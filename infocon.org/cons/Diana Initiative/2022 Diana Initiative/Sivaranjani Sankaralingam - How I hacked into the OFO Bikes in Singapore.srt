1
00:00:06,160 --> 00:00:07,680
welcome back to

2
00:00:07,680 --> 00:00:09,840
the diana initiative

3
00:00:09,840 --> 00:00:12,320
and we've been thanking our sponsors all

4
00:00:12,320 --> 00:00:14,240
day today but you know i want to take a

5
00:00:14,240 --> 00:00:17,440
moment just to thank the staff of tdi

6
00:00:17,440 --> 00:00:21,279
and also all the volunteers and speakers

7
00:00:21,279 --> 00:00:24,160
we couldn't have an event without them

8
00:00:24,160 --> 00:00:26,720
they're doing an amazing job so please

9
00:00:26,720 --> 00:00:29,760
take a moment to to thank the staff um

10
00:00:29,760 --> 00:00:31,760
you can do that in discord thank the

11
00:00:31,760 --> 00:00:35,920
volunteers um if you see them in discord

12
00:00:35,920 --> 00:00:37,600
um

13
00:00:37,600 --> 00:00:39,040
and yeah

14
00:00:39,040 --> 00:00:41,280
oh there we go now i'm live

15
00:00:41,280 --> 00:00:42,399
um

16
00:00:42,399 --> 00:00:45,120
i don't know okay i'll i'll repeat

17
00:00:45,120 --> 00:00:46,320
myself

18
00:00:46,320 --> 00:00:47,840
um

19
00:00:47,840 --> 00:00:51,039
i i think everybody got it but

20
00:00:51,039 --> 00:00:53,600
yes thank you all for being here at the

21
00:00:53,600 --> 00:00:56,719
diana initiative and sometimes we have

22
00:00:56,719 --> 00:00:58,960
even we have technical issues it's not

23
00:00:58,960 --> 00:01:02,239
perfect but yes thank thank the speakers

24
00:01:02,239 --> 00:01:04,239
thank the volunteers and thank the staff

25
00:01:04,239 --> 00:01:05,920
they've been doing an amazing job here

26
00:01:05,920 --> 00:01:09,520
today um without further ado i would

27
00:01:09,520 --> 00:01:11,600
like to introduce

28
00:01:11,600 --> 00:01:14,799
uh simaranjani she is going to talk

29
00:01:14,799 --> 00:01:15,680
about

30
00:01:15,680 --> 00:01:18,400
how she hacked into the of

31
00:01:18,400 --> 00:01:21,280
ofo bikes in singapore this sounds like

32
00:01:21,280 --> 00:01:25,439
quite the interesting talk um so please

33
00:01:25,439 --> 00:01:28,158
take it away

34
00:01:29,200 --> 00:01:32,159
hello good afternoon everyone so i'm

35
00:01:32,159 --> 00:01:33,920
excited to be here

36
00:01:33,920 --> 00:01:36,799
i'm going to give a very quick and very

37
00:01:36,799 --> 00:01:39,119
short talk hope it's very engaging for

38
00:01:39,119 --> 00:01:42,880
all of you um i just want to share my

39
00:01:42,880 --> 00:01:44,720
experience on

40
00:01:44,720 --> 00:01:46,560
how i

41
00:01:46,560 --> 00:01:48,799
hacked into one of these yellow bikes

42
00:01:48,799 --> 00:01:51,040
which were popular

43
00:01:51,040 --> 00:01:55,360
throughout the island in um 2018 so

44
00:01:55,360 --> 00:01:58,560
around four years ago to be exact

45
00:01:58,560 --> 00:02:00,159
uh so

46
00:02:00,159 --> 00:02:01,119
um

47
00:02:01,119 --> 00:02:04,000
can you go to the next slide please

48
00:02:04,000 --> 00:02:06,880
uh so ofo was a is a

49
00:02:06,880 --> 00:02:09,679
bike sharing company that was founded in

50
00:02:09,679 --> 00:02:12,400
2014 in beijing china

51
00:02:12,400 --> 00:02:13,680
and

52
00:02:13,680 --> 00:02:15,920
i

53
00:02:15,920 --> 00:02:19,760
did this research in 2018 as a part of a

54
00:02:19,760 --> 00:02:22,400
startup that was attached to national

55
00:02:22,400 --> 00:02:24,480
university of singapore where i was

56
00:02:24,480 --> 00:02:26,319
working back then

57
00:02:26,319 --> 00:02:29,280
so uh the current status of the company

58
00:02:29,280 --> 00:02:31,680
is it's been defunct

59
00:02:31,680 --> 00:02:35,840
um since as of 20

60
00:02:35,840 --> 00:02:36,720
so

61
00:02:36,720 --> 00:02:39,200
um as a part of the responsible

62
00:02:39,200 --> 00:02:41,920
disclosure policy i've just attached

63
00:02:41,920 --> 00:02:42,879
some

64
00:02:42,879 --> 00:02:43,680
uh

65
00:02:43,680 --> 00:02:47,280
confirmation from ofo acknowledging my

66
00:02:47,280 --> 00:02:49,599
contribution to um

67
00:02:49,599 --> 00:02:52,080
their product development and

68
00:02:52,080 --> 00:02:52,959
uh

69
00:02:52,959 --> 00:02:53,760
it's

70
00:02:53,760 --> 00:02:56,080
also you can see another snippet where

71
00:02:56,080 --> 00:02:58,640
it says that it's no longer

72
00:02:58,640 --> 00:03:00,720
allowed to legally operate in singapore

73
00:03:00,720 --> 00:03:01,680
anymore

74
00:03:01,680 --> 00:03:03,680
so i also want to state a disclaimer

75
00:03:03,680 --> 00:03:04,400
that

76
00:03:04,400 --> 00:03:07,040
i am here on my personal

77
00:03:07,040 --> 00:03:09,519
um opinion i'm not just representing my

78
00:03:09,519 --> 00:03:11,680
current company or my formal employer

79
00:03:11,680 --> 00:03:14,800
it's just myself at this point

80
00:03:14,800 --> 00:03:16,879
so um

81
00:03:16,879 --> 00:03:19,040
yes uh so can we go to the next slide

82
00:03:19,040 --> 00:03:20,800
please

83
00:03:20,800 --> 00:03:24,480
so basically ofo is a bike sharing app

84
00:03:24,480 --> 00:03:25,920
it was i think

85
00:03:25,920 --> 00:03:28,400
the first of its kind in singapore and

86
00:03:28,400 --> 00:03:31,040
people were using it all over its

87
00:03:31,040 --> 00:03:32,799
bluetooth based

88
00:03:32,799 --> 00:03:35,280
and all you have to do is like you have

89
00:03:35,280 --> 00:03:38,720
your mobile app in the bike itself you

90
00:03:38,720 --> 00:03:41,120
just like

91
00:03:41,120 --> 00:03:43,599
go to the uh app you just pay a bit of

92
00:03:43,599 --> 00:03:45,519
your

93
00:03:45,519 --> 00:03:48,400
amount of money and then it just like

94
00:03:48,400 --> 00:03:50,319
unlocks the bike for you when you end

95
00:03:50,319 --> 00:03:52,640
the ride you place it in another

96
00:03:52,640 --> 00:03:56,400
uh anywhere else where there's a

97
00:03:56,400 --> 00:03:58,000
actually anywhere else in singapore

98
00:03:58,000 --> 00:03:59,599
where there's a bike rack

99
00:03:59,599 --> 00:04:02,480
and you just like stop the ride in the

100
00:04:02,480 --> 00:04:05,760
ride lock it again and then the

101
00:04:05,760 --> 00:04:08,080
money would be calculated for that um

102
00:04:08,080 --> 00:04:08,959
amount

103
00:04:08,959 --> 00:04:10,640
uh the amount of distance that you've

104
00:04:10,640 --> 00:04:13,439
covered so far so it was like the

105
00:04:13,439 --> 00:04:15,760
popular choice of bike sharing back in

106
00:04:15,760 --> 00:04:18,720
2018 when i was working on it

107
00:04:18,720 --> 00:04:21,600
uh can we go the next slide please

108
00:04:21,600 --> 00:04:23,840
so uh the

109
00:04:23,840 --> 00:04:26,639
protocol specifically used here is

110
00:04:26,639 --> 00:04:28,880
bluetooth low energy

111
00:04:28,880 --> 00:04:30,880
not the bluetooth classic

112
00:04:30,880 --> 00:04:33,520
primarily because the low energy is you

113
00:04:33,520 --> 00:04:35,600
know to conserve the power consumption

114
00:04:35,600 --> 00:04:37,440
of the devices itself

115
00:04:37,440 --> 00:04:40,720
so it basically only uses one third the

116
00:04:40,720 --> 00:04:43,600
speed of bluetooth classic and the power

117
00:04:43,600 --> 00:04:46,080
does not exceed half of that so which

118
00:04:46,080 --> 00:04:48,800
makes it a very ideal candidate for iot

119
00:04:48,800 --> 00:04:50,000
devices

120
00:04:50,000 --> 00:04:53,360
so um the main characteristic in a

121
00:04:53,360 --> 00:04:56,479
bluetooth low energy protocol is

122
00:04:56,479 --> 00:04:58,960
something called as gat

123
00:04:58,960 --> 00:05:02,320
which is a generic attribute profile

124
00:05:02,320 --> 00:05:03,360
so

125
00:05:03,360 --> 00:05:05,520
in simple terms what it means is like

126
00:05:05,520 --> 00:05:08,320
it's just a definition of two devices

127
00:05:08,320 --> 00:05:10,400
which are interacting with each other

128
00:05:10,400 --> 00:05:12,400
they kind of share information back and

129
00:05:12,400 --> 00:05:13,600
forth

130
00:05:13,600 --> 00:05:15,520
through some things called the services

131
00:05:15,520 --> 00:05:18,880
and characteristics where they agree on

132
00:05:18,880 --> 00:05:22,000
what sort of uh

133
00:05:23,360 --> 00:05:25,280
information that they want to share

134
00:05:25,280 --> 00:05:26,400
between them

135
00:05:26,400 --> 00:05:29,120
it's also to be um noted the connections

136
00:05:29,120 --> 00:05:31,680
are exclusive so only one connection is

137
00:05:31,680 --> 00:05:33,520
valid at a time so you can be only with

138
00:05:33,520 --> 00:05:35,919
one peripheral ble peripheral and vle

139
00:05:35,919 --> 00:05:37,520
essentials so

140
00:05:37,520 --> 00:05:39,280
it's just one connection one valid

141
00:05:39,280 --> 00:05:41,120
connection at a time

142
00:05:41,120 --> 00:05:44,160
so um can we go to the next slide please

143
00:05:44,160 --> 00:05:45,039
so

144
00:05:45,039 --> 00:05:47,680
uh this is how the pairing process works

145
00:05:47,680 --> 00:05:50,479
in a due to low energy device

146
00:05:50,479 --> 00:05:51,360
so

147
00:05:51,360 --> 00:05:53,840
we have the pairing request from the

148
00:05:53,840 --> 00:05:55,919
initiating device which would be the ble

149
00:05:55,919 --> 00:05:57,680
peripheral in this case

150
00:05:57,680 --> 00:06:01,680
so they just um exchange information on

151
00:06:01,680 --> 00:06:04,000
what sort of bonding requirements they

152
00:06:04,000 --> 00:06:05,600
have what sort of authentication

153
00:06:05,600 --> 00:06:08,240
requirements they have the maximum link

154
00:06:08,240 --> 00:06:10,479
size and

155
00:06:10,479 --> 00:06:12,960
and all the associated information

156
00:06:12,960 --> 00:06:15,680
then the devices decide among themselves

157
00:06:15,680 --> 00:06:17,039
how they want to set up a secure

158
00:06:17,039 --> 00:06:19,680
connection and then this to be this

159
00:06:19,680 --> 00:06:22,560
particular communication itself is

160
00:06:22,560 --> 00:06:24,400
unencrypted

161
00:06:24,400 --> 00:06:26,400
so um then

162
00:06:26,400 --> 00:06:29,360
the next stage is they will generate a

163
00:06:29,360 --> 00:06:32,160
temporary key or tk

164
00:06:32,160 --> 00:06:34,800
more on this on the next slide and after

165
00:06:34,800 --> 00:06:36,720
this is uh i'm not

166
00:06:36,720 --> 00:06:38,800
let me just go back a little bit again

167
00:06:38,800 --> 00:06:41,759
yeah so and then the final step is we

168
00:06:41,759 --> 00:06:43,039
would

169
00:06:43,039 --> 00:06:45,199
generate a short term key

170
00:06:45,199 --> 00:06:47,759
which is a combination of the

171
00:06:47,759 --> 00:06:50,240
temporary temporary key with some random

172
00:06:50,240 --> 00:06:52,639
values

173
00:06:52,639 --> 00:06:54,000
used with them

174
00:06:54,000 --> 00:06:56,240
so the definition of random values could

175
00:06:56,240 --> 00:06:59,199
be again depending on the devices itself

176
00:06:59,199 --> 00:07:03,599
so um the next one uh so

177
00:07:03,599 --> 00:07:05,759
for the pairing methods there are very

178
00:07:05,759 --> 00:07:08,000
three very common ones that are found in

179
00:07:08,000 --> 00:07:10,160
bluetooth low energy devices

180
00:07:10,160 --> 00:07:13,840
the first one is just works where the tk

181
00:07:13,840 --> 00:07:16,479
itself is zero which means tk and sdk

182
00:07:16,479 --> 00:07:18,639
everything is unencrypted it's possibly

183
00:07:18,639 --> 00:07:20,639
the lowest level of security that you

184
00:07:20,639 --> 00:07:22,240
would find

185
00:07:22,240 --> 00:07:25,440
um the pass key display is basically you

186
00:07:25,440 --> 00:07:27,280
have a six digit number pass between

187
00:07:27,280 --> 00:07:29,280
devices

188
00:07:29,280 --> 00:07:31,759
and the most secure of them all is out

189
00:07:31,759 --> 00:07:33,520
of band ob

190
00:07:33,520 --> 00:07:36,479
um it uses a large

191
00:07:36,479 --> 00:07:39,440
temporal key up to 21 28 bits which

192
00:07:39,440 --> 00:07:42,400
making it much much more secure

193
00:07:42,400 --> 00:07:44,639
and most of them use near field

194
00:07:44,639 --> 00:07:46,879
communications and for nfcs you have to

195
00:07:46,879 --> 00:07:49,360
be really really close the monster in

196
00:07:49,360 --> 00:07:51,360
the middle have to be super close to the

197
00:07:51,360 --> 00:07:53,520
device in question so which means you

198
00:07:53,520 --> 00:07:56,000
would technically know

199
00:07:56,000 --> 00:07:57,120
that you know

200
00:07:57,120 --> 00:07:59,280
uh someone is right there in front of

201
00:07:59,280 --> 00:08:00,479
you so

202
00:08:00,479 --> 00:08:03,599
this for this reason nfc is considered

203
00:08:03,599 --> 00:08:04,960
secure

204
00:08:04,960 --> 00:08:08,639
um can you go to the next slide please

205
00:08:08,639 --> 00:08:10,800
so there are also different security

206
00:08:10,800 --> 00:08:13,440
modes and different security levels

207
00:08:13,440 --> 00:08:15,520
associated with each of them

208
00:08:15,520 --> 00:08:17,840
so if you choose mode one there are

209
00:08:17,840 --> 00:08:20,000
different levels one being the least

210
00:08:20,000 --> 00:08:23,599
secure and four being uh the most secure

211
00:08:23,599 --> 00:08:26,400
so one is basically no authentication no

212
00:08:26,400 --> 00:08:28,800
encryption two is

213
00:08:28,800 --> 00:08:30,879
unauthenticated pairing but there's

214
00:08:30,879 --> 00:08:32,080
encryption

215
00:08:32,080 --> 00:08:33,919
and then the third one is authenticated

216
00:08:33,919 --> 00:08:35,839
pairing with encryption and the fourth

217
00:08:35,839 --> 00:08:37,839
one is authenticated le secure

218
00:08:37,839 --> 00:08:40,958
connections with encryptions as well

219
00:08:40,958 --> 00:08:42,080
um

220
00:08:42,080 --> 00:08:44,480
can we go to the next one

221
00:08:44,480 --> 00:08:46,800
so in security mode two it's like

222
00:08:46,800 --> 00:08:48,640
unauthenticated pairing with data

223
00:08:48,640 --> 00:08:50,560
signing and authenticated pairing with

224
00:08:50,560 --> 00:08:51,920
data

225
00:08:51,920 --> 00:08:54,240
so um these are different modes and

226
00:08:54,240 --> 00:08:56,080
these are different levels so the higher

227
00:08:56,080 --> 00:08:57,760
the level the more secure it is

228
00:08:57,760 --> 00:09:00,640
depending upon how which mode the two

229
00:09:00,640 --> 00:09:03,839
devices were deciding on during the uh

230
00:09:03,839 --> 00:09:06,399
g80 uh process

231
00:09:06,399 --> 00:09:09,519
and also um

232
00:09:09,519 --> 00:09:12,000
two things to keep in mind is

233
00:09:12,000 --> 00:09:14,320
apart from the communication itself

234
00:09:14,320 --> 00:09:15,519
it's also

235
00:09:15,519 --> 00:09:18,320
uh more secure if the

236
00:09:18,320 --> 00:09:22,080
channel ble channel itself is um

237
00:09:22,080 --> 00:09:24,720
encrypted or is secure

238
00:09:24,720 --> 00:09:26,000
by uh

239
00:09:26,000 --> 00:09:28,800
any other means so the previous one

240
00:09:28,800 --> 00:09:31,200
security mode one level four also

241
00:09:31,200 --> 00:09:33,680
addresses this this uh securing the

242
00:09:33,680 --> 00:09:36,399
channel along with the communications

243
00:09:36,399 --> 00:09:39,760
um can we go to the next slide please

244
00:09:39,760 --> 00:09:42,560
okay so these are the simple devices

245
00:09:42,560 --> 00:09:45,839
that i have used for um

246
00:09:45,839 --> 00:09:48,080
doing performing the monster in the

247
00:09:48,080 --> 00:09:49,519
middle attacks

248
00:09:49,519 --> 00:09:53,360
so it's i used a sniffer which basically

249
00:09:53,360 --> 00:09:56,480
sniffs all the um

250
00:09:56,480 --> 00:09:59,279
bluetooth energy communications

251
00:09:59,279 --> 00:10:03,040
and then i used a um blue fruit friend

252
00:10:03,040 --> 00:10:05,440
which is used to send

253
00:10:05,440 --> 00:10:07,600
messages to the ble channel that you

254
00:10:07,600 --> 00:10:08,560
want

255
00:10:08,560 --> 00:10:12,240
so um i used a already available app

256
00:10:12,240 --> 00:10:15,200
called nordic semiconductor connect

257
00:10:15,200 --> 00:10:17,200
conductor connect which basically can

258
00:10:17,200 --> 00:10:20,160
just like send out get messages to um

259
00:10:20,160 --> 00:10:21,760
devices nearby

260
00:10:21,760 --> 00:10:23,519
so you can either use that or you can

261
00:10:23,519 --> 00:10:26,880
just write your own app so whatever

262
00:10:26,880 --> 00:10:28,480
you feel like

263
00:10:28,480 --> 00:10:31,680
so can we go to the next slide

264
00:10:31,680 --> 00:10:35,600
so it's the process is um pretty pretty

265
00:10:35,600 --> 00:10:37,920
straightforward because

266
00:10:37,920 --> 00:10:39,440
the um

267
00:10:39,440 --> 00:10:43,040
level of encryption is pretty low in o4

268
00:10:43,040 --> 00:10:43,839
so

269
00:10:43,839 --> 00:10:46,560
i do remember having a um

270
00:10:46,560 --> 00:10:49,680
pin entering have to enter a passcode on

271
00:10:49,680 --> 00:10:51,440
both the sides so

272
00:10:51,440 --> 00:10:53,839
um it would probably be not the just key

273
00:10:53,839 --> 00:10:56,079
but the um

274
00:10:56,079 --> 00:11:00,000
pass key which is the second uh layer of

275
00:11:00,000 --> 00:11:01,519
padding method

276
00:11:01,519 --> 00:11:05,760
and uh here um

277
00:11:06,000 --> 00:11:08,399
it's it goes like this so first i start

278
00:11:08,399 --> 00:11:11,519
the low energy sniffer and then i just

279
00:11:11,519 --> 00:11:14,399
select over bike and then i start like

280
00:11:14,399 --> 00:11:15,120
uh

281
00:11:15,120 --> 00:11:17,279
wireshark capture so i can

282
00:11:17,279 --> 00:11:20,399
monitor all the communications going to

283
00:11:20,399 --> 00:11:21,839
and from that

284
00:11:21,839 --> 00:11:24,160
so and then

285
00:11:24,160 --> 00:11:27,200
it now it's just communications from

286
00:11:27,200 --> 00:11:29,600
the application the offer application to

287
00:11:29,600 --> 00:11:31,279
the offer bike and then you have the

288
00:11:31,279 --> 00:11:33,200
monster in middle which is you

289
00:11:33,200 --> 00:11:35,600
you have the bike which you want to

290
00:11:35,600 --> 00:11:37,120
manipulate the

291
00:11:37,120 --> 00:11:40,079
g80d communication between them

292
00:11:40,079 --> 00:11:43,519
so uh the first one is the right message

293
00:11:43,519 --> 00:11:46,480
and it just like if you were able to see

294
00:11:46,480 --> 00:11:48,720
the screen it's just a very simple write

295
00:11:48,720 --> 00:11:50,000
request

296
00:11:50,000 --> 00:11:50,800
and

297
00:11:50,800 --> 00:11:52,800
once you send that

298
00:11:52,800 --> 00:11:55,600
uh the bike sends an acknowledgement

299
00:11:55,600 --> 00:11:57,120
saying okay

300
00:11:57,120 --> 00:11:58,000
so

301
00:11:58,000 --> 00:12:00,240
that's the fi first right message that

302
00:12:00,240 --> 00:12:01,920
happens after

303
00:12:01,920 --> 00:12:04,079
all the communications have taken place

304
00:12:04,079 --> 00:12:07,040
already and now the the goal is to

305
00:12:07,040 --> 00:12:08,880
unlock the bike so

306
00:12:08,880 --> 00:12:11,920
at this point you want to um either lock

307
00:12:11,920 --> 00:12:14,320
or unlock the bike depending upon what

308
00:12:14,320 --> 00:12:15,680
you want to do

309
00:12:15,680 --> 00:12:16,560
so

310
00:12:16,560 --> 00:12:18,240
this is the first message that is sent

311
00:12:18,240 --> 00:12:20,240
it's sent from the app to the bike

312
00:12:20,240 --> 00:12:22,959
acknowledges it so it's great um can you

313
00:12:22,959 --> 00:12:25,680
go to the next um message so in the

314
00:12:25,680 --> 00:12:27,680
message one we're not doing anything as

315
00:12:27,680 --> 00:12:29,920
a monster we're just observing

316
00:12:29,920 --> 00:12:31,839
that the app and the bike exchange this

317
00:12:31,839 --> 00:12:34,079
message we just stay silent

318
00:12:34,079 --> 00:12:36,880
now in the command two

319
00:12:36,880 --> 00:12:39,600
that uh the bike

320
00:12:39,600 --> 00:12:43,600
sends back uh the absence to the bike

321
00:12:43,600 --> 00:12:46,000
so here it's a

322
00:12:46,000 --> 00:12:47,279
a very

323
00:12:47,279 --> 00:12:51,040
constant unique value that is same that

324
00:12:51,040 --> 00:12:54,160
stays the same for each bike

325
00:12:54,160 --> 00:12:57,120
so if you have it either has two

326
00:12:57,120 --> 00:12:59,040
starting values it always started with

327
00:12:59,040 --> 00:13:03,279
either 2 23 or it started with a

328
00:13:03,279 --> 00:13:04,399
hash

329
00:13:04,399 --> 00:13:06,959
so it always started like that and it

330
00:13:06,959 --> 00:13:09,040
always remained

331
00:13:09,040 --> 00:13:12,000
the same for each bike which is a bit of

332
00:13:12,000 --> 00:13:14,320
a problem because once you know that

333
00:13:14,320 --> 00:13:16,000
that is unique for each bike and once

334
00:13:16,000 --> 00:13:17,360
you're able to figure that out that

335
00:13:17,360 --> 00:13:19,519
itself is like

336
00:13:19,519 --> 00:13:21,839
passes a lot of the

337
00:13:21,839 --> 00:13:24,240
security mechanisms they have

338
00:13:24,240 --> 00:13:26,720
so once when she send that the bottom

339
00:13:26,720 --> 00:13:28,880
picture there is the acknowledgement

340
00:13:28,880 --> 00:13:31,760
from the bike the bike says okay

341
00:13:31,760 --> 00:13:32,560
so

342
00:13:32,560 --> 00:13:34,880
again at this point as a monster you're

343
00:13:34,880 --> 00:13:37,120
just sitting and you're observing

344
00:13:37,120 --> 00:13:39,040
so for a replay attack what you would

345
00:13:39,040 --> 00:13:41,920
need to do is just know where the values

346
00:13:41,920 --> 00:13:44,399
that are being there and then just

347
00:13:44,399 --> 00:13:47,839
send it at the time that is

348
00:13:47,839 --> 00:13:49,360
going to

349
00:13:49,360 --> 00:13:52,560
cause the maximum security damage

350
00:13:52,560 --> 00:13:56,480
so the next one next slide please

351
00:13:56,480 --> 00:13:59,839
okay so the final command is from us

352
00:13:59,839 --> 00:14:01,040
to the bike

353
00:14:01,040 --> 00:14:03,199
so we are pretending to be coming from

354
00:14:03,199 --> 00:14:06,160
the app but it's actually coming from us

355
00:14:06,160 --> 00:14:06,959
so

356
00:14:06,959 --> 00:14:09,279
again another observation is that the

357
00:14:09,279 --> 00:14:11,040
last um

358
00:14:11,040 --> 00:14:13,120
the last command at least for the bikes

359
00:14:13,120 --> 00:14:16,480
that have tested always remain the same

360
00:14:16,480 --> 00:14:20,480
so once i send the values back to the um

361
00:14:20,480 --> 00:14:22,720
bike itself pretending to be from the

362
00:14:22,720 --> 00:14:24,079
app

363
00:14:24,079 --> 00:14:26,560
it was unlocked so when i tried the same

364
00:14:26,560 --> 00:14:29,600
procedure on an unlocked bike it locked

365
00:14:29,600 --> 00:14:31,279
which could be pretty dangerous if

366
00:14:31,279 --> 00:14:33,120
you're riding the bike and then you

367
00:14:33,120 --> 00:14:34,959
suddenly lock it you can't move the

368
00:14:34,959 --> 00:14:36,480
wheels so

369
00:14:36,480 --> 00:14:38,399
the person falls down so it's also

370
00:14:38,399 --> 00:14:40,720
pretty dangerous and that's it

371
00:14:40,720 --> 00:14:42,880
so in the next slide i'll be showing a

372
00:14:42,880 --> 00:14:45,199
30 second video demo where you can

373
00:14:45,199 --> 00:14:47,839
actually see all of this happening

374
00:14:47,839 --> 00:14:50,560
so maybe yes if you're able to click on

375
00:14:50,560 --> 00:14:53,839
that and just play that

376
00:14:56,320 --> 00:14:58,480
so i'm using this app

377
00:14:58,480 --> 00:15:00,240
and i just like

378
00:15:00,240 --> 00:15:03,360
send all the gdt messages um the three

379
00:15:03,360 --> 00:15:05,360
write commands so i just

380
00:15:05,360 --> 00:15:08,880
modify the different values according to

381
00:15:08,880 --> 00:15:09,920
you know

382
00:15:09,920 --> 00:15:12,079
what we have just discussed in the

383
00:15:12,079 --> 00:15:14,880
previous slides

384
00:15:14,959 --> 00:15:19,518
so once i send all the three commands

385
00:15:21,519 --> 00:15:23,440
so again i think one thing i forgot to

386
00:15:23,440 --> 00:15:25,040
mention is the command one and the

387
00:15:25,040 --> 00:15:26,639
command two where we're just silent

388
00:15:26,639 --> 00:15:27,760
observers

389
00:15:27,760 --> 00:15:29,279
we observe it

390
00:15:29,279 --> 00:15:30,160
and

391
00:15:30,160 --> 00:15:32,560
now we just repeat the same commands and

392
00:15:32,560 --> 00:15:35,199
it still works the just using the same

393
00:15:35,199 --> 00:15:37,519
commands from before just do it i'll

394
00:15:37,519 --> 00:15:39,360
just send it back again and the third

395
00:15:39,360 --> 00:15:42,240
one you just also send it um as i

396
00:15:42,240 --> 00:15:44,320
mentioned so it just you're able to see

397
00:15:44,320 --> 00:15:45,120
the

398
00:15:45,120 --> 00:15:47,199
uh

399
00:15:47,199 --> 00:15:50,240
the bike just lock

400
00:15:50,240 --> 00:15:55,160
so uh the next slide please

401
00:15:55,440 --> 00:15:59,360
uh yeah so that's it so now we're just

402
00:15:59,360 --> 00:16:01,759
gonna just give you some recommendations

403
00:16:01,759 --> 00:16:04,959
on how to keep ble devices secure

404
00:16:04,959 --> 00:16:07,920
so a research from ohio university has

405
00:16:07,920 --> 00:16:10,800
said that about 7.4 percent of the ble

406
00:16:10,800 --> 00:16:12,880
devices are vulnerable to each dropping

407
00:16:12,880 --> 00:16:14,800
attacks which is exactly what i've

408
00:16:14,800 --> 00:16:16,639
demonstrated here

409
00:16:16,639 --> 00:16:17,519
so

410
00:16:17,519 --> 00:16:19,440
uh the recommendations which you might

411
00:16:19,440 --> 00:16:22,639
already guessed is the pairing mode

412
00:16:22,639 --> 00:16:24,880
should be of the highest level

413
00:16:24,880 --> 00:16:26,800
uh highest

414
00:16:26,800 --> 00:16:29,120
security level as possible

415
00:16:29,120 --> 00:16:32,320
so instead of using the pass key mode

416
00:16:32,320 --> 00:16:35,839
that is currently there uh probably use

417
00:16:35,839 --> 00:16:37,199
out of band

418
00:16:37,199 --> 00:16:40,720
so you can use a longer uh tk value uh

419
00:16:40,720 --> 00:16:43,199
temporary key value and then the

420
00:16:43,199 --> 00:16:44,160
uh

421
00:16:44,160 --> 00:16:46,399
channel is also protected if you use the

422
00:16:46,399 --> 00:16:49,279
level four so then it's extremely hard

423
00:16:49,279 --> 00:16:51,040
to break into this

424
00:16:51,040 --> 00:16:51,920
um

425
00:16:51,920 --> 00:16:54,240
next one

426
00:16:54,240 --> 00:16:55,199
so

427
00:16:55,199 --> 00:16:57,440
yes security level as i just mentioned

428
00:16:57,440 --> 00:16:59,519
just choose a higher security level as

429
00:16:59,519 --> 00:17:01,360
possible it may always not be possible

430
00:17:01,360 --> 00:17:03,519
to choose the highest highest security

431
00:17:03,519 --> 00:17:06,319
level at any chance but we have to try

432
00:17:06,319 --> 00:17:09,599
to do as many as high as we can

433
00:17:09,599 --> 00:17:11,599
so another thing that you have you may

434
00:17:11,599 --> 00:17:13,679
have noticed is

435
00:17:13,679 --> 00:17:16,000
the constant appearance of

436
00:17:16,000 --> 00:17:19,119
static keys or just unique keys

437
00:17:19,119 --> 00:17:20,880
so that's a bit problematic so if

438
00:17:20,880 --> 00:17:22,799
they're able to do dynamic keys or

439
00:17:22,799 --> 00:17:25,599
values instead of static variables

440
00:17:25,599 --> 00:17:27,679
that also would make it very harder

441
00:17:27,679 --> 00:17:28,960
because you don't know what's the

442
00:17:28,960 --> 00:17:30,559
current uh

443
00:17:30,559 --> 00:17:32,559
value that you're working with

444
00:17:32,559 --> 00:17:36,480
and another thing is um obfuscate the

445
00:17:36,480 --> 00:17:38,240
app code so you're trying to actually

446
00:17:38,240 --> 00:17:40,320
get the android app code and everything

447
00:17:40,320 --> 00:17:42,000
to see if there is any

448
00:17:42,000 --> 00:17:43,600
um

449
00:17:43,600 --> 00:17:46,160
values that are being shown as it was

450
00:17:46,160 --> 00:17:48,799
shown like when i opened the app i was

451
00:17:48,799 --> 00:17:51,679
able to see the

452
00:17:51,679 --> 00:17:54,559
long digits of 23 or ash starting with

453
00:17:54,559 --> 00:17:56,799
which the unique value to the pipe so if

454
00:17:56,799 --> 00:17:58,640
you're able to obfuscate the app code

455
00:17:58,640 --> 00:18:00,720
then you will make it much much harder

456
00:18:00,720 --> 00:18:03,120
to reverse engineer for the monsters to

457
00:18:03,120 --> 00:18:05,919
reverse engineer your

458
00:18:05,919 --> 00:18:07,440
code or product

459
00:18:07,440 --> 00:18:10,320
and this one is specifically for ofo but

460
00:18:10,320 --> 00:18:12,559
i think it may also hold true for

461
00:18:12,559 --> 00:18:14,960
certain other devices which have a lot

462
00:18:14,960 --> 00:18:15,760
of

463
00:18:15,760 --> 00:18:17,760
data profile available

464
00:18:17,760 --> 00:18:19,919
so if there is a data profile for each

465
00:18:19,919 --> 00:18:21,919
user then you can just see if there

466
00:18:21,919 --> 00:18:24,720
isn't detect any abnormal usage so if

467
00:18:24,720 --> 00:18:26,880
somebody is just locking and unlocking

468
00:18:26,880 --> 00:18:28,799
multiple times and it's not

469
00:18:28,799 --> 00:18:31,039
you know useful for it's not their usual

470
00:18:31,039 --> 00:18:33,600
behavior then again that's something

471
00:18:33,600 --> 00:18:36,880
that you know the company can enforce

472
00:18:36,880 --> 00:18:38,799
from their end so

473
00:18:38,799 --> 00:18:40,160
uh

474
00:18:40,160 --> 00:18:42,799
can we go the next slide please

475
00:18:42,799 --> 00:18:46,480
so and the last one is

476
00:18:46,480 --> 00:18:49,520
um identify some key attack surfaces so

477
00:18:49,520 --> 00:18:52,160
if you are getting user inputs in like

478
00:18:52,160 --> 00:18:54,960
an app or something just try to sanitize

479
00:18:54,960 --> 00:18:57,919
the inputs and monitor all the communic

480
00:18:57,919 --> 00:19:00,000
inter-process communication either with

481
00:19:00,000 --> 00:19:02,000
the company server

482
00:19:02,000 --> 00:19:03,039
or

483
00:19:03,039 --> 00:19:04,640
inter-process communications with the

484
00:19:04,640 --> 00:19:06,320
apps on device

485
00:19:06,320 --> 00:19:08,880
itself like the device level

486
00:19:08,880 --> 00:19:12,480
so these are the things that can make a

487
00:19:12,480 --> 00:19:15,120
replay attacks or monster in the middle

488
00:19:15,120 --> 00:19:18,320
attacks much harder um

489
00:19:18,320 --> 00:19:19,280
actually

490
00:19:19,280 --> 00:19:24,240
so i think that's the end of my talk

491
00:19:24,640 --> 00:19:25,600
yeah

492
00:19:25,600 --> 00:19:31,080
i really hope all of you enjoyed it

493
00:19:52,160 --> 00:19:54,240
oh i want to thank you for that talk

494
00:19:54,240 --> 00:19:57,440
that was great um i it makes me want to

495
00:19:57,440 --> 00:19:59,919
go do a little more um ble hacking

496
00:19:59,919 --> 00:20:02,960
myself but what i want to know is

497
00:20:02,960 --> 00:20:05,679
why has no one started a unicycle

498
00:20:05,679 --> 00:20:07,679
sharing company

499
00:20:07,679 --> 00:20:11,360
i really want to see that but oh well

500
00:20:11,360 --> 00:20:12,400
um

501
00:20:12,400 --> 00:20:15,280
anyway thank you all and um thank you

502
00:20:15,280 --> 00:20:16,880
ron johnny

503
00:20:16,880 --> 00:20:18,240
great talk

504
00:20:18,240 --> 00:20:19,120
and

505
00:20:19,120 --> 00:20:24,039
enjoy the rest of the diana initiative

