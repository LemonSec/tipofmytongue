1
00:00:12,559 --> 00:00:12,880
hi

2
00:00:12,880 --> 00:00:15,440
everyone this is edward miro again over

3
00:00:15,440 --> 00:00:16,320
here on

4
00:00:16,320 --> 00:00:19,119
stage two uh before i announce the next

5
00:00:19,119 --> 00:00:20,000
speaker

6
00:00:20,000 --> 00:00:22,480
i just want to thank the sponsors again

7
00:00:22,480 --> 00:00:24,560
for this year's diana initiative

8
00:00:24,560 --> 00:00:28,240
mongodb microsoft verizon salesforce

9
00:00:28,240 --> 00:00:31,039
amazon information security elearn

10
00:00:31,039 --> 00:00:31,840
security

11
00:00:31,840 --> 00:00:34,640
intel and remediant a couple other

12
00:00:34,640 --> 00:00:36,160
things i just want to remind you of if

13
00:00:36,160 --> 00:00:38,239
you're not taking advantage of some of

14
00:00:38,239 --> 00:00:38,640
the

15
00:00:38,640 --> 00:00:40,800
expo hall things that are going on you

16
00:00:40,800 --> 00:00:42,239
want to check that out there are

17
00:00:42,239 --> 00:00:44,320
sponsors there that are running contests

18
00:00:44,320 --> 00:00:45,120
they're giving away

19
00:00:45,120 --> 00:00:48,960
swag there are red team talks going on

20
00:00:48,960 --> 00:00:51,360
all kinds of raffles and there's badge

21
00:00:51,360 --> 00:00:53,120
workshops so there's just really so much

22
00:00:53,120 --> 00:00:54,160
to do

23
00:00:54,160 --> 00:00:55,440
make sure you're taking advantage of the

24
00:00:55,440 --> 00:00:58,320
raffle prize so it's my distinct honor

25
00:00:58,320 --> 00:01:01,120
to announce the next speaker base 16. uh

26
00:01:01,120 --> 00:01:04,400
base 16 is the founder of dc919

27
00:01:04,400 --> 00:01:07,439
she's a b-sides rdu volunteer a founding

28
00:01:07,439 --> 00:01:09,360
member of kakalakicon

29
00:01:09,360 --> 00:01:12,080
and incident response security analyst

30
00:01:12,080 --> 00:01:14,560
uh her talk is secrets of the second

31
00:01:14,560 --> 00:01:15,360
factor

32
00:01:15,360 --> 00:01:16,799
and if there are any is there any time

33
00:01:16,799 --> 00:01:18,320
if there's any time at the end we will

34
00:01:18,320 --> 00:01:20,159
do questions if not we will uh

35
00:01:20,159 --> 00:01:22,640
direct you all to a breakout session so

36
00:01:22,640 --> 00:01:24,799
take it away base 16.

37
00:01:24,799 --> 00:01:26,320
all right thank you uh for that

38
00:01:26,320 --> 00:01:27,840
introduction um

39
00:01:27,840 --> 00:01:29,840
yeah so this is secrets of the second

40
00:01:29,840 --> 00:01:30,880
factor aka

41
00:01:30,880 --> 00:01:33,840
uh threat hunting and mfa logs so um

42
00:01:33,840 --> 00:01:34,640
just a little bit more

43
00:01:34,640 --> 00:01:36,079
about who i am there's a brief

44
00:01:36,079 --> 00:01:37,680
introduction there with like the um the

45
00:01:37,680 --> 00:01:39,920
day job i'm an incident response analyst

46
00:01:39,920 --> 00:01:41,439
specifically for

47
00:01:41,439 --> 00:01:44,159
um inside a company so not responding to

48
00:01:44,159 --> 00:01:45,280
any customers or

49
00:01:45,280 --> 00:01:47,280
anything like that responding to my own

50
00:01:47,280 --> 00:01:48,399
company stuff

51
00:01:48,399 --> 00:01:50,159
um nights and weekends i'm a hack

52
00:01:50,159 --> 00:01:51,680
coordinator

53
00:01:51,680 --> 00:01:54,479
and then i'm the expert in one room um

54
00:01:54,479 --> 00:01:54,799
so

55
00:01:54,799 --> 00:01:56,799
i'm just the person that can google this

56
00:01:56,799 --> 00:01:58,560
information the fastest on my team and

57
00:01:58,560 --> 00:01:59,520
that's why

58
00:01:59,520 --> 00:02:01,600
um i'm kind of like the expert now on

59
00:02:01,600 --> 00:02:04,159
this um but that's only that one room so

60
00:02:04,159 --> 00:02:05,920
i go to conferences like this and i try

61
00:02:05,920 --> 00:02:06,799
to take it to

62
00:02:06,799 --> 00:02:10,160
a larger room because when i feel like

63
00:02:10,160 --> 00:02:11,760
maybe i'm the expert or i'm the only one

64
00:02:11,760 --> 00:02:13,280
in the room that understands something

65
00:02:13,280 --> 00:02:15,040
i want to go to a different room and i

66
00:02:15,040 --> 00:02:17,040
want to understand more i want to teach

67
00:02:17,040 --> 00:02:18,319
other people

68
00:02:18,319 --> 00:02:20,640
and things like that i want to point out

69
00:02:20,640 --> 00:02:22,000
that i do not make a commission

70
00:02:22,000 --> 00:02:23,920
i only mention vendors as it is

71
00:02:23,920 --> 00:02:27,599
convenient um i had access to

72
00:02:27,599 --> 00:02:29,920
certain tools uh you know were just very

73
00:02:29,920 --> 00:02:31,680
convenient for me so i use those

74
00:02:31,680 --> 00:02:33,440
uh purely out of con convenience it's

75
00:02:33,440 --> 00:02:35,760
not an endorse

76
00:02:35,760 --> 00:02:37,760
but i don't know one way or the other um

77
00:02:37,760 --> 00:02:39,920
i just don't have really deep pockets to

78
00:02:39,920 --> 00:02:41,440
go do research on

79
00:02:41,440 --> 00:02:44,560
like more than one vendor really so

80
00:02:44,560 --> 00:02:46,080
i'm hoping that all this can apply to

81
00:02:46,080 --> 00:02:47,519
different vendors but i might not be

82
00:02:47,519 --> 00:02:48,319
able to answer

83
00:02:48,319 --> 00:02:51,440
specific vendor questions so giving you

84
00:02:51,440 --> 00:02:53,040
a brief overview of what the heck

85
00:02:53,040 --> 00:02:55,120
this talk is all about i'm going to do a

86
00:02:55,120 --> 00:02:57,360
brief introduction to mfa 101 just make

87
00:02:57,360 --> 00:02:58,800
sure that we're all level set there on

88
00:02:58,800 --> 00:02:59,519
it

89
00:02:59,519 --> 00:03:01,440
i'm going to get into what they tell you

90
00:03:01,440 --> 00:03:03,360
basically what do the vendors tell you

91
00:03:03,360 --> 00:03:04,560
what does

92
00:03:04,560 --> 00:03:06,159
the rest of the internet tell you and

93
00:03:06,159 --> 00:03:07,840
like other professionals in the area

94
00:03:07,840 --> 00:03:08,159
like

95
00:03:08,159 --> 00:03:10,000
conversations that i have seen happening

96
00:03:10,000 --> 00:03:12,400
already about mfa and then i'm going to

97
00:03:12,400 --> 00:03:13,360
get into

98
00:03:13,360 --> 00:03:15,120
what i haven't seen conversations about

99
00:03:15,120 --> 00:03:16,560
what i haven't seen the vendors talk

100
00:03:16,560 --> 00:03:17,280
about

101
00:03:17,280 --> 00:03:18,879
and then i'm going to get into discovery

102
00:03:18,879 --> 00:03:20,480
time the things that i found in my own

103
00:03:20,480 --> 00:03:22,640
like environment um kind of mix that in

104
00:03:22,640 --> 00:03:24,959
with a couple of other stories from

105
00:03:24,959 --> 00:03:26,319
the handful of people that i was able to

106
00:03:26,319 --> 00:03:28,400
talk to that have seen some things

107
00:03:28,400 --> 00:03:30,159
around this as well

108
00:03:30,159 --> 00:03:31,280
and then i'm going to get into some

109
00:03:31,280 --> 00:03:32,879
points about how you can fix this and

110
00:03:32,879 --> 00:03:34,159
how you can have a good mfa

111
00:03:34,159 --> 00:03:35,280
implementation

112
00:03:35,280 --> 00:03:38,319
um in your own organization

113
00:03:38,319 --> 00:03:41,040
so just a level for the purposes of this

114
00:03:41,040 --> 00:03:41,519
talk

115
00:03:41,519 --> 00:03:44,159
um mfa or multi-factor authentication

116
00:03:44,159 --> 00:03:45,599
second factor authentication

117
00:03:45,599 --> 00:03:48,159
i'm going to use those interchangeably

118
00:03:48,159 --> 00:03:50,720
is used after the password is correct

119
00:03:50,720 --> 00:03:52,480
there are some implementations where you

120
00:03:52,480 --> 00:03:53,920
can put your

121
00:03:53,920 --> 00:03:55,920
code in line with the password but

122
00:03:55,920 --> 00:03:57,200
that's not what i'm going to talk about

123
00:03:57,200 --> 00:03:57,760
today

124
00:03:57,760 --> 00:03:59,040
you have to have a correct password

125
00:03:59,040 --> 00:04:00,319
first and hit that level of

126
00:04:00,319 --> 00:04:03,439
authentication before being requested

127
00:04:03,439 --> 00:04:06,400
on a device and for the purposes of this

128
00:04:06,400 --> 00:04:07,519
talk we're going to consider

129
00:04:07,519 --> 00:04:11,439
mfa is a phone call an sms message or

130
00:04:11,439 --> 00:04:12,959
you're getting a push sent to a phone

131
00:04:12,959 --> 00:04:14,480
app and then you have to push that

132
00:04:14,480 --> 00:04:15,519
accept button

133
00:04:15,519 --> 00:04:17,918
um on that phone app and then mfa is

134
00:04:17,918 --> 00:04:18,798
security

135
00:04:18,798 --> 00:04:20,320
um it's something that everybody talks

136
00:04:20,320 --> 00:04:22,000
about as you know you got to have

137
00:04:22,000 --> 00:04:23,600
that second factor you got to have that

138
00:04:23,600 --> 00:04:25,600
extra layer that defense and depth it's

139
00:04:25,600 --> 00:04:26,080
your

140
00:04:26,080 --> 00:04:29,600
security plan um so kind of moving on i

141
00:04:29,600 --> 00:04:31,199
kind of want to give you an idea of the

142
00:04:31,199 --> 00:04:31,680
flow

143
00:04:31,680 --> 00:04:35,040
of how the heck mfa actually works when

144
00:04:35,040 --> 00:04:38,160
you go through and you enter your user

145
00:04:38,160 --> 00:04:41,199
navigation or service um it then goes to

146
00:04:41,199 --> 00:04:42,160
your first factor

147
00:04:42,160 --> 00:04:44,240
authentication uh after it goes through

148
00:04:44,240 --> 00:04:45,840
a proxy and this is going to be your

149
00:04:45,840 --> 00:04:47,919
active directory your radius your

150
00:04:47,919 --> 00:04:50,000
whatever you have set up um in the

151
00:04:50,000 --> 00:04:51,040
environment

152
00:04:51,040 --> 00:04:53,040
um it then you know passes through a

153
00:04:53,040 --> 00:04:54,880
firewall and goes to a cloud service

154
00:04:54,880 --> 00:04:57,520
such as duo where it then sends that

155
00:04:57,520 --> 00:04:58,800
signal to the phone

156
00:04:58,800 --> 00:05:00,639
passes it back it passes it to the

157
00:05:00,639 --> 00:05:02,960
application

158
00:05:02,960 --> 00:05:07,680
and just kind of

159
00:05:08,960 --> 00:05:10,479
and then moving on to some of the things

160
00:05:10,479 --> 00:05:11,600
that you've probably heard about and

161
00:05:11,600 --> 00:05:12,320
that they've told you

162
00:05:12,320 --> 00:05:15,600
before uh problems are mitigated by this

163
00:05:15,600 --> 00:05:16,320
system

164
00:05:16,320 --> 00:05:18,160
um it mitigates any problems with the

165
00:05:18,160 --> 00:05:19,520
password policy

166
00:05:19,520 --> 00:05:21,840
um if people are saving their their

167
00:05:21,840 --> 00:05:23,919
texts their passwords and plain text

168
00:05:23,919 --> 00:05:25,199
files somewhere on the system and

169
00:05:25,199 --> 00:05:26,880
somebody's able to read that the whole

170
00:05:26,880 --> 00:05:28,000
post-it note

171
00:05:28,000 --> 00:05:30,080
um under the keyboard uh you know that

172
00:05:30,080 --> 00:05:32,560
second factor gives

173
00:05:32,560 --> 00:05:36,320
you that credential harvesters

174
00:05:36,320 --> 00:05:40,320
asterisk to a degree um so

175
00:05:40,320 --> 00:05:43,919
also where the uh mfa is seen

176
00:05:43,919 --> 00:05:46,400
uh in the threat model is something that

177
00:05:46,400 --> 00:05:47,759
they tell you it's all about you know

178
00:05:47,759 --> 00:05:49,440
prevention preventing that account

179
00:05:49,440 --> 00:05:50,080
access

180
00:05:50,080 --> 00:05:52,639
or it's mitigating it's mitigating that

181
00:05:52,639 --> 00:05:54,240
password policy

182
00:05:54,240 --> 00:05:56,240
um so so this is where it lies in the

183
00:05:56,240 --> 00:05:57,280
current threat model

184
00:05:57,280 --> 00:06:00,240
where it's generally being discussed um

185
00:06:00,240 --> 00:06:02,800
out in the open and every

186
00:06:02,800 --> 00:06:05,120
thing and then that leads to you know

187
00:06:05,120 --> 00:06:07,520
pretty graphs and charts like this where

188
00:06:07,520 --> 00:06:10,160
you know we can see how effective it is

189
00:06:10,160 --> 00:06:10,639
um

190
00:06:10,639 --> 00:06:13,360
you know having an on dev device uh

191
00:06:13,360 --> 00:06:15,600
prompt attempt or an sms code

192
00:06:15,600 --> 00:06:18,960
and how effective it is

193
00:06:18,960 --> 00:06:22,319
and sticks um i'm going to give you a

194
00:06:22,319 --> 00:06:23,840
minute to kind of absorb this slide i

195
00:06:23,840 --> 00:06:25,199
know that i talk really fast and i

196
00:06:25,199 --> 00:06:27,280
actually give myself speaker notes to

197
00:06:27,280 --> 00:06:29,360
take a pause and let people kind of

198
00:06:29,360 --> 00:06:31,360
absorb information a little bit while i

199
00:06:31,360 --> 00:06:35,840
take a drink

200
00:06:39,520 --> 00:06:41,600
it's kind of moving into the things that

201
00:06:41,600 --> 00:06:43,440
um they don't tell you or i haven't

202
00:06:43,440 --> 00:06:44,319
really seen

203
00:06:44,319 --> 00:06:47,199
discussed um the whole a whole lot when

204
00:06:47,199 --> 00:06:49,680
i go out looking for different things on

205
00:06:49,680 --> 00:06:54,000
mfa or in conversations

206
00:06:54,000 --> 00:06:56,479
problems persist even though you have an

207
00:06:56,479 --> 00:06:58,000
mfa system set up

208
00:06:58,000 --> 00:07:00,960
people will still try to brute force

209
00:07:00,960 --> 00:07:03,120
imagine your phone constantly ringing

210
00:07:03,120 --> 00:07:05,120
for that second factor authentication if

211
00:07:05,120 --> 00:07:07,120
somebody gets a password list and is

212
00:07:07,120 --> 00:07:08,080
able to

213
00:07:08,080 --> 00:07:12,000
um get past that password then

214
00:07:12,000 --> 00:07:14,400
is going to keep trying to authenticate

215
00:07:14,400 --> 00:07:15,199
push messages

216
00:07:15,199 --> 00:07:17,360
phone calls things like that do your

217
00:07:17,360 --> 00:07:19,039
users know how to report

218
00:07:19,039 --> 00:07:22,319
uh root force against getting these

219
00:07:22,319 --> 00:07:24,800
phone calls continuously or keep getting

220
00:07:24,800 --> 00:07:28,000
codes sent to their sms

221
00:07:28,000 --> 00:07:29,759
man in the middle are credential

222
00:07:29,759 --> 00:07:31,360
harvesting sites um

223
00:07:31,360 --> 00:07:32,639
where they can quickly use the

224
00:07:32,639 --> 00:07:34,639
information where um

225
00:07:34,639 --> 00:07:38,240
you know just um social engineering

226
00:07:38,240 --> 00:07:39,360
fishing sites

227
00:07:39,360 --> 00:07:41,840
of that nature another thing that you

228
00:07:41,840 --> 00:07:42,720
have to consider

229
00:07:42,720 --> 00:07:46,080
uh is user lockout and or bypass

230
00:07:46,080 --> 00:07:47,680
what if a user doesn't have access to

231
00:07:47,680 --> 00:07:49,660
their phone or access to their device

232
00:07:49,660 --> 00:07:51,039
[Music]

233
00:07:51,039 --> 00:07:52,560
an admin needs to be able to issue them

234
00:07:52,560 --> 00:07:55,120
a bypass code and how does the admin

235
00:07:55,120 --> 00:07:57,199
validate who they who they are who they

236
00:07:57,199 --> 00:07:58,319
say they are um

237
00:07:58,319 --> 00:08:00,639
you know they could social engineer your

238
00:08:00,639 --> 00:08:01,440
uh

239
00:08:01,440 --> 00:08:03,440
security staff you know say that they

240
00:08:03,440 --> 00:08:05,199
forgot their phone that day and then

241
00:08:05,199 --> 00:08:07,440
they need a bypass code um how are you

242
00:08:07,440 --> 00:08:08,879
gonna distribute those codes

243
00:08:08,879 --> 00:08:10,160
you know are they gonna be a one-time

244
00:08:10,160 --> 00:08:12,400
use are they gonna have a

245
00:08:12,400 --> 00:08:16,560
timeout things like that

246
00:08:16,560 --> 00:08:20,000
another thing that when you introduce

247
00:08:20,000 --> 00:08:23,199
you can also introduce more problems to

248
00:08:23,199 --> 00:08:24,479
your environment

249
00:08:24,479 --> 00:08:26,000
you can instill a false sense of

250
00:08:26,000 --> 00:08:28,000
security to some of your workers

251
00:08:28,000 --> 00:08:29,759
um you know they feel like they can

252
00:08:29,759 --> 00:08:32,479
click on anything

253
00:08:32,479 --> 00:08:34,479
or got a whole bunch of stats about um

254
00:08:34,479 --> 00:08:36,320
mfa will protect their account

255
00:08:36,320 --> 00:08:38,880
um but you know that's not true that you

256
00:08:38,880 --> 00:08:40,320
can still fall for phishing attacks the

257
00:08:40,320 --> 00:08:42,320
man in the middle things like that

258
00:08:42,320 --> 00:08:44,640
it can be used as password validation if

259
00:08:44,640 --> 00:08:46,560
somebody gets a hold of a credential

260
00:08:46,560 --> 00:08:47,519
note

261
00:08:47,519 --> 00:08:49,200
they can use you know a couple of

262
00:08:49,200 --> 00:08:50,480
passwords in there and as soon as they

263
00:08:50,480 --> 00:08:52,399
see that prompt for that second factor

264
00:08:52,399 --> 00:08:54,320
they know what your system is and then

265
00:08:54,320 --> 00:08:55,600
they can silently

266
00:08:55,600 --> 00:08:58,800
um not cause that second factor to to

267
00:08:58,800 --> 00:09:00,080
follow through

268
00:09:00,080 --> 00:09:03,200
um so that can be so they can do further

269
00:09:03,200 --> 00:09:04,800
research and then come back later

270
00:09:04,800 --> 00:09:06,480
and try to exploit that multi-factor

271
00:09:06,480 --> 00:09:08,959
system exploit that application that

272
00:09:08,959 --> 00:09:10,480
they're trying to log into to see if

273
00:09:10,480 --> 00:09:11,040
there

274
00:09:11,040 --> 00:09:13,600
is a way to bypass that that trigger or

275
00:09:13,600 --> 00:09:14,720
that call to the

276
00:09:14,720 --> 00:09:18,080
multi-factor completely

277
00:09:18,080 --> 00:09:19,519
the other thing that you can have happen

278
00:09:19,519 --> 00:09:23,360
is an incorrect implementation

279
00:09:23,360 --> 00:09:25,920
as you roll out multi-factor system the

280
00:09:25,920 --> 00:09:27,040
application

281
00:09:27,040 --> 00:09:29,680
owners might have to set some certain

282
00:09:29,680 --> 00:09:31,360
configurations

283
00:09:31,360 --> 00:09:33,200
in their application in order to do that

284
00:09:33,200 --> 00:09:35,360
authentication and be compliant

285
00:09:35,360 --> 00:09:37,760
in order to make the correct calls um

286
00:09:37,760 --> 00:09:39,519
out to the multi-factor

287
00:09:39,519 --> 00:09:41,760
um you know they might set up their

288
00:09:41,760 --> 00:09:43,760
application in such a way that

289
00:09:43,760 --> 00:09:46,480
um you know it passes the test from the

290
00:09:46,480 --> 00:09:47,920
security team one time but then they go

291
00:09:47,920 --> 00:09:49,519
back in and make a configuration change

292
00:09:49,519 --> 00:09:50,320
later

293
00:09:50,320 --> 00:09:52,080
and they're suddenly allowing local

294
00:09:52,080 --> 00:09:54,640
authentication instead of

295
00:09:54,640 --> 00:09:57,680
using that single sign-on

296
00:09:57,680 --> 00:10:00,720
so they're now bypassing or

297
00:10:00,720 --> 00:10:04,399
not requiring that second factor and

298
00:10:04,399 --> 00:10:06,320
your security security team might not be

299
00:10:06,320 --> 00:10:07,600
aware of that

300
00:10:07,600 --> 00:10:11,920
um so uh moving on to the threats itself

301
00:10:11,920 --> 00:10:15,040
against the system uh i kind of went out

302
00:10:15,040 --> 00:10:16,720
and asked my red team friends

303
00:10:16,720 --> 00:10:19,760
you know what do you do

304
00:10:19,760 --> 00:10:20,959
it's supposed to you know protect these

305
00:10:20,959 --> 00:10:22,959
systems so well is red team still able

306
00:10:22,959 --> 00:10:23,600
to

307
00:10:23,600 --> 00:10:25,839
get into accounts and they said one of

308
00:10:25,839 --> 00:10:28,079
their favorite things is when they're

309
00:10:28,079 --> 00:10:29,920
going out and doing a pen test against a

310
00:10:29,920 --> 00:10:31,600
company where they're rolling out their

311
00:10:31,600 --> 00:10:33,600
mfa system for the first time

312
00:10:33,600 --> 00:10:36,800
they find those people that are like pto

313
00:10:36,800 --> 00:10:40,480
or not around

314
00:10:40,480 --> 00:10:42,079
and they have go and they focus on those

315
00:10:42,079 --> 00:10:44,240
people to get their passwords

316
00:10:44,240 --> 00:10:46,320
and then the system because it's brand

317
00:10:46,320 --> 00:10:47,519
new they haven't

318
00:10:47,519 --> 00:10:49,839
the actual user hasn't enrolled their

319
00:10:49,839 --> 00:10:51,360
personal device yet

320
00:10:51,360 --> 00:10:53,279
it then asks them for enrollment because

321
00:10:53,279 --> 00:10:55,360
the password was correct

322
00:10:55,360 --> 00:10:58,160
so second factor's not set up yet the

323
00:10:58,160 --> 00:10:59,920
red team just adds their red team phone

324
00:10:59,920 --> 00:11:00,800
to that person

325
00:11:00,800 --> 00:11:03,680
that they've managed to pop um the

326
00:11:03,680 --> 00:11:04,880
actual user doesn't notice because

327
00:11:04,880 --> 00:11:06,480
they're on vacation or whatever

328
00:11:06,480 --> 00:11:09,680
uh kind of some sneaky tactics there um

329
00:11:09,680 --> 00:11:10,959
another thing that you can have happen i

330
00:11:10,959 --> 00:11:12,720
already mentioned was the

331
00:11:12,720 --> 00:11:15,440
brute force notification or calls your

332
00:11:15,440 --> 00:11:16,079
users

333
00:11:16,079 --> 00:11:18,079
users get exhausted just having their

334
00:11:18,079 --> 00:11:19,760
phone ring they just want it to stop so

335
00:11:19,760 --> 00:11:21,440
they click the button and say yes

336
00:11:21,440 --> 00:11:24,320
go ahead sure if they don't have a way

337
00:11:24,320 --> 00:11:25,600
to report

338
00:11:25,600 --> 00:11:27,839
fraud or to report spam or anything like

339
00:11:27,839 --> 00:11:29,360
that happening

340
00:11:29,360 --> 00:11:30,959
you know they're just going to accept

341
00:11:30,959 --> 00:11:32,560
just make it stop

342
00:11:32,560 --> 00:11:34,399
and then the other thing that can happen

343
00:11:34,399 --> 00:11:35,760
is you can dos

344
00:11:35,760 --> 00:11:38,720
an mfa server

345
00:11:39,440 --> 00:11:41,360
if it is set up in a fail open

346
00:11:41,360 --> 00:11:43,120
configuration so if we kind of go back

347
00:11:43,120 --> 00:11:43,519
to

348
00:11:43,519 --> 00:11:47,120
our idea of the flowchart here where

349
00:11:47,120 --> 00:11:49,440
it goes where the user tries to

350
00:11:49,440 --> 00:11:51,120
authenticate into an application it hits

351
00:11:51,120 --> 00:11:53,760
the primary

352
00:11:53,839 --> 00:11:57,040
authentication factor and then tries to

353
00:11:57,040 --> 00:11:57,760
reach out to

354
00:11:57,760 --> 00:12:00,560
a external server to get that second

355
00:12:00,560 --> 00:12:01,360
factor

356
00:12:01,360 --> 00:12:04,160
if you were to have local access maybe

357
00:12:04,160 --> 00:12:04,800
be able to

358
00:12:04,800 --> 00:12:07,279
set a hosts file or maybe be able to

359
00:12:07,279 --> 00:12:09,839
change internal dns records

360
00:12:09,839 --> 00:12:12,160
and you cause that connection to the

361
00:12:12,160 --> 00:12:13,600
external

362
00:12:13,600 --> 00:12:16,240
validation server you can have a fail

363
00:12:16,240 --> 00:12:18,399
and and the system is set to fail open

364
00:12:18,399 --> 00:12:20,240
um it just bypasses the second factor

365
00:12:20,240 --> 00:12:22,000
completely so

366
00:12:22,000 --> 00:12:25,839
that's another threat

367
00:12:26,560 --> 00:12:28,240
against things that they don't tell you

368
00:12:28,240 --> 00:12:30,160
um or the things that i haven't heard

369
00:12:30,160 --> 00:12:31,760
talked about a lot is

370
00:12:31,760 --> 00:12:34,800
that there are logs

371
00:12:36,480 --> 00:12:40,480
these mfa systems are are logging um

372
00:12:40,480 --> 00:12:41,839
all the time and you can go in and you

373
00:12:41,839 --> 00:12:44,240
can read those logs why do we want logs

374
00:12:44,240 --> 00:12:44,880
well

375
00:12:44,880 --> 00:12:48,000
logs tell me things um i i like to

376
00:12:48,000 --> 00:12:49,839
listen to logs i like to go out

377
00:12:49,839 --> 00:12:52,160
and explore and see what they have to

378
00:12:52,160 --> 00:12:53,760
say to me and see what they have to say

379
00:12:53,760 --> 00:12:54,240
about

380
00:12:54,240 --> 00:12:56,079
what my users are doing and what's going

381
00:12:56,079 --> 00:12:57,519
on the company and what

382
00:12:57,519 --> 00:13:00,560
what sort of systems um are going wrong

383
00:13:00,560 --> 00:13:04,160
or haven't been ex inspected or

384
00:13:04,160 --> 00:13:07,279
not put in place correctly so listen to

385
00:13:07,279 --> 00:13:08,240
your logs

386
00:13:08,240 --> 00:13:10,399
um i'll kind of show you what i have

387
00:13:10,399 --> 00:13:11,839
learned from the logs and

388
00:13:11,839 --> 00:13:14,800
how i've learned to listen to them so

389
00:13:14,800 --> 00:13:16,480
kind of like the

390
00:13:16,480 --> 00:13:19,839
the first step in the um in the logs is

391
00:13:19,839 --> 00:13:20,880
our first section

392
00:13:20,880 --> 00:13:22,480
is going to be the access device and

393
00:13:22,480 --> 00:13:24,320
going through and sometimes this isn't

394
00:13:24,320 --> 00:13:25,440
always clear

395
00:13:25,440 --> 00:13:27,839
um certain applications can show up as

396
00:13:27,839 --> 00:13:29,120
browsers even though they're not

397
00:13:29,120 --> 00:13:30,320
browsers

398
00:13:30,320 --> 00:13:32,000
i've seen things like the jabber

399
00:13:32,000 --> 00:13:34,560
application show up as internet explorer

400
00:13:34,560 --> 00:13:36,720
so it's engine is probably running on

401
00:13:36,720 --> 00:13:39,839
that but it's certainly not ie

402
00:13:39,839 --> 00:13:42,480
and then other

403
00:13:44,000 --> 00:13:47,199
fun thing end of life you can see what

404
00:13:47,199 --> 00:13:49,120
version of windows users are logging in

405
00:13:49,120 --> 00:13:51,199
as you know go hunt go find

406
00:13:51,199 --> 00:13:53,360
um and see if anybody's still running

407
00:13:53,360 --> 00:13:54,720
windows 7

408
00:13:54,720 --> 00:13:58,079
if that's expected or not the next chunk

409
00:13:58,079 --> 00:14:00,320
that i'm going to take a look at here is

410
00:14:00,320 --> 00:14:02,079
the device itself this is the device

411
00:14:02,079 --> 00:14:03,440
that the user is

412
00:14:03,440 --> 00:14:06,560
authenticating with either a phone

413
00:14:06,560 --> 00:14:08,160
number

414
00:14:08,160 --> 00:14:10,880
or a device name or it can be both and

415
00:14:10,880 --> 00:14:12,720
then the event type is going to be an

416
00:14:12,720 --> 00:14:14,160
authentication

417
00:14:14,160 --> 00:14:17,360
there are event types for admin um if an

418
00:14:17,360 --> 00:14:19,279
admin goes in and adds another device or

419
00:14:19,279 --> 00:14:20,320
maybe they remove

420
00:14:20,320 --> 00:14:22,320
another device from a user's account if

421
00:14:22,320 --> 00:14:24,399
the if you don't have self enrollment

422
00:14:24,399 --> 00:14:27,360
um if your it has to go in and enroll

423
00:14:27,360 --> 00:14:28,560
going back and looking through those

424
00:14:28,560 --> 00:14:30,070
logs can be interesting as well

425
00:14:30,070 --> 00:14:31,360
[Music]

426
00:14:31,360 --> 00:14:33,440
and then the factor is how the device

427
00:14:33,440 --> 00:14:35,760
was used so in this case we see that

428
00:14:35,760 --> 00:14:37,519
the factor is a push and that

429
00:14:37,519 --> 00:14:38,800
immediately tells us

430
00:14:38,800 --> 00:14:41,040
that this device that this phone number

431
00:14:41,040 --> 00:14:42,480
is going to be a cell phone

432
00:14:42,480 --> 00:14:43,920
because you can't send a push to a

433
00:14:43,920 --> 00:14:47,360
landline so that's kind of interesting

434
00:14:47,360 --> 00:14:50,959
um the next piece in like

435
00:14:50,959 --> 00:14:54,000
is uh is taking a look at the host in

436
00:14:54,000 --> 00:14:55,440
this case it's going to be the

437
00:14:55,440 --> 00:14:57,120
authentication server so the

438
00:14:57,120 --> 00:14:58,800
server that you are actually doing the

439
00:14:58,800 --> 00:15:00,880
authentication against

440
00:15:00,880 --> 00:15:03,040
not really an interesting detail in this

441
00:15:03,040 --> 00:15:04,079
case um

442
00:15:04,079 --> 00:15:06,079
integration i've seen different things

443
00:15:06,079 --> 00:15:08,000
such as like sso which is your single

444
00:15:08,000 --> 00:15:09,199
sign-on

445
00:15:09,199 --> 00:15:13,519
vpn your virtual private network ssh

446
00:15:13,519 --> 00:15:15,600
and then ip is where the traffic came

447
00:15:15,600 --> 00:15:17,519
from and you want to remember that your

448
00:15:17,519 --> 00:15:18,560
ip is going to be

449
00:15:18,560 --> 00:15:21,600
integration dependent so you're going to

450
00:15:21,600 --> 00:15:22,399
need to

451
00:15:22,399 --> 00:15:26,079
to look at ip and integration together

452
00:15:26,079 --> 00:15:27,519
like the ip address that they're coming

453
00:15:27,519 --> 00:15:29,519
from when they log into a vpn

454
00:15:29,519 --> 00:15:31,519
might be different than after they're

455
00:15:31,519 --> 00:15:32,720
inside of your network

456
00:15:32,720 --> 00:15:34,399
and then they then leave your network to

457
00:15:34,399 --> 00:15:36,639
go to an sso

458
00:15:36,639 --> 00:15:39,759
authentication that ip might change to

459
00:15:39,759 --> 00:15:42,880
your company's public ip or something of

460
00:15:42,880 --> 00:15:45,279
that nature

461
00:15:45,279 --> 00:15:48,320
next piece in log listening

462
00:15:48,320 --> 00:15:50,880
again is looking at the ip address and

463
00:15:50,880 --> 00:15:52,079
the location

464
00:15:52,079 --> 00:15:55,360
but that location needs validation um i

465
00:15:55,360 --> 00:15:58,399
used to work as a firewall engineer at

466
00:15:58,399 --> 00:15:59,120
an ia

467
00:15:59,120 --> 00:16:02,240
then an isp um and i had a customer call

468
00:16:02,240 --> 00:16:03,600
in one day and they were saying

469
00:16:03,600 --> 00:16:06,639
hey um my

470
00:16:06,639 --> 00:16:08,399
business partner is blocking my traffic

471
00:16:08,399 --> 00:16:10,720
they said that my traffic is coming from

472
00:16:10,720 --> 00:16:12,240
like costa rica

473
00:16:12,240 --> 00:16:14,880
and i don't have any business locations

474
00:16:14,880 --> 00:16:17,120
in costa rica can you take a look and

475
00:16:17,120 --> 00:16:19,279
i looked at the customer's account and

476
00:16:19,279 --> 00:16:20,560
i'm like that's weird you're

477
00:16:20,560 --> 00:16:22,160
you're on the new york firewall what's

478
00:16:22,160 --> 00:16:24,160
going on here and

479
00:16:24,160 --> 00:16:25,680
i jumped on that new york firewall i

480
00:16:25,680 --> 00:16:26,880
started doing a packet capture sure

481
00:16:26,880 --> 00:16:27,600
enough his

482
00:16:27,600 --> 00:16:30,399
traffic is leaving new york um no

483
00:16:30,399 --> 00:16:31,680
question about it that

484
00:16:31,680 --> 00:16:34,079
ip is physically you know located and

485
00:16:34,079 --> 00:16:35,519
everything going out of a new york

486
00:16:35,519 --> 00:16:36,720
firewall

487
00:16:36,720 --> 00:16:38,720
but the registration on the internet for

488
00:16:38,720 --> 00:16:40,160
whatever reason the isp

489
00:16:40,160 --> 00:16:42,560
still had it registered to costa rica

490
00:16:42,560 --> 00:16:43,199
block

491
00:16:43,199 --> 00:16:45,920
so sometimes those things are really out

492
00:16:45,920 --> 00:16:47,839
of whack and they need to be readjusted

493
00:16:47,839 --> 00:16:51,040
i go uh dub

494
00:16:51,040 --> 00:16:54,319
i can for that

495
00:16:55,600 --> 00:16:59,759
uh the next is

496
00:16:59,759 --> 00:17:01,279
seeing if the user is adding a new

497
00:17:01,279 --> 00:17:04,079
device it with the new enrollment piece

498
00:17:04,079 --> 00:17:06,559
um if it's true they're adding a device

499
00:17:06,559 --> 00:17:08,000
there if it's false they're not

500
00:17:08,000 --> 00:17:09,679
um it can be interesting when you see

501
00:17:09,679 --> 00:17:11,359
users authenticating with a brand new

502
00:17:11,359 --> 00:17:12,640
device that might set up

503
00:17:12,640 --> 00:17:15,199
set off some alarm bells when you go and

504
00:17:15,199 --> 00:17:16,839
look through this

505
00:17:16,839 --> 00:17:19,280
um the reason piece is going to be

506
00:17:19,280 --> 00:17:21,119
factor dependent and then the result of

507
00:17:21,119 --> 00:17:21,520
its

508
00:17:21,520 --> 00:17:24,480
success or failure

509
00:17:24,959 --> 00:17:28,000
and the actual authentication uh the

510
00:17:28,000 --> 00:17:30,960
next little piece in the thing

511
00:17:30,960 --> 00:17:32,400
is that they are going to be that you're

512
00:17:32,400 --> 00:17:34,080
going to need more data um you can't

513
00:17:34,080 --> 00:17:36,160
just look at these logs at face value

514
00:17:36,160 --> 00:17:37,840
as much as they tell you kind of that

515
00:17:37,840 --> 00:17:39,200
face value there's a little bit of

516
00:17:39,200 --> 00:17:40,640
supplementation that hey

517
00:17:40,640 --> 00:17:44,320
i have found um is very useful to have

518
00:17:44,320 --> 00:17:45,679
when you start digging through these

519
00:17:45,679 --> 00:17:47,200
logs

520
00:17:47,200 --> 00:17:49,919
so looking at things like the result

521
00:17:49,919 --> 00:17:50,960
like i say the whole

522
00:17:50,960 --> 00:17:55,200
spamming or brute forcing your your mfa

523
00:17:55,200 --> 00:17:56,799
you want to have access to that first

524
00:17:56,799 --> 00:17:58,480
factor to those logs too

525
00:17:58,480 --> 00:18:01,760
take a look at um you know ad your aaa

526
00:18:01,760 --> 00:18:02,400
or your

527
00:18:02,400 --> 00:18:04,960
single sign-on logs see if they were

528
00:18:04,960 --> 00:18:06,400
brute forced

529
00:18:06,400 --> 00:18:09,520
on the first factor or if they were

530
00:18:09,520 --> 00:18:10,640
successful

531
00:18:10,640 --> 00:18:13,440
with one shot and where that came from

532
00:18:13,440 --> 00:18:14,240
um

533
00:18:14,240 --> 00:18:15,760
see if there was more than one user that

534
00:18:15,760 --> 00:18:18,480
is experience

535
00:18:20,000 --> 00:18:22,000
it's saying successful you might have

536
00:18:22,000 --> 00:18:24,000
your passwords dumped somewhere

537
00:18:24,000 --> 00:18:25,440
and need all these users to change their

538
00:18:25,440 --> 00:18:27,200
passwords

539
00:18:27,200 --> 00:18:30,000
the next piece to look at um is if you

540
00:18:30,000 --> 00:18:31,679
have an employee directory is to

541
00:18:31,679 --> 00:18:32,720
incorporate that

542
00:18:32,720 --> 00:18:36,000
into your analysis um does alice

543
00:18:36,000 --> 00:18:37,600
you know does she have a registered

544
00:18:37,600 --> 00:18:39,200
phone number with your company for

545
00:18:39,200 --> 00:18:41,919
for 408 is that her desk phone is it her

546
00:18:41,919 --> 00:18:43,679
desk phone in new york

547
00:18:43,679 --> 00:18:45,520
do you even have an office in new york

548
00:18:45,520 --> 00:18:46,880
just you know

549
00:18:46,880 --> 00:18:49,760
to take a look at things like that the

550
00:18:49,760 --> 00:18:50,480
next piece

551
00:18:50,480 --> 00:18:53,280
is have if you have a user device

552
00:18:53,280 --> 00:18:54,320
registry

553
00:18:54,320 --> 00:18:58,240
um did it issue alice a windows laptop

554
00:18:58,240 --> 00:19:00,480
or did they issue her a mac laptop and

555
00:19:00,480 --> 00:19:02,000
this is really setting off

556
00:19:02,000 --> 00:19:05,120
alarm bells in your head

557
00:19:05,200 --> 00:19:07,919
um the next piece is if you can do an

558
00:19:07,919 --> 00:19:08,640
internal

559
00:19:08,640 --> 00:19:10,640
ns lookup kind of going back to the idea

560
00:19:10,640 --> 00:19:12,320
of the locations

561
00:19:12,320 --> 00:19:15,520
might not match up but if you have

562
00:19:15,520 --> 00:19:18,000
a way to look up those ip addresses and

563
00:19:18,000 --> 00:19:19,600
it comes back and it says yeah oh yeah

564
00:19:19,600 --> 00:19:20,080
this is

565
00:19:20,080 --> 00:19:22,080
the nat address for a corporate new york

566
00:19:22,080 --> 00:19:24,160
office excellent you've proved another

567
00:19:24,160 --> 00:19:25,360
point

568
00:19:25,360 --> 00:19:27,120
you've got that second data set to

569
00:19:27,120 --> 00:19:28,640
validate your first

570
00:19:28,640 --> 00:19:31,280
data piece

571
00:19:32,240 --> 00:19:33,840
and then any sort of other attribution

572
00:19:33,840 --> 00:19:36,160
data sources that you have or that you

573
00:19:36,160 --> 00:19:36,960
can

574
00:19:36,960 --> 00:19:41,840
look at if all else fails go out

575
00:19:41,919 --> 00:19:44,320
and it's not in your user directory

576
00:19:44,320 --> 00:19:45,280
anywhere

577
00:19:45,280 --> 00:19:47,600
you have no idea what it is it might

578
00:19:47,600 --> 00:19:50,559
even show that it belongs to

579
00:19:50,559 --> 00:19:52,160
say you have a contractor and it's their

580
00:19:52,160 --> 00:19:54,160
third party contracting company and it's

581
00:19:54,160 --> 00:19:54,960
an office

582
00:19:54,960 --> 00:19:58,080
somewhere else um finding those extra

583
00:19:58,080 --> 00:19:58,559
clues

584
00:19:58,559 --> 00:20:02,080
using other data sources so the next

585
00:20:02,080 --> 00:20:02,480
piece

586
00:20:02,480 --> 00:20:05,760
is kind of giving yourself an idea of

587
00:20:05,760 --> 00:20:07,520
what is a baseline what would be normal

588
00:20:07,520 --> 00:20:08,880
traffic

589
00:20:08,880 --> 00:20:11,280
for your users what would you expect to

590
00:20:11,280 --> 00:20:13,440
see

591
00:20:14,640 --> 00:20:16,400
how many devices do you even expect your

592
00:20:16,400 --> 00:20:17,760
users to have

593
00:20:17,760 --> 00:20:18,960
are they going to have a cell phone are

594
00:20:18,960 --> 00:20:20,640
they going to have a desk phone are they

595
00:20:20,640 --> 00:20:23,039
then going to have like a ub key

596
00:20:23,039 --> 00:20:25,440
or any sort of other authentication

597
00:20:25,440 --> 00:20:26,640
methods

598
00:20:26,640 --> 00:20:28,400
do they have a legitimate reason to have

599
00:20:28,400 --> 00:20:29,919
anything else

600
00:20:29,919 --> 00:20:31,360
on their corporate account you know did

601
00:20:31,360 --> 00:20:32,880
you issue them a corporate cell phone

602
00:20:32,880 --> 00:20:33,760
and they should only be

603
00:20:33,760 --> 00:20:35,440
using that are you going to allow

604
00:20:35,440 --> 00:20:37,679
personal cell phones

605
00:20:37,679 --> 00:20:39,360
how many locations do you expect to be

606
00:20:39,360 --> 00:20:41,760
normal for your workforce

607
00:20:41,760 --> 00:20:43,440
are you only expecting to see people log

608
00:20:43,440 --> 00:20:45,520
in from the us

609
00:20:45,520 --> 00:20:47,120
you know is anybody allowed on site

610
00:20:47,120 --> 00:20:48,880
should anybody actually be using their

611
00:20:48,880 --> 00:20:50,480
office landline right now to

612
00:20:50,480 --> 00:20:52,159
authenticate

613
00:20:52,159 --> 00:20:54,080
uh so that could be interesting things

614
00:20:54,080 --> 00:20:56,320
to kind of get an idea of what your your

615
00:20:56,320 --> 00:20:57,039
baseline

616
00:20:57,039 --> 00:21:00,880
is is gonna be um

617
00:21:00,880 --> 00:21:03,280
so kind of away with the vlog listening

618
00:21:03,280 --> 00:21:04,240
and kind of like the more

619
00:21:04,240 --> 00:21:05,919
boring stuff i'm going to start digging

620
00:21:05,919 --> 00:21:07,760
into the stuff that i discovered

621
00:21:07,760 --> 00:21:10,640
um this for me is like the real fun

622
00:21:10,640 --> 00:21:11,440
going through

623
00:21:11,440 --> 00:21:13,520
um some of these scenarios um some of

624
00:21:13,520 --> 00:21:15,039
these are real cases that i actually

625
00:21:15,039 --> 00:21:16,000
worked some of them i

626
00:21:16,000 --> 00:21:18,400
embellished a little bit some of them i

627
00:21:18,400 --> 00:21:20,159
kind of blended together

628
00:21:20,159 --> 00:21:23,760
with some of the local security folks in

629
00:21:23,760 --> 00:21:24,799
the area where i heard

630
00:21:24,799 --> 00:21:26,240
kind of some different stories from them

631
00:21:26,240 --> 00:21:28,640
as well um

632
00:21:28,640 --> 00:21:32,080
so stepping through this um when i first

633
00:21:32,080 --> 00:21:32,799
went out and

634
00:21:32,799 --> 00:21:35,360
and started looking um after talking to

635
00:21:35,360 --> 00:21:36,720
my red team people

636
00:21:36,720 --> 00:21:39,840
um and the whole concept of you know red

637
00:21:39,840 --> 00:21:41,200
team is adding their phone number to

638
00:21:41,200 --> 00:21:42,720
somebody else's account that's kind of

639
00:21:42,720 --> 00:21:43,280
what

640
00:21:43,280 --> 00:21:45,039
what drove me in my directions when i

641
00:21:45,039 --> 00:21:46,559
went hunting so that's

642
00:21:46,559 --> 00:21:49,679
kind of what led me to multiple users

643
00:21:49,679 --> 00:21:51,630
on one phone so

644
00:21:51,630 --> 00:21:53,039
[Music]

645
00:21:53,039 --> 00:21:55,039
kind of taking a look at these logs and

646
00:21:55,039 --> 00:21:56,080
kind of looking at them

647
00:21:56,080 --> 00:21:59,840
face value

648
00:22:01,440 --> 00:22:03,600
kind of and we're just gonna go through

649
00:22:03,600 --> 00:22:05,360
here and we have a device with an

650
00:22:05,360 --> 00:22:06,720
extension

651
00:22:06,720 --> 00:22:10,480
it was successful it was user approved

652
00:22:10,480 --> 00:22:12,559
but there's six people on this one phone

653
00:22:12,559 --> 00:22:13,520
number

654
00:22:13,520 --> 00:22:14,960
uh they're all help desk agents and

655
00:22:14,960 --> 00:22:17,120
they're all in bangalore okay

656
00:22:17,120 --> 00:22:19,360
well let's let's take a deeper dive um

657
00:22:19,360 --> 00:22:20,559
it looks like they all have the same

658
00:22:20,559 --> 00:22:22,320
manager and they all have the same hire

659
00:22:22,320 --> 00:22:23,520
date

660
00:22:23,520 --> 00:22:25,679
we called the phone number an extension

661
00:22:25,679 --> 00:22:27,200
and it plays a tone

662
00:22:27,200 --> 00:22:28,720
and that's kind of interesting so let's

663
00:22:28,720 --> 00:22:31,600
take that tone and just run it through

664
00:22:31,600 --> 00:22:33,200
the translator real quick oh it's

665
00:22:33,200 --> 00:22:35,520
pressing the number one

666
00:22:35,520 --> 00:22:38,880
automatically so that's interesting

667
00:22:38,880 --> 00:22:40,720
they have automatic authentication going

668
00:22:40,720 --> 00:22:42,720
on for for the six people

669
00:22:42,720 --> 00:22:44,720
to this extension so let's email the

670
00:22:44,720 --> 00:22:47,200
manager

671
00:22:48,640 --> 00:22:50,080
oh people are allowed to have a cell

672
00:22:50,080 --> 00:22:52,320
phone or a mobile phone on that help

673
00:22:52,320 --> 00:22:54,080
desk agent floor

674
00:22:54,080 --> 00:22:55,440
so we're going to go ahead and ship them

675
00:22:55,440 --> 00:22:57,760
all hard tokens so that they can all use

676
00:22:57,760 --> 00:22:59,679
that method to authenticate instead of

677
00:22:59,679 --> 00:23:00,080
all

678
00:23:00,080 --> 00:23:02,480
sharing a phone that is basically

679
00:23:02,480 --> 00:23:04,480
bypassing your multi-factor because it's

680
00:23:04,480 --> 00:23:05,440
automatically

681
00:23:05,440 --> 00:23:08,480
playing a tone um

682
00:23:08,480 --> 00:23:11,679
our next piece is um we're gonna um

683
00:23:11,679 --> 00:23:15,360
investigate into a device that is

684
00:23:15,360 --> 00:23:17,520
uh nicely named for us called grace's

685
00:23:17,520 --> 00:23:18,960
landline

686
00:23:18,960 --> 00:23:20,480
but three people logging in we have

687
00:23:20,480 --> 00:23:22,799
trudy frank and grace and well two of

688
00:23:22,799 --> 00:23:23,919
those people are not

689
00:23:23,919 --> 00:23:26,000
grace so what are they doing on grace's

690
00:23:26,000 --> 00:23:27,120
landline

691
00:23:27,120 --> 00:23:29,200
um we'll take a look at the titles here

692
00:23:29,200 --> 00:23:30,320
okay one's hr

693
00:23:30,320 --> 00:23:32,480
one sales engineer and then we have

694
00:23:32,480 --> 00:23:34,080
laptop support

695
00:23:34,080 --> 00:23:36,640
that's interesting so grace is doing

696
00:23:36,640 --> 00:23:38,480
laptop support but she's doing it in a

697
00:23:38,480 --> 00:23:40,240
shadow i.t method

698
00:23:40,240 --> 00:23:43,360
she's added uh her phone number

699
00:23:43,360 --> 00:23:47,279
to trudy and frank's um

700
00:23:47,279 --> 00:23:49,440
mfa system and also written down their

701
00:23:49,440 --> 00:23:50,400
passwords

702
00:23:50,400 --> 00:23:52,880
so if she's doing this laptop support

703
00:23:52,880 --> 00:23:54,640
and the laptop keeps rebooting

704
00:23:54,640 --> 00:23:56,640
she can just log in as them and doesn't

705
00:23:56,640 --> 00:23:57,919
have to worry about it

706
00:23:57,919 --> 00:24:00,400
it doesn't have to bother trudy or frank

707
00:24:00,400 --> 00:24:01,520
um

708
00:24:01,520 --> 00:24:03,679
so we kind of ask her manager and talk

709
00:24:03,679 --> 00:24:05,520
to people about it and we take a look at

710
00:24:05,520 --> 00:24:06,240
those

711
00:24:06,240 --> 00:24:09,760
those help desk tickets that she was my

712
00:24:09,760 --> 00:24:10,640
stamps match

713
00:24:10,640 --> 00:24:12,400
those time frames when they log in so

714
00:24:12,400 --> 00:24:13,840
it's okay she wasn't doing anything

715
00:24:13,840 --> 00:24:15,520
malicious she was just trying to

716
00:24:15,520 --> 00:24:18,320
do her job um we go in and we confirm

717
00:24:18,320 --> 00:24:18,799
that

718
00:24:18,799 --> 00:24:20,240
that trudy and frank change their

719
00:24:20,240 --> 00:24:22,400
passwords and that we've removed grace's

720
00:24:22,400 --> 00:24:24,559
landline from their accounts

721
00:24:24,559 --> 00:24:25,840
and then we have a conversation with

722
00:24:25,840 --> 00:24:28,240
management and we kind of go through and

723
00:24:28,240 --> 00:24:30,640
we're like how can we make this process

724
00:24:30,640 --> 00:24:32,320
easier in such a way that we're not

725
00:24:32,320 --> 00:24:34,799
compromising trudy or frank

726
00:24:34,799 --> 00:24:38,400
um or anybody else in this process

727
00:24:38,400 --> 00:24:41,360
so i also give this example because i

728
00:24:41,360 --> 00:24:43,039
like to show that

729
00:24:43,039 --> 00:24:45,440
you can actually your users might have

730
00:24:45,440 --> 00:24:48,000
the ability to change the name of their

731
00:24:48,000 --> 00:24:50,400
their phone um in order to make it more

732
00:24:50,400 --> 00:24:52,880
convenient for them or

733
00:24:52,880 --> 00:24:55,919
just kind of rename their device give it

734
00:24:55,919 --> 00:24:56,880
a nickname if they have

735
00:24:56,880 --> 00:24:59,279
multiple devices and this is kind of

736
00:24:59,279 --> 00:25:01,200
where uh i admit when i found this out i

737
00:25:01,200 --> 00:25:02,240
went and i changed

738
00:25:02,240 --> 00:25:05,520
the uh the name of my phone uh on my own

739
00:25:05,520 --> 00:25:07,039
device where i log in to work

740
00:25:07,039 --> 00:25:09,360
and then as i was showing my co-workers

741
00:25:09,360 --> 00:25:11,360
how to go in and do this analysis

742
00:25:11,360 --> 00:25:14,480
um i kind of a little guilty

743
00:25:14,480 --> 00:25:16,400
uh trolling that i do here because

744
00:25:16,400 --> 00:25:17,760
whenever uh

745
00:25:17,760 --> 00:25:19,440
anybody goes and looks at my logs they

746
00:25:19,440 --> 00:25:28,480
will see that i always log in okay

747
00:25:28,480 --> 00:25:31,440
so the next piece is going to be the

748
00:25:31,440 --> 00:25:32,320
next thing that i did

749
00:25:32,320 --> 00:25:34,320
is i kind of reversed it where i'm

750
00:25:34,320 --> 00:25:35,360
looking for

751
00:25:35,360 --> 00:25:38,640
one user that has multiple phones so

752
00:25:38,640 --> 00:25:41,760
kind of some examples here um we'll dig

753
00:25:41,760 --> 00:25:42,320
in

754
00:25:42,320 --> 00:25:45,679
a little bit further into alice here

755
00:25:45,679 --> 00:25:48,960
she's a manager an employee um

756
00:25:48,960 --> 00:25:52,480
she has three login phones

757
00:25:54,880 --> 00:25:57,120
and phones are actually the same phone

758
00:25:57,120 --> 00:25:59,440
number but they're named different

759
00:25:59,440 --> 00:26:02,159
so uh looking into it a little bit

760
00:26:02,159 --> 00:26:04,159
further proving out that it's benign

761
00:26:04,159 --> 00:26:06,640
uh alice previously had an unlabeled

762
00:26:06,640 --> 00:26:07,679
cell phone

763
00:26:07,679 --> 00:26:09,360
uh she went out and she got a new iphone

764
00:26:09,360 --> 00:26:12,000
she previously had an android

765
00:26:12,000 --> 00:26:14,559
the mfa system had a code update where

766
00:26:14,559 --> 00:26:16,400
when she registered her android phone

767
00:26:16,400 --> 00:26:17,679
with that phone number

768
00:26:17,679 --> 00:26:20,000
it wasn't recording the device name on

769
00:26:20,000 --> 00:26:20,960
registration

770
00:26:20,960 --> 00:26:22,960
but there was a software update and now

771
00:26:22,960 --> 00:26:24,480
it's grabbing that

772
00:26:24,480 --> 00:26:25,760
that name of that phone she didn't

773
00:26:25,760 --> 00:26:27,360
create a custom or anything so that's

774
00:26:27,360 --> 00:26:28,720
kind of interesting

775
00:26:28,720 --> 00:26:31,440
um so it's just the the mfa system

776
00:26:31,440 --> 00:26:32,799
decided to re-label it when she

777
00:26:32,799 --> 00:26:33,679
re-authentic

778
00:26:33,679 --> 00:26:36,320
when she re-um brought that in and

779
00:26:36,320 --> 00:26:37,440
installed the app on

780
00:26:37,440 --> 00:26:41,360
the iphone so that's benign

781
00:26:41,360 --> 00:26:44,240
uh we can move on to it where we have

782
00:26:44,240 --> 00:26:45,760
bob's engineer

783
00:26:45,760 --> 00:26:49,679
uh who's receiving his authentication

784
00:26:49,679 --> 00:26:53,120
as a mobile code a push and a phone call

785
00:26:53,120 --> 00:26:55,760
we have his registered mobile number and

786
00:26:55,760 --> 00:26:56,880
his work

787
00:26:56,880 --> 00:26:59,120
number but when we look at these five

788
00:26:59,120 --> 00:27:00,400
login phones

789
00:27:00,400 --> 00:27:02,320
none of them actually match up to what

790
00:27:02,320 --> 00:27:04,240
we have on file for him so this is very

791
00:27:04,240 --> 00:27:05,440
suspect

792
00:27:05,440 --> 00:27:08,480
um so we also take a look at some of the

793
00:27:08,480 --> 00:27:10,080
time stamps for when he's logging in and

794
00:27:10,080 --> 00:27:10,559
they're

795
00:27:10,559 --> 00:27:13,360
happening at all hours of the day when

796
00:27:13,360 --> 00:27:14,320
we contract

797
00:27:14,320 --> 00:27:16,720
contact bob's manager we find out that

798
00:27:16,720 --> 00:27:17,360
he's

799
00:27:17,360 --> 00:27:18,840
outsourcing his work to other

800
00:27:18,840 --> 00:27:21,360
contractors bob is actually

801
00:27:21,360 --> 00:27:23,520
five people and none of these five

802
00:27:23,520 --> 00:27:24,720
people we have on record

803
00:27:24,720 --> 00:27:29,360
so bob doesn't work here anymore

804
00:27:30,159 --> 00:27:31,840
the next piece we're going to look at

805
00:27:31,840 --> 00:27:34,720
for kind of deep diving into the law

806
00:27:34,720 --> 00:27:37,200
bugs in

807
00:27:38,720 --> 00:27:41,520
something to happen plus crazy scenarios

808
00:27:41,520 --> 00:27:44,960
so we're going to look at our user ivan

809
00:27:44,960 --> 00:27:47,919
we have a mobile a direct mobile number

810
00:27:47,919 --> 00:27:49,679
for him on file and a work number for

811
00:27:49,679 --> 00:27:50,880
him on file

812
00:27:50,880 --> 00:27:54,320
um we have what looks like his mobile

813
00:27:54,320 --> 00:27:58,158
logging in and that is

814
00:27:58,559 --> 00:28:01,520
um and then it looks like he's had five

815
00:28:01,520 --> 00:28:03,120
um

816
00:28:03,120 --> 00:28:05,440
attempts against his account so let's

817
00:28:05,440 --> 00:28:06,799
take a closer look at that we're gonna

818
00:28:06,799 --> 00:28:09,679
verify this out as benign

819
00:28:09,679 --> 00:28:12,080
his login attempts appear to have random

820
00:28:12,080 --> 00:28:12,960
timing

821
00:28:12,960 --> 00:28:14,799
there's not any sort of pattern or

822
00:28:14,799 --> 00:28:16,240
anything to them

823
00:28:16,240 --> 00:28:18,159
he has a successful login after the

824
00:28:18,159 --> 00:28:19,679
failures on his

825
00:28:19,679 --> 00:28:21,600
on a registered device that we know

826
00:28:21,600 --> 00:28:24,639
about so that's good

827
00:28:24,799 --> 00:28:27,200
we're going to go manager and oh we take

828
00:28:27,200 --> 00:28:29,039
a closer look at that

829
00:28:29,039 --> 00:28:30,559
that strange number that we saw

830
00:28:30,559 --> 00:28:32,000
attempting to log in it turned out that

831
00:28:32,000 --> 00:28:33,039
he typoed

832
00:28:33,039 --> 00:28:36,240
his desk phone number um and ivan's

833
00:28:36,240 --> 00:28:38,000
mobile phone was on silence so he missed

834
00:28:38,000 --> 00:28:38,880
a couple of those

835
00:28:38,880 --> 00:28:42,559
um pushes as well so

836
00:28:42,559 --> 00:28:44,320
this is something that i i've seen

837
00:28:44,320 --> 00:28:46,000
before where um

838
00:28:46,000 --> 00:28:51,360
the 919 area code uh often

839
00:28:51,440 --> 00:28:53,919
gets typo people can typo in the system

840
00:28:53,919 --> 00:28:57,600
109.1 which is india's country code

841
00:28:57,600 --> 00:29:00,399
so that's kind of interesting um you can

842
00:29:00,399 --> 00:29:01,840
type of these numbers and you can

843
00:29:01,840 --> 00:29:03,679
accidentally call somebody with trying

844
00:29:03,679 --> 00:29:05,840
to do uh authentication especially on

845
00:29:05,840 --> 00:29:06,720
enrollment

846
00:29:06,720 --> 00:29:09,360
um if that poor wrong number actually

847
00:29:09,360 --> 00:29:10,559
answers it it can be

848
00:29:10,559 --> 00:29:13,760
on the account and then used again so

849
00:29:13,760 --> 00:29:16,960
that can be a benign thing for

850
00:29:16,960 --> 00:29:21,039
brute force against a user

851
00:29:21,039 --> 00:29:25,360
calling somebody the next piece

852
00:29:25,360 --> 00:29:27,520
that i'm deep diving into and that we're

853
00:29:27,520 --> 00:29:28,559
going to investigate

854
00:29:28,559 --> 00:29:32,399
is faith's account where

855
00:29:32,399 --> 00:29:34,399
we don't have any numbers on her on

856
00:29:34,399 --> 00:29:35,440
record

857
00:29:35,440 --> 00:29:38,000
for some reason and she has 27 failed

858
00:29:38,000 --> 00:29:39,679
login attempts

859
00:29:39,679 --> 00:29:43,120
so we're gonna take a wish there was no

860
00:29:43,120 --> 00:29:44,320
response

861
00:29:44,320 --> 00:29:47,200
um the login attempts happened exactly

862
00:29:47,200 --> 00:29:49,279
five minutes apart to the second that's

863
00:29:49,279 --> 00:29:50,320
very suspicious

864
00:29:50,320 --> 00:29:52,240
probably a script we're gonna email

865
00:29:52,240 --> 00:29:54,000
faith's manager and oh no it turns out

866
00:29:54,000 --> 00:29:55,520
she's on pto

867
00:29:55,520 --> 00:29:58,559
um wherever whatever number that is

868
00:29:58,559 --> 00:30:00,080
trying to authenticate you know nobody's

869
00:30:00,080 --> 00:30:01,919
paying attention and faith is definitely

870
00:30:01,919 --> 00:30:03,360
not logging in

871
00:30:03,360 --> 00:30:04,960
um so we're gonna go ahead and go and

872
00:30:04,960 --> 00:30:07,039
disable faith's account

873
00:30:07,039 --> 00:30:09,039
and then we're gonna set set it so that

874
00:30:09,039 --> 00:30:10,240
when she comes back from

875
00:30:10,240 --> 00:30:13,440
vacation she can

876
00:30:14,720 --> 00:30:16,399
reach out to sure it's really her and

877
00:30:16,399 --> 00:30:17,760
reset her password

878
00:30:17,760 --> 00:30:20,880
and get her back logged into the system

879
00:30:20,880 --> 00:30:22,000
and then we're going to take this and

880
00:30:22,000 --> 00:30:23,360
we're going to do further follow-up

881
00:30:23,360 --> 00:30:24,399
investigation

882
00:30:24,399 --> 00:30:26,640
on those login attempts on those ips

883
00:30:26,640 --> 00:30:28,559
those are very weird ips

884
00:30:28,559 --> 00:30:31,360
um about where she's trying to about who

885
00:30:31,360 --> 00:30:33,200
and what was trying to authenticate in

886
00:30:33,200 --> 00:30:33,679
as her

887
00:30:33,679 --> 00:30:35,039
and why they were doing it and things

888
00:30:35,039 --> 00:30:37,440
like that

889
00:30:37,440 --> 00:30:40,799
so kind of the next piece after

890
00:30:42,559 --> 00:30:45,919
after the beyond the technology that you

891
00:30:45,919 --> 00:30:48,640
you kind of want to think of and some of

892
00:30:48,640 --> 00:30:49,679
the scenarios that

893
00:30:49,679 --> 00:30:51,520
i may or may not have seen um there are

894
00:30:51,520 --> 00:30:53,279
things like uh assistance

895
00:30:53,279 --> 00:30:56,080
assistance to executives or other people

896
00:30:56,080 --> 00:30:57,279
in the office

897
00:30:57,279 --> 00:31:00,480
people that have a reason to proxy or to

898
00:31:00,480 --> 00:31:03,600
you know pseudo log in as somebody else

899
00:31:03,600 --> 00:31:05,919
are they getting the username getting

900
00:31:05,919 --> 00:31:07,039
the passwords

901
00:31:07,039 --> 00:31:08,559
and then adding their phones to the

902
00:31:08,559 --> 00:31:10,159
accounts of these other people

903
00:31:10,159 --> 00:31:13,519
and logging in that way um do you have

904
00:31:13,519 --> 00:31:15,279
applications that

905
00:31:15,279 --> 00:31:17,600
you know have proxies in place and built

906
00:31:17,600 --> 00:31:18,320
out already

907
00:31:18,320 --> 00:31:21,120
so that this doesn't happen do you have

908
00:31:21,120 --> 00:31:23,600
maybe an intermediary application proxy

909
00:31:23,600 --> 00:31:24,240
that will

910
00:31:24,240 --> 00:31:25,919
allow somebody to log in as somebody

911
00:31:25,919 --> 00:31:27,679
else and to take care of just these

912
00:31:27,679 --> 00:31:30,799
administrative tasks well

913
00:31:30,799 --> 00:31:32,320
you know you want to be able to set that

914
00:31:32,320 --> 00:31:34,159
up um

915
00:31:34,159 --> 00:31:36,960
contractors um you need to give them the

916
00:31:36,960 --> 00:31:38,640
the access that they need to do their

917
00:31:38,640 --> 00:31:39,519
jobs

918
00:31:39,519 --> 00:31:42,159
um and not restrict them to certain

919
00:31:42,159 --> 00:31:42,559
things

920
00:31:42,559 --> 00:31:45,360
um if you do restrict them uh you know

921
00:31:45,360 --> 00:31:47,679
uh contractors versus employee

922
00:31:47,679 --> 00:31:50,720
and you have managers um they they need

923
00:31:50,720 --> 00:31:51,200
to know

924
00:31:51,200 --> 00:31:53,840
the that manage both they need to know

925
00:31:53,840 --> 00:31:56,159
the levels that contractors are allowed

926
00:31:56,159 --> 00:31:58,480
um and set the expectations accordingly

927
00:31:58,480 --> 00:32:00,480
for their work level

928
00:32:00,480 --> 00:32:02,559
because if you expect contractors to do

929
00:32:02,559 --> 00:32:05,039
work they aren't capable of doing

930
00:32:05,039 --> 00:32:06,640
where they can't log into a system where

931
00:32:06,640 --> 00:32:08,480
only an employee can log into that

932
00:32:08,480 --> 00:32:09,039
system

933
00:32:09,039 --> 00:32:10,799
do not be surprised when you see

934
00:32:10,799 --> 00:32:12,480
contractor phone numbers on an

935
00:32:12,480 --> 00:32:14,320
employee's account

936
00:32:14,320 --> 00:32:16,720
because they have to log in and do that

937
00:32:16,720 --> 00:32:17,840
shadow i t

938
00:32:17,840 --> 00:32:21,039
you know get that employee's password in

939
00:32:21,039 --> 00:32:21,840
order to do

940
00:32:21,840 --> 00:32:25,519
what they need to do for their job

941
00:32:25,519 --> 00:32:27,840
and then also keep in mind the idea of

942
00:32:27,840 --> 00:32:29,600
restricted areas or skiffs

943
00:32:29,600 --> 00:32:32,399
um you know are if they're not allowed a

944
00:32:32,399 --> 00:32:33,279
cell phone

945
00:32:33,279 --> 00:32:36,080
um are they allowed desk phones um do

946
00:32:36,080 --> 00:32:37,519
they all have their own individual

947
00:32:37,519 --> 00:32:39,440
extensions so they're responsible for

948
00:32:39,440 --> 00:32:41,360
their own individual

949
00:32:41,360 --> 00:32:44,240
authentication you can't just go to one

950
00:32:44,240 --> 00:32:45,919
single phone number in order to log them

951
00:32:45,919 --> 00:32:48,000
in

952
00:32:48,080 --> 00:32:50,159
because anybody that can pick up that

953
00:32:50,159 --> 00:32:52,399
phone or if it rings to multiple desk

954
00:32:52,399 --> 00:32:53,760
phones at a time anybody can

955
00:32:53,760 --> 00:32:55,360
authenticate for anybody else and that

956
00:32:55,360 --> 00:32:57,120
kind of defeats the purpose

957
00:32:57,120 --> 00:32:59,679
so just kind of know what can be done

958
00:32:59,679 --> 00:33:01,919
there

959
00:33:02,240 --> 00:33:04,080
and then the next piece when you do any

960
00:33:04,080 --> 00:33:06,080
sort of threat hunting is responding to

961
00:33:06,080 --> 00:33:07,200
your findings

962
00:33:07,200 --> 00:33:09,760
and some of the i guess suggestions i

963
00:33:09,760 --> 00:33:11,440
have for responding to the things that i

964
00:33:11,440 --> 00:33:12,320
have found

965
00:33:12,320 --> 00:33:15,440
is think about um no self enrollment or

966
00:33:15,440 --> 00:33:16,799
limiting self enrollment

967
00:33:16,799 --> 00:33:18,480
how many phone numbers do you let

968
00:33:18,480 --> 00:33:20,000
somebody actually

969
00:33:20,000 --> 00:33:22,080
assign to their account um you know

970
00:33:22,080 --> 00:33:23,840
should they only have a cell phone or a

971
00:33:23,840 --> 00:33:25,519
company issued cell phone

972
00:33:25,519 --> 00:33:28,480
um or a desk phone things like that um

973
00:33:28,480 --> 00:33:30,640
it does kind of put a burden on your it

974
00:33:30,640 --> 00:33:31,840
department so you do kind of have to

975
00:33:31,840 --> 00:33:32,559
look at the

976
00:33:32,559 --> 00:33:34,799
you know it versus security there might

977
00:33:34,799 --> 00:33:38,159
need an ugly conversation there

978
00:33:38,159 --> 00:33:39,919
but that would prevent a lot of what i

979
00:33:39,919 --> 00:33:42,080
saw um just by limiting

980
00:33:42,080 --> 00:33:45,200
self enrollment um consider no phone

981
00:33:45,200 --> 00:33:46,720
call authentication

982
00:33:46,720 --> 00:33:48,640
um when you really think about it if if

983
00:33:48,640 --> 00:33:50,480
somebody steals like a backpack

984
00:33:50,480 --> 00:33:53,039
and it has a laptop and a phone in it

985
00:33:53,039 --> 00:33:53,760
and that phone

986
00:33:53,760 --> 00:33:56,159
is the second factor they don't have to

987
00:33:56,159 --> 00:33:57,679
unlock the phone in order to answer a

988
00:33:57,679 --> 00:33:59,440
phone call

989
00:33:59,440 --> 00:34:01,200
so you know they have a sticky note with

990
00:34:01,200 --> 00:34:02,960
a password

991
00:34:02,960 --> 00:34:05,360
on the laptop you know that that

992
00:34:05,360 --> 00:34:08,079
system's completely compromised mfa

993
00:34:08,079 --> 00:34:09,839
because they can answer the phone call

994
00:34:09,839 --> 00:34:11,199
for the mfa

995
00:34:11,199 --> 00:34:15,280
um if you do allow phone calls consider

996
00:34:15,280 --> 00:34:17,599
authentication restrictions against the

997
00:34:17,599 --> 00:34:18,800
authentication

998
00:34:18,800 --> 00:34:21,040
it's a minor slowdown but if you change

999
00:34:21,040 --> 00:34:22,879
the default from you know press one to

1000
00:34:22,879 --> 00:34:23,760
authenticate

1001
00:34:23,760 --> 00:34:25,839
um and you change it to like press six

1002
00:34:25,839 --> 00:34:27,359
it's just that

1003
00:34:27,359 --> 00:34:29,599
that extra step um that somebody has to

1004
00:34:29,599 --> 00:34:32,560
take in order to try to bypass that

1005
00:34:32,560 --> 00:34:35,280
and then fix what you find um you might

1006
00:34:35,280 --> 00:34:36,560
find systematic things

1007
00:34:36,560 --> 00:34:40,079
in your environment um you know about

1008
00:34:40,079 --> 00:34:41,679
people sharing accounts and why are they

1009
00:34:41,679 --> 00:34:43,440
sharing accounts and

1010
00:34:43,440 --> 00:34:46,560
um you know it it might not be an easy

1011
00:34:46,560 --> 00:34:48,719
technology fix it might be an hr

1012
00:34:48,719 --> 00:34:52,879
it might be a culture fix maybe all your

1013
00:34:52,879 --> 00:34:54,800
server admins are actually sharing

1014
00:34:54,800 --> 00:34:56,800
usernames and passwords or

1015
00:34:56,800 --> 00:34:58,960
you know keys into certain

1016
00:34:58,960 --> 00:35:00,400
administrative things

1017
00:35:00,400 --> 00:35:02,720
and now that there's mfa that's an extra

1018
00:35:02,720 --> 00:35:03,599
step where

1019
00:35:03,599 --> 00:35:05,200
you know they now have to put their

1020
00:35:05,200 --> 00:35:07,119
phone numbers on all these accounts

1021
00:35:07,119 --> 00:35:10,400
or um you know are all sharing some sort

1022
00:35:10,400 --> 00:35:12,079
of other authentication factor

1023
00:35:12,079 --> 00:35:14,240
so just keep in mind and fix what you

1024
00:35:14,240 --> 00:35:16,000
find if you go out and hunt these

1025
00:35:16,000 --> 00:35:19,040
things and then the other piece i want

1026
00:35:19,040 --> 00:35:19,599
to bring up

1027
00:35:19,599 --> 00:35:23,040
is educating your users this goes beyond

1028
00:35:23,040 --> 00:35:25,280
the password policy your users probably

1029
00:35:25,280 --> 00:35:27,440
know and understand the password policy

1030
00:35:27,440 --> 00:35:29,119
you have the restrictions around that it

1031
00:35:29,119 --> 00:35:31,680
has to be so many characters special

1032
00:35:31,680 --> 00:35:34,160
alphanumeric special character all that

1033
00:35:34,160 --> 00:35:35,680
but do they know

1034
00:35:35,680 --> 00:35:38,960
don't share your multi-factor

1035
00:35:38,960 --> 00:35:40,320
don't let somebody else put their phone

1036
00:35:40,320 --> 00:35:43,520
number on your account things like that

1037
00:35:43,520 --> 00:35:45,200
do your users know how to report

1038
00:35:45,200 --> 00:35:47,119
fraudulent login attempts

1039
00:35:47,119 --> 00:35:49,920
is your security or your it department

1040
00:35:49,920 --> 00:35:51,760
prepared to handle those phone calls

1041
00:35:51,760 --> 00:35:55,359
or those or those emails coming in from

1042
00:35:55,359 --> 00:35:57,280
users where hey

1043
00:35:57,280 --> 00:35:59,440
i got this mfa push or this phone call

1044
00:35:59,440 --> 00:36:00,880
and it was weird because i wasn't

1045
00:36:00,880 --> 00:36:03,040
logging in

1046
00:36:03,040 --> 00:36:04,560
make sure that your users know how to do

1047
00:36:04,560 --> 00:36:05,680
that because they're going to be

1048
00:36:05,680 --> 00:36:07,359
probably your earliest detection if

1049
00:36:07,359 --> 00:36:09,760
something weird is going on

1050
00:36:09,760 --> 00:36:12,320
and then you also want to have a safe

1051
00:36:12,320 --> 00:36:14,400
way for your users to report

1052
00:36:14,400 --> 00:36:16,560
requests for credential sharing if their

1053
00:36:16,560 --> 00:36:18,000
manager comes to them

1054
00:36:18,000 --> 00:36:21,359
and you know requests that they allow or

1055
00:36:21,359 --> 00:36:23,040
they give them their password and their

1056
00:36:23,040 --> 00:36:24,240
their phone number you know do you have

1057
00:36:24,240 --> 00:36:26,079
a culture where that

1058
00:36:26,079 --> 00:36:29,520
might happen is there a way that

1059
00:36:29,520 --> 00:36:32,320
that users can report that think of the

1060
00:36:32,320 --> 00:36:34,079
especially vulnerable

1061
00:36:34,079 --> 00:36:35,760
contractors working for a contracting

1062
00:36:35,760 --> 00:36:37,200
company and

1063
00:36:37,200 --> 00:36:41,440
their contract league liaison says hey

1064
00:36:41,440 --> 00:36:44,560
i need your credentials for this company

1065
00:36:44,560 --> 00:36:45,839
so that i can go in and make sure that

1066
00:36:45,839 --> 00:36:47,680
you get your paycheck on time

1067
00:36:47,680 --> 00:36:50,000
um and then once they do that then that

1068
00:36:50,000 --> 00:36:51,359
you know recruiting company is now

1069
00:36:51,359 --> 00:36:54,000
downloading all your internal hr

1070
00:36:54,000 --> 00:36:56,800
records or whatever that that user had

1071
00:36:56,800 --> 00:36:57,760
access to

1072
00:36:57,760 --> 00:37:00,880
you know that could be a huge problem so

1073
00:37:00,880 --> 00:37:02,480
make sure that people can report that

1074
00:37:02,480 --> 00:37:04,000
and then of course

1075
00:37:04,000 --> 00:37:09,359
include contractors

1076
00:37:09,359 --> 00:37:10,800
the main thing that i want you to take

1077
00:37:10,800 --> 00:37:12,400
away from this talk that i want you

1078
00:37:12,400 --> 00:37:15,520
to take away from from mfa and the whole

1079
00:37:15,520 --> 00:37:17,119
secrets of the second factor

1080
00:37:17,119 --> 00:37:19,599
is um just do not set and forget your

1081
00:37:19,599 --> 00:37:20,240
setup

1082
00:37:20,240 --> 00:37:23,680
um like yes mfa is a fantastic um

1083
00:37:23,680 --> 00:37:25,599
resource for protecting user accounts

1084
00:37:25,599 --> 00:37:27,200
and everything but it's totally not

1085
00:37:27,200 --> 00:37:28,160
flawless

1086
00:37:28,160 --> 00:37:30,480
um i've gone over a lot of the things

1087
00:37:30,480 --> 00:37:32,640
that can happen that can go wrong

1088
00:37:32,640 --> 00:37:34,880
um i encourage you to search for the

1089
00:37:34,880 --> 00:37:36,160
unusual not only

1090
00:37:36,160 --> 00:37:39,920
in in mfa but in any sort of resource

1091
00:37:39,920 --> 00:37:40,800
that you have

1092
00:37:40,800 --> 00:37:42,960
um and then go through and investigate

1093
00:37:42,960 --> 00:37:44,880
those logs and see what's going on

1094
00:37:44,880 --> 00:37:47,520
bring in other resources other teams

1095
00:37:47,520 --> 00:37:49,359
other different log sources and validate

1096
00:37:49,359 --> 00:37:49,680
what

1097
00:37:49,680 --> 00:37:52,000
what you're

1098
00:37:53,440 --> 00:37:55,200
seeing people um in different

1099
00:37:55,200 --> 00:37:56,880
departments and having like those

1100
00:37:56,880 --> 00:37:57,760
relationships

1101
00:37:57,760 --> 00:38:00,560
and being able to to discover the truth

1102
00:38:00,560 --> 00:38:02,160
of what's going on and then

1103
00:38:02,160 --> 00:38:03,920
solving systematic problems that could

1104
00:38:03,920 --> 00:38:05,760
be going on

1105
00:38:05,760 --> 00:38:08,480
in your company or be discovered in a

1106
00:38:08,480 --> 00:38:10,320
system like this

1107
00:38:10,320 --> 00:38:12,400
um i guess kind of the next piece is

1108
00:38:12,400 --> 00:38:13,599
just

1109
00:38:13,599 --> 00:38:15,040
the stuff that i want to do future

1110
00:38:15,040 --> 00:38:17,119
research on this

1111
00:38:17,119 --> 00:38:19,680
might be a talk um digging more into how

1112
00:38:19,680 --> 00:38:20,480
to detect

1113
00:38:20,480 --> 00:38:22,400
credential stuffing attempts digging

1114
00:38:22,400 --> 00:38:24,400
more into

1115
00:38:24,400 --> 00:38:27,359
a soft token duke into soft tokens um

1116
00:38:27,359 --> 00:38:27,920
but i'm

1117
00:38:27,920 --> 00:38:30,160
i'm really curious to see you know if

1118
00:38:30,160 --> 00:38:32,000
that type of stuff is going on

1119
00:38:32,000 --> 00:38:34,320
if people are able to copy those i want

1120
00:38:34,320 --> 00:38:36,240
to look into sms token brute forcing if

1121
00:38:36,240 --> 00:38:36,960
somebody's just

1122
00:38:36,960 --> 00:38:39,359
randomly throwing numbers into one of

1123
00:38:39,359 --> 00:38:40,480
these things

1124
00:38:40,480 --> 00:38:43,280
um i want to see if if anybody is also

1125
00:38:43,280 --> 00:38:46,160
trying to attempt to bypass codes

1126
00:38:46,160 --> 00:38:48,960
when like it or security didn't issue a

1127
00:38:48,960 --> 00:38:51,040
bypass code to a user

1128
00:38:51,040 --> 00:38:52,640
um and then one of the other things i

1129
00:38:52,640 --> 00:38:54,079
want to take a look into is

1130
00:38:54,079 --> 00:38:56,400
people sharing ub keys hacker keys or

1131
00:38:56,400 --> 00:38:57,200
hard tokens

1132
00:38:57,200 --> 00:38:59,599
is it possible to share those um can

1133
00:38:59,599 --> 00:39:01,200
they be on multiple accounts and

1134
00:39:01,200 --> 00:39:04,800
things like that um

1135
00:39:04,800 --> 00:39:06,400
and this slide here is just kind of like

1136
00:39:06,400 --> 00:39:08,560
thanks um to the diet initiative to my

1137
00:39:08,560 --> 00:39:09,839
employer

1138
00:39:09,839 --> 00:39:11,359
especially management for letting me do

1139
00:39:11,359 --> 00:39:12,960
this research

1140
00:39:12,960 --> 00:39:16,079
not naming them um and then the

1141
00:39:16,079 --> 00:39:19,200
yeah you know

1142
00:39:19,359 --> 00:39:22,160
and rtb security beard um just having

1143
00:39:22,160 --> 00:39:23,200
conversations with me

1144
00:39:23,200 --> 00:39:25,520
and letting me know that i'm not crazy

1145
00:39:25,520 --> 00:39:27,200
for going and digging around in these

1146
00:39:27,200 --> 00:39:28,000
logs

1147
00:39:28,000 --> 00:39:30,000
and then just randomly duo because they

1148
00:39:30,000 --> 00:39:32,000
have nice flowcharts

1149
00:39:32,000 --> 00:39:33,760
and then just some references here and

1150
00:39:33,760 --> 00:39:42,480
then i'll take questions hey can you

1151
00:39:42,480 --> 00:39:44,800
hear me

1152
00:39:50,720 --> 00:39:53,680
i think he can okay good good good okay

1153
00:39:53,680 --> 00:39:55,040
basically i just want to say thank you

1154
00:39:55,040 --> 00:39:56,320
so much for that talk that was

1155
00:39:56,320 --> 00:39:56,960
incredible

1156
00:39:56,960 --> 00:39:59,520
um i was just having a conversation with

1157
00:39:59,520 --> 00:40:01,040
a friend last night who works in

1158
00:40:01,040 --> 00:40:02,880
incident response and he was like i'm

1159
00:40:02,880 --> 00:40:04,960
currently at dinner trying to convince a

1160
00:40:04,960 --> 00:40:06,880
bunch of sea levels to enforce

1161
00:40:06,880 --> 00:40:09,839
mfa and or two-factor authentication and

1162
00:40:09,839 --> 00:40:11,359
it's like

1163
00:40:11,359 --> 00:40:14,400
well it seems so self-evident in 2020

1164
00:40:14,400 --> 00:40:15,040
that

1165
00:40:15,040 --> 00:40:16,800
you shouldn't you shouldn't have to

1166
00:40:16,800 --> 00:40:18,480
explain this it should be it should be

1167
00:40:18,480 --> 00:40:19,359
so obvious

1168
00:40:19,359 --> 00:40:21,520
and to justify the return on investments

1169
00:40:21,520 --> 00:40:22,560
just like

1170
00:40:22,560 --> 00:40:25,200
oh but it's crazy um so there's been a

1171
00:40:25,200 --> 00:40:26,720
lot of really great uh

1172
00:40:26,720 --> 00:40:28,960
interaction in the audience people

1173
00:40:28,960 --> 00:40:30,400
really liked the uh

1174
00:40:30,400 --> 00:40:32,640
the logs section that was that got a lot

1175
00:40:32,640 --> 00:40:33,760
of uh pause

1176
00:40:33,760 --> 00:40:36,000
and then you have like the the great

1177
00:40:36,000 --> 00:40:39,040
reference there so i have the theme song

1178
00:40:39,040 --> 00:40:41,680
in my head okay anyway sorry a lot of

1179
00:40:41,680 --> 00:40:44,160
love for the case study scenarios uh one

1180
00:40:44,160 --> 00:40:46,240
question that we had was

1181
00:40:46,240 --> 00:40:49,440
the dos mfa server fail open slide in

1182
00:40:49,440 --> 00:40:50,160
this case

1183
00:40:50,160 --> 00:40:52,720
i assume failed clothes should be

1184
00:40:52,720 --> 00:40:54,880
implemented in the architecture is that

1185
00:40:54,880 --> 00:40:58,160
a correct assumption

1186
00:40:58,560 --> 00:41:00,640
i mean the answer to everything is going

1187
00:41:00,640 --> 00:41:02,160
to be it depends

1188
00:41:02,160 --> 00:41:06,079
um because in a closed scenario you can

1189
00:41:06,079 --> 00:41:07,280
totally

1190
00:41:07,280 --> 00:41:10,000
screw yourself too so um you want to be

1191
00:41:10,000 --> 00:41:11,839
careful with that

1192
00:41:11,839 --> 00:41:14,800
in the environment but um yeah if you

1193
00:41:14,800 --> 00:41:15,920
suspect anybody

1194
00:41:15,920 --> 00:41:19,920
have the ability to um change host files

1195
00:41:19,920 --> 00:41:21,200
or anything like that

1196
00:41:21,200 --> 00:41:24,640
then you'd want to feel close

1197
00:41:25,040 --> 00:41:27,680
great great so i want to just let the

1198
00:41:27,680 --> 00:41:29,359
audience know that there is a survey for

1199
00:41:29,359 --> 00:41:31,119
this talk available the links in the

1200
00:41:31,119 --> 00:41:32,240
chat

1201
00:41:32,240 --> 00:41:35,359
if you have any further questions uh you

1202
00:41:35,359 --> 00:41:37,040
can yeah we actually have time right now

1203
00:41:37,040 --> 00:41:38,240
if you want to throw them in the chat

1204
00:41:38,240 --> 00:41:40,960
and get some live interaction

1205
00:41:40,960 --> 00:41:43,359
if not the base you'll be available in

1206
00:41:43,359 --> 00:41:45,760
chat afterwards

1207
00:41:45,760 --> 00:41:48,480
okay great great all right well thank

1208
00:41:48,480 --> 00:41:49,680
you so much for

1209
00:41:49,680 --> 00:41:52,240
presenting this was an amazing talk and

1210
00:41:52,240 --> 00:41:53,599
something that i've been

1211
00:41:53,599 --> 00:41:55,359
hearing about a lot personally through

1212
00:41:55,359 --> 00:41:57,280
my people that i know in the in the

1213
00:41:57,280 --> 00:41:58,480
industry so

1214
00:41:58,480 --> 00:42:01,119
i love that you ended with the areas of

1215
00:42:01,119 --> 00:42:03,200
research that you're looking into and

1216
00:42:03,200 --> 00:42:03,599
you're

1217
00:42:03,599 --> 00:42:05,839
encouraging others to do and and yeah i

1218
00:42:05,839 --> 00:42:07,200
think that's i think that's really cool

1219
00:42:07,200 --> 00:42:08,000
like you

1220
00:42:08,000 --> 00:42:09,839
you're so knowledgeable about this

1221
00:42:09,839 --> 00:42:11,839
subject and then you're looking at these

1222
00:42:11,839 --> 00:42:13,119
different things that you want to see

1223
00:42:13,119 --> 00:42:14,319
further research in it and you're

1224
00:42:14,319 --> 00:42:15,839
sharing that with the community like

1225
00:42:15,839 --> 00:42:16,800
saying hey

1226
00:42:16,800 --> 00:42:18,079
these are some interesting things to

1227
00:42:18,079 --> 00:42:19,680
look at this is some research that can

1228
00:42:19,680 --> 00:42:20,319
be done

1229
00:42:20,319 --> 00:42:22,240
let's do this together let's let's see

1230
00:42:22,240 --> 00:42:24,000
where we can go with this so

1231
00:42:24,000 --> 00:42:25,200
thank you so much i thought that was a

1232
00:42:25,200 --> 00:42:28,160
really cool thing to do

1233
00:42:29,040 --> 00:42:32,079
and uh so uh everyone else stand by here

1234
00:42:32,079 --> 00:42:34,720
we have about 18 minutes until the next

1235
00:42:34,720 --> 00:42:35,920
presenter

1236
00:42:35,920 --> 00:42:38,160
um but uh we'll get someone on as soon

1237
00:42:38,160 --> 00:42:42,399
as possible thank you so much

