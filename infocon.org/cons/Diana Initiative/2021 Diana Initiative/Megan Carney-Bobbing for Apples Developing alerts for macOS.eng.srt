1
00:00:13,519 --> 00:00:16,560
hey all my name is bree helton and i'm

2
00:00:16,560 --> 00:00:19,600
here for diana initiative uh 2021 on the

3
00:00:19,600 --> 00:00:21,760
virtual event and we're excited to

4
00:00:21,760 --> 00:00:24,080
present another talk here on stage two

5
00:00:24,080 --> 00:00:24,960
today

6
00:00:24,960 --> 00:00:26,720
uh first off i want

7
00:00:26,720 --> 00:00:29,760
i just want to thank our speakers uh and

8
00:00:29,760 --> 00:00:31,920
our sponsors uh for our sponsors this

9
00:00:31,920 --> 00:00:35,520
year we have elearn security uh noxus uh

10
00:00:35,520 --> 00:00:39,360
mongodb juniper corelight google

11
00:00:39,360 --> 00:00:41,680
uh and bridge crew uh with us today i'm

12
00:00:41,680 --> 00:00:43,680
all basically sponsoring this event and

13
00:00:43,680 --> 00:00:45,520
the tracks and such uh give them your

14
00:00:45,520 --> 00:00:47,680
thanks and feel free to visit any of our

15
00:00:47,680 --> 00:00:49,760
exhibitors today over in our exhibit

16
00:00:49,760 --> 00:00:51,440
hall and give them a lot of love and

17
00:00:51,440 --> 00:00:53,520
attention there in addition to that we

18
00:00:53,520 --> 00:00:55,600
have an exciting amount of ctfs going on

19
00:00:55,600 --> 00:00:57,120
today i believe we're at three or four

20
00:00:57,120 --> 00:00:59,199
at this particular point in time so

21
00:00:59,199 --> 00:01:00,719
after these talks are in between talks

22
00:01:00,719 --> 00:01:02,079
if you want to catch a ctf and

23
00:01:02,079 --> 00:01:03,920
participate virtually feel free to hop

24
00:01:03,920 --> 00:01:05,760
on over there and such

25
00:01:05,760 --> 00:01:08,400
um i just want to introduce our speaker

26
00:01:08,400 --> 00:01:09,600
for today

27
00:01:09,600 --> 00:01:12,240
and our speaker is megan carney and she

28
00:01:12,240 --> 00:01:14,400
is here on the stream um she'll be

29
00:01:14,400 --> 00:01:16,880
having a talk today entitled

30
00:01:16,880 --> 00:01:18,880
uh bobbing for apples developing alerts

31
00:01:18,880 --> 00:01:20,240
for mac os

32
00:01:20,240 --> 00:01:22,880
um and so in this talk she'll be uh

33
00:01:22,880 --> 00:01:24,880
giving a bit about herself and the

34
00:01:24,880 --> 00:01:27,360
actual topic at hand she's a security

35
00:01:27,360 --> 00:01:29,280
analyst and bad news giver in several

36
00:01:29,280 --> 00:01:31,600
different environments over the past 10

37
00:01:31,600 --> 00:01:33,040
years or so she's currently employed

38
00:01:33,040 --> 00:01:35,119
with target and she spends most of her

39
00:01:35,119 --> 00:01:36,880
time searching for places that badness

40
00:01:36,880 --> 00:01:39,280
might be and can often be found staring

41
00:01:39,280 --> 00:01:41,040
into the abyss and it's true the best

42
00:01:41,040 --> 00:01:42,960
stares back at you and as a fellow

43
00:01:42,960 --> 00:01:44,640
beefer analyst i spend a lot of time

44
00:01:44,640 --> 00:01:47,119
also staring into the abyss and uh yeah

45
00:01:47,119 --> 00:01:49,040
it really does stare back into you which

46
00:01:49,040 --> 00:01:50,640
gives you a great place to get bad news

47
00:01:50,640 --> 00:01:52,000
from and kind of bring to other people's

48
00:01:52,000 --> 00:01:55,119
attention to introduce it to them um

49
00:01:55,119 --> 00:01:57,360
it is really um so i'm going to hand it

50
00:01:57,360 --> 00:02:01,200
off here to uh megan thank you very much

51
00:02:01,200 --> 00:02:04,560
hey everyone um so i really wish i could

52
00:02:04,560 --> 00:02:07,119
be in person and see all of your smiling

53
00:02:07,119 --> 00:02:08,399
faces

54
00:02:08,399 --> 00:02:10,639
but that wasn't in the cards this year

55
00:02:10,639 --> 00:02:12,959
so i just want to encourage people to

56
00:02:12,959 --> 00:02:14,959
ask questions or

57
00:02:14,959 --> 00:02:16,560
if you have comments you can find me

58
00:02:16,560 --> 00:02:18,720
later on twitter

59
00:02:18,720 --> 00:02:20,560
as i go through the slides i just want

60
00:02:20,560 --> 00:02:22,640
people to know i am gonna post these

61
00:02:22,640 --> 00:02:24,800
online and i will put the link on my

62
00:02:24,800 --> 00:02:26,000
twitter feed

63
00:02:26,000 --> 00:02:27,040
so

64
00:02:27,040 --> 00:02:29,440
that's not a flex like i'm okay if you

65
00:02:29,440 --> 00:02:32,000
subscribe or follow me for two days get

66
00:02:32,000 --> 00:02:33,920
the slides and then disappear that's

67
00:02:33,920 --> 00:02:35,840
cool with me i just you don't have to

68
00:02:35,840 --> 00:02:37,519
copy down the details

69
00:02:37,519 --> 00:02:39,680
as we go through the slides

70
00:02:39,680 --> 00:02:40,879
all right cool i think that's

71
00:02:40,879 --> 00:02:43,360
housekeeping stuff so

72
00:02:43,360 --> 00:02:45,599
about me um so you know where i come

73
00:02:45,599 --> 00:02:46,800
from

74
00:02:46,800 --> 00:02:47,599
i

75
00:02:47,599 --> 00:02:50,800
have been doing infosec stuff for

76
00:02:50,800 --> 00:02:52,640
10 years or

77
00:02:52,640 --> 00:02:54,400
and a few now

78
00:02:54,400 --> 00:02:55,920
mostly on the blue team side of the

79
00:02:55,920 --> 00:02:57,840
world though i've also done

80
00:02:57,840 --> 00:03:00,480
some like light penetration testing

81
00:03:00,480 --> 00:03:03,280
consulting sort of stuff

82
00:03:03,280 --> 00:03:05,360
and for the past few years i've been

83
00:03:05,360 --> 00:03:07,120
focusing on

84
00:03:07,120 --> 00:03:09,920
mac os stuff because i don't

85
00:03:09,920 --> 00:03:11,519
it just feels like an area that not

86
00:03:11,519 --> 00:03:13,760
enough people are working on

87
00:03:13,760 --> 00:03:17,120
and one of the problems that i found oh

88
00:03:17,120 --> 00:03:19,840
sorry there we go

89
00:03:19,840 --> 00:03:21,120
is that

90
00:03:21,120 --> 00:03:24,080
macs are just harder to manage at scale

91
00:03:24,080 --> 00:03:25,920
and i think if you talk

92
00:03:25,920 --> 00:03:28,720
without mac admins and i've talked with

93
00:03:28,720 --> 00:03:30,640
our team at target a little bit

94
00:03:30,640 --> 00:03:34,000
there's just not as many tools available

95
00:03:34,000 --> 00:03:35,599
for people to use

96
00:03:35,599 --> 00:03:37,760
and they're

97
00:03:37,760 --> 00:03:40,239
not they're just not as mature which

98
00:03:40,239 --> 00:03:41,920
means if you're

99
00:03:41,920 --> 00:03:43,440
managing a bunch of macs within your

100
00:03:43,440 --> 00:03:45,840
enterprise it's just

101
00:03:45,840 --> 00:03:49,200
not as easy and this isn't just true

102
00:03:49,200 --> 00:03:50,000
for

103
00:03:50,000 --> 00:03:52,640
things like managing settings

104
00:03:52,640 --> 00:03:56,480
it's also true for security tools

105
00:03:56,480 --> 00:04:00,400
so just getting logs to a central sim is

106
00:04:00,400 --> 00:04:04,000
harder so if you know anything about

107
00:04:04,000 --> 00:04:05,120
mac os

108
00:04:05,120 --> 00:04:07,840
over you know the past few years

109
00:04:07,840 --> 00:04:09,840
first there was syslog but then syslog

110
00:04:09,840 --> 00:04:11,519
went away and then there were apple

111
00:04:11,519 --> 00:04:14,080
system logs and now we have unified logs

112
00:04:14,080 --> 00:04:15,120
but

113
00:04:15,120 --> 00:04:17,440
ever since syslog went away

114
00:04:17,440 --> 00:04:19,839
there hasn't been a built-in way to send

115
00:04:19,839 --> 00:04:22,479
logs to a central location

116
00:04:22,479 --> 00:04:26,080
and a lot of alerting depends on sending

117
00:04:26,080 --> 00:04:28,560
logs to a central location

118
00:04:28,560 --> 00:04:30,320
so it can be

119
00:04:30,320 --> 00:04:33,199
a really difficult problem

120
00:04:33,199 --> 00:04:35,919
and given all that it's not really a

121
00:04:35,919 --> 00:04:37,199
surprise

122
00:04:37,199 --> 00:04:40,840
that most security orgs don't focus on

123
00:04:40,840 --> 00:04:44,080
max i mean i get it windows machines are

124
00:04:44,080 --> 00:04:45,840
still a larger target for malware

125
00:04:45,840 --> 00:04:48,320
authors you know we all know mac malware

126
00:04:48,320 --> 00:04:50,160
exists we all know that it can be

127
00:04:50,160 --> 00:04:51,440
dangerous

128
00:04:51,440 --> 00:04:52,320
but

129
00:04:52,320 --> 00:04:54,400
there's still a larger number of windows

130
00:04:54,400 --> 00:04:56,560
malware samples out there

131
00:04:56,560 --> 00:04:58,560
and because the tool sets are less

132
00:04:58,560 --> 00:05:01,280
mature it does require more effort if

133
00:05:01,280 --> 00:05:03,280
you're going to set up alerting or start

134
00:05:03,280 --> 00:05:05,919
writing custom alerts for your macs

135
00:05:05,919 --> 00:05:06,880
so

136
00:05:06,880 --> 00:05:09,120
why am i here today

137
00:05:09,120 --> 00:05:11,120
talking about

138
00:05:11,120 --> 00:05:13,280
mac alerting if it's a more difficult

139
00:05:13,280 --> 00:05:14,960
thing to do when it requires a lot of

140
00:05:14,960 --> 00:05:16,720
effort

141
00:05:16,720 --> 00:05:19,759
so the truth is your macs are probably

142
00:05:19,759 --> 00:05:22,240
tied into the same environment as the

143
00:05:22,240 --> 00:05:24,560
rest of your windows machines

144
00:05:24,560 --> 00:05:25,680
so

145
00:05:25,680 --> 00:05:27,120
they're tied into the same domain

146
00:05:27,120 --> 00:05:29,440
they're accessing the same file shares

147
00:05:29,440 --> 00:05:32,080
and if you're in a large org

148
00:05:32,080 --> 00:05:34,000
and maybe two percent of your machines

149
00:05:34,000 --> 00:05:35,199
are max

150
00:05:35,199 --> 00:05:38,560
that's still a lot of machines right

151
00:05:38,560 --> 00:05:39,919
were

152
00:05:39,919 --> 00:05:42,479
and it's completely possible for your

153
00:05:42,479 --> 00:05:44,720
max to be compromised and for that to be

154
00:05:44,720 --> 00:05:47,280
a foothold into taking down the rest of

155
00:05:47,280 --> 00:05:48,639
your network

156
00:05:48,639 --> 00:05:50,000
so

157
00:05:50,000 --> 00:05:52,400
we know in infosec

158
00:05:52,400 --> 00:05:53,759
and this is really

159
00:05:53,759 --> 00:05:55,680
common wisdom

160
00:05:55,680 --> 00:05:56,560
that

161
00:05:56,560 --> 00:05:59,120
your security is only as strong as your

162
00:05:59,120 --> 00:06:00,800
weakest link

163
00:06:00,800 --> 00:06:03,520
and if you ask any cso they'll agree

164
00:06:03,520 --> 00:06:04,800
with this

165
00:06:04,800 --> 00:06:08,000
but it's curious how many companies

166
00:06:08,000 --> 00:06:11,360
just don't monitor entire segments of

167
00:06:11,360 --> 00:06:13,280
their network and i'm not just talking

168
00:06:13,280 --> 00:06:14,800
about mac os here though that's a

169
00:06:14,800 --> 00:06:17,360
problem it's also things like linux

170
00:06:17,360 --> 00:06:18,400
machines

171
00:06:18,400 --> 00:06:20,160
like do you have monitoring on your

172
00:06:20,160 --> 00:06:21,680
linux servers

173
00:06:21,680 --> 00:06:22,479
and

174
00:06:22,479 --> 00:06:25,039
i think it's important

175
00:06:25,039 --> 00:06:26,080
to

176
00:06:26,080 --> 00:06:28,319
think about all of the operating systems

177
00:06:28,319 --> 00:06:29,919
on your network and what you're covering

178
00:06:29,919 --> 00:06:31,759
so today i'm going to focus on mac os

179
00:06:31,759 --> 00:06:34,960
but i completely realize that mac os is

180
00:06:34,960 --> 00:06:37,039
not the only operating system that has

181
00:06:37,039 --> 00:06:38,960
this problem

182
00:06:38,960 --> 00:06:40,560
so you might be thinking

183
00:06:40,560 --> 00:06:44,080
well i have antivirus i have some sort

184
00:06:44,080 --> 00:06:46,880
of ids sitting on my network

185
00:06:46,880 --> 00:06:52,479
why should i be doing more than that

186
00:06:52,800 --> 00:06:53,680
and

187
00:06:53,680 --> 00:06:55,919
this isn't a dig to vendors i'm not

188
00:06:55,919 --> 00:06:58,160
saying that vendors are terrible or that

189
00:06:58,160 --> 00:06:59,520
all their products are terrible but

190
00:06:59,520 --> 00:07:03,520
vendors aren't everything if you are

191
00:07:03,520 --> 00:07:06,560
mcafee if you're sofos you have to tune

192
00:07:06,560 --> 00:07:08,880
your detection based on all of your

193
00:07:08,880 --> 00:07:10,000
clients

194
00:07:10,000 --> 00:07:12,160
and what all of their environments look

195
00:07:12,160 --> 00:07:12,960
like

196
00:07:12,960 --> 00:07:15,759
if you are writing detection for your

197
00:07:15,759 --> 00:07:16,960
environment

198
00:07:16,960 --> 00:07:19,520
you can tune detection based on

199
00:07:19,520 --> 00:07:21,919
how you know your org runs

200
00:07:21,919 --> 00:07:24,560
and your org's appetite for risk

201
00:07:24,560 --> 00:07:27,840
so if you're say a nuclear power plant

202
00:07:27,840 --> 00:07:30,160
you might have a really low appetite for

203
00:07:30,160 --> 00:07:33,120
risk if you're

204
00:07:33,120 --> 00:07:35,360
i don't know a small startup maybe your

205
00:07:35,360 --> 00:07:38,400
appetite for risk is larger or smaller

206
00:07:38,400 --> 00:07:40,400
so if you're writing your own detection

207
00:07:40,400 --> 00:07:43,599
you can really tailor me your alerts to

208
00:07:43,599 --> 00:07:45,680
your environment and there are some big

209
00:07:45,680 --> 00:07:48,879
advantages there that a vendor just

210
00:07:48,879 --> 00:07:51,199
can't offer you

211
00:07:51,199 --> 00:07:53,199
and you can also create

212
00:07:53,199 --> 00:07:56,639
trip wires to make it more difficult

213
00:07:56,639 --> 00:07:58,400
for an attack in your environment to

214
00:07:58,400 --> 00:07:59,919
succeed

215
00:07:59,919 --> 00:08:02,800
so you've probably heard the phrase an

216
00:08:02,800 --> 00:08:04,800
attacker only has to be right once a

217
00:08:04,800 --> 00:08:07,120
defender has to be right all the time

218
00:08:07,120 --> 00:08:09,840
and while that is technically true i

219
00:08:09,840 --> 00:08:12,319
think what gets lost in that discussion

220
00:08:12,319 --> 00:08:14,879
is that you as the defender

221
00:08:14,879 --> 00:08:17,919
control the attacker's playground

222
00:08:17,919 --> 00:08:20,879
and there are always choke points or

223
00:08:20,879 --> 00:08:22,960
tripwires that you can set up to make

224
00:08:22,960 --> 00:08:25,360
their job more difficult

225
00:08:25,360 --> 00:08:27,360
in particular

226
00:08:27,360 --> 00:08:29,360
i think we need to redefine success and

227
00:08:29,360 --> 00:08:31,039
i know this has also been talked about a

228
00:08:31,039 --> 00:08:32,479
lot but

229
00:08:32,479 --> 00:08:34,159
do not assume

230
00:08:34,159 --> 00:08:36,240
that your prevention measures are going

231
00:08:36,240 --> 00:08:38,320
to be 100 accurate

232
00:08:38,320 --> 00:08:40,080
something is always going to get past

233
00:08:40,080 --> 00:08:42,479
your spam filter some piece of malware

234
00:08:42,479 --> 00:08:44,240
is always going to find its way into

235
00:08:44,240 --> 00:08:46,959
your environment so the question is

236
00:08:46,959 --> 00:08:48,480
are you going to find that piece of

237
00:08:48,480 --> 00:08:51,040
malware early when it's an easy problem

238
00:08:51,040 --> 00:08:53,360
to solve or are you going to find it

239
00:08:53,360 --> 00:08:55,760
later when it's a really big problem to

240
00:08:55,760 --> 00:08:57,040
solve

241
00:08:57,040 --> 00:08:59,360
and the way you find it early is by

242
00:08:59,360 --> 00:09:01,680
looking for these choke points so for

243
00:09:01,680 --> 00:09:03,760
any operating system i'm talking windows

244
00:09:03,760 --> 00:09:06,640
macs linux unix whatever

245
00:09:06,640 --> 00:09:10,080
there are only so many ways to set up

246
00:09:10,080 --> 00:09:12,160
an auto run job there are only so many

247
00:09:12,160 --> 00:09:13,920
ways to move data in and out of the

248
00:09:13,920 --> 00:09:14,880
network

249
00:09:14,880 --> 00:09:17,600
and if you look at your configuration

250
00:09:17,600 --> 00:09:20,240
and your machines and your network you

251
00:09:20,240 --> 00:09:22,000
can start saying things like well we

252
00:09:22,000 --> 00:09:23,760
don't use startup items

253
00:09:23,760 --> 00:09:24,720
cool

254
00:09:24,720 --> 00:09:26,880
so i can create an alert for if any

255
00:09:26,880 --> 00:09:28,560
startup item is added and you can go

256
00:09:28,560 --> 00:09:30,080
down the list for all the persistence

257
00:09:30,080 --> 00:09:32,399
mechanisms and really tailor your

258
00:09:32,399 --> 00:09:35,680
alerting to your environment

259
00:09:35,680 --> 00:09:38,640
so hopefully i've made the case that

260
00:09:38,640 --> 00:09:40,880
custom alerting might be a thing worth

261
00:09:40,880 --> 00:09:42,880
doing in your environment

262
00:09:42,880 --> 00:09:45,040
so let's talk about some of the

263
00:09:45,040 --> 00:09:48,640
difficulties you might face in building

264
00:09:48,640 --> 00:09:50,880
a program like this

265
00:09:50,880 --> 00:09:52,240
um

266
00:09:52,240 --> 00:09:54,880
so in terms of my background and

267
00:09:54,880 --> 00:09:58,160
i became a detection engineer a year or

268
00:09:58,160 --> 00:10:00,320
two ago i don't remember exactly but

269
00:10:00,320 --> 00:10:02,000
before that

270
00:10:02,000 --> 00:10:04,079
i was an incident response and i was

271
00:10:04,079 --> 00:10:05,680
dealing with a lot of mac stuff and i

272
00:10:05,680 --> 00:10:07,600
was super excited to come over and be a

273
00:10:07,600 --> 00:10:09,839
detection engineer and i thought i'm

274
00:10:09,839 --> 00:10:11,760
just going to go play in the data i'm

275
00:10:11,760 --> 00:10:13,360
going to find some alerts to write it's

276
00:10:13,360 --> 00:10:14,959
going to be this really great technical

277
00:10:14,959 --> 00:10:16,000
work

278
00:10:16,000 --> 00:10:18,000
and it is like the technical work is

279
00:10:18,000 --> 00:10:19,519
interesting

280
00:10:19,519 --> 00:10:21,279
but looking back

281
00:10:21,279 --> 00:10:24,399
it was really naive of me to assume that

282
00:10:24,399 --> 00:10:27,680
this would just be a technical challenge

283
00:10:27,680 --> 00:10:30,240
it is also a people challenge and it's

284
00:10:30,240 --> 00:10:33,279
also an organizational challenge

285
00:10:33,279 --> 00:10:34,480
because

286
00:10:34,480 --> 00:10:36,800
writing alerts is not something you do

287
00:10:36,800 --> 00:10:38,160
in a vacuum

288
00:10:38,160 --> 00:10:40,160
it's something that i need other

289
00:10:40,160 --> 00:10:42,959
people's support for and it's something

290
00:10:42,959 --> 00:10:45,200
that the engineering has to be set up

291
00:10:45,200 --> 00:10:47,760
for

292
00:10:47,760 --> 00:10:49,519
so when you're talking about increased

293
00:10:49,519 --> 00:10:51,120
visibility

294
00:10:51,120 --> 00:10:53,519
it's not always pleasant

295
00:10:53,519 --> 00:10:55,360
when you start setting up new pipelines

296
00:10:55,360 --> 00:10:57,440
when you start bringing in new data

297
00:10:57,440 --> 00:10:59,360
you're gonna find some stuff that looks

298
00:10:59,360 --> 00:11:00,880
gross

299
00:11:00,880 --> 00:11:02,880
some of it's dangerous gross some of

300
00:11:02,880 --> 00:11:05,519
it's just gen and some of it's just

301
00:11:05,519 --> 00:11:07,040
gross

302
00:11:07,040 --> 00:11:08,079
but

303
00:11:08,079 --> 00:11:10,800
be prepared to find some things that you

304
00:11:10,800 --> 00:11:13,519
probably didn't want to know

305
00:11:13,519 --> 00:11:15,519
and on top of that

306
00:11:15,519 --> 00:11:17,600
you're probably going to find

307
00:11:17,600 --> 00:11:21,200
some departments in your organization

308
00:11:21,200 --> 00:11:23,519
that have been creatively solving

309
00:11:23,519 --> 00:11:26,320
problems in ways that are not

310
00:11:26,320 --> 00:11:28,720
great

311
00:11:28,720 --> 00:11:29,760
and

312
00:11:29,760 --> 00:11:31,839
if you can

313
00:11:31,839 --> 00:11:34,079
work with these departments to find

314
00:11:34,079 --> 00:11:36,959
better ways to

315
00:11:36,959 --> 00:11:39,680
get the job done so that they're not

316
00:11:39,680 --> 00:11:41,760
creating noise for you when you're

317
00:11:41,760 --> 00:11:43,360
writing alerts

318
00:11:43,360 --> 00:11:45,839
because a messy environment

319
00:11:45,839 --> 00:11:48,079
is really hard to write good alerting on

320
00:11:48,079 --> 00:11:50,639
if you have a lot of false positives if

321
00:11:50,639 --> 00:11:52,240
you have say

322
00:11:52,240 --> 00:11:56,079
i don't know your entire

323
00:11:56,079 --> 00:11:58,800
mac fleet is being managed by shell

324
00:11:58,800 --> 00:12:02,079
scripts running out of

325
00:12:02,079 --> 00:12:03,760
user directories that's going to look

326
00:12:03,760 --> 00:12:05,200
really sketchy

327
00:12:05,200 --> 00:12:06,800
and you probably want to see if there's

328
00:12:06,800 --> 00:12:09,600
a better way to do that

329
00:12:09,600 --> 00:12:10,720
um

330
00:12:10,720 --> 00:12:12,959
so once you have the data coming into

331
00:12:12,959 --> 00:12:15,519
alert on the next stage

332
00:12:15,519 --> 00:12:18,000
and this is more organizational stuff

333
00:12:18,000 --> 00:12:20,480
is looking at

334
00:12:20,480 --> 00:12:22,079
incident response

335
00:12:22,079 --> 00:12:24,399
and the engineering

336
00:12:24,399 --> 00:12:26,800
and the engineering side of it

337
00:12:26,800 --> 00:12:28,480
so

338
00:12:28,480 --> 00:12:31,279
as i was sort of alluding to earlier i

339
00:12:31,279 --> 00:12:33,839
cannot write alerts in a vacuum i cannot

340
00:12:33,839 --> 00:12:36,880
work alerts in a vacuum like the work i

341
00:12:36,880 --> 00:12:38,959
do as a detection engineer writing

342
00:12:38,959 --> 00:12:42,160
alerts to find badness on our network on

343
00:12:42,160 --> 00:12:43,760
mac os machines

344
00:12:43,760 --> 00:12:45,920
only works because i have other people

345
00:12:45,920 --> 00:12:47,120
on my team

346
00:12:47,120 --> 00:12:48,639
and those other people are mainly

347
00:12:48,639 --> 00:12:51,120
incident response and engineering and in

348
00:12:51,120 --> 00:12:54,240
particular these feedback loops like

349
00:12:54,240 --> 00:12:55,440
communicating with these other

350
00:12:55,440 --> 00:12:58,160
departments and really listening to

351
00:12:58,160 --> 00:13:00,480
the difficulties they're having

352
00:13:00,480 --> 00:13:02,560
that's especially important

353
00:13:02,560 --> 00:13:05,760
with incident response

354
00:13:05,760 --> 00:13:07,440
incident response

355
00:13:07,440 --> 00:13:10,000
needs to

356
00:13:10,000 --> 00:13:12,800
know how to do basic forensics and if

357
00:13:12,800 --> 00:13:13,600
you

358
00:13:13,600 --> 00:13:15,600
are spinning up alerting in mac os and

359
00:13:15,600 --> 00:13:17,360
your team hasn't really done a lot of

360
00:13:17,360 --> 00:13:19,360
mac os forensics before

361
00:13:19,360 --> 00:13:21,040
that's something that you need to

362
00:13:21,040 --> 00:13:23,519
support it might not be you working on

363
00:13:23,519 --> 00:13:24,480
it

364
00:13:24,480 --> 00:13:27,040
but before you roll out your first mac

365
00:13:27,040 --> 00:13:29,040
alert you need to make sure that at

366
00:13:29,040 --> 00:13:31,120
least some portion of your incident

367
00:13:31,120 --> 00:13:33,360
response team knows how to deal with

368
00:13:33,360 --> 00:13:34,560
that

369
00:13:34,560 --> 00:13:36,639
and the other part of this is not just

370
00:13:36,639 --> 00:13:38,560
you telling them

371
00:13:38,560 --> 00:13:41,040
you know information it's them telling

372
00:13:41,040 --> 00:13:43,040
you information too

373
00:13:43,040 --> 00:13:44,320
i

374
00:13:44,320 --> 00:13:46,399
so i've been doing

375
00:13:46,399 --> 00:13:49,920
writing alerts in some form or another

376
00:13:49,920 --> 00:13:52,160
for a few years now like

377
00:13:52,160 --> 00:13:53,600
i switched to this position and i

378
00:13:53,600 --> 00:13:55,040
started to focus on it but i've been

379
00:13:55,040 --> 00:13:57,360
doing it for a few years now

380
00:13:57,360 --> 00:13:58,160
and

381
00:13:58,160 --> 00:14:00,639
i am continually surprised

382
00:14:00,639 --> 00:14:02,320
by the alerts that work and the alerts

383
00:14:02,320 --> 00:14:03,360
that don't

384
00:14:03,360 --> 00:14:05,519
and sometimes

385
00:14:05,519 --> 00:14:07,680
something i've had in testing for two

386
00:14:07,680 --> 00:14:09,680
months looks great

387
00:14:09,680 --> 00:14:12,480
i roll it out and something changes and

388
00:14:12,480 --> 00:14:13,839
all of a sudden there's a bunch of false

389
00:14:13,839 --> 00:14:15,199
positives

390
00:14:15,199 --> 00:14:18,240
and i cannot afford to just ignore

391
00:14:18,240 --> 00:14:19,839
incident responders when they tell me

392
00:14:19,839 --> 00:14:21,440
that because if an alert triggers too

393
00:14:21,440 --> 00:14:24,320
many false positives it will be ignored

394
00:14:24,320 --> 00:14:26,320
that is completely human and completely

395
00:14:26,320 --> 00:14:27,440
natural

396
00:14:27,440 --> 00:14:31,120
and as the person who's managing these

397
00:14:31,120 --> 00:14:34,160
alerts it's important that i'm listening

398
00:14:34,160 --> 00:14:34,959
to

399
00:14:34,959 --> 00:14:36,320
what happens when they actually get

400
00:14:36,320 --> 00:14:38,639
rolled out and responding to people's

401
00:14:38,639 --> 00:14:42,000
concerns and to the extent i can

402
00:14:42,000 --> 00:14:44,720
filtering them or fixing them or in some

403
00:14:44,720 --> 00:14:46,480
cases just saying

404
00:14:46,480 --> 00:14:48,480
that was a nice idea but i don't think

405
00:14:48,480 --> 00:14:50,399
it's going to work

406
00:14:50,399 --> 00:14:52,880
and in addition to incident response

407
00:14:52,880 --> 00:14:54,160
it's also

408
00:14:54,160 --> 00:14:56,240
important to remember

409
00:14:56,240 --> 00:14:59,279
that all of the alerts i write

410
00:14:59,279 --> 00:15:00,720
sit on top of an engineering

411
00:15:00,720 --> 00:15:02,240
infrastructure

412
00:15:02,240 --> 00:15:03,360
and

413
00:15:03,360 --> 00:15:05,600
that's work that i cannot do all by

414
00:15:05,600 --> 00:15:08,240
myself and those are also teams

415
00:15:08,240 --> 00:15:10,639
that i need to work with

416
00:15:10,639 --> 00:15:12,560
and the tools that we're given to work

417
00:15:12,560 --> 00:15:14,480
with i

418
00:15:14,480 --> 00:15:16,240
this isn't going to be news to everyone

419
00:15:16,240 --> 00:15:19,199
but if you haven't worked in infosec

420
00:15:19,199 --> 00:15:21,920
um or you've never had like a job where

421
00:15:21,920 --> 00:15:25,199
you regularly have to deal with a sim or

422
00:15:25,199 --> 00:15:28,079
a central management tool

423
00:15:28,079 --> 00:15:30,720
it is surprising how often

424
00:15:30,720 --> 00:15:33,040
tools are not as good as they were

425
00:15:33,040 --> 00:15:34,720
advertised to be

426
00:15:34,720 --> 00:15:37,120
or they have really

427
00:15:37,120 --> 00:15:39,120
weird little quirks that you just have

428
00:15:39,120 --> 00:15:41,440
to discover on your own and then

429
00:15:41,440 --> 00:15:44,560
understand that maybe in this situation

430
00:15:44,560 --> 00:15:46,720
this tool or this sim isn't going to

431
00:15:46,720 --> 00:15:49,360
give you the answer you're expecting

432
00:15:49,360 --> 00:15:50,480
so

433
00:15:50,480 --> 00:15:52,240
especially when you're rolling out new

434
00:15:52,240 --> 00:15:55,680
pipelines or new data sources

435
00:15:55,680 --> 00:15:57,839
you have to learn your tools you have to

436
00:15:57,839 --> 00:15:59,199
test them

437
00:15:59,199 --> 00:15:59,920
so

438
00:15:59,920 --> 00:16:02,160
let's say you have a vendor that's

439
00:16:02,160 --> 00:16:03,680
promised you they're going to do process

440
00:16:03,680 --> 00:16:06,079
detection and you can write alerts

441
00:16:06,079 --> 00:16:09,680
inside their system to say if a process

442
00:16:09,680 --> 00:16:13,040
runs out of temp and has these other

443
00:16:13,040 --> 00:16:14,880
specifications

444
00:16:14,880 --> 00:16:16,720
then i want you to alert

445
00:16:16,720 --> 00:16:18,320
you should test

446
00:16:18,320 --> 00:16:20,639
by creating that process

447
00:16:20,639 --> 00:16:22,480
or testing as much as you can to make

448
00:16:22,480 --> 00:16:24,720
sure the alert fires as you expect

449
00:16:24,720 --> 00:16:26,800
because there will be gremlins there but

450
00:16:26,800 --> 00:16:28,399
there will be weirdness and you can't

451
00:16:28,399 --> 00:16:32,000
just assume that everything works

452
00:16:32,000 --> 00:16:35,199
and if you're lucky you get a bonus team

453
00:16:35,199 --> 00:16:37,920
and at target we're lucky um we have

454
00:16:37,920 --> 00:16:40,079
something called a hunt team yeah excuse

455
00:16:40,079 --> 00:16:42,959
me just need to

456
00:16:43,600 --> 00:16:44,880
so i don't know if this is true for

457
00:16:44,880 --> 00:16:46,160
anyone else

458
00:16:46,160 --> 00:16:48,160
but since i've been working at home my

459
00:16:48,160 --> 00:16:50,560
voice is not used to speaking for long

460
00:16:50,560 --> 00:16:52,800
periods of time

461
00:16:52,800 --> 00:16:53,759
anyway

462
00:16:53,759 --> 00:16:55,440
back to the presentation

463
00:16:55,440 --> 00:16:57,920
so we are really lucky at target we have

464
00:16:57,920 --> 00:16:59,199
a hunt team

465
00:16:59,199 --> 00:17:00,079
and

466
00:17:00,079 --> 00:17:01,839
even if you don't have a hunt team you

467
00:17:01,839 --> 00:17:04,319
can still set up a hunt week and these

468
00:17:04,319 --> 00:17:06,640
are really useful to test theories

469
00:17:06,640 --> 00:17:08,959
so one of the coolest hunts

470
00:17:08,959 --> 00:17:10,720
that i've done

471
00:17:10,720 --> 00:17:13,039
is we just sat in a room for a week and

472
00:17:13,039 --> 00:17:15,520
looked at what are all the ways

473
00:17:15,520 --> 00:17:16,559
that

474
00:17:16,559 --> 00:17:18,400
lateral movement happens

475
00:17:18,400 --> 00:17:20,720
in mac os environments and how can we

476
00:17:20,720 --> 00:17:23,439
detect those in other words let's turn

477
00:17:23,439 --> 00:17:25,359
on remote apple events and see what the

478
00:17:25,359 --> 00:17:27,359
unified logs look like

479
00:17:27,359 --> 00:17:29,360
can we write some sort of detection for

480
00:17:29,360 --> 00:17:32,000
that is there some sort of say sensor we

481
00:17:32,000 --> 00:17:34,480
can write so after an incident happens

482
00:17:34,480 --> 00:17:36,480
can i scan the environment to see if

483
00:17:36,480 --> 00:17:39,039
remote apple events were used

484
00:17:39,039 --> 00:17:41,120
and this isn't just about lateral

485
00:17:41,120 --> 00:17:42,799
movement if there's a particular piece

486
00:17:42,799 --> 00:17:44,880
of malware that you know it's really

487
00:17:44,880 --> 00:17:46,880
important for you to catch

488
00:17:46,880 --> 00:17:49,360
running that in a controlled environment

489
00:17:49,360 --> 00:17:51,520
and then making sure you know what sort

490
00:17:51,520 --> 00:17:53,440
of artifacts are created

491
00:17:53,440 --> 00:17:55,440
and therefore what you need to search

492
00:17:55,440 --> 00:17:58,840
for those are all super valuable

493
00:17:58,840 --> 00:18:02,400
exercises so based on our hunt weeks and

494
00:18:02,400 --> 00:18:04,880
based on open source information

495
00:18:04,880 --> 00:18:07,440
i'm going to share with you

496
00:18:07,440 --> 00:18:09,679
some alerts that worked for us

497
00:18:09,679 --> 00:18:12,240
so all of these required some testing

498
00:18:12,240 --> 00:18:13,679
and some tuning

499
00:18:13,679 --> 00:18:15,039
but they've all worked in our

500
00:18:15,039 --> 00:18:16,640
environment with relatively good

501
00:18:16,640 --> 00:18:18,720
signal-to-noise ratios

502
00:18:18,720 --> 00:18:21,760
of course your mileage may vary um

503
00:18:21,760 --> 00:18:24,080
because your environment is different

504
00:18:24,080 --> 00:18:25,919
and that's kind of the point of doing

505
00:18:25,919 --> 00:18:28,799
custom alerting you you can really

506
00:18:28,799 --> 00:18:31,360
tailor the alerts to your environment

507
00:18:31,360 --> 00:18:33,520
and catch things early and create those

508
00:18:33,520 --> 00:18:35,600
choke points that we talked about a

509
00:18:35,600 --> 00:18:37,360
little bit ago

510
00:18:37,360 --> 00:18:40,320
uh but before i get into talking about

511
00:18:40,320 --> 00:18:42,559
specific alerts

512
00:18:42,559 --> 00:18:44,400
i want to talk about

513
00:18:44,400 --> 00:18:47,360
how i evaluate alerts

514
00:18:47,360 --> 00:18:48,240
so

515
00:18:48,240 --> 00:18:50,480
when you're trying to figure out to

516
00:18:50,480 --> 00:18:52,080
whether or not you want to implement an

517
00:18:52,080 --> 00:18:54,640
alert or not

518
00:18:54,640 --> 00:18:56,480
definitely false positive

519
00:18:56,480 --> 00:18:58,160
rates and false negative rates are

520
00:18:58,160 --> 00:19:00,559
important and i don't like i'm not

521
00:19:00,559 --> 00:19:02,320
telling you to ignore them

522
00:19:02,320 --> 00:19:05,440
but you also want to factor in risk and

523
00:19:05,440 --> 00:19:07,520
overall volume

524
00:19:07,520 --> 00:19:10,640
so i've made up my answers for this

525
00:19:10,640 --> 00:19:12,799
chart your answers might be a little

526
00:19:12,799 --> 00:19:14,960
different than mine

527
00:19:14,960 --> 00:19:17,360
but when i think about an alert that has

528
00:19:17,360 --> 00:19:20,960
a high false a high false positive rate

529
00:19:20,960 --> 00:19:23,360
but the malware that that alert finds

530
00:19:23,360 --> 00:19:26,640
indicates a very bad day

531
00:19:26,640 --> 00:19:29,360
i might implement it anyway depending on

532
00:19:29,360 --> 00:19:31,840
how often it fires right

533
00:19:31,840 --> 00:19:34,080
if it's firing once a day that's

534
00:19:34,080 --> 00:19:35,919
probably still too much

535
00:19:35,919 --> 00:19:40,080
if it fires once a year even if 50 of

536
00:19:40,080 --> 00:19:42,240
those are false positives then maybe

537
00:19:42,240 --> 00:19:44,080
it's worth implementing

538
00:19:44,080 --> 00:19:45,440
and again your answers might be

539
00:19:45,440 --> 00:19:47,760
different i just want to encourage you

540
00:19:47,760 --> 00:19:51,360
to think beyond you know this has a 50

541
00:19:51,360 --> 00:19:53,360
false positive rate or this has a 90

542
00:19:53,360 --> 00:19:55,919
false positive rate and also factor in

543
00:19:55,919 --> 00:19:58,320
the risk and how often that alert

544
00:19:58,320 --> 00:19:59,840
actually fires

545
00:19:59,840 --> 00:20:01,840
and as a side note you probably have

546
00:20:01,840 --> 00:20:03,440
noticed this presentation as she-ra

547
00:20:03,440 --> 00:20:04,480
themed

548
00:20:04,480 --> 00:20:06,799
if you haven't watched she-ra i highly

549
00:20:06,799 --> 00:20:09,039
recommend it super cool

550
00:20:09,039 --> 00:20:09,919
um

551
00:20:09,919 --> 00:20:11,440
yeah all right

552
00:20:11,440 --> 00:20:14,720
so moving on to

553
00:20:14,720 --> 00:20:16,880
evaluating alerts

554
00:20:16,880 --> 00:20:19,679
when they fire

555
00:20:19,679 --> 00:20:23,120
responders need to understand what an

556
00:20:23,120 --> 00:20:24,559
alert

557
00:20:24,559 --> 00:20:25,679
means

558
00:20:25,679 --> 00:20:28,000
and i know that sounds a little basic

559
00:20:28,000 --> 00:20:29,440
but

560
00:20:29,440 --> 00:20:31,760
when an alert fires it's important to

561
00:20:31,760 --> 00:20:35,120
understand what stage of an attack

562
00:20:35,120 --> 00:20:37,679
that alert references right

563
00:20:37,679 --> 00:20:38,799
so

564
00:20:38,799 --> 00:20:41,200
incident responders always have a list

565
00:20:41,200 --> 00:20:42,880
of things that they're looking at they

566
00:20:42,880 --> 00:20:44,559
always have a list of tickets that's

567
00:20:44,559 --> 00:20:47,120
coming in and they need to prioritize

568
00:20:47,120 --> 00:20:49,200
those tickets so if your alert

569
00:20:49,200 --> 00:20:51,520
represents an attacker that's actively

570
00:20:51,520 --> 00:20:53,280
in the network that's maybe running

571
00:20:53,280 --> 00:20:54,880
recon that's already established a

572
00:20:54,880 --> 00:20:56,480
foothold

573
00:20:56,480 --> 00:20:59,919
it's important to know that versus maybe

574
00:20:59,919 --> 00:21:02,159
this piece of malware got delivered but

575
00:21:02,159 --> 00:21:04,400
it hasn't been executed yet

576
00:21:04,400 --> 00:21:06,960
it's also important to know what types

577
00:21:06,960 --> 00:21:09,280
of malware use this technique so instead

578
00:21:09,280 --> 00:21:10,240
of saying

579
00:21:10,240 --> 00:21:12,799
something bad happened you know this is

580
00:21:12,799 --> 00:21:14,640
used by

581
00:21:14,640 --> 00:21:16,480
ocean lotus for instance

582
00:21:16,480 --> 00:21:19,760
or maybe it's used by bundler

583
00:21:19,760 --> 00:21:22,559
and if you provide that context

584
00:21:22,559 --> 00:21:25,360
it gives people a clue as to where they

585
00:21:25,360 --> 00:21:27,200
should look next

586
00:21:27,200 --> 00:21:30,799
so let's say you fired an alert for

587
00:21:30,799 --> 00:21:33,039
ocean lotus execution

588
00:21:33,039 --> 00:21:35,039
then maybe you can point to some

589
00:21:35,039 --> 00:21:37,360
documentation for here's what the rest

590
00:21:37,360 --> 00:21:40,000
of an ocean lotus infection looks like

591
00:21:40,000 --> 00:21:42,640
so there are spent so the responders can

592
00:21:42,640 --> 00:21:44,880
start to look for artifacts

593
00:21:44,880 --> 00:21:47,919
and confirm that yes this is a problem

594
00:21:47,919 --> 00:21:51,280
or no this was a false positive

595
00:21:51,280 --> 00:21:53,520
all right cool so after that brief

596
00:21:53,520 --> 00:21:55,440
detour um

597
00:21:55,440 --> 00:21:59,200
we'll get to talking about some alerts

598
00:21:59,200 --> 00:22:01,520
that have worked in our environment

599
00:22:01,520 --> 00:22:03,600
and then at the end i'll do a little bit

600
00:22:03,600 --> 00:22:05,039
of a wrap up

601
00:22:05,039 --> 00:22:06,640
and hopefully

602
00:22:06,640 --> 00:22:08,320
after that wrap up there will be time

603
00:22:08,320 --> 00:22:10,400
for questions

604
00:22:10,400 --> 00:22:13,520
uh so suid binaries

605
00:22:13,520 --> 00:22:16,000
for those of you who aren't familiar

606
00:22:16,000 --> 00:22:18,080
with unix's systems

607
00:22:18,080 --> 00:22:21,440
suid binaries are kind of a weird beast

608
00:22:21,440 --> 00:22:23,039
i

609
00:22:23,039 --> 00:22:24,559
i'm not actually sure there's an

610
00:22:24,559 --> 00:22:26,400
equivalent on windows

611
00:22:26,400 --> 00:22:28,240
there might be

612
00:22:28,240 --> 00:22:29,280
anyway

613
00:22:29,280 --> 00:22:31,120
what it means is

614
00:22:31,120 --> 00:22:32,240
that

615
00:22:32,240 --> 00:22:33,440
program

616
00:22:33,440 --> 00:22:35,440
or that executable

617
00:22:35,440 --> 00:22:38,559
when it runs has root permissions

618
00:22:38,559 --> 00:22:42,159
even if the person that executes the

619
00:22:42,159 --> 00:22:43,600
binary

620
00:22:43,600 --> 00:22:46,480
does not have root access

621
00:22:46,480 --> 00:22:49,120
and the reason attackers love these

622
00:22:49,120 --> 00:22:50,960
obviously is because it's something you

623
00:22:50,960 --> 00:22:53,440
can run from user land

624
00:22:53,440 --> 00:22:57,520
but has the privileges of the root user

625
00:22:57,520 --> 00:22:58,480
and

626
00:22:58,480 --> 00:23:00,720
they're also relatively rare

627
00:23:00,720 --> 00:23:03,039
because they are a security risk

628
00:23:03,039 --> 00:23:05,679
i don't know

629
00:23:05,679 --> 00:23:06,880
how far

630
00:23:06,880 --> 00:23:08,799
back

631
00:23:08,799 --> 00:23:10,799
people remember but there was at one

632
00:23:10,799 --> 00:23:12,559
point a pretty serious vulnerability in

633
00:23:12,559 --> 00:23:14,880
one of these suad binaries

634
00:23:14,880 --> 00:23:18,080
and the vulnerability had to do with

635
00:23:18,080 --> 00:23:21,919
being able to parse some command line

636
00:23:21,919 --> 00:23:24,159
things and if they were parsed in

637
00:23:24,159 --> 00:23:26,400
correctly then you could basically

638
00:23:26,400 --> 00:23:28,640
execute arbitrary commands as wrote and

639
00:23:28,640 --> 00:23:30,720
those are the sort of things that suid

640
00:23:30,720 --> 00:23:34,960
binaries if they are not properly built

641
00:23:34,960 --> 00:23:36,960
allow and that's why they're relatively

642
00:23:36,960 --> 00:23:39,520
rare but this is good news for us as

643
00:23:39,520 --> 00:23:40,960
defenders

644
00:23:40,960 --> 00:23:44,400
because we can find their creation or we

645
00:23:44,400 --> 00:23:46,240
can find them sitting on disk so these

646
00:23:46,240 --> 00:23:48,880
two commands these shmod commands

647
00:23:48,880 --> 00:23:52,640
are both process detection things

648
00:23:53,760 --> 00:23:56,480
and if you have os query deployed you

649
00:23:56,480 --> 00:23:59,120
can also use this

650
00:23:59,120 --> 00:24:02,559
query to search for them

651
00:24:02,640 --> 00:24:04,320
i should probably explain a little bit

652
00:24:04,320 --> 00:24:06,640
about os query for people who don't know

653
00:24:06,640 --> 00:24:07,919
about it

654
00:24:07,919 --> 00:24:08,640
so

655
00:24:08,640 --> 00:24:10,080
os query

656
00:24:10,080 --> 00:24:13,440
is a tool that lets you

657
00:24:13,440 --> 00:24:16,000
ask questions about your operating

658
00:24:16,000 --> 00:24:18,640
system as if your operating system were

659
00:24:18,640 --> 00:24:20,559
a sql database

660
00:24:20,559 --> 00:24:24,400
so this select star from suid bin os

661
00:24:24,400 --> 00:24:25,520
query

662
00:24:25,520 --> 00:24:26,960
internally

663
00:24:26,960 --> 00:24:30,159
builds a table called suid underscore

664
00:24:30,159 --> 00:24:33,840
bin which then references suid binaries

665
00:24:33,840 --> 00:24:35,679
present on the system

666
00:24:35,679 --> 00:24:37,600
so it's a really useful tool

667
00:24:37,600 --> 00:24:40,559
particularly for mac os which doesn't

668
00:24:40,559 --> 00:24:43,360
have a lot of tools available right now

669
00:24:43,360 --> 00:24:45,279
so if it's available to you

670
00:24:45,279 --> 00:24:47,679
it's something to consider

671
00:24:47,679 --> 00:24:49,520
the malware that uses

672
00:24:49,520 --> 00:24:51,679
these techniques it's a long list as you

673
00:24:51,679 --> 00:24:53,840
can see below

674
00:24:53,840 --> 00:24:57,919
bundler xcset echelar search mine adware

675
00:24:57,919 --> 00:25:00,080
ocean lotus which is nation state stuff

676
00:25:00,080 --> 00:25:01,760
xcode spy

677
00:25:01,760 --> 00:25:03,360
bella which has been known to be used by

678
00:25:03,360 --> 00:25:04,720
fitting seven

679
00:25:04,720 --> 00:25:05,760
um

680
00:25:05,760 --> 00:25:07,760
so some of this stuff listed here is

681
00:25:07,760 --> 00:25:09,520
adware and i'm gonna talk a little bit

682
00:25:09,520 --> 00:25:11,279
more about that later

683
00:25:11,279 --> 00:25:13,440
but just right now

684
00:25:13,440 --> 00:25:15,120
if it's adware

685
00:25:15,120 --> 00:25:17,520
that doesn't mean you should ignore it

686
00:25:17,520 --> 00:25:20,159
it can still be dangerous and we'll talk

687
00:25:20,159 --> 00:25:23,200
more about that later

688
00:25:23,360 --> 00:25:26,720
another alert that's worked well for us

689
00:25:26,720 --> 00:25:28,960
is the installation of new root

690
00:25:28,960 --> 00:25:31,039
certificates

691
00:25:31,039 --> 00:25:32,720
so

692
00:25:32,720 --> 00:25:33,840
um

693
00:25:33,840 --> 00:25:36,159
certificates are

694
00:25:36,159 --> 00:25:37,679
trying to decide how far in the weeds i

695
00:25:37,679 --> 00:25:40,480
should get if you're not familiar with

696
00:25:40,480 --> 00:25:44,559
how things like say https or

697
00:25:44,559 --> 00:25:46,080
that works

698
00:25:46,080 --> 00:25:48,960
the reason your browser knows to trust a

699
00:25:48,960 --> 00:25:51,279
certain certificate is because it's been

700
00:25:51,279 --> 00:25:52,720
signed

701
00:25:52,720 --> 00:25:53,760
by

702
00:25:53,760 --> 00:25:55,200
one of

703
00:25:55,200 --> 00:25:56,480
the

704
00:25:56,480 --> 00:25:58,960
big organizations that sign certificates

705
00:25:58,960 --> 00:26:01,360
for other companies

706
00:26:01,360 --> 00:26:03,679
but sometimes you as a company are going

707
00:26:03,679 --> 00:26:05,440
to install your own root certificates

708
00:26:05,440 --> 00:26:08,080
like say maybe you're putting in a proxy

709
00:26:08,080 --> 00:26:10,000
that's going to intercept web traffic in

710
00:26:10,000 --> 00:26:11,520
that case you're going to be installing

711
00:26:11,520 --> 00:26:13,600
your own certificate

712
00:26:13,600 --> 00:26:15,520
so that you can man in the middle

713
00:26:15,520 --> 00:26:18,159
traffic in an authorized way

714
00:26:18,159 --> 00:26:20,480
but of course if you are an attacker

715
00:26:20,480 --> 00:26:22,240
being able to man in the middle traffic

716
00:26:22,240 --> 00:26:25,360
in an unauthorized way is also super

717
00:26:25,360 --> 00:26:26,640
useful

718
00:26:26,640 --> 00:26:29,440
and installing a new root certificate

719
00:26:29,440 --> 00:26:32,559
will allow an attacker to intercept and

720
00:26:32,559 --> 00:26:34,480
modify network traffic

721
00:26:34,480 --> 00:26:37,279
without your users ever knowing that

722
00:26:37,279 --> 00:26:38,960
there's a problem

723
00:26:38,960 --> 00:26:40,880
these are the two commands

724
00:26:40,880 --> 00:26:42,480
that look for

725
00:26:42,480 --> 00:26:45,279
installation of new certificates

726
00:26:45,279 --> 00:26:48,799
this is process detection only as far as

727
00:26:48,799 --> 00:26:50,480
i know

728
00:26:50,480 --> 00:26:51,600
um

729
00:26:51,600 --> 00:26:54,080
i think there is a way to list

730
00:26:54,080 --> 00:26:55,039
let me

731
00:26:55,039 --> 00:26:57,360
clarify i know there is a way to list

732
00:26:57,360 --> 00:26:59,200
all the root certificates present on a

733
00:26:59,200 --> 00:27:00,720
system

734
00:27:00,720 --> 00:27:03,760
that data is surprisingly messy

735
00:27:03,760 --> 00:27:05,919
so if it's a short enough list in your

736
00:27:05,919 --> 00:27:07,360
environment that you can list all of

737
00:27:07,360 --> 00:27:09,760
those certificates and say boom done

738
00:27:09,760 --> 00:27:12,159
anything that's not on this list that i

739
00:27:12,159 --> 00:27:14,000
know to be good is bad

740
00:27:14,000 --> 00:27:15,200
awesome

741
00:27:15,200 --> 00:27:18,320
but i suspect that won't be the case

742
00:27:18,320 --> 00:27:20,320
um so anyway you can detect the

743
00:27:20,320 --> 00:27:22,080
installation of new root certificates

744
00:27:22,080 --> 00:27:23,679
using these commands

745
00:27:23,679 --> 00:27:26,480
this is used by doc malware and some

746
00:27:26,480 --> 00:27:29,039
malicious browser extensions

747
00:27:29,039 --> 00:27:31,200
some of which

748
00:27:31,200 --> 00:27:34,799
are look like adware stuff but again

749
00:27:34,799 --> 00:27:37,200
if it's adware it still can be dangerous

750
00:27:37,200 --> 00:27:38,960
particularly if it's intercepting

751
00:27:38,960 --> 00:27:39,919
traffic

752
00:27:39,919 --> 00:27:41,760
even if it's intercepting traffic just

753
00:27:41,760 --> 00:27:44,960
to install ads or say may maybe

754
00:27:44,960 --> 00:27:47,919
redirect traffic to

755
00:27:47,919 --> 00:27:49,840
their favorite search engine

756
00:27:49,840 --> 00:27:52,000
it's still redirecting traffic it's

757
00:27:52,000 --> 00:27:55,840
still a new certificate on your network

758
00:27:57,039 --> 00:27:59,200
all right um

759
00:27:59,200 --> 00:28:01,360
launch agents

760
00:28:01,360 --> 00:28:04,480
so at the beginning i talked about

761
00:28:04,480 --> 00:28:06,720
persistence mechanisms being a good

762
00:28:06,720 --> 00:28:08,960
target for custom alerting

763
00:28:08,960 --> 00:28:11,840
and this one has been really useful for

764
00:28:11,840 --> 00:28:12,640
us

765
00:28:12,640 --> 00:28:15,360
so for people who aren't familiar

766
00:28:15,360 --> 00:28:17,679
with mac os systems

767
00:28:17,679 --> 00:28:19,360
a launch agent

768
00:28:19,360 --> 00:28:21,679
is really just a configuration file and

769
00:28:21,679 --> 00:28:23,279
it says hey

770
00:28:23,279 --> 00:28:26,159
run this every time the system boots or

771
00:28:26,159 --> 00:28:28,640
maybe you run it on a schedule

772
00:28:28,640 --> 00:28:31,039
and launch agents

773
00:28:31,039 --> 00:28:33,679
just have a command in them so

774
00:28:33,679 --> 00:28:35,760
in that configuration file you specify

775
00:28:35,760 --> 00:28:37,679
when the launch agent runs

776
00:28:37,679 --> 00:28:40,159
and then you also specify the command

777
00:28:40,159 --> 00:28:41,679
that gets run

778
00:28:41,679 --> 00:28:44,960
and for most well-behaving applications

779
00:28:44,960 --> 00:28:46,399
that command

780
00:28:46,399 --> 00:28:47,760
is

781
00:28:47,760 --> 00:28:50,480
the binary for that application

782
00:28:50,480 --> 00:28:53,200
but launch agents can use python they

783
00:28:53,200 --> 00:28:55,840
can use perl you can put

784
00:28:55,840 --> 00:28:58,559
a shell script in a launch agent if you

785
00:28:58,559 --> 00:28:59,600
want

786
00:28:59,600 --> 00:29:01,279
and you can even put hidden directories

787
00:29:01,279 --> 00:29:05,120
in a launch agent it just you're just

788
00:29:05,120 --> 00:29:07,520
including a configuration key that

789
00:29:07,520 --> 00:29:10,320
specifies a command to run and what you

790
00:29:10,320 --> 00:29:13,440
put in there is really flexible

791
00:29:13,440 --> 00:29:15,039
one of the most common persistence

792
00:29:15,039 --> 00:29:16,960
mechanisms that we see

793
00:29:16,960 --> 00:29:20,159
in malware is user land launch agents so

794
00:29:20,159 --> 00:29:22,320
there are two versions of launch agents

795
00:29:22,320 --> 00:29:23,919
on mac os

796
00:29:23,919 --> 00:29:26,720
one of them requires privileges to

797
00:29:26,720 --> 00:29:29,279
install and one of them doesn't which

798
00:29:29,279 --> 00:29:31,600
means it's a very attractive target for

799
00:29:31,600 --> 00:29:32,880
malware

800
00:29:32,880 --> 00:29:35,039
and in a lot of cases

801
00:29:35,039 --> 00:29:36,640
they don't want to download their own

802
00:29:36,640 --> 00:29:38,880
binary which is why they're using things

803
00:29:38,880 --> 00:29:41,120
like python and perl

804
00:29:41,120 --> 00:29:42,960
because one of the great things about

805
00:29:42,960 --> 00:29:45,600
mac os and the reason that i have used

806
00:29:45,600 --> 00:29:47,760
it for a long time

807
00:29:47,760 --> 00:29:49,679
is because it's like having a unix

808
00:29:49,679 --> 00:29:51,840
command line but you also get a pretty

809
00:29:51,840 --> 00:29:53,520
gooey attached to it

810
00:29:53,520 --> 00:29:55,840
but all of those things that make it fun

811
00:29:55,840 --> 00:29:57,679
for me to play around on my machine at

812
00:29:57,679 --> 00:30:00,159
home are also tools that attackers can

813
00:30:00,159 --> 00:30:00,960
use

814
00:30:00,960 --> 00:30:02,960
so you can build a full back door in

815
00:30:02,960 --> 00:30:04,240
python

816
00:30:04,240 --> 00:30:06,159
you don't need to install python on a

817
00:30:06,159 --> 00:30:08,080
mac to do that it's already sitting

818
00:30:08,080 --> 00:30:10,000
around basically everything you need is

819
00:30:10,000 --> 00:30:10,880
there

820
00:30:10,880 --> 00:30:12,399
you just need to

821
00:30:12,399 --> 00:30:15,600
get the code down there

822
00:30:15,600 --> 00:30:18,320
sorry that was a bit of my digression

823
00:30:18,320 --> 00:30:21,039
but anyway you can implement this via

824
00:30:21,039 --> 00:30:23,440
yara 6 and it's a pretty basic yara

825
00:30:23,440 --> 00:30:24,720
signature

826
00:30:24,720 --> 00:30:26,640
because these are text files they're

827
00:30:26,640 --> 00:30:28,480
small text files because like i said

828
00:30:28,480 --> 00:30:30,799
they're just configuration files

829
00:30:30,799 --> 00:30:32,480
and you can look for that configuration

830
00:30:32,480 --> 00:30:33,520
key

831
00:30:33,520 --> 00:30:35,760
that specifies the command to run and

832
00:30:35,760 --> 00:30:37,360
then look for

833
00:30:37,360 --> 00:30:39,840
suspicious scripting languages basically

834
00:30:39,840 --> 00:30:41,840
we've seen this used by

835
00:30:41,840 --> 00:30:44,240
multiple fake flash infections

836
00:30:44,240 --> 00:30:47,919
and some other types of malware

837
00:30:49,120 --> 00:30:52,399
all right um another type of persistence

838
00:30:52,399 --> 00:30:54,720
this is going to be a common theme here

839
00:30:54,720 --> 00:30:56,320
uh because i think

840
00:30:56,320 --> 00:30:57,279
that

841
00:30:57,279 --> 00:30:59,200
concentrating on persistence mechanisms

842
00:30:59,200 --> 00:31:01,360
is one of the best ways to do alerting

843
00:31:01,360 --> 00:31:03,519
in your environment

844
00:31:03,519 --> 00:31:05,760
um is cron jobs

845
00:31:05,760 --> 00:31:07,679
so again if you're not familiar with

846
00:31:07,679 --> 00:31:09,600
unix cron jobs are just a way of

847
00:31:09,600 --> 00:31:11,600
scheduling tasks

848
00:31:11,600 --> 00:31:14,080
they're specified in what's a pretty

849
00:31:14,080 --> 00:31:15,840
simple configuration file where you

850
00:31:15,840 --> 00:31:18,480
specify do they run daily monthly

851
00:31:18,480 --> 00:31:21,600
on a specific hour every other week

852
00:31:21,600 --> 00:31:24,159
it's pretty flexible

853
00:31:24,159 --> 00:31:26,159
and because

854
00:31:26,159 --> 00:31:30,159
cron tabs are defined per user

855
00:31:30,159 --> 00:31:32,640
you do not need elevated privileges to

856
00:31:32,640 --> 00:31:33,679
install

857
00:31:33,679 --> 00:31:37,600
a cron tab for the user on that machine

858
00:31:37,600 --> 00:31:40,000
which obviously means as an attacker

859
00:31:40,000 --> 00:31:41,200
it's a great way to establish

860
00:31:41,200 --> 00:31:42,880
persistence

861
00:31:42,880 --> 00:31:44,840
um and

862
00:31:44,840 --> 00:31:47,360
the one of the easiest ways to find

863
00:31:47,360 --> 00:31:49,279
these is with os query

864
00:31:49,279 --> 00:31:51,120
uh with that query that i have there

865
00:31:51,120 --> 00:31:53,440
select star from cron tab

866
00:31:53,440 --> 00:31:56,240
process detection gets a little tricky

867
00:31:56,240 --> 00:31:58,320
here because basically you're looking

868
00:31:58,320 --> 00:32:00,720
for something that edits that

869
00:32:00,720 --> 00:32:02,720
crontab file

870
00:32:02,720 --> 00:32:04,880
and there are a lot of ways to edit a

871
00:32:04,880 --> 00:32:06,559
crontab file

872
00:32:06,559 --> 00:32:07,840
so

873
00:32:07,840 --> 00:32:10,799
if you do want to do this

874
00:32:10,799 --> 00:32:13,039
via some sort of process detection i

875
00:32:13,039 --> 00:32:15,200
recommend looking for changes to the

876
00:32:15,200 --> 00:32:17,279
crontab files as opposed to looking for

877
00:32:17,279 --> 00:32:19,600
a process that matches a specific

878
00:32:19,600 --> 00:32:21,679
signature and these are the paths that

879
00:32:21,679 --> 00:32:24,080
you would use in that case var a t or

880
00:32:24,080 --> 00:32:26,559
depending on how your tool reports it

881
00:32:26,559 --> 00:32:30,000
system volumes data private var at

882
00:32:30,000 --> 00:32:32,559
cron jobs are known to be used by impair

883
00:32:32,559 --> 00:32:35,200
empire gravity rat qbrat and vind

884
00:32:35,200 --> 00:32:36,559
installer and these are some pretty

885
00:32:36,559 --> 00:32:39,679
heavy hitting pieces of malware so

886
00:32:39,679 --> 00:32:41,360
they're a good target

887
00:32:41,360 --> 00:32:42,399
and especially

888
00:32:42,399 --> 00:32:43,200
if

889
00:32:43,200 --> 00:32:45,919
again you know in your org cron jobs

890
00:32:45,919 --> 00:32:48,399
aren't normally used it's a really good

891
00:32:48,399 --> 00:32:52,159
way to start finding some bad things

892
00:32:52,159 --> 00:32:54,480
another method of persistence

893
00:32:54,480 --> 00:32:56,480
i hope you're sensing a theme here

894
00:32:56,480 --> 00:32:59,039
is doc replacement

895
00:32:59,039 --> 00:33:00,240
and

896
00:33:00,240 --> 00:33:02,240
i am going to link to the blog post

897
00:33:02,240 --> 00:33:04,159
later so you can read about all the gory

898
00:33:04,159 --> 00:33:05,360
details

899
00:33:05,360 --> 00:33:07,200
but sort of the

900
00:33:07,200 --> 00:33:09,440
top level overview here is doc

901
00:33:09,440 --> 00:33:11,519
replacement is the equivalent of link

902
00:33:11,519 --> 00:33:12,960
persistence

903
00:33:12,960 --> 00:33:14,640
on windows

904
00:33:14,640 --> 00:33:16,480
so again you can look at the blog post

905
00:33:16,480 --> 00:33:17,519
later i

906
00:33:17,519 --> 00:33:19,840
it's too much to go into right now

907
00:33:19,840 --> 00:33:22,799
in order to

908
00:33:22,799 --> 00:33:24,960
look for this technique

909
00:33:24,960 --> 00:33:28,000
you can look for changes to file paths

910
00:33:28,000 --> 00:33:30,240
that end with this path right here

911
00:33:30,240 --> 00:33:33,919
library preferences com.apple.plist

912
00:33:33,919 --> 00:33:37,360
um and i say end with because there is a

913
00:33:37,360 --> 00:33:39,840
copy of this file for each user and

914
00:33:39,840 --> 00:33:42,240
there is also a copy at the system level

915
00:33:42,240 --> 00:33:44,240
so if you want to change this file you

916
00:33:44,240 --> 00:33:46,480
can change it in either place

917
00:33:46,480 --> 00:33:48,399
and as a defender

918
00:33:48,399 --> 00:33:50,399
you should be aware that there are two

919
00:33:50,399 --> 00:33:51,679
different places to establish

920
00:33:51,679 --> 00:33:53,279
persistence this way

921
00:33:53,279 --> 00:33:55,120
and we've seen this used by some fake

922
00:33:55,120 --> 00:33:58,080
flash infections

923
00:33:58,720 --> 00:34:00,399
all right i think

924
00:34:00,399 --> 00:34:01,679
that is all

925
00:34:01,679 --> 00:34:03,760
for most of our persistence mechanisms

926
00:34:03,760 --> 00:34:05,519
anyway

927
00:34:05,519 --> 00:34:08,159
and i'm gonna i have a few more alerts

928
00:34:08,159 --> 00:34:09,520
to go through and then we'll get to the

929
00:34:09,520 --> 00:34:11,119
wrap up

930
00:34:11,119 --> 00:34:13,359
the quarantine attribute

931
00:34:13,359 --> 00:34:14,800
is

932
00:34:14,800 --> 00:34:16,960
a really useful bit of information on

933
00:34:16,960 --> 00:34:18,079
mac os

934
00:34:18,079 --> 00:34:19,760
i'm going to explain a little bit about

935
00:34:19,760 --> 00:34:22,159
it just so people who aren't familiar

936
00:34:22,159 --> 00:34:24,399
might have the background

937
00:34:24,399 --> 00:34:27,199
when you download a file via chrome

938
00:34:27,199 --> 00:34:28,879
on your mac machine

939
00:34:28,879 --> 00:34:31,599
it gets the quarantine attribute added

940
00:34:31,599 --> 00:34:35,119
as a piece of metadata basically

941
00:34:35,119 --> 00:34:37,520
and then the internal security features

942
00:34:37,520 --> 00:34:39,839
like gatekeeper or xprotect or their

943
00:34:39,839 --> 00:34:42,320
malware removal tool

944
00:34:42,320 --> 00:34:44,639
look at files with the quarantine

945
00:34:44,639 --> 00:34:46,239
attribute

946
00:34:46,239 --> 00:34:48,480
and because so much

947
00:34:48,480 --> 00:34:49,440
of

948
00:34:49,440 --> 00:34:51,440
mac's internal security tools depend on

949
00:34:51,440 --> 00:34:54,000
that quarantine attribute being present

950
00:34:54,000 --> 00:34:56,079
a lot of malware likes to take that

951
00:34:56,079 --> 00:34:57,760
attribute away

952
00:34:57,760 --> 00:34:58,480
so

953
00:34:58,480 --> 00:35:00,000
the thing that's important to understand

954
00:35:00,000 --> 00:35:02,640
here is the quarantine attribute is just

955
00:35:02,640 --> 00:35:04,560
a piece of metadata

956
00:35:04,560 --> 00:35:06,400
that sits on that file

957
00:35:06,400 --> 00:35:08,640
you do not need root privileges to

958
00:35:08,640 --> 00:35:09,839
remove it

959
00:35:09,839 --> 00:35:11,839
and in fact not everything that gets

960
00:35:11,839 --> 00:35:13,680
downloaded has to have a quarantine

961
00:35:13,680 --> 00:35:14,720
attribute

962
00:35:14,720 --> 00:35:17,040
programs like curl when they download

963
00:35:17,040 --> 00:35:18,400
things don't add the quarantine

964
00:35:18,400 --> 00:35:19,760
attribute

965
00:35:19,760 --> 00:35:20,560
um

966
00:35:20,560 --> 00:35:22,079
but anyway

967
00:35:22,079 --> 00:35:24,480
you can use process detection to find

968
00:35:24,480 --> 00:35:26,480
out when the attribute gets removed and

969
00:35:26,480 --> 00:35:28,720
that's with this x adder command

970
00:35:28,720 --> 00:35:30,800
x adder um

971
00:35:30,800 --> 00:35:33,280
is how you edit attributes

972
00:35:33,280 --> 00:35:35,680
this dash d means delete and

973
00:35:35,680 --> 00:35:37,760
com.apple.quarantine

974
00:35:37,760 --> 00:35:40,480
is the bit of data or if you want to

975
00:35:40,480 --> 00:35:42,720
think of it the key

976
00:35:42,720 --> 00:35:45,839
and that tells gatekeeper and xprotect

977
00:35:45,839 --> 00:35:47,680
that hey this file was downloaded from

978
00:35:47,680 --> 00:35:49,359
the internet so you might want to check

979
00:35:49,359 --> 00:35:50,400
it out

980
00:35:50,400 --> 00:35:52,079
and we've seen this

981
00:35:52,079 --> 00:35:53,839
i say we've um

982
00:35:53,839 --> 00:35:55,359
i should rephrase that it has been

983
00:35:55,359 --> 00:35:57,760
documented that this is used by ocean

984
00:35:57,760 --> 00:35:59,839
lotus and xcset

985
00:35:59,839 --> 00:36:01,599
so some of the things i'm talking about

986
00:36:01,599 --> 00:36:02,480
here

987
00:36:02,480 --> 00:36:05,440
uh what malware uses what technique are

988
00:36:05,440 --> 00:36:07,520
oscent and

989
00:36:07,520 --> 00:36:10,000
i will give you a link to that at the

990
00:36:10,000 --> 00:36:12,800
end

991
00:36:12,800 --> 00:36:14,400
all right

992
00:36:14,400 --> 00:36:18,079
um execution from library scripts is a

993
00:36:18,079 --> 00:36:20,800
sign of malware and it's also relatively

994
00:36:20,800 --> 00:36:21,839
rare

995
00:36:21,839 --> 00:36:23,680
in normal operation

996
00:36:23,680 --> 00:36:26,400
which again good for defenders

997
00:36:26,400 --> 00:36:28,960
and you can just look for processes that

998
00:36:28,960 --> 00:36:31,680
start with this

999
00:36:31,680 --> 00:36:33,760
this is known to be used by snake

1000
00:36:33,760 --> 00:36:36,240
malware which is not a long list but

1001
00:36:36,240 --> 00:36:40,680
snake is a pretty nasty piece of malware

1002
00:36:43,440 --> 00:36:46,880
python i mentioned earlier is a thing

1003
00:36:46,880 --> 00:36:49,680
that is sometimes used by launch agents

1004
00:36:49,680 --> 00:36:51,839
to

1005
00:36:51,839 --> 00:36:54,640
establish persistence and with to

1006
00:36:54,640 --> 00:36:56,720
establish persistence without

1007
00:36:56,720 --> 00:37:00,160
bringing down your own uh custom binary

1008
00:37:00,160 --> 00:37:03,040
or maco executable

1009
00:37:03,040 --> 00:37:06,240
this python as a parent of openssl or

1010
00:37:06,240 --> 00:37:09,839
osa script is especially suspicious

1011
00:37:09,839 --> 00:37:10,960
um

1012
00:37:10,960 --> 00:37:14,000
because openssl is something that's used

1013
00:37:14,000 --> 00:37:15,200
to do

1014
00:37:15,200 --> 00:37:18,480
command line encryption or decryption so

1015
00:37:18,480 --> 00:37:19,440
if you're

1016
00:37:19,440 --> 00:37:21,200
a piece of malware and you want to pull

1017
00:37:21,200 --> 00:37:22,720
down like

1018
00:37:22,720 --> 00:37:25,760
an encrypted or obfuscated bit of code

1019
00:37:25,760 --> 00:37:27,040
and you want to decrypt it or

1020
00:37:27,040 --> 00:37:29,440
de-obfuscate it on the command line you

1021
00:37:29,440 --> 00:37:31,599
can use openssl

1022
00:37:31,599 --> 00:37:34,800
osa script is another scripting language

1023
00:37:34,800 --> 00:37:36,800
that's built in on mac os

1024
00:37:36,800 --> 00:37:38,640
that attackers like

1025
00:37:38,640 --> 00:37:42,000
because you can pop up really realistic

1026
00:37:42,000 --> 00:37:44,160
dialog boxes

1027
00:37:44,160 --> 00:37:46,560
using osa script you can pop up things

1028
00:37:46,560 --> 00:37:48,720
like hey this installer requires your

1029
00:37:48,720 --> 00:37:51,119
password to

1030
00:37:51,119 --> 00:37:53,119
proceed and then get the user to enter

1031
00:37:53,119 --> 00:37:55,520
their password and then capture it

1032
00:37:55,520 --> 00:37:58,400
and users fall for these dialog boxes

1033
00:37:58,400 --> 00:38:00,480
not because they're dumb but because

1034
00:38:00,480 --> 00:38:02,720
they look really similar to the system

1035
00:38:02,720 --> 00:38:05,280
dialog boxes that pop up and say

1036
00:38:05,280 --> 00:38:07,839
we need your password um and this

1037
00:38:07,839 --> 00:38:10,640
technique is known to be used by bella

1038
00:38:10,640 --> 00:38:14,400
evil osx and sh layer which is adware

1039
00:38:14,400 --> 00:38:16,800
but again you know don't discount all

1040
00:38:16,800 --> 00:38:18,880
adware

1041
00:38:18,880 --> 00:38:21,760
and the last alert we're going to cover

1042
00:38:21,760 --> 00:38:23,520
today

1043
00:38:23,520 --> 00:38:26,800
is deleting unified logs

1044
00:38:26,800 --> 00:38:28,320
this is one of my favorite scenes in

1045
00:38:28,320 --> 00:38:29,680
shira

1046
00:38:29,680 --> 00:38:31,040
but

1047
00:38:31,040 --> 00:38:33,440
i should not get distracted all right so

1048
00:38:33,440 --> 00:38:35,440
i talked in the beginning a little bit

1049
00:38:35,440 --> 00:38:37,599
about how there was syslog and then

1050
00:38:37,599 --> 00:38:39,119
there was apple system logs and now

1051
00:38:39,119 --> 00:38:41,280
there's unified logs

1052
00:38:41,280 --> 00:38:43,760
unified logs can be messy but they are

1053
00:38:43,760 --> 00:38:45,839
one of the richest source sources of

1054
00:38:45,839 --> 00:38:48,800
information on mac os hosts there are

1055
00:38:48,800 --> 00:38:50,880
things that you can find in unified logs

1056
00:38:50,880 --> 00:38:53,440
that you cannot find from any other

1057
00:38:53,440 --> 00:38:55,119
source

1058
00:38:55,119 --> 00:38:57,200
you can access them via the log show

1059
00:38:57,200 --> 00:38:59,599
command you can search them

1060
00:38:59,599 --> 00:39:01,760
i don't have time in this presentation

1061
00:39:01,760 --> 00:39:03,040
to go over

1062
00:39:03,040 --> 00:39:05,280
what to look for that was a previous

1063
00:39:05,280 --> 00:39:06,720
presentation

1064
00:39:06,720 --> 00:39:09,680
but this is precisely why attackers want

1065
00:39:09,680 --> 00:39:11,200
to delete them

1066
00:39:11,200 --> 00:39:14,560
and if you have elevated privileges

1067
00:39:14,560 --> 00:39:16,640
like rope privileges you can delete them

1068
00:39:16,640 --> 00:39:19,839
using this log erase command

1069
00:39:19,839 --> 00:39:22,560
i don't have any specific groups or

1070
00:39:22,560 --> 00:39:25,359
malware that i can put on this slide

1071
00:39:25,359 --> 00:39:27,440
but i do

1072
00:39:27,440 --> 00:39:30,079
um i did hear an objective by the sea

1073
00:39:30,079 --> 00:39:32,000
last year that this was a technique

1074
00:39:32,000 --> 00:39:34,240
being used in the wild that attackers

1075
00:39:34,240 --> 00:39:35,680
were going through and just

1076
00:39:35,680 --> 00:39:38,079
erasing all the logs in the host to hide

1077
00:39:38,079 --> 00:39:40,160
their footprints

1078
00:39:40,160 --> 00:39:41,359
all right

1079
00:39:41,359 --> 00:39:43,680
so it looks like we're pretty good on

1080
00:39:43,680 --> 00:39:45,280
time here i'm gonna do a wrap up and

1081
00:39:45,280 --> 00:39:47,520
then we should have time

1082
00:39:47,520 --> 00:39:50,560
to do some q a

1083
00:39:50,560 --> 00:39:53,200
so i've talked about a lot people tell

1084
00:39:53,200 --> 00:39:55,839
me i tend to talk fast so

1085
00:39:55,839 --> 00:39:57,680
hopefully i didn't overwhelm you too

1086
00:39:57,680 --> 00:39:59,280
much

1087
00:39:59,280 --> 00:40:01,440
but if you're looking for a place to

1088
00:40:01,440 --> 00:40:04,000
start doing mac alerting

1089
00:40:04,000 --> 00:40:06,240
i really recommend start with

1090
00:40:06,240 --> 00:40:08,560
persistence mechanisms

1091
00:40:08,560 --> 00:40:11,280
because even though attackers have a

1092
00:40:11,280 --> 00:40:14,000
billion ways to get on to a host there

1093
00:40:14,000 --> 00:40:16,400
are only a few ways to persist

1094
00:40:16,400 --> 00:40:19,200
and there are only a few ways to persist

1095
00:40:19,200 --> 00:40:21,440
that are built into the operating system

1096
00:40:21,440 --> 00:40:24,240
right so if you can look for changes to

1097
00:40:24,240 --> 00:40:26,079
startup items or

1098
00:40:26,079 --> 00:40:28,400
login items or

1099
00:40:28,400 --> 00:40:29,520
cron

1100
00:40:29,520 --> 00:40:31,759
or

1101
00:40:32,960 --> 00:40:34,880
there's a couple others that i'm

1102
00:40:34,880 --> 00:40:37,040
that are a little bit

1103
00:40:37,040 --> 00:40:38,400
uh

1104
00:40:38,400 --> 00:40:40,079
like launch agents and launch demons are

1105
00:40:40,079 --> 00:40:42,160
obvious but there's also like

1106
00:40:42,160 --> 00:40:44,720
file and folder actions like if you can

1107
00:40:44,720 --> 00:40:46,000
nail down

1108
00:40:46,000 --> 00:40:48,720
what exists in your environment what is

1109
00:40:48,720 --> 00:40:50,480
used by

1110
00:40:50,480 --> 00:40:52,800
the people who manage your max or used

1111
00:40:52,800 --> 00:40:54,800
by the people who

1112
00:40:54,800 --> 00:40:56,960
actually use your macs every day and

1113
00:40:56,960 --> 00:40:59,280
then just alert on everything else

1114
00:40:59,280 --> 00:41:02,480
that's a really good place to start

1115
00:41:02,480 --> 00:41:05,200
common activities done by malware is

1116
00:41:05,200 --> 00:41:07,280
also another really good place to start

1117
00:41:07,280 --> 00:41:09,839
i mentioned curl earlier

1118
00:41:09,839 --> 00:41:12,000
a lot of the malware we see

1119
00:41:12,000 --> 00:41:14,000
loves doubt loves to download things

1120
00:41:14,000 --> 00:41:15,280
with curl

1121
00:41:15,280 --> 00:41:17,200
curl does not add the quarantine

1122
00:41:17,200 --> 00:41:19,440
attribute when it downloads a file and

1123
00:41:19,440 --> 00:41:21,200
this is one of the reason that malware

1124
00:41:21,200 --> 00:41:23,119
really likes to use curl

1125
00:41:23,119 --> 00:41:24,960
because if it doesn't have the

1126
00:41:24,960 --> 00:41:26,720
quarantine flag it doesn't get scanned

1127
00:41:26,720 --> 00:41:28,640
by gatekeeper it doesn't get scanned by

1128
00:41:28,640 --> 00:41:31,280
xprotect and that malware can fly right

1129
00:41:31,280 --> 00:41:34,400
under the radar um

1130
00:41:34,400 --> 00:41:37,520
scripting is another good target for

1131
00:41:37,520 --> 00:41:39,760
custom alerting in your environment

1132
00:41:39,760 --> 00:41:42,400
so built in on mac os there is python

1133
00:41:42,400 --> 00:41:44,720
there is perl there is osa script

1134
00:41:44,720 --> 00:41:45,760
there's

1135
00:41:45,760 --> 00:41:47,760
a few different kinds of shells

1136
00:41:47,760 --> 00:41:50,000
all of these can be used to do scripting

1137
00:41:50,000 --> 00:41:50,960
and

1138
00:41:50,960 --> 00:41:52,640
patterns like

1139
00:41:52,640 --> 00:41:55,839
openssl as a child of python

1140
00:41:55,839 --> 00:41:58,800
or other anomalous uses are a good place

1141
00:41:58,800 --> 00:42:00,000
to start

1142
00:42:00,000 --> 00:42:02,880
looking for bad things

1143
00:42:02,880 --> 00:42:05,520
if you're lucky and your users don't

1144
00:42:05,520 --> 00:42:07,440
install a lot of software outside of

1145
00:42:07,440 --> 00:42:09,920
like your centrally managed catalog

1146
00:42:09,920 --> 00:42:13,280
you can look for installs from dmgs

1147
00:42:13,280 --> 00:42:14,560
i would say

1148
00:42:14,560 --> 00:42:18,240
like 90 of the malware we see

1149
00:42:18,240 --> 00:42:21,520
is some infection because a malicious ad

1150
00:42:21,520 --> 00:42:24,319
popped up or something like something

1151
00:42:24,319 --> 00:42:26,160
popped up on the user's screen saying

1152
00:42:26,160 --> 00:42:28,160
you need to upgrade flash

1153
00:42:28,160 --> 00:42:30,800
even though flash is no longer a thing

1154
00:42:30,800 --> 00:42:32,960
people still click on it people still

1155
00:42:32,960 --> 00:42:35,359
download that malicious dmg and then

1156
00:42:35,359 --> 00:42:37,119
install software

1157
00:42:37,119 --> 00:42:38,960
and recon commands

1158
00:42:38,960 --> 00:42:41,599
so just like there's a set of commands

1159
00:42:41,599 --> 00:42:43,839
you run on windows to get a feel for

1160
00:42:43,839 --> 00:42:46,079
what's running in that environment

1161
00:42:46,079 --> 00:42:49,920
like ipconfig who am i um

1162
00:42:49,920 --> 00:42:52,160
there's a bunch of commands that malware

1163
00:42:52,160 --> 00:42:54,800
tends to run in mac os environments so

1164
00:42:54,800 --> 00:42:56,720
who am i which works on both macs and

1165
00:42:56,720 --> 00:42:58,640
windows um

1166
00:42:58,640 --> 00:43:02,000
ifconfig syscontrol uh listing kernel

1167
00:43:02,000 --> 00:43:04,240
extensions like all of those recon

1168
00:43:04,240 --> 00:43:06,640
commands if they're not being done

1169
00:43:06,640 --> 00:43:07,440
by

1170
00:43:07,440 --> 00:43:10,160
the tool that's managing your max it's

1171
00:43:10,160 --> 00:43:14,079
probably not a good thing

1172
00:43:14,079 --> 00:43:15,119
and

1173
00:43:15,119 --> 00:43:17,359
if i were in person this is where i

1174
00:43:17,359 --> 00:43:19,520
would get out my soapbox and climb on

1175
00:43:19,520 --> 00:43:20,800
top of it

1176
00:43:20,800 --> 00:43:23,280
uh i really think

1177
00:43:23,280 --> 00:43:26,720
we underestimate adware there's a lot of

1178
00:43:26,720 --> 00:43:28,880
stuff that gets labeled as pua or you

1179
00:43:28,880 --> 00:43:31,200
know that's just bundler that's just sh

1180
00:43:31,200 --> 00:43:32,560
layer

1181
00:43:32,560 --> 00:43:34,160
basically

1182
00:43:34,160 --> 00:43:36,960
a lot of this adware is a remote access

1183
00:43:36,960 --> 00:43:38,000
trojan

1184
00:43:38,000 --> 00:43:40,480
with root privileges

1185
00:43:40,480 --> 00:43:42,079
and right now it might just be

1186
00:43:42,079 --> 00:43:44,560
displaying ads to your user

1187
00:43:44,560 --> 00:43:47,280
but it's still a remote access trojan

1188
00:43:47,280 --> 00:43:49,599
with root privileges

1189
00:43:49,599 --> 00:43:51,920
and these tools regularly update

1190
00:43:51,920 --> 00:43:53,119
themselves

1191
00:43:53,119 --> 00:43:56,000
that could become anything else anything

1192
00:43:56,000 --> 00:43:58,720
else anytime it wants to

1193
00:43:58,720 --> 00:44:01,040
and it has root privileges

1194
00:44:01,040 --> 00:44:01,920
so

1195
00:44:01,920 --> 00:44:03,680
you know if i

1196
00:44:03,680 --> 00:44:05,680
wanted to be sneaky if i were i don't

1197
00:44:05,680 --> 00:44:07,680
know a nation-state actor

1198
00:44:07,680 --> 00:44:08,880
i would

1199
00:44:08,880 --> 00:44:10,640
distribute some pua

1200
00:44:10,640 --> 00:44:12,000
widely

1201
00:44:12,000 --> 00:44:14,720
get it labeled as low risk or hey this

1202
00:44:14,720 --> 00:44:16,880
is just adware and then deliver

1203
00:44:16,880 --> 00:44:19,520
malicious ads to like the 10 machines i

1204
00:44:19,520 --> 00:44:21,680
was concerned about out of the 10 000

1205
00:44:21,680 --> 00:44:24,160
that adware was installed on and then

1206
00:44:24,160 --> 00:44:25,920
i'm in the environment right

1207
00:44:25,920 --> 00:44:26,800
so

1208
00:44:26,800 --> 00:44:29,599
if the adware you're looking at has root

1209
00:44:29,599 --> 00:44:30,880
privileges

1210
00:44:30,880 --> 00:44:33,280
don't discount it just because it's only

1211
00:44:33,280 --> 00:44:35,040
displaying ads you still want to get

1212
00:44:35,040 --> 00:44:37,119
that out of your environment

1213
00:44:37,119 --> 00:44:38,880
all right i think that's the end of my

1214
00:44:38,880 --> 00:44:41,280
rant slash soapbox

1215
00:44:41,280 --> 00:44:42,560
um

1216
00:44:42,560 --> 00:44:44,880
there is a really good reference and i'm

1217
00:44:44,880 --> 00:44:46,720
going to put this on the next slide too

1218
00:44:46,720 --> 00:44:48,800
this is an article by phil stokes at

1219
00:44:48,800 --> 00:44:52,000
sentinel one it just goes over 20 tools

1220
00:44:52,000 --> 00:44:53,200
and techniques

1221
00:44:53,200 --> 00:44:55,839
that are used by mac os malware and mac

1222
00:44:55,839 --> 00:44:57,359
os thread actors

1223
00:44:57,359 --> 00:44:58,880
and a bunch of my slides in this

1224
00:44:58,880 --> 00:45:00,560
presentation said you know this

1225
00:45:00,560 --> 00:45:02,800
technique is used by this actor or this

1226
00:45:02,800 --> 00:45:04,960
piece of malware a lot of that

1227
00:45:04,960 --> 00:45:07,200
information came from this article

1228
00:45:07,200 --> 00:45:08,800
and particularly if you're getting

1229
00:45:08,800 --> 00:45:12,240
started in mac os and you don't know

1230
00:45:12,240 --> 00:45:14,880
what malware does generally this is a

1231
00:45:14,880 --> 00:45:17,520
really good article to start with

1232
00:45:17,520 --> 00:45:19,119
all right

1233
00:45:19,119 --> 00:45:22,560
so as i said i'm gonna have these slides

1234
00:45:22,560 --> 00:45:24,720
available via my twitter feed

1235
00:45:24,720 --> 00:45:25,760
maybe

1236
00:45:25,760 --> 00:45:29,200
today if i'm motivated or tomorrow

1237
00:45:29,200 --> 00:45:31,440
and you can get these links or you can

1238
00:45:31,440 --> 00:45:34,240
grab a screenshot right now

1239
00:45:34,240 --> 00:45:35,599
there's

1240
00:45:35,599 --> 00:45:37,760
a lot being added to mitre specifically

1241
00:45:37,760 --> 00:45:40,880
for mac os which is very cool and very

1242
00:45:40,880 --> 00:45:42,000
needed

1243
00:45:42,000 --> 00:45:45,200
that article on link persistence or

1244
00:45:45,200 --> 00:45:48,480
persistence via the doc is on this slide

1245
00:45:48,480 --> 00:45:50,160
and that slide where i talked about the

1246
00:45:50,160 --> 00:45:52,560
attacker's dilemma and how really as

1247
00:45:52,560 --> 00:45:55,440
defenders we have the ability to make an

1248
00:45:55,440 --> 00:45:57,440
attacker's life difficult

1249
00:45:57,440 --> 00:46:00,480
that's the last bullet here

1250
00:46:00,480 --> 00:46:02,800
so the idea is if you know your

1251
00:46:02,800 --> 00:46:04,400
environment well if you look at these

1252
00:46:04,400 --> 00:46:05,920
choke points if you set up the right

1253
00:46:05,920 --> 00:46:07,040
alerts

1254
00:46:07,040 --> 00:46:09,200
you can make sure the attacker has to

1255
00:46:09,200 --> 00:46:10,640
make noise

1256
00:46:10,640 --> 00:46:12,640
and you can find them when they're in

1257
00:46:12,640 --> 00:46:15,839
the early stages of their attack

1258
00:46:15,839 --> 00:46:19,520
all right um three that is the end of my

1259
00:46:19,520 --> 00:46:21,119
slides

1260
00:46:21,119 --> 00:46:23,599
hey megan uh we just had a few questions

1261
00:46:23,599 --> 00:46:25,440
for you here i'm gonna start with a

1262
00:46:25,440 --> 00:46:26,319
really

1263
00:46:26,319 --> 00:46:29,119
uh quicker one here uh windows logs have

1264
00:46:29,119 --> 00:46:31,040
an event where the logs are deleted and

1265
00:46:31,040 --> 00:46:32,880
that gets logged i believe that's uh

1266
00:46:32,880 --> 00:46:35,280
1102 if i recall my windows event logs

1267
00:46:35,280 --> 00:46:37,680
correctly is there any uh mac equivalent

1268
00:46:37,680 --> 00:46:40,240
of that or where basically any of the

1269
00:46:40,240 --> 00:46:42,880
logs gets cleared either partially or

1270
00:46:42,880 --> 00:46:45,119
just maybe all the logs on the system

1271
00:46:45,119 --> 00:46:45,920
um

1272
00:46:45,920 --> 00:46:47,599
so i don't actually know what the

1273
00:46:47,599 --> 00:46:50,319
unified logs record

1274
00:46:50,319 --> 00:46:52,400
when you do that log erase command

1275
00:46:52,400 --> 00:46:53,760
that's a

1276
00:46:53,760 --> 00:46:55,839
that would be a good thing to look at

1277
00:46:55,839 --> 00:46:57,520
one of the annoying things about the

1278
00:46:57,520 --> 00:47:00,000
unified logs is there aren't any event

1279
00:47:00,000 --> 00:47:01,200
ids

1280
00:47:01,200 --> 00:47:02,240
so

1281
00:47:02,240 --> 00:47:03,520
you know how in the windows world you

1282
00:47:03,520 --> 00:47:06,079
talk about well that's 4795 or that's a

1283
00:47:06,079 --> 00:47:09,520
4652 and it makes it really easy

1284
00:47:09,520 --> 00:47:12,079
they that is not in the mac os world yet

1285
00:47:12,079 --> 00:47:12,960
so

1286
00:47:12,960 --> 00:47:15,119
it's unfortunate

1287
00:47:15,119 --> 00:47:16,800
gotcha there yeah because i'm used to

1288
00:47:16,800 --> 00:47:18,319
for ransomware if you see it occurring

1289
00:47:18,319 --> 00:47:21,280
on system like that deletion of uh like

1290
00:47:21,280 --> 00:47:24,160
um logs or potenti or more often you

1291
00:47:24,160 --> 00:47:27,119
know um the backups and such for

1292
00:47:27,119 --> 00:47:29,200
the volume shadows just are just like

1293
00:47:29,200 --> 00:47:31,119
the canary in the coal mine for those

1294
00:47:31,119 --> 00:47:32,800
types of things so there's just certain

1295
00:47:32,800 --> 00:47:34,400
things that you expect and just like yep

1296
00:47:34,400 --> 00:47:36,079
that's gonna be alert we're gonna have

1297
00:47:36,079 --> 00:47:38,960
really fast um what other questions we

1298
00:47:38,960 --> 00:47:41,119
have here we have another question

1299
00:47:41,119 --> 00:47:44,319
on uh regarding detection queries um is

1300
00:47:44,319 --> 00:47:45,440
there things that can pick up on

1301
00:47:45,440 --> 00:47:46,960
precursors to the ransomware like

1302
00:47:46,960 --> 00:47:48,960
inhibiting system recovery or backups

1303
00:47:48,960 --> 00:47:50,800
such as deleting volume shadow files or

1304
00:47:50,800 --> 00:47:54,160
such um just

1305
00:47:54,160 --> 00:47:56,640
probably i haven't looked in that

1306
00:47:56,640 --> 00:47:59,839
particular direction before

1307
00:47:59,839 --> 00:48:02,800
but i imagine

1308
00:48:02,800 --> 00:48:05,760
so we don't have volume shadow copies in

1309
00:48:05,760 --> 00:48:08,319
mac os at least if there is a thing like

1310
00:48:08,319 --> 00:48:10,079
that i don't know about it

1311
00:48:10,079 --> 00:48:12,240
but there is time machine

1312
00:48:12,240 --> 00:48:14,400
and if you're using time machine and you

1313
00:48:14,400 --> 00:48:15,920
want to see

1314
00:48:15,920 --> 00:48:18,640
if somebody sent the order to delete all

1315
00:48:18,640 --> 00:48:20,960
your time machine backups

1316
00:48:20,960 --> 00:48:23,040
that would be a good thing to look for

1317
00:48:23,040 --> 00:48:25,040
and if i had to guess i would say it

1318
00:48:25,040 --> 00:48:26,559
would be in the unified log somewhere

1319
00:48:26,559 --> 00:48:28,079
but i haven't looked for it so i don't

1320
00:48:28,079 --> 00:48:29,760
know for sure

1321
00:48:29,760 --> 00:48:31,760
gotcha um and then we had another

1322
00:48:31,760 --> 00:48:34,559
question for about 20 minutes ago um

1323
00:48:34,559 --> 00:48:37,359
when you write detections um when these

1324
00:48:37,359 --> 00:48:39,440
binaries are created um

1325
00:48:39,440 --> 00:48:41,040
would you suggest as a hunting mission

1326
00:48:41,040 --> 00:48:42,880
to review all uh

1327
00:48:42,880 --> 00:48:45,359
suid binaries

1328
00:48:45,359 --> 00:48:47,760
um yeah i mean those are that's actually

1329
00:48:47,760 --> 00:48:50,960
a great point sometimes good hunt weeks

1330
00:48:50,960 --> 00:48:52,400
are just

1331
00:48:52,400 --> 00:48:54,800
let's look at the behavior of this in

1332
00:48:54,800 --> 00:48:57,040
our environment or

1333
00:48:57,040 --> 00:48:59,040
you know how many of this widget do we

1334
00:48:59,040 --> 00:49:01,440
have how many applications do we have

1335
00:49:01,440 --> 00:49:03,760
and see if you can build a good list

1336
00:49:03,760 --> 00:49:06,480
and suid binaries should be short

1337
00:49:06,480 --> 00:49:08,640
hopefully

1338
00:49:08,640 --> 00:49:11,040
gotcha um and just one last question out

1339
00:49:11,040 --> 00:49:12,880
of curiosity since you're dealing with

1340
00:49:12,880 --> 00:49:16,559
an enterprise environment and such um

1341
00:49:16,559 --> 00:49:18,079
somewhere attacks against windows

1342
00:49:18,079 --> 00:49:19,280
machines and different types of

1343
00:49:19,280 --> 00:49:21,440
environments are all the rage nowadays

1344
00:49:21,440 --> 00:49:23,440
and one of the things gets the most

1345
00:49:23,440 --> 00:49:25,200
newsworthy stuff are you seeing those

1346
00:49:25,200 --> 00:49:28,400
similar trends within the mac ecosystems

1347
00:49:28,400 --> 00:49:30,160
within corporate environments from you

1348
00:49:30,160 --> 00:49:32,079
or other colleagues or such that you all

1349
00:49:32,079 --> 00:49:33,520
are having to worry about ransomware is

1350
00:49:33,520 --> 00:49:35,040
it still kind of behind the curve

1351
00:49:35,040 --> 00:49:36,240
compared to where the rest of the

1352
00:49:36,240 --> 00:49:37,680
industry's at

1353
00:49:37,680 --> 00:49:39,680
well i mean there's always

1354
00:49:39,680 --> 00:49:42,240
there's been ransomware for max for a

1355
00:49:42,240 --> 00:49:45,280
while now um

1356
00:49:45,280 --> 00:49:47,359
and i haven't

1357
00:49:47,359 --> 00:49:49,040
so in this presentation i haven't talked

1358
00:49:49,040 --> 00:49:51,920
about detection for it

1359
00:49:51,920 --> 00:49:54,160
but

1360
00:49:54,480 --> 00:49:57,760
i did run a ransomware a few ransomware

1361
00:49:57,760 --> 00:49:59,760
samples through

1362
00:49:59,760 --> 00:50:01,440
for a different experiment a few years

1363
00:50:01,440 --> 00:50:03,040
ago

1364
00:50:03,040 --> 00:50:06,720
and one of the most reliable indicators

1365
00:50:06,720 --> 00:50:09,680
that i saw was number of processes

1366
00:50:09,680 --> 00:50:11,040
because that particular piece of

1367
00:50:11,040 --> 00:50:12,800
ransomware

1368
00:50:12,800 --> 00:50:14,000
would

1369
00:50:14,000 --> 00:50:15,760
run a find command

1370
00:50:15,760 --> 00:50:17,760
to find all the files it wanted to

1371
00:50:17,760 --> 00:50:20,319
encrypt and then spin up a process for

1372
00:50:20,319 --> 00:50:21,119
each

1373
00:50:21,119 --> 00:50:22,960
for each file it wanted to encrypt to

1374
00:50:22,960 --> 00:50:25,200
encrypt that file and so if you see like

1375
00:50:25,200 --> 00:50:27,520
a process tree where like it's python

1376
00:50:27,520 --> 00:50:30,240
and then it's got a thousand children

1377
00:50:30,240 --> 00:50:31,359
then

1378
00:50:31,359 --> 00:50:33,040
that's that's what that particular

1379
00:50:33,040 --> 00:50:34,400
sample looked like

1380
00:50:34,400 --> 00:50:35,359
so

1381
00:50:35,359 --> 00:50:36,720
i haven't looked at ransomware

1382
00:50:36,720 --> 00:50:39,040
specifically recently but you know it

1383
00:50:39,040 --> 00:50:42,400
exists for max it always has

1384
00:50:42,400 --> 00:50:44,559
gotcha um i don't see any of the

1385
00:50:44,559 --> 00:50:46,240
questions or anything else and we seem

1386
00:50:46,240 --> 00:50:49,760
to be at the top of the hour here um so

1387
00:50:49,760 --> 00:50:51,680
any less words for us megan

1388
00:50:51,680 --> 00:50:52,800
um

1389
00:50:52,800 --> 00:50:53,760
yeah

1390
00:50:53,760 --> 00:50:56,400
so go forth learn things make me look

1391
00:50:56,400 --> 00:50:57,359
bad

1392
00:50:57,359 --> 00:51:00,480
and if you have questions that come up

1393
00:51:00,480 --> 00:51:03,119
later feel free to find me on twitter or

1394
00:51:03,119 --> 00:51:06,319
in chat around the conference

1395
00:51:06,319 --> 00:51:09,440
yep and just a note again um megan has

1396
00:51:09,440 --> 00:51:12,400
their twitter account here as ponyvan um

1397
00:51:12,400 --> 00:51:14,000
listed on there so if anyone's looking

1398
00:51:14,000 --> 00:51:15,520
at the slides that is the name of their

1399
00:51:15,520 --> 00:51:18,079
twitter and then um thank you very much

1400
00:51:18,079 --> 00:51:20,720
for enjoy um taking our session here

1401
00:51:20,720 --> 00:51:22,640
and look forward to the next session

1402
00:51:22,640 --> 00:51:23,920
coming up and if anyone has any

1403
00:51:23,920 --> 00:51:25,280
questions feel free to put them else in

1404
00:51:25,280 --> 00:51:27,119
chat and we'll try and get an answer for

1405
00:51:27,119 --> 00:51:29,040
you and take a look at anything else

1406
00:51:29,040 --> 00:51:31,280
going on the diana initiative today we

1407
00:51:31,280 --> 00:51:33,040
have a large number of exhibitors and

1408
00:51:33,040 --> 00:51:34,960
ctfs and other events going on today so

1409
00:51:34,960 --> 00:51:36,559
it's not just limited to our talks and

1410
00:51:36,559 --> 00:51:38,400
such thank you very much and have a good

1411
00:51:38,400 --> 00:51:41,400
day

