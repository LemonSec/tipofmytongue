1
00:00:12,400 --> 00:00:14,559
okay great so uh hello everybody and

2
00:00:14,559 --> 00:00:17,199
welcome my name is ariana the next talk

3
00:00:17,199 --> 00:00:19,039
what we're all here to listen to is from

4
00:00:19,039 --> 00:00:21,279
kirsty failey i knew you were trouble a

5
00:00:21,279 --> 00:00:24,000
lesson in hypothesis and threat hunting

6
00:00:24,000 --> 00:00:25,920
i'm so glad that you're with us here at

7
00:00:25,920 --> 00:00:28,320
the 2021 diana initiative virtual

8
00:00:28,320 --> 00:00:29,760
conference for those of you on the

9
00:00:29,760 --> 00:00:33,360
socials we are hashtag tdi 2021 and

10
00:00:33,360 --> 00:00:35,760
hashtag spark a journey

11
00:00:35,760 --> 00:00:38,320
so our next expert is incident responder

12
00:00:38,320 --> 00:00:41,440
giggs as in gigabyte with a swift-esque

13
00:00:41,440 --> 00:00:43,680
take on hypothesis and threat hunting

14
00:00:43,680 --> 00:00:46,399
but first we have a very short note from

15
00:00:46,399 --> 00:00:49,360
our sponsors

16
00:00:50,160 --> 00:00:53,519
oh dear excuse me

17
00:00:54,320 --> 00:00:56,480
i can't seem to share my screen

18
00:00:56,480 --> 00:00:58,719
to show you the sponsor list i'm really

19
00:00:58,719 --> 00:01:01,039
sorry

20
00:01:01,440 --> 00:01:04,000
uh so tech team is there anything we can

21
00:01:04,000 --> 00:01:05,438
do or have i just messed that up

22
00:01:05,438 --> 00:01:07,919
entirely

23
00:01:10,320 --> 00:01:12,000
yeah i've messed that up entirely okay

24
00:01:12,000 --> 00:01:14,240
our sponsors mongodb juniper networks

25
00:01:14,240 --> 00:01:16,560
corelight google bridge crew we hack

26
00:01:16,560 --> 00:01:18,320
purple axonius

27
00:01:18,320 --> 00:01:20,640
and elan security thank you so much to

28
00:01:20,640 --> 00:01:26,040
our sponsors thank you very much indeed

29
00:01:26,080 --> 00:01:28,240
move on very quickly

30
00:01:28,240 --> 00:01:31,040
so our expert is instant responder giggs

31
00:01:31,040 --> 00:01:32,880
and we have a jam-packed uh talk for you

32
00:01:32,880 --> 00:01:34,240
today

33
00:01:34,240 --> 00:01:36,720
before i let kirsty go on with her talk

34
00:01:36,720 --> 00:01:38,079
i'd like to just draw your attention to

35
00:01:38,079 --> 00:01:40,000
our capture the flag event it runs over

36
00:01:40,000 --> 00:01:41,680
the entire two days with challenges

37
00:01:41,680 --> 00:01:44,000
ranging from easy uh to a little bit

38
00:01:44,000 --> 00:01:45,840
harder for those of you who love puzzles

39
00:01:45,840 --> 00:01:48,159
so stop over in our other sessions areas

40
00:01:48,159 --> 00:01:49,680
and the expo

41
00:01:49,680 --> 00:01:52,399
but uh enough of that move on moving on

42
00:01:52,399 --> 00:01:53,920
to our main event

43
00:01:53,920 --> 00:01:54,720
so

44
00:01:54,720 --> 00:01:56,719
just a note on questions we've got we've

45
00:01:56,719 --> 00:01:58,399
got some time at the end but if you have

46
00:01:58,399 --> 00:01:59,840
any questions post them in the chat and

47
00:01:59,840 --> 00:02:01,360
i'll post them i'll pass them through to

48
00:02:01,360 --> 00:02:03,680
kirsty if we run out of time today do

49
00:02:03,680 --> 00:02:06,000
not worry because these will be answered

50
00:02:06,000 --> 00:02:07,439
on twitter

51
00:02:07,439 --> 00:02:09,199
so that's

52
00:02:09,199 --> 00:02:11,280
that's all from me today without any

53
00:02:11,280 --> 00:02:13,040
further ado it is my pleasure it is my

54
00:02:13,040 --> 00:02:15,200
absolute joy to introduce you to kirsty

55
00:02:15,200 --> 00:02:17,280
failey uh around the digital applause

56
00:02:17,280 --> 00:02:20,000
please kirsty take it away

57
00:02:20,000 --> 00:02:22,720
thank you so much

58
00:02:22,720 --> 00:02:24,239
all right

59
00:02:24,239 --> 00:02:26,400
so my screen is up

60
00:02:26,400 --> 00:02:29,040
perfect

61
00:02:29,599 --> 00:02:32,879
all right hey what's up friends swifties

62
00:02:32,879 --> 00:02:34,720
and brett hunters alike thank you so

63
00:02:34,720 --> 00:02:36,319
much for joining my talk i knew you were

64
00:02:36,319 --> 00:02:38,640
trouble a lesson in hypothesis and

65
00:02:38,640 --> 00:02:40,560
threat hunting today i have a lot to

66
00:02:40,560 --> 00:02:44,080
cover are you ready for it

67
00:02:45,040 --> 00:02:47,040
maybe okay there you go

68
00:02:47,040 --> 00:02:49,120
my name is chrissy failey i'm a senior

69
00:02:49,120 --> 00:02:51,760
incident response consultant at mandiant

70
00:02:51,760 --> 00:02:54,080
and um i

71
00:02:54,080 --> 00:02:55,519
love

72
00:02:55,519 --> 00:02:56,480
love

73
00:02:56,480 --> 00:03:00,560
fret hunting and finding evil

74
00:03:00,720 --> 00:03:03,440
oh hold up

75
00:03:03,440 --> 00:03:05,120
as you can probably tell

76
00:03:05,120 --> 00:03:08,959
by my title i'm a huge taylor swift fan

77
00:03:08,959 --> 00:03:11,120
uh throughout this talk you will come to

78
00:03:11,120 --> 00:03:13,840
find a number of easter eggs that i've

79
00:03:13,840 --> 00:03:15,519
carefully woven into the fabric of my

80
00:03:15,519 --> 00:03:16,640
content

81
00:03:16,640 --> 00:03:19,599
keep track of them and the person with

82
00:03:19,599 --> 00:03:22,560
the closest uh at the end of the next

83
00:03:22,560 --> 00:03:25,760
week uh yeah next week will be getting

84
00:03:25,760 --> 00:03:27,280
some swag for me

85
00:03:27,280 --> 00:03:29,519
i'm a proud dog mama to my main guide

86
00:03:29,519 --> 00:03:31,680
knox you can find pictures of him and

87
00:03:31,680 --> 00:03:34,239
his sassy personality on twitter uh so

88
00:03:34,239 --> 00:03:35,760
make sure you're following me or hit me

89
00:03:35,760 --> 00:03:37,840
up in slack uh with

90
00:03:37,840 --> 00:03:40,000
the final number for those easter eggs

91
00:03:40,000 --> 00:03:42,239
for the chance to get some uh mandiant

92
00:03:42,239 --> 00:03:44,640
swag

93
00:03:45,280 --> 00:03:46,720
now

94
00:03:46,720 --> 00:03:49,519
taylor swift and threat hunting if

95
00:03:49,519 --> 00:03:51,280
you're not a swifty you're probably

96
00:03:51,280 --> 00:03:52,480
thinking

97
00:03:52,480 --> 00:03:53,840
what the heck

98
00:03:53,840 --> 00:03:55,360
uh so

99
00:03:55,360 --> 00:03:57,920
taylor swift very early on in her career

100
00:03:57,920 --> 00:04:00,400
started to create this amazing

101
00:04:00,400 --> 00:04:02,239
relationship with her fan base through

102
00:04:02,239 --> 00:04:05,040
the use of secret messages and easter

103
00:04:05,040 --> 00:04:07,200
eggs in the lyrics of her songs and the

104
00:04:07,200 --> 00:04:09,840
visuals in her music videos

105
00:04:09,840 --> 00:04:12,159
as her career developed so did the

106
00:04:12,159 --> 00:04:14,319
attention of people throughout the world

107
00:04:14,319 --> 00:04:16,720
to know everything about her

108
00:04:16,720 --> 00:04:17,759
which

109
00:04:17,759 --> 00:04:20,560
led to some wild rumors and stories

110
00:04:20,560 --> 00:04:22,400
being created about her

111
00:04:22,400 --> 00:04:25,280
tailors of fans and uh or i guess

112
00:04:25,280 --> 00:04:27,600
swifties as we like to be called saw

113
00:04:27,600 --> 00:04:29,120
that haters were going to hate and

114
00:04:29,120 --> 00:04:31,600
became digital detectives to read

115
00:04:31,600 --> 00:04:33,759
through all of this nonsense reporting

116
00:04:33,759 --> 00:04:35,600
in hopes of finding the true message

117
00:04:35,600 --> 00:04:37,360
that miss taylor swift intended for all

118
00:04:37,360 --> 00:04:39,840
of her easter eggs

119
00:04:39,840 --> 00:04:41,360
now

120
00:04:41,360 --> 00:04:43,840
um

121
00:04:44,160 --> 00:04:46,639
this isn't an isolated scenario to the

122
00:04:46,639 --> 00:04:49,040
taylor swift fan base so everyone can

123
00:04:49,040 --> 00:04:51,680
probably imagine that over time and with

124
00:04:51,680 --> 00:04:53,600
the power of the internet the narratives

125
00:04:53,600 --> 00:04:56,479
began to change and be pulled apart and

126
00:04:56,479 --> 00:04:59,600
blown way out of proportion

127
00:04:59,600 --> 00:05:00,400
so

128
00:05:00,400 --> 00:05:03,120
how do you read through the nonsense and

129
00:05:03,120 --> 00:05:05,360
the level of conf and get a level of

130
00:05:05,360 --> 00:05:07,199
comfort uh to be able to pick out the

131
00:05:07,199 --> 00:05:10,400
truth in all of this crazy nonsense well

132
00:05:10,400 --> 00:05:12,080
that's where a bit of critical thinking

133
00:05:12,080 --> 00:05:14,639
hypothesis generation and data gathering

134
00:05:14,639 --> 00:05:17,199
and basically understanding just how far

135
00:05:17,199 --> 00:05:19,280
into wonderland you can dive is going to

136
00:05:19,280 --> 00:05:22,000
take you a really long way

137
00:05:22,000 --> 00:05:22,880
so

138
00:05:22,880 --> 00:05:24,880
what does threat hunting really have to

139
00:05:24,880 --> 00:05:26,880
do with miss taylor swift

140
00:05:26,880 --> 00:05:27,680
well

141
00:05:27,680 --> 00:05:30,800
threat hunting is so much fun but it can

142
00:05:30,800 --> 00:05:33,120
be very costly for your organization if

143
00:05:33,120 --> 00:05:35,759
you don't have your hypotheses in order

144
00:05:35,759 --> 00:05:39,199
you know um you have to figure out when

145
00:05:39,199 --> 00:05:40,960
to call it a day

146
00:05:40,960 --> 00:05:43,120
something that over the past 15 years i

147
00:05:43,120 --> 00:05:47,120
have learned so much from the swifties

148
00:05:47,120 --> 00:05:49,520
um i want to share today with you some

149
00:05:49,520 --> 00:05:52,080
tips and tricks that i have gathered

150
00:05:52,080 --> 00:05:54,479
from them as well as over my career as

151
00:05:54,479 --> 00:05:56,240
an incident responder and threat hunter

152
00:05:56,240 --> 00:05:58,319
so let's go ahead and dive into the

153
00:05:58,319 --> 00:06:00,080
details that you'll need to know about

154
00:06:00,080 --> 00:06:03,599
miss taylor swift

155
00:06:04,960 --> 00:06:06,639
so uh

156
00:06:06,639 --> 00:06:09,039
taylor swift and her fans refer to each

157
00:06:09,039 --> 00:06:11,680
album cycle as an era this allows taylor

158
00:06:11,680 --> 00:06:13,680
to create worlds within her music and

159
00:06:13,680 --> 00:06:16,639
then uh it allows her fans to better

160
00:06:16,639 --> 00:06:18,960
relate to it and it also opens up

161
00:06:18,960 --> 00:06:21,360
creativity for her fans um

162
00:06:21,360 --> 00:06:22,880
and uh

163
00:06:22,880 --> 00:06:25,680
taylor leverages that to leave behind a

164
00:06:25,680 --> 00:06:27,440
lot of easter eggs

165
00:06:27,440 --> 00:06:30,479
now in her first five studio albums

166
00:06:30,479 --> 00:06:32,319
taylor incorporated secret messages in

167
00:06:32,319 --> 00:06:34,400
the lyric booklets of each physical

168
00:06:34,400 --> 00:06:35,360
album

169
00:06:35,360 --> 00:06:37,520
all of the letters would be lowercase

170
00:06:37,520 --> 00:06:40,639
except for the secret messages um

171
00:06:40,639 --> 00:06:43,199
which would ultimately spell out a

172
00:06:43,199 --> 00:06:45,360
message or a word that would add

173
00:06:45,360 --> 00:06:49,120
additional meaning into the song now in

174
00:06:49,120 --> 00:06:51,520
her sixth studio album

175
00:06:51,520 --> 00:06:52,960
uh she

176
00:06:52,960 --> 00:06:54,800
let the music and the clues in the

177
00:06:54,800 --> 00:06:56,800
lyrics of her songs do the talking

178
00:06:56,800 --> 00:06:59,199
famously saying there will be no there

179
00:06:59,199 --> 00:07:01,520
will be no explanation there will only

180
00:07:01,520 --> 00:07:03,919
be reputation

181
00:07:03,919 --> 00:07:05,360
this is very important for our story

182
00:07:05,360 --> 00:07:08,319
because reputation was the first album

183
00:07:08,319 --> 00:07:09,759
that directly pointed to public

184
00:07:09,759 --> 00:07:12,319
situations that was

185
00:07:12,319 --> 00:07:14,560
pretty clear to swifties which hater she

186
00:07:14,560 --> 00:07:16,800
was poking fun at and which relationship

187
00:07:16,800 --> 00:07:19,199
she was talking about

188
00:07:19,199 --> 00:07:21,520
taylor didn't participate in any

189
00:07:21,520 --> 00:07:23,039
marketing or

190
00:07:23,039 --> 00:07:25,759
promotion events for this album cycle

191
00:07:25,759 --> 00:07:29,120
that she did not arrange or control

192
00:07:29,120 --> 00:07:31,840
everything was by design a conversation

193
00:07:31,840 --> 00:07:33,759
where she was speaking directly to her

194
00:07:33,759 --> 00:07:36,160
fans through her music

195
00:07:36,160 --> 00:07:38,000
now this all started to change when

196
00:07:38,000 --> 00:07:41,199
2018's highest grossing stadium tour for

197
00:07:41,199 --> 00:07:45,840
the reputation era came to an end

198
00:07:47,120 --> 00:07:48,479
there we go

199
00:07:48,479 --> 00:07:50,319
taylor began transitioning her social

200
00:07:50,319 --> 00:07:52,240
media accounts from the dark

201
00:07:52,240 --> 00:07:54,879
snake-filled reputation theme all the

202
00:07:54,879 --> 00:07:58,160
way to this bright and sparkly butterfly

203
00:07:58,160 --> 00:08:01,919
filled era of ts7

204
00:08:01,919 --> 00:08:04,319
taylor swift seems to always be thinking

205
00:08:04,319 --> 00:08:06,240
a couple steps ahead of her fans keeping

206
00:08:06,240 --> 00:08:09,039
a tight handle on any upcoming events or

207
00:08:09,039 --> 00:08:11,120
future song releases

208
00:08:11,120 --> 00:08:12,479
and

209
00:08:12,479 --> 00:08:14,400
this sometimes uh

210
00:08:14,400 --> 00:08:16,240
leads to some interesting theories from

211
00:08:16,240 --> 00:08:17,120
fans

212
00:08:17,120 --> 00:08:19,280
this gradual thematic change to a

213
00:08:19,280 --> 00:08:21,440
lighter more whimsical social media feed

214
00:08:21,440 --> 00:08:23,680
made her fans get

215
00:08:23,680 --> 00:08:26,960
a little carried away

216
00:08:26,960 --> 00:08:28,879
there we go

217
00:08:28,879 --> 00:08:31,039
because of this dramatic social media

218
00:08:31,039 --> 00:08:33,599
comeback that taylor swift had in 2017

219
00:08:33,599 --> 00:08:35,360
as the main marketing event that

220
00:08:35,360 --> 00:08:36,640
showcased that she was completely

221
00:08:36,640 --> 00:08:38,479
rewriting her reputation

222
00:08:38,479 --> 00:08:39,360
uh

223
00:08:39,360 --> 00:08:40,719
her fans

224
00:08:40,719 --> 00:08:42,958
got a little carried away

225
00:08:42,958 --> 00:08:45,200
her fans began hyper analyzing every

226
00:08:45,200 --> 00:08:48,240
aspect of her social media presence um

227
00:08:48,240 --> 00:08:50,800
and i guess as a global pop star this is

228
00:08:50,800 --> 00:08:53,440
kind of part of the territory

229
00:08:53,440 --> 00:08:56,320
and oh did her fans have a blast and

230
00:08:56,320 --> 00:08:58,959
spend way too much time trying to figure

231
00:08:58,959 --> 00:09:02,080
out what was going on

232
00:09:02,080 --> 00:09:05,440
so this brings us back to the main topic

233
00:09:05,440 --> 00:09:09,680
that sparked my idea for this talk

234
00:09:09,680 --> 00:09:12,080
now this picture is iconic for the

235
00:09:12,080 --> 00:09:15,440
swifty fandom um but it may

236
00:09:15,440 --> 00:09:17,680
confuse the rest of you but it was

237
00:09:17,680 --> 00:09:20,000
really a turning point in the fandom the

238
00:09:20,000 --> 00:09:21,600
five holes in the fence picture that you

239
00:09:21,600 --> 00:09:23,760
see on the screen where taylor swift is

240
00:09:23,760 --> 00:09:25,519
pictured looking through the center of a

241
00:09:25,519 --> 00:09:28,880
lattice fence with five associated holes

242
00:09:28,880 --> 00:09:30,880
was posted by miss taylor swift after

243
00:09:30,880 --> 00:09:32,880
posting some

244
00:09:32,880 --> 00:09:35,360
seemingly countdown-esque type pictures

245
00:09:35,360 --> 00:09:38,640
on her instagram first we see this these

246
00:09:38,640 --> 00:09:40,160
seven trees

247
00:09:40,160 --> 00:09:43,839
then we see her on the sixth step so

248
00:09:43,839 --> 00:09:45,839
naturally

249
00:09:45,839 --> 00:09:48,240
five holes in the fence

250
00:09:48,240 --> 00:09:50,160
makes sense right five days until

251
00:09:50,160 --> 00:09:51,120
something

252
00:09:51,120 --> 00:09:53,360
is going to happen

253
00:09:53,360 --> 00:09:54,480
well

254
00:09:54,480 --> 00:09:56,560
wrong uh so

255
00:09:56,560 --> 00:09:59,200
taylor swift posted these pictures well

256
00:09:59,200 --> 00:10:02,320
before she had even announced this a

257
00:10:02,320 --> 00:10:06,959
single even um for ts7 uh so

258
00:10:06,959 --> 00:10:09,279
she didn't even release the name of the

259
00:10:09,279 --> 00:10:11,680
album yet this reaction got turned into

260
00:10:11,680 --> 00:10:13,920
memes and is still used to this day as a

261
00:10:13,920 --> 00:10:15,600
way to measure the likelihood of a new

262
00:10:15,600 --> 00:10:16,720
theory

263
00:10:16,720 --> 00:10:18,640
being true within the fandom

264
00:10:18,640 --> 00:10:19,440
so

265
00:10:19,440 --> 00:10:21,440
what can we use this fast-paced growth

266
00:10:21,440 --> 00:10:23,600
and curiosity to teach us about building

267
00:10:23,600 --> 00:10:26,800
theories and creating hypotheses

268
00:10:26,800 --> 00:10:28,640
well

269
00:10:28,640 --> 00:10:29,680
data

270
00:10:29,680 --> 00:10:31,600
or interrogated data will generally tell

271
00:10:31,600 --> 00:10:33,360
you anything you want it to

272
00:10:33,360 --> 00:10:34,240
because

273
00:10:34,240 --> 00:10:36,320
data can easily be manipulated to paint

274
00:10:36,320 --> 00:10:38,240
any type of picture you want

275
00:10:38,240 --> 00:10:39,839
this is where your critical thinking

276
00:10:39,839 --> 00:10:41,920
comes in when it comes to threat hunting

277
00:10:41,920 --> 00:10:44,160
there are a number of ways to get the

278
00:10:44,160 --> 00:10:47,040
right answer right um it it's just a

279
00:10:47,040 --> 00:10:49,360
matter of how you ask the question

280
00:10:49,360 --> 00:10:51,760
the process of validating that you have

281
00:10:51,760 --> 00:10:53,920
the right data and then of course

282
00:10:53,920 --> 00:10:55,440
having this level mindset of

283
00:10:55,440 --> 00:10:57,040
realistically understanding what the

284
00:10:57,040 --> 00:11:00,880
outcome is most likely going to be is

285
00:11:00,880 --> 00:11:02,240
going to just

286
00:11:02,240 --> 00:11:03,600
carry you through your threat hunting

287
00:11:03,600 --> 00:11:06,560
process generating this open and

288
00:11:06,560 --> 00:11:08,560
this open-ended question and having the

289
00:11:08,560 --> 00:11:10,000
right data

290
00:11:10,000 --> 00:11:12,160
and knowing what your data looks like

291
00:11:12,160 --> 00:11:14,000
within your environment will lead you

292
00:11:14,000 --> 00:11:16,399
down some pretty great hunts that will

293
00:11:16,399 --> 00:11:17,680
ultimately

294
00:11:17,680 --> 00:11:20,399
lead you in creating better detections

295
00:11:20,399 --> 00:11:23,200
which then in turn will give you better

296
00:11:23,200 --> 00:11:27,519
visibility into your environment

297
00:11:27,600 --> 00:11:30,240
so when we're talking about taylor swift

298
00:11:30,240 --> 00:11:32,640
we will never understand exactly what

299
00:11:32,640 --> 00:11:34,560
her reasoning was at the time of each

300
00:11:34,560 --> 00:11:37,440
cryptic post until she confirms it or

301
00:11:37,440 --> 00:11:39,920
she makes fun of us for it

302
00:11:39,920 --> 00:11:42,160
like once you posted the same picture

303
00:11:42,160 --> 00:11:44,800
that caused her fans to spiral five days

304
00:11:44,800 --> 00:11:46,800
before the album dropped as you can see

305
00:11:46,800 --> 00:11:49,040
in this picture she recognized that this

306
00:11:49,040 --> 00:11:51,519
was such a big deal for the swifties she

307
00:11:51,519 --> 00:11:53,519
needed to make sure that she knew that

308
00:11:53,519 --> 00:11:55,279
we all knew that she saw us climbing

309
00:11:55,279 --> 00:11:56,480
around

310
00:11:56,480 --> 00:11:57,519
so

311
00:11:57,519 --> 00:11:59,279
when you are the threat hunter in your

312
00:11:59,279 --> 00:12:01,279
own environment though you have a little

313
00:12:01,279 --> 00:12:03,680
bit more control uh in figuring out

314
00:12:03,680 --> 00:12:05,360
where you're following falling into a

315
00:12:05,360 --> 00:12:08,240
rabbit hole or if you're on to creating

316
00:12:08,240 --> 00:12:10,720
this next big detection or maybe finding

317
00:12:10,720 --> 00:12:13,440
a new supply chain attack

318
00:12:13,440 --> 00:12:14,880
when you start threat hunting the

319
00:12:14,880 --> 00:12:17,040
short-term goal is to get to know your

320
00:12:17,040 --> 00:12:20,000
environment really really well

321
00:12:20,000 --> 00:12:23,040
my tips are for starting is to basically

322
00:12:23,040 --> 00:12:25,920
identify that uh basically identify

323
00:12:25,920 --> 00:12:27,760
areas that you have limited visibility

324
00:12:27,760 --> 00:12:30,240
into and then find ways to get more data

325
00:12:30,240 --> 00:12:32,320
points surrounding that let's start by

326
00:12:32,320 --> 00:12:35,200
breaking those down into three buckets

327
00:12:35,200 --> 00:12:36,079
first

328
00:12:36,079 --> 00:12:37,760
we'll talk about an endpoint then you

329
00:12:37,760 --> 00:12:40,720
have your network areas and then finally

330
00:12:40,720 --> 00:12:42,959
cloud we'll start with these three the

331
00:12:42,959 --> 00:12:44,800
idea here is to capture the main data

332
00:12:44,800 --> 00:12:46,959
points that could possibly tell us about

333
00:12:46,959 --> 00:12:49,440
what users are what users are doing

334
00:12:49,440 --> 00:12:51,519
within each environment

335
00:12:51,519 --> 00:12:53,200
and

336
00:12:53,200 --> 00:12:54,800
later it will tell us whether or not

337
00:12:54,800 --> 00:12:57,360
it's a legit user or a nefarious one

338
00:12:57,360 --> 00:12:59,360
we'll start with these buckets uh and

339
00:12:59,360 --> 00:13:01,279
later down the line we can break them

340
00:13:01,279 --> 00:13:03,440
out into sub-areas or even find

341
00:13:03,440 --> 00:13:06,800
additional areas to add buckets for

342
00:13:06,800 --> 00:13:09,279
for example data for endpoint will

343
00:13:09,279 --> 00:13:10,959
likely come from

344
00:13:10,959 --> 00:13:14,320
endpoint detection tools like edr

345
00:13:14,320 --> 00:13:16,079
edr technologies or endpoint detection

346
00:13:16,079 --> 00:13:18,240
and response capabilities

347
00:13:18,240 --> 00:13:20,639
anti-virus tools within the environment

348
00:13:20,639 --> 00:13:22,560
asset management or even software

349
00:13:22,560 --> 00:13:24,880
deployment tools

350
00:13:24,880 --> 00:13:28,079
next we have network data points you can

351
00:13:28,079 --> 00:13:30,720
pull from things like vpn uh firewall

352
00:13:30,720 --> 00:13:32,959
data to see bytes going in and out and

353
00:13:32,959 --> 00:13:34,800
if they're consistent in timed network

354
00:13:34,800 --> 00:13:36,959
communication sourcing from an internal

355
00:13:36,959 --> 00:13:39,760
system to an external infrastructure to

356
00:13:39,760 --> 00:13:42,639
an environment that is consistent with

357
00:13:42,639 --> 00:13:45,199
something like malware beaconing or even

358
00:13:45,199 --> 00:13:46,959
looking at proxy data to see what type

359
00:13:46,959 --> 00:13:48,639
of internet traffic is occurring and

360
00:13:48,639 --> 00:13:50,560
what is getting blocked or maybe what

361
00:13:50,560 --> 00:13:52,399
should be getting blocked

362
00:13:52,399 --> 00:13:54,720
now don't forget about cloud

363
00:13:54,720 --> 00:13:56,959
right as we're moving to more

364
00:13:56,959 --> 00:13:58,639
cloud-based services it's always

365
00:13:58,639 --> 00:14:00,720
important to know what type of logging

366
00:14:00,720 --> 00:14:02,399
is available to pull from

367
00:14:02,399 --> 00:14:04,399
as well as understanding the different

368
00:14:04,399 --> 00:14:06,639
types of license agreements that are in

369
00:14:06,639 --> 00:14:08,959
place for each services they are not all

370
00:14:08,959 --> 00:14:11,440
created sim uh equal

371
00:14:11,440 --> 00:14:13,519
now i don't have enough time for this

372
00:14:13,519 --> 00:14:15,199
talk specifically to dive into

373
00:14:15,199 --> 00:14:19,199
cloud-specific hunts but maybe next time

374
00:14:19,199 --> 00:14:22,240
uh so now i just want to tell you that

375
00:14:22,240 --> 00:14:23,680
these are the main buckets of data

376
00:14:23,680 --> 00:14:25,680
sources that we'll be using during this

377
00:14:25,680 --> 00:14:27,360
talk to

378
00:14:27,360 --> 00:14:29,760
talk through the gathering of data and

379
00:14:29,760 --> 00:14:31,920
that brings me to why do we even need to

380
00:14:31,920 --> 00:14:33,680
consider the data first before we create

381
00:14:33,680 --> 00:14:35,040
the hypothesis

382
00:14:35,040 --> 00:14:37,360
um so

383
00:14:37,360 --> 00:14:40,079
let's just go ahead and recap real quick

384
00:14:40,079 --> 00:14:41,600
we've been talking about how

385
00:14:41,600 --> 00:14:43,600
swifties use

386
00:14:43,600 --> 00:14:45,519
info taylor swift has given us i've

387
00:14:45,519 --> 00:14:48,240
highlighted some pretty funny swifty

388
00:14:48,240 --> 00:14:50,560
theories or at least i think so um and

389
00:14:50,560 --> 00:14:52,399
then we touched on some data sources

390
00:14:52,399 --> 00:14:54,480
that you can pull from to get answers

391
00:14:54,480 --> 00:14:56,320
for the questions that you want to ask

392
00:14:56,320 --> 00:14:58,399
of the data within your environment

393
00:14:58,399 --> 00:15:01,680
so let's go ahead and dive into the ways

394
00:15:01,680 --> 00:15:05,120
that we can generate some great hunts

395
00:15:05,120 --> 00:15:06,880
so

396
00:15:06,880 --> 00:15:08,800
when you're hunting you never really

397
00:15:08,800 --> 00:15:11,120
want to find um evil within your

398
00:15:11,120 --> 00:15:12,720
environment but

399
00:15:12,720 --> 00:15:15,120
uh it's really hard to prove a negative

400
00:15:15,120 --> 00:15:19,040
so uh what we want is to

401
00:15:19,040 --> 00:15:21,600
build uh

402
00:15:21,600 --> 00:15:24,880
build hunts off of actionable intel uh

403
00:15:24,880 --> 00:15:28,959
but also with the main motivation uh of

404
00:15:28,959 --> 00:15:30,959
looking through all of the data that we

405
00:15:30,959 --> 00:15:33,759
have access to within the environment uh

406
00:15:33,759 --> 00:15:35,839
to see where we're lacking visibility so

407
00:15:35,839 --> 00:15:37,519
that we can make future hunts a little

408
00:15:37,519 --> 00:15:39,279
bit better and a little bit quicker and

409
00:15:39,279 --> 00:15:41,440
maybe a little bit more automated

410
00:15:41,440 --> 00:15:43,680
so first i

411
00:15:43,680 --> 00:15:46,000
you are probably thinking okay but how

412
00:15:46,000 --> 00:15:47,920
do i confirm that i have visibility into

413
00:15:47,920 --> 00:15:50,079
the network if i'm not an expert in all

414
00:15:50,079 --> 00:15:52,639
things like systems administration or

415
00:15:52,639 --> 00:15:55,040
incident response and forensics or even

416
00:15:55,040 --> 00:15:57,440
red teaming right

417
00:15:57,440 --> 00:16:00,560
well a great way uh we can kind of get

418
00:16:00,560 --> 00:16:02,959
into a threat actor's head is by looking

419
00:16:02,959 --> 00:16:04,639
at open source intelligence and public

420
00:16:04,639 --> 00:16:06,800
threat briefings that highlight what the

421
00:16:06,800 --> 00:16:09,199
attackers are up to right

422
00:16:09,199 --> 00:16:10,800
keep up to date with the major threat

423
00:16:10,800 --> 00:16:14,160
reports that come out every year uh so

424
00:16:14,160 --> 00:16:17,040
for instance the mandiant m trends or

425
00:16:17,040 --> 00:16:19,519
the crowdstrike global threat report or

426
00:16:19,519 --> 00:16:22,079
maybe even the verizon's dvi-r just to

427
00:16:22,079 --> 00:16:23,440
name a few

428
00:16:23,440 --> 00:16:26,560
these provide a great metric and

429
00:16:26,560 --> 00:16:28,720
a lot of fantastic predictions of what

430
00:16:28,720 --> 00:16:30,880
is likely to come based off of what each

431
00:16:30,880 --> 00:16:33,839
company has seen the year previous

432
00:16:33,839 --> 00:16:34,880
so

433
00:16:34,880 --> 00:16:37,279
now um

434
00:16:37,279 --> 00:16:39,360
if you're looking for something that is

435
00:16:39,360 --> 00:16:41,199
a little bit more actionable

436
00:16:41,199 --> 00:16:43,440
to work through while you're while each

437
00:16:43,440 --> 00:16:45,040
of those companies are building out

438
00:16:45,040 --> 00:16:47,600
their yearly reports keep an eye on

439
00:16:47,600 --> 00:16:50,079
twitter or threat blogs to watch out for

440
00:16:50,079 --> 00:16:52,560
the next big thing i mean

441
00:16:52,560 --> 00:16:55,680
2021 has been filled with a number of

442
00:16:55,680 --> 00:16:58,000
network appliance zero days and supply

443
00:16:58,000 --> 00:17:00,399
chain-esque attacks that have been

444
00:17:00,399 --> 00:17:02,160
stretching us incident responders and

445
00:17:02,160 --> 00:17:04,240
security teams pretty thin

446
00:17:04,240 --> 00:17:06,959
there's a lot of resources that you can

447
00:17:06,959 --> 00:17:09,119
pull indicators to hunt for a lot of

448
00:17:09,119 --> 00:17:12,240
stuff that is really actionable

449
00:17:12,240 --> 00:17:13,280
so

450
00:17:13,280 --> 00:17:14,559
when we're leveraging all of this

451
00:17:14,559 --> 00:17:16,480
information to create a multifaceted

452
00:17:16,480 --> 00:17:19,839
question we need to make sure that we

453
00:17:19,839 --> 00:17:21,919
have access into the data within our

454
00:17:21,919 --> 00:17:23,839
environment

455
00:17:23,839 --> 00:17:26,160
um this can help you stay one step ahead

456
00:17:26,160 --> 00:17:28,480
of the malicious actors that one day

457
00:17:28,480 --> 00:17:30,400
will probably find their way into your

458
00:17:30,400 --> 00:17:31,760
network

459
00:17:31,760 --> 00:17:33,360
and

460
00:17:33,360 --> 00:17:35,679
at this point hopefully after this talk

461
00:17:35,679 --> 00:17:37,039
you'll go back and make sure that you

462
00:17:37,039 --> 00:17:39,600
have detections on everything

463
00:17:39,600 --> 00:17:41,200
so

464
00:17:41,200 --> 00:17:43,360
this brings me to

465
00:17:43,360 --> 00:17:44,559
this slide

466
00:17:44,559 --> 00:17:48,000
uh we have to talk about how to take

467
00:17:48,000 --> 00:17:49,840
that open source research and turn it

468
00:17:49,840 --> 00:17:51,600
into something actionable

469
00:17:51,600 --> 00:17:52,640
and

470
00:17:52,640 --> 00:17:55,280
that brings us to why attribution

471
00:17:55,280 --> 00:17:56,400
matters

472
00:17:56,400 --> 00:17:58,400
we've come a really long way as a

473
00:17:58,400 --> 00:18:00,480
community when it comes to attribution

474
00:18:00,480 --> 00:18:02,960
and believe me we have much further to

475
00:18:02,960 --> 00:18:03,760
go

476
00:18:03,760 --> 00:18:06,160
but um it is really important as a

477
00:18:06,160 --> 00:18:08,720
defender to understand why attribution

478
00:18:08,720 --> 00:18:12,080
matters um and honestly as an incident

479
00:18:12,080 --> 00:18:15,919
responder myself i'm not going to try to

480
00:18:15,919 --> 00:18:17,679
attribute any threat group or even

481
00:18:17,679 --> 00:18:19,200
create threat groups mostly because i

482
00:18:19,200 --> 00:18:21,600
just don't have that visibility but i

483
00:18:21,600 --> 00:18:24,320
leverage all of that attribution every

484
00:18:24,320 --> 00:18:26,640
day when i'm responding to incidents and

485
00:18:26,640 --> 00:18:29,600
here's why attribution can really tell

486
00:18:29,600 --> 00:18:31,440
us what the outcome of the incident

487
00:18:31,440 --> 00:18:32,880
probably

488
00:18:32,880 --> 00:18:36,240
would be or is intended to be uh and it

489
00:18:36,240 --> 00:18:39,600
can help me understand you know where

490
00:18:39,600 --> 00:18:40,880
uh

491
00:18:40,880 --> 00:18:43,039
where to look where to start when i'm

492
00:18:43,039 --> 00:18:45,039
trying to make sure that my network is

493
00:18:45,039 --> 00:18:45,840
uh

494
00:18:45,840 --> 00:18:48,000
is defended against those imminent

495
00:18:48,000 --> 00:18:50,880
threats so i keep the following

496
00:18:50,880 --> 00:18:52,720
questions in mind whenever i read a

497
00:18:52,720 --> 00:18:55,200
threat report uh because it helps me

498
00:18:55,200 --> 00:18:57,520
craft my um

499
00:18:57,520 --> 00:18:58,960
my hunts

500
00:18:58,960 --> 00:19:02,160
so first is do did the

501
00:19:02,160 --> 00:19:03,280
uh

502
00:19:03,280 --> 00:19:06,080
did the person who wrote this blog or

503
00:19:06,080 --> 00:19:08,640
the uh threat report

504
00:19:08,640 --> 00:19:10,480
attribute this threat actor to a

505
00:19:10,480 --> 00:19:12,320
specific region a specific threat group

506
00:19:12,320 --> 00:19:16,799
that's already known um and uh outline

507
00:19:16,799 --> 00:19:18,400
what the ramifications and what they're

508
00:19:18,400 --> 00:19:20,960
what they're generally after

509
00:19:20,960 --> 00:19:22,240
next um

510
00:19:22,240 --> 00:19:24,160
we see

511
00:19:24,160 --> 00:19:25,280
when

512
00:19:25,280 --> 00:19:27,919
did this threat actor start or end this

513
00:19:27,919 --> 00:19:29,919
campaign that they're reporting on or is

514
00:19:29,919 --> 00:19:32,400
it still an ongoing uh

515
00:19:32,400 --> 00:19:34,559
incident right

516
00:19:34,559 --> 00:19:36,640
then we have what was the intended

517
00:19:36,640 --> 00:19:39,120
outcome um this goes along with the who

518
00:19:39,120 --> 00:19:40,720
um it was it data theft was it

519
00:19:40,720 --> 00:19:43,360
disruption was it just monetary based

520
00:19:43,360 --> 00:19:45,600
right uh and then that follows on with

521
00:19:45,600 --> 00:19:47,280
could there be any other motivations

522
00:19:47,280 --> 00:19:48,720
behind the campaign something like

523
00:19:48,720 --> 00:19:51,440
espionage or political interference or

524
00:19:51,440 --> 00:19:52,400
advantage

525
00:19:52,400 --> 00:19:55,120
um or was it just purely a nuisance uh

526
00:19:55,120 --> 00:19:57,840
type uh attack

527
00:19:57,840 --> 00:20:00,160
and then we have is the threat actor

528
00:20:00,160 --> 00:20:02,320
targeting something specific right are

529
00:20:02,320 --> 00:20:04,880
they targeting a specific geo geography

530
00:20:04,880 --> 00:20:05,600
uh

531
00:20:05,600 --> 00:20:08,799
geographic look uh location or

532
00:20:08,799 --> 00:20:12,320
uh a group or or like a group of people

533
00:20:12,320 --> 00:20:14,559
or an industry specifically right this

534
00:20:14,559 --> 00:20:17,039
will help us understand

535
00:20:17,039 --> 00:20:19,520
what our hunts are supposed to look like

536
00:20:19,520 --> 00:20:21,520
and what speed we need to get them out

537
00:20:21,520 --> 00:20:23,120
and make sure that we have detections

538
00:20:23,120 --> 00:20:24,080
against

539
00:20:24,080 --> 00:20:26,559
and last but certainly not least how is

540
00:20:26,559 --> 00:20:28,799
the campaign being carried out

541
00:20:28,799 --> 00:20:30,320
as you're reading

542
00:20:30,320 --> 00:20:31,679
a new threat report think about all of

543
00:20:31,679 --> 00:20:32,880
these different questions in the back of

544
00:20:32,880 --> 00:20:35,200
your mind like i mentioned it's going to

545
00:20:35,200 --> 00:20:36,960
help you create your hypotheses for

546
00:20:36,960 --> 00:20:39,280
hunting and

547
00:20:39,280 --> 00:20:40,960
figure out how much

548
00:20:40,960 --> 00:20:43,919
people power you need to put behind it

549
00:20:43,919 --> 00:20:46,559
so actionable attribution gives us a

550
00:20:46,559 --> 00:20:48,480
quicker way to respond and move quickly

551
00:20:48,480 --> 00:20:51,200
as the situation changes and we find new

552
00:20:51,200 --> 00:20:52,799
data that can either strengthen or

553
00:20:52,799 --> 00:20:55,600
hinder our case uh for the initial

554
00:20:55,600 --> 00:20:58,400
response uh our initial hunt so this all

555
00:20:58,400 --> 00:21:00,640
starts with our ability to get info on

556
00:21:00,640 --> 00:21:03,039
the campaigns and threat groups

557
00:21:03,039 --> 00:21:04,480
so

558
00:21:04,480 --> 00:21:05,840
now understand

559
00:21:05,840 --> 00:21:10,000
just before you jump to conclusions uh

560
00:21:10,000 --> 00:21:13,200
sometimes bad threat group names happen

561
00:21:13,200 --> 00:21:16,640
uh it's okay really i promise just

562
00:21:16,640 --> 00:21:20,320
remember that tools do not make a threat

563
00:21:20,320 --> 00:21:22,960
group okay um it can be really confusing

564
00:21:22,960 --> 00:21:25,039
as an offender for a number of reasons

565
00:21:25,039 --> 00:21:28,000
when this happens um because honestly

566
00:21:28,000 --> 00:21:29,440
threat actors

567
00:21:29,440 --> 00:21:32,880
use tools to complete missions right as

568
00:21:32,880 --> 00:21:36,080
folks that are um involved with naming

569
00:21:36,080 --> 00:21:38,640
threat groups uh we have to remember

570
00:21:38,640 --> 00:21:40,720
that when we name newly attributed

571
00:21:40,720 --> 00:21:43,440
groups after the tools that they that

572
00:21:43,440 --> 00:21:45,360
we're observing them using we make it

573
00:21:45,360 --> 00:21:48,480
more confusing for uh defenders as the

574
00:21:48,480 --> 00:21:50,880
group evolves right

575
00:21:50,880 --> 00:21:52,400
we have to do better as a threat

576
00:21:52,400 --> 00:21:54,559
intelligence community to make sure that

577
00:21:54,559 --> 00:21:56,400
our defenders and our threat hunters and

578
00:21:56,400 --> 00:21:57,679
the folks that are on the ground

579
00:21:57,679 --> 00:22:00,559
defending networks have as much as they

580
00:22:00,559 --> 00:22:04,240
need um to do the job well

581
00:22:04,240 --> 00:22:06,559
this means that uh

582
00:22:06,559 --> 00:22:08,400
the group could

583
00:22:08,400 --> 00:22:09,200
uh

584
00:22:09,200 --> 00:22:10,080
you know

585
00:22:10,080 --> 00:22:11,200
if if

586
00:22:11,200 --> 00:22:14,000
if the group develops or changes tooling

587
00:22:14,000 --> 00:22:16,240
um it could cause the group to fall off

588
00:22:16,240 --> 00:22:19,039
those defenders radar or even completely

589
00:22:19,039 --> 00:22:21,840
miss out um on other aspects of the main

590
00:22:21,840 --> 00:22:24,000
part of the threat actors campaign like

591
00:22:24,000 --> 00:22:25,760
for instance

592
00:22:25,760 --> 00:22:27,360
the trickbot group

593
00:22:27,360 --> 00:22:29,200
there was a period of time when the

594
00:22:29,200 --> 00:22:32,000
trickbot malware was not being seen

595
00:22:32,000 --> 00:22:34,880
deployed to new victims

596
00:22:34,880 --> 00:22:36,480
so we saw

597
00:22:36,480 --> 00:22:39,200
public reports that the trickbot group

598
00:22:39,200 --> 00:22:43,280
was taken down um and i had i had folks

599
00:22:43,280 --> 00:22:45,280
coming to me um that i've worked with

600
00:22:45,280 --> 00:22:46,640
previously

601
00:22:46,640 --> 00:22:48,400
during response efforts that involved

602
00:22:48,400 --> 00:22:50,799
trickbot um telling me that they were

603
00:22:50,799 --> 00:22:52,559
safe and they didn't have to do anything

604
00:22:52,559 --> 00:22:55,600
else um but honestly that's not really

605
00:22:55,600 --> 00:22:58,640
how this works right uh this can confuse

606
00:22:58,640 --> 00:23:01,039
investigators and defenders alike if

607
00:23:01,039 --> 00:23:03,120
they've never been uh

608
00:23:03,120 --> 00:23:06,400
privy to what that tool looks like um

609
00:23:06,400 --> 00:23:09,440
because trickbot among other access as a

610
00:23:09,440 --> 00:23:11,520
service platforms are known to sell

611
00:23:11,520 --> 00:23:14,320
access to victims most of the time it's

612
00:23:14,320 --> 00:23:16,400
for the purpose of deploying ransomware

613
00:23:16,400 --> 00:23:19,280
so we have to be very careful as um

614
00:23:19,280 --> 00:23:20,720
security professionals when we're

615
00:23:20,720 --> 00:23:23,520
talking about uh tooling versus the

616
00:23:23,520 --> 00:23:26,080
threat groups themselves

617
00:23:26,080 --> 00:23:28,640
or you know let's just say

618
00:23:28,640 --> 00:23:29,520
just

619
00:23:29,520 --> 00:23:31,679
you know maybe one day

620
00:23:31,679 --> 00:23:34,000
that the tool that the group is named

621
00:23:34,000 --> 00:23:35,840
after is actually being used in

622
00:23:35,840 --> 00:23:37,280
different missions

623
00:23:37,280 --> 00:23:40,240
by different threat actors right so this

624
00:23:40,240 --> 00:23:43,360
brings me to my next slide uh

625
00:23:43,360 --> 00:23:45,600
let me introduce you to the cobalt group

626
00:23:45,600 --> 00:23:47,760
um now

627
00:23:47,760 --> 00:23:49,440
we'll get into what cobalt strike is a

628
00:23:49,440 --> 00:23:51,600
little bit later on in this talk but

629
00:23:51,600 --> 00:23:53,760
this group has really always confused me

630
00:23:53,760 --> 00:23:55,279
and i see a ton of different threat

631
00:23:55,279 --> 00:23:58,080
actors on a daily basis and um

632
00:23:58,080 --> 00:24:01,840
so when the first news reports hit

633
00:24:01,840 --> 00:24:04,000
it outlined that this group leveraged a

634
00:24:04,000 --> 00:24:06,000
lot of spearfishing campaigns to drop

635
00:24:06,000 --> 00:24:08,640
cobalt strike payloads for backdoor

636
00:24:08,640 --> 00:24:12,240
access when uh they were trying to move

637
00:24:12,240 --> 00:24:14,799
through financially uh or move through

638
00:24:14,799 --> 00:24:16,799
financial organizations

639
00:24:16,799 --> 00:24:18,720
and institutions to commit some

640
00:24:18,720 --> 00:24:20,400
financially motivated

641
00:24:20,400 --> 00:24:23,200
crimes right uh so

642
00:24:23,200 --> 00:24:25,360
it got even better when i did a little

643
00:24:25,360 --> 00:24:27,760
bit more digging uh

644
00:24:27,760 --> 00:24:28,880
because

645
00:24:28,880 --> 00:24:30,799
i found out that they were using cobalt

646
00:24:30,799 --> 00:24:33,120
strike and like it confused me even more

647
00:24:33,120 --> 00:24:35,200
because that wasn't even a custom tool

648
00:24:35,200 --> 00:24:38,799
um so it wasn't even like custom to them

649
00:24:38,799 --> 00:24:40,480
so i just got very confused and i

650
00:24:40,480 --> 00:24:42,159
remember reading through the like the

651
00:24:42,159 --> 00:24:44,080
vlog that outlined everything and got

652
00:24:44,080 --> 00:24:45,200
confused when they were talking about

653
00:24:45,200 --> 00:24:47,279
the group or talking about the malware

654
00:24:47,279 --> 00:24:49,360
specifically and that's just like as a

655
00:24:49,360 --> 00:24:50,880
defender you never want that to happen

656
00:24:50,880 --> 00:24:53,440
and as a someone who authors papers and

657
00:24:53,440 --> 00:24:56,159
stuff like i wouldn't want my readers to

658
00:24:56,159 --> 00:24:58,000
be confused when they're reading a paper

659
00:24:58,000 --> 00:24:59,679
especially against something that's very

660
00:24:59,679 --> 00:25:00,400
very

661
00:25:00,400 --> 00:25:03,200
very important here um so

662
00:25:03,200 --> 00:25:04,960
uh i

663
00:25:04,960 --> 00:25:07,039
it's just it's just very funny to me i

664
00:25:07,039 --> 00:25:10,000
don't know why uh but uh this got even

665
00:25:10,000 --> 00:25:11,919
better when in

666
00:25:11,919 --> 00:25:15,200
mid 2020 uh the cobalt group reportedly

667
00:25:15,200 --> 00:25:17,600
refactored their tool set uh moving

668
00:25:17,600 --> 00:25:19,360
further away from even using cobalt

669
00:25:19,360 --> 00:25:21,840
strike i don't know uh i just i i find

670
00:25:21,840 --> 00:25:24,080
it funny okay hey my name is giggs like

671
00:25:24,080 --> 00:25:26,559
it's gonna happen okay um and then of

672
00:25:26,559 --> 00:25:28,320
course i'm not even going to start in on

673
00:25:28,320 --> 00:25:30,480
the carbonac malware versus the carbonac

674
00:25:30,480 --> 00:25:32,640
group uh

675
00:25:32,640 --> 00:25:34,400
once it's safe to get back into large

676
00:25:34,400 --> 00:25:36,720
conferences i'll see you guys at the bar

677
00:25:36,720 --> 00:25:39,200
if you're allowed and we can chat about

678
00:25:39,200 --> 00:25:41,919
my vehement dislike that this had ever

679
00:25:41,919 --> 00:25:42,880
existed

680
00:25:42,880 --> 00:25:45,039
um so basically the biggest takeaway

681
00:25:45,039 --> 00:25:47,279
here is to just stop calling new threat

682
00:25:47,279 --> 00:25:49,200
groups by their tool names okay just

683
00:25:49,200 --> 00:25:51,919
like stop

684
00:25:51,919 --> 00:25:53,440
now if you're confused by the

685
00:25:53,440 --> 00:25:55,440
explanation of a report that you're

686
00:25:55,440 --> 00:25:58,080
reading try to find additional resources

687
00:25:58,080 --> 00:26:00,320
or reports to validate it because the

688
00:26:00,320 --> 00:26:03,600
more data the better

689
00:26:04,400 --> 00:26:05,200
so

690
00:26:05,200 --> 00:26:07,440
this uh seems to be a really important

691
00:26:07,440 --> 00:26:10,880
clarification these days um i am here to

692
00:26:10,880 --> 00:26:14,559
remind you that ransomware has operators

693
00:26:14,559 --> 00:26:18,320
uh so it goes a little bit like this

694
00:26:18,320 --> 00:26:19,679
more and more

695
00:26:19,679 --> 00:26:22,000
uh we're seeing ransomware variants

696
00:26:22,000 --> 00:26:24,960
impacting victims operating through what

697
00:26:24,960 --> 00:26:27,200
we know is as a

698
00:26:27,200 --> 00:26:28,960
affiliate model

699
00:26:28,960 --> 00:26:30,880
what this means is that the main code

700
00:26:30,880 --> 00:26:34,320
maintainer licenses out their ransomware

701
00:26:34,320 --> 00:26:37,360
malware samples to affiliates to perform

702
00:26:37,360 --> 00:26:39,520
their operations aka deploying their

703
00:26:39,520 --> 00:26:40,960
ransomware

704
00:26:40,960 --> 00:26:43,440
and then the the maintainers take a cut

705
00:26:43,440 --> 00:26:46,000
of their ransomware payment so

706
00:26:46,000 --> 00:26:48,960
maybe it's not sufficient to ask

707
00:26:48,960 --> 00:26:52,080
of the environment are we safe from soda

708
00:26:52,080 --> 00:26:56,080
nikiti or darkseid right um

709
00:26:56,080 --> 00:26:57,279
because

710
00:26:57,279 --> 00:26:59,200
uh i know that

711
00:26:59,200 --> 00:27:02,480
attribution matters really does uh

712
00:27:02,480 --> 00:27:04,400
cause a point of contention within the

713
00:27:04,400 --> 00:27:05,760
twitter sphere

714
00:27:05,760 --> 00:27:08,080
but realistically it does matter

715
00:27:08,080 --> 00:27:10,559
so much for defenders because you want

716
00:27:10,559 --> 00:27:12,080
to stay one step ahead of the threat

717
00:27:12,080 --> 00:27:13,840
actors as much as possible they're

718
00:27:13,840 --> 00:27:16,320
already collaborating uh

719
00:27:16,320 --> 00:27:18,960
more efficiently apparently than we are

720
00:27:18,960 --> 00:27:21,200
as defenders and we want to make sure

721
00:27:21,200 --> 00:27:23,520
that everyone knows that threat actors

722
00:27:23,520 --> 00:27:26,960
use tools right um to to come uh

723
00:27:26,960 --> 00:27:29,120
complete their mission it's the trade

724
00:27:29,120 --> 00:27:31,279
craft and the ttps that really matter

725
00:27:31,279 --> 00:27:32,720
that's what we're hunting for that's the

726
00:27:32,720 --> 00:27:36,159
goal um to find them before they have

727
00:27:36,159 --> 00:27:38,240
completed their mission hopefully we'll

728
00:27:38,240 --> 00:27:40,159
catch them in the very early stages of

729
00:27:40,159 --> 00:27:42,640
their mission um when they are trying to

730
00:27:42,640 --> 00:27:45,120
establish their foothold so that we um

731
00:27:45,120 --> 00:27:47,360
you know kind of avoid any any

732
00:27:47,360 --> 00:27:49,760
additional risk right that is that is

733
00:27:49,760 --> 00:27:53,120
the goal that's where we're at

734
00:27:53,120 --> 00:27:54,320
now

735
00:27:54,320 --> 00:27:56,000
understanding threat groups and what

736
00:27:56,000 --> 00:27:58,960
they target uh can help you address

737
00:27:58,960 --> 00:28:01,120
business risk

738
00:28:01,120 --> 00:28:04,000
um so as you're reading through your

739
00:28:04,000 --> 00:28:05,600
threat blogs identify if your

740
00:28:05,600 --> 00:28:07,200
organization is even a target of these

741
00:28:07,200 --> 00:28:09,200
campaigns it will help you define the

742
00:28:09,200 --> 00:28:11,840
level of effort you're going through um

743
00:28:11,840 --> 00:28:13,679
you're going to throw behind creating

744
00:28:13,679 --> 00:28:16,000
your hunts um basically do you even have

745
00:28:16,000 --> 00:28:17,760
the technology that just disclosed a

746
00:28:17,760 --> 00:28:19,600
vulnerability that is being actively

747
00:28:19,600 --> 00:28:22,320
exploited or maybe you have customers or

748
00:28:22,320 --> 00:28:24,880
partners that could be impacted by this

749
00:28:24,880 --> 00:28:27,360
new campaign right that might open up

750
00:28:27,360 --> 00:28:30,720
your organization to additional risk

751
00:28:30,720 --> 00:28:34,480
uh do you even have data to pivot off of

752
00:28:34,480 --> 00:28:37,679
right we'll identify in a blog here

753
00:28:37,679 --> 00:28:39,600
later some additional indicators of

754
00:28:39,600 --> 00:28:41,760
compromise that

755
00:28:41,760 --> 00:28:43,120
we

756
00:28:43,120 --> 00:28:44,960
can search for but we have to have a way

757
00:28:44,960 --> 00:28:46,640
to search for it throughout our

758
00:28:46,640 --> 00:28:48,159
environment and we have to have a stable

759
00:28:48,159 --> 00:28:49,840
way that's repeatable because we're

760
00:28:49,840 --> 00:28:52,799
gonna eventually automate our hunts um

761
00:28:52,799 --> 00:28:54,480
so if you've answered yes to any of

762
00:28:54,480 --> 00:28:56,480
these questions then you're gonna wanna

763
00:28:56,480 --> 00:28:58,640
move really quickly and then

764
00:28:58,640 --> 00:29:01,039
maybe consider shutting off those

765
00:29:01,039 --> 00:29:03,440
potentially impacted assets you know if

766
00:29:03,440 --> 00:29:05,440
another network appliance zero day comes

767
00:29:05,440 --> 00:29:07,760
out because uh a lot of them have been

768
00:29:07,760 --> 00:29:09,279
used to deploy red square within

769
00:29:09,279 --> 00:29:11,520
environments i mean we are still in 2021

770
00:29:11,520 --> 00:29:13,840
you know um think about

771
00:29:13,840 --> 00:29:15,039
those

772
00:29:15,039 --> 00:29:16,960
think about just think about it it's

773
00:29:16,960 --> 00:29:18,640
kind of scary

774
00:29:18,640 --> 00:29:20,000
now if you're lucky and you have

775
00:29:20,000 --> 00:29:22,320
answered no to those questions uh you

776
00:29:22,320 --> 00:29:23,760
should still be doing those hunts but

777
00:29:23,760 --> 00:29:26,159
you can take a more gradual and like

778
00:29:26,159 --> 00:29:29,520
casual approach to it right

779
00:29:29,520 --> 00:29:32,399
um so understanding that uh

780
00:29:32,399 --> 00:29:33,919
understanding how to read and interpret

781
00:29:33,919 --> 00:29:36,399
those threat blogs for your organization

782
00:29:36,399 --> 00:29:38,399
can really help quell anxieties of

783
00:29:38,399 --> 00:29:41,120
executive leadership so if you don't

784
00:29:41,120 --> 00:29:42,559
have that appliance that's being

785
00:29:42,559 --> 00:29:44,320
targeted you're not really a target

786
00:29:44,320 --> 00:29:46,559
right so take all of the other follow-on

787
00:29:46,559 --> 00:29:48,480
actions that are in the report and

788
00:29:48,480 --> 00:29:50,399
action on those make detections

789
00:29:50,399 --> 00:29:51,760
understand whether or not you have

790
00:29:51,760 --> 00:29:54,080
visibility to see if those

791
00:29:54,080 --> 00:29:55,600
actions are taken within your

792
00:29:55,600 --> 00:29:57,279
environment if someone does get access

793
00:29:57,279 --> 00:29:58,720
to your perimeter

794
00:29:58,720 --> 00:30:00,159
breaches are going to happen but

795
00:30:00,159 --> 00:30:02,159
honestly nothing is going to get done if

796
00:30:02,159 --> 00:30:04,880
we're all panicking you know

797
00:30:04,880 --> 00:30:07,039
one other big topic that seems very

798
00:30:07,039 --> 00:30:09,520
timely to discuss is

799
00:30:09,520 --> 00:30:11,840
uh

800
00:30:11,840 --> 00:30:12,640
is

801
00:30:12,640 --> 00:30:14,399
understanding the timing of campaigns

802
00:30:14,399 --> 00:30:17,200
for example detection can be a really

803
00:30:17,200 --> 00:30:19,760
big uh can play a really big role but

804
00:30:19,760 --> 00:30:21,360
acting on those detections is really

805
00:30:21,360 --> 00:30:23,360
where the money is initial point of

806
00:30:23,360 --> 00:30:25,679
compromise to completion of the mission

807
00:30:25,679 --> 00:30:28,720
for uh ransomware has been as quick as a

808
00:30:28,720 --> 00:30:31,440
couple of hours uh so that doesn't leave

809
00:30:31,440 --> 00:30:34,399
a lot of room if you're unprepared right

810
00:30:34,399 --> 00:30:36,399
all right so

811
00:30:36,399 --> 00:30:37,919
a little bit ago we were talking about

812
00:30:37,919 --> 00:30:39,679
the wild theories that swifties can

813
00:30:39,679 --> 00:30:40,799
create if they haven't heard from taylor

814
00:30:40,799 --> 00:30:42,720
swift in a while so remember this

815
00:30:42,720 --> 00:30:44,000
picture

816
00:30:44,000 --> 00:30:45,440
let's just all make an agreement right

817
00:30:45,440 --> 00:30:47,520
now that we will never let our threat

818
00:30:47,520 --> 00:30:51,360
hunt get so far down into a uh a rabbit

819
00:30:51,360 --> 00:30:54,240
hole that will get here okay

820
00:30:54,240 --> 00:30:56,080
now in order for us to get to the main

821
00:30:56,080 --> 00:30:57,840
goal of our hunts let's talk about

822
00:30:57,840 --> 00:31:00,799
generating a good threat hunt

823
00:31:00,799 --> 00:31:02,880
let's start with this we have to

824
00:31:02,880 --> 00:31:05,120
capitalize on the core principles of

825
00:31:05,120 --> 00:31:07,679
what is considered a successful hunt

826
00:31:07,679 --> 00:31:09,440
within our organization that is

827
00:31:09,440 --> 00:31:11,519
something you need to define within your

828
00:31:11,519 --> 00:31:13,279
team but here are some things to keep in

829
00:31:13,279 --> 00:31:15,679
mind first we want that actionable

830
00:31:15,679 --> 00:31:18,080
intelligence that way we can identify

831
00:31:18,080 --> 00:31:20,159
unknowns and create new detections for

832
00:31:20,159 --> 00:31:21,840
things that are happening in the wild

833
00:31:21,840 --> 00:31:23,679
and are being reported on these hunts

834
00:31:23,679 --> 00:31:25,440
will give us a better understanding of

835
00:31:25,440 --> 00:31:27,440
where our gaps are and then we will be

836
00:31:27,440 --> 00:31:29,200
able to later work to close them down

837
00:31:29,200 --> 00:31:31,600
and create new detections to better find

838
00:31:31,600 --> 00:31:32,799
evil

839
00:31:32,799 --> 00:31:34,399
through this we'll be able to also

840
00:31:34,399 --> 00:31:36,000
provide a lot of data to show what's

841
00:31:36,000 --> 00:31:38,000
working and what's not working and pivot

842
00:31:38,000 --> 00:31:39,279
through to make sure that we are

843
00:31:39,279 --> 00:31:41,200
continuously getting better

844
00:31:41,200 --> 00:31:43,440
and to do that we're going to validate

845
00:31:43,440 --> 00:31:46,000
that we have uh relevant indicators

846
00:31:46,000 --> 00:31:48,080
throughout our environment to make sure

847
00:31:48,080 --> 00:31:50,000
that we have all of the visibility that

848
00:31:50,000 --> 00:31:53,200
we need um and what we're looking for

849
00:31:53,200 --> 00:31:54,320
right

850
00:31:54,320 --> 00:31:55,919
then of course we're going to anticipate

851
00:31:55,919 --> 00:31:58,080
that these things will change and make

852
00:31:58,080 --> 00:31:59,679
sure that there is a plan for

853
00:31:59,679 --> 00:32:02,159
improvement both security controls wise

854
00:32:02,159 --> 00:32:04,799
as well as those detections once those

855
00:32:04,799 --> 00:32:07,519
are put into place verify uh we're able

856
00:32:07,519 --> 00:32:10,640
to see those indicators right

857
00:32:10,640 --> 00:32:12,000
then we want to make sure that we have

858
00:32:12,000 --> 00:32:13,519
measurable metrics making sure that we

859
00:32:13,519 --> 00:32:15,840
have something to show uh that we're

860
00:32:15,840 --> 00:32:17,760
working through a number of tasks and

861
00:32:17,760 --> 00:32:19,200
have a way to show that we're increasing

862
00:32:19,200 --> 00:32:22,880
the efficiency and the way that those uh

863
00:32:22,880 --> 00:32:25,039
that are looking at uh those detections

864
00:32:25,039 --> 00:32:28,240
um can work through them in a more uh

865
00:32:28,240 --> 00:32:30,640
succinct pattern and lastly make sure

866
00:32:30,640 --> 00:32:32,480
that you're able to communicate those

867
00:32:32,480 --> 00:32:34,559
findings to the security community um

868
00:32:34,559 --> 00:32:36,399
because that's a huge goal right uh

869
00:32:36,399 --> 00:32:38,960
figuring out what works and what doesn't

870
00:32:38,960 --> 00:32:40,960
um if you're able to of course i'm not a

871
00:32:40,960 --> 00:32:43,360
lawyer this is not legal advice

872
00:32:43,360 --> 00:32:46,000
uh so if i've learned anything from miss

873
00:32:46,000 --> 00:32:47,600
taylor swift over the years it's about

874
00:32:47,600 --> 00:32:49,919
understanding your worth um not only so

875
00:32:49,919 --> 00:32:52,960
that you can get paid for what uh you

876
00:32:52,960 --> 00:32:54,799
have contributed

877
00:32:54,799 --> 00:32:56,640
in the environment um and in the

878
00:32:56,640 --> 00:33:00,880
community but also understand that um

879
00:33:00,880 --> 00:33:02,399
you can inspire the rest of your team to

880
00:33:02,399 --> 00:33:04,320
reach higher peaks

881
00:33:04,320 --> 00:33:07,600
now uh we have uh now that we have what

882
00:33:07,600 --> 00:33:10,159
it takes to make up a good hunt let's

883
00:33:10,159 --> 00:33:13,440
dive into this uh hypothesis generate uh

884
00:33:13,440 --> 00:33:16,640
generation right um there are a ton of

885
00:33:16,640 --> 00:33:20,000
ways to approach threat hunting um

886
00:33:20,000 --> 00:33:21,600
one of them being proactive structured

887
00:33:21,600 --> 00:33:24,240
hunts where you're looking at tdps um

888
00:33:24,240 --> 00:33:26,320
something that might be helpful helpful

889
00:33:26,320 --> 00:33:29,200
for you is the mitre attack framework

890
00:33:29,200 --> 00:33:31,760
check that out if you haven't seen it um

891
00:33:31,760 --> 00:33:33,919
and uh maybe

892
00:33:33,919 --> 00:33:36,640
though you are more better you are more

893
00:33:36,640 --> 00:33:38,799
equipped to take on a methodical

894
00:33:38,799 --> 00:33:42,320
approach um to do some unstructured uh

895
00:33:42,320 --> 00:33:45,840
alert based detections um and hunts uh

896
00:33:45,840 --> 00:33:47,519
right to pivot on interesting points

897
00:33:47,519 --> 00:33:48,480
that are happening within your

898
00:33:48,480 --> 00:33:51,120
environment uh so you guys are probably

899
00:33:51,120 --> 00:33:52,720
thinking all right are we out of the

900
00:33:52,720 --> 00:33:53,760
woods yet

901
00:33:53,760 --> 00:33:56,640
uh so honestly i'm a bit of a nerd and i

902
00:33:56,640 --> 00:33:59,279
need to track things down on like pen

903
00:33:59,279 --> 00:34:01,120
and paper uh so this is how we're gonna

904
00:34:01,120 --> 00:34:04,000
be going through and keeping notes for

905
00:34:04,000 --> 00:34:06,640
uh the rest of this talk so we'll keep

906
00:34:06,640 --> 00:34:09,679
track of everything um for the days

907
00:34:09,679 --> 00:34:11,679
we'll grab iocs we'll put them here

908
00:34:11,679 --> 00:34:14,159
we'll keep track of next steps um and of

909
00:34:14,159 --> 00:34:15,440
course we're gonna

910
00:34:15,440 --> 00:34:17,679
make a note of what the goal is that

911
00:34:17,679 --> 00:34:20,320
we're looking for

912
00:34:20,320 --> 00:34:21,599
so

913
00:34:21,599 --> 00:34:23,440
things to keep in mind making sure that

914
00:34:23,440 --> 00:34:25,839
you're acting or you're asking

915
00:34:25,839 --> 00:34:28,079
some structured yet broad questions of

916
00:34:28,079 --> 00:34:30,560
the data will allow you to let the data

917
00:34:30,560 --> 00:34:33,280
do the talking instead of your biases

918
00:34:33,280 --> 00:34:35,119
and then making sure that you know you

919
00:34:35,119 --> 00:34:36,719
have the data that you need to get a

920
00:34:36,719 --> 00:34:38,560
reasonable understanding of what is

921
00:34:38,560 --> 00:34:39,760
happening within the environment is

922
00:34:39,760 --> 00:34:41,918
super important as well so making sure

923
00:34:41,918 --> 00:34:43,760
that you have those proper data sets and

924
00:34:43,760 --> 00:34:45,280
then of course making sure that you have

925
00:34:45,280 --> 00:34:47,918
that standard practice of updating your

926
00:34:47,918 --> 00:34:50,320
procedures creating better detections

927
00:34:50,320 --> 00:34:52,560
and putting them all in play um so with

928
00:34:52,560 --> 00:34:55,119
that all in mind let's go ahead and pull

929
00:34:55,119 --> 00:34:57,200
out some uh

930
00:34:57,200 --> 00:35:00,160
rip apart a blog and see if we can come

931
00:35:00,160 --> 00:35:02,240
up with some structured hunts all right

932
00:35:02,240 --> 00:35:05,359
so we're going to start with this uh

933
00:35:05,359 --> 00:35:07,440
fireeye blog from may

934
00:35:07,440 --> 00:35:09,440
where it is looking at all the different

935
00:35:09,440 --> 00:35:11,680
uncategorized or unk groups leveraging

936
00:35:11,680 --> 00:35:13,920
the dark side ransomware

937
00:35:13,920 --> 00:35:16,960
so here we see that darkseid is a

938
00:35:16,960 --> 00:35:18,880
ransomware as a service which again

939
00:35:18,880 --> 00:35:21,119
basically means that the main code uh

940
00:35:21,119 --> 00:35:23,359
maintainer is is licensing out that

941
00:35:23,359 --> 00:35:25,040
ransomware malware for a portion of the

942
00:35:25,040 --> 00:35:28,079
ransom payment um and then here we see

943
00:35:28,079 --> 00:35:30,800
some host-based indicators that we can

944
00:35:30,800 --> 00:35:33,760
use to verify um the visibility that we

945
00:35:33,760 --> 00:35:35,920
have within the network

946
00:35:35,920 --> 00:35:37,599
and the

947
00:35:37,599 --> 00:35:40,960
instance for instance here we see

948
00:35:40,960 --> 00:35:42,800
some file names so we would want to make

949
00:35:42,800 --> 00:35:44,560
sure that we're able to go across all of

950
00:35:44,560 --> 00:35:46,160
the hosts within our environment and

951
00:35:46,160 --> 00:35:47,920
list out all of the file metadata to

952
00:35:47,920 --> 00:35:50,640
check what those file names are

953
00:35:50,640 --> 00:35:53,040
and then making sure that we can

954
00:35:53,040 --> 00:35:56,240
ascertain when it was created on disk

955
00:35:56,240 --> 00:35:58,640
what have you uh but then also we see up

956
00:35:58,640 --> 00:36:00,079
here there are some persistent

957
00:36:00,079 --> 00:36:02,560
mechanisms um so

958
00:36:02,560 --> 00:36:04,480
we're gonna want to check those uh but

959
00:36:04,480 --> 00:36:06,320
in this case it looks like it is just

960
00:36:06,320 --> 00:36:09,040
pulling up the ransom note um but that

961
00:36:09,040 --> 00:36:10,880
is a

962
00:36:10,880 --> 00:36:12,560
methodology methodology-based detection

963
00:36:12,560 --> 00:36:14,480
that you're going to want to uh figure

964
00:36:14,480 --> 00:36:17,520
out is weird service uh creation within

965
00:36:17,520 --> 00:36:19,200
your environment

966
00:36:19,200 --> 00:36:21,680
right so then at the end of the blog we

967
00:36:21,680 --> 00:36:23,280
see some

968
00:36:23,280 --> 00:36:25,200
host-based indicators um there's some

969
00:36:25,200 --> 00:36:27,200
network based indicators ip addresses

970
00:36:27,200 --> 00:36:31,119
domain names um and then at the end of

971
00:36:31,119 --> 00:36:34,720
this we see a md5 hash for a beacon

972
00:36:34,720 --> 00:36:35,760
sample

973
00:36:35,760 --> 00:36:37,680
um so let's go ahead and search that in

974
00:36:37,680 --> 00:36:40,640
virustotal awesome don't upload anything

975
00:36:40,640 --> 00:36:43,599
to virustotal just don't do it um

976
00:36:43,599 --> 00:36:46,800
just honestly just don't do it uh so

977
00:36:46,800 --> 00:36:49,599
here we see that people are

978
00:36:49,599 --> 00:36:51,280
you know there are a bunch of different

979
00:36:51,280 --> 00:36:52,800
vendors that are detecting it as cobalt

980
00:36:52,800 --> 00:36:54,560
strike let's go ahead and look at the

981
00:36:54,560 --> 00:36:57,040
relations um and of course we see that

982
00:36:57,040 --> 00:37:00,160
yep it is a cobalt strike beacon um all

983
00:37:00,160 --> 00:37:02,720
right so what the heck is cobalt

984
00:37:02,720 --> 00:37:05,760
what the heck is beacon right um so

985
00:37:05,760 --> 00:37:07,520
let's talk through what cobalt strike is

986
00:37:07,520 --> 00:37:09,760
cobalt strike was originally created as

987
00:37:09,760 --> 00:37:12,400
an adversary emulation tool that's often

988
00:37:12,400 --> 00:37:14,480
used by red teamers to perform red team

989
00:37:14,480 --> 00:37:16,400
engagements

990
00:37:16,400 --> 00:37:18,240
and

991
00:37:18,240 --> 00:37:21,200
it also unfortunately is used by a slew

992
00:37:21,200 --> 00:37:23,440
of threat actors to conduct a lot of

993
00:37:23,440 --> 00:37:25,839
financially motivated uh

994
00:37:25,839 --> 00:37:28,320
ransomware attacks um and

995
00:37:28,320 --> 00:37:29,200
other

996
00:37:29,200 --> 00:37:31,760
uh incidents as well so things to keep

997
00:37:31,760 --> 00:37:33,599
in mind when you see that cobalt strike

998
00:37:33,599 --> 00:37:36,000
payloads have made their way into the

999
00:37:36,000 --> 00:37:38,240
network or into a blog is that the

1000
00:37:38,240 --> 00:37:40,240
threat actor had to get those payments

1001
00:37:40,240 --> 00:37:43,359
or those payloads in somehow so

1002
00:37:43,359 --> 00:37:45,200
something like a phishing email or other

1003
00:37:45,200 --> 00:37:47,280
unauthorized access like

1004
00:37:47,280 --> 00:37:49,760
password reuse compromises or zero day

1005
00:37:49,760 --> 00:37:52,160
exploitations you know the list goes on

1006
00:37:52,160 --> 00:37:53,520
and on

1007
00:37:53,520 --> 00:37:55,839
cobalt strike pre uh provides a fully

1008
00:37:55,839 --> 00:37:58,079
featured backdoor that allows the threat

1009
00:37:58,079 --> 00:38:00,320
actor to access a victim system with

1010
00:38:00,320 --> 00:38:03,280
malicious payloads um and it can be in

1011
00:38:03,280 --> 00:38:05,520
memory only or maybe the malicious

1012
00:38:05,520 --> 00:38:07,040
payload is configured to run as a

1013
00:38:07,040 --> 00:38:09,760
persistent task or service that well

1014
00:38:09,760 --> 00:38:11,839
that's written to disk and we can find

1015
00:38:11,839 --> 00:38:13,920
it on disk if it's still available

1016
00:38:13,920 --> 00:38:16,320
um this provides the threat actor access

1017
00:38:16,320 --> 00:38:18,320
to the system much like an employee

1018
00:38:18,320 --> 00:38:20,000
would have access right they can run

1019
00:38:20,000 --> 00:38:22,320
commands snoop around the network and

1020
00:38:22,320 --> 00:38:24,000
move to different systems right it's

1021
00:38:24,000 --> 00:38:26,480
just really a bad time

1022
00:38:26,480 --> 00:38:28,400
oh and to top it all off decent threat

1023
00:38:28,400 --> 00:38:31,119
actors will be able to evade detection

1024
00:38:31,119 --> 00:38:33,680
so they uh will

1025
00:38:33,680 --> 00:38:35,440
scoot around all of the detections that

1026
00:38:35,440 --> 00:38:38,320
are using signature-based detections um

1027
00:38:38,320 --> 00:38:40,720
by bringing in custom payloads or simply

1028
00:38:40,720 --> 00:38:42,640
turning off antivirus or other security

1029
00:38:42,640 --> 00:38:44,560
tools within the environment it's just

1030
00:38:44,560 --> 00:38:47,599
fabulous um so with that information we

1031
00:38:47,599 --> 00:38:50,480
can craft a lot of different missions uh

1032
00:38:50,480 --> 00:38:52,320
for our hunt on cobalt strike within the

1033
00:38:52,320 --> 00:38:54,240
environment football strike is a massive

1034
00:38:54,240 --> 00:38:56,880
tool so go ahead and look at uh

1035
00:38:56,880 --> 00:38:57,760
the

1036
00:38:57,760 --> 00:38:59,760
all of the documents for it it's pretty

1037
00:38:59,760 --> 00:39:02,800
snazzy from a red teaming perspective uh

1038
00:39:02,800 --> 00:39:05,920
from a defender's perspective not so

1039
00:39:05,920 --> 00:39:06,880
much

1040
00:39:06,880 --> 00:39:09,119
honestly um so first we have to take a

1041
00:39:09,119 --> 00:39:11,440
look at all of the indicators that are

1042
00:39:11,440 --> 00:39:14,800
um provided in the blog

1043
00:39:14,800 --> 00:39:17,359
um and one of those being this

1044
00:39:17,359 --> 00:39:20,640
host-based indicator um

1045
00:39:20,640 --> 00:39:21,440
that

1046
00:39:21,440 --> 00:39:24,160
is a payload right so generally speaking

1047
00:39:24,160 --> 00:39:26,720
uh cobalt strike is going to be

1048
00:39:26,720 --> 00:39:29,760
represented on a host as some obfuscated

1049
00:39:29,760 --> 00:39:31,760
powershell um so one of the hunts that

1050
00:39:31,760 --> 00:39:34,320
you could do is looking through

1051
00:39:34,320 --> 00:39:36,320
you know historical powershell logging

1052
00:39:36,320 --> 00:39:38,240
or active process commands through

1053
00:39:38,240 --> 00:39:40,480
real-time alerting right if you don't

1054
00:39:40,480 --> 00:39:42,320
know about it already powershell has a

1055
00:39:42,320 --> 00:39:44,079
lot of vlogging and it's only getting

1056
00:39:44,079 --> 00:39:46,240
better shout out to the microsoft team

1057
00:39:46,240 --> 00:39:49,119
thank you so much um we really love to

1058
00:39:49,119 --> 00:39:51,359
see it on the defender side um if you

1059
00:39:51,359 --> 00:39:54,320
own a environment please turn on

1060
00:39:54,320 --> 00:39:57,200
powershell logging and beef up that uh

1061
00:39:57,200 --> 00:40:00,000
that event log retention

1062
00:40:00,000 --> 00:40:03,440
uh so that we can go through and comb

1063
00:40:03,440 --> 00:40:04,960
through all of this stuff so this is

1064
00:40:04,960 --> 00:40:06,240
cobalt strike

1065
00:40:06,240 --> 00:40:07,839
decoded and

1066
00:40:07,839 --> 00:40:10,079
this brings me to cyber chef cyber chef

1067
00:40:10,079 --> 00:40:13,359
is amazing um after we fully decode this

1068
00:40:13,359 --> 00:40:14,560
power shell

1069
00:40:14,560 --> 00:40:16,079
we see that there's a named pipe so

1070
00:40:16,079 --> 00:40:17,599
that's something else that we can hunt

1071
00:40:17,599 --> 00:40:20,079
for um when we get to network-based

1072
00:40:20,079 --> 00:40:21,920
indicators

1073
00:40:21,920 --> 00:40:23,839
so i see that we're running low on time

1074
00:40:23,839 --> 00:40:25,359
because i decided to chat a little bit

1075
00:40:25,359 --> 00:40:29,280
too much um but uh basically here is

1076
00:40:29,280 --> 00:40:32,400
what i would write down for this uh host

1077
00:40:32,400 --> 00:40:34,800
based hunt right um i would look through

1078
00:40:34,800 --> 00:40:37,200
all of the uh hbis that are listed in

1079
00:40:37,200 --> 00:40:39,040
that um

1080
00:40:39,040 --> 00:40:41,200
that blog but then also

1081
00:40:41,200 --> 00:40:43,520
i pulled out some example methodologies

1082
00:40:43,520 --> 00:40:46,560
here uh basically those uh obfuscated

1083
00:40:46,560 --> 00:40:49,280
powershell uh queries misplaced system

1084
00:40:49,280 --> 00:40:51,200
binaries uh

1085
00:40:51,200 --> 00:40:53,280
those system binaries calling outbound

1086
00:40:53,280 --> 00:40:54,560
go ahead and look those up those are

1087
00:40:54,560 --> 00:40:56,480
your pieces of homework um so we can

1088
00:40:56,480 --> 00:40:58,560
cruise right through here um next we're

1089
00:40:58,560 --> 00:41:01,040
talking about you know our network-based

1090
00:41:01,040 --> 00:41:04,079
indicators here um we

1091
00:41:04,079 --> 00:41:06,880
can look for network-based call-outs

1092
00:41:06,880 --> 00:41:09,599
using um

1093
00:41:09,599 --> 00:41:12,079
our dns logs uh so making sure that

1094
00:41:12,079 --> 00:41:14,400
you're logging dns first is the first

1095
00:41:14,400 --> 00:41:16,560
step um and then you can kind of go

1096
00:41:16,560 --> 00:41:19,280
through and stack like custom url uh

1097
00:41:19,280 --> 00:41:22,079
uris right uh you can see a bunch of

1098
00:41:22,079 --> 00:41:24,160
different post requests and stack those

1099
00:41:24,160 --> 00:41:26,319
and see what is kind of anomal what is

1100
00:41:26,319 --> 00:41:28,319
anomalies within your environment you

1101
00:41:28,319 --> 00:41:30,400
can also hunt through stack uh hunt

1102
00:41:30,400 --> 00:41:32,319
through and stack your user agents

1103
00:41:32,319 --> 00:41:34,319
because uh cobalt strike conveniently

1104
00:41:34,319 --> 00:41:37,280
allows you to set custom user agents um

1105
00:41:37,280 --> 00:41:38,240
so

1106
00:41:38,240 --> 00:41:41,599
go ahead and do that it's pretty nifty

1107
00:41:41,599 --> 00:41:43,280
because honestly the last thing that i

1108
00:41:43,280 --> 00:41:45,599
want to cover which is pretty pretty

1109
00:41:45,599 --> 00:41:47,359
difficult to understand sometimes and

1110
00:41:47,359 --> 00:41:49,760
it's also pretty difficult to detect is

1111
00:41:49,760 --> 00:41:53,119
this uh domain here so one thing that

1112
00:41:53,119 --> 00:41:56,240
concerns me over uh as a defender is

1113
00:41:56,240 --> 00:41:58,400
that this has azure in the top level

1114
00:41:58,400 --> 00:42:02,079
domain um so if you know anything about

1115
00:42:02,079 --> 00:42:03,200
the way

1116
00:42:03,200 --> 00:42:05,440
azure works this is actually a domain

1117
00:42:05,440 --> 00:42:08,160
that can be fronted

1118
00:42:08,160 --> 00:42:10,000
and

1119
00:42:10,000 --> 00:42:11,520
virustotal doesn't really give us a lot

1120
00:42:11,520 --> 00:42:12,640
of information because it is a

1121
00:42:12,640 --> 00:42:14,400
legitimate domain

1122
00:42:14,400 --> 00:42:16,560
but because it was in our blog we can we

1123
00:42:16,560 --> 00:42:19,040
know that it is uh bad right we know

1124
00:42:19,040 --> 00:42:21,280
that it was used in a malicious fashion

1125
00:42:21,280 --> 00:42:24,240
um so the way that the attacker did that

1126
00:42:24,240 --> 00:42:26,720
was they fronted the domain they

1127
00:42:26,720 --> 00:42:29,599
leveraged a um

1128
00:42:29,599 --> 00:42:30,720
they

1129
00:42:30,720 --> 00:42:33,119
basically abuse the way that a content

1130
00:42:33,119 --> 00:42:36,240
content delivery network is configured

1131
00:42:36,240 --> 00:42:38,800
um basically the content delivery

1132
00:42:38,800 --> 00:42:41,760
network is there to load balance um a

1133
00:42:41,760 --> 00:42:45,440
very uh heavily utilized domain back to

1134
00:42:45,440 --> 00:42:47,200
a bunch of different servers so a threat

1135
00:42:47,200 --> 00:42:49,280
actor can essentially front that domain

1136
00:42:49,280 --> 00:42:51,280
and say ins and tell the payload that

1137
00:42:51,280 --> 00:42:53,440
instead of using the actual domain and

1138
00:42:53,440 --> 00:42:55,920
getting picked up by that uh

1139
00:42:55,920 --> 00:42:57,599
that's uh actual content delivery

1140
00:42:57,599 --> 00:42:59,280
network it can

1141
00:42:59,280 --> 00:43:01,040
be configured to call back directly to

1142
00:43:01,040 --> 00:43:03,200
the attacker owned infrastructure

1143
00:43:03,200 --> 00:43:05,280
now keep in mind content delivery

1144
00:43:05,280 --> 00:43:07,040
network

1145
00:43:07,040 --> 00:43:09,040
fronting essentially is

1146
00:43:09,040 --> 00:43:11,280
used a lot to subvert censorship so we

1147
00:43:11,280 --> 00:43:13,440
can't just get rid of it um because

1148
00:43:13,440 --> 00:43:16,640
there are pros and cons to each um but

1149
00:43:16,640 --> 00:43:19,280
it can be really difficult to understand

1150
00:43:19,280 --> 00:43:22,640
because of how network traffic is often

1151
00:43:22,640 --> 00:43:24,400
configured to be

1152
00:43:24,400 --> 00:43:27,040
recorded within your environment so our

1153
00:43:27,040 --> 00:43:30,480
hypothesis generation here um really is

1154
00:43:30,480 --> 00:43:32,480
uh going to be searching for those

1155
00:43:32,480 --> 00:43:35,200
indicators historically and then also

1156
00:43:35,200 --> 00:43:37,119
looking through and making sure that we

1157
00:43:37,119 --> 00:43:39,359
have visibility into those dns requests

1158
00:43:39,359 --> 00:43:41,359
and making sure that we're able to see

1159
00:43:41,359 --> 00:43:43,599
whether or not those uh these indicators

1160
00:43:43,599 --> 00:43:45,440
specifically are

1161
00:43:45,440 --> 00:43:48,880
um able and or are showing up in our

1162
00:43:48,880 --> 00:43:50,640
environment because that probably will

1163
00:43:50,640 --> 00:43:52,480
mean that we have to go back and do a

1164
00:43:52,480 --> 00:43:54,560
little bit more of a deeper dive into

1165
00:43:54,560 --> 00:43:56,319
those systems specifically that they're

1166
00:43:56,319 --> 00:43:58,640
calling out from

1167
00:43:58,640 --> 00:43:59,599
now

1168
00:43:59,599 --> 00:44:00,720
let's see

1169
00:44:00,720 --> 00:44:02,640
um so

1170
00:44:02,640 --> 00:44:04,800
keep in mind that during your threat

1171
00:44:04,800 --> 00:44:06,640
hunt you are going to get a lot of false

1172
00:44:06,640 --> 00:44:09,119
positives rome was not built in a day

1173
00:44:09,119 --> 00:44:11,359
threat hunting is a marathon you have to

1174
00:44:11,359 --> 00:44:12,960
have fun with it you have to accept that

1175
00:44:12,960 --> 00:44:15,599
you're gonna be wrong it's okay you will

1176
00:44:15,599 --> 00:44:18,000
learn so much by being wrong just make

1177
00:44:18,000 --> 00:44:20,720
it part of your brand to

1178
00:44:20,720 --> 00:44:23,440
constantly learn from your mistakes

1179
00:44:23,440 --> 00:44:25,119
but also make it measurable right we're

1180
00:44:25,119 --> 00:44:26,560
not just out here getting into bunny

1181
00:44:26,560 --> 00:44:28,720
holes um because the more skills that

1182
00:44:28,720 --> 00:44:29,839
you're picking up the better hunts

1183
00:44:29,839 --> 00:44:31,680
you're going to have which means you're

1184
00:44:31,680 --> 00:44:33,920
going to be generating better detections

1185
00:44:33,920 --> 00:44:36,000
and finding more evils with it more evil

1186
00:44:36,000 --> 00:44:38,560
within your environment um hunt early

1187
00:44:38,560 --> 00:44:39,839
hunt often

1188
00:44:39,839 --> 00:44:42,480
this makes it less of a stress on the

1189
00:44:42,480 --> 00:44:43,440
sock

1190
00:44:43,440 --> 00:44:45,280
and honestly sometimes you can find

1191
00:44:45,280 --> 00:44:46,880
pre-ransomware activities and that's

1192
00:44:46,880 --> 00:44:48,160
just like

1193
00:44:48,160 --> 00:44:50,560
solid if you can thwart threat actors uh

1194
00:44:50,560 --> 00:44:52,960
mission right before they end it like

1195
00:44:52,960 --> 00:44:54,160
that's money

1196
00:44:54,160 --> 00:44:57,440
so as we wrap up here um

1197
00:44:57,440 --> 00:44:58,319
uh

1198
00:44:58,319 --> 00:45:01,040
let's go with uh this kind of summary

1199
00:45:01,040 --> 00:45:02,960
page i talked about a lot of different

1200
00:45:02,960 --> 00:45:05,200
things so let's just recap it

1201
00:45:05,200 --> 00:45:07,280
taylor swift she is a mastermind of

1202
00:45:07,280 --> 00:45:09,760
easter eggs and hidden messages uh the

1203
00:45:09,760 --> 00:45:12,960
data will tell us anything that we

1204
00:45:12,960 --> 00:45:15,920
like want to know even if it's wrong

1205
00:45:15,920 --> 00:45:17,520
and then also make sure that you're

1206
00:45:17,520 --> 00:45:19,119
sanity checking and making sure that

1207
00:45:19,119 --> 00:45:21,040
you're creating better questions each

1208
00:45:21,040 --> 00:45:23,359
time you're asking questions of the data

1209
00:45:23,359 --> 00:45:26,079
um and after you get through this cycle

1210
00:45:26,079 --> 00:45:28,960
make sure that you are able to validate

1211
00:45:28,960 --> 00:45:30,960
uh validate those signatures validate

1212
00:45:30,960 --> 00:45:32,880
the visibility validate your detections

1213
00:45:32,880 --> 00:45:34,160
making sure that you're constantly

1214
00:45:34,160 --> 00:45:37,200
having this feedback loop um hunt early

1215
00:45:37,200 --> 00:45:40,000
hunt often just do it honestly it's

1216
00:45:40,000 --> 00:45:41,680
going to be so much fun for you and

1217
00:45:41,680 --> 00:45:42,960
you're going to

1218
00:45:42,960 --> 00:45:45,119
be a lot better

1219
00:45:45,119 --> 00:45:48,000
as a as a detection and a detection

1220
00:45:48,000 --> 00:45:49,599
writer as well as an analyst

1221
00:45:49,599 --> 00:45:52,000
specifically um and of course you're

1222
00:45:52,000 --> 00:45:54,079
already here at this conference so just

1223
00:45:54,079 --> 00:45:55,839
keep learning those threat actors are

1224
00:45:55,839 --> 00:45:58,880
doing it um so honestly why shouldn't we

1225
00:45:58,880 --> 00:46:01,280
right all right

1226
00:46:01,280 --> 00:46:03,119
i think i made it i rushed through the

1227
00:46:03,119 --> 00:46:05,920
end of it but it's okay um so i know

1228
00:46:05,920 --> 00:46:09,040
that uh you all probably have questions

1229
00:46:09,040 --> 00:46:11,359
um i don't know that we have enough time

1230
00:46:11,359 --> 00:46:13,839
to do it uh answer those questions now

1231
00:46:13,839 --> 00:46:15,760
but i do want to give a huge shout out

1232
00:46:15,760 --> 00:46:17,760
to the conference organizers all of the

1233
00:46:17,760 --> 00:46:20,240
volunteers all of the tech support staff

1234
00:46:20,240 --> 00:46:22,480
like y'all have been amazing i had a

1235
00:46:22,480 --> 00:46:24,720
fabulous time i was enchanted to meet

1236
00:46:24,720 --> 00:46:26,079
everyone here

1237
00:46:26,079 --> 00:46:27,359
and i want to give

1238
00:46:27,359 --> 00:46:29,599
a lot of special thanks to my colleagues

1239
00:46:29,599 --> 00:46:32,240
who just like beefed up this uh this

1240
00:46:32,240 --> 00:46:35,839
talk to um roll through a lot of twitter

1241
00:46:35,839 --> 00:46:37,839
and get a lot of buzz it's amazing it's

1242
00:46:37,839 --> 00:46:39,839
such a great talk to have out there to

1243
00:46:39,839 --> 00:46:41,440
learn how to critically think and and

1244
00:46:41,440 --> 00:46:43,599
read through all of those tech uh tech

1245
00:46:43,599 --> 00:46:45,280
blogs to make sure that we're actively

1246
00:46:45,280 --> 00:46:47,680
hunting so with that i will say are

1247
00:46:47,680 --> 00:46:49,200
there any questions ariana i don't know

1248
00:46:49,200 --> 00:46:52,078
if we have time

1249
00:46:52,400 --> 00:46:55,119
hello hello thank you so so much i think

1250
00:46:55,119 --> 00:46:56,720
we don't have many questions there's a

1251
00:46:56,720 --> 00:46:58,240
lot of discussion going on in the chat

1252
00:46:58,240 --> 00:47:00,720
so now

1253
00:47:01,440 --> 00:47:04,160
there you go thanks jared

1254
00:47:04,160 --> 00:47:05,520
perfect

1255
00:47:05,520 --> 00:47:07,040
so in the chat you've got these few

1256
00:47:07,040 --> 00:47:09,119
precious minutes with kirsty everyone so

1257
00:47:09,119 --> 00:47:12,400
like go ahead uh thanks appreciated but

1258
00:47:12,400 --> 00:47:13,839
any questions

1259
00:47:13,839 --> 00:47:15,920
how else can we meet you kirsty uh now

1260
00:47:15,920 --> 00:47:17,359
we've run out of time today but how can

1261
00:47:17,359 --> 00:47:18,720
we get in touch and keep the

1262
00:47:18,720 --> 00:47:20,079
conversation going

1263
00:47:20,079 --> 00:47:22,480
yes if you are on uh the diana

1264
00:47:22,480 --> 00:47:23,599
initiative

1265
00:47:23,599 --> 00:47:26,400
slack please feel free to dm me um i

1266
00:47:26,400 --> 00:47:28,720
will be hanging around uh

1267
00:47:28,720 --> 00:47:31,280
either the rest of today and um also

1268
00:47:31,280 --> 00:47:33,280
tomorrow um and then of course follow me

1269
00:47:33,280 --> 00:47:35,760
on twitter i'm giggs underscore security

1270
00:47:35,760 --> 00:47:37,680
always happy to have conversations there

1271
00:47:37,680 --> 00:47:39,520
my dms are not open

1272
00:47:39,520 --> 00:47:40,960
but if i get enough

1273
00:47:40,960 --> 00:47:43,280
folks that want to dm me

1274
00:47:43,280 --> 00:47:45,520
i will open them for a little bit but

1275
00:47:45,520 --> 00:47:49,280
that's always an interesting situation

1276
00:47:49,359 --> 00:47:51,599
okay i think all that is left now is for

1277
00:47:51,599 --> 00:47:53,200
me to say thank you again thank you so

1278
00:47:53,200 --> 00:47:55,200
much for your time your expertise

1279
00:47:55,200 --> 00:47:57,359
fantastic talk and in the chat here

1280
00:47:57,359 --> 00:48:00,000
everyone everyone watching we've got uh

1281
00:48:00,000 --> 00:48:02,160
speaker surveys so please if you have

1282
00:48:02,160 --> 00:48:04,800
liked this talk please let us know give

1283
00:48:04,800 --> 00:48:06,400
us some feedback your feedback is good

1284
00:48:06,400 --> 00:48:08,640
for kirsty feedback is good for us here

1285
00:48:08,640 --> 00:48:11,359
diana initiative uh take the minute or

1286
00:48:11,359 --> 00:48:13,520
two that that you can we'd really

1287
00:48:13,520 --> 00:48:16,559
appreciate it thank you so so much

1288
00:48:16,559 --> 00:48:19,359
thank you all for coming

1289
00:48:19,359 --> 00:48:20,640
thanks kirsty

1290
00:48:20,640 --> 00:48:23,879
bye everyone

