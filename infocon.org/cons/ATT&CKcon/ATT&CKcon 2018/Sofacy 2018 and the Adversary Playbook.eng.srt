1
00:00:04,600 --> 00:00:09,760
so our next presenter has a long history

2
00:00:06,940 --> 00:00:11,380
<font color="#CCCCCC">with</font><font color="#E5E5E5"> cyber espionage and targeted</font>

3
00:00:09,760 --> 00:00:13,240
attacks which I when I read<font color="#E5E5E5"> that it's</font>

4
00:00:11,380 --> 00:00:15,309
like what<font color="#E5E5E5"> exactly does that mean</font><font color="#CCCCCC"> but</font>

5
00:00:13,240 --> 00:00:17,259
I'll leave it<font color="#CCCCCC"> to</font><font color="#E5E5E5"> him to answer</font>

6
00:00:15,309 --> 00:00:19,990
Robert Falcone is<font color="#CCCCCC"> a threat researcher</font>

7
00:00:17,260 --> 00:00:22,330
with<font color="#E5E5E5"> Palo Alto</font><font color="#CCCCCC"> is unit 42</font><font color="#E5E5E5"> and has spent</font>

8
00:00:19,990 --> 00:00:24,250
the last<font color="#CCCCCC"> 10 years</font><font color="#E5E5E5"> focusing on malware</font>

9
00:00:22,330 --> 00:00:27,070
analysis<font color="#CCCCCC"> reverse</font><font color="#E5E5E5"> engineering and</font>

10
00:00:24,250 --> 00:00:29,439
tracking threat actors primarily<font color="#E5E5E5"> those</font>

11
00:00:27,070 --> 00:00:31,570
associated<font color="#CCCCCC"> with cyber espionage and</font>

12
00:00:29,439 --> 00:00:33,520
targeted attacks he's also worked as a

13
00:00:31,570 --> 00:00:35,680
security<font color="#CCCCCC"> engineer within</font><font color="#E5E5E5"> an operation</font>

14
00:00:33,520 --> 00:00:37,870
<font color="#E5E5E5">center for a managed security service</font>

15
00:00:35,680 --> 00:00:38,500
<font color="#E5E5E5">focused on intrusion detection and</font>

16
00:00:37,870 --> 00:00:46,718
<font color="#CCCCCC">prevention</font>

17
00:00:38,500 --> 00:00:53,710
please welcome Robert Falcone thank you

18
00:00:46,719 --> 00:00:54,969
everyone<font color="#CCCCCC"> so thank you rich for that</font>

19
00:00:53,710 --> 00:00:56,350
introduction<font color="#CCCCCC"> I'm not gonna really</font>

20
00:00:54,969 --> 00:00:58,780
introduce myself because I was a you

21
00:00:56,350 --> 00:01:01,090
know<font color="#E5E5E5"> pretty decent job</font><font color="#CCCCCC"> what I do</font><font color="#E5E5E5"> want to</font>

22
00:00:58,780 --> 00:01:03,609
say is that I'm a threat researcher<font color="#E5E5E5"> okay</font>

23
00:01:01,090 --> 00:01:05,410
so I'm<font color="#E5E5E5"> gonna be</font><font color="#CCCCCC"> talking about a specific</font>

24
00:01:03,609 --> 00:01:07,900
<font color="#E5E5E5">threat that we've been researching for a</font>

25
00:01:05,410 --> 00:01:11,439
while now called sofa<font color="#E5E5E5"> C and I'm gonna</font>

26
00:01:07,900 --> 00:01:12,640
<font color="#E5E5E5">talk</font><font color="#CCCCCC"> about how we're using attack when</font>

27
00:01:11,439 --> 00:01:16,600
we're doing<font color="#E5E5E5"> this kind of threat research</font>

28
00:01:12,640 --> 00:01:18,340
<font color="#E5E5E5">and specifically with one of the one</font><font color="#CCCCCC"> of</font>

29
00:01:16,600 --> 00:01:19,899
<font color="#E5E5E5">the concepts</font><font color="#CCCCCC"> we're starting to</font><font color="#E5E5E5"> really</font>

30
00:01:18,340 --> 00:01:23,140
focus<font color="#E5E5E5"> our attention on and that's</font>

31
00:01:19,900 --> 00:01:24,759
adversary<font color="#E5E5E5"> playbooks</font><font color="#CCCCCC"> okay so I'm gonna</font>

32
00:01:23,140 --> 00:01:27,250
<font color="#E5E5E5">start off talking about adversary</font>

33
00:01:24,759 --> 00:01:29,140
playbooks the concept<font color="#E5E5E5"> behind it and I'm</font>

34
00:01:27,250 --> 00:01:31,390
gonna start off<font color="#CCCCCC"> by asking probably the</font>

35
00:01:29,140 --> 00:01:35,560
most important question<font color="#CCCCCC"> of this entire</font>

36
00:01:31,390 --> 00:01:39,790
conference<font color="#E5E5E5"> and it's uh did anyone back</font>

37
00:01:35,560 --> 00:01:42,040
<font color="#E5E5E5">you know late 8990</font><font color="#CCCCCC"> play Nintendo and you</font>

38
00:01:39,790 --> 00:01:43,390
wouldn't<font color="#E5E5E5"> know what this game is wow</font>

39
00:01:42,040 --> 00:01:44,890
that's a pretty<font color="#CCCCCC"> decent amount of folks</font>

40
00:01:43,390 --> 00:01:47,219
<font color="#CCCCCC">okay so for the</font><font color="#E5E5E5"> folks that don't know</font>

41
00:01:44,890 --> 00:01:49,600
<font color="#E5E5E5">what this game is this is what's ahead</font>

42
00:01:47,219 --> 00:01:51,969
<font color="#CCCCCC">okay yeah I</font><font color="#E5E5E5"> know right</font><font color="#CCCCCC"> in the right</font>

43
00:01:49,600 --> 00:01:54,158
right country American football<font color="#CCCCCC"> so this</font>

44
00:01:51,969 --> 00:01:56,229
is for<font color="#E5E5E5"> those that don't</font><font color="#CCCCCC"> know this is</font>

45
00:01:54,159 --> 00:01:58,659
<font color="#E5E5E5">Tecmo Bowl it's a football game from</font>

46
00:01:56,229 --> 00:02:01,360
<font color="#E5E5E5">Nintendo</font><font color="#CCCCCC"> and I think there was a</font><font color="#E5E5E5"> Super</font>

47
00:01:58,659 --> 00:02:04,719
<font color="#E5E5E5">Nintendo version but the idea was there</font>

48
00:02:01,360 --> 00:02:06,219
were<font color="#E5E5E5"> two players here and one player was</font>

49
00:02:04,719 --> 00:02:07,960
on offense and one player was<font color="#E5E5E5"> on defense</font>

50
00:02:06,219 --> 00:02:11,049
and the offense would try<font color="#E5E5E5"> to choose a</font>

51
00:02:07,960 --> 00:02:12,670
play from<font color="#CCCCCC"> a screen like this and it</font>

52
00:02:11,050 --> 00:02:15,070
would<font color="#E5E5E5"> be</font><font color="#CCCCCC"> like a run</font><font color="#E5E5E5"> play or pass play or</font>

53
00:02:12,670 --> 00:02:17,920
whatever<font color="#E5E5E5"> and the</font><font color="#CCCCCC"> defense would try to</font>

54
00:02:15,070 --> 00:02:18,280
<font color="#CCCCCC">pick</font><font color="#E5E5E5"> that same play okay and if the</font>

55
00:02:17,920 --> 00:02:20,470
defense

56
00:02:18,280 --> 00:02:22,709
<font color="#E5E5E5">pick the same play they</font><font color="#CCCCCC"> overwhelmed the</font>

57
00:02:20,470 --> 00:02:26,230
offense and<font color="#E5E5E5"> just dominated them okay</font>

58
00:02:22,709 --> 00:02:27,970
<font color="#E5E5E5">just like this so even</font><font color="#CCCCCC"> though this</font><font color="#E5E5E5"> is</font>

59
00:02:26,230 --> 00:02:29,799
<font color="#E5E5E5">you know Bo Jackson about to get the</font>

60
00:02:27,970 --> 00:02:32,560
ball he gets crushed<font color="#CCCCCC"> he's not</font><font color="#E5E5E5"> able to</font>

61
00:02:29,800 --> 00:02:34,450
<font color="#E5E5E5">get you know anywhere and I'm using this</font>

62
00:02:32,560 --> 00:02:37,360
metaphor in this<font color="#E5E5E5"> analogy because that's</font>

63
00:02:34,450 --> 00:02:39,730
where we want to<font color="#E5E5E5"> be from you</font><font color="#CCCCCC"> four by</font>

64
00:02:37,360 --> 00:02:41,560
using<font color="#CCCCCC"> absolute play books if you know</font>

65
00:02:39,730 --> 00:02:44,500
what<font color="#CCCCCC"> at what play the adversary is gonna</font>

66
00:02:41,560 --> 00:02:45,819
run to<font color="#E5E5E5"> his attack an organization you're</font>

67
00:02:44,500 --> 00:02:46,870
gonna have a much better chance<font color="#CCCCCC"> of</font>

68
00:02:45,819 --> 00:02:49,839
<font color="#E5E5E5">defending against it</font>

69
00:02:46,870 --> 00:02:52,450
so<font color="#CCCCCC"> let's you</font><font color="#E5E5E5"> know get away</font><font color="#CCCCCC"> from Tecmo</font>

70
00:02:49,840 --> 00:02:54,970
<font color="#CCCCCC">Bowl for a little bit let's talk about</font>

71
00:02:52,450 --> 00:02:57,670
how we've decided to<font color="#CCCCCC"> approach this</font>

72
00:02:54,970 --> 00:02:59,530
problem<font color="#CCCCCC"> and to make this no</font><font color="#E5E5E5"> longer</font>

73
00:02:57,670 --> 00:03:02,470
concept but actually put it into<font color="#CCCCCC"> reality</font>

74
00:02:59,530 --> 00:03:05,110
and put it into our workflows as threat

75
00:03:02,470 --> 00:03:07,140
researchers so we started<font color="#E5E5E5"> off with the</font>

76
00:03:05,110 --> 00:03:10,840
attack lifecycle just because that's how

77
00:03:07,140 --> 00:03:12,100
as researchers<font color="#CCCCCC"> we are focusing on how an</font>

78
00:03:10,840 --> 00:03:14,620
adversary is gonna carry out their

79
00:03:12,100 --> 00:03:16,299
attack and it's just a<font color="#CCCCCC"> face based</font>

80
00:03:14,620 --> 00:03:19,030
approach you may notice<font color="#CCCCCC"> a lucky</font><font color="#E5E5E5"> kill</font>

81
00:03:16,300 --> 00:03:20,739
chain or you<font color="#E5E5E5"> know whatever</font><font color="#CCCCCC"> but again</font>

82
00:03:19,030 --> 00:03:23,410
it's just<font color="#E5E5E5"> a phase based approach and</font>

83
00:03:20,739 --> 00:03:30,040
what we did was we<font color="#CCCCCC"> wanted to</font><font color="#E5E5E5"> use the</font>

84
00:03:23,410 --> 00:03:33,730
attack the attack framework to to be

85
00:03:30,040 --> 00:03:34,929
able<font color="#E5E5E5"> to identify</font><font color="#CCCCCC"> the activities that an</font>

86
00:03:33,730 --> 00:03:37,298
adversary is gonna have<font color="#E5E5E5"> to take in each</font>

87
00:03:34,930 --> 00:03:38,380
<font color="#E5E5E5">one of these phases</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> we wanted to be</font>

88
00:03:37,299 --> 00:03:40,480
able<font color="#E5E5E5"> to share this with</font><font color="#CCCCCC"> the community</font>

89
00:03:38,380 --> 00:03:42,280
<font color="#CCCCCC">because that's a big</font><font color="#E5E5E5"> part of unit 42 is</font>

90
00:03:40,480 --> 00:03:44,590
that we want<font color="#CCCCCC"> to</font><font color="#E5E5E5"> share the intelligence</font>

91
00:03:42,280 --> 00:03:46,600
and with the you<font color="#E5E5E5"> know the the</font>

92
00:03:44,590 --> 00:03:48,820
communities for<font color="#CCCCCC"> a greater</font><font color="#E5E5E5"> good so we</font>

93
00:03:46,600 --> 00:03:50,920
ended up<font color="#CCCCCC"> fusion using sticks</font><font color="#E5E5E5"> to version</font>

94
00:03:48,820 --> 00:03:53,459
<font color="#CCCCCC">two to be</font><font color="#E5E5E5"> able</font><font color="#CCCCCC"> to you</font><font color="#E5E5E5"> know create</font>

95
00:03:50,920 --> 00:03:56,108
objects for each one<font color="#E5E5E5"> of these of these</font>

96
00:03:53,459 --> 00:03:59,769
attack techniques and be<font color="#E5E5E5"> able to apply</font>

97
00:03:56,109 --> 00:04:00,760
it to<font color="#E5E5E5"> the</font><font color="#CCCCCC"> killer chain</font><font color="#E5E5E5"> okay so you guys</font>

98
00:03:59,769 --> 00:04:02,410
<font color="#E5E5E5">probably</font><font color="#CCCCCC"> recognize this we've been</font>

99
00:04:00,760 --> 00:04:04,630
<font color="#CCCCCC">talking about</font><font color="#E5E5E5"> it for two days so I'm not</font>

100
00:04:02,410 --> 00:04:07,390
<font color="#E5E5E5">gonna talk</font><font color="#CCCCCC"> about</font><font color="#E5E5E5"> it much but I</font><font color="#CCCCCC"> just want</font>

101
00:04:04,630 --> 00:04:09,250
<font color="#E5E5E5">to take this time to thank the folks at</font>

102
00:04:07,390 --> 00:04:11,950
<font color="#E5E5E5">mitre that worked on attack and all the</font>

103
00:04:09,250 --> 00:04:14,290
contributors<font color="#CCCCCC"> cuz this</font><font color="#E5E5E5"> saved that without</font>

104
00:04:11,950 --> 00:04:15,700
without this<font color="#CCCCCC"> framework the playbook</font>

105
00:04:14,290 --> 00:04:17,349
concept<font color="#E5E5E5"> would never have gotten off</font><font color="#CCCCCC"> the</font>

106
00:04:15,700 --> 00:04:22,479
<font color="#CCCCCC">ground so thanks everyone I appreciate</font>

107
00:04:17,350 --> 00:04:25,930
that<font color="#CCCCCC"> so I mentioned that</font><font color="#E5E5E5"> we're using</font>

108
00:04:22,479 --> 00:04:27,849
sticks for to be able<font color="#E5E5E5"> to disseminate</font>

109
00:04:25,930 --> 00:04:29,320
<font color="#E5E5E5">these these play books and disseminate</font>

110
00:04:27,849 --> 00:04:31,330
<font color="#E5E5E5">this intelligence out with the community</font>

111
00:04:29,320 --> 00:04:32,260
<font color="#E5E5E5">and I mentioned that we're specifically</font>

112
00:04:31,330 --> 00:04:35,469
using

113
00:04:32,260 --> 00:04:37,450
- and there's one main reason<font color="#CCCCCC"> for</font><font color="#E5E5E5"> that</font>

114
00:04:35,470 --> 00:04:39,490
we<font color="#E5E5E5"> chose version</font><font color="#CCCCCC"> 2</font><font color="#E5E5E5"> it's the latest and</font>

115
00:04:37,450 --> 00:04:41,740
<font color="#CCCCCC">greatest</font><font color="#E5E5E5"> but</font><font color="#CCCCCC"> it's also in JSON format</font>

116
00:04:39,490 --> 00:04:44,080
which is<font color="#E5E5E5"> really really helpful</font><font color="#CCCCCC"> because</font>

117
00:04:41,740 --> 00:04:47,830
<font color="#E5E5E5">we don't have to parse XML anymore</font><font color="#CCCCCC"> we're</font>

118
00:04:44,080 --> 00:04:50,109
gonna start<font color="#E5E5E5"> using JSON JSON objects to</font>

119
00:04:47,830 --> 00:04:52,419
be able<font color="#E5E5E5"> to</font><font color="#CCCCCC"> identify the entities within</font>

120
00:04:50,110 --> 00:04:54,550
<font color="#E5E5E5">these</font><font color="#CCCCCC"> playbooks</font><font color="#E5E5E5"> and one of the other</font>

121
00:04:52,420 --> 00:04:57,160
<font color="#E5E5E5">really important parts about</font><font color="#CCCCCC"> Stix - is</font>

122
00:04:54,550 --> 00:04:59,620
that you can relate any entities

123
00:04:57,160 --> 00:05:03,160
<font color="#CCCCCC">together</font><font color="#E5E5E5"> or other JSON objects together</font>

124
00:04:59,620 --> 00:05:04,750
<font color="#E5E5E5">using a relationship object and this is</font>

125
00:05:03,160 --> 00:05:06,250
actually<font color="#E5E5E5"> really important because this</font>

126
00:05:04,750 --> 00:05:08,260
allows us<font color="#CCCCCC"> to</font><font color="#E5E5E5"> kind of bind things</font>

127
00:05:06,250 --> 00:05:11,650
together<font color="#E5E5E5"> to actually be able to</font><font color="#CCCCCC"> create</font>

128
00:05:08,260 --> 00:05:13,810
these plays<font color="#CCCCCC"> and play books okay</font><font color="#E5E5E5"> so how</font>

129
00:05:11,650 --> 00:05:15,849
did we<font color="#E5E5E5"> approach this well like I said we</font>

130
00:05:13,810 --> 00:05:19,210
took the attack lifecycle where we took

131
00:05:15,850 --> 00:05:21,040
the attack framework and<font color="#CCCCCC"> pre-attack and</font>

132
00:05:19,210 --> 00:05:22,870
<font color="#CCCCCC">sticks</font><font color="#E5E5E5"> version</font><font color="#CCCCCC"> two</font><font color="#E5E5E5"> and kind of threw</font><font color="#CCCCCC"> it</font>

133
00:05:21,040 --> 00:05:25,060
in a blender just<font color="#E5E5E5"> to see what we could</font>

134
00:05:22,870 --> 00:05:26,740
<font color="#E5E5E5">come</font><font color="#CCCCCC"> up with</font><font color="#E5E5E5"> at</font><font color="#CCCCCC"> first and I think it</font>

135
00:05:25,060 --> 00:05:28,620
<font color="#CCCCCC">actually worked</font><font color="#E5E5E5"> because we're starting</font>

136
00:05:26,740 --> 00:05:32,530
<font color="#CCCCCC">to be able</font><font color="#E5E5E5"> to create these play books</font>

137
00:05:28,620 --> 00:05:35,410
<font color="#E5E5E5">during</font><font color="#CCCCCC"> our research efforts so</font><font color="#E5E5E5"> here's</font>

138
00:05:32,530 --> 00:05:38,109
how<font color="#E5E5E5"> we actually looked at the</font><font color="#CCCCCC"> play book</font>

139
00:05:35,410 --> 00:05:39,970
concept<font color="#E5E5E5"> so at the top here we have</font><font color="#CCCCCC"> an</font>

140
00:05:38,110 --> 00:05:41,890
adversary or intrusion<font color="#CCCCCC"> center</font><font color="#E5E5E5"> whatever</font>

141
00:05:39,970 --> 00:05:43,990
<font color="#CCCCCC">you want to call it</font><font color="#E5E5E5"> and underneath that</font>

142
00:05:41,890 --> 00:05:46,690
<font color="#E5E5E5">they're carrying out attack campaigns</font>

143
00:05:43,990 --> 00:05:48,670
right and<font color="#E5E5E5"> each one of those campaigns</font>

144
00:05:46,690 --> 00:05:50,560
has a set number<font color="#E5E5E5"> of techniques that</font>

145
00:05:48,670 --> 00:05:52,750
they're<font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> carry out to take you know</font>

146
00:05:50,560 --> 00:05:55,060
<font color="#E5E5E5">carry out that campaign and</font><font color="#CCCCCC"> each one</font><font color="#E5E5E5"> of</font>

147
00:05:52,750 --> 00:05:58,450
those<font color="#E5E5E5"> techniques may have a set amount</font>

148
00:05:55,060 --> 00:06:00,970
of indicators that you can look for and

149
00:05:58,450 --> 00:06:04,420
observe<font color="#CCCCCC"> - to be able</font><font color="#E5E5E5"> to see that</font>

150
00:06:00,970 --> 00:06:06,070
<font color="#E5E5E5">technique happen so in our</font><font color="#CCCCCC"> PlayBook idea</font>

151
00:06:04,420 --> 00:06:09,880
<font color="#E5E5E5">we just kind</font><font color="#CCCCCC"> of replace some of these</font>

152
00:06:06,070 --> 00:06:11,860
words with with these words instead so

153
00:06:09,880 --> 00:06:14,200
at the top we've got the adversary now

154
00:06:11,860 --> 00:06:16,600
being<font color="#E5E5E5"> the playbook because if you</font><font color="#CCCCCC"> think</font>

155
00:06:14,200 --> 00:06:18,670
<font color="#E5E5E5">about it an adversary wouldn't have</font>

156
00:06:16,600 --> 00:06:20,440
multiple play books<font color="#E5E5E5"> if we</font><font color="#CCCCCC"> continued that</font>

157
00:06:18,670 --> 00:06:21,940
<font color="#E5E5E5">analogy with</font><font color="#CCCCCC"> the football team a</font>

158
00:06:20,440 --> 00:06:23,650
football team wouldn't have multiple

159
00:06:21,940 --> 00:06:25,300
play books<font color="#E5E5E5"> that doesn't really make</font>

160
00:06:23,650 --> 00:06:27,340
sense<font color="#CCCCCC"> they would just</font><font color="#E5E5E5"> have multiple</font>

161
00:06:25,300 --> 00:06:30,550
pages of<font color="#E5E5E5"> plays within that playbook</font>

162
00:06:27,340 --> 00:06:33,909
that's why<font color="#E5E5E5"> campaigns themselves are</font><font color="#CCCCCC"> our</font>

163
00:06:30,550 --> 00:06:34,570
plays getting back<font color="#E5E5E5"> to the techniques</font>

164
00:06:33,910 --> 00:06:36,190
<font color="#CCCCCC">themselves</font>

165
00:06:34,570 --> 00:06:37,810
we just mapped like I said we use the

166
00:06:36,190 --> 00:06:40,060
attack framework we just made<font color="#E5E5E5"> that</font>

167
00:06:37,810 --> 00:06:42,250
mapping very easily<font color="#E5E5E5"> and indicators</font>

168
00:06:40,060 --> 00:06:44,260
themselves<font color="#CCCCCC"> are just sticks version to</font>

169
00:06:42,250 --> 00:06:45,310
indicators which<font color="#E5E5E5"> are just indicator</font>

170
00:06:44,260 --> 00:06:47,590
patterns that

171
00:06:45,310 --> 00:06:49,960
what<font color="#E5E5E5"> what</font><font color="#CCCCCC"> we're</font><font color="#E5E5E5"> able</font><font color="#CCCCCC"> to do</font><font color="#E5E5E5"> now is we're</font>

172
00:06:47,590 --> 00:06:51,460
able to use six relationships<font color="#E5E5E5"> to be able</font>

173
00:06:49,960 --> 00:06:55,560
<font color="#E5E5E5">to bind all those together make those</font>

174
00:06:51,460 --> 00:06:58,299
relationships<font color="#E5E5E5"> between</font><font color="#CCCCCC"> sticks indicators</font>

175
00:06:55,560 --> 00:07:00,790
<font color="#E5E5E5">observables to the actual techniques</font>

176
00:06:58,300 --> 00:07:03,730
that you can<font color="#E5E5E5"> you know identify with</font><font color="#CCCCCC"> that</font>

177
00:07:00,790 --> 00:07:06,370
with that indicator<font color="#E5E5E5"> and be able to</font>

178
00:07:03,730 --> 00:07:09,520
relate all<font color="#E5E5E5"> these things together from</font>

179
00:07:06,370 --> 00:07:12,310
<font color="#E5E5E5">there we use another</font><font color="#CCCCCC"> Stix</font><font color="#E5E5E5"> object called</font>

180
00:07:09,520 --> 00:07:15,909
<font color="#E5E5E5">a bundle</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> bundle of sticks right I</font>

181
00:07:12,310 --> 00:07:17,230
think<font color="#CCCCCC"> that was a sticks joke</font><font color="#E5E5E5"> but so what</font>

182
00:07:15,910 --> 00:07:19,330
that what we were able to<font color="#E5E5E5"> do with the</font>

183
00:07:17,230 --> 00:07:21,730
sticks bundle<font color="#E5E5E5"> is we were able to take</font>

184
00:07:19,330 --> 00:07:23,740
all<font color="#E5E5E5"> these JSON objects that are related</font>

185
00:07:21,730 --> 00:07:25,330
to<font color="#E5E5E5"> a play a</font><font color="#CCCCCC"> playbook the attack</font>

186
00:07:23,740 --> 00:07:27,460
techniques that were used in<font color="#CCCCCC"> that play</font>

187
00:07:25,330 --> 00:07:29,830
<font color="#E5E5E5">and all the indicators</font><font color="#CCCCCC"> and we're able</font><font color="#E5E5E5"> to</font>

188
00:07:27,460 --> 00:07:31,599
put them in one<font color="#E5E5E5"> object to be easily to</font>

189
00:07:29,830 --> 00:07:34,030
<font color="#E5E5E5">be shared with the community</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> could</font>

190
00:07:31,600 --> 00:07:38,530
just<font color="#E5E5E5"> create one object</font><font color="#CCCCCC"> and share it out</font>

191
00:07:34,030 --> 00:07:40,840
as one giant JSON object<font color="#CCCCCC"> okay so I</font>

192
00:07:38,530 --> 00:07:44,169
mentioned<font color="#CCCCCC"> that</font><font color="#E5E5E5"> we had</font><font color="#CCCCCC"> we were using</font>

193
00:07:40,840 --> 00:07:46,960
sticks sticks version<font color="#CCCCCC"> two but we're also</font>

194
00:07:44,170 --> 00:07:49,150
<font color="#E5E5E5">mapping the attack techniques to the</font>

195
00:07:46,960 --> 00:07:51,940
kill chain and I wanted<font color="#E5E5E5"> to</font><font color="#CCCCCC"> provide a</font>

196
00:07:49,150 --> 00:07:54,370
<font color="#E5E5E5">quick mapping of how that works</font><font color="#CCCCCC"> we just</font>

197
00:07:51,940 --> 00:07:58,660
did it<font color="#E5E5E5"> really you know</font><font color="#CCCCCC"> very</font><font color="#E5E5E5"> simple very</font>

198
00:07:54,370 --> 00:08:00,730
<font color="#E5E5E5">dirty kind of attack tactic to kill</font>

199
00:07:58,660 --> 00:08:03,640
chain<font color="#E5E5E5"> kind of mapping</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> it kind of</font>

200
00:08:00,730 --> 00:08:05,050
worked out okay for<font color="#E5E5E5"> the most part if you</font>

201
00:08:03,640 --> 00:08:07,840
<font color="#E5E5E5">probably can't read all of these but</font>

202
00:08:05,050 --> 00:08:10,240
<font color="#CCCCCC">some of them there fall into multiple</font>

203
00:08:07,840 --> 00:08:13,270
phases<font color="#E5E5E5"> specifically I think</font><font color="#CCCCCC"> its</font>

204
00:08:10,240 --> 00:08:15,750
execution<font color="#CCCCCC"> has some techniques that</font>

205
00:08:13,270 --> 00:08:19,659
really belong<font color="#CCCCCC"> in the</font><font color="#E5E5E5"> exploitation phase</font>

206
00:08:15,750 --> 00:08:21,930
<font color="#CCCCCC">so we had to kind</font><font color="#E5E5E5"> of make</font><font color="#CCCCCC"> decisions on</font>

207
00:08:19,660 --> 00:08:24,760
where<font color="#E5E5E5"> these where these techniques</font>

208
00:08:21,930 --> 00:08:27,370
actually fell in the kill<font color="#E5E5E5"> chain and</font>

209
00:08:24,760 --> 00:08:29,710
luckily because<font color="#E5E5E5"> we use sticks</font><font color="#CCCCCC"> - these</font>

210
00:08:27,370 --> 00:08:31,870
are all JSON objects we<font color="#E5E5E5"> can manipulate</font>

211
00:08:29,710 --> 00:08:34,179
them<font color="#CCCCCC"> a little bit like right here</font><font color="#E5E5E5"> you</font>

212
00:08:31,870 --> 00:08:38,169
can see<font color="#E5E5E5"> we're</font><font color="#CCCCCC"> able to assign not only</font>

213
00:08:34,179 --> 00:08:41,130
the the kill chain name for the attack

214
00:08:38,169 --> 00:08:44,680
tactic<font color="#E5E5E5"> well you can also change which</font>

215
00:08:41,130 --> 00:08:46,780
which phase on<font color="#CCCCCC"> the Lockheed</font><font color="#E5E5E5"> Joe chain it</font>

216
00:08:44,680 --> 00:08:49,810
actually belongs<font color="#E5E5E5"> and you'll see this</font>

217
00:08:46,780 --> 00:08:54,280
when<font color="#E5E5E5"> I show you our viewer why this is</font>

218
00:08:49,810 --> 00:08:56,640
important<font color="#E5E5E5"> okay</font><font color="#CCCCCC"> so this</font><font color="#E5E5E5"> is a playbook</font>

219
00:08:54,280 --> 00:08:58,370
<font color="#E5E5E5">isn't</font><font color="#CCCCCC"> that doesn't that</font><font color="#E5E5E5"> look great right</font>

220
00:08:56,640 --> 00:09:01,339
humans should never<font color="#E5E5E5"> read</font>

221
00:08:58,370 --> 00:09:03,890
this is the JSON output of<font color="#CCCCCC"> our PlayBook</font>

222
00:09:01,339 --> 00:09:06,380
creator<font color="#E5E5E5"> right I just wanted to emphasize</font>

223
00:09:03,890 --> 00:09:08,240
<font color="#E5E5E5">this is really good if you're a machine</font>

224
00:09:06,380 --> 00:09:11,750
<font color="#E5E5E5">and need to parse this really quickly</font>

225
00:09:08,240 --> 00:09:13,790
<font color="#E5E5E5">because they're all</font><font color="#CCCCCC"> really concise JSON</font>

226
00:09:11,750 --> 00:09:16,910
objects really<font color="#E5E5E5"> easy to consume from a</font>

227
00:09:13,790 --> 00:09:18,319
machine standpoint<font color="#CCCCCC"> I also</font><font color="#E5E5E5"> mentioned a</font>

228
00:09:16,910 --> 00:09:20,569
<font color="#E5E5E5">human</font><font color="#CCCCCC"> shouldn't read</font><font color="#E5E5E5"> this we actually</font>

229
00:09:18,320 --> 00:09:23,240
<font color="#E5E5E5">created a viewer that will parse all</font>

230
00:09:20,570 --> 00:09:24,890
<font color="#E5E5E5">this for you and actually make</font><font color="#CCCCCC"> it so</font><font color="#E5E5E5"> you</font>

231
00:09:23,240 --> 00:09:28,520
know your eyes<font color="#E5E5E5"> don't bleed and I'll show</font>

232
00:09:24,890 --> 00:09:29,569
you<font color="#E5E5E5"> that</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> little</font><font color="#E5E5E5"> bit okay so what</font>

233
00:09:28,520 --> 00:09:31,520
I'm<font color="#E5E5E5"> going to do now is I'm going</font><font color="#CCCCCC"> to talk</font>

234
00:09:29,570 --> 00:09:34,250
about<font color="#CCCCCC"> a specific thread actor called</font>

235
00:09:31,520 --> 00:09:36,829
sofa<font color="#E5E5E5"> see I think someone touched on on</font>

236
00:09:34,250 --> 00:09:39,140
this threat<font color="#E5E5E5"> group earlier in the at the</font>

237
00:09:36,830 --> 00:09:41,360
conference<font color="#CCCCCC"> but I want to talk about</font><font color="#E5E5E5"> this</font>

238
00:09:39,140 --> 00:09:43,550
<font color="#CCCCCC">specific threat</font><font color="#E5E5E5"> and use this threat as</font>

239
00:09:41,360 --> 00:09:46,580
an example<font color="#CCCCCC"> of how</font><font color="#E5E5E5"> we're how we're</font>

240
00:09:43,550 --> 00:09:50,150
building<font color="#CCCCCC"> these plays and</font><font color="#E5E5E5"> playbooks</font><font color="#CCCCCC"> is</font>

241
00:09:46,580 --> 00:09:52,430
for their campaigns<font color="#CCCCCC"> so let's jump off</font>

242
00:09:50,150 --> 00:09:54,410
<font color="#E5E5E5">into some of the activity that we saw</font>

243
00:09:52,430 --> 00:09:56,529
this<font color="#E5E5E5"> thread actor carrying out in early</font>

244
00:09:54,410 --> 00:09:59,420
<font color="#E5E5E5">2018</font>

245
00:09:56,529 --> 00:10:01,640
<font color="#E5E5E5">starting in January 2018</font><font color="#CCCCCC"> moving the</font>

246
00:09:59,420 --> 00:10:04,790
<font color="#E5E5E5">February</font><font color="#CCCCCC"> you know another attack</font>

247
00:10:01,640 --> 00:10:07,130
campaign in March 2008<font color="#CCCCCC"> eeen I don't have</font>

248
00:10:04,790 --> 00:10:09,020
time to go into<font color="#E5E5E5"> all of these</font><font color="#CCCCCC"> but I want</font>

249
00:10:07,130 --> 00:10:12,589
to focus on one<font color="#E5E5E5"> that occurred of one</font>

250
00:10:09,020 --> 00:10:14,810
campaign in February 2018<font color="#CCCCCC"> that we</font>

251
00:10:12,589 --> 00:10:16,310
internally<font color="#E5E5E5"> call Lucky Strike</font><font color="#CCCCCC"> okay</font>

252
00:10:14,810 --> 00:10:19,670
this was targeting government

253
00:10:16,310 --> 00:10:22,790
<font color="#CCCCCC">organizations in the EU and</font><font color="#E5E5E5"> in the with</font>

254
00:10:19,670 --> 00:10:23,240
America<font color="#E5E5E5"> okay so that we call it Lucky</font>

255
00:10:22,790 --> 00:10:25,880
<font color="#E5E5E5">Strike</font>

256
00:10:23,240 --> 00:10:28,550
internally<font color="#E5E5E5"> because of the tool that</font><font color="#CCCCCC"> they</font>

257
00:10:25,880 --> 00:10:30,140
use<font color="#E5E5E5"> to create the delivery document</font><font color="#CCCCCC"> okay</font>

258
00:10:28,550 --> 00:10:31,160
so what I'm<font color="#CCCCCC"> going to do now is I'm going</font>

259
00:10:30,140 --> 00:10:33,470
to<font color="#E5E5E5"> go through each</font><font color="#CCCCCC"> one of</font><font color="#E5E5E5"> those</font>

260
00:10:31,160 --> 00:10:35,120
operational<font color="#E5E5E5"> phases and what the</font>

261
00:10:33,470 --> 00:10:37,730
adversary actually did in each of those

262
00:10:35,120 --> 00:10:40,130
phases<font color="#CCCCCC"> so then</font><font color="#E5E5E5"> afterwards we can</font>

263
00:10:37,730 --> 00:10:42,170
actually<font color="#E5E5E5"> build a play using the attack</font>

264
00:10:40,130 --> 00:10:46,339
framework<font color="#E5E5E5"> okay so start in the</font>

265
00:10:42,170 --> 00:10:48,529
weaponization phase<font color="#E5E5E5"> like I</font><font color="#CCCCCC"> said this</font>

266
00:10:46,339 --> 00:10:50,240
group used the this this tool<font color="#E5E5E5"> called</font>

267
00:10:48,529 --> 00:10:51,740
Lucky Strike<font color="#E5E5E5"> I'm not sure if you guys</font>

268
00:10:50,240 --> 00:10:54,110
have heard<font color="#E5E5E5"> of it but it's an</font><font color="#CCCCCC"> open-source</font>

269
00:10:51,740 --> 00:10:56,720
<font color="#CCCCCC">tool</font><font color="#E5E5E5"> it's freely available on github</font><font color="#CCCCCC"> and</font>

270
00:10:54,110 --> 00:10:59,420
what it does is it takes<font color="#E5E5E5"> an Excel</font>

271
00:10:56,720 --> 00:11:01,070
spreadsheet<font color="#E5E5E5"> and adds a macro to it and</font>

272
00:10:59,420 --> 00:11:05,060
embeds a payload<font color="#CCCCCC"> to it of your choice</font>

273
00:11:01,070 --> 00:11:07,970
and in outputs another weaponized<font color="#CCCCCC"> excel</font>

274
00:11:05,060 --> 00:11:10,219
document pretty straightforward<font color="#CCCCCC"> okay</font>

275
00:11:07,970 --> 00:11:11,340
so this group used that to generate

276
00:11:10,220 --> 00:11:13,470
their delivery document

277
00:11:11,340 --> 00:11:15,720
that then they deliver via<font color="#E5E5E5"> spearfishing</font>

278
00:11:13,470 --> 00:11:17,580
<font color="#E5E5E5">email as an attachment and this is what</font>

279
00:11:15,720 --> 00:11:19,560
the<font color="#E5E5E5"> email looked like and the</font>

280
00:11:17,580 --> 00:11:22,410
interesting part<font color="#E5E5E5"> about this is the</font>

281
00:11:19,560 --> 00:11:25,560
delivery email itself<font color="#E5E5E5"> spoofed</font><font color="#CCCCCC"> a very</font>

282
00:11:22,410 --> 00:11:28,140
well-known<font color="#E5E5E5"> organization in in several</font>

283
00:11:25,560 --> 00:11:30,089
<font color="#CCCCCC">different industries and you know the</font>

284
00:11:28,140 --> 00:11:32,370
actual content of the of the email was

285
00:11:30,090 --> 00:11:35,430
<font color="#CCCCCC">you know</font><font color="#E5E5E5"> written</font><font color="#CCCCCC"> really</font><font color="#E5E5E5"> well really</font>

286
00:11:32,370 --> 00:11:37,920
decent<font color="#CCCCCC"> Spearfish here let's move into</font>

287
00:11:35,430 --> 00:11:39,479
the<font color="#E5E5E5"> exploitation phase</font><font color="#CCCCCC"> let's</font><font color="#E5E5E5"> look back</font>

288
00:11:37,920 --> 00:11:41,610
at<font color="#E5E5E5"> that delivery email you can actually</font>

289
00:11:39,480 --> 00:11:44,370
<font color="#E5E5E5">see there's a spreadsheet attached to it</font>

290
00:11:41,610 --> 00:11:46,230
<font color="#E5E5E5">and I drew a box around this</font><font color="#CCCCCC"> this part</font>

291
00:11:44,370 --> 00:11:48,060
<font color="#CCCCCC">of the email it says note if you're</font>

292
00:11:46,230 --> 00:11:49,860
having trouble viewing the<font color="#CCCCCC"> document you</font>

293
00:11:48,060 --> 00:11:52,979
can try to enable<font color="#E5E5E5"> content to resolve the</font>

294
00:11:49,860 --> 00:11:55,110
issue now<font color="#E5E5E5"> many of you may know macros</font>

295
00:11:52,980 --> 00:11:57,270
are not automatically run in in

296
00:11:55,110 --> 00:11:58,590
Microsoft<font color="#E5E5E5"> Office products you actually</font>

297
00:11:57,270 --> 00:12:00,780
have to click<font color="#E5E5E5"> the enable content</font><font color="#CCCCCC"> button</font>

298
00:11:58,590 --> 00:12:03,420
to<font color="#E5E5E5"> run it this is just</font><font color="#CCCCCC"> giving you a hey</font>

299
00:12:00,780 --> 00:12:05,160
if you can't see the<font color="#E5E5E5"> the contents of the</font>

300
00:12:03,420 --> 00:12:07,439
of the document<font color="#E5E5E5"> try clicking enable</font>

301
00:12:05,160 --> 00:12:12,030
<font color="#E5E5E5">content</font><font color="#CCCCCC"> it may it may you know fix it</font>

302
00:12:07,440 --> 00:12:14,670
<font color="#E5E5E5">well guess what it does so when you</font>

303
00:12:12,030 --> 00:12:16,860
first open<font color="#CCCCCC"> it it looks like</font><font color="#E5E5E5"> this all no</font>

304
00:12:14,670 --> 00:12:18,420
<font color="#E5E5E5">content in it well once you put the</font>

305
00:12:16,860 --> 00:12:20,280
enable<font color="#CCCCCC"> content button all of a</font><font color="#E5E5E5"> sudden</font>

306
00:12:18,420 --> 00:12:23,310
you see the content<font color="#E5E5E5"> so I mean you're</font>

307
00:12:20,280 --> 00:12:25,500
seeing you<font color="#CCCCCC"> know</font><font color="#E5E5E5"> that the email is</font><font color="#CCCCCC"> was</font>

308
00:12:23,310 --> 00:12:27,089
right you you know<font color="#E5E5E5"> now you click the</font>

309
00:12:25,500 --> 00:12:29,160
enable<font color="#CCCCCC"> content button</font><font color="#E5E5E5"> it resolved the</font>

310
00:12:27,090 --> 00:12:31,770
issue everything's<font color="#CCCCCC"> grand right but</font>

311
00:12:29,160 --> 00:12:33,900
<font color="#CCCCCC">unfortunately what you did was you the</font>

312
00:12:31,770 --> 00:12:35,790
<font color="#E5E5E5">macro ran and the first thing it did was</font>

313
00:12:33,900 --> 00:12:38,100
<font color="#CCCCCC">it just changed</font><font color="#E5E5E5"> the color of the text to</font>

314
00:12:35,790 --> 00:12:40,500
<font color="#CCCCCC">black</font><font color="#E5E5E5"> okay so if you're</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> if you were</font>

315
00:12:38,100 --> 00:12:42,030
<font color="#CCCCCC">just to highlight all of those cells it</font>

316
00:12:40,500 --> 00:12:43,500
would<font color="#E5E5E5"> have showed up and because you</font>

317
00:12:42,030 --> 00:12:44,640
would<font color="#CCCCCC"> be able</font><font color="#E5E5E5"> to see it it was just in</font>

318
00:12:43,500 --> 00:12:48,870
white text<font color="#CCCCCC"> okay</font>

319
00:12:44,640 --> 00:12:50,850
however the macro itself<font color="#CCCCCC"> also installed</font>

320
00:12:48,870 --> 00:12:53,190
<font color="#E5E5E5">the</font><font color="#CCCCCC"> trojan and this is that the code</font>

321
00:12:50,850 --> 00:12:56,520
that<font color="#CCCCCC"> would</font><font color="#E5E5E5"> obtain the</font><font color="#CCCCCC"> embedded payload</font>

322
00:12:53,190 --> 00:12:59,430
from within the spreadsheet then<font color="#E5E5E5"> the</font>

323
00:12:56,520 --> 00:13:01,530
macro would take that encoded<font color="#CCCCCC"> data right</font>

324
00:12:59,430 --> 00:13:05,459
<font color="#E5E5E5">into a text file and then use the cert</font>

325
00:13:01,530 --> 00:13:08,250
util decode<font color="#E5E5E5"> application or in this case</font>

326
00:13:05,460 --> 00:13:09,690
the switch<font color="#E5E5E5"> to decode that base64 encoded</font>

327
00:13:08,250 --> 00:13:12,150
data<font color="#E5E5E5"> and</font><font color="#CCCCCC"> write to an executable which</font>

328
00:13:09,690 --> 00:13:13,680
would later in run okay so that's the

329
00:13:12,150 --> 00:13:15,959
installation process that would occur

330
00:13:13,680 --> 00:13:18,510
<font color="#E5E5E5">now the payload</font><font color="#CCCCCC"> that was dropped was</font>

331
00:13:15,960 --> 00:13:21,090
<font color="#CCCCCC">Sofia sees pretty much go to first stage</font>

332
00:13:18,510 --> 00:13:23,189
payload<font color="#E5E5E5"> some folks call it setup loader</font>

333
00:13:21,090 --> 00:13:24,140
we<font color="#CCCCCC"> call it soap see convert but it's</font>

334
00:13:23,190 --> 00:13:28,100
there

335
00:13:24,140 --> 00:13:30,740
their primary go-to for stage payload so

336
00:13:28,100 --> 00:13:34,700
that initial payload in the command

337
00:13:30,740 --> 00:13:36,410
<font color="#CCCCCC">control phase would use HTTP to beacon</font>

338
00:13:34,700 --> 00:13:38,600
at<font color="#CCCCCC"> situ server</font><font color="#E5E5E5"> and it looks</font><font color="#CCCCCC"> like this</font>

339
00:13:36,410 --> 00:13:41,860
<font color="#CCCCCC">well technically</font><font color="#E5E5E5"> it's an HTTP this is</font>

340
00:13:38,600 --> 00:13:44,000
just the HTTP request<font color="#CCCCCC"> that's going out</font>

341
00:13:41,860 --> 00:13:46,190
<font color="#E5E5E5">as you can see it's just an HTTP POST</font>

342
00:13:44,000 --> 00:13:48,589
request to a specific domain<font color="#CCCCCC"> has some</font>

343
00:13:46,190 --> 00:13:51,019
<font color="#CCCCCC">cipher</font><font color="#E5E5E5"> text in it and that's the</font><font color="#CCCCCC"> C Tube</font>

344
00:13:48,589 --> 00:13:53,779
channel let's<font color="#E5E5E5"> move into the objective</font>

345
00:13:51,019 --> 00:13:55,310
<font color="#E5E5E5">phase and I will be honest we we don't</font>

346
00:13:53,779 --> 00:13:56,689
<font color="#CCCCCC">have a</font><font color="#E5E5E5"> complete view</font><font color="#CCCCCC"> of what was going</font>

347
00:13:55,310 --> 00:13:59,300
on here<font color="#E5E5E5"> we didn't see any lateral</font>

348
00:13:56,690 --> 00:14:01,940
movement<font color="#CCCCCC"> because what we found was that</font>

349
00:13:59,300 --> 00:14:04,189
when we took a look<font color="#CCCCCC"> at the the data</font><font color="#E5E5E5"> that</font>

350
00:14:01,940 --> 00:14:06,410
<font color="#E5E5E5">was sent out in</font><font color="#CCCCCC"> the c2</font><font color="#E5E5E5"> it looks like</font>

351
00:14:04,190 --> 00:14:08,320
this<font color="#E5E5E5"> which</font><font color="#CCCCCC"> is encrypted</font>

352
00:14:06,410 --> 00:14:10,850
<font color="#CCCCCC">once you decrypt it you can see</font><font color="#E5E5E5"> initial</font>

353
00:14:08,320 --> 00:14:14,480
<font color="#E5E5E5">local reconnaissance being done you know</font>

354
00:14:10,850 --> 00:14:17,269
running running running processes<font color="#E5E5E5"> it's</font>

355
00:14:14,480 --> 00:14:19,670
checking the hard disk in some of the

356
00:14:17,269 --> 00:14:22,490
NIC information that kind<font color="#CCCCCC"> of</font><font color="#E5E5E5"> stuff</font><font color="#CCCCCC"> also</font>

357
00:14:19,670 --> 00:14:24,890
<font color="#CCCCCC">sending a screenshot that is meant to</font>

358
00:14:22,490 --> 00:14:28,490
<font color="#E5E5E5">filter out you know analysis systems and</font>

359
00:14:24,890 --> 00:14:30,500
<font color="#E5E5E5">that kind of thing</font><font color="#CCCCCC"> okay but what we can</font>

360
00:14:28,490 --> 00:14:32,300
<font color="#E5E5E5">surmise based off of the command handler</font>

361
00:14:30,500 --> 00:14:34,370
of that payload is what they were

362
00:14:32,300 --> 00:14:35,930
<font color="#E5E5E5">actually trying to do this is just like</font>

363
00:14:34,370 --> 00:14:37,970
I said<font color="#CCCCCC"> their first</font><font color="#E5E5E5"> stage payload all</font>

364
00:14:35,930 --> 00:14:39,500
they're trying<font color="#CCCCCC"> to do is to you</font><font color="#E5E5E5"> know do</font>

365
00:14:37,970 --> 00:14:40,850
initial reconnaissance find out if

366
00:14:39,500 --> 00:14:43,579
that's<font color="#CCCCCC"> the system</font><font color="#E5E5E5"> they want to they want</font>

367
00:14:40,850 --> 00:14:46,100
<font color="#E5E5E5">to you</font><font color="#CCCCCC"> know compromise</font><font color="#E5E5E5"> and then</font><font color="#CCCCCC"> they</font>

368
00:14:43,579 --> 00:14:47,540
load additional<font color="#E5E5E5"> tools to be able to</font>

369
00:14:46,100 --> 00:14:49,490
<font color="#E5E5E5">carry out further activities like</font>

370
00:14:47,540 --> 00:14:52,760
<font color="#E5E5E5">lateral movement privilege escalation</font>

371
00:14:49,490 --> 00:14:54,949
<font color="#E5E5E5">that kind of stuff so</font><font color="#CCCCCC"> now we've gone</font><font color="#E5E5E5"> to</font>

372
00:14:52,760 --> 00:14:58,100
that<font color="#E5E5E5"> whole</font><font color="#CCCCCC"> process that was the Lucky</font>

373
00:14:54,949 --> 00:15:00,859
<font color="#CCCCCC">Strike attack you know</font><font color="#E5E5E5"> looking at it</font>

374
00:14:58,100 --> 00:15:03,019
<font color="#E5E5E5">from the kill chain</font><font color="#CCCCCC"> perspective now I</font>

375
00:15:00,860 --> 00:15:05,449
want to<font color="#CCCCCC"> talk use that same attack</font><font color="#E5E5E5"> and</font>

376
00:15:03,019 --> 00:15:08,420
talk about<font color="#E5E5E5"> what how we</font><font color="#CCCCCC"> created a play</font>

377
00:15:05,449 --> 00:15:10,609
<font color="#E5E5E5">for our play books using</font><font color="#CCCCCC"> that</font>

378
00:15:08,420 --> 00:15:12,680
<font color="#CCCCCC">information and I mentioned earlier when</font>

379
00:15:10,610 --> 00:15:15,350
I<font color="#CCCCCC"> showed that</font><font color="#E5E5E5"> JSON that would make you</font>

380
00:15:12,680 --> 00:15:17,359
make your<font color="#E5E5E5"> eyes want to bleed</font><font color="#CCCCCC"> this here</font>

381
00:15:15,350 --> 00:15:19,820
is<font color="#E5E5E5"> the viewer that we created to parse</font>

382
00:15:17,360 --> 00:15:21,140
all that JSON to make it so a human can

383
00:15:19,820 --> 00:15:23,449
actually click<font color="#CCCCCC"> through these these play</font>

384
00:15:21,140 --> 00:15:25,760
books and understand what TTP's are

385
00:15:23,449 --> 00:15:28,699
being used in the in the<font color="#CCCCCC"> life cycle it's</font>

386
00:15:25,760 --> 00:15:30,890
<font color="#E5E5E5">you can access it right on our github</font>

387
00:15:28,699 --> 00:15:32,060
page<font color="#CCCCCC"> there's the</font><font color="#E5E5E5"> link right there</font><font color="#CCCCCC"> so if</font>

388
00:15:30,890 --> 00:15:33,770
you're interested<font color="#CCCCCC"> in kind</font><font color="#E5E5E5"> of playing</font>

389
00:15:32,060 --> 00:15:36,079
around<font color="#E5E5E5"> and looking at looking at the</font>

390
00:15:33,770 --> 00:15:37,699
<font color="#E5E5E5">play books that we have and the</font>

391
00:15:36,079 --> 00:15:39,949
indicators that are associated<font color="#E5E5E5"> with them</font>

392
00:15:37,699 --> 00:15:42,709
<font color="#CCCCCC">you just go right right to our github</font>

393
00:15:39,949 --> 00:15:44,719
<font color="#E5E5E5">also that the raw JSON czar also freely</font>

394
00:15:42,709 --> 00:15:46,160
<font color="#E5E5E5">available on our github as well so you</font>

395
00:15:44,720 --> 00:15:49,880
<font color="#E5E5E5">can do you know whatever you</font><font color="#CCCCCC"> want with</font>

396
00:15:46,160 --> 00:15:52,189
them so let's go<font color="#E5E5E5"> through the same life</font>

397
00:15:49,880 --> 00:15:55,760
<font color="#E5E5E5">cycle phases and kind of highlight which</font>

398
00:15:52,190 --> 00:15:58,310
one of<font color="#E5E5E5"> the attack</font><font color="#CCCCCC"> TTP's that were in</font>

399
00:15:55,760 --> 00:16:00,020
those phases<font color="#CCCCCC"> now I'm not sure</font><font color="#E5E5E5"> if</font>

400
00:15:58,310 --> 00:16:02,180
anyone's still<font color="#CCCCCC"> playing bingo</font><font color="#E5E5E5"> but there's</font>

401
00:16:00,020 --> 00:16:04,370
gonna<font color="#E5E5E5"> be a lot of</font><font color="#CCCCCC"> T attack techniques</font>

402
00:16:02,180 --> 00:16:06,829
here so you may you may win and if<font color="#CCCCCC"> you</font>

403
00:16:04,370 --> 00:16:10,490
win<font color="#E5E5E5"> please shout out because I do have a</font>

404
00:16:06,829 --> 00:16:13,459
prize so<font color="#E5E5E5"> if you win let me know okay so</font>

405
00:16:10,490 --> 00:16:16,520
then recon<font color="#CCCCCC"> we have the identifier</font>

406
00:16:13,459 --> 00:16:18,619
business relationships from pre-attack

407
00:16:16,520 --> 00:16:22,040
and the reason why we have<font color="#E5E5E5"> that there is</font>

408
00:16:18,620 --> 00:16:23,149
because<font color="#E5E5E5"> they the actor clearly was able</font>

409
00:16:22,040 --> 00:16:24,709
to<font color="#E5E5E5"> identify</font><font color="#CCCCCC"> that there was a</font>

410
00:16:23,149 --> 00:16:27,199
<font color="#E5E5E5">relationship between</font><font color="#CCCCCC"> that spoofed</font>

411
00:16:24,709 --> 00:16:30,410
organization and the target the targeted

412
00:16:27,199 --> 00:16:34,010
org<font color="#CCCCCC"> that you know would help them be</font>

413
00:16:30,410 --> 00:16:36,130
successful<font color="#E5E5E5"> in their attack moving on to</font>

414
00:16:34,010 --> 00:16:38,959
the weaponization phase we<font color="#E5E5E5"> have these</font>

415
00:16:36,130 --> 00:16:42,140
techniques here and<font color="#E5E5E5"> I'm just going to</font>

416
00:16:38,959 --> 00:16:43,399
<font color="#CCCCCC">highlight the</font><font color="#E5E5E5"> by domain name in the in</font>

417
00:16:42,140 --> 00:16:45,890
the black text<font color="#E5E5E5"> here you can see its</font>

418
00:16:43,399 --> 00:16:49,430
newly just newly<font color="#E5E5E5"> registered domain that</font>

419
00:16:45,890 --> 00:16:51,439
is our description in in our play for

420
00:16:49,430 --> 00:16:53,420
the reason that technique is<font color="#E5E5E5"> in that</font>

421
00:16:51,440 --> 00:16:55,310
<font color="#E5E5E5">play okay so we're able to provide a</font>

422
00:16:53,420 --> 00:16:58,579
little<font color="#E5E5E5"> bit</font><font color="#CCCCCC"> more insight and for the</font>

423
00:16:55,310 --> 00:17:01,550
<font color="#E5E5E5">viewer why that is there and below</font><font color="#CCCCCC"> that</font>

424
00:16:58,579 --> 00:17:03,620
<font color="#CCCCCC">you can actually see the the</font><font color="#E5E5E5"> indicator</font>

425
00:17:01,550 --> 00:17:06,678
the<font color="#E5E5E5"> sticks version</font><font color="#CCCCCC"> two indicators that</font>

426
00:17:03,620 --> 00:17:09,369
we created<font color="#E5E5E5"> that</font><font color="#CCCCCC"> is nowis is related to</font>

427
00:17:06,679 --> 00:17:11,959
<font color="#E5E5E5">that that attack technique right there</font>

428
00:17:09,369 --> 00:17:15,829
<font color="#E5E5E5">so if you were to see that that that</font>

429
00:17:11,959 --> 00:17:18,679
<font color="#E5E5E5">domain CDN verified net you know</font><font color="#CCCCCC"> exactly</font>

430
00:17:15,829 --> 00:17:20,240
<font color="#E5E5E5">where or what adversary is associated</font>

431
00:17:18,679 --> 00:17:26,360
with<font color="#E5E5E5"> where in their operational phases</font>

432
00:17:20,240 --> 00:17:29,120
that it belongs<font color="#E5E5E5"> that kind of thing okay</font>

433
00:17:26,359 --> 00:17:31,639
moving<font color="#E5E5E5"> on</font><font color="#CCCCCC"> to delivery</font><font color="#E5E5E5"> phase there's some</font>

434
00:17:29,120 --> 00:17:34,340
<font color="#E5E5E5">interesting techniques here which I'll</font>

435
00:17:31,640 --> 00:17:36,020
talk about in<font color="#E5E5E5"> a little bit</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> here we</font>

436
00:17:34,340 --> 00:17:38,629
have<font color="#E5E5E5"> spearfishing messages with</font>

437
00:17:36,020 --> 00:17:40,550
malicious attachments<font color="#E5E5E5"> and as you</font>

438
00:17:38,630 --> 00:17:42,919
<font color="#E5E5E5">remember the the Excel spreadsheet was</font>

439
00:17:40,550 --> 00:17:44,480
attached to<font color="#CCCCCC"> it</font><font color="#E5E5E5"> email sent</font><font color="#CCCCCC"> to the target</font>

440
00:17:42,919 --> 00:17:45,950
<font color="#E5E5E5">and here you can see</font><font color="#CCCCCC"> there's</font><font color="#E5E5E5"> several</font>

441
00:17:44,480 --> 00:17:49,130
<font color="#CCCCCC">different indicators associated with</font>

442
00:17:45,950 --> 00:17:50,240
that with that<font color="#E5E5E5"> specific technique moving</font>

443
00:17:49,130 --> 00:17:53,120
the<font color="#E5E5E5"> exploitation phase</font>

444
00:17:50,240 --> 00:17:55,190
another interesting<font color="#E5E5E5"> technique</font><font color="#CCCCCC"> authorized</font>

445
00:17:53,120 --> 00:17:58,909
user performs requested cyber action

446
00:17:55,190 --> 00:18:00,110
<font color="#CCCCCC">this was to capture the</font><font color="#E5E5E5"> there was no</font>

447
00:17:58,910 --> 00:18:02,750
<font color="#E5E5E5">software vulnerability that was</font>

448
00:18:00,110 --> 00:18:05,750
exploited<font color="#E5E5E5"> so we had to use</font><font color="#CCCCCC"> a technique</font>

449
00:18:02,750 --> 00:18:07,400
<font color="#E5E5E5">from attack to specify you know clicking</font>

450
00:18:05,750 --> 00:18:10,300
that enable content<font color="#E5E5E5"> button to infect</font>

451
00:18:07,400 --> 00:18:12,380
themselves<font color="#CCCCCC"> and</font><font color="#E5E5E5"> that's what this is used</font>

452
00:18:10,300 --> 00:18:14,990
<font color="#CCCCCC">okay</font><font color="#E5E5E5"> in the installation phase here's</font>

453
00:18:12,380 --> 00:18:17,240
several different techniques<font color="#CCCCCC"> that were</font>

454
00:18:14,990 --> 00:18:18,679
used and the<font color="#E5E5E5"> I'm just</font><font color="#CCCCCC"> gonna highlight</font>

455
00:18:17,240 --> 00:18:20,900
<font color="#E5E5E5">this</font><font color="#CCCCCC"> one real quick the login scripts</font>

456
00:18:18,679 --> 00:18:23,780
<font color="#E5E5E5">it's a very specific registry key that</font>

457
00:18:20,900 --> 00:18:26,210
was used by<font color="#E5E5E5"> the payload to automatically</font>

458
00:18:23,780 --> 00:18:28,040
run each time<font color="#E5E5E5"> and here at the bottom I</font>

459
00:18:26,210 --> 00:18:29,929
<font color="#E5E5E5">just want to kind</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> highlight in orange</font>

460
00:18:28,040 --> 00:18:33,470
<font color="#E5E5E5">you</font><font color="#CCCCCC"> can see that the the actual</font>

461
00:18:29,929 --> 00:18:36,050
indicator pattern itself includes<font color="#E5E5E5"> some</font>

462
00:18:33,470 --> 00:18:37,760
logic<font color="#E5E5E5"> there's an and in there</font><font color="#CCCCCC"> right</font><font color="#E5E5E5"> so</font>

463
00:18:36,050 --> 00:18:40,370
that I<font color="#E5E5E5"> just want to highlight the</font><font color="#CCCCCC"> fact</font>

464
00:18:37,760 --> 00:18:43,309
that sticks<font color="#E5E5E5"> to you can actually write</font>

465
00:18:40,370 --> 00:18:45,080
some pretty pretty accurate indicator

466
00:18:43,309 --> 00:18:47,059
patterns<font color="#CCCCCC"> by using a little bit more</font>

467
00:18:45,080 --> 00:18:49,040
<font color="#E5E5E5">logic to them like this one requires a</font>

468
00:18:47,059 --> 00:18:51,309
registry key and a specific<font color="#E5E5E5"> value being</font>

469
00:18:49,040 --> 00:18:53,540
used so interesting stuff

470
00:18:51,309 --> 00:18:55,040
<font color="#CCCCCC">okay</font><font color="#E5E5E5"> moving into a command control we</font>

471
00:18:53,540 --> 00:18:57,440
have standard application layer protocol

472
00:18:55,040 --> 00:18:58,750
one of my favorite one<font color="#CCCCCC"> of my favorite</font>

473
00:18:57,440 --> 00:19:02,179
techniques which you'll see<font color="#E5E5E5"> in a minute</font>

474
00:18:58,750 --> 00:19:05,420
<font color="#E5E5E5">service queue</font><font color="#CCCCCC"> burp</font><font color="#E5E5E5"> uses HTTP and there's</font>

475
00:19:02,179 --> 00:19:07,190
the technique that's being used and in

476
00:19:05,420 --> 00:19:10,429
<font color="#CCCCCC">ACTA objectives phase</font><font color="#E5E5E5"> these are the</font>

477
00:19:07,190 --> 00:19:12,470
techniques<font color="#E5E5E5"> that we were</font><font color="#CCCCCC"> able to just</font>

478
00:19:10,429 --> 00:19:16,190
kind of speculate on<font color="#E5E5E5"> because we didn't</font>

479
00:19:12,470 --> 00:19:17,870
have<font color="#CCCCCC"> a true</font><font color="#E5E5E5"> view into</font><font color="#CCCCCC"> what they did</font>

480
00:19:16,190 --> 00:19:20,660
<font color="#E5E5E5">after they got there</font><font color="#CCCCCC"> their</font><font color="#E5E5E5"> initial</font>

481
00:19:17,870 --> 00:19:24,139
access<font color="#E5E5E5"> but this is what they did right</font>

482
00:19:20,660 --> 00:19:25,550
when they got to the to the system<font color="#CCCCCC"> one</font>

483
00:19:24,140 --> 00:19:27,650
thing I do want<font color="#CCCCCC"> to</font><font color="#E5E5E5"> highlight is the</font><font color="#CCCCCC"> fact</font>

484
00:19:25,550 --> 00:19:29,809
<font color="#CCCCCC">usually when I</font><font color="#E5E5E5"> get this presentation I</font>

485
00:19:27,650 --> 00:19:31,760
go through multiple<font color="#E5E5E5"> of the different</font>

486
00:19:29,809 --> 00:19:34,010
campaigns<font color="#E5E5E5"> so you can start you know</font>

487
00:19:31,760 --> 00:19:35,840
comparing them together<font color="#E5E5E5"> but once you do</font>

488
00:19:34,010 --> 00:19:38,690
this kind<font color="#E5E5E5"> of create these plays and</font>

489
00:19:35,840 --> 00:19:40,699
<font color="#E5E5E5">start tracking the the techniques that</font>

490
00:19:38,690 --> 00:19:43,610
<font color="#E5E5E5">are used during these campaigns you</font><font color="#CCCCCC"> can</font>

491
00:19:40,700 --> 00:19:46,070
start seeing overlaps<font color="#E5E5E5"> in different</font>

492
00:19:43,610 --> 00:19:49,340
campaigns by the same threat groups so

493
00:19:46,070 --> 00:19:51,080
it shows<font color="#E5E5E5"> that they continue to use the</font>

494
00:19:49,340 --> 00:19:52,760
same techniques<font color="#E5E5E5"> over and over again and</font>

495
00:19:51,080 --> 00:19:57,230
<font color="#CCCCCC">there</font><font color="#E5E5E5"> their attack campaigns which is</font>

496
00:19:52,760 --> 00:19:58,580
kind of interesting<font color="#CCCCCC"> okay so</font><font color="#E5E5E5"> I don't know</font>

497
00:19:57,230 --> 00:19:59,570
how much time<font color="#E5E5E5"> I have left</font><font color="#CCCCCC"> but I want to</font>

498
00:19:58,580 --> 00:20:03,600
talk<font color="#CCCCCC"> about a</font><font color="#E5E5E5"> little bit about the</font>

499
00:19:59,570 --> 00:20:06,389
<font color="#E5E5E5">challenges that</font><font color="#CCCCCC"> we came across</font>

500
00:20:03,600 --> 00:20:07,379
<font color="#CCCCCC">we're</font><font color="#E5E5E5"> creating these</font><font color="#CCCCCC"> play books this is</font>

501
00:20:06,390 --> 00:20:09,809
not a<font color="#CCCCCC"> bash</font><font color="#E5E5E5"> vest</font>

502
00:20:07,380 --> 00:20:13,500
I love attack and the<font color="#E5E5E5"> framework itself</font>

503
00:20:09,809 --> 00:20:16,260
<font color="#CCCCCC">and sticks but when we first set out to</font>

504
00:20:13,500 --> 00:20:18,690
make<font color="#E5E5E5"> this concept into a reality we came</font>

505
00:20:16,260 --> 00:20:22,110
across some some hurdles<font color="#CCCCCC"> that we kind of</font>

506
00:20:18,690 --> 00:20:24,660
had<font color="#E5E5E5"> to overcome</font><font color="#CCCCCC"> first off</font><font color="#E5E5E5"> the standard</font>

507
00:20:22,110 --> 00:20:28,428
<font color="#CCCCCC">application layer</font><font color="#E5E5E5"> protocol is a good a</font>

508
00:20:24,660 --> 00:20:30,960
good scent a good example<font color="#E5E5E5"> of where a</font>

509
00:20:28,429 --> 00:20:33,870
technique is a<font color="#E5E5E5"> little bit too broad</font><font color="#CCCCCC"> so</font>

510
00:20:30,960 --> 00:20:35,940
<font color="#CCCCCC">for in our plays this doesn't really</font>

511
00:20:33,870 --> 00:20:38,340
tell you what what standard application

512
00:20:35,940 --> 00:20:40,620
layer protocol<font color="#E5E5E5"> right it could be</font><font color="#CCCCCC"> in this</font>

513
00:20:38,340 --> 00:20:42,720
it even says RPC SSH RDP all those kind

514
00:20:40,620 --> 00:20:44,280
of things<font color="#CCCCCC"> right</font><font color="#E5E5E5"> luckily we were able</font><font color="#CCCCCC"> to</font>

515
00:20:42,720 --> 00:20:46,380
<font color="#E5E5E5">kind of overcome</font><font color="#CCCCCC"> this in our plays</font>

516
00:20:44,280 --> 00:20:49,110
<font color="#E5E5E5">because</font><font color="#CCCCCC"> we're able</font><font color="#E5E5E5"> to add descriptions</font>

517
00:20:46,380 --> 00:20:51,179
so we're relying on that<font color="#CCCCCC"> but this</font><font color="#E5E5E5"> was</font>

518
00:20:49,110 --> 00:20:53,189
this<font color="#E5E5E5"> is an interesting one that just</font>

519
00:20:51,179 --> 00:20:56,970
said<font color="#E5E5E5"> that showed that some of these are</font>

520
00:20:53,190 --> 00:21:01,250
really<font color="#CCCCCC"> really broad techniques</font><font color="#E5E5E5"> execution</font>

521
00:20:56,970 --> 00:21:03,570
through API very very all-encompassing

522
00:21:01,250 --> 00:21:06,120
<font color="#CCCCCC">because this</font><font color="#E5E5E5"> pretty much captures almost</font>

523
00:21:03,570 --> 00:21:09,570
any Trojan<font color="#CCCCCC"> that runs on something else</font>

524
00:21:06,120 --> 00:21:12,330
<font color="#CCCCCC">using an API like create process or</font><font color="#E5E5E5"> win</font>

525
00:21:09,570 --> 00:21:14,100
exact or load library anything so any

526
00:21:12,330 --> 00:21:16,530
any Trojan<font color="#CCCCCC"> that loads something else</font>

527
00:21:14,100 --> 00:21:17,699
<font color="#CCCCCC">would be captured by this technique so</font>

528
00:21:16,530 --> 00:21:23,399
this would<font color="#CCCCCC"> probably pretty</font><font color="#E5E5E5"> much show up</font>

529
00:21:17,700 --> 00:21:25,820
in almost<font color="#E5E5E5"> all</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> our plays</font><font color="#CCCCCC"> use of open</font>

530
00:21:23,400 --> 00:21:28,830
<font color="#E5E5E5">source</font><font color="#CCCCCC"> tools like</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> Lucky Strike</font>

531
00:21:25,820 --> 00:21:31,230
<font color="#E5E5E5">attack that I just mentioned there</font><font color="#CCCCCC"> isn't</font>

532
00:21:28,830 --> 00:21:33,780
a technique for<font color="#E5E5E5"> that and I know that</font><font color="#CCCCCC"> the</font>

533
00:21:31,230 --> 00:21:36,690
<font color="#CCCCCC">miter folks are</font><font color="#E5E5E5"> really receptive to new</font>

534
00:21:33,780 --> 00:21:38,220
<font color="#CCCCCC">techniques</font><font color="#E5E5E5"> and we've been kind of going</font>

535
00:21:36,690 --> 00:21:39,510
back and<font color="#E5E5E5"> forth</font><font color="#CCCCCC"> about this one</font><font color="#E5E5E5"> because we</font>

536
00:21:38,220 --> 00:21:42,299
<font color="#CCCCCC">don't know</font><font color="#E5E5E5"> if it's really a technique or</font>

537
00:21:39,510 --> 00:21:45,299
<font color="#E5E5E5">not but it is</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> flipside</font><font color="#CCCCCC"> of using</font>

538
00:21:42,299 --> 00:21:48,840
custom tooling<font color="#E5E5E5"> so there's a conversation</font>

539
00:21:45,299 --> 00:21:52,440
to have there and in<font color="#E5E5E5"> my favorite and</font>

540
00:21:48,840 --> 00:21:53,730
this<font color="#E5E5E5"> is a lot on us because I know that</font>

541
00:21:52,440 --> 00:21:55,740
several<font color="#CCCCCC"> of the techniques have been</font>

542
00:21:53,730 --> 00:21:58,289
deprecated as you<font color="#E5E5E5"> probably noticed in my</font>

543
00:21:55,740 --> 00:21:59,460
might<font color="#CCCCCC"> my talk a lot of the a lot of that</font>

544
00:21:58,289 --> 00:22:03,150
play some of<font color="#E5E5E5"> the techniques have been</font>

545
00:21:59,460 --> 00:22:04,350
deprecated<font color="#CCCCCC"> and so it's it's one of</font><font color="#E5E5E5"> those</font>

546
00:22:03,150 --> 00:22:06,539
things that<font color="#E5E5E5"> now we have</font><font color="#CCCCCC"> to go back</font>

547
00:22:04,350 --> 00:22:07,918
through<font color="#CCCCCC"> all of our</font><font color="#E5E5E5"> plays and find the</font>

548
00:22:06,539 --> 00:22:10,500
techniques that were deprecated<font color="#E5E5E5"> and</font>

549
00:22:07,919 --> 00:22:13,169
figure<font color="#CCCCCC"> out what</font><font color="#E5E5E5"> to replace them with in</font>

550
00:22:10,500 --> 00:22:15,000
some sort of some<font color="#CCCCCC"> sort of formal</font><font color="#E5E5E5"> manner</font>

551
00:22:13,169 --> 00:22:17,430
<font color="#CCCCCC">because quite frankly</font><font color="#E5E5E5"> there's</font><font color="#CCCCCC"> not like a</font>

552
00:22:15,000 --> 00:22:19,830
<font color="#E5E5E5">really</font><font color="#CCCCCC"> one-to-one</font><font color="#E5E5E5"> kind of over place</font>

553
00:22:17,430 --> 00:22:23,070
one with this it's so we have to kind<font color="#E5E5E5"> of</font>

554
00:22:19,830 --> 00:22:26,010
go back<font color="#CCCCCC"> and do some</font><font color="#E5E5E5"> legwork there okay</font>

555
00:22:23,070 --> 00:22:28,290
moving<font color="#E5E5E5"> on</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> sticks I like sticks</font><font color="#CCCCCC"> it's</font>

556
00:22:26,010 --> 00:22:31,800
fun<font color="#E5E5E5"> it just</font><font color="#CCCCCC"> sticks</font><font color="#E5E5E5"> to is great because</font>

557
00:22:28,290 --> 00:22:33,899
<font color="#E5E5E5">it uses JSON</font><font color="#CCCCCC"> said</font><font color="#E5E5E5"> XML</font><font color="#CCCCCC"> it's lots of</font>

558
00:22:31,800 --> 00:22:36,810
documentation so<font color="#CCCCCC"> that information</font><font color="#E5E5E5"> is out</font>

559
00:22:33,900 --> 00:22:38,760
<font color="#CCCCCC">there but there there's like</font><font color="#E5E5E5"> eight or</font>

560
00:22:36,810 --> 00:22:40,500
<font color="#E5E5E5">five different documents they're all</font>

561
00:22:38,760 --> 00:22:42,600
like<font color="#CCCCCC"> seventy</font><font color="#E5E5E5"> plus pages and they're just</font>

562
00:22:40,500 --> 00:22:44,190
there's a lot<font color="#E5E5E5"> of control F going on here</font>

563
00:22:42,600 --> 00:22:46,620
to be<font color="#CCCCCC"> able</font><font color="#E5E5E5"> to find anything that you're</font>

564
00:22:44,190 --> 00:22:48,660
actually<font color="#E5E5E5"> looking for</font><font color="#CCCCCC"> okay</font>

565
00:22:46,620 --> 00:22:51,959
that being said there are<font color="#E5E5E5"> things</font><font color="#CCCCCC"> that</font>

566
00:22:48,660 --> 00:22:55,200
are sort<font color="#E5E5E5"> of missing here</font><font color="#CCCCCC"> especially with</font>

567
00:22:51,960 --> 00:22:56,730
the<font color="#E5E5E5"> indicator objects these these</font><font color="#CCCCCC"> things</font>

568
00:22:55,200 --> 00:22:58,890
called cyber observable objects which

569
00:22:56,730 --> 00:23:01,710
you<font color="#E5E5E5"> use within your patterns and in this</font>

570
00:22:58,890 --> 00:23:04,580
<font color="#E5E5E5">case there's a there's an</font><font color="#CCCCCC"> object for</font>

571
00:23:01,710 --> 00:23:07,350
HTTP<font color="#CCCCCC"> requests</font><font color="#E5E5E5"> but there's no object</font><font color="#CCCCCC"> for</font>

572
00:23:04,580 --> 00:23:09,179
HTTP response<font color="#E5E5E5"> so you can't write any</font>

573
00:23:07,350 --> 00:23:10,949
patterns for anything<font color="#E5E5E5"> a c2 server would</font>

574
00:23:09,180 --> 00:23:14,520
<font color="#E5E5E5">reply</font><font color="#CCCCCC"> with because there's</font><font color="#E5E5E5"> no object</font><font color="#CCCCCC"> for</font>

575
00:23:10,950 --> 00:23:16,530
it okay

576
00:23:14,520 --> 00:23:20,160
sticks<font color="#E5E5E5"> to</font><font color="#CCCCCC"> is great because</font><font color="#E5E5E5"> it actually</font>

577
00:23:16,530 --> 00:23:21,540
<font color="#E5E5E5">comes with a</font><font color="#CCCCCC"> Python</font><font color="#E5E5E5"> library and which</font>

578
00:23:20,160 --> 00:23:23,340
you<font color="#E5E5E5"> know allows us to create things</font>

579
00:23:21,540 --> 00:23:25,200
really<font color="#E5E5E5"> quickly</font><font color="#CCCCCC"> and one of the things</font>

580
00:23:23,340 --> 00:23:28,320
that we ran into<font color="#E5E5E5"> from</font><font color="#CCCCCC"> an issue</font>

581
00:23:25,200 --> 00:23:32,070
<font color="#E5E5E5">standpoint was the pattern validator</font>

582
00:23:28,320 --> 00:23:34,080
<font color="#E5E5E5">itself was pretty broken unfortunate but</font>

583
00:23:32,070 --> 00:23:36,179
<font color="#E5E5E5">fortunately the sticks folks were</font><font color="#CCCCCC"> able</font>

584
00:23:34,080 --> 00:23:38,520
to fix that with<font color="#E5E5E5"> a new with a new</font>

585
00:23:36,180 --> 00:23:41,490
library<font color="#CCCCCC"> but for a while there we weren't</font>

586
00:23:38,520 --> 00:23:43,230
able<font color="#CCCCCC"> to create any any indicators</font><font color="#E5E5E5"> with a</font>

587
00:23:41,490 --> 00:23:45,630
double<font color="#E5E5E5"> quote in it it just would break</font>

588
00:23:43,230 --> 00:23:47,430
and it wouldn't work at all so here you

589
00:23:45,630 --> 00:23:49,590
can see it just<font color="#E5E5E5"> had a</font><font color="#CCCCCC"> traceback</font><font color="#E5E5E5"> error if</font>

590
00:23:47,430 --> 00:23:51,600
when I try<font color="#E5E5E5"> to create that and this is</font>

591
00:23:49,590 --> 00:23:53,429
one<font color="#CCCCCC"> of the</font><font color="#E5E5E5"> patterns we try to create for</font>

592
00:23:51,600 --> 00:23:55,770
<font color="#CCCCCC">this specific play that Lucky Strike</font>

593
00:23:53,430 --> 00:23:57,930
<font color="#E5E5E5">play but we weren't able to because of</font>

594
00:23:55,770 --> 00:23:59,490
this of this<font color="#CCCCCC"> limitation</font><font color="#E5E5E5"> but like I said</font>

595
00:23:57,930 --> 00:24:02,160
they fixed<font color="#E5E5E5"> it with their new with their</font>

596
00:23:59,490 --> 00:24:04,140
new library<font color="#E5E5E5"> okay I'm not gonna really</font>

597
00:24:02,160 --> 00:24:06,810
<font color="#E5E5E5">talk about the</font><font color="#CCCCCC"> tech</font><font color="#E5E5E5"> navigator much</font><font color="#CCCCCC"> I</font>

598
00:24:04,140 --> 00:24:08,690
wish this tool existed when we kind<font color="#CCCCCC"> of</font>

599
00:24:06,810 --> 00:24:11,850
first started<font color="#E5E5E5"> going down this path</font>

600
00:24:08,690 --> 00:24:13,620
<font color="#CCCCCC">because there wasn't</font><font color="#E5E5E5"> a way to real</font>

601
00:24:11,850 --> 00:24:15,740
really visualize and interact<font color="#CCCCCC"> with the</font>

602
00:24:13,620 --> 00:24:19,100
attack framework<font color="#CCCCCC"> in</font><font color="#E5E5E5"> any sort of way</font>

603
00:24:15,740 --> 00:24:21,990
<font color="#CCCCCC">other than into in the wiki itself</font><font color="#E5E5E5"> and</font>

604
00:24:19,100 --> 00:24:23,189
this<font color="#CCCCCC"> is actually a really cool</font><font color="#E5E5E5"> tool</font><font color="#CCCCCC"> that</font>

605
00:24:21,990 --> 00:24:25,230
allows you<font color="#E5E5E5"> to kind</font><font color="#CCCCCC"> of interact</font><font color="#E5E5E5"> with it</font>

606
00:24:23,190 --> 00:24:27,630
and this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> that same play</font><font color="#E5E5E5"> all these</font>

607
00:24:25,230 --> 00:24:30,330
these boxes are the<font color="#E5E5E5"> same play that were</font>

608
00:24:27,630 --> 00:24:31,380
on the that that<font color="#CCCCCC"> I built in the</font><font color="#E5E5E5"> in the</font>

609
00:24:30,330 --> 00:24:33,149
<font color="#CCCCCC">playbook</font>

610
00:24:31,380 --> 00:24:34,950
you<font color="#E5E5E5"> were but just aren't using the</font>

611
00:24:33,150 --> 00:24:40,650
attack framework<font color="#E5E5E5"> or detect</font><font color="#CCCCCC"> navigator</font>

612
00:24:34,950 --> 00:24:42,360
itself<font color="#E5E5E5"> okay that's all of</font><font color="#CCCCCC"> god I</font><font color="#E5E5E5"> did want</font>

613
00:24:40,650 --> 00:24:44,370
to<font color="#E5E5E5"> kind of end and</font><font color="#CCCCCC"> just say that you</font>

614
00:24:42,360 --> 00:24:47,040
know<font color="#E5E5E5"> as unifor</font><font color="#CCCCCC"> to as we're</font><font color="#E5E5E5"> going through</font>

615
00:24:44,370 --> 00:24:49,350
our<font color="#E5E5E5"> research</font><font color="#CCCCCC"> we're we're starting to</font>

616
00:24:47,040 --> 00:24:51,300
<font color="#CCCCCC">think</font><font color="#E5E5E5"> about attack and the attack</font>

617
00:24:49,350 --> 00:24:53,850
techniques and the adversaries and how

618
00:24:51,300 --> 00:24:55,800
they're using these techniques<font color="#E5E5E5"> to carry</font>

619
00:24:53,850 --> 00:24:58,050
out these attacks<font color="#CCCCCC"> and we just wanted to</font>

620
00:24:55,800 --> 00:25:00,600
be able<font color="#E5E5E5"> to disseminate</font><font color="#CCCCCC"> that kind</font><font color="#E5E5E5"> of</font>

621
00:24:58,050 --> 00:25:02,580
<font color="#E5E5E5">information to provide more context</font><font color="#CCCCCC"> to</font>

622
00:25:00,600 --> 00:25:05,149
the the Intel<font color="#E5E5E5"> that we're gathering on a</font>

623
00:25:02,580 --> 00:25:08,820
<font color="#CCCCCC">day to day basis for the community</font><font color="#E5E5E5"> to</font>

624
00:25:05,150 --> 00:25:11,400
absorb and yeah that's all<font color="#E5E5E5"> I got here's</font>

625
00:25:08,820 --> 00:25:13,080
the again the URLs for the the PlayBook

626
00:25:11,400 --> 00:25:16,380
viewer and our<font color="#E5E5E5"> blog where most of the</font>

627
00:25:13,080 --> 00:25:21,510
other<font color="#CCCCCC"> information that</font><font color="#E5E5E5"> we have and thank</font>

628
00:25:16,380 --> 00:25:23,910
you yes you do said any questions<font color="#CCCCCC"> by the</font>

629
00:25:21,510 --> 00:25:27,920
<font color="#E5E5E5">way as the guy who created sticks and</font>

630
00:25:23,910 --> 00:25:31,950
taxi<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> I will cop to sticks one being</font>

631
00:25:27,920 --> 00:25:34,740
something<font color="#E5E5E5"> I will take to my grave glad</font>

632
00:25:31,950 --> 00:25:37,590
to<font color="#E5E5E5"> see that you've toughed it out and</font>

633
00:25:34,740 --> 00:25:40,350
stuck with<font color="#CCCCCC"> 66 to is there it</font><font color="#E5E5E5"> I mean</font>

634
00:25:37,590 --> 00:25:42,240
Jason's much easier to work with and as

635
00:25:40,350 --> 00:25:44,939
much<font color="#CCCCCC"> as I</font><font color="#E5E5E5"> kind of gave challenges up</font>

636
00:25:42,240 --> 00:25:46,860
here it's still well<font color="#E5E5E5"> these are you know</font>

637
00:25:44,940 --> 00:25:48,960
standardized frameworks like it's still

638
00:25:46,860 --> 00:25:50,790
<font color="#E5E5E5">better</font><font color="#CCCCCC"> than me creating our own so I</font>

639
00:25:48,960 --> 00:25:52,560
mean<font color="#CCCCCC"> it still</font><font color="#E5E5E5"> have to give thanks</font><font color="#CCCCCC"> for</font>

640
00:25:50,790 --> 00:25:54,240
thanks<font color="#CCCCCC"> to Stuart ya</font><font color="#E5E5E5"> know it's an</font><font color="#CCCCCC"> awesome</font>

641
00:25:52,560 --> 00:26:01,490
application<font color="#CCCCCC"> alright questions for a</font>

642
00:25:54,240 --> 00:26:01,490
Robert come on you can do it

643
00:26:05,440 --> 00:26:09,980
<font color="#CCCCCC">where'd you say was like the level of</font>

644
00:26:07,909 --> 00:26:11,240
effort<font color="#CCCCCC"> that it took too big</font><font color="#E5E5E5"> to like put</font>

645
00:26:09,980 --> 00:26:13,610
together<font color="#E5E5E5"> one of these play books to do</font>

646
00:26:11,240 --> 00:26:15,590
all the mappings<font color="#CCCCCC"> you know is</font><font color="#E5E5E5"> it like a</font>

647
00:26:13,610 --> 00:26:19,340
month a week<font color="#E5E5E5"> a day that's a great</font>

648
00:26:15,590 --> 00:26:22,070
question<font color="#CCCCCC"> I think at well at first</font><font color="#E5E5E5"> to get</font>

649
00:26:19,340 --> 00:26:23,928
<font color="#E5E5E5">this process started</font><font color="#CCCCCC"> I think I was given</font>

650
00:26:22,070 --> 00:26:26,928
a<font color="#CCCCCC"> timeline the first one had to</font><font color="#E5E5E5"> be done</font>

651
00:26:23,929 --> 00:26:29,390
in<font color="#CCCCCC"> like a month and that</font><font color="#E5E5E5"> was daunting at</font>

652
00:26:26,929 --> 00:26:31,159
first because we<font color="#CCCCCC"> didn't have any tooling</font>

653
00:26:29,390 --> 00:26:33,770
<font color="#E5E5E5">to be</font><font color="#CCCCCC"> able to create these in any sort</font>

654
00:26:31,159 --> 00:26:38,779
<font color="#E5E5E5">of manner</font><font color="#CCCCCC"> so there was some development</font>

655
00:26:33,770 --> 00:26:41,260
effort<font color="#CCCCCC"> upfront so the the level</font><font color="#E5E5E5"> the the</font>

656
00:26:38,779 --> 00:26:43,789
<font color="#CCCCCC">effort level</font><font color="#E5E5E5"> was daunting at first but</font>

657
00:26:41,260 --> 00:26:47,090
<font color="#CCCCCC">since</font><font color="#E5E5E5"> we've actually started to do these</font>

658
00:26:43,789 --> 00:26:48,710
in you know more repetitive function and

659
00:26:47,090 --> 00:26:50,840
got more familiarized<font color="#E5E5E5"> with not only</font>

660
00:26:48,710 --> 00:26:54,740
<font color="#CCCCCC">sticks to but also the attack framework</font>

661
00:26:50,840 --> 00:26:57,439
it's been easier<font color="#CCCCCC"> I will also say that</font>

662
00:26:54,740 --> 00:26:59,840
<font color="#CCCCCC">the tooling we have now is much better</font>

663
00:26:57,440 --> 00:27:02,770
than<font color="#E5E5E5"> the you know the stuff I wrote</font>

664
00:26:59,840 --> 00:27:05,120
because<font color="#E5E5E5"> it was really poorly written</font><font color="#CCCCCC"> but</font>

665
00:27:02,770 --> 00:27:06,710
just<font color="#E5E5E5"> getting familiarized with</font><font color="#CCCCCC"> the</font>

666
00:27:05,120 --> 00:27:10,639
framework<font color="#CCCCCC"> and</font><font color="#E5E5E5"> that kind of thing was</font>

667
00:27:06,710 --> 00:27:12,440
probably<font color="#E5E5E5"> the biggest hurdle</font><font color="#CCCCCC"> I will</font><font color="#E5E5E5"> also</font>

668
00:27:10,640 --> 00:27:14,929
say there were a lot of<font color="#E5E5E5"> arguments</font>

669
00:27:12,440 --> 00:27:16,490
between analysts<font color="#E5E5E5"> like</font><font color="#CCCCCC"> oh does</font><font color="#E5E5E5"> this apply</font>

670
00:27:14,929 --> 00:27:19,070
does this apply that kind<font color="#CCCCCC"> of thing</font>

671
00:27:16,490 --> 00:27:21,710
between techniques<font color="#CCCCCC"> themselves but</font><font color="#E5E5E5"> yeah I</font>

672
00:27:19,070 --> 00:27:24,049
would<font color="#CCCCCC"> say at first</font><font color="#E5E5E5"> it was a heavy lift</font>

673
00:27:21,710 --> 00:27:27,049
but then after you know<font color="#E5E5E5"> after a little</font>

674
00:27:24,049 --> 00:27:30,620
<font color="#CCCCCC">bit it got it got easier I have a</font>

675
00:27:27,049 --> 00:27:32,090
two-part<font color="#CCCCCC"> question okay the first</font><font color="#E5E5E5"> is do</font>

676
00:27:30,620 --> 00:27:34,250
you have<font color="#E5E5E5"> you guys written software for</font>

677
00:27:32,090 --> 00:27:36,439
the<font color="#E5E5E5"> ingest of the data so the actual</font>

678
00:27:34,250 --> 00:27:37,730
data import and the second how much

679
00:27:36,440 --> 00:27:39,080
adoption have you seen<font color="#E5E5E5"> from the</font>

680
00:27:37,730 --> 00:27:41,059
community have you seen other<font color="#E5E5E5"> people</font>

681
00:27:39,080 --> 00:27:43,610
writing these and using these<font color="#E5E5E5"> so</font>

682
00:27:41,059 --> 00:27:46,010
<font color="#E5E5E5">ingestion not yet we're actually</font>

683
00:27:43,610 --> 00:27:48,070
thinking about<font color="#E5E5E5"> even creating tools to</font>

684
00:27:46,010 --> 00:27:50,690
create<font color="#E5E5E5"> them yourselves</font>

685
00:27:48,070 --> 00:27:54,320
how much adoption have we had we have

686
00:27:50,690 --> 00:27:56,179
some<font color="#E5E5E5"> serious interest in it</font><font color="#CCCCCC"> how how</font>

687
00:27:54,320 --> 00:27:59,450
those folks are actually<font color="#E5E5E5"> do using them</font>

688
00:27:56,179 --> 00:28:01,070
I'm not<font color="#E5E5E5"> entirely entirely sure but we</font>

689
00:27:59,450 --> 00:28:02,750
<font color="#E5E5E5">are having people you know pulling down</font>

690
00:28:01,070 --> 00:28:05,350
the<font color="#CCCCCC"> JSON sand</font><font color="#E5E5E5"> you know kind of getting</font>

691
00:28:02,750 --> 00:28:05,350
<font color="#CCCCCC">excited</font><font color="#E5E5E5"> about it</font>

692
00:28:11,410 --> 00:28:16,600
<font color="#CCCCCC">could you talk just a little bit more</font>

693
00:28:13,490 --> 00:28:19,400
about the process<font color="#E5E5E5"> you guys are using to</font>

694
00:28:16,600 --> 00:28:20,959
<font color="#E5E5E5">evaluate the malicious activity to</font>

695
00:28:19,400 --> 00:28:23,840
create the<font color="#E5E5E5"> playbook and is there any</font>

696
00:28:20,960 --> 00:28:26,000
automated processing that you're<font color="#E5E5E5"> doing</font>

697
00:28:23,840 --> 00:28:28,429
to<font color="#CCCCCC"> identify the attack techniques being</font>

698
00:28:26,000 --> 00:28:31,430
<font color="#E5E5E5">used</font><font color="#CCCCCC"> no not yet</font><font color="#E5E5E5"> I should</font><font color="#CCCCCC"> also mention</font>

699
00:28:28,430 --> 00:28:35,090
<font color="#E5E5E5">that this</font><font color="#CCCCCC"> is a it's we're still working</font>

700
00:28:31,430 --> 00:28:37,880
on this in fact our<font color="#E5E5E5"> our our tooling is</font>

701
00:28:35,090 --> 00:28:39,620
not even fully there<font color="#CCCCCC"> yet we do have</font>

702
00:28:37,880 --> 00:28:42,110
<font color="#CCCCCC">ideas of how we could</font><font color="#E5E5E5"> start automating</font>

703
00:28:39,620 --> 00:28:44,870
<font color="#CCCCCC">some of these</font><font color="#E5E5E5"> things</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> it's not there</font>

704
00:28:42,110 --> 00:28:45,979
right<font color="#CCCCCC"> now it's up to the</font><font color="#E5E5E5"> analyst as</font>

705
00:28:44,870 --> 00:28:49,760
they're going<font color="#E5E5E5"> through</font><font color="#CCCCCC"> their research</font>

706
00:28:45,980 --> 00:28:51,260
efforts to identify<font color="#CCCCCC"> which techniques are</font>

707
00:28:49,760 --> 00:28:54,290
being<font color="#CCCCCC"> used and</font><font color="#E5E5E5"> then apply that</font><font color="#CCCCCC"> to the</font>

708
00:28:51,260 --> 00:28:57,580
play so it's largely manual right now

709
00:28:54,290 --> 00:29:05,120
but we're working<font color="#E5E5E5"> we're working on it</font>

710
00:28:57,580 --> 00:29:09,010
any other questions<font color="#E5E5E5"> for</font><font color="#CCCCCC"> Robert great all</font>

711
00:29:05,120 --> 00:29:09,010
<font color="#E5E5E5">right please join me in thanking Robert</font>

712
00:29:14,400 --> 00:29:16,460
you

