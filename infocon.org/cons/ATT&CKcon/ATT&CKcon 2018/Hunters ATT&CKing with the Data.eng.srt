1
00:00:05,640 --> 00:00:11,129
<font color="#E5E5E5">the</font><font color="#CCCCCC"> shock</font><font color="#E5E5E5"> to say that many of us here</font>

2
00:00:07,950 --> 00:00:12,180
are<font color="#E5E5E5"> passionate about attack and how</font>

3
00:00:11,130 --> 00:00:13,799
we're<font color="#E5E5E5"> going to use</font><font color="#CCCCCC"> it in our</font>

4
00:00:12,180 --> 00:00:16,079
environments or how we<font color="#E5E5E5"> are using in our</font>

5
00:00:13,799 --> 00:00:18,210
environments<font color="#CCCCCC"> all</font><font color="#E5E5E5"> right and our next</font>

6
00:00:16,079 --> 00:00:20,939
speakers<font color="#E5E5E5"> really embody this ideal</font>

7
00:00:18,210 --> 00:00:23,700
<font color="#E5E5E5">Roberto Rodriguez is a senior threat</font>

8
00:00:20,940 --> 00:00:25,880
hunter at<font color="#CCCCCC"> specter ops</font><font color="#E5E5E5"> we specializes in</font>

9
00:00:23,700 --> 00:00:28,919
the development<font color="#CCCCCC"> of analytics to detect</font>

10
00:00:25,880 --> 00:00:30,630
advanced adversaries techniques<font color="#E5E5E5"> his</font>

11
00:00:28,920 --> 00:00:33,510
experience performing<font color="#CCCCCC"> Incident Response</font>

12
00:00:30,630 --> 00:00:35,670
<font color="#E5E5E5">and threat hunting motivated him</font><font color="#CCCCCC"> to help</font>

13
00:00:33,510 --> 00:00:37,769
<font color="#CCCCCC">organizations improve their</font><font color="#E5E5E5"> security</font>

14
00:00:35,670 --> 00:00:40,620
posture and<font color="#E5E5E5"> to</font><font color="#CCCCCC"> share his knowledge with</font>

15
00:00:37,770 --> 00:00:42,210
<font color="#CCCCCC">the information</font><font color="#E5E5E5"> security community</font><font color="#CCCCCC"> he is</font>

16
00:00:40,620 --> 00:00:44,250
the author of several<font color="#E5E5E5"> open-source</font>

17
00:00:42,210 --> 00:00:47,280
projects such as the threat hunter

18
00:00:44,250 --> 00:00:48,900
playbook and help to aid the community

19
00:00:47,280 --> 00:00:51,870
<font color="#CCCCCC">development of techniques and toolings</font>

20
00:00:48,900 --> 00:00:55,530
<font color="#E5E5E5">for hunting campaigns his co-presenter</font>

21
00:00:51,870 --> 00:00:56,970
<font color="#E5E5E5">is his brother Jose</font><font color="#CCCCCC"> Luis Rodriguez</font><font color="#E5E5E5"> a</font>

22
00:00:55,530 --> 00:00:58,980
student at Northern Virginia Community

23
00:00:56,970 --> 00:01:01,710
<font color="#CCCCCC">College where he just started his</font>

24
00:00:58,980 --> 00:01:03,540
associate degree in<font color="#E5E5E5"> cyber security</font><font color="#CCCCCC"> his</font>

25
00:01:01,710 --> 00:01:05,430
<font color="#E5E5E5">background</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> business intelligence and</font>

26
00:01:03,540 --> 00:01:07,560
<font color="#E5E5E5">data science for large organizations in</font>

27
00:01:05,430 --> 00:01:09,450
Peru<font color="#CCCCCC"> motivated him to apply</font><font color="#E5E5E5"> his</font>

28
00:01:07,560 --> 00:01:11,670
experience here in the<font color="#E5E5E5"> cyber security</font>

29
00:01:09,450 --> 00:01:13,530
<font color="#E5E5E5">industry</font><font color="#CCCCCC"> and he is also</font><font color="#E5E5E5"> a frequent</font>

30
00:01:11,670 --> 00:01:15,630
<font color="#E5E5E5">contributor to</font><font color="#CCCCCC"> open source projects</font>

31
00:01:13,530 --> 00:01:20,270
please welcome<font color="#E5E5E5"> Roberto would be</font>

32
00:01:15,630 --> 00:01:20,270
Rodriguez and Jose Luis Rodriguez

33
00:01:22,439 --> 00:01:28,079
<font color="#E5E5E5">all right thank you</font><font color="#CCCCCC"> very much everybody</font>

34
00:01:24,749 --> 00:01:29,640
<font color="#CCCCCC">uh uh can you guys</font><font color="#E5E5E5"> hear</font><font color="#CCCCCC"> me</font><font color="#E5E5E5"> well okay and</font>

35
00:01:28,079 --> 00:01:30,809
first of<font color="#E5E5E5"> all I could say thank you to</font>

36
00:01:29,640 --> 00:01:32,549
the<font color="#E5E5E5"> TAC team for giving us the</font>

37
00:01:30,810 --> 00:01:34,859
opportunity<font color="#CCCCCC"> to be part of the first</font>

38
00:01:32,549 --> 00:01:36,060
attack on and<font color="#E5E5E5"> also of course</font><font color="#CCCCCC"> to be able</font>

39
00:01:34,859 --> 00:01:41,038
<font color="#CCCCCC">to speak</font><font color="#E5E5E5"> with my brother</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> the first</font>

40
00:01:36,060 --> 00:01:42,959
<font color="#E5E5E5">time and the topic today</font><font color="#CCCCCC"> is going to be</font>

41
00:01:41,039 --> 00:01:45,840
<font color="#E5E5E5">hunters attacking with the right data</font><font color="#CCCCCC"> so</font>

42
00:01:42,959 --> 00:01:47,459
the focus<font color="#E5E5E5"> or talking about hunting is</font>

43
00:01:45,840 --> 00:01:49,200
going to be focusing a little<font color="#CCCCCC"> bit</font><font color="#E5E5E5"> into</font>

44
00:01:47,459 --> 00:01:50,819
how we can<font color="#E5E5E5"> start using what attack</font>

45
00:01:49,200 --> 00:01:52,530
provides from a data perspective<font color="#E5E5E5"> and</font>

46
00:01:50,819 --> 00:01:55,219
then start<font color="#CCCCCC"> mapping things to what we're</font>

47
00:01:52,530 --> 00:01:58,229
collecting already in<font color="#CCCCCC"> our environment</font>

48
00:01:55,219 --> 00:02:00,689
<font color="#E5E5E5">and</font><font color="#CCCCCC"> we were already</font><font color="#E5E5E5"> presented part of</font>

49
00:01:58,229 --> 00:02:02,099
the<font color="#E5E5E5"> specter</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> steam and the github</font><font color="#CCCCCC"> link</font>

50
00:02:00,689 --> 00:02:03,958
<font color="#E5E5E5">is theirs if you want to contribute</font>

51
00:02:02,099 --> 00:02:05,610
<font color="#E5E5E5">please I would love to talk to</font><font color="#CCCCCC"> you and</font>

52
00:02:03,959 --> 00:02:07,770
brainstorm a little<font color="#E5E5E5"> bit how we can do</font>

53
00:02:05,610 --> 00:02:11,129
things better<font color="#E5E5E5"> and also</font><font color="#CCCCCC"> a former capital</font>

54
00:02:07,770 --> 00:02:13,859
<font color="#E5E5E5">one senior trade hunter hi everyone my</font>

55
00:02:11,129 --> 00:02:15,720
name<font color="#E5E5E5"> is Jose</font><font color="#CCCCCC"> I go by cyber panda</font><font color="#E5E5E5"> in</font>

56
00:02:13,859 --> 00:02:18,390
Twitter<font color="#E5E5E5"> very happy to be here with you</font>

57
00:02:15,720 --> 00:02:20,670
this<font color="#CCCCCC"> is my first conference</font><font color="#E5E5E5"> and also a</font>

58
00:02:18,390 --> 00:02:22,858
funny thing<font color="#CCCCCC"> about this</font><font color="#E5E5E5"> is that my first</font>

59
00:02:20,670 --> 00:02:24,390
<font color="#E5E5E5">cybersecurity world that I'd learned in</font>

60
00:02:22,859 --> 00:02:28,680
January when I came<font color="#E5E5E5"> here to the States</font>

61
00:02:24,390 --> 00:02:30,660
was attack and I'm also a former<font color="#E5E5E5"> senior</font>

62
00:02:28,680 --> 00:02:34,650
<font color="#E5E5E5">business intelligence analyst from Tunis</font>

63
00:02:30,660 --> 00:02:36,989
<font color="#CCCCCC">in Peru alright so the agenda</font><font color="#E5E5E5"> for today</font>

64
00:02:34,650 --> 00:02:38,400
<font color="#CCCCCC">is going to</font><font color="#E5E5E5"> be talking</font><font color="#CCCCCC"> about what we</font><font color="#E5E5E5"> are</font>

65
00:02:36,989 --> 00:02:40,500
<font color="#CCCCCC">seeing</font><font color="#E5E5E5"> what I'm seeing also some</font>

66
00:02:38,400 --> 00:02:42,810
organizations from a threat hunting from

67
00:02:40,500 --> 00:02:44,639
data<font color="#CCCCCC"> perspective from attack as well all</font>

68
00:02:42,810 --> 00:02:47,910
the<font color="#E5E5E5"> way to start showing you how we</font>

69
00:02:44,639 --> 00:02:49,919
start<font color="#CCCCCC"> mapping things specifically</font><font color="#E5E5E5"> event</font>

70
00:02:47,910 --> 00:02:51,329
logs to attack<font color="#E5E5E5"> their sources show you a</font>

71
00:02:49,919 --> 00:02:54,959
couple<font color="#CCCCCC"> examples at the end how that</font>

72
00:02:51,329 --> 00:02:56,880
works<font color="#CCCCCC"> so from a threat hunting data</font>

73
00:02:54,959 --> 00:02:58,799
perspective<font color="#CCCCCC"> I see that every</font>

74
00:02:56,880 --> 00:03:00,209
<font color="#E5E5E5">organization has</font><font color="#CCCCCC"> its own procedures they</font>

75
00:02:58,799 --> 00:03:01,769
want to do their own things they put

76
00:03:00,209 --> 00:03:04,109
<font color="#CCCCCC">together their own programs and</font><font color="#E5E5E5"> it's</font>

77
00:03:01,769 --> 00:03:07,799
great<font color="#E5E5E5"> but at the same time I see</font><font color="#CCCCCC"> that</font>

78
00:03:04,109 --> 00:03:10,319
the focus<font color="#CCCCCC"> on data is not as important as</font>

79
00:03:07,799 --> 00:03:12,209
I believe<font color="#E5E5E5"> it should</font><font color="#CCCCCC"> be</font><font color="#E5E5E5"> data as we know</font>

80
00:03:10,319 --> 00:03:13,950
first is growing<font color="#E5E5E5"> it's getting bigger and</font>

81
00:03:12,209 --> 00:03:16,079
bigger<font color="#E5E5E5"> and</font><font color="#CCCCCC"> bigger</font><font color="#E5E5E5"> and if we don't start</font>

82
00:03:13,950 --> 00:03:18,569
documenting our data<font color="#E5E5E5"> understanding what</font>

83
00:03:16,079 --> 00:03:20,910
<font color="#E5E5E5">that actually means</font><font color="#CCCCCC"> what that provides</font>

84
00:03:18,569 --> 00:03:22,828
to<font color="#CCCCCC"> us and finding relationships</font><font color="#E5E5E5"> in there</font>

85
00:03:20,910 --> 00:03:24,150
it's gonna<font color="#E5E5E5"> be hard to start hunting and</font>

86
00:03:22,829 --> 00:03:26,129
it doesn't<font color="#E5E5E5"> matter how good</font><font color="#CCCCCC"> your program</font>

87
00:03:24,150 --> 00:03:28,319
might be<font color="#E5E5E5"> you</font><font color="#CCCCCC"> might be</font><font color="#E5E5E5"> hunting in a data</font>

88
00:03:26,129 --> 00:03:30,600
swamp<font color="#CCCCCC"> rather than in a data Lake which</font>

89
00:03:28,319 --> 00:03:32,399
<font color="#CCCCCC">is what we all intend to do right we all</font>

90
00:03:30,600 --> 00:03:34,138
try<font color="#CCCCCC"> to buy these</font><font color="#E5E5E5"> tools</font><font color="#CCCCCC"> try to put them</font>

91
00:03:32,400 --> 00:03:35,060
<font color="#E5E5E5">together but at the</font><font color="#CCCCCC"> end</font><font color="#E5E5E5"> of the day it</font>

92
00:03:34,139 --> 00:03:37,580
might not be

93
00:03:35,060 --> 00:03:39,080
an ideal situation<font color="#E5E5E5"> so more data more</font>

94
00:03:37,580 --> 00:03:40,640
problems<font color="#CCCCCC"> I think that</font><font color="#E5E5E5"> some</font><font color="#CCCCCC"> of you might</font>

95
00:03:39,080 --> 00:03:42,380
be thinking<font color="#E5E5E5"> about this but the reality</font>

96
00:03:40,640 --> 00:03:44,269
<font color="#CCCCCC">is that more data gives you enough</font>

97
00:03:42,380 --> 00:03:46,310
visibility<font color="#CCCCCC"> right from a hunting</font><font color="#E5E5E5"> from the</font>

98
00:03:44,270 --> 00:03:48,440
<font color="#CCCCCC">IR perspective</font><font color="#E5E5E5"> but you have to start</font>

99
00:03:46,310 --> 00:03:50,569
prioritizing<font color="#E5E5E5"> what you collect</font><font color="#CCCCCC"> you have</font>

100
00:03:48,440 --> 00:03:52,880
to start understanding<font color="#CCCCCC"> what you have and</font>

101
00:03:50,569 --> 00:03:54,649
the<font color="#E5E5E5"> first</font><font color="#CCCCCC"> question of like what data do</font>

102
00:03:52,880 --> 00:03:56,750
you<font color="#CCCCCC"> have in your</font><font color="#E5E5E5"> environment</font><font color="#CCCCCC"> most of the</font>

103
00:03:54,650 --> 00:03:59,060
time of<font color="#E5E5E5"> course is answer by I do know</font>

104
00:03:56,750 --> 00:04:01,519
where my data comes<font color="#E5E5E5"> from I do know my</font>

105
00:03:59,060 --> 00:04:03,380
logs where they come<font color="#CCCCCC"> from but</font><font color="#E5E5E5"> the second</font>

106
00:04:01,519 --> 00:04:05,090
<font color="#E5E5E5">question</font><font color="#CCCCCC"> do you really know your data</font>

107
00:04:03,380 --> 00:04:07,069
<font color="#CCCCCC">the</font><font color="#E5E5E5"> data</font><font color="#CCCCCC"> they are collecting that's a</font>

108
00:04:05,090 --> 00:04:08,269
different question<font color="#CCCCCC"> right</font><font color="#E5E5E5"> you understand</font>

109
00:04:07,069 --> 00:04:10,488
the<font color="#E5E5E5"> meaning of the logs that you're</font>

110
00:04:08,269 --> 00:04:11,900
collecting<font color="#E5E5E5"> and of course at the end</font><font color="#CCCCCC"> we</font>

111
00:04:10,489 --> 00:04:14,180
can<font color="#CCCCCC"> start</font><font color="#E5E5E5"> going back into this</font>

112
00:04:11,900 --> 00:04:17,120
conversation<font color="#E5E5E5"> but do you really know your</font>

113
00:04:14,180 --> 00:04:20,180
data<font color="#E5E5E5"> right so this is</font><font color="#CCCCCC"> the whole idea</font><font color="#E5E5E5"> of</font>

114
00:04:17,120 --> 00:04:22,430
<font color="#E5E5E5">you know this presentation</font><font color="#CCCCCC"> we all know</font>

115
00:04:20,180 --> 00:04:24,290
<font color="#CCCCCC">we're here right</font><font color="#E5E5E5"> attack provides a lot</font>

116
00:04:22,430 --> 00:04:25,820
of<font color="#E5E5E5"> information great relationships</font>

117
00:04:24,290 --> 00:04:28,490
across<font color="#E5E5E5"> all the data that they put</font>

118
00:04:25,820 --> 00:04:30,320
together<font color="#E5E5E5"> but I believe that</font><font color="#CCCCCC"> we're still</font>

119
00:04:28,490 --> 00:04:32,270
<font color="#CCCCCC">missing that piece from the extra</font>

120
00:04:30,320 --> 00:04:34,340
metadata that<font color="#E5E5E5"> attack provides that we</font>

121
00:04:32,270 --> 00:04:37,460
love the<font color="#E5E5E5"> most which</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> the data sources</font>

122
00:04:34,340 --> 00:04:39,080
piece<font color="#E5E5E5"> and if we define data sources from</font>

123
00:04:37,460 --> 00:04:41,359
<font color="#CCCCCC">miner perspective just</font><font color="#E5E5E5"> to summarize this</font>

124
00:04:39,080 --> 00:04:43,250
thought is<font color="#CCCCCC"> that it's the</font><font color="#E5E5E5"> information</font>

125
00:04:41,360 --> 00:04:44,240
that you<font color="#CCCCCC"> collect from the</font><font color="#E5E5E5"> sensors</font><font color="#CCCCCC"> and</font>

126
00:04:43,250 --> 00:04:45,979
<font color="#E5E5E5">things that</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> have in</font><font color="#CCCCCC"> your</font><font color="#E5E5E5"> environment</font>

127
00:04:44,240 --> 00:04:47,810
<font color="#CCCCCC">all the weights new to the</font><font color="#E5E5E5"> perimeter</font>

128
00:04:45,979 --> 00:04:49,460
level that is going to<font color="#E5E5E5"> allow you to</font>

129
00:04:47,810 --> 00:04:52,130
<font color="#E5E5E5">validate the detection of</font><font color="#CCCCCC"> on a specific</font>

130
00:04:49,460 --> 00:04:53,599
<font color="#E5E5E5">technique so when you start</font>

131
00:04:52,130 --> 00:04:55,010
understanding<font color="#E5E5E5"> this you</font><font color="#CCCCCC"> start then</font>

132
00:04:53,600 --> 00:04:57,229
<font color="#E5E5E5">creating</font><font color="#CCCCCC"> creating these extra</font>

133
00:04:55,010 --> 00:04:58,669
relationships in this<font color="#E5E5E5"> beautiful first</font>

134
00:04:57,229 --> 00:05:01,789
relationship<font color="#CCCCCC"> that they put together in</font>

135
00:04:58,669 --> 00:05:04,639
their paper with the main goal to start

136
00:05:01,789 --> 00:05:06,409
mapping things that you have all the way

137
00:05:04,639 --> 00:05:08,120
to a technique to<font color="#CCCCCC"> an adversary and</font>

138
00:05:06,410 --> 00:05:09,950
things like<font color="#E5E5E5"> that</font><font color="#CCCCCC"> now this</font><font color="#E5E5E5"> is easier</font>

139
00:05:08,120 --> 00:05:11,960
right because you can just say this tool

140
00:05:09,950 --> 00:05:15,080
<font color="#E5E5E5">gives me this I bought this vendor is</font>

141
00:05:11,960 --> 00:05:16,520
giving me this<font color="#E5E5E5"> so you can do this so</font>

142
00:05:15,080 --> 00:05:18,919
your question might be<font color="#E5E5E5"> right now then</font>

143
00:05:16,520 --> 00:05:21,440
why we keep<font color="#E5E5E5"> talking about data and how</font>

144
00:05:18,919 --> 00:05:23,419
<font color="#CCCCCC">we can</font><font color="#E5E5E5"> map it</font><font color="#CCCCCC"> to miter</font><font color="#E5E5E5"> attack the main</font>

145
00:05:21,440 --> 00:05:26,030
goals is<font color="#CCCCCC"> that we want to do in</font><font color="#E5E5E5"> here</font><font color="#CCCCCC"> is</font>

146
00:05:23,419 --> 00:05:28,609
to expand on<font color="#E5E5E5"> the attack data sources we</font>

147
00:05:26,030 --> 00:05:31,309
want to help<font color="#CCCCCC"> prioritize how we can start</font>

148
00:05:28,610 --> 00:05:33,020
collecting data still map it to<font color="#E5E5E5"> an</font>

149
00:05:31,310 --> 00:05:34,850
attack<font color="#E5E5E5"> data source but in order to</font><font color="#CCCCCC"> be</font>

150
00:05:33,020 --> 00:05:37,280
<font color="#E5E5E5">more efficient doing that we need</font><font color="#CCCCCC"> to</font>

151
00:05:34,850 --> 00:05:38,570
understand how pretty much we can talk

152
00:05:37,280 --> 00:05:40,460
<font color="#E5E5E5">about our data understanding a little</font>

153
00:05:38,570 --> 00:05:42,530
<font color="#E5E5E5">bit better at the end of the day we're</font>

154
00:05:40,460 --> 00:05:44,630
going to define a methodology how we do

155
00:05:42,530 --> 00:05:47,059
this<font color="#CCCCCC"> I'm in</font><font color="#E5E5E5"> order to help blue teamers</font>

156
00:05:44,630 --> 00:05:48,380
and also red teamers to understand what

157
00:05:47,060 --> 00:05:50,270
an adversary actually

158
00:05:48,380 --> 00:05:51,530
look like in the environment<font color="#E5E5E5"> and of</font>

159
00:05:50,270 --> 00:05:54,010
course we want<font color="#E5E5E5"> to share how</font><font color="#CCCCCC"> we learn</font>

160
00:05:51,530 --> 00:05:56,659
about event logs and also data sources

161
00:05:54,010 --> 00:05:58,400
<font color="#E5E5E5">so let's</font><font color="#CCCCCC"> define our methodology we're</font>

162
00:05:56,660 --> 00:06:01,340
going to go all<font color="#CCCCCC"> the way</font><font color="#E5E5E5"> from exploring</font>

163
00:05:58,400 --> 00:06:02,870
<font color="#E5E5E5">attack data sources to start</font><font color="#CCCCCC"> validating</font>

164
00:06:01,340 --> 00:06:04,810
these data mappings<font color="#E5E5E5"> and of course share</font>

165
00:06:02,870 --> 00:06:07,250
in<font color="#E5E5E5"> our methodology</font>

166
00:06:04,810 --> 00:06:09,020
let's explore attack data sources you

167
00:06:07,250 --> 00:06:10,670
might be asking<font color="#CCCCCC"> yourself how I do this</font>

168
00:06:09,020 --> 00:06:11,719
<font color="#E5E5E5">and there are different</font><font color="#CCCCCC"> ways to</font><font color="#E5E5E5"> do</font><font color="#CCCCCC"> it</font>

169
00:06:10,670 --> 00:06:13,460
right<font color="#E5E5E5"> you can do it through the website</font>

170
00:06:11,720 --> 00:06:15,650
<font color="#E5E5E5">you can do it through the github repo</font>

171
00:06:13,460 --> 00:06:17,780
<font color="#CCCCCC">but the one that</font><font color="#E5E5E5"> I like</font><font color="#CCCCCC"> the most</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> to</font>

172
00:06:15,650 --> 00:06:20,090
do it via their public taxi servers

173
00:06:17,780 --> 00:06:22,789
<font color="#CCCCCC">listen</font><font color="#E5E5E5"> their API is to then access the</font>

174
00:06:20,090 --> 00:06:25,190
data in<font color="#CCCCCC"> sticks format so we built this</font>

175
00:06:22,790 --> 00:06:27,440
library on<font color="#CCCCCC"> the top of the two other</font>

176
00:06:25,190 --> 00:06:29,120
<font color="#CCCCCC">minor libraries that were out there for</font>

177
00:06:27,440 --> 00:06:31,130
the community<font color="#CCCCCC"> the reason why I built</font>

178
00:06:29,120 --> 00:06:33,620
mine was because I<font color="#E5E5E5"> wanted</font><font color="#CCCCCC"> to keep the</font>

179
00:06:31,130 --> 00:06:35,540
same naming<font color="#E5E5E5"> convention</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> you see on</font>

180
00:06:33,620 --> 00:06:37,310
the<font color="#CCCCCC"> website</font><font color="#E5E5E5"> when I collect all this data</font>

181
00:06:35,540 --> 00:06:38,810
<font color="#E5E5E5">because it sticks tend to change a</font>

182
00:06:37,310 --> 00:06:40,550
little bit<font color="#E5E5E5"> the</font><font color="#CCCCCC"> names</font><font color="#E5E5E5"> and all the stuff</font>

183
00:06:38,810 --> 00:06:42,770
and<font color="#CCCCCC"> instead of calling it</font><font color="#E5E5E5"> a technique</font>

184
00:06:40,550 --> 00:06:44,420
you might be calling<font color="#CCCCCC"> it</font><font color="#E5E5E5"> this attack</font>

185
00:06:42,770 --> 00:06:46,159
pattern so that's what I<font color="#E5E5E5"> like to keep</font>

186
00:06:44,420 --> 00:06:49,790
<font color="#CCCCCC">things more consistent</font><font color="#E5E5E5"> that's the only</font>

187
00:06:46,160 --> 00:06:50,990
reason why I built this tool this tool

188
00:06:49,790 --> 00:06:52,700
can<font color="#CCCCCC"> be installed</font><font color="#E5E5E5"> this is just for</font>

189
00:06:50,990 --> 00:06:55,580
reference<font color="#E5E5E5"> for you guys you can do</font><font color="#CCCCCC"> it via</font>

190
00:06:52,700 --> 00:06:57,560
<font color="#E5E5E5">tip from source and then after you do</font>

191
00:06:55,580 --> 00:07:00,260
that<font color="#E5E5E5"> you can</font><font color="#CCCCCC"> use Jupiter notebooks to</font>

192
00:06:57,560 --> 00:07:01,460
start manipulating the<font color="#CCCCCC"> tag data sources</font>

193
00:07:00,260 --> 00:07:03,620
all the information<font color="#CCCCCC"> that you</font><font color="#E5E5E5"> get</font><font color="#CCCCCC"> from</font>

194
00:07:01,460 --> 00:07:06,140
attack<font color="#E5E5E5"> and as you can</font><font color="#CCCCCC"> see it was</font><font color="#E5E5E5"> just</font>

195
00:07:03,620 --> 00:07:07,910
updated<font color="#E5E5E5"> yesterday after the</font><font color="#CCCCCC"> big</font><font color="#E5E5E5"> updates</font>

196
00:07:06,140 --> 00:07:10,490
<font color="#E5E5E5">some of the things broke in my scripts</font>

197
00:07:07,910 --> 00:07:11,930
<font color="#E5E5E5">so I had to do it again</font><font color="#CCCCCC"> and update it</font>

198
00:07:10,490 --> 00:07:14,120
<font color="#E5E5E5">but actually that helped a lot</font><font color="#CCCCCC"> for our</font>

199
00:07:11,930 --> 00:07:16,730
next conversation because<font color="#CCCCCC"> we were able</font>

200
00:07:14,120 --> 00:07:18,350
<font color="#E5E5E5">to put together and updated Jupiter</font>

201
00:07:16,730 --> 00:07:19,970
notebook with the<font color="#E5E5E5"> latest numbers from</font>

202
00:07:18,350 --> 00:07:24,020
<font color="#CCCCCC">Maya attack</font><font color="#E5E5E5"> especially from a data</font>

203
00:07:19,970 --> 00:07:27,140
source perspective<font color="#E5E5E5"> yeah so after</font>

204
00:07:24,020 --> 00:07:30,620
updating our you<font color="#CCCCCC"> could add</font><font color="#E5E5E5"> notebook we</font>

205
00:07:27,140 --> 00:07:34,070
found 478 techniques most<font color="#E5E5E5"> of them</font>

206
00:07:30,620 --> 00:07:36,350
actually<font color="#E5E5E5"> 259</font><font color="#CCCCCC"> do not have data sources</font>

207
00:07:34,070 --> 00:07:38,480
and this might be an opportunity<font color="#E5E5E5"> for us</font>

208
00:07:36,350 --> 00:07:40,850
<font color="#CCCCCC">to collaborate with</font><font color="#E5E5E5"> attack</font><font color="#CCCCCC"> teams or</font>

209
00:07:38,480 --> 00:07:42,650
maybe because<font color="#E5E5E5"> some of them do</font><font color="#CCCCCC"> not happen</font>

210
00:07:40,850 --> 00:07:46,570
inside your environment<font color="#E5E5E5"> where your</font>

211
00:07:42,650 --> 00:07:46,570
security<font color="#E5E5E5"> tools are collecting data</font><font color="#CCCCCC"> now</font>

212
00:07:47,110 --> 00:07:53,480
<font color="#CCCCCC">so if we group</font><font color="#E5E5E5"> all these techniques with</font>

213
00:07:50,540 --> 00:07:55,580
and without<font color="#E5E5E5"> data sources by matrix we</font>

214
00:07:53,480 --> 00:07:57,770
can<font color="#CCCCCC"> see on the</font><font color="#E5E5E5"> graph on</font><font color="#CCCCCC"> the right that</font>

215
00:07:55,580 --> 00:08:00,080
all the techniques<font color="#E5E5E5"> without data sources</font>

216
00:07:57,770 --> 00:08:02,000
<font color="#CCCCCC">most of them belong to</font><font color="#E5E5E5"> the pre attack</font>

217
00:08:00,080 --> 00:08:05,010
and the mobile attack<font color="#CCCCCC"> make</font>

218
00:08:02,000 --> 00:08:07,920
now something interesting<font color="#CCCCCC"> that</font><font color="#E5E5E5"> we found</font>

219
00:08:05,010 --> 00:08:10,469
<font color="#E5E5E5">here is</font><font color="#CCCCCC"> that there are four Enterprise</font>

220
00:08:07,920 --> 00:08:12,270
techniques that do not have<font color="#E5E5E5"> data sources</font>

221
00:08:10,470 --> 00:08:15,360
so<font color="#CCCCCC"> if you were</font><font color="#E5E5E5"> looking for something to</font>

222
00:08:12,270 --> 00:08:17,090
<font color="#CCCCCC">do this weekend this is the list of 1/4</font>

223
00:08:15,360 --> 00:08:19,200
<font color="#CCCCCC">tunisia do not have data sources</font>

224
00:08:17,090 --> 00:08:21,060
<font color="#E5E5E5">collaboration right there if you really</font>

225
00:08:19,200 --> 00:08:25,050
wanted<font color="#CCCCCC"> to do get</font><font color="#E5E5E5"> a commune</font><font color="#CCCCCC"> weekend yeah</font>

226
00:08:21,060 --> 00:08:27,030
<font color="#E5E5E5">there there yep now let's focus only on</font>

227
00:08:25,050 --> 00:08:29,370
those data on those techniques<font color="#E5E5E5"> that</font><font color="#CCCCCC"> do</font>

228
00:08:27,030 --> 00:08:32,039
<font color="#CCCCCC">though do and do ducks eatery that do</font>

229
00:08:29,370 --> 00:08:33,780
have<font color="#E5E5E5"> data sources so the</font><font color="#CCCCCC"> majority of</font>

230
00:08:32,039 --> 00:08:36,419
these techniques are covered by three

231
00:08:33,780 --> 00:08:39,240
data<font color="#E5E5E5"> sources process monitoring process</font>

232
00:08:36,419 --> 00:08:41,039
command line and fire monitoring so this

233
00:08:39,240 --> 00:08:43,580
might<font color="#CCCCCC"> be a good</font><font color="#E5E5E5"> start</font><font color="#CCCCCC"> if you want to</font>

234
00:08:41,039 --> 00:08:46,500
prioritize your data<font color="#E5E5E5"> collection process</font>

235
00:08:43,580 --> 00:08:48,210
another interesting thing I'd look in

236
00:08:46,500 --> 00:08:50,280
<font color="#E5E5E5">this graph is</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> there are some data</font>

237
00:08:48,210 --> 00:08:54,390
<font color="#E5E5E5">sources names that are related</font><font color="#CCCCCC"> to the</font>

238
00:08:50,280 --> 00:08:59,579
Windows platform<font color="#CCCCCC"> so let's analyze these</font>

239
00:08:54,390 --> 00:09:03,330
<font color="#CCCCCC">Windows data sources and please</font>

240
00:08:59,580 --> 00:09:06,480
exploiting all the analyzing<font color="#CCCCCC"> all every</font>

241
00:09:03,330 --> 00:09:09,120
data source that<font color="#CCCCCC"> is</font><font color="#E5E5E5"> mapped to a specific</font>

242
00:09:06,480 --> 00:09:12,120
technique<font color="#E5E5E5"> we can see that some of them</font>

243
00:09:09,120 --> 00:09:14,010
are related<font color="#E5E5E5"> to non Windows platform so</font>

244
00:09:12,120 --> 00:09:16,710
we<font color="#CCCCCC"> need to be careful if we want to</font><font color="#E5E5E5"> if</font>

245
00:09:14,010 --> 00:09:19,050
we<font color="#CCCCCC"> want to map and</font><font color="#E5E5E5"> a specific data</font>

246
00:09:16,710 --> 00:09:21,930
source to a specific technique the

247
00:09:19,050 --> 00:09:25,650
specific platform<font color="#CCCCCC"> they might be</font><font color="#E5E5E5"> some</font>

248
00:09:21,930 --> 00:09:28,410
information<font color="#CCCCCC"> that</font><font color="#E5E5E5"> doesn't make sense now</font>

249
00:09:25,650 --> 00:09:30,390
<font color="#E5E5E5">going back</font><font color="#CCCCCC"> to our graph</font><font color="#E5E5E5"> some of you</font>

250
00:09:28,410 --> 00:09:33,600
might be prioritizing your<font color="#E5E5E5"> data</font>

251
00:09:30,390 --> 00:09:35,550
collection<font color="#E5E5E5"> but considering the data</font>

252
00:09:33,600 --> 00:09:38,250
source that<font color="#E5E5E5"> covers most of the</font>

253
00:09:35,550 --> 00:09:41,459
techniques of<font color="#CCCCCC"> the attack framework</font><font color="#E5E5E5"> but</font>

254
00:09:38,250 --> 00:09:44,160
do we really<font color="#E5E5E5"> need only one data source</font>

255
00:09:41,460 --> 00:09:47,190
<font color="#E5E5E5">to validate the detection of a specific</font>

256
00:09:44,160 --> 00:09:49,230
technique well our next graph will help

257
00:09:47,190 --> 00:09:51,330
us to understand<font color="#CCCCCC"> or</font><font color="#E5E5E5"> to answer this</font>

258
00:09:49,230 --> 00:09:55,190
question<font color="#E5E5E5"> according</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> the my real attack</font>

259
00:09:51,330 --> 00:09:59,580
framework<font color="#E5E5E5"> only 19 techniques need</font>

260
00:09:55,190 --> 00:10:01,470
require one data source so the<font color="#CCCCCC"> other</font><font color="#E5E5E5"> 200</font>

261
00:09:59,580 --> 00:10:03,360
techniques require at least two data

262
00:10:01,470 --> 00:10:06,030
sources<font color="#CCCCCC"> so the number of data</font><font color="#E5E5E5"> sources</font>

263
00:10:03,360 --> 00:10:08,310
<font color="#CCCCCC">for us is related to</font><font color="#E5E5E5"> how much contest</font>

264
00:10:06,030 --> 00:10:09,839
you need to validate<font color="#CCCCCC"> the detection of a</font>

265
00:10:08,310 --> 00:10:11,670
technique<font color="#E5E5E5"> so we</font><font color="#CCCCCC"> are</font><font color="#E5E5E5"> not talking</font><font color="#CCCCCC"> about</font>

266
00:10:09,840 --> 00:10:13,939
<font color="#E5E5E5">just only one data source we're talking</font>

267
00:10:11,670 --> 00:10:16,429
about groups of<font color="#E5E5E5"> data sources</font>

268
00:10:13,939 --> 00:10:19,419
now here is the<font color="#E5E5E5"> list of the</font><font color="#CCCCCC"> top 15</font>

269
00:10:16,429 --> 00:10:21,889
groups of data sources<font color="#CCCCCC"> that the TAC team</font>

270
00:10:19,419 --> 00:10:24,529
recommends to work together in a

271
00:10:21,889 --> 00:10:27,019
specific<font color="#E5E5E5"> technique so you</font><font color="#CCCCCC"> can see here</font>

272
00:10:24,529 --> 00:10:29,089
the top<font color="#E5E5E5"> process command line process</font>

273
00:10:27,019 --> 00:10:32,779
<font color="#E5E5E5">monitoring and five honey</font><font color="#CCCCCC"> touring belong</font>

274
00:10:29,089 --> 00:10:34,489
to the top four<font color="#E5E5E5"> now we know that that</font><font color="#CCCCCC"> we</font>

275
00:10:32,779 --> 00:10:36,589
were talking<font color="#CCCCCC"> about these</font><font color="#E5E5E5"> data sources</font>

276
00:10:34,489 --> 00:10:38,509
<font color="#CCCCCC">before</font><font color="#E5E5E5"> but now we are</font><font color="#CCCCCC"> not</font><font color="#E5E5E5"> looking at</font>

277
00:10:36,589 --> 00:10:40,970
dangerous one by one we<font color="#E5E5E5"> are looking at</font>

278
00:10:38,509 --> 00:10:42,589
them as a<font color="#CCCCCC"> group of data sources</font><font color="#E5E5E5"> so for</font>

279
00:10:40,970 --> 00:10:45,559
<font color="#E5E5E5">example with five monitoring process</font>

280
00:10:42,589 --> 00:10:46,609
<font color="#CCCCCC">command line from</font><font color="#E5E5E5"> process monitoring</font>

281
00:10:45,559 --> 00:10:49,819
<font color="#E5E5E5">across the command line and five</font>

282
00:10:46,609 --> 00:10:53,059
monitoring you<font color="#CCCCCC"> can start analyzing</font>

283
00:10:49,819 --> 00:10:55,189
at least<font color="#CCCCCC"> 37</font><font color="#E5E5E5"> techniques but</font><font color="#CCCCCC"> there</font><font color="#E5E5E5"> has to</font>

284
00:10:53,059 --> 00:10:57,919
<font color="#CCCCCC">be as a group and not just</font><font color="#E5E5E5"> as one which</font>

285
00:10:55,189 --> 00:11:01,098
is the main point here<font color="#E5E5E5"> and this this can</font>

286
00:10:57,919 --> 00:11:04,189
be another way<font color="#E5E5E5"> to</font><font color="#CCCCCC"> prioritize your</font><font color="#E5E5E5"> data</font>

287
00:11:01,099 --> 00:11:05,689
collection<font color="#CCCCCC"> process all right so once we</font>

288
00:11:04,189 --> 00:11:07,189
learn a little bit into what<font color="#E5E5E5"> attack</font>

289
00:11:05,689 --> 00:11:09,139
actually<font color="#E5E5E5"> provides to us from a data</font>

290
00:11:07,189 --> 00:11:10,429
source perspective<font color="#CCCCCC"> then we want to</font><font color="#E5E5E5"> start</font>

291
00:11:09,139 --> 00:11:12,679
<font color="#E5E5E5">documenting</font><font color="#CCCCCC"> some of the things now that</font>

292
00:11:10,429 --> 00:11:15,199
<font color="#E5E5E5">we have in our environment let's pick</font>

293
00:11:12,679 --> 00:11:17,299
this technique right here<font color="#E5E5E5"> T 1 to 1 for</font>

294
00:11:15,199 --> 00:11:19,309
credential in registry<font color="#E5E5E5"> we do have this</font>

295
00:11:17,299 --> 00:11:21,289
attack data sources already defined for

296
00:11:19,309 --> 00:11:23,598
you the first<font color="#E5E5E5"> step you might be already</font>

297
00:11:21,289 --> 00:11:25,279
<font color="#E5E5E5">saying okay</font><font color="#CCCCCC"> if I want to detect this at</font>

298
00:11:23,599 --> 00:11:28,279
least validate the detection of<font color="#E5E5E5"> this</font>

299
00:11:25,279 --> 00:11:30,829
technique<font color="#CCCCCC"> I may use 468</font><font color="#E5E5E5"> because that</font>

300
00:11:28,279 --> 00:11:32,359
maps to<font color="#E5E5E5"> a process creation</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> the</font>

301
00:11:30,829 --> 00:11:34,159
reality is<font color="#E5E5E5"> that there is other events</font>

302
00:11:32,359 --> 00:11:36,949
that are part of process monitoring<font color="#E5E5E5"> in</font>

303
00:11:34,159 --> 00:11:38,959
this case for 689 you might have<font color="#CCCCCC"> other</font>

304
00:11:36,949 --> 00:11:40,758
data sets such<font color="#E5E5E5"> as system</font><font color="#CCCCCC"> only</font><font color="#E5E5E5"> process</font>

305
00:11:38,959 --> 00:11:43,279
creation<font color="#CCCCCC"> they give you more information</font>

306
00:11:40,759 --> 00:11:46,159
<font color="#E5E5E5">that probably</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> 60 days might provide</font>

307
00:11:43,279 --> 00:11:48,229
<font color="#CCCCCC">to you all the</font><font color="#E5E5E5"> way</font><font color="#CCCCCC"> up to for example</font><font color="#E5E5E5"> a</font>

308
00:11:46,159 --> 00:11:50,299
process accessing a process<font color="#E5E5E5"> so the main</font>

309
00:11:48,229 --> 00:11:52,189
<font color="#CCCCCC">goal in here is to understand what you</font>

310
00:11:50,299 --> 00:11:54,739
are getting<font color="#CCCCCC"> from the</font><font color="#E5E5E5"> data rather</font><font color="#CCCCCC"> than</font>

311
00:11:52,189 --> 00:11:56,478
say oh this gives me a process and then

312
00:11:54,739 --> 00:11:58,009
<font color="#E5E5E5">you say cool so we're</font><font color="#CCCCCC"> checked now you</font>

313
00:11:56,479 --> 00:12:00,799
have to understand how<font color="#CCCCCC"> that actually</font>

314
00:11:58,009 --> 00:12:02,329
works<font color="#CCCCCC"> and in order to do that the main</font>

315
00:12:00,799 --> 00:12:03,679
step in here is to start<font color="#E5E5E5"> creating data</font>

316
00:12:02,329 --> 00:12:05,659
dictionaries you have to understand

317
00:12:03,679 --> 00:12:08,539
exactly what each<font color="#E5E5E5"> event field provides</font>

318
00:12:05,659 --> 00:12:11,479
to you<font color="#E5E5E5"> and in this case we have to paint</font>

319
00:12:08,539 --> 00:12:14,079
<font color="#CCCCCC">81 so you have some ideas</font><font color="#E5E5E5"> this came from</font>

320
00:12:11,479 --> 00:12:16,399
<font color="#E5E5E5">also a research for from red teamers</font>

321
00:12:14,079 --> 00:12:18,049
<font color="#CCCCCC">Spector</font><font color="#E5E5E5"> odds Mac River and Lee</font>

322
00:12:16,399 --> 00:12:20,269
<font color="#CCCCCC">Christensen they talked</font><font color="#E5E5E5"> about a black</font>

323
00:12:18,049 --> 00:12:22,249
<font color="#E5E5E5">hat how they were</font><font color="#CCCCCC"> able to document</font><font color="#E5E5E5"> what</font>

324
00:12:20,269 --> 00:12:24,619
system provided to them and they were

325
00:12:22,249 --> 00:12:27,560
<font color="#CCCCCC">able to see which specific event fields</font>

326
00:12:24,619 --> 00:12:30,830
were a higher rent

327
00:12:27,560 --> 00:12:32,660
<font color="#CCCCCC">haier attacker influence rating</font><font color="#E5E5E5"> so these</font>

328
00:12:30,830 --> 00:12:34,400
are the specific<font color="#E5E5E5"> event fields that they</font>

329
00:12:32,660 --> 00:12:37,520
were sharing<font color="#E5E5E5"> that they could manipulate</font>

330
00:12:34,400 --> 00:12:39,439
<font color="#E5E5E5">and pretty much own so that's</font><font color="#CCCCCC"> very</font>

331
00:12:37,520 --> 00:12:40,790
important so<font color="#CCCCCC"> if</font><font color="#E5E5E5"> they</font><font color="#CCCCCC"> are</font><font color="#E5E5E5"> doing it we</font>

332
00:12:39,440 --> 00:12:41,990
should be<font color="#E5E5E5"> doing it as well if I haven't</font>

333
00:12:40,790 --> 00:12:44,810
<font color="#E5E5E5">convinced you yet to start documenting</font>

334
00:12:41,990 --> 00:12:46,760
<font color="#E5E5E5">your data the next step is to build a</font>

335
00:12:44,810 --> 00:12:48,560
data model<font color="#CCCCCC"> once you document all</font><font color="#E5E5E5"> the</font>

336
00:12:46,760 --> 00:12:50,330
stuff<font color="#E5E5E5"> this is because we want to define</font>

337
00:12:48,560 --> 00:12:51,949
<font color="#E5E5E5">the structure of the data and we want to</font>

338
00:12:50,330 --> 00:12:54,980
find<font color="#E5E5E5"> relationships</font><font color="#CCCCCC"> among</font><font color="#E5E5E5"> all these</font>

339
00:12:51,950 --> 00:12:56,660
<font color="#CCCCCC">different</font><font color="#E5E5E5"> data sets and mitre</font><font color="#CCCCCC"> started</font>

340
00:12:54,980 --> 00:12:59,390
their<font color="#CCCCCC"> own data model</font><font color="#E5E5E5"> and those are the</font>

341
00:12:56,660 --> 00:13:01,189
links<font color="#E5E5E5"> for car analytics and also the</font>

342
00:12:59,390 --> 00:13:04,240
specific cyber of several objects<font color="#E5E5E5"> that</font>

343
00:13:01,190 --> 00:13:06,440
they use information<font color="#CCCCCC"> so if you want</font><font color="#E5E5E5"> to</font>

344
00:13:04,240 --> 00:13:07,520
understand<font color="#E5E5E5"> it a little bit more go to</font>

345
00:13:06,440 --> 00:13:09,470
<font color="#E5E5E5">those</font><font color="#CCCCCC"> links</font><font color="#E5E5E5"> you're gonna have a lot</font><font color="#CCCCCC"> of</font>

346
00:13:07,520 --> 00:13:12,380
information<font color="#E5E5E5"> most of our research is</font>

347
00:13:09,470 --> 00:13:13,820
based on<font color="#E5E5E5"> data as well so when you start</font>

348
00:13:12,380 --> 00:13:15,890
talking<font color="#CCCCCC"> about</font><font color="#E5E5E5"> data</font><font color="#CCCCCC"> modeling you might be</font>

349
00:13:13,820 --> 00:13:18,380
thinking from<font color="#E5E5E5"> a</font><font color="#CCCCCC"> database perspective</font><font color="#E5E5E5"> ok</font>

350
00:13:15,890 --> 00:13:20,540
conceptual or the way to physical so

351
00:13:18,380 --> 00:13:22,880
basic entity relationships<font color="#E5E5E5"> all the way</font>

352
00:13:20,540 --> 00:13:25,520
to specific data types that you use to

353
00:13:22,880 --> 00:13:28,010
store<font color="#E5E5E5"> your data</font><font color="#CCCCCC"> ok so that's your for</font>

354
00:13:25,520 --> 00:13:29,750
those that have<font color="#CCCCCC"> that knowledge</font><font color="#E5E5E5"> but this</font>

355
00:13:28,010 --> 00:13:31,069
also applies to cyber threat

356
00:13:29,750 --> 00:13:33,740
intelligence all the way from a

357
00:13:31,070 --> 00:13:36,410
relational database perspective to some

358
00:13:33,740 --> 00:13:39,200
<font color="#CCCCCC">graph in that you can do with</font><font color="#E5E5E5"> data from</font>

359
00:13:36,410 --> 00:13:41,569
<font color="#E5E5E5">you know CGI and from here you can</font><font color="#CCCCCC"> then</font>

360
00:13:39,200 --> 00:13:44,089
go deeper and start getting information

361
00:13:41,570 --> 00:13:45,800
such as you<font color="#E5E5E5"> know properties or specific</font>

362
00:13:44,089 --> 00:13:48,740
adversary attributes<font color="#E5E5E5"> and things like</font>

363
00:13:45,800 --> 00:13:50,540
<font color="#E5E5E5">that</font><font color="#CCCCCC"> so why can't</font><font color="#E5E5E5"> we do that with the</font>

364
00:13:48,740 --> 00:13:53,720
event<font color="#E5E5E5"> logs we can start them</font><font color="#CCCCCC"> pulling</font>

365
00:13:50,540 --> 00:13:55,459
<font color="#E5E5E5">file a process a registry</font><font color="#CCCCCC"> a pipe</font><font color="#E5E5E5"> and</font>

366
00:13:53,720 --> 00:13:57,410
<font color="#E5E5E5">then to that they're going to be</font>

367
00:13:55,460 --> 00:13:59,360
relationships among<font color="#CCCCCC"> this specific data</font>

368
00:13:57,410 --> 00:14:01,160
objects<font color="#E5E5E5"> you're gonna find properties</font>

369
00:13:59,360 --> 00:14:03,050
attributes to<font color="#E5E5E5"> these specific</font><font color="#CCCCCC"> data</font>

370
00:14:01,160 --> 00:14:04,969
objects<font color="#E5E5E5"> and if you document your</font><font color="#CCCCCC"> data</font>

371
00:14:03,050 --> 00:14:07,280
you might<font color="#E5E5E5"> find a specific</font><font color="#CCCCCC"> relationships</font>

372
00:14:04,970 --> 00:14:08,990
already defined for you that you have to

373
00:14:07,280 --> 00:14:10,910
use in<font color="#E5E5E5"> order to do these correlations</font>

374
00:14:08,990 --> 00:14:13,700
what we're talking<font color="#CCCCCC"> about</font><font color="#E5E5E5"> joining queries</font>

375
00:14:10,910 --> 00:14:15,829
we're talking about<font color="#CCCCCC"> concept</font><font color="#E5E5E5"> of sequences</font>

376
00:14:13,700 --> 00:14:17,600
of<font color="#CCCCCC"> events you have to</font><font color="#E5E5E5"> document</font><font color="#CCCCCC"> your data</font>

377
00:14:15,830 --> 00:14:20,030
and it start modeling so you understand

378
00:14:17,600 --> 00:14:21,050
what that<font color="#E5E5E5"> actually</font><font color="#CCCCCC"> looks like the idea</font>

379
00:14:20,030 --> 00:14:23,630
<font color="#E5E5E5">at the</font><font color="#CCCCCC"> end is to</font><font color="#E5E5E5"> start building</font>

380
00:14:21,050 --> 00:14:25,640
<font color="#E5E5E5">something</font><font color="#CCCCCC"> like this where sis</font><font color="#E5E5E5"> Mon can be</font>

381
00:14:23,630 --> 00:14:27,890
instead<font color="#CCCCCC"> of showing all this</font><font color="#E5E5E5"> beautiful</font>

382
00:14:25,640 --> 00:14:30,890
event IDs<font color="#E5E5E5"> now you can start showing that</font>

383
00:14:27,890 --> 00:14:33,140
in a relationship<font color="#CCCCCC"> way</font><font color="#E5E5E5"> between</font><font color="#CCCCCC"> a process</font>

384
00:14:30,890 --> 00:14:35,689
creating a process<font color="#CCCCCC"> a registry a file</font>

385
00:14:33,140 --> 00:14:36,980
connecting<font color="#E5E5E5"> to a pipe so you have to be</font>

386
00:14:35,690 --> 00:14:38,600
able<font color="#E5E5E5"> to understand your</font><font color="#CCCCCC"> data this way</font>

387
00:14:36,980 --> 00:14:41,950
because<font color="#E5E5E5"> this is going to help you later</font>

388
00:14:38,600 --> 00:14:41,950
to build your data analytics

389
00:14:43,040 --> 00:14:48,660
so after documenting all<font color="#CCCCCC"> the</font>

390
00:14:46,260 --> 00:14:52,110
relationship between our data objects<font color="#E5E5E5"> we</font>

391
00:14:48,660 --> 00:14:54,779
kind of start defining sub data<font color="#E5E5E5"> sub data</font>

392
00:14:52,110 --> 00:14:58,050
sources<font color="#E5E5E5"> that will help us - that will</font>

393
00:14:54,779 --> 00:15:01,589
<font color="#E5E5E5">give us more details and information</font>

394
00:14:58,050 --> 00:15:03,329
about<font color="#E5E5E5"> each attached data source and</font>

395
00:15:01,589 --> 00:15:05,130
<font color="#CCCCCC">we'll give you will give us the</font>

396
00:15:03,330 --> 00:15:09,029
relationship<font color="#E5E5E5"> between an</font><font color="#CCCCCC"> acog data source</font>

397
00:15:05,130 --> 00:15:11,220
and data model<font color="#E5E5E5"> so after that you can</font>

398
00:15:09,029 --> 00:15:12,750
<font color="#E5E5E5">start backing up each specific sub data</font>

399
00:15:11,220 --> 00:15:14,250
source<font color="#CCCCCC"> we're talking about sub</font>

400
00:15:12,750 --> 00:15:15,779
techniques but I believe<font color="#CCCCCC"> that in order</font>

401
00:15:14,250 --> 00:15:17,640
<font color="#E5E5E5">to accomplish that</font><font color="#CCCCCC"> you have to</font>

402
00:15:15,779 --> 00:15:19,860
understand how the data will define what

403
00:15:17,640 --> 00:15:21,720
it is<font color="#CCCCCC"> that you can detect so in here</font><font color="#E5E5E5"> we</font>

404
00:15:19,860 --> 00:15:24,810
can pretty<font color="#E5E5E5"> much apply our basic model</font>

405
00:15:21,720 --> 00:15:26,490
<font color="#E5E5E5">and start putting together what what a</font>

406
00:15:24,810 --> 00:15:28,709
sub data source actually<font color="#E5E5E5"> means from a</font>

407
00:15:26,490 --> 00:15:30,120
logic perspective and at the end you can

408
00:15:28,709 --> 00:15:32,219
<font color="#E5E5E5">do the same thing with Windows registry</font>

409
00:15:30,120 --> 00:15:34,620
for example and something very

410
00:15:32,220 --> 00:15:36,480
interested in here is<font color="#E5E5E5"> that that's what</font>

411
00:15:34,620 --> 00:15:39,920
system provides to you<font color="#CCCCCC"> right</font><font color="#E5E5E5"> process to</font>

412
00:15:36,480 --> 00:15:43,050
a registry but system does not give you

413
00:15:39,920 --> 00:15:44,819
<font color="#E5E5E5">that's not give you user to a registry</font>

414
00:15:43,050 --> 00:15:46,979
relationship you have<font color="#E5E5E5"> to do that with</font>

415
00:15:44,820 --> 00:15:48,480
security<font color="#CCCCCC"> unlocks</font><font color="#E5E5E5"> so that's very</font>

416
00:15:46,980 --> 00:15:50,010
important because<font color="#E5E5E5"> you might just</font><font color="#CCCCCC"> be</font>

417
00:15:48,480 --> 00:15:52,709
stuck in<font color="#CCCCCC"> here and then when you try to</font>

418
00:15:50,010 --> 00:15:54,510
<font color="#E5E5E5">come up with this next analytic to to</font>

419
00:15:52,709 --> 00:15:56,339
<font color="#CCCCCC">start identifying users doing all these</font>

420
00:15:54,510 --> 00:15:57,930
<font color="#CCCCCC">behaviors you won't be able</font><font color="#E5E5E5"> to do it</font>

421
00:15:56,339 --> 00:16:00,209
with<font color="#E5E5E5"> this</font><font color="#CCCCCC"> one</font><font color="#E5E5E5"> so you have</font><font color="#CCCCCC"> to understand</font>

422
00:15:57,930 --> 00:16:02,609
what events are<font color="#E5E5E5"> going to provide</font><font color="#CCCCCC"> that to</font>

423
00:16:00,209 --> 00:16:05,670
you the idea the<font color="#CCCCCC"> end is to</font><font color="#E5E5E5"> start</font>

424
00:16:02,610 --> 00:16:07,860
creating this whole<font color="#E5E5E5"> mapping right and</font>

425
00:16:05,670 --> 00:16:09,930
before<font color="#CCCCCC"> we were talking</font><font color="#E5E5E5"> about all the way</font>

426
00:16:07,860 --> 00:16:13,200
from a technique<font color="#E5E5E5"> to attack data sources</font>

427
00:16:09,930 --> 00:16:17,069
<font color="#E5E5E5">to sub data sources with this specific</font>

428
00:16:13,200 --> 00:16:20,250
model<font color="#E5E5E5"> then once I do this then this to</font>

429
00:16:17,070 --> 00:16:22,950
me<font color="#CCCCCC"> makes sense</font><font color="#E5E5E5"> it's not</font><font color="#CCCCCC"> anymore</font><font color="#E5E5E5"> based on</font>

430
00:16:20,250 --> 00:16:25,200
feelings<font color="#CCCCCC"> based on expertise and saying</font><font color="#E5E5E5"> I</font>

431
00:16:22,950 --> 00:16:27,750
know this tool gives<font color="#CCCCCC"> me this</font><font color="#E5E5E5"> yeah I work</font>

432
00:16:25,200 --> 00:16:29,760
with<font color="#CCCCCC"> this were covered with registry you</font>

433
00:16:27,750 --> 00:16:31,200
buy this tool what good they say that

434
00:16:29,760 --> 00:16:33,660
they<font color="#E5E5E5"> cover process monitoring</font><font color="#CCCCCC"> wait a</font>

435
00:16:31,200 --> 00:16:35,430
minute what specific sub data sources of

436
00:16:33,660 --> 00:16:37,620
my process<font color="#E5E5E5"> monitoring are you covering</font>

437
00:16:35,430 --> 00:16:39,510
<font color="#CCCCCC">are you covering only process creation</font>

438
00:16:37,620 --> 00:16:43,470
<font color="#E5E5E5">or you're going all the way to a process</font>

439
00:16:39,510 --> 00:16:45,600
accessing a process correct so going

440
00:16:43,470 --> 00:16:49,230
back<font color="#CCCCCC"> to our top 15 groups of data</font>

441
00:16:45,600 --> 00:16:51,540
sources<font color="#CCCCCC"> let's</font><font color="#E5E5E5"> speak the second the</font>

442
00:16:49,230 --> 00:16:53,380
second one which<font color="#E5E5E5"> which contains</font><font color="#CCCCCC"> five</font>

443
00:16:51,540 --> 00:16:56,800
monitoring and process

444
00:16:53,380 --> 00:17:02,260
this pair<font color="#E5E5E5"> of data sources are</font><font color="#CCCCCC"> together</font>

445
00:16:56,800 --> 00:17:05,169
<font color="#CCCCCC">in at</font><font color="#E5E5E5"> least 68 techniques so applying</font>

446
00:17:02,260 --> 00:17:07,720
<font color="#CCCCCC">about methodology</font><font color="#E5E5E5"> you can see here the</font>

447
00:17:05,170 --> 00:17:10,510
<font color="#E5E5E5">relationship between attacked an attack</font>

448
00:17:07,720 --> 00:17:13,240
data source<font color="#E5E5E5"> sub data sources and event</font>

449
00:17:10,510 --> 00:17:17,579
logs<font color="#E5E5E5"> now the question here</font><font color="#CCCCCC"> is do we need</font>

450
00:17:13,240 --> 00:17:20,470
<font color="#E5E5E5">to collect all these event logs so the</font>

451
00:17:17,579 --> 00:17:21,879
<font color="#CCCCCC">answer is it depends</font><font color="#E5E5E5"> of the technique</font><font color="#CCCCCC"> or</font>

452
00:17:20,470 --> 00:17:23,800
the<font color="#E5E5E5"> variation that technique that you</font>

453
00:17:21,880 --> 00:17:27,280
are analyzing<font color="#CCCCCC"> so in this case for</font>

454
00:17:23,800 --> 00:17:29,860
<font color="#CCCCCC">example</font><font color="#E5E5E5"> we</font><font color="#CCCCCC"> are only considering</font><font color="#E5E5E5"> four sub</font>

455
00:17:27,280 --> 00:17:31,928
data sources and<font color="#CCCCCC"> four even logs</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> this</font>

456
00:17:29,860 --> 00:17:35,580
for us is<font color="#CCCCCC"> a good example of being</font>

457
00:17:31,929 --> 00:17:36,820
effective<font color="#CCCCCC"> in our data collection</font><font color="#E5E5E5"> process</font>

458
00:17:35,580 --> 00:17:38,620
yep

459
00:17:36,820 --> 00:17:40,870
so the via the end I know that a lot<font color="#CCCCCC"> of</font>

460
00:17:38,620 --> 00:17:43,300
you<font color="#E5E5E5"> might not like you know</font><font color="#CCCCCC"> excel</font><font color="#E5E5E5"> sheets</font>

461
00:17:40,870 --> 00:17:44,979
<font color="#E5E5E5">right but this is very easy to keep</font>

462
00:17:43,300 --> 00:17:47,110
track<font color="#CCCCCC"> of this</font><font color="#E5E5E5"> word excel sheet if you</font>

463
00:17:44,980 --> 00:17:49,090
<font color="#E5E5E5">want to now be a little bit more</font><font color="#CCCCCC"> dynamic</font>

464
00:17:47,110 --> 00:17:51,309
and<font color="#CCCCCC"> it started using some like text</font>

465
00:17:49,090 --> 00:17:52,780
search functionality top<font color="#E5E5E5"> I can push this</font>

466
00:17:51,309 --> 00:17:54,040
to an<font color="#E5E5E5"> L stack and just give</font><font color="#CCCCCC"> it to you</font>

467
00:17:52,780 --> 00:17:55,629
which is<font color="#CCCCCC"> gonna happen after</font><font color="#E5E5E5"> this</font>

468
00:17:54,040 --> 00:17:57,580
<font color="#CCCCCC">presentation I</font><font color="#E5E5E5"> was thinking about that</font>

469
00:17:55,630 --> 00:18:01,120
<font color="#CCCCCC">how can</font><font color="#E5E5E5"> I not show an expression sheet</font>

470
00:17:57,580 --> 00:18:03,428
and show an elastic dashboard<font color="#E5E5E5"> so this is</font>

471
00:18:01,120 --> 00:18:04,989
going<font color="#E5E5E5"> to be available in awesome this is</font>

472
00:18:03,429 --> 00:18:07,300
our new logo by the way because we love

473
00:18:04,990 --> 00:18:10,000
animals<font color="#CCCCCC"> so we like to put</font><font color="#E5E5E5"> together like</font>

474
00:18:07,300 --> 00:18:11,860
<font color="#E5E5E5">a little logo for each project that we</font>

475
00:18:10,000 --> 00:18:13,720
work on<font color="#E5E5E5"> and this is going to have you</font>

476
00:18:11,860 --> 00:18:15,669
<font color="#E5E5E5">know data dictionaries the whole data</font>

477
00:18:13,720 --> 00:18:17,290
model aspect attack data sources<font color="#CCCCCC"> mapped</font>

478
00:18:15,670 --> 00:18:19,030
<font color="#CCCCCC">a specific event IDs and things like</font>

479
00:18:17,290 --> 00:18:21,159
that but not<font color="#CCCCCC"> just</font><font color="#E5E5E5"> the direct</font>

480
00:18:19,030 --> 00:18:22,389
relationship<font color="#E5E5E5"> between attack data source</font>

481
00:18:21,160 --> 00:18:24,700
and event ID we're<font color="#E5E5E5"> going to show you</font>

482
00:18:22,390 --> 00:18:26,530
what happens between<font color="#E5E5E5"> that relationship</font>

483
00:18:24,700 --> 00:18:29,050
and why we<font color="#CCCCCC"> believe it should be that</font><font color="#E5E5E5"> way</font>

484
00:18:26,530 --> 00:18:31,059
<font color="#CCCCCC">we have at least</font><font color="#E5E5E5"> I</font><font color="#CCCCCC"> think a hundred</font><font color="#E5E5E5"> event</font>

485
00:18:29,050 --> 00:18:32,290
logs<font color="#E5E5E5"> with relationships that we have in</font>

486
00:18:31,059 --> 00:18:33,550
there<font color="#E5E5E5"> and that's</font><font color="#CCCCCC"> going to keep growing</font>

487
00:18:32,290 --> 00:18:35,409
<font color="#CCCCCC">and growing</font><font color="#E5E5E5"> and of course with a</font>

488
00:18:33,550 --> 00:18:38,470
community<font color="#E5E5E5"> as a community both</font><font color="#CCCCCC"> and that</font>

489
00:18:35,410 --> 00:18:40,630
<font color="#CCCCCC">will be nice to expand it so we're</font><font color="#E5E5E5"> gonna</font>

490
00:18:38,470 --> 00:18:42,490
show how that's<font color="#E5E5E5"> actually helpful for</font>

491
00:18:40,630 --> 00:18:44,770
your three hunting operations<font color="#E5E5E5"> everybody</font>

492
00:18:42,490 --> 00:18:46,570
has their own<font color="#E5E5E5"> procedures once again</font>

493
00:18:44,770 --> 00:18:48,010
right there<font color="#CCCCCC"> is different ways that you</font>

494
00:18:46,570 --> 00:18:51,250
<font color="#E5E5E5">can do this but this presentation</font>

495
00:18:48,010 --> 00:18:53,260
<font color="#E5E5E5">focused a lot</font><font color="#CCCCCC"> into where data might fit</font>

496
00:18:51,250 --> 00:18:54,610
and I think that what we talked<font color="#CCCCCC"> about in</font>

497
00:18:53,260 --> 00:18:56,830
here from a documentation<font color="#CCCCCC"> and data</font>

498
00:18:54,610 --> 00:18:58,600
modeling perspective<font color="#E5E5E5"> happens before you</font>

499
00:18:56,830 --> 00:19:00,040
even build your data analytics<font color="#E5E5E5"> because</font>

500
00:18:58,600 --> 00:19:01,870
<font color="#E5E5E5">you have to understand what it is that</font>

501
00:19:00,040 --> 00:19:03,850
<font color="#CCCCCC">you need before</font><font color="#E5E5E5"> you build your data</font>

502
00:19:01,870 --> 00:19:06,668
analytics<font color="#E5E5E5"> and this happens of course</font>

503
00:19:03,850 --> 00:19:08,500
<font color="#CCCCCC">after a simulation so for those</font>

504
00:19:06,669 --> 00:19:11,049
great companies<font color="#CCCCCC"> ain't</font><font color="#E5E5E5"> game</font><font color="#CCCCCC"> & Wrekin re</font>

505
00:19:08,500 --> 00:19:12,640
building<font color="#E5E5E5"> their own simulation tools it's</font>

506
00:19:11,049 --> 00:19:15,340
<font color="#E5E5E5">awesome because you</font><font color="#CCCCCC"> can then</font><font color="#E5E5E5"> have that</font>

507
00:19:12,640 --> 00:19:17,890
<font color="#E5E5E5">data model it documented</font><font color="#CCCCCC"> and then build</font>

508
00:19:15,340 --> 00:19:20,139
your data analytics<font color="#E5E5E5"> and before you</font>

509
00:19:17,890 --> 00:19:21,850
execute<font color="#CCCCCC"> a hunt you have to then with</font>

510
00:19:20,140 --> 00:19:24,010
that<font color="#CCCCCC"> information</font><font color="#E5E5E5"> do some type of</font>

511
00:19:21,850 --> 00:19:25,928
completeness<font color="#CCCCCC"> you know data quality</font>

512
00:19:24,010 --> 00:19:27,970
assessments<font color="#E5E5E5"> how much data do I have now</font>

513
00:19:25,929 --> 00:19:29,470
that<font color="#E5E5E5"> I want to go in production that</font>

514
00:19:27,970 --> 00:19:31,659
will define how successful you will be

515
00:19:29,470 --> 00:19:33,820
<font color="#E5E5E5">in your trade hunting engagements so</font>

516
00:19:31,659 --> 00:19:37,210
keep<font color="#E5E5E5"> that in</font><font color="#CCCCCC"> mind when you talk about</font>

517
00:19:33,820 --> 00:19:39,460
data make it<font color="#E5E5E5"> a big point in your program</font>

518
00:19:37,210 --> 00:19:41,620
think about it<font color="#E5E5E5"> document it and it will</font>

519
00:19:39,460 --> 00:19:43,000
<font color="#CCCCCC">be really</font><font color="#E5E5E5"> helpful so we're going to do</font>

520
00:19:41,620 --> 00:19:45,610
one example in here

521
00:19:43,000 --> 00:19:47,409
and we're gonna pick<font color="#CCCCCC"> as the hatch that</font>

522
00:19:45,610 --> 00:19:50,019
was actually<font color="#E5E5E5"> perfect to be here since I</font>

523
00:19:47,409 --> 00:19:52,419
can point<font color="#E5E5E5"> it out and pass the</font><font color="#CCCCCC"> hatch in</font>

524
00:19:50,019 --> 00:19:55,240
general<font color="#CCCCCC"> just a basic sister</font><font color="#E5E5E5"> Knauth</font><font color="#CCCCCC"> ntk -</font>

525
00:19:52,419 --> 00:19:56,139
you know<font color="#CCCCCC"> - a resource by using</font><font color="#E5E5E5"> up just a</font>

526
00:19:55,240 --> 00:19:58,149
hash or a key

527
00:19:56,139 --> 00:20:00,908
so without typing your credentials and

528
00:19:58,149 --> 00:20:02,678
there is some variations<font color="#E5E5E5"> there's one</font>

529
00:20:00,909 --> 00:20:04,450
called<font color="#E5E5E5"> overpass the hash this is just</font>

530
00:20:02,679 --> 00:20:05,799
based on Kerberos authentication<font color="#CCCCCC"> I'll</font>

531
00:20:04,450 --> 00:20:07,210
talk to<font color="#E5E5E5"> you a little bit in with my</font>

532
00:20:05,799 --> 00:20:09,668
<font color="#CCCCCC">one-minute</font><font color="#E5E5E5"> definition what it is</font>

533
00:20:07,210 --> 00:20:12,190
actually<font color="#CCCCCC"> less than</font><font color="#E5E5E5"> minute and then it's</font>

534
00:20:09,669 --> 00:20:13,899
just<font color="#E5E5E5"> based on tickets and keys and then</font>

535
00:20:12,190 --> 00:20:16,149
the idea here<font color="#CCCCCC"> is how you can take</font><font color="#E5E5E5"> a hash</font>

536
00:20:13,899 --> 00:20:17,979
of a password and<font color="#E5E5E5"> then upgrade it to a</font>

537
00:20:16,149 --> 00:20:20,260
<font color="#E5E5E5">ticket it's gonna make sense in a little</font>

538
00:20:17,980 --> 00:20:22,419
bit so Kerberos<font color="#CCCCCC"> syndication here the</font>

539
00:20:20,260 --> 00:20:24,610
basics you type your<font color="#E5E5E5"> password you can</font>

540
00:20:22,419 --> 00:20:27,250
<font color="#CCCCCC">stash multiple keys get created</font>

541
00:20:24,610 --> 00:20:29,740
<font color="#E5E5E5">depending on the functionality of your</font>

542
00:20:27,250 --> 00:20:32,649
<font color="#E5E5E5">domain you can take that hash or that</font>

543
00:20:29,740 --> 00:20:35,230
key<font color="#E5E5E5"> and then request a ticket you get a</font>

544
00:20:32,649 --> 00:20:36,760
ticket<font color="#CCCCCC"> because they validated</font><font color="#E5E5E5"> that it is</font>

545
00:20:35,230 --> 00:20:38,200
who<font color="#CCCCCC"> you say you are</font><font color="#E5E5E5"> that you want who</font>

546
00:20:36,760 --> 00:20:40,210
you<font color="#E5E5E5"> say you are and then with</font><font color="#CCCCCC"> that</font>

547
00:20:38,200 --> 00:20:42,490
ticket<font color="#CCCCCC"> you can access other service</font>

548
00:20:40,210 --> 00:20:43,870
tickets to<font color="#E5E5E5"> access all</font><font color="#CCCCCC"> the resources</font><font color="#E5E5E5"> like</font>

549
00:20:42,490 --> 00:20:46,029
<font color="#CCCCCC">a file share or you know things like</font>

550
00:20:43,870 --> 00:20:47,768
<font color="#E5E5E5">that that's the basics of Kerberos</font>

551
00:20:46,029 --> 00:20:51,279
authentication<font color="#CCCCCC"> there is of course</font><font color="#E5E5E5"> more</font>

552
00:20:47,769 --> 00:20:53,529
about this<font color="#CCCCCC"> over pass the hash avoids the</font>

553
00:20:51,279 --> 00:20:55,659
first step which<font color="#CCCCCC"> is do not</font><font color="#E5E5E5"> provide you</font>

554
00:20:53,529 --> 00:20:57,159
know they don't<font color="#E5E5E5"> provide a clear text</font>

555
00:20:55,659 --> 00:20:59,769
<font color="#CCCCCC">password if the attacker steals that</font>

556
00:20:57,159 --> 00:21:01,929
hash or that key<font color="#E5E5E5"> they can do this whole</font>

557
00:20:59,769 --> 00:21:04,240
requesting of a ticket<font color="#E5E5E5"> then getting a</font>

558
00:21:01,929 --> 00:21:05,649
service<font color="#CCCCCC"> ticket and things</font><font color="#E5E5E5"> like</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> so</font>

559
00:21:04,240 --> 00:21:07,240
let's just<font color="#E5E5E5"> take a look at mimikatz</font>

560
00:21:05,649 --> 00:21:09,459
because they can do<font color="#E5E5E5"> that right and this</font>

561
00:21:07,240 --> 00:21:11,340
is not new this<font color="#E5E5E5"> has happened a long time</font>

562
00:21:09,460 --> 00:21:14,080
actually<font color="#E5E5E5"> did a blog</font><font color="#CCCCCC"> post</font><font color="#E5E5E5"> about this and</font>

563
00:21:11,340 --> 00:21:16,720
what it does it creates a new process

564
00:21:14,080 --> 00:21:20,178
with fake credentials<font color="#E5E5E5"> then it patches</font>

565
00:21:16,720 --> 00:21:21,649
<font color="#E5E5E5">alsace with the key</font><font color="#CCCCCC"> that are stole</font>

566
00:21:20,179 --> 00:21:23,480
and then you can start pretty much

567
00:21:21,649 --> 00:21:27,018
impersonating and accessing resources

568
00:21:23,480 --> 00:21:29,480
that the<font color="#CCCCCC"> users a</font><font color="#E5E5E5"> key actually has access</font>

569
00:21:27,019 --> 00:21:31,429
to so in this<font color="#E5E5E5"> demo we have</font><font color="#CCCCCC"> mimicked</font><font color="#E5E5E5"> ads</font>

570
00:21:29,480 --> 00:21:34,220
<font color="#E5E5E5">we have our account Pedro it's actually</font>

571
00:21:31,429 --> 00:21:37,009
my dog's name<font color="#CCCCCC"> and we have a hash and we</font>

572
00:21:34,220 --> 00:21:38,899
have a target<font color="#E5E5E5"> this is</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> victim and is</font>

573
00:21:37,009 --> 00:21:41,330
running<font color="#E5E5E5"> as admin and we have the target</font>

574
00:21:38,899 --> 00:21:43,639
and if we pretty much check who we are

575
00:21:41,330 --> 00:21:45,860
right<font color="#E5E5E5"> which is basic C Brown</font><font color="#CCCCCC"> it's just</font>

576
00:21:43,639 --> 00:21:48,049
another user and<font color="#CCCCCC"> we try to</font><font color="#E5E5E5"> access the</font>

577
00:21:45,860 --> 00:21:49,699
domain controller or just any<font color="#E5E5E5"> other</font>

578
00:21:48,049 --> 00:21:53,389
server that the user does not<font color="#E5E5E5"> have</font>

579
00:21:49,700 --> 00:21:56,360
<font color="#E5E5E5">access to access</font><font color="#CCCCCC"> deny basic</font><font color="#E5E5E5"> stuff but</font>

580
00:21:53,389 --> 00:21:58,969
<font color="#CCCCCC">then what I</font><font color="#E5E5E5"> can do is start using</font>

581
00:21:56,360 --> 00:22:01,129
<font color="#CCCCCC">mimikatz</font><font color="#E5E5E5"> over pass the hash in order to</font>

582
00:21:58,970 --> 00:22:05,360
access these<font color="#CCCCCC"> resources that are one</font>

583
00:22:01,129 --> 00:22:07,100
because now I have Pedro's hash so we

584
00:22:05,360 --> 00:22:09,559
just copy<font color="#CCCCCC"> and paste that</font><font color="#E5E5E5"> command</font><font color="#CCCCCC"> and</font>

585
00:22:07,100 --> 00:22:11,480
<font color="#E5E5E5">then we can see that</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> first a fake</font>

586
00:22:09,559 --> 00:22:13,639
process gets created fake credentials

587
00:22:11,480 --> 00:22:17,090
<font color="#E5E5E5">are there first then the hash gets</font>

588
00:22:13,639 --> 00:22:20,779
<font color="#CCCCCC">patched to 12 sighs so now if we</font><font color="#E5E5E5"> do</font>

589
00:22:17,090 --> 00:22:22,490
another<font color="#CCCCCC"> Who am I in</font><font color="#E5E5E5"> this process we</font>

590
00:22:20,779 --> 00:22:25,970
still see<font color="#CCCCCC"> Brown</font><font color="#E5E5E5"> where it's still the</font>

591
00:22:22,490 --> 00:22:28,999
user but<font color="#E5E5E5"> now we try</font><font color="#CCCCCC"> to access the domain</font>

592
00:22:25,970 --> 00:22:31,820
controller<font color="#CCCCCC"> again for example then we can</font>

593
00:22:28,999 --> 00:22:33,350
see<font color="#E5E5E5"> that it was successful so</font><font color="#CCCCCC"> this</font>

594
00:22:31,820 --> 00:22:34,908
<font color="#E5E5E5">attack is</font><font color="#CCCCCC"> very interesting</font><font color="#E5E5E5"> right</font><font color="#CCCCCC"> because</font>

595
00:22:33,350 --> 00:22:37,369
you can use impersonate somebody but

596
00:22:34,909 --> 00:22:38,840
without using<font color="#CCCCCC"> those credentials</font><font color="#E5E5E5"> and</font>

597
00:22:37,369 --> 00:22:40,789
<font color="#E5E5E5">let's start using this methodology a</font>

598
00:22:38,840 --> 00:22:42,320
little bit so we start getting<font color="#E5E5E5"> all these</font>

599
00:22:40,789 --> 00:22:44,629
event<font color="#CCCCCC"> lots and in this</font><font color="#E5E5E5"> case we're</font>

600
00:22:42,320 --> 00:22:47,480
getting a process calling a service with

601
00:22:44,629 --> 00:22:50,149
privilege<font color="#E5E5E5"> of you know with with specific</font>

602
00:22:47,480 --> 00:22:52,009
service privileges we can see Elsa is

603
00:22:50,149 --> 00:22:55,389
doing the same<font color="#CCCCCC"> thing and in</font><font color="#E5E5E5"> this case is</font>

604
00:22:52,009 --> 00:22:58,549
because<font color="#E5E5E5"> Elsa's is getting ready</font><font color="#CCCCCC"> to start</font>

605
00:22:55,389 --> 00:23:00,229
<font color="#E5E5E5">managing this Kerberos authentication</font><font color="#CCCCCC"> we</font>

606
00:22:58,549 --> 00:23:03,590
see a user authenticating to a<font color="#E5E5E5"> host</font>

607
00:23:00,230 --> 00:23:06,590
<font color="#E5E5E5">locally</font><font color="#CCCCCC"> it's because C Brown now has a</font>

608
00:23:03,590 --> 00:23:08,689
new<font color="#CCCCCC"> logon</font><font color="#E5E5E5"> process with other credentials</font>

609
00:23:06,590 --> 00:23:10,730
<font color="#E5E5E5">are going to be used over the network</font><font color="#CCCCCC"> so</font>

610
00:23:08,690 --> 00:23:12,799
<font color="#E5E5E5">we have C Brown and then we have Pedro</font>

611
00:23:10,730 --> 00:23:14,690
<font color="#E5E5E5">there that the mom and the user</font><font color="#CCCCCC"> accesses</font>

612
00:23:12,799 --> 00:23:17,450
is a resource on the network then<font color="#E5E5E5"> it's</font>

613
00:23:14,690 --> 00:23:18,889
going<font color="#E5E5E5"> to use federal tensions and then</font>

614
00:23:17,450 --> 00:23:22,490
of course what<font color="#CCCCCC"> mimickers does best</font>

615
00:23:18,889 --> 00:23:26,119
access<font color="#CCCCCC"> else's</font><font color="#E5E5E5"> and you can you know patch</font>

616
00:23:22,490 --> 00:23:28,100
the specific key to Alsace and<font color="#E5E5E5"> then</font><font color="#CCCCCC"> the</font>

617
00:23:26,119 --> 00:23:30,080
NL<font color="#CCCCCC"> SAS gets ready to</font><font color="#E5E5E5"> start doing</font><font color="#CCCCCC"> this</font>

618
00:23:28,100 --> 00:23:32,719
<font color="#E5E5E5">authentication so our process binding to</font>

619
00:23:30,080 --> 00:23:33,439
<font color="#E5E5E5">app or a process</font><font color="#CCCCCC"> connecting to an IP</font>

620
00:23:32,720 --> 00:23:34,970
<font color="#CCCCCC">VNS</font>

621
00:23:33,440 --> 00:23:36,379
Pacific<font color="#E5E5E5"> pour so now we're kind</font><font color="#CCCCCC"> of like</font>

622
00:23:34,970 --> 00:23:38,740
<font color="#E5E5E5">telling</font><font color="#CCCCCC"> the story a little bit just</font>

623
00:23:36,379 --> 00:23:41,178
using<font color="#E5E5E5"> our data modeling concepts and</font>

624
00:23:38,740 --> 00:23:43,399
then this is<font color="#E5E5E5"> very</font><font color="#CCCCCC"> interesting</font><font color="#E5E5E5"> system</font><font color="#CCCCCC"> or</font>

625
00:23:41,179 --> 00:23:45,320
<font color="#E5E5E5">event</font><font color="#CCCCCC"> id3 it gives you that information</font>

626
00:23:43,399 --> 00:23:48,168
<font color="#CCCCCC">that uses all before</font><font color="#E5E5E5"> I connection a</font>

627
00:23:45,320 --> 00:23:50,210
process connecting to<font color="#E5E5E5"> an IP but you do</font>

628
00:23:48,169 --> 00:23:52,970
not get user information<font color="#CCCCCC"> in this</font><font color="#E5E5E5"> event</font>

629
00:23:50,210 --> 00:23:54,980
log you get it with<font color="#E5E5E5"> the pin 33 so if you</font>

630
00:23:52,970 --> 00:23:57,440
want<font color="#E5E5E5"> to do a use case about users and</font>

631
00:23:54,980 --> 00:23:59,779
<font color="#E5E5E5">processes</font><font color="#CCCCCC"> together as a relationship</font><font color="#E5E5E5"> you</font>

632
00:23:57,440 --> 00:24:02,629
<font color="#E5E5E5">need a different</font><font color="#CCCCCC"> event law</font><font color="#E5E5E5"> okay</font>

633
00:23:59,779 --> 00:24:04,490
and then we see port 648 the<font color="#CCCCCC"> moment the</font>

634
00:24:02,629 --> 00:24:06,230
user wants<font color="#CCCCCC"> to authenticate to the</font>

635
00:24:04,490 --> 00:24:09,620
specific resource and it's<font color="#E5E5E5"> going to be</font>

636
00:24:06,230 --> 00:24:13,580
using explicit credentials and then we

637
00:24:09,620 --> 00:24:16,370
see the whole<font color="#CCCCCC"> ticket</font><font color="#E5E5E5"> this authentication</font>

638
00:24:13,580 --> 00:24:18,980
<font color="#E5E5E5">in there all the way to the ticket the</font>

639
00:24:16,370 --> 00:24:20,719
service<font color="#CCCCCC"> ticket</font><font color="#E5E5E5"> and then we have the user</font>

640
00:24:18,980 --> 00:24:22,669
authenticating to the<font color="#CCCCCC"> bot</font><font color="#E5E5E5"> and this</font>

641
00:24:20,720 --> 00:24:24,830
happens on<font color="#E5E5E5"> the server side such you can</font>

642
00:24:22,669 --> 00:24:27,139
<font color="#CCCCCC">see if Pedro</font><font color="#E5E5E5"> is authenticating it's not</font>

643
00:24:24,830 --> 00:24:29,269
<font color="#CCCCCC">see</font><font color="#E5E5E5"> brown anymore so we're trying</font><font color="#CCCCCC"> to</font>

644
00:24:27,139 --> 00:24:30,830
understand<font color="#CCCCCC"> what we get and documented</font><font color="#E5E5E5"> in</font>

645
00:24:29,269 --> 00:24:32,690
building the relationship in that

646
00:24:30,830 --> 00:24:35,600
<font color="#CCCCCC">specific</font><font color="#E5E5E5"> log because that's gonna help</font>

647
00:24:32,690 --> 00:24:37,490
us for our data analytics and<font color="#E5E5E5"> then we</font>

648
00:24:35,600 --> 00:24:40,219
see the user<font color="#CCCCCC"> access in a network share</font>

649
00:24:37,490 --> 00:24:42,649
and things like<font color="#CCCCCC"> that</font><font color="#E5E5E5"> so now I'm going to</font>

650
00:24:40,220 --> 00:24:44,240
<font color="#E5E5E5">show you</font><font color="#CCCCCC"> another variation real quick</font>

651
00:24:42,649 --> 00:24:47,629
<font color="#E5E5E5">which is with c-sharp</font>

652
00:24:44,240 --> 00:24:50,240
<font color="#CCCCCC">Rubeus project from our coworker</font><font color="#E5E5E5"> wheels</font>

653
00:24:47,629 --> 00:24:54,168
shorter<font color="#E5E5E5"> harm Joey</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> then he pretty</font>

654
00:24:50,240 --> 00:24:56,360
<font color="#CCCCCC">much started building this tool</font><font color="#E5E5E5"> that</font>

655
00:24:54,169 --> 00:24:58,669
does not touch<font color="#CCCCCC"> else's</font>

656
00:24:56,360 --> 00:25:00,830
does not let else us do in all this

657
00:24:58,669 --> 00:25:03,379
Kerberos authentication<font color="#CCCCCC"> it crafts the</font>

658
00:25:00,830 --> 00:25:05,899
traffic and then does this whole<font color="#E5E5E5"> ticket</font>

659
00:25:03,379 --> 00:25:08,809
<font color="#CCCCCC">you</font><font color="#E5E5E5"> know request and response is very</font>

660
00:25:05,899 --> 00:25:12,309
<font color="#CCCCCC">interested</font><font color="#E5E5E5"> in here so let's just do</font><font color="#CCCCCC"> it</font>

661
00:25:08,809 --> 00:25:17,149
<font color="#CCCCCC">again</font><font color="#E5E5E5"> so we</font><font color="#CCCCCC"> have our tool in there and</font>

662
00:25:12,309 --> 00:25:19,129
we do have our hash and our<font color="#E5E5E5"> target we're</font>

663
00:25:17,149 --> 00:25:21,199
going to do<font color="#E5E5E5"> these same steps just to</font>

664
00:25:19,129 --> 00:25:24,769
show you<font color="#E5E5E5"> that it's not being run as an</font>

665
00:25:21,200 --> 00:25:26,659
admin it's just a regular user<font color="#E5E5E5"> and this</font>

666
00:25:24,769 --> 00:25:28,220
is actually one of the beautiful<font color="#CCCCCC"> things</font>

667
00:25:26,659 --> 00:25:29,870
about<font color="#E5E5E5"> this because you can run this</font>

668
00:25:28,220 --> 00:25:31,639
without<font color="#E5E5E5"> being at me because you're not</font>

669
00:25:29,870 --> 00:25:34,158
touching else as you're now<font color="#E5E5E5"> patching</font>

670
00:25:31,639 --> 00:25:37,219
<font color="#CCCCCC">else as with a new key</font><font color="#E5E5E5"> so we're doing</font>

671
00:25:34,159 --> 00:25:39,830
<font color="#CCCCCC">our Big C a basic test</font><font color="#E5E5E5"> access denied of</font>

672
00:25:37,220 --> 00:25:42,740
course same concepts<font color="#E5E5E5"> but now if I use</font>

673
00:25:39,830 --> 00:25:45,918
<font color="#E5E5E5">Rubeus it's a c-sharp implementation of</font>

674
00:25:42,740 --> 00:25:47,549
<font color="#CCCCCC">Dell Pease keep your project we can just</font>

675
00:25:45,919 --> 00:25:51,690
use the hash of

676
00:25:47,549 --> 00:25:53,639
again and then we run<font color="#E5E5E5"> it</font><font color="#CCCCCC"> and then from</font>

677
00:25:51,690 --> 00:25:55,739
<font color="#E5E5E5">there what</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> going to happen is else</font>

678
00:25:53,639 --> 00:25:58,738
<font color="#CCCCCC">ass is going</font><font color="#E5E5E5"> to I'm sorry</font><font color="#CCCCCC"> Rubio's it's</font>

679
00:25:55,739 --> 00:26:02,190
going to manage all these like sending

680
00:25:58,739 --> 00:26:04,350
<font color="#E5E5E5">the key getting a ticket</font><font color="#CCCCCC"> as you</font><font color="#E5E5E5"> can see</font>

681
00:26:02,190 --> 00:26:07,019
is doing<font color="#CCCCCC"> this whole request and then</font>

682
00:26:04,350 --> 00:26:09,899
gets<font color="#E5E5E5"> the ticket back and then imports</font>

683
00:26:07,019 --> 00:26:11,940
that ticket into<font color="#CCCCCC"> the current law one</font>

684
00:26:09,899 --> 00:26:14,459
session<font color="#E5E5E5"> so now without opening a new</font>

685
00:26:11,940 --> 00:26:17,730
process we can<font color="#CCCCCC"> access</font><font color="#E5E5E5"> the domain</font>

686
00:26:14,460 --> 00:26:19,379
controller<font color="#E5E5E5"> so we here we're going to</font>

687
00:26:17,730 --> 00:26:22,470
<font color="#CCCCCC">start looking at a couple</font><font color="#E5E5E5"> of different</font>

688
00:26:19,379 --> 00:26:23,998
<font color="#CCCCCC">events similar</font><font color="#E5E5E5"> but something interested</font>

689
00:26:22,470 --> 00:26:25,590
in is<font color="#CCCCCC"> that we jumped</font><font color="#E5E5E5"> it straight to the</font>

690
00:26:23,999 --> 00:26:27,600
authentication<font color="#CCCCCC"> events we didn't do</font>

691
00:26:25,590 --> 00:26:29,609
anything<font color="#E5E5E5"> with all sides in between and</font>

692
00:26:27,600 --> 00:26:31,100
here we<font color="#E5E5E5"> see</font><font color="#CCCCCC"> Rubio's getting ready</font><font color="#E5E5E5"> to</font>

693
00:26:29,609 --> 00:26:33,689
talk to somebody

694
00:26:31,100 --> 00:26:36,449
<font color="#CCCCCC">Rubeus talking to the domain controller</font>

695
00:26:33,690 --> 00:26:38,820
via<font color="#E5E5E5"> port 80 and all these maps to</font><font color="#CCCCCC"> our</font>

696
00:26:36,450 --> 00:26:41,639
<font color="#E5E5E5">modeling on the top with</font><font color="#CCCCCC"> a specific sub</font>

697
00:26:38,820 --> 00:26:45,239
<font color="#CCCCCC">data source</font><font color="#E5E5E5"> once again information about</font>

698
00:26:41,639 --> 00:26:47,279
a<font color="#CCCCCC"> user</font><font color="#E5E5E5"> which is</font><font color="#CCCCCC"> moon</font><font color="#E5E5E5"> event ID</font><font color="#CCCCCC"> 3 and then</font>

699
00:26:45,239 --> 00:26:50,419
the same concepts with<font color="#E5E5E5"> the</font><font color="#CCCCCC"> ticket</font>

700
00:26:47,279 --> 00:26:52,559
request service seeker request

701
00:26:50,419 --> 00:26:55,710
authentication to the server side<font color="#E5E5E5"> all</font>

702
00:26:52,559 --> 00:26:57,590
the way<font color="#CCCCCC"> to accessing</font><font color="#E5E5E5"> a share the</font>

703
00:26:55,710 --> 00:27:00,210
<font color="#E5E5E5">interesting piece about</font><font color="#CCCCCC"> this is that</font>

704
00:26:57,590 --> 00:27:04,559
<font color="#CCCCCC">Elsa's was managing the authentication</font>

705
00:27:00,210 --> 00:27:07,320
first but they now<font color="#CCCCCC"> Rubeus is doing it by</font>

706
00:27:04,559 --> 00:27:10,168
itself<font color="#CCCCCC"> so if we and here we provide more</font>

707
00:27:07,320 --> 00:27:12,539
information<font color="#CCCCCC"> about</font><font color="#E5E5E5"> the user if we throw</font>

708
00:27:10,169 --> 00:27:14,909
<font color="#E5E5E5">this logic to</font><font color="#CCCCCC"> 3 million events</font><font color="#E5E5E5"> just</font>

709
00:27:12,539 --> 00:27:17,999
network events in a regular lab<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is</font>

710
00:27:14,909 --> 00:27:21,869
for our<font color="#E5E5E5"> what single class lab that we do</font>

711
00:27:17,999 --> 00:27:25,139
for a whole week only<font color="#CCCCCC"> 29,000 events</font>

712
00:27:21,869 --> 00:27:29,039
happen<font color="#CCCCCC"> process is talking to port 8080</font>

713
00:27:25,139 --> 00:27:31,859
<font color="#E5E5E5">which is Kerberos for program and we see</font>

714
00:27:29,039 --> 00:27:34,019
the<font color="#CCCCCC"> LSAT is the only one</font><font color="#E5E5E5"> doing it so the</font>

715
00:27:31,859 --> 00:27:36,449
moment<font color="#CCCCCC"> you've just run Rubeus then you</font>

716
00:27:34,019 --> 00:27:38,429
pretty<font color="#CCCCCC"> much stick out right away</font><font color="#E5E5E5"> from</font><font color="#CCCCCC"> a</font>

717
00:27:36,450 --> 00:27:41,309
network perspective and process to an IP

718
00:27:38,429 --> 00:27:43,379
into a user<font color="#E5E5E5"> but</font><font color="#CCCCCC"> the idea here is that</font><font color="#E5E5E5"> I</font>

719
00:27:41,309 --> 00:27:45,739
was able to see that with<font color="#E5E5E5"> this</font><font color="#CCCCCC"> event log</font>

720
00:27:43,379 --> 00:27:49,259
<font color="#E5E5E5">I can start</font><font color="#CCCCCC"> creating relationships</font><font color="#E5E5E5"> on</font>

721
00:27:45,739 --> 00:27:51,419
what users<font color="#CCCCCC"> are accessing my servers or</font>

722
00:27:49,259 --> 00:27:53,730
<font color="#E5E5E5">via 488 there are not system and it's</font>

723
00:27:51,419 --> 00:27:56,340
<font color="#E5E5E5">not else</font><font color="#CCCCCC"> ask for example from a user</font>

724
00:27:53,730 --> 00:27:58,649
from<font color="#E5E5E5"> a process perspective the idea here</font>

725
00:27:56,340 --> 00:28:00,929
is<font color="#CCCCCC"> to start mapping</font><font color="#E5E5E5"> our methodology to</font>

726
00:27:58,649 --> 00:28:03,800
what we saw during<font color="#E5E5E5"> this simulation and</font>

727
00:28:00,930 --> 00:28:07,490
we can see the<font color="#CCCCCC"> reviews use</font><font color="#E5E5E5"> justice uses</font>

728
00:28:03,800 --> 00:28:10,440
different less sub data sources and<font color="#E5E5E5"> less</font>

729
00:28:07,490 --> 00:28:11,970
specific<font color="#E5E5E5"> event ideas and that's just</font>

730
00:28:10,440 --> 00:28:14,280
because<font color="#E5E5E5"> of</font><font color="#CCCCCC"> the nature of the tool so</font>

731
00:28:11,970 --> 00:28:15,690
<font color="#CCCCCC">instead of modifying</font><font color="#E5E5E5"> a tax data sources</font>

732
00:28:14,280 --> 00:28:17,730
because I'm now changing the first one

733
00:28:15,690 --> 00:28:19,680
<font color="#E5E5E5">I'll take the first month indication</font><font color="#CCCCCC"> box</font>

734
00:28:17,730 --> 00:28:22,920
<font color="#E5E5E5">I'm at least giving you some details</font>

735
00:28:19,680 --> 00:28:24,630
<font color="#E5E5E5">into what it could be and then we also</font>

736
00:28:22,920 --> 00:28:28,010
have some extra<font color="#E5E5E5"> data sources</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> would</font>

737
00:28:24,630 --> 00:28:30,570
allow us<font color="#E5E5E5"> to also probably contribute to</font>

738
00:28:28,010 --> 00:28:32,670
<font color="#CCCCCC">to the attack framework as though those</font>

739
00:28:30,570 --> 00:28:34,649
<font color="#CCCCCC">two data</font><font color="#E5E5E5"> sources at the bottom allow me</font>

740
00:28:32,670 --> 00:28:37,730
to get<font color="#E5E5E5"> more context and get to the</font>

741
00:28:34,650 --> 00:28:42,380
<font color="#E5E5E5">network piece of you know please attack</font>

742
00:28:37,730 --> 00:28:42,380
thank you<font color="#CCCCCC"> very</font><font color="#E5E5E5"> much thank you</font>

743
00:28:48,000 --> 00:28:50,060
you

