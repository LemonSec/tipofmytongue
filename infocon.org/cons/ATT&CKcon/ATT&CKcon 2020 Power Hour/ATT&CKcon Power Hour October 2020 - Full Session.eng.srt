1
00:00:05,810 --> 00:00:08,809
- Welcome to ATT&CKcon POWER
HOUR, probably the only 90

2
00:00:08,810 --> 00:00:10,890
minute hour you're gonna experience today.

3
00:00:10,890 --> 00:00:13,950
I'm your host and lead of
MITRE ATT&CK, Adam Pennington.

4
00:00:13,950 --> 00:00:16,570
If you aren't familiar with
MITRE, we're a not for profit

5
00:00:16,570 --> 00:00:19,370
dedicated to solving
problems for a safer world.

6
00:00:19,370 --> 00:00:21,670
Through our public private
partnerships and federally funded

7
00:00:21,670 --> 00:00:24,660
research and development
centers work across government

8
00:00:24,660 --> 00:00:25,930
and with industry to tackle

9
00:00:25,930 --> 00:00:28,230
some of the world's biggest problems.

10
00:00:28,230 --> 00:00:31,030
If you're here, you've
probably heard of ATT&CK

11
00:00:31,030 --> 00:00:32,560
with ATT&CK in ATT&CKcon

12
00:00:32,560 --> 00:00:34,010
we're working to bring communities

13
00:00:34,010 --> 00:00:35,949
together to improve cyber security.

14
00:00:35,950 --> 00:00:38,600
ATT&CK is open and available to any person

15
00:00:38,600 --> 00:00:41,960
or organization for use
at no charge globally.

16
00:00:41,960 --> 00:00:44,690
Wanna start by thanking everyone
who submitted to our open

17
00:00:44,690 --> 00:00:48,190
CFP process for ATT&CKcon over the summer.

18
00:00:48,190 --> 00:00:50,980
Similar to the past two
ATT&CKcons this year was very

19
00:00:50,980 --> 00:00:54,360
competitive and resulted in
the monthly ATT&CKcon Power

20
00:00:54,360 --> 00:00:57,250
Hour sessions we have
scheduled through January.

21
00:00:57,250 --> 00:00:59,940
I'd also like to thank the
ATT&CK team and everyone out

22
00:00:59,940 --> 00:01:01,900
there who's contributed to ATT&CK

23
00:01:01,900 --> 00:01:04,260
and works to make ATT&CK better.

24
00:01:04,260 --> 00:01:05,600
A couple of quick housekeeping notes

25
00:01:05,600 --> 00:01:08,770
as we get started along with
your link to today's session,

26
00:01:08,770 --> 00:01:11,149
you should have also
gotten a slack invite.

27
00:01:11,150 --> 00:01:14,680
In that slack you'll find
channels dedicated to each talk.

28
00:01:14,680 --> 00:01:17,200
Please ask any questions you
have for today's speakers

29
00:01:17,200 --> 00:01:20,050
they're in the channel
dedicated to their talk.

30
00:01:20,050 --> 00:01:21,170
Our ATT&CKcon interviewer,

31
00:01:21,170 --> 00:01:24,240
Jamie Williams may ask your
questions, live with a speaker,

32
00:01:24,240 --> 00:01:27,470
have an opportunity to answer
it in slack after their talk.

33
00:01:27,470 --> 00:01:31,200
Today's session is being recorded
and will be posted online

34
00:01:31,200 --> 00:01:33,770
and sent to all registered participants.

35
00:01:33,770 --> 00:01:36,410
Once we're done editing
and captioning the videos.

36
00:01:36,410 --> 00:01:38,009
Hopefully early next week.

37
00:01:38,010 --> 00:01:39,600
So without further ado,

38
00:01:39,600 --> 00:01:42,663
I'm gonna turn over to the
first speaker of the first

39
00:01:42,663 --> 00:01:46,983
ATT&CKcon Power Hour, Brian
Donohue from Red Canary.

40
00:01:48,580 --> 00:01:53,580
- Hello, got a bit of
a lag on, there we go.

41
00:01:56,500 --> 00:02:00,550
All right, so first off,
like thank you, Adam,

42
00:02:00,550 --> 00:02:04,210
thank you to the ATT&CK team
for organizing this conference

43
00:02:04,210 --> 00:02:07,350
and for allowing me to
come and speak at it,

44
00:02:07,350 --> 00:02:12,350
apologies in advance, if
my talk gets interrupted by

45
00:02:12,570 --> 00:02:15,750
any dogs barking or the
pitter patter of toddlers

46
00:02:15,750 --> 00:02:17,990
running flatfooted above my head,

47
00:02:17,990 --> 00:02:20,210
but such as the reality of life in 2020.

48
00:02:20,210 --> 00:02:23,920
So without wasting any more time,

49
00:02:23,920 --> 00:02:27,440
my talk is Starting over with
Sub-techniques and it's about

50
00:02:27,440 --> 00:02:29,760
the lessons that we learned at Red Canary

51
00:02:29,760 --> 00:02:34,070
when we remapped from like
the old pre-sub techniques

52
00:02:34,070 --> 00:02:37,420
version of MITRE ATT&CK to the new

53
00:02:37,420 --> 00:02:39,403
sub-techniques version of ATT&CK.

54
00:02:40,370 --> 00:02:45,370
So before I go any further,
a few things about myself,

55
00:02:45,530 --> 00:02:47,450
I work at Red Canary

56
00:02:47,450 --> 00:02:52,320
I primarily either like
support publication of content

57
00:02:52,320 --> 00:02:56,070
or work on it myself,
importantly in the context

58
00:02:56,070 --> 00:02:59,120
of this talk, I am one of the
lead writers of our threat

59
00:02:59,120 --> 00:03:00,890
detection report, which is like an effort

60
00:03:00,890 --> 00:03:03,309
to gather all of the threats

61
00:03:03,310 --> 00:03:06,910
we detected our customer's
environments and sort of rank

62
00:03:06,910 --> 00:03:10,010
and stack the MITRE ATT&CK
techniques associated with them

63
00:03:10,010 --> 00:03:12,359
for the purposes of sort of
like determining which ATT&CK

64
00:03:12,360 --> 00:03:15,090
techniques are most
prevalent and like creating

65
00:03:15,090 --> 00:03:17,590
sort of a ranking order to them.

66
00:03:17,590 --> 00:03:19,230
Prior to joining Red Canary,

67
00:03:19,230 --> 00:03:23,450
I've worked as a journalist
and as a CTI analyst,

68
00:03:23,450 --> 00:03:28,450
about 10 years ago now I
was interviewing for a job

69
00:03:29,850 --> 00:03:32,350
as a social media editor at Threat Post.

70
00:03:32,350 --> 00:03:35,299
It would have been my first
job, it was my first job.

71
00:03:35,300 --> 00:03:36,680
The editors there asked me,

72
00:03:36,680 --> 00:03:41,470
have I had any experience
with social media, I lied

73
00:03:41,470 --> 00:03:44,350
I told them I did when in fact I did not,

74
00:03:44,350 --> 00:03:47,560
they either believed me or
didn't care, but they hired me

75
00:03:47,560 --> 00:03:49,150
and that's how my career started here.

76
00:03:49,150 --> 00:03:52,700
So if you dislike me or my talk,
you can send your hate mail

77
00:03:52,700 --> 00:03:55,162
to Paul Roberts and or Dennis Fisher.

78
00:03:56,100 --> 00:03:57,489
Now that I've got that out of the way

79
00:03:57,490 --> 00:03:59,300
so we've already gone through who I am

80
00:03:59,300 --> 00:04:02,230
I'm gonna give you guys just
an absolute bare minimum

81
00:04:02,230 --> 00:04:04,730
background on what Red Canary
does so that you can sort

82
00:04:04,730 --> 00:04:07,679
of understand the context
around our remapping effort.

83
00:04:07,680 --> 00:04:10,320
Then we'll run through the
seven lessons we learned,

84
00:04:10,320 --> 00:04:11,540
and then we'll close with a minute

85
00:04:11,540 --> 00:04:13,233
or two question and answers.

86
00:04:14,610 --> 00:04:17,670
So like one of the primary
things Red Canary does

87
00:04:17,670 --> 00:04:19,840
is manage detection and response.

88
00:04:19,839 --> 00:04:23,270
So we gathered telemetry
from our customers in points

89
00:04:23,270 --> 00:04:26,500
we parsed that telemetry
against like some thousand

90
00:04:26,500 --> 00:04:29,933
of detection analytics to
surface potential threats.

91
00:04:30,820 --> 00:04:33,250
Then those potential threats
are reviewed by a human

92
00:04:33,250 --> 00:04:37,080
on our detection engineering
team that detection engineer

93
00:04:37,080 --> 00:04:39,830
can either suppress or hide that event,

94
00:04:39,830 --> 00:04:42,950
or they can confirm that it's
a threat in which case they

95
00:04:42,950 --> 00:04:46,229
ship what we call a confirmed
threat detection to a customer

96
00:04:46,230 --> 00:04:47,520
for the purposes of this talk,

97
00:04:47,520 --> 00:04:50,359
that's effectively a
customer notification.

98
00:04:50,360 --> 00:04:53,790
It's more than that, but
like for our purposes just

99
00:04:53,790 --> 00:04:57,390
to understand that it includes
the among many other things.

100
00:04:57,390 --> 00:04:59,029
The MITRE ATT&CK techniques

101
00:04:59,029 --> 00:05:01,653
that threat is corresponded with.

102
00:05:03,130 --> 00:05:08,050
so given the way our system
operates we have a few different

103
00:05:08,050 --> 00:05:10,920
options for how we can
handle ATT&CK mapping.

104
00:05:10,920 --> 00:05:12,780
We can do it at the behavioral analytic

105
00:05:12,780 --> 00:05:16,030
or the detector level, the
benefit of doing it at that level

106
00:05:16,030 --> 00:05:18,229
is that it's highly scalable.

107
00:05:18,230 --> 00:05:20,360
You get to make your mapping decisions

108
00:05:20,360 --> 00:05:22,580
when you write your detection analytic.

109
00:05:22,580 --> 00:05:24,140
So you make that decision once

110
00:05:24,140 --> 00:05:26,169
and it's automated from there on out.

111
00:05:26,170 --> 00:05:28,910
The problem with that is
that it's bad at nuance.

112
00:05:28,910 --> 00:05:32,490
So you might have a theory
about what your detection

113
00:05:32,490 --> 00:05:34,620
analytic is gonna catch
and then in practice,

114
00:05:34,620 --> 00:05:37,060
it might catch something
altogether different.

115
00:05:37,060 --> 00:05:40,040
A second option would be to do
this at the detection level.

116
00:05:40,040 --> 00:05:41,970
So if we go back that last slide,

117
00:05:41,970 --> 00:05:45,173
the detection level would be
at this human analysis level.

118
00:05:46,730 --> 00:05:49,480
The benefit of doing it at the
human analysis level is that

119
00:05:49,480 --> 00:05:53,010
it is good at nuance, right
you've got all of the context

120
00:05:53,010 --> 00:05:56,789
you need to make a determination
about what you are,

121
00:05:56,790 --> 00:05:59,480
what MITRE ATT&CK technique
is associated with it however,

122
00:05:59,480 --> 00:06:02,120
it's difficult to scale because
it slows down your detection

123
00:06:02,120 --> 00:06:04,400
pipeline because you have to
make a decision and choose

124
00:06:04,400 --> 00:06:06,200
from 200 some odd techniques

125
00:06:06,200 --> 00:06:08,180
every time you detect the threat.

126
00:06:08,180 --> 00:06:11,200
The third potential option is
like the why not both option.

127
00:06:11,200 --> 00:06:13,630
And I'm actually gonna get into that

128
00:06:13,630 --> 00:06:15,130
later on in this presentation.

129
00:06:16,350 --> 00:06:18,630
So we actually map at the analytic level.

130
00:06:18,630 --> 00:06:22,320
So we make the determinations
about what our analytics,

131
00:06:22,320 --> 00:06:23,760
what technique they should map to

132
00:06:23,760 --> 00:06:26,440
like when we're developing
them and the reason we do this

133
00:06:26,440 --> 00:06:30,450
is because primarily Red Canary's
exists to detect threats.

134
00:06:30,450 --> 00:06:34,560
So when we adopted MITRE
ATT&CK a few years ago,

135
00:06:34,560 --> 00:06:36,990
we made the decision to
optimize for threat detection

136
00:06:36,990 --> 00:06:38,900
and speed since like, you know,

137
00:06:38,900 --> 00:06:41,729
oftentimes we're detecting
things of high priority rather

138
00:06:41,730 --> 00:06:45,233
than like being a 100% accurate
in our mapping all the time.

139
00:06:46,500 --> 00:06:48,410
So what this looks like in practice,

140
00:06:48,410 --> 00:06:51,620
but the red text at the top
here is a detection analytic.

141
00:06:51,620 --> 00:06:55,030
It basically is looking for
a process that is an L test

142
00:06:55,030 --> 00:06:56,599
The end of that also includes

143
00:06:56,600 --> 00:06:58,350
a command line with domain trust.

144
00:06:58,350 --> 00:07:02,540
They're all trust this maps
to domain trust discovery.

145
00:07:02,540 --> 00:07:04,700
And it's basically a technique
that adversary is used

146
00:07:04,700 --> 00:07:06,670
to make determinations about domain trusts

147
00:07:06,670 --> 00:07:08,040
within an environment.

148
00:07:08,040 --> 00:07:10,130
This is irrelevant for
the purposes of this talk,

149
00:07:10,130 --> 00:07:12,450
but historically this
detector has helped us catch

150
00:07:12,450 --> 00:07:14,993
a whole lot of trick bot activity.

151
00:07:16,800 --> 00:07:19,420
So now that you understand
sort of this high level

152
00:07:19,420 --> 00:07:21,410
background, the first lesson

153
00:07:21,410 --> 00:07:23,820
that I'd like to impart onto you is like,

154
00:07:23,820 --> 00:07:26,670
if you're going to map things
or if you're gonna transition

155
00:07:26,670 --> 00:07:29,170
from old MITRE to some
techniques, like the first thing

156
00:07:29,170 --> 00:07:31,530
you need to figure out is all
of the things that you were

157
00:07:31,530 --> 00:07:34,289
mapping to MITRE ATT&CK
in the first place.

158
00:07:34,290 --> 00:07:36,450
So for our purposes that would include

159
00:07:36,450 --> 00:07:38,240
behavioral detection analytics,

160
00:07:38,240 --> 00:07:39,920
which I already sort of explained.

161
00:07:39,920 --> 00:07:43,490
It would also include Atomic
Red Team tests, so Atomic red

162
00:07:43,490 --> 00:07:47,970
team is an open source
Adversary Emulation platform

163
00:07:47,970 --> 00:07:52,480
that we manage and maintain
in all of the tests in it

164
00:07:52,480 --> 00:07:54,600
are designed to simulate ATT&CK
techniques and they're map

165
00:07:54,600 --> 00:07:56,130
to ATT&CK techniques.

166
00:07:56,130 --> 00:07:57,390
For the purposes of this talk

167
00:07:57,390 --> 00:07:59,110
you can kind of think of these two things,

168
00:07:59,110 --> 00:08:01,620
the behavioral analytics
and the Atomic tests

169
00:08:01,620 --> 00:08:05,010
sort of interchangeably,
cause like the Atomic tests

170
00:08:05,010 --> 00:08:08,050
are isolated scripts that map to ATT&CK

171
00:08:08,050 --> 00:08:11,440
and simulate behaviors, the
analytics are isolated bits

172
00:08:11,440 --> 00:08:13,050
of Ruby code also mapped to ATT&CK

173
00:08:13,050 --> 00:08:15,500
designed to catch techniques.

174
00:08:15,500 --> 00:08:17,920
We also map a lot of our
research and educational

175
00:08:17,920 --> 00:08:19,390
content to MITRE ATT&CK,

176
00:08:19,390 --> 00:08:22,520
but like a lot of it is
derivative of our detection

177
00:08:23,940 --> 00:08:26,520
and we didn't go back and
retroactively map any of it.

178
00:08:26,520 --> 00:08:29,409
So that didn't really
involve any upfront work.

179
00:08:29,410 --> 00:08:32,510
For your purposes, you might
be mapping threat intelligence

180
00:08:32,510 --> 00:08:33,939
reporting to MITRE ATT&CK

181
00:08:33,940 --> 00:08:36,410
you might have like charts
and tables that you're using

182
00:08:36,409 --> 00:08:38,860
to determine things like
detection, coverage,

183
00:08:38,860 --> 00:08:41,240
or like any variety of security controls

184
00:08:41,240 --> 00:08:44,130
alerts, IFCs, and the like.

185
00:08:44,130 --> 00:08:49,130
Oh, so sorry, having some issues here.

186
00:08:51,950 --> 00:08:56,950
So once you figure out what
you need to map to ATT&CK

187
00:09:00,038 --> 00:09:03,820
it's time to do the actual mapping.

188
00:09:03,820 --> 00:09:06,940
Sorry, I'm having a little
bit of trouble controlling

189
00:09:06,940 --> 00:09:08,363
the screen right now.

190
00:09:10,940 --> 00:09:12,310
All right, there we go.

191
00:09:12,310 --> 00:09:14,859
So first things first, well I
guess it's the second thing.

192
00:09:14,860 --> 00:09:17,410
So let the code do the work for you okay.

193
00:09:17,410 --> 00:09:22,410
So luckily a MITRE ATT&CK
created a useful little JSON

194
00:09:22,740 --> 00:09:25,540
crosswalk script and effectively
what that'll tell you

195
00:09:25,540 --> 00:09:28,030
is like a tech, it'll tell you what,

196
00:09:28,030 --> 00:09:30,480
what a technique remaps through
so maybe a technique becomes

197
00:09:30,480 --> 00:09:32,700
a parrot technique and it'll
tell you the sub techniques

198
00:09:32,700 --> 00:09:35,820
under it, maybe a technique
becomes a sub technique

199
00:09:35,820 --> 00:09:37,610
and it'll tell you the
parrot technique above it

200
00:09:37,610 --> 00:09:39,210
or possibly the technique if it's like

201
00:09:39,210 --> 00:09:41,123
scripting has just deprecated.

202
00:09:42,410 --> 00:09:47,012
So we took that JSON crosswalk
script who built a little

203
00:09:47,012 --> 00:09:49,589
PowerShell script that sort
of helped at work specifically

204
00:09:49,590 --> 00:09:52,580
with our environment and
like for Atomic Red Team,

205
00:09:52,580 --> 00:09:54,270
we kind of naively thought that the code

206
00:09:54,270 --> 00:09:56,050
would do all the work for us

207
00:09:56,050 --> 00:09:59,209
we were quickly disabused of
that notion for the behavioral

208
00:09:59,210 --> 00:10:00,760
analytics as I'll get to in a minute,

209
00:10:00,760 --> 00:10:02,890
we sort of knew that we were
gonna have to do a good deal

210
00:10:02,890 --> 00:10:04,439
of manual review there.

211
00:10:04,440 --> 00:10:07,970
So once you get to the
point where you realize

212
00:10:07,970 --> 00:10:11,400
that you're gonna have to do
a human review at some level,

213
00:10:11,400 --> 00:10:14,130
you have to make a choice of
whether or not you want to,

214
00:10:14,130 --> 00:10:18,800
divide and conquer or do it
as a small team or individual.

215
00:10:18,800 --> 00:10:20,560
So the benefits of doing it as a team

216
00:10:20,560 --> 00:10:22,780
obviously are that it
will get done faster,

217
00:10:22,780 --> 00:10:24,130
although it might get done faster

218
00:10:24,130 --> 00:10:26,750
at the cost of it being less consistent,

219
00:10:26,750 --> 00:10:30,350
the benefit of assigning it to
an individual or a very small

220
00:10:30,350 --> 00:10:32,440
team is that it might be more consistent.

221
00:10:32,440 --> 00:10:35,430
And then the cost of that
might be that it takes longer.

222
00:10:35,430 --> 00:10:37,410
So if you have a
reasonable number of things

223
00:10:37,410 --> 00:10:39,189
you need to remap then by all means,

224
00:10:39,190 --> 00:10:42,270
keep it through a small
team or an individual.

225
00:10:42,270 --> 00:10:44,130
However, for our purposes,

226
00:10:44,130 --> 00:10:46,760
we've got thousands of
active detection analytics

227
00:10:46,760 --> 00:10:49,490
we've got 500 plus from
Atomic Red Team tests

228
00:10:49,490 --> 00:10:51,170
and like, I don't even know how many,

229
00:10:51,170 --> 00:10:54,469
but there's some like
200 plus ATT&CK technique

230
00:10:54,470 --> 00:10:56,490
and sub technique combos.

231
00:10:56,490 --> 00:11:00,060
So that was just too much
work for any individual to do.

232
00:11:00,060 --> 00:11:03,089
So we assembled a team consisting
of our intelligence team,

233
00:11:03,090 --> 00:11:06,230
our threat research team, our
detection engineering team

234
00:11:06,230 --> 00:11:08,570
and most importantly, not me.

235
00:11:08,570 --> 00:11:10,770
So all credit goes to those three teams

236
00:11:10,770 --> 00:11:12,949
I stood back and watched
and asked a lot of questions

237
00:11:12,950 --> 00:11:14,800
and wrote a blog about it eventually.

238
00:11:16,830 --> 00:11:20,190
So I stole this quote from
my colleague, Katie Nichols,

239
00:11:20,190 --> 00:11:23,280
but ATT&CK mapping is an
art, it's not a science.

240
00:11:23,280 --> 00:11:26,390
So particularly if you're gonna have

241
00:11:26,390 --> 00:11:29,370
a team that's doing this work,

242
00:11:29,370 --> 00:11:32,290
you should create a style
guide because people interpret

243
00:11:32,290 --> 00:11:34,880
techniques in different ways.

244
00:11:34,880 --> 00:11:37,240
In a style guide, like the
other thing to remember is that

245
00:11:37,240 --> 00:11:38,940
we're kind of learning
this on the fly, right?

246
00:11:38,940 --> 00:11:41,230
Like these sub techniques are new.

247
00:11:41,230 --> 00:11:44,400
So a style guide will help us
learn like how to map things

248
00:11:44,400 --> 00:11:46,530
it will keep some guardrails on how we map

249
00:11:46,530 --> 00:11:48,980
and it will help enforce consistency.

250
00:11:48,980 --> 00:11:52,230
Equally important is to
assign a review team.

251
00:11:52,230 --> 00:11:54,930
So we assigned a team of
senior detection, engineers,

252
00:11:54,930 --> 00:11:57,689
and intelligence analysts to
review every single mapping

253
00:11:57,690 --> 00:12:01,170
decision that was made by
the broader remapping team.

254
00:12:01,170 --> 00:12:03,910
This also helped to enforce
consistency and it helped us

255
00:12:03,910 --> 00:12:06,892
catch errors that we may have
made in the mapping process.

256
00:12:09,310 --> 00:12:14,050
Lesson five fix, find them fix
your legacy mapping issues.

257
00:12:14,050 --> 00:12:16,359
So I'm gonna tell a little story.

258
00:12:16,360 --> 00:12:20,510
So when we were working on
the threat detection report,

259
00:12:20,510 --> 00:12:24,050
like the first thing we do is
we pull the data and we see,

260
00:12:24,050 --> 00:12:26,459
and we make a pivot table and we see like,

261
00:12:26,460 --> 00:12:30,250
what are the top 10 MITRE ATT&CK
techniques from last year?

262
00:12:30,250 --> 00:12:31,660
The initial data poll revealed

263
00:12:31,660 --> 00:12:33,882
that masquerading was the top technique.

264
00:12:34,730 --> 00:12:39,130
So we then went and we made
a sub list of the detectors

265
00:12:39,130 --> 00:12:42,189
that converted to a threat
that was mapped to masquerading

266
00:12:42,190 --> 00:12:45,780
most often and these
two detectors showed up.

267
00:12:45,780 --> 00:12:49,260
The first one looks for
untrusted, binaries, spawning,

268
00:12:49,260 --> 00:12:51,170
suspicious windows service hosts.

269
00:12:51,170 --> 00:12:54,599
The second one identifies
a SPC host executing

270
00:12:54,600 --> 00:12:57,040
with a suspicious pair of process.

271
00:12:57,040 --> 00:13:00,439
All told these two detectors
on their own or in conjunction

272
00:13:00,440 --> 00:13:01,460
with one another triggered

273
00:13:01,460 --> 00:13:04,800
on more than 4,000 confirmed threats.

274
00:13:04,800 --> 00:13:06,870
However, when my colleague

275
00:13:06,870 --> 00:13:08,420
and our principal intelligence analyst,

276
00:13:08,420 --> 00:13:11,300
Jeff Felling went and reviewed
all the individual detections

277
00:13:11,300 --> 00:13:14,449
associated with those to
a behavioral analytics,

278
00:13:14,450 --> 00:13:17,490
he made a startling discovery.

279
00:13:17,490 --> 00:13:21,370
He discovered that those
two analytics actually

280
00:13:21,370 --> 00:13:24,050
were representative of Process Injection

281
00:13:24,050 --> 00:13:25,990
and not of masquerading.

282
00:13:25,990 --> 00:13:30,790
So we manually remapped them,
we were in the numbers again

283
00:13:30,790 --> 00:13:33,120
we also manually remapped
a few other analytics,

284
00:13:33,120 --> 00:13:36,230
but they weren't nearly
as dramatic as these ones

285
00:13:36,230 --> 00:13:38,560
and Process Injection fell to number one

286
00:13:38,560 --> 00:13:42,280
and then masquerading became number six.

287
00:13:42,280 --> 00:13:45,310
So this is a great lesson,
like this is the perfect time

288
00:13:45,310 --> 00:13:47,000
to review your behavioral analytics

289
00:13:47,000 --> 00:13:50,290
also probably good to be reviewing
them on a continual basis

290
00:13:50,290 --> 00:13:52,740
just to make sure that
nothing changes over time.

291
00:13:55,840 --> 00:13:58,770
Lesson number six,
considering the alternatives.

292
00:13:58,770 --> 00:14:01,180
So I promised you that there
was a third sort of why not

293
00:14:01,180 --> 00:14:05,699
both option for where we
could do our ATT&CK mapping

294
00:14:05,700 --> 00:14:07,410
and here's where I'm
gonna talk about that.

295
00:14:07,410 --> 00:14:10,300
So again, mapping at the
detection level is the most

296
00:14:10,300 --> 00:14:14,260
accurate mapping at the
analytic level is the fastest.

297
00:14:14,260 --> 00:14:16,480
However, we're developing an idea

298
00:14:16,480 --> 00:14:17,830
called conditional mapping.

299
00:14:17,830 --> 00:14:20,870
We haven't really operationalized
it yet, but the idea

300
00:14:20,870 --> 00:14:24,680
is that we're gonna try and
identify ambiguous analytics.

301
00:14:24,680 --> 00:14:26,540
Maybe they're just broad

302
00:14:26,540 --> 00:14:28,420
maybe there's some sort
of other problem going on,

303
00:14:28,420 --> 00:14:32,089
but the idea is like you pick
out the ones that don't always

304
00:14:32,090 --> 00:14:35,620
alert on the thing you
hypothesized they would alert on,

305
00:14:35,620 --> 00:14:37,970
and then you require
human review of those.

306
00:14:37,970 --> 00:14:42,010
So you're still able to keep
the main benefit of mapping

307
00:14:42,010 --> 00:14:44,910
at the analytic level because
most of the mapping is gonna

308
00:14:44,910 --> 00:14:46,930
get done there so you still have the speed

309
00:14:46,930 --> 00:14:51,239
and then you just identify that
small subset of problematic

310
00:14:51,240 --> 00:14:54,163
detectors and you require
a human review of them.

311
00:14:57,720 --> 00:14:59,870
Now the seventh and final lesson

312
00:14:59,870 --> 00:15:02,030
is just to have fun with it guys.

313
00:15:02,030 --> 00:15:04,680
Just kidding, that's not
the seventh lesson at all.

314
00:15:04,680 --> 00:15:08,569
The seventh lesson is actually a lags back

315
00:15:09,760 --> 00:15:12,350
to give back to the
MITRE ATT&CK community.

316
00:15:12,350 --> 00:15:17,350
So the ATT&CK team is
constantly looking for feedback.

317
00:15:17,700 --> 00:15:21,960
They probably get less of
it than they need, whoops.

318
00:15:21,960 --> 00:15:26,220
So ways you can give
back, obviously the main,

319
00:15:26,220 --> 00:15:28,130
the most obvious way to
give back is probably

320
00:15:28,130 --> 00:15:32,140
to contribute techniques
back to the MITRE ATT&CK

321
00:15:32,140 --> 00:15:34,530
but I think also like they
want feedback on what's working

322
00:15:34,530 --> 00:15:35,470
and what's not working

323
00:15:35,470 --> 00:15:37,230
and by all means you
should reach out to them

324
00:15:37,230 --> 00:15:39,720
and let them know suggest improvements

325
00:15:39,720 --> 00:15:41,470
and whatever else you can think of.

326
00:15:42,460 --> 00:15:45,590
Finally, like if you learn
something while using ATT&CK

327
00:15:45,590 --> 00:15:47,000
that might be useful to the rest of us,

328
00:15:47,000 --> 00:15:50,090
write a blog about it
or give a talk about it.

329
00:15:50,090 --> 00:15:52,373
And then while we're
on the topic of blogs,

330
00:15:53,450 --> 00:15:56,220
I know that I only had 14
minutes here and I'm talking

331
00:15:56,220 --> 00:15:58,300
incredibly fast, like a madman.

332
00:15:58,300 --> 00:16:01,390
So if you wanna take
more time with this talk,

333
00:16:01,390 --> 00:16:04,270
we wrote a blog version,
Macro Haber and Katie Nichols

334
00:16:04,270 --> 00:16:05,850
and I wrote a blog version of this talk

335
00:16:05,850 --> 00:16:08,910
maybe a couple of weeks
ago, the link is right there

336
00:16:08,910 --> 00:16:10,880
I'll try to remember to
tweet it after this talk,

337
00:16:10,880 --> 00:16:13,510
if any of you follow me on Twitter

338
00:16:13,510 --> 00:16:15,550
and I guess without further ado,

339
00:16:15,550 --> 00:16:17,359
we can sort of jump into the Q&A.

340
00:16:20,060 --> 00:16:21,640
- That was fantastic Brian, thank you.

341
00:16:21,640 --> 00:16:22,790
That was, that was
really great like I said,

342
00:16:22,790 --> 00:16:25,380
it's really appreciate from
coming from the ATT&CK side,

343
00:16:25,380 --> 00:16:26,920
we did so much work to kind of produce

344
00:16:26,920 --> 00:16:28,620
and publish these sub techniques

345
00:16:28,620 --> 00:16:30,770
so we are really excited to
see like an organization as

346
00:16:30,770 --> 00:16:33,130
large as Red Canary adopt it
and actually make it their own

347
00:16:33,130 --> 00:16:35,360
like you said, I love the
quotes coming off that blog

348
00:16:35,360 --> 00:16:38,540
the art of this, as well
as all of the nuance.

349
00:16:38,540 --> 00:16:39,988
So definitely I've seen a lot of traction

350
00:16:39,989 --> 00:16:43,240
and kind of activity going
around about your talks,

351
00:16:43,240 --> 00:16:45,100
but definitely stay queued
up for some questions.

352
00:16:45,100 --> 00:16:47,620
But one thing I just wanted
to ask you was you kinda

353
00:16:47,620 --> 00:16:51,320
mentioned how kind of
artistic and free kind of free

354
00:16:51,320 --> 00:16:52,450
spirited this mapping is.

355
00:16:52,450 --> 00:16:53,550
And one of the things I was wondering is,

356
00:16:53,550 --> 00:16:56,030
do you think that as advice
to other organizations,

357
00:16:56,030 --> 00:16:58,530
this was an all or not
effort, or can you map, like,

358
00:16:58,530 --> 00:17:00,930
can you map certain portions
to sub techniques and then

359
00:17:00,930 --> 00:17:03,560
maybe stay behind and other
areas you mentioned how like

360
00:17:03,560 --> 00:17:05,190
nuanced Red Canary is with, you know,

361
00:17:05,190 --> 00:17:07,780
Atomic Red Team and it
detections as well as looking

362
00:17:07,780 --> 00:17:08,730
at the matrix itself, like,

363
00:17:08,730 --> 00:17:10,500
do you think there's
areas of carve that up,

364
00:17:10,500 --> 00:17:13,770
but you think it's a binary
yes or no kind of question.

365
00:17:13,770 --> 00:17:17,910
- Yeah, so I think that
I'm interested in talking

366
00:17:17,910 --> 00:17:19,010
to other organizations about this

367
00:17:19,010 --> 00:17:20,890
'cause I actually think
that like in a weird way,

368
00:17:20,890 --> 00:17:24,770
Red Canary is like designed
to be mapped to MITRE ATT&CK

369
00:17:24,770 --> 00:17:26,530
and I think that there's a
lot of people that would have

370
00:17:26,530 --> 00:17:28,109
a lot of a harder time with that.

371
00:17:28,109 --> 00:17:31,840
Like specifically if you're
doing like a lot of IOC

372
00:17:31,840 --> 00:17:33,949
in signature-based stuff,
I can see how it would be

373
00:17:33,950 --> 00:17:36,990
difficult to map things through ATT&CK.

374
00:17:36,990 --> 00:17:39,020
And also if like you're
dealing with a lot of alerts

375
00:17:39,020 --> 00:17:41,560
that maybe are false positives,
that I could also understand

376
00:17:41,560 --> 00:17:44,040
how that could be a problem, but yeah,

377
00:17:44,040 --> 00:17:46,330
for us like the Atomic Red
Team stuff and the detection

378
00:17:46,330 --> 00:17:50,129
analytics really, really teed
us up to have a relatively

379
00:17:50,130 --> 00:17:52,690
easy job of mapping to ATT&CK.

380
00:17:52,690 --> 00:17:54,610
- Yep tracking, thank you and thanks again

381
00:17:54,610 --> 00:17:55,443
excellent talking to you.

382
00:17:55,443 --> 00:17:57,930
So I think I've experienced
the wisdom that you guys have

383
00:17:57,930 --> 00:17:59,930
got kind of leading the
way and doing that mapping

384
00:17:59,930 --> 00:18:02,220
is really greatly appreciated, you know,

385
00:18:02,220 --> 00:18:04,240
big benefits of the
community so thank you.

386
00:18:04,240 --> 00:18:06,930
But with that, I think we're,
we're right on time to turn it

387
00:18:06,930 --> 00:18:09,750
over back to Adam for our
introduction of our next speaker.

388
00:18:09,750 --> 00:18:11,560
- Great, thanks so much.

389
00:18:11,560 --> 00:18:13,803
- Yeah thank you both Jamie and Brian.

390
00:18:14,680 --> 00:18:17,840
So next up we have a team
from temple university.

391
00:18:17,840 --> 00:18:20,830
We have Aunshul Rege, who's
an Associate Professor there

392
00:18:20,830 --> 00:18:24,883
along with PhD student Rachel
Bleiman, so take it away.

393
00:18:33,540 --> 00:18:36,790
- Great, hi everyone,
my name is Aunshul Rege

394
00:18:36,790 --> 00:18:38,090
I'm an Associate Professor with

395
00:18:38,090 --> 00:18:40,800
the Department of Criminal
Justice at Temple,

396
00:18:40,800 --> 00:18:43,800
and I'm here today with my
amazing graduate research

397
00:18:43,800 --> 00:18:45,190
assistant, Rachel Bleiman

398
00:18:45,190 --> 00:18:48,110
and today we wanna share
with you how we are using

399
00:18:48,110 --> 00:18:51,320
pre-ATT&CK and ATT&CK
in the social sciences

400
00:18:51,320 --> 00:18:54,860
for cyber security and cyber
crime education and research.

401
00:18:54,860 --> 00:18:57,679
We wanna thank MITRE for the
opportunity to let us share

402
00:18:57,680 --> 00:18:59,290
what we're doing with you all today.

403
00:18:59,290 --> 00:19:02,460
And of course we want to thank our funders

404
00:19:02,460 --> 00:19:05,860
National Science Foundation
because without them,

405
00:19:05,860 --> 00:19:08,409
we couldn't do what we're doing today.

406
00:19:09,430 --> 00:19:11,960
So on the agenda, we're gonna
talk about how we're using

407
00:19:11,960 --> 00:19:15,780
pre-ATT&CK for cyber crime
and security education.

408
00:19:15,780 --> 00:19:18,480
Rachel is then gonna share
with you how we've been using

409
00:19:18,480 --> 00:19:21,570
ATT&CK for some of our research datasets.

410
00:19:21,570 --> 00:19:25,230
And then we're gonna end
with a summary and talk about

411
00:19:25,230 --> 00:19:27,570
where we'd like to go with, you know,

412
00:19:27,570 --> 00:19:30,283
what we're doing in
education and research.

413
00:19:31,620 --> 00:19:34,959
So let's get started with
that first component.

414
00:19:34,960 --> 00:19:38,780
How are we using MITRE
pre-ATT&CK framework

415
00:19:38,780 --> 00:19:41,210
in security education.

416
00:19:41,210 --> 00:19:44,820
I teach a Cybercrime course
in the social sciences.

417
00:19:44,820 --> 00:19:48,030
The emphasis here is on the
human aspects of cyber attacks

418
00:19:48,030 --> 00:19:49,850
and security with an emphasis

419
00:19:49,850 --> 00:19:53,149
within that on social engineering.

420
00:19:53,150 --> 00:19:56,300
The class is composed of students
from multiple disciplines.

421
00:19:56,300 --> 00:19:59,129
So we have not just
social science students,

422
00:19:59,130 --> 00:20:02,111
but we also have computer
science and engineering students.

423
00:20:02,111 --> 00:20:05,870
We've grouped them up in
about eight different groups

424
00:20:05,870 --> 00:20:10,199
that have both social and
computer science students in them.

425
00:20:10,200 --> 00:20:13,310
The objectives of one of the
assignments that they have

426
00:20:13,310 --> 00:20:17,020
is we're trying to map
the pre-ATT&CK framework

427
00:20:17,020 --> 00:20:19,620
to social engineering case studies,

428
00:20:19,620 --> 00:20:23,489
to help students learn how
these frameworks can be used

429
00:20:23,490 --> 00:20:24,990
to conduct threat intelligence,

430
00:20:24,990 --> 00:20:28,020
but also to understand the
limitations of both the case

431
00:20:28,020 --> 00:20:30,180
studies and the framework.

432
00:20:30,180 --> 00:20:33,390
So we've got about six social
engineering case studies with

433
00:20:33,390 --> 00:20:37,730
a lot of detailed and students
will be required to look

434
00:20:37,730 --> 00:20:41,120
at the overall mapping to
the pre-ATT&CK framework,

435
00:20:41,120 --> 00:20:44,449
the specific action on
certain tactics and techniques

436
00:20:44,450 --> 00:20:48,560
that they find, and then
identify a mitigation strategies

437
00:20:48,560 --> 00:20:52,240
identified in the framework
and also extend beyond that.

438
00:20:52,240 --> 00:20:54,900
This was our first attempt
this semester to try something

439
00:20:54,900 --> 00:20:57,733
like this, but we're hoping
to learn and grow in this.

440
00:21:02,890 --> 00:21:06,920
So students, like I said, we're
gonna be given six different

441
00:21:06,920 --> 00:21:09,560
case studies with an HK study

442
00:21:09,560 --> 00:21:12,350
they would then map it all
to the overall framework,

443
00:21:12,350 --> 00:21:15,139
as you can see by the
highlighted boxes here

444
00:21:15,140 --> 00:21:18,970
so if they find certain
components, they would map it on.

445
00:21:18,970 --> 00:21:23,970
But then the idea here is we
want them to think about things

446
00:21:24,750 --> 00:21:27,160
like what is the proportion of mapping?

447
00:21:27,160 --> 00:21:28,870
How much of the case study were you able

448
00:21:28,870 --> 00:21:31,770
to successfully map onto the framework

449
00:21:31,770 --> 00:21:36,150
because this gets them to
think about the implications.

450
00:21:36,150 --> 00:21:38,370
What does this mean for
the case study right?

451
00:21:38,370 --> 00:21:40,699
Do we see certain patterns?

452
00:21:40,700 --> 00:21:42,720
Can we identify if certain tactics

453
00:21:42,720 --> 00:21:44,410
and techniques are useful?

454
00:21:44,410 --> 00:21:47,480
And of course then what are
the implications for pre-ATT&CK

455
00:21:47,480 --> 00:21:48,453
in the sense that how well

456
00:21:48,453 --> 00:21:51,420
does it apply to social engineering.

457
00:21:51,420 --> 00:21:54,850
Now we're aware that pre-ATT&CK
is gonna be restructured

458
00:21:54,850 --> 00:21:57,459
and possibly merged with ATT&CK,

459
00:21:57,460 --> 00:22:00,670
but this is what we're
doing in the fall semester

460
00:22:00,670 --> 00:22:03,883
we'll be adapting this project
moving into the future.

461
00:22:06,180 --> 00:22:08,340
So once they've done this overall mapping,

462
00:22:08,340 --> 00:22:12,439
they then have to zoom
into a specific tactic

463
00:22:12,440 --> 00:22:17,270
and try to identify things
along the lines of techniques,

464
00:22:17,270 --> 00:22:19,200
similar techniques that fall under

465
00:22:19,200 --> 00:22:22,980
that tactic to again
identify relationships.

466
00:22:22,980 --> 00:22:26,090
See if they can come up
with any detection measures

467
00:22:26,090 --> 00:22:28,600
as identified in the
framework and of course,

468
00:22:28,600 --> 00:22:31,990
dive into the difficulty
level for the adversary.

469
00:22:31,990 --> 00:22:36,150
But in addition to this,
we want them to think about

470
00:22:36,150 --> 00:22:38,160
mitigation for social engineering.

471
00:22:38,160 --> 00:22:41,970
So currently, if you look at, you know,

472
00:22:41,970 --> 00:22:45,350
MITRE's ATT&CK website under mitigation,

473
00:22:45,350 --> 00:22:48,050
they have mitigation listed
for enterprise and mobile.

474
00:22:49,380 --> 00:22:53,240
And we are trying to get
our students to think about

475
00:22:53,240 --> 00:22:55,780
well, what would something
similar look like for pre-ATT&CK

476
00:22:55,780 --> 00:22:57,540
for social engineering?

477
00:22:57,540 --> 00:22:59,920
What would be those mitigation strategies?

478
00:22:59,920 --> 00:23:02,680
And if none exists,
students are then encouraged

479
00:23:02,680 --> 00:23:04,360
to recommend mitigation.

480
00:23:04,360 --> 00:23:06,770
And these might take the
form of for instance,

481
00:23:06,770 --> 00:23:09,290
policy or training and awareness, right?

482
00:23:09,290 --> 00:23:11,623
Moving beyond that technical domain.

483
00:23:13,300 --> 00:23:17,600
So the overall then objective
here is that students learn

484
00:23:17,600 --> 00:23:20,120
about threat intelligence, about mapping,

485
00:23:20,120 --> 00:23:21,840
about identifying patterns

486
00:23:21,840 --> 00:23:26,270
and trends and also about mitigation.

487
00:23:26,270 --> 00:23:28,900
So these are efforts
in the education space

488
00:23:28,900 --> 00:23:31,150
I'm now gonna pass it on
to Rachel to talk about

489
00:23:31,150 --> 00:23:34,873
what we're doing or the
datasets, so Rachel.

490
00:23:35,923 --> 00:23:37,170
- Great, thanks Aunshul.

491
00:23:38,430 --> 00:23:39,954
So through our Cybersecurity
in action research

492
00:23:39,954 --> 00:23:43,180
and education lab website

493
00:23:43,180 --> 00:23:46,500
which is sites.temple.edu/care.

494
00:23:46,500 --> 00:23:49,780
We offer free downloads of
the course projects along with

495
00:23:49,780 --> 00:23:53,510
two datasets that we've created
and we have recently mapped

496
00:23:53,510 --> 00:23:55,990
onto the MITRE ATT&CK framework.

497
00:23:55,990 --> 00:23:59,890
Both of these data sets are
updated on a monthly basis.

498
00:23:59,890 --> 00:24:02,660
The first data set we have is a repository

499
00:24:02,660 --> 00:24:04,880
of social engineering incidents

500
00:24:04,880 --> 00:24:09,570
we currently have 623
incidents recorded spanning

501
00:24:09,570 --> 00:24:13,320
from 2011 up through August, 2020.

502
00:24:13,320 --> 00:24:16,659
The second data set consists
of ransomware ATT&CKs

503
00:24:16,660 --> 00:24:18,340
against critical infrastructure.

504
00:24:18,340 --> 00:24:22,790
And this data set has
747 incidents ranging

505
00:24:22,790 --> 00:24:26,822
from November of 2013, up
through September of 2020.

506
00:24:27,720 --> 00:24:30,050
All of the incidents that
we gather for both of these

507
00:24:30,050 --> 00:24:33,180
datasets is completely
based on publicly disclosed

508
00:24:33,180 --> 00:24:36,670
information that we
collect from Google alerts.

509
00:24:36,670 --> 00:24:37,930
And a couple of months ago,

510
00:24:37,930 --> 00:24:40,610
we received some feedback
from people who use

511
00:24:40,610 --> 00:24:43,540
the ransomware dataset and
they asked if we could map it

512
00:24:43,540 --> 00:24:45,139
onto the ATT&CK framework.

513
00:24:45,140 --> 00:24:48,040
So we did that and we decided
to also map the social

514
00:24:48,040 --> 00:24:50,433
engineering dataset onto
the framework as well.

515
00:24:53,400 --> 00:24:56,380
So on the table on the left,
here are some of the variables

516
00:24:56,380 --> 00:24:59,090
that we record in the
social engineering dataset

517
00:24:59,090 --> 00:25:02,870
including dates, who the target
is and where they're located

518
00:25:02,870 --> 00:25:05,290
what social engineering tactic is used

519
00:25:05,290 --> 00:25:08,930
the monetary cost of the
ATT&CK, who the ATT&CKer is

520
00:25:08,930 --> 00:25:11,587
and some information about
the ploy of the ATT&CK.

521
00:25:12,640 --> 00:25:16,850
About 50% of the social
engineering tactics in our dataset

522
00:25:16,850 --> 00:25:20,230
mapped onto the ATT&CK
techniques or software.

523
00:25:20,230 --> 00:25:22,320
The primary techniques,
we were able to match

524
00:25:22,320 --> 00:25:24,490
we're phishing and spear phishing,

525
00:25:24,490 --> 00:25:27,030
but there were also some
instances of malware that mapped

526
00:25:27,030 --> 00:25:29,338
onto the software and the framework.

527
00:25:29,338 --> 00:25:32,820
And then we also mapped
about 23% of the ATT&CKers

528
00:25:32,820 --> 00:25:35,919
onto the ATT&CK group slash ATT&CKer.

529
00:25:35,920 --> 00:25:39,253
So group 32 or Lazarus
group appeared several times

530
00:25:39,253 --> 00:25:42,437
and was the most common while groups 59,

531
00:25:42,437 --> 00:25:45,592
92 and 94 were also repeatedly mapped.

532
00:25:47,730 --> 00:25:50,630
Moving on to the critical
infrastructure ransomware dataset,

533
00:25:50,630 --> 00:25:53,800
our variables record information
about the date and location

534
00:25:53,800 --> 00:25:55,879
of the ATT&CK, who was targeted,

535
00:25:55,880 --> 00:25:57,770
what strain of ransomware is used

536
00:25:57,770 --> 00:26:00,000
and details about the ransom.

537
00:26:00,000 --> 00:26:03,310
And in our transition
from the ninth iteration

538
00:26:03,310 --> 00:26:05,570
to the 10th iteration of the dataset,

539
00:26:05,570 --> 00:26:08,340
we began mapping onto
the ATT&CK framework.

540
00:26:08,340 --> 00:26:11,470
We first removed all incidents
where the strain was recorded

541
00:26:11,470 --> 00:26:14,213
as NotPetya as the
ATT&CK framework to find,

542
00:26:14,213 --> 00:26:18,090
NotPetya as a wiperware
and not a ransomware.

543
00:26:18,090 --> 00:26:20,580
We then mapped the
ransomware strain variable

544
00:26:20,580 --> 00:26:22,879
onto the ATT&CK software ID.

545
00:26:22,880 --> 00:26:26,920
About 56% of the strains mapped
onto the ATT&CK software.

546
00:26:26,920 --> 00:26:29,370
And these eight softwares
are the ones that appeared

547
00:26:29,370 --> 00:26:33,590
in our dataset repeatedly and
included Maze, Locker, Gaga,

548
00:26:33,590 --> 00:26:37,409
Net Walker, Ragnar
Locker, Robinhood, Riach

549
00:26:37,410 --> 00:26:38,833
Sam Sam, and Wanna Cry.

550
00:26:42,490 --> 00:26:45,720
And we did some challenges
and found some limitations

551
00:26:45,720 --> 00:26:49,120
with mapping our dataset
onto the ATT&CK framework.

552
00:26:49,120 --> 00:26:51,090
In the social engineering dataset

553
00:26:51,090 --> 00:26:54,000
many of the social engineering
tactics do not currently

554
00:26:54,000 --> 00:26:57,690
exist in the framework such
as whaling and vishing.

555
00:26:57,690 --> 00:27:00,030
And while our mapping
results did show that about

556
00:27:00,030 --> 00:27:03,660
half of the tactics mapped
over the bulk of our incidents

557
00:27:03,660 --> 00:27:06,350
in this dataset are phishing
and spear phishing attacks,

558
00:27:06,350 --> 00:27:07,959
which the framework does include,

559
00:27:07,960 --> 00:27:10,560
which raised that percentage for us.

560
00:27:10,560 --> 00:27:12,690
We had very few techniques
besides phishing

561
00:27:12,690 --> 00:27:14,163
that maps onto the framework.

562
00:27:15,050 --> 00:27:16,899
And in the ransomware dataset,

563
00:27:16,900 --> 00:27:19,600
we were unable to map a
portion of the strains.

564
00:27:19,600 --> 00:27:21,340
Some strains that appear frequently,

565
00:27:21,340 --> 00:27:24,669
the datasets such as Revil
and has been around for some

566
00:27:24,670 --> 00:27:28,690
time do not yet exist in the framework.

567
00:27:28,690 --> 00:27:30,330
And other strains that are newer,

568
00:27:30,330 --> 00:27:33,423
such as RansomEXX are also
not yet in the framework.

569
00:27:36,040 --> 00:27:37,159
- Great, thanks Rachel.

570
00:27:37,160 --> 00:27:39,730
So I'm just gonna bring
everything to a close here

571
00:27:39,730 --> 00:27:42,100
and share with you some of the reasons

572
00:27:42,100 --> 00:27:45,169
why we're using this right,
in the education space

573
00:27:45,170 --> 00:27:47,550
I, as an educator
certainly found pre-ATT&CK

574
00:27:47,550 --> 00:27:50,040
to be extremely useful because

575
00:27:50,040 --> 00:27:52,639
it helps her students
develop the ability to map

576
00:27:52,640 --> 00:27:54,860
and understand threat intelligence.

577
00:27:54,860 --> 00:27:57,080
And also the ability to understand

578
00:27:57,080 --> 00:27:58,830
challenges and limitations.

579
00:27:58,830 --> 00:28:01,649
I think what's really cool
is we're trying to map

580
00:28:01,650 --> 00:28:05,550
social engineering cases,
which is not typically done.

581
00:28:05,550 --> 00:28:08,790
So I think that's an interesting
exercise in and of itself

582
00:28:08,790 --> 00:28:11,200
from the social science perspective.

583
00:28:11,200 --> 00:28:13,980
What else I like about this
is that isn't technical enough

584
00:28:13,980 --> 00:28:16,440
so all disciplines can engage.

585
00:28:16,440 --> 00:28:18,390
I have a lot of social science
students who can actually

586
00:28:18,390 --> 00:28:21,780
participate in this and get
a top level understanding

587
00:28:21,780 --> 00:28:24,980
of threat intelligence, so I
think that this is a really,

588
00:28:24,980 --> 00:28:27,930
really cool exercise for
my students to try out.

589
00:28:27,930 --> 00:28:29,930
From a dataset perspective

590
00:28:30,820 --> 00:28:33,649
interestingly, when
Rachel and I started this,

591
00:28:33,650 --> 00:28:37,480
we were struggling to get data
because for obvious reasons,

592
00:28:37,480 --> 00:28:39,360
companies don't wanna share
it or government doesn't wanna

593
00:28:39,360 --> 00:28:40,600
share it so we said, you know what,

594
00:28:40,600 --> 00:28:44,290
let's create our own dataset
and we'll share it with other

595
00:28:44,290 --> 00:28:45,597
folks in the academic domain.

596
00:28:45,597 --> 00:28:49,050
And so we've had a lot of
educators and students of course

597
00:28:49,050 --> 00:28:52,950
request this data which was great because

598
00:28:52,950 --> 00:28:57,180
it's allowed us to fulfill
sort of our objective

599
00:28:57,180 --> 00:28:59,730
of sharing this with the
wider academic community

600
00:28:59,730 --> 00:29:02,310
but interestingly we got a lot
of requests from governments,

601
00:29:02,310 --> 00:29:05,840
not just in the US but around
the world and also industry

602
00:29:05,840 --> 00:29:08,250
from all over the world
that was interested

603
00:29:08,250 --> 00:29:10,530
in getting a copy of our dataset.

604
00:29:10,530 --> 00:29:12,850
Said hey, let's, you know,
see if we can look at trends

605
00:29:12,850 --> 00:29:15,899
and patterns across ransomware strains.

606
00:29:15,900 --> 00:29:18,740
Comparing the data to
their own internal datasets

607
00:29:18,740 --> 00:29:20,760
are raising awareness and for training

608
00:29:20,760 --> 00:29:24,870
and what was really cool
is mapping it onto MITRE

609
00:29:24,870 --> 00:29:27,919
really, really improve
the quality of our dataset

610
00:29:27,920 --> 00:29:30,350
it gave our data set a lot of credibility,

611
00:29:30,350 --> 00:29:32,510
and we got a lot of responses saying,

612
00:29:32,510 --> 00:29:33,900
thank you for mapping this

613
00:29:33,900 --> 00:29:35,773
this is gonna help us out big time.

614
00:29:37,330 --> 00:29:42,330
So that is a, you know, the
cool thing is it was after

615
00:29:42,600 --> 00:29:44,570
we mapped it onto the MITRE framework,

616
00:29:44,570 --> 00:29:47,080
we actually got the data
set was actually picked up

617
00:29:47,080 --> 00:29:50,300
by a Security Week and also as mentioned,

618
00:29:50,300 --> 00:29:52,840
our lab was mentioned in leaving
computer, which was again,

619
00:29:52,840 --> 00:29:55,686
another big win for us
'cause we're a team of two

620
00:29:55,686 --> 00:29:57,100
trying to do something like this

621
00:29:57,100 --> 00:30:00,020
and it's lovely to see that our
efforts are having an impact

622
00:30:00,020 --> 00:30:01,770
and benefiting the wider community.

623
00:30:03,850 --> 00:30:06,699
So one of the things that
we wanna do is, like I said,

624
00:30:06,700 --> 00:30:09,410
we're aware that pre-ATT&CK
and ATT&CK are going to be

625
00:30:09,410 --> 00:30:14,190
restructured merging, and I
know that pre-ATT&CK and ATT&CK

626
00:30:14,190 --> 00:30:16,810
has helped me in the social
science space, right.

627
00:30:16,810 --> 00:30:19,440
Helped me with my education
and research efforts.

628
00:30:19,440 --> 00:30:20,820
But I would love to do,

629
00:30:20,820 --> 00:30:24,220
is to see how we in the
social science domain,

630
00:30:24,220 --> 00:30:26,070
through our education and research efforts

631
00:30:26,070 --> 00:30:28,530
can contribute back to
pre-ATT&CK and ATT&CK.

632
00:30:28,530 --> 00:30:31,149
And this is what our previous
speaker mentioned as well

633
00:30:31,150 --> 00:30:34,030
is how can we be contributing?

634
00:30:34,030 --> 00:30:36,899
We're trying to create data repositories

635
00:30:36,899 --> 00:30:40,580
I remember, you know, where
do we go to get data right?

636
00:30:40,580 --> 00:30:42,120
So we're looking at indictments,

637
00:30:42,120 --> 00:30:45,320
we're looking at social
engineering case studies

638
00:30:45,320 --> 00:30:47,639
we can conduct focus groups and interviews

639
00:30:47,640 --> 00:30:51,100
with social engineers and we're
also trying to weave it into

640
00:30:51,100 --> 00:30:53,159
what we've best started at Temple

641
00:30:53,160 --> 00:30:56,030
is a collegiate social
engineering capture the flag

642
00:30:57,070 --> 00:30:58,790
competition and training event.

643
00:30:58,790 --> 00:31:03,790
So can we use MITREs ATT&CK
frameworks to sort of shape that

644
00:31:04,660 --> 00:31:08,410
exercise and in turn
use student experiences

645
00:31:08,410 --> 00:31:11,270
to then contribute back to this framework.

646
00:31:11,270 --> 00:31:13,010
So if anyone's interested in any of this,

647
00:31:13,010 --> 00:31:15,360
we are definitely seeking collaboration

648
00:31:15,360 --> 00:31:18,100
we love to hear not just
from academic communities,

649
00:31:18,100 --> 00:31:21,540
but also from industry and
government and of course MITRE.

650
00:31:21,540 --> 00:31:23,879
So that's everything that I had.

651
00:31:23,880 --> 00:31:26,133
We can, I guess, take it up for questions.

652
00:31:27,170 --> 00:31:29,090
- Fantastic talk and like
people are going nuts

653
00:31:29,090 --> 00:31:30,419
over this data set, Aunshul I love

654
00:31:30,420 --> 00:31:32,130
that you touch at the
end at like how it was

655
00:31:32,130 --> 00:31:34,240
truly a grassroots
effort to like, you know,

656
00:31:34,240 --> 00:31:36,220
compile that and build it yourself.

657
00:31:36,220 --> 00:31:38,470
I think the biggest
question is, like you said,

658
00:31:38,470 --> 00:31:40,640
I love the idea of, like you said,

659
00:31:40,640 --> 00:31:42,590
no matter how technical
things are, it's all,

660
00:31:42,590 --> 00:31:43,970
there's a human element to all this works.

661
00:31:43,970 --> 00:31:45,360
My biggest question is, you know,

662
00:31:45,360 --> 00:31:48,490
have you seen themes in terms
of the mitigations that your

663
00:31:48,490 --> 00:31:50,640
students are putting
together for these attacks

664
00:31:50,640 --> 00:31:52,180
that you can share with
the wider community,

665
00:31:52,180 --> 00:31:54,130
the things that we can
do to kind of, you know,

666
00:31:54,130 --> 00:31:56,640
prevent or at least like, you
know, mitigate to some degree,

667
00:31:56,640 --> 00:32:00,881
these layer eight human-based behaviors.

668
00:32:00,881 --> 00:32:04,870
- Yeah, yeah that's a great
question and you know,

669
00:32:04,870 --> 00:32:07,830
I'm gonna respond in
two parts here I guess.

670
00:32:07,830 --> 00:32:11,419
One is it's primarily
been policy, you know,

671
00:32:11,420 --> 00:32:14,350
appropriate behavior, what to
click on what not to click on

672
00:32:14,350 --> 00:32:17,379
so a bit more on the education
and training aspects of this.

673
00:32:17,380 --> 00:32:20,600
But I love that because it's
a multidisciplinary class,

674
00:32:20,600 --> 00:32:21,939
you're getting computer scientists

675
00:32:21,940 --> 00:32:23,410
to really think about this.

676
00:32:23,410 --> 00:32:25,940
This is the next generation
workforce of computer scientists

677
00:32:25,940 --> 00:32:28,170
who are gonna be developers and defenders

678
00:32:28,170 --> 00:32:30,750
and so in thinking about
using these frameworks,

679
00:32:30,750 --> 00:32:33,210
not just in the technical aspect,

680
00:32:33,210 --> 00:32:36,080
but also on the human domain, right.

681
00:32:36,080 --> 00:32:39,300
That for, I think it's really
getting them to think about

682
00:32:39,300 --> 00:32:41,870
that as they go out and
design and defense systems.

683
00:32:41,870 --> 00:32:46,280
So that's, it's impossible
to really give your question,

684
00:32:46,280 --> 00:32:49,120
an effective response to
the short time we have,

685
00:32:49,120 --> 00:32:52,391
but I'm happy to carry
on that conversation.

686
00:32:52,392 --> 00:32:53,660
- It makes a lot of sense like you said,

687
00:32:53,660 --> 00:32:55,790
you can only build a wall so
strong if someone's just gonna

688
00:32:55,790 --> 00:32:57,657
open the door, what's the
point, but yeah, with that,

689
00:32:57,657 --> 00:32:59,699
thank you thanks again
for a great presentation

690
00:32:59,700 --> 00:33:00,533
that was really excellent

691
00:33:00,533 --> 00:33:02,330
you said there's a lot of
Slack activity going on,

692
00:33:02,330 --> 00:33:03,920
so definitely hanging around
and answer some questions.

693
00:33:03,921 --> 00:33:05,150
- Great thank you all.

694
00:33:05,150 --> 00:33:06,210
- With that I'm gonna turn it back over

695
00:33:06,210 --> 00:33:08,173
to Adam to introduce our next speaker.

696
00:33:10,020 --> 00:33:13,750
- Along with Jamie, thank
you again, awesome talk.

697
00:33:13,750 --> 00:33:16,960
And so the time to go on
to our next speaker though.

698
00:33:16,960 --> 00:33:19,680
So next speaker is gonna be Matan Hart

699
00:33:19,680 --> 00:33:24,680
with Cymptom and if you're
ready, take it away.

700
00:33:25,340 --> 00:33:29,270
- Thank you, Adam and the entire
ATT&CK team for having this

701
00:33:29,270 --> 00:33:31,200
giving me the opportunity to present.

702
00:33:31,200 --> 00:33:35,333
You're doing amazing job, huge fan here.

703
00:33:39,290 --> 00:33:42,980
Great, so I'm going to talk about today

704
00:33:42,980 --> 00:33:47,000
is how you can Transform
Adversary Emulation

705
00:33:47,000 --> 00:33:48,930
into a Data Analysis Question

706
00:33:48,930 --> 00:33:51,900
using the MITRE ATT&CK
framework and specifically

707
00:33:51,900 --> 00:33:54,013
the mitigation in the ATT&CK framework.

708
00:33:56,220 --> 00:33:59,810
About myself, usually I look
like in the picture on the left

709
00:33:59,810 --> 00:34:04,139
side, but during COVID,
I might look like this.

710
00:34:04,140 --> 00:34:08,740
I'm the co founder and CEO
@ Cymptom, security start up

711
00:34:08,739 --> 00:34:10,739
specializing in security testing.

712
00:34:10,739 --> 00:34:13,069
I've been a security researcher

713
00:34:13,070 --> 00:34:15,310
in the Israeli Defense Force

714
00:34:15,310 --> 00:34:17,263
and as well as in the private sector.

715
00:34:18,745 --> 00:34:20,600
Some of my research I've been presented

716
00:34:20,600 --> 00:34:22,469
in several security cons,

717
00:34:22,469 --> 00:34:25,699
such as a Black Hat and
actually the inspiration

718
00:34:25,699 --> 00:34:28,879
for the content that I'm
talking today is based on

719
00:34:28,880 --> 00:34:33,880
my existing work building
solutions and conducting security

720
00:34:34,909 --> 00:34:36,763
assessments for large organizations.

721
00:34:40,060 --> 00:34:45,060
And click, right, so let's
start with Adversary Emulation.

722
00:34:47,196 --> 00:34:50,607
Other side, I have a issue
with the clicking, right?

723
00:34:53,460 --> 00:34:55,130
There is a lag a bit, sorry about that.

724
00:34:55,130 --> 00:34:59,140
So Adversary Emulation for
those of you who in either

725
00:34:59,140 --> 00:35:03,180
recap is the way that
has been used popularly

726
00:35:03,180 --> 00:35:07,399
one of the most useful use
cases for the ATT&CK framework,

727
00:35:07,400 --> 00:35:11,330
which is basically allow the
organization to test their

728
00:35:11,330 --> 00:35:14,880
defenses against specific
threats, the ATT&CK framework,

729
00:35:14,880 --> 00:35:19,730
can be very beneficial to
measure a test and then also make

730
00:35:19,730 --> 00:35:23,660
improvements to defenses based
on the different adversary

731
00:35:23,660 --> 00:35:26,053
tactics, techniques, and procedures.

732
00:35:27,340 --> 00:35:30,568
But the problem with Adversary
Emulation is that it,

733
00:35:30,568 --> 00:35:35,170
it doesn't scale nor it
wasn't intended to basically

734
00:35:35,170 --> 00:35:38,720
the main focus of Adversary
Emulation is to test specific

735
00:35:38,720 --> 00:35:43,720
controls in a controlled
manner that is very targeted,

736
00:35:43,940 --> 00:35:48,213
a specific network and
emulating a specific threat.

737
00:35:49,060 --> 00:35:53,570
The issue with it is
that some organization

738
00:35:53,570 --> 00:35:56,872
are looking or still early on during

739
00:35:56,872 --> 00:36:00,000
their work with the ATT&CK framework

740
00:36:00,000 --> 00:36:03,750
and they basically want to
get an initial state of,

741
00:36:03,750 --> 00:36:07,280
whereas our standing with our
defenses against the metrics

742
00:36:08,671 --> 00:36:12,210
and what I've seen that
basically some organization

743
00:36:12,210 --> 00:36:17,210
are trying to emulate all
attacks all in the network.

744
00:36:17,280 --> 00:36:20,938
I've seen one time that there
was an organization with,

745
00:36:20,938 --> 00:36:25,938
50,000 endpoints where as they
needed to emulate a lateral

746
00:36:27,900 --> 00:36:32,900
movement technique used
by an AAPT and they had,

747
00:36:33,160 --> 00:36:36,000
they figured out only
where authors use some kind

748
00:36:36,000 --> 00:36:39,400
of automation that the literally
emulated two and a half

749
00:36:39,400 --> 00:36:42,590
billion emulation because
they tested it from each

750
00:36:42,590 --> 00:36:46,550
computer to all the other
computers in the network.

751
00:36:46,550 --> 00:36:51,510
So it was a big number and
it's actually made a huge

752
00:36:52,510 --> 00:36:54,520
disruption to their network.

753
00:36:54,520 --> 00:36:58,910
So what I'm suggesting is to
a different approach using

754
00:36:58,910 --> 00:37:02,960
the MITRE ATT&CK matrix
framework that basically check

755
00:37:02,960 --> 00:37:05,290
the instead of checking
detection capabilities

756
00:37:05,290 --> 00:37:08,320
that are the most commonly
used with Adversary Emulation

757
00:37:08,320 --> 00:37:11,930
is to basically look at the aspect

758
00:37:11,930 --> 00:37:16,930
of the medication of the ATT&CK
framework and testing each

759
00:37:20,560 --> 00:37:22,940
technique and the associated mitigations,

760
00:37:22,940 --> 00:37:25,930
if you're really have
the right capabilities

761
00:37:25,930 --> 00:37:30,930
to prevent this take before
going on to detection.

762
00:37:32,130 --> 00:37:35,920
So the methodology is I have
four steps first of all,

763
00:37:35,920 --> 00:37:39,750
choose an ATT&CK technique,
you should preferably choose

764
00:37:39,750 --> 00:37:41,340
the technique that you feel more

765
00:37:41,340 --> 00:37:43,860
you want to have the first
initial that you feel

766
00:37:43,860 --> 00:37:45,970
comfortable, that you want to test first

767
00:37:45,970 --> 00:37:48,120
if you're already a mapped,

768
00:37:48,120 --> 00:37:50,750
have mapped techniques
to detection capabilities

769
00:37:50,750 --> 00:37:53,810
so you should preferably start
with something that you feel

770
00:37:53,810 --> 00:37:56,000
that you don't have enough data sources

771
00:37:56,000 --> 00:38:01,000
or detective capabilities in place.

772
00:38:01,530 --> 00:38:04,270
Then for each, for the
technique that you choose

773
00:38:04,270 --> 00:38:07,220
you should test for each mitigation

774
00:38:07,220 --> 00:38:10,240
how much it effective because
not all of the mitigation

775
00:38:10,240 --> 00:38:14,022
that are in the ATT&CK
framework are having the same,

776
00:38:15,200 --> 00:38:18,299
same they are you using
the same ATT&CK vector

777
00:38:18,300 --> 00:38:21,180
or some of them are just
reducing some of the ATT&CK

778
00:38:21,180 --> 00:38:23,319
surface or the exploitability
of that technique

779
00:38:23,320 --> 00:38:27,483
and some of them are truly
mitigate the technique entirely.

780
00:38:28,410 --> 00:38:32,350
After you grasp those techniques

781
00:38:32,350 --> 00:38:34,180
that you want to focus on,

782
00:38:34,180 --> 00:38:39,180
you should map the data
sources that you can really

783
00:38:40,870 --> 00:38:43,270
collect information needed
in order to validate

784
00:38:43,270 --> 00:38:45,840
the applicability of that mitigation.

785
00:38:45,840 --> 00:38:49,530
Preferably you should do
it for all the mitigation

786
00:38:49,530 --> 00:38:51,270
for that technique in order to make sure

787
00:38:51,270 --> 00:38:53,560
that you're not missing any information.

788
00:38:53,560 --> 00:38:58,350
But yeah, in generally as
mentioned also by previous

789
00:38:58,350 --> 00:39:01,033
speakers before me, it's not
science that ATT&CK framework

790
00:39:01,033 --> 00:39:04,390
and you don't have to
be 100% all the time.

791
00:39:04,390 --> 00:39:06,430
And it's okay that even if you don't,

792
00:39:06,430 --> 00:39:08,569
if you feel that it's not 100% accurate

793
00:39:08,570 --> 00:39:10,740
or don't have access
to all the information,

794
00:39:10,740 --> 00:39:14,680
you can still be able to have
the initial states to conclude

795
00:39:14,680 --> 00:39:16,480
if a specific technique you are able

796
00:39:18,161 --> 00:39:19,913
to prevent in your what's your,

797
00:39:19,913 --> 00:39:23,280
what is your current situation
during that technique

798
00:39:23,280 --> 00:39:26,027
and how much is
exploitable in your network

799
00:39:26,027 --> 00:39:27,510
and not on specific endpoint,

800
00:39:27,510 --> 00:39:31,713
rather on the entire ATT&CK
surface inside the network.

801
00:39:33,380 --> 00:39:37,970
Let's take a test case the
Pass The Hash scenario,

802
00:39:37,970 --> 00:39:42,759
basically Pass The Hash
literal movement and a defense

803
00:39:42,760 --> 00:39:47,760
division technique that
allows an adversary to move

804
00:39:48,070 --> 00:39:50,960
laterally between endpoints
based on a credential

805
00:39:50,960 --> 00:39:53,290
that they can reuse because they,

806
00:39:53,290 --> 00:39:57,029
those two users have the same credentials.

807
00:39:57,030 --> 00:40:00,160
It's very common between endpoints
that are used by the same

808
00:40:00,160 --> 00:40:04,879
image and the default Milton users are,

809
00:40:04,880 --> 00:40:07,960
their password are not changed
after they've been deployed

810
00:40:07,960 --> 00:40:09,340
and something that is still

811
00:40:09,340 --> 00:40:12,520
very common to see in organization.

812
00:40:12,520 --> 00:40:14,550
And it's sometimes very
hard to really know

813
00:40:14,550 --> 00:40:16,050
what's has been changing that.

814
00:40:17,640 --> 00:40:20,100
When we looking at the mitigations

815
00:40:22,591 --> 00:40:23,890
in the ATT&CK framework
about the specific technique,

816
00:40:25,690 --> 00:40:27,640
there are basically four different

817
00:40:27,640 --> 00:40:29,383
mitigations that offer different,

818
00:40:30,685 --> 00:40:33,900
they have different ways
to mitigate the threat,

819
00:40:33,900 --> 00:40:36,160
this technique, however, not all of them

820
00:40:36,160 --> 00:40:38,339
are actually doing the same.

821
00:40:38,340 --> 00:40:41,920
And also their exposure
that they are reducing

822
00:40:41,920 --> 00:40:44,200
or eliminating is not the same.

823
00:40:44,200 --> 00:40:48,049
So when you drill down with
the small letters first of all,

824
00:40:48,050 --> 00:40:51,070
you can understand what is
really needed to be checked

825
00:40:51,070 --> 00:40:52,870
what data should be collected

826
00:40:53,874 --> 00:40:57,370
and then you can move on
to do a bit of research.

827
00:40:57,370 --> 00:40:58,960
It's not something that I they're easy,

828
00:40:58,960 --> 00:41:02,320
but we took here a case
that is more and more harder

829
00:41:02,320 --> 00:41:03,770
as I've summed that up,
the mitigations are more

830
00:41:03,770 --> 00:41:08,259
straightforward, but when
you check each mitigation

831
00:41:08,260 --> 00:41:11,730
specifically, you can
see their effectiveness

832
00:41:11,730 --> 00:41:13,350
isn't always the same.

833
00:41:13,350 --> 00:41:16,009
So of course, if you have
the capability to check,

834
00:41:16,010 --> 00:41:18,620
if there's any type of credential overlap,

835
00:41:18,620 --> 00:41:21,440
the first mitigation which is
privileged account management,

836
00:41:21,440 --> 00:41:23,390
if you use laps or you have access

837
00:41:23,390 --> 00:41:25,720
to endpoints and check the registry,

838
00:41:25,720 --> 00:41:29,216
or whether you have a Pam
solution that you can use

839
00:41:29,217 --> 00:41:34,217
to assess, this is the best
mitigation that you could check

840
00:41:34,470 --> 00:41:38,129
and you could also enforce but of course,

841
00:41:38,130 --> 00:41:41,130
life are not perfect

842
00:41:41,130 --> 00:41:44,410
and if you're looking for
other mitigations that could

843
00:41:44,410 --> 00:41:46,710
reduce potential to
reduce the ATT&CK surface,

844
00:41:47,730 --> 00:41:51,360
you should consider checking
for your patch management

845
00:41:51,360 --> 00:41:55,498
how, if you installed the
right patches that the modern

846
00:41:55,498 --> 00:42:00,498
mitigation suggests as
well as which will mitigate

847
00:42:00,896 --> 00:42:05,896
the exposure only to
administrative local accounts.

848
00:42:07,300 --> 00:42:10,360
You could go with the user
account control a mitigation,

849
00:42:10,360 --> 00:42:13,090
which is aimed more for
the four domain users

850
00:42:13,090 --> 00:42:16,860
but it could be easily
checked by checking the active

851
00:42:16,860 --> 00:42:21,860
directory in the GPO to see
if there is, or user that are,

852
00:42:22,140 --> 00:42:26,462
have multiple systems that
have administrative access,

853
00:42:27,740 --> 00:42:29,439
that the same user have this administer

854
00:42:29,440 --> 00:42:32,440
access to both of them and
maybe you should consider

855
00:42:32,440 --> 00:42:34,430
focusing on that mitigation as well.

856
00:42:34,430 --> 00:42:37,500
Other effective mitigation
that has been used

857
00:42:37,500 --> 00:42:42,500
in the frame that is commonly
seen in your organization

858
00:42:42,540 --> 00:42:45,200
that is easy to implement is
use our account management

859
00:42:45,200 --> 00:42:50,200
is basically enforce some use
restrictions are using the GPO

860
00:42:50,590 --> 00:42:52,590
if you don't trust your
GPO, you could also,

861
00:42:52,590 --> 00:42:55,390
if you have the capability
to query each endpoint,

862
00:42:55,390 --> 00:42:56,799
the registry and look for the right keys

863
00:42:56,800 --> 00:43:00,372
which are also mentioned
in the minor mitigation,

864
00:43:00,372 --> 00:43:04,970
in data mitigation and
basically if you don't have,

865
00:43:04,970 --> 00:43:07,640
if you're a building
administrator account is disabled,

866
00:43:07,640 --> 00:43:09,390
this is a very effective mitigation

867
00:43:09,390 --> 00:43:14,390
to eliminate the local
variation of a local account

868
00:43:14,620 --> 00:43:17,933
variation of the Pass The
Hash ATT&CK technique.

869
00:43:19,380 --> 00:43:24,380
And of course, you know, you
can do a talk about the ATT&CK

870
00:43:25,130 --> 00:43:27,740
framework and not show a fancy hit map.

871
00:43:27,740 --> 00:43:29,223
So here is my hit map.

872
00:43:30,490 --> 00:43:35,279
What we focus here, which
is the important difference

873
00:43:35,280 --> 00:43:40,280
is that we are not mapping
detective controls.

874
00:43:40,680 --> 00:43:42,490
We are checking only if the existing

875
00:43:42,490 --> 00:43:44,870
mitigations are applied.

876
00:43:44,870 --> 00:43:48,029
So if you already built
the hit map, that is,

877
00:43:48,030 --> 00:43:51,810
that shows your detection capabilities,

878
00:43:51,810 --> 00:43:54,790
this hit map could look very different

879
00:43:54,790 --> 00:43:59,020
and I suggest to use it as a
complementary to the techniques

880
00:43:59,020 --> 00:44:01,700
that you feel that you don't
have enough detection controls.

881
00:44:01,700 --> 00:44:03,730
If you don't have already,

882
00:44:03,730 --> 00:44:06,900
and you want to focus and
you start, and, you know,

883
00:44:06,900 --> 00:44:09,140
we start from square zero
I think it's a better,

884
00:44:09,140 --> 00:44:12,259
I feel it's better to start
actually with this hit map

885
00:44:12,260 --> 00:44:14,650
and then, you know, when
you, if you feel comfortable

886
00:44:14,650 --> 00:44:18,060
with preventing some of
the ATT&CK techniques,

887
00:44:18,060 --> 00:44:21,520
you should focus or detective
controls for other techniques

888
00:44:21,520 --> 00:44:23,050
in the MITRE framework.

889
00:44:23,050 --> 00:44:26,630
So those you can build
even interesting ATT&CK,

890
00:44:26,630 --> 00:44:29,410
hit map that contains how much,

891
00:44:29,410 --> 00:44:32,109
how many of the techniques
you are able to prevent using

892
00:44:32,110 --> 00:44:35,050
preventing patrols using the
mitigations in the ATT&CK

893
00:44:35,050 --> 00:44:40,050
framework and how many of
those you only able to detect.

894
00:44:40,490 --> 00:44:44,700
So it's interesting a use case
to know how to make a defense

895
00:44:44,700 --> 00:44:48,169
gap analysis first with a mitigation

896
00:44:48,170 --> 00:44:50,063
and then also we have detection.

897
00:44:55,240 --> 00:45:00,040
So it's important to
mention that there is no,

898
00:45:00,040 --> 00:45:02,620
you need to pick the right
tool for the right job.

899
00:45:02,620 --> 00:45:03,700
Adversary Emulation is great

900
00:45:03,700 --> 00:45:08,700
I've been doing it also for
years, it helps organization

901
00:45:08,770 --> 00:45:11,310
really to know really where they stand

902
00:45:12,380 --> 00:45:15,050
and they'll also check how you're also

903
00:45:15,050 --> 00:45:17,860
people and processes are performing.

904
00:45:17,860 --> 00:45:22,700
The issues that makes Adversary
Emulation to not scale

905
00:45:22,700 --> 00:45:25,310
is the potential business
disruption that it might create.

906
00:45:25,310 --> 00:45:27,545
And also the experienced team

907
00:45:27,545 --> 00:45:30,523
that should do it in a safe manner.

908
00:45:30,523 --> 00:45:34,440
Data Analytics on the other
hand could be a very good

909
00:45:34,440 --> 00:45:39,440
complementary to first get the
right coverage in the ATT&CK

910
00:45:40,470 --> 00:45:44,013
framework, as well as the
network coverage in a safe manner

911
00:45:44,013 --> 00:45:46,363
that scales, that could scale better.

912
00:45:47,220 --> 00:45:51,149
I suggest to start with Data Analytics

913
00:45:51,150 --> 00:45:54,198
if you don't perform
Adversary Emulation yet,

914
00:45:54,198 --> 00:45:57,920
and then based on the
results that you can map

915
00:45:57,920 --> 00:45:59,760
from the ATT&CK metrics in order

916
00:45:59,760 --> 00:46:01,030
to check your detective controls,

917
00:46:01,030 --> 00:46:04,430
or to see how you can really
check that the medications

918
00:46:04,430 --> 00:46:07,589
that you have implemented
are performing as intended

919
00:46:07,590 --> 00:46:12,590
Adversary Emulation could be
a good use case to check this.

920
00:46:12,730 --> 00:46:15,240
The issue with Data Analytics
is that, first of all,

921
00:46:15,240 --> 00:46:16,830
it doesn't check detective controls

922
00:46:16,830 --> 00:46:19,170
which is of course, one
of the main use cases

923
00:46:20,601 --> 00:46:23,470
and yet in that people
use the ATT&CK metrics

924
00:46:23,470 --> 00:46:25,399
and the ATT&CK framework,

925
00:46:25,400 --> 00:46:29,683
and it doesn't really check
any type of processes.

926
00:46:31,200 --> 00:46:33,990
To conclude the presentation first of all,

927
00:46:33,990 --> 00:46:36,700
Adversary Emulation are
great they are important,

928
00:46:36,700 --> 00:46:40,160
and it's something that I
suggest everybody to practice,

929
00:46:40,160 --> 00:46:41,410
even if you're not in the red team,

930
00:46:41,410 --> 00:46:43,500
also blue teams can use
the Atomic Red Team,

931
00:46:43,500 --> 00:46:46,400
which Brian talked about,

932
00:46:46,400 --> 00:46:49,200
but as well as something
that you should use

933
00:46:49,200 --> 00:46:53,281
cautiously, something that you
don't really want to run it

934
00:46:53,281 --> 00:46:55,330
in all your of your network rather,

935
00:46:55,330 --> 00:46:58,650
you want to do it specifically
to check specific controls

936
00:46:58,650 --> 00:47:00,685
in a controlling environment.

937
00:47:00,685 --> 00:47:05,685
Data Analytics on the other
hand could be a better approach

938
00:47:06,870 --> 00:47:08,799
to get the initial state of where your,

939
00:47:08,800 --> 00:47:12,690
what is your defense coverage
and to know where you stand,

940
00:47:12,690 --> 00:47:17,690
and then you could operate and
implement new capabilities,

941
00:47:17,980 --> 00:47:21,420
whether preventive or detective.

942
00:47:21,420 --> 00:47:26,420
And I found the mitigation
in ATT&CK very beneficial

943
00:47:27,376 --> 00:47:29,930
to understand what the defense coverage,

944
00:47:29,930 --> 00:47:33,220
because first of all,
most of the techniques

945
00:47:33,220 --> 00:47:34,419
in the MITRE framework,

946
00:47:34,420 --> 00:47:39,420
and basically most of the
controls that most organization

947
00:47:39,600 --> 00:47:41,930
have in his organization
are first of all preventive

948
00:47:41,930 --> 00:47:44,613
and of course should be preferred.

949
00:47:45,461 --> 00:47:48,629
So sometimes, I found
yet mitigation in ATT&CK

950
00:47:48,630 --> 00:47:53,430
something that is not, is
that should be used more often

951
00:47:53,430 --> 00:47:57,493
during any type of usage
for the ATT&CK framework.

952
00:48:02,950 --> 00:48:07,002
- So that's it, we're not Brendan yet.

953
00:48:09,760 --> 00:48:11,790
- Great talk Matan that's fantastic.

954
00:48:11,790 --> 00:48:14,320
I've really loved someone
dropped a comment in Slack that

955
00:48:14,320 --> 00:48:17,300
you're effectively emulating
the adversary emulators,

956
00:48:17,300 --> 00:48:18,650
like you said, getting
ahead of them and saying,

957
00:48:18,650 --> 00:48:21,490
you know what, before we
even if you don't have that

958
00:48:21,490 --> 00:48:23,569
resources to do any
emulation or before we do it

959
00:48:23,570 --> 00:48:24,430
let's go ahead and figure out, like,

960
00:48:24,430 --> 00:48:26,740
what are we doing in terms
of the mitigation aspect?

961
00:48:26,740 --> 00:48:28,156
I think of a lot of
people really appreciate,

962
00:48:28,157 --> 00:48:30,090
and that resonates with them.

963
00:48:30,090 --> 00:48:32,610
Biggest question that people
are already asking us in Slack

964
00:48:32,610 --> 00:48:35,450
is what advice do you have
for the community in terms

965
00:48:35,450 --> 00:48:37,240
of the process that you
shared of, you know,

966
00:48:37,240 --> 00:48:39,759
looking at ATT&CK, seeing the
mitigations for technique,

967
00:48:39,760 --> 00:48:41,520
and actually translating
that to, you know,

968
00:48:41,520 --> 00:48:42,790
what can we do in our environment?

969
00:48:42,790 --> 00:48:45,233
How does that line up with our technology?

970
00:48:45,233 --> 00:48:46,293
Any words you can share with the community

971
00:48:46,293 --> 00:48:49,750
and any wisdom you can add up.

972
00:48:49,750 --> 00:48:51,260
- Great, so first of all,

973
00:48:51,260 --> 00:48:53,640
I think as also discussed
in the previous talks,

974
00:48:53,640 --> 00:48:55,879
and I guess it's something that

975
00:48:55,880 --> 00:48:58,170
we learn with ATT&CK on a daily basis,

976
00:48:58,170 --> 00:48:59,770
that it's the human aspect you know,

977
00:48:59,770 --> 00:49:02,819
we can't really automate
everything and is always a magic.

978
00:49:02,819 --> 00:49:05,444
Of course you should,
it's required to research

979
00:49:05,444 --> 00:49:07,960
it requires work, I took an
example of The Pass The Hash,

980
00:49:07,960 --> 00:49:09,810
because it's an interesting case,

981
00:49:09,810 --> 00:49:11,090
and it's a bit complicated of course,

982
00:49:11,090 --> 00:49:15,180
some of them are much easier
to start with, but yes,

983
00:49:15,180 --> 00:49:19,730
the process is to research is
to learn and to be familiar,

984
00:49:19,730 --> 00:49:21,760
with the different tactics and techniques,

985
00:49:21,760 --> 00:49:24,560
and to be able to really
understand and research,

986
00:49:24,560 --> 00:49:26,183
what are the current
capabilities that people have

987
00:49:26,183 --> 00:49:28,680
in this organization that
they can really check.

988
00:49:28,680 --> 00:49:33,680
Of course, good cyber
posture, and hygiene helps

989
00:49:35,140 --> 00:49:38,160
and if you have the right
tools and the right controls

990
00:49:38,160 --> 00:49:41,060
or use vendors that help you
automate some of this stuff,

991
00:49:41,060 --> 00:49:46,029
it could be easier but
for most techniques,

992
00:49:46,030 --> 00:49:48,660
I found it that it's pretty trivial.

993
00:49:48,660 --> 00:49:51,569
I do think that is part
of our work as a community

994
00:49:51,570 --> 00:49:55,530
to also invest in the mitigations
in the ATTA&CK even more.

995
00:49:55,530 --> 00:49:58,580
I know that those are
also now the also shield

996
00:49:58,580 --> 00:50:02,920
and of course, going forward
how we can all as a community,

997
00:50:02,920 --> 00:50:03,900
be able to share more

998
00:50:03,900 --> 00:50:07,420
and maybe that's the
things that processes easy.

999
00:50:07,420 --> 00:50:10,320
- Yep, love that answer like
you said cybersecurity is hard

1000
00:50:10,320 --> 00:50:13,720
but I'm loving to contribute
plugs to get accepted

1001
00:50:13,720 --> 00:50:16,520
by all means, keeping everything
back to us we love it.

1002
00:50:16,520 --> 00:50:18,210
But yeah, thanks again for
great talking with that

1003
00:50:18,210 --> 00:50:19,360
I'm gonna turn it back over to Adam

1004
00:50:19,360 --> 00:50:22,420
to present our next speaker.

1005
00:50:22,420 --> 00:50:25,333
- Yeah and Jay, are you
ready to share your screen?

1006
00:50:37,670 --> 00:50:38,503
Yeah, there we go.

1007
00:50:38,503 --> 00:50:42,793
So next stop we have Jair
Santanna from North wave.

1008
00:50:45,120 --> 00:50:46,319
- Okay, can you hear me?

1009
00:50:49,680 --> 00:50:51,069
I cannot see myself,

1010
00:50:51,070 --> 00:50:54,030
but I believe that I am appearing there.

1011
00:50:54,030 --> 00:50:55,853
Now I am there, shiny.

1012
00:50:57,315 --> 00:51:02,270
Okay, so guys, let me introduce
first myself, I'm a Jair,

1013
00:51:02,270 --> 00:51:06,307
actually the full name is
Jose Jair Cardoso De Santanna.

1014
00:51:07,370 --> 00:51:10,870
But let's get short Jair
I'm a cloud security lead

1015
00:51:10,870 --> 00:51:15,130
at North Wave Security
Company in the Netherlands.

1016
00:51:15,130 --> 00:51:19,180
And I'm also assistant professor
at University of Twente.

1017
00:51:19,180 --> 00:51:22,210
And you understand the
why I emphasize that.

1018
00:51:22,210 --> 00:51:25,330
So I need to talk first about the problem

1019
00:51:25,330 --> 00:51:27,630
of static threshold.

1020
00:51:27,630 --> 00:51:32,240
Yeah, so let me give one example
and I need your help, okay?

1021
00:51:32,240 --> 00:51:37,240
So how much milk should
they give to my daughter?

1022
00:51:37,410 --> 00:51:42,410
Yeah, so I have a, one and
a half years old daughter

1023
00:51:43,460 --> 00:51:48,460
she usually drinks, or we
usually give to her 180ml

1024
00:51:48,460 --> 00:51:51,000
three times a day, 30 days.

1025
00:51:51,000 --> 00:51:56,000
So per month we spend like
we buy 17 liters of milk.

1026
00:51:56,960 --> 00:52:01,960
And, but then I noticed that
sometimes she drinks everything

1027
00:52:03,070 --> 00:52:05,790
and seams that are still thirsty

1028
00:52:05,790 --> 00:52:09,553
and some times she doesn't
finish her bottle, obviously.

1029
00:52:10,540 --> 00:52:13,029
And my wife used to say, well,

1030
00:52:13,030 --> 00:52:17,300
better to put more milk than
let her thirsty, do you agree?

1031
00:52:17,300 --> 00:52:22,110
Well, to me it's not like
that, I'm a data driven guy.

1032
00:52:22,110 --> 00:52:26,830
So I just ask her to give 200mls of milk.

1033
00:52:26,830 --> 00:52:30,779
And then we count how much
milk should drink every day

1034
00:52:30,780 --> 00:52:32,843
during the month of August.

1035
00:52:34,210 --> 00:52:39,210
On average, she drank a
172ml upper time the minimal

1036
00:52:40,020 --> 00:52:45,020
that she drunk was 97
and the maximum was 200.

1037
00:52:45,480 --> 00:52:49,313
Wait we gave 200, she drank 200.

1038
00:52:50,990 --> 00:52:53,173
The mean I could say something,

1039
00:52:54,170 --> 00:52:57,870
nothing that's she just
said, drink these on average.

1040
00:52:57,870 --> 00:53:00,470
The 97 if I looked at the graph,

1041
00:53:00,470 --> 00:53:04,890
looks a pretty clear abnormal point, yeah.

1042
00:53:04,890 --> 00:53:09,890
And if it's 200, well,
possibly she was thirsty.

1043
00:53:11,470 --> 00:53:13,430
Then my question comes to you.

1044
00:53:13,430 --> 00:53:17,940
How much more should they
put on her bottle, yeah.

1045
00:53:17,940 --> 00:53:21,430
And then I said, first, I
need to explain something

1046
00:53:21,430 --> 00:53:23,770
that is what explained to my students.

1047
00:53:23,770 --> 00:53:28,770
That there is the Quantiles,
Percentile, Quartile Median

1048
00:53:28,810 --> 00:53:31,299
so it will bring you
back to the school, okay.

1049
00:53:31,300 --> 00:53:35,930
So here's the graph and
here, all the points okay

1050
00:53:35,930 --> 00:53:38,529
so all the amount of milk that she drink,

1051
00:53:38,530 --> 00:53:41,510
I just sort all the values, okay?

1052
00:53:41,510 --> 00:53:45,410
Now, if I divide these in the middle,

1053
00:53:45,410 --> 00:53:47,839
let me ask you which element

1054
00:53:47,840 --> 00:53:52,320
so which number is at the
middle of the second list,

1055
00:53:52,320 --> 00:53:54,460
and then you look to the list and say,

1056
00:53:54,460 --> 00:53:57,400
it looks like that is the 188.

1057
00:53:57,400 --> 00:54:02,400
These guys also code as
075, quantile 75% percentile

1058
00:54:05,140 --> 00:54:10,140
or three thirds quantile,
but the values is 188.

1059
00:54:10,331 --> 00:54:14,366
So if you look to the
second or to the first part,

1060
00:54:14,366 --> 00:54:17,910
and I asked you what is
the element at the middle?

1061
00:54:17,910 --> 00:54:22,910
You would say 156 and indeed
and this is called 025 quantile

1062
00:54:24,677 --> 00:54:27,693
25 percentile or first quartile.

1063
00:54:28,600 --> 00:54:31,750
And then if I ask you which
element is that the middle

1064
00:54:31,750 --> 00:54:36,380
of this list of values you
would say Jair that is not

1065
00:54:36,380 --> 00:54:38,500
one single element there,

1066
00:54:38,500 --> 00:54:43,390
but it's somewhere between
the 176 and the 177.

1067
00:54:43,390 --> 00:54:46,843
So why not to have this as the median.

1068
00:54:49,240 --> 00:54:54,240
And these middle element
is called median, okay.

1069
00:54:56,090 --> 00:54:58,083
So far so good I hope.

1070
00:54:58,990 --> 00:55:02,169
So that is another concept
that is really important for me

1071
00:55:02,170 --> 00:55:07,010
to explain the rest that is
called Inter Quartile Range.

1072
00:55:07,010 --> 00:55:12,010
That is basically the difference
between Q3 and Q1 okay.

1073
00:55:12,730 --> 00:55:15,410
It means basically what is the difference

1074
00:55:16,520 --> 00:55:18,880
which range of values are between

1075
00:55:18,880 --> 00:55:20,723
this quartile and the top one.

1076
00:55:21,750 --> 00:55:24,943
And then came this guy called Joan Tukey.

1077
00:55:26,630 --> 00:55:30,010
Tukey, not Turkey and then
he said, well let's define

1078
00:55:30,010 --> 00:55:35,010
the range to see how much
value would variate okay.

1079
00:55:35,980 --> 00:55:39,030
And then he said, well, if
I we'll do like to analyze

1080
00:55:39,030 --> 00:55:40,890
the lowest point, I would take the Q1

1081
00:55:41,969 --> 00:55:44,290
and then I would take
the Inter Quartile Range,

1082
00:55:44,290 --> 00:55:49,150
multiply by one dot five
and subtract this to the Q1.

1083
00:55:49,150 --> 00:55:51,360
And I could he also propose

1084
00:55:51,360 --> 00:55:53,110
a definition of the higher value.

1085
00:55:53,110 --> 00:55:57,100
Let us take Q3, take
this Inter Quartile Range

1086
00:55:57,100 --> 00:56:01,423
this difference and then
multiply by one dot five okay?

1087
00:56:03,380 --> 00:56:07,950
These what's called Honest
Significance Difference

1088
00:56:07,950 --> 00:56:12,192
or Tukey's Test to define
this up and down value.

1089
00:56:13,587 --> 00:56:16,030
And then came this visualization,

1090
00:56:16,030 --> 00:56:18,930
who have you noticed this visualization?

1091
00:56:18,930 --> 00:56:22,183
Yes, it's a block box plot.

1092
00:56:22,183 --> 00:56:27,183
What you may know is that the
third quartile these value,

1093
00:56:27,240 --> 00:56:31,540
the second quartile is below,
the first quartile is this,

1094
00:56:31,540 --> 00:56:34,980
the difference in the box
is Inter Quartile Range.

1095
00:56:34,980 --> 00:56:38,363
This is the lowest value
and is the upper value.

1096
00:56:39,310 --> 00:56:42,743
This is the moment that
usually my students says, ah,

1097
00:56:44,080 --> 00:56:46,730
this is what the block box plot means.

1098
00:56:46,730 --> 00:56:49,560
Yes, and these values below

1099
00:56:49,560 --> 00:56:53,003
are actually the abnormal points okay.

1100
00:56:56,020 --> 00:56:57,940
And I put something at the corner

1101
00:56:57,940 --> 00:57:01,010
this is not a normal
distribution for these reasons

1102
00:57:01,010 --> 00:57:02,633
they fellows may be different.

1103
00:57:04,440 --> 00:57:08,730
So if you remember, I ask and
measure everything in August,

1104
00:57:08,730 --> 00:57:12,520
and then I saw that I gave 200mls

1105
00:57:12,520 --> 00:57:17,520
but she reached near 200ml
so thirsty, possibly.

1106
00:57:19,200 --> 00:57:22,419
And, but after I did this Tukey's Test,

1107
00:57:22,420 --> 00:57:25,535
I just took that value, the upper value

1108
00:57:25,535 --> 00:57:30,252
and then I asked my wife,
please let's give only 236.

1109
00:57:31,230 --> 00:57:33,543
And then these is the graph of September.

1110
00:57:35,390 --> 00:57:39,440
The max, so maximum that my daughter drunk

1111
00:57:39,440 --> 00:57:41,753
in all this month was 217.

1112
00:57:44,450 --> 00:57:46,942
Question, is she thirsty, was she?

1113
00:57:47,880 --> 00:57:49,380
No.

1114
00:57:49,380 --> 00:57:51,433
Is it clear so far?

1115
00:57:52,350 --> 00:57:57,029
So it means that instead of
that 17 liters, I actually,

1116
00:57:57,030 --> 00:58:01,000
it's better to buy 20 liters and guarantee

1117
00:58:01,000 --> 00:58:03,373
that she will not be thirsty.

1118
00:58:04,570 --> 00:58:08,070
And I could do these for their calculation

1119
00:58:08,070 --> 00:58:11,430
of the Tukey Tests per
month or could do it per day

1120
00:58:11,430 --> 00:58:13,270
or it could do per feeding,

1121
00:58:13,270 --> 00:58:17,333
compare it to some past
data, is that clear?

1122
00:58:18,180 --> 00:58:19,580
I hope so.

1123
00:58:19,580 --> 00:58:22,120
Now applying to ATT&CK's.

1124
00:58:22,120 --> 00:58:26,850
So if you're just now
take this graph I remove,

1125
00:58:26,850 --> 00:58:31,850
and I tell you that this graph
had the peak you right now.

1126
00:58:31,920 --> 00:58:36,000
And they say that this
graph represents the number

1127
00:58:36,000 --> 00:58:39,800
of signings of a user per day.

1128
00:58:39,800 --> 00:58:43,470
And then you look to the
graph, look the peak and say

1129
00:58:43,470 --> 00:58:48,470
well, if this is the
amount of signings per day,

1130
00:58:48,510 --> 00:58:51,920
what we have here, it's
a huge peak of signings.

1131
00:58:51,920 --> 00:58:56,530
Well, I know this guy,
this may be a brute force

1132
00:58:56,530 --> 00:59:01,210
because these abnormal points
there is clearly a brute force

1133
00:59:01,210 --> 00:59:05,020
or I just need to further investigate.

1134
00:59:05,020 --> 00:59:07,620
If I tell you that instead of this graph

1135
00:59:07,620 --> 00:59:11,350
being assignee frequence
its a network traffic

1136
00:59:11,350 --> 00:59:15,569
yeah, from one IP, sending
traffic outside the company.

1137
00:59:15,570 --> 00:59:17,993
And to see the speaker say hm,

1138
00:59:20,030 --> 00:59:22,883
this could be some type of Exfiltration.

1139
00:59:24,950 --> 00:59:29,950
And if I tell you that this
graph is the DNS traffic

1140
00:59:30,340 --> 00:59:35,070
is the DNS request
towards one domain name.

1141
00:59:35,070 --> 00:59:35,910
You could say, well,

1142
00:59:35,910 --> 00:59:38,723
this got to be a command
control communication.

1143
00:59:39,830 --> 00:59:43,620
Did you get the point here
is that you just need to use

1144
00:59:43,620 --> 00:59:48,620
the Tukey Test to compare debt
point to a previous points

1145
00:59:50,320 --> 00:59:54,370
or to a previous a number of points.

1146
00:59:54,370 --> 00:59:55,243
Is that clear?

1147
00:59:56,090 --> 00:59:57,216
I hope so.

1148
00:59:57,216 --> 00:59:59,720
Now I need to introduce Sentinel,

1149
00:59:59,720 --> 01:00:02,133
who of you have no clue what is Sentinel?

1150
01:00:03,670 --> 01:00:05,420
Maybe Mimet has no clue.

1151
01:00:05,420 --> 01:00:08,590
Sentinel is the seam,
the security information

1152
01:00:08,590 --> 01:00:12,020
and event management from Microsoft.

1153
01:00:12,020 --> 01:00:14,983
Cloud born offers whoever that is,

1154
01:00:15,940 --> 01:00:20,940
the behavior analytics and
automatic response with SOAR.

1155
01:00:22,590 --> 01:00:27,020
This is how it looks like
and Sentinel is for free.

1156
01:00:27,020 --> 01:00:29,150
You just need to pay for the data

1157
01:00:29,150 --> 01:00:31,200
that you'd need to ingest there.

1158
01:00:31,200 --> 01:00:33,350
Okay, jokers.

1159
01:00:33,350 --> 01:00:37,890
So why I like Sentinel first
is that you can integrate

1160
01:00:37,890 --> 01:00:40,379
all the Microsoft staffs.

1161
01:00:40,380 --> 01:00:42,910
The, well, if it's Microsoft thing

1162
01:00:42,910 --> 01:00:45,339
it's supposed to integrate
to Microsoft thing.

1163
01:00:45,340 --> 01:00:49,830
So, but I don't want to go
there it goes beyond yeah,

1164
01:00:49,830 --> 01:00:52,390
I discovered work with Sentinel and the,

1165
01:00:52,390 --> 01:00:56,290
my team of engineers, that we
can actually onboard any type

1166
01:00:56,290 --> 01:01:01,210
of data from any type of
security or no security box okay.

1167
01:01:01,210 --> 01:01:06,210
So let's say now that I
can put insight Sentinel

1168
01:01:06,370 --> 01:01:10,509
the identity management with
the signings logs remember,

1169
01:01:10,510 --> 01:01:14,813
or the firewall logs or the DNS server.

1170
01:01:17,640 --> 01:01:22,569
So what I like the most about Sentinel

1171
01:01:22,570 --> 01:01:25,640
is that is the flexibility.

1172
01:01:25,640 --> 01:01:28,900
Because I play with a lot of
things and we cannot write

1173
01:01:28,900 --> 01:01:33,520
everything that are predefined
templates that well, no.

1174
01:01:33,520 --> 01:01:37,248
So I'm a data driven person
so I want to use the data

1175
01:01:37,248 --> 01:01:40,990
as I want and not as
someone says for me to do.

1176
01:01:40,990 --> 01:01:45,029
So this is where we can
use the language defined

1177
01:01:45,030 --> 01:01:46,913
by Microsoft, that these a KQL.

1178
01:01:47,869 --> 01:01:51,690
And then when they start to
learning a Sentinel and teaching

1179
01:01:51,690 --> 01:01:56,690
to my team, I signed the
documentation that was a function

1180
01:01:57,030 --> 01:02:02,030
that implements exactly
the Tukey's Test, nice.

1181
01:02:02,550 --> 01:02:07,550
So remember these ATT&CKs,
this is what the KQL

1182
01:02:07,550 --> 01:02:10,270
looks more or less like.

1183
01:02:10,270 --> 01:02:13,247
So this is a in production KQL.

1184
01:02:14,890 --> 01:02:19,863
So basically I receive
firewall log data using Syslog.

1185
01:02:22,260 --> 01:02:24,883
I make a series okay.

1186
01:02:26,100 --> 01:02:29,529
And then I just get that series and ask,

1187
01:02:29,530 --> 01:02:34,530
use the function to calculate
what is the test of Tukey.

1188
01:02:35,510 --> 01:02:38,370
And then I can see which values

1189
01:02:38,370 --> 01:02:42,130
are higher than one dot five okay.

1190
01:02:42,130 --> 01:02:44,383
That one dot five times the EQR.

1191
01:02:46,300 --> 01:02:50,650
So basically here, I just
used one internal IP address,

1192
01:02:50,650 --> 01:02:54,479
communicating to an external
IP address or something

1193
01:02:54,479 --> 01:02:58,973
abnormal amount of Bytes
Sent in relation to the best.

1194
01:03:01,473 --> 01:03:03,740
But they need to tell you
what are the problems?

1195
01:03:03,740 --> 01:03:07,069
Well, how should you finetune yeah?

1196
01:03:07,070 --> 01:03:09,630
And how can you bring this life?

1197
01:03:09,630 --> 01:03:13,210
Because I usually recommend for you first,

1198
01:03:13,210 --> 01:03:16,810
before Bringing It Live
to test over the data.

1199
01:03:16,810 --> 01:03:19,520
If you do test with
the data that you have,

1200
01:03:19,520 --> 01:03:23,710
you will notice that these
type of graphs will appear.

1201
01:03:23,710 --> 01:03:27,900
So something that was
imagined that is outgoing data

1202
01:03:27,900 --> 01:03:32,900
from one single IP to
external IP addresses okay.

1203
01:03:33,490 --> 01:03:38,490
And then these IP address
was almost no activity

1204
01:03:38,580 --> 01:03:41,730
and suddenly there is a peak yeah.

1205
01:03:41,730 --> 01:03:44,520
When I ask the analysts in the SOC,

1206
01:03:44,520 --> 01:03:47,940
if they should trigger one
alarm, they say, of course, yeah.

1207
01:03:47,940 --> 01:03:51,183
I see clearly in the graph,
there is a clear peak.

1208
01:03:52,750 --> 01:03:56,800
But then to consider
these are exfiltration

1209
01:03:56,800 --> 01:04:01,800
I need to know how many
IPs these internal IP

1210
01:04:01,870 --> 01:04:04,940
are communicating, this one too many.

1211
01:04:04,940 --> 01:04:05,950
If there are many,

1212
01:04:05,950 --> 01:04:09,500
I don't know if I would
consider exfiltration.

1213
01:04:09,500 --> 01:04:13,300
So then the other question
is that if I run these

1214
01:04:13,300 --> 01:04:17,080
over and over my best time,
I don't know yesterday,

1215
01:04:17,080 --> 01:04:22,080
the day before or one hour
before and so on and so forth

1216
01:04:22,860 --> 01:04:25,253
do I notice these behavior again?

1217
01:04:27,100 --> 01:04:30,009
And you know, one of the
case, one of the customers,

1218
01:04:30,010 --> 01:04:33,750
we noticed that one over time,

1219
01:04:33,750 --> 01:04:36,950
some might be as he starts
having to speak yeah.

1220
01:04:36,950 --> 01:04:39,730
And then I asked them, well,
I sent a list of IPs and said,

1221
01:04:39,730 --> 01:04:42,360
well, these IPs have abnormal behavior

1222
01:04:42,360 --> 01:04:44,800
and we noticed that this
time, this time and this time,

1223
01:04:44,800 --> 01:04:49,070
and then they said, Jair these
lists of IPs are behind that

1224
01:04:49,070 --> 01:04:52,500
so every time away from the DHCP,

1225
01:04:52,500 --> 01:04:56,840
someone receives a new
IP and then a new IP

1226
01:04:56,840 --> 01:05:01,640
starts exchanges data ah, okay.

1227
01:05:01,640 --> 01:05:04,950
Another customer, we see
this behavior and the were

1228
01:05:04,950 --> 01:05:09,950
some peaks and then we ask
well, with did the tests

1229
01:05:10,230 --> 01:05:13,210
sent to the customer and they
said Jair these are specific

1230
01:05:13,210 --> 01:05:16,120
IP is over and over every month

1231
01:05:16,120 --> 01:05:18,513
they doing some backups okay.

1232
01:05:19,540 --> 01:05:23,320
And if these are the BDNS analysis, I,

1233
01:05:23,320 --> 01:05:27,220
or the DNS query is to a specific domain

1234
01:05:27,220 --> 01:05:29,000
well this is normal.

1235
01:05:29,000 --> 01:05:31,590
It's like, I tell you,
now I tell him the chat,

1236
01:05:31,590 --> 01:05:32,780
what is my webpage?

1237
01:05:32,780 --> 01:05:37,780
And everyone would access
that URL it means that

1238
01:05:38,260 --> 01:05:40,700
the number of DNS queries generated

1239
01:05:40,700 --> 01:05:43,020
within the company would be big.

1240
01:05:43,020 --> 01:05:47,470
The question is, is these the
normal or abnormal behavior?

1241
01:05:47,470 --> 01:05:48,980
Well, in this case,

1242
01:05:48,980 --> 01:05:53,980
it may be normal and not a
common control communication.

1243
01:05:53,990 --> 01:05:56,459
So all these nuances,

1244
01:05:56,460 --> 01:05:59,363
you need to finetune and
finetune with the customer.

1245
01:06:00,870 --> 01:06:04,759
So before you bring live tests,

1246
01:06:04,760 --> 01:06:07,380
using as much data as you can.

1247
01:06:07,380 --> 01:06:12,020
I tell my engineers to run
10,000 times this same algorithm,

1248
01:06:12,020 --> 01:06:16,500
just create a loop go back in
time and live the algorithm

1249
01:06:16,500 --> 01:06:18,980
running for the entire
night, giving me the data

1250
01:06:18,980 --> 01:06:21,910
and let's contact the customer.

1251
01:06:21,910 --> 01:06:24,910
To clarify to finetune your algorithm,

1252
01:06:24,910 --> 01:06:29,910
to add which IP should be
removed or which IP should be,

1253
01:06:32,490 --> 01:06:35,042
we cannot black list white
list anymore but okay.

1254
01:06:35,940 --> 01:06:40,940
But yeah remove or include,
yeah to be more whatever.

1255
01:06:42,820 --> 01:06:44,910
And then after you created this list,

1256
01:06:44,910 --> 01:06:47,653
you can bring your algorithm live.

1257
01:06:49,580 --> 01:06:52,750
Look into the future and
checking my time here

1258
01:06:52,750 --> 01:06:54,323
as I'm almost there.

1259
01:06:55,890 --> 01:06:59,910
Basically what I'm doing with
the academia with my students

1260
01:06:59,910 --> 01:07:02,410
is taking the entire list of MITRE

1261
01:07:03,420 --> 01:07:07,890
and then we are going one by
one there and try to create

1262
01:07:07,890 --> 01:07:11,129
a signature base rule using KQL.

1263
01:07:11,130 --> 01:07:14,010
And then in the second stage,

1264
01:07:14,010 --> 01:07:17,830
we do the same thing
using statistical methods,

1265
01:07:17,830 --> 01:07:19,703
like the Tukey's Test.

1266
01:07:20,560 --> 01:07:24,740
But we also use some
machine learning algorithms.

1267
01:07:24,740 --> 01:07:28,200
And then the KQL, you cannot write

1268
01:07:28,200 --> 01:07:30,009
a machine learning algorithms,

1269
01:07:30,010 --> 01:07:33,403
but Sentinel allow us
to use Jupyter notebook.

1270
01:07:34,830 --> 01:07:36,060
My life is saved.

1271
01:07:36,060 --> 01:07:40,240
Now we can bring all our crazy
machine learning algorithms

1272
01:07:40,240 --> 01:07:42,582
to use the data within Sentinel.

1273
01:07:43,850 --> 01:07:45,740
Now guys lets me go

1274
01:07:45,740 --> 01:07:50,729
my little one wants the
217 of milk or less.

1275
01:07:50,730 --> 01:07:51,783
Thank you very much.

1276
01:07:53,130 --> 01:07:56,020
- That was fantastic thank you,
I love the theme of the day

1277
01:07:56,020 --> 01:07:57,810
is the human connection to all of this.

1278
01:07:57,810 --> 01:08:00,270
So thank you for bringing your
family as well as your great

1279
01:08:00,270 --> 01:08:02,660
insight into the presentation
I really appreciate it.

1280
01:08:02,660 --> 01:08:04,460
So definitely hang around
and ask some questions

1281
01:08:04,460 --> 01:08:07,410
or answer questions in Slack
but I think we ran out of time

1282
01:08:08,360 --> 01:08:09,526
for any live Q%A and with that

1283
01:08:09,526 --> 01:08:11,089
just wanna thank you one more time

1284
01:08:11,090 --> 01:08:14,620
and pass it back over to Adam
to introduce our next speaker.

1285
01:08:14,620 --> 01:08:19,090
- Yeah hopefully we can get
switched over to Brandon slides

1286
01:08:19,090 --> 01:08:21,120
back to the main deck there we go.

1287
01:08:21,120 --> 01:08:23,729
Excellent so we're coming
to the home stretch now

1288
01:08:23,729 --> 01:08:27,859
just got two speakers left
and so gonna turn it over

1289
01:08:27,859 --> 01:08:29,912
to Brandon Levene from Google.

1290
01:08:36,270 --> 01:08:37,240
- All righty let me make sure

1291
01:08:37,240 --> 01:08:38,790
I can actually click on things.

1292
01:08:40,140 --> 01:08:42,623
Maybe, maybe.

1293
01:08:43,779 --> 01:08:45,712
Wow that's a lot of luck.

1294
01:08:46,970 --> 01:08:49,040
Hello everyone and welcome
to ATT&CKcon Power Hour.

1295
01:08:49,040 --> 01:08:51,430
My name is Brandon Levene
and I'm with Google Clouds,

1296
01:08:51,430 --> 01:08:53,750
threat intelligence team uppercase.

1297
01:08:53,750 --> 01:08:57,500
Today we'll be discussing a
threat group known as TA505.

1298
01:08:57,500 --> 01:09:00,319
Thanks for point a and
exploring their big game hunting

1299
01:09:00,319 --> 01:09:02,513
operations in the context of their TTPs.

1300
01:09:05,830 --> 01:09:09,143
Maybe, come on.

1301
01:09:13,020 --> 01:09:16,133
Hey Tom, do you wanna progress them?

1302
01:09:18,810 --> 01:09:22,390
Okay, nevermind, target
ransomware deployments are the new

1303
01:09:22,390 --> 01:09:24,740
scourge of enterprises across the globe.

1304
01:09:24,740 --> 01:09:27,450
The shifts to ransomware as
a primary monetization scheme

1305
01:09:27,450 --> 01:09:30,260
provides tremendous benefit
to threat actors who no longer

1306
01:09:30,260 --> 01:09:33,530
have to write up off upwards
of 70% of their profits

1307
01:09:33,529 --> 01:09:37,300
via a complex network of
money mules and laundry.

1308
01:09:37,300 --> 01:09:40,170
In order to maximize return on
investment threat actors now

1309
01:09:40,170 --> 01:09:42,760
accurately orient themselves
to their targets in order

1310
01:09:42,760 --> 01:09:45,490
to identify those that
are capable of paying.

1311
01:09:45,490 --> 01:09:49,639
To speeds businesses,
governments and municipalities

1312
01:09:50,819 --> 01:09:52,803
schools and hospitals.

1313
01:09:57,630 --> 01:09:59,520
This talk will be broken into four parts.

1314
01:09:59,520 --> 01:10:02,920
There'll be context and
background threat actor processes,

1315
01:10:02,920 --> 01:10:06,013
operational details and
lessons learned and takeaways.

1316
01:10:07,880 --> 01:10:10,473
Let's begin with some
context and background.

1317
01:10:14,220 --> 01:10:16,920
They are a customer of
Dridex a banking Trojan

1318
01:10:16,920 --> 01:10:19,530
and users of broadly
targeted ransomware families,

1319
01:10:19,530 --> 01:10:23,009
such as Lockheed between 2014 and 2017.

1320
01:10:23,010 --> 01:10:25,390
They're not the developers of these tools.

1321
01:10:25,390 --> 01:10:26,670
That would be EvilCorp,

1322
01:10:26,670 --> 01:10:31,255
thanks intel 471 per point and
NCC for that disambiguation.

1323
01:10:31,255 --> 01:10:34,140
TA505 moved on from
bespoke banking Trojans,

1324
01:10:34,140 --> 01:10:37,310
and non-targeted ransomware in 2018.

1325
01:10:37,310 --> 01:10:40,290
They begin to favor more
traditional backdoors for achieving

1326
01:10:40,290 --> 01:10:42,750
access into targets for opportunity.

1327
01:10:42,750 --> 01:10:46,010
Threat actors iterating
rapidly in both its initial

1328
01:10:46,010 --> 01:10:48,240
loaders and secondary payloads.

1329
01:10:48,240 --> 01:10:52,160
By late 2019, they settled
on solely in house tooling.

1330
01:10:52,160 --> 01:10:54,160
They've been using the
CLOP ransomware families

1331
01:10:54,160 --> 01:10:55,990
since February 2019,

1332
01:10:55,990 --> 01:10:57,900
and there don't appear
to be any other users.

1333
01:10:57,900 --> 01:10:59,410
So it's suspected that this is an

1334
01:10:59,410 --> 01:11:01,473
in house ransomware family as well.

1335
01:11:04,390 --> 01:11:08,083
Since 2018, TA505 activities has led to,

1336
01:11:09,980 --> 01:11:12,250
multiple high profile
victims in the Netherlands

1337
01:11:12,250 --> 01:11:14,690
Germany, Korea and more.

1338
01:11:14,690 --> 01:11:17,620
Unfortunately headlines
really do tell the tale here.

1339
01:11:17,620 --> 01:11:20,660
Ransomware pulls data
leak is a very strong

1340
01:11:20,660 --> 01:11:23,193
threat and it is a natural pair.

1341
01:11:25,660 --> 01:11:27,000
Well, some background out of the way,

1342
01:11:27,000 --> 01:11:30,873
let's move into what
TA5050 looks like now.

1343
01:11:33,000 --> 01:11:36,740
So credit to the French National
Cyber Security Agency, NC

1344
01:11:36,740 --> 01:11:39,800
for creating a great visual
representation of the initial

1345
01:11:39,800 --> 01:11:43,090
intrusion TTPs for TA505.

1346
01:11:43,090 --> 01:11:46,350
So TA505 generally
follows a well established

1347
01:11:46,350 --> 01:11:49,950
pattern in their initial
intrusion process.

1348
01:11:49,950 --> 01:11:53,559
This is composed of
roughly five or six steps.

1349
01:11:53,560 --> 01:11:56,510
If phishing email, social
engineering, no exploits,

1350
01:11:56,510 --> 01:11:59,210
user intervention is required here.

1351
01:11:59,210 --> 01:12:02,270
That attachment or Lincoln
sufficient email what's done

1352
01:12:02,270 --> 01:12:04,940
redirects to a legit
book compromised domain,

1353
01:12:04,940 --> 01:12:08,519
typically WordPress that
compromised domain redirects,

1354
01:12:08,520 --> 01:12:11,210
usually with some embedded
victim verification logic,

1355
01:12:11,210 --> 01:12:15,360
AKA a gate, much like an exploit
kit to a malicious domain.

1356
01:12:15,360 --> 01:12:18,469
And finally that malicious
domain drops an office document

1357
01:12:18,470 --> 01:12:22,270
with embedded macros and
binaries actually again,

1358
01:12:22,270 --> 01:12:24,690
user intervention is required.

1359
01:12:24,690 --> 01:12:28,950
Just to reiterate this diagram
is only covering the initial

1360
01:12:28,950 --> 01:12:32,543
efforts at TA505 goes through
just to land on target.

1361
01:12:35,320 --> 01:12:37,759
So now that we have a good
understanding of the multiple

1362
01:12:37,760 --> 01:12:41,250
intricate steps TA505 goes
through to land on target,

1363
01:12:41,250 --> 01:12:42,660
let's take a deeper look at how

1364
01:12:42,660 --> 01:12:45,143
this activity actually looks.

1365
01:12:50,390 --> 01:12:53,380
Here's the first thing that
target we'll see from TTA505

1366
01:12:53,380 --> 01:12:55,010
starting from the left.

1367
01:12:55,010 --> 01:12:56,880
On the left, we have some German language

1368
01:12:56,880 --> 01:12:57,720
spear phishing email

1369
01:12:57,720 --> 01:13:00,460
this is fairly recent
with an HTML attachment.

1370
01:13:00,460 --> 01:13:02,490
If anybody wants to
translate what this says,

1371
01:13:02,490 --> 01:13:05,420
I don't speak German, so feel free.

1372
01:13:05,420 --> 01:13:07,970
On the right hand side, we
actually have the contents

1373
01:13:07,970 --> 01:13:10,340
of the HTML phishing attachment that were,

1374
01:13:10,340 --> 01:13:12,780
that show an embedded
link with a fake error

1375
01:13:12,780 --> 01:13:14,519
and various nonessential padding.

1376
01:13:14,520 --> 01:13:18,060
The only part of this
HTML file that matters

1377
01:13:18,060 --> 01:13:20,760
is that embed source equals sign.

1378
01:13:20,760 --> 01:13:23,470
And that is pointing to a compromised

1379
01:13:23,470 --> 01:13:25,210
but legitimate WordPress site.

1380
01:13:33,830 --> 01:13:35,123
Apologies for the delay.

1381
01:13:40,070 --> 01:13:42,490
After user interacts with
the spear phishing attachment

1382
01:13:42,490 --> 01:13:43,690
and goes through the entire

1383
01:13:43,690 --> 01:13:45,790
redirection chain in the browser.

1384
01:13:45,790 --> 01:13:48,640
And we'll just document
typically a Microsoft Excel file

1385
01:13:48,640 --> 01:13:51,180
is forced downloaded
to the user's machine.

1386
01:13:51,180 --> 01:13:54,143
The user must then click
on this very enticing file.

1387
01:13:55,230 --> 01:13:59,700
A very interesting file
and enable content macros.

1388
01:13:59,700 --> 01:14:02,170
Which require two clicks and
modern versions of office.

1389
01:14:02,170 --> 01:14:04,350
I believe starting in 2016,

1390
01:14:04,350 --> 01:14:06,890
but I'm not sure when
that actually started.

1391
01:14:06,890 --> 01:14:09,130
The lore's documents have
undergone various degrees

1392
01:14:09,130 --> 01:14:12,280
of iteration to try and
trick into allowing macros.

1393
01:14:12,280 --> 01:14:15,070
On the left you see one
of their earlier examples

1394
01:14:15,070 --> 01:14:16,259
on the right end in the middle,

1395
01:14:16,260 --> 01:14:20,390
you see a more sophisticated
social engineering lore,

1396
01:14:20,390 --> 01:14:21,800
but the point is the same.

1397
01:14:21,800 --> 01:14:24,830
The user must click at
least twice at this point

1398
01:14:24,830 --> 01:14:26,843
in order to get code executing.

1399
01:14:32,650 --> 01:14:33,889
Thanks to hatching triage

1400
01:14:33,890 --> 01:14:36,060
for the lovely sandbox report here.

1401
01:14:36,060 --> 01:14:38,690
When a user allows the
macros and the XLS document

1402
01:14:38,690 --> 01:14:41,280
to execute two DLL files are written

1403
01:14:41,280 --> 01:14:43,990
to a folder in the app data directory.

1404
01:14:43,990 --> 01:14:47,040
These are a 32 bit and 64 bit version

1405
01:14:47,040 --> 01:14:49,880
of the same tool known as get to loader.

1406
01:14:49,880 --> 01:14:52,950
This is TA505 downloader
of choice that appears

1407
01:14:52,950 --> 01:14:55,313
to have been developed in house.

1408
01:15:04,380 --> 01:15:07,260
Once the DLLs embedded in
the malicious XLS document

1409
01:15:07,260 --> 01:15:10,070
are written internal logic
of the macro determines

1410
01:15:10,070 --> 01:15:13,830
whether to execute the
32 bit or 64 bit version

1411
01:15:13,830 --> 01:15:15,720
based on the operating system.

1412
01:15:15,720 --> 01:15:18,140
The selected DLL is
injected into the already

1413
01:15:18,140 --> 01:15:20,560
running Excel process and
in order to be traditional

1414
01:15:20,560 --> 01:15:23,830
detections that rely on
parent child oddities.

1415
01:15:23,830 --> 01:15:26,780
We can see in the top photo
Excel connecting to an external

1416
01:15:26,780 --> 01:15:29,190
IP as a result of the get to loader DLL,

1417
01:15:29,190 --> 01:15:31,730
being executed and injected.

1418
01:15:31,730 --> 01:15:34,169
The bottom image shows the HTP post body,

1419
01:15:34,170 --> 01:15:37,030
which has been SSL
decrypted that is sent back

1420
01:15:37,030 --> 01:15:38,500
to the attackers command controls.

1421
01:15:38,500 --> 01:15:41,617
So we see things like
computer name, username, OS.

1422
01:15:42,890 --> 01:15:44,530
It believes the architecture here

1423
01:15:44,530 --> 01:15:47,112
so it's x86 and a process list.

1424
01:15:54,030 --> 01:15:56,450
So not everyone will get the
step depending on what is sent

1425
01:15:56,450 --> 01:15:59,880
back in the HTTP post body of
the get to loader callback.

1426
01:15:59,880 --> 01:16:02,720
The threat actors can decide
to push an additional payload,

1427
01:16:02,720 --> 01:16:06,120
which is their full back
door known as SDB bot.

1428
01:16:06,120 --> 01:16:08,940
In this image, we see STB
bot establishing persistence

1429
01:16:08,940 --> 01:16:12,230
by writing code to the windows
registry and adding an image

1430
01:16:12,230 --> 01:16:15,219
file execution option
to win log on dot EXE.

1431
01:16:15,220 --> 01:16:17,973
This ensures that the malware
executes on every start.

1432
01:16:23,240 --> 01:16:27,000
Well, SDP bot is the main
backdoor tool used by TA505

1433
01:16:27,000 --> 01:16:29,030
at this point in time, the threat actors,

1434
01:16:29,030 --> 01:16:31,790
when opting to interact
with the victim manually,

1435
01:16:31,790 --> 01:16:34,120
will typically use a
more interactive implant,

1436
01:16:34,120 --> 01:16:36,349
such as tiny mat or beacon.

1437
01:16:36,350 --> 01:16:38,640
In this image, we see a tiny bite

1438
01:16:38,640 --> 01:16:40,440
side tiny mid-stage or stub,

1439
01:16:40,440 --> 01:16:43,190
which is used for pivoting
inside a victim network

1440
01:16:43,190 --> 01:16:45,210
and for various reconstitutes activities,

1441
01:16:45,210 --> 01:16:49,220
including mapping permissions
groups and privileged users.

1442
01:16:49,220 --> 01:16:51,620
Many organizations assume
that a signed binary

1443
01:16:51,620 --> 01:16:54,260
is an indication of trust, that is false.

1444
01:16:54,260 --> 01:16:57,350
A sign file simply means it
is cryptographically intact.

1445
01:16:57,350 --> 01:17:00,000
So you could have
cryptographically intact malware,

1446
01:17:00,000 --> 01:17:01,350
which is what you see here.

1447
01:17:06,080 --> 01:17:08,019
And finally, when it
comes to the end game.

1448
01:17:08,020 --> 01:17:11,060
When a victim is considered
viable and the manual recon

1449
01:17:11,060 --> 01:17:14,190
and staging is complete, a
ransomware pay mode is deployed.

1450
01:17:14,190 --> 01:17:15,190
Most typically CLOP.

1451
01:17:16,160 --> 01:17:17,870
Here, we see an example, ransom note

1452
01:17:17,870 --> 01:17:19,740
written as a simple TXT file,

1453
01:17:19,740 --> 01:17:23,460
which pops up on the host
after encryption has finished.

1454
01:17:23,460 --> 01:17:25,720
This is a pretty typical
ransom note that requests

1455
01:17:25,720 --> 01:17:27,710
the victims contact the
threat actor for payment

1456
01:17:27,710 --> 01:17:30,180
and negotiations, interestingly

1457
01:17:30,180 --> 01:17:32,600
they do not appear to set
up accounts per victim

1458
01:17:32,600 --> 01:17:34,100
I don't know if that's still the case

1459
01:17:34,100 --> 01:17:36,860
I believe it's still this, but
this is can actually be noted

1460
01:17:36,860 --> 01:17:39,210
in one of the later points
in this ransom note.

1461
01:17:42,610 --> 01:17:45,309
As a small bonus TA505 is one of the many

1462
01:17:45,310 --> 01:17:48,090
big game hunters, threat actors
that uses the threat of data

1463
01:17:48,090 --> 01:17:50,190
leakage as a strong arm tactic to entice

1464
01:17:50,190 --> 01:17:52,059
victims to pay a ransom.

1465
01:17:52,060 --> 01:17:54,750
They threatened to publish
files on a dedicated leak site

1466
01:17:54,750 --> 01:17:57,200
in the event of customer does not pay.

1467
01:17:57,200 --> 01:18:00,309
This tactic has been adopted
by many ransomware families

1468
01:18:00,310 --> 01:18:02,433
and has been devastatingly effective.

1469
01:18:03,490 --> 01:18:05,550
This has not been mapped
to MITRE ATT&CK yet,

1470
01:18:05,550 --> 01:18:08,560
but I am gonna work on actually
getting this particular

1471
01:18:08,560 --> 01:18:10,983
technique might map to the impact section.

1472
01:18:15,440 --> 01:18:16,980
Now that we've seen a high level example

1473
01:18:16,980 --> 01:18:20,160
of the way various TTPs fit
together, let's discuss what can

1474
01:18:20,160 --> 01:18:22,263
be learned by studying this threat actor.

1475
01:18:25,720 --> 01:18:28,830
Complimenting defense in
depth with detection in depth

1476
01:18:28,830 --> 01:18:32,910
is crucial to protecting
a modern enterprise.

1477
01:18:32,910 --> 01:18:34,450
Studying TTPs with an eye

1478
01:18:34,450 --> 01:18:36,420
towards interdiction opportunities.

1479
01:18:36,420 --> 01:18:37,780
Where should I see X?

1480
01:18:37,780 --> 01:18:39,219
How could I stop Y?

1481
01:18:39,220 --> 01:18:41,470
Should be your organization's
plan when considering

1482
01:18:41,470 --> 01:18:43,233
how best to use MITRE ATT&CK.

1483
01:18:44,170 --> 01:18:46,750
Detecting the ransomware is too late.

1484
01:18:46,750 --> 01:18:48,180
A long chain of activity

1485
01:18:48,180 --> 01:18:50,570
proceeded the ransomware deployment.

1486
01:18:50,570 --> 01:18:54,009
and finally attackers use a
blend of tools and techniques.

1487
01:18:54,010 --> 01:18:56,417
Open source or red team tools on GitHub

1488
01:18:56,417 --> 01:18:58,890
are no less capable of
getting the job done.

1489
01:18:58,890 --> 01:19:00,980
And are arguably a higher ROI

1490
01:19:00,980 --> 01:19:04,370
and significantly more accessible.

1491
01:19:04,370 --> 01:19:06,420
Thank you and I'll hand it back to Jamie.

1492
01:19:07,970 --> 01:19:09,659
- Awesome, thank you,
Brandon that was fantastic.

1493
01:19:09,659 --> 01:19:12,799
I think one of the unintended unplanned,

1494
01:19:12,800 --> 01:19:14,910
like themes of the day was
the human behind the keyboard

1495
01:19:14,910 --> 01:19:16,940
and how much that plays
into these attacks.

1496
01:19:16,940 --> 01:19:18,960
I think your presentation here
really kind of highlighted

1497
01:19:18,960 --> 01:19:21,810
that with the optimistic
nature of it is like, you know,

1498
01:19:21,810 --> 01:19:24,120
the initial access that you
went through was all based on

1499
01:19:24,120 --> 01:19:26,990
users, you know, clicking
things, they shouldn't, you know,

1500
01:19:26,990 --> 01:19:28,800
enabling things that, you
know, otherwise, you know,

1501
01:19:28,800 --> 01:19:30,640
defenses otherwise would protect.

1502
01:19:30,640 --> 01:19:32,050
But what are your thoughts on, you know,

1503
01:19:32,050 --> 01:19:35,380
as a community, what can we
do in terms of, you know,

1504
01:19:35,380 --> 01:19:37,550
minimizing that, so like
you said, the full chain

1505
01:19:37,550 --> 01:19:41,040
of behaviors that kind of spun
from that one bad decision,

1506
01:19:41,040 --> 01:19:42,860
what can we do with the
community to kind of minimize

1507
01:19:42,860 --> 01:19:44,963
the impact or the likelihood of that?

1508
01:19:45,930 --> 01:19:48,880
- So I think really one of
the main takeaways for me

1509
01:19:48,880 --> 01:19:53,060
is that studying the way
the TTPs fit together

1510
01:19:53,060 --> 01:19:54,650
is of paramount importance.

1511
01:19:54,650 --> 01:19:58,710
You know and we've sort of
espoused this idea of defense

1512
01:19:58,710 --> 01:20:01,420
in depth, but that hasn't really
kept pace with the concept

1513
01:20:01,420 --> 01:20:04,050
of detection in depth, we're
in, you need to consider,

1514
01:20:04,050 --> 01:20:06,547
how can I see this, where can I stop that

1515
01:20:06,547 --> 01:20:07,719
and how I stop, why?

1516
01:20:07,720 --> 01:20:09,700
And those are really critical
questions to consider

1517
01:20:09,700 --> 01:20:11,980
when creating a detection program.

1518
01:20:11,980 --> 01:20:14,874
And MITRE ATT&CK is a great
guideline to help inform

1519
01:20:14,874 --> 01:20:17,559
those sorts of sorts of decisions.

1520
01:20:17,560 --> 01:20:19,740
As Brian mentioned
earlier, he was talking,

1521
01:20:19,740 --> 01:20:21,820
there was a lot of art behind the science

1522
01:20:21,820 --> 01:20:23,719
and a little bit of science to the art

1523
01:20:24,910 --> 01:20:28,340
but I think it is really important
to understand how the big

1524
01:20:28,340 --> 01:20:30,840
picture really fits
together because, you know,

1525
01:20:30,840 --> 01:20:33,610
when you start to try to
detect this that ransomware,

1526
01:20:33,610 --> 01:20:35,009
you have missed, you know,

1527
01:20:35,010 --> 01:20:38,160
five or six different
interdiction opportunities.

1528
01:20:38,160 --> 01:20:41,120
- It's a great point, it's like
you said, plan for the best

1529
01:20:41,120 --> 01:20:43,700
but assume the worst and
kind of like, you know,

1530
01:20:43,700 --> 01:20:45,860
know all the steps along the
path that you could possibly

1531
01:20:45,860 --> 01:20:47,570
interject and have a
detection opportunity.

1532
01:20:47,570 --> 01:20:49,269
It's really great advice, thank you.

1533
01:20:49,270 --> 01:20:50,840
With that I'm going to obviously

1534
01:20:50,840 --> 01:20:52,130
thank you for your great presentation.

1535
01:20:52,130 --> 01:20:54,420
Thank you for your time and
sharing with us and then

1536
01:20:54,420 --> 01:20:57,000
pinned it over to Adam
for the introduction

1537
01:20:57,000 --> 01:20:59,060
of our last speaker for the day.

1538
01:20:59,060 --> 01:21:00,280
- Yeah thank you, Jamie.

1539
01:21:00,280 --> 01:21:03,639
So our last speaker today
is actually gonna be someone

1540
01:21:03,640 --> 01:21:07,030
from the ATT&CK team,
you're gonna be switching

1541
01:21:07,030 --> 01:21:11,580
to Jen Burns, who is the
lead for ATT&CK for Cloud?

1542
01:21:11,580 --> 01:21:13,230
Take it away, Jen.

1543
01:21:13,230 --> 01:21:15,330
- Sure thanks Adam and hey everybody,

1544
01:21:15,330 --> 01:21:17,660
I'm Jen Burns a lead of ATT&CK for Cloud,

1545
01:21:17,660 --> 01:21:19,230
like Adam mentioned,

1546
01:21:19,230 --> 01:21:22,450
and really excited to talk
to you all about what's new

1547
01:21:22,450 --> 01:21:24,423
and upcoming in this area for ATT&CK.

1548
01:21:27,130 --> 01:21:30,560
So to give a bit of a
background on ATT&CK for Cloud,

1549
01:21:30,560 --> 01:21:33,916
it was actually at the first
ATT&CK on where Dave Herrald

1550
01:21:33,916 --> 01:21:36,820
and Ryan Kovar presented this slide

1551
01:21:36,820 --> 01:21:38,610
that I graciously stole from them

1552
01:21:38,610 --> 01:21:41,190
and can't take credit for, in their talk

1553
01:21:41,190 --> 01:21:45,040
they express a need for
expanding ATT&CK into the cloud

1554
01:21:45,040 --> 01:21:48,120
this also ended up being
a fairly common request

1555
01:21:48,120 --> 01:21:51,690
from the community, so about
a year ago or what now,

1556
01:21:51,690 --> 01:21:54,690
I guess seems like about 10
years ago in COVID years,

1557
01:21:54,690 --> 01:21:58,330
the ATT&CK team was able
to turn that cloud frown

1558
01:21:58,330 --> 01:22:01,607
upside down and add cloud
techniques into ATT&CK.

1559
01:22:03,960 --> 01:22:05,920
So ATT&CK for Cloud was added

1560
01:22:05,920 --> 01:22:07,270
as a part of Enterprise ATT&CK.

1561
01:22:07,270 --> 01:22:11,680
It really was and continues
to be a community effort.

1562
01:22:11,680 --> 01:22:15,120
Almost a 100% of the initial
release of ATT&CK for Cloud

1563
01:22:15,120 --> 01:22:18,920
was contributed by the
community that initial

1564
01:22:18,920 --> 01:22:23,440
and also the current release
cover AWS Azure and GCP,

1565
01:22:23,440 --> 01:22:27,120
as well as Office 365 as
your active directory,

1566
01:22:27,120 --> 01:22:30,253
and also kind of a
generalized SAS platform.

1567
01:22:32,340 --> 01:22:36,120
With the release of sub techniques
in July came a re-factor

1568
01:22:36,120 --> 01:22:39,340
of ATT&CK for Cloud to
also add sub techniques

1569
01:22:39,340 --> 01:22:42,580
with that update, we also
added some new infrastructures,

1570
01:22:42,580 --> 01:22:46,309
a service techniques, and some
techniques like modify cloud

1571
01:22:46,310 --> 01:22:48,750
compute infrastructure
within defensive aviation

1572
01:22:48,750 --> 01:22:52,260
and we made some improvements
to ensure that every technique

1573
01:22:52,260 --> 01:22:55,360
in cloud had some sort of a description

1574
01:22:55,360 --> 01:22:57,809
on how it fits into cloud.

1575
01:22:57,810 --> 01:23:01,230
As always so if you see
gaps in the cloud matrices,

1576
01:23:01,230 --> 01:23:03,599
please feel free to
send us a new technique

1577
01:23:03,600 --> 01:23:08,010
and sub technique submitions
we love contributions you know,

1578
01:23:08,010 --> 01:23:09,700
definitely hope to just
continue to work with you,

1579
01:23:09,700 --> 01:23:11,820
to make ATT&CK for Cloud as usable

1580
01:23:11,820 --> 01:23:13,393
as possible for the community.

1581
01:23:15,830 --> 01:23:18,980
So with making things as
usable as possible in mind

1582
01:23:18,980 --> 01:23:22,580
just wanted to take a moment
to kind of explain what we,

1583
01:23:22,580 --> 01:23:23,730
consider to be the scope

1584
01:23:23,730 --> 01:23:25,860
of ATT&CK for Cloud as an ATT&CK team.

1585
01:23:25,860 --> 01:23:28,330
Really, you can use ATT&CK including cloud

1586
01:23:28,330 --> 01:23:29,797
in whatever way works for you.

1587
01:23:29,797 --> 01:23:32,719
But this is how we view
like adding techniques

1588
01:23:32,720 --> 01:23:34,643
into a cloud platform with an ATT&CK.

1589
01:23:35,520 --> 01:23:38,060
One thing that we determined
is if the technique

1590
01:23:38,060 --> 01:23:41,390
is generally visible
via cloud data sources,

1591
01:23:41,390 --> 01:23:43,040
if you're familiar with, you know,

1592
01:23:43,040 --> 01:23:45,400
the shared responsibilities
model of cloud service

1593
01:23:45,400 --> 01:23:48,530
providers, these are data sources that you

1594
01:23:48,530 --> 01:23:51,320
as a customer have visibility into

1595
01:23:51,320 --> 01:23:53,519
and are generally responsible for.

1596
01:23:53,520 --> 01:23:55,380
To think of it and kind
of the opposite way

1597
01:23:55,380 --> 01:23:58,850
the cloud matrices generally
don't contain techniques that

1598
01:23:58,850 --> 01:24:02,770
only the cloud service providers
would have visibility into.

1599
01:24:02,770 --> 01:24:04,240
We might find that, you know,

1600
01:24:04,240 --> 01:24:06,300
there are exceptions to this over time,

1601
01:24:06,300 --> 01:24:08,690
especially when it comes to SAS providers,

1602
01:24:08,690 --> 01:24:11,740
but for the most part, this
is what we're scoping for.

1603
01:24:11,740 --> 01:24:15,120
And then additionally, when
we scope cloud techniques,

1604
01:24:15,120 --> 01:24:18,390
the team works to minimize
that duplication of techniques

1605
01:24:18,390 --> 01:24:21,650
in cloud, across those
found in like the windows,

1606
01:24:21,650 --> 01:24:24,087
Linux and MacOS major scenes.

1607
01:24:24,087 --> 01:24:27,760
ATT&CK for Cloud is really meant
to provide a separate layer

1608
01:24:27,760 --> 01:24:29,500
of coverage of adversary behavior

1609
01:24:29,500 --> 01:24:32,240
that's focused specifically on cloud.

1610
01:24:32,240 --> 01:24:35,420
So for example, consider
like an adversary,

1611
01:24:35,420 --> 01:24:40,100
creating a Cron job on Linux
ECE2 instance or an Azure VM.

1612
01:24:40,100 --> 01:24:42,940
Even though that technique
was carried out in the cloud

1613
01:24:42,940 --> 01:24:46,000
environment, that's covered
by the Linux matrix.

1614
01:24:46,000 --> 01:24:48,720
So we generally wouldn't
add that technique to cloud,

1615
01:24:48,720 --> 01:24:50,260
unless there's something that makes it

1616
01:24:50,260 --> 01:24:52,513
specifically unique to cloud.

1617
01:24:54,190 --> 01:24:57,360
So to kind of start digging
in a bit into the future

1618
01:24:57,360 --> 01:25:00,339
of ATT&CK for Cloud, first
thing I wanna talk about

1619
01:25:00,340 --> 01:25:02,360
is the future of cloud platforms.

1620
01:25:02,360 --> 01:25:04,809
And as a heads up, none of these proposed

1621
01:25:04,810 --> 01:25:09,070
changes are going to be
added to ATT&CK until 2021.

1622
01:25:09,070 --> 01:25:11,969
We wanna make sure to give you
time to give us your feedback

1623
01:25:11,970 --> 01:25:15,100
on this and plan for any of these updates.

1624
01:25:15,100 --> 01:25:17,967
So right now on the left of
these are the current platforms

1625
01:25:17,967 --> 01:25:21,690
in ATT&CK for Cloud after
doing some research,

1626
01:25:21,690 --> 01:25:23,660
talking with folks in the community,

1627
01:25:23,660 --> 01:25:27,400
we're planning in a future
release to consolidate Azure,

1628
01:25:27,400 --> 01:25:30,809
AWS, and GCP into a single infrastructure

1629
01:25:30,810 --> 01:25:33,340
as a service platform and then continue

1630
01:25:33,340 --> 01:25:35,280
to add additional SAS platforms to ATT&CK.

1631
01:25:35,280 --> 01:25:39,349
There are a few SAS platforms
we've been considering

1632
01:25:39,350 --> 01:25:42,110
for potential future
inclusion in to ATT&CK

1633
01:25:42,110 --> 01:25:45,820
we'd also be really curious
on your feedback here on your,

1634
01:25:45,820 --> 01:25:48,290
in the wild experience
with adversaries here.

1635
01:25:48,290 --> 01:25:50,360
So we can kind of continue to increase

1636
01:25:50,360 --> 01:25:51,843
coverage in this space.

1637
01:25:55,070 --> 01:25:57,610
So some of you are
probably wondering why that

1638
01:25:57,610 --> 01:26:00,450
generalization into
infrastructure as a service.

1639
01:26:00,450 --> 01:26:02,320
Well, the first reason is that

1640
01:26:02,320 --> 01:26:04,639
the current infrastructure
to service platforms

1641
01:26:04,640 --> 01:26:07,160
already share most
techniques across ATT&CK.

1642
01:26:07,160 --> 01:26:09,830
We realized there are some exceptions here

1643
01:26:09,830 --> 01:26:11,500
and there will be in the future.

1644
01:26:11,500 --> 01:26:13,870
So those exceptions, we plan to document

1645
01:26:13,870 --> 01:26:16,550
in the descriptions and other fields

1646
01:26:16,550 --> 01:26:20,290
of the individual
techniques for transparency.

1647
01:26:20,290 --> 01:26:22,970
Another reason for this
change is it helps to broaden

1648
01:26:22,970 --> 01:26:26,220
the scope of ATT&CK across
other cloud service providers

1649
01:26:26,220 --> 01:26:29,930
in addition to Azure, AWS, and GCP.

1650
01:26:29,930 --> 01:26:32,540
And then finally, and
probably most importantly,

1651
01:26:32,540 --> 01:26:35,610
the community feedback we've
received here favors a single

1652
01:26:35,610 --> 01:26:37,549
infrastructure as a service platform.

1653
01:26:37,550 --> 01:26:41,040
A survey at the EU ATT&CK
conference earlier in the year

1654
01:26:41,040 --> 01:26:43,650
showed that many supported this

1655
01:26:43,650 --> 01:26:46,799
and pretty much the first
question I usually get from people

1656
01:26:46,800 --> 01:26:50,040
when I talk about ATT&CK for
Cloud is why the infrastructure

1657
01:26:50,040 --> 01:26:52,190
as a service platforms are split out.

1658
01:26:52,190 --> 01:26:55,219
So we're definitely interested
in your feedback here though

1659
01:26:55,220 --> 01:26:57,990
please feel free to reach out
once again with any thoughts

1660
01:26:57,990 --> 01:26:59,163
you may have on this.

1661
01:27:01,620 --> 01:27:02,800
Next thing I wanna talk about

1662
01:27:02,800 --> 01:27:05,730
is plans for Cloud Data
Sources moving forward.

1663
01:27:05,730 --> 01:27:08,910
So right now, almost
every Cloud Data Source

1664
01:27:08,910 --> 01:27:11,820
especially in infrastructure
as a service is just logs.

1665
01:27:11,820 --> 01:27:15,019
We realized that these may
not be the most helpful data

1666
01:27:15,020 --> 01:27:19,130
sources as they're pretty
general and can be really vast

1667
01:27:19,130 --> 01:27:22,103
so we planned for some
future updates here as well.

1668
01:27:25,080 --> 01:27:28,750
I'm not sure how many of you
have seen Jose Rodriguez post

1669
01:27:28,750 --> 01:27:31,310
a blog post about the
future of data sources

1670
01:27:31,310 --> 01:27:34,060
for enterprise ATT&CK, but
we're also moving in that

1671
01:27:34,060 --> 01:27:36,360
direction with our Cloud Data Sources.

1672
01:27:36,360 --> 01:27:40,070
So the idea here is that you
have a single data source

1673
01:27:40,070 --> 01:27:43,519
it has one or more of these
things called data components

1674
01:27:43,520 --> 01:27:46,410
and then as contributed
from the ATT&CK team

1675
01:27:46,410 --> 01:27:50,090
or the community, there can
be mappings to relevant events

1676
01:27:50,090 --> 01:27:52,440
and APIs from the various clubs

1677
01:27:52,440 --> 01:27:54,549
service providers and SAS providers.

1678
01:27:54,550 --> 01:27:58,250
We really hope to move away
from that general logs approach

1679
01:27:58,250 --> 01:28:01,020
and start moving towards
something that's a more meaningful

1680
01:28:01,020 --> 01:28:03,153
set of data sources for our users.

1681
01:28:06,060 --> 01:28:09,690
So here's an example of what
the instance data source

1682
01:28:09,690 --> 01:28:12,500
may look like a shout out to Matt Beshek

1683
01:28:12,500 --> 01:28:14,830
on the ATT&CK team who
did a lot of this work.

1684
01:28:14,830 --> 01:28:18,210
So we have the data source on the left,

1685
01:28:18,210 --> 01:28:20,327
which is instance in this case.

1686
01:28:20,327 --> 01:28:24,010
And we have multiple data
components that basically consists

1687
01:28:24,010 --> 01:28:27,540
of like operations on that data source.

1688
01:28:27,540 --> 01:28:29,950
And then you can map one
or more relevant events

1689
01:28:29,950 --> 01:28:32,740
to each data component
based on the cloud service

1690
01:28:32,740 --> 01:28:35,010
provider or SAS providers offerings.

1691
01:28:35,010 --> 01:28:36,820
Obviously we still have
a lot of work to do

1692
01:28:36,820 --> 01:28:38,299
in this area as a team,

1693
01:28:38,300 --> 01:28:41,450
but we really wanted to get
you all kind of a sneak peak

1694
01:28:41,450 --> 01:28:43,303
so you know what our plans are here.

1695
01:28:45,580 --> 01:28:48,080
And just to recap what we're planning

1696
01:28:48,080 --> 01:28:50,290
on updating cloud data sources, first off,

1697
01:28:50,290 --> 01:28:52,730
we want to ensure that we're consistent

1698
01:28:52,730 --> 01:28:54,290
with the rest of enterprise.

1699
01:28:54,290 --> 01:28:57,940
I do recommend checking
out that blog by Jose

1700
01:28:57,940 --> 01:29:00,269
to see what our plans are in that area.

1701
01:29:00,270 --> 01:29:01,560
We also just wanna make sure

1702
01:29:01,560 --> 01:29:04,280
data sources are more meaningful.

1703
01:29:04,280 --> 01:29:06,400
A feedback suggests that you know,

1704
01:29:06,400 --> 01:29:07,860
that everything is logs approach

1705
01:29:07,860 --> 01:29:10,730
isn't super helpful for
building things like detections

1706
01:29:10,730 --> 01:29:12,759
so we wanna refactor to, you know,

1707
01:29:12,760 --> 01:29:15,590
align to events and API calls instead.

1708
01:29:15,590 --> 01:29:18,030
And also we wanna ensure that
our data sources approach

1709
01:29:18,030 --> 01:29:22,099
is consistent with that plan
for consolidating AWS, Azure

1710
01:29:22,099 --> 01:29:25,603
and GCP, and to infrastructure
as a service as a platform.

1711
01:29:26,470 --> 01:29:30,040
We're hoping to make the data
sources and data components

1712
01:29:30,040 --> 01:29:32,790
general enough across the
cloud service providers

1713
01:29:32,790 --> 01:29:34,523
that they're usable across all.

1714
01:29:36,780 --> 01:29:39,969
And finally, I just wanna put
out a call to the community

1715
01:29:39,970 --> 01:29:42,770
to help us make ATT&CK for
Cloud as useful as possible.

1716
01:29:42,770 --> 01:29:45,590
First, please let us know
if you have any thoughts

1717
01:29:45,590 --> 01:29:47,610
on how we can improve ATT&CK for Cloud

1718
01:29:47,610 --> 01:29:50,259
you're the ones with boots
on the ground using it

1719
01:29:50,260 --> 01:29:52,260
we wanna make sure that it works for you.

1720
01:29:52,260 --> 01:29:55,160
Also, we need your help
to continue to add,

1721
01:29:55,160 --> 01:29:57,900
to and improve ATT&CK for
Cloud please reach out

1722
01:29:57,900 --> 01:30:01,420
if you have in the wild
visibility into what adversaries

1723
01:30:01,420 --> 01:30:04,910
are doing in this space and
send us your contributions.

1724
01:30:04,910 --> 01:30:08,230
Also, if you have opinions on
the future platforms or data

1725
01:30:08,230 --> 01:30:09,709
sources updates that we're planning

1726
01:30:09,710 --> 01:30:13,060
please let us know nothing
is set in stone yet

1727
01:30:13,060 --> 01:30:14,750
we wanna make sure that these changes

1728
01:30:14,750 --> 01:30:16,903
are what's going to work the best for you.

1729
01:30:18,400 --> 01:30:21,719
And as always, you can reach
out to us at attack@mitre.org

1730
01:30:21,720 --> 01:30:23,410
with any of that feedback,

1731
01:30:23,410 --> 01:30:25,700
feel free to follow me
on Twitter @snarejen

1732
01:30:25,700 --> 01:30:29,500
if you like Drums Katz or
ATT&CK, and then you can follow

1733
01:30:29,500 --> 01:30:33,050
ATT&CK @MITREattack to
stay up to date, thanks.

1734
01:30:33,050 --> 01:30:34,190
- Awesome, thanks Jen.

1735
01:30:34,190 --> 01:30:36,910
Like I said, the Slack's
going crazy with questions,

1736
01:30:36,910 --> 01:30:39,269
comments, so definitely
hop over there and respond,

1737
01:30:39,270 --> 01:30:40,160
but thank you for the updates.

1738
01:30:40,160 --> 01:30:42,320
It's really exciting to
see how much cloud has gone

1739
01:30:42,320 --> 01:30:44,410
from like, you know,
initial drop to, you know,

1740
01:30:44,410 --> 01:30:45,730
growing and to where it is today

1741
01:30:45,730 --> 01:30:46,562
and where it's going forward.

1742
01:30:46,563 --> 01:30:48,210
So definitely appreciate your sharing,

1743
01:30:48,210 --> 01:30:49,920
all this great insight with us.

1744
01:30:49,920 --> 01:30:51,380
And with that, I'm gonna
turn it over to Adam

1745
01:30:51,380 --> 01:30:53,270
for a sign off for the day.

1746
01:30:53,270 --> 01:30:56,170
- Yeah, yeah and sorry we've
gone a few minutes over today,

1747
01:30:56,170 --> 01:30:58,990
but thank you to all of
our speakers for coming

1748
01:30:58,990 --> 01:31:01,130
for making this, what it was today,

1749
01:31:01,130 --> 01:31:04,380
as well as to our communications
team for all of their help

1750
01:31:04,380 --> 01:31:07,453
try putting this on and thank you

1751
01:31:07,453 --> 01:31:09,310
for actually joining us.

1752
01:31:09,310 --> 01:31:11,350
There's been some great
discussions in our Slack,

1753
01:31:11,350 --> 01:31:13,140
as Jamie said, which will hopefully

1754
01:31:13,140 --> 01:31:14,650
keep going after we're done here

1755
01:31:14,650 --> 01:31:17,769
we're not gonna close up
shop as soon as we're done.

1756
01:31:17,770 --> 01:31:19,293
Links to videos and slides from today

1757
01:31:19,293 --> 01:31:21,849
will be emailed to
everyone who's registered

1758
01:31:21,850 --> 01:31:24,540
as soon as we're ready to put them online.

1759
01:31:24,540 --> 01:31:27,610
Please join us for our
next ATT&CKcon Power Hour

1760
01:31:27,610 --> 01:31:31,250
on November 12th,
registration is open today

1761
01:31:31,250 --> 01:31:33,223
and again, thank you for joining us.

