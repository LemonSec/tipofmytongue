1
00:00:01,060 --> 00:00:02,080
- [Katie] Please join me in welcoming

2
00:00:02,080 --> 00:00:04,715
for our Lightning Talks, Adam Pennington.

3
00:00:04,715 --> 00:00:08,119
(crowd applauding)

4
00:00:08,119 --> 00:00:08,953
- Thank you, Katy

5
00:00:08,953 --> 00:00:11,320
and hopefully we'll
get the slides up soon.

6
00:00:11,320 --> 00:00:14,090
So lots of people have talked

7
00:00:14,090 --> 00:00:16,890
about in the past that
they really liked some

8
00:00:16,890 --> 00:00:20,090
of the short talks that
this conference has done,

9
00:00:20,090 --> 00:00:22,663
that we don't have any 50 minute talks.

10
00:00:23,750 --> 00:00:27,200
We're just doing short
all the way through.

11
00:00:27,200 --> 00:00:29,490
So this is gonna be even shorter.

12
00:00:29,490 --> 00:00:32,089
Just a couple weeks ago,
we put out just a call

13
00:00:32,090 --> 00:00:34,950
for presentations asking people to give us

14
00:00:34,950 --> 00:00:39,670
their five minute pithy war
stories, their half-baked ideas,

15
00:00:39,670 --> 00:00:42,450
and I think people
really delivered on that.

16
00:00:42,450 --> 00:00:45,520
It was selective, so we had more than

17
00:00:45,520 --> 00:00:47,450
just the people up here today.

18
00:00:47,450 --> 00:00:48,560
We're gonna be running these back

19
00:00:48,560 --> 00:00:50,433
to back, there's no time for Q&A.

20
00:00:51,590 --> 00:00:53,970
We're gonna be going strictly
timed to five minutes.

21
00:00:53,970 --> 00:00:56,330
I'm gonna be showing you the
timings that the speakers are

22
00:00:56,330 --> 00:00:58,940
also seeing so that you
know how close they're

23
00:00:58,940 --> 00:01:00,050
actually gonna get.

24
00:01:00,050 --> 00:01:00,919
(crowd applauding)
- Hi, everybody,

25
00:01:00,920 --> 00:01:01,810
I'm Brian Donohue.

26
00:01:01,810 --> 00:01:03,790
I work at Red Canary.

27
00:01:03,790 --> 00:01:07,039
I've worked on last year's
threat detection report.

28
00:01:07,040 --> 00:01:08,360
I helped produce and write that.

29
00:01:08,360 --> 00:01:09,790
I'm currently helping produce

30
00:01:09,790 --> 00:01:12,260
and write this year's
threat detection report.

31
00:01:12,260 --> 00:01:14,550
And in the spirit of getting

32
00:01:14,550 --> 00:01:17,660
to the point quickly in
case I get cut off, I think

33
00:01:17,660 --> 00:01:19,080
that everyone should be taking

34
00:01:19,080 --> 00:01:20,410
the threats that they observe

35
00:01:20,410 --> 00:01:21,243
on their network,

36
00:01:21,243 --> 00:01:24,449
whether it's their own
enterprise's network

37
00:01:24,450 --> 00:01:26,000
or maybe it's the network that,

38
00:01:27,202 --> 00:01:29,080
or the network that
your customers that you

39
00:01:29,080 --> 00:01:32,450
are monitoring in the course of business.

40
00:01:32,450 --> 00:01:34,990
I think we should take all
of those threats, map them

41
00:01:34,990 --> 00:01:36,009
to MITRE ATT&CK

42
00:01:36,010 --> 00:01:38,900
and then release what we find in the

43
00:01:38,900 --> 00:01:41,030
form of prevalence ratings.

44
00:01:41,030 --> 00:01:43,180
And the reason I wanna do
this is I think we should be

45
00:01:43,180 --> 00:01:47,457
creating a grand unified
MITRE ATT&CK heat map.

46
00:01:47,457 --> 00:01:49,679
And the reason I think
we should do that is

47
00:01:49,680 --> 00:01:50,513
because I don't know

48
00:01:50,513 --> 00:01:52,660
that we make really great
scientific decisions

49
00:01:52,660 --> 00:01:55,860
about how we resource
allocate in security.

50
00:01:55,860 --> 00:01:58,560
So the other day I was reading
an article on Cyber Scoop

51
00:01:58,560 --> 00:02:02,560
and it was about how the
security insurance companies

52
00:02:02,560 --> 00:02:06,080
are gonna be positioned to
dictate the tools that we buy.

53
00:02:06,080 --> 00:02:08,359
So they create a white
list, if you buy a tool on

54
00:02:08,360 --> 00:02:11,460
the white list, you get a
discount on your premium.

55
00:02:11,460 --> 00:02:14,380
And my initial thought was,
"Wow, that's a horrible idea."

56
00:02:14,380 --> 00:02:16,470
And then I thought about it a bit and it's

57
00:02:16,470 --> 00:02:18,530
like, "Who's more incentivized

58
00:02:18,530 --> 00:02:20,530
to make sure you don't get breached than

59
00:02:20,530 --> 00:02:23,330
the company that's gonna have
to pay for it when you do?"

60
00:02:23,330 --> 00:02:24,163
So that got me

61
00:02:24,163 --> 00:02:27,180
thinking, "How do we make
these decisions as is?"

62
00:02:27,180 --> 00:02:30,103
And I got a list, it's incomplete.

63
00:02:30,103 --> 00:02:33,180
I'll just say, ahead of time, it's a list.

64
00:02:33,180 --> 00:02:36,050
Each item on the list has pros and cons.

65
00:02:36,050 --> 00:02:39,150
They're all flawed and none
of them are scientific.

66
00:02:39,150 --> 00:02:42,700
So sometimes we've got
experienced people on our teams.

67
00:02:42,700 --> 00:02:44,713
We let them use their intuition

68
00:02:44,713 --> 00:02:48,549
to decide how they're
gonna resource allocate.

69
00:02:48,550 --> 00:02:51,120
Sometimes we go and we
talk to an analyst firm.

70
00:02:51,120 --> 00:02:54,680
Other teams read the news,
read about ATT&CK, try

71
00:02:54,680 --> 00:02:57,660
and build out coverage
for it, circumstance plays

72
00:02:57,660 --> 00:02:58,920
a large role in this.

73
00:02:58,920 --> 00:03:02,380
So maybe some of that happens
and you have to buy a tool.

74
00:03:02,380 --> 00:03:04,380
There's plenty of firms
out there that probably

75
00:03:04,380 --> 00:03:07,780
just do this based on regulatory

76
00:03:07,780 --> 00:03:10,348
and compliance requirements,
and then I bet a lot

77
00:03:10,348 --> 00:03:13,290
of us just make arbitrary decisions.

78
00:03:13,290 --> 00:03:15,667
So the question is, "Is
there a better way?"

79
00:03:15,667 --> 00:03:17,890
And of course the answer is, yes.

80
00:03:17,890 --> 00:03:19,329
All you have to do is figure out

81
00:03:19,330 --> 00:03:21,370
the threats that are most likely to occur

82
00:03:21,370 --> 00:03:24,090
and focus on them first
and then move backwards

83
00:03:24,090 --> 00:03:26,150
to the one's that are
less likely to occur.

84
00:03:26,150 --> 00:03:28,185
Luckily, MITRE ATT&CK gives us

85
00:03:28,185 --> 00:03:31,840
a nice framework to work with for this.

86
00:03:31,840 --> 00:03:36,200
It takes this nebulous, indefinite
thing, a threat landscape

87
00:03:36,200 --> 00:03:39,100
and it makes it definite
and gives you a finite list

88
00:03:39,100 --> 00:03:41,200
of techniques and the
data sources you need

89
00:03:41,200 --> 00:03:43,760
to observe those things.

90
00:03:43,760 --> 00:03:46,690
So I think of this in
the terms of baseball.

91
00:03:46,690 --> 00:03:49,160
So forever, you stuck nine players

92
00:03:49,160 --> 00:03:51,579
on a baseball field, evenly spaced

93
00:03:51,580 --> 00:03:53,470
and that was how you played defense.

94
00:03:53,470 --> 00:03:54,303
With the advent

95
00:03:54,303 --> 00:03:57,810
of advanced analytics increasingly
works in infield shifts.

96
00:03:57,810 --> 00:04:00,600
So we've got spread charts for batters.

97
00:04:00,600 --> 00:04:02,380
We know where they're gonna hit the ball

98
00:04:02,380 --> 00:04:04,769
and you move the in field accordingly

99
00:04:04,770 --> 00:04:06,423
to neutralize their strengths.

100
00:04:07,710 --> 00:04:09,900
So the sort of thing that in terms

101
00:04:09,900 --> 00:04:11,000
of MITRE ATT&CK where

102
00:04:11,000 --> 00:04:13,140
the framework itself
is the baseball field.

103
00:04:13,140 --> 00:04:17,659
You don't wanna just throw
coverage at the entire matrix.

104
00:04:17,660 --> 00:04:19,780
You wanna figure out the hotspots.

105
00:04:19,779 --> 00:04:21,209
So a year ago we started

106
00:04:21,209 --> 00:04:23,317
producing our threat detection report

107
00:04:23,317 --> 00:04:25,930
and the idea was, let's figure out

108
00:04:25,930 --> 00:04:28,120
the MITRE techniques that
we see the most often

109
00:04:28,120 --> 00:04:29,900
so we can answer a few questions, one

110
00:04:29,900 --> 00:04:31,900
being, "How do I get started with ATT&CK?"

111
00:04:31,900 --> 00:04:34,229
Another being, "How do I use ATT&CK?"

112
00:04:34,230 --> 00:04:37,397
And maybe a third being, "How
do I prioritize coverage."

113
00:04:39,000 --> 00:04:41,113
So I'm thinking if everyone does

114
00:04:41,113 --> 00:04:45,400
that we won't have Red Canary's
very incentric point view

115
00:04:45,400 --> 00:04:48,296
of how you should prioritize coverage

116
00:04:48,297 --> 00:04:50,970
in which threats are most likely to occur.

117
00:04:50,970 --> 00:04:53,200
We should have everybody doing that.

118
00:04:53,200 --> 00:04:55,190
I wanna know what firewall
companies are seeing.

119
00:04:55,190 --> 00:04:58,060
I wanna know what email
filter makers are seeing.

120
00:04:58,060 --> 00:05:00,970
So that we can get a really universal view

121
00:05:00,970 --> 00:05:04,433
of how the threat landscape
plays out on the ATT&CK matrix.

122
00:05:05,340 --> 00:05:08,599
So I found three problems with this

123
00:05:08,600 --> 00:05:09,710
as I was preparing for this.

124
00:05:09,710 --> 00:05:10,919
There's probably more.

125
00:05:10,920 --> 00:05:14,470
I'm not that creative,
but interestingly two

126
00:05:14,470 --> 00:05:17,481
of those problems were solved yesterday.

127
00:05:17,481 --> 00:05:19,680
So I'll start with the
ones that have been solved.

128
00:05:19,680 --> 00:05:22,930
The first one I couldn't figure
out was, how do we normalize

129
00:05:22,930 --> 00:05:25,440
the data because a
company with one customer,

130
00:05:25,440 --> 00:05:27,400
their prevalence rankings are not gonna be

131
00:05:27,400 --> 00:05:29,969
the same as a company
with 10,000 customers.

132
00:05:29,970 --> 00:05:32,800
And the other problem I saw
was, how do we aggregate it all?

133
00:05:32,800 --> 00:05:34,960
And I actually think that
MITRE is solving both

134
00:05:34,960 --> 00:05:37,460
of those problems potentially
with ATT&CK sightings.

135
00:05:37,460 --> 00:05:39,570
So I'm interested to see where that goes.

136
00:05:39,570 --> 00:05:43,909
Now the third problem I'm seeing is it has

137
00:05:43,910 --> 00:05:45,647
to do with the nomenclature.

138
00:05:45,647 --> 00:05:48,340
ATT&CK gives a nice common language,

139
00:05:48,340 --> 00:05:49,510
but we don't have a common language

140
00:05:49,510 --> 00:05:52,099
to talk about things like
detection and alerts.

141
00:05:52,100 --> 00:05:54,250
We call them detections in Red Canary

142
00:05:54,250 --> 00:05:57,470
and that's what we're ranking and applying

143
00:05:57,470 --> 00:06:00,040
to MITRE ATT&CK when we create
our threat detection report.

144
00:06:00,040 --> 00:06:02,977
But that's not necessarily
what other people are doing,

145
00:06:02,977 --> 00:06:06,260
but go forth and create
the grand unified--

146
00:06:06,260 --> 00:06:07,940
- I'm here to talk about
dashboards and I can think

147
00:06:07,940 --> 00:06:12,940
of nothing scarier, spookier
than a useless dashboard.

148
00:06:14,470 --> 00:06:15,520
But who am I?

149
00:06:15,520 --> 00:06:16,430
My name is Dan Paul.

150
00:06:16,430 --> 00:06:19,240
I'm the director of
product at ThreatConnect.

151
00:06:19,240 --> 00:06:21,620
We're an intel-driven security platform.

152
00:06:21,620 --> 00:06:23,230
I've been there about four years.

153
00:06:23,230 --> 00:06:27,220
I love Star Wars, I love my
dog, I love threat intel,

154
00:06:27,220 --> 00:06:29,470
and I love explaining
dashboards to people,

155
00:06:29,470 --> 00:06:31,450
so this is a perfect talk for me.

156
00:06:31,450 --> 00:06:35,469
Now to figure out how to use
ATT&CK with dashboards, we need

157
00:06:35,470 --> 00:06:37,500
to talk about what dashboards are not.

158
00:06:37,500 --> 00:06:40,155
I wanna talk about the
pretty picture fallacy.

159
00:06:40,155 --> 00:06:43,010
Oftentimes I hear people
dismiss dashboards

160
00:06:43,010 --> 00:06:44,969
as, "They're just pretty pictures."

161
00:06:44,970 --> 00:06:46,836
Or you walk a show floor and it's a bunch

162
00:06:46,836 --> 00:06:50,300
of blinking lights, a bunch of animations,

163
00:06:50,300 --> 00:06:52,100
but they don't really do anything.

164
00:06:52,100 --> 00:06:53,390
And it ends up becoming

165
00:06:53,390 --> 00:06:56,240
a form of informational bias where we're

166
00:06:56,240 --> 00:06:58,890
just collecting pretty pictures without

167
00:06:58,890 --> 00:07:00,680
thinking of the action that we take.

168
00:07:00,680 --> 00:07:03,670
And to correct this we
need to think about what

169
00:07:03,670 --> 00:07:06,470
a dashboard is actually
supposed to be for.

170
00:07:06,470 --> 00:07:09,631
So we have a nice long
definition from Stephen Few, one

171
00:07:09,631 --> 00:07:13,049
of the great modern thought
leaders of dashboard design,

172
00:07:13,050 --> 00:07:16,740
but to coalesce it, dashboard
is about what you need

173
00:07:16,740 --> 00:07:20,940
to see to focus on
achieving your objectives.

174
00:07:20,940 --> 00:07:24,040
So in essence, it's
about behavior changing.

175
00:07:24,040 --> 00:07:27,550
So if you think about your
car's dashboard, it's all

176
00:07:27,550 --> 00:07:28,900
about answering questions

177
00:07:28,900 --> 00:07:31,760
like, "Should I speed up or slow down?"

178
00:07:31,760 --> 00:07:34,210
It doesn't provide extraneous information.

179
00:07:34,210 --> 00:07:37,020
So depending on what
hat you wear at InfoSec,

180
00:07:37,020 --> 00:07:38,909
a dashboard might help
you answer questions

181
00:07:38,910 --> 00:07:42,281
like, "Should I hunt, patch, block, change

182
00:07:42,281 --> 00:07:45,467
"my intelligence requirements, have

183
00:07:45,467 --> 00:07:48,320
"my intel requirements changed?"

184
00:07:48,320 --> 00:07:51,800
And the good thing about ATT&CK is that

185
00:07:51,800 --> 00:07:54,343
it helps you focus your behavior.

186
00:07:55,370 --> 00:07:57,970
We've heard a lot of great talks today

187
00:07:57,970 --> 00:07:59,640
and yesterday about

188
00:07:59,640 --> 00:08:02,310
how ATT&CK can help you prioritize things,

189
00:08:02,310 --> 00:08:05,060
whether you're prioritizing
hunting or doing some kind

190
00:08:05,060 --> 00:08:09,300
of gap analysis, or prioritizing
some kind of response.

191
00:08:09,300 --> 00:08:13,302
So if we marry these
two things, dashboards

192
00:08:13,302 --> 00:08:16,540
and ATT&CK where dashboards
are all about helping you focus

193
00:08:16,540 --> 00:08:18,420
on objectives and ATT&CK's all

194
00:08:18,420 --> 00:08:21,870
about helping you
prioritize, what we end up

195
00:08:21,870 --> 00:08:25,460
with is a very boring looking dashboard.

196
00:08:25,460 --> 00:08:26,810
It's just a bunch of tables.

197
00:08:26,810 --> 00:08:28,710
It does not have blinking lights.

198
00:08:28,710 --> 00:08:30,460
It does not have fancy pie charts.

199
00:08:30,460 --> 00:08:32,030
It does not have bar graphs,

200
00:08:32,030 --> 00:08:37,030
but, and this was created,
inspired by an actual user.

201
00:08:37,607 --> 00:08:40,679
This is their daily
driver of what they take

202
00:08:40,679 --> 00:08:42,000
a look at every day.

203
00:08:42,000 --> 00:08:46,030
So they got tables, boring
looking tables up here

204
00:08:46,030 --> 00:08:50,939
that show indicators related
to a specific technique

205
00:08:50,940 --> 00:08:52,250
that I think happened to be tracking

206
00:08:52,250 --> 00:08:54,680
as part of their intel requirements.

207
00:08:54,680 --> 00:08:57,695
They can see indicators related
to incidents that leverage

208
00:08:57,696 --> 00:09:01,840
a specific tactic or technique.

209
00:09:01,840 --> 00:09:04,080
They can manage or look
at incidence related

210
00:09:04,080 --> 00:09:06,490
to a high-impact tactic.

211
00:09:06,490 --> 00:09:10,260
In this case I think they've
got exfiltration and C2,

212
00:09:10,260 --> 00:09:12,160
but it's all about putting
the things that they care

213
00:09:12,160 --> 00:09:15,240
about, that drive their
day in front of them

214
00:09:15,240 --> 00:09:16,830
so that they can focus only

215
00:09:16,830 --> 00:09:19,860
and specifically on those objectives.

216
00:09:19,860 --> 00:09:22,500
And the way this works
is behind the scenes

217
00:09:22,500 --> 00:09:25,740
is we have something called
ThreatConnect Query Language

218
00:09:25,740 --> 00:09:29,395
which is this SQL inspired way

219
00:09:29,395 --> 00:09:34,090
of asking complex questions
of your threat intelligence.

220
00:09:34,090 --> 00:09:36,310
So all we're doing to
bubble these things up

221
00:09:36,310 --> 00:09:40,227
to that tabular dashboard
is say, "Okay, show me

222
00:09:40,227 --> 00:09:43,197
"all incidents and campaigns matching

223
00:09:43,197 --> 00:09:44,597
"a particular technique

224
00:09:44,597 --> 00:09:49,597
"or show me all data related
to a particular tactic."

225
00:09:50,736 --> 00:09:52,930
And you can ask about,
around ID, you can ask around

226
00:09:52,930 --> 00:09:54,579
the name of the technique,
you can ask around

227
00:09:54,580 --> 00:09:57,050
the tactic, you can ask
very complex questions

228
00:09:57,050 --> 00:10:00,697
like, "Show me all incidents
coming through that are tied

229
00:10:00,697 --> 00:10:03,597
"to adversaries, that are
tied to previous incidents

230
00:10:03,597 --> 00:10:05,137
"that have been known to use

231
00:10:05,137 --> 00:10:06,296
"a particular technique where

232
00:10:06,297 --> 00:10:08,677
"that technique effects
the Windows platform."

233
00:10:09,990 --> 00:10:12,720
That level of granularity is possible.

234
00:10:12,720 --> 00:10:16,840
So to sum up dashboards, not

235
00:10:16,840 --> 00:10:19,370
about pew-pew maps or pretty pictures.

236
00:10:19,370 --> 00:10:21,740
They are about focusing your behavior

237
00:10:21,740 --> 00:10:23,400
on specific objectives

238
00:10:23,400 --> 00:10:25,622
hopefully driven by intel requirements.

239
00:10:26,600 --> 00:10:29,600
You wanna orient those
objectives around ATT&CK

240
00:10:30,660 --> 00:10:33,980
and by creating the
customized dashboard, it lets

241
00:10:33,980 --> 00:10:38,980
that dashboard turn into your daily driver

242
00:10:38,980 --> 00:10:40,823
to help you focus.

243
00:10:42,547 --> 00:10:44,280
Thank you very much.

244
00:10:44,280 --> 00:10:47,240
One last picture of my dog and I'll yield

245
00:10:47,240 --> 00:10:48,170
the rest of my time.

246
00:10:48,170 --> 00:10:50,490
- Hey, everybody, I'm Stephan Chenette.

247
00:10:50,490 --> 00:10:53,650
The CTO and the co-founder of AttackIQ.

248
00:10:53,650 --> 00:10:57,000
I got to know the ATT&CK
team somewhere around 2016.

249
00:10:57,000 --> 00:10:57,930
So since then I've been

250
00:10:57,930 --> 00:11:00,969
working with ATT&CK one way or another.

251
00:11:00,970 --> 00:11:02,120
Some of the contributions

252
00:11:02,120 --> 00:11:04,600
from my team have gone into

253
00:11:04,600 --> 00:11:06,940
the Verizon DBI report
example with regards

254
00:11:06,940 --> 00:11:10,130
to ATT&CK paths, ATT&CK
mapping, but what I'm here

255
00:11:10,130 --> 00:11:13,530
to talk about is in that
time my observations with

256
00:11:13,530 --> 00:11:18,180
working with security teams
in operationalizing ATT&CK.

257
00:11:18,180 --> 00:11:21,189
More specifically, as I was looking

258
00:11:21,190 --> 00:11:23,140
at the Lightning Talks and then thinking

259
00:11:23,140 --> 00:11:26,170
about a subject was how
I have observed some

260
00:11:26,170 --> 00:11:27,680
of the security capabilities

261
00:11:27,680 --> 00:11:30,109
and the maturing security capabilities

262
00:11:30,110 --> 00:11:31,900
that organizations have

263
00:11:31,900 --> 00:11:35,090
and what use cases actually
make sense to get started.

264
00:11:35,090 --> 00:11:36,730
So you don't just wake up in the morning

265
00:11:36,730 --> 00:11:38,680
and have a threat intel team.

266
00:11:38,680 --> 00:11:40,530
You don't wake up in the
morning and have a red team.

267
00:11:40,530 --> 00:11:44,140
So where do you actually
start with ATT&CK?

268
00:11:44,140 --> 00:11:47,080
So I'm gonna share some
of my observations.

269
00:11:47,080 --> 00:11:48,030
The hope here is that this is

270
00:11:48,030 --> 00:11:51,199
gonna help you actually
focus and get started faster.

271
00:11:51,200 --> 00:11:52,690
This is a Lighting Talk,
we've got five minutes

272
00:11:52,690 --> 00:11:54,290
so I'm not gonna go to
the level of detail,

273
00:11:54,290 --> 00:11:57,050
talking about levels one
through five, talking

274
00:11:57,051 --> 00:11:59,670
about security capabilities
being undefined to optimize.

275
00:11:59,670 --> 00:12:01,420
We're gonna keep it simple.

276
00:12:01,420 --> 00:12:02,252
So when I talk

277
00:12:02,253 --> 00:12:06,120
about security capabilities,
what I'm referring

278
00:12:06,120 --> 00:12:07,710
to is an organizations ability

279
00:12:07,710 --> 00:12:11,770
to prevent, detect, monitor, respond

280
00:12:11,770 --> 00:12:12,620
to an ATT&CK where

281
00:12:12,620 --> 00:12:15,990
their people process
tools and technologies.

282
00:12:15,990 --> 00:12:19,902
And really as your program
matures, it earns the right

283
00:12:19,902 --> 00:12:22,173
to then have more capabilities.

284
00:12:22,173 --> 00:12:25,510
So over the last number
of years in working

285
00:12:25,510 --> 00:12:28,720
with several security teams there's been

286
00:12:28,720 --> 00:12:31,880
an interesting mapping that I've observed

287
00:12:32,880 --> 00:12:35,310
as teams have increased
in their capabilities

288
00:12:35,310 --> 00:12:37,810
and what use case
they've completely failed

289
00:12:37,810 --> 00:12:39,609
in operationalizing, but more importantly

290
00:12:39,610 --> 00:12:43,153
where they succeeded in
operationalizing the use of ATT&CK.

291
00:12:44,270 --> 00:12:45,103
So where do we get started?

292
00:12:45,103 --> 00:12:46,359
So the first set of groupings,

293
00:12:46,360 --> 00:12:49,130
this could be relevant to
a new security program.

294
00:12:49,130 --> 00:12:50,070
This could be relevant to

295
00:12:50,070 --> 00:12:52,740
the fact that you have your
security program in place,

296
00:12:52,740 --> 00:12:54,920
but you have these fundamentals

297
00:12:54,920 --> 00:12:57,060
with people in place, security analysts,

298
00:12:57,060 --> 00:12:58,949
and security engineers.

299
00:12:58,950 --> 00:13:02,900
You've put in place basic
end-point detection capabilities,

300
00:13:02,900 --> 00:13:05,810
basic network detection capabilities,

301
00:13:05,810 --> 00:13:08,439
your security engineers are maintaining

302
00:13:08,440 --> 00:13:10,720
and putting in more security controls

303
00:13:10,720 --> 00:13:13,270
in those technologies and processes.

304
00:13:13,270 --> 00:13:14,920
Here's what I see in success.

305
00:13:14,920 --> 00:13:17,250
At this point it's not putting ATT&CK

306
00:13:17,250 --> 00:13:21,672
into action, it's putting it in the way

307
00:13:21,672 --> 00:13:26,672
of the team simply as a reference library.

308
00:13:27,550 --> 00:13:30,630
The amount of success
I've seen in teams just

309
00:13:30,630 --> 00:13:33,290
to start off with this
simple concept, use it

310
00:13:33,290 --> 00:13:36,410
as a reference library, start
talking a common language.

311
00:13:36,410 --> 00:13:37,870
This is a them that I've seen

312
00:13:37,870 --> 00:13:39,720
this week that we haven't mentioned

313
00:13:39,720 --> 00:13:42,040
which is the change in culture.

314
00:13:42,040 --> 00:13:43,959
So as a team starts talking

315
00:13:43,960 --> 00:13:47,020
the same language, it changes the mindset.

316
00:13:47,020 --> 00:13:51,930
So super simple, really, change

317
00:13:51,930 --> 00:13:55,089
in culture, use MITRE ATT&CK
as a reference library.

318
00:13:55,090 --> 00:13:57,890
As security analysts,
security engineers start

319
00:13:57,890 --> 00:14:01,390
to grow the team, the
program starts to mature,

320
00:14:01,390 --> 00:14:04,550
the assessment engineering
use case comes into mind.

321
00:14:04,550 --> 00:14:07,109
So where I've seen success in working

322
00:14:07,110 --> 00:14:09,330
with security organizations
is going through

323
00:14:09,330 --> 00:14:12,760
these iterative exercises
of looking at ATT&CK

324
00:14:12,760 --> 00:14:14,840
as a matrix and overlaying

325
00:14:14,840 --> 00:14:16,560
the controls that have been put in place,

326
00:14:16,560 --> 00:14:19,089
the detection, prevention,
response capabilities

327
00:14:19,090 --> 00:14:21,540
for your team, and it's
an iterative exercise,

328
00:14:21,540 --> 00:14:24,150
so it's constantly, as the
analysts and the engineers

329
00:14:24,150 --> 00:14:25,800
are more familiar with their environment.

330
00:14:25,800 --> 00:14:27,709
Let's overlay that onto the matrix

331
00:14:27,710 --> 00:14:30,325
and understand what attacks

332
00:14:30,325 --> 00:14:33,100
are we defending and preventing against.

333
00:14:33,100 --> 00:14:38,100
Detection analytics, again, a
more complex set of engineers.

334
00:14:39,350 --> 00:14:41,350
We're using this from a POC perspective,

335
00:14:41,350 --> 00:14:42,923
an analytics perspective,

336
00:14:44,170 --> 00:14:47,199
but it now shifts this cultural change

337
00:14:47,200 --> 00:14:52,060
to represent red teams sharing
the TTPs, blue teams learning

338
00:14:52,060 --> 00:14:54,599
and sharing back to the red teams

339
00:14:54,600 --> 00:14:58,541
with threat intelligence, now
a new capability if you will.

340
00:14:58,541 --> 00:15:01,240
This comes into three
different areas, threat

341
00:15:01,240 --> 00:15:03,820
hunting, incident
response, and gap analysis.

342
00:15:03,820 --> 00:15:06,050
So if you have these
capabilities, excellent.

343
00:15:06,050 --> 00:15:08,829
This use case is for you
and where I've seen success

344
00:15:08,830 --> 00:15:11,240
in teams is using it as a common mapping.

345
00:15:11,240 --> 00:15:12,610
So these tactics and techniques

346
00:15:12,610 --> 00:15:14,090
as you're building internal processes

347
00:15:14,090 --> 00:15:17,430
for capturing threat intel,
capturing external threat intel,

348
00:15:17,430 --> 00:15:19,969
mapping this all together,
this use case makes sense

349
00:15:19,970 --> 00:15:21,300
for your capabilities.

350
00:15:21,300 --> 00:15:24,209
Now close to my heart,
adversary emulation,

351
00:15:24,210 --> 00:15:25,850
this is extremely important.

352
00:15:25,850 --> 00:15:26,870
This is really when you start

353
00:15:26,870 --> 00:15:28,880
thinking about the purple team mentality.

354
00:15:28,880 --> 00:15:31,460
This is also the point where
you think about ATT&CK paths

355
00:15:31,460 --> 00:15:34,190
and you think about impact
to your organization,

356
00:15:34,190 --> 00:15:36,330
and you're mapping that
security capabilities

357
00:15:36,330 --> 00:15:37,580
and understanding where you need

358
00:15:37,580 --> 00:15:39,540
to improve, where you're failing,

359
00:15:39,540 --> 00:15:41,560
and you're discussing that with the rest

360
00:15:41,560 --> 00:15:44,250
of the management team,
the rest of the company.

361
00:15:44,250 --> 00:15:47,350
So again, as you're reflecting
on some of these thoughts.

362
00:15:47,350 --> 00:15:48,900
It's less about your industry

363
00:15:48,900 --> 00:15:51,670
and some more about what
drives your security programs.

364
00:15:51,670 --> 00:15:53,420
It's more about where
your capabilities are.

365
00:15:53,420 --> 00:15:56,750
It's more about what use
cases to choose, thank you.

366
00:15:56,750 --> 00:15:57,997
- Ivan Ninichuck.

367
00:15:58,869 --> 00:16:00,577
- Here you go, thanks.

368
00:16:00,577 --> 00:16:03,767
(crowd applauding)

369
00:16:03,767 --> 00:16:07,657
I've been validated by
my peers. (laughing)

370
00:16:09,010 --> 00:16:12,173
Okay, so we got ATT&CK
poker which is a lot of fun.

371
00:16:13,130 --> 00:16:16,290
So first of all though
none of us work in a vacuum

372
00:16:16,290 --> 00:16:20,030
so I took knowledge, my
colleague, Jeff Whittacker

373
00:16:20,030 --> 00:16:23,130
who better be watching
right now. (laughing)

374
00:16:23,130 --> 00:16:25,140
Without his constant contributions I

375
00:16:25,140 --> 00:16:26,453
probably wouldn't be here.

376
00:16:28,740 --> 00:16:31,810
Let's see, so I'm gonna
cover the main themes

377
00:16:31,810 --> 00:16:34,130
of the conference which
is actually kinda cool.

378
00:16:34,130 --> 00:16:37,800
The first one is ATT&CK as a game.

379
00:16:37,800 --> 00:16:41,390
We heard some great
motivational speaking yesterday.

380
00:16:41,390 --> 00:16:45,670
I know I had wonderful
sessions with Shane Stagger.

381
00:16:45,670 --> 00:16:49,510
He brought his little TCG
Magic the Gathering type game

382
00:16:49,510 --> 00:16:51,360
called Maelstorm and we talked

383
00:16:51,360 --> 00:16:53,354
and nerded out on game theory,

384
00:16:53,354 --> 00:16:57,030
but why does it work so well with ATT&CK?

385
00:16:57,030 --> 00:16:59,610
Well, basically because
it's so abstract with

386
00:16:59,610 --> 00:17:01,160
the techniques and tactics,

387
00:17:01,160 --> 00:17:04,139
and then also as you can
see, you can prioritize,

388
00:17:04,140 --> 00:17:07,453
you can make decisions, you
can do payoffs of resources.

389
00:17:08,839 --> 00:17:10,949
So why is it poker?

390
00:17:10,950 --> 00:17:13,280
You might say how in
the world is it poker?

391
00:17:13,280 --> 00:17:15,619
So the concept of ATT&CK poker is that

392
00:17:15,619 --> 00:17:18,040
the cards would actually
have their techniques

393
00:17:18,040 --> 00:17:22,379
and tactics on them so you could
start matching those chains

394
00:17:22,380 --> 00:17:24,070
of attacks that's also been talked about.

395
00:17:24,069 --> 00:17:26,030
So that's another thing.

396
00:17:26,030 --> 00:17:28,089
So you can start looking
at what combinations.

397
00:17:28,089 --> 00:17:32,350
'Cause in poker, say,
you have a pair, right?

398
00:17:32,350 --> 00:17:34,486
Okay, maybe some resources, put some chips

399
00:17:34,487 --> 00:17:36,500
and the chips are resources.

400
00:17:36,500 --> 00:17:39,750
Put some chips in, you might
win, you might lose, who knows?

401
00:17:39,750 --> 00:17:44,210
Now if you've got a full
house, you've got, now how does

402
00:17:44,210 --> 00:17:47,860
all this wonderful abstract
poker playing on Unreal 4

403
00:17:47,860 --> 00:17:51,729
because I'm making a mobile
game, but how does it help?

404
00:17:51,730 --> 00:17:54,320
The other cool thing about
the theme that I love.

405
00:17:54,320 --> 00:17:57,750
I loved hearing it over and
over again, communication,

406
00:17:57,750 --> 00:18:01,260
but I'd take it one
step further. (laughing)

407
00:18:01,260 --> 00:18:02,160
Don't get you anywhere.

408
00:18:02,160 --> 00:18:07,160
Maybe they're gonna bet too
resource heavy to follow up on.

409
00:18:07,300 --> 00:18:10,440
So that's the noise there.

410
00:18:10,440 --> 00:18:13,580
And then the cool thing about this is that

411
00:18:13,580 --> 00:18:16,983
for me the message is the true positive.

412
00:18:18,060 --> 00:18:22,129
And then the symbols of the
message become your alert

413
00:18:22,130 --> 00:18:24,410
or because we smartly map

414
00:18:24,410 --> 00:18:28,190
to MITRE ATT&CK they
become your techniques.

415
00:18:28,190 --> 00:18:29,951
So you're actually making up

416
00:18:29,951 --> 00:18:34,600
the true positive using
those combinations.

417
00:18:34,600 --> 00:18:38,689
So if we can find these
statistics that we can get

418
00:18:38,690 --> 00:18:40,420
from things like ATT&CK poker,

419
00:18:40,420 --> 00:18:45,140
like Maelstorm, like Sightings, like...

420
00:18:45,140 --> 00:18:47,803
What was the other one I was gonna use?

421
00:18:47,803 --> 00:18:50,600
Oh, emulation, if we
can get those statistics

422
00:18:50,600 --> 00:18:53,330
and start making these models, then

423
00:18:53,330 --> 00:18:56,120
like I said, we can start
actually using good old theorems

424
00:18:56,120 --> 00:19:01,120
from 1948 that successfully
develop digital communications.

425
00:19:01,730 --> 00:19:02,690
Oh, there's the timer.

426
00:19:02,690 --> 00:19:04,980
Okay, I keep looking over there.

427
00:19:04,980 --> 00:19:09,850
I'm doing great time-wise,
time-wise. (laughing)

428
00:19:09,850 --> 00:19:13,550
So like I was saying,
then we can actually start

429
00:19:13,550 --> 00:19:15,690
optimizing our alerts

430
00:19:15,690 --> 00:19:18,020
or I'm gonna use another
word everyone's been

431
00:19:18,020 --> 00:19:23,020
using ATT&CK poker was
to find a way to be able

432
00:19:23,225 --> 00:19:28,225
to gain information to
prioritization, it's wonderful.

433
00:19:29,860 --> 00:19:34,199
So on other notes, I like Excel sheets.

434
00:19:34,200 --> 00:19:36,090
(laughing)

435
00:19:36,090 --> 00:19:37,870
But I'm moving to Jupiter notebooks.

436
00:19:37,870 --> 00:19:39,570
Come on, drink it up, drink it up.

437
00:19:40,640 --> 00:19:42,893
I hate candy corn, I'm sorry.

438
00:19:44,860 --> 00:19:47,010
I know I just got like, never

439
00:19:47,010 --> 00:19:50,240
coming back here again apparently,
but I just can't do it.

440
00:19:50,240 --> 00:19:51,230
My dad loved it though.

441
00:19:51,230 --> 00:19:52,600
We always argued.

442
00:19:52,600 --> 00:19:54,370
Thank you very much for this opportunity.

443
00:19:54,370 --> 00:19:56,159
This was my first time speaking ever

444
00:19:56,160 --> 00:19:58,940
and I was so happy to do it, thank you.

445
00:19:58,940 --> 00:19:59,980
- I'm Mauricio everyone

446
00:19:59,980 --> 00:20:02,300
so we have five minutes, so my
intro's gonna be real quick.

447
00:20:02,300 --> 00:20:05,030
I run a blue team in
financial services in New York

448
00:20:05,030 --> 00:20:07,680
and I love threat hunting
and adversary simulation.

449
00:20:07,680 --> 00:20:09,260
And if you wanna know
more about the things I'm

450
00:20:09,260 --> 00:20:11,650
working on, check out my
Twitter and my GitHub.

451
00:20:11,650 --> 00:20:15,006
But so ATT&CK is a great
tool that we can use

452
00:20:15,006 --> 00:20:18,810
to measure our security
posture against techniques used

453
00:20:18,810 --> 00:20:22,200
by real attackers in the
world in real attacks, right?

454
00:20:22,200 --> 00:20:23,980
But in order to achieve this goal we

455
00:20:23,980 --> 00:20:25,940
really need different technologies

456
00:20:25,940 --> 00:20:27,030
that serve different purposes.

457
00:20:27,030 --> 00:20:29,379
And I think one thing that
we're not talking too much

458
00:20:29,380 --> 00:20:31,950
about or at least I
haven't heard is the tools

459
00:20:31,950 --> 00:20:34,070
that we're using, the
technologies that we're using

460
00:20:34,070 --> 00:20:37,330
to help blue teams keep track

461
00:20:37,330 --> 00:20:39,939
of the security posture state over time

462
00:20:39,940 --> 00:20:42,570
and most importantly collaborate as a team

463
00:20:42,570 --> 00:20:45,300
and share notes, share
documentation as we're

464
00:20:45,300 --> 00:20:48,330
working on tracking these techniques.

465
00:20:48,330 --> 00:20:49,610
So that's what I wanted
to talk about today.

466
00:20:49,610 --> 00:20:52,479
I wanna show you one way
of doing it, how we do it,

467
00:20:52,480 --> 00:20:53,520
and also I'm gonna release

468
00:20:53,520 --> 00:20:56,280
a tool that can maybe
help you do it yourself.

469
00:20:56,280 --> 00:20:58,860
So as we started our journey with

470
00:20:58,860 --> 00:21:00,283
the ATT&CK MITRE framework,

471
00:21:01,360 --> 00:21:03,459
just like we need a view, we
started using spreadsheets.

472
00:21:03,460 --> 00:21:06,340
And, Katie, nothing against
spreadsheets, I promise.

473
00:21:06,340 --> 00:21:08,919
I actually support the
spreadsheet movement,

474
00:21:08,920 --> 00:21:11,460
but we wanted to use something different

475
00:21:11,460 --> 00:21:13,470
and we displayed our requirements.

476
00:21:13,470 --> 00:21:15,610
So our requirements were we wanted a way

477
00:21:15,610 --> 00:21:16,919
to manage ATT&CK techniques

478
00:21:16,920 --> 00:21:18,810
as entities, entities with properties.

479
00:21:18,810 --> 00:21:20,600
Some of these properties are static, some

480
00:21:20,600 --> 00:21:22,199
of these properties are dynamic.

481
00:21:22,200 --> 00:21:24,270
So we can track this state over time.

482
00:21:24,270 --> 00:21:26,629
We wanted an interface that
would would allow our team

483
00:21:26,630 --> 00:21:28,890
to collaborate, to log
work, to share comments,

484
00:21:28,890 --> 00:21:32,730
to share analytics in
one simple interface.

485
00:21:32,730 --> 00:21:35,140
And we wanted to get some basic reporting.

486
00:21:35,140 --> 00:21:36,900
So I'm gonna stop here
and move to the demo.

487
00:21:36,900 --> 00:21:41,000
So this is a tool we
wrote, so attached to JIRA.

488
00:21:41,000 --> 00:21:42,560
It's a simple Python script that

489
00:21:42,560 --> 00:21:46,899
leverages JIRA's API, leverages
Roberto's attackcti library.

490
00:21:46,900 --> 00:21:49,330
It basically is gonna automate the process

491
00:21:49,330 --> 00:21:51,530
of setting up a JIRA
environment that has all

492
00:21:51,530 --> 00:21:54,070
the ATT&CK techniques and
allows you to assign it

493
00:21:54,070 --> 00:21:55,860
to people, collaborate, work.

494
00:21:55,860 --> 00:21:57,949
So I'm gonna just jump to the demo.

495
00:21:57,950 --> 00:21:58,900
Hopefully this works.

496
00:21:58,900 --> 00:22:03,900
I guess it's not gonna work, let's see.

497
00:22:04,270 --> 00:22:09,270
Oh, unfortunately, is this working?

498
00:22:14,419 --> 00:22:17,330
Yeah, all right, it's not
gonna work, but that's okay.

499
00:22:17,330 --> 00:22:18,932
So what this is going to show

500
00:22:18,932 --> 00:22:21,171
and you can check on the
GitHub, it's gonna have

501
00:22:21,171 --> 00:22:25,020
the links to the videos, what
this one's going to show is

502
00:22:25,020 --> 00:22:27,230
a really easy where you can run the tool.

503
00:22:27,230 --> 00:22:28,390
It's gonna do a few things.

504
00:22:28,390 --> 00:22:31,000
It's gonna create a
JIRA project, it's going

505
00:22:31,000 --> 00:22:36,000
to create custom fields
because JIRA comes with out

506
00:22:36,290 --> 00:22:37,540
of the box fields that we don't need

507
00:22:37,540 --> 00:22:38,659
for software engineering.

508
00:22:38,660 --> 00:22:41,170
So it's gonna create custom fields, hide

509
00:22:41,170 --> 00:22:45,130
those unnecessary fields
and basically create, talk

510
00:22:45,130 --> 00:22:49,480
to ATT&CK's API to get a
list of all the techniques.

511
00:22:49,480 --> 00:22:51,440
Basically it created a
JIRA project with all

512
00:22:51,440 --> 00:22:53,060
the ATT&CK techniques that you have.

513
00:22:53,060 --> 00:22:54,980
It takes five to six minutes.

514
00:22:54,980 --> 00:22:58,294
So in five minutes you can
have a full environment

515
00:22:58,294 --> 00:23:01,730
in JIRA that you can go ahead
and just start assigning

516
00:23:01,730 --> 00:23:06,130
to people, running reports,
changing the maturity state.

517
00:23:06,130 --> 00:23:08,170
You may start in a no truck.

518
00:23:08,170 --> 00:23:11,019
I have a maturity matrix
that you can customize

519
00:23:11,019 --> 00:23:15,180
just changing a JSON file
and then also JIRA allows you

520
00:23:15,180 --> 00:23:17,290
to run basic reporting, right?

521
00:23:17,290 --> 00:23:20,409
So you can run reports and
they even have a JQL language.

522
00:23:20,410 --> 00:23:21,780
It's really easy to run reports,

523
00:23:21,780 --> 00:23:23,790
but one thing that we did
also is that we wanted

524
00:23:23,790 --> 00:23:25,860
to leverage the ATT&CK navigator.

525
00:23:25,860 --> 00:23:29,139
So we have basically an extra feature on

526
00:23:29,140 --> 00:23:32,450
the tool that uses that
maturity level that you can work

527
00:23:32,450 --> 00:23:36,450
on in your team and track over
time and it's gonna export

528
00:23:36,450 --> 00:23:39,140
a JSON layer based on
that maturity level on

529
00:23:39,140 --> 00:23:44,140
the JIRA custom field and then
it's gonna be easy to create

530
00:23:46,750 --> 00:23:51,450
and have a visual of your ATT&CK
coverage as we work on it.

531
00:23:51,450 --> 00:23:54,600
So I encourage you, now
the code is out there.

532
00:23:54,600 --> 00:23:55,433
So you can go to this GitHub

533
00:23:55,433 --> 00:23:57,940
and in this GitHub page
you're gonna find the video.

534
00:23:57,940 --> 00:24:00,160
So it would have been really
nice if the videos worked,

535
00:24:00,160 --> 00:24:01,040
but that's okay.

536
00:24:01,040 --> 00:24:03,370
You can watch the videos
there and now I'm really

537
00:24:03,370 --> 00:24:05,879
looking forward to good
comments from if this works,

538
00:24:05,880 --> 00:24:08,040
if this is an approach
you like, let me know.

539
00:24:08,040 --> 00:24:11,300
I'm gonna keep working on
this because we use it.

540
00:24:11,300 --> 00:24:14,970
And then finally we also have, I created

541
00:24:14,970 --> 00:24:19,750
this JIRA instance, it's
attack.atlantean.net

542
00:24:19,750 --> 00:24:21,540
and I've created this JIRA instance with

543
00:24:21,540 --> 00:24:25,230
the tool and now I made it
public so you can access it.

544
00:24:25,230 --> 00:24:27,900
So if you wanna play with
it this approach maybe works

545
00:24:27,900 --> 00:24:31,070
for you, just go to this
URL attack.atlantean.net.

546
00:24:31,070 --> 00:24:34,500
Once again it's gonna be on
the JIRA GitHub repository.

547
00:24:34,500 --> 00:24:37,990
And maybe it's a one way,
another way that we can track

548
00:24:37,990 --> 00:24:42,193
and measure our ATT&CK coverage
over time, so thank you.

549
00:24:43,200 --> 00:24:45,770
- Ivan, earlier today mentioned Carat

550
00:24:45,770 --> 00:24:48,520
and now we're gonna bring
the STIX, #DADJOKEs.

551
00:24:48,520 --> 00:24:49,730
You can follow those on Twitter

552
00:24:49,730 --> 00:24:51,060
if you ever wanna get through your day.

553
00:24:51,060 --> 00:24:52,110
There is an entire group

554
00:24:52,110 --> 00:24:54,572
of us who are just as
demented with these puns.

555
00:24:56,820 --> 00:24:59,179
Toni, aww, who said, aww?

556
00:25:03,344 --> 00:25:04,177
(laughing)

557
00:25:04,177 --> 00:25:05,010
It'll come back, don't worry.

558
00:25:05,010 --> 00:25:08,379
I'll need to illustrate it,
but it gets hot in this thing.

559
00:25:08,380 --> 00:25:10,010
Toni was the key note.

560
00:25:10,010 --> 00:25:11,310
She said something really interesting.

561
00:25:11,310 --> 00:25:12,899
She talked about commitment

562
00:25:13,940 --> 00:25:15,690
and we all understand that projects

563
00:25:15,690 --> 00:25:17,120
and change require commitment.

564
00:25:17,120 --> 00:25:18,226
That's what executives have to do.

565
00:25:18,227 --> 00:25:19,660
That's what engineers have to do

566
00:25:19,660 --> 00:25:21,480
to actually make something happen

567
00:25:22,390 --> 00:25:23,830
and the theme that I've pulled out

568
00:25:23,830 --> 00:25:27,449
of the last two days is seeing
that commitment in action.

569
00:25:27,450 --> 00:25:31,180
Deloitte, Nationwide,
CrowdStrike were all examples

570
00:25:31,180 --> 00:25:32,520
of commitment, trying

571
00:25:32,520 --> 00:25:35,373
to make a system work
through individual heroics.

572
00:25:36,240 --> 00:25:38,930
MITRE showed us the TRAM project which was

573
00:25:38,930 --> 00:25:42,270
using natural language
processing to, let's find a way

574
00:25:42,270 --> 00:25:44,250
to look through analyst reports and try

575
00:25:44,250 --> 00:25:46,130
to automate some sort of understanding

576
00:25:46,130 --> 00:25:47,430
of what they're doing.

577
00:25:47,430 --> 00:25:50,090
So there's all of this
information out there.

578
00:25:50,090 --> 00:25:52,010
We're all telling each other to share.

579
00:25:52,010 --> 00:25:55,440
Why don't we make it
easier as a community?

580
00:25:55,440 --> 00:25:58,410
So the commitment should
not be to us as individuals,

581
00:25:58,410 --> 00:26:00,020
but community commitment

582
00:26:00,020 --> 00:26:03,163
to making this a better
standard that all of us can use.

583
00:26:06,160 --> 00:26:10,160
So I'm actually here with
somebody else in costume.

584
00:26:10,160 --> 00:26:11,770
I'm obviously the unicorn

585
00:26:11,770 --> 00:26:14,263
and Dan Riedel is Harley the Rabbit.

586
00:26:15,842 --> 00:26:17,060
(laughing)

587
00:26:17,060 --> 00:26:19,110
Dan is in Paris right
now so he can't make it,

588
00:26:19,110 --> 00:26:21,659
but I did some things and Dan is on the

589
00:26:21,660 --> 00:26:24,630
board of directors at Oasis.

590
00:26:24,630 --> 00:26:27,960
So today's threat intelligence,
I'm gonna start by, I picked

591
00:26:27,960 --> 00:26:29,710
a random vendor and I'm
not gonna say who they are.

592
00:26:29,710 --> 00:26:32,250
I'm just gonna read some of what they do.

593
00:26:32,250 --> 00:26:35,950
They have the most advanced automatic deep

594
00:26:35,950 --> 00:26:37,733
and dark web CTI platform.

595
00:26:38,640 --> 00:26:41,373
They are a cool vendor of Gartner.

596
00:26:42,430 --> 00:26:44,443
Then they had something
else that was really cool.

597
00:26:46,100 --> 00:26:46,933
Where is it?

598
00:26:46,933 --> 00:26:49,540
Right here, invisible to cyber criminals.

599
00:26:49,540 --> 00:26:52,360
It extracts intel from them.

600
00:26:52,360 --> 00:26:54,320
So what's the problem
with threat intelligence?

601
00:26:54,320 --> 00:26:55,590
The problem with threat intelligence

602
00:26:55,590 --> 00:27:00,590
is we're always understanding
yesterday, it's reactive.

603
00:27:01,440 --> 00:27:04,550
And so the key is how do we
make it as quickly as possible

604
00:27:04,550 --> 00:27:07,070
from reaction to application?

605
00:27:07,070 --> 00:27:08,550
Today's threat intelligence

606
00:27:08,550 --> 00:27:11,090
is based on static IOCs and identifiers.

607
00:27:11,090 --> 00:27:13,310
Here's a hash, here's a signature, here's

608
00:27:13,310 --> 00:27:14,870
a domain, here's an IP.

609
00:27:14,870 --> 00:27:16,850
This is what I just learned,

610
00:27:16,850 --> 00:27:20,219
but the bad guys already know that.

611
00:27:20,220 --> 00:27:22,980
It's not hard for them to
build changes into the malware.

612
00:27:22,980 --> 00:27:25,090
It's not hard to shift infrastructure

613
00:27:25,090 --> 00:27:27,679
and so we're left trying to play catch up

614
00:27:28,610 --> 00:27:31,087
and so if we can shorten
that loop, this is why

615
00:27:31,087 --> 00:27:33,160
having a machine-readable approach

616
00:27:33,160 --> 00:27:34,660
to threat intelligence where instead

617
00:27:34,660 --> 00:27:37,080
of trying to read the reports

618
00:27:37,080 --> 00:27:41,100
and then do something, well, what

619
00:27:41,100 --> 00:27:43,632
if we had a quicker way
to make that operational?

620
00:27:45,920 --> 00:27:48,780
So STIX 2.1 is coming.

621
00:27:48,780 --> 00:27:50,920
STIX 2.1 does implement some

622
00:27:50,920 --> 00:27:53,290
of these things that combine
with current STIX patterning

623
00:27:53,290 --> 00:27:55,500
is going to make things
more machine-readable,

624
00:27:55,500 --> 00:27:57,763
but it's still missing some pieces.

625
00:27:59,010 --> 00:28:03,150
First of all, we have an
accuracy and quality problem.

626
00:28:03,150 --> 00:28:05,750
Analysts should not be
debating what something is

627
00:28:05,750 --> 00:28:07,820
because there are mistakes made.

628
00:28:07,820 --> 00:28:10,189
We also have problems of duplication.

629
00:28:10,190 --> 00:28:12,223
Who here is overwhelmed with data?

630
00:28:13,300 --> 00:28:14,840
If you're not raising your
hand I will come say, "Hi,"

631
00:28:14,840 --> 00:28:16,209
to you in the audience.

632
00:28:16,210 --> 00:28:17,143
All of us?

633
00:28:18,210 --> 00:28:20,430
The stock gets false positives

634
00:28:20,430 --> 00:28:23,130
for the rest of us we're buried in, this

635
00:28:23,130 --> 00:28:24,820
is kinda what Keith was
going with, his Red Canary.

636
00:28:24,820 --> 00:28:25,653
Where are you Keith?

637
00:28:25,653 --> 00:28:29,240
Right there, what he was
talking about was this balance

638
00:28:29,240 --> 00:28:30,620
of trying to collect everything,

639
00:28:30,620 --> 00:28:32,510
but at the same time making it usable.

640
00:28:32,510 --> 00:28:35,780
It's called the national
security agency problem.

641
00:28:35,780 --> 00:28:36,800
That was a joke.

642
00:28:36,800 --> 00:28:37,877
Think about what their problem was.

643
00:28:37,877 --> 00:28:38,950
"Hey, we collected everything."

644
00:28:38,950 --> 00:28:39,783
What do we got?

645
00:28:39,783 --> 00:28:42,209
Nothing's actionable, there's too much.

646
00:28:42,210 --> 00:28:43,967
Now tie this back into ATT&CK.

647
00:28:44,910 --> 00:28:46,650
I think ATT&CK has been abused

648
00:28:46,650 --> 00:28:48,810
by industry for similar reasons.

649
00:28:48,810 --> 00:28:50,379
We've turned it into a check list.

650
00:28:50,380 --> 00:28:51,510
We've turned it into trying to chase it.

651
00:28:51,510 --> 00:28:55,480
We've turned it into engineering
directly detections for it.

652
00:28:55,480 --> 00:28:59,640
And instead I always think of
ATT&CK as a periodic table.

653
00:28:59,640 --> 00:29:02,490
We're trying to describe
a chemical equation

654
00:29:02,490 --> 00:29:05,360
because one piece of ATT&CK
tied to another piece

655
00:29:05,360 --> 00:29:06,459
of ATT&CK, tied to another piece

656
00:29:06,460 --> 00:29:07,910
of ATT&CK equals something else

657
00:29:07,910 --> 00:29:11,063
and there's a state basis to
it, the proverbial unicorn.

658
00:29:12,910 --> 00:29:15,210
So we want our threat
intelligence to be able

659
00:29:15,210 --> 00:29:17,590
to capture that same factor of it's not

660
00:29:17,590 --> 00:29:18,929
just a checklist of things.

661
00:29:18,930 --> 00:29:21,360
I haven't just tagged these
things, but I understand

662
00:29:21,360 --> 00:29:24,913
the context, the order and
the state of what's happening.

663
00:29:25,910 --> 00:29:28,370
So of course starting with Katie

664
00:29:28,370 --> 00:29:32,300
and always ending with
Katie, this could become

665
00:29:32,300 --> 00:29:34,649
a machine-readable format
that we could actually use,

666
00:29:34,650 --> 00:29:37,290
an operationalized threat
intelligence if we all commit

667
00:29:37,290 --> 00:29:39,629
to it together as an industry, thank you.

668
00:29:39,630 --> 00:29:42,293
- Our next speaker up is Emma MacMullan.

669
00:29:47,260 --> 00:29:49,110
Just a second, there you go.

670
00:29:49,110 --> 00:29:52,639
- Great, thanks, man, I feel
so underdressed now, gus.

671
00:29:52,640 --> 00:29:55,523
Where's my onesie? (laughing)

672
00:29:57,950 --> 00:29:59,810
All right, so I'm here today to talk

673
00:29:59,810 --> 00:30:03,159
about ATT&CK intelligence
and purple-teaming.

674
00:30:03,160 --> 00:30:05,220
And before I get started I have to give

675
00:30:05,220 --> 00:30:07,980
the obligatory caveat that
my views that I express today

676
00:30:07,980 --> 00:30:10,930
are my own and do not
necessarily represent those

677
00:30:10,930 --> 00:30:12,020
of the Federal Reserve Bank

678
00:30:12,020 --> 00:30:14,210
of New York or the Federal Reserve System.

679
00:30:14,210 --> 00:30:16,840
All right, that's as fun
as it's gonna get today.

680
00:30:16,840 --> 00:30:19,790
All right, so purple-teaming,
literally, what

681
00:30:19,790 --> 00:30:20,750
do I mean by that.

682
00:30:20,750 --> 00:30:23,363
It sounds very buzzwordy
so please forgive me.

683
00:30:24,420 --> 00:30:28,040
But really, everyone here's
been giving such great talks

684
00:30:28,040 --> 00:30:29,440
the past couple of days, right?

685
00:30:29,440 --> 00:30:30,984
People are doing detection, people

686
00:30:30,984 --> 00:30:33,230
are doing really cool heat maps

687
00:30:33,230 --> 00:30:34,730
that aren't just pew-pew maps.

688
00:30:34,730 --> 00:30:36,760
And people are also doing purple-teaming.

689
00:30:36,760 --> 00:30:39,342
We heard a great talk
about that earlier today.

690
00:30:39,342 --> 00:30:42,010
But why do we wanna do
micropurple-teaming.

691
00:30:42,010 --> 00:30:45,100
And specifically a
micropurple-teaming workflow.

692
00:30:45,100 --> 00:30:46,669
Well, it began, as you might expect

693
00:30:46,670 --> 00:30:49,610
with yet another fusion initiative.

694
00:30:49,610 --> 00:30:52,060
We've all heard that coming down the line

695
00:30:52,060 --> 00:30:54,270
from our leaders at some point or another.

696
00:30:54,270 --> 00:30:56,340
So really we were being tasked with

697
00:30:56,340 --> 00:30:59,526
saying, "All right, we need
to collaborate together not

698
00:30:59,527 --> 00:31:01,867
"just within the intelligence team,

699
00:31:01,867 --> 00:31:04,367
"but we also wanna
collaborate better across

700
00:31:04,367 --> 00:31:06,600
"this entire organization."

701
00:31:06,600 --> 00:31:10,649
We wanna be talking not
just to detection creation,

702
00:31:10,650 --> 00:31:11,550
but we wanna be talking

703
00:31:11,550 --> 00:31:13,430
about hunt teams, red teams, what are all

704
00:31:13,430 --> 00:31:14,930
of these other teams within our sock

705
00:31:14,930 --> 00:31:16,420
that we're not talking about?

706
00:31:16,420 --> 00:31:18,440
And ATT&CK was really the great vector

707
00:31:18,440 --> 00:31:21,070
to be the common language

708
00:31:21,070 --> 00:31:23,639
if you will, to be that
cornerstone, right?

709
00:31:23,640 --> 00:31:25,220
Well, we've already gotten pretty good

710
00:31:25,220 --> 00:31:27,050
at this center vertical.

711
00:31:27,050 --> 00:31:30,440
So that's ATT&CK-based
intelligence on the intel team we

712
00:31:30,440 --> 00:31:31,730
are breaking down our reports

713
00:31:31,730 --> 00:31:34,390
into TTPs, we were then handing that off

714
00:31:34,390 --> 00:31:36,940
for detection, creation, we
were integrating that into

715
00:31:36,940 --> 00:31:39,220
our reports, and we were looking around

716
00:31:39,220 --> 00:31:41,580
and saying, "Wow, we've
got so many great TTPs."

717
00:31:41,580 --> 00:31:42,939
We are so great at this.

718
00:31:42,940 --> 00:31:45,370
Who's using them?

719
00:31:45,370 --> 00:31:47,169
We're creating use cases for it,

720
00:31:47,170 --> 00:31:48,720
but I think there's probably

721
00:31:48,720 --> 00:31:50,480
a lot more other ways that we could be

722
00:31:50,480 --> 00:31:54,090
using this and then fusion
call came from on high.

723
00:31:54,090 --> 00:31:56,956
So we turned and said,
"Blue team, I heard you're

724
00:31:56,957 --> 00:31:57,977
"doing a hunt engagement.

725
00:31:57,977 --> 00:31:59,327
"We've got all these great TTPs.

726
00:31:59,327 --> 00:32:00,427
"We wrote a giant report.

727
00:32:00,427 --> 00:32:01,667
"Here you go.

728
00:32:01,667 --> 00:32:03,256
"Red team, we've heard you're doing

729
00:32:03,257 --> 00:32:05,257
"a really cool initiative on that side.

730
00:32:05,257 --> 00:32:08,037
"Here's a bunch of TTPs,
here's a great report.

731
00:32:08,037 --> 00:32:09,570
"Here you go."

732
00:32:09,570 --> 00:32:12,129
But we were stating to hit
some road blocks with that

733
00:32:12,130 --> 00:32:14,760
which is that you haven't truly
lived until you've written

734
00:32:14,760 --> 00:32:17,940
an 80 page report with
over 100 TTPs in it.

735
00:32:17,940 --> 00:32:21,110
And someone has to read that
because it's, guess what, got

736
00:32:21,110 --> 00:32:23,209
a spreadsheet attached to it.

737
00:32:23,210 --> 00:32:25,330
So that's no fun for anybody, right?

738
00:32:25,330 --> 00:32:28,010
And you can imagine that
people are super ecstatic

739
00:32:28,010 --> 00:32:30,600
when they get that much
to read and to work with.

740
00:32:30,600 --> 00:32:33,330
So there's clearly some
constraints and even on

741
00:32:33,330 --> 00:32:36,250
the intel side we are finding that, was

742
00:32:36,250 --> 00:32:38,000
the intel being generated?

743
00:32:38,000 --> 00:32:41,730
Were these TTPs being
generated, truly high-priority.

744
00:32:41,730 --> 00:32:44,190
Were they really what red
teams should be knowing about

745
00:32:44,190 --> 00:32:48,180
or are the TTPs who are being
created, a little repetitive

746
00:32:48,180 --> 00:32:50,850
because they're driven by the
similar custom requirements

747
00:32:50,850 --> 00:32:53,030
to report what we
already did on blue team?

748
00:32:53,030 --> 00:32:55,887
And if we're doing overlapping
work here, does blue team

749
00:32:55,887 --> 00:32:58,606
and red team even know they're
getting similar intelligence

750
00:32:58,606 --> 00:33:00,000
and what are they doing with it?

751
00:33:00,000 --> 00:33:02,640
So we clearly needed to do something.

752
00:33:02,640 --> 00:33:04,290
What's their solution?

753
00:33:04,290 --> 00:33:05,740
Make it micro.

754
00:33:05,740 --> 00:33:08,100
Instead of doing these big
reports, these big workups,

755
00:33:08,100 --> 00:33:09,990
these big engagements
that take a lot of time

756
00:33:09,990 --> 00:33:11,380
and have a lot of reporting.

757
00:33:11,380 --> 00:33:12,870
We thought, "Let's go small."

758
00:33:12,870 --> 00:33:13,879
So it all started with

759
00:33:13,880 --> 00:33:17,610
a single TTP which you've got
abbreviated here on the left.

760
00:33:17,610 --> 00:33:21,649
Cozy Bear, WMI, so tactic,
technique, we've abbreviated

761
00:33:21,650 --> 00:33:24,400
the procedure part so
don't get mad at me, Katie.

762
00:33:24,400 --> 00:33:26,093
It was there, I promise.

763
00:33:26,980 --> 00:33:30,190
And we gave that command to both red team

764
00:33:30,190 --> 00:33:32,370
and blue team at the same time.

765
00:33:32,370 --> 00:33:34,776
So red team says, "All
right, I've got this command

766
00:33:34,777 --> 00:33:37,200
"that I created to emulate this behavior."

767
00:33:37,200 --> 00:33:39,307
And blue team says, "I
created this use case

768
00:33:39,307 --> 00:33:41,030
"that will detect this behavior."

769
00:33:41,030 --> 00:33:42,960
And then we deployed it simultaneously

770
00:33:42,960 --> 00:33:44,630
in multiple different environments

771
00:33:44,630 --> 00:33:47,070
of the FRS or Federal Reserve System.

772
00:33:47,070 --> 00:33:48,879
So if any of you guys know anything

773
00:33:48,880 --> 00:33:51,480
about that we're pretty distributed,

774
00:33:51,480 --> 00:33:54,310
so lots of different environments there.

775
00:33:54,310 --> 00:33:56,580
And we found that, yes,
we could detect it,

776
00:33:56,580 --> 00:33:58,350
but we also found that

777
00:33:58,350 --> 00:34:01,050
in one particular environment, we didn't.

778
00:34:01,050 --> 00:34:04,139
So that leads us to
these final results which

779
00:34:04,140 --> 00:34:07,630
is that rapid emulation
validation is gonna help us be

780
00:34:07,630 --> 00:34:09,100
a lot more responsive

781
00:34:09,100 --> 00:34:11,719
to high-priority threat actor activity.

782
00:34:11,719 --> 00:34:13,169
And in particular gives us

783
00:34:13,170 --> 00:34:17,060
a lot better, more accurate
assumptions on coverage.

784
00:34:17,060 --> 00:34:20,239
So that created this new work
flow which is that instead

785
00:34:20,239 --> 00:34:22,226
of having a big engagement, we say,

786
00:34:22,226 --> 00:34:24,330
"All right, intel is determined."

787
00:34:24,330 --> 00:34:26,909
This is an event trigger
that if we see perhaps

788
00:34:26,909 --> 00:34:28,929
a threat actor exhibiting new behavior,

789
00:34:28,929 --> 00:34:31,239
but maybe just one single new behavior, we

790
00:34:31,239 --> 00:34:32,819
wanna make sure we're covered.

791
00:34:32,820 --> 00:34:35,240
We break that down in intel
and to different TTPs.

792
00:34:35,239 --> 00:34:39,479
Red team is able to emulate it,
blue team creates detection,

793
00:34:39,480 --> 00:34:40,810
then suddenly we can answer to

794
00:34:40,810 --> 00:34:43,090
the leadership, "Here's
what your coverage is."

795
00:34:43,090 --> 00:34:45,357
That question, they always
love to hear the answer to.

796
00:34:45,357 --> 00:34:47,409
And then finally lessons learned,

797
00:34:47,409 --> 00:34:49,049
on the intel side, we can continue

798
00:34:49,050 --> 00:34:51,400
to do those event triggers, but also we're

799
00:34:51,400 --> 00:34:53,920
learning more about our
enterprise as we do it.

800
00:34:53,920 --> 00:34:56,530
So at the end of the day,
purple-teaming is great,

801
00:34:56,530 --> 00:34:58,690
but let's make it micro, thank you.

802
00:34:58,690 --> 00:35:02,570
- I'm Nick Carr and this is
Guardrails of the Galaxy.

803
00:35:02,570 --> 00:35:06,250
So I work on a team
that's at the intersection

804
00:35:06,250 --> 00:35:09,420
of hunting and detection,
that looks across all

805
00:35:09,420 --> 00:35:10,920
of our Mandiant services

806
00:35:10,920 --> 00:35:13,670
and then across all the
FireEye product tech stack.

807
00:35:13,670 --> 00:35:17,500
We spend our time reverse
engineering attack techniques.

808
00:35:17,500 --> 00:35:19,680
So why talk about execution guardrails?

809
00:35:19,680 --> 00:35:22,390
First of all, this was
our first technique,

810
00:35:22,390 --> 00:35:23,520
our first new technique added

811
00:35:23,520 --> 00:35:27,210
in April 2019 to the ATT&CK matrix.

812
00:35:27,210 --> 00:35:28,690
My boss talks about them.

813
00:35:28,690 --> 00:35:31,717
Here, Kevin Mandia, is
saying, "The US uses,

814
00:35:31,717 --> 00:35:33,067
"their malware uses guardrails.

815
00:35:33,067 --> 00:35:35,800
"Other nations do not."

816
00:35:35,800 --> 00:35:40,490
Maybe examples that were
raised earlier by the ESET team

817
00:35:42,380 --> 00:35:43,270
and most importantly, I

818
00:35:43,270 --> 00:35:47,530
guess MITRE attack celebrity,
Katy Nickels liked my quote

819
00:35:47,530 --> 00:35:49,320
from Sate of the Hack
saying that the hallmark

820
00:35:49,320 --> 00:35:51,480
of sophistication is restraint.

821
00:35:51,480 --> 00:35:56,480
So if we agree that
sophistication means people

822
00:35:56,860 --> 00:35:59,020
are restraining their
activities and guardrails

823
00:35:59,020 --> 00:36:00,920
are a manifestation of restraint.

824
00:36:00,920 --> 00:36:02,340
Then it stands to reason that looking

825
00:36:02,340 --> 00:36:04,310
at execution guardrails is interesting

826
00:36:04,310 --> 00:36:06,740
and has sophisticated attackers.

827
00:36:06,740 --> 00:36:09,799
So a quick look here at the combination

828
00:36:09,800 --> 00:36:12,389
of the definition with
some detection concepts.

829
00:36:12,389 --> 00:36:14,210
Just boiling it down
really quickly, you're

830
00:36:14,210 --> 00:36:15,964
doing a couple things.

831
00:36:15,964 --> 00:36:17,799
The attackers are checking
an environmental condition

832
00:36:17,800 --> 00:36:18,900
and then they're comparing that

833
00:36:18,900 --> 00:36:20,790
to an attacker-supplied value.

834
00:36:20,790 --> 00:36:22,630
These are the behaviors

835
00:36:22,630 --> 00:36:25,020
in this particular order
that you wanna look for.

836
00:36:25,020 --> 00:36:27,820
I know I'm greatly generalizing
it for this quick talk

837
00:36:27,820 --> 00:36:30,230
and then MITRE also includes
environmental keying,

838
00:36:30,230 --> 00:36:31,750
protecting your payload

839
00:36:31,750 --> 00:36:34,133
with that same environmental information,

840
00:36:35,130 --> 00:36:38,310
so the use of those crypto
functions in that order.

841
00:36:38,310 --> 00:36:39,600
Again you can tie it together.

842
00:36:39,600 --> 00:36:41,350
So a couple detection issues

843
00:36:41,350 --> 00:36:44,120
that we run into when looking
for something like this.

844
00:36:44,120 --> 00:36:47,237
The first is that it
catches a lot of recon.

845
00:36:47,237 --> 00:36:50,140
If you image a non-targeted
phish that comes in

846
00:36:50,140 --> 00:36:52,400
and collects information
from the host about

847
00:36:52,400 --> 00:36:54,510
the environment and then beacons it

848
00:36:54,510 --> 00:36:55,950
and sends that back to an attacker

849
00:36:55,950 --> 00:36:58,549
and encrypts those results.

850
00:36:58,550 --> 00:37:00,570
So you run into this,
that's still evil, it's

851
00:37:00,570 --> 00:37:01,730
just the wrong kind of evil.

852
00:37:01,730 --> 00:37:03,830
It's not the guardrails we're looking for.

853
00:37:03,830 --> 00:37:05,360
We also see a lot of people confused.

854
00:37:05,360 --> 00:37:07,140
What we're trying to talk about here

855
00:37:07,140 --> 00:37:12,140
with more broad AV evasions or VM evasion,

856
00:37:12,370 --> 00:37:14,009
just looking to see if
what I'm running within

857
00:37:14,010 --> 00:37:16,070
a virtual machine isn't
what we're talking about

858
00:37:16,070 --> 00:37:19,280
because it's not attacker-supplied
and victim specific.

859
00:37:19,280 --> 00:37:21,030
And when you start to look at
all of those, you get a lot

860
00:37:21,030 --> 00:37:23,030
of other less interesting
things in the mix.

861
00:37:23,030 --> 00:37:24,610
The other thing that I see a lot of

862
00:37:24,610 --> 00:37:29,610
and occasionally share is
the insider threat, I guess,

863
00:37:30,250 --> 00:37:32,400
to guardrail detection which

864
00:37:32,400 --> 00:37:36,270
is legitimate uses of
protecting execution.

865
00:37:36,270 --> 00:37:38,600
In this case, here's a bank's macros that

866
00:37:38,600 --> 00:37:41,370
are actually checking the computer name,

867
00:37:41,370 --> 00:37:45,440
making sure it matches a
particular naming convention.

868
00:37:45,440 --> 00:37:47,400
It checks what domain
it's joined to, checks

869
00:37:47,400 --> 00:37:48,790
the egress IP address.

870
00:37:48,790 --> 00:37:50,820
It even runs interactive
recon and it does all that

871
00:37:50,820 --> 00:37:54,870
before it runs a legitimate
macro, so that's not malicious.

872
00:37:54,870 --> 00:37:57,220
Okay, what you're all
here for is the Guardies.

873
00:37:57,220 --> 00:37:59,917
So this is the first three Guardy Awards

874
00:37:59,917 --> 00:38:02,017
for technical achievement in guardrailing.

875
00:38:03,300 --> 00:38:04,940
So the first up is

876
00:38:04,940 --> 00:38:09,877
the offensive tool
Demiguise from NCC Group.

877
00:38:11,050 --> 00:38:13,910
These guys do some fantastic
guardrailing in the wild

878
00:38:13,910 --> 00:38:16,350
if you have a chance to look
at some of the things they do,

879
00:38:16,350 --> 00:38:19,240
but they publicly released
this Demiguise tool

880
00:38:19,240 --> 00:38:21,089
to encrypt HTA payloads.

881
00:38:21,090 --> 00:38:22,840
Rich Warren specifically does a lot here.

882
00:38:22,840 --> 00:38:24,190
This example's really neat.

883
00:38:24,190 --> 00:38:26,210
It looks for a network attached device.

884
00:38:26,210 --> 00:38:28,870
It looks for someone's where you'd expect

885
00:38:28,870 --> 00:38:30,950
to see the router's landing page, looks

886
00:38:30,950 --> 00:38:33,060
at the logo dimensions
and sees if it matches

887
00:38:33,060 --> 00:38:34,352
the logo dimensions

888
00:38:34,352 --> 00:38:38,500
of Virgin Mobile
broadband customer router.

889
00:38:38,500 --> 00:38:40,480
So it's an example of the kinds of things,

890
00:38:40,480 --> 00:38:41,750
they do a lot more of these.

891
00:38:41,750 --> 00:38:45,280
It's the kinds of ways that
you can restrict more than

892
00:38:45,280 --> 00:38:48,110
just a joined domain.

893
00:38:48,110 --> 00:38:49,340
The next one, I loved this one.

894
00:38:49,340 --> 00:38:52,340
The best use of guardrails
in a close access operation.

895
00:38:52,340 --> 00:38:53,820
Oh, this is spicy.

896
00:38:53,820 --> 00:38:58,530
To current detection at
two vendors, I could rant

897
00:38:58,530 --> 00:39:00,900
about how that doesn't really
rant about true detection,

898
00:39:00,900 --> 00:39:02,850
but anyways, this is currently
out there on Virus Total.

899
00:39:02,850 --> 00:39:04,330
I'll show the link afterwards.

900
00:39:04,330 --> 00:39:05,870
You don't have to do the government thing,

901
00:39:05,870 --> 00:39:08,859
how you hand copy hashes from screenshots.

902
00:39:08,860 --> 00:39:12,510
I'll share it out, but
this malware actually looks

903
00:39:12,510 --> 00:39:15,920
to see for a specific USB wireless adapter

904
00:39:15,920 --> 00:39:17,700
and then it actually adds

905
00:39:17,700 --> 00:39:21,622
in a rogue access point as a WLANProfile.

906
00:39:23,830 --> 00:39:26,200
It creates a rogue access point entry

907
00:39:26,200 --> 00:39:28,060
and tries to connect to that for C2.

908
00:39:28,060 --> 00:39:31,700
So this is, we believe the attacker was

909
00:39:31,700 --> 00:39:35,100
then physically close by
with an access point that

910
00:39:35,100 --> 00:39:36,630
this malware was designed to connect to

911
00:39:36,630 --> 00:39:38,980
and use that as covert C2.

912
00:39:38,980 --> 00:39:40,630
So pretty interesting,

913
00:39:40,630 --> 00:39:42,850
an interesting tactic to override these.

914
00:39:42,850 --> 00:39:43,960
Quickly I'm running out of time.

915
00:39:43,960 --> 00:39:45,150
I should have practiced.

916
00:39:45,150 --> 00:39:46,750
The lifetime achievement award

917
00:39:46,750 --> 00:39:48,400
in guardrailing goes to APT41.

918
00:39:48,400 --> 00:39:49,233
If you have a chance

919
00:39:49,233 --> 00:39:51,600
to check out our ATP41
report, you might be familiar

920
00:39:51,600 --> 00:39:53,020
with their supply chain compromises

921
00:39:53,020 --> 00:39:55,140
where they restrict
execution with Mac addresses.

922
00:39:55,140 --> 00:39:56,210
You might not know about

923
00:39:56,210 --> 00:39:58,500
the Microsoft crypto API that's tied

924
00:39:58,500 --> 00:40:01,310
to an individual user account
on an individual system

925
00:40:01,310 --> 00:40:02,143
and you might not know

926
00:40:02,143 --> 00:40:04,951
about volume serial IDs to keep payloads.

927
00:40:04,951 --> 00:40:07,015
- Thank you very much, Nick.

928
00:40:07,015 --> 00:40:09,932
(crowd applauding)

