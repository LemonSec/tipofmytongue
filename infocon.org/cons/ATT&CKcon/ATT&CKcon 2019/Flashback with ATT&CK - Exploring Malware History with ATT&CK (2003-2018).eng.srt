1
00:00:00,559 --> 00:00:13,039
please join me in welcoming Chris Oh

2
00:00:03,530 --> 00:00:15,440
stuck yes so basically I investigated a

3
00:00:13,039 --> 00:00:17,689
big corpus of Malloy's mower windows

4
00:00:15,440 --> 00:00:19,939
malware and I've plotted the results on

5
00:00:17,690 --> 00:00:22,280
the attack framework and this gives you

6
00:00:19,940 --> 00:00:29,030
very good impression of how to

7
00:00:22,280 --> 00:00:32,058
prioritize in your mitigation yeah so

8
00:00:29,030 --> 00:00:33,559
this is the front slide oh yeah so I did

9
00:00:32,058 --> 00:00:35,959
all of this as part of a part-time PhD

10
00:00:33,559 --> 00:00:38,780
at the cyber threat intelligence led at

11
00:00:35,960 --> 00:00:41,269
Delft University of Technology in daily

12
00:00:38,780 --> 00:00:43,030
life I'm a sock analyst with a focus on

13
00:00:41,269 --> 00:00:45,589
threat intelligence as Rijkswaterstaat

14
00:00:43,030 --> 00:00:47,929
which is the largest public sector

15
00:00:45,589 --> 00:00:49,850
provider of critical infrastructure in

16
00:00:47,929 --> 00:00:52,609
the Netherlands and responsible for most

17
00:00:49,850 --> 00:00:55,039
of the National dams storm barriers

18
00:00:52,609 --> 00:00:58,329
railways waterways and not railways

19
00:00:55,039 --> 00:01:01,519
roadways waterways all stuff like that

20
00:00:58,329 --> 00:01:03,109
yeah so quick index before going to the

21
00:01:01,519 --> 00:01:04,699
results I would like to give you some

22
00:01:03,109 --> 00:01:06,500
background on the organization I'm

23
00:01:04,699 --> 00:01:10,880
working for because this is heavily

24
00:01:06,500 --> 00:01:12,770
affected how this research came about so

25
00:01:10,880 --> 00:01:14,719
the Dutch they've been living below sea

26
00:01:12,770 --> 00:01:16,969
level for hundreds of years

27
00:01:14,719 --> 00:01:18,919
most of our capital Amsterdam is four

28
00:01:16,969 --> 00:01:21,250
meters below sea level where it's some

29
00:01:18,920 --> 00:01:24,770
parts even sick six

30
00:01:21,250 --> 00:01:27,380
so as imagine the risk of the flood is

31
00:01:24,770 --> 00:01:29,539
immensely high right and just a sink

32
00:01:27,380 --> 00:01:31,520
with you here on the terminology with a

33
00:01:29,539 --> 00:01:34,670
flood I mean an overflow another syn

34
00:01:31,520 --> 00:01:36,048
flood and with an overflow I don't mean

35
00:01:34,670 --> 00:01:39,380
a buffer overflow but an overflow of

36
00:01:36,049 --> 00:01:42,829
water so as a form of risk mitigation

37
00:01:39,380 --> 00:01:46,399
against this we have built the Delta

38
00:01:42,829 --> 00:01:48,889
works and by this we have decreased the

39
00:01:46,399 --> 00:01:52,700
risk of a flood striking to once in

40
00:01:48,890 --> 00:01:54,259
every four thousand years so you might

41
00:01:52,700 --> 00:01:56,479
now be asking why am I telling you all

42
00:01:54,259 --> 00:01:58,729
this this is because if you work in an

43
00:01:56,479 --> 00:02:00,439
organization like this on a daily basis

44
00:01:58,729 --> 00:02:03,158
this affects how you look at cyber

45
00:02:00,439 --> 00:02:07,628
defense right because these Delta works

46
00:02:03,159 --> 00:02:09,840
well basically it is a physical form of

47
00:02:07,629 --> 00:02:12,660
perimeter

48
00:02:09,840 --> 00:02:15,720
defense or as we would like to call it a

49
00:02:12,660 --> 00:02:17,819
physical kill chain it's a physical kill

50
00:02:15,720 --> 00:02:22,520
chain and in the against an advance

51
00:02:17,819 --> 00:02:25,649
purchase the natural tress basically so

52
00:02:22,520 --> 00:02:28,830
yeah with this in mind I have a look at

53
00:02:25,650 --> 00:02:31,440
this kill chain now here enter academia

54
00:02:28,830 --> 00:02:33,900
because this of course is the Lockheed

55
00:02:31,440 --> 00:02:36,660
Martin cyber kill chain and when I

56
00:02:33,900 --> 00:02:38,069
started my PhD I saw this model is

57
00:02:36,660 --> 00:02:39,630
gaining a lot of traction and I'm

58
00:02:38,069 --> 00:02:42,958
getting a lot of attention within

59
00:02:39,630 --> 00:02:45,030
academia in contrast for example to the

60
00:02:42,959 --> 00:02:48,780
attack framework for which I didn't see

61
00:02:45,030 --> 00:02:50,730
that much coverage so I'm not going to

62
00:02:48,780 --> 00:02:54,000
compare the kill chain to the technology

63
00:02:50,730 --> 00:02:57,690
today but of course well I decided to

64
00:02:54,000 --> 00:02:59,760
give attack the academic attention it

65
00:02:57,690 --> 00:03:03,840
deserves or at least to make a decent

66
00:02:59,760 --> 00:03:05,399
start but unfortunately unfortunately

67
00:03:03,840 --> 00:03:08,069
you cannot just you know go about

68
00:03:05,400 --> 00:03:11,310
writing a paper saying hey guys adopt

69
00:03:08,069 --> 00:03:13,738
this model believe me it's great yeah so

70
00:03:11,310 --> 00:03:18,870
you should do something with it so long

71
00:03:13,739 --> 00:03:20,489
story short I studied analyze the big

72
00:03:18,870 --> 00:03:22,980
corpus of Windows malware nine hundred

73
00:03:20,489 --> 00:03:25,109
fifty families basically and I

74
00:03:22,980 --> 00:03:28,200
communicated the results in a research

75
00:03:25,109 --> 00:03:31,890
paper using the uniform language offered

76
00:03:28,200 --> 00:03:34,980
by the attack framework so our

77
00:03:31,890 --> 00:03:37,738
methodology we got our data sample from

78
00:03:34,980 --> 00:03:41,100
NOPD a-- which is an invite-only

79
00:03:37,739 --> 00:03:44,130
repository maintained by the german /

80
00:03:41,100 --> 00:03:46,858
Institute and it this is a curated data

81
00:03:44,130 --> 00:03:49,709
set which means that it provides several

82
00:03:46,859 --> 00:03:51,389
quality assurances over just you know

83
00:03:49,709 --> 00:03:54,000
randomly picking your mallow samples

84
00:03:51,389 --> 00:03:56,450
from the world for example it is also

85
00:03:54,000 --> 00:03:59,519
labeled data set which means it provides

86
00:03:56,450 --> 00:04:02,069
metadata for most mallow families so

87
00:03:59,519 --> 00:04:04,590
stuff like name of course year of origin

88
00:04:02,069 --> 00:04:08,399
but also attribution based on open

89
00:04:04,590 --> 00:04:10,440
source reporting so as my birria offers

90
00:04:08,400 --> 00:04:12,780
for most mountain mower families

91
00:04:10,440 --> 00:04:15,299
multiple samples we ran all the hash

92
00:04:12,780 --> 00:04:18,450
values of the samples offered by this

93
00:04:15,299 --> 00:04:21,298
repository to virus total to select the

94
00:04:18,450 --> 00:04:23,580
most recent sample for each family

95
00:04:21,298 --> 00:04:26,789
and then we rent that sample through an

96
00:04:23,580 --> 00:04:29,849
offer an SEM box that was offered to

97
00:04:26,789 --> 00:04:31,979
also provided to us by Joe security they

98
00:04:29,849 --> 00:04:34,020
have an online sandbox for automated

99
00:04:31,979 --> 00:04:36,810
malware analysis which can be regarded

100
00:04:34,020 --> 00:04:38,609
as quite representative for most of the

101
00:04:36,810 --> 00:04:41,400
current market market offerings or

102
00:04:38,610 --> 00:04:42,840
automated malware analysis which you

103
00:04:41,400 --> 00:04:45,198
want right because you want your

104
00:04:42,840 --> 00:04:49,440
research to be reproducible and

105
00:04:45,199 --> 00:04:52,919
representative so then we also developed

106
00:04:49,440 --> 00:04:54,900
manual plotting of all the raw sandbox

107
00:04:52,919 --> 00:04:59,340
activity logging to the attack framework

108
00:04:54,900 --> 00:05:03,690
and well if you do all of that you will

109
00:04:59,340 --> 00:05:06,060
get this you will get this this is of

110
00:05:03,690 --> 00:05:08,430
course the standard 8 enterprise matrix

111
00:05:06,060 --> 00:05:11,130
of the attack framework as it was before

112
00:05:08,430 --> 00:05:12,900
the April update of the framework you

113
00:05:11,130 --> 00:05:17,729
know timelines and academia are quite

114
00:05:12,900 --> 00:05:20,159
long so yeah I know most of this will be

115
00:05:17,729 --> 00:05:21,659
difficult to read for most of you but

116
00:05:20,159 --> 00:05:23,490
this is of course the failover in the

117
00:05:21,659 --> 00:05:25,349
published paper that's available for

118
00:05:23,490 --> 00:05:30,090
download and also they're also available

119
00:05:25,349 --> 00:05:32,610
for download as a separate file so what

120
00:05:30,090 --> 00:05:34,830
I will do now is I will quickly go

121
00:05:32,610 --> 00:05:37,349
through the most relevant results of our

122
00:05:34,830 --> 00:05:40,169
paper there's more in the food paper of

123
00:05:37,349 --> 00:05:42,779
course but this might give you a good

124
00:05:40,169 --> 00:05:46,258
impression of the direction in which

125
00:05:42,779 --> 00:05:48,090
certain techniques are heading and this

126
00:05:46,259 --> 00:05:51,779
of course might even inform your own

127
00:05:48,090 --> 00:05:55,349
mitigation yeah so with the slide format

128
00:05:51,779 --> 00:05:57,680
the red down arrow basically indicates a

129
00:05:55,349 --> 00:06:01,440
decrease in the use of this technique

130
00:05:57,680 --> 00:06:03,719
observed in a data set or covered for

131
00:06:01,440 --> 00:06:07,770
the covered by the time frame of a data

132
00:06:03,719 --> 00:06:11,669
sets over time and the green up arrow

133
00:06:07,770 --> 00:06:14,460
exactly the opposite so for D techniques

134
00:06:11,669 --> 00:06:16,889
used for the execution tactic basically

135
00:06:14,460 --> 00:06:19,349
the most observed technique in our data

136
00:06:16,889 --> 00:06:21,509
set was execution through API which

137
00:06:19,349 --> 00:06:23,940
means malware calls the create process

138
00:06:21,509 --> 00:06:26,849
function of the witness API in order to

139
00:06:23,940 --> 00:06:28,770
launch malicious code while this is the

140
00:06:26,849 --> 00:06:31,169
most absurd technique it is also

141
00:06:28,770 --> 00:06:33,029
decreasing off time which means it is

142
00:06:31,169 --> 00:06:34,529
getting replaced by other techniques

143
00:06:33,029 --> 00:06:37,469
used in DX

144
00:06:34,529 --> 00:06:39,539
in tactic for example by obfuscated

145
00:06:37,469 --> 00:06:44,789
comment lines which are gaining traction

146
00:06:39,539 --> 00:06:47,519
over the last couple of years now one of

147
00:06:44,789 --> 00:06:49,769
the other techniques gaining traction is

148
00:06:47,519 --> 00:06:51,769
of course the whole file inspector this

149
00:06:49,769 --> 00:06:55,999
shouldn't be surprising to you of course

150
00:06:51,769 --> 00:06:58,799
but what we found interesting is that

151
00:06:55,999 --> 00:07:01,649
files malware receives its first

152
00:06:58,799 --> 00:07:04,349
coverage in academia around 2070 and

153
00:07:01,649 --> 00:07:08,459
this was also the first year for which

154
00:07:04,349 --> 00:07:11,699
is also observed in the data set so then

155
00:07:08,459 --> 00:07:12,929
defense evasion for base for defense

156
00:07:11,699 --> 00:07:14,399
evasion they were basically five

157
00:07:12,929 --> 00:07:17,938
techniques that really stood out here

158
00:07:14,399 --> 00:07:21,839
with a significant increase for DLL side

159
00:07:17,939 --> 00:07:22,499
loading over recent years and then

160
00:07:21,839 --> 00:07:24,059
discovery

161
00:07:22,499 --> 00:07:27,449
well discovery is interesting right

162
00:07:24,059 --> 00:07:30,569
because most malware does some form of

163
00:07:27,449 --> 00:07:34,079
discovery just like most benign

164
00:07:30,569 --> 00:07:37,469
applications as you can see here in the

165
00:07:34,079 --> 00:07:40,499
query registry technique for example so

166
00:07:37,469 --> 00:07:42,779
this is interesting because in daily

167
00:07:40,499 --> 00:07:45,209
practice this means it can be pretty

168
00:07:42,779 --> 00:07:47,519
difficult to distinguish malicious

169
00:07:45,209 --> 00:07:49,709
discovery so to say from benign

170
00:07:47,519 --> 00:07:52,799
discovery because it relies mostly on

171
00:07:49,709 --> 00:07:55,110
native operating system functions what

172
00:07:52,799 --> 00:07:58,638
we are however saw is a significant

173
00:07:55,110 --> 00:08:01,860
increase in malware using or doing

174
00:07:58,639 --> 00:08:03,899
discovery of security software this

175
00:08:01,860 --> 00:08:06,119
includes quite straightforward stuff

176
00:08:03,899 --> 00:08:09,599
such as looking for local antivirus and

177
00:08:06,119 --> 00:08:11,959
looking for local firewall rules but

178
00:08:09,599 --> 00:08:15,509
also more advanced and virtualization

179
00:08:11,959 --> 00:08:18,329
such as executing read date/time stem

180
00:08:15,509 --> 00:08:20,369
counter instructions this is basically

181
00:08:18,329 --> 00:08:21,779
something from which the presence of a

182
00:08:20,369 --> 00:08:28,679
debugger running on the system can be

183
00:08:21,779 --> 00:08:30,029
inferred so then command control command

184
00:08:28,679 --> 00:08:32,909
control is typically one of those

185
00:08:30,029 --> 00:08:35,219
techniques that can be very difficult to

186
00:08:32,909 --> 00:08:37,979
observe in a sandbox for different kinds

187
00:08:35,219 --> 00:08:41,300
of reasons and this also reflects in our

188
00:08:37,979 --> 00:08:44,250
results however what I would like to

189
00:08:41,299 --> 00:08:47,160
discuss with you today is a specific

190
00:08:44,250 --> 00:08:50,629
implementation of process injection

191
00:08:47,160 --> 00:08:53,329
which we saw applied for command control

192
00:08:50,629 --> 00:08:56,579
are you still awake

193
00:08:53,329 --> 00:08:58,769
okay good because then you will probably

194
00:08:56,579 --> 00:09:00,899
say hey processing control that's a

195
00:08:58,769 --> 00:09:02,879
technique primarily being used in the

196
00:09:00,899 --> 00:09:05,610
breathless escalation and defense

197
00:09:02,879 --> 00:09:06,179
evasion technique right yes that's

198
00:09:05,610 --> 00:09:08,250
correct

199
00:09:06,179 --> 00:09:10,709
but if you look this up on the mitem

200
00:09:08,250 --> 00:09:13,500
technology base you will see that they

201
00:09:10,709 --> 00:09:16,920
refer to a specific implementation of

202
00:09:13,500 --> 00:09:19,199
process injection namely the use of IPC

203
00:09:16,920 --> 00:09:22,139
name pipes being used for command and

204
00:09:19,199 --> 00:09:24,269
control and it also says that this

205
00:09:22,139 --> 00:09:28,199
applies to the more sophisticated

206
00:09:24,269 --> 00:09:31,879
samples of malware now we found that

207
00:09:28,199 --> 00:09:34,410
this is true but only partially so

208
00:09:31,879 --> 00:09:35,879
because what we found is that this

209
00:09:34,410 --> 00:09:39,350
technique for command and control

210
00:09:35,879 --> 00:09:42,720
IPC overnight pipes is indeed applied by

211
00:09:39,350 --> 00:09:46,199
more sophisticated samples of more molar

212
00:09:42,720 --> 00:09:49,949
or well malware applied to more

213
00:09:46,199 --> 00:09:54,959
sophisticated actors before 2015 but

214
00:09:49,949 --> 00:09:58,199
after 2015 it is adopted by what you

215
00:09:54,959 --> 00:10:00,929
could call a commodity molar authors

216
00:09:58,199 --> 00:10:02,519
like mid-level market authors and also

217
00:10:00,929 --> 00:10:07,410
quickly dropped by the sophisticated

218
00:10:02,519 --> 00:10:10,259
ones so you might ask you might ask how

219
00:10:07,410 --> 00:10:13,319
can you say this remember our data set

220
00:10:10,259 --> 00:10:15,629
is a label data set so it does

221
00:10:13,319 --> 00:10:18,750
attribution to trade actors based on

222
00:10:15,629 --> 00:10:21,209
open source reporting so for most for

223
00:10:18,750 --> 00:10:24,439
most our families they refer to like

224
00:10:21,209 --> 00:10:27,179
five or six open source pending reports

225
00:10:24,439 --> 00:10:29,790
so based on that made of data we were

226
00:10:27,179 --> 00:10:31,920
able to attribute mount malware not only

227
00:10:29,790 --> 00:10:35,339
to actors but also two categories of

228
00:10:31,920 --> 00:10:38,160
actors and based on this well we were

229
00:10:35,339 --> 00:10:40,470
able to see this pattern of course there

230
00:10:38,160 --> 00:10:42,750
are you know several theories which

231
00:10:40,470 --> 00:10:44,750
might explain this but for us it was

232
00:10:42,750 --> 00:10:47,910
interesting as it kind of proves the

233
00:10:44,750 --> 00:10:50,160
hypothesis that more techniques are

234
00:10:47,910 --> 00:10:52,919
brought to the ecosystem by advanced

235
00:10:50,160 --> 00:10:54,959
actors and then quickly adopted by the

236
00:10:52,919 --> 00:10:57,709
well commodity authors or the less

237
00:10:54,959 --> 00:10:57,709
sophisticated ones

238
00:10:58,600 --> 00:11:05,950
so as we're moving towards the end this

239
00:11:03,380 --> 00:11:08,870
is what I would like to leave you with

240
00:11:05,950 --> 00:11:10,460
it has already already been set during

241
00:11:08,870 --> 00:11:14,560
this conference and rightly so that

242
00:11:10,460 --> 00:11:16,760
attack is great for CGI right undeniably

243
00:11:14,560 --> 00:11:19,040
it is perhaps for this reason that you

244
00:11:16,760 --> 00:11:23,319
see more and more vendors in the cyber

245
00:11:19,040 --> 00:11:26,089
security market implementing you know

246
00:11:23,320 --> 00:11:28,610
automated attack matrices as a form of

247
00:11:26,089 --> 00:11:32,029
CGI within their product products you

248
00:11:28,610 --> 00:11:33,950
know like we did manually but what what

249
00:11:32,029 --> 00:11:37,910
I would like to argue here today is that

250
00:11:33,950 --> 00:11:41,080
yes the tech is great for CDI but using

251
00:11:37,910 --> 00:11:44,750
a tech in this form does not make it CDI

252
00:11:41,080 --> 00:11:46,459
because you know such an well such an

253
00:11:44,750 --> 00:11:49,190
automatic plotting might come across as

254
00:11:46,459 --> 00:11:51,979
a trustworthy verdict on what a certain

255
00:11:49,190 --> 00:11:54,080
type of malware is capable of because

256
00:11:51,980 --> 00:11:56,300
you trust this vendor these tools have

257
00:11:54,080 --> 00:11:59,240
the limitations and we call these biases

258
00:11:56,300 --> 00:12:00,800
inter intelligence right these are these

259
00:11:59,240 --> 00:12:03,980
tools they can only see so much and

260
00:12:00,800 --> 00:12:07,790
they're just biased towards that in the

261
00:12:03,980 --> 00:12:09,589
presentation of their results so yeah

262
00:12:07,790 --> 00:12:11,839
this goes for anything basically in

263
00:12:09,589 --> 00:12:13,880
threat intelligence results always

264
00:12:11,839 --> 00:12:18,110
depends on the capabilities of the

265
00:12:13,880 --> 00:12:20,050
resource used for analysis right so you

266
00:12:18,110 --> 00:12:22,250
need to account for each of these biases

267
00:12:20,050 --> 00:12:26,630
otherwise you'll get mistreated further

268
00:12:22,250 --> 00:12:29,630
down the road so very important look at

269
00:12:26,630 --> 00:12:33,140
what something can tell you but above

270
00:12:29,630 --> 00:12:36,050
all at what I cannot tell you right so

271
00:12:33,140 --> 00:12:38,260
yeah basically if we figured automated

272
00:12:36,050 --> 00:12:41,990
that automated analysis is great for CGI

273
00:12:38,260 --> 00:12:46,939
but unsuited as a source for CGI by

274
00:12:41,990 --> 00:12:50,029
itself so yeah guys stay safe stay

275
00:12:46,940 --> 00:12:53,000
critical and be aware of your own biases

276
00:12:50,029 --> 00:12:56,130
but also the biases brought by your tool

277
00:12:53,000 --> 00:13:00,100
kit thank you

278
00:12:56,130 --> 00:13:00,100
[Applause]

