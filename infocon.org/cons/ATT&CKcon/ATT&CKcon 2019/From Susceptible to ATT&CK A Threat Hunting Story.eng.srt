1
00:00:00,590 --> 00:00:05,139
please join me in welcoming Chris Thayer

2
00:00:13,809 --> 00:00:20,600
thanks Katie and I just wanted everybody

3
00:00:18,080 --> 00:00:24,310
to bear with me this is my first talk in

4
00:00:20,600 --> 00:00:27,230
front of any conference so there's a

5
00:00:24,310 --> 00:00:30,409
there's a small chance I may run out the

6
00:00:27,230 --> 00:00:31,910
door and back to my car so and thanks

7
00:00:30,410 --> 00:00:35,390
for laughing at that that makes it just

8
00:00:31,910 --> 00:00:37,160
a chance a little bit smaller so so I

9
00:00:35,390 --> 00:00:38,149
just wanted to start a little bit with

10
00:00:37,160 --> 00:00:42,190
my background

11
00:00:38,149 --> 00:00:42,190
oh let's see if I can get this to work

12
00:00:43,659 --> 00:00:46,659
maybe

13
00:00:55,989 --> 00:01:01,430
yeah doesn't say which which I'm afraid

14
00:01:00,410 --> 00:01:05,238
to hit any of the other buttons that

15
00:01:01,430 --> 00:01:08,720
don't look like arrows there we go okay

16
00:01:05,239 --> 00:01:13,610
all right so I'm from st. Louis Missouri

17
00:01:08,720 --> 00:01:16,310
so I have seven years background and

18
00:01:13,610 --> 00:01:19,039
information security almost all of its n

19
00:01:16,310 --> 00:01:20,570
I are working for MasterCard so I've

20
00:01:19,040 --> 00:01:22,220
worked on their started in their

21
00:01:20,570 --> 00:01:23,929
Security Operations Center I've worked

22
00:01:22,220 --> 00:01:25,490
on their design and architecture team

23
00:01:23,930 --> 00:01:28,610
I've worked on their third intelligence

24
00:01:25,490 --> 00:01:34,149
team and currently I'm the technical

25
00:01:28,610 --> 00:01:36,920
lead for their digital forensics lab so

26
00:01:34,149 --> 00:01:39,170
overall I am a blue team or at heart

27
00:01:36,920 --> 00:01:42,500
I remember has anyone played Starcraft

28
00:01:39,170 --> 00:01:44,869
at all I remember as a kid I played

29
00:01:42,500 --> 00:01:47,090
Starcraft I loved playing it I always

30
00:01:44,869 --> 00:01:49,039
had more fun building up defenses than I

31
00:01:47,090 --> 00:01:50,330
did actually attacking people which is

32
00:01:49,039 --> 00:01:53,240
anyone who's played the game knows

33
00:01:50,330 --> 00:01:55,158
that's not a good way to win so that's

34
00:01:53,240 --> 00:01:56,990
something I've actually taken into my

35
00:01:55,159 --> 00:01:58,819
career a little bit I don't do pen

36
00:01:56,990 --> 00:02:00,860
testing professionally but I have a lab

37
00:01:58,819 --> 00:02:02,479
where I try to keep my skills up because

38
00:02:00,860 --> 00:02:05,079
I think it's important when we're

39
00:02:02,479 --> 00:02:07,939
dealing from the defensive side so

40
00:02:05,079 --> 00:02:10,970
MasterCard our digital forensics lab is

41
00:02:07,939 --> 00:02:13,700
an IAB accredited lab which means we

42
00:02:10,970 --> 00:02:16,310
have lots of policies and procedures we

43
00:02:13,700 --> 00:02:18,320
have to follow along with evidence

44
00:02:16,310 --> 00:02:20,810
handling and chain of custody and all

45
00:02:18,320 --> 00:02:22,430
that there are also certain roles built

46
00:02:20,810 --> 00:02:23,840
out where I said I was tech lead there's

47
00:02:22,430 --> 00:02:26,269
a couple of roles that are built out

48
00:02:23,840 --> 00:02:27,410
with a nav procedures so we handle

49
00:02:26,269 --> 00:02:29,810
everything

50
00:02:27,410 --> 00:02:34,220
all internal investigations from malware

51
00:02:29,810 --> 00:02:37,549
to web application compromised possible

52
00:02:34,220 --> 00:02:39,109
compromises as tech lead I'm also

53
00:02:37,549 --> 00:02:42,109
responsible for creating new

54
00:02:39,109 --> 00:02:43,579
investigation procedures evaluating new

55
00:02:42,109 --> 00:02:46,790
software hardware and kind of

56
00:02:43,579 --> 00:02:49,820
implementing that and then on top of

57
00:02:46,790 --> 00:02:51,709
that we recently as Katie mentioned I

58
00:02:49,820 --> 00:02:54,350
kind of started a one-man threat hunting

59
00:02:51,709 --> 00:02:55,609
program there and the reason I wanted to

60
00:02:54,350 --> 00:02:57,620
mention this I don't want you to feel

61
00:02:55,609 --> 00:02:59,239
sorry for me because I have lots to do I

62
00:02:57,620 --> 00:03:01,670
think that's a real common problem in

63
00:02:59,239 --> 00:03:03,650
our industry so anything I can do to

64
00:03:01,670 --> 00:03:05,899
save time any kind of automation I can

65
00:03:03,650 --> 00:03:07,459
do I try to do it and I think that

66
00:03:05,900 --> 00:03:08,310
there's a lot of people in that same

67
00:03:07,459 --> 00:03:10,140
boat kind of

68
00:03:08,310 --> 00:03:11,910
here which is one of the reasons I think

69
00:03:10,140 --> 00:03:14,339
we're all here in mic attack because

70
00:03:11,910 --> 00:03:24,750
they do a lot of hard work where they

71
00:03:14,340 --> 00:03:26,340
can save us a lot of time there we go

72
00:03:24,750 --> 00:03:29,489
the other one is probably a little more

73
00:03:26,340 --> 00:03:34,459
batteries all right so so I wanted to

74
00:03:29,489 --> 00:03:37,110
kind of go over the agenda real quick so

75
00:03:34,459 --> 00:03:39,750
the first part is mitre attack doesn't

76
00:03:37,110 --> 00:03:41,130
need to be complex the second part that

77
00:03:39,750 --> 00:03:43,709
we're gonna go over is I kind of just

78
00:03:41,130 --> 00:03:45,959
wanted to throw a definition of what the

79
00:03:43,709 --> 00:03:48,330
red hunting is mainly because I think

80
00:03:45,959 --> 00:03:49,950
that there are a lot of different

81
00:03:48,330 --> 00:03:51,989
definitions out there it's kind of been

82
00:03:49,950 --> 00:03:53,579
one of those one of those buzz words and

83
00:03:51,989 --> 00:03:55,500
I think that at least for this

84
00:03:53,580 --> 00:03:57,000
presentation I wanted to define it so we

85
00:03:55,500 --> 00:03:59,220
all kind of are on the same page I

86
00:03:57,000 --> 00:04:01,310
wanted to talk about our first phase

87
00:03:59,220 --> 00:04:04,160
which was I called it just before attack

88
00:04:01,310 --> 00:04:06,900
and then phase to you after attack and

89
00:04:04,160 --> 00:04:12,870
then just go through any if we have time

90
00:04:06,900 --> 00:04:16,560
some questions and answers so I wanted

91
00:04:12,870 --> 00:04:18,590
to talk about we've we've seen a lot of

92
00:04:16,560 --> 00:04:20,668
presentations this morning where

93
00:04:18,589 --> 00:04:22,169
everyone talked about implementing

94
00:04:20,668 --> 00:04:24,240
attack in their own way and one of the

95
00:04:22,169 --> 00:04:26,549
common trends is it's complex there's a

96
00:04:24,240 --> 00:04:28,740
lot to do here we saw one of the earlier

97
00:04:26,550 --> 00:04:30,000
presentations talked about you know if

98
00:04:28,740 --> 00:04:31,470
you're really going to do this right it

99
00:04:30,000 --> 00:04:33,330
probably is going to take a year at your

100
00:04:31,470 --> 00:04:35,039
organization and I know most of these

101
00:04:33,330 --> 00:04:36,719
big organizations everything kind of

102
00:04:35,039 --> 00:04:38,280
moves slow because it's not just you you

103
00:04:36,720 --> 00:04:40,680
got to get a lot of people's buy-ins a

104
00:04:38,280 --> 00:04:43,409
lot of this processes manual where you

105
00:04:40,680 --> 00:04:44,880
have to score it and map it report on it

106
00:04:43,410 --> 00:04:48,720
and convince everyone this is worth

107
00:04:44,880 --> 00:04:50,159
doing and sometimes that involves a lot

108
00:04:48,720 --> 00:04:53,090
of teams getting them together and make

109
00:04:50,160 --> 00:04:55,740
sure they work so I kind of wanted to

110
00:04:53,090 --> 00:04:58,229
bring our story together because I think

111
00:04:55,740 --> 00:05:00,780
that it's a way where you can use attack

112
00:04:58,229 --> 00:05:03,240
and kind of pick and choose what you use

113
00:05:00,780 --> 00:05:05,729
and you can do as little or as much as

114
00:05:03,240 --> 00:05:10,970
you want and you're the ones that decide

115
00:05:05,729 --> 00:05:10,969
decide where to go as you use attack I

116
00:05:11,030 --> 00:05:16,200
did also want to mention that even

117
00:05:13,380 --> 00:05:19,409
though the when I talked about us

118
00:05:16,200 --> 00:05:21,000
implementing it we we actually are doing

119
00:05:19,409 --> 00:05:21,840
that and if you're doing that don't stop

120
00:05:21,000 --> 00:05:23,940
it's great

121
00:05:21,840 --> 00:05:31,049
this is just kind of a complement to

122
00:05:23,940 --> 00:05:35,340
that so what is threat hunting so I

123
00:05:31,050 --> 00:05:36,870
recently did about six or seven

124
00:05:35,340 --> 00:05:39,270
interviews for our team with an open

125
00:05:36,870 --> 00:05:41,220
position and I think every single person

126
00:05:39,270 --> 00:05:42,960
had threat hunting on their resume and

127
00:05:41,220 --> 00:05:44,970
so I asked him about it because I was

128
00:05:42,960 --> 00:05:48,599
interested in it because of this program

129
00:05:44,970 --> 00:05:50,490
so one of the one of the guys said he

130
00:05:48,600 --> 00:05:52,050
was just making similar it's another

131
00:05:50,490 --> 00:05:54,540
person said they're querying there's

132
00:05:52,050 --> 00:05:56,070
some for IO C's they found another

133
00:05:54,540 --> 00:05:58,380
person said they were patching

134
00:05:56,070 --> 00:06:00,060
vulnerabilities another person said they

135
00:05:58,380 --> 00:06:03,000
were in around and were fixing bad

136
00:06:00,060 --> 00:06:04,979
policies and then one guy even told me

137
00:06:03,000 --> 00:06:07,560
he was just looking for failed logins

138
00:06:04,979 --> 00:06:09,210
throughout the environment and all these

139
00:06:07,560 --> 00:06:11,010
are good we should be doing them but I

140
00:06:09,210 --> 00:06:13,109
really wouldn't consider any of those

141
00:06:11,010 --> 00:06:15,510
threat hunting so I threw up the

142
00:06:13,110 --> 00:06:18,270
definition I found online that I thought

143
00:06:15,510 --> 00:06:20,909
kind of fit it bet best and it's the

144
00:06:18,270 --> 00:06:22,950
proact or the process of proactively and

145
00:06:20,910 --> 00:06:25,290
iteratively searching through systems to

146
00:06:22,950 --> 00:06:27,599
detect and isolate advanced threats that

147
00:06:25,290 --> 00:06:29,070
evade existing security solutions so I

148
00:06:27,600 --> 00:06:31,110
kind of else I threw up the threat

149
00:06:29,070 --> 00:06:33,950
hunting loop also I think it's important

150
00:06:31,110 --> 00:06:36,300
to see there you start with a hypothesis

151
00:06:33,950 --> 00:06:39,690
you kind of investigate it through tools

152
00:06:36,300 --> 00:06:43,620
and techniques or and you uncover new

153
00:06:39,690 --> 00:06:45,450
patterns we talked about TTP's earlier I

154
00:06:43,620 --> 00:06:47,100
think it's important if you don't

155
00:06:45,450 --> 00:06:49,800
uncover new patterns too I think that

156
00:06:47,100 --> 00:06:51,750
both of those processes can provide you

157
00:06:49,800 --> 00:06:53,250
with good information but then you kind

158
00:06:51,750 --> 00:06:55,200
of do analytics to make some detections

159
00:06:53,250 --> 00:06:58,889
and see how can i deploy this throughout

160
00:06:55,200 --> 00:07:01,979
my entire environment so really to me I

161
00:06:58,889 --> 00:07:04,110
feel like the hardest part of this isn't

162
00:07:01,979 --> 00:07:05,849
necessarily the investigate or the

163
00:07:04,110 --> 00:07:08,789
analytics we kind of do that every day

164
00:07:05,850 --> 00:07:11,160
in our in our job I think the hardest

165
00:07:08,789 --> 00:07:12,570
part was always creating that hypothesis

166
00:07:11,160 --> 00:07:15,169
trying to figure out what really is bad

167
00:07:12,570 --> 00:07:17,550
what indicates something's bad out there

168
00:07:15,169 --> 00:07:19,289
and it kind of goes back to that pyramid

169
00:07:17,550 --> 00:07:21,270
of pain where it's it's always easier to

170
00:07:19,289 --> 00:07:22,680
implement the IOC that we find then

171
00:07:21,270 --> 00:07:25,859
actually look for that behavior that's

172
00:07:22,680 --> 00:07:28,710
bad and then kind of uncovering the new

173
00:07:25,860 --> 00:07:30,479
new tactics and techniques and

174
00:07:28,710 --> 00:07:33,120
procedures as they come out I before

175
00:07:30,479 --> 00:07:34,950
attack used to have to go through and

176
00:07:33,120 --> 00:07:35,370
search through a whole bunch of tweets a

177
00:07:34,950 --> 00:07:38,010
whole bunch of

178
00:07:35,370 --> 00:07:39,810
blogposts white papers you have to scour

179
00:07:38,010 --> 00:07:46,949
the internet to try to figure out what's

180
00:07:39,810 --> 00:07:48,449
going on here so I'll start at the

181
00:07:46,949 --> 00:07:50,699
beginning of the program so like I said

182
00:07:48,449 --> 00:07:55,770
I've worked in I are at MasterCard for

183
00:07:50,699 --> 00:07:57,540
around 7 years different areas we you

184
00:07:55,770 --> 00:07:59,310
know we spend a fair a lot of fair

185
00:07:57,540 --> 00:08:02,010
amount of money on information security

186
00:07:59,310 --> 00:08:04,940
we have expensive perimeter defenses we

187
00:08:02,010 --> 00:08:07,229
got a whole bunch of agents going around

188
00:08:04,940 --> 00:08:10,020
you know all of that all of our logins

189
00:08:07,229 --> 00:08:13,080
centralized there's well-thought-out

190
00:08:10,020 --> 00:08:15,150
architecture and policy and I we worked

191
00:08:13,080 --> 00:08:17,039
real hard to keep up with patching and

192
00:08:15,150 --> 00:08:18,448
new vulnerabilities I thought we're in a

193
00:08:17,039 --> 00:08:20,780
pretty good spot you know going through

194
00:08:18,449 --> 00:08:23,669
we work hard we do all this good stuff

195
00:08:20,780 --> 00:08:28,229
and then I went to my first Def Con and

196
00:08:23,669 --> 00:08:31,080
I remember the very first talk I saw was

197
00:08:28,229 --> 00:08:32,760
by a guy named Mark Newland and it was

198
00:08:31,080 --> 00:08:35,669
it was an amazing talk he had found

199
00:08:32,760 --> 00:08:37,080
vulnerabilities inside common wireless

200
00:08:35,669 --> 00:08:39,929
mice and keyboards where he could

201
00:08:37,080 --> 00:08:43,440
perform replay attacks he could do this

202
00:08:39,929 --> 00:08:45,390
from 200 meters away and he could

203
00:08:43,440 --> 00:08:46,770
essentially do anything he wanted to

204
00:08:45,390 --> 00:08:49,830
your computer if you're using one of

205
00:08:46,770 --> 00:08:52,439
those meister keyboards so he did what

206
00:08:49,830 --> 00:08:55,110
any Def Con presenter would do he wrote

207
00:08:52,440 --> 00:08:57,450
he created a small Nintendo remote and

208
00:08:55,110 --> 00:09:00,510
he proceeded to mess with all the other

209
00:08:57,450 --> 00:09:02,750
presenters the next year he came even

210
00:09:00,510 --> 00:09:06,029
talked about it and showed everybody

211
00:09:02,750 --> 00:09:08,040
unfortunately even after he reported a

212
00:09:06,029 --> 00:09:10,830
lot of these vulnerabilities because of

213
00:09:08,040 --> 00:09:12,660
the nature of those those mice and

214
00:09:10,830 --> 00:09:14,400
keyboards they were on patchable so

215
00:09:12,660 --> 00:09:16,350
these are probably if you go watch that

216
00:09:14,400 --> 00:09:18,630
talk you could probably still do this to

217
00:09:16,350 --> 00:09:20,339
a lot of people today it was really

218
00:09:18,630 --> 00:09:22,380
interesting so I kind of thought about

219
00:09:20,339 --> 00:09:23,850
this and I'm going well I don't I don't

220
00:09:22,380 --> 00:09:25,140
have a good defense against this with

221
00:09:23,850 --> 00:09:25,650
all the money were spending everything

222
00:09:25,140 --> 00:09:28,949
we're doing

223
00:09:25,650 --> 00:09:30,360
I can't detect us I would hope one of

224
00:09:28,950 --> 00:09:33,060
our other layers would maybe the web

225
00:09:30,360 --> 00:09:35,790
proxy would block it or the antivirus

226
00:09:33,060 --> 00:09:38,040
might see it but if I have this much

227
00:09:35,790 --> 00:09:39,930
control I mean I could literally write

228
00:09:38,040 --> 00:09:43,170
the malware on your computer with the

229
00:09:39,930 --> 00:09:44,729
keystrokes with the script so it kind of

230
00:09:43,170 --> 00:09:47,400
blew me away and changed a lot of my

231
00:09:44,730 --> 00:09:48,870
worldview and then I saw about 20 more

232
00:09:47,400 --> 00:09:53,760
talks after that

233
00:09:48,870 --> 00:09:57,000
oh that that scared me just as much so I

234
00:09:53,760 --> 00:09:58,620
came back and I just thought we got to

235
00:09:57,000 --> 00:10:00,090
figure out how how can I do more how can

236
00:09:58,620 --> 00:10:06,950
how can we figure out how to be more

237
00:10:00,090 --> 00:10:09,090
secure so everybody's kind of heard the

238
00:10:06,950 --> 00:10:11,460
that old saying we're dressed for the

239
00:10:09,090 --> 00:10:14,820
job you want not for the job you have so

240
00:10:11,460 --> 00:10:16,290
I love this cartoon you see the boss

241
00:10:14,820 --> 00:10:17,750
he's putting up the sign dressed for the

242
00:10:16,290 --> 00:10:20,670
job you want not for the job you have

243
00:10:17,750 --> 00:10:23,130
and everybody comes in wearing superhero

244
00:10:20,670 --> 00:10:26,729
outfits and Darth Vader and Gandalf

245
00:10:23,130 --> 00:10:29,430
shows up so I'm not as big a fan as

246
00:10:26,730 --> 00:10:31,020
dressed for the job you want and and so

247
00:10:29,430 --> 00:10:33,510
the job we have but but I am a big fan

248
00:10:31,020 --> 00:10:36,300
of in my experience doing the job you

249
00:10:33,510 --> 00:10:37,950
want that will eventually turn into that

250
00:10:36,300 --> 00:10:40,170
becoming your job so I'll give you an

251
00:10:37,950 --> 00:10:42,150
example when I was in college I worked

252
00:10:40,170 --> 00:10:46,829
for a very small woodworking machinery

253
00:10:42,150 --> 00:10:49,290
dealership and I was actually a

254
00:10:46,830 --> 00:10:51,210
chemistry major in college and so all I

255
00:10:49,290 --> 00:10:52,170
was doing all day there was scanning in

256
00:10:51,210 --> 00:10:53,970
their literature they were in the

257
00:10:52,170 --> 00:10:55,199
process of making it so the salesmen

258
00:10:53,970 --> 00:10:58,170
didn't have to carry around a briefcase

259
00:10:55,200 --> 00:11:00,390
that was this big and so as I was doing

260
00:10:58,170 --> 00:11:02,189
that I started realizing a lot of these

261
00:11:00,390 --> 00:11:03,390
other people are having problems on

262
00:11:02,190 --> 00:11:04,920
their computers they're just little

263
00:11:03,390 --> 00:11:07,110
troubleshooting problems and I started

264
00:11:04,920 --> 00:11:08,610
troubleshooting those I started dealing

265
00:11:07,110 --> 00:11:13,470
with network problems and it eventually

266
00:11:08,610 --> 00:11:16,650
turned into I I learned asp.net and was

267
00:11:13,470 --> 00:11:18,210
doing their entire website and this kind

268
00:11:16,650 --> 00:11:19,740
of this turned into a job they

269
00:11:18,210 --> 00:11:21,540
essentially had didn't realize they

270
00:11:19,740 --> 00:11:24,120
needed at that time when when I left

271
00:11:21,540 --> 00:11:26,280
they had to replace me it's so it's kind

272
00:11:24,120 --> 00:11:27,990
of a it also changed the course of my

273
00:11:26,280 --> 00:11:29,640
career because I've stopped being a

274
00:11:27,990 --> 00:11:35,430
chemistry major and started looking into

275
00:11:29,640 --> 00:11:37,770
computers so this is what I did I came

276
00:11:35,430 --> 00:11:38,310
back from DEFCON and I thought we got to

277
00:11:37,770 --> 00:11:41,040
do more

278
00:11:38,310 --> 00:11:43,349
so I started meeting with teams and

279
00:11:41,040 --> 00:11:46,319
started brainstorming how can we do this

280
00:11:43,350 --> 00:11:48,600
how can we actually provide more

281
00:11:46,320 --> 00:11:52,020
security for our for our business and

282
00:11:48,600 --> 00:11:54,720
for our team so I noticed one of our big

283
00:11:52,020 --> 00:11:56,130
gaps is we we had a lot of agents on our

284
00:11:54,720 --> 00:11:58,170
hosts but but our logging wasn't that

285
00:11:56,130 --> 00:12:01,200
great there and we didn't have what we

286
00:11:58,170 --> 00:12:01,990
wanted so that was the first thing we

287
00:12:01,200 --> 00:12:04,959
did I

288
00:12:01,990 --> 00:12:09,399
created a deploy deploy whould data from

289
00:12:04,959 --> 00:12:12,040
hosts we were pullin mainly autorun data

290
00:12:09,399 --> 00:12:15,279
execution data this is before we had a

291
00:12:12,040 --> 00:12:16,779
lot of process monitoring which from the

292
00:12:15,279 --> 00:12:19,060
those guys have seen the data source and

293
00:12:16,779 --> 00:12:20,620
attack covers a lot so it's it's

294
00:12:19,060 --> 00:12:22,989
something really nice to have especially

295
00:12:20,620 --> 00:12:25,300
if it's centralized we're also pulling

296
00:12:22,990 --> 00:12:27,279
running processes and just looking for

297
00:12:25,300 --> 00:12:29,740
things that you know possible Windows

298
00:12:27,279 --> 00:12:31,270
Windows processes that weren't weren't

299
00:12:29,740 --> 00:12:33,970
spawned by the right thing you know as

300
00:12:31,270 --> 00:12:38,110
TV host or SVC host not spawned by

301
00:12:33,970 --> 00:12:39,940
services things like that so then we

302
00:12:38,110 --> 00:12:41,649
would take it we'd combine it all and

303
00:12:39,940 --> 00:12:46,089
had a few Python scripts that would kind

304
00:12:41,649 --> 00:12:49,990
of analyze it and this is it was real

305
00:12:46,089 --> 00:12:52,690
slow so we were doing it from one server

306
00:12:49,990 --> 00:12:56,740
we had we were droppin executables for

307
00:12:52,690 --> 00:13:00,160
tools it was it was real slow and it was

308
00:12:56,740 --> 00:13:03,430
real inefficient but at the same time

309
00:13:00,160 --> 00:13:06,520
we're still moderately successful I we

310
00:13:03,430 --> 00:13:07,540
found a ton of adware which I don't care

311
00:13:06,520 --> 00:13:10,240
about as much but I don't necessarily

312
00:13:07,540 --> 00:13:12,040
want that on the workstations but we

313
00:13:10,240 --> 00:13:14,140
also found to rats

314
00:13:12,040 --> 00:13:16,329
and that was that was pretty amazing

315
00:13:14,140 --> 00:13:17,829
that - - pretty bad infections would

316
00:13:16,329 --> 00:13:21,279
have sat there with without the program

317
00:13:17,829 --> 00:13:22,209
so I thought thought we're doing we're

318
00:13:21,279 --> 00:13:24,279
doing a pretty good job

319
00:13:22,209 --> 00:13:27,609
I like this we've been I felt like

320
00:13:24,279 --> 00:13:29,350
pretty successful so I met with of a few

321
00:13:27,610 --> 00:13:31,270
I met with a team member and we decided

322
00:13:29,350 --> 00:13:33,040
we should make a pitch to management C

323
00:13:31,270 --> 00:13:34,839
we should be doing this full-time if

324
00:13:33,040 --> 00:13:36,719
we're getting this much success but just

325
00:13:34,839 --> 00:13:39,130
something we're doing behind the scenes

326
00:13:36,720 --> 00:13:43,089
we should take it take it farther see

327
00:13:39,130 --> 00:13:46,110
what they say and so we set up a meeting

328
00:13:43,089 --> 00:13:49,209
with our vice-president we created a

329
00:13:46,110 --> 00:13:50,860
roadmap we created a mission statement

330
00:13:49,209 --> 00:13:53,709
all these things and kind of like a

331
00:13:50,860 --> 00:13:56,800
essentially a five-year plan sat down

332
00:13:53,709 --> 00:13:58,750
with them and and he really liked it and

333
00:13:56,800 --> 00:14:02,319
he said I'm gonna take this up to my

334
00:13:58,750 --> 00:14:04,060
management so I took it up and they also

335
00:14:02,320 --> 00:14:06,279
had good things to say but then they

336
00:14:04,060 --> 00:14:07,930
came back and said well we don't have a

337
00:14:06,279 --> 00:14:10,689
lot of budget there's a lot of people

338
00:14:07,930 --> 00:14:14,229
asking for extra headcount

339
00:14:10,690 --> 00:14:15,740
and you know that's that's kind of the

340
00:14:14,230 --> 00:14:17,360
way it goes they said

341
00:14:15,740 --> 00:14:19,520
so they said well we'll do this for you

342
00:14:17,360 --> 00:14:21,680
we won't we won't give you any extra

343
00:14:19,520 --> 00:14:24,860
resources but we'll give you some time

344
00:14:21,680 --> 00:14:26,660
so they said so I don't know like I

345
00:14:24,860 --> 00:14:29,570
mentioned earlier I'm I'm from Missouri

346
00:14:26,660 --> 00:14:33,740
does anyone know the Missouri state

347
00:14:29,570 --> 00:14:34,370
motto yeah show me state and that's what

348
00:14:33,740 --> 00:14:38,150
they said

349
00:14:34,370 --> 00:14:39,980
so they said show me that this is worth

350
00:14:38,150 --> 00:14:42,199
a full team's time or a full person's

351
00:14:39,980 --> 00:14:48,170
time I said we'll give you some time but

352
00:14:42,200 --> 00:14:50,380
I want to see more so that's that's what

353
00:14:48,170 --> 00:14:53,089
we did

354
00:14:50,380 --> 00:14:54,710
unfortunately it dawned on me that oh no

355
00:14:53,090 --> 00:14:55,100
now they know about this what do we do

356
00:14:54,710 --> 00:14:57,260
now

357
00:14:55,100 --> 00:15:00,100
because we actually have to perform and

358
00:14:57,260 --> 00:15:04,189
they're watching and expecting things so

359
00:15:00,100 --> 00:15:06,200
I came back and decided first of all

360
00:15:04,190 --> 00:15:07,970
that as everybody knows in this industry

361
00:15:06,200 --> 00:15:10,220
nothing nothing stays static for long

362
00:15:07,970 --> 00:15:11,090
doing these same things over and over is

363
00:15:10,220 --> 00:15:13,580
not going to help you

364
00:15:11,090 --> 00:15:15,230
so I decided we have to make a new

365
00:15:13,580 --> 00:15:17,480
program we have to start from scratch

366
00:15:15,230 --> 00:15:19,700
what we're doing now isn't isn't real

367
00:15:17,480 --> 00:15:26,990
efficient and it's not going to I'm not

368
00:15:19,700 --> 00:15:29,480
going to keep finding new things so and

369
00:15:26,990 --> 00:15:31,040
I have to do that with 20% of a person

370
00:15:29,480 --> 00:15:32,720
so they give it essentially gave me

371
00:15:31,040 --> 00:15:35,089
about a day a week they said spend on

372
00:15:32,720 --> 00:15:36,650
this of course my other job was still

373
00:15:35,090 --> 00:15:39,710
there so it wasn't even always a day a

374
00:15:36,650 --> 00:15:45,949
week so I had to do that with just the

375
00:15:39,710 --> 00:15:47,840
feet and ankles pretty much so the the

376
00:15:45,950 --> 00:15:49,640
first thing I thought the first thing I

377
00:15:47,840 --> 00:15:51,500
realized is that getting a thousand

378
00:15:49,640 --> 00:15:54,350
hosts a month is not sustainable we have

379
00:15:51,500 --> 00:15:55,760
to make this more efficient so we were

380
00:15:54,350 --> 00:15:58,280
we were in the process of actually

381
00:15:55,760 --> 00:16:00,980
rolling out some more PowerShell

382
00:15:58,280 --> 00:16:04,100
remoting for our admin team and that's

383
00:16:00,980 --> 00:16:08,330
that was the that was the Avenue I took

384
00:16:04,100 --> 00:16:10,700
to start looking at this so so we

385
00:16:08,330 --> 00:16:12,500
started I don't know how many people are

386
00:16:10,700 --> 00:16:15,550
familiar with konso it's a PowerShell

387
00:16:12,500 --> 00:16:18,140
Incident Response framework I'm

388
00:16:15,550 --> 00:16:21,740
currently using a very heavily modified

389
00:16:18,140 --> 00:16:23,510
version of Konza but Konza isn't

390
00:16:21,740 --> 00:16:25,340
necessarily an important part the

391
00:16:23,510 --> 00:16:27,260
important part is to you we that we use

392
00:16:25,340 --> 00:16:28,259
the advantages of PowerShell remoting so

393
00:16:27,260 --> 00:16:29,850
we could

394
00:16:28,259 --> 00:16:31,829
do parallel processing we could reach

395
00:16:29,850 --> 00:16:34,259
out to multiple hosts at once use their

396
00:16:31,829 --> 00:16:37,888
resources instead of ours but also

397
00:16:34,259 --> 00:16:41,160
because we were using PowerShell I went

398
00:16:37,889 --> 00:16:43,559
from deploying some executables or

399
00:16:41,160 --> 00:16:45,809
deploying other people's tools to now I

400
00:16:43,559 --> 00:16:47,809
have the freedom to write my own and I

401
00:16:45,809 --> 00:16:50,639
can pull just about anything I want

402
00:16:47,809 --> 00:16:52,259
which is great but it also goes back to

403
00:16:50,639 --> 00:16:54,479
that threateningly I start having to do

404
00:16:52,259 --> 00:16:55,949
research how do i how do I figure out

405
00:16:54,479 --> 00:16:57,239
what I want to pull there's all kinds of

406
00:16:55,949 --> 00:16:58,858
stuff and as soon as I pull too much

407
00:16:57,239 --> 00:17:01,169
data I'm gonna be in real trouble

408
00:16:58,859 --> 00:17:07,019
because there's only only one person

409
00:17:01,169 --> 00:17:12,388
looking through it all right now so

410
00:17:07,019 --> 00:17:13,888
that's when I found a tack and it was it

411
00:17:12,388 --> 00:17:16,158
was great to me because a lot of the

412
00:17:13,888 --> 00:17:19,708
other frameworks I've seen stopped it

413
00:17:16,159 --> 00:17:21,959
stopped at techniques adopted tactics

414
00:17:19,709 --> 00:17:23,220
and I needed techniques I needed I

415
00:17:21,959 --> 00:17:26,370
needed to figure out I need something

416
00:17:23,220 --> 00:17:28,830
deeper that was more specific we started

417
00:17:26,369 --> 00:17:31,260
using attack with this where because I

418
00:17:28,830 --> 00:17:33,870
had built out the framework there

419
00:17:31,260 --> 00:17:35,850
I could write three four lines of code

420
00:17:33,870 --> 00:17:37,529
and a PowerShell module and pull back

421
00:17:35,850 --> 00:17:40,139
information that I could that I could

422
00:17:37,529 --> 00:17:41,700
use on a on a technique and I didn't

423
00:17:40,139 --> 00:17:47,090
have to do it all at once I could do it

424
00:17:41,700 --> 00:17:49,860
piece by piece by piece I actually

425
00:17:47,090 --> 00:17:51,899
mainly focused on our gaps because I

426
00:17:49,860 --> 00:17:53,129
knew I had worked in IR there so long I

427
00:17:51,899 --> 00:17:54,989
knew where our gaps were and I knew

428
00:17:53,129 --> 00:17:57,360
counselor where we couldn't see and this

429
00:17:54,990 --> 00:18:00,179
was I knew also that we were we were

430
00:17:57,360 --> 00:18:01,769
fixing them but in a large organization

431
00:18:00,179 --> 00:18:03,059
there's a lot of change control there's

432
00:18:01,769 --> 00:18:05,129
a lot of process built around

433
00:18:03,059 --> 00:18:06,539
infrastructure and it takes time so a

434
00:18:05,129 --> 00:18:08,820
lot of times you know about those gaps

435
00:18:06,539 --> 00:18:11,610
for four months before you can get a fix

436
00:18:08,820 --> 00:18:13,408
on and this way we could take this right

437
00:18:11,610 --> 00:18:15,959
a few write a few lines in a PowerShell

438
00:18:13,409 --> 00:18:18,120
script and cover that attack pretty much

439
00:18:15,960 --> 00:18:20,210
Enterprise recover that yeah that

440
00:18:18,120 --> 00:18:23,639
technique pretty much enterprise-wide

441
00:18:20,210 --> 00:18:24,899
the greatest thing here is since since

442
00:18:23,639 --> 00:18:27,059
this is there and it was easy now I

443
00:18:24,899 --> 00:18:29,189
could do this at scale I could I could

444
00:18:27,059 --> 00:18:31,350
push it all out to to everyone and all

445
00:18:29,190 --> 00:18:34,019
of a sudden were recovered as opposed to

446
00:18:31,350 --> 00:18:35,789
deploying hardware to point and even

447
00:18:34,019 --> 00:18:36,779
even an agent could be could be rough

448
00:18:35,789 --> 00:18:38,010
because you have to go through the

449
00:18:36,779 --> 00:18:39,960
testing we have to go through everything

450
00:18:38,010 --> 00:18:41,910
else and this was this was great because

451
00:18:39,960 --> 00:18:44,490
I'm minimally invasive here I just

452
00:18:41,910 --> 00:18:47,790
all the data I get out and then I'll see

453
00:18:44,490 --> 00:18:49,650
you at the next time we come lo reefs

454
00:18:47,790 --> 00:18:51,780
resource cost which is really the most

455
00:18:49,650 --> 00:18:53,790
important thing for me because I still

456
00:18:51,780 --> 00:18:56,280
had to do my other job and we had to

457
00:18:53,790 --> 00:18:58,350
somehow accomplish this and attack pull

458
00:18:56,280 --> 00:19:01,320
attack was the reason we were able to do

459
00:18:58,350 --> 00:19:03,149
this because of all of the I essentially

460
00:19:01,320 --> 00:19:04,860
shifted the resource costs from us to

461
00:19:03,150 --> 00:19:06,630
all the rest of the community and

462
00:19:04,860 --> 00:19:08,490
everyone creating these here so it was

463
00:19:06,630 --> 00:19:12,540
it was a great as far as I was concerned

464
00:19:08,490 --> 00:19:15,120
it's a great switch the other great

465
00:19:12,540 --> 00:19:16,620
thing is that it covers major Oasis so

466
00:19:15,120 --> 00:19:18,810
so far I've been talking about Windows

467
00:19:16,620 --> 00:19:20,550
but that wasn't our goal we want to I

468
00:19:18,810 --> 00:19:22,590
wanted to expand this out to our whole

469
00:19:20,550 --> 00:19:24,950
environment which means we need Macs and

470
00:19:22,590 --> 00:19:27,330
we need Linux in there and I'll tell you

471
00:19:24,950 --> 00:19:30,860
I'm fine dealing with Linux I'm not a

472
00:19:27,330 --> 00:19:33,449
Big Mac guy so having these having these

473
00:19:30,860 --> 00:19:34,830
actual techniques out there where I can

474
00:19:33,450 --> 00:19:36,840
read them and understand them and

475
00:19:34,830 --> 00:19:45,649
compare them to other techniques that I

476
00:19:36,840 --> 00:19:51,270
might be more familiar with was great so

477
00:19:45,650 --> 00:19:54,180
this was phase 2 after attack let's see

478
00:19:51,270 --> 00:19:56,700
so there's some things that we kept

479
00:19:54,180 --> 00:20:00,330
going strong I still run monthly stints

480
00:19:56,700 --> 00:20:02,670
but instead of going to 1,000 hosts I'm

481
00:20:00,330 --> 00:20:05,490
now collecting data from 30,000 hopes

482
00:20:02,670 --> 00:20:07,530
both windows and Macs and we have our

483
00:20:05,490 --> 00:20:11,340
Linux side kind of in production right

484
00:20:07,530 --> 00:20:12,750
now and that really is is my goal for

485
00:20:11,340 --> 00:20:14,760
this whole thing is to be able to hit

486
00:20:12,750 --> 00:20:18,680
the entire environment and then we can

487
00:20:14,760 --> 00:20:20,820
slowly continue I add more and more

488
00:20:18,680 --> 00:20:23,490
techniques in there so I'll tell you

489
00:20:20,820 --> 00:20:25,530
right right now I think we're at 31

490
00:20:23,490 --> 00:20:27,660
techniques but I've proved this out

491
00:20:25,530 --> 00:20:29,670
enough or I actually got some help so we

492
00:20:27,660 --> 00:20:31,290
have more people helping me and we're

493
00:20:29,670 --> 00:20:33,930
expanding those all the time and like I

494
00:20:31,290 --> 00:20:35,730
said we we there have been a lot of talk

495
00:20:33,930 --> 00:20:39,600
of threat Intel and adversaries here

496
00:20:35,730 --> 00:20:41,400
threat actors we I'm gonna take that

497
00:20:39,600 --> 00:20:43,860
back and probably do some more research

498
00:20:41,400 --> 00:20:46,050
there to the point where maybe we start

499
00:20:43,860 --> 00:20:47,909
looking at specific adversaries that are

500
00:20:46,050 --> 00:20:49,500
targeting us but right now I've been

501
00:20:47,910 --> 00:20:51,750
trying to fill our gaps gaps that we

502
00:20:49,500 --> 00:20:54,030
know about that maybe we're gonna have a

503
00:20:51,750 --> 00:20:55,860
solution in place but we're months away

504
00:20:54,030 --> 00:20:57,750
this way I can fill that and we can

505
00:20:55,860 --> 00:21:00,090
back up and say hey where we get some

506
00:20:57,750 --> 00:21:01,620
mitigation here until we can buy some

507
00:21:00,090 --> 00:21:03,270
time until we get something permanent in

508
00:21:01,620 --> 00:21:04,739
there that maybe maybe a little better

509
00:21:03,270 --> 00:21:08,580
maybe hidden it more than once a month

510
00:21:04,740 --> 00:21:10,980
there what's also nice about this is

511
00:21:08,580 --> 00:21:14,460
that I'm Bonin from one server right now

512
00:21:10,980 --> 00:21:16,080
our plan is to get this closer and

513
00:21:14,460 --> 00:21:22,920
closer to hitting the entire environment

514
00:21:16,080 --> 00:21:24,240
in a week or so so the other nice stat

515
00:21:22,920 --> 00:21:27,120
is that we've actually been responsible

516
00:21:24,240 --> 00:21:28,590
for finding 15% of our malware incidents

517
00:21:27,120 --> 00:21:32,250
this year and it's no longer the

518
00:21:28,590 --> 00:21:34,350
low-risk adware click-fraud we've been

519
00:21:32,250 --> 00:21:36,270
finding real real things that are

520
00:21:34,350 --> 00:21:38,370
concerning which is even a little more

521
00:21:36,270 --> 00:21:39,780
frustrating to me because then they come

522
00:21:38,370 --> 00:21:42,239
back to my team where I have to do more

523
00:21:39,780 --> 00:21:47,100
investigation and I have less time to

524
00:21:42,240 --> 00:21:49,070
work on this stuff oh the other the

525
00:21:47,100 --> 00:21:53,389
other great thing about this is that

526
00:21:49,070 --> 00:21:56,040
this is this is help there socket on so

527
00:21:53,390 --> 00:21:57,510
iíve been as I made these tools I've

528
00:21:56,040 --> 00:21:59,940
been providing them to our sock and

529
00:21:57,510 --> 00:22:02,250
what's great about this is that not only

530
00:21:59,940 --> 00:22:04,049
can they go from may be manually looking

531
00:22:02,250 --> 00:22:05,820
at a looking at a workstation or a

532
00:22:04,049 --> 00:22:07,799
server after an alert they can pull back

533
00:22:05,820 --> 00:22:10,350
this information automatically but it

534
00:22:07,799 --> 00:22:12,450
also gets our analysts that maybe don't

535
00:22:10,350 --> 00:22:13,889
have a more experienced they'd have a

536
00:22:12,450 --> 00:22:16,710
little less experience they start asking

537
00:22:13,890 --> 00:22:19,520
why are you looking at this why is this

538
00:22:16,710 --> 00:22:22,380
part important here and so we've

539
00:22:19,520 --> 00:22:24,299
increased the we have essentially cut

540
00:22:22,380 --> 00:22:26,040
down the time it takes to train our sock

541
00:22:24,299 --> 00:22:28,290
analysts because they can use the tools

542
00:22:26,040 --> 00:22:29,760
we create here and it points out areas

543
00:22:28,290 --> 00:22:32,100
that they should be looking at in their

544
00:22:29,760 --> 00:22:33,840
investigation and so it's it's been

545
00:22:32,100 --> 00:22:35,399
great for them they've all they all love

546
00:22:33,840 --> 00:22:42,959
that they have these tools now where

547
00:22:35,400 --> 00:22:46,440
they can do this quickly so I wish that

548
00:22:42,960 --> 00:22:48,600
I could come out and say that I now have

549
00:22:46,440 --> 00:22:50,730
run a team with our thread hunting

550
00:22:48,600 --> 00:22:53,100
program but we're not there yet one day

551
00:22:50,730 --> 00:22:56,250
we may be I'm still I'm still proving

552
00:22:53,100 --> 00:22:58,889
this out we we were a little late to the

553
00:22:56,250 --> 00:23:00,929
game we started using attack I started

554
00:22:58,890 --> 00:23:04,260
the face to probably around January of

555
00:23:00,929 --> 00:23:06,090
this year so we've had some time to get

556
00:23:04,260 --> 00:23:07,470
stats but we're still we're still

557
00:23:06,090 --> 00:23:09,189
working at this still trying to get it

558
00:23:07,470 --> 00:23:13,370
going

559
00:23:09,190 --> 00:23:15,440
but I can also say that I wouldn't been

560
00:23:13,370 --> 00:23:17,389
able to do this with the time that I had

561
00:23:15,440 --> 00:23:19,490
and I wouldn't been successful its

562
00:23:17,390 --> 00:23:21,590
without attack without the information

563
00:23:19,490 --> 00:23:23,480
provided there that saved me so much

564
00:23:21,590 --> 00:23:25,879
time researching and so much time

565
00:23:23,480 --> 00:23:30,410
looking and improving out what was going

566
00:23:25,880 --> 00:23:33,110
on so and in the last thing I just

567
00:23:30,410 --> 00:23:34,940
wanted to hit on again is that with us

568
00:23:33,110 --> 00:23:37,520
using this we can we can implement it

569
00:23:34,940 --> 00:23:39,140
slowly we can we can pick pieces pick

570
00:23:37,520 --> 00:23:42,580
and choose what we are most worried

571
00:23:39,140 --> 00:23:42,580
about and kind of go through there

