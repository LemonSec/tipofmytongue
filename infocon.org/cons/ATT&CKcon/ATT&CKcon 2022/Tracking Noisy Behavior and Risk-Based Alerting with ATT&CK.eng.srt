1
00:00:11,759 --> 00:00:14,080
so our last talk before lunch will be

2
00:00:14,080 --> 00:00:16,560
hayley mills from splunk our first of

3
00:00:16,560 --> 00:00:19,279
two splunk talks today

4
00:00:19,279 --> 00:00:20,960
many organizations have had the

5
00:00:20,960 --> 00:00:23,439
experience of drowning in alerts but we

6
00:00:23,439 --> 00:00:25,439
need to figure out what's important to

7
00:00:25,439 --> 00:00:26,400
us

8
00:00:26,400 --> 00:00:28,880
and be you know what's likely to be a

9
00:00:28,880 --> 00:00:31,039
real risk to our enterprise

10
00:00:31,039 --> 00:00:32,640
next talk is going to share with us

11
00:00:32,640 --> 00:00:34,800
concept of risk-based alerting and

12
00:00:34,800 --> 00:00:37,040
helping us be alerted on what's

13
00:00:37,040 --> 00:00:38,399
important

14
00:00:38,399 --> 00:00:41,420
get a round of applause haley mills

15
00:00:41,420 --> 00:00:46,630
[Applause]

16
00:00:52,559 --> 00:00:55,840
all right but also

17
00:00:55,840 --> 00:00:59,840
it's not going to the next slide

18
00:01:02,399 --> 00:01:03,840
that's the laser

19
00:01:03,840 --> 00:01:07,439
oh god the green button okay

20
00:01:07,439 --> 00:01:09,280
uh there's two green buttons and one's a

21
00:01:09,280 --> 00:01:11,680
laser uh so we're just going to talk

22
00:01:11,680 --> 00:01:12,960
about what i'm talking about with

23
00:01:12,960 --> 00:01:14,240
respect to learning so we're all sort of

24
00:01:14,240 --> 00:01:16,640
on the same page as to what that is

25
00:01:16,640 --> 00:01:18,159
and then we'll talk about how you can do

26
00:01:18,159 --> 00:01:19,920
that so you can implement it in whatever

27
00:01:19,920 --> 00:01:21,360
tool you have

28
00:01:21,360 --> 00:01:23,759
and then when you have that implemented

29
00:01:23,759 --> 00:01:27,119
what can you do with that so uh the

30
00:01:27,119 --> 00:01:31,520
problem is that we often have uh a great

31
00:01:31,520 --> 00:01:33,759
mitre technique data source like command

32
00:01:33,759 --> 00:01:37,600
line but really really difficult to

33
00:01:37,600 --> 00:01:39,680
craft alerts

34
00:01:39,680 --> 00:01:41,200
and the reason is we don't want to get

35
00:01:41,200 --> 00:01:43,439
murdered by the sock they already have

36
00:01:43,439 --> 00:01:45,360
enough alerts to deal with and we don't

37
00:01:45,360 --> 00:01:47,600
want to add to that so

38
00:01:47,600 --> 00:01:49,280
risk-based alerting is a great way to

39
00:01:49,280 --> 00:01:51,840
deal with that

40
00:01:52,240 --> 00:01:54,560
story time about myself i was a sock

41
00:01:54,560 --> 00:01:57,920
analyst for a while and i was drowning

42
00:01:57,920 --> 00:02:00,320
in alerts like we all tend to be

43
00:02:00,320 --> 00:02:04,880
and in 2018 at splunks.com i watched a

44
00:02:04,880 --> 00:02:06,799
talk by jim apgar of splunk and stuart

45
00:02:06,799 --> 00:02:09,679
mcintosh of outposts security

46
00:02:09,679 --> 00:02:11,120
talking about risk-based alerting and i

47
00:02:11,120 --> 00:02:13,200
was like white-knuckling my seat because

48
00:02:13,200 --> 00:02:15,280
i could see the potential and like when

49
00:02:15,280 --> 00:02:17,120
i got back i just wanted it implemented

50
00:02:17,120 --> 00:02:18,480
right away

51
00:02:18,480 --> 00:02:21,920
so um when i got back i tried to do that

52
00:02:21,920 --> 00:02:23,840
but it took a while of convincing to

53
00:02:23,840 --> 00:02:25,760
make sure that we could make it happen

54
00:02:25,760 --> 00:02:28,160
but what we were able to do

55
00:02:28,160 --> 00:02:29,680
is uh

56
00:02:29,680 --> 00:02:32,720
reduce alert volume by 90 percent which

57
00:02:32,720 --> 00:02:35,519
sounds wild but i believe it's i've seen

58
00:02:35,519 --> 00:02:37,040
those numbers over and over when someone

59
00:02:37,040 --> 00:02:39,360
implements risk-based alerting and also

60
00:02:39,360 --> 00:02:41,120
increase alert fidelity from one percent

61
00:02:41,120 --> 00:02:43,360
to nearly 10 and not just that we're

62
00:02:43,360 --> 00:02:45,519
like pigeonholing on the like we reduced

63
00:02:45,519 --> 00:02:47,840
90 of alerts and that's what's left but

64
00:02:47,840 --> 00:02:49,200
more that

65
00:02:49,200 --> 00:02:50,319
i think the issue with a lot of

66
00:02:50,319 --> 00:02:52,400
detection is like we have these alerts

67
00:02:52,400 --> 00:02:53,840
that just keep making more and more

68
00:02:53,840 --> 00:02:55,680
alerts so we kind of have blinders on

69
00:02:55,680 --> 00:02:57,680
the detections that we're looking at and

70
00:02:57,680 --> 00:02:59,920
instead we want to look at all of the

71
00:02:59,920 --> 00:03:02,000
noise and just sort of like observe

72
00:03:02,000 --> 00:03:03,680
those things happening and then alert

73
00:03:03,680 --> 00:03:05,440
when we see a bunch of interesting

74
00:03:05,440 --> 00:03:07,519
observations together

75
00:03:07,519 --> 00:03:08,640
and

76
00:03:08,640 --> 00:03:10,480
we were able to cover huge swaths of the

77
00:03:10,480 --> 00:03:12,959
attack framework and actually we

78
00:03:12,959 --> 00:03:16,560
we wanted to build uh rba in 2019 after

79
00:03:16,560 --> 00:03:19,519
i got back from the conference in 2018

80
00:03:19,519 --> 00:03:21,040
and i told everyone about it everyone

81
00:03:21,040 --> 00:03:23,360
was mostly on board but the voices from

82
00:03:23,360 --> 00:03:26,000
on high just wanted 100 of the mitre

83
00:03:26,000 --> 00:03:27,920
attack framework covered

84
00:03:27,920 --> 00:03:30,480
which is not how you're supposed to

85
00:03:30,480 --> 00:03:32,959
utilize that but uh that's uh what we

86
00:03:32,959 --> 00:03:35,840
did so our little rebellion was to

87
00:03:35,840 --> 00:03:38,000
uh just post in a lot of jiras like

88
00:03:38,000 --> 00:03:39,519
we'll build this next year with rba

89
00:03:39,519 --> 00:03:41,680
we'll build this next year with rpa and

90
00:03:41,680 --> 00:03:43,120
so that's what we did and the next year

91
00:03:43,120 --> 00:03:44,720
we were able to dedicate some

92
00:03:44,720 --> 00:03:46,000
engineering time to sort of like

93
00:03:46,000 --> 00:03:48,799
reorganize how we were alerting

94
00:03:48,799 --> 00:03:50,480
and then we also got incredible value

95
00:03:50,480 --> 00:03:52,640
from purple teams because

96
00:03:52,640 --> 00:03:55,599
uh we actually caught uh red team during

97
00:03:55,599 --> 00:03:57,439
the development of rba when we only had

98
00:03:57,439 --> 00:03:59,519
like 15 or 20 rules in place but because

99
00:03:59,519 --> 00:04:01,680
we were detecting on the type of like

100
00:04:01,680 --> 00:04:04,000
subtle low band low bass stuff that they

101
00:04:04,000 --> 00:04:05,360
were doing we were actually able to

102
00:04:05,360 --> 00:04:06,720
catch them then

103
00:04:06,720 --> 00:04:08,159
and then i took a screenshot of their

104
00:04:08,159 --> 00:04:09,599
activity sent it to them be like hey

105
00:04:09,599 --> 00:04:11,120
what are you up to bud

106
00:04:11,120 --> 00:04:13,439
and uh got that conversation going and

107
00:04:13,439 --> 00:04:14,959
then we were able to sort of have these

108
00:04:14,959 --> 00:04:17,680
back and forth of like having them test

109
00:04:17,680 --> 00:04:19,918
see what risk they generate and then

110
00:04:19,918 --> 00:04:22,320
rebuilding a bunch of content and then

111
00:04:22,320 --> 00:04:24,000
detecting again and the amount of risk

112
00:04:24,000 --> 00:04:25,600
they created was so much more that we

113
00:04:25,600 --> 00:04:27,360
would detect them so much earlier in the

114
00:04:27,360 --> 00:04:28,960
attack life cycle

115
00:04:28,960 --> 00:04:30,560
and then lastly one thing i really like

116
00:04:30,560 --> 00:04:32,240
about this is like the view into

117
00:04:32,240 --> 00:04:34,320
behavior that you're getting by tracking

118
00:04:34,320 --> 00:04:36,160
the objects and what your objects are

119
00:04:36,160 --> 00:04:37,199
doing

120
00:04:37,199 --> 00:04:40,320
so you can use that for like large

121
00:04:40,320 --> 00:04:42,880
swaths of like adjusting rules but you

122
00:04:42,880 --> 00:04:45,040
can also view it as like a lens to see

123
00:04:45,040 --> 00:04:46,720
trends or anomalies

124
00:04:46,720 --> 00:04:48,800
and also potentially as like a type of

125
00:04:48,800 --> 00:04:50,800
threat hunting cue because you're you're

126
00:04:50,800 --> 00:04:52,320
looking at noisy things so over

127
00:04:52,320 --> 00:04:53,759
different time frames you can see

128
00:04:53,759 --> 00:04:55,840
patterns that arise with those different

129
00:04:55,840 --> 00:04:57,360
lenses

130
00:04:57,360 --> 00:05:00,000
so the detection methodology for far too

131
00:05:00,000 --> 00:05:02,000
long has been you've got a log source

132
00:05:02,000 --> 00:05:03,919
you build some detection logic and then

133
00:05:03,919 --> 00:05:06,240
you pop out an alert on the other side

134
00:05:06,240 --> 00:05:07,440
and

135
00:05:07,440 --> 00:05:09,120
the problem with that is is that as you

136
00:05:09,120 --> 00:05:10,400
increase visibility you're just

137
00:05:10,400 --> 00:05:12,240
increasing volume and like if you were

138
00:05:12,240 --> 00:05:13,919
going for a hundred percent of the miter

139
00:05:13,919 --> 00:05:16,320
attack framework with this methodology

140
00:05:16,320 --> 00:05:18,080
you would end up with a hundred analysts

141
00:05:18,080 --> 00:05:19,600
to work the amount of alerts you're

142
00:05:19,600 --> 00:05:21,680
generating from that type of thing

143
00:05:21,680 --> 00:05:22,560
so

144
00:05:22,560 --> 00:05:24,720
what we're switching to is relatively

145
00:05:24,720 --> 00:05:27,360
simple it's not like a wild idea but

146
00:05:27,360 --> 00:05:29,199
you're just taking that log source and

147
00:05:29,199 --> 00:05:30,639
then i like to think of it as

148
00:05:30,639 --> 00:05:33,120
observation logic i just want to see

149
00:05:33,120 --> 00:05:34,880
something that's interesting something i

150
00:05:34,880 --> 00:05:36,639
might want to know about

151
00:05:36,639 --> 00:05:39,039
so that could be like registry keys

152
00:05:39,039 --> 00:05:41,680
created in startup locations it could be

153
00:05:41,680 --> 00:05:45,520
common recon commands 80 fines uh

154
00:05:45,520 --> 00:05:46,240
and

155
00:05:46,240 --> 00:05:48,560
low bins are great because they have

156
00:05:48,560 --> 00:05:50,320
like they happen in a normal environment

157
00:05:50,320 --> 00:05:51,600
so often

158
00:05:51,600 --> 00:05:53,600
that but now i just want to know every

159
00:05:53,600 --> 00:05:55,919
time it happens not alert just know that

160
00:05:55,919 --> 00:05:58,080
it happened and we throw that into what

161
00:05:58,080 --> 00:05:59,680
we call a risk index but it's just an

162
00:05:59,680 --> 00:06:01,280
abstraction layer where everything's

163
00:06:01,280 --> 00:06:03,680
sharing the same field language

164
00:06:03,680 --> 00:06:06,319
so on top of that when that event occurs

165
00:06:06,319 --> 00:06:08,400
and we observe it we might want to throw

166
00:06:08,400 --> 00:06:10,880
on some security metadata so

167
00:06:10,880 --> 00:06:13,039
you'd use a risk score you can also use

168
00:06:13,039 --> 00:06:15,680
the miter attack tactic and technique

169
00:06:15,680 --> 00:06:17,039
and then just the log source that it's

170
00:06:17,039 --> 00:06:18,960
coming from so you can see like things

171
00:06:18,960 --> 00:06:21,280
coming from multiple log sources

172
00:06:21,280 --> 00:06:23,520
and then on top of that we can also

173
00:06:23,520 --> 00:06:26,080
tweak the risk score by

174
00:06:26,080 --> 00:06:29,039
attributes about the risk object so

175
00:06:29,039 --> 00:06:31,360
for example asset priority if it has any

176
00:06:31,360 --> 00:06:33,680
crit volts on the machine or if that

177
00:06:33,680 --> 00:06:36,080
user is an outlier doing that type of

178
00:06:36,080 --> 00:06:38,080
activity in your environment

179
00:06:38,080 --> 00:06:40,479
and then we are grouping that into like

180
00:06:40,479 --> 00:06:42,319
a bucket so now

181
00:06:42,319 --> 00:06:44,800
i like to think of like each object like

182
00:06:44,800 --> 00:06:46,400
a user or system in your environment

183
00:06:46,400 --> 00:06:48,000
like having a bucket that you're just

184
00:06:48,000 --> 00:06:50,800
storing observations in over and over

185
00:06:50,800 --> 00:06:53,280
and then we're grouping that together

186
00:06:53,280 --> 00:06:54,720
and alerting on the interesting

187
00:06:54,720 --> 00:06:57,599
observations that are in that bucket

188
00:06:57,599 --> 00:07:00,960
so um i've got some sample events here

189
00:07:00,960 --> 00:07:03,280
most of these things i couldn't alert on

190
00:07:03,280 --> 00:07:05,680
in my enterprise when i built this out

191
00:07:05,680 --> 00:07:07,360
but you can see

192
00:07:07,360 --> 00:07:09,599
i've got the the miter tactic and

193
00:07:09,599 --> 00:07:12,080
technique i've got an assigned score

194
00:07:12,080 --> 00:07:15,199
and uh the source type and so if we were

195
00:07:15,199 --> 00:07:17,440
to group this in our little abstraction

196
00:07:17,440 --> 00:07:19,039
layer and throwing it into our risk

197
00:07:19,039 --> 00:07:21,280
index by object then it's like each

198
00:07:21,280 --> 00:07:22,800
object is looking at all of your

199
00:07:22,800 --> 00:07:24,400
detections no matter what they are and

200
00:07:24,400 --> 00:07:25,680
then just alerting when there's enough

201
00:07:25,680 --> 00:07:27,199
interesting things there

202
00:07:27,199 --> 00:07:29,520
so for example we could use the score

203
00:07:29,520 --> 00:07:31,039
that's classic

204
00:07:31,039 --> 00:07:33,360
um so over 24 hours we could see that

205
00:07:33,360 --> 00:07:35,520
these events together generated a score

206
00:07:35,520 --> 00:07:37,759
over 100 throw an alert to the sock to

207
00:07:37,759 --> 00:07:39,680
investigate and now they've got like a

208
00:07:39,680 --> 00:07:41,280
list of activities so it's kind of

209
00:07:41,280 --> 00:07:43,840
telling a security story i love the last

210
00:07:43,840 --> 00:07:46,080
talk and now i want to do a whole new

211
00:07:46,080 --> 00:07:48,400
talk on storytelling with this type of

212
00:07:48,400 --> 00:07:49,599
alerting

213
00:07:49,599 --> 00:07:53,520
but you could also do for example

214
00:07:53,520 --> 00:07:55,520
events from multiple source types over

215
00:07:55,520 --> 00:07:57,919
three days or i mean really any time

216
00:07:57,919 --> 00:07:58,800
frame

217
00:07:58,800 --> 00:07:59,599
but

218
00:07:59,599 --> 00:08:01,280
this was actually our highest performing

219
00:08:01,280 --> 00:08:03,280
alert that when we went from like 800 to

220
00:08:03,280 --> 00:08:07,039
1400 alerts per week to 80 to 120

221
00:08:07,039 --> 00:08:08,080
we

222
00:08:08,080 --> 00:08:10,319
we would get maybe zero to 10 of these

223
00:08:10,319 --> 00:08:11,759
per week but they were very high

224
00:08:11,759 --> 00:08:13,680
fidelity because it's very uncommon for

225
00:08:13,680 --> 00:08:16,000
like someone from hr to pop something

226
00:08:16,000 --> 00:08:18,879
from netflow ids web and edr or

227
00:08:18,879 --> 00:08:20,639
something along those lines

228
00:08:20,639 --> 00:08:22,960
so we really love that alert

229
00:08:22,960 --> 00:08:24,560
and then we could also look at multiple

230
00:08:24,560 --> 00:08:26,960
miter tactics observed over seven days

231
00:08:26,960 --> 00:08:28,800
so you could see these same events

232
00:08:28,800 --> 00:08:31,280
would potentially be caught in a like a

233
00:08:31,280 --> 00:08:34,399
more spread out time frame

234
00:08:34,399 --> 00:08:37,120
so the requirements as far as i know i'm

235
00:08:37,120 --> 00:08:39,039
sure there are other creative ways of

236
00:08:39,039 --> 00:08:40,399
solving this

237
00:08:40,399 --> 00:08:41,760
this problem

238
00:08:41,760 --> 00:08:43,839
but

239
00:08:43,839 --> 00:08:46,000
you want to be able to tie events from

240
00:08:46,000 --> 00:08:47,920
all sources into an abstraction layer

241
00:08:47,920 --> 00:08:50,000
that has shared field language and i'll

242
00:08:50,000 --> 00:08:52,000
go over a risk generating rule and see

243
00:08:52,000 --> 00:08:54,160
how those how we utilize those those

244
00:08:54,160 --> 00:08:55,360
shared fields

245
00:08:55,360 --> 00:08:57,760
in splunk's spl that is the collect

246
00:08:57,760 --> 00:08:59,760
command that like brings things into a

247
00:08:59,760 --> 00:09:02,080
new index that you can search and in

248
00:09:02,080 --> 00:09:03,440
enterprise security that's the risk

249
00:09:03,440 --> 00:09:05,519
analysis action attached to correlation

250
00:09:05,519 --> 00:09:06,720
searches

251
00:09:06,720 --> 00:09:08,800
and then you need to be able to define a

252
00:09:08,800 --> 00:09:11,440
risk score and add security metadata to

253
00:09:11,440 --> 00:09:12,880
these observations when you're throwing

254
00:09:12,880 --> 00:09:14,800
it into that new source type

255
00:09:14,800 --> 00:09:16,560
and with spl that would be the eval

256
00:09:16,560 --> 00:09:18,160
command or you could utilize risk

257
00:09:18,160 --> 00:09:20,720
factors in enterprise security

258
00:09:20,720 --> 00:09:22,240
and lastly you need to be able to tweak

259
00:09:22,240 --> 00:09:24,160
those scores up and down based on the

260
00:09:24,160 --> 00:09:26,000
attributes of that risk object that

261
00:09:26,000 --> 00:09:28,160
you're assigning the observation to

262
00:09:28,160 --> 00:09:30,160
so in spl that's the lookup command and

263
00:09:30,160 --> 00:09:31,839
in yes that would be the identity and

264
00:09:31,839 --> 00:09:33,839
asset lookup as well as a combination of

265
00:09:33,839 --> 00:09:35,760
risk factors

266
00:09:35,760 --> 00:09:36,560
so

267
00:09:36,560 --> 00:09:38,959
uh let's build our risk rule starting

268
00:09:38,959 --> 00:09:40,640
with the skeleton so we're just going to

269
00:09:40,640 --> 00:09:43,440
look at our circada data to start in our

270
00:09:43,440 --> 00:09:46,080
ids index and we're just statsing

271
00:09:46,080 --> 00:09:49,040
basically a table of uh the source ip

272
00:09:49,040 --> 00:09:51,120
destip and signature along with the

273
00:09:51,120 --> 00:09:54,160
category of the alert that came through

274
00:09:54,160 --> 00:09:56,399
um and the signature of the alert

275
00:09:56,399 --> 00:09:58,560
and then we're just gonna

276
00:09:58,560 --> 00:10:01,120
based on the category we're going to

277
00:10:01,120 --> 00:10:02,240
assign

278
00:10:02,240 --> 00:10:04,800
uh a risk score so

279
00:10:04,800 --> 00:10:06,959
the way we were basically assigning risk

280
00:10:06,959 --> 00:10:08,880
scores was like a combination of impact

281
00:10:08,880 --> 00:10:11,920
and fidelity or confidence so if if

282
00:10:11,920 --> 00:10:13,519
something would be really really bad to

283
00:10:13,519 --> 00:10:15,600
see we might pop up the impact but the

284
00:10:15,600 --> 00:10:17,360
fidel like the fidelity is low we don't

285
00:10:17,360 --> 00:10:19,120
see it very often so we might lower it a

286
00:10:19,120 --> 00:10:20,240
little bit

287
00:10:20,240 --> 00:10:22,320
but uh

288
00:10:22,320 --> 00:10:24,880
this was able to give like huge swaths

289
00:10:24,880 --> 00:10:26,959
of these ids signatures we had you know

290
00:10:26,959 --> 00:10:28,880
35 000 signatures

291
00:10:28,880 --> 00:10:30,480
and they weren't contributing this like

292
00:10:30,480 --> 00:10:32,800
context to work with our other alerts it

293
00:10:32,800 --> 00:10:34,959
was just really really noisy and the

294
00:10:34,959 --> 00:10:36,480
only things we really had enabled were

295
00:10:36,480 --> 00:10:38,480
things we had seen by red team in the

296
00:10:38,480 --> 00:10:40,320
past and just sort of whitelisted our

297
00:10:40,320 --> 00:10:41,279
normal

298
00:10:41,279 --> 00:10:44,000
uh business activity but i also left a

299
00:10:44,000 --> 00:10:46,000
little space there because another thing

300
00:10:46,000 --> 00:10:47,680
i like to do

301
00:10:47,680 --> 00:10:50,320
is to add informational risk

302
00:10:50,320 --> 00:10:52,480
observations so in this case if the

303
00:10:52,480 --> 00:10:55,760
signature started with et info or et pro

304
00:10:55,760 --> 00:10:56,800
info

305
00:10:56,800 --> 00:10:59,120
i would just make this category info

306
00:10:59,120 --> 00:11:02,560
field so that i could assign a zero risk

307
00:11:02,560 --> 00:11:04,640
score to that just so that i have the

308
00:11:04,640 --> 00:11:06,240
observation tracked

309
00:11:06,240 --> 00:11:08,399
and you know once you have that tracked

310
00:11:08,399 --> 00:11:10,320
you can do a lot of that broad tuning

311
00:11:10,320 --> 00:11:12,480
when you see what's sort of firing that

312
00:11:12,480 --> 00:11:14,959
informational alert but you also

313
00:11:14,959 --> 00:11:17,279
you could tune it out if if it's really

314
00:11:17,279 --> 00:11:18,800
regular business traffic and it's very

315
00:11:18,800 --> 00:11:20,800
specific but you can also just observe

316
00:11:20,800 --> 00:11:22,560
it every time it happens because that

317
00:11:22,560 --> 00:11:25,839
context can be useful with other things

318
00:11:25,839 --> 00:11:27,600
and then on top of that we'll add some

319
00:11:27,600 --> 00:11:29,680
muscles to our risk rules so that's just

320
00:11:29,680 --> 00:11:32,160
that shared field language so

321
00:11:32,160 --> 00:11:34,399
we use the the terminology terminology

322
00:11:34,399 --> 00:11:36,320
of risk object and threat object risk

323
00:11:36,320 --> 00:11:37,839
object being the thing that you are

324
00:11:37,839 --> 00:11:40,000
protecting and threat object being the

325
00:11:40,000 --> 00:11:42,640
thing that it does or the behavior that

326
00:11:42,640 --> 00:11:44,800
it has so in this case i've got a source

327
00:11:44,800 --> 00:11:48,480
ip i'm identifying it as a system but if

328
00:11:48,480 --> 00:11:52,079
you have other data like in proxy data

329
00:11:52,079 --> 00:11:54,000
you might have the user and the host

330
00:11:54,000 --> 00:11:56,800
name so you'd apply risk to both objects

331
00:11:56,800 --> 00:11:58,800
because if there's any sort of pivoting

332
00:11:58,800 --> 00:12:00,720
going on you'd still be tracking to

333
00:12:00,720 --> 00:12:03,200
something uh the shared sort of risk

334
00:12:03,200 --> 00:12:04,320
language

335
00:12:04,320 --> 00:12:05,600
and then with the threat object we have

336
00:12:05,600 --> 00:12:08,959
a desk in this case marking it as an ip

337
00:12:08,959 --> 00:12:10,480
but that could be

338
00:12:10,480 --> 00:12:13,519
a domain a file hash registry key file

339
00:12:13,519 --> 00:12:16,000
name command line whatever is the thing

340
00:12:16,000 --> 00:12:18,320
that your thing is doing just so you can

341
00:12:18,320 --> 00:12:20,480
look at it later and you can either use

342
00:12:20,480 --> 00:12:23,360
that for tuning or again thread hunting

343
00:12:23,360 --> 00:12:25,360
and then we'll just add the source type

344
00:12:25,360 --> 00:12:27,040
as well as the event time we're just

345
00:12:27,040 --> 00:12:29,279
doing that because you want the actual

346
00:12:29,279 --> 00:12:31,120
time of the event to follow through with

347
00:12:31,120 --> 00:12:33,360
the the new alert that you're you're

348
00:12:33,360 --> 00:12:35,760
going to build after this

349
00:12:35,760 --> 00:12:38,639
and then we'll throw a risk message and

350
00:12:38,639 --> 00:12:41,120
a risk info field i sort of see this

351
00:12:41,120 --> 00:12:43,040
risk message being like

352
00:12:43,040 --> 00:12:44,560
a general idea of what's happening

353
00:12:44,560 --> 00:12:46,480
enough to sort of tell that story so if

354
00:12:46,480 --> 00:12:48,000
you saw all the alerts in order you can

355
00:12:48,000 --> 00:12:50,079
see like ideas alert to this edr alert

356
00:12:50,079 --> 00:12:50,959
to that

357
00:12:50,959 --> 00:12:53,200
um but don't make it too unique like

358
00:12:53,200 --> 00:12:55,519
adding the timestamp because

359
00:12:55,519 --> 00:12:57,279
if you were going to dedupe this and

360
00:12:57,279 --> 00:12:59,360
just only look at uniques later you

361
00:12:59,360 --> 00:13:01,839
would want some way to sort of just like

362
00:13:01,839 --> 00:13:02,959
you don't want to see the same thing

363
00:13:02,959 --> 00:13:05,600
alerting 500 times and each time it adds

364
00:13:05,600 --> 00:13:07,519
risk so the risk message field is a

365
00:13:07,519 --> 00:13:09,839
great way to sort of tune that down and

366
00:13:09,839 --> 00:13:11,279
then the risk information field just

367
00:13:11,279 --> 00:13:13,279
really anything you want to pass forward

368
00:13:13,279 --> 00:13:15,040
to the analyst so they don't have to go

369
00:13:15,040 --> 00:13:16,959
directly to the raw logs to find

370
00:13:16,959 --> 00:13:18,560
interesting context

371
00:13:18,560 --> 00:13:20,880
and for example with proxy we would

372
00:13:20,880 --> 00:13:22,959
include the user agent the url bytes

373
00:13:22,959 --> 00:13:24,639
invites out that type of stuff just so

374
00:13:24,639 --> 00:13:26,079
they had it handy when they were

375
00:13:26,079 --> 00:13:27,360
investigating

376
00:13:27,360 --> 00:13:30,000
and lastly the star of the show is the

377
00:13:30,000 --> 00:13:31,279
mitre attack

378
00:13:31,279 --> 00:13:32,800
tactic and technique

379
00:13:32,800 --> 00:13:34,480
you can see based on the category i'm

380
00:13:34,480 --> 00:13:35,839
assigning a different technique and i

381
00:13:35,839 --> 00:13:38,399
grant and again this is a broad brush

382
00:13:38,399 --> 00:13:40,639
but it at least gives that observation

383
00:13:40,639 --> 00:13:42,720
some context so it can play well with

384
00:13:42,720 --> 00:13:45,440
other alerts

385
00:13:45,440 --> 00:13:48,240
and lastly we'll throw a skin on there

386
00:13:48,240 --> 00:13:51,040
so in this case i'm looking up an asset

387
00:13:51,040 --> 00:13:52,000
list

388
00:13:52,000 --> 00:13:54,639
and then providing uh

389
00:13:54,639 --> 00:13:56,560
the host name if i have it as well as

390
00:13:56,560 --> 00:13:58,639
the priority and the category

391
00:13:58,639 --> 00:14:01,120
and this this next slide is not that

392
00:14:01,120 --> 00:14:03,680
scary it's just starting with a count of

393
00:14:03,680 --> 00:14:04,720
zero

394
00:14:04,720 --> 00:14:08,000
and then if in the category i see pci go

395
00:14:08,000 --> 00:14:09,519
ahead and throw one on that zero

396
00:14:09,519 --> 00:14:11,199
otherwise leave it alone if i see

397
00:14:11,199 --> 00:14:13,040
production add one otherwise leave it

398
00:14:13,040 --> 00:14:14,880
alone if i see database add one

399
00:14:14,880 --> 00:14:17,279
otherwise leave it alone and priority

400
00:14:17,279 --> 00:14:20,240
and critical or high same thing

401
00:14:20,240 --> 00:14:22,800
and then on top of that a fun thing you

402
00:14:22,800 --> 00:14:25,440
can do is add that vuln data

403
00:14:25,440 --> 00:14:28,240
so if you had a lookup of your hosts

404
00:14:28,240 --> 00:14:30,160
with the number of crit bones on those

405
00:14:30,160 --> 00:14:32,800
machines you could combine that crit vol

406
00:14:32,800 --> 00:14:34,399
count with the modification account you

407
00:14:34,399 --> 00:14:36,240
just made from this

408
00:14:36,240 --> 00:14:38,800
and make a new count and again with

409
00:14:38,800 --> 00:14:40,160
users you could do something like

410
00:14:40,160 --> 00:14:42,000
executives executive assistants you

411
00:14:42,000 --> 00:14:43,680
could base it on the admin rights they

412
00:14:43,680 --> 00:14:44,399
have

413
00:14:44,399 --> 00:14:46,000
or anything you can think of that would

414
00:14:46,000 --> 00:14:48,240
make sense to elevate their scoring

415
00:14:48,240 --> 00:14:49,440
automatically

416
00:14:49,440 --> 00:14:51,440
um i know for its insider risk people a

417
00:14:51,440 --> 00:14:53,519
lot of like if there's a watch list or

418
00:14:53,519 --> 00:14:55,839
someone's about to be terminated

419
00:14:55,839 --> 00:14:57,839
they just add risk so that those insider

420
00:14:57,839 --> 00:14:59,600
threat alerts are more likely to bubble

421
00:14:59,600 --> 00:15:01,199
up as an alert

422
00:15:01,199 --> 00:15:02,880
and then we just take our normal risk

423
00:15:02,880 --> 00:15:04,320
score we would have assigned and then

424
00:15:04,320 --> 00:15:06,160
multiply it by that risk modification

425
00:15:06,160 --> 00:15:07,279
count

426
00:15:07,279 --> 00:15:09,680
that we've adjusted by 0.25 just because

427
00:15:09,680 --> 00:15:11,040
if something makes

428
00:15:11,040 --> 00:15:12,639
50 risk you don't want to make

429
00:15:12,639 --> 00:15:15,920
necessarily 200 risk out of the box but

430
00:15:15,920 --> 00:15:18,240
just you can tweak that number um and i

431
00:15:18,240 --> 00:15:19,680
like to think like with risk you're

432
00:15:19,680 --> 00:15:21,839
working with an ecology sort of like you

433
00:15:21,839 --> 00:15:23,680
have this sort of environment that plays

434
00:15:23,680 --> 00:15:25,120
with itself

435
00:15:25,120 --> 00:15:27,199
so rather than just direct alerts where

436
00:15:27,199 --> 00:15:28,720
you're just tuning that alert you get

437
00:15:28,720 --> 00:15:30,959
these opportunities to like tweak

438
00:15:30,959 --> 00:15:33,040
aspects of the whole system and then see

439
00:15:33,040 --> 00:15:36,560
how it responds to your tweets

440
00:15:36,560 --> 00:15:38,399
and then it just ends with a collect

441
00:15:38,399 --> 00:15:40,079
command that's just throwing it into a

442
00:15:40,079 --> 00:15:42,320
new index so you can search on that

443
00:15:42,320 --> 00:15:44,079
index for your alerts and we'll do that

444
00:15:44,079 --> 00:15:45,440
in the next slide

445
00:15:45,440 --> 00:15:47,279
but just to review what we've got here

446
00:15:47,279 --> 00:15:48,880
as far as fields goes

447
00:15:48,880 --> 00:15:51,040
we've got the risk score that we applied

448
00:15:51,040 --> 00:15:52,399
at the very beginning

449
00:15:52,399 --> 00:15:54,079
then we've got the risk object and the

450
00:15:54,079 --> 00:15:56,399
type we've got the threat object and the

451
00:15:56,399 --> 00:15:58,720
type we've got the source type and the

452
00:15:58,720 --> 00:15:59,839
event time

453
00:15:59,839 --> 00:16:01,680
and we've got that general risk message

454
00:16:01,680 --> 00:16:03,199
along with additional info we might want

455
00:16:03,199 --> 00:16:05,680
to include in the risk info field

456
00:16:05,680 --> 00:16:07,920
and then we've got that good good mitre

457
00:16:07,920 --> 00:16:10,639
attack data but you can also use any

458
00:16:10,639 --> 00:16:13,120
cyber security framework cis 20 lockheed

459
00:16:13,120 --> 00:16:15,839
martin kill chain even build your own uh

460
00:16:15,839 --> 00:16:17,199
i know that mitre is working on an

461
00:16:17,199 --> 00:16:19,680
insider threat kill chain so that's how

462
00:16:19,680 --> 00:16:21,360
i've seen people use it before of like

463
00:16:21,360 --> 00:16:23,440
collection reconnaissance exfiltration

464
00:16:23,440 --> 00:16:25,360
type things

465
00:16:25,360 --> 00:16:29,519
and then uh we build our alert so that's

466
00:16:29,519 --> 00:16:32,000
that's the basis of the alerting um you

467
00:16:32,000 --> 00:16:33,600
know you don't have as many of these you

468
00:16:33,600 --> 00:16:36,160
have a ton of risk generating rules but

469
00:16:36,160 --> 00:16:37,839
then you'd really just have a handful of

470
00:16:37,839 --> 00:16:40,560
these types of like gathering alerts

471
00:16:40,560 --> 00:16:42,639
so we're just looking at our risk index

472
00:16:42,639 --> 00:16:44,639
and then popping out distinct number of

473
00:16:44,639 --> 00:16:47,199
tactics missing number of techniques

474
00:16:47,199 --> 00:16:49,519
distinct sources and some the risk score

475
00:16:49,519 --> 00:16:51,199
by our risk objects

476
00:16:51,199 --> 00:16:52,560
and that generates all three of those

477
00:16:52,560 --> 00:16:54,720
alerts we used in the example so we've

478
00:16:54,720 --> 00:16:56,000
got the

479
00:16:56,000 --> 00:16:59,199
risk score over 100 for the 24 hours

480
00:16:59,199 --> 00:17:01,839
we've got the distinct number of sources

481
00:17:01,839 --> 00:17:03,120
above two

482
00:17:03,120 --> 00:17:06,400
we've got the uh distinct count of minor

483
00:17:06,400 --> 00:17:09,520
tactics above two or distinct number of

484
00:17:09,520 --> 00:17:12,400
minor techniques as well as distinct

485
00:17:12,400 --> 00:17:14,559
source types above one just because if

486
00:17:14,559 --> 00:17:17,599
an attacker is stuck in sort of one part

487
00:17:17,599 --> 00:17:19,520
of the chain you could still detect them

488
00:17:19,520 --> 00:17:20,559
because you're seeing things from

489
00:17:20,559 --> 00:17:22,079
multiple source types firing in that

490
00:17:22,079 --> 00:17:23,839
area

491
00:17:23,839 --> 00:17:25,760
um so

492
00:17:25,760 --> 00:17:27,679
on top of that i mentioned this earlier

493
00:17:27,679 --> 00:17:29,440
that like

494
00:17:29,440 --> 00:17:32,880
we generally utilized just like one

495
00:17:32,880 --> 00:17:35,200
alert over a certain time period for

496
00:17:35,200 --> 00:17:36,799
each one of those things

497
00:17:36,799 --> 00:17:38,799
but again you could do a risk score of

498
00:17:38,799 --> 00:17:42,080
say 300 over three days or you could do

499
00:17:42,080 --> 00:17:44,320
distinct source types over five days or

500
00:17:44,320 --> 00:17:46,400
minor attack over 30 days

501
00:17:46,400 --> 00:17:48,160
and each one of these gives like a

502
00:17:48,160 --> 00:17:50,240
different picture of your environment

503
00:17:50,240 --> 00:17:51,120
that

504
00:17:51,120 --> 00:17:53,120
again you can use for tuning and sort of

505
00:17:53,120 --> 00:17:54,720
seeing those behaviors that pop out

506
00:17:54,720 --> 00:17:56,960
those threat objects that are

507
00:17:56,960 --> 00:17:58,799
really really common and so you can just

508
00:17:58,799 --> 00:18:01,760
tweak levers here and there you can uh

509
00:18:01,760 --> 00:18:04,640
you know allow list as far as you'd like

510
00:18:04,640 --> 00:18:07,039
with really specific business traffic

511
00:18:07,039 --> 00:18:08,799
but i really like the idea of hanging on

512
00:18:08,799 --> 00:18:10,720
to these observations so we can make

513
00:18:10,720 --> 00:18:12,640
comparisons and do the anomaly tracking

514
00:18:12,640 --> 00:18:15,679
type stuff as well

515
00:18:15,679 --> 00:18:18,480
and so just about rethinking how we do

516
00:18:18,480 --> 00:18:20,000
detection

517
00:18:20,000 --> 00:18:21,760
because we're just looking for

518
00:18:21,760 --> 00:18:25,039
observations i can i can store anything

519
00:18:25,039 --> 00:18:27,120
i might want to know about later and

520
00:18:27,120 --> 00:18:30,000
just make the risk score zero

521
00:18:30,000 --> 00:18:30,799
so

522
00:18:30,799 --> 00:18:34,320
uh a few examples of how we utilize this

523
00:18:34,320 --> 00:18:36,880
this was actually um a favorite of mine

524
00:18:36,880 --> 00:18:39,200
from one of our stock analysts you know

525
00:18:39,200 --> 00:18:40,400
who you are

526
00:18:40,400 --> 00:18:44,960
and uh his idea was to make a risk rule

527
00:18:44,960 --> 00:18:48,000
that makes a zero risk event when adobe

528
00:18:48,000 --> 00:18:50,160
acrobat spawns a web browser we had to

529
00:18:50,160 --> 00:18:51,679
do some allow listing for like normal

530
00:18:51,679 --> 00:18:53,360
internal business traffic opening

531
00:18:53,360 --> 00:18:55,600
internal pdfs and that type of thing

532
00:18:55,600 --> 00:18:58,480
but also in conjunction with a proxy

533
00:18:58,480 --> 00:19:00,960
connection to an uncategorized site

534
00:19:00,960 --> 00:19:03,200
and also you could for example look for

535
00:19:03,200 --> 00:19:06,000
an http post or something like that but

536
00:19:06,000 --> 00:19:08,160
those things within a 10 minute time

537
00:19:08,160 --> 00:19:09,360
frame

538
00:19:09,360 --> 00:19:11,919
you know each one of these alerts fired

539
00:19:11,919 --> 00:19:14,400
thousands of times per day but in

540
00:19:14,400 --> 00:19:17,200
conjunction happened very rarely and

541
00:19:17,200 --> 00:19:19,200
usually it was only when people were

542
00:19:19,200 --> 00:19:22,480
being fished and we would often see like

543
00:19:22,480 --> 00:19:24,559
the alert come in it would work the

544
00:19:24,559 --> 00:19:27,039
alerts re about to reset the user's

545
00:19:27,039 --> 00:19:29,600
password and then the user reports it to

546
00:19:29,600 --> 00:19:31,039
the fishing queue because they realize

547
00:19:31,039 --> 00:19:32,799
that they did get phished

548
00:19:32,799 --> 00:19:35,280
um so that was uh one of my favorite

549
00:19:35,280 --> 00:19:36,240
rules

550
00:19:36,240 --> 00:19:38,400
my favorite rule that i made

551
00:19:38,400 --> 00:19:40,799
was looking for all these recon commands

552
00:19:40,799 --> 00:19:43,280
so my netstat ipconfig so on and so

553
00:19:43,280 --> 00:19:44,400
forth

554
00:19:44,400 --> 00:19:46,880
and some of those i

555
00:19:46,880 --> 00:19:48,960
did assign more than zero risk to

556
00:19:48,960 --> 00:19:52,160
because impact and confidence some of

557
00:19:52,160 --> 00:19:54,320
those things were happening so rarely in

558
00:19:54,320 --> 00:19:55,760
our environment that i might just throw

559
00:19:55,760 --> 00:19:58,880
like 10 15 20 like not a terrible amount

560
00:19:58,880 --> 00:20:01,440
so that it wouldn't alert by itself

561
00:20:01,440 --> 00:20:03,679
but then i made another rule to look for

562
00:20:03,679 --> 00:20:06,559
when any of those fired and then i could

563
00:20:06,559 --> 00:20:10,720
say add maybe 25 risk when i see three

564
00:20:10,720 --> 00:20:13,120
maybe 50 risk when i see five but maybe

565
00:20:13,120 --> 00:20:15,679
like 90 when i see seven of those

566
00:20:15,679 --> 00:20:17,919
because who is doing all seven of those

567
00:20:17,919 --> 00:20:20,559
commands in any sort of small time frame

568
00:20:20,559 --> 00:20:22,799
and so this was

569
00:20:22,799 --> 00:20:25,200
really great for catching red team and

570
00:20:25,200 --> 00:20:26,240
so

571
00:20:26,240 --> 00:20:28,480
uh and shells in general

572
00:20:28,480 --> 00:20:29,360
um

573
00:20:29,360 --> 00:20:31,039
you know after we built this and red

574
00:20:31,039 --> 00:20:33,440
team realized they had to get around my

575
00:20:33,440 --> 00:20:35,360
crafty little detection then they

576
00:20:35,360 --> 00:20:37,360
started building uh

577
00:20:37,360 --> 00:20:40,240
fireless in-memory mount like shells so

578
00:20:40,240 --> 00:20:42,240
that our edr wouldn't catch the command

579
00:20:42,240 --> 00:20:43,679
lines and then

580
00:20:43,679 --> 00:20:45,840
we had to evolve by starting to look at

581
00:20:45,840 --> 00:20:47,440
network traffic and making risk rules

582
00:20:47,440 --> 00:20:49,120
about network traffic and the types of

583
00:20:49,120 --> 00:20:51,760
things that indicate c2 so it's it's

584
00:20:51,760 --> 00:20:53,840
just so exciting the possibilities of

585
00:20:53,840 --> 00:20:56,080
like complex detections and and i'm

586
00:20:56,080 --> 00:20:57,679
excited to see the cat and mouse game

587
00:20:57,679 --> 00:20:59,280
sort of evolve these detections even

588
00:20:59,280 --> 00:21:01,280
further

589
00:21:01,280 --> 00:21:04,320
so as far as alerting goes um

590
00:21:04,320 --> 00:21:06,400
one thing i really like about risc is

591
00:21:06,400 --> 00:21:09,280
that you can have different lenses into

592
00:21:09,280 --> 00:21:11,520
this data like we initially approached

593
00:21:11,520 --> 00:21:14,320
this for sock but also we had people in

594
00:21:14,320 --> 00:21:17,840
dlp in database in insider risk who like

595
00:21:17,840 --> 00:21:19,360
saw the potential for the approach but

596
00:21:19,360 --> 00:21:22,080
we didn't it necessarily wasn't for sock

597
00:21:22,080 --> 00:21:24,240
we really just added eval

598
00:21:24,240 --> 00:21:27,200
for sock equals one for insider equals

599
00:21:27,200 --> 00:21:29,440
one and then had their own alerts that

600
00:21:29,440 --> 00:21:31,919
just looked at their own risk events

601
00:21:31,919 --> 00:21:33,520
and what was really great about this was

602
00:21:33,520 --> 00:21:34,480
that

603
00:21:34,480 --> 00:21:35,600
so often

604
00:21:35,600 --> 00:21:37,760
as a content engineer like people would

605
00:21:37,760 --> 00:21:39,360
come with a request like we've got this

606
00:21:39,360 --> 00:21:40,880
log source and we've got an audit

607
00:21:40,880 --> 00:21:42,640
requirement for security can you please

608
00:21:42,640 --> 00:21:44,559
do security on it

609
00:21:44,559 --> 00:21:46,080
and a lot of the times we really

610
00:21:46,080 --> 00:21:47,440
couldn't because they wanted to know

611
00:21:47,440 --> 00:21:49,600
like every failed login and just a lot

612
00:21:49,600 --> 00:21:51,200
of things that were really really noisy

613
00:21:51,200 --> 00:21:52,960
so we would often just sort of send them

614
00:21:52,960 --> 00:21:54,240
a report

615
00:21:54,240 --> 00:21:56,159
and like good luck i hope that helps

616
00:21:56,159 --> 00:21:57,360
kind of thing but it didn't really feel

617
00:21:57,360 --> 00:22:00,159
like you're enabling the business um

618
00:22:00,159 --> 00:22:01,280
and so

619
00:22:01,280 --> 00:22:02,799
what was great about this was like they

620
00:22:02,799 --> 00:22:04,799
would come with their log source and we

621
00:22:04,799 --> 00:22:06,400
would talk to them like what do you like

622
00:22:06,400 --> 00:22:08,559
we would explain the rba concept and the

623
00:22:08,559 --> 00:22:10,880
buckets and be like well what do you

624
00:22:10,880 --> 00:22:13,280
think would indicate compromise like

625
00:22:13,280 --> 00:22:14,720
what sort of things would you be looking

626
00:22:14,720 --> 00:22:16,559
for like these if this and that type

627
00:22:16,559 --> 00:22:17,440
things

628
00:22:17,440 --> 00:22:20,480
so uh we might have a team who has just

629
00:22:20,480 --> 00:22:23,679
one log source but has only three to six

630
00:22:23,679 --> 00:22:27,120
risk rule generating uh or

631
00:22:27,120 --> 00:22:29,120
risk generating rules

632
00:22:29,120 --> 00:22:31,280
but like one might be 25 and then

633
00:22:31,280 --> 00:22:33,600
there's three 50s and then 275s but that

634
00:22:33,600 --> 00:22:35,360
little combination was enough to give

635
00:22:35,360 --> 00:22:37,600
them like a better picture of when

636
00:22:37,600 --> 00:22:40,320
something might be actually happening

637
00:22:40,320 --> 00:22:41,360
and

638
00:22:41,360 --> 00:22:43,200
as far as alerting goes i i showed those

639
00:22:43,200 --> 00:22:45,760
examples of those interesting like

640
00:22:45,760 --> 00:22:47,760
chained events you can make

641
00:22:47,760 --> 00:22:49,440
and what i thought was really cool was

642
00:22:49,440 --> 00:22:51,200
while i was making this slide deck uh

643
00:22:51,200 --> 00:22:53,600
the ingenuity team published their their

644
00:22:53,600 --> 00:22:54,880
attack flow

645
00:22:54,880 --> 00:22:57,600
article which talks basically i mean

646
00:22:57,600 --> 00:22:59,200
there it's a match made in heaven uh

647
00:22:59,200 --> 00:23:00,880
risk-based alerting and this attack flow

648
00:23:00,880 --> 00:23:02,640
stuff because we've got the asset with

649
00:23:02,640 --> 00:23:04,480
properties about the asset tweaking

650
00:23:04,480 --> 00:23:06,480
things and then the relationship to the

651
00:23:06,480 --> 00:23:08,400
action that they're performing so

652
00:23:08,400 --> 00:23:11,280
rba to me is just a beautiful system for

653
00:23:11,280 --> 00:23:12,880
you know bringing these things together

654
00:23:12,880 --> 00:23:14,960
and i'm really excited to see

655
00:23:14,960 --> 00:23:17,679
how the the evolution of like complex

656
00:23:17,679 --> 00:23:20,320
defense to meet complex attackers

657
00:23:20,320 --> 00:23:22,880
sort of evolves through this space

658
00:23:22,880 --> 00:23:25,280
um so just to recap what we talked about

659
00:23:25,280 --> 00:23:27,039
we talked about risk-based alerting that

660
00:23:27,039 --> 00:23:28,880
really cool thing that uh hopefully

661
00:23:28,880 --> 00:23:30,320
you'll be implementing as soon as

662
00:23:30,320 --> 00:23:31,919
possible and reducing your alert volume

663
00:23:31,919 --> 00:23:33,280
for your sock

664
00:23:33,280 --> 00:23:35,120
and then we talked about how we did that

665
00:23:35,120 --> 00:23:36,880
with the

666
00:23:36,880 --> 00:23:38,799
the collect command to

667
00:23:38,799 --> 00:23:41,360
bring together disparate events from

668
00:23:41,360 --> 00:23:43,200
other source types into just a shared

669
00:23:43,200 --> 00:23:45,919
field language on an abstraction layer

670
00:23:45,919 --> 00:23:47,760
and then we

671
00:23:47,760 --> 00:23:49,200
add the risk score and the security

672
00:23:49,200 --> 00:23:51,200
metadata that we have about that

673
00:23:51,200 --> 00:23:52,559
observation

674
00:23:52,559 --> 00:23:56,799
as well as um oh and then uh

675
00:23:56,799 --> 00:23:58,640
the tweaking the risk score up and down

676
00:23:58,640 --> 00:24:00,320
based on the attributes about the risk

677
00:24:00,320 --> 00:24:01,520
object

678
00:24:01,520 --> 00:24:04,240
and then the things we can do now the

679
00:24:04,240 --> 00:24:06,240
possibilities are endless and i'm

680
00:24:06,240 --> 00:24:07,600
actually really excited to talk to

681
00:24:07,600 --> 00:24:08,960
people because i know a lot of people

682
00:24:08,960 --> 00:24:11,679
are actually doing this in some capacity

683
00:24:11,679 --> 00:24:13,600
but it's it's just been missing in sim

684
00:24:13,600 --> 00:24:15,440
for a long time so i've talked to people

685
00:24:15,440 --> 00:24:16,720
who see it and they're like oh i think i

686
00:24:16,720 --> 00:24:18,400
can figure out how to sort of make that

687
00:24:18,400 --> 00:24:20,320
happen and i'm really excited to see

688
00:24:20,320 --> 00:24:22,000
that sort of spread through the space

689
00:24:22,000 --> 00:24:24,880
and see you know the defense game level

690
00:24:24,880 --> 00:24:26,000
up

691
00:24:26,000 --> 00:24:30,559
so that's me and uh yeah wow i went fast

692
00:24:30,559 --> 00:24:33,720
all right

693
00:24:36,559 --> 00:24:38,480
simply amazing simply amazing and one of

694
00:24:38,480 --> 00:24:40,159
the things i really appreciated and you

695
00:24:40,159 --> 00:24:41,200
know i'm

696
00:24:41,200 --> 00:24:42,880
summarizing a lot of the feedback from

697
00:24:42,880 --> 00:24:44,559
slack you caught a lot of eyes because i

698
00:24:44,559 --> 00:24:46,799
think risk is something we all have and

699
00:24:46,799 --> 00:24:49,279
we all deal with but i really loved how

700
00:24:49,279 --> 00:24:51,200
you said you know you start with your

701
00:24:51,200 --> 00:24:52,799
customers even if they're internal like

702
00:24:52,799 --> 00:24:54,720
how do i fit to them i don't want to

703
00:24:54,720 --> 00:24:56,159
piss them off i don't want them to

704
00:24:56,159 --> 00:24:58,240
murder me how do i really make this a

705
00:24:58,240 --> 00:25:01,039
part they can buy into um so while we

706
00:25:01,039 --> 00:25:02,400
give the audience a couple minutes a

707
00:25:02,400 --> 00:25:03,679
couple seconds to maybe think of some

708
00:25:03,679 --> 00:25:04,640
questions

709
00:25:04,640 --> 00:25:06,240
just from a quick summary of the slack

710
00:25:06,240 --> 00:25:07,919
one of the you know everyone really

711
00:25:07,919 --> 00:25:09,039
loved this and they like you know they

712
00:25:09,039 --> 00:25:10,480
were answering questions asking

713
00:25:10,480 --> 00:25:11,840
questions as you were answering them so

714
00:25:11,840 --> 00:25:13,600
it really really vibing with that but i

715
00:25:13,600 --> 00:25:15,360
think the big kind of overarching

716
00:25:15,360 --> 00:25:17,360
thought was in your perspective you know

717
00:25:17,360 --> 00:25:19,200
someone who you know maybe hasn't had a

718
00:25:19,200 --> 00:25:20,480
lot of experience in this space and

719
00:25:20,480 --> 00:25:22,080
they're just getting in what advice

720
00:25:22,080 --> 00:25:23,760
would you give them in terms of you know

721
00:25:23,760 --> 00:25:25,279
first steps of getting into you know

722
00:25:25,279 --> 00:25:27,840
really adopting and you know not just

723
00:25:27,840 --> 00:25:29,919
applying but you know exactly you said

724
00:25:29,919 --> 00:25:31,679
maintaining and developing this risk

725
00:25:31,679 --> 00:25:33,760
approach in the organization yeah i mean

726
00:25:33,760 --> 00:25:35,360
there's there's a few

727
00:25:35,360 --> 00:25:36,960
quite a few steps and i i've you know

728
00:25:36,960 --> 00:25:38,720
i've seen sort of like best practices as

729
00:25:38,720 --> 00:25:40,080
far as implementing this because there

730
00:25:40,080 --> 00:25:41,600
are a lot of pieces to think about and

731
00:25:41,600 --> 00:25:44,320
it's also sort of changing the nature of

732
00:25:44,320 --> 00:25:46,400
how the whole security operations center

733
00:25:46,400 --> 00:25:48,000
because like you can get red team more

734
00:25:48,000 --> 00:25:49,760
involved you can get so many more teams

735
00:25:49,760 --> 00:25:51,279
involved in this

736
00:25:51,279 --> 00:25:53,760
um i think it's it's good to start like

737
00:25:53,760 --> 00:25:56,000
talking about what you want to do to the

738
00:25:56,000 --> 00:25:57,520
other people you're going to work with

739
00:25:57,520 --> 00:25:58,480
because

740
00:25:58,480 --> 00:26:00,960
maybe you can align what you're building

741
00:26:00,960 --> 00:26:03,120
like with them early on so that like

742
00:26:03,120 --> 00:26:05,600
when you have this in practice you

743
00:26:05,600 --> 00:26:07,440
not only design it in a way that makes

744
00:26:07,440 --> 00:26:09,760
it usable for them like uh you know

745
00:26:09,760 --> 00:26:10,960
making sure there's

746
00:26:10,960 --> 00:26:12,480
your socks should have a process to

747
00:26:12,480 --> 00:26:14,159
responding to risk alerts before you

748
00:26:14,159 --> 00:26:16,240
just enable risk alerts because it's

749
00:26:16,240 --> 00:26:17,840
it's a little different of how they're

750
00:26:17,840 --> 00:26:19,679
approaching things so i really think

751
00:26:19,679 --> 00:26:21,360
just talking to people you will get so

752
00:26:21,360 --> 00:26:22,720
many ideas while you're talking to

753
00:26:22,720 --> 00:26:24,320
people and then you have to scope what

754
00:26:24,320 --> 00:26:26,000
you can actually do and then just build

755
00:26:26,000 --> 00:26:27,360
the foundation

756
00:26:27,360 --> 00:26:29,919
but uh yeah as far as like content you

757
00:26:29,919 --> 00:26:31,760
can also prioritize content based on

758
00:26:31,760 --> 00:26:33,919
what's making a lot of noise for your

759
00:26:33,919 --> 00:26:35,360
team

760
00:26:35,360 --> 00:26:37,279
and then covering gaps that you just

761
00:26:37,279 --> 00:26:39,120
haven't been able to close before i love

762
00:26:39,120 --> 00:26:40,400
that it really does start with the

763
00:26:40,400 --> 00:26:42,559
people it's it's a lot of hard problems

764
00:26:42,559 --> 00:26:44,159
a lot of technical problems but people

765
00:26:44,159 --> 00:26:45,440
aren't aren't bought in and you know

766
00:26:45,440 --> 00:26:46,320
really

767
00:26:46,320 --> 00:26:48,000
into what's happening that makes a lot

768
00:26:48,000 --> 00:26:50,320
of sense so i think we have uh i know

769
00:26:50,320 --> 00:26:51,679
we're right in front of lunch so i

770
00:26:51,679 --> 00:26:52,880
recognize that and i know everyone

771
00:26:52,880 --> 00:26:54,240
online will you know

772
00:26:54,240 --> 00:26:55,600
we're probably in a similar boat but we

773
00:26:55,600 --> 00:26:57,039
do have a couple minutes for questions

774
00:26:57,039 --> 00:26:59,120
if there's anyone oh couple i saw on

775
00:26:59,120 --> 00:27:02,760
hand in the back

776
00:27:16,640 --> 00:27:18,720
yeah for the live audience the question

777
00:27:18,720 --> 00:27:21,440
was what um going into calculating risk

778
00:27:21,440 --> 00:27:23,279
scores and kind of that algorithm what

779
00:27:23,279 --> 00:27:24,880
kind of goes into that and what is the

780
00:27:24,880 --> 00:27:26,880
feedback loop for you know maintaining

781
00:27:26,880 --> 00:27:29,200
and kind of maturing that

782
00:27:29,200 --> 00:27:32,320
yeah so um

783
00:27:32,320 --> 00:27:33,840
like i said with like low bins are a

784
00:27:33,840 --> 00:27:35,520
great example because they're really

785
00:27:35,520 --> 00:27:38,159
common activity in your environment so

786
00:27:38,159 --> 00:27:39,440
we could

787
00:27:39,440 --> 00:27:41,600
uh utilize a combination of like impact

788
00:27:41,600 --> 00:27:43,120
if that thing were to happen like if a

789
00:27:43,120 --> 00:27:45,039
recon command happens that's not a huge

790
00:27:45,039 --> 00:27:47,360
impact when it's happening but if it's

791
00:27:47,360 --> 00:27:49,679
happening a thousand times per day my

792
00:27:49,679 --> 00:27:52,000
confidence in that is really low so i

793
00:27:52,000 --> 00:27:53,840
just generally grouped things by

794
00:27:53,840 --> 00:27:55,600
fidelity and just

795
00:27:55,600 --> 00:27:57,520
my perception of how bad it would be for

796
00:27:57,520 --> 00:27:59,360
this thing to be occurring and so maybe

797
00:27:59,360 --> 00:28:00,880
things later in the chain

798
00:28:00,880 --> 00:28:02,480
might have a higher impact

799
00:28:02,480 --> 00:28:05,520
but uh yeah we often just would like

800
00:28:05,520 --> 00:28:07,520
make our detection logic see how many

801
00:28:07,520 --> 00:28:10,000
results we're getting and then even

802
00:28:10,000 --> 00:28:11,760
like some stuff we might allow list

803
00:28:11,760 --> 00:28:13,360
outright just because it is definitely

804
00:28:13,360 --> 00:28:15,039
business traffic every time but then

805
00:28:15,039 --> 00:28:17,200
we'd still have thousands of alerts left

806
00:28:17,200 --> 00:28:19,440
we might see how we can slice that into

807
00:28:19,440 --> 00:28:21,120
like what are the things that are

808
00:28:21,120 --> 00:28:23,919
generally going to be even lower risk

809
00:28:23,919 --> 00:28:26,000
and what's medium what's high so like

810
00:28:26,000 --> 00:28:28,240
our proxy rule we might see malware and

811
00:28:28,240 --> 00:28:31,279
fishing keep those high suspicious uh

812
00:28:31,279 --> 00:28:33,200
maybe medium

813
00:28:33,200 --> 00:28:35,120
and uncategorized site with zero for

814
00:28:35,120 --> 00:28:37,200
example so you can slice it up in ways

815
00:28:37,200 --> 00:28:38,640
that makes sense and that really does

816
00:28:38,640 --> 00:28:39,919
get back to what you said earlier about

817
00:28:39,919 --> 00:28:41,360
talking to people like not just

818
00:28:41,360 --> 00:28:42,799
initially but throughout that entire

819
00:28:42,799 --> 00:28:45,840
process so thank you

