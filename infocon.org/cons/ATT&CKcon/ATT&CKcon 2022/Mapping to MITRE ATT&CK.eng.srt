1
00:00:14,179 --> 00:00:15,539
- [Announcer] Ladies and gentlemen,

2
00:00:15,539 --> 00:00:21,090
please welcome back to the
stage, Adam Pennington.

3
00:00:21,090 --> 00:00:23,730
(audience applauding)

4
00:00:23,730 --> 00:00:24,779
- Welcome back from break.

5
00:00:24,779 --> 00:00:26,960
Hopefully, if you're home or here,

6
00:00:26,960 --> 00:00:31,469
you got a chance to see Cat on the couch

7
00:00:31,469 --> 00:00:36,079
or even got a snack, drink,
ready to get going again.

8
00:00:36,079 --> 00:00:38,079
So now into our regular program.

9
00:00:38,079 --> 00:00:41,430
So first talk, coming
from our call for papers.

10
00:00:41,430 --> 00:00:43,050
We're gonna have Jason Wood

11
00:00:43,050 --> 00:00:44,709
and Justin Swisher from CrowdStrike.

12
00:00:44,710 --> 00:00:49,410
So I'm a sucker for talks
with real threat data.

13
00:00:49,410 --> 00:00:51,139
I'm always excited to hear about things

14
00:00:51,140 --> 00:00:54,319
that adversaries have
really done in the wild,

15
00:00:54,319 --> 00:00:57,950
but this proposal caught
our eye specifically,

16
00:00:57,950 --> 00:01:00,899
combining ATT&CK analysis of
some of this real threat data

17
00:01:00,899 --> 00:01:02,930
with a platform, we really don't see

18
00:01:02,930 --> 00:01:05,470
that much in reporting Lenox.

19
00:01:05,470 --> 00:01:10,420
So please help me welcome to
the stage, Jason and Justin.

20
00:01:10,420 --> 00:01:13,049
(audience applauding)

21
00:01:13,049 --> 00:01:15,670
- Thanks Adam.

22
00:01:15,670 --> 00:01:17,780
You guys hear me okay?

23
00:01:17,780 --> 00:01:18,780
Audio check.

24
00:01:18,780 --> 00:01:19,780
Oh, awesome.

25
00:01:19,780 --> 00:01:20,780
Awesome.

26
00:01:20,780 --> 00:01:21,780
Cool.

27
00:01:21,780 --> 00:01:23,110
So yeah, Jason, I think you're the first

28
00:01:23,110 --> 00:01:24,110
bio slide.

29
00:01:24,110 --> 00:01:25,110
- Yep.

30
00:01:25,110 --> 00:01:27,590
So hi everybody, my name's Jason Wood.

31
00:01:27,590 --> 00:01:29,290
I'm an intrusion researcher

32
00:01:29,290 --> 00:01:31,980
on the OverWatch team at CrowdStrike.

33
00:01:31,980 --> 00:01:33,920
OverWatch is our Threat Hunting team.

34
00:01:33,920 --> 00:01:36,549
And so yeah, we look at a
lot of intrusions every week,

35
00:01:36,549 --> 00:01:39,049
hands on, somebody's gone
interactive on systems.

36
00:01:39,049 --> 00:01:42,060
So this is just kind of
a snapshot into that.

37
00:01:42,060 --> 00:01:43,409
What we're gonna be talking about here.

38
00:01:43,409 --> 00:01:45,490
I know it's just Justin
and I up here talking,

39
00:01:45,490 --> 00:01:49,339
but there is a whole team
on our Outreach team that

40
00:01:49,340 --> 00:01:50,340
does this analysis

41
00:01:50,340 --> 00:01:57,229
and really helped build what
we're talking about here today.

42
00:01:57,229 --> 00:02:00,289
So yeah, with that, Justin.

43
00:02:00,290 --> 00:02:01,300
- Yeah.

44
00:02:01,300 --> 00:02:02,710
So Justin Swisher,

45
00:02:02,710 --> 00:02:05,240
have a little over a decade of experience.

46
00:02:05,240 --> 00:02:07,710
I started as a civilian Intel
Analyst at the air force,

47
00:02:07,710 --> 00:02:10,090
looking at foreign command
and control networks,

48
00:02:10,090 --> 00:02:12,959
and then foreign malware
against airspace systems,

49
00:02:12,959 --> 00:02:15,290
bounced around to a bunch
of different vendors

50
00:02:15,290 --> 00:02:17,100
doing network security, monitoring,

51
00:02:17,100 --> 00:02:18,290
threat Intel consulting.

52
00:02:18,290 --> 00:02:19,929
And then the last few years I've spent

53
00:02:19,930 --> 00:02:21,560
most of my time on
Endpoint Threat Hunting,

54
00:02:21,560 --> 00:02:22,790
which I really enjoy and

55
00:02:22,790 --> 00:02:25,340
obviously we're gonna be
talking a lot about today.

56
00:02:25,340 --> 00:02:29,810
So I wanna dive right in with
why do we track intrusions?

57
00:02:29,810 --> 00:02:31,189
I don't know if you've read the book,

58
00:02:31,189 --> 00:02:33,769
"Start With Why" by Simon
Sinek, love that book.

59
00:02:33,769 --> 00:02:36,430
And I always approach
everything with a why.

60
00:02:36,430 --> 00:02:37,430
Why am I doing this?

61
00:02:37,430 --> 00:02:38,499
What's the purpose behind it?

62
00:02:38,499 --> 00:02:41,379
And so when we look at intrusion tracking,

63
00:02:41,379 --> 00:02:43,249
we understand why do
we go about doing this?

64
00:02:43,249 --> 00:02:44,970
Like we gotta put all this effort into it,

65
00:02:44,970 --> 00:02:46,769
tagging everything with MITRE.

66
00:02:46,769 --> 00:02:49,239
And the first thing is we
wanna understand successes,

67
00:02:49,239 --> 00:02:50,930
ours and our adversaries.

68
00:02:50,930 --> 00:02:52,749
What are the techniques that they're using

69
00:02:52,749 --> 00:02:53,870
that they're successful with?

70
00:02:53,870 --> 00:02:56,680
How are they operating and
getting past our defenses?

71
00:02:56,680 --> 00:02:58,090
What are they doing that's successful

72
00:02:58,090 --> 00:02:59,969
and they're repeating over and over again?

73
00:02:59,969 --> 00:03:02,099
And then when we think
about our successes,

74
00:03:02,099 --> 00:03:05,268
what are we doing in terms
of triggers and hunting leads

75
00:03:05,269 --> 00:03:07,290
that is catching this adversary?

76
00:03:07,290 --> 00:03:08,418
What are the techniques
that they're leveraging

77
00:03:08,419 --> 00:03:12,010
that we're like, yes, we've
got that or eyes on that.

78
00:03:12,010 --> 00:03:13,010
Where our successes?

79
00:03:13,010 --> 00:03:15,120
So we wanna continue to
focus on those areas,

80
00:03:15,120 --> 00:03:17,379
but then we wanna look
at the failures as well.

81
00:03:17,379 --> 00:03:19,379
What did the adversary
do that didn't work?

82
00:03:19,379 --> 00:03:21,149
Did they type a command wrong?

83
00:03:21,150 --> 00:03:22,980
Did they bring in a tool
for the wrong architecture?

84
00:03:22,980 --> 00:03:24,160
We see that oftentimes like,

85
00:03:24,160 --> 00:03:25,859
what are they doing that's failing?

86
00:03:25,859 --> 00:03:28,999
And also when they conduct
something like Mimikatz,

87
00:03:28,999 --> 00:03:30,219
is it being prevented?

88
00:03:30,219 --> 00:03:32,198
That's a failure on there
and it did not work.

89
00:03:32,199 --> 00:03:34,279
But our failures as well.

90
00:03:34,279 --> 00:03:36,290
We research these intrusions where,

91
00:03:36,290 --> 00:03:37,989
okay, maybe we catch it here.

92
00:03:37,989 --> 00:03:39,999
This is a hunting lead that fired.

93
00:03:39,999 --> 00:03:41,388
What else happened where we could have

94
00:03:41,389 --> 00:03:43,299
triggered a little earlier?

95
00:03:43,299 --> 00:03:45,809
Maybe prevention was not enabled.

96
00:03:45,809 --> 00:03:47,059
That's a failure on our end.

97
00:03:47,059 --> 00:03:50,139
Like the technology could have
stopped this, but it didn't.

98
00:03:50,139 --> 00:03:51,760
And then that leads into gap analysis.

99
00:03:51,760 --> 00:03:54,059
What are our coverage gaps?

100
00:03:54,059 --> 00:03:57,189
Where could visibility be
improved as we look at the matrix,

101
00:03:57,189 --> 00:03:59,150
the techniques that we're identifying,

102
00:03:59,150 --> 00:04:01,409
where are those slightly less red spots

103
00:04:01,409 --> 00:04:03,089
if you're thinking about
the ATT&CK navigator.

104
00:04:03,089 --> 00:04:04,530
Why aren't we catching things there?

105
00:04:04,530 --> 00:04:07,029
Could we improve visibility,
better detection,

106
00:04:07,029 --> 00:04:09,839
better collection, and then
improve our hunting patterns.

107
00:04:09,839 --> 00:04:12,859
So we take all of that
to identify and document

108
00:04:12,859 --> 00:04:13,959
and keep track of that.

109
00:04:13,959 --> 00:04:17,540
And then this is hands
on keyboard activity.

110
00:04:17,540 --> 00:04:19,640
Our adversaries are
developing and growing.

111
00:04:19,640 --> 00:04:22,330
Over time, and Jason will talk
to this a little bit later.

112
00:04:22,330 --> 00:04:24,800
We wanna understand what
techniques continue to show up,

113
00:04:24,800 --> 00:04:28,240
quarter after quarter, year
over year that are successful

114
00:04:28,240 --> 00:04:29,450
and then where are they improving?

115
00:04:29,450 --> 00:04:30,450
Where are they growing?

116
00:04:30,450 --> 00:04:31,450
Where are they developing?

117
00:04:31,450 --> 00:04:35,039
And can we identify those
clusters of activity?

118
00:04:35,039 --> 00:04:40,520
So, we really dig into hands
on keyboard intrusions only.

119
00:04:40,520 --> 00:04:41,960
That's what we focus on at OverWatch

120
00:04:41,960 --> 00:04:43,549
and in the Outreach team.

121
00:04:43,550 --> 00:04:45,990
And so we are mapping
individual unique events

122
00:04:45,990 --> 00:04:49,050
within an intrusion to the ATT&CK matrix

123
00:04:49,050 --> 00:04:51,659
and it's really fun to be
able to kind of dig down in

124
00:04:51,659 --> 00:04:55,219
and look at a single line
is an actual process roll up

125
00:04:55,220 --> 00:04:56,910
or in a network connect.

126
00:04:56,910 --> 00:04:59,090
And we're actually looking
at hundreds to, what,

127
00:04:59,090 --> 00:05:01,948
thousands of lines, and
depending on the intrusion,

128
00:05:01,949 --> 00:05:03,310
the scope of the intrusion,

129
00:05:03,310 --> 00:05:06,129
and we're gonna map everything
that we can to MITRE ATT&CK.

130
00:05:06,129 --> 00:05:07,949
So we have some examples here,

131
00:05:07,949 --> 00:05:10,080
initial access valid accounts.

132
00:05:10,080 --> 00:05:12,099
How many people continue
to see valid accounts

133
00:05:12,099 --> 00:05:13,938
leveraged against them every single day.

134
00:05:13,939 --> 00:05:16,639
I see heads nodding, right?

135
00:05:16,639 --> 00:05:20,229
Externally accessible RDP,
just constantly happening.

136
00:05:20,229 --> 00:05:22,169
So that's gonna be our
initial access valid account.

137
00:05:22,169 --> 00:05:25,240
And then we'll see things
like registry modifications.

138
00:05:25,240 --> 00:05:28,130
So event triggered execution,
accessibility features.

139
00:05:28,130 --> 00:05:30,150
What's nice about this
line is that it actually

140
00:05:30,150 --> 00:05:31,469
applies to two different techniques.

141
00:05:31,469 --> 00:05:34,569
And sometimes we have to be
very careful when we're mapping.

142
00:05:34,569 --> 00:05:36,099
Are we hitting both techniques?

143
00:05:36,099 --> 00:05:37,099
Its, (sighs)

144
00:05:37,099 --> 00:05:39,830
we catch each other's
mistakes all the time.

145
00:05:39,830 --> 00:05:41,590
- Spend a lot of time.

146
00:05:41,590 --> 00:05:43,650
It's not unusual when we're
bringing in new people

147
00:05:43,650 --> 00:05:45,609
to the Outreach team, 'cause
we're doing this analysis,

148
00:05:45,610 --> 00:05:47,610
inevitably, you have these questions.

149
00:05:47,610 --> 00:05:49,770
Well, I've got this
command line doing this.

150
00:05:49,770 --> 00:05:51,310
How does this map,

151
00:05:51,310 --> 00:05:54,760
where does this map to the framework?

152
00:05:54,760 --> 00:05:57,169
And so we're going through
that and I'm telling people

153
00:05:57,169 --> 00:05:59,060
all the time, oh, don't worry,

154
00:05:59,060 --> 00:06:01,419
I'll be asking the same questions.

155
00:06:01,419 --> 00:06:02,419
- Yeah.

156
00:06:02,419 --> 00:06:04,740
- Because

157
00:06:04,740 --> 00:06:05,740
adversaries are doing different things

158
00:06:05,740 --> 00:06:06,759
and you're just like, where does this fit?

159
00:06:06,759 --> 00:06:07,759
- Yeah.

160
00:06:07,759 --> 00:06:09,810
Yeah, we have great discussions along.

161
00:06:09,810 --> 00:06:10,810
Where does this fit exactly?

162
00:06:10,810 --> 00:06:12,620
What could be here, maybe it's over here,

163
00:06:12,620 --> 00:06:13,830
it spurred some discussion around,

164
00:06:13,830 --> 00:06:15,030
should we submit something to MITRE

165
00:06:15,030 --> 00:06:17,109
for maybe a new technique.

166
00:06:17,110 --> 00:06:20,280
But just some examples there
to kinda go through and

167
00:06:20,280 --> 00:06:24,378
that's our job every single
day, we really enjoy it.

168
00:06:24,379 --> 00:06:27,150
But last year, 2021,

169
00:06:27,150 --> 00:06:31,500
we observed 960 hands
on keyboard intrusions.

170
00:06:31,500 --> 00:06:32,500
- [Jason] Hopefully.

171
00:06:32,500 --> 00:06:33,960
- Almost a thousand hands
on keyboard intrusions

172
00:06:33,960 --> 00:06:35,900
across our customer set.

173
00:06:35,900 --> 00:06:38,280
That's a lot, even for the
size team that we have,

174
00:06:38,280 --> 00:06:39,590
that is a lot.

175
00:06:39,590 --> 00:06:43,060
And so we have to store,
memorialize and use this data.

176
00:06:43,060 --> 00:06:45,740
And that's not easy.

177
00:06:45,740 --> 00:06:47,830
Not just the individual command lines,

178
00:06:47,830 --> 00:06:50,130
not just the MITRE ATT&CK,
but the metadata around it.

179
00:06:50,130 --> 00:06:51,610
What is the vertical?

180
00:06:51,610 --> 00:06:52,610
Is it eCrime?

181
00:06:52,610 --> 00:06:54,159
Is it targeted nation state?

182
00:06:54,159 --> 00:06:56,219
What is our attribution
confidence of e-Crime

183
00:06:56,219 --> 00:06:58,150
or targeted nation state?

184
00:06:58,150 --> 00:07:00,370
And so we've looked at
a few different tools.

185
00:07:00,370 --> 00:07:01,810
Obviously you have wonderful spreadsheets.

186
00:07:01,810 --> 00:07:03,470
We all love spreadsheets.

187
00:07:03,470 --> 00:07:06,530
The MITRE ATT&CK navigator
is great for visualizing it.

188
00:07:06,530 --> 00:07:08,520
We've settled on myths
for the last couple years.

189
00:07:08,520 --> 00:07:11,870
So the malware information

190
00:07:11,870 --> 00:07:14,919
sharing platform, ha ha I knew I'd get it.

191
00:07:14,919 --> 00:07:17,650
That's where we memorialize
a lot of our data

192
00:07:17,650 --> 00:07:19,669
and it is not perfect,
but it's worked well.

193
00:07:19,669 --> 00:07:21,020
We're actually right now in the process

194
00:07:21,020 --> 00:07:22,599
of building our own tool

195
00:07:22,599 --> 00:07:24,409
with our research and development team,

196
00:07:24,409 --> 00:07:26,919
because we need some
more specific use cases.

197
00:07:26,919 --> 00:07:27,919
But this is really important

198
00:07:27,919 --> 00:07:29,789
because what it allows us to do is

199
00:07:29,789 --> 00:07:31,979
look at trends over time, right?

200
00:07:31,979 --> 00:07:33,400
What verticals are targeted?

201
00:07:33,400 --> 00:07:35,188
What adversaries are
targeting those verticals?

202
00:07:35,189 --> 00:07:36,639
What are the techniques that you're using

203
00:07:36,639 --> 00:07:37,639
in those verticals,

204
00:07:37,639 --> 00:07:39,870
by those adversaries and
where they're successful?

205
00:07:39,870 --> 00:07:42,419
It allows us to ask a lot
of questions of the data

206
00:07:42,419 --> 00:07:45,979
to present a picture to the
other hunters, to our customers,

207
00:07:45,979 --> 00:07:48,300
what we're seeing, how we're stopping it,

208
00:07:48,300 --> 00:07:50,820
how we're growing and
developing our own team.

209
00:07:50,820 --> 00:07:54,330
And so just a quick example
of kind of how we do this.

210
00:07:54,330 --> 00:07:55,699
So we dig...

211
00:07:55,699 --> 00:08:00,319
Each intrusion event is
tracked as one MISP event

212
00:08:00,319 --> 00:08:02,229
and we will tag that with the metadata.

213
00:08:02,229 --> 00:08:05,830
So we have our, what we
call our intent tag, right?

214
00:08:05,830 --> 00:08:07,438
eCrime or targeted when it's known.

215
00:08:07,439 --> 00:08:10,449
The analyst, the customer vertical,

216
00:08:10,449 --> 00:08:13,810
operating system that was used,
our attribution confidence.

217
00:08:13,810 --> 00:08:15,910
We track the metric of
breakout time, right?

218
00:08:15,910 --> 00:08:18,300
So if we know the initial access

219
00:08:18,300 --> 00:08:20,819
and we don't use things
like valid accounts because

220
00:08:20,819 --> 00:08:22,289
they could have gotten
those from other means.

221
00:08:22,289 --> 00:08:23,688
But when we see that initial access

222
00:08:23,689 --> 00:08:26,270
from the time that they get on
a box to the time they move,

223
00:08:26,270 --> 00:08:27,870
we track that as breakout time.

224
00:08:27,870 --> 00:08:30,389
So that's tagged in there as well.

225
00:08:30,389 --> 00:08:32,289
We've modified the galaxies a little bit.

226
00:08:32,289 --> 00:08:34,919
So we've added specific
galaxies for our use case here.

227
00:08:34,919 --> 00:08:38,360
So we've got region,
sub region if we see it,

228
00:08:38,360 --> 00:08:40,870
malware and tools, those are lots of tag,

229
00:08:40,870 --> 00:08:42,830
Cobalt Strike, maybe Cats,
the ones that we all love

230
00:08:42,830 --> 00:08:44,680
and see all the time.

231
00:08:44,680 --> 00:08:45,890
The adversary as well.

232
00:08:45,890 --> 00:08:49,149
So if we have a named adversary
associated to that activity,

233
00:08:49,149 --> 00:08:51,670
we have that as a galaxy
and then the ATT&CK pattern.

234
00:08:51,670 --> 00:08:54,990
So MISP is really great, it
allows us to tag those things.

235
00:08:54,990 --> 00:08:57,520
There's some challenges
around MISP with how they

236
00:08:57,520 --> 00:09:01,930
update, keep, store and track
some of that information.

237
00:09:01,930 --> 00:09:03,880
We've worked around it as best we can

238
00:09:03,880 --> 00:09:06,760
but what it does is it allows
us to query all of that

239
00:09:06,760 --> 00:09:08,380
and build out pictures and trends.

240
00:09:08,380 --> 00:09:10,579
And so that's where I'm
gonna let Jason kind of

241
00:09:10,579 --> 00:09:12,130
dive into more specifics around.

242
00:09:12,130 --> 00:09:13,130
- [Jason] Alrighty.

243
00:09:13,130 --> 00:09:14,380
- Some of the stuff that we see.

244
00:09:14,380 --> 00:09:17,519
- So this intrusion was one...

245
00:09:17,519 --> 00:09:20,459
I was hunting around, I'm
like, what are some...

246
00:09:20,459 --> 00:09:22,209
We see a number of Linux intrusions,

247
00:09:22,209 --> 00:09:24,130
what would be interesting
to even talk about?

248
00:09:24,130 --> 00:09:26,560
'Cause I'm sure you've
all looked at intrusions

249
00:09:26,560 --> 00:09:29,069
where you're like, okay,
this was more the same.

250
00:09:29,070 --> 00:09:32,649
We really don't care that much about this.

251
00:09:32,649 --> 00:09:34,310
So I found this one I thought

252
00:09:34,310 --> 00:09:37,579
was interesting enough to bring up.

253
00:09:37,579 --> 00:09:40,920
Now we don't have any idea
who this threat actor is.

254
00:09:40,920 --> 00:09:42,640
There's no attribution.

255
00:09:42,640 --> 00:09:45,880
There was no telling whether
this was eCrime or whatnot

256
00:09:45,880 --> 00:09:47,820
from the information we had,

257
00:09:47,820 --> 00:09:51,279
maybe that changes over the
future but at this point

258
00:09:51,279 --> 00:09:55,779
they compromised a web
application running on Linux.

259
00:09:55,779 --> 00:09:59,639
And so they get going and start initiating

260
00:09:59,639 --> 00:10:00,680
their actions on objective.

261
00:10:00,680 --> 00:10:02,649
And so I'm watching this,

262
00:10:02,649 --> 00:10:05,261
as I'm going through
command line by command line

263
00:10:05,261 --> 00:10:06,430
to see what happened,

264
00:10:06,430 --> 00:10:08,899
you see this command
start really very close.

265
00:10:08,899 --> 00:10:10,560
There's a little bit of reconnaissance,

266
00:10:10,560 --> 00:10:12,630
but then they start off
with this fine command.

267
00:10:12,630 --> 00:10:15,189
They're looking for done
properties files on the system.

268
00:10:15,190 --> 00:10:16,829
So, okay, well that makes sense.

269
00:10:16,829 --> 00:10:19,829
I'm looking through and
tagging things back to,

270
00:10:19,829 --> 00:10:21,630
mapping it back to MITRE ATT&CK.

271
00:10:21,630 --> 00:10:24,360
Well, then we've got file
and directory discovery.

272
00:10:24,360 --> 00:10:25,910
We're crawling through the file system,

273
00:10:25,910 --> 00:10:27,670
see what we have that's interesting.

274
00:10:27,670 --> 00:10:29,180
This sounds an awful lot like what I did

275
00:10:29,180 --> 00:10:31,239
when I was penetration testing and I

276
00:10:31,240 --> 00:10:32,720
popped a system where I wanted to see,

277
00:10:32,720 --> 00:10:33,910
all right, what do I have?

278
00:10:33,910 --> 00:10:36,990
I don't even know what's going on here.

279
00:10:36,990 --> 00:10:39,630
So they find all the
property files on this system

280
00:10:39,630 --> 00:10:41,470
and this is just one example,

281
00:10:41,470 --> 00:10:44,399
looking at the Tomcats properties file.

282
00:10:44,399 --> 00:10:46,610
They're looking at data
from the local system.

283
00:10:46,610 --> 00:10:50,449
They actually spent about
30 minutes digging through

284
00:10:50,449 --> 00:10:52,670
different property files
after property file,

285
00:10:52,670 --> 00:10:56,310
after property and just
looking at this list.

286
00:10:56,310 --> 00:11:00,800
And finally, I think, and
this is just me guessing

287
00:11:00,800 --> 00:11:04,029
because I'm putting it kind
of my bias on this or whatever

288
00:11:04,029 --> 00:11:05,250
from doing this,

289
00:11:05,250 --> 00:11:06,820
they got really annoyed
with whatever they had

290
00:11:06,820 --> 00:11:08,000
for access to the system.

291
00:11:08,000 --> 00:11:11,580
They're like, man, we have
got to expand access to this.

292
00:11:11,580 --> 00:11:12,800
So let's pull down some tools

293
00:11:12,800 --> 00:11:14,670
and in this case they pull down what,

294
00:11:14,670 --> 00:11:20,040
or tried to pull down what
is likely reverse proxy.

295
00:11:20,040 --> 00:11:24,839
And, looks like some kind of
compromised WordPress site

296
00:11:24,839 --> 00:11:26,680
where they have this stored up there,

297
00:11:26,680 --> 00:11:31,290
they go to pull it down, you
see a pause on the timing,

298
00:11:31,290 --> 00:11:32,800
nothing happens.

299
00:11:32,800 --> 00:11:35,008
Oh yeah, don't check for the certificate.

300
00:11:35,009 --> 00:11:36,009
We got an error.

301
00:11:36,009 --> 00:11:38,209
It didn't work.

302
00:11:38,209 --> 00:11:39,589
(laughs)

303
00:11:39,589 --> 00:11:40,589
So they get it down.

304
00:11:40,589 --> 00:11:41,589
Great.

305
00:11:41,589 --> 00:11:43,649
Oh, we've got Ingres Tool Transfer.

306
00:11:43,649 --> 00:11:46,699
So now we've got this down
onto the system and I'm,

307
00:11:46,699 --> 00:11:50,649
dutifully mapping everything
out here trying to figure out,

308
00:11:50,649 --> 00:11:53,860
how am I gonna talk about this
later in report or anything

309
00:11:53,860 --> 00:11:55,860
that this comes up later.

310
00:11:55,860 --> 00:11:58,350
And so then now let's execute this.

311
00:11:58,350 --> 00:12:00,529
So far, and we're gonna execute our proxy.

312
00:12:00,529 --> 00:12:02,269
It didn't work.

313
00:12:02,269 --> 00:12:03,269
What happened?

314
00:12:03,269 --> 00:12:06,589
Oh yeah, I gotta add execute
permissions to the file.

315
00:12:06,589 --> 00:12:07,910
Oh, gun it.

316
00:12:07,910 --> 00:12:11,189
Beat it when that happens.

317
00:12:11,190 --> 00:12:13,389
And we've all seen probably
this in intrusions.

318
00:12:13,389 --> 00:12:15,240
You see somebody hop on a windows box,

319
00:12:15,240 --> 00:12:18,890
they run LS or they run
Cat and you're like,

320
00:12:18,890 --> 00:12:21,500
yeah, dude, I feel your pain.

321
00:12:21,500 --> 00:12:22,620
(all laugh)

322
00:12:22,620 --> 00:12:23,620
Right?

323
00:12:23,620 --> 00:12:24,620
But so then they,

324
00:12:24,620 --> 00:12:25,930
this is basically
modifying the file system

325
00:12:25,930 --> 00:12:28,530
permissions on the system.

326
00:12:28,530 --> 00:12:30,560
So that they can then
try and run their tooling

327
00:12:30,560 --> 00:12:32,739
and then they turn around
and try and execute it again.

328
00:12:32,740 --> 00:12:36,639
We're back to executing
the proxy application.

329
00:12:36,639 --> 00:12:38,649
Now they got a little
frustrated at this point

330
00:12:38,649 --> 00:12:40,870
because as it turned out,

331
00:12:40,870 --> 00:12:42,350
Falcon of course was running on this host.

332
00:12:42,350 --> 00:12:44,019
That's how we see the data in OverWatch

333
00:12:44,019 --> 00:12:47,150
as Falcon collects all this.

334
00:12:47,150 --> 00:12:49,180
It prevented it.

335
00:12:49,180 --> 00:12:51,359
And so they tried this a few
times and they went for a while

336
00:12:51,360 --> 00:12:52,529
and then they finally went, all right,

337
00:12:52,529 --> 00:12:55,660
this isn't working, now what?

338
00:12:55,660 --> 00:12:57,160
Let's go back with something simple.

339
00:12:57,160 --> 00:12:58,500
We'll just use bash.

340
00:12:58,500 --> 00:12:59,899
We'll use dev TCP.

341
00:12:59,899 --> 00:13:04,060
We'll connect out to
this host on port 99 99

342
00:13:04,060 --> 00:13:06,839
and see what happens here.

343
00:13:06,839 --> 00:13:09,110
We've got nonstandard port being used.

344
00:13:09,110 --> 00:13:11,120
We've got the capabilities of the command

345
00:13:11,120 --> 00:13:13,690
and scripting interpreter
being used as well as

346
00:13:13,690 --> 00:13:17,870
the Linux file system
and capability of the OS.

347
00:13:17,870 --> 00:13:19,519
Again, they got prevented and

348
00:13:19,519 --> 00:13:22,860
they tried this for
probably about 20 minutes

349
00:13:22,860 --> 00:13:25,820
and you're watching them
work their way through this.

350
00:13:25,820 --> 00:13:28,779
Finally, I don't know
where this file came from.

351
00:13:28,779 --> 00:13:29,939
And one of the interesting things

352
00:13:29,940 --> 00:13:30,959
about being a threat hunter

353
00:13:30,959 --> 00:13:34,399
is you don't always see all of the data.

354
00:13:34,399 --> 00:13:36,740
There's one thing that
was told to me early on

355
00:13:36,740 --> 00:13:40,209
made me feel a lot better
with Threat Hunting,

356
00:13:40,209 --> 00:13:42,888
an intrusion's never one event.

357
00:13:42,889 --> 00:13:44,889
If you miss one detection,

358
00:13:44,889 --> 00:13:47,180
you didn't miss an entire intrusion.

359
00:13:47,180 --> 00:13:49,089
A lot of stuff is happening.

360
00:13:49,089 --> 00:13:50,089
So, okay.

361
00:13:50,089 --> 00:13:53,230
We didn't have some visibility
to when this file got here,

362
00:13:53,230 --> 00:13:54,230
but shell.elf.

363
00:13:54,230 --> 00:13:59,670
Well, I'm gonna make some
guesses about what this is doing.

364
00:13:59,670 --> 00:14:01,889
I don't know for certain it's
running on somebody's system,

365
00:14:01,889 --> 00:14:04,170
it's not like I can pull it down and,

366
00:14:04,170 --> 00:14:06,500
or I don't have any access
to the end environment

367
00:14:06,500 --> 00:14:08,970
to pull down files,

368
00:14:08,970 --> 00:14:10,389
but it looks like we're trying to execute

369
00:14:10,389 --> 00:14:14,870
some kind of shell to, some
kind of custom compiled tool.

370
00:14:14,870 --> 00:14:17,670
They're using this underneath,

371
00:14:17,670 --> 00:14:20,029
again, the command scripting interpreter

372
00:14:20,029 --> 00:14:24,760
bash the uniq shell and
then this got prevented.

373
00:14:24,760 --> 00:14:26,519
Again, they tried a
number of different times

374
00:14:26,519 --> 00:14:27,959
to get this to go.

375
00:14:27,959 --> 00:14:32,339
And then they finally just
gave up and deleted the file.

376
00:14:32,339 --> 00:14:34,639
And quasi cleaned up after themself.

377
00:14:34,639 --> 00:14:37,920
The amusing thing is they
just deleted the one file,

378
00:14:37,920 --> 00:14:41,329
the INI file for fast reverse
proxy, the binary there,

379
00:14:41,330 --> 00:14:45,980
yeah, that stayed on the system.

380
00:14:45,980 --> 00:14:48,980
The funny part is that this intrusion,

381
00:14:48,980 --> 00:14:51,920
they stopped for the day.

382
00:14:51,920 --> 00:14:53,378
The next day they come back

383
00:14:53,379 --> 00:14:56,160
and they spent several hours again,

384
00:14:56,160 --> 00:14:58,360
trying to get something to run on this.

385
00:14:58,360 --> 00:15:01,350
Now the thing that I thought
was funny about this,

386
00:15:01,350 --> 00:15:03,279
and I can recognize myself in this,

387
00:15:03,279 --> 00:15:05,920
you get so fixated on
what you're trying to do,

388
00:15:05,920 --> 00:15:08,219
that you don't stop and think, well,

389
00:15:08,220 --> 00:15:09,779
why am I trying to get...

390
00:15:09,779 --> 00:15:12,069
I mean, they already had
access to the system,

391
00:15:12,069 --> 00:15:14,640
what are some of the things
they could have done on this?

392
00:15:14,640 --> 00:15:15,640
I don't know.

393
00:15:15,640 --> 00:15:17,779
They got tunnel vision though on,

394
00:15:17,779 --> 00:15:21,089
I gotta get a reverse shell running

395
00:15:21,089 --> 00:15:24,350
and then they finally
gave up and went away.

396
00:15:24,350 --> 00:15:27,550
We're notifying the customer
throughout all of this

397
00:15:27,550 --> 00:15:28,729
and getting them to respond.

398
00:15:28,730 --> 00:15:31,820
So hopefully they got them
contained and cleared out.

399
00:15:31,820 --> 00:15:34,730
But this is our process
there as we're going to see

400
00:15:34,730 --> 00:15:37,699
command line by command line,
what the adversary's doing,

401
00:15:37,699 --> 00:15:40,839
now, we're endpoint centric, right?

402
00:15:40,839 --> 00:15:42,990
Selena already talked a
little bit earlier about

403
00:15:42,990 --> 00:15:44,920
things that they see at Proofpoint.

404
00:15:44,920 --> 00:15:49,810
We have the things that
we see in our data set

405
00:15:49,810 --> 00:15:54,310
and so our graphs or the
things that we're seeing

406
00:15:54,310 --> 00:15:55,829
are gonna vary a little bit.

407
00:15:55,829 --> 00:15:58,269
That's fine.

408
00:15:58,269 --> 00:16:01,350
But this is our process for
going through and seeing,

409
00:16:01,350 --> 00:16:03,560
okay, what is this adversary doing?

410
00:16:03,560 --> 00:16:05,060
And then we come back later,

411
00:16:05,060 --> 00:16:09,420
the hunters, they're trying
to move at speed here.

412
00:16:09,420 --> 00:16:10,939
And so they've got to notify the customer

413
00:16:10,939 --> 00:16:14,110
as fast as they can whereas for us,

414
00:16:14,110 --> 00:16:16,279
we can spend a little bit
more time doing the analysis.

415
00:16:16,279 --> 00:16:18,009
All of this is going, being captured,

416
00:16:18,009 --> 00:16:20,970
put into MISP and memorializing that there

417
00:16:20,970 --> 00:16:23,269
so that we can go back and
do reports on it later.

418
00:16:23,269 --> 00:16:26,910
Now this is, I don't expect
anybody to read this.

419
00:16:26,910 --> 00:16:27,910
(laughs)

420
00:16:27,910 --> 00:16:29,759
Really just pay attention
to some of the shading here.

421
00:16:29,759 --> 00:16:32,290
This is Q1 2021.

422
00:16:32,290 --> 00:16:33,529
And just kind of what was popular.

423
00:16:33,529 --> 00:16:36,270
There you're seeing ballot
accounts are being used

424
00:16:36,270 --> 00:16:39,480
in the command and scripting
interpreter uniq shell,

425
00:16:39,480 --> 00:16:43,660
things moved around a little
bit in Q1 of 2022 instead.

426
00:16:43,660 --> 00:16:45,410
So, it's kind of interesting

427
00:16:45,410 --> 00:16:47,990
to just sit here and just kind of

428
00:16:47,990 --> 00:16:50,290
see some of the movement.

429
00:16:50,290 --> 00:16:51,310
Why did this happen?

430
00:16:51,310 --> 00:16:52,310
What was going on?

431
00:16:52,310 --> 00:16:53,310
What are some of the differences?

432
00:16:53,310 --> 00:16:56,339
We can dive into that
a little bit further.

433
00:16:56,339 --> 00:16:57,600
And in this case,

434
00:16:57,600 --> 00:17:03,189
we've got Q1 2021 on the
right on the left, excuse me.

435
00:17:03,189 --> 00:17:05,938
And then on the right, we have 2022,

436
00:17:05,939 --> 00:17:10,520
I focused just on a few items here.

437
00:17:10,520 --> 00:17:13,030
We actually initially broke
out all the differences out

438
00:17:13,030 --> 00:17:15,010
and it was probably too much.

439
00:17:15,010 --> 00:17:17,500
But some interesting
things to me here was,

440
00:17:17,500 --> 00:17:20,599
at the top we have valid accounts is being

441
00:17:20,599 --> 00:17:24,760
one of the most
predominant defense evasion

442
00:17:24,760 --> 00:17:25,780
areas of the heat map.

443
00:17:25,780 --> 00:17:31,100
We go to 2022 defense
that's actually swapped.

444
00:17:31,100 --> 00:17:32,370
More cleanup is occurring.

445
00:17:32,370 --> 00:17:35,310
The adversaries are doing
a little bit more cleanup.

446
00:17:35,310 --> 00:17:36,889
Why is that?

447
00:17:36,890 --> 00:17:39,170
Is that interesting?

448
00:17:39,170 --> 00:17:40,720
And that's where we
start doing our analysis

449
00:17:40,720 --> 00:17:42,610
when we're doing our reports,

450
00:17:42,610 --> 00:17:44,120
start to look at what's happening.

451
00:17:44,120 --> 00:17:49,570
Is there a trend that
occurred here along the way?

452
00:17:49,570 --> 00:17:53,679
What has gone on that makes
this interesting to us.

453
00:17:53,680 --> 00:17:55,940
And what do we think that it
tells us about the adversary?

454
00:17:55,940 --> 00:17:57,480
One of the things I like
to say is that every

455
00:17:57,480 --> 00:17:59,810
time an adversary runs a command,

456
00:17:59,810 --> 00:18:01,419
they tell us something about themselves,

457
00:18:01,420 --> 00:18:03,790
about what they're trying to do,

458
00:18:03,790 --> 00:18:06,909
what their goals are and stuff like that.

459
00:18:06,910 --> 00:18:08,670
Credential access, you
see unsecured credentials

460
00:18:08,670 --> 00:18:11,520
being the primarily area where we saw

461
00:18:11,520 --> 00:18:13,920
them looking for a password,
being stored somewhere,

462
00:18:13,920 --> 00:18:17,260
something like bash history
or files on the system.

463
00:18:17,260 --> 00:18:19,690
Swapped a little bit in 2022,

464
00:18:19,690 --> 00:18:22,660
we see a little bit
more access going after

465
00:18:22,660 --> 00:18:26,340
Etsy shadow and Etsy password.

466
00:18:26,340 --> 00:18:27,510
Systems are being compromised with,

467
00:18:27,510 --> 00:18:29,590
they maybe running with
privileges that they shouldn't,

468
00:18:29,590 --> 00:18:32,500
or they're elevating their privileges.

469
00:18:32,500 --> 00:18:34,460
So we can see a little
bit of movement here.

470
00:18:34,460 --> 00:18:37,620
And that allows us to just kind of

471
00:18:37,620 --> 00:18:40,750
use MITRE ATT&CK to see how things

472
00:18:40,750 --> 00:18:41,930
are changing over the time.

473
00:18:41,930 --> 00:18:45,090
If I'm trying to dig
individual command lines,

474
00:18:45,090 --> 00:18:50,340
this can be very
overwhelming, very quickly.

475
00:18:50,340 --> 00:18:53,649
Some trends that I noticed as I was just

476
00:18:53,650 --> 00:18:57,800
kind of looking at 2022,
the most recent data.

477
00:18:57,800 --> 00:18:59,570
What are we seeing adversaries do?

478
00:18:59,570 --> 00:19:01,990
And this is all Linux centric.

479
00:19:01,990 --> 00:19:04,840
What are we seeing here?

480
00:19:04,840 --> 00:19:07,919
What I've seen is as I've
reviewed the data was,

481
00:19:07,920 --> 00:19:09,970
hey, we have a little
bit more exploitation

482
00:19:09,970 --> 00:19:12,020
of some kind of web application.

483
00:19:12,020 --> 00:19:16,340
We're reasonably certain as
a public facing application

484
00:19:16,340 --> 00:19:17,340
for the initial access.

485
00:19:17,340 --> 00:19:19,709
Of course the uniq shell
is gonna be involved

486
00:19:19,710 --> 00:19:22,160
for any of this stuff.

487
00:19:22,160 --> 00:19:24,220
As they're executing
commands underneath it,

488
00:19:24,220 --> 00:19:26,950
you see 'em trying to establish
persistence with web shells.

489
00:19:26,950 --> 00:19:31,560
Now that is pretty consistent
across windows or Linux,

490
00:19:31,560 --> 00:19:34,129
but that is definitely
one you'll see happen.

491
00:19:34,130 --> 00:19:35,680
Defensive agent, they're going out

492
00:19:35,680 --> 00:19:38,090
and they're trying to clear
their command histories,

493
00:19:38,090 --> 00:19:40,179
they'll delete files that they drop.

494
00:19:40,180 --> 00:19:41,850
Usually rather haphazardly,

495
00:19:41,850 --> 00:19:43,909
occasionally you run
into a very conscientious

496
00:19:43,910 --> 00:19:46,520
adversary that you
watch go back and delete

497
00:19:46,520 --> 00:19:49,210
everything that they
dropped on the system.

498
00:19:49,210 --> 00:19:50,590
But that's actually a
little bit more rare.

499
00:19:50,590 --> 00:19:52,470
- And I'd say one thing
that I find interesting,

500
00:19:52,470 --> 00:19:54,220
at least when I look at the data is

501
00:19:54,220 --> 00:19:56,310
that clearing command
history, clearing logs

502
00:19:56,310 --> 00:19:57,820
happens more on,

503
00:19:57,820 --> 00:20:00,179
that I've noticed on Linux
than it does on windows.

504
00:20:00,180 --> 00:20:01,180
- Yeah.

505
00:20:01,180 --> 00:20:02,210
- I don't know what it is about.

506
00:20:02,210 --> 00:20:04,170
Just maybe they're more
comfortable with the Linux logging

507
00:20:04,170 --> 00:20:06,760
or, but I've noticed a lot
times that defensive agent,

508
00:20:06,760 --> 00:20:09,060
those clearing system logs
comes much more on Linux

509
00:20:09,060 --> 00:20:10,980
than it does on a window system.

510
00:20:10,980 --> 00:20:11,980
- Yep.

511
00:20:11,980 --> 00:20:12,980
Yeah.

512
00:20:12,980 --> 00:20:17,780
And yeah, you do see
those variations between

513
00:20:17,780 --> 00:20:20,010
what an actor is comfortable
with on one environment

514
00:20:20,010 --> 00:20:23,040
versus another environment
and you just, I don't know,

515
00:20:23,040 --> 00:20:26,070
I find it to be kind of
fascinating to see how this goes.

516
00:20:26,070 --> 00:20:29,570
Again, our credential access
I've already commented,

517
00:20:29,570 --> 00:20:31,200
access for Etsy shadow and Etsy password

518
00:20:31,200 --> 00:20:32,280
has bumped up a little bit,

519
00:20:32,280 --> 00:20:35,889
but you still see him
looking through bash history.

520
00:20:35,890 --> 00:20:38,890
How many shell scripts
have you seen in your time

521
00:20:38,890 --> 00:20:42,030
working that required you
to type the password into

522
00:20:42,030 --> 00:20:44,360
command line as you want.

523
00:20:44,360 --> 00:20:45,990
Because

524
00:20:45,990 --> 00:20:50,540
we just cobbled this thing
together so there we go.

525
00:20:50,540 --> 00:20:52,490
And we log all of this.

526
00:20:52,490 --> 00:20:53,490
Lateral movement.

527
00:20:53,490 --> 00:20:54,490
If it's on Linux,

528
00:20:54,490 --> 00:20:55,990
typically you're gonna see
this happening via SSH.

529
00:20:55,990 --> 00:20:57,460
If they can steal credentials,

530
00:20:57,460 --> 00:20:58,810
they can do some password cracking.

531
00:20:58,810 --> 00:21:01,330
Sometimes you see 'em get
a hold of private keys.

532
00:21:01,330 --> 00:21:03,060
They try and use that to move laterally

533
00:21:03,060 --> 00:21:07,909
to other hosts via SSH, a
lot of collection and every,

534
00:21:07,910 --> 00:21:09,260
very consistently you're seeing tools

535
00:21:09,260 --> 00:21:13,510
being dropped into the hosts.

536
00:21:13,510 --> 00:21:14,580
Why are we doing this?

537
00:21:14,580 --> 00:21:17,560
What are the benefits to all of this work?

538
00:21:17,560 --> 00:21:20,169
I mean, we're putting it all into MISP,

539
00:21:20,170 --> 00:21:23,350
we have some different tools
wrapped around this to try and

540
00:21:23,350 --> 00:21:29,570
extract data out of it
to use, what's the point?

541
00:21:29,570 --> 00:21:31,950
One thing is it allows
us to go back and see

542
00:21:31,950 --> 00:21:33,770
if something interesting has happened.

543
00:21:33,770 --> 00:21:37,490
Something interesting
has changed over time.

544
00:21:37,490 --> 00:21:40,050
You're in the thick of it.

545
00:21:40,050 --> 00:21:42,620
Just kind of doing your day to day work

546
00:21:42,620 --> 00:21:44,409
and wherever that may be,

547
00:21:44,410 --> 00:21:46,820
for us, it's intrusion analysis
for the threat hunters,

548
00:21:46,820 --> 00:21:48,790
it's detecting whatever
is currently happening

549
00:21:48,790 --> 00:21:52,800
and you don't necessarily
know what's changed over time

550
00:21:52,800 --> 00:21:54,930
'cause you're just focused
right here and right now,

551
00:21:54,930 --> 00:21:56,630
maybe last week or last month,

552
00:21:56,630 --> 00:21:58,650
but that's about the end of it.

553
00:21:58,650 --> 00:22:00,220
So using that, go back to that heat map

554
00:22:00,220 --> 00:22:03,480
that allows me to see
something is changed here.

555
00:22:03,480 --> 00:22:04,530
Why did it change?

556
00:22:04,530 --> 00:22:06,020
Did something new pop out of this?

557
00:22:06,020 --> 00:22:09,000
So you can dig into that.

558
00:22:09,000 --> 00:22:10,170
One thing that I really like

559
00:22:10,170 --> 00:22:14,690
with ATT&CK is it gives us

560
00:22:14,690 --> 00:22:19,150
a very consistent way to
talk about what we're seeing

561
00:22:19,150 --> 00:22:21,280
to different audiences.

562
00:22:21,280 --> 00:22:23,560
The technology folks have
pretty well gotten into this,

563
00:22:23,560 --> 00:22:25,409
though they'll always want
to see the command lines

564
00:22:25,410 --> 00:22:29,710
and whatnot as much as we can,
but if I'm talking to a CSO,

565
00:22:29,710 --> 00:22:33,820
they don't care that
much about that detail.

566
00:22:33,820 --> 00:22:34,840
They just wanna know,

567
00:22:34,840 --> 00:22:37,260
kind of the high level,
tell me what's going on.

568
00:22:37,260 --> 00:22:38,370
And I say customers up here

569
00:22:38,370 --> 00:22:40,510
because that's what I was thinking of as

570
00:22:40,510 --> 00:22:44,030
my typical audience but for
you and your organization,

571
00:22:44,030 --> 00:22:49,139
who are your stakeholders,
who are your customers

572
00:22:49,140 --> 00:22:51,310
that you need to be communicating with?

573
00:22:51,310 --> 00:22:53,360
And that may be

574
00:22:53,360 --> 00:22:58,719
the CSO in your environment, or it may be

575
00:22:58,720 --> 00:23:02,490
an auditor that's come in or whoever it is

576
00:23:02,490 --> 00:23:04,870
that you're briefing on something.

577
00:23:04,870 --> 00:23:08,679
And so this gives us that ability

578
00:23:08,680 --> 00:23:11,880
to normalize on what
we're doing and when I say

579
00:23:11,880 --> 00:23:18,690
doing something like
Ingress Tool Transfer,

580
00:23:18,690 --> 00:23:21,010
the other person who is
familiar with MITRE ATT&CK

581
00:23:21,010 --> 00:23:22,550
has an idea of what that means.

582
00:23:22,550 --> 00:23:25,740
And I don't have to fumble
around for words and

583
00:23:25,740 --> 00:23:29,100
they're trying to interpret
what I meant to say.

584
00:23:29,100 --> 00:23:34,620
And for us, it facilitates
our public reporting as well.

585
00:23:34,620 --> 00:23:37,610
Lot of companies are
doing public reporting.

586
00:23:37,610 --> 00:23:40,629
For us and our team on Outreach,

587
00:23:40,630 --> 00:23:42,460
our annual Threat Hunting Report

588
00:23:42,460 --> 00:23:45,060
is our big public report that we do.

589
00:23:45,060 --> 00:23:50,480
Here's the name of our
2021 Threat Hunting Report,

590
00:23:50,480 --> 00:23:53,970
you can always Google that
and go take a look at that.

591
00:23:53,970 --> 00:23:57,590
But that was a look back at
the previous year and see,

592
00:23:57,590 --> 00:23:58,860
what have we been seeing?

593
00:23:58,860 --> 00:23:59,949
What's changed over time?

594
00:23:59,950 --> 00:24:03,630
What are some meanings that
we can extract from that?

595
00:24:03,630 --> 00:24:06,630
We've definitely found that
it's not an exact science

596
00:24:06,630 --> 00:24:09,470
by any stretch, because
as we've already said,

597
00:24:09,470 --> 00:24:10,850
we'll hop on Slack and we're like,

598
00:24:10,850 --> 00:24:12,560
hey, what do you think about this?

599
00:24:12,560 --> 00:24:16,010
Oh, I don't know, let me dig
around and we will hunt around.

600
00:24:16,010 --> 00:24:18,320
But through that consensus, it allows us

601
00:24:18,320 --> 00:24:21,350
basically to better communicate
what adversaries are doing

602
00:24:21,350 --> 00:24:23,070
and then hopefully inform our customers

603
00:24:23,070 --> 00:24:25,210
what they need to do to respond to that.

604
00:24:25,210 --> 00:24:26,930
Where do they need to
show up their defenses?

605
00:24:26,930 --> 00:24:31,240
Hey, could we detect this
in our environment or not?

606
00:24:31,240 --> 00:24:33,900
So these are some of the
benefits to use a MITRE ATT&CK.

607
00:24:33,900 --> 00:24:35,230
That's why we go through this work

608
00:24:35,230 --> 00:24:37,470
and why we find this to be useful

609
00:24:37,470 --> 00:24:39,300
and hopefully our customers do as well.

610
00:24:39,300 --> 00:24:41,990
I've gotten some good
feedback from them on this.

611
00:24:41,990 --> 00:24:46,270
And with that, I think
that's what we have,

612
00:24:46,270 --> 00:24:48,100
we'll go to some questions.

613
00:24:48,100 --> 00:24:49,889
- First off.

614
00:24:49,890 --> 00:24:51,680
Oh, yeah.

615
00:24:51,680 --> 00:24:53,460
(audience applauding)

616
00:24:53,460 --> 00:24:56,150
Give it up.

617
00:24:56,150 --> 00:24:57,930
Great job.

618
00:24:57,930 --> 00:24:59,490
So while we give folks in
the room a couple minutes

619
00:24:59,490 --> 00:25:00,640
to maybe think about some questions,

620
00:25:00,640 --> 00:25:02,940
I think we have a little bit of time here.

621
00:25:02,940 --> 00:25:05,270
Really good note and feedback
I was getting from Slack was,

622
00:25:05,270 --> 00:25:07,900
the appreciation for,
the way you're reporting,

623
00:25:07,900 --> 00:25:09,240
not just tactics and techniques,

624
00:25:09,240 --> 00:25:11,640
but really getting down
into the procedures.

625
00:25:11,640 --> 00:25:13,300
What advice would you give for

626
00:25:13,300 --> 00:25:16,649
Intel producers or anyone
doing IR or Threat Hunting

627
00:25:16,650 --> 00:25:19,530
and their producing these
products and how to really

628
00:25:19,530 --> 00:25:20,920
make the most of including
those procedures?

629
00:25:20,920 --> 00:25:22,550
Like, is there any tips and tricks,

630
00:25:22,550 --> 00:25:29,370
lesson learned that you
can share with the crowd?

631
00:25:29,370 --> 00:25:34,300
- So probably the biggest, the
first advice comes to mind,

632
00:25:34,300 --> 00:25:36,580
Selena already commented
on earlier today was,

633
00:25:36,580 --> 00:25:38,460
who is your audience?

634
00:25:38,460 --> 00:25:40,670
Who are you writing this to?

635
00:25:40,670 --> 00:25:43,620
If I'm in an IR report and I'm,

636
00:25:43,620 --> 00:25:46,510
there's something I'm gonna have

637
00:25:46,510 --> 00:25:48,879
to communicate to executives

638
00:25:48,880 --> 00:25:51,600
and there's something I'm
gonna have to communicate

639
00:25:51,600 --> 00:25:55,699
to the technology people so
that they can learn from that.

640
00:25:55,700 --> 00:25:57,550
So a lot of times when we're going through

641
00:25:57,550 --> 00:26:01,200
our reporting, we're trying
to keep that in mind.

642
00:26:01,200 --> 00:26:04,360
When I finish writing
something up for our report,

643
00:26:04,360 --> 00:26:07,639
I really spent some time trying
to think about my conc...

644
00:26:07,640 --> 00:26:08,640
What's the point?

645
00:26:08,640 --> 00:26:10,190
I just talked about this cool intrusion.

646
00:26:10,190 --> 00:26:11,190
What does this matter?

647
00:26:11,190 --> 00:26:13,550
What can you take away from
this in your environment?

648
00:26:13,550 --> 00:26:15,049
What do I want the reader to think of?

649
00:26:15,049 --> 00:26:16,049
- Yeah, yeah.

650
00:26:16,049 --> 00:26:18,220
Like I would, Selena said about bias.

651
00:26:18,220 --> 00:26:19,870
Like my bias is I wanna
see the command line.

652
00:26:19,870 --> 00:26:21,969
I wanna know exactly what they're doing,

653
00:26:21,970 --> 00:26:23,220
because that's more interesting but

654
00:26:23,220 --> 00:26:25,610
a lot of times that may not be relevant

655
00:26:25,610 --> 00:26:26,821
to the person reading it.

656
00:26:26,821 --> 00:26:29,189
And so know when that procedure...

657
00:26:29,190 --> 00:26:30,970
Like if that command line says something

658
00:26:30,970 --> 00:26:33,330
about the intent, says
something about the capability,

659
00:26:33,330 --> 00:26:34,820
it may be valuable, whereas if it's

660
00:26:34,820 --> 00:26:37,360
a command line you've
seen 10, 15, 20 times,

661
00:26:37,360 --> 00:26:39,139
it may not have any utility in that report

662
00:26:39,140 --> 00:26:40,650
or someone may just say,
okay, that's cool but

663
00:26:40,650 --> 00:26:42,820
I can't write a detection for that

664
00:26:42,820 --> 00:26:44,760
or that doesn't tell me
anything about the adversary

665
00:26:44,760 --> 00:26:46,330
then you probably don't
need to include it.

666
00:26:46,330 --> 00:26:48,639
So know when the detail is actionable

667
00:26:48,640 --> 00:26:49,760
and know when it's just fluff

668
00:26:49,760 --> 00:26:52,460
that you wanna toss in
there 'cause it looks cool.

669
00:26:52,460 --> 00:26:53,600
- Any questions from the room?

670
00:26:53,600 --> 00:27:02,560
Actually, we'll start right up front.

671
00:27:02,560 --> 00:27:03,560
- [Attendee] Yeah, do you
have examples of (indistinct)

672
00:27:03,560 --> 00:27:04,560
that I was speaking my world (indistinct).

673
00:27:04,560 --> 00:27:05,560
- There is absolutely a lot of nest, yeah.

674
00:27:05,560 --> 00:27:06,560
- [Attendee] There's importance
to value in capturing

675
00:27:06,560 --> 00:27:07,560
kinda which techniques we used together,

676
00:27:07,560 --> 00:27:13,020
kinda the sequence they
use or is it more just

677
00:27:13,020 --> 00:27:17,100
technique or something in the toolbox?

678
00:27:17,100 --> 00:27:20,899
- So quick recap for the online audience,

679
00:27:20,900 --> 00:27:24,530
the observation was that
a lot of the intrusions

680
00:27:24,530 --> 00:27:26,620
that you were analyzing
don't necessarily flow

681
00:27:26,620 --> 00:27:28,689
from left to right or
sequential, it's a lot of

682
00:27:28,690 --> 00:27:31,660
looping or within the matrix
or moving around a little bit.

683
00:27:31,660 --> 00:27:33,130
And that's something
we've done intentionally

684
00:27:33,130 --> 00:27:35,990
in terms of not prescribing
a sequence, the tactics,

685
00:27:35,990 --> 00:27:38,040
but what are your observations
and what are your takes

686
00:27:38,040 --> 00:27:42,370
in terms of, how do you
process and deal with that?

687
00:27:42,370 --> 00:27:43,780
- So we do that...

688
00:27:43,780 --> 00:27:45,220
It's kind of interesting as you look at

689
00:27:45,220 --> 00:27:46,830
the different analysts and how they do it.

690
00:27:46,830 --> 00:27:48,780
I am very time driven.

691
00:27:48,780 --> 00:27:50,740
I will sort out all the command lines

692
00:27:50,740 --> 00:27:54,040
and I'm just gonna pick
through these things in order

693
00:27:54,040 --> 00:27:55,649
and make my notes accordingly on it.

694
00:27:55,650 --> 00:27:57,830
One of the things we do
to try and capture that

695
00:27:57,830 --> 00:28:00,840
and add some context to
that is we try and write

696
00:28:00,840 --> 00:28:04,120
a summary of what happened
around this, kind of a narrative,

697
00:28:04,120 --> 00:28:06,080
even for our notes.

698
00:28:06,080 --> 00:28:09,520
So that if Justin enriches something

699
00:28:09,520 --> 00:28:11,410
and I have to look at this later,

700
00:28:11,410 --> 00:28:13,730
I can look at his summary
and get kind of a flow

701
00:28:13,730 --> 00:28:16,830
for how the intrusion went and
you can see them jump around

702
00:28:16,830 --> 00:28:20,490
for the techniques.

703
00:28:20,490 --> 00:28:24,070
So that's one way that
we work to address that.

704
00:28:24,070 --> 00:28:25,110
Is it perfect?

705
00:28:25,110 --> 00:28:27,449
No, we're working on
trying to improve that

706
00:28:27,450 --> 00:28:30,080
because some of these
intrusions get rather complex.

707
00:28:30,080 --> 00:28:31,820
- And that's where that,

708
00:28:31,820 --> 00:28:33,450
like MISP has been really good for us

709
00:28:33,450 --> 00:28:35,500
for the past couple of years,
the challenge has been,

710
00:28:35,500 --> 00:28:37,360
it doesn't allow us to collate

711
00:28:37,360 --> 00:28:40,050
the time that that tactic was leveraged.

712
00:28:40,050 --> 00:28:41,649
And so the tool that
we're working on building

713
00:28:41,650 --> 00:28:43,760
is gonna bring in that time based analysis

714
00:28:43,760 --> 00:28:47,021
where you can take a command
line, tag the technique to it,

715
00:28:47,021 --> 00:28:49,090
with the timestamp and
then start to move through

716
00:28:49,090 --> 00:28:50,350
and say, okay, yeah.

717
00:28:50,350 --> 00:28:52,939
So they did some discovery,
tried to do some persistence,

718
00:28:52,940 --> 00:28:55,370
went back to discovery
and see that movement.

719
00:28:55,370 --> 00:28:57,570
Right now, it's just,
here's the data and then

720
00:28:57,570 --> 00:28:59,928
the write up is really where
that narrative comes out.

721
00:28:59,929 --> 00:29:01,890
- And then hopefully we see the...

722
00:29:01,890 --> 00:29:02,890
Oh sorry.

723
00:29:02,890 --> 00:29:04,050
Hopefully then, we'll see that

724
00:29:04,050 --> 00:29:06,110
in the products that we're producing,

725
00:29:06,110 --> 00:29:07,110
'cause that'll allow us
to speak more to that.

726
00:29:07,110 --> 00:29:09,479
- And I love what you said earlier about,

727
00:29:09,480 --> 00:29:10,550
the attackers aren't perfect.

728
00:29:10,550 --> 00:29:12,060
They're making mistakes,
we're watching those,

729
00:29:12,060 --> 00:29:13,060
but neither is defenders,

730
00:29:13,060 --> 00:29:14,639
we don't have that
expectation of needing to see

731
00:29:14,640 --> 00:29:18,630
every bit of data and every
single technique versus,

732
00:29:18,630 --> 00:29:20,620
working with what we have
and making the most of it.

733
00:29:20,620 --> 00:29:22,189
So I think we're coming up on time,

734
00:29:22,190 --> 00:29:23,940
but I did have one really
interesting question

735
00:29:23,940 --> 00:29:26,360
from Slack that I wanted
to run by you was,

736
00:29:26,360 --> 00:29:28,790
in the course of an investigation
or any of your processes,

737
00:29:28,790 --> 00:29:32,710
if you see a technique that
you can't map to ATT&CK,

738
00:29:32,710 --> 00:29:35,470
what would be your reaction
or what would you do?

739
00:29:35,470 --> 00:29:38,090
- That's normally where the
Slack discussion gets hot and

740
00:29:38,090 --> 00:29:39,199
heavy is all right.

741
00:29:39,200 --> 00:29:40,200
Where does this fit?

742
00:29:40,200 --> 00:29:41,400
What do we do?

743
00:29:41,400 --> 00:29:45,490
We have a process on the
team where if it doesn't fit,

744
00:29:45,490 --> 00:29:47,640
we bring it to the wider team.

745
00:29:47,640 --> 00:29:49,440
So obviously we're across the Globes,

746
00:29:49,440 --> 00:29:51,940
we've got folks in Australia, UK, America.

747
00:29:51,940 --> 00:29:53,940
And so like normally when we're working,

748
00:29:53,940 --> 00:29:55,310
we're in the similar time zones,

749
00:29:55,310 --> 00:29:56,840
so we'll bring to the whole team

750
00:29:56,840 --> 00:29:58,379
and then that's where
that discussion comes up.

751
00:29:58,380 --> 00:29:59,950
Should this be something
that we surface up?

752
00:29:59,950 --> 00:30:02,170
So one of our analysts in
Australia is working on

753
00:30:02,170 --> 00:30:05,460
something to submit
something we came across.

754
00:30:05,460 --> 00:30:06,460
- Right.

755
00:30:06,460 --> 00:30:07,460
And I can't remember what the details are

756
00:30:07,460 --> 00:30:10,429
off top of our head, but it was some-

757
00:30:10,429 --> 00:30:11,429
- RDP.

758
00:30:11,429 --> 00:30:12,530
- Yeah, it was around
RDP and some use of it,

759
00:30:12,530 --> 00:30:16,840
but it didn't fit in really
well with how things were.

760
00:30:16,840 --> 00:30:18,919
So he's like, well, wouldn't
it make sense to submit this

761
00:30:18,920 --> 00:30:20,830
and we're like, go forth.

762
00:30:20,830 --> 00:30:21,830
(all laugh)

763
00:30:21,830 --> 00:30:22,830
Do it.

764
00:30:22,830 --> 00:30:23,970
- Shameless plug, we'd
love to make that slide

765
00:30:23,970 --> 00:30:25,900
Adam showed earlier much bigger.

766
00:30:25,900 --> 00:30:27,630
So definitely keep those
contributions coming.

767
00:30:27,630 --> 00:30:29,700
But with that, thank you again.

768
00:30:29,700 --> 00:30:30,700
And we will reintroduce

769
00:30:30,700 --> 00:30:32,520
our MC to introduce our next speakers.

770
00:30:32,520 --> 00:30:33,520
Thank you.

771
00:30:33,520 --> 00:30:33,600
(audience applauding)

