1
00:00:11,920 --> 00:00:14,340
- So next speaker of the
session is gonna be Fred Frey

2
00:00:14,340 --> 00:00:17,890
and Jonathan Mulholland from SnapAttack.

3
00:00:17,890 --> 00:00:21,160
So atomic red team open source
project has a long history

4
00:00:21,160 --> 00:00:24,250
on the ATT&CKcon stage with a presentation

5
00:00:24,250 --> 00:00:27,529
at the first one back in 2018.

6
00:00:27,529 --> 00:00:28,529
Sigma's another project that

7
00:00:28,529 --> 00:00:30,620
has had a lot of mentions here.

8
00:00:30,620 --> 00:00:34,330
And so the next talk is gonna
take a look at smashing,

9
00:00:34,330 --> 00:00:36,170
their term,

10
00:00:36,170 --> 00:00:39,370
these tools together to take
a look at the best analytics

11
00:00:39,370 --> 00:00:40,370
to apply.

12
00:00:40,370 --> 00:00:42,190
So please welcome to the
stage Fred and Jonathan.

13
00:00:42,190 --> 00:00:43,949
(crowd applauding)

14
00:00:43,950 --> 00:00:45,710
- [Jonathan] Okay.

15
00:00:45,710 --> 00:00:48,350
- [Fred] All right.

16
00:00:48,350 --> 00:00:50,110
Welcome everybody.

17
00:00:50,110 --> 00:00:52,750
How's everybody doing?

18
00:00:52,750 --> 00:00:55,490
Everybody having a good time so far?

19
00:00:55,490 --> 00:00:56,600
(indistinct response from crowd)

20
00:00:56,600 --> 00:00:57,600
All right.

21
00:00:57,600 --> 00:00:58,600
Awesome.

22
00:00:58,600 --> 00:00:59,600
All right, very good.

23
00:00:59,600 --> 00:01:00,600
So yeah, we're a new company.

24
00:01:00,600 --> 00:01:01,600
We're about four to five months old

25
00:01:01,600 --> 00:01:04,540
and we have a community
release that we're gonna be

26
00:01:04,540 --> 00:01:05,540
doing today.

27
00:01:05,540 --> 00:01:06,540
So we're really excited
to share some of our

28
00:01:06,540 --> 00:01:07,590
data science research.

29
00:01:07,590 --> 00:01:09,420
We're gonna be releasing
a lot of data sets,

30
00:01:09,420 --> 00:01:12,280
to hopefully drive forward
the detection community

31
00:01:12,280 --> 00:01:14,990
and red teams and blue
teams working together.

32
00:01:14,990 --> 00:01:18,829
Okay so for introductions,
my name is Fred Frey.

33
00:01:18,829 --> 00:01:23,000
I've been around InfoSec
for probably over 20 years.

34
00:01:23,000 --> 00:01:27,300
First 16 of which I've
done a lot of offensive CNO

35
00:01:27,300 --> 00:01:29,850
operations for military DOD as well as

36
00:01:29,850 --> 00:01:32,658
commercial red team pen tests.

37
00:01:32,659 --> 00:01:35,450
Last six years has been
switched over to the blue side.

38
00:01:35,450 --> 00:01:37,409
I never thought that I would
trade in my red card badge

39
00:01:37,409 --> 00:01:38,409
for a blue one,

40
00:01:38,409 --> 00:01:39,890
but it happened

41
00:01:39,890 --> 00:01:41,399
and threat hunting is so much fun.

42
00:01:41,399 --> 00:01:44,579
So if any red teamers wanna
switch to the blue side,

43
00:01:44,579 --> 00:01:46,969
we have cookies too.

44
00:01:46,969 --> 00:01:49,298
But blue team is a lot of fun.

45
00:01:49,299 --> 00:01:50,299
Threat hunting is a lot of fun.

46
00:01:50,299 --> 00:01:52,310
It's about a lot about investigation

47
00:01:52,310 --> 00:01:53,310
and what I found is

48
00:01:53,310 --> 00:01:56,729
in teaching, you know, blue
teamers or red teamers,

49
00:01:56,729 --> 00:01:59,048
how to do the blue team side,
we've learned a lot of things.

50
00:01:59,049 --> 00:02:00,930
So love to talk to you
guys more about that.

51
00:02:00,930 --> 00:02:02,810
And with that hand it over to Jonathan.

52
00:02:02,810 --> 00:02:03,810
- Hi everybody.

53
00:02:03,810 --> 00:02:04,810
I'm Jonathan Mulholland.

54
00:02:04,810 --> 00:02:05,950
I started my life as a physicist.

55
00:02:05,950 --> 00:02:09,880
I got my PhD at Jefferson
lab down in Newport news.

56
00:02:09,880 --> 00:02:12,410
I worked for a bit at NIS
doing neutron physics,

57
00:02:12,410 --> 00:02:15,190
and I bailed on all that
because the job prospects

58
00:02:15,190 --> 00:02:16,370
were pretty grim and

59
00:02:16,370 --> 00:02:21,190
started following my other
passion, which is ML and AI.

60
00:02:21,190 --> 00:02:23,120
And since then I've been working in,

61
00:02:23,120 --> 00:02:26,170
you know, image processing,
document classification,

62
00:02:26,170 --> 00:02:28,869
document exploitation, and
my perpetual fascination,

63
00:02:28,870 --> 00:02:32,030
which is trying to apply
ML and AI to cyber,

64
00:02:32,030 --> 00:02:33,690
which is an extremely challenging problem.

65
00:02:33,690 --> 00:02:36,480
So I was super happy when
Fred asked me to join the team

66
00:02:36,480 --> 00:02:39,119
and I got a chance to really
dig into that problem.

67
00:02:39,120 --> 00:02:40,560
- All right.

68
00:02:40,560 --> 00:02:42,659
So some of the talk topics today,

69
00:02:42,659 --> 00:02:44,819
so we're gonna talk about
this red and blue smashing

70
00:02:44,819 --> 00:02:46,980
together concept.

71
00:02:46,980 --> 00:02:48,649
We are going to

72
00:02:48,650 --> 00:02:50,730
talk about what we can
measure when we do these kinds

73
00:02:50,730 --> 00:02:51,730
of things.

74
00:02:51,730 --> 00:02:53,481
We're gonna talk about a
community release at the end,

75
00:02:53,481 --> 00:02:56,810
and we're releasing all of
our research at the end.

76
00:02:56,810 --> 00:02:57,810
And really,

77
00:02:57,810 --> 00:02:59,090
I wanna talk about like some of our goals

78
00:02:59,090 --> 00:03:00,250
and our motivations, right?

79
00:03:00,250 --> 00:03:01,400
So, you know,

80
00:03:01,400 --> 00:03:03,830
by combining the red teams
and blue teams together,

81
00:03:03,830 --> 00:03:07,370
really we can measure
and identify gaps, right?

82
00:03:07,370 --> 00:03:08,989
There's been a lot of good effort,

83
00:03:08,989 --> 00:03:12,129
but labeling them with MITRE ATT&CK.

84
00:03:12,129 --> 00:03:14,159
So we can actually use
MITRE ATT&CK as a backdrop

85
00:03:14,159 --> 00:03:16,470
for this whole talk to
talk about measuring

86
00:03:16,470 --> 00:03:19,620
and effectiveness and
validation of analytics.

87
00:03:19,620 --> 00:03:20,620
The other thing is

88
00:03:20,620 --> 00:03:24,250
there's a lot of great
effort from the communities

89
00:03:24,250 --> 00:03:25,410
out there already,

90
00:03:25,410 --> 00:03:27,290
but a lot of them exist in repos, right?

91
00:03:27,290 --> 00:03:30,109
Like GitHub repos and things like that.

92
00:03:30,110 --> 00:03:32,569
And while they're really
open and very collaborative

93
00:03:32,569 --> 00:03:33,569
and very sharing, sometimes

94
00:03:33,569 --> 00:03:36,780
the barrier to entry for
these is a little too high

95
00:03:36,780 --> 00:03:37,790
for some people.

96
00:03:37,790 --> 00:03:40,780
So we have some concepts that
we think that we can help

97
00:03:40,780 --> 00:03:44,329
the community with by bringing
these open source communities

98
00:03:44,329 --> 00:03:47,200
up into a nice searchable user interface,

99
00:03:47,200 --> 00:03:48,560
filterable and things like that.

100
00:03:48,560 --> 00:03:50,959
I actually loved the talk yesterday.

101
00:03:50,959 --> 00:03:51,970
If you haven't checked it out

102
00:03:51,970 --> 00:03:52,970
Compass.

103
00:03:52,970 --> 00:03:54,939
There was a talk yesterday on Compass

104
00:03:54,939 --> 00:03:56,549
where they actually did the mapping

105
00:03:56,549 --> 00:03:59,420
and it's up on GitHub
and there's a search page

106
00:03:59,420 --> 00:04:01,439
where you can search by MITRE ATT&CK

107
00:04:01,439 --> 00:04:03,470
and pull up all of the
red team communities

108
00:04:03,470 --> 00:04:05,530
and all of the blue team communities,

109
00:04:05,530 --> 00:04:06,710
all in one place.

110
00:04:06,710 --> 00:04:08,879
Those kinds of efforts, bring
these communities together

111
00:04:08,879 --> 00:04:10,310
and strengthen them.

112
00:04:10,310 --> 00:04:14,040
SnapAttack, we're trying even go further.

113
00:04:14,040 --> 00:04:16,719
We have probably 80% of all
the analytics that are in

114
00:04:16,720 --> 00:04:19,050
and ATT&CK sessions that are in Compass,

115
00:04:19,050 --> 00:04:21,160
but in a sandbox environment.

116
00:04:21,160 --> 00:04:22,990
So we'll talk about that.

117
00:04:22,990 --> 00:04:25,090
But anyway, I really wanted
to highlight the awesome work

118
00:04:25,090 --> 00:04:26,510
that red team communities,

119
00:04:26,510 --> 00:04:28,409
blue team communities,

120
00:04:28,410 --> 00:04:29,680
repositories out there are doing.

121
00:04:29,680 --> 00:04:31,540
We're a huge fan where we contribute.

122
00:04:31,540 --> 00:04:34,380
In fact, I gave a PR this morning.

123
00:04:34,380 --> 00:04:36,110
But really good stuff,

124
00:04:36,110 --> 00:04:37,830
but wouldn't it be really cool

125
00:04:37,830 --> 00:04:40,979
if we could smash these things together.

126
00:04:40,980 --> 00:04:42,750
So pause on that.

127
00:04:42,750 --> 00:04:45,780
We mentioned that Jonathan
is, you know, a scientist.

128
00:04:45,780 --> 00:04:48,250
He worked actually at a
particle collision lab.

129
00:04:48,250 --> 00:04:49,830
So one time we were having lunch,

130
00:04:49,830 --> 00:04:51,530
I think there might
have been beer involved.

131
00:04:51,530 --> 00:04:54,599
We were philosophizing on InfoSec and,

132
00:04:54,600 --> 00:04:56,740
you know, he was talking
about particle collisions

133
00:04:56,740 --> 00:04:58,110
and it really kind of dawned on us,

134
00:04:58,110 --> 00:04:59,550
it was like, hey, that's
kind of what we're doing

135
00:04:59,550 --> 00:05:00,970
in our platform, right?

136
00:05:00,970 --> 00:05:04,470
Scientists, they are trying to
study the subatomic elements

137
00:05:04,470 --> 00:05:06,750
of an atom and in doing so, it's very hard

138
00:05:06,750 --> 00:05:08,030
to measure directly.

139
00:05:08,030 --> 00:05:09,380
So what they do is they collide them.

140
00:05:09,380 --> 00:05:10,580
And then this back scatter

141
00:05:10,580 --> 00:05:13,780
due to the collision is
what they actually measure

142
00:05:13,780 --> 00:05:15,140
their research off of.

143
00:05:15,140 --> 00:05:16,440
So, very similarly,

144
00:05:16,440 --> 00:05:20,560
we are taking data sets from
the red and the blue community

145
00:05:20,560 --> 00:05:23,630
and smashing them
together in our platform,

146
00:05:23,630 --> 00:05:26,540
along the labeled lines of MITRE ATT&CK.

147
00:05:26,540 --> 00:05:27,970
So here for today's talk,

148
00:05:27,970 --> 00:05:30,090
we're actually gonna focus
on atomic red and Sigma.

149
00:05:30,090 --> 00:05:33,099
They're two of the most
widely supported and popular,

150
00:05:33,100 --> 00:05:34,500
you know, communities.

151
00:05:34,500 --> 00:05:35,880
Thank you guys.

152
00:05:35,880 --> 00:05:37,969
And, our goals are to

153
00:05:37,970 --> 00:05:42,410
measure hacker behavior
by colliding these.

154
00:05:42,410 --> 00:05:44,910
So what are some of the types
of things that we can measure?

155
00:05:44,910 --> 00:05:45,930
So there's a lot of things,

156
00:05:45,930 --> 00:05:48,210
but I'll narrow it down
to this and we'll go fast

157
00:05:48,210 --> 00:05:49,840
because we're gonna jump
into each one of these

158
00:05:49,840 --> 00:05:51,380
as a research topic.

159
00:05:51,380 --> 00:05:52,380
False positives, right?

160
00:05:52,380 --> 00:05:57,550
If you study a analytic in
a GitHub repo in unison like

161
00:05:57,550 --> 00:06:00,270
by itself, that doesn't
tell you anything about its

162
00:06:00,270 --> 00:06:03,330
true positive, or false
positive nature, right?

163
00:06:03,330 --> 00:06:05,530
Only when you put these
analytics into action,

164
00:06:05,530 --> 00:06:08,549
can you really see how they work.

165
00:06:08,550 --> 00:06:10,930
MITRE ATT&CK coverage, same thing.

166
00:06:10,930 --> 00:06:12,880
We can actually collide a-

167
00:06:12,880 --> 00:06:16,280
we have the unique opportunity
to have a red team researcher

168
00:06:16,280 --> 00:06:19,309
apply a MITRE ATT&CK tag to
what he thinks the attack is.

169
00:06:19,310 --> 00:06:20,940
And then the analytics,

170
00:06:20,940 --> 00:06:23,990
the detection engineer
applies a tag to what

171
00:06:23,990 --> 00:06:25,020
they think it is.

172
00:06:25,020 --> 00:06:26,560
But there's some really interesting stuff

173
00:06:26,560 --> 00:06:28,530
when you start colliding these together.

174
00:06:28,530 --> 00:06:30,880
You can validate MITRE ATT&CK tagging,

175
00:06:30,880 --> 00:06:32,830
but you can also find discrepancies

176
00:06:32,830 --> 00:06:35,340
and interesting
similarities, which I won't-

177
00:06:35,340 --> 00:06:38,020
Jonathan will go into a little later.

178
00:06:38,020 --> 00:06:39,710
And then lastly, analytics similarities.

179
00:06:39,710 --> 00:06:40,760
Whenever you have a community,

180
00:06:40,760 --> 00:06:44,250
the Sigma community alone
has over 1800 analytics.

181
00:06:44,250 --> 00:06:47,110
They're freely downloadable and usable.

182
00:06:47,110 --> 00:06:49,700
The quality varies widely, right?

183
00:06:49,700 --> 00:06:51,880
So measuring these things is important.

184
00:06:51,880 --> 00:06:53,680
But analytics similarities
are bound to happen.

185
00:06:53,680 --> 00:06:54,990
And we're gonna talk about that.

186
00:06:54,990 --> 00:06:57,960
Around how when you have 1800 analytics

187
00:06:57,960 --> 00:06:59,310
and you bash it up against an atomic

188
00:06:59,310 --> 00:07:02,390
and you get these four that
always hit on the same attacks,

189
00:07:02,390 --> 00:07:04,180
maybe they're duplicates,
maybe they're similarities.

190
00:07:04,180 --> 00:07:06,180
So we'll talk about that.

191
00:07:06,180 --> 00:07:09,890
So before we jump into
the data and the research,

192
00:07:09,890 --> 00:07:12,430
really briefly talking about the library,

193
00:07:12,430 --> 00:07:13,550
so we'll come back to this,

194
00:07:13,550 --> 00:07:14,550
but this is what we're open-

195
00:07:14,550 --> 00:07:15,800
Well, I wouldn't say open sources,

196
00:07:15,800 --> 00:07:17,970
but open, free community platform.

197
00:07:17,970 --> 00:07:19,440
We're putting all of the data in there.

198
00:07:19,440 --> 00:07:21,200
We've ran all of the atomics,

199
00:07:21,200 --> 00:07:23,090
all of the sigmas up against each other.

200
00:07:23,090 --> 00:07:26,570
It's part sandbox, part
detection engineering platform,

201
00:07:26,570 --> 00:07:29,469
but it's really supposed
to be a research platform

202
00:07:29,470 --> 00:07:32,650
to uplift our whole community.

203
00:07:32,650 --> 00:07:36,530
Our whole goal is to really take

204
00:07:36,530 --> 00:07:38,049
blue and red and mash them together.

205
00:07:38,050 --> 00:07:39,050
So if you look, actually,

206
00:07:39,050 --> 00:07:40,960
I don't think anybody
used the laser pointer.

207
00:07:40,960 --> 00:07:42,700
(Jonathan and crowd laughing)

208
00:07:42,700 --> 00:07:44,880
So I'm super excited to.

209
00:07:44,880 --> 00:07:45,880
Yeah.

210
00:07:45,880 --> 00:07:48,219
I'll keep my fire down range.

211
00:07:48,220 --> 00:07:50,080
But if you look at it,

212
00:07:50,080 --> 00:07:51,159
the red team, right?

213
00:07:51,160 --> 00:07:52,680
So the red team, there's this circle of

214
00:07:52,680 --> 00:07:54,720
red team attack sessions, right?

215
00:07:54,720 --> 00:07:56,720
Whether that's Matter split, Caldera,

216
00:07:56,720 --> 00:07:59,070
atomic, red, et cetera.

217
00:07:59,070 --> 00:08:00,360
And then there is, sorry, Jonathan,

218
00:08:00,360 --> 00:08:01,890
you're close to down range.

219
00:08:01,890 --> 00:08:03,770
I'll try and not get you.

220
00:08:03,770 --> 00:08:05,330
We do have the analytics, right?

221
00:08:05,330 --> 00:08:06,930
And those are those repos.

222
00:08:06,930 --> 00:08:10,190
And so what we really wanna
do is measure the validation

223
00:08:10,190 --> 00:08:11,190
of these, right?

224
00:08:11,190 --> 00:08:13,490
So you have all of
these attacks out there,

225
00:08:13,490 --> 00:08:15,500
all these analytics, when
you smash 'em together,

226
00:08:15,500 --> 00:08:17,840
anything that matches from
a validation standpoint

227
00:08:17,840 --> 00:08:20,820
is something that we
can confidently deploy.

228
00:08:20,820 --> 00:08:24,480
We are confident that
that analytic will match

229
00:08:24,480 --> 00:08:26,350
that attack detection, right?

230
00:08:26,350 --> 00:08:28,920
So that's what we're gonna talk about.

231
00:08:28,920 --> 00:08:31,860
These represent attacks from a standpoint

232
00:08:31,860 --> 00:08:33,870
that we cannot yet detect.

233
00:08:33,870 --> 00:08:34,870
And over here

234
00:08:34,870 --> 00:08:38,630
are analytics that exist in a
repo that are probably valid,

235
00:08:38,630 --> 00:08:40,620
but a red teamer hasn't exercised those

236
00:08:40,620 --> 00:08:42,500
in a real way and validated them.

237
00:08:42,500 --> 00:08:47,759
So our goal is to smash
these together more and more.

238
00:08:47,759 --> 00:08:48,759
Okay.

239
00:08:48,759 --> 00:08:50,649
- So I'm gonna turn it.

240
00:08:50,649 --> 00:08:51,759
- Yeah, Jonathan.

241
00:08:51,759 --> 00:08:52,879
- Okay, great.

242
00:08:52,879 --> 00:08:53,879
- Okay.

243
00:08:53,879 --> 00:08:56,019
Let's do a particle physics experiment.

244
00:08:56,019 --> 00:08:58,260
So here's all our particles up there.

245
00:08:58,260 --> 00:09:00,769
We've got red ones and blue ones.

246
00:09:00,769 --> 00:09:03,259
The blue ones are all drawn from the

247
00:09:03,259 --> 00:09:05,010
Sigma community analytics repo.

248
00:09:05,010 --> 00:09:07,870
So every one of those blue
dots represents a query

249
00:09:07,870 --> 00:09:10,029
from that repository.

250
00:09:10,029 --> 00:09:12,280
So there's 1,840 of them.

251
00:09:12,280 --> 00:09:13,280
The red dots.

252
00:09:13,280 --> 00:09:15,680
So these are our attack sessions.

253
00:09:15,680 --> 00:09:18,329
So there was 847 atomic red scripts.

254
00:09:18,329 --> 00:09:20,489
We emulated as many of them as we could.

255
00:09:20,490 --> 00:09:21,839
We logged it.

256
00:09:21,839 --> 00:09:23,970
And then we applied a
marker to those logs to show

257
00:09:23,970 --> 00:09:26,420
where in that session did the exploit

258
00:09:26,420 --> 00:09:28,329
that we're interested in happen.

259
00:09:28,329 --> 00:09:30,779
So we've got a time stamp on
there and we've got a process,

260
00:09:30,779 --> 00:09:34,490
we've got the process marked
and possibly most importantly,

261
00:09:34,490 --> 00:09:38,029
is that we have the attack
techniques labeled in all of this

262
00:09:38,029 --> 00:09:39,510
from the community.

263
00:09:39,510 --> 00:09:41,250
Which allows us to bridge the gap here.

264
00:09:41,250 --> 00:09:42,769
And I'll show you how that works later.

265
00:09:42,769 --> 00:09:47,579
379 of them, we were able
to emulate successfully.

266
00:09:47,579 --> 00:09:50,349
And so that's what's in our
pile of particles there.

267
00:09:50,350 --> 00:09:52,800
So let's smash 'em together.

268
00:09:52,800 --> 00:09:53,800
Okay.

269
00:09:53,800 --> 00:09:54,800
Here's the particle

270
00:09:54,800 --> 00:09:55,829
collider,

271
00:09:55,830 --> 00:09:58,389
the inside of the particle
Collider from SnapAttack.

272
00:09:58,389 --> 00:09:59,649
It looks like a mess.

273
00:09:59,649 --> 00:10:01,829
And it's kind of like in nuclear physics,

274
00:10:01,829 --> 00:10:03,800
when you've got a mess
inside of a detector,

275
00:10:03,800 --> 00:10:06,399
you have to hack away at it piece by piece

276
00:10:06,399 --> 00:10:08,490
and you would start by
filtering out the noise first.

277
00:10:08,490 --> 00:10:09,860
You can see there's lots of noise up there

278
00:10:09,860 --> 00:10:12,519
and then start to dig
into what's left over

279
00:10:12,519 --> 00:10:15,600
to find patterns and find
out what's significant here.

280
00:10:15,600 --> 00:10:19,470
So the end goal here is,
after we dig away the noise,

281
00:10:19,470 --> 00:10:22,350
we match the patterns we try
and discover what's in here,

282
00:10:22,350 --> 00:10:25,279
is we're hoping to find a set
of analytics that are valid,

283
00:10:25,279 --> 00:10:26,329
that we can rely on.

284
00:10:26,329 --> 00:10:30,160
They don't have huge,
false positive rates.

285
00:10:30,160 --> 00:10:32,649
So another point of this
before I continue is

286
00:10:32,649 --> 00:10:34,089
this experiment we ran,

287
00:10:34,089 --> 00:10:35,720
this is environment sensitive, right?

288
00:10:35,720 --> 00:10:37,330
So if we run this in a
different environment,

289
00:10:37,330 --> 00:10:40,220
we might get a slightly different answer.

290
00:10:40,220 --> 00:10:43,290
Okay so let's, let's
clear away some of this.

291
00:10:43,290 --> 00:10:44,290
Okay.

292
00:10:44,290 --> 00:10:45,819
So this is after we've removed

293
00:10:45,819 --> 00:10:48,019
the analytics that are too
hot and too cold, right?

294
00:10:48,019 --> 00:10:50,160
We saw that some of
those hit on everything

295
00:10:50,160 --> 00:10:51,509
and some hit on nothing.

296
00:10:51,509 --> 00:10:54,079
So we obviously don't want those.

297
00:10:54,079 --> 00:10:57,649
And we removed everything
that had a connection

298
00:10:57,649 --> 00:11:00,000
between the analytics and
the sessions that was-

299
00:11:00,000 --> 00:11:02,250
They had fewer than, sorry-

300
00:11:02,250 --> 00:11:05,019
Everything up there has
between one and 20 connections.

301
00:11:05,019 --> 00:11:06,019
What is a connection?

302
00:11:06,019 --> 00:11:08,070
What is one of those particle traces?

303
00:11:08,070 --> 00:11:10,980
We draw one whenever an analytic

304
00:11:10,980 --> 00:11:14,029
query hits on a log from
one of those sessions.

305
00:11:14,029 --> 00:11:16,870
So a line means there was at least one hit

306
00:11:16,870 --> 00:11:18,230
on that session up there.

307
00:11:18,230 --> 00:11:19,230
Okay.

308
00:11:19,230 --> 00:11:21,410
So this is all the connectivity
that we are gonna dig into

309
00:11:21,410 --> 00:11:25,499
and try and find like
some sort of pattern.

310
00:11:25,499 --> 00:11:27,760
The analytics that we threw away,

311
00:11:27,760 --> 00:11:28,870
as Fred mentioned, right?

312
00:11:28,870 --> 00:11:30,339
They just didn't validate on anything.

313
00:11:30,339 --> 00:11:31,370
They didn't hit anything.

314
00:11:31,370 --> 00:11:32,899
That doesn't mean they're bad.

315
00:11:32,899 --> 00:11:34,430
So we're gonna put those in a backlog

316
00:11:34,430 --> 00:11:36,089
and deal with them later.

317
00:11:36,089 --> 00:11:38,550
This is fodder for the
red team community, right?

318
00:11:38,550 --> 00:11:41,790
Like, can you make attack
sessions that represent

319
00:11:41,790 --> 00:11:44,089
behaviors that those
might be able to detect?

320
00:11:44,090 --> 00:11:47,579
So we can say something about them.

321
00:11:47,579 --> 00:11:51,810
For the ones that hit
too many of the sessions.

322
00:11:51,810 --> 00:11:53,800
If they hit more than 20 sessions,

323
00:11:53,800 --> 00:11:54,889
they're probably useless.

324
00:11:54,889 --> 00:11:58,730
They're gonna hit on lots
and lots and lots of events.

325
00:11:58,730 --> 00:12:00,509
They're supposed to hit on a
particular type of behavior.

326
00:12:00,509 --> 00:12:03,190
And if you're hitting
on all of our sessions,

327
00:12:03,190 --> 00:12:05,319
it's probably not a focused analytic.

328
00:12:05,319 --> 00:12:09,349
So we get rid of 'em.

329
00:12:09,350 --> 00:12:12,220
So we're doing this within
just open source data.

330
00:12:12,220 --> 00:12:13,949
If you've got access to real data,

331
00:12:13,949 --> 00:12:15,809
there's a better way to
estimate false positives

332
00:12:15,809 --> 00:12:16,839
for analytics,

333
00:12:16,839 --> 00:12:19,829
just run it on real data and
keep track of what happens

334
00:12:19,829 --> 00:12:20,829
over time.

335
00:12:20,829 --> 00:12:22,969
How many hits are those analytics getting?

336
00:12:22,970 --> 00:12:26,269
So we're actually doing
this with some client data.

337
00:12:26,269 --> 00:12:27,860
We've got a client that's 50,000 hosts

338
00:12:27,860 --> 00:12:29,589
that's let us run our analytics on there

339
00:12:29,589 --> 00:12:31,249
so we can get real measurements.

340
00:12:31,249 --> 00:12:32,680
We really wanted to share it with you,

341
00:12:32,680 --> 00:12:35,069
but that lawyer said that
wouldn't be a good idea.

342
00:12:35,069 --> 00:12:37,689
So we're keeping this open source,

343
00:12:37,690 --> 00:12:40,339
and this is still a pretty good
estimate of false positives.

344
00:12:40,339 --> 00:12:42,559
So we've cleared those out,

345
00:12:42,559 --> 00:12:43,980
right?

346
00:12:43,980 --> 00:12:45,089
And like,

347
00:12:45,089 --> 00:12:46,959
we're doing this like mechanically, right?

348
00:12:46,959 --> 00:12:48,229
This is an empirical measurement.

349
00:12:48,230 --> 00:12:49,860
Why is that so important?

350
00:12:49,860 --> 00:12:51,259
You can't stare at analytics

351
00:12:51,259 --> 00:12:52,499
and figure out what they're gonna do.

352
00:12:52,499 --> 00:12:54,800
And so we have an example of that here.

353
00:12:54,800 --> 00:12:57,069
So this is an analytic
that's set to detect

354
00:12:57,070 --> 00:13:03,290
PowerShell runs that have
an unsafe execution policy.

355
00:13:03,290 --> 00:13:04,930
And if you look at what the author thinks,

356
00:13:04,930 --> 00:13:07,529
they think that this is gonna
have some false positive

357
00:13:07,529 --> 00:13:09,189
associated with administrator scripts

358
00:13:09,189 --> 00:13:11,839
and the criticality level of it is high.

359
00:13:11,839 --> 00:13:13,509
So in the Sigma aspects,

360
00:13:13,509 --> 00:13:16,259
a high criticality level means that

361
00:13:16,259 --> 00:13:19,089
you should forward this to
an analyst when it hits.

362
00:13:19,089 --> 00:13:20,089
Right?

363
00:13:20,089 --> 00:13:22,120
So just looking at this, we might suspect,

364
00:13:22,120 --> 00:13:23,120
okay,

365
00:13:23,120 --> 00:13:25,149
there's gonna be false positives, right?

366
00:13:25,149 --> 00:13:26,839
Like this happens in the
background sometimes.

367
00:13:26,839 --> 00:13:28,769
Well, it turns out it
hit on every single one

368
00:13:28,769 --> 00:13:29,769
of our sessions.

369
00:13:29,769 --> 00:13:31,749
So this is an example of
one of those analytics

370
00:13:31,749 --> 00:13:33,809
that a smear of white lines across it,

371
00:13:33,809 --> 00:13:34,879
it hit everything.

372
00:13:34,879 --> 00:13:36,579
We probably would've
guessed it would have a

373
00:13:36,579 --> 00:13:38,349
a false positive rate,

374
00:13:38,350 --> 00:13:39,810
but not that it hit on everything.

375
00:13:39,810 --> 00:13:41,959
There's gonna be lots
of analytics like this.

376
00:13:41,959 --> 00:13:43,699
The only way to figure out
how they're gonna behave

377
00:13:43,699 --> 00:13:47,979
is to test them and validate them.

378
00:13:47,980 --> 00:13:49,670
Right, it's even worse than that.

379
00:13:49,670 --> 00:13:52,410
So what if you took the
Sigma analytic repository

380
00:13:52,410 --> 00:13:55,800
and just wanted to filter
on the criticality level,

381
00:13:55,800 --> 00:13:58,819
we're gonna take all
of the critical labels.

382
00:13:58,819 --> 00:14:00,769
Is that a reliable way to pull analytics?

383
00:14:00,769 --> 00:14:02,600
Answer is no.

384
00:14:02,600 --> 00:14:05,550
So we did this measurement
here, this X axis here.

385
00:14:05,550 --> 00:14:08,079
Two people using a laser
pointer, look at that.

386
00:14:08,080 --> 00:14:09,080
- It's catching on.

387
00:14:09,080 --> 00:14:10,080
Right.

388
00:14:10,080 --> 00:14:11,080
So that X axis-

389
00:14:11,080 --> 00:14:13,140
(Jonathan laughing)

390
00:14:13,140 --> 00:14:14,140
The quality score.

391
00:14:14,140 --> 00:14:16,480
So that is the fraction of attack sessions

392
00:14:16,480 --> 00:14:19,240
then an analytic hit that got validated.

393
00:14:19,240 --> 00:14:22,500
So if it's one, it validated-

394
00:14:22,500 --> 00:14:23,500
Oops, sorry.

395
00:14:23,500 --> 00:14:24,910
That's why they didn't use the laser.

396
00:14:24,910 --> 00:14:26,118
So

397
00:14:26,119 --> 00:14:29,879
it validated on a hundred percent of the

398
00:14:29,879 --> 00:14:31,430
sessions it hit, this is zero.

399
00:14:31,430 --> 00:14:32,979
So it's on the left, it's garbage.

400
00:14:32,980 --> 00:14:34,369
On the right, it's gold.

401
00:14:34,369 --> 00:14:37,480
And it's separated by the
criticality level here, right?

402
00:14:37,480 --> 00:14:39,600
And you'll notice that the
analytics are clustered

403
00:14:39,600 --> 00:14:42,060
into two piles on either side.

404
00:14:42,060 --> 00:14:43,229
Which means that it's a coin flip.

405
00:14:43,230 --> 00:14:46,779
If you pick a critical

406
00:14:46,779 --> 00:14:48,339
Sigma analytic.

407
00:14:48,339 --> 00:14:49,620
It's 50/50,

408
00:14:49,620 --> 00:14:50,680
whether it's garbage or not.

409
00:14:50,680 --> 00:14:52,508
So

410
00:14:52,509 --> 00:14:53,509
these authors,

411
00:14:53,509 --> 00:14:55,230
while they might be trying to represent

412
00:14:55,230 --> 00:14:59,360
the severity of an event with
this criticality measure,

413
00:14:59,360 --> 00:15:03,019
they have no way of estimating
the probability of occurrence

414
00:15:03,019 --> 00:15:04,360
in your system.

415
00:15:04,360 --> 00:15:05,360
And so

416
00:15:05,360 --> 00:15:06,649
it's up to you to figure that out.

417
00:15:06,649 --> 00:15:08,019
You can't rely on them to do this,

418
00:15:08,019 --> 00:15:10,050
so you have to do measurements.

419
00:15:10,050 --> 00:15:11,170
Okay.

420
00:15:11,170 --> 00:15:12,910
So what's the final answer.

421
00:15:12,910 --> 00:15:14,809
This is kind of the final answer.

422
00:15:14,809 --> 00:15:16,389
So we've taken our graph

423
00:15:16,389 --> 00:15:18,240
and we've eliminated all of the noise.

424
00:15:18,240 --> 00:15:20,939
We've eliminated all the cold analytics.

425
00:15:20,939 --> 00:15:22,050
And now this is,

426
00:15:22,050 --> 00:15:24,748
every line here involves a validated hit.

427
00:15:24,749 --> 00:15:25,749
So that means that

428
00:15:25,749 --> 00:15:28,889
the analytic hit on a log.

429
00:15:28,889 --> 00:15:31,361
That's either the process that
was indicated in the session

430
00:15:31,361 --> 00:15:34,149
as the malicious activity,

431
00:15:34,149 --> 00:15:38,269
or it hit in a time
window and the analytic

432
00:15:38,269 --> 00:15:42,800
and the session share a
MITRE ATT&CK technique.

433
00:15:42,800 --> 00:15:45,020
This technique is what
allows us to communicate

434
00:15:45,020 --> 00:15:46,449
between the two worlds.

435
00:15:46,449 --> 00:15:48,329
And it indicates that
there's a shared intent

436
00:15:48,329 --> 00:15:51,118
between both the analytic and the session.

437
00:15:51,119 --> 00:15:53,089
So this is really key to communicating

438
00:15:53,089 --> 00:15:54,379
and bridging this gap.

439
00:15:54,379 --> 00:15:56,399
So

440
00:15:56,399 --> 00:16:00,949
this common language
bridges the red blue divide.

441
00:16:00,949 --> 00:16:02,689
So

442
00:16:02,689 --> 00:16:03,969
what else can you do with this, right?

443
00:16:03,970 --> 00:16:06,339
This is sort of the core set of data.

444
00:16:06,339 --> 00:16:07,339
This is actually,

445
00:16:07,339 --> 00:16:08,339
I'm not showing this just because

446
00:16:08,339 --> 00:16:10,290
I'm nostalgic about physics.

447
00:16:10,290 --> 00:16:12,618
And it kind of looks like particles.

448
00:16:12,619 --> 00:16:13,990
This is a graph data structure.

449
00:16:13,990 --> 00:16:16,019
All the data from our
system is actually stored

450
00:16:16,019 --> 00:16:19,060
in this structure and those
relationships are related.

451
00:16:19,060 --> 00:16:21,910
So you can actually do a couple
other cool things with it.

452
00:16:21,910 --> 00:16:24,240
One is you can just filter
by the attack technique.

453
00:16:24,240 --> 00:16:29,259
So this is all those points with just the-

454
00:16:29,259 --> 00:16:32,319
This is just events having
to do with credential dumping

455
00:16:32,319 --> 00:16:34,389
with Elsas.

456
00:16:34,389 --> 00:16:36,959
So those five red dots at the top are,

457
00:16:36,959 --> 00:16:39,260
it's very messy if you put
the labels on the graph.

458
00:16:39,260 --> 00:16:40,459
So they're like off the side,

459
00:16:40,459 --> 00:16:43,768
and these are the names of
the analytics down here.

460
00:16:43,769 --> 00:16:45,839
So this is a decision making tool.

461
00:16:45,839 --> 00:16:47,550
So right if you wanted to
figure out what you want

462
00:16:47,550 --> 00:16:48,550
to deploy,

463
00:16:48,550 --> 00:16:49,550
you might say like,

464
00:16:49,550 --> 00:16:52,349
okay, well, this analytic
here connects to all

465
00:16:52,350 --> 00:16:53,441
these different types of behavior

466
00:16:53,441 --> 00:16:55,100
that are all Elsas memory dumping

467
00:16:55,100 --> 00:16:57,319
or credential dumping.

468
00:16:57,319 --> 00:17:00,099
So maybe we wanna just take
that one and recover it.

469
00:17:00,100 --> 00:17:01,980
Or if you notice there's a few

470
00:17:01,980 --> 00:17:03,540
that connect to only one, right?

471
00:17:03,540 --> 00:17:06,639
So maybe we want a few analytics that all

472
00:17:06,640 --> 00:17:10,310
are tuned to specific
types of approaches to this

473
00:17:10,310 --> 00:17:12,809
one sub technique.

474
00:17:12,809 --> 00:17:14,740
Or all the data's in here.

475
00:17:14,740 --> 00:17:16,240
You could look at log sources, right?

476
00:17:16,240 --> 00:17:19,940
So like pick a few analytics
from each log source,

477
00:17:19,940 --> 00:17:23,369
and then you have like a
detection in depth approach,

478
00:17:23,369 --> 00:17:24,369
you're covering your bases.

479
00:17:24,369 --> 00:17:25,369
- Yeah.

480
00:17:25,369 --> 00:17:26,369
And I think the one thing
that's important to know

481
00:17:26,369 --> 00:17:27,369
about this is

482
00:17:27,369 --> 00:17:29,780
this is also true sandbox detonation

483
00:17:29,780 --> 00:17:32,660
and true analytic hitting in a SIM.

484
00:17:32,660 --> 00:17:36,641
So this isn't just taking
a look at the, you know,

485
00:17:36,641 --> 00:17:38,640
the label of each and
merging them together.

486
00:17:38,640 --> 00:17:39,640
This is real,

487
00:17:39,640 --> 00:17:40,640
real world, real life.

488
00:17:40,640 --> 00:17:42,060
So I think that's important.

489
00:17:42,060 --> 00:17:44,600
And then the other thing is
this is all easily searchable,

490
00:17:44,600 --> 00:17:46,602
like in the platform that
we're releasing today.

491
00:17:46,603 --> 00:17:49,030
So you can just go in
there with one query, say,

492
00:17:49,030 --> 00:17:52,860
hey, show me all the
Sigma analytics for T100,

493
00:17:52,860 --> 00:17:54,740
yeah 3.001.

494
00:17:54,740 --> 00:17:56,930
And it'll pop up all of
the sandbox detonations

495
00:17:56,930 --> 00:17:57,930
from Metasplit,

496
00:17:57,930 --> 00:18:00,530
from, you know, atomic red from

497
00:18:00,530 --> 00:18:02,570
a wide variety of the tax sources,

498
00:18:02,570 --> 00:18:05,300
as well as all of the sigmas
that are actually detecting.

499
00:18:05,300 --> 00:18:06,510
And the cool thing is,

500
00:18:06,510 --> 00:18:08,920
as a new LSAS gets uploaded the platform,

501
00:18:08,920 --> 00:18:11,100
all of the analytics are
run against it in real time.

502
00:18:11,100 --> 00:18:12,919
And 15 seconds later, you get the answer.

503
00:18:12,920 --> 00:18:14,930
So if you're not sure
if a piece of malware

504
00:18:14,930 --> 00:18:18,150
will be caught by any
community public analytic,

505
00:18:18,150 --> 00:18:20,380
you can actually upload
it to the platform.

506
00:18:20,380 --> 00:18:23,240
I would say that's
actually the beta release

507
00:18:23,240 --> 00:18:24,240
that's private right now.

508
00:18:24,240 --> 00:18:26,140
But we're opening that
up in about four months,

509
00:18:26,140 --> 00:18:28,350
once it's really on us
for the coding project.

510
00:18:28,350 --> 00:18:29,949
But we'll talk about that at the end.

511
00:18:29,950 --> 00:18:30,950
- Yeah, yeah.

512
00:18:30,950 --> 00:18:31,950
Yeah, I mean to the point, right?

513
00:18:31,950 --> 00:18:33,240
I told you, these were the answers,

514
00:18:33,240 --> 00:18:34,240
we're giving these away.

515
00:18:34,240 --> 00:18:35,310
We're not keeping these to ourselves,

516
00:18:35,310 --> 00:18:37,440
so this'll be in the community edition.

517
00:18:37,440 --> 00:18:38,440
Okay.

518
00:18:38,440 --> 00:18:40,750
So a few other things
you can do with this,

519
00:18:40,750 --> 00:18:42,960
then I'm gonna hand it back to Fred.

520
00:18:42,960 --> 00:18:44,840
One is once you have

521
00:18:44,840 --> 00:18:47,689
these validations analyzed,

522
00:18:47,690 --> 00:18:49,950
you can give a much
more realistic estimate

523
00:18:49,950 --> 00:18:52,330
of what your attack coverage is.

524
00:18:52,330 --> 00:18:55,560
If you had just taken the
Sigma repository and said,

525
00:18:55,560 --> 00:18:57,090
what techniques does it cover,

526
00:18:57,090 --> 00:19:00,370
all of those analytics together cover

527
00:19:00,370 --> 00:19:04,030
322 distinct techniques
and sub techniques.

528
00:19:04,030 --> 00:19:06,360
If you follow our methodology

529
00:19:06,360 --> 00:19:08,939
and filter it down to the good stuff,

530
00:19:08,940 --> 00:19:11,590
you're only covering 115
techniques and sub techniques,

531
00:19:11,590 --> 00:19:14,330
which is less sexy, but it's real, right?

532
00:19:14,330 --> 00:19:17,889
Like if you colored in your
tech matrix with those 322,

533
00:19:17,890 --> 00:19:18,890
you're gonna have gaps,

534
00:19:18,890 --> 00:19:21,410
you're gonna have analytics
that hit too often to be usable.

535
00:19:21,410 --> 00:19:22,860
You're gonna have ones
that aren't reliable

536
00:19:22,860 --> 00:19:24,399
or that haven't been tested.

537
00:19:24,400 --> 00:19:28,190
So this 115 number is the real
answer that you want to use

538
00:19:28,190 --> 00:19:29,910
in your attack navigator

539
00:19:29,910 --> 00:19:33,090
illustrations here.

540
00:19:33,090 --> 00:19:34,679
Okay.

541
00:19:34,680 --> 00:19:40,170
One cool graph analysis
technique is you can do a proj-

542
00:19:40,170 --> 00:19:43,930
So this is all graph
data, like I said, right?

543
00:19:43,930 --> 00:19:45,260
So you can project this.

544
00:19:45,260 --> 00:19:47,900
You can do what's mathematically
is called projection

545
00:19:47,900 --> 00:19:49,940
onto one side of this chart.

546
00:19:49,940 --> 00:19:50,940
So that's

547
00:19:50,940 --> 00:19:53,300
a projection of a BI part type network.

548
00:19:53,300 --> 00:19:56,270
When you do that in regular terms,

549
00:19:56,270 --> 00:19:57,590
you get similar analytics.

550
00:19:57,590 --> 00:19:59,620
So this little Petri dish over here

551
00:19:59,620 --> 00:20:02,879
is the analytics that are similar.

552
00:20:02,880 --> 00:20:04,650
So this is one cluster
of similar analytics,

553
00:20:04,650 --> 00:20:07,950
and you can turn the math
knob up and down on here.

554
00:20:07,950 --> 00:20:10,330
So if you want a lot of
analytics similarities

555
00:20:10,330 --> 00:20:12,480
that are like, maybe not so similar,

556
00:20:12,480 --> 00:20:13,630
you can turn the knob one way.

557
00:20:13,630 --> 00:20:16,180
If you want, just very focused-

558
00:20:16,180 --> 00:20:18,780
Every single pair here
is very, very similar

559
00:20:18,780 --> 00:20:20,260
but you'll get fewer of them.

560
00:20:20,260 --> 00:20:22,240
So this is an adjustable parameter,

561
00:20:22,240 --> 00:20:23,280
but once you do that,

562
00:20:23,280 --> 00:20:26,010
you can start doing cool
things like de-duplication,

563
00:20:26,010 --> 00:20:27,010
you can auto label,

564
00:20:27,010 --> 00:20:29,410
you can move labels from one to the other,

565
00:20:29,410 --> 00:20:30,410
and you can look at

566
00:20:30,410 --> 00:20:33,930
the depth of your defense
systems you've got so-

567
00:20:33,930 --> 00:20:34,930
- Yeah.

568
00:20:34,930 --> 00:20:37,700
So let's take a look at one of
these analytics similarities.

569
00:20:37,700 --> 00:20:39,480
So first step is,

570
00:20:39,480 --> 00:20:41,850
you know, an example of Mav Inject.

571
00:20:41,850 --> 00:20:43,240
And actually it's funny this morning,

572
00:20:43,240 --> 00:20:45,810
I was actually doing some
research on Mav Inject.

573
00:20:45,810 --> 00:20:46,919
And I was like, okay,

574
00:20:46,920 --> 00:20:49,050
is this the right MITRE
ATT&CK tag and label,

575
00:20:49,050 --> 00:20:50,919
because you can see that they differ here.

576
00:20:50,920 --> 00:20:52,410
So one, you know, one person has,

577
00:20:52,410 --> 00:20:54,930
they both agree on 1055,

578
00:20:54,930 --> 00:20:57,020
but there's this 1056 that's different.

579
00:20:57,020 --> 00:20:58,020
So,

580
00:20:58,020 --> 00:21:00,370
but they're both hitting on
the same logs multiple times.

581
00:21:00,370 --> 00:21:01,520
So they're very close.

582
00:21:01,520 --> 00:21:02,770
And if you look at the code,

583
00:21:02,770 --> 00:21:03,830
they're actually very, very close

584
00:21:03,830 --> 00:21:06,909
and it turns out Matt
Gray here in the audience

585
00:21:06,910 --> 00:21:09,490
actually wrote a blog
post on this in 2018.

586
00:21:09,490 --> 00:21:12,260
So thank you, Matt for that.

587
00:21:12,260 --> 00:21:13,260
And yeah.

588
00:21:13,260 --> 00:21:15,140
So MITRE ATT&CK now has

589
00:21:15,140 --> 00:21:16,560
an updated label.

590
00:21:16,560 --> 00:21:17,560
I think it's

591
00:21:17,560 --> 00:21:19,440
T128

592
00:21:19,440 --> 00:21:24,380
Yeah, it's T128, I think,

593
00:21:24,380 --> 00:21:25,380
.013.

594
00:21:25,380 --> 00:21:27,080
So actually I started typing in,

595
00:21:27,080 --> 00:21:29,580
you know, a mental note
to do the PR request.

596
00:21:29,580 --> 00:21:31,750
And then I just put in
the PR request right away.

597
00:21:31,750 --> 00:21:33,170
But these are the things
that we can uncover

598
00:21:33,170 --> 00:21:36,360
and clean up the community
as things happen.

599
00:21:36,360 --> 00:21:39,050
So there's a PR request to change this,

600
00:21:39,050 --> 00:21:40,050
but what I would do with these

601
00:21:40,050 --> 00:21:43,080
they're too similar, we need
to merge these analytics.

602
00:21:43,080 --> 00:21:46,580
The next example has the
exact same graph behavior.

603
00:21:46,580 --> 00:21:50,050
They're both hitting on a
lot of the same attacks,

604
00:21:50,050 --> 00:21:51,310
but you can kind of notice,

605
00:21:51,310 --> 00:21:55,590
you can notice that one
is actually looking at

606
00:21:55,590 --> 00:21:57,290
log source process creation,

607
00:21:57,290 --> 00:22:00,639
and the other one is network connections.

608
00:22:00,640 --> 00:22:02,600
So some clients might
have network connections

609
00:22:02,600 --> 00:22:03,810
and not process creation

610
00:22:03,810 --> 00:22:05,950
or remote workers might
have process creation

611
00:22:05,950 --> 00:22:07,180
and not network connections.

612
00:22:07,180 --> 00:22:09,000
So what I would recommend
is we keep both of these

613
00:22:09,000 --> 00:22:12,100
for defense and depth purposes, right?

614
00:22:12,100 --> 00:22:14,730
But we can detect, you
know, the same behaviors,

615
00:22:14,730 --> 00:22:18,270
two different ways through
two different log sources.

616
00:22:18,270 --> 00:22:19,270
Okay.

617
00:22:19,270 --> 00:22:21,910
So I'm actually gonna jump
to here and then jump back.

618
00:22:21,910 --> 00:22:24,820
So we've talked a little bit
about this community platform.

619
00:22:24,820 --> 00:22:27,730
It's gonna be free
forever for the community.

620
00:22:27,730 --> 00:22:31,480
For our goal is to lower
the barrier of entry

621
00:22:31,480 --> 00:22:33,240
for detection engineering.

622
00:22:33,240 --> 00:22:36,270
As you saw, I think Johnny
and Olas talk yesterday,

623
00:22:36,270 --> 00:22:37,820
those are the very advanced techniques

624
00:22:37,820 --> 00:22:42,030
that we need to mature our
community to be able to detect.

625
00:22:42,030 --> 00:22:43,129
So if you haven't seen their talk,

626
00:22:43,130 --> 00:22:45,260
definitely check their talk out.

627
00:22:45,260 --> 00:22:46,970
Process creation is the
most prevalent thing

628
00:22:46,970 --> 00:22:47,970
that people are developing today.

629
00:22:47,970 --> 00:22:51,060
The sad truth is that
it's also the easiest

630
00:22:51,060 --> 00:22:52,530
for hackers to evade.

631
00:22:52,530 --> 00:22:54,899
So by having tools,

632
00:22:54,900 --> 00:22:57,040
we're hoping to uncover other data sources

633
00:22:57,040 --> 00:23:00,020
that could be valuable for detection,

634
00:23:00,020 --> 00:23:02,120
that are very, very hard
for humans to detect, right?

635
00:23:02,120 --> 00:23:04,550
So that's maybe a future reaching goal.

636
00:23:04,550 --> 00:23:07,070
But first and foremost,
we have to have the data.

637
00:23:07,070 --> 00:23:08,070
So, you know,

638
00:23:08,070 --> 00:23:10,450
through this particle
collision kind of platform,

639
00:23:10,450 --> 00:23:13,550
we have the data to start
that research, we hope.

640
00:23:13,550 --> 00:23:14,550
Yep.

641
00:23:14,550 --> 00:23:16,850
So today, actually, it
should be live right now.

642
00:23:16,850 --> 00:23:19,449
If you go to snapattack.com community,

643
00:23:19,450 --> 00:23:21,120
we're opening up for read access.

644
00:23:21,120 --> 00:23:23,580
We don't have all the code polished for

645
00:23:23,580 --> 00:23:24,580
contributing,

646
00:23:24,580 --> 00:23:26,980
and we don't have our moderation status up

647
00:23:26,980 --> 00:23:27,980
and things like that.

648
00:23:27,980 --> 00:23:28,980
But

649
00:23:28,980 --> 00:23:32,210
we have probably an open spot
for maybe 20 contributors.

650
00:23:32,210 --> 00:23:34,550
So if you're interested
in being a contributor,

651
00:23:34,550 --> 00:23:37,149
please post on that
website or on that link.

652
00:23:37,150 --> 00:23:38,630
There's a little form.

653
00:23:38,630 --> 00:23:41,240
Other community contributions
that you've made.

654
00:23:41,240 --> 00:23:44,670
We're looking for developers of,

655
00:23:44,670 --> 00:23:46,950
threat detections that are
people that are blogging

656
00:23:46,950 --> 00:23:48,600
and putting back to the community.

657
00:23:48,600 --> 00:23:49,690
So those will be the first
people that we accept

658
00:23:49,691 --> 00:23:51,900
into our developer program.

659
00:23:51,900 --> 00:23:55,090
Which we can, we can
accept, you know, 20 today.

660
00:23:55,090 --> 00:23:57,389
So that's important.

661
00:23:57,390 --> 00:23:58,790
All of the, yeah-

662
00:23:58,790 --> 00:24:01,129
All of the analytics and things
like that from right now,

663
00:24:01,130 --> 00:24:04,050
we seeded atomic red and Sigma.

664
00:24:04,050 --> 00:24:05,050
So those data sets,

665
00:24:05,050 --> 00:24:06,450
we also do have a little bit,

666
00:24:06,450 --> 00:24:09,540
I think there's two sessions
for cloud and cloud trail.

667
00:24:09,540 --> 00:24:12,360
A bunch of sessions for Cali Linux

668
00:24:12,360 --> 00:24:13,770
and Pretorian.

669
00:24:13,770 --> 00:24:14,850
So it's not just windows.

670
00:24:14,850 --> 00:24:16,590
We do have Linux,

671
00:24:16,590 --> 00:24:17,590
Windows,

672
00:24:17,590 --> 00:24:18,590
Cloud,

673
00:24:18,590 --> 00:24:20,280
and networking type events

674
00:24:20,280 --> 00:24:22,530
that our sandbox can capture.

675
00:24:22,530 --> 00:24:24,389
So there's a little bit of that out there.

676
00:24:24,390 --> 00:24:26,680
So if I take that and I jump back.

677
00:24:26,680 --> 00:24:29,720
Back button works.

678
00:24:29,720 --> 00:24:30,750
So research wrap-up.

679
00:24:30,750 --> 00:24:33,100
We actually started off this talk,

680
00:24:33,100 --> 00:24:34,560
thinking that we were
gonna dump a whole bunch

681
00:24:34,560 --> 00:24:36,790
of spreadsheets in GitHub
and share this out,

682
00:24:36,790 --> 00:24:38,420
like that way.

683
00:24:38,420 --> 00:24:40,140
Our developers were really motivated

684
00:24:40,140 --> 00:24:41,920
not to do yet another spreadsheet.

685
00:24:41,920 --> 00:24:44,250
And they were like, how
much time do we have?

686
00:24:44,250 --> 00:24:46,060
And I was like, oh, you probably
have a month and a half.

687
00:24:46,060 --> 00:24:47,060
They're like,

688
00:24:47,060 --> 00:24:48,669
we're gonna get a community
platform released like today.

689
00:24:48,670 --> 00:24:50,760
So it actually, wasn't
in our original talk.

690
00:24:50,760 --> 00:24:51,760
We had to alter the talk,

691
00:24:51,760 --> 00:24:53,890
thank you to the MITRE team for letting us

692
00:24:53,890 --> 00:24:55,720
change course just slightly.

693
00:24:55,720 --> 00:24:56,720
But now all of

694
00:24:56,720 --> 00:24:57,720
these results,

695
00:24:57,720 --> 00:24:59,960
everything except the analytics similarity

696
00:24:59,960 --> 00:25:02,420
is like three button
clicks in the platform.

697
00:25:02,420 --> 00:25:04,500
So I'm gonna put out a
YouTube video showing

698
00:25:04,500 --> 00:25:08,040
kind of how you can get all
these answers in the platform.

699
00:25:08,040 --> 00:25:09,040
But yeah,

700
00:25:09,040 --> 00:25:12,070
so curated set of validated
analytics is like filtered by,

701
00:25:12,070 --> 00:25:15,620
you know, validation status, right?

702
00:25:15,620 --> 00:25:17,649
- Filter by validation set and rank.

703
00:25:17,649 --> 00:25:18,649
- And then rank.

704
00:25:18,649 --> 00:25:19,649
Yeah, exactly.

705
00:25:19,649 --> 00:25:20,649
False positives,

706
00:25:20,649 --> 00:25:22,229
you can filter by rank in there.

707
00:25:22,230 --> 00:25:24,840
Backlog of all of the attacks that we have

708
00:25:24,840 --> 00:25:26,750
that we can't yet detect.

709
00:25:26,750 --> 00:25:29,110
That's a button click away
saying unvalidated or like

710
00:25:29,110 --> 00:25:31,370
undetected attack sessions.

711
00:25:31,370 --> 00:25:32,969
So those are the blue teamers.

712
00:25:32,970 --> 00:25:34,640
We're hoping blue teamers swarm on those

713
00:25:34,640 --> 00:25:36,530
and say, great, there's all these atomic

714
00:25:36,530 --> 00:25:38,010
that don't have a detection.

715
00:25:38,010 --> 00:25:39,270
Let's swarm on those.

716
00:25:39,270 --> 00:25:41,940
On the other side of things,

717
00:25:41,940 --> 00:25:43,440
we have untested signatures.

718
00:25:43,440 --> 00:25:45,350
There's a ton of untested signatures

719
00:25:45,350 --> 00:25:48,429
that we're hoping the
red team can produce,

720
00:25:48,430 --> 00:25:50,520
either automated a breach
attack simulation attacks

721
00:25:50,520 --> 00:25:52,360
that validate them.

722
00:25:52,360 --> 00:25:55,080
Or a one time sandbox
capture of that attack.

723
00:25:55,080 --> 00:25:56,760
Some things require a
lot of infrastructure

724
00:25:56,760 --> 00:25:58,370
to set up.

725
00:25:58,370 --> 00:26:00,389
Our sandbox, you can do
it one time, capture it,

726
00:26:00,390 --> 00:26:02,470
memorialize it forever.

727
00:26:02,470 --> 00:26:04,030
But that way we can actually validate that

728
00:26:04,030 --> 00:26:05,520
these analytics are working.

729
00:26:05,520 --> 00:26:07,639
Our goal is that true
positive center, right?

730
00:26:07,640 --> 00:26:10,450
That purple team.

731
00:26:10,450 --> 00:26:15,880
And with that, I think
we'll go for questions.

732
00:26:15,880 --> 00:26:19,910
(crowd applauding)

733
00:26:19,910 --> 00:26:22,010
- Another great presentation and you know,

734
00:26:22,010 --> 00:26:23,200
another tool drop so awesome.

735
00:26:23,200 --> 00:26:24,510
I actually think I was, you know,

736
00:26:24,510 --> 00:26:26,660
kind of brainstorming on the side there.

737
00:26:26,660 --> 00:26:27,660
Seemed like there might be an opportunity

738
00:26:27,660 --> 00:26:29,100
of combining your work and you know,

739
00:26:29,100 --> 00:26:30,540
what Lindsay and Scott shared earlier

740
00:26:30,540 --> 00:26:31,540
with the control compass.

741
00:26:31,540 --> 00:26:32,710
There might be a little bit of play there.

742
00:26:32,710 --> 00:26:33,810
Yeah, it's really awesome.

743
00:26:33,810 --> 00:26:34,810
And I also appreciate
your trigger discipline.

744
00:26:34,810 --> 00:26:38,060
I know, you know, brave
move, using losing laser,

745
00:26:38,060 --> 00:26:39,060
but worked out really well.

746
00:26:39,060 --> 00:26:40,690
So much appreciated.

747
00:26:40,690 --> 00:26:42,320
With that we have a couple minutes,

748
00:26:42,320 --> 00:26:48,720
so I wanted to open up to the audience,

749
00:26:48,720 --> 00:27:02,960
see some hands going,
we'll start in the front.

750
00:27:02,960 --> 00:27:05,190
(indistinct talking)

751
00:27:05,190 --> 00:27:14,380
- Oh, so just repeating
for the audience, you know?

752
00:27:14,380 --> 00:27:16,670
How do you kind of coalesce
what you're finding

753
00:27:16,670 --> 00:27:18,820
in terms of experimentation in labs

754
00:27:18,820 --> 00:27:20,649
and applying that to real world?

755
00:27:20,650 --> 00:27:23,010
These are typically the outputs
and kind of lessons learned

756
00:27:23,010 --> 00:27:25,280
translate directly or is a
little bit more massaging

757
00:27:25,280 --> 00:27:27,970
to kind of, you know,
embed that into real world?

758
00:27:27,970 --> 00:27:28,970
- Yeah.

759
00:27:28,970 --> 00:27:30,240
So the community edition,

760
00:27:30,240 --> 00:27:33,700
we have to have open source
community data in that,

761
00:27:33,700 --> 00:27:35,540
but that's actually how
we make money, right?

762
00:27:35,540 --> 00:27:37,460
So we customize these for clients.

763
00:27:37,460 --> 00:27:39,250
And so when we enter into a client,

764
00:27:39,250 --> 00:27:40,910
we actually run these against there

765
00:27:40,910 --> 00:27:43,060
and we actually rank
them with their data set.

766
00:27:43,060 --> 00:27:44,142
That's like one of the first things we do

767
00:27:44,142 --> 00:27:46,200
on the onboarding week, but you're right.

768
00:27:46,200 --> 00:27:48,440
But for this community,

769
00:27:48,440 --> 00:27:51,110
is if anybody has any
ideas or of data sets

770
00:27:51,110 --> 00:27:52,729
that we can run it against,

771
00:27:52,730 --> 00:27:55,580
we would love to work with
you guys to get better data,

772
00:27:55,580 --> 00:27:57,429
but for the open source community

773
00:27:57,430 --> 00:27:59,440
that's what we can do today.

774
00:27:59,440 --> 00:28:00,470
- Another question.

775
00:28:00,470 --> 00:28:03,560
- [Man 1] Thank you for this.

776
00:28:03,560 --> 00:28:04,560
Awesome.

777
00:28:04,560 --> 00:28:06,639
So one thing that I

778
00:28:06,640 --> 00:28:09,700
found a lot of is like
those on the red side

779
00:28:09,700 --> 00:28:13,750
are really good in putting out the X areas

780
00:28:13,750 --> 00:28:16,480
and them being the subject matter experts

781
00:28:16,480 --> 00:28:17,800
on that perspective.

782
00:28:17,800 --> 00:28:22,090
They're generally gonna be
pretty good at separating tag

783
00:28:22,090 --> 00:28:24,439
from like OS artifacts,

784
00:28:24,440 --> 00:28:26,200
test runner artifacts,

785
00:28:26,200 --> 00:28:27,370
and like,

786
00:28:27,370 --> 00:28:30,510
be really good at pinpointing
the specific artifacts,

787
00:28:30,510 --> 00:28:31,510
but

788
00:28:31,510 --> 00:28:33,000
they may not necessarily be like

789
00:28:33,000 --> 00:28:35,000
really good detection engineers, right?

790
00:28:35,000 --> 00:28:37,690
'Cause they don't have
like an operational,

791
00:28:37,690 --> 00:28:40,370
like focus of production data to like

792
00:28:40,370 --> 00:28:41,739
run their theories against.

793
00:28:41,740 --> 00:28:42,740
So like,

794
00:28:42,740 --> 00:28:44,830
how do you think through
like how your platform

795
00:28:44,830 --> 00:28:45,830
kinda like serves at niche of like,

796
00:28:45,830 --> 00:28:50,091
I'm a red teamer and I'm
a subject matter expert

797
00:28:50,091 --> 00:28:51,091
in this technique,

798
00:28:51,091 --> 00:28:53,469
but I may not necessarily be good

799
00:28:53,470 --> 00:28:55,020
at developing in analytics,

800
00:28:55,020 --> 00:28:58,430
but I can point out like
clearly what the artifacts are

801
00:28:58,430 --> 00:28:59,929
like, how do you think through
like merging that device?

802
00:28:59,929 --> 00:29:03,100
- So in short, really nuanced
and really great question.

803
00:29:03,100 --> 00:29:05,370
But in summary it was,
you know, basically,

804
00:29:05,370 --> 00:29:06,500
you know, how does this process,

805
00:29:06,500 --> 00:29:08,390
how does this platform
really connect the dots

806
00:29:08,390 --> 00:29:11,640
and the knowledge, you
know, from a blue, you know,

807
00:29:11,640 --> 00:29:12,750
detection engineering, you know,

808
00:29:12,750 --> 00:29:13,980
back over to the adversary perspective,

809
00:29:13,980 --> 00:29:17,200
but also a red teamer who
really knows their trade craft,

810
00:29:17,200 --> 00:29:19,130
but might not necessarily
know how to write an analytic

811
00:29:19,130 --> 00:29:21,370
or understand false
positives or validation.

812
00:29:21,370 --> 00:29:22,370
You know,

813
00:29:22,370 --> 00:29:23,959
what potential do you
really see in the platform

814
00:29:23,960 --> 00:29:25,840
in this process to kind
of connecting those dots?

815
00:29:25,840 --> 00:29:26,840
- Yeah.

816
00:29:26,840 --> 00:29:27,851
I promise I didn't softball pitch that.

817
00:29:27,851 --> 00:29:29,640
That was a great question.

818
00:29:29,640 --> 00:29:31,020
Couple of quick answers.

819
00:29:31,020 --> 00:29:32,730
One is InfoSec is a team sport.

820
00:29:32,730 --> 00:29:34,410
So you don't have to play all roles.

821
00:29:34,410 --> 00:29:36,970
Red teamers honestly don't
know about logs or detections

822
00:29:36,970 --> 00:29:37,970
and things like that.

823
00:29:37,970 --> 00:29:39,200
When we talk about,

824
00:29:39,200 --> 00:29:41,630
so red teamer can do their sandbox,

825
00:29:41,630 --> 00:29:42,960
throw it up there,

826
00:29:42,960 --> 00:29:45,480
add a label saying you
should have detected me here,

827
00:29:45,480 --> 00:29:48,630
put the MITRE ATT&CK tag on
that label and then walk away.

828
00:29:48,630 --> 00:29:50,910
And then a blue teamer
pops into their inbox.

829
00:29:50,910 --> 00:29:52,030
Second thing is

830
00:29:52,030 --> 00:29:55,340
purple team.

831
00:29:55,340 --> 00:29:56,580
Purple teaming is so critical,

832
00:29:56,580 --> 00:30:00,210
but typically in an organizations
it's always once a quarter

833
00:30:00,210 --> 00:30:02,970
kind of, you know, awesome play date,

834
00:30:02,970 --> 00:30:05,320
where the red teams and the
blue teams get to play together.

835
00:30:05,320 --> 00:30:06,320
And

836
00:30:06,320 --> 00:30:07,360
that's a paradigm that I feel strongly

837
00:30:07,360 --> 00:30:08,740
we need to break down.

838
00:30:08,740 --> 00:30:09,740
We have a saying,

839
00:30:09,740 --> 00:30:12,940
we want continuous and
asynchronous purple teaming.

840
00:30:12,940 --> 00:30:17,150
And this platform allows that
asynchronous purple teaming,

841
00:30:17,150 --> 00:30:18,440
the red teamer can put that,

842
00:30:18,440 --> 00:30:19,440
put it up.

843
00:30:19,440 --> 00:30:21,840
Blue teamer can prioritize
which things they think

844
00:30:21,840 --> 00:30:23,110
that they need to detect.

845
00:30:23,110 --> 00:30:25,790
Pull that off the shelf,
rate the detections,

846
00:30:25,790 --> 00:30:27,800
test the detections, validate it.

847
00:30:27,800 --> 00:30:28,800
And then, you know,

848
00:30:28,800 --> 00:30:30,850
can band style like work
through that work log,

849
00:30:30,850 --> 00:30:31,929
but it has to be asynchronous.

850
00:30:31,930 --> 00:30:35,160
The chance that a red team and
blue team get to get together

851
00:30:35,160 --> 00:30:37,390
in cyberspace is kind of fair.

852
00:30:37,390 --> 00:30:39,400
But yeah, team sport.

853
00:30:39,400 --> 00:30:41,040
- Thank you for pushing
us in the right direction.

854
00:30:41,040 --> 00:30:42,040
Thank you.
- Yeah.

855
00:30:42,040 --> 00:30:43,040
- Thanks.
- All right.

856
00:30:43,040 --> 00:30:44,040
- Thanks everybody.

857
00:30:44,040 --> 00:30:44,042
(crowd applauding)

