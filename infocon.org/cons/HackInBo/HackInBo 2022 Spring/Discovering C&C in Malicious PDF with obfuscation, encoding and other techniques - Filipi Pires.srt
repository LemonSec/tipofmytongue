1
00:00:15,280 --> 00:00:17,760
dal brazil queen is talking will be in

2
00:00:17,760 --> 00:00:18,800
english

3
00:00:18,800 --> 00:00:20,800
so thank you very much philippe for

4
00:00:20,800 --> 00:00:22,880
being here with us today

5
00:00:22,880 --> 00:00:24,800
discovering discovering common and

6
00:00:24,800 --> 00:00:26,880
controlling malicious pdf with

7
00:00:26,880 --> 00:00:28,840
obfuscation and coding and other

8
00:00:28,840 --> 00:00:31,920
techniques thank you very much and

9
00:00:31,920 --> 00:00:34,399
thank you

10
00:00:36,559 --> 00:00:39,559
okay

11
00:01:07,840 --> 00:01:10,240
hello

12
00:01:10,840 --> 00:01:13,360
hello can you see

13
00:01:13,360 --> 00:01:15,920
let's see

14
00:01:16,479 --> 00:01:18,640
no

15
00:01:25,360 --> 00:01:26,560
okay

16
00:01:26,560 --> 00:01:27,440
so

17
00:01:27,440 --> 00:01:30,599
[Music]

18
00:01:30,960 --> 00:01:32,560
no

19
00:01:32,560 --> 00:01:33,759
why not

20
00:01:33,759 --> 00:01:36,560
i'm sharing

21
00:01:37,360 --> 00:01:38,640
okay

22
00:01:38,640 --> 00:01:42,000
yes yes that's correct it's connected

23
00:01:42,000 --> 00:01:45,520
yes everything connected

24
00:01:45,600 --> 00:01:48,000
another

25
00:01:50,880 --> 00:01:55,479
oh yeah oh that's okay that's okay

26
00:01:58,399 --> 00:02:02,240
awesome yeah that's it's running

27
00:02:07,200 --> 00:02:08,878
once

28
00:02:08,878 --> 00:02:12,000
i know i know why

29
00:02:12,000 --> 00:02:14,800
htcp

30
00:02:16,080 --> 00:02:19,560
you need a scalar

31
00:02:31,840 --> 00:02:34,239
okay

32
00:02:34,400 --> 00:02:37,560
yeah yeah

33
00:02:41,500 --> 00:02:47,090
[Applause]

34
00:02:53,360 --> 00:02:58,239
the most common happen when using mac os

35
00:02:59,120 --> 00:03:02,599
sorry for that

36
00:03:08,400 --> 00:03:11,400
um

37
00:03:27,840 --> 00:03:30,840
okay

38
00:03:50,210 --> 00:03:54,439
[Applause]

39
00:04:12,460 --> 00:04:15,619
[Music]

40
00:04:25,040 --> 00:04:28,040
holy

41
00:04:31,950 --> 00:04:36,938
[Applause]

42
00:04:38,160 --> 00:04:41,560
i think yes

43
00:04:42,320 --> 00:04:45,449
[Music]

44
00:04:53,520 --> 00:04:57,560
we're good what do you think

45
00:05:18,080 --> 00:05:21,719
but i can see here

46
00:05:28,560 --> 00:05:30,479
yes

47
00:05:30,479 --> 00:05:32,000
yes

48
00:05:32,000 --> 00:05:34,400
it's good

49
00:05:35,759 --> 00:05:39,759
yes fingers crossed sorry

50
00:05:40,320 --> 00:05:41,600
thank you thank you thank you thanks so

51
00:05:41,600 --> 00:05:43,680
much sorry for

52
00:05:43,680 --> 00:05:45,680
this problem and um

53
00:05:45,680 --> 00:05:46,890
the idea is to

54
00:05:46,890 --> 00:05:48,240
[Music]

55
00:05:48,240 --> 00:05:50,080
explain first

56
00:05:50,080 --> 00:05:53,039
theory things and after that to do some

57
00:05:53,039 --> 00:05:54,000
demo

58
00:05:54,000 --> 00:05:56,160
in live and because of that cross your

59
00:05:56,160 --> 00:05:57,120
things

60
00:05:57,120 --> 00:05:58,880
because you know how this can happen so

61
00:05:58,880 --> 00:06:00,560
my name is felipe pierce

62
00:06:00,560 --> 00:06:01,759
this is my

63
00:06:01,759 --> 00:06:04,639
contact at twitter and today we're going

64
00:06:04,639 --> 00:06:06,800
to talk about something about the pdf

65
00:06:06,800 --> 00:06:09,840
malicious right so my idea

66
00:06:09,840 --> 00:06:12,000
and this afternoon is to bring you

67
00:06:12,000 --> 00:06:14,319
something about how you can study more

68
00:06:14,319 --> 00:06:17,120
about the malwares ptfs

69
00:06:17,120 --> 00:06:20,400
and and some basis about that okay so

70
00:06:20,400 --> 00:06:22,400
here other information about me i have a

71
00:06:22,400 --> 00:06:23,440
small

72
00:06:23,440 --> 00:06:25,360
web page here you can find other talks

73
00:06:25,360 --> 00:06:27,120
in portuguese and english and spanish if

74
00:06:27,120 --> 00:06:28,080
you want

75
00:06:28,080 --> 00:06:30,560
and some project and research that i'm

76
00:06:30,560 --> 00:06:33,680
i've been doing in my github and the

77
00:06:33,680 --> 00:06:35,759
folder name thread hunting you can find

78
00:06:35,759 --> 00:06:37,120
there if you want

79
00:06:37,120 --> 00:06:38,880
you can

80
00:06:38,880 --> 00:06:41,520
i made some tests using some

81
00:06:41,520 --> 00:06:44,000
security sensors

82
00:06:44,000 --> 00:06:46,240
sofas and crowdstrike

83
00:06:46,240 --> 00:06:48,560
and others and you can find in my github

84
00:06:48,560 --> 00:06:50,080
all those informations of course all

85
00:06:50,080 --> 00:06:52,639
those informations i send this report

86
00:06:52,639 --> 00:06:55,120
from these vendors so it's not a problem

87
00:06:55,120 --> 00:06:57,840
about that okay and i think no no

88
00:06:57,840 --> 00:07:00,880
problem in my linkedin as well so um

89
00:07:00,880 --> 00:07:02,560
now i'm security research of this

90
00:07:02,560 --> 00:07:05,039
company is a startup company

91
00:07:05,039 --> 00:07:06,240
um

92
00:07:06,240 --> 00:07:07,919
i'm responsible for creating the

93
00:07:07,919 --> 00:07:09,919
intelligence for this product i'm

94
00:07:09,919 --> 00:07:11,520
responsible for creating the attack

95
00:07:11,520 --> 00:07:13,919
modules basically this product is

96
00:07:13,919 --> 00:07:15,440
responsible for

97
00:07:15,440 --> 00:07:17,520
looking for attack path management so

98
00:07:17,520 --> 00:07:19,599
understand based on the policies that

99
00:07:19,599 --> 00:07:21,280
you have in the cloud on privacy

100
00:07:21,280 --> 00:07:22,639
environment

101
00:07:22,639 --> 00:07:25,520
it's kind of similar of bloodhound can

102
00:07:25,520 --> 00:07:28,479
you hear about bloodhound right okay and

103
00:07:28,479 --> 00:07:30,240
it's a similar but uh for an enterprise

104
00:07:30,240 --> 00:07:31,759
perspective and i'm responsible for

105
00:07:31,759 --> 00:07:34,560
creating attacks for aws azure id

106
00:07:34,560 --> 00:07:37,680
octa gcp and so on and so on okay

107
00:07:37,680 --> 00:07:40,080
and by the way if you'd like to be a a

108
00:07:40,080 --> 00:07:42,160
better tester we can talk with me after

109
00:07:42,160 --> 00:07:45,199
the talk okay and for aws i create four

110
00:07:45,199 --> 00:07:47,360
attack modules from this specific cloud

111
00:07:47,360 --> 00:07:49,599
and if you want and for the community

112
00:07:49,599 --> 00:07:51,759
view i'm a secure advocate of this

113
00:07:51,759 --> 00:07:53,440
organization since

114
00:07:53,440 --> 00:07:55,840
it's a solution of the plan but the idea

115
00:07:55,840 --> 00:07:57,840
is to talk about the security and spread

116
00:07:57,840 --> 00:07:59,039
the message

117
00:07:59,039 --> 00:08:02,000
and i'm hacking is not a crime advocate

118
00:08:02,000 --> 00:08:03,520
this project is very interesting talk

119
00:08:03,520 --> 00:08:06,319
about the hacking about the future and

120
00:08:06,319 --> 00:08:09,039
what is exactly hacking because

121
00:08:09,039 --> 00:08:11,759
hacking's it's really not a crime okay

122
00:08:11,759 --> 00:08:13,919
if you if the people if the guy is a

123
00:08:13,919 --> 00:08:15,280
lawyer

124
00:08:15,280 --> 00:08:16,560
and

125
00:08:16,560 --> 00:08:18,240
do something bad

126
00:08:18,240 --> 00:08:20,240
continue to be a lawyer but not a lawyer

127
00:08:20,240 --> 00:08:22,960
it's a criminal in this case if this

128
00:08:22,960 --> 00:08:24,160
lawyer

129
00:08:24,160 --> 00:08:26,479
do something bad okay

130
00:08:26,479 --> 00:08:29,599
and the problem is the television and

131
00:08:29,599 --> 00:08:32,320
the newspaper talking about the hacking

132
00:08:32,320 --> 00:08:34,640
has a criminal but it's not a criminal

133
00:08:34,640 --> 00:08:36,320
as we heard during the during the

134
00:08:36,320 --> 00:08:39,440
conference is attacker right as a threat

135
00:08:39,440 --> 00:08:41,440
actor that's the idea behind of this

136
00:08:41,440 --> 00:08:42,799
project okay

137
00:08:42,799 --> 00:08:44,959
and i'm sneak ambassador

138
00:08:44,959 --> 00:08:47,120
uh the open source project of course not

139
00:08:47,120 --> 00:08:49,600
enterprise often for open source so this

140
00:08:49,600 --> 00:08:52,320
idea of this project is to talk about

141
00:08:52,320 --> 00:08:55,360
the how you can develop your product

142
00:08:55,360 --> 00:08:57,839
your environment in a security way using

143
00:08:57,839 --> 00:09:00,000
open source project okay

144
00:09:00,000 --> 00:09:03,600
and i'm lead of the the sg it's a

145
00:09:03,600 --> 00:09:05,600
community in brazil

146
00:09:05,600 --> 00:09:07,600
in sao paulo by the way defcon groups in

147
00:09:07,600 --> 00:09:09,600
sao paulo is a part of the defcon

148
00:09:09,600 --> 00:09:12,000
conference but the groups spread

149
00:09:12,000 --> 00:09:13,760
around the world and i'm structural

150
00:09:13,760 --> 00:09:15,040
writer and have your those three

151
00:09:15,040 --> 00:09:16,800
magazines in europe it's a fantastic

152
00:09:16,800 --> 00:09:18,320
magazine hockey night in a foreign

153
00:09:18,320 --> 00:09:19,839
magazine

154
00:09:19,839 --> 00:09:21,120
okay

155
00:09:21,120 --> 00:09:23,360
take a picture i can send my mother very

156
00:09:23,360 --> 00:09:25,920
interesting for her it's very important

157
00:09:25,920 --> 00:09:28,080
okay anyway so first of all it's very

158
00:09:28,080 --> 00:09:29,519
important to understand about this

159
00:09:29,519 --> 00:09:31,680
simple thing what is a track a thread

160
00:09:31,680 --> 00:09:33,200
probably you know what is a thread it's

161
00:09:33,200 --> 00:09:35,040
not definition from philip this is the

162
00:09:35,040 --> 00:09:36,880
finish from this iso but

163
00:09:36,880 --> 00:09:39,040
exactly what is a threat is a potential

164
00:09:39,040 --> 00:09:42,480
thing that can happen in organization or

165
00:09:42,480 --> 00:09:43,519
company

166
00:09:43,519 --> 00:09:46,080
but it means a software attack or taffy

167
00:09:46,080 --> 00:09:47,760
of the electoral property or maybe

168
00:09:47,760 --> 00:09:50,720
identity death sabotage and information

169
00:09:50,720 --> 00:09:53,440
distortion like a what like a ramson

170
00:09:53,440 --> 00:09:55,600
seber server by the way it's a ransom

171
00:09:55,600 --> 00:09:58,240
kind of ransor it's a it's a server it's

172
00:09:58,240 --> 00:10:01,040
a kind of renzo and

173
00:10:01,040 --> 00:10:03,680
it's a kind of types of

174
00:10:03,680 --> 00:10:06,959
thread so if you see all those things

175
00:10:06,959 --> 00:10:10,320
is focused in specifically software you

176
00:10:10,320 --> 00:10:11,519
have a code

177
00:10:11,519 --> 00:10:13,360
and this code can be

178
00:10:13,360 --> 00:10:15,600
changing a binary or

179
00:10:15,600 --> 00:10:18,399
app right so in the end of the day we

180
00:10:18,399 --> 00:10:21,279
will have a binary behind of the

181
00:10:21,279 --> 00:10:23,440
software we have applications libraries

182
00:10:23,440 --> 00:10:25,120
and stuff like that okay

183
00:10:25,120 --> 00:10:25,920
nice

184
00:10:25,920 --> 00:10:27,519
so when you think about the more

185
00:10:27,519 --> 00:10:29,440
analysis we need to think about this

186
00:10:29,440 --> 00:10:32,000
specifically flow we have an artifact

187
00:10:32,000 --> 00:10:35,040
you need to identify if this simple or

188
00:10:35,040 --> 00:10:37,040
artifact is malicious or not because of

189
00:10:37,040 --> 00:10:38,959
that it's very important right so you

190
00:10:38,959 --> 00:10:39,920
have a

191
00:10:39,920 --> 00:10:41,680
possible malware it's acronym of the

192
00:10:41,680 --> 00:10:43,760
malicious software or you have a maldoc

193
00:10:43,760 --> 00:10:46,560
acronym of the malicious document like a

194
00:10:46,560 --> 00:10:49,200
pdf okay so when you're performing this

195
00:10:49,200 --> 00:10:51,440
you after that you have a simple you

196
00:10:51,440 --> 00:10:53,040
need to change what the best methodology

197
00:10:53,040 --> 00:10:55,600
you can apply i mean you can choose what

198
00:10:55,600 --> 00:10:57,279
the best approach you can use like

199
00:10:57,279 --> 00:10:58,399
statistical analysis and the naming

200
00:10:58,399 --> 00:11:01,360
canals when you do that

201
00:11:01,360 --> 00:11:04,399
my recommendation for for knowledgement

202
00:11:04,399 --> 00:11:06,720
you need always register all those steps

203
00:11:06,720 --> 00:11:09,839
that you are looking for on the pdf

204
00:11:09,839 --> 00:11:10,800
why

205
00:11:10,800 --> 00:11:12,839
because first we will learn about that

206
00:11:12,839 --> 00:11:16,000
right you understand those steps

207
00:11:16,000 --> 00:11:17,680
executed by the attack

208
00:11:17,680 --> 00:11:20,079
not only that but you can create a

209
00:11:20,079 --> 00:11:21,600
report

210
00:11:21,600 --> 00:11:23,839
and after that you can create an article

211
00:11:23,839 --> 00:11:25,680
think think about that

212
00:11:25,680 --> 00:11:27,120
and if you create this report you can

213
00:11:27,120 --> 00:11:29,040
present to you this of your manager your

214
00:11:29,040 --> 00:11:30,480
coordinator

215
00:11:30,480 --> 00:11:32,240
right it's very important to you you

216
00:11:32,240 --> 00:11:33,600
will learn

217
00:11:33,600 --> 00:11:34,640
and you can

218
00:11:34,640 --> 00:11:36,240
sell your work

219
00:11:36,240 --> 00:11:37,120
okay

220
00:11:37,120 --> 00:11:39,120
and not only that but

221
00:11:39,120 --> 00:11:41,040
you can improve your defense's mechanism

222
00:11:41,040 --> 00:11:43,760
why because you will understand what

223
00:11:43,760 --> 00:11:46,880
exactly technique used by the attacker

224
00:11:46,880 --> 00:11:48,720
to bypass

225
00:11:48,720 --> 00:11:50,560
your environment so because of that

226
00:11:50,560 --> 00:11:53,360
import and you can create this kind of

227
00:11:53,360 --> 00:11:55,279
beautiful word called the cyber threat

228
00:11:55,279 --> 00:11:56,959
intelligence it is a very nice word

229
00:11:56,959 --> 00:11:59,600
right but the real life is not too

230
00:11:59,600 --> 00:12:00,959
easy but anyway

231
00:12:00,959 --> 00:12:03,279
but if a small company knows you can

232
00:12:03,279 --> 00:12:05,440
work with that or you can

233
00:12:05,440 --> 00:12:07,440
using

234
00:12:07,440 --> 00:12:09,360
other service and of course we need to

235
00:12:09,360 --> 00:12:10,639
have this kind of strengthening

236
00:12:10,639 --> 00:12:12,320
resilience but philip what is exactly

237
00:12:12,320 --> 00:12:14,320
statistical analysis simple definition

238
00:12:14,320 --> 00:12:16,480
uses usually is the first step using by

239
00:12:16,480 --> 00:12:19,920
the analyst why because this is is a

240
00:12:19,920 --> 00:12:22,320
kind of analysis that describe the

241
00:12:22,320 --> 00:12:23,519
process

242
00:12:23,519 --> 00:12:26,480
that you are analyzing the binary

243
00:12:26,480 --> 00:12:28,880
you doesn't execute itself the binary

244
00:12:28,880 --> 00:12:31,440
you understand those process or

245
00:12:31,440 --> 00:12:33,839
if you can see for example if the binary

246
00:12:33,839 --> 00:12:35,920
have a specifically function that these

247
00:12:35,920 --> 00:12:38,160
functions is imported by specifically

248
00:12:38,160 --> 00:12:39,360
dll

249
00:12:39,360 --> 00:12:40,959
or library for

250
00:12:40,959 --> 00:12:43,680
the unix platform for example so in this

251
00:12:43,680 --> 00:12:45,040
case it's

252
00:12:45,040 --> 00:12:47,680
more safe of course it's more okay

253
00:12:47,680 --> 00:12:50,000
because doesn't run at this time the

254
00:12:50,000 --> 00:12:51,680
binary on the other hand you have a

255
00:12:51,680 --> 00:12:53,200
dynamic analysis just a simple

256
00:12:53,200 --> 00:12:55,680
definition basically is based on the

257
00:12:55,680 --> 00:12:58,560
runtime analysis you execute this binary

258
00:12:58,560 --> 00:13:00,399
or the sample in a controlled

259
00:13:00,399 --> 00:13:02,560
environment or is using specifically

260
00:13:02,560 --> 00:13:04,800
tools and they will give a result and

261
00:13:04,800 --> 00:13:06,800
that's the key here in our conversation

262
00:13:06,800 --> 00:13:08,240
today

263
00:13:08,240 --> 00:13:10,639
you can use many tools

264
00:13:10,639 --> 00:13:12,160
and usually when you talk about the

265
00:13:12,160 --> 00:13:14,079
offensive security offensive perspective

266
00:13:14,079 --> 00:13:16,240
or the penetration tester or whatever

267
00:13:16,240 --> 00:13:18,240
you think about how are you using burp

268
00:13:18,240 --> 00:13:19,200
suite

269
00:13:19,200 --> 00:13:22,000
to analyze the request and i will use

270
00:13:22,000 --> 00:13:23,839
sql sql map

271
00:13:23,839 --> 00:13:26,240
to executing specifically sql injection

272
00:13:26,240 --> 00:13:29,279
attack but we're using tools

273
00:13:29,279 --> 00:13:31,760
but if someone asking you about for

274
00:13:31,760 --> 00:13:33,760
example using burp suite so how is the

275
00:13:33,760 --> 00:13:35,839
handshake of the tls

276
00:13:35,839 --> 00:13:37,279
oh my goodness

277
00:13:37,279 --> 00:13:38,880
some people ask him about that so how

278
00:13:38,880 --> 00:13:42,880
this works the tls handshake

279
00:13:42,880 --> 00:13:44,720
this is the very common question from

280
00:13:44,720 --> 00:13:47,279
the atr team right not atr team but the

281
00:13:47,279 --> 00:13:49,680
technical interview right

282
00:13:49,680 --> 00:13:51,760
and i am seeing many

283
00:13:51,760 --> 00:13:53,760
questions about that not only that but

284
00:13:53,760 --> 00:13:56,079
about other technic stuffs and talk

285
00:13:56,079 --> 00:13:57,839
about the power or defensive perspective

286
00:13:57,839 --> 00:14:00,160
or offensive perspective and my question

287
00:14:00,160 --> 00:14:01,760
not my question but my point here during

288
00:14:01,760 --> 00:14:03,199
our conversations

289
00:14:03,199 --> 00:14:06,639
you need like me understand because i'm

290
00:14:06,639 --> 00:14:09,279
studying i need to learn about that how

291
00:14:09,279 --> 00:14:10,480
this works

292
00:14:10,480 --> 00:14:12,160
and more deeply right

293
00:14:12,160 --> 00:14:13,920
so dynamic analysis i was a good

294
00:14:13,920 --> 00:14:17,120
teaching using tools and i can use it i

295
00:14:17,120 --> 00:14:18,800
can automate the process using using

296
00:14:18,800 --> 00:14:19,760
this

297
00:14:19,760 --> 00:14:21,839
concept calling sandbox

298
00:14:21,839 --> 00:14:24,399
do you know what is exactly sandbox

299
00:14:24,399 --> 00:14:25,199
right

300
00:14:25,199 --> 00:14:26,959
so if you don't know what is a sandbox

301
00:14:26,959 --> 00:14:29,040
sandbox is a specifically controlled

302
00:14:29,040 --> 00:14:30,639
environment that you can put in this

303
00:14:30,639 --> 00:14:32,399
binary like this this pointer is a

304
00:14:32,399 --> 00:14:34,399
binary i will put this binary inside of

305
00:14:34,399 --> 00:14:36,480
this sandbox a control and environment

306
00:14:36,480 --> 00:14:38,560
and then i will run this binary inside

307
00:14:38,560 --> 00:14:39,440
of that

308
00:14:39,440 --> 00:14:41,600
and now you see if this binary is

309
00:14:41,600 --> 00:14:44,560
malicious or not right

310
00:14:44,560 --> 00:14:45,519
so

311
00:14:45,519 --> 00:14:47,120
if sandbox

312
00:14:47,120 --> 00:14:49,199
is a virtual machine that i can execute

313
00:14:49,199 --> 00:14:51,760
my binary inside of that

314
00:14:51,760 --> 00:14:54,160
so i can basically

315
00:14:54,160 --> 00:14:55,920
open my virtualbox

316
00:14:55,920 --> 00:14:57,920
install virtual machine and i have a

317
00:14:57,920 --> 00:15:00,720
sandbox is that correct

318
00:15:00,720 --> 00:15:02,880
no

319
00:15:03,680 --> 00:15:04,800
no

320
00:15:04,800 --> 00:15:07,120
because the sandbox that we're using for

321
00:15:07,120 --> 00:15:09,440
our analysis for example or using for

322
00:15:09,440 --> 00:15:11,920
executing malicious things inside of

323
00:15:11,920 --> 00:15:14,160
this the controlled environment you need

324
00:15:14,160 --> 00:15:15,120
to have

325
00:15:15,120 --> 00:15:17,920
the engines responsible for detect if

326
00:15:17,920 --> 00:15:20,000
this binary is malicious or not

327
00:15:20,000 --> 00:15:21,760
that's the key

328
00:15:21,760 --> 00:15:23,279
when you execute when you put in your

329
00:15:23,279 --> 00:15:25,839
binary in the antivirus and vero's total

330
00:15:25,839 --> 00:15:27,440
scanning

331
00:15:27,440 --> 00:15:29,360
you know how this works inside of the

332
00:15:29,360 --> 00:15:31,680
virustotal we have many engines

333
00:15:31,680 --> 00:15:33,279
providing from different security

334
00:15:33,279 --> 00:15:36,079
vendors like a set like mcafee like a

335
00:15:36,079 --> 00:15:38,560
trend micro like many others and

336
00:15:38,560 --> 00:15:40,720
specifically engines

337
00:15:40,720 --> 00:15:42,560
for example essentials here

338
00:15:42,560 --> 00:15:43,839
oh my goodness

339
00:15:43,839 --> 00:15:45,759
and

340
00:15:45,759 --> 00:15:47,360
probably they have

341
00:15:47,360 --> 00:15:49,360
some engines inside of that and if

342
00:15:49,360 --> 00:15:51,360
you're looking from the product from the

343
00:15:51,360 --> 00:15:52,240
set

344
00:15:52,240 --> 00:15:55,440
probably you need to enable specifically

345
00:15:55,440 --> 00:15:57,040
checkbox

346
00:15:57,040 --> 00:15:59,759
for increased detection because of that

347
00:15:59,759 --> 00:16:01,199
when you put in the binary inside of the

348
00:16:01,199 --> 00:16:03,440
antivirus the virustotal

349
00:16:03,440 --> 00:16:05,199
you're looking for i have the solution

350
00:16:05,199 --> 00:16:08,800
like a kaspersky or other but my binary

351
00:16:08,800 --> 00:16:11,519
didn't attack has a malicious why

352
00:16:11,519 --> 00:16:12,959
because if you see from the vendor

353
00:16:12,959 --> 00:16:14,560
perspective they haven't specifically

354
00:16:14,560 --> 00:16:17,040
checked or to enable because of that

355
00:16:17,040 --> 00:16:18,880
didn't attack the solution

356
00:16:18,880 --> 00:16:20,839
okay because of that it's very important

357
00:16:20,839 --> 00:16:23,759
understand not only how to use in the

358
00:16:23,759 --> 00:16:26,720
tools but how is the result

359
00:16:26,720 --> 00:16:28,480
when you putting something inside of

360
00:16:28,480 --> 00:16:31,600
these tools okay so nice

361
00:16:31,600 --> 00:16:32,399
so

362
00:16:32,399 --> 00:16:34,000
before to talk about the logic of the

363
00:16:34,000 --> 00:16:36,320
pdf i would like to show something more

364
00:16:36,320 --> 00:16:38,079
about this

365
00:16:38,079 --> 00:16:39,600
specifically

366
00:16:39,600 --> 00:16:42,480
and where is my virto machine

367
00:16:42,480 --> 00:16:44,639
okay cross your fingers now because it's

368
00:16:44,639 --> 00:16:46,079
here for you

369
00:16:46,079 --> 00:16:47,600
and i can see you here

370
00:16:47,600 --> 00:16:52,560
anyway let me try okay

371
00:16:54,320 --> 00:16:58,880
so can you hear me nice okay i will try

372
00:16:58,880 --> 00:17:00,639
i'm looking from this other

373
00:17:00,639 --> 00:17:02,959
here let's put in my

374
00:17:02,959 --> 00:17:04,959
here okay

375
00:17:04,959 --> 00:17:06,880
so i have here some documents okay can

376
00:17:06,880 --> 00:17:08,160
you see

377
00:17:08,160 --> 00:17:09,919
many documents

378
00:17:09,919 --> 00:17:12,000
first of all are you using file comment

379
00:17:12,000 --> 00:17:13,359
can you

380
00:17:13,359 --> 00:17:15,760
can you some people know this comment

381
00:17:15,760 --> 00:17:18,720
right file okay so fio i will looking

382
00:17:18,720 --> 00:17:20,559
for amazon first

383
00:17:20,559 --> 00:17:22,880
this is my friend amazon it's a it's a

384
00:17:22,880 --> 00:17:25,599
microsoft word document right so i have

385
00:17:25,599 --> 00:17:27,679
another friend called bu

386
00:17:27,679 --> 00:17:29,039
very nice guy

387
00:17:29,039 --> 00:17:32,960
it's a pdf nice and i have another

388
00:17:32,960 --> 00:17:35,039
i think i have something like a mower

389
00:17:35,039 --> 00:17:36,400
here

390
00:17:36,400 --> 00:17:38,000
let's see

391
00:17:38,000 --> 00:17:39,919
i think it's

392
00:17:39,919 --> 00:17:41,280
malware

393
00:17:41,280 --> 00:17:42,880
right

394
00:17:42,880 --> 00:17:45,679
it's a ascii text okay

395
00:17:45,679 --> 00:17:47,360
so

396
00:17:47,360 --> 00:17:49,630
let me try see more about the

397
00:17:49,630 --> 00:17:50,880
[Music]

398
00:17:50,880 --> 00:17:54,080
let me read this document mower

399
00:17:54,080 --> 00:17:57,200
it's a simple python script that's okay

400
00:17:57,200 --> 00:17:59,360
i think yes let me looking for another

401
00:17:59,360 --> 00:18:01,840
i'm cruising curious for this another

402
00:18:01,840 --> 00:18:04,240
thor like pdf

403
00:18:04,240 --> 00:18:06,000
it's a pdf document

404
00:18:06,000 --> 00:18:06,960
nice

405
00:18:06,960 --> 00:18:09,919
okay we have a different documents here

406
00:18:09,919 --> 00:18:13,360
but is another point is

407
00:18:13,360 --> 00:18:16,480
how the file

408
00:18:16,480 --> 00:18:19,200
binary or two works

409
00:18:19,200 --> 00:18:21,679
they need to find something in a

410
00:18:21,679 --> 00:18:24,080
specifically binary to identify remember

411
00:18:24,080 --> 00:18:26,880
the first step identification steps

412
00:18:26,880 --> 00:18:27,600
so

413
00:18:27,600 --> 00:18:29,919
do you know what is exact

414
00:18:29,919 --> 00:18:32,000
this part of the code or this part of

415
00:18:32,000 --> 00:18:35,200
the binary that the file you find

416
00:18:35,200 --> 00:18:37,600
to identify this binary

417
00:18:37,600 --> 00:18:39,200
can you try

418
00:18:39,200 --> 00:18:42,200
someone

419
00:18:42,559 --> 00:18:44,160
the magic

420
00:18:44,160 --> 00:18:46,799
the magic

421
00:18:46,799 --> 00:18:48,960
wait

422
00:18:48,960 --> 00:18:49,919
so

423
00:18:49,919 --> 00:18:51,840
anyone

424
00:18:51,840 --> 00:18:53,520
the magic

425
00:18:53,520 --> 00:18:56,960
probably they look in my presentations

426
00:18:56,960 --> 00:18:59,679
let's look in from the manual

427
00:18:59,679 --> 00:19:02,640
is a determiner type file

428
00:19:02,640 --> 00:19:05,360
let's see what happened here

429
00:19:05,360 --> 00:19:08,720
and they have something like magic here

430
00:19:08,720 --> 00:19:10,400
i think

431
00:19:10,400 --> 00:19:13,360
take a look here take a look here

432
00:19:13,360 --> 00:19:15,919
what's your name my friend

433
00:19:15,919 --> 00:19:17,039
fredrick

434
00:19:17,039 --> 00:19:19,360
exactly answer

435
00:19:19,360 --> 00:19:23,039
they're looking for the magic number

436
00:19:23,440 --> 00:19:24,640
exactly

437
00:19:24,640 --> 00:19:26,320
magic number that's the information that

438
00:19:26,320 --> 00:19:27,919
fio

439
00:19:27,919 --> 00:19:28,880
find

440
00:19:28,880 --> 00:19:30,720
or search

441
00:19:30,720 --> 00:19:31,600
where

442
00:19:31,600 --> 00:19:34,080
if you see the the text

443
00:19:34,080 --> 00:19:35,520
they find it

444
00:19:35,520 --> 00:19:36,799
no mick okay

445
00:19:36,799 --> 00:19:38,799
a store in particular placing the

446
00:19:38,799 --> 00:19:40,960
beginning of the file so that's the

447
00:19:40,960 --> 00:19:42,799
information that the file you're using

448
00:19:42,799 --> 00:19:45,120
to find this information

449
00:19:45,120 --> 00:19:46,320
okay

450
00:19:46,320 --> 00:19:47,440
nice

451
00:19:47,440 --> 00:19:49,360
let me turn here

452
00:19:49,360 --> 00:19:51,679
if i have here

453
00:19:51,679 --> 00:19:54,400
one specifically python script in this

454
00:19:54,400 --> 00:19:57,440
case in this file

455
00:19:57,440 --> 00:19:59,280
malware

456
00:19:59,280 --> 00:20:01,520
let me try as i could this file let's

457
00:20:01,520 --> 00:20:03,280
see what happened now

458
00:20:03,280 --> 00:20:07,440
what do you think what do you think

459
00:20:07,440 --> 00:20:09,360
it works

460
00:20:09,360 --> 00:20:10,400
nice

461
00:20:10,400 --> 00:20:12,320
but if you see the file don't have

462
00:20:12,320 --> 00:20:14,080
extension

463
00:20:14,080 --> 00:20:15,120
okay

464
00:20:15,120 --> 00:20:15,919
okay

465
00:20:15,919 --> 00:20:17,280
so let me

466
00:20:17,280 --> 00:20:20,080
change something here

467
00:20:20,080 --> 00:20:22,480
hello

468
00:20:23,440 --> 00:20:27,120
okay let me change something here

469
00:20:27,120 --> 00:20:28,960
let's see what happened if i put this

470
00:20:28,960 --> 00:20:33,039
three double quotes here and i will save

471
00:20:33,039 --> 00:20:36,320
and take a look what happened now

472
00:20:36,480 --> 00:20:39,360
file malware

473
00:20:39,600 --> 00:20:41,840
now is not more

474
00:20:41,840 --> 00:20:44,720
only ascii text but if you see now it's

475
00:20:44,720 --> 00:20:49,480
a python script executable

476
00:20:49,679 --> 00:20:53,200
let me do other things let me go to the

477
00:20:53,200 --> 00:20:54,720
the tor

478
00:20:54,720 --> 00:20:56,159
pdf

479
00:20:56,159 --> 00:20:57,360
file

480
00:20:57,360 --> 00:21:00,240
in this case it's a pdf right okay

481
00:21:00,240 --> 00:21:03,039
let me try read this

482
00:21:03,039 --> 00:21:05,440
file

483
00:21:10,080 --> 00:21:13,678
is a pdf okay

484
00:21:14,000 --> 00:21:15,760
let's

485
00:21:15,760 --> 00:21:18,879
good always happen this

486
00:21:22,880 --> 00:21:25,200
okay

487
00:21:27,200 --> 00:21:29,039
double check

488
00:21:29,039 --> 00:21:33,360
i always close your fingers now

489
00:21:34,720 --> 00:21:36,880
oh username thank you

490
00:21:36,880 --> 00:21:41,559
i'm trying looking here but you know

491
00:21:47,840 --> 00:21:50,320
some people are looking they will open

492
00:21:50,320 --> 00:21:52,320
the password

493
00:21:52,320 --> 00:21:54,799
okay where is the other

494
00:21:54,799 --> 00:21:57,919
ah okay i remember okay another here

495
00:21:57,919 --> 00:22:00,320
simple

496
00:22:00,559 --> 00:22:04,200
file simple.txt

497
00:22:04,480 --> 00:22:06,799
no not text it's a it's a python script

498
00:22:06,799 --> 00:22:08,400
okay

499
00:22:08,400 --> 00:22:10,640
let's see what happened now

500
00:22:10,640 --> 00:22:13,679
let me check here

501
00:22:13,679 --> 00:22:15,120
it's difficult to read for the the

502
00:22:15,120 --> 00:22:16,640
monitor you know

503
00:22:16,640 --> 00:22:19,200
but anyway

504
00:22:19,200 --> 00:22:22,159
you see in this case it's another python

505
00:22:22,159 --> 00:22:24,880
script as you can see here right

506
00:22:24,880 --> 00:22:26,240
being

507
00:22:26,240 --> 00:22:27,760
is a simple

508
00:22:27,760 --> 00:22:29,760
python script to you know removing

509
00:22:29,760 --> 00:22:32,080
special characters for

510
00:22:32,080 --> 00:22:34,720
specifically function okay remember that

511
00:22:34,720 --> 00:22:37,039
i changing i put in specifically

512
00:22:37,039 --> 00:22:39,200
think in the beginning of the my other

513
00:22:39,200 --> 00:22:43,679
file called malware remember cat mower

514
00:22:46,400 --> 00:22:49,840
remember that the quotes here

515
00:22:49,840 --> 00:22:51,600
okay

516
00:22:51,600 --> 00:22:53,440
here

517
00:22:53,440 --> 00:22:56,000
so now changing the file so if i try as

518
00:22:56,000 --> 00:22:57,200
i could this

519
00:22:57,200 --> 00:23:00,159
mower despite this file now take a look

520
00:23:00,159 --> 00:23:02,720
what happened

521
00:23:05,679 --> 00:23:08,640
some problem it's happened here

522
00:23:08,640 --> 00:23:10,799
why

523
00:23:10,799 --> 00:23:13,600
but if you see fio identify has a python

524
00:23:13,600 --> 00:23:14,400
right

525
00:23:14,400 --> 00:23:16,640
but if i try to use in python it doesn't

526
00:23:16,640 --> 00:23:17,840
works

527
00:23:17,840 --> 00:23:19,840
something can happen here in this case

528
00:23:19,840 --> 00:23:21,520
the answer of the log is about this

529
00:23:21,520 --> 00:23:22,880
probably some

530
00:23:22,880 --> 00:23:25,200
thing about the syntax okay

531
00:23:25,200 --> 00:23:28,240
so let me change the other thing here so

532
00:23:28,240 --> 00:23:31,919
if i change again this is my file

533
00:23:31,919 --> 00:23:35,039
now and i will cut here

534
00:23:35,039 --> 00:23:36,400
you cut here

535
00:23:36,400 --> 00:23:37,360
okay

536
00:23:37,360 --> 00:23:40,260
and i put percent pdf-1.9

537
00:23:40,260 --> 00:23:43,200
[Music]

538
00:23:43,200 --> 00:23:45,200
and i will save

539
00:23:45,200 --> 00:23:46,640
okay

540
00:23:46,640 --> 00:23:51,320
and i will try see what happen now

541
00:23:52,000 --> 00:23:54,400
malware

542
00:23:54,400 --> 00:23:57,840
now we have a pdf document

543
00:23:57,840 --> 00:23:59,360
nice

544
00:23:59,360 --> 00:24:00,320
so

545
00:24:00,320 --> 00:24:03,840
if you use for example pdf id

546
00:24:03,840 --> 00:24:06,799
see this file

547
00:24:07,200 --> 00:24:09,440
we have the tools works

548
00:24:09,440 --> 00:24:10,880
the tools

549
00:24:10,880 --> 00:24:13,760
it works pdf id basically is a tool from

550
00:24:13,760 --> 00:24:15,679
the dj stevens researcher that create

551
00:24:15,679 --> 00:24:16,840
these

552
00:24:16,840 --> 00:24:19,520
tools is a pdf right

553
00:24:19,520 --> 00:24:20,559
nice

554
00:24:20,559 --> 00:24:21,679
because

555
00:24:21,679 --> 00:24:24,240
these tools analyze

556
00:24:24,240 --> 00:24:26,799
the header of the ptf and the magic

557
00:24:26,799 --> 00:24:28,240
number one of this information of the

558
00:24:28,240 --> 00:24:30,320
header of the pdf

559
00:24:30,320 --> 00:24:31,760
is a percent

560
00:24:31,760 --> 00:24:33,360
pdf has i put in the beginning of the

561
00:24:33,360 --> 00:24:34,320
file

562
00:24:34,320 --> 00:24:35,200
right

563
00:24:35,200 --> 00:24:36,640
if i

564
00:24:36,640 --> 00:24:39,440
let me change other thing this

565
00:24:39,440 --> 00:24:41,360
here to show you

566
00:24:41,360 --> 00:24:42,159
okay

567
00:24:42,159 --> 00:24:44,960
so now i will

568
00:24:44,960 --> 00:24:46,640
take this point

569
00:24:46,640 --> 00:24:47,520
i will put in

570
00:24:47,520 --> 00:24:50,000
[Music]

571
00:24:50,000 --> 00:24:52,960
move mower

572
00:24:54,080 --> 00:24:56,559
i will change the name

573
00:24:56,559 --> 00:24:58,960
mower

574
00:24:58,960 --> 00:25:01,840
doc pd pdf

575
00:25:01,919 --> 00:25:04,400
and i will go to once again

576
00:25:04,400 --> 00:25:06,799
here

577
00:25:07,520 --> 00:25:09,840
okay

578
00:25:10,799 --> 00:25:13,600
doc pdf

579
00:25:13,600 --> 00:25:15,520
and now you cut this

580
00:25:15,520 --> 00:25:17,520
and i will save

581
00:25:17,520 --> 00:25:20,640
you see what happened now i change once

582
00:25:20,640 --> 00:25:22,720
again the magic number

583
00:25:22,720 --> 00:25:25,679
and i will try to using

584
00:25:25,679 --> 00:25:26,840
the

585
00:25:26,840 --> 00:25:29,760
same command

586
00:25:29,760 --> 00:25:32,000
but now

587
00:25:32,000 --> 00:25:34,320
i will put why

588
00:25:34,320 --> 00:25:37,279
i put in the file using the extension of

589
00:25:37,279 --> 00:25:38,559
the pdf

590
00:25:38,559 --> 00:25:39,760
so

591
00:25:39,760 --> 00:25:42,640
it works right

592
00:25:42,640 --> 00:25:44,640
no

593
00:25:44,640 --> 00:25:46,960
why

594
00:25:47,120 --> 00:25:51,679
so you see i'm using two tools

595
00:25:51,679 --> 00:25:54,880
and i'm i'm i'm i'm do something

596
00:25:54,880 --> 00:25:55,679
fun

597
00:25:55,679 --> 00:25:58,720
with the magic number of the file

598
00:25:58,720 --> 00:26:00,080
because of that it's important when

599
00:26:00,080 --> 00:26:01,919
you're executing specifically tools you

600
00:26:01,919 --> 00:26:04,080
not only use it but you receive the logs

601
00:26:04,080 --> 00:26:05,440
from these tools

602
00:26:05,440 --> 00:26:07,600
remember that when you execute your

603
00:26:07,600 --> 00:26:09,600
researchers your analysis

604
00:26:09,600 --> 00:26:11,360
you need to looking more deeply about

605
00:26:11,360 --> 00:26:12,799
how this works

606
00:26:12,799 --> 00:26:14,480
for example

607
00:26:14,480 --> 00:26:16,159
you if you think about

608
00:26:16,159 --> 00:26:20,880
for example about them let's go to my

609
00:26:21,600 --> 00:26:23,600
linux folder

610
00:26:23,600 --> 00:26:26,000
i have here

611
00:26:26,000 --> 00:26:29,679
some hours i think now it's hours i just

612
00:26:29,679 --> 00:26:32,000
using hours in my demonstrations and my

613
00:26:32,000 --> 00:26:33,760
course is always more so something

614
00:26:33,760 --> 00:26:34,720
happen

615
00:26:34,720 --> 00:26:37,279
i'm

616
00:26:37,279 --> 00:26:39,279
okay anyway

617
00:26:39,279 --> 00:26:40,799
in this case

618
00:26:40,799 --> 00:26:42,720
if you see

619
00:26:42,720 --> 00:26:46,640
um let me using um i would try i think

620
00:26:46,640 --> 00:26:49,880
it's agne32

621
00:26:50,840 --> 00:26:52,880
airbus okay

622
00:26:52,880 --> 00:26:55,840
so i'm looking now for the specific

623
00:26:55,840 --> 00:26:57,919
specifically hexadecimal informations in

624
00:26:57,919 --> 00:27:00,000
the beginning of this this elf is a

625
00:27:00,000 --> 00:27:03,039
binary from linux okay

626
00:27:03,039 --> 00:27:05,120
if you see here take a look that this is

627
00:27:05,120 --> 00:27:07,200
the string right

628
00:27:07,200 --> 00:27:10,320
in the beginning of the file you can see

629
00:27:10,320 --> 00:27:13,279
yeah nice this is the first string that

630
00:27:13,279 --> 00:27:15,279
appears for us right

631
00:27:15,279 --> 00:27:16,880
okay

632
00:27:16,880 --> 00:27:21,520
strings dash a it means all

633
00:27:21,520 --> 00:27:23,760
airbus

634
00:27:23,760 --> 00:27:28,399
pipeless because the fire is too big

635
00:27:28,399 --> 00:27:29,919
okay

636
00:27:29,919 --> 00:27:33,960
so i started since the beginning

637
00:27:34,000 --> 00:27:37,279
first string is elf

638
00:27:37,279 --> 00:27:38,960
no

639
00:27:38,960 --> 00:27:40,720
why

640
00:27:40,720 --> 00:27:41,840
or

641
00:27:41,840 --> 00:27:42,880
how

642
00:27:42,880 --> 00:27:45,679
how it's possible

643
00:27:46,320 --> 00:27:47,440
good

644
00:27:47,440 --> 00:27:49,760
so it's a simple question a stupid

645
00:27:49,760 --> 00:27:52,080
question i know

646
00:27:52,080 --> 00:27:54,720
but for if you read these informations

647
00:27:54,720 --> 00:27:57,440
here in the manual

648
00:27:57,440 --> 00:28:01,360
you understand exactly the answer

649
00:28:01,440 --> 00:28:04,240
i don't like read manual by the way

650
00:28:04,240 --> 00:28:06,559
if you like nice but if you don't like

651
00:28:06,559 --> 00:28:08,399
like me

652
00:28:08,399 --> 00:28:10,480
but anyway we in our

653
00:28:10,480 --> 00:28:13,200
career we need in our field security we

654
00:28:13,200 --> 00:28:17,080
need to read this is the answer

655
00:28:19,200 --> 00:28:21,120
string prints the printable character

656
00:28:21,120 --> 00:28:24,240
sequences that are at least four

657
00:28:24,240 --> 00:28:25,440
characters

658
00:28:25,440 --> 00:28:27,279
just because of that

659
00:28:27,279 --> 00:28:28,480
you see

660
00:28:28,480 --> 00:28:31,120
so they need to have the four sequence

661
00:28:31,120 --> 00:28:33,600
simple like this because probably when

662
00:28:33,600 --> 00:28:35,440
you receive and specifically sample the

663
00:28:35,440 --> 00:28:37,039
first step you will executing this

664
00:28:37,039 --> 00:28:38,000
string

665
00:28:38,000 --> 00:28:40,720
it is putting the string dash a

666
00:28:40,720 --> 00:28:42,000
uh

667
00:28:42,000 --> 00:28:44,000
putting copy all those information for

668
00:28:44,000 --> 00:28:45,760
specifically them text and then you read

669
00:28:45,760 --> 00:28:46,880
the text

670
00:28:46,880 --> 00:28:49,440
to see because you cannot you would

671
00:28:49,440 --> 00:28:51,279
want to manipulate the malicious in your

672
00:28:51,279 --> 00:28:52,960
environment right so we will copy these

673
00:28:52,960 --> 00:28:55,120
strings in a specifically text file you

674
00:28:55,120 --> 00:28:58,880
will read more calm relax but

675
00:28:58,880 --> 00:29:01,039
some informations you can read

676
00:29:01,039 --> 00:29:03,279
didn't appear there because

677
00:29:03,279 --> 00:29:06,080
the string didn't appear

678
00:29:06,080 --> 00:29:09,039
or will appears at least four

679
00:29:09,039 --> 00:29:10,320
sequence

680
00:29:10,320 --> 00:29:11,600
this is the key

681
00:29:11,600 --> 00:29:13,279
remember in the beginning of the talk i

682
00:29:13,279 --> 00:29:15,840
mentioned it with you so my idea is to

683
00:29:15,840 --> 00:29:17,360
bring this information to you to

684
00:29:17,360 --> 00:29:19,440
understand those steps and how important

685
00:29:19,440 --> 00:29:21,840
it is for your study your evolutions

686
00:29:21,840 --> 00:29:23,200
because it's important for me i'm

687
00:29:23,200 --> 00:29:24,720
studying and i think it's important for

688
00:29:24,720 --> 00:29:27,200
me so maybe maybe it's important for you

689
00:29:27,200 --> 00:29:29,279
okay nice

690
00:29:29,279 --> 00:29:31,360
let me return in my

691
00:29:31,360 --> 00:29:32,799
presentation

692
00:29:32,799 --> 00:29:34,799
okay so let's talk about the physical

693
00:29:34,799 --> 00:29:38,399
and logical structure about the pdf

694
00:29:38,399 --> 00:29:40,960
pdf in general have four parts right so

695
00:29:40,960 --> 00:29:42,799
the first is header

696
00:29:42,799 --> 00:29:44,880
it's all this is very similar for

697
00:29:44,880 --> 00:29:46,960
different binaries always has a header

698
00:29:46,960 --> 00:29:48,000
okay

699
00:29:48,000 --> 00:29:50,320
a body is a part of the you know

700
00:29:50,320 --> 00:29:52,399
like a font or other things like this

701
00:29:52,399 --> 00:29:54,799
they have a cross reference table is a

702
00:29:54,799 --> 00:29:56,000
part of the

703
00:29:56,000 --> 00:29:58,159
the correlation of the object and the

704
00:29:58,159 --> 00:30:00,720
trailer it more informations i will

705
00:30:00,720 --> 00:30:01,679
share

706
00:30:01,679 --> 00:30:05,200
with you in the next slide

707
00:30:05,200 --> 00:30:09,399
okay so we

708
00:30:10,080 --> 00:30:11,679
oh hello

709
00:30:11,679 --> 00:30:14,320
i'm here in this one okay

710
00:30:14,320 --> 00:30:16,480
and if you see here

711
00:30:16,480 --> 00:30:19,919
here the structure of the pdf okay we

712
00:30:19,919 --> 00:30:21,200
have in the beginning the body has i

713
00:30:21,200 --> 00:30:23,760
mentioned that with page image phones

714
00:30:23,760 --> 00:30:25,679
and stuff like that what funny things in

715
00:30:25,679 --> 00:30:28,159
the pdf you know the shiny things

716
00:30:28,159 --> 00:30:30,240
and cross reference table basically is

717
00:30:30,240 --> 00:30:32,799
the location of the object i mean you

718
00:30:32,799 --> 00:30:34,880
have in the beginning the root

719
00:30:34,880 --> 00:30:37,200
object in the pdf

720
00:30:37,200 --> 00:30:40,320
in this root we have a child like object

721
00:30:40,320 --> 00:30:43,039
two and object three

722
00:30:43,039 --> 00:30:45,760
and those in in these others object like

723
00:30:45,760 --> 00:30:48,480
two and three you can have you can have

724
00:30:48,480 --> 00:30:49,440
other

725
00:30:49,440 --> 00:30:52,880
childs of this object like at three okay

726
00:30:52,880 --> 00:30:54,320
one connect to

727
00:30:54,320 --> 00:30:56,880
an object two and object two maybe can

728
00:30:56,880 --> 00:31:00,240
connect an object to where v13 depends

729
00:31:00,240 --> 00:31:02,240
it depends of the how many objects you

730
00:31:02,240 --> 00:31:04,960
have inside of this pdf okay

731
00:31:04,960 --> 00:31:08,240
because of that the access is random

732
00:31:08,240 --> 00:31:11,039
inside of this is referring or in this

733
00:31:11,039 --> 00:31:14,880
case each object reference each one okay

734
00:31:14,880 --> 00:31:16,399
and the trailer

735
00:31:16,399 --> 00:31:18,720
is a part of this

736
00:31:18,720 --> 00:31:20,080
location

737
00:31:20,080 --> 00:31:22,159
uh is totally linked with a

738
00:31:22,159 --> 00:31:24,080
cross-reference table okay it's a

739
00:31:24,080 --> 00:31:27,039
theoretical part not so good but anyway

740
00:31:27,039 --> 00:31:28,720
so

741
00:31:28,720 --> 00:31:31,039
this is i recording just because it's

742
00:31:31,039 --> 00:31:33,840
it's longer i recorded this demo to show

743
00:31:33,840 --> 00:31:35,120
you

744
00:31:35,120 --> 00:31:37,279
so

745
00:31:37,360 --> 00:31:39,519
let's see what happened let's go

746
00:31:39,519 --> 00:31:42,080
and i will explain all those steps so i

747
00:31:42,080 --> 00:31:44,480
received the pdf malicious so the next

748
00:31:44,480 --> 00:31:45,760
steps is to

749
00:31:45,760 --> 00:31:48,480
investigate all those informations right

750
00:31:48,480 --> 00:31:51,279
so okay so first step

751
00:31:51,279 --> 00:31:52,799
i

752
00:31:52,799 --> 00:31:54,960
verify if this pdf

753
00:31:54,960 --> 00:31:58,840
it was a pdf of course i made others uh

754
00:31:58,840 --> 00:32:01,519
other activities but i just recorded

755
00:32:01,519 --> 00:32:02,640
this

756
00:32:02,640 --> 00:32:04,640
specifically steps right so first of all

757
00:32:04,640 --> 00:32:07,360
is a pdf malicious it's a pdf document

758
00:32:07,360 --> 00:32:09,679
version 1.3

759
00:32:09,679 --> 00:32:11,679
and after that i

760
00:32:11,679 --> 00:32:14,399
using pdf id remember these two

761
00:32:14,399 --> 00:32:17,200
basically performing specifically

762
00:32:17,200 --> 00:32:20,799
is scanning inside of the document

763
00:32:20,799 --> 00:32:21,919
for

764
00:32:21,919 --> 00:32:24,159
looking for any specific informations

765
00:32:24,159 --> 00:32:26,320
what kind of information philip

766
00:32:26,320 --> 00:32:29,039
we can find for example objects so in

767
00:32:29,039 --> 00:32:31,360
this case we have a 15 object inside of

768
00:32:31,360 --> 00:32:33,360
this up this file

769
00:32:33,360 --> 00:32:36,159
and if you see we have a two streaming

770
00:32:36,159 --> 00:32:38,640
and with streaming usually is a part of

771
00:32:38,640 --> 00:32:39,360
the

772
00:32:39,360 --> 00:32:41,919
content inside of the pdf use it by the

773
00:32:41,919 --> 00:32:43,600
attacker

774
00:32:43,600 --> 00:32:46,640
not only that but usually we have

775
00:32:46,640 --> 00:32:48,399
more informations that you can

776
00:32:48,399 --> 00:32:50,080
investigate that okay

777
00:32:50,080 --> 00:32:51,440
and if you see

778
00:32:51,440 --> 00:32:55,279
this specific pdf has a one specifically

779
00:32:55,279 --> 00:32:56,559
page

780
00:32:56,559 --> 00:32:58,799
okay they have one specifically page

781
00:32:58,799 --> 00:33:00,000
streaming

782
00:33:00,000 --> 00:33:01,919
and if you see they have

783
00:33:01,919 --> 00:33:04,480
five reference or two in this case js

784
00:33:04,480 --> 00:33:07,120
and three other reference

785
00:33:07,120 --> 00:33:09,200
we can find many others reference

786
00:33:09,200 --> 00:33:11,039
basically when dj students create these

787
00:33:11,039 --> 00:33:13,840
tools probably they think about

788
00:33:13,840 --> 00:33:15,679
strings probably and what kind of

789
00:33:15,679 --> 00:33:17,279
information the

790
00:33:17,279 --> 00:33:20,240
the tool could collected from this file

791
00:33:20,240 --> 00:33:22,880
and he created these tools basically

792
00:33:22,880 --> 00:33:25,279
this way that happened the tools that

793
00:33:25,279 --> 00:33:26,640
people create

794
00:33:26,640 --> 00:33:29,120
they look in front some information

795
00:33:29,120 --> 00:33:31,760
and they try to automate the process

796
00:33:31,760 --> 00:33:33,039
because of that it's very important to

797
00:33:33,039 --> 00:33:35,200
understand how the tools works how the

798
00:33:35,200 --> 00:33:37,279
command works and how the answer of this

799
00:33:37,279 --> 00:33:38,399
command

800
00:33:38,399 --> 00:33:40,720
appears to you okay

801
00:33:40,720 --> 00:33:42,559
okay let's continue to this

802
00:33:42,559 --> 00:33:44,799
investigation and other point is about

803
00:33:44,799 --> 00:33:47,360
this open action what that means

804
00:33:47,360 --> 00:33:49,120
phillips

805
00:33:49,120 --> 00:33:51,039
open action and aa

806
00:33:51,039 --> 00:33:53,360
is the same meaning okay but in this

807
00:33:53,360 --> 00:33:55,679
case they have one open action open

808
00:33:55,679 --> 00:33:57,840
action is basically

809
00:33:57,840 --> 00:34:00,399
the function when the user received the

810
00:34:00,399 --> 00:34:02,000
the pdf

811
00:34:02,000 --> 00:34:03,760
let's suppose that you're working with

812
00:34:03,760 --> 00:34:06,559
hr team or a financial team probably you

813
00:34:06,559 --> 00:34:08,960
receive a resume every day and probably

814
00:34:08,960 --> 00:34:12,399
receive every invoice every day okay so

815
00:34:12,399 --> 00:34:13,520
the

816
00:34:13,520 --> 00:34:14,560
everyday

817
00:34:14,560 --> 00:34:15,760
these people

818
00:34:15,760 --> 00:34:17,520
open the pdfs right

819
00:34:17,520 --> 00:34:21,679
or resume or invoice okay so after

820
00:34:21,679 --> 00:34:26,239
the user click to open this pdf

821
00:34:26,239 --> 00:34:28,639
we will be executed this function open

822
00:34:28,639 --> 00:34:29,679
action

823
00:34:29,679 --> 00:34:32,159
i mean i will explain

824
00:34:32,159 --> 00:34:35,119
basically one thing

825
00:34:35,119 --> 00:34:38,399
will be happen automatically

826
00:34:38,399 --> 00:34:40,960
okay the user don't need to interact

827
00:34:40,960 --> 00:34:43,280
once again with the file when they open

828
00:34:43,280 --> 00:34:44,480
the file

829
00:34:44,480 --> 00:34:46,000
automatically happens something in the

830
00:34:46,000 --> 00:34:47,119
background

831
00:34:47,119 --> 00:34:49,199
when you find this open action

832
00:34:49,199 --> 00:34:50,560
this means

833
00:34:50,560 --> 00:34:53,280
it basically okay you understand

834
00:34:53,280 --> 00:34:55,040
i think it's clear

835
00:34:55,040 --> 00:34:57,119
okay so let's continue so we have

836
00:34:57,119 --> 00:34:58,400
something interesting we have a

837
00:34:58,400 --> 00:34:59,839
javascript

838
00:34:59,839 --> 00:35:01,119
and we have

839
00:35:01,119 --> 00:35:02,640
an open action

840
00:35:02,640 --> 00:35:05,119
okay flippy it's encrypted

841
00:35:05,119 --> 00:35:07,599
maybe we need to password to using

842
00:35:07,599 --> 00:35:09,359
something here okay

843
00:35:09,359 --> 00:35:11,760
so the next tool that i use here in this

844
00:35:11,760 --> 00:35:13,520
investigation it's another tool from

845
00:35:13,520 --> 00:35:15,440
this package from the dj steven pdf

846
00:35:15,440 --> 00:35:17,359
parser

847
00:35:17,359 --> 00:35:18,960
to using to

848
00:35:18,960 --> 00:35:22,160
to parser some informations or to search

849
00:35:22,160 --> 00:35:24,160
for some information inside of this pdf

850
00:35:24,160 --> 00:35:26,240
basically okay so we have many

851
00:35:26,240 --> 00:35:28,079
informations or many comments that i can

852
00:35:28,079 --> 00:35:30,800
use here but basically

853
00:35:30,800 --> 00:35:31,839
the first

854
00:35:31,839 --> 00:35:33,839
i just will show you about this

855
00:35:33,839 --> 00:35:35,599
information javascript remember we have

856
00:35:35,599 --> 00:35:36,720
a three

857
00:35:36,720 --> 00:35:38,320
in this case in this case this is the

858
00:35:38,320 --> 00:35:40,640
first reference object one

859
00:35:40,640 --> 00:35:44,320
object seven and object twelve 3

860
00:35:44,320 --> 00:35:46,240
reference remember that

861
00:35:46,240 --> 00:35:49,040
and another search is about js

862
00:35:49,040 --> 00:35:51,920
just to confirm using two different

863
00:35:51,920 --> 00:35:55,119
tools if you see the first is pdf id

864
00:35:55,119 --> 00:35:57,599
first and second so if you remember i

865
00:35:57,599 --> 00:36:00,880
use pdf id and i found five informations

866
00:36:00,880 --> 00:36:03,520
related js and javascript

867
00:36:03,520 --> 00:36:06,640
are using another tools to confirm the

868
00:36:06,640 --> 00:36:08,560
same information

869
00:36:08,560 --> 00:36:10,880
so in this case we don't have any false

870
00:36:10,880 --> 00:36:12,480
positive right

871
00:36:12,480 --> 00:36:15,359
nice so the second one i will using now

872
00:36:15,359 --> 00:36:18,640
the other comment using the same tools

873
00:36:18,640 --> 00:36:20,480
just to explain more details okay are

874
00:36:20,480 --> 00:36:23,119
you using

875
00:36:23,440 --> 00:36:25,119
dave w or

876
00:36:25,119 --> 00:36:27,359
my idea here in this case is to collect

877
00:36:27,359 --> 00:36:28,880
the wrong

878
00:36:28,880 --> 00:36:31,040
output data to find

879
00:36:31,040 --> 00:36:33,200
more deeper informations about that okay

880
00:36:33,200 --> 00:36:35,280
so i secured this in this specifically

881
00:36:35,280 --> 00:36:37,520
resume pdf

882
00:36:37,520 --> 00:36:38,400
and

883
00:36:38,400 --> 00:36:40,800
let's see and now you you can understand

884
00:36:40,800 --> 00:36:42,960
how those object works so if you see

885
00:36:42,960 --> 00:36:45,200
here take a look this reference

886
00:36:45,200 --> 00:36:49,040
object one in this case

887
00:36:49,040 --> 00:36:49,920
they

888
00:36:49,920 --> 00:36:51,359
remember the tree

889
00:36:51,359 --> 00:36:53,920
so this is the the first object and they

890
00:36:53,920 --> 00:36:56,079
have six reference here

891
00:36:56,079 --> 00:37:00,160
object two three four five six and seven

892
00:37:00,160 --> 00:37:01,040
seven

893
00:37:01,040 --> 00:37:03,520
seven do you remember how many objects

894
00:37:03,520 --> 00:37:06,400
we have in this file

895
00:37:06,400 --> 00:37:09,400
no

896
00:37:11,760 --> 00:37:16,960
15 yes 15 objects two looking this is a

897
00:37:16,960 --> 00:37:20,560
a small object i i can show you after

898
00:37:20,560 --> 00:37:22,079
16

899
00:37:22,079 --> 00:37:25,119
17 18 objective can you imagine just

900
00:37:25,119 --> 00:37:26,400
analysis

901
00:37:26,400 --> 00:37:29,599
15 it's easier thank you god for this 15

902
00:37:29,599 --> 00:37:30,400
but

903
00:37:30,400 --> 00:37:31,920
yeah 15. so

904
00:37:31,920 --> 00:37:35,040
but here we can see just seven right so

905
00:37:35,040 --> 00:37:38,880
we need to looking from others

906
00:37:39,280 --> 00:37:42,800
oh my goodness oh sorry for that i

907
00:37:42,800 --> 00:37:44,720
yeah let me go

908
00:37:44,720 --> 00:37:46,160
again more

909
00:37:46,160 --> 00:37:48,160
our objects okay

910
00:37:48,160 --> 00:37:51,119
so we have a 15 objects and take a look

911
00:37:51,119 --> 00:37:53,760
that this open action is totally linked

912
00:37:53,760 --> 00:37:55,359
with the specifically javascript

913
00:37:55,359 --> 00:37:57,359
remember open action

914
00:37:57,359 --> 00:37:59,280
so when the user clicking the file to

915
00:37:59,280 --> 00:38:02,079
open something happened what happened

916
00:38:02,079 --> 00:38:03,680
something about the javascript but we

917
00:38:03,680 --> 00:38:05,440
don't know what exactly in this moment

918
00:38:05,440 --> 00:38:09,359
okay so other reference object four

919
00:38:09,359 --> 00:38:11,520
eight and nine so other new reference

920
00:38:11,520 --> 00:38:14,079
object eight and i appears now for us

921
00:38:14,079 --> 00:38:16,000
and take a look other reference

922
00:38:16,000 --> 00:38:17,440
something about the

923
00:38:17,440 --> 00:38:19,040
not important

924
00:38:19,040 --> 00:38:20,480
for now

925
00:38:20,480 --> 00:38:22,320
any or uh

926
00:38:22,320 --> 00:38:24,400
i can't i cannot see

927
00:38:24,400 --> 00:38:26,640
the value information and here we can

928
00:38:26,640 --> 00:38:29,599
see all the reference object eight

929
00:38:29,599 --> 00:38:32,240
of the reference

930
00:38:32,240 --> 00:38:35,119
you see other object reference another

931
00:38:35,119 --> 00:38:37,520
looking from the javascript

932
00:38:37,520 --> 00:38:38,800
let's see

933
00:38:38,800 --> 00:38:42,800
here the reference object 10 referring

934
00:38:42,800 --> 00:38:46,320
other javascript in this case js and

935
00:38:46,320 --> 00:38:49,839
here we can see the first streaming

936
00:38:49,839 --> 00:38:53,200
i need to stop this

937
00:38:53,200 --> 00:38:54,640
okay

938
00:38:54,640 --> 00:38:56,640
yeah the first stream take a look that

939
00:38:56,640 --> 00:38:58,240
object 11

940
00:38:58,240 --> 00:39:00,160
containing stream so maybe you can look

941
00:39:00,160 --> 00:39:02,800
in from the object 11 because

942
00:39:02,800 --> 00:39:04,480
we have any stream here but if you see

943
00:39:04,480 --> 00:39:06,400
here the left

944
00:39:06,400 --> 00:39:08,560
is very very small

945
00:39:08,560 --> 00:39:10,960
maybe the content inside of this stream

946
00:39:10,960 --> 00:39:12,560
is not too valid

947
00:39:12,560 --> 00:39:14,800
but we can look in from that and they

948
00:39:14,800 --> 00:39:17,839
have another flag here flat decode

949
00:39:17,839 --> 00:39:19,200
basically

950
00:39:19,200 --> 00:39:21,200
we need to decode something

951
00:39:21,200 --> 00:39:22,720
okay so

952
00:39:22,720 --> 00:39:25,919
let's move on

953
00:39:26,839 --> 00:39:29,280
okay nice

954
00:39:29,280 --> 00:39:33,599
and let's see object l 12v referring

955
00:39:33,599 --> 00:39:34,720
another

956
00:39:34,720 --> 00:39:35,920
13.

957
00:39:35,920 --> 00:39:37,359
in this case if you see they have

958
00:39:37,359 --> 00:39:39,760
another string but the left in this case

959
00:39:39,760 --> 00:39:40,880
is

960
00:39:40,880 --> 00:39:42,880
is very different

961
00:39:42,880 --> 00:39:44,400
it's bigger

962
00:39:44,400 --> 00:39:46,800
so maybe you can this is the object that

963
00:39:46,800 --> 00:39:49,280
we need to investigate more okay

964
00:39:49,280 --> 00:39:51,040
so

965
00:39:51,040 --> 00:39:52,560
let's move on

966
00:39:52,560 --> 00:39:55,520
for this specific object okay after that

967
00:39:55,520 --> 00:39:57,839
i use pdf techcom

968
00:39:57,839 --> 00:39:59,119
because we don't have more time to

969
00:39:59,119 --> 00:40:01,920
explain but we have a pdf taker this

970
00:40:01,920 --> 00:40:04,640
these tools we can manipulate pdfs we

971
00:40:04,640 --> 00:40:07,359
can merge pdf we can compress pdf and

972
00:40:07,359 --> 00:40:10,880
you can uncompress pdf that that's my

973
00:40:10,880 --> 00:40:13,040
idea now uncompress

974
00:40:13,040 --> 00:40:14,960
those informations or many informations

975
00:40:14,960 --> 00:40:17,760
that i can see inside of this stream

976
00:40:17,760 --> 00:40:19,760
remember object 13.

977
00:40:19,760 --> 00:40:21,839
so i execute these tools

978
00:40:21,839 --> 00:40:24,960
to uncompress this information exactly

979
00:40:24,960 --> 00:40:29,119
inside of this object 13 because

980
00:40:29,119 --> 00:40:31,440
when i made this investigation this

981
00:40:31,440 --> 00:40:33,680
content for me it was valid because it's

982
00:40:33,680 --> 00:40:36,720
it's bigger okay so i using these tools

983
00:40:36,720 --> 00:40:38,720
uncompress this information inside of

984
00:40:38,720 --> 00:40:39,599
that

985
00:40:39,599 --> 00:40:43,839
and i i copped this in specifically.text

986
00:40:43,839 --> 00:40:46,319
and after that take a look what happened

987
00:40:46,319 --> 00:40:48,560
i found

988
00:40:48,560 --> 00:40:50,800
this is the content

989
00:40:50,800 --> 00:40:53,119
inside of the object

990
00:40:53,119 --> 00:40:54,480
13.

991
00:40:54,480 --> 00:40:55,599
and here

992
00:40:55,599 --> 00:40:57,520
we have the first technique used by the

993
00:40:57,520 --> 00:40:58,560
attacker

994
00:40:58,560 --> 00:41:01,839
the javascript obfuscated

995
00:41:01,839 --> 00:41:04,240
okay so the attacker using basically the

996
00:41:04,240 --> 00:41:06,880
javascript obfuscated

997
00:41:06,880 --> 00:41:08,960
to obfuscate that the code inside of

998
00:41:08,960 --> 00:41:13,040
that the point is remember the flow

999
00:41:13,040 --> 00:41:15,599
user receive the resume

1000
00:41:15,599 --> 00:41:18,160
download the machine and open the resume

1001
00:41:18,160 --> 00:41:20,560
and after that they click and open this

1002
00:41:20,560 --> 00:41:21,440
file

1003
00:41:21,440 --> 00:41:22,640
and when they click and they open the

1004
00:41:22,640 --> 00:41:24,079
file

1005
00:41:24,079 --> 00:41:26,640
one javascript executing automatically

1006
00:41:26,640 --> 00:41:28,560
this is the javascript

1007
00:41:28,560 --> 00:41:30,560
so we need to look in what is exactly

1008
00:41:30,560 --> 00:41:31,359
what

1009
00:41:31,359 --> 00:41:33,119
what is the action of this

1010
00:41:33,119 --> 00:41:35,680
javascript if javascript i thought so

1011
00:41:35,680 --> 00:41:38,640
javascript web application

1012
00:41:38,640 --> 00:41:40,400
i using this

1013
00:41:40,400 --> 00:41:42,560
this basically i rewrite i found the

1014
00:41:42,560 --> 00:41:44,800
specifically evo parameter here and i

1015
00:41:44,800 --> 00:41:46,839
try to rewrite

1016
00:41:46,839 --> 00:41:50,880
this of course it's not too easy to do

1017
00:41:50,880 --> 00:41:53,599
i made other tasks until now until i

1018
00:41:53,599 --> 00:41:57,359
write these results okay and after that

1019
00:41:57,359 --> 00:41:59,599
i rewrite here using the document right

1020
00:41:59,599 --> 00:42:01,599
to print this information

1021
00:42:01,599 --> 00:42:03,520
in the web application and if you see

1022
00:42:03,520 --> 00:42:04,880
they haven't specifically standard

1023
00:42:04,880 --> 00:42:06,880
behavior not behavior but you know

1024
00:42:06,880 --> 00:42:09,280
percent number ladders and other things

1025
00:42:09,280 --> 00:42:11,440
like this very interesting

1026
00:42:11,440 --> 00:42:12,960
okay so first

1027
00:42:12,960 --> 00:42:15,520
what i did here is i rewrite this

1028
00:42:15,520 --> 00:42:18,800
information in a specifically html file

1029
00:42:18,800 --> 00:42:21,680
to print this information in a browser

1030
00:42:21,680 --> 00:42:24,160
right because my idea is to looking what

1031
00:42:24,160 --> 00:42:25,760
information i will find in this

1032
00:42:25,760 --> 00:42:26,960
javascript

1033
00:42:26,960 --> 00:42:29,280
it was obfuscated and now we

1034
00:42:29,280 --> 00:42:30,480
skate this code

1035
00:42:30,480 --> 00:42:32,720
and take a look what happened now

1036
00:42:32,720 --> 00:42:35,200
when i try to open this

1037
00:42:35,200 --> 00:42:36,800
file

1038
00:42:36,800 --> 00:42:39,280
what information we on this case we i

1039
00:42:39,280 --> 00:42:41,440
found

1040
00:42:41,440 --> 00:42:44,440
wow

1041
00:42:44,640 --> 00:42:48,879
the payload you know what is payload

1042
00:42:50,160 --> 00:42:52,160
yes or no

1043
00:42:52,160 --> 00:42:55,520
yes you like this

1044
00:42:55,520 --> 00:42:57,599
payload is a package if you don't know

1045
00:42:57,599 --> 00:43:00,160
what is payloads it's a package or part

1046
00:43:00,160 --> 00:43:01,520
of the code

1047
00:43:01,520 --> 00:43:03,440
that you download in the victory machine

1048
00:43:03,440 --> 00:43:05,680
and this package is responsible for the

1049
00:43:05,680 --> 00:43:07,040
callback

1050
00:43:07,040 --> 00:43:08,720
from the attacker

1051
00:43:08,720 --> 00:43:12,400
okay so that's the key so now we have

1052
00:43:12,400 --> 00:43:13,520
here

1053
00:43:13,520 --> 00:43:16,000
here the payload

1054
00:43:16,000 --> 00:43:17,520
remember the flow

1055
00:43:17,520 --> 00:43:19,040
so inside of javascript we have a

1056
00:43:19,040 --> 00:43:20,319
payload

1057
00:43:20,319 --> 00:43:22,160
download the victim machine so if this

1058
00:43:22,160 --> 00:43:24,960
payload is responsible for callback

1059
00:43:24,960 --> 00:43:27,119
so we we can try

1060
00:43:27,119 --> 00:43:28,880
it more deeply because it's totally

1061
00:43:28,880 --> 00:43:31,280
malicious the idea is if

1062
00:43:31,280 --> 00:43:32,560
it was

1063
00:43:32,560 --> 00:43:34,880
investigators this fire is malicious or

1064
00:43:34,880 --> 00:43:37,119
not but it's malicious okay but now we

1065
00:43:37,119 --> 00:43:39,119
have a payload next step is to try and

1066
00:43:39,119 --> 00:43:40,880
investigate or to find what kind of

1067
00:43:40,880 --> 00:43:42,640
information you have here

1068
00:43:42,640 --> 00:43:45,280
i'm using a lot unix platform but maybe

1069
00:43:45,280 --> 00:43:47,200
you are thinking flip just using linux

1070
00:43:47,200 --> 00:43:48,000
okay

1071
00:43:48,000 --> 00:43:49,680
i would like to see in the linux in

1072
00:43:49,680 --> 00:43:51,920
windows platform anyway no problem are

1073
00:43:51,920 --> 00:43:54,079
using the windows to show you other

1074
00:43:54,079 --> 00:43:55,280
tools okay

1075
00:43:55,280 --> 00:43:57,119
so here we can see

1076
00:43:57,119 --> 00:44:00,400
the same investigation not this none of

1077
00:44:00,400 --> 00:44:02,480
the end of the investigation actually

1078
00:44:02,480 --> 00:44:05,040
here you can see the same code

1079
00:44:05,040 --> 00:44:07,520
okay the same file the same information

1080
00:44:07,520 --> 00:44:09,839
the same

1081
00:44:10,720 --> 00:44:13,680
javascript obfuscated okay so i will

1082
00:44:13,680 --> 00:44:15,440
write all those information all those

1083
00:44:15,440 --> 00:44:16,400
things

1084
00:44:16,400 --> 00:44:17,440
is there

1085
00:44:17,440 --> 00:44:20,640
here is the payload okay so basically i

1086
00:44:20,640 --> 00:44:21,680
cop

1087
00:44:21,680 --> 00:44:24,480
this payload here as you can see

1088
00:44:24,480 --> 00:44:29,040
and i passed here and this tools mozilla

1089
00:44:29,040 --> 00:44:31,520
why because i need the attacker using

1090
00:44:31,520 --> 00:44:34,079
here another technique the encode

1091
00:44:34,079 --> 00:44:37,280
technique right and

1092
00:44:37,280 --> 00:44:39,920
they're using the only code using to

1093
00:44:39,920 --> 00:44:41,680
only code to encode

1094
00:44:41,680 --> 00:44:42,480
maybe

1095
00:44:42,480 --> 00:44:44,319
you know with the language here but

1096
00:44:44,319 --> 00:44:45,200
anyway

1097
00:44:45,200 --> 00:44:47,359
the attacker using specifically

1098
00:44:47,359 --> 00:44:49,359
because when you using something to

1099
00:44:49,359 --> 00:44:51,760
encoding you can use in ascii okay based

1100
00:44:51,760 --> 00:44:54,000
on bytes or you can use a new code based

1101
00:44:54,000 --> 00:44:55,760
in two bytes in this case the attacker

1102
00:44:55,760 --> 00:44:58,800
using unicode based in two bytes and not

1103
00:44:58,800 --> 00:45:00,960
only that but the attacker using the

1104
00:45:00,960 --> 00:45:03,280
other techniques to encode this

1105
00:45:03,280 --> 00:45:07,760
information the using the ucsc2

1106
00:45:07,760 --> 00:45:11,839
is old when you compare with utf-16 with

1107
00:45:11,839 --> 00:45:14,319
f32 and stuff like that this is the old

1108
00:45:14,319 --> 00:45:16,720
part okay

1109
00:45:16,720 --> 00:45:19,280
nice so i copy and paste this payload

1110
00:45:19,280 --> 00:45:22,000
here and the first i

1111
00:45:22,000 --> 00:45:25,920
using here this ec2 to convert to x

1112
00:45:25,920 --> 00:45:27,680
decimal information basically i cut the

1113
00:45:27,680 --> 00:45:28,960
percent and

1114
00:45:28,960 --> 00:45:30,800
only that okay

1115
00:45:30,800 --> 00:45:33,280
you can use sad in linux and after that

1116
00:45:33,280 --> 00:45:34,880
i generate this

1117
00:45:34,880 --> 00:45:36,000
file

1118
00:45:36,000 --> 00:45:37,040
binary

1119
00:45:37,040 --> 00:45:39,280
why because this attacker is from the

1120
00:45:39,280 --> 00:45:41,040
windows environment

1121
00:45:41,040 --> 00:45:44,640
okay so i generate this cnc because if i

1122
00:45:44,640 --> 00:45:47,839
have the payload i can try to find the

1123
00:45:47,839 --> 00:45:50,240
cnc from the attacker and that's the my

1124
00:45:50,240 --> 00:45:52,880
idea i generate this binary and after

1125
00:45:52,880 --> 00:45:55,119
that i'm using another tools

1126
00:45:55,119 --> 00:45:58,720
from the dj steven by by the way

1127
00:45:58,880 --> 00:46:02,960
to try if i figure out specifically the

1128
00:46:02,960 --> 00:46:05,200
ip address from the attacker

1129
00:46:05,200 --> 00:46:07,680
and if you see

1130
00:46:07,680 --> 00:46:09,760
we find

1131
00:46:09,760 --> 00:46:11,359
okay this is the ip address from the

1132
00:46:11,359 --> 00:46:12,880
attacker

1133
00:46:12,880 --> 00:46:16,640
so now we have or maybe the

1134
00:46:16,640 --> 00:46:17,680
the

1135
00:46:17,680 --> 00:46:20,319
the last hope that attack has

1136
00:46:20,319 --> 00:46:21,440
i don't know

1137
00:46:21,440 --> 00:46:24,480
but this is basically the last ip

1138
00:46:24,480 --> 00:46:26,000
address from the attacker in this case

1139
00:46:26,000 --> 00:46:28,720
in dystonia okay

1140
00:46:28,720 --> 00:46:31,040
and yes

1141
00:46:31,040 --> 00:46:33,599
so now i finish the presentation and

1142
00:46:33,599 --> 00:46:35,680
this is some recommendation of books if

1143
00:46:35,680 --> 00:46:37,200
you want to know more about the mara

1144
00:46:37,200 --> 00:46:38,640
analysis talking

1145
00:46:38,640 --> 00:46:40,560
we have many other books but just some

1146
00:46:40,560 --> 00:46:43,520
reference to you and

1147
00:46:43,520 --> 00:46:45,760
30 seconds i finish

1148
00:46:45,760 --> 00:46:47,920
the presentation sorry again for the

1149
00:46:47,920 --> 00:46:50,480
problems but remember the flow between

1150
00:46:50,480 --> 00:46:52,800
the machine received the cv inside of

1151
00:46:52,800 --> 00:46:56,800
the cv we have a javascript obfuscated

1152
00:46:58,560 --> 00:47:00,960
the attacker using unicode's technique

1153
00:47:00,960 --> 00:47:03,040
to encode informations inside of the

1154
00:47:03,040 --> 00:47:07,040
sony code we can found the pdf right

1155
00:47:07,040 --> 00:47:08,800
mathias thank you so much thanks so much

1156
00:47:08,800 --> 00:47:11,280
everyone

1157
00:47:11,280 --> 00:47:14,920
thank you philippe

