1
00:00:09,840 --> 00:00:13,019
new Good evening everyone it is always a

2
00:00:13,019 --> 00:00:15,240
great pleasure and honor to be here in

3
00:00:15,240 --> 00:00:17,820
Kimbo my first time as a speaker

4
00:00:17,820 --> 00:00:21,960
dates back to 2017 and although

5
00:00:21,960 --> 00:00:23,400
I have aged further in the meantime

6
00:00:23,400 --> 00:00:25,640


7
00:00:25,640 --> 00:00:27,599
the enthusiasm of being part of this

8
00:00:27,599 --> 00:00:30,140
splendid Community is always the same

9
00:00:30,140 --> 00:00:32,700
before  to move on to our

10
00:00:32,700 --> 00:00:35,399
real topic let's make the necessary very

11
00:00:35,399 --> 00:00:38,280
short presentations on who we are

12
00:00:38,280 --> 00:00:40,140
perfect Thanks Marco I'm Andrea

13
00:00:40,140 --> 00:00:41,760
Pierini I currently work at

14
00:00:41,760 --> 00:00:44,820
Risk which is a company that deals with

15
00:00:44,820 --> 00:00:47,460
securing and making

16
00:00:47,460 --> 00:00:49,680
secure Restores of Active directory and  dei

17
00:00:49,680 --> 00:00:52,800
Gerardi in my free time, among the various

18
00:00:52,800 --> 00:00:54,780
things, I enjoy trying to understand a

19
00:00:54,780 --> 00:00:56,940
little better how offensive

20
00:00:56,940 --> 00:01:01,020
Security works, i.e. this black magic, and

21
00:01:01,020 --> 00:01:02,699
trying to find security bugs

22
00:01:02,699 --> 00:01:05,040
especially in the Windows world

23
00:01:05,040 --> 00:01:06,720
together with my friend Antonio could

24
00:01:06,720 --> 00:01:08,880
be here in  sala Ciao Antonio Here it is

25
00:01:08,880 --> 00:01:11,159
we have been carrying on for

26
00:01:11,159 --> 00:01:12,420
some time now what we call

27
00:01:12,420 --> 00:01:15,240
the potato saga O  i.e. a series of

28
00:01:15,240 --> 00:01:17,700
technical tools Sometimes fixed sometimes

29
00:01:17,700 --> 00:01:19,380
not for the April legislation on Windows

30
00:01:19,380 --> 00:01:22,560
as you can see by now I have a long

31
00:01:22,560 --> 00:01:25,140
experience and therefore I have spread

32
00:01:25,140 --> 00:01:27,180
all the operating systems a bit and this is one

33
00:01:27,180 --> 00:01:28,500
of the few advantages of

34
00:01:28,500 --> 00:01:30,000
probably being one of the  older in here

35
00:01:30,000 --> 00:01:31,979
I leave the floor to Marco for

36
00:01:31,979 --> 00:01:33,240
his very brief presentation Thanks

37
00:01:33,240 --> 00:01:35,240
Andrea

38
00:01:35,240 --> 00:01:37,560
I too work with Andrea I work in

39
00:01:37,560 --> 00:01:39,299
semperies so I won't repeat

40
00:01:39,299 --> 00:01:41,960
what semperis is ehm we

41
00:01:41,960 --> 00:01:44,400
protect the identity identities based

42
00:01:44,400 --> 00:01:46,100
on technology Microsoft

43
00:01:46,100 --> 00:01:48,659
solution Market tell me what is the

44
00:01:48,659 --> 00:01:50,280
Identity protection problem

45
00:01:50,280 --> 00:01:53,640
and I'll tell you how to go about solving

46
00:01:53,640 --> 00:01:56,520
these problems How to try to

47
00:01:56,520 --> 00:02:00,180
avoid being victims No not victims but

48
00:02:00,180 --> 00:02:02,600
target

49
00:02:03,240 --> 00:02:06,540
I'm from Microsoft Custom engineer

50
00:02:06,540 --> 00:02:08,940
Anyway me too not how much

51
00:02:08,940 --> 00:02:11,160
Andrea's experience a little less you're more  young

52
00:02:11,160 --> 00:02:12,500
though

53
00:02:12,500 --> 00:02:14,360
and I

54
00:02:14,360 --> 00:02:16,319
give the floor to Andrea who

55
00:02:16,319 --> 00:02:19,680
explains what we will see today well Ok so

56
00:02:19,680 --> 00:02:22,620
today we will tell you about two free tools

57
00:02:22,620 --> 00:02:25,520
and Community drives  n

58
00:02:25,520 --> 00:02:28,080
developed by our colleagues in Center

59
00:02:28,080 --> 00:02:31,080
that allow us to do the session on

60
00:02:31,080 --> 00:02:33,000
Active Directory and Directory jurors

61
00:02:33,000 --> 00:02:35,760
before going into detail about these two

62
00:02:35,760 --> 00:02:37,920
tools we will try to understand why it is so

63
00:02:37,920 --> 00:02:39,959
important to protect our identity

64
00:02:39,959 --> 00:02:44,640
in the Age of Active Directory and then we will go

65
00:02:44,640 --> 00:02:46,440
a little further  in detail about these

66
00:02:46,440 --> 00:02:48,900
two tools we will let them understand how they

67
00:02:48,900 --> 00:02:51,720
work and we will make demos that I hope

68
00:02:51,720 --> 00:02:53,400
will be of interest to you And that

69
00:02:53,400 --> 00:02:54,440
above all

70
00:02:54,440 --> 00:02:56,819
Finger cross technology will assist us here

71
00:02:56,819 --> 00:02:59,000
because

72
00:02:59,000 --> 00:03:01,200
the live usually we say some

73
00:03:01,200 --> 00:03:03,180
problems come out But let's hope we

74
00:03:03,180 --> 00:03:04,440
say goodbye no in short we ce

75
00:03:04,440 --> 00:03:07,319
we'll put it all and nothing I'll leave

76
00:03:07,319 --> 00:03:09,120
the floor to you again Marco so you can explain a

77
00:03:09,120 --> 00:03:10,739
little better what we mean by

78
00:03:10,739 --> 00:03:14,519
protected identity on the Directory

79
00:03:14,519 --> 00:03:17,159
premise How many of you have

80
00:03:17,159 --> 00:03:19,940
heard of Active

81
00:03:20,700 --> 00:03:23,519
well How many of you also manage

82
00:03:23,519 --> 00:03:25,500
directors

83
00:03:25,500 --> 00:03:27,239


84
00:03:27,239 --> 00:03:29,819
hands are already lowering  how many have

85
00:03:29,819 --> 00:03:32,580
ever done security or

86
00:03:32,580 --> 00:03:34,620
even analyzed voters

87
00:03:34,620 --> 00:03:36,560
Excellent excellent

88
00:03:36,560 --> 00:03:39,799
better Bu  are good

89
00:03:39,799 --> 00:03:42,060


90
00:03:42,060 --> 00:03:43,640
Well done the same goes for reading that you directors So

91
00:03:43,640 --> 00:03:46,860
we have to make a premise the premise is

92
00:03:46,860 --> 00:03:48,900
that as we also saw this morning

93
00:03:48,900 --> 00:03:53,220
in the other sessions often the target

94
00:03:53,220 --> 00:03:55,440
of a cyber attack

95
00:03:55,440 --> 00:03:58,019
especially in companies

96
00:03:58,019 --> 00:04:00,120
aim at the identity so

97
00:04:00,120 --> 00:04:02,239
once  I have a credential to access

98
00:04:02,239 --> 00:04:05,040
I can do things in Active Directory

99
00:04:05,040 --> 00:04:07,519
small premise was born a few years ago

100
00:04:07,519 --> 00:04:09,780
Who knows when it was released The

101
00:04:09,780 --> 00:04:13,159
first Directory publicly

102
00:04:14,580 --> 00:04:16,738
right on

103
00:04:16,738 --> 00:04:20,000
or we understood here a bit of football

104
00:04:20,000 --> 00:04:23,759
999 starts in 2000 So he won

105
00:04:23,759 --> 00:04:28,100
a t-shirt so 2000 the t-shirt and

106
00:04:28,100 --> 00:04:31,880
whoever answered

107
00:04:35,150 --> 00:04:37,020
[Music]

108
00:04:37,020 --> 00:04:38,880
was born in the 2000s what was its goal to

109
00:04:38,880 --> 00:04:41,580
be usable by

110
00:04:41,580 --> 00:04:43,080
most companies and

111
00:04:43,080 --> 00:04:45,060
that's why we find it everywhere everyone

112
00:04:45,060 --> 00:04:46,199
You practically raised your hand

113
00:04:46,199 --> 00:04:48,360
I guess in your companies  or in

114
00:04:48,360 --> 00:04:50,460
your clients you find that you directors

115
00:04:50,460 --> 00:04:53,120
and/or and voter games

116
00:04:53,120 --> 00:04:56,699
now 23 years in terms of security

117
00:04:56,699 --> 00:04:58,800
So  of imprune while the

118
00:04:58,800 --> 00:05:00,180
updates that have taken place there have

119
00:05:00,180 --> 00:05:02,340
been improvements Definitely but it

120
00:05:02,340 --> 00:05:03,960
remains a product conceived in the

121
00:05:03,960 --> 00:05:07,560
2000s So how does it work What are the

122
00:05:07,560 --> 00:05:09,979
possibilities of being

123
00:05:09,979 --> 00:05:12,900
brecciated making privatilescalation pacts

124
00:05:12,900 --> 00:05:15,120
laterally many

125
00:05:15,120 --> 00:05:17,340
in these 23 years many have been discovered

126
00:05:17,340 --> 00:05:22,199
Attack pacts we try

127
00:05:22,199 --> 00:05:24,360
to prevent

128
00:05:24,360 --> 00:05:26,280
these attacks by configuring Active

129
00:05:26,280 --> 00:05:29,160
recline in a certain way and now with the

130
00:05:29,160 --> 00:05:31,199
two free tools that you can

131
00:05:31,199 --> 00:05:32,759
all use we show you

132
00:05:32,759 --> 00:05:35,419
how we do it

133
00:05:35,419 --> 00:05:38,699
another small premise is that Active

134
00:05:38,699 --> 00:05:42,060
Directory is the  we can

135
00:05:42,060 --> 00:05:43,440
call it the first brick so that we place it

136
00:05:43,440 --> 00:05:46,740
inside a T infrastructure so

137
00:05:46,740 --> 00:05:48,840
when electrici's eyes I

138
00:05:48,840 --> 00:05:50,400
connect the mail I connect

139
00:05:50,400 --> 00:05:52,139
the application I connect I don't mention names

140
00:05:52,139 --> 00:05:54,120
but I can connect whatever I want

141
00:05:54,120 --> 00:05:55,919
Almost almost all the applications are

142
00:05:55,919 --> 00:05:58,800
connected to  Active directory and the

143
00:05:58,800 --> 00:06:00,720
moment actidirectory has a

144
00:06:00,720 --> 00:06:02,880
problem i  I have a big problem in the

145
00:06:02,880 --> 00:06:05,039
company so

146
00:06:05,039 --> 00:06:07,620
we manage the whole chain of an

147
00:06:07,620 --> 00:06:09,960
attack from before during and after So

148
00:06:09,960 --> 00:06:11,520
also restore the recovery

149
00:06:11,520 --> 00:06:14,340
The goal is not to get to the recovery

150
00:06:14,340 --> 00:06:17,039
and then try to prevent having said

151
00:06:17,039 --> 00:06:18,080
that

152
00:06:18,080 --> 00:06:20,300
let's see our first free tool

153
00:06:20,300 --> 00:06:23,060
Has anyone ever  heard of

154
00:06:23,060 --> 00:06:26,300
purple night

155
00:06:27,060 --> 00:06:31,460
someone who used it raises a few hands

156
00:06:32,100 --> 00:06:34,740
1 2 3 4 Then pass by here because

157
00:06:34,740 --> 00:06:38,460
now if we throw things we do damage 4 in

158
00:06:38,460 --> 00:06:40,199
that area there remember Andrea

159
00:06:40,199 --> 00:06:42,960
is a free tool that is always

160
00:06:42,960 --> 00:06:46,440
available to check if mine

161
00:06:46,440 --> 00:06:49,620
directory is configured correctly

162
00:06:49,620 --> 00:06:52,259
configured correctly I mean if I've

163
00:06:52,259 --> 00:06:54,180
faked a certain vulnerability if I'm

164
00:06:54,180 --> 00:06:55,919
exposed to a risk if there are signals

165
00:06:55,919 --> 00:06:59,539
maybe already compromised

166
00:07:00,180 --> 00:07:02,940
it's a tool as I said free it doesn't have to be

167
00:07:02,940 --> 00:07:06,960
installed so what is Purple night

168
00:07:06,960 --> 00:07:08,900
I just told you

169
00:07:08,900 --> 00:07:10,800
offline we don't need

170
00:07:10,800 --> 00:07:12,240
internet connection nothing is sent

171
00:07:12,240 --> 00:07:13,919
out so it's something you

172
00:07:13,919 --> 00:07:16,818
can use

173
00:07:17,660 --> 00:07:20,340
it shouldn't be installed with the Gui So

174
00:07:20,340 --> 00:07:22,699
easy Windows Style Don't worry

175
00:07:22,699 --> 00:07:26,780
and how it works I told you before

176
00:07:26,780 --> 00:07:30,180
we check more than 100 and more

177
00:07:30,180 --> 00:07:32,759
indicators that come to us They

178
00:07:32,759 --> 00:07:34,979
return a report that we can

179
00:07:34,979 --> 00:07:37,560
use within our

180
00:07:37,560 --> 00:07:40,259
company or  at ours if you are a

181
00:07:40,259 --> 00:07:44,340
partner at your customers to

182
00:07:45,479 --> 00:07:48,120
create awareness on the problem of

183
00:07:48,120 --> 00:07:51,419
identity security in the company you

184
00:07:51,419 --> 00:07:53,220
do not need administrative permissions so

185
00:07:53,220 --> 00:07:56,819
this is already a big advantage and as

186
00:07:56,819 --> 00:07:58,319
you can see the requirements are

187
00:07:58,319 --> 00:08:01,259
really trivial i.e. any client

188
00:08:01,259 --> 00:08:03,240
and a  'any user Indeed, a

189
00:08:03,240 --> 00:08:05,340
domain user is even better because it is

190
00:08:05,340 --> 00:08:07,080
precisely the view that an attacker would have

191
00:08:07,080 --> 00:08:08,699
when he has access

192
00:08:08,699 --> 00:08:11,340
to your infrastructure and we know

193
00:08:11,340 --> 00:08:12,840
that having access to an infrastructure

194
00:08:12,840 --> 00:08:15,240
is fairly simple

195
00:08:15,240 --> 00:08:18,240
any

196
00:08:19,740 --> 00:08:22,020
utonto I call them I hope there are no

197
00:08:22,020 --> 00:08:24,780
fools here But  when they click it is done no

198
00:08:24,780 --> 00:08:27,620
credentials are taken having said that

199
00:08:27,620 --> 00:08:32,039
let's see if you want to do  and a

200
00:08:32,039 --> 00:08:35,760
scanner there we have the link Then to

201
00:08:35,760 --> 00:08:36,958
download it so quickly aside

202
00:08:36,958 --> 00:08:39,240
because maybe the name may seem a

203
00:08:39,240 --> 00:08:44,099
little strange but let's challenge the demo demon a little bit

204
00:08:44,099 --> 00:08:48,080
and see if

205
00:08:48,080 --> 00:08:51,720
the demo works Ok we don't project at this

206
00:08:51,720 --> 00:08:55,459
moment I don't know why Here

207
00:08:55,459 --> 00:08:59,279
no I'll go back out for a moment Here's a

208
00:08:59,279 --> 00:09:02,420
classic demo effect it

209
00:09:02,580 --> 00:09:09,360
fits and we're going to duplicates Ok good

210
00:09:13,019 --> 00:09:16,140
So as I told you Purple night is

211
00:09:16,140 --> 00:09:18,899
very simple it's a launched Turlo and you don't

212
00:09:18,899 --> 00:09:20,820
need to install it accept

213
00:09:20,820 --> 00:09:24,000
any agreements and here you can already

214
00:09:24,000 --> 00:09:27,240
make a choice check your

215
00:09:27,240 --> 00:09:29,640
posture  of Active directory security or

216
00:09:29,640 --> 00:09:32,160
10 hours direct or both so

217
00:09:32,160 --> 00:09:34,920
let's put ourselves in the simplest case that

218
00:09:34,920 --> 00:09:36,300
now here with connectivity it becomes

219
00:09:36,300 --> 00:09:38,459
complicated but direct you we

220
00:09:38,459 --> 00:09:40,500
select our forest our

221
00:09:40,500 --> 00:09:43,920
Domains Next and we launch and from here Yes

222
00:09:43,920 --> 00:09:47,100
then we launch the test  to make our

223
00:09:47,100 --> 00:09:49,620
Assessment what is the result It is a

224
00:09:49,620 --> 00:09:53,220
report that we have already ready so we

225
00:09:53,220 --> 00:09:56,940
avoid doing damage where is the good

226
00:09:56,940 --> 00:10:00,480
Andrea Here it is  a ok This is the famous

227
00:10:00,480 --> 00:10:02,040
report I was telling you about before which

228
00:10:02,040 --> 00:10:04,019
contains all the information relating

229
00:10:04,019 --> 00:10:07,200
to both membership we have

230
00:10:07,200 --> 00:10:09,899
run a score on both of us

231
00:10:09,899 --> 00:10:12,000
a score that tells

232
00:10:12,000 --> 00:10:15,959
us how more or less unsure we are a

233
00:10:15,959 --> 00:10:18,300
brief briefing of what has been

234
00:10:18,300 --> 00:10:21,180
done  so where did I launch it How

235
00:10:21,180 --> 00:10:23,880
long did it last What is my user how

236
00:10:23,880 --> 00:10:26,040
did the execution go and then the most

237
00:10:26,040 --> 00:10:27,839
important part the content and the result

238
00:10:27,839 --> 00:10:29,880
let's look at the voice a bit or is it my

239
00:10:29,880 --> 00:10:33,650
impression no it feels great

240
00:10:33,650 --> 00:10:34,980
[Music]

241
00:10:34,980 --> 00:10:38,880
we have in  order of criticality all the

242
00:10:38,880 --> 00:10:41,399
indicators and therefore the results that

243
00:10:41,399 --> 00:10:43,320
our report returns Obviously

244
00:10:43,320 --> 00:10:45,899
first there are the Critical then we have the

245
00:10:45,899 --> 00:10:49,140
Warning and finally we have the information

246
00:10:49,140 --> 00:10:52,320
so if we go to see the

247
00:10:52,320 --> 00:10:55,560
detail of each indicator for example

248
00:10:55,560 --> 00:10:59,820
here we can see what it is  present What

249
00:10:59,820 --> 00:11:02,360
we see inside each indicator

250
00:11:02,360 --> 00:11:06,180
we have apart from the name the criticality that

251
00:11:06,180 --> 00:11:09,779
this indicator has the score that

252
00:11:09,779 --> 00:11:11,279
this indicator has within the

253
00:11:11,279 --> 00:11:13,440
rep  ort we have a series

254
00:11:13,440 --> 00:11:16,440
of label information that refers

255
00:11:16,440 --> 00:11:18,620
to frameworks and security frameworks

256
00:11:18,620 --> 00:11:21,360
miter Attack rather than miter

257
00:11:21,360 --> 00:11:23,459
Defender rather than anxiety with

258
00:11:23,459 --> 00:11:24,540
French

259
00:11:24,540 --> 00:11:26,579
we have a description of what we are going

260
00:11:26,579 --> 00:11:27,839
to check now I took a

261
00:11:27,839 --> 00:11:29,339
random indicator  which is a famous

262
00:11:29,339 --> 00:11:32,160
vulnerability which is that of the Prince

263
00:11:32,160 --> 00:11:34,260
the description will tell us let's go and

264
00:11:34,260 --> 00:11:36,420
check if the Prince service is active on the two Man controllers

265
00:11:36,420 --> 00:11:39,000
spoiler then

266
00:11:39,000 --> 00:11:42,300
we have the information of What is the

267
00:11:42,300 --> 00:11:46,079
danger We already understand it from the labels

268
00:11:46,079 --> 00:11:48,180
that refer to the

269
00:11:48,180 --> 00:11:49,320
security frameworks  but here we have the details

270
00:11:49,320 --> 00:11:52,860
We also have the link maybe KB Sorry

271
00:11:52,860 --> 00:11:54,260
lcve

272
00:11:54,260 --> 00:11:57,000
Microsoft we have the results So

273
00:11:57,000 --> 00:11:59,640
what are the objects involved in the

274
00:11:59,640 --> 00:12:01,920
problem and last but not least

275
00:12:01,920 --> 00:12:04,200
we have the whole part related to the

276
00:12:04,200 --> 00:12:06,180
remediation step so what should we

277
00:12:06,180 --> 00:12:08,279
do to go and remedy our

278
00:12:08,279 --> 00:12:11,519
problem  now I have made you a

279
00:12:11,519 --> 00:12:15,060
quick overview the content of all the

280
00:12:15,060 --> 00:12:16,560
indicators will be  different but the structure

281
00:12:16,560 --> 00:12:19,620
remains the same Now I leave the floor to the

282
00:12:19,620 --> 00:12:22,579
good good Andrea

283
00:12:22,579 --> 00:12:26,959
do this At this point we make

284
00:12:26,959 --> 00:12:29,100
extended and make this change so

285
00:12:29,100 --> 00:12:31,019
perfect Yes as Marco says

286
00:12:31,019 --> 00:12:32,700
we clearly don't have the time to

287
00:12:32,700 --> 00:12:34,560
scroll through all the indicators Among

288
00:12:34,560 --> 00:12:36,480
other things we say  we

289
00:12:36,480 --> 00:12:38,160
actively collaborate with the development team

290
00:12:38,160 --> 00:12:40,019
reporting our direct experiences

291
00:12:40,019 --> 00:12:42,000
in the field myself, for example, I am

292
00:12:42,000 --> 00:12:44,519
also part of the research team which in

293
00:12:44,519 --> 00:12:47,339
some way dictates the guidelines in the

294
00:12:47,339 --> 00:12:48,980
development of these products so

295
00:12:48,980 --> 00:12:51,540
we will only show a few indicators

296
00:12:51,540 --> 00:12:53,220
which, in my opinion, some say are not  so

297
00:12:53,220 --> 00:12:55,019
obvious not so obvious that maybe

298
00:12:55,019 --> 00:12:57,660
some of you have never even seen the

299
00:12:57,660 --> 00:13:00,360
first one we go to see concerns

300
00:13:00,360 --> 00:13:01,980
certificates When we have an

301
00:13:01,980 --> 00:13:03,779
internal ca and we issue certificates and

302
00:13:03,779 --> 00:13:05,279
above all for client authentication

303
00:13:05,279 --> 00:13:07,380
very often we see in companies that

304
00:13:07,380 --> 00:13:09,120
there is a leave some

305
00:13:09,120 --> 00:13:11,459
configurations  little too cheerful came out let's say

306
00:13:11,459 --> 00:13:13,740
almost two years ago all a g  red papier

307
00:13:13,740 --> 00:13:15,839
made by spectrups all all

308
00:13:15,839 --> 00:13:18,060
the problems that there are with

309
00:13:18,060 --> 00:13:19,380
certificate issuing certificates in this case

310
00:13:19,380 --> 00:13:21,779
we see that this

311
00:13:21,779 --> 00:13:23,220
clearly known certificate is called Well

312
00:13:23,220 --> 00:13:25,019
sure In this certificate the user who

313
00:13:25,019 --> 00:13:27,959
can make the certificate mistake has the

314
00:13:27,959 --> 00:13:30,000
possibility to  specify a subject

315
00:13:30,000 --> 00:13:32,339
name this said in very simple words

316
00:13:32,339 --> 00:13:33,899
What does it mean that the user can

317
00:13:33,899 --> 00:13:36,660
request a client certificate for

318
00:13:36,660 --> 00:13:39,000
any other user therefore

319
00:13:39,000 --> 00:13:42,420
also including a name in admin and through

320
00:13:42,420 --> 00:13:45,540
two lines of scripting manages to

321
00:13:45,540 --> 00:13:47,459
impersonate abs so imagine

322
00:13:47,459 --> 00:13:48,959
this is a really situation  very

323
00:13:48,959 --> 00:13:51,360
dangerous which, however, we often see

324
00:13:51,360 --> 00:13:53,220
above all because I have for example

325
00:13:53,220 --> 00:13:56,339
access problems to

326
00:13:56,339 --> 00:13:58,440
Legacy applications very often for accessing the

327
00:13:58,440 --> 00:14:00,660
company WiFi based on certificates and

328
00:14:00,660 --> 00:14:01,920
so on, so this is something to

329
00:14:01,920 --> 00:14:03,959
keep very much under control and

330
00:14:03,959 --> 00:14:05,579
clearly We must put right away

331
00:14:05,579 --> 00:14:07,740
remedy this So it's a

332
00:14:07,740 --> 00:14:09,660
really critical alert

333
00:14:09,660 --> 00:14:14,240
the other ese  mpio we have it

334
00:14:14,639 --> 00:14:17,519
Because it doesn't work for me

335
00:14:17,519 --> 00:14:19,880
Ok Here we are

336
00:14:19,880 --> 00:14:22,519
this other one instead tells us that there has

337
00:14:22,519 --> 00:14:25,200
recently been a change in the permissions

338
00:14:25,200 --> 00:14:26,940
of the Olbia admins now I don't know

339
00:14:26,940 --> 00:14:28,380
how many of you know the

340
00:14:28,380 --> 00:14:30,779
holder guide But it is an object a container in

341
00:14:30,779 --> 00:14:34,500
acts Directory which acts as a Template to

342
00:14:34,500 --> 00:14:36,300
assign permissions to

343
00:14:36,300 --> 00:14:38,820
privileged users very often this is

344
00:14:38,820 --> 00:14:40,920
used by malicious actors to

345
00:14:40,920 --> 00:14:43,560
obtain persistence in active in this

346
00:14:43,560 --> 00:14:45,720
case our have user is granted

347
00:14:45,720 --> 00:14:49,800
maximum permissions full control on this

348
00:14:49,800 --> 00:14:51,420
template This means that the user

349
00:14:51,420 --> 00:14:53,579
a  once he got

350
00:14:53,579 --> 00:14:55,500
full control access on all Domina admin

351
00:14:55,500 --> 00:14:56,760
all privileged groups and

352
00:14:56,760 --> 00:14:58,260
whatnot then this be a

353
00:14:58,260 --> 00:15:00,120
wake up call when we see

354
00:15:00,120 --> 00:15:02,880
that changes have been made

355
00:15:02,880 --> 00:15:04,620
recently changes

356
00:15:04,620 --> 00:15:07,019
holder university we absolutely have to

357
00:15:07,019 --> 00:15:08,820
actually check  what's going on

358
00:15:08,820 --> 00:15:11,699
you think my great valet looks

359
00:15:11,699 --> 00:15:13,320
but I didn't have him I think about it but it's not right it's

360
00:15:13,320 --> 00:15:14,820
not right  So let's move on to the traditional method

361
00:15:14,820 --> 00:15:17,180


362
00:15:18,660 --> 00:15:19,880
Ok

363
00:15:19,880 --> 00:15:22,440
this other attack is a very

364
00:15:22,440 --> 00:15:26,120
particular one So what does

365
00:15:26,120 --> 00:15:28,079
Nadia plate tell us in this case look that

366
00:15:28,079 --> 00:15:32,160
there is a server that has

367
00:15:32,160 --> 00:15:33,540
a delegation delivery configured

368
00:15:33,540 --> 00:15:36,660
towards an spn pointing to an object in

369
00:15:36,660 --> 00:15:38,100
this in this  case another machine

370
00:15:38,100 --> 00:15:39,839
that no longer exists in the domain because

371
00:15:39,839 --> 00:15:42,240
it has probably been deleted because

372
00:15:42,240 --> 00:15:44,399
this is dangerous because under certain

373
00:15:44,399 --> 00:15:46,680
particular conditions a

374
00:15:46,680 --> 00:15:48,480
malicious actor could carry out an

375
00:15:48,480 --> 00:15:50,519
attack like SP and Jack King have you

376
00:15:50,519 --> 00:15:52,920
ever heard of this

377
00:15:52,920 --> 00:15:55,500
big attack heh but you  don't go it's not valid it's

378
00:15:55,500 --> 00:15:57,120
not valid oh over there there's one so let's

379
00:15:57,120 --> 00:15:59,880
remember from those Antonio No no it's not

380
00:15:59,880 --> 00:16:02,100
valid for Antonio to

381
00:16:02,100 --> 00:16:05,240
Antonio's friend Ok

382
00:16:07,639 --> 00:16:09,540
this is a somewhat particular attack

383
00:16:09,540 --> 00:16:13,139
let's say there were various surrounding conditions

384
00:16:13,139 --> 00:16:14,760
but if the  The user has the

385
00:16:14,760 --> 00:16:17,279
possibility to go and write an

386
00:16:17,279 --> 00:16:20,160
attribute of the spn he can carry out a

387
00:16:20,160 --> 00:16:22,440
type attack using it with strain

388
00:16:22,440 --> 00:16:23,940
delegation also exploiting this  also

389
00:16:23,940 --> 00:16:26,760
weakness of the kerberos protocol to

390
00:16:26,760 --> 00:16:29,100
have the few maximum privileges on

391
00:16:29,100 --> 00:16:31,800
the target machine clearly so

392
00:16:31,800 --> 00:16:33,660
what we have to do this gives us

393
00:16:33,660 --> 00:16:35,880
indications on Look you must always

394
00:16:35,880 --> 00:16:37,680
clean up when you delete a machine it

395
00:16:37,680 --> 00:16:39,600
also deletes all the references of

396
00:16:39,600 --> 00:16:41,940
this machine that insist on other

397
00:16:41,940 --> 00:16:43,199
objects

398
00:16:43,199 --> 00:16:45,560
let's go on ok

399
00:16:45,560 --> 00:16:47,639
We also have

400
00:16:47,639 --> 00:16:49,500
indicators on the outside of it is very simple to

401
00:16:49,500 --> 00:16:51,540
do the 3D scan Just create

402
00:16:51,540 --> 00:16:54,420
an ad hoc application everything is written

403
00:16:54,420 --> 00:16:56,600
inside the

404
00:16:56,600 --> 00:16:58,560
diversifier manual which allows us to

405
00:16:58,560 --> 00:17:01,380
understand the security posture the

406
00:17:01,380 --> 00:17:03,000
security status also of our Edwards

407
00:17:03,000 --> 00:17:05,160
Directory  why raise your hand who no

408
00:17:05,160 --> 00:17:07,380
longer does directory synchronization

409
00:17:07,380 --> 00:17:09,179
naturally we all have

410
00:17:09,179 --> 00:17:11,040
a more or less hybrid environment a good

411
00:17:11,040 --> 00:17:14,459
press a little on and even here

412
00:17:14,459 --> 00:17:16,919
a series of security files open up that

413
00:17:16,919 --> 00:17:19,619
I won't even explain the first one we

414
00:17:19,619 --> 00:17:21,959
see  it is a classic therefore a Global

415
00:17:21,959 --> 00:17:23,459
at least or in any case a user with

416
00:17:23,459 --> 00:17:25,619
privil  egi which has not enabled on which

417
00:17:25,619 --> 00:17:26,880


418
00:17:26,880 --> 00:17:28,679
multifactor authentication has not been enabled This is very very

419
00:17:28,679 --> 00:17:30,840
dangerous and therefore this absolutely

420
00:17:30,840 --> 00:17:34,260
goes immediately we use to immediately run for

421
00:17:34,260 --> 00:17:35,580
cover therefore this very

422
00:17:35,580 --> 00:17:38,160
useful indicator that very often maybe we are

423
00:17:38,160 --> 00:17:39,660
not looking we are not looking at all

424
00:17:39,660 --> 00:17:41,160
reports that ended up with us that can be

425
00:17:41,160 --> 00:17:44,340
done on the aigirati website and so on

426
00:17:44,340 --> 00:17:45,720
but here is an indication that we

427
00:17:45,720 --> 00:17:48,539
immediately have a precise one and we know who the

428
00:17:48,539 --> 00:17:50,820
users are and we must immediately try

429
00:17:50,820 --> 00:17:53,100
to fix the second

430
00:17:53,100 --> 00:17:55,919
indicator I would like to ask a question but I know

431
00:17:55,919 --> 00:17:58,740
that [ __ ] reigns here Who is it that is a

432
00:17:58,740 --> 00:18:00,980
Global

433
00:18:01,200 --> 00:18:03,860


434
00:18:04,160 --> 00:18:05,960
all recently

435
00:18:05,960 --> 00:18:08,640
Okay okay No one answered

436
00:18:08,640 --> 00:18:10,799
anyway in my test hotel I think

437
00:18:10,799 --> 00:18:12,539
he doesn't have it now We'll see

438
00:18:12,539 --> 00:18:15,140
but let's go ahead with the test

439
00:18:15,140 --> 00:18:17,240


440
00:18:17,240 --> 00:18:21,000
done this is ok this  'other is also

441
00:18:21,000 --> 00:18:22,140
this is a very particular indicator

442
00:18:22,140 --> 00:18:24,320
I repeat In short, we have tried to

443
00:18:24,320 --> 00:18:26,700
put some things that are not

444
00:18:26,700 --> 00:18:28,820
so common in life that perhaps you do not know

445
00:18:28,820 --> 00:18:32,520
what does this tell us that there is

446
00:18:32,520 --> 00:18:36,240
a user on the Active Directory who is in

447
00:18:36,240 --> 00:18:39,419
some way a candidate to assume

448
00:18:39,419 --> 00:18:41,640
privileged roles from Global Mina

449
00:18:41,640 --> 00:18:46,260
anything else and who is not synchronized from

450
00:18:46,260 --> 00:18:48,360
Active Directory and in addition has the

451
00:18:48,360 --> 00:18:51,660
SMTP proxy address set see madonna eh

452
00:18:51,660 --> 00:18:54,059
That is here  too many preconditions instead it

453
00:18:54,059 --> 00:18:56,299
is not so because these users exist

454
00:18:56,299 --> 00:19:00,000
what is the problem in fact if instead

455
00:19:00,000 --> 00:19:02,400
I have a user example acts Directory who

456
00:19:02,400 --> 00:19:03,780
can create users but this does not

457
00:19:03,780 --> 00:19:05,280
mean that it must necessarily be a

458
00:19:05,280 --> 00:19:07,080
delegate name they exist for this

459
00:19:07,080 --> 00:19:10,200
Know Directory and users  created by

460
00:19:10,200 --> 00:19:13,440
this user who can create them Excuse

461
00:19:13,440 --> 00:19:15,840
the miscalculation they are also

462
00:19:15,840 --> 00:19:18,059
synchronized on the Activity Directory I

463
00:19:18,059 --> 00:19:20,400
could create a user on Active

464
00:19:20,400 --> 00:19:22,980
Directory with the same Upim with the

465
00:19:22,980 --> 00:19:26,100
same smt proxy address wait for the

466
00:19:26,100 --> 00:19:28,140
synchronization the situation goes for me

467
00:19:28,140 --> 00:19:30,660
overwrite the password that is  it is up to the

468
00:19:30,660 --> 00:19:34,260
user on ajor to impersonate the user

469
00:19:34,260 --> 00:19:38,100
and then proceed with the

470
00:19:38,100 --> 00:19:40,140
privilege assignment request q  So a

471
00:19:40,140 --> 00:19:44,760
pretty good escalation this is because it

472
00:19:44,760 --> 00:19:48,660
takes advantage of a flaw let's call it that it

473
00:19:48,660 --> 00:19:50,220
was let's say notified to Microsoft by

474
00:19:50,220 --> 00:19:53,100
our colleagues however Microsoft and

475
00:19:53,100 --> 00:19:54,840
usually What is the classic response from

476
00:19:54,840 --> 00:19:58,520
behavior is by design so ok

477
00:20:00,799 --> 00:20:03,480
I could write a book on these

478
00:20:03,480 --> 00:20:05,160
things but before  retire

479
00:20:05,160 --> 00:20:08,160
I will do them and therefore

480
00:20:08,160 --> 00:20:10,860
and therefore here what we have to do well

481
00:20:10,860 --> 00:20:12,480
we have to be very careful very

482
00:20:12,480 --> 00:20:14,039
careful with the delegation what we

483
00:20:14,039 --> 00:20:16,380
delegate because we have to remember

484
00:20:16,380 --> 00:20:18,840
that in these cases clearly a little

485
00:20:18,840 --> 00:20:20,400
particular however it can happen

486
00:20:20,400 --> 00:20:23,179
Clearly it must only be

487
00:20:23,179 --> 00:20:25,860
elegibel because if the  'user if the

488
00:20:25,860 --> 00:20:27,419
user we are trying to visualize with

489
00:20:27,419 --> 00:20:29,640
this trick is already Global admin

490
00:20:29,640 --> 00:20:32,640
Microsoft luckily in this case he

491
00:20:32,640 --> 00:20:34,400
put a patch

492
00:20:34,400 --> 00:20:37,679
we can go on But go

493
00:20:37,679 --> 00:20:40,700
on let's go on let

494
00:20:41,000 --> 00:20:44,520
's go different meanwhile Purple night do you have a

495
00:20:44,520 --> 00:20:46,260
little understanding of how it works no  So

496
00:20:46,260 --> 00:20:49,220
let's look at the

497
00:20:49,220 --> 00:20:51,860
maintenance post install configuration

498
00:20:51,860 --> 00:20:55,860
So from the outside now c  i move with

499
00:20:55,860 --> 00:20:57,600
forest druid who ever

500
00:20:57,600 --> 00:21:00,678
heard of forrest druid

501
00:21:00,840 --> 00:21:04,639
who ever used him t shirt

502
00:21:07,100 --> 00:21:10,440
after after we get there

503
00:21:10,440 --> 00:21:12,179
yes yes but that's right because it's not out yet it's

504
00:21:12,179 --> 00:21:14,520
not out yet so

505
00:21:14,520 --> 00:21:19,020
preview only for no then it's a tool

506
00:21:19,020 --> 00:21:23,640
which allows us to verify who

507
00:21:23,640 --> 00:21:26,640
has access to a certain set of

508
00:21:26,640 --> 00:21:28,620
objects this particular set of

509
00:21:28,620 --> 00:21:31,380
objects and the

510
00:21:31,380 --> 00:21:33,059


511
00:21:33,059 --> 00:21:35,580


512
00:21:35,580 --> 00:21:39,059
tier Zero  it is a

513
00:21:39,059 --> 00:21:41,340
logical division that we make to understand

514
00:21:41,340 --> 00:21:45,179
which are those objects that have a

515
00:21:45,179 --> 00:21:48,120
certain value the name controller

516
00:21:48,120 --> 00:21:50,520
privileged groups to be clear

517
00:21:50,520 --> 00:21:52,740
organizational users objects that must

518
00:21:52,740 --> 00:21:56,159
be managed by a certain set of

519
00:21:56,159 --> 00:21:57,360
people and must not have any

520
00:21:57,360 --> 00:22:00,900
connection with the rest Now let's try to

521
00:22:00,900 --> 00:22:04,200
maybe  try to make you understand a little

522
00:22:04,200 --> 00:22:07,140
better then Forest Druid What it is This is

523
00:22:07,140 --> 00:22:09,539
also a tool that will be free and

524
00:22:09,539 --> 00:22:12,360
available to everyone on the

525
00:22:12,360 --> 00:22:15,179
other hand  ll identify the risks of

526
00:22:15,179 --> 00:22:17,700
possible spots of privileges escalation

527
00:22:17,700 --> 00:22:19,200
of tireer zero So of the Famous

528
00:22:19,200 --> 00:22:21,179
objects that we have to go and

529
00:22:21,179 --> 00:22:23,419
protect

530
00:22:24,240 --> 00:22:26,039
this too is easy it doesn't have to be installed

531
00:22:26,039 --> 00:22:30,419
Portable the only difference is that it

532
00:22:30,419 --> 00:22:32,340
also runs with a non-administrative user But

533
00:22:32,340 --> 00:22:34,679
if we want to do an analysis  done well

534
00:22:34,679 --> 00:22:36,780
we need a user with

535
00:22:36,780 --> 00:22:40,500
maximum privileges So at least one domen admin

536
00:22:40,500 --> 00:22:43,580
Andrea how about explaining this Digital Art to us

537
00:22:43,580 --> 00:22:47,120


538
00:22:48,140 --> 00:22:50,340
Among other things made with midge Journey

539
00:22:50,340 --> 00:22:55,860
this is the output produced by

540
00:22:56,240 --> 00:22:59,480
on a real case So here

541
00:22:59,480 --> 00:23:01,679
an attacker has nothing else  that

542
00:23:01,679 --> 00:23:03,780
the embarrassment of choice Just follow one

543
00:23:03,780 --> 00:23:06,059
of the many paths try Try a lot

544
00:23:06,059 --> 00:23:09,600
sooner or later I get there but

545
00:23:09,600 --> 00:23:11,480
Let's put ourselves in the shoes of asking

546
00:23:11,480 --> 00:23:13,919
defending those who care about the safety

547
00:23:13,919 --> 00:23:17,280
of saying Well the task is very difficult

548
00:23:17,280 --> 00:23:18,480
because First of all I don't  I can

549
00:23:18,480 --> 00:23:20,340
afford to exclude some Pats

550
00:23:20,340 --> 00:23:22,679
because they are unlikely but anyway who

551
00:23:22,679 --> 00:23:24,720
will ever exploit them no that is me what

552
00:23:24,720 --> 00:23:28,020
I have to do is identify the perim

553
00:23:28,020 --> 00:23:29,840
safety background of my family jewels

554
00:23:29,840 --> 00:23:33,799
understand what

555
00:23:33,799 --> 00:23:36,299
dangerous or illegitimate relationships are I've always said

556
00:23:36,299 --> 00:23:38,340
that I've finished this Talk we could also

557
00:23:38,340 --> 00:23:40,320
be asset consultants with all

558
00:23:40,320 --> 00:23:43,080
these relationships But oh well and therefore

559
00:23:43,080 --> 00:23:46,020
reactions

560
00:23:46,020 --> 00:23:47,940
let's not say not legitimate

561
00:23:47,940 --> 00:23:50,340
dangerous reactions and go and eliminate them If

562
00:23:50,340 --> 00:23:52,440
instead there are objects that have

563
00:23:52,440 --> 00:23:54,360
certain relationships with my

564
00:23:54,360 --> 00:23:56,880
tiersero objects I have to include them in my

565
00:23:56,880 --> 00:23:58,679
diary In such a way that

566
00:23:58,679 --> 00:24:01,159
my uncle continues to expand and I try to cut off

567
00:24:01,159 --> 00:24:03,960
all those relationships which all those

568
00:24:03,960 --> 00:24:06,299
Pat escalation privileges that can

569
00:24:06,299 --> 00:24:09,120
lead to complete control in a way

570
00:24:09,120 --> 00:24:11,400
I am perfectly aware that I

571
00:24:11,400 --> 00:24:13,500
explained it quite badly but Marco who

572
00:24:13,500 --> 00:24:15,000
is much better than me will explain

573
00:24:15,000 --> 00:24:17,059
it to you in more detail

574
00:24:17,059 --> 00:24:20,880
If you want there is also this the difference is clear

575
00:24:20,880 --> 00:24:22,500
the classic question we

576
00:24:22,500 --> 00:24:24,020
are asked is But what is the  difference

577
00:24:24,020 --> 00:24:27,900
between Blot on the forest Druid and

578
00:24:27,900 --> 00:24:30,659
Flow down approach Uses an

579
00:24:30,659 --> 00:24:32,760
outside approach in the sense of the atta  attacker

580
00:24:32,760 --> 00:24:34,919
the attacker who from the outside tries to

581
00:24:34,919 --> 00:24:37,020
arrive and follow a Pat of privileges

582
00:24:37,020 --> 00:24:40,860
escalation Red timing who does no it

583
00:24:40,860 --> 00:24:42,960
's an Inside Out approach These

584
00:24:42,960 --> 00:24:45,000
are my objects that I have to protect

585
00:24:45,000 --> 00:24:46,440
let's try to understand

586
00:24:46,440 --> 00:24:48,539
if beyond my perimeter there are  they are

587
00:24:48,539 --> 00:24:51,620
however possibility of attack So

588
00:24:51,620 --> 00:24:54,480
what is the message that both

589
00:24:54,480 --> 00:24:56,159
tools are useful both

590
00:24:56,159 --> 00:24:57,480
tools are complementary we

591
00:24:57,480 --> 00:24:58,980
can not say used only one

592
00:24:58,980 --> 00:25:00,799
only used only other

593
00:25:00,799 --> 00:25:02,700
used both Because in this way you

594
00:25:02,700 --> 00:25:04,559
definitely improve

595
00:25:04,559 --> 00:25:07,380
your security posture on other Directories

596
00:25:07,380 --> 00:25:09,539
then more Blood needs  of neoforgeie

597
00:25:09,539 --> 00:25:11,100
all those problems or

598
00:25:11,100 --> 00:25:12,840
the installation etc etc is

599
00:25:12,840 --> 00:25:14,240
completely Portable because it uses

600
00:25:14,240 --> 00:25:16,799
velocity of b as a container database

601
00:25:16,799 --> 00:25:19,020
we can launch the collector as

602
00:25:19,020 --> 00:25:21,120
sharepound directly on the target machine get the

603
00:25:21,120 --> 00:25:23,520
database and then

604
00:25:23,520 --> 00:25:25,440
analyze it at our home

605
00:25:25,440 --> 00:25:28,380
or in short where we think best

606
00:25:28,380 --> 00:25:32,179
please thanks Then  let's try to understand

607
00:25:32,179 --> 00:25:34,919
how it works What is the approach we

608
00:25:34,919 --> 00:25:36,179
said from the inside out

609
00:25:36,179 --> 00:25:38,900
When we start

610
00:25:38,900 --> 00:25:42,179
we have a default size Zero

611
00:25:42,179 --> 00:25:44,159
we have objects that we already know

612
00:25:44,159 --> 00:25:46,260
are size Zero

613
00:25:46,260 --> 00:25:48,539
then we realize maybe we can say

614
00:25:48,539 --> 00:25:50,100
what these objects are Just to

615
00:25:50,100 --> 00:25:52,080
understand no yes some objects how can they

616
00:25:52,080 --> 00:25:54,500
be

617
00:25:56,179 --> 00:25:59,840
we get there we get there

618
00:25:59,840 --> 00:26:03,179
administrator account operator backup

619
00:26:03,179 --> 00:26:04,919
operator and so on It is a

620
00:26:04,919 --> 00:26:08,159
predefined set of objects that will then

621
00:26:08,159 --> 00:26:11,520
have relationships with objects that do

622
00:26:11,520 --> 00:26:13,380
outside so in this slide

623
00:26:13,380 --> 00:26:17,279
we see i.e. from agp Objects that

624
00:26:17,279 --> 00:26:18,779
somehow have a relationship what

625
00:26:18,779 --> 00:26:21,779
kind  of relationship they have With size

626
00:26:21,779 --> 00:26:23,880
Zero different plans we have reported

627
00:26:23,880 --> 00:26:26,400
someone so blacks Call investigating judge I

628
00:26:26,400 --> 00:26:29,460
am a member of something I am part of

629
00:26:29,460 --> 00:26:31,200
a unit organization and so on

630
00:26:31,200 --> 00:26:33,360
So there is a relationship

631
00:26:33,360 --> 00:26:36,600
now this relationship is legitimate or

632
00:26:36,600 --> 00:26:38,700
not let's

633
00:26:38,700 --> 00:26:41,580
assume that it is not  so i am going

634
00:26:41,580 --> 00:26:43,980
to remove this permission because in the

635
00:26:43,980 --> 00:26:47,340
end we are talking about permissions to user a and

636
00:26:47,340 --> 00:26:50,460
therefore  I exclude it from the fact that it has

637
00:26:50,460 --> 00:26:52,380
an interaction that can have an

638
00:26:52,380 --> 00:26:54,480
interaction with zero cut

639
00:26:54,480 --> 00:26:56,940
object B equal I don't need it let's go

640
00:26:56,940 --> 00:26:59,279
ahead and get to object

641
00:26:59,279 --> 00:27:02,700
G object g of we decide that it is legitimate

642
00:27:02,700 --> 00:27:04,559
because maybe it is our

643
00:27:04,559 --> 00:27:06,419
network administrator  therefore it must have control

644
00:27:06,419 --> 00:27:08,520
of the Active directory therefore it must interact

645
00:27:08,520 --> 00:27:10,820
with the objects in Italia Zero

646
00:27:10,820 --> 00:27:13,919
we include it in the size zero and at this

647
00:27:13,919 --> 00:27:16,440
point what happens other links

648
00:27:16,440 --> 00:27:18,059
this object and these other

649
00:27:18,059 --> 00:27:20,760
links are legitimate or not the

650
00:27:20,760 --> 00:27:22,799
concept what is the objective the objective

651
00:27:22,799 --> 00:27:24,419
is  to get to this situation

652
00:27:24,419 --> 00:27:27,360
where we have the size Zero which is

653
00:27:27,360 --> 00:27:30,600
isolated so no one but who is

654
00:27:30,600 --> 00:27:32,159
inside this circle of

655
00:27:32,159 --> 00:27:35,760
this Tiger can manage and do things who

656
00:27:35,760 --> 00:27:37,159
outside obviously not

657
00:27:37,159 --> 00:27:42,559
let's try again Windows P I would say

658
00:27:43,140 --> 00:27:47,360
and let's go challenge the  'other Here

659
00:27:47,360 --> 00:27:51,139
we have to do this

660
00:27:51,179 --> 00:27:53,400
we can change display technologies

661
00:27:53,400 --> 00:27:56,400
During remote Connection

662
00:27:56,400 --> 00:27:59,120
Here this

663
00:28:00,200 --> 00:28:05,340
Here we are so we pass

664
00:28:05,340 --> 00:28:06,500
here Here we are

665
00:28:06,500 --> 00:28:10,200
this  a is the Forrest Druid interface

666
00:28:10,200 --> 00:28:12,659
so on the left we have a

667
00:28:12,659 --> 00:28:14,580
textual list and on the right we also have a

668
00:28:14,580 --> 00:28:16,980
graphic that Andrea will then help us to

669
00:28:16,980 --> 00:28:17,840
understand well

670
00:28:17,840 --> 00:28:20,520
it's quite simple We just need to

671
00:28:20,520 --> 00:28:23,460
play with it a couple of times we have big

672
00:28:23,460 --> 00:28:26,400
buttons that allow us to go and

673
00:28:26,400 --> 00:28:28,140
define some  objects size zero or

674
00:28:28,140 --> 00:28:30,720
risk by default everything here is

675
00:28:30,720 --> 00:28:32,640
the legend no everything orange is

676
00:28:32,640 --> 00:28:35,640
a risk what is green If perhaps you

677
00:28:35,640 --> 00:28:36,799
see little it

678
00:28:36,799 --> 00:28:39,720
is what we define as size zero and in

679
00:28:39,720 --> 00:28:41,940
blue those that are by default

680
00:28:41,940 --> 00:28:43,559
right here  we can then play to

681
00:28:43,559 --> 00:28:45,600
group the objects size Zero in

682
00:28:45,600 --> 00:28:47,580
one point rather than add

683
00:28:47,580 --> 00:28:49,620
remove the text and then something

684
00:28:49,620 --> 00:28:52,260
important here in another increase the

685
00:28:52,260 --> 00:28:54,960
hopes What are the hopes I have an object

686
00:28:54,960 --> 00:28:57,240
that has a direct link with

687
00:28:57,240 --> 00:28:58,679
another object that I struggled to find  zero and

688
00:28:58,679 --> 00:29:00,299
this is a hop

689
00:29:00,299 --> 00:29:02,820
the object that is in contact so that

690
00:29:02,820 --> 00:29:04,980
still the outside the Tyler Zero can

691
00:29:04,980 --> 00:29:08,340
in turn have someone who still has a

692
00:29:08,340 --> 00:29:10,200
connection with him like  we have seen

693
00:29:10,200 --> 00:29:14,360
first no the user G then he had other

694
00:29:14,360 --> 00:29:16,260
connections with other objects so

695
00:29:16,260 --> 00:29:18,720
the hopes are these how far we move

696
00:29:18,720 --> 00:29:21,600
from Zero let's take an example let's make

697
00:29:21,600 --> 00:29:23,460
an example Then let's clean up by

698
00:29:23,460 --> 00:29:27,059
default exact by default let's

699
00:29:27,059 --> 00:29:30,120
insert

700
00:29:30,120 --> 00:29:33,020
some objects inside Taier Zero  which Let me tell you They are

701
00:29:33,020 --> 00:29:35,820
by default Air 0 they are not included

702
00:29:35,820 --> 00:29:37,860
for various reasons that we don't

703
00:29:37,860 --> 00:29:41,299
have time to tell now but we

704
00:29:44,480 --> 00:29:47,520
consider them Tiger zero and then

705
00:29:47,520 --> 00:29:50,399
we should more or less be there Security

706
00:29:50,399 --> 00:29:53,820
principal Here we have a default domin

707
00:29:53,820 --> 00:29:56,940
Policy because it has become reported as a

708
00:29:56,940 --> 00:29:59,520
risk  because the incata to an object that

709
00:29:59,520 --> 00:30:01,260
we have defined Trial zero So

710
00:30:01,260 --> 00:30:04,820
the domain cuts Zero at this point

711
00:30:04,820 --> 00:30:07,100
we see that there are a series of objects

712
00:30:07,100 --> 00:30:09,919
these objects have a relationship they

713
00:30:09,919 --> 00:30:13,980
are orange they are risks with

714
00:30:13,980 --> 00:30:15,240
objects that are in Thai Air Zero

715
00:30:15,240 --> 00:30:16,580
Then

716
00:30:16,580 --> 00:30:19,799
adsx Service let's say Zero admin

717
00:30:19,799 --> 00:30:21,960
so let's make 0 admin let's put it in

718
00:30:21,960 --> 00:30:24,080
Taiz I'm Andrea thanks it

719
00:30:24,080 --> 00:30:26,659
comes out  ri ours

720
00:30:26,659 --> 00:30:29,700
comes out because the container that

721
00:30:29,700 --> 00:30:31,679
contains The object I just put

722
00:30:31,679 --> 00:30:34,620
in size zero I allowed the user t0

723
00:30:34,620 --> 00:30:35,820
admin

724
00:30:35,820 --> 00:30:38,159
ok I called it admin I

725
00:30:38,159 --> 00:30:41,159
called it Taier Zero whoever contains this

726
00:30:41,159 --> 00:30:44,159
object is a unit organization that doesn't

727
00:30:44,159 --> 00:30:46,080
it is considered taille zero so I'm going

728
00:30:46,080 --> 00:30:48,600
to insert it inside the zero at

729
00:30:48,600 --> 00:30:51,299
this point there are three objects left

730
00:30:51,299 --> 00:30:54,419
mainly the first

731
00:30:54,419 --> 00:30:57,020
which is the disin Service Does anyone

732
00:30:57,020 --> 00:31:00,320
know but

733
00:31:00,419 --> 00:31:02,700
Does anyone know the d Connect light Sync

734
00:31:02,700 --> 00:31:06,059
those things Ok there are few who

735
00:31:06,059 --> 00:31:08,580
manage this better Ok  if you replicate

736
00:31:08,580 --> 00:31:10,700
anyway it

737
00:31:10,700 --> 00:31:12,720
is a type of account We have

738
00:31:12,720 --> 00:31:15,539
called it Exit of Sing but in short it

739
00:31:15,539 --> 00:31:17,279
has important permissions on the

740
00:31:17,279 --> 00:31:20,039
Directory because Get Change therefore it can

741
00:31:20,039 --> 00:31:22,919
make passwords replicate So it is a

742
00:31:22,919 --> 00:31:25,679
sensitive object we throw it into Tiger

743
00:31:25,679 --> 00:31:29,100
Zero at this point the  desk

744
00:31:29,100 --> 00:31:33,240
operator below you see here the

745
00:31:33,240 --> 00:31:36,779
descopetor which has a forced Force Change password on

746
00:31:36,779 --> 00:31:38,399
the object we just put in

747
00:31:38,399 --> 00:31:39,419
Taiz

748
00:31:39,419 --> 00:31:41,580
now

749
00:31:41,580 --> 00:31:44,760
an error wanted Spe  ro unwanted a

750
00:31:44,760 --> 00:31:48,419
mistake i.e. the guys who work

751
00:31:48,419 --> 00:31:51,299
at the Germans Maybe they have the

752
00:31:51,299 --> 00:31:53,640
ability to reset the password of

753
00:31:53,640 --> 00:31:55,860
an account that can Synchronize

754
00:31:55,860 --> 00:31:58,460
passwords is now quite an issue

755
00:31:58,460 --> 00:32:00,260
from a security point of view

756
00:32:00,260 --> 00:32:03,659
important so what do we do We just

757
00:32:03,659 --> 00:32:06,659
go get the  'object let's go and

758
00:32:06,659 --> 00:32:07,799
see its security properties

759
00:32:07,799 --> 00:32:12,240
Then right click Of course the

760
00:32:12,240 --> 00:32:15,059
resolution does not help and we see that here

761
00:32:15,059 --> 00:32:17,460
we have an object called

762
00:32:17,460 --> 00:32:18,840
German on the back which then has

763
00:32:18,840 --> 00:32:22,799
special permissions to reset the

764
00:32:22,799 --> 00:32:25,020
password At this point if we

765
00:32:25,020 --> 00:32:26,340
we remove it then we clean it up

766
00:32:26,340 --> 00:32:28,559
we go to solve our

767
00:32:28,559 --> 00:32:30,360
problem going to

768
00:32:30,360 --> 00:32:33,659
remove it remove its permission

769
00:32:33,659 --> 00:32:35,520
above grope at the top right we have the

770
00:32:35,520 --> 00:32:37,559
possibility to resynchronize the

771
00:32:37,559 --> 00:32:39,140
data directory data If we do so

772
00:32:39,140 --> 00:32:42,840
let's say do a resink

773
00:32:42,840 --> 00:32:45,740
Go get you Maybe if the

774
00:32:45,740 --> 00:32:52,580
back-end works Perfect  Excellent However

775
00:32:53,580 --> 00:32:55,500
the objective which was to

776
00:32:55,500 --> 00:32:58,039
arrive at zero

777
00:32:58,039 --> 00:33:00,360
basically  while Andrea

778
00:33:00,360 --> 00:33:03,600
looks at us going to remove that permission

779
00:33:03,600 --> 00:33:06,779
What are we going to do we are going to remove

780
00:33:06,779 --> 00:33:09,260
that famous connection that famous

781
00:33:09,260 --> 00:33:12,840
possible attack Pat that could

782
00:33:12,840 --> 00:33:15,799
be exploited by an attacker if I

783
00:33:15,799 --> 00:33:19,919
enter a company or better

784
00:33:19,919 --> 00:33:21,779
if I manage to have a  set of credentials

785
00:33:21,779 --> 00:33:24,000
which can also be the domain user I

786
00:33:24,000 --> 00:33:27,740
move sideways I arrive on the pc

787
00:33:27,740 --> 00:33:30,480
of the desk operators and I can

788
00:33:30,480 --> 00:33:32,519
impersonate their user what can I

789
00:33:32,519 --> 00:33:35,580
do I can reset the passwords and

790
00:33:35,580 --> 00:33:37,440
therefore I can get

791
00:33:37,440 --> 00:33:39,000
everything I need as an architect and this

792
00:33:39,000 --> 00:33:41,820
point I can do for the dj escalation and

793
00:33:41,820 --> 00:33:44,340
manage my Directory from here

794
00:33:44,340 --> 00:33:45,960
then all the famous Pacts of

795
00:33:45,960 --> 00:33:48,000
crypto malware attacks can start all that

796
00:33:48,000 --> 00:33:52,200
interests us excellent

797
00:33:53,519 --> 00:33:54,899
we always have the backup solution

798
00:33:54,899 --> 00:33:57,059
Let's start Maybe the video because

799
00:33:57,059 --> 00:33:59,399
now I tried to restart it we can

800
00:33:59,399 --> 00:34:01,620
if  we have a few minutes we can

801
00:34:01,620 --> 00:34:04,860
try to challenge because he probably

802
00:34:04,860 --> 00:34:07,099
lost the various addresses that

803
00:34:07,099 --> 00:34:09,679
Proviam had  or immediately

804
00:34:09,679 --> 00:34:11,820
let's go and see first of all if

805
00:34:11,820 --> 00:34:13,699
we can

806
00:34:13,699 --> 00:34:16,859
No I would go for videos so we don't get

807
00:34:16,859 --> 00:34:19,099
bored in the meantime then

808
00:34:19,099 --> 00:34:21,560
we go over there

809
00:34:21,560 --> 00:34:25,520
oh well then let's go on in the meantime

810
00:34:26,418 --> 00:34:31,739
here we go back to

811
00:34:31,739 --> 00:34:33,839
where we were before so in this case

812
00:34:33,839 --> 00:34:35,480
size Zero

813
00:34:35,480 --> 00:34:38,879
has German  access to tirer

814
00:34:38,879 --> 00:34:40,139
zero because we said First we put

815
00:34:40,139 --> 00:34:42,780
that user inside in this case

816
00:34:42,780 --> 00:34:47,659
I'm going to remove

817
00:34:48,199 --> 00:34:52,080
operator permission and if we are not in demo then

818
00:34:52,080 --> 00:34:53,639
there is no demo effect and it works because it

819
00:34:53,639 --> 00:34:55,800
works we do a Racing that we see

820
00:34:55,800 --> 00:34:57,839
that it disappears  that famous connection

821
00:34:57,839 --> 00:35:00,540
Why Why at this point that we need to

822
00:35:00,540 --> 00:35:01,940
go a little fast because

823
00:35:01,940 --> 00:35:06,020
he doesn't stop with us you stop him

824
00:35:06,020 --> 00:35:09,300
this is a fairly simple no it was

825
00:35:09,300 --> 00:35:10,980
meant to be an introduction Now

826
00:35:10,980 --> 00:35:12,780
I'll leave the most complicated part to Andrea

827
00:35:12,780 --> 00:35:14,880
No nothing complicated vi

828
00:35:14,880 --> 00:35:16,140
story We have here also

829
00:35:16,140 --> 00:35:19,339
reported here three fairly

830
00:35:19,339 --> 00:35:22,560
simple more or less simple examples for as an

831
00:35:22,560 --> 00:35:24,000
example clearly why display

832
00:35:24,000 --> 00:35:26,099
the entire Acti  ve Directory explain it in

833
00:35:26,099 --> 00:35:27,960
Forest drui with lots of objects

834
00:35:27,960 --> 00:35:30,900
trying to understand the links takes

835
00:35:30,900 --> 00:35:32,760
time and clearly in 45 minutes we

836
00:35:32,760 --> 00:35:34,440
can't dedicate all the time by force it

837
00:35:34,440 --> 00:35:36,240
also gets from 2 I think we have

838
00:35:36,240 --> 00:35:38,400
two but I'm sure that the other 5

839
00:35:38,400 --> 00:35:40,560
allow us  so no problem Ok

840
00:35:40,560 --> 00:35:43,460
so

841
00:35:43,920 --> 00:35:47,280
what do we have here are we maybe too

842
00:35:47,280 --> 00:35:50,760
far gone Ah ok No No well boss

843
00:35:50,760 --> 00:35:52,380
operator Did you see earlier there was a

844
00:35:52,380 --> 00:35:54,180
backup operator who is a user who

845
00:35:54,180 --> 00:35:56,940
was part of the group Well boss Paredes of

846
00:35:56,940 --> 00:35:58,440
course So he's a user  comprivi

847
00:35:58,440 --> 00:36:00,980
law of data that must be put in

848
00:36:00,980 --> 00:36:03,599
Zero putting it in crisis Zero

849
00:36:03,599 --> 00:36:04,339


850
00:36:04,339 --> 00:36:08,400
this one comes out or where is

851
00:36:08,400 --> 00:36:11,540
the user inserted I never have two so as

852
00:36:11,540 --> 00:36:16,380
not to make simple examples and then let's

853
00:36:16,380 --> 00:36:19,140
see What happens to this one or

854
00:36:19,140 --> 00:36:20,640
let's see let's try to understand  before

855
00:36:20,640 --> 00:36:23,160
putting the o in Tea Zero let's

856
00:36:23,160 --> 00:36:25,740
see by targeting this u what

857
00:36:25,740 --> 00:36:28,740
relationships there are with this or with other

858
00:36:28,740 --> 00:36:30,780
objects external to the o E what

859
00:36:30,780 --> 00:36:33,540
we see in this case that it exists  a

860
00:36:33,540 --> 00:36:35,640
group or u operator that has the

861
00:36:35,640 --> 00:36:37,740
ability to link the Policy group

862
00:36:37,740 --> 00:36:40,619
so imagine what

863
00:36:40,619 --> 00:36:43,380
the problem could be a malicious user who is a

864
00:36:43,380 --> 00:36:45,560


865
00:36:46,700 --> 00:36:48,900
malicious party and manages in that way

866
00:36:48,900 --> 00:36:51,180
through schedut Task scripts and

867
00:36:51,180 --> 00:36:53,579
so on to impersonate the

868
00:36:53,579 --> 00:36:56,460
backup operator account so here what is it  the

869
00:36:56,460 --> 00:36:58,020
problem how we have to remedy the

870
00:36:58,020 --> 00:36:59,880
situation clearly the backup

871
00:36:59,880 --> 00:37:02,160
operator because the lure operators it is

872
00:37:02,160 --> 00:37:04,200
right that maybe or operettas you are right

873
00:37:04,200 --> 00:37:05,700
that maybe they can link group Policy

874
00:37:05,700 --> 00:37:09,180
but surely caught it must not be in

875
00:37:09,180 --> 00:37:11,339
that or but it must be in one or that

876
00:37:11,339 --> 00:37:14,220
we know it is protected where  only

877
00:37:14,220 --> 00:37:16,020
privileged users can modify

878
00:37:16,020 --> 00:37:17,940
the Policy group and

879
00:37:17,940 --> 00:37:20,060


880
00:37:20,060 --> 00:37:23,099


881
00:37:23,099 --> 00:37:24,660


882
00:37:24,660 --> 00:37:26,579


883
00:37:26,579 --> 00:37:28,140


884
00:37:28,140 --> 00:37:31,440
so on  back and we are left with

885
00:37:31,440 --> 00:37:34,560
the name in controller you see an

886
00:37:34,560 --> 00:37:37,380
Ok we put it in tir zero because

887
00:37:37,380 --> 00:37:39,000
normally where  and In controller should

888
00:37:39,000 --> 00:37:40,260
go intie zero and let's try to understand by

889
00:37:40,260 --> 00:37:42,300
setting them to zero If some

890
00:37:42,300 --> 00:37:45,540
strange relations come out we go on and here

891
00:37:45,540 --> 00:37:48,119
we see a very strange thing

892
00:37:48,119 --> 00:37:52,260
we see that the domain oneler sorry

893
00:37:52,260 --> 00:37:54,720
I interrupt you in the first there were two

894
00:37:54,720 --> 00:37:57,180
quick steps there was the  default do me

895
00:37:57,180 --> 00:37:58,800
controller Policy So we put

896
00:37:58,800 --> 00:38:02,040
the the man controller in tier Zero is there

897
00:38:02,040 --> 00:38:04,200
an object that can act on me against

898
00:38:04,200 --> 00:38:05,880
you what is the default me ​​controller

899
00:38:05,880 --> 00:38:07,800
Policy so we need to make sure

900
00:38:07,800 --> 00:38:10,940
that is in Tiger Zero too

901
00:38:10,940 --> 00:38:13,980
doesn't mean ok  everything is fine

902
00:38:13,980 --> 00:38:15,900
we put them intie zero and so we find out if

903
00:38:15,900 --> 00:38:17,520
that object that we have put in t0

904
00:38:17,520 --> 00:38:19,140
which is important for us has

905
00:38:19,140 --> 00:38:20,400
relations with other objects in this

906
00:38:20,400 --> 00:38:23,280
case No We only have to

907
00:38:23,280 --> 00:38:24,540
check we have also put zero and

908
00:38:24,540 --> 00:38:25,820
we see a strange relation outside

909
00:38:25,820 --> 00:38:30,540
leonar aluminum that is the sundays it's not

910
00:38:30,540 --> 00:38:31,820


911
00:38:31,820 --> 00:38:34,320
sunday this is also taken from real cases

912
00:38:34,320 --> 00:38:36,540
because very often it happens especially

913
00:38:36,540 --> 00:38:38,460
in large and very small companies  trutturate

914
00:38:38,460 --> 00:38:40,140
that exists Maybe the group that I have

915
00:38:40,140 --> 00:38:41,700
called server provision so as

916
00:38:41,700 --> 00:38:44,339
not to be too trivial that takes care

917
00:38:44,339 --> 00:38:46,500
of the deployment of the servers and therefore also

918
00:38:46,500 --> 00:38:48,780
of the joy A domain of computers ok

919
00:38:48,780 --> 00:38:52,740
So a legitimate task if by chance one of

920
00:38:52,740 --> 00:38:53,599
these

921
00:38:53,599 --> 00:38:56,400
servers is promised to where  In

922
00:38:56,400 --> 00:38:59,040
controller unfortunately the owner of the domain

923
00:38:59,040 --> 00:39:01,880
does not automatically become the

924
00:39:01,880 --> 00:39:05,520
name but remains the server operator i.e.

925
00:39:05,520 --> 00:39:07,260
the group that created it the user

926
00:39:07,260 --> 00:39:09,540
who created it and this is clearly very

927
00:39:09,540 --> 00:39:11,180
dangerous because

928
00:39:11,180 --> 00:39:14,339
having it chip an object I can

929
00:39:14,339 --> 00:39:16,440
do anything  I can assign myself

930
00:39:16,440 --> 00:39:18,119
all the permissions anything I want

931
00:39:18,119 --> 00:39:21,480
so anyone who is part of Severo for server

932
00:39:21,480 --> 00:39:24,119
provision can in theory have

933
00:39:24,119 --> 00:39:26,520
complete control of the domain we

934
00:39:26,520 --> 00:39:28,140
realized the [ __ ] we

935
00:39:28,140 --> 00:39:30,839
did but let's try to understand at this

936
00:39:30,839 --> 00:39:32,400
point how big the [ __ ] is

937
00:39:32,400 --> 00:39:34,079
we did It's not by chance that

938
00:39:34,079 --> 00:39:35,880
the provision server

939
00:39:35,880 --> 00:39:38,099
is also badly configured and therefore there are

940
00:39:38,099 --> 00:39:40,020
also attack pads towards the provis server

941
00:39:40,020 --> 00:39:41,760
ion Which then in turn become

942
00:39:41,760 --> 00:39:43,920
a domain let's go on So

943
00:39:43,920 --> 00:39:45,599
let's start expanding the levels to

944
00:39:45,599 --> 00:39:47,880
see the next levels the next relationships

945
00:39:47,880 --> 00:39:50,160


946
00:39:50,160 --> 00:39:51,780
is going on the is going

947
00:39:51,780 --> 00:39:52,579
on

948
00:39:52,579 --> 00:39:56,160
ok here we see At this point

949
00:39:56,160 --> 00:39:57,900
svc Group comes out Then to the group that

950
00:39:57,900 --> 00:40:00,000
contains the accounts  of services that has

951
00:40:00,000 --> 00:40:01,339
a Wright

952
00:40:01,339 --> 00:40:04,920
duckle so he can write the permissions of

953
00:40:04,920 --> 00:40:07,020
if you have the server prodigion group

954
00:40:07,020 --> 00:40:08,460
then writing the permissions of server

955
00:40:08,460 --> 00:40:09,839
provision clearly if I am part

956
00:40:09,839 --> 00:40:13,020
of that group I can become a member of

957
00:40:13,020 --> 00:40:14,820
server provision in But who is part of

958
00:40:14,820 --> 00:40:18,500
this group swg Group  let's go on

959
00:40:18,980 --> 00:40:22,260
There is a swc1 user who is a

960
00:40:22,260 --> 00:40:24,420
service CAM Among other things, an account managed

961
00:40:24,420 --> 00:40:26,880
by the Group manager account So whose

962
00:40:26,880 --> 00:40:28,140
password is managed at the

963
00:40:28,140 --> 00:40:30,900
domain level equipped etc etc This

964
00:40:30,900 --> 00:40:33,079
service user

965
00:40:33,079 --> 00:40:36,119
Runs on computer 1 because computer one

966
00:40:36,119 --> 00:40:38,579
has the possibility  to read the password of

967
00:40:38,579 --> 00:40:40,560
user svc1 So this is a

968
00:40:40,560 --> 00:40:42,560
service that is allocated on svc1 compu

969
00:40:42,560 --> 00:40:45,960
ter 1 so if I can have

970
00:40:45,960 --> 00:40:48,180
maximum privileges on computer 1 I could

971
00:40:48,180 --> 00:40:49,800
follow this whole beautiful chain of

972
00:40:49,800 --> 00:40:53,220
attack until I become Domain admin or

973
00:40:53,220 --> 00:40:54,839
have control of the domain which is the

974
00:40:54,839 --> 00:40:56,700
same thing let's go on There are

975
00:40:56,700 --> 00:40:58,440
some other curiosities about computer 1

976
00:40:58,440 --> 00:41:01,800
Unfortunately yes there is a  'another Miss

977
00:41:01,800 --> 00:41:03,599
configuration so called

978
00:41:03,599 --> 00:41:05,960
user user1 very stupid normal user

979
00:41:05,960 --> 00:41:08,960
has the ability

980
00:41:08,960 --> 00:41:11,180
to

981
00:41:11,180 --> 00:41:13,440
Set permissions Write account

982
00:41:13,440 --> 00:41:14,880
restriction Who of you ever

983
00:41:14,880 --> 00:41:17,400
heard of this stuff here

984
00:41:17,400 --> 00:41:19,320
to what could this thing

985
00:41:19,320 --> 00:41:21,060
here come

986
00:41:21,060 --> 00:41:24,180
on There is a gadget that responds Wright

987
00:41:24,180 --> 00:41:27,119
Account restrictions it's written on an

988
00:41:27,119 --> 00:41:29,780
active object

989
00:41:29,780 --> 00:41:32,099
we get it in the gadget we keep

990
00:41:32,099 --> 00:41:33,260
it well

991
00:41:33,260 --> 00:41:35,640
have you ever heard

992
00:41:35,640 --> 00:41:37,920
of the resource base based attack with Trend

993
00:41:37,920 --> 00:41:41,220
delegation yeah this is it I have

994
00:41:41,220 --> 00:41:43,079
By the way I also wrote it a post

995
00:41:43,079 --> 00:41:44,900
which is called

996
00:41:44,900 --> 00:41:48,000
donkeyslation precisely because at least to

997
00:41:48,000 --> 00:41:49,380
summaries like me I have explained how it

998
00:41:49,380 --> 00:41:51,980
works with practical examples so

999
00:41:51,980 --> 00:41:56,220
the user  user1 having the possibility to

1000
00:41:56,220 --> 00:41:58,740
create a kerberos delegation here

1001
00:41:58,740 --> 00:42:00,780
again exploiting one of the many

1002
00:42:00,780 --> 00:42:03,119
weaknesses of the kerberos protocol He

1003
00:42:03,119 --> 00:42:05,220
manages to obtain the maximum

1004
00:42:05,220 --> 00:42:06,720
impersonal privileges any user therefore

1005
00:42:06,720 --> 00:42:09,359
maximum privileges on one computer which in

1006
00:42:09,359 --> 00:42:11,359
turn can read the password

1007
00:42:11,359 --> 00:42:13,980
of the service account  svc1 that if

1008
00:42:13,980 --> 00:42:15,720
once is part of the svc Group which in

1009
00:42:15,720 --> 00:42:17,579
turn can become a member of the admin server is

1010
00:42:17,579 --> 00:42:21,320
needed for goodnight but I tell you

1011
00:42:21,320 --> 00:42:23,839
that in turn it was the

1012
00:42:23,839 --> 00:42:26,880
domain owner in simple terms

1013
00:42:26,880 --> 00:42:29,579
user1 had a beautiful attack Pat

1014
00:42:29,579 --> 00:42:32,579
to become admin tomorrow

1015
00:42:32,579 --> 00:42:35,240
let's go  go on

1016
00:42:35,339 --> 00:42:36,960
then to solve then to

1017
00:42:36,960 --> 00:42:38,579
solve the first thing is apart from

1018
00:42:38,579 --> 00:42:41,700
fixing things downstream but first of

1019
00:42:41,700 --> 00:42:43,140
all absolutely I have to change

1020
00:42:43,140 --> 00:42:45,480
the oneler domain I can't afford

1021
00:42:45,480 --> 00:42:47,579
this thing here And I assure you that

1022
00:42:47,579 --> 00:42:49,440
I have seen it several times when you come back

1023
00:42:49,440 --> 00:42:51,420
checked at home eh because it happens

1024
00:42:51,420 --> 00:42:53,359
often

1025
00:42:53,359 --> 00:42:56,040
And this is also reported to us by pennite

1026
00:42:56,040 --> 00:42:58,800
in its output that the waves go  by

1027
00:42:58,800 --> 00:43:01,460
default it is not Domain admin so

1028
00:43:01,460 --> 00:43:03,859
let's do everything

1029
00:43:03,859 --> 00:43:06,560
Let's all do it together or it

1030
00:43:06,560 --> 00:43:08,520
should arrive it should arrive it

1031
00:43:08,520 --> 00:43:10,200
should arrive Go it comes so

1032
00:43:10,200 --> 00:43:13,319
that the video wants Here it is And it has

1033
00:43:13,319 --> 00:43:15,599
arrived this is the dragon who tells us

1034
00:43:15,599 --> 00:43:17,700
Ok don't worry it's all right dragons

1035
00:43:17,700 --> 00:43:19,920
have you put a  post also Directory

1036
00:43:19,920 --> 00:43:22,440
So no problem, in short, no

1037
00:43:22,440 --> 00:43:23,660
problem

1038
00:43:23,660 --> 00:43:27,200
[Applause]

1039
00:43:27,200 --> 00:43:30,119
We are almost at the end we have reached the

1040
00:43:30,119 --> 00:43:32,099


1041
00:43:32,099 --> 00:43:33,839
end we told you before it is not

1042
00:43:33,839 --> 00:43:36,720
available yet but from December 7th so

1043
00:43:36,720 --> 00:43:38,480
synchronize your clocks soon

1044
00:43:38,480 --> 00:43:41,280
you should be able to find it available and

1045
00:43:41,280 --> 00:43:44,460
online Ok let's go two more Slimes then

1046
00:43:44,460 --> 00:43:46,380
we're done i swear eh

1047
00:43:46,380 --> 00:43:49,380
ok here What can we have

1048
00:43:49,380 --> 00:43:51,420
learned that What are the useful tips

1049
00:43:51,420 --> 00:43:53,579
we can give First of all a

1050
00:43:53,579 --> 00:43:55,280
sestment continuous activectory

1051
00:43:55,280 --> 00:43:57,079
edgeractive director

1052
00:43:57,079 --> 00:43:59,640
let's not limit ourselves every 3-6 months but if

1053
00:43:59,640 --> 00:44:00,780
I go out continuously because the conditions

1054
00:44:00,780 --> 00:44:02,660
change continuously

1055
00:44:02,660 --> 00:44:04,920
objects inserted objects deleted

1056
00:44:04,920 --> 00:44:06,839
objects modified  we don't know

1057
00:44:06,839 --> 00:44:08,760
we never have i  full control for

1058
00:44:08,760 --> 00:44:10,680
this it is very important to do it So

1059
00:44:10,680 --> 00:44:13,440
monitor all the changes that

1060
00:44:13,440 --> 00:44:15,660
are made and then we can also

1061
00:44:15,660 --> 00:44:19,200
hide the privileged objects

1062
00:44:19,200 --> 00:44:21,420
so that a malicious attacker

1063
00:44:21,420 --> 00:44:23,099
cannot see them I don't

1064
00:44:23,099 --> 00:44:25,200
want to pass the

1065
00:44:25,200 --> 00:44:28,619
security message with this toosculty But in the meantime

1066
00:44:28,619 --> 00:44:31,079
we also make the life of the attackers

1067
00:44:31,079 --> 00:44:33,020
a little more difficult because by

1068
00:44:33,020 --> 00:44:35,099
properly hiding objects,

1069
00:44:35,099 --> 00:44:37,260
for example an attacker He can

1070
00:44:37,260 --> 00:44:39,240
no longer even understand who is part of the

1071
00:44:39,240 --> 00:44:40,800
group tomorrow admin even if the seed

1072
00:44:40,800 --> 00:44:42,780
They are all there but I challenge you to understand

1073
00:44:42,780 --> 00:44:45,060
all the sites as they are  interlaced with

1074
00:44:45,060 --> 00:44:46,740
each other who is this who something else

1075
00:44:46,740 --> 00:44:48,780
In short, it's not the simplest of things

1076
00:44:48,780 --> 00:44:51,260
well I think you

1077
00:44:51,260 --> 00:44:53,520
have some questions you ask us then

1078
00:44:53,520 --> 00:44:55,200
when we argue because obviously we

1079
00:44:55,200 --> 00:44:58,859
don't have time otherwise 50 No

1080
00:44:58,859 --> 00:45:00,300
the counter has been reset Let's hope we

1081
00:45:00,300 --> 00:45:01,680
haven't heard snoring So  we hope we

1082
00:45:01,680 --> 00:45:03,240
didn't hear any snoring So

1083
00:45:03,240 --> 00:45:04,560
we hope you enjoyed the ta  lk

1084
00:45:04,560 --> 00:45:06,480
These are our references So

1085
00:45:06,480 --> 00:45:08,819
if you want to contact us obviously it's not

1086
00:45:08,819 --> 00:45:11,640
us so know that

1087
00:45:11,640 --> 00:45:14,180
thanks to you too and good continuation

1088
00:45:14,180 --> 00:45:17,400
and thanks to all the [ __ ] Go staff and

1089
00:45:17,400 --> 00:45:20,540
above all to Mario Thanks to all

