1
00:00:00,719 --> 00:00:03,439
nights never came to dawn

2
00:00:03,439 --> 00:00:17,920
they went on and on

3
00:00:25,039 --> 00:00:26,800
good afternoon and welcome to the final

4
00:00:26,800 --> 00:00:28,880
breakout session of officer 2021 the

5
00:00:28,880 --> 00:00:30,560
20th anniversary of the conference

6
00:00:30,560 --> 00:00:32,079
my name is valdemar jacobson and i'll be

7
00:00:32,079 --> 00:00:33,600
your chair for this final session

8
00:00:33,600 --> 00:00:36,960
in this uh in this room for this second

9
00:00:36,960 --> 00:00:37,920
last session here

10
00:00:37,920 --> 00:00:41,280
we have vlado vodic

11
00:00:41,840 --> 00:00:43,840
who's a solutions engineer from motivo

12
00:00:43,840 --> 00:00:45,440
networks

13
00:00:45,440 --> 00:00:47,280
talking about building your active

14
00:00:47,280 --> 00:00:49,280
defense with mitre shield

15
00:00:49,280 --> 00:00:52,079
please welcome bill

16
00:00:56,800 --> 00:00:58,800
thank you very much thanks for being

17
00:00:58,800 --> 00:01:00,480
here um

18
00:01:00,480 --> 00:01:03,680
i i expected a small audience so

19
00:01:03,680 --> 00:01:06,799
it's great already we

20
00:01:06,799 --> 00:01:09,840
we're doing well okay so

21
00:01:09,840 --> 00:01:12,479
today's topic planning your active

22
00:01:12,479 --> 00:01:14,159
defense

23
00:01:14,159 --> 00:01:16,400
a little bit about me i've been with

24
00:01:16,400 --> 00:01:17,360
otibo for

25
00:01:17,360 --> 00:01:20,479
about a year and a half working building

26
00:01:20,479 --> 00:01:23,040
active defense techniques building

27
00:01:23,040 --> 00:01:24,320
solutions

28
00:01:24,320 --> 00:01:26,080
seeing how integrate in customers

29
00:01:26,080 --> 00:01:27,360
environments

30
00:01:27,360 --> 00:01:30,320
and picking up experience on the way uh

31
00:01:30,320 --> 00:01:30,960
how

32
00:01:30,960 --> 00:01:34,880
active defense can can help

33
00:01:36,479 --> 00:01:39,119
so a bit of an introduction into active

34
00:01:39,119 --> 00:01:40,479
defense what what

35
00:01:40,479 --> 00:01:42,640
is it and why are we talking about it

36
00:01:42,640 --> 00:01:43,600
now

37
00:01:43,600 --> 00:01:46,640
what what is the the reason why it's

38
00:01:46,640 --> 00:01:47,920
becoming

39
00:01:47,920 --> 00:01:51,040
more mainstream uh than than before

40
00:01:51,040 --> 00:01:52,960
um so we're talking about limited

41
00:01:52,960 --> 00:01:55,759
offensive action

42
00:01:55,759 --> 00:01:57,759
using cyber deception and adversary

43
00:01:57,759 --> 00:01:58,799
engagement

44
00:01:58,799 --> 00:02:02,240
but on friendly net networks in the past

45
00:02:02,240 --> 00:02:06,000
active defense was associated with

46
00:02:06,000 --> 00:02:09,119
hacking back kind of concept where you

47
00:02:09,119 --> 00:02:10,318
go and attack

48
00:02:10,318 --> 00:02:13,200
whoever is attacking you obviously this

49
00:02:13,200 --> 00:02:14,239
concept

50
00:02:14,239 --> 00:02:16,080
is generally reserved for law

51
00:02:16,080 --> 00:02:18,160
enforcement intelligence

52
00:02:18,160 --> 00:02:20,720
uh you you have legal problems

53
00:02:20,720 --> 00:02:21,520
essentially

54
00:02:21,520 --> 00:02:23,840
trying to attack uh somebody's

55
00:02:23,840 --> 00:02:24,720
infrastructure

56
00:02:24,720 --> 00:02:27,360
regardless of the fact that it could be

57
00:02:27,360 --> 00:02:27,920
a

58
00:02:27,920 --> 00:02:29,280
an intruder it could be something

59
00:02:29,280 --> 00:02:31,200
illegal you don't you don't really have

60
00:02:31,200 --> 00:02:33,120
the right as an enterprise to do that

61
00:02:33,120 --> 00:02:35,120
unless you work with enforcement law

62
00:02:35,120 --> 00:02:36,959
enforcement and even then

63
00:02:36,959 --> 00:02:38,640
there are some barriers to it so we are

64
00:02:38,640 --> 00:02:40,239
talking on friendly networks you may be

65
00:02:40,239 --> 00:02:42,319
working with your service providers

66
00:02:42,319 --> 00:02:44,640
and that's something uh that is possible

67
00:02:44,640 --> 00:02:46,160
but most of the time

68
00:02:46,160 --> 00:02:48,480
you are engaging adversaries on your own

69
00:02:48,480 --> 00:02:49,200
turf

70
00:02:49,200 --> 00:02:52,000
in your own network uh where where you

71
00:02:52,000 --> 00:02:52,400
are

72
00:02:52,400 --> 00:02:54,800
actually uh have full legal legal rights

73
00:02:54,800 --> 00:02:57,120
to do that

74
00:02:57,120 --> 00:02:58,480
where does it come from obviously

75
00:02:58,480 --> 00:03:00,319
militaries have been using

76
00:03:00,319 --> 00:03:03,680
uh adversary engagement um you know even

77
00:03:03,680 --> 00:03:04,400
in cyber

78
00:03:04,400 --> 00:03:06,640
for a long time the concept is very well

79
00:03:06,640 --> 00:03:07,440
established

80
00:03:07,440 --> 00:03:09,760
it's actually interesting in some places

81
00:03:09,760 --> 00:03:11,040
around the world

82
00:03:11,040 --> 00:03:13,280
there is an intuitive understanding of

83
00:03:13,280 --> 00:03:14,800
deception as a tool of

84
00:03:14,800 --> 00:03:18,000
cyber war yeah in some

85
00:03:18,000 --> 00:03:21,040
other places people don't want to use it

86
00:03:21,040 --> 00:03:22,400
regardless of the fact that they are

87
00:03:22,400 --> 00:03:24,080
engaging with somebody who is attacking

88
00:03:24,080 --> 00:03:24,879
attacking them

89
00:03:24,879 --> 00:03:28,080
they find the concept um

90
00:03:28,080 --> 00:03:32,319
uh you know strange and be dishonest

91
00:03:32,319 --> 00:03:33,760
uh regardless of the fact that it's a

92
00:03:33,760 --> 00:03:36,239
tool of war uh but in some places around

93
00:03:36,239 --> 00:03:36,879
the world

94
00:03:36,879 --> 00:03:38,560
you talk to a customer and they

95
00:03:38,560 --> 00:03:39,920
understand the concept

96
00:03:39,920 --> 00:03:43,360
immediately immediately and intuitively

97
00:03:43,360 --> 00:03:46,319
uh it's a potentially a question of

98
00:03:46,319 --> 00:03:47,599
culture and understanding of

99
00:03:47,599 --> 00:03:49,040
relationships

100
00:03:49,040 --> 00:03:52,400
between adversaries so uh u.s air force

101
00:03:52,400 --> 00:03:53,840
had these five these

102
00:03:53,840 --> 00:03:56,239
very catchy slogan a while back probably

103
00:03:56,239 --> 00:03:57,599
about 10 years now

104
00:03:57,599 --> 00:04:00,319
deny degrade disrupt deceive and destroy

105
00:04:00,319 --> 00:04:02,640
in the concept of cyber warfare

106
00:04:02,640 --> 00:04:05,760
and um they're they're using it you know

107
00:04:05,760 --> 00:04:06,319
there are

108
00:04:06,319 --> 00:04:08,560
there is some evidence that there is a

109
00:04:08,560 --> 00:04:09,920
real usage of this

110
00:04:09,920 --> 00:04:12,400
obviously not reported there is no

111
00:04:12,400 --> 00:04:13,599
public sources

112
00:04:13,599 --> 00:04:15,680
that will tell you that but it is being

113
00:04:15,680 --> 00:04:18,399
used also u.s cyber command has this

114
00:04:18,399 --> 00:04:20,720
concept of defending forward

115
00:04:20,720 --> 00:04:24,240
defending forward um because

116
00:04:24,240 --> 00:04:27,440
uh really as an acknowledgement uh that

117
00:04:27,440 --> 00:04:30,560
passive defense is failing

118
00:04:30,560 --> 00:04:32,320
you know there is evidence that that

119
00:04:32,320 --> 00:04:34,560
passive defense is failing

120
00:04:34,560 --> 00:04:37,280
in uh in in many ways you know there are

121
00:04:37,280 --> 00:04:38,880
attacks out there and one day

122
00:04:38,880 --> 00:04:40,240
of the attacks we're going to talk about

123
00:04:40,240 --> 00:04:42,000
it today where

124
00:04:42,000 --> 00:04:45,360
uh detection uh was only done by pure

125
00:04:45,360 --> 00:04:46,000
chance

126
00:04:46,000 --> 00:04:48,960
yeah we're talking about solarwinds uh

127
00:04:48,960 --> 00:04:49,520
style

128
00:04:49,520 --> 00:04:52,560
campaign uh these guys were detected by

129
00:04:52,560 --> 00:04:55,199
pure luck you know and they they could

130
00:04:55,199 --> 00:04:56,960
have been around for much longer

131
00:04:56,960 --> 00:04:59,360
and they probably are you know we we

132
00:04:59,360 --> 00:05:00,320
don't know how many

133
00:05:00,320 --> 00:05:02,160
of these campaigns are actually in

134
00:05:02,160 --> 00:05:04,080
progress right now as we speak

135
00:05:04,080 --> 00:05:05,360
but we'll talk about it a little bit

136
00:05:05,360 --> 00:05:07,280
later so

137
00:05:07,280 --> 00:05:11,919
us nist standards are following the this

138
00:05:11,919 --> 00:05:13,680
active defense becoming mainstream you

139
00:05:13,680 --> 00:05:15,120
can read these documents there are some

140
00:05:15,120 --> 00:05:16,639
really good descriptions on various

141
00:05:16,639 --> 00:05:17,600
techniques

142
00:05:17,600 --> 00:05:20,080
but really why we're talking today is

143
00:05:20,080 --> 00:05:20,880
because

144
00:05:20,880 --> 00:05:24,400
mitra might organization built this

145
00:05:24,400 --> 00:05:27,440
shield matrix similar to

146
00:05:27,440 --> 00:05:29,440
attack matrix how many of you are aware

147
00:05:29,440 --> 00:05:31,280
of an attack matrix

148
00:05:31,280 --> 00:05:34,240
yeah most of you okay excellent so and

149
00:05:34,240 --> 00:05:35,280
they also built

150
00:05:35,280 --> 00:05:38,080
a mapping a very clear mapping between

151
00:05:38,080 --> 00:05:39,759
each of the attack techniques

152
00:05:39,759 --> 00:05:42,800
to a shield defense technique so right

153
00:05:42,800 --> 00:05:44,000
now

154
00:05:44,000 --> 00:05:47,199
you can pick up an attack technique and

155
00:05:47,199 --> 00:05:48,479
find

156
00:05:48,479 --> 00:05:51,120
from the mapping matrix the active

157
00:05:51,120 --> 00:05:52,000
defense technique

158
00:05:52,000 --> 00:05:53,919
that would work against this tactics you

159
00:05:53,919 --> 00:05:55,039
can do this right now

160
00:05:55,039 --> 00:05:57,520
you can go and implement it uh using a

161
00:05:57,520 --> 00:05:59,120
number of various tools out there

162
00:05:59,120 --> 00:06:01,680
uh that are available either open source

163
00:06:01,680 --> 00:06:03,759
from commercial vendors like ativo

164
00:06:03,759 --> 00:06:06,400
um you can do this today and this is

165
00:06:06,400 --> 00:06:07,120
really the

166
00:06:07,120 --> 00:06:10,160
the point of the of the talk today so a

167
00:06:10,160 --> 00:06:10,880
little

168
00:06:10,880 --> 00:06:13,280
practical session on how to build your

169
00:06:13,280 --> 00:06:15,840
defenses

170
00:06:16,240 --> 00:06:19,360
so a little bit of analogy um to kind of

171
00:06:19,360 --> 00:06:21,120
establish the concept a little better

172
00:06:21,120 --> 00:06:24,400
this comes from a uh strategist uh

173
00:06:24,400 --> 00:06:27,039
from from mita the way he describes

174
00:06:27,039 --> 00:06:28,479
active defense is that

175
00:06:28,479 --> 00:06:31,600
imagine you have a you have a

176
00:06:31,600 --> 00:06:33,840
in a perimeter network yeah imagine

177
00:06:33,840 --> 00:06:34,880
there is a

178
00:06:34,880 --> 00:06:36,560
there is a you have a wall around your

179
00:06:36,560 --> 00:06:38,720
network and there is this river of

180
00:06:38,720 --> 00:06:42,400
bad stuff coming at you when you have a

181
00:06:42,400 --> 00:06:44,080
network without perimeter you can

182
00:06:44,080 --> 00:06:46,319
perhaps talk about the notion

183
00:06:46,319 --> 00:06:48,720
of badness out there and you are an

184
00:06:48,720 --> 00:06:49,680
island

185
00:06:49,680 --> 00:06:52,720
you know or you are you your an

186
00:06:52,720 --> 00:06:55,120
enterprise consists of

187
00:06:55,120 --> 00:06:57,919
many little islands identities floating

188
00:06:57,919 --> 00:06:58,880
in this ocean

189
00:06:58,880 --> 00:07:02,800
yeah uh trying to take over

190
00:07:02,800 --> 00:07:06,160
um you have some defenses yeah you will

191
00:07:06,160 --> 00:07:08,240
stop some of that

192
00:07:08,240 --> 00:07:10,160
there will some attacks uh that are

193
00:07:10,160 --> 00:07:11,440
going to go through

194
00:07:11,440 --> 00:07:14,000
it is actually amazing even today when

195
00:07:14,000 --> 00:07:15,199
you speak to a lot of

196
00:07:15,199 --> 00:07:19,039
people out there who say no

197
00:07:19,039 --> 00:07:22,319
no attacks can come through into my

198
00:07:22,319 --> 00:07:23,280
environment

199
00:07:23,280 --> 00:07:26,800
do you often get this uh

200
00:07:26,800 --> 00:07:30,160
you know thrown back at you that no

201
00:07:30,160 --> 00:07:31,759
attacks are not getting through to my

202
00:07:31,759 --> 00:07:33,280
enterprise into my enterprise

203
00:07:33,280 --> 00:07:36,560
anybody out there no okay i hear this

204
00:07:36,560 --> 00:07:37,199
quite often

205
00:07:37,199 --> 00:07:39,280
you know and it's really depressing to

206
00:07:39,280 --> 00:07:40,880
hear it when you hear it

207
00:07:40,880 --> 00:07:43,120
i i have a temptation to walk out of the

208
00:07:43,120 --> 00:07:44,639
room often

209
00:07:44,639 --> 00:07:48,000
but obviously i can't do that yeah

210
00:07:48,000 --> 00:07:50,560
so um how are the attacks happen they

211
00:07:50,560 --> 00:07:51,919
follow the path of least release

212
00:07:51,919 --> 00:07:52,720
resistance

213
00:07:52,720 --> 00:07:54,560
is this true if you were an attacker

214
00:07:54,560 --> 00:07:55,840
would you follow the path of this

215
00:07:55,840 --> 00:07:57,199
release resistance

216
00:07:57,199 --> 00:07:59,759
of course you have a cost of engagement

217
00:07:59,759 --> 00:08:01,039
you as an attacker

218
00:08:01,039 --> 00:08:02,560
regardless of why you're a russian

219
00:08:02,560 --> 00:08:04,160
foreign intelligence service

220
00:08:04,160 --> 00:08:06,479
or a ransomware operator you have a cost

221
00:08:06,479 --> 00:08:07,840
of operation

222
00:08:07,840 --> 00:08:10,639
you know none of this is free yeah you

223
00:08:10,639 --> 00:08:11,360
have

224
00:08:11,360 --> 00:08:13,360
you know you have your costs yeah so

225
00:08:13,360 --> 00:08:14,479
this resistance is

226
00:08:14,479 --> 00:08:18,000
the the way to go controlled access is

227
00:08:18,000 --> 00:08:19,520
the key

228
00:08:19,520 --> 00:08:22,319
so you as a defender should be in

229
00:08:22,319 --> 00:08:23,440
control

230
00:08:23,440 --> 00:08:26,080
over how these people are getting

231
00:08:26,080 --> 00:08:26,639
through

232
00:08:26,639 --> 00:08:28,720
because they will get through so when

233
00:08:28,720 --> 00:08:30,080
they get through

234
00:08:30,080 --> 00:08:32,719
wouldn't you want to be in control of

235
00:08:32,719 --> 00:08:33,679
that

236
00:08:33,679 --> 00:08:36,159
of course you would of course you would

237
00:08:36,159 --> 00:08:37,519
like to be in control

238
00:08:37,519 --> 00:08:40,559
you know somebody's coming at you and

239
00:08:40,559 --> 00:08:43,039
you direct them where you want them to

240
00:08:43,039 --> 00:08:44,080
be

241
00:08:44,080 --> 00:08:46,000
obviously it doesn't happen all the time

242
00:08:46,000 --> 00:08:47,120
uh it happens

243
00:08:47,120 --> 00:08:49,680
actually quite rarely but when it

244
00:08:49,680 --> 00:08:50,560
happens

245
00:08:50,560 --> 00:08:52,160
wouldn't you want to be in this sort of

246
00:08:52,160 --> 00:08:53,760
position so

247
00:08:53,760 --> 00:08:57,120
the answer will be i'm hoping yes

248
00:08:57,120 --> 00:09:00,560
so you want to channel them away from

249
00:09:00,560 --> 00:09:03,360
real assets you want to build a spillway

250
00:09:03,360 --> 00:09:03,839
you know

251
00:09:03,839 --> 00:09:06,320
every dam out there has got a spillway

252
00:09:06,320 --> 00:09:08,240
so when the water gets to the certain

253
00:09:08,240 --> 00:09:08,800
point

254
00:09:08,800 --> 00:09:11,120
you open the spillway yeah you release

255
00:09:11,120 --> 00:09:12,320
the pressure

256
00:09:12,320 --> 00:09:14,959
this is the concept that we that active

257
00:09:14,959 --> 00:09:18,079
defense is advocating

258
00:09:19,440 --> 00:09:22,720
so how does it sound um uh

259
00:09:22,720 --> 00:09:24,240
i think it's a pretty good description

260
00:09:24,240 --> 00:09:25,839
obviously this is for a perimeter-based

261
00:09:25,839 --> 00:09:26,480
network

262
00:09:26,480 --> 00:09:28,640
once we're talking about zero zero trust

263
00:09:28,640 --> 00:09:30,720
and once we're talking about

264
00:09:30,720 --> 00:09:34,399
you know um uh everything in the clouds

265
00:09:34,399 --> 00:09:37,920
uh everything is you know

266
00:09:37,920 --> 00:09:40,399
every identity is essentially uh a

267
00:09:40,399 --> 00:09:41,440
perimeter

268
00:09:41,440 --> 00:09:43,920
uh the concept would be slightly

269
00:09:43,920 --> 00:09:44,880
slightly different

270
00:09:44,880 --> 00:09:46,560
oh well the this description would be

271
00:09:46,560 --> 00:09:47,920
slightly different but the concept would

272
00:09:47,920 --> 00:09:51,279
stay the same

273
00:09:51,279 --> 00:09:53,360
okay so how does it work in practice

274
00:09:53,360 --> 00:09:54,800
yeah so let's say you wanted to

275
00:09:54,800 --> 00:09:55,600
implement it

276
00:09:55,600 --> 00:09:57,839
you have an attacker over there and he

277
00:09:57,839 --> 00:09:58,640
somehow

278
00:09:58,640 --> 00:10:00,640
is in a position in a position to see

279
00:10:00,640 --> 00:10:02,480
your assets yeah

280
00:10:02,480 --> 00:10:05,200
so if if these assets are in the cloud

281
00:10:05,200 --> 00:10:06,959
you can already see them today

282
00:10:06,959 --> 00:10:10,079
yeah in a perimeter he somehow

283
00:10:10,079 --> 00:10:11,519
controls a machine inside of your

284
00:10:11,519 --> 00:10:13,440
perimeter what is he going to do

285
00:10:13,440 --> 00:10:15,680
he's going to see your target assets

286
00:10:15,680 --> 00:10:16,880
he's going to see them

287
00:10:16,880 --> 00:10:20,320
yeah he can he can touch them he can

288
00:10:20,320 --> 00:10:23,600
he can send packets to them um

289
00:10:23,600 --> 00:10:26,000
obviously in a in a very well segmented

290
00:10:26,000 --> 00:10:27,440
network that could be a challenge but

291
00:10:27,440 --> 00:10:28,399
most of the time

292
00:10:28,399 --> 00:10:33,440
he can see these assets we want this guy

293
00:10:33,440 --> 00:10:37,680
to to divert his attention

294
00:10:37,680 --> 00:10:40,560
to some of the decoy assets we call them

295
00:10:40,560 --> 00:10:42,640
traps we call them lewis we call them

296
00:10:42,640 --> 00:10:44,079
you can also call them honeypots

297
00:10:44,079 --> 00:10:46,079
although honeypots

298
00:10:46,079 --> 00:10:47,519
have been used for research in the past

299
00:10:47,519 --> 00:10:49,360
not for detection so this is a this is

300
00:10:49,360 --> 00:10:50,880
this is a slightly different concept but

301
00:10:50,880 --> 00:10:52,399
you can also call them honeypots

302
00:10:52,399 --> 00:10:54,560
so you build this decoy infrastructure

303
00:10:54,560 --> 00:10:55,440
inside your

304
00:10:55,440 --> 00:10:58,800
network and you divert

305
00:10:58,800 --> 00:11:00,640
the attention of these attackers to the

306
00:11:00,640 --> 00:11:02,240
the infrastructure

307
00:11:02,240 --> 00:11:04,480
and this infrastructure could be

308
00:11:04,480 --> 00:11:05,920
absolutely anything

309
00:11:05,920 --> 00:11:09,200
you know we we have seen customers

310
00:11:09,200 --> 00:11:11,600
building carbon copies of some of their

311
00:11:11,600 --> 00:11:12,320
environments

312
00:11:12,320 --> 00:11:15,120
yeah they have a cluster of database

313
00:11:15,120 --> 00:11:16,800
service and they have a decoy cluster of

314
00:11:16,800 --> 00:11:17,920
database service

315
00:11:17,920 --> 00:11:20,480
or maybe three servers in a cluster

316
00:11:20,480 --> 00:11:22,640
decoys and the rest are real

317
00:11:22,640 --> 00:11:25,200
we have seen uh people go to great

318
00:11:25,200 --> 00:11:25,839
lengths

319
00:11:25,839 --> 00:11:29,120
to build decoy infrastructure yeah

320
00:11:29,120 --> 00:11:30,959
just in case the attacker lands in their

321
00:11:30,959 --> 00:11:33,040
network and

322
00:11:33,040 --> 00:11:34,320
they're going to do reconnaissance

323
00:11:34,320 --> 00:11:35,360
they're going to look around they're

324
00:11:35,360 --> 00:11:36,720
going to look in active directory

325
00:11:36,720 --> 00:11:37,920
they're going to

326
00:11:37,920 --> 00:11:40,240
steal identities and they're going to

327
00:11:40,240 --> 00:11:42,240
find these decoy assets

328
00:11:42,240 --> 00:11:45,440
and once they find the decoy assets

329
00:11:45,440 --> 00:11:48,480
it is pretty much game over for any

330
00:11:48,480 --> 00:11:50,160
attacker out there

331
00:11:50,160 --> 00:11:53,519
i don't know if you see this point but

332
00:11:53,519 --> 00:11:57,279
once the attacker is in a decoy

333
00:11:57,279 --> 00:11:59,200
this is a deterministic detection we are

334
00:11:59,200 --> 00:12:01,279
not detecting behaviors

335
00:12:01,279 --> 00:12:03,920
we are detecting we are responding

336
00:12:03,920 --> 00:12:05,120
straight away

337
00:12:05,120 --> 00:12:09,839
attacker in a decoy is a valid

338
00:12:09,839 --> 00:12:13,120
uh 19 19 99 of the time

339
00:12:13,120 --> 00:12:15,920
it's a it's deterministic we are not

340
00:12:15,920 --> 00:12:17,920
investigating

341
00:12:17,920 --> 00:12:20,240
somebody roaming around your decoy

342
00:12:20,240 --> 00:12:21,200
infrastructure

343
00:12:21,200 --> 00:12:23,839
we are responding we are responding we

344
00:12:23,839 --> 00:12:25,360
are responding we want we want to know

345
00:12:25,360 --> 00:12:26,560
why would somebody

346
00:12:26,560 --> 00:12:29,600
end up in a non-production network that

347
00:12:29,600 --> 00:12:31,519
is not advertised anywhere

348
00:12:31,519 --> 00:12:34,959
yeah we want to know

349
00:12:35,120 --> 00:12:38,000
so being in a truck in a trap is going

350
00:12:38,000 --> 00:12:38,320
to

351
00:12:38,320 --> 00:12:40,959
break any attacker automation yeah most

352
00:12:40,959 --> 00:12:42,240
attackers run automation

353
00:12:42,240 --> 00:12:44,399
it is going to break their automation

354
00:12:44,399 --> 00:12:46,160
it's going to confuse them

355
00:12:46,160 --> 00:12:48,880
it's going to confuse them um it's going

356
00:12:48,880 --> 00:12:50,320
to waste their time

357
00:12:50,320 --> 00:12:52,560
it's going to incur their costs their

358
00:12:52,560 --> 00:12:54,240
costs are going up

359
00:12:54,240 --> 00:12:56,720
time is ticking time is ticking their

360
00:12:56,720 --> 00:12:58,240
cost to go is going up

361
00:12:58,240 --> 00:13:00,720
a lot of attackers leave a lot a lot of

362
00:13:00,720 --> 00:13:02,079
attackers once they get caught in a

363
00:13:02,079 --> 00:13:03,440
decoy they leave

364
00:13:03,440 --> 00:13:05,519
and do you know what red team people do

365
00:13:05,519 --> 00:13:06,959
when they get caught caught into

366
00:13:06,959 --> 00:13:10,399
into in a decoy do you know what they do

367
00:13:10,399 --> 00:13:14,480
they swear and they sit down

368
00:13:14,480 --> 00:13:18,560
and essentially give up their engagement

369
00:13:18,560 --> 00:13:20,959
we see this time and time and time and

370
00:13:20,959 --> 00:13:22,160
time again

371
00:13:22,160 --> 00:13:25,200
essentially they give up they give up

372
00:13:25,200 --> 00:13:27,839
or actually more advanced attackers then

373
00:13:27,839 --> 00:13:30,240
attack

374
00:13:30,240 --> 00:13:32,079
the management of the decoy

375
00:13:32,079 --> 00:13:34,320
infrastructure they realize they're in a

376
00:13:34,320 --> 00:13:34,959
decoy

377
00:13:34,959 --> 00:13:38,800
they get angry they find where where

378
00:13:38,800 --> 00:13:41,360
the infrastructure is managed from and

379
00:13:41,360 --> 00:13:42,480
then they attack

380
00:13:42,480 --> 00:13:45,120
our management console we see that a lot

381
00:13:45,120 --> 00:13:47,120
of time and what do we do

382
00:13:47,120 --> 00:13:49,040
we build the decoy of our management

383
00:13:49,040 --> 00:13:50,639
infrastructure

384
00:13:50,639 --> 00:13:54,160
okay excellent let's have fun

385
00:13:54,160 --> 00:13:57,440
let's have fun let's with a red team

386
00:13:57,440 --> 00:13:58,480
obviously we are not

387
00:13:58,480 --> 00:14:00,839
having fun with with real attacks

388
00:14:00,839 --> 00:14:02,560
obviously

389
00:14:02,560 --> 00:14:05,279
so so this is the uh how this works in

390
00:14:05,279 --> 00:14:06,399
practice

391
00:14:06,399 --> 00:14:08,639
so how do we build this how do we build

392
00:14:08,639 --> 00:14:09,839
this so

393
00:14:09,839 --> 00:14:12,959
might have built this uh shield matrix

394
00:14:12,959 --> 00:14:16,880
this is a matrix of defense techniques

395
00:14:16,880 --> 00:14:19,199
they built it based on their research

396
00:14:19,199 --> 00:14:20,000
they they have

397
00:14:20,000 --> 00:14:22,959
more than 10 years of research in in

398
00:14:22,959 --> 00:14:23,680
building

399
00:14:23,680 --> 00:14:26,959
active defenses they they run active

400
00:14:26,959 --> 00:14:30,079
defense in their network

401
00:14:30,079 --> 00:14:32,880
published papers they published human

402
00:14:32,880 --> 00:14:33,760
behavior

403
00:14:33,760 --> 00:14:36,800
uh you know exercises with red teams to

404
00:14:36,800 --> 00:14:37,440
prove

405
00:14:37,440 --> 00:14:39,839
that active defenses are working there

406
00:14:39,839 --> 00:14:41,839
is a whole body of research out there

407
00:14:41,839 --> 00:14:44,399
and they there are 33 techniques in this

408
00:14:44,399 --> 00:14:45,040
matrix

409
00:14:45,040 --> 00:14:46,560
it's a little deceptive there are only

410
00:14:46,560 --> 00:14:48,399
actually 33 techniques

411
00:14:48,399 --> 00:14:50,320
but they're they're grouped in these

412
00:14:50,320 --> 00:14:52,240
tactics similar to the

413
00:14:52,240 --> 00:14:55,680
matter attack matrix

414
00:14:55,680 --> 00:14:57,360
so let me just quickly go through the

415
00:14:57,360 --> 00:14:59,519
tactics we obviously can't go

416
00:14:59,519 --> 00:15:02,880
into any detail but a channel is

417
00:15:02,880 --> 00:15:05,839
essentially diverting guiding the attack

418
00:15:05,839 --> 00:15:07,680
into a certain direction yeah

419
00:15:07,680 --> 00:15:10,480
so you give them a lure you build some

420
00:15:10,480 --> 00:15:12,320
decoy infrastructure and you guide them

421
00:15:12,320 --> 00:15:14,240
into a decoy infrastructure so this is

422
00:15:14,240 --> 00:15:14,639
what

423
00:15:14,639 --> 00:15:16,959
channel is once they're there you want

424
00:15:16,959 --> 00:15:18,320
to collect you want to collect

425
00:15:18,320 --> 00:15:19,199
intelligence

426
00:15:19,199 --> 00:15:21,839
you want to collect iocs any binaries

427
00:15:21,839 --> 00:15:22,880
any scripts

428
00:15:22,880 --> 00:15:26,560
it's a treasure trove for any threatened

429
00:15:26,560 --> 00:15:28,560
uh intelligence person out there because

430
00:15:28,560 --> 00:15:30,720
this is a first-hand intelligence

431
00:15:30,720 --> 00:15:32,720
uh what is the best intelligence you can

432
00:15:32,720 --> 00:15:35,040
have from your own network

433
00:15:35,040 --> 00:15:36,720
from your own network from your past

434
00:15:36,720 --> 00:15:39,600
attacks from people who are consistently

435
00:15:39,600 --> 00:15:40,959
attacking you

436
00:15:40,959 --> 00:15:44,480
from uh you know anyone who has been in

437
00:15:44,480 --> 00:15:45,600
your network already

438
00:15:45,600 --> 00:15:48,320
he's likely to come back if you are

439
00:15:48,320 --> 00:15:49,279
targeted by

440
00:15:49,279 --> 00:15:52,320
an adversary he will come back they do

441
00:15:52,320 --> 00:15:55,279
come back and if you have their iocs

442
00:15:55,279 --> 00:15:56,560
well

443
00:15:56,560 --> 00:15:58,880
you are almost uh you're ready you're

444
00:15:58,880 --> 00:16:00,959
ready to defend

445
00:16:00,959 --> 00:16:03,199
contain uh you want to contain the

446
00:16:03,199 --> 00:16:04,959
attacker within a certain area

447
00:16:04,959 --> 00:16:07,120
you know to to decide how quickly you

448
00:16:07,120 --> 00:16:08,240
want to respond

449
00:16:08,240 --> 00:16:11,040
and how how proportionally you want to

450
00:16:11,040 --> 00:16:11,920
respond

451
00:16:11,920 --> 00:16:13,199
do you want to shut down half of your

452
00:16:13,199 --> 00:16:15,279
network while you

453
00:16:15,279 --> 00:16:18,160
defending defending like the pipeline

454
00:16:18,160 --> 00:16:19,839
people in u.s

455
00:16:19,839 --> 00:16:22,000
sometimes you do sometimes you don't

456
00:16:22,000 --> 00:16:23,120
depending on the

457
00:16:23,120 --> 00:16:25,120
on the type of attacker what are they

458
00:16:25,120 --> 00:16:26,800
trying to shut you down

459
00:16:26,800 --> 00:16:29,040
are they trying to ransom you or is this

460
00:16:29,040 --> 00:16:30,079
an untargeted

461
00:16:30,079 --> 00:16:31,360
attack and they don't know where they

462
00:16:31,360 --> 00:16:33,040
landed and they're trying to figure out

463
00:16:33,040 --> 00:16:34,560
what to do to you

464
00:16:34,560 --> 00:16:36,720
depends how you how what do you want to

465
00:16:36,720 --> 00:16:38,720
do and you have a little bit of time to

466
00:16:38,720 --> 00:16:40,000
make a decision

467
00:16:40,000 --> 00:16:42,560
a lot of our customers respond straight

468
00:16:42,560 --> 00:16:43,040
away

469
00:16:43,040 --> 00:16:45,440
you know they don't they're not they're

470
00:16:45,440 --> 00:16:46,800
not taking any risks

471
00:16:46,800 --> 00:16:48,639
but responding too early obviously has

472
00:16:48,639 --> 00:16:50,880
risks too you know when you

473
00:16:50,880 --> 00:16:52,560
when you're talking to a serious

474
00:16:52,560 --> 00:16:54,959
attacker when you're engaging a serious

475
00:16:54,959 --> 00:16:55,759
attacker

476
00:16:55,759 --> 00:16:58,639
responding too quickly is a risk is a

477
00:16:58,639 --> 00:17:00,320
risk that can be

478
00:17:00,320 --> 00:17:03,120
uh that it can cost you yeah so a little

479
00:17:03,120 --> 00:17:04,400
bit of time is

480
00:17:04,400 --> 00:17:07,520
is good here detection is obviously very

481
00:17:07,520 --> 00:17:08,400
central to

482
00:17:08,400 --> 00:17:11,119
to the whole exercise you want to detect

483
00:17:11,119 --> 00:17:12,959
you want to be aware of their activities

484
00:17:12,959 --> 00:17:13,599
you want to

485
00:17:13,599 --> 00:17:15,280
you want to know what they what they

486
00:17:15,280 --> 00:17:16,799
what they're doing

487
00:17:16,799 --> 00:17:18,480
disrupt you're going to stop then doing

488
00:17:18,480 --> 00:17:20,319
certain things you want to stop them

489
00:17:20,319 --> 00:17:21,839
doing certain things you want to stop

490
00:17:21,839 --> 00:17:22,160
them

491
00:17:22,160 --> 00:17:24,480
touching your production infrastructure

492
00:17:24,480 --> 00:17:26,079
especially your critical infrastructure

493
00:17:26,079 --> 00:17:26,799
you want to

494
00:17:26,799 --> 00:17:30,160
you want to stop them going there

495
00:17:30,400 --> 00:17:33,840
as much as possible um

496
00:17:33,840 --> 00:17:36,320
the the three techniques uh tactics on

497
00:17:36,320 --> 00:17:36,880
the right

498
00:17:36,880 --> 00:17:40,080
are kind of more advanced okay and not

499
00:17:40,080 --> 00:17:41,039
often used

500
00:17:41,039 --> 00:17:44,320
but if you can you would facilitate

501
00:17:44,320 --> 00:17:46,400
you would allow attackers to do certain

502
00:17:46,400 --> 00:17:47,440
things

503
00:17:47,440 --> 00:17:49,600
you you would it's similar to the

504
00:17:49,600 --> 00:17:50,559
channel so

505
00:17:50,559 --> 00:17:53,679
you would perhaps even give them access

506
00:17:53,679 --> 00:17:55,120
to some of the

507
00:17:55,120 --> 00:17:58,320
some of your real production uh

508
00:17:58,320 --> 00:18:01,039
to divert them from the from the

509
00:18:01,039 --> 00:18:01,760
critical

510
00:18:01,760 --> 00:18:04,080
production you know but at least you

511
00:18:04,080 --> 00:18:04,960
know they're there

512
00:18:04,960 --> 00:18:07,280
you know uh you you you may allow them

513
00:18:07,280 --> 00:18:08,480
to do certain things

514
00:18:08,480 --> 00:18:11,520
perhaps for to get more intelligence uh

515
00:18:11,520 --> 00:18:13,360
and perhaps to divert them from the real

516
00:18:13,360 --> 00:18:15,120
things legitimize

517
00:18:15,120 --> 00:18:17,039
you want to add authenticity to your

518
00:18:17,039 --> 00:18:18,240
decoys

519
00:18:18,240 --> 00:18:21,679
so for example you can put out

520
00:18:21,679 --> 00:18:24,720
a sql server out there with no data okay

521
00:18:24,720 --> 00:18:26,640
so they're going to land on this server

522
00:18:26,640 --> 00:18:28,240
and they're going to say

523
00:18:28,240 --> 00:18:30,000
this is not production there is no data

524
00:18:30,000 --> 00:18:32,080
in it okay how about if you add some

525
00:18:32,080 --> 00:18:32,720
data

526
00:18:32,720 --> 00:18:35,679
you know you you make it a a test server

527
00:18:35,679 --> 00:18:37,760
you make it a qa server you put some qa

528
00:18:37,760 --> 00:18:38,960
data on it

529
00:18:38,960 --> 00:18:41,039
that has expired that is maybe six

530
00:18:41,039 --> 00:18:42,720
months old or a year old

531
00:18:42,720 --> 00:18:45,760
that is not current that is

532
00:18:45,760 --> 00:18:48,080
essentially just a bait you know so you

533
00:18:48,080 --> 00:18:50,480
add authenticity to your decoys

534
00:18:50,480 --> 00:18:53,200
to legitimize the decoy infrastructure

535
00:18:53,200 --> 00:18:54,160
and the last one

536
00:18:54,160 --> 00:18:56,559
is test you test them um you know in

537
00:18:56,559 --> 00:18:57,760
some advanced cases

538
00:18:57,760 --> 00:19:01,520
you want to put a a piece of content

539
00:19:01,520 --> 00:19:04,799
on the server where they are

540
00:19:04,799 --> 00:19:07,120
to see what they do with it to see what

541
00:19:07,120 --> 00:19:07,919
they do with it

542
00:19:07,919 --> 00:19:10,480
maybe a script maybe a credential maybe

543
00:19:10,480 --> 00:19:11,679
a document

544
00:19:11,679 --> 00:19:14,559
maybe a document with some with

545
00:19:14,559 --> 00:19:16,400
something related to your business

546
00:19:16,400 --> 00:19:18,160
and see what they do with it you give

547
00:19:18,160 --> 00:19:20,160
them a bait and you see what they do

548
00:19:20,160 --> 00:19:20,799
with it so

549
00:19:20,799 --> 00:19:24,799
so this is what um test is

550
00:19:24,799 --> 00:19:26,400
um i think we need to go a little bit

551
00:19:26,400 --> 00:19:29,200
faster yeah

552
00:19:29,440 --> 00:19:32,640
okay so how do you how do you do this um

553
00:19:32,640 --> 00:19:34,240
uh start with intelligence about the

554
00:19:34,240 --> 00:19:35,760
adversary so you need to know who are

555
00:19:35,760 --> 00:19:36,480
you against

556
00:19:36,480 --> 00:19:38,720
yeah you need to make a list of the

557
00:19:38,720 --> 00:19:40,000
attack techniques and

558
00:19:40,000 --> 00:19:43,440
and start with something uh you know to

559
00:19:43,440 --> 00:19:45,760
to uh to know what are you defending

560
00:19:45,760 --> 00:19:46,799
against

561
00:19:46,799 --> 00:19:48,880
you should you choose shield tactics

562
00:19:48,880 --> 00:19:50,799
using this mapping that i will show you

563
00:19:50,799 --> 00:19:52,640
in a moment and then you

564
00:19:52,640 --> 00:19:55,440
deploy these techniques you you

565
00:19:55,440 --> 00:19:58,880
operationalize the whole thing

566
00:19:59,520 --> 00:20:01,440
so here's an example so let's just work

567
00:20:01,440 --> 00:20:02,799
through this example

568
00:20:02,799 --> 00:20:06,240
um so it's not uh

569
00:20:06,240 --> 00:20:09,440
two okay um

570
00:20:09,440 --> 00:20:11,679
so solo wins attack uh how many of you

571
00:20:11,679 --> 00:20:13,280
are aware of it

572
00:20:13,280 --> 00:20:16,720
yeah most of you okay most sophisticated

573
00:20:16,720 --> 00:20:18,000
attack

574
00:20:18,000 --> 00:20:21,360
ever perhaps more significant attack

575
00:20:21,360 --> 00:20:23,678
ever

576
00:20:24,320 --> 00:20:28,640
15 u.s government agencies

577
00:20:28,640 --> 00:20:32,960
some big name cyber security vendors

578
00:20:32,960 --> 00:20:36,000
yeah very sophisticated attack

579
00:20:36,000 --> 00:20:38,480
very wide-ranging attack so this is a

580
00:20:38,480 --> 00:20:40,320
microsoft slide so what what uh

581
00:20:40,320 --> 00:20:42,080
what happened here this is the second

582
00:20:42,080 --> 00:20:44,400
stage so after the

583
00:20:44,400 --> 00:20:46,640
after they got the orion server updated

584
00:20:46,640 --> 00:20:49,039
with with some malicious stuff

585
00:20:49,039 --> 00:20:51,760
they got credentials from memory you

586
00:20:51,760 --> 00:20:53,039
know some conventional

587
00:20:53,039 --> 00:20:56,080
methods there they enumerated

588
00:20:56,080 --> 00:20:59,280
active directory they found some stuff

589
00:20:59,280 --> 00:21:02,240
in there they escalated privileges uh

590
00:21:02,240 --> 00:21:04,480
in the active directive directory they

591
00:21:04,480 --> 00:21:06,559
got a domain admin

592
00:21:06,559 --> 00:21:10,159
they stole saml signing key

593
00:21:10,159 --> 00:21:13,600
and they got into cloud and

594
00:21:13,600 --> 00:21:17,520
and got emails and data and so on okay

595
00:21:17,520 --> 00:21:20,000
so let's say you want to defend this

596
00:21:20,000 --> 00:21:21,919
attack using active defense what would

597
00:21:21,919 --> 00:21:22,640
you do

598
00:21:22,640 --> 00:21:26,080
so deceptive lss credentials so

599
00:21:26,080 --> 00:21:28,960
um you know mimikatz is dumping stuff

600
00:21:28,960 --> 00:21:29,679
from memory

601
00:21:29,679 --> 00:21:31,840
how about if one quarter of these

602
00:21:31,840 --> 00:21:33,919
credentials are decoys

603
00:21:33,919 --> 00:21:37,200
that the the attack is dumped yeah

604
00:21:37,200 --> 00:21:39,440
well how good would that be they would

605
00:21:39,440 --> 00:21:41,039
find some credentials they would try to

606
00:21:41,039 --> 00:21:43,039
use the credentials and

607
00:21:43,039 --> 00:21:45,520
game over game over for the attacker you

608
00:21:45,520 --> 00:21:47,200
would know that somebody is dumping

609
00:21:47,200 --> 00:21:48,159
memory

610
00:21:48,159 --> 00:21:51,440
in in your in your in your windows yeah

611
00:21:51,440 --> 00:21:53,039
who is dumping memory in your windows

612
00:21:53,039 --> 00:21:53,760
for fun

613
00:21:53,760 --> 00:21:57,919
nobody nobody yeah and if somebody do

614
00:21:57,919 --> 00:21:59,679
they need to be sacked anyway

615
00:21:59,679 --> 00:22:02,799
yeah so this is what i'm saying it this

616
00:22:02,799 --> 00:22:04,880
is a deterministic detection we are not

617
00:22:04,880 --> 00:22:06,480
we are not talking behavioral detection

618
00:22:06,480 --> 00:22:09,440
that you need analysts time to correlate

619
00:22:09,440 --> 00:22:10,880
and context and

620
00:22:10,880 --> 00:22:12,480
map with threat intelligence and so on

621
00:22:12,480 --> 00:22:14,799
no no deterministic

622
00:22:14,799 --> 00:22:16,799
it's it's an alarm i need to do

623
00:22:16,799 --> 00:22:17,919
something about it

624
00:22:17,919 --> 00:22:22,320
yeah and then you would present some

625
00:22:22,320 --> 00:22:24,320
smb shares that the decoys you would

626
00:22:24,320 --> 00:22:27,760
have some wmi decoys around the place

627
00:22:27,760 --> 00:22:30,159
you would intercept ad enumeration you

628
00:22:30,159 --> 00:22:31,600
would give them some false

629
00:22:31,600 --> 00:22:35,360
data you would disrupt the discovery of

630
00:22:35,360 --> 00:22:37,679
users that are vulnerable vulnerable

631
00:22:37,679 --> 00:22:40,400
and what if you had three adfs servers

632
00:22:40,400 --> 00:22:42,080
instead of one

633
00:22:42,080 --> 00:22:45,039
what would happen the attacker would

634
00:22:45,039 --> 00:22:45,600
dump

635
00:22:45,600 --> 00:22:48,960
private sml saml keys would they pick

636
00:22:48,960 --> 00:22:50,640
just one or would they dump

637
00:22:50,640 --> 00:22:53,440
this credential from all three idfs

638
00:22:53,440 --> 00:22:54,880
servers

639
00:22:54,880 --> 00:22:57,919
i think they would want all three

640
00:22:57,919 --> 00:23:00,960
yeah and two of them are decoys

641
00:23:00,960 --> 00:23:04,799
yeah again you have a very clear

642
00:23:04,799 --> 00:23:05,600
detection

643
00:23:05,600 --> 00:23:08,320
who is dumping keys from your adfs by

644
00:23:08,320 --> 00:23:10,400
the way who is running adfs here or who

645
00:23:10,400 --> 00:23:13,039
knows somebody that runs your dfs

646
00:23:13,039 --> 00:23:15,520
excellent excellent i'm surprised there

647
00:23:15,520 --> 00:23:16,960
is no more people here

648
00:23:16,960 --> 00:23:21,600
they call adfs lcs for the cloud

649
00:23:21,600 --> 00:23:25,039
so you know what we had mimikatz what

650
00:23:25,039 --> 00:23:26,159
mimikatz did for

651
00:23:26,159 --> 00:23:30,000
for windows now we have adfs

652
00:23:30,000 --> 00:23:33,760
leaking keys um

653
00:23:33,760 --> 00:23:35,600
and can you have adfs that is not

654
00:23:35,600 --> 00:23:37,679
attached to active directory

655
00:23:37,679 --> 00:23:41,039
you can't can you and how easy is it to

656
00:23:41,039 --> 00:23:43,840
get a domain admin in active directory

657
00:23:43,840 --> 00:23:45,679
how easy is it

658
00:23:45,679 --> 00:23:48,960
what would you say half an hour

659
00:23:48,960 --> 00:23:50,640
who who thinks half an hour is enough to

660
00:23:50,640 --> 00:23:52,559
get active directory uh

661
00:23:52,559 --> 00:23:56,159
domain admin who thinks that a couple of

662
00:23:56,159 --> 00:23:58,480
couple of out there on average it is

663
00:23:58,480 --> 00:23:59,360
half an hour

664
00:23:59,360 --> 00:24:02,559
believe me believe me let's get a room

665
00:24:02,559 --> 00:24:04,240
full of penetration testers

666
00:24:04,240 --> 00:24:07,200
and let's let's have a uh you know rise

667
00:24:07,200 --> 00:24:08,720
of hands

668
00:24:08,720 --> 00:24:12,159
you will see 100 of penetration testers

669
00:24:12,159 --> 00:24:12,799
saying

670
00:24:12,799 --> 00:24:15,279
it takes us less than half an hour in

671
00:24:15,279 --> 00:24:18,159
average enterprise

672
00:24:18,159 --> 00:24:20,240
how easy to get to the private key of

673
00:24:20,240 --> 00:24:21,600
adfs

674
00:24:21,600 --> 00:24:24,960
very very easy yeah so anyway we are we

675
00:24:24,960 --> 00:24:26,720
are now distracted from active defense

676
00:24:26,720 --> 00:24:28,159
here

677
00:24:28,159 --> 00:24:30,000
okay so this process is a little

678
00:24:30,000 --> 00:24:32,159
difficult because you need to kind of

679
00:24:32,159 --> 00:24:36,400
map your own way through this what if

680
00:24:36,400 --> 00:24:39,840
there was an automated way to pick the

681
00:24:39,840 --> 00:24:43,200
uh attack techniques and map them into

682
00:24:43,200 --> 00:24:44,159
defense techniques

683
00:24:44,159 --> 00:24:48,000
well there is okay this is a

684
00:24:48,000 --> 00:24:53,440
navigator map of unc2452

685
00:24:53,440 --> 00:24:57,120
you have a list of techniques there yeah

686
00:24:57,120 --> 00:24:59,840
you can maybe add a few more to this um

687
00:24:59,840 --> 00:25:01,520
i just picked a few here from the

688
00:25:01,520 --> 00:25:02,799
discovery column

689
00:25:02,799 --> 00:25:04,640
discovery column is a big one for active

690
00:25:04,640 --> 00:25:06,880
defense yeah if you can't discover

691
00:25:06,880 --> 00:25:10,159
you can't attack yeah you know you as an

692
00:25:10,159 --> 00:25:11,440
attacker

693
00:25:11,440 --> 00:25:13,919
if you don't have the targets you you'd

694
00:25:13,919 --> 00:25:14,480
struggle

695
00:25:14,480 --> 00:25:16,320
yeah so you need to do discovery so i

696
00:25:16,320 --> 00:25:17,679
picked a couple

697
00:25:17,679 --> 00:25:21,360
um and also also uh

698
00:25:21,360 --> 00:25:24,159
you know privilege as a lateral movement

699
00:25:24,159 --> 00:25:26,000
is very closely related to discovery

700
00:25:26,000 --> 00:25:26,480
yeah

701
00:25:26,480 --> 00:25:28,480
you do your discovery you steal

702
00:25:28,480 --> 00:25:30,799
credentials you do

703
00:25:30,799 --> 00:25:32,880
you do privilege escalation so so in

704
00:25:32,880 --> 00:25:34,159
this matrix

705
00:25:34,159 --> 00:25:37,679
privilege escalation um credential

706
00:25:37,679 --> 00:25:39,760
access discovery electoral movement is

707
00:25:39,760 --> 00:25:42,400
90 of the time that the attacker spends

708
00:25:42,400 --> 00:25:45,039
90 percent of the time they go in

709
00:25:45,039 --> 00:25:46,240
circles

710
00:25:46,240 --> 00:25:48,080
finding more targets getting more

711
00:25:48,080 --> 00:25:49,440
credentials

712
00:25:49,440 --> 00:25:51,200
you know and this circle can go for a

713
00:25:51,200 --> 00:25:53,520
long time yeah we talking

714
00:25:53,520 --> 00:25:55,919
months and months and months until they

715
00:25:55,919 --> 00:25:57,120
find what they're looking for

716
00:25:57,120 --> 00:26:01,679
yeah typically they go through

717
00:26:01,679 --> 00:26:04,480
five different targets before they find

718
00:26:04,480 --> 00:26:05,360
what they're looking for

719
00:26:05,360 --> 00:26:09,760
yeah so this is an iterative uh

720
00:26:09,760 --> 00:26:13,679
technique here so we have this

721
00:26:13,679 --> 00:26:16,799
and now um can we switch to

722
00:26:16,799 --> 00:26:20,559
to the computer here thank you

723
00:26:21,120 --> 00:26:24,159
so um you basically

724
00:26:24,159 --> 00:26:27,919
go to the um

725
00:26:28,240 --> 00:26:31,360
shield defense matrix you go to the

726
00:26:31,360 --> 00:26:34,000
complete mapping here

727
00:26:34,000 --> 00:26:36,240
and here is the mapping yeah so here's

728
00:26:36,240 --> 00:26:37,840
the defense technique uh here is the

729
00:26:37,840 --> 00:26:39,120
attack techniques here is defense

730
00:26:39,120 --> 00:26:40,080
technique

731
00:26:40,080 --> 00:26:43,440
so what do we do um

732
00:26:43,440 --> 00:26:46,480
t one

733
00:26:46,480 --> 00:26:49,120
zero seven eight i think valid accounts

734
00:26:49,120 --> 00:26:49,679
yeah

735
00:26:49,679 --> 00:26:51,520
this is one of the techniques and here

736
00:26:51,520 --> 00:26:53,440
it is decoy account

737
00:26:53,440 --> 00:26:56,000
so for the valid uh valid accounts

738
00:26:56,000 --> 00:26:56,640
technique

739
00:26:56,640 --> 00:26:59,840
i'm going to pick dte0010

740
00:26:59,840 --> 00:27:02,880
decoy account defense technique

741
00:27:02,880 --> 00:27:05,679
and you say you simply go uh we can go

742
00:27:05,679 --> 00:27:06,720
back to the slide

743
00:27:06,720 --> 00:27:09,200
so you simply go technique by technique

744
00:27:09,200 --> 00:27:10,559
you do the mapping

745
00:27:10,559 --> 00:27:13,600
you find the defense active defense

746
00:27:13,600 --> 00:27:14,159
technique

747
00:27:14,159 --> 00:27:17,039
and you go and implement it this is the

748
00:27:17,039 --> 00:27:17,679
power

749
00:27:17,679 --> 00:27:20,640
of of miter shield so you now have a

750
00:27:20,640 --> 00:27:22,000
road map

751
00:27:22,000 --> 00:27:24,320
to to building active defense techniques

752
00:27:24,320 --> 00:27:26,399
and obviously i'm not saying that

753
00:27:26,399 --> 00:27:28,880
you would defend solarwinds attack

754
00:27:28,880 --> 00:27:29,679
solely

755
00:27:29,679 --> 00:27:31,200
using active defense techniques i mean

756
00:27:31,200 --> 00:27:33,679
this is this is really taking it too far

757
00:27:33,679 --> 00:27:36,799
you look at what you have and you see

758
00:27:36,799 --> 00:27:38,159
the defense techniques that you already

759
00:27:38,159 --> 00:27:38,880
have in place

760
00:27:38,880 --> 00:27:42,000
preventative and detective you assess

761
00:27:42,000 --> 00:27:43,200
how good they are

762
00:27:43,200 --> 00:27:45,840
and then you look at the ones that are

763
00:27:45,840 --> 00:27:47,120
that you are weak in

764
00:27:47,120 --> 00:27:50,159
yeah so for example for example you

765
00:27:50,159 --> 00:27:51,760
cannot detach adfs

766
00:27:51,760 --> 00:27:53,679
from the active directory active

767
00:27:53,679 --> 00:27:55,440
directory is already very very

768
00:27:55,440 --> 00:27:58,000
uh you know vulnerable so this is

769
00:27:58,000 --> 00:27:58,640
something you

770
00:27:58,640 --> 00:28:01,200
you can't easily build the defensive

771
00:28:01,200 --> 00:28:03,039
technique so why not use an active

772
00:28:03,039 --> 00:28:04,000
defense technique

773
00:28:04,000 --> 00:28:07,520
in places where passive defense

774
00:28:07,520 --> 00:28:10,640
is failing why not do that

775
00:28:10,640 --> 00:28:13,120
and this is where what more and more

776
00:28:13,120 --> 00:28:14,880
people

777
00:28:14,880 --> 00:28:18,159
are doing these days okay

778
00:28:18,159 --> 00:28:19,919
so let's work through some of these

779
00:28:19,919 --> 00:28:21,200
examples so

780
00:28:21,200 --> 00:28:23,760
the attacker is using valid accounts to

781
00:28:23,760 --> 00:28:25,440
move laterally around your network so

782
00:28:25,440 --> 00:28:27,120
basically they steal a password for a

783
00:28:27,120 --> 00:28:28,240
valid account

784
00:28:28,240 --> 00:28:30,640
and they jump on another machine yeah it

785
00:28:30,640 --> 00:28:32,159
happens all the time

786
00:28:32,159 --> 00:28:34,799
and how credentials are everywhere

787
00:28:34,799 --> 00:28:36,559
credentials are everywhere there is a

788
00:28:36,559 --> 00:28:36,960
seek

789
00:28:36,960 --> 00:28:38,880
of credentials in your enterprise a lot

790
00:28:38,880 --> 00:28:40,559
of them are ntlm credentials

791
00:28:40,559 --> 00:28:43,279
how good i anti-ntlm credentials they

792
00:28:43,279 --> 00:28:44,000
are only good

793
00:28:44,000 --> 00:28:46,240
for the attackers they are not good for

794
00:28:46,240 --> 00:28:47,120
anything else

795
00:28:47,120 --> 00:28:50,240
can you turn them off often you can't

796
00:28:50,240 --> 00:28:52,080
often you can't you have stuff that only

797
00:28:52,080 --> 00:28:53,440
uses ntlm

798
00:28:53,440 --> 00:28:56,960
so defense against stealing credential

799
00:28:56,960 --> 00:28:58,559
is um

800
00:28:58,559 --> 00:29:01,840
kind of lost for now you have to do some

801
00:29:01,840 --> 00:29:03,600
serious architecture changes to get rid

802
00:29:03,600 --> 00:29:05,679
of some of these credentials yeah

803
00:29:05,679 --> 00:29:07,840
and not even to talk to talk about

804
00:29:07,840 --> 00:29:09,120
credentials in memory

805
00:29:09,120 --> 00:29:11,440
credentials on file systems credentials

806
00:29:11,440 --> 00:29:12,320
in

807
00:29:12,320 --> 00:29:15,200
applications credentials uh and i'm

808
00:29:15,200 --> 00:29:16,880
talking there could be hashes yeah

809
00:29:16,880 --> 00:29:19,200
hashes can be broken you know hashes can

810
00:29:19,200 --> 00:29:19,919
be broken

811
00:29:19,919 --> 00:29:22,960
um you know

812
00:29:22,960 --> 00:29:26,559
if you have a big cluster of gpus

813
00:29:26,559 --> 00:29:29,120
you can you can break any ntlm hash in

814
00:29:29,120 --> 00:29:30,320
how long

815
00:29:30,320 --> 00:29:34,320
how long 10 minutes half an hour

816
00:29:34,320 --> 00:29:36,720
a couple of hours something like that

817
00:29:36,720 --> 00:29:37,520
yeah

818
00:29:37,520 --> 00:29:40,960
anyway um when somebody wants to defend

819
00:29:40,960 --> 00:29:42,480
against valid accounts

820
00:29:42,480 --> 00:29:44,720
you spray your network with decoy

821
00:29:44,720 --> 00:29:45,600
credentials

822
00:29:45,600 --> 00:29:47,520
you spray your network with decoy

823
00:29:47,520 --> 00:29:49,120
credentials

824
00:29:49,120 --> 00:29:51,600
if any of these credentials gets used

825
00:29:51,600 --> 00:29:53,039
what do you think this is

826
00:29:53,039 --> 00:29:55,679
what do you think this is somebody's

827
00:29:55,679 --> 00:29:57,520
digging around your network

828
00:29:57,520 --> 00:30:01,520
uh malicious or insider maybe

829
00:30:01,520 --> 00:30:03,679
um digging around your network for stuff

830
00:30:03,679 --> 00:30:05,120
they should not they should not be

831
00:30:05,120 --> 00:30:06,840
touching

832
00:30:06,840 --> 00:30:09,440
yeah um

833
00:30:09,440 --> 00:30:10,960
permissions group discovery so this is

834
00:30:10,960 --> 00:30:12,480
the same as discovering accounts

835
00:30:12,480 --> 00:30:14,480
you want to know who the domain admins

836
00:30:14,480 --> 00:30:15,679
are

837
00:30:15,679 --> 00:30:17,440
how do you know who domain admins are on

838
00:30:17,440 --> 00:30:19,120
your network

839
00:30:19,120 --> 00:30:20,960
how do you know can anybody on your

840
00:30:20,960 --> 00:30:23,360
network find who are the domain admins

841
00:30:23,360 --> 00:30:24,880
on your network

842
00:30:24,880 --> 00:30:28,399
show hands please anybody

843
00:30:28,399 --> 00:30:31,360
anybody in your network knows who your

844
00:30:31,360 --> 00:30:32,480
domain admins

845
00:30:32,480 --> 00:30:34,960
are full stop active directory cannot

846
00:30:34,960 --> 00:30:36,640
prevent that

847
00:30:36,640 --> 00:30:38,480
active directory cannot prevent

848
00:30:38,480 --> 00:30:40,640
discovery of

849
00:30:40,640 --> 00:30:42,880
any any privileged account in your

850
00:30:42,880 --> 00:30:44,240
network

851
00:30:44,240 --> 00:30:47,039
ask microsoft uh for anything that can

852
00:30:47,039 --> 00:30:48,640
prevent that

853
00:30:48,640 --> 00:30:52,399
i mean you know it's silly but it's true

854
00:30:52,399 --> 00:30:54,960
um how do you do that you use software

855
00:30:54,960 --> 00:30:56,000
manipulation

856
00:30:56,000 --> 00:30:58,880
uh there is a technique that would allow

857
00:30:58,880 --> 00:30:59,200
you

858
00:30:59,200 --> 00:31:02,720
to present decoy responses

859
00:31:02,720 --> 00:31:04,799
to any queries that look for privileged

860
00:31:04,799 --> 00:31:06,320
accounts

861
00:31:06,320 --> 00:31:08,000
and this is what it looks like so this

862
00:31:08,000 --> 00:31:11,120
is what the attackers would do

863
00:31:11,840 --> 00:31:14,960
net group domain admins slash dom

864
00:31:14,960 --> 00:31:17,840
would give you the domain admins how

865
00:31:17,840 --> 00:31:19,679
does the attacker know that this list is

866
00:31:19,679 --> 00:31:21,200
correct

867
00:31:21,200 --> 00:31:24,159
they don't there is a technique called

868
00:31:24,159 --> 00:31:24,799
software

869
00:31:24,799 --> 00:31:27,279
manipulation miter shield calls its

870
00:31:27,279 --> 00:31:28,880
software manipulation

871
00:31:28,880 --> 00:31:32,720
where there is a piece of software

872
00:31:32,720 --> 00:31:35,120
that sits on windows that intercepts the

873
00:31:35,120 --> 00:31:36,640
api calls

874
00:31:36,640 --> 00:31:40,000
and returns returns

875
00:31:40,000 --> 00:31:42,480
response of your choosing of your

876
00:31:42,480 --> 00:31:43,200
choosing

877
00:31:43,200 --> 00:31:46,240
so these accounts over there john adm

878
00:31:46,240 --> 00:31:47,679
malcolm.edm

879
00:31:47,679 --> 00:31:49,600
these are fake accounts these accounts

880
00:31:49,600 --> 00:31:51,440
do not exist

881
00:31:51,440 --> 00:31:53,440
or maybe they exist in the decoy

882
00:31:53,440 --> 00:31:55,600
infrastructure yeah

883
00:31:55,600 --> 00:31:57,519
so you can make them real or you can

884
00:31:57,519 --> 00:31:59,200
make them non-existent

885
00:31:59,200 --> 00:32:01,200
either way you guys either going to get

886
00:32:01,200 --> 00:32:02,880
a failed login

887
00:32:02,880 --> 00:32:05,360
or if it's in a decor infrastructure

888
00:32:05,360 --> 00:32:07,200
you're going to get a successful login

889
00:32:07,200 --> 00:32:09,679
and then you can track the attacker uh

890
00:32:09,679 --> 00:32:11,919
you know to see what they're doing

891
00:32:11,919 --> 00:32:16,000
so moving on cloud service discovery

892
00:32:16,000 --> 00:32:17,760
what did the solarwinds attacker do

893
00:32:17,760 --> 00:32:20,159
they wanted cloud they wanted cloud they

894
00:32:20,159 --> 00:32:21,279
wanted uh

895
00:32:21,279 --> 00:32:24,559
you know email office 365 they wanted

896
00:32:24,559 --> 00:32:26,960
something in azure you know how they're

897
00:32:26,960 --> 00:32:28,320
going to do that they're going to do the

898
00:32:28,320 --> 00:32:29,919
cloud service discovery they're going to

899
00:32:29,919 --> 00:32:30,240
run

900
00:32:30,240 --> 00:32:32,480
scripts to find what cloud resources do

901
00:32:32,480 --> 00:32:34,320
you have

902
00:32:34,320 --> 00:32:36,080
what they're going to find they're going

903
00:32:36,080 --> 00:32:38,399
to find decoy cloud

904
00:32:38,399 --> 00:32:40,880
infrastructure out there they're going

905
00:32:40,880 --> 00:32:41,519
to find

906
00:32:41,519 --> 00:32:44,080
decoy servers they're going to find

907
00:32:44,080 --> 00:32:45,760
decoy databases

908
00:32:45,760 --> 00:32:48,640
serverless functions storage bits

909
00:32:48,640 --> 00:32:50,240
they're going to find lots of stuff

910
00:32:50,240 --> 00:32:51,840
there that is not real

911
00:32:51,840 --> 00:32:57,200
and they're going to get detected

912
00:32:57,200 --> 00:33:00,240
so in summary um this is what the attack

913
00:33:00,240 --> 00:33:02,159
looked like yeah so the attacker first

914
00:33:02,159 --> 00:33:04,640
um got the orion server and then moved

915
00:33:04,640 --> 00:33:05,440
around

916
00:33:05,440 --> 00:33:09,120
got adfs private key saml signing key

917
00:33:09,120 --> 00:33:10,480
got into there

918
00:33:10,480 --> 00:33:12,960
what if some of these boxes or some of

919
00:33:12,960 --> 00:33:15,120
these gray boxes

920
00:33:15,120 --> 00:33:18,240
were not real yeah what if

921
00:33:18,240 --> 00:33:21,840
decoy infrastructure was deployed

922
00:33:21,840 --> 00:33:24,480
on some of these gray boxes over there

923
00:33:24,480 --> 00:33:26,000
how much harder

924
00:33:26,000 --> 00:33:28,720
would it be for any attacker to move

925
00:33:28,720 --> 00:33:30,000
around

926
00:33:30,000 --> 00:33:32,240
and find what they're looking for

927
00:33:32,240 --> 00:33:35,200
without getting detected

928
00:33:35,200 --> 00:33:37,600
i'd say it would be pretty hard pretty

929
00:33:37,600 --> 00:33:39,279
hard

930
00:33:39,279 --> 00:33:42,559
so that's the whole point of of

931
00:33:42,559 --> 00:33:45,360
presenting decoys engaging attackers

932
00:33:45,360 --> 00:33:47,120
instead of passively waiting

933
00:33:47,120 --> 00:33:50,840
for your telemetry to tell you something

934
00:33:50,840 --> 00:33:54,159
um passively waiting for a telemetry to

935
00:33:54,159 --> 00:33:55,120
tell you something

936
00:33:55,120 --> 00:33:59,120
is a valid approach or we all do it

937
00:33:59,120 --> 00:34:02,240
how hard is it it can be hard yeah so

938
00:34:02,240 --> 00:34:04,159
if you look at um this is by the way

939
00:34:04,159 --> 00:34:06,080
this is called golden saml attack this

940
00:34:06,080 --> 00:34:06,640
is what

941
00:34:06,640 --> 00:34:10,079
how the researchers called it there is a

942
00:34:10,079 --> 00:34:12,639
a nice little article published saying

943
00:34:12,639 --> 00:34:13,760
if you correlate

944
00:34:13,760 --> 00:34:17,760
these things you will see this attack

945
00:34:17,760 --> 00:34:20,399
well good luck good luck with this

946
00:34:20,399 --> 00:34:21,520
correlation

947
00:34:21,520 --> 00:34:23,359
good luck having a good luck having a

948
00:34:23,359 --> 00:34:26,719
good data sources first

949
00:34:26,719 --> 00:34:29,280
ingested good luck running good

950
00:34:29,280 --> 00:34:30,960
analytics on it

951
00:34:30,960 --> 00:34:34,000
good luck investigating correlating to

952
00:34:34,000 --> 00:34:34,480
see the

953
00:34:34,480 --> 00:34:36,960
the analytics is working good luck

954
00:34:36,960 --> 00:34:39,359
responding to it

955
00:34:39,359 --> 00:34:41,119
good luck with all of that and i'm sure

956
00:34:41,119 --> 00:34:42,800
some of them are some people are doing

957
00:34:42,800 --> 00:34:43,040
it

958
00:34:43,040 --> 00:34:45,440
out there i'm sure it's a valid approach

959
00:34:45,440 --> 00:34:46,960
but what if

960
00:34:46,960 --> 00:34:49,760
you had three adfs servers and one of

961
00:34:49,760 --> 00:34:51,599
them or two of them were decoys

962
00:34:51,599 --> 00:34:54,879
how easy would that be

963
00:34:55,280 --> 00:34:59,280
to to detect private keys extraction

964
00:34:59,280 --> 00:35:02,320
and responding straight away

965
00:35:02,320 --> 00:35:04,480
it it would work pretty well i'd say and

966
00:35:04,480 --> 00:35:06,079
this is just an illustration uh there

967
00:35:06,079 --> 00:35:06,400
are

968
00:35:06,400 --> 00:35:08,079
lots of other things that that you can

969
00:35:08,079 --> 00:35:09,839
do

970
00:35:09,839 --> 00:35:11,599
so this is what the outcome of your

971
00:35:11,599 --> 00:35:13,520
exercise would be so you you build your

972
00:35:13,520 --> 00:35:14,640
techniques

973
00:35:14,640 --> 00:35:17,280
you build your defenses and you build

974
00:35:17,280 --> 00:35:17,680
your

975
00:35:17,680 --> 00:35:21,359
own matrix your own shield matrix

976
00:35:21,359 --> 00:35:24,560
and you operationalize it you give it to

977
00:35:24,560 --> 00:35:26,960
operational people and say run it tell

978
00:35:26,960 --> 00:35:30,079
me how you're going

979
00:35:30,079 --> 00:35:31,680
and how would you operationalize it

980
00:35:31,680 --> 00:35:33,599
obviously this is probably a topic for a

981
00:35:33,599 --> 00:35:34,960
whole new talk

982
00:35:34,960 --> 00:35:38,079
but for each decoy type

983
00:35:38,079 --> 00:35:39,839
you would decide what kind of decoy you

984
00:35:39,839 --> 00:35:41,920
need and you want

985
00:35:41,920 --> 00:35:44,160
and how much effort you want to put into

986
00:35:44,160 --> 00:35:45,520
it

987
00:35:45,520 --> 00:35:47,440
you then decide on the placement of

988
00:35:47,440 --> 00:35:49,680
these decoys there are various ways you

989
00:35:49,680 --> 00:35:51,040
can place them you can place them on the

990
00:35:51,040 --> 00:35:52,240
point of attack

991
00:35:52,240 --> 00:35:54,640
or you can place them around your assets

992
00:35:54,640 --> 00:35:56,320
they're equally good

993
00:35:56,320 --> 00:35:58,160
strategies or you can put them

994
00:35:58,160 --> 00:36:00,079
everywhere

995
00:36:00,079 --> 00:36:02,079
put them everywhere you know if if it

996
00:36:02,079 --> 00:36:03,359
doesn't cost you anything

997
00:36:03,359 --> 00:36:04,880
just put this decoy everywhere around

998
00:36:04,880 --> 00:36:07,280
your network

999
00:36:07,280 --> 00:36:10,240
and then execute execute um and then

1000
00:36:10,240 --> 00:36:11,119
re-evaluate

1001
00:36:11,119 --> 00:36:12,960
yeah we you know a lot of people out

1002
00:36:12,960 --> 00:36:14,640
there start small

1003
00:36:14,640 --> 00:36:18,000
see the results grow bigger

1004
00:36:18,000 --> 00:36:22,480
and adapt so in summary

1005
00:36:22,480 --> 00:36:25,599
um know your

1006
00:36:25,599 --> 00:36:27,520
adversary yeah know the techniques you

1007
00:36:27,520 --> 00:36:28,880
want to defend against

1008
00:36:28,880 --> 00:36:31,280
uh find your gaps in your existing

1009
00:36:31,280 --> 00:36:32,960
infrastructure

1010
00:36:32,960 --> 00:36:35,920
um and then find what are the gaps do

1011
00:36:35,920 --> 00:36:36,720
the mapping

1012
00:36:36,720 --> 00:36:38,560
do the mapping and you can automate this

1013
00:36:38,560 --> 00:36:39,920
mapping uh might have published

1014
00:36:39,920 --> 00:36:40,960
everything as json

1015
00:36:40,960 --> 00:36:43,280
yeah so you can automate this you can

1016
00:36:43,280 --> 00:36:45,280
make an automated pipeline of

1017
00:36:45,280 --> 00:36:49,839
of building your defenses like that

1018
00:36:49,839 --> 00:36:51,760
and then um collected collect

1019
00:36:51,760 --> 00:36:53,440
intelligence would be a big deal

1020
00:36:53,440 --> 00:36:55,520
yeah so if you want good intelligence

1021
00:36:55,520 --> 00:36:56,880
this would be a really good way to

1022
00:36:56,880 --> 00:36:58,560
collect intelligence

1023
00:36:58,560 --> 00:37:01,920
and then uh contain contain and and

1024
00:37:01,920 --> 00:37:05,040
the outcome is really uh the the biggest

1025
00:37:05,040 --> 00:37:07,040
outcome is accelerating your time to to

1026
00:37:07,040 --> 00:37:09,200
respond and lowering your cost

1027
00:37:09,200 --> 00:37:12,240
yeah lowering your cost of of defense

1028
00:37:12,240 --> 00:37:15,920
by incorporating active defense in your

1029
00:37:15,920 --> 00:37:19,599
enterprise defenses

1030
00:37:20,000 --> 00:37:23,440
thank you uh thank you any any any

1031
00:37:23,440 --> 00:37:24,400
questions i'd

1032
00:37:24,400 --> 00:37:27,040
welcome uh your your feedback and

1033
00:37:27,040 --> 00:37:29,440
questions

1034
00:37:29,760 --> 00:37:33,440
yes yes okay

1035
00:37:34,160 --> 00:37:36,400
so thank you um thank you very much

1036
00:37:36,400 --> 00:37:37,599
valdi um

1037
00:37:37,599 --> 00:37:39,040
we've got a couple of minutes left if

1038
00:37:39,040 --> 00:37:40,800
anybody did have any questions i haven't

1039
00:37:40,800 --> 00:37:41,599
seen anything

1040
00:37:41,599 --> 00:37:45,119
come through the app um but uh yeah

1041
00:37:45,119 --> 00:37:49,200
the floor is open otherwise on behalf of

1042
00:37:49,200 --> 00:37:50,480
us sir thank you very much

1043
00:37:50,480 --> 00:37:52,160
thank you interesting uh introduction

1044
00:37:52,160 --> 00:37:54,000
and uh discussion on how to actually

1045
00:37:54,000 --> 00:37:55,599
make this work in an enterprise

1046
00:37:55,599 --> 00:37:58,720
thanks very much lisa thank um oh

1047
00:37:58,720 --> 00:38:00,960
hold on we do have finally we have a

1048
00:38:00,960 --> 00:38:02,880
question come through

1049
00:38:02,880 --> 00:38:05,119
okay how do you make a decoy visible to

1050
00:38:05,119 --> 00:38:06,640
an attacker

1051
00:38:06,640 --> 00:38:08,880
without also becoming visible and

1052
00:38:08,880 --> 00:38:11,680
therefore usable to legitimate users

1053
00:38:11,680 --> 00:38:13,839
so for example services get published

1054
00:38:13,839 --> 00:38:17,359
via dns which is visible to everybody

1055
00:38:17,359 --> 00:38:20,320
well excellent question uh you you don't

1056
00:38:20,320 --> 00:38:21,680
want to make your

1057
00:38:21,680 --> 00:38:24,720
decoys visible to your

1058
00:38:24,720 --> 00:38:28,240
users yeah so you want to

1059
00:38:28,240 --> 00:38:31,520
deploy decoys in a channel that is

1060
00:38:31,520 --> 00:38:32,079
outside

1061
00:38:32,079 --> 00:38:34,720
of standard workflows for your for your

1062
00:38:34,720 --> 00:38:35,599
production

1063
00:38:35,599 --> 00:38:39,599
yeah so um for example

1064
00:38:39,599 --> 00:38:42,320
um a great example is alsace secrets

1065
00:38:42,320 --> 00:38:43,359
yeah

1066
00:38:43,359 --> 00:38:45,440
elsa's secrets are not part of any

1067
00:38:45,440 --> 00:38:47,359
workflow yeah

1068
00:38:47,359 --> 00:38:49,680
this is a pretty safe place to put

1069
00:38:49,680 --> 00:38:50,480
decoys

1070
00:38:50,480 --> 00:38:53,599
yeah that's one example second example

1071
00:38:53,599 --> 00:38:57,280
is you

1072
00:38:57,280 --> 00:38:59,599
you block a number of ips in your

1073
00:38:59,599 --> 00:39:00,720
network

1074
00:39:00,720 --> 00:39:04,320
uh you populate them with decoys

1075
00:39:04,320 --> 00:39:06,560
and you hide these ips from your

1076
00:39:06,560 --> 00:39:09,040
legitimate network management tools

1077
00:39:09,040 --> 00:39:12,320
yeah any vulnerability scanners out

1078
00:39:12,320 --> 00:39:13,440
there

1079
00:39:13,440 --> 00:39:16,800
will not see these ips if somebody tries

1080
00:39:16,800 --> 00:39:17,520
to ping this

1081
00:39:17,520 --> 00:39:20,800
ip from a legitimate

1082
00:39:20,800 --> 00:39:22,320
vulnerability scanner they won't get a

1083
00:39:22,320 --> 00:39:24,720
response but if somebody is scanning the

1084
00:39:24,720 --> 00:39:26,480
network

1085
00:39:26,480 --> 00:39:29,599
you know they will be there

1086
00:39:29,599 --> 00:39:32,320
uh also we are not advocating that you

1087
00:39:32,320 --> 00:39:33,200
incorporate

1088
00:39:33,200 --> 00:39:35,280
decoy content with your production

1089
00:39:35,280 --> 00:39:36,560
infrastructure for example

1090
00:39:36,560 --> 00:39:38,560
there is a school of thought there that

1091
00:39:38,560 --> 00:39:40,160
in your production id

1092
00:39:40,160 --> 00:39:42,800
you should have some decoy accounts yeah

1093
00:39:42,800 --> 00:39:44,880
that is possible

1094
00:39:44,880 --> 00:39:47,520
but kind of difficult to manage your ad

1095
00:39:47,520 --> 00:39:48,880
administrators would have to

1096
00:39:48,880 --> 00:39:50,560
understand that these are not real and

1097
00:39:50,560 --> 00:39:52,560
so on what we advocate is

1098
00:39:52,560 --> 00:39:55,839
build another ad yeah build another id

1099
00:39:55,839 --> 00:39:56,320
call it

1100
00:39:56,320 --> 00:39:59,280
uh call it a test call it the qa2 call

1101
00:39:59,280 --> 00:40:00,400
it uh

1102
00:40:00,400 --> 00:40:03,520
something interesting but uh

1103
00:40:03,520 --> 00:40:05,200
nobody they will be they'll have no

1104
00:40:05,200 --> 00:40:07,359
production use yeah so essentially

1105
00:40:07,359 --> 00:40:10,800
you build production you you build a

1106
00:40:10,800 --> 00:40:12,720
decoy copy of a production

1107
00:40:12,720 --> 00:40:13,920
infrastructure

1108
00:40:13,920 --> 00:40:16,400
so you have parallel infrastructures and

1109
00:40:16,400 --> 00:40:17,680
then you divert

1110
00:40:17,680 --> 00:40:20,000
attackers from the real infrastructure

1111
00:40:20,000 --> 00:40:21,920
into the decoy infrastructure

1112
00:40:21,920 --> 00:40:24,800
by using elsa's credentials by using

1113
00:40:24,800 --> 00:40:26,319
hidden lures

1114
00:40:26,319 --> 00:40:28,720
by using a partial script with clear

1115
00:40:28,720 --> 00:40:29,680
text credential

1116
00:40:29,680 --> 00:40:33,040
in a file system yeah for example

1117
00:40:33,040 --> 00:40:36,000
how many of your standard users would be

1118
00:40:36,000 --> 00:40:38,160
digging through the file system

1119
00:40:38,160 --> 00:40:40,720
looking for powershell scripts how many

1120
00:40:40,720 --> 00:40:41,760
of them would do that

1121
00:40:41,760 --> 00:40:44,319
yeah so that it is not a part of any

1122
00:40:44,319 --> 00:40:45,520
production workflow

1123
00:40:45,520 --> 00:40:47,280
yeah so basically you look for

1124
00:40:47,280 --> 00:40:49,200
non-production workflows where you put

1125
00:40:49,200 --> 00:40:50,240
your lures

1126
00:40:50,240 --> 00:40:52,160
your standard users will not see them

1127
00:40:52,160 --> 00:40:53,920
the attackers will definitely look for

1128
00:40:53,920 --> 00:40:54,240
them

1129
00:40:54,240 --> 00:40:56,480
yeah so that that is the answer so put

1130
00:40:56,480 --> 00:40:58,319
everything in plain sight but not in a

1131
00:40:58,319 --> 00:40:58,960
place that

1132
00:40:58,960 --> 00:41:00,560
is either directly linked to or

1133
00:41:00,560 --> 00:41:02,640
referenced but is completely open and

1134
00:41:02,640 --> 00:41:03,440
discoverable

1135
00:41:03,440 --> 00:41:06,960
thank you thank you very much lotto

1136
00:41:06,960 --> 00:41:08,480
we'll be uh back in a couple of minutes

1137
00:41:08,480 --> 00:41:21,839
with the mike and leon show

1138
00:41:34,640 --> 00:41:37,440
you are

