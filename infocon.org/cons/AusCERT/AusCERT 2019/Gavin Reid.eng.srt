1
00:00:00,149 --> 00:00:05,069
this presentation as I say is by Gavin

2
00:00:02,879 --> 00:00:07,048
Reid he's the chief security architect

3
00:00:05,069 --> 00:00:09,690
and head of threat research at recorded

4
00:00:07,049 --> 00:00:19,109
future I will pass over to Gavin thank

5
00:00:09,690 --> 00:00:21,930
you thank you hey everyone thanks for

6
00:00:19,109 --> 00:00:27,810
coming especially right after lunch good

7
00:00:21,930 --> 00:00:31,259
to see a really full crowd see if my

8
00:00:27,810 --> 00:00:33,329
fingle work now aha there we go so yeah

9
00:00:31,260 --> 00:00:36,300
my name is Gavin Reid I work at recorded

10
00:00:33,329 --> 00:00:38,910
future I lead their threat research

11
00:00:36,300 --> 00:00:41,160
group which is largely made up of sort

12
00:00:38,910 --> 00:00:43,349
of two groups one group does research

13
00:00:41,160 --> 00:00:46,709
into nation-state attacks to threat

14
00:00:43,350 --> 00:00:49,170
actors to criminals to people and the

15
00:00:46,710 --> 00:00:52,350
other group does more of the cyber

16
00:00:49,170 --> 00:00:54,300
indicators the IO sees the zeros and

17
00:00:52,350 --> 00:00:57,420
ones and that sort of thing

18
00:00:54,300 --> 00:00:59,519
so I've worked there for a couple of

19
00:00:57,420 --> 00:01:02,489
years in previous to that I worked for

20
00:00:59,520 --> 00:01:05,189
15 years at Cisco Systems where I

21
00:01:02,489 --> 00:01:07,200
created and led their computer security

22
00:01:05,188 --> 00:01:09,059
incident response team so I've done a

23
00:01:07,200 --> 00:01:11,280
lot sort of on both side on the

24
00:01:09,060 --> 00:01:13,200
protector side and and of course the

25
00:01:11,280 --> 00:01:16,080
research into what we need to do to

26
00:01:13,200 --> 00:01:18,689
protect what recording future does is it

27
00:01:16,080 --> 00:01:20,729
pulls together indicators it pulls

28
00:01:18,689 --> 00:01:22,889
together techniques it pulls together

29
00:01:20,729 --> 00:01:25,560
the infrastructure that the hackers are

30
00:01:22,890 --> 00:01:28,439
using so we can use that against them

31
00:01:25,560 --> 00:01:30,720
right the hackers are lazy they're gonna

32
00:01:28,439 --> 00:01:32,008
use the same stuff over and over again

33
00:01:30,720 --> 00:01:33,929
they're going to use the same malware

34
00:01:32,009 --> 00:01:36,720
the same exploit pack the same

35
00:01:33,930 --> 00:01:40,049
commanding control over and over again

36
00:01:36,720 --> 00:01:42,298
if it works so you want to take those

37
00:01:40,049 --> 00:01:43,680
things you want to summarize them and

38
00:01:42,299 --> 00:01:46,170
you want to pay attention to them and

39
00:01:43,680 --> 00:01:48,840
use them and that's a lot about what my

40
00:01:46,170 --> 00:01:51,509
team does now I'm gonna go into a little

41
00:01:48,840 --> 00:01:54,270
bit of a deep detail of one particular

42
00:01:51,509 --> 00:01:56,340
incident of how we do that today sort of

43
00:01:54,270 --> 00:01:58,320
taking it all the way from how we find

44
00:01:56,340 --> 00:02:00,509
the stuff what we do with it and then

45
00:01:58,320 --> 00:02:03,210
what a cert team does but understand

46
00:02:00,509 --> 00:02:05,100
this isn't the only way we do it we

47
00:02:03,210 --> 00:02:07,140
either second um you know we're looking

48
00:02:05,100 --> 00:02:09,568
for you know open know distribute

49
00:02:07,140 --> 00:02:11,790
servers we're looking for ways to you

50
00:02:09,568 --> 00:02:13,200
know pull malware we're doing all kinds

51
00:02:11,790 --> 00:02:16,019
of stuff like

52
00:02:13,200 --> 00:02:18,810
our tool for example looks through

53
00:02:16,020 --> 00:02:21,690
github z' for references you know we can

54
00:02:18,810 --> 00:02:24,150
search if someone's put some code up on

55
00:02:21,690 --> 00:02:26,099
a git site that's inappropriate we can

56
00:02:24,150 --> 00:02:27,930
get alerting on that so we thought well

57
00:02:26,099 --> 00:02:30,420
if we're looking through all these get

58
00:02:27,930 --> 00:02:33,060
sites and you know all not just you know

59
00:02:30,420 --> 00:02:35,790
in in the Western world but you know all

60
00:02:33,060 --> 00:02:38,940
over different languages let's start

61
00:02:35,790 --> 00:02:41,160
looking at files that potentially get

62
00:02:38,940 --> 00:02:42,900
distributed through through github so we

63
00:02:41,160 --> 00:02:45,260
found that they were a bunch of files

64
00:02:42,900 --> 00:02:48,030
that were being you know just you know

65
00:02:45,260 --> 00:02:49,560
stuck up on github and we were thinking

66
00:02:48,030 --> 00:02:52,110
well people that's there probably

67
00:02:49,560 --> 00:02:54,840
malware right and so we we got the files

68
00:02:52,110 --> 00:02:56,730
we compiled them we found that mostly

69
00:02:54,840 --> 00:02:57,930
they weren't malware at all but then we

70
00:02:56,730 --> 00:03:00,929
started looking into it a little bit

71
00:02:57,930 --> 00:03:04,260
more deeper and we found that if the

72
00:03:00,930 --> 00:03:08,730
file was G G zipped and base64 encoded

73
00:03:04,260 --> 00:03:11,548
and then put up on to github 99.9% times

74
00:03:08,730 --> 00:03:14,399
it was malware so and and that sort of

75
00:03:11,549 --> 00:03:16,230
malware is the sort of bad guy staging

76
00:03:14,400 --> 00:03:18,060
stuff for an attack that he's going to

77
00:03:16,230 --> 00:03:19,619
do two or three weeks down the road so

78
00:03:18,060 --> 00:03:21,690
really really interesting source of data

79
00:03:19,620 --> 00:03:24,450
so I'm gonna talk a little bit about one

80
00:03:21,690 --> 00:03:26,040
source of data today but understand we

81
00:03:24,450 --> 00:03:29,399
do all kinds of stuff this is just one

82
00:03:26,040 --> 00:03:30,989
example first off we're going to talk

83
00:03:29,400 --> 00:03:32,970
about some hackers and I want you to

84
00:03:30,989 --> 00:03:37,140
know no hackers were hurt in the making

85
00:03:32,970 --> 00:03:40,500
of this presentation we do from time to

86
00:03:37,140 --> 00:03:41,880
time out hackers we talk about you know

87
00:03:40,500 --> 00:03:44,060
who they are we share with law

88
00:03:41,880 --> 00:03:46,739
enforcement you know what they've done

89
00:03:44,060 --> 00:03:49,500
if you're interested and one that we did

90
00:03:46,739 --> 00:03:52,230
this year Google recorded future and

91
00:03:49,500 --> 00:03:54,630
Tessa 88 you can see an example of one

92
00:03:52,230 --> 00:03:56,700
we've done a lot of work with stuff

93
00:03:54,630 --> 00:04:01,170
that's sort of pending litigation the

94
00:03:56,700 --> 00:04:04,560
dark overlord this wall so no hackers

95
00:04:01,170 --> 00:04:06,480
were hurt this isn't a real hacker it it

96
00:04:04,560 --> 00:04:08,069
is all of the screenshots and everything

97
00:04:06,480 --> 00:04:10,798
we're going to show is a real hacker

98
00:04:08,069 --> 00:04:12,839
it's just not this guy right it's not

99
00:04:10,799 --> 00:04:14,450
big zero dot I made that up

100
00:04:12,840 --> 00:04:17,910
this isn't someone that we're going to

101
00:04:14,450 --> 00:04:20,849
try and prosecute he's an example this

102
00:04:17,910 --> 00:04:23,640
hacker is interesting in that he has

103
00:04:20,850 --> 00:04:25,750
been in the business so you can see for

104
00:04:23,640 --> 00:04:30,400
about seven years right along

105
00:04:25,750 --> 00:04:32,530
time being zero dot in any also he does

106
00:04:30,400 --> 00:04:34,450
actual hacking so many of the threat

107
00:04:32,530 --> 00:04:36,309
actors the threat actor groups they

108
00:04:34,450 --> 00:04:39,340
don't really do any hacking all they do

109
00:04:36,310 --> 00:04:41,230
is they buy like credit credit cards or

110
00:04:39,340 --> 00:04:43,030
they buy data dumps and they resell them

111
00:04:41,230 --> 00:04:44,470
if you have no idea how to hack they

112
00:04:43,030 --> 00:04:50,080
don't really understand anything about

113
00:04:44,470 --> 00:04:52,030
computers this guy's different so a lot

114
00:04:50,080 --> 00:04:55,090
of what I'm going to be showing you

115
00:04:52,030 --> 00:04:56,890
today comes from what is sort of loosely

116
00:04:55,090 --> 00:04:58,960
known as the deep dark web or the

117
00:04:56,890 --> 00:05:03,780
criminal underground and I'll tell you

118
00:04:58,960 --> 00:05:06,909
I've seen this particular graphic

119
00:05:03,780 --> 00:05:08,979
presented upside down by folks who ought

120
00:05:06,910 --> 00:05:11,530
to know better with the concept being

121
00:05:08,980 --> 00:05:14,110
that you know the clear web is this tiny

122
00:05:11,530 --> 00:05:17,140
little peak of the iceberg and the dark

123
00:05:14,110 --> 00:05:19,870
web is this like mysterious big

124
00:05:17,140 --> 00:05:23,740
amorphous area that's complete BS in

125
00:05:19,870 --> 00:05:25,750
fact what we found is clear web really

126
00:05:23,740 --> 00:05:27,910
really big and the dark webs kind of

127
00:05:25,750 --> 00:05:31,120
small so a lot of what we're talking

128
00:05:27,910 --> 00:05:34,240
about here today comes from sites that

129
00:05:31,120 --> 00:05:36,729
are on the clear web but you need very

130
00:05:34,240 --> 00:05:38,620
specialized permissions in order to get

131
00:05:36,729 --> 00:05:43,030
access to it so you have to have other

132
00:05:38,620 --> 00:05:44,950
bad criminals that will take you know

133
00:05:43,030 --> 00:05:47,500
vouch for you and say you're a good you

134
00:05:44,950 --> 00:05:50,979
know a good person or a bad person you

135
00:05:47,500 --> 00:05:53,380
have to participate in in a certain

136
00:05:50,979 --> 00:05:54,130
manner on these forums or you'll get

137
00:05:53,380 --> 00:05:56,290
kicked out

138
00:05:54,130 --> 00:05:58,000
you have to know Russian slang really

139
00:05:56,290 --> 00:06:00,729
really well or you're gonna get kicked

140
00:05:58,000 --> 00:06:02,830
out and we pull information you know

141
00:06:00,729 --> 00:06:05,800
both from these what's known as the dark

142
00:06:02,830 --> 00:06:08,080
web that dot onion and you know tort

143
00:06:05,800 --> 00:06:09,940
protected sites and some of these clear

144
00:06:08,080 --> 00:06:13,000
web sites where you need you know

145
00:06:09,940 --> 00:06:16,660
specialized access to get on there and

146
00:06:13,000 --> 00:06:19,300
in some sites we you know get where

147
00:06:16,660 --> 00:06:21,100
you'll set up a persona all we have to

148
00:06:19,300 --> 00:06:23,260
do is you know kind of you know get a

149
00:06:21,100 --> 00:06:25,030
you know a user account on there we can

150
00:06:23,260 --> 00:06:26,950
start pulling information directly from

151
00:06:25,030 --> 00:06:28,960
this forum that we can use to sort of

152
00:06:26,950 --> 00:06:31,780
spy on what the hackers are doing and

153
00:06:28,960 --> 00:06:33,280
then there's other ones on the you know

154
00:06:31,780 --> 00:06:36,099
where the admins are really paying

155
00:06:33,280 --> 00:06:38,609
attention where we have to you know you

156
00:06:36,099 --> 00:06:40,770
know get a persona and then that persona

157
00:06:38,610 --> 00:06:42,689
to do nothing for a while and then he

158
00:06:40,770 --> 00:06:45,960
has to just sort of read messages like

159
00:06:42,689 --> 00:06:47,550
an individual human regret it and and

160
00:06:45,960 --> 00:06:51,090
then stop and he's got to be doing it

161
00:06:47,550 --> 00:06:53,669
during the sort of normal day time or

162
00:06:51,090 --> 00:06:54,900
you know user hours of the country that

163
00:06:53,669 --> 00:06:57,270
he's meant to be coming from and he has

164
00:06:54,900 --> 00:07:01,438
to originate from the country that this

165
00:06:57,270 --> 00:07:03,960
forum is serving and then you know so

166
00:07:01,439 --> 00:07:06,180
like on one side if we can just sort of

167
00:07:03,960 --> 00:07:09,090
you know get bulk access it's spider the

168
00:07:06,180 --> 00:07:10,949
the server the admin doesn't care we can

169
00:07:09,090 --> 00:07:14,188
bring that into our tool all in you know

170
00:07:10,949 --> 00:07:16,650
period of days some of the higher value

171
00:07:14,189 --> 00:07:17,939
sites takes us six months because we

172
00:07:16,650 --> 00:07:19,710
have to do it really slowly you have to

173
00:07:17,939 --> 00:07:21,090
do it and we have to stop we have to do

174
00:07:19,710 --> 00:07:23,969
nothing for a couple days because we

175
00:07:21,090 --> 00:07:25,830
have to sort of look like a normal user

176
00:07:23,969 --> 00:07:29,430
so that's a lot of what my team does and

177
00:07:25,830 --> 00:07:31,229
and again dark web ain't that big so we

178
00:07:29,430 --> 00:07:33,689
look at links we follow a lot of links

179
00:07:31,229 --> 00:07:35,849
the way that we find things these are

180
00:07:33,689 --> 00:07:38,159
links that we followed just in a 24 hour

181
00:07:35,849 --> 00:07:40,370
period inside of our product and you can

182
00:07:38,159 --> 00:07:44,669
see the clear web there were millions

183
00:07:40,370 --> 00:07:46,409
the dark web thousands ones we care

184
00:07:44,669 --> 00:07:49,859
about about nine

185
00:07:46,409 --> 00:07:52,349
so again if people tell you this deep

186
00:07:49,860 --> 00:07:55,289
dark huge web complete nonsense

187
00:07:52,349 --> 00:07:59,159
so the hacker that we're looking at

188
00:07:55,289 --> 00:08:02,460
today this big zero dot he actually has

189
00:07:59,159 --> 00:08:05,159
some form he's known to both sell and

190
00:08:02,460 --> 00:08:06,960
create exploit kits that's not easy to

191
00:08:05,159 --> 00:08:09,180
do that's pretty hard there's a lot of

192
00:08:06,960 --> 00:08:11,729
people that get exploit kits and sell

193
00:08:09,180 --> 00:08:14,669
malware but he actually has created ones

194
00:08:11,729 --> 00:08:17,128
in the past and you can see with a huge

195
00:08:14,669 --> 00:08:19,529
amount of confidence we know that this

196
00:08:17,129 --> 00:08:23,839
guy is what Stanley Maccoby face or

197
00:08:19,529 --> 00:08:26,520
something who resides in st. Petersburg

198
00:08:23,839 --> 00:08:29,400
so how does a threat actor get into our

199
00:08:26,520 --> 00:08:35,159
focus so you can see this is a period of

200
00:08:29,400 --> 00:08:37,380
from 2013 all the way to the beginning

201
00:08:35,159 --> 00:08:39,838
of this year each one of those little

202
00:08:37,380 --> 00:08:42,120
dots is references to this particular

203
00:08:39,839 --> 00:08:43,589
hacker either being talked about or

204
00:08:42,120 --> 00:08:47,940
doing stuff in the criminal underground

205
00:08:43,589 --> 00:08:50,790
so he's got a lot of activity so that

206
00:08:47,940 --> 00:08:51,810
alone would make us think hey this guy

207
00:08:50,790 --> 00:08:54,329
might be doing

208
00:08:51,810 --> 00:08:58,920
stuff that our customers could be

209
00:08:54,330 --> 00:09:00,480
interested in here's the very so what

210
00:08:58,920 --> 00:09:01,770
yeah what do you know these little

211
00:09:00,480 --> 00:09:04,950
reference things what do they look like

212
00:09:01,770 --> 00:09:07,620
here's his first post on a criminal

213
00:09:04,950 --> 00:09:08,190
forum and you can see he's talking about

214
00:09:07,620 --> 00:09:10,740
himself

215
00:09:08,190 --> 00:09:12,330
and he's got his ICQ number right so

216
00:09:10,740 --> 00:09:15,000
that's the first pivot point for us

217
00:09:12,330 --> 00:09:17,730
we've got some thing to like link him to

218
00:09:15,000 --> 00:09:19,710
two other things so good here's another

219
00:09:17,730 --> 00:09:21,839
one of those posts here's he's actually

220
00:09:19,710 --> 00:09:23,279
he's advertising a cash out service

221
00:09:21,839 --> 00:09:25,170
through betting sites so what you do

222
00:09:23,279 --> 00:09:27,930
there if you have some money that you've

223
00:09:25,170 --> 00:09:30,120
gotten illegally like you've got credit

224
00:09:27,930 --> 00:09:33,000
cards or maybe someone's PayPal account

225
00:09:30,120 --> 00:09:35,339
you can transfer that over to him he'll

226
00:09:33,000 --> 00:09:38,160
invest this in a gambling site then you

227
00:09:35,339 --> 00:09:39,540
can gamble and if you win you can take

228
00:09:38,160 --> 00:09:41,610
that money and actually deposit it

229
00:09:39,540 --> 00:09:42,959
hopefully a little washed from how you

230
00:09:41,610 --> 00:09:46,260
originally got it so he's out

231
00:09:42,960 --> 00:09:49,050
advertising the service back in 2015 so

232
00:09:46,260 --> 00:09:52,730
this guy he he does like many of the

233
00:09:49,050 --> 00:09:55,349
threat actors a little bit of everything

234
00:09:52,730 --> 00:09:58,740
here's another one where he's sowing

235
00:09:55,350 --> 00:10:00,650
Austrian bank credit cards right this

236
00:09:58,740 --> 00:10:03,750
one's good because we've got a telegram

237
00:10:00,650 --> 00:10:06,030
account right so now we've got you know

238
00:10:03,750 --> 00:10:09,660
I CQ let me see do we have anything else

239
00:10:06,030 --> 00:10:13,140
on this one yes we've got his two email

240
00:10:09,660 --> 00:10:14,699
accounts so you may got ICQ we got

241
00:10:13,140 --> 00:10:18,449
telegram we've got us two email accounts

242
00:10:14,700 --> 00:10:20,100
and you may think you may say why don't

243
00:10:18,450 --> 00:10:22,530
these hackers just set up a new email

244
00:10:20,100 --> 00:10:24,780
every time they advertise something

245
00:10:22,530 --> 00:10:27,480
wouldn't that be good OPSEC right be

246
00:10:24,780 --> 00:10:27,870
hard for us to track and and it would be

247
00:10:27,480 --> 00:10:29,970
good

248
00:10:27,870 --> 00:10:32,670
OPSEC it would be hard for us to track

249
00:10:29,970 --> 00:10:35,190
but they don't because what happens is

250
00:10:32,670 --> 00:10:37,140
over time like this guy now has been in

251
00:10:35,190 --> 00:10:40,470
the business you know for seven years

252
00:10:37,140 --> 00:10:42,930
and it's all relating back to this

253
00:10:40,470 --> 00:10:46,410
telegram account to these two to the

254
00:10:42,930 --> 00:10:48,180
previous two emails to his ICQ number so

255
00:10:46,410 --> 00:10:50,339
he has a repeat business that's based

256
00:10:48,180 --> 00:10:52,920
directly off of those emails and as he

257
00:10:50,339 --> 00:10:55,140
builds a reputation in the criminal

258
00:10:52,920 --> 00:10:57,839
underground people associate that with

259
00:10:55,140 --> 00:11:00,900
him now he could go on a forum and say

260
00:10:57,839 --> 00:11:02,740
hey guys I've changed my email I'm big

261
00:11:00,900 --> 00:11:04,959
zero dot I'm no longer this I

262
00:11:02,740 --> 00:11:06,399
that but half the people wouldn't

263
00:11:04,959 --> 00:11:07,930
believe them half the people would think

264
00:11:06,399 --> 00:11:10,480
his accounts been taken over

265
00:11:07,930 --> 00:11:12,270
so his reputation his ability to make

266
00:11:10,480 --> 00:11:14,770
money in the criminal underground is

267
00:11:12,270 --> 00:11:17,050
intrinsically linked to these accounts

268
00:11:14,770 --> 00:11:20,140
so we see them showing up again and

269
00:11:17,050 --> 00:11:23,109
again and again so in this particular

270
00:11:20,140 --> 00:11:26,050
case where he came into focus

271
00:11:23,110 --> 00:11:28,750
is we had a customer who got hit either

272
00:11:26,050 --> 00:11:31,959
by him or one of the bits of malware

273
00:11:28,750 --> 00:11:34,480
that he was selling so they reached out

274
00:11:31,959 --> 00:11:36,760
to us and said hey can you give us more

275
00:11:34,480 --> 00:11:38,860
information we can't detect it we don't

276
00:11:36,760 --> 00:11:40,720
know where it comes from but we've

277
00:11:38,860 --> 00:11:42,670
actually seen and we think that we've

278
00:11:40,720 --> 00:11:46,300
linked it to this particular criminal

279
00:11:42,670 --> 00:11:48,160
actor and you can see here March 25th

280
00:11:46,300 --> 00:11:50,800
he was selling on a bunch of different

281
00:11:48,160 --> 00:11:52,660
forums it was basically a two-part

282
00:11:50,800 --> 00:11:55,000
malware thing the first one was a

283
00:11:52,660 --> 00:11:57,790
downloader which basically it was an

284
00:11:55,000 --> 00:12:00,310
inject that went into a word doc a PDF a

285
00:11:57,790 --> 00:12:02,079
zip file or our file and what that would

286
00:12:00,310 --> 00:12:04,060
do is it would reach out and it would

287
00:12:02,080 --> 00:12:06,160
download a remote access tool kit so it

288
00:12:04,060 --> 00:12:08,770
was a tool part thing here we're showing

289
00:12:06,160 --> 00:12:12,490
the first part being sold and it's

290
00:12:08,770 --> 00:12:16,260
pretty cheap right 15 bucks $20 pretty

291
00:12:12,490 --> 00:12:19,529
inexpensive you can buy the lifetime

292
00:12:16,260 --> 00:12:22,720
exploits thing to make it for a thousand

293
00:12:19,529 --> 00:12:25,390
here's one of the forums that he's

294
00:12:22,720 --> 00:12:29,230
posting on you can see he's telling you

295
00:12:25,390 --> 00:12:32,410
0 detects 0 out of 33 these are where

296
00:12:29,230 --> 00:12:35,410
he's taking it to a know distribute my

297
00:12:32,410 --> 00:12:37,600
antivirus site or sorry virus site to

298
00:12:35,410 --> 00:12:40,390
test his malware to see if any of the

299
00:12:37,600 --> 00:12:42,640
normal virus software can detect it

300
00:12:40,390 --> 00:12:44,890
these know distribute sites are run by

301
00:12:42,640 --> 00:12:46,899
the criminal underground and they test

302
00:12:44,890 --> 00:12:48,699
malware's you can use them for proofs

303
00:12:46,899 --> 00:12:50,829
but they don't send any of the

304
00:12:48,700 --> 00:12:52,959
information back to the semantics of the

305
00:12:50,829 --> 00:12:55,270
world to the McAfee's of the world they

306
00:12:52,959 --> 00:12:58,719
keep it all in-house it's almost like a

307
00:12:55,270 --> 00:13:00,130
bonafide here is how you know that what

308
00:12:58,720 --> 00:13:03,640
I'm selling you is going to be

309
00:13:00,130 --> 00:13:06,760
successful for this particular 15 dollar

310
00:13:03,640 --> 00:13:09,339
exploit you don't have to click on

311
00:13:06,760 --> 00:13:11,380
anything after you open the word doc you

312
00:13:09,339 --> 00:13:13,510
don't have to you know click on

313
00:13:11,380 --> 00:13:15,040
something or enable anything you just

314
00:13:13,510 --> 00:13:16,370
have to open it you just have to open

315
00:13:15,040 --> 00:13:19,380
the PDF

316
00:13:16,370 --> 00:13:21,540
here's that same thing for sale and

317
00:13:19,380 --> 00:13:23,370
another one of the high-level forums and

318
00:13:21,540 --> 00:13:25,740
you can see in this one I think it's a

319
00:13:23,370 --> 00:13:28,050
little little yeah a little bit more

320
00:13:25,740 --> 00:13:30,270
expensive anyway and you can see again

321
00:13:28,050 --> 00:13:33,529
it's the same even though I've learned

322
00:13:30,270 --> 00:13:37,350
it all out same telegram account the

323
00:13:33,529 --> 00:13:42,660
same email account that he'd used back

324
00:13:37,350 --> 00:13:44,820
in 2012 so the first thing we do we know

325
00:13:42,660 --> 00:13:47,100
we want to try and get this particular

326
00:13:44,820 --> 00:13:49,770
bit of malware check it out so we

327
00:13:47,100 --> 00:13:52,529
contact the hacker and you can see here

328
00:13:49,770 --> 00:13:56,730
we say hey hey bro interested in your

329
00:13:52,529 --> 00:13:58,860
sploit you know you want to sell so

330
00:13:56,730 --> 00:14:01,110
we're establishing a rapport with the

331
00:13:58,860 --> 00:14:03,029
hacker here and then you know we're

332
00:14:01,110 --> 00:14:04,890
asking about this detection any proofs

333
00:14:03,029 --> 00:14:07,200
they're written in in Python and of

334
00:14:04,890 --> 00:14:08,699
course what does he do he ignores us and

335
00:14:07,200 --> 00:14:10,680
doesn't respond but you know we keep

336
00:14:08,700 --> 00:14:14,399
bugging him and then eventually he does

337
00:14:10,680 --> 00:14:17,750
he sends us proof linking to one of

338
00:14:14,399 --> 00:14:22,980
these hacker non distribute AV sites

339
00:14:17,750 --> 00:14:25,950
saying that you can see here 0 out of 20

340
00:14:22,980 --> 00:14:29,490
so 20 different virus scanners hit it no

341
00:14:25,950 --> 00:14:30,420
one found it so what do we have to do

342
00:14:29,490 --> 00:14:36,660
next

343
00:14:30,420 --> 00:14:39,689
any guesses I look I'm looking at a sea

344
00:14:36,660 --> 00:14:43,319
of Gabon and we've got to get some

345
00:14:39,690 --> 00:14:46,440
Bitcoin right Bitcoin is the currency of

346
00:14:43,320 --> 00:14:48,300
the criminal underground so you know we

347
00:14:46,440 --> 00:14:49,980
obviously you know use quite a bit of

348
00:14:48,300 --> 00:14:54,140
Bitcoin we do a lot of direct threat

349
00:14:49,980 --> 00:14:57,180
actor engagement but when we use Bitcoin

350
00:14:54,140 --> 00:14:59,220
we don't want it to get traced back to

351
00:14:57,180 --> 00:15:00,900
us for obvious reasons right I don't

352
00:14:59,220 --> 00:15:04,980
want you know these guys coming to my

353
00:15:00,900 --> 00:15:07,230
house and visiting me so we use just

354
00:15:04,980 --> 00:15:09,420
like the criminals use we mix it up with

355
00:15:07,230 --> 00:15:11,910
the Bitcoin mixer so if you're not and

356
00:15:09,420 --> 00:15:13,110
in fact we use multiple Bitcoin mixers

357
00:15:11,910 --> 00:15:15,719
but if you're not familiar with what a

358
00:15:13,110 --> 00:15:18,000
coin mixer is is it'll take our little

359
00:15:15,720 --> 00:15:19,920
twenty dollar transaction and it'll

360
00:15:18,000 --> 00:15:21,690
blend it in with like 50 other

361
00:15:19,920 --> 00:15:22,949
transactions so it'll take like two

362
00:15:21,690 --> 00:15:24,720
dollars from our twenty dollar

363
00:15:22,950 --> 00:15:26,700
transaction and mix it with eight

364
00:15:24,720 --> 00:15:28,140
dollars from someone else's and four

365
00:15:26,700 --> 00:15:29,529
dollars from someone else's and that

366
00:15:28,140 --> 00:15:31,300
sends it from wallet

367
00:15:29,529 --> 00:15:33,850
wallet and it makes as it pulls it apart

368
00:15:31,300 --> 00:15:36,389
mixes it and pulls it apart mixes it and

369
00:15:33,850 --> 00:15:39,310
pulls it apart until eventually it's

370
00:15:36,389 --> 00:15:40,899
extremely you can ask some of your

371
00:15:39,310 --> 00:15:43,060
friends in law enforcement that are pry

372
00:15:40,899 --> 00:15:45,459
in this room makes it very hard to trace

373
00:15:43,060 --> 00:15:47,410
people think bitcoin is anonymous it

374
00:15:45,459 --> 00:15:50,290
doesn't not anonymous it's like easy

375
00:15:47,410 --> 00:15:52,269
super easy to trace but if you use an in

376
00:15:50,290 --> 00:15:53,559
our case we'll go to something like coin

377
00:15:52,269 --> 00:15:56,350
base which is a place where you can just

378
00:15:53,559 --> 00:15:58,980
buy Bitcoin in America and then we'll

379
00:15:56,350 --> 00:16:01,809
send it through a number of these mixers

380
00:15:58,980 --> 00:16:03,459
and until we get to the point where

381
00:16:01,809 --> 00:16:05,769
we're actually going to send it to the

382
00:16:03,459 --> 00:16:07,540
hacker and at that point he really can't

383
00:16:05,769 --> 00:16:09,910
trace back where it came from so we

384
00:16:07,540 --> 00:16:12,279
can't see this came from recorded future

385
00:16:09,910 --> 00:16:14,379
this is going to be used against me this

386
00:16:12,279 --> 00:16:16,149
is you know not some other criminal

387
00:16:14,379 --> 00:16:18,579
doing it this is some of the good guys

388
00:16:16,149 --> 00:16:24,879
trying to you know find me out you'll

389
00:16:18,579 --> 00:16:27,219
never be able to see that so you can see

390
00:16:24,879 --> 00:16:30,759
here this is us sending it directly to

391
00:16:27,220 --> 00:16:33,370
his wallet right so he's got his $20 in

392
00:16:30,759 --> 00:16:34,959
Bitcoin which what it at the time of

393
00:16:33,370 --> 00:16:37,809
course in each one of these things and

394
00:16:34,959 --> 00:16:40,000
see the service fee here right every

395
00:16:37,809 --> 00:16:42,490
time you do this they take a cut right

396
00:16:40,000 --> 00:16:43,899
there's a little little slice of money

397
00:16:42,490 --> 00:16:45,610
out of all this they make they make

398
00:16:43,899 --> 00:16:48,490
pretty pretty decent money out of this

399
00:16:45,610 --> 00:16:50,529
obviously we're talking small amounts

400
00:16:48,490 --> 00:16:51,850
here but on some of these dark web

401
00:16:50,529 --> 00:16:54,519
markets that are dealing with large

402
00:16:51,850 --> 00:16:58,209
amounts of drugs Bitcoin mixers can make

403
00:16:54,519 --> 00:17:02,050
a lot of money so then we buy it right

404
00:16:58,209 --> 00:17:04,658
we reach out to him say hey guy we when

405
00:17:02,050 --> 00:17:07,349
was it now point zero zero three nine of

406
00:17:04,659 --> 00:17:10,510
a Bitcoin is yours you've got your money

407
00:17:07,349 --> 00:17:12,609
please you know give us give us yours

408
00:17:10,510 --> 00:17:16,359
you know your stuff and I'll tell you

409
00:17:12,609 --> 00:17:18,158
now you know we do direct actor

410
00:17:16,359 --> 00:17:20,349
engagements on behalf of our customers

411
00:17:18,159 --> 00:17:23,679
or in back on behalf of law enforcement

412
00:17:20,349 --> 00:17:26,168
pretty often and often the amounts are

413
00:17:23,679 --> 00:17:28,510
more than twenty dollars in which case

414
00:17:26,169 --> 00:17:30,640
what we would do and we didn't do it

415
00:17:28,510 --> 00:17:33,520
here because the amount was so small but

416
00:17:30,640 --> 00:17:35,830
what we do is we get basically an escrow

417
00:17:33,520 --> 00:17:38,110
service and what escrow service is is

418
00:17:35,830 --> 00:17:41,139
often the admin of the particular dark

419
00:17:38,110 --> 00:17:43,080
web site he'll run escrow and what he'll

420
00:17:41,140 --> 00:17:44,880
do is he's sort of a trust

421
00:17:43,080 --> 00:17:47,370
guy because he creates all the accounts

422
00:17:44,880 --> 00:17:50,250
he's the admin for the server

423
00:17:47,370 --> 00:17:52,860
he will then we'll send our money to him

424
00:17:50,250 --> 00:17:54,450
and the guy will send his malware or

425
00:17:52,860 --> 00:17:57,389
data dump or whatever it is that we're

426
00:17:54,450 --> 00:17:59,100
buying to the escrow agent the escrow

427
00:17:57,390 --> 00:18:01,830
agent will look and verify that they're

428
00:17:59,100 --> 00:18:02,610
both valid and then he'll take his cut

429
00:18:01,830 --> 00:18:04,230
again

430
00:18:02,610 --> 00:18:07,289
good way these people make a lot of

431
00:18:04,230 --> 00:18:09,120
money and then release them to us but in

432
00:18:07,289 --> 00:18:11,820
this particular case we didn't care and

433
00:18:09,120 --> 00:18:14,820
the reasons why we didn't care it was

434
00:18:11,820 --> 00:18:17,039
$20 and he's been selling this stuff for

435
00:18:14,820 --> 00:18:20,039
seven years this guy has a long history

436
00:18:17,039 --> 00:18:22,080
of selling malware he's not gonna rip us

437
00:18:20,039 --> 00:18:25,710
off he's not gonna take a chance so

438
00:18:22,080 --> 00:18:27,899
anyway he says we say bro it's paid and

439
00:18:25,710 --> 00:18:30,779
we give him the blockchain that shows it

440
00:18:27,899 --> 00:18:33,658
going to his address and then of course

441
00:18:30,779 --> 00:18:36,029
we get the we get the file so he sends

442
00:18:33,659 --> 00:18:39,570
us a link to download it on a man file

443
00:18:36,029 --> 00:18:41,880
and then again he sends us the you know

444
00:18:39,570 --> 00:18:44,039
the results of running this know

445
00:18:41,880 --> 00:18:49,889
distribute antivirus site against it

446
00:18:44,039 --> 00:18:50,100
zero detection x' so we got it download

447
00:18:49,889 --> 00:18:53,699
it

448
00:18:50,100 --> 00:18:55,350
got the malware is and then what we do

449
00:18:53,700 --> 00:18:57,029
is we sort of pull it apart to try and

450
00:18:55,350 --> 00:18:58,889
get some of those indicators to see what

451
00:18:57,029 --> 00:19:00,809
sort of makes it why is this not being

452
00:18:58,889 --> 00:19:02,850
detected what can we do to bring it into

453
00:19:00,809 --> 00:19:05,760
our product and the way we do that is

454
00:19:02,850 --> 00:19:07,379
through reverse engineering the file I'm

455
00:19:05,760 --> 00:19:08,850
sure a number of the folks in this room

456
00:19:07,380 --> 00:19:10,289
are very familiar with reverse

457
00:19:08,850 --> 00:19:12,899
engineering I'm not going to go into a

458
00:19:10,289 --> 00:19:17,158
lot of detail other than to say as we

459
00:19:12,899 --> 00:19:20,489
pull in samples like this we do dynamic

460
00:19:17,159 --> 00:19:22,320
we do static we do network analysis on

461
00:19:20,490 --> 00:19:24,690
the files there's strengths and

462
00:19:22,320 --> 00:19:26,879
weaknesses and all doing static analysis

463
00:19:24,690 --> 00:19:29,159
is really great we pull strings there's

464
00:19:26,880 --> 00:19:33,120
no risk I can have anyone on my team do

465
00:19:29,159 --> 00:19:35,250
static analysis and not necessarily you

466
00:19:33,120 --> 00:19:36,870
know infect themselves or the

467
00:19:35,250 --> 00:19:39,990
organization and then also in doing

468
00:19:36,870 --> 00:19:43,080
static analysis if the bad guy has put

469
00:19:39,990 --> 00:19:44,610
like let's say it's a nation-state piece

470
00:19:43,080 --> 00:19:46,830
of malware and he's put a trigger in

471
00:19:44,610 --> 00:19:49,469
there that would lit you know the people

472
00:19:46,830 --> 00:19:51,750
using it know when it's been executed

473
00:19:49,470 --> 00:19:54,360
then he'd see we're executing this in

474
00:19:51,750 --> 00:19:55,920
America not where we think it is and

475
00:19:54,360 --> 00:19:58,229
then he goes head and shuts it

476
00:19:55,920 --> 00:20:01,140
doing static analysis you don't take

477
00:19:58,230 --> 00:20:03,330
that risk right doing dynamic analysis

478
00:20:01,140 --> 00:20:05,400
sort of what happens you could think of

479
00:20:03,330 --> 00:20:06,990
the way most people experience this

480
00:20:05,400 --> 00:20:08,460
isn't through doing it dynamically

481
00:20:06,990 --> 00:20:10,890
themselves but they run it through

482
00:20:08,460 --> 00:20:13,050
sandboxes and of course we do both and

483
00:20:10,890 --> 00:20:14,940
then of course network transport we look

484
00:20:13,050 --> 00:20:17,550
and see what happened over the network

485
00:20:14,940 --> 00:20:19,559
during the execution of this malware to

486
00:20:17,550 --> 00:20:22,050
see if there's anything we can do from a

487
00:20:19,559 --> 00:20:24,600
signature based network signature base

488
00:20:22,050 --> 00:20:27,600
that would help us augment what we doing

489
00:20:24,600 --> 00:20:29,760
say from the static and dynamic analysis

490
00:20:27,600 --> 00:20:31,559
on the endpoint is there anything on the

491
00:20:29,760 --> 00:20:35,550
network that we could trigger and we

492
00:20:31,559 --> 00:20:38,460
could pattern so here's us using P

493
00:20:35,550 --> 00:20:39,899
Studio pulling out some indicator as you

494
00:20:38,460 --> 00:20:41,610
can see we're playing out some hashes

495
00:20:39,900 --> 00:20:44,070
and we're just basically getting some

496
00:20:41,610 --> 00:20:48,479
strings you can see their Outlook text a

497
00:20:44,070 --> 00:20:51,870
little suspicious here is us doing using

498
00:20:48,480 --> 00:20:54,090
X 30 to debug and doing dynamic analysis

499
00:20:51,870 --> 00:20:56,669
and what this does is it steps through

500
00:20:54,090 --> 00:20:58,290
the code piece-by-piece so the first one

501
00:20:56,670 --> 00:20:59,400
it just checks if there's an internet

502
00:20:58,290 --> 00:21:00,899
connection right so if you're just

503
00:20:59,400 --> 00:21:03,450
running it there's no internet

504
00:21:00,900 --> 00:21:06,390
connection nothing happens it dies but

505
00:21:03,450 --> 00:21:09,600
if it does then it does dll loading of

506
00:21:06,390 --> 00:21:11,370
some of the C 2's and then once it goes

507
00:21:09,600 --> 00:21:14,699
to the C 2's it sends a bunch of

508
00:21:11,370 --> 00:21:16,830
information about the particular client

509
00:21:14,700 --> 00:21:18,480
that's impacted so that the remote

510
00:21:16,830 --> 00:21:20,790
access tool kit knows if there's a

511
00:21:18,480 --> 00:21:23,420
vulnerability that it can use to extend

512
00:21:20,790 --> 00:21:26,040
its access on it and then the last bit

513
00:21:23,420 --> 00:21:28,110
here's a little bit of network analysis

514
00:21:26,040 --> 00:21:31,950
we see this thing actually making a post

515
00:21:28,110 --> 00:21:34,860
out to one of the C 2's so so this point

516
00:21:31,950 --> 00:21:38,490
we've got a hash of the file right we're

517
00:21:34,860 --> 00:21:39,899
a couple of files we have a little bit

518
00:21:38,490 --> 00:21:41,850
of an understanding of what they load

519
00:21:39,900 --> 00:21:45,120
from a dll and a file perspective

520
00:21:41,850 --> 00:21:48,689
internally and we've got a C to write

521
00:21:45,120 --> 00:21:52,040
good some info so then you know what we

522
00:21:48,690 --> 00:21:54,780
do is we pivot on those indicators and

523
00:21:52,040 --> 00:21:56,850
I'm sure you guys are all familiar you

524
00:21:54,780 --> 00:21:58,770
know with them you know you know with

525
00:21:56,850 --> 00:22:02,340
crashing a file so if your hash a file a

526
00:21:58,770 --> 00:22:05,220
hile file has a unique hash identifier

527
00:22:02,340 --> 00:22:07,530
really really useful if you like you're

528
00:22:05,220 --> 00:22:08,000
doing forensics and you know you know

529
00:22:07,530 --> 00:22:09,980
you want to

530
00:22:08,000 --> 00:22:12,260
exclude all the normal Windows system

531
00:22:09,980 --> 00:22:14,600
files you can get the hashes they don't

532
00:22:12,260 --> 00:22:16,190
change they're the same for the you know

533
00:22:14,600 --> 00:22:18,020
a particular version of the file and you

534
00:22:16,190 --> 00:22:20,870
can exclude all of that right for

535
00:22:18,020 --> 00:22:23,030
malware we can absolutely identify

536
00:22:20,870 --> 00:22:25,340
something within you know a hundred

537
00:22:23,030 --> 00:22:28,010
percent forensically sound method that

538
00:22:25,340 --> 00:22:31,310
it is that file with the hash right so

539
00:22:28,010 --> 00:22:34,220
that's good but it's kind of limited so

540
00:22:31,310 --> 00:22:36,280
what some smart researchers did using in

541
00:22:34,220 --> 00:22:39,130
here I'm just doing it in in virustotal

542
00:22:36,280 --> 00:22:44,020
using thing called impassion

543
00:22:39,130 --> 00:22:47,270
what about if that file is very similar

544
00:22:44,020 --> 00:22:48,860
with the hashes be kind of similar to so

545
00:22:47,270 --> 00:22:51,470
they algorithmically worked out a way

546
00:22:48,860 --> 00:22:53,689
that you could see hashes where you know

547
00:22:51,470 --> 00:22:56,270
let's say I just change a couple of bits

548
00:22:53,690 --> 00:22:58,900
in the file let's say I just change the

549
00:22:56,270 --> 00:23:02,660
domain name that the c2 goes to but

550
00:22:58,900 --> 00:23:04,820
99.9% of the file is the same then what

551
00:23:02,660 --> 00:23:07,940
impassion do was it'll pull out all of

552
00:23:04,820 --> 00:23:09,919
the similar hashes so we do that we run

553
00:23:07,940 --> 00:23:12,200
that into virustotal and find a whole

554
00:23:09,920 --> 00:23:14,000
bunch of other related command and

555
00:23:12,200 --> 00:23:16,760
control so what are these these are

556
00:23:14,000 --> 00:23:20,390
command and controls from other $20

557
00:23:16,760 --> 00:23:25,400
customers of this particular vendor so

558
00:23:20,390 --> 00:23:29,000
good good stuff this is what the backend

559
00:23:25,400 --> 00:23:31,640
remote access tool kit looks like you

560
00:23:29,000 --> 00:23:34,670
can see here this is what if you were

561
00:23:31,640 --> 00:23:37,820
the bad guy you were logging in this is

562
00:23:34,670 --> 00:23:39,560
sort of what you'd see here's some of

563
00:23:37,820 --> 00:23:41,870
the configuration things that you can do

564
00:23:39,560 --> 00:23:44,240
with it you can tell it to delete its

565
00:23:41,870 --> 00:23:47,510
executable after it expects accute so

566
00:23:44,240 --> 00:23:49,970
there's really no trace of it and then

567
00:23:47,510 --> 00:23:51,440
here's a client one of us connecting to

568
00:23:49,970 --> 00:23:53,690
it just to try it out so when we're

569
00:23:51,440 --> 00:23:55,940
doing all of this stuff we're thinking

570
00:23:53,690 --> 00:23:57,800
of how do I create yarra rules that

571
00:23:55,940 --> 00:23:59,960
would be able to detect this how do I do

572
00:23:57,800 --> 00:24:02,840
a signature from a network perspective

573
00:23:59,960 --> 00:24:05,510
that we can use with tools like shodhan

574
00:24:02,840 --> 00:24:07,220
to see where all these other k-pot were

575
00:24:05,510 --> 00:24:09,110
you know remote access tool kits

576
00:24:07,220 --> 00:24:11,750
throughout the world and how to identify

577
00:24:09,110 --> 00:24:13,310
those all of this stuff we do by kind of

578
00:24:11,750 --> 00:24:19,190
setting it up in a lab and checking it

579
00:24:13,310 --> 00:24:21,620
out this is our sandbox really nice

580
00:24:19,190 --> 00:24:24,200
graphic many of you guys use the same

581
00:24:21,620 --> 00:24:26,209
you'll recognize it but you can see here

582
00:24:24,200 --> 00:24:31,040
it's identified this thing pretty

583
00:24:26,210 --> 00:24:32,660
heavily as being a Trojan which it is so

584
00:24:31,040 --> 00:24:35,899
then what do we do we take that data and

585
00:24:32,660 --> 00:24:37,220
we normalize it and you can see here we

586
00:24:35,900 --> 00:24:38,750
do these things called in dull cards

587
00:24:37,220 --> 00:24:40,220
that have all of the associated

588
00:24:38,750 --> 00:24:42,559
information about a particular bit of

589
00:24:40,220 --> 00:24:44,720
malware so if you see this if you match

590
00:24:42,559 --> 00:24:47,240
on any of the indicators you can have a

591
00:24:44,720 --> 00:24:49,820
pretty good idea of what it does and

592
00:24:47,240 --> 00:24:51,800
this threat research from insect group

593
00:24:49,820 --> 00:24:54,110
yes that's my group so we'll write up

594
00:24:51,800 --> 00:24:57,020
stuff about it that we know and then

595
00:24:54,110 --> 00:25:00,139
we'll link anything that we get from our

596
00:24:57,020 --> 00:25:02,090
reverse analysis and then in the tool

597
00:25:00,140 --> 00:25:04,040
itself will pull up other references

598
00:25:02,090 --> 00:25:06,439
that it may see for this particular

599
00:25:04,040 --> 00:25:10,580
threat actor or for the indicators the

600
00:25:06,440 --> 00:25:12,559
domains and then all of the normal IOC s

601
00:25:10,580 --> 00:25:14,629
that you would see and these things as

602
00:25:12,559 --> 00:25:16,550
you can see we have both IOC s we have

603
00:25:14,630 --> 00:25:18,740
some risk scores associated with them

604
00:25:16,550 --> 00:25:22,010
and these are live updated so in other

605
00:25:18,740 --> 00:25:23,990
words if we come up or someone post on

606
00:25:22,010 --> 00:25:26,120
Twitter of a number of different IOC s

607
00:25:23,990 --> 00:25:28,040
and related to k-pot this will be

608
00:25:26,120 --> 00:25:30,649
updated without us doing anything at all

609
00:25:28,040 --> 00:25:32,450
so we have this sort of like one-stop

610
00:25:30,650 --> 00:25:34,610
shopping area where you have all the

611
00:25:32,450 --> 00:25:38,480
information about this obscure malware

612
00:25:34,610 --> 00:25:42,919
that some weird guy in where was it st.

613
00:25:38,480 --> 00:25:45,470
Petersburg is selling we also tagged all

614
00:25:42,920 --> 00:25:47,510
of the attack matrix stuff so that if

615
00:25:45,470 --> 00:25:49,429
you're looking for you know specific

616
00:25:47,510 --> 00:25:50,929
types of attacks or you want to see if

617
00:25:49,429 --> 00:25:53,140
you can protect against specific types

618
00:25:50,929 --> 00:25:56,570
we have that all sort of channelized

619
00:25:53,140 --> 00:25:58,700
inside of the tool as well and then so

620
00:25:56,570 --> 00:26:00,980
got all this information how does the

621
00:25:58,700 --> 00:26:02,510
sock use it how do how do you sort of

622
00:26:00,980 --> 00:26:05,600
take that and actually do anything with

623
00:26:02,510 --> 00:26:08,360
it I wish it was easier but for a lot of

624
00:26:05,600 --> 00:26:12,169
people it looks a lot like this so we

625
00:26:08,360 --> 00:26:14,120
have a whole bunch of security devices

626
00:26:12,170 --> 00:26:16,040
that we could feed with good threat

627
00:26:14,120 --> 00:26:20,059
intelligence we have a number of

628
00:26:16,040 --> 00:26:21,889
different systems to hold the records we

629
00:26:20,059 --> 00:26:24,410
have ways of enhancing and

630
00:26:21,890 --> 00:26:26,690
contextualizing the information more and

631
00:26:24,410 --> 00:26:28,250
really what they're what they're trying

632
00:26:26,690 --> 00:26:29,450
to so this is a high-level diagram and

633
00:26:28,250 --> 00:26:31,850
what they're trying to do and what

634
00:26:29,450 --> 00:26:34,100
everyone's trying to do with good high

635
00:26:31,850 --> 00:26:35,360
fidelity cyber threat intelligence is

636
00:26:34,100 --> 00:26:37,520
basically three things

637
00:26:35,360 --> 00:26:39,350
the first thing is they get in you

638
00:26:37,520 --> 00:26:41,179
information potentially about this

639
00:26:39,350 --> 00:26:43,070
malware that they're concerned with they

640
00:26:41,179 --> 00:26:45,440
want to go back through their old system

641
00:26:43,070 --> 00:26:48,110
of records to see well this is new stuff

642
00:26:45,440 --> 00:26:49,880
it wasn't detected do we have any people

643
00:26:48,110 --> 00:26:51,320
that were impacted by this before we

644
00:26:49,880 --> 00:26:53,420
knew about it so I got to be able to do

645
00:26:51,320 --> 00:26:56,928
that right the second thing they have to

646
00:26:53,420 --> 00:26:58,700
do is say does anyone connected right

647
00:26:56,929 --> 00:27:00,440
now do we have people that are connected

648
00:26:58,700 --> 00:27:02,540
to that command and control right now

649
00:27:00,440 --> 00:27:05,540
and if so then that becomes you know

650
00:27:02,540 --> 00:27:07,639
more a little bit of an emergency more

651
00:27:05,540 --> 00:27:10,370
of a you know deal with it kind of in a

652
00:27:07,640 --> 00:27:12,350
live way and then lastly they need to

653
00:27:10,370 --> 00:27:14,570
set up alerting

654
00:27:12,350 --> 00:27:16,610
so that if something comes that's based

655
00:27:14,570 --> 00:27:18,439
off of these indicators in the future

656
00:27:16,610 --> 00:27:20,178
they'll see it they'll be able to you

657
00:27:18,440 --> 00:27:23,570
know link right back to the Intel card

658
00:27:20,179 --> 00:27:26,360
and understand explicitly what threat

659
00:27:23,570 --> 00:27:29,059
they're facing where it came from what

660
00:27:26,360 --> 00:27:30,790
they need to do to fix it so this is

661
00:27:29,059 --> 00:27:34,090
sort of how it's done at a high level

662
00:27:30,790 --> 00:27:36,889
here's how we did it in my old company

663
00:27:34,090 --> 00:27:38,689
and you can see here we have a bunch of

664
00:27:36,890 --> 00:27:42,080
different sources of good threat

665
00:27:38,690 --> 00:27:44,240
intelligence we're using for stuff like

666
00:27:42,080 --> 00:27:47,230
unlike recorded future which is highly

667
00:27:44,240 --> 00:27:49,640
contextualized we would get just base

668
00:27:47,230 --> 00:27:52,280
open source fields that were just IP

669
00:27:49,640 --> 00:27:54,140
addresses that really had no context at

670
00:27:52,280 --> 00:27:57,139
all so we would run it through crits

671
00:27:54,140 --> 00:27:59,750
which is and now an open source program

672
00:27:57,140 --> 00:28:02,179
that Lockheed Martin wrote and what it

673
00:27:59,750 --> 00:28:05,440
would allow us to do is bring in a lot

674
00:28:02,179 --> 00:28:08,630
of stuff from other sources passive DNS

675
00:28:05,440 --> 00:28:11,090
running things like yarra rules on it SS

676
00:28:08,630 --> 00:28:13,340
deep to trying to get as much metadata

677
00:28:11,090 --> 00:28:15,949
about a particular indicator or event as

678
00:28:13,340 --> 00:28:19,070
possible and then all of this would end

679
00:28:15,950 --> 00:28:21,880
up in their tip and then the way that

680
00:28:19,070 --> 00:28:25,129
they would do that pass comparison

681
00:28:21,880 --> 00:28:27,799
instant comparison and new event coming

682
00:28:25,130 --> 00:28:29,660
up is all in sort of look up tables and

683
00:28:27,799 --> 00:28:31,970
Splunk so that

684
00:28:29,660 --> 00:28:34,669
Splunk a lot of it from a detection

685
00:28:31,970 --> 00:28:36,830
perspective is done through actual plays

686
00:28:34,669 --> 00:28:39,200
that the sock does so they look up a

687
00:28:36,830 --> 00:28:41,210
specific and I'll give you an example of

688
00:28:39,200 --> 00:28:44,059
this before we end they would look up a

689
00:28:41,210 --> 00:28:45,919
specific threat that they're concerned

690
00:28:44,059 --> 00:28:47,899
with to see if anyone is impacted by it

691
00:28:45,919 --> 00:28:48,690
and then deal with it sort of personally

692
00:28:47,900 --> 00:28:50,670
but

693
00:28:48,690 --> 00:28:52,980
stuff that they have a higher level of

694
00:28:50,670 --> 00:28:54,870
fidelity with they would throw directly

695
00:28:52,980 --> 00:28:56,360
into their threat mitigation system you

696
00:28:54,870 --> 00:28:58,979
could think of this as your soar

697
00:28:56,360 --> 00:29:00,719
automation platform and I know a lot of

698
00:28:58,980 --> 00:29:04,230
people have spent you know tons of money

699
00:29:00,720 --> 00:29:06,630
with you know with phantom and all the

700
00:29:04,230 --> 00:29:09,330
rest but in reality what this is is a

701
00:29:06,630 --> 00:29:11,910
bunch of Perl scripts and and what that

702
00:29:09,330 --> 00:29:14,760
does is if we have like indicators like

703
00:29:11,910 --> 00:29:16,230
md5 hashes that we know are bad we send

704
00:29:14,760 --> 00:29:18,570
them to our endpoint clients so that

705
00:29:16,230 --> 00:29:20,700
they can detect and block on those if we

706
00:29:18,570 --> 00:29:23,669
have things like domains that we know

707
00:29:20,700 --> 00:29:25,530
are bad we're gonna send them to our DNS

708
00:29:23,670 --> 00:29:28,260
rpz zone so they get automatically

709
00:29:25,530 --> 00:29:31,020
blocked and we use that both to protect

710
00:29:28,260 --> 00:29:33,750
and also as a detection source similarly

711
00:29:31,020 --> 00:29:36,240
if we have a long URL and we saw some of

712
00:29:33,750 --> 00:29:38,070
those in the earlier things we'll send

713
00:29:36,240 --> 00:29:39,960
that directly to our web proxy so that

714
00:29:38,070 --> 00:29:42,600
those will both you know be blocked and

715
00:29:39,960 --> 00:29:44,850
again we can use it for detection and

716
00:29:42,600 --> 00:29:47,280
then you know from an IP perspective if

717
00:29:44,850 --> 00:29:50,310
we just have a DNS name we'll send that

718
00:29:47,280 --> 00:29:52,260
to our BGP blackhole all of these things

719
00:29:50,310 --> 00:29:54,840
happen at the speed of light and they

720
00:29:52,260 --> 00:29:58,020
happen over and over again throughout

721
00:29:54,840 --> 00:30:01,500
the day all automated and the only thing

722
00:29:58,020 --> 00:30:04,080
that really ends up being user done is

723
00:30:01,500 --> 00:30:05,820
the follow up of okay so if someone got

724
00:30:04,080 --> 00:30:08,699
blocked as they went out on the Internet

725
00:30:05,820 --> 00:30:12,330
why what if they gives their system

726
00:30:08,700 --> 00:30:13,980
infected do they need to get fixed what

727
00:30:12,330 --> 00:30:15,570
does one of those blocks look like here

728
00:30:13,980 --> 00:30:17,280
you go this is a web proxy on this

729
00:30:15,570 --> 00:30:19,470
particular thing reaching out to one of

730
00:30:17,280 --> 00:30:21,389
the command and controls and you can see

731
00:30:19,470 --> 00:30:23,520
here blocked and then this cool little

732
00:30:21,390 --> 00:30:25,710
thing that we put in here researchers

733
00:30:23,520 --> 00:30:27,660
have found stuff and then if you were at

734
00:30:25,710 --> 00:30:30,240
Cisco this is what it would look like

735
00:30:27,660 --> 00:30:31,950
either on your full browser or part of

736
00:30:30,240 --> 00:30:34,260
your browser as an ad or another thing

737
00:30:31,950 --> 00:30:36,000
it says you've been blocked by us don't

738
00:30:34,260 --> 00:30:37,530
panic and you can report miss

739
00:30:36,000 --> 00:30:39,990
classification and of course that goes

740
00:30:37,530 --> 00:30:43,230
to Devon all right no one pays any

741
00:30:39,990 --> 00:30:45,360
attention to that so that's pretty much

742
00:30:43,230 --> 00:30:47,880
what the blocks look like if we go back

743
00:30:45,360 --> 00:30:50,820
to the plays anyone that's blocked will

744
00:30:47,880 --> 00:30:52,710
then go back and say did you go

745
00:30:50,820 --> 00:30:56,010
somewhere that was blocked and if so why

746
00:30:52,710 --> 00:30:57,450
there's an example we're looking at so

747
00:30:56,010 --> 00:31:00,660
we've got a list of what we know were

748
00:30:57,450 --> 00:31:02,370
bad URLs bad domains and we're looking

749
00:31:00,660 --> 00:31:05,010
through a web proxy over a 21

750
00:31:02,370 --> 00:31:06,540
our period and saying hey did anyone go

751
00:31:05,010 --> 00:31:09,030
there and if you went there and got

752
00:31:06,540 --> 00:31:10,800
blocked then someone is actually going

753
00:31:09,030 --> 00:31:12,389
to look into your system we're gonna do

754
00:31:10,800 --> 00:31:14,669
some forensics we're gonna see if

755
00:31:12,390 --> 00:31:16,860
perhaps you know you're a system that's

756
00:31:14,670 --> 00:31:18,410
gotten out of compliance or some new

757
00:31:16,860 --> 00:31:20,459
thing has happened that we don't have

758
00:31:18,410 --> 00:31:23,010
protection against and we have to get

759
00:31:20,460 --> 00:31:24,420
your machinery loaded so anyway this is

760
00:31:23,010 --> 00:31:28,050
this is what it looks like

761
00:31:24,420 --> 00:31:29,910
indicator is source references and then

762
00:31:28,050 --> 00:31:33,149
you know we run it run the command and

763
00:31:29,910 --> 00:31:37,650
Splunk and you can see here we got 99

764
00:31:33,150 --> 00:31:40,080
events so for this particular set this

765
00:31:37,650 --> 00:31:43,380
guy is very prevalent obviously you know

766
00:31:40,080 --> 00:31:45,600
going back to a huge network like Cisco

767
00:31:43,380 --> 00:31:47,190
there are a lot of people they have a

768
00:31:45,600 --> 00:31:49,980
couple hundred thousand machines on it

769
00:31:47,190 --> 00:31:51,840
at any time but this guy was pretty

770
00:31:49,980 --> 00:31:53,940
effective and there was a number of

771
00:31:51,840 --> 00:31:56,370
machines that were impacted by the kind

772
00:31:53,940 --> 00:31:59,850
of stuff that he did so these things

773
00:31:56,370 --> 00:32:02,040
would all become cases for IT to go and

774
00:31:59,850 --> 00:32:04,500
remediate we know first off it's

775
00:32:02,040 --> 00:32:07,590
commodity malware right remember how

776
00:32:04,500 --> 00:32:09,510
much it cost 20 bucks it's not a nation

777
00:32:07,590 --> 00:32:12,000
state it's nothing you need to be that

778
00:32:09,510 --> 00:32:13,920
concerned with that being said you don't

779
00:32:12,000 --> 00:32:15,809
want someone leaking secrets directly

780
00:32:13,920 --> 00:32:18,210
out of your corporate network so all we

781
00:32:15,809 --> 00:32:19,920
know because we have good contextual

782
00:32:18,210 --> 00:32:23,010
information about the type of attack

783
00:32:19,920 --> 00:32:24,900
that this mission these particular finds

784
00:32:23,010 --> 00:32:26,820
just need to be flattened we need to

785
00:32:24,900 --> 00:32:28,620
flat reload them and we don't need to

786
00:32:26,820 --> 00:32:31,260
worry about it this isn't indicative of

787
00:32:28,620 --> 00:32:33,330
some terrible nation-state or apt attack

788
00:32:31,260 --> 00:32:35,100
this is commodity malware and we just

789
00:32:33,330 --> 00:32:38,309
need to get rid of but it's effective

790
00:32:35,100 --> 00:32:40,889
because the guy's a good coder and then

791
00:32:38,309 --> 00:32:42,540
leading to your sock worker here on the

792
00:32:40,890 --> 00:32:45,179
Gold Coast this is I'm sure what you all

793
00:32:42,540 --> 00:32:47,760
look like right sitting at the beach you

794
00:32:45,179 --> 00:32:50,490
know dealing with your alerts and then

795
00:32:47,760 --> 00:32:52,500
if you go back you know the security

796
00:32:50,490 --> 00:32:54,570
researcher this is something that we

797
00:32:52,500 --> 00:32:55,860
would do like it probably took me longer

798
00:32:54,570 --> 00:32:58,470
to tell you this

799
00:32:55,860 --> 00:33:00,689
then it honestly takes us to do it this

800
00:32:58,470 --> 00:33:05,000
is something we do on a regular basis

801
00:33:00,690 --> 00:33:08,010
wash rinse repeat so anyway hopefully

802
00:33:05,000 --> 00:33:10,170
some of this was interesting I think we

803
00:33:08,010 --> 00:33:13,910
still have time for questions do we ten

804
00:33:10,170 --> 00:33:13,910
minutes yeah any questions

805
00:33:14,450 --> 00:33:17,289
yes

806
00:33:40,000 --> 00:33:44,809
the question was what are your thoughts

807
00:33:42,529 --> 00:33:47,240
on aging out indicators have I thought

808
00:33:44,809 --> 00:33:49,428
about it yeah unfortunately you felt way

809
00:33:47,240 --> 00:33:52,159
too much about it it's one of those

810
00:33:49,429 --> 00:33:55,130
things that you know some things last

811
00:33:52,159 --> 00:33:57,230
for a long time right so like an md5

812
00:33:55,130 --> 00:33:59,090
hash lasts forever

813
00:33:57,230 --> 00:34:01,580
it's good right if it's there's malware

814
00:33:59,090 --> 00:34:03,230
it has an md5 hash it ain't changing in

815
00:34:01,580 --> 00:34:06,710
10 years it's going to be good

816
00:34:03,230 --> 00:34:09,379
domains are less good so when I think

817
00:34:06,710 --> 00:34:13,899
the first time that that I get got hit

818
00:34:09,379 --> 00:34:18,049
by this really heavily was we at Cisco

819
00:34:13,899 --> 00:34:20,719
running the web proxies we would get

820
00:34:18,050 --> 00:34:25,010
information from various security other

821
00:34:20,719 --> 00:34:27,649
lists maneja fidelity and we would block

822
00:34:25,010 --> 00:34:30,320
based on that and and I got a phone call

823
00:34:27,649 --> 00:34:36,020
very angry people we had started

824
00:34:30,320 --> 00:34:39,409
blocking ESPN and ESPN popular site in

825
00:34:36,020 --> 00:34:41,270
America and and we looked at it and it

826
00:34:39,409 --> 00:34:43,490
was it was basically ESPN were serving

827
00:34:41,270 --> 00:34:50,060
up some some adware some malware right

828
00:34:43,489 --> 00:34:52,158
it was it was good but the the the you

829
00:34:50,060 --> 00:34:54,619
know is it was a random bit amount of

830
00:34:52,159 --> 00:34:56,450
malvert izing majority of people weren't

831
00:34:54,619 --> 00:34:58,640
seeing it caused a way more trouble and

832
00:34:56,449 --> 00:35:00,950
got us a lot of you know bad publicity

833
00:34:58,640 --> 00:35:03,319
as we were you know seemed to be this

834
00:35:00,950 --> 00:35:06,290
stupid group just blocking you know ESPN

835
00:35:03,319 --> 00:35:08,450
and so like for that particular fix we

836
00:35:06,290 --> 00:35:11,210
ended up doing a little bit of an

837
00:35:08,450 --> 00:35:13,430
algorithmic development that said you

838
00:35:11,210 --> 00:35:16,490
know k block if you get something but if

839
00:35:13,430 --> 00:35:18,890
it's got like over a hundred thousand

840
00:35:16,490 --> 00:35:21,319
you know streams to it over the last

841
00:35:18,890 --> 00:35:23,118
half-hour don't block it you know send

842
00:35:21,319 --> 00:35:26,109
an alert to one of the cert guys alert

843
00:35:23,119 --> 00:35:28,760
and look at it so things like domains

844
00:35:26,109 --> 00:35:33,560
obviously an IP addresses in particular

845
00:35:28,760 --> 00:35:35,180
can be very temporal right and so and

846
00:35:33,560 --> 00:35:38,779
that's one of the things I was in a

847
00:35:35,180 --> 00:35:41,328
discussion with a customer earlier this

848
00:35:38,780 --> 00:35:44,210
week and they were asking me well how do

849
00:35:41,329 --> 00:35:45,740
we know how do you rate feeds and how do

850
00:35:44,210 --> 00:35:47,930
you know when good you know feeds are

851
00:35:45,740 --> 00:35:49,970
good and and when you're bad and so we

852
00:35:47,930 --> 00:35:51,740
went into a lot of more detail on that

853
00:35:49,970 --> 00:35:53,480
that I'm going to go into it you know

854
00:35:51,740 --> 00:35:55,910
with you here anyway we can do it

855
00:35:53,480 --> 00:35:58,040
to words but basically things like how

856
00:35:55,910 --> 00:36:00,049
much new is there right how much net new

857
00:35:58,040 --> 00:36:02,270
do they put in on a daily basis is a

858
00:36:00,050 --> 00:36:05,810
good thing to watch for and then

859
00:36:02,270 --> 00:36:07,280
secondarily how much do they expire so

860
00:36:05,810 --> 00:36:11,029
you know because some of these things

861
00:36:07,280 --> 00:36:13,070
like fewer if you're saying IPA dress is

862
00:36:11,030 --> 00:36:16,070
bad and it's on a like a cable

863
00:36:13,070 --> 00:36:18,109
commercial cable modem network literally

864
00:36:16,070 --> 00:36:20,390
you know those things change every you

865
00:36:18,109 --> 00:36:22,250
know four hours or something so you

866
00:36:20,390 --> 00:36:23,839
could say it's bad for four hours

867
00:36:22,250 --> 00:36:26,090
anything longer than that you're just

868
00:36:23,840 --> 00:36:28,880
wasting everyone's time so I guess

869
00:36:26,090 --> 00:36:31,600
there's layers upon layers upon layers

870
00:36:28,880 --> 00:36:33,740
to that question it's not an easy one

871
00:36:31,600 --> 00:36:40,359
but I think I've managed to equivocate

872
00:36:33,740 --> 00:36:40,359
right over it so any other questions

873
00:36:40,900 --> 00:36:47,359
no one's gonna ask how come you pay the

874
00:36:43,550 --> 00:36:48,900
bad guys money or not good yeah well

875
00:36:47,359 --> 00:36:56,150
good thank you very much

876
00:36:48,900 --> 00:36:56,150
[Applause]

