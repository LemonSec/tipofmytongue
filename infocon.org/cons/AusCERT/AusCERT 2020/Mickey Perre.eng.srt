1
00:00:06,799 --> 00:00:09,519
hi

2
00:00:07,120 --> 00:00:11,679
all thanks for coming to my talk um

3
00:00:09,519 --> 00:00:13,040
there's many talks on today

4
00:00:11,679 --> 00:00:14,719
so you know especially really good ones

5
00:00:13,040 --> 00:00:16,960
at this time so i really appreciate you

6
00:00:14,719 --> 00:00:18,320
that you're actually taking the time to

7
00:00:16,960 --> 00:00:20,880
listen to my talk and

8
00:00:18,320 --> 00:00:22,560
you know it's friday afternoon the last

9
00:00:20,880 --> 00:00:24,000
time last week before

10
00:00:22,560 --> 00:00:25,599
the end of the conference so if you've

11
00:00:24,000 --> 00:00:27,279
lasted this long yeah i tip my hat off

12
00:00:25,599 --> 00:00:28,960
to you

13
00:00:27,279 --> 00:00:30,640
what i want to i guess make sure that

14
00:00:28,960 --> 00:00:34,000
i'm part today is that you know this

15
00:00:30,640 --> 00:00:35,440
is a a taste for adversary emulation and

16
00:00:34,000 --> 00:00:36,880
we're going to skim over a lot of a lot

17
00:00:35,440 --> 00:00:38,640
of details a lot of topics i'm probably

18
00:00:36,880 --> 00:00:40,239
going to give you some bad practices

19
00:00:38,640 --> 00:00:44,160
but that's okay um you know this isn't

20
00:00:40,239 --> 00:00:45,760
this is a getting started guide

21
00:00:44,160 --> 00:00:48,078
a little bit about me uh you know my

22
00:00:45,760 --> 00:00:49,120
name's dominico perry officially but you

23
00:00:48,079 --> 00:00:51,600
know all my

24
00:00:49,120 --> 00:00:52,640
friends know me as mickey as i'm a

25
00:00:51,600 --> 00:00:54,800
security specialist

26
00:00:52,640 --> 00:00:55,760
at elastic covering australian new

27
00:00:54,800 --> 00:00:59,599
zealand

28
00:00:55,760 --> 00:01:02,239
uh before working at elastic i

29
00:00:59,600 --> 00:01:03,520
used to work at a large federal agency

30
00:01:02,239 --> 00:01:05,759
and then you know i've worked across

31
00:01:03,520 --> 00:01:06,720
various roles and uh including being a

32
00:01:05,760 --> 00:01:08,320
bartender which was

33
00:01:06,720 --> 00:01:10,320
i still say is one of my favorite

34
00:01:08,320 --> 00:01:12,000
favorite jobs and it

35
00:01:10,320 --> 00:01:13,839
taught me to be a good listener whether

36
00:01:12,000 --> 00:01:16,560
you're a sober or drunk

37
00:01:13,840 --> 00:01:18,400
um in my spare time if i'm not uh you

38
00:01:16,560 --> 00:01:20,799
know spending time with family i'm an

39
00:01:18,400 --> 00:01:24,000
average brewer of beer but i also have

40
00:01:20,799 --> 00:01:26,400
the tide eyes of a father

41
00:01:24,000 --> 00:01:27,600
so quickly gone through our gender you

42
00:01:26,400 --> 00:01:30,159
know the what and why

43
00:01:27,600 --> 00:01:31,439
of adversary emulation you know where do

44
00:01:30,159 --> 00:01:32,720
i start

45
00:01:31,439 --> 00:01:34,798
a little bit about the elastic endpoint

46
00:01:32,720 --> 00:01:37,280
and why i feel like it's it's a good

47
00:01:34,799 --> 00:01:38,320
good uh good marriage between adversary

48
00:01:37,280 --> 00:01:40,720
emulation and

49
00:01:38,320 --> 00:01:43,839
uh sin i'm going to go to a quick demo

50
00:01:40,720 --> 00:01:47,280
and final remarks

51
00:01:43,840 --> 00:01:50,000
now red team is uh be like

52
00:01:47,280 --> 00:01:51,119
you know what to do adversary emulation

53
00:01:50,000 --> 00:01:52,159
all you need to do is just do a couple

54
00:01:51,119 --> 00:01:54,640
circles and then draw an

55
00:01:52,159 --> 00:01:55,840
hour and this is the uh the idea that

56
00:01:54,640 --> 00:01:57,520
they've tried to i guess

57
00:01:55,840 --> 00:01:58,560
portray that it's really hard to do and

58
00:01:57,520 --> 00:01:59,520
you have to have years and years of

59
00:01:58,560 --> 00:02:01,520
experience

60
00:01:59,520 --> 00:02:03,600
while some of that is true i don't

61
00:02:01,520 --> 00:02:04,560
believe that it's entirely true and i

62
00:02:03,600 --> 00:02:05,759
guess

63
00:02:04,560 --> 00:02:08,399
throughout the presentation today i want

64
00:02:05,759 --> 00:02:11,840
to show you why it's quite quite easy to

65
00:02:08,399 --> 00:02:14,160
start somewhere now to give you a bit of

66
00:02:11,840 --> 00:02:16,959
a description of adversary emulation

67
00:02:14,160 --> 00:02:19,280
i'll speak for verbatim from midas uh

68
00:02:16,959 --> 00:02:20,959
midas definition which i i feel was

69
00:02:19,280 --> 00:02:22,640
very accurate it's user's techniques

70
00:02:20,959 --> 00:02:23,440
that have been publicly attributed to an

71
00:02:22,640 --> 00:02:25,040
adversary

72
00:02:23,440 --> 00:02:26,800
and then change techniques together in a

73
00:02:25,040 --> 00:02:28,319
logical series of actions that

74
00:02:26,800 --> 00:02:30,480
are inspired by how the adversary has

75
00:02:28,319 --> 00:02:31,440
acted in the past i think that's very

76
00:02:30,480 --> 00:02:32,879
important because

77
00:02:31,440 --> 00:02:35,280
you know you've probably seen a lot of

78
00:02:32,879 --> 00:02:38,480
technologies that may just do individual

79
00:02:35,280 --> 00:02:39,920
techniques and then it's the ability to

80
00:02:38,480 --> 00:02:41,359
chain that that's um

81
00:02:39,920 --> 00:02:43,119
those techniques together that actually

82
00:02:41,360 --> 00:02:44,640
really adds value and you're going to

83
00:02:43,120 --> 00:02:48,480
see some of the features

84
00:02:44,640 --> 00:02:50,319
later that allows you to

85
00:02:48,480 --> 00:02:52,319
emulate you know even down to the level

86
00:02:50,319 --> 00:02:53,440
of you know adding delays in between

87
00:02:52,319 --> 00:02:57,119
action so you've got

88
00:02:53,440 --> 00:02:57,120
um you know some realism in there

89
00:02:57,200 --> 00:03:00,238
why would i ever want to approach

90
00:02:58,560 --> 00:03:01,599
adversary emulation

91
00:03:00,239 --> 00:03:03,360
and the first thing that comes to mind

92
00:03:01,599 --> 00:03:05,359
for me is to improve your detection

93
00:03:03,360 --> 00:03:07,280
and response capabilities you know

94
00:03:05,360 --> 00:03:08,000
there's a common theory and i would say

95
00:03:07,280 --> 00:03:10,239
theory it's a

96
00:03:08,000 --> 00:03:11,120
common practice of training like you

97
00:03:10,239 --> 00:03:13,840
fight you know

98
00:03:11,120 --> 00:03:15,599
the more you go through a process the

99
00:03:13,840 --> 00:03:17,440
more your muscle memory

100
00:03:15,599 --> 00:03:19,679
gets built up in these in these

101
00:03:17,440 --> 00:03:21,200
scenarios the second thing is improving

102
00:03:19,680 --> 00:03:23,360
your own knowledge um you know

103
00:03:21,200 --> 00:03:24,319
whilst building this presentation i

104
00:03:23,360 --> 00:03:26,959
learned a new

105
00:03:24,319 --> 00:03:28,319
technique about beaconing that i just

106
00:03:26,959 --> 00:03:30,879
never knew about until i

107
00:03:28,319 --> 00:03:31,760
went to this process myself and the

108
00:03:30,879 --> 00:03:34,640
third

109
00:03:31,760 --> 00:03:35,280
and final one um which you know is not

110
00:03:34,640 --> 00:03:37,920
the most

111
00:03:35,280 --> 00:03:39,280
uh it's not the most glamorous out of

112
00:03:37,920 --> 00:03:40,238
all of them is you know proving gaps

113
00:03:39,280 --> 00:03:42,159
before funding

114
00:03:40,239 --> 00:03:43,440
i feel like this is an important part

115
00:03:42,159 --> 00:03:45,840
because uh

116
00:03:43,440 --> 00:03:47,519
if you know normally when you go out and

117
00:03:45,840 --> 00:03:48,239
you're acquiring new technology you have

118
00:03:47,519 --> 00:03:51,120
to have a

119
00:03:48,239 --> 00:03:53,120
a business case that you need to talk

120
00:03:51,120 --> 00:03:56,480
through and and build up

121
00:03:53,120 --> 00:03:58,239
with adversary emulation you are clearly

122
00:03:56,480 --> 00:03:59,200
identifying your gaps and if you so if

123
00:03:58,239 --> 00:04:03,439
you need a new

124
00:03:59,200 --> 00:04:04,798
protection technology to deploy

125
00:04:03,439 --> 00:04:08,480
performing these activities helps

126
00:04:04,799 --> 00:04:08,480
improve the gap for full funding

127
00:04:08,799 --> 00:04:11,840
but you know the question you may you

128
00:04:10,959 --> 00:04:14,000
may

129
00:04:11,840 --> 00:04:16,160
ask is you know how much should i rely

130
00:04:14,000 --> 00:04:17,199
on the human and how much i rely on on

131
00:04:16,160 --> 00:04:18,799
software

132
00:04:17,199 --> 00:04:20,959
and there's a couple of reasons why you

133
00:04:18,798 --> 00:04:22,239
may want to choose the bozo to choose

134
00:04:20,959 --> 00:04:24,080
one or the other or

135
00:04:22,240 --> 00:04:26,240
what i recommend is actually have both

136
00:04:24,080 --> 00:04:27,440
in the right right scenario

137
00:04:26,240 --> 00:04:29,680
you know the human is going to have a

138
00:04:27,440 --> 00:04:31,280
higher upfront cost uh

139
00:04:29,680 --> 00:04:33,360
straight up because you have to get

140
00:04:31,280 --> 00:04:35,599
people in and have to spend time

141
00:04:33,360 --> 00:04:36,560
software is a is a lower lower cost and

142
00:04:35,600 --> 00:04:38,160
lower barrier

143
00:04:36,560 --> 00:04:39,520
the human what i appreciate about you

144
00:04:38,160 --> 00:04:41,600
know when you you get a partner

145
00:04:39,520 --> 00:04:42,799
organization that they're consultive

146
00:04:41,600 --> 00:04:44,000
so they're going to talk to you about

147
00:04:42,800 --> 00:04:45,520
the adversary group they're going to be

148
00:04:44,000 --> 00:04:47,280
able to do things like persona

149
00:04:45,520 --> 00:04:50,000
development or target selection or

150
00:04:47,280 --> 00:04:51,599
advanced fishing or advanced opsec

151
00:04:50,000 --> 00:04:52,960
when you're on the software side there's

152
00:04:51,600 --> 00:04:54,400
a bit of self-reliance there where you

153
00:04:52,960 --> 00:04:56,719
have to actually build the profiles

154
00:04:54,400 --> 00:04:58,799
yourself and yes the last two you guess

155
00:04:56,720 --> 00:05:00,479
that is you've got full spectrum versus

156
00:04:58,800 --> 00:05:03,440
the limit capability set

157
00:05:00,479 --> 00:05:04,159
and to map that out into minor attacks

158
00:05:03,440 --> 00:05:07,680
uh

159
00:05:04,160 --> 00:05:09,520
i guess framework i just want to sort of

160
00:05:07,680 --> 00:05:11,039
show here this is not you know you could

161
00:05:09,520 --> 00:05:11,520
argue this diagram here that you know

162
00:05:11,039 --> 00:05:13,599
you could

163
00:05:11,520 --> 00:05:15,198
potentially do delivery with software

164
00:05:13,600 --> 00:05:17,440
and weaponization recon

165
00:05:15,199 --> 00:05:18,639
but i guess want to make sure that when

166
00:05:17,440 --> 00:05:20,639
you

167
00:05:18,639 --> 00:05:21,919
choose i guess a partner or a human

168
00:05:20,639 --> 00:05:24,720
technology a human

169
00:05:21,919 --> 00:05:27,039
uh partner they'll be able to do the

170
00:05:24,720 --> 00:05:31,039
full suite in one go whereas

171
00:05:27,039 --> 00:05:32,320
with software you're potentially getting

172
00:05:31,039 --> 00:05:35,360
different pieces of software to do

173
00:05:32,320 --> 00:05:35,360
individual components

174
00:05:35,600 --> 00:05:39,199
now on the software side you know what

175
00:05:37,039 --> 00:05:40,960
what software do i choose and you know

176
00:05:39,199 --> 00:05:42,800
i'm a big proponent of open source tech

177
00:05:40,960 --> 00:05:45,599
allows you to

178
00:05:42,800 --> 00:05:46,000
test uh test software before actually

179
00:05:45,600 --> 00:05:48,160
making

180
00:05:46,000 --> 00:05:49,440
making an investment and you know the

181
00:05:48,160 --> 00:05:52,080
three that come to mind is

182
00:05:49,440 --> 00:05:53,360
red team automation which is uh built by

183
00:05:52,080 --> 00:05:56,080
elastic

184
00:05:53,360 --> 00:05:57,360
elastic teams and the in-game team and

185
00:05:56,080 --> 00:05:58,880
atomic red team you know

186
00:05:57,360 --> 00:06:00,479
they have overlapped between each other

187
00:05:58,880 --> 00:06:01,759
where they're looking at just deploying

188
00:06:00,479 --> 00:06:03,359
individual techniques

189
00:06:01,759 --> 00:06:05,039
atomic red team is built out a little

190
00:06:03,360 --> 00:06:07,360
bit further now and you can you can do

191
00:06:05,039 --> 00:06:08,880
full suite campaigns but where i feel

192
00:06:07,360 --> 00:06:10,639
these two lacks

193
00:06:08,880 --> 00:06:12,479
lack you know the user experience

194
00:06:10,639 --> 00:06:14,160
caldera makes up for that

195
00:06:12,479 --> 00:06:16,000
and the reason why is that it's a

196
00:06:14,160 --> 00:06:18,720
completely user driven

197
00:06:16,000 --> 00:06:20,240
experience so you've got a web interface

198
00:06:18,720 --> 00:06:21,440
and it's it's much more natural to

199
00:06:20,240 --> 00:06:24,479
actually build this and

200
00:06:21,440 --> 00:06:24,479
build the activity

201
00:06:24,560 --> 00:06:28,720
so maybe asking you know where do i

202
00:06:26,160 --> 00:06:31,600
start i think there's a couple

203
00:06:28,720 --> 00:06:32,080
criteria that i like to teach people

204
00:06:31,600 --> 00:06:34,080
when

205
00:06:32,080 --> 00:06:36,000
talking about this this problem and this

206
00:06:34,080 --> 00:06:38,318
uh solution

207
00:06:36,000 --> 00:06:40,319
it's ignoring the initial exploit and

208
00:06:38,319 --> 00:06:40,639
that's a hard thing for security people

209
00:06:40,319 --> 00:06:42,720
to

210
00:06:40,639 --> 00:06:44,400
grasp around that you know they want to

211
00:06:42,720 --> 00:06:45,680
try and detect that first thing as soon

212
00:06:44,400 --> 00:06:47,840
as possible but

213
00:06:45,680 --> 00:06:49,840
when you ignore the initial exploit you

214
00:06:47,840 --> 00:06:51,039
realize that those behaviors post

215
00:06:49,840 --> 00:06:53,359
exploitation

216
00:06:51,039 --> 00:06:54,560
are quite common and learning detect

217
00:06:53,360 --> 00:06:56,720
those activities

218
00:06:54,560 --> 00:06:58,560
is uh i feel where you get the most

219
00:06:56,720 --> 00:07:00,319
benefit

220
00:06:58,560 --> 00:07:01,360
the second thing is you know whether

221
00:07:00,319 --> 00:07:03,520
they're running production or not you

222
00:07:01,360 --> 00:07:04,800
know chuck norris run test his code in

223
00:07:03,520 --> 00:07:08,080
production

224
00:07:04,800 --> 00:07:09,199
but there's an important consideration

225
00:07:08,080 --> 00:07:12,080
here and that's

226
00:07:09,199 --> 00:07:13,360
legal imagine that you're running an

227
00:07:12,080 --> 00:07:16,560
adversary simulation

228
00:07:13,360 --> 00:07:18,400
uh platform emulation platform and it's

229
00:07:16,560 --> 00:07:19,520
in the cloud and you're running on your

230
00:07:18,400 --> 00:07:21,120
production network

231
00:07:19,520 --> 00:07:22,960
or maybe a government network and you

232
00:07:21,120 --> 00:07:25,680
exfiltrate data

233
00:07:22,960 --> 00:07:26,880
and you know you run a run a process and

234
00:07:25,680 --> 00:07:28,400
all of a sudden that data has gone out

235
00:07:26,880 --> 00:07:30,560
to the cloud

236
00:07:28,400 --> 00:07:32,000
you've just effectively leaked data into

237
00:07:30,560 --> 00:07:35,039
a unapproved

238
00:07:32,000 --> 00:07:37,280
or unapproved location so you know

239
00:07:35,039 --> 00:07:38,400
consulting with legal is important

240
00:07:37,280 --> 00:07:39,758
you know running and dev's still going

241
00:07:38,400 --> 00:07:41,120
to give you a lot of advantage so you

242
00:07:39,759 --> 00:07:41,840
know don't don't downplay that but

243
00:07:41,120 --> 00:07:44,720
production

244
00:07:41,840 --> 00:07:46,159
does have its benefits the next thing

245
00:07:44,720 --> 00:07:48,560
you're probably going to

246
00:07:46,160 --> 00:07:49,840
need to know is you know what techniques

247
00:07:48,560 --> 00:07:51,599
and

248
00:07:49,840 --> 00:07:53,198
just like samuel jackson's like say a

249
00:07:51,599 --> 00:07:55,360
miter attack one more time

250
00:07:53,199 --> 00:07:56,879
i think it feels a buzzer at all certain

251
00:07:55,360 --> 00:07:58,800
about how many times you've heard

252
00:07:56,879 --> 00:08:01,440
a minor attack you're probably going to

253
00:07:58,800 --> 00:08:03,919
run out of buzzers

254
00:08:01,440 --> 00:08:04,479
but the reason why i see value in this

255
00:08:03,919 --> 00:08:06,318
is that

256
00:08:04,479 --> 00:08:08,159
and i guess reflecting back on when i

257
00:08:06,319 --> 00:08:11,039
used to do threat hunting i used to feel

258
00:08:08,160 --> 00:08:12,960
swamped with and and i used to freeze in

259
00:08:11,039 --> 00:08:15,039
what my next actions

260
00:08:12,960 --> 00:08:16,719
whereas using a framework like motor

261
00:08:15,039 --> 00:08:20,080
attack gives you some

262
00:08:16,720 --> 00:08:21,919
guide posts to to start

263
00:08:20,080 --> 00:08:24,000
now i guess i'm going to propose a

264
00:08:21,919 --> 00:08:26,240
methodology that you can

265
00:08:24,000 --> 00:08:28,400
start with before getting into the full

266
00:08:26,240 --> 00:08:31,280
adversary emulation so you know

267
00:08:28,400 --> 00:08:32,880
start with a single technique technique

268
00:08:31,280 --> 00:08:35,598
so only only one technique

269
00:08:32,880 --> 00:08:37,200
that you need to walk through execute it

270
00:08:35,599 --> 00:08:39,680
see the results

271
00:08:37,200 --> 00:08:40,240
then build a tactic group so for example

272
00:08:39,679 --> 00:08:42,319
do

273
00:08:40,240 --> 00:08:44,240
uh something like command and control

274
00:08:42,320 --> 00:08:46,800
you know c2

275
00:08:44,240 --> 00:08:48,480
then build out sequences so you know

276
00:08:46,800 --> 00:08:51,120
trying to work out between

277
00:08:48,480 --> 00:08:52,880
different uh different attack life

278
00:08:51,120 --> 00:08:55,680
cycles so you know go maybe go

279
00:08:52,880 --> 00:08:57,439
discovery then c2 you know i'll i'm

280
00:08:55,680 --> 00:08:58,880
mincing my words here a little bit but

281
00:08:57,440 --> 00:09:00,560
the idea is that you're trying to build

282
00:08:58,880 --> 00:09:00,959
sequences between different groups or

283
00:09:00,560 --> 00:09:04,479
different

284
00:09:00,959 --> 00:09:06,560
tactics so what i'm looking for and then

285
00:09:04,480 --> 00:09:08,720
finally go full-blown adversary

286
00:09:06,560 --> 00:09:10,640
emulation we're actually looking to

287
00:09:08,720 --> 00:09:12,240
mimic an adversary and the reason i want

288
00:09:10,640 --> 00:09:15,040
to go through these approaches that

289
00:09:12,240 --> 00:09:16,399
you uh it is at the start number one is

290
00:09:15,040 --> 00:09:17,920
not adversary emulation

291
00:09:16,399 --> 00:09:19,519
at all but you want to make sure that

292
00:09:17,920 --> 00:09:21,120
you're you're starting somewhere and

293
00:09:19,519 --> 00:09:23,040
getting that muscle memory by

294
00:09:21,120 --> 00:09:24,480
being able to detect uh the problem is

295
00:09:23,040 --> 00:09:26,560
if you go straight to four

296
00:09:24,480 --> 00:09:27,680
you've got all these detection

297
00:09:26,560 --> 00:09:28,719
detections that you've got to sort of

298
00:09:27,680 --> 00:09:30,000
wrap your head around

299
00:09:28,720 --> 00:09:33,040
and you're not you don't make any

300
00:09:30,000 --> 00:09:33,040
incremental improvements

301
00:09:33,839 --> 00:09:38,800
so a little bit about elastic i guess

302
00:09:37,120 --> 00:09:41,120
the reason why i feel like it's a um

303
00:09:38,800 --> 00:09:43,599
it's very complementary for

304
00:09:41,120 --> 00:09:44,399
uh adversary emulation is that it's a

305
00:09:43,600 --> 00:09:46,240
free and open

306
00:09:44,399 --> 00:09:47,600
endpoint security technology but it's a

307
00:09:46,240 --> 00:09:49,519
little bit more than that it's a

308
00:09:47,600 --> 00:09:51,120
it's a endpoint telemetry agent we're

309
00:09:49,519 --> 00:09:54,000
going to show you why

310
00:09:51,120 --> 00:09:54,480
in a few slides so one of the things you

311
00:09:54,000 --> 00:09:56,480
can do

312
00:09:54,480 --> 00:09:58,160
is it's quite simple to get up and

313
00:09:56,480 --> 00:10:01,440
running it's all through the ui

314
00:09:58,160 --> 00:10:02,880
it's centrally managed so you can have a

315
00:10:01,440 --> 00:10:04,640
fleet of

316
00:10:02,880 --> 00:10:06,000
you know complete the post in your

317
00:10:04,640 --> 00:10:08,720
environment maybe you set up a full

318
00:10:06,000 --> 00:10:09,120
lab with 10 15 various hosts to test

319
00:10:08,720 --> 00:10:10,880
this

320
00:10:09,120 --> 00:10:14,320
you can essentially measure through a ui

321
00:10:10,880 --> 00:10:14,320
and it's you know free to deploy

322
00:10:14,480 --> 00:10:17,839
but not only that you get deep data

323
00:10:16,839 --> 00:10:19,760
visibility when i say

324
00:10:17,839 --> 00:10:21,440
deep uh you know we're doing process

325
00:10:19,760 --> 00:10:22,720
tree uh hierarchy we're looking at

326
00:10:21,440 --> 00:10:24,800
process and stress free

327
00:10:22,720 --> 00:10:25,920
dll on driver loads dns files if you

328
00:10:24,800 --> 00:10:27,359
think about how long it takes to

329
00:10:25,920 --> 00:10:28,880
instrument each of these you know this

330
00:10:27,360 --> 00:10:31,600
is sysmon this is

331
00:10:28,880 --> 00:10:33,200
uh maybe a packet capture there's a lot

332
00:10:31,600 --> 00:10:35,279
of components that you have to

333
00:10:33,200 --> 00:10:36,399
think about when trying to get

334
00:10:35,279 --> 00:10:37,839
visibility uh

335
00:10:36,399 --> 00:10:40,079
into when you're doing an adversary

336
00:10:37,839 --> 00:10:42,079
emulation plus you've got the issues of

337
00:10:40,079 --> 00:10:43,279
different platforms mac os and linux

338
00:10:42,079 --> 00:10:45,040
you know normally people focus on

339
00:10:43,279 --> 00:10:46,480
windows only but there's these other

340
00:10:45,040 --> 00:10:49,439
operating systems and the endpoint

341
00:10:46,480 --> 00:10:49,440
really provides that

342
00:10:49,680 --> 00:10:53,120
now if you wanted to um and you can

343
00:10:52,640 --> 00:10:56,399
actually

344
00:10:53,120 --> 00:10:57,920
turn on prevention mode but

345
00:10:56,399 --> 00:10:59,839
when you're trying to perform your

346
00:10:57,920 --> 00:11:01,199
adversary emulation you know i normally

347
00:10:59,839 --> 00:11:02,720
switch over to detect only

348
00:11:01,200 --> 00:11:04,560
and to see what triggers and let things

349
00:11:02,720 --> 00:11:07,120
go through so that uh

350
00:11:04,560 --> 00:11:08,479
at least i know that if my prevention

351
00:11:07,120 --> 00:11:11,519
fails i've got a

352
00:11:08,480 --> 00:11:14,959
stock app at the end to prevent what to

353
00:11:11,519 --> 00:11:15,839
detect sorry so what would it look like

354
00:11:14,959 --> 00:11:16,800
if you're going to

355
00:11:15,839 --> 00:11:19,519
integrate i'm going to go through this

356
00:11:16,800 --> 00:11:21,279
in a demo uh the beauty about using the

357
00:11:19,519 --> 00:11:22,880
elastic stack and this is in

358
00:11:21,279 --> 00:11:24,560
the free tier the basic tier is that you

359
00:11:22,880 --> 00:11:26,000
have to look at the full

360
00:11:24,560 --> 00:11:28,560
process tree and you'll be able to see

361
00:11:26,000 --> 00:11:31,120
the extent of any any attack

362
00:11:28,560 --> 00:11:32,479
and it's such a powerful visualization

363
00:11:31,120 --> 00:11:33,519
that lets you know you know what process

364
00:11:32,480 --> 00:11:37,040
has been executed how

365
00:11:33,519 --> 00:11:37,680
processes are communicating between each

366
00:11:37,040 --> 00:11:39,920
other

367
00:11:37,680 --> 00:11:41,279
the time it takes to run a subsequent

368
00:11:39,920 --> 00:11:43,680
query so there's

369
00:11:41,279 --> 00:11:44,640
the the level of detail you get in this

370
00:11:43,680 --> 00:11:47,599
view is is

371
00:11:44,640 --> 00:11:48,160
is amazing so a little bit about my

372
00:11:47,600 --> 00:11:51,360
environment

373
00:11:48,160 --> 00:11:52,399
um it's fairly simple i've got caldera

374
00:11:51,360 --> 00:11:53,760
running in

375
00:11:52,399 --> 00:11:56,720
the cloud also i've got a windows host

376
00:11:53,760 --> 00:11:58,160
running the cloud i'm running sysmon

377
00:11:56,720 --> 00:11:59,839
collecting windows security event logs

378
00:11:58,160 --> 00:12:03,600
and also the endpoint security agent

379
00:11:59,839 --> 00:12:05,519
now with caldera it compiles the binary

380
00:12:03,600 --> 00:12:07,440
through powershell in golang which is

381
00:12:05,519 --> 00:12:07,839
pretty cool and then i'm just sending

382
00:12:07,440 --> 00:12:11,120
this

383
00:12:07,839 --> 00:12:12,720
data to elastic cloud so for uh

384
00:12:11,120 --> 00:12:14,880
listeners on this talk you know you can

385
00:12:12,720 --> 00:12:15,360
spin up a free 30-day trial of elastic

386
00:12:14,880 --> 00:12:17,920
cloud

387
00:12:15,360 --> 00:12:18,560
or alternatively you can run this

388
00:12:17,920 --> 00:12:20,880
on-prem

389
00:12:18,560 --> 00:12:22,079
so you can pretty flexible in deployment

390
00:12:20,880 --> 00:12:24,240
options

391
00:12:22,079 --> 00:12:26,479
now to get started with caldera i

392
00:12:24,240 --> 00:12:28,880
normally pick the easy way which is

393
00:12:26,480 --> 00:12:30,399
docker run you know specify the name

394
00:12:28,880 --> 00:12:31,760
calvera hostname and you'll get the

395
00:12:30,399 --> 00:12:32,320
latest updates that they're pretty good

396
00:12:31,760 --> 00:12:35,439
at

397
00:12:32,320 --> 00:12:36,800
updating a lot of these um

398
00:12:35,440 --> 00:12:38,560
updating their code and their docker

399
00:12:36,800 --> 00:12:39,599
instance so let's just make sure that

400
00:12:38,560 --> 00:12:43,199
the ports are

401
00:12:39,600 --> 00:12:46,399
are exposed and then you can select

402
00:12:43,200 --> 00:12:48,240
docker logs caldera to find out the

403
00:12:46,399 --> 00:12:50,959
username and password so

404
00:12:48,240 --> 00:12:51,600
default login default sorry default

405
00:12:50,959 --> 00:12:54,479
pre-built

406
00:12:51,600 --> 00:12:56,079
logins uh for you so very simple you're

407
00:12:54,480 --> 00:12:57,839
up and running in a single line and

408
00:12:56,079 --> 00:12:59,120
the reason i like about the the docker

409
00:12:57,839 --> 00:13:00,160
format is that you can just spin it up

410
00:12:59,120 --> 00:13:02,480
and spin it down and you don't have to

411
00:13:00,160 --> 00:13:03,839
worry about that

412
00:13:02,480 --> 00:13:05,040
so now i'm rushing through i make sure

413
00:13:03,839 --> 00:13:08,160
i've got adequate time for a

414
00:13:05,040 --> 00:13:12,240
demonstration and also

415
00:13:08,160 --> 00:13:12,240
performing some q a at the end

416
00:13:12,639 --> 00:13:16,720
so let me flick to my demo what i'm

417
00:13:15,680 --> 00:13:20,399
going to first start

418
00:13:16,720 --> 00:13:21,519
is in the elastics in view page and when

419
00:13:20,399 --> 00:13:22,480
you think about you know the problem

420
00:13:21,519 --> 00:13:23,920
that you're trying to solve

421
00:13:22,480 --> 00:13:25,680
when you're trying to search all your

422
00:13:23,920 --> 00:13:26,639
data and collect all your data in one

423
00:13:25,680 --> 00:13:29,359
location

424
00:13:26,639 --> 00:13:30,320
speed becomes a very critical factor so

425
00:13:29,360 --> 00:13:31,519
a little bit about

426
00:13:30,320 --> 00:13:34,000
what you're going to see today i'm going

427
00:13:31,519 --> 00:13:35,519
to walk you through how the sim is used

428
00:13:34,000 --> 00:13:37,839
but also how

429
00:13:35,519 --> 00:13:39,440
you can get information from caldera and

430
00:13:37,839 --> 00:13:42,079
run run operations

431
00:13:39,440 --> 00:13:44,000
so first off what you want to do when

432
00:13:42,079 --> 00:13:47,519
you're setting up your

433
00:13:44,000 --> 00:13:48,959
your adversary emulation lab is going to

434
00:13:47,519 --> 00:13:51,440
administration once you've got an

435
00:13:48,959 --> 00:13:53,439
enrolled agent and the documentation is

436
00:13:51,440 --> 00:13:54,720
it's pretty good for this but switch it

437
00:13:53,440 --> 00:13:56,560
over from prevent

438
00:13:54,720 --> 00:13:58,160
to detect and the reason why is that you

439
00:13:56,560 --> 00:14:00,239
want to make sure that you can

440
00:13:58,160 --> 00:14:01,360
test some of these detections at the

441
00:14:00,240 --> 00:14:04,880
later stage

442
00:14:01,360 --> 00:14:06,720
of the campaigns

443
00:14:04,880 --> 00:14:08,560
so i'm going to jump back into ob page

444
00:14:06,720 --> 00:14:11,440
i'm going to switch to

445
00:14:08,560 --> 00:14:12,079
caldera now you are presented with just

446
00:14:11,440 --> 00:14:13,760
an uh

447
00:14:12,079 --> 00:14:14,719
this blank page and i was confused at

448
00:14:13,760 --> 00:14:16,000
start but you know if you click on the

449
00:14:14,720 --> 00:14:17,680
top left hand corner you've got the

450
00:14:16,000 --> 00:14:20,639
navigate icon

451
00:14:17,680 --> 00:14:21,439
and what i generally recommend is

452
00:14:20,639 --> 00:14:23,360
jumping into

453
00:14:21,440 --> 00:14:24,959
the training module and the training

454
00:14:23,360 --> 00:14:27,120
module gives you you know sort of a blue

455
00:14:24,959 --> 00:14:28,959
certificate and it's it's quite simple

456
00:14:27,120 --> 00:14:30,560
uh so bluetooth and use certificate uses

457
00:14:28,959 --> 00:14:31,599
the one you want to go for just walks

458
00:14:30,560 --> 00:14:33,518
you through

459
00:14:31,600 --> 00:14:35,680
some of the activities that you probably

460
00:14:33,519 --> 00:14:37,120
want to do when you first start

461
00:14:35,680 --> 00:14:38,479
using utilizing the platform is what i

462
00:14:37,120 --> 00:14:39,440
really love about it like i've really

463
00:14:38,480 --> 00:14:41,920
thought about

464
00:14:39,440 --> 00:14:44,720
everything um when it comes to making

465
00:14:41,920 --> 00:14:45,599
this experience natural

466
00:14:44,720 --> 00:14:47,920
what we're going to do is we're going to

467
00:14:45,600 --> 00:14:49,040
jump back to i guess agents so there's

468
00:14:47,920 --> 00:14:50,479
three components that you're probably

469
00:14:49,040 --> 00:14:52,240
going to be dealing with

470
00:14:50,480 --> 00:14:53,839
quite often is agents adversaries and

471
00:14:52,240 --> 00:14:55,279
operations so

472
00:14:53,839 --> 00:14:57,279
agents have capabilities they're in

473
00:14:55,279 --> 00:14:58,000
adversary groups and then you perform

474
00:14:57,279 --> 00:15:01,519
operations

475
00:14:58,000 --> 00:15:02,320
with agents so murray as you can see

476
00:15:01,519 --> 00:15:05,600
i've already got

477
00:15:02,320 --> 00:15:08,160
a agent deployed on my web server it's

478
00:15:05,600 --> 00:15:09,519
an elevator prompt i use powershell

479
00:15:08,160 --> 00:15:12,560
one thing i'm going to grab straight

480
00:15:09,519 --> 00:15:14,320
away is this process id and the reason

481
00:15:12,560 --> 00:15:15,680
why i'm grabbing this process id

482
00:15:14,320 --> 00:15:17,519
is i'm going to use it later when i'm

483
00:15:15,680 --> 00:15:19,599
trying to do the detections so

484
00:15:17,519 --> 00:15:21,440
i can kill agent i can see you know a

485
00:15:19,600 --> 00:15:23,440
lot of the information about this

486
00:15:21,440 --> 00:15:24,720
so the important part here when you want

487
00:15:23,440 --> 00:15:26,000
to deploy an agent there's a couple

488
00:15:24,720 --> 00:15:26,959
things you need to change here that when

489
00:15:26,000 --> 00:15:28,000
you select the agent

490
00:15:26,959 --> 00:15:29,199
you get a couple here and you can

491
00:15:28,000 --> 00:15:30,160
actually even bring your own agent if

492
00:15:29,199 --> 00:15:32,319
you want uh

493
00:15:30,160 --> 00:15:33,199
they walked through that process which

494
00:15:32,320 --> 00:15:34,480
is pretty neat

495
00:15:33,199 --> 00:15:36,399
but i normally just select the girling

496
00:15:34,480 --> 00:15:37,920
agent it's the least barrier because i'm

497
00:15:36,399 --> 00:15:38,240
trying to at least barometric i'm trying

498
00:15:37,920 --> 00:15:41,040
to

499
00:15:38,240 --> 00:15:41,920
ignore the exploitation phase and if you

500
00:15:41,040 --> 00:15:43,279
select windows

501
00:15:41,920 --> 00:15:45,040
or you know any operating system it

502
00:15:43,279 --> 00:15:47,439
gives you sort of a string to use

503
00:15:45,040 --> 00:15:48,399
now what i recommend is what you have to

504
00:15:47,440 --> 00:15:52,480
do is

505
00:15:48,399 --> 00:15:55,440
replace uh the four four zeros to

506
00:15:52,480 --> 00:15:56,720
the ip address or domain name of your

507
00:15:55,440 --> 00:15:59,120
caldera server

508
00:15:56,720 --> 00:15:59,920
changing the group is super important uh

509
00:15:59,120 --> 00:16:02,320
because the group

510
00:15:59,920 --> 00:16:04,479
red there's a little little little hint

511
00:16:02,320 --> 00:16:06,079
when you're starting up the red group

512
00:16:04,480 --> 00:16:07,519
if you keep the group as red it prevents

513
00:16:06,079 --> 00:16:09,599
you from advancing to

514
00:16:07,519 --> 00:16:11,360
the next levels in the training course

515
00:16:09,600 --> 00:16:13,759
so yeah just change it i've created my

516
00:16:11,360 --> 00:16:15,920
own for the time being and

517
00:16:13,759 --> 00:16:16,880
the reason why you want separate groups

518
00:16:15,920 --> 00:16:18,240
is that you may

519
00:16:16,880 --> 00:16:20,560
run different operations on different

520
00:16:18,240 --> 00:16:20,880
groups so you know an opportunity could

521
00:16:20,560 --> 00:16:22,880
be

522
00:16:20,880 --> 00:16:25,040
is you create a group for lower

523
00:16:22,880 --> 00:16:26,639
privileged agents and you create a group

524
00:16:25,040 --> 00:16:28,240
for higher privacy agents

525
00:16:26,639 --> 00:16:30,079
in the interest of time just making sure

526
00:16:28,240 --> 00:16:32,800
that i'm doing um just

527
00:16:30,079 --> 00:16:33,359
uh one group so now i've got that you

528
00:16:32,800 --> 00:16:35,120
know i can

529
00:16:33,360 --> 00:16:36,639
you know change some things i can change

530
00:16:35,120 --> 00:16:38,320
the beacon times

531
00:16:36,639 --> 00:16:40,480
min and max you know i recommend doing

532
00:16:38,320 --> 00:16:42,720
something like 10 and 10

533
00:16:40,480 --> 00:16:44,560
keeping it really short and the reason

534
00:16:42,720 --> 00:16:47,040
why is because i feel that

535
00:16:44,560 --> 00:16:47,920
by doing changing this beating interval

536
00:16:47,040 --> 00:16:50,560
you can

537
00:16:47,920 --> 00:16:51,680
practice the art of protecting beacons

538
00:16:50,560 --> 00:16:54,880
and you know i learnt

539
00:16:51,680 --> 00:16:56,000
a lot when uh utilizing um a smaller

540
00:16:54,880 --> 00:16:58,240
beacon time

541
00:16:56,000 --> 00:16:59,920
to help me understand how to detect that

542
00:16:58,240 --> 00:17:01,040
you know you've got this known pattern

543
00:16:59,920 --> 00:17:02,880
and you can adjust it

544
00:17:01,040 --> 00:17:04,480
as you want so there's jitter in here so

545
00:17:02,880 --> 00:17:05,679
now i've got these agents they're online

546
00:17:04,480 --> 00:17:09,120
i'm going to close this down i'm going

547
00:17:05,679 --> 00:17:12,240
to uh select adversaries

548
00:17:09,119 --> 00:17:14,000
and to go into edit mode

549
00:17:12,240 --> 00:17:15,520
you or you've got a list here you know

550
00:17:14,000 --> 00:17:17,119
you can pick on that i'm going to i'm

551
00:17:15,520 --> 00:17:18,079
going to create my own adversary group

552
00:17:17,119 --> 00:17:19,760
and i'm going to

553
00:17:18,079 --> 00:17:21,438
secure the add button and i'm going to

554
00:17:19,760 --> 00:17:24,240
call this also you know

555
00:17:21,439 --> 00:17:24,240
what technique

556
00:17:26,640 --> 00:17:30,080
and then you can say you have to

557
00:17:28,319 --> 00:17:31,280
actually description so you know i got

558
00:17:30,080 --> 00:17:33,360
annoyed with this last time so

559
00:17:31,280 --> 00:17:35,280
don't tell me what to do now to make it

560
00:17:33,360 --> 00:17:37,520
simple um just for today

561
00:17:35,280 --> 00:17:38,639
i'm going to go to add adversary and i'm

562
00:17:37,520 --> 00:17:41,760
going to select

563
00:17:38,640 --> 00:17:42,559
discovery i'm going to click on add to

564
00:17:41,760 --> 00:17:45,360
adversary

565
00:17:42,559 --> 00:17:46,480
and then what i can do yeah so notice

566
00:17:45,360 --> 00:17:47,280
how you've got these icons here that

567
00:17:46,480 --> 00:17:49,840
means this

568
00:17:47,280 --> 00:17:51,600
profile works across all um so but for

569
00:17:49,840 --> 00:17:54,480
now what i'm going to do is just delete

570
00:17:51,600 --> 00:17:54,480
all of these items

571
00:17:58,840 --> 00:18:02,559
here

572
00:18:00,000 --> 00:18:02,559
save this

573
00:18:04,480 --> 00:18:08,799
then i'm going to save that sweet and um

574
00:18:07,840 --> 00:18:09,760
you know

575
00:18:08,799 --> 00:18:13,200
you'll notice down the bottom you've got

576
00:18:09,760 --> 00:18:15,200
adversary saved and um

577
00:18:13,200 --> 00:18:17,039
you know the ui is not the best but you

578
00:18:15,200 --> 00:18:18,400
know it's okay so what i normally do is

579
00:18:17,039 --> 00:18:19,520
close and re-add just to

580
00:18:18,400 --> 00:18:21,840
make sure that i'm not overwriting the

581
00:18:19,520 --> 00:18:25,918
existing profile and then we'll also

582
00:18:21,840 --> 00:18:28,159
uh sequence or tactic

583
00:18:25,919 --> 00:18:29,360
so a group of the group of items get

584
00:18:28,160 --> 00:18:32,400
that do

585
00:18:29,360 --> 00:18:35,600
okay and adversary and i'll choose uh

586
00:18:32,400 --> 00:18:37,919
discovery here and i'll do the whole

587
00:18:35,600 --> 00:18:39,360
the whole swath so i'll pick all of

588
00:18:37,919 --> 00:18:42,559
these and then i'll select

589
00:18:39,360 --> 00:18:44,479
save simple adversary saved and now

590
00:18:42,559 --> 00:18:45,918
you've got yourself set up

591
00:18:44,480 --> 00:18:47,760
the next thing you want to do is create

592
00:18:45,919 --> 00:18:49,840
an operation so

593
00:18:47,760 --> 00:18:51,760
what i'm do is again flick over to add

594
00:18:49,840 --> 00:18:56,080
operation names

595
00:18:51,760 --> 00:18:57,679
single and i normally expand the uh

596
00:18:56,080 --> 00:18:59,600
group so you select the group you want

597
00:18:57,679 --> 00:19:00,720
make sure the the profile you select is

598
00:18:59,600 --> 00:19:02,240
the one you created i mean you've got

599
00:19:00,720 --> 00:19:04,320
some previous ones worm one

600
00:19:02,240 --> 00:19:05,919
is lateral movement you've got thief

601
00:19:04,320 --> 00:19:07,280
which is data filtration so

602
00:19:05,919 --> 00:19:09,039
we've got some pretty pretty good ones

603
00:19:07,280 --> 00:19:10,320
here and then we close the operation

604
00:19:09,039 --> 00:19:13,440
that can

605
00:19:10,320 --> 00:19:15,360
generally clean up items after it's done

606
00:19:13,440 --> 00:19:17,120
make sure it's running autonomously i

607
00:19:15,360 --> 00:19:19,280
can adjust some still factors here

608
00:19:17,120 --> 00:19:20,719
i just normally just do a plain text

609
00:19:19,280 --> 00:19:22,160
obfuscation

610
00:19:20,720 --> 00:19:23,760
but for the demo today i've only used

611
00:19:22,160 --> 00:19:26,559
one and one so one and two

612
00:19:23,760 --> 00:19:27,120
so making sure that the activity is

613
00:19:26,559 --> 00:19:28,960
executing

614
00:19:27,120 --> 00:19:30,239
in a short amount of time if i wanted to

615
00:19:28,960 --> 00:19:31,919
i could even schedule this at night

616
00:19:30,240 --> 00:19:33,440
which is pretty cool but um we're gonna

617
00:19:31,919 --> 00:19:35,919
ignore that today

618
00:19:33,440 --> 00:19:36,640
so i'm gonna go start and that's gonna

619
00:19:35,919 --> 00:19:39,520
go through

620
00:19:36,640 --> 00:19:40,480
and run the operation so while i'm doing

621
00:19:39,520 --> 00:19:42,559
that

622
00:19:40,480 --> 00:19:43,760
because i've got each one of 2628 i'm

623
00:19:42,559 --> 00:19:47,760
just going to jump

624
00:19:43,760 --> 00:19:49,280
into the timeline view

625
00:19:47,760 --> 00:19:52,160
to make it simple for me i'm going to do

626
00:19:49,280 --> 00:19:56,399
i'm going to go out process.did

627
00:19:52,160 --> 00:19:56,400
it was 2628

628
00:19:56,720 --> 00:20:00,240
hit save and this is going to give me

629
00:19:59,200 --> 00:20:01,679
all the

630
00:20:00,240 --> 00:20:03,360
real information for that particular

631
00:20:01,679 --> 00:20:04,400
process and i'm just going to drag this

632
00:20:03,360 --> 00:20:07,280
and drag the or

633
00:20:04,400 --> 00:20:08,720
field to make sure that as i'm adding

634
00:20:07,280 --> 00:20:11,760
this through

635
00:20:08,720 --> 00:20:12,880
i'm just focused in on the exact host

636
00:20:11,760 --> 00:20:14,799
now let me just double check the

637
00:20:12,880 --> 00:20:15,360
operations gone so what you see there's

638
00:20:14,799 --> 00:20:18,320
a little

639
00:20:15,360 --> 00:20:20,240
x mark here and that means that the

640
00:20:18,320 --> 00:20:22,000
operation is still going uh yeah it

641
00:20:20,240 --> 00:20:25,919
takes some time to do this

642
00:20:22,000 --> 00:20:25,919
so we'll just wait for this to return

643
00:20:29,280 --> 00:20:33,200
and we're done so notice that we have a

644
00:20:32,480 --> 00:20:36,960
username

645
00:20:33,200 --> 00:20:36,960
and preparing simple let's jump back

646
00:20:37,200 --> 00:20:42,480
that's all it's easier the

647
00:20:40,720 --> 00:20:44,159
fresh mod view and the way it works that

648
00:20:42,480 --> 00:20:46,720
you go from top to bottom

649
00:20:44,159 --> 00:20:48,720
uh the most uh you want to refresh it so

650
00:20:46,720 --> 00:20:52,320
that you've got the most up-to-date

651
00:20:48,720 --> 00:20:54,400
uh event view i always like analyze

652
00:20:52,320 --> 00:20:54,799
event it gives us this process tree so

653
00:20:54,400 --> 00:20:56,400
i've

654
00:20:54,799 --> 00:20:58,080
i've created a fairly obvious process

655
00:20:56,400 --> 00:20:59,520
name here maybe you start to get a

656
00:20:58,080 --> 00:21:00,799
little bit understanding about you know

657
00:20:59,520 --> 00:21:02,559
use this terminated process you've got

658
00:21:00,799 --> 00:21:04,400
five events where you've got one library

659
00:21:02,559 --> 00:21:07,039
to load four files been written

660
00:21:04,400 --> 00:21:08,080
um but because i've got powershell

661
00:21:07,039 --> 00:21:10,080
transcript logging

662
00:21:08,080 --> 00:21:11,760
i've got it in powershell log.log so i

663
00:21:10,080 --> 00:21:14,000
can actually see that this file has been

664
00:21:11,760 --> 00:21:15,520
been executed i can look at you know

665
00:21:14,000 --> 00:21:17,679
some of the network traffic between the

666
00:21:15,520 --> 00:21:19,280
between each of these how long between

667
00:21:17,679 --> 00:21:20,159
each of the processors that were run 15

668
00:21:19,280 --> 00:21:22,559
minutes ago

669
00:21:20,159 --> 00:21:24,640
it's 9 27 milliseconds like you start to

670
00:21:22,559 --> 00:21:26,799
get an understanding of

671
00:21:24,640 --> 00:21:28,480
what is going on but you know this is

672
00:21:26,799 --> 00:21:30,639
just the start of the events

673
00:21:28,480 --> 00:21:31,600
this is the start of the campaign if you

674
00:21:30,640 --> 00:21:33,440
want to actually go

675
00:21:31,600 --> 00:21:35,039
a little bit further you can start to

676
00:21:33,440 --> 00:21:36,400
and build out a bit of picture so you

677
00:21:35,039 --> 00:21:39,440
know network events

678
00:21:36,400 --> 00:21:41,919
will run we'll go back now so let's go

679
00:21:39,440 --> 00:21:44,080
something that's a little bit more noisy

680
00:21:41,919 --> 00:21:45,760
and what i'm going to select this time

681
00:21:44,080 --> 00:21:47,360
you need to add another

682
00:21:45,760 --> 00:21:49,840
another campaign and we're going to call

683
00:21:47,360 --> 00:21:49,840
this you know

684
00:21:50,240 --> 00:21:53,760
let's call it uh discovery

685
00:21:54,080 --> 00:21:57,199
and let's select the i can do a single

686
00:21:56,000 --> 00:21:59,200
technique i can do the tactic

687
00:21:57,200 --> 00:22:00,240
obviously the tactic why not i'm going

688
00:21:59,200 --> 00:22:03,760
to start that

689
00:22:00,240 --> 00:22:03,760
and this is going to take us some time

690
00:22:06,960 --> 00:22:10,400
starting to see fine processes and you

691
00:22:08,799 --> 00:22:11,280
know the one that will fail it'll tell

692
00:22:10,400 --> 00:22:12,960
you that you failed

693
00:22:11,280 --> 00:22:14,480
you'll give the responses the activities

694
00:22:12,960 --> 00:22:15,919
that was the one before

695
00:22:14,480 --> 00:22:17,440
starting to get a couple more items you

696
00:22:15,919 --> 00:22:19,440
know there's a lot of users that come

697
00:22:17,440 --> 00:22:21,280
back yep that's sweet

698
00:22:19,440 --> 00:22:23,679
and you can tell you can see the i'm

699
00:22:21,280 --> 00:22:26,000
using get wmi object

700
00:22:23,679 --> 00:22:28,400
for that process and this one here is

701
00:22:26,000 --> 00:22:31,039
using a bit of powershell

702
00:22:28,400 --> 00:22:31,919
w132 processor you've got a couple other

703
00:22:31,039 --> 00:22:33,360
uh items

704
00:22:31,919 --> 00:22:35,200
that are happening and the interesting

705
00:22:33,360 --> 00:22:39,439
part about this when i jump back

706
00:22:35,200 --> 00:22:39,440
if i will view and refresh the page

707
00:22:39,520 --> 00:22:43,840
and the operation's still still going i

708
00:22:42,400 --> 00:22:46,720
start to get a bigger picture about

709
00:22:43,840 --> 00:22:48,240
how i can start to detect these items uh

710
00:22:46,720 --> 00:22:48,880
let's go back event powershell

711
00:22:48,240 --> 00:22:51,200
powershell

712
00:22:48,880 --> 00:22:56,880
there's some w mic in there let's

713
00:22:51,200 --> 00:22:56,880
refresh all this data come in 132 events

714
00:22:59,120 --> 00:23:02,000
let's get some more

715
00:23:02,240 --> 00:23:06,640
looks like that's it great

716
00:23:05,360 --> 00:23:08,559
and now you're starting to see a little

717
00:23:06,640 --> 00:23:09,520
bit more against breadth and so here you

718
00:23:08,559 --> 00:23:12,639
know you've got

719
00:23:09,520 --> 00:23:13,760
power.exe spawning and test.exe um

720
00:23:12,640 --> 00:23:15,360
a lot of power so if you think about

721
00:23:13,760 --> 00:23:16,240
some of the detection scenarios you can

722
00:23:15,360 --> 00:23:18,080
look for

723
00:23:16,240 --> 00:23:19,600
you know using something like event

724
00:23:18,080 --> 00:23:20,879
query language or you know

725
00:23:19,600 --> 00:23:22,480
using another technology you can start

726
00:23:20,880 --> 00:23:24,000
to look for you know show me the

727
00:23:22,480 --> 00:23:27,679
distinct account of

728
00:23:24,000 --> 00:23:30,080
our process ids by executable

729
00:23:27,679 --> 00:23:32,080
for example or show me a sequence where

730
00:23:30,080 --> 00:23:33,678
you know powershell spawns an executable

731
00:23:32,080 --> 00:23:35,600
and then spawns powershell again or

732
00:23:33,679 --> 00:23:37,120
powershell to nl test or

733
00:23:35,600 --> 00:23:39,199
any executable to nlts so we haven't

734
00:23:37,120 --> 00:23:41,678
really covered uh

735
00:23:39,200 --> 00:23:43,200
we haven't already covered eql today but

736
00:23:41,679 --> 00:23:46,559
suffice to say that

737
00:23:43,200 --> 00:23:48,400
you can leverage this technology um

738
00:23:46,559 --> 00:23:50,639
in elasticsearch today to build some

739
00:23:48,400 --> 00:23:53,679
really cool detections

740
00:23:50,640 --> 00:23:54,240
so you just saw how easy it was to walk

741
00:23:53,679 --> 00:23:55,919
through

742
00:23:54,240 --> 00:23:58,400
adversary emulation and you know you

743
00:23:55,919 --> 00:24:00,640
could tell that i did skim over certain

744
00:23:58,400 --> 00:24:01,440
scenarios there but you know what i want

745
00:24:00,640 --> 00:24:03,120
to i guess

746
00:24:01,440 --> 00:24:05,520
and part with you is a couple key

747
00:24:03,120 --> 00:24:07,600
takeaways now the first one is

748
00:24:05,520 --> 00:24:09,039
start small you know don't try and boil

749
00:24:07,600 --> 00:24:11,039
the ocean uh try

750
00:24:09,039 --> 00:24:12,799
you know some of those those techniques

751
00:24:11,039 --> 00:24:15,120
those single techniques up front

752
00:24:12,799 --> 00:24:16,400
and then build on that don't hesitate

753
00:24:15,120 --> 00:24:17,120
you know anyone can do this you know

754
00:24:16,400 --> 00:24:19,360
this

755
00:24:17,120 --> 00:24:20,399
activity didn't take me so long to a

756
00:24:19,360 --> 00:24:23,520
long time to build

757
00:24:20,400 --> 00:24:25,760
it was really simple leverage partner

758
00:24:23,520 --> 00:24:27,360
systems to build profiles so it's really

759
00:24:25,760 --> 00:24:29,120
important that you know as you mature

760
00:24:27,360 --> 00:24:30,559
through those later stages that you get

761
00:24:29,120 --> 00:24:32,000
a partner to help you if you don't have

762
00:24:30,559 --> 00:24:33,039
your own threat until team get someone

763
00:24:32,000 --> 00:24:36,159
to help you

764
00:24:33,039 --> 00:24:38,240
build these profiles out in caldera use

765
00:24:36,159 --> 00:24:39,679
elastic of course because it's awesome

766
00:24:38,240 --> 00:24:41,360
and it's free and provides a ton of

767
00:24:39,679 --> 00:24:44,240
value in this scenario

768
00:24:41,360 --> 00:24:45,918
and finally you know don't forget about

769
00:24:44,240 --> 00:24:48,000
forget about the initial exploit um

770
00:24:45,919 --> 00:24:50,240
that's not really important how they

771
00:24:48,000 --> 00:24:51,840
uh initially exploits exploit you what's

772
00:24:50,240 --> 00:24:54,880
important is what happens after in

773
00:24:51,840 --> 00:24:57,279
in my humble opinion

774
00:24:54,880 --> 00:24:58,640
so would you love to you know write on

775
00:24:57,279 --> 00:25:01,840
your resume

776
00:24:58,640 --> 00:25:06,080
i'm at this i do adversary emulation

777
00:25:01,840 --> 00:25:08,959
well to fill the gap that we have today

778
00:25:06,080 --> 00:25:09,918
we are running a dedicated workshop

779
00:25:08,960 --> 00:25:12,559
later in the year

780
00:25:09,919 --> 00:25:13,200
and there's a link below um so take a

781
00:25:12,559 --> 00:25:16,559
screenshot

782
00:25:13,200 --> 00:25:19,039
of me and this website if you want

783
00:25:16,559 --> 00:25:20,320
and register your interest and we'll uh

784
00:25:19,039 --> 00:25:21,120
send some details out when we're

785
00:25:20,320 --> 00:25:24,320
actually

786
00:25:21,120 --> 00:25:26,000
booked or have a confirmed time

787
00:25:24,320 --> 00:25:28,480
now finally i want to make sure that you

788
00:25:26,000 --> 00:25:31,840
know people have time to ask questions

789
00:25:28,480 --> 00:25:33,520
um i'm always available um or you can

790
00:25:31,840 --> 00:25:34,879
catch me on linkedin or twitter at nikki

791
00:25:33,520 --> 00:25:38,158
perry um or

792
00:25:34,880 --> 00:25:42,559
nikki at elastic.com

793
00:25:38,159 --> 00:25:46,000
thank you right perfect guys i think

794
00:25:42,559 --> 00:25:49,600
uh mickey is in the room for some q a

795
00:25:46,000 --> 00:25:52,320
if i'm not mistaken um

796
00:25:49,600 --> 00:25:54,158
let's see if we can throw it on now i

797
00:25:52,320 --> 00:25:56,480
hope everyone's doing well thanks for um

798
00:25:54,159 --> 00:25:57,440
coming to the talk you know it's uh it's

799
00:25:56,480 --> 00:25:59,200
probably

800
00:25:57,440 --> 00:26:01,120
sitting down on a virtual conference is

801
00:25:59,200 --> 00:26:02,240
pretty it's pretty rough um so it's not

802
00:26:01,120 --> 00:26:06,080
like as

803
00:26:02,240 --> 00:26:07,520
uh well engaging as the

804
00:26:06,080 --> 00:26:09,600
face-to-face one but you know appreciate

805
00:26:07,520 --> 00:26:11,840
you uh come to join

806
00:26:09,600 --> 00:26:12,799
anyone have any questions uh i guess

807
00:26:11,840 --> 00:26:15,678
about what i covered

808
00:26:12,799 --> 00:26:17,600
um you know this i've really skimmed the

809
00:26:15,679 --> 00:26:18,480
surface like super scheme like imagine i

810
00:26:17,600 --> 00:26:19,840
chucked a rock and

811
00:26:18,480 --> 00:26:22,400
skimmed on the top of the surface of the

812
00:26:19,840 --> 00:26:25,199
water uh there's so much more to

813
00:26:22,400 --> 00:26:26,400
i guess what i had to what you can do so

814
00:26:25,200 --> 00:26:27,120
um by all means if you have any

815
00:26:26,400 --> 00:26:28,880
questions

816
00:26:27,120 --> 00:26:31,439
hit me up in chat if you want to keep it

817
00:26:28,880 --> 00:26:39,840
private or you know um

818
00:26:31,440 --> 00:26:39,840
put in put in the chat chat window

819
00:26:48,080 --> 00:26:51,199
all right thanks and that's good good

820
00:26:49,279 --> 00:26:52,240
point yeah people want to join me i'm

821
00:26:51,200 --> 00:26:54,480
gonna be at the booth

822
00:26:52,240 --> 00:26:56,400
doing virtual booth duty so uh yeah come

823
00:26:54,480 --> 00:26:59,600
over chat with me there

824
00:26:56,400 --> 00:27:02,080
thanks perfect

825
00:26:59,600 --> 00:27:03,039
thank you very much all right guys so i

826
00:27:02,080 --> 00:27:05,760
think this uh

827
00:27:03,039 --> 00:27:07,120
this about wraps it up for the uh the

828
00:27:05,760 --> 00:27:08,720
sessions that we've had today so thank

829
00:27:07,120 --> 00:27:10,080
you all very much for attending i hope

830
00:27:08,720 --> 00:27:12,000
you all enjoyed it

831
00:27:10,080 --> 00:27:13,600
and got a lot out of it we are going to

832
00:27:12,000 --> 00:27:14,480
break for afternoon tea and there's a

833
00:27:13,600 --> 00:27:16,158
speed debate on

834
00:27:14,480 --> 00:27:17,840
in the main room if i'm not mistaken so

835
00:27:16,159 --> 00:27:21,840
enjoy yourselves have a good weekend

836
00:27:17,840 --> 00:27:21,840
all the best and we'll see you next time

