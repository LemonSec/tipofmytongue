1
00:00:00,000 --> 00:00:05,040
hey we have David Litchfield who is an

2
00:00:02,399 --> 00:00:08,068
independent security consultant giving

3
00:00:05,040 --> 00:00:11,280
his presentation on hack proofing oracle

4
00:00:08,069 --> 00:00:14,599
e-business suite so if you want to like

5
00:00:11,280 --> 00:00:14,599
to give a round of applause for David

6
00:00:15,920 --> 00:00:19,230
just being<font color="#E5E5E5"> here I get a round of</font>

7
00:00:17,910 --> 00:00:22,340
applause that's great you know it's

8
00:00:19,230 --> 00:00:27,269
usually at the end of the talk so okay

9
00:00:22,340 --> 00:00:29,910
sorry thank you thank<font color="#CCCCCC"> you</font><font color="#E5E5E5"> okay so good</font>

10
00:00:27,269 --> 00:00:32,699
afternoon<font color="#E5E5E5"> everybody we're here</font><font color="#CCCCCC"> to talk</font>

11
00:00:29,910 --> 00:00:34,980
about Oracle's ebusiness sweet and

12
00:00:32,700 --> 00:00:39,210
attempting to secure that can I get<font color="#CCCCCC"> a</font>

13
00:00:34,980 --> 00:00:43,468
sharp hands before who actually has a

14
00:00:39,210 --> 00:00:45,360
<font color="#E5E5E5">business suite at work or is somewhat</font>

15
00:00:43,469 --> 00:00:51,840
responsible for any business<font color="#CCCCCC"> we install</font>

16
00:00:45,360 --> 00:00:53,940
somewhere a few people<font color="#E5E5E5"> okay okay so</font>

17
00:00:51,840 --> 00:00:56,760
before we get there Who am I and why am

18
00:00:53,940 --> 00:00:58,559
i addressing you find<font color="#E5E5E5"> people so I'm a</font>

19
00:00:56,760 --> 00:01:00,120
security researcher I've been<font color="#E5E5E5"> in the</font>

20
00:00:58,559 --> 00:01:04,408
game since about nineteen<font color="#E5E5E5"> ninety-eight</font>

21
00:01:00,120 --> 00:01:07,500
and in fact I was a zoologist to begin

22
00:01:04,409 --> 00:01:08,970
with I was studying zoology at Dundee

23
00:01:07,500 --> 00:01:10,560
University and I saw a film called the

24
00:01:08,970 --> 00:01:12,810
the net with Sandra Bullock in has

25
00:01:10,560 --> 00:01:16,020
anybody seen the<font color="#E5E5E5"> film I thought</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> was a</font>

26
00:01:12,810 --> 00:01:17,939
<font color="#E5E5E5">great movie in retrospect I understand</font>

27
00:01:16,020 --> 00:01:19,259
the technical flaws in the film now but

28
00:01:17,939 --> 00:01:21,330
you know they're they're pretty awful

29
00:01:19,259 --> 00:01:23,759
but it actually inspired me to get into

30
00:01:21,330 --> 00:01:28,039
computers and so here I am today not

31
00:01:23,759 --> 00:01:32,610
doing zoology but<font color="#E5E5E5"> instead hacking Oracle</font>

32
00:01:28,040 --> 00:01:35,100
I've written a few books the very few

33
00:01:32,610 --> 00:01:37,049
white papers found a number of bugs in

34
00:01:35,100 --> 00:01:39,000
fact<font color="#E5E5E5"> most of my research these days is</font>

35
00:01:37,049 --> 00:01:40,770
actually focused on oracle every<font color="#E5E5E5"> so</font>

36
00:01:39,000 --> 00:01:43,079
<font color="#E5E5E5">often I'll find a bug in other products</font>

37
00:01:40,770 --> 00:01:44,460
it's just professionally I don't have

38
00:01:43,079 --> 00:01:47,039
<font color="#E5E5E5">the time to be looking at other products</font>

39
00:01:44,460 --> 00:01:50,280
so that's why<font color="#E5E5E5"> most of my stuff is Oracle</font>

40
00:01:47,040 --> 00:01:51,810
these days I retin few security tools

41
00:01:50,280 --> 00:01:54,210
like NGS squirrel some of you may have

42
00:01:51,810 --> 00:01:56,880
used it others in the room probably have

43
00:01:54,210 --> 00:01:58,199
never heard of it and<font color="#E5E5E5"> I found that a few</font>

44
00:01:56,880 --> 00:02:01,199
<font color="#E5E5E5">companies along the way which have all</font>

45
00:01:58,200 --> 00:02:02,729
been acquired Cerberus was acquired by

46
00:02:01,200 --> 00:02:05,040
at stake so I work with that steak for

47
00:02:02,729 --> 00:02:08,610
we won then we left to set up NGS

48
00:02:05,040 --> 00:02:13,140
software and that<font color="#E5E5E5"> was acquired in 2008</font>

49
00:02:08,610 --> 00:02:13,770
by ncc group and i took a some time off

50
00:02:13,140 --> 00:02:16,829
<font color="#CCCCCC">to go dive</font>

51
00:02:13,770 --> 00:02:18,300
and one of<font color="#E5E5E5"> the</font><font color="#CCCCCC"> things I like to do is</font>

52
00:02:16,830 --> 00:02:19,890
<font color="#E5E5E5">dive with great white sharks was this</font>

53
00:02:18,300 --> 00:02:21,960
was the other day down at the Neptune

54
00:02:19,890 --> 00:02:24,989
Islands in South Australia anybody any

55
00:02:21,960 --> 00:02:27,360
divers here I really recommend you dive

56
00:02:24,990 --> 00:02:31,790
with white sharks it it's a I hoping

57
00:02:27,360 --> 00:02:35,880
experience so that's enough about<font color="#E5E5E5"> me</font>

58
00:02:31,790 --> 00:02:38,940
ebusiness sweet used by a large number

59
00:02:35,880 --> 00:02:41,850
<font color="#CCCCCC">of organizations across</font><font color="#E5E5E5"> the world mostly</font>

60
00:02:38,940 --> 00:02:44,250
medium to large organizations I've never

61
00:02:41,850 --> 00:02:48,690
seen<font color="#E5E5E5"> it in small organization simply</font>

62
00:02:44,250 --> 00:02:50,340
because<font color="#CCCCCC"> of the cost one of the customers</font>

63
00:02:48,690 --> 00:02:52,440
i've worked with a<font color="#E5E5E5"> business suite in the</font>

64
00:02:50,340 --> 00:02:55,290
past we were looking at installing the

65
00:02:52,440 --> 00:02:57,300
transparent the TD transparent data

66
00:02:55,290 --> 00:02:59,130
encryption to encrypt data at rest and

67
00:02:57,300 --> 00:03:01,650
with a<font color="#CCCCCC"> seventy eight percent reduction</font>

68
00:02:59,130 --> 00:03:05,760
in price we were looking at<font color="#E5E5E5"> a 2.6</font>

69
00:03:01,650 --> 00:03:08,490
million dollars price tag with<font color="#CCCCCC"> a</font><font color="#E5E5E5"> seventy</font>

70
00:03:05,760 --> 00:03:10,109
<font color="#E5E5E5">eight percent reduction in</font><font color="#CCCCCC"> cost so it's</font>

71
00:03:08,490 --> 00:03:12,600
a very expensive product and it's a very

72
00:03:10,110 --> 00:03:14,730
large product oh yeah we'll be<font color="#E5E5E5"> speaking</font>

73
00:03:12,600 --> 00:03:17,579
about versions 12.2 and all the way back

74
00:03:14,730 --> 00:03:21,260
<font color="#CCCCCC">to 11 dot five today interestingly</font>

75
00:03:17,580 --> 00:03:24,420
though on<font color="#CCCCCC"> the first of January this year</font>

76
00:03:21,260 --> 00:03:25,890
<font color="#CCCCCC">11 dot</font><font color="#E5E5E5"> five was</font><font color="#CCCCCC"> D supported so whilst</font>

77
00:03:24,420 --> 00:03:28,950
we're going to talk about a lot<font color="#CCCCCC"> of</font>

78
00:03:25,890 --> 00:03:32,458
issues in<font color="#CCCCCC"> 11 dot five and we'll cover</font>

79
00:03:28,950 --> 00:03:33,929
the<font color="#CCCCCC"> 12 dot to some of these issues are</font>

80
00:03:32,459 --> 00:03:35,880
no longer<font color="#E5E5E5"> going to be fixed because</font>

81
00:03:33,930 --> 00:03:38,430
Oracle had as that have<font color="#CCCCCC"> D support the</font>

82
00:03:35,880 --> 00:03:39,780
product a lot of customers are<font color="#E5E5E5"> still on</font>

83
00:03:38,430 --> 00:03:42,720
<font color="#E5E5E5">11 dot</font><font color="#CCCCCC"> five and are looking to</font><font color="#E5E5E5"> upgrade</font>

84
00:03:39,780 --> 00:03:45,380
<font color="#CCCCCC">to the next version so there is no</font>

85
00:03:42,720 --> 00:03:48,240
relevance to looking at<font color="#CCCCCC"> 11 dot 52</font>

86
00:03:45,380 --> 00:03:49,859
there's all sorts of components<font color="#E5E5E5"> that can</font>

87
00:03:48,240 --> 00:03:51,720
be added<font color="#CCCCCC"> to e-business suite depending</font>

88
00:03:49,860 --> 00:03:53,700
upon your tastes but part of the problem

89
00:03:51,720 --> 00:03:55,470
of the business<font color="#E5E5E5"> suite is its installed</font>

90
00:03:53,700 --> 00:03:57,869
with everything it<font color="#E5E5E5"> comes with</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> lot of</font>

91
00:03:55,470 --> 00:03:59,940
stuff<font color="#E5E5E5"> it's got a huge massive attack</font>

92
00:03:57,870 --> 00:04:01,260
surface if I if I look<font color="#CCCCCC"> like I'm</font>

93
00:03:59,940 --> 00:04:03,180
blabbering the point at the bottom

94
00:04:01,260 --> 00:04:05,399
massive ginormous gargantuan attack

95
00:04:03,180 --> 00:04:06,990
surface I don't<font color="#CCCCCC"> think that's</font><font color="#E5E5E5"> enough</font>

96
00:04:05,400 --> 00:04:10,890
hyperbole it's<font color="#E5E5E5"> actually bigger than that</font>

97
00:04:06,990 --> 00:04:12,330
<font color="#E5E5E5">ok we are we all know what comes with</font>

98
00:04:10,890 --> 00:04:15,798
big attack surfaces as well of course

99
00:04:12,330 --> 00:04:18,840
but<font color="#CCCCCC"> it is okay according to</font><font color="#E5E5E5"> Oracle of</font>

100
00:04:15,799 --> 00:04:21,660
<font color="#E5E5E5">the many potential sequel injections we</font>

101
00:04:18,839 --> 00:04:24,390
have seen reported we have yet<font color="#E5E5E5"> to</font><font color="#CCCCCC"> find a</font>

102
00:04:21,660 --> 00:04:26,389
single confirmed example that's in the

103
00:04:24,390 --> 00:04:28,520
<font color="#E5E5E5">documentation for securing Oracle</font>

104
00:04:26,389 --> 00:04:33,110
a<font color="#E5E5E5"> business suite I quickly disabused him</font>

105
00:04:28,520 --> 00:04:34,998
of that idea of<font color="#CCCCCC"> course just</font><font color="#E5E5E5"> I will skip</font>

106
00:04:33,110 --> 00:04:36,949
forward ahead just to show<font color="#CCCCCC"> you</font><font color="#E5E5E5"> how many</font>

107
00:04:34,999 --> 00:04:39,800
sequel injection floor oh there we go so

108
00:04:36,949 --> 00:04:41,599
after<font color="#CCCCCC"> a week's worth of effort looking</font>

109
00:04:39,800 --> 00:04:44,419
for sequel injection flaws in the

110
00:04:41,599 --> 00:04:45,949
e-business suite that was a list of

111
00:04:44,419 --> 00:04:48,289
these are the ones that Oracle<font color="#CCCCCC"> of fixed</font>

112
00:04:45,949 --> 00:04:50,090
so far there's a bunch more so there's a

113
00:04:48,289 --> 00:04:53,710
lot<font color="#E5E5E5"> of sequel injection floors in any</font>

114
00:04:50,090 --> 00:04:56,840
business suite so we'll come back<font color="#CCCCCC"> okay</font>

115
00:04:53,710 --> 00:04:59,388
so most of you<font color="#E5E5E5"> will know no doubt that</font>

116
00:04:56,840 --> 00:05:00,590
there<font color="#CCCCCC"> is a web server that feeds into a</font>

117
00:04:59,389 --> 00:05:02,659
back-end database server and there's a

118
00:05:00,590 --> 00:05:04,669
whole bunch<font color="#E5E5E5"> of architecture around that</font>

119
00:05:02,659 --> 00:05:05,930
for things like concurrent processing

120
00:05:04,669 --> 00:05:08,688
and so on and there's the database

121
00:05:05,930 --> 00:05:10,039
listeners and<font color="#CCCCCC"> all</font><font color="#E5E5E5"> that good stuff the</font>

122
00:05:08,689 --> 00:05:11,840
web server itself is going to be the

123
00:05:10,039 --> 00:05:14,479
primary focus of this talk because it's

124
00:05:11,840 --> 00:05:18,799
the easiest point of entry one would

125
00:05:14,479 --> 00:05:21,289
<font color="#CCCCCC">assume that a firewall has been put in</font>

126
00:05:18,800 --> 00:05:23,839
place to<font color="#CCCCCC"> stop</font><font color="#E5E5E5"> acts direct access to the</font>

127
00:05:21,289 --> 00:05:27,498
database server itself and<font color="#CCCCCC"> to the TNS</font>

128
00:05:23,839 --> 00:05:29,569
listeners however will obviously find

129
00:05:27,499 --> 00:05:33,099
out that through exporting some of these

130
00:05:29,569 --> 00:05:35,900
<font color="#E5E5E5">flaws that I've reported to Oracle that</font>

131
00:05:33,099 --> 00:05:37,639
it doesn't<font color="#E5E5E5"> matter</font><font color="#CCCCCC"> about firewall in the</font>

132
00:05:35,900 --> 00:05:40,039
database because we can get<font color="#CCCCCC"> access to</font>

133
00:05:37,639 --> 00:05:44,360
the database server anyway and gain full

134
00:05:40,039 --> 00:05:46,969
control over it there are if you do a

135
00:05:44,360 --> 00:05:49,939
directory listing of the webroot there

136
00:05:46,969 --> 00:05:52,330
are approximately 15,000 jsps what we'll

137
00:05:49,939 --> 00:05:56,060
talk<font color="#E5E5E5"> about later on is how to get rid of</font>

138
00:05:52,330 --> 00:06:00,500
99.9 percent of those jsps to reduce

139
00:05:56,060 --> 00:06:02,930
your<font color="#E5E5E5"> attack surface gone in release 12</font>

140
00:06:00,500 --> 00:06:04,729
is the PRC call gateway but it's obvious

141
00:06:02,930 --> 00:06:08,300
<font color="#CCCCCC">there in 11 dot 5 there are</font>

142
00:06:04,729 --> 00:06:10,159
approximately 700 accessible PR sequel

143
00:06:08,300 --> 00:06:12,710
packages and procedures that<font color="#CCCCCC"> again</font>

144
00:06:10,159 --> 00:06:14,810
provides attack servers in again<font color="#CCCCCC"> on a</font>

145
00:06:12,710 --> 00:06:17,270
recent engagement we reduce that from

146
00:06:14,810 --> 00:06:18,710
700 down to about six again a

147
00:06:17,270 --> 00:06:21,529
ninety-nine point nine nine percent

148
00:06:18,710 --> 00:06:26,500
reduction in attack surface and the same

149
00:06:21,529 --> 00:06:29,710
goes for servlets as well and so on<font color="#E5E5E5"> so</font><font color="#CCCCCC"> I</font>

150
00:06:26,500 --> 00:06:32,509
started an in-depth security review of

151
00:06:29,710 --> 00:06:35,448
e-business suite 11 top<font color="#CCCCCC"> 5 in</font><font color="#E5E5E5"> November</font>

152
00:06:32,509 --> 00:06:36,610
2015 i sat<font color="#E5E5E5"> down for about a week didn't</font>

153
00:06:35,449 --> 00:06:39,349
look at all<font color="#E5E5E5"> the code I just</font>

154
00:06:36,610 --> 00:06:39,710
cherry-picked essentially you know took

155
00:06:39,349 --> 00:06:44,480
<font color="#E5E5E5">some</font>

156
00:06:39,710 --> 00:06:47,419
samples and found a large number of

157
00:06:44,480 --> 00:06:52,520
floors I after finding 50 I decided<font color="#CCCCCC"> that</font>

158
00:06:47,420 --> 00:06:54,560
was enough and I decided that in terms

159
00:06:52,520 --> 00:06:56,090
of attempting<font color="#CCCCCC"> to secure a business suite</font>

160
00:06:54,560 --> 00:06:58,340
the approach was going to be rather than

161
00:06:56,090 --> 00:06:59,780
fixing it on a on a bug<font color="#CCCCCC"> bite bug basis</font>

162
00:06:58,340 --> 00:07:02,030
they were<font color="#E5E5E5"> just going to be far too many</font>

163
00:06:59,780 --> 00:07:03,739
bugs if we extrapolate then the<font color="#E5E5E5"> number</font>

164
00:07:02,030 --> 00:07:06,890
of bugs I found based upon the small

165
00:07:03,740 --> 00:07:09,020
number of components i looked at there

166
00:07:06,890 --> 00:07:11,419
was going to be a massive amount of bugs

167
00:07:09,020 --> 00:07:12,979
so rather<font color="#E5E5E5"> than approach it that way I</font>

168
00:07:11,420 --> 00:07:14,720
was<font color="#E5E5E5"> like well let's just assume that all</font>

169
00:07:12,980 --> 00:07:16,670
the ball the code is bug you what can<font color="#E5E5E5"> we</font>

170
00:07:14,720 --> 00:07:19,810
do to improve the state of our security

171
00:07:16,670 --> 00:07:21,970
such that you know with a couple of

172
00:07:19,810 --> 00:07:24,080
sweeping strokes we can remove

173
00:07:21,970 --> 00:07:29,330
ninety-nine point nine percent of the

174
00:07:24,080 --> 00:07:34,430
risk I did the same<font color="#E5E5E5"> kind of effort a</font>

175
00:07:29,330 --> 00:07:35,960
<font color="#E5E5E5">week's worth work on 12</font><font color="#CCCCCC"> to and again</font>

176
00:07:34,430 --> 00:07:39,470
there<font color="#E5E5E5"> are a whole bunch of security</font>

177
00:07:35,960 --> 00:07:42,680
issues<font color="#E5E5E5"> reported to Oracle most of those</font>

178
00:07:39,470 --> 00:07:44,990
are still<font color="#E5E5E5"> have still not been fixed at</font>

179
00:07:42,680 --> 00:07:47,200
this state so this<font color="#CCCCCC"> is</font><font color="#E5E5E5"> the unfortunate</font>

180
00:07:44,990 --> 00:07:49,100
<font color="#CCCCCC">thing I was hoping by this time the</font>

181
00:07:47,200 --> 00:07:51,260
presentation came around<font color="#E5E5E5"> that I would be</font>

182
00:07:49,100 --> 00:07:53,150
<font color="#CCCCCC">able to</font><font color="#E5E5E5"> present all my findings and</font>

183
00:07:51,260 --> 00:07:56,300
unfortunately<font color="#CCCCCC"> that</font><font color="#E5E5E5"> is not the case so</font>

184
00:07:53,150 --> 00:07:58,190
<font color="#CCCCCC">there's not massively truncated but</font>

185
00:07:56,300 --> 00:08:00,050
there's<font color="#E5E5E5"> going to be a portion of this</font>

186
00:07:58,190 --> 00:08:02,000
talk missing so suffice it to say that

187
00:08:00,050 --> 00:08:04,190
the principles remain the same there are

188
00:08:02,000 --> 00:08:07,070
bugs we can get rid<font color="#E5E5E5"> of them</font><font color="#CCCCCC"> okay the</font>

189
00:08:04,190 --> 00:08:11,180
<font color="#E5E5E5">actual bugs aren't too important i guess</font>

190
00:08:07,070 --> 00:08:12,290
given that there are so many of<font color="#E5E5E5"> them so</font>

191
00:08:11,180 --> 00:08:15,440
we'll look at<font color="#CCCCCC"> some of the issues that</font>

192
00:08:12,290 --> 00:08:17,570
are of interesting<font color="#E5E5E5"> lemon at five we'll</font>

193
00:08:15,440 --> 00:08:19,910
start with some really<font color="#E5E5E5"> simple ones so</font>

194
00:08:17,570 --> 00:08:23,570
all the JSP files are stored<font color="#E5E5E5"> in a</font>

195
00:08:19,910 --> 00:08:27,080
directory off and the web called<font color="#E5E5E5"> /</font><font color="#CCCCCC"> OE</font>

196
00:08:23,570 --> 00:08:28,340
underscore HTML there are other sub

197
00:08:27,080 --> 00:08:30,020
directories<font color="#E5E5E5"> within their one of those</font>

198
00:08:28,340 --> 00:08:31,760
being bin which is really<font color="#CCCCCC"> interesting</font>

199
00:08:30,020 --> 00:08:33,500
because inside<font color="#E5E5E5"> been there's a farm</font>

200
00:08:31,760 --> 00:08:35,030
called apps web CFG which contains

201
00:08:33,500 --> 00:08:39,260
things like usernames and passwords and

202
00:08:35,030 --> 00:08:41,059
configuration information and<font color="#E5E5E5"> also some</font>

203
00:08:39,260 --> 00:08:45,020
<font color="#CCCCCC">of the the applications used to connect</font>

204
00:08:41,059 --> 00:08:47,780
to the to<font color="#CCCCCC"> the database of the like</font>

205
00:08:45,020 --> 00:08:49,790
binary applications to connect to the

206
00:08:47,780 --> 00:08:52,170
database server and if those error

207
00:08:49,790 --> 00:08:53,699
they'll create an SQL net

208
00:08:52,170 --> 00:08:56,459
log file which we can gain access to

209
00:08:53,700 --> 00:08:59,010
simply by using some<font color="#E5E5E5"> of these other</font>

210
00:08:56,459 --> 00:09:00,768
directories / HTML / j initiator which

211
00:08:59,010 --> 00:09:06,930
point to the same physical location on

212
00:09:00,769 --> 00:09:09,089
that<font color="#E5E5E5"> on the file system so that's</font><font color="#CCCCCC"> just</font>

213
00:09:06,930 --> 00:09:11,849
<font color="#CCCCCC">one of the gotchas to be be wary of when</font>

214
00:09:09,089 --> 00:09:15,050
you're locking down ebusiness sweet

215
00:09:11,850 --> 00:09:18,690
they'll end up five remove HTML remove

216
00:09:15,050 --> 00:09:21,149
/j initiator trusted cannot be trusted

217
00:09:18,690 --> 00:09:24,510
that's really ironic so if we<font color="#CCCCCC"> look</font><font color="#E5E5E5"> at</font>

218
00:09:21,149 --> 00:09:26,490
and the the inside the location<font color="#E5E5E5"> sorry</font>

219
00:09:24,510 --> 00:09:28,170
inside<font color="#E5E5E5"> the trust of</font><font color="#CCCCCC"> calm file there's a</font>

220
00:09:26,490 --> 00:09:30,690
whole bunch<font color="#E5E5E5"> of location directors</font><font color="#CCCCCC"> Apache</font>

221
00:09:28,170 --> 00:09:32,370
location directives and that they're not

222
00:09:30,690 --> 00:09:35,880
<font color="#E5E5E5">really they've not really been thought</font>

223
00:09:32,370 --> 00:09:38,040
out well<font color="#E5E5E5"> so for example we're not</font>

224
00:09:35,880 --> 00:09:39,209
allowed to get access<font color="#CCCCCC"> to the DMS</font><font color="#E5E5E5"> zero</font>

225
00:09:38,040 --> 00:09:43,139
thing which gives us information about

226
00:09:39,209 --> 00:09:46,609
memory usage and you know configuration

227
00:09:43,139 --> 00:09:49,980
information and so on but by appending a

228
00:09:46,610 --> 00:09:51,510
so the default is denied from all

229
00:09:49,980 --> 00:09:53,730
essentially so no one should be<font color="#CCCCCC"> able to</font>

230
00:09:51,510 --> 00:09:55,800
access<font color="#CCCCCC"> that but of course by simply</font>

231
00:09:53,730 --> 00:09:58,140
adding another<font color="#E5E5E5"> slash we suddenly get</font>

232
00:09:55,800 --> 00:10:00,449
access to DM 0 and there are a whole

233
00:09:58,140 --> 00:10:03,800
bunch of<font color="#E5E5E5"> things that are protected</font><font color="#CCCCCC"> with</font>

234
00:10:00,449 --> 00:10:06,359
a<font color="#E5E5E5"> location directive that we can simply</font>

235
00:10:03,800 --> 00:10:08,490
bypass essentially so if you see all the

236
00:10:06,360 --> 00:10:12,589
double slashes there so even if someone

237
00:10:08,490 --> 00:10:15,839
<font color="#CCCCCC">was protected</font><font color="#E5E5E5"> the SQL net dot log file</font>

238
00:10:12,589 --> 00:10:20,160
with a<font color="#E5E5E5"> location directive in 08 HTML</font>

239
00:10:15,839 --> 00:10:21,540
which one would prefer<font color="#CCCCCC"> to do then it can</font>

240
00:10:20,160 --> 00:10:23,250
be typically bypass again with the

241
00:10:21,540 --> 00:10:25,439
double slashes so there's a whole<font color="#E5E5E5"> bunch</font>

242
00:10:23,250 --> 00:10:27,269
<font color="#E5E5E5">of issues</font><font color="#CCCCCC"> with with trusted cons but</font>

243
00:10:25,440 --> 00:10:31,320
<font color="#E5E5E5">these are</font><font color="#CCCCCC"> just boring standard Apache</font>

244
00:10:27,269 --> 00:10:35,250
failures that it's not patches for<font color="#E5E5E5"> its</font>

245
00:10:31,320 --> 00:10:36,930
<font color="#E5E5E5">its Oracle's problem so we'll look at</font>

246
00:10:35,250 --> 00:10:40,050
the<font color="#CCCCCC"> p.o</font><font color="#E5E5E5"> sequel gateway which is a much</font>

247
00:10:36,930 --> 00:10:42,329
more<font color="#CCCCCC"> interesting proposition so as</font><font color="#E5E5E5"> I</font>

248
00:10:40,050 --> 00:10:45,540
<font color="#E5E5E5">said earlier there's about 700 PL sequel</font>

249
00:10:42,329 --> 00:10:46,739
packages and procedures the<font color="#CCCCCC"> PLC call</font>

250
00:10:45,540 --> 00:10:48,449
<font color="#CCCCCC">gateways a</font><font color="#E5E5E5"> really interesting thing</font>

251
00:10:46,740 --> 00:10:50,639
essentially what<font color="#E5E5E5"> it does it takes a</font>

252
00:10:48,449 --> 00:10:52,439
request from the<font color="#E5E5E5"> web client and passes</font>

253
00:10:50,639 --> 00:10:55,139
it directly to the database server for

254
00:10:52,440 --> 00:10:57,870
execution so essentially the web client

255
00:10:55,139 --> 00:11:03,269
says get dub dub dub / example calm /

256
00:10:57,870 --> 00:11:06,180
pls / foo / x 10 p<font color="#E5E5E5"> QR now what the web</font>

257
00:11:03,269 --> 00:11:07,620
server does it takes X Y Z P Q R

258
00:11:06,180 --> 00:11:11,279
sends it to the database server and says

259
00:11:07,620 --> 00:11:14,670
please execute XYZ PQ are forming even

260
00:11:11,279 --> 00:11:17,250
if it doesn't exist it executes in a

261
00:11:14,670 --> 00:11:20,550
typical PR sequel gateway in situation

262
00:11:17,250 --> 00:11:23,970
so to prevent abuse like that<font color="#E5E5E5"> Oracle</font>

263
00:11:20,550 --> 00:11:25,229
introduced this fnd enabled pl/sql and

264
00:11:23,970 --> 00:11:29,130
essentially<font color="#CCCCCC"> it's a less it's a table</font>

265
00:11:25,230 --> 00:11:30,990
<font color="#E5E5E5">that contains a list of executable PL</font>

266
00:11:29,130 --> 00:11:34,439
sequel packages and procedures that<font color="#E5E5E5"> one</font>

267
00:11:30,990 --> 00:11:36,480
can access via the POC called gateway so

268
00:11:34,440 --> 00:11:39,240
<font color="#E5E5E5">I rather than looking all 700 of them I</font>

269
00:11:36,480 --> 00:11:43,890
took a sample of 40 12 of those had

270
00:11:39,240 --> 00:11:45,870
sequel injection issues 15 had XSS and

271
00:11:43,890 --> 00:11:47,610
two had a denial of service issue the

272
00:11:45,870 --> 00:11:50,370
simple denial of service issues where

273
00:11:47,610 --> 00:11:52,380
they take user input and pass that to a

274
00:11:50,370 --> 00:11:54,899
loop counter and we specify a really big

275
00:11:52,380 --> 00:11:57,660
number like you know four billion and it

276
00:11:54,899 --> 00:11:59,520
causes the the database to spin<font color="#E5E5E5"> it</font><font color="#CCCCCC"> 100%</font>

277
00:11:57,660 --> 00:12:02,399
and so on what's it's doing that

278
00:11:59,520 --> 00:12:03,779
processing most of the sequel injection

279
00:12:02,399 --> 00:12:06,270
floors where<font color="#E5E5E5"> your standard</font>

280
00:12:03,779 --> 00:12:08,189
run-of-the-mill inject your SQL here

281
00:12:06,270 --> 00:12:10,560
<font color="#CCCCCC">gainful full control of the</font><font color="#E5E5E5"> backend</font>

282
00:12:08,190 --> 00:12:11,790
database server really boring everyone

283
00:12:10,560 --> 00:12:12,949
<font color="#E5E5E5">knows about the kind of stuff but</font>

284
00:12:11,790 --> 00:12:16,410
there's so much more<font color="#E5E5E5"> interesting</font>

285
00:12:12,950 --> 00:12:19,230
<font color="#E5E5E5">slightly harder to exploit issues which</font>

286
00:12:16,410 --> 00:12:23,459
<font color="#CCCCCC">we'll talk</font><font color="#E5E5E5"> about him because it's that's</font>

287
00:12:19,230 --> 00:12:26,520
what we knew it's fun so there's a

288
00:12:23,459 --> 00:12:28,260
package called HR underscore util

289
00:12:26,520 --> 00:12:31,010
unscored discipline school where this

290
00:12:28,260 --> 00:12:34,770
has been patched by the way it has a

291
00:12:31,010 --> 00:12:36,120
procedure of it called<font color="#CCCCCC"> Dec cyl DXL</font><font color="#E5E5E5"> I</font>

292
00:12:34,770 --> 00:12:39,300
don't know how you<font color="#E5E5E5"> pronounce it I'm just</font>

293
00:12:36,120 --> 00:12:42,779
<font color="#E5E5E5">go with Dettol and it takes a single</font>

294
00:12:39,300 --> 00:12:46,140
parameter<font color="#E5E5E5"> a</font><font color="#CCCCCC"> P underscore URL now what it</font>

295
00:12:42,779 --> 00:12:50,189
does that p underscore URL is passed to

296
00:12:46,140 --> 00:12:53,010
the IC x called decrypt to function once

297
00:12:50,190 --> 00:12:55,500
it's been decrypted<font color="#E5E5E5"> it's then embedded</font>

298
00:12:53,010 --> 00:12:57,540
within a beginning and an end block on a

299
00:12:55,500 --> 00:13:00,150
nun honest PL sequel block and then it's

300
00:12:57,540 --> 00:13:02,630
executed via HR general utilities

301
00:13:00,150 --> 00:13:06,000
execute dynamic SQL so the<font color="#E5E5E5"> question is</font>

302
00:13:02,630 --> 00:13:10,620
what does I see X underscore coal creek

303
00:13:06,000 --> 00:13:12,270
dr decrypt to do well it takes a number

304
00:13:10,620 --> 00:13:14,970
<font color="#E5E5E5">that's all is it's not actually</font>

305
00:13:12,270 --> 00:13:17,100
encrypted it's just a<font color="#CCCCCC"> number</font><font color="#E5E5E5"> and what</font>

306
00:13:14,970 --> 00:13:18,480
the decrypt to function does is takes

307
00:13:17,100 --> 00:13:23,040
that number and looks up

308
00:13:18,480 --> 00:13:26,010
a the text column in the<font color="#E5E5E5"> IC X underscore</font>

309
00:13:23,040 --> 00:13:28,050
text table whatever that<font color="#E5E5E5"> text is it</font>

310
00:13:26,010 --> 00:13:33,420
embeds within the SQL statement and

311
00:13:28,050 --> 00:13:35,490
execute sit now because that table is in

312
00:13:33,420 --> 00:13:37,709
the database server we have no direct

313
00:13:35,490 --> 00:13:40,260
control<font color="#CCCCCC"> over that if we could insert</font>

314
00:13:37,709 --> 00:13:44,189
into that table somehow a record you

315
00:13:40,260 --> 00:13:46,709
<font color="#E5E5E5">know like you know pragma autonomous</font>

316
00:13:44,190 --> 00:13:50,010
transaction execute this go<font color="#E5E5E5"> and create a</font>

317
00:13:46,709 --> 00:13:51,899
user account for me that would execute

318
00:13:50,010 --> 00:13:55,019
and it would execute with the privileges

319
00:13:51,899 --> 00:13:57,389
<font color="#CCCCCC">of the apps user which basically is one</font>

320
00:13:55,019 --> 00:13:58,529
small step away from having sis DBA

321
00:13:57,389 --> 00:14:00,510
privileges and what we'll<font color="#E5E5E5"> talk</font><font color="#CCCCCC"> about</font>

322
00:13:58,529 --> 00:14:03,470
that later on<font color="#E5E5E5"> in fact it's trivial to</font>

323
00:14:00,510 --> 00:14:06,120
get such DBA privileges from from apps

324
00:14:03,470 --> 00:14:08,040
but essentially we as an outside

325
00:14:06,120 --> 00:14:09,690
attacker without<font color="#CCCCCC"> username</font><font color="#E5E5E5"> and password</font>

326
00:14:08,040 --> 00:14:10,949
don't necessarily have direct access to

327
00:14:09,690 --> 00:14:13,529
<font color="#E5E5E5">the database server at this stage of the</font>

328
00:14:10,949 --> 00:14:16,349
game so the<font color="#E5E5E5"> question is how do we get</font>

329
00:14:13,529 --> 00:14:19,070
stuff in<font color="#CCCCCC"> that table that what allows us</font>

330
00:14:16,350 --> 00:14:21,209
to execute arbitrary SQL well

331
00:14:19,070 --> 00:14:23,130
fortunately<font color="#E5E5E5"> Oracle again comes to the</font>

332
00:14:21,209 --> 00:14:24,420
rescue for us if we can<font color="#E5E5E5"> encrypt stuff if</font>

333
00:14:23,130 --> 00:14:27,630
we can find somewhere in the web

334
00:14:24,420 --> 00:14:29,819
application that calls<font color="#E5E5E5"> icx on score</font>

335
00:14:27,630 --> 00:14:32,160
called<font color="#E5E5E5"> dot encrypt</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> that'll take our</font>

336
00:14:29,819 --> 00:14:34,949
clear text and put it into that table

337
00:14:32,160 --> 00:14:37,680
for us now in<font color="#E5E5E5"> the same package there is</font>

338
00:14:34,949 --> 00:14:40,079
a display fatal errors procedure and as

339
00:14:37,680 --> 00:14:44,189
you can see here it takes whatever the<font color="#CCCCCC"> P</font>

340
00:14:40,079 --> 00:14:47,239
message parameter is and then

341
00:14:44,190 --> 00:14:50,160
essentially encrypts it for us and

342
00:14:47,240 --> 00:14:52,139
redirects us and gives us a number<font color="#E5E5E5"> so</font>

343
00:14:50,160 --> 00:14:55,339
insert the under<font color="#E5E5E5"> the covers that encrypt</font>

344
00:14:52,139 --> 00:14:57,600
<font color="#E5E5E5">to inserts into the icx tax table a</font>

345
00:14:55,339 --> 00:15:01,319
whatever we send it and gives us a

346
00:14:57,600 --> 00:15:03,870
number back so the attack sequence goes

347
00:15:01,319 --> 00:15:08,130
like this first off we the arbitrary SQL

348
00:15:03,870 --> 00:15:12,480
we want to execute is HTTP p dbms<font color="#E5E5E5"> aw and</font>

349
00:15:08,130 --> 00:15:14,579
sleep for<font color="#E5E5E5"> 10 seconds now this sleep dbms</font>

350
00:15:12,480 --> 00:15:16,649
aw interprets a nice little<font color="#E5E5E5"> function we</font>

351
00:15:14,579 --> 00:15:17,939
can<font color="#E5E5E5"> use to test whether an application</font>

352
00:15:16,649 --> 00:15:20,310
is vulnerable to sequel injection or not

353
00:15:17,940 --> 00:15:22,260
if it sleeps 4 10 seconds we inject it

354
00:15:20,310 --> 00:15:24,388
if<font color="#E5E5E5"> it's sleep if the application sleeps</font>

355
00:15:22,260 --> 00:15:25,920
<font color="#E5E5E5">for 10 seconds then we know it's</font>

356
00:15:24,389 --> 00:15:27,899
vulnerable to sequel injection our SQL

357
00:15:25,920 --> 00:15:29,959
is executing and we embed it within an

358
00:15:27,899 --> 00:15:33,110
HTTP p<font color="#E5E5E5"> just for</font><font color="#CCCCCC"> the you know</font>

359
00:15:29,960 --> 00:15:35,000
pass through without any problems so we

360
00:15:33,110 --> 00:15:38,600
we execute that with the display fatal

361
00:15:35,000 --> 00:15:42,290
errors and that we directs us to the

362
00:15:38,600 --> 00:15:46,520
same page but now with a number that

363
00:15:42,290 --> 00:15:49,420
number we then take and request with the

364
00:15:46,520 --> 00:15:54,199
vedeks all procedure and what happens is

365
00:15:49,420 --> 00:15:56,479
the database server looks in the IC x @

366
00:15:54,200 --> 00:15:59,350
underscore text table for that number

367
00:15:56,480 --> 00:16:02,090
takes out the text embeds it within the

368
00:15:59,350 --> 00:16:03,950
anonymous PL sequel blocks and execute

369
00:16:02,090 --> 00:16:05,750
it for us and the<font color="#CCCCCC"> application hangs for</font>

370
00:16:03,950 --> 00:16:11,300
10 seconds and that executors the apps

371
00:16:05,750 --> 00:16:12,950
user so it's<font color="#E5E5E5"> not a trivial sequel</font>

372
00:16:11,300 --> 00:16:16,069
injection floor it's it's a you know

373
00:16:12,950 --> 00:16:19,280
slightly<font color="#E5E5E5"> harder to exploit but much more</font>

374
00:16:16,070 --> 00:16:20,930
interesting you<font color="#E5E5E5"> know when you keep on</font>

375
00:16:19,280 --> 00:16:22,250
finding sequel injection<font color="#E5E5E5"> floors and it</font>

376
00:16:20,930 --> 00:16:23,630
gets really<font color="#E5E5E5"> boring when you find</font>

377
00:16:22,250 --> 00:16:24,800
something a bit more harder to<font color="#CCCCCC"> exploit</font>

378
00:16:23,630 --> 00:16:26,630
it's a lot more<font color="#CCCCCC"> fun because you know</font>

379
00:16:24,800 --> 00:16:32,030
it's like well actually now that you

380
00:16:26,630 --> 00:16:34,790
<font color="#CCCCCC">know piques my interest yeah what was</font>

381
00:16:32,030 --> 00:16:36,829
ironic was the whole statement in the

382
00:16:34,790 --> 00:16:38,360
beginning about of all the sequel

383
00:16:36,830 --> 00:16:41,150
injection floors we've had reported to a

384
00:16:38,360 --> 00:16:42,770
spot you know none of<font color="#E5E5E5"> them have been</font>

385
00:16:41,150 --> 00:16:45,920
confirmed examples<font color="#CCCCCC"> of that</font><font color="#E5E5E5"> in the time</font>

386
00:16:42,770 --> 00:16:47,630
it took me to type that<font color="#E5E5E5"> I found</font><font color="#CCCCCC"> it in</font>

387
00:16:45,920 --> 00:16:49,400
<font color="#CCCCCC">the equipment time I</font><font color="#E5E5E5"> found a single</font>

388
00:16:47,630 --> 00:16:51,170
injection floor which<font color="#CCCCCC"> was the ironic</font>

389
00:16:49,400 --> 00:16:54,920
thing it's there that easy<font color="#E5E5E5"> to find it in</font>

390
00:16:51,170 --> 00:16:58,069
a business way unfortunately another

391
00:16:54,920 --> 00:17:02,689
quite cool example is the execute

392
00:16:58,070 --> 00:17:04,220
procedure on the<font color="#CCCCCC"> Oracle</font><font color="#E5E5E5"> ssw a package so</font>

393
00:17:02,690 --> 00:17:06,410
what happens here<font color="#CCCCCC"> is</font><font color="#E5E5E5"> we've got slightly</font>

394
00:17:04,220 --> 00:17:11,329
different decrypt function this one is

395
00:17:06,410 --> 00:17:14,089
actually use it loosely encrypted now

396
00:17:11,329 --> 00:17:17,990
the e parameter basically is passed to

397
00:17:14,089 --> 00:17:22,520
the decrypt function and that block

398
00:17:17,990 --> 00:17:24,859
there there ! 38 FC<font color="#E5E5E5"> 0 decrypt to this</font>

399
00:17:22,520 --> 00:17:28,420
sequence of<font color="#E5E5E5"> numbers at the bottom now</font>

400
00:17:24,859 --> 00:17:32,479
that 2633 basically is passed to

401
00:17:28,420 --> 00:17:34,400
internally the run function function now

402
00:17:32,480 --> 00:17:38,820
what that<font color="#E5E5E5"> does is basically looks up a</font>

403
00:17:34,400 --> 00:17:42,450
web HTML call column in the<font color="#E5E5E5"> f</font>

404
00:17:38,820 --> 00:17:45,509
<font color="#CCCCCC">form functions table that equates to</font>

405
00:17:42,450 --> 00:17:49,289
that<font color="#E5E5E5"> given function ID so in this case</font>

406
00:17:45,509 --> 00:17:50,850
<font color="#E5E5E5">26 33 translates to i</font><font color="#CCCCCC"> six underscore</font>

407
00:17:49,289 --> 00:17:54,570
change unschooling language<font color="#E5E5E5"> show</font>

408
00:17:50,850 --> 00:17:57,779
languages now in the code if there<font color="#E5E5E5"> is a</font>

409
00:17:54,570 --> 00:18:00,990
parameter<font color="#CCCCCC"> called P and it's none know it</font>

410
00:17:57,779 --> 00:18:04,529
too is concatenate it<font color="#CCCCCC"> too is decrypted</font>

411
00:18:00,990 --> 00:18:07,279
and then concatenated to the arbitrary

412
00:18:04,529 --> 00:18:11,909
block of SQL that's going to be executed

413
00:18:07,279 --> 00:18:13,409
so in our case if we using<font color="#E5E5E5"> the encrypt</font>

414
00:18:11,909 --> 00:18:15,419
function if we've you know<font color="#CCCCCC"> will you need</font>

415
00:18:13,409 --> 00:18:18,769
<font color="#E5E5E5">the basic our own version our own copy</font>

416
00:18:15,419 --> 00:18:22,879
of e-business suite essentially we

417
00:18:18,769 --> 00:18:28,080
encrypt arbitrary SQL in this case<font color="#E5E5E5"> its</font>

418
00:18:22,879 --> 00:18:32,519
bracket semicolon HTTP p user semicolon

419
00:18:28,080 --> 00:18:34,529
end semicolon minus minus equals a the

420
00:18:32,519 --> 00:18:37,830
reason for<font color="#CCCCCC"> this all become clear shortly</font>

421
00:18:34,529 --> 00:18:40,320
what is concatenated or what is

422
00:18:37,830 --> 00:18:43,220
eventually executed is this so remember

423
00:18:40,320 --> 00:18:48,450
we've passed it<font color="#E5E5E5"> the encrypted text that</font>

424
00:18:43,220 --> 00:18:51,000
<font color="#E5E5E5">decrypts 2263 26 33 that takes from the</font>

425
00:18:48,450 --> 00:18:53,250
table<font color="#CCCCCC"> ice</font><font color="#E5E5E5"> exchange underscore language</font>

426
00:18:51,000 --> 00:18:55,649
let's show languages and then the peeper

427
00:18:53,250 --> 00:18:58,710
ammeter is concatenated to the end now

428
00:18:55,649 --> 00:19:01,559
by appending the minus minus at<font color="#E5E5E5"> the end</font>

429
00:18:58,710 --> 00:19:04,139
we essentially cut off the rest of the

430
00:19:01,559 --> 00:19:07,789
SQL that is supplied<font color="#CCCCCC"> by</font><font color="#E5E5E5"> the application</font>

431
00:19:04,139 --> 00:19:09,779
so<font color="#E5E5E5"> essentially we're embedding our own</font>

432
00:19:07,789 --> 00:19:15,870
arbitrary SQL to actually in this case

433
00:19:09,779 --> 00:19:18,240
HTTP dopey user so we go ahead<font color="#CCCCCC"> and</font>

434
00:19:15,870 --> 00:19:21,570
<font color="#CCCCCC">execute that the e parameter as</font><font color="#E5E5E5"> I said</font>

435
00:19:18,240 --> 00:19:26,250
is the encrypted text for the the 26 33

436
00:19:21,570 --> 00:19:31,350
and the peeper ammeter is our modified

437
00:19:26,250 --> 00:19:37,559
HTTP p SQL and if we look<font color="#E5E5E5"> in the source</font>

438
00:19:31,350 --> 00:19:39,029
we can<font color="#E5E5E5"> see HTTP dot p user excuse and we</font>

439
00:19:37,559 --> 00:19:45,059
can see<font color="#CCCCCC"> we're executing is the apps user</font>

440
00:19:39,029 --> 00:19:48,179
there now where are<font color="#CCCCCC"> we there's a whole</font>

441
00:19:45,059 --> 00:19:50,629
<font color="#E5E5E5">bunch of issues like this in 11 dot 5</font>

442
00:19:48,179 --> 00:19:52,800
and 12 2 and

443
00:19:50,630 --> 00:19:55,620
these are the ones that<font color="#CCCCCC"> were fixed these</font>

444
00:19:52,800 --> 00:20:00,990
<font color="#E5E5E5">were fixed in January except the bottom</font>

445
00:19:55,620 --> 00:20:04,260
three on the right hand side those<font color="#CCCCCC"> cve</font>

446
00:20:00,990 --> 00:20:05,520
IDs were given to me by<font color="#E5E5E5"> mitre because</font>

447
00:20:04,260 --> 00:20:07,980
<font color="#CCCCCC">Oracle have said they're not going to</font>

448
00:20:05,520 --> 00:20:11,940
<font color="#CCCCCC">fix those</font><font color="#E5E5E5"> issues because the the product</font>

449
00:20:07,980 --> 00:20:14,100
is now d supported so there's a<font color="#E5E5E5"> whole</font>

450
00:20:11,940 --> 00:20:19,230
bunch<font color="#E5E5E5"> of</font><font color="#CCCCCC"> issues that</font><font color="#E5E5E5"> have not been fixed</font>

451
00:20:14,100 --> 00:20:20,639
<font color="#CCCCCC">yet in the 11 dot 5 that Oracle have</font>

452
00:20:19,230 --> 00:20:22,800
said<font color="#E5E5E5"> that they're</font><font color="#CCCCCC"> not going to</font><font color="#E5E5E5"> fix so</font>

453
00:20:20,640 --> 00:20:26,190
I've gone to<font color="#E5E5E5"> what one of</font><font color="#CCCCCC"> the talks</font>

454
00:20:22,800 --> 00:20:30,120
earlier actually Darren would know<font color="#CCCCCC"> about</font>

455
00:20:26,190 --> 00:20:32,730
this more the there's<font color="#E5E5E5"> been problems with</font>

456
00:20:30,120 --> 00:20:35,070
mitre not being able to<font color="#E5E5E5"> churn out</font><font color="#CCCCCC"> CVE</font>

457
00:20:32,730 --> 00:20:36,780
IDs quick enough I'm one of the few

458
00:20:35,070 --> 00:20:39,360
people who've had good experiences with

459
00:20:36,780 --> 00:20:41,700
mitre I've managed to you know I've sent

460
00:20:39,360 --> 00:20:43,050
them<font color="#E5E5E5"> a request for a bunch of CV IDs for</font>

461
00:20:41,700 --> 00:20:44,880
some issues<font color="#E5E5E5"> are found and they've</font>

462
00:20:43,050 --> 00:20:48,450
responded with a debt within a day and

463
00:20:44,880 --> 00:20:51,480
issued me with a bunch of<font color="#E5E5E5"> CV IDs so that</font>

464
00:20:48,450 --> 00:20:52,950
goes counter to what some other security

465
00:20:51,480 --> 00:20:56,300
researchers are unfortunately

466
00:20:52,950 --> 00:21:03,150
experiencing right now but just<font color="#E5E5E5"> a wee</font>

467
00:20:56,300 --> 00:21:07,830
aside<font color="#CCCCCC"> okay moving on to a business</font><font color="#E5E5E5"> suite</font>

468
00:21:03,150 --> 00:21:10,800
12<font color="#CCCCCC"> 2 and earlier again I spent roughly</font>

469
00:21:07,830 --> 00:21:16,230
about 80 hours doing a security

470
00:21:10,800 --> 00:21:20,370
assessment on it there are it so in

471
00:21:16,230 --> 00:21:27,090
certain respects there is a larger

472
00:21:20,370 --> 00:21:28,919
attack surface in in 12<font color="#CCCCCC"> too but some of</font>

473
00:21:27,090 --> 00:21:30,659
the key components have been stripped

474
00:21:28,920 --> 00:21:34,500
out so for example the<font color="#CCCCCC"> P article gateway</font>

475
00:21:30,660 --> 00:21:36,000
is no longer in business suite 12 which

476
00:21:34,500 --> 00:21:38,160
is<font color="#E5E5E5"> great because that removes a whole</font>

477
00:21:36,000 --> 00:21:40,500
bunch of attack surface but there's<font color="#E5E5E5"> a if</font>

478
00:21:38,160 --> 00:21:42,390
we<font color="#CCCCCC"> look at the number of servlets</font>

479
00:21:40,500 --> 00:21:44,220
there's about 80 servlets installed by

480
00:21:42,390 --> 00:21:47,400
default whereas there's about 16 in<font color="#E5E5E5"> 11</font>

481
00:21:44,220 --> 00:21:52,290
dot five so we've sort of shifted the

482
00:21:47,400 --> 00:21:54,090
focus of the attack surface there are at

483
00:21:52,290 --> 00:21:56,700
least two that<font color="#E5E5E5"> I know of javidi</font>

484
00:21:54,090 --> 00:22:00,240
serialization<font color="#E5E5E5"> issues basically they take</font>

485
00:21:56,700 --> 00:22:01,950
an input stream and then do a read

486
00:22:00,240 --> 00:22:04,169
object on it which allows us basically

487
00:22:01,950 --> 00:22:08,220
using some<font color="#CCCCCC"> Java gadgets</font>

488
00:22:04,169 --> 00:22:12,210
execute OS commands those are in the

489
00:22:08,220 --> 00:22:14,279
process of being<font color="#E5E5E5"> fixed there were eight</font>

490
00:22:12,210 --> 00:22:17,460
sequel injection issues summon servlets

491
00:22:14,279 --> 00:22:20,279
summoned SP files<font color="#CCCCCC"> a lost</font><font color="#E5E5E5"> count of the</font>

492
00:22:17,460 --> 00:22:21,600
cross-site scripting flaws and there's a

493
00:22:20,279 --> 00:22:23,580
whole bunch<font color="#E5E5E5"> of minor</font><font color="#CCCCCC"> whatnot minor</font>

494
00:22:21,600 --> 00:22:26,789
issues one offs here in there like

495
00:22:23,580 --> 00:22:28,769
cookie exposure we can we<font color="#E5E5E5"> can force the</font>

496
00:22:26,789 --> 00:22:30,720
<font color="#CCCCCC">the web server to make arbitrary get</font>

497
00:22:28,769 --> 00:22:33,480
requests to other web servers and in

498
00:22:30,720 --> 00:22:35,840
doing so bleak him from other

499
00:22:33,480 --> 00:22:40,200
information there's directory traversal

500
00:22:35,840 --> 00:22:43,519
<font color="#CCCCCC">XML external entities denial of service</font>

501
00:22:40,200 --> 00:22:47,159
and so on most of the issues<font color="#CCCCCC"> for</font>

502
00:22:43,519 --> 00:22:49,950
e-business suite 12 dot two were waiting

503
00:22:47,159 --> 00:22:52,049
for patches on still<font color="#E5E5E5"> unfortunately so</font>

504
00:22:49,950 --> 00:22:58,830
don't want to go into the<font color="#CCCCCC"> specifics of</font>

505
00:22:52,049 --> 00:23:01,049
what these<font color="#E5E5E5"> issues are so here's another</font>

506
00:22:58,830 --> 00:23:03,059
problem then this will come<font color="#CCCCCC"> up again</font>

507
00:23:01,049 --> 00:23:06,418
when we come to looking at securing

508
00:23:03,059 --> 00:23:08,789
ebusiness sweet<font color="#CCCCCC"> I've spent</font><font color="#E5E5E5"> a wee while</font>

509
00:23:06,419 --> 00:23:11,249
today looking<font color="#CCCCCC"> for many ways to skin a</font>

510
00:23:08,789 --> 00:23:14,869
cat a synonym and there's<font color="#E5E5E5"> nothing</font><font color="#CCCCCC"> subil</font>

511
00:23:11,249 --> 00:23:17,519
which is really ironic you know

512
00:23:14,869 --> 00:23:19,470
essentially one of one<font color="#CCCCCC"> of them let's</font>

513
00:23:17,519 --> 00:23:25,830
look at a specific sequel injection

514
00:23:19,470 --> 00:23:28,289
floor in the<font color="#E5E5E5"> bis AK rgn JSP JSP file</font>

515
00:23:25,830 --> 00:23:30,590
there is a simple sequel injection floor

516
00:23:28,289 --> 00:23:33,408
essentially it takes some user input and

517
00:23:30,590 --> 00:23:37,199
embeds it in a dynamic SQL statement and

518
00:23:33,409 --> 00:23:40,710
execute it<font color="#E5E5E5"> you can see if we that sent</font>

519
00:23:37,200 --> 00:23:45,840
27 there is<font color="#E5E5E5"> single quote and we with</font>

520
00:23:40,710 --> 00:23:49,259
<font color="#CCCCCC">piper character the letter A and enclose</font>

521
00:23:45,840 --> 00:23:52,199
the the with a double pipe and the

522
00:23:49,259 --> 00:23:54,629
<font color="#E5E5E5">single quote simple sequel injection we</font>

523
00:23:52,200 --> 00:23:56,159
rather than put sure we can put a

524
00:23:54,629 --> 00:23:59,070
different<font color="#E5E5E5"> function in there and have it</font>

525
00:23:56,159 --> 00:24:01,970
executes for us we'll<font color="#E5E5E5"> talk about</font>

526
00:23:59,070 --> 00:24:04,559
batching how it's not matching but

527
00:24:01,970 --> 00:24:07,470
Oracle doesn't match SQL statements but

528
00:24:04,559 --> 00:24:10,820
there's a neat trick to get around that

529
00:24:07,470 --> 00:24:12,859
so you can execute any SQL you want to

530
00:24:10,820 --> 00:24:17,370
we'll come back to that in a minute but

531
00:24:12,859 --> 00:24:19,710
<font color="#CCCCCC">the point is this this JSP farm</font>

532
00:24:17,370 --> 00:24:21,179
<font color="#CCCCCC">van would sequel injection so we might</font>

533
00:24:19,710 --> 00:24:23,700
look at that and<font color="#CCCCCC"> say well we could use a</font>

534
00:24:21,180 --> 00:24:27,180
mod rewrite or a location or a mud

535
00:24:23,700 --> 00:24:29,130
security directive to block access<font color="#CCCCCC"> to</font>

536
00:24:27,180 --> 00:24:32,580
that file if for whatever reason we

537
00:24:29,130 --> 00:24:34,920
can't delete it the problem is there are

538
00:24:32,580 --> 00:24:37,500
multiple ways to access that file<font color="#E5E5E5"> so one</font>

539
00:24:34,920 --> 00:24:39,830
of them is through using the RFS with

540
00:24:37,500 --> 00:24:43,559
the run function JSP file basically

541
00:24:39,830 --> 00:24:47,629
because the the<font color="#E5E5E5"> BIS I'll just call it</font>

542
00:24:43,559 --> 00:24:51,928
the best JSP farm that has an entry in

543
00:24:47,630 --> 00:24:58,290
the<font color="#CCCCCC"> F and deform functions table for the</font>

544
00:24:51,929 --> 00:25:02,190
corresponding function ID of<font color="#CCCCCC"> 110 91 so</font>

545
00:24:58,290 --> 00:25:05,639
we don't access the JSP page directly we

546
00:25:02,190 --> 00:25:09,270
can indirectly access it through<font color="#CCCCCC"> IRS JSP</font>

547
00:25:05,640 --> 00:25:11,100
so even if even if we block direct

548
00:25:09,270 --> 00:25:13,020
access using as I said a location or a

549
00:25:11,100 --> 00:25:14,520
mod rewrite directive we can still

550
00:25:13,020 --> 00:25:16,260
access that sequel injection floor by

551
00:25:14,520 --> 00:25:19,350
going<font color="#CCCCCC"> through our F dot JSP so we have</font>

552
00:25:16,260 --> 00:25:21,860
to<font color="#CCCCCC"> be wary of that another one oh and</font>

553
00:25:19,350 --> 00:25:24,389
again<font color="#E5E5E5"> if you if you want to block it via</font>

554
00:25:21,860 --> 00:25:28,379
<font color="#E5E5E5">rssp and you look for the function ID of</font>

555
00:25:24,390 --> 00:25:29,910
<font color="#CCCCCC">1109 one then be</font><font color="#E5E5E5"> careful of things like</font>

556
00:25:28,380 --> 00:25:34,559
<font color="#E5E5E5">leading zeros and so on that kind of</font>

557
00:25:29,910 --> 00:25:37,470
trick to<font color="#E5E5E5"> bypass the the prevention</font>

558
00:25:34,559 --> 00:25:40,889
mechanism<font color="#E5E5E5"> use another way of gaining</font>

559
00:25:37,470 --> 00:25:43,020
access to this<font color="#CCCCCC"> b is jess p file is</font>

560
00:25:40,890 --> 00:25:45,660
through JSP<font color="#CCCCCC"> forwards there's a whole</font>

561
00:25:43,020 --> 00:25:48,030
bunch<font color="#E5E5E5"> of</font><font color="#CCCCCC"> jsps</font><font color="#E5E5E5"> that take arbitrary user</font>

562
00:25:45,660 --> 00:25:52,110
input and use that as part of a JSP

563
00:25:48,030 --> 00:25:56,910
forward so in this case we've got one

564
00:25:52,110 --> 00:25:59,850
called qts cop<font color="#CCCCCC"> adds service JSP</font><font color="#E5E5E5"> and it</font>

565
00:25:56,910 --> 00:26:02,070
takes a parameter<font color="#CCCCCC"> QT 4 main file which</font>

566
00:25:59,850 --> 00:26:03,330
is<font color="#E5E5E5"> the name of our JSP page and once</font>

567
00:26:02,070 --> 00:26:06,570
that's included once that's been

568
00:26:03,330 --> 00:26:08,280
forwarded we can then just pass it the<font color="#E5E5E5"> P</font>

569
00:26:06,570 --> 00:26:09,870
search by parameter and again that

570
00:26:08,280 --> 00:26:13,080
<font color="#E5E5E5">executes so we don't necessarily</font>

571
00:26:09,870 --> 00:26:17,159
directly access the JSP page again we

572
00:26:13,080 --> 00:26:20,520
can indirectly access it through another

573
00:26:17,160 --> 00:26:21,929
JSP<font color="#E5E5E5"> and there's lots of them so again</font>

574
00:26:20,520 --> 00:26:23,850
<font color="#E5E5E5">then we have to be really wary of this</font>

575
00:26:21,929 --> 00:26:27,150
using things like a<font color="#E5E5E5"> location director to</font>

576
00:26:23,850 --> 00:26:29,299
directly block access is<font color="#E5E5E5"> not sufficient</font>

577
00:26:27,150 --> 00:26:30,860
we have to<font color="#E5E5E5"> be really careful on</font>

578
00:26:29,299 --> 00:26:33,230
on the way we approach this thing's so

579
00:26:30,860 --> 00:26:38,090
if you look<font color="#E5E5E5"> at all these files these are</font>

580
00:26:33,230 --> 00:26:45,769
examples where they take a user input

581
00:26:38,090 --> 00:26:48,590
and use it as<font color="#CCCCCC"> JSP Ford internally what's</font>

582
00:26:45,769 --> 00:26:51,230
<font color="#E5E5E5">an interesting thing about this</font><font color="#CCCCCC"> is well</font>

583
00:26:48,590 --> 00:26:53,418
in 11 dot<font color="#CCCCCC"> 5 you can only include you</font>

584
00:26:51,230 --> 00:26:56,149
could only afford two other JSP pages or

585
00:26:53,419 --> 00:26:59,659
HTML pages whereas in 12 2 and earlier

586
00:26:56,149 --> 00:27:01,729
you can request any kind<font color="#E5E5E5"> of content so</font>

587
00:26:59,659 --> 00:27:03,230
for example an<font color="#E5E5E5"> XML file or a log file or</font>

588
00:27:01,730 --> 00:27:05,179
whatever it happens to be so again we

589
00:27:03,230 --> 00:27:07,820
can bypass things like location

590
00:27:05,179 --> 00:27:10,279
directives and mod rewrites to gain

591
00:27:07,820 --> 00:27:16,970
access to two files we shouldn't have

592
00:27:10,279 --> 00:27:19,730
<font color="#CCCCCC">access to so anything in grapping</font><font color="#E5E5E5"> that</font>

593
00:27:16,970 --> 00:27:20,960
<font color="#E5E5E5">all the jazz peas for things like get</font>

594
00:27:19,730 --> 00:27:23,720
parameter that's being passed to a

595
00:27:20,960 --> 00:27:29,450
forward page will will find you these

596
00:27:23,720 --> 00:27:36,019
kind of attacks some database issues

597
00:27:29,450 --> 00:27:37,309
right there's a lot ok so don't want to

598
00:27:36,019 --> 00:27:40,779
go through them all now how cuz weird

599
00:27:37,309 --> 00:27:43,039
how we doing for time<font color="#CCCCCC"> ten minutes okay</font>

600
00:27:40,779 --> 00:27:47,570
<font color="#E5E5E5">we'll</font><font color="#CCCCCC"> talk</font><font color="#E5E5E5"> about some some really quick</font>

601
00:27:43,039 --> 00:27:49,460
ones ok so the apps user basically does

602
00:27:47,570 --> 00:27:52,249
you know he's<font color="#CCCCCC"> got so many</font><font color="#E5E5E5"> privileges on</font>

603
00:27:49,460 --> 00:27:54,759
in the database server but Oracle goes

604
00:27:52,249 --> 00:27:58,159
one step further and gives apps the

605
00:27:54,759 --> 00:28:01,159
execute privilege on the DBMS underscore

606
00:27:58,159 --> 00:28:03,649
sis underscore SQL package that

607
00:28:01,159 --> 00:28:07,820
essentially allows you to specify a

608
00:28:03,649 --> 00:28:10,189
<font color="#E5E5E5">username a user ID to the</font><font color="#CCCCCC"> the past as</font>

609
00:28:07,820 --> 00:28:12,590
user function that basically says if we

610
00:28:10,190 --> 00:28:14,659
<font color="#E5E5E5">pass 0 we can execute coders</font><font color="#CCCCCC"> assist</font>

611
00:28:12,590 --> 00:28:17,600
that's why i said earlier apps is one

612
00:28:14,659 --> 00:28:20,090
step away from sis DBA because we just

613
00:28:17,600 --> 00:28:23,689
essentially use the DBMS underscore

614
00:28:20,090 --> 00:28:28,639
underscore SQL package to HQ code as the

615
00:28:23,690 --> 00:28:32,359
<font color="#E5E5E5">SIS user from apps the reason apps has</font>

616
00:28:28,639 --> 00:28:33,590
the this privileges for one reason and

617
00:28:32,359 --> 00:28:37,039
one reason alone because<font color="#E5E5E5"> at some point</font>

618
00:28:33,590 --> 00:28:40,279
<font color="#CCCCCC">in the code there</font><font color="#E5E5E5"> is something that</font>

619
00:28:37,039 --> 00:28:41,980
executes all to user arbitrary user with

620
00:28:40,279 --> 00:28:46,510
<font color="#CCCCCC">such and such a password</font>

621
00:28:41,980 --> 00:28:49,929
so it strikes me as being rather silly

622
00:28:46,510 --> 00:28:53,260
that we don't give the apps user the

623
00:28:49,929 --> 00:28:55,120
author user privilege directly but

624
00:28:53,260 --> 00:28:56,530
rather give<font color="#CCCCCC"> it access to</font><font color="#E5E5E5"> DBMS underscore</font>

625
00:28:55,120 --> 00:28:59,590
sister underscore SQL that<font color="#E5E5E5"> allows them</font>

626
00:28:56,530 --> 00:29:00,940
<font color="#CCCCCC">to execute any SQL rather than restrict</font>

627
00:28:59,590 --> 00:29:02,320
it to the author user so that<font color="#CCCCCC"> was report</font>

628
00:29:00,940 --> 00:29:04,150
to our coins I'm not<font color="#E5E5E5"> sure</font><font color="#CCCCCC"> if they've</font>

629
00:29:02,320 --> 00:29:06,520
actually fixed no they have fix that in

630
00:29:04,150 --> 00:29:08,410
April they fix that in April so<font color="#CCCCCC"> apps no</font>

631
00:29:06,520 --> 00:29:12,150
longer should<font color="#E5E5E5"> be able to execute dbms</font>

632
00:29:08,410 --> 00:29:15,220
underscores<font color="#E5E5E5"> just underscore SQL in</font>

633
00:29:12,150 --> 00:29:19,240
certain versions of e-business suite 12

634
00:29:15,220 --> 00:29:22,450
X public has been given the execute

635
00:29:19,240 --> 00:29:25,030
sorry the index privilege on this sisal

636
00:29:22,450 --> 00:29:28,179
table now what<font color="#CCCCCC"> that</font><font color="#E5E5E5"> means is anyone that</font>

637
00:29:25,030 --> 00:29:31,059
<font color="#CCCCCC">can create</font><font color="#E5E5E5"> a function can create a</font>

638
00:29:28,179 --> 00:29:34,030
function based index on sis<font color="#E5E5E5"> dual and</font>

639
00:29:31,059 --> 00:29:36,190
execute code as the<font color="#CCCCCC"> sis user again</font>

640
00:29:34,030 --> 00:29:39,580
that's you know a really worrying

641
00:29:36,190 --> 00:29:42,970
situation to have that should again

642
00:29:39,580 --> 00:29:45,370
that's all being fixed now there there's

643
00:29:42,970 --> 00:29:51,669
a whole<font color="#E5E5E5"> bunch of issues where things</font>

644
00:29:45,370 --> 00:29:54,610
like some of VP DS virtual private

645
00:29:51,669 --> 00:29:59,830
databases<font color="#E5E5E5"> the function that's used to</font>

646
00:29:54,610 --> 00:30:02,979
<font color="#E5E5E5">specify the execution context has global</font>

647
00:29:59,830 --> 00:30:06,580
<font color="#E5E5E5">variables in use that we can essentially</font>

648
00:30:02,980 --> 00:30:09,790
set as a user and have that SQL execute

649
00:30:06,580 --> 00:30:11,049
via the global variable<font color="#E5E5E5"> anytime we call</font>

650
00:30:09,790 --> 00:30:15,790
something<font color="#E5E5E5"> in the individual private</font>

651
00:30:11,049 --> 00:30:17,639
database essentially there are we are

652
00:30:15,790 --> 00:30:20,980
spoke earlier about the index privilege

653
00:30:17,640 --> 00:30:23,770
it's a generic issue with with Oracle

654
00:30:20,980 --> 00:30:25,870
whereby you have if you have<font color="#CCCCCC"> the index</font>

655
00:30:23,770 --> 00:30:28,720
privilege<font color="#E5E5E5"> on another user's table you</font>

656
00:30:25,870 --> 00:30:31,449
can execute code as that user by

657
00:30:28,720 --> 00:30:33,160
creating a function based index and when

658
00:30:31,450 --> 00:30:35,260
someone queries that the function based

659
00:30:33,160 --> 00:30:36,970
index execute the function and that

660
00:30:35,260 --> 00:30:40,960
function executes says the owner of the

661
00:30:36,970 --> 00:30:43,660
table there are<font color="#E5E5E5"> 26 thousand instances of</font>

662
00:30:40,960 --> 00:30:47,169
the apps user have an index privilege<font color="#E5E5E5"> on</font>

663
00:30:43,660 --> 00:30:50,559
another user's table<font color="#E5E5E5"> 26,000 instances of</font>

664
00:30:47,169 --> 00:30:54,280
that particular vulnerability so does

665
00:30:50,559 --> 00:30:54,940
<font color="#E5E5E5">anybody get the reference to the margins</font>

666
00:30:54,280 --> 00:30:58,240
to now

667
00:30:54,940 --> 00:31:01,150
<font color="#E5E5E5">Fermat's Last Theorem I didn't even</font><font color="#CCCCCC"> get</font>

668
00:30:58,240 --> 00:31:04,270
<font color="#CCCCCC">a snack oh ok so we're running out of</font>

669
00:31:01,150 --> 00:31:08,740
<font color="#E5E5E5">time so we're going to really shoot</font>

670
00:31:04,270 --> 00:31:10,780
forward with this<font color="#CCCCCC"> ok you can</font><font color="#E5E5E5"> literally</font>

671
00:31:08,740 --> 00:31:13,690
make a ninety-nine point nine nine

672
00:31:10,780 --> 00:31:15,490
percent reduction in attack surface for

673
00:31:13,690 --> 00:31:16,720
e-business suite it's the greatest thing

674
00:31:15,490 --> 00:31:18,550
since sliced bread if you want to sell

675
00:31:16,720 --> 00:31:22,630
this to management and<font color="#E5E5E5"> you can show</font><font color="#CCCCCC"> them</font>

676
00:31:18,550 --> 00:31:23,680
this the the<font color="#CCCCCC"> this that that</font><font color="#E5E5E5"> the</font>

677
00:31:22,630 --> 00:31:25,960
improvements you'll make as far as

678
00:31:23,680 --> 00:31:29,320
security is concerned it's an easy win

679
00:31:25,960 --> 00:31:32,040
essentially so if<font color="#E5E5E5"> if we look at the j</font>

680
00:31:29,320 --> 00:31:35,980
<font color="#E5E5E5">ESPYs</font><font color="#CCCCCC"> and say we've got 15,000 jsps</font>

681
00:31:32,040 --> 00:31:38,320
let's remove them all except those which

682
00:31:35,980 --> 00:31:41,620
we need it in day-to-day business

683
00:31:38,320 --> 00:31:44,649
operations first off we we look at the

684
00:31:41,620 --> 00:31:46,330
the<font color="#E5E5E5"> access</font><font color="#CCCCCC"> lodge what what Jess peas are</font>

685
00:31:44,650 --> 00:31:47,980
we actually using on a day-to-day basis

686
00:31:46,330 --> 00:31:50,530
go back as far<font color="#E5E5E5"> as you as you possibly</font>

687
00:31:47,980 --> 00:31:52,150
can of course speak<font color="#CCCCCC"> to the business</font><font color="#E5E5E5"> apps</font>

688
00:31:50,530 --> 00:31:55,240
people as well the best apps people

689
00:31:52,150 --> 00:31:57,130
because they'll know what components

690
00:31:55,240 --> 00:31:58,890
they're actually you know required to

691
00:31:57,130 --> 00:32:02,230
use for their day-to-day business

692
00:31:58,890 --> 00:32:03,820
activities but it's not<font color="#E5E5E5"> enough just to</font>

693
00:32:02,230 --> 00:32:06,970
look at the access logs<font color="#E5E5E5"> because of</font>

694
00:32:03,820 --> 00:32:08,500
course as we mentioned<font color="#CCCCCC"> earlier access to</font>

695
00:32:06,970 --> 00:32:12,070
<font color="#CCCCCC">a lot of these things can be done</font>

696
00:32:08,500 --> 00:32:17,680
through<font color="#E5E5E5"> RF JSP so we need a list of jsps</font>

697
00:32:12,070 --> 00:32:20,080
that we request via our<font color="#CCCCCC"> f dot JSP</font><font color="#E5E5E5"> and</font>

698
00:32:17,680 --> 00:32:22,810
add those to the white list too and then

699
00:32:20,080 --> 00:32:25,629
of<font color="#CCCCCC"> course there's a whole</font><font color="#E5E5E5"> bunch of if we</font>

700
00:32:22,810 --> 00:32:27,669
<font color="#CCCCCC">have if we need to give access to food</font>

701
00:32:25,630 --> 00:32:29,710
recipe we need<font color="#E5E5E5"> to review review the</font>

702
00:32:27,670 --> 00:32:32,890
source code for food recipe to ensure

703
00:32:29,710 --> 00:32:34,840
that<font color="#E5E5E5"> it's not including or forwarding to</font>

704
00:32:32,890 --> 00:32:38,200
another JSP underneath the covers and

705
00:32:34,840 --> 00:32:40,840
then do that recursively of course in a

706
00:32:38,200 --> 00:32:44,830
recent engagement we went<font color="#E5E5E5"> from 15,000</font>

707
00:32:40,840 --> 00:32:47,530
jsps to just under 200 which is actually

708
00:32:44,830 --> 00:32:55,620
<font color="#E5E5E5">better than 9.99 per cent percent</font>

709
00:32:47,530 --> 00:32:59,200
reduction it's 9.99 999 and so on the

710
00:32:55,620 --> 00:33:02,260
servlets again went from a list of 80

711
00:32:59,200 --> 00:33:07,000
servlets down to two which is 97 point

712
00:33:02,260 --> 00:33:08,800
cent percent reduction specific to sorry

713
00:33:07,000 --> 00:33:10,480
<font color="#CCCCCC">i'm just rapidly flying through this</font>

714
00:33:08,800 --> 00:33:12,310
the slides will<font color="#CCCCCC"> be online later on if</font>

715
00:33:10,480 --> 00:33:17,110
you if you want to browse them at your

716
00:33:12,310 --> 00:33:18,550
leisure securing the LM top<font color="#CCCCCC"> 5 is pretty</font>

717
00:33:17,110 --> 00:33:20,350
much<font color="#E5E5E5"> the same as travel up to accept we</font>

718
00:33:18,550 --> 00:33:22,360
have to worry about the PRC called

719
00:33:20,350 --> 00:33:24,399
gateway again you<font color="#E5E5E5"> can do the same kind</font>

720
00:33:22,360 --> 00:33:27,510
<font color="#E5E5E5">of exercise look at what's in your</font>

721
00:33:24,400 --> 00:33:29,230
access logs what's being requested and

722
00:33:27,510 --> 00:33:32,590
disable everything else basically

723
00:33:29,230 --> 00:33:35,470
there's a column in<font color="#CCCCCC"> fnd enabled pl/sql</font>

724
00:33:32,590 --> 00:33:37,689
enabled it's either y or n essentially

725
00:33:35,470 --> 00:33:41,140
if it's n the users the attacker should

726
00:33:37,690 --> 00:33:44,190
not be able<font color="#E5E5E5"> to get access to it and</font>

727
00:33:41,140 --> 00:33:46,180
again we went down from<font color="#CCCCCC"> 702 6 so again</font>

728
00:33:44,190 --> 00:33:50,260
realizing a ninety-nine point nine nine

729
00:33:46,180 --> 00:33:52,030
percent reduction in attack surface so

730
00:33:50,260 --> 00:33:54,040
<font color="#CCCCCC">the</font><font color="#E5E5E5"> idea basically is and this is doable</font>

731
00:33:52,030 --> 00:33:58,090
I've done it you strip everything down

732
00:33:54,040 --> 00:33:59,800
and review what's left use mod rewrite

733
00:33:58,090 --> 00:34:01,570
and<font color="#E5E5E5"> much security to protect everything</font>

734
00:33:59,800 --> 00:34:04,440
else don't use location directors

735
00:34:01,570 --> 00:34:07,780
because<font color="#E5E5E5"> Apache are deprecating them and</font>

736
00:34:04,440 --> 00:34:09,130
one<font color="#CCCCCC"> of the real benefits you want or one</font>

737
00:34:07,780 --> 00:34:10,179
of the real improvements you can make to

738
00:34:09,130 --> 00:34:12,310
this is rather than just leaving people

739
00:34:10,179 --> 00:34:13,870
<font color="#E5E5E5">in the dark if something does go wrong</font>

740
00:34:12,310 --> 00:34:15,460
if<font color="#CCCCCC"> you strip all this stuff</font><font color="#E5E5E5"> out and one</font>

741
00:34:13,870 --> 00:34:17,529
of the biz apps guys does actually

742
00:34:15,460 --> 00:34:20,350
require access to a specific page we

743
00:34:17,530 --> 00:34:22,929
leave a 404 explaining what the

744
00:34:20,350 --> 00:34:24,520
situation is go to you know file a

745
00:34:22,929 --> 00:34:30,760
support request to have<font color="#E5E5E5"> the file very</font>

746
00:34:24,520 --> 00:34:33,810
enabled and so on so<font color="#CCCCCC"> we've got about two</font>

747
00:34:30,760 --> 00:34:35,830
minutes for questions if there are any

748
00:34:33,810 --> 00:34:38,230
we<font color="#CCCCCC"> don't</font><font color="#E5E5E5"> have any questions I did have</font>

749
00:34:35,830 --> 00:34:40,270
one myself tram and that is<font color="#E5E5E5"> kind of</font>

750
00:34:38,230 --> 00:34:43,750
<font color="#E5E5E5">what's your take the eigen I like</font>

751
00:34:40,270 --> 00:34:46,540
<font color="#E5E5E5">compare the whole Oracle too much the</font>

752
00:34:43,750 --> 00:34:50,469
sequel server to mysql what is yours

753
00:34:46,540 --> 00:34:54,719
going to say use one yourself what is

754
00:34:50,469 --> 00:34:56,830
your like a sentence sequel server rocks

755
00:34:54,719 --> 00:34:58,330
<font color="#E5E5E5">Microsoft sequence of rocks yeah if you</font>

756
00:34:56,830 --> 00:34:59,620
look at<font color="#CCCCCC"> the number of floors</font><font color="#E5E5E5"> that have</font>

757
00:34:58,330 --> 00:35:03,100
been found in sequencer I want<font color="#E5E5E5"> to go</font>

758
00:34:59,620 --> 00:35:07,500
back actually to sequence over<font color="#E5E5E5"> 2000 who</font>

759
00:35:03,100 --> 00:35:10,299
remembers slammer here so slammer was

760
00:35:07,500 --> 00:35:13,270
based upon some of the code that I

761
00:35:10,300 --> 00:35:16,030
presented in july 2002<font color="#CCCCCC"> at black hat</font>

762
00:35:13,270 --> 00:35:19,600
<font color="#E5E5E5">security briefings in</font><font color="#CCCCCC"> las vegas and it</font>

763
00:35:16,030 --> 00:35:21,850
was a real problem obviously<font color="#E5E5E5"> you know</font>

764
00:35:19,600 --> 00:35:22,210
took down certain parts of the internet

765
00:35:21,850 --> 00:35:24,549
<font color="#CCCCCC">and</font><font color="#E5E5E5"> so</font>

766
00:35:22,210 --> 00:35:27,310
but the<font color="#E5E5E5"> point is that and a few other</font>

767
00:35:24,550 --> 00:35:28,839
issues myself says a cerrado Chris

768
00:35:27,310 --> 00:35:30,250
Hanley and a few other people were

769
00:35:28,839 --> 00:35:32,410
really bashing at sequence<font color="#CCCCCC"> over at the</font>

770
00:35:30,250 --> 00:35:34,390
time looking for looking<font color="#CCCCCC"> for</font><font color="#E5E5E5"> flaws</font>

771
00:35:32,410 --> 00:35:36,279
essentially and within the space of a

772
00:35:34,390 --> 00:35:37,509
few months<font color="#E5E5E5"> we'd reported 26 to Microsoft</font>

773
00:35:36,280 --> 00:35:41,260
and Microsoft<font color="#CCCCCC"> were getting</font><font color="#E5E5E5"> this fixed</font>

774
00:35:37,510 --> 00:35:43,990
but<font color="#E5E5E5"> after slammer and those kind of</font>

775
00:35:41,260 --> 00:35:48,250
episodes Microsoft was in the process of

776
00:35:43,990 --> 00:35:49,868
<font color="#CCCCCC">developing sequel server 2005 and they</font>

777
00:35:48,250 --> 00:35:52,030
<font color="#E5E5E5">basically took everybody off secret</font>

778
00:35:49,869 --> 00:35:53,950
server 2005 development went back to

779
00:35:52,030 --> 00:35:55,510
sequel server 2000 code and did a

780
00:35:53,950 --> 00:35:57,520
massive security review and fixed all

781
00:35:55,510 --> 00:35:59,619
the code up then they went<font color="#E5E5E5"> back</font><font color="#CCCCCC"> to</font>

782
00:35:57,520 --> 00:36:03,940
sequel server 2005 and did the<font color="#CCCCCC"> same</font>

783
00:35:59,619 --> 00:36:05,349
exercise in the<font color="#CCCCCC"> years between 2005 and</font>

784
00:36:03,940 --> 00:36:08,080
now I<font color="#CCCCCC"> think there have been eight</font>

785
00:36:05,349 --> 00:36:10,859
security flaws that would be classed as

786
00:36:08,080 --> 00:36:15,339
<font color="#E5E5E5">high</font><font color="#CCCCCC"> risk to critical in sequel server</font>

787
00:36:10,859 --> 00:36:18,190
2005 for that many is<font color="#E5E5E5"> 11 years that's an</font>

788
00:36:15,339 --> 00:36:19,210
outstanding record and it's microsoft

789
00:36:18,190 --> 00:36:21,820
sequel server is<font color="#CCCCCC"> the poster child</font>

790
00:36:19,210 --> 00:36:27,040
essentially for microsoft's security

791
00:36:21,820 --> 00:36:29,200
development lifecycle sdl<font color="#CCCCCC"> okay maybe</font>

792
00:36:27,040 --> 00:36:30,190
their browsers<font color="#CCCCCC"> stuffs not so great but</font>

793
00:36:29,200 --> 00:36:33,098
if you<font color="#E5E5E5"> look at their service stuff</font>

794
00:36:30,190 --> 00:36:35,740
they've done<font color="#CCCCCC"> a really great job oracle</font>

795
00:36:33,099 --> 00:36:37,540
on the other hand are fixing every three

796
00:36:35,740 --> 00:36:40,229
months critical flaws in the database

797
00:36:37,540 --> 00:36:42,580
server still there was a period where

798
00:36:40,230 --> 00:36:44,349
you know they look like they were

799
00:36:42,580 --> 00:36:46,390
<font color="#E5E5E5">telling off but the numbers</font><font color="#CCCCCC"> have</font>

800
00:36:44,349 --> 00:36:50,170
actually started<font color="#CCCCCC"> going back up again so</font>

801
00:36:46,390 --> 00:36:52,000
in<font color="#E5E5E5"> an answer to</font><font color="#CCCCCC"> the question which state</font>

802
00:36:50,170 --> 00:36:53,770
based server do<font color="#CCCCCC"> I think is</font><font color="#E5E5E5"> best it's my</font>

803
00:36:52,000 --> 00:36:55,660
personal opinion that's microsoft SQL

804
00:36:53,770 --> 00:36:57,280
server is<font color="#CCCCCC"> the strongest as far as</font>

805
00:36:55,660 --> 00:36:58,930
<font color="#E5E5E5">securities concern but not necessarily</font>

806
00:36:57,280 --> 00:37:01,240
features and let's face it at the<font color="#E5E5E5"> end of</font>

807
00:36:58,930 --> 00:37:02,830
<font color="#E5E5E5">the day the business is what's the</font>

808
00:37:01,240 --> 00:37:03,868
important you<font color="#E5E5E5"> know is the most important</font>

809
00:37:02,830 --> 00:37:12,220
<font color="#E5E5E5">thing and if they've got the features</font>

810
00:37:03,869 --> 00:37:14,230
yep well the last time i looked at my

811
00:37:12,220 --> 00:37:15,970
SQL i found a format string bug and a

812
00:37:14,230 --> 00:37:17,369
buffer<font color="#E5E5E5"> overflow within about two lines</font>

813
00:37:15,970 --> 00:37:20,980
<font color="#E5E5E5">of code but that was a long</font><font color="#CCCCCC"> time ago</font>

814
00:37:17,369 --> 00:37:23,230
2000 2004 and i thought no i don't want

815
00:37:20,980 --> 00:37:25,330
to touch that because i had other

816
00:37:23,230 --> 00:37:26,680
projects on you know it's there's

817
00:37:25,330 --> 00:37:29,980
there's been so many issues<font color="#E5E5E5"> in the past</font>

818
00:37:26,680 --> 00:37:32,348
with my<font color="#CCCCCC"> MySQL things like you set a flag</font>

819
00:37:29,980 --> 00:37:34,180
and only one bite of the password is

820
00:37:32,349 --> 00:37:35,830
checked you know during authentication

821
00:37:34,180 --> 00:37:37,690
just things<font color="#CCCCCC"> like that it's</font>

822
00:37:35,830 --> 00:37:39,250
it's<font color="#E5E5E5"> probably a lot better these days</font>

823
00:37:37,690 --> 00:37:41,800
but I've<font color="#E5E5E5"> not had an opportunity to do a</font>

824
00:37:39,250 --> 00:38:17,350
proper code review since then there was

825
00:37:41,800 --> 00:38:19,510
a question here yep I'm not going to

826
00:38:17,350 --> 00:38:21,700
look at<font color="#CCCCCC"> SAAP simply because I've got it</font>

827
00:38:19,510 --> 00:38:23,410
enough so I've got<font color="#CCCCCC"> to</font><font color="#E5E5E5"> two young children</font>

828
00:38:21,700 --> 00:38:25,180
and<font color="#E5E5E5"> they take up all my spare time right</font>

829
00:38:23,410 --> 00:38:26,859
now I used to be where I<font color="#E5E5E5"> used to be in</font>

830
00:38:25,180 --> 00:38:28,330
my spare time used to<font color="#E5E5E5"> hack you know and</font>

831
00:38:26,860 --> 00:38:33,430
have fun with<font color="#E5E5E5"> this stuff but now my kids</font>

832
00:38:28,330 --> 00:38:36,460
<font color="#E5E5E5">you know I've changed all that the in</font>

833
00:38:33,430 --> 00:38:39,009
terms of the patching question it's not

834
00:38:36,460 --> 00:38:40,660
uncommon to see people who are six

835
00:38:39,010 --> 00:38:44,080
months behind on patches you know they

836
00:38:40,660 --> 00:38:46,120
what they want to wait for<font color="#E5E5E5"> you know they</font>

837
00:38:44,080 --> 00:38:50,500
have a twice-yearly pat cycle and

838
00:38:46,120 --> 00:38:54,520
they'll install a patch from not<font color="#CCCCCC"> I'm not</font>

839
00:38:50,500 --> 00:38:55,990
<font color="#CCCCCC">going</font><font color="#E5E5E5"> to mention any names but they</font>

840
00:38:54,520 --> 00:38:59,320
might install say for example the

841
00:38:55,990 --> 00:39:00,970
October 2015 patch today you know so

842
00:38:59,320 --> 00:39:02,530
that they're behind but they want to

843
00:39:00,970 --> 00:39:04,180
give the landscape a chance to settle

844
00:39:02,530 --> 00:39:05,500
down<font color="#E5E5E5"> and see if there's anything wrong</font>

845
00:39:04,180 --> 00:39:07,600
with the patch<font color="#E5E5E5"> because if they install</font>

846
00:39:05,500 --> 00:39:09,430
the April patch now there might<font color="#E5E5E5"> be a</font>

847
00:39:07,600 --> 00:39:11,620
reissue of the patch and all that work

848
00:39:09,430 --> 00:39:15,790
has gone to not so typically what I see

849
00:39:11,620 --> 00:39:18,190
in in the industry is people using older

850
00:39:15,790 --> 00:39:20,529
patches because they're more stable I

851
00:39:18,190 --> 00:39:25,390
don't see very many people<font color="#E5E5E5"> not patching</font>

852
00:39:20,530 --> 00:39:29,910
their stuff though these days and if if

853
00:39:25,390 --> 00:39:31,900
they're not only you know getting yeah

854
00:39:29,910 --> 00:39:35,649
strongest recommendation i can make its

855
00:39:31,900 --> 00:39:39,640
patchy stuff and if<font color="#E5E5E5"> someone like the CFO</font>

856
00:39:35,650 --> 00:39:41,110
is is pushing against that then see in

857
00:39:39,640 --> 00:39:44,020
<font color="#CCCCCC">australian slightly different</font><font color="#E5E5E5"> because</font>

858
00:39:41,110 --> 00:39:46,300
you don't have<font color="#CCCCCC"> sox compliance in America</font>

859
00:39:44,020 --> 00:39:48,400
a lot of the Sox stuff is stored in<font color="#E5E5E5"> a</font>

860
00:39:46,300 --> 00:39:50,050
database server in any business sweet

861
00:39:48,400 --> 00:39:52,390
stuff and they have to certify

862
00:39:50,050 --> 00:39:53,980
the financial records say no one's

863
00:39:52,390 --> 00:39:57,250
tampered with this stuff but if I can

864
00:39:53,980 --> 00:39:59,020
drive<font color="#E5E5E5"> a bus through and and tamper with</font>

865
00:39:57,250 --> 00:40:02,230
those records without anyone knowing

866
00:39:59,020 --> 00:40:03,610
then it's really difficult when it comes

867
00:40:02,230 --> 00:40:05,380
to<font color="#E5E5E5"> such compliance but because that's</font>

868
00:40:03,610 --> 00:40:07,720
<font color="#E5E5E5">not necessary there's no driver in</font>

869
00:40:05,380 --> 00:40:09,940
Australia to patch because there's not

870
00:40:07,720 --> 00:40:12,790
<font color="#CCCCCC">naturally the compliance aspect but</font>

871
00:40:09,940 --> 00:40:14,590
certainly there is an America sorry<font color="#E5E5E5"> that</font>

872
00:40:12,790 --> 00:40:22,210
was a long rambling answer to your

873
00:40:14,590 --> 00:40:29,880
question but I hope I covered it numbers

874
00:40:22,210 --> 00:40:29,880
okay anyone else job hey how you don't

875
00:40:30,420 --> 00:40:35,410
just interested<font color="#E5E5E5"> in your thoughts on</font>

876
00:40:33,040 --> 00:40:39,400
cyber insurance so i think that<font color="#E5E5E5"> is a</font>

877
00:40:35,410 --> 00:40:43,600
relatively new player in the game and if

878
00:40:39,400 --> 00:40:47,350
you know a big business using sweet<font color="#E5E5E5"> a vs</font>

879
00:40:43,600 --> 00:40:49,600
sweet bee vs sweet see<font color="#CCCCCC"> i conceded in the</font>

880
00:40:47,350 --> 00:40:51,970
span of about<font color="#CCCCCC"> 10 years of</font><font color="#E5E5E5"> service is not</font>

881
00:40:49,600 --> 00:40:55,540
going to happen quickly but your

882
00:40:51,970 --> 00:40:58,140
insurance premiums may start to vary do

883
00:40:55,540 --> 00:41:01,630
you have any thoughts on that I do not

884
00:40:58,140 --> 00:41:05,109
it's the simple answer I know it's that

885
00:41:01,630 --> 00:41:06,910
I've got a few<font color="#CCCCCC"> friends like you know</font>

886
00:41:05,110 --> 00:41:08,530
much who's looking at this whole you

887
00:41:06,910 --> 00:41:11,649
know cyber insurance and underwriting

888
00:41:08,530 --> 00:41:12,880
labs and stuff but I've had got no

889
00:41:11,650 --> 00:41:16,360
experience with that<font color="#E5E5E5"> so I don't waste</font>

890
00:41:12,880 --> 00:41:17,710
your time<font color="#E5E5E5"> with a crackpot answer and on</font>

891
00:41:16,360 --> 00:41:20,250
that note<font color="#E5E5E5"> we'll finish up thank you very</font>

892
00:41:17,710 --> 00:41:24,430
much of a wrong David around applause

893
00:41:20,250 --> 00:41:28,240
thank you thanks guys<font color="#CCCCCC"> and we'll</font><font color="#E5E5E5"> break</font>

894
00:41:24,430 --> 00:41:29,470
for lunch don't forget to leave<font color="#E5E5E5"> feedback</font>

895
00:41:28,240 --> 00:41:31,799
and we'll<font color="#E5E5E5"> have the speed debate after</font>

896
00:41:29,470 --> 00:41:31,799
lunch

