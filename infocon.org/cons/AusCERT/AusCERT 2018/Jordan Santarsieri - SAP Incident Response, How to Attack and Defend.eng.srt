1
00:00:00,100 --> 00:00:03,179
[Applause]

2
00:00:01,070 --> 00:00:06,299
thank you thank you everyone

3
00:00:03,179 --> 00:00:08,370
well welcome to sa<font color="#E5E5E5"> Benson response</font>

4
00:00:06,299 --> 00:00:10,889
<font color="#CCCCCC">real-life examples on how to attack and</font>

5
00:00:08,370 --> 00:00:12,780
defend<font color="#E5E5E5"> before we start let</font><font color="#CCCCCC"> me tell you</font>

6
00:00:10,889 --> 00:00:15,389
something this<font color="#CCCCCC"> is</font><font color="#E5E5E5"> not like a fairy</font><font color="#CCCCCC"> tale</font>

7
00:00:12,780 --> 00:00:17,820
<font color="#E5E5E5">story this is not a kind</font><font color="#CCCCCC"> of story with</font>

8
00:00:15,389 --> 00:00:19,590
the good guy always win in<font color="#E5E5E5"> the end</font><font color="#CCCCCC"> what</font>

9
00:00:17,820 --> 00:00:22,890
you're going to see here<font color="#CCCCCC"> the real</font>

10
00:00:19,590 --> 00:00:25,350
examples of my experience doing SMB

11
00:00:22,890 --> 00:00:29,960
forensic analysis<font color="#E5E5E5"> this is how the market</font>

12
00:00:25,350 --> 00:00:33,420
in terms of<font color="#CCCCCC"> ASAP security it is reiner</font>

13
00:00:29,960 --> 00:00:35,309
<font color="#E5E5E5">so this is a brief disclaimer</font><font color="#CCCCCC"> no one</font>

14
00:00:33,420 --> 00:00:36,320
reads it anyway but it's very important

15
00:00:35,309 --> 00:00:38,760
<font color="#E5E5E5">to</font><font color="#CCCCCC"> put it out</font><font color="#E5E5E5"> there</font>

16
00:00:36,320 --> 00:00:41,370
Who am I my name is Jordan<font color="#E5E5E5"> central</font>

17
00:00:38,760 --> 00:00:43,920
<font color="#E5E5E5">cheering my background originally was</font>

18
00:00:41,370 --> 00:00:46,050
<font color="#E5E5E5">general penetration tester like when I</font>

19
00:00:43,920 --> 00:00:50,129
<font color="#E5E5E5">lead assessment</font><font color="#CCCCCC"> all the</font><font color="#E5E5E5"> it's</font><font color="#CCCCCC"> explained</font>

20
00:00:46,050 --> 00:00:52,769
writing and slowly starting from 2008<font color="#CCCCCC"> I</font>

21
00:00:50,129 --> 00:00:55,110
started<font color="#CCCCCC"> working</font><font color="#E5E5E5"> on this type of big</font>

22
00:00:52,770 --> 00:00:58,370
systems called<font color="#E5E5E5"> earpiece</font><font color="#CCCCCC"> making a lot of</font>

23
00:00:55,110 --> 00:01:01,559
<font color="#CCCCCC">focus in s IP and also in Oregon as well</font>

24
00:00:58,370 --> 00:01:03,839
<font color="#E5E5E5">since then I had the pleasure</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> work</font>

25
00:01:01,559 --> 00:01:05,700
with<font color="#E5E5E5"> almost like</font><font color="#CCCCCC"> a thousand</font><font color="#E5E5E5"> S&P</font>

26
00:01:03,840 --> 00:01:07,650
implementations worldwide you name it

27
00:01:05,700 --> 00:01:11,400
like<font color="#E5E5E5"> big companies</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> their United</font>

28
00:01:07,650 --> 00:01:15,770
States Europe military institutions<font color="#E5E5E5"> and</font>

29
00:01:11,400 --> 00:01:18,600
also<font color="#CCCCCC"> with a lot</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> OMGs in the planet I</font>

30
00:01:15,770 --> 00:01:20,789
work at<font color="#CCCCCC"> Bitzer I'm actually one of</font><font color="#E5E5E5"> the</font>

31
00:01:18,600 --> 00:01:23,548
founders of mixer<font color="#CCCCCC"> where we specialize in</font>

32
00:01:20,790 --> 00:01:26,790
<font color="#CCCCCC">sa be an Oracle</font><font color="#E5E5E5"> we have a lot of</font>

33
00:01:23,549 --> 00:01:29,100
customers<font color="#E5E5E5"> fortune 500</font><font color="#CCCCCC"> and we do a</font><font color="#E5E5E5"> lot of</font>

34
00:01:26,790 --> 00:01:32,280
stuff we do penetration testing<font color="#CCCCCC"> analysis</font>

35
00:01:29,100 --> 00:01:37,500
when all<font color="#E5E5E5"> its and what this chart bring</font>

36
00:01:32,280 --> 00:01:40,439
us forensic investigations by the way

37
00:01:37,500 --> 00:01:42,750
we're now expanding to<font color="#CCCCCC"> asia-pacific we</font>

38
00:01:40,439 --> 00:01:45,179
have a big core in all the Americas but

39
00:01:42,750 --> 00:01:48,689
<font color="#E5E5E5">now we are</font><font color="#CCCCCC"> expanding to</font><font color="#E5E5E5"> Asia Pacific as</font>

40
00:01:45,180 --> 00:01:51,119
well so this<font color="#E5E5E5"> is the</font><font color="#CCCCCC"> agenda that I have</font>

41
00:01:48,689 --> 00:01:53,100
prepared for you<font color="#CCCCCC"> guys first</font><font color="#E5E5E5"> it will be</font>

42
00:01:51,119 --> 00:01:55,259
<font color="#E5E5E5">like a brief introduction very very</font>

43
00:01:53,100 --> 00:01:57,929
brief introduction in just for the sake

44
00:01:55,259 --> 00:02:01,020
of time to s IP<font color="#E5E5E5"> so we can all be at the</font>

45
00:01:57,930 --> 00:02:03,780
<font color="#E5E5E5">same level</font><font color="#CCCCCC"> and something funny take the</font>

46
00:02:01,020 --> 00:02:05,460
<font color="#CCCCCC">eSAB</font><font color="#E5E5E5"> word out of it I can prepare for</font>

47
00:02:03,780 --> 00:02:07,740
<font color="#E5E5E5">you three different misconceptions that</font>

48
00:02:05,460 --> 00:02:09,929
I always<font color="#E5E5E5"> hear about maybe you hear about</font>

49
00:02:07,740 --> 00:02:12,900
<font color="#E5E5E5">those misconceptions to again take the</font>

50
00:02:09,929 --> 00:02:13,709
<font color="#CCCCCC">words AP out</font><font color="#E5E5E5"> first</font><font color="#CCCCCC"> misconception that I</font>

51
00:02:12,900 --> 00:02:15,900
have for<font color="#E5E5E5"> you</font>

52
00:02:13,709 --> 00:02:19,590
we can never<font color="#E5E5E5"> have an</font><font color="#CCCCCC"> sob</font><font color="#E5E5E5"> security</font>

53
00:02:15,900 --> 00:02:21,659
incident before<font color="#CCCCCC"> another misconception</font><font color="#E5E5E5"> we</font>

54
00:02:19,590 --> 00:02:24,540
thought that ACP<font color="#E5E5E5"> sir attacks were</font><font color="#CCCCCC"> not</font>

55
00:02:21,659 --> 00:02:27,899
real<font color="#CCCCCC"> and the final one the</font><font color="#E5E5E5"> probability</font>

56
00:02:24,540 --> 00:02:29,069
of an<font color="#E5E5E5"> ACP</font><font color="#CCCCCC"> sir attack is low</font><font color="#E5E5E5"> okay so</font>

57
00:02:27,900 --> 00:02:33,329
let's<font color="#CCCCCC"> just start with</font><font color="#E5E5E5"> a brief</font>

58
00:02:29,069 --> 00:02:35,730
introduction to<font color="#CCCCCC"> us ap the first question</font>

59
00:02:33,329 --> 00:02:39,359
<font color="#CCCCCC">that you might be having is</font><font color="#E5E5E5"> okay so what</font>

60
00:02:35,730 --> 00:02:41,608
is a CP CP is actually an acronym<font color="#E5E5E5"> and it</font>

61
00:02:39,359 --> 00:02:43,709
stands for assistance applications and

62
00:02:41,609 --> 00:02:46,169
products in data processing<font color="#CCCCCC"> so no wonder</font>

63
00:02:43,709 --> 00:02:48,439
<font color="#E5E5E5">why</font><font color="#CCCCCC"> choose</font><font color="#E5E5E5"> people call it a CP it's</font>

64
00:02:46,169 --> 00:02:52,500
actually a<font color="#E5E5E5"> German company was founded in</font>

65
00:02:48,439 --> 00:02:53,879
1972<font color="#E5E5E5"> but X IBM employees</font><font color="#CCCCCC"> another</font><font color="#E5E5E5"> if you</font>

66
00:02:52,500 --> 00:02:55,919
know the<font color="#E5E5E5"> history but those guys were</font>

67
00:02:53,879 --> 00:02:59,849
<font color="#CCCCCC">working together creating an inner P</font><font color="#E5E5E5"> for</font>

68
00:02:55,919 --> 00:03:01,919
actually IBM<font color="#E5E5E5"> don't I don't</font><font color="#CCCCCC"> know why</font><font color="#E5E5E5"> that</font>

69
00:02:59,849 --> 00:03:04,798
project<font color="#E5E5E5"> gets canceled and they</font><font color="#CCCCCC"> decide to</font>

70
00:03:01,919 --> 00:03:06,389
<font color="#E5E5E5">leave IBM to create their own ERP and</font>

71
00:03:04,799 --> 00:03:08,669
let me<font color="#E5E5E5"> tell you that</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> was one</font><font color="#CCCCCC"> of the</font>

72
00:03:06,389 --> 00:03:09,180
most<font color="#CCCCCC"> successful business decisions in</font>

73
00:03:08,669 --> 00:03:11,849
the war

74
00:03:09,180 --> 00:03:13,680
why because<font color="#E5E5E5"> s AP is huge is everywhere</font>

75
00:03:11,849 --> 00:03:17,369
<font color="#E5E5E5">look at these numbers that I prepared</font>

76
00:03:13,680 --> 00:03:21,930
for<font color="#CCCCCC"> you</font><font color="#E5E5E5"> they have</font><font color="#CCCCCC"> more</font><font color="#E5E5E5"> than 88,000</font>

77
00:03:17,370 --> 00:03:25,290
customers worldwide<font color="#CCCCCC"> they are present</font><font color="#E5E5E5"> in</font>

78
00:03:21,930 --> 00:03:29,609
more<font color="#CCCCCC"> than 80 countries so</font><font color="#E5E5E5"> there and they</font>

79
00:03:25,290 --> 00:03:32,728
totally dominate the market<font color="#CCCCCC"> 87%</font><font color="#E5E5E5"> of the</font>

80
00:03:29,609 --> 00:03:39,930
biggest companies out there<font color="#E5E5E5"> the Fortune</font>

81
00:03:32,729 --> 00:03:42,180
Global 2000 are using<font color="#E5E5E5"> s AP I know that</font>

82
00:03:39,930 --> 00:03:43,919
in the SI p war is kind of confusing

83
00:03:42,180 --> 00:03:46,680
<font color="#CCCCCC">some people even call it like</font>

84
00:03:43,919 --> 00:03:48,569
Stephanie's<font color="#CCCCCC"> but it's really</font><font color="#E5E5E5"> confusing</font>

85
00:03:46,680 --> 00:03:52,859
<font color="#CCCCCC">when you start</font><font color="#E5E5E5"> hearing all those names</font>

86
00:03:48,569 --> 00:03:54,839
like ear<font color="#E5E5E5"> PPI CRM it's kinda hard to keep</font>

87
00:03:52,859 --> 00:03:56,639
up<font color="#CCCCCC"> with those names</font><font color="#E5E5E5"> well for you to</font>

88
00:03:54,840 --> 00:04:00,180
understand<font color="#E5E5E5"> better I</font><font color="#CCCCCC"> can repair like a</font>

89
00:03:56,639 --> 00:04:02,639
brief division of both from one side you

90
00:04:00,180 --> 00:04:05,879
will have<font color="#CCCCCC"> the</font><font color="#E5E5E5"> enterprise solutions those</font>

91
00:04:02,639 --> 00:04:09,569
systems are the ones<font color="#CCCCCC"> that your workers</font>

92
00:04:05,879 --> 00:04:12,209
like<font color="#CCCCCC"> the HR people financial guys will</font>

93
00:04:09,569 --> 00:04:14,849
be<font color="#CCCCCC"> learning</font><font color="#E5E5E5"> every</font><font color="#CCCCCC"> day to do their work</font>

94
00:04:12,209 --> 00:04:17,099
and<font color="#E5E5E5"> from the other side</font><font color="#CCCCCC"> you have the</font>

95
00:04:14,849 --> 00:04:20,488
<font color="#CCCCCC">supporting solutions those</font><font color="#E5E5E5"> solutions</font>

96
00:04:17,099 --> 00:04:22,108
will support the enterprise ones the

97
00:04:20,488 --> 00:04:24,900
difference here<font color="#E5E5E5"> on the supporting</font>

98
00:04:22,108 --> 00:04:27,510
solutions<font color="#E5E5E5"> is that you won't have a lot</font>

99
00:04:24,900 --> 00:04:30,979
<font color="#CCCCCC">of</font><font color="#E5E5E5"> end customers most of the</font>

100
00:04:27,510 --> 00:04:33,599
<font color="#E5E5E5">we'll be logging in there are technical</font>

101
00:04:30,980 --> 00:04:36,450
so coming back to<font color="#E5E5E5"> this enterprise</font>

102
00:04:33,600 --> 00:04:39,900
<font color="#E5E5E5">solutions we are going to start hearing</font>

103
00:04:36,450 --> 00:04:42,210
a lot one small word called<font color="#CCCCCC"> netweaver</font>

104
00:04:39,900 --> 00:04:44,250
<font color="#CCCCCC">we're going to see later what NAND</font>

105
00:04:42,210 --> 00:04:46,530
<font color="#CCCCCC">Weaver means but just having in your</font>

106
00:04:44,250 --> 00:04:48,570
mind all the enterprise solutions that I

107
00:04:46,530 --> 00:04:53,130
have prepared here for you<font color="#CCCCCC"> are net</font>

108
00:04:48,570 --> 00:04:55,170
<font color="#E5E5E5">Weaver base that is the opposite for</font><font color="#CCCCCC"> the</font>

109
00:04:53,130 --> 00:04:58,350
supporting solutions except for this<font color="#CCCCCC"> I</font>

110
00:04:55,170 --> 00:05:01,020
<font color="#CCCCCC">Beecher see those are not netweaver base</font>

111
00:04:58,350 --> 00:05:02,700
<font color="#E5E5E5">basically</font><font color="#CCCCCC"> says IP that</font><font color="#E5E5E5"> you want to buy</font>

112
00:05:01,020 --> 00:05:04,409
<font color="#CCCCCC">different pieces of technologies and</font>

113
00:05:02,700 --> 00:05:09,570
start integrating those technologies

114
00:05:04,410 --> 00:05:10,980
between the ecosystem of SA P so what is

115
00:05:09,570 --> 00:05:14,340
this<font color="#CCCCCC"> netweaver time</font><font color="#E5E5E5"> I'm talking about</font>

116
00:05:10,980 --> 00:05:17,430
<font color="#E5E5E5">where</font><font color="#CCCCCC"> netweaver</font><font color="#E5E5E5"> is the framework where s</font>

117
00:05:14,340 --> 00:05:18,960
<font color="#CCCCCC">ap</font><font color="#E5E5E5"> is built in let me</font><font color="#CCCCCC"> tell you that</font><font color="#E5E5E5"> is</font>

118
00:05:17,430 --> 00:05:21,990
<font color="#E5E5E5">the</font><font color="#CCCCCC"> most important piece of technology</font>

119
00:05:18,960 --> 00:05:26,400
on the<font color="#CCCCCC"> SI p world</font><font color="#E5E5E5"> the most important one</font>

120
00:05:21,990 --> 00:05:29,760
<font color="#E5E5E5">and it regulates how s ap will interact</font>

121
00:05:26,400 --> 00:05:33,719
<font color="#E5E5E5">with all the</font><font color="#CCCCCC"> different components</font><font color="#E5E5E5"> a very</font>

122
00:05:29,760 --> 00:05:35,550
important set<font color="#CCCCCC"> of things about Ned Weaver</font>

123
00:05:33,720 --> 00:05:39,570
is that first is service oriented

124
00:05:35,550 --> 00:05:41,430
<font color="#E5E5E5">meaning</font><font color="#CCCCCC"> that each SI p</font><font color="#E5E5E5"> system will have</font>

125
00:05:39,570 --> 00:05:44,610
all the<font color="#CCCCCC"> different services running on</font>

126
00:05:41,430 --> 00:05:47,760
all<font color="#E5E5E5"> specific SFP ports</font><font color="#CCCCCC"> unlimitedly right</font>

127
00:05:44,610 --> 00:05:49,890
now that most of those<font color="#E5E5E5"> services</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> I</font>

128
00:05:47,760 --> 00:05:52,349
mention about<font color="#E5E5E5"> they have private</font>

129
00:05:49,890 --> 00:05:54,150
protocols<font color="#E5E5E5"> their proprietary protocols</font>

130
00:05:52,350 --> 00:05:58,440
meaning<font color="#E5E5E5"> that</font><font color="#CCCCCC"> are</font><font color="#E5E5E5"> not documented out</font>

131
00:05:54,150 --> 00:06:01,590
there and finally we can find two

132
00:05:58,440 --> 00:06:05,070
frameworks<font color="#E5E5E5"> or two divisions of</font><font color="#CCCCCC"> netweaver</font>

133
00:06:01,590 --> 00:06:07,619
we have the a<font color="#CCCCCC"> bub stack commonly</font><font color="#E5E5E5"> used</font>

134
00:06:05,070 --> 00:06:09,570
for<font color="#E5E5E5"> back-end systems</font><font color="#CCCCCC"> if your company's</font>

135
00:06:07,620 --> 00:06:12,270
processing credit<font color="#E5E5E5"> cards what is there</font>

136
00:06:09,570 --> 00:06:13,980
and you<font color="#CCCCCC"> have</font><font color="#E5E5E5"> the Java stack commonly</font>

137
00:06:12,270 --> 00:06:16,200
used for<font color="#E5E5E5"> front-end</font><font color="#CCCCCC"> but don't</font><font color="#E5E5E5"> get me</font>

138
00:06:13,980 --> 00:06:18,780
wrong<font color="#CCCCCC"> both of those stats you can find</font>

139
00:06:16,200 --> 00:06:22,110
on the<font color="#E5E5E5"> Internet so let's follow this</font>

140
00:06:18,780 --> 00:06:24,150
diagram here<font color="#E5E5E5"> this is how a</font><font color="#CCCCCC"> netweaver</font>

141
00:06:22,110 --> 00:06:27,120
system looks<font color="#CCCCCC"> like again this is</font><font color="#E5E5E5"> like a</font>

142
00:06:24,150 --> 00:06:29,159
very<font color="#E5E5E5"> brief introduction what I have here</font>

143
00:06:27,120 --> 00:06:32,490
the<font color="#E5E5E5"> ESP application</font><font color="#CCCCCC"> level is</font><font color="#E5E5E5"> actually</font>

144
00:06:29,160 --> 00:06:34,530
the<font color="#CCCCCC"> netweaver framework then</font><font color="#E5E5E5"> L we</font>

145
00:06:32,490 --> 00:06:36,480
refrain<font color="#E5E5E5"> will regulate how</font><font color="#CCCCCC"> this abcs</font>

146
00:06:34,530 --> 00:06:39,409
<font color="#CCCCCC">thing</font><font color="#E5E5E5"> connects to the operating system</font>

147
00:06:36,480 --> 00:06:43,160
<font color="#CCCCCC">and the net we were framework on</font>

148
00:06:39,410 --> 00:06:47,480
will regulate how the<font color="#CCCCCC"> SP system connects</font>

149
00:06:43,160 --> 00:06:49,990
to the database<font color="#E5E5E5"> so 75%</font><font color="#CCCCCC"> of all</font><font color="#E5E5E5"> the</font>

150
00:06:47,480 --> 00:06:53,780
<font color="#CCCCCC">netweaver systems are exactly the same</font>

151
00:06:49,990 --> 00:06:56,870
<font color="#E5E5E5">then the</font><font color="#CCCCCC"> business logic will make the</font>

152
00:06:53,780 --> 00:07:00,080
<font color="#CCCCCC">difference between an ERP system or a bi</font>

153
00:06:56,870 --> 00:07:03,530
<font color="#CCCCCC">system or a CRM system but</font><font color="#E5E5E5"> 70% is</font>

154
00:07:00,080 --> 00:07:04,849
exactly the same<font color="#E5E5E5"> and as an attacker if</font>

155
00:07:03,530 --> 00:07:07,760
you put<font color="#E5E5E5"> yourself in the role of an</font>

156
00:07:04,850 --> 00:07:09,830
attacker<font color="#E5E5E5"> that is really good but we are</font>

157
00:07:07,760 --> 00:07:11,990
defending<font color="#E5E5E5"> and if we are defending</font><font color="#CCCCCC"> that</font>

158
00:07:09,830 --> 00:07:14,510
is really mad<font color="#CCCCCC"> why because it means</font><font color="#E5E5E5"> that</font>

159
00:07:11,990 --> 00:07:17,510
is<font color="#CCCCCC"> some</font><font color="#E5E5E5"> phone</font><font color="#CCCCCC"> boon ability for</font><font color="#E5E5E5"> the year</font>

160
00:07:14,510 --> 00:07:20,270
people they have 75%<font color="#CCCCCC"> of probabilities of</font>

161
00:07:17,510 --> 00:07:26,510
that<font color="#E5E5E5"> one</font><font color="#CCCCCC"> ability</font><font color="#E5E5E5"> also working on a bi or</font>

162
00:07:20,270 --> 00:07:28,940
a CRM system<font color="#E5E5E5"> we give with some of the</font>

163
00:07:26,510 --> 00:07:32,030
basic concepts<font color="#CCCCCC"> that we are going</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> need</font>

164
00:07:28,940 --> 00:07:34,130
some transactions<font color="#CCCCCC"> well let me</font><font color="#E5E5E5"> tell you</font>

165
00:07:32,030 --> 00:07:38,349
that in the SI p<font color="#CCCCCC"> word even though they</font>

166
00:07:34,130 --> 00:07:40,490
are improving<font color="#E5E5E5"> it is not point-and-click</font>

167
00:07:38,350 --> 00:07:43,970
<font color="#E5E5E5">meaning</font><font color="#CCCCCC"> that you will</font><font color="#E5E5E5"> have to remember</font>

168
00:07:40,490 --> 00:07:47,390
some codes<font color="#E5E5E5"> some transactions that will</font>

169
00:07:43,970 --> 00:07:50,450
act as<font color="#CCCCCC"> a trigger to</font><font color="#E5E5E5"> call a specific</font><font color="#CCCCCC"> ASAP</font>

170
00:07:47,390 --> 00:07:52,280
<font color="#E5E5E5">programs you can have the fall</font>

171
00:07:50,450 --> 00:07:54,500
transactions or custom ones

172
00:07:52,280 --> 00:07:56,570
why<font color="#E5E5E5"> because you can also have the</font>

173
00:07:54,500 --> 00:07:59,780
default prevalence and<font color="#CCCCCC"> Kisan</font><font color="#E5E5E5"> SAV</font>

174
00:07:56,570 --> 00:08:02,570
<font color="#CCCCCC">programs for the sake of this talk for</font>

175
00:07:59,780 --> 00:08:05,239
now we're<font color="#E5E5E5"> going to only understand is a</font>

176
00:08:02,570 --> 00:08:07,610
B programs as a<font color="#E5E5E5"> bad provenance</font><font color="#CCCCCC"> just for</font>

177
00:08:05,240 --> 00:08:09,290
the sake of this talk<font color="#E5E5E5"> so what</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> the</font>

178
00:08:07,610 --> 00:08:11,150
<font color="#E5E5E5">neighbor program</font><font color="#CCCCCC"> well first let me tell</font>

179
00:08:09,290 --> 00:08:13,400
<font color="#E5E5E5">you</font><font color="#CCCCCC"> a Bop is a proprietary language</font>

180
00:08:11,150 --> 00:08:15,109
created<font color="#E5E5E5"> by ASAP</font><font color="#CCCCCC"> I'm going to show</font><font color="#E5E5E5"> you</font>

181
00:08:13,400 --> 00:08:20,479
later<font color="#E5E5E5"> but it's very very similar to</font>

182
00:08:15,110 --> 00:08:22,610
<font color="#CCCCCC">QBasic also we have a variation of</font><font color="#E5E5E5"> those</font>

183
00:08:20,480 --> 00:08:26,060
programs that<font color="#E5E5E5"> we can call</font><font color="#CCCCCC"> sav function</font>

184
00:08:22,610 --> 00:08:29,810
calls<font color="#E5E5E5"> again they're colored in a bap but</font>

185
00:08:26,060 --> 00:08:32,510
they can be seen as<font color="#E5E5E5"> api those api's can</font>

186
00:08:29,810 --> 00:08:36,260
be called locally from<font color="#E5E5E5"> the</font><font color="#CCCCCC"> ESP system</font><font color="#E5E5E5"> to</font>

187
00:08:32,510 --> 00:08:38,479
<font color="#E5E5E5">itself or remotely from one ASAP system</font>

188
00:08:36,260 --> 00:08:41,000
to another<font color="#E5E5E5"> or for an a</font><font color="#CCCCCC"> python script</font>

189
00:08:38,479 --> 00:08:44,000
<font color="#E5E5E5">Rubeus crib</font><font color="#CCCCCC"> over</font><font color="#E5E5E5"> java application to an</font>

190
00:08:41,000 --> 00:08:46,670
NCP system most of<font color="#E5E5E5"> these function calls</font>

191
00:08:44,000 --> 00:08:48,410
<font color="#CCCCCC">are authenticated but</font><font color="#E5E5E5"> there are some</font>

192
00:08:46,670 --> 00:08:52,300
that they are not meaning that<font color="#E5E5E5"> you can</font>

193
00:08:48,410 --> 00:08:54,459
call it without any<font color="#E5E5E5"> username password</font>

194
00:08:52,300 --> 00:08:56,500
so before we start<font color="#CCCCCC"> with</font><font color="#E5E5E5"> these</font>

195
00:08:54,460 --> 00:08:58,390
misconceptions<font color="#E5E5E5"> and again I told</font><font color="#CCCCCC"> you</font>

196
00:08:56,500 --> 00:08:59,800
before<font color="#CCCCCC"> that we're going to see like real</font>

197
00:08:58,390 --> 00:09:01,930
<font color="#CCCCCC">attacking scenarios</font>

198
00:08:59,800 --> 00:09:04,449
some of them even covering<font color="#E5E5E5"> the media</font><font color="#CCCCCC"> I</font>

199
00:09:01,930 --> 00:09:06,849
also want to tell<font color="#CCCCCC"> you that I'm not going</font>

200
00:09:04,450 --> 00:09:08,230
<font color="#E5E5E5">to give names</font><font color="#CCCCCC"> I'm not going</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> give the</font>

201
00:09:06,850 --> 00:09:10,420
names of the companies that they

202
00:09:08,230 --> 00:09:12,220
<font color="#CCCCCC">suffered these attacks just</font><font color="#E5E5E5"> out of</font>

203
00:09:10,420 --> 00:09:15,130
respect<font color="#E5E5E5"> and consideration for the big</font>

204
00:09:12,220 --> 00:09:17,500
<font color="#E5E5E5">things so let's start with</font>

205
00:09:15,130 --> 00:09:21,610
misconceptions<font color="#E5E5E5"> we never had any CP</font>

206
00:09:17,500 --> 00:09:24,240
security<font color="#CCCCCC"> incident before ok this</font><font color="#E5E5E5"> is the</font>

207
00:09:21,610 --> 00:09:28,000
<font color="#E5E5E5">scenario that we had to work with</font>

208
00:09:24,240 --> 00:09:30,370
<font color="#E5E5E5">someone had this massive company in the</font>

209
00:09:28,000 --> 00:09:35,080
United States<font color="#E5E5E5"> those guys were</font><font color="#CCCCCC"> the</font>

210
00:09:30,370 --> 00:09:37,750
<font color="#CCCCCC">filming is industry apparently a domain</font>

211
00:09:35,080 --> 00:09:41,770
controller was also compromised<font color="#E5E5E5"> the god</font>

212
00:09:37,750 --> 00:09:44,860
domain admin privileges everything<font color="#E5E5E5"> that</font>

213
00:09:41,770 --> 00:09:47,280
you<font color="#E5E5E5"> can</font><font color="#CCCCCC"> think of it was compromised the</font>

214
00:09:44,860 --> 00:09:51,550
domain controller<font color="#E5E5E5"> say before switches</font>

215
00:09:47,280 --> 00:09:53,680
servers workstations<font color="#CCCCCC"> database and of</font>

216
00:09:51,550 --> 00:09:57,609
course also the<font color="#E5E5E5"> databases that</font><font color="#CCCCCC"> were used</font>

217
00:09:53,680 --> 00:10:00,250
by ASAP the this is the first entire

218
00:09:57,610 --> 00:10:01,930
<font color="#E5E5E5">solaced this company decides to pretty</font>

219
00:10:00,250 --> 00:10:04,360
<font color="#E5E5E5">much duplicate every single piece of</font>

220
00:10:01,930 --> 00:10:06,819
technology<font color="#CCCCCC"> that was there</font><font color="#E5E5E5"> it was crazy</font>

221
00:10:04,360 --> 00:10:09,430
they created the concept of a wide room

222
00:10:06,820 --> 00:10:12,400
<font color="#CCCCCC">and only</font><font color="#E5E5E5"> the technology</font><font color="#CCCCCC"> that was</font>

223
00:10:09,430 --> 00:10:15,400
<font color="#CCCCCC">reinstall on that white room</font><font color="#E5E5E5"> was allowed</font>

224
00:10:12,400 --> 00:10:18,100
to<font color="#E5E5E5"> stay if I wanted to go there to work</font>

225
00:10:15,400 --> 00:10:20,800
<font color="#E5E5E5">I had to leave my phone</font><font color="#CCCCCC"> I had to leave</font>

226
00:10:18,100 --> 00:10:22,630
my<font color="#E5E5E5"> computer my</font><font color="#CCCCCC"> SmartWatch</font><font color="#E5E5E5"> everything</font>

227
00:10:20,800 --> 00:10:24,910
<font color="#CCCCCC">that was the inertia related you had to</font>

228
00:10:22,630 --> 00:10:26,710
<font color="#E5E5E5">leave it outside I was craziest the</font>

229
00:10:24,910 --> 00:10:30,250
first and<font color="#E5E5E5"> only time that I saw this kind</font>

230
00:10:26,710 --> 00:10:33,460
of behavior<font color="#E5E5E5"> so what was the main</font><font color="#CCCCCC"> concern</font>

231
00:10:30,250 --> 00:10:36,160
here<font color="#E5E5E5"> what the victim was specifically</font>

232
00:10:33,460 --> 00:10:39,580
<font color="#CCCCCC">concern about credit cards</font><font color="#E5E5E5"> most</font>

233
00:10:36,160 --> 00:10:41,530
important ones<font color="#E5E5E5"> and personal identifying</font>

234
00:10:39,580 --> 00:10:43,570
information bank accounts etc<font color="#CCCCCC"> they</font>

235
00:10:41,530 --> 00:10:45,310
wanted to know if<font color="#CCCCCC"> that information was</font>

236
00:10:43,570 --> 00:10:46,630
actually retrieved<font color="#E5E5E5"> they already knew</font>

237
00:10:45,310 --> 00:10:48,849
that<font color="#E5E5E5"> the word totally compromised</font>

238
00:10:46,630 --> 00:10:50,410
<font color="#E5E5E5">someone was already</font><font color="#CCCCCC"> the main enemy but</font>

239
00:10:48,850 --> 00:10:54,490
they want to<font color="#CCCCCC"> see if the information</font><font color="#E5E5E5"> was</font>

240
00:10:50,410 --> 00:10:57,219
actually extract they give us the<font color="#CCCCCC"> air</font>

241
00:10:54,490 --> 00:10:58,750
<font color="#CCCCCC">people action system why</font><font color="#E5E5E5"> because all the</font>

242
00:10:57,220 --> 00:11:01,180
credit cards<font color="#CCCCCC"> were processed there</font><font color="#E5E5E5"> they</font>

243
00:10:58,750 --> 00:11:03,250
say<font color="#CCCCCC"> ok guys</font><font color="#E5E5E5"> this is therapy</font><font color="#CCCCCC"> system</font><font color="#E5E5E5"> work</font>

244
00:11:01,180 --> 00:11:06,099
on<font color="#E5E5E5"> this the only caveat here is that we</font>

245
00:11:03,250 --> 00:11:08,410
didn't do the forensics<font color="#CCCCCC"> of the database</font>

246
00:11:06,100 --> 00:11:13,660
they contracted another one known

247
00:11:08,410 --> 00:11:15,160
company<font color="#CCCCCC"> choose for the</font><font color="#E5E5E5"> database so every</font>

248
00:11:13,660 --> 00:11:17,050
<font color="#E5E5E5">time</font><font color="#CCCCCC"> that you hear we never had</font><font color="#E5E5E5"> a nice</font>

249
00:11:15,160 --> 00:11:19,509
<font color="#CCCCCC">ap security</font><font color="#E5E5E5"> in</font><font color="#CCCCCC"> cm before you need</font><font color="#E5E5E5"> to</font>

250
00:11:17,050 --> 00:11:22,479
start<font color="#CCCCCC"> asking a few questions right can</font>

251
00:11:19,509 --> 00:11:24,999
<font color="#CCCCCC">you really be sure in Java</font><font color="#E5E5E5"> the Java</font>

252
00:11:22,480 --> 00:11:26,739
stack that<font color="#E5E5E5"> I show</font><font color="#CCCCCC"> you before</font><font color="#E5E5E5"> most of the</font>

253
00:11:24,999 --> 00:11:29,529
security<font color="#CCCCCC"> audit trails common able by</font>

254
00:11:26,739 --> 00:11:31,509
default<font color="#E5E5E5"> great but the name</font><font color="#CCCCCC"> of the most</font>

255
00:11:29,529 --> 00:11:33,489
important one the<font color="#E5E5E5"> one that was acting as</font>

256
00:11:31,509 --> 00:11:35,379
a back-end and what the credit<font color="#E5E5E5"> cards are</font>

257
00:11:33,489 --> 00:11:38,079
let<font color="#CCCCCC"> me</font><font color="#E5E5E5"> tell you that most of the</font>

258
00:11:35,379 --> 00:11:41,350
<font color="#CCCCCC">security</font><font color="#E5E5E5"> logs do not come enable by</font>

259
00:11:38,079 --> 00:11:43,059
default<font color="#E5E5E5"> so you need to start</font><font color="#CCCCCC"> asking the</font>

260
00:11:41,350 --> 00:11:45,339
<font color="#CCCCCC">questions</font><font color="#E5E5E5"> the first question</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> you</font>

261
00:11:43,059 --> 00:11:47,079
<font color="#E5E5E5">need to ask to your customers</font><font color="#CCCCCC"> hey do</font><font color="#E5E5E5"> you</font>

262
00:11:45,339 --> 00:11:50,139
<font color="#E5E5E5">have what is called</font><font color="#CCCCCC"> the security audit</font>

263
00:11:47,079 --> 00:11:53,049
log enable and instead<font color="#E5E5E5"> secretary log</font>

264
00:11:50,139 --> 00:11:57,160
enable in all your<font color="#CCCCCC"> ASAP systems across</font>

265
00:11:53,049 --> 00:12:00,399
all your users with all the<font color="#CCCCCC"> filters</font><font color="#E5E5E5"> let</font>

266
00:11:57,160 --> 00:12:03,249
me tell you that<font color="#CCCCCC"> 90% of</font><font color="#E5E5E5"> the time the</font>

267
00:12:00,399 --> 00:12:06,269
answer<font color="#CCCCCC"> is no but let's be kind</font><font color="#E5E5E5"> let's be</font>

268
00:12:03,249 --> 00:12:09,910
kind<font color="#E5E5E5"> let's assume that the answer is</font><font color="#CCCCCC"> yes</font>

269
00:12:06,269 --> 00:12:14,259
you need<font color="#E5E5E5"> to continue and you need to ask</font>

270
00:12:09,910 --> 00:12:15,759
<font color="#E5E5E5">these</font><font color="#CCCCCC"> that the other logs</font><font color="#E5E5E5"> enable do you</font>

271
00:12:14,259 --> 00:12:18,459
remember<font color="#E5E5E5"> that I told</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> before the</font>

272
00:12:15,759 --> 00:12:19,809
<font color="#CCCCCC">netweaver bus service oriented</font><font color="#E5E5E5"> well let</font>

273
00:12:18,459 --> 00:12:22,618
me<font color="#E5E5E5"> tell you that each one of</font><font color="#CCCCCC"> those</font>

274
00:12:19,809 --> 00:12:25,929
services<font color="#CCCCCC"> has its own set of locks</font><font color="#E5E5E5"> and</font>

275
00:12:22,619 --> 00:12:32,079
<font color="#CCCCCC">for most of them</font><font color="#E5E5E5"> they do not come enable</font>

276
00:12:25,929 --> 00:12:33,790
by default let's be kind again let's

277
00:12:32,079 --> 00:12:35,469
suppose that<font color="#E5E5E5"> the customer does have</font>

278
00:12:33,790 --> 00:12:39,160
those<font color="#E5E5E5"> locks enable even though most of</font>

279
00:12:35,470 --> 00:12:41,319
<font color="#E5E5E5">them do</font><font color="#CCCCCC"> not have them we need to</font><font color="#E5E5E5"> ask</font>

280
00:12:39,160 --> 00:12:43,509
another question<font color="#E5E5E5"> and the most important</font>

281
00:12:41,319 --> 00:12:45,099
one is<font color="#E5E5E5"> actually grabbing someone</font>

282
00:12:43,509 --> 00:12:46,929
<font color="#CCCCCC">actually grabbing</font><font color="#E5E5E5"> those locks and doing</font>

283
00:12:45,100 --> 00:12:48,819
something with<font color="#E5E5E5"> those locks</font><font color="#CCCCCC"> is someone</font>

284
00:12:46,929 --> 00:12:52,540
<font color="#E5E5E5">doing a correlation and look at looking</font>

285
00:12:48,819 --> 00:12:56,979
at those<font color="#CCCCCC"> logs</font><font color="#E5E5E5"> 95 percent of the cases</font>

286
00:12:52,540 --> 00:13:01,240
the<font color="#CCCCCC"> answer is no most customers right</font>

287
00:12:56,980 --> 00:13:03,759
<font color="#CCCCCC">now do not have the basic information to</font>

288
00:13:01,240 --> 00:13:06,069
<font color="#E5E5E5">start a forensic investigation</font><font color="#CCCCCC"> on an SMP</font>

289
00:13:03,759 --> 00:13:08,230
system and this<font color="#CCCCCC"> is not an</font><font color="#E5E5E5"> isolated case</font>

290
00:13:06,069 --> 00:13:11,559
<font color="#E5E5E5">here in Australia or the United States</font>

291
00:13:08,230 --> 00:13:14,259
<font color="#E5E5E5">pretty much every single company out</font>

292
00:13:11,559 --> 00:13:16,389
there<font color="#E5E5E5"> most of the companies out there</font><font color="#CCCCCC"> do</font>

293
00:13:14,259 --> 00:13:19,540
<font color="#E5E5E5">not have everything that they need for a</font>

294
00:13:16,389 --> 00:13:22,490
forensic<font color="#E5E5E5"> investigation</font>

295
00:13:19,540 --> 00:13:24,560
so what we had<font color="#CCCCCC"> to do</font><font color="#E5E5E5"> we asked for the</font>

296
00:13:22,490 --> 00:13:26,390
virtual machines of<font color="#CCCCCC"> the</font><font color="#E5E5E5"> ESCP</font><font color="#CCCCCC"> system</font><font color="#E5E5E5"> and</font>

297
00:13:24,560 --> 00:13:29,569
here's another<font color="#E5E5E5"> thing that you</font><font color="#CCCCCC"> need to</font>

298
00:13:26,390 --> 00:13:31,400
take into<font color="#CCCCCC"> consideration</font><font color="#E5E5E5"> in this</font><font color="#CCCCCC"> ap you</font>

299
00:13:29,570 --> 00:13:34,150
have what is called<font color="#CCCCCC"> the central instance</font>

300
00:13:31,400 --> 00:13:37,430
and then you have application servers

301
00:13:34,150 --> 00:13:39,920
you have application servers to support

302
00:13:37,430 --> 00:13:42,530
a<font color="#E5E5E5"> different number of</font><font color="#CCCCCC"> end-users</font><font color="#E5E5E5"> the more</font>

303
00:13:39,920 --> 00:13:44,150
users<font color="#CCCCCC"> you have working</font><font color="#E5E5E5"> on</font><font color="#CCCCCC"> a specific</font>

304
00:13:42,530 --> 00:13:46,010
<font color="#CCCCCC">system the</font><font color="#E5E5E5"> more application servers</font>

305
00:13:44,150 --> 00:13:48,410
you're going to have<font color="#E5E5E5"> well there is a</font>

306
00:13:46,010 --> 00:13:51,230
<font color="#CCCCCC">caveat there if you want to</font><font color="#E5E5E5"> do a good</font>

307
00:13:48,410 --> 00:13:53,480
job<font color="#E5E5E5"> you need to ask for the logs of</font>

308
00:13:51,230 --> 00:13:55,970
every<font color="#E5E5E5"> single application server and</font>

309
00:13:53,480 --> 00:13:58,100
<font color="#CCCCCC">central instance</font><font color="#E5E5E5"> why because the</font>

310
00:13:55,970 --> 00:13:59,660
attacker can<font color="#CCCCCC"> hit</font><font color="#E5E5E5"> just</font><font color="#CCCCCC"> one a specific</font>

311
00:13:58,100 --> 00:14:02,090
application server<font color="#E5E5E5"> and from there</font>

312
00:13:59,660 --> 00:14:03,949
<font color="#CCCCCC">directly jump</font><font color="#E5E5E5"> to the database so maybe</font>

313
00:14:02,090 --> 00:14:06,200
<font color="#E5E5E5">three application servers are completely</font>

314
00:14:03,950 --> 00:14:07,670
clean but if you<font color="#CCCCCC"> forget that one the</font>

315
00:14:06,200 --> 00:14:12,020
<font color="#E5E5E5">word the intrusion happened you will</font>

316
00:14:07,670 --> 00:14:14,209
never see<font color="#E5E5E5"> anything about the hack once</font>

317
00:14:12,020 --> 00:14:16,400
we go that we<font color="#E5E5E5"> mounted the DS and we</font>

318
00:14:14,210 --> 00:14:19,280
started reviewing<font color="#E5E5E5"> the logs for your</font>

319
00:14:16,400 --> 00:14:22,069
convenience<font color="#E5E5E5"> I have created this</font><font color="#CCCCCC"> table so</font>

320
00:14:19,280 --> 00:14:24,680
you<font color="#CCCCCC"> can go back</font><font color="#E5E5E5"> to your job and see if</font>

321
00:14:22,070 --> 00:14:26,720
you have the logs<font color="#E5E5E5"> enabled that's the</font>

322
00:14:24,680 --> 00:14:29,569
complete<font color="#E5E5E5"> path this kind of like the</font>

323
00:14:26,720 --> 00:14:32,270
<font color="#E5E5E5">Linux example of where the logs should</font>

324
00:14:29,570 --> 00:14:35,030
be at least<font color="#E5E5E5"> by default so let's review</font>

325
00:14:32,270 --> 00:14:38,300
together<font color="#E5E5E5"> what this customer had first</font>

326
00:14:35,030 --> 00:14:40,520
the<font color="#E5E5E5"> e Bob security of the log it was</font>

327
00:14:38,300 --> 00:14:42,109
<font color="#E5E5E5">partially activated it was not fully</font>

328
00:14:40,520 --> 00:14:45,020
<font color="#E5E5E5">activated by the least they got</font>

329
00:14:42,110 --> 00:14:47,180
something<font color="#E5E5E5"> perfect</font><font color="#CCCCCC"> it's a pig away</font><font color="#E5E5E5"> log</font>

330
00:14:45,020 --> 00:14:49,689
it's one of the logs that<font color="#E5E5E5"> does not come</font>

331
00:14:47,180 --> 00:14:52,550
by<font color="#CCCCCC"> default</font><font color="#E5E5E5"> the customer did not have it</font>

332
00:14:49,690 --> 00:14:54,500
<font color="#E5E5E5">domitius server LD log very important</font>

333
00:14:52,550 --> 00:14:55,939
piece of<font color="#CCCCCC"> technology in</font><font color="#E5E5E5"> s IP if it is</font>

334
00:14:54,500 --> 00:14:57,860
badly configured someone can do

335
00:14:55,940 --> 00:14:59,750
man-in-the-middle attacks and intercept

336
00:14:57,860 --> 00:15:01,820
<font color="#E5E5E5">the entire traffic that goes to the ASAP</font>

337
00:14:59,750 --> 00:15:03,940
system again<font color="#E5E5E5"> as it doesn't come by</font>

338
00:15:01,820 --> 00:15:06,140
default<font color="#CCCCCC"> the customer</font><font color="#E5E5E5"> Dino</font><font color="#CCCCCC"> Hallett and</font>

339
00:15:03,940 --> 00:15:07,910
<font color="#CCCCCC">finally we didn't even have the</font>

340
00:15:06,140 --> 00:15:10,610
<font color="#E5E5E5">balloting system</font><font color="#CCCCCC"> locks so as you can see</font>

341
00:15:07,910 --> 00:15:16,490
<font color="#E5E5E5">we were really</font><font color="#CCCCCC"> really far from</font><font color="#E5E5E5"> an ideal</font>

342
00:15:10,610 --> 00:15:18,980
<font color="#E5E5E5">scenario so what is</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> security</font><font color="#CCCCCC"> lock</font>

343
00:15:16,490 --> 00:15:22,130
<font color="#E5E5E5">today</font><font color="#CCCCCC"> Kim</font><font color="#E5E5E5"> mentioning this is a quote for</font>

344
00:15:18,980 --> 00:15:24,170
an essay<font color="#E5E5E5"> B it's a tool</font><font color="#CCCCCC"> designed for a</font>

345
00:15:22,130 --> 00:15:27,410
littles<font color="#E5E5E5"> and security professionals</font><font color="#CCCCCC"> when</font>

346
00:15:24,170 --> 00:15:29,180
they want to see details about<font color="#CCCCCC"> the</font>

347
00:15:27,410 --> 00:15:31,079
events that<font color="#CCCCCC"> are happening inside the</font>

348
00:15:29,180 --> 00:15:34,199
ASAP<font color="#E5E5E5"> system</font><font color="#CCCCCC"> let</font>

349
00:15:31,080 --> 00:15:37,470
tell you<font color="#E5E5E5"> right now that</font><font color="#CCCCCC"> the security log</font>

350
00:15:34,200 --> 00:15:39,660
is definitely definitely not one of the

351
00:15:37,470 --> 00:15:41,940
best pieces<font color="#E5E5E5"> of</font><font color="#CCCCCC"> technologies that</font><font color="#E5E5E5"> ACP</font>

352
00:15:39,660 --> 00:15:44,370
have created out there<font color="#E5E5E5"> but don't</font><font color="#CCCCCC"> get me</font>

353
00:15:41,940 --> 00:15:47,340
wrong<font color="#E5E5E5"> it's still</font><font color="#CCCCCC"> extremely important to</font>

354
00:15:44,370 --> 00:15:48,720
have<font color="#E5E5E5"> this enable why just for</font><font color="#CCCCCC"> the simple</font>

355
00:15:47,340 --> 00:15:52,320
<font color="#CCCCCC">concept</font><font color="#E5E5E5"> that something is better than</font>

356
00:15:48,720 --> 00:15:53,850
nothing<font color="#E5E5E5"> there are a million ways</font><font color="#CCCCCC"> to</font>

357
00:15:52,320 --> 00:15:57,570
bypass<font color="#E5E5E5"> the security of the log and</font><font color="#CCCCCC"> we're</font>

358
00:15:53,850 --> 00:15:59,280
going to<font color="#E5E5E5"> see</font><font color="#CCCCCC"> a one very soon</font><font color="#E5E5E5"> so how you</font>

359
00:15:57,570 --> 00:16:01,740
work with<font color="#CCCCCC"> the security of the log there</font>

360
00:15:59,280 --> 00:16:04,650
are three transactions involved with

361
00:16:01,740 --> 00:16:07,320
<font color="#CCCCCC">this m-19 you are going to activate the</font>

362
00:16:04,650 --> 00:16:09,270
security<font color="#CCCCCC"> log you're going to say to what</font>

363
00:16:07,320 --> 00:16:11,010
users the security<font color="#CCCCCC"> logs should</font><font color="#E5E5E5"> be</font>

364
00:16:09,270 --> 00:16:14,640
enabled<font color="#CCCCCC"> it could be for a couple users</font>

365
00:16:11,010 --> 00:16:17,400
all the users<font color="#CCCCCC"> or just one front rack</font>

366
00:16:14,640 --> 00:16:19,199
session is in 20 and I<font color="#CCCCCC"> set</font><font color="#E5E5E5"> this between</font>

367
00:16:17,400 --> 00:16:21,420
quotes<font color="#CCCCCC"> you are going to review the</font>

368
00:16:19,200 --> 00:16:24,620
<font color="#CCCCCC">events we're going to see later why with</font>

369
00:16:21,420 --> 00:16:29,010
the we didn't even<font color="#E5E5E5"> use the</font><font color="#CCCCCC"> some</font><font color="#E5E5E5"> 20</font><font color="#CCCCCC"> I'm</font>

370
00:16:24,620 --> 00:16:31,860
furnishing 18<font color="#E5E5E5"> we're going to be deleting</font>

371
00:16:29,010 --> 00:16:33,990
<font color="#E5E5E5">logs and you might be thinking wait</font>

372
00:16:31,860 --> 00:16:36,120
<font color="#CCCCCC">Joran but something is caching why you</font>

373
00:16:33,990 --> 00:16:37,740
would like to choose<font color="#CCCCCC"> the lid locks</font><font color="#E5E5E5"> well</font>

374
00:16:36,120 --> 00:16:39,980
let me tell<font color="#E5E5E5"> you that in the SI</font><font color="#CCCCCC"> p warned</font>

375
00:16:37,740 --> 00:16:43,260
the<font color="#CCCCCC"> locks do not how to recycle</font>

376
00:16:39,980 --> 00:16:45,030
<font color="#E5E5E5">themselves</font><font color="#CCCCCC"> ACP will</font><font color="#E5E5E5"> keep</font><font color="#CCCCCC"> logging on to</font>

377
00:16:43,260 --> 00:16:47,670
<font color="#CCCCCC">by</font><font color="#E5E5E5"> default it reaches</font><font color="#CCCCCC"> a hundred</font>

378
00:16:45,030 --> 00:16:50,010
megabytes if you don't recycle the logs

379
00:16:47,670 --> 00:16:51,599
manually or with<font color="#CCCCCC"> an script the SMP</font>

380
00:16:50,010 --> 00:16:54,270
system will hit<font color="#CCCCCC"> the hundred megabytes</font>

381
00:16:51,600 --> 00:16:57,270
<font color="#E5E5E5">and will stop logging until you recycle</font>

382
00:16:54,270 --> 00:16:58,980
those logs the<font color="#CCCCCC"> profit parameter that you</font>

383
00:16:57,270 --> 00:17:01,350
see there is how<font color="#E5E5E5"> you can regulate how</font>

384
00:16:58,980 --> 00:17:03,420
<font color="#CCCCCC">much information</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> AP will store</font><font color="#E5E5E5"> until</font>

385
00:17:01,350 --> 00:17:06,270
it stops logging by default again<font color="#E5E5E5"> is a</font>

386
00:17:03,420 --> 00:17:08,970
hundred megabytes and also I have

387
00:17:06,270 --> 00:17:11,970
include a little<font color="#E5E5E5"> chart down there that</font>

388
00:17:08,970 --> 00:17:13,530
it shows you some<font color="#CCCCCC"> of</font><font color="#E5E5E5"> the LD filters that</font>

389
00:17:11,970 --> 00:17:16,650
you<font color="#E5E5E5"> can activate with the security of</font>

390
00:17:13,530 --> 00:17:19,770
the log<font color="#E5E5E5"> finally log on a time if the</font>

391
00:17:16,650 --> 00:17:27,360
<font color="#CCCCCC">user gets</font><font color="#E5E5E5"> lock unlock successful log on</font>

392
00:17:19,770 --> 00:17:30,389
etc so there was the main problem<font color="#CCCCCC"> that</font>

393
00:17:27,359 --> 00:17:32,820
<font color="#E5E5E5">we hit here is that we have G</font><font color="#CCCCCC"> hides and</font>

394
00:17:30,390 --> 00:17:35,070
G hides and gigawatts of lock<font color="#E5E5E5"> and this</font>

395
00:17:32,820 --> 00:17:38,879
was just<font color="#CCCCCC"> for</font><font color="#E5E5E5"> a not fully configured</font>

396
00:17:35,070 --> 00:17:40,860
<font color="#E5E5E5">security log this and 20 was not good</font>

397
00:17:38,880 --> 00:17:43,250
<font color="#E5E5E5">enough we couldn't see what</font><font color="#CCCCCC"> we were</font>

398
00:17:40,860 --> 00:17:46,789
needed<font color="#E5E5E5"> to see so what we had to</font><font color="#CCCCCC"> do</font>

399
00:17:43,250 --> 00:17:48,380
<font color="#E5E5E5">is to create a parser let me tell you</font>

400
00:17:46,789 --> 00:17:51,919
and this<font color="#E5E5E5"> is another painful thing that</font>

401
00:17:48,380 --> 00:17:54,530
<font color="#E5E5E5">in</font><font color="#CCCCCC"> SI p the</font><font color="#E5E5E5"> locks are not symmetric</font>

402
00:17:51,919 --> 00:17:56,390
<font color="#E5E5E5">meaning</font><font color="#CCCCCC"> that each one of the services we</font>

403
00:17:54,530 --> 00:17:59,780
have<font color="#E5E5E5"> a different</font><font color="#CCCCCC"> syntax for the logs</font>

404
00:17:56,390 --> 00:18:03,590
<font color="#E5E5E5">some logs</font><font color="#CCCCCC"> as is the case of</font><font color="#E5E5E5"> the security</font>

405
00:17:59,780 --> 00:18:06,500
log and not even plain text or<font color="#CCCCCC"> binary so</font>

406
00:18:03,590 --> 00:18:09,559
we created this parser<font color="#CCCCCC"> for each one of</font>

407
00:18:06,500 --> 00:18:12,049
<font color="#CCCCCC">the lines that</font><font color="#E5E5E5"> we had we created this</font>

408
00:18:09,559 --> 00:18:14,480
table<font color="#E5E5E5"> so if we were at the beginning</font>

409
00:18:12,049 --> 00:18:17,389
with 10<font color="#E5E5E5"> gigawatts of information after</font>

410
00:18:14,480 --> 00:18:25,130
<font color="#E5E5E5">doing the parser we ended up with a</font>

411
00:18:17,390 --> 00:18:26,809
<font color="#CCCCCC">kinnor gigawatts we had the seed</font><font color="#E5E5E5"> the</font>

412
00:18:25,130 --> 00:18:30,080
name of the<font color="#E5E5E5"> system when the event</font>

413
00:18:26,809 --> 00:18:35,629
happened the<font color="#CCCCCC"> hostname the IP of</font><font color="#E5E5E5"> the ASAP</font>

414
00:18:30,080 --> 00:18:37,899
system the<font color="#CCCCCC"> username that</font><font color="#E5E5E5"> was used</font><font color="#CCCCCC"> to</font>

415
00:18:35,630 --> 00:18:40,610
<font color="#E5E5E5">produce that event</font>

416
00:18:37,900 --> 00:18:46,460
the message<font color="#E5E5E5"> from the SOP system per cell</font>

417
00:18:40,610 --> 00:18:48,709
and<font color="#E5E5E5"> the timestamp</font><font color="#CCCCCC"> so once we</font><font color="#E5E5E5"> were able</font>

418
00:18:46,460 --> 00:18:51,350
<font color="#E5E5E5">to parse of those slots we need</font>

419
00:18:48,710 --> 00:18:53,990
something to<font color="#E5E5E5"> correlate the</font><font color="#CCCCCC"> logs</font><font color="#E5E5E5"> we use</font>

420
00:18:51,350 --> 00:18:55,639
this plank<font color="#CCCCCC"> you can use any sim</font><font color="#E5E5E5"> that you</font>

421
00:18:53,990 --> 00:18:57,679
have in your company<font color="#E5E5E5"> but we use this</font>

422
00:18:55,640 --> 00:18:59,870
plan<font color="#E5E5E5"> by the way is</font><font color="#CCCCCC"> plant</font><font color="#E5E5E5"> even has</font><font color="#CCCCCC"> are</font>

423
00:18:57,679 --> 00:19:04,490
like a free trial version<font color="#E5E5E5"> if you want</font><font color="#CCCCCC"> to</font>

424
00:18:59,870 --> 00:19:06,559
try and once we<font color="#E5E5E5"> put it all the</font><font color="#CCCCCC"> events in</font>

425
00:19:04,490 --> 00:19:09,530
<font color="#CCCCCC">this plan we started notice something</font>

426
00:19:06,559 --> 00:19:13,309
very very common<font color="#E5E5E5"> and once we know that</font>

427
00:19:09,530 --> 00:19:15,830
<font color="#E5E5E5">and we knew</font><font color="#CCCCCC"> it the x time</font><font color="#E5E5E5"> yes just there</font>

428
00:19:13,309 --> 00:19:17,629
we could go inside<font color="#E5E5E5"> the SMP system with</font>

429
00:19:15,830 --> 00:19:21,168
<font color="#E5E5E5">the same</font><font color="#CCCCCC"> xx and corroborate the or</font>

430
00:19:17,630 --> 00:19:24,340
hypothesis<font color="#CCCCCC"> what you see and the first</font>

431
00:19:21,169 --> 00:19:27,110
chart is something very<font color="#CCCCCC"> common</font><font color="#E5E5E5"> is</font>

432
00:19:24,340 --> 00:19:31,010
basically<font color="#E5E5E5"> a brute</font><font color="#CCCCCC"> force over the</font><font color="#E5E5E5"> data</font>

433
00:19:27,110 --> 00:19:34,129
<font color="#E5E5E5">dictionary using NSIP that user in</font><font color="#CCCCCC"> SA P</font>

434
00:19:31,010 --> 00:19:36,289
is<font color="#CCCCCC"> ACP</font><font color="#E5E5E5"> underscore all that for you to</font>

435
00:19:34,130 --> 00:19:38,990
<font color="#E5E5E5">have an idea is live in</font><font color="#CCCCCC"> root on a UNIX</font>

436
00:19:36,289 --> 00:19:40,520
box is the<font color="#CCCCCC"> almighty user you</font><font color="#E5E5E5"> can do</font>

437
00:19:38,990 --> 00:19:42,890
whatever you want if you get<font color="#CCCCCC"> access to</font>

438
00:19:40,520 --> 00:19:45,200
that user so<font color="#CCCCCC"> what we're seeing here</font>

439
00:19:42,890 --> 00:19:49,400
<font color="#CCCCCC">we're</font><font color="#E5E5E5"> seeing a couple of failure logon</font>

440
00:19:45,200 --> 00:19:52,760
attempts<font color="#E5E5E5"> until we see a successful logon</font>

441
00:19:49,400 --> 00:19:55,549
and<font color="#E5E5E5"> a password</font><font color="#CCCCCC"> change of</font><font color="#E5E5E5"> that user the</font>

442
00:19:52,760 --> 00:19:56,990
first thing that<font color="#CCCCCC"> we did</font><font color="#E5E5E5"> is a ASAP basis</font>

443
00:19:55,549 --> 00:20:01,240
this was you

444
00:19:56,990 --> 00:20:01,240
they say no so we continue investigating

445
00:20:01,300 --> 00:20:06,980
we continue reviewing what this attacker

446
00:20:04,429 --> 00:20:09,080
was doing inside the ASAP system<font color="#E5E5E5"> and we</font>

447
00:20:06,980 --> 00:20:10,730
notice<font color="#CCCCCC"> that they call another</font>

448
00:20:09,080 --> 00:20:15,379
transaction<font color="#CCCCCC"> ACAD</font>

449
00:20:10,730 --> 00:20:17,080
in<font color="#E5E5E5"> SA P in order to code inside s AP is</font>

450
00:20:15,380 --> 00:20:20,030
not that you<font color="#E5E5E5"> will have a separate either</font>

451
00:20:17,080 --> 00:20:23,360
<font color="#E5E5E5">at least</font><font color="#CCCCCC"> most</font><font color="#E5E5E5"> of the times you had to</font>

452
00:20:20,030 --> 00:20:25,940
log in inside<font color="#E5E5E5"> the</font><font color="#CCCCCC"> s AP system</font><font color="#E5E5E5"> that is</font>

453
00:20:23,360 --> 00:20:29,928
the AC<font color="#E5E5E5"> ad they</font><font color="#CCCCCC"> erupted developing world</font>

454
00:20:25,940 --> 00:20:32,059
range<font color="#E5E5E5"> and there was a problem there when</font>

455
00:20:29,929 --> 00:20:35,120
we saw<font color="#CCCCCC"> that they were calling this</font>

456
00:20:32,059 --> 00:20:36,920
report that<font color="#CCCCCC"> report changed the entire</font>

457
00:20:35,120 --> 00:20:39,469
forensic investigation

458
00:20:36,920 --> 00:20:40,580
why because before that we<font color="#E5E5E5"> thought we</font>

459
00:20:39,470 --> 00:20:43,010
were<font color="#E5E5E5"> dealing</font><font color="#CCCCCC"> with</font><font color="#E5E5E5"> the script</font><font color="#CCCCCC"> kiddies</font>

460
00:20:40,580 --> 00:20:44,659
someone that was<font color="#CCCCCC"> like looking</font><font color="#E5E5E5"> at Google</font>

461
00:20:43,010 --> 00:20:47,840
with<font color="#CCCCCC"> the default password for that</font>

462
00:20:44,660 --> 00:20:49,700
<font color="#CCCCCC">default user</font><font color="#E5E5E5"> but this program</font><font color="#CCCCCC"> on to that</font>

463
00:20:47,840 --> 00:20:52,580
time I thought I<font color="#E5E5E5"> was the</font><font color="#CCCCCC"> only one</font><font color="#E5E5E5"> that</font>

464
00:20:49,700 --> 00:20:54,800
<font color="#E5E5E5">had that psyllid a technique to bypass</font>

465
00:20:52,580 --> 00:20:56,870
the security of the<font color="#CCCCCC"> lock this program</font>

466
00:20:54,800 --> 00:20:58,879
can be<font color="#E5E5E5"> used</font><font color="#CCCCCC"> to bypass the security only</font>

467
00:20:56,870 --> 00:21:00,800
<font color="#E5E5E5">log so</font><font color="#CCCCCC"> we were not</font><font color="#E5E5E5"> dealing just with a</font>

468
00:20:58,880 --> 00:21:02,840
script kiddie anymore<font color="#E5E5E5"> we're dealing with</font>

469
00:21:00,800 --> 00:21:08,629
<font color="#E5E5E5">someone</font><font color="#CCCCCC"> that had real and deep knowledge</font>

470
00:21:02,840 --> 00:21:11,510
<font color="#E5E5E5">on s IP this was a serious attack let me</font>

471
00:21:08,630 --> 00:21:17,390
show you you<font color="#E5E5E5"> don't have to believe me</font>

472
00:21:11,510 --> 00:21:19,670
<font color="#CCCCCC">let me show you how it works what you're</font>

473
00:21:17,390 --> 00:21:22,490
seeing<font color="#CCCCCC"> here is my Linux berta machine</font>

474
00:21:19,670 --> 00:21:23,840
I'm<font color="#E5E5E5"> going to open an SMB client</font><font color="#CCCCCC"> and I'm</font>

475
00:21:22,490 --> 00:21:25,670
going to<font color="#E5E5E5"> do exactly the</font><font color="#CCCCCC"> same that</font>

476
00:21:23,840 --> 00:21:27,709
<font color="#E5E5E5">attacker did we're going to replicate</font>

477
00:21:25,670 --> 00:21:29,600
exactly<font color="#CCCCCC"> the same we're going to see what</font>

478
00:21:27,710 --> 00:21:35,300
the security<font color="#CCCCCC"> elite trainers IP was able</font>

479
00:21:29,600 --> 00:21:39,230
to catch<font color="#E5E5E5"> so fail at logon attempt fail</font>

480
00:21:35,300 --> 00:21:41,419
at<font color="#E5E5E5"> Logan attempt and we're going</font><font color="#CCCCCC"> to</font>

481
00:21:39,230 --> 00:21:42,980
<font color="#CCCCCC">login</font><font color="#E5E5E5"> perfect we're inside the</font><font color="#CCCCCC"> s AP</font>

482
00:21:41,420 --> 00:21:49,190
<font color="#E5E5E5">system we're going to do</font><font color="#CCCCCC"> exactly the</font>

483
00:21:42,980 --> 00:21:52,610
same<font color="#E5E5E5"> let's go to a</font><font color="#CCCCCC"> CI D and as we</font><font color="#E5E5E5"> are</font>

484
00:21:49,190 --> 00:21:56,000
here let me<font color="#E5E5E5"> show</font><font color="#CCCCCC"> you what a Bob looks</font>

485
00:21:52,610 --> 00:21:59,330
like so<font color="#E5E5E5"> again something kind of similar</font>

486
00:21:56,000 --> 00:22:03,710
<font color="#CCCCCC">to Q basic and we're going</font><font color="#E5E5E5"> to execute</font>

487
00:21:59,330 --> 00:22:06,260
this<font color="#CCCCCC"> program this particular</font><font color="#E5E5E5"> program</font>

488
00:22:03,710 --> 00:22:08,000
will let us execute what is called the

489
00:22:06,260 --> 00:22:09,629
remote function calls<font color="#E5E5E5"> remember we</font>

490
00:22:08,000 --> 00:22:12,030
mentioned<font color="#E5E5E5"> at the beginning</font>

491
00:22:09,630 --> 00:22:14,700
there are hundreds and hundreds<font color="#E5E5E5"> and</font>

492
00:22:12,030 --> 00:22:16,620
hundreds of function calls<font color="#E5E5E5"> in</font><font color="#CCCCCC"> Si P you</font>

493
00:22:14,700 --> 00:22:19,169
could use function calls to<font color="#E5E5E5"> create users</font>

494
00:22:16,620 --> 00:22:21,360
to read tables to delete security of the

495
00:22:19,169 --> 00:22:23,340
log<font color="#CCCCCC"> attaches for this demonstration I'm</font>

496
00:22:21,360 --> 00:22:27,178
going to use<font color="#E5E5E5"> one that</font><font color="#CCCCCC"> is called Earth</font>

497
00:22:23,340 --> 00:22:30,168
<font color="#E5E5E5">see read table and of course this</font>

498
00:22:27,179 --> 00:22:32,730
function call reads<font color="#CCCCCC"> a table</font>

499
00:22:30,169 --> 00:22:37,789
you<font color="#E5E5E5"> just need to pull the table</font><font color="#CCCCCC"> that you</font>

500
00:22:32,730 --> 00:22:39,870
want<font color="#E5E5E5"> to read here you execute it and</font>

501
00:22:37,789 --> 00:22:43,980
automatically you<font color="#CCCCCC"> will get the content</font>

502
00:22:39,870 --> 00:22:46,049
of the table<font color="#E5E5E5"> let's see now what they say</font>

503
00:22:43,980 --> 00:22:48,720
<font color="#CCCCCC">B knows even</font><font color="#E5E5E5"> where the security</font><font color="#CCCCCC"> Ollie</font>

504
00:22:46,049 --> 00:22:52,860
log is fully activated<font color="#CCCCCC"> let me even close</font>

505
00:22:48,720 --> 00:22:57,409
<font color="#CCCCCC">the</font><font color="#E5E5E5"> entire session and we're going even</font>

506
00:22:52,860 --> 00:23:03,899
<font color="#E5E5E5">to use a completely different user oops</font>

507
00:22:57,409 --> 00:23:06,450
let's see we have we're going<font color="#E5E5E5"> to</font><font color="#CCCCCC"> go to</font>

508
00:23:03,900 --> 00:23:08,610
transaction<font color="#E5E5E5"> SM 20 and we're going to</font>

509
00:23:06,450 --> 00:23:14,000
<font color="#CCCCCC">even ask</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> ap</font><font color="#E5E5E5"> to reread</font><font color="#CCCCCC"> the LD lock</font>

510
00:23:08,610 --> 00:23:18,449
<font color="#CCCCCC">so</font><font color="#E5E5E5"> we can get most</font><font color="#CCCCCC"> out of it we</font><font color="#E5E5E5"> are here</font>

511
00:23:14,000 --> 00:23:21,570
first failure<font color="#CCCCCC"> logon attempt second</font>

512
00:23:18,450 --> 00:23:25,799
trailer<font color="#CCCCCC"> logon attempt we call</font>

513
00:23:21,570 --> 00:23:28,110
transaction<font color="#CCCCCC"> AC ad</font><font color="#E5E5E5"> and we use the RS and</font>

514
00:23:25,799 --> 00:23:32,270
<font color="#E5E5E5">scored this frame underscore call as you</font>

515
00:23:28,110 --> 00:23:35,520
can see what<font color="#CCCCCC"> happens</font><font color="#E5E5E5"> since there it's</font>

516
00:23:32,270 --> 00:23:38,370
<font color="#E5E5E5">completely invisible from</font><font color="#CCCCCC"> SAV we don't</font>

517
00:23:35,520 --> 00:23:40,590
know what function call was called we

518
00:23:38,370 --> 00:23:43,139
know the<font color="#E5E5E5"> input that</font><font color="#CCCCCC"> was</font><font color="#E5E5E5"> provide for that</font>

519
00:23:40,590 --> 00:23:46,530
<font color="#E5E5E5">function call and we don't know the</font>

520
00:23:43,140 --> 00:23:49,080
<font color="#E5E5E5">output so what do you think that means</font>

521
00:23:46,530 --> 00:23:50,970
<font color="#CCCCCC">from the forensic investigation point of</font>

522
00:23:49,080 --> 00:23:53,309
view well we<font color="#CCCCCC"> have to tell</font><font color="#E5E5E5"> the customer</font>

523
00:23:50,970 --> 00:23:55,650
<font color="#CCCCCC">you know what</font><font color="#E5E5E5"> you need to assume that</font>

524
00:23:53,309 --> 00:23:57,780
<font color="#E5E5E5">you were fully compromised there is no</font>

525
00:23:55,650 --> 00:23:59,730
way to discern what type of information

526
00:23:57,780 --> 00:24:01,500
<font color="#E5E5E5">was obtained about the attackers because</font>

527
00:23:59,730 --> 00:24:04,700
the security<font color="#CCCCCC"> of the log</font><font color="#E5E5E5"> is not getting</font>

528
00:24:01,500 --> 00:24:04,700
<font color="#E5E5E5">any</font><font color="#CCCCCC"> of that information</font>

529
00:24:05,390 --> 00:24:11,429
<font color="#CCCCCC">ok so moving forward the other</font>

530
00:24:09,720 --> 00:24:14,270
misconception that I<font color="#CCCCCC"> have for</font><font color="#E5E5E5"> you with</font>

531
00:24:11,429 --> 00:24:18,240
photos a pizzeria<font color="#E5E5E5"> tags were not real</font>

532
00:24:14,270 --> 00:24:20,760
this is<font color="#E5E5E5"> not is a really good one the</font>

533
00:24:18,240 --> 00:24:22,669
Treasury Department of an important

534
00:24:20,760 --> 00:24:25,190
country on the north

535
00:24:22,669 --> 00:24:28,279
<font color="#CCCCCC">medigun region gets visited by the</font>

536
00:24:25,190 --> 00:24:31,059
<font color="#CCCCCC">law-enforcement agency we don't care who</font>

537
00:24:28,279 --> 00:24:33,919
or<font color="#E5E5E5"> by what law</font><font color="#CCCCCC"> enforcement agency</font>

538
00:24:31,059 --> 00:24:36,049
apparently<font color="#CCCCCC"> their</font><font color="#E5E5E5"> entire platform was</font>

539
00:24:33,919 --> 00:24:38,809
compromised<font color="#E5E5E5"> and they were using that</font>

540
00:24:36,049 --> 00:24:41,210
platform<font color="#E5E5E5"> to distribute malware but there</font>

541
00:24:38,809 --> 00:24:43,340
is one particular<font color="#CCCCCC"> D here the law</font>

542
00:24:41,210 --> 00:24:45,499
enforcement tells<font color="#CCCCCC"> this Treasury</font>

543
00:24:43,340 --> 00:24:49,220
Department that<font color="#E5E5E5"> the tip of the spear</font><font color="#CCCCCC"> the</font>

544
00:24:45,499 --> 00:24:52,249
original<font color="#E5E5E5"> compromised over their platform</font>

545
00:24:49,220 --> 00:24:55,220
was through an NCP system a dual<font color="#E5E5E5"> stack</font>

546
00:24:52,249 --> 00:24:59,299
<font color="#CCCCCC">ap</font><font color="#E5E5E5"> system a</font><font color="#CCCCCC"> Bob and</font><font color="#E5E5E5"> Java</font><font color="#CCCCCC"> that was</font>

547
00:24:55,220 --> 00:25:01,220
directly exposed to<font color="#E5E5E5"> the</font><font color="#CCCCCC"> Internet</font><font color="#E5E5E5"> by the</font>

548
00:24:59,299 --> 00:25:04,309
<font color="#E5E5E5">time that we</font><font color="#CCCCCC"> actually arrived the system</font>

549
00:25:01,220 --> 00:25:06,200
was still exposed to<font color="#E5E5E5"> the Internet the</font>

550
00:25:04,309 --> 00:25:09,019
law<font color="#E5E5E5"> enforcement also</font><font color="#CCCCCC"> makes a very</font>

551
00:25:06,200 --> 00:25:11,869
<font color="#CCCCCC">particular claim they say that this</font>

552
00:25:09,019 --> 00:25:13,789
might<font color="#CCCCCC"> be</font><font color="#E5E5E5"> part of a sponsor</font><font color="#CCCCCC"> state attack</font>

553
00:25:11,869 --> 00:25:17,629
<font color="#E5E5E5">but they don't provide any kind of</font>

554
00:25:13,789 --> 00:25:20,119
<font color="#CCCCCC">evidence to support that claim</font><font color="#E5E5E5"> the main</font>

555
00:25:17,629 --> 00:25:22,759
concern<font color="#CCCCCC"> of this customer was at all</font>

556
00:25:20,119 --> 00:25:25,600
<font color="#E5E5E5">costs identified personal identifying</font>

557
00:25:22,759 --> 00:25:29,480
<font color="#E5E5E5">information was actually stolen</font><font color="#CCCCCC"> why</font>

558
00:25:25,600 --> 00:25:33,469
because if it was by law<font color="#E5E5E5"> they had to</font>

559
00:25:29,480 --> 00:25:35,389
make<font color="#E5E5E5"> it public</font><font color="#CCCCCC"> the second objective was</font>

560
00:25:33,470 --> 00:25:37,820
<font color="#CCCCCC">to understand okay what</font><font color="#E5E5E5"> happening how</font>

561
00:25:35,389 --> 00:25:41,719
they get in and if it was<font color="#CCCCCC"> lateral</font>

562
00:25:37,820 --> 00:25:44,809
<font color="#E5E5E5">movement or not with it exactly</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> same</font>

563
00:25:41,720 --> 00:25:47,389
<font color="#E5E5E5">procedure as</font><font color="#CCCCCC"> before a give us the</font>

564
00:25:44,809 --> 00:25:49,249
virtual machines<font color="#E5E5E5"> and let's start parsing</font>

565
00:25:47,389 --> 00:25:51,289
those<font color="#CCCCCC"> weird</font><font color="#E5E5E5"> machines</font><font color="#CCCCCC"> or parsing the</font><font color="#E5E5E5"> logs</font>

566
00:25:49,249 --> 00:25:52,700
inside the<font color="#CCCCCC"> border machines</font><font color="#E5E5E5"> the only</font>

567
00:25:51,289 --> 00:25:55,309
difference here<font color="#E5E5E5"> is that we already have</font>

568
00:25:52,700 --> 00:25:57,649
an idea<font color="#E5E5E5"> of what was the original tip of</font>

569
00:25:55,309 --> 00:25:59,600
the spear<font color="#E5E5E5"> what they were using to hack</font>

570
00:25:57,649 --> 00:26:01,070
into the ASAP system but of course we

571
00:25:59,600 --> 00:26:04,100
need<font color="#CCCCCC"> the evidence to actually prove it</font>

572
00:26:01,070 --> 00:26:06,710
<font color="#E5E5E5">so one more</font><font color="#CCCCCC"> time</font><font color="#E5E5E5"> the log table for you</font>

573
00:26:04,100 --> 00:26:08,418
to<font color="#E5E5E5"> follow if you have at home let's see</font>

574
00:26:06,710 --> 00:26:10,309
what we have<font color="#CCCCCC"> on T scenario the evap</font>

575
00:26:08,419 --> 00:26:12,039
security<font color="#CCCCCC"> all the</font><font color="#E5E5E5"> log that again we know</font>

576
00:26:10,309 --> 00:26:15,820
<font color="#CCCCCC">that it's</font><font color="#E5E5E5"> not activated by default</font>

577
00:26:12,039 --> 00:26:19,309
<font color="#E5E5E5">what's in there</font><font color="#CCCCCC"> now completely</font><font color="#E5E5E5"> empty</font>

578
00:26:15,820 --> 00:26:21,830
this<font color="#E5E5E5"> is a peek at way log</font><font color="#CCCCCC"> a very common</font>

579
00:26:19,309 --> 00:26:24,799
component very common to see<font color="#E5E5E5"> that is</font>

580
00:26:21,830 --> 00:26:26,539
under attack<font color="#CCCCCC"> doesn't come by default</font><font color="#E5E5E5"> the</font>

581
00:26:24,799 --> 00:26:30,499
logs<font color="#CCCCCC"> so it was not here</font>

582
00:26:26,539 --> 00:26:32,599
<font color="#E5E5E5">Misha's server nothing we were lucky as</font>

583
00:26:30,499 --> 00:26:34,669
I mentioned before<font color="#E5E5E5"> that the Java logs do</font>

584
00:26:32,599 --> 00:26:36,080
come by default<font color="#CCCCCC"> so we do</font><font color="#E5E5E5"> the witty</font>

585
00:26:34,669 --> 00:26:39,440
<font color="#CCCCCC">shadows and this</font>

586
00:26:36,080 --> 00:26:41,090
case<font color="#CCCCCC"> the operating</font><font color="#E5E5E5"> system was</font><font color="#CCCCCC"> Windows</font>

587
00:26:39,440 --> 00:26:45,799
and we also had<font color="#E5E5E5"> the logs from the</font>

588
00:26:41,090 --> 00:26:49,039
<font color="#E5E5E5">editing system we do exactly the</font><font color="#CCCCCC"> same we</font>

589
00:26:45,799 --> 00:26:51,289
start<font color="#E5E5E5"> creating the parsers to create the</font>

590
00:26:49,039 --> 00:26:53,289
logs<font color="#E5E5E5"> and as you can</font><font color="#CCCCCC"> see from</font><font color="#E5E5E5"> this plant</font>

591
00:26:51,289 --> 00:26:57,019
capture that<font color="#E5E5E5"> we have at the right side</font>

592
00:26:53,289 --> 00:26:59,720
<font color="#E5E5E5">it was very evident that the system was</font>

593
00:26:57,019 --> 00:27:02,179
compromised we starts<font color="#E5E5E5"> indirectly</font><font color="#CCCCCC"> their</font>

594
00:26:59,720 --> 00:27:03,980
operating system commands we start

595
00:27:02,179 --> 00:27:06,440
seeing<font color="#E5E5E5"> the attackers trying to shut down</font>

596
00:27:03,980 --> 00:27:09,380
the<font color="#E5E5E5"> windows firewalls Donna the shady</font>

597
00:27:06,440 --> 00:27:12,620
binaries and executing those binaries we

598
00:27:09,380 --> 00:27:14,149
even<font color="#E5E5E5"> go to see some heaters and east as</font>

599
00:27:12,620 --> 00:27:19,479
<font color="#CCCCCC">the image</font><font color="#E5E5E5"> that you will see at the left</font>

600
00:27:14,149 --> 00:27:21,709
side<font color="#E5E5E5"> of the</font><font color="#CCCCCC"> intrusion</font><font color="#E5E5E5"> and that</font><font color="#CCCCCC"> keine</font>

601
00:27:19,480 --> 00:27:24,620
<font color="#E5E5E5">supported or theory that we have before</font>

602
00:27:21,710 --> 00:27:28,279
<font color="#E5E5E5">at that point we knew what the Tucker's</font>

603
00:27:24,620 --> 00:27:30,139
utilized to compromise the<font color="#CCCCCC"> system what</font>

604
00:27:28,279 --> 00:27:33,860
they use is<font color="#E5E5E5"> something that is called in</font>

605
00:27:30,139 --> 00:27:38,178
<font color="#E5E5E5">pokers servlet the invoker servlet in</font><font color="#CCCCCC"> SA</font>

606
00:27:33,860 --> 00:27:41,899
P it's a class<font color="#CCCCCC"> loader</font><font color="#E5E5E5"> in meaning that it</font>

607
00:27:38,179 --> 00:27:45,409
will let you call<font color="#E5E5E5"> Java applications by</font>

608
00:27:41,899 --> 00:27:47,120
its name or<font color="#E5E5E5"> by the server class for</font>

609
00:27:45,409 --> 00:27:49,399
<font color="#CCCCCC">example if you go to</font><font color="#E5E5E5"> Jordan dot-com</font>

610
00:27:47,120 --> 00:27:51,289
<font color="#E5E5E5">slash myservlet it was exactly the</font><font color="#CCCCCC"> same</font>

611
00:27:49,399 --> 00:27:53,799
that if you go<font color="#E5E5E5"> to Jordan dot-com</font><font color="#CCCCCC"> slash</font>

612
00:27:51,289 --> 00:27:57,500
my package dot example dot<font color="#E5E5E5"> my servlet</font>

613
00:27:53,799 --> 00:27:59,539
<font color="#E5E5E5">but there is a problem</font><font color="#CCCCCC"> each time of that</font>

614
00:27:57,500 --> 00:28:01,639
you create a java application<font color="#CCCCCC"> you also</font>

615
00:27:59,539 --> 00:28:04,399
had<font color="#CCCCCC"> to</font><font color="#E5E5E5"> create a file</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> is called web</font>

616
00:28:01,639 --> 00:28:07,129
dot<font color="#CCCCCC"> xml and inside that file</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> are</font>

617
00:28:04,399 --> 00:28:10,820
<font color="#E5E5E5">going to say</font><font color="#CCCCCC"> ok every time</font><font color="#E5E5E5"> that someone</font>

618
00:28:07,130 --> 00:28:12,529
wants<font color="#CCCCCC"> to access</font><font color="#E5E5E5"> jordan comm slash</font>

619
00:28:10,820 --> 00:28:15,590
myservlet<font color="#E5E5E5"> you need to ask for username</font>

620
00:28:12,529 --> 00:28:17,539
<font color="#E5E5E5">password but there is a problem there</font><font color="#CCCCCC"> i</font>

621
00:28:15,590 --> 00:28:19,490
<font color="#E5E5E5">told you</font><font color="#CCCCCC"> before that you can call</font><font color="#E5E5E5"> it in</font>

622
00:28:17,539 --> 00:28:22,549
two<font color="#E5E5E5"> different ways</font><font color="#CCCCCC"> so what do you think</font>

623
00:28:19,490 --> 00:28:24,950
happened well when the the attacker goes

624
00:28:22,549 --> 00:28:27,110
to<font color="#CCCCCC"> jordan</font><font color="#E5E5E5"> come slash myservlet</font><font color="#CCCCCC"> ACP will</font>

625
00:28:24,950 --> 00:28:29,360
<font color="#CCCCCC">ask for username and password when the</font>

626
00:28:27,110 --> 00:28:32,178
attacker goes to jordan<font color="#CCCCCC"> comm slash my</font>

627
00:28:29,360 --> 00:28:34,879
package dot example dot<font color="#E5E5E5"> my servlet is a</font>

628
00:28:32,179 --> 00:28:37,580
complete authentication bypass<font color="#CCCCCC"> you</font>

629
00:28:34,880 --> 00:28:39,380
<font color="#E5E5E5">actually get to invoke every single</font>

630
00:28:37,580 --> 00:28:41,299
<font color="#CCCCCC">method or every</font><font color="#E5E5E5"> single functionality</font>

631
00:28:39,380 --> 00:28:43,639
exposed on that vulnerable web

632
00:28:41,299 --> 00:28:45,080
application one of the web applications

633
00:28:43,639 --> 00:28:47,178
<font color="#E5E5E5">that is vulnerable it will lead you to</font>

634
00:28:45,080 --> 00:28:49,090
execute<font color="#E5E5E5"> operating system comments and</font>

635
00:28:47,179 --> 00:28:52,150
also create<font color="#CCCCCC"> remote you</font>

636
00:28:49,090 --> 00:28:59,110
<font color="#CCCCCC">sirs</font><font color="#E5E5E5"> inside the</font><font color="#CCCCCC"> sav system but</font><font color="#E5E5E5"> again</font>

637
00:28:52,150 --> 00:29:00,580
<font color="#E5E5E5">don't</font><font color="#CCCCCC"> believe</font><font color="#E5E5E5"> me let me show you first</font>

638
00:28:59,110 --> 00:29:02,550
<font color="#E5E5E5">I'm going to show you that this is</font>

639
00:29:00,580 --> 00:29:05,590
nothing

640
00:29:02,550 --> 00:29:08,110
esoteric<font color="#E5E5E5"> this is the entire exploit that</font>

641
00:29:05,590 --> 00:29:11,860
<font color="#E5E5E5">by the way is available on the internet</font>

642
00:29:08,110 --> 00:29:14,139
<font color="#E5E5E5">and</font><font color="#CCCCCC"> it's in Metasploit for example we</font>

643
00:29:11,860 --> 00:29:17,969
<font color="#CCCCCC">are consuming one particular URL and</font>

644
00:29:14,140 --> 00:29:21,010
that's<font color="#E5E5E5"> it by invoking a Python script</font>

645
00:29:17,970 --> 00:29:22,780
<font color="#E5E5E5">you can</font><font color="#CCCCCC"> type</font><font color="#E5E5E5"> for</font><font color="#CCCCCC"> example Who am I place</font>

646
00:29:21,010 --> 00:29:24,879
the user that is actually running the

647
00:29:22,780 --> 00:29:27,250
ASAP<font color="#E5E5E5"> system</font><font color="#CCCCCC"> you can shut down the</font><font color="#E5E5E5"> ASAP</font>

648
00:29:24,880 --> 00:29:28,930
<font color="#CCCCCC">system you can corrupt</font><font color="#E5E5E5"> the kernel by</font>

649
00:29:27,250 --> 00:29:31,120
deleting<font color="#E5E5E5"> binaries you can jump</font><font color="#CCCCCC"> to the</font>

650
00:29:28,930 --> 00:29:38,920
database<font color="#E5E5E5"> you can</font><font color="#CCCCCC"> do whatever you want</font>

651
00:29:31,120 --> 00:29:41,409
you<font color="#CCCCCC"> can even do something</font><font color="#E5E5E5"> like this any</font>

652
00:29:38,920 --> 00:29:50,140
comment you<font color="#E5E5E5"> want you</font><font color="#CCCCCC"> are the owner of</font>

653
00:29:41,410 --> 00:29:52,390
<font color="#E5E5E5">the ASAP system</font><font color="#CCCCCC"> so what</font><font color="#E5E5E5"> that mean well</font>

654
00:29:50,140 --> 00:29:55,150
first of all it means that<font color="#E5E5E5"> our theory</font>

655
00:29:52,390 --> 00:29:57,550
<font color="#CCCCCC">was</font><font color="#E5E5E5"> right we suspected</font><font color="#CCCCCC"> that these guys</font>

656
00:29:55,150 --> 00:30:00,330
were compromised<font color="#CCCCCC"> by this</font><font color="#E5E5E5"> exploit that by</font>

657
00:29:57,550 --> 00:30:02,590
<font color="#E5E5E5">the way that exploit is five years old</font>

658
00:30:00,330 --> 00:30:04,659
<font color="#E5E5E5">what was the first thing that we need to</font>

659
00:30:02,590 --> 00:30:07,090
<font color="#CCCCCC">do is stop everything that we were doing</font>

660
00:30:04,660 --> 00:30:09,040
<font color="#E5E5E5">and go directly to the customer</font><font color="#CCCCCC"> and say</font>

661
00:30:07,090 --> 00:30:10,449
hey you need<font color="#E5E5E5"> to patch this as soon as</font>

662
00:30:09,040 --> 00:30:12,760
<font color="#E5E5E5">possible why because as I mentioned</font>

663
00:30:10,450 --> 00:30:14,770
<font color="#CCCCCC">before the</font><font color="#E5E5E5"> system was still exposed</font>

664
00:30:12,760 --> 00:30:17,410
directly<font color="#E5E5E5"> to the Internet</font><font color="#CCCCCC"> it was still</font>

665
00:30:14,770 --> 00:30:19,840
vulnerable<font color="#CCCCCC"> they had to</font><font color="#E5E5E5"> apply what</font><font color="#CCCCCC"> is</font>

666
00:30:17,410 --> 00:30:22,600
<font color="#CCCCCC">called is</font><font color="#E5E5E5"> a pin notes the notes that I</font>

667
00:30:19,840 --> 00:30:24,480
give<font color="#E5E5E5"> you right there</font><font color="#CCCCCC"> patching</font><font color="#E5E5E5"> as it is a</font>

668
00:30:22,600 --> 00:30:27,010
<font color="#E5E5E5">very controversial topic by the way and</font>

669
00:30:24,480 --> 00:30:29,320
the caveat here<font color="#CCCCCC"> is</font><font color="#E5E5E5"> that they need</font><font color="#CCCCCC"> to</font>

670
00:30:27,010 --> 00:30:33,160
restore<font color="#CCCCCC"> the isapi system for the changes</font>

671
00:30:29,320 --> 00:30:34,840
<font color="#CCCCCC">to</font><font color="#E5E5E5"> actually take effect perfect so we're</font>

672
00:30:33,160 --> 00:30:37,420
in the<font color="#E5E5E5"> right position</font><font color="#CCCCCC"> to understand what</font>

673
00:30:34,840 --> 00:30:39,490
happened<font color="#CCCCCC"> and we know now what was the</font>

674
00:30:37,420 --> 00:30:40,540
point of intrusion we need to know<font color="#CCCCCC"> ok</font><font color="#E5E5E5"> so</font>

675
00:30:39,490 --> 00:30:43,600
what<font color="#E5E5E5"> else happened</font>

676
00:30:40,540 --> 00:30:46,290
well we concluded that<font color="#E5E5E5"> yes 100% the</font>

677
00:30:43,600 --> 00:30:49,449
point of intrusion<font color="#CCCCCC"> on this file exploit</font>

678
00:30:46,290 --> 00:30:51,520
by analyzing the heuristics<font color="#E5E5E5"> of the</font>

679
00:30:49,450 --> 00:30:55,440
attacks<font color="#E5E5E5"> we were able</font><font color="#CCCCCC"> to see that</font><font color="#E5E5E5"> at</font>

680
00:30:51,520 --> 00:30:57,820
least<font color="#CCCCCC"> over three different</font><font color="#E5E5E5"> human beings</font>

681
00:30:55,440 --> 00:31:02,340
<font color="#E5E5E5">attacking the platform at different</font>

682
00:30:57,820 --> 00:31:04,560
<font color="#E5E5E5">periods of</font><font color="#CCCCCC"> time we were</font><font color="#E5E5E5"> not</font>

683
00:31:02,340 --> 00:31:06,419
able to<font color="#E5E5E5"> prove that personal identifying</font>

684
00:31:04,560 --> 00:31:08,340
<font color="#E5E5E5">information was</font><font color="#CCCCCC"> actually retrieve or</font>

685
00:31:06,420 --> 00:31:11,790
stolen and that's exactly<font color="#E5E5E5"> why you never</font>

686
00:31:08,340 --> 00:31:14,100
<font color="#CCCCCC">hear about</font><font color="#E5E5E5"> this case they were not</font>

687
00:31:11,790 --> 00:31:16,860
<font color="#CCCCCC">required by law to make it public so</font>

688
00:31:14,100 --> 00:31:18,360
they did not<font color="#E5E5E5"> and also we didn't see any</font>

689
00:31:16,860 --> 00:31:20,280
<font color="#E5E5E5">evidence of lateral movement that</font>

690
00:31:18,360 --> 00:31:22,320
<font color="#E5E5E5">occurred</font><font color="#CCCCCC"> chose attack a today's AP</font>

691
00:31:20,280 --> 00:31:24,330
system<font color="#CCCCCC"> and then try</font><font color="#E5E5E5"> to start hitting</font>

692
00:31:22,320 --> 00:31:28,710
things on the<font color="#CCCCCC"> DMZ or jump to the</font>

693
00:31:24,330 --> 00:31:30,480
<font color="#E5E5E5">Internet</font><font color="#CCCCCC"> so finally the</font><font color="#E5E5E5"> last</font>

694
00:31:28,710 --> 00:31:32,660
misconception that I have for<font color="#E5E5E5"> you is the</font>

695
00:31:30,480 --> 00:31:35,910
<font color="#CCCCCC">probability of an SCP cyberattack</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> low</font>

696
00:31:32,660 --> 00:31:39,690
<font color="#E5E5E5">okay this is</font><font color="#CCCCCC"> another</font><font color="#E5E5E5"> slightly</font><font color="#CCCCCC"> different</font>

697
00:31:35,910 --> 00:31:41,460
to the<font color="#CCCCCC"> others the IT security department</font>

698
00:31:39,690 --> 00:31:43,770
were concerned because<font color="#E5E5E5"> they have a</font>

699
00:31:41,460 --> 00:31:46,170
security in<font color="#E5E5E5"> the past a</font><font color="#CCCCCC"> couple months</font>

700
00:31:43,770 --> 00:31:49,350
before<font color="#E5E5E5"> we arrived and they suspected</font>

701
00:31:46,170 --> 00:31:51,870
that<font color="#E5E5E5"> the AP systems were actually we're</font>

702
00:31:49,350 --> 00:31:54,810
<font color="#CCCCCC">also compromised</font><font color="#E5E5E5"> in part of this</font><font color="#CCCCCC"> hack</font>

703
00:31:51,870 --> 00:31:56,850
<font color="#CCCCCC">that they had but the supreme</font><font color="#E5E5E5"> straighter</font>

704
00:31:54,810 --> 00:31:58,679
said the opposite they say no you know

705
00:31:56,850 --> 00:32:00,959
what our<font color="#CCCCCC"> receipe systems are clean</font>

706
00:31:58,680 --> 00:32:03,270
they're fully patched<font color="#E5E5E5"> nothing bad</font>

707
00:32:00,960 --> 00:32:05,250
happening<font color="#E5E5E5"> in our systems the ECP</font>

708
00:32:03,270 --> 00:32:07,650
security guys didn't have enough tools

709
00:32:05,250 --> 00:32:10,110
nor the knowledge to<font color="#CCCCCC"> actually prove them</font>

710
00:32:07,650 --> 00:32:12,150
wrong<font color="#E5E5E5"> or corroborate the theory so they</font>

711
00:32:10,110 --> 00:32:14,429
call<font color="#CCCCCC"> us and they say okay Jordan</font><font color="#E5E5E5"> we want</font>

712
00:32:12,150 --> 00:32:16,050
you to do two things<font color="#CCCCCC"> here first of</font><font color="#E5E5E5"> all</font><font color="#CCCCCC"> I</font>

713
00:32:14,430 --> 00:32:17,790
want you<font color="#CCCCCC"> to depend test</font><font color="#E5E5E5"> because we want</font>

714
00:32:16,050 --> 00:32:22,020
<font color="#CCCCCC">to see how it is to</font><font color="#E5E5E5"> breaking into the</font>

715
00:32:17,790 --> 00:32:24,840
systems and second<font color="#E5E5E5"> we want you to do a</font>

716
00:32:22,020 --> 00:32:27,510
forensic analysis this<font color="#E5E5E5"> is the</font><font color="#CCCCCC"> time frame</font>

717
00:32:24,840 --> 00:32:29,610
<font color="#E5E5E5">of where we had issues</font><font color="#CCCCCC"> in the</font><font color="#E5E5E5"> past we</font>

718
00:32:27,510 --> 00:32:30,840
want you to try<font color="#E5E5E5"> to find evidence that</font>

719
00:32:29,610 --> 00:32:36,659
<font color="#E5E5E5">the SOP systems were actually</font>

720
00:32:30,840 --> 00:32:38,820
<font color="#E5E5E5">compromised as well perfect every time</font>

721
00:32:36,660 --> 00:32:41,520
<font color="#E5E5E5">that I hear</font><font color="#CCCCCC"> that the probability of an</font>

722
00:32:38,820 --> 00:32:44,939
appeaser attack is low<font color="#E5E5E5"> I say yes and no</font>

723
00:32:41,520 --> 00:32:46,620
<font color="#CCCCCC">I mean definitely yes</font><font color="#E5E5E5"> if you compare it</font>

724
00:32:44,940 --> 00:32:48,260
<font color="#CCCCCC">with the probabilities of someone</font>

725
00:32:46,620 --> 00:32:51,389
attacking<font color="#E5E5E5"> your cell phone or your</font>

726
00:32:48,260 --> 00:32:53,940
workstation<font color="#E5E5E5"> but</font><font color="#CCCCCC"> s AP has a particularity</font>

727
00:32:51,390 --> 00:32:55,830
here take a look at the image that I

728
00:32:53,940 --> 00:33:00,810
<font color="#E5E5E5">have prepared for you that is a</font>

729
00:32:55,830 --> 00:33:03,720
vulnerability<font color="#E5E5E5"> of 2002 of that all the s</font>

730
00:33:00,810 --> 00:33:05,220
<font color="#E5E5E5">AP systems running Oracle</font><font color="#CCCCCC"> has a database</font>

731
00:33:03,720 --> 00:33:05,700
that by the<font color="#CCCCCC"> way is the most</font><font color="#E5E5E5"> common</font>

732
00:33:05,220 --> 00:33:08,550
flavor

733
00:33:05,700 --> 00:33:11,460
<font color="#E5E5E5">worldwide are having except if you</font><font color="#CCCCCC"> are</font>

734
00:33:08,550 --> 00:33:13,379
like the super<font color="#CCCCCC"> uber</font><font color="#E5E5E5"> greater kernel of</font><font color="#CCCCCC"> sa</font>

735
00:33:11,460 --> 00:33:14,140
<font color="#CCCCCC">picker and</font><font color="#E5E5E5"> the super uber mega version</font>

736
00:33:13,380 --> 00:33:17,590
of Oracle

737
00:33:14,140 --> 00:33:21,250
you are vulnerable this let<font color="#E5E5E5"> me tell you</font>

738
00:33:17,590 --> 00:33:23,740
that<font color="#E5E5E5"> 85% of the cases that you sit there</font>

739
00:33:21,250 --> 00:33:24,430
and you try<font color="#E5E5E5"> what I'm going to show you</font>

740
00:33:23,740 --> 00:33:27,130
soon

741
00:33:24,430 --> 00:33:29,410
you get compromising the ESP<font color="#CCCCCC"> system</font>

742
00:33:27,130 --> 00:33:35,740
database<font color="#E5E5E5"> without providing any kind of</font>

743
00:33:29,410 --> 00:33:36,460
username<font color="#E5E5E5"> passwords so what is the</font>

744
00:33:35,740 --> 00:33:38,140
problem here

745
00:33:36,460 --> 00:33:40,120
well in<font color="#CCCCCC"> s AP</font><font color="#E5E5E5"> there is something that</font><font color="#CCCCCC"> is</font>

746
00:33:38,140 --> 00:33:42,100
called<font color="#E5E5E5"> the OBS</font><font color="#CCCCCC"> dollar-sign</font><font color="#E5E5E5"> mode that</font>

747
00:33:40,120 --> 00:33:45,010
basically<font color="#E5E5E5"> Oracle trusted someone</font>

748
00:33:42,100 --> 00:33:47,379
somewhere<font color="#CCCCCC"> already authenticated the user</font>

749
00:33:45,010 --> 00:33:49,660
it doesn't<font color="#E5E5E5"> care who by default when you</font>

750
00:33:47,380 --> 00:33:51,490
<font color="#CCCCCC">start the ASAP system it creates an</font>

751
00:33:49,660 --> 00:33:54,070
operating system<font color="#E5E5E5"> user and that operating</font>

752
00:33:51,490 --> 00:33:58,990
system<font color="#CCCCCC"> user is mark at this</font><font color="#E5E5E5"> OBS dollar</font>

753
00:33:54,070 --> 00:34:01,450
<font color="#E5E5E5">Simon mechanism that user without</font>

754
00:33:58,990 --> 00:34:04,210
<font color="#E5E5E5">providing any telephone</font><font color="#CCCCCC"> 10th occation</font>

755
00:34:01,450 --> 00:34:07,360
connects to the<font color="#CCCCCC"> Oracle database and only</font>

756
00:34:04,210 --> 00:34:09,820
has access<font color="#CCCCCC"> to one particular</font><font color="#E5E5E5"> s AP table</font>

757
00:34:07,360 --> 00:34:12,370
is the<font color="#E5E5E5"> table is</font><font color="#CCCCCC"> AP user that has a</font>

758
00:34:09,820 --> 00:34:14,409
database user as well<font color="#E5E5E5"> and an encrypted</font>

759
00:34:12,370 --> 00:34:18,969
password<font color="#CCCCCC"> I know this is kind of</font>

760
00:34:14,409 --> 00:34:21,040
confusing<font color="#E5E5E5"> so I prepared this</font><font color="#CCCCCC"> for you the</font>

761
00:34:18,969 --> 00:34:23,379
application<font color="#E5E5E5"> server</font><font color="#CCCCCC"> says</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> I'm the</font>

762
00:34:21,040 --> 00:34:26,649
operating system user without<font color="#CCCCCC"> providing</font>

763
00:34:23,380 --> 00:34:29,200
anything<font color="#E5E5E5"> to you authenticate me and give</font>

764
00:34:26,649 --> 00:34:32,290
<font color="#E5E5E5">me the content of the ASAP user table</font>

765
00:34:29,199 --> 00:34:36,100
thank you<font color="#E5E5E5"> ASAP gets that content</font>

766
00:34:32,290 --> 00:34:39,449
<font color="#E5E5E5">decrypted connects again with the</font>

767
00:34:36,100 --> 00:34:42,250
database user and the password<font color="#E5E5E5"> that</font><font color="#CCCCCC"> user</font>

768
00:34:39,449 --> 00:34:45,908
<font color="#E5E5E5">the second user does have full</font>

769
00:34:42,250 --> 00:34:49,929
privileges<font color="#CCCCCC"> over the Oracle schema and</font>

770
00:34:45,909 --> 00:34:53,710
again let me<font color="#E5E5E5"> do this real</font><font color="#CCCCCC"> quick instead</font>

771
00:34:49,929 --> 00:34:56,440
of believing me<font color="#CCCCCC"> I can show you</font><font color="#E5E5E5"> we're</font>

772
00:34:53,710 --> 00:34:59,800
going<font color="#E5E5E5"> to attract one database that</font><font color="#CCCCCC"> is</font>

773
00:34:56,440 --> 00:35:05,080
called<font color="#CCCCCC"> tl-one so for that in</font><font color="#E5E5E5"> my machine</font>

774
00:34:59,800 --> 00:35:07,060
<font color="#CCCCCC">I created the user</font><font color="#E5E5E5"> till 1 atm</font>

775
00:35:05,080 --> 00:35:09,400
that's it<font color="#E5E5E5"> I'm just</font><font color="#CCCCCC"> creating a random</font>

776
00:35:07,060 --> 00:35:11,830
user<font color="#E5E5E5"> on my machine</font><font color="#CCCCCC"> and we're going to</font>

777
00:35:09,400 --> 00:35:14,710
use the<font color="#E5E5E5"> SQL plus this is</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> regular</font>

778
00:35:11,830 --> 00:35:16,900
database query utility that<font color="#E5E5E5"> you used for</font>

779
00:35:14,710 --> 00:35:19,870
<font color="#E5E5E5">Oracle is actually official for Oracle</font>

780
00:35:16,900 --> 00:35:21,670
and you're going<font color="#E5E5E5"> to tie this super super</font>

781
00:35:19,870 --> 00:35:27,359
complicated command<font color="#E5E5E5"> that</font><font color="#CCCCCC"> you see there</font>

782
00:35:21,670 --> 00:35:29,340
<font color="#CCCCCC">you do sqlplus / add target</font><font color="#E5E5E5"> one is</font>

783
00:35:27,360 --> 00:35:31,380
<font color="#CCCCCC">sfe</font><font color="#E5E5E5"> system that</font><font color="#CCCCCC"> I have running on</font><font color="#E5E5E5"> my</font>

784
00:35:29,340 --> 00:35:34,170
machine<font color="#E5E5E5"> 15:27</font>

785
00:35:31,380 --> 00:35:38,880
is the default port in<font color="#E5E5E5"> Oracle in the s</font>

786
00:35:34,170 --> 00:35:40,470
IP war until one is the database<font color="#E5E5E5"> that</font><font color="#CCCCCC"> I</font>

787
00:35:38,880 --> 00:35:44,220
<font color="#CCCCCC">want to connect</font><font color="#E5E5E5"> there are many ways to</font>

788
00:35:40,470 --> 00:35:45,299
<font color="#CCCCCC">brute-force</font><font color="#E5E5E5"> this database enter that's</font>

789
00:35:44,220 --> 00:35:47,910
it<font color="#E5E5E5"> I'm connected</font>

790
00:35:45,300 --> 00:35:52,640
<font color="#E5E5E5">I never provide username password but</font><font color="#CCCCCC"> I</font>

791
00:35:47,910 --> 00:35:54,089
<font color="#CCCCCC">am</font><font color="#E5E5E5"> connected but</font><font color="#CCCCCC"> I only have access</font><font color="#E5E5E5"> to</font>

792
00:35:52,640 --> 00:36:00,620
<font color="#CCCCCC">this table</font>

793
00:35:54,090 --> 00:36:03,450
<font color="#CCCCCC">sorry I only</font><font color="#E5E5E5"> have</font><font color="#CCCCCC"> access to this</font><font color="#E5E5E5"> table</font>

794
00:36:00,620 --> 00:36:07,770
<font color="#E5E5E5">what we did was reverse engineer the</font>

795
00:36:03,450 --> 00:36:10,230
algorithm that<font color="#E5E5E5"> Oracle was using and we</font>

796
00:36:07,770 --> 00:36:12,210
were able<font color="#E5E5E5"> to get the password for that</font>

797
00:36:10,230 --> 00:36:16,110
user as well<font color="#CCCCCC"> what is called the master</font>

798
00:36:12,210 --> 00:36:23,450
<font color="#E5E5E5">password and once you get the master</font>

799
00:36:16,110 --> 00:36:23,450
password<font color="#E5E5E5"> use the SQL plus again and now</font>

800
00:36:24,410 --> 00:36:29,460
<font color="#E5E5E5">you get full access over the s IP</font>

801
00:36:27,240 --> 00:36:32,790
database schema<font color="#E5E5E5"> you can steal credit</font>

802
00:36:29,460 --> 00:36:35,760
<font color="#CCCCCC">cards</font><font color="#E5E5E5"> you can do whatever you want for</font>

803
00:36:32,790 --> 00:36:38,480
us as a forensic<font color="#E5E5E5"> investigators this is</font>

804
00:36:35,760 --> 00:36:41,750
really bad<font color="#CCCCCC"> and</font><font color="#E5E5E5"> we're going to see what</font>

805
00:36:38,480 --> 00:36:41,750
or why

806
00:36:45,250 --> 00:36:51,220
so before that<font color="#E5E5E5"> there is a particularity</font>

807
00:36:48,780 --> 00:36:53,170
<font color="#E5E5E5">this authentication mechanism</font><font color="#CCCCCC"> on</font><font color="#E5E5E5"> you can</font>

808
00:36:51,220 --> 00:36:55,660
<font color="#CCCCCC">actually switch it off</font><font color="#E5E5E5"> actually</font>

809
00:36:53,170 --> 00:36:58,359
<font color="#CCCCCC">Oracle recommends it to turn it off and</font>

810
00:36:55,660 --> 00:37:00,970
it's now deprecated<font color="#E5E5E5"> but this EP in order</font>

811
00:36:58,359 --> 00:37:03,460
to make it ASAP<font color="#E5E5E5"> to work you need</font><font color="#CCCCCC"> to put</font>

812
00:37:00,970 --> 00:37:05,589
it in true<font color="#E5E5E5"> if you switch it</font><font color="#CCCCCC"> off</font><font color="#E5E5E5"> it's</font>

813
00:37:03,460 --> 00:37:07,660
even worse<font color="#E5E5E5"> because the</font><font color="#CCCCCC"> only</font><font color="#E5E5E5"> way that you</font>

814
00:37:05,590 --> 00:37:09,730
have<font color="#CCCCCC"> it to make the SF assistant work is</font>

815
00:37:07,660 --> 00:37:12,279
to have an<font color="#CCCCCC"> S ApS are three user with a</font>

816
00:37:09,730 --> 00:37:13,750
hard-coded<font color="#E5E5E5"> password</font><font color="#CCCCCC"> ASAP</font><font color="#E5E5E5"> so what you</font>

817
00:37:12,280 --> 00:37:15,130
need<font color="#CCCCCC"> to do</font><font color="#E5E5E5"> here is to restrict who can</font>

818
00:37:13,750 --> 00:37:19,990
<font color="#CCCCCC">actually connect to what is</font><font color="#E5E5E5"> called the</font>

819
00:37:15,130 --> 00:37:22,390
listener once we were able<font color="#E5E5E5"> to prove that</font>

820
00:37:19,990 --> 00:37:24,729
was really easy<font color="#CCCCCC"> to break</font><font color="#E5E5E5"> in we start</font>

821
00:37:22,390 --> 00:37:27,879
analyzing for backdoors<font color="#E5E5E5"> on the ASAP</font>

822
00:37:24,730 --> 00:37:29,470
program tables<font color="#E5E5E5"> long story</font><font color="#CCCCCC"> short and</font><font color="#E5E5E5"> I</font>

823
00:37:27,880 --> 00:37:32,380
had to trim the demo here<font color="#E5E5E5"> in order to</font>

824
00:37:29,470 --> 00:37:34,598
make it on<font color="#CCCCCC"> time</font><font color="#E5E5E5"> we start to</font><font color="#CCCCCC"> seen a lot</font>

825
00:37:32,380 --> 00:37:37,470
of backdoors planted inside the

826
00:37:34,599 --> 00:37:40,780
customers<font color="#CCCCCC"> NCP system and because of that</font>

827
00:37:37,470 --> 00:37:44,290
we needed<font color="#E5E5E5"> to</font><font color="#CCCCCC"> ask a full forensic</font>

828
00:37:40,780 --> 00:37:46,390
investigation or all the ASAP systems

829
00:37:44,290 --> 00:37:48,400
that were<font color="#E5E5E5"> in scope we were not able to</font>

830
00:37:46,390 --> 00:37:51,460
tell<font color="#E5E5E5"> because of</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> missing logs if that</font>

831
00:37:48,400 --> 00:37:53,800
bug doors were prior or after the

832
00:37:51,460 --> 00:37:55,810
intrusion<font color="#CCCCCC"> that this guys had the only</font>

833
00:37:53,800 --> 00:37:58,150
<font color="#E5E5E5">thing that we know</font><font color="#CCCCCC"> is that the</font><font color="#E5E5E5"> bugger</font>

834
00:37:55,810 --> 00:38:01,480
<font color="#CCCCCC">was injected in</font><font color="#E5E5E5"> them</font><font color="#CCCCCC"> it was transported</font>

835
00:37:58,150 --> 00:38:04,589
<font color="#E5E5E5">to QA and it was transported again to</font>

836
00:38:01,480 --> 00:38:07,359
<font color="#CCCCCC">production can</font><font color="#E5E5E5"> unlike in a legal way</font>

837
00:38:04,589 --> 00:38:08,349
so as I'm running<font color="#E5E5E5"> out of time and we're</font>

838
00:38:07,359 --> 00:38:09,670
wrapping<font color="#CCCCCC"> up here</font>

839
00:38:08,349 --> 00:38:13,210
what you can<font color="#E5E5E5"> expect from a forensic</font>

840
00:38:09,670 --> 00:38:15,160
<font color="#E5E5E5">investigation as a key first of all let</font>

841
00:38:13,210 --> 00:38:18,760
me<font color="#E5E5E5"> tell you does as I mentioned</font><font color="#CCCCCC"> it's a</font>

842
00:38:15,160 --> 00:38:21,670
highly complex<font color="#CCCCCC"> and difficult</font><font color="#E5E5E5"> discipline</font>

843
00:38:18,760 --> 00:38:25,570
<font color="#E5E5E5">more often than not the odds are not in</font>

844
00:38:21,670 --> 00:38:27,700
your<font color="#E5E5E5"> favor more often than not as well</font>

845
00:38:25,570 --> 00:38:30,310
the customer will not have<font color="#E5E5E5"> all the</font>

846
00:38:27,700 --> 00:38:32,890
available<font color="#E5E5E5"> logs to you that is the main</font>

847
00:38:30,310 --> 00:38:34,570
complication<font color="#E5E5E5"> here expect many data</font>

848
00:38:32,890 --> 00:38:36,129
sources<font color="#E5E5E5"> and entry</font><font color="#CCCCCC"> points if you</font><font color="#E5E5E5"> are</font>

849
00:38:34,570 --> 00:38:38,109
lucky enough<font color="#CCCCCC"> that</font><font color="#E5E5E5"> the customer will have</font>

850
00:38:36,130 --> 00:38:42,040
<font color="#E5E5E5">the</font><font color="#CCCCCC"> logs</font><font color="#E5E5E5"> available for you and because</font>

851
00:38:38,109 --> 00:38:43,930
<font color="#CCCCCC">of that easily</font><font color="#E5E5E5"> basically you might end</font>

852
00:38:42,040 --> 00:38:45,910
up<font color="#E5E5E5"> with terabytes of information to</font>

853
00:38:43,930 --> 00:38:48,700
process how that<font color="#E5E5E5"> seemed at hand and</font>

854
00:38:45,910 --> 00:38:51,848
<font color="#CCCCCC">hopefully you have a very</font><font color="#E5E5E5"> good hard</font>

855
00:38:48,700 --> 00:38:54,430
drive and the<font color="#E5E5E5"> most important in here</font>

856
00:38:51,849 --> 00:38:56,470
under no circumstances when you do a

857
00:38:54,430 --> 00:38:57,290
<font color="#CCCCCC">forensic investigation s</font><font color="#E5E5E5"> AP you can</font>

858
00:38:56,470 --> 00:39:01,310
<font color="#CCCCCC">guarantee</font>

859
00:38:57,290 --> 00:39:03,080
<font color="#E5E5E5">that the system was not compromised you</font>

860
00:39:01,310 --> 00:39:05,870
can do the<font color="#CCCCCC"> other way around</font><font color="#E5E5E5"> you can tell</font>

861
00:39:03,080 --> 00:39:08,330
yes<font color="#E5E5E5"> oh I can see here because of this</font>

862
00:39:05,870 --> 00:39:09,710
<font color="#E5E5E5">that your system has compromised but</font>

863
00:39:08,330 --> 00:39:11,840
never the other way around

864
00:39:09,710 --> 00:39:13,970
otherwise you<font color="#E5E5E5"> will be lying</font><font color="#CCCCCC"> I'm finally</font>

865
00:39:11,840 --> 00:39:16,280
prevent prevent prevent<font color="#E5E5E5"> the form</font><font color="#CCCCCC"> these</font>

866
00:39:13,970 --> 00:39:19,490
<font color="#E5E5E5">considerations are the root of all evil</font>

867
00:39:16,280 --> 00:39:22,160
<font color="#CCCCCC">I think we are doing good</font><font color="#E5E5E5"> with time but</font>

868
00:39:19,490 --> 00:39:24,529
thank you<font color="#CCCCCC"> and</font><font color="#E5E5E5"> if you have questions</font>

869
00:39:22,160 --> 00:39:25,759
please<font color="#CCCCCC"> feel free to us</font><font color="#E5E5E5"> also</font><font color="#CCCCCC"> we'll be</font><font color="#E5E5E5"> in</font>

870
00:39:24,530 --> 00:39:29,750
the conference<font color="#CCCCCC"> in case you want to ask</font>

871
00:39:25,760 --> 00:39:31,670
more<font color="#E5E5E5"> thank you thank you John we</font>

872
00:39:29,750 --> 00:39:35,870
actually have<font color="#E5E5E5"> time for one question</font>

873
00:39:31,670 --> 00:39:37,790
<font color="#E5E5E5">which has been asked is si</font><font color="#CCCCCC"> si P pen test</font>

874
00:39:35,870 --> 00:39:40,490
different<font color="#CCCCCC"> from a regular pen test for</font>

875
00:39:37,790 --> 00:39:41,300
<font color="#E5E5E5">example with web applications yes</font>

876
00:39:40,490 --> 00:39:44,450
<font color="#E5E5E5">absolutely</font>

877
00:39:41,300 --> 00:39:46,010
<font color="#E5E5E5">um</font><font color="#CCCCCC"> and normally</font><font color="#E5E5E5"> people ask</font><font color="#CCCCCC"> ok why we</font>

878
00:39:44,450 --> 00:39:48,529
don't<font color="#E5E5E5"> see too many hackers actually a</font>

879
00:39:46,010 --> 00:39:51,190
trying attack in<font color="#E5E5E5"> sa persistence</font>

880
00:39:48,530 --> 00:39:54,740
rather than<font color="#CCCCCC"> workstations</font><font color="#E5E5E5"> or phones well</font>

881
00:39:51,190 --> 00:39:56,270
before you learn how<font color="#CCCCCC"> to</font><font color="#E5E5E5"> actually attack</font>

882
00:39:54,740 --> 00:39:58,370
an<font color="#E5E5E5"> SI p system you also need to</font>

883
00:39:56,270 --> 00:40:01,430
<font color="#E5E5E5">understand the business side</font><font color="#CCCCCC"> ok why is</font>

884
00:39:58,370 --> 00:40:03,770
<font color="#CCCCCC">ap</font><font color="#E5E5E5"> was created how does it work and once</font>

885
00:40:01,430 --> 00:40:05,620
you had<font color="#E5E5E5"> the knowledge then you can start</font>

886
00:40:03,770 --> 00:40:08,150
<font color="#CCCCCC">doing a pen test</font><font color="#E5E5E5"> yes I would say that is</font>

887
00:40:05,620 --> 00:40:10,640
different especially<font color="#E5E5E5"> because if you</font>

888
00:40:08,150 --> 00:40:14,300
<font color="#E5E5E5">break</font><font color="#CCCCCC"> something you are breaking a</font>

889
00:40:10,640 --> 00:40:18,560
couple millions as<font color="#E5E5E5"> well well thank you</font>

890
00:40:14,300 --> 00:40:20,750
<font color="#E5E5E5">but any more questions</font><font color="#CCCCCC"> ok thank you</font><font color="#E5E5E5"> very</font>

891
00:40:18,560 --> 00:40:21,720
much<font color="#E5E5E5"> give Jordan my</font><font color="#CCCCCC"> friend close once</font>

892
00:40:20,750 --> 00:40:25,220
again thank<font color="#E5E5E5"> you</font>

893
00:40:21,720 --> 00:40:25,220
[Applause]

