1
00:00:00,080 --> 00:00:04,080
first time was in person obviously

2
00:00:04,160 --> 00:00:08,240
and uh and i'm going to assume that we

3
00:00:07,200 --> 00:00:10,080
have a similar crowd

4
00:00:08,240 --> 00:00:12,719
right so people who may be getting

5
00:00:10,080 --> 00:00:13,200
started in uh infosec you know looking

6
00:00:12,719 --> 00:00:15,360
to

7
00:00:13,200 --> 00:00:17,038
go into that world and so i wanted to

8
00:00:15,360 --> 00:00:17,919
take a minute and sort of talk through

9
00:00:17,039 --> 00:00:20,320
how i got

10
00:00:17,920 --> 00:00:20,960
into the industry and and maybe a little

11
00:00:20,320 --> 00:00:22,800
bit about

12
00:00:20,960 --> 00:00:24,800
how i see people being successful before

13
00:00:22,800 --> 00:00:27,599
i get into the bulk of my talk

14
00:00:24,800 --> 00:00:29,199
so um i got into infosec as a result of

15
00:00:27,599 --> 00:00:33,920
being extremely curious

16
00:00:29,199 --> 00:00:36,480
about how to watch nfl football

17
00:00:33,920 --> 00:00:37,840
so as a young kid basically you know

18
00:00:36,480 --> 00:00:39,120
looked into doing some reverse

19
00:00:37,840 --> 00:00:41,200
engineering into the

20
00:00:39,120 --> 00:00:42,959
satellite encryption the the encryption

21
00:00:41,200 --> 00:00:45,039
systems that directv and

22
00:00:42,960 --> 00:00:46,879
and dish network used and and basically

23
00:00:45,039 --> 00:00:50,559
spent some time poking around there and

24
00:00:46,879 --> 00:00:51,360
and um and and i share that not to say

25
00:00:50,559 --> 00:00:53,519
hey i'm some

26
00:00:51,360 --> 00:00:55,360
elite hacker dude or whatever i was part

27
00:00:53,520 --> 00:00:57,199
of a very large community that was

28
00:00:55,360 --> 00:00:58,559
uh looking into reverse engineering

29
00:00:57,199 --> 00:01:01,599
crypto that

30
00:00:58,559 --> 00:01:02,239
was protecting content but um what i'll

31
00:01:01,600 --> 00:01:04,640
tell you is

32
00:01:02,239 --> 00:01:05,920
that my secret to getting into this

33
00:01:04,640 --> 00:01:07,760
industry was

34
00:01:05,920 --> 00:01:09,600
finding something i was interested in

35
00:01:07,760 --> 00:01:10,080
finding a technology that i could get

36
00:01:09,600 --> 00:01:11,600
into

37
00:01:10,080 --> 00:01:14,240
and then sort of rolling it from there

38
00:01:11,600 --> 00:01:16,479
now um i will tell you you know don't go

39
00:01:14,240 --> 00:01:18,960
and do anything illegal or stupid

40
00:01:16,479 --> 00:01:19,600
um i was very fortunate in the fact that

41
00:01:18,960 --> 00:01:22,479
um

42
00:01:19,600 --> 00:01:24,158
when i got involved uh immediate within

43
00:01:22,479 --> 00:01:25,679
a very short amount of time some folks

44
00:01:24,159 --> 00:01:26,880
in federal law enforcement reached out

45
00:01:25,680 --> 00:01:28,240
to me and said hey

46
00:01:26,880 --> 00:01:29,600
we think it's a bad idea that you're

47
00:01:28,240 --> 00:01:31,199
doing what you're doing but maybe you

48
00:01:29,600 --> 00:01:33,199
can come work for us

49
00:01:31,200 --> 00:01:35,040
and i got the chance to go and do some

50
00:01:33,200 --> 00:01:36,479
things working for law enforcement that

51
00:01:35,040 --> 00:01:38,079
i never could have done

52
00:01:36,479 --> 00:01:39,679
on my own well i could have done i

53
00:01:38,079 --> 00:01:42,479
probably wouldn't end up in jail

54
00:01:39,680 --> 00:01:43,119
um and so that that's the early 90s

55
00:01:42,479 --> 00:01:45,119
right so

56
00:01:43,119 --> 00:01:46,720
you know now it's 30 years ago that i

57
00:01:45,119 --> 00:01:49,439
was doing that work

58
00:01:46,720 --> 00:01:50,479
and um and so now let's let's sort of

59
00:01:49,439 --> 00:01:52,559
roll forward

60
00:01:50,479 --> 00:01:54,079
about you know what what does it take

61
00:01:52,560 --> 00:01:56,240
for someone to do well

62
00:01:54,079 --> 00:01:57,600
in infosec today and doing cyber

63
00:01:56,240 --> 00:01:59,679
security well

64
00:01:57,600 --> 00:02:01,439
and the first thing i'll tell anybody is

65
00:01:59,680 --> 00:02:04,719
you need to make sure that you

66
00:02:01,439 --> 00:02:05,758
are an excellent technologist you very

67
00:02:04,719 --> 00:02:08,079
rarely can do

68
00:02:05,759 --> 00:02:09,360
security well if you don't know the

69
00:02:08,080 --> 00:02:12,640
security stack

70
00:02:09,360 --> 00:02:14,160
the technology stack soup to nuts and so

71
00:02:12,640 --> 00:02:16,879
a lot of folks who want to do well in

72
00:02:14,160 --> 00:02:17,840
cyber security oftentimes get guided to

73
00:02:16,879 --> 00:02:19,599
say okay well

74
00:02:17,840 --> 00:02:21,040
know about this particular attacker know

75
00:02:19,599 --> 00:02:22,238
about this particular monitoring

76
00:02:21,040 --> 00:02:23,760
technologies

77
00:02:22,239 --> 00:02:26,000
but my strong recommendation to

78
00:02:23,760 --> 00:02:26,720
everybody first is to go out and make

79
00:02:26,000 --> 00:02:28,400
sure

80
00:02:26,720 --> 00:02:30,080
that you are extremely strong in a

81
00:02:28,400 --> 00:02:31,599
particular technology and

82
00:02:30,080 --> 00:02:34,000
for those who are coming new into the

83
00:02:31,599 --> 00:02:34,959
industry go and focus on those emerging

84
00:02:34,000 --> 00:02:37,680
technologies

85
00:02:34,959 --> 00:02:38,000
so for example if if i were an 18 year

86
00:02:37,680 --> 00:02:41,519
old

87
00:02:38,000 --> 00:02:43,280
kid today and you know so if i go back

88
00:02:41,519 --> 00:02:45,840
in time and advise myself

89
00:02:43,280 --> 00:02:47,360
you know what would you do today if you

90
00:02:45,840 --> 00:02:49,280
were starting from scratch

91
00:02:47,360 --> 00:02:51,280
i would basically say you know

92
00:02:49,280 --> 00:02:52,560
technologies like starlink that

93
00:02:51,280 --> 00:02:54,480
spacex is coming out with there's going

94
00:02:52,560 --> 00:02:56,640
to be a whole range of cyber security

95
00:02:54,480 --> 00:02:58,799
problems that come as a result of

96
00:02:56,640 --> 00:03:00,000
ubiquitous satellite internet and so i

97
00:02:58,800 --> 00:03:02,239
think there's going to be a ton of

98
00:03:00,000 --> 00:03:04,480
really interesting stuff that's there

99
00:03:02,239 --> 00:03:05,440
and any emerging technology right

100
00:03:04,480 --> 00:03:07,280
whether it be

101
00:03:05,440 --> 00:03:09,120
relating to robotics or or something

102
00:03:07,280 --> 00:03:09,840
like that those are going to be areas

103
00:03:09,120 --> 00:03:11,760
that um

104
00:03:09,840 --> 00:03:13,360
that i would invest my time in to be a

105
00:03:11,760 --> 00:03:15,760
great technologist

106
00:03:13,360 --> 00:03:16,640
and then come in to do cyber security on

107
00:03:15,760 --> 00:03:20,000
top of it

108
00:03:16,640 --> 00:03:21,518
so if you have any uh questions about

109
00:03:20,000 --> 00:03:23,120
you know directions you should go

110
00:03:21,519 --> 00:03:25,280
feel free reach out to me through

111
00:03:23,120 --> 00:03:26,640
linkedin always happy to answer those

112
00:03:25,280 --> 00:03:29,440
questions

113
00:03:26,640 --> 00:03:31,599
so with that let me go ahead and share

114
00:03:29,440 --> 00:03:34,720
my

115
00:03:31,599 --> 00:03:35,119
there screen go so let's get into the

116
00:03:34,720 --> 00:03:38,319
meat

117
00:03:35,120 --> 00:03:38,319
of this presentation

118
00:03:40,080 --> 00:03:46,080
i started a business in march

119
00:03:43,120 --> 00:03:47,760
i was sitting i was actually living in

120
00:03:46,080 --> 00:03:50,400
europe at the time

121
00:03:47,760 --> 00:03:51,599
and the european coveted lockdown was

122
00:03:50,400 --> 00:03:54,080
extremely

123
00:03:51,599 --> 00:03:55,760
uh more aggressive than the united

124
00:03:54,080 --> 00:03:57,280
states one

125
00:03:55,760 --> 00:03:59,280
i actually had to get a state department

126
00:03:57,280 --> 00:04:02,720
letter to get out of luxembourg and to

127
00:03:59,280 --> 00:04:05,120
move my family back to the united states

128
00:04:02,720 --> 00:04:05,840
and so for a period of time it was

129
00:04:05,120 --> 00:04:07,599
illegal

130
00:04:05,840 --> 00:04:09,680
to wander the streets of luxembourg and

131
00:04:07,599 --> 00:04:11,280
you were fined ten thousand euros if you

132
00:04:09,680 --> 00:04:13,920
were out on the street

133
00:04:11,280 --> 00:04:15,599
and so i basically said okay well if i'm

134
00:04:13,920 --> 00:04:17,120
locked down and you know business is

135
00:04:15,599 --> 00:04:18,959
kind of slow and

136
00:04:17,120 --> 00:04:21,199
what am i going to do so i said you know

137
00:04:18,959 --> 00:04:23,680
what what would be an interesting

138
00:04:21,199 --> 00:04:25,600
security problem to solve and so in

139
00:04:23,680 --> 00:04:27,360
conjunction with the pandemic

140
00:04:25,600 --> 00:04:29,680
you know there's this massive movement

141
00:04:27,360 --> 00:04:31,759
of companies away from

142
00:04:29,680 --> 00:04:33,680
their traditional i.t systems and

143
00:04:31,759 --> 00:04:35,120
traditional infrastructure towards

144
00:04:33,680 --> 00:04:37,120
software as a service delivered things

145
00:04:35,120 --> 00:04:40,000
including microsoft 365

146
00:04:37,120 --> 00:04:41,919
but other things like z-scaler and and

147
00:04:40,000 --> 00:04:42,400
other cloud-based delivery platforms and

148
00:04:41,919 --> 00:04:44,560
so

149
00:04:42,400 --> 00:04:47,280
i said you know what what could i do to

150
00:04:44,560 --> 00:04:51,120
really dig into the security of it

151
00:04:47,280 --> 00:04:53,359
and um and so dig into the security let

152
00:04:51,120 --> 00:04:54,000
dogs dig into things and say i'll start

153
00:04:53,360 --> 00:04:56,320
a company

154
00:04:54,000 --> 00:04:58,160
that's named after a dog my favorite dog

155
00:04:56,320 --> 00:05:00,159
in mythology is serious

156
00:04:58,160 --> 00:05:03,199
all of the good serious domain names are

157
00:05:00,160 --> 00:05:06,080
taken so i'll name it cyrix with an x

158
00:05:03,199 --> 00:05:07,440
um and so i started a research project

159
00:05:06,080 --> 00:05:09,120
formed a company

160
00:05:07,440 --> 00:05:12,000
and and what i'm going to walk you

161
00:05:09,120 --> 00:05:13,840
through is sort of the trajectory of

162
00:05:12,000 --> 00:05:17,120
of how we've gone about trying to

163
00:05:13,840 --> 00:05:19,198
improve the security of data relative to

164
00:05:17,120 --> 00:05:21,199
the massive movement of data into

165
00:05:19,199 --> 00:05:23,440
microsoft 365.

166
00:05:21,199 --> 00:05:25,199
and you'll see here the ions logo in

167
00:05:23,440 --> 00:05:27,840
addition to being the founder and ceo of

168
00:05:25,199 --> 00:05:29,199
sirius i'm also an ions faculty member

169
00:05:27,840 --> 00:05:31,919
so i do a lot of my research and

170
00:05:29,199 --> 00:05:34,720
presentations in conjunction with them

171
00:05:31,919 --> 00:05:37,039
all right so if we think about you know

172
00:05:34,720 --> 00:05:39,280
the situation is that

173
00:05:37,039 --> 00:05:40,560
microsoft benefited from a massive

174
00:05:39,280 --> 00:05:44,559
windfall

175
00:05:40,560 --> 00:05:46,560
the the 2020 pandemic grow drove 22

176
00:05:44,560 --> 00:05:48,120
growth for them as far as the number of

177
00:05:46,560 --> 00:05:51,039
customers and it drove

178
00:05:48,120 --> 00:05:53,360
250 million paid seats of microsoft

179
00:05:51,039 --> 00:05:54,479
teams that's a quarter of a billion

180
00:05:53,360 --> 00:05:56,639
people who are now

181
00:05:54,479 --> 00:05:58,560
registered and signed up and paying for

182
00:05:56,639 --> 00:06:01,199
a microsoft team's license

183
00:05:58,560 --> 00:06:01,840
um i don't think we've seen that level

184
00:06:01,199 --> 00:06:04,160
of growth

185
00:06:01,840 --> 00:06:05,599
since i don't know the very very early

186
00:06:04,160 --> 00:06:07,680
days of the internet and so

187
00:06:05,600 --> 00:06:08,639
the 2020 fundamentally changed the way

188
00:06:07,680 --> 00:06:10,800
we collaborate

189
00:06:08,639 --> 00:06:12,160
heck you know we're doing this the this

190
00:06:10,800 --> 00:06:13,759
video conference over

191
00:06:12,160 --> 00:06:15,360
over zoom because we can't meet in

192
00:06:13,759 --> 00:06:18,560
person um

193
00:06:15,360 --> 00:06:21,600
and so the irony of this

194
00:06:18,560 --> 00:06:24,639
is that microsoft 365

195
00:06:21,600 --> 00:06:28,400
what is the microsoft 365 platform today

196
00:06:24,639 --> 00:06:28,880
was originally developed as a way to try

197
00:06:28,400 --> 00:06:31,039
to keep

198
00:06:28,880 --> 00:06:32,240
exchange microsoft exchange server

199
00:06:31,039 --> 00:06:34,400
customers happy

200
00:06:32,240 --> 00:06:35,440
and for full disclosure's sake i worked

201
00:06:34,400 --> 00:06:38,960
at microsoft from

202
00:06:35,440 --> 00:06:40,719
uh 99 until 2006 and so i was on the

203
00:06:38,960 --> 00:06:42,560
team that built the first

204
00:06:40,720 --> 00:06:44,720
application service provider version of

205
00:06:42,560 --> 00:06:47,360
exchange it was called

206
00:06:44,720 --> 00:06:48,880
hosted exchange for isps so imagine

207
00:06:47,360 --> 00:06:50,560
running an internet service writer on

208
00:06:48,880 --> 00:06:52,560
exchange in the year 2000 that was an

209
00:06:50,560 --> 00:06:54,479
interesting project

210
00:06:52,560 --> 00:06:56,319
but we basically when i was at microsoft

211
00:06:54,479 --> 00:06:58,080
we had created this online hosting

212
00:06:56,319 --> 00:07:00,080
version because so many people were so

213
00:06:58,080 --> 00:07:02,318
dissatisfied with exchange

214
00:07:00,080 --> 00:07:04,479
and so generally the the way people get

215
00:07:02,319 --> 00:07:06,080
into microsoft 365 is because they're

216
00:07:04,479 --> 00:07:08,400
tired of hosting exchange

217
00:07:06,080 --> 00:07:09,758
and they maybe tried g suite and it just

218
00:07:08,400 --> 00:07:10,960
wasn't good enough for their users and

219
00:07:09,759 --> 00:07:12,400
so they end up saying okay

220
00:07:10,960 --> 00:07:14,638
we're going to go to exchange online

221
00:07:12,400 --> 00:07:16,080
let's go so whether

222
00:07:14,639 --> 00:07:18,080
you got there as the result of the

223
00:07:16,080 --> 00:07:19,680
pandemic windfall or you got there as a

224
00:07:18,080 --> 00:07:23,520
result of exchange online

225
00:07:19,680 --> 00:07:24,960
hey the majority of of uh of enterprises

226
00:07:23,520 --> 00:07:26,639
in the united states and the united

227
00:07:24,960 --> 00:07:29,680
kingdom at least

228
00:07:26,639 --> 00:07:32,080
are now microsoft 365 users

229
00:07:29,680 --> 00:07:33,360
so what do you get when you sign up for

230
00:07:32,080 --> 00:07:34,960
this service

231
00:07:33,360 --> 00:07:36,720
you get exchange online you get

232
00:07:34,960 --> 00:07:37,758
microsoft teams you know onedrive

233
00:07:36,720 --> 00:07:39,840
sharepoint

234
00:07:37,759 --> 00:07:41,039
skype for business wait a second skype

235
00:07:39,840 --> 00:07:43,039
for business and teams

236
00:07:41,039 --> 00:07:44,560
yeah you get both and there are

237
00:07:43,039 --> 00:07:45,360
configurations for both those that

238
00:07:44,560 --> 00:07:47,280
impact the

239
00:07:45,360 --> 00:07:48,800
your security posture you get my

240
00:07:47,280 --> 00:07:51,119
analytics yammer

241
00:07:48,800 --> 00:07:52,879
microsoft 365 business voice wait a

242
00:07:51,120 --> 00:07:53,599
second there's a voice service in this

243
00:07:52,879 --> 00:07:57,680
thing

244
00:07:53,599 --> 00:07:59,520
um and so but most importantly

245
00:07:57,680 --> 00:08:01,440
you have now inherited all of the

246
00:07:59,520 --> 00:08:02,479
security problems relating to azure

247
00:08:01,440 --> 00:08:03,840
active directory

248
00:08:02,479 --> 00:08:05,359
and this is something that most

249
00:08:03,840 --> 00:08:06,638
organizations have have not thought

250
00:08:05,360 --> 00:08:08,879
through

251
00:08:06,639 --> 00:08:10,560
but wait there's more when you sign up

252
00:08:08,879 --> 00:08:12,479
for microsoft 365. here are the

253
00:08:10,560 --> 00:08:14,879
additional services that you get

254
00:08:12,479 --> 00:08:16,560
things like planner power automate

255
00:08:14,879 --> 00:08:20,160
microsoft teams

256
00:08:16,560 --> 00:08:22,720
a stream delve sway these are

257
00:08:20,160 --> 00:08:24,560
applications that may not resonate to

258
00:08:22,720 --> 00:08:26,879
you as far as a branding perspective

259
00:08:24,560 --> 00:08:28,000
but they all are ways by which attackers

260
00:08:26,879 --> 00:08:30,400
can enumerate

261
00:08:28,000 --> 00:08:32,640
your microsoft 365 platform and

262
00:08:30,400 --> 00:08:34,559
potentially exfiltrate data to bypass

263
00:08:32,640 --> 00:08:36,799
your data loss protection controls

264
00:08:34,559 --> 00:08:38,559
and so each one of these services has

265
00:08:36,799 --> 00:08:41,199
certain security configurations

266
00:08:38,559 --> 00:08:41,760
that you should be aware of so what we

267
00:08:41,200 --> 00:08:44,320
did

268
00:08:41,760 --> 00:08:45,920
in my research time is is we used a

269
00:08:44,320 --> 00:08:46,800
combination of microsoft powershell

270
00:08:45,920 --> 00:08:50,160
scripts

271
00:08:46,800 --> 00:08:52,640
and and the graph api to enumerate

272
00:08:50,160 --> 00:08:54,240
what what are these configurations and

273
00:08:52,640 --> 00:08:57,360
even in the basic or the

274
00:08:54,240 --> 00:09:00,880
e3 level of microsoft 365

275
00:08:57,360 --> 00:09:02,720
we found over 7500 individual settings

276
00:09:00,880 --> 00:09:04,640
some of these are not available through

277
00:09:02,720 --> 00:09:05,839
the ui you can't access them through the

278
00:09:04,640 --> 00:09:07,600
administrator portal

279
00:09:05,839 --> 00:09:09,760
you only can interact with them through

280
00:09:07,600 --> 00:09:14,480
powershell or the graph api

281
00:09:09,760 --> 00:09:16,319
and so when we took a look at these

282
00:09:14,480 --> 00:09:18,800
for high security organizations we

283
00:09:16,320 --> 00:09:20,800
believe that as many as 30 percent of

284
00:09:18,800 --> 00:09:23,120
the 7500 settings

285
00:09:20,800 --> 00:09:24,160
could have some impact on your

286
00:09:23,120 --> 00:09:27,839
organization's

287
00:09:24,160 --> 00:09:28,480
data or identities now not only is that

288
00:09:27,839 --> 00:09:30,959
a massive

289
00:09:28,480 --> 00:09:32,640
hill to climb to start but microsoft is

290
00:09:30,959 --> 00:09:34,959
releasing more apps every month

291
00:09:32,640 --> 00:09:36,240
and sometimes more security features

292
00:09:34,959 --> 00:09:38,319
within the apps they have released so

293
00:09:36,240 --> 00:09:40,880
for example this month alone

294
00:09:38,320 --> 00:09:42,399
microsoft has released 12 different

295
00:09:40,880 --> 00:09:43,120
security settings for azure active

296
00:09:42,399 --> 00:09:45,760
directory

297
00:09:43,120 --> 00:09:47,519
and that's just the p1 level now p2

298
00:09:45,760 --> 00:09:48,480
we've found over 40 different settings

299
00:09:47,519 --> 00:09:51,440
that they've released

300
00:09:48,480 --> 00:09:53,120
and these all are just keep you know

301
00:09:51,440 --> 00:09:54,720
getting piled on top of the stack that

302
00:09:53,120 --> 00:09:56,720
you already have

303
00:09:54,720 --> 00:09:58,080
so let's take a minute here and we say

304
00:09:56,720 --> 00:10:00,480
okay well

305
00:09:58,080 --> 00:10:02,560
why why should i care about this why why

306
00:10:00,480 --> 00:10:04,160
why is this something that

307
00:10:02,560 --> 00:10:06,640
that is something i should be spending

308
00:10:04,160 --> 00:10:08,319
time on let's talk through

309
00:10:06,640 --> 00:10:11,279
some of the incidents that we've had to

310
00:10:08,320 --> 00:10:13,600
clean up over the last couple of years

311
00:10:11,279 --> 00:10:15,760
so the first one is a global admin

312
00:10:13,600 --> 00:10:17,519
account takeover

313
00:10:15,760 --> 00:10:19,519
so this incident started with a browser

314
00:10:17,519 --> 00:10:20,399
exploit and we believe it was probably

315
00:10:19,519 --> 00:10:22,800
opportunistic

316
00:10:20,399 --> 00:10:23,680
so global admin surfing from their

317
00:10:22,800 --> 00:10:26,240
computer

318
00:10:23,680 --> 00:10:27,439
goes gets caught in someone's net

319
00:10:26,240 --> 00:10:30,480
browser exploit

320
00:10:27,440 --> 00:10:32,160
pops the the attacker essentially gets

321
00:10:30,480 --> 00:10:35,760
the ability to install a

322
00:10:32,160 --> 00:10:37,360
keystroke logger to get credentials

323
00:10:35,760 --> 00:10:38,640
software is a service that's a problem

324
00:10:37,360 --> 00:10:39,839
right because you have to interact with

325
00:10:38,640 --> 00:10:40,880
the software as a service through a

326
00:10:39,839 --> 00:10:43,519
browser so now

327
00:10:40,880 --> 00:10:44,160
the attacker has the credentials but

328
00:10:43,519 --> 00:10:46,000
luckily

329
00:10:44,160 --> 00:10:47,279
this organization had multi-factor

330
00:10:46,000 --> 00:10:48,880
authentication set up they had their

331
00:10:47,279 --> 00:10:52,160
microsoft authenticator

332
00:10:48,880 --> 00:10:54,079
taken care of oh but actually

333
00:10:52,160 --> 00:10:55,199
this global admins microsoft

334
00:10:54,079 --> 00:10:58,319
authenticator was

335
00:10:55,200 --> 00:11:01,040
installed on a vulnerable iphone

336
00:10:58,320 --> 00:11:03,120
the attackers went to github dumped a

337
00:11:01,040 --> 00:11:05,680
set of remote exploitation tools that

338
00:11:03,120 --> 00:11:07,279
were available for his version of ios

339
00:11:05,680 --> 00:11:08,640
targeted him with those remote

340
00:11:07,279 --> 00:11:10,240
exploitation tools

341
00:11:08,640 --> 00:11:11,920
and then captured the microsoft

342
00:11:10,240 --> 00:11:16,000
authenticator keys

343
00:11:11,920 --> 00:11:18,640
now the downside of using soft tokens

344
00:11:16,000 --> 00:11:19,600
is that the encryption keys that drive

345
00:11:18,640 --> 00:11:22,480
the integrity

346
00:11:19,600 --> 00:11:24,560
of that soft token have to be installed

347
00:11:22,480 --> 00:11:26,160
in the ios keychain or in the android

348
00:11:24,560 --> 00:11:28,800
key store

349
00:11:26,160 --> 00:11:30,399
that means that if someone gets a remote

350
00:11:28,800 --> 00:11:33,120
exploit vulnerability

351
00:11:30,399 --> 00:11:34,079
that they can clone that authenticator

352
00:11:33,120 --> 00:11:36,560
key set

353
00:11:34,079 --> 00:11:38,399
so now the attacker has the username and

354
00:11:36,560 --> 00:11:39,920
password from the browser exploit

355
00:11:38,399 --> 00:11:42,480
they have successfully cloned the

356
00:11:39,920 --> 00:11:44,640
microsoft authenticator so now

357
00:11:42,480 --> 00:11:47,279
they are the global admin right there's

358
00:11:44,640 --> 00:11:49,360
no way to tell the two apart

359
00:11:47,279 --> 00:11:51,120
and what these particular attackers did

360
00:11:49,360 --> 00:11:52,800
is they turned on all of the exchange

361
00:11:51,120 --> 00:11:55,600
online powershell commands

362
00:11:52,800 --> 00:11:56,319
to harvest information from the ceo cfos

363
00:11:55,600 --> 00:11:58,560
and other

364
00:11:56,320 --> 00:12:00,000
senior leaders of this company we

365
00:11:58,560 --> 00:12:01,680
believe this was done mainly for

366
00:12:00,000 --> 00:12:02,079
financial market arbitrage so in this

367
00:12:01,680 --> 00:12:03,680
case

368
00:12:02,079 --> 00:12:05,599
the bad guys came in and were looking

369
00:12:03,680 --> 00:12:07,279
for access to pre-market data which

370
00:12:05,600 --> 00:12:09,760
would they then use to trade

371
00:12:07,279 --> 00:12:11,360
this was an organization that was very

372
00:12:09,760 --> 00:12:12,160
involved in merger and acquisition

373
00:12:11,360 --> 00:12:13,920
activity

374
00:12:12,160 --> 00:12:15,279
and so we believe that this was all done

375
00:12:13,920 --> 00:12:17,279
for financial gain so while the

376
00:12:15,279 --> 00:12:18,959
beginning started as opportunistic

377
00:12:17,279 --> 00:12:20,480
that opportunistic attacker probably

378
00:12:18,959 --> 00:12:21,680
sold their foot hold on to a more

379
00:12:20,480 --> 00:12:23,200
sophisticated group

380
00:12:21,680 --> 00:12:24,959
the sophisticated group then went and

381
00:12:23,200 --> 00:12:26,639
exploited the additional vulnerabilities

382
00:12:24,959 --> 00:12:27,359
to gain access to the global admin

383
00:12:26,639 --> 00:12:29,680
account

384
00:12:27,360 --> 00:12:31,519
this went on for over six months so this

385
00:12:29,680 --> 00:12:32,880
was a long-term

386
00:12:31,519 --> 00:12:34,880
foothold that they had that they were

387
00:12:32,880 --> 00:12:35,920
abusing because of poor hygiene on the

388
00:12:34,880 --> 00:12:39,760
device

389
00:12:35,920 --> 00:12:41,439
poor global admin processes

390
00:12:39,760 --> 00:12:43,519
and so there's a whole bunch of problems

391
00:12:41,440 --> 00:12:47,440
here so there's one case

392
00:12:43,519 --> 00:12:50,480
right next case

393
00:12:47,440 --> 00:12:52,399
a few months ago the sans institute had

394
00:12:50,480 --> 00:12:54,800
to disclose that they had a

395
00:12:52,399 --> 00:12:56,480
leakage of some of their customer data

396
00:12:54,800 --> 00:12:58,000
now i don't know this for a fact and

397
00:12:56,480 --> 00:13:00,639
this is just all hearsay but

398
00:12:58,000 --> 00:13:01,120
through the grapevine it was suggested

399
00:13:00,639 --> 00:13:03,600
that

400
00:13:01,120 --> 00:13:04,720
that sans incident began with a

401
00:13:03,600 --> 00:13:06,079
microsoft plugin

402
00:13:04,720 --> 00:13:08,240
one of the plugins that you can install

403
00:13:06,079 --> 00:13:11,439
in outlook or teams or

404
00:13:08,240 --> 00:13:12,399
or whatever and so whether that's true

405
00:13:11,440 --> 00:13:14,720
or not

406
00:13:12,399 --> 00:13:16,320
we have found several instances where

407
00:13:14,720 --> 00:13:18,639
malicious plugins well

408
00:13:16,320 --> 00:13:19,839
where plugins have been used as a

409
00:13:18,639 --> 00:13:21,839
flexing vector by

410
00:13:19,839 --> 00:13:23,360
attackers so the the plug-in may not be

411
00:13:21,839 --> 00:13:24,959
malicious in and of itself

412
00:13:23,360 --> 00:13:26,560
but because the plug-in is so poorly

413
00:13:24,959 --> 00:13:28,160
engineered and has not properly gone

414
00:13:26,560 --> 00:13:29,680
through any sort of vetting process

415
00:13:28,160 --> 00:13:31,199
it's essentially a malicious plug-in

416
00:13:29,680 --> 00:13:33,040
because it ends up being

417
00:13:31,200 --> 00:13:34,320
the vector by which the attacker flows

418
00:13:33,040 --> 00:13:37,199
through

419
00:13:34,320 --> 00:13:38,240
we've seen one case where microsoft 365

420
00:13:37,200 --> 00:13:39,760
power automate

421
00:13:38,240 --> 00:13:41,360
was used to clone share drive and

422
00:13:39,760 --> 00:13:43,120
onedrive repositories

423
00:13:41,360 --> 00:13:44,880
and then send the data out through a

424
00:13:43,120 --> 00:13:46,560
plug-in to a third-party site

425
00:13:44,880 --> 00:13:48,320
so you have to think about what are you

426
00:13:46,560 --> 00:13:51,119
really getting in bed with when you go

427
00:13:48,320 --> 00:13:54,320
down the plug-in route

428
00:13:51,120 --> 00:13:55,279
we've seen tons of of exploits against

429
00:13:54,320 --> 00:13:58,480
the microsoft

430
00:13:55,279 --> 00:14:00,320
graph data api so the microsoft graph

431
00:13:58,480 --> 00:14:01,839
api gives you access to all sorts of

432
00:14:00,320 --> 00:14:02,720
interesting things to query address

433
00:14:01,839 --> 00:14:04,639
books to

434
00:14:02,720 --> 00:14:05,760
to get access to email to get access to

435
00:14:04,639 --> 00:14:08,000
sharepoint sites

436
00:14:05,760 --> 00:14:09,360
but when it's not properly configured it

437
00:14:08,000 --> 00:14:11,279
essentially becomes

438
00:14:09,360 --> 00:14:12,800
an open exploitation gateway to get

439
00:14:11,279 --> 00:14:14,800
access to data without proper

440
00:14:12,800 --> 00:14:16,880
authentication or authorization

441
00:14:14,800 --> 00:14:19,199
and we've got dozens of other incidents

442
00:14:16,880 --> 00:14:21,680
that we've helped to clean up

443
00:14:19,199 --> 00:14:23,359
so if we think about trying to

444
00:14:21,680 --> 00:14:26,479
prioritize these incidents

445
00:14:23,360 --> 00:14:28,399
what where's the place well

446
00:14:26,480 --> 00:14:30,399
let's take a moment to talk about azure

447
00:14:28,399 --> 00:14:32,639
active directory

448
00:14:30,399 --> 00:14:34,160
you have to have it you can't turn on

449
00:14:32,639 --> 00:14:36,320
microsoft 365

450
00:14:34,160 --> 00:14:37,360
without some form of azure active

451
00:14:36,320 --> 00:14:40,480
directory connection

452
00:14:37,360 --> 00:14:42,560
and even in a one-way sync situation

453
00:14:40,480 --> 00:14:44,000
azure active directory creates

454
00:14:42,560 --> 00:14:46,160
vulnerabilities that most

455
00:14:44,000 --> 00:14:47,279
organizations are not properly resourced

456
00:14:46,160 --> 00:14:49,600
to take care of

457
00:14:47,279 --> 00:14:51,040
so if your eyes are starting to glaze

458
00:14:49,600 --> 00:14:52,639
over here and go oh man

459
00:14:51,040 --> 00:14:54,160
too much stuff whatever what's the

460
00:14:52,639 --> 00:14:56,000
bottom line you know

461
00:14:54,160 --> 00:14:57,199
you should treat azure active directory

462
00:14:56,000 --> 00:14:58,639
as if it were

463
00:14:57,199 --> 00:15:00,959
another service that needs to be

464
00:14:58,639 --> 00:15:02,160
hardened and that means that the service

465
00:15:00,959 --> 00:15:04,239
to which it's connected

466
00:15:02,160 --> 00:15:06,800
your on-premise active directory needs

467
00:15:04,240 --> 00:15:08,959
to have the latest versions the latest

468
00:15:06,800 --> 00:15:10,240
patches installed the latest functional

469
00:15:08,959 --> 00:15:12,000
version and so

470
00:15:10,240 --> 00:15:13,440
what i'm telling most people is if you

471
00:15:12,000 --> 00:15:14,800
are not on azure ad

472
00:15:13,440 --> 00:15:16,480
if you are not on active directory

473
00:15:14,800 --> 00:15:17,599
version 2019

474
00:15:16,480 --> 00:15:19,120
you need to get there as soon as

475
00:15:17,600 --> 00:15:21,519
possible there are legacy

476
00:15:19,120 --> 00:15:25,040
vulnerabilities in 2008 2012

477
00:15:21,519 --> 00:15:26,560
2016 that that create specific

478
00:15:25,040 --> 00:15:28,639
vulnerability sets the most

479
00:15:26,560 --> 00:15:29,839
organizations are not equipped to detect

480
00:15:28,639 --> 00:15:31,839
and respond to

481
00:15:29,839 --> 00:15:33,759
so the best thing to do is just get that

482
00:15:31,839 --> 00:15:35,120
on-prem active directory upgraded and to

483
00:15:33,759 --> 00:15:37,360
the latest version and that's going to

484
00:15:35,120 --> 00:15:40,560
be the easiest way to solve this problem

485
00:15:37,360 --> 00:15:41,680
and so um among ions customers you know

486
00:15:40,560 --> 00:15:43,839
they have 200

487
00:15:41,680 --> 00:15:44,719
customers around the united states most

488
00:15:43,839 --> 00:15:47,759
of them fairly

489
00:15:44,720 --> 00:15:50,160
sophisticated information security teams

490
00:15:47,759 --> 00:15:51,680
even in those security teams with in

491
00:15:50,160 --> 00:15:52,560
clients with sophisticated security

492
00:15:51,680 --> 00:15:54,719
teams

493
00:15:52,560 --> 00:15:56,800
they would categorize their moved azure

494
00:15:54,720 --> 00:15:59,360
id as more of ready fire aim

495
00:15:56,800 --> 00:15:59,839
not ready aim fire right since they were

496
00:15:59,360 --> 00:16:02,320
drug

497
00:15:59,839 --> 00:16:03,519
kicking and screaming into azure id no

498
00:16:02,320 --> 00:16:05,120
one really took a good look at the

499
00:16:03,519 --> 00:16:06,240
security policies and then it's like

500
00:16:05,120 --> 00:16:08,720
okay we're here

501
00:16:06,240 --> 00:16:10,320
whatever um there's a really great

502
00:16:08,720 --> 00:16:10,959
resource that i've linked to here in the

503
00:16:10,320 --> 00:16:13,519
slides

504
00:16:10,959 --> 00:16:15,119
and if you do a google search for azure

505
00:16:13,519 --> 00:16:17,440
ad connect for red teams it's an article

506
00:16:15,120 --> 00:16:19,519
written by adam chester

507
00:16:17,440 --> 00:16:22,079
really great content there about how to

508
00:16:19,519 --> 00:16:24,000
leverage weaknesses in active directory

509
00:16:22,079 --> 00:16:25,519
to connect as an unauthorized user or

510
00:16:24,000 --> 00:16:27,440
non-authenticated user

511
00:16:25,519 --> 00:16:29,199
to create an account to elevate

512
00:16:27,440 --> 00:16:31,199
privilege and eventually get to global

513
00:16:29,199 --> 00:16:31,920
admin if a series of vulnerabilities

514
00:16:31,199 --> 00:16:33,758
exist

515
00:16:31,920 --> 00:16:35,439
that's the worst case scenario right why

516
00:16:33,759 --> 00:16:36,720
why would you ever get into bed with

517
00:16:35,440 --> 00:16:38,959
something where someone can go from

518
00:16:36,720 --> 00:16:40,639
unauthenticated user to global admin

519
00:16:38,959 --> 00:16:42,560
without you know having to go through

520
00:16:40,639 --> 00:16:44,560
some sort of process and if you've

521
00:16:42,560 --> 00:16:45,920
used the azure id defaults that's what

522
00:16:44,560 --> 00:16:47,680
can happen

523
00:16:45,920 --> 00:16:49,279
so if there's just one thing you can do

524
00:16:47,680 --> 00:16:50,000
about azure id if you don't have time to

525
00:16:49,279 --> 00:16:51,680
upgrade your your

526
00:16:50,000 --> 00:16:53,680
on-prem id if you don't have time to

527
00:16:51,680 --> 00:16:55,680
read the white paper by adam chester

528
00:16:53,680 --> 00:16:57,040
the one number one thing to do is block

529
00:16:55,680 --> 00:16:59,439
legacy auth

530
00:16:57,040 --> 00:17:00,719
yes by default azure id supports good

531
00:16:59,440 --> 00:17:03,839
old ntlm

532
00:17:00,720 --> 00:17:05,439
that completely reversible not a great

533
00:17:03,839 --> 00:17:06,400
protocol to use for authentication and

534
00:17:05,439 --> 00:17:08,319
authorization

535
00:17:06,400 --> 00:17:09,600
and so by blocking legacy auth you can

536
00:17:08,319 --> 00:17:12,319
help

537
00:17:09,599 --> 00:17:13,839
resolve a lot of these problems and as

538
00:17:12,319 --> 00:17:16,079
i've stated on the slide here

539
00:17:13,839 --> 00:17:17,119
we could spend an entire hour on this

540
00:17:16,079 --> 00:17:19,280
topic alone

541
00:17:17,119 --> 00:17:20,799
azure id is so fundamentally important

542
00:17:19,280 --> 00:17:21,599
to the future of your cloud-based

543
00:17:20,799 --> 00:17:24,799
security

544
00:17:21,599 --> 00:17:28,079
you need to dedicate those resources

545
00:17:24,799 --> 00:17:33,520
so let's talk a little bit about things

546
00:17:28,079 --> 00:17:36,000
on a more broad basis

547
00:17:33,520 --> 00:17:37,360
so when you think about prioritizing

548
00:17:36,000 --> 00:17:39,280
policies

549
00:17:37,360 --> 00:17:41,039
we've talked a little bit about azure id

550
00:17:39,280 --> 00:17:42,879
from a fundamental perspective from a

551
00:17:41,039 --> 00:17:45,039
protocol or

552
00:17:42,880 --> 00:17:46,480
a base configuration perspective but

553
00:17:45,039 --> 00:17:47,600
then you have to go through the process

554
00:17:46,480 --> 00:17:48,080
of actually thinking about how do you

555
00:17:47,600 --> 00:17:51,439
manage

556
00:17:48,080 --> 00:17:52,799
privileges of those people too so here's

557
00:17:51,440 --> 00:17:54,400
just my you know

558
00:17:52,799 --> 00:17:55,760
quick and dirty list of things that you

559
00:17:54,400 --> 00:17:56,880
should be checking to make sure that

560
00:17:55,760 --> 00:17:58,640
you're not vulnerable

561
00:17:56,880 --> 00:18:00,000
to some of the attacks that are going on

562
00:17:58,640 --> 00:18:02,559
inside of azure id

563
00:18:00,000 --> 00:18:04,160
so the first one is you want to de-link

564
00:18:02,559 --> 00:18:05,440
a user's day-to-day account from the

565
00:18:04,160 --> 00:18:07,520
global admin account

566
00:18:05,440 --> 00:18:09,200
so you should make sure that the daily

567
00:18:07,520 --> 00:18:12,080
driver account that they have

568
00:18:09,200 --> 00:18:14,160
is that they use for email and onedrive

569
00:18:12,080 --> 00:18:16,080
and all of the collaboration stuff that

570
00:18:14,160 --> 00:18:16,640
that account is not a global admin

571
00:18:16,080 --> 00:18:17,918
account

572
00:18:16,640 --> 00:18:20,000
you want to make sure that a global

573
00:18:17,919 --> 00:18:21,120
admin account does not have email

574
00:18:20,000 --> 00:18:22,960
sending privileges

575
00:18:21,120 --> 00:18:24,799
does not have the ability to log into

576
00:18:22,960 --> 00:18:25,919
teams that should be a completely

577
00:18:24,799 --> 00:18:29,280
separate account

578
00:18:25,919 --> 00:18:31,360
and in my opinion it should use um

579
00:18:29,280 --> 00:18:33,200
an mfa system that is separate from the

580
00:18:31,360 --> 00:18:34,959
mfa from the rest of the platform

581
00:18:33,200 --> 00:18:36,799
you can do that through uh conditional

582
00:18:34,960 --> 00:18:37,280
access policies where you can basically

583
00:18:36,799 --> 00:18:39,440
okay

584
00:18:37,280 --> 00:18:40,960
for this group of of global admin users

585
00:18:39,440 --> 00:18:42,799
i'm going to make them use a ubi key

586
00:18:40,960 --> 00:18:44,880
instead of the microsoft authenticator

587
00:18:42,799 --> 00:18:46,559
and that's my preferred approach is to

588
00:18:44,880 --> 00:18:48,400
basically use a hardware token

589
00:18:46,559 --> 00:18:51,200
instead of a soft token for multi-factor

590
00:18:48,400 --> 00:18:54,000
for global admin rights

591
00:18:51,200 --> 00:18:56,400
there's a setting inside of azure id

592
00:18:54,000 --> 00:18:58,559
that you can set to basically notify

593
00:18:56,400 --> 00:18:59,760
all admins if any admin changes their

594
00:18:58,559 --> 00:19:01,760
account and so

595
00:18:59,760 --> 00:19:03,039
that becomes sort of a method to let

596
00:19:01,760 --> 00:19:05,039
other admins watch

597
00:19:03,039 --> 00:19:06,799
for the relative integrity of of an

598
00:19:05,039 --> 00:19:09,120
account um

599
00:19:06,799 --> 00:19:10,720
you need to make sure that you enforce

600
00:19:09,120 --> 00:19:12,000
at least an authenticator code for a

601
00:19:10,720 --> 00:19:13,440
password reset but all

602
00:19:12,000 --> 00:19:15,520
but preferably require a full

603
00:19:13,440 --> 00:19:17,280
multi-factor authentication login

604
00:19:15,520 --> 00:19:19,280
you want to make sure that you disable

605
00:19:17,280 --> 00:19:20,879
sms and phone call authentication for

606
00:19:19,280 --> 00:19:22,960
those global admin accounts

607
00:19:20,880 --> 00:19:24,799
disable self-service password reset for

608
00:19:22,960 --> 00:19:25,360
those accounts restrict access to the

609
00:19:24,799 --> 00:19:26,960
azure

610
00:19:25,360 --> 00:19:28,559
ad portal so that they have to go

611
00:19:26,960 --> 00:19:30,160
through certain network controls

612
00:19:28,559 --> 00:19:31,918
before they're able to get to the azure

613
00:19:30,160 --> 00:19:34,000
id admin portal

614
00:19:31,919 --> 00:19:35,919
and then you want to set a notification

615
00:19:34,000 --> 00:19:38,080
email for admin

616
00:19:35,919 --> 00:19:38,960
changes to all admins in the group right

617
00:19:38,080 --> 00:19:41,199
so if if

618
00:19:38,960 --> 00:19:42,960
a person joins everyone's notified to

619
00:19:41,200 --> 00:19:43,360
say hey there's a new global admin in

620
00:19:42,960 --> 00:19:46,400
the group

621
00:19:43,360 --> 00:19:49,439
is that something you want to do

622
00:19:46,400 --> 00:19:50,080
so i'll take a quick break here and just

623
00:19:49,440 --> 00:19:53,520
say

624
00:19:50,080 --> 00:19:56,720
are there any questions about

625
00:19:53,520 --> 00:19:56,720
uh azure a.d

626
00:20:03,280 --> 00:20:06,158
and corncon people like do we have

627
00:20:05,039 --> 00:20:07,200
people in the session or i was just

628
00:20:06,159 --> 00:20:09,039
talking to myself

629
00:20:07,200 --> 00:20:12,240
how many people do we have let's see

630
00:20:09,039 --> 00:20:16,240
here and we have 11 participants

631
00:20:12,240 --> 00:20:21,280
and i'm checking discord to see if we

632
00:20:16,240 --> 00:20:25,600
have any questions

633
00:20:21,280 --> 00:20:29,200
nothing in track two so um oh wait

634
00:20:25,600 --> 00:20:32,399
one just popped up in the q a here

635
00:20:29,200 --> 00:20:34,480
uh this is a question from dan are you

636
00:20:32,400 --> 00:20:38,080
willing to share the presentation

637
00:20:34,480 --> 00:20:39,520
yes so um how are you

638
00:20:38,080 --> 00:20:41,199
what's going to be the easiest way to do

639
00:20:39,520 --> 00:20:42,879
that um

640
00:20:41,200 --> 00:20:44,960
should i send it to you should i post a

641
00:20:42,880 --> 00:20:48,880
link

642
00:20:44,960 --> 00:20:51,760
so we are recording right now and the

643
00:20:48,880 --> 00:20:52,480
hope is to get them uploaded somewhere

644
00:20:51,760 --> 00:20:55,840
maybe to

645
00:20:52,480 --> 00:21:00,000
um the website or youtube

646
00:20:55,840 --> 00:21:03,199
okay uh so if you want the presentation

647
00:21:00,000 --> 00:21:05,200
um i will share my contact info

648
00:21:03,200 --> 00:21:06,960
send me an email i see you know we don't

649
00:21:05,200 --> 00:21:08,720
have a ton of people here and so

650
00:21:06,960 --> 00:21:10,080
uh i'll make sure to share my email send

651
00:21:08,720 --> 00:21:11,679
me an email i'll send it to you direct

652
00:21:10,080 --> 00:21:13,120
but for the corncon folks

653
00:21:11,679 --> 00:21:15,039
happy to share it where you can publish

654
00:21:13,120 --> 00:21:17,760
it wherever you publish the video

655
00:21:15,039 --> 00:21:18,240
perfect thank you erin do you see the q

656
00:21:17,760 --> 00:21:21,760
a

657
00:21:18,240 --> 00:21:23,200
um yes i do i do so um

658
00:21:21,760 --> 00:21:26,960
okay so it looks like implementing

659
00:21:23,200 --> 00:21:26,960
intune and 365 premium

660
00:21:27,520 --> 00:21:32,320
okay uh so let's talk i see nate t

661
00:21:30,799 --> 00:21:33,679
in addition to those security steps i

662
00:21:32,320 --> 00:21:34,559
would assume you would require a hard

663
00:21:33,679 --> 00:21:36,640
token for

664
00:21:34,559 --> 00:21:37,760
uh global admins that is correct so my

665
00:21:36,640 --> 00:21:40,000
preference is

666
00:21:37,760 --> 00:21:40,960
is to completely avoid soft tokens or

667
00:21:40,000 --> 00:21:44,640
any any

668
00:21:40,960 --> 00:21:46,720
um sms driven authentication

669
00:21:44,640 --> 00:21:48,080
and use things like yubikey or google

670
00:21:46,720 --> 00:21:50,640
titan key

671
00:21:48,080 --> 00:21:52,480
to make sure that global admins have

672
00:21:50,640 --> 00:21:55,039
that level of integrity associated with

673
00:21:52,480 --> 00:21:57,600
their identity

674
00:21:55,039 --> 00:21:59,679
and so then dan i see your what about

675
00:21:57,600 --> 00:22:01,918
zero log on volume and azure id

676
00:21:59,679 --> 00:22:03,360
so um that white paper from adam chester

677
00:22:01,919 --> 00:22:06,400
walks through exactly

678
00:22:03,360 --> 00:22:09,918
how uh that is exploited and then um

679
00:22:06,400 --> 00:22:12,960
from a a hardening perspective

680
00:22:09,919 --> 00:22:14,640
um basically that if you take a look at

681
00:22:12,960 --> 00:22:18,080
what i just presented

682
00:22:14,640 --> 00:22:18,799
plus the um uh the upgrade of your

683
00:22:18,080 --> 00:22:21,520
on-prem

684
00:22:18,799 --> 00:22:23,120
ad it helps to reduce the likelihood

685
00:22:21,520 --> 00:22:24,000
that the zero login vulnerability can be

686
00:22:23,120 --> 00:22:26,959
exploited

687
00:22:24,000 --> 00:22:27,280
um now the downside is is that microsoft

688
00:22:26,960 --> 00:22:29,200
is

689
00:22:27,280 --> 00:22:30,960
shifting a lot of their functionality

690
00:22:29,200 --> 00:22:32,559
fast enough where we have seen

691
00:22:30,960 --> 00:22:34,080
situations where

692
00:22:32,559 --> 00:22:35,918
problems like xero login get

693
00:22:34,080 --> 00:22:37,520
reintroduced because of changes that

694
00:22:35,919 --> 00:22:38,240
microsoft makes within the azure id

695
00:22:37,520 --> 00:22:40,158
environment

696
00:22:38,240 --> 00:22:42,320
and so that's why it's really important

697
00:22:40,159 --> 00:22:43,679
um one of my ian's faculty colleagues

698
00:22:42,320 --> 00:22:46,320
john strand

699
00:22:43,679 --> 00:22:47,760
the black hills infosec team published a

700
00:22:46,320 --> 00:22:49,840
tool that will go out

701
00:22:47,760 --> 00:22:51,440
and scan to see if you've got azure id

702
00:22:49,840 --> 00:22:53,199
problems and so

703
00:22:51,440 --> 00:22:54,559
if you want to go and start looking for

704
00:22:53,200 --> 00:22:56,159
things i'd recommend downloading the

705
00:22:54,559 --> 00:22:58,080
black hills infosec

706
00:22:56,159 --> 00:22:59,440
azure id scanning tool and that will

707
00:22:58,080 --> 00:23:01,120
help you solve for some of these

708
00:22:59,440 --> 00:23:05,520
vulnerabilities as well

709
00:23:01,120 --> 00:23:05,520
um okay so we'll just start

710
00:23:05,840 --> 00:23:12,240
okay all right

711
00:23:08,880 --> 00:23:13,600
um okay so it looks like we've covered

712
00:23:12,240 --> 00:23:15,120
most of the questions so far

713
00:23:13,600 --> 00:23:17,520
feel free to keep dropping questions in

714
00:23:15,120 --> 00:23:18,320
there if if things come up so i'm going

715
00:23:17,520 --> 00:23:20,320
to go ahead

716
00:23:18,320 --> 00:23:22,399
and start talking a little bit about

717
00:23:20,320 --> 00:23:25,918
attack surface reduction here

718
00:23:22,400 --> 00:23:29,039
so let me share my screen again

719
00:23:25,919 --> 00:23:31,440
all right so um

720
00:23:29,039 --> 00:23:32,640
this is this may sound dumb but and it's

721
00:23:31,440 --> 00:23:35,440
basic but

722
00:23:32,640 --> 00:23:36,559
disable unused apps it shocks me how

723
00:23:35,440 --> 00:23:39,679
many people

724
00:23:36,559 --> 00:23:41,360
sign up for office 365 microsoft 365 and

725
00:23:39,679 --> 00:23:43,440
don't take the step to say

726
00:23:41,360 --> 00:23:44,479
i don't want to use yammer i don't want

727
00:23:43,440 --> 00:23:46,080
to use delve

728
00:23:44,480 --> 00:23:47,919
i don't want to use you know whatever

729
00:23:46,080 --> 00:23:49,600
stuff is out there if there is not a

730
00:23:47,919 --> 00:23:50,960
legitimate business purpose for why you

731
00:23:49,600 --> 00:23:54,399
should be using something

732
00:23:50,960 --> 00:23:55,279
shut that stuff off right it um it pains

733
00:23:54,400 --> 00:23:57,600
me

734
00:23:55,279 --> 00:23:59,279
so one of the ways that i learned the

735
00:23:57,600 --> 00:24:01,279
really hard way about security at

736
00:23:59,279 --> 00:24:03,520
microsoft when i was working there is

737
00:24:01,279 --> 00:24:05,600
we had to develop a method to train the

738
00:24:03,520 --> 00:24:07,440
microsoft developers to do security

739
00:24:05,600 --> 00:24:08,240
better because of the awful situation we

740
00:24:07,440 --> 00:24:10,720
were in i was

741
00:24:08,240 --> 00:24:11,520
responsible in 2003 for cleaning up all

742
00:24:10,720 --> 00:24:14,240
of the

743
00:24:11,520 --> 00:24:15,760
um the blaster worm and the slammer worm

744
00:24:14,240 --> 00:24:17,279
and everything that was going on

745
00:24:15,760 --> 00:24:19,919
and so we went back to the developers

746
00:24:17,279 --> 00:24:22,799
and we developed a mantra called sd3

747
00:24:19,919 --> 00:24:25,120
sd3 stood for secure by design secure by

748
00:24:22,799 --> 00:24:27,520
default and secure and deployment

749
00:24:25,120 --> 00:24:29,199
well right now microsoft is violating

750
00:24:27,520 --> 00:24:31,279
all those principles that we work for

751
00:24:29,200 --> 00:24:33,200
work towards for sd3 because when you

752
00:24:31,279 --> 00:24:34,000
turn on microsoft 365 everything's

753
00:24:33,200 --> 00:24:35,600
enabled

754
00:24:34,000 --> 00:24:37,600
and it should just be the opposite it

755
00:24:35,600 --> 00:24:38,959
should be you get to enable the things

756
00:24:37,600 --> 00:24:40,480
you want to do but instead it's like

757
00:24:38,960 --> 00:24:42,320
here here's all this stuff

758
00:24:40,480 --> 00:24:44,400
because microsoft is trying to compete

759
00:24:42,320 --> 00:24:45,439
on a global basis to get more people to

760
00:24:44,400 --> 00:24:46,640
use their platform

761
00:24:45,440 --> 00:24:48,480
so they're trying to make it easier to

762
00:24:46,640 --> 00:24:49,679
use

763
00:24:48,480 --> 00:24:51,120
one of the other key things i should

764
00:24:49,679 --> 00:24:52,799
have mentioned you want to make sure

765
00:24:51,120 --> 00:24:54,080
that you enable the azure id security

766
00:24:52,799 --> 00:24:56,559
defaults

767
00:24:54,080 --> 00:24:57,678
wait a second if it's a default why do i

768
00:24:56,559 --> 00:24:59,200
need to enable it

769
00:24:57,679 --> 00:25:00,880
well what ended up happening was too

770
00:24:59,200 --> 00:25:01,760
many people were having problems with

771
00:25:00,880 --> 00:25:04,080
enabling it

772
00:25:01,760 --> 00:25:06,960
and so microsoft disabled it by default

773
00:25:04,080 --> 00:25:10,960
and now you have to go turn it on

774
00:25:06,960 --> 00:25:13,120
some additional key configuration points

775
00:25:10,960 --> 00:25:14,000
we believe that microsoft 365 is one of

776
00:25:13,120 --> 00:25:17,039
the greatest data

777
00:25:14,000 --> 00:25:18,720
leakage problems on planet earth and so

778
00:25:17,039 --> 00:25:20,799
what you want to do is you want to

779
00:25:18,720 --> 00:25:21,760
disable external sharing by default and

780
00:25:20,799 --> 00:25:23,679
then create

781
00:25:21,760 --> 00:25:25,919
processes by which people have to ask

782
00:25:23,679 --> 00:25:27,679
for exceptions to that default behavior

783
00:25:25,919 --> 00:25:29,520
disabling external group memberships

784
00:25:27,679 --> 00:25:31,919
disabling external sway sharing

785
00:25:29,520 --> 00:25:33,039
disable external calendar sharing so

786
00:25:31,919 --> 00:25:35,600
it's interesting to us

787
00:25:33,039 --> 00:25:36,960
um one of the we were doing a

788
00:25:35,600 --> 00:25:37,918
penetration test with one of our

789
00:25:36,960 --> 00:25:41,039
partners

790
00:25:37,919 --> 00:25:42,240
and we were able to exfiltrate some very

791
00:25:41,039 --> 00:25:44,720
sensitive data

792
00:25:42,240 --> 00:25:46,080
because someone was publicly sharing

793
00:25:44,720 --> 00:25:48,880
their calendar

794
00:25:46,080 --> 00:25:49,918
and in this organization the culture was

795
00:25:48,880 --> 00:25:52,320
that they would attach

796
00:25:49,919 --> 00:25:54,000
documents to the calendar invite and so

797
00:25:52,320 --> 00:25:56,639
if the if the calendar is

798
00:25:54,000 --> 00:25:58,320
allowed to be shared externally and if

799
00:25:56,640 --> 00:26:00,080
someone has attached a sensitive

800
00:25:58,320 --> 00:26:01,678
document to that calendar invite

801
00:26:00,080 --> 00:26:03,520
well now you essentially have a public

802
00:26:01,679 --> 00:26:05,600
version of that sensitive data attached

803
00:26:03,520 --> 00:26:07,039
to the public calendar

804
00:26:05,600 --> 00:26:09,039
you want to make sure you disable third

805
00:26:07,039 --> 00:26:10,320
party app access by default

806
00:26:09,039 --> 00:26:12,480
these are the apps that you can install

807
00:26:10,320 --> 00:26:14,320
from the microsoft app store and disable

808
00:26:12,480 --> 00:26:16,559
linkedin account connections

809
00:26:14,320 --> 00:26:17,520
wait a second my linkedin account is it

810
00:26:16,559 --> 00:26:21,440
can be linked

811
00:26:17,520 --> 00:26:22,960
yeah so microsoft owns linkedin now

812
00:26:21,440 --> 00:26:25,279
and so you can actually bind the two

813
00:26:22,960 --> 00:26:26,640
together where you can have automatic

814
00:26:25,279 --> 00:26:29,840
updates between linkedin

815
00:26:26,640 --> 00:26:32,880
and the microsoft 365 suite

816
00:26:29,840 --> 00:26:34,559
now the next portion here you want to

817
00:26:32,880 --> 00:26:36,559
make sure you reduce vulnerabilities

818
00:26:34,559 --> 00:26:38,559
with trust relationships to devices and

819
00:26:36,559 --> 00:26:39,918
so you want to make sure you enable mfa

820
00:26:38,559 --> 00:26:41,678
for joining devices

821
00:26:39,919 --> 00:26:43,279
if this is not enabled then you will not

822
00:26:41,679 --> 00:26:44,559
be notified if someone tries to join a

823
00:26:43,279 --> 00:26:46,159
device on your behalf

824
00:26:44,559 --> 00:26:47,678
so in the case of the global admin

825
00:26:46,159 --> 00:26:48,880
takeover that we had to clean up

826
00:26:47,679 --> 00:26:50,559
they did not have this turned on and

827
00:26:48,880 --> 00:26:52,480
that's why the attackers were able to

828
00:26:50,559 --> 00:26:55,840
essentially clone their microsoft

829
00:26:52,480 --> 00:26:58,640
authenticator on the attacker's iphone

830
00:26:55,840 --> 00:26:59,840
let's talk a little bit about exchange

831
00:26:58,640 --> 00:27:01,440
online policies

832
00:26:59,840 --> 00:27:03,840
so we've got you know you want to make

833
00:27:01,440 --> 00:27:06,000
sure you blacklist malicious extensions

834
00:27:03,840 --> 00:27:08,080
we've seen situations where exchange

835
00:27:06,000 --> 00:27:09,600
online is used for ransomware delivery

836
00:27:08,080 --> 00:27:12,080
inside of an organization

837
00:27:09,600 --> 00:27:13,678
because sometimes the email hygiene is

838
00:27:12,080 --> 00:27:16,080
only configured to watch for

839
00:27:13,679 --> 00:27:17,600
external delivery of ransomware and not

840
00:27:16,080 --> 00:27:19,279
necessarily internal delivery of

841
00:27:17,600 --> 00:27:20,559
ransomware

842
00:27:19,279 --> 00:27:23,120
you want to make sure you do some attack

843
00:27:20,559 --> 00:27:24,879
service reduction for outlook web access

844
00:27:23,120 --> 00:27:26,080
there's a text messaging api that's

845
00:27:24,880 --> 00:27:27,760
available inside of there that we've

846
00:27:26,080 --> 00:27:29,760
seen all sorts of fraudulent

847
00:27:27,760 --> 00:27:32,559
text messages sent through again the

848
00:27:29,760 --> 00:27:34,720
linkedin contact sync should be disabled

849
00:27:32,559 --> 00:27:36,559
journaling inbox rules there's a whole

850
00:27:34,720 --> 00:27:38,559
bunch more that you can dig into there

851
00:27:36,559 --> 00:27:40,799
again we could probably spend 30 minutes

852
00:27:38,559 --> 00:27:42,320
just on exchange online policies

853
00:27:40,799 --> 00:27:43,840
and but then also you want to make sure

854
00:27:42,320 --> 00:27:45,600
you got dmarc and dcam core

855
00:27:43,840 --> 00:27:48,559
set up in your dns and your

856
00:27:45,600 --> 00:27:51,600
public-facing um

857
00:27:48,559 --> 00:27:52,320
internet published records because dmarc

858
00:27:51,600 --> 00:27:53,918
and dkim

859
00:27:52,320 --> 00:27:55,678
has become something that most of the

860
00:27:53,919 --> 00:27:56,880
email handlers are requiring now

861
00:27:55,679 --> 00:27:58,720
and if you don't have it properly

862
00:27:56,880 --> 00:27:59,600
configured there can be a lot of ways

863
00:27:58,720 --> 00:28:02,399
that your

864
00:27:59,600 --> 00:28:03,039
online domain can be used to try to fish

865
00:28:02,399 --> 00:28:06,639
other people

866
00:28:03,039 --> 00:28:09,919
your customers or your internal staff

867
00:28:06,640 --> 00:28:11,360
and then a few additional points here

868
00:28:09,919 --> 00:28:12,480
so sharepoint online you want to make

869
00:28:11,360 --> 00:28:15,039
sure that you've got really tight

870
00:28:12,480 --> 00:28:17,200
requirements around signing users out

871
00:28:15,039 --> 00:28:18,240
verifying your time preferences you want

872
00:28:17,200 --> 00:28:19,760
to disable delve

873
00:28:18,240 --> 00:28:21,440
delves is a really interesting pivot

874
00:28:19,760 --> 00:28:23,760
point for attackers to basically go

875
00:28:21,440 --> 00:28:24,880
get x's access to information stream it

876
00:28:23,760 --> 00:28:27,440
out somewhere else

877
00:28:24,880 --> 00:28:29,840
you want to disable video media

878
00:28:27,440 --> 00:28:30,320
streaming services we had one customer

879
00:28:29,840 --> 00:28:33,520
who

880
00:28:30,320 --> 00:28:35,039
uh an enterprise employee had set up a

881
00:28:33,520 --> 00:28:37,200
digital capture system

882
00:28:35,039 --> 00:28:39,279
uh to capture some college football

883
00:28:37,200 --> 00:28:41,919
games uh last year

884
00:28:39,279 --> 00:28:43,279
and they were using the azure media

885
00:28:41,919 --> 00:28:44,799
services to stream it and they were

886
00:28:43,279 --> 00:28:45,840
charging people to watch the college

887
00:28:44,799 --> 00:28:47,840
football game

888
00:28:45,840 --> 00:28:49,039
um you want to make sure you stay away

889
00:28:47,840 --> 00:28:51,279
from that

890
00:28:49,039 --> 00:28:52,879
disabling personal blogs we've seen some

891
00:28:51,279 --> 00:28:53,279
really interesting behavior where people

892
00:28:52,880 --> 00:28:55,039
are

893
00:28:53,279 --> 00:28:56,960
are posting personal stuff on their

894
00:28:55,039 --> 00:28:58,399
corporate sharepoint blog which by

895
00:28:56,960 --> 00:29:00,240
default is public

896
00:28:58,399 --> 00:29:02,399
not appropriate you want to prevent

897
00:29:00,240 --> 00:29:04,880
users from running customer scripts

898
00:29:02,399 --> 00:29:06,799
and self-service created sites and then

899
00:29:04,880 --> 00:29:07,679
you want to block sharepoint 2003

900
00:29:06,799 --> 00:29:09,440
workflows

901
00:29:07,679 --> 00:29:10,720
these are the old biztalk workflows that

902
00:29:09,440 --> 00:29:12,720
date all the way back to the first days

903
00:29:10,720 --> 00:29:16,399
of xml version 1.0

904
00:29:12,720 --> 00:29:18,159
and you know we could go on and on here

905
00:29:16,399 --> 00:29:19,760
so how do you think about assessing

906
00:29:18,159 --> 00:29:20,480
risks and this is the way we break it

907
00:29:19,760 --> 00:29:22,960
down

908
00:29:20,480 --> 00:29:23,520
you basically look at azure id exchange

909
00:29:22,960 --> 00:29:24,880
online

910
00:29:23,520 --> 00:29:27,279
team skype for business and then the

911
00:29:24,880 --> 00:29:29,919
microsoft 365 cross tenant settings

912
00:29:27,279 --> 00:29:31,120
and then you move through these four pro

913
00:29:29,919 --> 00:29:33,520
sort of domains

914
00:29:31,120 --> 00:29:34,959
right you've got privilege management

915
00:29:33,520 --> 00:29:37,279
attack service reduction

916
00:29:34,960 --> 00:29:38,320
service hardening and transitive trust

917
00:29:37,279 --> 00:29:40,000
management

918
00:29:38,320 --> 00:29:41,600
then once you get that done for the

919
00:29:40,000 --> 00:29:42,960
baseline then you start enumerating all

920
00:29:41,600 --> 00:29:45,760
of your sharepoint shares

921
00:29:42,960 --> 00:29:47,520
your onedrive shares the intune settings

922
00:29:45,760 --> 00:29:50,240
and these are much more complex

923
00:29:47,520 --> 00:29:51,760
so um azure id exchange online they're

924
00:29:50,240 --> 00:29:53,200
fairly static you can run that

925
00:29:51,760 --> 00:29:54,559
assessment once

926
00:29:53,200 --> 00:29:56,559
and essentially get a good idea of where

927
00:29:54,559 --> 00:29:58,080
you're at very little configuration

928
00:29:56,559 --> 00:29:59,760
drift in those

929
00:29:58,080 --> 00:30:02,480
but when it comes to sharepoint onedrive

930
00:29:59,760 --> 00:30:04,080
and intune lots of configuration drift

931
00:30:02,480 --> 00:30:05,679
because people can stand up a sharepoint

932
00:30:04,080 --> 00:30:07,760
site that sometimes

933
00:30:05,679 --> 00:30:08,880
violates the overarching rules for the

934
00:30:07,760 --> 00:30:10,480
global tenant

935
00:30:08,880 --> 00:30:12,159
depending upon what person's level of

936
00:30:10,480 --> 00:30:14,000
permissions are and so

937
00:30:12,159 --> 00:30:16,080
so this is the way that we break it out

938
00:30:14,000 --> 00:30:18,320
you know to be able to look at these

939
00:30:16,080 --> 00:30:18,320
things

940
00:30:18,559 --> 00:30:23,440
now when it comes to working through

941
00:30:22,240 --> 00:30:26,399
this

942
00:30:23,440 --> 00:30:28,799
it can be difficult um you know and so

943
00:30:26,399 --> 00:30:31,199
what we've had to do

944
00:30:28,799 --> 00:30:31,840
we've coded a series of scripts that

945
00:30:31,200 --> 00:30:35,279
combine

946
00:30:31,840 --> 00:30:37,360
graph api calls power shell some visual

947
00:30:35,279 --> 00:30:39,200
studio tools and we've bundled that

948
00:30:37,360 --> 00:30:40,158
together where we can be able to get a

949
00:30:39,200 --> 00:30:43,200
consistent

950
00:30:40,159 --> 00:30:45,120
return on those settings

951
00:30:43,200 --> 00:30:47,279
and and that's been what the most of our

952
00:30:45,120 --> 00:30:47,918
development effort so far at syrix is

953
00:30:47,279 --> 00:30:50,320
actually

954
00:30:47,919 --> 00:30:52,799
going ahead and developing those tools

955
00:30:50,320 --> 00:30:55,600
to get consistent data feeds

956
00:30:52,799 --> 00:30:56,720
so um we often get a question you know

957
00:30:55,600 --> 00:30:57,840
how do you prioritize these

958
00:30:56,720 --> 00:31:00,720
recommendations well

959
00:30:57,840 --> 00:31:02,399
we use the miter attack framework and so

960
00:31:00,720 --> 00:31:04,159
what we do is we

961
00:31:02,399 --> 00:31:05,439
we work with uh partners around the

962
00:31:04,159 --> 00:31:08,320
world research partners

963
00:31:05,440 --> 00:31:09,519
to look into azure id and microsoft 365

964
00:31:08,320 --> 00:31:12,960
security incidents

965
00:31:09,519 --> 00:31:14,399
and then um we align the root causes of

966
00:31:12,960 --> 00:31:15,840
those incidents to the miter attack

967
00:31:14,399 --> 00:31:18,239
framework to understand okay

968
00:31:15,840 --> 00:31:19,918
was this privilege elevation was it a uh

969
00:31:18,240 --> 00:31:22,000
transitive trust problem you know what

970
00:31:19,919 --> 00:31:23,039
was the actual root cause of what got

971
00:31:22,000 --> 00:31:24,799
them there and so

972
00:31:23,039 --> 00:31:26,158
if we think about this you know global

973
00:31:24,799 --> 00:31:27,760
admin privilege management we've already

974
00:31:26,159 --> 00:31:31,120
sort of beat that one to death

975
00:31:27,760 --> 00:31:33,679
single sign-on protocol handling

976
00:31:31,120 --> 00:31:34,719
anyone who has turned on azure id in its

977
00:31:33,679 --> 00:31:37,840
default state

978
00:31:34,720 --> 00:31:39,200
has turned on the azure id p1 single

979
00:31:37,840 --> 00:31:40,879
sign-on stack

980
00:31:39,200 --> 00:31:43,120
and what what we're seeing happening

981
00:31:40,880 --> 00:31:46,880
right now is sophisticated attackers

982
00:31:43,120 --> 00:31:50,239
are sending uh emails to to individuals

983
00:31:46,880 --> 00:31:51,679
that um has a legitimate link right it's

984
00:31:50,240 --> 00:31:54,559
a link to what appears to be a

985
00:31:51,679 --> 00:31:55,679
legitimate site but it is designed to

986
00:31:54,559 --> 00:31:58,320
basically serve

987
00:31:55,679 --> 00:31:59,519
as an oauth token capture mechanism

988
00:31:58,320 --> 00:32:01,120
where the attacker will go

989
00:31:59,519 --> 00:32:02,880
capture the token then replay that

990
00:32:01,120 --> 00:32:04,799
against a site that you may be

991
00:32:02,880 --> 00:32:06,320
using for single sign-on so this is

992
00:32:04,799 --> 00:32:08,399
where you federated your identity

993
00:32:06,320 --> 00:32:10,080
between azure id and salesforce or

994
00:32:08,399 --> 00:32:11,678
azure id and workday or something like

995
00:32:10,080 --> 00:32:12,799
that and so we're starting to see more

996
00:32:11,679 --> 00:32:15,200
and more of these single sign-on

997
00:32:12,799 --> 00:32:16,799
protocol attacks going on

998
00:32:15,200 --> 00:32:18,880
and then transitive trust of data

999
00:32:16,799 --> 00:32:22,000
objects and this is this is where

1000
00:32:18,880 --> 00:32:22,880
um if you do not properly limit the

1001
00:32:22,000 --> 00:32:25,279
ownership

1002
00:32:22,880 --> 00:32:27,360
of uh of data when it comes to

1003
00:32:25,279 --> 00:32:30,080
sharepoint and onedrive

1004
00:32:27,360 --> 00:32:32,080
so by default a data object that goes

1005
00:32:30,080 --> 00:32:34,720
into sharepoint and onedrive

1006
00:32:32,080 --> 00:32:35,360
can be owned by the organization owner

1007
00:32:34,720 --> 00:32:37,360
but

1008
00:32:35,360 --> 00:32:38,559
the receiving party so let's say you

1009
00:32:37,360 --> 00:32:40,559
invite someone like

1010
00:32:38,559 --> 00:32:42,320
an outside lawyer or an outside business

1011
00:32:40,559 --> 00:32:44,559
partner who's not part of your tenant

1012
00:32:42,320 --> 00:32:45,760
and they become a guest user by default

1013
00:32:44,559 --> 00:32:47,840
the guest user can take

1014
00:32:45,760 --> 00:32:48,799
ownership of an object and then share

1015
00:32:47,840 --> 00:32:51,678
that according to

1016
00:32:48,799 --> 00:32:53,120
their security policies and that thereby

1017
00:32:51,679 --> 00:32:54,799
creates the transitive trust problem

1018
00:32:53,120 --> 00:32:56,799
well if i trust him to do that

1019
00:32:54,799 --> 00:32:57,918
well do i really trust him to do that

1020
00:32:56,799 --> 00:33:00,158
and so that's why you want to

1021
00:32:57,919 --> 00:33:01,279
significantly limit the way that data

1022
00:33:00,159 --> 00:33:04,240
objects can

1023
00:33:01,279 --> 00:33:05,919
be taken ownership of uh from especially

1024
00:33:04,240 --> 00:33:08,159
guest users

1025
00:33:05,919 --> 00:33:10,480
it looks like we've got another question

1026
00:33:08,159 --> 00:33:13,440
here to to

1027
00:33:10,480 --> 00:33:13,760
just do it oh no okay we're good all

1028
00:33:13,440 --> 00:33:17,600
right

1029
00:33:13,760 --> 00:33:18,879
so um now

1030
00:33:17,600 --> 00:33:20,240
i'm going to do a little pitch here

1031
00:33:18,880 --> 00:33:20,960
right if you're if you don't want to

1032
00:33:20,240 --> 00:33:23,279
listen to this

1033
00:33:20,960 --> 00:33:25,519
don't i don't feel bad at all but um

1034
00:33:23,279 --> 00:33:27,360
ions and cyrix have come out with a

1035
00:33:25,519 --> 00:33:28,559
reporting function that helps people to

1036
00:33:27,360 --> 00:33:32,158
prioritize these

1037
00:33:28,559 --> 00:33:33,760
7000 capabilities and to provide some

1038
00:33:32,159 --> 00:33:35,200
insight into why we're doing this

1039
00:33:33,760 --> 00:33:38,240
we actually had to develop some machine

1040
00:33:35,200 --> 00:33:39,679
learning capabilities so for example um

1041
00:33:38,240 --> 00:33:42,000
if you take a look at the global admin

1042
00:33:39,679 --> 00:33:44,799
problem with the hijack situation

1043
00:33:42,000 --> 00:33:46,240
what led to that was vulnerable iphone

1044
00:33:44,799 --> 00:33:47,840
microsoft authenticator

1045
00:33:46,240 --> 00:33:49,440
and a global admin account that was

1046
00:33:47,840 --> 00:33:51,519
misconfigured well

1047
00:33:49,440 --> 00:33:53,120
to look at those three things in in a

1048
00:33:51,519 --> 00:33:54,240
simple way with a simple script is

1049
00:33:53,120 --> 00:33:56,799
fairly difficult

1050
00:33:54,240 --> 00:33:58,640
so what we've done is using the aws

1051
00:33:56,799 --> 00:34:00,720
machine learning platform is to go

1052
00:33:58,640 --> 00:34:01,760
let's enumerate all of the global admins

1053
00:34:00,720 --> 00:34:03,360
bang okay

1054
00:34:01,760 --> 00:34:05,360
let's go enumerate all of the intune

1055
00:34:03,360 --> 00:34:06,879
data about the devices that are owned by

1056
00:34:05,360 --> 00:34:08,960
those global admins

1057
00:34:06,880 --> 00:34:11,440
um and so then we then use machine

1058
00:34:08,960 --> 00:34:14,159
learning to go and say okay this guy has

1059
00:34:11,440 --> 00:34:14,720
a an iphone 4 and has a global admin

1060
00:34:14,159 --> 00:34:17,839
account

1061
00:34:14,719 --> 00:34:19,598
warning that's not a good situation

1062
00:34:17,839 --> 00:34:21,520
and so you know just to show a little

1063
00:34:19,599 --> 00:34:24,320
bit about how we dig into things

1064
00:34:21,520 --> 00:34:25,759
um you know the microsoft 365 security

1065
00:34:24,320 --> 00:34:27,200
center they look at 12 different

1066
00:34:25,760 --> 00:34:30,480
settings in azure ad

1067
00:34:27,199 --> 00:34:32,399
the cis m365 baseline looks at 16.

1068
00:34:30,480 --> 00:34:34,560
we're looking at about 35 when it comes

1069
00:34:32,399 --> 00:34:37,440
to just one aspect which is the

1070
00:34:34,560 --> 00:34:38,879
global admin stuff so um we've got just

1071
00:34:37,440 --> 00:34:40,480
a few minutes left

1072
00:34:38,879 --> 00:34:41,839
um if you want more information if

1073
00:34:40,480 --> 00:34:42,719
you're an ions customer you can reach

1074
00:34:41,839 --> 00:34:44,320
out to ions

1075
00:34:42,719 --> 00:34:46,799
if you're not an ions customer you can

1076
00:34:44,320 --> 00:34:49,599
visit us at cyrix.tech

1077
00:34:46,800 --> 00:34:50,320
and so let's go ahead and open it up uh

1078
00:34:49,599 --> 00:34:52,800
and

1079
00:34:50,320 --> 00:34:56,000
see if there are any more questions any

1080
00:34:52,800 --> 00:34:56,000
more questions from those

1081
00:35:00,839 --> 00:35:03,839
attending

1082
00:35:04,480 --> 00:35:08,560
don't be shy folks unless you guys all

1083
00:35:07,520 --> 00:35:09,520
have it figured out i mean if you

1084
00:35:08,560 --> 00:35:17,839
haven't figured out maybe i should be

1085
00:35:09,520 --> 00:35:17,839
asking you guys questions

1086
00:35:25,760 --> 00:35:28,800
oh aaron i i don't see any more

1087
00:35:27,760 --> 00:35:31,760
questions

1088
00:35:28,800 --> 00:35:32,320
okay well i'll go ahead and just wrap it

1089
00:35:31,760 --> 00:35:34,800
up then

1090
00:35:32,320 --> 00:35:35,440
so um so basically here's the bottom

1091
00:35:34,800 --> 00:35:37,760
line

1092
00:35:35,440 --> 00:35:38,480
if you're a microsoft 365 customer

1093
00:35:37,760 --> 00:35:40,079
you've got

1094
00:35:38,480 --> 00:35:41,440
some problems right and you need to

1095
00:35:40,079 --> 00:35:42,960
start figuring out how you're going to

1096
00:35:41,440 --> 00:35:45,440
go about doing that

1097
00:35:42,960 --> 00:35:46,800
if um if there's a way that you feel

1098
00:35:45,440 --> 00:35:49,040
like you're out of your depth there

1099
00:35:46,800 --> 00:35:51,040
reach out to us right um especially if

1100
00:35:49,040 --> 00:35:53,359
you're at a small business or non-profit

1101
00:35:51,040 --> 00:35:54,480
or an education institution we're happy

1102
00:35:53,359 --> 00:35:57,759
to help you know

1103
00:35:54,480 --> 00:35:59,280
on on a pro bono basis if for example uh

1104
00:35:57,760 --> 00:36:01,839
resources are an issue

1105
00:35:59,280 --> 00:36:03,920
um and so you know what i would what i

1106
00:36:01,839 --> 00:36:05,920
would invite you to do is get to know

1107
00:36:03,920 --> 00:36:07,200
some of these uh some especially in the

1108
00:36:05,920 --> 00:36:09,200
azure id space

1109
00:36:07,200 --> 00:36:10,560
i mentioned that paper from adam chester

1110
00:36:09,200 --> 00:36:12,560
highly recommend reading that i think

1111
00:36:10,560 --> 00:36:14,720
that's one of the most important things

1112
00:36:12,560 --> 00:36:15,680
for anyone running microsoft 365 to take

1113
00:36:14,720 --> 00:36:18,000
a look at

1114
00:36:15,680 --> 00:36:19,839
so um it's it's always a pleasure to be

1115
00:36:18,000 --> 00:36:21,440
able to speak to the corncon crowd

1116
00:36:19,839 --> 00:36:23,440
so if there's nothing else i think we

1117
00:36:21,440 --> 00:36:26,800
can end this one just a little bit early

1118
00:36:23,440 --> 00:36:29,040
one more does p2 offer enough additional

1119
00:36:26,800 --> 00:36:32,560
protection to make it worth

1120
00:36:29,040 --> 00:36:36,720
it over p1 oh man

1121
00:36:32,560 --> 00:36:39,759
so so um so you shouldn't think about

1122
00:36:36,720 --> 00:36:40,000
p2 as a security benefit p2 is actually

1123
00:36:39,760 --> 00:36:42,880
just

1124
00:36:40,000 --> 00:36:44,800
an expansion of the problem because

1125
00:36:42,880 --> 00:36:46,079
you're inheriting a bunch of features

1126
00:36:44,800 --> 00:36:48,560
and so essentially what you've got to

1127
00:36:46,079 --> 00:36:50,320
ask yourself is number one what is the

1128
00:36:48,560 --> 00:36:51,599
integrity of my on-prem ad

1129
00:36:50,320 --> 00:36:53,680
and number two what is the

1130
00:36:51,599 --> 00:36:55,440
sophistication of my security team

1131
00:36:53,680 --> 00:36:56,799
to understand the logs that are going to

1132
00:36:55,440 --> 00:36:57,680
be coming in and out of that p2

1133
00:36:56,800 --> 00:36:59,680
environment

1134
00:36:57,680 --> 00:37:01,359
and so i don't think you should view p2

1135
00:36:59,680 --> 00:37:02,078
as an improvement of security benefits

1136
00:37:01,359 --> 00:37:04,160
it's actually

1137
00:37:02,079 --> 00:37:05,280
complexity right how much stuff are you

1138
00:37:04,160 --> 00:37:07,520
willing to do now

1139
00:37:05,280 --> 00:37:09,920
there are security benefits and security

1140
00:37:07,520 --> 00:37:11,359
um features that are built into p2

1141
00:37:09,920 --> 00:37:12,960
but if you're not sophisticated enough

1142
00:37:11,359 --> 00:37:14,319
to manage p1

1143
00:37:12,960 --> 00:37:16,000
you probably aren't going to be

1144
00:37:14,320 --> 00:37:16,320
sophisticated enough to manage p2 either

1145
00:37:16,000 --> 00:37:17,599
so

1146
00:37:16,320 --> 00:37:19,839
that's where you have to ask yourself

1147
00:37:17,599 --> 00:37:20,960
are we really are we really ready to get

1148
00:37:19,839 --> 00:37:23,839
on the treadmill

1149
00:37:20,960 --> 00:37:23,839
to get this done

1150
00:37:24,880 --> 00:37:29,119
all right so i saw one come through in

1151
00:37:26,960 --> 00:37:30,880
the chat what is your advice to guys

1152
00:37:29,119 --> 00:37:34,640
starting in this field

1153
00:37:30,880 --> 00:37:36,079
um so you perhaps joined after the the

1154
00:37:34,640 --> 00:37:38,000
portion that i gave in the beginning but

1155
00:37:36,079 --> 00:37:40,640
i'll repeat it again

1156
00:37:38,000 --> 00:37:42,640
be an expert in tech right don't be an

1157
00:37:40,640 --> 00:37:44,319
expert in security be an expert in tech

1158
00:37:42,640 --> 00:37:45,759
go and get to the nth level so for

1159
00:37:44,320 --> 00:37:48,640
example if you're interested

1160
00:37:45,760 --> 00:37:50,720
in microsoft 365 security then at that

1161
00:37:48,640 --> 00:37:51,359
point you need to go and read every

1162
00:37:50,720 --> 00:37:53,040
single

1163
00:37:51,359 --> 00:37:55,598
bit of documentation you can about the

1164
00:37:53,040 --> 00:37:57,680
graph api you need to understand every

1165
00:37:55,599 --> 00:37:59,119
nuance inside of the conditional access

1166
00:37:57,680 --> 00:38:00,799
piece you need to understand

1167
00:37:59,119 --> 00:38:02,720
every single api that's available in

1168
00:38:00,800 --> 00:38:03,359
sharepoint online and teams and all that

1169
00:38:02,720 --> 00:38:06,319
stuff

1170
00:38:03,359 --> 00:38:08,160
be a great technologist and then apply

1171
00:38:06,320 --> 00:38:09,280
cybersecurity principles on top of that

1172
00:38:08,160 --> 00:38:10,560
great base of knowledge

1173
00:38:09,280 --> 00:38:12,400
so that would be my strongest

1174
00:38:10,560 --> 00:38:14,240
recommendation here looks like we just

1175
00:38:12,400 --> 00:38:18,000
had another one come through

1176
00:38:14,240 --> 00:38:19,759
um okay so um

1177
00:38:18,000 --> 00:38:21,280
pass the prt attack many cats can

1178
00:38:19,760 --> 00:38:22,480
extract cloud credentials from a log on

1179
00:38:21,280 --> 00:38:23,760
session that can then be used in a

1180
00:38:22,480 --> 00:38:25,280
browser for 14 days unless the

1181
00:38:23,760 --> 00:38:28,720
associated account is disabled

1182
00:38:25,280 --> 00:38:30,240
um bypass mfa2 yeah so um so this is

1183
00:38:28,720 --> 00:38:31,598
where you've got to have those settings

1184
00:38:30,240 --> 00:38:32,078
done to make sure that you're not

1185
00:38:31,599 --> 00:38:33,200
vulnerable

1186
00:38:32,079 --> 00:38:35,200
to this kind of thing and that's where

1187
00:38:33,200 --> 00:38:36,960
you can harden your sso stack

1188
00:38:35,200 --> 00:38:38,879
to decrease the amount of time that your

1189
00:38:36,960 --> 00:38:40,480
auth tokens are available for

1190
00:38:38,880 --> 00:38:42,320
and so you can start cranking that down

1191
00:38:40,480 --> 00:38:43,680
now the thing you have to be careful

1192
00:38:42,320 --> 00:38:45,359
about when you start cranking that stuff

1193
00:38:43,680 --> 00:38:47,919
down is that sometimes it will break

1194
00:38:45,359 --> 00:38:48,960
legacy single sign-on integrations and

1195
00:38:47,920 --> 00:38:50,880
so that's where you've got to

1196
00:38:48,960 --> 00:38:52,480
ask the question of your business hey

1197
00:38:50,880 --> 00:38:54,400
you know how tight do we want to take

1198
00:38:52,480 --> 00:38:55,200
this down and do we have a legacy anchor

1199
00:38:54,400 --> 00:38:56,480
on our hands

1200
00:38:55,200 --> 00:38:58,960
where we're essentially forced into

1201
00:38:56,480 --> 00:39:01,440
using legacy single sign-on protocols

1202
00:38:58,960 --> 00:39:04,560
that could open us up to a past the

1203
00:39:01,440 --> 00:39:08,400
refresh token you know type of attack

1204
00:39:04,560 --> 00:39:10,078
so so yeah if um let's just make sure

1205
00:39:08,400 --> 00:39:12,640
anything else looks like we've got

1206
00:39:10,079 --> 00:39:14,079
everything all right well um

1207
00:39:12,640 --> 00:39:15,279
we've got one minute left i'm gonna go

1208
00:39:14,079 --> 00:39:16,480
ahead and end a little bit early but

1209
00:39:15,280 --> 00:39:17,440
it's a pleasure speaking to the quaran

1210
00:39:16,480 --> 00:39:19,920
kong crowd

1211
00:39:17,440 --> 00:39:21,040
any feedback or or uh questions go ahead

1212
00:39:19,920 --> 00:39:23,200
and reach out to me

1213
00:39:21,040 --> 00:39:24,320
um through cyrix.tech or through my

1214
00:39:23,200 --> 00:39:26,078
linkedin profile

1215
00:39:24,320 --> 00:39:29,839
happy to help hope you have a great rest

1216
00:39:26,079 --> 00:39:29,839
of the day

1217
00:39:38,960 --> 00:39:45,680
okay everyone left in track two

1218
00:39:42,560 --> 00:39:48,160
um we have a break until 12 30

1219
00:39:45,680 --> 00:39:49,520
uh with dave kennedy so if you want to

1220
00:39:48,160 --> 00:39:53,680
hop onto track one

1221
00:39:49,520 --> 00:39:58,800
you can watch the keynote at keynote

1222
00:39:53,680 --> 00:39:58,799
uh presentation from malwarebytes thank

1223
00:40:08,520 --> 00:40:11,520
you

