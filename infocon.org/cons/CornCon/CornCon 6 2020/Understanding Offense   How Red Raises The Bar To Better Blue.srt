1
00:00:00,080 --> 00:00:03,919
back to that next year and whatnot and

2
00:00:02,240 --> 00:00:06,000
back to some sort of normalcy

3
00:00:03,919 --> 00:00:07,200
uh but today's talk uh understanding

4
00:00:06,000 --> 00:00:09,040
offense um

5
00:00:07,200 --> 00:00:10,960
is one of my favorites because it's

6
00:00:09,040 --> 00:00:12,959
something that i commonly run into

7
00:00:10,960 --> 00:00:14,160
when we're testing organizations day in

8
00:00:12,960 --> 00:00:14,880
and day out and we test

9
00:00:14,160 --> 00:00:16,000
you know some of the largest

10
00:00:14,880 --> 00:00:17,760
organizations in the world always small

11
00:00:16,000 --> 00:00:19,119
to medium-sized businesses and

12
00:00:17,760 --> 00:00:20,880
you know there's a there's a struggle

13
00:00:19,119 --> 00:00:21,680
that that is consistently across the

14
00:00:20,880 --> 00:00:23,359
board for

15
00:00:21,680 --> 00:00:25,039
for pretty much every organization that

16
00:00:23,359 --> 00:00:26,960
we go in and

17
00:00:25,039 --> 00:00:28,400
and identify and it's usually having an

18
00:00:26,960 --> 00:00:30,160
understanding around what their

19
00:00:28,400 --> 00:00:31,439
priorities should be

20
00:00:30,160 --> 00:00:33,520
around how you best defend your

21
00:00:31,439 --> 00:00:35,600
organization and and how do you actually

22
00:00:33,520 --> 00:00:37,120
implement that based on the amount of

23
00:00:35,600 --> 00:00:38,000
resources and time and everything else

24
00:00:37,120 --> 00:00:40,000
that you have

25
00:00:38,000 --> 00:00:42,079
and and really i think a lot of a lot of

26
00:00:40,000 --> 00:00:44,559
companies focus very heavily on

27
00:00:42,079 --> 00:00:45,920
technology implementation versus

28
00:00:44,559 --> 00:00:47,360
understanding visibility and

29
00:00:45,920 --> 00:00:49,520
understanding what attackers do from a

30
00:00:47,360 --> 00:00:51,360
post exploitation perspective

31
00:00:49,520 --> 00:00:53,360
and and it's it's a very different mind

32
00:00:51,360 --> 00:00:54,320
mindset um to have when you're going

33
00:00:53,360 --> 00:00:56,079
into

34
00:00:54,320 --> 00:00:57,520
and looking at how you should best

35
00:00:56,079 --> 00:00:59,520
secure your organization

36
00:00:57,520 --> 00:01:02,079
so today we'll be talking about how do

37
00:00:59,520 --> 00:01:03,600
we start you know looking at at

38
00:01:02,079 --> 00:01:05,119
understanding our threat models what

39
00:01:03,600 --> 00:01:07,600
adversaries are doing

40
00:01:05,119 --> 00:01:08,799
um how do we um best prioritize those

41
00:01:07,600 --> 00:01:09,520
and how do we build our security

42
00:01:08,799 --> 00:01:11,680
programs to be

43
00:01:09,520 --> 00:01:13,439
be successful i'll also be going through

44
00:01:11,680 --> 00:01:14,720
some uh you know specific ways of

45
00:01:13,439 --> 00:01:15,919
getting around

46
00:01:14,720 --> 00:01:17,360
certain detection criteria and what

47
00:01:15,920 --> 00:01:18,799
attackers do and things of that effect i

48
00:01:17,360 --> 00:01:20,560
have a couple demos here i'll go through

49
00:01:18,799 --> 00:01:22,240
as well from a technical perspective

50
00:01:20,560 --> 00:01:24,320
um but i really appreciate you joining

51
00:01:22,240 --> 00:01:25,839
today

52
00:01:24,320 --> 00:01:27,199
just a brief introduction myself my name

53
00:01:25,840 --> 00:01:29,040
is dave kennedy um i've been in the

54
00:01:27,200 --> 00:01:29,759
security industry now for gosh over 20

55
00:01:29,040 --> 00:01:32,479
years so

56
00:01:29,759 --> 00:01:34,079
means i'm getting old um but uh you know

57
00:01:32,479 --> 00:01:35,679
i started my career off working for

58
00:01:34,079 --> 00:01:37,199
um the united states marine corps i was

59
00:01:35,680 --> 00:01:38,960
in the intelligence community

60
00:01:37,200 --> 00:01:41,439
um focusing more on cyber warfare

61
00:01:38,960 --> 00:01:44,240
activities um and so i worked a lot

62
00:01:41,439 --> 00:01:45,439
um with the nsa doing you know a lot of

63
00:01:44,240 --> 00:01:46,880
different things a lot of fun times i

64
00:01:45,439 --> 00:01:48,398
had two tours in iraq

65
00:01:46,880 --> 00:01:50,479
um i've been a chief security officer

66
00:01:48,399 --> 00:01:51,759
for a fortune 1000 company for a number

67
00:01:50,479 --> 00:01:53,840
of years

68
00:01:51,759 --> 00:01:55,520
and i started my own two companies uh

69
00:01:53,840 --> 00:01:57,840
trusted second binary defense

70
00:01:55,520 --> 00:01:59,200
uh we have over 300 folks uh worldwide

71
00:01:57,840 --> 00:02:00,799
every everybody from the uk

72
00:01:59,200 --> 00:02:02,719
norway you know pretty much consistently

73
00:02:00,799 --> 00:02:03,280
all across the board and uh just really

74
00:02:02,719 --> 00:02:05,199
trying to

75
00:02:03,280 --> 00:02:06,320
have the best the best folks working

76
00:02:05,200 --> 00:02:07,439
with our customers

77
00:02:06,320 --> 00:02:09,440
making them better from a security

78
00:02:07,439 --> 00:02:10,720
standpoint uh day in and day out

79
00:02:09,440 --> 00:02:12,800
um i also co-authored the book

80
00:02:10,720 --> 00:02:14,400
metasploit the penetration testers guide

81
00:02:12,800 --> 00:02:15,440
uh which was a lot of fun writing uh

82
00:02:14,400 --> 00:02:16,640
from the rears i think it's actually

83
00:02:15,440 --> 00:02:19,280
back here somewhere

84
00:02:16,640 --> 00:02:20,559
um but i was it was written in 11

85
00:02:19,280 --> 00:02:22,480
different languages so we had

86
00:02:20,560 --> 00:02:23,599
chinese in a number of you know

87
00:02:22,480 --> 00:02:25,200
different different languages that it

88
00:02:23,599 --> 00:02:27,760
was uh converted into

89
00:02:25,200 --> 00:02:28,799
so that was a lot of fun and um i write

90
00:02:27,760 --> 00:02:30,879
a lot of open source

91
00:02:28,800 --> 00:02:32,720
uh tools so i wrote magic unicorn the

92
00:02:30,879 --> 00:02:34,640
social engineer toolkit

93
00:02:32,720 --> 00:02:36,879
pentesters framework a number of other

94
00:02:34,640 --> 00:02:38,958
tools as well um focusing on either

95
00:02:36,879 --> 00:02:39,760
defense or exploitation or expert

96
00:02:38,959 --> 00:02:42,160
research

97
00:02:39,760 --> 00:02:42,879
uh in a lot of cases i'm on the news

98
00:02:42,160 --> 00:02:44,799
quite often

99
00:02:42,879 --> 00:02:46,799
uh and i also helped out with the the tv

100
00:02:44,800 --> 00:02:48,800
show mr robot

101
00:02:46,800 --> 00:02:50,400
i also just recently uh got a delorean

102
00:02:48,800 --> 00:02:52,640
so i'm really excited about that um

103
00:02:50,400 --> 00:02:54,239
i've always wanted to learn as a kid um

104
00:02:52,640 --> 00:02:55,760
and so over the past uh

105
00:02:54,239 --> 00:02:57,360
over the next few months i'm going to be

106
00:02:55,760 --> 00:02:58,959
uh working on kind of converting it to

107
00:02:57,360 --> 00:03:00,239
the uh the back to the future

108
00:02:58,959 --> 00:03:02,159
one two and three i wanna be able to do

109
00:03:00,239 --> 00:03:03,280
all three of them uh so be modding it

110
00:03:02,159 --> 00:03:04,000
out obviously giving it a

111
00:03:03,280 --> 00:03:05,200
capacitor

112
00:03:04,000 --> 00:03:06,319
and everything else but i just got that

113
00:03:05,200 --> 00:03:07,760
last week so i wanted to put that in

114
00:03:06,319 --> 00:03:08,238
there that i'm now the proud owner of

115
00:03:07,760 --> 00:03:11,760
the

116
00:03:08,239 --> 00:03:13,360
1982 dmc uh delorean which you know

117
00:03:11,760 --> 00:03:15,518
it's actually a really cool car a lot of

118
00:03:13,360 --> 00:03:16,400
weird things um quirks about it because

119
00:03:15,519 --> 00:03:18,400
you know it was

120
00:03:16,400 --> 00:03:20,080
designed kind of from the ground up um

121
00:03:18,400 --> 00:03:21,519
but the engine itself is like so

122
00:03:20,080 --> 00:03:24,239
underpowered so it's like a

123
00:03:21,519 --> 00:03:25,760
1980s you know uh car when you're

124
00:03:24,239 --> 00:03:27,200
driving it so it's really

125
00:03:25,760 --> 00:03:28,798
really underpowered uh so that's always

126
00:03:27,200 --> 00:03:30,238
fun i might do a new engine swapping

127
00:03:28,799 --> 00:03:32,720
or something like that down the road

128
00:03:30,239 --> 00:03:33,519
we'll see that's not what we're here to

129
00:03:32,720 --> 00:03:36,319
talk today

130
00:03:33,519 --> 00:03:36,799
um why we're here to talk today is you

131
00:03:36,319 --> 00:03:38,879
know

132
00:03:36,799 --> 00:03:40,640
organizations regardless if you're small

133
00:03:38,879 --> 00:03:42,319
or large struggle with different things

134
00:03:40,640 --> 00:03:43,760
um whether that's you know hey we're

135
00:03:42,319 --> 00:03:45,359
predominantly moving to the cloud and

136
00:03:43,760 --> 00:03:47,359
understanding cloud technology

137
00:03:45,360 --> 00:03:48,959
whether that's a hybrid model whether

138
00:03:47,360 --> 00:03:49,599
that's understanding what our perimeter

139
00:03:48,959 --> 00:03:51,040
looks like

140
00:03:49,599 --> 00:03:53,599
what understanding and educating our

141
00:03:51,040 --> 00:03:55,120
users you know information security

142
00:03:53,599 --> 00:03:58,079
tackles a lot of different areas and

143
00:03:55,120 --> 00:04:00,159
it's an extremely complex

144
00:03:58,080 --> 00:04:01,680
program to implement because you have to

145
00:04:00,159 --> 00:04:03,120
essentially interface with a lot of

146
00:04:01,680 --> 00:04:05,599
different businesses

147
00:04:03,120 --> 00:04:06,879
and when you look at um a lot of

148
00:04:05,599 --> 00:04:08,480
different organizations

149
00:04:06,879 --> 00:04:10,720
you know one of the most complex

150
00:04:08,480 --> 00:04:12,720
programs within a security program

151
00:04:10,720 --> 00:04:14,879
is by far and hands down vulnerable

152
00:04:12,720 --> 00:04:16,160
management volume management to me is is

153
00:04:14,879 --> 00:04:17,599
one of the hardest

154
00:04:16,160 --> 00:04:19,359
programs to actually accomplish with an

155
00:04:17,600 --> 00:04:19,759
organization because one you're never

156
00:04:19,358 --> 00:04:20,959
done

157
00:04:19,759 --> 00:04:22,320
i mean i've never seen a company that

158
00:04:20,959 --> 00:04:23,840
didn't have any vulnerabilities that

159
00:04:22,320 --> 00:04:25,759
just doesn't happen

160
00:04:23,840 --> 00:04:26,960
but the second part about it is you know

161
00:04:25,759 --> 00:04:28,960
when you start looking at you know hey

162
00:04:26,960 --> 00:04:30,479
maybe we have our operating systems down

163
00:04:28,960 --> 00:04:33,198
okay and maybe we you know we're getting

164
00:04:30,479 --> 00:04:34,320
to third-party um applications okay

165
00:04:33,199 --> 00:04:36,080
we start getting into like the web

166
00:04:34,320 --> 00:04:37,440
application databases middleware tier

167
00:04:36,080 --> 00:04:38,960
things that affect ownership really

168
00:04:37,440 --> 00:04:40,880
starts to kind of go out the window

169
00:04:38,960 --> 00:04:42,400
on who's actually you know in charge of

170
00:04:40,880 --> 00:04:44,800
maintaining and supporting

171
00:04:42,400 --> 00:04:46,960
um that as we go along and so you know

172
00:04:44,800 --> 00:04:49,520
when you look at vulnerable management

173
00:04:46,960 --> 00:04:50,159
as an organization you know it we know

174
00:04:49,520 --> 00:04:51,758
that that

175
00:04:50,160 --> 00:04:52,960
we're not going to be a perfect system

176
00:04:51,759 --> 00:04:54,320
that you know there are going to be

177
00:04:52,960 --> 00:04:55,440
systems out there that we didn't know

178
00:04:54,320 --> 00:04:56,719
existed there's going gonna be systems

179
00:04:55,440 --> 00:04:57,840
out there that are legacy there's gonna

180
00:04:56,720 --> 00:04:59,440
be systems out there

181
00:04:57,840 --> 00:05:00,719
that we can't patch because it'll impact

182
00:04:59,440 --> 00:05:01,440
the business too much there are systems

183
00:05:00,720 --> 00:05:03,039
out there that

184
00:05:01,440 --> 00:05:04,240
we just haven't identified the exposures

185
00:05:03,039 --> 00:05:05,360
out there whether it's a custom map

186
00:05:04,240 --> 00:05:06,639
third-party app

187
00:05:05,360 --> 00:05:09,039
software that we have in place

188
00:05:06,639 --> 00:05:10,639
regardless you know there's a lot of a

189
00:05:09,039 --> 00:05:12,000
lot of complexities

190
00:05:10,639 --> 00:05:14,320
running technology within an

191
00:05:12,000 --> 00:05:16,000
organization and technology is just

192
00:05:14,320 --> 00:05:18,080
expanding and increasing right we have a

193
00:05:16,000 --> 00:05:18,960
technology that that gets added all the

194
00:05:18,080 --> 00:05:20,320
time i'm sure

195
00:05:18,960 --> 00:05:21,680
i'm sure everybody here knows of every

196
00:05:20,320 --> 00:05:22,800
single piece of technology that is

197
00:05:21,680 --> 00:05:24,320
implemented in every one of your

198
00:05:22,800 --> 00:05:25,039
organizations and continues to know that

199
00:05:24,320 --> 00:05:27,199
every single day

200
00:05:25,039 --> 00:05:28,560
day in and day out um usually doesn't

201
00:05:27,199 --> 00:05:30,479
happen that way right

202
00:05:28,560 --> 00:05:32,240
and so with technology progression with

203
00:05:30,479 --> 00:05:35,280
our attack surfaces expanding

204
00:05:32,240 --> 00:05:37,280
you know the mindset of of ten years ago

205
00:05:35,280 --> 00:05:38,799
was hey let's build a castle let's build

206
00:05:37,280 --> 00:05:40,559
this heavily fortified

207
00:05:38,800 --> 00:05:42,240
castle that you know is he's got these

208
00:05:40,560 --> 00:05:43,199
um you know he's got a drawbridge he's

209
00:05:42,240 --> 00:05:44,320
got archers

210
00:05:43,199 --> 00:05:46,560
we got all this stuff that we can

211
00:05:44,320 --> 00:05:47,919
protect the inside of our castle with

212
00:05:46,560 --> 00:05:49,360
then you know what we started realizing

213
00:05:47,919 --> 00:05:50,320
is hey now we have things like work from

214
00:05:49,360 --> 00:05:51,919
home we have

215
00:05:50,320 --> 00:05:54,159
different architecture designs where our

216
00:05:51,919 --> 00:05:56,318
users are more mobile and and remote in

217
00:05:54,160 --> 00:05:58,000
in many cases and we were leveraging

218
00:05:56,319 --> 00:06:00,720
more cloud infrastructure so

219
00:05:58,000 --> 00:06:02,960
our our castles are no longer there and

220
00:06:00,720 --> 00:06:03,600
our attack surfaces have have absolutely

221
00:06:02,960 --> 00:06:05,919
changed

222
00:06:03,600 --> 00:06:07,360
as technology has changed as well and so

223
00:06:05,919 --> 00:06:08,880
when you start looking at kind of the

224
00:06:07,360 --> 00:06:10,639
current state of security

225
00:06:08,880 --> 00:06:12,560
most organizations struggle to

226
00:06:10,639 --> 00:06:15,440
understand complex techniques

227
00:06:12,560 --> 00:06:16,880
and and when we talk about techniques um

228
00:06:15,440 --> 00:06:18,000
the you know the term the tactics

229
00:06:16,880 --> 00:06:19,440
techniques and procedures

230
00:06:18,000 --> 00:06:21,199
is commonly used all across the board so

231
00:06:19,440 --> 00:06:23,280
ttps right um

232
00:06:21,199 --> 00:06:24,960
you know most organizations are solely

233
00:06:23,280 --> 00:06:26,239
focusing on just the techniques and not

234
00:06:24,960 --> 00:06:27,280
understanding the tactics that

235
00:06:26,240 --> 00:06:28,639
adversaries

236
00:06:27,280 --> 00:06:30,400
um go through and the procedures that

237
00:06:28,639 --> 00:06:34,240
they operate by and

238
00:06:30,400 --> 00:06:35,679
this is kind of a um a shift that the

239
00:06:34,240 --> 00:06:38,160
industry continues to need

240
00:06:35,680 --> 00:06:39,280
to need to do which is hey we know that

241
00:06:38,160 --> 00:06:40,400
vulnerability management isn't going to

242
00:06:39,280 --> 00:06:42,000
be perfect we know that we're going to

243
00:06:40,400 --> 00:06:43,280
have some issues

244
00:06:42,000 --> 00:06:44,720
um you know that we're not going to be

245
00:06:43,280 --> 00:06:45,758
able to address or that we didn't know

246
00:06:44,720 --> 00:06:47,280
existed

247
00:06:45,759 --> 00:06:49,360
and that an attacker could potentially

248
00:06:47,280 --> 00:06:51,520
exploit those specific weaknesses

249
00:06:49,360 --> 00:06:52,880
and so if we know that that's the case

250
00:06:51,520 --> 00:06:55,198
you know traditionally

251
00:06:52,880 --> 00:06:56,719
let's let's fly back 10 years ago

252
00:06:55,199 --> 00:06:58,000
whenever an organization would get a

253
00:06:56,720 --> 00:06:59,840
penetration test done

254
00:06:58,000 --> 00:07:01,360
and they'd focus you know on on

255
00:06:59,840 --> 00:07:02,400
identifying what exposures they have so

256
00:07:01,360 --> 00:07:04,000
they can patch them

257
00:07:02,400 --> 00:07:05,599
there would be less of a focus on what

258
00:07:04,000 --> 00:07:06,080
happened afterwards so for example let's

259
00:07:05,599 --> 00:07:08,400
just say

260
00:07:06,080 --> 00:07:10,159
you know i popped a a web application

261
00:07:08,400 --> 00:07:11,679
had sql injection on it gave me

262
00:07:10,160 --> 00:07:13,120
you know command execution and then from

263
00:07:11,680 --> 00:07:14,240
command execution i was able to get real

264
00:07:13,120 --> 00:07:16,319
code execution and from

265
00:07:14,240 --> 00:07:18,240
remote code execution i was able to you

266
00:07:16,319 --> 00:07:19,599
know um do defense evasion and from

267
00:07:18,240 --> 00:07:21,120
there move laterally across the network

268
00:07:19,599 --> 00:07:22,719
until i got access to

269
00:07:21,120 --> 00:07:24,319
you know a system that was a server that

270
00:07:22,720 --> 00:07:25,840
had a local admin on it that a weak

271
00:07:24,319 --> 00:07:27,039
password then from there i was able to

272
00:07:25,840 --> 00:07:28,400
move to another server and then from

273
00:07:27,039 --> 00:07:29,440
there you know i got domain admin and

274
00:07:28,400 --> 00:07:30,318
from there i was able to get access to

275
00:07:29,440 --> 00:07:31,919
maintenance okay

276
00:07:30,319 --> 00:07:34,400
let's just take that as an example you

277
00:07:31,919 --> 00:07:36,479
know just a standard penetration test

278
00:07:34,400 --> 00:07:37,520
a lot of the focus would have been the

279
00:07:36,479 --> 00:07:39,280
weak password

280
00:07:37,520 --> 00:07:41,840
from the admin account would have been

281
00:07:39,280 --> 00:07:43,520
the sql injection on the web application

282
00:07:41,840 --> 00:07:44,960
and that probably would have been it uh

283
00:07:43,520 --> 00:07:45,440
from an attack surface perspective of

284
00:07:44,960 --> 00:07:47,919
what

285
00:07:45,440 --> 00:07:49,120
it would actually focus on now the the

286
00:07:47,919 --> 00:07:50,719
problem with that is that

287
00:07:49,120 --> 00:07:52,560
while you're addressing those specific

288
00:07:50,720 --> 00:07:53,360
actual holes that you have which are

289
00:07:52,560 --> 00:07:54,160
things that you should do because

290
00:07:53,360 --> 00:07:56,080
they're risks right you need to

291
00:07:54,160 --> 00:07:56,960
prioritize those with personnel timing

292
00:07:56,080 --> 00:07:59,199
everything else

293
00:07:56,960 --> 00:08:00,719
and address those and fix those there

294
00:07:59,199 --> 00:08:02,479
was less of a focus on

295
00:08:00,720 --> 00:08:04,000
the actual attack patterns that occurred

296
00:08:02,479 --> 00:08:04,960
when that sql injection attack was

297
00:08:04,000 --> 00:08:07,280
successful

298
00:08:04,960 --> 00:08:08,318
so what happens when an attack is

299
00:08:07,280 --> 00:08:10,000
actually successful within an

300
00:08:08,319 --> 00:08:12,240
organization so you compromise

301
00:08:10,000 --> 00:08:13,360
you have access now what happens okay

302
00:08:12,240 --> 00:08:15,120
now we start looking at

303
00:08:13,360 --> 00:08:16,479
you know defense evasion persistence

304
00:08:15,120 --> 00:08:17,840
lateral movement all these post

305
00:08:16,479 --> 00:08:19,120
exploitation scenarios all the way to

306
00:08:17,840 --> 00:08:20,719
exfiltration

307
00:08:19,120 --> 00:08:22,479
and and we start to look at those when

308
00:08:20,720 --> 00:08:24,560
we break those down in our environments

309
00:08:22,479 --> 00:08:26,560
and are those things that we can um

310
00:08:24,560 --> 00:08:27,759
either a prevent you know within our

311
00:08:26,560 --> 00:08:29,280
environment you know disallow certain

312
00:08:27,759 --> 00:08:30,560
things from running uh consistently

313
00:08:29,280 --> 00:08:32,159
across our enterprise

314
00:08:30,560 --> 00:08:34,399
um or two are the things that we can

315
00:08:32,159 --> 00:08:35,838
easily detect so that we can identify

316
00:08:34,399 --> 00:08:37,039
when an attacker is in our environment

317
00:08:35,839 --> 00:08:39,039
earlier on

318
00:08:37,039 --> 00:08:40,640
and so you know you see something like

319
00:08:39,039 --> 00:08:42,399
the miter attack framer come out

320
00:08:40,640 --> 00:08:44,000
um and and you know what's interesting

321
00:08:42,399 --> 00:08:46,480
about miter attack is that

322
00:08:44,000 --> 00:08:47,519
um i have rarely seen an organization

323
00:08:46,480 --> 00:08:49,519
actually implement

324
00:08:47,519 --> 00:08:51,200
the miter attack framework um they want

325
00:08:49,519 --> 00:08:52,640
to do it but then they look at the

326
00:08:51,200 --> 00:08:53,760
techniques and sub techniques and like

327
00:08:52,640 --> 00:08:54,800
well there's thousands of techniques

328
00:08:53,760 --> 00:08:56,399
here i don't even know where to start so

329
00:08:54,800 --> 00:08:59,120
i'm not gonna even bother

330
00:08:56,399 --> 00:09:00,720
and and there's a there's a there's a

331
00:08:59,120 --> 00:09:02,640
problem with that because

332
00:09:00,720 --> 00:09:04,480
when you look at what security operation

333
00:09:02,640 --> 00:09:05,040
centers um today are designed to do

334
00:09:04,480 --> 00:09:07,839
they're still

335
00:09:05,040 --> 00:09:09,680
very traditional a sense of you know

336
00:09:07,839 --> 00:09:11,519
information comes in from a log

337
00:09:09,680 --> 00:09:13,359
that log shorter is an alarm they look

338
00:09:11,519 --> 00:09:14,399
at that alarm is that alarm a false

339
00:09:13,360 --> 00:09:16,399
positive or not

340
00:09:14,399 --> 00:09:18,480
close that alarm move on to the next one

341
00:09:16,399 --> 00:09:19,600
or escalate it to tier two tier three

342
00:09:18,480 --> 00:09:21,120
stock analyst

343
00:09:19,600 --> 00:09:22,320
so you know we we still have the

344
00:09:21,120 --> 00:09:23,440
traditional methods of security

345
00:09:22,320 --> 00:09:24,800
operation centers

346
00:09:23,440 --> 00:09:26,880
when we should really be looking at

347
00:09:24,800 --> 00:09:28,880
unusual behavior or things that are

348
00:09:26,880 --> 00:09:29,760
that are exhibiting behavior within our

349
00:09:28,880 --> 00:09:31,200
environment that we should be

350
00:09:29,760 --> 00:09:31,920
investigating from an attack surface

351
00:09:31,200 --> 00:09:33,680
perspective

352
00:09:31,920 --> 00:09:35,360
it's what we consider threat hunting um

353
00:09:33,680 --> 00:09:37,120
in in many cases

354
00:09:35,360 --> 00:09:38,800
so we're still very much a signature

355
00:09:37,120 --> 00:09:39,600
driven industry and i'll talk about that

356
00:09:38,800 --> 00:09:42,640
here in a second

357
00:09:39,600 --> 00:09:44,320
um even even if you have an edr

358
00:09:42,640 --> 00:09:45,760
you know endpoint detection response

359
00:09:44,320 --> 00:09:47,279
tool deployed in your environment it's

360
00:09:45,760 --> 00:09:48,959
still very signature driven

361
00:09:47,279 --> 00:09:50,880
they have what they've built from known

362
00:09:48,959 --> 00:09:52,160
techniques into their tools

363
00:09:50,880 --> 00:09:54,480
hopefully detecting stuff that you've

364
00:09:52,160 --> 00:09:56,240
seen a great example

365
00:09:54,480 --> 00:09:59,040
is i just made a post on twitter

366
00:09:56,240 --> 00:09:59,519
recently about it and we had a customer

367
00:09:59,040 --> 00:10:01,439
that

368
00:09:59,519 --> 00:10:03,440
was running one of the one of the brand

369
00:10:01,440 --> 00:10:05,519
names and edr products

370
00:10:03,440 --> 00:10:07,120
um and had both the endpoint detection

371
00:10:05,519 --> 00:10:08,640
and endpoint protection on

372
00:10:07,120 --> 00:10:10,079
and uh we had a red team engaging with

373
00:10:08,640 --> 00:10:10,880
them and everybody wants a red team

374
00:10:10,079 --> 00:10:12,239
engagement uh

375
00:10:10,880 --> 00:10:13,680
it's it's because it's like the most

376
00:10:12,240 --> 00:10:14,720
amazing thing everybody thinks it sounds

377
00:10:13,680 --> 00:10:16,719
amazing so we got to do it

378
00:10:14,720 --> 00:10:18,320
because we can't do a traditional pen

379
00:10:16,720 --> 00:10:20,240
test because we're well above

380
00:10:18,320 --> 00:10:21,760
a penetration test right we got to do a

381
00:10:20,240 --> 00:10:24,800
red team i would say

382
00:10:21,760 --> 00:10:26,480
probably 80 to 90 percent of people that

383
00:10:24,800 --> 00:10:28,160
we test from a red teaming perspective

384
00:10:26,480 --> 00:10:30,720
are not able to handle

385
00:10:28,160 --> 00:10:31,920
what an actual red team entails um and

386
00:10:30,720 --> 00:10:33,519
and we have varying levels of

387
00:10:31,920 --> 00:10:35,279
sophistication like we can

388
00:10:33,519 --> 00:10:36,880
simulate you know whatever specific

389
00:10:35,279 --> 00:10:38,399
adversary that are in their

390
00:10:36,880 --> 00:10:40,000
uh individual industry verticals all the

391
00:10:38,399 --> 00:10:41,839
way to extremely mature

392
00:10:40,000 --> 00:10:43,760
zero-day routes you know undocumented

393
00:10:41,839 --> 00:10:44,480
features completely custom attack

394
00:10:43,760 --> 00:10:46,640
surface

395
00:10:44,480 --> 00:10:47,920
attack uh chains you know across their

396
00:10:46,640 --> 00:10:49,199
environment to to some of the ones that

397
00:10:47,920 --> 00:10:50,160
can actually handle those

398
00:10:49,200 --> 00:10:52,000
but what's interesting with this

399
00:10:50,160 --> 00:10:52,800
customer um and this is not a knock on

400
00:10:52,000 --> 00:10:54,800
the customer i mean

401
00:10:52,800 --> 00:10:56,079
a great customer they're they're amazing

402
00:10:54,800 --> 00:10:57,839
uh folks

403
00:10:56,079 --> 00:10:59,680
is that they relied though very heavily

404
00:10:57,839 --> 00:11:01,440
off of technology

405
00:10:59,680 --> 00:11:03,519
and when you rely heavily just off your

406
00:11:01,440 --> 00:11:05,279
technology you're not improving

407
00:11:03,519 --> 00:11:06,959
your environment you know understanding

408
00:11:05,279 --> 00:11:08,320
what that detection means in your

409
00:11:06,959 --> 00:11:09,599
environment or what the detections are

410
00:11:08,320 --> 00:11:10,640
within the edr products that can be

411
00:11:09,600 --> 00:11:11,760
circumvented

412
00:11:10,640 --> 00:11:13,439
you don't have a good monitoring

413
00:11:11,760 --> 00:11:14,000
detection program by slapping an edr

414
00:11:13,440 --> 00:11:15,920
does not make

415
00:11:14,000 --> 00:11:16,800
you secure in any way shape or form it

416
00:11:15,920 --> 00:11:17,680
means you might have some more

417
00:11:16,800 --> 00:11:18,959
visibility

418
00:11:17,680 --> 00:11:20,719
you might have some predefined things

419
00:11:18,959 --> 00:11:22,719
that maybe your antivirus didn't pick up

420
00:11:20,720 --> 00:11:24,399
but you're still far far far far away

421
00:11:22,720 --> 00:11:26,640
from being able to withstand even

422
00:11:24,399 --> 00:11:28,000
an average level of sophistication

423
00:11:26,640 --> 00:11:29,120
towards your organization from a

424
00:11:28,000 --> 00:11:30,399
hacker's perspective

425
00:11:29,120 --> 00:11:31,600
and look at what the ransomware authors

426
00:11:30,399 --> 00:11:32,160
are doing we'll talk about this as we go

427
00:11:31,600 --> 00:11:33,760
along

428
00:11:32,160 --> 00:11:35,279
but the ransomware authors have have

429
00:11:33,760 --> 00:11:36,399
gained a substantial amount of

430
00:11:35,279 --> 00:11:38,320
sophistication

431
00:11:36,399 --> 00:11:39,600
that are designed to get around your edr

432
00:11:38,320 --> 00:11:40,800
products that are designed to get around

433
00:11:39,600 --> 00:11:42,240
your antivirus products and they're

434
00:11:40,800 --> 00:11:43,439
designed to inflict as much damage as

435
00:11:42,240 --> 00:11:46,079
possible

436
00:11:43,440 --> 00:11:47,600
and so if you don't continuously focus

437
00:11:46,079 --> 00:11:48,479
on enhancing your monitoring detection

438
00:11:47,600 --> 00:11:50,000
capabilities

439
00:11:48,480 --> 00:11:51,760
you're going to fail when it comes to

440
00:11:50,000 --> 00:11:53,920
protecting against specific attacks and

441
00:11:51,760 --> 00:11:55,920
i'll show you some examples of this here

442
00:11:53,920 --> 00:11:58,000
in a little bit and we also talk about

443
00:11:55,920 --> 00:12:00,240
threat intelligence in a sense where

444
00:11:58,000 --> 00:12:02,000
you know threat intelligence um is is

445
00:12:00,240 --> 00:12:03,680
still to a lot of organizations

446
00:12:02,000 --> 00:12:06,160
domain names of already compromised

447
00:12:03,680 --> 00:12:07,599
infrastructure not actual techniques

448
00:12:06,160 --> 00:12:09,199
broken down based off of industry

449
00:12:07,600 --> 00:12:10,399
vertical based off of adversaries in

450
00:12:09,200 --> 00:12:11,440
your threat models that you can use

451
00:12:10,399 --> 00:12:12,880
actionably

452
00:12:11,440 --> 00:12:14,560
to build better detection criteria in

453
00:12:12,880 --> 00:12:16,079
your environment so again we have a lot

454
00:12:14,560 --> 00:12:17,359
of maturing to do here and this isn't

455
00:12:16,079 --> 00:12:18,560
a blanket segment across the board there

456
00:12:17,360 --> 00:12:19,360
are some organizations that are doing

457
00:12:18,560 --> 00:12:21,199
phenomenal

458
00:12:19,360 --> 00:12:23,360
um at a lot of this but most are still

459
00:12:21,200 --> 00:12:25,360
at a very basic level which again

460
00:12:23,360 --> 00:12:26,240
we're talking about but to my back to my

461
00:12:25,360 --> 00:12:27,440
story really quick around the

462
00:12:26,240 --> 00:12:29,200
penetration test

463
00:12:27,440 --> 00:12:31,920
you know the the the company would only

464
00:12:29,200 --> 00:12:34,399
focus on sql injection and that password

465
00:12:31,920 --> 00:12:35,839
not on all the different steps um that

466
00:12:34,399 --> 00:12:37,120
that happened during that you know

467
00:12:35,839 --> 00:12:38,480
how did i get those credentials in the

468
00:12:37,120 --> 00:12:39,680
first place how did i move laterally

469
00:12:38,480 --> 00:12:41,040
from one workstation to the next

470
00:12:39,680 --> 00:12:41,920
workstation or one from one server to

471
00:12:41,040 --> 00:12:42,959
the next server

472
00:12:41,920 --> 00:12:44,399
you know one of those those those

473
00:12:42,959 --> 00:12:45,279
specific types of techniques that i

474
00:12:44,399 --> 00:12:46,800
would leverage

475
00:12:45,279 --> 00:12:48,079
in an environment and there's there's

476
00:12:46,800 --> 00:12:49,040
common ones across the board you know

477
00:12:48,079 --> 00:12:50,479
whether i'm doing

478
00:12:49,040 --> 00:12:52,639
you know local link multicast name

479
00:12:50,480 --> 00:12:54,000
resolution protocol or netbell's name

480
00:12:52,639 --> 00:12:55,279
services or whether i'm doing printer

481
00:12:54,000 --> 00:12:56,800
spool attacks um

482
00:12:55,279 --> 00:12:58,399
you know abusing unconstrained

483
00:12:56,800 --> 00:12:59,839
delegation um

484
00:12:58,399 --> 00:13:01,519
you know common techniques that we'll

485
00:12:59,839 --> 00:13:03,600
see very much applied

486
00:13:01,519 --> 00:13:04,639
consistently across a lot of attacks you

487
00:13:03,600 --> 00:13:05,519
know those are things that you can

488
00:13:04,639 --> 00:13:07,360
quickly

489
00:13:05,519 --> 00:13:09,360
identify and work work through your

490
00:13:07,360 --> 00:13:10,160
program without without a lot of effort

491
00:13:09,360 --> 00:13:13,200
a lot of

492
00:13:10,160 --> 00:13:14,399
a lot of change and so if you look at

493
00:13:13,200 --> 00:13:18,079
our adversaries

494
00:13:14,399 --> 00:13:20,320
you know 95 of of companies are not in

495
00:13:18,079 --> 00:13:22,638
the nation-state category um

496
00:13:20,320 --> 00:13:23,519
when it comes to to who their threat

497
00:13:22,639 --> 00:13:25,200
models are

498
00:13:23,519 --> 00:13:27,200
so understanding your threat models is

499
00:13:25,200 --> 00:13:27,760
number one in any any program that you

500
00:13:27,200 --> 00:13:29,040
want to

501
00:13:27,760 --> 00:13:31,040
build because you need to understand

502
00:13:29,040 --> 00:13:32,399
what your your offense is doing in order

503
00:13:31,040 --> 00:13:35,040
to get a better defense

504
00:13:32,399 --> 00:13:36,720
um so first and foremost having um and

505
00:13:35,040 --> 00:13:37,680
understanding who your adversaries are

506
00:13:36,720 --> 00:13:39,839
in play

507
00:13:37,680 --> 00:13:41,760
uh and what their sophistication level

508
00:13:39,839 --> 00:13:43,199
and capabilities are is number one and

509
00:13:41,760 --> 00:13:44,480
starting to map those right so building

510
00:13:43,199 --> 00:13:47,120
out your threat models

511
00:13:44,480 --> 00:13:48,000
overall now i talked about this earlier

512
00:13:47,120 --> 00:13:50,000
but what's interesting

513
00:13:48,000 --> 00:13:51,360
about ransomware is that you know i was

514
00:13:50,000 --> 00:13:53,040
completely wrong

515
00:13:51,360 --> 00:13:54,720
a couple of years ago you know when i

516
00:13:53,040 --> 00:13:56,880
saw what happened with the carter market

517
00:13:54,720 --> 00:13:57,760
and the carter market got tough uh for a

518
00:13:56,880 --> 00:13:59,760
lot of these these

519
00:13:57,760 --> 00:14:01,439
that that soon became the ransomware

520
00:13:59,760 --> 00:14:02,480
authors the the ransomware as a service

521
00:14:01,440 --> 00:14:04,000
type models

522
00:14:02,480 --> 00:14:05,760
um you know i thought ransomware was

523
00:14:04,000 --> 00:14:06,880
going to kind of die off and the reason

524
00:14:05,760 --> 00:14:08,319
why i thought it would die off is

525
00:14:06,880 --> 00:14:10,240
because they were they were at such a

526
00:14:08,320 --> 00:14:11,839
low sophistication level

527
00:14:10,240 --> 00:14:13,600
um that i really didn't see them

528
00:14:11,839 --> 00:14:14,240
progressing much and i thought yeah they

529
00:14:13,600 --> 00:14:16,320
would get

530
00:14:14,240 --> 00:14:18,160
you know people with with you know

531
00:14:16,320 --> 00:14:20,160
fishing campaigns and small companies

532
00:14:18,160 --> 00:14:22,000
that didn't do any security whatsoever

533
00:14:20,160 --> 00:14:23,439
um but i thought that would eventually

534
00:14:22,000 --> 00:14:26,320
increase and raise

535
00:14:23,440 --> 00:14:26,959
um as time went on and so what ended up

536
00:14:26,320 --> 00:14:29,279
happening though

537
00:14:26,959 --> 00:14:30,000
is is is ransomware got a little bit

538
00:14:29,279 --> 00:14:35,120
more

539
00:14:30,000 --> 00:14:35,120
crazy um as things go um

540
00:14:35,680 --> 00:14:39,519
sorry one second okay sorry about that

541
00:14:38,959 --> 00:14:43,279
um

542
00:14:39,519 --> 00:14:45,600
so i you know as ransomware

543
00:14:43,279 --> 00:14:47,600
started impacting very immature users

544
00:14:45,600 --> 00:14:49,199
and their sophistication levels were low

545
00:14:47,600 --> 00:14:51,760
what the ransomware authors did which

546
00:14:49,199 --> 00:14:53,199
was fairly unique was invest more in

547
00:14:51,760 --> 00:14:54,319
their infrastructure the development and

548
00:14:53,199 --> 00:14:56,240
getting more people

549
00:14:54,320 --> 00:14:57,440
so it's kind of like a full-fledged

550
00:14:56,240 --> 00:15:00,560
business

551
00:14:57,440 --> 00:15:02,000
that was kind of happening and when that

552
00:15:00,560 --> 00:15:03,359
started occurring they started getting

553
00:15:02,000 --> 00:15:05,199
more and more sophisticated and going

554
00:15:03,360 --> 00:15:06,720
after small to medium-sized businesses

555
00:15:05,199 --> 00:15:08,319
and now we just started seeing recently

556
00:15:06,720 --> 00:15:09,360
over the past year and a half them

557
00:15:08,320 --> 00:15:11,680
targeting large

558
00:15:09,360 --> 00:15:13,360
large organizations and going with with

559
00:15:11,680 --> 00:15:14,719
very different types of attacks and i'll

560
00:15:13,360 --> 00:15:15,440
talk about tech customizations here in

561
00:15:14,720 --> 00:15:16,959
just a second

562
00:15:15,440 --> 00:15:18,320
but i mean they're they're using living

563
00:15:16,959 --> 00:15:19,599
off the land they're using powershell

564
00:15:18,320 --> 00:15:20,320
exploitation they're developing their

565
00:15:19,600 --> 00:15:21,600
own code

566
00:15:20,320 --> 00:15:23,279
they're weaponizing their own tooling

567
00:15:21,600 --> 00:15:23,600
they're leveraging open source resources

568
00:15:23,279 --> 00:15:26,240
and

569
00:15:23,600 --> 00:15:27,680
in open uh open source tools um

570
00:15:26,240 --> 00:15:29,680
offensive security tools

571
00:15:27,680 --> 00:15:31,439
um and so they're they're they're mixing

572
00:15:29,680 --> 00:15:33,199
together all of these different areas to

573
00:15:31,440 --> 00:15:34,560
have a recipe for success

574
00:15:33,199 --> 00:15:36,639
and we just saw a couple days ago you

575
00:15:34,560 --> 00:15:38,239
know universal uh health systems i just

576
00:15:36,639 --> 00:15:39,519
had a massive day debris or not data

577
00:15:38,240 --> 00:15:40,560
breach but ransomware attack

578
00:15:39,519 --> 00:15:42,240
shut down their hospitals they're

579
00:15:40,560 --> 00:15:43,758
turning people away allegedly for deaths

580
00:15:42,240 --> 00:15:44,560
apparently again not confirmed on that

581
00:15:43,759 --> 00:15:46,000
one so i don't want to

582
00:15:44,560 --> 00:15:48,959
start rumors there just what was been

583
00:15:46,000 --> 00:15:50,160
reported we saw uh garmin recently 15

584
00:15:48,959 --> 00:15:51,839
million dollar ransom

585
00:15:50,160 --> 00:15:52,639
they're getting bigger and bolder with

586
00:15:51,839 --> 00:15:54,959
what they're doing and their

587
00:15:52,639 --> 00:15:56,639
sophistication levels are not just hey

588
00:15:54,959 --> 00:15:58,239
we're going to send out this executable

589
00:15:56,639 --> 00:15:59,279
and this this document you know to free

590
00:15:58,240 --> 00:16:00,560
to go and download is going to go and

591
00:15:59,279 --> 00:16:01,519
download a binary wrapper then from

592
00:16:00,560 --> 00:16:03,920
there execute

593
00:16:01,519 --> 00:16:05,120
it's changing quite a bit um as things

594
00:16:03,920 --> 00:16:06,160
have gone along so

595
00:16:05,120 --> 00:16:08,079
you know and what's what's also

596
00:16:06,160 --> 00:16:09,839
interesting about this is that they're

597
00:16:08,079 --> 00:16:10,638
focusing less on the automation aspects

598
00:16:09,839 --> 00:16:11,680
of things and they're doing more

599
00:16:10,639 --> 00:16:13,120
targeted attacks

600
00:16:11,680 --> 00:16:15,199
you know doing open source intelligence

601
00:16:13,120 --> 00:16:16,880
gathering uh looking for

602
00:16:15,199 --> 00:16:18,000
um you know specific patterns then go

603
00:16:16,880 --> 00:16:19,360
after starting to target your

604
00:16:18,000 --> 00:16:20,720
organization infrastructure in a very

605
00:16:19,360 --> 00:16:22,000
customized approach and once they have

606
00:16:20,720 --> 00:16:23,920
access to a system

607
00:16:22,000 --> 00:16:25,199
you know they start focusing on other

608
00:16:23,920 --> 00:16:27,120
ways that we can do

609
00:16:25,199 --> 00:16:28,800
post-exploitation scenarios and lateral

610
00:16:27,120 --> 00:16:30,720
movement across your environment

611
00:16:28,800 --> 00:16:32,880
um and and continuously focus on that so

612
00:16:30,720 --> 00:16:34,320
again ways that they are getting better

613
00:16:32,880 --> 00:16:36,480
overall and those are things that we

614
00:16:34,320 --> 00:16:37,519
don't typically look at in our specific

615
00:16:36,480 --> 00:16:39,519
threat models and what we're building

616
00:16:37,519 --> 00:16:42,560
from a detection standpoint

617
00:16:39,519 --> 00:16:44,160
so in today's industry if you customize

618
00:16:42,560 --> 00:16:45,439
and attack in any way shape or form you

619
00:16:44,160 --> 00:16:46,639
can pretty much get around most

620
00:16:45,440 --> 00:16:48,480
detections today

621
00:16:46,639 --> 00:16:49,759
um that one customer that we was talking

622
00:16:48,480 --> 00:16:50,320
about we did the red team engagement

623
00:16:49,759 --> 00:16:52,800
with

624
00:16:50,320 --> 00:16:53,360
you know they had a a one of the the top

625
00:16:52,800 --> 00:16:54,959
you know

626
00:16:53,360 --> 00:16:56,240
edr products out there both in

627
00:16:54,959 --> 00:16:57,279
protection in texas and they didn't see

628
00:16:56,240 --> 00:16:59,519
us for over a month

629
00:16:57,279 --> 00:17:01,600
we had nothing that flagged not once in

630
00:16:59,519 --> 00:17:02,639
their entire infrastructure environment

631
00:17:01,600 --> 00:17:04,160
and they were shocked because they're

632
00:17:02,639 --> 00:17:05,679
like well our edr products should have

633
00:17:04,160 --> 00:17:06,240
picked this specific thing up and we're

634
00:17:05,679 --> 00:17:08,079
like

635
00:17:06,240 --> 00:17:09,679
yeah well i mean if we customize our

636
00:17:08,079 --> 00:17:11,760
attacks your edr's not going to see it

637
00:17:09,679 --> 00:17:13,520
you have to focus on your environment

638
00:17:11,760 --> 00:17:15,039
and and look for unusual behavior in

639
00:17:13,520 --> 00:17:16,720
your environment to get better at

640
00:17:15,039 --> 00:17:18,400
actual detections so let's take an

641
00:17:16,720 --> 00:17:20,880
example of of

642
00:17:18,400 --> 00:17:21,679
getting around detections today and

643
00:17:20,880 --> 00:17:23,199
obviously this is

644
00:17:21,679 --> 00:17:24,880
uh windows defender it could be with any

645
00:17:23,199 --> 00:17:25,679
product itself they're all very similar

646
00:17:24,880 --> 00:17:27,600
nature

647
00:17:25,679 --> 00:17:29,280
um to how they work even if it's an edr

648
00:17:27,599 --> 00:17:30,399
product or or things of that effect and

649
00:17:29,280 --> 00:17:31,918
in this case

650
00:17:30,400 --> 00:17:33,919
we're going to call registry r32 now

651
00:17:31,919 --> 00:17:35,520
register 32 is one of the most abused

652
00:17:33,919 --> 00:17:36,799
um living off the land binders and

653
00:17:35,520 --> 00:17:38,240
scripts that's out there a lot of

654
00:17:36,799 --> 00:17:40,000
ransomware use it

655
00:17:38,240 --> 00:17:42,559
um you know as a downloader and execute

656
00:17:40,000 --> 00:17:43,520
a way to execute scriptlet objects

657
00:17:42,559 --> 00:17:45,039
um but if you're not familiar with

658
00:17:43,520 --> 00:17:46,639
living off the lan just just a really

659
00:17:45,039 --> 00:17:49,840
quick um history lesson

660
00:17:46,640 --> 00:17:51,440
on some of this um so primarily you know

661
00:17:49,840 --> 00:17:53,199
the the method for exploitation was

662
00:17:51,440 --> 00:17:54,559
still executables and binaries which are

663
00:17:53,200 --> 00:17:56,480
still heavily used today because a lot

664
00:17:54,559 --> 00:17:58,000
of people don't have good control

665
00:17:56,480 --> 00:17:59,600
over unsigned code being executed in

666
00:17:58,000 --> 00:18:01,679
their systems and then things kind of

667
00:17:59,600 --> 00:18:04,000
migrated um to powershell

668
00:18:01,679 --> 00:18:04,960
um and and powershell has been a a major

669
00:18:04,000 --> 00:18:06,960
attack surface for

670
00:18:04,960 --> 00:18:08,559
for the longest time and then you look

671
00:18:06,960 --> 00:18:10,799
at what's what's called living on the

672
00:18:08,559 --> 00:18:12,720
land and this isn't specific to windows

673
00:18:10,799 --> 00:18:14,160
this is also this also very much applies

674
00:18:12,720 --> 00:18:17,039
to osx

675
00:18:14,160 --> 00:18:18,320
and linux as well and these are

676
00:18:17,039 --> 00:18:19,840
applications

677
00:18:18,320 --> 00:18:21,520
that are built in by the operating

678
00:18:19,840 --> 00:18:24,000
system or third parties

679
00:18:21,520 --> 00:18:25,200
they're code signed um and you know the

680
00:18:24,000 --> 00:18:27,039
by the the specific

681
00:18:25,200 --> 00:18:28,720
producer of that code you know to verify

682
00:18:27,039 --> 00:18:30,320
the integrity of the code itself

683
00:18:28,720 --> 00:18:31,840
and they have additional functionality

684
00:18:30,320 --> 00:18:33,280
in them that allow for certain things

685
00:18:31,840 --> 00:18:34,720
that happen like remote code execution

686
00:18:33,280 --> 00:18:37,840
or things of that effect

687
00:18:34,720 --> 00:18:40,480
in this specific case on registrar 32

688
00:18:37,840 --> 00:18:41,600
you can go and download a document or

689
00:18:40,480 --> 00:18:43,840
anything you want to it just

690
00:18:41,600 --> 00:18:45,280
contains whatever it wants but inside of

691
00:18:43,840 --> 00:18:46,879
it if you have it what's called a script

692
00:18:45,280 --> 00:18:48,639
object which is you know a scripting

693
00:18:46,880 --> 00:18:50,160
language that you can use for

694
00:18:48,640 --> 00:18:51,840
um you know essentially compromising the

695
00:18:50,160 --> 00:18:53,840
system if you want to um

696
00:18:51,840 --> 00:18:55,840
you can call that specific script object

697
00:18:53,840 --> 00:18:57,280
dll and have it parse that and

698
00:18:55,840 --> 00:18:59,360
automatically execute

699
00:18:57,280 --> 00:19:01,280
now since this attack this is since this

700
00:18:59,360 --> 00:19:03,439
is actively used quite frequently

701
00:19:01,280 --> 00:19:04,879
and microsoft instead of reducing its

702
00:19:03,440 --> 00:19:06,000
attack surface and removing that

703
00:19:04,880 --> 00:19:07,760
functionality out

704
00:19:06,000 --> 00:19:09,200
they decided to write you know a windows

705
00:19:07,760 --> 00:19:11,280
defender signature now

706
00:19:09,200 --> 00:19:13,280
windows defender is straight up a

707
00:19:11,280 --> 00:19:14,480
signature based antivirus product there

708
00:19:13,280 --> 00:19:15,918
is no machine learning

709
00:19:14,480 --> 00:19:17,760
artificial intelligence i don't care

710
00:19:15,919 --> 00:19:19,840
what their marketing says um about it it

711
00:19:17,760 --> 00:19:21,840
is straight up a signature based

712
00:19:19,840 --> 00:19:23,120
antivirus product there is no behavior

713
00:19:21,840 --> 00:19:25,760
in it whatsoever

714
00:19:23,120 --> 00:19:27,600
um and and it's extremely trivial to get

715
00:19:25,760 --> 00:19:28,720
around again signature-based detectors

716
00:19:27,600 --> 00:19:30,959
even with things like with the

717
00:19:28,720 --> 00:19:32,559
antimatter scanner face or amsi which

718
00:19:30,960 --> 00:19:35,520
was incorporated in windows 10

719
00:19:32,559 --> 00:19:36,639
amsi is dead it is not a security

720
00:19:35,520 --> 00:19:39,120
boundary

721
00:19:36,640 --> 00:19:41,520
um it is not a way to protect you in any

722
00:19:39,120 --> 00:19:43,600
way shape or form it is a commodity

723
00:19:41,520 --> 00:19:45,120
uh way of scanning scripted uh uh

724
00:19:43,600 --> 00:19:47,918
scripting languages

725
00:19:45,120 --> 00:19:49,678
um it is so far broken uh from a a

726
00:19:47,919 --> 00:19:52,799
preventative standpoint

727
00:19:49,679 --> 00:19:54,400
um that's not even funny so

728
00:19:52,799 --> 00:19:56,000
you know from from that side don't even

729
00:19:54,400 --> 00:19:57,360
worry about amsi from an attacker

730
00:19:56,000 --> 00:19:59,520
standpoint we can we can

731
00:19:57,360 --> 00:20:00,879
we can disable it um you know we can

732
00:19:59,520 --> 00:20:02,559
tell it not to scan

733
00:20:00,880 --> 00:20:04,400
you know there's two function types amsi

734
00:20:02,559 --> 00:20:05,760
scan string and as i scan buffer

735
00:20:04,400 --> 00:20:07,520
there's a million of different ways to

736
00:20:05,760 --> 00:20:08,480
get around amsi so it doesn't even touch

737
00:20:07,520 --> 00:20:09,918
your code in the first place you don't

738
00:20:08,480 --> 00:20:10,480
have to worry about obfuscating your

739
00:20:09,919 --> 00:20:12,080
code

740
00:20:10,480 --> 00:20:13,360
you can just shut off amsi in the first

741
00:20:12,080 --> 00:20:14,720
place and windows defender will never

742
00:20:13,360 --> 00:20:17,120
scan in the first place so it is

743
00:20:14,720 --> 00:20:18,480
it is broke um you know 10 ways to

744
00:20:17,120 --> 00:20:20,479
sunday because it runs in

745
00:20:18,480 --> 00:20:22,640
under the context of the user land aim

746
00:20:20,480 --> 00:20:24,159
has said a dll gets injected into a

747
00:20:22,640 --> 00:20:26,159
process space that you control as that

748
00:20:24,159 --> 00:20:27,520
regular user can shut it down on any way

749
00:20:26,159 --> 00:20:29,200
shape or form but anyways

750
00:20:27,520 --> 00:20:31,039
in this specific case we see here that

751
00:20:29,200 --> 00:20:33,120
that windows defender is

752
00:20:31,039 --> 00:20:34,080
um blocking the specific command from

753
00:20:33,120 --> 00:20:35,439
executing

754
00:20:34,080 --> 00:20:37,360
um so it's going up to this website

755
00:20:35,440 --> 00:20:39,039
downloading this this text document

756
00:20:37,360 --> 00:20:40,399
and then what it's trying to accomplish

757
00:20:39,039 --> 00:20:41,039
is just running calculate exe as an

758
00:20:40,400 --> 00:20:42,960
example

759
00:20:41,039 --> 00:20:45,200
so as an attacker is there a way for us

760
00:20:42,960 --> 00:20:46,240
to manipulate or modify this code in

761
00:20:45,200 --> 00:20:48,640
some way shape or form

762
00:20:46,240 --> 00:20:49,919
to gain remote code execution so the

763
00:20:48,640 --> 00:20:53,039
answer that is yes

764
00:20:49,919 --> 00:20:55,679
if we remove what the signature is uh

765
00:20:53,039 --> 00:20:57,919
for windows defender and instead of of

766
00:20:55,679 --> 00:21:00,000
going out to the website and downloading

767
00:20:57,919 --> 00:21:01,280
we can just use another application

768
00:21:00,000 --> 00:21:02,000
within windows to go and download our

769
00:21:01,280 --> 00:21:04,080
text file

770
00:21:02,000 --> 00:21:05,679
uh that test.txt in this case you can

771
00:21:04,080 --> 00:21:08,158
use bits admin you can use excel

772
00:21:05,679 --> 00:21:09,840
new versions of windows have curl um

773
00:21:08,159 --> 00:21:12,559
there's a million different ways to

774
00:21:09,840 --> 00:21:14,000
go and download a file um off of you

775
00:21:12,559 --> 00:21:15,918
know from the command line

776
00:21:14,000 --> 00:21:17,840
inside the house and in this case you

777
00:21:15,919 --> 00:21:20,080
know bits admin goes out to the internet

778
00:21:17,840 --> 00:21:22,080
is downloading test.txt and then from

779
00:21:20,080 --> 00:21:23,199
there we call registrar 32 without going

780
00:21:22,080 --> 00:21:24,639
out to the internet

781
00:21:23,200 --> 00:21:26,159
um and then running our script logic

782
00:21:24,640 --> 00:21:27,360
which completely circumvents the

783
00:21:26,159 --> 00:21:29,280
defender

784
00:21:27,360 --> 00:21:31,360
signature for this specific case here

785
00:21:29,280 --> 00:21:32,639
again very very broke very easy

786
00:21:31,360 --> 00:21:34,320
to get around as an attacker's

787
00:21:32,640 --> 00:21:35,360
perspective and that's very much how edr

788
00:21:34,320 --> 00:21:37,840
products work as well

789
00:21:35,360 --> 00:21:39,199
they're looking for very specific um

790
00:21:37,840 --> 00:21:40,480
types of attacks because they have to

791
00:21:39,200 --> 00:21:42,400
write signatures

792
00:21:40,480 --> 00:21:43,440
for entire enterprises and organizations

793
00:21:42,400 --> 00:21:44,400
that when you don't turn their product

794
00:21:43,440 --> 00:21:46,159
on you don't have 600

795
00:21:44,400 --> 00:21:48,240
000 you know false positives in your

796
00:21:46,159 --> 00:21:50,320
environment so they're very tuned pruned

797
00:21:48,240 --> 00:21:51,600
um type of of detections in those

798
00:21:50,320 --> 00:21:53,280
environments and so

799
00:21:51,600 --> 00:21:54,799
you know modifying it and changing it in

800
00:21:53,280 --> 00:21:55,760
some way shape or form completely blocks

801
00:21:54,799 --> 00:21:57,840
that um

802
00:21:55,760 --> 00:21:59,679
completely evades those detection

803
00:21:57,840 --> 00:22:01,039
criteria they have in place

804
00:21:59,679 --> 00:22:03,039
here's another example i'll show you

805
00:22:01,039 --> 00:22:05,120
here with uh with uh

806
00:22:03,039 --> 00:22:06,799
using magic unicorn and so you magic

807
00:22:05,120 --> 00:22:08,080
unicorn's a powershell exploitation

808
00:22:06,799 --> 00:22:10,960
framework that i wrote

809
00:22:08,080 --> 00:22:11,600
um and what it does is it um creates a

810
00:22:10,960 --> 00:22:13,520
one-liner

811
00:22:11,600 --> 00:22:15,840
essentially for you to go and download

812
00:22:13,520 --> 00:22:17,520
or to execute um shellcode directly into

813
00:22:15,840 --> 00:22:19,678
memory through powershell

814
00:22:17,520 --> 00:22:21,200
and uh windows defender loves my tool

815
00:22:19,679 --> 00:22:22,400
they love writing signatures for it

816
00:22:21,200 --> 00:22:23,760
um you know i'll come up with a new

817
00:22:22,400 --> 00:22:25,440
version they'll write signatures it's

818
00:22:23,760 --> 00:22:26,879
the most ridiculous thing ever because

819
00:22:25,440 --> 00:22:29,600
a funny story with this i didn't mean to

820
00:22:26,880 --> 00:22:32,799
do that but a really quick funny story

821
00:22:29,600 --> 00:22:35,120
um about this one is um i i wrote two

822
00:22:32,799 --> 00:22:36,799
tools uh one was called trevor c2

823
00:22:35,120 --> 00:22:38,320
uh which is a command control framework

824
00:22:36,799 --> 00:22:40,240
that does the exact same thing

825
00:22:38,320 --> 00:22:41,600
it has a c sharp module a powershell

826
00:22:40,240 --> 00:22:44,720
module um

827
00:22:41,600 --> 00:22:47,600
a c-plus plus module

828
00:22:44,720 --> 00:22:48,640
that's cross-compatible to linux osx and

829
00:22:47,600 --> 00:22:51,760
windows

830
00:22:48,640 --> 00:22:53,120
and um when i wrote unicorn they'll

831
00:22:51,760 --> 00:22:54,320
write new signatures all the time but

832
00:22:53,120 --> 00:22:55,520
they still haven't written anything for

833
00:22:54,320 --> 00:22:56,158
for trevor so you can just download

834
00:22:55,520 --> 00:22:57,918
trevor

835
00:22:56,159 --> 00:22:59,280
execute that have it load you know

836
00:22:57,919 --> 00:22:59,840
whatever you want to show code into

837
00:22:59,280 --> 00:23:01,678
memory

838
00:22:59,840 --> 00:23:03,918
and it doesn't get detected because you

839
00:23:01,679 --> 00:23:05,520
know they they only focus on unicorn so

840
00:23:03,919 --> 00:23:07,919
if your tools popular

841
00:23:05,520 --> 00:23:09,120
uh and and you know they decide they

842
00:23:07,919 --> 00:23:10,320
want to write tools for they assign

843
00:23:09,120 --> 00:23:11,918
essentially resources to write

844
00:23:10,320 --> 00:23:13,439
signatures when new versions are out but

845
00:23:11,919 --> 00:23:14,960
they don't focus on anything else so

846
00:23:13,440 --> 00:23:16,880
it's it's ridiculous it's a cat and

847
00:23:14,960 --> 00:23:18,799
mouse game but in this specific case

848
00:23:16,880 --> 00:23:20,080
it's it's so easy to get around so

849
00:23:18,799 --> 00:23:21,440
we're gonna i'm gonna go and open this

850
00:23:20,080 --> 00:23:22,720
this generated code that we just did

851
00:23:21,440 --> 00:23:24,240
this is our obfuscated code it's just

852
00:23:22,720 --> 00:23:25,760
base64 encoded

853
00:23:24,240 --> 00:23:27,520
so we get around execution restriction

854
00:23:25,760 --> 00:23:29,280
policies and then we're going to decode

855
00:23:27,520 --> 00:23:31,200
it so that we can take a look

856
00:23:29,280 --> 00:23:32,240
at the code through windows windows 10.

857
00:23:31,200 --> 00:23:32,960
now what we're going to see here is

858
00:23:32,240 --> 00:23:35,600
we're going to see

859
00:23:32,960 --> 00:23:36,080
amsi the antimatter scan interface

860
00:23:35,600 --> 00:23:38,000
actually

861
00:23:36,080 --> 00:23:39,760
scan my code now really quick here

862
00:23:38,000 --> 00:23:41,760
what's going to happen

863
00:23:39,760 --> 00:23:43,520
uh just behind the scenes within windows

864
00:23:41,760 --> 00:23:44,720
internals is that we're going to copy

865
00:23:43,520 --> 00:23:46,559
this code we're going to move it over to

866
00:23:44,720 --> 00:23:49,120
the powershell interpreter

867
00:23:46,559 --> 00:23:50,320
the powershell ise and when we hit play

868
00:23:49,120 --> 00:23:53,279
what's going to happen is there's

869
00:23:50,320 --> 00:23:54,799
there's a hook point in my in my in when

870
00:23:53,279 --> 00:23:57,840
my code's about to execute

871
00:23:54,799 --> 00:23:59,520
where amsi dot dll is is injected and

872
00:23:57,840 --> 00:24:01,279
there's going to be an msi scan string

873
00:23:59,520 --> 00:24:03,279
or msi scan buffer in this specific case

874
00:24:01,279 --> 00:24:05,120
it's going to be amsa scan string

875
00:24:03,279 --> 00:24:07,120
it's going to scan that code to look for

876
00:24:05,120 --> 00:24:08,639
any predefined signatures that has been

877
00:24:07,120 --> 00:24:10,559
written through what's called an amsi

878
00:24:08,640 --> 00:24:11,760
provider an enable site provider is

879
00:24:10,559 --> 00:24:12,720
going to be in this case specifically

880
00:24:11,760 --> 00:24:15,440
windows defender

881
00:24:12,720 --> 00:24:16,159
so amsi is going to submit to the amsi

882
00:24:15,440 --> 00:24:18,480
provider

883
00:24:16,159 --> 00:24:19,919
the string that i am trying to execute

884
00:24:18,480 --> 00:24:21,760
on that system itself

885
00:24:19,919 --> 00:24:23,600
um and so it's going to come back saying

886
00:24:21,760 --> 00:24:24,400
hey antivirus detected this because they

887
00:24:23,600 --> 00:24:26,240
wrote a

888
00:24:24,400 --> 00:24:27,600
signature but we'll see how easy it is

889
00:24:26,240 --> 00:24:29,760
to get around

890
00:24:27,600 --> 00:24:32,959
that signature in the first place here

891
00:24:29,760 --> 00:24:36,400
so we'll go ahead and copy this

892
00:24:32,960 --> 00:24:36,400
and we'll move it over to the other side

893
00:24:39,679 --> 00:24:43,440
and then we're going to hit play we're

894
00:24:41,679 --> 00:24:46,640
going to create a um

895
00:24:43,440 --> 00:24:48,559
a listener first so we can catch the the

896
00:24:46,640 --> 00:24:49,919
shell when we hit it but we hit play

897
00:24:48,559 --> 00:24:50,559
notice here it says uh the script

898
00:24:49,919 --> 00:24:52,400
contains

899
00:24:50,559 --> 00:24:53,520
um malicious content has been blocked so

900
00:24:52,400 --> 00:24:54,799
we're gonna do is i'm gonna try to chunk

901
00:24:53,520 --> 00:24:56,000
this up a little bit to figure out what

902
00:24:54,799 --> 00:24:57,679
parts actually getting detected so i'm

903
00:24:56,000 --> 00:25:00,080
just gonna delete this last line here

904
00:24:57,679 --> 00:25:01,520
gonna cut it out hit play and notice we

905
00:25:00,080 --> 00:25:02,799
don't get that that same error message

906
00:25:01,520 --> 00:25:04,480
before which means that there's

907
00:25:02,799 --> 00:25:06,000
a signature right in this specific line

908
00:25:04,480 --> 00:25:06,880
here that's getting caught so what we're

909
00:25:06,000 --> 00:25:09,360
gonna do instead is we're just gonna

910
00:25:06,880 --> 00:25:10,559
chunk this line up to say a equals

911
00:25:09,360 --> 00:25:12,719
and we're gonna take the second part of

912
00:25:10,559 --> 00:25:13,918
the the code uh which is

913
00:25:12,720 --> 00:25:15,760
invoke expression and we're just going

914
00:25:13,919 --> 00:25:17,679
to substitute it in for a for a variable

915
00:25:15,760 --> 00:25:19,760
a and then we're going to play again

916
00:25:17,679 --> 00:25:21,679
and we completely get around um d

917
00:25:19,760 --> 00:25:22,960
detection for that specific area so

918
00:25:21,679 --> 00:25:24,799
he's got to kind of play with it right

919
00:25:22,960 --> 00:25:26,720
um i have an automated tool that

920
00:25:24,799 --> 00:25:29,039
automatically goes through and submits

921
00:25:26,720 --> 00:25:31,679
on behalf of amsi scan

922
00:25:29,039 --> 00:25:33,600
scan string um to tell whether or not my

923
00:25:31,679 --> 00:25:35,279
code is actually being detected

924
00:25:33,600 --> 00:25:37,039
um by a specific piece and it chunks it

925
00:25:35,279 --> 00:25:38,559
up into places it knows the interpretive

926
00:25:37,039 --> 00:25:40,480
language of powershell

927
00:25:38,559 --> 00:25:41,840
and it chunks it up into a place to find

928
00:25:40,480 --> 00:25:42,640
exactly where that signature is being

929
00:25:41,840 --> 00:25:44,480
flagged at

930
00:25:42,640 --> 00:25:46,080
and then it'll it'll either a if it

931
00:25:44,480 --> 00:25:47,840
knows how to it automatically rewrite it

932
00:25:46,080 --> 00:25:49,279
for me with obfuscation just and then

933
00:25:47,840 --> 00:25:49,840
submit it again to see if it gets past

934
00:25:49,279 --> 00:25:52,080
it

935
00:25:49,840 --> 00:25:53,918
um or b um it'll tell me exactly where i

936
00:25:52,080 --> 00:25:55,120
need to uh go in order to rewrite my

937
00:25:53,919 --> 00:25:56,320
code to get around it so it just takes a

938
00:25:55,120 --> 00:25:58,000
couple of seconds

939
00:25:56,320 --> 00:26:00,080
to get around whenever they release a

940
00:25:58,000 --> 00:26:02,480
new signature for the code

941
00:26:00,080 --> 00:26:03,120
itself so you know trivial to get around

942
00:26:02,480 --> 00:26:05,919
from a

943
00:26:03,120 --> 00:26:07,760
attack service perspective so most

944
00:26:05,919 --> 00:26:09,039
organizations rely heavily

945
00:26:07,760 --> 00:26:11,200
off of their products and tooling

946
00:26:09,039 --> 00:26:12,960
whether it's an edr whether it's a

947
00:26:11,200 --> 00:26:14,480
next-gen firewall whether it's their

948
00:26:12,960 --> 00:26:17,200
monitoring detection from from an

949
00:26:14,480 --> 00:26:18,320
um from a sim perspective but most

950
00:26:17,200 --> 00:26:20,640
organizations

951
00:26:18,320 --> 00:26:21,840
don't enhance their security products as

952
00:26:20,640 --> 00:26:23,840
they implement i'm not saying having an

953
00:26:21,840 --> 00:26:25,279
edr is bad or having a sim is bad those

954
00:26:23,840 --> 00:26:26,799
are all great things you want visibility

955
00:26:25,279 --> 00:26:29,520
into your infrastructure

956
00:26:26,799 --> 00:26:31,440
but relying upon them to be your sole

957
00:26:29,520 --> 00:26:33,279
front of the detection is a really

958
00:26:31,440 --> 00:26:34,720
critical area that most organizations

959
00:26:33,279 --> 00:26:35,840
fail at because it's so easy to get

960
00:26:34,720 --> 00:26:37,919
around

961
00:26:35,840 --> 00:26:40,158
these specific products and so you look

962
00:26:37,919 --> 00:26:41,360
at things like like edr products right

963
00:26:40,159 --> 00:26:43,520
we as attackers going into

964
00:26:41,360 --> 00:26:45,360
infrastructure know you know what your

965
00:26:43,520 --> 00:26:47,120
edr product flags and doesn't flag on

966
00:26:45,360 --> 00:26:48,158
we're not stupid we test this out well

967
00:26:47,120 --> 00:26:51,439
ahead of time

968
00:26:48,159 --> 00:26:52,080
and um i think it was um it was hexa um

969
00:26:51,440 --> 00:26:55,279
adam

970
00:26:52,080 --> 00:26:57,600
um just recently um uh hexagon um

971
00:26:55,279 --> 00:26:59,279
sorry if i butchered the the name um but

972
00:26:57,600 --> 00:27:01,678
uh he recently said you know if

973
00:26:59,279 --> 00:27:02,960
if any of those products were public in

974
00:27:01,679 --> 00:27:03,760
nature where you could download free

975
00:27:02,960 --> 00:27:05,440
trials

976
00:27:03,760 --> 00:27:07,120
um they would be completely destroyed

977
00:27:05,440 --> 00:27:08,080
within you know two or three weeks just

978
00:27:07,120 --> 00:27:09,918
just based on

979
00:27:08,080 --> 00:27:12,158
how how big the gaps are within their

980
00:27:09,919 --> 00:27:12,960
environment and um that that's a hundred

981
00:27:12,159 --> 00:27:14,720
percent true

982
00:27:12,960 --> 00:27:16,240
i mean uh you you couldn't you couldn't

983
00:27:14,720 --> 00:27:17,600
have said it any better

984
00:27:16,240 --> 00:27:19,200
these products are you know the reason

985
00:27:17,600 --> 00:27:20,240
why they are they have been somewhat

986
00:27:19,200 --> 00:27:23,039
effective

987
00:27:20,240 --> 00:27:24,480
um and what hexachord was saying you

988
00:27:23,039 --> 00:27:25,600
know on that specific area is that you

989
00:27:24,480 --> 00:27:27,279
know it's because they're not widely

990
00:27:25,600 --> 00:27:28,158
public to security researchers or

991
00:27:27,279 --> 00:27:29,279
attackers

992
00:27:28,159 --> 00:27:30,399
so you have to figure out a way of

993
00:27:29,279 --> 00:27:32,159
getting them to test them out but that's

994
00:27:30,399 --> 00:27:33,760
the only thing is just kind of tripping

995
00:27:32,159 --> 00:27:35,039
on landmines and figuring things out

996
00:27:33,760 --> 00:27:37,200
versus actually building

997
00:27:35,039 --> 00:27:38,158
detection criteria um in your overall

998
00:27:37,200 --> 00:27:40,159
environment so

999
00:27:38,159 --> 00:27:42,159
again most organizations are still at a

1000
00:27:40,159 --> 00:27:44,080
very much a basic level

1001
00:27:42,159 --> 00:27:45,440
and you know some are further along than

1002
00:27:44,080 --> 00:27:47,439
others which is a great thing

1003
00:27:45,440 --> 00:27:48,559
those are folks that that focus on

1004
00:27:47,440 --> 00:27:50,080
understanding

1005
00:27:48,559 --> 00:27:51,840
what attackers are doing and i'll get

1006
00:27:50,080 --> 00:27:53,678
into that in just a second

1007
00:27:51,840 --> 00:27:55,360
so that's that's the main problem right

1008
00:27:53,679 --> 00:27:57,520
the problem is is that we don't look

1009
00:27:55,360 --> 00:27:59,439
at what our adversaries are doing we

1010
00:27:57,520 --> 00:28:01,520
don't look at what our threat models are

1011
00:27:59,440 --> 00:28:03,200
and we don't prioritize our security

1012
00:28:01,520 --> 00:28:05,600
program to to

1013
00:28:03,200 --> 00:28:07,279
to incorporate those specific input

1014
00:28:05,600 --> 00:28:08,158
items to build our security program in

1015
00:28:07,279 --> 00:28:10,720
the first place

1016
00:28:08,159 --> 00:28:12,720
our strategies are all focused on the

1017
00:28:10,720 --> 00:28:13,200
wrong areas our strategies are focused

1018
00:28:12,720 --> 00:28:14,960
on

1019
00:28:13,200 --> 00:28:16,720
all of the things that that we

1020
00:28:14,960 --> 00:28:18,559
hypothetically want to do

1021
00:28:16,720 --> 00:28:20,480
from a strategic roadmap perspective

1022
00:28:18,559 --> 00:28:23,039
over the next three years we want to

1023
00:28:20,480 --> 00:28:25,120
implement uh you know network access

1024
00:28:23,039 --> 00:28:26,960
control we want to resegment our network

1025
00:28:25,120 --> 00:28:28,320
those are all great things to aspire to

1026
00:28:26,960 --> 00:28:30,480
100 you shouldn't

1027
00:28:28,320 --> 00:28:32,158
not do that but it's going to take time

1028
00:28:30,480 --> 00:28:34,159
and effort so how do you keep

1029
00:28:32,159 --> 00:28:36,559
your security program that's at a basic

1030
00:28:34,159 --> 00:28:38,080
level in a way that you can minimize the

1031
00:28:36,559 --> 00:28:38,720
damage towards your organization until

1032
00:28:38,080 --> 00:28:40,720
you can get

1033
00:28:38,720 --> 00:28:42,320
all those things in place and so it's

1034
00:28:40,720 --> 00:28:44,559
that balancing act of having the

1035
00:28:42,320 --> 00:28:46,080
visibility and detection and making sure

1036
00:28:44,559 --> 00:28:47,279
that you can focus on your strategy at

1037
00:28:46,080 --> 00:28:48,639
the same time

1038
00:28:47,279 --> 00:28:50,880
and that really comes down to to

1039
00:28:48,640 --> 00:28:52,159
leveraging red when we talk about

1040
00:28:50,880 --> 00:28:53,919
leveraging red

1041
00:28:52,159 --> 00:28:55,279
when we talk about that specific

1042
00:28:53,919 --> 00:28:57,760
component there it's

1043
00:28:55,279 --> 00:28:59,360
it's understanding what red is doing

1044
00:28:57,760 --> 00:29:01,200
understanding what your adversaries are

1045
00:28:59,360 --> 00:29:02,639
doing right and i said that a lot

1046
00:29:01,200 --> 00:29:04,799
but most people don't look at that they

1047
00:29:02,640 --> 00:29:05,279
don't look at specific apt groups or you

1048
00:29:04,799 --> 00:29:06,960
know

1049
00:29:05,279 --> 00:29:08,399
insect specific type type you know

1050
00:29:06,960 --> 00:29:10,000
groups that are focusing on their

1051
00:29:08,399 --> 00:29:11,600
specific industry vertical

1052
00:29:10,000 --> 00:29:13,440
we looked very specifically off of well

1053
00:29:11,600 --> 00:29:14,559
hey we just got this new feed in we're

1054
00:29:13,440 --> 00:29:15,840
going to throw this feed into our tool

1055
00:29:14,559 --> 00:29:17,600
automatically and hopefully it detects

1056
00:29:15,840 --> 00:29:18,959
you know a specific hash or

1057
00:29:17,600 --> 00:29:20,000
you know a specific command and control

1058
00:29:18,960 --> 00:29:21,520
that's out there today we're going to

1059
00:29:20,000 --> 00:29:21,919
try to automate as much as possible so

1060
00:29:21,520 --> 00:29:23,440
that

1061
00:29:21,919 --> 00:29:24,720
you know we don't have to worry about it

1062
00:29:23,440 --> 00:29:25,679
unfortunately it takes a lot of hard

1063
00:29:24,720 --> 00:29:28,159
work and effort

1064
00:29:25,679 --> 00:29:29,520
and miter attack is a great example of a

1065
00:29:28,159 --> 00:29:31,120
good starting point because

1066
00:29:29,520 --> 00:29:33,360
with miter attack you don't have to do

1067
00:29:31,120 --> 00:29:36,000
all of the thousands of techniques

1068
00:29:33,360 --> 00:29:36,719
you can focus on the specific adversary

1069
00:29:36,000 --> 00:29:38,799
groups that are

1070
00:29:36,720 --> 00:29:40,399
in your industry vertical break down

1071
00:29:38,799 --> 00:29:42,720
those tactics and procedures

1072
00:29:40,399 --> 00:29:44,479
and start to build good detections now

1073
00:29:42,720 --> 00:29:45,039
let's just go back a second really quick

1074
00:29:44,480 --> 00:29:48,559
to

1075
00:29:45,039 --> 00:29:50,720
before is a good detection

1076
00:29:48,559 --> 00:29:52,720
for this specific attack looking for

1077
00:29:50,720 --> 00:29:55,440
regis qr32 with a slash i

1078
00:29:52,720 --> 00:29:56,880
and an hdp in it i.e what windows

1079
00:29:55,440 --> 00:29:58,480
defender is doing

1080
00:29:56,880 --> 00:29:59,840
the answer to that is no that is not a

1081
00:29:58,480 --> 00:30:00,320
good detection because we can get around

1082
00:29:59,840 --> 00:30:02,240
that

1083
00:30:00,320 --> 00:30:04,080
but what would be a good detection for

1084
00:30:02,240 --> 00:30:05,919
regis sphere 32 how about looking at

1085
00:30:04,080 --> 00:30:07,600
your entire environment

1086
00:30:05,919 --> 00:30:08,960
and seeing if you ever have seen a

1087
00:30:07,600 --> 00:30:10,639
process creation

1088
00:30:08,960 --> 00:30:12,000
for a regis vr 32 in your environment

1089
00:30:10,640 --> 00:30:14,480
from a regular user

1090
00:30:12,000 --> 00:30:17,360
i guarantee you the answer to that is no

1091
00:30:14,480 --> 00:30:20,720
so instead of focusing on a command line

1092
00:30:17,360 --> 00:30:21,600
um argument why not focus on registry

1093
00:30:20,720 --> 00:30:23,200
r32

1094
00:30:21,600 --> 00:30:25,199
ever being executed in the first place

1095
00:30:23,200 --> 00:30:26,399
or registry r32

1096
00:30:25,200 --> 00:30:28,640
ever going out to the internet in the

1097
00:30:26,399 --> 00:30:29,760
first place registrar 32 with network

1098
00:30:28,640 --> 00:30:32,480
communications

1099
00:30:29,760 --> 00:30:33,919
that is a good detection a bad detection

1100
00:30:32,480 --> 00:30:34,559
is what we see here because we have to

1101
00:30:33,919 --> 00:30:36,640
baseline

1102
00:30:34,559 --> 00:30:37,678
environments and again edr products and

1103
00:30:36,640 --> 00:30:39,760
antivirus products

1104
00:30:37,679 --> 00:30:41,279
focus very heavily on multitude of

1105
00:30:39,760 --> 00:30:42,240
organizations and corporations as they

1106
00:30:41,279 --> 00:30:43,840
go through

1107
00:30:42,240 --> 00:30:47,440
we don't have a good detection if we

1108
00:30:43,840 --> 00:30:49,360
just focus um solely on that

1109
00:30:47,440 --> 00:30:50,640
and and the way that you can you can

1110
00:30:49,360 --> 00:30:52,320
definitely approach this and start to

1111
00:30:50,640 --> 00:30:53,039
build it down is is by leveraging purple

1112
00:30:52,320 --> 00:30:54,799
teams

1113
00:30:53,039 --> 00:30:56,720
um or or just having somebody that

1114
00:30:54,799 --> 00:30:57,918
understands offense and working on

1115
00:30:56,720 --> 00:30:59,039
building the detections based off of

1116
00:30:57,919 --> 00:31:00,080
that and if you look at something they

1117
00:30:59,039 --> 00:31:02,000
might attack

1118
00:31:00,080 --> 00:31:04,639
um there's a blog that we did recently

1119
00:31:02,000 --> 00:31:05,200
on the top 10 most used miter attacks

1120
00:31:04,640 --> 00:31:06,480
that are

1121
00:31:05,200 --> 00:31:08,559
attack techniques that are out there

1122
00:31:06,480 --> 00:31:09,760
today that's a great starting point also

1123
00:31:08,559 --> 00:31:10,720
going through ones that you know that

1124
00:31:09,760 --> 00:31:12,158
you've heard of before because it's

1125
00:31:10,720 --> 00:31:13,519
probably relevant to your environment

1126
00:31:12,159 --> 00:31:14,960
and then start taking adversaries and

1127
00:31:13,519 --> 00:31:15,519
start prioritizing them hey these are

1128
00:31:14,960 --> 00:31:17,200
the

1129
00:31:15,519 --> 00:31:19,679
top 50 that we want to implement in our

1130
00:31:17,200 --> 00:31:22,640
organization that's a great step

1131
00:31:19,679 --> 00:31:23,360
of the top 50 attack techniques that are

1132
00:31:22,640 --> 00:31:24,720
out there

1133
00:31:23,360 --> 00:31:26,000
and ways that we can detect them in our

1134
00:31:24,720 --> 00:31:27,279
environment and getting better with

1135
00:31:26,000 --> 00:31:29,760
those detections right

1136
00:31:27,279 --> 00:31:31,360
um starting to whittle away that way

1137
00:31:29,760 --> 00:31:32,559
makes a big difference

1138
00:31:31,360 --> 00:31:35,039
in what you're trying to accomplish in

1139
00:31:32,559 --> 00:31:37,279
your mind detection program

1140
00:31:35,039 --> 00:31:39,679
and it really comes down to we we have a

1141
00:31:37,279 --> 00:31:40,799
a lack of detection in organizations i

1142
00:31:39,679 --> 00:31:42,960
can't tell you

1143
00:31:40,799 --> 00:31:45,679
how many times you know i go into an

1144
00:31:42,960 --> 00:31:47,679
organization as long as i don't trip

1145
00:31:45,679 --> 00:31:49,440
trigger their their signature base

1146
00:31:47,679 --> 00:31:50,320
detection i'm usually fine or even if i

1147
00:31:49,440 --> 00:31:52,480
do there's a

1148
00:31:50,320 --> 00:31:53,678
i did a talk last year um at wild west

1149
00:31:52,480 --> 00:31:56,880
hacking fest where

1150
00:31:53,679 --> 00:31:58,960
i started um messing with with security

1151
00:31:56,880 --> 00:32:01,679
analysts uh sock analysts

1152
00:31:58,960 --> 00:32:03,200
and knowing that that my my attack was

1153
00:32:01,679 --> 00:32:04,559
going to be detected how do i tell a

1154
00:32:03,200 --> 00:32:06,399
different story

1155
00:32:04,559 --> 00:32:07,760
um to the security operations center

1156
00:32:06,399 --> 00:32:09,678
that i'm going after

1157
00:32:07,760 --> 00:32:11,120
and the way that it did that was i would

1158
00:32:09,679 --> 00:32:11,840
take my malicious code that would get

1159
00:32:11,120 --> 00:32:14,000
picked up by

1160
00:32:11,840 --> 00:32:16,158
an edr product or antivirus or whatever

1161
00:32:14,000 --> 00:32:17,600
ends up being not antivirus specifically

1162
00:32:16,159 --> 00:32:19,360
um but their monitor detection program

1163
00:32:17,600 --> 00:32:22,080
and would definitely send an alarm

1164
00:32:19,360 --> 00:32:22,559
to a sock analyst and i'd wrap it in a

1165
00:32:22,080 --> 00:32:24,080
huge

1166
00:32:22,559 --> 00:32:25,760
massive script so like for example let's

1167
00:32:24,080 --> 00:32:27,120
just say i was using magic unicorn that

1168
00:32:25,760 --> 00:32:28,640
does shell coat injection

1169
00:32:27,120 --> 00:32:30,639
directly into memory through the

1170
00:32:28,640 --> 00:32:32,320
powershell process obviously malicious

1171
00:32:30,640 --> 00:32:33,200
if you saw obfuscated code coming across

1172
00:32:32,320 --> 00:32:35,360
your screen

1173
00:32:33,200 --> 00:32:37,519
what i did is i took a large microsoft

1174
00:32:35,360 --> 00:32:38,639
script uh powershell script and i tucked

1175
00:32:37,519 --> 00:32:40,240
my powershell

1176
00:32:38,640 --> 00:32:41,919
malicious powershell code halfway

1177
00:32:40,240 --> 00:32:43,039
through that script and guess what

1178
00:32:41,919 --> 00:32:44,799
happened

1179
00:32:43,039 --> 00:32:45,840
yep that flag does a false positive

1180
00:32:44,799 --> 00:32:47,360
right because they're not going to go

1181
00:32:45,840 --> 00:32:48,480
through thousands of lines of powershell

1182
00:32:47,360 --> 00:32:49,760
code they're like well this is a

1183
00:32:48,480 --> 00:32:51,600
this looks like a good script and a lot

1184
00:32:49,760 --> 00:32:52,879
of times what i'll even do from an

1185
00:32:51,600 --> 00:32:55,120
attacker's perspective

1186
00:32:52,880 --> 00:32:57,039
is i'll do osint on linkedin and find

1187
00:32:55,120 --> 00:32:58,399
like server admins or people within

1188
00:32:57,039 --> 00:33:00,320
their own organization

1189
00:32:58,399 --> 00:33:01,678
and i'll put like comment code in there

1190
00:33:00,320 --> 00:33:02,879
from that specific person that actually

1191
00:33:01,679 --> 00:33:04,159
works at that company

1192
00:33:02,880 --> 00:33:05,600
saying hey this is you know a script

1193
00:33:04,159 --> 00:33:07,039
that i'm using for blah blah blah if you

1194
00:33:05,600 --> 00:33:08,559
need any help just email me and i'll put

1195
00:33:07,039 --> 00:33:10,480
the email address in there

1196
00:33:08,559 --> 00:33:11,678
so for stock analysts it's like oh this

1197
00:33:10,480 --> 00:33:13,039
is this is bob

1198
00:33:11,679 --> 00:33:14,480
you know i know bob i work with bob

1199
00:33:13,039 --> 00:33:15,840
every day he's just using the script to

1200
00:33:14,480 --> 00:33:16,240
do some stuff cool we're all set i'm

1201
00:33:15,840 --> 00:33:18,399
just gonna

1202
00:33:16,240 --> 00:33:19,679
mark this as a false positive so we have

1203
00:33:18,399 --> 00:33:20,399
even larger challenges there i'm not

1204
00:33:19,679 --> 00:33:21,600
gonna go into

1205
00:33:20,399 --> 00:33:23,600
that part because that's that's the

1206
00:33:21,600 --> 00:33:25,279
human piece of it um

1207
00:33:23,600 --> 00:33:26,399
but you know the the piece that we're

1208
00:33:25,279 --> 00:33:27,760
lacking is that the priority and the

1209
00:33:26,399 --> 00:33:30,158
strategy around that

1210
00:33:27,760 --> 00:33:31,120
and really having a good understanding

1211
00:33:30,159 --> 00:33:33,279
um around

1212
00:33:31,120 --> 00:33:35,360
offense um and what your offense is

1213
00:33:33,279 --> 00:33:36,480
doing makes a good defense now i put the

1214
00:33:35,360 --> 00:33:37,360
cleveland browns in here because i'm

1215
00:33:36,480 --> 00:33:38,960
from cleveland

1216
00:33:37,360 --> 00:33:40,639
uh it's been an interesting season ever

1217
00:33:38,960 --> 00:33:42,240
each and every year but hey we're up uh

1218
00:33:40,640 --> 00:33:43,679
2-1 right now so that's a good that's a

1219
00:33:42,240 --> 00:33:45,039
good thing uh we've actually had we

1220
00:33:43,679 --> 00:33:46,799
actually have more victories

1221
00:33:45,039 --> 00:33:48,480
i think it's the first time we've had

1222
00:33:46,799 --> 00:33:49,918
two consecutive victories since like

1223
00:33:48,480 --> 00:33:50,399
seven years ago or something like that

1224
00:33:49,919 --> 00:33:51,840
which is

1225
00:33:50,399 --> 00:33:53,360
which has never happened uh we had a

1226
00:33:51,840 --> 00:33:54,879
perfect season one year we lost every

1227
00:33:53,360 --> 00:33:55,760
single game the whole the whole season

1228
00:33:54,880 --> 00:33:58,000
so we

1229
00:33:55,760 --> 00:33:59,360
you know maybe using this as a reference

1230
00:33:58,000 --> 00:34:01,279
isn't a good understanding because they

1231
00:33:59,360 --> 00:34:04,320
they can't figure out offense or defense

1232
00:34:01,279 --> 00:34:05,519
um but sports aside um

1233
00:34:04,320 --> 00:34:06,960
you know having a good understanding

1234
00:34:05,519 --> 00:34:08,320
around what your offense is doing helps

1235
00:34:06,960 --> 00:34:09,918
you build that better defense and

1236
00:34:08,320 --> 00:34:11,679
and that collaboration approach of

1237
00:34:09,918 --> 00:34:13,118
really working back and forth

1238
00:34:11,679 --> 00:34:15,119
um definitely makes it makes a big

1239
00:34:13,119 --> 00:34:17,200
difference overall

1240
00:34:15,119 --> 00:34:19,200
when we talk about um threat models

1241
00:34:17,199 --> 00:34:21,118
right and i've mentioned this

1242
00:34:19,199 --> 00:34:23,759
a number of different times but if

1243
00:34:21,119 --> 00:34:25,200
you're not prioritizing your detections

1244
00:34:23,760 --> 00:34:27,280
in how you're looking at maturing your

1245
00:34:25,199 --> 00:34:28,000
sock what what has happened is is that

1246
00:34:27,280 --> 00:34:30,079
we

1247
00:34:28,000 --> 00:34:31,760
what should be happening from a cyclical

1248
00:34:30,079 --> 00:34:32,800
effect from a security operation center

1249
00:34:31,760 --> 00:34:34,480
perspective

1250
00:34:32,800 --> 00:34:36,000
is that you have your sock analysts and

1251
00:34:34,480 --> 00:34:37,839
those sake analysts should be

1252
00:34:36,000 --> 00:34:39,199
less focused on the day in and day out

1253
00:34:37,839 --> 00:34:41,279
alarms

1254
00:34:39,199 --> 00:34:42,399
and i don't think you should remove the

1255
00:34:41,280 --> 00:34:43,839
ability for that but they should be

1256
00:34:42,399 --> 00:34:45,199
focusing on more of that

1257
00:34:43,839 --> 00:34:47,119
what we call the long tail if you're

1258
00:34:45,199 --> 00:34:47,678
familiar with the long tail concept

1259
00:34:47,119 --> 00:34:49,280
where

1260
00:34:47,679 --> 00:34:51,200
you have your your high volume stuff

1261
00:34:49,280 --> 00:34:52,879
that's up here and then as you start to

1262
00:34:51,199 --> 00:34:54,719
get down more and look at the unusual

1263
00:34:52,879 --> 00:34:55,759
things that are happening in the tail of

1264
00:34:54,719 --> 00:34:58,319
an attack

1265
00:34:55,760 --> 00:34:58,800
those are the the uh unusual indicators

1266
00:34:58,320 --> 00:35:00,720
that

1267
00:34:58,800 --> 00:35:02,079
are things that we should definitely

1268
00:35:00,720 --> 00:35:03,759
focus in there so

1269
00:35:02,079 --> 00:35:05,040
all of those things are our pieces that

1270
00:35:03,760 --> 00:35:07,280
we need to focus on from an attack

1271
00:35:05,040 --> 00:35:09,440
service perspective and start to build

1272
00:35:07,280 --> 00:35:10,800
um our detections around there now at

1273
00:35:09,440 --> 00:35:11,359
the same time you should have proactive

1274
00:35:10,800 --> 00:35:12,400
people

1275
00:35:11,359 --> 00:35:13,598
looking through your data looking

1276
00:35:12,400 --> 00:35:14,880
through your logs trying to understand

1277
00:35:13,599 --> 00:35:16,400
what's actually happening

1278
00:35:14,880 --> 00:35:18,079
uh to build all of those out and the

1279
00:35:16,400 --> 00:35:19,599
cyclical effect starts to occur

1280
00:35:18,079 --> 00:35:20,800
as you start to build those in and start

1281
00:35:19,599 --> 00:35:22,000
testing it from a purple teaming

1282
00:35:20,800 --> 00:35:24,000
perspective or more of an

1283
00:35:22,000 --> 00:35:25,200
offensive capabilities perspective and

1284
00:35:24,000 --> 00:35:26,160
enhancing your detection so again

1285
00:35:25,200 --> 00:35:27,598
continual

1286
00:35:26,160 --> 00:35:30,960
improvement of your security operation

1287
00:35:27,599 --> 00:35:33,760
center as you go along

1288
00:35:30,960 --> 00:35:34,880
um when you talk about prioritization

1289
00:35:33,760 --> 00:35:36,320
you know we have two

1290
00:35:34,880 --> 00:35:38,240
strategies right you want to have your

1291
00:35:36,320 --> 00:35:41,440
your long-term strategy

1292
00:35:38,240 --> 00:35:43,439
of of building out um your

1293
00:35:41,440 --> 00:35:44,640
your security program your strategic you

1294
00:35:43,440 --> 00:35:45,359
know portions whether that's network

1295
00:35:44,640 --> 00:35:47,680
segmentation

1296
00:35:45,359 --> 00:35:49,440
patch management volume management etc

1297
00:35:47,680 --> 00:35:50,879
you also want to have that stop gap of

1298
00:35:49,440 --> 00:35:52,000
things that are coming out new new

1299
00:35:50,880 --> 00:35:53,440
attacks that are coming out

1300
00:35:52,000 --> 00:35:54,960
things that are being actively exploited

1301
00:35:53,440 --> 00:35:56,880
in the environment being able to have

1302
00:35:54,960 --> 00:35:58,240
that stop gap to reduce that dwell time

1303
00:35:56,880 --> 00:36:00,960
that an attacker has

1304
00:35:58,240 --> 00:36:01,439
in your environment um some basics that

1305
00:36:00,960 --> 00:36:03,040
work

1306
00:36:01,440 --> 00:36:05,119
uh well in the preventative side you

1307
00:36:03,040 --> 00:36:06,880
know disallowing unsigned executables

1308
00:36:05,119 --> 00:36:08,400
within user profile directories

1309
00:36:06,880 --> 00:36:10,160
uh things like constrained language mode

1310
00:36:08,400 --> 00:36:12,000
within powershell

1311
00:36:10,160 --> 00:36:14,160
you know going to powershell version six

1312
00:36:12,000 --> 00:36:16,480
and disallowing powershell version two

1313
00:36:14,160 --> 00:36:17,920
um cismod i'm a huge fan of um using

1314
00:36:16,480 --> 00:36:19,440
kernel level event log tracing for

1315
00:36:17,920 --> 00:36:21,599
windows which is a free tool from mark

1316
00:36:19,440 --> 00:36:24,640
rusenovich's team over at microsoft

1317
00:36:21,599 --> 00:36:26,480
um great configurable option and olaf

1318
00:36:24,640 --> 00:36:28,879
hardong has um

1319
00:36:26,480 --> 00:36:30,560
has added a sysmon modular uh which

1320
00:36:28,880 --> 00:36:32,240
allows you to get a pretty extensive

1321
00:36:30,560 --> 00:36:33,040
amount of coverage with the miter attack

1322
00:36:32,240 --> 00:36:35,200
framework

1323
00:36:33,040 --> 00:36:37,200
um just enabling your windows firewall

1324
00:36:35,200 --> 00:36:38,319
um will stop lateral movement internally

1325
00:36:37,200 --> 00:36:39,598
especially if those firewalls can't

1326
00:36:38,320 --> 00:36:40,800
communicate with one another

1327
00:36:39,599 --> 00:36:42,880
you can't move from one system to the

1328
00:36:40,800 --> 00:36:44,480
next that's a great thing

1329
00:36:42,880 --> 00:36:46,000
uh you have to have endpoint logs today

1330
00:36:44,480 --> 00:36:48,160
that that's that's a must if you're not

1331
00:36:46,000 --> 00:36:50,240
doing that you're really far behind

1332
00:36:48,160 --> 00:36:51,520
um not just north to south traffic but

1333
00:36:50,240 --> 00:36:53,598
also east the west

1334
00:36:51,520 --> 00:36:55,599
improving on your visibility um and

1335
00:36:53,599 --> 00:36:58,480
focusing on on threat hunting and what

1336
00:36:55,599 --> 00:36:59,920
uh specific attackers are doing and i

1337
00:36:58,480 --> 00:37:01,760
just want to repeat one more time

1338
00:36:59,920 --> 00:37:03,040
before i close it off and open up to

1339
00:37:01,760 --> 00:37:04,800
some questions here but

1340
00:37:03,040 --> 00:37:06,560
you know you have to baseline your

1341
00:37:04,800 --> 00:37:07,680
environment and detect off of that right

1342
00:37:06,560 --> 00:37:08,960
understanding behavior in your

1343
00:37:07,680 --> 00:37:10,879
environment and that's going to show up

1344
00:37:08,960 --> 00:37:12,480
false positives a good example is

1345
00:37:10,880 --> 00:37:14,000
a good detection of a powershell isn't

1346
00:37:12,480 --> 00:37:16,240
looking for encoded command or kernel

1347
00:37:14,000 --> 00:37:17,359
32.dll or invoke expression

1348
00:37:16,240 --> 00:37:19,279
that's that's going to get you some high

1349
00:37:17,359 --> 00:37:20,560
commodity stuff but looking for whatever

1350
00:37:19,280 --> 00:37:21,119
powershell is communicating out to the

1351
00:37:20,560 --> 00:37:22,960
internet

1352
00:37:21,119 --> 00:37:24,079
that's going to be a false positive

1353
00:37:22,960 --> 00:37:25,119
nightmare at first because you're going

1354
00:37:24,079 --> 00:37:26,800
to have to baseline

1355
00:37:25,119 --> 00:37:28,320
and look for deviations those baselines

1356
00:37:26,800 --> 00:37:29,599
as you go along um

1357
00:37:28,320 --> 00:37:31,359
but as you start to whittle those

1358
00:37:29,599 --> 00:37:32,400
through you start to see less and less

1359
00:37:31,359 --> 00:37:33,680
and less of those and

1360
00:37:32,400 --> 00:37:35,200
now you can start to actually look for

1361
00:37:33,680 --> 00:37:36,000
unusual activity in your environment

1362
00:37:35,200 --> 00:37:39,040
originating in the first

1363
00:37:36,000 --> 00:37:39,839
place uh here's a blog post that we did

1364
00:37:39,040 --> 00:37:41,680
um if you just go

1365
00:37:39,839 --> 00:37:43,759
look up trusted tech top ten minor

1366
00:37:41,680 --> 00:37:45,040
techniques um you can find uh the

1367
00:37:43,760 --> 00:37:46,880
specific top tens there

1368
00:37:45,040 --> 00:37:48,640
um for you happy to you know share the

1369
00:37:46,880 --> 00:37:50,079
link or the the presentation afterwards

1370
00:37:48,640 --> 00:37:51,359
i think i linked them all in the section

1371
00:37:50,079 --> 00:37:53,920
um in the the latter stages of the

1372
00:37:51,359 --> 00:37:56,160
presentation um but closing up here i

1373
00:37:53,920 --> 00:37:58,640
want to thank everybody uh for for

1374
00:37:56,160 --> 00:38:00,319
corncon from having me um and uh for

1375
00:37:58,640 --> 00:38:01,598
putting on this this awesome conference

1376
00:38:00,320 --> 00:38:03,440
you know when it comes to

1377
00:38:01,599 --> 00:38:05,680
what we deal with today we still cannot

1378
00:38:03,440 --> 00:38:07,599
rely off of technology to automate us we

1379
00:38:05,680 --> 00:38:08,960
have to focus on people first

1380
00:38:07,599 --> 00:38:10,560
educating people educating our

1381
00:38:08,960 --> 00:38:11,760
environment so that we can look for

1382
00:38:10,560 --> 00:38:13,520
unusual behavior

1383
00:38:11,760 --> 00:38:15,599
um as things going on that comes from

1384
00:38:13,520 --> 00:38:17,680
understanding what attackers are doing

1385
00:38:15,599 --> 00:38:19,280
helping prioritize that in working

1386
00:38:17,680 --> 00:38:19,839
through that uh within your own

1387
00:38:19,280 --> 00:38:22,000
environment

1388
00:38:19,839 --> 00:38:24,000
um i have some other resources here um

1389
00:38:22,000 --> 00:38:26,079
you know you can go download just some

1390
00:38:24,000 --> 00:38:27,200
some good reading material um down down

1391
00:38:26,079 --> 00:38:28,400
the road i'll be happy to send these

1392
00:38:27,200 --> 00:38:30,000
slides out to anybody that wants it hit

1393
00:38:28,400 --> 00:38:31,440
me up on twitter or whatnot

1394
00:38:30,000 --> 00:38:33,200
but thank you again very much for having

1395
00:38:31,440 --> 00:38:35,599
me and uh happy to answer any questions

1396
00:38:33,200 --> 00:38:35,598
that you have

1397
00:38:37,040 --> 00:38:41,440
dave thank you so much uh looks like we

1398
00:38:39,200 --> 00:38:43,279
do have one question let me just pull it

1399
00:38:41,440 --> 00:38:45,760
up here at least

1400
00:38:43,280 --> 00:38:48,720
um it comes from nate would you estimate

1401
00:38:45,760 --> 00:38:51,760
that all the major offensive innovations

1402
00:38:48,720 --> 00:38:54,319
come from the nation state orgs and if

1403
00:38:51,760 --> 00:38:57,920
so would a cyber geneva convention

1404
00:38:54,320 --> 00:38:57,920
make the cyber world a safer place

1405
00:38:58,480 --> 00:39:02,240
i think i think i don't think a lot of

1406
00:39:00,560 --> 00:39:04,720
the innovation comes from

1407
00:39:02,240 --> 00:39:06,560
um a lot of the nation states you know

1408
00:39:04,720 --> 00:39:08,078
you look at some of the attacks um that

1409
00:39:06,560 --> 00:39:09,279
are coming out from from ransomware

1410
00:39:08,079 --> 00:39:10,720
groups um you know they're they're

1411
00:39:09,280 --> 00:39:11,920
highly sophisticated a lot of innovation

1412
00:39:10,720 --> 00:39:12,640
coming from there there was one recently

1413
00:39:11,920 --> 00:39:15,440
where um

1414
00:39:12,640 --> 00:39:16,720
it was emoted that um would

1415
00:39:15,440 --> 00:39:17,520
automatically scan your wireless

1416
00:39:16,720 --> 00:39:20,480
infrastructure

1417
00:39:17,520 --> 00:39:22,240
um to try to piggyback in and expand its

1418
00:39:20,480 --> 00:39:22,800
network communications and services too

1419
00:39:22,240 --> 00:39:24,959
so

1420
00:39:22,800 --> 00:39:26,480
you know a lot of the re i see a lot of

1421
00:39:24,960 --> 00:39:29,119
innovation comes from the

1422
00:39:26,480 --> 00:39:30,400
research industry as far as new you know

1423
00:39:29,119 --> 00:39:31,359
techniques that are happening out there

1424
00:39:30,400 --> 00:39:34,079
to try to

1425
00:39:31,359 --> 00:39:34,880
enhance and improve uh security overall

1426
00:39:34,079 --> 00:39:37,440
for a lot of them

1427
00:39:34,880 --> 00:39:38,160
um but you know nation states definitely

1428
00:39:37,440 --> 00:39:40,000
um are

1429
00:39:38,160 --> 00:39:41,279
a major concern because as soon as those

1430
00:39:40,000 --> 00:39:42,000
get discovered there's usually some

1431
00:39:41,280 --> 00:39:43,440
pretty awesome

1432
00:39:42,000 --> 00:39:45,760
secret sauce in there that's actually

1433
00:39:43,440 --> 00:39:47,440
happening um as it's going along so

1434
00:39:45,760 --> 00:39:48,800
you know i think um you know it's it's

1435
00:39:47,440 --> 00:39:50,320
all over the place where a lot of this

1436
00:39:48,800 --> 00:39:52,320
is coming off from it's it's you know

1437
00:39:50,320 --> 00:39:54,079
there's there's nation states there's

1438
00:39:52,320 --> 00:39:55,359
you know organized crime groups there's

1439
00:39:54,079 --> 00:39:56,880
researchers there

1440
00:39:55,359 --> 00:39:58,319
you know that this whole industry is is

1441
00:39:56,880 --> 00:39:59,680
exploding because technology is

1442
00:39:58,320 --> 00:40:00,640
exploding so fast so

1443
00:39:59,680 --> 00:40:02,720
i'm not sure if something like that

1444
00:40:00,640 --> 00:40:05,200
would help or not but i think um

1445
00:40:02,720 --> 00:40:06,959
you know a consortium of understanding

1446
00:40:05,200 --> 00:40:08,319
um the implications around attack

1447
00:40:06,960 --> 00:40:11,359
surfaces and being able to build your

1448
00:40:08,319 --> 00:40:13,759
defenses makes a big deal

1449
00:40:11,359 --> 00:40:15,759
great and then there is one more will

1450
00:40:13,760 --> 00:40:17,200
you be in the concord discord answering

1451
00:40:15,760 --> 00:40:19,040
questions later

1452
00:40:17,200 --> 00:40:20,480
uh unfortunately i don't have time to uh

1453
00:40:19,040 --> 00:40:21,759
to hang out in the discord but

1454
00:40:20,480 --> 00:40:24,240
maybe i can drop by a little bit later

1455
00:40:21,760 --> 00:40:25,599
tonight and my kids have uh basketball

1456
00:40:24,240 --> 00:40:27,040
practice here a little bit later so

1457
00:40:25,599 --> 00:40:28,319
apologize for that uh

1458
00:40:27,040 --> 00:40:31,040
but won't be able to make that but thank

1459
00:40:28,319 --> 00:40:32,319
you so much yeah norris thank you dave

1460
00:40:31,040 --> 00:40:35,920
that was all

1461
00:40:32,319 --> 00:40:35,920
thanks everybody take care bye

1462
00:40:36,839 --> 00:40:42,480
oh

1463
00:40:39,200 --> 00:40:45,759
sorry dramaal you uh came in before

1464
00:40:42,480 --> 00:40:49,280
and you win the chat all right

1465
00:40:45,760 --> 00:40:51,760
we're gonna be back at 11 115

1466
00:40:49,280 --> 00:40:53,920
with uh sean anderson executive security

1467
00:40:51,760 --> 00:40:56,160
advisor at microsoft

1468
00:40:53,920 --> 00:40:58,319
doing what should we trust should we

1469
00:40:56,160 --> 00:41:00,399
trust but verify or trust nothing and

1470
00:40:58,319 --> 00:41:07,839
verify everything

1471
00:41:00,400 --> 00:41:07,839
all right see you guys soon

1472
00:41:17,280 --> 00:41:19,359
you

