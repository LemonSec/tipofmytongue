1
00:00:04,840 --> 00:00:11,840
thanks a lot so welcome the reason why I

2
00:00:10,160 --> 00:00:16,490
chose to present this topic is because

3
00:00:11,840 --> 00:00:20,000
sock is like the the the thing that that

4
00:00:16,490 --> 00:00:24,759
is most being discussed on you know it's

5
00:00:20,000 --> 00:00:27,440
like a like a hot potato and basically a

6
00:00:24,760 --> 00:00:29,270
lot of talk is being it has been around

7
00:00:27,440 --> 00:00:30,619
there for you know whether we should be

8
00:00:29,270 --> 00:00:33,739
implementing a sock how we should be

9
00:00:30,619 --> 00:00:34,370
doing it why should we implement a sock

10
00:00:33,739 --> 00:00:35,989
and so on

11
00:00:34,370 --> 00:00:39,919
so I'm gonna start with the presentation

12
00:00:35,989 --> 00:00:42,440
just a bit about myself so I'm an

13
00:00:39,920 --> 00:00:45,589
independent researcher I'm going to like

14
00:00:42,440 --> 00:00:47,059
blue teaming and and BFI are I've been

15
00:00:45,589 --> 00:00:49,489
in the IT business for about 10 years

16
00:00:47,059 --> 00:00:52,578
out of those ten years for have been in

17
00:00:49,489 --> 00:00:55,608
the security field so that's enough

18
00:00:52,579 --> 00:00:58,280
about me so the agenda for today as

19
00:00:55,609 --> 00:01:02,389
mentioned we'll take a look at what is

20
00:00:58,280 --> 00:01:03,859
the sock why do we need it and then what

21
00:01:02,389 --> 00:01:05,659
the longer part of the presentation is

22
00:01:03,859 --> 00:01:07,700
going to be how do we implement it and

23
00:01:05,659 --> 00:01:14,420
or basically how do we start to

24
00:01:07,700 --> 00:01:17,480
implement a sock so what is a sock sock

25
00:01:14,420 --> 00:01:19,580
is there to basically defend information

26
00:01:17,480 --> 00:01:22,490
systems of an organelle or of an

27
00:01:19,580 --> 00:01:24,230
organization so not only to defend but

28
00:01:22,490 --> 00:01:28,369
also to monitor and assess these

29
00:01:24,230 --> 00:01:33,560
information systems and it it is

30
00:01:28,370 --> 00:01:35,780
actually if it actually you know

31
00:01:33,560 --> 00:01:38,330
comprises of people technology and

32
00:01:35,780 --> 00:01:40,850
process so we'll have a look at each one

33
00:01:38,330 --> 00:01:42,470
of those in the how-to section so we'll

34
00:01:40,850 --> 00:01:45,380
take a look at the specifics of you know

35
00:01:42,470 --> 00:01:49,908
people technology and process one by one

36
00:01:45,380 --> 00:01:52,220
you can see here a picture from this is

37
00:01:49,909 --> 00:01:55,400
the National Security Operations Center

38
00:01:52,220 --> 00:01:59,630
from 1975 so it doesn't look that much

39
00:01:55,400 --> 00:02:01,820
different today to be honest so why do

40
00:01:59,630 --> 00:02:03,289
we need a sock well basically every

41
00:02:01,820 --> 00:02:05,449
organization has something that they

42
00:02:03,290 --> 00:02:08,330
need to protect whether it be like

43
00:02:05,450 --> 00:02:10,639
intellectual property or you know

44
00:02:08,330 --> 00:02:14,209
confidential data like salaries or

45
00:02:10,639 --> 00:02:15,819
contracts or personal data which is tied

46
00:02:14,209 --> 00:02:18,040
to GDP are

47
00:02:15,819 --> 00:02:20,768
so basically you know you have something

48
00:02:18,040 --> 00:02:24,069
to protect and here we can see a couple

49
00:02:20,769 --> 00:02:25,900
of examples of companies that had

50
00:02:24,069 --> 00:02:28,179
breached that have been breached before

51
00:02:25,900 --> 00:02:32,340
like Sony which lost 100 terabytes of

52
00:02:28,180 --> 00:02:35,590
data Yahoo which lost 1 billion users

53
00:02:32,340 --> 00:02:37,420
and the latest one which is HBO they

54
00:02:35,590 --> 00:02:40,359
lost 1 point 5 terabytes of data

55
00:02:37,420 --> 00:02:43,238
including the latest episodes of Game of

56
00:02:40,359 --> 00:02:46,750
Thrones so they had obviously something

57
00:02:43,239 --> 00:02:52,060
to protect they didn't you know succeed

58
00:02:46,750 --> 00:02:55,200
that much in it so how do we start to

59
00:02:52,060 --> 00:02:57,790
implement a sock as mentioned before a

60
00:02:55,200 --> 00:02:59,589
socks a collection of people technology

61
00:02:57,790 --> 00:03:03,459
and process so we'll take a look at each

62
00:02:59,590 --> 00:03:04,900
one of those and I'll give you some

63
00:03:03,459 --> 00:03:06,459
pointers on you know what to look for

64
00:03:04,900 --> 00:03:07,510
when you're looking for people when

65
00:03:06,459 --> 00:03:09,700
you're looking for technology when

66
00:03:07,510 --> 00:03:15,370
you're implementing technology and and

67
00:03:09,700 --> 00:03:16,569
process as well so people basically

68
00:03:15,370 --> 00:03:20,650
there is you know depending on your

69
00:03:16,569 --> 00:03:22,418
organization size you will probably have

70
00:03:20,650 --> 00:03:24,669
more roles you know in a large

71
00:03:22,419 --> 00:03:27,159
organization you will have less roles in

72
00:03:24,669 --> 00:03:30,669
in a small organization but basically

73
00:03:27,159 --> 00:03:33,159
all of those roles in a sock need to

74
00:03:30,669 --> 00:03:34,629
have the right mindset so the research

75
00:03:33,159 --> 00:03:36,099
that need to have the right mindset the

76
00:03:34,629 --> 00:03:39,608
right background and the right skill set

77
00:03:36,099 --> 00:03:41,560
when we're looking at the mindset what

78
00:03:39,609 --> 00:03:43,060
it means is that they need to be you

79
00:03:41,560 --> 00:03:44,739
know the people need to be passionate

80
00:03:43,060 --> 00:03:46,810
about their job they need to be curious

81
00:03:44,739 --> 00:03:48,579
so that they are digging deeper and

82
00:03:46,810 --> 00:03:51,310
deeper searching for stuff that they

83
00:03:48,579 --> 00:03:53,970
they want to find they want to you know

84
00:03:51,310 --> 00:03:57,790
they need like a thirst for knowledge

85
00:03:53,970 --> 00:04:00,689
they need to have attention for detail

86
00:03:57,790 --> 00:04:03,909
thinking outside the box and basically

87
00:04:00,689 --> 00:04:06,668
think like the adversary so that they

88
00:04:03,909 --> 00:04:08,709
can find it when you're looking at the

89
00:04:06,669 --> 00:04:10,510
background obviously they need to have

90
00:04:08,709 --> 00:04:12,729
like networking skills and you know the

91
00:04:10,510 --> 00:04:16,269
way the networking the way that networks

92
00:04:12,729 --> 00:04:17,949
and systems operate and when we're

93
00:04:16,269 --> 00:04:20,048
looking at the skill set then we're

94
00:04:17,949 --> 00:04:22,750
looking like specific stuff you know

95
00:04:20,048 --> 00:04:25,539
operating systems so Windows Linux and

96
00:04:22,750 --> 00:04:27,450
so on we're looking at different

97
00:04:25,539 --> 00:04:28,659
protocols that they need to know about

98
00:04:27,450 --> 00:04:30,580
cryptography

99
00:04:28,660 --> 00:04:32,910
or network and security as well so how

100
00:04:30,580 --> 00:04:36,520
networking security devices operate and

101
00:04:32,910 --> 00:04:38,950
basically scripting as well which is

102
00:04:36,520 --> 00:04:42,190
like something that needs to be needs to

103
00:04:38,950 --> 00:04:44,170
be in there as well there's a very good

104
00:04:42,190 --> 00:04:45,820
book out there that you I would probably

105
00:04:44,170 --> 00:04:47,830
recommend you know I would recommend

106
00:04:45,820 --> 00:04:49,420
that you read it actually it's called

107
00:04:47,830 --> 00:04:51,550
ten strategies or world-class cyber

108
00:04:49,420 --> 00:04:54,310
security operations center and there are

109
00:04:51,550 --> 00:04:56,740
two quotes in that book which which I

110
00:04:54,310 --> 00:04:58,570
admire so the first one is that if you

111
00:04:56,740 --> 00:05:01,480
have the right tools and just one good

112
00:04:58,570 --> 00:05:03,280
analyst you will actually you know be

113
00:05:01,480 --> 00:05:06,040
more successful than having like 100

114
00:05:03,280 --> 00:05:07,869
mediocre ones and the other one is that

115
00:05:06,040 --> 00:05:12,570
you should always be looking for quality

116
00:05:07,870 --> 00:05:12,570
instant instead of quantity

117
00:05:12,780 --> 00:05:19,359
okay so where do you start

118
00:05:17,590 --> 00:05:20,979
you know if you don't have a stock if

119
00:05:19,360 --> 00:05:23,260
you don't have people in your sock you

120
00:05:20,980 --> 00:05:25,510
most likely would need to form a team of

121
00:05:23,260 --> 00:05:29,230
people so what kind of people do you

122
00:05:25,510 --> 00:05:31,180
need there you need experts if you have

123
00:05:29,230 --> 00:05:32,410
existing ones that'll be perfect so

124
00:05:31,180 --> 00:05:34,720
people that have the right you know

125
00:05:32,410 --> 00:05:37,630
skills the right mindset the right

126
00:05:34,720 --> 00:05:39,700
background and if you don't have you

127
00:05:37,630 --> 00:05:42,040
know experts in house you can hire

128
00:05:39,700 --> 00:05:44,200
consultants to do that for you and the

129
00:05:42,040 --> 00:05:46,570
reason you would you would you know have

130
00:05:44,200 --> 00:05:49,210
experts is because you could use them to

131
00:05:46,570 --> 00:05:51,250
train your other stuff in the sock which

132
00:05:49,210 --> 00:05:54,250
is like the biggest benefit of it you

133
00:05:51,250 --> 00:05:56,890
can use the experts to fine-tune the

134
00:05:54,250 --> 00:05:59,470
tools that you use within the sock so

135
00:05:56,890 --> 00:06:02,140
like you see them all the other like

136
00:05:59,470 --> 00:06:03,970
solutions like collection of events and

137
00:06:02,140 --> 00:06:05,770
things like that and the most important

138
00:06:03,970 --> 00:06:08,980
one is that they know how the process

139
00:06:05,770 --> 00:06:10,900
works like the incident response process

140
00:06:08,980 --> 00:06:14,290
so you want to have them define that as

141
00:06:10,900 --> 00:06:16,479
well for you and procedures too so

142
00:06:14,290 --> 00:06:18,010
besides the existing experts or

143
00:06:16,480 --> 00:06:21,880
consultants if you don't have existing

144
00:06:18,010 --> 00:06:23,530
experts higher internal you know get

145
00:06:21,880 --> 00:06:24,610
internal staff on board because you

146
00:06:23,530 --> 00:06:27,840
probably have in your organization

147
00:06:24,610 --> 00:06:31,180
people that understand your environment

148
00:06:27,840 --> 00:06:34,030
really really well and they might not

149
00:06:31,180 --> 00:06:36,220
have like the right skill set so they

150
00:06:34,030 --> 00:06:37,510
probably have some of the skill set but

151
00:06:36,220 --> 00:06:39,789
they can I gradually you know adapt new

152
00:06:37,510 --> 00:06:40,900
skills if they have the right mindset

153
00:06:39,789 --> 00:06:42,090
that would be you know they'll be

154
00:06:40,900 --> 00:06:44,190
perfect

155
00:06:42,090 --> 00:06:45,750
if you don't have any internal guys then

156
00:06:44,190 --> 00:06:48,000
you would obviously go and hire somebody

157
00:06:45,750 --> 00:06:49,740
but do you have experts on board from

158
00:06:48,000 --> 00:06:52,140
the beginning because that that will you

159
00:06:49,740 --> 00:06:54,150
know help you implement yourself much

160
00:06:52,140 --> 00:06:56,849
faster or if you already have a shot you

161
00:06:54,150 --> 00:07:02,489
will probably be much much faster to get

162
00:06:56,850 --> 00:07:04,370
it to a mature level so in terms of

163
00:07:02,490 --> 00:07:06,420
Technology

164
00:07:04,370 --> 00:07:10,260
we all know that there is a lot of tools

165
00:07:06,420 --> 00:07:12,210
out there that socks use we'll see that

166
00:07:10,260 --> 00:07:14,789
on the other slide but basically it's

167
00:07:12,210 --> 00:07:17,280
not a problem of you know like lack of

168
00:07:14,790 --> 00:07:19,470
tools it's a it's an issue where you

169
00:07:17,280 --> 00:07:23,820
know people cannot or don't know how to

170
00:07:19,470 --> 00:07:25,800
effectively use those tools so we all

171
00:07:23,820 --> 00:07:28,730
know that the said the central part of

172
00:07:25,800 --> 00:07:31,440
every sock is a sim where you have like

173
00:07:28,730 --> 00:07:33,720
all the events coming in and use it for

174
00:07:31,440 --> 00:07:36,000
correlation and context and real-time

175
00:07:33,720 --> 00:07:38,580
analysis and historical analysis and so

176
00:07:36,000 --> 00:07:41,730
on so there are actually two types of

177
00:07:38,580 --> 00:07:44,580
seams that I that I know of one is that

178
00:07:41,730 --> 00:07:46,500
use for one that used for compliance so

179
00:07:44,580 --> 00:07:48,419
basically you just say okay I'm you know

180
00:07:46,500 --> 00:07:50,340
the auditors tell told me that I need to

181
00:07:48,420 --> 00:07:52,800
get all these logs in there I need to

182
00:07:50,340 --> 00:07:54,119
capture all these events so you just

183
00:07:52,800 --> 00:07:57,840
shove it in there and then when you need

184
00:07:54,120 --> 00:07:59,550
to do like an any analysis it's very

185
00:07:57,840 --> 00:08:01,049
difficult to do it you have to wait for

186
00:07:59,550 --> 00:08:02,760
a long long time to get your searches

187
00:08:01,050 --> 00:08:05,880
you know to get some results out of your

188
00:08:02,760 --> 00:08:07,890
searches probably go for a coffee or for

189
00:08:05,880 --> 00:08:09,480
lunch or something like that and then

190
00:08:07,890 --> 00:08:12,599
when you come back it probably crashes

191
00:08:09,480 --> 00:08:14,130
so you know most of it is like for

192
00:08:12,600 --> 00:08:16,890
compliance the one that we're looking

193
00:08:14,130 --> 00:08:18,810
for so that a Sox should eventually have

194
00:08:16,890 --> 00:08:21,930
is a technical team so one day you can

195
00:08:18,810 --> 00:08:23,760
basically you know come there and and

196
00:08:21,930 --> 00:08:25,380
just search and it will be very quick

197
00:08:23,760 --> 00:08:27,710
you'll get your results faster you will

198
00:08:25,380 --> 00:08:33,150
be able to do your analysis properly and

199
00:08:27,710 --> 00:08:34,919
and you don't catch the bad guys so

200
00:08:33,150 --> 00:08:38,010
looking into technology there are some

201
00:08:34,919 --> 00:08:40,669
issues that you know come to mind like

202
00:08:38,010 --> 00:08:43,289
you know what should I be gathering

203
00:08:40,669 --> 00:08:45,689
should I be gathering everything like

204
00:08:43,289 --> 00:08:46,650
you know what I've mentioned before as

205
00:08:45,690 --> 00:08:48,060
you do for compliance

206
00:08:46,650 --> 00:08:50,790
so they're actually or should I be

207
00:08:48,060 --> 00:08:52,560
gathering some you know just a bit some

208
00:08:50,790 --> 00:08:54,990
parts of it so basically there are three

209
00:08:52,560 --> 00:08:56,160
strategies that we have there the first

210
00:08:54,990 --> 00:08:58,380
one is the input

211
00:08:56,160 --> 00:09:00,030
so that's like the hoarder approach

212
00:08:58,380 --> 00:09:02,189
where you say okay let just give me

213
00:09:00,030 --> 00:09:03,980
everything in it you know whatever you

214
00:09:02,190 --> 00:09:06,360
have just shove it all in there and

215
00:09:03,980 --> 00:09:08,580
basically you get the the picture on the

216
00:09:06,360 --> 00:09:13,860
left of that you know overstuffed fridge

217
00:09:08,580 --> 00:09:16,710
so you know you have a sim which is full

218
00:09:13,860 --> 00:09:18,360
of these logs which is very slow which

219
00:09:16,710 --> 00:09:22,110
is you know you cannot use it for

220
00:09:18,360 --> 00:09:23,550
analytical purposes the other model is

221
00:09:22,110 --> 00:09:25,680
the output driven model

222
00:09:23,550 --> 00:09:27,300
wellyou've where you know that you need

223
00:09:25,680 --> 00:09:29,729
to have like you know you want to alert

224
00:09:27,300 --> 00:09:32,430
on something you know what you what you

225
00:09:29,730 --> 00:09:34,380
need to get it to that alert so you know

226
00:09:32,430 --> 00:09:35,609
your input so you say okay I'm gonna be

227
00:09:34,380 --> 00:09:37,650
very picky about it I'm gonna be

228
00:09:35,610 --> 00:09:41,550
technical about it I'm gonna say okay I

229
00:09:37,650 --> 00:09:43,680
need only those events from you know

230
00:09:41,550 --> 00:09:46,199
your network devices or from your

231
00:09:43,680 --> 00:09:48,239
endpoints or from servers or whatever in

232
00:09:46,200 --> 00:09:50,490
that in that case you have the picture

233
00:09:48,240 --> 00:09:53,220
on the on the ride so which is a nicely

234
00:09:50,490 --> 00:09:54,960
you know a nice fridge with everything

235
00:09:53,220 --> 00:09:57,480
you know packed properly and you know

236
00:09:54,960 --> 00:10:00,810
you can find fine things very very

237
00:09:57,480 --> 00:10:02,580
quickly and there's also what we call a

238
00:10:00,810 --> 00:10:05,489
hybrid model so basically you know going

239
00:10:02,580 --> 00:10:06,810
from one to the other so you start off

240
00:10:05,490 --> 00:10:08,100
with a hoarder approach where you say

241
00:10:06,810 --> 00:10:10,410
okay I'm gonna shove everything in there

242
00:10:08,100 --> 00:10:11,610
and then you filter out you know I don't

243
00:10:10,410 --> 00:10:13,020
need that I don't need that so you

244
00:10:11,610 --> 00:10:17,460
filter it out and you gradually go

245
00:10:13,020 --> 00:10:18,750
toward the output different model so

246
00:10:17,460 --> 00:10:20,840
these are all the logs that we have you

247
00:10:18,750 --> 00:10:23,700
know all the devices all the different

248
00:10:20,840 --> 00:10:26,580
all the different solutions that we need

249
00:10:23,700 --> 00:10:30,950
to get logs from and these are the three

250
00:10:26,580 --> 00:10:30,950
ways that we we should be doing it

251
00:10:33,260 --> 00:10:38,069
there's a big question about you know

252
00:10:35,940 --> 00:10:42,870
should we should we be collecting

253
00:10:38,070 --> 00:10:46,890
desktop bulbs and my answer is yes we

254
00:10:42,870 --> 00:10:49,200
should because most of the most of the

255
00:10:46,890 --> 00:10:51,420
attacks happen on clients so you know

256
00:10:49,200 --> 00:10:53,220
whether it you know and it happens from

257
00:10:51,420 --> 00:10:57,150
like an infection happens from a USB or

258
00:10:53,220 --> 00:10:59,850
from phishing emails or from you know

259
00:10:57,150 --> 00:11:01,890
ransomware things like that basically

260
00:10:59,850 --> 00:11:03,300
yes you should be collecting desktop

261
00:11:01,890 --> 00:11:05,520
logs but I'm not saying that you should

262
00:11:03,300 --> 00:11:07,829
be collecting all of them that's why

263
00:11:05,520 --> 00:11:09,290
there are two strategies so either

264
00:11:07,830 --> 00:11:12,259
collect all of them you

265
00:11:09,290 --> 00:11:15,199
we gonna you know lock your seam to the

266
00:11:12,259 --> 00:11:17,420
ground and or you can collect like

267
00:11:15,199 --> 00:11:21,199
targeted events so targeted things that

268
00:11:17,420 --> 00:11:24,560
you need and then you know be much more

269
00:11:21,199 --> 00:11:27,649
costly to not collect the events then

270
00:11:24,560 --> 00:11:30,199
then to do you know to collect them so

271
00:11:27,649 --> 00:11:34,519
basically if we log everything we see on

272
00:11:30,199 --> 00:11:37,399
the left side that we basically you know

273
00:11:34,519 --> 00:11:40,130
have more desktop logs than server logs

274
00:11:37,399 --> 00:11:42,230
and that's normal because you have more

275
00:11:40,130 --> 00:11:44,269
desktops and servers so that's nothing

276
00:11:42,230 --> 00:11:46,670
new but if we do a targeted approach

277
00:11:44,269 --> 00:11:48,319
like a technical approach you know be

278
00:11:46,670 --> 00:11:50,599
nimble about it and just select specific

279
00:11:48,319 --> 00:11:53,870
events from from desktops then we have

280
00:11:50,600 --> 00:11:55,100
the targeted we have the the picture on

281
00:11:53,870 --> 00:11:56,720
the right where we have more events

282
00:11:55,100 --> 00:12:00,620
coming in from from servers than from

283
00:11:56,720 --> 00:12:05,180
desktops now why would that be important

284
00:12:00,620 --> 00:12:07,910
so if we collect desktop logs we can

285
00:12:05,180 --> 00:12:11,329
detect things like you know your pen

286
00:12:07,910 --> 00:12:13,490
testers coming in and and connecting to

287
00:12:11,329 --> 00:12:16,310
you know using the Terp retur to connect

288
00:12:13,490 --> 00:12:19,279
to a you know to a next to the tool to a

289
00:12:16,310 --> 00:12:21,579
remote machine basically what happens is

290
00:12:19,279 --> 00:12:23,899
that a service is created okay and

291
00:12:21,579 --> 00:12:25,310
immediately after that is deleted so if

292
00:12:23,899 --> 00:12:27,649
you're collecting like service events

293
00:12:25,310 --> 00:12:29,630
and you see a service event being

294
00:12:27,649 --> 00:12:31,850
generated you know being created on a

295
00:12:29,630 --> 00:12:34,160
machine on an on an endpoint that should

296
00:12:31,850 --> 00:12:36,500
be an alert in your sim so you would go

297
00:12:34,160 --> 00:12:38,149
and investigate that there are other

298
00:12:36,500 --> 00:12:40,069
method methods that you can use here as

299
00:12:38,149 --> 00:12:41,569
well so I mean you could look at the

300
00:12:40,069 --> 00:12:43,010
service name and see that it's a fully

301
00:12:41,569 --> 00:12:46,849
random name so you can use like

302
00:12:43,010 --> 00:12:49,819
frequency analysis to to detect this as

303
00:12:46,850 --> 00:12:51,560
well and be you know like 99.99% sure

304
00:12:49,819 --> 00:12:53,959
that it is some sort of an attack it's

305
00:12:51,560 --> 00:12:56,119
some sort of an anomaly which needs to

306
00:12:53,959 --> 00:12:58,160
be investigated same thing with the

307
00:12:56,120 --> 00:13:00,589
previous privilege escalation so again a

308
00:12:58,160 --> 00:13:02,029
service is created a random name it's

309
00:13:00,589 --> 00:13:03,410
something that you don't have in your

310
00:13:02,029 --> 00:13:05,839
environment something that you don't

311
00:13:03,410 --> 00:13:08,600
know so basically you should be alerting

312
00:13:05,839 --> 00:13:12,050
on that and that's what their supports

313
00:13:08,600 --> 00:13:14,810
give you the other part that we have is

314
00:13:12,050 --> 00:13:18,229
PowerShell box again it is part of

315
00:13:14,810 --> 00:13:21,319
desktop logs but partials ephod came up

316
00:13:18,230 --> 00:13:23,190
with a lot of logging features and you

317
00:13:21,319 --> 00:13:26,689
can see here some statistics

318
00:13:23,190 --> 00:13:29,430
we're basically carbon black research

319
00:13:26,690 --> 00:13:31,320
report states that 38% of incidents

320
00:13:29,430 --> 00:13:34,229
involve PowerShell so we see a lot of

321
00:13:31,320 --> 00:13:38,310
power shells partial being used out

322
00:13:34,230 --> 00:13:41,550
there if you only turned on like command

323
00:13:38,310 --> 00:13:44,250
line logging for PowerShell you will be

324
00:13:41,550 --> 00:13:46,650
able to catch bad stuff because what did

325
00:13:44,250 --> 00:13:49,620
what do the adversaries do basically

326
00:13:46,650 --> 00:13:51,030
they don't want to be you know poking

327
00:13:49,620 --> 00:13:53,130
around and you know placing files on

328
00:13:51,030 --> 00:13:55,560
your system they want to stay in memory

329
00:13:53,130 --> 00:13:57,800
you know stealthy and so on so they they

330
00:13:55,560 --> 00:14:01,380
have these long partial command lines

331
00:13:57,800 --> 00:14:03,030
that they execute and if you have

332
00:14:01,380 --> 00:14:04,770
command line logging what you could do

333
00:14:03,030 --> 00:14:06,630
is you could just you know alert and and

334
00:14:04,770 --> 00:14:08,640
check if a command line has more than I

335
00:14:06,630 --> 00:14:12,570
don't know 100 or 200 or 500 characters

336
00:14:08,640 --> 00:14:14,100
and if that happens that's probably

337
00:14:12,570 --> 00:14:16,770
something that your you know system

338
00:14:14,100 --> 00:14:20,550
admin or whatever didn't you know type

339
00:14:16,770 --> 00:14:23,180
in manually so it has to be you know

340
00:14:20,550 --> 00:14:25,469
investigated there are other types of

341
00:14:23,180 --> 00:14:28,920
walking there like module logging or

342
00:14:25,470 --> 00:14:31,320
script log logging transcription logging

343
00:14:28,920 --> 00:14:33,060
which is like the the you know the the

344
00:14:31,320 --> 00:14:34,740
most verbose logging that you can get

345
00:14:33,060 --> 00:14:36,930
for a pub for PowerShell weight where

346
00:14:34,740 --> 00:14:39,660
basically you monitor you know the input

347
00:14:36,930 --> 00:14:41,849
and the output as well and you wouldn't

348
00:14:39,660 --> 00:14:43,920
be sending that off to a sim so you can

349
00:14:41,850 --> 00:14:46,170
send things like that so the

350
00:14:43,920 --> 00:14:49,219
transcription logging to like a share

351
00:14:46,170 --> 00:14:51,780
and if you need it for forensic purposes

352
00:14:49,220 --> 00:14:55,440
you have it there but you want to be

353
00:14:51,780 --> 00:14:57,480
sending that off to us in the other part

354
00:14:55,440 --> 00:14:59,010
that you know adversities like to do is

355
00:14:57,480 --> 00:15:01,860
they can actually run PowerShell without

356
00:14:59,010 --> 00:15:05,850
PowerShell dot exe so they can actually

357
00:15:01,860 --> 00:15:07,800
load three dll files and execute a

358
00:15:05,850 --> 00:15:09,480
PowerShell command and you wouldn't be

359
00:15:07,800 --> 00:15:11,760
getting that with a command line logging

360
00:15:09,480 --> 00:15:13,230
or module logging or whatever so for

361
00:15:11,760 --> 00:15:15,330
that you need a third party tool which

362
00:15:13,230 --> 00:15:17,520
is open source which is called system on

363
00:15:15,330 --> 00:15:21,770
and you will be looking for like DLL

364
00:15:17,520 --> 00:15:24,410
load events I forgot to mention but

365
00:15:21,770 --> 00:15:27,800
we're still on the page so

366
00:15:24,410 --> 00:15:30,350
a lot of the PowerShell commands tend to

367
00:15:27,800 --> 00:15:32,689
be basic support encoded so you could

368
00:15:30,350 --> 00:15:35,510
actually you know check if there is like

369
00:15:32,690 --> 00:15:37,820
basic support decode and kosher encoding

370
00:15:35,510 --> 00:15:42,439
in the partial command and alert on that

371
00:15:37,820 --> 00:15:45,970
as well just for you know for an example

372
00:15:42,440 --> 00:15:48,620
we have like if you invoke mimikatz

373
00:15:45,970 --> 00:15:52,070
which is a tool used to steal

374
00:15:48,620 --> 00:15:54,260
credentials if you have module logging

375
00:15:52,070 --> 00:15:56,360
turned on you will create a lot of

376
00:15:54,260 --> 00:15:58,189
events around eight and a half thousand

377
00:15:56,360 --> 00:16:01,190
events so you don't want to you know

378
00:15:58,190 --> 00:16:02,600
have that in your sim because you know

379
00:16:01,190 --> 00:16:05,720
if it's mimicked else you want to have

380
00:16:02,600 --> 00:16:10,130
like I don't know one event or less than

381
00:16:05,720 --> 00:16:11,510
8500 events with script log logging you

382
00:16:10,130 --> 00:16:14,240
cut that down to about five hundred

383
00:16:11,510 --> 00:16:15,770
events now you don't run me me me cats

384
00:16:14,240 --> 00:16:17,750
every single day on on every single

385
00:16:15,770 --> 00:16:20,210
machine so you want to be generating 500

386
00:16:17,750 --> 00:16:23,030
events but like a normal powershell

387
00:16:20,210 --> 00:16:25,100
script which is being executed it will

388
00:16:23,030 --> 00:16:26,660
just generate one event so we're cutting

389
00:16:25,100 --> 00:16:29,750
down on the amount of events that we are

390
00:16:26,660 --> 00:16:32,569
collecting and you know we're proving

391
00:16:29,750 --> 00:16:34,250
their desktop logging is possible but

392
00:16:32,570 --> 00:16:36,310
you have to be tactical technical about

393
00:16:34,250 --> 00:16:36,310
it

394
00:16:36,580 --> 00:16:43,280
what about dns logs so this is something

395
00:16:39,560 --> 00:16:44,479
that you know it's another you know very

396
00:16:43,280 --> 00:16:46,130
big question whether you should be

397
00:16:44,480 --> 00:16:48,350
collecting it or not so if you go out

398
00:16:46,130 --> 00:16:50,030
down to your system admin and you you

399
00:16:48,350 --> 00:16:52,760
know you ask him okay can you turn on

400
00:16:50,030 --> 00:16:55,520
dns logging you know dns debug on on the

401
00:16:52,760 --> 00:16:59,150
dns server you probably be punched in

402
00:16:55,520 --> 00:17:01,310
the face because you will kill the

403
00:16:59,150 --> 00:17:04,220
server so there are other solutions that

404
00:17:01,310 --> 00:17:06,169
you can use there one of the solutions

405
00:17:04,220 --> 00:17:09,319
is from security onion so you can use

406
00:17:06,170 --> 00:17:10,910
security onion specifically bro to sniff

407
00:17:09,319 --> 00:17:13,369
the network and then extract the dns

408
00:17:10,910 --> 00:17:15,829
logs and what would you why would you do

409
00:17:13,369 --> 00:17:18,020
that so basically you would do that

410
00:17:15,829 --> 00:17:20,089
because you will be able to catch things

411
00:17:18,020 --> 00:17:24,980
like you know domains that keep changing

412
00:17:20,089 --> 00:17:27,290
IPs often and often if you have a list

413
00:17:24,980 --> 00:17:29,690
of domains that your organization is you

414
00:17:27,290 --> 00:17:31,700
know visiting on a daily basis and you

415
00:17:29,690 --> 00:17:33,680
see a new observe you know you observe a

416
00:17:31,700 --> 00:17:36,080
new domain which is not in your white

417
00:17:33,680 --> 00:17:37,790
list you can alert on that as well

418
00:17:36,080 --> 00:17:41,120
because people tend to be

419
00:17:37,790 --> 00:17:44,149
all sides you know sites that they visit

420
00:17:41,120 --> 00:17:46,159
every day so new domains should not be

421
00:17:44,150 --> 00:17:49,810
showing up that often again you would

422
00:17:46,160 --> 00:17:52,430
not have so many alerts baby domains

423
00:17:49,810 --> 00:17:54,260
that's something that you know why would

424
00:17:52,430 --> 00:17:57,290
somebody be accessing a domain which is

425
00:17:54,260 --> 00:17:58,910
like two days old so that's that's

426
00:17:57,290 --> 00:18:01,399
something unusual and you can alert on

427
00:17:58,910 --> 00:18:04,160
that as well you could detect the

428
00:18:01,400 --> 00:18:07,160
exfiltration of data through DNS

429
00:18:04,160 --> 00:18:11,120
tunneling specifically through text

430
00:18:07,160 --> 00:18:12,950
records and the last one is you know I

431
00:18:11,120 --> 00:18:14,659
mean there's more more but the last one

432
00:18:12,950 --> 00:18:15,950
of the list is like the unauthorized

433
00:18:14,660 --> 00:18:19,190
devices so you can detect unauthorized

434
00:18:15,950 --> 00:18:22,010
devices on the network it is a poor

435
00:18:19,190 --> 00:18:23,150
man's neck so it's not like 100% you

436
00:18:22,010 --> 00:18:26,720
know you will detect all unauthorized

437
00:18:23,150 --> 00:18:30,440
devices but the way to do that is every

438
00:18:26,720 --> 00:18:33,920
machine has like an NTP server so when

439
00:18:30,440 --> 00:18:36,200
you saw like Windows or you the NTP

440
00:18:33,920 --> 00:18:38,180
server set to time dot windows comm so

441
00:18:36,200 --> 00:18:40,600
if you see anybody go out to time got

442
00:18:38,180 --> 00:18:43,130
windows com

443
00:18:40,600 --> 00:18:44,689
that's probably an unauthorized device

444
00:18:43,130 --> 00:18:46,700
because in your organization you

445
00:18:44,690 --> 00:18:49,700
probably have an NTP server which is

446
00:18:46,700 --> 00:18:53,150
local so every single endpoint should be

447
00:18:49,700 --> 00:18:55,460
going to your local ntp server if you do

448
00:18:53,150 --> 00:18:57,950
just two things so if you monitor for

449
00:18:55,460 --> 00:18:59,000
new domains that you haven't seen in

450
00:18:57,950 --> 00:19:02,240
your organization yet

451
00:18:59,000 --> 00:19:04,130
then if you monitor the direct IP so

452
00:19:02,240 --> 00:19:06,260
naked eye piece meaning that they don't

453
00:19:04,130 --> 00:19:08,570
have a domain associated with them you

454
00:19:06,260 --> 00:19:16,430
can alert on almost a hundred percent of

455
00:19:08,570 --> 00:19:20,149
Internet based Network attacks okay in

456
00:19:16,430 --> 00:19:22,360
terms of process so in order for your

457
00:19:20,150 --> 00:19:24,920
sock to be successful you need to have a

458
00:19:22,360 --> 00:19:29,060
really well-defined Incident Response

459
00:19:24,920 --> 00:19:30,920
process so your people need to know what

460
00:19:29,060 --> 00:19:34,310
happens when an alert comes into your

461
00:19:30,920 --> 00:19:35,960
sock does the level one analyst look at

462
00:19:34,310 --> 00:19:38,540
the alert and try to you know analyze it

463
00:19:35,960 --> 00:19:41,210
and investigate it a bit more does it

464
00:19:38,540 --> 00:19:44,420
pass it on to like level two or just

465
00:19:41,210 --> 00:19:47,480
straight away to like the incident

466
00:19:44,420 --> 00:19:48,890
handlers does it contain a machine if

467
00:19:47,480 --> 00:19:50,090
it's a you know if it's infected or

468
00:19:48,890 --> 00:19:51,410
something like that you need to know

469
00:19:50,090 --> 00:19:51,980
that you know you need to define that

470
00:19:51,410 --> 00:19:54,260
process be

471
00:19:51,980 --> 00:19:56,299
because when when an incident happens

472
00:19:54,260 --> 00:20:00,530
you need to know exactly what everybody

473
00:19:56,299 --> 00:20:03,320
is doing to be successful to do that you

474
00:20:00,530 --> 00:20:05,299
need to perform fire drills so do we

475
00:20:03,320 --> 00:20:08,059
like mock infections you know test your

476
00:20:05,299 --> 00:20:09,799
your sock with pentesters coming in if

477
00:20:08,059 --> 00:20:11,750
you have a red team in there cool if you

478
00:20:09,799 --> 00:20:14,030
don't you know hire some some

479
00:20:11,750 --> 00:20:16,010
consultants to do that for you and and

480
00:20:14,030 --> 00:20:20,330
keep testing your sock make sure they

481
00:20:16,010 --> 00:20:23,480
are they are up to the game there are

482
00:20:20,330 --> 00:20:25,639
two models for incident process for the

483
00:20:23,480 --> 00:20:29,090
incident process incident of swamp

484
00:20:25,640 --> 00:20:31,130
response process so you can use the boa

485
00:20:29,090 --> 00:20:32,510
which is the most commonly used one so

486
00:20:31,130 --> 00:20:35,630
that's the one that's showing up here on

487
00:20:32,510 --> 00:20:38,320
with the green circle which consists of

488
00:20:35,630 --> 00:20:40,640
six stages or you can use the NIST

489
00:20:38,320 --> 00:20:44,750
computer in security incident handling

490
00:20:40,640 --> 00:20:46,760
guide among the you know the incident

491
00:20:44,750 --> 00:20:49,610
response process you should have in your

492
00:20:46,760 --> 00:20:51,260
sock it's not limited to but you know

493
00:20:49,610 --> 00:20:53,149
most all should have like you know

494
00:20:51,260 --> 00:20:54,860
monitoring procedure

495
00:20:53,150 --> 00:20:56,390
you know notification procedures are you

496
00:20:54,860 --> 00:20:59,178
who you need to notify if something

497
00:20:56,390 --> 00:21:02,890
happens maybe some sort of a template as

498
00:20:59,179 --> 00:21:05,030
well for an order for notification

499
00:21:02,890 --> 00:21:07,429
incident logging which is important so

500
00:21:05,030 --> 00:21:10,990
you can do you know reports on how long

501
00:21:07,429 --> 00:21:13,370
did it take for an incident to be closed

502
00:21:10,990 --> 00:21:15,710
then you have of course report

503
00:21:13,370 --> 00:21:18,439
development so you know reporting on and

504
00:21:15,710 --> 00:21:21,049
on and on a daily basis weekly basis

505
00:21:18,440 --> 00:21:26,720
monthly basis for for the management

506
00:21:21,049 --> 00:21:28,900
therefore and so on so what I want you

507
00:21:26,720 --> 00:21:35,030
to take home today in terms of people

508
00:21:28,900 --> 00:21:37,280
basically look for quality not only

509
00:21:35,030 --> 00:21:40,490
quantity so quality is the one you know

510
00:21:37,280 --> 00:21:43,309
look for experts they will help mature

511
00:21:40,490 --> 00:21:44,990
your sock that will help you get your

512
00:21:43,309 --> 00:21:47,389
sock up and running if you if you don't

513
00:21:44,990 --> 00:21:49,220
have it already and make sure you use

514
00:21:47,390 --> 00:21:51,010
them to train your people so training is

515
00:21:49,220 --> 00:21:53,620
important for your for your soft people

516
00:21:51,010 --> 00:21:56,650
in terms of Technology think about

517
00:21:53,620 --> 00:22:00,080
technical versus compliance seems so

518
00:21:56,650 --> 00:22:02,659
compliant seems tend to be more you know

519
00:22:00,080 --> 00:22:03,720
commercial technicals it seems seem to

520
00:22:02,659 --> 00:22:06,029
be

521
00:22:03,720 --> 00:22:09,149
more open source because there are open

522
00:22:06,029 --> 00:22:11,159
source seams out there think about

523
00:22:09,149 --> 00:22:13,830
desktop logs you know logging desktop

524
00:22:11,159 --> 00:22:16,440
blocks especially PowerShell and DNS

525
00:22:13,830 --> 00:22:17,549
logs so you should be technical about it

526
00:22:16,440 --> 00:22:19,620
I'm not saying you should be logging

527
00:22:17,549 --> 00:22:21,929
everything but think about it because

528
00:22:19,620 --> 00:22:24,360
there's a wealth of information that you

529
00:22:21,929 --> 00:22:27,509
can get out of it as for the process I

530
00:22:24,360 --> 00:22:29,758
already mentioned so define your

531
00:22:27,509 --> 00:22:31,830
incident response process properly and

532
00:22:29,759 --> 00:22:35,100
make sure that it is tested on a you

533
00:22:31,830 --> 00:22:36,689
know regular basis so that everybody

534
00:22:35,100 --> 00:22:40,949
knows what it what they're doing because

535
00:22:36,690 --> 00:22:42,899
if they don't you you will fail and just

536
00:22:40,950 --> 00:22:44,970
you know a last quote that we all know

537
00:22:42,899 --> 00:22:47,158
that there are two types of

538
00:22:44,970 --> 00:22:48,600
organizations out there those that were

539
00:22:47,159 --> 00:22:51,690
breached and those that that will be

540
00:22:48,600 --> 00:22:53,789
breached but by being prepared when it

541
00:22:51,690 --> 00:23:00,090
happens that's that you know that's what

542
00:22:53,789 --> 00:23:03,179
makes the difference so that's it thanks

543
00:23:00,090 --> 00:23:19,320
a lot I could probably take questions

544
00:23:03,179 --> 00:23:23,220
now oh yeah yeah yeah hi great

545
00:23:19,320 --> 00:23:25,408
presentation thank you very much all

546
00:23:23,220 --> 00:23:28,830
those tools like carbon black and

547
00:23:25,409 --> 00:23:33,570
because money is there any alternative

548
00:23:28,830 --> 00:23:36,080
to commercial tools and to speed up the

549
00:23:33,570 --> 00:23:39,240
process and not invest too much into the

550
00:23:36,080 --> 00:23:40,740
Security Operations Center yeah so there

551
00:23:39,240 --> 00:23:42,419
are commercial tools out there like I

552
00:23:40,740 --> 00:23:44,220
mentioned already and most of them are

553
00:23:42,419 --> 00:23:46,019
you know most folks use it for

554
00:23:44,220 --> 00:23:47,789
compliance but if you want to do like a

555
00:23:46,019 --> 00:23:49,289
technical sock yes I'm not saying you

556
00:23:47,789 --> 00:23:51,360
should not be using commercial tools yes

557
00:23:49,289 --> 00:23:55,049
there are open-source tools out there as

558
00:23:51,360 --> 00:23:56,969
well so you can use you know like the

559
00:23:55,049 --> 00:23:59,700
elks Tech is one of them it's being used

560
00:23:56,970 --> 00:24:01,620
by by many organizations out there it

561
00:23:59,700 --> 00:24:05,399
does require customization but you can

562
00:24:01,620 --> 00:24:07,320
use you know open-source tools osek is

563
00:24:05,399 --> 00:24:12,239
one of them as well for like if you need

564
00:24:07,320 --> 00:24:13,439
hits on your endpoints so to be honest

565
00:24:12,240 --> 00:24:15,960
all the commercial tools actually

566
00:24:13,440 --> 00:24:17,309
started you know using open-source tools

567
00:24:15,960 --> 00:24:19,039
and then it built up to all comers

568
00:24:17,309 --> 00:24:23,908
so there's always something out there

569
00:24:19,039 --> 00:24:26,429
and use the company can provide it yes

570
00:24:23,909 --> 00:24:45,840
we can talk about a whole face outside

571
00:24:26,429 --> 00:24:48,830
there okay thank you thanks hello

572
00:24:45,840 --> 00:24:51,539
sorry I missed start but I want to ask

573
00:24:48,830 --> 00:24:54,960
what kind of tool do you use to analyze

574
00:24:51,539 --> 00:24:58,529
those logs sorry what kind of tool to

575
00:24:54,960 --> 00:25:01,769
use to analyze these kind of logs you

576
00:24:58,529 --> 00:25:03,240
take such amount so if I heard you

577
00:25:01,769 --> 00:25:05,730
correctly what kind of tool do I use to

578
00:25:03,240 --> 00:25:07,350
analyze all these logs yeah I sorry I

579
00:25:05,730 --> 00:25:09,029
didn't I miss the start of the

580
00:25:07,350 --> 00:25:10,860
presentation okay so basically the

581
00:25:09,029 --> 00:25:13,230
central part of every sock is a sim

582
00:25:10,860 --> 00:25:15,269
whether it be an hour commercial seam

583
00:25:13,230 --> 00:25:18,509
which is used for long collection and

584
00:25:15,269 --> 00:25:22,070
correlation purposes so this is where

585
00:25:18,509 --> 00:25:22,070
you do most of your analysis

586
00:25:35,450 --> 00:25:40,799
[Applause]

