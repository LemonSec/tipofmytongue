1
00:00:00,000 --> 00:00:01,890
okay good morning everyone then I will

2
00:00:01,890 --> 00:00:03,958
only introduce myself for a moment for those who do

3
00:00:03,959 --> 00:00:06,720
not already know me my name is paolo pond

4
00:00:06,720 --> 00:00:09,120
and on the internet I am better known

5
00:00:09,120 --> 00:00:12,599
as void set since the beginning of my

6
00:00:12,599 --> 00:00:13,830
career I have mainly dealt

7
00:00:13,830 --> 00:00:17,310
with both application and infrastructural penetration tests

8
00:00:17,310 --> 00:00:20,460
and then  to laugh at the team

9
00:00:20,460 --> 00:00:22,710
in hand I am trying instead to

10
00:00:22,710 --> 00:00:25,289
move towards a part of the research in

11
00:00:25,289 --> 00:00:27,240
the windows field it is mainly to

12
00:00:27,240 --> 00:00:30,660
move towards the split bay and shawn

13
00:00:30,660 --> 00:00:34,230
has always been interested in

14
00:00:34,230 --> 00:00:35,910
understanding the functioning of the objects

15
00:00:35,910 --> 00:00:38,450
that surround us substantially

16
00:00:38,450 --> 00:00:41,190
also continues a  homonymous blog boyd

17
00:00:41,190 --> 00:00:43,230
sex.com on which I publish

18
00:00:43,230 --> 00:00:45,780
my researches vulnerabilities in

19
00:00:45,780 --> 00:00:49,260
general the results of my studies I

20
00:00:49,260 --> 00:00:50,550
only ask one thing since I

21
00:00:50,550 --> 00:00:52,710
have to give you a roundup of concepts if

22
00:00:52,710 --> 00:00:55,020
you have questions please do the bottom

23
00:00:55,020 --> 00:00:59,430
only and today we will talk about scale

24
00:00:59,430 --> 00:01:01,620
Basically in recent years we have

25
00:01:01,620 --> 00:01:04,049
always heard of scale both in

26
00:01:04,049 --> 00:01:06,540
technical articles of itself  ttore but also in the

27
00:01:06,540 --> 00:01:09,320
su of the more and generalist newspapers

28
00:01:09,320 --> 00:01:13,439
always in a worrying connotation

29
00:01:13,439 --> 00:01:15,840
with frightening news coming

30
00:01:15,840 --> 00:01:17,759
from this sector we went from

31
00:01:17,759 --> 00:01:19,710
stuxnet to the compromise of

32
00:01:19,710 --> 00:01:20,610
the national distribution grid

33
00:01:20,610 --> 00:01:23,400
in Ukraine took place in

34
00:01:23,400 --> 00:01:24,659
December

35
00:01:24,659 --> 00:01:28,320
2015 scana systems are actively

36
00:01:28,320 --> 00:01:30,450
used in  everything that generally

37
00:01:30,450 --> 00:01:32,340
falls under the nomenclature of

38
00:01:32,340 --> 00:01:34,290
critical

39
00:01:34,290 --> 00:01:35,790
infrastructures critical infrastructures are all

40
00:01:35,790 --> 00:01:38,100
those strategic companies for a country

41
00:01:38,100 --> 00:01:39,840
and range from the supply

42
00:01:39,840 --> 00:01:42,329
of electricity or energy in

43
00:01:42,329 --> 00:01:43,829
general, therefore power plants

44
00:01:43,829 --> 00:01:47,060
distribution crickets of g and railways

45
00:01:47,060 --> 00:01:50,009
nuclear power stations and so on

46
00:01:50,009 --> 00:01:52,229
are also  the scada systems are

47
00:01:52,229 --> 00:01:55,090
used by different

48
00:01:55,090 --> 00:01:58,119
product sectors so they range from

49
00:01:58,119 --> 00:02:02,460
oil and gas to pp pharma and so on

50
00:02:02,460 --> 00:02:04,479
they basically manage the

51
00:02:04,479 --> 00:02:07,270
production in this talk so I will

52
00:02:07,270 --> 00:02:08,860
try to give me an overview of all the

53
00:02:08,860 --> 00:02:10,869
major components that can be

54
00:02:10,869 --> 00:02:12,819
encountered in this environment  body and then

55
00:02:12,819 --> 00:02:14,170
we will see together some of the cases of the

56
00:02:14,170 --> 00:02:15,730
most famous malware that have precisely

57
00:02:15,730 --> 00:02:18,549
targeted these in these environments

58
00:02:18,549 --> 00:02:20,170
specifically then try to go

59
00:02:20,170 --> 00:02:22,920
into the technical detail of a

60
00:02:22,920 --> 00:02:25,299
specific plc used not in these

61
00:02:25,299 --> 00:02:28,560
environments because to explain the reason

62
00:02:28,560 --> 00:02:31,060
then it is not possible to speak of scale

63
00:02:31,060 --> 00:02:32,980
therefore without the basic concepts that

64
00:02:32,980 --> 00:02:34,200
govern this environment

65
00:02:34,200 --> 00:02:37,030
the first concept that we will face and

66
00:02:37,030 --> 00:02:39,130
are the control systems in control systems

67
00:02:39,130 --> 00:02:41,079
are

68
00:02:41,079 --> 00:02:43,269
basically designed around the controller

69
00:02:43,269 --> 00:02:46,090
the controller effect of decisions

70
00:02:46,090 --> 00:02:48,400
based on the inputs it receives from the

71
00:02:48,400 --> 00:02:51,069
sensors and the possibility of varying the

72
00:02:51,069 --> 00:02:53,079
process by changing  the status of actuators

73
00:02:53,079 --> 00:02:56,890
if mechanical and analog controllers

74
00:02:56,890 --> 00:02:58,780
are often supported a

75
00:02:58,780 --> 00:03:00,930
dedicated infrastructure for the management of the same

76
00:03:00,930 --> 00:03:03,910
normally used to collect

77
00:03:03,910 --> 00:03:06,160
data therefore in the sense both for the history

78
00:03:06,160 --> 00:03:07,450
and for the status of production processes

79
00:03:07,450 --> 00:03:10,120
for errors and so on

80
00:03:10,120 --> 00:03:12,730
yes hd operator interface  user so

81
00:03:12,730 --> 00:03:15,220
d  to show high-level flow diagrams

82
00:03:15,220 --> 00:03:17,829
and to be able to control the

83
00:03:17,829 --> 00:03:19,480
controllers sexes, however

84
00:03:19,480 --> 00:03:21,099
, most controllers

85
00:03:21,099 --> 00:03:22,209
do not need to remain

86
00:03:22,209 --> 00:03:24,819
permanently connected to the

87
00:03:24,819 --> 00:03:26,680
management infrastructures and once

88
00:03:26,680 --> 00:03:28,630
programmed they can operate

89
00:03:28,630 --> 00:03:29,370
independently

90
00:03:29,370 --> 00:03:32,380
this kind of architecture yes  applies

91
00:03:32,380 --> 00:03:33,880
practically to all medical devices

92
00:03:33,880 --> 00:03:37,380
and aids

93
00:03:37,980 --> 00:03:40,709
to the c.so industry control system which is

94
00:03:40,709 --> 00:03:43,230
basically the general term to

95
00:03:43,230 --> 00:03:45,480
describe different types

96
00:03:45,480 --> 00:03:47,549
of control systems and all

97
00:03:47,549 --> 00:03:50,940
associated instrumentation and precisely manage

98
00:03:50,940 --> 00:03:52,049
industrial processes

99
00:03:52,049 --> 00:03:54,330
if we simplify industrial control

100
00:03:54,330 --> 00:03:56,910
systems are computers  plc in this

101
00:03:56,910 --> 00:03:58,830
case and later we will see specifically how they

102
00:03:58,830 --> 00:04:01,769
work that then govern the whole

103
00:04:01,769 --> 00:04:03,810
world around us ranging from

104
00:04:03,810 --> 00:04:05,060
controllers for air conditioning

105
00:04:05,060 --> 00:04:06,959
used in offices in

106
00:04:06,959 --> 00:04:09,030
shopping centers to controllers for lights in

107
00:04:09,030 --> 00:04:11,190
theaters stadiums and so on

108
00:04:11,190 --> 00:04:12,690
to robots in the lines of

109
00:04:12,690 --> 00:04:15,629
automatic control  atized for production are

110
00:04:15,629 --> 00:04:17,970
systems that vary from eight

111
00:04:17,970 --> 00:04:19,769
modular controllers to huge

112
00:04:19,769 --> 00:04:22,289
interactive control systems interconnected

113
00:04:22,289 --> 00:04:24,000
and distributed with thousands of

114
00:04:24,000 --> 00:04:27,000
connections so the thousands of

115
00:04:27,000 --> 00:04:28,289
connections can also go to

116
00:04:28,289 --> 00:04:30,030
hardware devices that are

117
00:04:30,030 --> 00:04:31,710
geolocated even thousands of

118
00:04:31,710 --> 00:04:33,080
kilometers away

119
00:04:33,080 --> 00:04:35,340
an example can  be for example in

120
00:04:35,340 --> 00:04:38,400
america where many houses have

121
00:04:38,400 --> 00:04:41,850
digital meters and thermometers all

122
00:04:41,850 --> 00:04:43,620
these devices are connected then

123
00:04:43,620 --> 00:04:46,889
with the distribution center for

124
00:04:46,889 --> 00:04:50,000
heating industrial control

125
00:04:50,000 --> 00:04:52,229
systems basically work

126
00:04:52,229 --> 00:04:54,270
in this way and receive data from

127
00:04:54,270 --> 00:04:56,550
remote sensors and measure what a

128
00:04:56,550 --> 00:04:58,500
circle is called bbo process

129
00:04:58,500 --> 00:05:01,680
variables compare these data with the

130
00:05:01,680 --> 00:05:04,800
set point or sp and then derive the

131
00:05:04,800 --> 00:05:07,680
functions used to command and

132
00:05:07,680 --> 00:05:10,050
control the process through

133
00:05:10,050 --> 00:05:11,460
final or efficient control elements

134
00:05:11,460 --> 00:05:14,250
then through matrix valves,

135
00:05:14,250 --> 00:05:16,440
switches and whatever else they

136
00:05:16,440 --> 00:05:19,590
change to  precisely the process to

137
00:05:19,590 --> 00:05:22,349
respect those that are the sets with the

138
00:05:22,349 --> 00:05:23,789


139
00:05:23,789 --> 00:05:26,520
icy control systems they are often hybrids between

140
00:05:26,520 --> 00:05:29,430
dcs scada and therefore incorporate the

141
00:05:29,430 --> 00:05:32,370
attributes of both these elements

142
00:05:32,370 --> 00:05:34,800
dcs are therefore

143
00:05:34,800 --> 00:05:37,050
distributed control systems and are systems used

144
00:05:37,050 --> 00:05:39,510
to control production in the

145
00:05:39,510 --> 00:05:40,979
specification  locations are therefore

146
00:05:40,979 --> 00:05:44,370
local controllers all of cs have a

147
00:05:44,370 --> 00:05:46,500
centralized supervisor capable of

148
00:05:46,500 --> 00:05:48,660
managing multiple controls and this

149
00:05:48,660 --> 00:05:50,550
guarantees the industry to be

150
00:05:50,550 --> 00:05:52,169
able to quickly access the

151
00:05:52,169 --> 00:05:54,150
production data thanks to the use of

152
00:05:54,150 --> 00:05:55,889
multiple devices but controlled by

153
00:05:55,889 --> 00:05:58,620
a single one and are beyond all in  able to

154
00:05:58,620 --> 00:06:00,750
reduce the impact of a single failure

155
00:06:00,750 --> 00:06:02,100
because they are distributed across

156
00:06:02,100 --> 00:06:07,979
multiple devices the dcs we

157
00:06:07,979 --> 00:06:09,330
will start more or less like this

158
00:06:09,330 --> 00:06:11,789
here locally you have to keep in mind that

159
00:06:11,789 --> 00:06:13,260
the point of view of this architecture

160
00:06:13,260 --> 00:06:16,199
is a central office with several

161
00:06:16,199 --> 00:06:18,510
remote offices and therefore  in the central office there is

162
00:06:18,510 --> 00:06:21,870
therefore a tv or master ends unit  which

163
00:06:21,870 --> 00:06:23,699
is a device that sends commands to the

164
00:06:23,699 --> 00:06:27,150
rtv devices on the rtv field are the

165
00:06:27,150 --> 00:06:30,260
local controllers of each remote site

166
00:06:30,260 --> 00:06:33,150
so rtv is a device that says

167
00:06:33,150 --> 00:06:34,470
win calls and sends the

168
00:06:34,470 --> 00:06:36,960
requested information to the tvs and is generally

169
00:06:36,960 --> 00:06:39,060
composed of a network gateway and a

170
00:06:39,060 --> 00:06:42,780
controller pl yes generic and this how

171
00:06:42,780 --> 00:06:46,050
the arts are made are practically

172
00:06:46,050 --> 00:06:47,669
devices to which all the

173
00:06:47,669 --> 00:06:50,250
local controllers are connected and therefore the rt a

174
00:06:50,250 --> 00:06:52,860
multiplexer goes to send commands to the

175
00:06:52,860 --> 00:06:55,050
individual local controllers and receive the

176
00:06:55,050 --> 00:06:57,450
results these results were

177
00:06:57,450 --> 00:06:58,860
practically e lips and the  wicked and

178
00:06:58,860 --> 00:07:01,770
back to the yutube the mechanism

179
00:07:01,770 --> 00:07:03,060
with which the communication practically takes place

180
00:07:03,060 --> 00:07:05,250
is in fact a bit of the ing

181
00:07:05,250 --> 00:07:07,530
so the networks you will go to follow the single ones

182
00:07:07,530 --> 00:07:10,320
here to the controllers and the controller

183
00:07:10,320 --> 00:07:12,060
never has the possibility to start the

184
00:07:12,060 --> 00:07:16,800
communication therefore 16s

185
00:07:16,800 --> 00:07:18,900
operationally control the  on-site processes the

186
00:07:18,900 --> 00:07:21,229
scada systems which then the focus today

187
00:07:21,229 --> 00:07:23,070
allow the control of the devices

188
00:07:23,070 --> 00:07:27,030
to a remote operator  you therefore

189
00:07:27,030 --> 00:07:29,310
make it possible to view the

190
00:07:29,310 --> 00:07:31,710
production process and can acquire

191
00:07:31,710 --> 00:07:33,849
and transmit

192
00:07:33,849 --> 00:07:35,979
different types of data are therefore

193
00:07:35,979 --> 00:07:38,679
integrated with a human machine

194
00:07:38,679 --> 00:07:39,669
interface

195
00:07:39,669 --> 00:07:41,860
then there is never that therefore provides

196
00:07:41,860 --> 00:07:43,889
monitoring centralized control

197
00:07:43,889 --> 00:07:46,990
for the operator the purpose is therefore

198
00:07:46,990 --> 00:07:49,270
to control  remotely these

199
00:07:49,270 --> 00:07:50,740
production sites without we would have to physically go to

200
00:07:50,740 --> 00:07:54,189
the operator on the field of

201
00:07:54,189 --> 00:07:55,509
men machine interfaces

202
00:07:55,509 --> 00:07:58,539
are therefore interfaces that

203
00:07:58,539 --> 00:08:00,219
allow the interaction between the operator

204
00:08:00,219 --> 00:08:02,860
an evil and the production process

205
00:08:02,860 --> 00:08:05,439
as well as the controller hardware can

206
00:08:05,439 --> 00:08:07,479
basically display various

207
00:08:07,479 --> 00:08:09,159
information  generally on the state

208
00:08:09,159 --> 00:08:12,279
of the process of historical data and all

209
00:08:12,279 --> 00:08:13,809
that is precisely collected by the

210
00:08:13,809 --> 00:08:16,059
devices in the environment s are

211
00:08:16,059 --> 00:08:19,119
normally used to configure the

212
00:08:19,119 --> 00:08:21,309
set points therefore to respect a

213
00:08:21,309 --> 00:08:23,499
certain type of production and

214
00:08:23,499 --> 00:08:25,569
as well as the control algorithms flash

215
00:08:25,569 --> 00:08:28,589
a new program on the pl  yes and so on

216
00:08:28,589 --> 00:08:31,659
p  they can therefore vary a lot from

217
00:08:31,659 --> 00:08:34,179
physical control panels with lights buttons and

218
00:08:34,179 --> 00:08:36,839
so on industrial abc so where

219
00:08:36,839 --> 00:08:39,068
the screen is already integrated on the

220
00:08:39,068 --> 00:08:41,019
machine as well as instead

221
00:08:41,019 --> 00:08:43,659
of the web interface for which the

222
00:08:43,659 --> 00:08:45,310
operator connects directly to his station

223
00:08:45,310 --> 00:08:48,329
and can interface with  the contribution

224
00:08:48,329 --> 00:08:51,250
this is one of the examples that gives a

225
00:08:51,250 --> 00:08:52,990
better idea of the

226
00:08:52,990 --> 00:08:55,839
physical interfaces so in real life

227
00:08:55,839 --> 00:08:59,769
basically these are instead

228
00:08:59,769 --> 00:09:01,569
interfaces always for the

229
00:09:01,569 --> 00:09:04,779
control of industrial processes web or

230
00:09:04,779 --> 00:09:06,310
directly that run on

231
00:09:06,310 --> 00:09:08,889
specialized software on board these of

232
00:09:08,889 --> 00:09:11,139
these controllers

233
00:09:11,139 --> 00:09:13,970
so when I talk about controllers I am

234
00:09:13,970 --> 00:09:16,519
talking about jesi what are only

235
00:09:16,519 --> 00:09:18,649
generic controllers that can be

236
00:09:18,649 --> 00:09:21,229
programmed for any purpose are

237
00:09:21,229 --> 00:09:22,910
used both in sias systems and

238
00:09:22,910 --> 00:09:26,149
scada systems as controllers for a

239
00:09:26,149 --> 00:09:30,439
very specific task basically in

240
00:09:30,439 --> 00:09:33,759
scale the foot uses the same

241
00:09:33,759 --> 00:09:37,220
functions  of the rtv units

242
00:09:37,220 --> 00:09:39,499
while 11 they yes are a  point

243
00:09:39,499 --> 00:09:41,679
also used as local controllers

244
00:09:41,679 --> 00:09:45,139
only moreover practically the basic unit

245
00:09:45,139 --> 00:09:47,629
of all this large architecture and

246
00:09:47,629 --> 00:09:49,789
are used as primary components

247
00:09:49,789 --> 00:09:51,350
instead in much simpler architectures

248
00:09:51,350 --> 00:09:55,009
this is how they appear taken in

249
00:09:55,009 --> 00:09:56,689
single this here a model of

250
00:09:56,689 --> 00:09:59,629
siemens and this is how it looks instead

251
00:09:59,629 --> 00:10:02,029
within the industry, therefore, huge

252
00:10:02,029 --> 00:10:05,239
cabinets with multiple plc

253
00:10:05,239 --> 00:10:10,039
wired together and so on what is basically on board

254
00:10:10,039 --> 00:10:12,439
these plans there

255
00:10:12,439 --> 00:10:14,720
are very small operating systems

256
00:10:14,720 --> 00:10:18,470
and they are not the generic operating systems

257
00:10:18,470 --> 00:10:20,029
that we expect to find on  a

258
00:10:20,029 --> 00:10:23,559
desktop system etc.

259
00:10:23,689 --> 00:10:25,429
are basically

260
00:10:25,429 --> 00:10:28,009
real time operating systems and therefore are

261
00:10:28,009 --> 00:10:29,149
operating systems that must react

262
00:10:29,149 --> 00:10:32,720
quickly to a specific trigger in the

263
00:10:32,720 --> 00:10:34,519
case of a film save for example

264
00:10:34,519 --> 00:10:37,429
software is an operating system

265
00:10:37,429 --> 00:10:39,739
actually prevents them from high priority processes

266
00:10:39,739 --> 00:10:42,199
or rather prevents them  processes

267
00:10:42,199 --> 00:10:44,239
with lower priority to override the prior

268
00:10:44,239 --> 00:10:47,959
processes and tasks  high rity

269
00:10:47,959 --> 00:10:50,809
I give an example if you imagine the leaders

270
00:10:50,809 --> 00:10:53,720
of self-driving cars that therefore

271
00:10:53,720 --> 00:10:55,429
guarantee the safety of the driver by

272
00:10:55,429 --> 00:10:58,399
avoiding forecasts and it is important that

273
00:10:58,399 --> 00:11:01,100
the on-board system can precisely manage

274
00:11:01,100 --> 00:11:02,089
the tasks by priority

275
00:11:02,089 --> 00:11:04,939
regardless of what may

276
00:11:04,939 --> 00:11:07,189
occur as the system's calculation capacity

277
00:11:07,189 --> 00:11:07,970


278
00:11:07,970 --> 00:11:10,850
therefore, unlike the

279
00:11:10,850 --> 00:11:13,249
generic operating system, the answers with respect

280
00:11:13,249 --> 00:11:14,210
to

281
00:11:14,210 --> 00:11:16,380
computational deadlines regardless of

282
00:11:16,380 --> 00:11:17,760
how unfavorable the scenario may become

283
00:11:17,760 --> 00:11:18,930
for the operating system

284
00:11:18,930 --> 00:11:22,530
itself, the timing therefore the

285
00:11:22,530 --> 00:11:24,390
process timing is fundamental and is more

286
00:11:24,390 --> 00:11:26,450
important than the performance of the system

287
00:11:26,450 --> 00:11:31,080
therefore as a requirement that the system

288
00:11:31,080 --> 00:11:32,370
operating system is able to respond

289
00:11:32,370 --> 00:11:35,190
before a blind specification

290
00:11:35,190 --> 00:11:37,500
performance and computational speed

291
00:11:37,500 --> 00:11:41,250
are secondary therefore a

292
00:11:41,250 --> 00:11:42,840
reality system must guarantee the timing

293
00:11:42,840 --> 00:11:45,180
of the processes under its control and

294
00:11:45,180 --> 00:11:47,990
must be predictable in the sense of

295
00:11:47,990 --> 00:11:50,700
deterministic the operating system

296
00:11:50,700 --> 00:11:53,460
in fact it knows is the time necessary

297
00:11:53,460 --> 00:11:55,440
for all the processes and then determines

298
00:11:55,440 --> 00:11:58,200
with certainty the behavior time

299
00:11:58,200 --> 00:12:00,830
of completely in activity if

300
00:12:00,830 --> 00:12:04,080
basically the networks os knows

301
00:12:04,080 --> 00:12:08,400
input data and certain pockets mashed is the

302
00:12:08,400 --> 00:12:10,860
specific expiration used by all the

303
00:12:10,860 --> 00:12:13,190
keys and therefore manages to manage

304
00:12:13,190 --> 00:12:16,230
interrupt based on priorities and knows how to

305
00:12:16,230 --> 00:12:18,270
ensure that an

306
00:12:18,270 --> 00:12:22,470
activity ends on its specific expiration among

307
00:12:22,470 --> 00:12:25,490
the systems actually recognized there are

308
00:12:25,490 --> 00:12:29,370
those xd blackberry leaks works of the

309
00:12:29,370 --> 00:12:31,940
wind river system windows embedded

310
00:12:31,940 --> 00:12:35,610
now called windows aid I now

311
00:12:35,610 --> 00:12:37,500
believe that a

312
00:12:37,500 --> 00:12:42,990
linux micro kernel called rt linux last

313
00:12:42,990 --> 00:12:47,550
big block of definitions ai and o

314
00:12:47,550 --> 00:12:50,280
intelligent electronic device which

315
00:12:50,280 --> 00:12:51,570
are devices able to

316
00:12:51,570 --> 00:12:53,700
truly perform all the functions described

317
00:12:53,700 --> 00:12:55,590
so far, therefore the workings and

318
00:12:55,590 --> 00:12:59,000
control the local as well as

319
00:12:59,000 --> 00:13:00,890
the communication to

320
00:13:00,890 --> 00:13:04,340
remote devices  and fundamentally they can

321
00:13:04,340 --> 00:13:08,990
again be compared to the disp  positive aids

322
00:13:08,990 --> 00:13:10,580
here in fact I can

323
00:13:10,580 --> 00:13:11,860
easily fall into this

324
00:13:11,860 --> 00:13:17,390
categorization the d'atri storen

325
00:13:17,390 --> 00:13:21,560
last and the centralized database which

326
00:13:21,560 --> 00:13:23,330
therefore records all the information

327
00:13:23,330 --> 00:13:25,520
relating to the processes within an

328
00:13:25,520 --> 00:13:27,230
environment is guaranteed precisely

329
00:13:27,230 --> 00:13:30,140
the export of data and the collection of

330
00:13:30,140 --> 00:13:32,480
these  they are used precisely for

331
00:13:32,480 --> 00:13:33,470
the analysis of the processes

332
00:13:33,470 --> 00:13:35,510
the statistical control is the

333
00:13:35,510 --> 00:13:37,220
planning at the company level and

334
00:13:37,220 --> 00:13:39,170
whatever else is populated by the

335
00:13:39,170 --> 00:13:42,080
interfaces says never by the pm you can

336
00:13:42,080 --> 00:13:43,670
communicate directly with the scalea

337
00:13:43,670 --> 00:13:45,500
server because then it will be

338
00:13:45,500 --> 00:13:48,560
the heater seems to populate the datec history is anyway  high

339
00:13:48,560 --> 00:13:50,180
in general applicator for

340
00:13:50,180 --> 00:13:52,640
supervision etc. is the main

341
00:13:52,640 --> 00:13:55,670
reason why the control networks

342
00:13:55,670 --> 00:13:57,610
cannot be completely segregated

343
00:13:57,610 --> 00:13:59,420
from the corporate network

344
00:13:59,420 --> 00:14:02,030
basically the business part

345
00:14:02,030 --> 00:14:03,860
needs to access all this

346
00:14:03,860 --> 00:14:05,839
information to the data in history here in the

347
00:14:05,839 --> 00:14:07,850
sense there is anyway at least  a

348
00:14:07,850 --> 00:14:10,610
connection point between the corporate network

349
00:14:10,610 --> 00:14:13,130
prin  company and the part

350
00:14:13,130 --> 00:14:16,280
let's say expires for the control

351
00:14:16,280 --> 00:14:20,180
of the industry this made you escape

352
00:14:20,180 --> 00:14:22,700
ok this is a schematic example

353
00:14:22,700 --> 00:14:25,490
of all the major components listed

354
00:14:25,490 --> 00:14:27,170
so far we have precisely the control

355
00:14:27,170 --> 00:14:29,660
room with the interfaces never says that it

356
00:14:29,660 --> 00:14:31,490
goes with the airport  sherman lowe

357
00:14:31,490 --> 00:14:34,430
server card receive data from all feet on the

358
00:14:34,430 --> 00:14:36,500
field as well as from

359
00:14:36,500 --> 00:14:39,500
remote chairs from remote through

360
00:14:39,500 --> 00:14:43,010
the arts or there is a problem maybe

361
00:14:43,010 --> 00:14:46,640
we will be rue this point is a

362
00:14:46,640 --> 00:14:50,270
schematic example in architecture and in

363
00:14:50,270 --> 00:14:53,600
real life it is a little more complicated

364
00:14:53,600 --> 00:14:54,660
I do not know what we have seen,

365
00:14:54,660 --> 00:14:57,480
however, all the colored blocks are

366
00:14:57,480 --> 00:14:59,759
different components and this is a diagram

367
00:14:59,759 --> 00:15:01,860
of an electrical distribution grid

368
00:15:01,860 --> 00:15:02,879


369
00:15:02,879 --> 00:15:05,040
basically in green there are all

370
00:15:05,040 --> 00:15:08,279
the components on the custom side and all the

371
00:15:08,279 --> 00:15:13,740
digital controller part therefore

372
00:15:13,740 --> 00:15:19,529
meter thermometers and counters are  to

373
00:15:19,529 --> 00:15:21,629
say a single block or maybe thousands

374
00:15:21,629 --> 00:15:24,410
of connected devices

375
00:15:24,410 --> 00:15:29,519
ok given the ss scada

376
00:15:29,519 --> 00:15:31,100
systems are true systems  mind fragile and

377
00:15:31,100 --> 00:15:33,360
particularly sensitive so more

378
00:15:33,360 --> 00:15:34,709
just think that normal

379
00:15:34,709 --> 00:15:36,449
yen map scans can only

380
00:15:36,449 --> 00:15:38,550
leave the device if you do not pay

381
00:15:38,550 --> 00:15:42,420
particular attention obviously the

382
00:15:42,420 --> 00:15:44,519
crash of one of these devices or to

383
00:15:44,519 --> 00:15:48,480
say paralyze if we want to start the

384
00:15:48,480 --> 00:15:50,430
lights of a city rather than making sense

385
00:15:50,430 --> 00:15:53,339
other wider and

386
00:15:53,339 --> 00:15:55,199
wider-ranging infrastructures I think potentially

387
00:15:55,199 --> 00:15:57,509
paralyzing a city or a nation

388
00:15:57,509 --> 00:15:59,819
I decided in June of this year to

389
00:15:59,819 --> 00:16:01,139
carry out what is truly a

390
00:16:01,139 --> 00:16:02,899
mega survey of all the devices

391
00:16:02,899 --> 00:16:05,370
present on the network in the

392
00:16:05,370 --> 00:16:08,639
space in the Italian address space that would

393
00:16:08,639 --> 00:16:10,589
communicate with  protocols to whether

394
00:16:10,589 --> 00:16:14,279
it expires I took the balance then

395
00:16:14,279 --> 00:16:15,750
followed the protocols and following

396
00:16:15,750 --> 00:16:17,899
devices which are among the main ones

397
00:16:17,899 --> 00:16:20,160
used precisely within this

398
00:16:20,160 --> 00:16:24,509
industry and through shot z map mascal

399
00:16:24,509 --> 00:16:25,560
and so on

400
00:16:25,560 --> 00:16:27,689
or mapped all these

401
00:16:27,689 --> 00:16:30,120
ip addresses these protocols are only

402
00:16:30,120 --> 00:16:32,100
some of the most used there

403
00:16:32,100 --> 00:16:35,269
are many molt  the others

404
00:16:35,420 --> 00:16:37,500
given that substantially all of these

405
00:16:37,500 --> 00:16:39,120
protocols or most of these

406
00:16:39,120 --> 00:16:40,560
were developed in a pre

407
00:16:40,560 --> 00:16:42,630
internet era or were certainly not

408
00:16:42,630 --> 00:16:46,320
designed to be connected to an

409
00:16:46,320 --> 00:16:50,130
internet network is the main reason

410
00:16:50,130 --> 00:16:52,230
why these devices are often

411
00:16:52,230 --> 00:16:54,600
reachable and there  it can be accessed without

412
00:16:54,600 --> 00:16:58,500
authentication therefore on the basis of the

413
00:16:58,500 --> 00:17:01,470
previous filters or enumerated a total

414
00:17:01,470 --> 00:17:05,670
of 3,600 machines of which therefore 3,500 and

415
00:17:05,670 --> 00:17:08,790
univocal ip with different

416
00:17:08,790 --> 00:17:14,640
control systems are 116 p involved 116 sp

417
00:17:14,640 --> 00:17:18,630
sorry involved for 264 cities

418
00:17:18,630 --> 00:17:20,730
obviously not all these systems are

419
00:17:20,730 --> 00:17:23,190
directly connected  x industry

420
00:17:23,190 --> 00:17:25,500
or critical infrastructures because

421
00:17:25,500 --> 00:17:26,910
some of these protocols are

422
00:17:26,910 --> 00:17:29,460
used in home automation so they are the

423
00:17:29,460 --> 00:17:31,470
many of minor importance and have been

424
00:17:31,470 --> 00:17:34,710
filtered where possible and this is the

425
00:17:34,710 --> 00:17:36,630
distribution of hi sense devices

426
00:17:36,630 --> 00:17:37,860
by region

427
00:17:37,860 --> 00:17:38,880
obviously the most

428
00:17:38,880 --> 00:17:40,920
industrialized regions or with the presence  therefore on the

429
00:17:40,920 --> 00:17:42,330
territory of strong

430
00:17:42,330 --> 00:17:45,450
industrial complexes  steel mills

431
00:17:45,450 --> 00:17:46,890
petrochemical companies production lines

432
00:17:46,890 --> 00:17:49,500
etc. are more evident on

433
00:17:49,500 --> 00:17:54,570
ours and these cost the protocols to

434
00:17:54,570 --> 00:17:57,360
visit the most used mo bast is the

435
00:17:57,360 --> 00:18:00,210
master together precisely followed by fox and

436
00:18:00,210 --> 00:18:03,830
siemens which are among the

437
00:18:03,830 --> 00:18:07,010
most used devices in an industry

438
00:18:07,010 --> 00:18:09,960
among the spas precisely that  we find

439
00:18:09,960 --> 00:18:11,970
involved at least for a matter of

440
00:18:11,970 --> 00:18:13,910
historicity and of present on the territory

441
00:18:13,910 --> 00:18:18,290
we find telecom italia and

442
00:18:18,400 --> 00:18:22,190
then from the main dataset extracted a

443
00:18:22,190 --> 00:18:25,940
small sample I tried to solve

444
00:18:25,940 --> 00:18:28,700
the probable day localization of the

445
00:18:28,700 --> 00:18:31,070
hippies and the ops fought practically on

446
00:18:31,070 --> 00:18:34,670
a motorcycle useless to tell you that therefore it

447
00:18:34,670 --> 00:18:36,500
was  It is possible to find various

448
00:18:36,500 --> 00:18:39,320
colorful strange things so this system

449
00:18:39,320 --> 00:18:42,050
presents or belongs to the

450
00:18:42,050 --> 00:18:43,760
air conditioning management of a small

451
00:18:43,760 --> 00:18:47,030
shopping center rather than a

452
00:18:47,030 --> 00:18:53,480
large thermal system swimming pools spa here

453
00:18:53,480 --> 00:18:55,460
precisely the principal control various

454
00:18:55,460 --> 00:18:56,510
information from the

455
00:18:56,510 --> 00:19:00,100
water temperature to the lights and so on

456
00:19:00,100 --> 00:19:02,560
then also  some comples  I know industrial

457
00:19:02,560 --> 00:19:04,730
from which it is possible

458
00:19:04,730 --> 00:19:06,590
to possibly recover even those that are

459
00:19:06,590 --> 00:19:09,740
close to the set point of the whole

460
00:19:09,740 --> 00:19:12,580
panel possibly the location

461
00:19:12,580 --> 00:19:16,610
appropriately to the limited but precisely

462
00:19:16,610 --> 00:19:18,950
to do with a plant type also

463
00:19:18,950 --> 00:19:21,830
industrial type

464
00:19:21,830 --> 00:19:24,320
ok another aspect not to be

465
00:19:24,320 --> 00:19:27,560
underestimated when I speak  security

466
00:19:27,560 --> 00:19:29,570
in the SS field and that obviously on the

467
00:19:29,570 --> 00:19:31,850
individual that there are multiple

468
00:19:31,850 --> 00:19:36,080
services vary point from the

469
00:19:36,080 --> 00:19:39,770
criticism in http https and services

470
00:19:39,770 --> 00:19:42,500
big ncr effects of pil in more or less

471
00:19:42,500 --> 00:19:43,790
anything I can think of

472
00:19:43,790 --> 00:19:46,250
and therefore rarely all these services

473
00:19:46,250 --> 00:19:48,410
are  kept up to date not only

474
00:19:48,410 --> 00:19:49,790
as version but also as

475
00:19:49,790 --> 00:19:53,150
security did and precisely for the use of

476
00:19:53,150 --> 00:19:54,540
protocols

477
00:19:54,540 --> 00:19:57,960
that I mentioned before many of these

478
00:19:57,960 --> 00:19:59,100
devices do not

479
00:19:59,100 --> 00:20:01,310
require authentication to be able to access them

480
00:20:01,310 --> 00:20:04,740
I obviously have not tried the

481
00:20:04,740 --> 00:20:07,350
default credentials but I expect that between  these

482
00:20:07,350 --> 00:20:08,940
devices a large number that could

483
00:20:08,940 --> 00:20:11,210
also have large rooms  and by default

484
00:20:11,210 --> 00:20:15,540
ok let's talk now about the three most

485
00:20:15,540 --> 00:20:19,260
famous malware known for systems precisely

486
00:20:19,260 --> 00:20:21,980
to get out of which they were born to

487
00:20:21,980 --> 00:20:24,540
interrupt or but not to put the

488
00:20:24,540 --> 00:20:27,360
operation of one of these systems

489
00:20:27,360 --> 00:20:30,450
first of all certainly stuxnet which

490
00:20:30,450 --> 00:20:32,490
is the most famous malware for

491
00:20:32,490 --> 00:20:34,770
scale systems  initially come to the fore

492
00:20:34,770 --> 00:20:37,890
around 2010 and a malware

493
00:20:37,890 --> 00:20:40,260
thought to have been built by 26 and

494
00:20:40,260 --> 00:20:42,410
israel to stop uranium enrichment

495
00:20:42,410 --> 00:20:46,200
occurred in iran and

496
00:20:46,200 --> 00:20:49,320
initially developed as far back as

497
00:20:49,320 --> 00:20:54,510
2005 and takes at least three ex floyd zero

498
00:20:54,510 --> 00:20:57,810
days for windows both as

499
00:20:57,810 --> 00:21:00,360
attack reader that for infection and

500
00:21:00,360 --> 00:21:04,220
propagation and despite being

501
00:21:04,220 --> 00:21:08,160
incredibly capable of spreading

502
00:21:08,160 --> 00:21:10,980
and at a huge spread rate

503
00:21:10,980 --> 00:21:13,110
the miur has practically all computers

504
00:21:13,110 --> 00:21:15,990
that are not involved in the rich

505
00:21:15,990 --> 00:21:17,010
chin of the buu screams of the time

506
00:21:17,010 --> 00:21:19,770
present at startup  check the computers

507
00:21:19,770 --> 00:21:21,930
are connected or have specific software

508
00:21:21,930 --> 00:21:24,090
installed and a software

509
00:21:24,090 --> 00:21:27,390
for controlling devices jelsi

510
00:21:27,390 --> 00:21:29,820
siemens n  n the specific case of some

511
00:21:29,820 --> 00:21:31,350
models that are used

512
00:21:31,350 --> 00:21:32,400
centrifuges for uranium enrichment

513
00:21:32,400 --> 00:21:34,440
so if the computer does not

514
00:21:34,440 --> 00:21:36,299
have these characteristics, the computer

515
00:21:36,299 --> 00:21:38,370
remains fundamentally infected but the

516
00:21:38,370 --> 00:21:42,590
malware does not act on the system

517
00:21:42,590 --> 00:21:45,900
what happens if in values instead it

518
00:21:45,900 --> 00:21:47,820
finds one of the devices with  these

519
00:21:47,820 --> 00:21:49,650
characteristics

520
00:21:49,650 --> 00:21:51,000
infect it when the device is

521
00:21:51,000 --> 00:21:54,120
connected to the jazz in question the

522
00:21:54,120 --> 00:21:56,630
malware alters the programming of the yes

523
00:21:56,630 --> 00:21:59,400
so it causes the centrifuges that would

524
00:21:59,400 --> 00:22:01,140
enrich the uranium to spin

525
00:22:01,140 --> 00:22:03,270
an abnormal speed above the norm

526
00:22:03,270 --> 00:22:06,090
and therefore substantially destroy themselves

527
00:22:06,090 --> 00:22:09,390
physically in the  process losing

528
00:22:09,390 --> 00:22:12,140
moreover the enrichment of uranium it is

529
00:22:12,140 --> 00:22:14,179
difficult to make estimates

530
00:22:14,179 --> 00:22:16,409
fundamentally but it is thought that a

531
00:22:16,409 --> 00:22:18,780
fifth of the centrifuges used in

532
00:22:18,780 --> 00:22:20,429
Iran for the enrichment program

533
00:22:20,429 --> 00:22:22,500
have been destroyed precisely by this

534
00:22:22,500 --> 00:22:23,970
world,

535
00:22:23,970 --> 00:22:26,669
moreover it is difficult to identify

536
00:22:26,669 --> 00:22:29,940
this malware because in the meantime it goes

537
00:22:29,940 --> 00:22:31,799
into the  configuration that s  i also shows

538
00:22:31,799 --> 00:22:32,789
the control because it possibly

539
00:22:32,789 --> 00:22:35,730
asks that the system

540
00:22:35,730 --> 00:22:37,799
is in a normal state so if I know the

541
00:22:37,799 --> 00:22:39,240
centrifuge breaks and at least apparently

542
00:22:39,240 --> 00:22:42,240
to the operator or in the immediately visible data it

543
00:22:42,240 --> 00:22:44,429
seems that the procedure has

544
00:22:44,429 --> 00:22:47,070
been carried out correctly without

545
00:22:47,070 --> 00:22:49,039
any problem

546
00:22:49,039 --> 00:22:53,010
other malware crash override or

547
00:22:53,010 --> 00:22:55,950
industrial is a malware considered

548
00:22:55,950 --> 00:22:58,440
responsible for the blackout of kiev

549
00:22:58,440 --> 00:23:02,520
in december 2016 and previously in

550
00:23:02,520 --> 00:23:05,460
december 2015 it is a malware that cut off

551
00:23:05,460 --> 00:23:08,220
the electricity of the

552
00:23:08,220 --> 00:23:09,659
capital for at least an hour

553
00:23:09,659 --> 00:23:12,750
and despite the serious accident the

554
00:23:12,750 --> 00:23:14,880
capabilities of the  malware go much further and

555
00:23:14,880 --> 00:23:16,470
therefore it is thought that it was only

556
00:23:16,470 --> 00:23:17,260


557
00:23:17,260 --> 00:23:19,390
a show of strength basically

558
00:23:19,390 --> 00:23:23,590
of russia against the drive among

559
00:23:23,590 --> 00:23:24,910
the complexities of malware in fact

560
00:23:24,910 --> 00:23:27,640
we find the ability to remove energy

561
00:23:27,640 --> 00:23:30,850
from a substation forcing the events

562
00:23:30,850 --> 00:23:32,620
of aids landini and let's see in a moment

563
00:23:32,620 --> 00:23:35,860
what only and thus create

564
00:23:35,860 --> 00:23:37,750
margin conditions of

565
00:23:37,750 --> 00:23:39,280
visible negations  whereby the operator can no

566
00:23:39,280 --> 00:23:40,480
longer interact to say

567
00:23:40,480 --> 00:23:43,780
the Germans with the interface Iceland in

568
00:23:43,780 --> 00:23:46,270
Wales, on the other hand, are all those cases in

569
00:23:46,270 --> 00:23:48,970
which a distributed generator continues

570
00:23:48,970 --> 00:23:51,430
to power a location even when

571
00:23:51,430 --> 00:23:53,530
the distribution grid

572
00:23:53,530 --> 00:23:56,680
is disconnected and it is a problem for  at least two two

573
00:23:56,680 --> 00:23:59,020
reasons the first is that the operators who

574
00:23:59,020 --> 00:24:01,110
are eventually sent to the field

575
00:24:01,110 --> 00:24:03,550
to operate may not

576
00:24:03,550 --> 00:24:06,400
realize that a subsection section is

577
00:24:06,400 --> 00:24:08,770
still live despite the fact that

578
00:24:08,770 --> 00:24:10,410
the main energy grid is

579
00:24:10,410 --> 00:24:14,410
disconnected the second reason is that all

580
00:24:14,410 --> 00:24:16,420
these generators have

581
00:24:16,420 --> 00:24:17,980
anti aids lending

582
00:24:17,980 --> 00:24:19,120
and here in tendency they tend to

583
00:24:19,120 --> 00:24:20,950
switch off to prevent precisely these

584
00:24:20,950 --> 00:24:23,110
problems if obviously I turn off the

585
00:24:23,110 --> 00:24:25,170
world generator plus electricity to

586
00:24:25,170 --> 00:24:28,450
an entire section an entire neighborhood

587
00:24:28,450 --> 00:24:29,800
depending on how large how much

588
00:24:29,800 --> 00:24:32,110
distributed is then obviously I leave

589
00:24:32,110 --> 00:24:34,360
certain parts of the city in the dark

590
00:24:34,360 --> 00:24:39,070
it's basically it's the first

591
00:24:39,070 --> 00:24:41,110
malware  known and developed

592
00:24:41,110 --> 00:24:43,690
specifically to attack

593
00:24:43,690 --> 00:24:44,890
electricity distribution

594
00:24:44,890 --> 00:24:47,500
grids and is an extremely

595
00:24:47,500 --> 00:24:50,380
modular malware so it is able once

596
00:24:50,380 --> 00:24:53,080
connected to the network to adapt to different

597
00:24:53,080 --> 00:24:57,010
protocols download additional

598
00:24:57,010 --> 00:25:00,910
dlls and then can talk to different

599
00:25:00,910 --> 00:25:03,790
devices is another thing  that does

600
00:25:03,790 --> 00:25:06,460
and is able

601
00:25:06,460 --> 00:25:09,600
to clean up once the system is infected mark

602
00:25:09,600 --> 00:25:11,890
substantially braze the

603
00:25:11,890 --> 00:25:14,350
affected operating system in such a way as to

604
00:25:14,350 --> 00:25:16,390
cover or at least the traces at the

605
00:25:16,390 --> 00:25:19,660
end of the attack latest

606
00:25:19,660 --> 00:25:21,940
triton malware which is a malware written

607
00:25:21,940 --> 00:25:24,340
specifically for

608
00:25:24,340 --> 00:25:27,250
controllers triconex ssis controllers  and they are

609
00:25:27,250 --> 00:25:29,740
systems used for film safe

610
00:25:29,740 --> 00:25:31,810
and industrial in therefore

611
00:25:31,810 --> 00:25:33,420
emergency shodown and everything that

612
00:25:33,420 --> 00:25:36,220
substantially prevents

613
00:25:36,220 --> 00:25:38,560
physical damage to operators and / or people

614
00:25:38,560 --> 00:25:43,390
and basically the new malware is

615
00:25:43,390 --> 00:25:46,120
presumed to be Russian and the

616
00:25:46,120 --> 00:25:48,310
triconex protocol is proprietary so there is  a

617
00:25:48,310 --> 00:25:50,320
notable fort behind the development of

618
00:25:50,320 --> 00:25:51,430
this ma  lware and that's why we

619
00:25:51,430 --> 00:25:54,340
think again that it was a sponsor and

620
00:25:54,340 --> 00:25:56,530
a dance and that it is able to replicate

621
00:25:56,530 --> 00:25:59,350
the functionality of the legitimate program

622
00:25:59,350 --> 00:26:02,800
that precisely controlled the

623
00:26:02,800 --> 00:26:06,610
triconex controllers is basically able to

624
00:26:06,610 --> 00:26:08,980
read in the memory alter the values

625
00:26:08,980 --> 00:26:12,310
if bridge so on  if to say the

626
00:26:12,310 --> 00:26:14,950
target controller fails once

627
00:26:14,950 --> 00:26:18,520
after black 70 from malware and triton

628
00:26:18,520 --> 00:26:20,170
basically tries rifle share and the

629
00:26:20,170 --> 00:26:21,940
controller with a previously

630
00:26:21,940 --> 00:26:24,490
saved state where control was working

631
00:26:24,490 --> 00:26:26,410
if it is unable to recover

632
00:26:26,410 --> 00:26:29,320
control in a given timeframe the

633
00:26:29,320 --> 00:26:31,600
malo d  'bears overwrites again and

634
00:26:31,600 --> 00:26:33,280
cleans the infected system so it is

635
00:26:33,280 --> 00:26:35,260
much more complicated to trace the

636
00:26:35,260 --> 00:26:37,980
origin of the fault

637
00:26:37,980 --> 00:26:41,560
ok at this point I said to myself after

638
00:26:41,560 --> 00:26:43,750
reading about all these super malware how

639
00:26:43,750 --> 00:26:46,840
it really works you think how difficult it is

640
00:26:46,840 --> 00:26:48,160
to reverse

641
00:26:48,160 --> 00:26:49,680
engineer a protocol

642
00:26:49,680 --> 00:26:51,760
eventually  writing

643
00:26:51,760 --> 00:26:55,450
malware I have examined

644
00:26:55,450 --> 00:26:59,740
this thought but this is

645
00:26:59,740 --> 00:27:02,080
basically a version and  conomica of

646
00:27:02,080 --> 00:27:04,390
a more complicated industrial version

647
00:27:04,390 --> 00:27:06,310
and keep in mind this here costs a

648
00:27:06,310 --> 00:27:08,770
hundred euros while industry there

649
00:27:08,770 --> 00:27:11,050
ranging from thousands of euros to tens

650
00:27:11,050 --> 00:27:13,240
of thousands of euros so you understand why

651
00:27:13,240 --> 00:27:14,890
I chose this and not one that costs

652
00:27:14,890 --> 00:27:18,190
10 thousand because also because if  flash to

653
00:27:18,190 --> 00:27:20,620
say firmware at random this here is

654
00:27:20,620 --> 00:27:22,720
worried that okay you gave 100 euro are

655
00:27:22,720 --> 00:27:25,000
wrong flash only 12 thousand settlements

656
00:27:25,000 --> 00:27:28,420
also a problem foresees for the

657
00:27:28,420 --> 00:27:30,070
programming of this specific you think

658
00:27:30,070 --> 00:27:31,510
this software

659
00:27:31,510 --> 00:27:33,190
so you can program for

660
00:27:33,190 --> 00:27:36,220
block diagrams and flows and not  is to

661
00:27:36,220 --> 00:27:37,540
build by programming with no

662
00:27:37,540 --> 00:27:38,890
low-level programming language

663
00:27:38,890 --> 00:27:39,430


664
00:27:39,430 --> 00:27:43,660
so if put or absent

665
00:27:43,660 --> 00:27:46,120
ok I also imagined then to

666
00:27:46,120 --> 00:27:48,640
assign tasks to this that in

667
00:27:48,640 --> 00:27:50,740
this case our crisis will deal

668
00:27:50,740 --> 00:27:53,350
with a model assati to take as

669
00:27:53,350 --> 00:27:55,600
input let's say three elements from

670
00:27:55,600 --> 00:27:58,510
sections  different elements of the system and to mix

671
00:27:58,510 --> 00:28:01,060
these three elements together these three

672
00:28:01,060 --> 00:28:01,900
elements need them  re

673
00:28:01,900 --> 00:28:04,420
added in a specific order to

674
00:28:04,420 --> 00:28:05,680
be blended together for a

675
00:28:05,680 --> 00:28:08,740
specified as soon as possible and I have

676
00:28:08,740 --> 00:28:10,510
also added two features to

677
00:28:10,510 --> 00:28:12,960
this foot yes the first which is

678
00:28:12,960 --> 00:28:14,680
basically a possibility

679
00:28:14,680 --> 00:28:16,090
to pause the production process

680
00:28:16,090 --> 00:28:16,750


681
00:28:16,750 --> 00:28:19,450
the second is an emergency system

682
00:28:19,450 --> 00:28:22,030
then the game freezes in the

683
00:28:22,030 --> 00:28:24,310
productive state discards everything that has been

684
00:28:24,310 --> 00:28:26,530
generated up to now present the system

685
00:28:26,530 --> 00:28:28,420
obviously the

686
00:28:28,420 --> 00:28:29,820
process as an emergency process is

687
00:28:29,820 --> 00:28:31,510
not interruptible by

688
00:28:31,510 --> 00:28:34,630
the operator through the interface and goes away from the

689
00:28:34,630 --> 00:28:35,470
rest of the software

690
00:28:35,470 --> 00:28:37,420
therefore before the  completion of

691
00:28:37,420 --> 00:28:39,100
the emergency process that

692
00:28:39,100 --> 00:28:40,930
practically cleans the fish the mister

693
00:28:40,930 --> 00:28:43,690
the mix is not possible precisely

694
00:28:43,690 --> 00:28:47,320
interrupts therefore a

695
00:28:47,320 --> 00:28:50,020
high-level interface is built for

696
00:28:50,020 --> 00:28:53,940
the operator who is running

697
00:28:56,940 --> 00:29:01,210
ok always simplifies a little use

698
00:29:01,210 --> 00:29:03,520
basically instead of counting  on

699
00:29:03,520 --> 00:29:05,590
a track to the state of

700
00:29:05,590 --> 00:29:07,570
the production process on the leds accent

701
00:29:07,570 --> 00:29:09,370
on them possia  mo simply give it

702
00:29:09,370 --> 00:29:11,860
from the interface obviously a demo but

703
00:29:11,860 --> 00:29:16,660
we will need it for later ok the ps

704
00:29:16,660 --> 00:29:18,940
in question communicates with the software

705
00:29:18,940 --> 00:29:22,390
for programming or with any

706
00:29:22,390 --> 00:29:24,790
other program that wants to query it

707
00:29:24,790 --> 00:29:26,800
through a specific

708
00:29:26,800 --> 00:29:28,960
protocol the boss mode protocol as we have

709
00:29:28,960 --> 00:29:30,970
seen previously low modes and one  of

710
00:29:30,970 --> 00:29:33,220
the most used protocols

711
00:29:33,220 --> 00:29:36,820
within systems and scale was

712
00:29:36,820 --> 00:29:40,570
developed mainly in 1980 and

713
00:29:40,570 --> 00:29:42,790
became open source in early

714
00:29:42,790 --> 00:29:47,950
2010 modbus works with this

715
00:29:47,950 --> 00:29:51,790
master and slay concept so the master communicates

716
00:29:51,790 --> 00:29:54,490
with the device in the field by mass

717
00:29:54,490 --> 00:29:57,250
we can therefore  understand the tv or she

718
00:29:57,250 --> 00:30:00,070
is never there and communicated with devices

719
00:30:00,070 --> 00:30:02,170
in the field then artour or prices

720
00:30:02,170 --> 00:30:05,140
directly and the master is interrogating

721
00:30:05,140 --> 00:30:07,660
the station and field device

722
00:30:07,660 --> 00:30:09,160
again can never start the

723
00:30:09,160 --> 00:30:11,020
communication the protocol a

724
00:30:11,020 --> 00:30:12,340
very simple protocol therefore

725
00:30:12,340 --> 00:30:14,560
request for an answer however there  are other

726
00:30:14,560 --> 00:30:18,370
wayne sheikhs or other and when it was

727
00:30:18,370 --> 00:30:21,760
developed fashions  bas the security has not

728
00:30:21,760 --> 00:30:23,590
been taken into consideration by the

729
00:30:23,590 --> 00:30:26,290
part of the initial design so low modes it

730
00:30:26,290 --> 00:30:28,650
is possible to communicate through

731
00:30:28,650 --> 00:30:31,720
precisely those devices without any

732
00:30:31,720 --> 00:30:35,800
type of authentication and also

733
00:30:35,800 --> 00:30:37,510
precisely mo bast supports that this

734
00:30:37,510 --> 00:30:40,390
concept of master and slayer up to 247

735
00:30:40,390 --> 00:30:43,320
connected devices

736
00:30:43,320 --> 00:30:47,260
ok few  changes as I said

737
00:30:47,260 --> 00:30:49,870
the sashall heidi trend and we

738
00:30:49,870 --> 00:30:51,970
only need to synchronize the

739
00:30:51,970 --> 00:30:54,690
messages received from the offline

740
00:30:54,690 --> 00:30:58,240
or master server desire in this case the

741
00:30:58,240 --> 00:30:59,800
protocol and in this case everything is

742
00:30:59,800 --> 00:31:01,900
set to zero so that it is enough

743
00:31:01,900 --> 00:31:04,840
if there was a low of power  in greenhouses more

744
00:31:04,840 --> 00:31:08,620
landfill would vary than simply a

745
00:31:08,620 --> 00:31:10,990
count of the bytes remaining in this

746
00:31:10,990 --> 00:31:14,320
frame loew maggie which is basically

747
00:31:14,320 --> 00:31:16,330
the indie of the station we

748
00:31:16,330 --> 00:31:18,220
want to talk to so in this case it

749
00:31:18,220 --> 00:31:20,320
was at 1 we will speak with the slang number

750
00:31:20,320 --> 00:31:24,670
170 255 if it is not if  we do not use

751
00:31:24,670 --> 00:31:28,900
practically is the slider res then belly

752
00:31:28,900 --> 00:31:29,410
the goal

753
00:31:29,410 --> 00:31:32,620
and the data relating to the function what

754
00:31:32,620 --> 00:31:35,320
allows  te di fare mode mas donnas

755
00:31:35,320 --> 00:31:37,950
basically allows rhythm bright and

756
00:31:37,950 --> 00:31:41,410
in this specific concert of

757
00:31:41,410 --> 00:31:44,800
low modes it is referred to coils and

758
00:31:44,800 --> 00:31:47,380
all digital outputs heard while

759
00:31:47,380 --> 00:31:50,040


760
00:31:50,040 --> 00:31:53,879
16 bit analog input and output registers are defined

761
00:31:53,910 --> 00:31:57,070
ok this is an example of le and is a

762
00:31:57,070 --> 00:32:01,210
example of mike so to say give you

763
00:32:01,210 --> 00:32:03,700
skyteam input from a specific dress

764
00:32:03,700 --> 00:32:05,710
present on the device for a

765
00:32:05,710 --> 00:32:10,930
certain number of hands this

766
00:32:10,930 --> 00:32:13,480
note is instead the methodology that I have

767
00:32:13,480 --> 00:32:16,150
chosen to follow to analyze the

768
00:32:16,150 --> 00:32:19,120
virus in question the first of all

769
00:32:19,120 --> 00:32:20,380
the first point was l  '

770
00:32:20,380 --> 00:32:23,050
functional analysis then I recovered all

771
00:32:23,050 --> 00:32:24,940
the ardor in question the software

772
00:32:24,940 --> 00:32:26,020
connected to it

773
00:32:26,020 --> 00:32:27,940
the driver the development tools and

774
00:32:27,940 --> 00:32:30,400
cash the purpose was to make the

775
00:32:30,400 --> 00:32:32,860
first connection then use the

776
00:32:32,860 --> 00:32:35,140
available interfaces in such a way as an

777
00:32:35,140 --> 00:32:38,020
operator basically map the

778
00:32:38,020 --> 00:32:39,490
functions carry out the first

779
00:32:39,490 --> 00:32:40,830
configuration

780
00:32:40,830 --> 00:32:43,360
l  'goal is to identify all

781
00:32:43,360 --> 00:32:45,720
the high-risk features

782
00:32:45,720 --> 00:32:48,210
you think or tut  te those features that

783
00:32:48,210 --> 00:32:50,360
are present without authentication or

784
00:32:50,360 --> 00:32:52,410
any other you can also precisely it

785
00:32:52,410 --> 00:32:55,920
is worth investigating the successions

786
00:32:55,920 --> 00:32:58,410
in our case but it is writable and

787
00:32:58,410 --> 00:33:00,690
without any authentication as well

788
00:33:00,690 --> 00:33:02,880
as readable without the indication it is

789
00:33:02,880 --> 00:33:04,710
possible to flash the firmware even by

790
00:33:04,710 --> 00:33:06,060
performing a grade is the  the only

791
00:33:06,060 --> 00:33:08,070
check that is done is that the

792
00:33:08,070 --> 00:33:09,180
version you are already trying to

793
00:33:09,180 --> 00:33:13,500
flash is different from the one already

794
00:33:13,500 --> 00:33:15,120
present so regardless of

795
00:33:15,120 --> 00:33:17,880
what the number of versions is, the same thing

796
00:33:17,880 --> 00:33:20,160
applies to the program that will then run on the

797
00:33:20,160 --> 00:33:22,550
controller

798
00:33:22,550 --> 00:33:25,470
other common point 10 to capture then

799
00:33:25,470 --> 00:33:27,690
take  of the communication samples

800
00:33:27,690 --> 00:33:30,030
between the device or the devices and

801
00:33:30,030 --> 00:33:31,700
software

802
00:33:31,700 --> 00:33:34,560
this here then get an always

803
00:33:34,560 --> 00:33:35,850
of the communication for all the

804
00:33:35,850 --> 00:33:37,290
functionalities of the device

805
00:33:37,290 --> 00:33:38,850
specifically for all the

806
00:33:38,850 --> 00:33:40,970
high risk functionalities

807
00:33:40,970 --> 00:33:43,170
initially then I used a

808
00:33:43,170 --> 00:33:45,800
software that a client for mode was

809
00:33:45,800 --> 00:33:49,680
modbus pole for  to be able to execute

810
00:33:49,680 --> 00:33:52,650
simple rh lines  ythm bright on the

811
00:33:52,650 --> 00:33:58,410
various coins of the thesis subsequently

812
00:33:58,410 --> 00:34:00,780
so I realized in reality

813
00:34:00,780 --> 00:34:02,400
that once the team drivers are installed

814
00:34:02,400 --> 00:34:04,350
the virtual serial port is created

815
00:34:04,350 --> 00:34:07,770
and then with this

816
00:34:07,770 --> 00:34:11,340
software called device monitor studio

817
00:34:11,340 --> 00:34:12,920
we can again go and analyze

818
00:34:12,920 --> 00:34:14,969
the  communication that takes place through

819
00:34:14,969 --> 00:34:17,639
usb or through this serial force

820
00:34:17,639 --> 00:34:18,780
alternatively it is possible to use

821
00:34:18,780 --> 00:34:24,530
wireshark with usd pick up

822
00:34:24,620 --> 00:34:26,909
third point an analysis of the

823
00:34:26,909 --> 00:34:29,790
communication then understand and map the

824
00:34:29,790 --> 00:34:32,540
commands to the packets that has been registered

825
00:34:32,540 --> 00:34:35,639
understand the structure of the packets and

826
00:34:35,639 --> 00:34:37,770
therefore be able to  replicate the

827
00:34:37,770 --> 00:34:39,719
functionalities without going from

828
00:34:39,719 --> 00:34:41,420
development software

829
00:34:41,420 --> 00:34:44,940
ok our pil think about it

830
00:34:44,940 --> 00:34:47,909
specifically communicates via modbus

831
00:34:47,909 --> 00:34:49,830
with a payload

832
00:34:49,830 --> 00:34:53,739
so it is slightly varied compared

833
00:34:53,739 --> 00:34:57,010
to the initial low mode again very

834
00:34:57,010 --> 00:34:59,260
similar of units and therefore for the new one

835
00:34:59,260 --> 00:35:01,600
for the slam we are in  giving speak to the

836
00:35:01,600 --> 00:35:02,920
function cod

837
00:35:02,920 --> 00:35:05,470
the data relating to the function that

838
00:35:05,470 --> 00:35:07,840
is copied  ati in response to the command

839
00:35:07,840 --> 00:35:10,930
that is executed is a search and final

840
00:35:10,930 --> 00:35:13,420
for the control of the data between the

841
00:35:13,420 --> 00:35:15,820
functions again this there are taken

842
00:35:15,820 --> 00:35:16,960
from the development software

843
00:35:16,960 --> 00:35:18,700
are some of the features that the

844
00:35:18,700 --> 00:35:20,560
parent I know the foot would not make

845
00:35:20,560 --> 00:35:22,030
available through its

846
00:35:22,030 --> 00:35:23,860
interface but going to

847
00:35:23,860 --> 00:35:25,870
practically sniff the traffic between the

848
00:35:25,870 --> 00:35:27,610
development software and dense it is possible to

849
00:35:27,610 --> 00:35:29,200
recover to say the possibility of

850
00:35:29,200 --> 00:35:31,900
entering the bubble rather than

851
00:35:31,900 --> 00:35:35,380
other features with the function

852
00:35:35,380 --> 00:35:37,960
category f1 all the

853
00:35:37,960 --> 00:35:40,270
normal commands are present therefore related

854
00:35:40,270 --> 00:35:43,750
to the software interface in  f zero

855
00:35:43,750 --> 00:35:45,370
we find the possibility to

856
00:35:45,370 --> 00:35:47,830
enter the park mode and in fact

857
00:35:47,830 --> 00:35:50,110
to say the status command there are

858
00:35:50,110 --> 00:35:51,520
commands that are used to check the

859
00:35:51,520 --> 00:35:53,920
status of the pen they are normally used

860
00:35:53,920 --> 00:35:57,340
during the firmware flash and so

861
00:35:57,340 --> 00:36:01,960
broadly ok one of the last points of the

862
00:36:01,960 --> 00:36:05,050
our analysis then impersonate

863
00:36:05,050 --> 00:36:07,180
the interface the goal then now

864
00:36:07,180 --> 00:36:08,980
and having understood what the protocol is c  he

865
00:36:08,980 --> 00:36:11,230
uses having understood what are the

866
00:36:11,230 --> 00:36:13,630
features that interest us to be able

867
00:36:13,630 --> 00:36:14,950
to build some type of

868
00:36:14,950 --> 00:36:17,290
software and that can speak

869
00:36:17,290 --> 00:36:20,130
autonomously with our thinking

870
00:36:20,130 --> 00:36:23,560
exploitation because making it possible

871
00:36:23,560 --> 00:36:25,780
to verify our hypotheses

872
00:36:25,780 --> 00:36:30,220
with a first functional scholes so

873
00:36:30,220 --> 00:36:32,740
I said very well how difficult it can

874
00:36:32,740 --> 00:36:35,080
be  build a script

875
00:36:35,080 --> 00:36:37,570
that now that I know the

876
00:36:37,570 --> 00:36:40,000
team's communication mechanism is set to

877
00:36:40,000 --> 00:36:41,650
say activate our

878
00:36:41,650 --> 00:36:44,500
emergency system that if you remember

879
00:36:44,500 --> 00:36:46,390
at the beginning it discards practically the whole

880
00:36:46,390 --> 00:36:49,270
production process easier than

881
00:36:49,270 --> 00:36:51,130
expected in reality baita di to say

882
00:36:51,130 --> 00:36:54,250
puts to  I have a module that goes

883
00:36:54,250 --> 00:36:57,700
like a boss and a few lines of

884
00:36:57,700 --> 00:36:58,990
code are enough

885
00:36:58,990 --> 00:37:01,660
basically so in bright precisely

886
00:37:01,660 --> 00:37:05,920
on the specific is a third are in

887
00:37:05,920 --> 00:37:08,290
this case in the three requests one to

888
00:37:08,290 --> 00:37:11,020
check the status of the GDP yes then

889
00:37:11,020 --> 00:37:12,400
in which we are going to verify that the

890
00:37:12,400 --> 00:37:15,040
choice process  an emergency

891
00:37:15,040 --> 00:37:18,190
is not already not 6 Jan running the s  second

892
00:37:18,190 --> 00:37:20,380
that activates it and the third to check

893
00:37:20,380 --> 00:37:22,780
again that the smooth dow state

894
00:37:22,780 --> 00:37:25,620
is now active

895
00:37:25,840 --> 00:37:28,870
ok a little while now let's see if the

896
00:37:28,870 --> 00:37:43,259
demon god assist does not assist me

897
00:37:48,359 --> 00:37:51,180
deceased line yes

898
00:37:51,180 --> 00:37:55,600
head of the table test in fact you have it

899
00:37:55,600 --> 00:37:59,140
public screen stand there is none  they have been

900
00:37:59,140 --> 00:37:59,770
freezing

901
00:37:59,770 --> 00:38:03,810
now the same at least he sees the screen

902
00:38:07,260 --> 00:38:10,650
as he said

903
00:38:14,720 --> 00:38:17,290
ok

904
00:38:32,800 --> 00:38:36,420
ok so our foot is turning

905
00:38:36,420 --> 00:38:40,150
you will not see the status of the LEDs but

906
00:38:40,150 --> 00:38:42,880
maybe the first rows yes so if now

907
00:38:42,880 --> 00:38:45,840
active

908
00:38:58,260 --> 00:39:02,220
ok and in this case

909
00:39:02,220 --> 00:39:14,880
the show down is run  emergency so

910
00:39:14,880 --> 00:39:17,570
you all see it

911
00:39:19,450 --> 00:39:22,060
ok this here simply what

912
00:39:22,060 --> 00:39:24,850
I saw on the terminal since it is a

913
00:39:24,850 --> 00:39:31,150
bit limited this perfect theme so

914
00:39:31,150 --> 00:39:34,000
if I haven't made you all

915
00:39:34,000 --> 00:39:37,000
completely sleepy if you have questions just

916
00:39:37,000 --> 00:39:38,770
if you are not free later

917
00:39:38,770 --> 00:39:41,020
or send me  an email if you would like to

918
00:39:41,020 --> 00:39:43,290
know more

919
00:39:58,520 --> 00:40:01,770
from today is not about the door with the

920
00:40:01,770 --> 00:40:05,280
rightly low wind women's costumes

921
00:40:05,280 --> 00:40:07,950
considering the statistics there

922
00:40:07,950 --> 00:40:11,480
including not to fear the indication  and

923
00:40:14,050 --> 00:40:16,849
with the experience instead that there are

924
00:40:16,849 --> 00:40:20,500
players how is it possible that the

925
00:40:20,500 --> 00:40:28,040
south low direction there are other

926
00:40:28,040 --> 00:40:29,599
protocols which instead foresees precisely

927
00:40:29,599 --> 00:40:32,450
users cation between the master basket

928
00:40:32,450 --> 00:40:34,730
and the slide our problem again and

929
00:40:34,730 --> 00:40:36,410
that basically a key to

930
00:40:36,410 --> 00:40:38,930
shared therefore it is  find both on the

931
00:40:38,930 --> 00:40:41,329
master and a slay and depending on

932
00:40:41,329 --> 00:40:44,059
how much physical access rather than what

933
00:40:44,059 --> 00:40:45,950
network means it is

934
00:40:45,950 --> 00:40:49,839
possible to capture this key

935
00:40:51,490 --> 00:40:53,750
basically on these devices

936
00:40:53,750 --> 00:40:57,410
here born in this way if then in the

937
00:40:57,410 --> 00:40:59,660
firmware and subsequent updates

938
00:40:59,660 --> 00:41:01,250
possibly depending on which model

939
00:41:01,250 --> 00:41:03,140
specific to which we speak it is possible that they

940
00:41:03,140 --> 00:41:05,990
are envious of the other protocols or

941
00:41:05,990 --> 00:41:08,359
of the modifications to the protocol itself

942
00:41:08,359 --> 00:41:10,670
the nativity that they have integrated you with

943
00:41:10,670 --> 00:41:13,160
similar basic purification in the

944
00:41:13,160 --> 00:41:15,319
very must basic sense as it is does not

945
00:41:15,319 --> 00:41:23,960
provide for adapting to these securities

946
00:41:23,960 --> 00:41:33,559
security what type of investment does not

947
00:41:33,559 --> 00:41:35,299
it is exact it would be necessary to review

948
00:41:35,299 --> 00:41:36,799
the architecture of one of the m

949
00:41:36,799 --> 00:41:39,230
main reasons why this sector in

950
00:41:39,230 --> 00:41:42,530
particular is quite behind let's say

951
00:41:42,530 --> 00:41:45,500
with the more traditional safety and

952
00:41:45,500 --> 00:41:47,270
where in reality in the sense there is

953
00:41:47,270 --> 00:41:49,250
convergence between those that are the

954
00:41:49,250 --> 00:41:51,109
production processes and the part let's say

955
00:41:51,109 --> 00:41:52,849
iti because obviously you are taking them

956
00:41:52,849 --> 00:41:55,910
check follow the part but points

957
00:41:55,910 --> 00:41:59,599
production processes that absurdly is the

958
00:41:59,599 --> 00:42:00,980
one that maintains intellectual piety

959
00:42:00,980 --> 00:42:02,990
and also the least

960
00:42:02,990 --> 00:42:05,329
protected part a little man of the company precisely

961
00:42:05,329 --> 00:42:07,730
because it is linked to these software

962
00:42:07,730 --> 00:42:09,460
rather than to these devices,

963
00:42:09,460 --> 00:42:11,450
possibly old at least in

964
00:42:11,450 --> 00:42:14,170
conception

965
00:42:14,170 --> 00:42:17,710
, the industrial part that tries not to

966
00:42:17,710 --> 00:42:20,550
walk and the  another attacker because

967
00:42:20,550 --> 00:42:25,930
you are current context in a simple way

968
00:42:25,930 --> 00:42:31,390
no then there are specific flyers that

969
00:42:31,390 --> 00:42:33,930
act as a firewall on which the protocols

970
00:42:33,930 --> 00:42:36,390
used in the industrial field

971
00:42:36,390 --> 00:42:38,530
but obviously are third-party solutions

972
00:42:38,530 --> 00:42:41,369
in the sense that

