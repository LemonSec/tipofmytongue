1
00:00:04,040 --> 00:00:06,240
and well hello to all I hope you

2
00:00:06,240 --> 00:00:08,280
ate well so as he said

3
00:00:08,280 --> 00:00:10,019
we are going to make you two subjects for the

4
00:00:10,019 --> 00:00:11,820
price of one so first we

5
00:00:11,820 --> 00:00:14,639
are going to tell you about what CSP is and

6
00:00:14,639 --> 00:00:16,139
how it  introduce into a

7
00:00:16,139 --> 00:00:19,560
rather large ecosystem then a little anecdote

8
00:00:19,560 --> 00:00:22,199
about an XS that we came across and

9
00:00:22,199 --> 00:00:24,060
how we managed to exploit it despite

10
00:00:24,060 --> 00:00:26,760
a CSP that was already in place

11
00:00:26,760 --> 00:00:28,320
so I'll start by introducing myself my

12
00:00:28,320 --> 00:00:30,180
name is Kevin giroudj I  come from the south

13
00:00:30,180 --> 00:00:31,460
of France

14
00:00:31,460 --> 00:00:33,960
for me it's going to be a bit of a first it's

15
00:00:33,960 --> 00:00:35,460
my first talk it's been

16
00:00:35,460 --> 00:00:37,739
a year since I graduated I

17
00:00:37,739 --> 00:00:39,420
work at Claude bise more

18
00:00:39,420 --> 00:00:41,700
precisely in the security team which

19
00:00:41,700 --> 00:00:44,660
will be in charge of Jenkins and this  plugin

20
00:00:44,660 --> 00:00:47,160
so I hope you'll like it and

21
00:00:47,160 --> 00:00:50,180
that I won't be too stressed

22
00:00:50,899 --> 00:00:53,399
hello to all Patrick foulonnier so

23
00:00:53,399 --> 00:00:55,199
I am the official security of the

24
00:00:55,199 --> 00:00:56,460
Jenkins project for the

25
00:00:56,460 --> 00:00:59,460
community part and also manager of the

26
00:00:59,460 --> 00:01:01,320
Claude bise side by managing a security team

27
00:01:01,320 --> 00:01:03,539
where to work Kevin as well as another

28
00:01:03,539 --> 00:01:04,860
team for pure development in addition

29
00:01:04,860 --> 00:01:06,780
I have been with Claude bis for 5 years

30
00:01:06,780 --> 00:01:09,240
more or less I then go I come

31
00:01:09,240 --> 00:01:12,240
from Switzerland and for the little anecdote the

32
00:01:12,240 --> 00:01:13,619
difference between the community

33
00:01:13,619 --> 00:01:15,479
and owner side and something that  is

34
00:01:15,479 --> 00:01:17,040
very often the subject of debate

35
00:01:17,040 --> 00:01:19,260
discussions normally for the

36
00:01:19,260 --> 00:01:20,520
presentation there should be no

37
00:01:20,520 --> 00:01:21,960
problem if you have any questions

38
00:01:21,960 --> 00:01:23,460
also in relation to this kind of thing

39
00:01:23,460 --> 00:01:25,020
do not hesitate to come and see us again afterwards

40
00:01:25,020 --> 00:01:27,840
it is a fairly recurring subject so don't

41
00:01:27,840 --> 00:01:29,100
worry  no

42
00:01:29,100 --> 00:01:33,000
so thank you the word CSP good

43
00:01:33,000 --> 00:01:34,920
luck

44
00:01:34,920 --> 00:01:36,720
so we started with a little intro

45
00:01:36,720 --> 00:01:38,640
of what the CST is so CSP it's

46
00:01:38,640 --> 00:01:40,680
for police security content in

47
00:01:40,680 --> 00:01:42,840
fact it's going to be a

48
00:01:42,840 --> 00:01:44,700
protection mechanism that will be mainly

49
00:01:44,700 --> 00:01:46,740
used  to prevent

50
00:01:46,740 --> 00:01:49,380
XSS type vulnerabilities so it's going to be all that

51
00:01:49,380 --> 00:01:51,600
is injection that will allow to leave

52
00:01:51,600 --> 00:01:53,220
or not a context to execute

53
00:01:53,220 --> 00:01:54,720
JavaScript

54
00:01:54,720 --> 00:01:56,460
the CSP it's going to be a mechanism that will

55
00:01:56,460 --> 00:01:58,200
try to reduce the attack surface

56
00:01:58,200 --> 00:02:00,840
of the exercises  in the best possible way

57
00:02:00,840 --> 00:02:02,360
in fact and reduce the impact or even

58
00:02:02,360 --> 00:02:04,500
nullify the impact

59
00:02:04,500 --> 00:02:06,899
it's not only that the CP it will

60
00:02:06,899 --> 00:02:09,419
also be a way to

61
00:02:09,419 --> 00:02:11,459
define with rules each resource

62
00:02:11,459 --> 00:02:14,940
how to load them so if the resource

63
00:02:14,940 --> 00:02:16,500
is not  loaded according to the

64
00:02:16,500 --> 00:02:18,440
defined rules we will prevent its loading

65
00:02:18,440 --> 00:02:20,340
after what should also be noted is

66
00:02:20,340 --> 00:02:22,520
that you have there is a report only mode

67
00:02:22,520 --> 00:02:26,760
so it will not necessarily block the

68
00:02:26,760 --> 00:02:28,200
loading of the data just give you

69
00:02:28,200 --> 00:02:30,180
a little warning in you  specifying

70
00:02:30,180 --> 00:02:32,099
perhaps give has been loaded in the

71
00:02:32,099 --> 00:02:34,920
wrong way without respecting your CSP

72
00:02:34,920 --> 00:02:37,260
the CSP will generally be defined

73
00:02:37,260 --> 00:02:39,840
in the header of the HTTP response

74
00:02:39,840 --> 00:02:41,640
but not only it can also be

75
00:02:41,640 --> 00:02:43,019
done directly in the pages

76
00:02:43,019 --> 00:02:45,900
through the tag  meta what you

77
00:02:45,900 --> 00:02:48,180
have to remember is that the CSP is

78
00:02:48,180 --> 00:02:50,340
not going to be a total defense against

79
00:02:50,340 --> 00:02:52,080
the exercise it's not because we put a

80
00:02:52,080 --> 00:02:54,180
CSP in place that we have to completely

81
00:02:54,180 --> 00:02:55,920
stop escaping all our variables

82
00:02:55,920 --> 00:02:57,480
we have to continue to protect ourselves it's

83
00:02:57,480 --> 00:02:59,580
just reducing the impact it's going to be an

84
00:02:59,580 --> 00:03:01,620
additional layer of security to

85
00:03:01,620 --> 00:03:03,080
really avoid,

86
00:03:03,080 --> 00:03:06,060
despite a hole in our security,

87
00:03:06,060 --> 00:03:10,739
having the SS with an impact

88
00:03:10,739 --> 00:03:12,000
so I'm going to explain to you now

89
00:03:12,000 --> 00:03:15,560
the directives the directives that  going to be

90
00:03:15,560 --> 00:03:19,860
the type of resources we are going to load I do

91
00:03:19,860 --> 00:03:21,440
n't want to specify yet how we

92
00:03:21,440 --> 00:03:23,879
define the loading or not of its

93
00:03:23,879 --> 00:03:26,300
resources and just the type so the

94
00:03:26,300 --> 00:03:28,440
main ones that interest us it's going

95
00:03:28,440 --> 00:03:30,720
to be source script so it's going to be everything

96
00:03:30,720 --> 00:03:32,879
that will execute  javascript so

97
00:03:32,879 --> 00:03:34,260
in the example that I put for you it will

98
00:03:34,260 --> 00:03:34,940
be

99
00:03:34,940 --> 00:03:37,140
relativescript but not only it

100
00:03:37,140 --> 00:03:39,060
can be all the

101
00:03:39,060 --> 00:03:41,099
onclick and CETA ventenders everything that will

102
00:03:41,099 --> 00:03:43,260
already excite sneakers the same for source image

103
00:03:43,260 --> 00:03:45,000
this time it will be everything that will

104
00:03:45,000 --> 00:03:47,040
load  images not only the

105
00:03:47,040 --> 00:03:50,400
images tag but also for example for

106
00:03:50,400 --> 00:03:52,379
CSS if I try to load in the

107
00:03:52,379 --> 00:03:55,739
background a URL to an image

108
00:03:55,739 --> 00:03:57,599
if it is not in my CSP it will be

109
00:03:57,599 --> 00:04:00,780
blocked and the same for frame source which

110
00:04:00,780 --> 00:04:02,599
will be the  ifray tags and my

111
00:04:02,599 --> 00:04:07,200
media frames it's going to be audio and video etc if

112
00:04:07,200 --> 00:04:09,180
you

113
00:04:09,180 --> 00:04:11,099
have a fairly important directive it's

114
00:04:11,099 --> 00:04:13,140
the source faults directive in fact

115
00:04:13,140 --> 00:04:15,180
it's going to be the fullback for our other

116
00:04:15,180 --> 00:04:17,279
directives that is to say that if I do

117
00:04:17,279 --> 00:04:19,500
n't specify  we will return to the one

118
00:04:19,500 --> 00:04:21,779
defined by our source defol so if

119
00:04:21,779 --> 00:04:23,940
we take an example in our CSP we

120
00:04:23,940 --> 00:04:25,500
define an anon source defeat so

121
00:04:25,500 --> 00:04:27,300
that is to say we do not allow anything to

122
00:04:27,300 --> 00:04:29,340
change it would be the equivalent of saying

123
00:04:29,340 --> 00:04:31,560
that all our other script directives

124
00:04:31,560 --> 00:04:33,960
source image source frame source etc

125
00:04:33,960 --> 00:04:35,820
Santana

126
00:04:35,820 --> 00:04:37,560
but what you have to see is that it's

127
00:04:37,560 --> 00:04:40,380
not hereditary either, it's not because

128
00:04:40,380 --> 00:04:42,600
I defined an anone source default

129
00:04:42,600 --> 00:04:45,540
that another directive will be

130
00:04:45,540 --> 00:04:47,280
specified so  for example source script

131
00:04:47,280 --> 00:04:51,020
I define to self so my application

132
00:04:51,419 --> 00:04:53,040
will inherit one that is if it is not

133
00:04:53,040 --> 00:04:54,380
defined

134
00:04:54,380 --> 00:04:56,699
it will fetch the directive that

135
00:04:56,699 --> 00:04:59,220
is defined on photos

136
00:04:59,220 --> 00:05:03,780
after that is not we will say the only one there

137
00:05:03,780 --> 00:05:05,520
is  exceptions there are small

138
00:05:05,520 --> 00:05:07,440
families finally in this source clip there are

139
00:05:07,440 --> 00:05:09,120
lower directives we are not going to

140
00:05:09,120 --> 00:05:10,320
approach because it is not really what

141
00:05:10,320 --> 00:05:12,419
interests us here now which

142
00:05:12,419 --> 00:05:14,580
will relate to what is source if

143
00:05:14,580 --> 00:05:16,380
they are defined  but these are not

144
00:05:16,380 --> 00:05:17,880
defined they will go back to

145
00:05:17,880 --> 00:05:20,240
crazy sources

146
00:05:20,340 --> 00:05:22,380
so generally when we talk about CSP

147
00:05:22,380 --> 00:05:26,820
we think of the XS it's the major impact I

148
00:05:26,820 --> 00:05:28,500
repeat it's not the only one but it's

149
00:05:28,500 --> 00:05:30,180
the one we think of

150
00:05:30,180 --> 00:05:32,699
in our  presentation we are

151
00:05:32,699 --> 00:05:35,639
really going to focus on this point so

152
00:05:35,639 --> 00:05:37,340
everything related to JavaScript

153
00:05:37,340 --> 00:05:39,840
more precisely it will be the

154
00:05:39,840 --> 00:05:42,679
source script directive

155
00:05:43,320 --> 00:05:45,000
we could also have talked about everything related to

156
00:05:45,000 --> 00:05:47,759
CSS injection it can be

157
00:05:47,759 --> 00:05:50,699
interesting but to our knowledge it is

158
00:05:50,699 --> 00:05:52,919
not the same  physical impact that 16 so

159
00:05:52,919 --> 00:05:54,900
we're going to try to stay rather broad

160
00:05:54,900 --> 00:05:56,820
so I'm not saying that it's not a

161
00:05:56,820 --> 00:05:58,919
vulnerability from what we know we can

162
00:05:58,919 --> 00:06:00,660
do minitoring activity so

163
00:06:00,660 --> 00:06:02,160
really know when do we

164
00:06:02,160 --> 00:06:04,500
access such  page we can of course

165
00:06:04,500 --> 00:06:07,199
touch the integrity of the page but we

166
00:06:07,199 --> 00:06:09,479
can also even extract data a

167
00:06:09,479 --> 00:06:11,699
CSRF token or whatever so it

168
00:06:11,699 --> 00:06:12,840
remains important but it is not what we

169
00:06:12,840 --> 00:06:15,560
decided to address today

170
00:06:15,560 --> 00:06:17,820
so for everything that is

171
00:06:17,820 --> 00:06:19,740
javascript script there are going to be different

172
00:06:19,740 --> 00:06:22,979
ways to approve or not our script

173
00:06:22,979 --> 00:06:26,400
so we can use no it's going to be a

174
00:06:26,400 --> 00:06:28,340
character string which

175
00:06:28,340 --> 00:06:30,900
and generate randomly and for single use

176
00:06:30,900 --> 00:06:32,639


177
00:06:32,639 --> 00:06:34,580
so we're going to define it in our

178
00:06:34,580 --> 00:06:37,740
CSP and  all the skips that have defined

179
00:06:37,740 --> 00:06:39,240
our character string in the same way

180
00:06:39,240 --> 00:06:40,919
will be authorized to be

181
00:06:40,919 --> 00:06:42,360
loaded so if I show you an

182
00:06:42,360 --> 00:06:44,940
example in our CSP we specify that

183
00:06:44,940 --> 00:06:46,319
it is a spear we put the

184
00:06:46,319 --> 00:06:48,419
character string and in the script we add

185
00:06:48,419 --> 00:06:50,160
a  attribute no where we will be able to define

186
00:06:50,160 --> 00:06:51,180
this character string again

187
00:06:51,180 --> 00:06:53,220
we can make several

188
00:06:53,220 --> 00:06:57,120
scripts with the same launch so just a

189
00:06:57,120 --> 00:06:58,979
precedent once in the in the CSP

190
00:06:58,979 --> 00:07:01,319
it will authorize it everywhere

191
00:07:01,319 --> 00:07:03,539
afterwards we still have to be careful

192
00:07:03,539 --> 00:07:05,400
that  our name is generated

193
00:07:05,400 --> 00:07:07,500
randomly so really with a

194
00:07:07,500 --> 00:07:09,380
viable enterprise because if we manage to

195
00:07:09,380 --> 00:07:12,960
reproduce our character string it

196
00:07:12,960 --> 00:07:14,400
would not be in the same interest

197
00:07:14,400 --> 00:07:15,900
it must be really single use if

198
00:07:15,900 --> 00:07:16,919
it is fixed we could just

199
00:07:16,919 --> 00:07:18,780
reload the page each time  and

200
00:07:18,780 --> 00:07:20,039
put it back and validate any

201
00:07:20,039 --> 00:07:21,780
script so if there is an attacker who manages

202
00:07:21,780 --> 00:07:24,240
to inject HTML and who feels his own

203
00:07:24,240 --> 00:07:27,120
script he could very easily

204
00:07:27,120 --> 00:07:29,580
add the tribe

205
00:07:29,580 --> 00:07:30,740
we also have

206
00:07:30,740 --> 00:07:33,660
the H that we can use sometimes we don't  we do

207
00:07:33,660 --> 00:07:36,840
n't have control over our tagscript we do

208
00:07:36,840 --> 00:07:37,860
n't have the right to write on it so

209
00:07:37,860 --> 00:07:40,139
adding the tribe no it won't be

210
00:07:40,139 --> 00:07:40,819
possible

211
00:07:40,819 --> 00:07:43,319
that's where the H can be quite useful

212
00:07:43,319 --> 00:07:45,720
so it's about the same thing but

213
00:07:45,720 --> 00:07:47,580
this time we  specifies the algorithm then

214
00:07:47,580 --> 00:07:49,620
from memory I believe that it is only

215
00:07:49,620 --> 00:07:54,020
cat 256 384 and 512 which is authorized

216
00:07:54,020 --> 00:07:58,500
and then we follow it from the bottom 64

217
00:07:58,500 --> 00:08:00,240
so the skip we do not touch it on the other hand

218
00:08:00,240 --> 00:08:01,440
must be careful enough because

219
00:08:01,440 --> 00:08:04,199
it is really  the H of everything that is

220
00:08:04,199 --> 00:08:05,520
inside our tags so with

221
00:08:05,520 --> 00:08:07,560
the example we have it would be the

222
00:08:07,560 --> 00:08:09,060
line break everything is abulation I do

223
00:08:09,060 --> 00:08:11,699
n't necessarily know the annotations there plus the

224
00:08:11,699 --> 00:08:13,800
12/9 and again a return to  the line so

225
00:08:13,800 --> 00:08:15,720
it can be easily forgotten but that

226
00:08:15,720 --> 00:08:17,340
's where the animal report can be interesting

227
00:08:17,340 --> 00:08:20,099
because it will

228
00:08:20,099 --> 00:08:23,940
generate the H of your script directly

229
00:08:23,940 --> 00:08:25,440
so you can know if you want

230
00:08:25,440 --> 00:08:27,900
to validate or not after you don't have to validate

231
00:08:27,900 --> 00:08:29,819
anyone  what if inside there is

232
00:08:29,819 --> 00:08:32,039
a variable injection it's useless

233
00:08:32,039 --> 00:08:34,440
to validate this script finally for Le Havre

234
00:08:34,440 --> 00:08:35,339
it doesn't work it's more for the announcement

235
00:08:35,339 --> 00:08:38,539
I'll come back later on that

236
00:08:38,580 --> 00:08:40,919
yes for the H also if a change  of

237
00:08:40,919 --> 00:08:42,659
your script because it's an

238
00:08:42,659 --> 00:08:44,099
external source you are aware it will be

239
00:08:44,099 --> 00:08:45,980
more validated so it's really useful

240
00:08:45,980 --> 00:08:47,940
another way to approve it would be

241
00:08:47,940 --> 00:08:50,519
directly with the origin the source of

242
00:08:50,519 --> 00:08:52,980
our script we will specify the domain

243
00:08:52,980 --> 00:08:54,720
by which  it comes from where it was

244
00:08:54,720 --> 00:08:56,880
recovered so if I show you

245
00:08:56,880 --> 00:09:00,180
another self example for my domain and the

246
00:09:00,180 --> 00:09:02,700
sharp domain example.com it means

247
00:09:02,700 --> 00:09:05,339
that I will only authorize a skip

248
00:09:05,339 --> 00:09:07,019
coming from its origins you have to be a

249
00:09:07,019 --> 00:09:09,720
little careful not to  to be too finally you

250
00:09:09,720 --> 00:09:12,000
have to be quite restrictive because we do

251
00:09:12,000 --> 00:09:13,140
n't necessarily have confidence in the whole site

252
00:09:13,140 --> 00:09:16,019
I know that there was a call back on

253
00:09:16,019 --> 00:09:17,880
Google that existed at the time we

254
00:09:17,880 --> 00:09:21,540
could just specify our script as an argument

255
00:09:21,540 --> 00:09:23,519
and it will be sent  so if we

256
00:09:23,519 --> 00:09:24,980
authorized everything Google for example

257
00:09:24,980 --> 00:09:27,680
it wouldn't protect me

258
00:09:27,680 --> 00:09:29,580
so if I can give some

259
00:09:29,580 --> 00:09:32,820
advice on how to use the CSP it

260
00:09:32,820 --> 00:09:34,800
would really already be in case you

261
00:09:34,800 --> 00:09:36,899
use a lance to be sure that

262
00:09:36,899 --> 00:09:39,180
it is generated randomly

263
00:09:39,180 --> 00:09:41,100
with really enough company that

264
00:09:41,100 --> 00:09:43,140
is unique because otherwise really if

265
00:09:43,140 --> 00:09:46,519
it is fixed it is useless

266
00:09:48,360 --> 00:09:49,500
which is not variable inside

267
00:09:49,500 --> 00:09:51,920
to avoid any injection you really have to

268
00:09:51,920 --> 00:09:54,540
check that this script is safe before

269
00:09:54,540 --> 00:09:55,920
validating it if  you validate everything there

270
00:09:55,920 --> 00:09:58,320
is no point either you

271
00:09:58,320 --> 00:10:00,480
have to avoid using the

272
00:10:00,480 --> 00:10:04,680
Walker directive by the directives otherwise if

273
00:10:04,680 --> 00:10:06,240
you make a list of domains but

274
00:10:06,240 --> 00:10:07,459
you accept

275
00:10:07,459 --> 00:10:10,380
everything for other directives we can

276
00:10:10,380 --> 00:10:12,120
finding bypasses to be able to use

277
00:10:12,120 --> 00:10:14,959
and inject and have an impact on it

278
00:10:14,959 --> 00:10:16,980
really needs to see a somewhat

279
00:10:16,980 --> 00:10:20,040
basic firewall approach we prohibit everything and

280
00:10:20,040 --> 00:10:21,480
it's really little by little that we will

281
00:10:21,480 --> 00:10:24,720
open points if it's not enough

282
00:10:24,720 --> 00:10:27,540
we test  we see we check that the

283
00:10:27,540 --> 00:10:29,339
script is valid or not we are not

284
00:10:29,339 --> 00:10:31,200
injection which is nothing and we can validate it

285
00:10:31,200 --> 00:10:33,320


286
00:10:36,360 --> 00:10:38,459
so there we discussed a little bit of CSP

287
00:10:38,459 --> 00:10:40,820
you see more or less what it is for

288
00:10:40,820 --> 00:10:43,560
little question for l  'assembly

289
00:10:43,560 --> 00:10:45,360
have you already used this in your

290
00:10:45,360 --> 00:10:46,500
application in your

291
00:10:46,500 --> 00:10:48,480
current applications a little raise of hands

292
00:10:48,480 --> 00:10:50,279
please

293
00:10:50,279 --> 00:10:55,620
we are on at least 10%.  ok XSS you

294
00:10:55,620 --> 00:10:57,920
see all that what it's for how to

295
00:10:57,920 --> 00:11:00,839
protect etc that's much better

296
00:11:00,839 --> 00:11:04,200
known we're going to say there we in jinkins we

297
00:11:04,200 --> 00:11:06,959
have a problem with XS since Jenkins

298
00:11:06,959 --> 00:11:08,940
allows code to be executed unlike

299
00:11:08,940 --> 00:11:11,760
a PHP forum or if  you have an XS

300
00:11:11,760 --> 00:11:13,260
you'll be able to create new

301
00:11:13,260 --> 00:11:14,880
posts modify existing ones

302
00:11:14,880 --> 00:11:17,279
the impact isn't very big in jinkins

303
00:11:17,279 --> 00:11:20,040
it's the purpose of executing code it's a

304
00:11:20,040 --> 00:11:21,839
wax engine so if you're able through

305
00:11:21,839 --> 00:11:23,880
XS to execute code

306
00:11:23,880 --> 00:11:25,740
that was unwanted the impact is

307
00:11:25,740 --> 00:11:27,180
much greater so for us it is

308
00:11:27,180 --> 00:11:28,380
still a relatively

309
00:11:28,380 --> 00:11:30,000
frequent problem that we see in some

310
00:11:30,000 --> 00:11:31,560
plugins again yesterday we made a

311
00:11:31,560 --> 00:11:33,959
release with an XS in a plugin  which

312
00:11:33,959 --> 00:11:35,279
allowed us to do a little

313
00:11:35,279 --> 00:11:37,920
bit dangerous things so we are trying to

314
00:11:37,920 --> 00:11:40,140
set up CSP Jenkins it's a

315
00:11:40,140 --> 00:11:41,760
relatively large project so we need a

316
00:11:41,760 --> 00:11:43,680
little bit formal approach we'll

317
00:11:43,680 --> 00:11:45,800
say so we're going on four phases

318
00:11:45,800 --> 00:11:48,779
the first will be  already to understand

319
00:11:48,779 --> 00:11:50,700
so that's what we've done a few

320
00:11:50,700 --> 00:11:52,680
years already to understand how it

321
00:11:52,680 --> 00:11:55,380
works CSP how it can be integrated

322
00:11:55,380 --> 00:11:57,300
into the jinkins so see in relation to

323
00:11:57,300 --> 00:11:59,040
our functionalities our

324
00:11:59,040 --> 00:12:00,600
coding practices how  we can

325
00:12:00,600 --> 00:12:02,459
integrate it without completely disturbing

326
00:12:02,459 --> 00:12:04,320
the developers without asking to

327
00:12:04,320 --> 00:12:05,519
rewrite the whole application

328
00:12:05,519 --> 00:12:07,740
because it's just to add CSP

329
00:12:07,740 --> 00:12:10,320
it's not worth it now if we

330
00:12:10,320 --> 00:12:12,240
manage to integrate it in a soft way over time

331
00:12:12,240 --> 00:12:14,399
the developers will be

332
00:12:14,399 --> 00:12:16,140
much more secure the

333
00:12:16,140 --> 00:12:18,300
users will be reassured with the

334
00:12:18,300 --> 00:12:19,980
students the additional protection and

335
00:12:19,980 --> 00:12:21,480
our estimate is that we could

336
00:12:21,480 --> 00:12:24,600
mitigate up to 95% of the XSS that arrive

337
00:12:24,600 --> 00:12:26,820
in the application which relieved

338
00:12:26,820 --> 00:12:28,860
the security team  and reduce

339
00:12:28,860 --> 00:12:31,440
our investigation time a little bit on this

340
00:12:31,440 --> 00:12:33,180
so to start the Discovery we

341
00:12:33,180 --> 00:12:35,339
just created a page where in fact we let

342
00:12:35,339 --> 00:12:37,800
the user insert an XS pelo

343
00:12:37,800 --> 00:12:41,700
to run it then we configure the

344
00:12:41,700 --> 00:12:43,680
CSP on it in a very restrictive way

345
00:12:43,680 --> 00:12:45,240
or not it is precisely the purpose of the

346
00:12:45,240 --> 00:12:47,040
Discovery to see to what extent it can be

347
00:12:47,040 --> 00:12:49,079
useful or not to the developer to

348
00:12:49,079 --> 00:12:51,540
protect his page so it's going to be a little

349
00:12:51,540 --> 00:12:53,100
discovery that we made it's interesting

350
00:12:53,100 --> 00:12:55,200
for the security team but as we don't  it's

351
00:12:55,200 --> 00:12:56,940
not the only people who develop

352
00:12:56,940 --> 00:12:59,040
the application it's a community there is

353
00:12:59,040 --> 00:13:01,019
let's say between 500 and 1000 people

354
00:13:01,019 --> 00:13:03,839
depends on the scoopont you have to

355
00:13:03,839 --> 00:13:05,639
convince them too so in

356
00:13:05,639 --> 00:13:07,079
fact through this through this Discovery through this

357
00:13:07,079 --> 00:13:09,000
page that  we proposed we see him

358
00:13:09,000 --> 00:13:11,339
show it to others how they can

359
00:13:11,339 --> 00:13:13,019
use it what it can be used for with

360
00:13:13,019 --> 00:13:15,240
real demos of real elements that

361
00:13:15,240 --> 00:13:17,579
can be understood and not just a page

362
00:13:17,579 --> 00:13:19,740
on MDN which explains what it's for in a

363
00:13:19,740 --> 00:13:21,240
theoretical way  we really had

364
00:13:21,240 --> 00:13:23,459
practical uses that

365
00:13:23,459 --> 00:13:25,500
convinced a lot of people we will see a

366
00:13:25,500 --> 00:13:27,180
little later in three four

367
00:13:27,180 --> 00:13:28,560
slides

368
00:13:28,560 --> 00:13:30,300
the other part of Discovery is

369
00:13:30,300 --> 00:13:31,920
that we also created a plugin that allows

370
00:13:31,920 --> 00:13:34,800
administrators to activate  CSP in

371
00:13:34,800 --> 00:13:36,540
their instance so that they can

372
00:13:36,540 --> 00:13:38,279
understand if they are already compliant

373
00:13:38,279 --> 00:13:40,019
with that is to say that all the plugins

374
00:13:40,019 --> 00:13:42,899
they already have are compatible with CSP

375
00:13:42,899 --> 00:13:45,060
in order to be able to enforce it so I'm

376
00:13:45,060 --> 00:13:46,800
not hiding it from you it's a project that  it's

377
00:13:46,800 --> 00:13:49,260
still between let's say 10 and 15 years depending on

378
00:13:49,260 --> 00:13:51,420
how you look we don't expect

379
00:13:51,420 --> 00:13:52,920
it to work the first time so there

380
00:13:52,920 --> 00:13:53,820
is a little effort to be made behind

381
00:13:53,820 --> 00:13:55,380
that's why we start with a project

382
00:13:55,380 --> 00:13:57,899
that we estimate we will say two three years

383
00:13:57,899 --> 00:13:59,700
out of the total we have to do a

384
00:13:59,700 --> 00:14:01,740
nice migration a little soft to avoid

385
00:14:01,740 --> 00:14:03,779
rushing people so there the plugin for

386
00:14:03,779 --> 00:14:05,399
the moment it's just to help the

387
00:14:05,399 --> 00:14:07,380
discovery help with the inventory of

388
00:14:07,380 --> 00:14:09,420
all  all the different patterns

389
00:14:09,420 --> 00:14:11,040
that we have to correct and that has already

390
00:14:11,040 --> 00:14:13,500
allowed us to draw up a small list of the

391
00:14:13,500 --> 00:14:15,959
different patterns their correction our

392
00:14:15,959 --> 00:14:17,279
advice recommendations for developers

393
00:14:17,279 --> 00:14:18,600


394
00:14:18,600 --> 00:14:20,639
it's ok it's something in my opinion that

395
00:14:20,639 --> 00:14:21,959
is not necessarily important in a

396
00:14:21,959 --> 00:14:23,760
community like ours but

397
00:14:23,760 --> 00:14:25,320
in general you are in a

398
00:14:25,320 --> 00:14:27,240
team you are not the only one suddenly

399
00:14:27,240 --> 00:14:28,500
you have to convince the others so

400
00:14:28,500 --> 00:14:30,360
having this kind of tools available

401
00:14:30,360 --> 00:14:32,160
whether it is demos of presentations

402
00:14:32,160 --> 00:14:34,680
it can convince others that it is  is

403
00:14:34,680 --> 00:14:36,600
useful to spend let's say 10

404
00:14:36,600 --> 00:14:38,700
extra minutes an hour just to

405
00:14:38,700 --> 00:14:40,139
change the approach of the code a little bit

406
00:14:40,139 --> 00:14:41,459
to have something that is

407
00:14:41,459 --> 00:14:43,980
secure by default

408
00:14:43,980 --> 00:14:46,440
second phase we do more so

409
00:14:46,440 --> 00:14:48,000
before we can correct things we

410
00:14:48,000 --> 00:14:49,320
have to  know where the

411
00:14:49,320 --> 00:14:51,899
concrete elements are located so there you

412
00:14:51,899 --> 00:14:53,839
can see

413
00:14:53,839 --> 00:14:57,300
you can see the first example where

414
00:14:57,300 --> 00:14:58,920
in fact it's an in line script so

415
00:14:58,920 --> 00:15:01,139
it's inside the page we're going to

416
00:15:01,139 --> 00:15:03,720
put a block directly inscribed and  we

417
00:15:03,720 --> 00:15:05,360
throw the Javascript directly into it

418
00:15:05,360 --> 00:15:07,260
personally it reminds me a little

419
00:15:07,260 --> 00:15:09,000
bit 10-15 years ago when we made

420
00:15:09,000 --> 00:15:10,740
a PHP query in the database

421
00:15:10,740 --> 00:15:13,139
directly in the view with the

422
00:15:13,139 --> 00:15:15,300
business logic just around it we will say that

423
00:15:15,300 --> 00:15:16,800
it's not too much  good practices

424
00:15:16,800 --> 00:15:18,240
these days but this kind of thing

425
00:15:18,240 --> 00:15:19,560
still happens in some

426
00:15:19,560 --> 00:15:21,060
applications especially since they are of a

427
00:15:21,060 --> 00:15:22,980
certain age and suddenly in Jenkins there are

428
00:15:22,980 --> 00:15:24,899
still a lot of codes like that in line

429
00:15:24,899 --> 00:15:27,139
that we will strive for in the corrections

430
00:15:27,139 --> 00:15:29,160
of  externalize in separate files

431
00:15:29,160 --> 00:15:31,620
as explained by Kevin just before an

432
00:15:31,620 --> 00:15:33,300
external file which is always delivered

433
00:15:33,300 --> 00:15:36,060
by the same origin will be validated rather

434
00:15:36,060 --> 00:15:38,100
than scripts in lines which will

435
00:15:38,100 --> 00:15:41,060
annoy for the RS8 we also see the

436
00:15:41,060 --> 00:15:43,500
events under such as for example the uncle

437
00:15:43,500 --> 00:15:45,540
the  we and this kind of thing that will

438
00:15:45,540 --> 00:15:47,279
also execute Javascript you see

439
00:15:47,279 --> 00:15:48,120
an example precisely with the button

440
00:15:48,120 --> 00:15:49,880
when we click we do something

441
00:15:49,880 --> 00:15:52,380
it is also this kind of code when

442
00:15:52,380 --> 00:15:53,760
JavaScript we try to discourage

443
00:15:53,760 --> 00:15:55,920
using an external script that will

444
00:15:55,920 --> 00:15:57,779
save its listers  in your place

445
00:15:57,779 --> 00:16:00,420
dynamically in the page etc there

446
00:16:00,420 --> 00:16:01,019
are much more

447
00:16:01,019 --> 00:16:02,360
interesting elements in terms of programming

448
00:16:02,360 --> 00:16:04,920
last point which is we will say

449
00:16:04,920 --> 00:16:06,060
interesting but which should no longer

450
00:16:06,060 --> 00:16:07,980
exist we will say nowadays it is

451
00:16:07,980 --> 00:16:09,720
the use of Vals  and the

452
00:16:09,720 --> 00:16:11,220
equivalents it can be for example a

453
00:16:11,220 --> 00:16:12,779
7 Time Out the creation of a wing

454
00:16:12,779 --> 00:16:15,420
function from the text in

455
00:16:15,420 --> 00:16:16,440
most languages ​​it is something

456
00:16:16,440 --> 00:16:18,240
that we advise you not to do that

457
00:16:18,240 --> 00:16:19,920
bypasses most of the

458
00:16:19,920 --> 00:16:21,540
security mechanisms and  on javascript it's the same you have

459
00:16:21,540 --> 00:16:24,180
to avoid there are

460
00:16:24,180 --> 00:16:27,360
express directives to authorize it it starts with

461
00:16:27,360 --> 00:16:30,660
a safe unsafeval it's not for nothing you

462
00:16:30,660 --> 00:16:32,459
shouldn't use it

463
00:16:32,459 --> 00:16:34,560
then for the correction you should

464
00:16:34,560 --> 00:16:35,880
know that Jenkins is a  project

465
00:16:35,880 --> 00:16:39,240
used by about 300,000 instances let's

466
00:16:39,240 --> 00:16:40,440
say they are installed

467
00:16:40,440 --> 00:16:42,959
worldwide we may estimate several

468
00:16:42,959 --> 00:16:45,180
million people who use it we

469
00:16:45,180 --> 00:16:47,160
can't afford to activate CSP for

470
00:16:47,160 --> 00:16:48,720
everyone overnight and

471
00:16:48,720 --> 00:16:51,060
good luck because basically with the

472
00:16:51,060 --> 00:16:52,620
1900 plugins that we have in the ecosystem

473
00:16:52,620 --> 00:16:55,259
there is almost no chance that there is

474
00:16:55,259 --> 00:16:57,060
not a small bug so when we did

475
00:16:57,060 --> 00:16:59,279
the Discovery the first inventory we

476
00:16:59,279 --> 00:17:01,259
saw that already in  jenkinscore the base of

477
00:17:01,259 --> 00:17:02,940
the application there were problems so

478
00:17:02,940 --> 00:17:04,500
we corrected them we are still

479
00:17:04,500 --> 00:17:06,660
correcting them and we will also target some of the

480
00:17:06,660 --> 00:17:08,040
most popular plugins

481
00:17:08,040 --> 00:17:10,619
the goal is that we can progress little

482
00:17:10,619 --> 00:17:13,020
by little  and not having a given moment

483
00:17:13,020 --> 00:17:15,000
at all of you have to migrate to the new

484
00:17:15,000 --> 00:17:16,439
version it's something that is not

485
00:17:16,439 --> 00:17:17,819
feasible in a large-scale project of

486
00:17:17,819 --> 00:17:19,199
this type

487
00:17:19,199 --> 00:17:20,459
so there I mentioned that a

488
00:17:20,459 --> 00:17:21,900
lot of in line scripting is still ahead  in

489
00:17:21,900 --> 00:17:23,459
some places you have to know that

490
00:17:23,459 --> 00:17:26,040
to develop a Jenkins plugin you

491
00:17:26,040 --> 00:17:28,040
have to know a little bit about Java we

492
00:17:28,040 --> 00:17:30,419
have developers who come from

493
00:17:30,419 --> 00:17:33,059
Python rubies or developer names

494
00:17:33,059 --> 00:17:36,179
who write a small piece of code that

495
00:17:36,179 --> 00:17:37,440
took several tries several

496
00:17:37,440 --> 00:17:39,539
maybe hundreds of tests it

497
00:17:39,539 --> 00:17:41,520
works the quality of the code behind

498
00:17:41,520 --> 00:17:44,220
and we will say less good than the rest

499
00:17:44,220 --> 00:17:46,140
of the project and in the safety team we

500
00:17:46,140 --> 00:17:48,240
have a little fun finding

501
00:17:48,240 --> 00:17:50,580
creative approaches from time to time

502
00:17:50,580 --> 00:17:52,260
now for  try to

503
00:17:52,260 --> 00:17:54,059
bypass the security mechanisms that

504
00:17:54,059 --> 00:17:56,100
we put in place but which

505
00:17:56,100 --> 00:17:57,960
prevent them from doing something that

506
00:17:57,960 --> 00:18:00,059
could work for them but which is

507
00:18:00,059 --> 00:18:01,679
not something good so sometimes

508
00:18:01,679 --> 00:18:03,600
we find very interesting things I will

509
00:18:03,600 --> 00:18:04,860
not show you  for example you can

510
00:18:04,860 --> 00:18:06,780
find them quite easily sometimes there are

511
00:18:06,780 --> 00:18:07,620
small, for example small,

512
00:18:07,620 --> 00:18:10,559
very sweet comments add the security

513
00:18:10,559 --> 00:18:13,620
thank you but avoid that what after it's

514
00:18:13,620 --> 00:18:15,120
not necessarily engineers they don't

515
00:18:15,120 --> 00:18:16,320
necessarily have the background they just make

516
00:18:16,320 --> 00:18:17,760
a small plugin  that works for them

517
00:18:17,760 --> 00:18:20,220
and often it's a plugin are part of

518
00:18:20,220 --> 00:18:22,200
the long tail plugins that are not really

519
00:18:22,200 --> 00:18:23,580
popular but that exist in

520
00:18:23,580 --> 00:18:26,400
the ecosystem it is estimated we will say that

521
00:18:26,400 --> 00:18:28,260
the 1000 least popular plugins

522
00:18:28,260 --> 00:18:31,140
have less than 500 installs unlike

523
00:18:31,140 --> 00:18:33,000
the plugin is more  popular with 300000

524
00:18:33,000 --> 00:18:35,520
you see the difference also for us

525
00:18:35,520 --> 00:18:37,140
it is also important to put the effort

526
00:18:37,140 --> 00:18:38,820
where there is efficiency a return

527
00:18:38,820 --> 00:18:40,740
on investment and typically at

528
00:18:40,740 --> 00:18:42,539
more popular plugin we will leave a

529
00:18:42,539 --> 00:18:44,660
little bit aside we will take care

530
00:18:44,660 --> 00:18:46,919
indirectly  but that's not there we're going to

531
00:18:46,919 --> 00:18:48,120
propose the corrections as soon as

532
00:18:48,120 --> 00:18:50,460
possible we're going to say

533
00:18:50,460 --> 00:18:52,440
so it's a very large ecosystem

534
00:18:52,440 --> 00:18:54,179
it's a community it's an

535
00:18:54,179 --> 00:18:56,280
open source project so for the month

536
00:18:56,280 --> 00:18:57,900
of October for example we have  organized a

537
00:18:57,900 --> 00:19:00,900
part of ectobofest including Jenkins to

538
00:19:00,900 --> 00:19:03,360
motivate people to implement

539
00:19:03,360 --> 00:19:05,640
corrections to the preparations for the CSP

540
00:19:05,640 --> 00:19:09,000
there for example we had 80% of the tasks

541
00:19:09,000 --> 00:19:10,620
we had created which were taken by

542
00:19:10,620 --> 00:19:11,760
new contributors from

543
00:19:11,760 --> 00:19:13,200
existing contributors who  are

544
00:19:13,200 --> 00:19:15,360
interested in the subject who have been

545
00:19:15,360 --> 00:19:16,380
learning a little bit about how it

546
00:19:16,380 --> 00:19:17,760
works what to do and

547
00:19:17,760 --> 00:19:19,320
since the entry barrier is

548
00:19:19,320 --> 00:19:21,000
relatively simple just

549
00:19:21,000 --> 00:19:22,860
move the javascript to a

550
00:19:22,860 --> 00:19:25,740
separate file let's say in  theory you will see

551
00:19:25,740 --> 00:19:26,700
after two or three examples a little

552
00:19:26,700 --> 00:19:28,919
more complicated than suddenly there have been

553
00:19:28,919 --> 00:19:30,360
a lot of contributions and it allows

554
00:19:30,360 --> 00:19:32,580
to increase the warness the education of the

555
00:19:32,580 --> 00:19:34,260
developer community and it

556
00:19:34,260 --> 00:19:35,640
also helps a lot in terms of motivation

557
00:19:35,640 --> 00:19:37,860
behind seeing  that the project is progressing and

558
00:19:37,860 --> 00:19:39,419
people are interested

559
00:19:39,419 --> 00:19:41,520
then once we have corrected it we

560
00:19:41,520 --> 00:19:43,679
will say a good part of the more than one

561
00:19:43,679 --> 00:19:46,200
popular we are going to force so basically we are

562
00:19:46,200 --> 00:19:48,539
proposing the plugin which will allow

563
00:19:48,539 --> 00:19:50,820
people to force the rules already to start

564
00:19:50,820 --> 00:19:52,320
by rice for tony as kevin

565
00:19:52,320 --> 00:19:53,940
explained who will inform you

566
00:19:53,940 --> 00:19:55,740
anyway the admin oh there have been

567
00:19:55,740 --> 00:19:57,480
warnings here there are two three things

568
00:19:57,480 --> 00:19:59,880
screwing up there and at least you have

569
00:19:59,880 --> 00:20:01,740
the information and you can figure out

570
00:20:01,740 --> 00:20:04,080
if you  are you ready to switch to forced CSP mode

571
00:20:04,080 --> 00:20:07,559
complete with protection or if

572
00:20:07,559 --> 00:20:09,539
you still have to wait a bit there

573
00:20:09,539 --> 00:20:11,280
you have for example two

574
00:20:11,280 --> 00:20:13,340
script examples the one on the left

575
00:20:13,340 --> 00:20:17,160
yeah the one on the left and static the one

576
00:20:17,160 --> 00:20:19,380
on the right and dynamic the difference

577
00:20:19,380 --> 00:20:21,480
is at the level  random Heidi which is

578
00:20:21,480 --> 00:20:24,059
a variable injected from jelly which

579
00:20:24,059 --> 00:20:25,380
is our templating system in

580
00:20:25,380 --> 00:20:27,960
Jenkins to finally ingest it inject it

581
00:20:27,960 --> 00:20:30,179
into the Javascript which means that

582
00:20:30,179 --> 00:20:31,980
if we want to allow people to validate

583
00:20:31,980 --> 00:20:34,080
by H as proposed by Kevin when you

584
00:20:34,080 --> 00:20:35,640
don't have control of the script

585
00:20:35,640 --> 00:20:37,679
directly typically a plugin that

586
00:20:37,679 --> 00:20:39,000
is not maintained or that you are

587
00:20:39,000 --> 00:20:42,120
not you can validate the axes

588
00:20:42,120 --> 00:20:44,580
as an administrator except for a

589
00:20:44,580 --> 00:20:46,860
plugin that offers dynamic inline

590
00:20:46,860 --> 00:20:49,260
so with the  random Heidi which at each

591
00:20:49,260 --> 00:20:51,299
execution will be different you don't have

592
00:20:51,299 --> 00:20:53,340
an H so you have no way to

593
00:20:53,340 --> 00:20:55,679
go and validate this kind of script and

594
00:20:55,679 --> 00:20:58,080
that's why this kind of plugin

595
00:20:58,080 --> 00:21:00,059
is a little too annoying for us  and

596
00:21:00,059 --> 00:21:01,380
also makes the correction a little

597
00:21:01,380 --> 00:21:02,760
more difficult it's not impossible

598
00:21:02,760 --> 00:21:03,960
it's just that you have to understand a

599
00:21:03,960 --> 00:21:05,700
little more how it works I

600
00:21:05,700 --> 00:21:07,740
won't go into the details here

601
00:21:07,740 --> 00:21:09,299
then once we have forced that we have

602
00:21:09,299 --> 00:21:10,740
given the plugin to people who are starting

603
00:21:10,740 --> 00:21:11,820
to use it that we have a little

604
00:21:11,820 --> 00:21:13,260
telemetry to know what the

605
00:21:13,260 --> 00:21:16,160
adoption rate is we will manage in the long term,

606
00:21:16,160 --> 00:21:18,480
for example the transformation of

607
00:21:18,480 --> 00:21:19,559
tickets which are currently

608
00:21:19,559 --> 00:21:21,539
improvements plugin improvements

609
00:21:21,539 --> 00:21:24,120
we bug because we will consider the CSP

610
00:21:24,120 --> 00:21:24,960
as something that

611
00:21:24,960 --> 00:21:27,179
the plugin is asked to be compatible with

612
00:21:27,179 --> 00:21:29,880
for security for

613
00:21:29,880 --> 00:21:31,260
quality needs also because you have to know

614
00:21:31,260 --> 00:21:32,580
that it allows us to improve

615
00:21:32,580 --> 00:21:34,740
quality also in the  project to avoid

616
00:21:34,740 --> 00:21:36,299
all these in-line scripts which sometimes

617
00:21:36,299 --> 00:21:38,940
are very strange which work but

618
00:21:38,940 --> 00:21:40,200
which are very strange if we really try to

619
00:21:40,200 --> 00:21:41,700
look at what is being done

620
00:21:41,700 --> 00:21:44,039
behind and suddenly have a

621
00:21:44,039 --> 00:21:45,900
long-term management to do  the

622
00:21:45,900 --> 00:21:47,640
maintenance of to help the maintainers

623
00:21:47,640 --> 00:21:49,740
also in terms of the quality of what does

624
00:21:49,740 --> 00:21:51,000
it have to do in their plugin to

625
00:21:51,000 --> 00:21:52,740
be compatible and to move forward all

626
00:21:52,740 --> 00:21:55,020
together in a way it is expected

627
00:21:55,020 --> 00:21:56,580
that the lesser plugins  popular

628
00:21:56,580 --> 00:21:59,100
are never compatible typically

629
00:21:59,100 --> 00:22:02,220
a plugin with 10 installations there is

630
00:22:02,220 --> 00:22:03,419
little chance that the maintainer is

631
00:22:03,419 --> 00:22:05,640
still there or still active suddenly

632
00:22:05,640 --> 00:22:07,980
it is a hope that we do not necessarily see we

633
00:22:07,980 --> 00:22:10,500
have we will really aim for the top 100

634
00:22:10,500 --> 00:22:12,539
top of its  plugins that

635
00:22:12,539 --> 00:22:15,960
perhaps correspond to 95 99% of the instances in the

636
00:22:15,960 --> 00:22:17,780
wild so it's no use for us either

637
00:22:17,780 --> 00:22:20,580
to wait for 100% compatibility before

638
00:22:20,580 --> 00:22:22,620
moving forward we also don't want to be

639
00:22:22,620 --> 00:22:25,500
slowed down by elements that

640
00:22:25,500 --> 00:22:26,580
may not have  be not destined to change we will

641
00:22:26,580 --> 00:22:28,639
say

642
00:22:29,039 --> 00:22:32,220
and suddenly we go to the second part

643
00:22:32,220 --> 00:22:33,419
suddenly we will go to the second

644
00:22:33,419 --> 00:22:36,059
part yes the little story on an XS

645
00:22:36,059 --> 00:22:38,520
that we could see so we will put a

646
00:22:38,520 --> 00:22:40,080
little more context so I  I told you

647
00:22:40,080 --> 00:22:42,120
that I was a young graduate it's been a year

648
00:22:42,120 --> 00:22:44,580
and to finish my Master's I first had to

649
00:22:44,580 --> 00:22:46,500
do a two-month project that I was able to

650
00:22:46,500 --> 00:22:48,960
do code auditing on Jenkins

651
00:22:48,960 --> 00:22:50,460
it's plugin so  this is where I

652
00:22:50,460 --> 00:22:52,080
met Vadec

653
00:22:52,080 --> 00:22:53,460
and moreover I left for a

654
00:22:53,460 --> 00:22:55,140
six-month internship but this time not

655
00:22:55,140 --> 00:22:56,640
at all in everything that was web app

656
00:22:56,640 --> 00:22:58,260
but in an encryption solution

657
00:22:58,260 --> 00:23:01,980
but really security in web

658
00:23:01,980 --> 00:23:03,360
applications  it takes a lot more

659
00:23:03,360 --> 00:23:06,299
suddenly I continued in my corner in

660
00:23:06,299 --> 00:23:08,700
self-taught mode trying to train myself and

661
00:23:08,700 --> 00:23:10,919
I quickly got a little fed up with the

662
00:23:10,919 --> 00:23:14,039
boxes where I was a little closed, let's say

663
00:23:14,039 --> 00:23:16,620
with I know that there  has such a type of

664
00:23:16,620 --> 00:23:18,600
vulnerability in it i know that there is

665
00:23:18,600 --> 00:23:20,700
an inhabited life i am looking for and i

666
00:23:20,700 --> 00:23:22,679
already know what i am looking for so i wanted to

667
00:23:22,679 --> 00:23:26,340
continue a little but in a

668
00:23:26,340 --> 00:23:28,500
slightly different approach that is where i

669
00:23:28,500 --> 00:23:29,820
turned  towards the Bounty bug already

670
00:23:29,820 --> 00:23:31,799
first point there is a Bounty I'm a

671
00:23:31,799 --> 00:23:34,020
student of money I'm so

672
00:23:34,020 --> 00:23:35,100
happy

673
00:23:35,100 --> 00:23:38,520
so I finally have the advantage it's going to be

674
00:23:38,520 --> 00:23:40,740
that it's going to be very large there are already

675
00:23:40,740 --> 00:23:41,820
plenty of researchers who have passed

676
00:23:41,820 --> 00:23:44,220
on it so I really have to be

677
00:23:44,220 --> 00:23:45,960
interested in everything that seems

678
00:23:45,960 --> 00:23:48,720
dangerous to me and that I dwell a bit in it

679
00:23:48,720 --> 00:23:52,080
to see if it's interesting or not and that

680
00:23:52,080 --> 00:23:54,000
allows me I think in any case to

681
00:23:54,000 --> 00:23:57,419
better develop my skills so I

682
00:23:57,419 --> 00:23:59,760
myself  signed up signed up for a

683
00:23:59,760 --> 00:24:01,320
bounty bug program i took an app

684
00:24:01,320 --> 00:24:03,840
and went to look on one of the

685
00:24:03,840 --> 00:24:06,299
biggest dating sites if ever

686
00:24:06,299 --> 00:24:08,100
my girlfriend listening i talk about chasing

687
00:24:08,100 --> 00:24:09,900
vulnerabilities no chasing on the

688
00:24:09,900 --> 00:24:12,200
site of  meet

689
00:24:12,840 --> 00:24:15,299
so the first step it's going to be to

690
00:24:15,299 --> 00:24:18,059
finally search for XS it's not going to be

691
00:24:18,059 --> 00:24:20,700
only about I have my field so my

692
00:24:20,700 --> 00:24:22,860
nickname I put my ball in it and

693
00:24:22,860 --> 00:24:25,080
I hope it's executed the idea it's going to

694
00:24:25,080 --> 00:24:27,179
be to use  tools or

695
00:24:27,179 --> 00:24:29,700
anything to facilitate the work afterwards you

696
00:24:29,700 --> 00:24:32,159
have to be careful because you are

697
00:24:32,159 --> 00:24:34,140
not saying that a very specific legal framework says

698
00:24:34,140 --> 00:24:37,140
there is a limit rule for all

699
00:24:37,140 --> 00:24:39,299
the calls I can make sometimes I

700
00:24:39,299 --> 00:24:41,039
had to add leaders even  your

701
00:24:41,039 --> 00:24:43,140
account create can be specified there are

702
00:24:43,140 --> 00:24:45,740
a lot of rules to be

703
00:24:45,960 --> 00:24:48,059
able to its advantages we can touch

704
00:24:48,059 --> 00:24:50,820
fields which are supposed to be fixed

705
00:24:50,820 --> 00:24:52,380
which are not really validated on the

706
00:24:52,380 --> 00:24:54,980
server side or anything so we can

707
00:24:54,980 --> 00:24:57,780
touch variables which are supposed

708
00:24:57,780 --> 00:24:59,600
to be

709
00:24:59,600 --> 00:25:02,039
which can potentially be

710
00:25:02,039 --> 00:25:05,580
unprotected or no one has tried yet

711
00:25:05,580 --> 00:25:07,020
so I started trying some

712
00:25:07,020 --> 00:25:09,000
simple drivers so the basic with

713
00:25:09,000 --> 00:25:11,580
script or passing with vaattenders

714
00:25:11,580 --> 00:25:13,620
on an image for example

715
00:25:13,620 --> 00:25:15,900
if characters were banned and I

716
00:25:15,900 --> 00:25:17,580
could use  be variant with

717
00:25:17,580 --> 00:25:20,820
slashes and so on I was

718
00:25:20,820 --> 00:25:22,799
quickly able to find on one of the sites

719
00:25:22,799 --> 00:25:24,419
a meaning that looked rather

720
00:25:24,419 --> 00:25:26,880
interesting so it was on the profile

721
00:25:26,880 --> 00:25:29,820
of obtaining a meeting one could

722
00:25:29,820 --> 00:25:33,120
specify his work his diplomas and

723
00:25:33,120 --> 00:25:36,240
his  university exactly etc

724
00:25:36,240 --> 00:25:39,000
trying my little alert so there rather

725
00:25:39,000 --> 00:25:40,440
happy

726
00:25:40,440 --> 00:25:42,059
a little point I said it was not

727
00:25:42,059 --> 00:25:43,679
that easy but I lied a little

728
00:25:43,679 --> 00:25:45,480
because for this case honestly I was going

729
00:25:45,480 --> 00:25:46,799
up to my little one  brother who

730
00:25:46,799 --> 00:25:48,299
is also in computer science what was

731
00:25:48,299 --> 00:25:49,620
the bounty bug what

732
00:25:49,620 --> 00:25:52,080
was a css and this is one of the first

733
00:25:52,080 --> 00:25:53,400
sites i took to show him one

734
00:25:53,400 --> 00:25:54,900
of the first  fields I got my alert

735
00:25:54,900 --> 00:25:56,820
I was pretty happy even me it

736
00:25:56,820 --> 00:25:58,020
shocked me

737
00:25:58,020 --> 00:25:59,480
but hey here

738
00:25:59,480 --> 00:26:01,620
after the question that came to me

739
00:26:01,620 --> 00:26:03,120
quickly is what do I do with it

740
00:26:03,120 --> 00:26:04,620
it was not the first XS  that I

741
00:26:04,620 --> 00:26:06,120
found it was not the first that I

742
00:26:06,120 --> 00:26:07,799
reported certainly I am happy

743
00:26:07,799 --> 00:26:11,159
to have a Bounty but I would like what I

744
00:26:11,159 --> 00:26:12,419
wanted to say it is rather to perfect

745
00:26:12,419 --> 00:26:13,919
ignorance to really

746
00:26:13,919 --> 00:26:16,559
learn that I was in there so to

747
00:26:16,559 --> 00:26:17,940
report it as  that was no longer really

748
00:26:17,940 --> 00:26:19,700
of interest to me already

749
00:26:19,700 --> 00:26:22,980
suddenly I had a little dilemma between

750
00:26:22,980 --> 00:26:25,080
postponing it quickly to get the

751
00:26:25,080 --> 00:26:26,460
candle because it still interests me

752
00:26:26,460 --> 00:26:27,559
a minimum

753
00:26:27,559 --> 00:26:30,720
but being afraid that someone will postpone it

754
00:26:30,720 --> 00:26:32,220
before me or like I  I was able to see it yesterday

755
00:26:32,220 --> 00:26:34,260
that a crack that has nothing to do fixes

756
00:26:34,260 --> 00:26:36,539
my problem for no reason

757
00:26:36,539 --> 00:26:39,900
so I was a little mixed there I

758
00:26:39,900 --> 00:26:43,200
thought that the town hall would be to see what

759
00:26:43,200 --> 00:26:44,340
I can do with my vulnerability

760
00:26:44,340 --> 00:26:46,919
not  stop on the alert it has two

761
00:26:46,919 --> 00:26:49,820
interests to take to increase

762
00:26:49,820 --> 00:26:53,640
the score because on programs it

763
00:26:53,640 --> 00:26:55,020
can be considered as the water really

764
00:26:55,020 --> 00:26:58,440
to have an XS if we find no impact

765
00:26:58,440 --> 00:27:00,960
and it can go up to high or even

766
00:27:00,960 --> 00:27:02,580
even critical I must specify on

767
00:27:02,580 --> 00:27:04,080
this one it was marked that if we are

768
00:27:04,080 --> 00:27:05,419
able to touch

769
00:27:05,419 --> 00:27:08,520
the profile of other users touches

770
00:27:08,520 --> 00:27:09,779
their imprint it can go up to

771
00:27:09,779 --> 00:27:11,940
critical it was what was marked

772
00:27:11,940 --> 00:27:13,980
so I thought of  looking for help

773
00:27:13,980 --> 00:27:15,600
because I didn't necessarily have the time

774
00:27:15,600 --> 00:27:18,299
so I wanted to find a common point

775
00:27:18,299 --> 00:27:19,500
between my two approaches my two

776
00:27:19,500 --> 00:27:21,840
problems and that's when I thought about the

777
00:27:21,840 --> 00:27:22,860
network that I was just beginning to

778
00:27:22,860 --> 00:27:24,840
build myself  in particular Vadec who was able to

779
00:27:24,840 --> 00:27:27,000
show me and make me discover everything

780
00:27:27,000 --> 00:27:29,120
that was

781
00:27:31,460 --> 00:27:34,440
the very interesting little side there is

782
00:27:34,440 --> 00:27:35,400
someone who will show you look

783
00:27:35,400 --> 00:27:37,200
I have a problem I manage to do

784
00:27:37,200 --> 00:27:38,279
things with it but I don't know what  that

785
00:27:38,279 --> 00:27:40,740
I can do in total so if we like

786
00:27:40,740 --> 00:27:42,179
solving problems it's the

787
00:27:42,179 --> 00:27:44,039
kind of little challenge which is very

788
00:27:44,039 --> 00:27:46,919
interesting so there's a little disclaimer

789
00:27:46,919 --> 00:27:48,960
compared to what we've done so already for

790
00:27:48,960 --> 00:27:50,940
the Bounty bug program it didn't

791
00:27:50,940 --> 00:27:53,460
offer  no test application so

792
00:27:53,460 --> 00:27:54,840
we had to do that on the prod application

793
00:27:54,840 --> 00:27:56,700
used by millions of people

794
00:27:56,700 --> 00:27:59,039
so we had to be a little bit

795
00:27:59,039 --> 00:28:00,020


796
00:28:00,020 --> 00:28:02,640
careful so our poke was

797
00:28:02,640 --> 00:28:04,200
never done in full it was done

798
00:28:04,200 --> 00:28:06,059
by small isolation by small segment

799
00:28:06,059 --> 00:28:08,580
to make sure that everything worked and

800
00:28:08,580 --> 00:28:10,140
we explained to them how to put everything

801
00:28:10,140 --> 00:28:12,179
end to end by telling them well we did

802
00:28:12,179 --> 00:28:14,820
not exploit it but we could have it was

803
00:28:14,820 --> 00:28:17,039
a bit the idea also we did not  are not

804
00:28:17,039 --> 00:28:19,919
interested old CSP experts it's been

805
00:28:19,919 --> 00:28:21,000
more or less two years that we read

806
00:28:21,000 --> 00:28:22,260
a lot of things on it that we test that we

807
00:28:22,260 --> 00:28:24,360
tweak but do not come to

808
00:28:24,360 --> 00:28:26,220
ask me questions on a directive in

809
00:28:26,220 --> 00:28:28,380
particular on a particular detail we

810
00:28:28,380 --> 00:28:30,900
didn't do the aspect we use it we

811
00:28:30,900 --> 00:28:32,460
're very into it we see on all the holes

812
00:28:32,460 --> 00:28:33,960
as you'll see in a mountain team

813
00:28:33,960 --> 00:28:36,900
but it's still a method we

814
00:28:36,900 --> 00:28:38,340
used which worked it's not

815
00:28:38,340 --> 00:28:40,020
necessarily the only one  there are maybe

816
00:28:40,020 --> 00:28:41,700
dozens of others it's just we'll

817
00:28:41,700 --> 00:28:43,200
show you what we've had

818
00:28:43,200 --> 00:28:46,320
for this vulnerability

819
00:28:46,320 --> 00:28:49,260
in particular

820
00:28:49,260 --> 00:28:51,779
so first step without Kevin just

821
00:28:51,779 --> 00:28:53,880
saw yeah I have an XS

822
00:28:53,880 --> 00:28:54,960
I can  put that in a profile

823
00:28:54,960 --> 00:28:56,940
what can I do so as

824
00:28:56,940 --> 00:28:59,460
I said that before we have a PHP forum

825
00:28:59,460 --> 00:29:01,679
it is not often very interesting there

826
00:29:01,679 --> 00:29:02,400
are not many things to

827
00:29:02,400 --> 00:29:04,320
look for on Jenkins we can

828
00:29:04,320 --> 00:29:06,539
exploit  run code on a

829
00:29:06,539 --> 00:29:08,039
dating application like

830
00:29:08,039 --> 00:29:10,080
most of the time it's pays to win

831
00:29:10,080 --> 00:29:11,640
if you want to earn a little more

832
00:29:11,640 --> 00:29:13,440
before it's faster you buy a

833
00:29:13,440 --> 00:29:16,080
boost a premium this kind of thing so

834
00:29:16,080 --> 00:29:18,960
who says purchase says money  money

835
00:29:18,960 --> 00:29:20,940
credit card there I discovered that in

836
00:29:20,940 --> 00:29:22,980
the application we enter the

837
00:29:22,980 --> 00:29:24,240
credit card numbers directly in

838
00:29:24,240 --> 00:29:26,760
the web application so that means that

839
00:29:26,760 --> 00:29:30,240
it was not a partner a third party who

840
00:29:30,240 --> 00:29:32,520
offered this service I believe that it  is

841
00:29:32,520 --> 00:29:33,659
again this morning that we were told well do

842
00:29:33,659 --> 00:29:36,360
n't use your own

843
00:29:36,360 --> 00:29:37,740
system yourself to save

844
00:29:37,740 --> 00:29:39,539
bank details use a service that

845
00:29:39,539 --> 00:29:41,580
does it it's more secure it's their

846
00:29:41,580 --> 00:29:43,020
job it's not yours in

847
00:29:43,020 --> 00:29:44,520
this case  we're in charge of a

848
00:29:44,520 --> 00:29:46,500
dating application we don't expect it

849
00:29:46,500 --> 00:29:47,700
to be people who manage

850
00:29:47,700 --> 00:29:50,220
this aspect extremely well we'll

851
00:29:50,220 --> 00:29:51,539
see that it's going to be very useful to us

852
00:29:51,539 --> 00:29:53,279


853
00:29:53,279 --> 00:29:55,860
so to start the little alert a

854
00:29:55,860 --> 00:29:58,740
finally alert one that  Kevin uses to

855
00:29:58,740 --> 00:30:01,020
have the pop-up it's useful to see

856
00:30:01,020 --> 00:30:02,580
when it's necessary who tries but

857
00:30:02,580 --> 00:30:05,460
it doesn't go far enough so we can

858
00:30:05,460 --> 00:30:07,380
already transform the alert into a world console

859
00:30:07,380 --> 00:30:08,880


860
00:30:08,880 --> 00:30:11,220
the difference is that the console warn

861
00:30:11,220 --> 00:30:14,159
allows us to have  the street so there

862
00:30:14,159 --> 00:30:15,480
it's just a hell of a thing that I found

863
00:30:15,480 --> 00:30:17,039
on the internet nothing to do with

864
00:30:17,039 --> 00:30:18,720
the application itself we're not going to

865
00:30:18,720 --> 00:30:19,799
give you the name of the application

866
00:30:19,799 --> 00:30:22,140
either so there the thing is very

867
00:30:22,140 --> 00:30:24,299
interesting it  is that we can see where

868
00:30:24,299 --> 00:30:27,120
the XS comes from where the trigger comes from in this case

869
00:30:27,120 --> 00:30:28,980
for this case it was

870
00:30:28,980 --> 00:30:30,840
extremely simple in fact it was

871
00:30:30,840 --> 00:30:33,419
simply an input which was not escaped

872
00:30:33,419 --> 00:30:34,919
from the server side which was displayed for

873
00:30:34,919 --> 00:30:36,899
the client the difference in fact is

874
00:30:36,899 --> 00:30:38,640
that if it's a no warmer that is

875
00:30:38,640 --> 00:30:40,860
displayed you can use a

876
00:30:40,860 --> 00:30:42,960
script tag if it's not a field that's displayed

877
00:30:42,960 --> 00:30:44,640
directly but it's something that

878
00:30:44,640 --> 00:30:45,600
has been automatically generated

879
00:30:45,600 --> 00:30:47,700
dynamically we're going  having to use

880
00:30:47,700 --> 00:30:50,039
other pelods from other XS bootstraps

881
00:30:50,039 --> 00:30:52,200
to launch our country lo in itself

882
00:30:52,200 --> 00:30:55,080
it doesn't mean much in the end and there

883
00:30:55,080 --> 00:30:56,899
we saw the first security barrier

884
00:30:56,899 --> 00:31:00,419
they limited the linput to 40 characters

885
00:31:00,419 --> 00:31:02,340
so to 40 characters good luck  to

886
00:31:02,340 --> 00:31:05,039
make an interesting XS good

887
00:31:05,039 --> 00:31:07,860
protection we removed the tribe it

888
00:31:07,860 --> 00:31:10,200
worked so there we say to ourselves in terms

889
00:31:10,200 --> 00:31:12,720
of security it's interesting so thanks to

890
00:31:12,720 --> 00:31:15,000
that we were able to go up to 250 5 which

891
00:31:15,000 --> 00:31:16,500
seems to be the default value for  'a

892
00:31:16,500 --> 00:31:17,940
field in a database so

893
00:31:17,940 --> 00:31:20,640
basically no validation it also reassures

894
00:31:20,640 --> 00:31:22,020
it increases the challenge a little bit what

895
00:31:22,020 --> 00:31:22,980
can we push

896
00:31:22,980 --> 00:31:24,539
on it

897
00:31:24,539 --> 00:31:25,399
so

898
00:31:25,399 --> 00:31:27,720
255 characters we can't do

899
00:31:27,720 --> 00:31:29,460
much if we want to completely

900
00:31:29,460 --> 00:31:31,380
replace  the page where we enter the

901
00:31:31,380 --> 00:31:33,480
credit card numbers etc so they

902
00:31:33,480 --> 00:31:34,380
will see us we need a

903
00:31:34,380 --> 00:31:37,559
little more the idea is to add a

904
00:31:37,559 --> 00:31:40,140
small script tag with an

905
00:31:40,140 --> 00:31:42,120
external source against the by us to put

906
00:31:42,120 --> 00:31:43,559
the ball that  we do

907
00:31:43,559 --> 00:31:45,960
n't want any luck they had to look that's why

908
00:31:45,960 --> 00:31:47,460
we rate

909
00:31:47,460 --> 00:31:51,000
the protection and the attack together cspect script

910
00:31:51,000 --> 00:31:52,860
security registration a list of

911
00:31:52,860 --> 00:31:54,779
domains we checked the domains and we

912
00:31:54,779 --> 00:31:56,039
had no  which allowed us to

913
00:31:56,039 --> 00:31:57,840
put our own data on it and

914
00:31:57,840 --> 00:32:00,000
load it it was typically from their

915
00:32:00,000 --> 00:32:02,220
application from their CDN from their S3 etc

916
00:32:02,220 --> 00:32:06,179
nothing interesting for us so we are

917
00:32:06,179 --> 00:32:09,659
something else we insert an iframe we put

918
00:32:09,659 --> 00:32:11,700
a source that belongs to us to

919
00:32:11,700 --> 00:32:13,679
load  the data in the frame and there

920
00:32:13,679 --> 00:32:15,840
in fact we discover that frame source they

921
00:32:15,840 --> 00:32:17,880
have a small star thank you very much

922
00:32:17,880 --> 00:32:19,799
so there was a list of

923
00:32:19,799 --> 00:32:22,140
approved domains and with the star in

924
00:32:22,140 --> 00:32:23,399
addition it cancels everything they put

925
00:32:23,399 --> 00:32:27,240
other cool so we have a frame the

926
00:32:27,240 --> 00:32:28,980
problem with niframe is that the content

927
00:32:28,980 --> 00:32:30,240
inside is not supposed to

928
00:32:30,240 --> 00:32:31,559
interact with the content

929
00:32:31,559 --> 00:32:33,179
outside there is a separation that the

930
00:32:33,179 --> 00:32:34,320
parent and the child

931
00:32:34,320 --> 00:32:36,840
except that  it is a protection that is

932
00:32:36,840 --> 00:32:38,580
made if you have control over

933
00:32:38,580 --> 00:32:40,320
the iframe we in this case we had

934
00:32:40,320 --> 00:32:42,779
control over the ifrem and the call which creates

935
00:32:42,779 --> 00:32:45,360
the frames so in fact we were able to use

936
00:32:45,360 --> 00:32:47,340
post message which is  planned for that when

937
00:32:47,340 --> 00:32:49,200
we have control over the two elements to

938
00:32:49,200 --> 00:32:51,600
retrieve the information so at this time

939
00:32:51,600 --> 00:32:55,080
we have a peload which is unlimited in

940
00:32:55,080 --> 00:32:56,760
terms of size and which we can retrieve

941
00:32:56,760 --> 00:33:00,600
in our attack script

942
00:33:00,600 --> 00:33:01,919
the problem is  is that we must execute it is only

943
00:33:01,919 --> 00:33:03,779
text that we can recover

944
00:33:03,779 --> 00:33:06,600
with this event so we try a small

945
00:33:06,600 --> 00:33:09,179
eval as I mentioned before to use

946
00:33:09,179 --> 00:33:12,480
the script source directive must

947
00:33:12,480 --> 00:33:15,480
contain a safeval unsaf

948
00:33:15,480 --> 00:33:17,460
use the step  they didn't use it

949
00:33:17,460 --> 00:33:20,640
that's very good so we say to ourselves we'll

950
00:33:20,640 --> 00:33:22,679
try with an image tag an

951
00:33:22,679 --> 00:33:24,960
empty source it generates an error so the One

952
00:33:24,960 --> 00:33:26,640
error and trigger we insert our

953
00:33:26,640 --> 00:33:29,279
content in it and there it goes because

954
00:33:29,279 --> 00:33:31,860
in fact  they paid for a safe in line

955
00:33:31,860 --> 00:33:34,380
so inside also don't use it if

956
00:33:34,380 --> 00:33:36,120
it's not necessary and in this case it was

957
00:33:36,120 --> 00:33:37,440
present it allowed us

958
00:33:37,440 --> 00:33:40,919
to run our script so there we have an

959
00:33:40,919 --> 00:33:42,899
unlimited peload that we can run

960
00:33:42,899 --> 00:33:46,080
so the limit of 255 doesn't really bother us

961
00:33:46,080 --> 00:33:47,399
anymore

962
00:33:47,399 --> 00:33:48,779
so here you can see this is the script

963
00:33:48,779 --> 00:33:51,240
we used roughly for the poke which

964
00:33:51,240 --> 00:33:54,659
will create the iframe at the very bottom and before

965
00:33:54,659 --> 00:33:57,600
adding a small event for when there is

966
00:33:57,600 --> 00:33:59,100
a  message we received from the

967
00:33:59,100 --> 00:34:01,740
post-message retrieve the content create

968
00:34:01,740 --> 00:34:04,140
the image add the One error and execute

969
00:34:04,140 --> 00:34:05,340
the code

970
00:34:05,340 --> 00:34:07,620
so that's nice but if you

971
00:34:07,620 --> 00:34:08,879
calculate the number of characters there

972
00:34:08,879 --> 00:34:11,820
is we arrive at  350 so we are above

973
00:34:11,820 --> 00:34:14,460
255 if you also remove the

974
00:34:14,460 --> 00:34:16,320
taxscript which is necessary to launch

975
00:34:16,320 --> 00:34:19,139
the code we are a little bit in concrete the

976
00:34:19,139 --> 00:34:21,659
problem well it's not that problematic

977
00:34:21,659 --> 00:34:23,460
because in fact we can have

978
00:34:23,460 --> 00:34:25,560
several jobs  so we just folded the

979
00:34:25,560 --> 00:34:27,418
code in several parts and we were

980
00:34:27,418 --> 00:34:29,099


981
00:34:29,099 --> 00:34:31,020
n't really executing it, we were able to progress a

982
00:34:31,020 --> 00:34:33,139
little more so the next step

983
00:34:33,139 --> 00:34:35,159
is to make a fake page for the

984
00:34:35,159 --> 00:34:36,239
payment so as you can see in

985
00:34:36,239 --> 00:34:37,560
the image  it's the kind of thing in

986
00:34:37,560 --> 00:34:40,080
physics is done quite often in css

987
00:34:40,080 --> 00:34:41,460
html it's even simpler we copy

988
00:34:41,460 --> 00:34:43,080
paste the code we balance in our

989
00:34:43,080 --> 00:34:45,599
iframe and no worries

990
00:34:45,599 --> 00:34:46,859
the problem is that once we have

991
00:34:46,859 --> 00:34:48,000
the maps of  credit once we have

992
00:34:48,000 --> 00:34:49,320
all the information we want we want to

993
00:34:49,320 --> 00:34:51,899
recover we have to get it out

994
00:34:51,899 --> 00:34:54,500
suddenly we make a little call to the party

995
00:34:54,500 --> 00:34:57,119
our site we balance in parameter

996
00:34:57,119 --> 00:34:58,740
all the dates that we received the number

997
00:34:58,740 --> 00:35:00,960
of  credit card the honor the

998
00:35:00,960 --> 00:35:02,880
expiration date all these little

999
00:35:02,880 --> 00:35:04,020
extra things that allow us to use it

1000
00:35:04,020 --> 00:35:07,080
and well they also had CFP for that

1001
00:35:07,080 --> 00:35:10,440
so self login which only says

1002
00:35:10,440 --> 00:35:12,960
the current site the current domain and

1003
00:35:12,960 --> 00:35:14,339
a list of domains  approved in addition

1004
00:35:14,339 --> 00:35:17,099
which was limited but not useful for

1005
00:35:17,099 --> 00:35:18,900
us either so we were again we

1006
00:35:18,900 --> 00:35:20,280


1007
00:35:20,280 --> 00:35:22,740
said to ourselves we will try for

1008
00:35:22,740 --> 00:35:24,000
educational needs because in fact

1009
00:35:24,000 --> 00:35:25,980
the iframe we used before could have

1010
00:35:25,980 --> 00:35:27,960
played also we have  just wanted to have a

1011
00:35:27,960 --> 00:35:29,880
little more fun in fact an image with

1012
00:35:29,880 --> 00:35:32,040
a source it comes to the same thing since it

1013
00:35:32,040 --> 00:35:33,540
will force the Brother to send the

1014
00:35:33,540 --> 00:35:36,359
data outside and well it bugs me

1015
00:35:36,359 --> 00:35:38,400
if there was also a star

1016
00:35:38,400 --> 00:35:40,800
so  very nice we saw in the CSP

1017
00:35:40,800 --> 00:35:42,839
it was star and all of the images that they

1018
00:35:42,839 --> 00:35:44,460
had static stuff so it's

1019
00:35:44,460 --> 00:35:46,500
very nice there we have the second evolution

1020
00:35:46,500 --> 00:35:48,119
of the peload so the first was

1021
00:35:48,119 --> 00:35:49,380
just to debug a little bit  to

1022
00:35:49,380 --> 00:35:51,300
understand where it came from we put everything

1023
00:35:51,300 --> 00:35:53,520
together if we had wanted because we

1024
00:35:53,520 --> 00:35:54,720
did each of the little bits in isolation

1025
00:35:54,720 --> 00:35:56,520
but if we had wanted we

1026
00:35:56,520 --> 00:35:58,020
could have put it all together and it would have

1027
00:35:58,020 --> 00:35:58,920
made a ball a little bit more

1028
00:35:58,920 --> 00:36:00,839
spicy we're going to say

1029
00:36:00,839 --> 00:36:03,540
and there you say it's over well no

1030
00:36:03,540 --> 00:36:07,260
little bonus in fact like the XSS

1031
00:36:07,260 --> 00:36:09,420
it was sorted on a profile we

1032
00:36:09,420 --> 00:36:11,660
discovered that this profile we saw it

1033
00:36:11,660 --> 00:36:13,800
when you swapped on the different

1034
00:36:13,800 --> 00:36:15,420
genres different profiles you didn't even have

1035
00:36:15,420 --> 00:36:17,400
need to click on the profile and

1036
00:36:17,400 --> 00:36:20,220
it was automatically triggered so if

1037
00:36:20,220 --> 00:36:22,380
we put the peload and when it is going to

1038
00:36:22,380 --> 00:36:24,720
run we will force the person who is

1039
00:36:24,720 --> 00:36:27,119
watching to change his profile through

1040
00:36:27,119 --> 00:36:30,119
the XS we could insert the ball

1041
00:36:30,119 --> 00:36:31,619
that we  wanted and it was answered like

1042
00:36:31,619 --> 00:36:32,820
a virus

1043
00:36:32,820 --> 00:36:35,760
so basically we said to each other nice

1044
00:36:35,760 --> 00:36:37,980
evolution for the little anecdote the

1045
00:36:37,980 --> 00:36:39,720
Pokémon there I discovered it when I

1046
00:36:39,720 --> 00:36:42,240
did the mega slides Dardagnan 6th

1047
00:36:42,240 --> 00:36:44,220
generation I had never heard of it

1048
00:36:44,220 --> 00:36:46,320
before

1049
00:36:46,320 --> 00:36:49,079
so  small summary to my sign we have an

1050
00:36:49,079 --> 00:36:51,660
attack that starts from a very simple XS

1051
00:36:51,660 --> 00:36:54,599
we will say on a profile with a

1052
00:36:54,599 --> 00:36:57,180
limited space that we were able to go through the little

1053
00:36:57,180 --> 00:36:59,099
tricks that I showed you

1054
00:36:59,099 --> 00:37:01,800
we give a page to us small detail  yes

1055
00:37:01,800 --> 00:37:03,680
the page as it was in the application

1056
00:37:03,680 --> 00:37:06,599
the URL did not change so we

1057
00:37:06,599 --> 00:37:08,400
changed the application the complete page

1058
00:37:08,400 --> 00:37:11,520
even an informed user saw

1059
00:37:11,520 --> 00:37:13,500
no difference hence the interest

1060
00:37:13,500 --> 00:37:15,060
of changing the application  arriving at

1061
00:37:15,060 --> 00:37:16,800
a pole or this kind of thing can

1062
00:37:16,800 --> 00:37:18,680
help so there

1063
00:37:18,680 --> 00:37:21,180
we change the payment page we

1064
00:37:21,180 --> 00:37:22,920
retrieve the information we filter them and

1065
00:37:22,920 --> 00:37:25,020
it responds like a virus we said to ourselves

1066
00:37:25,020 --> 00:37:28,320
jackpot especially Kévin see the

1067
00:37:28,320 --> 00:37:30,000
student side it can be  interesting in

1068
00:37:30,000 --> 00:37:32,280
addition so we say to ourselves we have to

1069
00:37:32,280 --> 00:37:34,560
report it that we do a good well detailed report

1070
00:37:34,560 --> 00:37:35,940


1071
00:37:35,940 --> 00:37:37,260
so it was perhaps a little

1072
00:37:37,260 --> 00:37:39,119
too detailed for the

1073
00:37:39,119 --> 00:37:40,500
Bad Bounty program team they didn't have too much

1074
00:37:40,500 --> 00:37:42,180
understood what we were doing they didn't

1075
00:37:42,180 --> 00:37:44,160
manage to reproduce

1076
00:37:44,160 --> 00:37:45,960
it was nice we were a little scared

1077
00:37:45,960 --> 00:37:46,859
what are they going to do are they

1078
00:37:46,859 --> 00:37:48,720
going to close us the postponement

1079
00:37:48,720 --> 00:37:50,180
always good stuff fortunately

1080
00:37:50,180 --> 00:37:52,680
the team in charge of the application

1081
00:37:52,680 --> 00:37:54,599
came, don't worry, it's fine, we

1082
00:37:54,599 --> 00:37:56,460
take control, we reproduced the case, we're going to

1083
00:37:56,460 --> 00:37:58,260
fix it, they did it all in

1084
00:37:58,260 --> 00:37:59,640
two days,

1085
00:37:59,640 --> 00:38:02,220
pretty good job, given the impact there is

1086
00:38:02,220 --> 00:38:04,079
had it's worth we'll say it's

1087
00:38:04,079 --> 00:38:05,400
the kind of small attack that can

1088
00:38:05,400 --> 00:38:07,800
make you sink a box on the stock exchange and

1089
00:38:07,800 --> 00:38:09,540
suddenly well they considered that it was

1090
00:38:09,540 --> 00:38:11,880
a medium with 1000 balls of Bounty

1091
00:38:11,880 --> 00:38:14,220
so yeah they may have  not

1092
00:38:14,220 --> 00:38:16,079
really understood the impact it's our

1093
00:38:16,079 --> 00:38:18,660
hypothesis but well here it is so the

1094
00:38:18,660 --> 00:38:20,820
correction was relatively simple they

1095
00:38:20,820 --> 00:38:22,859
escaped the lever input which

1096
00:38:22,859 --> 00:38:25,560
therefore had the job and escape what should have been

1097
00:38:25,560 --> 00:38:27,660
done from the beginning and they

1098
00:38:27,660 --> 00:38:29,880
improved a little bit  their aspects I think

1099
00:38:29,880 --> 00:38:31,200
it's again an excess elsewhere

1100
00:38:31,200 --> 00:38:33,900
it will be just as exploitable

1101
00:38:33,900 --> 00:38:34,980
but it's just that they try

1102
00:38:34,980 --> 00:38:36,540
to use a little bit of respect that's

1103
00:38:36,540 --> 00:38:38,280
why we first explain to you the

1104
00:38:38,280 --> 00:38:39,839
definition of how  put in place

1105
00:38:39,839 --> 00:38:41,760
CSP and be careful if you

1106
00:38:41,760 --> 00:38:43,380
leave holes as we have seen

1107
00:38:43,380 --> 00:38:45,359
in several examples there is

1108
00:38:45,359 --> 00:38:46,920
protection but the passes are sufficient

1109
00:38:46,920 --> 00:38:49,079
to completely cover the potential

1110
00:38:49,079 --> 00:38:50,480
drifts behind

1111
00:38:50,480 --> 00:38:52,640
so

1112
00:38:52,640 --> 00:38:55,020
the lessons learned with that at

1113
00:38:55,020 --> 00:38:57,000
clubbise we also have  a Bounty bug so

1114
00:38:57,000 --> 00:38:58,200
it's also interesting for us to

1115
00:38:58,200 --> 00:38:59,400
understand what we have to put in place

1116
00:38:59,400 --> 00:39:02,220
to help researchers and also it's

1117
00:39:02,220 --> 00:39:04,980
already a

1118
00:39:04,980 --> 00:39:07,140
test environment itself it's still not bad because

1119
00:39:07,140 --> 00:39:08,820
there typically  if we wanted to try

1120
00:39:08,820 --> 00:39:11,160
our time a little bit more well we

1121
00:39:11,160 --> 00:39:13,320
wanted credit cards it was not

1122
00:39:13,320 --> 00:39:15,660
necessarily the goal so we did well in

1123
00:39:15,660 --> 00:39:18,180
isolation and everything but we are ethical

1124
00:39:18,180 --> 00:39:19,440
it is not said that other researchers

1125
00:39:19,440 --> 00:39:21,540
are also ethical  and they say to themselves if

1126
00:39:21,540 --> 00:39:23,220
I find something like that I make a

1127
00:39:23,220 --> 00:39:25,800
little million I break that's it and then

1128
00:39:25,800 --> 00:39:27,060
after a while it's also

1129
00:39:27,060 --> 00:39:29,579
maybe the side there escape your use

1130
00:39:29,579 --> 00:39:31,440
a beam that's all  [ __ ] we talk about it

1131
00:39:31,440 --> 00:39:33,240
in all the safety courses it's one of the

1132
00:39:33,240 --> 00:39:34,980
first things we explain

1133
00:39:34,980 --> 00:39:36,420
we still find

1134
00:39:36,420 --> 00:39:38,280
extremely modern applications of it in

1135
00:39:38,280 --> 00:39:40,020
companies that are worth billions

1136
00:39:40,020 --> 00:39:42,000
behind we still find this kind of

1137
00:39:42,000 --> 00:39:43,740
thing it's very dangerous  you see

1138
00:39:43,740 --> 00:39:45,300
the impact behind a

1139
00:39:45,300 --> 00:39:48,119
stock market valuation can fall we had seen with

1140
00:39:48,119 --> 00:39:49,800
Yahoo just before the takeover this

1141
00:39:49,800 --> 00:39:50,660
day of stuff that hurts

1142
00:39:50,660 --> 00:39:53,880
financially and a stupid little thing but

1143
00:39:53,880 --> 00:39:56,640
server side validation is still

1144
00:39:56,640 --> 00:39:58,260
much better than doing it on the

1145
00:39:58,260 --> 00:40:00,359
client side for  the client side is good

1146
00:40:00,359 --> 00:40:01,920
for the user experience it's good

1147
00:40:01,920 --> 00:40:03,480
to have both but if you make a

1148
00:40:03,480 --> 00:40:05,099
choice between the two done on the

1149
00:40:05,099 --> 00:40:07,200
server side there is security with that

1150
00:40:07,200 --> 00:40:09,359
otherwise it's not much use

1151
00:40:09,359 --> 00:40:10,980
was for the limitation of the number

1152
00:40:10,980 --> 00:40:12,900
of characters because we had stayed at

1153
00:40:12,900 --> 00:40:14,820
40 characters I don't think we could have

1154
00:40:14,820 --> 00:40:16,140
done everything we did or

1155
00:40:16,140 --> 00:40:18,119
it would have been much more complicated

1156
00:40:18,119 --> 00:40:19,980
it's also interesting and above all

1157
00:40:19,980 --> 00:40:22,320
use  no stars in the

1158
00:40:22,320 --> 00:40:24,780
CSP guidelines especially if you have a

1159
00:40:24,780 --> 00:40:27,540
list ready to prove just keep that it's

1160
00:40:27,540 --> 00:40:29,700
a character that screws up

1161
00:40:29,700 --> 00:40:31,140
all the rules for you so it's a bit of a

1162
00:40:31,140 --> 00:40:34,800
shame and a small bonus anyway the

1163
00:40:34,800 --> 00:40:36,660
means of payment trust

1164
00:40:36,660 --> 00:40:37,980
another service take the steps yourself

1165
00:40:37,980 --> 00:40:40,740
it's too risky it's for the means

1166
00:40:40,740 --> 00:40:42,599
of payment it's when you do all

1167
00:40:42,599 --> 00:40:43,980
the things all the things that are

1168
00:40:43,980 --> 00:40:46,020
not your body business delegate them

1169
00:40:46,020 --> 00:40:47,820
it's much simpler and  you have

1170
00:40:47,820 --> 00:40:49,619
a kind of guarantee that water must

1171
00:40:49,619 --> 00:40:50,700
offer you a quality service

1172
00:40:50,700 --> 00:40:52,619
rather than having to hire

1173
00:40:52,619 --> 00:40:54,720
people yourself who have expertise that

1174
00:40:54,720 --> 00:40:55,859
you don't need for your

1175
00:40:55,859 --> 00:40:57,000
business

1176
00:40:57,000 --> 00:40:58,680
after that is some advice do you

1177
00:40:58,680 --> 00:41:00,000
want

1178
00:41:00,000 --> 00:41:02,040
here so we have more or less finished our

1179
00:41:02,040 --> 00:41:05,900
little bonus talk we have Jenkins t-shirts

1180
00:41:05,900 --> 00:41:09,300
a lot of emoji the same

1181
00:41:09,300 --> 00:41:11,460
finally say image like that so we

1182
00:41:11,460 --> 00:41:14,420
distribute t-shirts to you

1183
00:41:14,760 --> 00:41:17,280
we have a small package so there  there is a

1184
00:41:17,280 --> 00:41:18,599
talk just after there is no break

1185
00:41:18,599 --> 00:41:20,160
directly so come and see us at

1186
00:41:20,160 --> 00:41:23,400
the reception we ideally distribute to

1187
00:41:23,400 --> 00:41:25,980
Jenkins users like that it responds

1188
00:41:25,980 --> 00:41:27,119
a little bit to the good little thing so

1189
00:41:27,119 --> 00:41:29,339
come with a plugin name for example or

1190
00:41:29,339 --> 00:41:31,740
a  little story on that to

1191
00:41:31,740 --> 00:41:33,119
make sure you know what it is

1192
00:41:33,119 --> 00:41:36,060
like that we have about twenty we do

1193
00:41:36,060 --> 00:41:39,078
n't have for everyone so here we go

1194
00:41:40,980 --> 00:41:43,579
thank you

