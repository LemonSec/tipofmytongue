1
00:00:02,720 --> 00:00:09,210
so hello everybody<font color="#E5E5E5"> it's great that see</font>

2
00:00:07,649 --> 00:00:12,629
<font color="#CCCCCC">you</font><font color="#E5E5E5"> all here and thank you for attending</font>

3
00:00:09,210 --> 00:00:15,269
<font color="#CCCCCC">this</font><font color="#E5E5E5"> stop so my name is</font><font color="#CCCCCC"> Roman haben I'm</font>

4
00:00:12,630 --> 00:00:17,760
a malware researcher<font color="#E5E5E5"> working in 40 net</font>

5
00:00:15,269 --> 00:00:20,279
for the guard<font color="#E5E5E5"> in Singapore so my</font>

6
00:00:17,760 --> 00:00:23,010
co-author is<font color="#CCCCCC"> flow-through Bakura</font><font color="#E5E5E5"> jr.</font>

7
00:00:20,279 --> 00:00:25,619
he's a senior malware researcher and

8
00:00:23,010 --> 00:00:29,099
<font color="#E5E5E5">we're working both</font><font color="#CCCCCC"> on the same team</font>

9
00:00:25,619 --> 00:00:30,119
unfortunately he can join<font color="#E5E5E5"> us today so as</font>

10
00:00:29,099 --> 00:00:33,300
you can see<font color="#E5E5E5"> on the screen</font>

11
00:00:30,119 --> 00:00:36,719
our topic is sloppy<font color="#E5E5E5"> strike smoking the</font>

12
00:00:33,300 --> 00:00:38,819
lucky<font color="#E5E5E5"> ransomware code as we all know for</font>

13
00:00:36,719 --> 00:00:41,520
the<font color="#E5E5E5"> past year this ransomware has been</font>

14
00:00:38,820 --> 00:00:43,230
very<font color="#CCCCCC"> popular and became one of the one</font>

15
00:00:41,520 --> 00:00:48,300
of the<font color="#E5E5E5"> most prevalent family in the</font>

16
00:00:43,230 --> 00:00:50,940
ransomware industry so this is what you

17
00:00:48,300 --> 00:00:53,099
would<font color="#E5E5E5"> expect</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> this talk</font><font color="#CCCCCC"> first</font><font color="#E5E5E5"> we will</font>

18
00:00:50,940 --> 00:00:55,140
talk<font color="#E5E5E5"> we'll take a look on the success of</font>

19
00:00:53,100 --> 00:00:58,230
lucky compared to other popular

20
00:00:55,140 --> 00:01:00,960
ransomware<font color="#E5E5E5"> second I will share on</font><font color="#CCCCCC"> how</font>

21
00:00:58,230 --> 00:01:03,209
lucky<font color="#E5E5E5"> develop over</font><font color="#CCCCCC"> time so it's</font><font color="#E5E5E5"> like a</font>

22
00:01:00,960 --> 00:01:07,140
history of lucky<font color="#E5E5E5"> from its first</font>

23
00:01:03,210 --> 00:01:08,970
appearance last February 2016 third we

24
00:01:07,140 --> 00:01:10,820
will<font color="#CCCCCC"> delve in the detailed analysis of</font>

25
00:01:08,970 --> 00:01:14,340
<font color="#CCCCCC">fluffy so this includes</font><font color="#E5E5E5"> its</font>

26
00:01:10,820 --> 00:01:17,039
configuration<font color="#CCCCCC"> CNC communication and file</font>

27
00:01:14,340 --> 00:01:18,810
encryption<font color="#E5E5E5"> at the fourth one we will</font>

28
00:01:17,040 --> 00:01:22,229
share details on the system<font color="#CCCCCC"> that we</font>

29
00:01:18,810 --> 00:01:26,369
built to automatically harvest this

30
00:01:22,229 --> 00:01:28,619
<font color="#CCCCCC">lakis configuration</font><font color="#E5E5E5"> and then next having</font>

31
00:01:26,369 --> 00:01:30,540
<font color="#E5E5E5">monitored lucky for more than a year</font><font color="#CCCCCC"> we</font>

32
00:01:28,619 --> 00:01:33,090
will share our findings on the kill

33
00:01:30,540 --> 00:01:33,780
chain<font color="#E5E5E5"> specifically the spam campaign of</font>

34
00:01:33,090 --> 00:01:37,380
<font color="#E5E5E5">lucky</font>

35
00:01:33,780 --> 00:01:40,110
and lastly<font color="#E5E5E5"> additional stuff</font><font color="#CCCCCC"> that we</font>

36
00:01:37,380 --> 00:01:42,780
<font color="#CCCCCC">found to be interesting and</font><font color="#E5E5E5"> after that</font>

37
00:01:40,110 --> 00:01:47,060
presentation there will<font color="#E5E5E5"> be some Q&A so</font>

38
00:01:42,780 --> 00:01:49,740
let's begin<font color="#CCCCCC"> so first on the list</font>

39
00:01:47,060 --> 00:01:52,140
<font color="#E5E5E5">everyone must be familiar</font><font color="#CCCCCC"> with this</font><font color="#E5E5E5"> so</font>

40
00:01:49,740 --> 00:01:54,419
this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> the one a cry ransomware note</font>

41
00:01:52,140 --> 00:01:58,140
this<font color="#CCCCCC"> is</font><font color="#E5E5E5"> the ransomware that made an</font>

42
00:01:54,420 --> 00:02:01,280
outbreak but meet me<font color="#E5E5E5"> so I did a little</font>

43
00:01:58,140 --> 00:02:04,170
<font color="#E5E5E5">research on one a cry that hits</font>

44
00:02:01,280 --> 00:02:06,000
Switzerland<font color="#E5E5E5"> and I think</font><font color="#CCCCCC"> only around 800</font>

45
00:02:04,170 --> 00:02:09,869
was hit so that's a good<font color="#E5E5E5"> thing for</font>

46
00:02:06,000 --> 00:02:11,849
<font color="#E5E5E5">Switzerland so next are the interesting</font>

47
00:02:09,869 --> 00:02:13,590
in wanna cry is it<font color="#CCCCCC"> wasn't</font><font color="#E5E5E5"> the typical</font>

48
00:02:11,849 --> 00:02:17,190
ransomware that arrives by

49
00:02:13,590 --> 00:02:19,470
spam email or malicious web websites<font color="#E5E5E5"> so</font>

50
00:02:17,190 --> 00:02:23,760
it took<font color="#E5E5E5"> advantage</font><font color="#CCCCCC"> of the leaked exploit</font>

51
00:02:19,470 --> 00:02:26,099
from the NSA<font color="#E5E5E5"> attack tools so with this</font>

52
00:02:23,760 --> 00:02:28,049
it<font color="#E5E5E5"> was able</font><font color="#CCCCCC"> to hijack hundreds of</font>

53
00:02:26,099 --> 00:02:31,920
thousands<font color="#E5E5E5"> of computer across the globe</font>

54
00:02:28,050 --> 00:02:37,290
in a matter of<font color="#E5E5E5"> hours so let's take a</font>

55
00:02:31,920 --> 00:02:39,750
look at the next<font color="#E5E5E5"> one so this is the</font>

56
00:02:37,290 --> 00:02:41,900
server ransomware node and this

57
00:02:39,750 --> 00:02:45,030
ransomware<font color="#E5E5E5"> is one of the most successful</font>

58
00:02:41,900 --> 00:02:46,019
<font color="#E5E5E5">ransomware as a service that is</font><font color="#CCCCCC"> offered</font>

59
00:02:45,030 --> 00:02:49,470
in<font color="#E5E5E5"> the dark web</font>

60
00:02:46,019 --> 00:02:52,410
so servers greater our servers<font color="#CCCCCC"> cretur</font>

61
00:02:49,470 --> 00:02:54,450
are particularly<font color="#E5E5E5"> nurturing when it comes</font>

62
00:02:52,410 --> 00:02:56,430
to this ransomware<font color="#E5E5E5"> that it they</font>

63
00:02:54,450 --> 00:02:58,950
constantly<font color="#E5E5E5"> update and make improvements</font>

64
00:02:56,430 --> 00:03:01,440
<font color="#CCCCCC">to be more effective</font><font color="#E5E5E5"> this is the reason</font>

65
00:02:58,950 --> 00:03:03,540
why it still remains prevalent<font color="#E5E5E5"> so</font>

66
00:03:01,440 --> 00:03:05,849
comparing the two<font color="#E5E5E5"> we</font><font color="#CCCCCC"> have</font><font color="#E5E5E5"> one a cry</font>

67
00:03:03,540 --> 00:03:08,609
<font color="#E5E5E5">which had a short life lifespan that</font>

68
00:03:05,849 --> 00:03:10,349
<font color="#CCCCCC">lasted less than a month while in the</font>

69
00:03:08,610 --> 00:03:11,879
<font color="#E5E5E5">other hand we have the server</font><font color="#CCCCCC"> run</font>

70
00:03:10,349 --> 00:03:16,828
somewhere which has been in the

71
00:03:11,879 --> 00:03:19,048
<font color="#E5E5E5">ransomware for quite some</font><font color="#CCCCCC"> time and</font><font color="#E5E5E5"> now</font>

72
00:03:16,829 --> 00:03:23,430
we have here<font color="#E5E5E5"> the lucky ransomware</font>

73
00:03:19,049 --> 00:03:25,889
so having seen wanna cry and server how

74
00:03:23,430 --> 00:03:28,709
do you think<font color="#CCCCCC"> will lucky</font><font color="#E5E5E5"> will match</font><font color="#CCCCCC"> up</font>

75
00:03:25,889 --> 00:03:31,019
with<font color="#E5E5E5"> these to run</font><font color="#CCCCCC"> summers</font><font color="#E5E5E5"> so to give us</font>

76
00:03:28,709 --> 00:03:33,540
an idea<font color="#CCCCCC"> on how these three runs</font>

77
00:03:31,019 --> 00:03:35,430
somewhere matches up<font color="#E5E5E5"> we will take</font><font color="#CCCCCC"> a look</font>

78
00:03:33,540 --> 00:03:38,970
on<font color="#E5E5E5"> the lock in profits made by this</font>

79
00:03:35,430 --> 00:03:41,220
ransomware<font color="#E5E5E5"> since most ransomware are the</font>

80
00:03:38,970 --> 00:03:45,419
purpose of ransomware our profits<font color="#CCCCCC"> so we</font>

81
00:03:41,220 --> 00:03:49,049
will compare<font color="#CCCCCC"> their profits so how</font>

82
00:03:45,419 --> 00:03:51,359
profitable is ransomware<font color="#E5E5E5"> so what we have</font>

83
00:03:49,049 --> 00:03:52,950
<font color="#CCCCCC">here is a chart</font><font color="#E5E5E5"> of the profits made</font><font color="#CCCCCC"> by</font>

84
00:03:51,359 --> 00:03:56,340
the most prevalent<font color="#E5E5E5"> ransomware</font>

85
00:03:52,950 --> 00:03:58,048
so this has been research from the

86
00:03:56,340 --> 00:04:00,359
<font color="#E5E5E5">Google's research team that trace</font>

87
00:03:58,049 --> 00:04:02,819
<font color="#E5E5E5">end-to-end payment from</font><font color="#CCCCCC"> the Bitcoin</font>

88
00:04:00,359 --> 00:04:05,940
wallets<font color="#E5E5E5"> used by ransomware</font><font color="#CCCCCC"> so whenever</font>

89
00:04:02,819 --> 00:04:08,220
you<font color="#CCCCCC"> see the runs ransomware side you</font>

90
00:04:05,940 --> 00:04:10,290
will see a Bitcoin wallet<font color="#CCCCCC"> of this of</font>

91
00:04:08,220 --> 00:04:12,959
this transformer<font color="#E5E5E5"> so that's the one that</font>

92
00:04:10,290 --> 00:04:15,870
<font color="#E5E5E5">Google trace so you can find out more in</font>

93
00:04:12,959 --> 00:04:18,720
<font color="#CCCCCC">the reference</font><font color="#E5E5E5"> le dotnet he explained</font>

94
00:04:15,870 --> 00:04:22,740
<font color="#E5E5E5">more on how they trace this</font><font color="#CCCCCC"> bit Bitcoin</font>

95
00:04:18,720 --> 00:04:25,860
payments so now<font color="#CCCCCC"> taking</font><font color="#E5E5E5"> the data included</font>

96
00:04:22,740 --> 00:04:27,370
here are ransomware from year 2013 up to

97
00:04:25,860 --> 00:04:31,150
the second<font color="#E5E5E5"> quarter of</font>

98
00:04:27,370 --> 00:04:32,979
<font color="#CCCCCC">c17 so it's quite updated now</font><font color="#E5E5E5"> taking a</font>

99
00:04:31,150 --> 00:04:35,349
<font color="#E5E5E5">look at the graph</font><font color="#CCCCCC"> we can see that</font><font color="#E5E5E5"> lucky</font>

100
00:04:32,979 --> 00:04:39,039
earned<font color="#E5E5E5"> whopping seven point eight</font>

101
00:04:35,350 --> 00:04:41,770
million<font color="#CCCCCC"> dollars</font><font color="#E5E5E5"> and served server</font><font color="#CCCCCC"> six</font>

102
00:04:39,040 --> 00:04:44,620
point nine million dollars<font color="#CCCCCC"> and both of</font>

103
00:04:41,770 --> 00:04:47,849
them took major of the<font color="#E5E5E5"> profits with</font>

104
00:04:44,620 --> 00:04:50,650
<font color="#E5E5E5">lucky leading the way by a short margin</font>

105
00:04:47,850 --> 00:04:52,990
comparing<font color="#E5E5E5"> to one a cry so if you see in</font>

106
00:04:50,650 --> 00:04:56,049
the<font color="#CCCCCC"> bottom it earned only around a</font>

107
00:04:52,990 --> 00:04:58,479
hundred thousand dollars<font color="#CCCCCC"> so</font><font color="#E5E5E5"> even though</font>

108
00:04:56,050 --> 00:05:01,630
<font color="#CCCCCC">wanna cry became a household name</font>

109
00:04:58,479 --> 00:05:05,440
<font color="#CCCCCC">I lost me why</font><font color="#E5E5E5"> wasn't its popularity</font>

110
00:05:01,630 --> 00:05:06,550
turned into direct profits<font color="#E5E5E5"> so the reason</font>

111
00:05:05,440 --> 00:05:09,789
could be<font color="#E5E5E5"> first</font>

112
00:05:06,550 --> 00:05:11,350
the famous<font color="#E5E5E5"> kill switch that</font><font color="#CCCCCC"> a registered</font>

113
00:05:09,789 --> 00:05:15,430
domain<font color="#E5E5E5"> could stop immediately the</font>

114
00:05:11,350 --> 00:05:17,530
infection<font color="#E5E5E5"> second victims just didn't</font>

115
00:05:15,430 --> 00:05:21,039
want to<font color="#E5E5E5"> pay since decryption had issues</font>

116
00:05:17,530 --> 00:05:23,229
so when researchers are reversed wanna

117
00:05:21,039 --> 00:05:25,090
cry<font color="#E5E5E5"> they saw some issues that there were</font>

118
00:05:23,229 --> 00:05:28,630
no assurance that<font color="#E5E5E5"> the files would be</font>

119
00:05:25,090 --> 00:05:30,940
decrypted back and third since wanna cry

120
00:05:28,630 --> 00:05:32,440
took advantage of an exploit which

121
00:05:30,940 --> 00:05:33,789
<font color="#CCCCCC">already had an available available</font>

122
00:05:32,440 --> 00:05:36,190
available patch

123
00:05:33,789 --> 00:05:38,409
<font color="#E5E5E5">I think last March or April this means</font>

124
00:05:36,190 --> 00:05:42,250
that<font color="#E5E5E5"> update updated computers weren't</font>

125
00:05:38,410 --> 00:05:45,010
vulnerable at<font color="#E5E5E5"> that time so the major</font>

126
00:05:42,250 --> 00:05:48,010
difference of<font color="#E5E5E5"> a difference of one a cry</font>

127
00:05:45,010 --> 00:05:50,080
from lucky and server<font color="#E5E5E5"> is that lucky and</font>

128
00:05:48,010 --> 00:05:52,090
server uses the business model called

129
00:05:50,080 --> 00:05:55,300
ransomware<font color="#CCCCCC"> as a service</font>

130
00:05:52,090 --> 00:05:58,690
so since<font color="#E5E5E5"> ransomware is</font><font color="#CCCCCC"> a big business on</font>

131
00:05:55,300 --> 00:06:00,669
the dark<font color="#E5E5E5"> web its creators realized that</font>

132
00:05:58,690 --> 00:06:03,400
they could make more<font color="#E5E5E5"> money</font><font color="#CCCCCC"> not just by</font>

133
00:06:00,669 --> 00:06:05,460
extorting<font color="#E5E5E5"> digital currency by themselves</font>

134
00:06:03,400 --> 00:06:07,659
from their victims but by selling

135
00:06:05,460 --> 00:06:09,580
selling<font color="#E5E5E5"> the</font><font color="#CCCCCC"> ransomware key to</font><font color="#E5E5E5"> other</font>

136
00:06:07,660 --> 00:06:15,490
cyber criminals<font color="#E5E5E5"> that will help spread</font>

137
00:06:09,580 --> 00:06:18,039
<font color="#CCCCCC">the ransomware</font><font color="#E5E5E5"> so yeah so majority</font><font color="#CCCCCC"> of</font>

138
00:06:15,490 --> 00:06:19,810
<font color="#E5E5E5">the success of lucky as seen in</font><font color="#CCCCCC"> in its</font>

139
00:06:18,039 --> 00:06:22,330
profits<font color="#CCCCCC"> could</font><font color="#E5E5E5"> be</font><font color="#CCCCCC"> attributed to</font><font color="#E5E5E5"> its</font>

140
00:06:19,810 --> 00:06:25,030
affiliate program<font color="#CCCCCC"> so when we say</font>

141
00:06:22,330 --> 00:06:27,219
affiliate program it is a program where

142
00:06:25,030 --> 00:06:30,429
<font color="#E5E5E5">third party cyber criminals or other</font>

143
00:06:27,220 --> 00:06:34,330
cyber criminals help spread the<font color="#CCCCCC"> locky</font>

144
00:06:30,430 --> 00:06:36,729
ransomware<font color="#E5E5E5"> and and with this in the</font>

145
00:06:34,330 --> 00:06:39,460
<font color="#E5E5E5">potential victims they would have a pay</font>

146
00:06:36,729 --> 00:06:41,349
per install<font color="#E5E5E5"> commission so both earned</font>

147
00:06:39,460 --> 00:06:43,210
the<font color="#E5E5E5"> crater of</font><font color="#CCCCCC"> lucky</font>

148
00:06:41,350 --> 00:06:46,240
and<font color="#E5E5E5"> the other cyber criminals will have</font>

149
00:06:43,210 --> 00:06:48,609
<font color="#CCCCCC">profits</font><font color="#E5E5E5"> so here are the list of the</font>

150
00:06:46,240 --> 00:06:51,730
athlete IDs<font color="#E5E5E5"> that were that we have</font>

151
00:06:48,610 --> 00:06:54,520
<font color="#E5E5E5">determined so far and how and had found</font>

152
00:06:51,730 --> 00:06:56,860
<font color="#E5E5E5">at least eight affiliate IDs so we</font>

153
00:06:54,520 --> 00:07:01,240
<font color="#E5E5E5">classified this affiliate IDs into</font>

154
00:06:56,860 --> 00:07:05,320
<font color="#E5E5E5">methods use so such as a spam email and</font>

155
00:07:01,240 --> 00:07:07,690
<font color="#E5E5E5">compromised sites so we have</font><font color="#CCCCCC"> 1 3 5</font><font color="#E5E5E5"> 15</font>

156
00:07:05,320 --> 00:07:10,750
and<font color="#E5E5E5"> 21 and we observe that this</font>

157
00:07:07,690 --> 00:07:13,150
affiliate<font color="#CCCCCC"> IDs use the use the adopt</font>

158
00:07:10,750 --> 00:07:15,100
vector for spam email and<font color="#E5E5E5"> this spam</font>

159
00:07:13,150 --> 00:07:18,099
email can contain any malicious

160
00:07:15,100 --> 00:07:19,510
<font color="#E5E5E5">attachment like scripts</font><font color="#CCCCCC"> MS</font><font color="#E5E5E5"> Office PDF or</font>

161
00:07:18,100 --> 00:07:25,000
any other file types

162
00:07:19,510 --> 00:07:27,010
then for<font color="#CCCCCC"> 1324 and 1e we observe that</font>

163
00:07:25,000 --> 00:07:29,410
this<font color="#CCCCCC"> our this came from compromised</font>

164
00:07:27,010 --> 00:07:34,990
sites<font color="#CCCCCC"> that redirect to nuclear or</font>

165
00:07:29,410 --> 00:07:37,570
neutrino exploit kit so so to keep track

166
00:07:34,990 --> 00:07:40,480
of<font color="#CCCCCC"> these installs lucky binaries contain</font>

167
00:07:37,570 --> 00:07:43,420
this athlete<font color="#E5E5E5"> IDs embedded in its lucky</font>

168
00:07:40,480 --> 00:07:44,380
lucky binary code<font color="#E5E5E5"> so we will talk about</font>

169
00:07:43,420 --> 00:07:47,830
this<font color="#E5E5E5"> more later</font>

170
00:07:44,380 --> 00:07:50,409
<font color="#E5E5E5">so aside from athlete distribution</font>

171
00:07:47,830 --> 00:07:53,280
method<font color="#E5E5E5"> lucky also aggressively updates</font>

172
00:07:50,410 --> 00:07:57,310
itself<font color="#E5E5E5"> for some reason like AV evasion</font>

173
00:07:53,280 --> 00:07:59,229
<font color="#E5E5E5">configuration improvement and so on so</font>

174
00:07:57,310 --> 00:08:03,700
now let's take<font color="#E5E5E5"> a look at Lucky's</font>

175
00:07:59,230 --> 00:08:07,720
development for the<font color="#E5E5E5"> past year so in</font>

176
00:08:03,700 --> 00:08:11,020
<font color="#E5E5E5">February it it first appeared in</font><font color="#CCCCCC"> a</font>

177
00:08:07,720 --> 00:08:13,360
<font color="#E5E5E5">February 2016 so the sample</font><font color="#CCCCCC"> if you are</font>

178
00:08:11,020 --> 00:08:16,030
the sample was pretty<font color="#CCCCCC"> straightforward so</font>

179
00:08:13,360 --> 00:08:19,090
if you do reverse<font color="#CCCCCC"> engineering then once</font>

180
00:08:16,030 --> 00:08:21,280
you open<font color="#E5E5E5"> it then it's not</font><font color="#CCCCCC"> pack or not</font>

181
00:08:19,090 --> 00:08:24,369
encrypted so reversing it is quite easy

182
00:08:21,280 --> 00:08:27,219
<font color="#CCCCCC">and it was</font><font color="#E5E5E5"> easily identified as lucky</font>

183
00:08:24,370 --> 00:08:30,100
since it<font color="#CCCCCC"> uses the</font><font color="#E5E5E5"> hard-coded lucky</font>

184
00:08:27,220 --> 00:08:32,530
string for its registry key<font color="#E5E5E5"> so once you</font>

185
00:08:30,100 --> 00:08:34,719
see the lucky registry key<font color="#CCCCCC"> it means that</font>

186
00:08:32,530 --> 00:08:37,179
it's from lucky<font color="#E5E5E5"> ransomware</font>

187
00:08:34,719 --> 00:08:39,280
then as<font color="#E5E5E5"> mentioned on the affiliate</font>

188
00:08:37,179 --> 00:08:41,228
program from the previous slides so

189
00:08:39,280 --> 00:08:43,329
under the configuration<font color="#CCCCCC"> you</font><font color="#E5E5E5"> can see the</font>

190
00:08:41,229 --> 00:08:49,330
affiliate ID<font color="#E5E5E5"> so it's</font><font color="#CCCCCC"> included there and</font>

191
00:08:43,330 --> 00:08:51,760
the CNC servers so the next month<font color="#E5E5E5"> the</font>

192
00:08:49,330 --> 00:08:54,380
sample<font color="#E5E5E5"> is already</font><font color="#CCCCCC"> pack</font><font color="#E5E5E5"> so after a month</font>

193
00:08:51,760 --> 00:08:57,120
<font color="#E5E5E5">it</font><font color="#CCCCCC"> released</font><font color="#E5E5E5"> it pop and</font>

194
00:08:54,380 --> 00:09:01,350
<font color="#E5E5E5">encrypted itself and its configuration</font>

195
00:08:57,120 --> 00:09:04,860
<font color="#E5E5E5">is also encrypted its registry key which</font>

196
00:09:01,350 --> 00:09:09,180
was former lucky<font color="#CCCCCC"> is now based from</font><font color="#E5E5E5"> from</font>

197
00:09:04,860 --> 00:09:11,610
the<font color="#CCCCCC"> computers volume GID the DGE</font><font color="#E5E5E5"> is now</font>

198
00:09:09,180 --> 00:09:14,160
updated and now based on the<font color="#CCCCCC"> DJI</font><font color="#E5E5E5"> seed</font>

199
00:09:11,610 --> 00:09:17,209
<font color="#E5E5E5">found from</font><font color="#CCCCCC"> his</font><font color="#E5E5E5"> config so if you can see</font>

200
00:09:14,160 --> 00:09:20,930
the font in red<font color="#E5E5E5"> it's the added</font>

201
00:09:17,209 --> 00:09:24,359
configuration<font color="#E5E5E5"> flags in the configuration</font>

202
00:09:20,930 --> 00:09:26,219
so in just<font color="#E5E5E5"> a month this ransomware</font>

203
00:09:24,360 --> 00:09:32,190
already shows<font color="#E5E5E5"> its big impact in the</font>

204
00:09:26,220 --> 00:09:34,920
world for April 2016<font color="#E5E5E5"> another improvement</font>

205
00:09:32,190 --> 00:09:38,040
<font color="#E5E5E5">is the custom encryption of HTTP</font>

206
00:09:34,920 --> 00:09:40,620
communication with the<font color="#CCCCCC"> CNC so the HTTP</font>

207
00:09:38,040 --> 00:09:43,980
traffic<font color="#E5E5E5"> are encrypted now using both</font><font color="#CCCCCC"> AES</font>

208
00:09:40,620 --> 00:09:47,640
and<font color="#E5E5E5"> RSA so it's more difficult to trace</font>

209
00:09:43,980 --> 00:09:50,850
and and for the<font color="#E5E5E5"> configuration there's</font>

210
00:09:47,640 --> 00:09:57,149
again another another<font color="#CCCCCC"> entry which is the</font>

211
00:09:50,850 --> 00:10:00,140
URL<font color="#E5E5E5"> pad so in May 2016 the encrypted</font>

212
00:09:57,149 --> 00:10:03,209
<font color="#E5E5E5">HTTP POST data is now encoded using</font>

213
00:10:00,140 --> 00:10:05,310
<font color="#E5E5E5">percent-encoding one possible reason of</font>

214
00:10:03,209 --> 00:10:07,920
this change is to<font color="#E5E5E5"> avoid suspicious look</font>

215
00:10:05,310 --> 00:10:11,670
of pocket since<font color="#CCCCCC"> percent-encoding is</font>

216
00:10:07,920 --> 00:10:15,360
usually used<font color="#E5E5E5"> by legitimate</font><font color="#CCCCCC"> sites so we</font>

217
00:10:11,670 --> 00:10:17,189
<font color="#CCCCCC">move on to June 2016 it's loader it's</font>

218
00:10:15,360 --> 00:10:20,480
loader now requires an argument to

219
00:10:17,190 --> 00:10:23,100
execute it properly<font color="#CCCCCC"> so actually this</font>

220
00:10:20,480 --> 00:10:25,320
this<font color="#E5E5E5"> argument like one two</font><font color="#CCCCCC"> three and</font>

221
00:10:23,100 --> 00:10:28,170
<font color="#E5E5E5">three two one is a decryption</font><font color="#CCCCCC"> key used</font>

222
00:10:25,320 --> 00:10:30,740
to decrypt<font color="#E5E5E5"> the next layers of code so if</font>

223
00:10:28,170 --> 00:10:33,089
you<font color="#E5E5E5"> execute this sample without this</font>

224
00:10:30,740 --> 00:10:36,420
<font color="#E5E5E5">this arguments then it won't run</font>

225
00:10:33,089 --> 00:10:39,540
properly<font color="#CCCCCC"> so lucky use this as a Anti</font>

226
00:10:36,420 --> 00:10:42,360
sandbox technique so if you if you load

227
00:10:39,540 --> 00:10:43,800
this sample<font color="#E5E5E5"> without the argument so it</font>

228
00:10:42,360 --> 00:10:46,010
will that<font color="#E5E5E5"> it will not show its true</font>

229
00:10:43,800 --> 00:10:51,930
payload<font color="#E5E5E5"> so it will not</font><font color="#CCCCCC"> be detected</font><font color="#E5E5E5"> by</font>

230
00:10:46,010 --> 00:10:55,470
sandbox next thing also in June lucky

231
00:10:51,930 --> 00:10:59,069
changes extension of its encrypted files

232
00:10:55,470 --> 00:11:00,660
into Zepto<font color="#CCCCCC"> this update causes caused a</font>

233
00:10:59,070 --> 00:11:02,550
<font color="#CCCCCC">little</font><font color="#E5E5E5"> bit of confusion to some</font>

234
00:11:00,660 --> 00:11:04,380
researchers at that time<font color="#E5E5E5"> which they</font>

235
00:11:02,550 --> 00:11:07,410
thought it is a new ransomware family

236
00:11:04,380 --> 00:11:09,810
since usually<font color="#E5E5E5"> ransomware</font><font color="#CCCCCC"> family space</font>

237
00:11:07,410 --> 00:11:14,040
the extension<font color="#E5E5E5"> added to the encrypted</font>

238
00:11:09,810 --> 00:11:18,599
files so apparently<font color="#E5E5E5"> lucky Inceptor was</font>

239
00:11:14,040 --> 00:11:22,139
just the same and in the same month in

240
00:11:18,600 --> 00:11:25,019
July<font color="#CCCCCC"> next month</font><font color="#E5E5E5"> it added</font><font color="#CCCCCC"> the capability</font>

241
00:11:22,139 --> 00:11:26,930
<font color="#E5E5E5">of online encryption so when we say</font>

242
00:11:25,019 --> 00:11:29,939
offline encryption it doesn't need any

243
00:11:26,930 --> 00:11:31,709
any connection<font color="#CCCCCC"> to its CNC</font><font color="#E5E5E5"> so even though</font>

244
00:11:29,939 --> 00:11:33,779
<font color="#CCCCCC">even</font><font color="#E5E5E5"> though there's no network traffic</font>

245
00:11:31,709 --> 00:11:36,930
<font color="#CCCCCC">as long as it runs in your computer then</font>

246
00:11:33,779 --> 00:11:41,879
it will still<font color="#CCCCCC"> be encrypted so it also</font>

247
00:11:36,930 --> 00:11:44,008
<font color="#E5E5E5">added the ampersand v equals</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> or it</font>

248
00:11:41,879 --> 00:11:46,019
could<font color="#CCCCCC"> mean like</font><font color="#E5E5E5"> version 2 of lucky which</font>

249
00:11:44,009 --> 00:11:49,050
has the offline and online<font color="#CCCCCC"> encrypt</font>

250
00:11:46,019 --> 00:11:53,910
encryption capability<font color="#CCCCCC"> we'll discuss this</font>

251
00:11:49,050 --> 00:11:56,699
more later<font color="#E5E5E5"> then in</font><font color="#CCCCCC"> August</font><font color="#E5E5E5"> we saw that</font>

252
00:11:53,910 --> 00:12:00,329
Lucky's binary switch from executable to

253
00:11:56,699 --> 00:12:02,939
DLL which<font color="#CCCCCC"> is loaded using run DLL 32</font>

254
00:12:00,329 --> 00:12:05,430
that<font color="#CCCCCC"> acts so one possible reason for</font>

255
00:12:02,939 --> 00:12:06,990
<font color="#E5E5E5">this</font><font color="#CCCCCC"> update is</font><font color="#E5E5E5"> to bypass</font><font color="#CCCCCC"> chips</font><font color="#E5E5E5"> as some</font>

256
00:12:05,430 --> 00:12:12,709
security vendors will not perform

257
00:12:06,990 --> 00:12:12,709
<font color="#E5E5E5">behavior analysis on run DLL 32 that</font><font color="#CCCCCC"> x'x</font>

258
00:12:14,329 --> 00:12:21,329
<font color="#E5E5E5">September we saw that lucky is the and</font>

259
00:12:18,620 --> 00:12:24,060
<font color="#E5E5E5">insists installer package as its loader</font>

260
00:12:21,329 --> 00:12:28,880
<font color="#E5E5E5">so this could possibly evade</font><font color="#CCCCCC"> AV</font><font color="#E5E5E5"> detect</font>

261
00:12:24,060 --> 00:12:31,050
<font color="#E5E5E5">that a V</font><font color="#CCCCCC"> direction and</font><font color="#E5E5E5"> also it causes</font>

262
00:12:28,880 --> 00:12:33,209
<font color="#E5E5E5">problems to create a more generic</font>

263
00:12:31,050 --> 00:12:38,699
signature since a lot of malware<font color="#E5E5E5"> uses</font>

264
00:12:33,209 --> 00:12:40,800
this and as<font color="#E5E5E5"> is power</font><font color="#CCCCCC"> and on the same</font>

265
00:12:38,699 --> 00:12:45,329
month<font color="#E5E5E5"> it changed again</font><font color="#CCCCCC"> it's</font><font color="#E5E5E5"> extension to</font>

266
00:12:40,800 --> 00:12:49,529
<font color="#E5E5E5">that Odin so lucky continues to update</font>

267
00:12:45,329 --> 00:12:51,959
itself every month and in October it

268
00:12:49,529 --> 00:12:54,779
continues to spread spread in massive

269
00:12:51,959 --> 00:12:58,529
spam campaigns and now<font color="#E5E5E5"> it changes its</font>

270
00:12:54,779 --> 00:13:01,259
extension to<font color="#CCCCCC"> that shit and</font><font color="#E5E5E5"> doctor sorry</font>

271
00:12:58,529 --> 00:13:06,139
so yeah<font color="#E5E5E5"> and also that you are right</font>

272
00:13:01,259 --> 00:13:09,209
<font color="#E5E5E5">change to</font><font color="#CCCCCC"> Linux us</font><font color="#E5E5E5"> that page we so so</font>

273
00:13:06,139 --> 00:13:11,309
lucky regularly changes the<font color="#CCCCCC"> URI since</font>

274
00:13:09,209 --> 00:13:14,719
this URI<font color="#E5E5E5"> is used for its</font><font color="#CCCCCC"> CNC</font>

275
00:13:11,309 --> 00:13:17,430
communication so if they<font color="#E5E5E5"> use the same</font>

276
00:13:14,720 --> 00:13:20,459
<font color="#E5E5E5">your</font><font color="#CCCCCC"> I it's most probably block already</font>

277
00:13:17,430 --> 00:13:21,390
by security vendor so they constantly

278
00:13:20,459 --> 00:13:25,229
change it<font color="#E5E5E5"> to</font>

279
00:13:21,390 --> 00:13:28,880
evade this detection<font color="#E5E5E5"> moving on from</font>

280
00:13:25,230 --> 00:13:32,910
November so yeah some<font color="#CCCCCC"> Ana</font><font color="#E5E5E5"> again</font>

281
00:13:28,880 --> 00:13:37,910
<font color="#E5E5E5">extension extension change that AC R and</font>

282
00:13:32,910 --> 00:13:42,719
that<font color="#CCCCCC"> GCC</font><font color="#E5E5E5"> and URI so not much major</font>

283
00:13:37,910 --> 00:13:45,420
changes<font color="#E5E5E5"> then in December before 2016</font>

284
00:13:42,720 --> 00:13:48,810
<font color="#E5E5E5">ended it</font><font color="#CCCCCC"> change again it's extension</font><font color="#E5E5E5"> to</font>

285
00:13:45,420 --> 00:13:50,130
the that Osiris<font color="#E5E5E5"> so as you have</font><font color="#CCCCCC"> seen</font>

286
00:13:48,810 --> 00:13:52,770
there's a lot of changes in<font color="#E5E5E5"> the</font>

287
00:13:50,130 --> 00:13:55,620
extension<font color="#E5E5E5"> but generally they are</font><font color="#CCCCCC"> all</font>

288
00:13:52,770 --> 00:13:58,110
lucky<font color="#E5E5E5"> ransomware</font><font color="#CCCCCC"> and common during</font>

289
00:13:55,620 --> 00:14:01,700
<font color="#E5E5E5">December cyber criminals and luck</font>

290
00:13:58,110 --> 00:14:04,200
included<font color="#E5E5E5"> take a Christmas break so and</font>

291
00:14:01,700 --> 00:14:06,630
malware hits<font color="#CCCCCC"> drop down for lucky in</font>

292
00:14:04,200 --> 00:14:10,950
December and it goes

293
00:14:06,630 --> 00:14:13,410
also for and 2017<font color="#E5E5E5"> came so lucky extended</font>

294
00:14:10,950 --> 00:14:16,080
this break<font color="#E5E5E5"> at the first quarter to</font>

295
00:14:13,410 --> 00:14:20,670
January February and March<font color="#CCCCCC"> so we didn't</font>

296
00:14:16,080 --> 00:14:22,860
<font color="#CCCCCC">notice any spam campaign and</font><font color="#E5E5E5"> our respect</font>

297
00:14:20,670 --> 00:14:25,640
speculation<font color="#E5E5E5"> was that lucky orders was</font>

298
00:14:22,860 --> 00:14:30,570
preparing<font color="#CCCCCC"> for a new lucky to be deployed</font>

299
00:14:25,640 --> 00:14:32,819
so moving<font color="#E5E5E5"> on April 2017</font><font color="#CCCCCC"> after a three</font>

300
00:14:30,570 --> 00:14:36,450
<font color="#CCCCCC">month</font><font color="#E5E5E5"> long break lucky came back using</font>

301
00:14:32,820 --> 00:14:38,940
<font color="#CCCCCC">the</font><font color="#E5E5E5"> same Osiris extension then again</font>

302
00:14:36,450 --> 00:14:42,810
later that month<font color="#E5E5E5"> it changed to</font><font color="#CCCCCC"> lob</font><font color="#E5E5E5"> the</font>

303
00:14:38,940 --> 00:14:45,150
earth that<font color="#CCCCCC"> eloped ear</font><font color="#E5E5E5"> so for us it</font>

304
00:14:42,810 --> 00:14:47,430
<font color="#CCCCCC">wasn't a complete comeback yet for lucky</font>

305
00:14:45,150 --> 00:14:51,360
comparing<font color="#E5E5E5"> to the havoc</font><font color="#CCCCCC"> that it</font><font color="#E5E5E5"> made</font>

306
00:14:47,430 --> 00:14:54,390
during<font color="#E5E5E5"> 2016 so against for the following</font>

307
00:14:51,360 --> 00:14:56,280
months May<font color="#E5E5E5"> June and July</font><font color="#CCCCCC"> there were no</font>

308
00:14:54,390 --> 00:15:01,530
changes<font color="#E5E5E5"> again so we will skip</font><font color="#CCCCCC"> this month</font>

309
00:14:56,280 --> 00:15:04,949
<font color="#E5E5E5">so moving on to August this is where we</font>

310
00:15:01,530 --> 00:15:06,870
<font color="#E5E5E5">can say that lucky release map so it had</font>

311
00:15:04,950 --> 00:15:09,740
<font color="#CCCCCC">to new extension change</font><font color="#E5E5E5"> within a week</font>

312
00:15:06,870 --> 00:15:12,930
which<font color="#CCCCCC"> is job below</font><font color="#E5E5E5"> six and</font><font color="#CCCCCC"> Lukie toes</font>

313
00:15:09,740 --> 00:15:17,420
then reports were<font color="#CCCCCC"> coming in from</font>

314
00:15:12,930 --> 00:15:20,969
<font color="#E5E5E5">different different security vendors</font>

315
00:15:17,420 --> 00:15:22,949
<font color="#E5E5E5">saying that they have</font><font color="#CCCCCC"> reached like</font>

316
00:15:20,970 --> 00:15:25,230
<font color="#CCCCCC">twenty</font><font color="#E5E5E5"> three</font><font color="#CCCCCC"> million in volume and some</font>

317
00:15:22,950 --> 00:15:28,140
events<font color="#E5E5E5"> say</font><font color="#CCCCCC"> that they have observed</font><font color="#E5E5E5"> sixty</font>

318
00:15:25,230 --> 00:15:31,920
million<font color="#E5E5E5"> of spam emails so that only</font>

319
00:15:28,140 --> 00:15:34,140
means that lucky pushes in a massive

320
00:15:31,920 --> 00:15:38,399
massive spam campaigns

321
00:15:34,140 --> 00:15:39,029
so<font color="#E5E5E5"> also</font><font color="#CCCCCC"> Lucky's loader</font><font color="#E5E5E5"> so before Lucky's</font>

322
00:15:38,399 --> 00:15:42,180
loaded

323
00:15:39,029 --> 00:15:45,600
it also has an update<font color="#E5E5E5"> it has a new anti</font>

324
00:15:42,180 --> 00:15:47,519
VM<font color="#E5E5E5"> and anti sandbox trick since it will</font>

325
00:15:45,600 --> 00:15:49,890
only start the<font color="#E5E5E5"> PowerShell to download</font>

326
00:15:47,519 --> 00:15:52,079
lucky when the document is closed<font color="#E5E5E5"> so for</font>

327
00:15:49,890 --> 00:15:54,660
<font color="#E5E5E5">example you open the document in</font><font color="#CCCCCC"> sandbox</font>

328
00:15:52,079 --> 00:15:56,969
then it won't<font color="#E5E5E5"> do anything</font><font color="#CCCCCC"> but once you</font>

329
00:15:54,660 --> 00:15:59,579
close<font color="#CCCCCC"> the document that's where the</font>

330
00:15:56,970 --> 00:16:01,860
<font color="#CCCCCC">powershell will download the lucky</font><font color="#E5E5E5"> so</font>

331
00:15:59,579 --> 00:16:03,420
yeah it's quite tricky so if you didn't

332
00:16:01,860 --> 00:16:06,890
know<font color="#CCCCCC"> that you need to</font><font color="#E5E5E5"> close then nothing</font>

333
00:16:03,420 --> 00:16:12,060
will<font color="#E5E5E5"> happen</font><font color="#CCCCCC"> even if you enable macros</font>

334
00:16:06,890 --> 00:16:14,850
okay so next September<font color="#E5E5E5"> so this pumpkin</font>

335
00:16:12,060 --> 00:16:18,119
spam campaign continues with new variant

336
00:16:14,850 --> 00:16:22,910
which is<font color="#CCCCCC"> wike a call or just inverted</font>

337
00:16:18,120 --> 00:16:26,070
lucky and then<font color="#CCCCCC"> October came last month</font>

338
00:16:22,910 --> 00:16:29,250
again a new<font color="#CCCCCC"> extension which is that</font>

339
00:16:26,070 --> 00:16:32,490
assassin so interesting also<font color="#E5E5E5"> is the</font>

340
00:16:29,250 --> 00:16:35,399
loader<font color="#E5E5E5"> which which now serves to malware</font>

341
00:16:32,490 --> 00:16:38,220
<font color="#E5E5E5">so the loader the loader gets first the</font>

342
00:16:35,399 --> 00:16:41,970
geoip of the machine<font color="#E5E5E5"> and if it includes</font>

343
00:16:38,220 --> 00:16:45,600
if it cludes the following countries<font color="#E5E5E5"> UK</font>

344
00:16:41,970 --> 00:16:48,329
<font color="#E5E5E5">australia</font><font color="#CCCCCC"> luxembourg</font><font color="#E5E5E5"> belgium or ireland</font>

345
00:16:45,600 --> 00:16:50,519
it will serve the trick<font color="#CCCCCC"> bot malware</font>

346
00:16:48,329 --> 00:16:52,859
however if it's not from<font color="#E5E5E5"> those countries</font>

347
00:16:50,519 --> 00:16:57,269
then it will still serve<font color="#E5E5E5"> the</font><font color="#CCCCCC"> lucky</font>

348
00:16:52,860 --> 00:17:00,180
<font color="#CCCCCC">ransomware</font><font color="#E5E5E5"> also some malicious word the</font>

349
00:16:57,269 --> 00:17:04,020
attachments is the DD exploit to

350
00:17:00,180 --> 00:17:06,599
download and execute<font color="#E5E5E5"> lucky so with the</font>

351
00:17:04,020 --> 00:17:08,069
<font color="#E5E5E5">momentum that luckiest now we continue</font>

352
00:17:06,599 --> 00:17:10,319
<font color="#CCCCCC">to</font><font color="#E5E5E5"> believe that there will be more</font>

353
00:17:08,069 --> 00:17:16,699
updates on<font color="#E5E5E5"> the loader</font><font color="#CCCCCC"> and lock</font><font color="#E5E5E5"> itself</font>

354
00:17:10,319 --> 00:17:19,020
for the upcoming months so after the

355
00:17:16,699 --> 00:17:20,549
after<font color="#CCCCCC"> seeing the history of lucky</font><font color="#E5E5E5"> will</font>

356
00:17:19,020 --> 00:17:26,939
now take<font color="#E5E5E5"> a look on the technical</font>

357
00:17:20,549 --> 00:17:29,190
<font color="#E5E5E5">analysis of lucky so as I was mentioning</font>

358
00:17:26,939 --> 00:17:31,590
a lot about the configuration<font color="#E5E5E5"> so this is</font>

359
00:17:29,190 --> 00:17:33,270
a sample of its<font color="#CCCCCC"> configuration so we will</font>

360
00:17:31,590 --> 00:17:36,689
<font color="#E5E5E5">try to understand what this</font>

361
00:17:33,270 --> 00:17:39,389
configuration<font color="#CCCCCC"> do and why</font><font color="#E5E5E5"> and why is it</font>

362
00:17:36,690 --> 00:17:41,040
<font color="#E5E5E5">important to lucky so the first thing</font>

363
00:17:39,390 --> 00:17:43,169
that lucky does is to decrypt<font color="#CCCCCC"> this</font>

364
00:17:41,040 --> 00:17:45,600
configuration<font color="#E5E5E5"> which</font><font color="#CCCCCC"> is embedded</font><font color="#E5E5E5"> in its</font>

365
00:17:43,169 --> 00:17:47,940
binary so this configuration is

366
00:17:45,600 --> 00:17:50,549
important<font color="#E5E5E5"> since this will affect some of</font>

367
00:17:47,940 --> 00:17:52,110
the behavior decisions of<font color="#CCCCCC"> lucky</font><font color="#E5E5E5"> so we</font>

368
00:17:50,549 --> 00:17:54,750
will<font color="#CCCCCC"> take a look</font><font color="#E5E5E5"> at each flag in the</font>

369
00:17:52,110 --> 00:17:57,870
configure info in the configuration<font color="#E5E5E5"> and</font>

370
00:17:54,750 --> 00:18:00,629
how it<font color="#E5E5E5"> affects Lucky's behavior so first</font>

371
00:17:57,870 --> 00:18:01,049
is the affiliate ID<font color="#CCCCCC"> as</font><font color="#E5E5E5"> mentioned in</font><font color="#CCCCCC"> the</font>

372
00:18:00,629 --> 00:18:03,779
beginning

373
00:18:01,049 --> 00:18:04,529
<font color="#E5E5E5">this indicates the individual who spread</font>

374
00:18:03,779 --> 00:18:09,720
the ransomware

375
00:18:04,529 --> 00:18:12,480
<font color="#E5E5E5">so it's</font><font color="#CCCCCC"> five next is the sex</font><font color="#E5E5E5"> next four</font>

376
00:18:09,720 --> 00:18:14,639
bytes is the<font color="#CCCCCC"> DJI seed this</font><font color="#E5E5E5"> is used to</font>

377
00:18:12,480 --> 00:18:16,620
<font color="#E5E5E5">determine the future domains to be used</font>

378
00:18:14,639 --> 00:18:21,449
as the<font color="#CCCCCC"> fallback for lucky</font><font color="#E5E5E5"> to connect to</font>

379
00:18:16,620 --> 00:18:23,508
<font color="#E5E5E5">its</font><font color="#CCCCCC"> CNC next is slip this</font><font color="#E5E5E5"> flag dictates</font>

380
00:18:21,450 --> 00:18:28,019
the duration of slip in seconds before

381
00:18:23,509 --> 00:18:29,970
<font color="#E5E5E5">before executing it's a</font><font color="#CCCCCC"> main behavior so</font>

382
00:18:28,019 --> 00:18:31,830
the longer<font color="#CCCCCC"> the slip by lucky could</font>

383
00:18:29,970 --> 00:18:34,289
affect some<font color="#E5E5E5"> automated analysis to</font>

384
00:18:31,830 --> 00:18:42,149
<font color="#E5E5E5">timeout and resulting for lucky to be</font>

385
00:18:34,289 --> 00:18:45,330
undetected so next is only a bite<font color="#E5E5E5"> so it</font>

386
00:18:42,149 --> 00:18:48,629
<font color="#E5E5E5">is to drop as videos drop us as</font><font color="#CCCCCC"> videos</font>

387
00:18:45,330 --> 00:18:51,389
that<font color="#E5E5E5"> accesso if it's</font><font color="#CCCCCC"> zero one it will</font>

388
00:18:48,629 --> 00:18:53,668
drop<font color="#E5E5E5"> us as we run drop and run us as</font>

389
00:18:51,389 --> 00:18:55,279
videos and it's and if it's<font color="#CCCCCC"> zero it</font><font color="#E5E5E5"> will</font>

390
00:18:53,669 --> 00:18:58,590
just run<font color="#E5E5E5"> as normal</font>

391
00:18:55,279 --> 00:19:02,100
next is auto run this is for persistence

392
00:18:58,590 --> 00:19:06,539
<font color="#E5E5E5">like adding the</font><font color="#CCCCCC"> startup registry</font><font color="#E5E5E5"> so to</font>

393
00:19:02,100 --> 00:19:09,629
run<font color="#CCCCCC"> lock yet every startup next is check</font>

394
00:19:06,539 --> 00:19:12,450
<font color="#CCCCCC">Russian config so lucky checks the user</font>

395
00:19:09,629 --> 00:19:15,029
and system<font color="#E5E5E5"> default</font><font color="#CCCCCC"> plan default language</font>

396
00:19:12,450 --> 00:19:17,429
of the computer<font color="#E5E5E5"> so if it is found as</font>

397
00:19:15,029 --> 00:19:20,639
Russian<font color="#CCCCCC"> then lucky will close and</font><font color="#E5E5E5"> delete</font>

398
00:19:17,429 --> 00:19:22,409
itself meaning meaning<font color="#E5E5E5"> it won't</font><font color="#CCCCCC"> infect</font>

399
00:19:20,639 --> 00:19:25,320
<font color="#E5E5E5">computer with Russian as their default</font>

400
00:19:22,409 --> 00:19:27,720
language<font color="#E5E5E5"> language so if you set your</font>

401
00:19:25,320 --> 00:19:32,100
language<font color="#E5E5E5"> as Russia then he won't be</font>

402
00:19:27,720 --> 00:19:39,149
infected by<font color="#E5E5E5"> lucky yeah it's tested</font><font color="#CCCCCC"> next</font>

403
00:19:32,100 --> 00:19:41,939
is the<font color="#E5E5E5"> CNC offset so our necks in the</font>

404
00:19:39,149 --> 00:19:45,689
configuration<font color="#CCCCCC"> is the</font><font color="#E5E5E5"> URI as you can see</font>

405
00:19:41,940 --> 00:19:47,700
it's user info dot PHP so<font color="#CCCCCC"> this this one</font>

406
00:19:45,690 --> 00:19:50,460
is<font color="#E5E5E5"> one</font><font color="#CCCCCC"> of the constantly</font><font color="#E5E5E5"> changing</font><font color="#CCCCCC"> in</font>

407
00:19:47,700 --> 00:19:53,159
<font color="#E5E5E5">Lucky's development</font><font color="#CCCCCC"> so this URI will be</font>

408
00:19:50,460 --> 00:19:55,970
appended<font color="#CCCCCC"> the hard-coded I piece as</font><font color="#E5E5E5"> you</font>

409
00:19:53,159 --> 00:20:00,090
<font color="#CCCCCC">seen as you can see below so so far</font>

410
00:19:55,970 --> 00:20:01,710
<font color="#E5E5E5">lucky has 13 total URI changes since its</font>

411
00:20:00,090 --> 00:20:05,158
first<font color="#CCCCCC"> appearance in</font>

412
00:20:01,710 --> 00:20:10,070
and<font color="#E5E5E5"> last in the configuration is</font><font color="#CCCCCC"> the</font>

413
00:20:05,159 --> 00:20:10,070
CNCs<font color="#CCCCCC"> so we have three sets of IP there</font>

414
00:20:10,190 --> 00:20:16,740
so here again is<font color="#E5E5E5"> a quick look on the</font>

415
00:20:13,260 --> 00:20:18,870
<font color="#CCCCCC">online configure configuration</font><font color="#E5E5E5"> and if</font>

416
00:20:16,740 --> 00:20:21,720
you remember<font color="#CCCCCC"> that</font><font color="#E5E5E5"> one</font><font color="#CCCCCC"> of the development</font>

417
00:20:18,870 --> 00:20:24,539
of lucky<font color="#E5E5E5"> is it has its own offline</font>

418
00:20:21,720 --> 00:20:27,240
offline<font color="#E5E5E5"> encryption mode to encrypt files</font>

419
00:20:24,539 --> 00:20:30,419
so<font color="#E5E5E5"> we will compare</font><font color="#CCCCCC"> the difference of the</font>

420
00:20:27,240 --> 00:20:35,190
two modes<font color="#E5E5E5"> so we have here the offline</font>

421
00:20:30,419 --> 00:20:37,530
<font color="#E5E5E5">mode and we have here</font><font color="#CCCCCC"> the online mode so</font>

422
00:20:35,190 --> 00:20:40,440
comparing comparing to the online<font color="#E5E5E5"> mode</font>

423
00:20:37,530 --> 00:20:43,470
<font color="#E5E5E5">we will see some major differences so</font>

424
00:20:40,440 --> 00:20:46,860
first there is<font color="#E5E5E5"> no</font><font color="#CCCCCC"> djz</font><font color="#E5E5E5"> since yeah it</font>

425
00:20:43,470 --> 00:20:51,020
doesn't<font color="#CCCCCC"> need to connect to its</font><font color="#E5E5E5"> CNC next</font>

426
00:20:46,860 --> 00:20:54,090
there's no CNC offset<font color="#E5E5E5"> and no CNC</font><font color="#CCCCCC"> and URI</font>

427
00:20:51,020 --> 00:20:56,309
<font color="#E5E5E5">so basically all the configuration</font>

428
00:20:54,090 --> 00:20:58,439
needed<font color="#E5E5E5"> to connect to its CNC has been</font>

429
00:20:56,309 --> 00:21:02,970
removed<font color="#CCCCCC"> in the fully functional offline</font>

430
00:20:58,440 --> 00:21:05,159
lucky so you may ask like how<font color="#CCCCCC"> will how</font>

431
00:21:02,970 --> 00:21:07,260
<font color="#E5E5E5">will lucky</font><font color="#CCCCCC"> and creep itself</font><font color="#E5E5E5"> if it</font>

432
00:21:05,159 --> 00:21:12,570
doesn't connect<font color="#E5E5E5"> to its CNC and</font><font color="#CCCCCC"> get our</font>

433
00:21:07,260 --> 00:21:14,549
RSA key so what lucky did is<font color="#E5E5E5"> for for the</font>

434
00:21:12,570 --> 00:21:18,928
offline mode<font color="#E5E5E5"> to success successfully</font>

435
00:21:14,549 --> 00:21:20,460
encrypt the data<font color="#E5E5E5"> lucky stored if you see</font>

436
00:21:18,929 --> 00:21:23,669
the address<font color="#E5E5E5"> it's one nine eight</font><font color="#CCCCCC"> zero</font>

437
00:21:20,460 --> 00:21:27,840
<font color="#CCCCCC">zero</font><font color="#E5E5E5"> so just below it the configuration</font>

438
00:21:23,669 --> 00:21:30,030
it added the embedded public RSA key<font color="#E5E5E5"> so</font>

439
00:21:27,840 --> 00:21:32,668
one loophole<font color="#E5E5E5"> of the offline mode is that</font>

440
00:21:30,030 --> 00:21:34,980
in theory one private<font color="#CCCCCC"> key or the</font>

441
00:21:32,669 --> 00:21:37,289
decryption key<font color="#CCCCCC"> could decrypt all offline</font>

442
00:21:34,980 --> 00:21:40,470
mode lucky with the same embedded public

443
00:21:37,289 --> 00:21:44,460
RSA key so it doesn't only include the

444
00:21:40,470 --> 00:21:49,590
RSA key it also includes the embedded

445
00:21:44,460 --> 00:21:53,340
ransomware<font color="#CCCCCC"> tags and embedded HTML ransom</font>

446
00:21:49,590 --> 00:21:55,500
<font color="#E5E5E5">yeah ransom HTML yeah and that's however</font>

447
00:21:53,340 --> 00:22:00,959
for the offline mode this<font color="#E5E5E5"> only supports</font>

448
00:21:55,500 --> 00:22:03,539
<font color="#CCCCCC">the English language so so after</font>

449
00:22:00,960 --> 00:22:07,049
<font color="#E5E5E5">decrypting the configuration lucky</font>

450
00:22:03,539 --> 00:22:08,908
<font color="#E5E5E5">precedes now to create the victim ID so</font>

451
00:22:07,049 --> 00:22:11,250
to be able<font color="#CCCCCC"> for lucky to identify the</font>

452
00:22:08,909 --> 00:22:15,110
victims it has to<font color="#E5E5E5"> create a unique ID</font><font color="#CCCCCC"> for</font>

453
00:22:11,250 --> 00:22:17,000
each victim<font color="#E5E5E5"> so this is for online</font>

454
00:22:15,110 --> 00:22:19,908
so since offline<font color="#CCCCCC"> mood has a different</font>

455
00:22:17,000 --> 00:22:22,000
<font color="#E5E5E5">victim ID so for online it will take the</font>

456
00:22:19,909 --> 00:22:25,460
volume<font color="#CCCCCC"> goe ID of the windows directory</font>

457
00:22:22,000 --> 00:22:28,580
<font color="#E5E5E5">so this geo ID will</font><font color="#CCCCCC"> be half</font><font color="#E5E5E5"> using md5</font>

458
00:22:25,460 --> 00:22:30,890
<font color="#E5E5E5">and then the first 16 characters of the</font>

459
00:22:28,580 --> 00:22:37,010
md5 will be the victim ID<font color="#CCCCCC"> so an example</font>

460
00:22:30,890 --> 00:22:38,870
is<font color="#CCCCCC"> seen below and for</font><font color="#E5E5E5"> offline mode</font><font color="#CCCCCC"> so</font>

461
00:22:37,010 --> 00:22:40,940
for lucky to tell apart between<font color="#E5E5E5"> the</font>

462
00:22:38,870 --> 00:22:44,840
different offline victims<font color="#E5E5E5"> it creates</font>

463
00:22:40,940 --> 00:22:48,610
this special victim<font color="#E5E5E5"> ID so first the Geo</font>

464
00:22:44,840 --> 00:22:52,580
ID<font color="#CCCCCC"> we have the</font><font color="#E5E5E5"> default language the OS</font>

465
00:22:48,610 --> 00:22:54,500
domain controller<font color="#E5E5E5"> the affiliate ID from</font>

466
00:22:52,580 --> 00:22:58,580
<font color="#CCCCCC">the configuration</font><font color="#E5E5E5"> and the public key ID</font>

467
00:22:54,500 --> 00:23:01,639
<font color="#CCCCCC">since</font><font color="#E5E5E5"> it has the RSA key there and after</font>

468
00:22:58,580 --> 00:23:05,199
it will be encoded using a<font color="#CCCCCC"> hard-coded 32</font>

469
00:23:01,639 --> 00:23:08,029
character value and an example<font color="#E5E5E5"> of the</font>

470
00:23:05,200 --> 00:23:12,409
sample of the offline victim ID is a

471
00:23:08,029 --> 00:23:14,600
<font color="#E5E5E5">scene below so if you notice</font><font color="#CCCCCC"> the</font>

472
00:23:12,409 --> 00:23:16,610
affiliate ID and public key has a part

473
00:23:14,600 --> 00:23:19,279
in<font color="#CCCCCC"> creating the victim ID in the</font><font color="#E5E5E5"> offline</font>

474
00:23:16,610 --> 00:23:22,309
mode since this will<font color="#E5E5E5"> assist the malware</font>

475
00:23:19,279 --> 00:23:27,139
<font color="#E5E5E5">authors</font><font color="#CCCCCC"> to determine the affiliate since</font>

476
00:23:22,309 --> 00:23:28,639
there is no<font color="#CCCCCC"> CNC connection so next after</font>

477
00:23:27,139 --> 00:23:31,340
decrypting the configuration and

478
00:23:28,639 --> 00:23:33,799
creating a<font color="#E5E5E5"> unique ID lucky now proceeds</font>

479
00:23:31,340 --> 00:23:37,090
to connect to<font color="#E5E5E5"> its</font><font color="#CCCCCC"> CNC this 4 so this is</font>

480
00:23:33,799 --> 00:23:40,279
<font color="#E5E5E5">for the</font><font color="#CCCCCC"> online for the online</font><font color="#E5E5E5"> lucky only</font>

481
00:23:37,090 --> 00:23:43,399
so here is a quick overview<font color="#E5E5E5"> on the CNCs</font>

482
00:23:40,279 --> 00:23:46,010
behavior<font color="#CCCCCC"> it first tries to connect to</font>

483
00:23:43,399 --> 00:23:48,559
its<font color="#CCCCCC"> hard-coded eyepiece</font><font color="#E5E5E5"> and then if yes</font>

484
00:23:46,010 --> 00:23:52,429
it's just start<font color="#E5E5E5"> starts posting requests</font>

485
00:23:48,559 --> 00:23:56,080
then if no it uses the<font color="#E5E5E5"> the</font><font color="#CCCCCC"> DJ is</font><font color="#E5E5E5"> hid in</font>

486
00:23:52,429 --> 00:24:00,200
the configuration<font color="#CCCCCC"> to create some domains</font>

487
00:23:56,080 --> 00:24:02,928
and here is here's an actual data the

488
00:24:00,200 --> 00:24:06,590
data<font color="#CCCCCC"> before being encrypted</font><font color="#E5E5E5"> which will</font>

489
00:24:02,929 --> 00:24:09,500
be sent<font color="#E5E5E5"> to the</font><font color="#CCCCCC"> CNC so we have here the</font>

490
00:24:06,590 --> 00:24:12,620
key<font color="#E5E5E5"> and it</font><font color="#CCCCCC"> uses the ampersand as it's</font>

491
00:24:09,500 --> 00:24:16,000
the limiter so first is<font color="#E5E5E5"> the victim ID as</font>

492
00:24:12,620 --> 00:24:19,639
we discussed a while ago next is AK<font color="#E5E5E5"> or</font>

493
00:24:16,000 --> 00:24:23,539
<font color="#CCCCCC">action so</font><font color="#E5E5E5"> these actions are get</font><font color="#CCCCCC"> key get</font>

494
00:24:19,639 --> 00:24:26,719
tax get<font color="#E5E5E5"> HTML and stats so get keys to</font>

495
00:24:23,539 --> 00:24:28,760
get the RSA public key from<font color="#CCCCCC"> the CNC get</font>

496
00:24:26,720 --> 00:24:31,400
<font color="#CCCCCC">taxes to get</font><font color="#E5E5E5"> the ransomware tax</font>

497
00:24:28,760 --> 00:24:34,610
get<font color="#CCCCCC"> HTML Stu get the HTML ransomware</font>

498
00:24:31,400 --> 00:24:36,590
attacks<font color="#E5E5E5"> and stats is the how many files</font>

499
00:24:34,610 --> 00:24:39,199
<font color="#E5E5E5">are encrypted how many are filled and</font>

500
00:24:36,590 --> 00:24:45,850
yeah that's it<font color="#CCCCCC"> and then next</font><font color="#E5E5E5"> is the</font>

501
00:24:39,200 --> 00:24:48,740
affiliate ID<font color="#CCCCCC"> then we have the</font><font color="#E5E5E5"> language</font>

502
00:24:45,850 --> 00:24:50,750
since<font color="#E5E5E5"> lock is multilingual it retrieves</font>

503
00:24:48,740 --> 00:24:52,100
the default language of the victim<font color="#CCCCCC"> so</font>

504
00:24:50,750 --> 00:24:54,530
this will be used<font color="#CCCCCC"> to</font><font color="#E5E5E5"> determine the</font>

505
00:24:52,100 --> 00:24:56,929
language of the ransomware<font color="#CCCCCC"> note when</font>

506
00:24:54,530 --> 00:24:58,550
requested to the<font color="#CCCCCC"> C&C so if it's not</font>

507
00:24:56,930 --> 00:25:00,670
<font color="#CCCCCC">English</font><font color="#E5E5E5"> or it's a different language</font>

508
00:24:58,550 --> 00:25:03,139
then that's the<font color="#CCCCCC"> führer's corresponding</font>

509
00:25:00,670 --> 00:25:04,180
<font color="#CCCCCC">run somewhere note that will receive</font><font color="#E5E5E5"> by</font>

510
00:25:03,140 --> 00:25:07,250
the victim

511
00:25:04,180 --> 00:25:09,950
next is<font color="#CCCCCC"> Corp or this could sign for</font>

512
00:25:07,250 --> 00:25:12,740
<font color="#E5E5E5">corporation and it does if</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> infected</font>

513
00:25:09,950 --> 00:25:15,680
user is a<font color="#CCCCCC"> member of</font><font color="#E5E5E5"> a domain which could</font>

514
00:25:12,740 --> 00:25:18,950
mean it infected<font color="#E5E5E5"> a corporate computer so</font>

515
00:25:15,680 --> 00:25:22,940
we have this value 0 1<font color="#CCCCCC"> & 2</font><font color="#E5E5E5"> then server</font>

516
00:25:18,950 --> 00:25:25,100
if it's a server<font color="#CCCCCC"> or not so as you can</font>

517
00:25:22,940 --> 00:25:27,530
see lucky retrieves this information

518
00:25:25,100 --> 00:25:30,620
like the server and Corp<font color="#E5E5E5"> so it can have</font>

519
00:25:27,530 --> 00:25:32,750
an idea<font color="#E5E5E5"> of the</font><font color="#CCCCCC"> value</font><font color="#E5E5E5"> of the data that</font>

520
00:25:30,620 --> 00:25:34,729
<font color="#E5E5E5">was encrypted</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> the infected computer</font>

521
00:25:32,750 --> 00:25:37,100
so this<font color="#E5E5E5"> now could determine the number</font>

522
00:25:34,730 --> 00:25:39,800
<font color="#E5E5E5">of bitcoins</font><font color="#CCCCCC"> lucky will extort from</font><font color="#E5E5E5"> the</font>

523
00:25:37,100 --> 00:25:42,530
victim<font color="#E5E5E5"> so if you see</font><font color="#CCCCCC"> on reports like</font>

524
00:25:39,800 --> 00:25:44,899
<font color="#CCCCCC">Hospital Speedy's and</font><font color="#E5E5E5"> schools</font><font color="#CCCCCC"> paid this</font>

525
00:25:42,530 --> 00:25:47,270
since he<font color="#E5E5E5"> Allah he gets a lot</font><font color="#CCCCCC"> of</font>

526
00:25:44,900 --> 00:25:51,290
information<font color="#CCCCCC"> to determine how important</font>

527
00:25:47,270 --> 00:25:53,690
the computer that's been<font color="#E5E5E5"> infected so</font>

528
00:25:51,290 --> 00:25:57,080
next is the<font color="#CCCCCC"> operating</font><font color="#E5E5E5"> system the service</font>

529
00:25:53,690 --> 00:26:00,010
pack the architecture<font color="#E5E5E5"> and this is the</font>

530
00:25:57,080 --> 00:26:05,179
<font color="#CCCCCC">version so version</font><font color="#E5E5E5"> 2</font>

531
00:26:00,010 --> 00:26:08,720
next we'll proceed to<font color="#E5E5E5"> yeah so this</font><font color="#CCCCCC"> is</font>

532
00:26:05,180 --> 00:26:11,960
<font color="#E5E5E5">just how the victim and the C&C CNC</font>

533
00:26:08,720 --> 00:26:16,250
talks to each other<font color="#E5E5E5"> so the victim get</font>

534
00:26:11,960 --> 00:26:19,400
<font color="#E5E5E5">key</font><font color="#CCCCCC"> C&C</font><font color="#E5E5E5"> sends the RSA public key the</font>

535
00:26:16,250 --> 00:26:21,440
victim<font color="#E5E5E5"> post the get tax then it will</font>

536
00:26:19,400 --> 00:26:25,160
respond the<font color="#E5E5E5"> corresponding ransomware</font>

537
00:26:21,440 --> 00:26:25,990
<font color="#CCCCCC">text it will get</font><font color="#E5E5E5"> HTML and correspond</font>

538
00:26:25,160 --> 00:26:29,510
with the

539
00:26:25,990 --> 00:26:37,220
correct language<font color="#E5E5E5"> ransomware HTML and</font>

540
00:26:29,510 --> 00:26:41,090
stats<font color="#CCCCCC"> okay then next after after</font>

541
00:26:37,220 --> 00:26:42,620
<font color="#E5E5E5">connecting to the CNC and having the RSA</font>

542
00:26:41,090 --> 00:26:44,209
public key ready<font color="#E5E5E5"> so</font>

543
00:26:42,620 --> 00:26:48,379
it will now proceed to the<font color="#E5E5E5"> file</font>

544
00:26:44,210 --> 00:26:52,220
encryption<font color="#E5E5E5"> so this are</font><font color="#CCCCCC"> the target</font><font color="#E5E5E5"> that</font>

545
00:26:48,379 --> 00:26:54,769
drives by<font color="#E5E5E5"> loppy</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> removable fix remote</font>

546
00:26:52,220 --> 00:26:57,620
<font color="#CCCCCC">ram</font><font color="#E5E5E5"> this so it infects all possible</font>

547
00:26:54,769 --> 00:27:00,889
drives connected<font color="#CCCCCC"> to the user</font><font color="#E5E5E5"> and these</font>

548
00:26:57,620 --> 00:27:03,799
are some extension so we<font color="#CCCCCC"> found that that</font>

549
00:27:00,889 --> 00:27:06,979
around 460<font color="#E5E5E5"> extensions are being targeted</font>

550
00:27:03,799 --> 00:27:10,309
by<font color="#CCCCCC"> Loki</font><font color="#E5E5E5"> so now we have the file</font>

551
00:27:06,980 --> 00:27:14,029
encryption<font color="#E5E5E5"> so if you notice we have two</font>

552
00:27:10,309 --> 00:27:14,869
keys here the<font color="#CCCCCC"> RSA and AES so when we</font>

553
00:27:14,029 --> 00:27:17,690
think about it

554
00:27:14,869 --> 00:27:19,639
why did lock is<font color="#CCCCCC"> still use an aes for</font>

555
00:27:17,690 --> 00:27:22,610
file encryption when in fact it<font color="#CCCCCC"> already</font>

556
00:27:19,639 --> 00:27:25,699
has the RS RS<font color="#E5E5E5"> a key which can</font><font color="#CCCCCC"> be used</font>

557
00:27:22,610 --> 00:27:29,360
already<font color="#E5E5E5"> for encryption so one possible</font>

558
00:27:25,700 --> 00:27:31,279
<font color="#CCCCCC">reason is in terms</font><font color="#E5E5E5"> of performance</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> aes</font>

559
00:27:29,360 --> 00:27:33,789
would be more efficient than<font color="#E5E5E5"> our say</font>

560
00:27:31,279 --> 00:27:36,409
since<font color="#E5E5E5"> aes uses symmetric encryption</font>

561
00:27:33,789 --> 00:27:41,110
which is not which would be normally

562
00:27:36,409 --> 00:27:44,330
faster than our say so yeah so the

563
00:27:41,110 --> 00:27:46,369
aes-128 key is<font color="#E5E5E5"> randy randomly generated</font>

564
00:27:44,330 --> 00:27:48,529
for<font color="#CCCCCC"> each file</font><font color="#E5E5E5"> so this is not from the</font>

565
00:27:46,369 --> 00:27:51,830
<font color="#CCCCCC">C&C but this is low locally from</font><font color="#E5E5E5"> the</font>

566
00:27:48,529 --> 00:27:54,499
<font color="#E5E5E5">infected computer then the aes-128 key</font>

567
00:27:51,830 --> 00:27:57,168
is used to encrypt the file and<font color="#CCCCCC"> its</font>

568
00:27:54,499 --> 00:27:59,029
<font color="#CCCCCC">final</font><font color="#E5E5E5"> name so not only the file but</font><font color="#CCCCCC"> also</font>

569
00:27:57,169 --> 00:28:02,480
the<font color="#CCCCCC"> final</font><font color="#E5E5E5"> name of the file is being</font>

570
00:27:59,029 --> 00:28:05,029
<font color="#E5E5E5">encrypted then after encryption the</font>

571
00:28:02,480 --> 00:28:08,389
aes-128 key will now be<font color="#E5E5E5"> encrypted by the</font>

572
00:28:05,029 --> 00:28:11,029
RSA public key from<font color="#E5E5E5"> the</font><font color="#CCCCCC"> cnc</font><font color="#E5E5E5"> or if it's</font>

573
00:28:08,389 --> 00:28:16,178
<font color="#E5E5E5">offline then it's from the embedded RS</font>

574
00:28:11,029 --> 00:28:16,179
RS<font color="#CCCCCC"> e key from the</font><font color="#E5E5E5"> from the configuration</font>

575
00:28:16,509 --> 00:28:23,570
<font color="#E5E5E5">so this as</font><font color="#CCCCCC"> we said that the file name is</font>

576
00:28:20,990 --> 00:28:26,389
also encrypted so it has to<font color="#E5E5E5"> create its</font>

577
00:28:23,570 --> 00:28:30,110
<font color="#E5E5E5">own file name so this is the format</font><font color="#CCCCCC"> of</font>

578
00:28:26,389 --> 00:28:32,059
the encrypted<font color="#E5E5E5"> files by lucky</font><font color="#CCCCCC"> so again we</font>

579
00:28:30,110 --> 00:28:34,279
have the victim ID'd<font color="#CCCCCC"> the first 16</font>

580
00:28:32,059 --> 00:28:37,009
characters and the next 16 characters is

581
00:28:34,279 --> 00:28:39,259
the file ID<font color="#E5E5E5"> then it is appended by that</font>

582
00:28:37,009 --> 00:28:41,929
lucky<font color="#CCCCCC"> so this is the first very first</font>

583
00:28:39,259 --> 00:28:44,509
version then the latest<font color="#CCCCCC"> one is that</font>

584
00:28:41,929 --> 00:28:47,210
assassin<font color="#CCCCCC"> so the victim ID is still the</font>

585
00:28:44,509 --> 00:28:50,899
same 16 characters<font color="#CCCCCC"> while the file ID has</font>

586
00:28:47,210 --> 00:28:54,700
been added<font color="#CCCCCC"> four characters more so 20 in</font>

587
00:28:50,899 --> 00:28:58,658
<font color="#E5E5E5">total then appended</font><font color="#CCCCCC"> by that assassin</font>

588
00:28:54,700 --> 00:29:02,710
so after<font color="#CCCCCC"> this we will</font><font color="#E5E5E5"> take</font><font color="#CCCCCC"> a look</font><font color="#E5E5E5"> on the</font>

589
00:28:58,659 --> 00:29:04,960
file encryption layout<font color="#E5E5E5"> so the yellow</font>

590
00:29:02,710 --> 00:29:08,169
part is the original file<font color="#CCCCCC"> so once it's</font>

591
00:29:04,960 --> 00:29:11,710
encrypted<font color="#E5E5E5"> it should since it uses the</font>

592
00:29:08,169 --> 00:29:14,580
<font color="#E5E5E5">AES it should have same same file size</font>

593
00:29:11,710 --> 00:29:17,499
since<font color="#CCCCCC"> its symmetric so we can see there</font>

594
00:29:14,580 --> 00:29:20,559
but lock it up<font color="#CCCCCC"> and some important</font>

595
00:29:17,499 --> 00:29:23,739
<font color="#CCCCCC">information like four bytes hard code</font>

596
00:29:20,559 --> 00:29:24,759
<font color="#CCCCCC">it's which is hard-coded in it's it's</font>

597
00:29:23,739 --> 00:29:27,179
<font color="#E5E5E5">been it's binary</font>

598
00:29:24,759 --> 00:29:30,369
then it appends also the victim ID<font color="#CCCCCC"> and</font>

599
00:29:27,179 --> 00:29:32,529
it will append also the<font color="#E5E5E5"> encrypted AES</font>

600
00:29:30,369 --> 00:29:34,629
key<font color="#E5E5E5"> since the AES</font><font color="#CCCCCC"> key is randomly</font>

601
00:29:32,529 --> 00:29:36,279
<font color="#CCCCCC">generated for each</font><font color="#E5E5E5"> file so it's unique</font>

602
00:29:34,629 --> 00:29:38,939
<font color="#CCCCCC">for each file it has to store it</font>

603
00:29:36,279 --> 00:29:41,830
somewhere so it<font color="#E5E5E5"> stores it there and</font>

604
00:29:38,940 --> 00:29:44,409
lastly it appends the<font color="#CCCCCC"> encrypted file</font>

605
00:29:41,830 --> 00:29:47,139
name<font color="#E5E5E5"> so this would be the file layout</font>

606
00:29:44,409 --> 00:29:51,059
for every encrypted file so to prove

607
00:29:47,139 --> 00:29:53,529
<font color="#CCCCCC">this we have an actual layout of file so</font>

608
00:29:51,059 --> 00:29:55,749
yeah so the first<font color="#E5E5E5"> part is</font><font color="#CCCCCC"> the encrypted</font>

609
00:29:53,529 --> 00:29:58,869
data<font color="#E5E5E5"> which again was encrypted by the</font>

610
00:29:55,749 --> 00:30:02,379
AES<font color="#E5E5E5"> then we have here the 4 bytes</font><font color="#CCCCCC"> hard</font>

611
00:29:58,869 --> 00:30:05,320
<font color="#E5E5E5">coded value so this</font><font color="#CCCCCC"> hard-coded value is</font>

612
00:30:02,379 --> 00:30:07,988
important for lucky since this will<font color="#CCCCCC"> be</font>

613
00:30:05,320 --> 00:30:11,259
its reference so when it gets the file

614
00:30:07,989 --> 00:30:13,059
<font color="#E5E5E5">it knows where to find it so once it</font>

615
00:30:11,259 --> 00:30:15,759
<font color="#E5E5E5">finds this</font><font color="#CCCCCC"> hard-coded value it knows</font>

616
00:30:13,059 --> 00:30:19,509
that<font color="#E5E5E5"> after it is the victim ID and</font>

617
00:30:15,759 --> 00:30:22,210
before it<font color="#E5E5E5"> is the original file and we</font>

618
00:30:19,509 --> 00:30:24,909
<font color="#CCCCCC">have the victim ID here and then</font>

619
00:30:22,210 --> 00:30:28,600
encrypted AES key<font color="#E5E5E5"> which is encrypted</font>

620
00:30:24,909 --> 00:30:30,519
<font color="#E5E5E5">again by the RSA public key and lastly</font>

621
00:30:28,600 --> 00:30:38,009
is the encrypted file name which was

622
00:30:30,519 --> 00:30:40,899
encrypted<font color="#E5E5E5"> by the aes-128 key so next</font>

623
00:30:38,009 --> 00:30:43,779
yeah after encryption it will show the

624
00:30:40,899 --> 00:30:45,518
HTML ransomware<font color="#CCCCCC"> note</font><font color="#E5E5E5"> so this must be</font>

625
00:30:43,779 --> 00:30:48,580
familiar<font color="#E5E5E5"> with you guys</font>

626
00:30:45,519 --> 00:30:50,669
next is the the Crippler page so

627
00:30:48,580 --> 00:30:54,249
compared last year

628
00:30:50,669 --> 00:30:57,820
lucky was asking<font color="#CCCCCC"> for 0.5 Bitcoin</font><font color="#E5E5E5"> but now</font>

629
00:30:54,249 --> 00:30:59,950
it<font color="#CCCCCC"> only</font><font color="#E5E5E5"> asked for 0.1 Bitcoin since this</font>

630
00:30:57,820 --> 00:31:02,559
causes by the search of price<font color="#CCCCCC"> of Bitcoin</font>

631
00:30:59,950 --> 00:31:05,859
for<font color="#E5E5E5"> this year so it's crazy</font><font color="#CCCCCC"> so</font>

632
00:31:02,559 --> 00:31:07,658
interestingly if the cyber criminals

633
00:31:05,859 --> 00:31:08,649
behind lucky didn't pay out their

634
00:31:07,659 --> 00:31:12,790
profits

635
00:31:08,650 --> 00:31:15,550
then they would<font color="#CCCCCC"> have like</font><font color="#E5E5E5"> 500</font><font color="#CCCCCC"> like 1000%</font>

636
00:31:12,790 --> 00:31:18,639
increase in<font color="#E5E5E5"> profits like from $500 now</font>

637
00:31:15,550 --> 00:31:20,860
it's<font color="#CCCCCC"> 5,000 6,000 so they have increased</font>

638
00:31:18,640 --> 00:31:24,160
profits if they didn't cash out their

639
00:31:20,860 --> 00:31:27,040
<font color="#E5E5E5">Bitcoin and lastly the Decrypter page</font>

640
00:31:24,160 --> 00:31:29,440
<font color="#E5E5E5">this</font><font color="#CCCCCC"> is usually hosted in tor so it's</font>

641
00:31:27,040 --> 00:31:34,870
just not to<font color="#CCCCCC"> be so it just to be</font>

642
00:31:29,440 --> 00:31:36,700
anonymous<font color="#E5E5E5"> next</font><font color="#CCCCCC"> so at the beginning as</font>

643
00:31:34,870 --> 00:31:39,610
<font color="#CCCCCC">you</font><font color="#E5E5E5"> have seen in the configuration</font><font color="#CCCCCC"> that</font>

644
00:31:36,700 --> 00:31:42,190
there there<font color="#E5E5E5"> is there the C&C so we</font>

645
00:31:39,610 --> 00:31:43,959
wanted to automatically harvest the<font color="#E5E5E5"> C&C</font>

646
00:31:42,190 --> 00:31:47,500
so we can proactively block it and

647
00:31:43,960 --> 00:31:49,630
protect customers so upon analysis of

648
00:31:47,500 --> 00:31:52,120
lucky we<font color="#E5E5E5"> observed that lucky will</font>

649
00:31:49,630 --> 00:31:54,130
allocate a memory in its process<font color="#E5E5E5"> wherein</font>

650
00:31:52,120 --> 00:31:56,830
it stores the decrypted configuration

651
00:31:54,130 --> 00:31:59,620
<font color="#CCCCCC">since</font><font color="#E5E5E5"> since it's already in the memory</font>

652
00:31:56,830 --> 00:32:01,929
we<font color="#CCCCCC"> can take advantage of</font><font color="#E5E5E5"> this and get</font>

653
00:31:59,620 --> 00:32:04,000
directly the decrypted configuration so

654
00:32:01,930 --> 00:32:08,710
there<font color="#E5E5E5"> will be no need of a separate tool</font>

655
00:32:04,000 --> 00:32:10,390
to get this configuration<font color="#CCCCCC"> so I will</font><font color="#E5E5E5"> just</font>

656
00:32:08,710 --> 00:32:13,810
<font color="#E5E5E5">share the overview and how we did this</font>

657
00:32:10,390 --> 00:32:16,780
so we execute the sample in sandbox<font color="#E5E5E5"> then</font>

658
00:32:13,810 --> 00:32:18,879
after since we have the memory<font color="#E5E5E5"> we have</font>

659
00:32:16,780 --> 00:32:20,200
the process memory already<font color="#E5E5E5"> dumped in</font>

660
00:32:18,880 --> 00:32:22,510
using the sandbox

661
00:32:20,200 --> 00:32:24,910
<font color="#E5E5E5">we will use the error rule to validate</font>

662
00:32:22,510 --> 00:32:28,360
if it's lucky so this will<font color="#E5E5E5"> just work as</font>

663
00:32:24,910 --> 00:32:31,240
a filter so if it's<font color="#E5E5E5"> not then just end</font>

664
00:32:28,360 --> 00:32:33,820
<font color="#E5E5E5">then if it's yes we try to search the</font>

665
00:32:31,240 --> 00:32:37,270
lucky config in the memory dump<font color="#CCCCCC"> so it</font>

666
00:32:33,820 --> 00:32:40,810
has some we have some indicator if it's

667
00:32:37,270 --> 00:32:43,480
the lucky configuration already<font color="#CCCCCC"> then if</font>

668
00:32:40,810 --> 00:32:46,450
if it's not fun then it will notify<font color="#E5E5E5"> us</font>

669
00:32:43,480 --> 00:32:49,240
since we already determined<font color="#CCCCCC"> that it is</font>

670
00:32:46,450 --> 00:32:52,150
<font color="#E5E5E5">lucky so we can say that the</font>

671
00:32:49,240 --> 00:32:54,370
configuration must be<font color="#E5E5E5"> updated or maybe</font>

672
00:32:52,150 --> 00:32:57,850
this this is a new variant of lucky so

673
00:32:54,370 --> 00:33:00,070
we can check<font color="#E5E5E5"> it out and and if you found</font>

674
00:32:57,850 --> 00:33:05,169
the lucky config then we just started to

675
00:33:00,070 --> 00:33:07,629
our database so<font color="#CCCCCC"> proceeding next</font><font color="#E5E5E5"> the kill</font>

676
00:33:05,170 --> 00:33:09,760
<font color="#E5E5E5">chain of</font><font color="#CCCCCC"> locky</font><font color="#E5E5E5"> so we have been</font>

677
00:33:07,630 --> 00:33:14,050
monitoring lucky for more than a<font color="#E5E5E5"> year so</font>

678
00:33:09,760 --> 00:33:16,960
<font color="#CCCCCC">we will</font><font color="#E5E5E5"> just the spam campaign so here</font>

679
00:33:14,050 --> 00:33:21,010
is the typical spam campaign<font color="#E5E5E5"> setup so</font>

680
00:33:16,960 --> 00:33:22,160
first we<font color="#E5E5E5"> have</font><font color="#CCCCCC"> the spam email the next is</font>

681
00:33:21,010 --> 00:33:24,770
the<font color="#E5E5E5"> attachment</font>

682
00:33:22,160 --> 00:33:27,140
so this will serve as<font color="#CCCCCC"> the</font><font color="#E5E5E5"> load the</font>

683
00:33:24,770 --> 00:33:29,750
loader for<font color="#CCCCCC"> locky</font><font color="#E5E5E5"> so these are the files</font>

684
00:33:27,140 --> 00:33:32,780
that we observe<font color="#E5E5E5"> Microsoft Office</font>

685
00:33:29,750 --> 00:33:37,160
this is Word Excel or<font color="#E5E5E5"> PPT</font>

686
00:33:32,780 --> 00:33:41,260
we have<font color="#CCCCCC"> lnk</font><font color="#E5E5E5"> powershell HTML archive</font>

687
00:33:37,160 --> 00:33:45,110
script<font color="#CCCCCC"> i and PDF so yeah lucky is quite</font>

688
00:33:41,260 --> 00:33:48,020
<font color="#E5E5E5">this</font><font color="#CCCCCC"> is a lot of file types -</font><font color="#E5E5E5"> and the</font>

689
00:33:45,110 --> 00:33:50,179
next<font color="#CCCCCC"> is</font><font color="#E5E5E5"> the download</font><font color="#CCCCCC"> URLs so this is</font>

690
00:33:48,020 --> 00:33:52,280
where the payload is stored these are

691
00:33:50,180 --> 00:33:53,230
usually legitimate sites that have<font color="#E5E5E5"> been</font>

692
00:33:52,280 --> 00:33:56,899
compromised

693
00:33:53,230 --> 00:33:58,760
next is the payload<font color="#E5E5E5"> lobby so it is</font>

694
00:33:56,900 --> 00:34:01,280
pretty<font color="#E5E5E5"> straight forward so to have a</font>

695
00:33:58,760 --> 00:34:03,620
better<font color="#CCCCCC"> understanding of the whole spam</font>

696
00:34:01,280 --> 00:34:07,480
campaign<font color="#E5E5E5"> we will take a look on a visual</font>

697
00:34:03,620 --> 00:34:10,850
representation<font color="#E5E5E5"> so this would be from our</font>

698
00:34:07,480 --> 00:34:14,418
internal project<font color="#E5E5E5"> buck in Singapore for</font>

699
00:34:10,850 --> 00:34:22,460
<font color="#CCCCCC">the girl</font><font color="#E5E5E5"> Singapore and to correlate some</font>

700
00:34:14,418 --> 00:34:24,049
data<font color="#E5E5E5"> so</font><font color="#CCCCCC"> I just</font><font color="#E5E5E5"> play a demo here so as</font>

701
00:34:22,460 --> 00:34:27,470
you can<font color="#CCCCCC"> see first these</font><font color="#E5E5E5"> are a group of</font>

702
00:34:24,050 --> 00:34:30,350
spam emails<font color="#E5E5E5"> then we were</font><font color="#CCCCCC"> able to</font><font color="#E5E5E5"> link it</font>

703
00:34:27,469 --> 00:34:33,918
since what the system the project that

704
00:34:30,350 --> 00:34:36,799
<font color="#E5E5E5">we did the system</font><font color="#CCCCCC"> it extracts all the</font>

705
00:34:33,918 --> 00:34:39,529
email that comes in and then we found

706
00:34:36,800 --> 00:34:43,190
out<font color="#E5E5E5"> that all these spam emails shared</font>

707
00:34:39,530 --> 00:34:49,909
the same<font color="#CCCCCC"> share the same rare file or</font>

708
00:34:43,190 --> 00:34:52,210
attachment so yeah let's play so here we

709
00:34:49,909 --> 00:34:52,210
have the

710
00:34:59,490 --> 00:35:06,450
here<font color="#E5E5E5"> sets of email which when extracted</font>

711
00:35:04,500 --> 00:35:10,230
that that attachment<font color="#CCCCCC"> we have a similar</font>

712
00:35:06,450 --> 00:35:13,379
sample<font color="#E5E5E5"> and then from this rar rar file</font>

713
00:35:10,230 --> 00:35:16,650
we again extracted it and we found out

714
00:35:13,380 --> 00:35:20,160
<font color="#E5E5E5">that it has a malicious</font><font color="#CCCCCC"> Jaya script</font><font color="#E5E5E5"> and</font>

715
00:35:16,650 --> 00:35:22,470
this<font color="#CCCCCC"> flaw and from this jl script when</font>

716
00:35:20,160 --> 00:35:24,990
we execute<font color="#E5E5E5"> this jl script</font><font color="#CCCCCC"> we found out</font>

717
00:35:22,470 --> 00:35:27,868
that it connects to<font color="#CCCCCC"> this</font><font color="#E5E5E5"> malicious URL</font>

718
00:35:24,990 --> 00:35:30,330
so as you<font color="#E5E5E5"> consider a lot of</font><font color="#CCCCCC"> internet</font>

719
00:35:27,869 --> 00:35:33,660
globe there<font color="#E5E5E5"> it's all malicious URL and</font>

720
00:35:30,330 --> 00:35:36,990
it all<font color="#E5E5E5"> points to a specific payload</font>

721
00:35:33,660 --> 00:35:39,868
which is lucky<font color="#E5E5E5"> so this is only a part of</font>

722
00:35:36,990 --> 00:35:42,750
<font color="#E5E5E5">the spam campaign so to be</font><font color="#CCCCCC"> able to see</font>

723
00:35:39,869 --> 00:35:48,720
the whole<font color="#CCCCCC"> the whole part we will zoom</font>

724
00:35:42,750 --> 00:35:55,550
zoom this out we will<font color="#E5E5E5"> zoom using lucky</font>

725
00:35:48,720 --> 00:35:55,549
lucky payload in<font color="#E5E5E5"> in the in the media</font>

726
00:35:55,790 --> 00:36:00,690
<font color="#CCCCCC">yeah so this is what we found out</font><font color="#E5E5E5"> so</font>

727
00:35:58,440 --> 00:36:03,210
there are a<font color="#E5E5E5"> lot of in a spam email</font><font color="#CCCCCC"> in a</font>

728
00:36:00,690 --> 00:36:05,880
spam campaign there's a lot of emails

729
00:36:03,210 --> 00:36:08,790
<font color="#E5E5E5">but it doesn't mean</font><font color="#CCCCCC"> that every spam</font>

730
00:36:05,880 --> 00:36:11,760
email has<font color="#CCCCCC"> a unique sample what we did</font>

731
00:36:08,790 --> 00:36:14,130
here we can see<font color="#CCCCCC"> that every a group of</font>

732
00:36:11,760 --> 00:36:16,520
spam email have a similar attachment

733
00:36:14,130 --> 00:36:19,470
then this attachment connects to a

734
00:36:16,520 --> 00:36:22,980
malicious URL<font color="#E5E5E5"> so we have multiple URLs</font>

735
00:36:19,470 --> 00:36:24,899
but all<font color="#E5E5E5"> this multiple URLs connect only</font>

736
00:36:22,980 --> 00:36:32,220
to one sample<font color="#E5E5E5"> only download to one</font>

737
00:36:24,900 --> 00:36:34,140
sample so let's proceed to<font color="#E5E5E5"> the</font><font color="#CCCCCC"> next</font><font color="#E5E5E5"> so</font>

738
00:36:32,220 --> 00:36:36,419
here<font color="#E5E5E5"> just to better understand we</font>

739
00:36:34,140 --> 00:36:39,960
isolate once part of the<font color="#E5E5E5"> spawn campaign</font>

740
00:36:36,420 --> 00:36:44,160
so we<font color="#E5E5E5"> spam emails we have the script</font>

741
00:36:39,960 --> 00:36:47,280
downloader<font color="#E5E5E5"> then we have the URL so what</font>

742
00:36:44,160 --> 00:36:52,080
we tried once we have this<font color="#CCCCCC"> URL we</font>

743
00:36:47,280 --> 00:36:54,660
monitor this<font color="#CCCCCC"> URL and we</font><font color="#E5E5E5"> try to connect</font>

744
00:36:52,080 --> 00:36:59,310
<font color="#E5E5E5">to it a couple of times a</font><font color="#CCCCCC"> day</font><font color="#E5E5E5"> so what we</font>

745
00:36:54,660 --> 00:37:02,490
found out at first<font color="#E5E5E5"> it downloaded</font><font color="#CCCCCC"> that</font>

746
00:36:59,310 --> 00:37:05,700
<font color="#CCCCCC">job lo6 variant of locky and then after</font>

747
00:37:02,490 --> 00:37:08,399
after<font color="#E5E5E5"> a few days it</font><font color="#CCCCCC"> don't it downloaded</font>

748
00:37:05,700 --> 00:37:11,759
<font color="#E5E5E5">that lucky toes so what we can see is</font>

749
00:37:08,400 --> 00:37:13,170
that the spam botnet that is behind

750
00:37:11,760 --> 00:37:16,230
lucky

751
00:37:13,170 --> 00:37:18,299
<font color="#E5E5E5">it reduces this malicious</font><font color="#CCCCCC"> urls</font><font color="#E5E5E5"> and it</font>

752
00:37:16,230 --> 00:37:21,690
always updates it like<font color="#E5E5E5"> like for example</font>

753
00:37:18,299 --> 00:37:23,280
this today that<font color="#CCCCCC"> table but tomorrow it</font>

754
00:37:21,690 --> 00:37:25,680
will be<font color="#E5E5E5"> that lucky</font><font color="#CCCCCC"> to go and then</font>

755
00:37:23,280 --> 00:37:30,650
another day it could<font color="#CCCCCC"> be any other</font>

756
00:37:25,680 --> 00:37:34,290
malware<font color="#E5E5E5"> or another another family</font>

757
00:37:30,650 --> 00:37:36,780
so another overview to summarize our

758
00:37:34,290 --> 00:37:41,730
findings<font color="#CCCCCC"> here is what we found</font>

759
00:37:36,780 --> 00:37:44,250
so first wave of<font color="#E5E5E5"> a spam campaign</font><font color="#CCCCCC"> we we</font>

760
00:37:41,730 --> 00:37:49,109
notice it on Monday which is<font color="#CCCCCC"> September</font>

761
00:37:44,250 --> 00:37:52,410
17 2017 so 8:24 a.m.<font color="#E5E5E5"> this is UTC time</font>

762
00:37:49,109 --> 00:37:55,650
and all<font color="#CCCCCC"> this thousands</font><font color="#E5E5E5"> of thousands of</font>

763
00:37:52,410 --> 00:37:58,078
email<font color="#E5E5E5"> only</font><font color="#CCCCCC"> had one email subject which</font>

764
00:37:55,650 --> 00:38:01,230
is status of<font color="#E5E5E5"> invoice and then when</font>

765
00:37:58,079 --> 00:38:03,869
extracting<font color="#E5E5E5"> all</font><font color="#CCCCCC"> these all these emails</font><font color="#E5E5E5"> we</font>

766
00:38:01,230 --> 00:38:06,270
got the attachment of not exactly this

767
00:38:03,869 --> 00:38:08,700
but<font color="#E5E5E5"> this kind of format like a then</font>

768
00:38:06,270 --> 00:38:11,009
<font color="#E5E5E5">random numbers or but it had the same</font>

769
00:38:08,700 --> 00:38:18,270
format like<font color="#E5E5E5"> our characters</font><font color="#CCCCCC"> and numbers</font>

770
00:38:11,010 --> 00:38:20,520
with that 7-zip file type and then since

771
00:38:18,270 --> 00:38:22,349
we<font color="#CCCCCC"> have the attachment we got the GI</font>

772
00:38:20,520 --> 00:38:25,470
script then executed all this<font color="#CCCCCC"> Jaya</font>

773
00:38:22,349 --> 00:38:28,559
script<font color="#E5E5E5"> and we found out that it connects</font>

774
00:38:25,470 --> 00:38:32,308
to<font color="#E5E5E5"> multiple multiple compromised sites</font>

775
00:38:28,559 --> 00:38:37,680
but<font color="#E5E5E5"> it's appended</font><font color="#CCCCCC"> by this</font><font color="#E5E5E5"> URI 87</font><font color="#CCCCCC"> dj's</font>

776
00:38:32,309 --> 00:38:40,770
and once we got the payload<font color="#CCCCCC"> all of the</font>

777
00:38:37,680 --> 00:38:45,118
samples in<font color="#E5E5E5"> the first</font><font color="#CCCCCC"> first-wave had this</font>

778
00:38:40,770 --> 00:38:47,819
affiliate ID<font color="#CCCCCC"> 3 it</font><font color="#E5E5E5"> has your ing and</font><font color="#CCCCCC"> it's</font>

779
00:38:45,119 --> 00:38:50,849
online<font color="#CCCCCC"> and offline encryption the second</font>

780
00:38:47,819 --> 00:38:54,180
wave same day<font color="#E5E5E5"> Monday but now in the</font>

781
00:38:50,849 --> 00:38:56,480
afternoon<font color="#E5E5E5"> it had thousands and thousands</font>

782
00:38:54,180 --> 00:38:59,700
<font color="#CCCCCC">of emails</font><font color="#E5E5E5"> again had a same email subject</font>

783
00:38:56,480 --> 00:39:01,920
the attachment had a similar format

784
00:38:59,700 --> 00:39:06,348
again<font color="#E5E5E5"> like the date and random numbers</font>

785
00:39:01,920 --> 00:39:08,730
then the URI<font color="#E5E5E5"> change and now the sample</font>

786
00:39:06,349 --> 00:39:11,630
<font color="#E5E5E5">when we extract the configuration it's</font>

787
00:39:08,730 --> 00:39:15,780
now on only<font color="#E5E5E5"> supports offline encryption</font>

788
00:39:11,630 --> 00:39:18,089
so the takeaways<font color="#CCCCCC"> here are first in to</font>

789
00:39:15,780 --> 00:39:19,920
spam<font color="#E5E5E5"> webs were delivered per day one in</font>

790
00:39:18,089 --> 00:39:22,589
the morning<font color="#E5E5E5"> and one in the afternoon</font>

791
00:39:19,920 --> 00:39:23,700
so each file<font color="#E5E5E5"> has its own set of</font>

792
00:39:22,589 --> 00:39:26,730
compromised

793
00:39:23,700 --> 00:39:27,020
host and it's been<font color="#CCCCCC"> appended by</font><font color="#E5E5E5"> the only</font>

794
00:39:26,730 --> 00:39:29,800
say

795
00:39:27,020 --> 00:39:32,540
<font color="#E5E5E5">you are I so they do this since AV</font>

796
00:39:29,800 --> 00:39:34,640
vendors could already have<font color="#E5E5E5"> block in the</font>

797
00:39:32,540 --> 00:39:38,840
morning the previous URL so they<font color="#CCCCCC"> need</font><font color="#E5E5E5"> to</font>

798
00:39:34,640 --> 00:39:41,470
<font color="#E5E5E5">update</font><font color="#CCCCCC"> it so a wave can deliver samples</font>

799
00:39:38,840 --> 00:39:47,120
with<font color="#E5E5E5"> either online or offline encryption</font>

800
00:39:41,470 --> 00:39:50,060
then<font color="#E5E5E5"> yeah so as you have seen in this</font>

801
00:39:47,120 --> 00:39:52,279
graph and in the demo<font color="#CCCCCC"> there is a lot of</font>

802
00:39:50,060 --> 00:39:57,710
places where<font color="#CCCCCC"> we</font><font color="#E5E5E5"> can stop and detect the</font>

803
00:39:52,280 --> 00:40:00,500
<font color="#E5E5E5">lucky so back in our demo so if we just</font>

804
00:39:57,710 --> 00:40:04,700
<font color="#E5E5E5">block the payload for for this time then</font>

805
00:40:00,500 --> 00:40:06,380
it was able<font color="#E5E5E5"> already to block like all</font>

806
00:40:04,700 --> 00:40:09,560
the even<font color="#CCCCCC"> the even though there's a new</font>

807
00:40:06,380 --> 00:40:11,510
<font color="#CCCCCC">URL</font><font color="#E5E5E5"> and if it's points to the same</font>

808
00:40:09,560 --> 00:40:15,320
payload<font color="#E5E5E5"> then once the payload is blocked</font>

809
00:40:11,510 --> 00:40:19,040
then it should<font color="#CCCCCC"> be okay next next</font>

810
00:40:15,320 --> 00:40:21,560
<font color="#CCCCCC">takeaway is blocking the malicious URL</font>

811
00:40:19,040 --> 00:40:24,710
so as we can<font color="#CCCCCC"> see that the</font><font color="#E5E5E5"> URL was</font><font color="#CCCCCC"> reuse</font>

812
00:40:21,560 --> 00:40:27,130
<font color="#E5E5E5">so it could it could serve a different</font>

813
00:40:24,710 --> 00:40:29,870
malware for some other time so once it's

814
00:40:27,130 --> 00:40:31,940
once it's blocked<font color="#E5E5E5"> so it's for good</font>

815
00:40:29,870 --> 00:40:34,609
already<font color="#E5E5E5"> even though there's new samples</font>

816
00:40:31,940 --> 00:40:36,860
in<font color="#CCCCCC"> that you</font><font color="#E5E5E5"> are and lastly having</font><font color="#CCCCCC"> known</font>

817
00:40:34,610 --> 00:40:39,620
some common behaviors like in this table

818
00:40:36,860 --> 00:40:42,740
<font color="#E5E5E5">we can immediately identify if the email</font>

819
00:40:39,620 --> 00:40:46,880
is<font color="#CCCCCC"> from spam campaign and if the URL URL</font>

820
00:40:42,740 --> 00:40:50,359
is malicious through yeah and last is

821
00:40:46,880 --> 00:40:53,540
some<font color="#E5E5E5"> interesting observation so the</font>

822
00:40:50,360 --> 00:40:56,330
email subject<font color="#E5E5E5"> message from kmc22 for e</font>

823
00:40:53,540 --> 00:40:59,000
the spam email subject<font color="#E5E5E5"> was also used by</font>

824
00:40:56,330 --> 00:41:02,540
<font color="#CCCCCC">the</font><font color="#E5E5E5"> three decks and Jeff ransomware</font><font color="#CCCCCC"> in</font>

825
00:40:59,000 --> 00:41:04,790
their spam campaigns<font color="#E5E5E5"> next is the</font><font color="#CCCCCC"> QT bot</font>

826
00:41:02,540 --> 00:41:07,970
loader<font color="#E5E5E5"> which serves</font><font color="#CCCCCC"> trick button</font><font color="#E5E5E5"> lucky</font>

827
00:41:04,790 --> 00:41:09,800
as mentioned a while ago and then lucky

828
00:41:07,970 --> 00:41:11,870
<font color="#CCCCCC">ransomware</font><font color="#E5E5E5"> files shared the same</font>

829
00:41:09,800 --> 00:41:14,240
download<font color="#E5E5E5"> service with</font><font color="#CCCCCC"> siege</font><font color="#E5E5E5"> ransomware</font>

830
00:41:11,870 --> 00:41:17,150
<font color="#E5E5E5">so this is</font><font color="#CCCCCC"> also</font><font color="#E5E5E5"> quite</font><font color="#CCCCCC"> popular this year</font>

831
00:41:14,240 --> 00:41:19,250
<font color="#CCCCCC">sage consumer and next lucky</font><font color="#E5E5E5"> ransomware</font>

832
00:41:17,150 --> 00:41:21,080
<font color="#CCCCCC">file share shares the same download</font>

833
00:41:19,250 --> 00:41:23,780
<font color="#E5E5E5">servers with fake globe ransomware</font>

834
00:41:21,080 --> 00:41:25,910
<font color="#E5E5E5">so</font><font color="#CCCCCC"> even though we can</font><font color="#E5E5E5"> see a direct</font>

835
00:41:23,780 --> 00:41:28,160
connection<font color="#E5E5E5"> with this malware we can</font>

836
00:41:25,910 --> 00:41:31,190
prove enough that<font color="#E5E5E5"> only one cyber</font>

837
00:41:28,160 --> 00:41:32,990
criminal or one<font color="#E5E5E5"> hug group is behind our</font>

838
00:41:31,190 --> 00:41:35,570
speculation<font color="#E5E5E5"> would be that the malware</font>

839
00:41:32,990 --> 00:41:38,000
<font color="#CCCCCC">authors are one group the creator of the</font>

840
00:41:35,570 --> 00:41:40,040
<font color="#E5E5E5">loaders is another group and the spam</font>

841
00:41:38,000 --> 00:41:41,630
bots<font color="#E5E5E5"> again is another group</font>

842
00:41:40,040 --> 00:41:44,720
<font color="#E5E5E5">it just happens that</font><font color="#CCCCCC"> this malware</font>

843
00:41:41,630 --> 00:41:49,720
<font color="#E5E5E5">authors bought the service from one</font>

844
00:41:44,720 --> 00:41:52,910
group<font color="#E5E5E5"> who handles the fun but so</font><font color="#CCCCCC"> just</font>

845
00:41:49,720 --> 00:41:55,640
<font color="#E5E5E5">conclusion so to give some better</font>

846
00:41:52,910 --> 00:41:57,799
perspective<font color="#CCCCCC"> so let's say for example</font>

847
00:41:55,640 --> 00:42:00,620
that<font color="#E5E5E5"> you</font><font color="#CCCCCC"> are just</font><font color="#E5E5E5"> an ordinary</font><font color="#CCCCCC"> computer</font>

848
00:41:57,800 --> 00:42:03,200
<font color="#E5E5E5">user</font><font color="#CCCCCC"> you just use your computer on</font><font color="#E5E5E5"> day</font>

849
00:42:00,620 --> 00:42:05,600
<font color="#E5E5E5">to day job and all of a</font><font color="#CCCCCC"> sudden you were</font>

850
00:42:03,200 --> 00:42:07,700
surprised that<font color="#E5E5E5"> your desktop wallpaper</font>

851
00:42:05,600 --> 00:42:10,130
has been changed<font color="#E5E5E5"> saying that all your</font>

852
00:42:07,700 --> 00:42:12,049
important files have been encrypted<font color="#E5E5E5"> then</font>

853
00:42:10,130 --> 00:42:14,530
you felt some adrenaline<font color="#CCCCCC"> you</font><font color="#E5E5E5"> need to</font>

854
00:42:12,050 --> 00:42:17,150
look at your important files<font color="#E5E5E5"> pictures</font>

855
00:42:14,530 --> 00:42:19,880
financial statements<font color="#E5E5E5"> and everything</font><font color="#CCCCCC"> and</font>

856
00:42:17,150 --> 00:42:22,520
as it turns out all<font color="#CCCCCC"> of it</font><font color="#E5E5E5"> are already</font>

857
00:42:19,880 --> 00:42:24,620
corrupted or encrypted<font color="#E5E5E5"> so there's really</font>

858
00:42:22,520 --> 00:42:27,800
nothing<font color="#CCCCCC"> you can do to recover</font><font color="#E5E5E5"> your files</font>

859
00:42:24,620 --> 00:42:29,720
<font color="#E5E5E5">unless</font><font color="#CCCCCC"> you pay a certain</font><font color="#E5E5E5"> price so the</font>

860
00:42:27,800 --> 00:42:32,140
question is are you<font color="#E5E5E5"> willing to pay the</font>

861
00:42:29,720 --> 00:42:34,879
price<font color="#CCCCCC"> or will you</font><font color="#E5E5E5"> let your files go</font>

862
00:42:32,140 --> 00:42:44,859
thank you

863
00:42:34,880 --> 00:42:44,860
[Applause]

864
00:42:46,069 --> 00:43:01,920
we have 10<font color="#CCCCCC"> minutes for Christians you</font>

865
00:42:59,549 --> 00:43:04,529
have said that<font color="#E5E5E5"> there are multiple groups</font>

866
00:43:01,920 --> 00:43:07,049
that work together and<font color="#CCCCCC"> buy</font><font color="#E5E5E5"> services from</font>

867
00:43:04,529 --> 00:43:08,989
each other<font color="#E5E5E5"> yeah</font><font color="#CCCCCC"> would it be</font><font color="#E5E5E5"> that to be</font>

868
00:43:07,049 --> 00:43:12,779
an affiliate you<font color="#E5E5E5"> have to provide</font>

869
00:43:08,989 --> 00:43:14,759
<font color="#CCCCCC">compromised server for the URLs</font><font color="#E5E5E5"> or for</font>

870
00:43:12,779 --> 00:43:16,200
spam servers and that's why there<font color="#CCCCCC"> are</font>

871
00:43:14,759 --> 00:43:16,619
shirts<font color="#E5E5E5"> of resources but they're not</font>

872
00:43:16,200 --> 00:43:19,799
really

873
00:43:16,619 --> 00:43:23,119
<font color="#E5E5E5">hacking roofs</font><font color="#CCCCCC"> just people that has a</font>

874
00:43:19,799 --> 00:43:25,920
possibility to exploit<font color="#E5E5E5"> or enter some</font>

875
00:43:23,119 --> 00:43:31,440
servers and then decide<font color="#CCCCCC"> to use this DS</font>

876
00:43:25,920 --> 00:43:33,839
and use the service offered<font color="#CCCCCC"> ok</font><font color="#E5E5E5"> I think</font>

877
00:43:31,440 --> 00:43:35,819
for the affiliates like<font color="#E5E5E5"> it could be</font>

878
00:43:33,839 --> 00:43:38,640
anyone as<font color="#E5E5E5"> long as they're</font><font color="#CCCCCC"> there willing</font>

879
00:43:35,819 --> 00:43:39,989
<font color="#CCCCCC">to get the</font><font color="#E5E5E5"> ransomware and give the</font>

880
00:43:38,640 --> 00:43:42,239
Commission<font color="#E5E5E5"> that the malware author and</font>

881
00:43:39,989 --> 00:43:44,609
they have contacts<font color="#E5E5E5"> like they could not</font>

882
00:43:42,239 --> 00:43:46,559
<font color="#CCCCCC">necessarily</font><font color="#E5E5E5"> be the spam bot but they</font>

883
00:43:44,609 --> 00:43:48,959
could get<font color="#E5E5E5"> the service of a spambot group</font>

884
00:43:46,559 --> 00:43:50,849
then get a<font color="#CCCCCC"> loader group so it doesn't</font>

885
00:43:48,959 --> 00:43:54,359
mean<font color="#CCCCCC"> that</font><font color="#E5E5E5"> I must</font><font color="#CCCCCC"> plan but then I</font><font color="#E5E5E5"> need a</font>

886
00:43:50,849 --> 00:43:56,039
<font color="#E5E5E5">I need a malware to to spread so I think</font>

887
00:43:54,359 --> 00:43:57,779
it's not<font color="#CCCCCC"> that it's</font><font color="#E5E5E5"> not that</font><font color="#CCCCCC"> the facings</font>

888
00:43:56,039 --> 00:44:01,319
they will have some conflict of<font color="#E5E5E5"> interest</font>

889
00:43:57,779 --> 00:44:02,759
<font color="#E5E5E5">so I think as I may be as a cyber</font>

890
00:44:01,319 --> 00:44:04,380
<font color="#CCCCCC">criminal then they will get this</font><font color="#E5E5E5"> and</font>

891
00:44:02,759 --> 00:44:06,059
they know some contacts who have<font color="#E5E5E5"> these</font>

892
00:44:04,380 --> 00:44:14,519
<font color="#CCCCCC">services then they will just combined</font><font color="#E5E5E5"> it</font>

893
00:44:06,059 --> 00:44:20,910
then<font color="#E5E5E5"> spread it so yeah I think order</font>

894
00:44:14,519 --> 00:44:23,488
equation are there any other tips

895
00:44:20,910 --> 00:44:27,118
suggesting some attribution like for

896
00:44:23,489 --> 00:44:29,249
example this ignore<font color="#E5E5E5"> Russia when you talk</font>

897
00:44:27,119 --> 00:44:31,859
<font color="#CCCCCC">about the times where the email</font>

898
00:44:29,249 --> 00:44:36,988
campaigns<font color="#E5E5E5"> arrived like which time zone</font>

899
00:44:31,859 --> 00:44:40,140
<font color="#E5E5E5">where those for</font><font color="#CCCCCC"> example I think since we</font>

900
00:44:36,989 --> 00:44:43,440
track it<font color="#E5E5E5"> in UTC time so when I check in</font>

901
00:44:40,140 --> 00:44:46,259
Google UTC time is UK so I don't know

902
00:44:43,440 --> 00:44:49,289
<font color="#E5E5E5">yeah if they're from there or did they</font>

903
00:44:46,259 --> 00:44:51,660
really target<font color="#CCCCCC"> QK so at</font><font color="#E5E5E5"> that time like</font>

904
00:44:49,289 --> 00:44:53,369
<font color="#E5E5E5">people will open email so it's</font><font color="#CCCCCC"> really</font>

905
00:44:51,660 --> 00:44:54,690
<font color="#E5E5E5">hard to attribute attribute if</font>

906
00:44:53,369 --> 00:44:56,910
<font color="#CCCCCC">especially if</font>

907
00:44:54,690 --> 00:44:58,770
is in the affiliate<font color="#E5E5E5"> program</font><font color="#CCCCCC"> there is</font><font color="#E5E5E5"> not</font>

908
00:44:56,910 --> 00:45:00,480
only<font color="#CCCCCC"> one group but multiple people who</font>

909
00:44:58,770 --> 00:45:03,480
are<font color="#E5E5E5"> behind</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> so they leave a lot of</font>

910
00:45:00,480 --> 00:45:04,170
traces but they don't connect to like

911
00:45:03,480 --> 00:45:15,960
someone

912
00:45:04,170 --> 00:45:17,819
yeah so it's hard<font color="#CCCCCC"> to point I think from</font>

913
00:45:15,960 --> 00:45:27,210
all that we have observed<font color="#E5E5E5"> it's always</font>

914
00:45:17,819 --> 00:45:31,200
one yeah<font color="#E5E5E5"> it's</font><font color="#CCCCCC"> safety senior in the</font>

915
00:45:27,210 --> 00:45:34,980
reason why they are<font color="#CCCCCC"> using only</font><font color="#E5E5E5"> a yes</font><font color="#CCCCCC"> one</font>

916
00:45:31,200 --> 00:45:35,430
<font color="#CCCCCC">two eight not for example two two five</font>

917
00:45:34,980 --> 00:45:38,640
six

918
00:45:35,430 --> 00:45:42,240
I think a s12 it would be enough<font color="#E5E5E5"> since</font>

919
00:45:38,640 --> 00:45:45,210
they encrypt<font color="#E5E5E5"> encrypted by ours a</font><font color="#CCCCCC"> twenty</font>

920
00:45:42,240 --> 00:45:47,720
<font color="#CCCCCC">four eight so the very the real</font>

921
00:45:45,210 --> 00:45:51,180
<font color="#E5E5E5">protection to the to them is the RSA so</font>

922
00:45:47,720 --> 00:45:53,848
so to be able<font color="#E5E5E5"> to get the the use key</font>

923
00:45:51,180 --> 00:45:55,910
<font color="#CCCCCC">that is</font><font color="#E5E5E5"> monthly they still need the RSA</font>

924
00:45:53,849 --> 00:45:59,700
private key so<font color="#E5E5E5"> I think they don't need a</font>

925
00:45:55,910 --> 00:46:01,319
higher encryption for because it will it

926
00:45:59,700 --> 00:46:11,810
will take more time<font color="#E5E5E5"> to encrypt the files</font>

927
00:46:01,319 --> 00:46:11,810
so yeah no question

928
00:46:15,760 --> 00:46:22,630
how long does it take generally to

929
00:46:18,190 --> 00:46:24,490
encrypt the whole computer<font color="#CCCCCC"> I think in a</font>

930
00:46:22,630 --> 00:46:29,100
couple<font color="#CCCCCC"> of minutes</font><font color="#E5E5E5"> like less</font><font color="#CCCCCC"> than the</font>

931
00:46:24,490 --> 00:46:29,100
<font color="#CCCCCC">tides 5-10</font><font color="#E5E5E5"> minutes then it's done yeah</font>

932
00:46:40,290 --> 00:46:48,100
<font color="#E5E5E5">I've seen new runs more use encryption</font>

933
00:46:44,350 --> 00:46:49,779
of<font color="#E5E5E5"> the MFT table or of the boot sector</font>

934
00:46:48,100 --> 00:46:51,520
so stuff<font color="#CCCCCC"> like that</font><font color="#E5E5E5"> yeah does</font><font color="#CCCCCC"> look you</font>

935
00:46:49,780 --> 00:46:56,080
<font color="#E5E5E5">have anything more advanced than just</font>

936
00:46:51,520 --> 00:46:59,050
files<font color="#CCCCCC"> I think for now that's that's</font>

937
00:46:56,080 --> 00:47:01,480
their target like<font color="#E5E5E5"> I think the like the</font>

938
00:46:59,050 --> 00:47:02,050
<font color="#E5E5E5">not pad yeah it's like the boot boot</font>

939
00:47:01,480 --> 00:47:05,280
ransomware

940
00:47:02,050 --> 00:47:08,080
<font color="#CCCCCC">I think for lucky they haven't done any</font>

941
00:47:05,280 --> 00:47:12,119
major changes from<font color="#E5E5E5"> like from</font><font color="#CCCCCC"> last year</font>

942
00:47:08,080 --> 00:47:12,119
so<font color="#E5E5E5"> it's still the same yeah</font>

943
00:47:16,080 --> 00:47:19,680
one last question

944
00:47:27,880 --> 00:47:33,849
did you find some component<font color="#E5E5E5"> of this kind</font>

945
00:47:31,389 --> 00:47:41,049
<font color="#E5E5E5">of row somewhere like open source part</font>

946
00:47:33,849 --> 00:47:43,599
or<font color="#E5E5E5"> oh it is built I think there's no</font>

947
00:47:41,049 --> 00:47:45,069
basis for open source<font color="#E5E5E5"> and as you can</font><font color="#CCCCCC"> see</font>

948
00:47:43,599 --> 00:47:47,229
in the<font color="#CCCCCC"> Lucky's development they</font>

949
00:47:45,069 --> 00:47:49,599
<font color="#CCCCCC">continued to</font><font color="#E5E5E5"> develop it and from this</font>

950
00:47:47,229 --> 00:47:53,109
<font color="#E5E5E5">development</font><font color="#CCCCCC"> I haven't seen any other</font>

951
00:47:49,599 --> 00:47:55,329
<font color="#E5E5E5">animal or other families</font><font color="#CCCCCC"> that do this so</font>

952
00:47:53,109 --> 00:47:58,239
yeah I<font color="#E5E5E5"> think the malware authors</font><font color="#CCCCCC"> are</font>

953
00:47:55,329 --> 00:48:16,719
really they were the ones who built from

954
00:47:58,239 --> 00:48:18,459
ground<font color="#CCCCCC"> up</font><font color="#E5E5E5"> yeah one last last so you have</font>

955
00:48:16,719 --> 00:48:20,919
shown the<font color="#E5E5E5"> timeline of</font><font color="#CCCCCC"> the evolution of</font>

956
00:48:18,459 --> 00:48:23,078
the ransomware<font color="#CCCCCC"> yeah how much time does</font>

957
00:48:20,919 --> 00:48:25,319
it take you to analyze the<font color="#E5E5E5"> differences</font>

958
00:48:23,079 --> 00:48:29,619
between the different version<font color="#E5E5E5"> of the</font>

959
00:48:25,319 --> 00:48:33,279
ransomware<font color="#CCCCCC"> I think initially we took</font>

960
00:48:29,619 --> 00:48:36,209
like maybe a week or two to<font color="#E5E5E5"> analyze the</font>

961
00:48:33,279 --> 00:48:38,889
whole ransomware<font color="#E5E5E5"> then after that we</font>

962
00:48:36,209 --> 00:48:41,019
<font color="#E5E5E5">rebuilt the harvesting of</font><font color="#CCCCCC"> the</font>

963
00:48:38,889 --> 00:48:43,659
configuration so with that we were able

964
00:48:41,019 --> 00:48:45,368
<font color="#CCCCCC">to like we we don't check</font><font color="#E5E5E5"> it daily but</font>

965
00:48:43,659 --> 00:48:47,589
<font color="#E5E5E5">it sends us a notification like</font>

966
00:48:45,369 --> 00:48:50,229
something's wrong like<font color="#E5E5E5"> we weren't able</font>

967
00:48:47,589 --> 00:48:52,449
to we weren't able to<font color="#E5E5E5"> get this</font>

968
00:48:50,229 --> 00:48:54,459
configuration<font color="#E5E5E5"> so once we have that</font>

969
00:48:52,449 --> 00:48:56,679
notification<font color="#CCCCCC"> that's the time when we</font>

970
00:48:54,459 --> 00:48:58,598
check again<font color="#E5E5E5"> a sample then if it's</font>

971
00:48:56,679 --> 00:49:02,369
something new then we just update our

972
00:48:58,599 --> 00:49:05,019
database then<font color="#E5E5E5"> we move on forward but</font>

973
00:49:02,369 --> 00:49:08,589
since there were<font color="#E5E5E5"> really</font><font color="#CCCCCC"> no major changes</font>

974
00:49:05,019 --> 00:49:11,078
<font color="#E5E5E5">from its initial outbreak then yeah it</font>

975
00:49:08,589 --> 00:49:15,969
may be just<font color="#E5E5E5"> a few</font><font color="#CCCCCC"> hours a day if there's</font>

976
00:49:11,079 --> 00:49:18,389
something you yeah that's all<font color="#E5E5E5"> okay thank</font>

977
00:49:15,969 --> 00:49:18,389
you<font color="#CCCCCC"> again</font>

978
00:49:18,480 --> 00:49:23,409
[Applause]

