1
00:00:02,570 --> 00:00:10,490
<font color="#E5E5E5">all right so thanks for being there</font><font color="#CCCCCC"> just</font>

2
00:00:06,529 --> 00:00:13,510
<font color="#E5E5E5">before I start I will not play the</font>

3
00:00:10,490 --> 00:00:16,910
attribution game<font color="#E5E5E5"> so</font><font color="#CCCCCC"> I won't tell I</font>

4
00:00:13,510 --> 00:00:19,310
should not tell any names during<font color="#E5E5E5"> that</font>

5
00:00:16,910 --> 00:00:21,560
presentation<font color="#CCCCCC"> I'll just show you</font><font color="#E5E5E5"> some</font>

6
00:00:19,310 --> 00:00:24,409
tricks<font color="#CCCCCC"> that actually you can do</font><font color="#E5E5E5"> that</font>

7
00:00:21,560 --> 00:00:27,110
will kind of<font color="#E5E5E5"> mimic real Hardware</font>

8
00:00:24,410 --> 00:00:32,570
implants<font color="#E5E5E5"> that you can do at home if you</font>

9
00:00:27,110 --> 00:00:36,710
like so how<font color="#E5E5E5"> did I start exactly</font><font color="#CCCCCC"> so we</font>

10
00:00:32,570 --> 00:00:39,140
saw the big news there sorry I said<font color="#CCCCCC"> okay</font>

11
00:00:36,710 --> 00:00:41,899
no names there so I fixed that using

12
00:00:39,140 --> 00:00:42,170
GIMP<font color="#CCCCCC"> a lot</font><font color="#E5E5E5"> of skills there so that's</font>

13
00:00:41,899 --> 00:00:45,129
fine

14
00:00:42,170 --> 00:00:49,850
so actually there was a huge article

15
00:00:45,129 --> 00:00:52,420
about people<font color="#E5E5E5"> implanting</font><font color="#CCCCCC"> Hardware stuff</font>

16
00:00:49,850 --> 00:00:58,549
into motherboards<font color="#E5E5E5"> that could potentially</font>

17
00:00:52,420 --> 00:01:01,670
access the<font color="#E5E5E5"> CPU DRAM etc and send that</font>

18
00:00:58,549 --> 00:01:04,159
<font color="#E5E5E5">through the network and that was a big</font>

19
00:01:01,670 --> 00:01:06,910
thing etc<font color="#E5E5E5"> and yeah a lot</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> people were</font>

20
00:01:04,159 --> 00:01:09,860
saying yes that's possible<font color="#E5E5E5"> no that's not</font>

21
00:01:06,910 --> 00:01:14,179
<font color="#E5E5E5">yes it's doable no it's not but there</font>

22
00:01:09,860 --> 00:01:16,970
was no technical technical article about

23
00:01:14,180 --> 00:01:22,130
how<font color="#E5E5E5"> to do it exactly</font><font color="#CCCCCC"> so this</font><font color="#E5E5E5"> is the</font>

24
00:01:16,970 --> 00:01:24,530
purpose of<font color="#CCCCCC"> that presentation so in one</font>

25
00:01:22,130 --> 00:01:26,509
<font color="#CCCCCC">of the part of</font><font color="#E5E5E5"> the article</font><font color="#CCCCCC"> there was</font>

26
00:01:24,530 --> 00:01:29,180
that<font color="#CCCCCC"> specific phrase the legitimate</font>

27
00:01:26,510 --> 00:01:31,370
server was communicating one way and the

28
00:01:29,180 --> 00:01:32,750
end<font color="#CCCCCC"> plant</font><font color="#E5E5E5"> another but all the traffic</font>

29
00:01:31,370 --> 00:01:37,460
appeared to be<font color="#E5E5E5"> coming from the same</font>

30
00:01:32,750 --> 00:01:40,730
<font color="#E5E5E5">trusted server so that's particular</font>

31
00:01:37,460 --> 00:01:43,850
thing was like<font color="#E5E5E5"> bothering me because that</font>

32
00:01:40,730 --> 00:01:45,860
would<font color="#E5E5E5"> mean that in some</font><font color="#CCCCCC"> way there is</font>

33
00:01:43,850 --> 00:01:48,589
something<font color="#CCCCCC"> that</font><font color="#E5E5E5"> could access some of</font><font color="#CCCCCC"> the</font>

34
00:01:45,860 --> 00:01:51,680
<font color="#E5E5E5">parts of the</font><font color="#CCCCCC"> motörboat without the</font><font color="#E5E5E5"> host</font>

35
00:01:48,590 --> 00:01:57,350
knowing it so exactly<font color="#CCCCCC"> how</font><font color="#E5E5E5"> is that</font>

36
00:01:51,680 --> 00:01:59,750
possible so basically I need<font color="#E5E5E5"> to check</font>

37
00:01:57,350 --> 00:02:02,119
<font color="#CCCCCC">that</font><font color="#E5E5E5"> if you see the picture there you</font>

38
00:01:59,750 --> 00:02:05,120
see that<font color="#CCCCCC"> that specific implant is</font><font color="#E5E5E5"> like</font>

39
00:02:02,120 --> 00:02:08,840
three pins<font color="#E5E5E5"> so that's not a lot of</font>

40
00:02:05,120 --> 00:02:11,689
signals<font color="#CCCCCC"> that you</font><font color="#E5E5E5"> can actually use to to</font>

41
00:02:08,840 --> 00:02:13,700
make an implant<font color="#E5E5E5"> so only three pins to</font>

42
00:02:11,689 --> 00:02:16,650
play with the

43
00:02:13,700 --> 00:02:20,089
with the<font color="#E5E5E5"> ethernet card</font>

44
00:02:16,650 --> 00:02:23,300
it sounds really too good to be true<font color="#CCCCCC"> so</font>

45
00:02:20,090 --> 00:02:26,520
first thing<font color="#CCCCCC"> to do</font><font color="#E5E5E5"> let's play with the</font>

46
00:02:23,300 --> 00:02:29,790
<font color="#CCCCCC">width let's use Google try to find some</font>

47
00:02:26,520 --> 00:02:32,640
information<font color="#CCCCCC"> etc I found nothing</font><font color="#E5E5E5"> maybe my</font>

48
00:02:29,790 --> 00:02:34,470
<font color="#E5E5E5">Google who is not that good but I didn't</font>

49
00:02:32,640 --> 00:02:35,988
find anything<font color="#CCCCCC"> so I better check it</font><font color="#E5E5E5"> out</font>

50
00:02:34,470 --> 00:02:43,410
by<font color="#CCCCCC"> myself</font>

51
00:02:35,989 --> 00:02:46,410
let's start so first thing is<font color="#E5E5E5"> if you</font>

52
00:02:43,410 --> 00:02:51,780
know<font color="#E5E5E5"> about servers etc you know about</font>

53
00:02:46,410 --> 00:02:53,609
<font color="#CCCCCC">IPMI everybody knows what ipmi is okay</font>

54
00:02:51,780 --> 00:02:56,880
so<font color="#E5E5E5"> basically it's a it's an out-of-band</font>

55
00:02:53,610 --> 00:02:59,540
management for<font color="#E5E5E5"> a four servers normally</font>

56
00:02:56,880 --> 00:03:04,380
you have<font color="#CCCCCC"> on different</font><font color="#E5E5E5"> vendors they have</font>

57
00:02:59,540 --> 00:03:06,660
different names<font color="#CCCCCC"> idrac ILO etc they</font>

58
00:03:04,380 --> 00:03:10,230
normally use<font color="#CCCCCC"> a separate network</font>

59
00:03:06,660 --> 00:03:13,470
interface but there are cases<font color="#E5E5E5"> where</font><font color="#CCCCCC"> you</font>

60
00:03:10,230 --> 00:03:17,340
can<font color="#CCCCCC"> use the same interface to access to</font>

61
00:03:13,470 --> 00:03:19,609
use the<font color="#E5E5E5"> the out-of-band management how</font>

62
00:03:17,340 --> 00:03:22,950
does<font color="#E5E5E5"> it work exactly in practice</font><font color="#CCCCCC"> so</font>

63
00:03:19,609 --> 00:03:24,390
within the<font color="#CCCCCC"> ipmi you have the central</font>

64
00:03:22,950 --> 00:03:26,458
<font color="#E5E5E5">path there which is called the BMC</font>

65
00:03:24,390 --> 00:03:29,070
basement management controller which is

66
00:03:26,459 --> 00:03:32,190
<font color="#CCCCCC">the central core</font><font color="#E5E5E5"> of the out-of-band</font>

67
00:03:29,070 --> 00:03:34,858
management of your server<font color="#E5E5E5"> and this is</font>

68
00:03:32,190 --> 00:03:37,260
the image from<font color="#E5E5E5"> a</font><font color="#CCCCCC"> Wikipedia and if you</font>

69
00:03:34,859 --> 00:03:41,430
just look there you have the NIC<font color="#E5E5E5"> network</font>

70
00:03:37,260 --> 00:03:45,709
interface card and<font color="#E5E5E5"> smbus with a nice</font>

71
00:03:41,430 --> 00:03:49,890
word which is sideband it looks really a

72
00:03:45,709 --> 00:03:52,049
lot<font color="#CCCCCC"> like what the article</font><font color="#E5E5E5"> said like you</font>

73
00:03:49,890 --> 00:03:56,970
use the<font color="#CCCCCC"> same</font><font color="#E5E5E5"> network card</font><font color="#CCCCCC"> but for</font>

74
00:03:52,049 --> 00:04:00,170
sideband access for other<font color="#E5E5E5"> stuff so let's</font>

75
00:03:56,970 --> 00:04:03,510
dig into that<font color="#E5E5E5"> what is exactly smbus</font>

76
00:04:00,170 --> 00:04:06,149
smbus is a system management bus it's

77
00:04:03,510 --> 00:04:09,690
derived from<font color="#E5E5E5"> another protocol which</font><font color="#CCCCCC"> is</font>

78
00:04:06,150 --> 00:04:12,930
called<font color="#E5E5E5"> I</font><font color="#CCCCCC"> Square C and again</font><font color="#E5E5E5"> from</font>

79
00:04:09,690 --> 00:04:17,039
<font color="#E5E5E5">Wikipedia it's a single engine simple to</font>

80
00:04:12,930 --> 00:04:20,639
wire<font color="#E5E5E5"> bus looks very good</font><font color="#CCCCCC"> because</font>

81
00:04:17,039 --> 00:04:23,729
remember you are on the picture before

82
00:04:20,639 --> 00:04:26,530
<font color="#CCCCCC">we</font><font color="#E5E5E5"> had like</font><font color="#CCCCCC"> three wires</font><font color="#E5E5E5"> three pins and</font>

83
00:04:23,729 --> 00:04:28,800
there with only two wires

84
00:04:26,530 --> 00:04:34,119
you should be able to<font color="#CCCCCC"> communicate</font><font color="#E5E5E5"> with a</font>

85
00:04:28,800 --> 00:04:36,690
<font color="#E5E5E5">network card</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> maybe do some some</font>

86
00:04:34,120 --> 00:04:41,320
nasty<font color="#CCCCCC"> stuff we will see that later so</font>

87
00:04:36,690 --> 00:04:44,590
<font color="#E5E5E5">that looks really promising so with</font>

88
00:04:41,320 --> 00:04:47,169
knowing<font color="#E5E5E5"> the fact that smbus is available</font>

89
00:04:44,590 --> 00:04:51,580
on some<font color="#CCCCCC"> Nicks</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> assembles using</font>

90
00:04:47,169 --> 00:04:54,760
uses<font color="#CCCCCC"> only two wires</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> I started to</font>

91
00:04:51,580 --> 00:05:02,520
look for hardware that actually<font color="#E5E5E5"> uses</font>

92
00:04:54,760 --> 00:05:04,810
that<font color="#E5E5E5"> specific smbus yeah using smbus so</font>

93
00:05:02,520 --> 00:05:09,789
<font color="#E5E5E5">unfortunately</font><font color="#CCCCCC"> I didn't</font><font color="#E5E5E5"> have any service</font>

94
00:05:04,810 --> 00:05:13,810
<font color="#CCCCCC">available at home so I found on the</font>

95
00:05:09,790 --> 00:05:16,060
<font color="#CCCCCC">internet</font><font color="#E5E5E5"> on some websites the PCI</font>

96
00:05:13,810 --> 00:05:21,010
Express<font color="#E5E5E5"> cards network cards that are</font>

97
00:05:16,060 --> 00:05:22,720
using<font color="#E5E5E5"> that specific chipset and if you</font>

98
00:05:21,010 --> 00:05:24,909
look at the<font color="#E5E5E5"> the information on the</font>

99
00:05:22,720 --> 00:05:27,520
website<font color="#E5E5E5"> you</font><font color="#CCCCCC"> see that there is something</font>

100
00:05:24,910 --> 00:05:31,270
<font color="#CCCCCC">that is called SMS path through on that</font>

101
00:05:27,520 --> 00:05:32,979
specific that specific chipset this is a

102
00:05:31,270 --> 00:05:37,599
good<font color="#E5E5E5"> thing so I ordered</font><font color="#CCCCCC"> some of</font><font color="#E5E5E5"> those</font>

103
00:05:32,979 --> 00:05:40,960
boards<font color="#CCCCCC"> and</font><font color="#E5E5E5"> start to look at the data</font>

104
00:05:37,600 --> 00:05:44,890
<font color="#E5E5E5">sheet data sheet</font><font color="#CCCCCC"> is basically everything</font>

105
00:05:40,960 --> 00:05:51,099
you<font color="#E5E5E5"> need to know about that chipset it's</font>

106
00:05:44,890 --> 00:05:53,710
a nice PDF of about<font color="#CCCCCC"> 500 pages</font><font color="#E5E5E5"> and yeah I</font>

107
00:05:51,100 --> 00:05:57,280
read a lot<font color="#E5E5E5"> of that to understand exactly</font>

108
00:05:53,710 --> 00:05:59,169
how it<font color="#CCCCCC"> works</font><font color="#E5E5E5"> so that would be the motto</font>

109
00:05:57,280 --> 00:06:01,479
<font color="#CCCCCC">of that talk</font><font color="#E5E5E5"> everything</font><font color="#CCCCCC"> you need</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> know</font>

110
00:05:59,169 --> 00:06:03,640
is in<font color="#E5E5E5"> the</font><font color="#CCCCCC"> datasheet</font><font color="#E5E5E5"> because what I will</font>

111
00:06:01,479 --> 00:06:05,590
show you there everything is written in

112
00:06:03,640 --> 00:06:07,570
<font color="#E5E5E5">the datasheet so there's nothing</font><font color="#CCCCCC"> new</font>

113
00:06:05,590 --> 00:06:10,150
nothing special it's<font color="#CCCCCC"> just reading</font><font color="#E5E5E5"> the</font>

114
00:06:07,570 --> 00:06:14,190
<font color="#CCCCCC">datasheet and applying</font><font color="#E5E5E5"> what is actually</font>

115
00:06:10,150 --> 00:06:19,120
<font color="#E5E5E5">publicly available on the the vendors</font>

116
00:06:14,190 --> 00:06:22,719
documentation so first of all we need<font color="#E5E5E5"> to</font>

117
00:06:19,120 --> 00:06:27,400
<font color="#E5E5E5">have</font><font color="#CCCCCC"> access to smbus on the on the card</font>

118
00:06:22,720 --> 00:06:30,280
<font color="#E5E5E5">so first part is locate</font><font color="#CCCCCC"> the signals on</font>

119
00:06:27,400 --> 00:06:33,280
that chip<font color="#E5E5E5"> so what do</font><font color="#CCCCCC"> we do we</font><font color="#E5E5E5"> take the</font>

120
00:06:30,280 --> 00:06:38,140
<font color="#CCCCCC">datasheet and we have that nice picture</font>

121
00:06:33,280 --> 00:06:39,248
<font color="#E5E5E5">with the pins there that I need to to</font>

122
00:06:38,140 --> 00:06:41,079
access<font color="#E5E5E5"> the</font>

123
00:06:39,249 --> 00:06:43,089
it's written<font color="#E5E5E5"> in</font><font color="#CCCCCC"> the datasheet you have</font>

124
00:06:41,079 --> 00:06:46,299
all the information<font color="#CCCCCC"> about</font><font color="#E5E5E5"> which pin does</font>

125
00:06:43,089 --> 00:06:50,079
what blah blah blah<font color="#E5E5E5"> so to make</font><font color="#CCCCCC"> it easier</font>

126
00:06:46,299 --> 00:06:51,729
for<font color="#E5E5E5"> you that's just</font><font color="#CCCCCC"> those</font><font color="#E5E5E5"> three pins so</font>

127
00:06:50,079 --> 00:06:55,959
<font color="#CCCCCC">okay that's</font><font color="#E5E5E5"> fine we have the chip there</font>

128
00:06:51,729 --> 00:06:58,419
which is<font color="#E5E5E5"> this one here</font><font color="#CCCCCC"> and so somewhere</font>

129
00:06:55,959 --> 00:07:03,129
up there<font color="#E5E5E5"> we should have our three</font>

130
00:06:58,419 --> 00:07:06,219
signals that go somewhere cool<font color="#E5E5E5"> but how</font>

131
00:07:03,129 --> 00:07:09,759
do we<font color="#E5E5E5"> actually know where they</font><font color="#CCCCCC"> are</font><font color="#E5E5E5"> going</font>

132
00:07:06,219 --> 00:07:12,969
<font color="#E5E5E5">to so we take some</font><font color="#CCCCCC"> pictures</font><font color="#E5E5E5"> using a</font>

133
00:07:09,759 --> 00:07:19,059
camera<font color="#E5E5E5"> and we have our three pins which</font>

134
00:07:12,969 --> 00:07:20,909
are there which are those three there so

135
00:07:19,059 --> 00:07:27,249
it's those ones<font color="#E5E5E5"> so basically you just</font>

136
00:07:20,909 --> 00:07:31,329
<font color="#CCCCCC">use your your</font><font color="#E5E5E5"> GIMP skills to trace those</font>

137
00:07:27,249 --> 00:07:34,239
signals unfortunately we see that they

138
00:07:31,329 --> 00:07:36,699
are<font color="#CCCCCC"> going</font><font color="#E5E5E5"> to those kind of</font><font color="#CCCCCC"> smaller holes</font>

139
00:07:34,239 --> 00:07:40,919
<font color="#E5E5E5">which are called vias what</font><font color="#CCCCCC"> are vias</font>

140
00:07:36,699 --> 00:07:45,099
exactly it's a way for<font color="#E5E5E5"> people designing</font>

141
00:07:40,919 --> 00:07:48,849
<font color="#E5E5E5">PCBs to actually send the signal to</font><font color="#CCCCCC"> the</font>

142
00:07:45,099 --> 00:07:52,449
other side of the PCB<font color="#CCCCCC"> the</font><font color="#E5E5E5"> thing</font>

143
00:07:48,849 --> 00:07:56,529
understands yeah cool<font color="#E5E5E5"> so how do we do</font>

144
00:07:52,449 --> 00:07:57,099
<font color="#E5E5E5">that</font><font color="#CCCCCC"> to trace all</font><font color="#E5E5E5"> of the see those</font>

145
00:07:56,529 --> 00:08:00,610
signals

146
00:07:57,099 --> 00:08:03,069
<font color="#E5E5E5">I used games give</font><font color="#CCCCCC"> you use you take</font>

147
00:08:00,610 --> 00:08:05,319
pictures of one side<font color="#E5E5E5"> of the board then</font>

148
00:08:03,069 --> 00:08:08,679
the other side<font color="#E5E5E5"> then using GIMP you</font>

149
00:08:05,319 --> 00:08:13,689
change<font color="#E5E5E5"> you arrange the</font><font color="#CCCCCC"> two images to</font>

150
00:08:08,679 --> 00:08:17,919
align them to<font color="#CCCCCC"> have the two vias</font><font color="#E5E5E5"> mapped</font>

151
00:08:13,689 --> 00:08:20,919
together<font color="#CCCCCC"> if I do this that way you see</font>

152
00:08:17,919 --> 00:08:28,839
that the via the vias<font color="#CCCCCC"> are correctly</font>

153
00:08:20,919 --> 00:08:31,948
aligned so once we know<font color="#CCCCCC"> that those are</font>

154
00:08:28,839 --> 00:08:35,588
<font color="#E5E5E5">the signals that we</font><font color="#CCCCCC"> are looking for</font>

155
00:08:31,949 --> 00:08:38,519
<font color="#E5E5E5">again we are just following them on one</font>

156
00:08:35,589 --> 00:08:41,769
<font color="#E5E5E5">side</font><font color="#CCCCCC"> of the board then on the</font><font color="#E5E5E5"> next side</font>

157
00:08:38,519 --> 00:08:45,509
that is good so let's follow that<font color="#E5E5E5"> to the</font>

158
00:08:41,769 --> 00:08:45,509
<font color="#CCCCCC">the end of the board and</font>

159
00:08:45,610 --> 00:08:51,130
we see that<font color="#E5E5E5"> they are going</font><font color="#CCCCCC"> directly to</font>

160
00:08:48,100 --> 00:08:53,470
those<font color="#E5E5E5"> three headers that are that were</font>

161
00:08:51,130 --> 00:08:56,230
actually the<font color="#E5E5E5"> only ones on the board so I</font>

162
00:08:53,470 --> 00:08:59,110
spent a lot<font color="#E5E5E5"> of time for absolutely</font>

163
00:08:56,230 --> 00:09:03,280
nothing<font color="#E5E5E5"> because they were already there</font>

164
00:08:59,110 --> 00:09:05,740
<font color="#CCCCCC">so</font><font color="#E5E5E5"> that was fun but not really useful</font>

165
00:09:03,280 --> 00:09:11,140
once<font color="#E5E5E5"> you know</font><font color="#CCCCCC"> that its its lead it's</font>

166
00:09:05,740 --> 00:09:13,240
kind of obvious<font color="#CCCCCC"> but</font><font color="#E5E5E5"> okay so what I did</font>

167
00:09:11,140 --> 00:09:16,240
<font color="#CCCCCC">know that was soldering some headers</font>

168
00:09:13,240 --> 00:09:19,990
<font color="#E5E5E5">there connecting a device that actually</font>

169
00:09:16,240 --> 00:09:23,350
<font color="#E5E5E5">speaks I</font><font color="#CCCCCC"> Square C and once I'm</font>

170
00:09:19,990 --> 00:09:26,800
connecting I should be<font color="#CCCCCC"> able to</font><font color="#E5E5E5"> actually</font>

171
00:09:23,350 --> 00:09:31,090
send<font color="#CCCCCC"> comments</font><font color="#E5E5E5"> to the card and back that</font>

172
00:09:26,800 --> 00:09:34,900
<font color="#E5E5E5">is the that is</font><font color="#CCCCCC"> the easy plan to do that</font>

173
00:09:31,090 --> 00:09:38,080
<font color="#CCCCCC">I use what I said I I square C I square</font>

174
00:09:34,900 --> 00:09:40,329
C what<font color="#E5E5E5"> is exactly it's for inter</font>

175
00:09:38,080 --> 00:09:43,900
integrated circuits<font color="#CCCCCC"> it</font><font color="#E5E5E5"> uses two lines</font>

176
00:09:40,330 --> 00:09:46,750
the data line which is used to<font color="#CCCCCC"> send</font><font color="#E5E5E5"> the</font>

177
00:09:43,900 --> 00:09:48,880
zeros<font color="#CCCCCC"> and the ones on</font><font color="#E5E5E5"> the wire and the</font>

178
00:09:46,750 --> 00:09:51,880
other<font color="#E5E5E5"> one is the clock line</font><font color="#CCCCCC"> basically</font>

179
00:09:48,880 --> 00:09:55,270
<font color="#E5E5E5">when you use a signal you need to</font>

180
00:09:51,880 --> 00:09:57,100
synchronize<font color="#E5E5E5"> between two devices and to</font>

181
00:09:55,270 --> 00:10:00,370
synchronize that<font color="#E5E5E5"> you use the clock line</font>

182
00:09:57,100 --> 00:10:03,580
which goes<font color="#E5E5E5"> from 0 to 1</font><font color="#CCCCCC"> to 0 to</font><font color="#E5E5E5"> 1 and</font>

183
00:10:00,370 --> 00:10:06,370
each time the clock goes from 0 to 1 you

184
00:10:03,580 --> 00:10:12,190
<font color="#E5E5E5">have</font><font color="#CCCCCC"> to send a bit using the data line</font>

185
00:10:06,370 --> 00:10:14,890
<font color="#E5E5E5">so quite a simple simple protocol</font><font color="#CCCCCC"> a good</font>

186
00:10:12,190 --> 00:10:18,250
thing in the protocol is that after each

187
00:10:14,890 --> 00:10:22,180
byte so after<font color="#E5E5E5"> 8 bits</font><font color="#CCCCCC"> you send you need</font>

188
00:10:18,250 --> 00:10:25,300
to send another clock pulse<font color="#E5E5E5"> and that</font>

189
00:10:22,180 --> 00:10:28,180
<font color="#E5E5E5">time it's the slave so the device at the</font>

190
00:10:25,300 --> 00:10:32,589
other end of the bus<font color="#CCCCCC"> that needs</font><font color="#E5E5E5"> to send</font>

191
00:10:28,180 --> 00:10:34,680
you an<font color="#CCCCCC"> acknowledgment this is the</font>

192
00:10:32,590 --> 00:10:38,230
protocol which<font color="#CCCCCC"> is really good because</font>

193
00:10:34,680 --> 00:10:42,040
<font color="#CCCCCC">we'll see that later</font><font color="#E5E5E5"> we can in that</font><font color="#CCCCCC"> way</font>

194
00:10:38,230 --> 00:10:44,720
know exactly when the card stops

195
00:10:42,040 --> 00:10:49,670
taking our input because we did

196
00:10:44,720 --> 00:10:52,790
something<font color="#E5E5E5"> wrong stuff like this still in</font>

197
00:10:49,670 --> 00:10:55,160
<font color="#CCCCCC">9 square see all devices</font><font color="#E5E5E5"> have an address</font>

198
00:10:52,790 --> 00:10:58,430
<font color="#E5E5E5">because it's a bus it's pretty much like</font>

199
00:10:55,160 --> 00:11:00,290
<font color="#E5E5E5">on a network every device on a network</font>

200
00:10:58,430 --> 00:11:04,010
has<font color="#E5E5E5"> an actress it's the same for I</font>

201
00:11:00,290 --> 00:11:10,219
square C by default<font color="#CCCCCC"> it's the address is</font>

202
00:11:04,010 --> 00:11:13,370
on<font color="#CCCCCC"> 7 bits so</font><font color="#E5E5E5"> you have to when you send a</font>

203
00:11:10,220 --> 00:11:15,080
communication you<font color="#CCCCCC"> have as</font><font color="#E5E5E5"> the master you</font>

204
00:11:13,370 --> 00:11:17,090
<font color="#CCCCCC">have to send what is called a start bit</font>

205
00:11:15,080 --> 00:11:18,980
it's basically it's a<font color="#CCCCCC"> way for the master</font>

206
00:11:17,090 --> 00:11:23,330
to<font color="#CCCCCC"> say ok we'll</font><font color="#E5E5E5"> start a new transaction</font>

207
00:11:18,980 --> 00:11:26,660
<font color="#CCCCCC">on the bus then you send the address if</font>

208
00:11:23,330 --> 00:11:30,250
a slave<font color="#E5E5E5"> is a at that specific address it</font>

209
00:11:26,660 --> 00:11:33,350
needs to acknowledge<font color="#E5E5E5"> that's</font><font color="#CCCCCC"> address and</font>

210
00:11:30,250 --> 00:11:36,200
once it's done<font color="#CCCCCC"> the</font><font color="#E5E5E5"> master needs to send</font>

211
00:11:33,350 --> 00:11:39,200
<font color="#E5E5E5">the comments so it will send clock</font>

212
00:11:36,200 --> 00:11:44,420
pulses and<font color="#CCCCCC"> the zeros the ones etc and</font>

213
00:11:39,200 --> 00:11:47,900
after<font color="#CCCCCC"> a after each eight bits the slave</font>

214
00:11:44,420 --> 00:11:50,329
needs to send an<font color="#E5E5E5"> acknowledge so you can</font>

215
00:11:47,900 --> 00:11:55,490
follow you can<font color="#E5E5E5"> basically follow the</font><font color="#CCCCCC"> the</font>

216
00:11:50,330 --> 00:11:58,550
communication using that specific way<font color="#CCCCCC"> so</font>

217
00:11:55,490 --> 00:12:01,100
as I said<font color="#E5E5E5"> there the master sends the</font>

218
00:11:58,550 --> 00:12:04,099
address<font color="#E5E5E5"> and there's an acknowledge sent</font>

219
00:12:01,100 --> 00:12:06,340
back by the slave<font color="#E5E5E5"> if some something is</font>

220
00:12:04,100 --> 00:12:08,840
responding<font color="#CCCCCC"> to</font><font color="#E5E5E5"> that specific address</font>

221
00:12:06,340 --> 00:12:11,810
since I actually didn't know<font color="#E5E5E5"> exactly</font>

222
00:12:08,840 --> 00:12:15,320
<font color="#E5E5E5">what was the</font><font color="#CCCCCC"> address</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> card on the</font>

223
00:12:11,810 --> 00:12:17,750
<font color="#CCCCCC">bus I just used basically the like a</font>

224
00:12:15,320 --> 00:12:19,430
<font color="#CCCCCC">port scan</font><font color="#E5E5E5"> you just</font><font color="#CCCCCC"> asked for every</font>

225
00:12:17,750 --> 00:12:21,860
<font color="#CCCCCC">address and if you receive an</font>

226
00:12:19,430 --> 00:12:25,359
acknowledge back that means<font color="#E5E5E5"> something is</font>

227
00:12:21,860 --> 00:12:28,010
actually<font color="#E5E5E5"> responding to that address</font>

228
00:12:25,360 --> 00:12:32,000
unfortunately on my test cards the<font color="#E5E5E5"> I</font>

229
00:12:28,010 --> 00:12:34,490
<font color="#E5E5E5">square C didn't give any results so that</font>

230
00:12:32,000 --> 00:12:36,110
means the<font color="#CCCCCC"> samples is actually not</font>

231
00:12:34,490 --> 00:12:37,670
working<font color="#E5E5E5"> I was like I was a bit</font>

232
00:12:36,110 --> 00:12:40,810
disappointed<font color="#CCCCCC"> I didn't know exactly</font><font color="#E5E5E5"> what</font>

233
00:12:37,670 --> 00:12:43,760
<font color="#E5E5E5">to do so what I did was read</font><font color="#CCCCCC"> the</font>

234
00:12:40,810 --> 00:12:45,589
documentation again<font color="#E5E5E5"> and in the</font>

235
00:12:43,760 --> 00:12:48,080
documentation<font color="#E5E5E5"> it says</font><font color="#CCCCCC"> ok so all the</font>

236
00:12:45,590 --> 00:12:50,360
settings<font color="#E5E5E5"> are stored in a name from</font><font color="#CCCCCC"> there</font>

237
00:12:48,080 --> 00:12:53,570
<font color="#CCCCCC">any prom is basically just a small</font>

238
00:12:50,360 --> 00:12:55,370
memory<font color="#E5E5E5"> that is available to the card</font>

239
00:12:53,570 --> 00:12:59,930
all of the settings are<font color="#E5E5E5"> stored on that</font>

240
00:12:55,370 --> 00:13:02,450
<font color="#E5E5E5">specific chip which is there so I</font><font color="#CCCCCC"> used</font>

241
00:12:59,930 --> 00:13:08,180
the tool<font color="#E5E5E5"> to actually read everything</font>

242
00:13:02,450 --> 00:13:11,450
from that EEPROM<font color="#CCCCCC"> and again</font><font color="#E5E5E5"> you just need</font>

243
00:13:08,180 --> 00:13:13,400
<font color="#E5E5E5">to read the datasheet follow that and</font>

244
00:13:11,450 --> 00:13:15,560
you will<font color="#E5E5E5"> see that you need to change to</font>

245
00:13:13,400 --> 00:13:17,630
<font color="#CCCCCC">different</font><font color="#E5E5E5"> values which are documented</font>

246
00:13:15,560 --> 00:13:19,849
<font color="#CCCCCC">again by the code by the</font><font color="#E5E5E5"> vendor so</font>

247
00:13:17,630 --> 00:13:22,460
that's that's cool so<font color="#E5E5E5"> you need to</font><font color="#CCCCCC"> change</font>

248
00:13:19,850 --> 00:13:24,890
the<font color="#E5E5E5"> address there to set the the</font>

249
00:13:22,460 --> 00:13:26,810
<font color="#E5E5E5">management interface to enable that so</font>

250
00:13:24,890 --> 00:13:31,250
you need to change<font color="#E5E5E5"> that specific bits</font>

251
00:13:26,810 --> 00:13:33,770
from<font color="#CCCCCC"> 0 to 1</font><font color="#E5E5E5"> and on the on that path to</font>

252
00:13:31,250 --> 00:13:38,360
you need to<font color="#E5E5E5"> change that specific bit</font>

253
00:13:33,770 --> 00:13:41,870
from 0 to 1 so<font color="#CCCCCC"> once I read all the</font><font color="#E5E5E5"> data</font>

254
00:13:38,360 --> 00:13:44,510
from<font color="#E5E5E5"> the EEPROM</font><font color="#CCCCCC"> I change the bits flash</font>

255
00:13:41,870 --> 00:13:49,280
the the EEPROM again rebooted the the

256
00:13:44,510 --> 00:13:51,950
the the machine<font color="#CCCCCC"> here and I didn't have</font>

257
00:13:49,280 --> 00:13:55,430
any card<font color="#E5E5E5"> the card was was not</font><font color="#CCCCCC"> there I</font>

258
00:13:51,950 --> 00:13:59,030
didn't<font color="#E5E5E5"> have any ETH something etc so ok</font>

259
00:13:55,430 --> 00:14:03,250
what the get<font color="#CCCCCC"> the</font><font color="#E5E5E5"> documentation back</font>

260
00:13:59,030 --> 00:14:07,250
and I forgot<font color="#CCCCCC"> to calculate the checksum</font>

261
00:14:03,250 --> 00:14:09,740
so back to<font color="#CCCCCC"> the</font><font color="#E5E5E5"> documentation you read so</font>

262
00:14:07,250 --> 00:14:12,650
the the checksum word is stored at<font color="#CCCCCC"> that</font>

263
00:14:09,740 --> 00:14:15,830
specific address on the EEPROM and<font color="#E5E5E5"> it's</font>

264
00:14:12,650 --> 00:14:20,510
it says that you need<font color="#CCCCCC"> that the checksum</font>

265
00:14:15,830 --> 00:14:24,290
the<font color="#E5E5E5"> the sum</font><font color="#CCCCCC"> of all the bytes</font><font color="#E5E5E5"> on the the</font>

266
00:14:20,510 --> 00:14:27,830
EEPROM needs to be equal<font color="#CCCCCC"> to BA BA that's</font>

267
00:14:24,290 --> 00:14:30,020
valued a specified directly so using

268
00:14:27,830 --> 00:14:34,550
<font color="#CCCCCC">just a bit of Python I just calculated</font>

269
00:14:30,020 --> 00:14:39,800
<font color="#E5E5E5">the new checksum</font><font color="#CCCCCC"> I changed it</font><font color="#E5E5E5"> on the on</font>

270
00:14:34,550 --> 00:14:43,160
the flash dump flash the<font color="#CCCCCC"> the dump on the</font>

271
00:14:39,800 --> 00:14:48,560
the EEPROM<font color="#E5E5E5"> again rebooted</font><font color="#CCCCCC"> the machine</font>

272
00:14:43,160 --> 00:14:51,339
and now if I use<font color="#CCCCCC"> the the</font><font color="#E5E5E5"> scanning on the</font>

273
00:14:48,560 --> 00:14:53,689
I<font color="#E5E5E5"> square</font><font color="#CCCCCC"> si bus I have access to</font>

274
00:14:51,340 --> 00:14:58,700
something<font color="#E5E5E5"> something responds to the</font>

275
00:14:53,690 --> 00:15:01,310
address<font color="#E5E5E5"> 3</font><font color="#CCCCCC"> X 4 9</font><font color="#E5E5E5"> that's great for the</font>

276
00:14:58,700 --> 00:15:02,300
<font color="#CCCCCC">next part of the of the talk the address</font>

277
00:15:01,310 --> 00:15:05,839
<font color="#E5E5E5">is still</font><font color="#CCCCCC"> 4 9</font>

278
00:15:02,300 --> 00:15:07,250
<font color="#CCCCCC">but since the address is</font><font color="#E5E5E5"> on</font><font color="#CCCCCC"> 7 bits</font><font color="#E5E5E5"> you</font>

279
00:15:05,840 --> 00:15:11,600
need to shift that

280
00:15:07,250 --> 00:15:17,199
one bit<font color="#E5E5E5"> which is why you will see 0x9</font><font color="#CCCCCC"> -</font>

281
00:15:11,600 --> 00:15:19,790
in all<font color="#E5E5E5"> the in all the subsequent slides</font>

282
00:15:17,199 --> 00:15:21,589
so that's good<font color="#CCCCCC"> we already spent a lot of</font>

283
00:15:19,790 --> 00:15:23,959
time reading the documentation we now

284
00:15:21,589 --> 00:15:27,850
have access<font color="#E5E5E5"> to</font><font color="#CCCCCC"> the I square C bus</font><font color="#E5E5E5"> so</font>

285
00:15:23,959 --> 00:15:32,119
what do we<font color="#E5E5E5"> do now we are starting</font><font color="#CCCCCC"> to</font>

286
00:15:27,850 --> 00:15:34,519
<font color="#E5E5E5">look at the data sheet again so if you</font>

287
00:15:32,120 --> 00:15:36,410
take<font color="#E5E5E5"> the data sheet you</font><font color="#CCCCCC"> see</font><font color="#E5E5E5"> a lot</font><font color="#CCCCCC"> of</font>

288
00:15:34,519 --> 00:15:39,800
different ways<font color="#CCCCCC"> to communicate with the</font>

289
00:15:36,410 --> 00:15:43,579
board<font color="#E5E5E5"> and the first</font><font color="#CCCCCC"> commands that you</font>

290
00:15:39,800 --> 00:15:47,359
can<font color="#CCCCCC"> see is</font><font color="#E5E5E5"> basically asked the network</font>

291
00:15:43,579 --> 00:15:51,138
card<font color="#E5E5E5"> to give you back</font><font color="#CCCCCC"> the MAC address</font><font color="#E5E5E5"> so</font>

292
00:15:47,360 --> 00:15:56,300
you have that<font color="#CCCCCC"> comment there that if you</font>

293
00:15:51,139 --> 00:16:02,720
<font color="#CCCCCC">do the same way that here I'll</font><font color="#E5E5E5"> show it</font>

294
00:15:56,300 --> 00:16:05,060
live<font color="#CCCCCC"> you see that here I'm sending</font>

295
00:16:02,720 --> 00:16:08,839
that's basically the comments I use on

296
00:16:05,060 --> 00:16:11,628
my device<font color="#E5E5E5"> to to access</font><font color="#CCCCCC"> the I</font><font color="#E5E5E5"> Square C</font>

297
00:16:08,839 --> 00:16:13,490
bus that commands is basically a nice

298
00:16:11,629 --> 00:16:18,319
<font color="#CCCCCC">quasi start to start a new transaction</font>

299
00:16:13,490 --> 00:16:20,240
<font color="#E5E5E5">you have the address of the NIC then the</font>

300
00:16:18,319 --> 00:16:23,449
comment<font color="#E5E5E5"> that</font><font color="#CCCCCC"> you need to send is</font><font color="#E5E5E5"> d4</font>

301
00:16:20,240 --> 00:16:25,970
<font color="#E5E5E5">which is in the documentation then you</font>

302
00:16:23,449 --> 00:16:31,219
need to tell the device<font color="#CCCCCC"> okay and now I</font>

303
00:16:25,970 --> 00:16:33,470
will start<font color="#CCCCCC"> to</font><font color="#E5E5E5"> read data from you which</font>

304
00:16:31,220 --> 00:16:35,899
device you want to<font color="#E5E5E5"> read it's always the</font>

305
00:16:33,470 --> 00:16:37,819
same<font color="#E5E5E5"> in the network card then I will</font>

306
00:16:35,899 --> 00:16:40,399
read the<font color="#CCCCCC"> first two bytes</font><font color="#E5E5E5"> because the</font>

307
00:16:37,819 --> 00:16:43,969
first byte is the number<font color="#CCCCCC"> of bytes that</font>

308
00:16:40,399 --> 00:16:47,470
<font color="#E5E5E5">will be sent by the card back</font><font color="#CCCCCC"> to us</font><font color="#E5E5E5"> the</font>

309
00:16:43,970 --> 00:16:50,600
<font color="#E5E5E5">next one is basically the the same ID</font>

310
00:16:47,470 --> 00:16:55,430
which means it's an answer to the

311
00:16:50,600 --> 00:16:59,089
requests number<font color="#E5E5E5"> 0</font><font color="#CCCCCC"> XD 4 and the next six</font>

312
00:16:55,430 --> 00:17:01,388
bytes<font color="#E5E5E5"> those ones here which are the same</font>

313
00:16:59,089 --> 00:17:01,389
as

314
00:17:08,589 --> 00:17:14,740
those six by<font color="#CCCCCC"> their so for the moment</font>

315
00:17:13,059 --> 00:17:18,759
<font color="#CCCCCC">everything looks</font><font color="#E5E5E5"> fine I'm able to</font>

316
00:17:14,740 --> 00:17:23,039
actually query<font color="#E5E5E5"> the card and get some</font>

317
00:17:18,759 --> 00:17:25,620
information<font color="#CCCCCC"> back</font><font color="#E5E5E5"> that's good</font><font color="#CCCCCC"> but that's</font>

318
00:17:23,039 --> 00:17:29,679
<font color="#E5E5E5">the basic stuff we know we now need to</font>

319
00:17:25,619 --> 00:17:31,629
be doing<font color="#CCCCCC"> more stuff</font><font color="#E5E5E5"> like this so again</font>

320
00:17:29,679 --> 00:17:34,330
<font color="#E5E5E5">reading the documentation you see that</font>

321
00:17:31,629 --> 00:17:36,879
there is<font color="#CCCCCC"> a comment which is Zurich c4</font>

322
00:17:34,330 --> 00:17:39,730
<font color="#E5E5E5">that's when you use that command</font><font color="#CCCCCC"> then</font>

323
00:17:36,879 --> 00:17:42,809
you need to send the size of a frame

324
00:17:39,730 --> 00:17:45,730
that<font color="#E5E5E5"> you</font><font color="#CCCCCC"> want to send</font><font color="#E5E5E5"> on the</font><font color="#CCCCCC"> network</font><font color="#E5E5E5"> and</font>

325
00:17:42,809 --> 00:17:48,460
then the full frame that you<font color="#CCCCCC"> want to</font>

326
00:17:45,730 --> 00:17:51,070
<font color="#E5E5E5">send directly on the network so that's</font>

327
00:17:48,460 --> 00:17:55,840
<font color="#E5E5E5">good if you if you are using that</font>

328
00:17:51,070 --> 00:17:58,658
<font color="#CCCCCC">command</font><font color="#E5E5E5"> so our implant can be can ask</font>

329
00:17:55,840 --> 00:18:02,559
the network card to send<font color="#E5E5E5"> something on</font>

330
00:17:58,659 --> 00:18:08,019
the<font color="#E5E5E5"> network which is good let's start</font>

331
00:18:02,559 --> 00:18:10,210
<font color="#E5E5E5">with a small</font><font color="#CCCCCC"> script it is there so</font>

332
00:18:08,019 --> 00:18:14,289
<font color="#E5E5E5">basically what it does is I'm using</font>

333
00:18:10,210 --> 00:18:15,999
Skippy here to generate<font color="#E5E5E5"> a frame so I'm</font>

334
00:18:14,289 --> 00:18:18,129
just using a dummy

335
00:18:15,999 --> 00:18:21,190
source MAC address<font color="#CCCCCC"> Jaime destination</font>

336
00:18:18,129 --> 00:18:25,509
address this is an IP packet<font color="#E5E5E5"> so I'm</font>

337
00:18:21,190 --> 00:18:27,730
using the IPS for<font color="#E5E5E5"> dream the demo and it</font>

338
00:18:25,509 --> 00:18:31,090
will be an ICMP<font color="#E5E5E5"> packets so it will be a</font>

339
00:18:27,730 --> 00:18:33,369
ping basically a ping and just to show

340
00:18:31,090 --> 00:18:38,709
<font color="#E5E5E5">you that it</font><font color="#CCCCCC"> works I will</font><font color="#E5E5E5"> add arrow black</font>

341
00:18:33,369 --> 00:18:44,908
helps<font color="#E5E5E5"> within the packets so here I</font>

342
00:18:38,710 --> 00:18:47,259
should<font color="#E5E5E5"> be there so this is my laptop</font>

343
00:18:44,909 --> 00:18:51,460
here<font color="#E5E5E5"> Here I am</font>

344
00:18:47,259 --> 00:18:52,029
<font color="#E5E5E5">on the implant machine you can</font><font color="#CCCCCC"> solve</font>

345
00:18:51,460 --> 00:18:53,950
sorry

346
00:18:52,029 --> 00:18:57,700
you can see that there it's the<font color="#CCCCCC"> implant</font>

347
00:18:53,950 --> 00:18:58,570
machine so if I send<font color="#E5E5E5"> that command it</font>

348
00:18:57,700 --> 00:19:03,090
<font color="#CCCCCC">sent</font><font color="#E5E5E5"> me okay</font>

349
00:18:58,570 --> 00:19:08,158
send<font color="#E5E5E5"> okay and if I see there</font><font color="#CCCCCC"> I received</font>

350
00:19:03,090 --> 00:19:08,158
the packet<font color="#CCCCCC"> that I sent that's good</font>

351
00:19:08,850 --> 00:19:16,560
what was really<font color="#CCCCCC"> interesting in that case</font>

352
00:19:12,240 --> 00:19:23,340
is that<font color="#CCCCCC"> if I do</font><font color="#E5E5E5"> a TCP dump on the</font>

353
00:19:16,560 --> 00:19:29,720
<font color="#CCCCCC">implanted machine here and if I repeat</font>

354
00:19:23,340 --> 00:19:29,720
the<font color="#CCCCCC"> same operation okay</font>

355
00:19:31,270 --> 00:19:34,349
[Music]

356
00:19:35,060 --> 00:19:41,970
<font color="#E5E5E5">okay that's it there you</font><font color="#CCCCCC"> see it's only</font>

357
00:19:38,490 --> 00:19:45,270
an echo<font color="#E5E5E5"> reply okay so basically</font><font color="#CCCCCC"> my</font>

358
00:19:41,970 --> 00:19:48,840
laptop there received the echo request

359
00:19:45,270 --> 00:19:51,810
sent the<font color="#CCCCCC"> equal reply but the</font><font color="#E5E5E5"> implant in</font>

360
00:19:48,840 --> 00:19:54,949
machine did only<font color="#E5E5E5"> see the equal reply and</font>

361
00:19:51,810 --> 00:19:58,440
not the packet<font color="#E5E5E5"> so that</font><font color="#CCCCCC"> means that that</font>

362
00:19:54,950 --> 00:20:01,500
<font color="#CCCCCC">machine</font><font color="#E5E5E5"> there just sent a packet on the</font>

363
00:19:58,440 --> 00:20:03,900
<font color="#E5E5E5">network but if your sis admin and you</font>

364
00:20:01,500 --> 00:20:05,760
are<font color="#CCCCCC"> looking</font><font color="#E5E5E5"> at the TCP dump so you are</font>

365
00:20:03,900 --> 00:20:08,070
<font color="#E5E5E5">looking at the other traffic you don't</font>

366
00:20:05,760 --> 00:20:13,850
see the traffic<font color="#CCCCCC"> that the network card</font>

367
00:20:08,070 --> 00:20:13,850
<font color="#E5E5E5">sends that means that you can actually</font>

368
00:20:13,880 --> 00:20:19,770
hide traffic you<font color="#E5E5E5"> can actually send</font>

369
00:20:17,400 --> 00:20:21,740
traffic<font color="#E5E5E5"> from</font><font color="#CCCCCC"> that host on the network</font>

370
00:20:19,770 --> 00:20:25,379
without<font color="#E5E5E5"> the host knowing it</font>

371
00:20:21,740 --> 00:20:27,180
so that's might be something good might

372
00:20:25,380 --> 00:20:29,430
be something good and it<font color="#CCCCCC"> really looks</font>

373
00:20:27,180 --> 00:20:36,570
like the thing<font color="#CCCCCC"> that was described</font><font color="#E5E5E5"> in</font><font color="#CCCCCC"> the</font>

374
00:20:29,430 --> 00:20:40,140
first<font color="#E5E5E5"> article so if we are still reading</font>

375
00:20:36,570 --> 00:20:44,189
<font color="#E5E5E5">the documentation we see that there</font><font color="#CCCCCC"> is a</font>

376
00:20:40,140 --> 00:20:47,160
way to the network to<font color="#E5E5E5"> actually get some</font>

377
00:20:44,190 --> 00:20:50,010
traffic<font color="#E5E5E5"> and send it</font><font color="#CCCCCC"> to the BMC</font><font color="#E5E5E5"> remember</font>

378
00:20:47,160 --> 00:20:52,410
the BMC<font color="#E5E5E5"> the stuff for the out-of-band</font>

379
00:20:50,010 --> 00:20:55,800
management<font color="#E5E5E5"> so again everything</font><font color="#CCCCCC"> is</font>

380
00:20:52,410 --> 00:20:58,770
documented<font color="#E5E5E5"> and there is a way to for the</font>

381
00:20:55,800 --> 00:21:01,320
<font color="#E5E5E5">the network card</font><font color="#CCCCCC"> to know if a specific</font>

382
00:20:58,770 --> 00:21:03,780
packets that comes from<font color="#E5E5E5"> the network if</font>

383
00:21:01,320 --> 00:21:05,669
it needs to<font color="#E5E5E5"> go to the host so basically</font>

384
00:21:03,780 --> 00:21:09,060
the operating system of the<font color="#E5E5E5"> machine or</font>

385
00:21:05,670 --> 00:21:11,730
if it<font color="#CCCCCC"> needs</font><font color="#E5E5E5"> to go</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> the BMC and how</font>

386
00:21:09,060 --> 00:21:14,340
<font color="#E5E5E5">this how does</font><font color="#CCCCCC"> it work</font><font color="#E5E5E5"> exactly</font><font color="#CCCCCC"> so you</font>

387
00:21:11,730 --> 00:21:18,890
have the<font color="#CCCCCC"> network there</font><font color="#E5E5E5"> the traffic comes</font>

388
00:21:14,340 --> 00:21:21,290
here<font color="#E5E5E5"> and here there's a way to</font><font color="#CCCCCC"> which you</font>

389
00:21:18,890 --> 00:21:25,550
select traffic that<font color="#E5E5E5"> will</font><font color="#CCCCCC"> need to</font><font color="#E5E5E5"> go to</font>

390
00:21:21,290 --> 00:21:28,250
the BMC so on our ice<font color="#CCCCCC"> course a bus</font><font color="#E5E5E5"> or if</font>

391
00:21:25,550 --> 00:21:30,860
the traffic needs to<font color="#E5E5E5"> go through the PCI</font>

392
00:21:28,250 --> 00:21:34,840
<font color="#CCCCCC">Express to the host and</font><font color="#E5E5E5"> the operating</font>

393
00:21:30,860 --> 00:21:37,840
system<font color="#E5E5E5"> basically on the TCP dump part</font>

394
00:21:34,840 --> 00:21:40,899
and how does<font color="#CCCCCC"> it</font><font color="#E5E5E5"> work</font><font color="#CCCCCC"> exactly</font>

395
00:21:37,840 --> 00:21:43,939
actually on those on that specific

396
00:21:40,900 --> 00:21:46,610
<font color="#E5E5E5">chipsets there are ways</font><font color="#CCCCCC"> to select</font>

397
00:21:43,940 --> 00:21:51,050
traffic from the source or destination

398
00:21:46,610 --> 00:21:53,780
<font color="#CCCCCC">TCP or UDP port from</font><font color="#E5E5E5"> the villain</font><font color="#CCCCCC"> that is</font>

399
00:21:51,050 --> 00:21:57,050
used<font color="#CCCCCC"> on</font><font color="#E5E5E5"> the packet from the source ipv4</font>

400
00:21:53,780 --> 00:21:59,300
or ipv6 from the source<font color="#E5E5E5"> MAC</font><font color="#CCCCCC"> etcetera</font><font color="#E5E5E5"> so</font>

401
00:21:57,050 --> 00:22:02,180
that<font color="#E5E5E5"> means that every</font><font color="#CCCCCC"> packet that</font><font color="#E5E5E5"> comes</font>

402
00:21:59,300 --> 00:22:06,350
to that specific network interface can

403
00:22:02,180 --> 00:22:08,990
<font color="#CCCCCC">be filtered using those and if the if</font>

404
00:22:06,350 --> 00:22:11,719
one of the packet matches<font color="#E5E5E5"> the filters it</font>

405
00:22:08,990 --> 00:22:14,390
will be sent to<font color="#CCCCCC"> the assemblies</font><font color="#E5E5E5"> and not</font>

406
00:22:11,720 --> 00:22:17,240
on the PCI Express<font color="#CCCCCC"> so basically you can</font>

407
00:22:14,390 --> 00:22:19,490
<font color="#E5E5E5">make some traffic disappear from the</font>

408
00:22:17,240 --> 00:22:22,910
network and the the operating system

409
00:22:19,490 --> 00:22:24,920
will not see<font color="#E5E5E5"> that good thing is you have</font>

410
00:22:22,910 --> 00:22:27,260
actually seven different<font color="#E5E5E5"> filters</font>

411
00:22:24,920 --> 00:22:30,050
available<font color="#CCCCCC"> so you can you can create</font>

412
00:22:27,260 --> 00:22:33,560
<font color="#CCCCCC">filters for a specific</font><font color="#E5E5E5"> port or a</font>

413
00:22:30,050 --> 00:22:36,649
specific<font color="#E5E5E5"> source IP etc and all those</font>

414
00:22:33,560 --> 00:22:40,700
filters<font color="#E5E5E5"> are directly in the network card</font>

415
00:22:36,650 --> 00:22:43,220
<font color="#CCCCCC">and</font><font color="#E5E5E5"> there's no way for the</font><font color="#CCCCCC"> card</font><font color="#E5E5E5"> for the</font>

416
00:22:40,700 --> 00:22:45,710
<font color="#E5E5E5">host to know which traffic goes where</font>

417
00:22:43,220 --> 00:22:47,180
because the host<font color="#E5E5E5"> actually doesn't see</font>

418
00:22:45,710 --> 00:22:51,020
the traffic<font color="#E5E5E5"> that is matched by the</font>

419
00:22:47,180 --> 00:22:53,480
filters so if you want<font color="#E5E5E5"> to do exactly</font>

420
00:22:51,020 --> 00:22:55,510
that<font color="#E5E5E5"> in practice how do we do that first</font>

421
00:22:53,480 --> 00:22:59,390
of all we again look at the data sheet

422
00:22:55,510 --> 00:23:01,910
<font color="#CCCCCC">and if you look at the</font><font color="#E5E5E5"> data sheet a long</font>

423
00:22:59,390 --> 00:23:04,100
time you understand that you need<font color="#CCCCCC"> to</font>

424
00:23:01,910 --> 00:23:07,190
<font color="#CCCCCC">create a filter using a specific</font>

425
00:23:04,100 --> 00:23:09,590
<font color="#E5E5E5">register there and you need to use that</font>

426
00:23:07,190 --> 00:23:12,080
specific<font color="#CCCCCC"> command which is your</font><font color="#E5E5E5"> X C C</font>

427
00:23:09,590 --> 00:23:14,169
with the<font color="#E5E5E5"> specific parameters that are</font>

428
00:23:12,080 --> 00:23:18,020
<font color="#E5E5E5">defined in another page of the document</font>

429
00:23:14,170 --> 00:23:21,110
<font color="#E5E5E5">and</font><font color="#CCCCCC"> that specific pieces</font><font color="#E5E5E5"> I'll use tells</font>

430
00:23:18,020 --> 00:23:23,330
you<font color="#E5E5E5"> okay so to add the filters you</font><font color="#CCCCCC"> need</font>

431
00:23:21,110 --> 00:23:25,939
to set<font color="#E5E5E5"> those specific bits at those</font>

432
00:23:23,330 --> 00:23:29,120
specific<font color="#CCCCCC"> addresses using</font><font color="#E5E5E5"> that specific I</font>

433
00:23:25,940 --> 00:23:32,550
<font color="#E5E5E5">square C commands</font><font color="#CCCCCC"> blah</font><font color="#E5E5E5"> blah blah</font>

434
00:23:29,120 --> 00:23:37,260
to simplify<font color="#E5E5E5"> that this is the command to</font>

435
00:23:32,550 --> 00:23:39,990
actually set a filter<font color="#E5E5E5"> on the on to a</font>

436
00:23:37,260 --> 00:23:44,820
predefined ports that are the common pot

437
00:23:39,990 --> 00:23:47,250
for<font color="#CCCCCC"> IPMI so if you send that</font><font color="#E5E5E5"> command</font><font color="#CCCCCC"> if</font>

438
00:23:44,820 --> 00:23:50,129
you think<font color="#E5E5E5"> that it's the</font><font color="#CCCCCC"> start bit then</font>

439
00:23:47,250 --> 00:23:52,800
the<font color="#E5E5E5"> address then</font><font color="#CCCCCC"> the comment to updates</font>

440
00:23:50,130 --> 00:23:55,070
the filters then the number of<font color="#E5E5E5"> bytes we</font>

441
00:23:52,800 --> 00:24:00,030
will send to<font color="#CCCCCC"> the card for</font><font color="#E5E5E5"> it to process</font>

442
00:23:55,070 --> 00:24:04,020
<font color="#E5E5E5">then number 61 is to update the filter</font>

443
00:24:00,030 --> 00:24:06,870
register and then there<font color="#E5E5E5"> are four bytes</font>

444
00:24:04,020 --> 00:24:10,590
for<font color="#CCCCCC"> the</font><font color="#E5E5E5"> filter register the value is 0 0</font>

445
00:24:06,870 --> 00:24:13,560
0 0 0 0<font color="#E5E5E5"> 0 which means</font><font color="#CCCCCC"> that only 2 bits</font>

446
00:24:10,590 --> 00:24:15,689
are set and those<font color="#E5E5E5"> 2 bits if you read the</font>

447
00:24:13,560 --> 00:24:18,030
data<font color="#CCCCCC"> sheets</font><font color="#E5E5E5"> you will see that that</font>

448
00:24:15,690 --> 00:24:22,500
creates a filter<font color="#E5E5E5"> for specific for two</font>

449
00:24:18,030 --> 00:24:25,080
<font color="#CCCCCC">specific ports which are those 2</font><font color="#E5E5E5"> so if</font>

450
00:24:22,500 --> 00:24:28,700
you set that<font color="#CCCCCC"> up you are</font><font color="#E5E5E5"> able to actually</font>

451
00:24:25,080 --> 00:24:31,980
create<font color="#CCCCCC"> a</font><font color="#E5E5E5"> filter that's good I tested it</font>

452
00:24:28,700 --> 00:24:34,560
but it's<font color="#E5E5E5"> not the</font><font color="#CCCCCC"> only thing you</font><font color="#E5E5E5"> need to</font>

453
00:24:31,980 --> 00:24:36,390
<font color="#E5E5E5">do because you just created the filter</font>

454
00:24:34,560 --> 00:24:39,060
but you didn't<font color="#E5E5E5"> tell the card that it</font>

455
00:24:36,390 --> 00:24:41,880
needs<font color="#E5E5E5"> to use those filters to actually</font>

456
00:24:39,060 --> 00:24:43,830
<font color="#E5E5E5">process them so you also need to read</font>

457
00:24:41,880 --> 00:24:45,600
again<font color="#E5E5E5"> the documentation to see that</font>

458
00:24:43,830 --> 00:24:48,149
there is<font color="#E5E5E5"> another comment which is</font><font color="#CCCCCC"> called</font>

459
00:24:45,600 --> 00:24:50,340
legacy receive enable which is that

460
00:24:48,150 --> 00:24:54,630
<font color="#E5E5E5">specific bytes so you need to create</font>

461
00:24:50,340 --> 00:24:57,149
<font color="#CCCCCC">that specific</font><font color="#E5E5E5"> command again and you need</font>

462
00:24:54,630 --> 00:24:59,580
<font color="#E5E5E5">to pass it a parameter with those</font>

463
00:24:57,150 --> 00:25:01,860
specific<font color="#E5E5E5"> bits that are set some of them</font>

464
00:24:59,580 --> 00:25:05,520
needs<font color="#E5E5E5"> to be at</font><font color="#CCCCCC"> 1 otherwise</font><font color="#E5E5E5"> the card will</font>

465
00:25:01,860 --> 00:25:07,949
will just return<font color="#CCCCCC"> on error and you need</font>

466
00:25:05,520 --> 00:25:10,650
to add that bit specifically and that

467
00:25:07,950 --> 00:25:13,380
<font color="#CCCCCC">bit specifically to make the card</font>

468
00:25:10,650 --> 00:25:17,400
<font color="#CCCCCC">actually process your filters that</font><font color="#E5E5E5"> you</font>

469
00:25:13,380 --> 00:25:19,680
that you created so again the<font color="#E5E5E5"> comment is</font>

470
00:25:17,400 --> 00:25:22,290
there that's good but you<font color="#E5E5E5"> need to know</font>

471
00:25:19,680 --> 00:25:27,120
<font color="#CCCCCC">exactly how to read the packet from the</font>

472
00:25:22,290 --> 00:25:30,420
<font color="#E5E5E5">neck and on that specific NICs you have</font>

473
00:25:27,120 --> 00:25:34,379
actually four<font color="#CCCCCC"> different ways to read</font><font color="#E5E5E5"> the</font>

474
00:25:30,420 --> 00:25:35,850
frames<font color="#E5E5E5"> the first one is what what is</font>

475
00:25:34,380 --> 00:25:39,630
called the<font color="#CCCCCC"> Assembly's alert that's</font>

476
00:25:35,850 --> 00:25:42,639
basically there<font color="#CCCCCC"> is a third signal that</font>

477
00:25:39,630 --> 00:25:46,710
goes from 1<font color="#CCCCCC"> to 0 each time</font>

478
00:25:42,640 --> 00:25:50,010
<font color="#CCCCCC">is</font><font color="#E5E5E5"> available for our implants to read</font>

479
00:25:46,710 --> 00:25:52,990
another way is that the card actually

480
00:25:50,010 --> 00:25:56,230
<font color="#E5E5E5">starts to send by itself the packets on</font>

481
00:25:52,990 --> 00:25:58,059
the the I<font color="#E5E5E5"> square</font><font color="#CCCCCC"> C bus that's another</font>

482
00:25:56,230 --> 00:26:01,540
possibility and there are two other one

483
00:25:58,059 --> 00:26:03,730
other<font color="#CCCCCC"> ones to make things simple</font><font color="#E5E5E5"> I only</font>

484
00:26:01,540 --> 00:26:06,370
use the<font color="#CCCCCC"> Assemblies a lot</font><font color="#E5E5E5"> so I'm still</font>

485
00:26:03,730 --> 00:26:09,010
driving<font color="#E5E5E5"> everything on the bus driving</font>

486
00:26:06,370 --> 00:26:11,949
<font color="#E5E5E5">the clock driving the data so I</font><font color="#CCCCCC"> can just</font>

487
00:26:09,010 --> 00:26:13,960
ask the<font color="#CCCCCC"> the network card okay so give me</font>

488
00:26:11,950 --> 00:26:19,660
a packet<font color="#CCCCCC"> if you have one if you don't</font>

489
00:26:13,960 --> 00:26:21,910
<font color="#E5E5E5">have just send me</font><font color="#CCCCCC"> dummy values so how do</font>

490
00:26:19,660 --> 00:26:25,419
we exactly read frames so now we have a

491
00:26:21,910 --> 00:26:28,840
filter<font color="#E5E5E5"> that</font><font color="#CCCCCC"> can process</font><font color="#E5E5E5"> packets so each</font>

492
00:26:25,419 --> 00:26:32,679
time a packet comes from the network to

493
00:26:28,840 --> 00:26:35,379
<font color="#E5E5E5">the card it will pass every filter that</font>

494
00:26:32,679 --> 00:26:39,070
we set and if each match is<font color="#CCCCCC"> a filter it</font>

495
00:26:35,380 --> 00:26:42,640
will be sent to<font color="#CCCCCC"> our implant</font><font color="#E5E5E5"> and not to</font>

496
00:26:39,070 --> 00:26:45,610
the host<font color="#E5E5E5"> but how do we exactly read</font>

497
00:26:42,640 --> 00:26:47,500
<font color="#E5E5E5">those packets actually if you read the</font>

498
00:26:45,610 --> 00:26:50,379
<font color="#CCCCCC">documentation again you</font><font color="#E5E5E5"> have</font><font color="#CCCCCC"> another</font>

499
00:26:47,500 --> 00:26:53,620
comment here<font color="#E5E5E5"> which is receive TCO</font>

500
00:26:50,380 --> 00:26:55,679
packets because<font color="#E5E5E5"> of course there's in</font>

501
00:26:53,620 --> 00:26:58,299
different<font color="#E5E5E5"> chapters</font><font color="#CCCCCC"> it's not the same</font>

502
00:26:55,679 --> 00:27:01,330
<font color="#CCCCCC">nomenclature</font><font color="#E5E5E5"> the same naming of the same</font>

503
00:26:58,299 --> 00:27:04,960
functions that's good so you have the

504
00:27:01,330 --> 00:27:07,510
<font color="#CCCCCC">Zurich c0 command which when you send it</font>

505
00:27:04,960 --> 00:27:10,780
to the NIC it will reply with<font color="#E5E5E5"> the size</font>

506
00:27:07,510 --> 00:27:13,330
of the frame<font color="#E5E5E5"> and some</font><font color="#CCCCCC"> information about</font>

507
00:27:10,780 --> 00:27:19,389
that<font color="#E5E5E5"> frame and the bytes of the packets</font>

508
00:27:13,330 --> 00:27:22,389
<font color="#E5E5E5">that was received by the card so if we</font>

509
00:27:19,390 --> 00:27:28,809
<font color="#CCCCCC">are</font><font color="#E5E5E5"> doing</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> team of</font><font color="#CCCCCC"> their I will do</font>

510
00:27:22,390 --> 00:27:31,290
<font color="#CCCCCC">exactly what I told you</font><font color="#E5E5E5"> about so the</font>

511
00:27:28,809 --> 00:27:31,290
first one is

512
00:27:37,960 --> 00:27:41,029
[Music]

513
00:27:46,369 --> 00:28:07,889
something strange<font color="#E5E5E5"> here okay so what I</font>

514
00:28:05,249 --> 00:28:16,649
<font color="#E5E5E5">will do first is create a filter</font><font color="#CCCCCC"> a</font>

515
00:28:07,889 --> 00:28:20,039
specific<font color="#CCCCCC"> filter here so I sent the</font><font color="#E5E5E5"> by</font><font color="#CCCCCC"> -</font>

516
00:28:16,649 --> 00:28:22,619
<font color="#E5E5E5">to start a new transaction</font><font color="#CCCCCC"> then the</font>

517
00:28:20,039 --> 00:28:24,479
<font color="#E5E5E5">address of the card then update and</font>

518
00:28:22,619 --> 00:28:26,579
<font color="#CCCCCC">you've create a new filter</font>

519
00:28:24,479 --> 00:28:29,190
I will send four bytes<font color="#E5E5E5"> for</font><font color="#CCCCCC"> the</font>

520
00:28:26,579 --> 00:28:32,759
parameters<font color="#CCCCCC"> the first one is okay I will</font>

521
00:28:29,190 --> 00:28:35,459
<font color="#CCCCCC">create a new filter on a specific port</font>

522
00:28:32,759 --> 00:28:41,399
and the port<font color="#CCCCCC"> I will be filtering is</font>

523
00:28:35,459 --> 00:28:46,259
<font color="#E5E5E5">zorak's</font><font color="#CCCCCC"> a1 which is</font><font color="#E5E5E5"> 161 everybody knows</font>

524
00:28:41,399 --> 00:28:55,379
what is the the protocol with<font color="#CCCCCC"> the port</font>

525
00:28:46,259 --> 00:28:59,879
161 SNMP<font color="#CCCCCC"> true so then once I created the</font>

526
00:28:55,379 --> 00:29:03,089
filter now I will use<font color="#CCCCCC"> that filter on the</font>

527
00:28:59,879 --> 00:29:05,458
device so again the equipment is<font color="#CCCCCC"> a</font><font color="#E5E5E5"> CC</font>

528
00:29:03,089 --> 00:29:08,070
for all the filtering commands<font color="#CCCCCC"> then I</font>

529
00:29:05,459 --> 00:29:10,289
will<font color="#E5E5E5"> send</font><font color="#CCCCCC"> 6 bytes</font><font color="#E5E5E5"> tell the device that I</font>

530
00:29:08,070 --> 00:29:12,869
will use the filter<font color="#CCCCCC"> I just</font><font color="#E5E5E5"> created</font>

531
00:29:10,289 --> 00:29:15,899
before<font color="#E5E5E5"> so I need to set that specific</font>

532
00:29:12,869 --> 00:29:18,418
bit here in the register for the card<font color="#CCCCCC"> to</font>

533
00:29:15,899 --> 00:29:22,379
know that I need I<font color="#E5E5E5"> want to process that</font>

534
00:29:18,419 --> 00:29:25,820
specific port and you<font color="#E5E5E5"> can also see that</font>

535
00:29:22,379 --> 00:29:28,139
<font color="#E5E5E5">every time I send a byte I receive an</font>

536
00:29:25,820 --> 00:29:29,820
<font color="#CCCCCC">acknowledgment from</font><font color="#E5E5E5"> the network card</font>

537
00:29:28,139 --> 00:29:34,978
<font color="#E5E5E5">that means that all my comments</font><font color="#CCCCCC"> are</font>

538
00:29:29,820 --> 00:29:38,458
<font color="#E5E5E5">processed are processed correctly now</font>

539
00:29:34,979 --> 00:29:45,140
what I need<font color="#E5E5E5"> to</font><font color="#CCCCCC"> do is enable the</font>

540
00:29:38,459 --> 00:29:52,740
<font color="#E5E5E5">filtering stuff there</font>

541
00:29:45,140 --> 00:29:55,350
and if everything works<font color="#E5E5E5"> correctly</font><font color="#CCCCCC"> that</font>

542
00:29:52,740 --> 00:29:57,870
would mean<font color="#CCCCCC"> that if I ask the card to</font>

543
00:29:55,350 --> 00:30:01,169
read some packets<font color="#E5E5E5"> I don't see anything</font>

544
00:29:57,870 --> 00:30:34,139
for<font color="#E5E5E5"> the moment that's good and if I do</font>

545
00:30:01,170 --> 00:30:39,690
an SNMP don't see anything<font color="#CCCCCC"> which I don't</font>

546
00:30:34,140 --> 00:30:48,870
<font color="#CCCCCC">get anything</font><font color="#E5E5E5"> else from of course</font><font color="#CCCCCC"> demo</font>

547
00:30:39,690 --> 00:30:51,260
effects thank you what<font color="#E5E5E5"> doesn't work</font>

548
00:30:48,870 --> 00:30:51,260
<font color="#E5E5E5">exactly</font>

549
00:31:08,770 --> 00:31:28,549
enjoy me one more time okay so of course

550
00:31:25,010 --> 00:31:31,879
<font color="#CCCCCC">do you affect</font><font color="#E5E5E5"> thank you sorry about this</font>

551
00:31:28,549 --> 00:31:35,929
<font color="#E5E5E5">so basically what should have appeared</font>

552
00:31:31,880 --> 00:31:40,010
on<font color="#CCCCCC"> the screen</font><font color="#E5E5E5"> was that I'm sending SNMP</font>

553
00:31:35,929 --> 00:31:44,720
requests to the implanted hosts the

554
00:31:40,010 --> 00:31:46,460
<font color="#CCCCCC">hosts</font><font color="#E5E5E5"> should show me the implant should</font>

555
00:31:44,720 --> 00:31:49,970
<font color="#E5E5E5">show me the packets that was received</font>

556
00:31:46,460 --> 00:31:54,340
and if I do a TCP dump on the host<font color="#E5E5E5"> I</font>

557
00:31:49,970 --> 00:32:00,679
won't see any SNMP traffic<font color="#E5E5E5"> coming in</font>

558
00:31:54,340 --> 00:32:01,730
<font color="#E5E5E5">okay so I'm able now to actually select</font>

559
00:32:00,679 --> 00:32:05,240
which traffic

560
00:32:01,730 --> 00:32:08,419
I want the<font color="#E5E5E5"> host to see and which traffic</font>

561
00:32:05,240 --> 00:32:09,700
<font color="#CCCCCC">I just want to keep for my implants and</font>

562
00:32:08,419 --> 00:32:13,370
nothing more

563
00:32:09,700 --> 00:32:15,770
so this is cool<font color="#E5E5E5"> yeah in that case we can</font>

564
00:32:13,370 --> 00:32:17,959
create a really<font color="#CCCCCC"> good covered</font><font color="#E5E5E5"> channel</font>

565
00:32:15,770 --> 00:32:20,539
because basically<font color="#E5E5E5"> we just</font><font color="#CCCCCC"> make some</font>

566
00:32:17,960 --> 00:32:24,020
traffic disappear so now we can receive

567
00:32:20,539 --> 00:32:26,390
packets for as an implant we can receive

568
00:32:24,020 --> 00:32:30,370
some packets process them<font color="#E5E5E5"> and send</font>

569
00:32:26,390 --> 00:32:32,630
responses back to our CNC for example

570
00:32:30,370 --> 00:32:35,539
<font color="#E5E5E5">the other thing that is</font><font color="#CCCCCC"> cool is that you</font>

571
00:32:32,630 --> 00:32:39,140
<font color="#CCCCCC">can</font><font color="#E5E5E5"> actually remove traffic so if you</font>

572
00:32:35,539 --> 00:32:41,360
are a sysadmin<font color="#E5E5E5"> and use</font><font color="#CCCCCC"> us</font><font color="#E5E5E5"> the networking</font>

573
00:32:39,140 --> 00:32:43,190
team<font color="#CCCCCC"> I don't see any traffic</font><font color="#E5E5E5"> coming in</font>

574
00:32:41,360 --> 00:32:45,500
the network team<font color="#E5E5E5"> will say you</font><font color="#CCCCCC"> okay but</font>

575
00:32:43,190 --> 00:32:47,720
on my switch I see<font color="#E5E5E5"> traffic going to</font><font color="#CCCCCC"> you</font>

576
00:32:45,500 --> 00:32:50,090
to your machine<font color="#CCCCCC"> and the</font><font color="#E5E5E5"> system will say</font>

577
00:32:47,720 --> 00:32:52,370
no<font color="#E5E5E5"> but I using TCP number I don't see</font>

578
00:32:50,090 --> 00:32:54,678
any<font color="#CCCCCC"> traffic what happens so</font><font color="#E5E5E5"> you can</font>

579
00:32:52,370 --> 00:33:00,049
<font color="#E5E5E5">really</font><font color="#CCCCCC"> drive a system in crazy using</font>

580
00:32:54,679 --> 00:33:02,240
this that could<font color="#E5E5E5"> be a fun thing to do but</font>

581
00:33:00,049 --> 00:33:04,279
there's more<font color="#E5E5E5"> to do that because just</font>

582
00:33:02,240 --> 00:33:07,669
making some traffic disappear is not

583
00:33:04,279 --> 00:33:08,030
really stealthy so I think<font color="#E5E5E5"> we can do</font>

584
00:33:07,669 --> 00:33:09,490
<font color="#E5E5E5">better</font>

585
00:33:08,030 --> 00:33:13,360
and again if you

586
00:33:09,490 --> 00:33:15,130
it<font color="#E5E5E5"> the datasheet again you see that</font>

587
00:33:13,360 --> 00:33:19,030
there is<font color="#E5E5E5"> another register which is</font>

588
00:33:15,130 --> 00:33:23,170
<font color="#E5E5E5">called</font><font color="#CCCCCC"> Mansi 2h and that specific</font>

589
00:33:19,030 --> 00:33:25,178
register is basically the register<font color="#E5E5E5"> that</font>

590
00:33:23,170 --> 00:33:27,970
<font color="#E5E5E5">tells okay so if there is traffic</font>

591
00:33:25,179 --> 00:33:31,809
matching<font color="#CCCCCC"> a specific filter</font><font color="#E5E5E5"> that we</font>

592
00:33:27,970 --> 00:33:34,240
created before<font color="#E5E5E5"> then if that filter is</font>

593
00:33:31,809 --> 00:33:37,030
matching<font color="#E5E5E5"> then you can send traffic both</font>

594
00:33:34,240 --> 00:33:40,179
on the assembles the square<font color="#CCCCCC"> see and on</font>

595
00:33:37,030 --> 00:33:42,220
the PCI Express<font color="#E5E5E5"> but so</font><font color="#CCCCCC"> basically what</font>

596
00:33:40,179 --> 00:33:43,840
just sniffing traffic coming<font color="#CCCCCC"> from the</font>

597
00:33:42,220 --> 00:33:47,530
host the host<font color="#E5E5E5"> is still seeing the</font>

598
00:33:43,840 --> 00:33:50,709
traffic and<font color="#E5E5E5"> but our implants is doing</font>

599
00:33:47,530 --> 00:33:54,360
the same<font color="#CCCCCC"> thing for</font><font color="#E5E5E5"> us so again the</font>

600
00:33:50,710 --> 00:33:57,160
comment to do this<font color="#E5E5E5"> is this one here and</font>

601
00:33:54,360 --> 00:34:01,120
<font color="#E5E5E5">you need to set a specific register</font>

602
00:33:57,160 --> 00:34:02,800
value that you<font color="#E5E5E5"> can understand by</font><font color="#CCCCCC"> reading</font>

603
00:34:01,120 --> 00:34:04,979
the documentation and you<font color="#E5E5E5"> need to set</font>

604
00:34:02,800 --> 00:34:08,379
<font color="#CCCCCC">the last bit because we set the first</font>

605
00:34:04,980 --> 00:34:12,490
filter<font color="#E5E5E5"> then this is the first bit that</font>

606
00:34:08,379 --> 00:34:15,429
says<font color="#CCCCCC"> that sets the first</font><font color="#E5E5E5"> filter and in</font>

607
00:34:12,489 --> 00:34:18,100
that case if<font color="#CCCCCC"> the demo was working again</font>

608
00:34:15,429 --> 00:34:21,429
I'm<font color="#E5E5E5"> sorry for this you should see</font><font color="#CCCCCC"> that</font>

609
00:34:18,100 --> 00:34:25,359
on the implants<font color="#E5E5E5"> we can receive the</font>

610
00:34:21,429 --> 00:34:28,720
traffic but on the from the network side

611
00:34:25,359 --> 00:34:31,179
<font color="#E5E5E5">you can actually see</font><font color="#CCCCCC"> the SNMP query and</font>

612
00:34:28,719 --> 00:34:33,939
you get the response<font color="#E5E5E5"> back so this is</font>

613
00:34:31,179 --> 00:34:37,600
great<font color="#E5E5E5"> there's a way to sniff traffic and</font>

614
00:34:33,940 --> 00:34:43,480
still making<font color="#CCCCCC"> the the</font><font color="#E5E5E5"> network work</font>

615
00:34:37,600 --> 00:34:45,520
correctly<font color="#E5E5E5"> which is good so using our</font>

616
00:34:43,480 --> 00:34:48,550
implants<font color="#E5E5E5"> now we are able</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> create a</font>

617
00:34:45,520 --> 00:34:50,379
<font color="#CCCCCC">covered channel</font><font color="#E5E5E5"> so traffic that so we</font>

618
00:34:48,550 --> 00:34:52,840
can receive and send traffic<font color="#CCCCCC"> that will</font>

619
00:34:50,379 --> 00:34:54,668
not be seen<font color="#CCCCCC"> by the hosts does the that</font>

620
00:34:52,840 --> 00:34:57,369
does not<font color="#CCCCCC"> mean that it will be</font><font color="#E5E5E5"> seen</font><font color="#CCCCCC"> by</font>

621
00:34:54,668 --> 00:34:57,940
<font color="#E5E5E5">the network so if you have an IDs or</font>

622
00:34:57,369 --> 00:34:59,950
something

623
00:34:57,940 --> 00:35:02,260
it will still be seen<font color="#E5E5E5"> because it's</font>

624
00:34:59,950 --> 00:35:05,049
physically on the<font color="#E5E5E5"> network but from the</font>

625
00:35:02,260 --> 00:35:08,350
implanted hosts<font color="#E5E5E5"> point of view the</font>

626
00:35:05,050 --> 00:35:10,720
<font color="#E5E5E5">traffic is never appeared</font><font color="#CCCCCC"> that's good we</font>

627
00:35:08,350 --> 00:35:12,819
are<font color="#E5E5E5"> also able to sniff traffic coming</font>

628
00:35:10,720 --> 00:35:16,180
<font color="#CCCCCC">from the network</font><font color="#E5E5E5"> which is good because</font>

629
00:35:12,820 --> 00:35:18,280
yeah<font color="#CCCCCC"> you normally have a lot</font><font color="#E5E5E5"> of secrets</font>

630
00:35:16,180 --> 00:35:20,950
<font color="#E5E5E5">traveling to the network especially</font><font color="#CCCCCC"> if</font>

631
00:35:18,280 --> 00:35:22,960
you have a trusted<font color="#CCCCCC"> network for for your</font>

632
00:35:20,950 --> 00:35:26,589
<font color="#CCCCCC">servers</font>

633
00:35:22,960 --> 00:35:28,569
and again as a<font color="#CCCCCC"> banished we can send send</font>

634
00:35:26,589 --> 00:35:31,750
<font color="#E5E5E5">any frame we want directly on the</font>

635
00:35:28,569 --> 00:35:35,079
<font color="#CCCCCC">networks in the previous Gmail I used</font>

636
00:35:31,750 --> 00:35:37,059
<font color="#E5E5E5">Scapa to create a correct packet but</font>

637
00:35:35,079 --> 00:35:38,920
basically if you<font color="#CCCCCC"> just send random bytes</font>

638
00:35:37,059 --> 00:35:43,690
<font color="#E5E5E5">the network</font><font color="#CCCCCC"> out would just send random</font>

639
00:35:38,920 --> 00:35:47,190
bytes on the network<font color="#E5E5E5"> which is good so</font>

640
00:35:43,690 --> 00:35:51,490
again I'm sorry<font color="#E5E5E5"> for</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> demos but that's</font>

641
00:35:47,190 --> 00:35:54,730
the end of the presentation in my

642
00:35:51,490 --> 00:35:58,229
conclusions<font color="#CCCCCC"> I would say that can it be</font>

643
00:35:54,730 --> 00:36:01,990
done so we've seen<font color="#E5E5E5"> that from the network</font>

644
00:35:58,230 --> 00:36:05,740
side from the network card<font color="#CCCCCC"> point of</font><font color="#E5E5E5"> view</font>

645
00:36:01,990 --> 00:36:07,990
<font color="#E5E5E5">yes it is possible</font><font color="#CCCCCC"> if you</font><font color="#E5E5E5"> take again if</font>

646
00:36:05,740 --> 00:36:10,029
you read the article the<font color="#E5E5E5"> the</font><font color="#CCCCCC"> article in</font>

647
00:36:07,990 --> 00:36:12,609
the first place it will tell you that it

648
00:36:10,030 --> 00:36:16,210
can also access<font color="#E5E5E5"> to the CPU the</font><font color="#CCCCCC"> RAM blah</font>

649
00:36:12,609 --> 00:36:18,520
blah blah<font color="#E5E5E5"> etc</font><font color="#CCCCCC"> to my knowledge there's no</font>

650
00:36:16,210 --> 00:36:21,520
way from the<font color="#E5E5E5"> for the assembles to access</font>

651
00:36:18,520 --> 00:36:23,650
the CPU or the<font color="#E5E5E5"> RAM of</font><font color="#CCCCCC"> a host</font><font color="#E5E5E5"> maybe I'm</font>

652
00:36:21,520 --> 00:36:26,530
wrong but from what I've seen<font color="#E5E5E5"> is</font><font color="#CCCCCC"> not</font>

653
00:36:23,650 --> 00:36:29,260
possible<font color="#CCCCCC"> thus in</font><font color="#E5E5E5"> some cases a way</font>

654
00:36:26,530 --> 00:36:32,859
further<font color="#E5E5E5"> for the assembles to access the</font>

655
00:36:29,260 --> 00:36:36,750
BIOS<font color="#E5E5E5"> or the</font><font color="#CCCCCC"> efi also on</font><font color="#E5E5E5"> some mondobot so</font>

656
00:36:32,859 --> 00:36:39,549
maybe there's a way using<font color="#E5E5E5"> the smbus to</font>

657
00:36:36,750 --> 00:36:44,920
actually do something<font color="#E5E5E5"> nasty directly on</font>

658
00:36:39,549 --> 00:36:47,910
the host<font color="#E5E5E5"> side again the</font><font color="#CCCCCC"> best way</font><font color="#E5E5E5"> for me</font>

659
00:36:44,920 --> 00:36:51,460
<font color="#CCCCCC">again that's for me</font><font color="#E5E5E5"> the best way to be</font>

660
00:36:47,910 --> 00:36:54,368
<font color="#E5E5E5">to to be able to</font><font color="#CCCCCC"> do everything</font><font color="#E5E5E5"> that was</font>

661
00:36:51,460 --> 00:36:57,849
<font color="#E5E5E5">written in the</font><font color="#CCCCCC"> article is to be in</font><font color="#E5E5E5"> that</font>

662
00:36:54,369 --> 00:36:59,799
<font color="#CCCCCC">specific place</font><font color="#E5E5E5"> because if you are at the</font>

663
00:36:57,849 --> 00:37:02,710
<font color="#E5E5E5">BMC side you have access to</font><font color="#CCCCCC"> the network</font>

664
00:36:59,799 --> 00:37:06,430
<font color="#CCCCCC">as we've seen</font><font color="#E5E5E5"> actually we didn't but</font>

665
00:37:02,710 --> 00:37:09,069
yeah<font color="#CCCCCC"> we think access</font><font color="#E5E5E5"> to the</font><font color="#CCCCCC"> network</font><font color="#E5E5E5"> and</font>

666
00:37:06,430 --> 00:37:12,190
<font color="#E5E5E5">you also have access to all the</font><font color="#CCCCCC"> other</font>

667
00:37:09,069 --> 00:37:15,549
buses<font color="#E5E5E5"> the LPC so you have access</font><font color="#CCCCCC"> to the</font>

668
00:37:12,190 --> 00:37:17,380
Southbridge and by that by<font color="#E5E5E5"> that way you</font>

669
00:37:15,549 --> 00:37:21,250
<font color="#E5E5E5">have access</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> all the peripherals of</font>

670
00:37:17,380 --> 00:37:24,549
the server<font color="#E5E5E5"> so if I would have to design</font>

671
00:37:21,250 --> 00:37:27,160
an implant I would<font color="#CCCCCC"> have placed</font><font color="#E5E5E5"> it there</font>

672
00:37:24,549 --> 00:37:30,130
<font color="#E5E5E5">the thing is that of course the BMC is a</font>

673
00:37:27,160 --> 00:37:34,049
rather big chip physically so it's<font color="#CCCCCC"> quite</font>

674
00:37:30,130 --> 00:37:36,910
obvious if it's there<font color="#E5E5E5"> the thing is that</font>

675
00:37:34,049 --> 00:37:40,640
on those

676
00:37:36,910 --> 00:37:43,310
sometimes you can also change the

677
00:37:40,640 --> 00:37:47,140
<font color="#CCCCCC">firmware on</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> under BMC's and maybe</font>

678
00:37:43,310 --> 00:37:50,869
place<font color="#CCCCCC"> some software that</font><font color="#E5E5E5"> can</font><font color="#CCCCCC"> be</font>

679
00:37:47,140 --> 00:37:55,790
malicious<font color="#E5E5E5"> this is something that could</font>

680
00:37:50,869 --> 00:37:58,670
<font color="#CCCCCC">be doable other thing is could it</font><font color="#E5E5E5"> be</font>

681
00:37:55,790 --> 00:38:02,779
hidden<font color="#E5E5E5"> directly on the motherboard</font><font color="#CCCCCC"> as</font>

682
00:37:58,670 --> 00:38:05,720
we've seen for that specific<font color="#CCCCCC"> thing when</font>

683
00:38:02,780 --> 00:38:10,160
<font color="#CCCCCC">your only two pins</font><font color="#E5E5E5"> so the plug and the</font>

684
00:38:05,720 --> 00:38:13,339
<font color="#CCCCCC">data plus the of course please</font><font color="#E5E5E5"> VC and VD</font>

685
00:38:10,160 --> 00:38:16,790
D which is<font color="#E5E5E5"> the the power source for our</font>

686
00:38:13,339 --> 00:38:18,740
implants if we want<font color="#E5E5E5"> to do this</font><font color="#CCCCCC"> the thing</font>

687
00:38:16,790 --> 00:38:21,410
is<font color="#E5E5E5"> that I</font><font color="#CCCCCC"> Square C is available on</font>

688
00:38:18,740 --> 00:38:25,819
nearly all microcontrollers available

689
00:38:21,410 --> 00:38:28,940
<font color="#E5E5E5">even the small</font><font color="#CCCCCC"> an example is the small</font>

690
00:38:25,820 --> 00:38:31,760
right tiny 85<font color="#E5E5E5"> if I give you an</font><font color="#CCCCCC"> example</font>

691
00:38:28,940 --> 00:38:36,440
this is<font color="#CCCCCC"> a microcontroller net tiny and</font>

692
00:38:31,760 --> 00:38:38,570
this<font color="#E5E5E5"> is a memory chip that</font><font color="#CCCCCC"> you can you</font>

693
00:38:36,440 --> 00:38:41,510
<font color="#E5E5E5">can see on some motherboards you've seen</font>

694
00:38:38,570 --> 00:38:44,900
one of<font color="#E5E5E5"> these one of these EEPROM on the</font>

695
00:38:41,510 --> 00:38:47,210
network card so if I replace<font color="#E5E5E5"> this one</font>

696
00:38:44,900 --> 00:38:47,960
<font color="#CCCCCC">with this one would you spot it</font><font color="#E5E5E5"> just by</font>

697
00:38:47,210 --> 00:38:50,869
<font color="#CCCCCC">looking at it</font>

698
00:38:47,960 --> 00:38:53,869
could<font color="#CCCCCC"> we get</font><font color="#E5E5E5"> difficult</font><font color="#CCCCCC"> you if you if you</font>

699
00:38:50,869 --> 00:38:55,460
read every chip<font color="#E5E5E5"> that's fine if you're</font>

700
00:38:53,869 --> 00:38:59,030
just<font color="#E5E5E5"> looking</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> one</font><font color="#CCCCCC"> of those have you</font>

701
00:38:55,460 --> 00:39:01,880
<font color="#E5E5E5">ever seen a motherboard how many chip</font>

702
00:38:59,030 --> 00:39:03,770
out there not easy but<font color="#E5E5E5"> again that's</font>

703
00:39:01,880 --> 00:39:05,690
that's the easiest way to do<font color="#CCCCCC"> this you</font>

704
00:39:03,770 --> 00:39:10,280
just<font color="#E5E5E5"> remove</font><font color="#CCCCCC"> that one place this one</font><font color="#E5E5E5"> and</font>

705
00:39:05,690 --> 00:39:15,560
create<font color="#CCCCCC"> a nice software tool to you use</font>

706
00:39:10,280 --> 00:39:18,710
an implant<font color="#E5E5E5"> do you have one of the</font>

707
00:39:15,560 --> 00:39:20,960
implant<font color="#E5E5E5"> are presented there actually in</font>

708
00:39:18,710 --> 00:39:24,319
your<font color="#E5E5E5"> motherboard</font><font color="#CCCCCC"> I would say no because</font>

709
00:39:20,960 --> 00:39:27,950
on<font color="#CCCCCC"> i-square see the bitrate</font><font color="#E5E5E5"> is hundred</font>

710
00:39:24,319 --> 00:39:31,040
kilobytes per second kilobits sorry per

711
00:39:27,950 --> 00:39:33,470
second<font color="#E5E5E5"> so if you have a gigabit</font><font color="#CCCCCC"> NIC it's</font>

712
00:39:31,040 --> 00:39:37,880
<font color="#E5E5E5">you know not able</font><font color="#CCCCCC"> to actually</font><font color="#E5E5E5"> sniff</font>

713
00:39:33,470 --> 00:39:41,660
<font color="#E5E5E5">everything and it's more</font><font color="#CCCCCC"> difficult there</font>

714
00:39:37,880 --> 00:39:44,329
is<font color="#CCCCCC"> also I just spoke about</font><font color="#E5E5E5"> smbus there</font>

715
00:39:41,660 --> 00:39:47,149
is another<font color="#E5E5E5"> available sideband interface</font>

716
00:39:44,329 --> 00:39:49,670
which<font color="#CCCCCC"> is called</font><font color="#E5E5E5"> NCS</font><font color="#CCCCCC"> IDE which uses a</font><font color="#E5E5E5"> lot</font>

717
00:39:47,150 --> 00:39:53,240
of<font color="#E5E5E5"> a lot</font><font color="#CCCCCC"> more signals</font>

718
00:39:49,670 --> 00:39:56,359
you don't have<font color="#E5E5E5"> just two two pins you</font>

719
00:39:53,240 --> 00:39:58,368
need to have<font color="#E5E5E5"> around ten something so</font>

720
00:39:56,359 --> 00:40:02,000
again if you have more pins you have

721
00:39:58,369 --> 00:40:04,099
more the chip is bigger and it's more

722
00:40:02,000 --> 00:40:06,440
<font color="#CCCCCC">difficult</font><font color="#E5E5E5"> to hide so there is a way to</font>

723
00:40:04,099 --> 00:40:09,770
sniff traffic at the gigabit<font color="#CCCCCC"> speed</font><font color="#E5E5E5"> using</font>

724
00:40:06,440 --> 00:40:15,890
<font color="#E5E5E5">that but the the implant will not be</font>

725
00:40:09,770 --> 00:40:16,579
that's that<font color="#E5E5E5"> stealthy as this is admin or</font>

726
00:40:15,890 --> 00:40:19,879
something

727
00:40:16,579 --> 00:40:22,819
is someone trolling you with with such

728
00:40:19,880 --> 00:40:26,569
<font color="#E5E5E5">implants unfortunately from the</font><font color="#CCCCCC"> host you</font>

729
00:40:22,819 --> 00:40:29,869
you are<font color="#E5E5E5"> not able to ask the</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> network</font>

730
00:40:26,569 --> 00:40:32,839
card<font color="#CCCCCC"> if some</font><font color="#E5E5E5"> of the registers as I</font>

731
00:40:29,869 --> 00:40:34,910
showed you<font color="#E5E5E5"> are set or not the only way</font>

732
00:40:32,839 --> 00:40:38,150
to do it<font color="#CCCCCC"> is actually to</font><font color="#E5E5E5"> be connected</font>

733
00:40:34,910 --> 00:40:43,730
directly<font color="#E5E5E5"> on the assembles and ask and</font>

734
00:40:38,150 --> 00:40:45,680
query<font color="#E5E5E5"> the card for the registers so all</font>

735
00:40:43,730 --> 00:40:48,140
those<font color="#CCCCCC"> settings are set</font><font color="#E5E5E5"> around at</font><font color="#CCCCCC"> runtime</font>

736
00:40:45,680 --> 00:40:51,618
<font color="#E5E5E5">so even if you are if you are rebooting</font>

737
00:40:48,140 --> 00:40:54,170
the your your machine<font color="#E5E5E5"> all the settings</font>

738
00:40:51,619 --> 00:40:58,490
will be at<font color="#E5E5E5"> zero so there will be no</font>

739
00:40:54,170 --> 00:41:01,849
filters<font color="#E5E5E5"> no duplicate traffic etc etc so</font>

740
00:40:58,490 --> 00:41:03,500
<font color="#E5E5E5">every time you reboot the machine if you</font>

741
00:41:01,849 --> 00:41:05,390
<font color="#CCCCCC">have an implant somewhere that the</font>

742
00:41:03,500 --> 00:41:10,970
implant needs to send<font color="#E5E5E5"> comments to the</font>

743
00:41:05,390 --> 00:41:13,940
card to actually have access<font color="#E5E5E5"> to</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> a</font>

744
00:41:10,970 --> 00:41:17,328
question one<font color="#CCCCCC"> of the question is has it</font>

745
00:41:13,940 --> 00:41:19,270
<font color="#E5E5E5">been done that way so is the other</font>

746
00:41:17,329 --> 00:41:23,390
<font color="#CCCCCC">motorboats from the article using the</font>

747
00:41:19,270 --> 00:41:26,390
<font color="#CCCCCC">same same thing the same</font><font color="#E5E5E5"> things I did I</font>

748
00:41:23,390 --> 00:41:28,819
don't<font color="#E5E5E5"> know maybe maybe not but that's</font>

749
00:41:26,390 --> 00:41:32,900
<font color="#E5E5E5">what</font><font color="#CCCCCC"> you that's the way to do what the</font>

750
00:41:28,819 --> 00:41:34,970
the article<font color="#E5E5E5"> was saying so again what</font>

751
00:41:32,900 --> 00:41:37,099
would<font color="#E5E5E5"> be a better option</font><font color="#CCCCCC"> than fiddling</font>

752
00:41:34,970 --> 00:41:40,759
with the<font color="#CCCCCC"> icrc bus placing a new chip</font>

753
00:41:37,099 --> 00:41:43,839
blah blah blah etc<font color="#E5E5E5"> good thing is that as</font>

754
00:41:40,760 --> 00:41:47,630
I said<font color="#E5E5E5"> the BMC is using a specific</font>

755
00:41:43,839 --> 00:41:50,990
<font color="#E5E5E5">software inside so you can just replace</font>

756
00:41:47,630 --> 00:41:55,940
<font color="#E5E5E5">the the software from</font><font color="#CCCCCC"> the BMC with a</font>

757
00:41:50,990 --> 00:41:59,450
Trojan<font color="#CCCCCC"> it--one from what I've seen by</font>

758
00:41:55,940 --> 00:42:01,150
<font color="#E5E5E5">looking at some articles on Google</font><font color="#CCCCCC"> um</font>

759
00:41:59,450 --> 00:42:03,549
<font color="#CCCCCC">some websites</font>

760
00:42:01,150 --> 00:42:06,099
<font color="#E5E5E5">since like some money</font><font color="#CCCCCC"> from</font><font color="#E5E5E5"> multiple</font>

761
00:42:03,549 --> 00:42:10,150
manufacturers<font color="#CCCCCC"> that</font><font color="#E5E5E5"> are using</font><font color="#CCCCCC"> BMC s for</font>

762
00:42:06,099 --> 00:42:12,849
<font color="#E5E5E5">IPM</font><font color="#CCCCCC"> I do not use encryption</font><font color="#E5E5E5"> for the</font>

763
00:42:10,150 --> 00:42:15,660
<font color="#CCCCCC">firmware do not validate</font><font color="#E5E5E5"> or checksum the</font>

764
00:42:12,849 --> 00:42:18,430
firmware<font color="#E5E5E5"> so people were actually able to</font>

765
00:42:15,660 --> 00:42:22,029
<font color="#CCCCCC">to change the</font><font color="#E5E5E5"> firmware flash it on the</font>

766
00:42:18,430 --> 00:42:25,118
BMC<font color="#E5E5E5"> and do some other stuff good thing</font>

767
00:42:22,029 --> 00:42:27,490
is if you have if<font color="#E5E5E5"> you are on the BMC</font>

768
00:42:25,119 --> 00:42:29,859
with your<font color="#CCCCCC"> trojan</font><font color="#E5E5E5"> as I said you</font><font color="#CCCCCC"> have</font>

769
00:42:27,490 --> 00:42:30,839
access<font color="#CCCCCC"> to the whole system not</font><font color="#E5E5E5"> only the</font>

770
00:42:29,859 --> 00:42:33,730
<font color="#CCCCCC">NIC</font>

771
00:42:30,839 --> 00:42:36,460
so if you if you will ask<font color="#E5E5E5"> me I</font><font color="#CCCCCC"> would</font><font color="#E5E5E5"> say</font>

772
00:42:33,730 --> 00:42:39,250
that's the<font color="#E5E5E5"> better way</font><font color="#CCCCCC"> so I</font><font color="#E5E5E5"> don't know if</font>

773
00:42:36,460 --> 00:42:41,440
you when you<font color="#E5E5E5"> are getting</font><font color="#CCCCCC"> a new hardware</font>

774
00:42:39,250 --> 00:42:43,539
a new server<font color="#CCCCCC"> etc if you</font><font color="#E5E5E5"> are actually</font>

775
00:42:41,440 --> 00:42:45,609
<font color="#E5E5E5">checking if all the firmware on</font><font color="#CCCCCC"> your</font>

776
00:42:43,539 --> 00:42:48,730
motherboard<font color="#CCCCCC"> are at the</font><font color="#E5E5E5"> correct version</font>

777
00:42:45,609 --> 00:42:51,670
<font color="#E5E5E5">or</font><font color="#CCCCCC"> if you are actually verifying stuff</font>

778
00:42:48,730 --> 00:42:55,569
maybe yes maybe no but<font color="#CCCCCC"> I would say most</font>

779
00:42:51,670 --> 00:42:57,609
of the<font color="#CCCCCC"> time no</font><font color="#E5E5E5"> and that's</font><font color="#CCCCCC"> it I'm</font><font color="#E5E5E5"> sorry</font>

780
00:42:55,569 --> 00:43:01,779
for the demo so if you have any

781
00:42:57,609 --> 00:43:02,509
questions feel free thank<font color="#E5E5E5"> you for great</font>

782
00:43:01,779 --> 00:43:05,629
presentation

783
00:43:02,510 --> 00:43:05,629
[Music]

784
00:43:09,700 --> 00:43:26,450
any question if you dump the<font color="#CCCCCC"> EPROM of</font>

785
00:43:23,269 --> 00:43:28,220
the of the<font color="#CCCCCC"> knick and</font><font color="#E5E5E5"> you find that smbus</font>

786
00:43:26,450 --> 00:43:30,519
is<font color="#CCCCCC"> 2 1 does it mean you have</font><font color="#E5E5E5"> been</font>

787
00:43:28,220 --> 00:43:34,669
compromised

788
00:43:30,519 --> 00:43:37,459
no not technically

789
00:43:34,670 --> 00:43:41,059
that just<font color="#E5E5E5"> means that there is</font><font color="#CCCCCC"> something</font>

790
00:43:37,460 --> 00:43:44,119
on the<font color="#E5E5E5"> motherboard</font><font color="#CCCCCC"> that is communicating</font>

791
00:43:41,059 --> 00:43:47,720
using assembles<font color="#E5E5E5"> you with the card most</font>

792
00:43:44,119 --> 00:43:50,210
of the time it<font color="#E5E5E5"> will</font><font color="#CCCCCC"> be the PNC as I said</font>

793
00:43:47,720 --> 00:43:52,759
the<font color="#CCCCCC"> PMC needs that that specific</font><font color="#E5E5E5"> access</font>

794
00:43:50,210 --> 00:43:56,539
to control the card<font color="#E5E5E5"> so that would</font><font color="#CCCCCC"> just</font>

795
00:43:52,759 --> 00:43:59,200
mean<font color="#E5E5E5"> that you have a</font><font color="#CCCCCC"> PMC and it is it's</font>

796
00:43:56,539 --> 00:44:03,079
it is able<font color="#CCCCCC"> to use</font><font color="#E5E5E5"> the network</font><font color="#CCCCCC"> card</font><font color="#E5E5E5"> to</font>

797
00:43:59,200 --> 00:44:08,419
use the out-of-band access so that<font color="#CCCCCC"> would</font>

798
00:44:03,079 --> 00:44:10,160
<font color="#CCCCCC">just mean</font><font color="#E5E5E5"> also that yeah it's the the</font>

799
00:44:08,420 --> 00:44:27,079
interface is enabled that<font color="#E5E5E5"> doesn't mean</font>

800
00:44:10,160 --> 00:44:30,529
it is used in your question thank you<font color="#E5E5E5"> do</font>

801
00:44:27,079 --> 00:44:33,019
you know of any<font color="#CCCCCC"> application using the</font>

802
00:44:30,529 --> 00:44:39,440
NIC filtering capability and what would

803
00:44:33,019 --> 00:44:43,328
be<font color="#CCCCCC"> your</font><font color="#E5E5E5"> take on why is it there actually</font>

804
00:44:39,440 --> 00:44:45,650
the the the first purpose of<font color="#CCCCCC"> that was to</font>

805
00:44:43,329 --> 00:44:50,029
<font color="#E5E5E5">actually use</font>

806
00:44:45,650 --> 00:44:53,170
what to actually<font color="#CCCCCC"> lower the cost of of</font>

807
00:44:50,029 --> 00:44:56,839
<font color="#E5E5E5">using an out-of-band management access</font>

808
00:44:53,170 --> 00:44:59,000
<font color="#CCCCCC">it was the</font><font color="#E5E5E5"> primary mean was to use the</font>

809
00:44:56,839 --> 00:45:00,589
same<font color="#CCCCCC"> network cable for both the</font>

810
00:44:59,000 --> 00:45:02,960
out-of-band access and the network

811
00:45:00,589 --> 00:45:05,839
access which might be<font color="#CCCCCC"> useful I</font><font color="#E5E5E5"> would say</font>

812
00:45:02,960 --> 00:45:08,180
no because most<font color="#E5E5E5"> of the time the good</font>

813
00:45:05,839 --> 00:45:11,359
practice is to<font color="#CCCCCC"> use</font><font color="#E5E5E5"> a separate switch or</font>

814
00:45:08,180 --> 00:45:13,279
separate VLAN blah blah blah<font color="#E5E5E5"> so it was</font>

815
00:45:11,359 --> 00:45:16,299
<font color="#E5E5E5">just for lowering</font><font color="#CCCCCC"> the cost for</font>

816
00:45:13,279 --> 00:45:19,789
operational purposes<font color="#CCCCCC"> that</font><font color="#E5E5E5"> was the main</font>

817
00:45:16,299 --> 00:45:22,250
the main usage for that<font color="#E5E5E5"> but again as you</font>

818
00:45:19,789 --> 00:45:25,190
as we've seen<font color="#E5E5E5"> there are there are</font>

819
00:45:22,250 --> 00:45:29,260
documented ways to to mess with that<font color="#CCCCCC"> and</font>

820
00:45:25,190 --> 00:45:29,260
use it<font color="#CCCCCC"> for maybe more</font><font color="#E5E5E5"> malicious purposes</font>

821
00:45:31,299 --> 00:45:42,200
<font color="#E5E5E5">last question is</font><font color="#CCCCCC"> there a way to access</font>

822
00:45:37,369 --> 00:45:44,569
<font color="#CCCCCC">to the rhythm from the PCIe report</font><font color="#E5E5E5"> not</font>

823
00:45:42,200 --> 00:45:48,169
<font color="#E5E5E5">on that specific card maybe on some</font>

824
00:45:44,569 --> 00:45:52,640
others there<font color="#E5E5E5"> are some some of the cards</font>

825
00:45:48,170 --> 00:45:57,650
<font color="#E5E5E5">I if I check the picture back now I</font>

826
00:45:52,640 --> 00:46:05,210
didn't show<font color="#CCCCCC"> that to you Matt maybe I</font>

827
00:45:57,650 --> 00:46:08,150
have image<font color="#E5E5E5"> okay there here you see that</font>

828
00:46:05,210 --> 00:46:11,599
this<font color="#E5E5E5"> is the EEPROM from there</font><font color="#CCCCCC"> and the</font>

829
00:46:08,150 --> 00:46:15,559
only wiring is directly to the chip<font color="#E5E5E5"> so</font>

830
00:46:11,599 --> 00:46:18,440
there's no way<font color="#E5E5E5"> to actually use that good</font>

831
00:46:15,559 --> 00:46:22,880
thing is<font color="#CCCCCC"> that</font><font color="#E5E5E5"> on</font><font color="#CCCCCC"> some</font><font color="#E5E5E5"> of the cards you</font>

832
00:46:18,440 --> 00:46:24,950
<font color="#E5E5E5">can</font><font color="#CCCCCC"> use a th2 on</font><font color="#E5E5E5"> on</font><font color="#CCCCCC"> linux</font><font color="#E5E5E5"> to actually</font>

833
00:46:22,880 --> 00:46:27,710
ask the card<font color="#E5E5E5"> for the EEPROM some of the</font>

834
00:46:24,950 --> 00:46:29,450
cards like<font color="#CCCCCC"> Intel ones actually allows</font>

835
00:46:27,710 --> 00:46:32,420
you to dump the EEPROM from there

836
00:46:29,450 --> 00:46:35,299
but that's not always the case another

837
00:46:32,420 --> 00:46:37,339
thing<font color="#E5E5E5"> that I didn't</font><font color="#CCCCCC"> mention is</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> as</font>

838
00:46:35,299 --> 00:46:41,359
we've seen<font color="#E5E5E5"> I spent a lot</font><font color="#CCCCCC"> of time routing</font>

839
00:46:37,339 --> 00:46:44,058
the traffic the wires to the<font color="#E5E5E5"> the headers</font>

840
00:46:41,359 --> 00:46:46,848
there but they<font color="#E5E5E5"> are also the</font><font color="#CCCCCC"> same the</font>

841
00:46:44,059 --> 00:46:50,299
same wires also<font color="#E5E5E5"> go down to the PCI</font>

842
00:46:46,849 --> 00:46:53,150
<font color="#CCCCCC">Express here so the SN bus is</font><font color="#E5E5E5"> actually</font>

843
00:46:50,299 --> 00:46:55,279
going out<font color="#CCCCCC"> there and I took the PCI</font>

844
00:46:53,150 --> 00:46:58,549
<font color="#CCCCCC">Express documentation and they are</font>

845
00:46:55,279 --> 00:46:59,000
<font color="#E5E5E5">actually two two pins in the PCI</font><font color="#CCCCCC"> Express</font>

846
00:46:58,549 --> 00:47:03,650
document

847
00:46:59,000 --> 00:47:04,580
<font color="#E5E5E5">that are used for the smbus so on that</font>

848
00:47:03,650 --> 00:47:09,470
card

849
00:47:04,580 --> 00:47:12,950
the this<font color="#E5E5E5"> the signal is cut somewhere</font>

850
00:47:09,470 --> 00:47:16,939
there but you should be able<font color="#CCCCCC"> to actually</font>

851
00:47:12,950 --> 00:47:19,700
<font color="#E5E5E5">why are they wire it to the PCI</font><font color="#CCCCCC"> Express</font>

852
00:47:16,940 --> 00:47:28,250
<font color="#E5E5E5">and access it from somewhere else</font><font color="#CCCCCC"> on</font><font color="#E5E5E5"> the</font>

853
00:47:19,700 --> 00:47:30,290
motherboard nice thank<font color="#E5E5E5"> you for the great</font>

854
00:47:28,250 --> 00:47:34,870
talk on<font color="#CCCCCC"> also thank you for all the</font><font color="#E5E5E5"> work</font>

855
00:47:30,290 --> 00:47:34,870
as organizer<font color="#E5E5E5"> of backups</font><font color="#CCCCCC"> thanks</font>

