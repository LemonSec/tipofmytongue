1
00:00:03,290 --> 00:00:09,150
okay yeah thanks for being here

2
00:00:06,029 --> 00:00:14,070
I will tell you new tales of wireless

3
00:00:09,150 --> 00:00:17,070
input devices well mostly because we did

4
00:00:14,070 --> 00:00:19,080
some research back in 2016 and this is

5
00:00:17,070 --> 00:00:24,300
an updated research on basically the

6
00:00:19,080 --> 00:00:27,240
same topic and as it was kind enough to

7
00:00:24,300 --> 00:00:30,599
introduce me I'm your close de Meyer I'm

8
00:00:27,240 --> 00:00:33,120
basically a pen tester analyzing

9
00:00:30,599 --> 00:00:34,980
products for security and as I'm in the

10
00:00:33,120 --> 00:00:36,629
hardware department I'm really

11
00:00:34,980 --> 00:00:39,239
interested in all the embedded stuff

12
00:00:36,630 --> 00:00:41,490
radio security and all that comes with

13
00:00:39,240 --> 00:00:43,920
it this is my dear colleague who cannot

14
00:00:41,490 --> 00:00:47,250
be with me here for today unfortunately

15
00:00:43,920 --> 00:00:50,760
but all these whenever I talk about we

16
00:00:47,250 --> 00:00:54,620
and this is a group effort so he was he

17
00:00:50,760 --> 00:00:58,199
did huge parts of the research with me

18
00:00:54,620 --> 00:01:00,239
so I want to tell you about a little bit

19
00:00:58,200 --> 00:01:02,280
of the introduction of and what we

20
00:01:00,240 --> 00:01:05,339
analyzed and what devices we use to

21
00:01:02,280 --> 00:01:08,609
analyze it and the previous work of

22
00:01:05,339 --> 00:01:11,070
other researchers who had a look into

23
00:01:08,609 --> 00:01:13,199
the same area and then I will give you

24
00:01:11,070 --> 00:01:17,579
an overview of our our research what we

25
00:01:13,200 --> 00:01:20,369
did the found security issues we we

26
00:01:17,579 --> 00:01:22,979
detected during the research I will try

27
00:01:20,369 --> 00:01:25,350
some live demos hopefully they work and

28
00:01:22,979 --> 00:01:27,810
some conclusions and recommendations if

29
00:01:25,350 --> 00:01:31,169
we have some time there two interesting

30
00:01:27,810 --> 00:01:33,030
anecdotes to tell holy short ones and at

31
00:01:31,170 --> 00:01:37,350
the end a Q&A session if you have any

32
00:01:33,030 --> 00:01:39,210
questions so let's get started and when

33
00:01:37,350 --> 00:01:41,639
I'm talking about wireless input devices

34
00:01:39,210 --> 00:01:44,130
I basically mean the things you can see

35
00:01:41,639 --> 00:01:46,949
on this slide so keyboards mice is the

36
00:01:44,130 --> 00:01:49,408
most common one but also the presenters

37
00:01:46,950 --> 00:01:52,229
like the keynote speaker used before me

38
00:01:49,409 --> 00:01:54,990
it's one you can talk more freely and

39
00:01:52,229 --> 00:01:57,899
use your clicker to switch to the next

40
00:01:54,990 --> 00:02:00,719
slide they're also considered wireless

41
00:01:57,899 --> 00:02:02,880
input devices and the devices we use for

42
00:02:00,719 --> 00:02:05,669
analyzing them and attacking them are

43
00:02:02,880 --> 00:02:07,560
basically software-defined radios or we

44
00:02:05,670 --> 00:02:11,640
use them for at least parts of our

45
00:02:07,560 --> 00:02:12,930
research like we have a hacker one for

46
00:02:11,640 --> 00:02:14,670
those who don't know software-defined

47
00:02:12,930 --> 00:02:17,550
radios this is just a

48
00:02:14,670 --> 00:02:19,470
Eric will use B device I can plug in and

49
00:02:17,550 --> 00:02:21,599
I can tell like the name says

50
00:02:19,470 --> 00:02:24,150
software-defined radio I can tell in

51
00:02:21,599 --> 00:02:27,269
software on my PC how this device should

52
00:02:24,150 --> 00:02:28,890
act only RF spectrum how it should

53
00:02:27,270 --> 00:02:31,170
decode signals how it should send

54
00:02:28,890 --> 00:02:34,619
signals there are other devices like the

55
00:02:31,170 --> 00:02:36,750
crazy radio this is just a really useful

56
00:02:34,620 --> 00:02:41,250
tool because there is a chip on it that

57
00:02:36,750 --> 00:02:43,980
is the same chip like in at least a lot

58
00:02:41,250 --> 00:02:47,160
of keyboards we analyzed so it's easier

59
00:02:43,980 --> 00:02:50,549
to use the same hardware like that is in

60
00:02:47,160 --> 00:02:52,049
the keyboard because all the decoding is

61
00:02:50,550 --> 00:02:54,780
already in the chip and you have to do

62
00:02:52,050 --> 00:02:57,180
that manually and you even can use the

63
00:02:54,780 --> 00:02:59,250
logitech unifying reciever because it

64
00:02:57,180 --> 00:03:03,209
has the same chip as well and it's free

65
00:02:59,250 --> 00:03:06,000
programmable over USB so previous work

66
00:03:03,209 --> 00:03:09,799
of other researchers the interesting

67
00:03:06,000 --> 00:03:12,420
ones are like the Hickory key project

68
00:03:09,799 --> 00:03:16,620
interesting in that case for example was

69
00:03:12,420 --> 00:03:19,140
the year it's 2010 so researching

70
00:03:16,620 --> 00:03:22,950
wireless input devices is really really

71
00:03:19,140 --> 00:03:26,339
old at that point like close to 10 years

72
00:03:22,950 --> 00:03:32,850
and we have Nova 2019 and their devices

73
00:03:26,340 --> 00:03:34,799
are still not really secure also to give

74
00:03:32,850 --> 00:03:36,600
you a quick overview so this involves

75
00:03:34,799 --> 00:03:38,850
the keyboard evolved the Hickory key

76
00:03:36,600 --> 00:03:42,840
project was like for keyboards sometimes

77
00:03:38,850 --> 00:03:47,100
working on the 27 megahertz nowadays

78
00:03:42,840 --> 00:03:49,040
it's all 2.4 gigahertz spectrum and when

79
00:03:47,100 --> 00:03:53,959
I talk mutates of wireless input devices

80
00:03:49,040 --> 00:03:56,608
in 2016 we published some research about

81
00:03:53,959 --> 00:04:00,780
secure keyboards well they weren't so

82
00:03:56,609 --> 00:04:03,510
secure there and this is the follow-up

83
00:04:00,780 --> 00:04:05,819
project to this and interesting enough

84
00:04:03,510 --> 00:04:09,269
mark newland maybe you know him from the

85
00:04:05,819 --> 00:04:11,819
mouse jack attack he did research in

86
00:04:09,269 --> 00:04:15,060
2019 as well on presentation clickers as

87
00:04:11,819 --> 00:04:17,039
well as we but on all the models so it's

88
00:04:15,060 --> 00:04:20,190
interesting to see the differences and

89
00:04:17,039 --> 00:04:21,120
Marcus Manx UMaine well saw his tweets

90
00:04:20,190 --> 00:04:23,760
or something

91
00:04:21,120 --> 00:04:28,320
he had a closer look at all the Logitech

92
00:04:23,760 --> 00:04:30,539
products so in this project we

93
00:04:28,320 --> 00:04:33,240
to answer the the open questions we had

94
00:04:30,540 --> 00:04:34,470
from our last project and we want to

95
00:04:33,240 --> 00:04:36,510
have a closer look and Wireless

96
00:04:34,470 --> 00:04:39,150
presenters because we didn't had a

97
00:04:36,510 --> 00:04:42,080
closer look there the first research

98
00:04:39,150 --> 00:04:46,859
project was about mice and keyboards

99
00:04:42,080 --> 00:04:48,719
just a recap from 2016 the the most

100
00:04:46,860 --> 00:04:51,630
important question we want to answer is

101
00:04:48,720 --> 00:04:54,330
D for the Fujitsu keyboard for the other

102
00:04:51,630 --> 00:04:56,550
keyboards v1 we're able to replay attack

103
00:04:54,330 --> 00:04:59,640
we can talk about this later what this

104
00:04:56,550 --> 00:05:01,440
implies but interesting enough there

105
00:04:59,640 --> 00:05:03,690
were keystroke injections on these

106
00:05:01,440 --> 00:05:06,300
keyboards so even though you don't know

107
00:05:03,690 --> 00:05:08,790
the key because this is all the

108
00:05:06,300 --> 00:05:10,980
keyboards market themselves as being

109
00:05:08,790 --> 00:05:12,780
secure and using AES encryption and

110
00:05:10,980 --> 00:05:15,870
although we don't know the key we were

111
00:05:12,780 --> 00:05:19,200
able to inject keys on the horse that is

112
00:05:15,870 --> 00:05:21,300
using the keyboard without knowing the

113
00:05:19,200 --> 00:05:23,070
actual key for most of the keyboard but

114
00:05:21,300 --> 00:05:25,320
if a jitsu keyboard used a different

115
00:05:23,070 --> 00:05:28,260
chip and we were not able to understand

116
00:05:25,320 --> 00:05:31,020
it back then and for a new research

117
00:05:28,260 --> 00:05:32,909
where that will work keyboards and a lot

118
00:05:31,020 --> 00:05:38,010
of more wireless presenters because we

119
00:05:32,910 --> 00:05:39,960
want to understand them as well so that

120
00:05:38,010 --> 00:05:41,880
we get a better understanding of what we

121
00:05:39,960 --> 00:05:44,099
do and there are basically three

122
00:05:41,880 --> 00:05:46,290
approaches to do this first one is the

123
00:05:44,100 --> 00:05:48,930
hardware analysis for such a researcher

124
00:05:46,290 --> 00:05:51,210
because we don't have internal data

125
00:05:48,930 --> 00:05:52,770
sheets on what they do so it's just

126
00:05:51,210 --> 00:05:55,049
buying the hardware on Amazon or

127
00:05:52,770 --> 00:05:57,120
something like this and what first step

128
00:05:55,050 --> 00:05:59,070
is hardware analysis opening up the

129
00:05:57,120 --> 00:06:01,350
keyboards the wireless presenters look

130
00:05:59,070 --> 00:06:03,930
at the PCBs look at the chips maybe

131
00:06:01,350 --> 00:06:05,490
there are markings on the chip if you're

132
00:06:03,930 --> 00:06:07,620
lucky you'll find the datasheet for the

133
00:06:05,490 --> 00:06:10,860
chip online you'll learn more about this

134
00:06:07,620 --> 00:06:13,530
what about the chips there and in some

135
00:06:10,860 --> 00:06:15,900
cases you can even sniff the

136
00:06:13,530 --> 00:06:19,619
communication on the PCB and learn more

137
00:06:15,900 --> 00:06:21,450
about the chips of course there's the

138
00:06:19,620 --> 00:06:24,120
radio based approach to analyze the

139
00:06:21,450 --> 00:06:26,610
device this is like I said before using

140
00:06:24,120 --> 00:06:28,590
the hack RF and software like no radio

141
00:06:26,610 --> 00:06:30,930
or in spectrum to understand what they

142
00:06:28,590 --> 00:06:33,330
are actually sending over the air or it

143
00:06:30,930 --> 00:06:36,660
can use crazy radio and the NRF research

144
00:06:33,330 --> 00:06:38,159
firmware for NF based keyboards or

145
00:06:36,660 --> 00:06:40,050
presenters or mises

146
00:06:38,160 --> 00:06:42,260
it makes it a lot easier because the

147
00:06:40,050 --> 00:06:46,530
decoding is already handled by touch

148
00:06:42,260 --> 00:06:49,170
and for the former analysis what's the

149
00:06:46,530 --> 00:06:52,289
third approach we didn't do that much in

150
00:06:49,170 --> 00:06:54,870
this project just because we didn't had

151
00:06:52,290 --> 00:06:57,240
the need to do it back in 2016 we

152
00:06:54,870 --> 00:06:59,430
actually did that and it worked well on

153
00:06:57,240 --> 00:07:01,230
most keyboards so most keyboards don't

154
00:06:59,430 --> 00:07:02,910
have the eve chips that are on there I'm

155
00:07:01,230 --> 00:07:04,380
not locked down so you can just connect

156
00:07:02,910 --> 00:07:07,350
some wires the chip readout it's

157
00:07:04,380 --> 00:07:09,390
remember and learn and understand how

158
00:07:07,350 --> 00:07:11,790
the keyboard is working and in most

159
00:07:09,390 --> 00:07:14,010
cases we were also able of course to

160
00:07:11,790 --> 00:07:16,290
extract the AES encryption keys and then

161
00:07:14,010 --> 00:07:18,270
you can decrypt the traffic or emulate

162
00:07:16,290 --> 00:07:21,140
your own keyboard so for the hardware

163
00:07:18,270 --> 00:07:24,000
analysis this is was a what a typical

164
00:07:21,140 --> 00:07:25,860
presenter might look like what you take

165
00:07:24,000 --> 00:07:27,600
a decent miss kit and most of the time

166
00:07:25,860 --> 00:07:29,790
that's why they work on all operating

167
00:07:27,600 --> 00:07:32,310
systems with most of the east of birth

168
00:07:29,790 --> 00:07:34,920
for presentation because the dongle

169
00:07:32,310 --> 00:07:36,600
adjust well emulates a USB keyboard and

170
00:07:34,920 --> 00:07:36,930
when you press next slide or previous

171
00:07:36,600 --> 00:07:39,060
slides

172
00:07:36,930 --> 00:07:41,730
it's in most case it is a page up and

173
00:07:39,060 --> 00:07:43,710
page down just what you're pressing so

174
00:07:41,730 --> 00:07:46,950
this is why no additional driver is

175
00:07:43,710 --> 00:07:49,739
needed for that and if you open the

176
00:07:46,950 --> 00:07:52,950
devices up you can see a lot of

177
00:07:49,740 --> 00:07:54,780
different well wisely the devices are

178
00:07:52,950 --> 00:07:57,800
designed and they come in different form

179
00:07:54,780 --> 00:08:00,750
factors as well so what you see here is

180
00:07:57,800 --> 00:08:02,820
this device here it's like a ring shape

181
00:08:00,750 --> 00:08:07,410
and I can use it my finger and can talk

182
00:08:02,820 --> 00:08:09,090
more freely really easy in this case you

183
00:08:07,410 --> 00:08:10,890
can maybe you can see it there chip

184
00:08:09,090 --> 00:08:13,679
markings on that you can search for the

185
00:08:10,890 --> 00:08:14,310
datasheet it might be easy completely

186
00:08:13,680 --> 00:08:16,770
different

187
00:08:14,310 --> 00:08:19,350
presenter completely different chip and

188
00:08:16,770 --> 00:08:20,940
so having different chips means you're

189
00:08:19,350 --> 00:08:22,380
basically starting the research again

190
00:08:20,940 --> 00:08:24,030
because of what the different chip or

191
00:08:22,380 --> 00:08:27,150
everything might be different for this

192
00:08:24,030 --> 00:08:29,969
presenter another presenter as well the

193
00:08:27,150 --> 00:08:32,130
friendship this one is even trickier as

194
00:08:29,970 --> 00:08:36,210
you can see the chips are covered in an

195
00:08:32,130 --> 00:08:38,039
epoxy and well you don't get any

196
00:08:36,210 --> 00:08:40,680
markings and you don't know what chip is

197
00:08:38,039 --> 00:08:43,740
underneath there for this chip we were

198
00:08:40,679 --> 00:08:46,530
actually able to guess what chip is

199
00:08:43,740 --> 00:08:48,600
under there because we saw that here

200
00:08:46,530 --> 00:08:51,449
some some small wires between those

201
00:08:48,600 --> 00:08:53,370
chips it's a two chip setup the first

202
00:08:51,450 --> 00:08:55,710
tip is the microcontroller with all the

203
00:08:53,370 --> 00:08:57,780
firmware for pressing the keys and

204
00:08:55,710 --> 00:08:59,760
stuff on there and these second ship is

205
00:08:57,780 --> 00:09:02,220
the transmitter the RF transmitter chip

206
00:08:59,760 --> 00:09:04,200
and if you sniff the communication in

207
00:09:02,220 --> 00:09:06,980
between you might learn how the chip

208
00:09:04,200 --> 00:09:10,590
underneath the epoxy is working

209
00:09:06,980 --> 00:09:13,020
same for the Fujitsu keyboard we had to

210
00:09:10,590 --> 00:09:15,750
look at its did the same approach

211
00:09:13,020 --> 00:09:21,780
because it was covered we try to read

212
00:09:15,750 --> 00:09:24,060
data with soldering wires on there so

213
00:09:21,780 --> 00:09:25,740
after the first research we could

214
00:09:24,060 --> 00:09:26,819
determine the chips that were in there

215
00:09:25,740 --> 00:09:30,930
and as you can see there are a lot of

216
00:09:26,820 --> 00:09:34,530
different chips and so there was a lot

217
00:09:30,930 --> 00:09:37,199
of work to do with them first of all you

218
00:09:34,530 --> 00:09:40,199
try to find the datasheet and in most

219
00:09:37,200 --> 00:09:42,420
cases actually we got lucky or the chips

220
00:09:40,200 --> 00:09:44,640
for the NF 24 the datasheet for the NF

221
00:09:42,420 --> 00:09:47,579
24 and for the cyprus chips they are

222
00:09:44,640 --> 00:09:48,960
freely online available and used in some

223
00:09:47,580 --> 00:09:52,410
of these products and you can learn a

224
00:09:48,960 --> 00:09:56,340
lot about these devices in some other

225
00:09:52,410 --> 00:09:58,469
cases like the bacon RF chip we got

226
00:09:56,340 --> 00:10:00,510
lucky as well it is completely different

227
00:09:58,470 --> 00:10:03,960
vendors but the chip is basically a

228
00:10:00,510 --> 00:10:06,360
clone of the NRF 24 chip so you can use

229
00:10:03,960 --> 00:10:10,230
a lot of the knowledge you again before

230
00:10:06,360 --> 00:10:12,950
- yeah and you can apply it to the back

231
00:10:10,230 --> 00:10:14,370
end chips and in some cases like the HS

232
00:10:12,950 --> 00:10:16,260
304 chips

233
00:10:14,370 --> 00:10:18,480
there was no datasheet online we don't

234
00:10:16,260 --> 00:10:20,750
know a mark newland reverse engineer

235
00:10:18,480 --> 00:10:23,370
part of the chips that helped us a lot

236
00:10:20,750 --> 00:10:25,770
but otherwise no public information

237
00:10:23,370 --> 00:10:28,890
available and for the radio based

238
00:10:25,770 --> 00:10:30,780
analysis there are two lie tools like

239
00:10:28,890 --> 00:10:32,850
the universal radio hacker for the

240
00:10:30,780 --> 00:10:34,890
software-defined radios this is a tool

241
00:10:32,850 --> 00:10:36,960
that really helps you getting started to

242
00:10:34,890 --> 00:10:39,569
understand the peg packets that are uh

243
00:10:36,960 --> 00:10:43,500
well somewhere out there and D on the

244
00:10:39,570 --> 00:10:45,810
air and you can easily decode them and

245
00:10:43,500 --> 00:10:48,690
you can actually use this tool as well

246
00:10:45,810 --> 00:10:51,119
to resend package to you recovered or

247
00:10:48,690 --> 00:10:54,990
craft your own package so this is really

248
00:10:51,120 --> 00:10:58,590
helpful but it's not that easy when I'm

249
00:10:54,990 --> 00:10:59,970
talking about Wireless analysis because

250
00:10:58,590 --> 00:11:03,000
there are a lot of challenges the first

251
00:10:59,970 --> 00:11:05,580
challenges and this is even one step is

252
00:11:03,000 --> 00:11:07,560
already done there and we have nothing

253
00:11:05,580 --> 00:11:08,430
so there's just some signals in the air

254
00:11:07,560 --> 00:11:10,650
so you

255
00:11:08,430 --> 00:11:12,449
need to guess I'll guess a lot of things

256
00:11:10,650 --> 00:11:14,730
or look at a lot of things like what

257
00:11:12,450 --> 00:11:16,530
frequency what modulation is it

258
00:11:14,730 --> 00:11:18,810
frequency amplitude shift keying or

259
00:11:16,530 --> 00:11:20,790
something like this this is a decoded

260
00:11:18,810 --> 00:11:24,689
signal you might well you can see a

261
00:11:20,790 --> 00:11:27,150
digital signal here but there's still a

262
00:11:24,690 --> 00:11:30,060
lot of to do we're guessing this are

263
00:11:27,150 --> 00:11:32,069
slow just ones and zeroes how do you get

264
00:11:30,060 --> 00:11:34,469
from these ones in series to eventually

265
00:11:32,070 --> 00:11:36,900
actually understand why a key a was

266
00:11:34,470 --> 00:11:40,380
pressed on the keyboard for example so

267
00:11:36,900 --> 00:11:42,510
the challenge ins are basically all this

268
00:11:40,380 --> 00:11:45,390
we need to understand these signal

269
00:11:42,510 --> 00:11:47,910
modulation the package format framing we

270
00:11:45,390 --> 00:11:50,430
need to understand where packet lengths

271
00:11:47,910 --> 00:11:53,160
fields are a byte or sometimes they're

272
00:11:50,430 --> 00:11:56,069
reversed if there are check sums how

273
00:11:53,160 --> 00:11:58,650
they check how the check sums works the

274
00:11:56,070 --> 00:12:00,090
the payload feel of course the most

275
00:11:58,650 --> 00:12:02,340
interesting we want to understand where

276
00:12:00,090 --> 00:12:06,930
is the actual key a or key B that was

277
00:12:02,340 --> 00:12:09,210
pressed on the keyboard and for some

278
00:12:06,930 --> 00:12:12,479
other challenges you need to have in

279
00:12:09,210 --> 00:12:14,760
mind is in the RF frequency hopping for

280
00:12:12,480 --> 00:12:16,260
example some of the devices do frequency

281
00:12:14,760 --> 00:12:18,300
hopping so they change rapidly the

282
00:12:16,260 --> 00:12:21,360
frequency and you have to follow them if

283
00:12:18,300 --> 00:12:24,420
you want to get the signal right or data

284
00:12:21,360 --> 00:12:25,920
whitening and data scrambling we hadn't

285
00:12:24,420 --> 00:12:28,170
had that before but in this research

286
00:12:25,920 --> 00:12:32,219
some of the chips use data whitening in

287
00:12:28,170 --> 00:12:35,610
data scrambling this is not encryption

288
00:12:32,220 --> 00:12:37,230
but on on the air it's better for the

289
00:12:35,610 --> 00:12:38,820
receiver to understand what this Center

290
00:12:37,230 --> 00:12:41,250
was sending when there's a lot of

291
00:12:38,820 --> 00:12:43,560
changes between ones and zeros it's just

292
00:12:41,250 --> 00:12:47,040
easier to understand for them and for

293
00:12:43,560 --> 00:12:49,680
that case some of the chips use data

294
00:12:47,040 --> 00:12:52,439
scrambling and data scrambling is just X

295
00:12:49,680 --> 00:12:55,050
oaring some more or less random string

296
00:12:52,440 --> 00:12:59,010
it's hard coded somewhere in the chip X

297
00:12:55,050 --> 00:13:03,390
or on the actual data to get a lot of

298
00:12:59,010 --> 00:13:06,180
changes but we as a researchers need

299
00:13:03,390 --> 00:13:08,550
that string otherwise X or in some

300
00:13:06,180 --> 00:13:11,040
unknown string about some data is

301
00:13:08,550 --> 00:13:13,709
basically encryption so we need to add

302
00:13:11,040 --> 00:13:17,910
that string in order to get the reverse

303
00:13:13,710 --> 00:13:19,530
the data scrambling the data structure

304
00:13:17,910 --> 00:13:22,170
for these packets are most of the time

305
00:13:19,530 --> 00:13:23,910
pretty similar like preamble

306
00:13:22,170 --> 00:13:26,040
think worth there's that address of

307
00:13:23,910 --> 00:13:28,079
course because if your neighbor buys the

308
00:13:26,040 --> 00:13:30,930
same keyboard you don't want when you

309
00:13:28,079 --> 00:13:34,019
press keys only operating the neighbor's

310
00:13:30,930 --> 00:13:35,790
PC or the other way around there are

311
00:13:34,019 --> 00:13:38,459
some control fields the actual payload

312
00:13:35,790 --> 00:13:41,670
and it checks on this was true for most

313
00:13:38,459 --> 00:13:43,888
of the receivers and if you looked at

314
00:13:41,670 --> 00:13:45,870
the data sheets and the ones and zeros

315
00:13:43,889 --> 00:13:48,029
in the air you eventually come to

316
00:13:45,870 --> 00:13:50,760
something like this so you understand

317
00:13:48,029 --> 00:13:53,910
what the preamble is you can dissect the

318
00:13:50,760 --> 00:13:57,510
actual address that the chips are using

319
00:13:53,910 --> 00:14:00,449
some more ya control fields payload

320
00:13:57,510 --> 00:14:03,930
length fields and of course most

321
00:14:00,449 --> 00:14:07,319
importantly the actual payload that is

322
00:14:03,930 --> 00:14:11,699
sent by the devices and the CRC check

323
00:14:07,320 --> 00:14:14,130
sum field so this is an example for one

324
00:14:11,699 --> 00:14:20,389
of them but they are similar in most

325
00:14:14,130 --> 00:14:23,519
cases so let's talk about the actual

326
00:14:20,389 --> 00:14:25,980
actual attack a text we can do and

327
00:14:23,519 --> 00:14:28,529
there's a really old one and really

328
00:14:25,980 --> 00:14:30,690
obvious one at least for us it was

329
00:14:28,529 --> 00:14:33,660
obvious because for all the keyboards

330
00:14:30,690 --> 00:14:35,579
and that's why we have it here again for

331
00:14:33,660 --> 00:14:37,079
all the presenters it was true as well

332
00:14:35,579 --> 00:14:39,089
because they're our presenters out there

333
00:14:37,079 --> 00:14:41,640
they have mouse emulation as well that

334
00:14:39,089 --> 00:14:45,199
you can show what the mouse pointer when

335
00:14:41,640 --> 00:14:48,689
you're presenting and we noticed that he

336
00:14:45,199 --> 00:14:49,649
even was involved of the even of the

337
00:14:48,690 --> 00:14:51,540
encrypted keyboard the mouse

338
00:14:49,649 --> 00:14:54,120
communication is always unencrypted and

339
00:14:51,540 --> 00:14:56,459
unauthenticated so if we understand the

340
00:14:54,120 --> 00:15:00,149
protocol correctly we can just move a

341
00:14:56,459 --> 00:15:06,569
mouse it's not that interesting but let

342
00:15:00,149 --> 00:15:09,630
me quickly show you some some

343
00:15:06,569 --> 00:15:12,300
demonstration this was in 2016 as well

344
00:15:09,630 --> 00:15:14,160
we just brought a a proof of concept to

345
00:15:12,300 --> 00:15:17,609
show people that maybe it's also

346
00:15:14,160 --> 00:15:21,839
interesting - or maybe good to encrypt

347
00:15:17,610 --> 00:15:24,180
your your mouse mouse as well because of

348
00:15:21,839 --> 00:15:26,100
when we control the mouse well of course

349
00:15:24,180 --> 00:15:29,519
with a mouse it's not that easy to

350
00:15:26,100 --> 00:15:31,490
attack an PC but every PC at least on

351
00:15:29,519 --> 00:15:34,140
Windows has an on-screen keyboard and

352
00:15:31,490 --> 00:15:35,680
you can just search for the on-screen

353
00:15:34,140 --> 00:15:37,480
keyboard of course well

354
00:15:35,680 --> 00:15:39,160
maybe you will not find it by the first

355
00:15:37,480 --> 00:15:41,620
try but maybe you'll find it by the

356
00:15:39,160 --> 00:15:44,350
second or about fourth doesn't matter it

357
00:15:41,620 --> 00:15:46,270
comes on on top and if you never use it

358
00:15:44,350 --> 00:15:48,339
before it's always 100 pixel from the

359
00:15:46,270 --> 00:15:50,020
top and 100 pixel from the left so

360
00:15:48,339 --> 00:15:52,029
there's some some conclusions where we

361
00:15:50,020 --> 00:15:53,860
can find it even without a back channel

362
00:15:52,029 --> 00:15:57,430
and that makes it well more or less

363
00:15:53,860 --> 00:15:59,440
reliable and well that's a it's a funny

364
00:15:57,430 --> 00:16:02,469
way to to show this mic well of course

365
00:15:59,440 --> 00:16:05,140
the the screen must be unlocked but it

366
00:16:02,470 --> 00:16:07,959
actually worked and the it's not it's

367
00:16:05,140 --> 00:16:10,449
actually also resolution independent

368
00:16:07,959 --> 00:16:12,520
because most movements are resolution

369
00:16:10,450 --> 00:16:14,440
independent so there are some things

370
00:16:12,520 --> 00:16:16,660
that make this attack work better and

371
00:16:14,440 --> 00:16:18,610
some make it harder this is why it's

372
00:16:16,660 --> 00:16:20,529
really slow because the curve of mouse

373
00:16:18,610 --> 00:16:23,380
acceleration is really hard to

374
00:16:20,529 --> 00:16:25,510
understand but even when you do small

375
00:16:23,380 --> 00:16:27,990
steps you can actually well this is just

376
00:16:25,510 --> 00:16:31,689
the power show download and execute

377
00:16:27,990 --> 00:16:37,330
payload of some ransomware or something

378
00:16:31,690 --> 00:16:41,040
like this it takes the time but point

379
00:16:37,330 --> 00:16:41,040
proven it it is possible

380
00:16:50,570 --> 00:16:57,870
so apart form from spoofing mouse

381
00:16:54,829 --> 00:17:00,060
movements what can we do else of course

382
00:16:57,870 --> 00:17:03,120
their replay attacks this is most

383
00:17:00,060 --> 00:17:05,220
basically just recording the signals we

384
00:17:03,120 --> 00:17:07,349
have captured in the air for example

385
00:17:05,220 --> 00:17:10,559
with a software-defined radio and just

386
00:17:07,349 --> 00:17:12,839
replay the signal and for our research

387
00:17:10,559 --> 00:17:14,899
we found out that all the presenters we

388
00:17:12,839 --> 00:17:17,369
had were actually vulnerable for that so

389
00:17:14,900 --> 00:17:18,929
if somebody's here presenting and

390
00:17:17,369 --> 00:17:20,698
clicking next slide next slide next

391
00:17:18,929 --> 00:17:23,189
slide and you record it with a device

392
00:17:20,699 --> 00:17:26,870
you don't don't have a clue about the

393
00:17:23,189 --> 00:17:29,250
actual the actual format that the

394
00:17:26,869 --> 00:17:31,889
presenters using doesn't matter just

395
00:17:29,250 --> 00:17:33,210
save the data into a file and send it

396
00:17:31,890 --> 00:17:35,610
with the software-defined radio later

397
00:17:33,210 --> 00:17:39,179
and it will go to the next slide or to

398
00:17:35,610 --> 00:17:40,799
the previous slide just a side note this

399
00:17:39,179 --> 00:17:43,590
was true for most of the keyboards as

400
00:17:40,799 --> 00:17:45,179
well we analyzed so far so what what you

401
00:17:43,590 --> 00:17:47,340
can do actually what the keyboard is

402
00:17:45,179 --> 00:17:49,650
when you come into the office at the

403
00:17:47,340 --> 00:17:51,570
morning and somebody is recording well

404
00:17:49,650 --> 00:17:54,419
if you boot up your PC the first thing

405
00:17:51,570 --> 00:17:56,280
you will enter is the the username and

406
00:17:54,419 --> 00:17:58,020
the password and if you go to a coffee

407
00:17:56,280 --> 00:18:00,480
break and lock the screen you can just

408
00:17:58,020 --> 00:18:02,700
resend the signal out and it will unlock

409
00:18:00,480 --> 00:18:04,110
the PC so this works there we have a

410
00:18:02,700 --> 00:18:07,679
YouTube video showing this if you

411
00:18:04,110 --> 00:18:10,080
interested in it pretty pretty simple

412
00:18:07,679 --> 00:18:12,030
but for wireless presenters well it's

413
00:18:10,080 --> 00:18:13,949
not that interesting of course I can

414
00:18:12,030 --> 00:18:18,059
well mess up the person trying to

415
00:18:13,950 --> 00:18:19,890
present in front of you but we can

416
00:18:18,059 --> 00:18:23,399
actually take over the PC just with a

417
00:18:19,890 --> 00:18:25,500
page up and page down button so more

418
00:18:23,400 --> 00:18:29,040
interesting are the keystroke injection

419
00:18:25,500 --> 00:18:35,880
attacks so what if we can enter some

420
00:18:29,040 --> 00:18:39,389
some keystrokes here and as we found out

421
00:18:35,880 --> 00:18:42,419
the data for the presenters are still

422
00:18:39,390 --> 00:18:45,179
unencrypted and unauthenticated so by

423
00:18:42,419 --> 00:18:46,710
understanding the whole packet format we

424
00:18:45,179 --> 00:18:49,230
were able to understand where are the

425
00:18:46,710 --> 00:18:53,520
actual page up and page down button and

426
00:18:49,230 --> 00:18:56,550
if we can craft as the same package with

427
00:18:53,520 --> 00:18:58,139
some other device and just switch out

428
00:18:56,550 --> 00:19:00,480
the page up and page down button with

429
00:18:58,140 --> 00:19:01,810
let's say the a key or the B key or the

430
00:19:00,480 --> 00:19:05,140
C key we were interests

431
00:19:01,810 --> 00:19:06,730
that will be emulated USB keyboard and

432
00:19:05,140 --> 00:19:08,710
the dongle except these keys

433
00:19:06,730 --> 00:19:11,800
although the presenter don't have that

434
00:19:08,710 --> 00:19:15,310
keys in order to attack the PC what the

435
00:19:11,800 --> 00:19:17,800
dongle is connected to and we found out

436
00:19:15,310 --> 00:19:19,830
that two of them actually had some kind

437
00:19:17,800 --> 00:19:23,710
of white listing not excepting the keys

438
00:19:19,830 --> 00:19:26,889
that easily but most of them were were

439
00:19:23,710 --> 00:19:29,020
just vulnerable for these keystroke

440
00:19:26,890 --> 00:19:32,170
injection attacks and I will try this

441
00:19:29,020 --> 00:19:35,620
life like every live demo I will hope it

442
00:19:32,170 --> 00:19:39,370
works and the SSID devices in nowadays

443
00:19:35,620 --> 00:19:40,870
use a 2.4 gigahertz signals and I think

444
00:19:39,370 --> 00:19:43,360
they are oh the room here is pretty much

445
00:19:40,870 --> 00:19:47,169
crowded with Wi-Fi and Bluetooth and

446
00:19:43,360 --> 00:19:49,600
what on so pardon me if it does not work

447
00:19:47,170 --> 00:19:54,310
so I will exploit this ring presenter

448
00:19:49,600 --> 00:19:56,320
here yeah this is we shout on some other

449
00:19:54,310 --> 00:19:58,419
logical presenters that it works but

450
00:19:56,320 --> 00:20:00,879
this was part of the newer research and

451
00:19:58,420 --> 00:20:03,460
he this device was vulnerable as well I

452
00:20:00,880 --> 00:20:05,620
will use the crazy radio dongle for that

453
00:20:03,460 --> 00:20:08,950
because it has a compatible chip to the

454
00:20:05,620 --> 00:20:11,199
chip here and the receiver and there's a

455
00:20:08,950 --> 00:20:16,690
special firmware on the that can lets me

456
00:20:11,200 --> 00:20:18,280
send well whatever I want and this is

457
00:20:16,690 --> 00:20:20,140
just an etiquette PC not really

458
00:20:18,280 --> 00:20:23,020
interesting to see just a common eyeline

459
00:20:20,140 --> 00:20:25,360
to what I can start here that will find

460
00:20:23,020 --> 00:20:27,879
this device emulate the actual presenter

461
00:20:25,360 --> 00:20:30,219
here and not just pressing page up atone

462
00:20:27,880 --> 00:20:33,070
for what other keys and let's see if it

463
00:20:30,220 --> 00:20:34,660
works and as you can see well it just

464
00:20:33,070 --> 00:20:36,520
opened the command from and typed I'm

465
00:20:34,660 --> 00:20:38,050
saying in just as a proof of concept of

466
00:20:36,520 --> 00:20:43,540
course you can change it to whatever you

467
00:20:38,050 --> 00:20:45,370
want download and execute again so this

468
00:20:43,540 --> 00:20:46,870
this worked pretty easily of course it

469
00:20:45,370 --> 00:20:49,300
was not encrypted it was not

470
00:20:46,870 --> 00:20:52,600
authenticated but this is true for most

471
00:20:49,300 --> 00:20:54,460
of the presenter so I guess it's it's

472
00:20:52,600 --> 00:20:57,159
interesting if you present and if you

473
00:20:54,460 --> 00:20:58,780
want to be secure this is why the

474
00:20:57,160 --> 00:21:03,640
presenter from the conference is still

475
00:20:58,780 --> 00:21:05,470
lying here at night out using it so you

476
00:21:03,640 --> 00:21:07,570
can only because the tools are already

477
00:21:05,470 --> 00:21:10,120
online so you can get them on github and

478
00:21:07,570 --> 00:21:11,830
try it out at home maybe not at your

479
00:21:10,120 --> 00:21:13,719
neighbor at least in Germany this is not

480
00:21:11,830 --> 00:21:16,100
a large file or

481
00:21:13,720 --> 00:21:18,019
for the keystroke injection attacks well

482
00:21:16,100 --> 00:21:20,360
for the for the presenters was pretty

483
00:21:18,019 --> 00:21:22,250
easy but what's about the the Fujitsu

484
00:21:20,360 --> 00:21:26,870
keyboard he didn't understand back then

485
00:21:22,250 --> 00:21:28,789
and back then when I talk about this we

486
00:21:26,870 --> 00:21:32,870
analyzed the three other keyboards down

487
00:21:28,789 --> 00:21:35,210
there and we found at that at that time

488
00:21:32,870 --> 00:21:37,629
a cryptographic issue and the way they

489
00:21:35,210 --> 00:21:40,940
use the is counter mode so they actually

490
00:21:37,630 --> 00:21:43,100
use encryption they actually use IAS but

491
00:21:40,940 --> 00:21:46,419
they will just don't use it right and

492
00:21:43,100 --> 00:21:49,490
therefore we were able to inject keys

493
00:21:46,419 --> 00:21:53,509
although we don't know the actual AES

494
00:21:49,490 --> 00:21:55,940
encryption key but this did not work for

495
00:21:53,509 --> 00:21:57,320
the fugitive keyboard there was a there

496
00:21:55,940 --> 00:22:00,500
there's a different chip on that

497
00:21:57,320 --> 00:22:01,820
keyboard and and what the way it was

498
00:22:00,500 --> 00:22:05,509
programmed it was just not vulnerable

499
00:22:01,820 --> 00:22:06,830
for this this kind of attack but as we

500
00:22:05,509 --> 00:22:08,120
have a closer look so this difference

501
00:22:06,830 --> 00:22:10,129
it's a keyboard as you can see there

502
00:22:08,120 --> 00:22:11,870
it's a two chip set up as well you can

503
00:22:10,129 --> 00:22:15,408
also sniff the communication again

504
00:22:11,870 --> 00:22:18,199
between and if when we had a closer look

505
00:22:15,409 --> 00:22:19,909
into the transmitter chip see the chips

506
00:22:18,200 --> 00:22:23,570
are from Cyprus the keyboard is phone

507
00:22:19,909 --> 00:22:26,450
from Fujitsu and and what most chip

508
00:22:23,570 --> 00:22:28,639
manufacturers do - well some kind of

509
00:22:26,450 --> 00:22:30,730
showcase their chip they providing you

510
00:22:28,639 --> 00:22:35,600
example code or something like this and

511
00:22:30,730 --> 00:22:37,549
Cyprus was I had some website up there

512
00:22:35,600 --> 00:22:39,830
and you can search for it and there was

513
00:22:37,549 --> 00:22:42,500
some some example or some software

514
00:22:39,830 --> 00:22:45,379
development kit way can check that was

515
00:22:42,500 --> 00:22:50,600
especially for that chip or for these

516
00:22:45,379 --> 00:22:52,580
chip and serious and within it chip

517
00:22:50,600 --> 00:22:54,918
Cedars there was example code for this

518
00:22:52,580 --> 00:22:57,080
is how you can do a basic keyboard and

519
00:22:54,919 --> 00:22:58,879
this basic keeper of course it's just

520
00:22:57,080 --> 00:23:02,090
example codes and unencrypted keyboard

521
00:22:58,879 --> 00:23:05,240
but you can use that and it turns out

522
00:23:02,090 --> 00:23:07,428
that the Fujitsu people actually most

523
00:23:05,240 --> 00:23:09,139
likely use that example code with the

524
00:23:07,429 --> 00:23:11,029
unencrypted keyboard and added

525
00:23:09,139 --> 00:23:15,620
encryption to it well you were not able

526
00:23:11,029 --> 00:23:18,440
to decrypt it or to inject encrypted

527
00:23:15,620 --> 00:23:20,840
packages but our Samson was maybe if

528
00:23:18,440 --> 00:23:23,720
they use the unencrypted keyboard code

529
00:23:20,840 --> 00:23:25,760
and edit encryption did they removed the

530
00:23:23,720 --> 00:23:26,960
unencrypted keyboard code after adding

531
00:23:25,760 --> 00:23:30,110
the encryption

532
00:23:26,960 --> 00:23:32,210
and turns out they didn't so instead of

533
00:23:30,110 --> 00:23:34,909
injecting encrypted packets we just

534
00:23:32,210 --> 00:23:37,070
encrypt sent plaintext package to the

535
00:23:34,910 --> 00:23:39,950
chip and he process the chip processes

536
00:23:37,070 --> 00:23:43,909
the plaintext packages as well and we

537
00:23:39,950 --> 00:23:47,780
were able to gain a keystroke injection

538
00:23:43,910 --> 00:23:51,170
here as well so this trip uses data

539
00:23:47,780 --> 00:23:53,960
whitening and this is rather hard so we

540
00:23:51,170 --> 00:23:56,210
did the same like with the crazy radio

541
00:23:53,960 --> 00:24:00,290
we bought a port that has the same chip

542
00:23:56,210 --> 00:24:04,630
like used in the keyboard this is again

543
00:24:00,290 --> 00:24:07,700
some eye from from some multicopter or

544
00:24:04,630 --> 00:24:09,620
multicopter drone hobbyist remote

545
00:24:07,700 --> 00:24:12,590
control chip but this has the same shape

546
00:24:09,620 --> 00:24:13,100
we want to use and that's good enough

547
00:24:12,590 --> 00:24:16,429
for us

548
00:24:13,100 --> 00:24:18,350
and it also on the only back side and if

549
00:24:16,430 --> 00:24:19,160
this ship here not sure if you can see

550
00:24:18,350 --> 00:24:21,230
it back there

551
00:24:19,160 --> 00:24:23,330
on the back side there's even a small

552
00:24:21,230 --> 00:24:25,970
micro controller where I can program co2

553
00:24:23,330 --> 00:24:28,909
so this is a standalone attack even if

554
00:24:25,970 --> 00:24:30,950
you don't need something though we we

555
00:24:28,910 --> 00:24:32,750
put the demo code on the controller here

556
00:24:30,950 --> 00:24:35,120
on the other side there the transceiver

557
00:24:32,750 --> 00:24:36,830
chips this device has four transceiver

558
00:24:35,120 --> 00:24:39,169
chips but one of them as II for the

559
00:24:36,830 --> 00:24:42,290
Fujitsu keyboard and reprogram it just

560
00:24:39,170 --> 00:24:46,130
to send the unencrypted keystrokes let's

561
00:24:42,290 --> 00:24:49,399
try this in a live demos well it worked

562
00:24:46,130 --> 00:24:51,890
a lot of times but I was presenting this

563
00:24:49,400 --> 00:24:56,080
light again at some point and did not

564
00:24:51,890 --> 00:24:58,880
work let's see if it works this time

565
00:24:56,080 --> 00:25:03,639
so just connecting a battery over here

566
00:24:58,880 --> 00:25:03,640
so the board has some power to run

567
00:25:11,830 --> 00:25:18,320
and as you can see well not doing

568
00:25:15,260 --> 00:25:21,140
anything blinks a little bit here that's

569
00:25:18,320 --> 00:25:25,158
everything you can even make it smaller

570
00:25:21,140 --> 00:25:26,809
if you want to but works again so

571
00:25:25,159 --> 00:25:30,770
keystroke injection on the keyboard that

572
00:25:26,809 --> 00:25:33,740
supposedly should be secure is encrypted

573
00:25:30,770 --> 00:25:37,090
but they just forget to remove the the

574
00:25:33,740 --> 00:25:40,070
unencrypted keyboard code from there

575
00:25:37,090 --> 00:25:44,240
after we had a closer look at the Alex

576
00:25:40,070 --> 00:25:48,830
mmm 901 this is the one I just showed

577
00:25:44,240 --> 00:25:53,080
you the keyboard and people asked us

578
00:25:48,830 --> 00:25:57,260
about plx three nine Oh keyboard and

579
00:25:53,080 --> 00:26:01,250
sure fair enough it advertised this

580
00:25:57,260 --> 00:26:02,990
table as a secure 2.4 technology

581
00:26:01,250 --> 00:26:05,030
keyboard but not mentioning AES

582
00:26:02,990 --> 00:26:06,830
encryption somewhere so what's

583
00:26:05,030 --> 00:26:09,830
interesting for us to have a closer look

584
00:26:06,830 --> 00:26:11,990
and this R is the data feed ordered

585
00:26:09,830 --> 00:26:14,418
product sheet before we had a close

586
00:26:11,990 --> 00:26:16,340
closer look and other data sheet down

587
00:26:14,419 --> 00:26:19,100
there see that Rashid after we had a

588
00:26:16,340 --> 00:26:30,049
closer look and now the font is really

589
00:26:19,100 --> 00:26:32,480
tiny but my spot the difference so of

590
00:26:30,049 --> 00:26:33,950
course we when we find security

591
00:26:32,480 --> 00:26:35,900
vulnerabilities we do a responsible

592
00:26:33,950 --> 00:26:37,490
disclosure and tell the manufacturers

593
00:26:35,900 --> 00:26:39,650
and they updated the keyboard actually

594
00:26:37,490 --> 00:26:41,510
this keyboard is no longer you can no

595
00:26:39,650 --> 00:26:46,370
longer buy it they have a better ones

596
00:26:41,510 --> 00:26:47,870
now with better encryption let's quickly

597
00:26:46,370 --> 00:26:50,389
have a closer look in that keyboard it

598
00:26:47,870 --> 00:26:52,610
was a an interesting journey because it

599
00:26:50,390 --> 00:26:54,590
was basically the lockdown chips and

600
00:26:52,610 --> 00:26:56,870
just by sniffing the communication with

601
00:26:54,590 --> 00:26:58,820
a logic analyzer you can get the

602
00:26:56,870 --> 00:27:02,059
sequence what you want microcontrollers

603
00:26:58,820 --> 00:27:06,110
telling the receiver chip and on the

604
00:27:02,059 --> 00:27:08,418
receiver chip we we noticed a pattern be

605
00:27:06,110 --> 00:27:11,719
known before and this is what when the

606
00:27:08,419 --> 00:27:14,360
device boots up it configures the RF

607
00:27:11,720 --> 00:27:17,059
chip like what data rate it should use

608
00:27:14,360 --> 00:27:18,830
what channel it should use stuff like

609
00:27:17,059 --> 00:27:20,658
this and from that we were able to

610
00:27:18,830 --> 00:27:23,389
reconstruct what ship must be under

611
00:27:20,659 --> 00:27:23,809
there and we found out it must be an LP

612
00:27:23,390 --> 00:27:28,190
8

613
00:27:23,809 --> 00:27:30,200
900 bass chips somewhere but when we

614
00:27:28,190 --> 00:27:33,729
understand this and what the chip

615
00:27:30,200 --> 00:27:37,219
actually is we can again build our own

616
00:27:33,729 --> 00:27:39,739
first of all this is when we decoded the

617
00:27:37,219 --> 00:27:41,840
packet now that we understand what they

618
00:27:39,739 --> 00:27:43,999
talk about each other to each other and

619
00:27:41,840 --> 00:27:46,158
how they configured we again can do the

620
00:27:43,999 --> 00:27:47,960
radio based analysis capture the package

621
00:27:46,159 --> 00:27:49,359
and decode the packages to understand

622
00:27:47,960 --> 00:27:52,700
what is going on there

623
00:27:49,359 --> 00:27:55,609
and of course again the important part

624
00:27:52,700 --> 00:28:00,619
is something like the payload here and

625
00:27:55,609 --> 00:28:03,379
the CRC check sum and it turns out the

626
00:28:00,619 --> 00:28:05,899
again this chip uses data whitening soda

627
00:28:03,379 --> 00:28:08,238
scrambling we have to understand how

628
00:28:05,899 --> 00:28:12,199
this works and even though the plaintext

629
00:28:08,239 --> 00:28:14,799
is always the same and so it has no

630
00:28:12,200 --> 00:28:17,749
replay protection or something like this

631
00:28:14,799 --> 00:28:19,729
the the actual CRC when we buy two

632
00:28:17,749 --> 00:28:22,119
different keyboards you can see here the

633
00:28:19,729 --> 00:28:25,099
last part is the CRC is different so we

634
00:28:22,119 --> 00:28:29,330
found out that the CRC is initialized

635
00:28:25,099 --> 00:28:31,428
with a well device specific bite but

636
00:28:29,330 --> 00:28:33,439
first of all the data scrambling that

637
00:28:31,429 --> 00:28:36,589
was more easy because the data

638
00:28:33,440 --> 00:28:38,690
scrambling was the same on each on every

639
00:28:36,589 --> 00:28:40,428
keyboard so by reverting the data

640
00:28:38,690 --> 00:28:43,460
scrambling for one keyboard you can

641
00:28:40,429 --> 00:28:45,739
apply to just all other keyboards you

642
00:28:43,460 --> 00:28:49,399
have to make a look at table basically

643
00:28:45,739 --> 00:28:51,409
and again this is just a basic CRC no

644
00:28:49,399 --> 00:28:53,508
message authentication code no no real

645
00:28:51,409 --> 00:28:54,979
security so we can again spoof the

646
00:28:53,509 --> 00:28:56,599
keyboard just for the sake of

647
00:28:54,979 --> 00:28:59,419
completeness you can prove force this

648
00:28:56,599 --> 00:29:02,570
year see how all this work how it's

649
00:28:59,419 --> 00:29:06,919
working and you can see down here and

650
00:29:02,570 --> 00:29:09,139
there there's a device specific value in

651
00:29:06,919 --> 00:29:12,080
this case we have to initialize the CRC

652
00:29:09,139 --> 00:29:13,849
with this value and if you want to hack

653
00:29:12,080 --> 00:29:16,489
the keyboard of your neighbour of course

654
00:29:13,849 --> 00:29:17,899
you just sniff one packet and prove

655
00:29:16,489 --> 00:29:21,739
first this years even if you're hitting

656
00:29:17,899 --> 00:29:24,018
the right CRC you found you device

657
00:29:21,739 --> 00:29:28,359
specific initialization value and it

658
00:29:24,019 --> 00:29:32,179
will be used for all packets there so

659
00:29:28,359 --> 00:29:33,830
again to recap it has no protection

660
00:29:32,179 --> 00:29:37,159
against replay attack it has no

661
00:29:33,830 --> 00:29:38,689
protection against it has no real and

662
00:29:37,159 --> 00:29:40,789
corruptions or sensitive data is not

663
00:29:38,690 --> 00:29:42,979
really protected there and there are no

664
00:29:40,789 --> 00:29:44,840
data authenticity so we can just move

665
00:29:42,979 --> 00:29:47,539
the device or replay a text keystroke

666
00:29:44,840 --> 00:29:49,939
and keep sniffing attacks uh this time

667
00:29:47,539 --> 00:29:51,499
possible and my colleague actually wrote

668
00:29:49,940 --> 00:29:53,809
that we are not sure if it's already

669
00:29:51,499 --> 00:29:55,879
public but it's just another proof of

670
00:29:53,809 --> 00:30:00,259
concept that you can actually in this

671
00:29:55,879 --> 00:30:01,969
case decode what the people typing on

672
00:30:00,259 --> 00:30:05,960
the keyboard so if they type the

673
00:30:01,970 --> 00:30:08,960
password in you arrive on this secure

674
00:30:05,960 --> 00:30:11,029
keyboard to sniff the actual key strokes

675
00:30:08,960 --> 00:30:13,340
that were pressed and recover the

676
00:30:11,029 --> 00:30:17,450
keyboard and already clear the login

677
00:30:13,340 --> 00:30:20,359
credentials or whatever the email the

678
00:30:17,450 --> 00:30:22,700
people the person is typing so

679
00:30:20,359 --> 00:30:24,949
conclusions unencrypted an

680
00:30:22,700 --> 00:30:27,080
unauthenticated data communication of

681
00:30:24,950 --> 00:30:31,340
course this allowed us all the

682
00:30:27,080 --> 00:30:33,859
disproving and and injection attacks

683
00:30:31,340 --> 00:30:35,899
missing code protection against replay

684
00:30:33,859 --> 00:30:38,418
attacks what we can do replay this is

685
00:30:35,899 --> 00:30:40,428
rather easy and the cryptographic issues

686
00:30:38,419 --> 00:30:43,580
we saw we can bypass some cryptographic

687
00:30:40,429 --> 00:30:45,979
things and inject keys and in some cases

688
00:30:43,580 --> 00:30:50,210
we even are able to decode the actual

689
00:30:45,979 --> 00:30:53,690
key strings here so from the presenters

690
00:30:50,210 --> 00:30:56,239
we had a closer look the well most of

691
00:30:53,690 --> 00:30:58,609
them are vulnerable to keystroke

692
00:30:56,239 --> 00:31:02,109
injection some of them had some sort of

693
00:30:58,609 --> 00:31:04,789
whitelist inium a little bit better and

694
00:31:02,109 --> 00:31:06,590
for some of them most poofing worked and

695
00:31:04,789 --> 00:31:08,929
this does not mean there's no more

696
00:31:06,590 --> 00:31:15,259
spoofing this presenters just didn't

697
00:31:08,929 --> 00:31:17,359
have a mouse pointer and as we were not

698
00:31:15,259 --> 00:31:19,759
the only ones researching the wireless

699
00:31:17,359 --> 00:31:22,249
presenters I want to show you this from

700
00:31:19,759 --> 00:31:23,659
mark Neil earnest way as well he had

701
00:31:22,249 --> 00:31:25,879
looked at at different presenters as

702
00:31:23,659 --> 00:31:28,639
well and came to the same conclusion

703
00:31:25,879 --> 00:31:31,809
it's basically possible all the time to

704
00:31:28,639 --> 00:31:36,769
to inject keystrokes some time limited

705
00:31:31,809 --> 00:31:39,918
some Logitech products that do not allow

706
00:31:36,769 --> 00:31:42,739
sending a B C or D keys but in some of

707
00:31:39,919 --> 00:31:45,080
the cases you can press the the Alt key

708
00:31:42,739 --> 00:31:47,059
and the number lock keys and without a

709
00:31:45,080 --> 00:31:49,369
new block you can type Unicode symbols

710
00:31:47,059 --> 00:31:49,950
on at least on Windows and again you

711
00:31:49,369 --> 00:31:56,279
have it

712
00:31:49,950 --> 00:31:58,679
keyboard with that and updating our 2016

713
00:31:56,279 --> 00:32:02,399
research with a viola with the Fujitsu

714
00:31:58,679 --> 00:32:04,139
wireless input devices as we showed you

715
00:32:02,399 --> 00:32:08,870
the keystroke injection we were able to

716
00:32:04,139 --> 00:32:11,610
do this as well so some recommendations

717
00:32:08,870 --> 00:32:14,549
choose your wireless presenter input

718
00:32:11,610 --> 00:32:17,459
devices might be by looking at some

719
00:32:14,549 --> 00:32:19,740
table or maybe we jump to the last point

720
00:32:17,460 --> 00:32:22,289
maybe not at all if you really want to

721
00:32:19,740 --> 00:32:24,600
be secure of course if you in

722
00:32:22,289 --> 00:32:26,610
environments that demand high security I

723
00:32:24,600 --> 00:32:28,678
would recommend not to use them at all

724
00:32:26,610 --> 00:32:31,260
at some points you can consider

725
00:32:28,679 --> 00:32:35,419
Bluetooth space input devices they are

726
00:32:31,260 --> 00:32:38,220
in most of the cases they're more secure

727
00:32:35,419 --> 00:32:40,010
when they paired and when the in during

728
00:32:38,220 --> 00:32:42,539
the pairing process there are a lot of

729
00:32:40,010 --> 00:32:44,730
vulnerabilities especially in the root

730
00:32:42,539 --> 00:32:47,940
of low energy devices the old ones and

731
00:32:44,730 --> 00:32:50,130
if the attacker is near you while you

732
00:32:47,940 --> 00:32:53,580
are pairing the presenter with your

733
00:32:50,130 --> 00:32:55,500
laptop using Bluetooth Low Energy 4.0

734
00:32:53,580 --> 00:32:58,500
like most of the presenters with

735
00:32:55,500 --> 00:33:01,679
Bluetooth or keywords and you are able

736
00:32:58,500 --> 00:33:04,919
to extract the key as well and can

737
00:33:01,679 --> 00:33:06,779
inject code again and for some of them

738
00:33:04,919 --> 00:33:08,700
there are replacements or updates are

739
00:33:06,779 --> 00:33:11,250
available you can have a look into that

740
00:33:08,700 --> 00:33:14,220
especially for a Logitech products but

741
00:33:11,250 --> 00:33:16,200
if in doubt just use a wired one and if

742
00:33:14,220 --> 00:33:17,880
you're interested in trying this at home

743
00:33:16,200 --> 00:33:19,440
the most of the software's online

744
00:33:17,880 --> 00:33:21,720
available so mark Newlands wireless

745
00:33:19,440 --> 00:33:22,919
presentation work is online and the

746
00:33:21,720 --> 00:33:25,500
tools are on github

747
00:33:22,919 --> 00:33:29,279
Markus Manx who did the research on the

748
00:33:25,500 --> 00:33:32,909
Logitech products his tools are online

749
00:33:29,279 --> 00:33:34,980
as well you can try them and our Fork of

750
00:33:32,909 --> 00:33:37,200
Mark Newlands presentation clickers

751
00:33:34,980 --> 00:33:41,549
repository where we edit our keyboards

752
00:33:37,200 --> 00:33:43,529
and the yeah presenters we analyzed is

753
00:33:41,549 --> 00:33:47,580
also available online you can have a

754
00:33:43,529 --> 00:33:50,220
closer look and if we have no she's just

755
00:33:47,580 --> 00:33:53,129
some short anecdote funny because the

756
00:33:50,220 --> 00:33:56,460
the is encrypted keyboard by Cherry we

757
00:33:53,130 --> 00:33:58,889
had 2016 a closer look you can no longer

758
00:33:56,460 --> 00:34:01,230
buy it as be unlimited is but they built

759
00:33:58,889 --> 00:34:03,629
a new one it's the be unlimited 3.0

760
00:34:01,230 --> 00:34:05,580
really new and shiny

761
00:34:03,630 --> 00:34:08,700
but it has still the same cryptographic

762
00:34:05,580 --> 00:34:10,889
weakness we found in 2016 so they fixed

763
00:34:08,699 --> 00:34:14,370
the security issue just by rebranding it

764
00:34:10,889 --> 00:34:16,199
so before there was this is a secure

765
00:34:14,370 --> 00:34:17,880
keyboard now when you buy it there's no

766
00:34:16,199 --> 00:34:20,730
more secure printed on the keyboard and

767
00:34:17,880 --> 00:34:23,790
keyboard without printing securing it

768
00:34:20,730 --> 00:34:25,050
well there is no security issue if the

769
00:34:23,790 --> 00:34:28,860
keyboard wasn't secured in the first

770
00:34:25,050 --> 00:34:30,960
place and another interesting thing to

771
00:34:28,860 --> 00:34:33,090
keep in mind when I say look at the

772
00:34:30,960 --> 00:34:35,010
table and you say ok I by the August

773
00:34:33,090 --> 00:34:37,380
presenter or something because this was

774
00:34:35,010 --> 00:34:39,930
the best in this research this is the

775
00:34:37,380 --> 00:34:42,120
Logitech our 400 we bought in from

776
00:34:39,929 --> 00:34:44,520
Amazon like three different points of

777
00:34:42,120 --> 00:34:46,230
time and clicking on different shops and

778
00:34:44,520 --> 00:34:49,530
this is what we got three different

779
00:34:46,230 --> 00:34:51,120
versions of the our 400 all completely

780
00:34:49,530 --> 00:34:54,240
different completely different hardware

781
00:34:51,120 --> 00:34:57,450
and I'm not sure if the first one we

782
00:34:54,239 --> 00:34:59,129
analyzed in this is for sure attackable

783
00:34:57,450 --> 00:35:01,230
but keystroke injection the other ones

784
00:34:59,130 --> 00:35:03,720
we haven't had a closer look we contact

785
00:35:01,230 --> 00:35:06,120
contact that Logitech if the others are

786
00:35:03,720 --> 00:35:07,500
just cheap Chinese clones because the

787
00:35:06,120 --> 00:35:09,270
logo was slightly different and the

788
00:35:07,500 --> 00:35:12,210
presenter was lighter and something like

789
00:35:09,270 --> 00:35:15,140
this and Logitech refused to answer

790
00:35:12,210 --> 00:35:18,450
because well it's the parts on the

791
00:35:15,140 --> 00:35:22,379
presenters are internally and are under

792
00:35:18,450 --> 00:35:24,960
disclosure and a closure so you you they

793
00:35:22,380 --> 00:35:28,560
won't tell us if they are real product

794
00:35:24,960 --> 00:35:30,030
or not but if you search online a lot to

795
00:35:28,560 --> 00:35:33,060
take is saying that if you have a

796
00:35:30,030 --> 00:35:35,550
Logitech product the USP vendor ID for

797
00:35:33,060 --> 00:35:37,470
USB product as a banner ID should be the

798
00:35:35,550 --> 00:35:40,050
one from Logitech and for the first one

799
00:35:37,470 --> 00:35:42,600
this is true for the other two there the

800
00:35:40,050 --> 00:35:45,480
vendor ID is from some Chinese chip

801
00:35:42,600 --> 00:35:47,190
manufacturer so not really largely not

802
00:35:45,480 --> 00:35:50,790
sure maybe they change the production

803
00:35:47,190 --> 00:35:54,090
just because it was cheaper but so even

804
00:35:50,790 --> 00:35:56,100
if you buy the the most secure one maybe

805
00:35:54,090 --> 00:35:59,480
you don't get a secure one because if

806
00:35:56,100 --> 00:36:03,390
you don't open it up you you don't know

807
00:35:59,480 --> 00:36:05,100
so this is what I said and translating

808
00:36:03,390 --> 00:36:07,799
to something like the parts are

809
00:36:05,100 --> 00:36:11,640
copyright protected information so won't

810
00:36:07,800 --> 00:36:14,070
tell us as one more thing we're not

811
00:36:11,640 --> 00:36:15,450
finished yet with that research there

812
00:36:14,070 --> 00:36:17,400
are other devices out there like the

813
00:36:15,450 --> 00:36:18,419
barcode scanners or so

814
00:36:17,400 --> 00:36:20,520
you can get basically they're just

815
00:36:18,420 --> 00:36:23,280
keyboards as well we having closer look

816
00:36:20,520 --> 00:36:25,560
into them as well maybe devil more

817
00:36:23,280 --> 00:36:27,600
attacks and wireless input devices and

818
00:36:25,560 --> 00:36:30,120
the slides will be online you can have a

819
00:36:27,600 --> 00:36:32,279
look at all the references and check out

820
00:36:30,120 --> 00:36:34,410
all the stuff and with that I'm finished

821
00:36:32,280 --> 00:36:43,590
thank you and if you have some questions

822
00:36:34,410 --> 00:36:46,470
I'm ready to get them thank you for this

823
00:36:43,590 --> 00:36:51,000
interesting talk and well German

824
00:36:46,470 --> 00:36:56,490
precision the timing is spot on so we

825
00:36:51,000 --> 00:36:58,980
have time for questions you know so for

826
00:36:56,490 --> 00:37:01,080
the first keyboard you are saying that

827
00:36:58,980 --> 00:37:03,180
it can process both encrypted and

828
00:37:01,080 --> 00:37:05,310
unencrypted may say how does it make a

829
00:37:03,180 --> 00:37:07,220
difference like when you receive the

830
00:37:05,310 --> 00:37:10,200
message how I can tell that it's

831
00:37:07,220 --> 00:37:12,209
actually we don't know this was one of

832
00:37:10,200 --> 00:37:13,799
the chips that has the firmware locked

833
00:37:12,210 --> 00:37:15,840
on the tip so we can't read out what

834
00:37:13,800 --> 00:37:17,940
they actually programmed on the chip but

835
00:37:15,840 --> 00:37:21,300
the data structure is just different

836
00:37:17,940 --> 00:37:23,850
from an encrypted and encrypted packet

837
00:37:21,300 --> 00:37:25,170
and I guess somewhere they're parsing it

838
00:37:23,850 --> 00:37:26,520
different when the data structure is

839
00:37:25,170 --> 00:37:28,770
different when coming in from the

840
00:37:26,520 --> 00:37:31,230
transceiver down low okay thank you

841
00:37:28,770 --> 00:37:32,759
there's no no flag like saying this is

842
00:37:31,230 --> 00:37:35,850
encrypted or non interrupts it's just a

843
00:37:32,760 --> 00:37:41,490
different data format some more

844
00:37:35,850 --> 00:37:43,529
questions okay I do have a question yeah

845
00:37:41,490 --> 00:37:45,810
it's more of a political question

846
00:37:43,530 --> 00:37:48,480
actually because I'm looking at all

847
00:37:45,810 --> 00:37:51,360
these it seems like a lot of work and it

848
00:37:48,480 --> 00:37:54,300
must be time-consuming yeah and they

849
00:37:51,360 --> 00:37:55,920
don't seem to be prototypes in any case

850
00:37:54,300 --> 00:37:58,530
meaning that these are products that are

851
00:37:55,920 --> 00:38:02,820
being sold in the market so who finances

852
00:37:58,530 --> 00:38:05,250
this research so what is the I mean of

853
00:38:02,820 --> 00:38:07,500
course it's fun and I understand the

854
00:38:05,250 --> 00:38:09,150
motivation for that but do you guys like

855
00:38:07,500 --> 00:38:11,850
approach the company is there for bounty

856
00:38:09,150 --> 00:38:13,650
hunting or things like that or and in

857
00:38:11,850 --> 00:38:16,110
some cases so it started if the first

858
00:38:13,650 --> 00:38:19,740
research in 2016 started actually as a

859
00:38:16,110 --> 00:38:21,960
customer project because a bank was want

860
00:38:19,740 --> 00:38:23,399
to use encrypted keyboards wireless

861
00:38:21,960 --> 00:38:25,560
keyboards and they asked us is one of

862
00:38:23,400 --> 00:38:27,990
these three encrypted keyboards secure

863
00:38:25,560 --> 00:38:30,060
and they say well you have like one or

864
00:38:27,990 --> 00:38:31,649
two weeks to analyze them and

865
00:38:30,060 --> 00:38:34,110
okay we give it a shot but in one or two

866
00:38:31,650 --> 00:38:35,850
weeks we can't actually tell much but we

867
00:38:34,110 --> 00:38:37,260
saw enough to say well this is pretty

868
00:38:35,850 --> 00:38:39,299
interesting and we want to learn more

869
00:38:37,260 --> 00:38:42,990
about it and at that point it was just

870
00:38:39,300 --> 00:38:44,850
self investment basically 50% from the

871
00:38:42,990 --> 00:38:46,500
company and well to be fair the other

872
00:38:44,850 --> 00:38:48,750
50% of free time

873
00:38:46,500 --> 00:38:51,570
doing it somewhere in the evening and

874
00:38:48,750 --> 00:38:52,110
then again and again again and after a

875
00:38:51,570 --> 00:38:53,970
while

876
00:38:52,110 --> 00:38:57,140
why we had the first devices report the

877
00:38:53,970 --> 00:38:59,060
first devices some of the actual

878
00:38:57,140 --> 00:39:01,620
manufacturers of these devices

879
00:38:59,060 --> 00:39:03,570
cooperated with us for newer products

880
00:39:01,620 --> 00:39:06,600
and we tested the products and give them

881
00:39:03,570 --> 00:39:08,970
some yeah some feedback on what they can

882
00:39:06,600 --> 00:39:13,430
improve on the products okay thank you

883
00:39:08,970 --> 00:39:13,430
very much are there any other questions

884
00:39:17,540 --> 00:39:23,670
so for the presenters to you can you

885
00:39:20,640 --> 00:39:26,609
actually see which presenter it is from

886
00:39:23,670 --> 00:39:29,250
just sniffing or if you inject so

887
00:39:26,610 --> 00:39:31,680
because if you are in the audience right

888
00:39:29,250 --> 00:39:34,260
now someone could inject yeah right now

889
00:39:31,680 --> 00:39:35,790
right okay I have removed the dongles

890
00:39:34,260 --> 00:39:37,590
but I guess for the other presenters

891
00:39:35,790 --> 00:39:40,920
everybody other people present here and

892
00:39:37,590 --> 00:39:43,620
this might be true yes in most cases you

893
00:39:40,920 --> 00:39:45,540
can so the data structures are that

894
00:39:43,620 --> 00:39:47,670
different if you know them you can see

895
00:39:45,540 --> 00:39:49,710
what chip must be at least if it's one

896
00:39:47,670 --> 00:39:52,800
of the common ones and they most of the

897
00:39:49,710 --> 00:39:54,720
time they're pretty common even and in

898
00:39:52,800 --> 00:39:56,720
most of the cases you can just use this

899
00:39:54,720 --> 00:39:59,220
device because the chip on here is

900
00:39:56,720 --> 00:40:01,169
compatible with a lot of devices and

901
00:39:59,220 --> 00:40:02,220
it's also compatible for the bacon chips

902
00:40:01,170 --> 00:40:04,620
because the backend chips are just

903
00:40:02,220 --> 00:40:07,109
clones you can just use this device also

904
00:40:04,620 --> 00:40:11,250
for sniffing this device is capable of

905
00:40:07,110 --> 00:40:14,060
sniffing drinks thanks to I think Travis

906
00:40:11,250 --> 00:40:16,140
Goodspeed is here somewhere because

907
00:40:14,060 --> 00:40:18,630
there are some tricks in the chip you

908
00:40:16,140 --> 00:40:22,410
can use for sniffing and if you under

909
00:40:18,630 --> 00:40:25,590
see what is there in the air you

910
00:40:22,410 --> 00:40:27,660
probably can guess the rest from that if

911
00:40:25,590 --> 00:40:30,330
the presenter is a presenter we had

912
00:40:27,660 --> 00:40:32,100
never take a look before I'm not sure if

913
00:40:30,330 --> 00:40:34,110
you can say it that way but if it's

914
00:40:32,100 --> 00:40:36,230
known you can distinct them from each

915
00:40:34,110 --> 00:40:36,230
other

916
00:40:38,460 --> 00:40:45,240
did you try to use the FCC ID to find

917
00:40:42,619 --> 00:40:48,539
other details about the device or not

918
00:40:45,240 --> 00:40:51,629
yeah we did from time to time so the FCC

919
00:40:48,539 --> 00:40:54,299
idea is an idea if you sell a product in

920
00:40:51,630 --> 00:40:56,789
America every radio based product must

921
00:40:54,299 --> 00:40:59,130
have an unique ID that must be printed

922
00:40:56,789 --> 00:41:00,329
on the product and it was interesting

923
00:40:59,130 --> 00:41:02,849
enough at least for the Logitech

924
00:41:00,329 --> 00:41:04,799
presenters there was the same FCC ID on

925
00:41:02,849 --> 00:41:06,660
all of them although there we get them

926
00:41:04,799 --> 00:41:08,549
with different chips and another

927
00:41:06,660 --> 00:41:12,149
interesting story was actually from the

928
00:41:08,549 --> 00:41:15,059
Cherry keyboard we start for the FCC ID

929
00:41:12,150 --> 00:41:17,010
and the FCC ID wasn't there they did a

930
00:41:15,059 --> 00:41:19,470
typo and the FCC ID they printed on the

931
00:41:17,010 --> 00:41:22,319
product so you're not able to find them

932
00:41:19,470 --> 00:41:24,450
but for the first research it's fun time

933
00:41:22,319 --> 00:41:26,520
to time it really helps but we buy them

934
00:41:24,450 --> 00:41:28,680
anyway opening up anyway so we get the

935
00:41:26,520 --> 00:41:33,359
internal pictures from the FCC our ID

936
00:41:28,680 --> 00:41:39,690
report by ourselves possible as well so

937
00:41:33,359 --> 00:41:43,369
we have time for more questions okay so

938
00:41:39,690 --> 00:41:43,369
thank you very much again let me

