1
00:00:00,560 --> 00:00:02,879
welcome back everyone our next speaker

2
00:00:02,879 --> 00:00:04,319
is andrew lemon

3
00:00:04,319 --> 00:00:07,919
and the title of his presentation is bne

4
00:00:07,919 --> 00:00:10,480
from a to z i'm looking forward to his

5
00:00:10,480 --> 00:00:11,519
presentation

6
00:00:11,519 --> 00:00:13,599
so without any further ado i'll pass it

7
00:00:13,599 --> 00:00:17,920
to andrew

8
00:00:21,520 --> 00:00:23,760
hi welcome to my presentation i'm andrew

9
00:00:23,760 --> 00:00:24,960
lemon

10
00:00:24,960 --> 00:00:27,519
and this is b and e from a to z a guide

11
00:00:27,519 --> 00:00:29,119
to physical pen testing

12
00:00:29,119 --> 00:00:30,560
where we're going to go over the last

13
00:00:30,560 --> 00:00:32,719
year of physical pen testing my company

14
00:00:32,719 --> 00:00:33,520
did

15
00:00:33,520 --> 00:00:35,440
and talk about how we got into your data

16
00:00:35,440 --> 00:00:38,079
centers even during a pandemic

17
00:00:38,079 --> 00:00:39,520
so i originally started this talk

18
00:00:39,520 --> 00:00:41,280
thinking of just be 25 minutes

19
00:00:41,280 --> 00:00:42,879
turns out i didn't realize how much

20
00:00:42,879 --> 00:00:45,039
information wasn't in the wild

21
00:00:45,039 --> 00:00:46,719
so instead i'll cover the techniques the

22
00:00:46,719 --> 00:00:48,480
tools i've used some of the breakdown

23
00:00:48,480 --> 00:00:49,600
anatomy of doors

24
00:00:49,600 --> 00:00:51,120
and what's made me successful in

25
00:00:51,120 --> 00:00:53,760
engagements

26
00:00:54,559 --> 00:00:56,800
so who am i i'm the principal security

27
00:00:56,800 --> 00:00:58,480
engineer for a company called alias

28
00:00:58,480 --> 00:01:00,239
i've got 10 years of professional pent

29
00:01:00,239 --> 00:01:01,840
testing experience

30
00:01:01,840 --> 00:01:04,000
20 years of unprofessional unpaid

31
00:01:04,000 --> 00:01:05,280
fantastic experience

32
00:01:05,280 --> 00:01:07,040
i'm the lead engineer for pen testing

33
00:01:07,040 --> 00:01:08,400
and incident response

34
00:01:08,400 --> 00:01:12,560
as well as the other engineers

35
00:01:12,560 --> 00:01:14,720
so what is physical pen testing

36
00:01:14,720 --> 00:01:16,080
companies spend millions of dollars on

37
00:01:16,080 --> 00:01:17,920
cyber security but forget about physical

38
00:01:17,920 --> 00:01:18,960
security

39
00:01:18,960 --> 00:01:20,720
what i spend time finding a zero day

40
00:01:20,720 --> 00:01:22,080
when i can just walk in

41
00:01:22,080 --> 00:01:24,320
and get the proprietary data or

42
00:01:24,320 --> 00:01:27,200
intellectual property office system

43
00:01:27,200 --> 00:01:28,960
i feel like this comment kind of sums it

44
00:01:28,960 --> 00:01:30,240
up so

45
00:01:30,240 --> 00:01:31,759
this multi-million dollar computer to

46
00:01:31,759 --> 00:01:33,520
crack a password i'm like no just

47
00:01:33,520 --> 00:01:34,720
hit this guy with this five dollar

48
00:01:34,720 --> 00:01:36,880
wrench until he tells us the password

49
00:01:36,880 --> 00:01:39,200
so most people say it can't be that easy

50
00:01:39,200 --> 00:01:42,640
is literally that easy

51
00:01:45,439 --> 00:01:46,880
planning portion so you've got your

52
00:01:46,880 --> 00:01:48,880
recon creating an alias

53
00:01:48,880 --> 00:01:51,840
and then pre-texting for that alias and

54
00:01:51,840 --> 00:01:54,399
if you guys ever watch the a-team

55
00:01:54,399 --> 00:01:57,439
believe that's hannibal loves it when a

56
00:01:57,439 --> 00:02:00,398
plan comes together

57
00:02:05,680 --> 00:02:08,959
so the recon phase ocean's a super

58
00:02:08,959 --> 00:02:09,919
important tool

59
00:02:09,919 --> 00:02:11,520
so use the company's social media to

60
00:02:11,520 --> 00:02:13,280
determine the culture are they jeans

61
00:02:13,280 --> 00:02:15,599
culture are they suit and tie

62
00:02:15,599 --> 00:02:17,760
use a site like dns dumpster so you can

63
00:02:17,760 --> 00:02:19,920
learn what isps the company use

64
00:02:19,920 --> 00:02:21,120
in the event that you're going to come

65
00:02:21,120 --> 00:02:23,280
in as an isp tech you want to

66
00:02:23,280 --> 00:02:25,520
collect as many pictures as much info as

67
00:02:25,520 --> 00:02:26,400
possible

68
00:02:26,400 --> 00:02:28,160
so use google maps and street view to

69
00:02:28,160 --> 00:02:29,680
get an outside view without getting

70
00:02:29,680 --> 00:02:30,800
burned

71
00:02:30,800 --> 00:02:32,400
walk sister buildings determine the

72
00:02:32,400 --> 00:02:34,080
layout you should know the names in the

73
00:02:34,080 --> 00:02:36,000
face of the players who the secretary is

74
00:02:36,000 --> 00:02:36,720
the cio

75
00:02:36,720 --> 00:02:39,040
the important people know your ingress

76
00:02:39,040 --> 00:02:40,400
and egress points

77
00:02:40,400 --> 00:02:41,519
most importantly know where your

78
00:02:41,519 --> 00:02:43,599
bathrooms are the first thing you want

79
00:02:43,599 --> 00:02:45,280
to do when you get into a building

80
00:02:45,280 --> 00:02:47,120
just head to the bathroom take a chance

81
00:02:47,120 --> 00:02:48,400
to calm down

82
00:02:48,400 --> 00:02:51,360
recollect yourself get comfortable and

83
00:02:51,360 --> 00:02:52,080
then go back

84
00:02:52,080 --> 00:02:53,760
you can always use the bathroom as your

85
00:02:53,760 --> 00:02:54,879
safety net because no one's going to

86
00:02:54,879 --> 00:02:55,840
stop and ask you

87
00:02:55,840 --> 00:02:58,959
why are you in the bathroom

88
00:03:00,080 --> 00:03:02,159
so you should have a plan a plan b and

89
00:03:02,159 --> 00:03:04,000
plan c so i'm going to go on this

90
00:03:04,000 --> 00:03:06,080
door and if that doesn't work i'm going

91
00:03:06,080 --> 00:03:07,280
to this door

92
00:03:07,280 --> 00:03:08,800
it doesn't remove this door same thing

93
00:03:08,800 --> 00:03:11,040
with buildings this is my primary target

94
00:03:11,040 --> 00:03:12,879
my secondary target

95
00:03:12,879 --> 00:03:14,720
but don't be married to a plan don't get

96
00:03:14,720 --> 00:03:16,879
so caught up in the planning phase and

97
00:03:16,879 --> 00:03:19,120
knowing all the names and everything

98
00:03:19,120 --> 00:03:19,840
that

99
00:03:19,840 --> 00:03:22,080
you psych yourself out and you can't do

100
00:03:22,080 --> 00:03:23,599
your job and you just panic and

101
00:03:23,599 --> 00:03:26,400
run away so you should be efficient with

102
00:03:26,400 --> 00:03:27,920
all of your tools if you plan on using

103
00:03:27,920 --> 00:03:29,360
your gate tool and you find door to

104
00:03:29,360 --> 00:03:30,959
launches suck

105
00:03:30,959 --> 00:03:32,799
pivot over your under dwarf tool or

106
00:03:32,799 --> 00:03:34,159
figure out what's going to work when

107
00:03:34,159 --> 00:03:35,280
you're on site

108
00:03:35,280 --> 00:03:38,879
it may be all social engineering

109
00:03:41,680 --> 00:03:44,480
so creating an alias who are you so on

110
00:03:44,480 --> 00:03:45,680
the left hand side here

111
00:03:45,680 --> 00:03:46,640
i'm going to go ahead and critique

112
00:03:46,640 --> 00:03:48,959
myself a little bit this is for a

113
00:03:48,959 --> 00:03:50,080
chemical plant

114
00:03:50,080 --> 00:03:51,920
so what's wrong with the image if we

115
00:03:51,920 --> 00:03:53,519
start top to bottom

116
00:03:53,519 --> 00:03:56,560
look at my shiny new yellow helmet so

117
00:03:56,560 --> 00:03:58,159
you can see that any professional that

118
00:03:58,159 --> 00:03:59,280
works in the industry

119
00:03:59,280 --> 00:04:02,080
uses a white helmet glasses are brand

120
00:04:02,080 --> 00:04:02,720
new

121
00:04:02,720 --> 00:04:04,319
i'm wearing the proper fire resistant

122
00:04:04,319 --> 00:04:06,640
clothing but why am i wearing a collared

123
00:04:06,640 --> 00:04:07,760
shirt underneath

124
00:04:07,760 --> 00:04:08,959
while this engagement was still

125
00:04:08,959 --> 00:04:10,480
successful it's important to go back and

126
00:04:10,480 --> 00:04:11,599
critique yourself and

127
00:04:11,599 --> 00:04:14,959
understand the industry that

128
00:04:16,639 --> 00:04:18,720
so here's a better example of where i

129
00:04:18,720 --> 00:04:19,839
identified the av

130
00:04:19,839 --> 00:04:22,880
vendor i created a badge i've got a cell

131
00:04:22,880 --> 00:04:24,560
phone number that actually redirects to

132
00:04:24,560 --> 00:04:26,160
one of my teammates

133
00:04:26,160 --> 00:04:28,160
i have a fake email address not a

134
00:04:28,160 --> 00:04:30,400
lanyard everything's above board

135
00:04:30,400 --> 00:04:34,080
and really sold it if you think of

136
00:04:34,080 --> 00:04:36,639
a university i consider well i don't

137
00:04:36,639 --> 00:04:38,320
have all my pen testing tools on me when

138
00:04:38,320 --> 00:04:40,720
i'm breaking into a university

139
00:04:40,720 --> 00:04:42,800
but a backpack's not really out of place

140
00:04:42,800 --> 00:04:44,000
and that's something that i had to think

141
00:04:44,000 --> 00:04:46,240
about

142
00:04:48,560 --> 00:04:51,360
so put it uh hit your local thrift shop

143
00:04:51,360 --> 00:04:54,080
one closest to the place you're working

144
00:04:54,080 --> 00:04:56,240
they're gonna have your company shirts

145
00:04:56,240 --> 00:04:57,759
you can also get them off ebay and

146
00:04:57,759 --> 00:04:58,880
amazon

147
00:04:58,880 --> 00:05:00,800
but thrift store is great like if you

148
00:05:00,800 --> 00:05:02,720
want to have legitimacy to a disguise

149
00:05:02,720 --> 00:05:03,600
like

150
00:05:03,600 --> 00:05:05,440
who's going to have a shirt that says my

151
00:05:05,440 --> 00:05:06,800
company name barbecue

152
00:05:06,800 --> 00:05:09,520
2019 probably only an employee and if

153
00:05:09,520 --> 00:05:11,199
you know their t-shirts and jean culture

154
00:05:11,199 --> 00:05:13,280
you're going on a friday by all means

155
00:05:13,280 --> 00:05:16,239
use that to sell it

156
00:05:17,520 --> 00:05:20,000
pre-texting so who are you why are you

157
00:05:20,000 --> 00:05:21,360
there who you seeing

158
00:05:21,360 --> 00:05:24,320
who authorized you and what's your story

159
00:05:24,320 --> 00:05:26,080
so you want to create a story

160
00:05:26,080 --> 00:05:27,280
if you're going the whole social

161
00:05:27,280 --> 00:05:29,440
engineering route who are you there to

162
00:05:29,440 --> 00:05:30,000
see

163
00:05:30,000 --> 00:05:31,199
make sure you know the names and the

164
00:05:31,199 --> 00:05:32,960
faces so you don't want to tell them

165
00:05:32,960 --> 00:05:34,880
that you're there to see the cio

166
00:05:34,880 --> 00:05:36,560
and it turns out you're face-to-face the

167
00:05:36,560 --> 00:05:39,759
cio and he didn't authorize you

168
00:05:39,759 --> 00:05:41,600
you don't want your lies to fall apart

169
00:05:41,600 --> 00:05:42,800
in flight

170
00:05:42,800 --> 00:05:46,160
so if you're an rfid tech isp tech hvac

171
00:05:46,160 --> 00:05:48,720
building maintenance just make sure you

172
00:05:48,720 --> 00:05:50,240
know what you're doing so if you say

173
00:05:50,240 --> 00:05:52,080
you're a senior software developer you

174
00:05:52,080 --> 00:05:55,199
should be able to sell that

175
00:05:57,919 --> 00:06:00,720
and so here's an example of where i am

176
00:06:00,720 --> 00:06:01,199
an av

177
00:06:01,199 --> 00:06:03,680
technician so blanked out the customer

178
00:06:03,680 --> 00:06:04,319
information

179
00:06:04,319 --> 00:06:06,639
but what am i here to do i'm checking

180
00:06:06,639 --> 00:06:08,400
all the access control systems including

181
00:06:08,400 --> 00:06:09,759
the rfid

182
00:06:09,759 --> 00:06:11,840
and inspecting premises for proper door

183
00:06:11,840 --> 00:06:12,880
fitment

184
00:06:12,880 --> 00:06:14,639
so initially they tried to reach out to

185
00:06:14,639 --> 00:06:16,479
the contact and approve my work order

186
00:06:16,479 --> 00:06:18,479
and we got her information her signature

187
00:06:18,479 --> 00:06:21,360
from a phishing email

188
00:06:21,360 --> 00:06:22,639
they were validating they're trying to

189
00:06:22,639 --> 00:06:24,479
call her so i said hey while you guys

190
00:06:24,479 --> 00:06:25,600
are reaching out to her i'm just going

191
00:06:25,600 --> 00:06:27,039
to go ahead and do the outside

192
00:06:27,039 --> 00:06:28,880
so if you see a weird guy walking around

193
00:06:28,880 --> 00:06:30,800
trying to open doors and unlock them and

194
00:06:30,800 --> 00:06:31,520
whatnot

195
00:06:31,520 --> 00:06:34,639
that's just me just a heads up so i was

196
00:06:34,639 --> 00:06:35,759
completely able to walk around the

197
00:06:35,759 --> 00:06:37,199
building have no interactions with

198
00:06:37,199 --> 00:06:38,160
anyone

199
00:06:38,160 --> 00:06:40,639
outside because i had pre-texted and

200
00:06:40,639 --> 00:06:42,080
told them this is what i'm going to be

201
00:06:42,080 --> 00:06:42,880
doing

202
00:06:42,880 --> 00:06:44,880
you can take really obscure and strange

203
00:06:44,880 --> 00:06:47,280
behaviors and normalize them

204
00:06:47,280 --> 00:06:50,559
just by pre-texting

205
00:06:51,440 --> 00:06:53,680
so the tool is the trade it's not all

206
00:06:53,680 --> 00:06:55,199
locked

207
00:06:55,199 --> 00:06:57,199
there's lots of phone apps lots of

208
00:06:57,199 --> 00:06:58,319
physical tools

209
00:06:58,319 --> 00:07:00,160
i always tell the other engineers think

210
00:07:00,160 --> 00:07:02,000
more dumber

211
00:07:02,000 --> 00:07:04,080
as engineers we tend to over complicate

212
00:07:04,080 --> 00:07:05,759
problems we want to show off an awesome

213
00:07:05,759 --> 00:07:06,639
tool that

214
00:07:06,639 --> 00:07:09,440
maybe only a locksmith has access to but

215
00:07:09,440 --> 00:07:11,360
i think it's way better to show like i

216
00:07:11,360 --> 00:07:13,120
opened this door with a fly swatter i

217
00:07:13,120 --> 00:07:15,280
found the receptionist desk

218
00:07:15,280 --> 00:07:17,120
it's good to show high impact attacks

219
00:07:17,120 --> 00:07:19,120
but for the most part you want your

220
00:07:19,120 --> 00:07:21,680
attacks to fall in that 90

221
00:07:21,680 --> 00:07:23,759
and not that top 10 percent of not

222
00:07:23,759 --> 00:07:25,199
feasible

223
00:07:25,199 --> 00:07:26,800
looking at the tools here you've got a

224
00:07:26,800 --> 00:07:29,199
push tool the gate tool which is one of

225
00:07:29,199 --> 00:07:30,080
my favorites

226
00:07:30,080 --> 00:07:31,599
and if you don't have the gate tool on a

227
00:07:31,599 --> 00:07:34,639
pinch you can use a contractor square

228
00:07:34,639 --> 00:07:37,520
the under door tool this is a thumb turn

229
00:07:37,520 --> 00:07:39,759
tool or the california tool we'll talk

230
00:07:39,759 --> 00:07:41,280
about that later

231
00:07:41,280 --> 00:07:44,080
the double door tool exploits gap and

232
00:07:44,080 --> 00:07:45,759
double doors

233
00:07:45,759 --> 00:07:47,599
we'll talk about the airbags later and

234
00:07:47,599 --> 00:07:49,280
how they can be used to manipulate door

235
00:07:49,280 --> 00:07:50,000
fitment

236
00:07:50,000 --> 00:07:58,639
and then a boroscope

237
00:07:58,639 --> 00:08:02,080
talk about my edc from the top we've got

238
00:08:02,080 --> 00:08:02,479
the

239
00:08:02,479 --> 00:08:05,440
covert companion from covert instruments

240
00:08:05,440 --> 00:08:07,039
this has your traveler hooks your

241
00:08:07,039 --> 00:08:08,479
jigglers

242
00:08:08,479 --> 00:08:11,520
come picks some some rakes and then some

243
00:08:11,520 --> 00:08:12,160
word

244
00:08:12,160 --> 00:08:17,039
uh word picks that's always in my bag

245
00:08:17,039 --> 00:08:18,879
also from code instruments is this bag

246
00:08:18,879 --> 00:08:20,720
of openings so these are your five most

247
00:08:20,720 --> 00:08:22,160
common keys you're going to see

248
00:08:22,160 --> 00:08:23,840
and i've added a couple you've got your

249
00:08:23,840 --> 00:08:26,680
door king your linear keys

250
00:08:26,680 --> 00:08:29,919
ch751 126a

251
00:08:29,919 --> 00:08:32,240
your ford fleet key i never got to use

252
00:08:32,240 --> 00:08:34,320
it but i'm keeping on my key ring and

253
00:08:34,320 --> 00:08:37,039
holding on hope

254
00:08:37,039 --> 00:08:40,080
for rfid cloning don't over complicate

255
00:08:40,080 --> 00:08:41,919
it get the keys

256
00:08:41,919 --> 00:08:43,839
you don't need to build a hot pad you

257
00:08:43,839 --> 00:08:45,360
can but

258
00:08:45,360 --> 00:08:46,880
you can get your hands on a badge try

259
00:08:46,880 --> 00:08:49,279
this first always work easy and then

260
00:08:49,279 --> 00:08:50,959
work your way up to more complicated

261
00:08:50,959 --> 00:08:52,560
attacks

262
00:08:52,560 --> 00:08:55,200
this is the tuxedo from sparrows that

263
00:08:55,200 --> 00:08:57,279
have included some chrome picks here

264
00:08:57,279 --> 00:08:59,600
you have your nfc tags so at the height

265
00:08:59,600 --> 00:09:00,640
of the pandemic

266
00:09:00,640 --> 00:09:02,560
we found that people started using qr

267
00:09:02,560 --> 00:09:04,560
codes and with apps on our phone we

268
00:09:04,560 --> 00:09:06,720
could program these nfc tags

269
00:09:06,720 --> 00:09:08,480
stick them behind the qr code and then

270
00:09:08,480 --> 00:09:11,040
color out the qr code so it doesn't work

271
00:09:11,040 --> 00:09:14,399
and create an easy fishing site

272
00:09:14,399 --> 00:09:16,720
you have the shark jack so when we

273
00:09:16,720 --> 00:09:17,440
actually need to show

274
00:09:17,440 --> 00:09:19,040
impact actually physically gotten in

275
00:09:19,040 --> 00:09:22,480
this is a shark jack from hack five

276
00:09:22,480 --> 00:09:24,640
so once again i throw an army mode plug

277
00:09:24,640 --> 00:09:26,320
in leave it run for 10 minutes

278
00:09:26,320 --> 00:09:28,880
grab a hash walk out and leave the

279
00:09:28,880 --> 00:09:30,560
sparrows quick gym

280
00:09:30,560 --> 00:09:32,880
this is just for loiting doors and

281
00:09:32,880 --> 00:09:34,640
honestly i went with this because i was

282
00:09:34,640 --> 00:09:36,080
tired of cutting up my hands

283
00:09:36,080 --> 00:09:37,600
so i just needed a convenient little

284
00:09:37,600 --> 00:09:39,279
package i could throw it in

285
00:09:39,279 --> 00:09:41,440
you can cut out a milk carton cd any

286
00:09:41,440 --> 00:09:43,519
hard plastic blister pack

287
00:09:43,519 --> 00:09:44,490
can do everything you need

288
00:09:44,490 --> 00:09:47,580
[Music]

289
00:09:49,120 --> 00:09:51,360
so phone apps you've got the hd wi-fi

290
00:09:51,360 --> 00:09:53,279
that's for the borescope

291
00:09:53,279 --> 00:09:56,640
keep that the burner and spoof card app

292
00:09:56,640 --> 00:09:58,480
so the burner app will let you create

293
00:09:58,480 --> 00:09:59,760
phone numbers

294
00:09:59,760 --> 00:10:02,079
and you can create burner phone lines

295
00:10:02,079 --> 00:10:03,440
and then the spoof card app will

296
00:10:03,440 --> 00:10:04,000
actually

297
00:10:04,000 --> 00:10:06,240
spoof phone numbers text messages and

298
00:10:06,240 --> 00:10:07,920
caller id

299
00:10:07,920 --> 00:10:09,519
so on an engagement with a data center

300
00:10:09,519 --> 00:10:11,279
where you had to have pre-authorization

301
00:10:11,279 --> 00:10:13,519
the night before i called ahead using

302
00:10:13,519 --> 00:10:15,200
the name and the phone number of the

303
00:10:15,200 --> 00:10:15,920
client

304
00:10:15,920 --> 00:10:18,000
i was able to put myself on the list as

305
00:10:18,000 --> 00:10:19,839
an auditor and as an auditor that means

306
00:10:19,839 --> 00:10:21,200
we're gonna roll out the red carpet

307
00:10:21,200 --> 00:10:21,680
we're gonna

308
00:10:21,680 --> 00:10:24,240
unlock everything for you uh the company

309
00:10:24,240 --> 00:10:25,839
was completely unaware that

310
00:10:25,839 --> 00:10:27,279
we were actually doing a physical

311
00:10:27,279 --> 00:10:29,680
security audit and that i wasn't who i

312
00:10:29,680 --> 00:10:32,000
said i was they took me at face value

313
00:10:32,000 --> 00:10:33,400
and didn't do any validation

314
00:10:33,400 --> 00:10:35,760
[Music]

315
00:10:35,760 --> 00:10:37,839
the nfc tools that's what we use to

316
00:10:37,839 --> 00:10:38,959
program those nfc

317
00:10:38,959 --> 00:10:42,320
tags wi-fi sweet spots

318
00:10:42,320 --> 00:10:43,680
most of us will fall back on our career

319
00:10:43,680 --> 00:10:46,160
at iit so if you need a reason to wander

320
00:10:46,160 --> 00:10:46,480
around

321
00:10:46,480 --> 00:10:49,360
like an idiot have that up the app it'll

322
00:10:49,360 --> 00:10:51,200
show you wi-fi signal and you can walk

323
00:10:51,200 --> 00:10:52,720
around and stare at the ceiling looking

324
00:10:52,720 --> 00:10:54,320
at wireless access points

325
00:10:54,320 --> 00:10:56,000
usually no one's going to stop the it

326
00:10:56,000 --> 00:10:58,079
guy

327
00:10:58,079 --> 00:11:01,120
instacode this is a an app for locksmith

328
00:11:01,120 --> 00:11:01,519
i

329
00:11:01,519 --> 00:11:03,279
just recently in the last year started

330
00:11:03,279 --> 00:11:05,920
using this i didn't realize the value of

331
00:11:05,920 --> 00:11:06,880
it until i actually

332
00:11:06,880 --> 00:11:10,320
dug in and started playing with it

333
00:11:13,440 --> 00:11:16,160
so cloning keys and here's the spoof

334
00:11:16,160 --> 00:11:18,480
card for playing numbers

335
00:11:18,480 --> 00:11:20,800
so here's the instacart app uh you can

336
00:11:20,800 --> 00:11:24,320
actually use this to clone a key

337
00:11:24,320 --> 00:11:25,920
this will give you the you know the

338
00:11:25,920 --> 00:11:28,160
manufacturer and series

339
00:11:28,160 --> 00:11:31,519
you get all the cutting depths

340
00:11:35,360 --> 00:11:38,320
so here's a really fun practice of

341
00:11:38,320 --> 00:11:39,519
cloning key

342
00:11:39,519 --> 00:11:41,360
so you use what you have available

343
00:11:41,360 --> 00:11:43,680
instead of

344
00:11:43,680 --> 00:11:46,720
studying a key or trying to cast one in

345
00:11:46,720 --> 00:11:47,600
lead

346
00:11:47,600 --> 00:11:49,760
instead just color with a sharpie throw

347
00:11:49,760 --> 00:11:50,720
some tape on it

348
00:11:50,720 --> 00:11:53,519
and put it on a business card if it's a

349
00:11:53,519 --> 00:11:55,279
dumb wafer lock it's

350
00:11:55,279 --> 00:11:59,360
pretty apparent it's going to work

351
00:12:01,600 --> 00:12:04,000
clearly that never work right

352
00:12:04,000 --> 00:12:05,440
unfortunately it did

353
00:12:05,440 --> 00:12:08,880
so another chemical plant this poor lock

354
00:12:08,880 --> 00:12:10,800
box that we have here contains

355
00:12:10,800 --> 00:12:12,480
all the keys of the facility so it's

356
00:12:12,480 --> 00:12:14,880
nasa apple and cement co-locks

357
00:12:14,880 --> 00:12:16,480
uh this is by the receptionist desk

358
00:12:16,480 --> 00:12:18,399
though so after we hit the request

359
00:12:18,399 --> 00:12:20,800
exit sensor with compressed air where

360
00:12:20,800 --> 00:12:22,480
we'll get access to the lobby

361
00:12:22,480 --> 00:12:24,720
we didn't have a physical key but if you

362
00:12:24,720 --> 00:12:26,880
zoom in on the actual lock body

363
00:12:26,880 --> 00:12:30,240
it says jc 31 so

364
00:12:30,240 --> 00:12:33,200
uh google search lets me know well jc31

365
00:12:33,200 --> 00:12:35,519
is a default key

366
00:12:35,519 --> 00:12:37,920
i plug that into instacode and google i

367
00:12:37,920 --> 00:12:39,680
can get the key profile

368
00:12:39,680 --> 00:12:42,560
use calipers and who has the lunch i was

369
00:12:42,560 --> 00:12:44,320
able to

370
00:12:44,320 --> 00:12:45,839
throw double sided tape on a business

371
00:12:45,839 --> 00:12:47,680
card cut out the card

372
00:12:47,680 --> 00:12:50,399
come back and unlock it well i showed

373
00:12:50,399 --> 00:12:51,760
the customer that the key was readily

374
00:12:51,760 --> 00:12:53,040
available online

375
00:12:53,040 --> 00:12:54,880
i just got to take it a step further and

376
00:12:54,880 --> 00:12:56,320
take that from

377
00:12:56,320 --> 00:13:00,800
a kind of lame attack to elite attack

378
00:13:03,600 --> 00:13:06,560
airbags so this one was a happy little

379
00:13:06,560 --> 00:13:07,519
accident

380
00:13:07,519 --> 00:13:09,120
i was attempting to use airbags to

381
00:13:09,120 --> 00:13:11,040
create space to actually hit this

382
00:13:11,040 --> 00:13:12,959
requested exit sensor with my under door

383
00:13:12,959 --> 00:13:13,760
tool

384
00:13:13,760 --> 00:13:15,600
that says request exit button my under

385
00:13:15,600 --> 00:13:18,000
door tool uh so imagine my surprise and

386
00:13:18,000 --> 00:13:18,800
the door just

387
00:13:18,800 --> 00:13:21,680
popped open and the magnet holding open

388
00:13:21,680 --> 00:13:22,399
wasn't

389
00:13:22,399 --> 00:13:25,440
strong enough for the

390
00:13:25,760 --> 00:13:29,120
for the door so surely that worked once

391
00:13:29,120 --> 00:13:29,760
but

392
00:13:29,760 --> 00:13:32,839
there's no way that would happen twice

393
00:13:32,839 --> 00:13:35,680
right

394
00:13:35,680 --> 00:13:37,519
so once we got inside i found the data

395
00:13:37,519 --> 00:13:41,040
center we couldn't go over or under

396
00:13:41,040 --> 00:13:44,240
and it was rfid locked so i figured i

397
00:13:44,240 --> 00:13:48,240
would cram the airbags in

398
00:13:48,240 --> 00:13:49,839
so i'm going to get them as close to the

399
00:13:49,839 --> 00:13:51,760
lock as possible you can see there's no

400
00:13:51,760 --> 00:13:53,279
latch on this door so it's got to be

401
00:13:53,279 --> 00:14:03,839
hard if i need control

402
00:14:05,279 --> 00:14:07,440
so if i pause here for a minute this is

403
00:14:07,440 --> 00:14:09,120
actually your most important tool

404
00:14:09,120 --> 00:14:11,279
your get out of jail free card is what's

405
00:14:11,279 --> 00:14:12,399
going to keep you from knowing the

406
00:14:12,399 --> 00:14:13,519
handcuffs

407
00:14:13,519 --> 00:14:15,680
so make sure that that's always on you i

408
00:14:15,680 --> 00:14:17,519
keep my back right pocket with the

409
00:14:17,519 --> 00:14:18,399
signature

410
00:14:18,399 --> 00:14:20,480
ready to be pulled out and ready to be

411
00:14:20,480 --> 00:14:21,839
easily shown

412
00:14:21,839 --> 00:14:25,839
but back to the video we air up the bags

413
00:14:25,839 --> 00:14:27,600
and originally you can hear us laughing

414
00:14:27,600 --> 00:14:29,040
and you can hear the door creaking a

415
00:14:29,040 --> 00:14:30,240
little bit

416
00:14:30,240 --> 00:14:32,240
there's no real damage that i found from

417
00:14:32,240 --> 00:14:34,480
this so no more further issues

418
00:14:34,480 --> 00:14:36,160
last bit is push your foot along the

419
00:14:36,160 --> 00:14:45,839
bottom and you're inside

420
00:14:50,000 --> 00:14:53,839
so rfid cloning got access to a badge

421
00:14:53,839 --> 00:14:56,880
use the key so here's an example of a

422
00:14:56,880 --> 00:15:00,639
badge that well it doesn't work

423
00:15:05,839 --> 00:15:13,680
but just like that using the keys

424
00:15:13,680 --> 00:15:16,639
all right 35 millimeter film so there's

425
00:15:16,639 --> 00:15:18,000
a term in lock picking called

426
00:15:18,000 --> 00:15:20,399
loiting as from the days of using

427
00:15:20,399 --> 00:15:22,320
celluloid to open doors to celluloid

428
00:15:22,320 --> 00:15:23,519
film

429
00:15:23,519 --> 00:15:25,760
so here's 35 millimeter film this one's

430
00:15:25,760 --> 00:15:26,800
purposely bent

431
00:15:26,800 --> 00:15:28,720
but you can also use it to go over the

432
00:15:28,720 --> 00:15:31,040
door

433
00:15:37,440 --> 00:15:41,839
i'll show you guys an example of that

434
00:15:49,519 --> 00:15:52,399
so come through too much gap in this

435
00:15:52,399 --> 00:15:53,279
door

436
00:15:53,279 --> 00:15:56,399
down grab the latch

437
00:15:56,399 --> 00:16:09,839
pull it and it's open

438
00:16:09,839 --> 00:16:12,399
found keys so why try to exploit a door

439
00:16:12,399 --> 00:16:13,920
when you can literally just take the

440
00:16:13,920 --> 00:16:15,040
keys

441
00:16:15,040 --> 00:16:16,480
keys are in common places they're

442
00:16:16,480 --> 00:16:18,639
normally labeled if not

443
00:16:18,639 --> 00:16:20,320
you can kind of take a guess of what

444
00:16:20,320 --> 00:16:22,800
they might be to but always look out for

445
00:16:22,800 --> 00:16:25,120
keys

446
00:16:26,160 --> 00:16:29,040
lock picking so this never works on

447
00:16:29,040 --> 00:16:29,920
engagements

448
00:16:29,920 --> 00:16:32,160
never ever pick a lock on engagement

449
00:16:32,160 --> 00:16:34,839
unless it's your absolute last

450
00:16:34,839 --> 00:16:37,120
choice

451
00:16:37,120 --> 00:16:38,320
blocks are going to be difficult to

452
00:16:38,320 --> 00:16:39,759
begin with you're looking at acid

453
00:16:39,759 --> 00:16:40,639
abloy's

454
00:16:40,639 --> 00:16:44,160
best medcos even a master key system

455
00:16:44,160 --> 00:16:45,920
while the wafers will make it easier

456
00:16:45,920 --> 00:16:47,120
you're still not going to have great

457
00:16:47,120 --> 00:16:48,839
luck and the added adrenaline and

458
00:16:48,839 --> 00:16:50,000
pressure it's going to make it difficult

459
00:16:50,000 --> 00:16:51,759
so unless you're regularly practicing

460
00:16:51,759 --> 00:16:52,720
your craft

461
00:16:52,720 --> 00:16:56,480
i don't recommend trying all the human

462
00:17:02,839 --> 00:17:05,839
engagements

463
00:17:07,439 --> 00:17:09,359
so that being said sometimes lockpicking

464
00:17:09,359 --> 00:17:10,880
is your only choice

465
00:17:10,880 --> 00:17:13,280
so this is the deadbolted door the

466
00:17:13,280 --> 00:17:16,400
magnetic strike isn't in place

467
00:17:16,400 --> 00:17:19,839
but we can pick the lock

468
00:17:19,839 --> 00:17:21,119
so after a little bit of work and a

469
00:17:21,119 --> 00:17:22,559
little bit of finessing we're able to

470
00:17:22,559 --> 00:17:24,319
break in that way

471
00:17:24,319 --> 00:17:28,559
but again always the last choice

472
00:17:31,120 --> 00:17:34,000
so field tools if you're playing the

473
00:17:34,000 --> 00:17:34,400
part

474
00:17:34,400 --> 00:17:38,559
of an rfid tech well have a clipboard

475
00:17:38,559 --> 00:17:40,720
but you can see the tools that i have uh

476
00:17:40,720 --> 00:17:42,640
doing pre-recon ahead of time

477
00:17:42,640 --> 00:17:44,799
i knew that there were some doors that i

478
00:17:44,799 --> 00:17:47,200
could use my j tool on

479
00:17:47,200 --> 00:17:48,880
have a screwdriver to look for the part

480
00:17:48,880 --> 00:17:51,120
as well as this film this is good for

481
00:17:51,120 --> 00:17:53,520
loading as well as pretending to check

482
00:17:53,520 --> 00:17:55,919
the gap in rfid sensors

483
00:17:55,919 --> 00:17:58,559
uh gate bypass tool just looks cheap but

484
00:17:58,559 --> 00:18:01,840
it could also be a ruler

485
00:18:03,520 --> 00:18:04,960
but use the information you learned in

486
00:18:04,960 --> 00:18:07,280
the recon phase to create a proper

487
00:18:07,280 --> 00:18:07,919
persona

488
00:18:07,919 --> 00:18:11,840
as well as having those tools on you

489
00:18:12,799 --> 00:18:15,919
the gate tool for latch slipping gate

490
00:18:15,919 --> 00:18:17,679
tool is going to be by far my favorite

491
00:18:17,679 --> 00:18:18,480
tool

492
00:18:18,480 --> 00:18:21,280
and then the wallet size pocket version

493
00:18:21,280 --> 00:18:24,720
is the sparrows hall pass

494
00:18:27,440 --> 00:18:30,400
when you have our uh when you have

495
00:18:30,400 --> 00:18:31,760
electronic strikes

496
00:18:31,760 --> 00:18:34,160
on doors these will almost always get

497
00:18:34,160 --> 00:18:35,039
you in

498
00:18:35,039 --> 00:18:36,559
and there are very few instances that

499
00:18:36,559 --> 00:18:38,400
i've had where the gate tool

500
00:18:38,400 --> 00:18:43,840
didn't do everything i needed

501
00:18:46,000 --> 00:18:48,960
so you come to the door

502
00:18:51,600 --> 00:18:54,719
slip this behind the latch

503
00:18:55,200 --> 00:18:56,799
and grab the latch there so the door's

504
00:18:56,799 --> 00:19:11,840
not open there

505
00:19:13,760 --> 00:19:16,160
okay so let's talk about exploiting

506
00:19:16,160 --> 00:19:17,120
doors

507
00:19:17,120 --> 00:19:18,480
these are the doors that you're going to

508
00:19:18,480 --> 00:19:20,720
see in corporate environments

509
00:19:20,720 --> 00:19:23,520
either a double door or a single door

510
00:19:23,520 --> 00:19:24,480
and the door is either

511
00:19:24,480 --> 00:19:26,799
mounted on this side of the frame or the

512
00:19:26,799 --> 00:19:28,640
other side of the frame

513
00:19:28,640 --> 00:19:30,880
but let's break down the anatomy of the

514
00:19:30,880 --> 00:19:32,880
door if you think about the door

515
00:19:32,880 --> 00:19:35,840
like you would as a pen tester they're

516
00:19:35,840 --> 00:19:37,520
really like four sides

517
00:19:37,520 --> 00:19:41,440
you've got top bottom hinge and latch

518
00:19:41,440 --> 00:19:43,200
so the hinges they can be if they're

519
00:19:43,200 --> 00:19:45,120
exposed like they are on this

520
00:19:45,120 --> 00:19:47,520
image the pens can be knocked out the

521
00:19:47,520 --> 00:19:49,200
door can be walked away from the frame

522
00:19:49,200 --> 00:19:51,919
if there are security pins i'm never

523
00:19:51,919 --> 00:19:53,280
going to walk the door away from the

524
00:19:53,280 --> 00:19:54,640
frame or knockout

525
00:19:54,640 --> 00:19:56,240
hinge pins on an engagement i just

526
00:19:56,240 --> 00:19:58,400
haven't run into an issue where

527
00:19:58,400 --> 00:20:01,520
that was going to be the resolution so

528
00:20:01,520 --> 00:20:03,280
from the bottom and under your door tool

529
00:20:03,280 --> 00:20:05,679
i vastly underestimated this tool

530
00:20:05,679 --> 00:20:08,400
early on in my career i made heavily on

531
00:20:08,400 --> 00:20:09,280
the gate tool

532
00:20:09,280 --> 00:20:10,880
and so i found in a lot of corporate

533
00:20:10,880 --> 00:20:13,120
environments there is a gigantic gap

534
00:20:13,120 --> 00:20:14,080
under the door

535
00:20:14,080 --> 00:20:16,240
and fire code requires these leather

536
00:20:16,240 --> 00:20:17,520
locks

537
00:20:17,520 --> 00:20:18,880
so i could reach underneath the under

538
00:20:18,880 --> 00:20:20,240
door tool and pop every door in a

539
00:20:20,240 --> 00:20:21,520
facility

540
00:20:21,520 --> 00:20:24,640
with ease extremely fast

541
00:20:24,640 --> 00:20:27,520
so from the top there's an over door

542
00:20:27,520 --> 00:20:28,559
attack where you use

543
00:20:28,559 --> 00:20:31,200
film to push through the gap these

544
00:20:31,200 --> 00:20:32,880
frames make it a little harder

545
00:20:32,880 --> 00:20:35,360
but you can also think of going over the

546
00:20:35,360 --> 00:20:36,799
top of the wall

547
00:20:36,799 --> 00:20:39,039
and pushing up the ceiling tiles and

548
00:20:39,039 --> 00:20:40,640
then attacking the film

549
00:20:40,640 --> 00:20:42,720
carry 12 to 15 feet of film it's super

550
00:20:42,720 --> 00:20:44,320
cheap

551
00:20:44,320 --> 00:20:46,799
the last side is going to be your most

552
00:20:46,799 --> 00:20:48,400
common attack surface

553
00:20:48,400 --> 00:20:50,000
you're going to be exploiting the lock

554
00:20:50,000 --> 00:20:52,480
up between the latch and the frame

555
00:20:52,480 --> 00:20:56,000
so if the latch is visible use a push

556
00:20:56,000 --> 00:20:56,640
tool

557
00:20:56,640 --> 00:20:59,600
if the latch is shielded use a gate if

558
00:20:59,600 --> 00:21:00,960
the door is properly hung

559
00:21:00,960 --> 00:21:02,960
and the dead latch is engaged preventing

560
00:21:02,960 --> 00:21:04,799
the latch from actually moving

561
00:21:04,799 --> 00:21:07,360
then use airbags we're gonna use airbags

562
00:21:07,360 --> 00:21:08,720
to exploit the gap

563
00:21:08,720 --> 00:21:11,200
indoors and then consider alternate

564
00:21:11,200 --> 00:21:12,240
routes so

565
00:21:12,240 --> 00:21:15,440
drop ceilings raised floors so can you

566
00:21:15,440 --> 00:21:16,559
go over the door

567
00:21:16,559 --> 00:21:20,879
or under the door what's easier

568
00:21:23,360 --> 00:21:26,080
attacking impossible doors so let's say

569
00:21:26,080 --> 00:21:27,039
that you have a

570
00:21:27,039 --> 00:21:29,840
well-hung door and a facility and

571
00:21:29,840 --> 00:21:31,600
there's no real way around it

572
00:21:31,600 --> 00:21:34,159
right we can't see the latch so we can't

573
00:21:34,159 --> 00:21:36,080
attack it

574
00:21:36,080 --> 00:21:38,880
i'm not seeing rfid on this side can't

575
00:21:38,880 --> 00:21:41,120
go under the door or over the door

576
00:21:41,120 --> 00:21:42,559
this is where your specialty tools are

577
00:21:42,559 --> 00:21:45,440
going to come in so latch needles

578
00:21:45,440 --> 00:21:47,200
these will actually be used to slip into

579
00:21:47,200 --> 00:21:49,280
this gap and then push the striker on

580
00:21:49,280 --> 00:21:51,039
the door

581
00:21:51,039 --> 00:21:52,960
and the last spatula is actually slid in

582
00:21:52,960 --> 00:21:54,960
from the bottom

583
00:21:54,960 --> 00:21:58,240
to latch slip

584
00:21:58,240 --> 00:21:59,679
and this is an instance of using a

585
00:21:59,679 --> 00:22:02,000
specialized tool to exploit a known

586
00:22:02,000 --> 00:22:04,480
weakness

587
00:22:07,280 --> 00:22:09,840
so how will we attack this door right

588
00:22:09,840 --> 00:22:11,120
off the bat

589
00:22:11,120 --> 00:22:12,640
look up here at the top there's a

590
00:22:12,640 --> 00:22:15,280
carriage bolt that's holding a magnetic

591
00:22:15,280 --> 00:22:17,840
plate in that's holding the door closed

592
00:22:17,840 --> 00:22:20,799
but on this side there's nothing so this

593
00:22:20,799 --> 00:22:22,480
is where we use the j tool

594
00:22:22,480 --> 00:22:25,200
to actually come in the thumb turn and

595
00:22:25,200 --> 00:22:28,159
unlock this door

596
00:22:32,640 --> 00:22:34,720
okay so how do we attack this on the

597
00:22:34,720 --> 00:22:36,880
left

598
00:22:36,880 --> 00:22:39,280
you can see the latch is exposed it

599
00:22:39,280 --> 00:22:40,000
doesn't look well

600
00:22:40,000 --> 00:22:42,559
hung you could do an under door tool but

601
00:22:42,559 --> 00:22:43,919
let's ignore that

602
00:22:43,919 --> 00:22:46,159
but that's also an option the hinges are

603
00:22:46,159 --> 00:22:48,559
also exposed

604
00:22:48,559 --> 00:22:50,960
which could be knocked out and walked

605
00:22:50,960 --> 00:22:53,760
away and it's a glass door

606
00:22:53,760 --> 00:22:57,360
if anything it could just be broken

607
00:22:57,600 --> 00:23:00,480
so this second door is a little more

608
00:23:00,480 --> 00:23:02,320
well secured still a glass door still

609
00:23:02,320 --> 00:23:03,280
easy to go through

610
00:23:03,280 --> 00:23:05,679
can't go out with hinges under door tool

611
00:23:05,679 --> 00:23:06,880
of course

612
00:23:06,880 --> 00:23:08,400
you definitely don't want to pick two

613
00:23:08,400 --> 00:23:10,080
locks so this is where your

614
00:23:10,080 --> 00:23:11,919
latch needles or your spatula will come

615
00:23:11,919 --> 00:23:14,400
into play

616
00:23:18,480 --> 00:23:21,280
so how do we attack this door you can

617
00:23:21,280 --> 00:23:22,000
try to brute force

618
00:23:22,000 --> 00:23:23,919
the combination you look for known

619
00:23:23,919 --> 00:23:25,679
weaknesses in that combination style

620
00:23:25,679 --> 00:23:26,960
walk

621
00:23:26,960 --> 00:23:29,280
the hinges are exposed the latch is

622
00:23:29,280 --> 00:23:30,320
exposed but

623
00:23:30,320 --> 00:23:31,440
let's say that you're just trying to

624
00:23:31,440 --> 00:23:33,520
show impact the customer and you've

625
00:23:33,520 --> 00:23:35,039
already latch flipped and

626
00:23:35,039 --> 00:23:36,559
worked on hinges and exploited these

627
00:23:36,559 --> 00:23:39,440
locks well what's this

628
00:23:39,440 --> 00:23:40,880
the customer used to have a deadbolt on

629
00:23:40,880 --> 00:23:43,360
this lock and they just replaced it with

630
00:23:43,360 --> 00:23:44,720
this jeep screw in

631
00:23:44,720 --> 00:23:46,000
so a little bit of pressure while

632
00:23:46,000 --> 00:23:47,200
pulling that out you can actually

633
00:23:47,200 --> 00:23:48,400
unscrew that

634
00:23:48,400 --> 00:23:50,320
and create a gap big enough to slip film

635
00:23:50,320 --> 00:23:51,520
through and then

636
00:23:51,520 --> 00:23:55,120
grab the latch in the backing side

637
00:23:57,760 --> 00:24:01,760
but when in doubt just go around

638
00:24:02,640 --> 00:24:04,000
this is where that pre-planning comes in

639
00:24:04,000 --> 00:24:06,720
handy where recon comes in handy

640
00:24:06,720 --> 00:24:08,080
and we're just looking for alternate

641
00:24:08,080 --> 00:24:11,120
routes to help look for fire maps

642
00:24:11,120 --> 00:24:14,000
look for building maps a lot of security

643
00:24:14,000 --> 00:24:15,679
areas have attached bathrooms because

644
00:24:15,679 --> 00:24:17,120
they don't want to create another set

645
00:24:17,120 --> 00:24:19,120
so you can walk straight into the

646
00:24:19,120 --> 00:24:23,279
bathroom and then out into a secure area

647
00:24:23,279 --> 00:24:25,200
and so one of the great examples of this

648
00:24:25,200 --> 00:24:26,960
from our team was a bank assessment we

649
00:24:26,960 --> 00:24:28,000
were working on

650
00:24:28,000 --> 00:24:30,640
they had biometric thumbprint locks

651
00:24:30,640 --> 00:24:32,320
there was no way we're getting a secure

652
00:24:32,320 --> 00:24:33,360
area

653
00:24:33,360 --> 00:24:35,360
but we walked into their overflow

654
00:24:35,360 --> 00:24:36,960
activity space that they bought

655
00:24:36,960 --> 00:24:38,640
and there's a kitchen and in the kitchen

656
00:24:38,640 --> 00:24:40,640
there's a pantry so i open the door to

657
00:24:40,640 --> 00:24:42,480
the pantry and i find

658
00:24:42,480 --> 00:24:44,000
this door which is the door to their

659
00:24:44,000 --> 00:24:46,320
store room and right over here directly

660
00:24:46,320 --> 00:24:47,840
connected to that store room with an

661
00:24:47,840 --> 00:24:49,279
unlocked door is their secure

662
00:24:49,279 --> 00:24:53,200
area so instead of trying to bypass

663
00:24:53,200 --> 00:24:56,080
super complicated locks or knobs or

664
00:24:56,080 --> 00:24:57,200
thumb print

665
00:24:57,200 --> 00:24:59,440
i was able just to walk around and no

666
00:24:59,440 --> 00:25:01,120
suspicion because i was in a low traffic

667
00:25:01,120 --> 00:25:02,799
area versus trying to use an underdoor

668
00:25:02,799 --> 00:25:03,440
tool

669
00:25:03,440 --> 00:25:07,039
in an area that was well trafficked

670
00:25:10,559 --> 00:25:13,600
so access control

671
00:25:13,600 --> 00:25:15,200
what you're most commonly going to see

672
00:25:15,200 --> 00:25:18,640
going to be your magnetic locks

673
00:25:18,640 --> 00:25:21,919
and your electronic strikes

674
00:25:22,240 --> 00:25:24,400
so you can see your protection here see

675
00:25:24,400 --> 00:25:25,600
a hidden reader

676
00:25:25,600 --> 00:25:28,720
and you see an unshielded contact

677
00:25:28,720 --> 00:25:30,720
so a firefighter if you're allowed to do

678
00:25:30,720 --> 00:25:32,000
destructive entry

679
00:25:32,000 --> 00:25:33,760
just punches these out with halogens

680
00:25:33,760 --> 00:25:35,679
hole and the door comes right off

681
00:25:35,679 --> 00:25:37,440
but we've got to be a little better than

682
00:25:37,440 --> 00:25:39,279
that so we couldn't really use a lash

683
00:25:39,279 --> 00:25:40,720
spool here

684
00:25:40,720 --> 00:25:42,960
because this is likely a dead bolt so

685
00:25:42,960 --> 00:25:44,640
that's going to be a picking attack

686
00:25:44,640 --> 00:25:46,640
this could be last flipped but health is

687
00:25:46,640 --> 00:25:48,240
a dead bull box

688
00:25:48,240 --> 00:25:50,159
and then here's an rfid reader that's

689
00:25:50,159 --> 00:25:51,900
just left out on the outside of the

690
00:25:51,900 --> 00:25:54,840
[Music]

691
00:25:54,840 --> 00:25:57,840
building

692
00:25:59,120 --> 00:26:01,360
so access control attacks we're looking

693
00:26:01,360 --> 00:26:02,400
at the

694
00:26:02,400 --> 00:26:04,000
locking mechanism of the mechanism

695
00:26:04,000 --> 00:26:05,919
keeping the door closed attacking the

696
00:26:05,919 --> 00:26:06,880
reader

697
00:26:06,880 --> 00:26:08,960
the request to exit sensors and buttons

698
00:26:08,960 --> 00:26:11,440
and the controllers

699
00:26:11,440 --> 00:26:12,640
so the first part is going to be the

700
00:26:12,640 --> 00:26:14,240
lock whether it be a magnetic an

701
00:26:14,240 --> 00:26:16,799
electronic block

702
00:26:16,799 --> 00:26:20,159
then we'll have our readers and then our

703
00:26:20,159 --> 00:26:21,760
request to exit so this is going to be a

704
00:26:21,760 --> 00:26:22,320
button

705
00:26:22,320 --> 00:26:25,919
or a sensor that detects heat or motion

706
00:26:25,919 --> 00:26:27,039
these are the clicks you hear when you

707
00:26:27,039 --> 00:26:29,360
walk past an electric door

708
00:26:29,360 --> 00:26:33,039
and you have your controller at the top

709
00:26:36,480 --> 00:26:38,000
so your magnetic locks and your electric

710
00:26:38,000 --> 00:26:40,400
door strikes so you can identify these

711
00:26:40,400 --> 00:26:43,200
by carriage bolts on the latch side

712
00:26:43,200 --> 00:26:44,720
if they're screwed into the door that's

713
00:26:44,720 --> 00:26:46,559
a different story but most commonly

714
00:26:46,559 --> 00:26:48,159
you're going to see this especially on

715
00:26:48,159 --> 00:26:53,840
exterior doors or solid corridors

716
00:26:55,200 --> 00:26:58,080
if you have access to a space prior so

717
00:26:58,080 --> 00:27:00,880
if you're doing some

718
00:27:00,880 --> 00:27:02,880
social engineering ahead of time if

719
00:27:02,880 --> 00:27:04,320
you're able to access the lobby

720
00:27:04,320 --> 00:27:06,320
then a paper clip and a piece of gaff

721
00:27:06,320 --> 00:27:07,440
tape right here

722
00:27:07,440 --> 00:27:09,200
as you're walking out slap that to the

723
00:27:09,200 --> 00:27:11,840
lock that will significantly reduce the

724
00:27:11,840 --> 00:27:13,919
hold force

725
00:27:13,919 --> 00:27:16,720
a lot of these are weak as just as they

726
00:27:16,720 --> 00:27:17,440
are

727
00:27:17,440 --> 00:27:19,120
so an average person can just row that

728
00:27:19,120 --> 00:27:20,559
door open but

729
00:27:20,559 --> 00:27:21,840
throwing a paper clip in there and

730
00:27:21,840 --> 00:27:23,440
increasing the distance between the iron

731
00:27:23,440 --> 00:27:25,039
plate and the magnet

732
00:27:25,039 --> 00:27:28,640
significantly weakens the system

733
00:27:28,880 --> 00:27:31,679
so an electronic latch is the other kind

734
00:27:31,679 --> 00:27:33,360
of holding mechanism you're going to see

735
00:27:33,360 --> 00:27:35,919
these have all the same common

736
00:27:35,919 --> 00:27:37,360
vulnerabilities you would see

737
00:27:37,360 --> 00:27:39,600
in say a regular latch and a regular

738
00:27:39,600 --> 00:27:41,360
door however they also have some

739
00:27:41,360 --> 00:27:42,320
additional

740
00:27:42,320 --> 00:27:44,320
vulnerabilities so because people are

741
00:27:44,320 --> 00:27:45,760
lazy in their installs

742
00:27:45,760 --> 00:27:48,640
they'll use the biggest latch that they

743
00:27:48,640 --> 00:27:49,520
can

744
00:27:49,520 --> 00:27:51,039
and the door will be improperly hung

745
00:27:51,039 --> 00:27:53,039
making slipping electronic latches

746
00:27:53,039 --> 00:27:55,760
super easy

747
00:27:59,760 --> 00:28:03,440
your rfid readers so you've got

748
00:28:03,440 --> 00:28:06,080
the only real way to attack an rfid

749
00:28:06,080 --> 00:28:06,720
reader

750
00:28:06,720 --> 00:28:09,200
is with an esp key so from red team

751
00:28:09,200 --> 00:28:09,840
tools

752
00:28:09,840 --> 00:28:12,720
this is a postage stamp size tool spins

753
00:28:12,720 --> 00:28:14,399
up a wireless interface

754
00:28:14,399 --> 00:28:16,480
and can store up to 80 000 credentials

755
00:28:16,480 --> 00:28:17,760
in memory

756
00:28:17,760 --> 00:28:21,039
so the tamper switch behind a hit

757
00:28:21,039 --> 00:28:21,919
carburetor

758
00:28:21,919 --> 00:28:24,080
is rarely hooked up so you can walk in

759
00:28:24,080 --> 00:28:26,880
punch one of these down

760
00:28:26,880 --> 00:28:28,480
and then the credentials can be replayed

761
00:28:28,480 --> 00:28:31,840
later from the web interface

762
00:28:32,159 --> 00:28:34,320
so don't really bother cloning a card i

763
00:28:34,320 --> 00:28:37,678
mean you can use a

764
00:28:41,520 --> 00:28:44,640
you can use the prox mark or

765
00:28:44,640 --> 00:28:46,399
try to replay the credentials and get in

766
00:28:46,399 --> 00:28:48,399
that door but really just

767
00:28:48,399 --> 00:28:50,960
on the daily engagement take that off so

768
00:28:50,960 --> 00:28:52,799
we prior you installed it on the daily

769
00:28:52,799 --> 00:28:53,600
engagement

770
00:28:53,600 --> 00:28:55,440
take it off the primary door go to the

771
00:28:55,440 --> 00:28:56,960
door that you're trying to get into like

772
00:28:56,960 --> 00:28:59,440
say a server room or a secure area

773
00:28:59,440 --> 00:29:01,200
punch it down and just replay

774
00:29:01,200 --> 00:29:02,880
credentials

775
00:29:02,880 --> 00:29:04,640
save yourself the time of the complexity

776
00:29:04,640 --> 00:29:07,600
of trying to clone a card

777
00:29:09,919 --> 00:29:13,520
so request to exit so request

778
00:29:13,520 --> 00:29:15,360
exit sensors or button are used to allow

779
00:29:15,360 --> 00:29:17,039
you to exit the control area without

780
00:29:17,039 --> 00:29:18,640
badging out

781
00:29:18,640 --> 00:29:20,799
uh these sensors like this hall effect

782
00:29:20,799 --> 00:29:22,240
sensor here can be triggered with a

783
00:29:22,240 --> 00:29:23,600
balloon

784
00:29:23,600 --> 00:29:26,960
air duster smoke vape pen

785
00:29:26,960 --> 00:29:29,600
any number of things a flash water

786
00:29:29,600 --> 00:29:30,159
request

787
00:29:30,159 --> 00:29:31,760
exit buttons have type requirements

788
00:29:31,760 --> 00:29:33,200
related to fire code

789
00:29:33,200 --> 00:29:35,120
so your request exit button has to be

790
00:29:35,120 --> 00:29:36,320
within a certain height

791
00:29:36,320 --> 00:29:37,919
and this distance to the door and be

792
00:29:37,919 --> 00:29:39,440
open for this time

793
00:29:39,440 --> 00:29:41,200
so a little wire taped here on your door

794
00:29:41,200 --> 00:29:42,559
tool and your borescope

795
00:29:42,559 --> 00:29:44,880
can be used to actually hit that and

796
00:29:44,880 --> 00:29:47,520
open the door

797
00:29:47,520 --> 00:29:49,279
request exit sensors depending on their

798
00:29:49,279 --> 00:29:51,200
severity are also constantly being

799
00:29:51,200 --> 00:29:52,080
triggered

800
00:29:52,080 --> 00:29:53,840
so you'll hear them click as people go

801
00:29:53,840 --> 00:29:56,240
by you can also watch a lot of the hit

802
00:29:56,240 --> 00:29:57,919
readers you'll see them go from red to

803
00:29:57,919 --> 00:29:58,399
green

804
00:29:58,399 --> 00:30:01,520
for no reason so if you watch that

805
00:30:01,520 --> 00:30:03,360
you're staying in a hallway

806
00:30:03,360 --> 00:30:07,279
you have that go red to green and then

807
00:30:07,279 --> 00:30:09,440
grab the door open it and then badge

808
00:30:09,440 --> 00:30:11,200
just for effect

809
00:30:11,200 --> 00:30:13,600
because your badge is going to make a

810
00:30:13,600 --> 00:30:16,480
sound regardless

811
00:30:19,200 --> 00:30:21,279
that's also another good tip for when

812
00:30:21,279 --> 00:30:22,720
you're tailgating so even if you're

813
00:30:22,720 --> 00:30:24,240
tailgating behind someone

814
00:30:24,240 --> 00:30:25,760
say you were in the smoker's pit you

815
00:30:25,760 --> 00:30:27,520
followed them along

816
00:30:27,520 --> 00:30:29,679
you can badge in with any badge it's

817
00:30:29,679 --> 00:30:30,720
still going to be

818
00:30:30,720 --> 00:30:32,000
and most people aren't going to check to

819
00:30:32,000 --> 00:30:34,840
make sure the reader actually read

820
00:30:34,840 --> 00:30:37,840
anything

821
00:30:37,840 --> 00:30:41,679
the door controllers uh rtfm right

822
00:30:41,679 --> 00:30:43,520
so door control systems are often

823
00:30:43,520 --> 00:30:45,760
unprotected with default credits

824
00:30:45,760 --> 00:30:47,440
uh you can pivot the controller from the

825
00:30:47,440 --> 00:30:49,120
network

826
00:30:49,120 --> 00:30:51,520
and then just read the manual so how do

827
00:30:51,520 --> 00:30:52,799
we connect the controller well here's

828
00:30:52,799 --> 00:30:54,480
the default id address

829
00:30:54,480 --> 00:30:56,960
that could change but admin admin is the

830
00:30:56,960 --> 00:30:59,279
login

831
00:30:59,279 --> 00:31:01,200
once we get to the login click the

832
00:31:01,200 --> 00:31:03,039
dashboard button this tells you

833
00:31:03,039 --> 00:31:06,080
exactly how to exploit the system so

834
00:31:06,080 --> 00:31:07,679
pick your door say

835
00:31:07,679 --> 00:31:10,960
i t closet hit m unlock it'll unlock

836
00:31:10,960 --> 00:31:12,080
temporarily

837
00:31:12,080 --> 00:31:16,840
or hit em up and it's going to stay

838
00:31:16,840 --> 00:31:19,840
unlocked

839
00:31:21,679 --> 00:31:23,679
and then our last option is if you have

840
00:31:23,679 --> 00:31:25,440
access to the door control system let's

841
00:31:25,440 --> 00:31:28,080
say you have an engineer in another area

842
00:31:28,080 --> 00:31:31,519
say you've popped the security room

843
00:31:31,519 --> 00:31:34,159
but you need access to a server room if

844
00:31:34,159 --> 00:31:35,919
you can locate the door

845
00:31:35,919 --> 00:31:38,559
you can jump for the contacts so if it

846
00:31:38,559 --> 00:31:39,120
is a

847
00:31:39,120 --> 00:31:42,640
normally closed jumper across if it is

848
00:31:42,640 --> 00:31:45,760
normally open just pull a wire but

849
00:31:45,760 --> 00:31:46,480
understand

850
00:31:46,480 --> 00:31:48,159
how your systems work make sure that

851
00:31:48,159 --> 00:31:51,279
you're not breaking your own systems

852
00:31:51,279 --> 00:31:53,200
last little bit of advice is going to be

853
00:31:53,200 --> 00:31:55,200
around cameras

854
00:31:55,200 --> 00:31:56,880
you're going to see cameras everywhere

855
00:31:56,880 --> 00:31:58,720
but it's important to think about

856
00:31:58,720 --> 00:32:01,200
if you count 30 cameras you probably

857
00:32:01,200 --> 00:32:03,440
still only have two sets of eyes on them

858
00:32:03,440 --> 00:32:04,960
don't let a camera discourage you from

859
00:32:04,960 --> 00:32:06,799
doing the work you plan on doing

860
00:32:06,799 --> 00:32:08,799
uh there have been a number of times

861
00:32:08,799 --> 00:32:10,559
where i've used another door tool

862
00:32:10,559 --> 00:32:12,320
right underneath the camera i've walked

863
00:32:12,320 --> 00:32:14,080
around for hours on end with

864
00:32:14,080 --> 00:32:16,960
nothing at all uh no response no

865
00:32:16,960 --> 00:32:19,120
interactions or anything

866
00:32:19,120 --> 00:32:21,360
just confidently walking through

867
00:32:21,360 --> 00:32:23,279
anywhere is going to be your best bet

868
00:32:23,279 --> 00:32:25,519
a lot of times i won't pretext i'll just

869
00:32:25,519 --> 00:32:27,679
walk in as i am as a person

870
00:32:27,679 --> 00:32:29,360
just to show the different levels we'll

871
00:32:29,360 --> 00:32:31,679
have a high quality social engineering

872
00:32:31,679 --> 00:32:33,200
attack with paperwork

873
00:32:33,200 --> 00:32:34,720
we'll have a low effort with just a

874
00:32:34,720 --> 00:32:37,120
costume and then we'll have a no effort

875
00:32:37,120 --> 00:32:37,919
which is

876
00:32:37,919 --> 00:32:43,840
a stranger walks in off the street

877
00:32:46,000 --> 00:32:48,559
well that's everything i could think of

878
00:32:48,559 --> 00:32:50,480
so if you have any questions please send

879
00:32:50,480 --> 00:32:55,760
them in the chat

