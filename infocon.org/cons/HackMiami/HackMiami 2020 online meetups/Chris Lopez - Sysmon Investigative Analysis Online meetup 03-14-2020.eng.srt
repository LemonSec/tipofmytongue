1
00:00:00,310 --> 00:00:04,410
this conference will now be recorded

2
00:00:04,410 --> 00:00:09,330
okay so good afternoon everyone

3
00:00:09,330 --> 00:00:11,679
Alexis seems to think that she has a

4
00:00:11,679 --> 00:00:13,570
part in this so she can shut the hell up

5
00:00:13,570 --> 00:00:17,080
um so you have to know everyone welcome

6
00:00:17,080 --> 00:00:19,000
to our hack Miami meeting this afternoon

7
00:00:19,000 --> 00:00:21,970
our virtual conference um I just want to

8
00:00:21,970 --> 00:00:24,220
go over a few housewarming housewarming

9
00:00:24,220 --> 00:00:26,710
tips before we turn it over to honey and

10
00:00:26,710 --> 00:00:28,960
air presenter today

11
00:00:28,960 --> 00:00:30,940
so you'll notice today we are in goto

12
00:00:30,940 --> 00:00:33,280
meeting it is not GoToWebinar it is goto

13
00:00:33,280 --> 00:00:35,949
meeting and you must be responsible

14
00:00:35,949 --> 00:00:37,859
adults and you must take care of

15
00:00:37,859 --> 00:00:40,329
silencing yourself muting yourself and

16
00:00:40,329 --> 00:00:43,030
being the own police of your microphone

17
00:00:43,030 --> 00:00:45,069
now if it does get out of hand if too

18
00:00:45,069 --> 00:00:46,749
many people unmute at one time we will

19
00:00:46,749 --> 00:00:49,870
have to mute all so don't want to do

20
00:00:49,870 --> 00:00:53,649
that Chris has said that he is happy to

21
00:00:53,649 --> 00:00:56,469
welcome questions in the middle so it's

22
00:00:56,469 --> 00:00:57,879
not a normal webinar where everybody

23
00:00:57,879 --> 00:01:00,579
joins and just shuts up and whatever he

24
00:01:00,579 --> 00:01:02,859
wanted to be interactive so he's hoping

25
00:01:02,859 --> 00:01:06,100
welcoming your questions in between a

26
00:01:06,100 --> 00:01:08,860
few things about the platform

27
00:01:08,860 --> 00:01:11,649
GoToMeeting platform we are recording

28
00:01:11,649 --> 00:01:14,350
today when you get connected your video

29
00:01:14,350 --> 00:01:17,170
is probably turned on automatically so

30
00:01:17,170 --> 00:01:19,509
as good hackers that we are you probably

31
00:01:19,509 --> 00:01:21,039
have a piece of paper over it or tape

32
00:01:21,039 --> 00:01:24,039
over it or whatever but like Gustavo and

33
00:01:24,039 --> 00:01:25,960
Diego I just want you to know that your

34
00:01:25,960 --> 00:01:28,420
cameras are on you know they're covered

35
00:01:28,420 --> 00:01:31,240
so just be careful of sharing your

36
00:01:31,240 --> 00:01:34,149
camera as well some of the other things

37
00:01:34,149 --> 00:01:36,250
make sure that you like I said mute

38
00:01:36,250 --> 00:01:37,539
yourself so we don't hear your phones

39
00:01:37,539 --> 00:01:40,060
and things in the background and make

40
00:01:40,060 --> 00:01:41,680
sure you don't put your line if you are

41
00:01:41,680 --> 00:01:43,390
dialed in by phone make sure you don't

42
00:01:43,390 --> 00:01:45,340
put your line on hold because sometimes

43
00:01:45,340 --> 00:01:47,829
we can hear hold music from that other

44
00:01:47,829 --> 00:01:50,649
things to keep in mind GoToMeeting hates

45
00:01:50,649 --> 00:01:54,280
me I used it every day for the last 15

46
00:01:54,280 --> 00:01:56,320
years but it does hate me so at least

47
00:01:56,320 --> 00:01:58,659
one time during this meeting I my voice

48
00:01:58,659 --> 00:02:00,549
will go out at least for 20 seconds I've

49
00:02:00,549 --> 00:02:03,729
not disappeared I'm still here and I

50
00:02:03,729 --> 00:02:05,710
will come back again hopefully won't

51
00:02:05,710 --> 00:02:07,899
happen while Chris is presenting but it

52
00:02:07,899 --> 00:02:09,940
does happen and the other thing is

53
00:02:09,940 --> 00:02:11,900
should we happen to get disconnected

54
00:02:11,900 --> 00:02:13,939
that happens occasionally should we

55
00:02:13,939 --> 00:02:15,860
happen to get disconnected we will make

56
00:02:15,860 --> 00:02:18,349
sure the meeting link is in events just

57
00:02:18,349 --> 00:02:20,450
come right back in I will open it up as

58
00:02:20,450 --> 00:02:24,170
quickly as possible and anything else

59
00:02:24,170 --> 00:02:26,750
the meeting is set to go from 2:00 to

60
00:02:26,750 --> 00:02:27,709
about 4:00 today

61
00:02:27,709 --> 00:02:30,140
but depending on how much material Chris

62
00:02:30,140 --> 00:02:33,709
has that could change he could I don't

63
00:02:33,709 --> 00:02:35,239
know exactly how much he has know many

64
00:02:35,239 --> 00:02:37,189
questions you guys have and discussions

65
00:02:37,189 --> 00:02:39,590
we are happy to hang out a little bit

66
00:02:39,590 --> 00:02:41,420
afterwards for a little bit of a

67
00:02:41,420 --> 00:02:43,510
networking if you like so we can discuss

68
00:02:43,510 --> 00:02:46,069
you know tips on going forward how you

69
00:02:46,069 --> 00:02:47,989
liked it you know other suggestions that

70
00:02:47,989 --> 00:02:50,060
you might have so we're happy to do that

71
00:02:50,060 --> 00:02:51,709
as well and again from the new people

72
00:02:51,709 --> 00:02:53,359
that are joining we are recording this

73
00:02:53,359 --> 00:02:55,870
so I just want to let you know that now

74
00:02:55,870 --> 00:02:57,980
without further ado I'd like to turn it

75
00:02:57,980 --> 00:03:01,340
over to honey so she can give you an

76
00:03:01,340 --> 00:03:03,799
intro introduce Chris and we'll get

77
00:03:03,799 --> 00:03:06,639
started thanks guys

78
00:03:06,639 --> 00:03:09,530
hey everybody it's some supergreat that

79
00:03:09,530 --> 00:03:11,659
you guys could be here online today

80
00:03:11,659 --> 00:03:13,639
thank you for being flexible about our

81
00:03:13,639 --> 00:03:15,859
meeting location and moving to the

82
00:03:15,859 --> 00:03:19,280
online platform which seem to go really

83
00:03:19,280 --> 00:03:22,639
great so far so just a reminder that

84
00:03:22,639 --> 00:03:26,209
currently HACC Miami con is is probably

85
00:03:26,209 --> 00:03:27,980
not gonna happen and I think has already

86
00:03:27,980 --> 00:03:30,139
been cancelled so in the event that you

87
00:03:30,139 --> 00:03:32,989
have planned for that also if you are a

88
00:03:32,989 --> 00:03:36,109
b-sides Orlando participant that has

89
00:03:36,109 --> 00:03:38,299
also been rescheduled and more

90
00:03:38,299 --> 00:03:40,699
information will be coming out shortly

91
00:03:40,699 --> 00:03:42,139
about both of those events

92
00:03:42,139 --> 00:03:44,750
I'm sure if you are not a member of our

93
00:03:44,750 --> 00:03:46,400
slack Channel and you would like to

94
00:03:46,400 --> 00:03:48,349
become a member of our slack Channel

95
00:03:48,349 --> 00:03:51,620
please just email one of our members a

96
00:03:51,620 --> 00:03:54,109
request or you can email me at honey

97
00:03:54,109 --> 00:03:56,659
percent 27 you have to spell it out at

98
00:03:56,659 --> 00:03:59,959
gmail.com well you have to solve percent

99
00:03:59,959 --> 00:04:03,680
not the 27 and and eventually I'm sure

100
00:04:03,680 --> 00:04:08,239
I'll I'll get back to you so yeah so I

101
00:04:08,239 --> 00:04:10,579
want to thank Chris Chris Lopez our

102
00:04:10,579 --> 00:04:12,229
presenter today he's been super flexible

103
00:04:12,229 --> 00:04:14,510
working with me on this making this

104
00:04:14,510 --> 00:04:16,940
meeting a reality since Wednesday when

105
00:04:16,940 --> 00:04:19,699
we decided we could not in good faith

106
00:04:19,699 --> 00:04:21,560
show up to the library because it kind

107
00:04:21,560 --> 00:04:23,419
of has cooties

108
00:04:23,419 --> 00:04:27,590
best of days let alone right now so so

109
00:04:27,590 --> 00:04:29,870
without further ado I'd like to turn

110
00:04:29,870 --> 00:04:31,729
this over to Chris and remind people

111
00:04:31,729 --> 00:04:33,800
that if they don't want their cameras on

112
00:04:33,800 --> 00:04:40,639
to please turn them off Chris thank you

113
00:04:40,639 --> 00:04:44,930
so my presenter now I am making you the

114
00:04:44,930 --> 00:04:49,400
presenter now I'm sending you make sure

115
00:04:49,400 --> 00:04:56,990
you accept that all right just to verify

116
00:04:56,990 --> 00:05:03,710
everyone can see my screen awesome all

117
00:05:03,710 --> 00:05:06,229
right so let me just get this in the

118
00:05:06,229 --> 00:05:09,560
background ready amazing start this up

119
00:05:09,560 --> 00:05:17,210
really quick alright so I am going to

120
00:05:17,210 --> 00:05:19,039
share my camera why not let's make this

121
00:05:19,039 --> 00:05:22,699
a little bit more personal again I want

122
00:05:22,699 --> 00:05:24,889
to ensure that everyone here feels

123
00:05:24,889 --> 00:05:26,659
comfortable asking questions while I'm

124
00:05:26,659 --> 00:05:28,969
talking this is one of those

125
00:05:28,969 --> 00:05:31,539
conversations that I love to have and

126
00:05:31,539 --> 00:05:34,520
any questions just you know right in the

127
00:05:34,520 --> 00:05:36,830
chat I'll try to keep an eye on that as

128
00:05:36,830 --> 00:05:40,099
I'm talking or you know just disrespect

129
00:05:40,099 --> 00:05:43,550
just like interrupt me you know it's

130
00:05:43,550 --> 00:05:45,229
fine I just try to make this as

131
00:05:45,229 --> 00:05:48,409
conversational as possible so again my

132
00:05:48,409 --> 00:05:50,330
name is Christopher Lopez and today

133
00:05:50,330 --> 00:05:51,949
we're going to be talking about system

134
00:05:51,949 --> 00:05:55,099
on from investigative standpoint let's

135
00:05:55,099 --> 00:05:59,509
just jump right into it so let's all

136
00:05:59,509 --> 00:06:00,919
right so Who am I mentioned that a

137
00:06:00,919 --> 00:06:03,979
little bit already first and foremost

138
00:06:03,979 --> 00:06:07,370
I'm a father so I and what's considered

139
00:06:07,370 --> 00:06:09,379
to be a blue team I'm on that side of

140
00:06:09,379 --> 00:06:10,909
the fence when it comes to cyber

141
00:06:10,909 --> 00:06:13,189
security and currently I'm a cyber

142
00:06:13,189 --> 00:06:15,710
intelligence analyst and of course human

143
00:06:15,710 --> 00:06:19,039
being so if anyone wants to talk to me

144
00:06:19,039 --> 00:06:21,620
on Twitter there goes my twitter handle

145
00:06:21,620 --> 00:06:24,800
and a little bit about me I love log I

146
00:06:24,800 --> 00:06:27,169
love working on investigations and I

147
00:06:27,169 --> 00:06:31,180
really love learning and healthy work so

148
00:06:31,180 --> 00:06:33,740
this month let's get into it

149
00:06:33,740 --> 00:06:37,190
uh why are we talking about this well

150
00:06:37,190 --> 00:06:39,950
it is arguably one of the best endpoint

151
00:06:39,950 --> 00:06:42,890
detection logging mechanisms that we

152
00:06:42,890 --> 00:06:45,650
currently have for Windows systems it's

153
00:06:45,650 --> 00:06:48,410
part of the sysinternals toolset that a

154
00:06:48,410 --> 00:06:50,120
lot of us may be familiar with from like

155
00:06:50,120 --> 00:06:52,520
an IT perspective a lot of these tools

156
00:06:52,520 --> 00:06:56,750
were more geared towards of IT related

157
00:06:56,750 --> 00:07:00,230
tasks but later on the field realized

158
00:07:00,230 --> 00:07:02,240
hey there's a lot that we can gain from

159
00:07:02,240 --> 00:07:05,000
these tools in order to help us with

160
00:07:05,000 --> 00:07:07,790
security related events and we have to

161
00:07:07,790 --> 00:07:11,360
think the person is on the slide mark he

162
00:07:11,360 --> 00:07:13,370
is the creator of system on and he's

163
00:07:13,370 --> 00:07:15,680
from Microsoft and he's really awesome

164
00:07:15,680 --> 00:07:18,440
and it's great that he released this for

165
00:07:18,440 --> 00:07:20,570
us to use a lot of organizations use

166
00:07:20,570 --> 00:07:23,300
this mahn in order to detect bad that's

167
00:07:23,300 --> 00:07:24,890
what it's all about right but it goes

168
00:07:24,890 --> 00:07:27,230
way beyond the standard logging of

169
00:07:27,230 --> 00:07:29,570
Windows like you know log on events and

170
00:07:29,570 --> 00:07:30,200
things like that

171
00:07:30,200 --> 00:07:34,220
and the best part arguably is that it

172
00:07:34,220 --> 00:07:37,370
can be deployed really easily and it's

173
00:07:37,370 --> 00:07:39,230
it can be deployed to hundreds of

174
00:07:39,230 --> 00:07:40,850
dollars of systems I mean I've seen it

175
00:07:40,850 --> 00:07:43,550
my experience which of course then we

176
00:07:43,550 --> 00:07:45,110
sent to a spin right to be able to

177
00:07:45,110 --> 00:07:47,870
correlate data properly but the last

178
00:07:47,870 --> 00:07:50,510
point it's fun to analyze I loved system

179
00:07:50,510 --> 00:07:51,680
on like I said in the beginning and

180
00:07:51,680 --> 00:07:53,660
we're just going to start diving into

181
00:07:53,660 --> 00:07:56,960
how to set it up so here is a slide just

182
00:07:56,960 --> 00:07:59,060
showing anyone that's not familiar with

183
00:07:59,060 --> 00:08:00,890
this mahn how it's set up

184
00:08:00,890 --> 00:08:03,950
it's incredibly easy what I do and what

185
00:08:03,950 --> 00:08:05,480
I'm going to show on the demo is how to

186
00:08:05,480 --> 00:08:09,050
do it in a lab environment and basically

187
00:08:09,050 --> 00:08:12,800
it is a command once you download it

188
00:08:12,800 --> 00:08:15,320
from Microsoft you run a simple command

189
00:08:15,320 --> 00:08:17,270
and point it to the config file which is

190
00:08:17,270 --> 00:08:20,330
an XML file and we'll go over the XML

191
00:08:20,330 --> 00:08:23,330
file more during the demo but

192
00:08:23,330 --> 00:08:26,180
essentially that's it Frank shut it up

193
00:08:26,180 --> 00:08:28,669
and it starts logging stuff and you you

194
00:08:28,669 --> 00:08:30,530
can just make rules based on certain

195
00:08:30,530 --> 00:08:30,950
things

196
00:08:30,950 --> 00:08:33,890
so the XML file itself what's great

197
00:08:33,890 --> 00:08:37,070
about it is that it is something that

198
00:08:37,070 --> 00:08:38,900
can be used to whitelist so an example

199
00:08:38,900 --> 00:08:40,729
of that is let's say that your

200
00:08:40,729 --> 00:08:44,080
environment you have specific

201
00:08:44,080 --> 00:08:46,760
applications that are developed by you

202
00:08:46,760 --> 00:08:49,160
know developers internally you know

203
00:08:49,160 --> 00:08:50,490
that's always happening

204
00:08:50,490 --> 00:08:52,920
and basically you want to stop logging

205
00:08:52,920 --> 00:08:54,540
or stop

206
00:08:54,540 --> 00:08:57,180
you know flooding your sin with a

207
00:08:57,180 --> 00:08:59,279
million events tied to these executables

208
00:08:59,279 --> 00:09:02,220
that you know are legitimate you could

209
00:09:02,220 --> 00:09:04,560
whitelist them and there's a lot of

210
00:09:04,560 --> 00:09:07,860
examples for six monthly figs Swift on

211
00:09:07,860 --> 00:09:09,480
security a lot of people here may know

212
00:09:09,480 --> 00:09:12,180
them on Twitter they have an awesome

213
00:09:12,180 --> 00:09:14,370
github system on config that's the one I

214
00:09:14,370 --> 00:09:16,770
use I've seen a lot of organizations

215
00:09:16,770 --> 00:09:18,660
that use that as like a foundational

216
00:09:18,660 --> 00:09:22,020
template and then you know just build on

217
00:09:22,020 --> 00:09:24,570
it add stuff to it include this you know

218
00:09:24,570 --> 00:09:26,279
this include whatever you want to call

219
00:09:26,279 --> 00:09:29,880
it exclude and yeah so let's go into how

220
00:09:29,880 --> 00:09:33,800
it looks so this is an example and it's

221
00:09:33,800 --> 00:09:38,279
there's a lot I'm not a huge XML person

222
00:09:38,279 --> 00:09:42,180
but it's pretty easy to digest once you

223
00:09:42,180 --> 00:09:45,149
look at an example of it and from this

224
00:09:45,149 --> 00:09:49,080
you can just include or exclude anything

225
00:09:49,080 --> 00:09:51,720
that you may find interesting or you may

226
00:09:51,720 --> 00:09:53,610
not find interesting and you can build

227
00:09:53,610 --> 00:09:56,579
it based on each event ID so this event

228
00:09:56,579 --> 00:09:57,959
ID that we're looking at which we're

229
00:09:57,959 --> 00:09:59,790
going to cover in a few slides is for a

230
00:09:59,790 --> 00:10:01,860
process create event and it's basically

231
00:10:01,860 --> 00:10:03,810
just saying you know what we want to

232
00:10:03,810 --> 00:10:08,850
even log on these machines so once you

233
00:10:08,850 --> 00:10:10,589
install it it's always important to

234
00:10:10,589 --> 00:10:13,529
understand where it is so let's say that

235
00:10:13,529 --> 00:10:16,110
for example you have an alert in your

236
00:10:16,110 --> 00:10:18,870
environment that tells you that some bad

237
00:10:18,870 --> 00:10:21,420
file did something bad let's say like an

238
00:10:21,420 --> 00:10:24,959
AV type alert antivirus whatever it is

239
00:10:24,959 --> 00:10:26,850
that you use in your organization well

240
00:10:26,850 --> 00:10:29,430
let's say that you don't have a sim or

241
00:10:29,430 --> 00:10:31,560
for some reason these logs are missing

242
00:10:31,560 --> 00:10:34,380
in the same that does happen I don't

243
00:10:34,380 --> 00:10:36,810
know why but it definitely can deter you

244
00:10:36,810 --> 00:10:39,390
in an investigation so it's always

245
00:10:39,390 --> 00:10:40,620
really important whenever you're going

246
00:10:40,620 --> 00:10:42,899
to remote to a system connect to a

247
00:10:42,899 --> 00:10:45,240
system to know where it is and I put the

248
00:10:45,240 --> 00:10:46,560
path on the bottom we're going to go

249
00:10:46,560 --> 00:10:48,600
over that in the demo of going to it in

250
00:10:48,600 --> 00:10:50,160
case anyone here is not familiar where

251
00:10:50,160 --> 00:10:51,930
these logs are stored but that's where

252
00:10:51,930 --> 00:10:53,640
it is and that's what you pull to be

253
00:10:53,640 --> 00:10:55,440
able to analyze it and see what occurred

254
00:10:55,440 --> 00:10:57,690
on that system since this Mon was

255
00:10:57,690 --> 00:10:59,490
running of course this is a service that

256
00:10:59,490 --> 00:11:03,760
runs so monitor any changes in that so

257
00:11:03,760 --> 00:11:05,890
was running because that's usually an

258
00:11:05,890 --> 00:11:07,330
indicator that someone may have stopped

259
00:11:07,330 --> 00:11:09,550
it and that warrants some investigation

260
00:11:09,550 --> 00:11:12,310
but yeah so that's the pass and go to

261
00:11:12,310 --> 00:11:15,660
that pulled it and start analyzing so

262
00:11:15,660 --> 00:11:19,000
event IDs there's too many to cover on

263
00:11:19,000 --> 00:11:20,890
this presentation unfortunately as much

264
00:11:20,890 --> 00:11:22,390
as I would love to sit here and talk to

265
00:11:22,390 --> 00:11:24,460
you guys for three hours four hours then

266
00:11:24,460 --> 00:11:26,230
that would be that would drag on a

267
00:11:26,230 --> 00:11:27,820
little bit so we're going to focus on a

268
00:11:27,820 --> 00:11:30,820
few of these that I use the most to be

269
00:11:30,820 --> 00:11:32,350
able to make a determination on

270
00:11:32,350 --> 00:11:34,900
something bad or not bad happening and

271
00:11:34,900 --> 00:11:36,670
it's all about correlating some of these

272
00:11:36,670 --> 00:11:39,340
and I wrote them all down here I may

273
00:11:39,340 --> 00:11:41,230
have missed one or two not sure but

274
00:11:41,230 --> 00:11:43,360
there's a lot of events a lot of event

275
00:11:43,360 --> 00:11:45,610
IDs that you can filter on when you're

276
00:11:45,610 --> 00:11:47,170
using a sim or you're using like any

277
00:11:47,170 --> 00:11:50,350
kind of log parsing tool to be able to

278
00:11:50,350 --> 00:11:52,660
you know view the ones that you care

279
00:11:52,660 --> 00:11:53,350
about the most

280
00:11:53,350 --> 00:11:55,330
but we're going to get into a few of

281
00:11:55,330 --> 00:11:57,880
them here in these slides and more in

282
00:11:57,880 --> 00:11:59,950
the demo about you know what's important

283
00:11:59,950 --> 00:12:01,780
to look at so let's just start out with

284
00:12:01,780 --> 00:12:06,880
the first one here we go process create

285
00:12:06,880 --> 00:12:10,000
event ID one this is arguably the most

286
00:12:10,000 --> 00:12:12,220
important one the reason I say that is

287
00:12:12,220 --> 00:12:13,990
because this is logged every single time

288
00:12:13,990 --> 00:12:18,010
something runs super awesome so

289
00:12:18,010 --> 00:12:22,390
Microsoft does have and it and a default

290
00:12:22,390 --> 00:12:25,240
log for this that's outside of this one

291
00:12:25,240 --> 00:12:27,730
so if for some reason you can't deploy

292
00:12:27,730 --> 00:12:29,440
this one in your environment I would

293
00:12:29,440 --> 00:12:31,420
definitely say to checkmark the forty

294
00:12:31,420 --> 00:12:33,520
six eighty eight I believe event which

295
00:12:33,520 --> 00:12:35,890
is the same as this one but since this

296
00:12:35,890 --> 00:12:38,020
is with system on it correlates with all

297
00:12:38,020 --> 00:12:40,600
the other system or logs and it's super

298
00:12:40,600 --> 00:12:42,100
important because it tells you when

299
00:12:42,100 --> 00:12:44,110
things are doing stuff and it's a good

300
00:12:44,110 --> 00:12:45,580
indicator or at least a good base

301
00:12:45,580 --> 00:12:47,590
indicator to tell you that something has

302
00:12:47,590 --> 00:12:50,340
occurred right so an example of that is

303
00:12:50,340 --> 00:12:52,570
let's say that we're going to go back to

304
00:12:52,570 --> 00:12:57,100
the AV event right so a bad file was

305
00:12:57,100 --> 00:12:59,470
seen by your antivirus and it logs it

306
00:12:59,470 --> 00:13:00,910
and you're trying to do an investigation

307
00:13:00,910 --> 00:13:02,710
to see what happened one of the first

308
00:13:02,710 --> 00:13:05,410
things that I do is see did AV actually

309
00:13:05,410 --> 00:13:07,090
stop it right

310
00:13:07,090 --> 00:13:10,690
AV is really good at low-hanging fruit

311
00:13:10,690 --> 00:13:13,240
but a lot of AV is built on signature

312
00:13:13,240 --> 00:13:15,970
detection and we all know that that kind

313
00:13:15,970 --> 00:13:17,500
of can be

314
00:13:17,500 --> 00:13:19,570
by past I mean if you recompile an

315
00:13:19,570 --> 00:13:22,750
executable a few times a B engines won't

316
00:13:22,750 --> 00:13:25,600
be aware of the hash so that's just

317
00:13:25,600 --> 00:13:27,880
something you know keep in mind but if

318
00:13:27,880 --> 00:13:30,880
it is tied to a specific executable and

319
00:13:30,880 --> 00:13:31,990
you're trying to see if something

320
00:13:31,990 --> 00:13:34,870
actually did occur even though there is

321
00:13:34,870 --> 00:13:39,040
a AV related event you can check to see

322
00:13:39,040 --> 00:13:41,140
if the process actually ran so that's

323
00:13:41,140 --> 00:13:43,000
one way that I try to see it for some

324
00:13:43,000 --> 00:13:46,030
reason and I've seen this before in the

325
00:13:46,030 --> 00:13:48,490
environment where I'll see a navy alert

326
00:13:48,490 --> 00:13:50,470
and it's like hey this happened and I'm

327
00:13:50,470 --> 00:13:51,970
like okay so did it gets to the point

328
00:13:51,970 --> 00:13:53,140
that I need to do something with this

329
00:13:53,140 --> 00:13:55,870
machine and usually that leads to has it

330
00:13:55,870 --> 00:13:57,430
installed persistence or has it done

331
00:13:57,430 --> 00:14:00,430
something that warrants reimage of the

332
00:14:00,430 --> 00:14:02,020
machine and one of the first thing I

333
00:14:02,020 --> 00:14:04,540
look for is did it actually run because

334
00:14:04,540 --> 00:14:06,280
these are two different log sources that

335
00:14:06,280 --> 00:14:08,170
you're comparing here and process

336
00:14:08,170 --> 00:14:10,090
creates will tell you if something has

337
00:14:10,090 --> 00:14:12,460
actually run so very important to keep

338
00:14:12,460 --> 00:14:14,740
in mind with system or logs and that's

339
00:14:14,740 --> 00:14:17,890
what it looks like so I put this on here

340
00:14:17,890 --> 00:14:19,060
a little bit as a joke

341
00:14:19,060 --> 00:14:21,340
because I think it's interesting and

342
00:14:21,340 --> 00:14:22,780
we're going to dig into some of these

343
00:14:22,780 --> 00:14:25,750
events and a little bit but this is me

344
00:14:25,750 --> 00:14:27,730
as you can see here I mean there's a few

345
00:14:27,730 --> 00:14:29,560
lines here that are interesting for

346
00:14:29,560 --> 00:14:32,470
example this is a prospect crate for

347
00:14:32,470 --> 00:14:34,750
PowerPoint right I'm just running

348
00:14:34,750 --> 00:14:36,850
PowerPoint and as you can see for the

349
00:14:36,850 --> 00:14:40,240
date it is the 13th of March yesterday

350
00:14:40,240 --> 00:14:42,610
yes I was working on a presentation

351
00:14:42,610 --> 00:14:43,870
yesterday because I forgot to put

352
00:14:43,870 --> 00:14:45,730
something in there and this is me

353
00:14:45,730 --> 00:14:47,410
working on the presentation before I

354
00:14:47,410 --> 00:14:48,700
decided to change the title because it

355
00:14:48,700 --> 00:14:52,390
was too long so this is a and also

356
00:14:52,390 --> 00:14:53,620
something to keep in mind it does

357
00:14:53,620 --> 00:14:55,780
capture the directory in which this file

358
00:14:55,780 --> 00:14:58,300
is executing from so it's in a download

359
00:14:58,300 --> 00:14:59,890
folder because I had it on Google Drive

360
00:14:59,890 --> 00:15:02,770
know maybe I shouldn't use that but I

361
00:15:02,770 --> 00:15:04,839
had it on Google Drive and I downloaded

362
00:15:04,839 --> 00:15:06,700
onto my machine so I can work on any

363
00:15:06,700 --> 00:15:09,040
different machines in my house and

364
00:15:09,040 --> 00:15:11,170
things like that but what I really want

365
00:15:11,170 --> 00:15:14,620
everyone to focus on here is the hash so

366
00:15:14,620 --> 00:15:17,110
in the hashes section the bottom here I

367
00:15:17,110 --> 00:15:18,339
don't know if you guys can see my mouse

368
00:15:18,339 --> 00:15:21,740
hopefully basically

369
00:15:21,740 --> 00:15:23,840
that hash is super important so every

370
00:15:23,840 --> 00:15:27,230
time that an image executes it is hashed

371
00:15:27,230 --> 00:15:30,050
and it does contain the hash of that in

372
00:15:30,050 --> 00:15:31,700
process create events and these hashes

373
00:15:31,700 --> 00:15:35,030
are exactly what I use to try to learn a

374
00:15:35,030 --> 00:15:36,440
little bit more about the file that's

375
00:15:36,440 --> 00:15:38,540
executing you know I'll use Olsen you

376
00:15:38,540 --> 00:15:39,830
know we're all probably familiar with

377
00:15:39,830 --> 00:15:41,120
like virustotal and things like that

378
00:15:41,120 --> 00:15:43,100
just to check to see what this is if

379
00:15:43,100 --> 00:15:44,360
it's a file that's never heard of

380
00:15:44,360 --> 00:15:47,360
there's a lot of files out there and the

381
00:15:47,360 --> 00:15:48,800
hash is a good way of being able to

382
00:15:48,800 --> 00:15:51,440
figure out maybe this is that right and

383
00:15:51,440 --> 00:15:53,090
you can just keep going on with the

384
00:15:53,090 --> 00:15:54,500
investigation we'll do a little bit of

385
00:15:54,500 --> 00:15:58,160
that in a demo as well so the next event

386
00:15:58,160 --> 00:16:00,050
that I want to really focus on our file

387
00:16:00,050 --> 00:16:04,130
creeps so in contrast to process creates

388
00:16:04,130 --> 00:16:06,230
a file create occurs when a file is

389
00:16:06,230 --> 00:16:09,050
created so one of the ones that I see

390
00:16:09,050 --> 00:16:12,950
often is anything that has to do with an

391
00:16:12,950 --> 00:16:16,220
email service let's say outlook for

392
00:16:16,220 --> 00:16:19,400
example and someone downloads a file

393
00:16:19,400 --> 00:16:21,500
that is an attachment that does create a

394
00:16:21,500 --> 00:16:24,710
file create event it and it shows it

395
00:16:24,710 --> 00:16:26,570
usually in the cache directory for

396
00:16:26,570 --> 00:16:27,680
Outlook whenever it is that you're

397
00:16:27,680 --> 00:16:29,510
trying to see you know what someone did

398
00:16:29,510 --> 00:16:31,790
before they move it to their desktop or

399
00:16:31,790 --> 00:16:34,190
Documents folder but throughout that

400
00:16:34,190 --> 00:16:36,500
course of moving things or putting

401
00:16:36,500 --> 00:16:38,660
things in certain places or creating

402
00:16:38,660 --> 00:16:41,300
anything that is a file on you know on

403
00:16:41,300 --> 00:16:45,440
Windows it does log an event so this is

404
00:16:45,440 --> 00:16:47,240
really good when you're trying to

405
00:16:47,240 --> 00:16:50,950
determine what a file did or what a

406
00:16:50,950 --> 00:16:53,620
image did so let's say that it's in

407
00:16:53,620 --> 00:16:56,150
malicious file or malicious image and

408
00:16:56,150 --> 00:16:58,610
you're looking at and you expect it

409
00:16:58,610 --> 00:17:01,790
based on some asset information that you

410
00:17:01,790 --> 00:17:03,590
gathered throughout your investigation

411
00:17:03,590 --> 00:17:06,170
that it should drop a file in a certain

412
00:17:06,170 --> 00:17:08,750
location you can look for the image

413
00:17:08,750 --> 00:17:13,099
being badly EXCI right dropping this bad

414
00:17:13,099 --> 00:17:16,609
dot exe file somewhere else really good

415
00:17:16,609 --> 00:17:18,109
to be able to correlate that between

416
00:17:18,109 --> 00:17:20,180
process IDs and I'm going to try to

417
00:17:20,180 --> 00:17:22,640
remember the process ID to mention it

418
00:17:22,640 --> 00:17:24,800
during a demo because that's a great way

419
00:17:24,800 --> 00:17:26,690
to correlate between different events

420
00:17:26,690 --> 00:17:28,580
and just like group them all together so

421
00:17:28,580 --> 00:17:31,130
you can see what happened after

422
00:17:31,130 --> 00:17:33,680
something actually executed that's an

423
00:17:33,680 --> 00:17:35,630
excellent correlation

424
00:17:35,630 --> 00:17:38,960
feel the evening use so talk about

425
00:17:38,960 --> 00:17:41,900
registry events I was a lot here

426
00:17:41,900 --> 00:17:43,760
anyone that's really familiar with

427
00:17:43,760 --> 00:17:46,790
Windows or has opened up regedit in

428
00:17:46,790 --> 00:17:49,370
their lifetime knows that the registry

429
00:17:49,370 --> 00:17:51,350
can be daunting there's a lot of stuff

430
00:17:51,350 --> 00:17:53,600
going on and of course due to how big

431
00:17:53,600 --> 00:17:55,580
the registry is and how much stuff is

432
00:17:55,580 --> 00:17:57,080
involved in a registry there are

433
00:17:57,080 --> 00:17:58,550
different events that are related to

434
00:17:58,550 --> 00:18:01,670
registries or registry changes so there

435
00:18:01,670 --> 00:18:03,110
are three different events twelve

436
00:18:03,110 --> 00:18:05,750
thirteen and fourteen and you know we're

437
00:18:05,750 --> 00:18:08,150
going to see creation type events or

438
00:18:08,150 --> 00:18:09,560
creating Keys we're going to see a

439
00:18:09,560 --> 00:18:11,540
valley being set for a key and any kind

440
00:18:11,540 --> 00:18:14,080
of rename is also set up there as well

441
00:18:14,080 --> 00:18:16,370
the reason I this is so important is

442
00:18:16,370 --> 00:18:19,820
because one of the main ways that I

443
00:18:19,820 --> 00:18:21,740
don't want to say main one of the ways

444
00:18:21,740 --> 00:18:24,200
I'm malware attempts to you know hide

445
00:18:24,200 --> 00:18:27,470
itself or install persistence through

446
00:18:27,470 --> 00:18:30,860
registry type changes for example run

447
00:18:30,860 --> 00:18:32,840
Keys probably heard of that or run ones

448
00:18:32,840 --> 00:18:35,030
Keys you know of course as other things

449
00:18:35,030 --> 00:18:36,890
like startup folders and things like

450
00:18:36,890 --> 00:18:38,450
that it's scheduled tasks for example

451
00:18:38,450 --> 00:18:40,820
but when you're looking at system on

452
00:18:40,820 --> 00:18:42,920
it's really interesting to see this

453
00:18:42,920 --> 00:18:45,380
occur in the registry so it's always

454
00:18:45,380 --> 00:18:46,940
something to keep in mind with system on

455
00:18:46,940 --> 00:18:51,800
events so DNS queries now this is really

456
00:18:51,800 --> 00:18:54,680
cool I don't know how large some of the

457
00:18:54,680 --> 00:18:56,450
organizations that everyone here you

458
00:18:56,450 --> 00:18:59,620
know works in but DNS can be a problem

459
00:18:59,620 --> 00:19:01,580
you know we see that on Twitter all the

460
00:19:01,580 --> 00:19:03,200
time they're only blaming DNS for

461
00:19:03,200 --> 00:19:05,600
everything because it is a behemoth and

462
00:19:05,600 --> 00:19:08,260
sometimes there is just so much logging

463
00:19:08,260 --> 00:19:11,420
surrounding DNS type events what's

464
00:19:11,420 --> 00:19:13,130
really interesting is that the creators

465
00:19:13,130 --> 00:19:15,140
of system on marking all those people

466
00:19:15,140 --> 00:19:18,200
they're Microsoft they added this

467
00:19:18,200 --> 00:19:20,780
recently as an event force this month

468
00:19:20,780 --> 00:19:23,870
and I loved it I mean it's really cool

469
00:19:23,870 --> 00:19:26,420
because you're able to see when a file

470
00:19:26,420 --> 00:19:29,960
not when they actually make that let's

471
00:19:29,960 --> 00:19:32,390
say that it is a file that is known to

472
00:19:32,390 --> 00:19:33,770
communicate with a command-and-control

473
00:19:33,770 --> 00:19:36,740
server right will see it execute will

474
00:19:36,740 --> 00:19:38,420
see it do its thing and then at some

475
00:19:38,420 --> 00:19:39,740
point it's going to try to reach out

476
00:19:39,740 --> 00:19:42,620
well before it actually does reach out

477
00:19:42,620 --> 00:19:44,390
it will you know the way that things

478
00:19:44,390 --> 00:19:46,100
work with connections right will send a

479
00:19:46,100 --> 00:19:49,490
query or you know to a DNS server to get

480
00:19:49,490 --> 00:19:51,020
the information that it needs in order

481
00:19:51,020 --> 00:19:54,020
to know which address space to speak to

482
00:19:54,020 --> 00:19:57,380
in order to actually pull that secondary

483
00:19:57,380 --> 00:19:59,600
payload or that primary payload that it

484
00:19:59,600 --> 00:20:01,100
needs in order to start you know doing

485
00:20:01,100 --> 00:20:03,890
bad stuff so you can actually see this

486
00:20:03,890 --> 00:20:06,320
and correlate it based on hey this

487
00:20:06,320 --> 00:20:08,630
executed and it led to a DNS event which

488
00:20:08,630 --> 00:20:10,730
then led to a network connection which

489
00:20:10,730 --> 00:20:13,159
then led to a download of this bad stuff

490
00:20:13,159 --> 00:20:16,909
so really awesome event and it is event

491
00:20:16,909 --> 00:20:19,880
22 and we may see some of this in the

492
00:20:19,880 --> 00:20:22,330
demo as well hopefully it does show up

493
00:20:22,330 --> 00:20:26,559
alright so the reason why I you know

494
00:20:26,559 --> 00:20:29,600
wanted to try to not fly through the

495
00:20:29,600 --> 00:20:31,370
slides I just wanted to show some

496
00:20:31,370 --> 00:20:32,539
background it's because I feel like

497
00:20:32,539 --> 00:20:35,059
there's a lot more to cover and a lot

498
00:20:35,059 --> 00:20:37,760
more to gain from seeing it all work on

499
00:20:37,760 --> 00:20:41,960
a demo and as we know this is a live

500
00:20:41,960 --> 00:20:44,870
demo so please if I mistyped something

501
00:20:44,870 --> 00:20:48,380
it's gonna it's just the way it is you

502
00:20:48,380 --> 00:20:50,990
know let me know and you know keep it

503
00:20:50,990 --> 00:20:52,730
conversational I know I've just been

504
00:20:52,730 --> 00:20:55,850
kind of talking but you know interrupt

505
00:20:55,850 --> 00:20:57,620
me if you're confused about something or

506
00:20:57,620 --> 00:20:59,000
if you want to add something there's

507
00:20:59,000 --> 00:21:01,340
always something to learn you know I can

508
00:21:01,340 --> 00:21:02,779
definitely learn something as well from

509
00:21:02,779 --> 00:21:06,250
all this - so let's get into it

510
00:21:06,250 --> 00:21:08,840
hopefully this all works out so I'm

511
00:21:08,840 --> 00:21:11,710
going to open up one of my be ends here

512
00:21:11,710 --> 00:21:14,809
being my expected VM right and we're

513
00:21:14,809 --> 00:21:17,720
going to go through a few things and I

514
00:21:17,720 --> 00:21:20,510
have a long list of things over here on

515
00:21:20,510 --> 00:21:22,429
my other screen that I'm going to try to

516
00:21:22,429 --> 00:21:24,890
follow in order to ensure that we keep

517
00:21:24,890 --> 00:21:26,690
at you know and the right step

518
00:21:26,690 --> 00:21:28,279
throughout this process because there is

519
00:21:28,279 --> 00:21:29,750
a lot of there are a lot of steps

520
00:21:29,750 --> 00:21:32,360
involved in showing this so the first

521
00:21:32,360 --> 00:21:34,730
thing that we're going to do is we are

522
00:21:34,730 --> 00:21:38,110
actually going to focus on installing

523
00:21:38,110 --> 00:21:41,390
respond so oh let me make sure I don't

524
00:21:41,390 --> 00:21:42,799
make that mistake again for the third

525
00:21:42,799 --> 00:21:45,320
time today and that is to make sure that

526
00:21:45,320 --> 00:21:47,510
I run this as administrator

527
00:21:47,510 --> 00:21:49,159
right because if you're going to install

528
00:21:49,159 --> 00:21:50,659
so small you got to run as administrator

529
00:21:50,659 --> 00:21:52,309
so first thing I'm going to do is I'm

530
00:21:52,309 --> 00:21:56,390
actually going to go to the folder of my

531
00:21:56,390 --> 00:21:59,059
choosing and I forgot what the name is

532
00:21:59,059 --> 00:22:02,700
it's user I believe it's root and then

533
00:22:02,700 --> 00:22:06,470
cough and then I believe it's just fun

534
00:22:06,470 --> 00:22:09,060
there we go alright so in this route

535
00:22:09,060 --> 00:22:10,740
I almost typed LS for the third time

536
00:22:10,740 --> 00:22:14,970
today we see that we have a few folders

537
00:22:14,970 --> 00:22:17,550
here that are really important to us or

538
00:22:17,550 --> 00:22:18,690
couple files here they're really

539
00:22:18,690 --> 00:22:20,190
important to us so whenever it is you

540
00:22:20,190 --> 00:22:21,690
downloads this month you're going to be

541
00:22:21,690 --> 00:22:23,430
given these three files so something

542
00:22:23,430 --> 00:22:25,440
that I am going to do now is I'm going

543
00:22:25,440 --> 00:22:28,230
to show what the config looks like

544
00:22:28,230 --> 00:22:32,160
before we add it and run it all right so

545
00:22:32,160 --> 00:22:35,370
here we go notepad plus plus as I talked

546
00:22:35,370 --> 00:22:38,840
about earlier this is the base

547
00:22:38,840 --> 00:22:41,760
configuration I was provided by Swift on

548
00:22:41,760 --> 00:22:43,800
security really awesome

549
00:22:43,800 --> 00:22:45,090
I can't download it now because this

550
00:22:45,090 --> 00:22:46,920
machine is not connected to a network

551
00:22:46,920 --> 00:22:49,680
because we're going to inspect it so I

552
00:22:49,680 --> 00:22:51,480
don't want any of that stuff happening

553
00:22:51,480 --> 00:22:54,480
so a lot of stuff like it goes through

554
00:22:54,480 --> 00:22:58,220
each event and includes and excludes

555
00:22:58,220 --> 00:23:01,260
things that we don't need and it's a

556
00:23:01,260 --> 00:23:03,870
really good base configuration but as

557
00:23:03,870 --> 00:23:06,630
you can see it is really robust so I

558
00:23:06,630 --> 00:23:08,820
always keep copies of this everywhere in

559
00:23:08,820 --> 00:23:11,130
case I make a mistake which being an

560
00:23:11,130 --> 00:23:13,710
analyst you're going to make mistakes it

561
00:23:13,710 --> 00:23:15,930
happens all the time but having a backup

562
00:23:15,930 --> 00:23:17,910
even if config files it's super

563
00:23:17,910 --> 00:23:20,430
important all right so now we're going

564
00:23:20,430 --> 00:23:23,820
to move that into this folder and we're

565
00:23:23,820 --> 00:23:25,860
just gonna run it and I'm gonna show you

566
00:23:25,860 --> 00:23:28,650
just how easy it is to run this so sis

567
00:23:28,650 --> 00:23:32,790
lon - I for install and I'm just going

568
00:23:32,790 --> 00:23:37,190
to point it to the config file and

569
00:23:37,190 --> 00:23:40,560
that's it I mean that's super awesome

570
00:23:40,560 --> 00:23:44,070
super easy just to ensure that we're all

571
00:23:44,070 --> 00:23:46,340
on the same page we're going to go to

572
00:23:46,340 --> 00:23:51,210
the sir this is if I can spell this

573
00:23:51,210 --> 00:23:53,940
properly hopefully that's what it is

574
00:23:53,940 --> 00:23:56,160
that I'm looking for kind of strange but

575
00:23:56,160 --> 00:23:57,720
we're also going to show where this file

576
00:23:57,720 --> 00:24:02,090
is or where is log file is so C Drive

577
00:24:02,090 --> 00:24:04,500
going to be a lot of stuff opening up as

578
00:24:04,500 --> 00:24:07,440
we walk through this so just don't bear

579
00:24:07,440 --> 00:24:12,720
with it so windows system32 if anyone's

580
00:24:12,720 --> 00:24:14,280
curious about where all these logs are

581
00:24:14,280 --> 00:24:15,900
stored without having to go to the Event

582
00:24:15,900 --> 00:24:17,940
Viewer they're all going to be in here

583
00:24:17,940 --> 00:24:21,750
in a log section of this so there's some

584
00:24:21,750 --> 00:24:23,460
that we're familiar with here that we

585
00:24:23,460 --> 00:24:25,080
see a lot for example if you go all the

586
00:24:25,080 --> 00:24:26,370
way down you'll see like the security

587
00:24:26,370 --> 00:24:29,400
log which is something a lot of us may

588
00:24:29,400 --> 00:24:31,020
be familiar with with just like regular

589
00:24:31,020 --> 00:24:33,390
login events and things like that but

590
00:24:33,390 --> 00:24:35,370
now that we have installed this month we

591
00:24:35,370 --> 00:24:37,500
have this wonderful little system on

592
00:24:37,500 --> 00:24:39,300
event log that has already started

593
00:24:39,300 --> 00:24:42,510
collecting events so we're going to come

594
00:24:42,510 --> 00:24:44,910
in here and just look at it before we do

595
00:24:44,910 --> 00:24:47,160
anything bad I just see what it looks

596
00:24:47,160 --> 00:24:53,010
like so here we go and it logs a bunch

597
00:24:53,010 --> 00:24:54,900
of stuff so it may take a little bit of

598
00:24:54,900 --> 00:24:58,650
time to open up and I believe that this

599
00:24:58,650 --> 00:25:02,970
should sweating for it to finish up and

600
00:25:02,970 --> 00:25:05,700
we can start moving on to a couple other

601
00:25:05,700 --> 00:25:08,880
things here once this actually does work

602
00:25:08,880 --> 00:25:10,680
and of course is not responding because

603
00:25:10,680 --> 00:25:13,860
why would it and let's go all the way to

604
00:25:13,860 --> 00:25:16,920
the beginning right so pretty

605
00:25:16,920 --> 00:25:18,150
interesting there's some events here

606
00:25:18,150 --> 00:25:19,830
that we didn't go over we're just going

607
00:25:19,830 --> 00:25:22,830
to kind of walk through them so there's

608
00:25:22,830 --> 00:25:25,800
a event 16 which is for configuration

609
00:25:25,800 --> 00:25:28,520
state has changed this is when I gave

610
00:25:28,520 --> 00:25:32,370
system on the configuration and it logs

611
00:25:32,370 --> 00:25:36,030
us as hey you can say as changed this is

612
00:25:36,030 --> 00:25:37,830
really good to keep in mind whenever is

613
00:25:37,830 --> 00:25:39,230
that you're rolling this out to your

614
00:25:39,230 --> 00:25:41,130
environment and you want to make sure

615
00:25:41,130 --> 00:25:43,410
that all machines that are targeted with

616
00:25:43,410 --> 00:25:45,240
this change have actually changed

617
00:25:45,240 --> 00:25:47,820
you can monitor for this event ID to

618
00:25:47,820 --> 00:25:49,830
ensure that it actually did occur very

619
00:25:49,830 --> 00:25:51,420
important to make sure that everyone

620
00:25:51,420 --> 00:25:53,040
like all the missions you're monitoring

621
00:25:53,040 --> 00:25:55,220
for something specific are on the same

622
00:25:55,220 --> 00:25:59,340
configuration so in the service right so

623
00:25:59,340 --> 00:26:01,710
the service started so that denotes this

624
00:26:01,710 --> 00:26:03,180
month started as we would expect

625
00:26:03,180 --> 00:26:05,280
right and then we have a couple more

626
00:26:05,280 --> 00:26:07,050
here this is just showing a process

627
00:26:07,050 --> 00:26:08,550
great which is the one that we talked

628
00:26:08,550 --> 00:26:12,510
about a lot and it is sis Mon running as

629
00:26:12,510 --> 00:26:14,640
you saying that saman has ran from the

630
00:26:14,640 --> 00:26:18,420
services executable and you know we're

631
00:26:18,420 --> 00:26:20,460
just a couple things here and we're just

632
00:26:20,460 --> 00:26:22,050
going to come back to this in a second

633
00:26:22,050 --> 00:26:24,720
after we do something bad to the Machine

634
00:26:24,720 --> 00:26:27,300
and run some malware and we'll spend

635
00:26:27,300 --> 00:26:32,450
some time with that as well so here is

636
00:26:32,450 --> 00:26:35,160
where it is that we would find the

637
00:26:35,160 --> 00:26:38,820
actual service that were concerned with

638
00:26:38,820 --> 00:26:41,970
and it's right there and that is the

639
00:26:41,970 --> 00:26:44,040
service that was installed when it was a

640
00:26:44,040 --> 00:26:46,170
you ran the executable now really

641
00:26:46,170 --> 00:26:48,630
interesting service to monitor now there

642
00:26:48,630 --> 00:26:50,460
could be things that occur that certain

643
00:26:50,460 --> 00:26:53,790
services may restart or like you know

644
00:26:53,790 --> 00:26:56,940
stop for some reason so it may not be

645
00:26:56,940 --> 00:26:59,730
the best to always detect this because

646
00:26:59,730 --> 00:27:00,900
it doesn't necessarily mean that

647
00:27:00,900 --> 00:27:02,730
something bad occurred on the machine

648
00:27:02,730 --> 00:27:04,860
but I'm always interested to see the

649
00:27:04,860 --> 00:27:06,450
modification of services especially

650
00:27:06,450 --> 00:27:08,850
system on because if I was an attacker

651
00:27:08,850 --> 00:27:12,210
well then again it may it may alert

652
00:27:12,210 --> 00:27:13,620
somebody but let's just say that I was

653
00:27:13,620 --> 00:27:15,450
not concerned with someone monitoring

654
00:27:15,450 --> 00:27:18,630
the services starting or stopping on a

655
00:27:18,630 --> 00:27:20,940
machine but I was more concerned with

656
00:27:20,940 --> 00:27:23,640
hiding my tracks and not anyone you know

657
00:27:23,640 --> 00:27:25,710
in preventing analysts from being able

658
00:27:25,710 --> 00:27:29,070
to see some of my executables run or

659
00:27:29,070 --> 00:27:31,170
trigger any alerts related to any

660
00:27:31,170 --> 00:27:33,120
activity that I would be performing on

661
00:27:33,120 --> 00:27:35,250
the Box I would try to turn off the

662
00:27:35,250 --> 00:27:36,870
system on service especially if it's

663
00:27:36,870 --> 00:27:38,970
being sent to assume this would just

664
00:27:38,970 --> 00:27:42,420
stop any logs that would normally happen

665
00:27:42,420 --> 00:27:44,040
on system on from happening in the first

666
00:27:44,040 --> 00:27:46,440
place so that's one way of looking at it

667
00:27:46,440 --> 00:27:49,950
and that's where it's located here ok so

668
00:27:49,950 --> 00:27:52,350
now we have it installed we know where

669
00:27:52,350 --> 00:27:54,120
it's at we're going to go back to it in

670
00:27:54,120 --> 00:27:56,100
a little bit right so let's just like

671
00:27:56,100 --> 00:27:58,500
closes out we don't need that right now

672
00:27:58,500 --> 00:28:01,320
now I'm going to show something else

673
00:28:01,320 --> 00:28:04,620
that I think is really cool to look

674
00:28:04,620 --> 00:28:07,800
logs especially system on logs without

675
00:28:07,800 --> 00:28:12,090
using Event Viewer personally I I think

676
00:28:12,090 --> 00:28:14,430
that Event Viewer is very cumbersome I

677
00:28:14,430 --> 00:28:16,440
don't think that it's very easy to

678
00:28:16,440 --> 00:28:19,800
search through it's definitely my last

679
00:28:19,800 --> 00:28:23,670
resort so luckily Microsoft again I

680
00:28:23,670 --> 00:28:25,950
gotta give them props where props are

681
00:28:25,950 --> 00:28:28,140
due because not only did they create

682
00:28:28,140 --> 00:28:29,730
this internal and all that stuff they

683
00:28:29,730 --> 00:28:32,220
also created this which is log parsing

684
00:28:32,220 --> 00:28:35,430
studio so here and we're going to come

685
00:28:35,430 --> 00:28:37,710
back to this later after we run some bad

686
00:28:37,710 --> 00:28:41,820
stuff here it's really cool because you

687
00:28:41,820 --> 00:28:44,610
can feed it a query and you can point it

688
00:28:44,610 --> 00:28:47,280
to the location of a longer you're

689
00:28:47,280 --> 00:28:48,600
looking at it doesn't have to be system

690
00:28:48,600 --> 00:28:50,070
on it can be the security logs as well

691
00:28:50,070 --> 00:28:54,360
and you basically can parse out all the

692
00:28:54,360 --> 00:28:56,580
fields that are of interest and you can

693
00:28:56,580 --> 00:28:59,040
use this search to search for specific

694
00:28:59,040 --> 00:29:01,860
things that you find interesting so I

695
00:29:01,860 --> 00:29:05,070
like using this if I don't have a sim to

696
00:29:05,070 --> 00:29:07,080
be able to analyze different logs or a

697
00:29:07,080 --> 00:29:10,230
machine so we'll come back to this once

698
00:29:10,230 --> 00:29:13,380
we run the file and go to the process of

699
00:29:13,380 --> 00:29:16,110
pulling the system on log putting on a

700
00:29:16,110 --> 00:29:18,510
desktop and taking a look at it in this

701
00:29:18,510 --> 00:29:21,600
way of looking at it all right so now

702
00:29:21,600 --> 00:29:23,580
the file of interest is this file right

703
00:29:23,580 --> 00:29:27,480
here right and just to ensure that we're

704
00:29:27,480 --> 00:29:30,480
all on the same page let's take a look

705
00:29:30,480 --> 00:29:33,809
at what the world says about this file

706
00:29:33,809 --> 00:29:36,960
okay so let's hopefully I don't miss

707
00:29:36,960 --> 00:29:41,130
anything probably will and we have this

708
00:29:41,130 --> 00:29:44,490
file here right yes and in order for us

709
00:29:44,490 --> 00:29:47,220
to hash it or get the hash of it we're

710
00:29:47,220 --> 00:29:48,960
just going to do this just to check to

711
00:29:48,960 --> 00:29:53,370
see what it said about it so there goes

712
00:29:53,370 --> 00:29:55,590
our shall that get file hash command if

713
00:29:55,590 --> 00:29:57,630
anyone here is not familiar with it it's

714
00:29:57,630 --> 00:30:00,929
just a very easy command you can run on

715
00:30:00,929 --> 00:30:03,570
PowerShell to get the hashes of specific

716
00:30:03,570 --> 00:30:05,550
things you're looking at so I'm going to

717
00:30:05,550 --> 00:30:08,100
actually just open this up and we're

718
00:30:08,100 --> 00:30:09,330
just going to take a look to see what

719
00:30:09,330 --> 00:30:11,220
Assent says about it Osen being

720
00:30:11,220 --> 00:30:11,970
virustotal

721
00:30:11,970 --> 00:30:14,130
it's usually what I gravitate towards

722
00:30:14,130 --> 00:30:16,560
and so here we go

723
00:30:16,560 --> 00:30:18,490
Irish total

724
00:30:18,490 --> 00:30:21,639
kind of paste this here all right so

725
00:30:21,639 --> 00:30:23,889
that that is an indicator right there

726
00:30:23,889 --> 00:30:25,659
that this is definitely bad these are

727
00:30:25,659 --> 00:30:26,919
all different engines that are saying

728
00:30:26,919 --> 00:30:31,899
hey 52 out of 70 usually in most

729
00:30:31,899 --> 00:30:35,110
organizations do - how many signature

730
00:30:35,110 --> 00:30:37,119
hits this does have the likelihood of

731
00:30:37,119 --> 00:30:39,399
this file running properly in most

732
00:30:39,399 --> 00:30:42,570
organizations that have proper AV is low

733
00:30:42,570 --> 00:30:44,830
but of course things get around maybe

734
00:30:44,830 --> 00:30:47,499
but this is definitely a indicator as to

735
00:30:47,499 --> 00:30:50,200
this file probably not being bad like if

736
00:30:50,200 --> 00:30:51,970
I saw this I would it would warrant me

737
00:30:51,970 --> 00:30:54,460
looking a little bit deeper and I don't

738
00:30:54,460 --> 00:30:56,669
know how many of you are familiar with

739
00:30:56,669 --> 00:30:59,470
virustotal but basically I always pay

740
00:30:59,470 --> 00:31:01,659
attention to behavior side of things you

741
00:31:01,659 --> 00:31:04,990
see like what I expect it to do you know

742
00:31:04,990 --> 00:31:07,690
and what I should be looking for for

743
00:31:07,690 --> 00:31:10,600
this specific file for example we have

744
00:31:10,600 --> 00:31:13,960
some registry keys that are set we got

745
00:31:13,960 --> 00:31:17,830
this set as well which is interesting we

746
00:31:17,830 --> 00:31:21,220
got some deletions of keys as well so

747
00:31:21,220 --> 00:31:23,049
those are things that system on would

748
00:31:23,049 --> 00:31:26,139
help us to be able to see really cool

749
00:31:26,139 --> 00:31:28,570
stuff we also have some deletes and

750
00:31:28,570 --> 00:31:29,980
let's see if we have anything else that

751
00:31:29,980 --> 00:31:33,580
would warrant some interest um oh and we

752
00:31:33,580 --> 00:31:36,070
have a little DNS resolution here and

753
00:31:36,070 --> 00:31:38,830
I'm not sure what this is I can't really

754
00:31:38,830 --> 00:31:40,539
looked at this but why not just take a

755
00:31:40,539 --> 00:31:43,450
look see what it says about this

756
00:31:43,450 --> 00:31:47,289
so some reason it looks like no one

757
00:31:47,289 --> 00:31:48,940
really thinks that this is bad which I

758
00:31:48,940 --> 00:31:52,929
guess is okay in relations well here's

759
00:31:52,929 --> 00:31:55,749
something interesting for this dot biz

760
00:31:55,749 --> 00:31:57,039
which I don't know what it is I haven't

761
00:31:57,039 --> 00:31:59,470
really looked at it there are multiple

762
00:31:59,470 --> 00:32:01,960
files that have been scanned previously

763
00:32:01,960 --> 00:32:04,179
that communicate with it with very high

764
00:32:04,179 --> 00:32:05,860
detection rates I don't know what that

765
00:32:05,860 --> 00:32:06,999
means I don't know if this is just like

766
00:32:06,999 --> 00:32:10,450
people testing stuff but it does warrant

767
00:32:10,450 --> 00:32:12,879
some interest it's like okay well this

768
00:32:12,879 --> 00:32:15,580
might be a bad domain potentially we

769
00:32:15,580 --> 00:32:18,840
don't know that yet so that is just

770
00:32:18,840 --> 00:32:20,950
something to keep in mind something

771
00:32:20,950 --> 00:32:24,399
interesting and yeah so my son may come

772
00:32:24,399 --> 00:32:26,470
in here from time to time I'm home so

773
00:32:26,470 --> 00:32:28,539
just be aware of that better give me a

774
00:32:28,539 --> 00:32:32,419
second okay and so here we go let's

775
00:32:32,419 --> 00:32:34,279
focus on a few more things in regards to

776
00:32:34,279 --> 00:32:36,619
this file so one of the commands I think

777
00:32:36,619 --> 00:32:38,989
is really interesting if anyone here is

778
00:32:38,989 --> 00:32:41,179
not familiar with it might as well get

779
00:32:41,179 --> 00:32:42,710
some more information about what this

780
00:32:42,710 --> 00:32:45,789
file is and that is the strength command

781
00:32:45,789 --> 00:32:49,369
why would we want to run this well

782
00:32:49,369 --> 00:32:53,989
because it may detail what else we would

783
00:32:53,989 --> 00:32:57,649
like to know about this file based on

784
00:32:57,649 --> 00:33:01,549
any you see the me edit this based on

785
00:33:01,549 --> 00:33:05,179
anything that's readable of the file so

786
00:33:05,179 --> 00:33:07,700
this just looks at anything on this file

787
00:33:07,700 --> 00:33:11,090
that may be readable via ASCII and it

788
00:33:11,090 --> 00:33:13,009
just puts it on here and all I did was

789
00:33:13,009 --> 00:33:17,239
just throw it into a test text whatever

790
00:33:17,239 --> 00:33:19,340
a notepad and I'm just looking at it on

791
00:33:19,340 --> 00:33:21,980
notepad plus plus so something

792
00:33:21,980 --> 00:33:25,249
interesting that file looks like it's a

793
00:33:25,249 --> 00:33:27,710
PDF file well it's definitely not this

794
00:33:27,710 --> 00:33:29,749
is an executable and that can also be

795
00:33:29,749 --> 00:33:32,600
seen here where you know when we did a

796
00:33:32,600 --> 00:33:34,639
pad completion for that file definitely

797
00:33:34,639 --> 00:33:37,039
not a PDF but it has a picture of a PDF

798
00:33:37,039 --> 00:33:40,460
I mean that's attackers may do that from

799
00:33:40,460 --> 00:33:42,980
time to time and I don't know if there's

800
00:33:42,980 --> 00:33:44,299
anything in here I'm really look to this

801
00:33:44,299 --> 00:33:46,039
to see if there's anything that warrants

802
00:33:46,039 --> 00:33:49,220
more you know or gives us more

803
00:33:49,220 --> 00:33:50,659
information about this file but there

804
00:33:50,659 --> 00:33:53,230
are some interesting things here

805
00:33:53,230 --> 00:33:55,489
sometimes it does give you information

806
00:33:55,489 --> 00:33:57,409
as to like the communication at this

807
00:33:57,409 --> 00:34:00,019
file may have which i think is pretty

808
00:34:00,019 --> 00:34:02,840
cool um also looks like they left us a

809
00:34:02,840 --> 00:34:05,869
note here say being whoever created this

810
00:34:05,869 --> 00:34:08,119
moshus file the oldest and strongest

811
00:34:08,119 --> 00:34:09,739
emotion of mankind is fear and the

812
00:34:09,739 --> 00:34:12,559
oldest and strongest kind of fears fear

813
00:34:12,559 --> 00:34:15,139
the unknown awesome thank you I don't

814
00:34:15,139 --> 00:34:17,089
know I know what they were doing but uh

815
00:34:17,089 --> 00:34:18,859
oh yeah so there goes a nice little note

816
00:34:18,859 --> 00:34:21,049
from a potential attacker if you're

817
00:34:21,049 --> 00:34:22,389
looking at strange why not

818
00:34:22,389 --> 00:34:27,230
alright so that strings so now let's

819
00:34:27,230 --> 00:34:29,119
actually run the file and then we can

820
00:34:29,119 --> 00:34:31,429
start looking at system unrelated events

821
00:34:31,429 --> 00:34:34,129
for that file okay so we're going to run

822
00:34:34,129 --> 00:34:36,409
it and see what happens of course this

823
00:34:36,409 --> 00:34:40,280
is all part of my home lab this is not

824
00:34:40,280 --> 00:34:43,750
going to infect my actual host machine

825
00:34:43,750 --> 00:34:46,159
that would not be fun so

826
00:34:46,159 --> 00:34:51,289
here we go run it and it is speared

827
00:34:51,289 --> 00:34:54,399
alright so there is some self deletion

828
00:34:54,399 --> 00:34:57,020
characteristics to this file that's good

829
00:34:57,020 --> 00:34:57,440
to know

830
00:34:57,440 --> 00:34:59,240
so now let's start taking a look at

831
00:34:59,240 --> 00:35:06,230
stuff so we know that from old cent

832
00:35:06,230 --> 00:35:09,020
there should be some logging associated

833
00:35:09,020 --> 00:35:13,130
to what this file tries to do on sis Mon

834
00:35:13,130 --> 00:35:15,680
because this one does capture DNS

835
00:35:15,680 --> 00:35:17,510
requests like we talked about it does

836
00:35:17,510 --> 00:35:20,119
capture registry level events and it

837
00:35:20,119 --> 00:35:22,460
would also capture the fact that I just

838
00:35:22,460 --> 00:35:27,020
executed that file now the likelihood of

839
00:35:27,020 --> 00:35:30,170
a user just executing some random EDF

840
00:35:30,170 --> 00:35:33,319
file on their desktop is hopefully low

841
00:35:33,319 --> 00:35:37,880
but the likelihood of a user downloading

842
00:35:37,880 --> 00:35:43,250
a home a PDF from an email is really

843
00:35:43,250 --> 00:35:46,010
high we see that a lot phishing and all

844
00:35:46,010 --> 00:35:49,700
that good stuff right so hopefully AV

845
00:35:49,700 --> 00:35:51,890
stops most of those or you have

846
00:35:51,890 --> 00:35:53,869
restrictions in your environment to stop

847
00:35:53,869 --> 00:35:55,640
certain attachments from actually being

848
00:35:55,640 --> 00:35:58,549
able to get in or you set policies that

849
00:35:58,549 --> 00:36:01,599
you can set via you know group policy to

850
00:36:01,599 --> 00:36:05,270
file associate certain things like PDF

851
00:36:05,270 --> 00:36:07,609
files and executables to open up in

852
00:36:07,609 --> 00:36:11,210
notepad that actually renders a lot of

853
00:36:11,210 --> 00:36:14,809
attachments useless and things like

854
00:36:14,809 --> 00:36:16,430
email pet which a lot of us may hear

855
00:36:16,430 --> 00:36:19,099
about wouldn't necessarily work of

856
00:36:19,099 --> 00:36:21,140
course those are dependent on macros and

857
00:36:21,140 --> 00:36:23,450
all that good stuff but that's a side

858
00:36:23,450 --> 00:36:25,730
note just something to keep in mind this

859
00:36:25,730 --> 00:36:27,650
is something that does happen where

860
00:36:27,650 --> 00:36:31,490
users will open up a PDF and it

861
00:36:31,490 --> 00:36:33,710
disappears they're like our angle there

862
00:36:33,710 --> 00:36:35,119
was no alerts or anything to happen on

863
00:36:35,119 --> 00:36:37,460
my machine I guess I'm good to go why

864
00:36:37,460 --> 00:36:39,559
would I let you know the security folk

865
00:36:39,559 --> 00:36:41,420
know what's going on he's going to keep

866
00:36:41,420 --> 00:36:44,000
living my life so let's open this up and

867
00:36:44,000 --> 00:36:46,640
see what that file actually did after it

868
00:36:46,640 --> 00:36:48,680
you know basically deleted itself

869
00:36:48,680 --> 00:36:51,289
alright so when we first opened this we

870
00:36:51,289 --> 00:36:53,180
had like 15 events but since then we've

871
00:36:53,180 --> 00:36:55,880
done quite a lot of things so let's try

872
00:36:55,880 --> 00:37:00,490
to see what's happened here and we can

873
00:37:00,490 --> 00:37:03,650
kind of just goes through it alright so

874
00:37:03,650 --> 00:37:05,390
these are the ones that I showed in the

875
00:37:05,390 --> 00:37:06,500
beginning which basically shows that

876
00:37:06,500 --> 00:37:09,050
things were opened let's try to see some

877
00:37:09,050 --> 00:37:11,240
files here that are interesting so this

878
00:37:11,240 --> 00:37:16,420
is a log we just this as you can see

879
00:37:16,420 --> 00:37:18,410
anything on a vent view it can be a

880
00:37:18,410 --> 00:37:21,020
little bit difficult to use but this is

881
00:37:21,020 --> 00:37:23,840
basically running the log parser studio

882
00:37:23,840 --> 00:37:27,260
that we'll get to later on and it's

883
00:37:27,260 --> 00:37:29,060
really cool to be able to see things

884
00:37:29,060 --> 00:37:32,000
happening like that so we have log

885
00:37:32,000 --> 00:37:34,570
parser studio actually creating a file

886
00:37:34,570 --> 00:37:38,720
and that's interesting that looks not

887
00:37:38,720 --> 00:37:39,950
good but we're just going to keep moving

888
00:37:39,950 --> 00:37:44,840
on and PowerShell running right um and

889
00:37:44,840 --> 00:37:46,490
then power a PowerShell script being

890
00:37:46,490 --> 00:37:48,800
created and then here we go so now we

891
00:37:48,800 --> 00:37:50,810
see that this is the strings command

892
00:37:50,810 --> 00:37:52,880
that I run a little bit earlier via

893
00:37:52,880 --> 00:37:55,760
PowerShell and we do see that it is

894
00:37:55,760 --> 00:37:57,560
actually capturing the command line of

895
00:37:57,560 --> 00:38:01,070
this occurring always really cool and of

896
00:38:01,070 --> 00:38:03,170
course the parent would be PowerShell

897
00:38:03,170 --> 00:38:05,240
because we rent it from PowerShell which

898
00:38:05,240 --> 00:38:07,820
then launched the string which is the

899
00:38:07,820 --> 00:38:10,550
actual image in the strings is part of

900
00:38:10,550 --> 00:38:14,180
the PS tools um you know folder which is

901
00:38:14,180 --> 00:38:16,730
in system 32 I put it there and SSS

902
00:38:16,730 --> 00:38:19,010
internals tools estranged so that makes

903
00:38:19,010 --> 00:38:21,380
sense as to why even though we ran it on

904
00:38:21,380 --> 00:38:23,210
PowerShell PowerShell is considered to

905
00:38:23,210 --> 00:38:26,390
be the parent and image so ran strings

906
00:38:26,390 --> 00:38:28,160
against this it doesn't give us the

907
00:38:28,160 --> 00:38:29,960
output of course but it just shows us

908
00:38:29,960 --> 00:38:34,640
what occurred um so this is strings and

909
00:38:34,640 --> 00:38:37,790
the EULA being accepted valley being set

910
00:38:37,790 --> 00:38:38,810
no big deal

911
00:38:38,810 --> 00:38:42,140
notepad looking at strings or actually

912
00:38:42,140 --> 00:38:42,620
yeah

913
00:38:42,620 --> 00:38:45,500
opening up the output of that and a

914
00:38:45,500 --> 00:38:47,210
couple things that are windows related

915
00:38:47,210 --> 00:38:51,290
ok so here we go so this is the first

916
00:38:51,290 --> 00:38:54,110
event related to everything that

917
00:38:54,110 --> 00:38:57,740
occurred from from the point that I

918
00:38:57,740 --> 00:39:01,730
double clicked on the malicious file and

919
00:39:01,730 --> 00:39:04,100
forward so the first event that we have

920
00:39:04,100 --> 00:39:06,560
here is of the file launching itself

921
00:39:06,560 --> 00:39:08,960
right so I'm using Explorer right

922
00:39:08,960 --> 00:39:11,120
because Explorer is what you use when

923
00:39:11,120 --> 00:39:12,980
you're clicking on stuff and Explorer

924
00:39:12,980 --> 00:39:15,770
right the file explorer for example so i

925
00:39:15,770 --> 00:39:18,740
clicked on it it launched the process

926
00:39:18,740 --> 00:39:21,050
this is the exact same hash that we

927
00:39:21,050 --> 00:39:24,680
gathered from the get file hash command

928
00:39:24,680 --> 00:39:27,020
on powershell alright so that matches so

929
00:39:27,020 --> 00:39:28,550
this would be an indicator to look for

930
00:39:28,550 --> 00:39:30,920
this right and now let's see what

931
00:39:30,920 --> 00:39:35,390
happens first thing some reason it sets

932
00:39:35,390 --> 00:39:40,190
this it sets this value in the registry

933
00:39:40,190 --> 00:39:42,410
in this location so that's number one

934
00:39:42,410 --> 00:39:43,760
and of course a lot of these things are

935
00:39:43,760 --> 00:39:45,410
going to happen like at the same time

936
00:39:45,410 --> 00:39:47,869
because things move a lot faster on

937
00:39:47,869 --> 00:39:50,450
computers and we sometimes really think

938
00:39:50,450 --> 00:39:52,460
about and a lot of events can happen

939
00:39:52,460 --> 00:39:55,520
within the same second right so here is

940
00:39:55,520 --> 00:39:58,340
when it's really interesting and that is

941
00:39:58,340 --> 00:40:00,140
a value being set and this is something

942
00:40:00,140 --> 00:40:02,450
that we saw on the o sign of virustotal

943
00:40:02,450 --> 00:40:06,260
that goes to this location and set this

944
00:40:06,260 --> 00:40:10,700
value right this binary value to or this

945
00:40:10,700 --> 00:40:13,750
hex in the hexadecimal value of 2 for

946
00:40:13,750 --> 00:40:17,240
this which would make it so that if

947
00:40:17,240 --> 00:40:18,980
anyone's not familiar with what this is

948
00:40:18,980 --> 00:40:21,369
this basically hides the file

949
00:40:21,369 --> 00:40:24,080
so there's when we can look for that

950
00:40:24,080 --> 00:40:27,340
later so it's saying to hide it right

951
00:40:27,340 --> 00:40:31,730
file created so the image is the

952
00:40:31,730 --> 00:40:33,590
original file that we ran right the bad

953
00:40:33,590 --> 00:40:35,510
one I wish I would have called it bad

954
00:40:35,510 --> 00:40:36,859
bad exe or something would have been

955
00:40:36,859 --> 00:40:41,450
easier to remember that so for me so

956
00:40:41,450 --> 00:40:43,820
then the target file name is the file

957
00:40:43,820 --> 00:40:47,150
that was created and it's a bat file so

958
00:40:47,150 --> 00:40:48,530
the likelihood of that still being there

959
00:40:48,530 --> 00:40:51,710
probably low have you really looked into

960
00:40:51,710 --> 00:40:54,619
this specific executable to see too much

961
00:40:54,619 --> 00:40:56,900
of what it does let's just go there and

962
00:40:56,900 --> 00:40:59,600
see um if it's go there most likely it

963
00:40:59,600 --> 00:41:02,600
ran and just deleted itself or hid

964
00:41:02,600 --> 00:41:04,940
itself most likely that's what I would

965
00:41:04,940 --> 00:41:07,700
do and it's probably not there anymore

966
00:41:07,700 --> 00:41:09,770
so we have the app data no I don't have

967
00:41:09,770 --> 00:41:13,310
hidden things open hold on one second so

968
00:41:13,310 --> 00:41:16,700
I can add some hidden IDs all right AB

969
00:41:16,700 --> 00:41:19,490
data and we're going to go into the

970
00:41:19,490 --> 00:41:21,920
local I'm going to go into the temp

971
00:41:21,920 --> 00:41:24,109
folder there's a bunch of stuff here but

972
00:41:24,109 --> 00:41:25,760
the likelihood of seeing a bat file

973
00:41:25,760 --> 00:41:27,040
probably really

974
00:41:27,040 --> 00:41:32,090
and I don't see a bat file or anything

975
00:41:32,090 --> 00:41:35,680
that has the numbers are l1 to whatever

976
00:41:35,680 --> 00:41:39,619
so probably deleted itself next process

977
00:41:39,619 --> 00:41:42,200
create oh well that's to be expected

978
00:41:42,200 --> 00:41:44,810
so this parent right the parent image

979
00:41:44,810 --> 00:41:50,230
too bad file ran and it executed this

980
00:41:50,230 --> 00:41:54,170
after it created it okay so that makes

981
00:41:54,170 --> 00:41:56,150
sense it created this bat file we don't

982
00:41:56,150 --> 00:41:57,740
know what that pop file does we had a

983
00:41:57,740 --> 00:41:59,690
copy of it we can just open it up on a

984
00:41:59,690 --> 00:42:02,180
notepad and take a look at it see what

985
00:42:02,180 --> 00:42:03,590
it does but we don't necessarily have

986
00:42:03,590 --> 00:42:05,780
that at this moment but we do see that

987
00:42:05,780 --> 00:42:09,920
it did run it okay so that's step two of

988
00:42:09,920 --> 00:42:12,320
well step three it already did a few

989
00:42:12,320 --> 00:42:12,770
things

990
00:42:12,770 --> 00:42:15,710
it changed the registry it created a

991
00:42:15,710 --> 00:42:17,180
file and then it ran that file that it

992
00:42:17,180 --> 00:42:19,940
changed so and of course is all

993
00:42:19,940 --> 00:42:22,880
happening in same two seconds now this

994
00:42:22,880 --> 00:42:24,050
is another one that's interesting this

995
00:42:24,050 --> 00:42:25,730
is a this is something that I'm

996
00:42:25,730 --> 00:42:27,650
constantly looking for whenever it is

997
00:42:27,650 --> 00:42:31,310
that I'm hunting for anything in in our

998
00:42:31,310 --> 00:42:33,320
environment or the environment that you

999
00:42:33,320 --> 00:42:37,310
know I see as an analyst story it's run

1000
00:42:37,310 --> 00:42:40,940
keys the run once or the run key so as

1001
00:42:40,940 --> 00:42:44,240
you can see here it's set up this run

1002
00:42:44,240 --> 00:42:48,740
one key on the registry from this bad

1003
00:42:48,740 --> 00:42:49,400
file

1004
00:42:49,400 --> 00:42:53,300
in order to execute this every time this

1005
00:42:53,300 --> 00:42:56,390
key runs make sense we don't know what

1006
00:42:56,390 --> 00:42:59,420
this does but the likelihood of it being

1007
00:42:59,420 --> 00:43:02,300
there is probably low but it's there so

1008
00:43:02,300 --> 00:43:04,369
now we have another indicator and let's

1009
00:43:04,369 --> 00:43:08,300
actually let's start taking some some

1010
00:43:08,300 --> 00:43:13,839
notes here as we learn more we have this

1011
00:43:13,839 --> 00:43:18,589
target object and let's go here just a

1012
00:43:18,589 --> 00:43:22,339
nice copy pasting and we have the bat

1013
00:43:22,339 --> 00:43:24,830
file let's go back to that just to have

1014
00:43:24,830 --> 00:43:30,470
this so it's just going to say file

1015
00:43:30,470 --> 00:43:35,599
create alright and so we have a few

1016
00:43:35,599 --> 00:43:37,760
things that happened right so let's go

1017
00:43:37,760 --> 00:43:40,280
back to it wow this is running the file

1018
00:43:40,280 --> 00:43:42,170
this is the run ones kita we're just

1019
00:43:42,170 --> 00:43:44,710
talking about now this one's interesting

1020
00:43:44,710 --> 00:43:47,060
this matches exactly what we saw on

1021
00:43:47,060 --> 00:43:49,070
virus all right I believe it's

1022
00:43:49,070 --> 00:43:50,690
word-for-word the exact same same

1023
00:43:50,690 --> 00:43:52,100
actually out in the screen it's why I'm

1024
00:43:52,100 --> 00:43:53,960
looking away and I believe that that's

1025
00:43:53,960 --> 00:43:56,450
totally the same yep

1026
00:43:56,450 --> 00:44:02,240
same mom URL or yeah same domain so

1027
00:44:02,240 --> 00:44:04,340
that's another indicator that's

1028
00:44:04,340 --> 00:44:06,260
supported by all sent whenever it is

1029
00:44:06,260 --> 00:44:07,100
you're looking for

1030
00:44:07,100 --> 00:44:10,040
you know something malicious so it did

1031
00:44:10,040 --> 00:44:15,860
attempt to query DNS for this to be able

1032
00:44:15,860 --> 00:44:18,590
to gain information about what this

1033
00:44:18,590 --> 00:44:20,570
domain is or where it's located to be

1034
00:44:20,570 --> 00:44:23,000
able to initiate the second stage of

1035
00:44:23,000 --> 00:44:25,070
this we don't know why it's reaching out

1036
00:44:25,070 --> 00:44:26,980
to this domain but for some reason it is

1037
00:44:26,980 --> 00:44:29,540
but something to keep in mind is that

1038
00:44:29,540 --> 00:44:31,580
the query results are empty and the

1039
00:44:31,580 --> 00:44:33,650
reason for that is because the DNS query

1040
00:44:33,650 --> 00:44:36,680
did not work if it would have worked so

1041
00:44:36,680 --> 00:44:40,430
sis Mon dns events actually captured the

1042
00:44:40,430 --> 00:44:43,880
query and the response all in the same

1043
00:44:43,880 --> 00:44:46,010
log so that that took you some time to

1044
00:44:46,010 --> 00:44:49,070
like remember because I'm so used to

1045
00:44:49,070 --> 00:44:50,930
seeing two different types of things

1046
00:44:50,930 --> 00:44:54,110
when you're looking at packets but this

1047
00:44:54,110 --> 00:44:56,270
captures both and the fact that the

1048
00:44:56,270 --> 00:44:59,810
query is not there the the query result

1049
00:44:59,810 --> 00:45:02,390
is not there means it wasn't successful

1050
00:45:02,390 --> 00:45:05,960
and actually querying that domain for

1051
00:45:05,960 --> 00:45:09,830
the IP so sometimes I look to see you

1052
00:45:09,830 --> 00:45:12,140
know requests that are being made that

1053
00:45:12,140 --> 00:45:15,080
don't succeed for some reason especially

1054
00:45:15,080 --> 00:45:18,650
if the machine has you know it's connect

1055
00:45:18,650 --> 00:45:20,390
to the network why is it not working

1056
00:45:20,390 --> 00:45:23,060
what's going on you know with that

1057
00:45:23,060 --> 00:45:26,360
domain that is trying to reach so that's

1058
00:45:26,360 --> 00:45:28,370
another indicator that we have right so

1059
00:45:28,370 --> 00:45:31,190
let's take a look at that and we're

1060
00:45:31,190 --> 00:45:33,500
going to put that here because we're

1061
00:45:33,500 --> 00:45:36,160
just trying to take some notes of course

1062
00:45:36,160 --> 00:45:38,210
one of the most important things that an

1063
00:45:38,210 --> 00:45:40,220
analyst does is the report that they

1064
00:45:40,220 --> 00:45:43,430
create about a specific event something

1065
00:45:43,430 --> 00:45:44,900
that I probably need to spend a little

1066
00:45:44,900 --> 00:45:47,360
bit more time doing you know because I

1067
00:45:47,360 --> 00:45:48,710
find this other stuff so much more

1068
00:45:48,710 --> 00:45:49,250
interesting

1069
00:45:49,250 --> 00:45:51,110
let's do good take notes while you're

1070
00:45:51,110 --> 00:45:52,610
looking at stuff just to you know

1071
00:45:52,610 --> 00:45:53,840
further

1072
00:45:53,840 --> 00:45:57,110
in force or further you know emphasize

1073
00:45:57,110 --> 00:45:58,790
what happened to lead to some kind of

1074
00:45:58,790 --> 00:46:01,070
mitigation effort so let's keep going up

1075
00:46:01,070 --> 00:46:04,760
the list keep seeing this hidden thing

1076
00:46:04,760 --> 00:46:07,520
occur and it keeps triggering the same D

1077
00:46:07,520 --> 00:46:10,610
word change so let's keep going into

1078
00:46:10,610 --> 00:46:11,660
here and see if anything else is

1079
00:46:11,660 --> 00:46:12,830
different

1080
00:46:12,830 --> 00:46:15,290
so I don't see anything besides those

1081
00:46:15,290 --> 00:46:18,380
two constantly happening there's a clear

1082
00:46:18,380 --> 00:46:21,470
name for star at this point my guess is

1083
00:46:21,470 --> 00:46:23,450
that is trying anything at this point

1084
00:46:23,450 --> 00:46:25,070
because it's failed the first time and

1085
00:46:25,070 --> 00:46:26,390
it wasn't able to get to it so it's like

1086
00:46:26,390 --> 00:46:29,030
hey can I reach something to see that

1087
00:46:29,030 --> 00:46:31,580
this machine does have you know

1088
00:46:31,580 --> 00:46:34,280
any kind of network activity and if we

1089
00:46:34,280 --> 00:46:35,630
keep going we're going to see the same

1090
00:46:35,630 --> 00:46:39,320
stuff it appears that it's just setting

1091
00:46:39,320 --> 00:46:42,500
that key trying to run it over it over

1092
00:46:42,500 --> 00:46:43,970
and over and over and over again so it

1093
00:46:43,970 --> 00:46:46,670
installed some level of persistence so

1094
00:46:46,670 --> 00:46:50,240
now um well let's take a look at that I

1095
00:46:50,240 --> 00:46:52,070
think that's always interesting

1096
00:46:52,070 --> 00:47:02,630
I just can't spell right no problem now

1097
00:47:02,630 --> 00:47:04,220
there's many tools out there that you

1098
00:47:04,220 --> 00:47:06,520
know can be used in order to review

1099
00:47:06,520 --> 00:47:10,130
certain things within the registry you

1100
00:47:10,130 --> 00:47:11,390
know you can take snapshots of a

1101
00:47:11,390 --> 00:47:13,250
registry before you actually run

1102
00:47:13,250 --> 00:47:15,640
something and compare against it like

1103
00:47:15,640 --> 00:47:18,020
autoruns tools and things like that I

1104
00:47:18,020 --> 00:47:19,340
felt like that was a little bit outside

1105
00:47:19,340 --> 00:47:21,440
of the scope for this conversation so

1106
00:47:21,440 --> 00:47:24,260
instead it should just you know look at

1107
00:47:24,260 --> 00:47:26,000
the registry and take a look at these

1108
00:47:26,000 --> 00:47:29,240
entries that we've seen so one of the

1109
00:47:29,240 --> 00:47:31,250
things that we know occurred right is

1110
00:47:31,250 --> 00:47:34,580
that this was changed so let's actually

1111
00:47:34,580 --> 00:47:40,550
take a look at this and that's from here

1112
00:47:40,550 --> 00:47:43,520
and hopefully this copy/paste works

1113
00:47:43,520 --> 00:47:46,520
if not we'll just start taking a look at

1114
00:47:46,520 --> 00:47:48,860
where we're at and every go back one so

1115
00:47:48,860 --> 00:47:51,740
we have B let's see what we did we it we

1116
00:47:51,740 --> 00:47:57,650
got this scene we're all the way down

1117
00:47:57,650 --> 00:48:02,810
Microsoft current version Explorer fans

1118
00:48:02,810 --> 00:48:07,040
okay we're here um and that's it so

1119
00:48:07,040 --> 00:48:07,310
we're

1120
00:48:07,310 --> 00:48:09,800
you see hidden and we see that the two

1121
00:48:09,800 --> 00:48:13,490
value has been set from my experience

1122
00:48:13,490 --> 00:48:16,250
the two value means that it is indeed

1123
00:48:16,250 --> 00:48:18,350
hidden I believe the one value from

1124
00:48:18,350 --> 00:48:20,180
previous research I've done means that

1125
00:48:20,180 --> 00:48:23,410
it's available and it's setting it or

1126
00:48:23,410 --> 00:48:27,680
this file to go back to here for the

1127
00:48:27,680 --> 00:48:31,390
file for armed not this one actually

1128
00:48:31,390 --> 00:48:35,000
this is another file but let's see if we

1129
00:48:35,000 --> 00:48:36,640
can find it

1130
00:48:36,640 --> 00:48:39,670
nope that's not what we want to do um

1131
00:48:39,670 --> 00:48:43,970
okay so let's focus on this too so it's

1132
00:48:43,970 --> 00:48:47,060
setting that value to hide itself which

1133
00:48:47,060 --> 00:48:49,490
would make sense with what we saw when

1134
00:48:49,490 --> 00:48:51,620
we executed the file as well but then

1135
00:48:51,620 --> 00:48:54,110
deleted it high eight hit it right so if

1136
00:48:54,110 --> 00:48:57,140
we go back to the registry and just take

1137
00:48:57,140 --> 00:49:03,170
a quick look at this and we are nope not

1138
00:49:03,170 --> 00:49:06,140
we want of course the demo so let's hope

1139
00:49:06,140 --> 00:49:09,860
it works we got to go to software so

1140
00:49:09,860 --> 00:49:11,920
let's just focus on that for now

1141
00:49:11,920 --> 00:49:20,030
software 21s Microsoft let's go back to

1142
00:49:20,030 --> 00:49:24,140
this key there we go so this shows you

1143
00:49:24,140 --> 00:49:29,660
that this actually is set so that it

1144
00:49:29,660 --> 00:49:33,170
continues to run that file um so this is

1145
00:49:33,170 --> 00:49:35,030
something that a lot of malicious files

1146
00:49:35,030 --> 00:49:38,090
do to install persistence and do what it

1147
00:49:38,090 --> 00:49:40,880
wants to do right and due to the fact

1148
00:49:40,880 --> 00:49:42,110
that it's hitting the likelihood of

1149
00:49:42,110 --> 00:49:44,060
being able to see that it's probably

1150
00:49:44,060 --> 00:49:47,270
pretty low but there's no reason why we

1151
00:49:47,270 --> 00:49:49,400
can't try to take a look at it and see

1152
00:49:49,400 --> 00:49:50,930
if I can actually look at it yeah there

1153
00:49:50,930 --> 00:49:53,060
we go so let's go into this directory

1154
00:49:53,060 --> 00:49:57,170
and take a look since it's still trying

1155
00:49:57,170 --> 00:49:59,660
to you know go there it would make sense

1156
00:49:59,660 --> 00:50:03,380
if it's there right why would it not be

1157
00:50:03,380 --> 00:50:06,530
on the disk so when you do an LS you see

1158
00:50:06,530 --> 00:50:09,170
nothing is there right of course not why

1159
00:50:09,170 --> 00:50:10,880
would it be there especially since we

1160
00:50:10,880 --> 00:50:13,970
saw the key was set to hide this so

1161
00:50:13,970 --> 00:50:17,900
let's do an LS - hidden I believe so

1162
00:50:17,900 --> 00:50:21,500
right word for that so we see the

1163
00:50:21,500 --> 00:50:25,530
folder which is matching exactly we saw

1164
00:50:25,530 --> 00:50:27,900
there that's how it is trying to hide

1165
00:50:27,900 --> 00:50:32,720
itself so let's actually go into that

1166
00:50:34,640 --> 00:50:36,869
all right so we are there even though

1167
00:50:36,869 --> 00:50:38,489
we're going to show that right LS again

1168
00:50:38,489 --> 00:50:40,259
of course not going to show that

1169
00:50:40,259 --> 00:50:45,029
anything is there but when we do the

1170
00:50:45,029 --> 00:50:47,459
hitting flag for this command we do see

1171
00:50:47,459 --> 00:50:50,699
that it's executable is here and my

1172
00:50:50,699 --> 00:50:53,969
guess is it's randomly named executable

1173
00:50:53,969 --> 00:51:02,940
is probably the same same hash as the

1174
00:51:02,940 --> 00:51:05,789
previous one that we ran a long time ago

1175
00:51:05,789 --> 00:51:11,369
so let's go back into the history oh not

1176
00:51:11,369 --> 00:51:13,079
there anymore because it deleted I

1177
00:51:13,079 --> 00:51:15,509
think but I believe that that's the

1178
00:51:15,509 --> 00:51:18,259
exact same hash that we saw previously

1179
00:51:18,259 --> 00:51:21,150
and we can probably just verify that 1

1180
00:51:21,150 --> 00:51:24,349
second on virustotal

1181
00:51:24,349 --> 00:51:32,579
mmm and this sort of summary and this is

1182
00:51:32,579 --> 00:51:39,049
what we got let's smooth this over and

1183
00:51:39,049 --> 00:51:45,719
here we go 1 5 C 3 ECC yep fe e so what

1184
00:51:45,719 --> 00:51:48,390
that means is that they are necessary

1185
00:51:48,390 --> 00:51:50,880
delete itself renamed itself and put

1186
00:51:50,880 --> 00:51:54,569
itself into that directory hit itself

1187
00:51:54,569 --> 00:51:57,209
set a key to be able to change the

1188
00:51:57,209 --> 00:52:00,359
registry and run it in order to make

1189
00:52:00,359 --> 00:52:01,650
that connection

1190
00:52:01,650 --> 00:52:04,170
outbound in order to get the secondary

1191
00:52:04,170 --> 00:52:06,779
payload which we stopped due to the fact

1192
00:52:06,779 --> 00:52:08,579
that you know this is not actually

1193
00:52:08,579 --> 00:52:11,249
connected to the network in order to

1194
00:52:11,249 --> 00:52:15,660
actually allow this to succeed so we

1195
00:52:15,660 --> 00:52:18,329
went through a lot there which is a lot

1196
00:52:18,329 --> 00:52:20,609
of fun I mean this stuff is what I try

1197
00:52:20,609 --> 00:52:22,440
to do almost on a daily basis at work

1198
00:52:22,440 --> 00:52:24,869
and let's try to look at it for these

1199
00:52:24,869 --> 00:52:26,969
logs in a different location so let's

1200
00:52:26,969 --> 00:52:28,920
make sure this is close actually because

1201
00:52:28,920 --> 00:52:31,709
it will complain so let's do a nice

1202
00:52:31,709 --> 00:52:37,229
little copy-paste should work ok good

1203
00:52:37,229 --> 00:52:41,219
and I don't know if the query that I'm

1204
00:52:41,219 --> 00:52:44,670
going to run is going to work because it

1205
00:52:44,670 --> 00:52:47,640
is an older query that I pulled a long

1206
00:52:47,640 --> 00:52:48,240
time

1207
00:52:48,240 --> 00:52:51,810
I don't necessarily know if it's

1208
00:52:51,810 --> 00:52:54,120
accurate and it's parsing but here goes

1209
00:52:54,120 --> 00:52:57,600
a template that we can use with log

1210
00:52:57,600 --> 00:53:00,060
parser studio and again this is to look

1211
00:53:00,060 --> 00:53:03,240
at sis Mon without having to go on to

1212
00:53:03,240 --> 00:53:09,510
the actual um Event Viewer which again

1213
00:53:09,510 --> 00:53:10,980
maybe there's people out there that

1214
00:53:10,980 --> 00:53:12,210
actually enjoy to use it

1215
00:53:12,210 --> 00:53:15,990
I personally don't so this is what it

1216
00:53:15,990 --> 00:53:18,900
looks like and what we want to do is go

1217
00:53:18,900 --> 00:53:22,860
to point it to this specific folder so

1218
00:53:22,860 --> 00:53:24,530
instead of typing all that out because

1219
00:53:24,530 --> 00:53:27,300
who enjoys the type right we're going to

1220
00:53:27,300 --> 00:53:29,910
go and just get the path in order to

1221
00:53:29,910 --> 00:53:34,020
ensure that we can point this query

1222
00:53:34,020 --> 00:53:36,900
properly within the log partial studio

1223
00:53:36,900 --> 00:53:41,250
start running it so where is it actually

1224
00:53:41,250 --> 00:53:42,450
it's Microsoft

1225
00:53:42,450 --> 00:53:46,230
let me just type it here persona awesome

1226
00:53:46,230 --> 00:53:49,470
copy paste and we're going to put that

1227
00:53:49,470 --> 00:53:53,810
right in here there you go what we do is

1228
00:53:53,810 --> 00:54:00,900
copy paste that and we paste it right

1229
00:54:00,900 --> 00:54:03,900
here into the new query section and then

1230
00:54:03,900 --> 00:54:05,040
what we're going to do is we're going to

1231
00:54:05,040 --> 00:54:08,430
set the log type to event log that's

1232
00:54:08,430 --> 00:54:09,660
what it's and as you can see here

1233
00:54:09,660 --> 00:54:11,970
there's many logs or you can use that

1234
00:54:11,970 --> 00:54:14,150
you can put in here and parse them out

1235
00:54:14,150 --> 00:54:16,050
again I don't know if there's going to

1236
00:54:16,050 --> 00:54:17,970
work properly or as good as it should

1237
00:54:17,970 --> 00:54:20,310
probably work because I don't

1238
00:54:20,310 --> 00:54:24,330
necessarily know if if it's parsing

1239
00:54:24,330 --> 00:54:26,340
properly since there has been changes

1240
00:54:26,340 --> 00:54:28,320
with system on since the last time that

1241
00:54:28,320 --> 00:54:31,500
I ran this so now runs that you press a

1242
00:54:31,500 --> 00:54:33,990
little little red icon here oh man it

1243
00:54:33,990 --> 00:54:35,400
did parse some stuff out but it looks

1244
00:54:35,400 --> 00:54:38,790
like there are some issues but we talked

1245
00:54:38,790 --> 00:54:39,540
about in the beginning of this

1246
00:54:39,540 --> 00:54:43,410
presentation or this demo is you can

1247
00:54:43,410 --> 00:54:46,680
actually search keywords and that is the

1248
00:54:46,680 --> 00:54:48,840
beauty of this because instead of

1249
00:54:48,840 --> 00:54:52,590
analyzing everything one by one I can

1250
00:54:52,590 --> 00:54:55,710
actually see things that occurred based

1251
00:54:55,710 --> 00:54:57,840
on the events right like this being one

1252
00:54:57,840 --> 00:55:00,420
which is an event um a process create

1253
00:55:00,420 --> 00:55:01,890
which shows the first time

1254
00:55:01,890 --> 00:55:04,020
it actually ran and then just basically

1255
00:55:04,020 --> 00:55:08,370
ensure that the time is set up properly

1256
00:55:08,370 --> 00:55:12,330
right we have the time here and then we

1257
00:55:12,330 --> 00:55:14,490
have I think this is set the way that we

1258
00:55:14,490 --> 00:55:16,620
want it right so this is going up and

1259
00:55:16,620 --> 00:55:19,320
this is going down and then it just

1260
00:55:19,320 --> 00:55:20,610
shows you know everything that occurred

1261
00:55:20,610 --> 00:55:24,930
within you know that matches that for

1262
00:55:24,930 --> 00:55:28,290
this file right super awesome as you can

1263
00:55:28,290 --> 00:55:30,150
see it's continuously trying to run that

1264
00:55:30,150 --> 00:55:33,030
over and over and over again but yeah I

1265
00:55:33,030 --> 00:55:35,280
mean that is how you can use this and

1266
00:55:35,280 --> 00:55:36,660
maybe parse this out just a little bit

1267
00:55:36,660 --> 00:55:38,820
better because it seems like it's not

1268
00:55:38,820 --> 00:55:41,030
know working as it should

1269
00:55:41,030 --> 00:55:44,070
unfortunately but this is how you would

1270
00:55:44,070 --> 00:55:46,950
use a log parser studio instead of

1271
00:55:46,950 --> 00:55:49,760
Windows Event Viewer in order to

1272
00:55:49,760 --> 00:55:52,910
actually view these system on that's

1273
00:55:52,910 --> 00:55:57,180
that's kind of most of what I have here

1274
00:55:57,180 --> 00:56:00,600
to show if anyone has any questions or

1275
00:56:00,600 --> 00:56:02,070
anyone wants to see anything else

1276
00:56:02,070 --> 00:56:05,340
related to this let me know again and

1277
00:56:05,340 --> 00:56:07,890
I've been talking about time but

1278
00:56:07,890 --> 00:56:10,620
hopefully this is helpful - smells

1279
00:56:10,620 --> 00:56:11,100
amazing

1280
00:56:11,100 --> 00:56:14,190
reach out to me if you want you know to

1281
00:56:14,190 --> 00:56:15,570
find out more about this or anything

1282
00:56:15,570 --> 00:56:17,940
that you can do to teach this to

1283
00:56:17,940 --> 00:56:19,680
yourself or to others or anything like

1284
00:56:19,680 --> 00:56:23,190
that and I will be putting the slides on

1285
00:56:23,190 --> 00:56:27,180
the slack after this presentation and

1286
00:56:27,180 --> 00:56:28,950
you know you can reach out to me there

1287
00:56:28,950 --> 00:56:31,860
as well so that's all I've got for right

1288
00:56:31,860 --> 00:56:38,640
now Chris yeah hey hey okay and also so

1289
00:56:38,640 --> 00:56:40,170
thank you again and we're gonna we've

1290
00:56:40,170 --> 00:56:41,820
recorded this presentation we're gonna

1291
00:56:41,820 --> 00:56:44,700
be posting this to the hack Miami

1292
00:56:44,700 --> 00:56:48,630
YouTube channel as well and I'd like to

1293
00:56:48,630 --> 00:56:50,400
just remind everybody that there's going

1294
00:56:50,400 --> 00:56:53,280
to be a P hack talk after this and the

1295
00:56:53,280 --> 00:56:55,350
the way to get into that is going to be

1296
00:56:55,350 --> 00:56:57,630
posted in slack if you're not in slack

1297
00:56:57,630 --> 00:56:59,760
and you want the details I can um I can

1298
00:56:59,760 --> 00:57:01,920
go ahead and try to find them and post

1299
00:57:01,920 --> 00:57:04,230
them to this chat so just hang back for

1300
00:57:04,230 --> 00:57:06,330
a little and before I exit the chat I'll

1301
00:57:06,330 --> 00:57:08,370
go ahead and I'll post those details in

1302
00:57:08,370 --> 00:57:10,530
this chat

1303
00:57:10,530 --> 00:57:13,870
okay thanks McGrath boom there that went

1304
00:57:13,870 --> 00:57:15,910
right into the chat are you thank you

1305
00:57:15,910 --> 00:57:18,460
and I didn't have to do a thing and it

1306
00:57:18,460 --> 00:57:19,420
starts in an hour

1307
00:57:19,420 --> 00:57:21,340
okay so you look at this productivity

1308
00:57:21,340 --> 00:57:24,250
synergy that's what's up all right so um

1309
00:57:24,250 --> 00:57:26,530
hey this you you guys are still welcome

1310
00:57:26,530 --> 00:57:28,720
to go out for a beer after this you just

1311
00:57:28,720 --> 00:57:30,430
might want to just have it by yourself

1312
00:57:30,430 --> 00:57:34,060
in your own yard or something we can

1313
00:57:34,060 --> 00:57:35,530
have beers the whole time that's the

1314
00:57:35,530 --> 00:57:38,560
beauty of personal meeting that see see

1315
00:57:38,560 --> 00:57:40,390
these are the on the Florida people

1316
00:57:40,390 --> 00:57:41,890
we're prepared for this we're like oh

1317
00:57:41,890 --> 00:57:42,820
this is like a hurricane

1318
00:57:42,820 --> 00:57:45,190
stock up on beer and I don't get the

1319
00:57:45,190 --> 00:57:48,640
toilet okay so we would like to open up

1320
00:57:48,640 --> 00:57:50,890
the floor anybody that would like to ask

1321
00:57:50,890 --> 00:57:53,170
a question you can either post it in

1322
00:57:53,170 --> 00:57:55,900
chat and I will relay the question to

1323
00:57:55,900 --> 00:57:58,750
Chris for y'all shy folks I get it um

1324
00:57:58,750 --> 00:58:02,020
for the rest of you that want to be

1325
00:58:02,020 --> 00:58:03,700
renegades you can unmute yourself ask

1326
00:58:03,700 --> 00:58:06,810
your question and that chris is prepared

1327
00:58:06,810 --> 00:58:18,280
yeah let's talk about it it's fun I

1328
00:58:18,280 --> 00:58:23,350
should have go ahead hey it's Matt Lee

1329
00:58:23,350 --> 00:58:24,390
how you doin

1330
00:58:24,390 --> 00:58:26,500
so here's my question when you were

1331
00:58:26,500 --> 00:58:28,840
showing the log parser app which is

1332
00:58:28,840 --> 00:58:29,860
really cool is my first time actually

1333
00:58:29,860 --> 00:58:31,090
really taking a look at that

1334
00:58:31,090 --> 00:58:32,950
what did without going into too much

1335
00:58:32,950 --> 00:58:34,840
detail just when I start using it how am

1336
00:58:34,840 --> 00:58:36,250
I gonna know if it's showing me the

1337
00:58:36,250 --> 00:58:37,600
right info or not like you were able to

1338
00:58:37,600 --> 00:58:39,100
identify that something was wrong

1339
00:58:39,100 --> 00:58:43,270
what what what led you to that so let's

1340
00:58:43,270 --> 00:58:45,880
see if we can show that here really

1341
00:58:45,880 --> 00:58:49,330
quick so it's all dependent on the

1342
00:58:49,330 --> 00:58:51,700
tokens that you're extracting based on

1343
00:58:51,700 --> 00:58:54,070
specific fields that you should expect I

1344
00:58:54,070 --> 00:58:57,730
will say that doing a quick search for

1345
00:58:57,730 --> 00:59:00,490
other queries related to log parks or

1346
00:59:00,490 --> 00:59:02,560
studio may be beneficial because a lot

1347
00:59:02,560 --> 00:59:04,420
of people have collections of these

1348
00:59:04,420 --> 00:59:06,370
things on github for example which is

1349
00:59:06,370 --> 00:59:08,710
very helpful but you'll start to see

1350
00:59:08,710 --> 00:59:11,380
that things are missing this is these

1351
00:59:11,380 --> 00:59:13,330
are examples like all this stuff like

1352
00:59:13,330 --> 00:59:14,980
none of none of the hashes are being

1353
00:59:14,980 --> 00:59:17,740
captured of things that I would expect

1354
00:59:17,740 --> 00:59:21,520
to be here that I put into the extract

1355
00:59:21,520 --> 00:59:23,980
query are not here that's

1356
00:59:23,980 --> 00:59:25,660
started to notice okay yeah this is not

1357
00:59:25,660 --> 00:59:29,560
working completely but yeah thank you

1358
00:59:29,560 --> 00:59:32,910
that make sense hopefully that helps

1359
00:59:37,080 --> 00:59:40,230
I feel like this is one of those like if

1360
00:59:40,230 --> 00:59:42,330
everything's quiet for 30 seconds we

1361
00:59:42,330 --> 00:59:45,450
just decided to call this this uh this a

1362
00:59:45,450 --> 00:59:51,120
day yes which is fine all right guys

1363
00:59:51,120 --> 00:59:52,950
really really appreciate you guys coming

1364
00:59:52,950 --> 00:59:54,720
out hope to see everybody again in an

1365
00:59:54,720 --> 00:59:57,890
hour thank you thank you thank you Chris

1366
00:59:57,890 --> 01:00:03,350
of course yes thank you Chris I'm good

1367
01:00:03,810 --> 01:00:08,490
thank you all for presentation guys

1368
01:00:08,490 --> 01:00:18,420
enjoy your weekend honey I'm gonna shut

1369
01:00:18,420 --> 01:00:21,800
it down good call it

1370
01:00:21,800 --> 01:00:25,040
honey's gone

