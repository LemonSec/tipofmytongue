1
00:00:04,690 --> 00:00:27,070
hello everybody my name is rob my handle
is glucose which means a duck-billed

2
00:00:27,070 --> 00:00:32,289
platypus in Russian I know this is
probably one of the only locations or

3
00:00:32,289 --> 00:00:36,909
conferences where I don't have to
translate it for most people but so

4
00:00:36,909 --> 00:00:42,550
balkon is has become one of my favorite
cons and I'm glad to come back here for

5
00:00:42,550 --> 00:00:49,239
a second year this talk is about malware
hunting and malware hunting techniques

6
00:00:49,239 --> 00:00:56,769
and processes so i am the director of
research innovation on the research team

7
00:00:56,769 --> 00:01:06,400
at threat connect and I'm actually uh we
are live with one of my colleagues says

8
00:01:06,400 --> 00:01:11,260
on vahid and he is he was unfortunately
unable to make it to the conference but

9
00:01:11,260 --> 00:01:19,120
he is here out in the ethernet sand the
in the network so without further ado I

10
00:01:19,120 --> 00:01:22,120
will let says on introduced himself

11
00:01:23,410 --> 00:01:28,929
hello everyone like Rob said my name is
jean and i am the research intern for

12
00:01:28,930 --> 00:01:32,980
the research team at that connect and I
mean rob has been working on this

13
00:01:32,980 --> 00:01:37,510
project for the past few months and now
we're really excited to its presented to

14
00:01:37,510 --> 00:01:46,060
you and I hope we have a good
presentation today thanks says so uh by

15
00:01:46,060 --> 00:01:49,690
the way if you want to tweet during the
talk

16
00:01:49,690 --> 00:01:54,130
these are the twitter my twitter handle
and that connect twitter handle so if

17
00:01:54,130 --> 00:02:02,140
you want to tweet stuff you know that
mention us etc so one of the basic one

18
00:02:02,140 --> 00:02:07,510
of the basic problems that i want to
solve with this project and with some of

19
00:02:07,510 --> 00:02:12,580
the processes that I've developed on
underneath this product this project I

20
00:02:12,580 --> 00:02:17,700
is to help out small teams so when you
have a

21
00:02:17,700 --> 00:02:21,690
organizations such as ours that we have
about nine researchers and our team so

22
00:02:21,690 --> 00:02:27,209
we have a very small team so if you have
a small team you need big tactics

23
00:02:27,209 --> 00:02:33,330
because you're not able to compete
unless you have unless you work smart so

24
00:02:33,330 --> 00:02:38,790
I one of the things I've tried to try to
do with this project is to allow our

25
00:02:38,790 --> 00:02:44,250
small team to compete at the weight
level or the weight class of large teams

26
00:02:44,250 --> 00:02:49,620
and so to do this we have to fight
smarter and one of the goals with this

27
00:02:49,620 --> 00:02:56,700
specific project in malware hunting is
to find malware faster and if not find

28
00:02:56,700 --> 00:03:02,730
it the fastest find it the next fastest
sob the very next in line to find a new

29
00:03:02,730 --> 00:03:09,840
malware so my hypothesis is thus this is
going a little bit long but i'll read it

30
00:03:09,840 --> 00:03:15,150
all kind of paraphrase it for you so
malicious binary these out there you

31
00:03:15,150 --> 00:03:22,079
know various forms of malware whether
it's an exploit kit or ransomware or

32
00:03:22,079 --> 00:03:27,780
trojan of some type of many of them
exploit a vulnerability so

33
00:03:27,780 --> 00:03:34,859
vulnerabilities are assigned a CBE and
so my hypothesis is that basically

34
00:03:34,859 --> 00:03:41,010
looking at all of the different virus
scanner companies that all contribute

35
00:03:41,010 --> 00:03:46,590
their information and their scanners to
virustotal or if you go out and get your

36
00:03:46,590 --> 00:03:50,970
own virus scanner bank or create your
own using something like blech scanner

37
00:03:50,970 --> 00:03:57,239
you'll have the ability to kind of
leverage these large teams so virus

38
00:03:57,239 --> 00:04:03,329
scanner companies i just off the top of
my head some Lykke set or bitdefender or

39
00:04:03,329 --> 00:04:08,790
kaspersky or mcafee they have large
teams they have much larger teams in our

40
00:04:08,790 --> 00:04:16,469
nine-person team and so I have found a
way to leverage those larger teams

41
00:04:16,470 --> 00:04:22,889
collectively to hunt malware and not
necessarily find zero-day malware but

42
00:04:22,889 --> 00:04:27,210
find one day malware so basically
piggyback on their ability to

43
00:04:28,230 --> 00:04:33,420
you know boil the ocean and find all of
the zero-day malware that they can and

44
00:04:33,420 --> 00:04:39,900
then i find it through this process
almost immediately after they find it so

45
00:04:39,900 --> 00:04:44,039
a couple of definitions that I want to
cover first

46
00:04:44,730 --> 00:04:52,650
so CBE is common vulnerabilities and
exposures it's a system for numbering

47
00:04:52,650 --> 00:04:57,659
vulnerabilities so that a vulnerability
that's enough a specific piece of

48
00:04:57,660 --> 00:05:05,070
software is assigned a number and that
number is a CBE number these cv numbers

49
00:05:05,070 --> 00:05:11,969
are maintained and disclosed by a number
of different organizations so the

50
00:05:11,970 --> 00:05:17,070
organization that at that goes and
discloses the vulnerabilities in the CEO

51
00:05:17,070 --> 00:05:23,610
uh uh you know there's a there's a whole
system for disclosing them so this is

52
00:05:23,610 --> 00:05:28,920
us-cert so that's the United States
computer emergency readiness team and

53
00:05:28,920 --> 00:05:35,040
this is run as a part of the department
of homeland security DHS and then the

54
00:05:35,040 --> 00:05:40,320
organization that maintains all of the
cds in a database is the National

55
00:05:40,320 --> 00:05:45,719
vulnerability database and VD and this
is maintained by the National Institute

56
00:05:45,720 --> 00:05:52,110
of Standards stick to and Technology or
NIST so past those definitions i want to

57
00:05:52,110 --> 00:05:58,950
talk about the the tools that i'm using
to find the malware so the tool that i'm

58
00:05:58,950 --> 00:06:03,990
using primarily is called Yara and you
may be familiar with Yara it is a

59
00:06:03,990 --> 00:06:09,510
signature a signature tool which
basically looks at these static

60
00:06:09,510 --> 00:06:15,780
qualities of a file any file you can
look at many different things you can

61
00:06:15,780 --> 00:06:20,760
look at strings you can use a regular
expression to find certain uh you know

62
00:06:20,760 --> 00:06:26,039
not necessarily a specific string but a
regular expression representation of a

63
00:06:26,040 --> 00:06:27,300
string

64
00:06:27,300 --> 00:06:33,180
additionally if you use your roles in
conjunction with virustotal you can also

65
00:06:33,180 --> 00:06:40,139
hunt for certain tags and certain
indexes that virustotal uses too

66
00:06:40,139 --> 00:06:45,870
you categorize the malware that they
have in their database I in addition to

67
00:06:45,870 --> 00:06:51,629
this you can look at basically anything
you can have your look at yarrow

68
00:06:51,629 --> 00:06:55,949
basically looks at a file and thought
matches qualities that it finds in that

69
00:06:55,949 --> 00:07:03,120
file that matchup specific signature or
rule that you have written so I and this

70
00:07:03,120 --> 00:07:09,479
is an example of one CDE this is an
Adobe Flash vulnerable vulnerability so

71
00:07:09,479 --> 00:07:16,020
the cv 2016 4249 it's a heat based
buffer overflow in flash player

72
00:07:16,020 --> 00:07:21,900
such-and-such versions and then it it
allows an attacker to execute arbitrary

73
00:07:21,900 --> 00:07:28,739
code via unspecified vectors so these
are the type of cds that I find

74
00:07:28,740 --> 00:07:35,819
important for this specific project so I
want to kind of back up a little bit and

75
00:07:35,819 --> 00:07:41,849
talk about the process that i developed
that that I underlies the the system

76
00:07:41,849 --> 00:07:48,419
that i'm talking about today so back in
February of this year I spoke at the CTI

77
00:07:48,419 --> 00:07:54,180
summit the cyber threat intelligence
summit in Virginia and we talked about

78
00:07:54,180 --> 00:07:59,639
my colleague and myself rich barger we
talked about a yard hunting process

79
00:07:59,639 --> 00:08:06,240
which automates looking at files that
are deployed in files that are that are

80
00:08:06,240 --> 00:08:11,939
sent to virustotal it is also used if
you want to you could have this your

81
00:08:11,939 --> 00:08:17,189
hunting system deployed on your mail
server if you're looking at attachments

82
00:08:17,189 --> 00:08:23,009
or any files that are coming in through
email if you have an inline network

83
00:08:23,009 --> 00:08:29,490
network security monitoring tools such
as bro or snort or any of these you can

84
00:08:29,490 --> 00:08:35,909
use yard to look at the files that these
NSM systems find out on the on the wire

85
00:08:35,909 --> 00:08:42,000
from packet capture on or if you have
endpoint protection and many endpoint

86
00:08:42,000 --> 00:08:46,680
protection products will if there's
something new and new executable that it

87
00:08:46,680 --> 00:08:51,060
hasn't seen before it will take that
file and send it to a central server so

88
00:08:51,060 --> 00:08:51,619
you

89
00:08:51,620 --> 00:08:56,060
and take the yard hunting process that
I've developed and put it on top of

90
00:08:56,060 --> 00:09:00,979
these systems which pull in malware from
your enterprise and then look at those

91
00:09:00,980 --> 00:09:05,600
malware looking for you know any of the
qualities that you would put into a yard

92
00:09:05,600 --> 00:09:09,950
signature but one of the one of the
things that i added to this process is

93
00:09:09,950 --> 00:09:17,029
putting a confidence in a priority on
each one of the rules so that when you

94
00:09:17,029 --> 00:09:21,980
deploy the rules you can before you
deploy the roles kind of decide this

95
00:09:21,980 --> 00:09:26,990
specific rule is something that is more
important than this specific rule or

96
00:09:26,990 --> 00:09:32,810
this rule has a lot of false positives
compared to this rule and therefore once

97
00:09:32,810 --> 00:09:37,640
you have confidence in priority on all
of your rules you can then arrange them

98
00:09:37,640 --> 00:09:43,160
in descending priority and confidence
and if you have a limited amount of uh

99
00:09:43,160 --> 00:09:49,490
you know automated our analysis systems
you can take only the rules that you

100
00:09:49,490 --> 00:09:54,980
only the files that you find that are
you know the highest priority for you

101
00:09:54,980 --> 00:10:00,230
and you can sandbox and analyze them
first using automated malware analysis

102
00:10:00,230 --> 00:10:07,730
systems so this whole process is kind of
captured here in this pair of swim lanes

103
00:10:07,730 --> 00:10:12,740
so all of the yard rules that my team
uses we keep them in a git repository

104
00:10:12,740 --> 00:10:18,440
because rules kind of look much like
source code so if you use the same

105
00:10:18,440 --> 00:10:23,270
source code repositories the programmers
use to keep their source code you can

106
00:10:23,270 --> 00:10:28,880
keep your rules much more organized so
all of these rules get updated in

107
00:10:28,880 --> 00:10:33,740
revision control then they get deployed
to your hunting system whether this is

108
00:10:33,740 --> 00:10:38,480
at virustotal or whether this is on your
you know mail server attachments or

109
00:10:38,480 --> 00:10:45,230
whether it's on your NSM system or
endpoint protection then that system

110
00:10:45,230 --> 00:10:50,240
then uses that set of yard rules to hunt
for the files that you want to find in

111
00:10:50,240 --> 00:10:58,160
that you know pool of files so then that
will just if if we rule if a rule

112
00:10:58,160 --> 00:11:02,360
matches a file it will generate a
notification so then this notification

113
00:11:02,360 --> 00:11:04,290
prioritisation system

114
00:11:04,290 --> 00:11:08,670
ranges the notifications in order and
then downloads the files from the

115
00:11:08,670 --> 00:11:13,410
database if it was virustotal or if you
already have the files you skip that

116
00:11:13,410 --> 00:11:18,120
step and then they all get sent to the
sandbox you know I use many different

117
00:11:18,120 --> 00:11:22,889
sandboxes one of my favorite is cuckoo
sandbox which is an open source project

118
00:11:22,889 --> 00:11:28,680
many of you have heard of it and then
all of the network indicators that you

119
00:11:28,680 --> 00:11:33,599
can extract from that particular piece
of malware or file being detonated in

120
00:11:33,600 --> 00:11:38,190
the AMA all of those all of those
Network indicators you can then take

121
00:11:38,190 --> 00:11:42,600
with the file and file itself and upload
those two a threat intelligence platform

122
00:11:42,600 --> 00:11:44,459
so moving on

123
00:11:44,459 --> 00:11:49,560
that's the underlying system that i use
to kind of organize what we're talking

124
00:11:49,560 --> 00:11:56,189
about today and just you know a little
bit of I you know information about what

125
00:11:56,190 --> 00:12:01,079
happened after my team began using this
system there's a fifteen percent

126
00:12:01,079 --> 00:12:07,649
reduction in time to process and analyze
a sample that was interesting so over

127
00:12:07,649 --> 00:12:16,079
1,500 samples so this saved 300 hours so
300 hours doesn't sound like that much

128
00:12:16,079 --> 00:12:23,160
of time over you know this amount uh you
know six months is so but 300 hours is a

129
00:12:23,160 --> 00:12:28,199
lot of time when you're looking at
someone who's an analyst who was in the

130
00:12:28,199 --> 00:12:33,240
past doing a lot of manual moving around
of information and now the automation

131
00:12:33,240 --> 00:12:38,699
allows this person to do their job and
analyze the malware itself so we had a

132
00:12:38,699 --> 00:12:43,920
thirty percent increase in content
production and so this as it says here

133
00:12:43,920 --> 00:12:48,990
the analyst can reclaim that 300 hours
and use it to do analysis rather than

134
00:12:48,990 --> 00:12:55,500
busy work so alright now that that's the
that's sort of the backstory of the

135
00:12:55,500 --> 00:13:00,750
system that we built so now let's talk
about predictive cv hunting so this is a

136
00:13:00,750 --> 00:13:04,560
way to basically fight above our weight
class and with a small team of nine

137
00:13:04,560 --> 00:13:08,638
people we can go out and find malware
that is new

138
00:13:09,950 --> 00:13:13,760
you know we're not finding the malware
that is zero-day malware so we're not

139
00:13:13,760 --> 00:13:17,960
the people that found it first but we
were able to find its second and were

140
00:13:17,960 --> 00:13:24,350
able to find it very quickly within a
24-hour period so this is the yard rule

141
00:13:24,350 --> 00:13:28,610
template that we use I will be
publishing the slides so you know if you

142
00:13:28,610 --> 00:13:33,650
need to use this yard roll it will be
available so to explain it you have the

143
00:13:33,650 --> 00:13:39,380
rule name at the top and then these
thoughts e.v.e variable here is a

144
00:13:39,380 --> 00:13:44,600
regular expression and this is a nuance
of the rule that I'll talk about later

145
00:13:44,600 --> 00:13:49,220
when we get into some of the special
false positives that we found after we

146
00:13:49,220 --> 00:13:55,970
deployed the system but this basically
looks for the cvv number in text in

147
00:13:55,970 --> 00:14:03,830
strings in the file in addition to this
it also looks for tags in virustotal and

148
00:14:03,830 --> 00:14:10,220
then also if the signature that the
virus scanner engine replies with so if

149
00:14:10,220 --> 00:14:13,850
you submit a file and scan it with you
know

150
00:14:13,850 --> 00:14:17,930
kaspersky some of the some of the virus
scanner results that you get back

151
00:14:17,930 --> 00:14:24,229
actually have the CVE number in the
result meaning that the virus scanner

152
00:14:24,230 --> 00:14:28,790
engine has a signature that that detects
that particular file they already know

153
00:14:28,790 --> 00:14:33,860
that it's attacking that particular
vulnerability so and then a little bit

154
00:14:33,860 --> 00:14:38,750
of the that end part with new file and
not tag that's basically to clean up

155
00:14:38,750 --> 00:14:42,680
some of the complete false positives
that I know are completely no

156
00:14:42,680 --> 00:14:45,829
unnecessary and not interesting for the
project

157
00:14:46,430 --> 00:14:50,959
so this is a list of the the
vulnerabilities that are important for

158
00:14:50,960 --> 00:14:55,040
me so if you think about it there are
many many many vulnerabilities that come

159
00:14:55,040 --> 00:14:59,900
out many different systems but i want to
narrow the number of vulnerabilities

160
00:14:59,900 --> 00:15:06,140
that I look at just two ones that are
for the most part operationalized in

161
00:15:06,140 --> 00:15:11,210
malware so Mauer is going to exploit
browser vulnerabilities so opera

162
00:15:11,750 --> 00:15:17,540
you know chrome especially internet
explorer firefox and then operating

163
00:15:17,540 --> 00:15:22,640
system vulnerabilities but I'm not so
interested in all operating system

164
00:15:22,640 --> 00:15:27,199
vulnerabilities i'm only interested in
privileged excellent back at privilege

165
00:15:27,200 --> 00:15:32,180
escalation and then arbitrary code
execution so especially remote code

166
00:15:32,180 --> 00:15:39,199
execution and then of course the usual
set of offenders as i like to call them

167
00:15:39,200 --> 00:15:45,080
so Java flash PDF silverlight all of the
things that you should turn off on your

168
00:15:45,080 --> 00:15:51,560
browser at all times I think and then
office documents so you know PowerPoint

169
00:15:51,560 --> 00:15:57,739
Word and Excel documents and then also
we've begun applying the system to

170
00:15:57,740 --> 00:16:04,100
mobile malware but i wanted to focus
only on kind of the more popular mobile

171
00:16:04,100 --> 00:16:11,420
system so iOS and Android
vulnerabilities so has this work i want

172
00:16:11,420 --> 00:16:18,020
to show you some of the hunting system
in action and I i want to start with the

173
00:16:18,020 --> 00:16:22,670
failures so i want to show you some of
the things that happen when you know but

174
00:16:22,670 --> 00:16:27,020
it didn't work and i'll talk about why
it didn't work and then how we improve

175
00:16:27,020 --> 00:16:32,990
the system after you know reviewing why
this thing didn't work so the first

176
00:16:32,990 --> 00:16:41,390
near-miss that we had was last year so
this is a cv 2015 20 336 and it was

177
00:16:41,390 --> 00:16:48,319
operationalized binuclear exploit kit on
march nineteenth of $MONTH 2015

178
00:16:48,320 --> 00:16:54,680
this is an arbitrary code execution in
adobe flash and the reason why we missed

179
00:16:54,680 --> 00:17:00,589
it was the rules at that time this was
last year the rules were only looking

180
00:17:00,589 --> 00:17:07,550
for cve numbers in AV scanner results so
at that time we weren't looking at all

181
00:17:07,550 --> 00:17:12,379
the different things that you can look
at with yard rule and so the AV scanner

182
00:17:12,380 --> 00:17:18,890
results didn't actually have the CVE in
it but a researcher and if anyone here

183
00:17:18,890 --> 00:17:22,250
does malware research you're probably
familiar with caffeine

184
00:17:22,770 --> 00:17:27,599
so caffeine found some of the first
samples and then uploaded them to

185
00:17:27,599 --> 00:17:33,810
virustotal and then he tagged them with
this particular CDE and because he was

186
00:17:33,810 --> 00:17:39,510
the one the tag them with the CBE it
basically bypassed the are rules that we

187
00:17:39,510 --> 00:17:45,090
had written and so we learned from this
and you know back a couple of slides it

188
00:17:45,090 --> 00:17:51,540
has tag includes blah blah and tag
contains CD number and so we added this

189
00:17:51,540 --> 00:17:58,830
the template for the rules that we are
generating another one was more recent

190
00:17:58,830 --> 00:18:07,770
so this near-miss so this this entire
project has been going on for uh maybe a

191
00:18:07,770 --> 00:18:13,860
year and a half but I didn't have the
resources the manpower to actually

192
00:18:13,860 --> 00:18:18,659
continue but continue the project the
person who is working on our team left

193
00:18:18,660 --> 00:18:23,790
our company and so for a period of time
we had shut down the whole system and

194
00:18:23,790 --> 00:18:28,860
then when Zhan came on the team we had
the manpower to bring the system back up

195
00:18:28,860 --> 00:18:36,179
but the system basically and this was a
few days literally a few days before

196
00:18:36,180 --> 00:18:42,690
says on became part of the project and
so you know the intern was still being

197
00:18:42,690 --> 00:18:47,190
trained on how to use everything and how
this whole thing works and so we missed

198
00:18:47,190 --> 00:18:52,410
this because this the the system was
actually at that time mothballed but

199
00:18:52,410 --> 00:18:58,590
what we did was we went back and then
deployed all of the missing your rules

200
00:18:58,590 --> 00:19:03,389
that hit that that had the basically all
the cds that had come out since we

201
00:19:03,390 --> 00:19:09,000
bought the project and then we had a
flood of stuff that we could have found

202
00:19:09,000 --> 00:19:15,270
if the system had been running the
entire time so I want to move on to some

203
00:19:15,270 --> 00:19:23,970
of the ones that we hit on and so we
found a cv 2015-16 41 so this is a

204
00:19:23,970 --> 00:19:28,350
microsoft office memory concur eruption
vulnerability so this is a vulnerability

205
00:19:28,350 --> 00:19:33,980
that is used in office documents rich
text file and it allows remote

206
00:19:33,980 --> 00:19:38,900
attackers arbitrary code execution
versus the via a crafted RTF document

207
00:19:38,900 --> 00:19:46,040
and one thing that's interesting is
after we deployed the role for this we

208
00:19:46,040 --> 00:19:50,690
are literally we found we found this at
first and then now literally we are

209
00:19:50,690 --> 00:19:56,270
swimming in alerts for rich text files
that exploit this particular

210
00:19:56,270 --> 00:20:01,668
vulnerability so you know we're we're
thinking about creating a feed of just

211
00:20:01,669 --> 00:20:04,669
these just these malware files

212
00:20:04,669 --> 00:20:11,059
the second one is cv 2015 5122 so this
is a use after free this is another

213
00:20:11,059 --> 00:20:15,860
adobe flash player vulnerability Soyuz
after free vulnerability in the display

214
00:20:15,860 --> 00:20:23,570
object class in actionscript 3 so this
is another one that we found a second

215
00:20:23,570 --> 00:20:29,059
basically we didn't find it first but
again this is one that is deployed a lot

216
00:20:29,059 --> 00:20:36,110
in many exploit kits and similarly the
next one CB 2015 5119 is another use

217
00:20:36,110 --> 00:20:43,070
after free in the bytearray again turn
flash off don't use flash hate it I hate

218
00:20:43,070 --> 00:20:49,040
it but this is another one that we're
basically now swimming in malware that

219
00:20:49,040 --> 00:20:55,100
exploit this vulnerability so what I
wanted to talk about next

220
00:20:55,100 --> 00:21:01,340
and these are false ish positives so
they're not they're not true false

221
00:21:01,340 --> 00:21:06,168
positives because we found something
that was interesting to us but it wasn't

222
00:21:06,169 --> 00:21:10,490
malware that was exploiting the
vulnerability so there's two categories

223
00:21:10,490 --> 00:21:11,900
that we found

224
00:21:11,900 --> 00:21:16,340
first of all is there are many
vulnerabilities that are exploited in

225
00:21:16,340 --> 00:21:21,649
the wild but they're not exploited by
malware their exploited you know they

226
00:21:21,650 --> 00:21:27,320
might be part of you know but they might
be part of an exploit that used like

227
00:21:27,320 --> 00:21:32,629
metasploit or something that's used as a
payload this sort of thing but they're

228
00:21:32,630 --> 00:21:39,200
not actually weaponized in malware and
so we found a few files that were

229
00:21:39,200 --> 00:21:45,890
payload so some people will submit their
payload 22 virustotal and so we found a

230
00:21:45,890 --> 00:21:46,470
lot of

231
00:21:46,470 --> 00:21:51,150
of payloads that people were submitting
that exploited a particular

232
00:21:51,150 --> 00:21:56,039
vulnerability but the payload was not
actually you know malware in the

233
00:21:56,039 --> 00:22:01,260
traditional sense that that we think of
it as like you know trojan or or a

234
00:22:01,260 --> 00:22:05,039
malicious document but it was still
exploiting this particular vulnerability

235
00:22:05,039 --> 00:22:09,750
and what we did was at this point we
went back and looked at all of the

236
00:22:09,750 --> 00:22:16,260
exploit DB and you know metasploit
exploit database and all them and kind

237
00:22:16,260 --> 00:22:22,020
of review the rules that we had created
and d prioritize a lot of the ones that

238
00:22:22,020 --> 00:22:28,500
have been found in the wild basically in
these different databases but they're

239
00:22:28,500 --> 00:22:32,520
still there so we're still hunting for
them so occasionally we will find some

240
00:22:32,520 --> 00:22:39,870
either pentester you know or possibly a
adversaries payload and then we'll be

241
00:22:39,870 --> 00:22:44,039
able to analyze that and kind of dual
not kind of figure out like where it's

242
00:22:44,039 --> 00:22:46,020
calling back to and things like that

243
00:22:46,020 --> 00:22:49,590
another thing that we've added which is
that kind of very interesting and this

244
00:22:49,590 --> 00:22:55,110
is the if you remember in the yard rule
we just looked at there's a variable CBE

245
00:22:55,110 --> 00:23:01,500
with the regex the regular expression
for looking for CD numbers so we found

246
00:23:01,500 --> 00:23:06,539
that a lot of people submit text
documents that are not malicious but

247
00:23:06,539 --> 00:23:12,629
talk about things that are interesting
for us so the things that people submit

248
00:23:12,630 --> 00:23:18,120
to virustotal or not always going to be
malware files they might be a text

249
00:23:18,120 --> 00:23:23,520
document they might be you know an excel
file that's not malicious but is talking

250
00:23:23,520 --> 00:23:26,820
about something that we would be
interested in specifically in the

251
00:23:26,820 --> 00:23:31,710
context of a CBE so we've kind of
expanded our net to look for things that

252
00:23:31,710 --> 00:23:36,990
are not necessarily malware but also
documents that people submit that are

253
00:23:36,990 --> 00:23:42,299
talking about see these so we're looking
for text file so these are these two i

254
00:23:42,299 --> 00:23:47,520
consider their false ish positives the
original hypothesis of our system didn't

255
00:23:47,520 --> 00:23:52,168
include these so they're they're
basically false positives but now we

256
00:23:52,169 --> 00:23:55,020
know that these are things that are
interesting for us to look at

257
00:23:55,020 --> 00:23:59,520
so what I want to do is turn the turn

258
00:23:59,520 --> 00:24:04,710
the discussion over to says and he's
going to talk about some of the things

259
00:24:04,710 --> 00:24:11,640
that he's been working on in his part of
the project so uh you know the the basic

260
00:24:11,640 --> 00:24:17,070
components of the project we put
together and a lot of this was before he

261
00:24:17,070 --> 00:24:21,870
joined the project a lot of it was very
manual and so he has been working on

262
00:24:21,870 --> 00:24:26,669
automating some of the things of the
project automate all the things he's

263
00:24:26,670 --> 00:24:31,710
been working on automating components of
the project that basically he was

264
00:24:31,710 --> 00:24:36,300
working on and so he's kind of
automating his own pain away because he

265
00:24:36,300 --> 00:24:39,720
was the one that had to do a lot of the
manual stuff so I'm going to turn it

266
00:24:39,720 --> 00:24:46,800
over to says and move to the first slide
for you going on all made all things

267
00:24:48,750 --> 00:24:53,190
yep you're on not 23 ok cool

268
00:24:53,190 --> 00:24:58,050
hello everyone and thank you rob for
going over all that that's not really

269
00:24:58,050 --> 00:25:03,780
cool so as I mentioned my part is to
automate the rule generation and kind of

270
00:25:03,780 --> 00:25:08,100
the hunting process this part is going
to be mostly review of what rob has been

271
00:25:08,100 --> 00:25:11,399
discussing except we're going to focus a
little bit more on automation side of

272
00:25:11,400 --> 00:25:19,380
things on so if we can can we go to the
next slide and 20 cool

273
00:25:19,380 --> 00:25:27,000
yep ok so low backs are initially we
created by your rules by manually going

274
00:25:27,000 --> 00:25:31,020
through the u.s. certain media
vulnerability summaries and formatting

275
00:25:31,020 --> 00:25:34,470
them into your rules on those days are
over

276
00:25:34,470 --> 00:25:39,900
we have been making great progress and
automating this and i will explain how

277
00:25:39,900 --> 00:25:40,860
this works

278
00:25:40,860 --> 00:25:48,990
so as Ron mentioned are two sources rc4
cds are us sir and led on and now we

279
00:25:48,990 --> 00:25:54,210
have a Python script that grabs the CBI
identifiers released in the feeds

280
00:25:54,210 --> 00:26:00,030
through RSS and we can create your we
can generate your rules automatically

281
00:26:00,030 --> 00:26:09,030
get through this your RSS and speed
parsing so we take the identical

282
00:26:09,030 --> 00:26:12,149
identifier which is the cvv number

283
00:26:12,150 --> 00:26:19,650
2016 baba and we give it a name usually
the names are attached to the CVS with

284
00:26:19,650 --> 00:26:27,210
with the release of their summaries and
we generate a rule and i can show you an

285
00:26:27,210 --> 00:26:33,630
example on the next slide which is 125

286
00:26:34,200 --> 00:26:42,090
yep 26 yep her 2000 you want to all
right start 25 sorry

287
00:26:42,090 --> 00:26:47,790
yeah hope so here's an example of a
linux kernel vulnerability that was a

288
00:26:47,790 --> 00:26:51,930
released by both NBD and us-cert on in
there

289
00:26:51,930 --> 00:26:57,840
bolton summaries and we grab this
information and we parse it we take the

290
00:26:57,840 --> 00:27:03,330
identifier which is that number 2065
people for and the name the linux kernel

291
00:27:03,330 --> 00:27:07,949
vulnerability and if you go to the next
slide 226 we have an example of the

292
00:27:07,950 --> 00:27:14,040
yarrow that's formed from this from this
example so give you guys a second look

293
00:27:14,040 --> 00:27:17,670
at that and so as you can see just the
real name

294
00:27:17,670 --> 00:27:24,930
we have the tags that contain the TV
identifier and then this rule these

295
00:27:24,930 --> 00:27:32,190
rules are uploaded to VT where they stay
engaged and basically on they stay

296
00:27:32,190 --> 00:27:36,450
active and waiting waiting to be
triggered by malware this process is now

297
00:27:36,450 --> 00:27:41,370
automated and now we can have this
system running on a server and we don't

298
00:27:41,370 --> 00:27:46,050
have any like no human interaction know
an appearance

299
00:27:46,050 --> 00:27:51,360
this is just running and grabs automate
automatically grabs the Seavey's and but

300
00:27:51,360 --> 00:27:57,750
creates rules and uploads on the bt and
that saves a lot of time so we are going

301
00:27:57,750 --> 00:28:07,410
to continue on to processing the hits
slide 27 got it where they're cool

302
00:28:08,519 --> 00:28:13,919
so previously we would get email
notifications when we was triggered this

303
00:28:13,919 --> 00:28:18,119
required analyst to go and manually
download the sample and upload to you

304
00:28:18,119 --> 00:28:22,468
know Joe sand monster cuckoo and whatnot
to basic analysis so we wanted to

305
00:28:22,469 --> 00:28:27,959
automate this process as well so what we
would do is have a bot listening for VT

306
00:28:27,959 --> 00:28:33,779
notifications when a rule is hit and
then download the sample if its prior to

307
00:28:33,779 --> 00:28:41,219
prioritization the Bakken uploads the
sample to and some sort of sandbox like

308
00:28:41,219 --> 00:28:47,219
a jones or cookie and basically grabs
any further IOC such as network

309
00:28:47,219 --> 00:28:51,690
indicators or drop files and now the
analyst has some wear something to work

310
00:28:51,690 --> 00:28:52,019
with

311
00:28:52,019 --> 00:28:57,509
without having to do any of that
themselves so now they want to Train

312
00:28:57,509 --> 00:28:58,440
what they do best

313
00:28:58,440 --> 00:29:02,940
the human aspect of analysis and doing
further research with reverse

314
00:29:02,940 --> 00:29:09,570
engineering and whatnot so i think that
should be in the automation process i

315
00:29:09,570 --> 00:29:15,689
hope that there's enough for everyone
and yeah i'll pass about to rob cool

316
00:29:15,690 --> 00:29:21,779
thanks says so and you know I by the way
so says has been doing a lot of the

317
00:29:21,779 --> 00:29:22,679
heavy lifting

318
00:29:22,679 --> 00:29:28,559
so he's been doing a lot of the the
programming and in Python and you know

319
00:29:28,559 --> 00:29:31,559
Thank you Thank says you're awesome

320
00:29:33,119 --> 00:29:39,478
so I and one of the things i wanted to
go back to with his with this is the

321
00:29:39,479 --> 00:29:46,229
idea that that you're basically
piggybacking on other organizations so I

322
00:29:46,229 --> 00:29:51,389
think this is a really important point
to take home is that even if you don't

323
00:29:51,389 --> 00:29:59,820
have the resources or the the budget you
can be crafty and go and you know if you

324
00:29:59,820 --> 00:30:03,899
think hard enough you can find a way
that you can basically use other

325
00:30:03,899 --> 00:30:10,678
people's resources and leverage them in
your own way and be able to you know

326
00:30:10,679 --> 00:30:16,109
basically hunt for things in this
particular example hunt for malware uh

327
00:30:16,109 --> 00:30:21,129
through other people's hunting processes
so what we've done here is

328
00:30:21,130 --> 00:30:26,800
we've taken the processes that uh and I
i'm going to probably get called out on

329
00:30:26,800 --> 00:30:31,300
this number being incorrect but i think
it's around 52 or so

330
00:30:31,990 --> 00:30:39,790
52 or so virus scanner engines that are
available in virustotal you can have as

331
00:30:39,790 --> 00:30:43,450
many virus scanner engines you want if
you want to do this on your own outside

332
00:30:43,450 --> 00:30:49,630
virustotal but you're basically taking
the time that you put into the project

333
00:30:49,630 --> 00:30:55,660
and your team and then not wasting time
looking for stuff yourself you're

334
00:30:55,660 --> 00:31:01,300
basically allowing yourself to piggyback
on 52 different teams that are all out

335
00:31:01,300 --> 00:31:06,520
there doing very similar things to what
we're doing which is finding new malware

336
00:31:06,520 --> 00:31:11,590
and reviewing it and analyzing it and
reverse engineering it but you're

337
00:31:11,590 --> 00:31:15,610
basically taking you know you're
basically having your small team and

338
00:31:15,610 --> 00:31:21,820
then multiplying that by 52 and so
you've got this massive team very wide

339
00:31:21,820 --> 00:31:26,950
net all over the world and you know the
AV scanner engines out there come from

340
00:31:26,950 --> 00:31:28,060
all over the world

341
00:31:28,060 --> 00:31:33,550
I know that ESET is from I think
slovakia I know a bit defender is

342
00:31:33,550 --> 00:31:41,020
Romania kaspersky is Russia mcafee some
semantic they're both from the US so

343
00:31:41,020 --> 00:31:46,240
you've got a lot of you have a very wide
reach when you leverage this type of

344
00:31:46,240 --> 00:31:52,630
network uh and you can find files that
are not necessarily ones that you would

345
00:31:52,630 --> 00:31:58,630
normally find attacking your own region
or your own in this industrial vertical

346
00:31:58,630 --> 00:32:03,910
so you'll find stuff that might actually
be targeting a different country you

347
00:32:03,910 --> 00:32:07,870
could find stuff that's targeting a
different type of business then you find

348
00:32:07,870 --> 00:32:12,879
and so you're able to find things and
then operationalize like the the

349
00:32:12,880 --> 00:32:16,630
intelligence that you can gather from
that and use it to protect your

350
00:32:16,630 --> 00:32:23,020
organization so I wanted to move on and
then kind of asked it does anyone have

351
00:32:23,020 --> 00:32:26,020
any questions on the stuff we've talked
about so far

352
00:32:27,700 --> 00:32:34,570
yes and says is live too so if you have
a question for him as well

353
00:32:40,870 --> 00:32:48,428
hi I'm doing this stuff for just $MONEY
just for Bobby you only manually you

354
00:32:48,429 --> 00:32:53,590
mentioned caffeine and malware must die
and all these blocks where do you find

355
00:32:53,590 --> 00:33:00,158
that amount of malware when you stream
files from i mean i can just dig two

356
00:33:00,159 --> 00:33:04,990
files a day you know when I want to try
but you need thousands of files for

357
00:33:04,990 --> 00:33:06,070
birthday right

358
00:33:06,070 --> 00:33:12,220
correct so the question was I you know
if you have access to a lot of the blogs

359
00:33:12,220 --> 00:33:16,990
like caffeine and other in our
researchers I where do you find access

360
00:33:16,990 --> 00:33:23,649
to malware files in volume you saying
that he has access to it maybe a few

361
00:33:23,649 --> 00:33:27,100
files and stuff like that but where do
you find thousands of files to do this

362
00:33:27,100 --> 00:33:33,340
so there are a few techniques and if
anyone was here last year at balkon by

363
00:33:33,340 --> 00:33:39,879
gave a talk on spam honey pots and so
running your own spam honey pots is a

364
00:33:39,880 --> 00:33:47,440
very good way for a collection of new
malware in volume basically the amount

365
00:33:47,440 --> 00:33:53,080
of resources you want to devote to vm
running but you know open mail servers

366
00:33:53,080 --> 00:33:57,879
that will receive malware for you know
from brit anywhere the amount of

367
00:33:57,880 --> 00:34:02,440
resources that you will devote to the
number of VMS that you can deploy that's

368
00:34:02,440 --> 00:34:06,370
you know x whatever that's the amount of
malware that you can collect you can

369
00:34:06,370 --> 00:34:13,540
collect a lot of malware that way there
are other so that's that's malware

370
00:34:13,540 --> 00:34:17,589
that's based that's based or distributed
via email

371
00:34:17,589 --> 00:34:21,460
there's a lot of other types of malware
out there this botnets that will

372
00:34:21,460 --> 00:34:27,369
actually click connect and deliver a
payload over a particular port so-die

373
00:34:27,369 --> 00:34:33,609
ania and other types of honey pots
they're different style of honey pot but

374
00:34:33,609 --> 00:34:38,469
you'd want to do deploy that type of
honey pot and those uh

375
00:34:39,168 --> 00:34:43,908
those are mostly I think they're kind of
medium or low interaction honey pots

376
00:34:43,909 --> 00:34:47,659
what you'd want to do in addition to
this is have a high interaction honey

377
00:34:47,659 --> 00:34:56,329
pot which basically you know emulates an
entire operating system or service at

378
00:34:56,329 --> 00:35:01,400
least and then you know because it
emulates that particular service or

379
00:35:01,400 --> 00:35:05,869
operating system an attacker will
connect to that service and basically

380
00:35:05,869 --> 00:35:08,059
give you a payload of some kind

381
00:35:08,059 --> 00:35:15,740
so that's another another method of
collection also there are a lot of

382
00:35:15,740 --> 00:35:23,299
public sandboxes so some of my favorites
you know malware mal WR this is a public

383
00:35:23,299 --> 00:35:29,000
sandbox that's based on cuckoo the
authors of some of the authors of cuckoo

384
00:35:29,000 --> 00:35:34,640
run this and it does have a login you
know you have to apply for an account

385
00:35:34,640 --> 00:35:40,490
but the account is free and some of the
files not all of the files that you find

386
00:35:40,490 --> 00:35:45,229
on now I'm alwar but some of the files
if the person who submitted the file you

387
00:35:45,230 --> 00:35:49,730
know checks the boxing share if you have
an account on there you can download

388
00:35:49,730 --> 00:35:55,970
that particular file another one is
another one of my favorites so Jan

389
00:35:55,970 --> 00:36:02,118
miller runs a company called payload
security and they have a sandbox called

390
00:36:02,119 --> 00:36:07,609
VX the extreme and they have it's a
commercial product but at the same time

391
00:36:07,609 --> 00:36:13,040
they do something like what malware does
with ku and they have yeah they have a

392
00:36:13,040 --> 00:36:17,390
public sandbox where anyone can submit
files to it and again it works in

393
00:36:17,390 --> 00:36:23,000
similar way in a similar way where you
can get a free account on the system and

394
00:36:23,000 --> 00:36:27,380
then if you have an account on the
system you can download malware files

395
00:36:27,380 --> 00:36:33,380
that have been submitted and shared of
course also i and i can't i can't say

396
00:36:33,380 --> 00:36:40,369
how much i love that particular system
and and Jayne Miller and that whole

397
00:36:40,369 --> 00:36:45,740
system because you not only if you have
an account you not only get access to

398
00:36:45,740 --> 00:36:50,689
the malware file itself you can also
download the packet capture so you can

399
00:36:50,690 --> 00:36:52,110
download the pcap

400
00:36:52,110 --> 00:36:57,750
from the malware running in the sandbox
and I you know I've also i've had

401
00:36:57,750 --> 00:37:01,230
another talk that I've been giving to
add other conferences about open source

402
00:37:01,230 --> 00:37:08,220
malware labs and so i can tell you if
you have access to the pcap as opposed

403
00:37:08,220 --> 00:37:13,830
to the output that you get from a
sandbox you get more uh there are you

404
00:37:13,830 --> 00:37:19,049
know there's they're sort of uh I forget
what the term my friend use but there's

405
00:37:19,050 --> 00:37:24,540
there's there's a information in the
pcap that you can get out of it that a

406
00:37:24,540 --> 00:37:29,730
sandbox may not have been able to
interpret using the software that it had

407
00:37:29,730 --> 00:37:33,090
four pcap analysis so for example

408
00:37:33,090 --> 00:37:39,150
coo coo i believe uses deepak at DP
katie and i'm not sure what the xtreme

409
00:37:39,150 --> 00:37:48,690
uses for packet analysis but in my lab I
use bro 44 packet analysis and bro finds

410
00:37:48,690 --> 00:37:54,570
uh you know broke and find things that
maybe the sandbox didn't you know i did

411
00:37:54,570 --> 00:37:58,320
just didn't detect not that it you know
not that it wasn't you know maybe it

412
00:37:58,320 --> 00:38:04,410
didn't detect a particular protocol or
maybe there was just some failure during

413
00:38:04,410 --> 00:38:08,069
that sandbox session and it didn't find
a particular IP address

414
00:38:08,070 --> 00:38:12,540
you know there's many reasons for it but
you know the the packet capture the pcap

415
00:38:12,540 --> 00:38:17,610
is sort of ground truth when ya its
ground truth when you're talking about

416
00:38:17,610 --> 00:38:22,500
the communication of the malware and so
if you go back and analyze the pcap

417
00:38:22,500 --> 00:38:25,410
itself you can get much much more

418
00:38:25,410 --> 00:38:29,009
and also if you've been where I was
going with this is if you get the peak

419
00:38:29,010 --> 00:38:34,440
apps from from that hybrid hybrid
analysis you can actually get more

420
00:38:34,440 --> 00:38:38,910
malware samples from the the packet
capture from carving files out of it

421
00:38:38,910 --> 00:38:44,730
that you can then analyze further so
you'll have like you know many many more

422
00:38:44,730 --> 00:38:53,700
families will have staged attacks so the
first stages maybe a weaponized document

423
00:38:53,700 --> 00:39:00,569
and then the second stage is you know a
dropper second-stage might be pony or

424
00:39:00,570 --> 00:39:03,830
something like this and then a third
stage might be bought track

425
00:39:03,830 --> 00:39:08,900
there you know there's different stages
but if you're looking at just the if you

426
00:39:08,900 --> 00:39:14,990
submit maybe the first stage 22 a
sandbox you don't always get the entire

427
00:39:14,990 --> 00:39:19,399
picture of what's happening with the
further stages so it's yeah it's always

428
00:39:19,400 --> 00:39:24,800
important to take those further stages
maybe carrot carving them from the

429
00:39:24,800 --> 00:39:30,620
packet capture maybe you know looking at
what the download URL is and downloading

430
00:39:30,620 --> 00:39:34,819
a copy of it yourself and then
sandboxing those separately from the

431
00:39:34,820 --> 00:39:41,600
first or second or early stages of
malware yes

432
00:39:52,030 --> 00:40:02,110
mind explaining cv 2015-16 41 it's
related to RTF rich text document which

433
00:40:02,110 --> 00:40:08,470
txt file documents right yeah let me go
to explain how the arbitrary code

434
00:40:08,470 --> 00:40:15,009
executes how does it work is done
recognize weaponize document

435
00:40:15,970 --> 00:40:22,600
yes so I and honestly i mean the the
volume of vulnerabilities and exploits

436
00:40:22,600 --> 00:40:27,850
that are out there uh I don't focus on
the specifics of actually the how that

437
00:40:27,850 --> 00:40:34,390
particular exploit works so I you know
I'm casting a wide net and looking at

438
00:40:34,390 --> 00:40:38,109
all the vulnerabilities in kind of
looking at which ones I can match up

439
00:40:38,110 --> 00:40:43,090
with which malware families and which
ones are being used in which exploit

440
00:40:43,090 --> 00:40:46,180
kits you could spend your entire life

441
00:40:46,180 --> 00:40:52,480
diving deep into each one of these
exploits so I don't know how this one

442
00:40:52,480 --> 00:40:56,530
works technically but I could answer
that for you later

443
00:40:56,530 --> 00:41:03,130
I could find out yeah it would be nice
thanks but i know i specifically how its

444
00:41:03,130 --> 00:41:05,560
work how it's used

445
00:41:05,560 --> 00:41:11,320
I is you know your typical rich text
file attached to a to an email saying

446
00:41:11,320 --> 00:41:17,020
you know this is a an invoice from your
amazon account please open this and then

447
00:41:17,020 --> 00:41:27,130
check it would basically distribute
defect ef5 right right here document you

448
00:41:27,130 --> 00:41:28,900
would have to

449
00:41:28,900 --> 00:41:33,970
yes the same as expand base yeah you
would get kind of form in PDF you might

450
00:41:33,970 --> 00:41:35,439
not recognize it

451
00:41:35,440 --> 00:41:41,140
sometimes you might be like the original
sender sometimes you would open the

452
00:41:41,140 --> 00:41:43,390
document nothing would happen

453
00:41:43,390 --> 00:41:49,990
still when you feel the form when you
feel the form save the document then the

454
00:41:49,990 --> 00:41:55,720
the arbitrary code code might be
executed correct so there there's a

455
00:41:55,720 --> 00:42:02,470
number . so he was asking about you know
you could fill a form out in PDF for

456
00:42:02,470 --> 00:42:04,348
example right and then the exploit
Woodrow

457
00:42:04,349 --> 00:42:09,839
and when this when the PDF is saved yes
that's one way but so there's basically

458
00:42:09,839 --> 00:42:17,130
on when you're talking about malware uh
that is like malware spam that's an

459
00:42:17,130 --> 00:42:23,369
attachment there's kind of two two
categories i would say so there's one

460
00:42:23,369 --> 00:42:27,599
there's a malware spam that uses a
exploit which is what we're talking

461
00:42:27,599 --> 00:42:33,599
about here on those documents typically
don't have any legitimate information to

462
00:42:33,599 --> 00:42:35,700
look at you know you open it

463
00:42:35,700 --> 00:42:40,589
exploit runs you know the shellcode runs
and then something you know something

464
00:42:40,589 --> 00:42:46,229
bad happens you're possibly the the you
know the the thing that the software

465
00:42:46,229 --> 00:42:50,759
that you're using to view the document
will crash if the exploit is very good

466
00:42:50,759 --> 00:42:54,960
one it won't crash and then you know you
won't even notice but in these

467
00:42:54,960 --> 00:42:59,279
situations the the document itself
doesn't typically have what I would call

468
00:42:59,279 --> 00:43:06,210
like bait in it but there's a whole
other category of uh you know malware

469
00:43:06,210 --> 00:43:13,229
which is you know a lot of it would be
vbscript you know macros and stuff like

470
00:43:13,229 --> 00:43:14,038
this

471
00:43:14,039 --> 00:43:20,160
many of those will have some sort of
bait information in it so I felt you

472
00:43:20,160 --> 00:43:26,969
know and these those are more used for
targeted attacks so you know the the

473
00:43:26,969 --> 00:43:31,950
adversary will go and find a document
that you you might find interesting

474
00:43:33,059 --> 00:43:36,989
they'll typically strip out all the
other pages so it's just you know we'll

475
00:43:36,989 --> 00:43:42,690
take the first page and then weaponize
it with you know vb code whatever sort

476
00:43:42,690 --> 00:43:48,630
of other code they're using if it's a
PDF maybe javascript but at that point

477
00:43:48,630 --> 00:43:52,920
what they're doing is that there's a
there's like a small layer of like

478
00:43:52,920 --> 00:43:55,829
social engineering there where they're
trying to trick you into you know

479
00:43:55,829 --> 00:43:59,279
opening it because you think it's going
to be interesting and then the malware

480
00:43:59,279 --> 00:44:03,239
runs and then something happens but
those typically don't exploit those

481
00:44:03,239 --> 00:44:07,349
don't exploit a vulnerability that well
they exploit a vulnerability in the

482
00:44:07,349 --> 00:44:08,770
human's brain rather

483
00:44:08,770 --> 00:44:14,110
than exploit in the the technology
underlying the document viewer truth

484
00:44:14,110 --> 00:44:17,110
thanks

485
00:44:18,400 --> 00:44:21,550
any other questions yep

486
00:44:23,650 --> 00:44:34,570
God tough question inbound so obviously
there's a very active darknet market for

487
00:44:34,570 --> 00:44:41,200
with some what some call a PT's or just
not not your garden-variety like banking

488
00:44:41,200 --> 00:44:46,540
trojans and things like that and i'm
just curious as somebody who gets to

489
00:44:46,540 --> 00:44:49,900
kind of see the the world behind the
veil so to speak

490
00:44:50,650 --> 00:44:54,880
what kind of crossover what kind of
metrics there are in terms of monitoring

491
00:44:54,880 --> 00:45:00,190
darknet markets and how many of these a
casualty deployed kind of white and

492
00:45:00,190 --> 00:45:05,350
exploits you see from dark metrics and
what the visibility is like wait a

493
00:45:05,350 --> 00:45:10,270
minute if you can even give like a
garden a lot but after like a general

494
00:45:10,270 --> 00:45:15,520
ballpark a percentage of what the number
of what you know what I mean to do see a

495
00:45:15,520 --> 00:45:24,100
lot of poison ivy de levantar comment so
I honestly it has changed literally in

496
00:45:24,100 --> 00:45:31,150
the past like four months or so so the
the so he was asking you know what is

497
00:45:31,150 --> 00:45:36,700
the kind of what are the ratios of the
things that I'm seeing kind of cv based

498
00:45:36,700 --> 00:45:41,560
like to what I see coming out of darknet
what I see coming out of like that you

499
00:45:41,560 --> 00:45:47,860
know the the bad side of the right so I
one of the things that happened recently

500
00:45:47,860 --> 00:45:53,410
was there was a big takedown in Russia
with a lot of cyber criminals and so i

501
00:45:53,410 --> 00:45:58,899
don't know i don't know whether you know
this corresponds you know directly but i

502
00:45:58,900 --> 00:46:01,900
know that a bunch of exploit kits went
dark

503
00:46:02,650 --> 00:46:08,710
Lockheed disappeared for awhile came
back strong so you know whoever's behind

504
00:46:08,710 --> 00:46:16,210
that didn't stay in jail for long but I
i would say that thing things transition

505
00:46:16,210 --> 00:46:20,030
from being you know and I'm not going to

506
00:46:20,030 --> 00:46:22,970
i'm going to just go for some ballpark
because I you know I don't want to get

507
00:46:22,970 --> 00:46:27,649
caught saying of fifty-five percent you
know actually 75-percent of statistics

508
00:46:27,650 --> 00:46:33,890
are made up on the spot so but i would
say there were more banking Trojans

509
00:46:33,890 --> 00:46:40,279
before that event and now a lot a lot of
the adversaries and a lot of like the

510
00:46:40,280 --> 00:46:47,510
exploit kits have begun delivering more
ransomware ransomware is the new the new

511
00:46:47,510 --> 00:46:52,730
bad thing you know that's the that is
the the new popular thing to deliver and

512
00:46:52,730 --> 00:46:59,720
I think one of the reasons for that is a
banking Trojan requires a secondary

513
00:46:59,720 --> 00:47:08,120
money exfiltration system so once you
have crap once you've captured a login

514
00:47:08,120 --> 00:47:12,859
for someone's online banking or if
you've captured a credit card number

515
00:47:12,860 --> 00:47:15,830
then what do you do with it

516
00:47:15,830 --> 00:47:21,799
you need to actually do something else
with it to get money out of it but with

517
00:47:21,800 --> 00:47:28,730
with ransomware you've cut out that
money exfiltration middleman where the

518
00:47:28,730 --> 00:47:36,710
you know the client or victim the client
is sending you the money directly so I

519
00:47:36,710 --> 00:47:43,490
think that it's it's basically a you
know it's a logical progression in like

520
00:47:43,490 --> 00:47:50,720
the the concepts of cybercrime is that
like coral is correlated with like a

521
00:47:50,720 --> 00:47:56,750
decrease in some of the more advanced
kids being for sale so i think i would

522
00:47:56,750 --> 00:48:02,180
say it had so when you say thinking when
you say the advanced things being for

523
00:48:02,180 --> 00:48:07,700
sale so one thing that i found
interesting is there's a lot more kits

524
00:48:07,700 --> 00:48:14,540
for macro is being sold right which I
wouldn't call that advance for my

525
00:48:14,540 --> 00:48:17,750
perspective you know as a reverse
engineer i wouldn't call it advanced but

526
00:48:17,750 --> 00:48:25,100
from you know a you know adversary user
perspective it's much more effective so

527
00:48:25,100 --> 00:48:29,930
it you know you could consider it more
advanced in its effectiveness

528
00:48:31,100 --> 00:48:39,230
so uh yeah and the thing is a lot of the
exploit kits the the the malware itself

529
00:48:39,230 --> 00:48:43,370
I've seen more of the malware you know
like a Trojan that sort of thing like

530
00:48:43,370 --> 00:48:46,970
them you know state-sponsored actors
stuff like that

531
00:48:47,570 --> 00:48:52,130
still exploiting you know some of the
more obscure vulnerabilities and some of

532
00:48:52,130 --> 00:48:58,040
the common ones but the the day to day
delivery of malware starts with an

533
00:48:58,040 --> 00:49:03,500
exploit kit which is typically not you
know going after a PDF for flash or

534
00:49:03,500 --> 00:49:08,600
Silverlight or Java actually not so much
java and java actually has kind of

535
00:49:08,600 --> 00:49:14,540
fallen off and I I i would say thank
Google for that because they they said

536
00:49:14,540 --> 00:49:19,250
you know we're not going to have any any
more plugins that are NPAPI everything

537
00:49:19,250 --> 00:49:24,860
has to be ppapi and then Oracle said
we're not going to make a ppapi Java

538
00:49:24,860 --> 00:49:32,450
plug-in and everyone went awesome the
perfect but yes I haven't seen Java but

539
00:49:32,450 --> 00:49:37,910
the exploit kit layer that's first the
first layer of delivery definitely you

540
00:49:37,910 --> 00:49:44,390
know I almost entirely relies on
vulnerabilities but the next layer

541
00:49:44,390 --> 00:49:49,040
payload the payload that it's delivering
doesn't necessarily these days rely on

542
00:49:49,040 --> 00:49:52,040
an exploit or or vulnerability

543
00:49:55,700 --> 00:49:58,700
looks like we have about five minutes
left

544
00:49:58,700 --> 00:50:04,399
any more questions alright so I'm gonna
jump to back to the slide i was on

545
00:50:04,400 --> 00:50:05,750
before

546
00:50:05,750 --> 00:50:11,570
alright so if anyone is going to be
around for different things and and fun

547
00:50:11,570 --> 00:50:15,650
stuff in the future i will be at their
beak on in

548
00:50:16,520 --> 00:50:20,810
shoot that's like two weeks wow so yeah
i'll be at Derby kind of two weeks

549
00:50:21,500 --> 00:50:25,130
this year I won't be speaking at there
because i will just be hanging out so

550
00:50:25,130 --> 00:50:30,710
come and hang out there with me and then
after that early next month I'm going to

551
00:50:30,710 --> 00:50:35,869
be a virus bulletin in denver i'll be
speaking about open source of our labs

552
00:50:35,869 --> 00:50:43,130
and then in Toronto at sektor which will
be shoot that's actually like two weeks

553
00:50:43,130 --> 00:50:50,000
after that I'll be in Toronto giving uh
another talk about coo bro volatility

554
00:50:50,000 --> 00:50:50,960
and thug

555
00:50:50,960 --> 00:50:58,130
so come check me out if you're in a any
of those locations and that's it so

556
00:50:58,130 --> 00:50:59,119
thank you

557
00:50:59,119 --> 00:51:11,089
thanks for coming and thanks thanks says
let's give says a round of applause

