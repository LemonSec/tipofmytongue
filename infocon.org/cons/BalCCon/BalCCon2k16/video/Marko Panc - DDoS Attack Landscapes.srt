1
00:00:21,050 --> 00:00:30,890
ok hi everybody thanks for coming so it
is said that every day loss presentation

2
00:00:30,890 --> 00:00:35,239
starts with the first light what is the
does i'm trying to maybe make things a

3
00:00:35,239 --> 00:00:40,669
bit differently when you speak with
people outside of the security network

4
00:00:40,670 --> 00:00:45,890
industry eternally get a few different
opinions when you mentioned them the dos

5
00:00:45,890 --> 00:00:51,170
attacks one of them is our latest
attacks they don't exist anymore there

6
00:00:51,170 --> 00:00:56,210
are a thing of the past you know we
patched everything up right ten years

7
00:00:56,210 --> 00:00:57,350
ago

8
00:00:57,350 --> 00:01:04,940
the truth is no we didn't second opinion
might you might encounter is that our

9
00:01:04,940 --> 00:01:10,220
command our isp with it will help us now
they want at least not the way you might

10
00:01:10,220 --> 00:01:11,360
think they will

11
00:01:11,360 --> 00:01:16,250
and the third opinion is that when they
do the same that you there's basically

12
00:01:16,250 --> 00:01:18,320
nothing you can do

13
00:01:18,320 --> 00:01:25,190
well I'm here to prove to show you that
maybe that's not totally correct as

14
00:01:25,190 --> 00:01:32,720
those attacks are effect of life on
everyday internet and working on what's

15
00:01:32,720 --> 00:01:36,800
a security operations center at the
latest mitigation provider you can

16
00:01:36,800 --> 00:01:45,440
easily have anywhere between 5 to 15 to
those attacks para de so what I was

17
00:01:45,440 --> 00:01:51,050
already does the taxable are they focus
on service disruption meaning that if

18
00:01:51,050 --> 00:01:58,640
you have a high-profit ecommerce site
running and somebody wants 2c c down

19
00:01:58,640 --> 00:02:04,429
they will lose this exact method to
accomplish that goal but also sometimes

20
00:02:04,429 --> 00:02:10,910
are those attacks are used just employed
as a smokescreen meaning to on the verge

21
00:02:10,910 --> 00:02:18,799
your attention from let's say a bridge
data breach or a defacement we're not

22
00:02:18,800 --> 00:02:29,030
only on revenue but also your let's say
customers trust suffers when it's talk

23
00:02:29,030 --> 00:02:31,070
is and what it is not so on

24
00:02:31,070 --> 00:02:32,750
I'm trying to make this talk

25
00:02:32,750 --> 00:02:39,290
vendor-independent as you have like
different providers out there you have

26
00:02:39,290 --> 00:02:45,079
different appliances are trying to solve
the same problem but generally they're

27
00:02:45,080 --> 00:02:51,920
all utilize really are similar practices
and similar approaches to the same

28
00:02:51,920 --> 00:03:02,810
problem so translation and the size and
frequency as a function of time so often

29
00:03:02,810 --> 00:03:08,120
you will see well sometimes you will see
some with solutions asian showing

30
00:03:08,120 --> 00:03:13,670
cyberattacks like an angry birds fashion
jumping from one side planet of the

31
00:03:13,670 --> 00:03:19,399
other well the truth is nobody has
global visibility on DDoS attacks

32
00:03:19,400 --> 00:03:23,630
everybody has just their own
representative viewpoint even the

33
00:03:23,630 --> 00:03:28,820
biggest enterprise great CD and
providers don't see more than maybe

34
00:03:28,820 --> 00:03:33,920
twenty thirty percent of all internet
traffic but still even this allows us

35
00:03:33,920 --> 00:03:40,880
just to see how the trends in those
attacks are progressing so here are my

36
00:03:40,880 --> 00:03:46,940
first of all it's a logarithmic scale so
the attacks at the top are by magnitudes

37
00:03:46,940 --> 00:03:53,390
larger than the attacks at the bottom
and were each dot represents a singular

38
00:03:53,390 --> 00:04:00,890
single or attack as you can see the
attack size is not really growing but

39
00:04:00,890 --> 00:04:10,548
the frequency is now why is that is
because things the the let's say ways

40
00:04:10,549 --> 00:04:15,380
people utilize those attacks they always
explore the same things that was

41
00:04:15,380 --> 00:04:20,600
explored the same protocols they don't
really change or not such as the abrupt

42
00:04:20,600 --> 00:04:29,840
base while the use of botnets and use of
tools becomes more and more easier let's

43
00:04:29,840 --> 00:04:36,140
say on some history so simple it's

44
00:04:36,680 --> 00:04:42,949
we had those things since the nineties
and we have them till today obviously

45
00:04:42,949 --> 00:04:49,550
but things like I no more attacks things
are that are not so much common anymore

46
00:04:49,550 --> 00:04:55,220
so a smurf attack is when you spoke to
the victim source IP and your broadcast

47
00:04:55,220 --> 00:05:02,000
broadcasting icmp echo request at at
Seattle networks broadcast address the

48
00:05:02,000 --> 00:05:09,530
pickup that is basically just oversized
icmp packets which will cause a buffer

49
00:05:09,530 --> 00:05:13,880
overflow but still exploiting the bad
implementation of the network stack

50
00:05:13,880 --> 00:05:24,169
since ya 2,000 people were already using
our seas piracy to control botnets from

51
00:05:24,169 --> 00:05:32,389
2001 we already had the first dns
servers use just as reflectors and 15

52
00:05:32,389 --> 00:05:38,060
years after we still face the same
problems so just here after the first

53
00:05:38,060 --> 00:05:44,389
big attack against the dns root servers
were initiated as you know the dns root

54
00:05:44,389 --> 00:05:52,340
servers are the main servers that
resolve the top-level domains so if you

55
00:05:52,340 --> 00:05:58,609
have a fqdn so the . which is usually
omitted and then it stands for on the

56
00:05:58,610 --> 00:06:04,789
road service of course we have more than
30 13 of them we have I think like 500

57
00:06:04,789 --> 00:06:10,219
something of them which are mostly any
casted and pretty much redundant some of

58
00:06:10,220 --> 00:06:16,729
them are young owned by university is
some by governments some by armies

59
00:06:16,729 --> 00:06:25,820
uh-huh in 2003 the first data's
mitigation services have our arise so

60
00:06:25,820 --> 00:06:32,599
arm in two thousand treat this was the
error on line casinos gambling casinos

61
00:06:32,599 --> 00:06:38,479
came to be now at that time this was
like gray area of the law because it

62
00:06:38,479 --> 00:06:45,800
wasn't really regulated and they would
make a lot of money in this business so

63
00:06:46,370 --> 00:06:51,530
um they got their first extortionists
letters saying like okay we know you

64
00:06:51,530 --> 00:06:56,809
guys make fifty thousand dollars per
month we want to cut of that or your

65
00:06:56,810 --> 00:07:01,580
site your online casino goes down so at
that time there was really no other

66
00:07:01,580 --> 00:07:07,490
option than to comply with it but after
some time this online casinos they got

67
00:07:07,490 --> 00:07:15,500
together hired this guy named Barrett
Leon to put the first three Doors

68
00:07:15,500 --> 00:07:22,430
mitigation service in place which let to
the imprisonment of the main organizers

69
00:07:22,430 --> 00:07:32,479
behind it in 2012 operation album it's
not so really what's a significant in

70
00:07:32,479 --> 00:07:38,270
terms of technology or it wasn't
revolutionary but it's I think it's

71
00:07:38,270 --> 00:07:43,549
important because yeah it was a big
operation big docetaxel seriously does

72
00:07:43,550 --> 00:07:50,030
attacks aimed against big financial
institutions in the United States so

73
00:07:50,030 --> 00:07:57,710
that here gave the adidas service
mitigation industry a big boom on you

74
00:07:57,710 --> 00:08:03,409
can see here how the attack size is
progressing so in 2005 for just eight

75
00:08:03,410 --> 00:08:13,610
gigabits 2014 400 gigabytes 2015 the d4
bc and the great cannon of China so I

76
00:08:13,610 --> 00:08:16,610
guess everybody knows about the Great
Firewall of China

77
00:08:17,210 --> 00:08:23,989
well the great cannon of China is a
different mechanism which they intercept

78
00:08:23,990 --> 00:08:25,910
traffic came that

79
00:08:25,910 --> 00:08:31,220
baidu and inserted with the malicious
javascript causing the . specifically

80
00:08:31,220 --> 00:08:36,979
this time against our great fire . work
and get up which were providing tools to

81
00:08:36,979 --> 00:08:40,729
circumvent the the China's firewall

82
00:08:43,649 --> 00:08:55,319
motivations so we got a range of them so
revenge so it happened one time

83
00:08:55,319 --> 00:09:00,029
what say there was this big company and
this small company and this small

84
00:09:00,029 --> 00:09:06,119
company they stole the proprietary
software of this big company and they

85
00:09:06,119 --> 00:09:10,319
started making their own software now
the big company they couldn't really see

86
00:09:10,319 --> 00:09:15,899
them because they were outside of their
range of the law so what did the big

87
00:09:15,899 --> 00:09:21,449
company do they sponsored do those
attacks last thing for I think a bit

88
00:09:21,449 --> 00:09:24,748
over a year by continuously those
attacks against a small company

89
00:09:24,749 --> 00:09:29,850
blackmail extortion that that's pretty

90
00:09:30,689 --> 00:09:36,240
yeah well known hacktivism also is the
equivalent of the technology equivalent

91
00:09:36,240 --> 00:09:40,889
of spraying graffiti on your government
buildings i guess business feud

92
00:09:41,639 --> 00:09:44,970
I like your business i want to see you
down

93
00:09:44,970 --> 00:09:50,999
it's not so come uncommon especially in
specific interest industries for the

94
00:09:50,999 --> 00:09:57,389
competitors they use this taxes and also
leveling up

95
00:09:57,899 --> 00:10:06,660
does anybody have a day idea what that
one means yeah yeah yeah I was thrown

96
00:10:06,660 --> 00:10:14,219
it's a specific case but yeah I was
aiming more for on pvp so like in online

97
00:10:14,220 --> 00:10:22,800
multiplayer our games you have like
flavors player combat were the guy who

98
00:10:22,800 --> 00:10:29,160
wins to get some XP some items and the
guy who loses yeah he loses XP and block

99
00:10:29,160 --> 00:10:33,719
so what do they do if they see that
they're on the losing side they just

100
00:10:33,720 --> 00:10:38,370
launched this attack and get against the
server the both are connected to which

101
00:10:38,370 --> 00:10:43,470
results in like dropping oldest
connected players all the sessions so

102
00:10:43,470 --> 00:10:46,709
they get to live to fight another day

103
00:10:46,709 --> 00:10:55,498
groups well everybody knows this first
one activism oriented mostly a lizard

104
00:10:55,499 --> 00:10:57,180
squad they were big like again

105
00:10:57,180 --> 00:11:04,170
she does attacks in the gaming industry
today for be seen there they're

106
00:11:04,170 --> 00:11:09,540
interesting because i like their name is
pretty descriptive it's basically deals

107
00:11:09,540 --> 00:11:16,560
for Bitcoin you also have a copycat of
the day before bc our mother collective

108
00:11:16,560 --> 00:11:22,680
and so many groups so many groups
copycats impersonators this group

109
00:11:22,680 --> 00:11:28,199
operate sometimes in cells so you can
actually know certain texts are

110
00:11:28,200 --> 00:11:34,260
connected or they although they claim to
be and so on so this is a nice

111
00:11:34,260 --> 00:11:39,540
extortionist letter you might have
gotten from the thief or receive if

112
00:11:39,540 --> 00:11:45,990
you're working in a big and working a
bit company and it's very well put

113
00:11:45,990 --> 00:11:50,400
together so first they introduced
themselves give some links on the

114
00:11:50,400 --> 00:11:58,800
previous activity and then yeah they
demand the ransom lab extortion of 40

115
00:11:58,800 --> 00:12:07,050
bitcoins and they claim to have an UDP
flat ball power of 400-500 gigabits per

116
00:12:07,050 --> 00:12:13,709
second and it's written because even if
you have never used it going in your

117
00:12:13,710 --> 00:12:17,220
life just with this email you would be
able to make a payment

118
00:12:19,290 --> 00:12:26,670
yeah and also leaving way to message
them and the interesting thing is at the

119
00:12:26,670 --> 00:12:33,120
end they say we do bad things what we
keep our word extortionist they don't

120
00:12:33,120 --> 00:12:34,080
keep their word

121
00:12:34,080 --> 00:12:41,070
so on if you're I don't know a big top
management guy at a big company you

122
00:12:41,070 --> 00:12:45,990
might do you have you might have several
different approaches to this you might

123
00:12:45,990 --> 00:12:50,340
decide okay i'll just pay them off this
is like nothing for me

124
00:12:50,340 --> 00:12:56,250
its peanuts some of them pay them off
but still higher adidas mitigation

125
00:12:56,250 --> 00:13:00,360
service so yeah

126
00:13:01,050 --> 00:13:04,979
mechanisms

127
00:13:05,850 --> 00:13:11,220
why are those attacks possible well the
truth is for a variety of reasons there

128
00:13:11,220 --> 00:13:11,730
isn't

129
00:13:11,730 --> 00:13:18,990
uh there isn't one correct answer to do
it but I to try to put it into one

130
00:13:18,990 --> 00:13:24,540
sentence just of because of the way the
internet was gradually build because we

131
00:13:24,540 --> 00:13:29,370
rely on latest technology which were
never meant to be deployed in such a way

132
00:13:29,370 --> 00:13:38,459
use such a scale with several that
implementational ideas so basically I've

133
00:13:38,459 --> 00:13:45,149
all the big cats got to do together get
to rewrite all of this during the night

134
00:13:45,149 --> 00:13:49,890
and reboot the internet probably the
service providers would be out of their

135
00:13:49,890 --> 00:13:56,069
business but no way that that's going to
happen when it comes to those attacks we

136
00:13:56,070 --> 00:14:01,529
need to differentiate well metric
attacks vs resources starvation attacks

137
00:14:01,529 --> 00:14:08,490
and infrastructure vs application
attacks so on infrastructure attacks

138
00:14:08,490 --> 00:14:12,810
they're like layer tree and for
application attacks are obviously layer

139
00:14:12,810 --> 00:14:21,060
7 allometric attack is our attacks just
aimed at huge amount of using huge

140
00:14:21,060 --> 00:14:25,890
amount of bandwidth so for instance if
you're I don't know if you have your

141
00:14:25,890 --> 00:14:32,850
data center its multihomed had a fire
roll your ideas your status appliance

142
00:14:32,850 --> 00:14:38,910
you think you're pretty much prepared
for anything but then suddenly 200

143
00:14:38,910 --> 00:14:42,839
gigabytes per second this attack comes
your way

144
00:14:42,839 --> 00:14:48,329
causes huge saturation your provider
just no routes you because they don't

145
00:14:48,329 --> 00:14:52,770
want to route all the strategy traffic
to you and you're just there like a dead

146
00:14:52,770 --> 00:15:04,050
fish resources starvation attacks they
aim or at its are starving your

147
00:15:04,050 --> 00:15:08,130
infrastructure out of its resources for
instance if you have I don't know a load

148
00:15:08,130 --> 00:15:11,550
balancer capable of doing 10,000
concurrent connections

149
00:15:12,529 --> 00:15:20,660
and yeah huge layer 7 Flatts comes and
just takes all your resources legitimate

150
00:15:20,660 --> 00:15:26,930
users cannot connect so it's basically a
bit of a game

151
00:15:26,930 --> 00:15:33,378
who's got the bigger guns it's very easy
for an attacker to get more bandwidth

152
00:15:33,379 --> 00:15:40,279
then you have also one important thing
is a bit per second versus pockets per

153
00:15:40,279 --> 00:15:45,259
second usually when it comes to like
let's say one of these mega attacks

154
00:15:45,259 --> 00:15:50,689
which are classified as attacks of like
hundreds gigabits or more

155
00:15:50,689 --> 00:15:54,740
everybody just you know mentions to give
up its butt packets per second i was

156
00:15:54,740 --> 00:16:03,889
also an important metric here why are
because are doing stateful analysis

157
00:16:03,889 --> 00:16:09,529
doing like a switching it takes a lot of
resources it takes a lot of cpu power

158
00:16:09,529 --> 00:16:15,079
now the network gear the appliances you
have they all have a packet per second

159
00:16:15,079 --> 00:16:21,439
limit that they can inspect that they
can route and everything that scene

160
00:16:21,439 --> 00:16:31,790
appliances which had their cpu burnout
when the PPS limit was was hit stealth

161
00:16:31,790 --> 00:16:39,620
creeper attacks so they can't be this
but they do not have to be and there are

162
00:16:39,620 --> 00:16:46,129
much harder to detect these are things
like slow loris or low post attacks us

163
00:16:46,129 --> 00:16:54,259
like slow lorises just my new when the
attacker sensor HTTP request just one

164
00:16:54,259 --> 00:16:59,240
header at a time and there's a delay of
like you know 10 20 30 seconds between

165
00:16:59,240 --> 00:17:04,760
each other keeping the connection open
utilizing your connection pool that's it

166
00:17:04,760 --> 00:17:11,329
slow post works in a similar way just
utilizing the post method and with a

167
00:17:11,329 --> 00:17:17,178
pretty huge contemplating whether and
then when it comes to sending the body

168
00:17:17,179 --> 00:17:20,240
it just sense like one bite at a time

169
00:17:21,299 --> 00:17:29,730
so getting the same effect so how do
these guys do this well obviously they

170
00:17:29,730 --> 00:17:35,129
cannot like legally obtain such huge
amount of bandwidth it cannot go just

171
00:17:35,129 --> 00:17:36,928
there ESP and asking

172
00:17:36,929 --> 00:17:45,299
yeah I need a higher bigger uplink why
because reasons so are so they're

173
00:17:45,299 --> 00:17:52,259
utilizing buttons or heroes for hire
services which are freely available you

174
00:17:52,259 --> 00:17:55,529
can find a lot of them some of them have
an hourly rate

175
00:17:56,369 --> 00:18:01,320
some of them have a like rate for 15
minutes some of them have like fancy

176
00:18:01,320 --> 00:18:05,908
drop-down boxes where you can select
your type of attack which you want to

177
00:18:05,909 --> 00:18:11,970
launch one interesting thing about
botnets is that are in the last time

178
00:18:12,570 --> 00:18:20,999
linux well what about nets are becoming
more and more widely seen why is that

179
00:18:20,999 --> 00:18:27,779
well things like on the Explorer botnet
things like the think it's called bill

180
00:18:27,779 --> 00:18:29,429
gates but net

181
00:18:29,429 --> 00:18:35,549
it's basically utilizing their just
searching for linux servers that have SH

182
00:18:35,549 --> 00:18:41,549
open on the standard port without any
access control utilizing our weak

183
00:18:41,549 --> 00:18:46,320
passwords which were logging enabled so
just be a brute force to get access to

184
00:18:46,320 --> 00:18:52,649
it they make your pipe sh and they
download and out malware and then they

185
00:18:52,649 --> 00:19:03,479
can do pretty much everything our
infrastructure does so so the first five

186
00:19:03,480 --> 00:19:11,100
there are basically plaques in the tcp
Heather which you can turn off and on

187
00:19:11,100 --> 00:19:18,719
which are pretty normal in any tcp
communication but sometimes you just see

188
00:19:18,720 --> 00:19:25,889
them coming used in attacks different
combinations of it and they're generally

189
00:19:25,889 --> 00:19:31,379
referred to as out-of-state that's why
out-of-state words because they're not

190
00:19:31,379 --> 00:19:33,870
part of any established tcp connection

191
00:19:33,870 --> 00:19:39,300
so no TCP handshake has been made so
they just got dropped

192
00:19:40,320 --> 00:19:47,129
there's also what is called the xmax
express attack like a Christmas because

193
00:19:47,130 --> 00:19:53,250
all of the flags and the tcp TCP header
are turned on so it looks like a

194
00:19:53,250 --> 00:19:58,410
Christmas tree and also disappear
anomaly which is basically a badly

195
00:19:58,410 --> 00:20:05,130
crafted tcp packet with I don't know
they can have some tcp options in the

196
00:20:05,130 --> 00:20:12,270
payload because they're yeah barely
crafted hunt in flats there are like the

197
00:20:12,270 --> 00:20:19,470
most dangerous here let's say because
they're hard to differentiate is it you

198
00:20:19,470 --> 00:20:26,280
know are there are they spoofed are
there but violet clients so yeah just

199
00:20:26,280 --> 00:20:32,010
leave a half of open connection and if
you haven't tweaked your I know this

200
00:20:32,010 --> 00:20:36,420
would be back lock if you're having
decreased your time out this be timeless

201
00:20:36,420 --> 00:20:44,760
reasonable value but it's not going to
turn out good to you chargin yeah this

202
00:20:44,760 --> 00:20:52,410
is I think the most useless protocol I
know maybe it was used to a deep

203
00:20:52,410 --> 00:20:57,000
debugging purposes later somebody knows
any values of jargon please let me know

204
00:20:58,170 --> 00:21:03,840
it runs on port 19 and when you connect
to it you just get a random stream of

205
00:21:03,840 --> 00:21:09,419
characters dns we're going to talk about
that later

206
00:21:10,140 --> 00:21:16,440
icmp is also there although icmp often
it's not used as a direct attack vector

207
00:21:16,440 --> 00:21:23,040
sometimes you just see it as how to call
it back chatter because if then you

208
00:21:23,040 --> 00:21:27,510
repeat the nation for is not available
you'll get back

209
00:21:27,510 --> 00:21:30,929
19 p message saying that's only a
reflection attack

210
00:21:31,470 --> 00:21:37,920
yeah you'll see it rip specifically
version rip one has ripped too had

211
00:21:37,920 --> 00:21:45,299
notification enabled so for some reason
people are still using a rip routers are

212
00:21:45,299 --> 00:21:52,860
the internet version one so you can use
them also a reflection attack to get

213
00:21:52,860 --> 00:21:59,639
their roots with a spoofed IP and yeah
aimed at your victims or service ssdp

214
00:21:59,639 --> 00:22:07,258
ntp we're going to talk about them bit
later so you debase amplification why is

215
00:22:07,259 --> 00:22:14,460
it good for and why and what is it
exactly so often you'll hear the words

216
00:22:14,460 --> 00:22:17,460
amplification no shots now

217
00:22:18,299 --> 00:22:26,220
usually you hear the word amplification
and reflection used together so how does

218
00:22:26,220 --> 00:22:32,850
it exactly work well we have here our
attacker with their command center and

219
00:22:32,850 --> 00:22:35,939
he has a series of compromised machines

220
00:22:35,940 --> 00:22:42,570
he has his own botnet and then he finds
some servers running some vulnerable

221
00:22:42,570 --> 00:22:49,230
services that he can exploit in some way
on so this is where the amplification

222
00:22:49,230 --> 00:22:54,690
factor comes in because with
amplification you don't need so much

223
00:22:54,690 --> 00:22:59,609
resources on your side because the
request you're sending is much smaller

224
00:22:59,609 --> 00:23:07,439
than the response so you get different
amplification factors depending on which

225
00:23:07,440 --> 00:23:14,429
kind of protocol exploit so today you
you use of course you support the source

226
00:23:14,429 --> 00:23:17,999
IP because it's UDP so there is no
really

227
00:23:17,999 --> 00:23:22,679
state it's just a fire-and-forget
protocol best for delivery

228
00:23:22,679 --> 00:23:30,509
that's all there is to so yeah we still
have dns reflection attacks and we also

229
00:23:30,509 --> 00:23:38,489
have ntp amplification attacks so as you
know ntp that for time protocol hospital

230
00:23:38,489 --> 00:23:39,869
synchronize your time

231
00:23:39,869 --> 00:23:46,529
so Andy Brooks like it's a hierarchical
setup so on the top you got an atomic

232
00:23:46,529 --> 00:23:52,440
clock and then you got this different
layers called Stratasys so stretches one

233
00:23:52,440 --> 00:23:56,730
they have an offset of just a few
milliseconds but it's not the problem

234
00:23:56,730 --> 00:23:58,500
entity was built but is this

235
00:23:58,500 --> 00:24:05,850
the command won't get list which you can
use in entropy amplification attack this

236
00:24:05,850 --> 00:24:11,820
command it's more for debugging purposes
it just get the list of the last

237
00:24:11,820 --> 00:24:16,500
connected clients which synchronize the
time with the services so there are a

238
00:24:16,500 --> 00:24:27,840
lot of ntp servers with this function
enabled open resolvers now this is on to

239
00:24:27,840 --> 00:24:33,780
talk about dns how many of you know
about the open resolver project

240
00:24:35,430 --> 00:24:44,820
ok cool so open resolvers are basically
dns servers which answer to queries

241
00:24:44,820 --> 00:24:51,870
outside of their administrative domains
and we have many of them dunno maybe how

242
00:24:51,870 --> 00:24:52,770
much

243
00:24:52,770 --> 00:25:00,930
yeah it it's 30 million and like 28
million for them are exploitable in some

244
00:25:00,930 --> 00:25:05,910
way so if you're running a dns server
please make sure that it's only

245
00:25:05,910 --> 00:25:12,300
answering two queries within your domain
so unless you're like building for

246
00:25:12,300 --> 00:25:15,300
opendns or google but that's another
story

247
00:25:17,670 --> 00:25:24,690
so amplification factor as you can see
ntp chargen pretty nice amplification

248
00:25:24,690 --> 00:25:31,650
factor the dns amplification factor
varies why is that well because it

249
00:25:31,650 --> 00:25:36,930
varies on the query you are using
because dns has different record types

250
00:25:36,930 --> 00:25:41,820
used for different things so for
instance there is this any query which

251
00:25:41,820 --> 00:25:48,060
return all of the record types which is
really bad and should be disabled to

252
00:25:48,060 --> 00:25:55,770
also people for for some reason our
hosting huge takes their records like

253
00:25:55,770 --> 00:26:01,410
I've seen takes their records with like
points and literally works

254
00:26:01,410 --> 00:26:04,680
i I don't know what was the use of that
but we have it

255
00:26:06,490 --> 00:26:15,250
yeah this is example caring for a ntp
server this command enabled and a small

256
00:26:15,250 --> 00:26:18,820
code how to utilize that through your
own purposes

257
00:26:18,820 --> 00:26:27,129
ssdp flight now I'm stp flat is a
relatively new attack vector order we

258
00:26:27,130 --> 00:26:30,670
had this sdb protocol for some time now

259
00:26:30,670 --> 00:26:37,960
SVP is one of them plug-and-play
protocols and a lot of like printers

260
00:26:37,960 --> 00:26:39,370
that cameras

261
00:26:39,370 --> 00:26:45,219
Reuters have this protocol and it's
quite useful and allows for automatic

262
00:26:45,220 --> 00:26:51,250
device discovery but the problem is
someone the same device has a public

263
00:26:51,250 --> 00:26:56,530
rootable IP then you can make it then
you can use it to make a reflection

264
00:26:56,530 --> 00:27:05,889
attack resulting in this payload so it's
it's interesting because we had I think

265
00:27:05,890 --> 00:27:16,420
ssdp since maybe 99 2000 2001 but it
took like 13 14 years i think it until

266
00:27:16,420 --> 00:27:22,390
somebody has thought of to exploit it so
if you have a router at home and its

267
00:27:22,390 --> 00:27:25,420
forces DP chances are you

268
00:27:26,410 --> 00:27:29,770
yeah we're taking part and willingly in
a did DDoS attack

269
00:27:33,880 --> 00:27:41,230
dns reflection plots so basically a same
scenario attacker from our commands the

270
00:27:41,230 --> 00:27:45,790
compromised machines are compromised
machines they spoof intended victims

271
00:27:45,790 --> 00:27:51,430
source IP the cleri the open court
requires of servers which sense

272
00:27:51,430 --> 00:27:58,570
withstand huge UT payloads to the
intended victim disappear based attacks

273
00:27:58,570 --> 00:28:06,520
now PCP takes care of the state you have
the usual story you have the true a

274
00:28:06,520 --> 00:28:07,810
handshake

275
00:28:07,810 --> 00:28:15,970
it establishes never got some kind of a
verification so out-of-state parts as we

276
00:28:15,970 --> 00:28:23,350
told our different flags which don't and
and random sequence number which are not

277
00:28:23,350 --> 00:28:27,219
part of an already established
connection

278
00:28:27,220 --> 00:28:32,860
rainbow rainbow floods with our
different flags turned on which do not

279
00:28:32,860 --> 00:28:38,740
like makes sense that go together a tcp
anomaly but we crafted disappear packets

280
00:28:38,740 --> 00:28:46,120
and yeah this is important because rtcp
has this transmission control block

281
00:28:46,120 --> 00:28:50,620
which is a data structure within
disappear which holds information about

282
00:28:50,620 --> 00:28:56,169
the current connection so each time a
syn packet comes in this tcp with will

283
00:28:56,170 --> 00:29:01,570
hold information about things like
source destination IP next sequence

284
00:29:01,570 --> 00:29:06,429
number things like that so being gone
data structure is a unit of resource and

285
00:29:06,430 --> 00:29:12,430
you can have you cannot have an
unlimited number of them sin Grable

286
00:29:12,430 --> 00:29:15,220
flats so yeah

287
00:29:15,220 --> 00:29:20,920
for instance this is on down the rainbow
but with a different DCP flex turned on

288
00:29:20,920 --> 00:29:26,470
which are not valid because at the same
time you have the scene and resident

289
00:29:26,470 --> 00:29:31,120
flag so why do you want to speak with me
at the same time and terminate the

290
00:29:31,120 --> 00:29:34,120
connection at the same time

291
00:29:34,840 --> 00:29:44,139
application layer attacks now as with
all these are layer 7 attacks and they

292
00:29:44,140 --> 00:29:50,260
can be a variety of things so what makes
for a good layer 7 attack

293
00:29:51,430 --> 00:30:01,120
well you have basic hdb flats when sub
somebody just like tries to get / but

294
00:30:01,120 --> 00:30:07,689
they're pretty obvious and easy got
randomized HTTP flats were our people

295
00:30:07,690 --> 00:30:12,100
will feed different user agent values
and they will probably do some

296
00:30:12,100 --> 00:30:17,050
investigation some web scraping of your
side before their they launched the

297
00:30:17,050 --> 00:30:21,370
attack and they will pretty much
randomized it so there will be harder to

298
00:30:21,370 --> 00:30:22,090
catch

299
00:30:22,090 --> 00:30:28,209
also Monday do such a thing they want to
bypass the cash because I because if you

300
00:30:28,210 --> 00:30:34,330
have a i don't know let's say a varnish
cluster which is really good at serving

301
00:30:34,330 --> 00:30:38,620
static content you don't want to hit the
varnish you want to get the backhand you

302
00:30:38,620 --> 00:30:42,550
want to get especially the back and
logic of the application you know

303
00:30:42,550 --> 00:30:48,159
because you want to hit the databases
you want to go with some slow queries

304
00:30:48,160 --> 00:30:51,160
you need to do some serious damage

305
00:30:53,980 --> 00:31:04,300
https floods are basically the same
thing just are ya with on on TLS SL Rick

306
00:31:04,300 --> 00:31:11,710
negotiation attacks so this this is now
likely a thing of the past basically on

307
00:31:11,710 --> 00:31:17,200
one and necessary during an ssl
handshake when it's established the

308
00:31:17,200 --> 00:31:23,080
client and request a broad core brought
protocol renegotiation which is much

309
00:31:23,080 --> 00:31:27,820
more expensive on the server side than
on the client side usually now

310
00:31:27,820 --> 00:31:31,720
renegotiation is disabled pretty much
everywhere

311
00:31:33,789 --> 00:31:45,999
ok so this is a malicious get request
does anybody see why this malicious a

312
00:31:45,999 --> 00:31:49,059
tip it's not because the except language
is Chinese

313
00:31:58,020 --> 00:32:00,990
mhm

314
00:32:00,990 --> 00:32:07,500
note that up but what why is it is the
ball card invalid

315
00:32:10,080 --> 00:32:17,939
nope nope not that so on there are
different things first thing that are

316
00:32:17,940 --> 00:32:21,690
interesting is well

317
00:32:21,690 --> 00:32:25,710
pragma and cache control headers or
they're so they're like really using

318
00:32:25,710 --> 00:32:31,110
legacy cache headers everything because
they really want too hard to bypass cash

319
00:32:31,110 --> 00:32:35,760
but this is not an indication of a
malicious request as true indication of

320
00:32:35,760 --> 00:32:44,220
malicious request is that on ya by
specification there needs to be a space

321
00:32:44,220 --> 00:32:50,880
between the key value pair so between
the header name and the value and here

322
00:32:50,880 --> 00:32:55,410
on the host header you don't have a
space it's just just everything written

323
00:32:55,410 --> 00:33:00,960
together and the same thing with
connection keep-alive and cash control

324
00:33:00,960 --> 00:33:10,350
the sea is spelt lorica a lowercase so
this is indicative of a ultimate eyes

325
00:33:10,350 --> 00:33:14,879
attack because the people who make this
kind of attacks they don't make a huge

326
00:33:14,880 --> 00:33:22,710
effort to implement all aspects of every
RFC there is so it's just like small

327
00:33:22,710 --> 00:33:31,290
things like this that are dead giveaway
detection how to do a proper protection

328
00:33:31,290 --> 00:33:38,610
well first you need to know your RC is
so you need to know what's valid what's

329
00:33:38,610 --> 00:33:44,459
not what's written you know in like a
good specification what's not also are

330
00:33:44,460 --> 00:33:51,210
false positive versus force- now a
mitigation and it's not really an exact

331
00:33:51,210 --> 00:33:52,320
science

332
00:33:52,320 --> 00:33:59,639
sometimes you'll over mitigate because
some legitimate client was called in the

333
00:33:59,640 --> 00:34:04,710
rule you wrote or you're under mitigate
and something goes under the red radar

334
00:34:04,710 --> 00:34:11,580
another thing to use is an anomaly
detection basically Delta calculation

335
00:34:11,580 --> 00:34:13,489
when you just profile

336
00:34:13,489 --> 00:34:20,330
the clients traffic and over a series of
a few weeks and then with this engine

337
00:34:20,330 --> 00:34:25,699
you decide you know use tell it's like
over a period of 15 minutes

338
00:34:25,699 --> 00:34:32,270
mmm more than twenty percent packets per
second variation is not accepted so

339
00:34:32,270 --> 00:34:36,649
Monday's thresholds are reached you'll
get a notification and then you go and

340
00:34:36,649 --> 00:34:43,969
manual check these things out of course
you can also use already appliances

341
00:34:43,969 --> 00:34:50,779
which have on their own detection
mechanisms in its so you just plug it in

342
00:34:50,780 --> 00:34:55,909
in line to analyze the traffic and they
just have warned you detect if something

343
00:34:55,909 --> 00:34:59,090
might be happening in something is wrong

344
00:34:59,090 --> 00:35:06,350
graphs are really useful super useful
because breaths are often a dead

345
00:35:06,350 --> 00:35:11,720
giveaway especially in volumetric
attacks when you just see things like

346
00:35:11,720 --> 00:35:18,770
this I mean this is obviously not this
is obviously not a flash crowd because

347
00:35:18,770 --> 00:35:26,180
yeah it's just like from 0 to 1 into the
hex well of course you need to do a lot

348
00:35:26,180 --> 00:35:34,100
of PCP dumping a lot of packet analysis
and if you do it a lot you'll get like

349
00:35:34,100 --> 00:35:39,440
six cents at pattern detection you'll
recognize certain patterns happening all

350
00:35:39,440 --> 00:35:47,000
over you maybe get even to know the
traffic of a certain client if you're

351
00:35:47,000 --> 00:35:52,310
working a lot on their network so yeah
sometimes you can call it even by using

352
00:35:52,310 --> 00:36:05,690
your your I so packet forensics are this
is this is an example of r2 r2 packets

353
00:36:05,690 --> 00:36:13,010
with disappeared simple i can able so
the sort of the handshake and one of

354
00:36:13,010 --> 00:36:16,220
them looks a bit strange

355
00:36:16,220 --> 00:36:24,980
I don't know if you can see it from here
yeah i think you can so okay so although

356
00:36:24,980 --> 00:36:28,730
does anybody see maybe what's wrong with
any of this

357
00:36:29,270 --> 00:36:40,910
like one of these two might be a bit
suspicious so it's were really strange

358
00:36:40,910 --> 00:36:47,720
for a syn packet to carry a payload
although it's not against RFC and there

359
00:36:47,720 --> 00:36:52,819
is this like think like called PCP past
open which is still like experimental

360
00:36:52,820 --> 00:36:58,190
and starting news you know it's it's not
the direct indication that it's

361
00:36:58,190 --> 00:37:02,210
malicious but yeah I would definitely
watch out for it

362
00:37:03,410 --> 00:37:12,020
mitigation techniques so are we got here
a wide variety of different mitigation

363
00:37:12,020 --> 00:37:16,970
techniques some of them are so obvious
as rate-limiting meaning from a single

364
00:37:16,970 --> 00:37:23,299
source IP I don't want to see more than
hundred concurrent connections or more

365
00:37:23,300 --> 00:37:30,619
than I know ten new connections per
second acl's help you always try to

366
00:37:30,619 --> 00:37:36,170
block the malicious traffic upstream
always so it doesn't influence the rest

367
00:37:36,170 --> 00:37:42,290
of your infrastructure so you can use
just your edge routers control list we

368
00:37:42,290 --> 00:37:49,460
can match and specific ranges are or on
different a combination of tcp flags

369
00:37:49,460 --> 00:37:58,820
black holing is the thing I species do
ya source-based now routing basically

370
00:37:58,820 --> 00:38:03,500
the same thing just based on the source
address stateful inspection devices

371
00:38:03,500 --> 00:38:09,619
which are basically the appliances that
those fateful inspection and signature

372
00:38:09,619 --> 00:38:18,619
matching sin cookies now what are some
cookies cookies are method to detect

373
00:38:18,619 --> 00:38:27,830
spoofed syn packets so our how do they
work well the cookie value so one an

374
00:38:27,830 --> 00:38:29,450
attacker bunches

375
00:38:29,450 --> 00:38:38,000
a sin from here with a spoofed IP the
receiver it gets that's in it drops it

376
00:38:38,000 --> 00:38:46,130
but it calculates also a value which is
made up of our source IP port

377
00:38:46,130 --> 00:38:52,430
combination destination IP port secret
seed and initial sequence number and

378
00:38:52,430 --> 00:38:59,450
then send it back with our snack now if
you get the final act meaning if it's a

379
00:38:59,450 --> 00:39:05,839
valid client is able to reconstruct the
connection just from that sin cookie

380
00:39:05,839 --> 00:39:14,480
header order for our layer seven flights
there also are sometimes to give away

381
00:39:14,480 --> 00:39:21,230
because some of these devices some of
the other these attacks utilize a

382
00:39:21,230 --> 00:39:26,450
specific Heather order so you can I
don't use things maybe like I know snort

383
00:39:26,450 --> 00:39:32,299
or something just to match the header
order dns truncated bit

384
00:39:33,589 --> 00:39:42,259
it's a method against protecting our
from spoofed dns flats because by this

385
00:39:42,260 --> 00:39:48,920
you indicate that you don't want to talk
VI UDP you're only interested talk the

386
00:39:48,920 --> 00:39:54,619
rtcp because ya Yin is primarily works
via UDP but there are some things like

387
00:39:54,619 --> 00:39:59,329
zone transfers which required to see
because you kind of want to zone

388
00:39:59,329 --> 00:40:07,430
transfers to be reliable and network in
crystal drink which is I think everybody

389
00:40:07,430 --> 00:40:15,078
running any like network should
implement its it's a way of verifying

390
00:40:15,079 --> 00:40:24,140
that the originating our pockets fit to
your network so meaning that you're

391
00:40:24,140 --> 00:40:31,250
serving your so you're serving from our
that network it's it's basically a good

392
00:40:31,250 --> 00:40:35,390
neighbor policy because you're not
benefiting yourself by implementing that

393
00:40:35,390 --> 00:40:38,960
but yeah it's it's a good thing and
everybody should have it

394
00:40:39,470 --> 00:40:45,348
also force there are some things like on
four layer layer seven floors if there

395
00:40:45,349 --> 00:40:53,000
are initiated by a botnet you can send
them on JavaScript like redirect cookie

396
00:40:53,000 --> 00:40:56,330
or something because some of them cannot
follow it

397
00:40:56,330 --> 00:41:04,340
well more the most new botnets cat but
it's worth the try different solutions

398
00:41:04,340 --> 00:41:09,920
when it comes to mitigation of course
you have on-premise devices you have

399
00:41:09,920 --> 00:41:17,390
plowed and you have hybrid solutions are
on premise is basically you have your

400
00:41:17,390 --> 00:41:21,529
own device there have your appliance
clouds utilizing different cloud

401
00:41:21,530 --> 00:41:28,369
providers hybrid is having an on-premise
device which if certain patterns are

402
00:41:28,369 --> 00:41:34,340
match just activate and your routed to
the cloud

403
00:41:34,340 --> 00:41:44,270
yeah often with the cloud there is there
is a different ways to implement it so

404
00:41:44,270 --> 00:41:50,240
you can put your services behind again
so CDN it's like every host is made like

405
00:41:50,240 --> 00:41:57,169
a bastion host so on the utilized any
caste or they do some dns magic were

406
00:41:57,170 --> 00:42:04,460
your site always resolved to the like
nearest nearest server nearest edge

407
00:42:04,460 --> 00:42:10,670
server to work for your original client
location i'm running out of time and

408
00:42:10,670 --> 00:42:14,690
it's good things up a bit and cloudy the
solutions

409
00:42:14,690 --> 00:42:22,250
well so as I said you got you can put
your side behind the CDN but you can

410
00:42:22,250 --> 00:42:32,180
also utilize a GRE tunnel to announce
your practices over a cloud neros

411
00:42:32,180 --> 00:42:37,460
solution where they become effectively
your eyes be and all traffic needs to go

412
00:42:37,460 --> 00:42:41,060
to them before it reaches your
destination

413
00:42:41,060 --> 00:42:48,140
so here we know that there is this term
called mitigation center scrubbing

414
00:42:48,140 --> 00:42:51,348
center thoes protection Center which is
basically

415
00:42:52,150 --> 00:42:59,470
on data center focused only on scrubbing
bad traffic and forwarding the good

416
00:42:59,470 --> 00:43:06,368
traffic they're usually manned by 24-7
socks they like sometimes have an SLA

417
00:43:06,369 --> 00:43:11,440
sometimes they don't meaning that some
of them say okay will mitigate this kind

418
00:43:11,440 --> 00:43:17,230
of attack in so much and so much time
they leverage anycast so not a single

419
00:43:17,230 --> 00:43:22,150
scrubbing center sees the flow
full-blown attack because yeah asset

420
00:43:22,150 --> 00:43:31,510
distributed attack require a distributed
defense and also gives that the attack

421
00:43:31,510 --> 00:43:38,980
traffic is not routed to the whole globe
have usually terabytes of our habits of

422
00:43:38,980 --> 00:43:44,319
attack epatha t it also features some
kind of tragedy telligence so they might

423
00:43:44,319 --> 00:43:48,788
know sometimes that an attack is going
to happen before it actually does

424
00:43:48,789 --> 00:43:59,440
they also do a zero-day stuff and jap
that's it and who

425
00:44:00,010 --> 00:44:03,089
ok

426
00:44:03,089 --> 00:44:06,210
so guys I'm up for any questions now
thank you for listening

427
00:44:06,900 --> 00:44:10,890
yep always yeah so you have to

428
00:44:17,180 --> 00:44:25,009
my question is there a possibility to
create one hundred percent protection

429
00:44:25,010 --> 00:44:31,880
from dust and I mean if you have a
attacker who is create basically the

430
00:44:31,880 --> 00:44:38,119
same package with size and the query
like a normal user yes you can do it

431
00:44:38,119 --> 00:44:42,200
maybe you know it always changes it
always see no pics the initial sequence

432
00:44:42,200 --> 00:44:49,189
number is always you know has the same
on the same signature you know you're

433
00:44:49,190 --> 00:44:52,280
doing some kind of signature mention
because like some attacks what they do

434
00:44:52,280 --> 00:44:56,660
it's like for instance in flats they
have a payload which is like it's called

435
00:44:56,660 --> 00:45:02,598
Pat sense so like when you open it you
can see just zeros or you can see like

436
00:45:02,599 --> 00:45:07,849
the f-word continuously like going to be
so but that is a butt about the human

437
00:45:07,849 --> 00:45:10,339
interface not automatically stuff

438
00:45:10,339 --> 00:45:16,880
no no no no not automatically because
it's it's on ya machine learning isn't

439
00:45:16,880 --> 00:45:22,040
so advanced that is it as its yeah it is
that it's just it's just the state of

440
00:45:22,040 --> 00:45:27,200
things but basically you need a human
every time to make a decision otherwise

441
00:45:27,200 --> 00:45:32,270
you could really damage you know the
customer because you can block are you

442
00:45:32,270 --> 00:45:35,089
know legitimate traffic if thank you

443
00:45:35,089 --> 00:45:38,089
yep

444
00:45:42,779 --> 00:45:45,779
anybody

445
00:45:49,540 --> 00:45:52,870
how are you have good so far

446
00:46:05,920 --> 00:46:10,540
if you've seen more of these attacks in
the last time especially with

447
00:46:10,540 --> 00:46:14,410
blackmailing companies so sorry one more
time

448
00:46:14,410 --> 00:46:18,759
have you seen more of these attacks in
the last time I not a real field outside

449
00:46:18,760 --> 00:46:27,640
so i'm not actually working her in this
industry since some time ago but the

450
00:46:27,640 --> 00:46:30,879
truth is this attacks

451
00:46:30,880 --> 00:46:35,109
yeah that they're becoming you know
they're quite common

452
00:46:35,109 --> 00:46:41,470
so it's every time for instance
especially in you know like gambling in

453
00:46:41,470 --> 00:46:46,270
the streets things like that it's a
totally you know legit way of doing

454
00:46:46,270 --> 00:46:51,490
business by just knocking your
competitor totally off so yeah it's it

455
00:46:51,490 --> 00:46:55,000
is pretty much common still I don't see
it going away anytime soon

456
00:46:55,780 --> 00:47:00,849
okay thank you so guys thanks for
listening if you have any other question

457
00:47:00,849 --> 00:47:03,700
i'll be moving around here somewhere

458
00:47:03,700 --> 00:47:08,859
thank you

459
00:47:12,110 --> 00:47:14,240
yeah

