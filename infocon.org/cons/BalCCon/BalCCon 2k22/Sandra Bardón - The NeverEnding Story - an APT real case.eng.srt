1
00:00:00,080 --> 00:00:16,909
[Music]

2
00:00:18,980 --> 00:00:21,130
thank you

3
00:00:21,130 --> 00:00:24,660
[Music]

4
00:00:28,460 --> 00:00:31,560
thank you thank you guys

5
00:00:31,560 --> 00:00:35,660
um so hello everyone good afternoon

6
00:00:36,360 --> 00:00:37,440
um

7
00:00:37,440 --> 00:00:39,840
first of all I want just to say thank

8
00:00:39,840 --> 00:00:43,379
you to the organization to Delena to

9
00:00:43,379 --> 00:00:47,160
Milos just to allow me to stay here it's

10
00:00:47,160 --> 00:00:49,980
a great great pleasure I'm super happy

11
00:00:49,980 --> 00:00:52,800
to stay here it's my first time in

12
00:00:52,800 --> 00:00:54,960
balcon and in Serbia

13
00:00:54,960 --> 00:00:58,920
so I hope you will enjoy my talk

14
00:00:58,920 --> 00:01:01,379
so I'm going just to start in the

15
00:01:01,379 --> 00:01:02,940
Country Way

16
00:01:02,940 --> 00:01:06,479
that talk used to start

17
00:01:06,479 --> 00:01:10,020
I have a question to you

18
00:01:10,020 --> 00:01:14,658
um how many of you are from the 80s

19
00:01:15,780 --> 00:01:17,159
okay

20
00:01:17,159 --> 00:01:19,560
how many of you have read The

21
00:01:19,560 --> 00:01:22,400
NeverEnding Story

22
00:01:22,979 --> 00:01:24,180
cool

23
00:01:24,180 --> 00:01:27,479
and what's the movie

24
00:01:27,479 --> 00:01:28,860
really nice

25
00:01:28,860 --> 00:01:32,040
so I was so so fond of The Neverending

26
00:01:32,040 --> 00:01:33,840
Story so probably you already know the

27
00:01:33,840 --> 00:01:36,299
the history behind

28
00:01:36,299 --> 00:01:41,820
but I see the many of incidents and apts

29
00:01:41,820 --> 00:01:44,579
like they never end in a story you can

30
00:01:44,579 --> 00:01:48,060
just finish the history just giving

31
00:01:48,060 --> 00:01:50,880
another name

32
00:01:50,880 --> 00:01:52,680
um from Fantasia

33
00:01:52,680 --> 00:01:55,380
to the APT so we are talking about

34
00:01:55,380 --> 00:01:57,659
traductors and we are going just to talk

35
00:01:57,659 --> 00:02:01,320
about iocs the timeline for sure so

36
00:02:01,320 --> 00:02:04,619
let's start just a little bit

37
00:02:04,619 --> 00:02:07,439
brief introduction about me

38
00:02:07,439 --> 00:02:09,360
uh Sandra Bardon thank you for the

39
00:02:09,360 --> 00:02:11,760
presentation

40
00:02:11,760 --> 00:02:13,920
um currently I'm working for a United

41
00:02:13,920 --> 00:02:17,899
Nations International Computing Center

42
00:02:20,460 --> 00:02:21,800
[Applause]

43
00:02:21,800 --> 00:02:25,260
exercises it can be today one topic

44
00:02:25,260 --> 00:02:27,599
exercises red teaming exercises purple

45
00:02:27,599 --> 00:02:29,340
teaming exercises

46
00:02:29,340 --> 00:02:30,780
and

47
00:02:30,780 --> 00:02:33,920
helping as well into the Fantastic

48
00:02:33,920 --> 00:02:37,319
because my my core my main expertise is

49
00:02:37,319 --> 00:02:40,020
just in that wheel and as well in

50
00:02:40,020 --> 00:02:43,080
exploitation I used to to teach at the

51
00:02:43,080 --> 00:02:45,239
University different universities as

52
00:02:45,239 --> 00:02:46,519
well

53
00:02:46,519 --> 00:02:49,440
but I had a conversation yesterday quite

54
00:02:49,440 --> 00:02:52,680
nice that I started my work as a blue

55
00:02:52,680 --> 00:02:53,700
teamer

56
00:02:53,700 --> 00:02:56,940
during some years at the Spanish joins

57
00:02:56,940 --> 00:03:00,360
cyber command it was so nice doing some

58
00:03:00,360 --> 00:03:03,660
forensics Central hunting but I decided

59
00:03:03,660 --> 00:03:06,360
I mean there's a person gave me an

60
00:03:06,360 --> 00:03:08,640
opportunity just to to join the the red

61
00:03:08,640 --> 00:03:09,720
team

62
00:03:09,720 --> 00:03:12,440
uh uh and I yes

63
00:03:12,440 --> 00:03:15,540
just go directly to to the open side

64
00:03:15,540 --> 00:03:18,000
site to the dark side I will say to the

65
00:03:18,000 --> 00:03:19,300
red team

66
00:03:19,300 --> 00:03:21,560
[Music]

67
00:03:21,560 --> 00:03:24,900
in Spain many many years and after that

68
00:03:24,900 --> 00:03:27,720
I just moved to the to Estonia so I know

69
00:03:27,720 --> 00:03:29,640
the cold cold winter

70
00:03:29,640 --> 00:03:33,900
I mean more harder than here I guess

71
00:03:33,900 --> 00:03:37,620
um doing some research related to band

72
00:03:37,620 --> 00:03:40,799
testing on ICS industrial control

73
00:03:40,799 --> 00:03:43,680
systems and as well service station

74
00:03:43,680 --> 00:03:46,080
electrical substances and power plants

75
00:03:46,080 --> 00:03:49,080
and so on doing some research in related

76
00:03:49,080 --> 00:03:51,659
to pen test that kind of systems

77
00:03:51,659 --> 00:03:54,440
teaching courses as well and

78
00:03:54,440 --> 00:03:57,360
participating in different kind of

79
00:03:57,360 --> 00:04:00,060
exercises all of them in in the red team

80
00:04:00,060 --> 00:04:02,220
or leading the the red team

81
00:04:02,220 --> 00:04:03,659
so

82
00:04:03,659 --> 00:04:04,560
um

83
00:04:04,560 --> 00:04:06,239
I'm going to have to stop talking about

84
00:04:06,239 --> 00:04:07,920
me

85
00:04:07,920 --> 00:04:10,400
first of all languages to give you a

86
00:04:10,400 --> 00:04:14,540
really small introduction about what is

87
00:04:14,540 --> 00:04:17,579
unicc that is the place that I import to

88
00:04:17,579 --> 00:04:19,440
uh I'm not going just to sell you

89
00:04:19,440 --> 00:04:21,660
anything I promise it will be really

90
00:04:21,660 --> 00:04:24,600
really small and after that we just go

91
00:04:24,600 --> 00:04:27,600
directly to tissue some technical

92
00:04:27,600 --> 00:04:29,699
details about the incident that we

93
00:04:29,699 --> 00:04:33,060
suffer inside United Nations one of the

94
00:04:33,060 --> 00:04:34,919
incidents I will say

95
00:04:34,919 --> 00:04:37,860
and next steps for sure

96
00:04:37,860 --> 00:04:39,419
so

97
00:04:39,419 --> 00:04:41,280
um United Nations International computer

98
00:04:41,280 --> 00:04:43,259
center it's an organization Under the

99
00:04:43,259 --> 00:04:45,419
Umbrella of UN

100
00:04:45,419 --> 00:04:48,680
we have 50 years

101
00:04:48,680 --> 00:04:51,419
of experience just giving some digital

102
00:04:51,419 --> 00:04:54,300
Solutions some different agencies or

103
00:04:54,300 --> 00:04:56,759
organization Under the

104
00:04:56,759 --> 00:04:59,720
Umbrella of a un right now we are

105
00:04:59,720 --> 00:05:04,919
supporting and helping more than 85 I

106
00:05:04,919 --> 00:05:07,979
think it's right now it's not 70 clients

107
00:05:07,979 --> 00:05:11,460
it's like more than 82 at least

108
00:05:11,460 --> 00:05:13,440
so we are providing some digital

109
00:05:13,440 --> 00:05:15,240
Solutions like at the very very

110
00:05:15,240 --> 00:05:17,240
beginning like hosting

111
00:05:17,240 --> 00:05:20,400
but some from some years ago we are

112
00:05:20,400 --> 00:05:21,840
providing as well some cyber security

113
00:05:21,840 --> 00:05:24,539
services so

114
00:05:24,539 --> 00:05:25,139
um

115
00:05:25,139 --> 00:05:26,759
what are the agencies or the

116
00:05:26,759 --> 00:05:30,720
organization that we help or we support

117
00:05:30,720 --> 00:05:33,900
uh for sure United Nations they work as

118
00:05:33,900 --> 00:05:35,360
a Organization

119
00:05:35,360 --> 00:05:38,520
for example the World Bank

120
00:05:38,520 --> 00:05:39,900
um

121
00:05:39,900 --> 00:05:43,950
uh immigration for example

122
00:05:43,950 --> 00:05:44,160
[Music]

123
00:05:44,160 --> 00:05:45,180
um

124
00:05:45,180 --> 00:05:47,699
the U.N volunteers U.N government I mean

125
00:05:47,699 --> 00:05:49,560
many many many of different kind of

126
00:05:49,560 --> 00:05:52,680
organizations I started yes you I joined

127
00:05:52,680 --> 00:05:55,680
at the beginning of this year

128
00:05:55,680 --> 00:05:59,039
and I'm not used just to know all of the

129
00:05:59,039 --> 00:06:00,660
all of the name of the different

130
00:06:00,660 --> 00:06:02,460
organization it's a little bit

131
00:06:02,460 --> 00:06:04,380
complicated to to be just to remember

132
00:06:04,380 --> 00:06:07,199
all of them just to show you

133
00:06:07,199 --> 00:06:07,919
um

134
00:06:07,919 --> 00:06:12,180
very brief a map where our customers or

135
00:06:12,180 --> 00:06:14,400
our the audiences or organization that

136
00:06:14,400 --> 00:06:17,580
we help are around the world we

137
00:06:17,580 --> 00:06:20,660
represent most of the of the countries

138
00:06:20,660 --> 00:06:23,759
and we are physically in Geneva

139
00:06:23,759 --> 00:06:26,280
Switzerland Valencia Spain Rome and

140
00:06:26,280 --> 00:06:30,960
rudisi in Italy and New York USA

141
00:06:30,960 --> 00:06:34,620
so there's some really small highlights

142
00:06:34,620 --> 00:06:38,100
about where what exactly we are doing in

143
00:06:38,100 --> 00:06:40,080
cyber security just to help this kind of

144
00:06:40,080 --> 00:06:43,259
organization that we have seen two

145
00:06:43,259 --> 00:06:46,259
slides before so we have the the common

146
00:06:46,259 --> 00:06:47,819
secure service

147
00:06:47,819 --> 00:06:50,400
that mainly we are providing threat

148
00:06:50,400 --> 00:06:52,860
intelligence for the the overall

149
00:06:52,860 --> 00:06:55,259
audiences well not the overall some of

150
00:06:55,259 --> 00:06:58,100
the some of the audiences

151
00:06:58,100 --> 00:07:03,000
we have a shock 24 7 monitoring and

152
00:07:03,000 --> 00:07:04,860
providing some information as well to

153
00:07:04,860 --> 00:07:08,280
all of this kind of um organizations

154
00:07:08,280 --> 00:07:10,919
and we adapt to the technologies that

155
00:07:10,919 --> 00:07:13,220
they that our partner or our customer

156
00:07:13,220 --> 00:07:15,660
just need to deal with it

157
00:07:15,660 --> 00:07:18,360
uh for sure it's a common sock so most

158
00:07:18,360 --> 00:07:20,699
of us probably we are using the same

159
00:07:20,699 --> 00:07:22,319
technology in the in the system but we

160
00:07:22,319 --> 00:07:24,360
can adapt just new technologies as well

161
00:07:24,360 --> 00:07:27,960
to the Technologies of the every client

162
00:07:27,960 --> 00:07:29,639
and there is a

163
00:07:29,639 --> 00:07:32,940
really gross integration between the

164
00:07:32,940 --> 00:07:35,280
people working from the shock

165
00:07:35,280 --> 00:07:38,099
and the incident response team that is

166
00:07:38,099 --> 00:07:42,720
composed by the fears as well for some

167
00:07:42,720 --> 00:07:45,180
good reversal we have one of the

168
00:07:45,180 --> 00:07:48,419
reversal from Malwarebytes uh we have

169
00:07:48,419 --> 00:07:50,580
some sun instructor so we have really

170
00:07:50,580 --> 00:07:52,500
really good people technical people just

171
00:07:52,500 --> 00:07:54,360
there just to analyze the different

172
00:07:54,360 --> 00:07:56,280
incidents like this one the languages

173
00:07:56,280 --> 00:07:58,319
you talk about

174
00:07:58,319 --> 00:08:00,900
and as well we have an offensive unit

175
00:08:00,900 --> 00:08:04,259
uh that's my my power that I'm I'm happy

176
00:08:04,259 --> 00:08:06,300
to work

177
00:08:06,300 --> 00:08:09,479
um we just do some red teaming and Pen

178
00:08:09,479 --> 00:08:12,240
testing property teaming

179
00:08:12,240 --> 00:08:14,520
um in different kind of infrastructure

180
00:08:14,520 --> 00:08:16,979
with different Technologies uh Network

181
00:08:16,979 --> 00:08:19,919
like inside a web

182
00:08:19,919 --> 00:08:23,180
um so we can just adapt if it's remote

183
00:08:23,180 --> 00:08:25,759
if it can be I mean the paint is

184
00:08:25,759 --> 00:08:29,220
completely on site if it's a Blackberry

185
00:08:29,220 --> 00:08:31,440
white box so it depends on the

186
00:08:31,440 --> 00:08:33,360
requirements of every project mainly but

187
00:08:33,360 --> 00:08:35,640
we have like a 360

188
00:08:35,640 --> 00:08:37,500
um vision

189
00:08:37,500 --> 00:08:40,020
well this is like a commercial sentence

190
00:08:40,020 --> 00:08:43,260
but I mean everything is completely

191
00:08:43,260 --> 00:08:44,700
joined

192
00:08:44,700 --> 00:08:48,180
we have like different units but all of

193
00:08:48,180 --> 00:08:50,339
us I don't care if they are part of the

194
00:08:50,339 --> 00:08:52,560
blue team or we are part of the red team

195
00:08:52,560 --> 00:08:56,279
we need just reward together if not I

196
00:08:56,279 --> 00:08:58,140
mean we are in the same direction at the

197
00:08:58,140 --> 00:09:02,040
end so I I see the work like like that

198
00:09:02,040 --> 00:09:06,180
so but let's go for just you to dig a

199
00:09:06,180 --> 00:09:08,459
little bit into the incident related one

200
00:09:08,459 --> 00:09:10,620
of the incidents because we have a lot

201
00:09:10,620 --> 00:09:13,620
as probably most of you in in the

202
00:09:13,620 --> 00:09:15,660
organization but I I would love to

203
00:09:15,660 --> 00:09:18,240
assume to ask you first

204
00:09:18,240 --> 00:09:20,399
another question

205
00:09:20,399 --> 00:09:23,760
how many of you have been involved

206
00:09:23,760 --> 00:09:26,700
in an incident of your I mean solving an

207
00:09:26,700 --> 00:09:28,680
incident in your organization company

208
00:09:28,680 --> 00:09:32,359
now or in the past

209
00:09:33,120 --> 00:09:34,560
well

210
00:09:34,560 --> 00:09:37,740
probably most of you

211
00:09:37,740 --> 00:09:40,800
who can tell me that you are completely

212
00:09:40,800 --> 00:09:43,220
sure

213
00:09:43,220 --> 00:09:46,920
that you have all the details and you

214
00:09:46,920 --> 00:09:48,420
have remediate

215
00:09:48,420 --> 00:09:50,580
and you have mitigate

216
00:09:50,580 --> 00:09:53,519
everything on all servers and all hosts

217
00:09:53,519 --> 00:09:54,899
on

218
00:09:54,899 --> 00:09:57,420
connected devices

219
00:09:57,420 --> 00:09:58,440
yeah

220
00:09:58,440 --> 00:10:01,700
okay probably I have a contract to you

221
00:10:01,700 --> 00:10:04,150
see you on uh

222
00:10:04,150 --> 00:10:05,459
[Music]

223
00:10:05,459 --> 00:10:08,040
okay okay I mean it's it's quite

224
00:10:08,040 --> 00:10:09,959
difficult right

225
00:10:09,959 --> 00:10:11,459
yeah

226
00:10:11,459 --> 00:10:15,899
correct so you never know

227
00:10:15,899 --> 00:10:18,480
if the traductor is still on your

228
00:10:18,480 --> 00:10:19,620
systems

229
00:10:19,620 --> 00:10:23,399
or you have all the evidences from the

230
00:10:23,399 --> 00:10:25,140
past

231
00:10:25,140 --> 00:10:28,680
um just to identify all of the iocs and

232
00:10:28,680 --> 00:10:30,779
all the activity that it's running on

233
00:10:30,779 --> 00:10:33,060
the different servers and so on right

234
00:10:33,060 --> 00:10:35,880
so always it's quite quite complicated

235
00:10:35,880 --> 00:10:37,980
so just for that reason

236
00:10:37,980 --> 00:10:40,320
uh I call this presentation The

237
00:10:40,320 --> 00:10:43,080
Neverending Story because it's a like an

238
00:10:43,080 --> 00:10:45,000
infinite Loop

239
00:10:45,000 --> 00:10:47,899
so let's rock

240
00:10:48,120 --> 00:10:49,680
well

241
00:10:49,680 --> 00:10:52,320
um one year ago almost

242
00:10:52,320 --> 00:10:56,760
on 20 October 2021

243
00:10:56,760 --> 00:10:57,839
um

244
00:10:57,839 --> 00:11:01,620
an organization just was notified that

245
00:11:01,620 --> 00:11:04,620
four servers were compromised and just

246
00:11:04,620 --> 00:11:06,060
the day after

247
00:11:06,060 --> 00:11:10,200
uh we were activated our incident

248
00:11:10,200 --> 00:11:13,079
response team were activated just to

249
00:11:13,079 --> 00:11:16,380
help support analyze everything related

250
00:11:16,380 --> 00:11:19,440
to this incident well at the very

251
00:11:19,440 --> 00:11:21,899
beginning is yes okay just four servers

252
00:11:21,899 --> 00:11:26,579
but exactly which ones you know

253
00:11:26,579 --> 00:11:30,839
I need to assume give like a warning

254
00:11:30,839 --> 00:11:32,220
about this talk

255
00:11:32,220 --> 00:11:35,100
because unfortunately I cannot talk

256
00:11:35,100 --> 00:11:38,339
about any threat actor I will say

257
00:11:38,339 --> 00:11:41,220
attackers cyber criminals I will say

258
00:11:41,220 --> 00:11:43,320
traductor in general

259
00:11:43,320 --> 00:11:44,839
but

260
00:11:44,839 --> 00:11:47,940
in United Nations we representing most

261
00:11:47,940 --> 00:11:50,040
of the countries around the world

262
00:11:50,040 --> 00:11:52,800
so we cannot say that okay this country

263
00:11:52,800 --> 00:11:55,339
it's attacking this country

264
00:11:55,339 --> 00:11:58,500
for obvious reasons I said you probably

265
00:11:58,500 --> 00:12:00,899
know if you know how to read between

266
00:12:00,899 --> 00:12:02,220
lines

267
00:12:02,220 --> 00:12:03,779
so

268
00:12:03,779 --> 00:12:05,820
um I'm really sorry but I will call

269
00:12:05,820 --> 00:12:07,860
thread actor in general okay or

270
00:12:07,860 --> 00:12:10,620
attackers or whoever

271
00:12:10,620 --> 00:12:14,820
so the day after uh we were activated

272
00:12:14,820 --> 00:12:18,240
and we face this incident at the very

273
00:12:18,240 --> 00:12:20,040
beginning

274
00:12:20,040 --> 00:12:22,800
um into different phases but at the same

275
00:12:22,800 --> 00:12:25,200
time simultaneously

276
00:12:25,200 --> 00:12:27,360
first one the backward investigation

277
00:12:27,360 --> 00:12:31,200
phase just to identify uh all of the

278
00:12:31,200 --> 00:12:34,320
ttps the tactics techniques and

279
00:12:34,320 --> 00:12:36,720
procedures related to the to the

280
00:12:36,720 --> 00:12:38,579
incident that's that makes sense right

281
00:12:38,579 --> 00:12:40,920
just to create the the threat

282
00:12:40,920 --> 00:12:42,839
intelligence related to this incident

283
00:12:42,839 --> 00:12:46,079
and if it has any

284
00:12:46,079 --> 00:12:49,079
um relation or any join with any

285
00:12:49,079 --> 00:12:51,300
incident in the past

286
00:12:51,300 --> 00:12:52,860
and as well at the same time they

287
00:12:52,860 --> 00:12:54,839
contain maintenance response phase just

288
00:12:54,839 --> 00:12:57,720
to monitor everything that was happening

289
00:12:57,720 --> 00:13:00,480
just to correlate probably with future

290
00:13:00,480 --> 00:13:02,160
events

291
00:13:02,160 --> 00:13:06,240
or just you to identify more potential

292
00:13:06,240 --> 00:13:09,300
attacks related or involved the Korean

293
00:13:09,300 --> 00:13:09,820
incident

294
00:13:09,820 --> 00:13:11,279
[Music]

295
00:13:11,279 --> 00:13:12,600
so

296
00:13:12,600 --> 00:13:16,500
um just identifying uh analyzing this

297
00:13:16,500 --> 00:13:18,620
ttp's different tdps

298
00:13:18,620 --> 00:13:22,079
we just realized that it wasn't just

299
00:13:22,079 --> 00:13:23,760
four servers

300
00:13:23,760 --> 00:13:27,600
it was related to 24 horse compromises

301
00:13:27,600 --> 00:13:30,959
at the very beginning who knows later

302
00:13:30,959 --> 00:13:32,399
so

303
00:13:32,399 --> 00:13:33,360
um

304
00:13:33,360 --> 00:13:37,320
the the window of the attacks on 2021

305
00:13:37,320 --> 00:13:40,380
was just one week

306
00:13:40,380 --> 00:13:46,560
from uh 18th of October to 25 of October

307
00:13:46,560 --> 00:13:48,480
as a red teamer

308
00:13:48,480 --> 00:13:51,060
I see that come on it's a really really

309
00:13:51,060 --> 00:13:54,000
small window or time you know usually

310
00:13:54,000 --> 00:13:55,740
the the attacks

311
00:13:55,740 --> 00:13:59,760
are not related to to apts

312
00:13:59,760 --> 00:14:01,380
we are talking about

313
00:14:01,380 --> 00:14:03,839
not only one week probably a lot of

314
00:14:03,839 --> 00:14:06,240
weeks months or

315
00:14:06,240 --> 00:14:09,920
years who knows

316
00:14:10,620 --> 00:14:13,380
um but during the the investigation we

317
00:14:13,380 --> 00:14:14,579
realize

318
00:14:14,579 --> 00:14:17,639
that the same traductor started to

319
00:14:17,639 --> 00:14:21,200
attack and to Target our systems

320
00:14:21,200 --> 00:14:24,720
one year a half before from 28th of

321
00:14:24,720 --> 00:14:27,000
April and 2020.

322
00:14:27,000 --> 00:14:30,120
and we see some connections and some the

323
00:14:30,120 --> 00:14:32,459
same kind of actions over the the

324
00:14:32,459 --> 00:14:35,700
systems so but we don't know exactly if

325
00:14:35,700 --> 00:14:38,519
it's completely link it

326
00:14:38,519 --> 00:14:41,399
the attacks that were done

327
00:14:41,399 --> 00:14:42,899
on 2020

328
00:14:42,899 --> 00:14:47,040
and on 2021 and who knows right now

329
00:14:47,040 --> 00:14:49,199
so the three doctor in the past in 2020

330
00:14:49,199 --> 00:14:50,660
they try to

331
00:14:50,660 --> 00:14:53,880
explore open collect

332
00:14:53,880 --> 00:14:56,639
a lot of files

333
00:14:56,639 --> 00:14:59,699
that contains sensible data

334
00:14:59,699 --> 00:15:02,160
when we say sensible data it's quite

335
00:15:02,160 --> 00:15:04,139
important because if you remember I'm

336
00:15:04,139 --> 00:15:07,100
not I'm not saying that this is the case

337
00:15:07,100 --> 00:15:09,720
of the refugees for example I'm just

338
00:15:09,720 --> 00:15:13,019
giving just an example stupid example

339
00:15:13,019 --> 00:15:15,620
but just to let you know the the

340
00:15:15,620 --> 00:15:18,779
importance of the information that it's

341
00:15:18,779 --> 00:15:21,000
contained in some files for example just

342
00:15:21,000 --> 00:15:23,699
try to imagine that this agency or this

343
00:15:23,699 --> 00:15:27,000
organization is related to refugees and

344
00:15:27,000 --> 00:15:28,440
it's uh

345
00:15:28,440 --> 00:15:32,399
um for example for a for a mission in a

346
00:15:32,399 --> 00:15:35,519
specific Zone some people were deployed

347
00:15:35,519 --> 00:15:37,380
just there and they need just to

348
00:15:37,380 --> 00:15:39,600
reconnect it and they just need to

349
00:15:39,600 --> 00:15:42,180
receive instructions what happened in

350
00:15:42,180 --> 00:15:44,880
some of these documents are completely

351
00:15:44,880 --> 00:15:47,820
changed just giving a different

352
00:15:47,820 --> 00:15:50,579
um instructions so can you imagine what

353
00:15:50,579 --> 00:15:51,899
can happen

354
00:15:51,899 --> 00:15:55,860
if an attack on our service uh

355
00:15:55,860 --> 00:15:58,920
uh are completely related to emission of

356
00:15:58,920 --> 00:16:00,899
refugees or something like that I mean

357
00:16:00,899 --> 00:16:03,460
it can be crucial right

358
00:16:03,460 --> 00:16:05,519
[Music]

359
00:16:05,519 --> 00:16:09,480
but on 2020 one

360
00:16:09,480 --> 00:16:12,300
um the traductor just went directly to

361
00:16:12,300 --> 00:16:14,880
the file server so that's one of the

362
00:16:14,880 --> 00:16:17,399
points that I see come on they they were

363
00:16:17,399 --> 00:16:19,980
just there before because just go

364
00:16:19,980 --> 00:16:22,019
directly to the file server just just

365
00:16:22,019 --> 00:16:25,320
with that clue we just step back back

366
00:16:25,320 --> 00:16:28,440
back and we realized that they were

367
00:16:28,440 --> 00:16:30,899
there from 2020.

368
00:16:30,899 --> 00:16:33,060
they tried just to collect some files

369
00:16:33,060 --> 00:16:35,699
from the um

370
00:16:35,699 --> 00:16:39,540
10 days ago until now I mean in 2021

371
00:16:39,540 --> 00:16:40,620
but

372
00:16:40,620 --> 00:16:43,380
they try just you to open and yes you

373
00:16:43,380 --> 00:16:45,600
see the information contain it in that

374
00:16:45,600 --> 00:16:47,779
in those kind of file but it was

375
00:16:47,779 --> 00:16:50,880
encrypted with a really strong password

376
00:16:50,880 --> 00:16:53,399
so they couldn't see anything

377
00:16:53,399 --> 00:16:54,260
cool

378
00:16:54,260 --> 00:16:56,519
[Music]

379
00:16:56,519 --> 00:16:57,720
um

380
00:16:57,720 --> 00:16:58,880
so

381
00:16:58,880 --> 00:17:01,680
remarks just at the very beginning about

382
00:17:01,680 --> 00:17:04,380
this it's like the question that I that

383
00:17:04,380 --> 00:17:05,699
I asked you

384
00:17:05,699 --> 00:17:10,619
before it's like okay we have some Clues

385
00:17:10,619 --> 00:17:13,559
we have a lot of evidences because

386
00:17:13,559 --> 00:17:16,079
we were recollecting

387
00:17:16,079 --> 00:17:19,859
one gigabyte of data per day and in some

388
00:17:19,859 --> 00:17:23,579
cases up to 20 Gigabytes per day

389
00:17:23,579 --> 00:17:26,099
so it's really greasy I mean the the

390
00:17:26,099 --> 00:17:29,940
amount of um of data that we we had to

391
00:17:29,940 --> 00:17:32,520
to analyze during this incident

392
00:17:32,520 --> 00:17:34,080
but

393
00:17:34,080 --> 00:17:34,860
um

394
00:17:34,860 --> 00:17:36,679
you never know

395
00:17:36,679 --> 00:17:40,679
if you are missing something and if you

396
00:17:40,679 --> 00:17:43,080
have missed something like uh the the

397
00:17:43,080 --> 00:17:45,600
previous or the the the first attack

398
00:17:45,600 --> 00:17:48,360
Vector you know

399
00:17:48,360 --> 00:17:51,960
I hate meetings sorry I hate doing

400
00:17:51,960 --> 00:17:54,780
reports sorry as well I'm more focused

401
00:17:54,780 --> 00:17:56,880
on the technical part I know that they

402
00:17:56,880 --> 00:18:00,120
are so important but at this point

403
00:18:00,120 --> 00:18:03,600
they were I mean they were crucial the

404
00:18:03,600 --> 00:18:07,140
meetings a daily briefing we don't need

405
00:18:07,140 --> 00:18:10,020
to talk about ours

406
00:18:10,020 --> 00:18:11,940
we just need just to go directly to the

407
00:18:11,940 --> 00:18:13,860
information just to have the key people

408
00:18:13,860 --> 00:18:16,440
in that kind of meetings

409
00:18:16,440 --> 00:18:18,480
um just you to

410
00:18:18,480 --> 00:18:20,340
to explain

411
00:18:20,340 --> 00:18:22,440
what is the point that we are

412
00:18:22,440 --> 00:18:24,740
and as well just giving some

413
00:18:24,740 --> 00:18:27,740
explanation about the the the

414
00:18:27,740 --> 00:18:30,240
analysis that we have done the day

415
00:18:30,240 --> 00:18:32,400
before and where exactly that we are

416
00:18:32,400 --> 00:18:35,160
going to do during today

417
00:18:35,160 --> 00:18:37,980
so um

418
00:18:37,980 --> 00:18:42,000
really really brief daily briefings but

419
00:18:42,000 --> 00:18:44,460
they are quite important

420
00:18:44,460 --> 00:18:47,820
so let's go uh to the timeline

421
00:18:47,820 --> 00:18:50,820
uh timeline if there is any forensic

422
00:18:50,820 --> 00:18:52,080
here

423
00:18:52,080 --> 00:18:53,940
recently

424
00:18:53,940 --> 00:18:57,360
forensic analyze it here

425
00:18:57,360 --> 00:19:01,020
no well the timeline is

426
00:19:01,020 --> 00:19:04,320
um is the key in the resolution of an

427
00:19:04,320 --> 00:19:05,940
incident you know

428
00:19:05,940 --> 00:19:09,360
so just to establish what happened when

429
00:19:09,360 --> 00:19:10,559
where

430
00:19:10,559 --> 00:19:12,419
so if we established from the very

431
00:19:12,419 --> 00:19:17,160
beginning of on 18th sorry yes on 18th

432
00:19:17,160 --> 00:19:21,000
of October we realized that for another

433
00:19:21,000 --> 00:19:24,080
remote system they just try to access

434
00:19:24,080 --> 00:19:27,120
the domain controller come on just the

435
00:19:27,120 --> 00:19:30,539
the the first attack Victory is just you

436
00:19:30,539 --> 00:19:33,240
try to to get the the main controller

437
00:19:33,240 --> 00:19:36,720
it's really crazy right because yes they

438
00:19:36,720 --> 00:19:39,480
were just there on the network from

439
00:19:39,480 --> 00:19:40,500
before

440
00:19:40,500 --> 00:19:43,140
so they just write here just to use well

441
00:19:43,140 --> 00:19:47,160
they try no they use the TGT so the

442
00:19:47,160 --> 00:19:49,679
ticket granted ticket

443
00:19:49,679 --> 00:19:51,780
um that it's probably you already know

444
00:19:51,780 --> 00:19:52,980
but it's um

445
00:19:52,980 --> 00:19:55,740
and a user authentication token that is

446
00:19:55,740 --> 00:19:58,860
requested to the to the ticket granting

447
00:19:58,860 --> 00:20:01,740
service in order just to get access and

448
00:20:01,740 --> 00:20:04,740
to join the domain so they try it from

449
00:20:04,740 --> 00:20:06,539
the very beginning from that remote host

450
00:20:06,539 --> 00:20:09,200
just to join the domain one of our

451
00:20:09,200 --> 00:20:14,039
domains right so they just went to the

452
00:20:14,039 --> 00:20:17,120
to the game

453
00:20:17,700 --> 00:20:21,000
um just after that they just use some

454
00:20:21,000 --> 00:20:22,620
Powershell scripts just to do some

455
00:20:22,620 --> 00:20:25,980
lateral movements through uh win on a

456
00:20:25,980 --> 00:20:27,780
win RM

457
00:20:27,780 --> 00:20:30,840
and just after that they try just to set

458
00:20:30,840 --> 00:20:33,240
up command and control

459
00:20:33,240 --> 00:20:37,620
of cobalty strike but the that's very

460
00:20:37,620 --> 00:20:38,880
funny

461
00:20:38,880 --> 00:20:41,460
but the the antivirus because just

462
00:20:41,460 --> 00:20:44,340
detect it and it wasn't allowed how many

463
00:20:44,340 --> 00:20:48,020
of you know what is Cobalt

464
00:20:48,600 --> 00:20:51,000
cool I mean I see more people just

465
00:20:51,000 --> 00:20:53,160
around there

466
00:20:53,160 --> 00:20:55,440
um just for those

467
00:20:55,440 --> 00:20:57,539
um who doesn't know what is Koval

468
00:20:57,539 --> 00:20:59,360
I really love it

469
00:20:59,360 --> 00:21:02,460
a spread simmer

470
00:21:02,460 --> 00:21:05,220
um Koval it's a framework common and

471
00:21:05,220 --> 00:21:07,500
controller that can be used in the

472
00:21:07,500 --> 00:21:10,280
create team activities it's quietly used

473
00:21:10,280 --> 00:21:13,679
in governments and in some countries

474
00:21:13,679 --> 00:21:15,860
uh in the offensive bar

475
00:21:15,860 --> 00:21:18,480
and it's quite quite nice because yes

476
00:21:18,480 --> 00:21:19,799
you can just set up like different

477
00:21:19,799 --> 00:21:22,860
servers just to do many different things

478
00:21:22,860 --> 00:21:25,860
and you can just customize everything

479
00:21:25,860 --> 00:21:28,020
with your own scripts with Cortana

480
00:21:28,020 --> 00:21:31,799
scripts so you can just join as well uh

481
00:21:31,799 --> 00:21:33,539
different Frameworks different common

482
00:21:33,539 --> 00:21:35,580
controls and just to create your own

483
00:21:35,580 --> 00:21:38,820
binary sophisticated blah blah blah uh

484
00:21:38,820 --> 00:21:42,900
setup listener in in Koval and you can

485
00:21:42,900 --> 00:21:44,940
just start using the different Bitcoins

486
00:21:44,940 --> 00:21:46,860
you know

487
00:21:46,860 --> 00:21:50,220
um it's quite quite nice I recommend you

488
00:21:50,220 --> 00:21:53,159
just you use at least the trial just you

489
00:21:53,159 --> 00:21:55,799
test it and see what kind I mean how

490
00:21:55,799 --> 00:21:59,280
powerful it can be I really love Cobalt

491
00:21:59,280 --> 00:22:03,720
and I knew Rafi the developer of this

492
00:22:03,720 --> 00:22:06,720
tool of this framework and he's a very

493
00:22:06,720 --> 00:22:08,820
nice guy that he's working a lot every

494
00:22:08,820 --> 00:22:12,539
day just to improve uh that will

495
00:22:12,539 --> 00:22:15,299
um time by time I have to tell you that

496
00:22:15,299 --> 00:22:17,640
it's not free tool

497
00:22:17,640 --> 00:22:22,320
it costs a lot if I remember well 350

498
00:22:22,320 --> 00:22:26,100
500 dollars American dollars

499
00:22:26,100 --> 00:22:28,980
per server sober license

500
00:22:28,980 --> 00:22:32,520
uh you can just look for that on the

501
00:22:32,520 --> 00:22:34,380
dark web or whatever

502
00:22:34,380 --> 00:22:38,880
all of them came with a surprise so good

503
00:22:38,880 --> 00:22:41,039
luck

504
00:22:41,039 --> 00:22:43,080
always trust me

505
00:22:43,080 --> 00:22:45,240
but anyway we we can just continue with

506
00:22:45,240 --> 00:22:46,740
the incident

507
00:22:46,740 --> 00:22:50,419
just some minutes after

508
00:22:50,419 --> 00:22:53,480
the trade actor just creates

509
00:22:53,480 --> 00:22:56,059
a binary

510
00:22:56,059 --> 00:22:58,919
unexecute title I don't know how many of

511
00:22:58,919 --> 00:23:02,340
you know what is chaiso

512
00:23:02,340 --> 00:23:04,260
cool

513
00:23:04,260 --> 00:23:09,059
so it's a it contains a socks proxy a

514
00:23:09,059 --> 00:23:11,340
four and five

515
00:23:11,340 --> 00:23:13,460
um

516
00:23:13,460 --> 00:23:15,140
forward

517
00:23:15,140 --> 00:23:18,900
some packets from one chord to the other

518
00:23:18,900 --> 00:23:22,020
and this is used commonly used in the

519
00:23:22,020 --> 00:23:24,840
red team or inoffensive operations uh

520
00:23:24,840 --> 00:23:27,480
just to set up a pivot to do lateral

521
00:23:27,480 --> 00:23:30,059
movements or people to another part of

522
00:23:30,059 --> 00:23:33,080
the network right

523
00:23:33,160 --> 00:23:35,419
[Music]

524
00:23:35,419 --> 00:23:38,400
the following actions are related yes

525
00:23:38,400 --> 00:23:41,880
you set up that pivot

526
00:23:41,880 --> 00:23:44,340
um I mean the the end report the exit

527
00:23:44,340 --> 00:23:45,840
Port

528
00:23:45,840 --> 00:23:50,460
um and yes you configure as as follows

529
00:23:50,460 --> 00:23:53,880
so from the DC that they were I mean

530
00:23:53,880 --> 00:23:55,559
that they compromise

531
00:23:55,559 --> 00:23:58,080
they wanted just to go and just to do

532
00:23:58,080 --> 00:24:01,440
some lateral movements uh inside the

533
00:24:01,440 --> 00:24:04,200
network so they went directly to the

534
00:24:04,200 --> 00:24:05,960
Usos W

535
00:24:05,960 --> 00:24:09,179
shoes that it's a quite common I mean

536
00:24:09,179 --> 00:24:11,700
it's already known for both of you right

537
00:24:11,700 --> 00:24:15,419
it's just to update all of the servers

538
00:24:15,419 --> 00:24:18,539
and hosts related to Windows

539
00:24:18,539 --> 00:24:20,880
so they just do lateral movement throw

540
00:24:20,880 --> 00:24:26,600
or 135 and they use yesu as well 138 35

541
00:24:26,600 --> 00:24:29,820
139 and 445

542
00:24:29,820 --> 00:24:33,000
just to do some recognition through the

543
00:24:33,000 --> 00:24:35,039
network so just thinking about that

544
00:24:35,039 --> 00:24:36,900
attacker

545
00:24:36,900 --> 00:24:39,600
you need to be completely stealthy

546
00:24:39,600 --> 00:24:42,600
if you get one server and you need just

547
00:24:42,600 --> 00:24:45,600
to do the reconnect sense uh phase just

548
00:24:45,600 --> 00:24:47,280
you see

549
00:24:47,280 --> 00:24:49,679
how many servers or holes or in general

550
00:24:49,679 --> 00:24:52,679
are in that segment right so it's not

551
00:24:52,679 --> 00:24:55,140
just you use a map with the top 100

552
00:24:55,140 --> 00:24:59,100
reports or all the ports that's I mean

553
00:24:59,100 --> 00:25:02,059
it's foreign

554
00:25:02,600 --> 00:25:04,620
ERS kill you

555
00:25:04,620 --> 00:25:06,900
so this case is exactly the same

556
00:25:06,900 --> 00:25:09,500
I can't recognize exactly the same

557
00:25:09,500 --> 00:25:12,840
ways just to do everything you need to

558
00:25:12,840 --> 00:25:16,500
be always stealthy so at this time they

559
00:25:16,500 --> 00:25:18,480
just do their recording scenes through

560
00:25:18,480 --> 00:25:21,539
main mainly three ports

561
00:25:21,539 --> 00:25:25,860
and just with that they could do a throw

562
00:25:25,860 --> 00:25:28,380
a power cell while liner just your pivot

563
00:25:28,380 --> 00:25:30,240
and just to do the lateral movements to

564
00:25:30,240 --> 00:25:33,320
the to the Usos

565
00:25:34,140 --> 00:25:37,620
um and as well from from that server

566
00:25:37,620 --> 00:25:41,900
they download some common and controls

567
00:25:41,900 --> 00:25:45,120
they just execute some malicious Powers

568
00:25:45,120 --> 00:25:47,580
all scripts uh

569
00:25:47,580 --> 00:25:49,980
um that it was a store in the in the

570
00:25:49,980 --> 00:25:52,620
databases in the database sorry

571
00:25:52,620 --> 00:25:55,200
and from the versus they just went back

572
00:25:55,200 --> 00:25:59,340
to the domain controller uh why just you

573
00:25:59,340 --> 00:26:01,980
set up for first time one of the common

574
00:26:01,980 --> 00:26:04,080
uh common and controls that they are

575
00:26:04,080 --> 00:26:06,600
going just to use

576
00:26:06,600 --> 00:26:10,080
so whenever the the common control Wars

577
00:26:10,080 --> 00:26:12,539
install it completely on the system on

578
00:26:12,539 --> 00:26:16,320
the DC and on the buses it was

579
00:26:16,320 --> 00:26:18,840
throw we are going just to analyze later

580
00:26:18,840 --> 00:26:21,419
I did both more in detail

581
00:26:21,419 --> 00:26:25,620
uh program data that Ln key and for sure

582
00:26:25,620 --> 00:26:29,700
that it's pointing to a scheduled task

583
00:26:29,700 --> 00:26:32,760
that it called Windows updates

584
00:26:32,760 --> 00:26:34,980
how many of you I mean how many of you

585
00:26:34,980 --> 00:26:37,200
have been involved in any offensive

586
00:26:37,200 --> 00:26:39,299
operations

587
00:26:39,299 --> 00:26:40,380
okay

588
00:26:40,380 --> 00:26:42,840
do you use yes you call services or

589
00:26:42,840 --> 00:26:45,380
schedule tasks like

590
00:26:45,380 --> 00:26:49,919
this is malware not right just tell me

591
00:26:49,919 --> 00:26:52,279
one name

592
00:26:54,240 --> 00:26:57,720
I used to use Windows updates come on

593
00:26:57,720 --> 00:27:00,360
in The Blue Team Jesse Windows update no

594
00:27:00,360 --> 00:27:03,120
no no this is not fake this is quite

595
00:27:03,120 --> 00:27:05,100
real right we need just to maintain

596
00:27:05,100 --> 00:27:07,799
because come on we need to patch so

597
00:27:07,799 --> 00:27:11,039
that's a really tricky trick

598
00:27:11,039 --> 00:27:13,980
that it's commonly used and as well in

599
00:27:13,980 --> 00:27:17,580
real incidents as you can just see here

600
00:27:17,580 --> 00:27:19,020
so

601
00:27:19,020 --> 00:27:20,640
um

602
00:27:20,640 --> 00:27:23,580
and again we can just solve different

603
00:27:23,580 --> 00:27:26,960
kind of pivots not only our

604
00:27:26,960 --> 00:27:30,659
throwing winner M but as well to thieves

605
00:27:30,659 --> 00:27:31,820
and as well

606
00:27:31,820 --> 00:27:36,480
throw a RDP come on RDP it's quite

607
00:27:36,480 --> 00:27:38,220
common it's quite easy yes you get it

608
00:27:38,220 --> 00:27:39,299
right

609
00:27:39,299 --> 00:27:42,960
but I'm I was so so curious because uh

610
00:27:42,960 --> 00:27:45,539
some of the connections were the

611
00:27:45,539 --> 00:27:47,400
duration I mean of the connection were

612
00:27:47,400 --> 00:27:50,340
more than 40 minutes

613
00:27:50,340 --> 00:27:52,380
probably it's because the monitoring

614
00:27:52,380 --> 00:27:57,419
power they didn't do uh well like in the

615
00:27:57,419 --> 00:27:59,640
best way or who knows we are going to

616
00:27:59,640 --> 00:28:02,760
see more in detail

617
00:28:02,760 --> 00:28:07,380
for sure if you see uh the the time

618
00:28:07,380 --> 00:28:09,620
I have been talking about just one hour

619
00:28:09,620 --> 00:28:13,620
and I told you before that the window

620
00:28:13,620 --> 00:28:14,940
attack

621
00:28:14,940 --> 00:28:18,840
was due in one week so this is just an

622
00:28:18,840 --> 00:28:21,720
example just the the starting point but

623
00:28:21,720 --> 00:28:24,720
the the report of this incident it's

624
00:28:24,720 --> 00:28:28,260
well many hundreds of pages so you can

625
00:28:28,260 --> 00:28:30,779
just try to to imagine the rest of them

626
00:28:30,779 --> 00:28:33,720
I don't have any enough time just to

627
00:28:33,720 --> 00:28:36,539
talk about all of the the timeline and

628
00:28:36,539 --> 00:28:39,600
about all of the iocs

629
00:28:39,600 --> 00:28:43,440
but the butter it's always the same

630
00:28:43,440 --> 00:28:46,440
or quite similar I will say

631
00:28:46,440 --> 00:28:49,500
so this is just a small piece

632
00:28:49,500 --> 00:28:52,380
this this is not the whole diagram about

633
00:28:52,380 --> 00:28:54,900
the lateral movements so I don't know

634
00:28:54,900 --> 00:28:56,279
yeah

635
00:28:56,279 --> 00:28:58,980
this was the starting point the remote

636
00:28:58,980 --> 00:29:02,880
host like that try to get access and and

637
00:29:02,880 --> 00:29:05,580
got access to the domain controller

638
00:29:05,580 --> 00:29:10,320
and just after that go to the a w source

639
00:29:10,320 --> 00:29:13,200
and from then I mean yes mainly when

640
00:29:13,200 --> 00:29:15,179
they if you have the domain controller

641
00:29:15,179 --> 00:29:17,460
you have everything right if you have a

642
00:29:17,460 --> 00:29:20,000
golden ticket

643
00:29:22,220 --> 00:29:24,659
as well

644
00:29:24,659 --> 00:29:27,120
so you can just go through the the

645
00:29:27,120 --> 00:29:29,580
overall Network and here it's a small

646
00:29:29,580 --> 00:29:32,100
representation of the of the overall

647
00:29:32,100 --> 00:29:35,840
diagram of lateral movements

648
00:29:35,940 --> 00:29:37,380
so

649
00:29:37,380 --> 00:29:40,380
talking about and remembering I mean you

650
00:29:40,380 --> 00:29:43,080
probably remember that I told you that

651
00:29:43,080 --> 00:29:47,600
24 hosts were completely compromised

652
00:29:49,080 --> 00:29:53,120
um from a routine perspective

653
00:29:53,460 --> 00:29:56,940
what will you do first after get some

654
00:29:56,940 --> 00:29:59,820
foothold into a system

655
00:29:59,820 --> 00:30:02,220
just answer me please I mean it's it's

656
00:30:02,220 --> 00:30:04,679
more than seven there are lots of people

657
00:30:04,679 --> 00:30:06,899
drinking rakia outside and I'm really

658
00:30:06,899 --> 00:30:09,360
happy that you are here but just try to

659
00:30:09,360 --> 00:30:11,279
collaborate between us

660
00:30:11,279 --> 00:30:14,899
yeah yeah it will be nice as well

661
00:30:15,000 --> 00:30:17,659
any idea

662
00:30:17,760 --> 00:30:21,740
yeah that's but for what reason

663
00:30:22,200 --> 00:30:25,799
correct yeah probably I mean

664
00:30:25,799 --> 00:30:28,440
that's my weight he has to act

665
00:30:28,440 --> 00:30:30,899
first get a photo probably to get

666
00:30:30,899 --> 00:30:32,880
persistence or

667
00:30:32,880 --> 00:30:35,220
do some privileged escalation and after

668
00:30:35,220 --> 00:30:37,320
that what is the most important part

669
00:30:37,320 --> 00:30:39,840
persistency

670
00:30:39,840 --> 00:30:42,120
I mean if they reboot the system you are

671
00:30:42,120 --> 00:30:44,399
off you're over

672
00:30:44,399 --> 00:30:48,779
so they install malicious persistency uh

673
00:30:48,779 --> 00:30:51,240
in all over the the servers and horse

674
00:30:51,240 --> 00:30:54,380
that were compromised

675
00:30:54,960 --> 00:30:57,240
um but one tricky part

676
00:30:57,240 --> 00:31:01,020
that we be they know how they how they

677
00:31:01,020 --> 00:31:04,559
did it is that they were using some

678
00:31:04,559 --> 00:31:06,179
domain accounts

679
00:31:06,179 --> 00:31:10,520
but the legit domain accounts

680
00:31:10,799 --> 00:31:13,820
yeah that's that's really scary

681
00:31:13,820 --> 00:31:17,760
and they create a new local admin

682
00:31:17,760 --> 00:31:21,659
accounts just to use some Services I've

683
00:31:21,659 --> 00:31:23,159
used some Services yes you get

684
00:31:23,159 --> 00:31:27,059
persistence or just to install some rods

685
00:31:27,059 --> 00:31:29,880
on remote access tools

686
00:31:29,880 --> 00:31:31,980
I just use send and receive some some

687
00:31:31,980 --> 00:31:38,600
commands like aorus and W and DW agents

688
00:31:38,600 --> 00:31:41,460
as well just to set up the scheduled

689
00:31:41,460 --> 00:31:44,100
tasks of a Windows update and so on so

690
00:31:44,100 --> 00:31:46,200
let's go just to to see

691
00:31:46,200 --> 00:31:49,880
some of the iocs

692
00:31:49,919 --> 00:31:52,919
let me drink a little bit

693
00:31:52,919 --> 00:31:54,419
well I'm not going to tell you always

694
00:31:54,419 --> 00:31:57,720
did probably it's a local

695
00:31:57,720 --> 00:32:00,860
train here

696
00:32:02,820 --> 00:32:04,860
so

697
00:32:04,860 --> 00:32:07,140
um first of all the binary the

698
00:32:07,140 --> 00:32:10,860
executable MSI hub.x

699
00:32:10,860 --> 00:32:12,240
that at the end

700
00:32:12,240 --> 00:32:12,659
[Music]

701
00:32:12,659 --> 00:32:13,860
um

702
00:32:13,860 --> 00:32:17,659
well creates a channel

703
00:32:17,659 --> 00:32:22,140
to download the the command and control

704
00:32:22,140 --> 00:32:26,220
and how can this Winery can just get the

705
00:32:26,220 --> 00:32:28,679
the configuration because all of the

706
00:32:28,679 --> 00:32:30,059
binaries as you created the common

707
00:32:30,059 --> 00:32:32,039
control needs to have some some

708
00:32:32,039 --> 00:32:34,620
configuration just with something that

709
00:32:34,620 --> 00:32:37,740
it was a store in the registry

710
00:32:37,740 --> 00:32:40,980
with the style name this binary just get

711
00:32:40,980 --> 00:32:43,559
the the configuration of the of the

712
00:32:43,559 --> 00:32:46,080
binary and as well

713
00:32:46,080 --> 00:32:49,080
um gets some information related to I

714
00:32:49,080 --> 00:32:51,600
mean from install process into the the

715
00:32:51,600 --> 00:32:56,760
registry uh just to to have some cells

716
00:32:56,760 --> 00:32:58,020
using

717
00:32:58,020 --> 00:32:59,179
um

718
00:32:59,179 --> 00:33:02,220
Power Cell Scripts

719
00:33:02,220 --> 00:33:04,980
the Windows update as well I mean and

720
00:33:04,980 --> 00:33:07,220
again

721
00:33:09,440 --> 00:33:12,779
that's uh just with that you can just

722
00:33:12,779 --> 00:33:16,919
get the program data that Ellen key and

723
00:33:16,919 --> 00:33:20,039
from the program data that lnt that it's

724
00:33:20,039 --> 00:33:24,840
a binary encoded uh just from that

725
00:33:24,840 --> 00:33:27,899
binary you can just decode it

726
00:33:27,899 --> 00:33:31,080
and and they offer skates the script and

727
00:33:31,080 --> 00:33:32,419
you can just get

728
00:33:32,419 --> 00:33:35,760
the the desktop that anywhere in as you

729
00:33:35,760 --> 00:33:39,299
see more in detail and the desktopini is

730
00:33:39,299 --> 00:33:41,940
mainly the the common and control that

731
00:33:41,940 --> 00:33:43,740
they use yes you send and receive some

732
00:33:43,740 --> 00:33:47,600
some commands and some files right

733
00:33:48,360 --> 00:33:50,299
something more

734
00:33:50,299 --> 00:33:55,919
ssa.x some of you know what is SSA

735
00:33:55,919 --> 00:33:57,179
no

736
00:33:57,179 --> 00:33:58,919
cool

737
00:33:58,919 --> 00:34:02,880
it's quite similar to title right

738
00:34:02,880 --> 00:34:05,399
but this case is over TLS

739
00:34:05,399 --> 00:34:06,779
so it's

740
00:34:06,779 --> 00:34:07,620
um

741
00:34:07,620 --> 00:34:11,460
it's a secure socket funneling instead

742
00:34:11,460 --> 00:34:13,679
of tunneling but at the end it's a socks

743
00:34:13,679 --> 00:34:14,639
proxy

744
00:34:14,639 --> 00:34:18,540
uh completely Cipher over TLS Just For

745
00:34:18,540 --> 00:34:19,980
What in

746
00:34:19,980 --> 00:34:20,699
um

747
00:34:20,699 --> 00:34:23,280
uh some data from a portal to the other

748
00:34:23,280 --> 00:34:25,560
one right

749
00:34:25,560 --> 00:34:27,599
but at this time

750
00:34:27,599 --> 00:34:31,918
um they just use a power cell script

751
00:34:31,918 --> 00:34:34,859
that install that binary the executable

752
00:34:34,859 --> 00:34:36,800
into the system

753
00:34:36,800 --> 00:34:40,619
but as you probably know on Windows did

754
00:34:40,619 --> 00:34:42,719
you install a binary without a

755
00:34:42,719 --> 00:34:45,899
certificate you are over right

756
00:34:45,899 --> 00:34:48,659
so they were quite smart because they

757
00:34:48,659 --> 00:34:51,119
just installed some certificates related

758
00:34:51,119 --> 00:34:54,000
to the certification Authority so just

759
00:34:54,000 --> 00:34:57,320
without the binary it's

760
00:34:57,440 --> 00:35:00,480
just you to be used into the system so

761
00:35:00,480 --> 00:35:03,300
that's that's really nice

762
00:35:03,300 --> 00:35:07,080
from the faces a perspective for sure

763
00:35:07,080 --> 00:35:10,020
uh and as well we just could identify

764
00:35:10,020 --> 00:35:13,020
some of the rats the remote that has

765
00:35:13,020 --> 00:35:16,200
tools that were used like aorus or

766
00:35:16,200 --> 00:35:18,599
wagen.x

767
00:35:18,599 --> 00:35:20,700
and as well on the last part you can

768
00:35:20,700 --> 00:35:22,260
just see main.exe

769
00:35:22,260 --> 00:35:24,359
that's probably at the very beginning is

770
00:35:24,359 --> 00:35:27,660
just like quite common but it was

771
00:35:27,660 --> 00:35:31,320
detected by the the antivirus that that

772
00:35:31,320 --> 00:35:33,900
they had like

773
00:35:33,900 --> 00:35:36,359
um like chisel so you already know

774
00:35:36,359 --> 00:35:39,078
thistle right

775
00:35:39,180 --> 00:35:41,640
sorry

776
00:35:41,640 --> 00:35:44,180
who

777
00:35:44,579 --> 00:35:46,079
um

778
00:35:46,079 --> 00:35:49,200
well they delete some of the files

779
00:35:49,200 --> 00:35:52,500
during the the attack campaign yeah just

780
00:35:52,500 --> 00:35:54,800
to try to

781
00:35:54,800 --> 00:35:57,720
avoid giving us some evidences just to

782
00:35:57,720 --> 00:35:59,640
identify them

783
00:35:59,640 --> 00:36:02,099
right

784
00:36:02,099 --> 00:36:04,680
so our related to the Windows update

785
00:36:04,680 --> 00:36:07,380
schedule task

786
00:36:07,380 --> 00:36:12,000
um mainly it's um executes a power cell

787
00:36:12,000 --> 00:36:15,359
script and just with that you can just

788
00:36:15,359 --> 00:36:19,640
get a uh the program data that's

789
00:36:19,640 --> 00:36:22,800
with the obfuscation and the execution

790
00:36:22,800 --> 00:36:25,200
of the file you can just get the desktop

791
00:36:25,200 --> 00:36:29,339
that ini so mainly is yes respond a

792
00:36:29,339 --> 00:36:30,859
powerful

793
00:36:30,859 --> 00:36:34,380
script as system as you can just see

794
00:36:34,380 --> 00:36:36,180
here

795
00:36:36,180 --> 00:36:40,079
so with this kind of schedule task

796
00:36:40,079 --> 00:36:42,540
probably they just do this kind of

797
00:36:42,540 --> 00:36:44,400
actions just to do some privileged

798
00:36:44,400 --> 00:36:47,579
escalation right just to get system

799
00:36:47,579 --> 00:36:50,099
on every server on any horse that they

800
00:36:50,099 --> 00:36:52,260
were compromise

801
00:36:52,260 --> 00:36:56,040
so they they program data that that Ela

802
00:36:56,040 --> 00:36:58,980
sorry Ln key

803
00:36:58,980 --> 00:37:01,020
um

804
00:37:01,020 --> 00:37:04,260
this kind of file was observed in

805
00:37:04,260 --> 00:37:07,560
different parts of a of the rest of the

806
00:37:07,560 --> 00:37:10,260
horse so it's it's like not kind of

807
00:37:10,260 --> 00:37:13,260
randomly but it was like in

808
00:37:13,260 --> 00:37:15,660
um many many many different parts on

809
00:37:15,660 --> 00:37:18,300
every server on any host that we just

810
00:37:18,300 --> 00:37:22,700
analyze so that's pretty good

811
00:37:30,119 --> 00:37:34,079
the script just the open skates uh the

812
00:37:34,079 --> 00:37:36,960
second power power cell that it say the

813
00:37:36,960 --> 00:37:39,480
file desktop that any

814
00:37:39,480 --> 00:37:42,599
and what it does contain well mainly

815
00:37:42,599 --> 00:37:44,640
it's a common control that just send and

816
00:37:44,640 --> 00:37:46,500
receive some command and some files

817
00:37:46,500 --> 00:37:51,599
throw or 443 that's all mainly

818
00:37:51,599 --> 00:37:53,880
the multimedia reports here is scheduled

819
00:37:53,880 --> 00:37:58,380
us it's a skeletal test mostly well it

820
00:37:58,380 --> 00:37:59,880
has some differences from the previous

821
00:37:59,880 --> 00:38:03,180
one but it's quite quite similar so just

822
00:38:03,180 --> 00:38:06,000
execute the powerful script uh after

823
00:38:06,000 --> 00:38:07,200
that

824
00:38:07,200 --> 00:38:09,480
um get the configuration from the from

825
00:38:09,480 --> 00:38:12,180
the registry and they offer skate and

826
00:38:12,180 --> 00:38:17,759
execute another binary that it's.com

827
00:38:18,060 --> 00:38:21,359
so again is just your to get system over

828
00:38:21,359 --> 00:38:24,020
the over the different services and host

829
00:38:24,020 --> 00:38:27,960
and it just spawn a power cell process

830
00:38:27,960 --> 00:38:30,079
um running the script

831
00:38:30,079 --> 00:38:33,240
into the into the registry of the of the

832
00:38:33,240 --> 00:38:35,640
service right

833
00:38:35,640 --> 00:38:38,400
so the register key that is they say the

834
00:38:38,400 --> 00:38:40,260
security health score just the

835
00:38:40,260 --> 00:38:42,359
obfuscates the script

836
00:38:42,359 --> 00:38:46,740
and points to the binary that it's.com

837
00:38:46,740 --> 00:38:49,020
and at the end

838
00:38:49,020 --> 00:38:49,980
um

839
00:38:49,980 --> 00:38:51,180
well

840
00:38:51,180 --> 00:38:54,540
at the end mainly they share they were

841
00:38:54,540 --> 00:38:56,280
restored in different locations but they

842
00:38:56,280 --> 00:39:00,060
serve they exactly the same Global key

843
00:39:00,060 --> 00:39:02,700
and exactly the same user alien and as

844
00:39:02,700 --> 00:39:04,619
you can just see they are just quite

845
00:39:04,619 --> 00:39:08,940
common I mean Mozilla

846
00:39:09,359 --> 00:39:12,900
um Chrome Safari Apple weapit so they

847
00:39:12,900 --> 00:39:15,060
are just targeting

848
00:39:15,060 --> 00:39:17,820
um most of the the common

849
00:39:17,820 --> 00:39:20,880
um web browsers that they are using in

850
00:39:20,880 --> 00:39:23,280
Windows right or in any platform at the

851
00:39:23,280 --> 00:39:25,339
end

852
00:39:25,500 --> 00:39:28,680
and this is uh quite nice the service

853
00:39:28,680 --> 00:39:30,619
that is Ms

854
00:39:30,619 --> 00:39:33,480
hub.x just get the configuration from

855
00:39:33,480 --> 00:39:35,900
the register key

856
00:39:35,900 --> 00:39:38,640
uh mainly it's a portable executive

857
00:39:38,640 --> 00:39:41,940
execution sorry executable it's because

858
00:39:41,940 --> 00:39:44,520
I was just seeing the the guy behind you

859
00:39:44,520 --> 00:39:47,940
that I have 10 minutes more only

860
00:39:47,940 --> 00:39:50,400
um of 32 bytes

861
00:39:50,400 --> 00:39:54,480
that mainly implemented the service just

862
00:39:54,480 --> 00:39:58,020
to get persistence over the over the the

863
00:39:58,020 --> 00:40:00,839
old horse compromise so as you can just

864
00:40:00,839 --> 00:40:04,680
see the.net a classes are https my

865
00:40:04,680 --> 00:40:06,780
service program and sell

866
00:40:06,780 --> 00:40:09,960
so you can just try to imagine what this

867
00:40:09,960 --> 00:40:14,119
this executable is doing over the system

868
00:40:14,119 --> 00:40:16,500
something quite important that I would

869
00:40:16,500 --> 00:40:18,660
love just to remark is that the default

870
00:40:18,660 --> 00:40:21,180
Beacon interval is set up to one hour

871
00:40:21,180 --> 00:40:23,400
and a half

872
00:40:23,400 --> 00:40:25,740
that's quite nice because you need to be

873
00:40:25,740 --> 00:40:27,839
a stealthy you don't need just to

874
00:40:27,839 --> 00:40:30,660
receive the Callback of a beacon just

875
00:40:30,660 --> 00:40:32,820
you receive some commands or whatever

876
00:40:32,820 --> 00:40:35,520
like every minute that's a very

877
00:40:35,520 --> 00:40:39,060
iterative interactive mode

878
00:40:39,060 --> 00:40:41,400
each one I just have one hour and 30

879
00:40:41,400 --> 00:40:45,599
minutes but at this point

880
00:40:45,599 --> 00:40:49,680
as a red teamer I used to use guitar

881
00:40:49,680 --> 00:40:51,900
you know just you try to randomize a

882
00:40:51,900 --> 00:40:53,880
little bit it's not like one hour and 30

883
00:40:53,880 --> 00:40:56,940
minutes always it can be 1 hour and 20

884
00:40:56,940 --> 00:40:59,820
one hour and 35 something like that just

885
00:40:59,820 --> 00:41:02,700
try to avoid the detection by default I

886
00:41:02,700 --> 00:41:04,920
will say in the case of the the blue

887
00:41:04,920 --> 00:41:07,079
teamers right

888
00:41:07,079 --> 00:41:09,060
and the ssf

889
00:41:09,060 --> 00:41:11,400
so probably you already know I explained

890
00:41:11,400 --> 00:41:13,260
before

891
00:41:13,260 --> 00:41:17,579
um at the end it's a Powers script that

892
00:41:17,579 --> 00:41:20,000
just tried to unzip the zip file

893
00:41:20,000 --> 00:41:22,680
containing all of that you can just see

894
00:41:22,680 --> 00:41:24,720
at the at the screen and it's exactly

895
00:41:24,720 --> 00:41:27,060
the same that I explained before so just

896
00:41:27,060 --> 00:41:29,400
the executable

897
00:41:29,400 --> 00:41:32,820
um that is synced by the certification

898
00:41:32,820 --> 00:41:35,940
Authority certificate and that's all

899
00:41:35,940 --> 00:41:38,460
it's it's done just without they can

900
00:41:38,460 --> 00:41:42,300
just use and just to set up some socks

901
00:41:42,300 --> 00:41:46,820
proxy over a socks four and five

902
00:41:48,240 --> 00:41:51,500
well I'm

903
00:41:51,660 --> 00:41:54,420
probably I mean how many of you knows

904
00:41:54,420 --> 00:41:57,140
Mitri attack

905
00:41:57,359 --> 00:42:00,780
cool almost all of you

906
00:42:00,780 --> 00:42:02,640
um I had a pleasure just to collaborate

907
00:42:02,640 --> 00:42:06,119
with Mitre some years ago

908
00:42:06,119 --> 00:42:08,160
um as a red teamer because they really

909
00:42:08,160 --> 00:42:11,820
need yes you try to impersonate or just

910
00:42:11,820 --> 00:42:15,720
you replay some apts we just did

911
00:42:15,720 --> 00:42:17,900
assembly exactly the same

912
00:42:17,900 --> 00:42:22,980
attack vectors as a apt-29 during an

913
00:42:22,980 --> 00:42:25,260
exercise and it was quite not just to

914
00:42:25,260 --> 00:42:26,760
collaborate with them in all the years

915
00:42:26,760 --> 00:42:28,579
you facilitate

916
00:42:28,579 --> 00:42:31,140
this framework for the blue teamers

917
00:42:31,140 --> 00:42:33,740
right so at this incident

918
00:42:33,740 --> 00:42:36,780
we can just see that they

919
00:42:36,780 --> 00:42:39,540
we can just identify tactics like the

920
00:42:39,540 --> 00:42:42,440
initials initial access the execution

921
00:42:42,440 --> 00:42:45,839
persistence privilege escalation defense

922
00:42:45,839 --> 00:42:47,700
evasion they don't have a lot of

923
00:42:47,700 --> 00:42:50,640
defensive engine so they

924
00:42:50,640 --> 00:42:54,720
they didn't need just to use a lot of

925
00:42:54,720 --> 00:42:57,720
techniques just to avoid edrs and so on

926
00:42:57,720 --> 00:42:59,959
right

927
00:43:00,000 --> 00:43:02,339
um credential access just at the very

928
00:43:02,339 --> 00:43:05,280
beginning they use DC sync who knows

929
00:43:05,280 --> 00:43:07,680
what is this is Inc

930
00:43:07,680 --> 00:43:08,760
cool

931
00:43:08,760 --> 00:43:11,880
easiest a technique just try to

932
00:43:11,880 --> 00:43:13,500
impersonate the domain controller with

933
00:43:13,500 --> 00:43:15,720
mimikats for example

934
00:43:15,720 --> 00:43:19,079
uh just without the next step or is

935
00:43:19,079 --> 00:43:21,900
golden ticket right again

936
00:43:21,900 --> 00:43:23,339
yeah

937
00:43:23,339 --> 00:43:26,400
so they they they they use it

938
00:43:26,400 --> 00:43:28,500
the discovery that we have been talking

939
00:43:28,500 --> 00:43:30,660
about and as well lateral movement

940
00:43:30,660 --> 00:43:33,960
collection but the building is filtrate

941
00:43:33,960 --> 00:43:38,119
any file any data

942
00:43:38,700 --> 00:43:41,460
and at the end we couldn't identify as

943
00:43:41,460 --> 00:43:42,839
well the impact

944
00:43:42,839 --> 00:43:45,359
I mean the the technique related to the

945
00:43:45,359 --> 00:43:46,440
impact

946
00:43:46,440 --> 00:43:48,780
because all the servers were up and

947
00:43:48,780 --> 00:43:49,619
running

948
00:43:49,619 --> 00:43:53,280
I mean they I guess they try just to

949
00:43:53,280 --> 00:43:55,440
exfiltrate

950
00:43:55,440 --> 00:43:58,859
or just to do something more but

951
00:43:58,859 --> 00:44:01,619
thanks to to our incident Response Team

952
00:44:01,619 --> 00:44:04,500
probably they just were killed and over

953
00:44:04,500 --> 00:44:06,720
in the overall

954
00:44:06,720 --> 00:44:08,400
um

955
00:44:08,400 --> 00:44:11,579
segment of a well different segments of

956
00:44:11,579 --> 00:44:13,500
the network

957
00:44:13,500 --> 00:44:17,040
so at the end we had to stop the

958
00:44:17,040 --> 00:44:19,800
investigation for many different reasons

959
00:44:19,800 --> 00:44:21,780
that I'm not going just to talk about

960
00:44:21,780 --> 00:44:24,660
but we just gave some recommendations

961
00:44:24,660 --> 00:44:27,359
in the short term a billion term a

962
00:44:27,359 --> 00:44:31,200
long-term and classified by uh if it's

963
00:44:31,200 --> 00:44:33,720
quite important quite risky median or

964
00:44:33,720 --> 00:44:34,500
low

965
00:44:34,500 --> 00:44:37,500
but just talking in general

966
00:44:37,500 --> 00:44:40,920
please yes you do at an asset inventory

967
00:44:40,920 --> 00:44:43,740
how many of you can tell me and can

968
00:44:43,740 --> 00:44:45,180
guarantee

969
00:44:45,180 --> 00:44:48,359
that you have a complete asset inventory

970
00:44:48,359 --> 00:44:51,000
in your organization

971
00:44:51,000 --> 00:44:53,460
nobody right I mean it's almost

972
00:44:53,460 --> 00:44:55,920
completely impossible

973
00:44:55,920 --> 00:44:59,599
but we need just to reinforce this idea

974
00:44:59,599 --> 00:45:01,680
as well

975
00:45:01,680 --> 00:45:04,800
uh inventory of the gpos just try to

976
00:45:04,800 --> 00:45:08,579
identify all of the the gpos on all

977
00:45:08,579 --> 00:45:12,000
servers on all the main controllers just

978
00:45:12,000 --> 00:45:15,480
to erase all of them that I really don't

979
00:45:15,480 --> 00:45:19,700
need it or just to create new ones

980
00:45:20,099 --> 00:45:24,359
um some of the ideas were deployed but

981
00:45:24,359 --> 00:45:27,619
we'd recommend just to deploy

982
00:45:27,619 --> 00:45:31,079
edrs on all connected devices just to

983
00:45:31,079 --> 00:45:34,740
Monitor and response in a

984
00:45:34,740 --> 00:45:38,839
um in a good time right

985
00:45:38,880 --> 00:45:40,680
and as well

986
00:45:40,680 --> 00:45:45,060
um we monitor with a Renault 1cm this

987
00:45:45,060 --> 00:45:49,500
this agency after this incident for sure

988
00:45:49,500 --> 00:45:52,319
related to user and groups into the

989
00:45:52,319 --> 00:45:54,359
domain yes we need just to have an

990
00:45:54,359 --> 00:45:56,940
inventory of different users just to

991
00:45:56,940 --> 00:45:59,660
give the correct privileges

992
00:45:59,660 --> 00:46:02,819
Implement as well the local

993
00:46:02,819 --> 00:46:05,160
Administration administrator a password

994
00:46:05,160 --> 00:46:08,280
service that's mainly a store the

995
00:46:08,280 --> 00:46:09,900
password of the local administrator into

996
00:46:09,900 --> 00:46:11,819
the domain controller and it's only

997
00:46:11,819 --> 00:46:14,339
accessible in some specific

998
00:46:14,339 --> 00:46:16,859
circumstances right

999
00:46:16,859 --> 00:46:19,020
for sure I'll review the network

1000
00:46:19,020 --> 00:46:22,740
segmentation for SMB version three I

1001
00:46:22,740 --> 00:46:24,060
mean the last one and blah blah blah

1002
00:46:24,060 --> 00:46:27,960
much much much more but

1003
00:46:27,960 --> 00:46:30,859
do you miss anything

1004
00:46:31,980 --> 00:46:34,880
yeah please

1005
00:46:36,300 --> 00:46:39,359
probably it was from 2020

1006
00:46:39,359 --> 00:46:42,300
but we didn't know we didn't have enough

1007
00:46:42,300 --> 00:46:44,700
evidences just to say okay this is the

1008
00:46:44,700 --> 00:46:46,440
entry point right

1009
00:46:46,440 --> 00:46:49,220
but we are talking always about

1010
00:46:49,220 --> 00:46:52,800
technology right

1011
00:46:52,800 --> 00:46:55,140
right correct

1012
00:46:55,140 --> 00:46:57,420
what about people

1013
00:46:57,420 --> 00:47:00,960
uh in the red team exercises we used to

1014
00:47:00,960 --> 00:47:03,839
test not only the defenses

1015
00:47:03,839 --> 00:47:06,240
as well the Defenders

1016
00:47:06,240 --> 00:47:08,760
so this is a

1017
00:47:08,760 --> 00:47:10,880
really nice video

1018
00:47:10,880 --> 00:47:13,920
I really love it a really good friend

1019
00:47:13,920 --> 00:47:16,920
just send it to me some months ago and I

1020
00:47:16,920 --> 00:47:19,740
say come on I have to to saw it and just

1021
00:47:19,740 --> 00:47:23,400
to see with you so just enjoy because

1022
00:47:23,400 --> 00:47:25,440
this is like the common offensive

1023
00:47:25,440 --> 00:47:28,859
operations are done and it's quite quite

1024
00:47:28,859 --> 00:47:31,740
similar to most of the incidents right

1025
00:47:31,740 --> 00:47:33,660
so that's it

1026
00:47:33,660 --> 00:47:36,660
foreign

1027
00:47:49,920 --> 00:47:52,920
foreign

1028
00:48:00,980 --> 00:48:04,870
[Laughter]

1029
00:48:06,970 --> 00:48:10,120
[Applause]

1030
00:48:35,300 --> 00:48:38,300
thank you

1031
00:48:41,520 --> 00:48:44,590
[Applause]

1032
00:48:52,840 --> 00:48:56,189
[Applause]

1033
00:49:02,400 --> 00:49:03,540
foreign

1034
00:49:03,540 --> 00:49:05,500
[Laughter]

1035
00:49:05,500 --> 00:49:08,690
[Applause]

1036
00:49:26,180 --> 00:49:39,119
[Laughter]

1037
00:49:39,119 --> 00:49:41,540
thank you

1038
00:49:57,960 --> 00:50:00,580
quite funny right

1039
00:50:00,580 --> 00:50:03,739
[Applause]

1040
00:50:06,260 --> 00:50:10,200
so just after the incident was solved

1041
00:50:10,200 --> 00:50:13,260
and blah blah blah blah blah what's next

1042
00:50:13,260 --> 00:50:15,359
what do you think that we can just do

1043
00:50:15,359 --> 00:50:18,780
after doing some consultancy just try to

1044
00:50:18,780 --> 00:50:20,339
help you know yes you put some

1045
00:50:20,339 --> 00:50:22,980
recommendation blah blah blah

1046
00:50:22,980 --> 00:50:25,920
yeah probably

1047
00:50:25,920 --> 00:50:28,680
come on do pen test

1048
00:50:28,680 --> 00:50:30,180
every year

1049
00:50:30,180 --> 00:50:32,040
an external pen test every two years

1050
00:50:32,040 --> 00:50:34,560
that's my recommendation always

1051
00:50:34,560 --> 00:50:36,240
great team in

1052
00:50:36,240 --> 00:50:39,420
yes you test as well people from The

1053
00:50:39,420 --> 00:50:41,700
Blue Team Vibes or just to collaborate

1054
00:50:41,700 --> 00:50:45,060
between all of us purple teaming

1055
00:50:45,060 --> 00:50:46,680
or

1056
00:50:46,680 --> 00:50:49,980
what's more this is quite important and

1057
00:50:49,980 --> 00:50:52,740
it's always miss it you know the Seesaw

1058
00:50:52,740 --> 00:50:54,000
attack

1059
00:50:54,000 --> 00:50:55,980
come on we are always talking between us

1060
00:50:55,980 --> 00:50:58,619
technical people we are really weak we

1061
00:50:58,619 --> 00:51:00,180
really a geek

1062
00:51:00,180 --> 00:51:02,520
but what about people that they don't

1063
00:51:02,520 --> 00:51:04,859
really understand the technology they

1064
00:51:04,859 --> 00:51:06,720
are using the same infrastructure right

1065
00:51:06,720 --> 00:51:10,399
so what happened with them

1066
00:51:12,240 --> 00:51:15,180
well from the offensive unit

1067
00:51:15,180 --> 00:51:17,280
um we are just doing pen testing for

1068
00:51:17,280 --> 00:51:19,200
teaming proper teaming I mean I guess I

1069
00:51:19,200 --> 00:51:21,720
talked about it before it is and also

1070
00:51:21,720 --> 00:51:24,119
simulating some reductors

1071
00:51:24,119 --> 00:51:27,300
but this is quite important

1072
00:51:27,300 --> 00:51:30,180
the table top exercises this is just to

1073
00:51:30,180 --> 00:51:32,700
train key people the sea level the

1074
00:51:32,700 --> 00:51:34,740
decision makers

1075
00:51:34,740 --> 00:51:37,980
just to train them in case of a real

1076
00:51:37,980 --> 00:51:39,599
incident

1077
00:51:39,599 --> 00:51:41,640
it's quite quite important as well as

1078
00:51:41,640 --> 00:51:44,520
appendix or our red team that's more

1079
00:51:44,520 --> 00:51:45,660
funny probably

1080
00:51:45,660 --> 00:51:50,220
but this is quite important as well so

1081
00:51:50,220 --> 00:51:52,559
if you have any question I'm more than

1082
00:51:52,559 --> 00:51:55,800
happy just you answered you or we can

1083
00:51:55,800 --> 00:51:58,740
just talk later with rakia beers so

1084
00:51:58,740 --> 00:52:01,079
whatever that you that you need

1085
00:52:01,079 --> 00:52:03,680
yep

1086
00:52:05,599 --> 00:52:08,280
just wait for the mic please

1087
00:52:08,280 --> 00:52:11,599
I gotta hurt you sorry

1088
00:52:15,480 --> 00:52:19,520
yeah my question is regarding uh

1089
00:52:19,520 --> 00:52:22,440
monitoring because okay incidents happen

1090
00:52:22,440 --> 00:52:25,859
nobody noticed and the attacker was in

1091
00:52:25,859 --> 00:52:28,020
the network and doing whatever he's

1092
00:52:28,020 --> 00:52:31,559
doing I didn't see the signs that

1093
00:52:31,559 --> 00:52:34,260
sellers were hardened and that is really

1094
00:52:34,260 --> 00:52:37,200
important because if these servers were

1095
00:52:37,200 --> 00:52:41,940
hardened really good a lot of actions

1096
00:52:41,940 --> 00:52:46,339
will not be possible to be done and also

1097
00:52:46,339 --> 00:52:49,680
monitoring where you got a few new

1098
00:52:49,680 --> 00:52:52,140
created local accounts and nobody is

1099
00:52:52,140 --> 00:52:55,380
watching in CM or checking these reports

1100
00:52:55,380 --> 00:52:57,480
it's really strange

1101
00:52:57,480 --> 00:53:00,240
yeah you're completely right I mean I

1102
00:53:00,240 --> 00:53:02,280
will say exactly

1103
00:53:02,280 --> 00:53:06,240
do you answer your own question

1104
00:53:06,240 --> 00:53:09,180
um if they implement

1105
00:53:09,180 --> 00:53:12,240
really good monitoring tools just to be

1106
00:53:12,240 --> 00:53:14,700
connected to the CM to this to the sock

1107
00:53:14,700 --> 00:53:16,200
mainly

1108
00:53:16,200 --> 00:53:20,579
if they just go Implement edrs if they

1109
00:53:20,579 --> 00:53:23,280
just Implement Guru gpos

1110
00:53:23,280 --> 00:53:27,300
if they just do really good hardening of

1111
00:53:27,300 --> 00:53:29,160
the whole service and as well for sure

1112
00:53:29,160 --> 00:53:31,800
to the domain controller

1113
00:53:31,800 --> 00:53:34,079
I cannot say that it's completely

1114
00:53:34,079 --> 00:53:36,720
impossible just to have these incidents

1115
00:53:36,720 --> 00:53:38,700
but it will be more difficult probably

1116
00:53:38,700 --> 00:53:41,280
yeah they are completely right

1117
00:53:41,280 --> 00:53:43,980
just for that reason after this incident

1118
00:53:43,980 --> 00:53:45,240
just happened

1119
00:53:45,240 --> 00:53:47,579
I mean this is just the NeverEnding

1120
00:53:47,579 --> 00:53:49,500
Story

1121
00:53:49,500 --> 00:53:53,280
people just react come on prevent

1122
00:53:53,280 --> 00:53:56,579
you know always the same story

1123
00:53:56,579 --> 00:53:59,040
so thank you for your answer just for

1124
00:53:59,040 --> 00:54:02,520
your question sorry so

1125
00:54:02,520 --> 00:54:04,800
didn't you have like a big red alarm

1126
00:54:04,800 --> 00:54:08,099
when when like the local admin accounts

1127
00:54:08,099 --> 00:54:11,099
were created because it's like the big

1128
00:54:11,099 --> 00:54:13,619
alarm in the CM or in a in a soccer team

1129
00:54:13,619 --> 00:54:16,920
well thank you for your question as well

1130
00:54:16,920 --> 00:54:18,960
because I heard it a lot of times that

1131
00:54:18,960 --> 00:54:20,940
in some networks local admins were

1132
00:54:20,940 --> 00:54:23,520
created or admin accounts and like there

1133
00:54:23,520 --> 00:54:25,559
is no monitoring or they are sleeping or

1134
00:54:25,559 --> 00:54:26,760
there's like nothing that they don't

1135
00:54:26,760 --> 00:54:28,440
detect it because of a big alarm if you

1136
00:54:28,440 --> 00:54:30,180
get the admin account created

1137
00:54:30,180 --> 00:54:31,319
well

1138
00:54:31,319 --> 00:54:36,180
we just uh we just were activated

1139
00:54:36,180 --> 00:54:38,579
in 2021

1140
00:54:38,579 --> 00:54:41,880
Park we just saw the the attack the

1141
00:54:41,880 --> 00:54:44,579
entry point was on one year a half

1142
00:54:44,579 --> 00:54:46,079
before

1143
00:54:46,079 --> 00:54:48,119
and we didn't have enough evidence is

1144
00:54:48,119 --> 00:54:50,400
just to know how they create

1145
00:54:50,400 --> 00:54:53,339
local admin accounts so that's a true

1146
00:54:53,339 --> 00:54:57,480
key part but I mean I cannot say 100

1147
00:54:57,480 --> 00:55:00,119
percent sure that that was the the way

1148
00:55:00,119 --> 00:55:03,119
that they were able just to create that

1149
00:55:03,119 --> 00:55:05,339
kind of accounts it's really tricky that

1150
00:55:05,339 --> 00:55:08,579
far but sometimes you have some Shadows

1151
00:55:08,579 --> 00:55:10,920
you know in the investigations

1152
00:55:10,920 --> 00:55:14,099
for sure right now they are completely

1153
00:55:14,099 --> 00:55:18,240
being monitored by our CM by our sock

1154
00:55:18,240 --> 00:55:21,660
uh they deploy some edrs and with many

1155
00:55:21,660 --> 00:55:24,059
of I mean following some of our

1156
00:55:24,059 --> 00:55:26,040
recommendations they are completely more

1157
00:55:26,040 --> 00:55:27,480
safe than before

1158
00:55:27,480 --> 00:55:29,760
so that's quite nice but I cannot

1159
00:55:29,760 --> 00:55:31,800
guarantee as well that they are not

1160
00:55:31,800 --> 00:55:34,500
being attacked right now by the same

1161
00:55:34,500 --> 00:55:36,780
three adapter so who knows

1162
00:55:36,780 --> 00:55:39,500
thank you

1163
00:55:40,500 --> 00:55:44,760
uh you said uh 20 or so assets were

1164
00:55:44,760 --> 00:55:47,000
compromised and had persistency

1165
00:55:47,000 --> 00:55:50,880
mechanisms installed which

1166
00:55:50,880 --> 00:55:53,579
percentage of these persistencies would

1167
00:55:53,579 --> 00:55:56,819
be stopped by implementing Labs because

1168
00:55:56,819 --> 00:56:00,000
Labs will wipe local admins on the next

1169
00:56:00,000 --> 00:56:01,740
update

1170
00:56:01,740 --> 00:56:03,240
well

1171
00:56:03,240 --> 00:56:04,440
um

1172
00:56:04,440 --> 00:56:06,839
that's a tricky question because I

1173
00:56:06,839 --> 00:56:08,520
cannot tell you exactly I don't remember

1174
00:56:08,520 --> 00:56:12,359
I didn't do the maths I mean the most

1175
00:56:12,359 --> 00:56:15,660
the most persistence is or some

1176
00:56:15,660 --> 00:56:18,780
persistence the most persistencies yes I

1177
00:56:18,780 --> 00:56:20,640
cannot tell you a number exactly but

1178
00:56:20,640 --> 00:56:23,819
it's the most yes the most right thank

1179
00:56:23,819 --> 00:56:25,940
you

1180
00:56:27,180 --> 00:56:29,640
is all done

1181
00:56:29,640 --> 00:56:31,859
so okay

1182
00:56:31,859 --> 00:56:34,740
the first question is how much did the

1183
00:56:34,740 --> 00:56:37,400
incident response process last

1184
00:56:37,400 --> 00:56:40,680
sorry how for how long did the incident

1185
00:56:40,680 --> 00:56:43,920
response process last from your side how

1186
00:56:43,920 --> 00:56:46,700
long have you been working on that case

1187
00:56:46,700 --> 00:56:49,079
much more time

1188
00:56:49,079 --> 00:56:51,359
I mean the report they ask you to tell

1189
00:56:51,359 --> 00:56:52,440
you a number

1190
00:56:52,440 --> 00:56:56,780
it's more than 300 pages

1191
00:56:57,119 --> 00:56:59,819
so you can just imagine then I mean just

1192
00:56:59,819 --> 00:57:03,599
telling you that we receive one giga one

1193
00:57:03,599 --> 00:57:07,440
gigabyte of data daily to analyze and in

1194
00:57:07,440 --> 00:57:09,960
some cases up to 20. I mean it was

1195
00:57:09,960 --> 00:57:11,700
really crazy

1196
00:57:11,700 --> 00:57:14,040
okay and you mentioned that you

1197
00:57:14,040 --> 00:57:16,380
effectively stopped the attack but did

1198
00:57:16,380 --> 00:57:18,480
you link the attackers to a specific

1199
00:57:18,480 --> 00:57:22,140
organization or apt group or to other

1200
00:57:22,140 --> 00:57:24,599
active attacks or past attacks

1201
00:57:24,599 --> 00:57:28,579
yeah that's uh that's a good question

1202
00:57:28,680 --> 00:57:30,799
um

1203
00:57:30,960 --> 00:57:32,640
this is the spoiler

1204
00:57:32,640 --> 00:57:35,460
uh sorry

1205
00:57:35,460 --> 00:57:37,200
I cannot tell you anything about the

1206
00:57:37,200 --> 00:57:38,400
trade actor

1207
00:57:38,400 --> 00:57:41,339
just with the two faces that I commented

1208
00:57:41,339 --> 00:57:43,200
from the very beginning

1209
00:57:43,200 --> 00:57:46,740
we just create the tcbs just try to

1210
00:57:46,740 --> 00:57:50,099
identify if it was just before on the

1211
00:57:50,099 --> 00:57:52,500
systems and just to use it as well for

1212
00:57:52,500 --> 00:57:55,559
probably next uh incident

1213
00:57:55,559 --> 00:57:57,300
so but at the very beginning we didn't

1214
00:57:57,300 --> 00:58:00,720
know anything about the this reductor

1215
00:58:00,720 --> 00:58:03,300
it's clear it's cool

1216
00:58:03,300 --> 00:58:05,520
any more questions

1217
00:58:05,520 --> 00:58:08,059
okay

1218
00:58:08,819 --> 00:58:13,319
hi uh you said that edr's helped is

1219
00:58:13,319 --> 00:58:15,720
there any preference on choosing the ADR

1220
00:58:15,720 --> 00:58:19,440
or do you think that any ADR would help

1221
00:58:19,440 --> 00:58:21,180
well there

1222
00:58:21,180 --> 00:58:23,520
are quite quite good I'm again just to

1223
00:58:23,520 --> 00:58:25,450
sell you a specific technology

1224
00:58:25,450 --> 00:58:27,059
[Music]

1225
00:58:27,059 --> 00:58:29,940
um mostly all of them are quite good

1226
00:58:29,940 --> 00:58:33,500
okay thank you thank you

1227
00:58:35,040 --> 00:58:37,279
anymore

1228
00:58:38,270 --> 00:58:41,819
[Music]

1229
00:58:41,819 --> 00:58:44,099
we're hungry of questions right did you

1230
00:58:44,099 --> 00:58:46,079
just got like Windows machines

1231
00:58:46,079 --> 00:58:48,000
compromised or have also some Linux

1232
00:58:48,000 --> 00:58:49,319
servers that you're around it got

1233
00:58:49,319 --> 00:58:52,500
compromised mainly windows

1234
00:58:52,500 --> 00:58:57,200
only or mainly windows

1235
00:59:00,660 --> 00:59:02,940
so thank you everybody it has been a

1236
00:59:02,940 --> 00:59:06,079
pleasure yes you'll be here

1237
00:59:06,440 --> 00:59:09,499
[Applause]

1238
00:59:12,180 --> 00:59:38,040
[Music]

