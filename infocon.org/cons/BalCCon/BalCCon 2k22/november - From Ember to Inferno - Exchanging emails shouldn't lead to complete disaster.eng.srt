1
00:00:00,080 --> 00:00:16,909
[Music]

2
00:00:18,980 --> 00:00:21,130
thank you

3
00:00:21,130 --> 00:00:23,640
[Music]

4
00:00:23,640 --> 00:00:27,180
next up from Amber Inferno and staging

5
00:00:27,180 --> 00:00:28,619
emails shouldn't lead to complete

6
00:00:28,619 --> 00:00:32,598
Disaster by November enjoy

7
00:00:33,890 --> 00:00:35,239
[Applause]

8
00:00:35,239 --> 00:00:39,420
all right hello all uh it's a pleasure

9
00:00:39,420 --> 00:00:40,980
being here it's my first time speaking

10
00:00:40,980 --> 00:00:43,140
at balcon

11
00:00:43,140 --> 00:00:46,440
so my name is Nicos I work as an instant

12
00:00:46,440 --> 00:00:48,780
responder for three years now

13
00:00:48,780 --> 00:00:51,780
um I like forensics I like petting dogs

14
00:00:51,780 --> 00:00:53,340
I like memes

15
00:00:53,340 --> 00:00:55,079
I'm one of you

16
00:00:55,079 --> 00:00:58,079
so once I started let's say my career

17
00:00:58,079 --> 00:01:00,360
back then when I was a student I always

18
00:01:00,360 --> 00:01:01,559
said you know what

19
00:01:01,559 --> 00:01:03,840
let's make things interesting

20
00:01:03,840 --> 00:01:06,479
and uh being here makes it really

21
00:01:06,479 --> 00:01:08,159
interesting to be honest

22
00:01:08,159 --> 00:01:10,560
yesterday of course as you can see I

23
00:01:10,560 --> 00:01:12,780
have a very nice mark from drinking too

24
00:01:12,780 --> 00:01:15,420
much right yeah unfortunately

25
00:01:15,420 --> 00:01:17,640
I've been two times in Serbia last time

26
00:01:17,640 --> 00:01:19,979
it ended up with a border patrol uh

27
00:01:19,979 --> 00:01:22,080
searching Micron jewels

28
00:01:22,080 --> 00:01:24,299
and as you can imagine each time I'm

29
00:01:24,299 --> 00:01:27,720
here something happens but it's nice so

30
00:01:27,720 --> 00:01:30,000
what's the agenda for today we're gonna

31
00:01:30,000 --> 00:01:31,380
discuss about an instant that happened

32
00:01:31,380 --> 00:01:34,200
in an organization we will not go let's

33
00:01:34,200 --> 00:01:37,680
say in too much into the details uh of

34
00:01:37,680 --> 00:01:39,840
the of the impact it goes because

35
00:01:39,840 --> 00:01:41,340
because I would like to focus more on

36
00:01:41,340 --> 00:01:43,320
the challenges we face and how we will

37
00:01:43,320 --> 00:01:45,540
approach let's say the investigation I

38
00:01:45,540 --> 00:01:48,000
truly believe that one of the biggest

39
00:01:48,000 --> 00:01:50,340
issues in at this moment is that

40
00:01:50,340 --> 00:01:52,740
everybody can teach forensics but you

41
00:01:52,740 --> 00:01:54,240
cannot teach the investigative mindset

42
00:01:54,240 --> 00:01:55,680
it's something that you either pick it

43
00:01:55,680 --> 00:01:58,560
up during uh with your experience or

44
00:01:58,560 --> 00:02:01,380
unfortunately it's something that you

45
00:02:01,380 --> 00:02:05,219
will need to have talks like that you

46
00:02:05,219 --> 00:02:08,220
have to to become better by yourself

47
00:02:08,220 --> 00:02:09,959
and of course at the end we will discuss

48
00:02:09,959 --> 00:02:13,080
some recommendations on on what to focus

49
00:02:13,080 --> 00:02:16,500
so since the dawn of time we use pigeons

50
00:02:16,500 --> 00:02:19,440
to carry messages then when we moved on

51
00:02:19,440 --> 00:02:22,620
to more electronic ways let's say we use

52
00:02:22,620 --> 00:02:26,459
the post office services and then as you

53
00:02:26,459 --> 00:02:28,680
can imagine right now the digitalization

54
00:02:28,680 --> 00:02:31,080
of all the mailing infrastructure we use

55
00:02:31,080 --> 00:02:33,780
exchange and of course the Outlook you

56
00:02:33,780 --> 00:02:35,099
cannot of course have different

57
00:02:35,099 --> 00:02:37,080
Technologies but you get the concept

58
00:02:37,080 --> 00:02:37,920
right

59
00:02:37,920 --> 00:02:40,500
messaging is an important aspect in uh

60
00:02:40,500 --> 00:02:42,480
in the throughout the human history and

61
00:02:42,480 --> 00:02:44,940
today most of us most of the talk will

62
00:02:44,940 --> 00:02:46,500
focus around

63
00:02:46,500 --> 00:02:49,319
The Exchange compromise and exchange the

64
00:02:49,319 --> 00:02:52,620
incident and think about it that

65
00:02:52,620 --> 00:02:54,540
although all these Services come

66
00:02:54,540 --> 00:02:55,920
together that are interconnected and

67
00:02:55,920 --> 00:02:57,480
something bad happens to one of them

68
00:02:57,480 --> 00:03:00,780
like in the case of Greece where it got

69
00:03:00,780 --> 00:03:01,940
hacked

70
00:03:01,940 --> 00:03:04,980
though that it's a lot of the post one

71
00:03:04,980 --> 00:03:06,660
of the the services actually got post

72
00:03:06,660 --> 00:03:09,000
and said some pretty nice let's say

73
00:03:09,000 --> 00:03:11,519
message about the prime minister

74
00:03:11,519 --> 00:03:13,800
okay

75
00:03:13,800 --> 00:03:18,060
so what about Microsoft chains the thing

76
00:03:18,060 --> 00:03:19,920
is it is very very targeted at this

77
00:03:19,920 --> 00:03:22,800
point since uh the last three years we

78
00:03:22,800 --> 00:03:24,440
had 69

79
00:03:24,440 --> 00:03:28,379
CVS and actually 10 of them were so so

80
00:03:28,379 --> 00:03:30,959
big they had critical score so you can

81
00:03:30,959 --> 00:03:33,120
imagine it was a mess for everybody

82
00:03:33,120 --> 00:03:35,760
working uh in the security industry it

83
00:03:35,760 --> 00:03:37,260
wasn't quite the year that we would hope

84
00:03:37,260 --> 00:03:39,840
for and it involved a lot of incidents

85
00:03:39,840 --> 00:03:42,239
imagine that when proxy Laguna came out

86
00:03:42,239 --> 00:03:47,040
in March 2018 it wasn't it wasn't much I

87
00:03:47,040 --> 00:03:47,780
believe

88
00:03:47,780 --> 00:03:50,580
we had so many incidents

89
00:03:50,580 --> 00:03:53,220
in only one week more than four so you

90
00:03:53,220 --> 00:03:56,459
can imagine no sleep at all

91
00:03:56,459 --> 00:04:01,440
but exchange has a very nice feature

92
00:04:01,440 --> 00:04:04,860
it involves parcel that you can have in

93
00:04:04,860 --> 00:04:08,040
order to do massive operations you can

94
00:04:08,040 --> 00:04:09,780
do stuff in bulk you can do things to

95
00:04:09,780 --> 00:04:11,879
automate rather than going behind the

96
00:04:11,879 --> 00:04:14,700
console the web page and uh

97
00:04:14,700 --> 00:04:16,620
and do it manually of course that

98
00:04:16,620 --> 00:04:19,199
creates an extra problem for us for us

99
00:04:19,199 --> 00:04:20,639
in the security business let's say

100
00:04:20,639 --> 00:04:22,680
because at this point we had one problem

101
00:04:22,680 --> 00:04:24,900
right you had to Monitor and secure the

102
00:04:24,900 --> 00:04:26,880
device but the server and the

103
00:04:26,880 --> 00:04:29,100
application but right now with the

104
00:04:29,100 --> 00:04:31,139
remote options that you have with power

105
00:04:31,139 --> 00:04:33,000
exchange partial you see how many

106
00:04:33,000 --> 00:04:34,560
Technologies they are available there

107
00:04:34,560 --> 00:04:37,740
and it's not so easy because

108
00:04:37,740 --> 00:04:39,840
there is one huge problem with security

109
00:04:39,840 --> 00:04:43,139
at this point we tend to to limit the

110
00:04:43,139 --> 00:04:45,660
usability of our products to enhance

111
00:04:45,660 --> 00:04:47,880
let's say the security aspect of the

112
00:04:47,880 --> 00:04:50,940
organization and that that these

113
00:04:50,940 --> 00:04:52,139
Administration tasks are really

114
00:04:52,139 --> 00:04:54,540
important for one organization

115
00:04:54,540 --> 00:04:55,979
of course for attackers this is

116
00:04:55,979 --> 00:04:57,419
Christmas right

117
00:04:57,419 --> 00:04:58,680
excellent

118
00:04:58,680 --> 00:05:01,860
so let's uh discuss about uh the

119
00:05:01,860 --> 00:05:04,199
incident pretty much it involved the

120
00:05:04,199 --> 00:05:05,580
typical scoping let's say with the

121
00:05:05,580 --> 00:05:07,500
client they pick we pick up the phone

122
00:05:07,500 --> 00:05:10,880
and they give us the first let's say

123
00:05:10,880 --> 00:05:14,040
details about it the the users inside

124
00:05:14,040 --> 00:05:16,020
the organization received

125
00:05:16,020 --> 00:05:18,300
a fishing email it was an email that

126
00:05:18,300 --> 00:05:21,479
prompted them to download the uh one

127
00:05:21,479 --> 00:05:23,820
malicious file and they didn't record

128
00:05:23,820 --> 00:05:26,280
they did some basic let's say sets for

129
00:05:26,280 --> 00:05:27,780
the headers in the email and they

130
00:05:27,780 --> 00:05:29,039
identified

131
00:05:29,039 --> 00:05:32,400
that the user IP is suspicious because

132
00:05:32,400 --> 00:05:35,699
it was not part of the organization so

133
00:05:35,699 --> 00:05:37,500
at first you see okay this is a typical

134
00:05:37,500 --> 00:05:39,720
business email compromise no biggie

135
00:05:39,720 --> 00:05:40,620
right

136
00:05:40,620 --> 00:05:43,139
but here's the thing we received a

137
00:05:43,139 --> 00:05:45,360
second call in the next 30 minutes

138
00:05:45,360 --> 00:05:47,340
saying you know what we'll have a second

139
00:05:47,340 --> 00:05:48,600
incident

140
00:05:48,600 --> 00:05:50,580
so we had two of them

141
00:05:50,580 --> 00:05:53,820
at least this is what I thought

142
00:05:53,820 --> 00:05:57,060
so you can imagine it was a very bad day

143
00:05:57,060 --> 00:06:00,120
it involved in one week

144
00:06:00,120 --> 00:06:02,280
of an incident so you can imagine there

145
00:06:02,280 --> 00:06:05,299
was no slip at all

146
00:06:05,880 --> 00:06:07,080
but

147
00:06:07,080 --> 00:06:09,660
the devil is not black as he is painted

148
00:06:09,660 --> 00:06:11,699
because we have tools

149
00:06:11,699 --> 00:06:14,340
we can detect it we can respond

150
00:06:14,340 --> 00:06:16,560
and we will discuss during the

151
00:06:16,560 --> 00:06:19,860
challenges how tough it is actually

152
00:06:19,860 --> 00:06:21,060
of course when we start the

153
00:06:21,060 --> 00:06:23,100
investigation we pick up the the web

154
00:06:23,100 --> 00:06:25,380
cells you know at least three of them

155
00:06:25,380 --> 00:06:27,180
into different service into different

156
00:06:27,180 --> 00:06:28,080
servers

157
00:06:28,080 --> 00:06:31,259
and as you can see it already had the

158
00:06:31,259 --> 00:06:34,560
privileged uh systemic privilege so it

159
00:06:34,560 --> 00:06:36,300
was pretty bad from the start

160
00:06:36,300 --> 00:06:37,979
because at this point you said that your

161
00:06:37,979 --> 00:06:40,319
organization your mailing infrastructure

162
00:06:40,319 --> 00:06:42,060
is completely compromised and that could

163
00:06:42,060 --> 00:06:44,520
State the tax for the next uh to enter

164
00:06:44,520 --> 00:06:47,160
the other systems as well it's one thing

165
00:06:47,160 --> 00:06:49,860
having a website but it's another to

166
00:06:49,860 --> 00:06:51,419
have admin running it with

167
00:06:51,419 --> 00:06:52,919
administrative privileges

168
00:06:52,919 --> 00:06:56,160
because we were saying okay the initial

169
00:06:56,160 --> 00:06:59,100
access is on the server how could they

170
00:06:59,100 --> 00:07:00,479
uh did the attackers just Collide

171
00:07:00,479 --> 00:07:02,220
further what could they do wouldn't have

172
00:07:02,220 --> 00:07:04,319
this kind of visibility and imagine that

173
00:07:04,319 --> 00:07:06,360
in most organizations right now they

174
00:07:06,360 --> 00:07:07,979
don't properly they don't monitor

175
00:07:07,979 --> 00:07:10,740
properly not the devices not the systems

176
00:07:10,740 --> 00:07:12,240
they don't know what they have this is a

177
00:07:12,240 --> 00:07:14,160
big big issue when it comes to scoping

178
00:07:14,160 --> 00:07:15,900
the incident because most of the times

179
00:07:15,900 --> 00:07:17,699
we enter blind you don't know where to

180
00:07:17,699 --> 00:07:19,979
go where to look and you have to pick up

181
00:07:19,979 --> 00:07:22,919
let's say some needles inside the whole

182
00:07:22,919 --> 00:07:25,400
haystack

183
00:07:27,060 --> 00:07:31,560
so once investigating the ISS logs we

184
00:07:31,560 --> 00:07:34,199
could find indeed that these web cells

185
00:07:34,199 --> 00:07:37,139
were plotting for uh some queries back

186
00:07:37,139 --> 00:07:38,520
to the C2 Channel

187
00:07:38,520 --> 00:07:40,020
and these are very important keep them

188
00:07:40,020 --> 00:07:42,300
in mind uh this is where you should be

189
00:07:42,300 --> 00:07:44,840
looking once you have a

190
00:07:44,840 --> 00:07:47,220
compromise like that not necessarily

191
00:07:47,220 --> 00:07:49,139
from a change because IIs might have

192
00:07:49,139 --> 00:07:51,240
different uh applications running on it

193
00:07:51,240 --> 00:07:54,660
as well so the assets logs are very

194
00:07:54,660 --> 00:07:57,840
important for us always keep them

195
00:07:57,840 --> 00:08:01,380
safe and if you if you can have a good

196
00:08:01,380 --> 00:08:04,199
retainment of at least one month before

197
00:08:04,199 --> 00:08:06,900
and let's save the list because it

198
00:08:06,900 --> 00:08:08,639
should be the bare minimum most

199
00:08:08,639 --> 00:08:10,740
organizations don't have this type of uh

200
00:08:10,740 --> 00:08:12,780
of logging capacities most of the times

201
00:08:12,780 --> 00:08:14,280
we have the question okay what could be

202
00:08:14,280 --> 00:08:16,680
a good retainment and most of the times

203
00:08:16,680 --> 00:08:18,900
it it involves the cost of the

204
00:08:18,900 --> 00:08:20,300
organization because

205
00:08:20,300 --> 00:08:23,879
logging and storing it costs so a good

206
00:08:23,879 --> 00:08:26,099
idea is to have at least three to six

207
00:08:26,099 --> 00:08:28,800
months of of retention

208
00:08:28,800 --> 00:08:31,379
as you can see in the website in one of

209
00:08:31,379 --> 00:08:34,740
them we were uh the the attackers were

210
00:08:34,740 --> 00:08:37,500
changing the local seeds and it was It

211
00:08:37,500 --> 00:08:39,539
was a base64.

212
00:08:39,539 --> 00:08:41,399
um string so let's keep in mind that

213
00:08:41,399 --> 00:08:43,559
okay you see something that you might

214
00:08:43,559 --> 00:08:45,660
not recognize at first but always look

215
00:08:45,660 --> 00:08:48,260
at patterns

216
00:08:48,540 --> 00:08:50,519
and then we focused on The Exchange

217
00:08:50,519 --> 00:08:52,019
Server again

218
00:08:52,019 --> 00:08:54,180
as your as you can see

219
00:08:54,180 --> 00:08:56,580
we found out in GitHub with that same

220
00:08:56,580 --> 00:08:59,040
simple sets that it was not even let's

221
00:08:59,040 --> 00:09:02,459
say uh a very very difficult attack to

222
00:09:02,459 --> 00:09:05,399
identify at first it was just a public

223
00:09:05,399 --> 00:09:08,279
POC that was out there and was run by

224
00:09:08,279 --> 00:09:11,820
Script kidding imagine that when a proxy

225
00:09:11,820 --> 00:09:14,399
shell happened when it came out it was I

226
00:09:14,399 --> 00:09:16,680
think August and that this incident was

227
00:09:16,680 --> 00:09:19,620
in November so the organization should

228
00:09:19,620 --> 00:09:21,480
have already been prepared for that but

229
00:09:21,480 --> 00:09:22,440
they didn't

230
00:09:22,440 --> 00:09:25,260
and this goes to show that no one cares

231
00:09:25,260 --> 00:09:27,300
about the patches that even the most

232
00:09:27,300 --> 00:09:29,519
simplistic attacks can be done and I'm

233
00:09:29,519 --> 00:09:32,279
simplistic because public POC that has

234
00:09:32,279 --> 00:09:35,580
already been picked up by the antivirus

235
00:09:35,580 --> 00:09:38,640
by the Arts by by whatever may be able

236
00:09:38,640 --> 00:09:39,839
to stop it

237
00:09:39,839 --> 00:09:43,440
and most of the times RC organizations

238
00:09:43,440 --> 00:09:45,540
think okay we need to invest more in EDR

239
00:09:45,540 --> 00:09:46,860
we need to invest more in the detection

240
00:09:46,860 --> 00:09:49,740
capability the thing is that all these

241
00:09:49,740 --> 00:09:51,180
products will be bypassed at some point

242
00:09:51,180 --> 00:09:54,660
right so no matter how you invest on the

243
00:09:54,660 --> 00:09:56,760
detection side you should always invest

244
00:09:56,760 --> 00:09:58,380
on the response as well

245
00:09:58,380 --> 00:10:00,300
we should it's something that I always

246
00:10:00,300 --> 00:10:01,740
say that there are three things in my

247
00:10:01,740 --> 00:10:04,620
life anymore that are inevitable it's

248
00:10:04,620 --> 00:10:07,080
death taxes and cyber incidents and we

249
00:10:07,080 --> 00:10:08,399
will never be able to avoid them at this

250
00:10:08,399 --> 00:10:10,019
point unless nuclear disaster happens

251
00:10:10,019 --> 00:10:12,420
and we're out of uh electricity and then

252
00:10:12,420 --> 00:10:15,540
we will not have the systems but always

253
00:10:15,540 --> 00:10:16,800
always

254
00:10:16,800 --> 00:10:18,899
keep in mind when you're looking at the

255
00:10:18,899 --> 00:10:21,000
at your logs you might be able to find

256
00:10:21,000 --> 00:10:24,420
unique identifiable uh observables as we

257
00:10:24,420 --> 00:10:26,519
call them in this case it was

258
00:10:26,519 --> 00:10:29,700
uh it was this is a user agent because

259
00:10:29,700 --> 00:10:31,980
once I was starting investigating I said

260
00:10:31,980 --> 00:10:33,000
okay

261
00:10:33,000 --> 00:10:34,740
we have two instance right now we have

262
00:10:34,740 --> 00:10:37,080
the one with the business email

263
00:10:37,080 --> 00:10:39,120
compromise and we're having one that

264
00:10:39,120 --> 00:10:43,760
change do they have some sort of

265
00:10:43,760 --> 00:10:45,839
collaboration between them the attackers

266
00:10:45,839 --> 00:10:48,180
did they know something uh did is it

267
00:10:48,180 --> 00:10:49,800
part of the same attack is it something

268
00:10:49,800 --> 00:10:50,700
new

269
00:10:50,700 --> 00:10:53,700
to balance with you it was my most

270
00:10:53,700 --> 00:10:55,980
difficult incident because it took me at

271
00:10:55,980 --> 00:10:58,680
least three days to try and pick up what

272
00:10:58,680 --> 00:11:00,079
actually happened

273
00:11:00,079 --> 00:11:03,240
and imagine that it's not always easy

274
00:11:03,240 --> 00:11:05,220
when you have an investigation because

275
00:11:05,220 --> 00:11:07,740
it's not always linear right you pick up

276
00:11:07,740 --> 00:11:10,440
some traces you pick some some

277
00:11:10,440 --> 00:11:13,320
some evidence you investigate as you go

278
00:11:13,320 --> 00:11:15,300
and then you have to do the analysis but

279
00:11:15,300 --> 00:11:17,339
at the same time you'd run out of time

280
00:11:17,339 --> 00:11:19,079
because most of times the organization

281
00:11:19,079 --> 00:11:21,000
circuit you know what you do a very good

282
00:11:21,000 --> 00:11:22,560
job with a forensics but I need to go

283
00:11:22,560 --> 00:11:24,240
back in business yes but how can you go

284
00:11:24,240 --> 00:11:26,579
back to business if you don't know where

285
00:11:26,579 --> 00:11:28,500
the incident happened what happened what

286
00:11:28,500 --> 00:11:29,940
caused what was the root cause of that

287
00:11:29,940 --> 00:11:32,339
what would you do to stop it from

288
00:11:32,339 --> 00:11:35,760
happening again uh most of the the times

289
00:11:35,760 --> 00:11:38,220
that will be seen in last four cases

290
00:11:38,220 --> 00:11:40,800
everybody proceeds to recover but do you

291
00:11:40,800 --> 00:11:43,079
know the entry point and if your backups

292
00:11:43,079 --> 00:11:45,660
are already compromised if you install

293
00:11:45,660 --> 00:11:48,300
the systems from scratch again

294
00:11:48,300 --> 00:11:51,360
what would happen nobody actually

295
00:11:51,360 --> 00:11:53,100
thinks about that during recovery times

296
00:11:53,100 --> 00:11:55,800
and this is something that we should

297
00:11:55,800 --> 00:11:58,680
strive as an industry to see what we

298
00:11:58,680 --> 00:12:00,240
will be looking we would be doing

299
00:12:00,240 --> 00:12:02,399
because at some point

300
00:12:02,399 --> 00:12:05,160
we see that most of the times the

301
00:12:05,160 --> 00:12:07,320
response companies that they called they

302
00:12:07,320 --> 00:12:11,160
only do basic investigation let's say

303
00:12:11,160 --> 00:12:13,140
and they proceed to according to the

304
00:12:13,140 --> 00:12:15,060
client needs and because you do what

305
00:12:15,060 --> 00:12:17,519
your client pays you to do it's okay I

306
00:12:17,519 --> 00:12:18,779
will stop my investigation I have

307
00:12:18,779 --> 00:12:20,160
already built you and I will continue

308
00:12:20,160 --> 00:12:22,500
with uh with the restoration of your

309
00:12:22,500 --> 00:12:24,680
services

310
00:12:25,980 --> 00:12:27,360
the good thing with forensic forensics

311
00:12:27,360 --> 00:12:28,980
is that it's a very well established

312
00:12:28,980 --> 00:12:32,579
science we do have uh this this

313
00:12:32,579 --> 00:12:34,200
Principle as we call it it's the local

314
00:12:34,200 --> 00:12:36,660
principle every it means that auto times

315
00:12:36,660 --> 00:12:40,380
when and a crime happens traces will be

316
00:12:40,380 --> 00:12:43,500
left behind and this is true to cyber

317
00:12:43,500 --> 00:12:45,060
instance as well

318
00:12:45,060 --> 00:12:48,360
no matter what something will be there

319
00:12:48,360 --> 00:12:50,820
remember when I told you that it was so

320
00:12:50,820 --> 00:12:53,160
difficult to try and understand if these

321
00:12:53,160 --> 00:12:55,440
incidents were linked together well in

322
00:12:55,440 --> 00:12:57,480
fact they were and I was

323
00:12:57,480 --> 00:13:01,019
amazed at the end of it like wow I I

324
00:13:01,019 --> 00:13:03,120
couldn't be able to understand it but

325
00:13:03,120 --> 00:13:05,220
again as you investigate

326
00:13:05,220 --> 00:13:07,079
you get all the peace together

327
00:13:07,079 --> 00:13:11,040
so one of the conclusions that I got out

328
00:13:11,040 --> 00:13:14,339
of it is never never us to to judging

329
00:13:14,339 --> 00:13:16,980
the situation mentally

330
00:13:16,980 --> 00:13:18,959
so these are three things let's say on

331
00:13:18,959 --> 00:13:21,240
the exchange technology how it works

332
00:13:21,240 --> 00:13:23,399
because it's one thing to receive the

333
00:13:23,399 --> 00:13:25,019
email in the

334
00:13:25,019 --> 00:13:27,540
in the server and it's another to have

335
00:13:27,540 --> 00:13:30,600
it uh you know in your system right so

336
00:13:30,600 --> 00:13:32,279
you have the message tracking you have

337
00:13:32,279 --> 00:13:34,260
the swap requests the shop messages we

338
00:13:34,260 --> 00:13:36,300
call it and have the Authentication

339
00:13:36,300 --> 00:13:37,680
as you understand the authentication

340
00:13:37,680 --> 00:13:39,540
means identity it means user it means an

341
00:13:39,540 --> 00:13:40,740
account

342
00:13:40,740 --> 00:13:44,040
and uh as we talk about ntlm you can

343
00:13:44,040 --> 00:13:47,519
figure out that uh if you can have a

344
00:13:47,519 --> 00:13:50,160
compromise and if

345
00:13:50,160 --> 00:13:52,560
you're able to hit the exchange

346
00:13:52,560 --> 00:13:55,139
initially this is a very good starting

347
00:13:55,139 --> 00:13:57,000
point because as we saw the website

348
00:13:57,000 --> 00:14:00,360
we're running on system so you would

349
00:14:00,360 --> 00:14:02,459
have a escalated privilege already and

350
00:14:02,459 --> 00:14:04,620
getting a house would be very very good

351
00:14:04,620 --> 00:14:07,079
to actually propagate inside the

352
00:14:07,079 --> 00:14:08,700
organization

353
00:14:08,700 --> 00:14:11,820
so just to have a graphical picture this

354
00:14:11,820 --> 00:14:15,000
is from the Microsoft website uh you

355
00:14:15,000 --> 00:14:16,980
will be able to to understand it's a

356
00:14:16,980 --> 00:14:19,320
little bit better we mostly thought it

357
00:14:19,320 --> 00:14:21,600
flickers a bit anyway but as you can see

358
00:14:21,600 --> 00:14:24,060
on the auto Discovery service it is the

359
00:14:24,060 --> 00:14:26,579
one the first that got hit and then it

360
00:14:26,579 --> 00:14:29,120
uh escalated

361
00:14:29,120 --> 00:14:32,100
ews service

362
00:14:32,100 --> 00:14:34,620
so what was the anatomy behind the

363
00:14:34,620 --> 00:14:35,600
attack

364
00:14:35,600 --> 00:14:39,420
discover service is abused to leak uh

365
00:14:39,420 --> 00:14:41,220
the the distinguished name of a known

366
00:14:41,220 --> 00:14:44,600
user in this case it was administrator

367
00:14:44,600 --> 00:14:48,800
and keep in mind that it is a very nice

368
00:14:48,800 --> 00:14:51,300
recommendation to change the name of

369
00:14:51,300 --> 00:14:53,639
your local administrator or disable it

370
00:14:53,639 --> 00:14:56,459
one of those two things because even

371
00:14:56,459 --> 00:14:58,980
script kidding even someone that has low

372
00:14:58,980 --> 00:15:01,980
uh let's check up capacity

373
00:15:01,980 --> 00:15:04,800
and doesn't know your organization they

374
00:15:04,800 --> 00:15:07,260
will always try the first ad or admin

375
00:15:07,260 --> 00:15:08,880
administrator something like that and

376
00:15:08,880 --> 00:15:10,760
for them it was the case as well

377
00:15:10,760 --> 00:15:13,800
so the attacker knows the most

378
00:15:13,800 --> 00:15:16,320
well-known uh distinguished name

379
00:15:16,320 --> 00:15:19,440
and then they can afford the their

380
00:15:19,440 --> 00:15:22,560
access to the AWS so

381
00:15:22,560 --> 00:15:25,199
uh with the attacker being able to

382
00:15:25,199 --> 00:15:27,000
successfully impersonate the target user

383
00:15:27,000 --> 00:15:29,639
with this valid access they can perform

384
00:15:29,639 --> 00:15:32,639
the old vws operations they want

385
00:15:32,639 --> 00:15:35,160
so the proxy cell to continue the

386
00:15:35,160 --> 00:15:38,459
operation they will uh have let's say

387
00:15:38,459 --> 00:15:41,399
the shop request we're discussing so one

388
00:15:41,399 --> 00:15:44,040
of them was a create item so it allows

389
00:15:44,040 --> 00:15:45,540
the create the remote creation of

390
00:15:45,540 --> 00:15:48,000
females and then they can impersonate

391
00:15:48,000 --> 00:15:49,019
the user

392
00:15:49,019 --> 00:15:51,000
uh imagine

393
00:15:51,000 --> 00:15:54,120
that this was the missing key

394
00:15:54,120 --> 00:15:55,260
because

395
00:15:55,260 --> 00:15:57,000
we were looking at the websites we were

396
00:15:57,000 --> 00:15:59,880
looking at the emails we found that in

397
00:15:59,880 --> 00:16:04,079
the in the mailbox we analyzed the the

398
00:16:04,079 --> 00:16:07,320
headers and who analyzed I find out

399
00:16:07,320 --> 00:16:09,600
actually that the client IP address

400
00:16:09,600 --> 00:16:13,620
the one that sent email was the one that

401
00:16:13,620 --> 00:16:16,019
had performed the swap request

402
00:16:16,019 --> 00:16:18,420
the softbox on the create item so this

403
00:16:18,420 --> 00:16:20,880
was the missing the missing link that we

404
00:16:20,880 --> 00:16:23,339
require to let's say link the attacks

405
00:16:23,339 --> 00:16:25,260
together when proxy happened I'm like oh

406
00:16:25,260 --> 00:16:27,240
my God finally I'm looking at an ATP

407
00:16:27,240 --> 00:16:30,000
find out my proper responder but it was

408
00:16:30,000 --> 00:16:32,220
not the case I harassed to to judge I

409
00:16:32,220 --> 00:16:33,839
asked to judge and this was a mistakes

410
00:16:33,839 --> 00:16:35,399
from my side because you go to the

411
00:16:35,399 --> 00:16:36,300
client say you know what you're being

412
00:16:36,300 --> 00:16:39,060
targeted by the Chinese and uh they look

413
00:16:39,060 --> 00:16:41,699
at them oh my why and this causes an

414
00:16:41,699 --> 00:16:43,620
unnecessary escalation let's say so

415
00:16:43,620 --> 00:16:45,600
that's why I say I have to be more

416
00:16:45,600 --> 00:16:47,519
careful next time but I'm happy because

417
00:16:47,519 --> 00:16:49,980
I learned from my mistakes and this was

418
00:16:49,980 --> 00:16:52,259
a key because it took me like three days

419
00:16:52,259 --> 00:16:54,959
only to find this IP address and I found

420
00:16:54,959 --> 00:16:58,079
out from the the create item to be

421
00:16:58,079 --> 00:16:59,160
honest with you I didn't have much

422
00:16:59,160 --> 00:17:00,899
experience back then with uh with

423
00:17:00,899 --> 00:17:04,079
exchange but as I told you you learn as

424
00:17:04,079 --> 00:17:06,059
you go you can learn all the things

425
00:17:06,059 --> 00:17:09,540
right and this is a very uh big

426
00:17:09,540 --> 00:17:11,400
statement when it comes to to most

427
00:17:11,400 --> 00:17:13,619
response companies and all the response

428
00:17:13,619 --> 00:17:15,660
Consultants out there if you don't have

429
00:17:15,660 --> 00:17:16,980
the capacity you don't have the

430
00:17:16,980 --> 00:17:18,660
knowledge inside your organization you

431
00:17:18,660 --> 00:17:21,599
will probably Outsource it so you cannot

432
00:17:21,599 --> 00:17:24,720
expect everybody let's say to have the

433
00:17:24,720 --> 00:17:25,980
Techno the knowledge and all

434
00:17:25,980 --> 00:17:28,500
Technologies uh technology evolved so

435
00:17:28,500 --> 00:17:30,540
much right now imagine that in Cloud

436
00:17:30,540 --> 00:17:32,940
especially in Azure things change it

437
00:17:32,940 --> 00:17:36,240
it's uh six months so it's you either uh

438
00:17:36,240 --> 00:17:39,299
have to keep up or you will have let's

439
00:17:39,299 --> 00:17:42,900
say this sort of uh slacking and this

440
00:17:42,900 --> 00:17:44,880
liking can be a little bit dangerous

441
00:17:44,880 --> 00:17:46,799
imagine that with a forensic tools as

442
00:17:46,799 --> 00:17:49,440
well we do not don't have the latest

443
00:17:49,440 --> 00:17:51,840
kernels inside them because first you

444
00:17:51,840 --> 00:17:54,059
wait for the the OS to come out for

445
00:17:54,059 --> 00:17:56,520
example in volatility uh we didn't have

446
00:17:56,520 --> 00:17:59,760
the latest version to analyze the

447
00:17:59,760 --> 00:18:01,620
windows 11 systems that were out there

448
00:18:01,620 --> 00:18:03,960
so you can imagine that this can create

449
00:18:03,960 --> 00:18:06,600
a problem as well

450
00:18:06,600 --> 00:18:08,280
so this would be the bigger picture

451
00:18:08,280 --> 00:18:10,440
let's say this would be how we link

452
00:18:10,440 --> 00:18:12,539
together over

453
00:18:12,539 --> 00:18:15,960
uh all these incidents together it was

454
00:18:15,960 --> 00:18:18,240
not so incident actually as you can see

455
00:18:18,240 --> 00:18:21,240
yeah we have the proxy exploitation the

456
00:18:21,240 --> 00:18:23,580
proxial exploitation and then the

457
00:18:23,580 --> 00:18:25,919
attacker created the show up the swap

458
00:18:25,919 --> 00:18:28,320
action this is how you know we're able

459
00:18:28,320 --> 00:18:31,320
to transmit the message this is how uh

460
00:18:31,320 --> 00:18:35,160
the the the attacker would spawn later

461
00:18:35,160 --> 00:18:36,960
the attack it was if I remember

462
00:18:36,960 --> 00:18:38,820
correctly it was the the squirrel

463
00:18:38,820 --> 00:18:42,720
bathroom uh payload and it didn't cause

464
00:18:42,720 --> 00:18:43,919
that much trouble inside the

465
00:18:43,919 --> 00:18:45,720
organization the good thing is because

466
00:18:45,720 --> 00:18:49,559
they detected the uh The Exchange

467
00:18:49,559 --> 00:18:52,160
compromise they will show

468
00:18:52,160 --> 00:18:55,559
agitated by that so they were behind the

469
00:18:55,559 --> 00:18:56,940
screens all the time saying okay what

470
00:18:56,940 --> 00:18:58,440
happens now what happens now and they

471
00:18:58,440 --> 00:19:00,480
were asking questions to the users and

472
00:19:00,480 --> 00:19:01,740
this is a bad thing because when you

473
00:19:01,740 --> 00:19:03,539
don't have Consolidated logs you only

474
00:19:03,539 --> 00:19:05,280
require on the users themselves to

475
00:19:05,280 --> 00:19:07,740
verify if they clicked or not

476
00:19:07,740 --> 00:19:10,799
and we will discuss about it in uh in a

477
00:19:10,799 --> 00:19:13,020
few seconds

478
00:19:13,020 --> 00:19:15,299
so additional investigation always

479
00:19:15,299 --> 00:19:17,400
evolves around the processes right it's

480
00:19:17,400 --> 00:19:18,419
really really important to understand

481
00:19:18,419 --> 00:19:21,480
what uh process have been run all the

482
00:19:21,480 --> 00:19:23,880
volatile information out there so this

483
00:19:23,880 --> 00:19:26,640
is why you should never ever shut down a

484
00:19:26,640 --> 00:19:28,919
system it's better to touch just

485
00:19:28,919 --> 00:19:31,500
disconnect the blood the

486
00:19:31,500 --> 00:19:33,960
ethernet cable or disconnect from Wi-Fi

487
00:19:33,960 --> 00:19:36,120
because all the volatile data would be

488
00:19:36,120 --> 00:19:38,700
lost imagine that we are seeing power

489
00:19:38,700 --> 00:19:39,960
commands

490
00:19:39,960 --> 00:19:42,360
from w3wp

491
00:19:42,360 --> 00:19:44,340
and we would be able to see the from

492
00:19:44,340 --> 00:19:46,440
Telemetry we would be able to see the

493
00:19:46,440 --> 00:19:48,960
malicious commands from uh from the

494
00:19:48,960 --> 00:19:50,760
attackers this is how you should you

495
00:19:50,760 --> 00:19:52,500
properly do the scoping because imagine

496
00:19:52,500 --> 00:19:54,120
you can see that the command get mailbox

497
00:19:54,120 --> 00:19:56,520
for example it means that right now the

498
00:19:56,520 --> 00:19:58,620
attackers has knowledge of the emails

499
00:19:58,620 --> 00:20:00,960
that you have sent right now they know

500
00:20:00,960 --> 00:20:04,380
more people inside the organization and

501
00:20:04,380 --> 00:20:06,720
they can stage more attacks I believe

502
00:20:06,720 --> 00:20:09,179
that with all the evidence around you

503
00:20:09,179 --> 00:20:11,100
would be able to have better mitigation

504
00:20:11,100 --> 00:20:12,840
action let's say because it's one thing

505
00:20:12,840 --> 00:20:14,280
changing the password it's one thing

506
00:20:14,280 --> 00:20:18,120
let's say reissuing Kerberos tickets and

507
00:20:18,120 --> 00:20:21,660
even certificates so once you finish the

508
00:20:21,660 --> 00:20:22,919
investigation then you would be able to

509
00:20:22,919 --> 00:20:24,120
say

510
00:20:24,120 --> 00:20:27,900
the bigger the impact

511
00:20:27,900 --> 00:20:30,539
remember this there is no one size fits

512
00:20:30,539 --> 00:20:33,780
all uh solution to that and this is why

513
00:20:33,780 --> 00:20:36,059
we shouldn't just rely on password

514
00:20:36,059 --> 00:20:37,500
changing

515
00:20:37,500 --> 00:20:40,500
and what I loved about the latest

516
00:20:40,500 --> 00:20:42,000
technology right now that Microsoft

517
00:20:42,000 --> 00:20:45,840
offers it's by no means there's no sales

518
00:20:45,840 --> 00:20:49,260
talk but the I as far as I know they are

519
00:20:49,260 --> 00:20:51,360
the only uh detection action at this

520
00:20:51,360 --> 00:20:53,820
point the 365 Defender that you can have

521
00:20:53,820 --> 00:20:56,820
Telemetry especially for clicks so with

522
00:20:56,820 --> 00:20:59,820
this uh query in the in kql you can

523
00:20:59,820 --> 00:21:02,039
actually find the list of all the users

524
00:21:02,039 --> 00:21:04,980
that they have clicked the suspicious

525
00:21:04,980 --> 00:21:06,840
links let's say and as you can

526
00:21:06,840 --> 00:21:08,640
understand it's very good for us because

527
00:21:08,640 --> 00:21:10,980
at this previously we had to go to its

528
00:21:10,980 --> 00:21:13,080
computer that we assumed it was braced

529
00:21:13,080 --> 00:21:16,020
and then we had to perform forensics and

530
00:21:16,020 --> 00:21:18,780
do all the actions there imagine that

531
00:21:18,780 --> 00:21:20,640
there is a specific in registry where

532
00:21:20,640 --> 00:21:22,679
you have to investigate to find the if a

533
00:21:22,679 --> 00:21:25,500
user has opened an Outlook attachment

534
00:21:25,500 --> 00:21:28,320
and uh and Outlook link but right now

535
00:21:28,320 --> 00:21:31,440
with Telemetry we are more able to stop

536
00:21:31,440 --> 00:21:34,320
let's say the incident before they cause

537
00:21:34,320 --> 00:21:36,900
too much trouble because indeed a

538
00:21:36,900 --> 00:21:38,400
business email compromise shouldn't lead

539
00:21:38,400 --> 00:21:41,220
to a complete disaster

540
00:21:41,220 --> 00:21:42,900
this is the time where you actually take

541
00:21:42,900 --> 00:21:44,640
your your phones to it

542
00:21:44,640 --> 00:21:46,500
to take photos I've Consolidated over

543
00:21:46,500 --> 00:21:48,780
the things we did for for the

544
00:21:48,780 --> 00:21:51,720
investigation so always processes it's

545
00:21:51,720 --> 00:21:54,299
very very important to say for uh cell

546
00:21:54,299 --> 00:21:55,440
commands

547
00:21:55,440 --> 00:21:58,980
it is also very very important to have

548
00:21:58,980 --> 00:22:01,860
all the volatile data I'm saying process

549
00:22:01,860 --> 00:22:03,900
because most of these times

550
00:22:03,900 --> 00:22:06,240
in at least in the in the investigation

551
00:22:06,240 --> 00:22:09,659
we have with the the whole incident

552
00:22:09,659 --> 00:22:11,940
around evolved around the compromise

553
00:22:11,940 --> 00:22:13,140
websites

554
00:22:13,140 --> 00:22:15,720
from the compromise server so keep in

555
00:22:15,720 --> 00:22:18,480
mind also that you might have web cells

556
00:22:18,480 --> 00:22:21,179
mostly these parts are indicative

557
00:22:21,179 --> 00:22:22,440
most of the times they might actually

558
00:22:22,440 --> 00:22:26,039
change but these are the two uh paths

559
00:22:26,039 --> 00:22:28,100
that are actually writable

560
00:22:28,100 --> 00:22:30,659
but keep in mind that it might that's

561
00:22:30,659 --> 00:22:32,820
why I put the asterisk on top of that

562
00:22:32,820 --> 00:22:34,200
they might be

563
00:22:34,200 --> 00:22:35,760
somewhere else

564
00:22:35,760 --> 00:22:38,039
of course you use the application logs

565
00:22:38,039 --> 00:22:39,360
as well so it's really really important

566
00:22:39,360 --> 00:22:41,100
not only to gather the logs from the

567
00:22:41,100 --> 00:22:43,080
system but from the applications as well

568
00:22:43,080 --> 00:22:45,240
and this is a general recommendation not

569
00:22:45,240 --> 00:22:47,220
just for exchange server not just for

570
00:22:47,220 --> 00:22:50,100
ISS logs Call It Whatever You Like We

571
00:22:50,100 --> 00:22:53,240
had an instant last week where it was uh

572
00:22:53,240 --> 00:22:56,460
an unauthorized access into a server and

573
00:22:56,460 --> 00:22:59,220
their client goes and says okay can you

574
00:22:59,220 --> 00:23:00,840
please tell us if we are compromised and

575
00:23:00,840 --> 00:23:02,940
we go okay of course but do you have

576
00:23:02,940 --> 00:23:05,340
application logs to to tell you who

577
00:23:05,340 --> 00:23:07,919
itself which accounts actually logged in

578
00:23:07,919 --> 00:23:09,900
and said we don't have that kind of

579
00:23:09,900 --> 00:23:12,480
visibility so

580
00:23:12,480 --> 00:23:14,580
because all the other external facing

581
00:23:14,580 --> 00:23:16,260
applications on your organization will

582
00:23:16,260 --> 00:23:18,780
be targeted let's face it it you might

583
00:23:18,780 --> 00:23:21,840
have let's say a lot of false positives

584
00:23:21,840 --> 00:23:23,580
you will be seeing scanners you will be

585
00:23:23,580 --> 00:23:26,340
seeing script kiddies stuff like that so

586
00:23:26,340 --> 00:23:29,220
we we typically say in the in the

587
00:23:29,220 --> 00:23:31,080
business the words maturity but what

588
00:23:31,080 --> 00:23:33,299
does it actually mean it's only it's a

589
00:23:33,299 --> 00:23:35,820
big buzzword right we only care let's

590
00:23:35,820 --> 00:23:38,340
see how much someone will invest

591
00:23:38,340 --> 00:23:40,620
and without proper investing that's true

592
00:23:40,620 --> 00:23:43,080
without proper investing in firewalls in

593
00:23:43,080 --> 00:23:44,640
the office the proper detection

594
00:23:44,640 --> 00:23:46,740
techniques it is very hard to respond

595
00:23:46,740 --> 00:23:49,200
very hard to respond

596
00:23:49,200 --> 00:23:52,020
so let's discuss some of the caveats

597
00:23:52,020 --> 00:23:54,780
some of the problems that uh

598
00:23:54,780 --> 00:23:56,760
that we face

599
00:23:56,760 --> 00:24:00,299
the one thing at most of the times we do

600
00:24:00,299 --> 00:24:02,700
as a response uh as a response

601
00:24:02,700 --> 00:24:04,679
consultant and call it whatever like

602
00:24:04,679 --> 00:24:06,720
blue teams defense teams whatever we

603
00:24:06,720 --> 00:24:08,760
link everything to meter attack that's

604
00:24:08,760 --> 00:24:11,100
good meter has already provided a good

605
00:24:11,100 --> 00:24:13,260
Consolidated list you have a very good

606
00:24:13,260 --> 00:24:15,380
picture let's say of what can be

607
00:24:15,380 --> 00:24:18,059
categorized as a tactic as a technique

608
00:24:18,059 --> 00:24:20,820
as a procedure of the attacker but it's

609
00:24:20,820 --> 00:24:22,980
uh and it's no Silver Bullet

610
00:24:22,980 --> 00:24:25,020
so this is why defend is being created

611
00:24:25,020 --> 00:24:28,620
at this point because all these uh all

612
00:24:28,620 --> 00:24:30,419
these tactics all these techniques would

613
00:24:30,419 --> 00:24:32,280
produce artifacts and as you can

614
00:24:32,280 --> 00:24:34,020
understand

615
00:24:34,020 --> 00:24:38,460
you have multiple artists tactics

616
00:24:38,460 --> 00:24:42,240
and procedure that map two specific logs

617
00:24:42,240 --> 00:24:44,460
keep in mind that first you have the

618
00:24:44,460 --> 00:24:45,840
system then you have the attack right

619
00:24:45,840 --> 00:24:48,780
someone has to happen so we need to know

620
00:24:48,780 --> 00:24:50,760
our operating systems better we need to

621
00:24:50,760 --> 00:24:52,500
know applications better and I believe

622
00:24:52,500 --> 00:24:55,020
that this is what defense strives for

623
00:24:55,020 --> 00:24:57,659
if you do know if you don't know it give

624
00:24:57,659 --> 00:25:00,419
it a look I believe the combination of

625
00:25:00,419 --> 00:25:03,120
both Frameworks is really important uh

626
00:25:03,120 --> 00:25:05,340
to to shape the future of cyber security

627
00:25:05,340 --> 00:25:07,559
because things evolve and we cannot rely

628
00:25:07,559 --> 00:25:11,100
not only on a single framework we need a

629
00:25:11,100 --> 00:25:12,960
combination of them and the combination

630
00:25:12,960 --> 00:25:15,720
of different uh skill sets I don't like

631
00:25:15,720 --> 00:25:17,940
putting Hudson gray hat black hat

632
00:25:17,940 --> 00:25:20,580
Whitehead or even saying blue team

633
00:25:20,580 --> 00:25:24,059
already team security is one right so we

634
00:25:24,059 --> 00:25:26,640
should be able to collaborate better and

635
00:25:26,640 --> 00:25:29,460
Frameworks like them that enhance the

636
00:25:29,460 --> 00:25:31,140
collaboration I believe this is what

637
00:25:31,140 --> 00:25:33,980
would be striving for

638
00:25:34,260 --> 00:25:35,760
and these are some of the challenges of

639
00:25:35,760 --> 00:25:37,980
course that that we face like I told you

640
00:25:37,980 --> 00:25:40,860
you have to know your logs you have to

641
00:25:40,860 --> 00:25:43,520
uh

642
00:25:43,520 --> 00:25:46,200
it's something so this is why I laugh

643
00:25:46,200 --> 00:25:48,240
it's something that most organizations

644
00:25:48,240 --> 00:25:50,039
don't put focus on

645
00:25:50,039 --> 00:25:53,820
and not having logs is essential you

646
00:25:53,820 --> 00:25:56,220
cannot expect not to have an incident at

647
00:25:56,220 --> 00:25:57,779
some point you need to realize that your

648
00:25:57,779 --> 00:25:59,760
digital footprint is out there and you

649
00:25:59,760 --> 00:26:01,559
have to do something about it you may

650
00:26:01,559 --> 00:26:04,440
not you may not have let's say the

651
00:26:04,440 --> 00:26:06,059
biggest Investments when it comes to

652
00:26:06,059 --> 00:26:08,640
detection capabilities but you need to

653
00:26:08,640 --> 00:26:12,080
be able to respond and respond fast

654
00:26:12,080 --> 00:26:14,880
is never linear you pick some Trails

655
00:26:14,880 --> 00:26:16,740
crumbly stuff like that and then you

656
00:26:16,740 --> 00:26:19,140
start connecting the Dodge

657
00:26:19,140 --> 00:26:21,000
like I told you jump too early on my

658
00:26:21,000 --> 00:26:22,980
conclusions I will I try not to do that

659
00:26:22,980 --> 00:26:25,860
anymore you learn as you go some that is

660
00:26:25,860 --> 00:26:28,740
very important as well is that you don't

661
00:26:28,740 --> 00:26:31,500
understand the pressure that uh a

662
00:26:31,500 --> 00:26:33,120
response team faces actually because

663
00:26:33,120 --> 00:26:34,620
you've had your normal eight hours let's

664
00:26:34,620 --> 00:26:36,539
say and then you you get a call on your

665
00:26:36,539 --> 00:26:38,039
Friday night and say okay you know what

666
00:26:38,039 --> 00:26:40,559
screw your your weekend you have to

667
00:26:40,559 --> 00:26:42,299
respond you have to go to an organizer

668
00:26:42,299 --> 00:26:44,100
and this creates an extra pressure and

669
00:26:44,100 --> 00:26:46,200
especially during copy times this is

670
00:26:46,200 --> 00:26:48,179
something that uh create a lot of stress

671
00:26:48,179 --> 00:26:50,760
during uh not only for responders but

672
00:26:50,760 --> 00:26:52,980
most I believe most of us in most of us

673
00:26:52,980 --> 00:26:55,679
of course sharing is caring right this

674
00:26:55,679 --> 00:26:56,940
is why we need to have conference like

675
00:26:56,940 --> 00:26:58,740
that open conferences we need to have

676
00:26:58,740 --> 00:27:01,260
open resources for digital forensics as

677
00:27:01,260 --> 00:27:03,059
well and what I don't like particularly

678
00:27:03,059 --> 00:27:05,520
in this industry in the fir is that

679
00:27:05,520 --> 00:27:09,360
there are no uh not known let's say many

680
00:27:09,360 --> 00:27:11,220
resources out there and you have to

681
00:27:11,220 --> 00:27:14,880
either pay for them uh or most of the

682
00:27:14,880 --> 00:27:17,640
times as they say okay you can blame cpf

683
00:27:17,640 --> 00:27:19,320
stuff like that I don't really believe

684
00:27:19,320 --> 00:27:23,400
that CTF approach is better for uh for

685
00:27:23,400 --> 00:27:25,799
forensics because imagine no one teaches

686
00:27:25,799 --> 00:27:27,779
you how to search the needle in the

687
00:27:27,779 --> 00:27:29,760
haystack but when you're playing a CTF

688
00:27:29,760 --> 00:27:31,380
and you're hunting for the flag you're

689
00:27:31,380 --> 00:27:33,419
focused on only one Mission finding the

690
00:27:33,419 --> 00:27:36,000
flag you know it's there sometimes when

691
00:27:36,000 --> 00:27:37,980
we get called to respond to incidents

692
00:27:37,980 --> 00:27:40,020
there are not even incidents so imagine

693
00:27:40,020 --> 00:27:42,120
you have to image the whole computer

694
00:27:42,120 --> 00:27:44,220
just to find out in the end of the day

695
00:27:44,220 --> 00:27:46,320
that nothing happened but you have to be

696
00:27:46,320 --> 00:27:47,880
able to prove it and that's why I say

697
00:27:47,880 --> 00:27:50,580
forensic science hiking is an art

698
00:27:50,580 --> 00:27:52,140
and you have to properly have a

699
00:27:52,140 --> 00:27:54,240
structure behind that and just by

700
00:27:54,240 --> 00:27:57,059
playing uh you cannot be able to get

701
00:27:57,059 --> 00:27:58,799
let's say the bigger picture in the

702
00:27:58,799 --> 00:28:00,918
future

703
00:28:01,320 --> 00:28:04,080
and that concludes my talk

704
00:28:04,080 --> 00:28:08,720
I don't know if you have any questions

705
00:28:10,200 --> 00:28:12,740
yes

706
00:28:19,100 --> 00:28:22,500
hi thanks for your presentation uh I was

707
00:28:22,500 --> 00:28:24,960
wondering you said that you matched your

708
00:28:24,960 --> 00:28:29,580
malicious shop API request from the with

709
00:28:29,580 --> 00:28:31,260
the IP address of the sender of the

710
00:28:31,260 --> 00:28:32,039
email

711
00:28:32,039 --> 00:28:35,520
but if I'm not mistaken the IP address

712
00:28:35,520 --> 00:28:38,640
of the sender is usually the smdp

713
00:28:38,640 --> 00:28:42,059
address the servers and the others so

714
00:28:42,059 --> 00:28:44,279
did you manage to find VIP from an

715
00:28:44,279 --> 00:28:46,320
administrative console of the user that

716
00:28:46,320 --> 00:28:48,240
sent the actual send email here's the

717
00:28:48,240 --> 00:28:50,520
thing this investigation specific to

718
00:28:50,520 --> 00:28:52,140
this point you have to do it in Outlook

719
00:28:52,140 --> 00:28:53,340
this is why I was talking about the

720
00:28:53,340 --> 00:28:55,679
headers we found the client IP address

721
00:28:55,679 --> 00:28:58,080
this is the one that matches in the

722
00:28:58,080 --> 00:29:00,659
headers and then you find the the IP

723
00:29:00,659 --> 00:29:03,480
address in the logs imagine in the logs

724
00:29:03,480 --> 00:29:06,720
for the system of uh it was the AWS we

725
00:29:06,720 --> 00:29:09,260
can go there

726
00:29:10,799 --> 00:29:11,940
so

727
00:29:11,940 --> 00:29:14,820
when you're the the IP address from the

728
00:29:14,820 --> 00:29:17,460
client is uh in the middle we found that

729
00:29:17,460 --> 00:29:20,279
in the in artwork in uh in with the

730
00:29:20,279 --> 00:29:22,440
email analysis right and then we jumped

731
00:29:22,440 --> 00:29:24,059
on the on the server and we're going

732
00:29:24,059 --> 00:29:25,260
through all the logs there are so many

733
00:29:25,260 --> 00:29:27,840
logs out there and at some point I

734
00:29:27,840 --> 00:29:30,360
started the investigating the user agent

735
00:29:30,360 --> 00:29:33,779
that we saw uh previously from the from

736
00:29:33,779 --> 00:29:34,799
the attack

737
00:29:34,799 --> 00:29:38,100
and uh all of the time it appeared that

738
00:29:38,100 --> 00:29:40,020
all the other requests were done with

739
00:29:40,020 --> 00:29:43,580
this agent the because in uh

740
00:29:43,580 --> 00:29:46,500
yeah we had two infrastructure set up by

741
00:29:46,500 --> 00:29:49,200
the attacker but they mailed was were

742
00:29:49,200 --> 00:29:51,840
sent by this one so this is how I was

743
00:29:51,840 --> 00:29:54,419
able to pinpoint let's say that these

744
00:29:54,419 --> 00:29:55,679
incidents are actually together they're

745
00:29:55,679 --> 00:29:57,679
linked together

746
00:29:57,679 --> 00:30:00,240
the IP address and the user agent

747
00:30:00,240 --> 00:30:02,760
together for this incident it sounds

748
00:30:02,760 --> 00:30:04,919
funny because it's so simple right

749
00:30:04,919 --> 00:30:08,700
because you look at uh and uh a user

750
00:30:08,700 --> 00:30:10,559
rate and say okay these things much but

751
00:30:10,559 --> 00:30:11,940
initially because we didn't have the

752
00:30:11,940 --> 00:30:14,399
visibility that we wanted to we were not

753
00:30:14,399 --> 00:30:15,779
we didn't know what was happening inside

754
00:30:15,779 --> 00:30:17,520
the organization so that's why you

755
00:30:17,520 --> 00:30:19,020
thought it was two different incidents

756
00:30:19,020 --> 00:30:21,840
and these two things actually probably

757
00:30:21,840 --> 00:30:24,779
was one and the mitigation actions

758
00:30:24,779 --> 00:30:26,100
behind that are completely different as

759
00:30:26,100 --> 00:30:28,200
you can imagine business compromise from

760
00:30:28,200 --> 00:30:31,620
a whole domain recovery

761
00:30:31,620 --> 00:30:34,459
okay I think

762
00:30:45,659 --> 00:30:47,159
did you sleep during the incidence

763
00:30:47,159 --> 00:30:48,539
response

764
00:30:48,539 --> 00:30:52,260
no unfortunately no I didn't sleep last

765
00:30:52,260 --> 00:30:53,820
night as well so you can imagine my

766
00:30:53,820 --> 00:30:56,059
whole life

767
00:30:56,520 --> 00:30:58,740
you should sleep more

768
00:30:58,740 --> 00:31:00,419
I can sleep when I die that's what I say

769
00:31:00,419 --> 00:31:03,120
to myself I almost died yesterday but

770
00:31:03,120 --> 00:31:06,260
that's a different story

771
00:31:13,559 --> 00:31:16,260
yeah I believe that concludes oh I have

772
00:31:16,260 --> 00:31:18,899
one last question what is in your

773
00:31:18,899 --> 00:31:20,940
opinion the best size for incident

774
00:31:20,940 --> 00:31:23,700
response team for investigation

775
00:31:23,700 --> 00:31:25,340
for the investigation

776
00:31:25,340 --> 00:31:27,440
I won't say

777
00:31:27,440 --> 00:31:29,880
about how many people you need I would

778
00:31:29,880 --> 00:31:32,640
say how which roles you need you

779
00:31:32,640 --> 00:31:33,779
definitely need someone to speak to the

780
00:31:33,779 --> 00:31:35,460
client an engagement manager call him

781
00:31:35,460 --> 00:31:38,279
whatever you like and then you need to

782
00:31:38,279 --> 00:31:40,679
have at least one or two responders you

783
00:31:40,679 --> 00:31:43,320
will be amazed how much overhead well it

784
00:31:43,320 --> 00:31:44,820
is created once you investigate because

785
00:31:44,820 --> 00:31:46,320
the clients ask questions all the time

786
00:31:46,320 --> 00:31:47,940
what are you doing what's your status

787
00:31:47,940 --> 00:31:49,559
what's your progress stuff like that so

788
00:31:49,559 --> 00:31:52,320
you need to have someone in the between

789
00:31:52,320 --> 00:31:54,240
that match the client expectations it's

790
00:31:54,240 --> 00:31:55,860
really important as well that is

791
00:31:55,860 --> 00:31:58,919
important as well but I would ideally it

792
00:31:58,919 --> 00:32:01,620
would be let's say three to four minimum

793
00:32:01,620 --> 00:32:03,299
and of course that depends on the size

794
00:32:03,299 --> 00:32:06,200
of the organization

795
00:32:08,840 --> 00:32:11,460
other rules yeah you have the responders

796
00:32:11,460 --> 00:32:13,740
yeah the roles I mean you have someone

797
00:32:13,740 --> 00:32:15,779
who's going to be speaking and the ones

798
00:32:15,779 --> 00:32:17,220
that are gonna be like on the technical

799
00:32:17,220 --> 00:32:19,980
side what should they because they the

800
00:32:19,980 --> 00:32:21,480
logic size that's why I say three

801
00:32:21,480 --> 00:32:23,340
persons at least because then you put

802
00:32:23,340 --> 00:32:25,200
extra costs with the utilization aspect

803
00:32:25,200 --> 00:32:26,880
all that stuff you need definitely

804
00:32:26,880 --> 00:32:28,500
someone to be in the meeting between the

805
00:32:28,500 --> 00:32:30,480
client but once you say that you have

806
00:32:30,480 --> 00:32:32,100
three extra person let's say you need to

807
00:32:32,100 --> 00:32:34,260
have different skill sets not all of

808
00:32:34,260 --> 00:32:35,760
them should know for example Windows

809
00:32:35,760 --> 00:32:38,399
someone has to know how to imagine the

810
00:32:38,399 --> 00:32:40,500
Dual in forensics someone has to know

811
00:32:40,500 --> 00:32:42,240
how to do Cloud investigation and this

812
00:32:42,240 --> 00:32:44,460
is how actually this is like the concept

813
00:32:44,460 --> 00:32:46,200
of very team right or very teamers the

814
00:32:46,200 --> 00:32:47,520
attackers no one knows everything there

815
00:32:47,520 --> 00:32:49,620
so why not have the same concept in uh

816
00:32:49,620 --> 00:32:51,779
in forensics everybody expects you to

817
00:32:51,779 --> 00:32:52,919
know everything in this field

818
00:32:52,919 --> 00:32:54,480
unfortunately and that's not the case

819
00:32:54,480 --> 00:32:58,820
that's why we need to collaborate more

820
00:33:07,980 --> 00:33:10,080
yep that concludes the talk thank you

821
00:33:10,080 --> 00:33:11,940
very much

822
00:33:11,940 --> 00:33:12,910
[Applause]

823
00:33:12,910 --> 00:33:41,799
[Music]

