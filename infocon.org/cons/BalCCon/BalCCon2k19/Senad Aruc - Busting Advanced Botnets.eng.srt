1
00:00:25,670 --> 00:00:32,189
ok everybody we're gonna start with our

2
00:00:28,740 --> 00:00:34,260
first talk for today in which Senate is

3
00:00:32,189 --> 00:00:41,910
going to talk about busting advanced

4
00:00:34,260 --> 00:00:43,620
botnets ok so good morning I can see the

5
00:00:41,910 --> 00:00:46,500
track here has a huge impact right I

6
00:00:43,620 --> 00:00:48,000
mean people are still spinning ok so my

7
00:00:46,500 --> 00:00:51,030
name is Senate and I'm based in

8
00:00:48,000 --> 00:00:54,449
Amsterdam so today I want to speak about

9
00:00:51,030 --> 00:00:56,430
my research articles there is a lot of

10
00:00:54,449 --> 00:00:57,449
them so basically what I do in my free

11
00:00:56,430 --> 00:00:59,850
time I used to do this professionally

12
00:00:57,449 --> 00:01:02,220
when I used to work in Italy so we were

13
00:00:59,850 --> 00:01:07,380
going against the botnets and we were

14
00:01:02,220 --> 00:01:12,900
trying to take them down so I just

15
00:01:07,380 --> 00:01:14,520
choose 3 4 of the most advanced ones

16
00:01:12,900 --> 00:01:18,570
right so we all know the botanist but

17
00:01:14,520 --> 00:01:20,670
how add ones they are we really don't do

18
00:01:18,570 --> 00:01:22,490
too much research on that side so I know

19
00:01:20,670 --> 00:01:25,530
there is a lot of colleagues like me

20
00:01:22,490 --> 00:01:27,750
freelancers or individual researchers

21
00:01:25,530 --> 00:01:31,710
that are doing this kind of stuff but

22
00:01:27,750 --> 00:01:34,320
believe me they're the advanced level of

23
00:01:31,710 --> 00:01:35,609
the botanists are really really high

24
00:01:34,320 --> 00:01:40,350
right now I mean they're really complex

25
00:01:35,609 --> 00:01:43,169
so agenda for today I'm going to be very

26
00:01:40,350 --> 00:01:44,908
short I have two demos very short ones I

27
00:01:43,170 --> 00:01:49,009
hope that you guys can see from here so

28
00:01:44,909 --> 00:01:51,390
I'm going to speak first of all the most

29
00:01:49,009 --> 00:01:54,090
annoying question for the cyber security

30
00:01:51,390 --> 00:01:55,890
operations are we are we affected why we

31
00:01:54,090 --> 00:01:58,320
are affected then we're going to see how

32
00:01:55,890 --> 00:02:00,539
to locate the evil and then we're going

33
00:01:58,320 --> 00:02:03,350
to sniffing or peeking into the

34
00:02:00,539 --> 00:02:06,869
cryptolocker command and control center

35
00:02:03,350 --> 00:02:08,310
men in the middle builder command and

36
00:02:06,869 --> 00:02:11,310
control center this is really cool and

37
00:02:08,310 --> 00:02:15,180
then we're going to speak about the NASA

38
00:02:11,310 --> 00:02:18,960
network attached storage from QNAP how

39
00:02:15,180 --> 00:02:21,000
they infected the machines then they put

40
00:02:18,960 --> 00:02:23,850
them to the botnet then we're going to

41
00:02:21,000 --> 00:02:25,710
speak about the Kinze this botnet and

42
00:02:23,850 --> 00:02:27,960
this malware is really unique is is

43
00:02:25,710 --> 00:02:30,300
better than my real a banking

44
00:02:27,960 --> 00:02:32,459
application ok it has better

45
00:02:30,300 --> 00:02:34,080
functionalities and then we're going to

46
00:02:32,459 --> 00:02:36,280
speak about the second factor of they

47
00:02:34,080 --> 00:02:38,320
are there enough to protect or

48
00:02:36,280 --> 00:02:40,330
personal information and especially for

49
00:02:38,320 --> 00:02:42,910
the credit card information and

50
00:02:40,330 --> 00:02:44,590
transactions and then we're going to

51
00:02:42,910 --> 00:02:48,370
show you guys the most advanced botnets

52
00:02:44,590 --> 00:02:50,230
so far that I managed to capture and I'm

53
00:02:48,370 --> 00:02:52,959
going to share you the source code of

54
00:02:50,230 --> 00:02:55,000
this botnet so you guys can play with it

55
00:02:52,959 --> 00:03:00,750
and then we're going to go with the

56
00:02:55,000 --> 00:03:04,390
conclusion about myself so I burn in

57
00:03:00,750 --> 00:03:06,550
ex-yugoslavia okay then I grow up in

58
00:03:04,390 --> 00:03:09,579
Macedonia and right now we called

59
00:03:06,550 --> 00:03:12,010
northern Macedonia okay so currently

60
00:03:09,580 --> 00:03:14,260
living in Amsterdam but you know all

61
00:03:12,010 --> 00:03:16,269
these South Eastern Europe countries

62
00:03:14,260 --> 00:03:17,920
like I mean mostly in Balkans we call

63
00:03:16,270 --> 00:03:20,860
ourselves we have from Balkans right so

64
00:03:17,920 --> 00:03:23,589
that's easier so next time well I start

65
00:03:20,860 --> 00:03:26,580
very early so Commodore 64 was one of my

66
00:03:23,590 --> 00:03:29,410
first PC I remember that time we had a

67
00:03:26,580 --> 00:03:32,440
it was really strange so we had a some

68
00:03:29,410 --> 00:03:33,730
kind of Club where we were pushing they

69
00:03:32,440 --> 00:03:34,680
were pushing actually I was too young at

70
00:03:33,730 --> 00:03:37,840
that time

71
00:03:34,680 --> 00:03:39,340
Commodore games and and some I don't

72
00:03:37,840 --> 00:03:41,019
know texts and stuff that stuff like

73
00:03:39,340 --> 00:03:42,700
that from the FM radio right basically

74
00:03:41,019 --> 00:03:43,989
so we were recording on the magnetic

75
00:03:42,700 --> 00:03:45,910
tapes and they were in there we were

76
00:03:43,989 --> 00:03:47,950
playing the programs in games on the on

77
00:03:45,910 --> 00:03:52,690
the Commodore 64 by the way I'm 40 years

78
00:03:47,950 --> 00:03:55,298
old so when I speak daunting that so

79
00:03:52,690 --> 00:03:57,880
then yeah one of my first hack was the

80
00:03:55,299 --> 00:04:00,220
diverted internet so in Macedonia at

81
00:03:57,880 --> 00:04:01,660
that time when they started to push our

82
00:04:00,220 --> 00:04:03,670
internet it was really expensive it was

83
00:04:01,660 --> 00:04:06,760
around five or six days and much for one

84
00:04:03,670 --> 00:04:09,578
hour and we had this expensive dialing

85
00:04:06,760 --> 00:04:10,929
numbers the premium ones but what was

86
00:04:09,579 --> 00:04:12,670
the strange thing is that when you were

87
00:04:10,930 --> 00:04:15,430
applying for a numbers change they were

88
00:04:12,670 --> 00:04:18,099
not terminating the old number so what I

89
00:04:15,430 --> 00:04:19,780
done I applied for diverting the number

90
00:04:18,100 --> 00:04:22,510
and I diverted my home number to a

91
00:04:19,779 --> 00:04:23,830
premium Internet number and then I went

92
00:04:22,510 --> 00:04:25,090
to the post office and I say okay I

93
00:04:23,830 --> 00:04:27,280
don't like this num but I want to change

94
00:04:25,090 --> 00:04:30,340
it and they give me a new number and all

95
00:04:27,280 --> 00:04:33,159
number state remained on the divert to

96
00:04:30,340 --> 00:04:34,690
the internet so it my home number was in

97
00:04:33,160 --> 00:04:37,150
news every but I think that we made a

98
00:04:34,690 --> 00:04:40,360
Minion's that time everybody was dialing

99
00:04:37,150 --> 00:04:41,919
in a local a fee and then after free

100
00:04:40,360 --> 00:04:43,390
dials it was diverting to the internet

101
00:04:41,919 --> 00:04:45,020
which was really expensive but we didn't

102
00:04:43,390 --> 00:04:48,450
pay anything so that time

103
00:04:45,020 --> 00:04:51,120
yeah 2007 you still can google it one of

104
00:04:48,450 --> 00:04:54,200
my first public hacks it was - so using

105
00:04:51,120 --> 00:04:57,720
simple and I thought yeah it was huge

106
00:04:54,200 --> 00:05:00,630
noise at that time and then I started to

107
00:04:57,720 --> 00:05:02,810
go against the botnets professionally

108
00:05:00,630 --> 00:05:05,190
and individually and like a hobby and

109
00:05:02,810 --> 00:05:07,020
yeah one of my last tax was a bottle

110
00:05:05,190 --> 00:05:08,880
phone Netherlands so basically what they

111
00:05:07,020 --> 00:05:10,950
do is they limit us we cannot put this

112
00:05:08,880 --> 00:05:13,380
modem on a bridge mode but there is a

113
00:05:10,950 --> 00:05:16,620
previous escalation so with a previous

114
00:05:13,380 --> 00:05:19,080
collation using a guest account and they

115
00:05:16,620 --> 00:05:20,340
hide the CSS the bridge button so I

116
00:05:19,080 --> 00:05:22,460
managed to do that they sent me flowers

117
00:05:20,340 --> 00:05:25,500
and they enable a lot of free

118
00:05:22,460 --> 00:05:27,719
pay-per-view channels to me but it was

119
00:05:25,500 --> 00:05:29,670
cool yeah I am a big fan of Metallica

120
00:05:27,720 --> 00:05:35,040
this is from the last concert in

121
00:05:29,670 --> 00:05:38,430
Amsterdam okay so let's go the first

122
00:05:35,040 --> 00:05:40,140
thing are we affected I used to work in

123
00:05:38,430 --> 00:05:43,080
cybersecurity operation centers like a

124
00:05:40,140 --> 00:05:46,530
treasure hunter instant responder team

125
00:05:43,080 --> 00:05:48,180
leads now I am building them so maybe

126
00:05:46,530 --> 00:05:50,219
you guys heard about the biggest airport

127
00:05:48,180 --> 00:05:51,990
in the Istanbul as I was it she parted

128
00:05:50,220 --> 00:05:53,490
for the world cyber security operations

129
00:05:51,990 --> 00:05:55,260
center there so basically I'm coming

130
00:05:53,490 --> 00:05:56,940
from that kind of background and you

131
00:05:55,260 --> 00:05:58,530
know the most unending question in the

132
00:05:56,940 --> 00:05:59,969
morning was when a manager was showing

133
00:05:58,530 --> 00:06:02,099
up and saying hey guys did you saw the

134
00:05:59,970 --> 00:06:04,320
news are we affected right that's the

135
00:06:02,100 --> 00:06:07,050
only thing they do I mean they show up

136
00:06:04,320 --> 00:06:08,580
in the morning and they say you did you

137
00:06:07,050 --> 00:06:11,460
guys saw the new survey affected right

138
00:06:08,580 --> 00:06:13,560
so let me just show you form a simple

139
00:06:11,460 --> 00:06:15,530
threat intelligence platform how we can

140
00:06:13,560 --> 00:06:18,600
come up to this question are we affected

141
00:06:15,530 --> 00:06:21,960
so what I'm going to do I will go just

142
00:06:18,600 --> 00:06:24,570
to the one I cry I will I will check the

143
00:06:21,960 --> 00:06:26,609
Talos block by the way I work for

144
00:06:24,570 --> 00:06:30,170
Cisco's I don't expect me some Cisco

145
00:06:26,610 --> 00:06:30,170
demos okay just classical stuff

146
00:06:30,650 --> 00:06:38,049
and then I'm going to copy my iosys

147
00:06:34,100 --> 00:06:38,050
indication of the compromises right

148
00:06:41,710 --> 00:06:45,489
so as you can see a copied bunch of

149
00:06:43,630 --> 00:06:46,690
irises and I'm going to tell to my truth

150
00:06:45,490 --> 00:06:49,150
Intelligence Platform hey what do you

151
00:06:46,690 --> 00:06:50,620
know about designers okay so this

152
00:06:49,150 --> 00:06:52,120
platform is actually correlated to an

153
00:06:50,620 --> 00:06:53,199
external threat intelligence an internal

154
00:06:52,120 --> 00:06:55,000
one what is happening on your

155
00:06:53,199 --> 00:06:58,020
environment okay so I just searched

156
00:06:55,000 --> 00:07:00,220
around 43 indication of the compromises

157
00:06:58,020 --> 00:07:04,448
wait remove this one is making songs

158
00:07:00,220 --> 00:07:06,490
sound and then yeah are we affected

159
00:07:04,449 --> 00:07:08,259
right so right away I can tell that one

160
00:07:06,490 --> 00:07:10,180
of my machines is already affected okay

161
00:07:08,259 --> 00:07:11,889
so this is the back to back integration

162
00:07:10,180 --> 00:07:13,840
this is something that every company

163
00:07:11,889 --> 00:07:15,039
needs to build today so the wall cyber

164
00:07:13,840 --> 00:07:16,330
security technologies they need to

165
00:07:15,039 --> 00:07:17,469
connect to each other they need to share

166
00:07:16,330 --> 00:07:20,440
threat intelligence they need to share

167
00:07:17,470 --> 00:07:21,090
contacts events to each other right so

168
00:07:20,440 --> 00:07:25,449
it's coming

169
00:07:21,090 --> 00:07:29,948
40:25 so let me just wait this one to

170
00:07:25,449 --> 00:07:32,199
finish I'm sure that we all know multigo

171
00:07:29,949 --> 00:07:34,750
right well I call this time multigrain

172
00:07:32,199 --> 00:07:36,520
muscles because it's using a huge cloud

173
00:07:34,750 --> 00:07:38,919
power behind and the world threat

174
00:07:36,520 --> 00:07:42,190
intelligence that you can collect of

175
00:07:38,919 --> 00:07:45,280
course again this is this is the one of

176
00:07:42,190 --> 00:07:47,919
the one of the let's say most integrated

177
00:07:45,280 --> 00:07:53,080
platform that you can that you can play

178
00:07:47,919 --> 00:07:56,349
with it right now so here we go yeah all

179
00:07:53,080 --> 00:07:58,599
43 is searching one single action so

180
00:07:56,349 --> 00:08:00,400
base is just copypasta right now I can

181
00:07:58,599 --> 00:08:02,500
see that two machines infected I want to

182
00:08:00,400 --> 00:08:05,979
jump to one of them machine here and as

183
00:08:02,500 --> 00:08:08,289
you can see all those arrows here that

184
00:08:05,979 --> 00:08:10,270
context actually is telling me hey this

185
00:08:08,289 --> 00:08:13,090
machine is targeted by this file and

186
00:08:10,270 --> 00:08:16,299
this file is parent of this file here

187
00:08:13,090 --> 00:08:18,400
and this bad file is again parent of

188
00:08:16,300 --> 00:08:20,590
this fellow is executed by this bad file

189
00:08:18,400 --> 00:08:22,929
so basically you can go to the root cows

190
00:08:20,590 --> 00:08:25,210
seeing who is executing who and who is

191
00:08:22,930 --> 00:08:27,880
attacking my machines right so this

192
00:08:25,210 --> 00:08:31,719
famous answer are we affected yes we are

193
00:08:27,880 --> 00:08:33,490
affected but we are not stopping here so

194
00:08:31,720 --> 00:08:34,659
the first thing what I do every morning

195
00:08:33,490 --> 00:08:37,599
and I'm sure that everybody does right

196
00:08:34,659 --> 00:08:41,260
it's going to Twitter and check in the

197
00:08:37,599 --> 00:08:45,370
open dear hashtag open their hashtag is

198
00:08:41,260 --> 00:08:48,790
actually researchers who are publishing

199
00:08:45,370 --> 00:08:51,040
all zero day findings regarding their

200
00:08:48,790 --> 00:08:53,620
researches okay so basically as you can

201
00:08:51,040 --> 00:08:55,060
see everybody is publishing since it's

202
00:08:53,620 --> 00:08:56,830
informations

203
00:08:55,060 --> 00:08:58,119
zero-day malware Mulder who's doesn't

204
00:08:56,830 --> 00:08:59,620
have any disposition and stuff like that

205
00:08:58,120 --> 00:09:01,840
so you're reading right so I'm reading

206
00:08:59,620 --> 00:09:03,490
the news maybe I'm in the restroom right

207
00:09:01,840 --> 00:09:06,520
now right sitting and reading my news

208
00:09:03,490 --> 00:09:08,320
everyday and then yeah you know like a

209
00:09:06,520 --> 00:09:11,020
security guy like a guy who used to work

210
00:09:08,320 --> 00:09:18,370
in socks I'm asking myself right now hey

211
00:09:11,020 --> 00:09:20,680
is any of those non detect that or fresh

212
00:09:18,370 --> 00:09:24,390
zero day indication of the compromises

213
00:09:20,680 --> 00:09:27,670
in my company okay so I'm affected of

214
00:09:24,390 --> 00:09:29,080
all of this file this information that I

215
00:09:27,670 --> 00:09:31,630
am reading here so it contains IP

216
00:09:29,080 --> 00:09:34,420
addresses domain name sha-256 anything

217
00:09:31,630 --> 00:09:35,920
can be IRC there is a simple button if I

218
00:09:34,420 --> 00:09:37,630
click the button here the threat

219
00:09:35,920 --> 00:09:39,520
response what we're going to do is going

220
00:09:37,630 --> 00:09:43,210
to grab all the i/o sis from the patch

221
00:09:39,520 --> 00:09:45,910
page that I just scroll down so he's

222
00:09:43,210 --> 00:09:47,650
done have the ally OCS that I was

223
00:09:45,910 --> 00:09:50,709
reading on my news and I'm going to say

224
00:09:47,650 --> 00:09:52,720
hey I am affected from those Isis and

225
00:09:50,710 --> 00:09:54,910
here we go so from one single button I

226
00:09:52,720 --> 00:09:56,710
can see if I am affected on that okay so

227
00:09:54,910 --> 00:10:04,780
this is helping a lot in threat hunting

228
00:09:56,710 --> 00:10:07,450
yes this is this is 13,000 spots on the

229
00:10:04,780 --> 00:10:08,860
threat intelligence platform yep but the

230
00:10:07,450 --> 00:10:13,180
trick here is that the button here

231
00:10:08,860 --> 00:10:15,550
actually is copying all the IOC's from

232
00:10:13,180 --> 00:10:17,290
the web page source and it's coming to

233
00:10:15,550 --> 00:10:19,719
your environment and is analyzing you

234
00:10:17,290 --> 00:10:22,900
see I just analyzed 24 24 and I'm not

235
00:10:19,720 --> 00:10:25,390
affected so basically if I want to see

236
00:10:22,900 --> 00:10:27,160
if let's say IP address right this IP

237
00:10:25,390 --> 00:10:29,020
address is a C&C server it's on my own

238
00:10:27,160 --> 00:10:30,640
environment what I do I go to my nation

239
00:10:29,020 --> 00:10:32,290
firewalls and there's an IPS is right

240
00:10:30,640 --> 00:10:35,290
and I'm searching that one right now

241
00:10:32,290 --> 00:10:36,670
what will happen if I have 25 of them so

242
00:10:35,290 --> 00:10:38,500
this is the cool thing when you click a

243
00:10:36,670 --> 00:10:39,849
button and then it's extracting all the

244
00:10:38,500 --> 00:10:42,100
diocese as you can see here

245
00:10:39,850 --> 00:10:44,260
automatically from the web page it can

246
00:10:42,100 --> 00:10:46,030
be your technology or it can be open

247
00:10:44,260 --> 00:10:48,370
Sint or whatever it is and then I

248
00:10:46,030 --> 00:10:49,990
automatically query my all endpoints all

249
00:10:48,370 --> 00:10:52,300
my email gets waste network gateways

250
00:10:49,990 --> 00:10:54,610
proxy gateways a nice figure right right

251
00:10:52,300 --> 00:10:56,140
away if I am affect that I know or not

252
00:10:54,610 --> 00:10:58,089
so as you can see I don't have any heat

253
00:10:56,140 --> 00:11:02,620
so far but I know that a lot of them are

254
00:10:58,089 --> 00:11:05,030
bad unknown and non good no coming back

255
00:11:02,620 --> 00:11:07,640
to my slides

256
00:11:05,030 --> 00:11:10,220
so you know this are we affected

257
00:11:07,640 --> 00:11:12,380
question is really really fast right now

258
00:11:10,220 --> 00:11:13,700
to answer it so why not affect it right

259
00:11:12,380 --> 00:11:15,500
so that's there's a cool thing like we

260
00:11:13,700 --> 00:11:17,720
all have a V and stuff like that you

261
00:11:15,500 --> 00:11:19,670
know why we are getting hacked every day

262
00:11:17,720 --> 00:11:22,040
even we have all this expensive next and

263
00:11:19,670 --> 00:11:23,390
next and next and devices right the simp

264
00:11:22,040 --> 00:11:25,939
the reason is very simple because

265
00:11:23,390 --> 00:11:28,310
defense-in-depth is broken why it's

266
00:11:25,940 --> 00:11:30,650
broken because the fencing that works in

267
00:11:28,310 --> 00:11:32,329
very very basic way sexual actual

268
00:11:30,650 --> 00:11:35,360
application whitelisting right so i know

269
00:11:32,330 --> 00:11:37,520
what is good based on this position i'm

270
00:11:35,360 --> 00:11:40,600
going to allow them to get came in i'm

271
00:11:37,520 --> 00:11:44,780
going to block what i know what is bad

272
00:11:40,600 --> 00:11:47,170
right you do guys ever seen a zero-day

273
00:11:44,780 --> 00:11:50,600
or unknown model which is unknown good

274
00:11:47,170 --> 00:11:52,459
or which is unknown bad right so then

275
00:11:50,600 --> 00:11:55,780
it's not a zero-day right so the unknown

276
00:11:52,460 --> 00:11:57,920
files are actually penetrating the wall

277
00:11:55,780 --> 00:12:00,339
defense in that strategy that we are

278
00:11:57,920 --> 00:12:03,920
putting in our own companies and they're

279
00:12:00,340 --> 00:12:07,160
pushing everybody to end up hacked or

280
00:12:03,920 --> 00:12:10,219
compromised ok so again this unknown

281
00:12:07,160 --> 00:12:11,420
files are making defense in that broken

282
00:12:10,220 --> 00:12:14,560
for that reason we need to have

283
00:12:11,420 --> 00:12:18,199
something which can deal with all of us

284
00:12:14,560 --> 00:12:20,420
so let's go and locate the evil actually

285
00:12:18,200 --> 00:12:23,540
so as you remember I made yeah I

286
00:12:20,420 --> 00:12:25,160
searched my wall and wall endpoints here

287
00:12:23,540 --> 00:12:27,290
right so one of my machines as you can

288
00:12:25,160 --> 00:12:31,250
see here he is affected by the one I try

289
00:12:27,290 --> 00:12:35,120
I want to go and see what happened with

290
00:12:31,250 --> 00:12:36,260
this machine when wanna cry got hit so

291
00:12:35,120 --> 00:12:39,740
I'm going to jump to the device

292
00:12:36,260 --> 00:12:41,900
trajectory which is actually a idea

293
00:12:39,740 --> 00:12:43,190
right we all know ideas I don't care

294
00:12:41,900 --> 00:12:45,470
which one you're going to use but you

295
00:12:43,190 --> 00:12:47,720
need to have something like this so

296
00:12:45,470 --> 00:12:49,220
basically I want to go back in the time

297
00:12:47,720 --> 00:12:51,890
right now I'm going to scroll down

298
00:12:49,220 --> 00:12:56,210
hope you guys are not seeing this I'm

299
00:12:51,890 --> 00:12:59,089
not sure why because it's like this

300
00:12:56,210 --> 00:13:01,160
yep so I'm going to back now so what

301
00:12:59,089 --> 00:13:02,990
I've done actually I went to my effect

302
00:13:01,160 --> 00:13:05,930
infected machine here and then I just

303
00:13:02,990 --> 00:13:08,600
opened device trajectory yeah this is

304
00:13:05,930 --> 00:13:11,120
anatomy of wanna cry so basically we can

305
00:13:08,600 --> 00:13:13,520
go back in the time and we can see how

306
00:13:11,120 --> 00:13:14,600
one a cries infecting this machine so I

307
00:13:13,520 --> 00:13:16,850
hope that you guys can see I know that

308
00:13:14,600 --> 00:13:18,440
this one here has a issue so as you can

309
00:13:16,850 --> 00:13:20,000
see here a known good process is

310
00:13:18,440 --> 00:13:22,040
dropping a lot of files the plus button

311
00:13:20,000 --> 00:13:23,600
here is dropping a files right so he's

312
00:13:22,040 --> 00:13:25,640
dropping a lot of files here as you can

313
00:13:23,600 --> 00:13:27,709
see which doesn't make any sense because

314
00:13:25,640 --> 00:13:29,990
unless SX is not dropping the files

315
00:13:27,709 --> 00:13:32,089
right and then he's executing a house

316
00:13:29,990 --> 00:13:33,649
disappeared the eternal bull a dream

317
00:13:32,089 --> 00:13:35,540
code execution for I see basically is

318
00:13:33,649 --> 00:13:38,540
forcing LSS exit to drop files into

319
00:13:35,540 --> 00:13:41,599
execute a house so if I go in a time

320
00:13:38,540 --> 00:13:43,880
right now so this is a time travel

321
00:13:41,600 --> 00:13:45,440
machine so I want to scroll in the time

322
00:13:43,880 --> 00:13:47,720
and to see what is happening on this

323
00:13:45,440 --> 00:13:50,660
machine so now I can see that he is

324
00:13:47,720 --> 00:13:52,820
running Attribution access to hide the

325
00:13:50,660 --> 00:13:56,420
files that he is dropping so one a

326
00:13:52,820 --> 00:13:58,970
Christ extremely extremely smart okay so

327
00:13:56,420 --> 00:14:01,010
he's hiding the files and then he is

328
00:13:58,970 --> 00:14:02,959
running I call sex a and he is preparing

329
00:14:01,010 --> 00:14:05,300
read and write permissions because he's

330
00:14:02,959 --> 00:14:07,339
going to encrypt everything right so he

331
00:14:05,300 --> 00:14:10,339
dropped the files he is hiding them and

332
00:14:07,339 --> 00:14:11,510
he is preparing the machine for for

333
00:14:10,339 --> 00:14:13,100
encryption and look what is happening

334
00:14:11,510 --> 00:14:15,080
now the encryption is happening so

335
00:14:13,100 --> 00:14:16,670
moving copying moving this is movement

336
00:14:15,080 --> 00:14:20,230
right so we can detect all kind of

337
00:14:16,670 --> 00:14:22,550
movements I mean any idea can do this

338
00:14:20,230 --> 00:14:25,130
that's it and this is a real machine

339
00:14:22,550 --> 00:14:27,109
it's not a sandbox by the way so copying

340
00:14:25,130 --> 00:14:30,080
done what he is doing now he is running

341
00:14:27,110 --> 00:14:32,300
toward ok now he needs to exchange the

342
00:14:30,080 --> 00:14:34,490
keys right and then out bone connection

343
00:14:32,300 --> 00:14:37,250
to the tour the keys are exchanged and

344
00:14:34,490 --> 00:14:38,990
for this machine is game over right

345
00:14:37,250 --> 00:14:41,180
the machine is act and it's encrypted

346
00:14:38,990 --> 00:14:43,310
and it's not stopping years so basically

347
00:14:41,180 --> 00:14:45,650
he is deleting the shadow copies right

348
00:14:43,310 --> 00:14:47,660
so is there within the shadow copies and

349
00:14:45,650 --> 00:14:50,209
doing persistency with the register and

350
00:14:47,660 --> 00:14:54,319
stuff like that so what we saw here

351
00:14:50,209 --> 00:14:56,449
actually was infection anatomy so how

352
00:14:54,320 --> 00:15:02,060
one appris infecting all these machines

353
00:14:56,450 --> 00:15:04,459
now let's go to one of famous botanist

354
00:15:02,060 --> 00:15:07,390
that time this was 2014 I agree with

355
00:15:04,459 --> 00:15:10,029
really 2013 actually September

356
00:15:07,390 --> 00:15:11,980
but it was one of the first ransomware

357
00:15:10,029 --> 00:15:13,240
attacks in the world that time so what

358
00:15:11,980 --> 00:15:15,279
was happening there was the infection

359
00:15:13,240 --> 00:15:18,160
probably infection process right so they

360
00:15:15,279 --> 00:15:21,490
use a PNG image with a VB visual basic

361
00:15:18,160 --> 00:15:22,899
code inside they were using obstacle and

362
00:15:21,490 --> 00:15:25,540
actually this is very cool because

363
00:15:22,899 --> 00:15:27,519
they're using vim port and VSS admin to

364
00:15:25,540 --> 00:15:29,890
deliver the attack right and what they

365
00:15:27,519 --> 00:15:32,260
why they do this is because vim world

366
00:15:29,890 --> 00:15:34,750
dot X and VSS that mean is a legitimate

367
00:15:32,260 --> 00:15:36,339
non good application at windows right so

368
00:15:34,750 --> 00:15:38,470
nobody's monitoring them no AV no

369
00:15:36,339 --> 00:15:41,470
nothing right so this is the one wave

370
00:15:38,470 --> 00:15:43,420
like right now PowerShell and W script

371
00:15:41,470 --> 00:15:45,450
and other things are heavily heavily

372
00:15:43,420 --> 00:15:49,750
heavily used to compromise the machines

373
00:15:45,450 --> 00:15:52,089
so after we receive the intelligence we

374
00:15:49,750 --> 00:15:53,680
can't get we went outside and we were

375
00:15:52,089 --> 00:15:55,269
chasing the botanist so we managed to

376
00:15:53,680 --> 00:15:58,300
get inside what we found inside is

377
00:15:55,269 --> 00:16:01,540
really amazing so they admin portal they

378
00:15:58,300 --> 00:16:03,699
have a user portal they have all the

379
00:16:01,540 --> 00:16:06,279
settings about the botanist so this is a

380
00:16:03,700 --> 00:16:09,640
botnet where you can rent around

381
00:16:06,279 --> 00:16:11,680
somewhere attack okay then what you do

382
00:16:09,640 --> 00:16:13,180
you define your country's which

383
00:16:11,680 --> 00:16:14,829
countries you're going to target this is

384
00:16:13,180 --> 00:16:17,109
all real data from the botnet by the way

385
00:16:14,829 --> 00:16:19,390
you define the amount how much is going

386
00:16:17,110 --> 00:16:21,579
to ask from your victims you're going to

387
00:16:19,390 --> 00:16:23,319
be found after amount right so you give

388
00:16:21,579 --> 00:16:24,579
me ten dollars in ten hours after that

389
00:16:23,320 --> 00:16:27,850
we're going to became twenty hours

390
00:16:24,579 --> 00:16:30,729
twenty dollars okay or little of liter

391
00:16:27,850 --> 00:16:32,589
of rakia right I mean and then you

392
00:16:30,730 --> 00:16:35,800
choose the currency you can it can be

393
00:16:32,589 --> 00:16:37,510
any currency right so this ransom as a

394
00:16:35,800 --> 00:16:41,019
service was really powerful basically

395
00:16:37,510 --> 00:16:42,910
right then what you do you go and you

396
00:16:41,019 --> 00:16:44,949
define your email for where you're going

397
00:16:42,910 --> 00:16:46,779
to receive the payments toward URL for

398
00:16:44,949 --> 00:16:48,479
the extension of the key is the time how

399
00:16:46,779 --> 00:16:50,740
much you're going to give them

400
00:16:48,480 --> 00:16:52,329
decryption application right so you want

401
00:16:50,740 --> 00:16:54,699
to give them some sample depiction for

402
00:16:52,329 --> 00:16:56,260
free so they can be sure that they would

403
00:16:54,699 --> 00:16:59,229
receive their files back so you can do

404
00:16:56,260 --> 00:17:00,850
also this kind of stuff your wallet ID

405
00:16:59,230 --> 00:17:02,860
were you going to receive the bitcoins

406
00:17:00,850 --> 00:17:04,809
and IV vector right this is specially

407
00:17:02,860 --> 00:17:08,380
for against against the brute-force

408
00:17:04,809 --> 00:17:10,149
attacks for your keys what we had

409
00:17:08,380 --> 00:17:13,120
insight so we found a lot of mails we

410
00:17:10,150 --> 00:17:14,620
found a lot of SMTP accounts and we have

411
00:17:13,119 --> 00:17:15,010
found a lot of errors so they were key

412
00:17:14,619 --> 00:17:17,889
key key

413
00:17:15,010 --> 00:17:19,650
keeping a full wikipedia for for the

414
00:17:17,890 --> 00:17:22,230
errors right so they make sure

415
00:17:19,650 --> 00:17:23,449
that there will be no problem during the

416
00:17:22,230 --> 00:17:26,760
infection phase right

417
00:17:23,449 --> 00:17:28,890
so inside of these folders we saw a lot

418
00:17:26,760 --> 00:17:33,320
of him victims I mean a lot of lot of

419
00:17:28,890 --> 00:17:36,990
encrypted machines what else we saw

420
00:17:33,320 --> 00:17:39,090
26,000 victims so there was a so it was

421
00:17:36,990 --> 00:17:41,220
very cool they have a great britain

422
00:17:39,090 --> 00:17:43,350
Espania italian netherlands email

423
00:17:41,220 --> 00:17:45,420
addresses all pure targeted with their

424
00:17:43,350 --> 00:17:47,760
own local language in their own girl

425
00:17:45,420 --> 00:17:51,600
location with their own currency

426
00:17:47,760 --> 00:17:53,700
everything was perfectly built they had

427
00:17:51,600 --> 00:17:56,010
a health portal here we extracted a lot

428
00:17:53,700 --> 00:17:58,140
of people were they writing here like

429
00:17:56,010 --> 00:18:00,240
after you the money where is my files

430
00:17:58,140 --> 00:18:02,610
right so this is again another proof

431
00:18:00,240 --> 00:18:03,870
that Spain to them is a problem all

432
00:18:02,610 --> 00:18:07,678
you're going to receive your money or

433
00:18:03,870 --> 00:18:09,570
not right so here is a people which you

434
00:18:07,679 --> 00:18:11,429
know they never received their files

435
00:18:09,570 --> 00:18:13,500
back even if they paid so they keep this

436
00:18:11,429 --> 00:18:16,110
kind of help portal right so you can

437
00:18:13,500 --> 00:18:17,550
reach out to them some impact so they

438
00:18:16,110 --> 00:18:19,169
collected sixty four thousand dollars

439
00:18:17,550 --> 00:18:20,730
for a couple of days while this attack

440
00:18:19,170 --> 00:18:22,050
was hot and then we didn't monitor them

441
00:18:20,730 --> 00:18:24,270
because we take down the scenes in

442
00:18:22,050 --> 00:18:27,149
server and then you know they come up

443
00:18:24,270 --> 00:18:29,790
somewhere else but who knows where yeah

444
00:18:27,150 --> 00:18:32,880
this was one of the let's say around

445
00:18:29,790 --> 00:18:34,710
summer again you know we all sing the

446
00:18:32,880 --> 00:18:36,330
hype of ransomware attacks right now

447
00:18:34,710 --> 00:18:39,059
this years why everybody thinks that hey

448
00:18:36,330 --> 00:18:41,850
there is a big money Runciman right well

449
00:18:39,059 --> 00:18:43,559
yes and there is another story about the

450
00:18:41,850 --> 00:18:44,820
runs over because do it to deliver

451
00:18:43,559 --> 00:18:47,399
around somewhere attack you do need to

452
00:18:44,820 --> 00:18:49,590
be a top-notch developer right because

453
00:18:47,400 --> 00:18:51,360
to create to steal a credit card

454
00:18:49,590 --> 00:18:52,919
information you need to have a lot of

455
00:18:51,360 --> 00:18:54,419
things you need to build them in the

456
00:18:52,920 --> 00:18:56,429
middle browser data you need to bypass

457
00:18:54,420 --> 00:18:59,010
the second factor to steal the credit

458
00:18:56,429 --> 00:19:01,440
that informations you need to burn some

459
00:18:59,010 --> 00:19:03,030
zero-days privilege escalations and blah

460
00:19:01,440 --> 00:19:04,470
blah blah right right with ransomware

461
00:19:03,030 --> 00:19:06,270
you can just rent it for hundred dollars

462
00:19:04,470 --> 00:19:08,190
and you can infect all your audio family

463
00:19:06,270 --> 00:19:12,990
right if you need the money for for some

464
00:19:08,190 --> 00:19:16,980
vacation so another one which was very

465
00:19:12,990 --> 00:19:19,980
interesting you know sometimes we want

466
00:19:16,980 --> 00:19:23,220
to build a mother right but we don't

467
00:19:19,980 --> 00:19:25,140
know how to do it I mean as I mentioned

468
00:19:23,220 --> 00:19:26,880
before the dropper developer can be

469
00:19:25,140 --> 00:19:28,590
different the payload different the men

470
00:19:26,880 --> 00:19:29,820
in the middle profit a guy who is doing

471
00:19:28,590 --> 00:19:31,379
that kind of stuff is different right

472
00:19:29,820 --> 00:19:33,270
and if you don't know to do that

473
00:19:31,380 --> 00:19:36,090
actually you can go to this bottom

474
00:19:33,270 --> 00:19:38,700
and this is a wizard where you can click

475
00:19:36,090 --> 00:19:40,860
next next next and you can build your

476
00:19:38,700 --> 00:19:46,380
own men in the middle browser attack

477
00:19:40,860 --> 00:19:48,120
plugin so let me just show you here

478
00:19:46,380 --> 00:19:50,670
basically you're going to select which

479
00:19:48,120 --> 00:19:53,699
bank what you want to do which country

480
00:19:50,670 --> 00:19:56,760
which operating system which browser etc

481
00:19:53,700 --> 00:19:58,170
etc and then what you do actually you

482
00:19:56,760 --> 00:20:01,620
are building your own man-in-the-middle

483
00:19:58,170 --> 00:20:03,270
brothel attack like in lego okay so you

484
00:20:01,620 --> 00:20:05,610
choose what you want to show them so

485
00:20:03,270 --> 00:20:08,250
here i can you can see you can choose i

486
00:20:05,610 --> 00:20:10,290
don't know what to show like a ten to

487
00:20:08,250 --> 00:20:11,550
them hold a login button size you can

488
00:20:10,290 --> 00:20:14,010
see here you can hold him a couple of

489
00:20:11,550 --> 00:20:15,300
minutes in the app after you can you can

490
00:20:14,010 --> 00:20:16,620
you're going to still in money and then

491
00:20:15,300 --> 00:20:18,889
you're going to forward in a real bank

492
00:20:16,620 --> 00:20:21,149
so basically you don't need to be a

493
00:20:18,890 --> 00:20:23,550
really good guy or a really good

494
00:20:21,150 --> 00:20:25,920
developer right that bad good developer

495
00:20:23,550 --> 00:20:28,860
let's put this way to develop C&C

496
00:20:25,920 --> 00:20:32,130
servers i mean you can rent them and

497
00:20:28,860 --> 00:20:33,929
then now you can still rent i mean in

498
00:20:32,130 --> 00:20:36,750
the middle of rocket attack so again you

499
00:20:33,930 --> 00:20:38,610
can you can you can push him to a

500
00:20:36,750 --> 00:20:40,350
question you can ask him something you

501
00:20:38,610 --> 00:20:42,679
can follow-up forward into somewhere

502
00:20:40,350 --> 00:20:46,439
else you can push in my error question

503
00:20:42,680 --> 00:20:48,150
java halt error login so you can kick

504
00:20:46,440 --> 00:20:50,700
him out and then you can confirm that

505
00:20:48,150 --> 00:20:52,050
the transaction is done so in place that

506
00:20:50,700 --> 00:20:54,210
you are paying your bills for

507
00:20:52,050 --> 00:20:55,680
electricity but in the background

508
00:20:54,210 --> 00:20:57,750
actually your money goes to somewhere

509
00:20:55,680 --> 00:20:58,980
else and you don't see it okay because

510
00:20:57,750 --> 00:21:01,920
it's made in the middle processor type

511
00:20:58,980 --> 00:21:04,050
so it's game over again this botanist

512
00:21:01,920 --> 00:21:06,270
was really really I mean granola I'm

513
00:21:04,050 --> 00:21:09,360
going to share you guys slides because

514
00:21:06,270 --> 00:21:11,070
this is research articles so going every

515
00:21:09,360 --> 00:21:12,540
single step will take a long long time

516
00:21:11,070 --> 00:21:14,790
so I'm just trying to tell you guys the

517
00:21:12,540 --> 00:21:16,920
most important functions but if you want

518
00:21:14,790 --> 00:21:18,389
to see deeper then I'm going to share

519
00:21:16,920 --> 00:21:21,780
the link and you can see all the

520
00:21:18,390 --> 00:21:24,650
functionalities of this botnet yeah next

521
00:21:21,780 --> 00:21:27,410
one this was really cool actually

522
00:21:24,650 --> 00:21:29,970
you know the shellshock right is a huge

523
00:21:27,410 --> 00:21:34,430
noise in the world she'll social special

524
00:21:29,970 --> 00:21:37,080
attack so basically this tune-up nass

525
00:21:34,430 --> 00:21:39,810
devices they got hit by a shell shock

526
00:21:37,080 --> 00:21:42,270
attack and was the important thing here

527
00:21:39,810 --> 00:21:44,190
is that which I really like is like they

528
00:21:42,270 --> 00:21:45,440
do massive shells of vulnerability

529
00:21:44,190 --> 00:21:47,539
scanning

530
00:21:45,440 --> 00:21:50,710
and then they deploy the pay lot and

531
00:21:47,539 --> 00:21:51,919
then they patch against the

532
00:21:50,710 --> 00:21:53,600
shell-shocked

533
00:21:51,919 --> 00:21:54,799
so they meant they want to make sure

534
00:21:53,600 --> 00:21:57,049
that they're going to own the device but

535
00:21:54,799 --> 00:22:01,090
not somebody else right and then they

536
00:21:57,049 --> 00:22:04,879
are arming the NAS device to doing the

537
00:22:01,090 --> 00:22:06,830
DDoS attacks and then using that same

538
00:22:04,879 --> 00:22:09,649
Nass device to scan and hack other

539
00:22:06,830 --> 00:22:11,840
devices so you can imagine I mean you

540
00:22:09,649 --> 00:22:14,539
just need to infect oneness do not

541
00:22:11,840 --> 00:22:16,668
tune-up NAS device network attached

542
00:22:14,539 --> 00:22:20,450
storage device and then that one going

543
00:22:16,669 --> 00:22:22,309
to start hacking other QNAP devices what

544
00:22:20,450 --> 00:22:25,490
we found inside we found the first stage

545
00:22:22,309 --> 00:22:27,350
so this is the shell script right so

546
00:22:25,490 --> 00:22:29,509
basically is coming from this address

547
00:22:27,350 --> 00:22:31,580
here is going to the temp and then it's

548
00:22:29,509 --> 00:22:33,860
executed here we have a second stage

549
00:22:31,580 --> 00:22:37,220
when actually the CGI script is coming

550
00:22:33,860 --> 00:22:38,840
in and is entering a backdoor right so

551
00:22:37,220 --> 00:22:41,840
he's having another user on the machine

552
00:22:38,840 --> 00:22:44,480
and then he is patching the machine this

553
00:22:41,840 --> 00:22:47,600
is really cool and then he is moving to

554
00:22:44,480 --> 00:22:50,360
autopilot where he's starting to go and

555
00:22:47,600 --> 00:22:52,969
search and hack other cleanup devices

556
00:22:50,360 --> 00:22:54,408
this was really unique I mean we we

557
00:22:52,970 --> 00:22:57,250
informed tune-up I think that they

558
00:22:54,409 --> 00:22:59,809
patched up for six months I think and I

559
00:22:57,250 --> 00:23:01,850
still think that there is a lot of IOT

560
00:22:59,809 --> 00:23:04,220
devices or this kind of NAS devices in

561
00:23:01,850 --> 00:23:05,629
the world we can check it on often the

562
00:23:04,220 --> 00:23:09,470
showdown which still is not patched

563
00:23:05,629 --> 00:23:12,080
against the shell shock attacks so as

564
00:23:09,470 --> 00:23:14,509
you can see here yeah second stage and

565
00:23:12,080 --> 00:23:17,389
then he is arming inside the second

566
00:23:14,509 --> 00:23:18,830
stage actually yeah we extracted the CJS

567
00:23:17,389 --> 00:23:20,899
script and as you can see here it has a

568
00:23:18,830 --> 00:23:22,908
dot well this time this was a DDoS right

569
00:23:20,899 --> 00:23:25,189
so what they do you know when you own

570
00:23:22,909 --> 00:23:26,659
twenty five thirty thousand of kin up

571
00:23:25,190 --> 00:23:28,519
devices right so you can do whatever you

572
00:23:26,659 --> 00:23:30,230
want you push up a lot with the DDoS you

573
00:23:28,519 --> 00:23:33,529
do videos next that you push a payload

574
00:23:30,230 --> 00:23:35,570
for Bitcoin mining then you can push

575
00:23:33,529 --> 00:23:37,429
another payload I don't know whatever

576
00:23:35,570 --> 00:23:40,809
whatever it is right so basically you

577
00:23:37,429 --> 00:23:40,809
can you can use them multiple times

578
00:23:40,990 --> 00:23:45,320
yeah and then it's not another CGI

579
00:23:43,580 --> 00:23:47,059
backdoor so basically we can control the

580
00:23:45,320 --> 00:23:50,960
cleanup device from anywhere in the

581
00:23:47,059 --> 00:23:54,019
world how is my timing okay do I speak

582
00:23:50,960 --> 00:23:56,940
fast I'm getting excited and stop me

583
00:23:54,019 --> 00:24:00,570
so what about Kings I mean I like this

584
00:23:56,940 --> 00:24:03,330
one you know I'm using my banking

585
00:24:00,570 --> 00:24:06,499
application i.e banking applications

586
00:24:03,330 --> 00:24:09,210
here in Vulcan sucks I know them okay so

587
00:24:06,499 --> 00:24:12,509
and some of the European banks they also

588
00:24:09,210 --> 00:24:14,100
have I don't know decent banking

589
00:24:12,509 --> 00:24:15,509
applications but these guys here they

590
00:24:14,100 --> 00:24:21,149
build a massive one let me just show you

591
00:24:15,509 --> 00:24:24,149
so this is malware from the King's

592
00:24:21,149 --> 00:24:26,039
family with a CNC server which is acting

593
00:24:24,149 --> 00:24:29,459
like a banking application as you can

594
00:24:26,039 --> 00:24:31,049
see here you have the victims then you

595
00:24:29,460 --> 00:24:34,559
have how many money they have in their

596
00:24:31,049 --> 00:24:36,929
accounts you can see the body and then

597
00:24:34,559 --> 00:24:38,789
you can see if the engine for stealing

598
00:24:36,929 --> 00:24:42,330
automatic money from them is starting or

599
00:24:38,789 --> 00:24:44,220
not so you say like this hey I have I

600
00:24:42,330 --> 00:24:46,978
don't know ten thousand infected victims

601
00:24:44,220 --> 00:24:49,919
go to them and grab only 10% of their

602
00:24:46,979 --> 00:24:51,479
money every month using pure man in the

603
00:24:49,919 --> 00:24:53,309
middle drops to attack the pure guy is

604
00:24:51,479 --> 00:24:56,309
paying every month their bills but

605
00:24:53,309 --> 00:25:00,749
behind the money goes to the Cork's but

606
00:24:56,309 --> 00:25:03,269
what you do then you go and you define

607
00:25:00,749 --> 00:25:04,830
your crews here so who is the guy who

608
00:25:03,269 --> 00:25:08,609
going to receive the money The Dropper

609
00:25:04,830 --> 00:25:10,710
guy his ebin account how much will be

610
00:25:08,609 --> 00:25:13,678
your split with him thirty fifty or I

611
00:25:10,710 --> 00:25:17,309
don't know fifty fifty or seventy thirty

612
00:25:13,679 --> 00:25:19,409
I mean so you define your victims you

613
00:25:17,309 --> 00:25:21,178
define how much money you're going to

614
00:25:19,409 --> 00:25:22,799
steal from the victims you define who is

615
00:25:21,179 --> 00:25:25,229
the guy who going to wash the money

616
00:25:22,799 --> 00:25:27,539
right we call them crooks and it's full

617
00:25:25,229 --> 00:25:30,539
automatic you just set up this and then

618
00:25:27,539 --> 00:25:31,889
the system works so here's the cooks he

619
00:25:30,539 --> 00:25:32,970
this as you can see on the right side

620
00:25:31,889 --> 00:25:35,699
that I'm going to show you again how

621
00:25:32,970 --> 00:25:39,989
much money they steal from the guys they

622
00:25:35,700 --> 00:25:41,369
keep some very nice buckless I mean they

623
00:25:39,989 --> 00:25:44,159
monitor everything if something is not

624
00:25:41,369 --> 00:25:46,408
working they have a full lock system so

625
00:25:44,159 --> 00:25:47,599
they can fix the mother next time to be

626
00:25:46,409 --> 00:25:50,220
sure they're going to steal their money

627
00:25:47,599 --> 00:25:52,678
and here you can design the guy so yeah

628
00:25:50,220 --> 00:25:54,989
is going to Afghanistan so he's even

629
00:25:52,679 --> 00:25:56,399
access drop name country here's the

630
00:25:54,989 --> 00:25:58,200
split right how much is she going to

631
00:25:56,399 --> 00:26:01,709
receive how much I'm going to keep to

632
00:25:58,200 --> 00:26:03,690
myself so basically again why they do

633
00:26:01,710 --> 00:26:05,519
this because you know when you in fact

634
00:26:03,690 --> 00:26:07,380
ten guys or hundred guys you can control

635
00:26:05,519 --> 00:26:08,970
this kind of stuff right manual

636
00:26:07,380 --> 00:26:10,770
but if you install thousands of people

637
00:26:08,970 --> 00:26:11,850
you need to have a banking application

638
00:26:10,770 --> 00:26:13,650
like this in the background we're going

639
00:26:11,850 --> 00:26:16,980
to grab the money share the money drops

640
00:26:13,650 --> 00:26:19,740
and stuff like that okay so again this

641
00:26:16,980 --> 00:26:21,480
show us how advanced are those botanist

642
00:26:19,740 --> 00:26:23,520
guys I mean it's not I mean it's not a

643
00:26:21,480 --> 00:26:25,350
joke okay we know right botanist is okay

644
00:26:23,520 --> 00:26:26,879
Stasia but ness is coming the payload

645
00:26:25,350 --> 00:26:28,918
payload is doing some specific stuff

646
00:26:26,880 --> 00:26:30,630
okay that's it game over but when you

647
00:26:28,919 --> 00:26:31,799
get inside and you try to unlock their

648
00:26:30,630 --> 00:26:34,020
logic then you're going to see they put

649
00:26:31,799 --> 00:26:37,350
a huge huge investment and effort

650
00:26:34,020 --> 00:26:40,139
building this kind of stuff okay in full

651
00:26:37,350 --> 00:26:43,620
automatic as you can see here the drops

652
00:26:40,140 --> 00:26:46,049
successful so the money is delivered the

653
00:26:43,620 --> 00:26:51,750
guy takes his own money and he's sharing

654
00:26:46,049 --> 00:26:54,330
with a with a hacker's bad guys so here

655
00:26:51,750 --> 00:26:55,710
is actually this is dope transfers so

656
00:26:54,330 --> 00:26:56,939
here you can put a transfer how much

657
00:26:55,710 --> 00:27:00,990
you're going to steal from the guy and

658
00:26:56,940 --> 00:27:02,309
where the money will go now let's see

659
00:27:00,990 --> 00:27:03,510
let's speak about the second factor

660
00:27:02,309 --> 00:27:04,950
right everybody thinks yeah I have a

661
00:27:03,510 --> 00:27:10,100
second factor and stuff like that well

662
00:27:04,950 --> 00:27:11,429
second factor is not not up I don't know

663
00:27:10,100 --> 00:27:12,809
protection anymore

664
00:27:11,429 --> 00:27:14,130
also the tweet you see of the Twitter

665
00:27:12,809 --> 00:27:18,030
right also is second factor that

666
00:27:14,130 --> 00:27:19,530
compromised with SMS right the latest

667
00:27:18,030 --> 00:27:21,389
new so basically papers and second

668
00:27:19,530 --> 00:27:23,580
factor is very easy there is a lot of

669
00:27:21,390 --> 00:27:25,590
fake applications right so when they do

670
00:27:23,580 --> 00:27:27,539
men in the middle browser attack they

671
00:27:25,590 --> 00:27:29,100
know exactly which bank you are and they

672
00:27:27,539 --> 00:27:32,070
going to push I mean in the middle

673
00:27:29,100 --> 00:27:34,139
browser attack for your bank and an apk

674
00:27:32,070 --> 00:27:37,799
android application for the specific

675
00:27:34,140 --> 00:27:41,070
bank right so you think that your bank

676
00:27:37,799 --> 00:27:43,350
is pushing your new application for

677
00:27:41,070 --> 00:27:45,330
Android for banking so you install you

678
00:27:43,350 --> 00:27:46,709
set up the application in all normal way

679
00:27:45,330 --> 00:27:48,539
you think that is from your bank but

680
00:27:46,710 --> 00:27:51,240
it's actually from the bad guys why

681
00:27:48,539 --> 00:27:52,799
because you're not aware that the bank

682
00:27:51,240 --> 00:27:54,780
web application of the bank that you are

683
00:27:52,799 --> 00:27:56,639
accessing every day is actually not a

684
00:27:54,780 --> 00:27:59,700
real one right is Amanda Middlebrooks

685
00:27:56,640 --> 00:28:01,950
retract and you see the render of no

686
00:27:59,700 --> 00:28:04,380
model itself as you can see here you

687
00:28:01,950 --> 00:28:08,070
define the second factor and then you

688
00:28:04,380 --> 00:28:12,090
can grab all the second factors to do

689
00:28:08,070 --> 00:28:14,820
your dirty job okay to send money and do

690
00:28:12,090 --> 00:28:16,500
transactions now we saw a lot of

691
00:28:14,820 --> 00:28:17,899
botanist right what about the most

692
00:28:16,500 --> 00:28:20,480
advanced one

693
00:28:17,900 --> 00:28:24,110
which contains all of them so this

694
00:28:20,480 --> 00:28:27,710
botnet has automatic pilot

695
00:28:24,110 --> 00:28:30,830
it has men in the middle browser builder

696
00:28:27,710 --> 00:28:32,630
it has a second factor it has the

697
00:28:30,830 --> 00:28:35,179
malware samples inside everything is

698
00:28:32,630 --> 00:28:36,710
here okay so it starts with a web

699
00:28:35,180 --> 00:28:38,240
injects right so basically you define

700
00:28:36,710 --> 00:28:40,160
your web user index and you're going to

701
00:28:38,240 --> 00:28:42,410
define which bank which country you are

702
00:28:40,160 --> 00:28:43,880
attacking and then it's starting right

703
00:28:42,410 --> 00:28:46,730
here we're going to define the second

704
00:28:43,880 --> 00:28:49,790
factor bypass so what will be the number

705
00:28:46,730 --> 00:28:50,870
which kind of communication you want to

706
00:28:49,790 --> 00:28:52,520
make for them and here is the

707
00:28:50,870 --> 00:28:54,469
application basically so the system is

708
00:28:52,520 --> 00:28:57,230
building you the application with bet

709
00:28:54,470 --> 00:29:00,710
the log of the bank and everything in it

710
00:28:57,230 --> 00:29:02,059
right so it's ready to to trick all the

711
00:29:00,710 --> 00:29:06,440
customers of that Bank that this

712
00:29:02,059 --> 00:29:07,280
application is negative eight as you can

713
00:29:06,440 --> 00:29:09,980
see here

714
00:29:07,280 --> 00:29:13,370
yeah after extracting the in the apk we

715
00:29:09,980 --> 00:29:15,530
saw attack phone number I think that

716
00:29:13,370 --> 00:29:20,330
this is the elevators number okay from

717
00:29:15,530 --> 00:29:21,950
the last night on okay so and the SMS

718
00:29:20,330 --> 00:29:23,809
here right you can you can build your

719
00:29:21,950 --> 00:29:25,880
SMS there is a templates you know in

720
00:29:23,809 --> 00:29:27,260
which kind of SMS of back-end for you

721
00:29:25,880 --> 00:29:30,500
are speaking with your customers with

722
00:29:27,260 --> 00:29:32,120
your video victims actually right to

723
00:29:30,500 --> 00:29:37,880
grab their second factor which is really

724
00:29:32,120 --> 00:29:39,320
really I mean advanced and then you can

725
00:29:37,880 --> 00:29:41,750
interact with them right you can forward

726
00:29:39,320 --> 00:29:43,939
them to another let's say let's say that

727
00:29:41,750 --> 00:29:47,360
the guy he changed his bank right

728
00:29:43,940 --> 00:29:48,830
using the cookies if I mean there is a

729
00:29:47,360 --> 00:29:50,750
mall but we're checking the cookies and

730
00:29:48,830 --> 00:29:52,550
he say hey there is a new bank or a new

731
00:29:50,750 --> 00:29:54,200
guy or his father or his mother logged

732
00:29:52,550 --> 00:29:56,540
into the same machine with another bank

733
00:29:54,200 --> 00:29:58,670
accounts and there is a new bank they

734
00:29:56,540 --> 00:30:00,470
want me to push man in the middle

735
00:29:58,670 --> 00:30:02,720
prototype for that Bank and it's just

736
00:30:00,470 --> 00:30:04,910
full automatic right did you configure

737
00:30:02,720 --> 00:30:08,450
once and the attack is going in full

738
00:30:04,910 --> 00:30:12,290
automatic manner yeah so some

739
00:30:08,450 --> 00:30:14,840
conclusions look I mean we fight this

740
00:30:12,290 --> 00:30:17,450
guy a long long long I mean this was my

741
00:30:14,840 --> 00:30:19,459
day by day work for five years okay and

742
00:30:17,450 --> 00:30:21,380
then every time when we are catching

743
00:30:19,460 --> 00:30:23,900
them they were becoming more advanced

744
00:30:21,380 --> 00:30:26,570
okay but what we learn from them is

745
00:30:23,900 --> 00:30:30,410
really amazing so they use nearly always

746
00:30:26,570 --> 00:30:31,250
our shared hosting web servers why they

747
00:30:30,410 --> 00:30:33,260
do that

748
00:30:31,250 --> 00:30:35,120
they do that because in shutting

749
00:30:33,260 --> 00:30:36,590
shutting host web server sometimes we

750
00:30:35,120 --> 00:30:40,189
can even we can have a website which has

751
00:30:36,590 --> 00:30:42,439
a PHP MySQL right it can be WordPress or

752
00:30:40,190 --> 00:30:45,230
Joomla something which can be prone to

753
00:30:42,440 --> 00:30:48,049
be compromised right and then there is a

754
00:30:45,230 --> 00:30:49,400
simple HTML web sites right which there

755
00:30:48,049 --> 00:30:50,900
is nothing you can do technically right

756
00:30:49,400 --> 00:30:52,669
even if there is because there is no

757
00:30:50,900 --> 00:30:54,740
technical I mean there is maybe in the

758
00:30:52,669 --> 00:30:56,390
past but I don't see HTML

759
00:30:54,740 --> 00:30:58,010
vulnerabilities on the web application

760
00:30:56,390 --> 00:31:02,000
there that you can do something what

761
00:30:58,010 --> 00:31:06,500
they do here is really really smart they

762
00:31:02,000 --> 00:31:09,380
hack into the web pages where the PHP

763
00:31:06,500 --> 00:31:11,679
and MySQL is installed so basically they

764
00:31:09,380 --> 00:31:14,299
leverage the application platform behind

765
00:31:11,679 --> 00:31:19,610
it can be worthless or whatever it is

766
00:31:14,299 --> 00:31:24,260
but they deployed the fishing kit on the

767
00:31:19,610 --> 00:31:26,600
HTML website ok and then when we came in

768
00:31:24,260 --> 00:31:29,480
we scan the HTML website and there is

769
00:31:26,600 --> 00:31:30,980
nothing inside that is vulnerable so we

770
00:31:29,480 --> 00:31:33,289
were questioning yourself hey how they

771
00:31:30,980 --> 00:31:36,740
managed to put this fishing kit on this

772
00:31:33,289 --> 00:31:38,419
website but there is only HTM right so

773
00:31:36,740 --> 00:31:41,780
they they were doing this kind of tricks

774
00:31:38,419 --> 00:31:43,669
all the time and then you know we mean

775
00:31:41,780 --> 00:31:45,289
it didn't take too much time to figure

776
00:31:43,669 --> 00:31:46,640
out that yeah they are hacking up so

777
00:31:45,289 --> 00:31:48,320
basically they have a root access to the

778
00:31:46,640 --> 00:31:50,870
whole server itself and then they can

779
00:31:48,320 --> 00:31:52,668
just browse through the directories and

780
00:31:50,870 --> 00:31:54,350
they just ran there is a HTML web page

781
00:31:52,669 --> 00:31:57,890
let's let's put it here because it's not

782
00:31:54,350 --> 00:32:00,649
so it's not so suspicious then what is

783
00:31:57,890 --> 00:32:04,940
happening so this is really cool so they

784
00:32:00,650 --> 00:32:07,159
have multiple phishing sites ok and all

785
00:32:04,940 --> 00:32:08,600
these phishing sites are sending hacked

786
00:32:07,159 --> 00:32:10,520
credit card information or personal

787
00:32:08,600 --> 00:32:12,500
personal information to these drop zones

788
00:32:10,520 --> 00:32:14,658
here right they were using cool ok in

789
00:32:12,500 --> 00:32:16,280
the background every single credit card

790
00:32:14,659 --> 00:32:18,110
information when you entered through the

791
00:32:16,280 --> 00:32:21,020
cool is pushing them to the drop zones

792
00:32:18,110 --> 00:32:22,520
and then what we what we were doing we

793
00:32:21,020 --> 00:32:24,620
were actually scanning those servers

794
00:32:22,520 --> 00:32:26,658
because there must be a vulnerability on

795
00:32:24,620 --> 00:32:28,370
the server in 99.8% they're using a

796
00:32:26,659 --> 00:32:30,320
vulnerable set for servers to deploy

797
00:32:28,370 --> 00:32:31,580
their stuff and they don't patch

798
00:32:30,320 --> 00:32:33,500
sometimes they don't care about this

799
00:32:31,580 --> 00:32:34,970
right so what we're doing we're going

800
00:32:33,500 --> 00:32:36,799
against these vulnerable servers

801
00:32:34,970 --> 00:32:38,929
figuring out how they get inside what we

802
00:32:36,799 --> 00:32:42,559
are getting inside and we start blocking

803
00:32:38,929 --> 00:32:44,059
them so we start stealing their drop

804
00:32:42,559 --> 00:32:45,610
zone data and reporting to the police

805
00:32:44,059 --> 00:32:47,320
and they start getting

806
00:32:45,610 --> 00:32:50,409
angry with this okay because they

807
00:32:47,320 --> 00:32:53,399
collect a lot of data we Jerry we get in

808
00:32:50,410 --> 00:32:57,780
we collect the data they are not happy

809
00:32:53,400 --> 00:33:02,290
but they don't they change the strategy

810
00:32:57,780 --> 00:33:04,420
then they remove the drop zones and they

811
00:33:02,290 --> 00:33:08,129
start using PHP ml functionality and

812
00:33:04,420 --> 00:33:11,140
using a gmail account like a drop zone

813
00:33:08,130 --> 00:33:13,000
okay and now is a problem because then

814
00:33:11,140 --> 00:33:16,030
we need to go and hack Gmail right and

815
00:33:13,000 --> 00:33:18,970
this will be not a good option so we get

816
00:33:16,030 --> 00:33:20,740
pissed off okay so because we were

817
00:33:18,970 --> 00:33:22,780
monitoring them a long time around five

818
00:33:20,740 --> 00:33:26,620
months and that they changed the way of

819
00:33:22,780 --> 00:33:30,070
their working and what will happen we

820
00:33:26,620 --> 00:33:34,419
break in and we put a BCC to the fraud

821
00:33:30,070 --> 00:33:36,189
bank account and this is real I can show

822
00:33:34,420 --> 00:33:38,140
you the data so every single credit card

823
00:33:36,190 --> 00:33:40,420
that we were hacking it was going to the

824
00:33:38,140 --> 00:33:42,040
Gmail of the guy and then his BCC won't

825
00:33:40,420 --> 00:33:46,240
go into the bank the bank was killing

826
00:33:42,040 --> 00:33:47,290
the credit card again it takes couple of

827
00:33:46,240 --> 00:33:50,170
months and until they figure out

828
00:33:47,290 --> 00:33:53,139
something else and then they go again

829
00:33:50,170 --> 00:33:54,040
black so again we made them really

830
00:33:53,140 --> 00:33:56,140
really mad okay

831
00:33:54,040 --> 00:33:58,180
so again every time when we are pushing

832
00:33:56,140 --> 00:34:00,880
them they're learning nice I mean look

833
00:33:58,180 --> 00:34:04,000
we are we are helping them to get to

834
00:34:00,880 --> 00:34:08,560
adopt more and more let's say skills and

835
00:34:04,000 --> 00:34:12,190
stuff like that so I know that well we

836
00:34:08,560 --> 00:34:14,770
don't build a botnets right but when we

837
00:34:12,190 --> 00:34:17,470
do we run in our computer so this is the

838
00:34:14,770 --> 00:34:19,630
link of this the source code of this

839
00:34:17,469 --> 00:34:22,529
botnet we're going to share the slides

840
00:34:19,630 --> 00:34:24,850
but you can you can take a picture here

841
00:34:22,530 --> 00:34:27,790
it's really cool you can play with it

842
00:34:24,850 --> 00:34:30,370
you can run it with all droppers and

843
00:34:27,790 --> 00:34:32,440
stuff like that inside maybe you can

844
00:34:30,370 --> 00:34:35,529
open your Lego you know I don't know

845
00:34:32,440 --> 00:34:37,810
your own bank I don't know it's already

846
00:34:35,530 --> 00:34:40,030
yeah my other research articles so

847
00:34:37,810 --> 00:34:41,610
basically there's a lot of them I'm not

848
00:34:40,030 --> 00:34:43,870
doing in couple of two years because of

849
00:34:41,610 --> 00:34:45,400
heavily load that I have my current role

850
00:34:43,870 --> 00:34:50,520
covering Northern Europe and Turkey

851
00:34:45,400 --> 00:34:50,520
alone yeah so thank you and questions

852
00:34:51,290 --> 00:35:04,090
oh I went fast questions

853
00:35:07,300 --> 00:35:10,300
first

854
00:35:14,480 --> 00:35:20,180
okay so this last one which explains is

855
00:35:16,790 --> 00:35:22,790
really fascinating so of course natural

856
00:35:20,180 --> 00:35:25,220
question is how do I check if my banking

857
00:35:22,790 --> 00:35:26,359
account has been compromised well that's

858
00:35:25,220 --> 00:35:30,078
a good question you need to check if

859
00:35:26,359 --> 00:35:31,759
your money is there another I mean the

860
00:35:30,079 --> 00:35:33,290
biggest problem about the main Naveed

861
00:35:31,760 --> 00:35:36,380
abroad starting and believe me those

862
00:35:33,290 --> 00:35:38,480
attacks are on low because they are

863
00:35:36,380 --> 00:35:40,670
doing around stronger I mean if there is

864
00:35:38,480 --> 00:35:41,990
some silver bullet which which will

865
00:35:40,670 --> 00:35:43,160
never came around somewhere they're

866
00:35:41,990 --> 00:35:44,479
going to go back to this and they're

867
00:35:43,160 --> 00:35:47,118
going because this was the only source

868
00:35:44,480 --> 00:35:49,460
for them right so the problem is that

869
00:35:47,119 --> 00:35:51,740
well me you we can realize but the

870
00:35:49,460 --> 00:35:53,780
victims here was more mostly people or

871
00:35:51,740 --> 00:35:55,759
Father's or mothers the people who are

872
00:35:53,780 --> 00:35:58,549
don't understand the essence of the

873
00:35:55,760 --> 00:36:00,680
security right and this kid this can

874
00:35:58,549 --> 00:36:03,200
take time for them to understand because

875
00:36:00,680 --> 00:36:05,690
this system the 80s one it was designed

876
00:36:03,200 --> 00:36:06,910
to steal 10% from them so let me tell

877
00:36:05,690 --> 00:36:09,410
you something

878
00:36:06,910 --> 00:36:11,089
you know we everybody do something right

879
00:36:09,410 --> 00:36:13,220
we do donations and stuff like that I

880
00:36:11,089 --> 00:36:14,990
put a couple of donation 10% right and

881
00:36:13,220 --> 00:36:16,368
I'm and I'm receiving up to six months

882
00:36:14,990 --> 00:36:18,529
an email from donation hey do you know

883
00:36:16,369 --> 00:36:19,910
that you donate 10% every month in from

884
00:36:18,530 --> 00:36:23,660
your account right so we don't feel the

885
00:36:19,910 --> 00:36:26,149
10% 5% that's the problem so the problem

886
00:36:23,660 --> 00:36:27,680
here is that if you are affected if you

887
00:36:26,150 --> 00:36:29,569
are in the middle blobsnark you go and

888
00:36:27,680 --> 00:36:31,520
you are not going to fill this the only

889
00:36:29,569 --> 00:36:34,160
way to feel this is to ask from your

890
00:36:31,520 --> 00:36:37,099
banking paper statement and then to

891
00:36:34,160 --> 00:36:39,618
compare with your machine or to go I

892
00:36:37,099 --> 00:36:42,140
don't know in another machine or VM

893
00:36:39,619 --> 00:36:44,150
install a VM clean one on the fault

894
00:36:42,140 --> 00:36:45,950
fully isolated and then login to that

895
00:36:44,150 --> 00:36:47,480
from that VM Tier II banking application

896
00:36:45,950 --> 00:36:51,169
and check if you see the same results or

897
00:36:47,480 --> 00:36:52,760
not that's the only way I mean if if

898
00:36:51,170 --> 00:36:56,200
your AV is not stopping them and believe

899
00:36:52,760 --> 00:36:56,200
me we're not going to stop them

900
00:37:00,049 --> 00:37:05,900
so my question at one point you

901
00:37:02,579 --> 00:37:09,000
mentioned that use BC BC seed the hacked

902
00:37:05,900 --> 00:37:11,279
credential car bank cards to the bank's

903
00:37:09,000 --> 00:37:12,839
how much luggage logistics was required

904
00:37:11,279 --> 00:37:16,380
for the banks to start automatically

905
00:37:12,839 --> 00:37:18,869
killing the nothing yeah bank gave us a

906
00:37:16,380 --> 00:37:21,720
very unique generate email address from

907
00:37:18,869 --> 00:37:23,819
their Simpson it was a random numbers

908
00:37:21,720 --> 00:37:26,220
and you know very specific so everything

909
00:37:23,819 --> 00:37:28,440
that was going there a simple I don't

910
00:37:26,220 --> 00:37:29,970
know crawl and then just grab something

911
00:37:28,440 --> 00:37:31,670
and then just put them to the blacklist

912
00:37:29,970 --> 00:37:34,669
it was really easy for them to do it

913
00:37:31,670 --> 00:37:34,670
thanks

914
00:37:41,259 --> 00:37:45,609
I wanted to get your professional

915
00:37:43,329 --> 00:37:49,029
opinion with the ransom as a service

916
00:37:45,609 --> 00:37:51,308
typically using RDP as a vector

917
00:37:49,029 --> 00:37:54,420
once that's fix do you see any other

918
00:37:51,309 --> 00:37:56,529
vectors that ransom is a service can use

919
00:37:54,420 --> 00:37:56,829
sorry I couldn't I couldn't hear you

920
00:37:56,529 --> 00:37:59,200
well

921
00:37:56,829 --> 00:38:02,589
so ransom is a service yeah okay uses

922
00:37:59,200 --> 00:38:04,689
RDP okay do you feel that there's gonna

923
00:38:02,589 --> 00:38:06,609
be other vectors that Reza means the

924
00:38:04,690 --> 00:38:07,299
service can use for an attack and

925
00:38:06,609 --> 00:38:09,038
exploitation

926
00:38:07,299 --> 00:38:11,460
you mean the remote desktop connection

927
00:38:09,039 --> 00:38:14,079
right Michael right and look there is I

928
00:38:11,460 --> 00:38:16,210
don't see the reason why they need to

929
00:38:14,079 --> 00:38:18,099
use their DP right because the aim of

930
00:38:16,210 --> 00:38:21,579
the one ah okay so let's put this way

931
00:38:18,099 --> 00:38:25,539
the classical mother we stealing your

932
00:38:21,579 --> 00:38:29,739
credit card information is is silent it

933
00:38:25,539 --> 00:38:32,880
must remain silent to be able to make

934
00:38:29,739 --> 00:38:34,960
his aim run soon what is opposite

935
00:38:32,880 --> 00:38:36,489
did you ever seen our side around

936
00:38:34,960 --> 00:38:38,380
Superboy's encrypting your files and not

937
00:38:36,489 --> 00:38:41,619
asking anything not so they're going to

938
00:38:38,380 --> 00:38:43,420
ask something from you okay speaking

939
00:38:41,619 --> 00:38:45,819
about you wait the question is for the

940
00:38:43,420 --> 00:38:49,509
early people nobility right now or write

941
00:38:45,819 --> 00:38:51,670
the future vectors beyond our DP I I

942
00:38:49,509 --> 00:38:53,019
don't get your question like do you feel

943
00:38:51,670 --> 00:38:56,890
that there's gonna be other vectors to

944
00:38:53,019 --> 00:38:58,899
to attack oh other vectors right I mean

945
00:38:56,890 --> 00:39:01,118
there is a lot of vectors look I mean it

946
00:38:58,900 --> 00:39:02,589
can be run somewhere it can be something

947
00:39:01,119 --> 00:39:04,210
else too extra greater I have another

948
00:39:02,589 --> 00:39:06,640
demo here but is we don't have a time

949
00:39:04,210 --> 00:39:08,289
around forty gigabyte of screenshots so

950
00:39:06,640 --> 00:39:10,450
what they were doing they were doing a

951
00:39:08,289 --> 00:39:14,079
remote desktop and doing screenshot

952
00:39:10,450 --> 00:39:16,989
every single seconds of the victims and

953
00:39:14,079 --> 00:39:19,359
I have the data it was huge

954
00:39:16,989 --> 00:39:21,069
but that was mostly you know we I

955
00:39:19,359 --> 00:39:22,359
receive every day hey I have your naked

956
00:39:21,069 --> 00:39:23,619
pictures you need to pay something you

957
00:39:22,359 --> 00:39:26,049
know and the guys send it again and

958
00:39:23,619 --> 00:39:27,609
again and again this is not new okay

959
00:39:26,049 --> 00:39:29,140
but right now with the ransomware

960
00:39:27,609 --> 00:39:31,119
they're doing massively but I can tell

961
00:39:29,140 --> 00:39:33,249
you six years ago with a remote desktop

962
00:39:31,119 --> 00:39:34,660
the what you are telling me right now he

963
00:39:33,249 --> 00:39:36,189
was doing a modern remote desktop

964
00:39:34,660 --> 00:39:37,328
opening a connection to just screenshots

965
00:39:36,190 --> 00:39:38,769
every second every second and then

966
00:39:37,329 --> 00:39:40,890
building a movie from the screenshots

967
00:39:38,769 --> 00:39:43,209
okay and then you can drop the movie or

968
00:39:40,890 --> 00:39:44,710
whatever it is and then you can play and

969
00:39:43,210 --> 00:39:48,789
you can see what he's doing for one hour

970
00:39:44,710 --> 00:39:50,259
okay so I mean I hope that this answers

971
00:39:48,789 --> 00:39:54,210
your question yeah oh yeah we can catch

972
00:39:50,259 --> 00:39:54,210
up later appreciate it thank you

973
00:39:55,140 --> 00:39:57,549
okay then

974
00:39:56,500 --> 00:39:59,650
last thing today we have a threat

975
00:39:57,550 --> 00:40:01,930
hunting workshop so you guys can use

976
00:39:59,650 --> 00:40:03,460
this real stuff with your own hands and

977
00:40:01,930 --> 00:40:04,569
you can became a threat hunter so if you

978
00:40:03,460 --> 00:40:06,550
like you can join me yes

979
00:40:04,570 --> 00:40:09,580
have you made any profiling on the kind

980
00:40:06,550 --> 00:40:11,950
of the servers that they seen see have

981
00:40:09,580 --> 00:40:15,430
place - for example if there are broke

982
00:40:11,950 --> 00:40:19,180
VPS or something like that what to

983
00:40:15,430 --> 00:40:23,649
provide what kind of servers are the

984
00:40:19,180 --> 00:40:25,149
scene see oh look I mean night I mean I

985
00:40:23,650 --> 00:40:26,500
don't wanna I don't know I don't know

986
00:40:25,150 --> 00:40:28,060
the exact statistics nobody is keeping

987
00:40:26,500 --> 00:40:30,940
some numbers for this but I think that

988
00:40:28,060 --> 00:40:33,460
around more than 90 percent is a hack

989
00:40:30,940 --> 00:40:35,920
servers okay so they don't buy that's

990
00:40:33,460 --> 00:40:38,500
one thing the second thing is for

991
00:40:35,920 --> 00:40:42,880
phishing attacks they always prefer

992
00:40:38,500 --> 00:40:45,220
shared hosting okay because look if i

993
00:40:42,880 --> 00:40:47,140
hack a shared host web server I'm going

994
00:40:45,220 --> 00:40:49,540
to hack all the domains under its rise

995
00:40:47,140 --> 00:40:52,200
so high I have one shot and I can have

996
00:40:49,540 --> 00:40:54,520
multiple they don't go to the dedicated

997
00:40:52,200 --> 00:40:55,810
postings because if the hacker dedicated

998
00:40:54,520 --> 00:40:57,460
hosting server right then they're going

999
00:40:55,810 --> 00:40:59,080
to have one domain but if it's a

1000
00:40:57,460 --> 00:41:00,640
water-holding attack then they're going

1001
00:40:59,080 --> 00:41:02,500
to go mostly on the dedicated web

1002
00:41:00,640 --> 00:41:05,140
servers okay to deliver a water rolling

1003
00:41:02,500 --> 00:41:07,380
attacks because it's more let's say more

1004
00:41:05,140 --> 00:41:09,580
safe right you go like I don't know

1005
00:41:07,380 --> 00:41:12,220
don't drop some open-source software

1006
00:41:09,580 --> 00:41:13,569
right and you believe to the website but

1007
00:41:12,220 --> 00:41:15,098
it is under the hot roll water running

1008
00:41:13,570 --> 00:41:19,210
attack and if someone hacked that one

1009
00:41:15,099 --> 00:41:22,210
then you trust to hacked website okay so

1010
00:41:19,210 --> 00:41:24,640
they use VPS most of the time they use

1011
00:41:22,210 --> 00:41:26,470
shared hosts most of the time and right

1012
00:41:24,640 --> 00:41:28,540
now you know yeah with the tour right

1013
00:41:26,470 --> 00:41:30,310
now they started using tor we can we see

1014
00:41:28,540 --> 00:41:33,849
a lot of all the transaction background

1015
00:41:30,310 --> 00:41:35,890
so the payload okay dropper can came out

1016
00:41:33,849 --> 00:41:38,109
from everywhere the payload is coming

1017
00:41:35,890 --> 00:41:40,089
always from their short time of web so

1018
00:41:38,109 --> 00:41:41,619
what they do they send you a dropper

1019
00:41:40,089 --> 00:41:43,180
right dropper zero day so it's in fact

1020
00:41:41,619 --> 00:41:46,810
your machine no a view no nothing right

1021
00:41:43,180 --> 00:41:49,118
and what they do to avoid sandbox Inc so

1022
00:41:46,810 --> 00:41:50,529
if you catch the dropper doesn't matter

1023
00:41:49,119 --> 00:41:52,660
if it's coming from email you catch the

1024
00:41:50,530 --> 00:41:54,369
dropper you put on the sandbox right you

1025
00:41:52,660 --> 00:41:57,730
execute them all there and then there is

1026
00:41:54,369 --> 00:42:00,400
a post or get communication to IP

1027
00:41:57,730 --> 00:42:02,650
address which doesn't exist what your

1028
00:42:00,400 --> 00:42:05,070
Sam was going to do your samples cannot

1029
00:42:02,650 --> 00:42:07,290
decide if that is malicious or not

1030
00:42:05,070 --> 00:42:09,330
and what they do your Sam was going to

1031
00:42:07,290 --> 00:42:11,790
score it like a low hey there was a some

1032
00:42:09,330 --> 00:42:13,619
poster get but there was not and then

1033
00:42:11,790 --> 00:42:15,779
what did they are doing after two days

1034
00:42:13,619 --> 00:42:17,520
they're pulling up the C&C server ah and

1035
00:42:15,780 --> 00:42:20,220
the piece of dropper has a heartbeat

1036
00:42:17,520 --> 00:42:21,780
he's checking if he's on or off and when

1037
00:42:20,220 --> 00:42:23,279
he's reaching out there he is dropping

1038
00:42:21,780 --> 00:42:26,130
the payload and game over your sandbox

1039
00:42:23,280 --> 00:42:30,510
is the bypassed and UAVs bypass is

1040
00:42:26,130 --> 00:42:32,190
simple okay so yeah there is a lot of

1041
00:42:30,510 --> 00:42:36,860
ways we can we can speak that also later

1042
00:42:32,190 --> 00:42:39,090
I mean a lot of a lot of waste or like

1043
00:42:36,860 --> 00:42:41,400
yeah when I tried the kill switch right

1044
00:42:39,090 --> 00:42:47,130
what do you think guys what was the kill

1045
00:42:41,400 --> 00:42:49,500
switch used for okay so two options to

1046
00:42:47,130 --> 00:42:54,750
control the spread or to evade sandbox

1047
00:42:49,500 --> 00:42:58,470
what do you think okay how you can

1048
00:42:54,750 --> 00:43:02,220
invade sandbox with a kill switch so let

1049
00:42:58,470 --> 00:43:05,100
me tell something sandbox is by the

1050
00:43:02,220 --> 00:43:07,649
default they are running up at a DNS

1051
00:43:05,100 --> 00:43:09,420
traffic net on their own host so every

1052
00:43:07,650 --> 00:43:12,240
single request you're going to receive

1053
00:43:09,420 --> 00:43:14,760
like a 200 found so doesn't matter if

1054
00:43:12,240 --> 00:43:16,229
you write a random comm it will really

1055
00:43:14,760 --> 00:43:19,050
play like a 200 okay

1056
00:43:16,230 --> 00:43:23,070
and you tell to your mother hey if you

1057
00:43:19,050 --> 00:43:24,960
are going to WWWE BCD 1 2 3 4 a domain

1058
00:43:23,070 --> 00:43:26,490
which doesn't exist and if you receive

1059
00:43:24,960 --> 00:43:30,140
200 you're on the sandbox don't do

1060
00:43:26,490 --> 00:43:32,879
anything make sense

1061
00:43:30,140 --> 00:43:35,368
so I mean somebody thinks that the

1062
00:43:32,880 --> 00:43:38,010
ransom I want to cry Killswitch was used

1063
00:43:35,369 --> 00:43:40,770
for the spreading control somebody

1064
00:43:38,010 --> 00:43:43,260
thinks that it was useful the sandbox

1065
00:43:40,770 --> 00:43:51,980
evade only the guy who built only he

1066
00:43:43,260 --> 00:43:51,980
knows we can only guess right now yep

1067
00:43:53,110 --> 00:43:58,210
okay so do you have any suggestions or

1068
00:43:55,960 --> 00:44:00,430
proposal how to defend ourselves from

1069
00:43:58,210 --> 00:44:02,950
some those kinds of attacks

1070
00:44:00,430 --> 00:44:06,100
so look defensive that is number one

1071
00:44:02,950 --> 00:44:07,419
right I mean we need to we need to stick

1072
00:44:06,100 --> 00:44:08,740
on defense and that we need to invest in

1073
00:44:07,420 --> 00:44:11,350
deference and that even if it's broken

1074
00:44:08,740 --> 00:44:13,240
right right now there is a huge shift on

1075
00:44:11,350 --> 00:44:16,620
the market for the ADR platforms you can

1076
00:44:13,240 --> 00:44:18,790
check them okay and remember one thing

1077
00:44:16,620 --> 00:44:20,500
intelligence platforms external

1078
00:44:18,790 --> 00:44:23,200
intelligence right you can buy all of

1079
00:44:20,500 --> 00:44:24,970
them external threat intelligence will

1080
00:44:23,200 --> 00:44:27,580
not help to you against the zero rate

1081
00:44:24,970 --> 00:44:28,899
malware attacks who going to attack you

1082
00:44:27,580 --> 00:44:32,350
with a known bad Mulder right come on

1083
00:44:28,900 --> 00:44:32,740
guys so I mean there is some hype right

1084
00:44:32,350 --> 00:44:34,120
now

1085
00:44:32,740 --> 00:44:35,259
you know I remember like an action

1086
00:44:34,120 --> 00:44:37,900
action nation everybody was buying

1087
00:44:35,260 --> 00:44:39,400
action now everybody is buying a threat

1088
00:44:37,900 --> 00:44:41,380
intelligence this is one thing the

1089
00:44:39,400 --> 00:44:43,600
second thing is that there is some

1090
00:44:41,380 --> 00:44:45,580
non-logical raised in the AV market

1091
00:44:43,600 --> 00:44:47,890
right now the catch rate who is catching

1092
00:44:45,580 --> 00:44:49,660
more Mulder don't buy a cybersecurity

1093
00:44:47,890 --> 00:44:52,420
product by doing a catch rate because

1094
00:44:49,660 --> 00:44:54,910
that's not real okay because if you ever

1095
00:44:52,420 --> 00:44:56,800
let's say that you have a customer I

1096
00:44:54,910 --> 00:44:59,310
don't know Bank number one right and

1097
00:44:56,800 --> 00:45:01,780
they use McAfee for avian right I

1098
00:44:59,310 --> 00:45:04,120
prepare a zero them Mulder I attack them

1099
00:45:01,780 --> 00:45:06,610
make efficient bow sketchiest hey I have

1100
00:45:04,120 --> 00:45:10,480
a signature right is this making a make

1101
00:45:06,610 --> 00:45:13,090
a feel better than Symantec no because

1102
00:45:10,480 --> 00:45:15,160
McAfee was on that Bank right what will

1103
00:45:13,090 --> 00:45:16,630
happen if I Mac I know second

1104
00:45:15,160 --> 00:45:18,759
bank where Symantec is installed right

1105
00:45:16,630 --> 00:45:21,070
semantics catch my malware sandbox and

1106
00:45:18,760 --> 00:45:23,950
hey we catch the mother is make a fee

1107
00:45:21,070 --> 00:45:27,520
bet again so this kind of races are not

1108
00:45:23,950 --> 00:45:30,490
real okay you cannot race Mulder catch

1109
00:45:27,520 --> 00:45:32,230
so focus on more behave focus on sandbox

1110
00:45:30,490 --> 00:45:34,620
and stuff like that rather than catch

1111
00:45:32,230 --> 00:45:38,560
rates so companies what they do

1112
00:45:34,620 --> 00:45:41,080
gathering the ivory they both as many as

1113
00:45:38,560 --> 00:45:44,620
they can and they put McAfee Symantec

1114
00:45:41,080 --> 00:45:47,230
and Sierra so if the pass is the first

1115
00:45:44,620 --> 00:45:51,270
one I think we try to cut the second and

1116
00:45:47,230 --> 00:45:53,530
so on but they all have the same

1117
00:45:51,270 --> 00:45:56,170
fingerprints of the same signature

1118
00:45:53,530 --> 00:45:58,840
soon they will never cut if they buy

1119
00:45:56,170 --> 00:46:00,340
every AV product in the world they will

1120
00:45:58,840 --> 00:46:03,400
never cut

1121
00:46:00,340 --> 00:46:05,320
a new marvel of Malwa I mean that's

1122
00:46:03,400 --> 00:46:06,730
that's exactly what what what you are

1123
00:46:05,320 --> 00:46:09,580
telling me I just tell you the same

1124
00:46:06,730 --> 00:46:11,230
right so basically like virustotal right

1125
00:46:09,580 --> 00:46:12,850
they have a just started checks you you

1126
00:46:11,230 --> 00:46:14,290
push a shot at 50 sees they check on

1127
00:46:12,850 --> 00:46:16,509
their blacklist and they say yeah this

1128
00:46:14,290 --> 00:46:18,670
is the technique this is not how easy is

1129
00:46:16,510 --> 00:46:19,810
to change shot of it is just a couple of

1130
00:46:18,670 --> 00:46:24,550
bites inside and you have on your

1131
00:46:19,810 --> 00:46:28,330
chapter 56 okay I mean yeah this this

1132
00:46:24,550 --> 00:46:29,890
cat and the mouse can be can be let's

1133
00:46:28,330 --> 00:46:32,020
put this way the cat and the mouse with

1134
00:46:29,890 --> 00:46:33,430
the shot 256 or file disposition lookups

1135
00:46:32,020 --> 00:46:36,640
we call them file disposition right

1136
00:46:33,430 --> 00:46:38,560
cannot be done by threat intelligence

1137
00:46:36,640 --> 00:46:40,900
you still need a sandbox in behave

1138
00:46:38,560 --> 00:46:42,640
indicators exploit prevention engine

1139
00:46:40,900 --> 00:46:44,230
heuristic and gene right and system

1140
00:46:42,640 --> 00:46:45,970
protections and genes are really really

1141
00:46:44,230 --> 00:46:47,320
important you know let me tell you

1142
00:46:45,970 --> 00:46:49,419
something about the mimic that's right

1143
00:46:47,320 --> 00:46:49,600
you know I mean it's painting us right

1144
00:46:49,420 --> 00:46:52,120
now

1145
00:46:49,600 --> 00:46:53,440
right mimic us everywhere why because we

1146
00:46:52,120 --> 00:46:55,900
are trying to block mimikatz

1147
00:46:53,440 --> 00:46:58,270
know we need to block the processes that

1148
00:46:55,900 --> 00:47:00,400
mimic us is using to leverage this job

1149
00:46:58,270 --> 00:47:00,820
okay so if we do that then because it's

1150
00:47:00,400 --> 00:47:03,190
done right

1151
00:47:00,820 --> 00:47:05,380
so again then mimic are used to find

1152
00:47:03,190 --> 00:47:08,050
another way right too bad so because you

1153
00:47:05,380 --> 00:47:09,310
can take you can compile your own Mulder

1154
00:47:08,050 --> 00:47:12,660
right and you have a new shot the

1155
00:47:09,310 --> 00:47:19,690
fictitious and everything is bypassed

1156
00:47:12,660 --> 00:47:21,129
any other questions okay then thanks for

1157
00:47:19,690 --> 00:47:24,349
listening me

1158
00:47:21,130 --> 00:47:24,349
[Applause]

1159
00:47:29,350 --> 00:47:32,429
[Music]

1160
00:47:47,540 --> 00:47:49,600
you

