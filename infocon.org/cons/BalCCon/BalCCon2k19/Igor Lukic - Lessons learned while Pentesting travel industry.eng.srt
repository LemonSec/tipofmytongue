1
00:00:26,900 --> 00:00:32,509
we're gonna start now ego is gonna talk

2
00:00:30,200 --> 00:00:41,930
to us about his lessons learned from

3
00:00:32,509 --> 00:00:44,420
fantastic industry enjoy thank you so

4
00:00:41,930 --> 00:00:46,790
I'm going to start crying you everyone

5
00:00:44,420 --> 00:00:48,530
that this morning they took my car so I

6
00:00:46,790 --> 00:00:50,780
was last night working on the

7
00:00:48,530 --> 00:00:53,360
presentation came to the hotel the car

8
00:00:50,780 --> 00:00:56,570
towed now I have to take my car to the

9
00:00:53,360 --> 00:00:59,629
station so I'm starting a good name in

10
00:00:56,570 --> 00:01:03,650
Balkan so my talk is going to be about

11
00:00:59,629 --> 00:01:04,610
lessons learned in the travel industry I

12
00:01:03,650 --> 00:01:06,470
come from

13
00:01:04,610 --> 00:01:08,540
Canary Islands have you ever been to

14
00:01:06,470 --> 00:01:12,020
Canary Islands do you know where Canary

15
00:01:08,540 --> 00:01:14,540
Islands give hands up islands two three

16
00:01:12,020 --> 00:01:16,880
four the other the other people should

17
00:01:14,540 --> 00:01:20,390
check the map it's really near Moroccan

18
00:01:16,880 --> 00:01:22,640
coast so we are in Spain and beautiful

19
00:01:20,390 --> 00:01:26,510
beaches lots of hotels so as you may

20
00:01:22,640 --> 00:01:28,400
know our customers are usually linked to

21
00:01:26,510 --> 00:01:30,080
the towel industry so we are learning

22
00:01:28,400 --> 00:01:33,680
some valuable lessons from there

23
00:01:30,080 --> 00:01:36,380
I work in enigmatic only fantasy

24
00:01:33,680 --> 00:01:38,720
innocent response and training my team

25
00:01:36,380 --> 00:01:41,089
is very young team

26
00:01:38,720 --> 00:01:42,770
they're very hands-on every time we have

27
00:01:41,090 --> 00:01:45,260
to do something we need a demo if

28
00:01:42,770 --> 00:01:48,860
there's not a demo we don't do it so

29
00:01:45,260 --> 00:01:51,500
that's more or less the talk is starting

30
00:01:48,860 --> 00:01:53,030
because as you have seen many industries

31
00:01:51,500 --> 00:01:55,250
are being breached right we are seeing

32
00:01:53,030 --> 00:01:57,290
the news that hired for the rich

33
00:01:55,250 --> 00:02:01,580
customer payment for the one hotels

34
00:01:57,290 --> 00:02:02,810
breached Hilton was fine 700 K which I

35
00:02:01,580 --> 00:02:06,170
don't know if it's true or not because

36
00:02:02,810 --> 00:02:08,810
gdpr is kind of starting to settle up

37
00:02:06,170 --> 00:02:11,810
and some fines are more as a precaution

38
00:02:08,810 --> 00:02:13,849
it's not a real fine but whoever wants

39
00:02:11,810 --> 00:02:17,090
to figure it out but big chains are

40
00:02:13,849 --> 00:02:19,879
getting hacked and this one is also a

41
00:02:17,090 --> 00:02:22,550
funny one Hotel ransom my hackers I

42
00:02:19,879 --> 00:02:24,980
would say criminals as guest locked out

43
00:02:22,550 --> 00:02:27,349
of rooms have you heard the story now in

44
00:02:24,980 --> 00:02:28,790
Austria I think either if it's true or

45
00:02:27,349 --> 00:02:30,530
not but they compromised

46
00:02:28,790 --> 00:02:32,989
I guess the reception machine and the

47
00:02:30,530 --> 00:02:35,430
keys for the key cards for your

48
00:02:32,990 --> 00:02:38,220
customers they were not being able to

49
00:02:35,430 --> 00:02:40,440
print new keys or or valid the keys so

50
00:02:38,220 --> 00:02:43,010
they couldn't get in the rooms for a

51
00:02:40,440 --> 00:02:45,270
long time I don't know if it's true but

52
00:02:43,010 --> 00:02:46,920
figure it out for yourself

53
00:02:45,270 --> 00:02:51,060
and have you heard the big story about

54
00:02:46,920 --> 00:02:53,730
Kaspersky the dark hotel anyone know

55
00:02:51,060 --> 00:02:56,580
it's quite old and it's pushed a lot of

56
00:02:53,730 --> 00:02:59,880
media basically Kaspersky had a research

57
00:02:56,580 --> 00:03:01,800
telling that they found many Asian

58
00:02:59,880 --> 00:03:04,019
hotels I think there was many luxury

59
00:03:01,800 --> 00:03:05,850
hotels were executives were targeted

60
00:03:04,020 --> 00:03:07,620
attacks they were going against them

61
00:03:05,850 --> 00:03:09,690
like an advanced persistent threat

62
00:03:07,620 --> 00:03:11,310
whether we want to call it the the

63
00:03:09,690 --> 00:03:13,170
scheme of the attack is quite easy so

64
00:03:11,310 --> 00:03:14,790
you get in your room checking the

65
00:03:13,170 --> 00:03:17,940
attacker knows what hotel you are

66
00:03:14,790 --> 00:03:21,060
because as everyone knows CEOs and big

67
00:03:17,940 --> 00:03:23,550
people always have to show where they're

68
00:03:21,060 --> 00:03:26,250
going right in Lincoln in in in Twitter

69
00:03:23,550 --> 00:03:28,050
like they have to you know move and show

70
00:03:26,250 --> 00:03:30,390
that you're traveling the whole world so

71
00:03:28,050 --> 00:03:32,580
an attacker could just grab a flight go

72
00:03:30,390 --> 00:03:35,339
there get in the hotel get a nice room

73
00:03:32,580 --> 00:03:38,880
next to the person or at least nearby

74
00:03:35,340 --> 00:03:41,370
and launch a targeted attack against

75
00:03:38,880 --> 00:03:42,780
customers in that hotel and this is what

76
00:03:41,370 --> 00:03:46,830
we actually do in the pen testing so

77
00:03:42,780 --> 00:03:49,530
this is a really practical example of

78
00:03:46,830 --> 00:03:52,560
things can can work this is where I live

79
00:03:49,530 --> 00:03:56,130
I know it's painful to watch but that's

80
00:03:52,560 --> 00:03:58,050
the reality so we are lots of Tears blah

81
00:03:56,130 --> 00:04:00,510
blah and that's what we see in the front

82
00:03:58,050 --> 00:04:03,630
end right like you cannot ask because we

83
00:04:00,510 --> 00:04:07,230
are geeks but usually the people around

84
00:04:03,630 --> 00:04:09,299
us are like ok this nice place to be and

85
00:04:07,230 --> 00:04:11,910
that's it right but on the other on the

86
00:04:09,300 --> 00:04:16,160
back end this is actually smart cities

87
00:04:11,910 --> 00:04:18,659
of beaches in Spain and the smart in our

88
00:04:16,160 --> 00:04:21,390
island it's even the smart island so

89
00:04:18,660 --> 00:04:23,520
even beaches are connected to internet

90
00:04:21,390 --> 00:04:25,890
of things to measure the quality of the

91
00:04:23,520 --> 00:04:28,919
sea to measure if the water is safe to

92
00:04:25,890 --> 00:04:32,130
be swimming because we live of tourism

93
00:04:28,919 --> 00:04:34,799
if something goes wrong in the tourism

94
00:04:32,130 --> 00:04:37,200
industry we are going to be bankrupt so

95
00:04:34,800 --> 00:04:39,419
our I think 90% of the economy in Canary

96
00:04:37,200 --> 00:04:40,500
Islands is based on tourism so what that

97
00:04:39,419 --> 00:04:42,690
means that everything needs to be

98
00:04:40,500 --> 00:04:45,750
measured everything needs to be really

99
00:04:42,690 --> 00:04:46,559
really you know figure it out so so we

100
00:04:45,750 --> 00:04:49,289
don't face

101
00:04:46,559 --> 00:04:51,659
and by watching that we are seeing so

102
00:04:49,289 --> 00:04:55,498
many things interconnected on a small

103
00:04:51,659 --> 00:04:57,899
island and believe me normally the truth

104
00:04:55,499 --> 00:05:00,239
is that it's quite messy it's like we

105
00:04:57,899 --> 00:05:02,009
need costs to be really down it needs to

106
00:05:00,239 --> 00:05:03,688
be fast it needs to be easy and you know

107
00:05:02,009 --> 00:05:07,259
I guess the drill where I'm going with

108
00:05:03,689 --> 00:05:09,359
that this is the story behind the hotels

109
00:05:07,259 --> 00:05:11,999
that are getting more information to

110
00:05:09,359 --> 00:05:14,429
their hotel guests to be safe this is in

111
00:05:11,999 --> 00:05:17,159
Sweden a couple two days ago when I was

112
00:05:14,429 --> 00:05:21,299
driving to to Belgrade and this is your

113
00:05:17,159 --> 00:05:23,489
TV and to see your flight status nothing

114
00:05:21,299 --> 00:05:26,448
better than a remote desktop from your

115
00:05:23,489 --> 00:05:29,068
TV and to watch your gate number right

116
00:05:26,449 --> 00:05:31,259
but this is the small change the reality

117
00:05:29,069 --> 00:05:33,239
in small hotels is that their budget for

118
00:05:31,259 --> 00:05:36,149
security is also small like their chain

119
00:05:33,239 --> 00:05:39,479
so they need to be beware that if they

120
00:05:36,149 --> 00:05:41,459
want to imitate the bigger brands they

121
00:05:39,479 --> 00:05:44,188
need to take into account that they can

122
00:05:41,459 --> 00:05:46,889
be quite easily hacked because obviously

123
00:05:44,189 --> 00:05:49,529
their budget is is limited this is also

124
00:05:46,889 --> 00:05:53,099
in in Sweden there who doesn't get their

125
00:05:49,529 --> 00:05:55,349
juice is pressing a tablet everyone

126
00:05:53,099 --> 00:05:57,529
right if there is no a tablet to get my

127
00:05:55,349 --> 00:06:01,949
orange juice and I'm going to die but

128
00:05:57,529 --> 00:06:04,649
those perks have a big price from our

129
00:06:01,949 --> 00:06:06,839
point of view like putting just a tablet

130
00:06:04,649 --> 00:06:09,269
where you can maybe see the corporate

131
00:06:06,839 --> 00:06:11,069
network of the Wi-Fi when I have my

132
00:06:09,269 --> 00:06:14,009
orange juice it's a big limitation

133
00:06:11,069 --> 00:06:16,409
security right well some tablets you

134
00:06:14,009 --> 00:06:19,259
just need to do some figures and guests

135
00:06:16,409 --> 00:06:21,569
and and touches and you can do that just

136
00:06:19,259 --> 00:06:24,239
by having orange juice so hotels really

137
00:06:21,569 --> 00:06:27,239
need to be careful about that and this

138
00:06:24,239 --> 00:06:29,219
one like yesterday also in the hotel you

139
00:06:27,239 --> 00:06:32,818
know that now Smart TVs and hotels want

140
00:06:29,219 --> 00:06:35,219
you to watch your net fix your hookup

141
00:06:32,819 --> 00:06:38,339
your HBO whatever you want to watch and

142
00:06:35,219 --> 00:06:42,479
be say and be comfortable in your hotel

143
00:06:38,339 --> 00:06:45,220
room right who here is going to put his

144
00:06:42,479 --> 00:06:48,940
or hers Netflix in a hotel room

145
00:06:45,220 --> 00:06:51,250
well people are doing it so the message

146
00:06:48,940 --> 00:06:53,290
here is that be careful the line that is

147
00:06:51,250 --> 00:06:54,490
crossing the hotel industry because they

148
00:06:53,290 --> 00:06:55,060
are treating like the guests like it's

149
00:06:54,490 --> 00:06:56,800
your home

150
00:06:55,060 --> 00:07:00,220
so everything needs to be you know

151
00:06:56,800 --> 00:07:01,990
sparking shine the lights needs to be

152
00:07:00,220 --> 00:07:05,170
figured out by a tablet your orange

153
00:07:01,990 --> 00:07:06,940
juice your smart TV etc and it's all

154
00:07:05,170 --> 00:07:09,360
layers and layers and layers that we're

155
00:07:06,940 --> 00:07:13,630
seeing in hotels that can be quite

156
00:07:09,360 --> 00:07:16,000
hacked in those right so to go back to

157
00:07:13,630 --> 00:07:17,590
the point of view to talk the

158
00:07:16,000 --> 00:07:21,670
experiences that I'm going to summarize

159
00:07:17,590 --> 00:07:24,810
very quick is the hotels airplanes the

160
00:07:21,670 --> 00:07:28,660
airports that are going to talk but and

161
00:07:24,810 --> 00:07:31,030
also the shipping industry as you may

162
00:07:28,660 --> 00:07:34,090
imagine Canary Islands we are surrounded

163
00:07:31,030 --> 00:07:36,010
by the Atlantic Ocean so our second

164
00:07:34,090 --> 00:07:39,340
biggest industry is the shipping

165
00:07:36,010 --> 00:07:42,219
shipping industry right so I've seen

166
00:07:39,340 --> 00:07:44,950
also some crazy things on board there so

167
00:07:42,220 --> 00:07:46,900
to start with the hotels from the red

168
00:07:44,950 --> 00:07:50,340
team fantastic perspective in the

169
00:07:46,900 --> 00:07:53,590
physical engagements one of the biggest

170
00:07:50,340 --> 00:07:55,719
things that work for us is and my team

171
00:07:53,590 --> 00:07:59,289
is to pretend to be a hotel guest you

172
00:07:55,720 --> 00:08:01,960
know why because hotels how do they

173
00:07:59,290 --> 00:08:04,780
treat their guests amazingly fine right

174
00:08:01,960 --> 00:08:06,940
so that anything you may ask in good

175
00:08:04,780 --> 00:08:09,340
proportion and if you are you know

176
00:08:06,940 --> 00:08:12,510
willing to to connect and explain that

177
00:08:09,340 --> 00:08:16,450
the person from the hotel they will just

178
00:08:12,510 --> 00:08:18,820
be surrounded by your by your engagement

179
00:08:16,450 --> 00:08:20,440
so some things that we tried the USB

180
00:08:18,820 --> 00:08:22,510
tricks have you used rubber ducky batch

181
00:08:20,440 --> 00:08:26,290
Bunny and all the toys from hak5 acquire

182
00:08:22,510 --> 00:08:28,659
hands up of course yeah if not check

183
00:08:26,290 --> 00:08:30,550
them out they have it makes your life

184
00:08:28,660 --> 00:08:32,830
easier if you do pen testing in speeds

185
00:08:30,550 --> 00:08:35,140
of the things the basic thing for those

186
00:08:32,830 --> 00:08:37,930
who don't know the tricks are that these

187
00:08:35,140 --> 00:08:39,968
USB drives once they plug them in they

188
00:08:37,929 --> 00:08:42,098
execute whatever you want you can

189
00:08:39,969 --> 00:08:45,160
execute power shell you can execute a

190
00:08:42,099 --> 00:08:48,430
thing to do in that in in that injection

191
00:08:45,160 --> 00:08:50,410
right and usually what you say and what

192
00:08:48,430 --> 00:08:52,810
we do then it works we need to bring the

193
00:08:50,410 --> 00:08:54,400
boarding pass from our flight so the

194
00:08:52,810 --> 00:08:56,979
reception is like yeah sure give me the

195
00:08:54,400 --> 00:08:58,540
USB Drive some tell

196
00:08:56,980 --> 00:09:00,220
send us an email and we're like okay

197
00:08:58,540 --> 00:09:04,029
sure we are going to send a phishing

198
00:09:00,220 --> 00:09:06,069
email afterwards so the usage of that we

199
00:09:04,029 --> 00:09:09,009
can use is that we can print the border

200
00:09:06,069 --> 00:09:11,858
passes or unattended workstations in the

201
00:09:09,009 --> 00:09:13,989
reception and hotel areas there are many

202
00:09:11,859 --> 00:09:16,089
places that computers are just left by

203
00:09:13,989 --> 00:09:19,389
with the session open and you only need

204
00:09:16,089 --> 00:09:21,369
to plug the USB ducky or flash money in

205
00:09:19,389 --> 00:09:23,619
the ducky I think it's six seconds a

206
00:09:21,369 --> 00:09:26,679
reverse shell I think it pops up so six

207
00:09:23,619 --> 00:09:28,569
seconds and depending how well it's done

208
00:09:26,679 --> 00:09:31,029
their security to work in most of our

209
00:09:28,569 --> 00:09:33,399
environments it quite works quite

210
00:09:31,029 --> 00:09:35,799
brilliantly and remember you can stop

211
00:09:33,399 --> 00:09:37,540
services you can stop the antivirus if

212
00:09:35,799 --> 00:09:39,369
they're running admin most of the time

213
00:09:37,540 --> 00:09:42,309
they are and if not you just elevate the

214
00:09:39,369 --> 00:09:45,699
the privilege so this is one of the

215
00:09:42,309 --> 00:09:49,319
tricks the second trick is the Wi-Fi

216
00:09:45,699 --> 00:09:51,549
guest in corporate environment we always

217
00:09:49,319 --> 00:09:54,488
pretend to be their internet provider in

218
00:09:51,549 --> 00:09:57,069
the hotels right we can do that by using

219
00:09:54,489 --> 00:09:59,799
the pineapple which is another tool very

220
00:09:57,069 --> 00:10:01,689
popular in hack five it comes from I

221
00:09:59,799 --> 00:10:04,269
think yeah cigar I think it's the origin

222
00:10:01,689 --> 00:10:07,089
yeah cigar I think is the original

223
00:10:04,269 --> 00:10:09,220
project and basically it's a device

224
00:10:07,089 --> 00:10:11,799
wireless device that you plug it in and

225
00:10:09,220 --> 00:10:13,480
it will it has many attacks vectors but

226
00:10:11,799 --> 00:10:15,899
one of them is that it's going to tell

227
00:10:13,480 --> 00:10:19,569
that your wireless network is your

228
00:10:15,899 --> 00:10:21,730
network of trust you know that right so

229
00:10:19,569 --> 00:10:24,219
when you come to your home or come to a

230
00:10:21,730 --> 00:10:29,169
friend's house it's allowed to connect

231
00:10:24,220 --> 00:10:32,079
that happens to you anyone right so in

232
00:10:29,169 --> 00:10:34,269
this origin you can also launch those

233
00:10:32,079 --> 00:10:36,758
attacks nobody in the hotel guests

234
00:10:34,269 --> 00:10:38,949
industry is going to check if the SSID

235
00:10:36,759 --> 00:10:41,259
is from their home only they want is to

236
00:10:38,949 --> 00:10:42,939
log in and have internet and this is the

237
00:10:41,259 --> 00:10:44,410
the reality and say it happens in the

238
00:10:42,939 --> 00:10:46,599
corporate environment if you clone the

239
00:10:44,410 --> 00:10:49,988
captive portal nobody is going to expect

240
00:10:46,600 --> 00:10:54,549
if it's signed by the entity even we're

241
00:10:49,989 --> 00:10:56,919
seeing HTTP still nowadays so Wi-Fi is

242
00:10:54,549 --> 00:10:59,108
still a big time and it works and if you

243
00:10:56,919 --> 00:11:03,639
have a pineapple or enable twin attack

244
00:10:59,109 --> 00:11:06,069
have you heard about evil twin yeah it

245
00:11:03,639 --> 00:11:08,710
will just make things easier to show you

246
00:11:06,069 --> 00:11:12,040
I will show you now later Adam

247
00:11:08,710 --> 00:11:14,890
that also the kiosks have as you may

248
00:11:12,040 --> 00:11:16,510
seen there are lots of machines there

249
00:11:14,890 --> 00:11:18,760
around like orange juice machines or

250
00:11:16,510 --> 00:11:20,680
whatever and once you poke them with

251
00:11:18,760 --> 00:11:22,630
sticky keys remember the trick from the

252
00:11:20,680 --> 00:11:24,880
sticky keys like pressing seven times

253
00:11:22,630 --> 00:11:27,160
the shift and then pops up you go out of

254
00:11:24,880 --> 00:11:29,770
the kiosk mode many times and then you

255
00:11:27,160 --> 00:11:32,890
can just pop by with the help file and

256
00:11:29,770 --> 00:11:34,660
get to the CMD and depends how it's well

257
00:11:32,890 --> 00:11:36,550
done which normally doesn't you

258
00:11:34,660 --> 00:11:40,120
compromise that machine in seven seconds

259
00:11:36,550 --> 00:11:42,279
or seven strikes as I say also with the

260
00:11:40,120 --> 00:11:44,560
fingers you will see now next slides how

261
00:11:42,279 --> 00:11:46,510
you can play with all these skills just

262
00:11:44,560 --> 00:11:48,760
by touching it and once you touch them

263
00:11:46,510 --> 00:11:51,189
you just get outside of that kiosk and

264
00:11:48,760 --> 00:11:54,010
once then you can do plenty of damage

265
00:11:51,190 --> 00:11:56,020
because you know guess what you do you

266
00:11:54,010 --> 00:11:58,209
think they segment the network of these

267
00:11:56,020 --> 00:12:00,670
kiosks or they're on the corporate

268
00:11:58,209 --> 00:12:03,339
network most of the times our corporate

269
00:12:00,670 --> 00:12:06,660
network like ninety percent of the times

270
00:12:03,339 --> 00:12:09,370
to be able I T to manage they don't

271
00:12:06,660 --> 00:12:10,719
segment the the network right

272
00:12:09,370 --> 00:12:12,010
and after you can just play with the

273
00:12:10,720 --> 00:12:14,500
Turner blue or your favorite trick

274
00:12:12,010 --> 00:12:15,580
pop-up a shell in that machine be an

275
00:12:14,500 --> 00:12:20,339
admin and from there

276
00:12:15,580 --> 00:12:22,779
just play the game right so this is also

277
00:12:20,339 --> 00:12:24,930
let's see if it works because Internet

278
00:12:22,779 --> 00:12:24,930
is

279
00:12:27,070 --> 00:12:34,509
this is also a machine we had in our

280
00:12:31,600 --> 00:12:35,259
office it was a cyber mirror have you

281
00:12:34,509 --> 00:12:38,380
heard about that

282
00:12:35,259 --> 00:12:40,750
it's a internet of device actually it's

283
00:12:38,380 --> 00:12:42,310
a Linux machine it's a mirror normally

284
00:12:40,750 --> 00:12:45,430
it's in the reception's or in the suite

285
00:12:42,310 --> 00:12:47,829
switched rooms so guests can when they

286
00:12:45,430 --> 00:12:49,839
shave they can watch videos in YouTube

287
00:12:47,829 --> 00:12:53,138
they can check their Facebook Twitter

288
00:12:49,839 --> 00:12:57,000
etc we ask the customer to give us the

289
00:12:53,139 --> 00:12:58,990
mirror and we were able to obviously

290
00:12:57,000 --> 00:13:00,850
compromise the mirror and we were

291
00:12:58,990 --> 00:13:03,699
playing with also with our Internet of

292
00:13:00,850 --> 00:13:05,110
Things and lights fishing hui Philip

293
00:13:03,699 --> 00:13:08,500
squid do you heard about that

294
00:13:05,110 --> 00:13:12,279
so we even figured out that once we get

295
00:13:08,500 --> 00:13:15,490
the shell on that mirror our lights is

296
00:13:12,279 --> 00:13:17,589
going to get green and this is something

297
00:13:15,490 --> 00:13:19,750
visual for us to say ok they need to be

298
00:13:17,589 --> 00:13:21,970
waiting on the listener whatever it's a

299
00:13:19,750 --> 00:13:24,610
nice visual effect that when I see green

300
00:13:21,970 --> 00:13:26,560
it's okay when I see red it's because

301
00:13:24,610 --> 00:13:29,410
they kill the process that we popped up

302
00:13:26,560 --> 00:13:31,869
on that machine showing this means that

303
00:13:29,410 --> 00:13:34,680
people are don't realize that behind

304
00:13:31,870 --> 00:13:37,870
this the Rice's are actually full

305
00:13:34,680 --> 00:13:40,269
operating system machines and the mirror

306
00:13:37,870 --> 00:13:44,019
itself we compromise it by a pen drive

307
00:13:40,269 --> 00:13:47,230
USB Drive and you couldn't get roots but

308
00:13:44,019 --> 00:13:49,149
just putting the any USB Drive out

309
00:13:47,230 --> 00:13:51,490
around popped up from I think it was a

310
00:13:49,149 --> 00:13:53,110
boon to behind it once there you made a

311
00:13:51,490 --> 00:13:56,319
shortcut you made a shortcut to the

312
00:13:53,110 --> 00:13:58,300
terminal you do sudo - I and with

313
00:13:56,319 --> 00:13:58,750
privileges it was not sanitized and your

314
00:13:58,300 --> 00:14:03,399
wait

315
00:13:58,750 --> 00:14:05,980
so that was like a big laugh for our

316
00:14:03,399 --> 00:14:08,649
team but this is the reality so the

317
00:14:05,980 --> 00:14:09,970
message here is that hotels don't know

318
00:14:08,649 --> 00:14:12,220
that if you can compromise these

319
00:14:09,970 --> 00:14:16,180
machines from there much from dead box

320
00:14:12,220 --> 00:14:19,120
you can put key loggers you can hop on

321
00:14:16,180 --> 00:14:23,500
other networks etc right this is in the

322
00:14:19,120 --> 00:14:26,770
boat with my friend this is a I

323
00:14:23,500 --> 00:14:30,220
I think it was a iPad behind it look how

324
00:14:26,770 --> 00:14:32,260
difficult was to hack this well and see

325
00:14:30,220 --> 00:14:37,140
the internet because I use Google

326
00:14:32,260 --> 00:14:40,450
this was our hardest hacking process

327
00:14:37,140 --> 00:14:43,390
three seconds it was I call it the magic

328
00:14:40,450 --> 00:14:45,970
five fingers and it's in the boat right

329
00:14:43,390 --> 00:14:51,069
so this is something that's that's

330
00:14:45,970 --> 00:14:53,110
happening also we with all this internet

331
00:14:51,070 --> 00:14:55,870
of things by land and stuff we figure

332
00:14:53,110 --> 00:14:58,840
out many hotels have their music systems

333
00:14:55,870 --> 00:15:01,450
also connected to the web systems and

334
00:14:58,840 --> 00:15:02,290
devices so the whole sound of the hotel

335
00:15:01,450 --> 00:15:05,200
you know when you're in the swimming

336
00:15:02,290 --> 00:15:07,150
pool listening chill-out music or

337
00:15:05,200 --> 00:15:10,480
whatever you like you can compromise

338
00:15:07,150 --> 00:15:13,150
that and play some sounds how do we do

339
00:15:10,480 --> 00:15:15,070
that in this case it was many of the

340
00:15:13,150 --> 00:15:17,920
times you just fish the password of the

341
00:15:15,070 --> 00:15:22,180
of the device because most of the times

342
00:15:17,920 --> 00:15:24,750
are even cloud-based solutions for

343
00:15:22,180 --> 00:15:27,459
hotels for music and once the

344
00:15:24,750 --> 00:15:29,500
receptionist gets that email we fish

345
00:15:27,460 --> 00:15:30,850
them we get the credentials nothing

346
00:15:29,500 --> 00:15:34,090
fancy about that or man-in-the-middle

347
00:15:30,850 --> 00:15:37,390
still works in some cases and they use

348
00:15:34,090 --> 00:15:39,280
also default passwords and I want you to

349
00:15:37,390 --> 00:15:41,410
think that most of the time we have fun

350
00:15:39,280 --> 00:15:43,510
hacking this type of things but

351
00:15:41,410 --> 00:15:45,640
switching music to a bond Ballard in a

352
00:15:43,510 --> 00:15:47,050
hotel of you know whatever stars you

353
00:15:45,640 --> 00:15:49,420
want to have what do you think the

354
00:15:47,050 --> 00:15:51,520
impact would be on the guests what would

355
00:15:49,420 --> 00:15:53,620
you do what would you do if you're in

356
00:15:51,520 --> 00:15:56,050
the swim pool and you hear a fire alert

357
00:15:53,620 --> 00:15:58,090
in the whole sound system of the hotels

358
00:15:56,050 --> 00:16:01,300
would you stay there for a beer or would

359
00:15:58,090 --> 00:16:04,210
you run and possibly fall and who knows

360
00:16:01,300 --> 00:16:06,160
can happen right so this is we did this

361
00:16:04,210 --> 00:16:09,760
in Christmas I think I don't know if

362
00:16:06,160 --> 00:16:11,560
this is the sound is working but

363
00:16:09,760 --> 00:16:13,870
basically if not because Google

364
00:16:11,560 --> 00:16:16,369
sometimes messes around

365
00:16:13,870 --> 00:16:22,750
mm-hmm I will show you later but

366
00:16:16,370 --> 00:16:26,330
basically we figured out that this

367
00:16:22,750 --> 00:16:28,550
another slide but basically at 12:50

368
00:16:26,330 --> 00:16:32,240
what we made the christmas carol stopped

369
00:16:28,550 --> 00:16:33,560
and at 12:50 one second the music starts

370
00:16:32,240 --> 00:16:35,450
in the whole hotel with the permission

371
00:16:33,560 --> 00:16:38,209
of the customer and it was Skrillex

372
00:16:35,450 --> 00:16:42,110
music you know Skrillex so the faces

373
00:16:38,210 --> 00:16:44,660
were quite funny but we also did a low

374
00:16:42,110 --> 00:16:47,360
volume and you can obviously upload any

375
00:16:44,660 --> 00:16:49,610
mp3 file or what filing in even that

376
00:16:47,360 --> 00:16:51,260
case and it was all systems we also

377
00:16:49,610 --> 00:16:54,350
found many system with no default

378
00:16:51,260 --> 00:16:57,230
password on South systems in hotels so

379
00:16:54,350 --> 00:16:58,880
if you scrape the portals HTTP portals

380
00:16:57,230 --> 00:17:01,100
in that environment and especially

381
00:16:58,880 --> 00:17:05,599
internal you can you can find it right

382
00:17:01,100 --> 00:17:07,040
so yeah and what also worked in hotels

383
00:17:05,599 --> 00:17:09,198
printers the interest is that the

384
00:17:07,040 --> 00:17:12,889
classic things will always work because

385
00:17:09,199 --> 00:17:13,610
they are not very savvy security

386
00:17:12,890 --> 00:17:15,800
oriented

387
00:17:13,609 --> 00:17:18,229
I'm talking especially about local

388
00:17:15,800 --> 00:17:19,790
hotels the big branches like like you

389
00:17:18,230 --> 00:17:21,589
know maybe they have their obviously

390
00:17:19,790 --> 00:17:23,809
their sock teams there is in response

391
00:17:21,589 --> 00:17:25,698
teams that's a another level story but

392
00:17:23,809 --> 00:17:30,170
for 80 percent of the hotels which still

393
00:17:25,699 --> 00:17:31,880
remain local these things works so brute

394
00:17:30,170 --> 00:17:35,840
force in internal portals we were able

395
00:17:31,880 --> 00:17:41,140
to get credentials having used the the

396
00:17:35,840 --> 00:17:45,740
SMB relay attack anyone ends up know

397
00:17:41,140 --> 00:17:49,429
nobody if you find that the SMB relay

398
00:17:45,740 --> 00:17:51,770
attack you will get domain credentials

399
00:17:49,429 --> 00:17:53,630
basically it maybe one hour or two hours

400
00:17:51,770 --> 00:17:56,000
depending on the traffic of the assembly

401
00:17:53,630 --> 00:17:58,550
in the shares in the environment once

402
00:17:56,000 --> 00:18:00,710
you get domain credentials you know this

403
00:17:58,550 --> 00:18:04,879
story so that worked every single time

404
00:18:00,710 --> 00:18:07,100
and you get it with no no effort the

405
00:18:04,880 --> 00:18:08,510
patching systems always also fails

406
00:18:07,100 --> 00:18:10,969
there's so many machines vulnerable

407
00:18:08,510 --> 00:18:13,340
eternal blue or blue keep whatever pops

408
00:18:10,970 --> 00:18:15,470
up that we are able to get there and

409
00:18:13,340 --> 00:18:17,959
induce him and pass the hash lateral

410
00:18:15,470 --> 00:18:19,880
movements and hop on different segments

411
00:18:17,960 --> 00:18:21,410
because high tea in the hotels or

412
00:18:19,880 --> 00:18:22,250
anywhere around they tell us

413
00:18:21,410 --> 00:18:25,670
yes everything

414
00:18:22,250 --> 00:18:27,110
segmented and it's yes because it's not

415
00:18:25,670 --> 00:18:29,840
really segmented they are just

416
00:18:27,110 --> 00:18:31,100
pretending it's not even sometimes

417
00:18:29,840 --> 00:18:34,340
villains are even not properly

418
00:18:31,100 --> 00:18:37,310
configured right so awareness is not

419
00:18:34,340 --> 00:18:38,840
very good in in the in this industry we

420
00:18:37,310 --> 00:18:41,120
even fished with second factor

421
00:18:38,840 --> 00:18:43,490
authentication because people say oh you

422
00:18:41,120 --> 00:18:46,310
cannot do fishing with that you know all

423
00:18:43,490 --> 00:18:48,830
of you can steal the session still and

424
00:18:46,310 --> 00:18:51,740
the cookie at the same time login to the

425
00:18:48,830 --> 00:18:53,540
to the website and use that cookie for

426
00:18:51,740 --> 00:18:55,760
once even with second factor

427
00:18:53,540 --> 00:18:59,000
authentication so if you do those tricks

428
00:18:55,760 --> 00:19:01,310
usually I mean this is our reality it

429
00:18:59,000 --> 00:19:04,550
works obviously need to be you know very

430
00:19:01,310 --> 00:19:07,429
on the keyboard but we have seen good

431
00:19:04,550 --> 00:19:11,990
good results and now we also have this

432
00:19:07,430 --> 00:19:13,880
fate fatality combat in the next attack

433
00:19:11,990 --> 00:19:17,180
which is the phishing attack that we

434
00:19:13,880 --> 00:19:22,900
always do I'm sure have you heard the

435
00:19:17,180 --> 00:19:25,610
fraud Co attack right fraud fee attack

436
00:19:22,900 --> 00:19:30,410
this is the best phishing attack yeah

437
00:19:25,610 --> 00:19:32,840
basically it's its base that you need to

438
00:19:30,410 --> 00:19:35,270
pretend to be a customer from the hotel

439
00:19:32,840 --> 00:19:37,820
or whatever thing you're doing in the

440
00:19:35,270 --> 00:19:39,620
pen testing and you have to fake or the

441
00:19:37,820 --> 00:19:41,030
invoice which I think it's too risky and

442
00:19:39,620 --> 00:19:44,929
this is the lessons we learned it

443
00:19:41,030 --> 00:19:47,120
actually never works because the invoice

444
00:19:44,930 --> 00:19:49,580
when it gets to the person who is paying

445
00:19:47,120 --> 00:19:51,409
the invoice will just watch and say hey

446
00:19:49,580 --> 00:19:53,990
this is not an invoice that I recognized

447
00:19:51,410 --> 00:19:56,240
right so what the attackers usually are

448
00:19:53,990 --> 00:19:58,550
doing and what we did in our scenarios

449
00:19:56,240 --> 00:20:01,160
was just to say that the bank at a bank

450
00:19:58,550 --> 00:20:03,790
account was changed this is a much more

451
00:20:01,160 --> 00:20:06,050
elegant approach and it works

452
00:20:03,790 --> 00:20:09,500
90% of the time that we've done it so

453
00:20:06,050 --> 00:20:12,139
how does it work you send first you fish

454
00:20:09,500 --> 00:20:14,630
your customer right you get the

455
00:20:12,140 --> 00:20:15,980
credentials and you get their emails the

456
00:20:14,630 --> 00:20:17,770
first thing you're going to search what

457
00:20:15,980 --> 00:20:22,340
is what do you think are in the search

458
00:20:17,770 --> 00:20:23,930
invoices invoices right so you see

459
00:20:22,340 --> 00:20:25,750
invoices and lots of emails with

460
00:20:23,930 --> 00:20:28,400
invoices and you see any kind of period

461
00:20:25,750 --> 00:20:31,760
do you see the provider and you only

462
00:20:28,400 --> 00:20:32,920
have to spoof that email against it

463
00:20:31,760 --> 00:20:35,980
because nobody has the recipe

464
00:20:32,920 --> 00:20:38,710
SPF and Demark set it properly so once

465
00:20:35,980 --> 00:20:40,930
you do that you attached a word document

466
00:20:38,710 --> 00:20:43,390
with the bank statement that you change

467
00:20:40,930 --> 00:20:46,270
the bank account where do you get a logo

468
00:20:43,390 --> 00:20:48,340
from the bank Google right so you just

469
00:20:46,270 --> 00:20:50,440
put the logo Bank you just put the new

470
00:20:48,340 --> 00:20:52,959
bank account is this and we're changing

471
00:20:50,440 --> 00:20:55,390
this because of an audit that we're

472
00:20:52,960 --> 00:20:58,420
having right now with the light or

473
00:20:55,390 --> 00:21:00,160
whatever company fancy KPMG that now

474
00:20:58,420 --> 00:21:02,380
they're giving a talk you can just put

475
00:21:00,160 --> 00:21:05,740
that send the email and the trick is

476
00:21:02,380 --> 00:21:08,140
also that to this phishing cast victim

477
00:21:05,740 --> 00:21:10,750
you need to spoof a phone call have you

478
00:21:08,140 --> 00:21:14,620
done spoof calls with voice over IP and

479
00:21:10,750 --> 00:21:16,440
spoofing the header when you call never

480
00:21:14,620 --> 00:21:19,179
do that it still works

481
00:21:16,440 --> 00:21:20,950
like nowadays and it's super easy to

482
00:21:19,180 --> 00:21:23,470
demonstrate the later of the talk

483
00:21:20,950 --> 00:21:25,360
somebody wants you only need to know the

484
00:21:23,470 --> 00:21:27,130
true phone calls right from the from the

485
00:21:25,360 --> 00:21:28,179
victim and from the provider that you're

486
00:21:27,130 --> 00:21:30,310
pretending to be

487
00:21:28,180 --> 00:21:32,800
once the provider gets the phone call

488
00:21:30,310 --> 00:21:36,700
and sees in his or her phone that this

489
00:21:32,800 --> 00:21:38,830
is Peter from from your own provider

490
00:21:36,700 --> 00:21:41,220
department you just take the phone and

491
00:21:38,830 --> 00:21:44,980
you speak with them and what do you say

492
00:21:41,220 --> 00:21:46,330
I'm asking what do you say I'm Peter but

493
00:21:44,980 --> 00:21:48,820
they will say you're not Peter your

494
00:21:46,330 --> 00:21:50,169
voice change what happened with Peter so

495
00:21:48,820 --> 00:21:52,149
the only thing you have to say is that

496
00:21:50,170 --> 00:21:54,430
Peter is not here Peter asked me for

497
00:21:52,150 --> 00:21:56,980
this big favor we're in a mess with this

498
00:21:54,430 --> 00:21:58,870
audit everybody's going crazy I'm just

499
00:21:56,980 --> 00:22:03,040
going to send you an email with this new

500
00:21:58,870 --> 00:22:05,169
bank statement officially stamped with

501
00:22:03,040 --> 00:22:07,090
our new bank account it's okay that with

502
00:22:05,170 --> 00:22:11,250
you yeah sure send it this morning okay

503
00:22:07,090 --> 00:22:14,020
you wait one hour you send an email and

504
00:22:11,250 --> 00:22:15,580
we actually the CEO of the company

505
00:22:14,020 --> 00:22:17,980
normally gives us a bank account

506
00:22:15,580 --> 00:22:20,800
internal bank account and we see our

507
00:22:17,980 --> 00:22:23,640
biggest phishing attack was fifty

508
00:22:20,800 --> 00:22:26,320
something thousand euros that

509
00:22:23,640 --> 00:22:28,420
pop-pop-pop by in another account only

510
00:22:26,320 --> 00:22:30,939
because you did a fishing with spoofing

511
00:22:28,420 --> 00:22:34,810
email account you can mess up with

512
00:22:30,940 --> 00:22:36,430
Bluetooth also and try to you know be

513
00:22:34,810 --> 00:22:38,020
more intrusive in against that we

514
00:22:36,430 --> 00:22:40,540
usually don't do that this is a much

515
00:22:38,020 --> 00:22:41,840
simpler approach and this is something

516
00:22:40,540 --> 00:22:44,440
works everything

517
00:22:41,840 --> 00:22:46,970
time so if you want to investigate

518
00:22:44,440 --> 00:22:48,950
search for the time being which is you

519
00:22:46,970 --> 00:22:50,900
know everybody has now a term for all

520
00:22:48,950 --> 00:22:53,570
these kind of things and you will see

521
00:22:50,900 --> 00:22:56,419
that setting up this assignment is easy

522
00:22:53,570 --> 00:22:59,149
from the approach from airlines or

523
00:22:56,419 --> 00:23:00,860
airports whatever you know that many

524
00:22:59,150 --> 00:23:04,070
airlines are pronounced free Wi-Fi right

525
00:23:00,860 --> 00:23:06,559
onboard so we had a flight and this

526
00:23:04,070 --> 00:23:10,970
slide didn't had Wi-Fi so what do you

527
00:23:06,559 --> 00:23:12,918
think we did we give you wiser you only

528
00:23:10,970 --> 00:23:14,840
need to put the faces I did with the

529
00:23:12,919 --> 00:23:17,480
same thing and a similar portal right

530
00:23:14,840 --> 00:23:23,149
what do you think the customers of that

531
00:23:17,480 --> 00:23:26,779
flight did they connect to us so once

532
00:23:23,149 --> 00:23:28,699
they connect to us we also I will show

533
00:23:26,779 --> 00:23:31,580
you the evil twin things so you can see

534
00:23:28,700 --> 00:23:34,580
where you can play in this case

535
00:23:31,580 --> 00:23:37,879
obviously this is a demo with Internet

536
00:23:34,580 --> 00:23:39,620
but even it will work if if it's it so

537
00:23:37,880 --> 00:23:41,960
you connect to this free Wi-Fi this is

538
00:23:39,620 --> 00:23:44,629
your mobile phone or whatever you open a

539
00:23:41,960 --> 00:23:47,179
web site which is the Spanish newspaper

540
00:23:44,630 --> 00:23:50,779
we have and it says very wait before you

541
00:23:47,179 --> 00:23:52,179
can you know surf the web this is the

542
00:23:50,779 --> 00:23:55,220
demo purpose that's why we did it so

543
00:23:52,179 --> 00:23:57,590
obvious you need to link with your

544
00:23:55,220 --> 00:23:59,659
LinkedIn account haven't you seen those

545
00:23:57,590 --> 00:24:01,309
like to open something you need to link

546
00:23:59,659 --> 00:24:03,770
with your account Gmail Facebook

547
00:24:01,309 --> 00:24:05,570
whatever so you put just link it in in

548
00:24:03,770 --> 00:24:07,220
this case and the funny thing is that

549
00:24:05,570 --> 00:24:09,980
when we were doing this presentation in

550
00:24:07,220 --> 00:24:12,380
Canary Islands the it was for

551
00:24:09,980 --> 00:24:14,929
non-technical like zero like executive

552
00:24:12,380 --> 00:24:16,940
people and during the talk somebody

553
00:24:14,929 --> 00:24:19,730
connected and put the link it's

554
00:24:16,940 --> 00:24:23,299
accountant and we were like telling 300

555
00:24:19,730 --> 00:24:24,679
times that it's a fake access point and

556
00:24:23,299 --> 00:24:26,629
we are going to steal your password

557
00:24:24,679 --> 00:24:32,120
still somebody do that

558
00:24:26,630 --> 00:24:34,190
true story I don't BS and the truth

559
00:24:32,120 --> 00:24:36,770
about this is obviously it's a deadly

560
00:24:34,190 --> 00:24:38,510
attack and also you can force people to

561
00:24:36,770 --> 00:24:42,620
connect to Ewings in most of the

562
00:24:38,510 --> 00:24:43,940
occasions so you can just you know when

563
00:24:42,620 --> 00:24:47,629
you see that you are already connected

564
00:24:43,940 --> 00:24:49,610
you don't have to pretend and ask people

565
00:24:47,630 --> 00:24:52,340
to connect to you you can optimize that

566
00:24:49,610 --> 00:24:54,530
and if you're lazy like us we also

567
00:24:52,340 --> 00:24:57,230
cloned a captive portal in the flight

568
00:24:54,530 --> 00:24:59,480
and you just ask stupid questions so

569
00:24:57,230 --> 00:25:01,520
it's a form to get online and you're

570
00:24:59,480 --> 00:25:03,470
like okay what's your seat number the

571
00:25:01,520 --> 00:25:05,690
seat number what's your favorite color

572
00:25:03,470 --> 00:25:07,310
they put the favorite color what's your

573
00:25:05,690 --> 00:25:11,990
ID no we asked even what is the capital

574
00:25:07,310 --> 00:25:13,790
of Moscow and people said Russia so they

575
00:25:11,990 --> 00:25:17,920
don't even they don't care they just

576
00:25:13,790 --> 00:25:21,129
want the Internet like leave me alone

577
00:25:17,920 --> 00:25:24,080
even then we made it even a longer

578
00:25:21,130 --> 00:25:27,620
survey just to see that this is not

579
00:25:24,080 --> 00:25:30,520
gonna work and believe me 60% we're

580
00:25:27,620 --> 00:25:32,510
still trying to log in and put the data

581
00:25:30,520 --> 00:25:34,190
obviously I'm not somebody who's going

582
00:25:32,510 --> 00:25:36,110
to say if it's fake or not the data but

583
00:25:34,190 --> 00:25:38,750
the true stories that I've seen this

584
00:25:36,110 --> 00:25:41,000
with our my own eyes and it's not like a

585
00:25:38,750 --> 00:25:43,220
newspaper that says careful with why

586
00:25:41,000 --> 00:25:46,160
fights if you want to try it try it and

587
00:25:43,220 --> 00:25:49,340
you will see that people on board to get

588
00:25:46,160 --> 00:25:50,720
internet are going to do anything and my

589
00:25:49,340 --> 00:25:53,300
question to you is that if it's an a

590
00:25:50,720 --> 00:25:56,720
targeted attack to one of the executives

591
00:25:53,300 --> 00:25:58,790
imagine that's movie time the victim is

592
00:25:56,720 --> 00:26:01,670
not going to go anywhere so you have

593
00:25:58,790 --> 00:26:05,450
maybe five hours to really go against a

594
00:26:01,670 --> 00:26:08,990
certain person and you can quite easily

595
00:26:05,450 --> 00:26:11,960
do that that's that's the story also we

596
00:26:08,990 --> 00:26:14,330
have done some airlines they're quite

597
00:26:11,960 --> 00:26:17,150
fit the airlines sorry to be rude but

598
00:26:14,330 --> 00:26:18,409
some of them had you know to check-in

599
00:26:17,150 --> 00:26:20,390
and book

600
00:26:18,410 --> 00:26:21,920
make your check-in online they only

601
00:26:20,390 --> 00:26:24,890
asked you for your airport from where

602
00:26:21,920 --> 00:26:27,110
you leaving and the booking code have

603
00:26:24,890 --> 00:26:28,820
you seen those and most of the time they

604
00:26:27,110 --> 00:26:31,490
don't even have captures they don't

605
00:26:28,820 --> 00:26:33,500
block your you can circumvent their

606
00:26:31,490 --> 00:26:35,570
blocking issues so you can brute force

607
00:26:33,500 --> 00:26:38,300
the check-ins because I think it's six

608
00:26:35,570 --> 00:26:40,040
six digits the code and the

609
00:26:38,300 --> 00:26:41,960
airport origins is just a list so if you

610
00:26:40,040 --> 00:26:43,639
combine those two you can brute force

611
00:26:41,960 --> 00:26:45,670
and have all the booking codes we did

612
00:26:43,640 --> 00:26:49,340
this with an airline quite big one and

613
00:26:45,670 --> 00:26:51,320
they fix it so if you see somebody with

614
00:26:49,340 --> 00:26:53,060
an airline for check-in has this type of

615
00:26:51,320 --> 00:26:55,850
things

616
00:26:53,060 --> 00:26:58,010
you get scared because it's it's not

617
00:26:55,850 --> 00:27:00,500
it's not good and this one is also good

618
00:26:58,010 --> 00:27:03,110
which is the QR code every time it also

619
00:27:00,500 --> 00:27:04,730
works if you put free beer and you do a

620
00:27:03,110 --> 00:27:07,459
good design and you post it in the

621
00:27:04,730 --> 00:27:09,830
swimming pool of the hotels it will

622
00:27:07,460 --> 00:27:11,800
definitely work and then you can just

623
00:27:09,830 --> 00:27:15,250
use this information maybe to get more

624
00:27:11,800 --> 00:27:18,620
advanced attack about their customers

625
00:27:15,250 --> 00:27:21,500
we've done even anything from upgrades

626
00:27:18,620 --> 00:27:24,260
to free beer and usually it works the

627
00:27:21,500 --> 00:27:26,240
message here is that the less use the

628
00:27:24,260 --> 00:27:28,610
less you think about the approach and

629
00:27:26,240 --> 00:27:30,860
something more rational it will always

630
00:27:28,610 --> 00:27:33,590
work like if you try to mess up a big

631
00:27:30,860 --> 00:27:35,120
story and complex thing of the QR code

632
00:27:33,590 --> 00:27:35,659
it will not work people will not even

633
00:27:35,120 --> 00:27:37,340
read it

634
00:27:35,660 --> 00:27:39,950
I'm sure if you put a code right there

635
00:27:37,340 --> 00:27:43,159
and you say free rakia somebody's going

636
00:27:39,950 --> 00:27:45,620
to scan right at least I would so behind

637
00:27:43,160 --> 00:27:48,110
this message you can obviously use it as

638
00:27:45,620 --> 00:27:51,290
a vector attack about approaching the

639
00:27:48,110 --> 00:27:53,270
day right and the last part that I want

640
00:27:51,290 --> 00:27:56,600
to show you the physical security you

641
00:27:53,270 --> 00:28:01,490
can always do that maybe sometimes works

642
00:27:56,600 --> 00:28:04,429
sometimes doesn't work but have you

643
00:28:01,490 --> 00:28:06,440
heard about the proxmark the the thing I

644
00:28:04,430 --> 00:28:09,740
have the Chinese the cheap version sorry

645
00:28:06,440 --> 00:28:13,490
have you heard about this yeah if not

646
00:28:09,740 --> 00:28:15,140
check it out and the idea is that first

647
00:28:13,490 --> 00:28:18,680
I will show you more like what it is so

648
00:28:15,140 --> 00:28:21,980
it will emulate RFID NFC it can clone

649
00:28:18,680 --> 00:28:24,650
cards like this like hotel cards or key

650
00:28:21,980 --> 00:28:27,680
cards or whatever and you can use it

651
00:28:24,650 --> 00:28:29,900
offline against some types of lag if you

652
00:28:27,680 --> 00:28:32,660
have a battery external etc right so the

653
00:28:29,900 --> 00:28:35,390
idea behind it is that every single key

654
00:28:32,660 --> 00:28:36,380
especially in my my fare I semi-fat it

655
00:28:35,390 --> 00:28:39,530
or it's my fare

656
00:28:36,380 --> 00:28:42,020
I guess it has a unique code your ID

657
00:28:39,530 --> 00:28:44,629
which needs to capture it clone it put

658
00:28:42,020 --> 00:28:47,420
it on the new key and brute force or get

659
00:28:44,630 --> 00:28:48,110
the whole encryption level inside these

660
00:28:47,420 --> 00:28:51,400
keys right

661
00:28:48,110 --> 00:28:54,800
some hotels use other keys but usually

662
00:28:51,400 --> 00:28:57,230
Mifare classic is a winner usually they

663
00:28:54,800 --> 00:28:59,960
use this in transport they use it in

664
00:28:57,230 --> 00:29:02,509
I've seen in a theme park that I have to

665
00:28:59,960 --> 00:29:05,330
for my little daughter because then you

666
00:29:02,509 --> 00:29:06,619
have free credit in the theme park so if

667
00:29:05,330 --> 00:29:10,189
you are able to clone it

668
00:29:06,619 --> 00:29:12,678
maybe the mess around with attitude you

669
00:29:10,190 --> 00:29:15,499
need to decrypt as I mentioned the the

670
00:29:12,679 --> 00:29:17,450
casing in the key a and key B in this

671
00:29:15,499 --> 00:29:19,759
case and once you get those keys you can

672
00:29:17,450 --> 00:29:22,549
clone it dump it and then what you do is

673
00:29:19,759 --> 00:29:25,309
restore it on a new card and if you have

674
00:29:22,549 --> 00:29:28,009
the perfect match and the perfect code

675
00:29:25,309 --> 00:29:30,590
you have a new key in hotels it's true

676
00:29:28,009 --> 00:29:32,779
that it's not so easy as it's apparent

677
00:29:30,590 --> 00:29:35,629
this is not telling like every single

678
00:29:32,779 --> 00:29:41,360
time you can do that but for this case

679
00:29:35,629 --> 00:29:44,090
that I brought a nice nice to show you I

680
00:29:41,360 --> 00:29:46,639
will show you if how what's the approach

681
00:29:44,090 --> 00:29:48,470
behind it you can always script all

682
00:29:46,639 --> 00:29:50,809
these things as you know so you can make

683
00:29:48,470 --> 00:29:55,759
it harder in case it fails I have a

684
00:29:50,809 --> 00:29:59,330
video so I will try to do that now so as

685
00:29:55,759 --> 00:30:03,559
you see this is the device and as you

686
00:29:59,330 --> 00:30:10,730
see the it's not moving right yeah so if

687
00:30:03,559 --> 00:30:17,080
I have invalid key it's still a movie

688
00:30:10,730 --> 00:30:21,090
right if it's the right tip unlocked

689
00:30:17,080 --> 00:30:24,720
works right what

690
00:30:21,090 --> 00:30:29,870
okay so now let's use the invalid key

691
00:30:24,720 --> 00:30:29,870
remember the one that doesn't work okay

692
00:30:31,310 --> 00:30:36,470
is the boring part so bear with me

693
00:30:39,090 --> 00:30:44,418
so first I am and I hope this is plugged

694
00:30:42,240 --> 00:30:44,419
in

695
00:30:44,940 --> 00:30:55,979
okay so the key is detected you see the

696
00:30:47,700 --> 00:30:59,309
UID is 0 1 0 2 0 3 0 4 right yeah you

697
00:30:55,979 --> 00:31:02,639
see it so what you obviously we need now

698
00:30:59,309 --> 00:31:04,918
the key of the real key so the attack

699
00:31:02,639 --> 00:31:09,899
vector is that you need to be stealing

700
00:31:04,919 --> 00:31:12,690
this key for if you do it fast maybe 60

701
00:31:09,899 --> 00:31:15,178
seconds so in that time when somebody

702
00:31:12,690 --> 00:31:17,129
takes Araki our beer and they leave

703
00:31:15,179 --> 00:31:23,179
their key on the table to take your

704
00:31:17,129 --> 00:31:23,178
proxmark and and you do this

705
00:31:23,750 --> 00:31:28,730
so you see the you IDs here it this is

706
00:31:26,120 --> 00:31:33,979
the real all right so you just copy that

707
00:31:28,730 --> 00:31:39,190
and save it take out the key put the new

708
00:31:33,980 --> 00:31:44,500
your your spare key whatever to clone it

709
00:31:39,190 --> 00:31:44,500
okay now in the command to be faster

710
00:31:51,530 --> 00:32:01,330
so well now what we are going to do is

711
00:31:55,930 --> 00:32:01,330
brute force with the dictionary attack

712
00:32:01,360 --> 00:32:06,699
against the key the original one sorry

713
00:32:11,660 --> 00:32:16,610
so you see these are the keys that are

714
00:32:14,120 --> 00:32:17,899
found obviously this is a much faster

715
00:32:16,610 --> 00:32:21,409
approach because there are some keys

716
00:32:17,900 --> 00:32:23,330
that we couldn't found so we had to to

717
00:32:21,410 --> 00:32:30,100
speed up the the things for to them okay

718
00:32:23,330 --> 00:32:30,100
so once we have it we put a new key

719
00:32:31,010 --> 00:32:37,330
okay and then we can dump

720
00:32:41,730 --> 00:32:46,070
and sorry because we had to dump this

721
00:32:43,830 --> 00:32:46,070
one

722
00:32:49,900 --> 00:32:52,500
right

723
00:33:04,220 --> 00:33:08,470
okay so sample the key

724
00:33:16,840 --> 00:33:19,340
so now we are writing the damp to the

725
00:33:18,970 --> 00:33:22,510
new key

726
00:33:19,340 --> 00:33:22,510
[Music]

727
00:33:33,570 --> 00:33:41,730
we also need to put

728
00:33:37,660 --> 00:33:41,730
the key before

729
00:34:10,929 --> 00:34:14,310
France would be

730
00:34:21,739 --> 00:34:27,449
okay

731
00:34:23,310 --> 00:34:34,159
I think it should work if not you can

732
00:34:27,449 --> 00:34:37,879
throw stones block sorry from this side

733
00:34:34,159 --> 00:34:37,879
okay did you see

734
00:34:39,790 --> 00:34:52,190
yeah no applause first the real the real

735
00:34:50,300 --> 00:34:54,530
stories that we have this only for a

736
00:34:52,190 --> 00:34:56,690
week like we are messing it round right

737
00:34:54,530 --> 00:34:59,180
now so we are still in this phase of

738
00:34:56,690 --> 00:35:03,380
playing with this thing but from our

739
00:34:59,180 --> 00:35:05,029
point of view it's it's definitely being

740
00:35:03,380 --> 00:35:06,830
a potential thing with this type of

741
00:35:05,030 --> 00:35:08,210
cards and they're like two more things

742
00:35:06,830 --> 00:35:12,310
that I want to just share with you guys

743
00:35:08,210 --> 00:35:13,760
let's see if it's internet is slow

744
00:35:12,310 --> 00:35:15,470
meanwhile there are any questions

745
00:35:13,760 --> 00:35:21,340
because I know you have other talks if

746
00:35:15,470 --> 00:35:21,339
I'm out of the time any other questions

747
00:35:26,780 --> 00:35:32,360
using Google slides sucks with internet

748
00:35:36,650 --> 00:35:41,850
this first serial number you mean the

749
00:35:38,970 --> 00:35:44,669
city you need yeah you just searched

750
00:35:41,850 --> 00:35:51,900
before with the original one you just

751
00:35:44,670 --> 00:35:53,430
copied and then the season ah the

752
00:35:51,900 --> 00:35:56,460
destination car of course it needs to be

753
00:35:53,430 --> 00:36:02,089
totally readable writable like nothing

754
00:35:56,460 --> 00:36:02,090
it needs to be righted on this one yeah

755
00:36:02,900 --> 00:36:08,850
yeah yeah it comes with the bundle it

756
00:36:07,050 --> 00:36:11,550
comes with a bunch of keys obviously

757
00:36:08,850 --> 00:36:12,990
need my files of 4k it's not included so

758
00:36:11,550 --> 00:36:14,580
there are some keys that you will not be

759
00:36:12,990 --> 00:36:17,580
able to perform if you buy those keys

760
00:36:14,580 --> 00:36:19,110
then you can you can do the things the

761
00:36:17,580 --> 00:36:20,730
the thing that I wanted to share with

762
00:36:19,110 --> 00:36:24,750
you is that once you get in a locked

763
00:36:20,730 --> 00:36:26,550
environment like this one or a CPD or or

764
00:36:24,750 --> 00:36:28,590
any because I'm not talking hotel rules

765
00:36:26,550 --> 00:36:30,930
the next thing is that you can deploy

766
00:36:28,590 --> 00:36:33,810
all sorts of toys right have you heard

767
00:36:30,930 --> 00:36:35,520
the land turtle whatever and you just

768
00:36:33,810 --> 00:36:37,529
put a sticker do not remove in the CPD

769
00:36:35,520 --> 00:36:41,310
do you think IT is going to remove it

770
00:36:37,530 --> 00:36:43,710
you know in a complex CPD you have a

771
00:36:41,310 --> 00:36:45,690
sticker and you put do not remove you

772
00:36:43,710 --> 00:36:47,490
think they're going to touch it there is

773
00:36:45,690 --> 00:36:49,590
no way they're going to touch that so

774
00:36:47,490 --> 00:36:51,270
once you put the implant you just put it

775
00:36:49,590 --> 00:36:54,090
there you have a reverse shell on the

776
00:36:51,270 --> 00:36:55,830
other side you go outside and you can

777
00:36:54,090 --> 00:36:58,020
compromise or you can play also with the

778
00:36:55,830 --> 00:36:59,970
with the cable have you sewn seen that

779
00:36:58,020 --> 00:37:03,720
one that the cable of the phone is

780
00:36:59,970 --> 00:37:06,660
actually it has is the same like a USB

781
00:37:03,720 --> 00:37:09,509
execution remotely so you can just

782
00:37:06,660 --> 00:37:12,720
switch inside the room of the person or

783
00:37:09,510 --> 00:37:15,600
the CPD and take their original cable

784
00:37:12,720 --> 00:37:18,209
and just put yours so that that talk of

785
00:37:15,600 --> 00:37:20,160
things can also also work and the last

786
00:37:18,210 --> 00:37:22,400
lesson that we also I want to share with

787
00:37:20,160 --> 00:37:27,180
you from the blue team perspective is

788
00:37:22,400 --> 00:37:30,030
that we had a phishing attack against a

789
00:37:27,180 --> 00:37:33,230
customer and they compromised the email

790
00:37:30,030 --> 00:37:36,150
address of a CEO a very big fear and

791
00:37:33,230 --> 00:37:38,190
obviously and some other users so as any

792
00:37:36,150 --> 00:37:40,110
response you know you watch locks

793
00:37:38,190 --> 00:37:41,430
you reset the passwords in for second

794
00:37:40,110 --> 00:37:44,550
factor authentication those are the

795
00:37:41,430 --> 00:37:48,990
things we do right it's a question yes

796
00:37:44,550 --> 00:37:51,270
or yeah yeah so you are like working

797
00:37:48,990 --> 00:37:53,399
your ass just watching all these things

798
00:37:51,270 --> 00:37:56,820
and the attacker was still inside the

799
00:37:53,400 --> 00:37:59,840
email of this person does anyone know

800
00:37:56,820 --> 00:38:02,570
what happened in this case

801
00:37:59,840 --> 00:38:04,740
what's the dirty trick as an attacker

802
00:38:02,570 --> 00:38:07,230
that you will do if you have an email

803
00:38:04,740 --> 00:38:08,549
address compromised of a big shot in

804
00:38:07,230 --> 00:38:14,970
your organization what's the first thing

805
00:38:08,550 --> 00:38:17,700
you're going to do yes yes yes totally

806
00:38:14,970 --> 00:38:19,620
once like this is way old strict but

807
00:38:17,700 --> 00:38:21,000
then sometimes you're like so stressed

808
00:38:19,620 --> 00:38:23,220
up that you're just watching other

809
00:38:21,000 --> 00:38:25,050
things and you should watch the basic

810
00:38:23,220 --> 00:38:27,330
things like did the attacker put a

811
00:38:25,050 --> 00:38:29,280
forward email address because once he

812
00:38:27,330 --> 00:38:32,690
did it every time the person was

813
00:38:29,280 --> 00:38:32,690
receiving was bouncing to the attacker

814
00:38:37,480 --> 00:38:44,130
that already and rule that

815
00:38:41,280 --> 00:38:46,900
you have to check all the rules and

816
00:38:44,130 --> 00:38:48,490
usually in that place we did in that

817
00:38:46,900 --> 00:38:51,880
case but we learned a hard lesson

818
00:38:48,490 --> 00:38:54,069
so that's other things and also with the

819
00:38:51,880 --> 00:38:56,200
public relations Pike news on all these

820
00:38:54,070 --> 00:38:58,180
things have you seen this report I know

821
00:38:56,200 --> 00:39:00,640
I don't have much time I was reading it

822
00:38:58,180 --> 00:39:03,490
the other day I really recommend you to

823
00:39:00,640 --> 00:39:05,830
read it carefully but from the point of

824
00:39:03,490 --> 00:39:07,390
perspectives perhaps nothing new but all

825
00:39:05,830 --> 00:39:09,790
these things that are happening in the

826
00:39:07,390 --> 00:39:12,509
world are or political or financial

827
00:39:09,790 --> 00:39:15,520
gains right so if an attacker or a

828
00:39:12,510 --> 00:39:20,500
person who has other beliefs needs to

829
00:39:15,520 --> 00:39:23,050
manipulate the pub the population they

830
00:39:20,500 --> 00:39:25,420
will use all these actors together and

831
00:39:23,050 --> 00:39:27,730
once using those actors they are going

832
00:39:25,420 --> 00:39:29,940
to push the industry towards one way or

833
00:39:27,730 --> 00:39:33,760
another if you are able to do that with

834
00:39:29,940 --> 00:39:35,470
big massive political attacks or fine

835
00:39:33,760 --> 00:39:37,330
financially gain attacks I think it's

836
00:39:35,470 --> 00:39:39,640
going to be a trend and we are seeing

837
00:39:37,330 --> 00:39:41,710
that and the thing that I want to share

838
00:39:39,640 --> 00:39:43,900
that we should pay attention at those

839
00:39:41,710 --> 00:39:46,270
moments because I think are the most

840
00:39:43,900 --> 00:39:49,420
fear fear ones nowadays are these ones

841
00:39:46,270 --> 00:39:51,670
not just malware apt attacks in zero day

842
00:39:49,420 --> 00:39:56,080
attacks it's the people attack that's

843
00:39:51,670 --> 00:39:59,020
going on every single time and the have

844
00:39:56,080 --> 00:40:00,549
you heard this is the in the report they

845
00:39:59,020 --> 00:40:03,910
talk about the Sepoy Republican

846
00:40:00,550 --> 00:40:05,770
rebellion this is from 1857 so there's

847
00:40:03,910 --> 00:40:08,140
nothing to do with our day days but it's

848
00:40:05,770 --> 00:40:11,440
a great example so you know that India

849
00:40:08,140 --> 00:40:14,170
had this united kingdom was invaded -

850
00:40:11,440 --> 00:40:15,910
almost India right so the Sepoy

851
00:40:14,170 --> 00:40:20,650
Rebellion which were the Indian soldiers

852
00:40:15,910 --> 00:40:23,109
well people made a rumour that India was

853
00:40:20,650 --> 00:40:25,750
going to be become a Christian country

854
00:40:23,109 --> 00:40:27,609
so in the religion part the rebels

855
00:40:25,750 --> 00:40:30,790
distributed chapati which is the Indian

856
00:40:27,609 --> 00:40:33,970
bread by night so people were thinking

857
00:40:30,790 --> 00:40:36,339
that it was a representation that they

858
00:40:33,970 --> 00:40:37,930
want to change to the Christian warfare

859
00:40:36,339 --> 00:40:40,060
right when they give you in the church

860
00:40:37,930 --> 00:40:41,859
and others rumor that the bread was

861
00:40:40,060 --> 00:40:44,470
soaked in beef to force a change in

862
00:40:41,859 --> 00:40:46,630
locals behavior so they can adapt to

863
00:40:44,470 --> 00:40:49,450
that but the stronger was on the South

864
00:40:46,630 --> 00:40:52,420
Indian soldiers was the strong narrative

865
00:40:49,450 --> 00:40:54,490
that the weapons they used they need

866
00:40:52,420 --> 00:40:57,160
grease from beef and

867
00:40:54,490 --> 00:40:59,259
so what do you think the Indian soldiers

868
00:40:57,160 --> 00:41:01,629
in those times when they were serving

869
00:40:59,260 --> 00:41:05,970
with the United Kingdom to preserve this

870
00:41:01,630 --> 00:41:09,310
did they rebelled because of a rumor

871
00:41:05,970 --> 00:41:11,109
because it was officially not right so

872
00:41:09,310 --> 00:41:14,440
you need to pay attention on these

873
00:41:11,110 --> 00:41:17,320
movements because I think we're in that

874
00:41:14,440 --> 00:41:19,300
in that era and thank you everyone I

875
00:41:17,320 --> 00:41:21,960
hope to have a great time in here every

876
00:41:19,300 --> 00:41:21,960
sorry thank you

877
00:41:24,270 --> 00:41:30,330
so I like to have questions or we can

878
00:41:27,040 --> 00:41:30,330
take any question

879
00:41:54,400 --> 00:41:56,460
you

