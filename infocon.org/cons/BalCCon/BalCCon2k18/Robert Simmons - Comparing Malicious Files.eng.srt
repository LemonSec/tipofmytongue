1
00:00:00,000 --> 00:00:12,130
[Music]

2
00:00:11,270 --> 00:00:14,910
[Applause]

3
00:00:12,130 --> 00:00:18,420
[Music]

4
00:00:14,910 --> 00:00:21,210
hello everyone our next stop<font color="#CCCCCC"> is gonna</font><font color="#E5E5E5"> be</font>

5
00:00:18,420 --> 00:00:26,699
<font color="#E5E5E5">on comparing malicious files</font><font color="#CCCCCC"> brought</font><font color="#E5E5E5"> to</font>

6
00:00:21,210 --> 00:00:30,000
<font color="#E5E5E5">you by Robert Simmons enjoy hello</font>

7
00:00:26,699 --> 00:00:32,309
everybody<font color="#E5E5E5"> my name</font><font color="#CCCCCC"> is Rob Simmons I go by</font>

8
00:00:30,000 --> 00:00:34,410
the handle<font color="#CCCCCC"> hoot Kano's I think some of</font>

9
00:00:32,308 --> 00:00:38,629
<font color="#CCCCCC">you might</font><font color="#E5E5E5"> know it but it's the word</font>

10
00:00:34,410 --> 00:00:41,760
means<font color="#E5E5E5"> duckbill platypus</font><font color="#CCCCCC"> don't</font><font color="#E5E5E5"> ask me why</font>

11
00:00:38,629 --> 00:00:46,230
<font color="#E5E5E5">so today I'm gonna be</font><font color="#CCCCCC"> talking about how</font>

12
00:00:41,760 --> 00:00:48,269
<font color="#E5E5E5">to compare malicious files and just a</font>

13
00:00:46,230 --> 00:00:49,709
<font color="#E5E5E5">little bit about myself</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> am now an</font>

14
00:00:48,270 --> 00:00:50,910
independent malware researcher<font color="#E5E5E5"> I'm</font>

15
00:00:49,710 --> 00:00:53,460
formerly<font color="#E5E5E5"> the director</font><font color="#CCCCCC"> of research</font>

16
00:00:50,910 --> 00:00:58,468
innovation at threat connect so formerly

17
00:00:53,460 --> 00:01:00,840
<font color="#E5E5E5">as of a couple weeks ago</font><font color="#CCCCCC"> and I want to</font>

18
00:00:58,469 --> 00:01:04,349
start with<font color="#E5E5E5"> you know going over some of</font>

19
00:01:00,840 --> 00:01:06,450
<font color="#CCCCCC">the</font><font color="#E5E5E5"> problems that I not necessarily some</font>

20
00:01:04,349 --> 00:01:08,908
not necessarily have any solutions for

21
00:01:06,450 --> 00:01:12,479
them but I want to<font color="#E5E5E5"> identify some of the</font>

22
00:01:08,909 --> 00:01:15,390
<font color="#E5E5E5">problems with comparing files and filed</font>

23
00:01:12,479 --> 00:01:19,560
you know sample nomenclature<font color="#E5E5E5"> malware</font>

24
00:01:15,390 --> 00:01:22,710
family nomenclature so and I apologize

25
00:01:19,560 --> 00:01:25,320
I'm getting over a little<font color="#E5E5E5"> cough so so</font>

26
00:01:22,710 --> 00:01:27,990
the first<font color="#E5E5E5"> problem</font><font color="#CCCCCC"> is the the</font><font color="#E5E5E5"> antivirus</font>

27
00:01:25,320 --> 00:01:30,179
problem so antivirus companies many

28
00:01:27,990 --> 00:01:32,759
antivirus companies you<font color="#E5E5E5"> have their own</font>

29
00:01:30,180 --> 00:01:35,610
unique nomenclature for<font color="#E5E5E5"> malware and</font>

30
00:01:32,759 --> 00:01:39,540
malware families so if if you submit a

31
00:01:35,610 --> 00:01:44,579
file<font color="#E5E5E5"> that's suspicious</font><font color="#CCCCCC"> or unknown to you</font>

32
00:01:39,540 --> 00:01:47,009
know a navy bank or to a specific<font color="#E5E5E5"> a V</font>

33
00:01:44,579 --> 00:01:51,059
scanner<font color="#CCCCCC"> you get you may get a result</font>

34
00:01:47,009 --> 00:01:53,070
back<font color="#E5E5E5"> and that result may</font><font color="#CCCCCC"> not actually</font><font color="#E5E5E5"> be</font>

35
00:01:51,060 --> 00:01:55,500
what the malware<font color="#E5E5E5"> is but it you know</font><font color="#CCCCCC"> it's</font>

36
00:01:53,070 --> 00:01:57,740
the<font color="#E5E5E5"> the goal of a V is to detect and</font>

37
00:01:55,500 --> 00:02:01,770
stop<font color="#E5E5E5"> it's not necessarily to identify</font>

38
00:01:57,740 --> 00:02:03,479
but this<font color="#E5E5E5"> causes a lot</font><font color="#CCCCCC"> of confusion</font>

39
00:02:01,770 --> 00:02:05,490
because<font color="#E5E5E5"> there's a lot of different names</font>

40
00:02:03,479 --> 00:02:09,478
that<font color="#E5E5E5"> something can come back as the the</font>

41
00:02:05,490 --> 00:02:11,250
results<font color="#CCCCCC"> there's another sort</font><font color="#E5E5E5"> of subset</font>

42
00:02:09,479 --> 00:02:12,989
of this problem and<font color="#E5E5E5"> it's the panda</font><font color="#CCCCCC"> panda</font>

43
00:02:11,250 --> 00:02:16,700
<font color="#E5E5E5">panda</font><font color="#CCCCCC"> panda</font>

44
00:02:12,989 --> 00:02:19,319
so this is the marketing problem so

45
00:02:16,700 --> 00:02:22,380
underneath the the<font color="#E5E5E5"> AV problem you have</font>

46
00:02:19,319 --> 00:02:25,500
the the nomenclature problem where a

47
00:02:22,380 --> 00:02:27,690
company<font color="#CCCCCC"> has a marketing team and you</font>

48
00:02:25,500 --> 00:02:30,120
know<font color="#E5E5E5"> dogs will hunt the marketing team</font>

49
00:02:27,690 --> 00:02:31,380
is doing<font color="#E5E5E5"> their</font><font color="#CCCCCC"> job but what they want to</font>

50
00:02:30,120 --> 00:02:34,019
do is name<font color="#CCCCCC"> the things that you've</font>

51
00:02:31,380 --> 00:02:37,019
discovered<font color="#E5E5E5"> so let's say you have a</font><font color="#CCCCCC"> new</font>

52
00:02:34,019 --> 00:02:39,120
you find a new malware family or a new

53
00:02:37,019 --> 00:02:41,940
variant of a malware family or<font color="#E5E5E5"> something</font>

54
00:02:39,120 --> 00:02:43,470
completely<font color="#E5E5E5"> new and</font><font color="#CCCCCC"> then you know the</font>

55
00:02:41,940 --> 00:02:45,030
marketing department hears about it<font color="#CCCCCC"> you</font>

56
00:02:43,470 --> 00:02:46,560
know they<font color="#E5E5E5"> hear you talking about it or</font>

57
00:02:45,030 --> 00:02:48,480
you send<font color="#E5E5E5"> them a message about</font><font color="#CCCCCC"> it and</font>

58
00:02:46,560 --> 00:02:50,850
then they want to name it they want<font color="#E5E5E5"> to</font>

59
00:02:48,480 --> 00:02:54,959
come up<font color="#CCCCCC"> with some fancy</font><font color="#E5E5E5"> name for it</font>

60
00:02:50,850 --> 00:02:57,690
I think we all know<font color="#E5E5E5"> one example of this</font>

61
00:02:54,959 --> 00:03:00,540
<font color="#E5E5E5">you know how many different names can</font>

62
00:02:57,690 --> 00:03:03,510
one malware family have<font color="#E5E5E5"> a PT 28 pawn</font>

63
00:03:00,540 --> 00:03:06,390
storm fancy<font color="#CCCCCC"> Bayer setne</font><font color="#E5E5E5"> it's our team</font><font color="#CCCCCC"> TG</font>

64
00:03:03,510 --> 00:03:09,319
<font color="#CCCCCC">44</font><font color="#E5E5E5"> one to seven group for one to seven</font>

65
00:03:06,390 --> 00:03:13,349
strontium tag double O seven zero zero

66
00:03:09,319 --> 00:03:16,200
<font color="#CCCCCC">Swallowtail iron Twilight</font><font color="#E5E5E5"> group 74</font><font color="#CCCCCC"> you</font>

67
00:03:13,349 --> 00:03:19,048
know<font color="#E5E5E5"> goes</font><font color="#CCCCCC"> on</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> on</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> on and</font><font color="#E5E5E5"> on and so</font>

68
00:03:16,200 --> 00:03:21,149
<font color="#E5E5E5">you know and just to go back you've</font><font color="#CCCCCC"> got</font>

69
00:03:19,049 --> 00:03:23,700
the problem<font color="#E5E5E5"> of the pandas and the rocket</font>

70
00:03:21,150 --> 00:03:25,799
kittens and and I'm<font color="#E5E5E5"> not calling out one</font>

71
00:03:23,700 --> 00:03:27,810
company<font color="#CCCCCC"> in specific specifically but</font>

72
00:03:25,799 --> 00:03:29,010
it's a it's<font color="#CCCCCC"> a problem with</font><font color="#E5E5E5"> all marketing</font>

73
00:03:27,810 --> 00:03:32,190
<font color="#E5E5E5">departments you come up with something</font>

74
00:03:29,010 --> 00:03:34,620
new<font color="#E5E5E5"> and the same problem exists in you</font>

75
00:03:32,190 --> 00:03:37,620
know exploit and vulnerabilities and if

76
00:03:34,620 --> 00:03:39,900
you find some you<font color="#CCCCCC"> know flashbang new</font>

77
00:03:37,620 --> 00:03:41,370
vulnerability the you know marketing

78
00:03:39,900 --> 00:03:45,269
department wants to put a label on it

79
00:03:41,370 --> 00:03:47,790
<font color="#E5E5E5">and you know give you the</font><font color="#CCCCCC"> logo and all</font>

80
00:03:45,269 --> 00:03:49,620
that sort of stuff<font color="#CCCCCC"> so</font><font color="#E5E5E5"> in the malware</font>

81
00:03:47,790 --> 00:03:51,540
research area this creates a<font color="#E5E5E5"> problem</font>

82
00:03:49,620 --> 00:03:54,120
<font color="#E5E5E5">because you</font><font color="#CCCCCC"> know there are so many</font><font color="#E5E5E5"> names</font>

83
00:03:51,540 --> 00:03:55,679
for<font color="#E5E5E5"> one single malware family or groups</font>

84
00:03:54,120 --> 00:04:00,540
of<font color="#E5E5E5"> malware family or related now our</font>

85
00:03:55,680 --> 00:04:03,030
families<font color="#CCCCCC"> so those are more</font><font color="#E5E5E5"> of the the</font>

86
00:04:00,540 --> 00:04:05,179
problems with the nomenclature and then

87
00:04:03,030 --> 00:04:08,340
<font color="#E5E5E5">another part of my</font><font color="#CCCCCC"> talk is about</font>

88
00:04:05,180 --> 00:04:11,400
identifying<font color="#E5E5E5"> additional</font><font color="#CCCCCC"> samples so not</font>

89
00:04:08,340 --> 00:04:13,950
not<font color="#E5E5E5"> only do you need</font><font color="#CCCCCC"> to figure out</font><font color="#E5E5E5"> what</font>

90
00:04:11,400 --> 00:04:16,320
a specific<font color="#CCCCCC"> sample</font><font color="#E5E5E5"> is so you know what</font>

91
00:04:13,950 --> 00:04:18,659
mount or family belongs to<font color="#CCCCCC"> but you also</font>

92
00:04:16,320 --> 00:04:20,459
need to<font color="#E5E5E5"> figure out what what other files</font>

93
00:04:18,660 --> 00:04:23,159
what other samples are related to the

94
00:04:20,459 --> 00:04:24,870
file<font color="#E5E5E5"> that you're looking at and there</font>

95
00:04:23,159 --> 00:04:25,630
are different<font color="#E5E5E5"> reasons for doing</font><font color="#CCCCCC"> this so</font>

96
00:04:24,870 --> 00:04:28,060
you<font color="#CCCCCC"> have them out</font>

97
00:04:25,630 --> 00:04:30,130
researcher and the<font color="#CCCCCC"> malware researcher</font>

98
00:04:28,060 --> 00:04:32,230
wants to know<font color="#E5E5E5"> like what what he or</font><font color="#CCCCCC"> she</font>

99
00:04:30,130 --> 00:04:34,810
<font color="#CCCCCC">is looking</font><font color="#E5E5E5"> at you know they might have a</font>

100
00:04:32,230 --> 00:04:37,540
sample<font color="#E5E5E5"> but the malware researcher is not</font>

101
00:04:34,810 --> 00:04:40,090
<font color="#E5E5E5">necessarily you know</font><font color="#CCCCCC"> in an emergency</font>

102
00:04:37,540 --> 00:04:42,160
<font color="#CCCCCC">situation you know they typically have</font>

103
00:04:40,090 --> 00:04:44,919
enough time to<font color="#E5E5E5"> sit down</font><font color="#CCCCCC"> and think about</font>

104
00:04:42,160 --> 00:04:46,600
<font color="#CCCCCC">what they're looking at and one of the</font>

105
00:04:44,920 --> 00:04:47,950
things they need<font color="#CCCCCC"> to do is to relate the</font>

106
00:04:46,600 --> 00:04:51,310
sample<font color="#E5E5E5"> that they're looking at</font><font color="#CCCCCC"> to</font>

107
00:04:47,950 --> 00:04:54,219
additional samples<font color="#CCCCCC"> in different related</font>

108
00:04:51,310 --> 00:04:56,230
<font color="#E5E5E5">in different ways so that</font><font color="#CCCCCC"> they can you</font>

109
00:04:54,220 --> 00:04:59,350
know potentially identify that through

110
00:04:56,230 --> 00:05:02,890
previous identifications of older files

111
00:04:59,350 --> 00:05:04,270
or older<font color="#CCCCCC"> samples and then you know one</font>

112
00:05:02,890 --> 00:05:05,860
of the the<font color="#CCCCCC"> things you really</font><font color="#E5E5E5"> want</font><font color="#CCCCCC"> to</font>

113
00:05:04,270 --> 00:05:07,810
figure<font color="#CCCCCC"> out is</font><font color="#E5E5E5"> this is this something</font>

114
00:05:05,860 --> 00:05:10,000
<font color="#E5E5E5">unique is this something new is this</font>

115
00:05:07,810 --> 00:05:11,410
something that<font color="#E5E5E5"> no one has seen</font><font color="#CCCCCC"> before is</font>

116
00:05:10,000 --> 00:05:14,110
something<font color="#CCCCCC"> that you haven't encountered</font>

117
00:05:11,410 --> 00:05:16,000
before<font color="#CCCCCC"> now there's another problem</font>

118
00:05:14,110 --> 00:05:18,910
<font color="#CCCCCC">that's very closely related</font><font color="#E5E5E5"> to the</font>

119
00:05:16,000 --> 00:05:21,940
<font color="#CCCCCC">malware researchers problem but this one</font>

120
00:05:18,910 --> 00:05:24,100
is more an emergency situation<font color="#CCCCCC"> so you</font>

121
00:05:21,940 --> 00:05:27,040
have the incident responder so if you

122
00:05:24,100 --> 00:05:28,810
are not on an IR team and you<font color="#CCCCCC"> have a</font>

123
00:05:27,040 --> 00:05:30,190
sample<font color="#CCCCCC"> that you've collected</font><font color="#E5E5E5"> off of a</font>

124
00:05:28,810 --> 00:05:33,340
server<font color="#E5E5E5"> or a sample</font><font color="#CCCCCC"> that you've collected</font>

125
00:05:30,190 --> 00:05:34,840
off of a laptop<font color="#E5E5E5"> or a</font><font color="#CCCCCC"> workstation you</font>

126
00:05:33,340 --> 00:05:36,549
know you're under<font color="#CCCCCC"> the gun</font><font color="#E5E5E5"> you need to</font>

127
00:05:34,840 --> 00:05:39,940
figure out<font color="#E5E5E5"> exactly what this is what</font>

128
00:05:36,550 --> 00:05:41,680
it's done<font color="#CCCCCC"> reverse-engineer it</font><font color="#E5E5E5"> and you</font>

129
00:05:39,940 --> 00:05:43,510
need<font color="#CCCCCC"> to do you need</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> do some</font><font color="#E5E5E5"> of the</font>

130
00:05:41,680 --> 00:05:45,100
same things that a malware researcher

131
00:05:43,510 --> 00:05:46,800
does but you need to do it quickly<font color="#E5E5E5"> and</font>

132
00:05:45,100 --> 00:05:50,290
you need to do it for a different<font color="#CCCCCC"> reason</font>

133
00:05:46,800 --> 00:05:53,260
<font color="#CCCCCC">one of the main reasons is</font><font color="#E5E5E5"> can I find</font>

134
00:05:50,290 --> 00:05:55,240
related malware that some researcher or

135
00:05:53,260 --> 00:05:58,180
another organization<font color="#CCCCCC"> has</font><font color="#E5E5E5"> already done</font>

136
00:05:55,240 --> 00:06:01,120
work on and I can you know<font color="#E5E5E5"> kind of take</font>

137
00:05:58,180 --> 00:06:02,980
a<font color="#CCCCCC"> shortcut</font><font color="#E5E5E5"> to you know my destination of</font>

138
00:06:01,120 --> 00:06:05,020
figuring out what it<font color="#E5E5E5"> what it</font><font color="#CCCCCC"> is what it</font>

139
00:06:02,980 --> 00:06:07,210
<font color="#CCCCCC">does</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> how I can</font><font color="#E5E5E5"> you know how I can</font>

140
00:06:05,020 --> 00:06:09,390
you know stop it<font color="#CCCCCC"> from pivoting around</font>

141
00:06:07,210 --> 00:06:11,770
the network<font color="#E5E5E5"> and this sort of thing so</font>

142
00:06:09,390 --> 00:06:14,349
finding related malware so that you can

143
00:06:11,770 --> 00:06:16,570
figure out what you know what previous

144
00:06:14,350 --> 00:06:19,810
work has been done will save an incident

145
00:06:16,570 --> 00:06:21,820
responders time so you know these<font color="#E5E5E5"> are</font>

146
00:06:19,810 --> 00:06:23,920
these<font color="#CCCCCC"> are both</font><font color="#E5E5E5"> basically the same</font>

147
00:06:21,820 --> 00:06:26,050
problem<font color="#E5E5E5"> but from two different angles</font>

148
00:06:23,920 --> 00:06:28,060
<font color="#E5E5E5">you've got like the emergency</font><font color="#CCCCCC"> situation</font>

149
00:06:26,050 --> 00:06:29,860
then you<font color="#E5E5E5"> have the the malware researcher</font>

150
00:06:28,060 --> 00:06:31,310
that has time to<font color="#CCCCCC"> to kind of figure</font><font color="#E5E5E5"> out</font>

151
00:06:29,860 --> 00:06:34,040
what's going on and

152
00:06:31,310 --> 00:06:35,840
not lazily but you know<font color="#E5E5E5"> at their own</font>

153
00:06:34,040 --> 00:06:37,910
pace look through the the different

154
00:06:35,840 --> 00:06:44,090
<font color="#E5E5E5">pathways to</font><font color="#CCCCCC"> other</font><font color="#E5E5E5"> associations and other</font>

155
00:06:37,910 --> 00:06:46,310
associated samples so there's a couple

156
00:06:44,090 --> 00:06:48,830
of related solution methods so different

157
00:06:46,310 --> 00:06:51,650
methodologies for answering these

158
00:06:48,830 --> 00:06:53,840
questions and you know kind of solving

159
00:06:51,650 --> 00:06:56,630
some of these problems<font color="#CCCCCC"> and I'm going</font><font color="#E5E5E5"> to</font>

160
00:06:53,840 --> 00:06:58,219
start<font color="#E5E5E5"> with you know the two there's kind</font>

161
00:06:56,630 --> 00:07:00,830
of two different<font color="#E5E5E5"> two</font><font color="#CCCCCC"> different ways to</font>

162
00:06:58,220 --> 00:07:03,320
<font color="#CCCCCC">go</font><font color="#E5E5E5"> to think about this so sample</font>

163
00:07:00,830 --> 00:07:05,030
identification<font color="#CCCCCC"> that's</font><font color="#E5E5E5"> the that is the</font>

164
00:07:03,320 --> 00:07:07,510
what it what is it<font color="#E5E5E5"> that I'm looking at</font>

165
00:07:05,030 --> 00:07:09,650
what my our family is it<font color="#E5E5E5"> you know</font>

166
00:07:07,510 --> 00:07:11,870
potentially who is the adversary<font color="#CCCCCC"> that</font>

167
00:07:09,650 --> 00:07:13,760
wrote it<font color="#E5E5E5"> and this sort of thing so</font>

168
00:07:11,870 --> 00:07:15,740
<font color="#E5E5E5">determining the malware identity</font>

169
00:07:13,760 --> 00:07:18,680
identifying the malware family is one

170
00:07:15,740 --> 00:07:20,810
you know one piece of this process<font color="#CCCCCC"> and</font>

171
00:07:18,680 --> 00:07:23,900
then the other part is locating

172
00:07:20,810 --> 00:07:27,680
<font color="#CCCCCC">Associated samples so within within</font><font color="#E5E5E5"> a</font>

173
00:07:23,900 --> 00:07:30,260
set<font color="#E5E5E5"> of samples</font><font color="#CCCCCC"> which</font><font color="#E5E5E5"> ones of this set</font>

174
00:07:27,680 --> 00:07:31,970
<font color="#CCCCCC">you know what subset of</font><font color="#E5E5E5"> that set are</font>

175
00:07:30,260 --> 00:07:34,789
related to the sample that I'm<font color="#CCCCCC"> looking</font>

176
00:07:31,970 --> 00:07:37,220
<font color="#E5E5E5">at right now so there are many different</font>

177
00:07:34,790 --> 00:07:41,140
methodologies for doing this<font color="#CCCCCC"> also this</font>

178
00:07:37,220 --> 00:07:44,479
talk is by by far not an exhaustive

179
00:07:41,140 --> 00:07:46,460
listing of the methods for<font color="#CCCCCC"> doing</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> we</font>

180
00:07:44,479 --> 00:07:48,860
were I<font color="#E5E5E5"> think we were having</font><font color="#CCCCCC"> coffee on</font>

181
00:07:46,460 --> 00:07:51,140
Monday<font color="#E5E5E5"> and someone mentioned</font><font color="#CCCCCC"> a method</font>

182
00:07:48,860 --> 00:07:52,640
that<font color="#E5E5E5"> isn't in my talk so I you know</font>

183
00:07:51,140 --> 00:07:55,789
there's there's there many many many

184
00:07:52,640 --> 00:07:57,200
<font color="#E5E5E5">methods and after this</font><font color="#CCCCCC"> I'd love</font><font color="#E5E5E5"> to talk</font>

185
00:07:55,789 --> 00:07:58,760
to<font color="#E5E5E5"> you if you have anything that isn't</font>

186
00:07:57,200 --> 00:08:01,400
<font color="#E5E5E5">in</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> talk and you want to you know</font>

187
00:07:58,760 --> 00:08:03,229
tell me a your methods for<font color="#CCCCCC"> identifying</font>

188
00:08:01,400 --> 00:08:07,909
other samples or identifying malware<font color="#E5E5E5"> I'd</font>

189
00:08:03,229 --> 00:08:11,870
love to talk<font color="#CCCCCC"> to</font><font color="#E5E5E5"> you about it so the most</font>

190
00:08:07,910 --> 00:08:14,180
basic<font color="#CCCCCC"> simple</font><font color="#E5E5E5"> kind of dumb method is</font>

191
00:08:11,870 --> 00:08:16,130
using<font color="#CCCCCC"> antivirus scanner results so you</font>

192
00:08:14,180 --> 00:08:18,020
<font color="#E5E5E5">can't really use one antivirus scanner</font>

193
00:08:16,130 --> 00:08:19,490
result what you want to do is go to

194
00:08:18,020 --> 00:08:22,669
<font color="#E5E5E5">someplace like virustotal</font>

195
00:08:19,490 --> 00:08:25,370
or you guys reversing labs<font color="#E5E5E5"> where you</font>

196
00:08:22,669 --> 00:08:27,520
<font color="#E5E5E5">have a lot of</font><font color="#CCCCCC"> Av scanners and</font><font color="#E5E5E5"> you can</font>

197
00:08:25,370 --> 00:08:30,530
scan<font color="#E5E5E5"> and</font><font color="#CCCCCC"> you can scan a sample across</font>

198
00:08:27,520 --> 00:08:32,809
<font color="#E5E5E5">basically all known you know AV scanners</font>

199
00:08:30,530 --> 00:08:37,250
and get<font color="#E5E5E5"> results back from all of</font><font color="#CCCCCC"> them</font>

200
00:08:32,809 --> 00:08:38,829
but<font color="#E5E5E5"> then you have another</font><font color="#CCCCCC"> problem so the</font>

201
00:08:37,250 --> 00:08:42,240
first problem with<font color="#E5E5E5"> that is you have</font>

202
00:08:38,830 --> 00:08:44,339
shared signatures and from

203
00:08:42,240 --> 00:08:46,230
antivirus companies perspective this<font color="#CCCCCC"> is</font>

204
00:08:44,339 --> 00:08:48,480
actually not a problem<font color="#CCCCCC"> this</font><font color="#E5E5E5"> is only a</font>

205
00:08:46,230 --> 00:08:51,000
<font color="#CCCCCC">problem from the researchers perspective</font>

206
00:08:48,480 --> 00:08:53,850
<font color="#CCCCCC">this</font><font color="#E5E5E5"> is actually a good thing</font><font color="#CCCCCC"> like I</font><font color="#E5E5E5"> I</font>

207
00:08:51,000 --> 00:08:55,529
am all<font color="#CCCCCC"> for sharing</font><font color="#E5E5E5"> information among</font>

208
00:08:53,850 --> 00:08:58,740
<font color="#CCCCCC">companies</font><font color="#E5E5E5"> and sharing</font><font color="#CCCCCC"> information among</font>

209
00:08:55,529 --> 00:09:01,100
researchers<font color="#CCCCCC"> so this is by far not a</font>

210
00:08:58,740 --> 00:09:04,890
problem<font color="#E5E5E5"> from the</font><font color="#CCCCCC"> perspective of you know</font>

211
00:09:01,100 --> 00:09:08,610
<font color="#E5E5E5">being altruistic</font><font color="#CCCCCC"> but this is a</font><font color="#E5E5E5"> problem</font>

212
00:09:04,890 --> 00:09:11,430
for for a researcher<font color="#E5E5E5"> so you have shared</font>

213
00:09:08,610 --> 00:09:13,709
signatures<font color="#CCCCCC"> many</font><font color="#E5E5E5"> companies</font><font color="#CCCCCC"> that will</font>

214
00:09:11,430 --> 00:09:15,870
<font color="#E5E5E5">develop a signature for their particular</font>

215
00:09:13,709 --> 00:09:17,609
scanner<font color="#CCCCCC"> and</font><font color="#E5E5E5"> will share that you know</font>

216
00:09:15,870 --> 00:09:20,580
under a nondisclosure<font color="#CCCCCC"> agreement with</font>

217
00:09:17,610 --> 00:09:23,100
other companies<font color="#E5E5E5"> so you end up</font><font color="#CCCCCC"> with</font>

218
00:09:20,580 --> 00:09:25,980
nearly<font color="#CCCCCC"> identical</font><font color="#E5E5E5"> scanner results for one</font>

219
00:09:23,100 --> 00:09:29,580
particular file<font color="#E5E5E5"> for many different AV</font>

220
00:09:25,980 --> 00:09:32,520
vendors<font color="#E5E5E5"> so this is an example of this so</font>

221
00:09:29,580 --> 00:09:34,380
this that's the md5 for the sample<font color="#E5E5E5"> you</font>

222
00:09:32,520 --> 00:09:36,930
can<font color="#CCCCCC"> go</font><font color="#E5E5E5"> find it it's on it's on</font>

223
00:09:34,380 --> 00:09:39,149
<font color="#E5E5E5">virustotal</font><font color="#CCCCCC"> the scanner results so this</font>

224
00:09:36,930 --> 00:09:41,579
<font color="#CCCCCC">is</font><font color="#E5E5E5"> just a generic generic scanner result</font>

225
00:09:39,149 --> 00:09:43,589
<font color="#E5E5E5">but you</font><font color="#CCCCCC"> know I picked this</font><font color="#E5E5E5"> one out</font>

226
00:09:41,580 --> 00:09:46,440
<font color="#CCCCCC">because it's it's both</font><font color="#E5E5E5"> a generic scanner</font>

227
00:09:43,589 --> 00:09:50,430
result but it also is<font color="#E5E5E5"> fairly specific so</font>

228
00:09:46,440 --> 00:09:53,459
that<font color="#CCCCCC"> number is</font><font color="#E5E5E5"> very unique across all</font>

229
00:09:50,430 --> 00:09:56,339
<font color="#E5E5E5">the all of</font><font color="#CCCCCC"> the scanner results and this</font>

230
00:09:53,459 --> 00:10:00,479
this<font color="#CCCCCC"> this exactly</font><font color="#E5E5E5"> the same scanner</font>

231
00:09:56,339 --> 00:10:03,390
result is on<font color="#CCCCCC"> adware</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> lyac BitDefender</font>

232
00:10:00,480 --> 00:10:05,670
<font color="#CCCCCC">ME soft</font><font color="#E5E5E5"> f-secure G data and</font><font color="#CCCCCC"> microworld a</font>

233
00:10:03,390 --> 00:10:08,670
scan and you'll also if you if you kind

234
00:10:05,670 --> 00:10:11,459
of<font color="#E5E5E5"> look through a V scanner results a</font>

235
00:10:08,670 --> 00:10:13,260
lot<font color="#E5E5E5"> I know that sounds boring</font><font color="#CCCCCC"> but I do</font>

236
00:10:11,459 --> 00:10:15,689
that a<font color="#E5E5E5"> lot and you'll see you'll see</font>

237
00:10:13,260 --> 00:10:16,740
<font color="#E5E5E5">these patterns emerge across the</font>

238
00:10:15,690 --> 00:10:18,240
companies and<font color="#E5E5E5"> you kind of figure out</font>

239
00:10:16,740 --> 00:10:21,240
<font color="#E5E5E5">who's sharing sample who's hearing</font>

240
00:10:18,240 --> 00:10:25,110
samples and who's sharing<font color="#E5E5E5"> signatures</font>

241
00:10:21,240 --> 00:10:28,470
with each other so that's a<font color="#E5E5E5"> problem</font><font color="#CCCCCC"> and</font>

242
00:10:25,110 --> 00:10:31,079
then another problem<font color="#E5E5E5"> with with the you</font>

243
00:10:28,470 --> 00:10:32,790
know the the methodologies<font color="#CCCCCC"> that the AV</font>

244
00:10:31,079 --> 00:10:35,370
companies used to produce their

245
00:10:32,790 --> 00:10:39,899
signatures is they take two different

246
00:10:35,370 --> 00:10:42,360
<font color="#E5E5E5">two</font><font color="#CCCCCC"> different approaches</font><font color="#E5E5E5"> so you have the</font>

247
00:10:39,899 --> 00:10:44,490
generic<font color="#E5E5E5"> approach and the generic</font>

248
00:10:42,360 --> 00:10:48,510
<font color="#E5E5E5">approach is basically you want to write</font>

249
00:10:44,490 --> 00:10:50,430
one<font color="#E5E5E5"> one signature that spans as many</font>

250
00:10:48,510 --> 00:10:53,189
different<font color="#CCCCCC"> malware families as</font><font color="#E5E5E5"> you</font>

251
00:10:50,430 --> 00:10:55,260
possibly can<font color="#E5E5E5"> because</font><font color="#CCCCCC"> the goal</font><font color="#E5E5E5"> of an AV</font>

252
00:10:53,190 --> 00:10:57,990
company is<font color="#E5E5E5"> two to two</font>

253
00:10:55,260 --> 00:11:00,360
<font color="#E5E5E5">TEKT and block the the the the malware</font>

254
00:10:57,990 --> 00:11:02,970
<font color="#CCCCCC">it's not necessarily to identify the</font>

255
00:11:00,360 --> 00:11:10,710
malware<font color="#E5E5E5"> that's that is perhaps a</font>

256
00:11:02,970 --> 00:11:14,190
secondary<font color="#E5E5E5"> or tertiary goal so excuse me</font>

257
00:11:10,710 --> 00:11:16,950
<font color="#E5E5E5">so you have your generic beer which is</font>

258
00:11:14,190 --> 00:11:20,070
<font color="#E5E5E5">the generic signature and there's</font>

259
00:11:16,950 --> 00:11:23,040
actually so there there is a<font color="#E5E5E5"> financial</font>

260
00:11:20,070 --> 00:11:25,620
reason<font color="#E5E5E5"> for AV companies to to produce</font>

261
00:11:23,040 --> 00:11:29,310
signatures in this way<font color="#E5E5E5"> because it takes</font>

262
00:11:25,620 --> 00:11:31,710
time money and<font color="#CCCCCC"> people to go and research</font>

263
00:11:29,310 --> 00:11:35,760
and figure<font color="#CCCCCC"> out what the signature needs</font>

264
00:11:31,710 --> 00:11:37,890
to be and so it it costs less<font color="#E5E5E5"> for you to</font>

265
00:11:35,760 --> 00:11:40,470
develop<font color="#CCCCCC"> a generic signature that detects</font>

266
00:11:37,890 --> 00:11:43,170
lots of stuff than it<font color="#E5E5E5"> is to develop</font><font color="#CCCCCC"> lots</font>

267
00:11:40,470 --> 00:11:46,590
of specific signatures<font color="#E5E5E5"> that detect</font>

268
00:11:43,170 --> 00:11:48,990
specific<font color="#E5E5E5"> malware families so also this</font>

269
00:11:46,590 --> 00:11:51,120
is a<font color="#E5E5E5"> little advertisement for my</font>

270
00:11:48,990 --> 00:11:53,790
<font color="#E5E5E5">favorite beer company back in back</font><font color="#CCCCCC"> in</font>

271
00:11:51,120 --> 00:11:56,880
Washington DC<font color="#E5E5E5"> so</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> is DC Brau</font>

272
00:11:53,790 --> 00:12:00,630
corruption IPA<font color="#CCCCCC"> I highly</font><font color="#E5E5E5"> recommend it</font>

273
00:11:56,880 --> 00:12:03,540
when you're<font color="#E5E5E5"> in town but so you have you</font>

274
00:12:00,630 --> 00:12:06,480
<font color="#E5E5E5">have these two kind of diametrically</font>

275
00:12:03,540 --> 00:12:08,640
opposed<font color="#E5E5E5"> forces in you know therefore</font>

276
00:12:06,480 --> 00:12:11,400
<font color="#CCCCCC">they're financial forces where you have</font>

277
00:12:08,640 --> 00:12:13,110
the push to have<font color="#E5E5E5"> a generic signature</font>

278
00:12:11,400 --> 00:12:15,120
that doesn't tell<font color="#E5E5E5"> you much and then you</font>

279
00:12:13,110 --> 00:12:17,220
also have you know researchers who want

280
00:12:15,120 --> 00:12:24,660
<font color="#E5E5E5">to have signatures that</font><font color="#CCCCCC"> are fairly</font>

281
00:12:17,220 --> 00:12:26,400
specific<font color="#E5E5E5"> and identify something so so I</font>

282
00:12:24,660 --> 00:12:29,880
<font color="#E5E5E5">want to call out</font><font color="#CCCCCC"> a few vendors</font><font color="#E5E5E5"> that have</font>

283
00:12:26,400 --> 00:12:31,530
<font color="#E5E5E5">good results you know thumbs up to to</font>

284
00:12:29,880 --> 00:12:33,120
them thumbs up to<font color="#E5E5E5"> any of you that might</font>

285
00:12:31,530 --> 00:12:36,360
work<font color="#CCCCCC"> for any</font><font color="#E5E5E5"> of these companies a good</font>

286
00:12:33,120 --> 00:12:40,260
job<font color="#CCCCCC"> so not</font><font color="#E5E5E5"> only do they have usable</font>

287
00:12:36,360 --> 00:12:43,350
<font color="#E5E5E5">results but they also have each of them</font>

288
00:12:40,260 --> 00:12:44,760
have varying qualities<font color="#CCCCCC"> you know some</font>

289
00:12:43,350 --> 00:12:47,520
better than<font color="#CCCCCC"> others but they have you</font>

290
00:12:44,760 --> 00:12:49,980
<font color="#E5E5E5">know threat encyclopedias or threat</font>

291
00:12:47,520 --> 00:12:51,990
analysis you know databases or whatever

292
00:12:49,980 --> 00:12:53,730
that<font color="#E5E5E5"> are all in line all are free you</font>

293
00:12:51,990 --> 00:12:57,570
can look up there you<font color="#CCCCCC"> can look</font><font color="#E5E5E5"> up the</font>

294
00:12:53,730 --> 00:12:59,610
<font color="#CCCCCC">scanner</font><font color="#E5E5E5"> result in their in their threat</font>

295
00:12:57,570 --> 00:13:01,350
database or their threat encyclopedia

296
00:12:59,610 --> 00:13:02,850
and get a<font color="#E5E5E5"> little bit more information</font>

297
00:13:01,350 --> 00:13:05,930
about<font color="#E5E5E5"> what</font><font color="#CCCCCC"> the thing is that you're</font>

298
00:13:02,850 --> 00:13:08,440
<font color="#CCCCCC">looking at so Microsoft Microsoft</font>

299
00:13:05,930 --> 00:13:10,359
Microsoft<font color="#E5E5E5"> is very very very good</font>

300
00:13:08,440 --> 00:13:11,860
I think I just<font color="#CCCCCC"> spoke with some people in</font>

301
00:13:10,360 --> 00:13:13,660
the<font color="#CCCCCC"> other room and</font><font color="#E5E5E5"> they were</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> this</font>

302
00:13:11,860 --> 00:13:16,240
<font color="#E5E5E5">was the first first one they came but</font>

303
00:13:13,660 --> 00:13:18,459
they they talked<font color="#E5E5E5"> about and I agree</font>

304
00:13:16,240 --> 00:13:21,130
Microsoft has very very very very<font color="#E5E5E5"> very</font>

305
00:13:18,460 --> 00:13:23,020
good<font color="#E5E5E5"> very specific detections but they</font>

306
00:13:21,130 --> 00:13:24,310
don't detect<font color="#E5E5E5"> much in the first place so</font>

307
00:13:23,020 --> 00:13:25,960
you<font color="#E5E5E5"> have to actually detect the thing</font>

308
00:13:24,310 --> 00:13:28,300
before<font color="#CCCCCC"> you can actually</font><font color="#E5E5E5"> get a result so</font>

309
00:13:25,960 --> 00:13:30,010
it doesn't detect much but if it does

310
00:13:28,300 --> 00:13:33,310
detect it it's very<font color="#E5E5E5"> very good</font>

311
00:13:30,010 --> 00:13:38,770
ESET Kaspersky<font color="#E5E5E5"> Sophos have fairly</font>

312
00:13:33,310 --> 00:13:44,949
<font color="#E5E5E5">specific scanner results so what I want</font>

313
00:13:38,770 --> 00:13:46,660
<font color="#E5E5E5">to show you is and I have loop so what</font>

314
00:13:44,950 --> 00:13:50,020
you need<font color="#E5E5E5"> to</font><font color="#CCCCCC"> do is once you've submitted</font>

315
00:13:46,660 --> 00:13:52,270
a sample to<font color="#CCCCCC"> a bank</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> Av scanners you'll</font>

316
00:13:50,020 --> 00:13:53,770
get back like a pile of<font color="#E5E5E5"> data and then</font>

317
00:13:52,270 --> 00:13:57,430
<font color="#E5E5E5">you need to boil</font><font color="#CCCCCC"> it you need</font><font color="#E5E5E5"> to boil</font>

318
00:13:53,770 --> 00:14:00,340
<font color="#E5E5E5">that down into maybe</font><font color="#CCCCCC"> one or two</font><font color="#E5E5E5"> names</font>

319
00:13:57,430 --> 00:14:03,939
that<font color="#CCCCCC"> are basically commonalities across</font>

320
00:14:00,340 --> 00:14:05,560
all of the scanner results and so I'm

321
00:14:03,940 --> 00:14:08,710
<font color="#CCCCCC">gonna I'm</font><font color="#E5E5E5"> gonna show what</font><font color="#CCCCCC"> kind of walk</font>

322
00:14:05,560 --> 00:14:10,270
you through<font color="#CCCCCC"> this so the first thing</font>

323
00:14:08,710 --> 00:14:13,060
you'll<font color="#E5E5E5"> notice is this</font><font color="#CCCCCC"> is actually not</font>

324
00:14:10,270 --> 00:14:15,939
this<font color="#E5E5E5"> isn't all of the</font><font color="#CCCCCC"> AV scanners that</font>

325
00:14:13,060 --> 00:14:20,920
<font color="#E5E5E5">were run against this particular this</font>

326
00:14:15,940 --> 00:14:24,160
sample<font color="#E5E5E5"> but excuse me</font>

327
00:14:20,920 --> 00:14:27,310
so what I've<font color="#E5E5E5"> done is I've gone ahead and</font>

328
00:14:24,160 --> 00:14:30,730
removed all of the generic ones just

329
00:14:27,310 --> 00:14:33,719
<font color="#CCCCCC">because space on the slide and the</font>

330
00:14:30,730 --> 00:14:36,010
generic<font color="#CCCCCC"> ones</font><font color="#E5E5E5"> give me no information</font><font color="#CCCCCC"> so</font>

331
00:14:33,720 --> 00:14:39,040
what you'll see<font color="#E5E5E5"> here is</font><font color="#CCCCCC"> if you look</font>

332
00:14:36,010 --> 00:14:41,050
<font color="#CCCCCC">carefully if you think about the problem</font>

333
00:14:39,040 --> 00:14:43,540
<font color="#CCCCCC">that I highlighted earlier</font><font color="#E5E5E5"> where you've</font>

334
00:14:41,050 --> 00:14:46,030
got shared samples<font color="#E5E5E5"> if you're going to</font>

335
00:14:43,540 --> 00:14:48,339
write an<font color="#CCCCCC"> algorithm that pulls apart the</font>

336
00:14:46,030 --> 00:14:50,380
the AV scanner results and then gives

337
00:14:48,340 --> 00:14:53,020
you one scanner result<font color="#E5E5E5"> you need to</font>

338
00:14:50,380 --> 00:14:56,680
<font color="#CCCCCC">correct for that problem</font><font color="#E5E5E5"> of shared</font>

339
00:14:53,020 --> 00:14:58,810
signatures so what you'll<font color="#CCCCCC"> see here</font><font color="#E5E5E5"> first</font>

340
00:14:56,680 --> 00:15:01,390
is obviously<font color="#E5E5E5"> sorry I skipped a slide but</font>

341
00:14:58,810 --> 00:15:03,189
<font color="#E5E5E5">you know you need</font><font color="#CCCCCC"> to remove clearly</font>

342
00:15:01,390 --> 00:15:05,470
generic results you have to<font color="#CCCCCC"> also look</font>

343
00:15:03,190 --> 00:15:09,010
for some<font color="#E5E5E5"> of the sneaky ones that are</font>

344
00:15:05,470 --> 00:15:13,360
basically generic by now<font color="#E5E5E5"> you know</font><font color="#CCCCCC"> zeusie</font>

345
00:15:09,010 --> 00:15:14,920
<font color="#CCCCCC">bots</font><font color="#E5E5E5"> Zusi etc like that but the what</font>

346
00:15:13,360 --> 00:15:18,550
you'll see here there's<font color="#E5E5E5"> one commonality</font>

347
00:15:14,920 --> 00:15:20,150
<font color="#E5E5E5">here so these are</font><font color="#CCCCCC"> all</font><font color="#E5E5E5"> exactly the same</font>

348
00:15:18,550 --> 00:15:22,010
signature

349
00:15:20,150 --> 00:15:23,360
I'm gonna go ahead and<font color="#E5E5E5"> count that</font><font color="#CCCCCC"> b1</font>

350
00:15:22,010 --> 00:15:26,900
down there in the bottom<font color="#CCCCCC"> is the</font><font color="#E5E5E5"> same</font>

351
00:15:23,360 --> 00:15:28,970
signature<font color="#CCCCCC"> so all</font><font color="#E5E5E5"> of these basically are</font>

352
00:15:26,900 --> 00:15:31,010
<font color="#CCCCCC">just</font><font color="#E5E5E5"> one signature so that's just one</font>

353
00:15:28,970 --> 00:15:32,210
results you need<font color="#E5E5E5"> to correct</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> that if</font>

354
00:15:31,010 --> 00:15:34,520
you're going<font color="#E5E5E5"> to write an</font><font color="#CCCCCC"> algorithm to</font>

355
00:15:32,210 --> 00:15:37,040
<font color="#E5E5E5">kind of boil down your</font><font color="#CCCCCC"> results there's</font>

356
00:15:34,520 --> 00:15:40,189
another one<font color="#E5E5E5"> here so these two</font><font color="#CCCCCC"> so I've</font>

357
00:15:37,040 --> 00:15:41,870
asked AVG<font color="#E5E5E5"> those are clearly a shared</font>

358
00:15:40,190 --> 00:15:47,960
signature<font color="#CCCCCC"> so again you have</font><font color="#E5E5E5"> to correct</font>

359
00:15:41,870 --> 00:15:51,110
for<font color="#CCCCCC"> that</font><font color="#E5E5E5"> one</font><font color="#CCCCCC"> and so moving down I've</font>

360
00:15:47,960 --> 00:15:54,440
boiled this down to two<font color="#E5E5E5"> so</font><font color="#CCCCCC"> two</font><font color="#E5E5E5"> two</font>

361
00:15:51,110 --> 00:15:55,910
possibilities here<font color="#E5E5E5"> these are clearly all</font>

362
00:15:54,440 --> 00:15:59,540
different signatures<font color="#E5E5E5"> from different</font>

363
00:15:55,910 --> 00:16:01,699
<font color="#CCCCCC">companies so is bar or</font><font color="#E5E5E5"> semi both of</font>

364
00:15:59,540 --> 00:16:04,010
these are also fairly<font color="#E5E5E5"> these by the way</font>

365
00:16:01,700 --> 00:16:06,400
these are fairly<font color="#E5E5E5"> generic results but I</font>

366
00:16:04,010 --> 00:16:10,550
<font color="#E5E5E5">just wanted to demonstrate the the</font>

367
00:16:06,400 --> 00:16:12,980
<font color="#E5E5E5">process</font><font color="#CCCCCC"> but if you look here those are</font>

368
00:16:10,550 --> 00:16:15,319
pretty much<font color="#E5E5E5"> the</font><font color="#CCCCCC"> same it's just the</font>

369
00:16:12,980 --> 00:16:17,450
formatting of the the formatting<font color="#E5E5E5"> of the</font>

370
00:16:15,320 --> 00:16:19,580
Signet of the scanner result is about

371
00:16:17,450 --> 00:16:21,860
the same so<font color="#E5E5E5"> I'm gonna I'm gonna collapse</font>

372
00:16:19,580 --> 00:16:24,980
those two down and say that you<font color="#E5E5E5"> know the</font>

373
00:16:21,860 --> 00:16:28,790
<font color="#E5E5E5">the result is you know mostly is bar and</font>

374
00:16:24,980 --> 00:16:31,010
a bit of semi so I have<font color="#E5E5E5"> actually an</font>

375
00:16:28,790 --> 00:16:33,140
algorithm for for doing<font color="#CCCCCC"> this that breaks</font>

376
00:16:31,010 --> 00:16:35,390
it all apart and kind<font color="#E5E5E5"> of finds the</font>

377
00:16:33,140 --> 00:16:39,710
commonalities<font color="#E5E5E5"> and corrects for shared</font>

378
00:16:35,390 --> 00:16:41,480
samples<font color="#CCCCCC"> and I hope I'll be</font><font color="#E5E5E5"> able to have</font>

379
00:16:39,710 --> 00:16:44,450
<font color="#E5E5E5">time to put that up</font><font color="#CCCCCC"> on my github but</font>

380
00:16:41,480 --> 00:16:48,620
watch for<font color="#CCCCCC"> it</font><font color="#E5E5E5"> it's a github github.com</font>

381
00:16:44,450 --> 00:16:50,870
<font color="#E5E5E5">slash</font><font color="#CCCCCC"> boot kano's and so the next</font>

382
00:16:48,620 --> 00:16:53,150
identification method is so<font color="#E5E5E5"> this is a</font>

383
00:16:50,870 --> 00:16:55,220
fairly new service in December<font color="#CCCCCC"> of</font><font color="#E5E5E5"> last</font>

384
00:16:53,150 --> 00:16:59,600
year<font color="#CCCCCC"> I was at bot</font><font color="#E5E5E5"> cough and they kind of</font>

385
00:16:55,220 --> 00:17:01,880
did their announcement of<font color="#E5E5E5"> mal pedia so</font>

386
00:16:59,600 --> 00:17:04,849
mal PD is really it's a it's an

387
00:17:01,880 --> 00:17:06,890
incredibly good concept<font color="#E5E5E5"> it's a little</font>

388
00:17:04,849 --> 00:17:08,540
bit sparse<font color="#CCCCCC"> right now it</font><font color="#E5E5E5"> needs you know</font>

389
00:17:06,890 --> 00:17:11,120
<font color="#E5E5E5">it needs more information</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> be put into</font>

390
00:17:08,540 --> 00:17:13,459
the into the<font color="#CCCCCC"> system</font><font color="#E5E5E5"> but it's basically</font>

391
00:17:11,119 --> 00:17:17,419
an identification system for<font color="#E5E5E5"> taking a</font>

392
00:17:13,459 --> 00:17:19,550
sample<font color="#E5E5E5"> and then finding finding</font><font color="#CCCCCC"> a</font>

393
00:17:17,420 --> 00:17:21,140
malware family so let me go<font color="#E5E5E5"> to the</font><font color="#CCCCCC"> next</font>

394
00:17:19,550 --> 00:17:22,879
<font color="#E5E5E5">slide so</font><font color="#CCCCCC"> this is actually straight off</font>

395
00:17:21,140 --> 00:17:25,220
<font color="#CCCCCC">of their website so the primary</font><font color="#E5E5E5"> goal of</font>

396
00:17:22,880 --> 00:17:27,200
<font color="#E5E5E5">mal pedia is to provide a resource</font><font color="#CCCCCC"> for</font>

397
00:17:25,220 --> 00:17:30,580
rapid identification and actionable

398
00:17:27,200 --> 00:17:32,860
<font color="#E5E5E5">context when investigating malware</font>

399
00:17:30,580 --> 00:17:34,870
openness to curated contributions

400
00:17:32,860 --> 00:17:36,699
<font color="#CCCCCC">challenge sir and</font><font color="#E5E5E5"> in an accountable</font>

401
00:17:34,870 --> 00:17:39,340
level of quality in order<font color="#E5E5E5"> to foster a</font>

402
00:17:36,700 --> 00:17:42,640
meaningful and reproducible research

403
00:17:39,340 --> 00:17:45,040
so essentially what mal pedia is is a

404
00:17:42,640 --> 00:17:47,710
collection of<font color="#CCCCCC"> yarra signatures</font><font color="#E5E5E5"> that have</font>

405
00:17:45,040 --> 00:17:49,889
been written by trusted researchers it's

406
00:17:47,710 --> 00:17:52,720
a closed community<font color="#E5E5E5"> so it's invite-only</font>

407
00:17:49,890 --> 00:17:54,220
<font color="#CCCCCC">and you know once</font><font color="#E5E5E5"> you're once you're in</font>

408
00:17:52,720 --> 00:17:57,550
you basically should be contributing

409
00:17:54,220 --> 00:17:59,050
<font color="#CCCCCC">information contributing samples</font><font color="#E5E5E5"> you</font>

410
00:17:57,550 --> 00:18:00,460
know<font color="#E5E5E5"> working on some of the our rules</font>

411
00:17:59,050 --> 00:18:02,770
that are<font color="#E5E5E5"> in there for identifying</font>

412
00:18:00,460 --> 00:18:07,240
samples<font color="#E5E5E5"> so one of the things that it</font>

413
00:18:02,770 --> 00:18:10,270
lets you do is basically upload<font color="#CCCCCC"> a file</font>

414
00:18:07,240 --> 00:18:12,040
and<font color="#E5E5E5"> then</font><font color="#CCCCCC"> have</font><font color="#E5E5E5"> that file run against all</font>

415
00:18:10,270 --> 00:18:15,310
of the<font color="#CCCCCC"> our signatures that are available</font>

416
00:18:12,040 --> 00:18:18,760
in mal pedia and then<font color="#E5E5E5"> potentially if it</font>

417
00:18:15,310 --> 00:18:21,220
matches one<font color="#CCCCCC"> of those one of those</font><font color="#E5E5E5"> yard</font>

418
00:18:18,760 --> 00:18:23,830
rules it'll give you a you know rule

419
00:18:21,220 --> 00:18:25,470
name<font color="#CCCCCC"> number of strings from</font><font color="#E5E5E5"> that</font>

420
00:18:23,830 --> 00:18:28,899
particular<font color="#E5E5E5"> yard rule that were matched</font>

421
00:18:25,470 --> 00:18:33,190
<font color="#CCCCCC">percent match and then you know yes or</font>

422
00:18:28,900 --> 00:18:34,780
no whether it matched or<font color="#CCCCCC"> not so</font><font color="#E5E5E5"> it has</font>

423
00:18:33,190 --> 00:18:38,080
the potential to<font color="#E5E5E5"> be a very very good</font>

424
00:18:34,780 --> 00:18:39,760
resource and<font color="#CCCCCC"> so you know if you</font><font color="#E5E5E5"> are if</font>

425
00:18:38,080 --> 00:18:42,730
you're a proficient at writing<font color="#E5E5E5"> yard</font>

426
00:18:39,760 --> 00:18:45,100
rules if you've got some free time<font color="#CCCCCC"> I</font>

427
00:18:42,730 --> 00:18:47,590
highly<font color="#CCCCCC"> recommend trying to get</font><font color="#E5E5E5"> into the</font>

428
00:18:45,100 --> 00:18:50,409
community<font color="#CCCCCC"> and contribute to it you know</font>

429
00:18:47,590 --> 00:18:52,959
it needs it<font color="#E5E5E5"> needs to have a few more</font>

430
00:18:50,410 --> 00:18:56,080
yards signatures in there but it is it's

431
00:18:52,960 --> 00:18:59,020
a pretty good service right<font color="#CCCCCC"> now so I</font>

432
00:18:56,080 --> 00:19:02,649
will<font color="#E5E5E5"> plug my former employer so there is</font>

433
00:18:59,020 --> 00:19:06,460
a method<font color="#CCCCCC"> that</font><font color="#E5E5E5"> we have or had back at</font>

434
00:19:02,650 --> 00:19:09,310
<font color="#E5E5E5">threat connect so one</font><font color="#CCCCCC"> of the so you can</font>

435
00:19:06,460 --> 00:19:13,090
sign<font color="#CCCCCC"> up</font><font color="#E5E5E5"> for</font><font color="#CCCCCC"> a free account at TC</font><font color="#E5E5E5"> I still</font>

436
00:19:09,310 --> 00:19:15,520
love them they're great but there's a

437
00:19:13,090 --> 00:19:17,199
system<font color="#E5E5E5"> that my team developed there so</font>

438
00:19:15,520 --> 00:19:20,530
it's actually<font color="#E5E5E5"> very very very very very</font>

439
00:19:17,200 --> 00:19:21,760
<font color="#E5E5E5">simple</font><font color="#CCCCCC"> totally simple so basically</font>

440
00:19:20,530 --> 00:19:23,350
<font color="#E5E5E5">threat</font><font color="#CCCCCC"> Connect is the threat</font>

441
00:19:21,760 --> 00:19:25,870
intelligence platform so you<font color="#E5E5E5"> can relate</font>

442
00:19:23,350 --> 00:19:28,480
different indicators together<font color="#CCCCCC"> you know</font>

443
00:19:25,870 --> 00:19:32,320
it's a it's a bit bit graph theory ish

444
00:19:28,480 --> 00:19:34,780
and so this is<font color="#E5E5E5"> actually a blog that</font><font color="#CCCCCC"> we</font>

445
00:19:32,320 --> 00:19:37,389
wrote that<font color="#E5E5E5"> my team wrote last</font><font color="#CCCCCC"> year when</font>

446
00:19:34,780 --> 00:19:39,280
<font color="#CCCCCC">we</font><font color="#E5E5E5"> first deployed this particular source</font>

447
00:19:37,390 --> 00:19:40,930
of information<font color="#CCCCCC"> and so what we're doing</font>

448
00:19:39,280 --> 00:19:43,480
<font color="#E5E5E5">is basically pulling in all of the</font>

449
00:19:40,930 --> 00:19:45,610
<font color="#E5E5E5">different blogs reports and</font>

450
00:19:43,480 --> 00:19:47,080
<font color="#E5E5E5">anything that we can</font><font color="#CCCCCC"> find that have</font>

451
00:19:45,610 --> 00:19:49,000
indicators<font color="#CCCCCC"> that are published</font><font color="#E5E5E5"> in the</font>

452
00:19:47,080 --> 00:19:50,980
<font color="#E5E5E5">blog and then basically putting them all</font>

453
00:19:49,000 --> 00:19:53,200
in<font color="#CCCCCC"> one</font><font color="#E5E5E5"> place and then finding you know</font>

454
00:19:50,980 --> 00:19:55,600
<font color="#E5E5E5">letting you find relationships between</font>

455
00:19:53,200 --> 00:19:58,270
indicators that<font color="#E5E5E5"> are in the in those</font>

456
00:19:55,600 --> 00:20:01,270
<font color="#CCCCCC">datasets so this first one</font><font color="#E5E5E5"> is actually a</font>

457
00:19:58,270 --> 00:20:03,460
link to the blog go read<font color="#CCCCCC"> about it after</font>

458
00:20:01,270 --> 00:20:05,740
you<font color="#CCCCCC"> sign up for</font><font color="#E5E5E5"> an account or before and</font>

459
00:20:03,460 --> 00:20:08,140
then the<font color="#E5E5E5"> knowledge base down here is</font>

460
00:20:05,740 --> 00:20:10,420
<font color="#CCCCCC">just a</font><font color="#E5E5E5"> little bit of a guide for how</font><font color="#CCCCCC"> to</font>

461
00:20:08,140 --> 00:20:13,330
get<font color="#E5E5E5"> into the data and figure out you</font>

462
00:20:10,420 --> 00:20:17,110
know get get<font color="#E5E5E5"> it</font><font color="#CCCCCC"> indexed properly and</font>

463
00:20:13,330 --> 00:20:19,870
browse it and find data<font color="#CCCCCC"> that you need</font><font color="#E5E5E5"> so</font>

464
00:20:17,110 --> 00:20:22,750
this is a particular you know<font color="#E5E5E5"> there</font>

465
00:20:19,870 --> 00:20:24,250
there<font color="#E5E5E5"> are a few dynamic DNS there's not</font>

466
00:20:22,750 --> 00:20:27,220
<font color="#CCCCCC">just a few</font><font color="#E5E5E5"> sorry there are many many</font>

467
00:20:24,250 --> 00:20:30,130
many many many many many dynamic DNS<font color="#E5E5E5"> you</font>

468
00:20:27,220 --> 00:20:34,090
know host names<font color="#CCCCCC"> so this is</font><font color="#E5E5E5"> just an</font>

469
00:20:30,130 --> 00:20:36,280
example<font color="#E5E5E5"> of dynamic DNS from hop to org</font><font color="#CCCCCC"> I</font>

470
00:20:34,090 --> 00:20:39,419
think that's a<font color="#CCCCCC"> dine I</font><font color="#E5E5E5"> don't remember off</font>

471
00:20:36,280 --> 00:20:42,340
the top of my<font color="#E5E5E5"> head</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> you can see</font>

472
00:20:39,420 --> 00:20:43,930
<font color="#E5E5E5">you've gone from the you know some</font>

473
00:20:42,340 --> 00:20:46,629
indicator that you might have<font color="#CCCCCC"> collected</font>

474
00:20:43,930 --> 00:20:49,480
off of a you know<font color="#E5E5E5"> peak app or something</font>

475
00:20:46,630 --> 00:20:52,000
like<font color="#E5E5E5"> this and then you want to find any</font>

476
00:20:49,480 --> 00:20:54,160
<font color="#E5E5E5">of the reports or any blog postings that</font>

477
00:20:52,000 --> 00:20:56,560
have been you know published about this

478
00:20:54,160 --> 00:20:58,030
and then you can go here kind<font color="#E5E5E5"> of pivot</font>

479
00:20:56,560 --> 00:21:01,270
to<font color="#CCCCCC"> the blog post</font><font color="#E5E5E5"> and then go read the</font>

480
00:20:58,030 --> 00:21:03,639
blog on the on<font color="#E5E5E5"> that blog site so this</font><font color="#CCCCCC"> is</font>

481
00:21:01,270 --> 00:21:05,350
this<font color="#E5E5E5"> this right here</font><font color="#CCCCCC"> kind</font><font color="#E5E5E5"> of solves that</font>

482
00:21:03,640 --> 00:21:08,140
in this incident responders problem

483
00:21:05,350 --> 00:21:09,490
where you know your<font color="#CCCCCC"> hair's on</font><font color="#E5E5E5"> fire</font>

484
00:21:08,140 --> 00:21:10,690
you've got a malware sample you don't

485
00:21:09,490 --> 00:21:12,720
know what it is<font color="#E5E5E5"> and you need to</font><font color="#CCCCCC"> figure</font>

486
00:21:10,690 --> 00:21:15,970
<font color="#E5E5E5">out what it is as quickly as possible</font>

487
00:21:12,720 --> 00:21:18,010
and then there's also the<font color="#E5E5E5"> identity the</font>

488
00:21:15,970 --> 00:21:19,960
the most basic identification<font color="#E5E5E5"> method</font>

489
00:21:18,010 --> 00:21:22,300
<font color="#E5E5E5">google it so if you've got something</font>

490
00:21:19,960 --> 00:21:24,940
<font color="#E5E5E5">just start googling it and you know</font>

491
00:21:22,300 --> 00:21:27,399
chances<font color="#E5E5E5"> are you'll find something like</font>

492
00:21:24,940 --> 00:21:29,590
you might find some result from<font color="#E5E5E5"> you know</font>

493
00:21:27,400 --> 00:21:31,360
hybrid analysis or you<font color="#E5E5E5"> you might find</font>

494
00:21:29,590 --> 00:21:34,510
something something<font color="#E5E5E5"> out there and</font><font color="#CCCCCC"> also</font>

495
00:21:31,360 --> 00:21:36,760
in a blog somewhere<font color="#E5E5E5"> else you know</font><font color="#CCCCCC"> can't</font>

496
00:21:34,510 --> 00:21:39,580
<font color="#E5E5E5">hurt to google it</font><font color="#CCCCCC"> and this you know</font>

497
00:21:36,760 --> 00:21:41,680
<font color="#E5E5E5">there's the requisite xkcd cartoon about</font>

498
00:21:39,580 --> 00:21:44,110
<font color="#E5E5E5">how to become an IT expert which is</font>

499
00:21:41,680 --> 00:21:46,300
<font color="#E5E5E5">google it basically the you know find a</font>

500
00:21:44,110 --> 00:21:48,159
menu bar<font color="#E5E5E5"> item blah blah and then this is</font>

501
00:21:46,300 --> 00:21:50,740
the most important part<font color="#CCCCCC"> it's go to</font>

502
00:21:48,160 --> 00:21:52,300
Google type<font color="#E5E5E5"> in the program name and</font><font color="#CCCCCC"> a</font>

503
00:21:50,740 --> 00:21:54,660
few words related<font color="#E5E5E5"> to what you want to</font><font color="#CCCCCC"> do</font>

504
00:21:52,300 --> 00:21:54,659
want<font color="#E5E5E5"> to know</font>

505
00:21:55,129 --> 00:22:01,699
<font color="#E5E5E5">all right so moving</font><font color="#CCCCCC"> from moving</font><font color="#E5E5E5"> from the</font>

506
00:21:58,830 --> 00:22:04,408
kind of simplest you know simplistic

507
00:22:01,700 --> 00:22:06,119
<font color="#E5E5E5">methods there I'm gonna look into I'm</font>

508
00:22:04,409 --> 00:22:08,580
<font color="#E5E5E5">gonna tell you talk to you about some</font>

509
00:22:06,119 --> 00:22:10,769
static analysis<font color="#E5E5E5"> methods so based based</font>

510
00:22:08,580 --> 00:22:12,330
on static analysis different data<font color="#CCCCCC"> points</font>

511
00:22:10,769 --> 00:22:14,340
that<font color="#E5E5E5"> you</font><font color="#CCCCCC"> can get from doing</font><font color="#E5E5E5"> static</font>

512
00:22:12,330 --> 00:22:17,428
<font color="#E5E5E5">analysis and then pivoting to different</font>

513
00:22:14,340 --> 00:22:20,369
samples<font color="#CCCCCC"> so these are some of</font><font color="#E5E5E5"> the most</font>

514
00:22:17,429 --> 00:22:22,249
<font color="#CCCCCC">basic</font><font color="#E5E5E5"> ones you've got</font><font color="#CCCCCC"> SS deep so SS deep</font>

515
00:22:20,369 --> 00:22:25,859
is a context triggered piecewise hash

516
00:22:22,249 --> 00:22:27,960
<font color="#E5E5E5">and in English what that means is if you</font>

517
00:22:25,859 --> 00:22:29,519
<font color="#E5E5E5">have a file you can</font><font color="#CCCCCC"> take a hash of that</font>

518
00:22:27,960 --> 00:22:32,460
<font color="#E5E5E5">file and you get you know you get a</font>

519
00:22:29,519 --> 00:22:36,029
string of<font color="#E5E5E5"> characters and if you have a</font>

520
00:22:32,460 --> 00:22:39,419
file that<font color="#CCCCCC"> just has some some of the data</font>

521
00:22:36,029 --> 00:22:41,429
changed in that<font color="#E5E5E5"> file</font><font color="#CCCCCC"> you'll get a string</font>

522
00:22:39,419 --> 00:22:46,349
of<font color="#E5E5E5"> characters with just a few of those</font>

523
00:22:41,429 --> 00:22:48,779
characters changed<font color="#E5E5E5"> so using the SS deep</font>

524
00:22:46,349 --> 00:22:51,029
algorithm<font color="#E5E5E5"> if you have two files and you</font>

525
00:22:48,779 --> 00:22:53,429
have<font color="#E5E5E5"> their SS deep hashes you can</font>

526
00:22:51,029 --> 00:22:56,190
compare those two and see how different

527
00:22:53,429 --> 00:22:59,279
<font color="#CCCCCC">they are</font><font color="#E5E5E5"> or how similar they</font><font color="#CCCCCC"> are and you</font>

528
00:22:56,190 --> 00:23:01,679
<font color="#E5E5E5">can pick a threshold of</font><font color="#CCCCCC"> how</font><font color="#E5E5E5"> different or</font>

529
00:22:59,279 --> 00:23:04,619
<font color="#CCCCCC">how similar you want them you</font><font color="#E5E5E5"> know how</font>

530
00:23:01,679 --> 00:23:07,229
your threshold<font color="#CCCCCC"> for saying</font><font color="#E5E5E5"> something is</font>

531
00:23:04,619 --> 00:23:09,749
or is<font color="#CCCCCC"> not related</font><font color="#E5E5E5"> and then if you have a</font>

532
00:23:07,229 --> 00:23:11,789
giant<font color="#CCCCCC"> database of malware you could</font>

533
00:23:09,749 --> 00:23:14,460
submit<font color="#E5E5E5"> one SS deep for the sample that</font>

534
00:23:11,789 --> 00:23:16,099
you<font color="#E5E5E5"> are looking at and then potentially</font>

535
00:23:14,460 --> 00:23:18,599
you'll get back files that are at least

536
00:23:16,099 --> 00:23:22,739
structurally<font color="#CCCCCC"> related to that particular</font>

537
00:23:18,599 --> 00:23:26,220
file<font color="#CCCCCC"> there's a few there's a few</font><font color="#E5E5E5"> points</font>

538
00:23:22,739 --> 00:23:28,409
with SS deep where it sucks<font color="#E5E5E5"> so SS deep</font>

539
00:23:26,220 --> 00:23:30,450
sucks because<font color="#E5E5E5"> of Packers so if you're</font>

540
00:23:28,409 --> 00:23:32,609
going<font color="#E5E5E5"> to run SS deep on a particular</font>

541
00:23:30,450 --> 00:23:34,470
malware sample<font color="#CCCCCC"> make sure that it's</font>

542
00:23:32,609 --> 00:23:36,299
unpacked<font color="#CCCCCC"> if you're running</font><font color="#E5E5E5"> it on a</font>

543
00:23:34,470 --> 00:23:39,059
<font color="#CCCCCC">packer you're basically just taking</font><font color="#E5E5E5"> the</font>

544
00:23:36,299 --> 00:23:42,059
SS deep of the packs<font color="#E5E5E5"> malware and you're</font>

545
00:23:39,059 --> 00:23:44,158
going to find<font color="#E5E5E5"> other related packed</font>

546
00:23:42,059 --> 00:23:45,269
malware that's<font color="#E5E5E5"> that's packed using a</font>

547
00:23:44,159 --> 00:23:46,889
similar<font color="#CCCCCC"> Packer</font><font color="#E5E5E5"> and you're not</font>

548
00:23:45,269 --> 00:23:51,330
necessarily<font color="#CCCCCC"> going to catch the same</font>

549
00:23:46,889 --> 00:23:53,279
malware family import hash so import

550
00:23:51,330 --> 00:23:55,349
hash is calculated from<font color="#CCCCCC"> the PE files</font>

551
00:23:53,279 --> 00:23:56,970
import table so<font color="#E5E5E5"> you take the import</font>

552
00:23:55,349 --> 00:23:58,710
table and then you hash it you come up

553
00:23:56,970 --> 00:24:00,090
<font color="#CCCCCC">with a string of characters and then</font>

554
00:23:58,710 --> 00:24:02,700
that string of<font color="#E5E5E5"> characters can be</font>

555
00:24:00,090 --> 00:24:05,399
<font color="#E5E5E5">compared</font><font color="#CCCCCC"> to a database of other import</font>

556
00:24:02,700 --> 00:24:07,300
hashes and<font color="#E5E5E5"> you can find files that have</font>

557
00:24:05,399 --> 00:24:10,989
the<font color="#CCCCCC"> same import</font><font color="#E5E5E5"> hash</font>

558
00:24:07,300 --> 00:24:12,820
and again<font color="#CCCCCC"> import hash sucks in a one</font>

559
00:24:10,990 --> 00:24:14,980
particular<font color="#CCCCCC"> situation so import hash</font>

560
00:24:12,820 --> 00:24:16,540
sucks<font color="#E5E5E5"> for dotnet</font><font color="#CCCCCC"> so if something is</font>

561
00:24:14,980 --> 00:24:18,010
compiled<font color="#E5E5E5"> with dotnet you put in the</font>

562
00:24:16,540 --> 00:24:20,620
import hash and you're going to see

563
00:24:18,010 --> 00:24:24,010
thousands<font color="#E5E5E5"> and thousands and thousands of</font>

564
00:24:20,620 --> 00:24:26,139
<font color="#E5E5E5">other dotnet import hash</font><font color="#CCCCCC"> and you're not</font>

565
00:24:24,010 --> 00:24:28,270
they are definitely not related to<font color="#E5E5E5"> the</font>

566
00:24:26,140 --> 00:24:29,740
thing<font color="#E5E5E5"> that you're looking at</font><font color="#CCCCCC"> except</font><font color="#E5E5E5"> for</font>

567
00:24:28,270 --> 00:24:30,879
a few<font color="#CCCCCC"> of them and</font><font color="#E5E5E5"> you'll never find them</font>

568
00:24:29,740 --> 00:24:34,450
because<font color="#E5E5E5"> they're gonna be a needle in a</font>

569
00:24:30,880 --> 00:24:36,280
<font color="#E5E5E5">haystack</font><font color="#CCCCCC"> file names file names are a bit</font>

570
00:24:34,450 --> 00:24:39,070
boring<font color="#E5E5E5"> you know finding exactly the same</font>

571
00:24:36,280 --> 00:24:40,389
file name<font color="#CCCCCC"> but what's exciting would be</font>

572
00:24:39,070 --> 00:24:42,730
or a little bit<font color="#E5E5E5"> more exciting still a</font>

573
00:24:40,390 --> 00:24:45,070
little<font color="#E5E5E5"> bit boring is developing a regex</font>

574
00:24:42,730 --> 00:24:49,050
<font color="#E5E5E5">if you find that a</font><font color="#CCCCCC"> particular malware</font>

575
00:24:45,070 --> 00:24:53,050
family drops<font color="#E5E5E5"> a copy of itself or drops a</font>

576
00:24:49,050 --> 00:24:55,870
payload and the payload name<font color="#E5E5E5"> changes</font>

577
00:24:53,050 --> 00:24:58,690
dynamically<font color="#CCCCCC"> there's the potential there</font>

578
00:24:55,870 --> 00:25:01,239
of figuring out<font color="#E5E5E5"> a regex for what that</font>

579
00:24:58,690 --> 00:25:03,250
dynamically changed file name is then

580
00:25:01,240 --> 00:25:07,300
using<font color="#CCCCCC"> that regex</font><font color="#E5E5E5"> to look for related</font>

581
00:25:03,250 --> 00:25:09,850
<font color="#E5E5E5">files now here's where here's where</font>

582
00:25:07,300 --> 00:25:12,669
stuff gets<font color="#E5E5E5"> a little interesting</font><font color="#CCCCCC"> there</font>

583
00:25:09,850 --> 00:25:16,870
are there's a few<font color="#E5E5E5"> secret squirrel groups</font>

584
00:25:12,670 --> 00:25:18,250
that share URL pattern reg<font color="#E5E5E5"> X's if you</font>

585
00:25:16,870 --> 00:25:21,729
want to come<font color="#E5E5E5"> and ask me</font><font color="#CCCCCC"> about that after</font>

586
00:25:18,250 --> 00:25:23,440
the talk<font color="#CCCCCC"> we'll we can chat but</font><font color="#E5E5E5"> so there</font>

587
00:25:21,730 --> 00:25:26,470
are there's basically<font color="#E5E5E5"> the URL structure</font>

588
00:25:23,440 --> 00:25:27,640
for payload download<font color="#E5E5E5"> and this is where</font>

589
00:25:26,470 --> 00:25:31,179
the<font color="#CCCCCC"> malware that's running</font><font color="#E5E5E5"> on your</font>

590
00:25:27,640 --> 00:25:34,210
machine<font color="#E5E5E5"> reaches out to its you know the</font>

591
00:25:31,179 --> 00:25:36,400
payload location downloads a file and

592
00:25:34,210 --> 00:25:38,170
then installs that<font color="#E5E5E5"> payload on your</font>

593
00:25:36,400 --> 00:25:40,960
machine<font color="#CCCCCC"> so that's</font><font color="#E5E5E5"> a you know</font><font color="#CCCCCC"> a child of</font>

594
00:25:38,170 --> 00:25:46,770
the of that<font color="#E5E5E5"> particular layer of malware</font>

595
00:25:40,960 --> 00:25:50,020
<font color="#E5E5E5">so the URL structure of the download URL</font>

596
00:25:46,770 --> 00:25:52,300
<font color="#E5E5E5">is more closely related to the</font>

597
00:25:50,020 --> 00:25:55,750
<font color="#CCCCCC">vulnerability that</font><font color="#E5E5E5"> was used in the CMS</font>

598
00:25:52,300 --> 00:25:58,120
so it's<font color="#E5E5E5"> more related to whatever</font><font color="#CCCCCC"> plugin</font>

599
00:25:55,750 --> 00:26:00,130
they exploited<font color="#E5E5E5"> to get into your</font>

600
00:25:58,120 --> 00:26:02,350
<font color="#CCCCCC">WordPress site for your</font><font color="#E5E5E5"> barber shop and</font>

601
00:26:00,130 --> 00:26:05,320
upload the malware payload so that they

602
00:26:02,350 --> 00:26:08,199
can<font color="#CCCCCC"> piggyback on your on your</font><font color="#E5E5E5"> website</font><font color="#CCCCCC"> so</font>

603
00:26:05,320 --> 00:26:09,850
it's not all that<font color="#CCCCCC"> valuable for what I'm</font>

604
00:26:08,200 --> 00:26:11,260
talking about<font color="#CCCCCC"> but I just</font><font color="#E5E5E5"> wanted to kind</font>

605
00:26:09,850 --> 00:26:14,500
<font color="#E5E5E5">of highlight that that's</font><font color="#CCCCCC"> something that</font>

606
00:26:11,260 --> 00:26:17,919
<font color="#CCCCCC">you can look</font><font color="#E5E5E5"> at so an example of</font><font color="#CCCCCC"> this so</font>

607
00:26:14,500 --> 00:26:18,960
if you have<font color="#CCCCCC"> 2016 if you've got</font><font color="#E5E5E5"> like the</font>

608
00:26:17,919 --> 00:26:23,549
the word

609
00:26:18,960 --> 00:26:25,679
theme 2016 2015 2014 13 12 all they're

610
00:26:23,549 --> 00:26:28,408
<font color="#CCCCCC">all vulnerable</font><font color="#E5E5E5"> to something so you can</font>

611
00:26:25,679 --> 00:26:30,090
<font color="#CCCCCC">write a regex that will kind of</font><font color="#E5E5E5"> look for</font>

612
00:26:28,409 --> 00:26:32,789
look<font color="#CCCCCC"> for that particular</font><font color="#E5E5E5"> pattern I know</font>

613
00:26:30,090 --> 00:26:35,759
this is a<font color="#CCCCCC"> very this</font><font color="#E5E5E5"> is actually kind of</font>

614
00:26:32,789 --> 00:26:37,200
not as this<font color="#CCCCCC"> particular regex is not all</font>

615
00:26:35,759 --> 00:26:39,899
that<font color="#CCCCCC"> useful</font><font color="#E5E5E5"> I just want to demonstrate</font>

616
00:26:37,200 --> 00:26:41,669
like the methodology for<font color="#E5E5E5"> putting</font>

617
00:26:39,899 --> 00:26:45,899
<font color="#E5E5E5">together a regex so this this one is</font>

618
00:26:41,669 --> 00:26:47,460
actually quite<font color="#CCCCCC"> easy to read now this is</font>

619
00:26:45,899 --> 00:26:50,369
where it<font color="#CCCCCC"> gets</font><font color="#E5E5E5"> interesting so the</font><font color="#CCCCCC"> URL</font>

620
00:26:47,460 --> 00:26:54,929
structure for<font color="#E5E5E5"> c2 is where it gets you</font>

621
00:26:50,369 --> 00:26:57,149
know into the structure<font color="#CCCCCC"> of</font><font color="#E5E5E5"> the c2 format</font>

622
00:26:54,929 --> 00:27:00,929
is directly<font color="#CCCCCC"> related to the malware</font>

623
00:26:57,149 --> 00:27:03,988
family so you'll see<font color="#CCCCCC"> you know</font><font color="#E5E5E5"> pony pony</font>

624
00:27:00,929 --> 00:27:06,779
has various file names for in the in the

625
00:27:03,989 --> 00:27:09,299
URL<font color="#E5E5E5"> lots of different URLs</font><font color="#CCCCCC"> so I'll give</font>

626
00:27:06,779 --> 00:27:12,659
<font color="#CCCCCC">you an example</font><font color="#E5E5E5"> of one that I found</font><font color="#CCCCCC"> so</font>

627
00:27:09,299 --> 00:27:14,399
this was back in<font color="#CCCCCC"> January so I was</font>

628
00:27:12,659 --> 00:27:17,159
working<font color="#CCCCCC"> with the journalist who</font><font color="#E5E5E5"> was</font>

629
00:27:14,399 --> 00:27:20,840
under<font color="#E5E5E5"> attack and I was sent some of</font><font color="#CCCCCC"> the</font>

630
00:27:17,159 --> 00:27:23,549
some<font color="#CCCCCC"> of the samples from him and I</font>

631
00:27:20,840 --> 00:27:26,908
didn't act so there's actually<font color="#CCCCCC"> as you</font>

632
00:27:23,549 --> 00:27:29,249
<font color="#CCCCCC">can see here there's a UID there is a</font>

633
00:27:26,909 --> 00:27:30,899
UID in this URL but I'm<font color="#CCCCCC"> not going</font><font color="#E5E5E5"> to</font>

634
00:27:29,249 --> 00:27:31,710
show<font color="#CCCCCC"> it</font><font color="#E5E5E5"> because it actually has the</font>

635
00:27:30,899 --> 00:27:35,039
victims

636
00:27:31,710 --> 00:27:38,519
it's an encoded<font color="#CCCCCC"> Verte it's an encode and</font>

637
00:27:35,039 --> 00:27:40,080
<font color="#E5E5E5">encoding of</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> victims email address so</font>

638
00:27:38,519 --> 00:27:43,649
I'm not<font color="#E5E5E5"> obviously I'm not going to have</font>

639
00:27:40,080 --> 00:27:47,009
that<font color="#E5E5E5"> up on the board</font><font color="#CCCCCC"> but basically you</font>

640
00:27:43,649 --> 00:27:48,928
have<font color="#E5E5E5"> you have the the c2 URL and then</font>

641
00:27:47,009 --> 00:27:50,909
<font color="#E5E5E5">you've got</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> regex that can detect</font>

642
00:27:48,929 --> 00:27:55,950
similar ones and you<font color="#CCCCCC"> can use this to</font>

643
00:27:50,909 --> 00:27:58,109
<font color="#E5E5E5">find related related c2 URLs</font><font color="#CCCCCC"> this one in</font>

644
00:27:55,950 --> 00:28:02,340
particular<font color="#CCCCCC"> I think I think we all know</font>

645
00:27:58,109 --> 00:28:04,199
who this one is so this is actually this

646
00:28:02,340 --> 00:28:07,168
is<font color="#CCCCCC"> a blog that I wrote</font><font color="#E5E5E5"> right after</font><font color="#CCCCCC"> I</font>

647
00:28:04,200 --> 00:28:10,039
found<font color="#E5E5E5"> this and it's actually so this</font>

648
00:28:07,169 --> 00:28:13,739
they were leveraging blogspot and

649
00:28:10,039 --> 00:28:15,539
basically it's a<font color="#E5E5E5"> the it's basically the</font>

650
00:28:13,739 --> 00:28:18,599
worst<font color="#CCCCCC"> blog post ever because it's just</font>

651
00:28:15,539 --> 00:28:22,379
like<font color="#CCCCCC"> one one forwarder to another to</font>

652
00:28:18,599 --> 00:28:24,479
<font color="#CCCCCC">another place so then you know you've</font>

653
00:28:22,379 --> 00:28:26,759
<font color="#CCCCCC">got a whole rabbit</font><font color="#E5E5E5"> hole of exif metadata</font>

654
00:28:24,479 --> 00:28:28,559
<font color="#E5E5E5">so if you run if you run a</font><font color="#CCCCCC"> sample or if</font>

655
00:28:26,759 --> 00:28:30,330
you run<font color="#CCCCCC"> a document through exif you get</font>

656
00:28:28,559 --> 00:28:35,399
this massive you<font color="#E5E5E5"> know</font>

657
00:28:30,330 --> 00:28:36,060
<font color="#E5E5E5">monstrous pile of data</font><font color="#CCCCCC"> let me see if it</font>

658
00:28:35,400 --> 00:28:39,630
actually<font color="#E5E5E5"> worked</font>

659
00:28:36,060 --> 00:28:41,669
<font color="#E5E5E5">all right so up here some of</font><font color="#CCCCCC"> the really</font>

660
00:28:39,630 --> 00:28:43,380
<font color="#E5E5E5">good ones are</font><font color="#CCCCCC"> timestamp so the</font>

661
00:28:41,670 --> 00:28:46,500
compilation<font color="#CCCCCC"> timestamp of</font><font color="#E5E5E5"> the malware</font>

662
00:28:43,380 --> 00:28:48,720
this is very valuable<font color="#CCCCCC"> you can</font><font color="#E5E5E5"> you can</font>

663
00:28:46,500 --> 00:28:52,470
use this in a couple<font color="#CCCCCC"> of interesting</font><font color="#E5E5E5"> ways</font>

664
00:28:48,720 --> 00:28:53,910
if you know the time<font color="#CCCCCC"> that file was</font>

665
00:28:52,470 --> 00:28:56,010
submitted to<font color="#E5E5E5"> something like hybrid</font>

666
00:28:53,910 --> 00:28:59,310
<font color="#E5E5E5">analysis or to virustotal or something</font>

667
00:28:56,010 --> 00:29:01,020
<font color="#E5E5E5">like this</font><font color="#CCCCCC"> you can compare that time with</font>

668
00:28:59,310 --> 00:29:02,909
the timestamp of<font color="#E5E5E5"> the malware and if</font>

669
00:29:01,020 --> 00:29:05,310
they're both<font color="#CCCCCC"> within a certain</font><font color="#E5E5E5"> period of</font>

670
00:29:02,910 --> 00:29:07,590
time very fast<font color="#CCCCCC"> you know a very</font><font color="#E5E5E5"> small</font>

671
00:29:05,310 --> 00:29:09,750
<font color="#E5E5E5">amount</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> time</font><font color="#CCCCCC"> that means that this</font><font color="#E5E5E5"> has</font>

672
00:29:07,590 --> 00:29:11,280
probably been submitted by<font color="#E5E5E5"> the adversary</font>

673
00:29:09,750 --> 00:29:13,170
and<font color="#CCCCCC"> they're testing you know they're</font>

674
00:29:11,280 --> 00:29:16,379
testing the<font color="#CCCCCC"> a/v detections or something</font>

675
00:29:13,170 --> 00:29:18,960
<font color="#E5E5E5">like this so that's a valuable data</font>

676
00:29:16,380 --> 00:29:23,070
point<font color="#CCCCCC"> you know you've got other stuff in</font>

677
00:29:18,960 --> 00:29:25,470
here<font color="#CCCCCC"> like an entry</font><font color="#E5E5E5"> entry point versions</font>

678
00:29:23,070 --> 00:29:29,250
of the software<font color="#CCCCCC"> or fake versions some of</font>

679
00:29:25,470 --> 00:29:31,770
it is<font color="#E5E5E5"> just you</font><font color="#CCCCCC"> know keyboard mash</font><font color="#E5E5E5"> but</font>

680
00:29:29,250 --> 00:29:33,660
there's a plethora of data and<font color="#E5E5E5"> also</font>

681
00:29:31,770 --> 00:29:35,370
language so if you if you're interested

682
00:29:33,660 --> 00:29:38,610
<font color="#CCCCCC">if if it's something</font><font color="#E5E5E5"> that isn't English</font>

683
00:29:35,370 --> 00:29:40,699
<font color="#E5E5E5">then that is a you know an indicator</font>

684
00:29:38,610 --> 00:29:43,790
<font color="#CCCCCC">that you can use in concert with</font><font color="#E5E5E5"> other</font>

685
00:29:40,700 --> 00:29:47,750
indicators<font color="#CCCCCC"> to find relatedness among</font>

686
00:29:43,790 --> 00:29:49,830
malware<font color="#E5E5E5"> so</font><font color="#CCCCCC"> you go</font><font color="#E5E5E5"> back</font><font color="#CCCCCC"> to here</font><font color="#E5E5E5"> and</font>

687
00:29:47,750 --> 00:29:51,120
another way that<font color="#E5E5E5"> you can find other</font>

688
00:29:49,830 --> 00:29:53,639
malware<font color="#E5E5E5"> is through code signing</font>

689
00:29:51,120 --> 00:29:55,979
<font color="#E5E5E5">certificates so it might be signed by a</font>

690
00:29:53,640 --> 00:29:58,920
fake cert<font color="#E5E5E5"> it might be signed by a real</font>

691
00:29:55,980 --> 00:29:59,700
or stolen cert it might just<font color="#E5E5E5"> look</font><font color="#CCCCCC"> like</font>

692
00:29:58,920 --> 00:30:01,260
it's signed

693
00:29:59,700 --> 00:30:02,850
you know they've<font color="#E5E5E5"> made it look like it's</font>

694
00:30:01,260 --> 00:30:05,250
sign but it's not actually signed the

695
00:30:02,850 --> 00:30:08,669
signature is just<font color="#E5E5E5"> broken so it's</font><font color="#CCCCCC"> signed</font>

696
00:30:05,250 --> 00:30:11,250
<font color="#CCCCCC">ich an</font><font color="#E5E5E5"> example of this so this is</font>

697
00:30:08,670 --> 00:30:13,640
actually fairly<font color="#E5E5E5"> old some of</font><font color="#CCCCCC"> you might</font>

698
00:30:11,250 --> 00:30:18,360
<font color="#CCCCCC">recognize this immediately</font><font color="#E5E5E5"> d top tools</font>

699
00:30:13,640 --> 00:30:19,980
<font color="#CCCCCC">but this</font><font color="#E5E5E5"> is a Desilu be</font><font color="#CCCCCC"> apt</font><font color="#E5E5E5"> signed</font>

700
00:30:18,360 --> 00:30:22,709
malware<font color="#E5E5E5"> sample so this is actually a</font>

701
00:30:19,980 --> 00:30:27,960
<font color="#E5E5E5">valid signature from</font><font color="#CCCCCC"> D top tools in</font>

702
00:30:22,710 --> 00:30:29,250
Korea and so we<font color="#E5E5E5"> found using using that</font>

703
00:30:27,960 --> 00:30:32,010
signature we found a lot of other

704
00:30:29,250 --> 00:30:34,020
<font color="#E5E5E5">samples that are that use this same</font>

705
00:30:32,010 --> 00:30:38,090
valid signature so this is actually a

706
00:30:34,020 --> 00:30:41,610
related sample which is<font color="#CCCCCC"> a sac EULA</font><font color="#E5E5E5"> and</font>

707
00:30:38,090 --> 00:30:43,740
so this is probably a<font color="#CCCCCC"> fairly famous one</font>

708
00:30:41,610 --> 00:30:45,809
so<font color="#E5E5E5"> this is one that</font><font color="#CCCCCC"> my team</font><font color="#E5E5E5"> found</font>

709
00:30:43,740 --> 00:30:48,450
<font color="#E5E5E5">this was</font><font color="#CCCCCC"> during the anthem hack a few</font>

710
00:30:45,809 --> 00:30:50,520
years ago<font color="#CCCCCC"> I</font><font color="#E5E5E5"> think many of you might know</font>

711
00:30:48,450 --> 00:30:53,520
it's<font color="#E5E5E5"> an insurance company in the United</font>

712
00:30:50,520 --> 00:30:58,460
States that was hacked<font color="#CCCCCC"> and well point</font><font color="#E5E5E5"> is</font>

713
00:30:53,520 --> 00:31:01,350
well we1 one point is the fake fake

714
00:30:58,460 --> 00:31:03,120
<font color="#E5E5E5">domain that the adversary stood up for</font>

715
00:31:01,350 --> 00:31:07,320
for that particular operation<font color="#E5E5E5"> that they</font>

716
00:31:03,120 --> 00:31:09,629
had so I you<font color="#CCCCCC"> know we wrote a blog post</font>

717
00:31:07,320 --> 00:31:11,550
about<font color="#E5E5E5"> it so please go check out check</font>

718
00:31:09,630 --> 00:31:14,340
<font color="#E5E5E5">out the research</font><font color="#CCCCCC"> I'm not going</font><font color="#E5E5E5"> to go</font><font color="#CCCCCC"> to</font>

719
00:31:11,550 --> 00:31:17,760
too in-depth into it<font color="#E5E5E5"> because we're you</font>

720
00:31:14,340 --> 00:31:20,010
know<font color="#CCCCCC"> we've got</font><font color="#E5E5E5"> about 20</font><font color="#CCCCCC"> minutes left</font><font color="#E5E5E5"> but</font>

721
00:31:17,760 --> 00:31:23,160
moving<font color="#E5E5E5"> on so another another good data</font>

722
00:31:20,010 --> 00:31:26,280
point<font color="#E5E5E5"> sections resources import table</font>

723
00:31:23,160 --> 00:31:28,500
imports exports<font color="#CCCCCC"> all of these various</font>

724
00:31:26,280 --> 00:31:31,200
things<font color="#E5E5E5"> can be used to find related</font>

725
00:31:28,500 --> 00:31:32,880
samples<font color="#CCCCCC"> you know it's hit or miss</font><font color="#E5E5E5"> you</font>

726
00:31:31,200 --> 00:31:35,940
<font color="#E5E5E5">have to for</font><font color="#CCCCCC"> some of these like</font><font color="#E5E5E5"> the</font>

727
00:31:32,880 --> 00:31:38,130
sections<font color="#E5E5E5"> it's good to look for sections</font>

728
00:31:35,940 --> 00:31:40,350
that have low entropy<font color="#E5E5E5"> if it has low</font>

729
00:31:38,130 --> 00:31:41,880
entropy<font color="#E5E5E5"> chances are it isn't something</font>

730
00:31:40,350 --> 00:31:44,639
that's encrypted<font color="#CCCCCC"> so you're not</font><font color="#E5E5E5"> going</font><font color="#CCCCCC"> to</font>

731
00:31:41,880 --> 00:31:50,490
<font color="#E5E5E5">you</font><font color="#CCCCCC"> know you</font><font color="#E5E5E5"> won't find something else</font>

732
00:31:44,640 --> 00:31:53,010
<font color="#E5E5E5">that has the exact same hash so just to</font>

733
00:31:50,490 --> 00:31:54,630
give<font color="#E5E5E5"> you a little primer here so what</font>

734
00:31:53,010 --> 00:31:58,230
we're talking<font color="#CCCCCC"> about</font><font color="#E5E5E5"> are different</font>

735
00:31:54,630 --> 00:32:00,840
<font color="#E5E5E5">sections different areas of data in a</font>

736
00:31:58,230 --> 00:32:04,170
file<font color="#CCCCCC"> and what you want to do is take a</font>

737
00:32:00,840 --> 00:32:08,610
hash of those particular of those

738
00:32:04,170 --> 00:32:10,920
particular sections<font color="#E5E5E5"> or parts of the of</font>

739
00:32:08,610 --> 00:32:12,928
the<font color="#E5E5E5"> file take a hash of them and then</font>

740
00:32:10,920 --> 00:32:15,210
take that hash and look through a

741
00:32:12,929 --> 00:32:18,780
<font color="#E5E5E5">database of hashes from that particular</font>

742
00:32:15,210 --> 00:32:20,610
part of a PE file and you potentially

743
00:32:18,780 --> 00:32:24,389
can find other files<font color="#E5E5E5"> that are related to</font>

744
00:32:20,610 --> 00:32:27,240
<font color="#E5E5E5">the one that you're looking at all right</font>

745
00:32:24,390 --> 00:32:30,360
<font color="#E5E5E5">so sections specifically so this is this</font>

746
00:32:27,240 --> 00:32:33,260
<font color="#E5E5E5">is a section and a</font><font color="#CCCCCC"> sample</font><font color="#E5E5E5"> you know but</font>

747
00:32:30,360 --> 00:32:37,110
it's just<font color="#E5E5E5"> a random one that I found</font><font color="#CCCCCC"> but</font>

748
00:32:33,260 --> 00:32:40,200
<font color="#E5E5E5">basically the the the md5 down at the</font>

749
00:32:37,110 --> 00:32:42,600
bottom<font color="#E5E5E5"> is a sample that's related I'm</font>

750
00:32:40,200 --> 00:32:48,179
sorry this is the<font color="#CCCCCC"> md5 of</font><font color="#E5E5E5"> this particular</font>

751
00:32:42,600 --> 00:32:50,340
relook section and then<font color="#E5E5E5"> resources this</font>

752
00:32:48,179 --> 00:32:52,410
<font color="#CCCCCC">is another way so you've got this</font>

753
00:32:50,340 --> 00:32:54,809
<font color="#E5E5E5">particular</font><font color="#CCCCCC"> sample</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> the RT version the</font>

754
00:32:52,410 --> 00:32:56,640
shop<font color="#CCCCCC"> two v6 of this is such and so you</font>

755
00:32:54,809 --> 00:32:59,780
can use that particular hash

756
00:32:56,640 --> 00:33:04,680
<font color="#E5E5E5">to go find samples that share the same</font>

757
00:32:59,780 --> 00:33:06,720
resource<font color="#CCCCCC"> I know I don't</font><font color="#E5E5E5"> normally</font><font color="#CCCCCC"> talk</font>

758
00:33:04,680 --> 00:33:10,230
about proprietary products and stuff

759
00:33:06,720 --> 00:33:13,110
<font color="#E5E5E5">like that in my talk but virustotal has</font>

760
00:33:10,230 --> 00:33:15,660
a really cool index called similar<font color="#E5E5E5"> to I</font>

761
00:33:13,110 --> 00:33:17,639
have no idea what is<font color="#E5E5E5"> working under the</font>

762
00:33:15,660 --> 00:33:19,890
<font color="#CCCCCC">hood it is complete proprietary black</font>

763
00:33:17,640 --> 00:33:22,620
magic but<font color="#E5E5E5"> it's fairly effective for</font>

764
00:33:19,890 --> 00:33:24,390
finding other files so if you have a

765
00:33:22,620 --> 00:33:26,090
subscription<font color="#CCCCCC"> to virus Odle</font><font color="#E5E5E5"> I highly</font>

766
00:33:24,390 --> 00:33:30,060
recommend going and digging in and

767
00:33:26,090 --> 00:33:30,600
looking at this<font color="#E5E5E5"> one</font><font color="#CCCCCC"> and then document</font>

768
00:33:30,060 --> 00:33:32,610
metadata

769
00:33:30,600 --> 00:33:35,939
I could<font color="#E5E5E5"> probably spend an entire</font><font color="#CCCCCC"> our</font>

770
00:33:32,610 --> 00:33:38,850
talk on<font color="#E5E5E5"> using you know leveraging</font>

771
00:33:35,940 --> 00:33:42,120
document metadata<font color="#E5E5E5"> to figure out</font><font color="#CCCCCC"> for</font>

772
00:33:38,850 --> 00:33:43,530
<font color="#E5E5E5">related malicious documents</font><font color="#CCCCCC"> but some of</font>

773
00:33:42,120 --> 00:33:46,199
the highlights for that<font color="#E5E5E5"> you know you've</font>

774
00:33:43,530 --> 00:33:50,310
got the author<font color="#E5E5E5"> for documents for Word</font>

775
00:33:46,200 --> 00:33:52,350
docs and Excel etc<font color="#CCCCCC"> timestamps are</font>

776
00:33:50,310 --> 00:33:55,080
important created<font color="#E5E5E5"> timestamp modified</font>

777
00:33:52,350 --> 00:33:58,260
timestamp<font color="#CCCCCC"> language</font><font color="#E5E5E5"> can be important and</font>

778
00:33:55,080 --> 00:34:01,409
then in the land<font color="#E5E5E5"> of PDFs the equivalent</font>

779
00:33:58,260 --> 00:34:03,510
<font color="#E5E5E5">of the author is the PDF producer so all</font>

780
00:34:01,410 --> 00:34:06,270
<font color="#E5E5E5">of these are very very good indicators</font>

781
00:34:03,510 --> 00:34:09,418
<font color="#CCCCCC">that things are related</font><font color="#E5E5E5"> to each other so</font>

782
00:34:06,270 --> 00:34:12,000
<font color="#E5E5E5">moving on so let's actually</font><font color="#CCCCCC"> think kind</font>

783
00:34:09,418 --> 00:34:14,429
of<font color="#E5E5E5"> Park all of the information</font><font color="#CCCCCC"> that I</font>

784
00:34:12,000 --> 00:34:15,840
just<font color="#CCCCCC"> went</font><font color="#E5E5E5"> over</font><font color="#CCCCCC"> for static analysis</font>

785
00:34:14,429 --> 00:34:17,460
because we're going<font color="#CCCCCC"> to</font><font color="#E5E5E5"> come back to it</font>

786
00:34:15,840 --> 00:34:21,899
when I get<font color="#CCCCCC"> into like</font><font color="#E5E5E5"> the machine</font>

787
00:34:17,460 --> 00:34:25,139
<font color="#E5E5E5">learning part but let's talk briefly and</font>

788
00:34:21,899 --> 00:34:26,790
I know this part is I think<font color="#E5E5E5"> everybody if</font>

789
00:34:25,139 --> 00:34:28,560
you work in malware analysis you

790
00:34:26,790 --> 00:34:31,259
probably know a<font color="#E5E5E5"> couple of these methods</font>

791
00:34:28,560 --> 00:34:33,299
this<font color="#E5E5E5"> is very very</font><font color="#CCCCCC"> basic so I'll kind</font><font color="#E5E5E5"> of</font>

792
00:34:31,260 --> 00:34:36,630
<font color="#E5E5E5">breeze through it so you have mutexes so</font>

793
00:34:33,300 --> 00:34:39,780
a mutual exclusion<font color="#E5E5E5"> if you have you know</font>

794
00:34:36,630 --> 00:34:41,520
most computers now have concurrency<font color="#E5E5E5"> and</font>

795
00:34:39,780 --> 00:34:42,870
<font color="#E5E5E5">so you can</font><font color="#CCCCCC"> actually run different</font>

796
00:34:41,520 --> 00:34:45,120
threads or you can run things<font color="#E5E5E5"> on</font>

797
00:34:42,870 --> 00:34:48,149
different<font color="#E5E5E5"> processors</font><font color="#CCCCCC"> and so because of</font>

798
00:34:45,120 --> 00:34:50,100
that<font color="#E5E5E5"> a program needs to have a mutual</font>

799
00:34:48,149 --> 00:34:53,899
exclusion so that two<font color="#CCCCCC"> of them don't run</font>

800
00:34:50,100 --> 00:34:56,639
at the same time<font color="#CCCCCC"> and so therefore</font>

801
00:34:53,899 --> 00:35:00,089
<font color="#E5E5E5">malware also needs to have a mutual</font>

802
00:34:56,639 --> 00:35:03,240
exclusion or a mutex<font color="#CCCCCC"> and so sometimes</font>

803
00:35:00,090 --> 00:35:05,280
<font color="#CCCCCC">that mutex they use is unique to that</font>

804
00:35:03,240 --> 00:35:08,100
particular malware family and so that

805
00:35:05,280 --> 00:35:10,349
you<font color="#E5E5E5"> know that is a way</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> finding other</font>

806
00:35:08,100 --> 00:35:13,109
related related samples

807
00:35:10,349 --> 00:35:15,720
of course<font color="#CCCCCC"> what registry</font><font color="#E5E5E5"> keys it touches</font>

808
00:35:13,109 --> 00:35:19,828
whether it writes them whether it reads

809
00:35:15,720 --> 00:35:22,709
them modifies them etc<font color="#E5E5E5"> that set of</font>

810
00:35:19,829 --> 00:35:25,170
registry keys can be unique to<font color="#CCCCCC"> a</font>

811
00:35:22,710 --> 00:35:27,930
particular<font color="#E5E5E5"> malware family</font><font color="#CCCCCC"> I know this is</font>

812
00:35:25,170 --> 00:35:29,549
this part is<font color="#CCCCCC"> very simple stuff but now</font>

813
00:35:27,930 --> 00:35:32,129
all the<font color="#CCCCCC"> information that</font><font color="#E5E5E5"> we</font><font color="#CCCCCC"> just talked</font>

814
00:35:29,549 --> 00:35:33,839
about<font color="#E5E5E5"> those from static analysis</font><font color="#CCCCCC"> I'm</font>

815
00:35:32,130 --> 00:35:36,779
<font color="#CCCCCC">going to talk</font><font color="#E5E5E5"> about how to</font><font color="#CCCCCC"> leverage this</font>

816
00:35:33,839 --> 00:35:38,910
<font color="#E5E5E5">and by the way this is not this isn't a</font>

817
00:35:36,779 --> 00:35:43,319
method<font color="#E5E5E5"> that I</font><font color="#CCCCCC"> came up with</font><font color="#E5E5E5"> this is</font>

818
00:35:38,910 --> 00:35:46,288
actually<font color="#E5E5E5"> Seb Draven</font><font color="#CCCCCC"> if you are familiar</font>

819
00:35:43,319 --> 00:35:48,960
this<font color="#E5E5E5"> is actually so I highly</font><font color="#CCCCCC"> recommend</font>

820
00:35:46,289 --> 00:35:51,269
going and taking<font color="#E5E5E5"> this this workshop from</font>

821
00:35:48,960 --> 00:35:53,549
him<font color="#E5E5E5"> I</font><font color="#CCCCCC"> took it at BOTS comp</font><font color="#E5E5E5"> back in</font>

822
00:35:51,269 --> 00:35:56,399
<font color="#E5E5E5">December fantastic</font>

823
00:35:53,549 --> 00:35:58,049
so it's<font color="#E5E5E5"> about Python using Python and</font>

824
00:35:56,400 --> 00:36:00,630
<font color="#E5E5E5">machine</font><font color="#CCCCCC"> learning to cluster eyes malware</font>

825
00:35:58,049 --> 00:36:03,180
and specifically you know I like to

826
00:36:00,630 --> 00:36:05,640
<font color="#E5E5E5">reuse as much information as other</font>

827
00:36:03,180 --> 00:36:08,220
people I can provide<font color="#E5E5E5"> so but I highly</font>

828
00:36:05,640 --> 00:36:10,140
<font color="#CCCCCC">recommend going</font><font color="#E5E5E5"> and that's everything</font>

829
00:36:08,220 --> 00:36:13,649
you<font color="#CCCCCC"> need is on github so please go look</font>

830
00:36:10,140 --> 00:36:17,129
<font color="#E5E5E5">at his stuff</font><font color="#CCCCCC"> also take his workshop if</font>

831
00:36:13,650 --> 00:36:21,109
he's offering it again<font color="#CCCCCC"> but the the basic</font>

832
00:36:17,130 --> 00:36:23,160
the basis of this<font color="#E5E5E5"> is taking particular</font>

833
00:36:21,109 --> 00:36:27,450
particular data points that<font color="#E5E5E5"> you gather</font>

834
00:36:23,160 --> 00:36:29,279
<font color="#E5E5E5">from static analysis</font><font color="#CCCCCC"> and using them with</font>

835
00:36:27,450 --> 00:36:32,308
<font color="#E5E5E5">machine learning algorithms like k-means</font>

836
00:36:29,279 --> 00:36:35,670
<font color="#E5E5E5">and DB scan</font><font color="#CCCCCC"> to basically cluster eyes</font>

837
00:36:32,309 --> 00:36:39,180
the malware<font color="#E5E5E5"> and from a large malware set</font>

838
00:36:35,670 --> 00:36:42,839
find clusters within<font color="#CCCCCC"> that that</font><font color="#E5E5E5"> malware</font>

839
00:36:39,180 --> 00:36:45,538
set and so one of<font color="#E5E5E5"> the things that one</font><font color="#CCCCCC"> of</font>

840
00:36:42,839 --> 00:36:48,890
the things you'll notice here<font color="#E5E5E5"> is</font><font color="#CCCCCC"> that a</font>

841
00:36:45,539 --> 00:36:53,160
lot of<font color="#E5E5E5"> people think machine learning</font><font color="#CCCCCC"> I</font>

842
00:36:48,890 --> 00:36:56,519
need a GPU<font color="#E5E5E5"> so you actually don't</font><font color="#CCCCCC"> need a</font>

843
00:36:53,160 --> 00:36:58,649
<font color="#E5E5E5">GPU for for machine</font><font color="#CCCCCC"> learning</font><font color="#E5E5E5"> it can help</font>

844
00:36:56,519 --> 00:37:00,479
if you<font color="#E5E5E5"> have a very very large</font><font color="#CCCCCC"> data set</font>

845
00:36:58,650 --> 00:37:01,890
but<font color="#E5E5E5"> if you have a manageable data set</font>

846
00:37:00,479 --> 00:37:06,390
<font color="#E5E5E5">and you want to figure out related</font>

847
00:37:01,890 --> 00:37:10,799
clusters<font color="#CCCCCC"> you don't</font><font color="#E5E5E5"> need a GPU</font><font color="#CCCCCC"> what you</font>

848
00:37:06,390 --> 00:37:12,118
need<font color="#E5E5E5"> is a glass of wine so if you have a</font>

849
00:37:10,799 --> 00:37:15,719
laptop such as this

850
00:37:12,119 --> 00:37:17,549
this one right here plus<font color="#CCCCCC"> some sparse</font>

851
00:37:15,719 --> 00:37:20,549
matrices<font color="#CCCCCC"> so that's one</font><font color="#E5E5E5"> of the keys to</font>

852
00:37:17,549 --> 00:37:22,319
<font color="#E5E5E5">using</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> to getting</font><font color="#CCCCCC"> away basically</font>

853
00:37:20,549 --> 00:37:23,030
<font color="#E5E5E5">getting away</font><font color="#CCCCCC"> with machine learning on</font>

854
00:37:22,319 --> 00:37:26,090
like

855
00:37:23,030 --> 00:37:30,320
<font color="#CCCCCC">a not</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> powerful machine is to use</font>

856
00:37:26,090 --> 00:37:33,350
sparse matrices and<font color="#CCCCCC"> so the</font><font color="#E5E5E5"> the basic</font><font color="#CCCCCC"> for</font>

857
00:37:30,320 --> 00:37:36,260
anyone that isn't<font color="#E5E5E5"> a mathematician the</font>

858
00:37:33,350 --> 00:37:38,930
the basics of a sparse matrix<font color="#CCCCCC"> is if</font>

859
00:37:36,260 --> 00:37:43,760
you've<font color="#CCCCCC"> got a</font><font color="#E5E5E5"> matrix of you know so many</font>

860
00:37:38,930 --> 00:37:45,950
you know<font color="#E5E5E5"> so many points you have a lot</font>

861
00:37:43,760 --> 00:37:48,620
of<font color="#E5E5E5"> zeros typically there's a zero in</font>

862
00:37:45,950 --> 00:37:50,270
<font color="#E5E5E5">many positions in that</font><font color="#CCCCCC"> matrix and so</font>

863
00:37:48,620 --> 00:37:51,410
you're actually<font color="#CCCCCC"> wasting a lot of</font>

864
00:37:50,270 --> 00:37:53,690
resources prata

865
00:37:51,410 --> 00:37:55,879
you know<font color="#E5E5E5"> processing that</font><font color="#CCCCCC"> matrix because</font>

866
00:37:53,690 --> 00:37:58,550
of those<font color="#CCCCCC"> zeros</font><font color="#E5E5E5"> so there's a method of</font>

867
00:37:55,880 --> 00:38:01,070
basically<font color="#E5E5E5"> kind of collapsing</font><font color="#CCCCCC"> the matrix</font>

868
00:37:58,550 --> 00:38:03,800
<font color="#E5E5E5">down to a sparse matrix which removes</font>

869
00:38:01,070 --> 00:38:07,280
the<font color="#E5E5E5"> zeros and</font><font color="#CCCCCC"> makes it manageable for</font><font color="#E5E5E5"> a</font>

870
00:38:03,800 --> 00:38:11,660
less<font color="#E5E5E5"> powerful computer to to to work</font>

871
00:38:07,280 --> 00:38:16,700
with<font color="#CCCCCC"> it so</font><font color="#E5E5E5"> I highly recommend</font><font color="#CCCCCC"> going and</font>

872
00:38:11,660 --> 00:38:19,850
<font color="#CCCCCC">checking out sub draven's you know</font><font color="#E5E5E5"> class</font>

873
00:38:16,700 --> 00:38:22,220
his workshop<font color="#CCCCCC"> but moving</font><font color="#E5E5E5"> on to another</font>

874
00:38:19,850 --> 00:38:24,770
<font color="#CCCCCC">one so</font><font color="#E5E5E5"> this is actually the the diamond</font>

875
00:38:22,220 --> 00:38:26,299
model of intrusion analysis so this<font color="#E5E5E5"> is</font>

876
00:38:24,770 --> 00:38:29,930
something<font color="#E5E5E5"> that that threat connect my</font>

877
00:38:26,300 --> 00:38:31,220
former employer<font color="#E5E5E5"> highly you know</font><font color="#CCCCCC"> you know</font>

878
00:38:29,930 --> 00:38:37,009
they<font color="#E5E5E5"> basically built some of</font><font color="#CCCCCC"> their</font>

879
00:38:31,220 --> 00:38:40,810
system on this<font color="#E5E5E5"> this model so rather than</font>

880
00:38:37,010 --> 00:38:44,060
using malware and by the way so we had a

881
00:38:40,810 --> 00:38:48,110
<font color="#E5E5E5">really incredible discussion coming</font><font color="#CCCCCC"> up</font>

882
00:38:44,060 --> 00:38:51,590
with a diamond model for<font color="#E5E5E5"> Star Wars</font><font color="#CCCCCC"> and</font>

883
00:38:48,110 --> 00:38:54,620
by the<font color="#E5E5E5"> way you you cannot</font><font color="#CCCCCC"> believe</font><font color="#E5E5E5"> how</font>

884
00:38:51,590 --> 00:38:57,290
heated of an argument<font color="#CCCCCC"> we had</font><font color="#E5E5E5"> about like</font>

885
00:38:54,620 --> 00:39:00,620
<font color="#E5E5E5">where certain points lie and the diamond</font>

886
00:38:57,290 --> 00:39:02,240
model but this<font color="#E5E5E5"> basically helps</font><font color="#CCCCCC"> you kind</font>

887
00:39:00,620 --> 00:39:03,470
of understand the diamond model so<font color="#E5E5E5"> you</font>

888
00:39:02,240 --> 00:39:06,410
have the adversary

889
00:39:03,470 --> 00:39:08,750
you've got the victim<font color="#CCCCCC"> capabilities are</font>

890
00:39:06,410 --> 00:39:12,080
kind of like a special<font color="#E5E5E5"> term</font><font color="#CCCCCC"> for the</font>

891
00:39:08,750 --> 00:39:14,960
malware sample itself<font color="#CCCCCC"> so the the you</font>

892
00:39:12,080 --> 00:39:18,110
<font color="#E5E5E5">know of a malicious document or a</font><font color="#CCCCCC"> Trojan</font>

893
00:39:14,960 --> 00:39:20,750
<font color="#E5E5E5">that</font><font color="#CCCCCC"> is under the the auspices of</font>

894
00:39:18,110 --> 00:39:22,670
capabilities and then<font color="#E5E5E5"> infrastructure so</font>

895
00:39:20,750 --> 00:39:24,860
this is all of the online infrastructure

896
00:39:22,670 --> 00:39:28,130
<font color="#E5E5E5">email addresses anything that's used to</font>

897
00:39:24,860 --> 00:39:30,560
communicate with<font color="#CCCCCC"> the capabilities so</font><font color="#E5E5E5"> and</font>

898
00:39:28,130 --> 00:39:33,650
then the bottom is the victim<font color="#E5E5E5"> so this is</font>

899
00:39:30,560 --> 00:39:35,610
the target<font color="#E5E5E5"> of the attack</font><font color="#CCCCCC"> and so the</font>

900
00:39:33,650 --> 00:39:37,560
diamond model<font color="#CCCCCC"> actually gives you</font>

901
00:39:35,610 --> 00:39:39,630
<font color="#E5E5E5">two axes and these this is where things</font>

902
00:39:37,560 --> 00:39:41,759
get fairly<font color="#E5E5E5"> interesting so the technical</font>

903
00:39:39,630 --> 00:39:44,130
axis is where the capabilities

904
00:39:41,760 --> 00:39:45,980
communicate with the<font color="#E5E5E5"> infrastructure and</font>

905
00:39:44,130 --> 00:39:49,170
then the socio-political axis<font color="#E5E5E5"> is</font>

906
00:39:45,980 --> 00:39:50,970
<font color="#E5E5E5">basically answering the question why did</font>

907
00:39:49,170 --> 00:39:54,750
<font color="#E5E5E5">this adversary attack this particular</font>

908
00:39:50,970 --> 00:39:57,930
<font color="#E5E5E5">victim</font><font color="#CCCCCC"> and so you know even</font><font color="#E5E5E5"> if you don't</font>

909
00:39:54,750 --> 00:40:00,750
<font color="#E5E5E5">have data in all of the the corners of</font>

910
00:39:57,930 --> 00:40:05,160
the diamond<font color="#E5E5E5"> you</font><font color="#CCCCCC"> can actually you know</font>

911
00:40:00,750 --> 00:40:08,910
infer a bit of who did<font color="#E5E5E5"> it you know who</font>

912
00:40:05,160 --> 00:40:10,529
done<font color="#CCCCCC"> it if you have</font><font color="#E5E5E5"> some</font><font color="#CCCCCC"> of the data on</font>

913
00:40:08,910 --> 00:40:13,140
here so if you've<font color="#E5E5E5"> got a victim and</font>

914
00:40:10,530 --> 00:40:17,070
you've got capabilities<font color="#CCCCCC"> you may be</font><font color="#E5E5E5"> able</font>

915
00:40:13,140 --> 00:40:18,870
<font color="#E5E5E5">to infer who the adversary is</font><font color="#CCCCCC"> but so</font>

916
00:40:17,070 --> 00:40:22,320
that's<font color="#E5E5E5"> the basics of the diamond model</font>

917
00:40:18,870 --> 00:40:26,100
<font color="#E5E5E5">and I you know I invite</font><font color="#CCCCCC"> you to go read</font>

918
00:40:22,320 --> 00:40:28,380
so it's<font color="#CCCCCC"> actually a scholarly</font><font color="#E5E5E5"> paper</font><font color="#CCCCCC"> this</font>

919
00:40:26,100 --> 00:40:30,480
<font color="#CCCCCC">is the URL for that</font><font color="#E5E5E5"> and all my slides</font>

920
00:40:28,380 --> 00:40:32,610
are gonna be<font color="#E5E5E5"> available I'll you know put</font>

921
00:40:30,480 --> 00:40:34,500
them up on SlideShare<font color="#CCCCCC"> hopefully</font>

922
00:40:32,610 --> 00:40:36,870
hopefully<font color="#E5E5E5"> this after this evening</font><font color="#CCCCCC"> maybe</font>

923
00:40:34,500 --> 00:40:38,960
tomorrow<font color="#CCCCCC"> so don't worry about writing</font>

924
00:40:36,870 --> 00:40:42,900
<font color="#CCCCCC">down all the the URLs you'll have them</font>

925
00:40:38,960 --> 00:40:45,840
so another<font color="#CCCCCC"> association method and</font><font color="#E5E5E5"> also I</font>

926
00:40:42,900 --> 00:40:47,790
apologize the I don't have screenshots

927
00:40:45,840 --> 00:40:49,800
of this because this morning<font color="#E5E5E5"> I was</font>

928
00:40:47,790 --> 00:40:51,450
trying<font color="#E5E5E5"> to connect to it and there were</font>

929
00:40:49,800 --> 00:40:54,180
connection issues I don't<font color="#CCCCCC"> know if it's</font>

930
00:40:51,450 --> 00:40:56,759
the the<font color="#E5E5E5"> ISP that</font><font color="#CCCCCC"> I have here in Serbia</font>

931
00:40:54,180 --> 00:40:59,759
<font color="#CCCCCC">but I</font><font color="#E5E5E5"> wasn't actually able to connect</font><font color="#CCCCCC"> to</font>

932
00:40:56,760 --> 00:41:02,670
ice water<font color="#CCCCCC"> but ice water is a free</font>

933
00:40:59,760 --> 00:41:06,090
service where you<font color="#CCCCCC"> can actually</font><font color="#E5E5E5"> and this</font>

934
00:41:02,670 --> 00:41:08,400
<font color="#E5E5E5">is the URL</font><font color="#CCCCCC"> for it so ice water uses</font><font color="#E5E5E5"> you</font>

935
00:41:06,090 --> 00:41:10,890
know<font color="#E5E5E5"> an algorithm for comparing</font><font color="#CCCCCC"> two to</font>

936
00:41:08,400 --> 00:41:13,140
malicious files<font color="#CCCCCC"> and finding clusters of</font>

937
00:41:10,890 --> 00:41:15,540
<font color="#E5E5E5">them and then you can also take a</font>

938
00:41:13,140 --> 00:41:17,819
cluster and you<font color="#E5E5E5"> can find its cluster</font>

939
00:41:15,540 --> 00:41:22,009
neighbors and so if you've got<font color="#CCCCCC"> a cluster</font>

940
00:41:17,820 --> 00:41:25,260
<font color="#CCCCCC">of maybe</font><font color="#E5E5E5"> ten ten files you can find</font>

941
00:41:22,010 --> 00:41:28,140
another<font color="#E5E5E5"> cluster that's potentially like</font>

942
00:41:25,260 --> 00:41:30,900
one basically one<font color="#CCCCCC"> step away from the</font>

943
00:41:28,140 --> 00:41:34,049
cholesterol looking at or two steps away

944
00:41:30,900 --> 00:41:35,850
<font color="#E5E5E5">so these related clusters may also be</font>

945
00:41:34,050 --> 00:41:37,530
<font color="#E5E5E5">related to the</font><font color="#CCCCCC"> malware cluster that</font>

946
00:41:35,850 --> 00:41:39,630
you're looking at so it's a really

947
00:41:37,530 --> 00:41:42,870
<font color="#CCCCCC">powerful system I highly recommend it</font>

948
00:41:39,630 --> 00:41:45,000
there's a daily there's a daily<font color="#CCCCCC"> report</font>

949
00:41:42,870 --> 00:41:46,620
of new files that have come in and then

950
00:41:45,000 --> 00:41:47,990
they you<font color="#E5E5E5"> know there's a listing of the</font>

951
00:41:46,620 --> 00:41:50,118
clusters

952
00:41:47,990 --> 00:41:53,149
you know and there's some there's some

953
00:41:50,119 --> 00:41:54,670
methods for<font color="#CCCCCC"> you know finding</font><font color="#E5E5E5"> interesting</font>

954
00:41:53,150 --> 00:41:57,980
things so if you've got<font color="#CCCCCC"> a big cluster</font>

955
00:41:54,670 --> 00:41:59,660
that has old files in it<font color="#E5E5E5"> the the new</font>

956
00:41:57,980 --> 00:42:01,520
files that have been<font color="#E5E5E5"> added that cluster</font>

957
00:41:59,660 --> 00:42:03,500
may not actually<font color="#CCCCCC"> be that</font><font color="#E5E5E5"> interesting to</font>

958
00:42:01,520 --> 00:42:05,630
you but if you've got<font color="#CCCCCC"> a</font><font color="#E5E5E5"> cluster</font><font color="#CCCCCC"> that's</font>

959
00:42:03,500 --> 00:42:07,940
new of like two files or a cluster<font color="#E5E5E5"> of</font>

960
00:42:05,630 --> 00:42:09,740
<font color="#CCCCCC">three files that's like that's</font><font color="#E5E5E5"> the gold</font>

961
00:42:07,940 --> 00:42:13,060
that's those are<font color="#CCCCCC"> the things</font><font color="#E5E5E5"> that you</font>

962
00:42:09,740 --> 00:42:15,410
want<font color="#E5E5E5"> to go start reversing and dig into</font>

963
00:42:13,060 --> 00:42:19,400
and<font color="#E5E5E5"> I apologize</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> not having a</font>

964
00:42:15,410 --> 00:42:22,009
screenshot of<font color="#E5E5E5"> it but in the in the the</font>

965
00:42:19,400 --> 00:42:23,240
<font color="#CCCCCC">the slides that I post on SlideShare</font>

966
00:42:22,010 --> 00:42:26,810
I'll definitely make<font color="#E5E5E5"> sure to</font><font color="#CCCCCC"> get</font><font color="#E5E5E5"> some</font>

967
00:42:23,240 --> 00:42:28,609
screenshots in there and then<font color="#E5E5E5"> so this is</font>

968
00:42:26,810 --> 00:42:32,560
actually a really<font color="#E5E5E5"> very very very</font>

969
00:42:28,610 --> 00:42:36,140
<font color="#E5E5E5">interesting</font><font color="#CCCCCC"> method that I learned</font><font color="#E5E5E5"> about</font>

970
00:42:32,560 --> 00:42:42,980
<font color="#CCCCCC">let's see quite a</font><font color="#E5E5E5"> few years ago so 2014</font>

971
00:42:36,140 --> 00:42:44,480
<font color="#E5E5E5">I was in in Derby con and there's a</font>

972
00:42:42,980 --> 00:42:47,990
<font color="#E5E5E5">gentleman there who was giving a talk</font>

973
00:42:44,480 --> 00:42:50,030
about<font color="#E5E5E5"> control flow graph analysis</font><font color="#CCCCCC"> the</font>

974
00:42:47,990 --> 00:42:51,560
the talk that<font color="#E5E5E5"> he gave so this is all the</font>

975
00:42:50,030 --> 00:42:53,660
information<font color="#CCCCCC"> about that</font><font color="#E5E5E5"> so it's the</font>

976
00:42:51,560 --> 00:42:57,320
control<font color="#E5E5E5"> control flow graph based fire</font>

977
00:42:53,660 --> 00:42:59,480
scanning so<font color="#E5E5E5"> Derby con 2014</font><font color="#CCCCCC"> the author's</font>

978
00:42:57,320 --> 00:43:03,500
<font color="#E5E5E5">name is Douglas Goddard and if you watch</font>

979
00:42:59,480 --> 00:43:06,470
this video<font color="#CCCCCC"> if</font><font color="#E5E5E5"> the camera were like this</font>

980
00:43:03,500 --> 00:43:07,900
you'd see my head<font color="#E5E5E5"> but it's a was right</font>

981
00:43:06,470 --> 00:43:12,730
in the<font color="#E5E5E5"> front row right in front of him</font>

982
00:43:07,900 --> 00:43:15,980
<font color="#CCCCCC">but</font><font color="#E5E5E5"> is a very fascinating methodology I</font>

983
00:43:12,730 --> 00:43:18,230
plan<font color="#E5E5E5"> on kind of taking the you know</font>

984
00:43:15,980 --> 00:43:21,290
basically taking the the the the process

985
00:43:18,230 --> 00:43:26,359
<font color="#E5E5E5">that he used and then applying it to PE</font>

986
00:43:21,290 --> 00:43:28,100
files<font color="#E5E5E5"> so the one of the problems well I</font>

987
00:43:26,359 --> 00:43:31,790
mean it's not<font color="#CCCCCC"> really a problem but</font><font color="#E5E5E5"> he</font>

988
00:43:28,100 --> 00:43:34,670
focused only on<font color="#E5E5E5"> a PK so basically only</font>

989
00:43:31,790 --> 00:43:36,920
on Android<font color="#E5E5E5"> malware</font><font color="#CCCCCC"> and the reason for</font>

990
00:43:34,670 --> 00:43:40,070
<font color="#E5E5E5">that is it was very easy to get the the</font>

991
00:43:36,920 --> 00:43:43,609
source code back from a Java<font color="#CCCCCC"> you know</font><font color="#E5E5E5"> a</font>

992
00:43:40,070 --> 00:43:46,310
<font color="#E5E5E5">Java</font><font color="#CCCCCC"> apk and then to take</font><font color="#E5E5E5"> that and get a</font>

993
00:43:43,609 --> 00:43:48,890
control<font color="#E5E5E5"> flow graph</font><font color="#CCCCCC"> it was</font><font color="#E5E5E5"> very easy so</font>

994
00:43:46,310 --> 00:43:51,380
I'd like<font color="#E5E5E5"> to actually</font><font color="#CCCCCC"> take that</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> kind</font>

995
00:43:48,890 --> 00:43:53,480
of you<font color="#E5E5E5"> know go to another level and look</font>

996
00:43:51,380 --> 00:43:58,070
at the control flow graph analysis of PE

997
00:43:53,480 --> 00:44:00,530
files and so<font color="#E5E5E5"> actually is</font><font color="#CCCCCC"> Tyrael here</font>

998
00:43:58,070 --> 00:44:01,740
<font color="#E5E5E5">Carol where are you</font><font color="#CCCCCC"> where I changed this</font>

999
00:44:00,530 --> 00:44:03,690
slide for you

1000
00:44:01,740 --> 00:44:05,580
<font color="#CCCCCC">oh and you're not even</font><font color="#E5E5E5"> in here</font><font color="#CCCCCC"> all right</font>

1001
00:44:03,690 --> 00:44:08,130
<font color="#CCCCCC">well he went</font><font color="#E5E5E5"> he went to the radar</font>

1002
00:44:05,580 --> 00:44:11,430
conference<font color="#E5E5E5"> he just got back so this the</font>

1003
00:44:08,130 --> 00:44:13,800
<font color="#CCCCCC">this is actually a new slide it was it</font>

1004
00:44:11,430 --> 00:44:15,960
<font color="#E5E5E5">was Ida</font><font color="#CCCCCC"> but I switched</font><font color="#E5E5E5"> it forward</font><font color="#CCCCCC"> err</font>

1005
00:44:13,800 --> 00:44:19,010
<font color="#E5E5E5">but it's basically</font><font color="#CCCCCC"> showing</font><font color="#E5E5E5"> you the same</font>

1006
00:44:15,960 --> 00:44:22,470
thing so<font color="#E5E5E5"> you know these are code blocks</font>

1007
00:44:19,010 --> 00:44:24,930
<font color="#CCCCCC">and so the you know</font><font color="#E5E5E5"> these lines that</font>

1008
00:44:22,470 --> 00:44:27,060
<font color="#E5E5E5">connect the</font><font color="#CCCCCC"> loop sorry</font><font color="#E5E5E5"> I want to go to</font>

1009
00:44:24,930 --> 00:44:29,339
this one<font color="#E5E5E5"> so these are code blocks and so</font>

1010
00:44:27,060 --> 00:44:33,150
the lines that connect them are<font color="#E5E5E5"> jump</font>

1011
00:44:29,340 --> 00:44:36,080
statements in in in assembly code so if

1012
00:44:33,150 --> 00:44:39,420
you've got a jump that<font color="#E5E5E5"> creates a loop</font>

1013
00:44:36,080 --> 00:44:41,160
<font color="#CCCCCC">that's one type of</font><font color="#E5E5E5"> control flow</font><font color="#CCCCCC"> if</font>

1014
00:44:39,420 --> 00:44:44,820
you've got an if-then statement that

1015
00:44:41,160 --> 00:44:47,069
jumps<font color="#CCCCCC"> to two optional code blocks</font><font color="#E5E5E5"> and so</font>

1016
00:44:44,820 --> 00:44:50,700
basically if you<font color="#E5E5E5"> take the the the</font>

1017
00:44:47,070 --> 00:44:52,200
essential<font color="#E5E5E5"> the essential like quality</font><font color="#CCCCCC"> of</font>

1018
00:44:50,700 --> 00:44:54,899
<font color="#E5E5E5">this so this is actually called an</font>

1019
00:44:52,200 --> 00:44:59,029
adjacency list<font color="#CCCCCC"> and what you want to do</font>

1020
00:44:54,900 --> 00:45:01,830
is take the<font color="#E5E5E5"> adjacency list and then</font>

1021
00:44:59,030 --> 00:45:04,200
basically display it as a<font color="#CCCCCC"> matrix so you</font>

1022
00:45:01,830 --> 00:45:05,880
<font color="#E5E5E5">have an adjacency matrix and once you've</font>

1023
00:45:04,200 --> 00:45:08,700
got an adjacency matrix you essentially

1024
00:45:05,880 --> 00:45:12,119
have as long as the as long as that

1025
00:45:08,700 --> 00:45:13,830
matrix is based on<font color="#CCCCCC"> non-library</font><font color="#E5E5E5"> code so</font>

1026
00:45:12,119 --> 00:45:15,930
you want to focus on code that<font color="#E5E5E5"> was</font>

1027
00:45:13,830 --> 00:45:17,880
<font color="#CCCCCC">written by the adversary not code that</font>

1028
00:45:15,930 --> 00:45:20,279
was<font color="#E5E5E5"> written by Microsoft or written by</font>

1029
00:45:17,880 --> 00:45:22,710
you know some library that they<font color="#E5E5E5"> got off</font>

1030
00:45:20,280 --> 00:45:25,770
of<font color="#E5E5E5"> github</font><font color="#CCCCCC"> so you</font><font color="#E5E5E5"> don't want you you want</font>

1031
00:45:22,710 --> 00:45:28,320
<font color="#CCCCCC">to</font><font color="#E5E5E5"> exclude library code but once you've</font>

1032
00:45:25,770 --> 00:45:30,180
excluded<font color="#E5E5E5"> library code and you convert an</font>

1033
00:45:28,320 --> 00:45:32,640
adjacency list to an adjacency matrix

1034
00:45:30,180 --> 00:45:35,819
you now have the potential of a

1035
00:45:32,640 --> 00:45:38,670
<font color="#E5E5E5">signature that can relate basically the</font>

1036
00:45:35,820 --> 00:45:40,619
the coding methodology of<font color="#CCCCCC"> the adversary</font>

1037
00:45:38,670 --> 00:45:43,590
<font color="#E5E5E5">and you can find other files that are</font>

1038
00:45:40,619 --> 00:45:45,480
<font color="#E5E5E5">not necessarily might not even be the</font>

1039
00:45:43,590 --> 00:45:48,990
same our family but we're coded by<font color="#E5E5E5"> the</font>

1040
00:45:45,480 --> 00:45:51,690
same person potentially so that's a very

1041
00:45:48,990 --> 00:45:53,368
<font color="#CCCCCC">interesting very interesting angle of</font>

1042
00:45:51,690 --> 00:45:55,800
comparing files and finding<font color="#E5E5E5"> related</font>

1043
00:45:53,369 --> 00:45:58,080
files and<font color="#E5E5E5"> actually one</font><font color="#CCCCCC"> of the</font><font color="#E5E5E5"> things I'm</font>

1044
00:45:55,800 --> 00:46:01,290
working<font color="#CCCCCC"> on is is converting</font><font color="#E5E5E5"> this sort of</font>

1045
00:45:58,080 --> 00:46:02,819
<font color="#E5E5E5">methodology to PE and looking at PE</font>

1046
00:46:01,290 --> 00:46:05,550
files because that's where you know

1047
00:46:02,820 --> 00:46:08,010
<font color="#E5E5E5">that's where all the amount of</font><font color="#CCCCCC"> stuff</font><font color="#E5E5E5"> in</font>

1048
00:46:05,550 --> 00:46:12,119
<font color="#CCCCCC">apk</font><font color="#E5E5E5"> but there's a plethora and the the</font>

1049
00:46:08,010 --> 00:46:13,980
land of Microsoft so that's it if you

1050
00:46:12,119 --> 00:46:15,990
<font color="#CCCCCC">have any questions</font>

1051
00:46:13,980 --> 00:46:22,020
<font color="#CCCCCC">I want to open the floor to questions I</font>

1052
00:46:15,990 --> 00:46:27,419
think we've got a<font color="#CCCCCC"> microphone questions</font>

1053
00:46:22,020 --> 00:46:29,520
questions and yes<font color="#E5E5E5"> hope I can answer but</font>

1054
00:46:27,420 --> 00:46:31,680
first of the<font color="#CCCCCC"> thanks</font><font color="#E5E5E5"> for your talking to</font>

1055
00:46:29,520 --> 00:46:35,009
us<font color="#E5E5E5"> is</font><font color="#CCCCCC"> very interesting my question is</font>

1056
00:46:31,680 --> 00:46:36,868
what's<font color="#CCCCCC"> your opinion on the</font><font color="#E5E5E5"> reliability</font>

1057
00:46:35,010 --> 00:46:39,540
<font color="#CCCCCC">of these indicators when it comes to</font>

1058
00:46:36,869 --> 00:46:41,730
false<font color="#E5E5E5"> black operations for example</font><font color="#CCCCCC"> we</font>

1059
00:46:39,540 --> 00:46:45,420
have seen the marble framework from<font color="#E5E5E5"> the</font>

1060
00:46:41,730 --> 00:46:49,590
shadow brokers release so whatever you

1061
00:46:45,420 --> 00:46:52,170
call it<font color="#CCCCCC"> how</font><font color="#E5E5E5"> reliable is attribution in</font>

1062
00:46:49,590 --> 00:46:55,859
that way<font color="#E5E5E5"> so that's</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> really good</font>

1063
00:46:52,170 --> 00:46:59,820
question<font color="#CCCCCC"> so what</font><font color="#E5E5E5"> I would say is if you</font>

1064
00:46:55,859 --> 00:47:03,359
if you<font color="#E5E5E5"> are aiming to do false flag and</font>

1065
00:46:59,820 --> 00:47:06,119
actually the when this was back in<font color="#E5E5E5"> 2016</font>

1066
00:47:03,359 --> 00:47:08,910
we had a couple<font color="#E5E5E5"> of naysayers that were</font>

1067
00:47:06,119 --> 00:47:10,619
throwing rocks<font color="#E5E5E5"> at my research and they</font>

1068
00:47:08,910 --> 00:47:12,750
were saying<font color="#E5E5E5"> that you know oh I can stand</font>

1069
00:47:10,619 --> 00:47:16,140
up<font color="#E5E5E5"> see to infrastructure that looks</font>

1070
00:47:12,750 --> 00:47:19,350
exactly like<font color="#E5E5E5"> certain apt groups</font><font color="#CCCCCC"> and I</font>

1071
00:47:16,140 --> 00:47:23,339
was like<font color="#CCCCCC"> no you can't no</font><font color="#E5E5E5"> and the reason</font>

1072
00:47:19,350 --> 00:47:25,350
why is yes<font color="#E5E5E5"> absolutely</font><font color="#CCCCCC"> if you look at one</font>

1073
00:47:23,340 --> 00:47:27,690
<font color="#CCCCCC">of</font><font color="#E5E5E5"> these one of these</font><font color="#CCCCCC"> methods that</font>

1074
00:47:25,350 --> 00:47:29,160
<font color="#E5E5E5">method by itself</font><font color="#CCCCCC"> absolutely can be</font>

1075
00:47:27,690 --> 00:47:31,410
<font color="#E5E5E5">reproduced absolutely can</font>

1076
00:47:29,160 --> 00:47:32,970
you know fail<font color="#CCCCCC"> you could have you know</font>

1077
00:47:31,410 --> 00:47:35,930
false flag operations you have false

1078
00:47:32,970 --> 00:47:39,149
positives<font color="#CCCCCC"> but when you accumulate many</font>

1079
00:47:35,930 --> 00:47:40,649
<font color="#E5E5E5">pathways of not necessarily you know</font><font color="#CCCCCC"> I'm</font>

1080
00:47:39,150 --> 00:47:43,260
not<font color="#E5E5E5"> going to go with the attribution but</font>

1081
00:47:40,650 --> 00:47:45,450
pathways of associating files to

1082
00:47:43,260 --> 00:47:48,080
previous files so<font color="#CCCCCC"> that you you know</font><font color="#E5E5E5"> you</font>

1083
00:47:45,450 --> 00:47:51,000
make<font color="#CCCCCC"> associations in that way the more</font>

1084
00:47:48,080 --> 00:47:54,930
<font color="#E5E5E5">variety of associations you make the</font>

1085
00:47:51,000 --> 00:47:59,490
stronger<font color="#E5E5E5"> the you know the attribution or</font>

1086
00:47:54,930 --> 00:48:02,970
Association gets so there you<font color="#E5E5E5"> know any</font>

1087
00:47:59,490 --> 00:48:05,640
<font color="#E5E5E5">of them on its own is weak</font><font color="#CCCCCC"> but if you</font>

1088
00:48:02,970 --> 00:48:07,319
have a number of<font color="#E5E5E5"> them together and</font>

1089
00:48:05,640 --> 00:48:10,170
<font color="#E5E5E5">that's actually that's one of the the</font>

1090
00:48:07,320 --> 00:48:12,720
really<font color="#E5E5E5"> basic components of the diamond</font>

1091
00:48:10,170 --> 00:48:14,609
model is that<font color="#CCCCCC"> you you don't just have</font>

1092
00:48:12,720 --> 00:48:16,500
one<font color="#E5E5E5"> pathway to attribution you have a</font>

1093
00:48:14,609 --> 00:48:19,380
couple of<font color="#E5E5E5"> different</font><font color="#CCCCCC"> pathways even like</font>

1094
00:48:16,500 --> 00:48:21,859
the the socio-economic axis<font color="#E5E5E5"> hope that</font>

1095
00:48:19,380 --> 00:48:21,859
answers your question

1096
00:48:22,320 --> 00:48:28,350
questions more<font color="#CCCCCC"> questions</font>

1097
00:48:29,580 --> 00:48:36,810
<font color="#E5E5E5">all right thank you</font><font color="#CCCCCC"> thanks everybody</font>

1098
00:48:33,060 --> 00:48:39,180
thank you<font color="#E5E5E5"> and if you want to chat about</font>

1099
00:48:36,810 --> 00:48:40,860
<font color="#E5E5E5">any of this</font><font color="#CCCCCC"> stuff</font><font color="#E5E5E5"> you know I'd be</font><font color="#CCCCCC"> happy</font>

1100
00:48:39,180 --> 00:48:43,319
to<font color="#E5E5E5"> chat with you out</font><font color="#CCCCCC"> there or</font><font color="#E5E5E5"> actually</font>

1101
00:48:40,860 --> 00:48:47,690
over there in the<font color="#CCCCCC"> drinks and food room</font>

1102
00:48:43,320 --> 00:48:47,690
<font color="#E5E5E5">so thank you</font>

1103
00:48:50,330 --> 00:49:02,450
[Music]

1104
00:49:01,590 --> 00:49:05,739
[Applause]

1105
00:49:02,450 --> 00:49:05,739
[Music]

