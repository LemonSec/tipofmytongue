1
00:00:00,000 --> 00:00:12,130
[Music]

2
00:00:11,270 --> 00:00:14,360
[Applause]

3
00:00:12,130 --> 00:00:17,430
[Music]

4
00:00:14,360 --> 00:00:27,979
next presentation is masking reflected

5
00:00:17,430 --> 00:00:30,779
DDoS attacks by<font color="#E5E5E5"> Jonathan Azaria</font><font color="#CCCCCC"> okay hi</font>

6
00:00:27,980 --> 00:00:34,260
<font color="#CCCCCC">just okay okay great</font>

7
00:00:30,779 --> 00:00:37,950
hi<font color="#E5E5E5"> I'm here</font><font color="#CCCCCC"> to talk to you about masking</font>

8
00:00:34,260 --> 00:00:41,489
DDoS attacks and they how to try to

9
00:00:37,950 --> 00:00:44,059
protect against<font color="#E5E5E5"> them okay you know you</font>

10
00:00:41,489 --> 00:00:46,500
can<font color="#E5E5E5"> start with our short disclaimer</font>

11
00:00:44,059 --> 00:00:49,078
so my actions<font color="#E5E5E5"> and opinions are not</font><font color="#CCCCCC"> a</font>

12
00:00:46,500 --> 00:00:50,610
reflection<font color="#E5E5E5"> of my employers</font><font color="#CCCCCC"> okay the</font>

13
00:00:49,079 --> 00:00:53,640
information this<font color="#E5E5E5"> presentation is</font><font color="#CCCCCC"> for</font>

14
00:00:50,610 --> 00:00:54,780
educational<font color="#E5E5E5"> purposes only</font><font color="#CCCCCC"> and I'm in no</font>

15
00:00:53,640 --> 00:00:56,879
<font color="#CCCCCC">way responsible if I have this</font>

16
00:00:54,780 --> 00:01:00,059
<font color="#E5E5E5">information used by</font><font color="#CCCCCC"> anyone who isn't me</font>

17
00:00:56,879 --> 00:01:01,858
<font color="#E5E5E5">okay and just</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> make this crystal clear</font>

18
00:01:00,059 --> 00:01:04,018
<font color="#CCCCCC">reading someone without</font><font color="#E5E5E5"> their permission</font>

19
00:01:01,859 --> 00:01:08,330
is illegal yes

20
00:01:04,019 --> 00:01:13,500
even if we call it stress testing<font color="#E5E5E5"> so</font>

21
00:01:08,330 --> 00:01:16,560
about my name is Jonathan Azaria<font color="#CCCCCC"> Johnny</font>

22
00:01:13,500 --> 00:01:22,200
works<font color="#CCCCCC"> to from a security research at the</font>

23
00:01:16,560 --> 00:01:25,080
<font color="#CCCCCC">Imperva in capsular okay what we do web</font>

24
00:01:22,200 --> 00:01:28,560
application firewalls and<font color="#E5E5E5"> DDoS</font>

25
00:01:25,080 --> 00:01:32,880
protection<font color="#E5E5E5"> but protection and some other</font>

26
00:01:28,560 --> 00:01:35,549
cool stuff<font color="#E5E5E5"> okay my what I mainly do is</font>

27
00:01:32,880 --> 00:01:38,250
security research around<font color="#E5E5E5"> DDoS attacks</font>

28
00:01:35,549 --> 00:01:41,729
<font color="#E5E5E5">okay I</font><font color="#CCCCCC"> research it as</font><font color="#E5E5E5"> text</font><font color="#CCCCCC"> how to detect</font>

29
00:01:38,250 --> 00:01:46,409
them<font color="#CCCCCC"> and how to</font><font color="#E5E5E5"> protect against them</font>

30
00:01:41,729 --> 00:01:48,750
look II know<font color="#E5E5E5"> how this talk is gonna work</font>

31
00:01:46,409 --> 00:01:52,740
<font color="#E5E5E5">I'm gonna talk a little bit about the</font>

32
00:01:48,750 --> 00:01:55,469
<font color="#E5E5E5">vacation attacks what we saw we saw</font>

33
00:01:52,740 --> 00:01:57,229
something something some special

34
00:01:55,469 --> 00:01:59,600
phenomena so I'm<font color="#E5E5E5"> gonna talk</font><font color="#CCCCCC"> about that</font>

35
00:01:57,229 --> 00:02:02,310
talk<font color="#CCCCCC"> about</font><font color="#E5E5E5"> what we found</font>

36
00:01:59,600 --> 00:02:05,850
I'm gonna do some a short<font color="#CCCCCC"> technical</font>

37
00:02:02,310 --> 00:02:09,509
overview and a demo<font color="#E5E5E5"> now talking about</font>

38
00:02:05,850 --> 00:02:14,340
demos<font color="#CCCCCC"> I understood</font><font color="#E5E5E5"> that the demagogue is</font>

39
00:02:09,508 --> 00:02:16,829
an angry<font color="#E5E5E5"> god so I tried practicing</font><font color="#CCCCCC"> the</font>

40
00:02:14,340 --> 00:02:19,530
demo for a while it<font color="#E5E5E5"> worked for this</font>

41
00:02:16,830 --> 00:02:21,120
<font color="#E5E5E5">entire week I did a all these different</font>

42
00:02:19,530 --> 00:02:22,709
magnification<font color="#E5E5E5"> and kept</font><font color="#CCCCCC"> them</font><font color="#E5E5E5"> working and</font>

43
00:02:21,120 --> 00:02:24,989
<font color="#E5E5E5">used VPN</font><font color="#CCCCCC"> they use different networks</font>

44
00:02:22,709 --> 00:02:26,760
<font color="#E5E5E5">kept</font><font color="#CCCCCC"> on working today in</font><font color="#E5E5E5"> the morning</font><font color="#CCCCCC"> I</font>

45
00:02:24,989 --> 00:02:31,500
said let's try<font color="#E5E5E5"> it again and of course it</font>

46
00:02:26,760 --> 00:02:34,019
stopped working<font color="#E5E5E5"> so I mean I have to use</font>

47
00:02:31,500 --> 00:02:40,349
<font color="#CCCCCC">the backup</font><font color="#E5E5E5"> I have</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> so it's not gonna</font>

48
00:02:34,019 --> 00:02:44,160
be entirely authentic now does anyone

49
00:02:40,349 --> 00:02:49,940
here and well<font color="#E5E5E5"> does anyone here not know</font>

50
00:02:44,160 --> 00:02:53,840
what DDoS is no<font color="#CCCCCC"> okay great</font>

51
00:02:49,940 --> 00:02:56,440
so just a very quick intro<font color="#CCCCCC"> nudists</font><font color="#E5E5E5"> is</font>

52
00:02:53,840 --> 00:03:00,050
short for distributed denial of services

53
00:02:56,440 --> 00:03:02,390
the major<font color="#E5E5E5"> ideas to overwhelm the victims</font>

54
00:03:00,050 --> 00:03:04,160
the data pipe<font color="#CCCCCC"> okay to bring it a point</font>

55
00:03:02,390 --> 00:03:06,679
<font color="#E5E5E5">where you just can't do anything else</font>

56
00:03:04,160 --> 00:03:09,500
besides handle the data<font color="#E5E5E5"> you send towards</font>

57
00:03:06,680 --> 00:03:12,950
<font color="#E5E5E5">them there are some other methods where</font>

58
00:03:09,500 --> 00:03:15,670
<font color="#CCCCCC">you try to overwhelm the</font><font color="#E5E5E5"> CPU a ovum is a</font>

59
00:03:12,950 --> 00:03:18,380
connection table and some other things

60
00:03:15,670 --> 00:03:20,570
<font color="#E5E5E5">okay and one of the major things about</font>

61
00:03:18,380 --> 00:03:22,370
<font color="#E5E5E5">these attacks it's very easy to execute</font>

62
00:03:20,570 --> 00:03:24,170
<font color="#E5E5E5">okay a lot of script kiddies do that</font>

63
00:03:22,370 --> 00:03:26,330
<font color="#E5E5E5">anyone can do that</font>

64
00:03:24,170 --> 00:03:28,339
tons of leaders tools out there<font color="#E5E5E5"> you can</font>

65
00:03:26,330 --> 00:03:29,420
just download your<font color="#CCCCCC"> computer press</font><font color="#E5E5E5"> few</font>

66
00:03:28,340 --> 00:03:31,490
<font color="#E5E5E5">buttons and</font><font color="#CCCCCC"> that's it</font>

67
00:03:29,420 --> 00:03:35,030
it starts working<font color="#E5E5E5"> and you can</font><font color="#CCCCCC"> flood the</font>

68
00:03:31,490 --> 00:03:37,610
victim and another thing the industry

69
00:03:35,030 --> 00:03:40,220
industry<font color="#E5E5E5"> of protection and mitigation</font>

70
00:03:37,610 --> 00:03:45,620
<font color="#E5E5E5">against DDoS is worth a lot over 1</font>

71
00:03:40,220 --> 00:03:47,690
billion dollars<font color="#CCCCCC"> in during 2017</font><font color="#E5E5E5"> and</font>

72
00:03:45,620 --> 00:03:51,230
there's also another<font color="#CCCCCC"> interesting around</font>

73
00:03:47,690 --> 00:03:51,980
<font color="#E5E5E5">DDoS where you can actually have</font><font color="#CCCCCC"> leaders</font>

74
00:03:51,230 --> 00:03:55,070
for<font color="#CCCCCC"> hire</font>

75
00:03:51,980 --> 00:03:59,840
<font color="#E5E5E5">ok you can hire someone to</font><font color="#CCCCCC"> attack your</font>

76
00:03:55,070 --> 00:04:02,600
victim you pay you have all these funny

77
00:03:59,840 --> 00:04:05,150
subscriptions<font color="#CCCCCC"> in a program</font><font color="#E5E5E5"> you have a</font>

78
00:04:02,600 --> 00:04:07,329
<font color="#CCCCCC">one month two months a lifetime and all</font>

79
00:04:05,150 --> 00:04:10,010
<font color="#E5E5E5">these</font><font color="#CCCCCC"> different things you</font><font color="#E5E5E5"> can get a</font>

80
00:04:07,330 --> 00:04:11,720
certain<font color="#CCCCCC"> amount</font><font color="#E5E5E5"> of a concurrent attacks</font>

81
00:04:10,010 --> 00:04:13,790
at<font color="#E5E5E5"> the same time you have 24/7 support</font>

82
00:04:11,720 --> 00:04:18,560
<font color="#E5E5E5">and all these different things</font><font color="#CCCCCC"> ok it's a</font>

83
00:04:13,790 --> 00:04:21,168
<font color="#E5E5E5">very thriving industry now this is your</font>

84
00:04:18,560 --> 00:04:23,840
<font color="#E5E5E5">very very small presentation</font><font color="#CCCCCC"> about</font><font color="#E5E5E5"> the</font>

85
00:04:21,168 --> 00:04:26,090
<font color="#E5E5E5">doctors they have a victim let's say he</font>

86
00:04:23,840 --> 00:04:28,250
<font color="#CCCCCC">has a pipe size of a</font><font color="#E5E5E5"> 15 megabits per</font>

87
00:04:26,090 --> 00:04:31,760
second<font color="#CCCCCC"> and he wants to watch his</font>

88
00:04:28,250 --> 00:04:33,530
<font color="#E5E5E5">favorite show</font><font color="#CCCCCC"> ok</font><font color="#E5E5E5"> now you get around with</font>

89
00:04:31,760 --> 00:04:35,210
some<font color="#E5E5E5"> of</font><font color="#CCCCCC"> your your</font><font color="#E5E5E5"> friends and you say</font>

90
00:04:33,530 --> 00:04:36,590
well I<font color="#CCCCCC"> don't like that guy so much that</font>

91
00:04:35,210 --> 00:04:38,239
stop<font color="#E5E5E5"> them from watching</font><font color="#CCCCCC"> the show I'm</font>

92
00:04:36,590 --> 00:04:41,869
gonna<font color="#E5E5E5"> show him what</font><font color="#CCCCCC"> a true hacker looks</font>

93
00:04:38,240 --> 00:04:43,610
like so you<font color="#E5E5E5"> get your friends and each</font>

94
00:04:41,870 --> 00:04:48,260
one<font color="#E5E5E5"> of you you</font><font color="#CCCCCC"> don't have so much say</font>

95
00:04:43,610 --> 00:04:50,780
such a<font color="#E5E5E5"> big in bandwidth each one of you</font>

96
00:04:48,260 --> 00:04:53,300
but<font color="#E5E5E5"> all together you can sum it up to</font>

97
00:04:50,780 --> 00:04:55,969
over 50 megabits per second<font color="#E5E5E5"> and</font><font color="#CCCCCC"> now your</font>

98
00:04:53,300 --> 00:04:57,800
victim<font color="#E5E5E5"> can't watch this show anymore</font><font color="#CCCCCC"> ok</font>

99
00:04:55,970 --> 00:04:58,610
so that's<font color="#E5E5E5"> the basic idea</font>

100
00:04:57,800 --> 00:05:02,330
around the

101
00:04:58,610 --> 00:05:06,949
someone okay<font color="#E5E5E5"> now let's talk about do the</font>

102
00:05:02,330 --> 00:05:12,500
simplification attack okay<font color="#E5E5E5"> so this is a</font>

103
00:05:06,949 --> 00:05:15,409
small presentation so the<font color="#CCCCCC"> ideas</font><font color="#E5E5E5"> like</font>

104
00:05:12,500 --> 00:05:17,840
<font color="#E5E5E5">this when you talk</font><font color="#CCCCCC"> about a</font><font color="#E5E5E5"> little</font>

105
00:05:15,409 --> 00:05:20,629
simplification<font color="#E5E5E5"> what</font><font color="#CCCCCC"> you do is that you</font>

106
00:05:17,840 --> 00:05:22,429
exploit a server<font color="#E5E5E5"> the tends to respond</font>

107
00:05:20,629 --> 00:05:24,409
with a response<font color="#CCCCCC"> that's much larger</font><font color="#E5E5E5"> than</font>

108
00:05:22,430 --> 00:05:27,710
the<font color="#CCCCCC"> request okay</font><font color="#E5E5E5"> in order</font><font color="#CCCCCC"> to amplify</font>

109
00:05:24,409 --> 00:05:33,740
<font color="#CCCCCC">your attack against the target in other</font>

110
00:05:27,710 --> 00:05:34,969
words the vulnerable<font color="#E5E5E5"> the computer server</font>

111
00:05:33,740 --> 00:05:36,919
that has<font color="#E5E5E5"> a</font><font color="#CCCCCC"> vulnerability the</font>

112
00:05:34,969 --> 00:05:39,259
vulnerability isn't the one you attack

113
00:05:36,919 --> 00:05:41,150
you<font color="#CCCCCC"> just use it in</font><font color="#E5E5E5"> order to attack the</font>

114
00:05:39,259 --> 00:05:43,370
<font color="#CCCCCC">victim</font><font color="#E5E5E5"> now this is kind of special</font>

115
00:05:41,150 --> 00:05:44,929
<font color="#CCCCCC">because</font><font color="#E5E5E5"> you don't exactly see it it's</font>

116
00:05:43,370 --> 00:05:46,849
<font color="#E5E5E5">not very common in different attacks</font>

117
00:05:44,930 --> 00:05:48,710
<font color="#CCCCCC">usually if someone is vulnerable use</font>

118
00:05:46,849 --> 00:05:50,800
that vulnerability<font color="#E5E5E5"> against them but this</font>

119
00:05:48,710 --> 00:05:56,090
<font color="#CCCCCC">is not the case an amplification</font><font color="#E5E5E5"> attack</font>

120
00:05:50,800 --> 00:05:58,969
<font color="#E5E5E5">okay now there are some prerequisites</font>

121
00:05:56,090 --> 00:06:01,250
<font color="#E5E5E5">for</font><font color="#CCCCCC"> an amplification</font><font color="#E5E5E5"> attack you must</font>

122
00:05:58,969 --> 00:06:03,589
have service<font color="#E5E5E5"> that responds with a very</font>

123
00:06:01,250 --> 00:06:05,389
large payload<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> so you send it a</font>

124
00:06:03,589 --> 00:06:07,879
small packet and it responds<font color="#CCCCCC"> with</font><font color="#E5E5E5"> a very</font>

125
00:06:05,389 --> 00:06:11,569
large pocket packet usually when it's

126
00:06:07,879 --> 00:06:13,789
<font color="#E5E5E5">above a litigation factor of</font><font color="#CCCCCC"> five so the</font>

127
00:06:11,569 --> 00:06:15,889
response is<font color="#CCCCCC"> the five times larger than</font>

128
00:06:13,789 --> 00:06:18,589
the<font color="#CCCCCC"> than the</font><font color="#E5E5E5"> request</font><font color="#CCCCCC"> then you consider</font>

129
00:06:15,889 --> 00:06:20,539
it<font color="#CCCCCC"> in</font><font color="#E5E5E5"> amplification attack you must work</font>

130
00:06:18,589 --> 00:06:22,430
<font color="#E5E5E5">with a spoof upon protocol okay because</font>

131
00:06:20,539 --> 00:06:24,289
<font color="#E5E5E5">the concept is that you spoof the</font>

132
00:06:22,430 --> 00:06:26,270
<font color="#CCCCCC">victim's IP</font><font color="#E5E5E5"> so if you work it</font><font color="#CCCCCC"> up reverse</font>

133
00:06:24,289 --> 00:06:27,919
the protocol<font color="#E5E5E5"> that they employ some sort</font>

134
00:06:26,270 --> 00:06:30,859
of a handshake<font color="#E5E5E5"> authentication of any</font>

135
00:06:27,919 --> 00:06:32,180
sorts so it's not really possible<font color="#E5E5E5"> and</font>

136
00:06:30,860 --> 00:06:34,339
<font color="#E5E5E5">the service must be open</font><font color="#CCCCCC"> to the world</font>

137
00:06:32,180 --> 00:06:35,779
<font color="#CCCCCC">okay if it's opened internally then you</font>

138
00:06:34,339 --> 00:06:37,610
might be<font color="#CCCCCC"> able to</font><font color="#E5E5E5"> be as your colleague</font>

139
00:06:35,779 --> 00:06:39,650
but<font color="#CCCCCC"> you want to be the sexual people in</font>

140
00:06:37,610 --> 00:06:42,110
the way once you have and the service

141
00:06:39,650 --> 00:06:45,799
<font color="#CCCCCC">you have to have the service open to the</font>

142
00:06:42,110 --> 00:06:47,990
world<font color="#CCCCCC"> now let's do a small</font><font color="#E5E5E5"> example just</font>

143
00:06:45,800 --> 00:06:50,870
as you see this is<font color="#CCCCCC"> what an hex dump of</font>

144
00:06:47,990 --> 00:06:52,729
an interview<font color="#E5E5E5"> request</font><font color="#CCCCCC"> looks</font><font color="#E5E5E5"> like and this</font>

145
00:06:50,870 --> 00:06:55,129
<font color="#CCCCCC">is what the response looks like in this</font>

146
00:06:52,729 --> 00:06:59,310
<font color="#E5E5E5">case we've got the</font><font color="#CCCCCC"> 17 amplification</font>

147
00:06:55,129 --> 00:07:01,470
factor but the<font color="#E5E5E5"> NDP can get up to 556</font>

148
00:06:59,310 --> 00:07:04,620
<font color="#E5E5E5">okay so that's a major</font><font color="#CCCCCC"> implication</font>

149
00:07:01,470 --> 00:07:08,520
factor now let's get<font color="#E5E5E5"> small</font><font color="#CCCCCC"> ei</font><font color="#E5E5E5"> attack</font>

150
00:07:04,620 --> 00:07:11,130
flow<font color="#E5E5E5"> let you have an</font><font color="#CCCCCC"> attacker</font><font color="#E5E5E5"> and you</font>

151
00:07:08,520 --> 00:07:13,169
have a<font color="#E5E5E5"> victim now that I could can send</font>

152
00:07:11,130 --> 00:07:15,360
<font color="#E5E5E5">only up to five megabits per second now</font>

153
00:07:13,169 --> 00:07:17,549
usually this won't be enough to cause

154
00:07:15,360 --> 00:07:19,169
<font color="#E5E5E5">any any</font><font color="#CCCCCC"> server chief all right five</font>

155
00:07:17,550 --> 00:07:22,830
<font color="#CCCCCC">minutes per second</font><font color="#E5E5E5"> there's barely</font>

156
00:07:19,169 --> 00:07:24,780
anything<font color="#E5E5E5"> so the attacker goes</font><font color="#CCCCCC"> in shorten</font>

157
00:07:22,830 --> 00:07:28,169
<font color="#E5E5E5">and he finds</font><font color="#CCCCCC"> this bunch of</font><font color="#E5E5E5"> nice entity</font>

158
00:07:24,780 --> 00:07:31,200
service that respond<font color="#E5E5E5"> to his request now</font>

159
00:07:28,169 --> 00:07:34,409
he can send a<font color="#E5E5E5"> request to these servers</font>

160
00:07:31,200 --> 00:07:36,060
while spoofing<font color="#E5E5E5"> the</font><font color="#CCCCCC"> victims IP</font><font color="#E5E5E5"> the server</font>

161
00:07:34,410 --> 00:07:39,000
will respond<font color="#E5E5E5"> to the victim because this</font>

162
00:07:36,060 --> 00:07:42,750
is UDP so he thinks the victims<font color="#E5E5E5"> in since</font>

163
00:07:39,000 --> 00:07:44,730
send<font color="#CCCCCC"> miss respond best a request</font><font color="#E5E5E5"> and</font>

164
00:07:42,750 --> 00:07:46,820
because we said<font color="#CCCCCC"> we have</font><font color="#E5E5E5"> about five</font>

165
00:07:44,730 --> 00:07:49,410
<font color="#E5E5E5">hundred</font><font color="#CCCCCC"> fifty six amplification factor</font>

166
00:07:46,820 --> 00:07:52,020
from five megabits per second we reach

167
00:07:49,410 --> 00:07:55,860
up to 2.5 gigabytes per second which

168
00:07:52,020 --> 00:07:58,409
<font color="#E5E5E5">will probably smash the victims server</font>

169
00:07:55,860 --> 00:08:02,550
<font color="#CCCCCC">now the victim is hit you repeat again</font>

170
00:07:58,410 --> 00:08:04,530
<font color="#CCCCCC">again</font><font color="#E5E5E5"> until the victim is down okay so</font>

171
00:08:02,550 --> 00:08:06,840
this way you<font color="#CCCCCC"> can see how one single</font>

172
00:08:04,530 --> 00:08:11,419
attacker can actually<font color="#E5E5E5"> cause a lot of</font>

173
00:08:06,840 --> 00:08:14,669
damage<font color="#E5E5E5"> and cause a lot</font><font color="#CCCCCC"> of damage</font><font color="#E5E5E5"> and</font>

174
00:08:11,419 --> 00:08:15,719
make a server<font color="#E5E5E5"> go down without needing</font>

175
00:08:14,669 --> 00:08:18,870
any friends without<font color="#E5E5E5"> really needing</font>

176
00:08:15,720 --> 00:08:24,380
anything<font color="#E5E5E5"> besides knowing what a service</font>

177
00:08:18,870 --> 00:08:27,360
will respond<font color="#E5E5E5"> to his request okay so now</font>

178
00:08:24,380 --> 00:08:30,060
let's talk<font color="#CCCCCC"> about how we detect</font><font color="#E5E5E5"> this kind</font>

179
00:08:27,360 --> 00:08:31,979
<font color="#CCCCCC">of notification attacks so does anyone</font>

180
00:08:30,060 --> 00:08:33,750
<font color="#CCCCCC">know what's the easiest</font><font color="#E5E5E5"> way to detect an</font>

181
00:08:31,979 --> 00:08:37,169
amplification attack

182
00:08:33,750 --> 00:08:43,809
[Music]

183
00:08:37,169 --> 00:08:45,819
anyone<font color="#CCCCCC"> mohit so one of the easiest ways</font>

184
00:08:43,809 --> 00:08:47,079
<font color="#E5E5E5">because we said these are services</font><font color="#CCCCCC"> okay</font>

185
00:08:45,820 --> 00:08:50,140
these<font color="#E5E5E5"> services are</font><font color="#CCCCCC"> open to the</font><font color="#E5E5E5"> world</font>

186
00:08:47,080 --> 00:08:52,630
like<font color="#CCCCCC"> NTP</font><font color="#E5E5E5"> in DNS and some other services</font>

187
00:08:50,140 --> 00:08:54,819
<font color="#CCCCCC">that well-known they have to publish</font>

188
00:08:52,630 --> 00:08:57,340
<font color="#CCCCCC">themselves and usually work of a very</font>

189
00:08:54,820 --> 00:08:58,900
<font color="#E5E5E5">specific protocol of a very</font><font color="#CCCCCC"> specific</font>

190
00:08:57,340 --> 00:09:01,840
protocol<font color="#E5E5E5"> and they were very specific</font>

191
00:08:58,900 --> 00:09:04,689
port<font color="#CCCCCC"> okay so let's say DNS works of a</font>

192
00:09:01,840 --> 00:09:07,690
port 53<font color="#E5E5E5"> NTP works over port</font><font color="#CCCCCC"> one two</font>

193
00:09:04,690 --> 00:09:09,490
<font color="#CCCCCC">three so the easiest way to detect</font><font color="#E5E5E5"> we</font>

194
00:09:07,690 --> 00:09:11,230
have an amplification that coming in

195
00:09:09,490 --> 00:09:14,440
your way<font color="#CCCCCC"> is just</font><font color="#E5E5E5"> looking</font><font color="#CCCCCC"> at</font><font color="#E5E5E5"> the source</font>

196
00:09:11,230 --> 00:09:15,790
port whoever sent the<font color="#CCCCCC"> packet</font><font color="#E5E5E5"> okay just</font>

197
00:09:14,440 --> 00:09:17,710
look<font color="#E5E5E5"> at the source port of the packet</font>

198
00:09:15,790 --> 00:09:20,740
<font color="#E5E5E5">and you can realize this is</font>

199
00:09:17,710 --> 00:09:22,690
amplification<font color="#E5E5E5"> attack now another</font><font color="#CCCCCC"> option</font>

200
00:09:20,740 --> 00:09:25,480
as I said because<font color="#CCCCCC"> these</font><font color="#E5E5E5"> services are</font>

201
00:09:22,690 --> 00:09:27,220
published<font color="#E5E5E5"> you can just find an IP list</font>

202
00:09:25,480 --> 00:09:28,570
of most of them<font color="#E5E5E5"> you can compose it by</font>

203
00:09:27,220 --> 00:09:31,060
looking<font color="#CCCCCC"> shut</font><font color="#E5E5E5"> down look in some other</font>

204
00:09:28,570 --> 00:09:33,100
sources<font color="#E5E5E5"> and just find an IP list of all</font>

205
00:09:31,060 --> 00:09:34,209
<font color="#E5E5E5">these</font><font color="#CCCCCC"> different services</font><font color="#E5E5E5"> in such a way</font>

206
00:09:33,100 --> 00:09:36,190
that<font color="#E5E5E5"> you can know</font><font color="#CCCCCC"> that when you get</font>

207
00:09:34,210 --> 00:09:38,740
traffic<font color="#E5E5E5"> from</font><font color="#CCCCCC"> this IP</font><font color="#E5E5E5"> it's probably an</font>

208
00:09:36,190 --> 00:09:41,200
amplification attack and the last thing

209
00:09:38,740 --> 00:09:43,480
this<font color="#E5E5E5"> is very general</font><font color="#CCCCCC"> -</font><font color="#E5E5E5"> DDoS you can just</font>

210
00:09:41,200 --> 00:09:45,930
look at a piece<font color="#E5E5E5"> that</font><font color="#CCCCCC"> a high rate that</font>

211
00:09:43,480 --> 00:09:49,360
<font color="#CCCCCC">they fire</font><font color="#E5E5E5"> way</font><font color="#CCCCCC"> more than they should have</font>

212
00:09:45,930 --> 00:09:51,370
fired<font color="#E5E5E5"> in other words you've seen a pink</font>

213
00:09:49,360 --> 00:09:53,920
<font color="#E5E5E5">that sends more traffic at you than you</font>

214
00:09:51,370 --> 00:09:56,080
would expect<font color="#CCCCCC"> now this usually</font><font color="#E5E5E5"> isn't very</font>

215
00:09:53,920 --> 00:09:58,780
<font color="#E5E5E5">easy to detect okay you have to have</font>

216
00:09:56,080 --> 00:10:00,460
some sort<font color="#CCCCCC"> of</font><font color="#E5E5E5"> mechanism that does that</font>

217
00:09:58,780 --> 00:10:04,060
<font color="#E5E5E5">that knows what's supposed to happen</font>

218
00:10:00,460 --> 00:10:05,830
what actually happens okay now what I'm

219
00:10:04,060 --> 00:10:08,319
here to talk<font color="#CCCCCC"> about is that this isn't</font>

220
00:10:05,830 --> 00:10:12,250
<font color="#E5E5E5">always the case</font><font color="#CCCCCC"> okay you can't always</font>

221
00:10:08,320 --> 00:10:16,570
rely on soft spot on an IP IP<font color="#CCCCCC"> lest to</font>

222
00:10:12,250 --> 00:10:18,700
mitigate amplification attacks now what

223
00:10:16,570 --> 00:10:21,610
did we<font color="#E5E5E5"> see as part</font><font color="#CCCCCC"> of my job</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> the</font>

224
00:10:18,700 --> 00:10:23,410
security researcher<font color="#CCCCCC"> local</font><font color="#E5E5E5"> DDoS attacks</font>

225
00:10:21,610 --> 00:10:25,270
<font color="#E5E5E5">we have all these different attacks</font>

226
00:10:23,410 --> 00:10:26,469
coming<font color="#E5E5E5"> in our</font><font color="#CCCCCC"> way and we need to look at</font>

227
00:10:25,270 --> 00:10:28,150
them<font color="#E5E5E5"> and mean to see</font><font color="#CCCCCC"> what's what</font>

228
00:10:26,470 --> 00:10:30,460
happened there<font color="#E5E5E5"> and</font><font color="#CCCCCC"> how we</font><font color="#E5E5E5"> can prevent it</font>

229
00:10:28,150 --> 00:10:32,829
from<font color="#CCCCCC"> having again</font><font color="#E5E5E5"> happening again and</font><font color="#CCCCCC"> a</font>

230
00:10:30,460 --> 00:10:34,690
what<font color="#CCCCCC"> kind mechanism welcome ruse we can</font>

231
00:10:32,830 --> 00:10:38,360
put in<font color="#E5E5E5"> to prevent these attacks from</font>

232
00:10:34,690 --> 00:10:41,179
<font color="#E5E5E5">happening</font><font color="#CCCCCC"> okay so</font>

233
00:10:38,360 --> 00:10:43,819
we<font color="#CCCCCC"> sign</font><font color="#E5E5E5"> amplification attack coming</font><font color="#CCCCCC"> from</font>

234
00:10:41,179 --> 00:10:45,559
<font color="#CCCCCC">nontrivial</font><font color="#E5E5E5"> saw sports okay</font><font color="#CCCCCC"> we expected</font>

235
00:10:43,819 --> 00:10:47,059
<font color="#E5E5E5">this attack</font><font color="#CCCCCC"> as</font><font color="#E5E5E5"> as</font><font color="#CCCCCC"> appears said we</font>

236
00:10:45,559 --> 00:10:49,368
expected this<font color="#E5E5E5"> attack to come from a</font>

237
00:10:47,059 --> 00:10:51,350
specific source port and it came from

238
00:10:49,369 --> 00:10:54,049
other source ports<font color="#E5E5E5"> now it was coupled</font>

239
00:10:51,350 --> 00:10:55,639
with the<font color="#CCCCCC"> Traverse or sports</font><font color="#E5E5E5"> but with</font>

240
00:10:54,049 --> 00:10:58,279
other source ports as well as<font color="#E5E5E5"> we said</font>

241
00:10:55,639 --> 00:11:00,379
this is<font color="#E5E5E5"> not expected you usually don't</font>

242
00:10:58,279 --> 00:11:03,040
<font color="#E5E5E5">think that amplification attack will</font>

243
00:11:00,379 --> 00:11:05,899
come from<font color="#CCCCCC"> different source ports</font><font color="#E5E5E5"> no</font>

244
00:11:03,040 --> 00:11:07,998
attack was very high volume so it wasn't

245
00:11:05,899 --> 00:11:11,569
some kind of fluke that you just cut<font color="#E5E5E5"> a</font>

246
00:11:07,999 --> 00:11:14,299
few packets for<font color="#CCCCCC"> maintenant</font><font color="#E5E5E5"> some services</font>

247
00:11:11,569 --> 00:11:18,649
<font color="#CCCCCC">that</font><font color="#E5E5E5"> very</font><font color="#CCCCCC"> strange e and as you can</font><font color="#E5E5E5"> see</font>

248
00:11:14,299 --> 00:11:21,019
<font color="#E5E5E5">here this</font><font color="#CCCCCC"> is a very big traffic</font><font color="#E5E5E5"> and we</font>

249
00:11:18,649 --> 00:11:22,610
said<font color="#E5E5E5"> okay</font><font color="#CCCCCC"> so we got this attack let's</font>

250
00:11:21,019 --> 00:11:24,259
try to replicate it<font color="#E5E5E5"> let's see if we</font><font color="#CCCCCC"> if</font>

251
00:11:22,610 --> 00:11:26,449
<font color="#CCCCCC">we can do</font><font color="#E5E5E5"> it again so we look at that</font>

252
00:11:24,259 --> 00:11:28,189
piece that<font color="#E5E5E5"> send the attack and</font><font color="#CCCCCC"> we try to</font>

253
00:11:26,449 --> 00:11:29,959
send packets<font color="#CCCCCC"> of their way and see if</font><font color="#E5E5E5"> we</font>

254
00:11:28,189 --> 00:11:32,059
<font color="#E5E5E5">get any response but we couldn't really</font>

255
00:11:29,959 --> 00:11:34,309
<font color="#E5E5E5">get anything back okay</font><font color="#CCCCCC"> you sent and you</font>

256
00:11:32,059 --> 00:11:36,350
<font color="#E5E5E5">sent all these different variations but</font>

257
00:11:34,309 --> 00:11:37,579
nothing happened<font color="#CCCCCC"> so I said</font><font color="#E5E5E5"> okay</font><font color="#CCCCCC"> let's do</font>

258
00:11:36,350 --> 00:11:40,399
the next<font color="#E5E5E5"> logical thing</font>

259
00:11:37,579 --> 00:11:43,910
<font color="#E5E5E5">let's shrine replicated in an internal</font>

260
00:11:40,399 --> 00:11:46,549
network<font color="#CCCCCC"> okay specifically the</font>

261
00:11:43,910 --> 00:11:48,199
simplification attack came from<font color="#CCCCCC"> devices</font>

262
00:11:46,549 --> 00:11:49,790
that usually you have<font color="#E5E5E5"> them in your</font>

263
00:11:48,199 --> 00:11:53,089
<font color="#E5E5E5">internal network so you said okay let's</font>

264
00:11:49,790 --> 00:11:55,549
try<font color="#E5E5E5"> to replicate it</font><font color="#CCCCCC"> but once again</font><font color="#E5E5E5"> we</font>

265
00:11:53,089 --> 00:11:57,319
<font color="#E5E5E5">didn't manage this case I think it's</font>

266
00:11:55,549 --> 00:11:59,269
because<font color="#CCCCCC"> they in my workplace</font><font color="#E5E5E5"> has like</font>

267
00:11:57,319 --> 00:12:00,319
this is crazy security rules so nothing

268
00:11:59,269 --> 00:12:02,989
really<font color="#CCCCCC"> works in</font><font color="#E5E5E5"> the internal network</font>

269
00:12:00,319 --> 00:12:04,429
unless<font color="#E5E5E5"> someone they predefined it so he</font>

270
00:12:02,989 --> 00:12:05,989
said<font color="#CCCCCC"> ok what what are we</font><font color="#E5E5E5"> gonna do what</font>

271
00:12:04,429 --> 00:12:08,480
<font color="#E5E5E5">kind of</font><font color="#CCCCCC"> network do we have in our area</font>

272
00:12:05,989 --> 00:12:10,489
that<font color="#CCCCCC"> isn't as secure so said</font><font color="#E5E5E5"> ok let's go</font>

273
00:12:08,480 --> 00:12:10,910
to the<font color="#E5E5E5"> local coffee house it's right</font>

274
00:12:10,489 --> 00:12:13,699
over there

275
00:12:10,910 --> 00:12:16,610
<font color="#E5E5E5">so</font><font color="#CCCCCC"> went downstairs to our</font><font color="#E5E5E5"> local area in</font>

276
00:12:13,699 --> 00:12:18,319
a coffee house and we connected to the

277
00:12:16,610 --> 00:12:20,119
Wi-Fi<font color="#CCCCCC"> image writing the same</font><font color="#E5E5E5"> thing</font><font color="#CCCCCC"> we</font>

278
00:12:18,319 --> 00:12:23,089
send some packets and we got a<font color="#E5E5E5"> response</font>

279
00:12:20,119 --> 00:12:27,259
<font color="#E5E5E5">and we didn't</font><font color="#CCCCCC"> expected what the response</font>

280
00:12:23,089 --> 00:12:28,579
came from a port<font color="#E5E5E5"> we didn't expect expect</font>

281
00:12:27,259 --> 00:12:32,240
it to<font color="#E5E5E5"> come from it came from a</font><font color="#CCCCCC"> non</font>

282
00:12:28,579 --> 00:12:34,069
<font color="#CCCCCC">trivial source port No</font>

283
00:12:32,240 --> 00:12:36,110
the amplification<font color="#CCCCCC"> vector I'm talking</font>

284
00:12:34,070 --> 00:12:38,120
about is called<font color="#E5E5E5"> a UPnP</font>

285
00:12:36,110 --> 00:12:41,300
and specifically the protocol is<font color="#CCCCCC"> called</font>

286
00:12:38,120 --> 00:12:44,890
this<font color="#E5E5E5"> is DB</font><font color="#CCCCCC"> I guess</font><font color="#E5E5E5"> some</font><font color="#CCCCCC"> of you most</font><font color="#E5E5E5"> of</font>

287
00:12:41,300 --> 00:12:44,890
you<font color="#E5E5E5"> heard about it</font><font color="#CCCCCC"> okay</font>

288
00:12:45,760 --> 00:12:50,450
<font color="#CCCCCC">SSDP</font><font color="#E5E5E5"> is short for simple service</font>

289
00:12:48,230 --> 00:12:52,279
discovery protocol and you<font color="#CCCCCC"> can pierce</font>

290
00:12:50,450 --> 00:12:54,290
<font color="#E5E5E5">your universal plug and</font><font color="#CCCCCC"> play</font><font color="#E5E5E5"> it's an</font>

291
00:12:52,279 --> 00:12:55,730
extension<font color="#E5E5E5"> of the existing</font><font color="#CCCCCC"> plug and play</font>

292
00:12:54,290 --> 00:12:58,339
you know what you use when<font color="#CCCCCC"> you plug your</font>

293
00:12:55,730 --> 00:13:00,050
<font color="#CCCCCC">a USB into a</font><font color="#E5E5E5"> computer</font><font color="#CCCCCC"> and then</font><font color="#E5E5E5"> you can</font>

294
00:12:58,339 --> 00:13:03,890
use your<font color="#CCCCCC"> mouse</font><font color="#E5E5E5"> this is kind of an</font>

295
00:13:00,050 --> 00:13:07,250
<font color="#E5E5E5">extension of</font><font color="#CCCCCC"> that day in service now</font>

296
00:13:03,890 --> 00:13:10,449
<font color="#E5E5E5">SSDP</font><font color="#CCCCCC"> is what</font><font color="#E5E5E5"> what's been used by</font><font color="#CCCCCC"> UPnP</font>

297
00:13:07,250 --> 00:13:16,850
devices to discover one another<font color="#CCCCCC"> okay and</font>

298
00:13:10,450 --> 00:13:18,800
<font color="#CCCCCC">works</font><font color="#E5E5E5"> over UDP 1900 and you can use it</font>

299
00:13:16,850 --> 00:13:21,170
to trigger<font color="#CCCCCC"> master response okay it's a</font>

300
00:13:18,800 --> 00:13:23,599
<font color="#CCCCCC">very popular</font><font color="#E5E5E5"> leaders technique what</font>

301
00:13:21,170 --> 00:13:25,610
happens if you<font color="#CCCCCC"> have a lot of IgG</font>

302
00:13:23,600 --> 00:13:27,709
<font color="#E5E5E5">Internet gateway devices that have you</font>

303
00:13:25,610 --> 00:13:30,230
<font color="#E5E5E5">pin P and instead of being opened</font>

304
00:13:27,709 --> 00:13:34,250
<font color="#E5E5E5">internally only</font><font color="#CCCCCC"> they're also opened</font>

305
00:13:30,230 --> 00:13:37,459
externally<font color="#E5E5E5"> so you can send a SSDP packet</font>

306
00:13:34,250 --> 00:13:39,560
to them<font color="#E5E5E5"> over for 1900 and will actually</font>

307
00:13:37,459 --> 00:13:41,869
reply<font color="#E5E5E5"> even though you're coming from the</font>

308
00:13:39,560 --> 00:13:43,339
<font color="#CCCCCC">external network</font><font color="#E5E5E5"> now this is</font><font color="#CCCCCC"> where as I</font>

309
00:13:41,870 --> 00:13:46,310
<font color="#E5E5E5">said this is a very popular</font><font color="#CCCCCC"> use</font>

310
00:13:43,339 --> 00:13:47,959
<font color="#E5E5E5">technique I think</font><font color="#CCCCCC"> last month we</font><font color="#E5E5E5"> did some</font>

311
00:13:46,310 --> 00:13:50,029
<font color="#E5E5E5">kind of an internal report and</font><font color="#CCCCCC"> I found</font>

312
00:13:47,959 --> 00:13:54,079
that this<font color="#E5E5E5"> was the most mostly used</font>

313
00:13:50,029 --> 00:13:55,850
vector<font color="#E5E5E5"> okay and in</font><font color="#CCCCCC"> general you PNP has</font>

314
00:13:54,080 --> 00:13:59,060
many security issues you can look<font color="#CCCCCC"> around</font>

315
00:13:55,850 --> 00:14:01,580
<font color="#CCCCCC">it and there's puns okay anyone can go</font>

316
00:13:59,060 --> 00:14:05,119
<font color="#CCCCCC">and find something available something</font>

317
00:14:01,580 --> 00:14:07,790
special and in this entire protocol<font color="#CCCCCC"> okay</font>

318
00:14:05,120 --> 00:14:10,130
there's tons of different<font color="#E5E5E5"> things there's</font>

319
00:14:07,790 --> 00:14:12,529
some even a remote code execution and

320
00:14:10,130 --> 00:14:15,130
they<font color="#CCCCCC"> and a bunch of</font><font color="#E5E5E5"> other phenomena</font><font color="#CCCCCC"> even</font>

321
00:14:12,529 --> 00:14:15,130
their abilities

322
00:14:15,480 --> 00:14:20,100
so let's explain very quickly<font color="#E5E5E5"> what</font><font color="#CCCCCC"> does</font>

323
00:14:18,480 --> 00:14:22,530
<font color="#CCCCCC">UPnP and this is the PN what is it</font>

324
00:14:20,100 --> 00:14:25,080
useful<font color="#CCCCCC"> okay so let's say you have a</font>

325
00:14:22,530 --> 00:14:27,780
computer<font color="#CCCCCC"> and</font><font color="#E5E5E5"> you got this amazing a</font>

326
00:14:25,080 --> 00:14:31,830
<font color="#E5E5E5">smart TV now you want to stream data</font>

327
00:14:27,780 --> 00:14:33,930
from your<font color="#E5E5E5"> computer</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> the TV</font><font color="#CCCCCC"> okay now</font>

328
00:14:31,830 --> 00:14:35,970
instead<font color="#E5E5E5"> of a</font><font color="#CCCCCC"> plugging</font><font color="#E5E5E5"> cable you want</font>

329
00:14:33,930 --> 00:14:37,859
something<font color="#E5E5E5"> that will work very</font><font color="#CCCCCC"> easy</font><font color="#E5E5E5"> so</font>

330
00:14:35,970 --> 00:14:41,430
this is what you can P and this is<font color="#E5E5E5"> P P</font>

331
00:14:37,860 --> 00:14:46,110
<font color="#CCCCCC">is for your</font><font color="#E5E5E5"> computer joins a multicast</font>

332
00:14:41,430 --> 00:14:49,680
IP<font color="#E5E5E5"> group on your router and the small</font><font color="#CCCCCC"> TV</font>

333
00:14:46,110 --> 00:14:52,500
does the same thing<font color="#E5E5E5"> okay now your</font>

334
00:14:49,680 --> 00:14:55,349
computer<font color="#CCCCCC"> can send a search packet to</font>

335
00:14:52,500 --> 00:14:57,300
this multicast IP group and the router

336
00:14:55,350 --> 00:15:00,690
will send it all over<font color="#CCCCCC"> to whoever is in</font>

337
00:14:57,300 --> 00:15:04,079
<font color="#CCCCCC">the group now the TV</font>

338
00:15:00,690 --> 00:15:06,390
<font color="#E5E5E5">it gets the search packet and returns to</font>

339
00:15:04,080 --> 00:15:08,910
<font color="#E5E5E5">the computer scheme okay you can</font><font color="#CCCCCC"> p</font>

340
00:15:06,390 --> 00:15:11,310
scheme now what this scheme does is that

341
00:15:08,910 --> 00:15:14,160
it allows<font color="#E5E5E5"> the laptop to understand how</font>

342
00:15:11,310 --> 00:15:17,280
<font color="#E5E5E5">to operate the small TV and how to send</font>

343
00:15:14,160 --> 00:15:19,050
different commands to it now the

344
00:15:17,280 --> 00:15:20,910
computer understands<font color="#E5E5E5"> read the scheme</font>

345
00:15:19,050 --> 00:15:23,339
understands it<font color="#E5E5E5"> and now it can stream</font>

346
00:15:20,910 --> 00:15:26,689
<font color="#CCCCCC">media to the small TV</font><font color="#E5E5E5"> and once again you</font>

347
00:15:23,340 --> 00:15:30,780
can<font color="#CCCCCC"> watch your favorite show</font><font color="#E5E5E5"> okay now</font>

348
00:15:26,690 --> 00:15:33,960
what happens if one day your TV breaks

349
00:15:30,780 --> 00:15:36,870
down and<font color="#E5E5E5"> you decide</font><font color="#CCCCCC"> to buy a new TV</font><font color="#E5E5E5"> okay</font>

350
00:15:33,960 --> 00:15:38,540
a much better<font color="#E5E5E5"> to me</font><font color="#CCCCCC"> I want it's way</font>

351
00:15:36,870 --> 00:15:44,130
better<font color="#CCCCCC"> than</font><font color="#E5E5E5"> the one you</font><font color="#CCCCCC"> already had</font>

352
00:15:38,540 --> 00:15:46,349
okay so what's amazing here<font color="#CCCCCC"> is because</font>

353
00:15:44,130 --> 00:15:48,900
they have if<font color="#E5E5E5"> they have the same upp</font>

354
00:15:46,350 --> 00:15:51,150
profile<font color="#E5E5E5"> to work in the same</font><font color="#CCCCCC"> way this</font>

355
00:15:48,900 --> 00:15:52,680
whole<font color="#CCCCCC"> process can happen again</font><font color="#E5E5E5"> and as</font>

356
00:15:51,150 --> 00:15:55,199
far as<font color="#E5E5E5"> you are concerned you plug in the</font>

357
00:15:52,680 --> 00:15:57,569
new TV<font color="#E5E5E5"> and you can start immediately</font>

358
00:15:55,200 --> 00:16:00,300
<font color="#E5E5E5">streaming media and once again watching</font>

359
00:15:57,570 --> 00:16:03,110
<font color="#E5E5E5">your favorite show</font><font color="#CCCCCC"> okay so the idea it's</font>

360
00:16:00,300 --> 00:16:06,420
<font color="#CCCCCC">very it's great I mean it's like a</font>

361
00:16:03,110 --> 00:16:08,430
<font color="#E5E5E5">plug-and-play you know with the mouse's</font>

362
00:16:06,420 --> 00:16:10,770
<font color="#E5E5E5">and keyboards</font><font color="#CCCCCC"> and whenever you</font><font color="#E5E5E5"> just plug</font>

363
00:16:08,430 --> 00:16:13,020
in<font color="#CCCCCC"> the</font><font color="#E5E5E5"> small</font><font color="#CCCCCC"> TV and everything works now</font>

364
00:16:10,770 --> 00:16:14,730
<font color="#E5E5E5">of course something had to be</font>

365
00:16:13,020 --> 00:16:16,740
compromised to<font color="#E5E5E5"> reach this kind of a</font>

366
00:16:14,730 --> 00:16:19,150
seamless connectivity and<font color="#CCCCCC"> that thing is</font>

367
00:16:16,740 --> 00:16:23,910
<font color="#E5E5E5">security obviously</font>

368
00:16:19,150 --> 00:16:28,569
so here's what we<font color="#E5E5E5"> filmed there's a way</font>

369
00:16:23,910 --> 00:16:30,400
<font color="#CCCCCC">to</font><font color="#E5E5E5"> use this you</font><font color="#CCCCCC"> PNP</font><font color="#E5E5E5"> and specifically you</font>

370
00:16:28,570 --> 00:16:33,820
can<font color="#E5E5E5"> be an</font><font color="#CCCCCC"> Internet gate with devices and</font>

371
00:16:30,400 --> 00:16:37,689
<font color="#CCCCCC">IG DS to proxy requests</font><font color="#E5E5E5"> throughout the</font>

372
00:16:33,820 --> 00:16:38,980
<font color="#CCCCCC">internet</font><font color="#E5E5E5"> okay now these ideas can be</font>

373
00:16:37,690 --> 00:16:42,240
<font color="#E5E5E5">remotely accessed</font>

374
00:16:38,980 --> 00:16:44,830
okay so accessed from external<font color="#CCCCCC"> network</font>

375
00:16:42,240 --> 00:16:46,630
they<font color="#E5E5E5"> can be found using</font><font color="#CCCCCC"> shut them</font><font color="#E5E5E5"> okay</font>

376
00:16:44,830 --> 00:16:51,130
<font color="#E5E5E5">you can use a very simple command to</font>

377
00:16:46,630 --> 00:16:54,790
<font color="#E5E5E5">access them via Chardon and this is the</font>

378
00:16:51,130 --> 00:16:57,370
interesting things<font color="#CCCCCC"> these</font><font color="#E5E5E5"> devices they</font>

379
00:16:54,790 --> 00:16:59,770
have<font color="#CCCCCC"> the ability to set</font><font color="#E5E5E5"> port forwarding</font>

380
00:16:57,370 --> 00:17:02,050
rules<font color="#CCCCCC"> and</font><font color="#E5E5E5"> that is part of their you can</font>

381
00:16:59,770 --> 00:17:03,910
be<font color="#CCCCCC"> scheme so it means you can just go to</font>

382
00:17:02,050 --> 00:17:05,619
this device<font color="#E5E5E5"> and change its port</font>

383
00:17:03,910 --> 00:17:09,670
forwarding rules as long<font color="#E5E5E5"> as you know how</font>

384
00:17:05,619 --> 00:17:11,800
to so what's what's the<font color="#E5E5E5"> idea being</font><font color="#CCCCCC"> on</font>

385
00:17:09,670 --> 00:17:14,170
<font color="#CCCCCC">this</font><font color="#E5E5E5"> and how can this used how can this</font>

386
00:17:11,800 --> 00:17:16,750
be used<font color="#E5E5E5"> for DDoS so let's</font><font color="#CCCCCC"> we have</font><font color="#E5E5E5"> this</font>

387
00:17:14,170 --> 00:17:18,640
attacker<font color="#CCCCCC"> and</font><font color="#E5E5E5"> you have this victim now</font>

388
00:17:16,750 --> 00:17:20,619
the attacker has been<font color="#E5E5E5"> abusing the</font><font color="#CCCCCC"> victim</font>

389
00:17:18,640 --> 00:17:22,240
for a while now<font color="#CCCCCC"> okay he used all these</font>

390
00:17:20,619 --> 00:17:23,739
<font color="#E5E5E5">different application vectors and he</font>

391
00:17:22,240 --> 00:17:26,829
kept on attacking him for<font color="#E5E5E5"> a very long</font>

392
00:17:23,740 --> 00:17:29,260
time<font color="#E5E5E5"> at some point the the</font><font color="#CCCCCC"> victim was</font>

393
00:17:26,829 --> 00:17:31,570
<font color="#CCCCCC">very tired so he called as I spin he</font>

394
00:17:29,260 --> 00:17:33,490
said well please block all these

395
00:17:31,570 --> 00:17:35,559
different ports<font color="#E5E5E5"> okay block traffic from</font>

396
00:17:33,490 --> 00:17:38,410
port 53 from<font color="#CCCCCC"> one</font><font color="#E5E5E5"> two three four nine one</font>

397
00:17:35,559 --> 00:17:39,790
<font color="#E5E5E5">one from a memcache versus one one two</font>

398
00:17:38,410 --> 00:17:42,010
<font color="#CCCCCC">and one and all these different ports</font>

399
00:17:39,790 --> 00:17:43,960
and you<font color="#E5E5E5"> give them give is I speed this</font>

400
00:17:42,010 --> 00:17:45,940
huge list of ports<font color="#CCCCCC"> told them block</font>

401
00:17:43,960 --> 00:17:47,890
everything<font color="#CCCCCC"> and not</font><font color="#E5E5E5"> only that</font><font color="#CCCCCC"> he said</font>

402
00:17:45,940 --> 00:17:49,330
<font color="#CCCCCC">okay I'm gonna find out all these</font>

403
00:17:47,890 --> 00:17:51,220
<font color="#CCCCCC">different IPS of all these</font><font color="#E5E5E5"> different</font>

404
00:17:49,330 --> 00:17:53,320
<font color="#CCCCCC">services I'm gonna ask</font><font color="#E5E5E5"> my I speak to</font>

405
00:17:51,220 --> 00:17:55,090
block all<font color="#CCCCCC"> of them as</font><font color="#E5E5E5"> well so</font><font color="#CCCCCC"> give the</font>

406
00:17:53,320 --> 00:17:57,550
<font color="#E5E5E5">high speed this huge list of ports and</font>

407
00:17:55,090 --> 00:17:59,080
<font color="#E5E5E5">90s and of the highest speed blocks</font>

408
00:17:57,550 --> 00:18:01,870
almost everything for him but he knows

409
00:17:59,080 --> 00:18:03,610
he's protected<font color="#CCCCCC"> okay so now the attacker</font>

410
00:18:01,870 --> 00:18:05,169
understands that and tried to try the

411
00:18:03,610 --> 00:18:06,909
<font color="#E5E5E5">attack in the victim but he just</font>

412
00:18:05,170 --> 00:18:09,640
couldn't because once again<font color="#CCCCCC"> the</font><font color="#E5E5E5"> SP</font>

413
00:18:06,910 --> 00:18:10,720
blocked everything so he found this<font color="#CCCCCC"> UPnP</font>

414
00:18:09,640 --> 00:18:12,780
device on the net

415
00:18:10,720 --> 00:18:15,299
now you've been to devices<font color="#CCCCCC"> especially</font>

416
00:18:12,780 --> 00:18:19,139
<font color="#E5E5E5">this type</font>

417
00:18:15,299 --> 00:18:21,029
household appliances<font color="#E5E5E5"> okay science is</font>

418
00:18:19,139 --> 00:18:24,479
used by private<font color="#E5E5E5"> people</font><font color="#CCCCCC"> in the home house</font>

419
00:18:21,029 --> 00:18:26,999
<font color="#E5E5E5">many cases once the device resets it</font>

420
00:18:24,480 --> 00:18:29,820
gets on<font color="#CCCCCC"> european</font><font color="#E5E5E5"> it gets a new</font><font color="#CCCCCC"> IP it</font>

421
00:18:26,999 --> 00:18:32,730
isn't in<font color="#E5E5E5"> nothing</font><font color="#CCCCCC"> they're stable nothing</font>

422
00:18:29,820 --> 00:18:35,220
stays the<font color="#CCCCCC"> same okay so you find this he</font>

423
00:18:32,730 --> 00:18:38,369
found this device<font color="#E5E5E5"> on the internet using</font>

424
00:18:35,220 --> 00:18:42,239
<font color="#CCCCCC">shut on and he knows a bunch</font><font color="#E5E5E5"> of the dns</font>

425
00:18:38,369 --> 00:18:46,350
<font color="#CCCCCC">service</font><font color="#E5E5E5"> now as</font><font color="#CCCCCC"> i said</font><font color="#E5E5E5"> the victim</font><font color="#CCCCCC"> the</font>

426
00:18:42,239 --> 00:18:48,869
<font color="#E5E5E5">sorry the attacker can sit both holding</font>

427
00:18:46,350 --> 00:18:52,678
rule on the<font color="#CCCCCC"> UPnP device what the port</font>

428
00:18:48,869 --> 00:18:54,600
folding rule says you<font color="#E5E5E5"> can read it but</font>

429
00:18:52,679 --> 00:18:57,450
<font color="#E5E5E5">the port folding rule says is the found</font>

430
00:18:54,600 --> 00:19:01,918
following<font color="#E5E5E5"> whatever requests you get to</font>

431
00:18:57,450 --> 00:19:06,330
port 1 3 3 7<font color="#E5E5E5"> forwarded to this</font><font color="#CCCCCC"> dns</font>

432
00:19:01,919 --> 00:19:09,450
server<font color="#E5E5E5"> over port 53</font><font color="#CCCCCC"> ok</font><font color="#E5E5E5"> this is the port</font>

433
00:19:06,330 --> 00:19:12,539
folding rule<font color="#CCCCCC"> he's</font><font color="#E5E5E5"> set in now what</font>

434
00:19:09,450 --> 00:19:17,549
<font color="#E5E5E5">happens is that you can now set send a</font>

435
00:19:12,539 --> 00:19:20,700
DNS query to the<font color="#CCCCCC"> UPnP device to port 1 3</font>

436
00:19:17,549 --> 00:19:24,239
3 7<font color="#E5E5E5"> the</font><font color="#CCCCCC"> UPP device will forward that</font>

437
00:19:20,700 --> 00:19:27,139
<font color="#CCCCCC">request to the</font><font color="#E5E5E5"> DNS server the</font><font color="#CCCCCC"> dns server</font>

438
00:19:24,239 --> 00:19:30,600
<font color="#E5E5E5">will respond to the</font><font color="#CCCCCC"> Olimpia device and</font>

439
00:19:27,139 --> 00:19:34,199
because the attacker sent a request<font color="#E5E5E5"> with</font>

440
00:19:30,600 --> 00:19:38,699
a spoofed IP the UPP device will respond

441
00:19:34,200 --> 00:19:42,419
to<font color="#E5E5E5"> the victim now the victim sees an</font>

442
00:19:38,700 --> 00:19:45,509
attack coming from<font color="#CCCCCC"> a port sauce sauce</font>

443
00:19:42,419 --> 00:19:47,639
port 1 3 3<font color="#CCCCCC"> 7 and from</font><font color="#E5E5E5"> an IP doesn't know</font>

444
00:19:45,509 --> 00:19:49,109
so he cannot be protected<font color="#CCCCCC"> because he</font>

445
00:19:47,639 --> 00:19:50,488
doesn't<font color="#E5E5E5"> know not it doesn't know the</font>

446
00:19:49,109 --> 00:19:52,710
source port<font color="#E5E5E5"> and it doesn't know the IP</font>

447
00:19:50,489 --> 00:19:54,720
so this way the attacker is able<font color="#E5E5E5"> to</font>

448
00:19:52,710 --> 00:19:58,650
overcome<font color="#CCCCCC"> all the obstacles</font><font color="#E5E5E5"> that the</font>

449
00:19:54,720 --> 00:20:01,130
victim set in place now

450
00:19:58,650 --> 00:20:01,130
in

451
00:20:03,720 --> 00:20:16,200
so is<font color="#E5E5E5"> this</font><font color="#CCCCCC"> fair</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> is this</font><font color="#E5E5E5"> is make</font>

452
00:20:05,730 --> 00:20:18,630
sense<font color="#E5E5E5"> okay great now now the thing</font><font color="#CCCCCC"> is it</font>

453
00:20:16,200 --> 00:20:20,370
<font color="#CCCCCC">doesn't</font><font color="#E5E5E5"> have to be</font><font color="#CCCCCC"> like that okay you</font>

454
00:20:18,630 --> 00:20:21,660
can even<font color="#E5E5E5"> play with that a little bit</font>

455
00:20:20,370 --> 00:20:24,120
<font color="#E5E5E5">more and do some other some other</font>

456
00:20:21,660 --> 00:20:26,700
<font color="#CCCCCC">modifications</font><font color="#E5E5E5"> instead of using one DNS</font>

457
00:20:24,120 --> 00:20:28,379
server<font color="#E5E5E5"> okay you can use instead of using</font>

458
00:20:26,700 --> 00:20:30,900
<font color="#CCCCCC">one you can be device you can use a</font>

459
00:20:28,380 --> 00:20:32,580
bunch<font color="#CCCCCC"> of UPnP devices that you</font><font color="#E5E5E5"> can set</font>

460
00:20:30,900 --> 00:20:34,200
port forwarding rules and all of them<font color="#E5E5E5"> to</font>

461
00:20:32,580 --> 00:20:36,990
<font color="#E5E5E5">the same DNS server</font>

462
00:20:34,200 --> 00:20:40,260
now what this accomplishes is that now

463
00:20:36,990 --> 00:20:42,860
<font color="#E5E5E5">the victim sees a bunch of different IPS</font>

464
00:20:40,260 --> 00:20:46,170
attacking him<font color="#E5E5E5"> and a bunch of different a</font>

465
00:20:42,860 --> 00:20:48,209
port sources okay<font color="#E5E5E5"> because</font><font color="#CCCCCC"> in each upp</font>

466
00:20:46,170 --> 00:20:49,950
device you can you can set a<font color="#CCCCCC"> different</font>

467
00:20:48,210 --> 00:20:52,860
source port<font color="#E5E5E5"> you don't have to stick to</font>

468
00:20:49,950 --> 00:20:54,420
<font color="#CCCCCC">the same one</font><font color="#E5E5E5"> now this way it becomes</font>

469
00:20:52,860 --> 00:20:56,969
<font color="#CCCCCC">even more complicated to mitigate</font>

470
00:20:54,420 --> 00:21:00,090
because you cannot see a<font color="#E5E5E5"> single IP that</font>

471
00:20:56,970 --> 00:21:01,920
<font color="#E5E5E5">is fine firing more than each other</font><font color="#CCCCCC"> you</font>

472
00:21:00,090 --> 00:21:03,929
cannot see a single<font color="#CCCCCC"> source for that</font><font color="#E5E5E5"> even</font>

473
00:21:01,920 --> 00:21:05,340
repeats itself<font color="#E5E5E5"> and the packets are</font>

474
00:21:03,930 --> 00:21:07,890
coming<font color="#E5E5E5"> from all this duplication</font><font color="#CCCCCC"> it</font>

475
00:21:05,340 --> 00:21:09,449
becomes very difficult<font color="#E5E5E5"> to mitigate now</font>

476
00:21:07,890 --> 00:21:11,400
it's not<font color="#CCCCCC"> only that you can</font><font color="#E5E5E5"> of course add</font>

477
00:21:09,450 --> 00:21:14,370
another server to make<font color="#E5E5E5"> that notification</font>

478
00:21:11,400 --> 00:21:16,170
even stronger then you can use<font color="#E5E5E5"> even</font><font color="#CCCCCC"> a</font>

479
00:21:14,370 --> 00:21:19,790
different<font color="#E5E5E5"> server so this becomes even</font>

480
00:21:16,170 --> 00:21:19,790
<font color="#CCCCCC">more difficult to mitigate</font>

481
00:21:19,940 --> 00:21:25,820
<font color="#E5E5E5">okay now after</font><font color="#CCCCCC"> we did all that research</font>

482
00:21:23,810 --> 00:21:28,730
<font color="#E5E5E5">and found all these different</font><font color="#CCCCCC"> things in</font>

483
00:21:25,820 --> 00:21:30,439
the European PA<font color="#E5E5E5"> decide you think the</font>

484
00:21:28,730 --> 00:21:32,360
libraries<font color="#E5E5E5"> that we found</font><font color="#CCCCCC"> all these</font>

485
00:21:30,440 --> 00:21:35,000
different options<font color="#E5E5E5"> to</font><font color="#CCCCCC"> play</font><font color="#E5E5E5"> with</font><font color="#CCCCCC"> UPP</font>

486
00:21:32,360 --> 00:21:36,830
devices and to achieve this<font color="#E5E5E5"> we found out</font>

487
00:21:35,000 --> 00:21:39,740
what actually<font color="#E5E5E5"> happened</font><font color="#CCCCCC"> and why did we</font>

488
00:21:36,830 --> 00:21:41,720
see this attack<font color="#E5E5E5"> coming from different</font>

489
00:21:39,740 --> 00:21:44,840
<font color="#E5E5E5">source for this is the</font><font color="#CCCCCC"> P attack coming</font>

490
00:21:41,720 --> 00:21:48,140
<font color="#E5E5E5">from port 1900 and also other source</font>

491
00:21:44,840 --> 00:21:50,120
ports as well<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> apparently</font><font color="#CCCCCC"> it seems</font>

492
00:21:48,140 --> 00:21:52,220
to be<font color="#E5E5E5"> an</font><font color="#CCCCCC"> out-of-the-box behavior</font><font color="#E5E5E5"> and you</font>

493
00:21:50,120 --> 00:21:54,229
can<font color="#E5E5E5"> pin some you can</font><font color="#CCCCCC"> P libraries</font><font color="#E5E5E5"> okay</font>

494
00:21:52,220 --> 00:21:56,630
what happens is<font color="#E5E5E5"> that some of them</font>

495
00:21:54,230 --> 00:21:59,150
instead<font color="#CCCCCC"> of</font><font color="#E5E5E5"> using the same connection to</font>

496
00:21:56,630 --> 00:22:01,670
reply<font color="#E5E5E5"> they open a new connection they</font>

497
00:21:59,150 --> 00:22:04,610
use a new handler<font color="#E5E5E5"> to reply so they get</font>

498
00:22:01,670 --> 00:22:06,200
the request and they get<font color="#CCCCCC"> a</font><font color="#E5E5E5"> request they</font>

499
00:22:04,610 --> 00:22:08,209
process it<font color="#E5E5E5"> and then they open a new</font>

500
00:22:06,200 --> 00:22:10,130
<font color="#E5E5E5">connection in order to respond when they</font>

501
00:22:08,210 --> 00:22:12,920
open the new<font color="#CCCCCC"> current connection we just</font>

502
00:22:10,130 --> 00:22:15,050
get some random<font color="#E5E5E5"> ephemeral port and they</font>

503
00:22:12,920 --> 00:22:17,360
use<font color="#CCCCCC"> it to respond so that's why we've</font>

504
00:22:15,050 --> 00:22:19,490
seen the behavior we see when this I

505
00:22:17,360 --> 00:22:20,929
mean this<font color="#E5E5E5"> is important but it doesn't</font>

506
00:22:19,490 --> 00:22:26,810
<font color="#CCCCCC">matter because what we saw</font>

507
00:22:20,930 --> 00:22:29,470
it can actually be achieved<font color="#E5E5E5"> so now let's</font>

508
00:22:26,810 --> 00:22:29,470
try<font color="#E5E5E5"> any we</font><font color="#CCCCCC"> can</font>

509
00:22:31,990 --> 00:22:40,340
okay so<font color="#CCCCCC"> European</font><font color="#E5E5E5"> P devices can</font><font color="#CCCCCC"> be used</font>

510
00:22:37,180 --> 00:22:45,340
<font color="#E5E5E5">IDs the tab</font><font color="#CCCCCC"> open B can be used for SSDP</font>

511
00:22:40,340 --> 00:22:49,490
attacks the<font color="#E5E5E5"> SS</font><font color="#CCCCCC"> the PA attacks</font><font color="#E5E5E5"> okay</font>

512
00:22:45,340 --> 00:22:51,470
come<font color="#E5E5E5"> from pot 1900 okay and in some</font>

513
00:22:49,490 --> 00:22:53,180
cases they come<font color="#CCCCCC"> out</font><font color="#E5E5E5"> so from some other</font>

514
00:22:51,470 --> 00:22:55,520
ports as<font color="#CCCCCC"> well this is an out-of-the-box</font>

515
00:22:53,180 --> 00:22:58,100
behavior<font color="#E5E5E5"> what we what we found is that</font>

516
00:22:55,520 --> 00:23:00,530
<font color="#CCCCCC">you're able</font><font color="#E5E5E5"> to set both folding rules in</font>

517
00:22:58,100 --> 00:23:02,600
such a way that intentionally

518
00:23:00,530 --> 00:23:05,720
intentionally the<font color="#CCCCCC"> response will come</font>

519
00:23:02,600 --> 00:23:08,030
from a<font color="#E5E5E5"> sore spot that's different than</font>

520
00:23:05,720 --> 00:23:09,860
<font color="#CCCCCC">19-hundred</font><font color="#E5E5E5"> and not only that you can get</font>

521
00:23:08,030 --> 00:23:12,010
a response<font color="#E5E5E5"> not from not only for</font><font color="#CCCCCC"> misses</font>

522
00:23:09,860 --> 00:23:15,590
the people<font color="#E5E5E5"> from whatever amplification a</font>

523
00:23:12,010 --> 00:23:18,860
server you want<font color="#E5E5E5"> to use so now this is</font><font color="#CCCCCC"> a</font>

524
00:23:15,590 --> 00:23:21,350
short<font color="#E5E5E5"> technical overview about</font><font color="#CCCCCC"> upp cases</font>

525
00:23:18,860 --> 00:23:23,840
<font color="#E5E5E5">something wasn't clear before that so</font>

526
00:23:21,350 --> 00:23:26,780
you can<font color="#CCCCCC"> B stands</font><font color="#E5E5E5"> for universal plug and</font>

527
00:23:23,840 --> 00:23:28,070
<font color="#E5E5E5">play the idea is to allow seamless</font>

528
00:23:26,780 --> 00:23:30,379
discovery in communication between

529
00:23:28,070 --> 00:23:32,540
different<font color="#E5E5E5"> devices</font><font color="#CCCCCC"> as I said you</font><font color="#E5E5E5"> have a</font>

530
00:23:30,380 --> 00:23:35,000
small TV<font color="#E5E5E5"> you wanted to talk to your</font>

531
00:23:32,540 --> 00:23:36,860
<font color="#E5E5E5">computer so this is an easy way for that</font>

532
00:23:35,000 --> 00:23:38,920
to<font color="#E5E5E5"> happen you</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> plug</font><font color="#CCCCCC"> in and plug them</font>

533
00:23:36,860 --> 00:23:41,870
<font color="#E5E5E5">in and they work okay</font>

534
00:23:38,920 --> 00:23:44,930
it uses<font color="#E5E5E5"> multicast for discovery which</font><font color="#CCCCCC"> is</font>

535
00:23:41,870 --> 00:23:46,879
again<font color="#E5E5E5"> for the sake of a seamlessness you</font>

536
00:23:44,930 --> 00:23:48,320
don't have to know another<font color="#CCCCCC"> devices IP</font>

537
00:23:46,880 --> 00:23:50,360
you just have to sign<font color="#CCCCCC"> in to the</font>

538
00:23:48,320 --> 00:23:53,600
multicast a a group and that's enough

539
00:23:50,360 --> 00:23:56,540
that's enough<font color="#E5E5E5"> okay and the last thing</font>

540
00:23:53,600 --> 00:23:58,760
the way one device knows what that

541
00:23:56,540 --> 00:24:01,190
<font color="#E5E5E5">device</font><font color="#CCCCCC"> can do is by an XML that</font>

542
00:23:58,760 --> 00:24:02,780
describes all the<font color="#CCCCCC"> available actions</font><font color="#E5E5E5"> so</font>

543
00:24:01,190 --> 00:24:05,600
in this case you can see this XML over

544
00:24:02,780 --> 00:24:08,300
here<font color="#E5E5E5"> you can have a you can add port</font>

545
00:24:05,600 --> 00:24:10,939
mapping<font color="#E5E5E5"> you can really put mapping you</font>

546
00:24:08,300 --> 00:24:12,470
<font color="#E5E5E5">can get external IP address and all</font>

547
00:24:10,940 --> 00:24:14,630
these different actions now this is

548
00:24:12,470 --> 00:24:17,330
clear<font color="#CCCCCC"> okay you can just</font><font color="#E5E5E5"> look at the XML</font>

549
00:24:14,630 --> 00:24:21,539
and<font color="#E5E5E5"> see all these different available</font>

550
00:24:17,330 --> 00:24:24,629
actions<font color="#E5E5E5"> so what is</font><font color="#CCCCCC"> SS leapin</font>

551
00:24:21,539 --> 00:24:27,229
<font color="#CCCCCC">a simple service discovery protocol</font><font color="#E5E5E5"> it</font>

552
00:24:24,629 --> 00:24:33,600
works with HTTP over UDP it's kind of<font color="#E5E5E5"> a</font>

553
00:24:27,229 --> 00:24:35,729
strange<font color="#E5E5E5"> beast and this is how an HTTP</font>

554
00:24:33,600 --> 00:24:39,059
you packet looks like as<font color="#CCCCCC"> you</font><font color="#E5E5E5"> can see it</font>

555
00:24:35,729 --> 00:24:42,330
<font color="#E5E5E5">looks very similar</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> where it looks</font>

556
00:24:39,059 --> 00:24:46,440
very similar to<font color="#CCCCCC"> http but this is</font>

557
00:24:42,330 --> 00:24:49,918
actually<font color="#E5E5E5"> over UDP it operates over port</font>

558
00:24:46,440 --> 00:24:53,460
1900 and subscription<font color="#E5E5E5"> and discovery via</font>

559
00:24:49,919 --> 00:24:55,859
multicast IP as I previously said now

560
00:24:53,460 --> 00:24:57,419
this<font color="#E5E5E5"> is intended</font><font color="#CCCCCC"> for intended for</font>

561
00:24:55,859 --> 00:24:59,070
<font color="#E5E5E5">internal networks only want your</font><font color="#CCCCCC"> smart</font>

562
00:24:57,419 --> 00:25:03,149
<font color="#CCCCCC">TV</font><font color="#E5E5E5"> to talk to your computer not your</font>

563
00:24:59,070 --> 00:25:04,918
<font color="#E5E5E5">neighbor's computer</font><font color="#CCCCCC"> ok</font><font color="#E5E5E5"> and even though</font>

564
00:25:03,149 --> 00:25:06,658
it's intended<font color="#E5E5E5"> for internal networks</font><font color="#CCCCCC"> only</font>

565
00:25:04,919 --> 00:25:08,729
it tends to<font color="#E5E5E5"> be open to</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> world</font><font color="#CCCCCC"> menu</font>

566
00:25:06,659 --> 00:25:10,979
can<font color="#CCCCCC"> be devices are open to open</font>

567
00:25:08,729 --> 00:25:15,869
externally<font color="#E5E5E5"> and it can actually access</font>

568
00:25:10,979 --> 00:25:18,570
them from<font color="#CCCCCC"> the external network</font><font color="#E5E5E5"> SSDP has</font>

569
00:25:15,869 --> 00:25:24,629
an amplification factor a factor of<font color="#E5E5E5"> 30</font>

570
00:25:18,570 --> 00:25:27,210
and this is how a search<font color="#E5E5E5"> request</font><font color="#CCCCCC"> look</font>

571
00:25:24,629 --> 00:25:28,918
looks like<font color="#E5E5E5"> so when you</font><font color="#CCCCCC"> have one device</font>

572
00:25:27,210 --> 00:25:32,190
<font color="#E5E5E5">that wants to discover</font><font color="#CCCCCC"> another device it</font>

573
00:25:28,919 --> 00:25:34,200
sends this search request<font color="#E5E5E5"> and this is</font>

574
00:25:32,190 --> 00:25:37,320
the<font color="#E5E5E5"> response that it gets the response</font>

575
00:25:34,200 --> 00:25:39,450
has all<font color="#E5E5E5"> these</font><font color="#CCCCCC"> different details about</font>

576
00:25:37,320 --> 00:25:41,908
the device<font color="#E5E5E5"> as you</font><font color="#CCCCCC"> can see there's a lot</font>

577
00:25:39,450 --> 00:25:43,799
of<font color="#CCCCCC"> details don't don't really</font><font color="#E5E5E5"> want to</font>

578
00:25:41,909 --> 00:25:46,169
<font color="#E5E5E5">any matter what's important that you</font>

579
00:25:43,799 --> 00:25:49,619
have<font color="#E5E5E5"> this location</font><font color="#CCCCCC"> ok the location says</font>

580
00:25:46,169 --> 00:25:52,200
where the<font color="#CCCCCC"> XML sets now as the previously</font>

581
00:25:49,619 --> 00:25:54,238
said this XML describes what you can do

582
00:25:52,200 --> 00:25:56,399
with the<font color="#E5E5E5"> device</font><font color="#CCCCCC"> it describes all these</font>

583
00:25:54,239 --> 00:26:00,330
different options<font color="#CCCCCC"> that</font><font color="#E5E5E5"> are</font><font color="#CCCCCC"> available</font><font color="#E5E5E5"> and</font>

584
00:25:56,399 --> 00:26:03,299
it's a<font color="#E5E5E5"> it's location is right over</font><font color="#CCCCCC"> here</font>

585
00:26:00,330 --> 00:26:05,489
<font color="#E5E5E5">now as you can</font><font color="#CCCCCC"> see this is an internal</font>

586
00:26:03,299 --> 00:26:08,549
IP<font color="#E5E5E5"> ok hundred twenty seven this is an</font>

587
00:26:05,489 --> 00:26:12,059
internal IP now

588
00:26:08,549 --> 00:26:13,918
in this case we have a<font color="#CCCCCC"> 30 amplification</font>

589
00:26:12,059 --> 00:26:16,950
factor so you send this request and<font color="#E5E5E5"> you</font>

590
00:26:13,919 --> 00:26:21,179
get back<font color="#CCCCCC"> I</font><font color="#E5E5E5"> response that that's 30 times</font>

591
00:26:16,950 --> 00:26:22,799
larger then the<font color="#E5E5E5"> request now and</font><font color="#CCCCCC"> then I</font>

592
00:26:21,179 --> 00:26:25,979
<font color="#E5E5E5">talk about controlling the</font><font color="#CCCCCC"> device but</font>

593
00:26:22,799 --> 00:26:27,658
the thing okay<font color="#CCCCCC"> I'm gonna do this and</font>

594
00:26:25,979 --> 00:26:31,349
then<font color="#CCCCCC"> we're gonna go and</font><font color="#E5E5E5"> show it in a</font>

595
00:26:27,659 --> 00:26:34,409
<font color="#E5E5E5">kind of a live a</font><font color="#CCCCCC"> way</font><font color="#E5E5E5"> so you send the</font>

596
00:26:31,349 --> 00:26:38,330
<font color="#CCCCCC">search packet to the site</font><font color="#E5E5E5"> that it's</font>

597
00:26:34,409 --> 00:26:42,049
called<font color="#CCCCCC"> upp</font><font color="#E5E5E5"> dot B or C over port 1900</font>

598
00:26:38,330 --> 00:26:44,668
<font color="#E5E5E5">okay and you get back this response now</font>

599
00:26:42,049 --> 00:26:47,039
as you can obviously<font color="#E5E5E5"> see this is an</font>

600
00:26:44,669 --> 00:26:50,609
internal IP<font color="#CCCCCC"> okay so how can</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> access</font>

601
00:26:47,039 --> 00:26:52,440
an internal IP from<font color="#E5E5E5"> an external okay how</font>

602
00:26:50,609 --> 00:26:54,809
can<font color="#CCCCCC"> you do that so there's something</font>

603
00:26:52,440 --> 00:26:57,479
<font color="#E5E5E5">very</font><font color="#CCCCCC"> interesting that they can't</font><font color="#E5E5E5"> explain</font>

604
00:26:54,809 --> 00:26:59,609
but for some reason the for this<font color="#E5E5E5"> isn't</font>

605
00:26:57,479 --> 00:27:01,409
open<font color="#E5E5E5"> only</font><font color="#CCCCCC"> in the</font><font color="#E5E5E5"> external only in the</font>

606
00:26:59,609 --> 00:27:03,749
<font color="#E5E5E5">internal</font><font color="#CCCCCC"> only on the internal network</font>

607
00:27:01,409 --> 00:27:06,839
<font color="#E5E5E5">but also</font><font color="#CCCCCC"> on</font><font color="#E5E5E5"> the external</font><font color="#CCCCCC"> network so what</font>

608
00:27:03,749 --> 00:27:09,419
you can<font color="#CCCCCC"> actually do is you can take</font><font color="#E5E5E5"> the</font>

609
00:27:06,839 --> 00:27:13,259
port and the XML location<font color="#E5E5E5"> you can take</font>

610
00:27:09,419 --> 00:27:15,509
the URL<font color="#E5E5E5"> and you</font><font color="#CCCCCC"> can</font><font color="#E5E5E5"> take the site IP and</font>

611
00:27:13,259 --> 00:27:18,619
<font color="#CCCCCC">squish them together and for some</font>

612
00:27:15,509 --> 00:27:22,229
unknown<font color="#E5E5E5"> reason this actually works</font><font color="#CCCCCC"> okay</font>

613
00:27:18,619 --> 00:27:28,259
so let's try and show<font color="#CCCCCC"> that in a specific</font>

614
00:27:22,229 --> 00:27:30,860
way<font color="#CCCCCC"> treating this is some a</font><font color="#E5E5E5"> darker with</font>

615
00:27:28,259 --> 00:27:34,850
<font color="#CCCCCC">UPnP on it</font>

616
00:27:30,860 --> 00:27:41,260
I'm gonna<font color="#E5E5E5"> turn on</font><font color="#CCCCCC"> the you can be okay</font>

617
00:27:34,850 --> 00:27:45,290
<font color="#E5E5E5">and I'll be</font><font color="#CCCCCC"> open peace running okay now</font>

618
00:27:41,260 --> 00:27:48,650
this<font color="#E5E5E5"> is the site and you can actually</font>

619
00:27:45,290 --> 00:27:50,480
access the<font color="#E5E5E5"> XML okay this is what the XML</font>

620
00:27:48,650 --> 00:27:52,610
looks like<font color="#E5E5E5"> you can see all these</font>

621
00:27:50,480 --> 00:27:53,690
<font color="#E5E5E5">different details</font><font color="#CCCCCC"> this is a UPnP device</font>

622
00:27:52,610 --> 00:27:56,990
<font color="#E5E5E5">okay you can see all these</font><font color="#CCCCCC"> different</font>

623
00:27:53,690 --> 00:27:59,809
details about the device<font color="#E5E5E5"> and what's</font>

624
00:27:56,990 --> 00:28:02,600
interesting is<font color="#CCCCCC"> that over</font><font color="#E5E5E5"> here</font><font color="#CCCCCC"> you have</font>

625
00:27:59,809 --> 00:28:05,059
<font color="#CCCCCC">this specific</font><font color="#E5E5E5"> URL</font><font color="#CCCCCC"> which you can use to</font>

626
00:28:02,600 --> 00:28:08,199
<font color="#E5E5E5">see all the different actions</font><font color="#CCCCCC"> that are</font>

627
00:28:05,059 --> 00:28:08,200
<font color="#CCCCCC">available in the device</font>

628
00:28:10,330 --> 00:28:19,010
so and so you<font color="#E5E5E5"> can have a set connection</font>

629
00:28:15,410 --> 00:28:21,380
<font color="#E5E5E5">get connection a type info and all these</font>

630
00:28:19,010 --> 00:28:23,360
different actions<font color="#CCCCCC"> that are available</font><font color="#E5E5E5"> now</font>

631
00:28:21,380 --> 00:28:25,040
this is<font color="#E5E5E5"> a human readable form</font><font color="#CCCCCC"> ok don't</font>

632
00:28:23,360 --> 00:28:26,659
even have to understand anything<font color="#CCCCCC"> you can</font>

633
00:28:25,040 --> 00:28:29,540
just<font color="#E5E5E5"> go into the XML you can read all</font>

634
00:28:26,660 --> 00:28:33,710
these different things<font color="#CCCCCC"> and then maybe</font>

635
00:28:29,540 --> 00:28:36,889
find some other use<font color="#CCCCCC"> for all</font><font color="#E5E5E5"> of them</font><font color="#CCCCCC"> okay</font>

636
00:28:33,710 --> 00:28:38,960
<font color="#CCCCCC">now of</font><font color="#E5E5E5"> course what I'm showing you</font><font color="#CCCCCC"> is</font>

637
00:28:36,890 --> 00:28:40,340
something<font color="#E5E5E5"> is some kind</font><font color="#CCCCCC"> of a darker it</font>

638
00:28:38,960 --> 00:28:42,440
says something private<font color="#CCCCCC"> that you can't</font>

639
00:28:40,340 --> 00:28:44,600
really<font color="#E5E5E5"> access my truth is you can</font>

640
00:28:42,440 --> 00:28:47,240
actually find these devices<font color="#E5E5E5"> yourself</font>

641
00:28:44,600 --> 00:28:51,290
using show them<font color="#CCCCCC"> ok</font><font color="#E5E5E5"> can just search for</font>

642
00:28:47,240 --> 00:28:54,950
<font color="#CCCCCC">one of</font><font color="#E5E5E5"> these a suffix</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> in this case</font>

643
00:28:51,290 --> 00:28:56,990
<font color="#CCCCCC">get this dot XML but any other thing you</font>

644
00:28:54,950 --> 00:28:59,809
<font color="#E5E5E5">want to</font><font color="#CCCCCC"> know and</font><font color="#E5E5E5"> then you can actually</font>

645
00:28:56,990 --> 00:29:01,010
see there's a bunch<font color="#E5E5E5"> of results and you</font>

646
00:28:59,809 --> 00:29:03,590
can see<font color="#CCCCCC"> all these different devices</font>

647
00:29:01,010 --> 00:29:06,020
<font color="#E5E5E5">located all over the world</font><font color="#CCCCCC"> you can try</font>

648
00:29:03,590 --> 00:29:10,939
to access them of<font color="#E5E5E5"> course you shouldn't</font>

649
00:29:06,020 --> 00:29:12,050
<font color="#E5E5E5">but you can try and then</font><font color="#CCCCCC"> you can look</font>

650
00:29:10,940 --> 00:29:14,030
there<font color="#E5E5E5"> and you can see if you can do all</font>

651
00:29:12,050 --> 00:29:16,790
<font color="#E5E5E5">these different actions with them this</font>

652
00:29:14,030 --> 00:29:18,559
<font color="#CCCCCC">is</font><font color="#E5E5E5"> completely a public as far as</font><font color="#CCCCCC"> a</font>

653
00:29:16,790 --> 00:29:20,510
<font color="#CCCCCC">shutter is concerned I mean this is</font><font color="#E5E5E5"> not</font>

654
00:29:18,559 --> 00:29:23,139
information<font color="#CCCCCC"> that someone</font><font color="#E5E5E5"> is in hiding</font>

655
00:29:20,510 --> 00:29:27,730
<font color="#CCCCCC">you can actually</font><font color="#E5E5E5"> access it very easily</font>

656
00:29:23,140 --> 00:29:27,730
<font color="#CCCCCC">ok so</font>

657
00:29:27,779 --> 00:29:33,629
this is all these<font color="#CCCCCC"> different</font><font color="#E5E5E5"> things we</font>

658
00:29:30,090 --> 00:29:36,959
just<font color="#CCCCCC"> saw okay so how do you control the</font>

659
00:29:33,629 --> 00:29:38,939
<font color="#E5E5E5">device</font><font color="#CCCCCC"> as I said this URL contains all</font>

660
00:29:36,960 --> 00:29:43,679
the different actions<font color="#CCCCCC"> you can do</font><font color="#E5E5E5"> with</font>

661
00:29:38,940 --> 00:29:45,599
the<font color="#E5E5E5"> device okay you need to build a</font>

662
00:29:43,679 --> 00:29:47,909
<font color="#CCCCCC">specific request</font><font color="#E5E5E5"> with which I'll explain</font>

663
00:29:45,599 --> 00:29:51,029
in<font color="#E5E5E5"> a</font><font color="#CCCCCC"> minute</font><font color="#E5E5E5"> but you can you need</font><font color="#CCCCCC"> to</font>

664
00:29:47,909 --> 00:29:56,580
<font color="#E5E5E5">build a</font><font color="#CCCCCC"> specific request okay</font><font color="#E5E5E5"> and they</font>

665
00:29:51,029 --> 00:29:58,499
send it<font color="#CCCCCC"> to this URL and</font><font color="#E5E5E5"> you have to add</font>

666
00:29:56,580 --> 00:30:02,389
a<font color="#CCCCCC"> specific header</font><font color="#E5E5E5"> that's called soap</font>

667
00:29:58,499 --> 00:30:04,889
action<font color="#E5E5E5"> okay and put this this line and</font>

668
00:30:02,389 --> 00:30:08,399
in the<font color="#CCCCCC"> header with the service name</font>

669
00:30:04,889 --> 00:30:13,439
together<font color="#E5E5E5"> okay so this is what the</font>

670
00:30:08,399 --> 00:30:14,728
request looks like okay you have what

671
00:30:13,440 --> 00:30:17,460
you want to do which is and<font color="#CCCCCC"> forth</font>

672
00:30:14,729 --> 00:30:20,549
mapping<font color="#CCCCCC"> okay and all these different</font>

673
00:30:17,460 --> 00:30:22,589
details now<font color="#E5E5E5"> what's interesting is that</font>

674
00:30:20,549 --> 00:30:24,119
<font color="#E5E5E5">you don't even need</font><font color="#CCCCCC"> to change this from</font>

675
00:30:22,589 --> 00:30:26,729
one device to another<font color="#CCCCCC"> you can actually</font>

676
00:30:24,119 --> 00:30:28,468
use the<font color="#CCCCCC"> same request</font><font color="#E5E5E5"> over</font><font color="#CCCCCC"> and over</font><font color="#E5E5E5"> so</font>

677
00:30:26,729 --> 00:30:30,539
let's say you want to do some<font color="#E5E5E5"> kind of</font>

678
00:30:28,469 --> 00:30:31,979
attack<font color="#CCCCCC"> you can use this request</font><font color="#E5E5E5"> and you</font>

679
00:30:30,539 --> 00:30:33,869
can go<font color="#E5E5E5"> to shorten and you can get the</font>

680
00:30:31,979 --> 00:30:35,909
<font color="#E5E5E5">list of devices</font><font color="#CCCCCC"> and you can just run all</font>

681
00:30:33,869 --> 00:30:37,289
over<font color="#E5E5E5"> them you can just run through all</font>

682
00:30:35,909 --> 00:30:38,399
these different device and send this

683
00:30:37,289 --> 00:30:41,099
packet<font color="#CCCCCC"> to all these</font><font color="#E5E5E5"> different</font><font color="#CCCCCC"> devices</font>

684
00:30:38,399 --> 00:30:42,959
<font color="#E5E5E5">and do this configuration very easily</font>

685
00:30:41,099 --> 00:30:45,479
<font color="#CCCCCC">you</font><font color="#E5E5E5"> don't have to do this manually don't</font>

686
00:30:42,960 --> 00:30:48,869
have to exploit one<font color="#CCCCCC"> by yourself once you</font>

687
00:30:45,479 --> 00:30:51,769
<font color="#CCCCCC">get a specific</font><font color="#E5E5E5"> a packet it works you can</font>

688
00:30:48,869 --> 00:30:54,029
run<font color="#CCCCCC"> over whatever</font><font color="#E5E5E5"> devices you want to</font>

689
00:30:51,769 --> 00:30:58,139
<font color="#CCCCCC">okay as</font><font color="#E5E5E5"> long as they</font><font color="#CCCCCC"> use the same</font>

690
00:30:54,029 --> 00:30:59,999
profile okay so now you'd expect this

691
00:30:58,139 --> 00:31:02,070
has some sort<font color="#E5E5E5"> of authentication you'd</font>

692
00:30:59,999 --> 00:31:03,479
expect that<font color="#E5E5E5"> you</font><font color="#CCCCCC"> have a some</font><font color="#E5E5E5"> kind of</font>

693
00:31:02,070 --> 00:31:06,468
passive protection anything like that

694
00:31:03,479 --> 00:31:09,570
but<font color="#E5E5E5"> the</font><font color="#CCCCCC"> truth is</font><font color="#E5E5E5"> that no there's nothing</font>

695
00:31:06,469 --> 00:31:10,519
<font color="#E5E5E5">okay no kind of authentication</font>

696
00:31:09,570 --> 00:31:14,099
whatsoever

697
00:31:10,519 --> 00:31:17,070
specifically changing the configuration

698
00:31:14,099 --> 00:31:19,589
requires you to<font color="#E5E5E5"> a do some sort of</font>

699
00:31:17,070 --> 00:31:21,989
<font color="#E5E5E5">anticipate connection but besides</font><font color="#CCCCCC"> that</font>

700
00:31:19,589 --> 00:31:23,399
it really isn't anything<font color="#E5E5E5"> you can if you</font>

701
00:31:21,989 --> 00:31:25,710
find the device in<font color="#E5E5E5"> the</font><font color="#CCCCCC"> network you</font><font color="#E5E5E5"> can</font>

702
00:31:23,399 --> 00:31:27,928
go to it and<font color="#E5E5E5"> can change it okay</font><font color="#CCCCCC"> it's</font>

703
00:31:25,710 --> 00:31:31,520
very very simple<font color="#CCCCCC"> very easy</font><font color="#E5E5E5"> nothing's</font>

704
00:31:27,929 --> 00:31:35,240
<font color="#E5E5E5">gonna stop you from doing that</font>

705
00:31:31,520 --> 00:31:37,670
<font color="#E5E5E5">okay and now another thing that</font><font color="#CCCCCC"> they I</font>

706
00:31:35,240 --> 00:31:40,640
didn't explain<font color="#CCCCCC"> the kind</font><font color="#E5E5E5"> of thing I'm</font>

707
00:31:37,670 --> 00:31:43,900
<font color="#E5E5E5">gonna go back and</font><font color="#CCCCCC"> show it is that</font>

708
00:31:40,640 --> 00:31:46,979
specifically when we talk<font color="#CCCCCC"> about</font>

709
00:31:43,900 --> 00:31:46,979
[Music]

710
00:31:47,180 --> 00:31:53,300
adding port mapping<font color="#CCCCCC"> okay as you</font><font color="#E5E5E5"> can see</font>

711
00:31:50,570 --> 00:31:56,149
this is this is nuke stone<font color="#CCCCCC"> extended port</font>

712
00:31:53,300 --> 00:31:58,460
<font color="#E5E5E5">okay new protocol and this says new</font>

713
00:31:56,150 --> 00:32:00,340
<font color="#E5E5E5">internal port and new internal client</font>

714
00:31:58,460 --> 00:32:03,290
<font color="#E5E5E5">client now what I talked about is</font>

715
00:32:00,340 --> 00:32:06,050
sending proxying the request to an

716
00:32:03,290 --> 00:32:08,389
external port right<font color="#CCCCCC"> 53 and an external</font>

717
00:32:06,050 --> 00:32:10,460
client which is<font color="#CCCCCC"> the DNS server but</font>

718
00:32:08,390 --> 00:32:12,950
<font color="#CCCCCC">somehow this still works</font><font color="#E5E5E5"> why is that</font>

719
00:32:10,460 --> 00:32:16,040
<font color="#E5E5E5">because the devices</font><font color="#CCCCCC"> don't</font><font color="#E5E5E5"> even validate</font>

720
00:32:12,950 --> 00:32:18,050
input<font color="#E5E5E5"> so it's get gets an IP which is a</font>

721
00:32:16,040 --> 00:32:19,820
clearly external but it's still<font color="#E5E5E5"> gonna</font>

722
00:32:18,050 --> 00:32:22,100
<font color="#CCCCCC">use it anyway</font><font color="#E5E5E5"> doesn't even check it</font>

723
00:32:19,820 --> 00:32:24,970
doesn't try to see if something doesn't

724
00:32:22,100 --> 00:32:29,560
fit it just works with it and<font color="#E5E5E5"> that's it</font>

725
00:32:24,970 --> 00:32:29,560
okay so

726
00:32:29,910 --> 00:32:35,430
as I said some devices validate input

727
00:32:32,730 --> 00:32:37,380
other devices<font color="#E5E5E5"> make sure to</font><font color="#CCCCCC"> open ports to</font>

728
00:32:35,430 --> 00:32:38,340
<font color="#E5E5E5">the internal network only but that's the</font>

729
00:32:37,380 --> 00:32:40,800
most you can hope for

730
00:32:38,340 --> 00:32:44,699
<font color="#E5E5E5">okay there's</font><font color="#CCCCCC"> really barely</font><font color="#E5E5E5"> any kind of a</font>

731
00:32:40,800 --> 00:32:49,590
protection<font color="#E5E5E5"> on these devices okay so now</font>

732
00:32:44,700 --> 00:32:52,320
I'm<font color="#E5E5E5"> gonna do the demo</font><font color="#CCCCCC"> talked</font><font color="#E5E5E5"> about the</font>

733
00:32:49,590 --> 00:32:54,240
CPP device is hosted on the docker

734
00:32:52,320 --> 00:32:56,490
so it's kind<font color="#E5E5E5"> of an internal network so</font>

735
00:32:54,240 --> 00:32:59,190
it's really not not not really<font color="#E5E5E5"> the real</font>

736
00:32:56,490 --> 00:33:01,770
thing<font color="#CCCCCC"> but</font><font color="#E5E5E5"> that's because my a</font><font color="#CCCCCC"> droplet</font>

737
00:32:59,190 --> 00:33:04,880
decided to die<font color="#E5E5E5"> today morning like</font><font color="#CCCCCC"> I said</font>

738
00:33:01,770 --> 00:33:11,450
<font color="#E5E5E5">beginning so that's that's what I've</font><font color="#CCCCCC"> got</font>

739
00:33:04,880 --> 00:33:11,450
<font color="#CCCCCC">okay so some reason this</font><font color="#E5E5E5"> is this</font>

740
00:33:11,480 --> 00:33:17,130
okay so here's<font color="#E5E5E5"> what we gonna</font><font color="#CCCCCC"> do</font><font color="#E5E5E5"> this is</font>

741
00:33:14,280 --> 00:33:19,530
the<font color="#CCCCCC"> UPnP device okay as you can</font><font color="#E5E5E5"> see it's</font>

742
00:33:17,130 --> 00:33:22,410
a waiting for different commands to come

743
00:33:19,530 --> 00:33:25,379
<font color="#CCCCCC">its way now I'm using a certain</font><font color="#E5E5E5"> a tool</font>

744
00:33:22,410 --> 00:33:27,360
<font color="#CCCCCC">DDoS tool called a saddam anyone can</font>

745
00:33:25,380 --> 00:33:29,420
<font color="#E5E5E5">download it from a chrome is from github</font>

746
00:33:27,360 --> 00:33:33,290
<font color="#CCCCCC">it's</font><font color="#E5E5E5"> very easy to</font><font color="#CCCCCC"> operate</font>

747
00:33:29,420 --> 00:33:35,700
<font color="#CCCCCC">and I'm gonna</font><font color="#E5E5E5"> use the following command</font>

748
00:33:33,290 --> 00:33:38,580
<font color="#CCCCCC">okay what I'm gonna do is</font><font color="#E5E5E5"> go I'm gonna</font>

749
00:33:35,700 --> 00:33:43,590
<font color="#E5E5E5">get a regular DNS response from</font><font color="#CCCCCC"> igoogle</font>

750
00:33:38,580 --> 00:33:45,960
<font color="#CCCCCC">okay eight eight eight eight</font><font color="#E5E5E5"> okay as you</font>

751
00:33:43,590 --> 00:33:47,639
<font color="#E5E5E5">can see here you</font><font color="#CCCCCC"> have an application of</font>

752
00:33:45,960 --> 00:33:51,660
one<font color="#E5E5E5"> because they used</font><font color="#CCCCCC"> the regular DNS</font>

753
00:33:47,640 --> 00:33:54,480
query<font color="#CCCCCC"> okay and I got a response from</font>

754
00:33:51,660 --> 00:34:02,180
<font color="#CCCCCC">igoogle now if</font><font color="#E5E5E5"> I'll try doing the</font><font color="#CCCCCC"> same</font>

755
00:33:54,480 --> 00:34:05,430
thing<font color="#E5E5E5"> okay with the UPN piece IP</font>

756
00:34:02,180 --> 00:34:08,400
obviously nothing is<font color="#E5E5E5"> going to happen</font>

757
00:34:05,430 --> 00:34:10,110
<font color="#CCCCCC">right because there's no</font><font color="#E5E5E5"> port folding</font>

758
00:34:08,400 --> 00:34:12,168
rule yet<font color="#E5E5E5"> I didn't set anything in place</font>

759
00:34:10,110 --> 00:34:15,720
so it's<font color="#E5E5E5"> not gonna work it gets a request</font>

760
00:34:12,168 --> 00:34:18,949
for me to<font color="#E5E5E5"> port 53 and nothing happens</font>

761
00:34:15,719 --> 00:34:23,069
now here's what here's<font color="#CCCCCC"> what I'm gonna do</font>

762
00:34:18,949 --> 00:34:25,889
there's another tune that downloaded

763
00:34:23,070 --> 00:34:28,200
from a clone from<font color="#CCCCCC"> github as well</font><font color="#E5E5E5"> it's a</font>

764
00:34:25,889 --> 00:34:30,000
<font color="#E5E5E5">called a part of a repository called a</font>

765
00:34:28,199 --> 00:34:32,158
you can be hack masked and specifically

766
00:34:30,000 --> 00:34:35,310
is the fault<font color="#E5E5E5"> opener okay what I'm gonna</font>

767
00:34:32,159 --> 00:34:39,540
do<font color="#E5E5E5"> I'm gonna give</font><font color="#CCCCCC"> it the UPnP device is</font>

768
00:34:35,310 --> 00:34:42,179
XML<font color="#E5E5E5"> okay then give it a port to operate</font>

769
00:34:39,540 --> 00:34:46,918
<font color="#E5E5E5">over so this is like the 137 we recently</font>

770
00:34:42,179 --> 00:34:48,929
saw so it's<font color="#E5E5E5"> four nine one</font><font color="#CCCCCC"> five two I'm</font>

771
00:34:46,918 --> 00:34:52,949
going to ask you to operate operate over

772
00:34:48,929 --> 00:34:56,850
UDP<font color="#E5E5E5"> and I wanted</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> send whatever</font>

773
00:34:52,949 --> 00:34:59,189
requested gets over UDP<font color="#E5E5E5"> to port</font><font color="#CCCCCC"> four</font>

774
00:34:56,850 --> 00:35:01,860
nine one<font color="#CCCCCC"> five</font><font color="#E5E5E5"> two I'm going to send it</font>

775
00:34:59,190 --> 00:35:06,450
<font color="#CCCCCC">to Google</font><font color="#E5E5E5"> okay -</font><font color="#CCCCCC"> eight eight eight eight</font>

776
00:35:01,860 --> 00:35:09,650
<font color="#E5E5E5">port 53 okay</font><font color="#CCCCCC"> so I'm going to do this and</font>

777
00:35:06,450 --> 00:35:09,649
<font color="#E5E5E5">as</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> can see here</font>

778
00:35:12,100 --> 00:35:19,779
let's make it<font color="#E5E5E5"> visible as you can see the</font>

779
00:35:17,530 --> 00:35:23,280
<font color="#E5E5E5">port folding</font><font color="#CCCCCC"> wood was set in place okay</font>

780
00:35:19,780 --> 00:35:26,770
UDP<font color="#E5E5E5"> this is the external port</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> is</font>

781
00:35:23,280 --> 00:35:32,650
what the device thinks is an internal

782
00:35:26,770 --> 00:35:35,710
port general port an IP<font color="#E5E5E5"> okay now if I</font>

783
00:35:32,650 --> 00:35:36,550
try sending the DNS query again<font color="#E5E5E5"> this</font>

784
00:35:35,710 --> 00:35:38,650
<font color="#E5E5E5">won't work</font>

785
00:35:36,550 --> 00:35:42,370
why because I need<font color="#CCCCCC"> to send it to port</font>

786
00:35:38,650 --> 00:35:46,570
<font color="#CCCCCC">four nine</font><font color="#E5E5E5"> four nine one five</font><font color="#CCCCCC"> two</font><font color="#E5E5E5"> so I'm</font>

787
00:35:42,370 --> 00:35:48,450
<font color="#E5E5E5">just gonna edit the script</font><font color="#CCCCCC"> wanted to do</font>

788
00:35:46,570 --> 00:35:52,270
<font color="#E5E5E5">this way so that it</font><font color="#CCCCCC"> won't be visible</font>

789
00:35:48,450 --> 00:35:58,200
<font color="#E5E5E5">usually it sends DNS to a</font><font color="#CCCCCC"> 53</font><font color="#E5E5E5"> and I have</font>

790
00:35:52,270 --> 00:36:02,400
to change<font color="#E5E5E5"> it to one five two right yes</font>

791
00:35:58,200 --> 00:36:05,370
so now just<font color="#CCCCCC"> that this will be clear</font><font color="#E5E5E5"> I'm</font>

792
00:36:02,400 --> 00:36:08,690
gonna try sending it again to<font color="#E5E5E5"> Google</font>

793
00:36:05,370 --> 00:36:11,160
<font color="#E5E5E5">okay and of course this won't work</font>

794
00:36:08,690 --> 00:36:15,650
<font color="#E5E5E5">Google doesn't understand what spot four</font>

795
00:36:11,160 --> 00:36:18,629
nine five two four nine<font color="#CCCCCC"> one five two and</font>

796
00:36:15,650 --> 00:36:20,190
<font color="#CCCCCC">when I send it to the</font><font color="#E5E5E5"> UPP device what</font>

797
00:36:18,630 --> 00:36:22,290
happens that<font color="#CCCCCC"> you</font><font color="#E5E5E5"> can pin the device is</font>

798
00:36:20,190 --> 00:36:24,390
gonna<font color="#E5E5E5"> get a</font><font color="#CCCCCC"> which get the request for</font>

799
00:36:22,290 --> 00:36:28,200
the to Google and get<font color="#E5E5E5"> a response</font><font color="#CCCCCC"> back</font>

800
00:36:24,390 --> 00:36:31,140
and<font color="#CCCCCC"> then forward</font><font color="#E5E5E5"> it back to me okay so</font>

801
00:36:28,200 --> 00:36:33,529
as<font color="#E5E5E5"> you can</font><font color="#CCCCCC"> see we actually got</font><font color="#E5E5E5"> an</font>

802
00:36:31,140 --> 00:36:37,020
amplification<font color="#E5E5E5"> we got a response</font><font color="#CCCCCC"> back</font><font color="#E5E5E5"> and</font>

803
00:36:33,530 --> 00:36:45,330
the port folding<font color="#E5E5E5"> folding the</font><font color="#CCCCCC"> request</font>

804
00:36:37,020 --> 00:36:49,140
<font color="#CCCCCC">actually works</font><font color="#E5E5E5"> okay so this sums</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the</font>

805
00:36:45,330 --> 00:36:51,319
demo<font color="#E5E5E5"> is this</font><font color="#CCCCCC"> I understood I mean didn't</font>

806
00:36:49,140 --> 00:36:53,910
understand what's what's<font color="#CCCCCC"> happening here</font>

807
00:36:51,320 --> 00:36:57,180
<font color="#E5E5E5">okay so we actually managed to send the</font>

808
00:36:53,910 --> 00:37:00,060
request<font color="#E5E5E5"> through the UPP device get it to</font>

809
00:36:57,180 --> 00:37:01,589
the<font color="#E5E5E5"> DNS server get it back and bring it</font>

810
00:37:00,060 --> 00:37:05,190
<font color="#CCCCCC">back</font><font color="#E5E5E5"> to me if I would send it with a</font>

811
00:37:01,590 --> 00:37:08,150
spoofed IP the response will return to

812
00:37:05,190 --> 00:37:08,150
the victim

813
00:37:08,380 --> 00:37:10,979
<font color="#E5E5E5">okay</font>

814
00:37:11,599 --> 00:37:18,349
so how can you<font color="#E5E5E5"> protect against this well</font>

815
00:37:14,959 --> 00:37:20,629
truth is that you<font color="#E5E5E5"> by yourself you can't</font>

816
00:37:18,349 --> 00:37:22,759
really protect against<font color="#E5E5E5"> it because you</font>

817
00:37:20,630 --> 00:37:24,199
have<font color="#E5E5E5"> to get first of all</font><font color="#CCCCCC"> adidas</font>

818
00:37:22,759 --> 00:37:25,489
<font color="#CCCCCC">protection provider but</font><font color="#E5E5E5"> the reason you</font>

819
00:37:24,199 --> 00:37:27,469
<font color="#CCCCCC">need to get a did this protection</font>

820
00:37:25,489 --> 00:37:29,539
provider is because you need<font color="#CCCCCC"> a deep</font>

821
00:37:27,469 --> 00:37:31,489
packet inspection<font color="#CCCCCC"> once you</font><font color="#E5E5E5"> don't have</font>

822
00:37:29,539 --> 00:37:33,979
the IP and you don't have the sort of

823
00:37:31,489 --> 00:37:35,599
the<font color="#CCCCCC"> source port</font><font color="#E5E5E5"> you can't understand</font>

824
00:37:33,979 --> 00:37:36,890
what's coming<font color="#CCCCCC"> your way</font>

825
00:37:35,599 --> 00:37:38,739
<font color="#E5E5E5">and once you can't understand what's</font>

826
00:37:36,890 --> 00:37:41,089
coming<font color="#E5E5E5"> your way you can't really</font>

827
00:37:38,739 --> 00:37:44,359
<font color="#E5E5E5">understand this is amplification vector</font>

828
00:37:41,089 --> 00:37:45,799
now most ISPs as far as I know don't UDP

829
00:37:44,359 --> 00:37:47,930
packet inspections and<font color="#E5E5E5"> you can't really</font>

830
00:37:45,799 --> 00:37:51,019
<font color="#E5E5E5">ask them to do these controls</font><font color="#CCCCCC"> to put</font><font color="#E5E5E5"> in</font>

831
00:37:47,930 --> 00:37:54,019
these kind of<font color="#E5E5E5"> rules okay now obviously</font>

832
00:37:51,019 --> 00:37:55,788
<font color="#E5E5E5">once</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> realize that there's a problem</font>

833
00:37:54,019 --> 00:37:57,439
here it's very<font color="#E5E5E5"> easy to mitigate you just</font>

834
00:37:55,789 --> 00:37:59,420
say if there's a mismatch<font color="#CCCCCC"> that there's a</font>

835
00:37:57,440 --> 00:38:01,309
mismatch between<font color="#E5E5E5"> the packet type I got</font>

836
00:37:59,420 --> 00:38:04,809
let's say<font color="#E5E5E5"> a DNS response from a report</font>

837
00:38:01,309 --> 00:38:07,430
that<font color="#E5E5E5"> is in 53</font><font color="#CCCCCC"> ok then obviously drop it</font>

838
00:38:04,809 --> 00:38:08,900
<font color="#E5E5E5">okay and</font><font color="#CCCCCC"> you can</font><font color="#E5E5E5"> do the same thing with</font>

839
00:38:07,430 --> 00:38:11,149
a<font color="#E5E5E5"> sauce</font><font color="#CCCCCC"> I'd be</font><font color="#E5E5E5"> let's say if I have a</font>

840
00:38:08,900 --> 00:38:13,309
list<font color="#E5E5E5"> of all the different</font><font color="#CCCCCC"> type is I</font>

841
00:38:11,150 --> 00:38:15,289
found<font color="#E5E5E5"> a mismatch</font><font color="#CCCCCC"> with in the packet type</font>

842
00:38:13,309 --> 00:38:18,289
<font color="#CCCCCC">okay I get a packet</font><font color="#E5E5E5"> type</font><font color="#CCCCCC"> from a form an</font>

843
00:38:15,289 --> 00:38:20,779
IP that<font color="#E5E5E5"> I know doesn't do the</font><font color="#CCCCCC"> NS</font><font color="#E5E5E5"> but I</font>

844
00:38:18,289 --> 00:38:23,410
get the DNS packet from<font color="#E5E5E5"> them then this</font>

845
00:38:20,779 --> 00:38:26,809
obviously<font color="#E5E5E5"> is something I want drop</font><font color="#CCCCCC"> okay</font>

846
00:38:23,410 --> 00:38:29,779
so<font color="#E5E5E5"> just say it was the</font><font color="#CCCCCC"> end of</font><font color="#E5E5E5"> it</font>

847
00:38:26,809 --> 00:38:34,069
just a few credits so I got the<font color="#E5E5E5"> port</font>

848
00:38:29,779 --> 00:38:36,259
<font color="#E5E5E5">opener from this a github repository</font><font color="#CCCCCC"> and</font>

849
00:38:34,069 --> 00:38:42,069
there's a downed either<font color="#CCCCCC"> still from this</font>

850
00:38:36,259 --> 00:38:42,069
one<font color="#E5E5E5"> okay</font><font color="#CCCCCC"> so thank you very</font><font color="#E5E5E5"> much</font>

851
00:38:46,190 --> 00:38:52,580
questions anyone yeah

852
00:39:14,690 --> 00:39:20,730
<font color="#E5E5E5">okay so this is a very widespread</font>

853
00:39:17,340 --> 00:39:23,820
problem<font color="#E5E5E5"> first of all there's a bunch of</font>

854
00:39:20,730 --> 00:39:25,680
<font color="#CCCCCC">devices that are vulnerable we did not</font>

855
00:39:23,820 --> 00:39:29,550
contact<font color="#E5E5E5"> any of them because this is</font><font color="#CCCCCC"> a</font>

856
00:39:25,680 --> 00:39:31,350
well known vulnerability and<font color="#E5E5E5"> the UPP</font>

857
00:39:29,550 --> 00:39:33,170
<font color="#E5E5E5">devices being open</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> the external</font>

858
00:39:31,350 --> 00:39:35,640
<font color="#E5E5E5">network is something very commonly known</font>

859
00:39:33,170 --> 00:39:39,060
one of<font color="#CCCCCC"> the things that also happens is</font>

860
00:39:35,640 --> 00:39:41,250
that many<font color="#E5E5E5"> manufactures just use the same</font>

861
00:39:39,060 --> 00:39:43,020
library<font color="#CCCCCC"> over and</font><font color="#E5E5E5"> over again</font><font color="#CCCCCC"> so even if</font>

862
00:39:41,250 --> 00:39:44,400
it's vulnerable<font color="#CCCCCC"> even if they got reports</font>

863
00:39:43,020 --> 00:39:48,119
it was<font color="#CCCCCC"> vulnerable they'll keep</font><font color="#E5E5E5"> on using</font>

864
00:39:44,400 --> 00:39:53,550
<font color="#E5E5E5">it this is a very widely spread problem</font>

865
00:39:48,119 --> 00:39:56,060
<font color="#E5E5E5">with you baby okay any other questions</font>

866
00:39:53,550 --> 00:39:56,060
<font color="#E5E5E5">yeah</font>

867
00:39:58,170 --> 00:40:10,390
hi<font color="#E5E5E5"> as I can see most of these</font><font color="#CCCCCC"> attacks</font>

868
00:40:02,670 --> 00:40:17,799
<font color="#E5E5E5">rely on IP spoofing</font><font color="#CCCCCC"> now how easy it is</font>

869
00:40:10,390 --> 00:40:21,700
to spoof<font color="#E5E5E5"> the source IP it's extremely</font>

870
00:40:17,799 --> 00:40:26,288
easy<font color="#E5E5E5"> it's a basically you don't you need</font>

871
00:40:21,700 --> 00:40:29,470
<font color="#CCCCCC">to do anything almost a you</font><font color="#E5E5E5"> just have to</font>

872
00:40:26,289 --> 00:40:30,970
put in you your<font color="#E5E5E5"> your the spoofed IP when</font>

873
00:40:29,470 --> 00:40:32,618
you send a packet and that's it

874
00:40:30,970 --> 00:40:37,629
<font color="#E5E5E5">really</font><font color="#CCCCCC"> don't</font><font color="#E5E5E5"> need</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> know anything else</font>

875
00:40:32,619 --> 00:40:41,079
so<font color="#CCCCCC"> Reuters along the route</font><font color="#E5E5E5"> of your</font>

876
00:40:37,630 --> 00:40:43,690
packet<font color="#E5E5E5"> they are not going to be they're</font>

877
00:40:41,079 --> 00:40:46,990
<font color="#E5E5E5">not going to check actually that the</font>

878
00:40:43,690 --> 00:40:47,410
source IP is actually outside<font color="#CCCCCC"> of their</font>

879
00:40:46,990 --> 00:40:49,779
<font color="#E5E5E5">range</font>

880
00:40:47,410 --> 00:40:54,629
<font color="#CCCCCC">I'm sorry didn't understand that</font><font color="#E5E5E5"> but</font>

881
00:40:49,779 --> 00:41:00,549
generally<font color="#CCCCCC"> speaking</font><font color="#E5E5E5"> yeah you could say</font>

882
00:40:54,630 --> 00:41:08,640
<font color="#CCCCCC">water on</font><font color="#E5E5E5"> the internet they could receive</font>

883
00:41:00,549 --> 00:41:12,579
a packet from anywhere should should<font color="#CCCCCC"> be</font>

884
00:41:08,640 --> 00:41:20,308
easy<font color="#CCCCCC"> at times some configurations maybe</font>

885
00:41:12,579 --> 00:41:25,329
the<font color="#CCCCCC"> Gateway could know which addresses</font>

886
00:41:20,309 --> 00:41:28,319
it actually<font color="#E5E5E5"> holds in its domain</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> do</font>

887
00:41:25,329 --> 00:41:31,990
you see something<font color="#CCCCCC"> like that</font><font color="#E5E5E5"> on the</font><font color="#CCCCCC"> net</font>

888
00:41:28,319 --> 00:41:34,930
<font color="#E5E5E5">well if I understand the question</font>

889
00:41:31,990 --> 00:41:37,058
correctly<font color="#CCCCCC"> you're asking if the different</font>

890
00:41:34,930 --> 00:41:40,509
a routing devices in the way can somehow

891
00:41:37,059 --> 00:41:43,839
discover that their<font color="#E5E5E5"> IP spoofed well not</font>

892
00:41:40,510 --> 00:41:46,900
as far as<font color="#E5E5E5"> I know not a regular routing</font>

893
00:41:43,839 --> 00:41:48,578
devices anyway they<font color="#E5E5E5"> just get</font><font color="#CCCCCC"> a packet</font>

894
00:41:46,900 --> 00:41:50,529
and<font color="#CCCCCC"> they deal with</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> they completely</font>

895
00:41:48,579 --> 00:41:53,710
trust it that's why I have a protocol

896
00:41:50,529 --> 00:41:56,230
such as TCP which has<font color="#CCCCCC"> a meant</font><font color="#E5E5E5"> to prevent</font>

897
00:41:53,710 --> 00:41:58,720
<font color="#E5E5E5">this case but when you have a single UDP</font>

898
00:41:56,230 --> 00:42:00,700
packet flowing through the network<font color="#E5E5E5"> now</font>

899
00:41:58,720 --> 00:42:03,038
different routing<font color="#CCCCCC"> devices just a</font>

900
00:42:00,700 --> 00:42:05,140
completely<font color="#CCCCCC"> trusted</font><font color="#E5E5E5"> and they do whatever</font>

901
00:42:03,039 --> 00:42:06,770
the packet they sort of tells them<font color="#CCCCCC"> to do</font>

902
00:42:05,140 --> 00:42:10,440
they just<font color="#E5E5E5"> route it</font>

903
00:42:06,770 --> 00:42:12,690
yeah<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> thanks yes</font>

904
00:42:10,440 --> 00:42:17,030
[Music]

905
00:42:12,690 --> 00:42:19,830
no thank you<font color="#E5E5E5"> hey one</font><font color="#CCCCCC"> question if the</font>

906
00:42:17,030 --> 00:42:22,740
European<font color="#CCCCCC"> beat device</font><font color="#E5E5E5"> it was the same</font>

907
00:42:19,830 --> 00:42:27,150
also<font color="#E5E5E5"> a DNS server</font><font color="#CCCCCC"> it would be</font><font color="#E5E5E5"> the that</font>

908
00:42:22,740 --> 00:42:30,330
<font color="#E5E5E5">would be the same sorry</font><font color="#CCCCCC"> UPnP device</font><font color="#E5E5E5"> yes</font>

909
00:42:27,150 --> 00:42:34,350
also<font color="#CCCCCC"> a DNS server is</font><font color="#E5E5E5"> also a DNS server</font>

910
00:42:30,330 --> 00:42:35,730
yeah for example yeah you can do yes<font color="#CCCCCC"> you</font>

911
00:42:34,350 --> 00:42:37,380
can actually<font color="#E5E5E5"> do the same</font><font color="#CCCCCC"> thing you can</font>

912
00:42:35,730 --> 00:42:39,660
<font color="#CCCCCC">tilt what you can do is you can tell the</font>

913
00:42:37,380 --> 00:42:41,820
UPP device<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> thanks</font>

914
00:42:39,660 --> 00:42:44,430
let's say you have a UPnP device of a

915
00:42:41,820 --> 00:42:47,550
port over<font color="#E5E5E5"> IP one one one one</font>

916
00:42:44,430 --> 00:42:50,879
<font color="#E5E5E5">okay so you can send it and set a port</font>

917
00:42:47,550 --> 00:42:52,980
forwarding rule<font color="#E5E5E5"> where that</font><font color="#CCCCCC"> way to</font>

918
00:42:50,880 --> 00:42:57,150
<font color="#CCCCCC">reroute</font><font color="#E5E5E5"> any request that comes from</font>

919
00:42:52,980 --> 00:43:00,840
<font color="#E5E5E5">whatever part you want</font><font color="#CCCCCC"> to a one one one</font>

920
00:42:57,150 --> 00:43:03,570
port 53<font color="#E5E5E5"> so you can actually tell it to</font>

921
00:43:00,840 --> 00:43:05,460
route the request to itself<font color="#E5E5E5"> and that way</font>

922
00:43:03,570 --> 00:43:08,160
you<font color="#E5E5E5"> can actually use the DNS server and</font>

923
00:43:05,460 --> 00:43:10,530
you get the same DNS server but it<font color="#CCCCCC"> will</font>

924
00:43:08,160 --> 00:43:12,629
respond from<font color="#E5E5E5"> a different port so instead</font>

925
00:43:10,530 --> 00:43:14,700
of responding<font color="#E5E5E5"> from</font><font color="#CCCCCC"> 453 it can response</font>

926
00:43:12,630 --> 00:43:15,590
<font color="#CCCCCC">on</font><font color="#E5E5E5"> another port so yeah that that is</font>

927
00:43:14,700 --> 00:43:18,698
<font color="#E5E5E5">possible</font>

928
00:43:15,590 --> 00:43:18,699
[Music]

929
00:43:31,299 --> 00:43:37,130
hi I will<font color="#E5E5E5"> just have addition to spoofing</font>

930
00:43:35,479 --> 00:43:39,739
<font color="#E5E5E5">okay technically technically it's not a</font>

931
00:43:37,130 --> 00:43:42,949
problem to<font color="#CCCCCC"> spoof the packets</font><font color="#E5E5E5"> but at</font>

932
00:43:39,739 --> 00:43:45,109
least<font color="#E5E5E5"> in my country is piece already</font>

933
00:43:42,949 --> 00:43:47,599
discarding the packets<font color="#CCCCCC"> they have spoofed</font>

934
00:43:45,109 --> 00:43:51,199
IP address is coming<font color="#E5E5E5"> not from from dry</font>

935
00:43:47,599 --> 00:43:53,569
<font color="#E5E5E5">Pia from my Reuters so I guess it's the</font>

936
00:43:51,199 --> 00:43:55,369
same<font color="#E5E5E5"> all around the world or it's always</font>

937
00:43:53,569 --> 00:43:57,380
different<font color="#CCCCCC"> because I know from our</font>

938
00:43:55,369 --> 00:44:00,559
perspective when<font color="#CCCCCC"> we</font><font color="#E5E5E5"> tried</font><font color="#CCCCCC"> our experiment</font>

939
00:43:57,380 --> 00:44:03,650
at the<font color="#E5E5E5"> different ice piece we get the</font>

940
00:44:00,559 --> 00:44:06,170
same results so<font color="#E5E5E5"> it's really hard</font><font color="#CCCCCC"> you can</font>

941
00:44:03,650 --> 00:44:10,699
<font color="#CCCCCC">spoop</font><font color="#E5E5E5"> but the packets are not forwarded</font>

942
00:44:06,170 --> 00:44:14,089
to to anywhere so<font color="#CCCCCC"> ok</font><font color="#E5E5E5"> let me have</font><font color="#CCCCCC"> two</font>

943
00:44:10,699 --> 00:44:15,799
<font color="#E5E5E5">here</font><font color="#CCCCCC"> I when</font><font color="#E5E5E5"> I whenever I tried spoofing</font>

944
00:44:14,089 --> 00:44:19,069
I never had any kind of problems<font color="#CCCCCC"> but I</font>

945
00:44:15,799 --> 00:44:21,469
guess<font color="#CCCCCC"> I might</font><font color="#E5E5E5"> be</font><font color="#CCCCCC"> lack or might be</font><font color="#E5E5E5"> that a</font>

946
00:44:19,069 --> 00:44:25,630
<font color="#E5E5E5">specific way where I tried from we</font>

947
00:44:21,469 --> 00:44:25,630
didn't have that kind of technique

948
00:44:29,150 --> 00:44:37,390
any more questions okay

949
00:44:34,700 --> 00:44:37,390
thank you

950
00:44:44,000 --> 00:44:56,090
[Music]

951
00:44:55,230 --> 00:44:59,359
[Applause]

952
00:44:56,090 --> 00:44:59,359
[Music]

