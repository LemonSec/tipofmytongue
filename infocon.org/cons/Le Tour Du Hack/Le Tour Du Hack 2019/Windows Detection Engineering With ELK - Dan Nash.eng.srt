1
00:00:02,870 --> 00:00:06,960
hi everyone so mark and I said a villain

2
00:00:06,960 --> 00:00:08,340
I could I'm here today to talk about the

3
00:00:08,340 --> 00:00:09,540
windows detection engineering

4
00:00:09,540 --> 00:00:11,010
specifically different to this writing

5
00:00:11,010 --> 00:00:13,559
detection and while better by the LK at

6
00:00:13,559 --> 00:00:15,449
the end but I'm done ash don't you know

7
00:00:15,449 --> 00:00:16,710
me so if you don't

8
00:00:16,710 --> 00:00:20,610
anyway I'm there's more about me so I

9
00:00:20,610 --> 00:00:22,440
know I'm part of the security

10
00:00:22,440 --> 00:00:24,900
engineering team s office after working

11
00:00:24,900 --> 00:00:27,630
with the West blog for a UCF security

12
00:00:27,630 --> 00:00:31,140
with with Harry I used to be much more a

13
00:00:31,140 --> 00:00:32,940
part of that you suck Donnie I'm no I uh

14
00:00:32,940 --> 00:00:34,650
and this one down that's great to see

15
00:00:34,650 --> 00:00:36,900
everyone here a other event it really is

16
00:00:36,900 --> 00:00:39,390
fantastic with such a great tournament

17
00:00:39,390 --> 00:00:40,620
and the runners been somebody good

18
00:00:40,620 --> 00:00:43,200
talked and they used to work on Jeff's

19
00:00:43,200 --> 00:00:45,570
detection logic so that's like

20
00:00:45,570 --> 00:00:47,270
essentially like endpoint and network

21
00:00:47,270 --> 00:00:49,260
traces which are left behind which allow

22
00:00:49,260 --> 00:00:50,820
us to see why like what does anything

23
00:00:50,820 --> 00:00:52,470
say bad and then we can react it instead

24
00:00:52,470 --> 00:00:53,460
of finding out about it eight months

25
00:00:53,460 --> 00:00:57,300
later when we're in the news so I used

26
00:00:57,300 --> 00:00:58,950
to work on just natural logic itself and

27
00:00:58,950 --> 00:01:00,300
since during sauce I've discovered

28
00:01:00,300 --> 00:01:01,680
there's so much more fit than not in

29
00:01:01,680 --> 00:01:04,409
that gave me nice I was privileged

30
00:01:04,409 --> 00:01:05,549
enough to attend Harry's talked earlier

31
00:01:05,549 --> 00:01:07,170
about it and like it's about does

32
00:01:07,170 --> 00:01:09,240
highlight a lot of it so it's there if

33
00:01:09,240 --> 00:01:10,829
you're watching us recorded you should

34
00:01:10,829 --> 00:01:12,030
go onto the same channel and check out

35
00:01:12,030 --> 00:01:15,299
on that as well but yeah I'm gonna start

36
00:01:15,299 --> 00:01:17,009
this off with enterprise security is

37
00:01:17,009 --> 00:01:19,200
hard and as security engineers on those

38
00:01:19,200 --> 00:01:20,549
people and the defense we're often on

39
00:01:20,549 --> 00:01:22,170
the back foot or if we don't prepare

40
00:01:22,170 --> 00:01:23,759
we're all from the back foot and I mean

41
00:01:23,759 --> 00:01:24,810
listen to railways

42
00:01:24,810 --> 00:01:26,700
so first technically like modern

43
00:01:26,700 --> 00:01:28,560
enterprises are quite specialized and

44
00:01:28,560 --> 00:01:29,729
well-liked

45
00:01:29,729 --> 00:01:31,829
suffer different threats so for instance

46
00:01:31,829 --> 00:01:34,950
like businesses which were called over

47
00:01:34,950 --> 00:01:36,779
email and like businesses we sell well

48
00:01:36,779 --> 00:01:39,149
welcome under fishing welcome on their

49
00:01:39,149 --> 00:01:42,469
fake shake say you threats while

50
00:01:42,469 --> 00:01:44,789
software vendors will come under attack

51
00:01:44,789 --> 00:01:47,689
from people looking to like hijack

52
00:01:47,689 --> 00:01:50,099
supply chains and so on and so forth and

53
00:01:50,099 --> 00:01:51,389
all all of these require different

54
00:01:51,389 --> 00:01:53,039
detection mechanisms and different

55
00:01:53,039 --> 00:01:56,189
protections and all sorts of things and

56
00:01:56,189 --> 00:01:58,139
even in one business different silos

57
00:01:58,139 --> 00:01:59,189
within the business of different

58
00:01:59,189 --> 00:02:00,569
departments will face entirely different

59
00:02:00,569 --> 00:02:02,429
threats as well so if you're a security

60
00:02:02,429 --> 00:02:03,479
engineer trying to deal with all this

61
00:02:03,479 --> 00:02:04,709
that's a lot of different things you

62
00:02:04,709 --> 00:02:08,610
need to consider and even in the same

63
00:02:08,610 --> 00:02:10,080
departments and even in the same like

64
00:02:10,080 --> 00:02:13,590
even in the same processes different

65
00:02:13,590 --> 00:02:15,069
platforms so like Linux Windows

66
00:02:15,069 --> 00:02:17,920
all been friends and Mac all require

67
00:02:17,920 --> 00:02:19,870
again they all work slightly different

68
00:02:19,870 --> 00:02:21,579
say all work slightly definitely a more

69
00:02:21,579 --> 00:02:23,079
require different protections again

70
00:02:23,079 --> 00:02:25,569
which which means more staff here are

71
00:02:25,569 --> 00:02:27,040
the subject matter expert than that

72
00:02:27,040 --> 00:02:28,870
which means collaboration necessary so

73
00:02:28,870 --> 00:02:30,909
schedules of the lineup into this it's a

74
00:02:30,909 --> 00:02:33,780
lot of drama and it's a lot of work and

75
00:02:33,780 --> 00:02:37,060
socially as well and Security's a call

76
00:02:37,060 --> 00:02:38,950
center I mean that's it's all Foster's

77
00:02:38,950 --> 00:02:40,120
business to secure other people but

78
00:02:40,120 --> 00:02:41,680
internally it's still a cost and still a

79
00:02:41,680 --> 00:02:43,720
cost you have to justify and I mean like

80
00:02:43,720 --> 00:02:46,239
why do much security when she's security

81
00:02:46,239 --> 00:02:48,129
defect I guess like if there's no clear

82
00:02:48,129 --> 00:02:51,040
indicator that taking the cheaper option

83
00:02:51,040 --> 00:02:52,750
is going to like damage it or maybe

84
00:02:52,750 --> 00:02:55,150
that's money in the future then why why

85
00:02:55,150 --> 00:03:02,439
not do that a lot of risk which is

86
00:03:02,439 --> 00:03:04,030
expensive or inconvenient to mitigate

87
00:03:04,030 --> 00:03:06,069
can be accepted and which can lead to a

88
00:03:06,069 --> 00:03:08,799
lot of technical debt so for for

89
00:03:08,799 --> 00:03:11,620
security engineers would you see a lot

90
00:03:11,620 --> 00:03:13,450
of a lot of fatalism when we suggest

91
00:03:13,450 --> 00:03:17,379
kind of suggest more extensive like

92
00:03:17,379 --> 00:03:19,479
protection measures or like oh we're

93
00:03:19,479 --> 00:03:20,500
gonna get breached anyway so it doesn't

94
00:03:20,500 --> 00:03:23,199
matter or like why like buy this product

95
00:03:23,199 --> 00:03:25,540
if I think there's no real point and

96
00:03:25,540 --> 00:03:27,819
then a lot of well less so now this is

97
00:03:27,819 --> 00:03:29,229
in the news actually every single day

98
00:03:29,229 --> 00:03:31,299
but something happened yes so like

99
00:03:31,299 --> 00:03:33,010
they're not going to take an ounce or a

100
00:03:33,010 --> 00:03:34,180
small company or not or than their other

101
00:03:34,180 --> 00:03:35,319
not gonna or they're not gonna say this

102
00:03:35,319 --> 00:03:36,819
so this is just a dev Network we're like

103
00:03:36,819 --> 00:03:39,849
don't worry about it and again with that

104
00:03:39,849 --> 00:03:42,099
kind of technical debt security hygiene

105
00:03:42,099 --> 00:03:44,079
has like a major marketing problem

106
00:03:44,079 --> 00:03:45,699
because it's very easy to say yeah I've

107
00:03:45,699 --> 00:03:47,470
got a I've got this cool new thing which

108
00:03:47,470 --> 00:03:49,419
is gonna capture all the threats unlike

109
00:03:49,419 --> 00:03:50,739
and I'm just gonna like save you loads

110
00:03:50,739 --> 00:03:52,690
of money in your sock but if you

111
00:03:52,690 --> 00:03:56,169
actually want like I like F F you if

112
00:03:56,169 --> 00:03:57,579
you're in a patch say okay I'm going to

113
00:03:57,579 --> 00:03:58,959
go back and make sure that all of our

114
00:03:58,959 --> 00:04:00,699
event everything is auditable and

115
00:04:00,699 --> 00:04:02,079
everything is easy too easy to follow

116
00:04:02,079 --> 00:04:03,699
and the winner whenever our security

117
00:04:03,699 --> 00:04:04,930
team leaves someone else will be able to

118
00:04:04,930 --> 00:04:06,459
take over or for bring a specialist then

119
00:04:06,459 --> 00:04:07,629
it will be easy to understand there's a

120
00:04:07,629 --> 00:04:08,889
bet last by and flat because there's no

121
00:04:08,889 --> 00:04:11,229
real tangible benefit unless you really

122
00:04:11,229 --> 00:04:14,739
need it so yeah and there's also I read

123
00:04:14,739 --> 00:04:16,060
an interesting paper while researching

124
00:04:16,060 --> 00:04:18,279
this why information security is hard an

125
00:04:18,279 --> 00:04:19,539
economic perspective it's actually

126
00:04:19,539 --> 00:04:20,949
pitches the problem enterprise security

127
00:04:20,949 --> 00:04:23,320
as a problem of perverse incentives so

128
00:04:23,320 --> 00:04:24,789
the people who are controlling the money

129
00:04:24,789 --> 00:04:27,670
don't really have the same motive a

130
00:04:27,670 --> 00:04:29,650
as like someone who wants to keep data

131
00:04:29,650 --> 00:04:31,780
secure and the best kind of conflict of

132
00:04:31,780 --> 00:04:33,850
well the right thing to do would be to

133
00:04:33,850 --> 00:04:35,620
do everything we can to keep the data

134
00:04:35,620 --> 00:04:37,840
safe and that's gonna cost us too much

135
00:04:37,840 --> 00:04:39,910
money is going to forever be a play and

136
00:04:39,910 --> 00:04:41,290
until we actually fix that them right

137
00:04:41,290 --> 00:04:44,740
there there might be no real solution so

138
00:04:44,740 --> 00:04:47,200
to combat this I'm going to very quickly

139
00:04:47,200 --> 00:04:50,740
talk about use cases so in enterprise

140
00:04:50,740 --> 00:04:52,480
security we tend to manage the problem

141
00:04:52,480 --> 00:04:54,490
of endpoint the network security with a

142
00:04:54,490 --> 00:04:56,440
program called the seam which is a

143
00:04:56,440 --> 00:04:58,090
security information that is management

144
00:04:58,090 --> 00:05:01,060
tool hope I got that right right here

145
00:05:01,060 --> 00:05:03,700
but essentially what what we try to do

146
00:05:03,700 --> 00:05:05,770
and an enterprise is gather all of these

147
00:05:05,770 --> 00:05:08,290
logs into one place and then run logic

148
00:05:08,290 --> 00:05:10,420
against them to see if they're there are

149
00:05:10,420 --> 00:05:12,370
things we knew or bad behavior happening

150
00:05:12,370 --> 00:05:13,570
because like we can't look at every

151
00:05:13,570 --> 00:05:15,310
individual and point in every individual

152
00:05:15,310 --> 00:05:18,640
log file to see if the f5 bad stuff is

153
00:05:18,640 --> 00:05:21,910
going on so and inside these and inside

154
00:05:21,910 --> 00:05:24,190
the same tool we will break up security

155
00:05:24,190 --> 00:05:26,470
problems as these kisses very briefly

156
00:05:26,470 --> 00:05:28,120
the there's a lot there's a lot to be

157
00:05:28,120 --> 00:05:30,070
said about this topic so if you know

158
00:05:30,070 --> 00:05:31,210
much about this will probably be some

159
00:05:31,210 --> 00:05:32,830
stuff but you know that you know we're

160
00:05:32,830 --> 00:05:35,320
checking on here but I'm essentially

161
00:05:35,320 --> 00:05:37,060
saying to people that's just like fix

162
00:05:37,060 --> 00:05:39,430
the security if the enterprise doesn't

163
00:05:39,430 --> 00:05:41,560
really work and then because I cuz

164
00:05:41,560 --> 00:05:42,910
there's new direction there's no time

165
00:05:42,910 --> 00:05:44,320
skill how long will it take we don't

166
00:05:44,320 --> 00:05:44,710
know

167
00:05:44,710 --> 00:05:46,780
I like how many people you need we don't

168
00:05:46,780 --> 00:05:51,010
know are we secure yet we don't know so

169
00:05:51,010 --> 00:05:52,810
like if this project takes months or

170
00:05:52,810 --> 00:05:54,280
even years it's kind of hard to keep buy

171
00:05:54,280 --> 00:05:55,420
in there but it's like someone's paying

172
00:05:55,420 --> 00:05:56,710
you to secure all this stuff and when

173
00:05:56,710 --> 00:05:57,670
you said oh yeah I'm just going to

174
00:05:57,670 --> 00:05:59,380
secure it all and then a year later it's

175
00:05:59,380 --> 00:06:01,260
still not all secure it's kind of like

176
00:06:01,260 --> 00:06:04,630
well what were you doing and where so I

177
00:06:04,630 --> 00:06:06,580
use kiss is generally used to refer to

178
00:06:06,580 --> 00:06:09,340
your specific condition or event usually

179
00:06:09,340 --> 00:06:11,230
no specific threat to be detected or

180
00:06:11,230 --> 00:06:12,910
reported by a security tool and

181
00:06:12,910 --> 00:06:15,520
generally one would like whenever like

182
00:06:15,520 --> 00:06:17,530
your engineers talk about use kiss it'll

183
00:06:17,530 --> 00:06:19,330
go all the way from the high level of

184
00:06:19,330 --> 00:06:20,740
hacker motivation so who's targeting

185
00:06:20,740 --> 00:06:22,630
this and why I get to the business go do

186
00:06:22,630 --> 00:06:24,520
a set is there like laser data to be

187
00:06:24,520 --> 00:06:26,260
stolen all the way down to the

188
00:06:26,260 --> 00:06:29,440
mitigation reward if we can't mitigate

189
00:06:29,440 --> 00:06:32,500
the detection of the offer look tough

190
00:06:32,500 --> 00:06:35,950
them off the indicator of compromise

191
00:06:35,950 --> 00:06:37,419
there

192
00:06:37,419 --> 00:06:39,610
and generally seeing is the purpose of a

193
00:06:39,610 --> 00:06:41,830
use cases to make these security issues

194
00:06:41,830 --> 00:06:43,389
addressable and will generally include a

195
00:06:43,389 --> 00:06:44,949
playbook for an analyst to follow as

196
00:06:44,949 --> 00:06:46,719
well so once this is flagged up in your

197
00:06:46,719 --> 00:06:48,069
security tool of choice for the lobby

198
00:06:48,069 --> 00:06:50,319
spelunker and ELQ stock or whatever then

199
00:06:50,319 --> 00:06:51,759
the analyst who's reading it and

200
00:06:51,759 --> 00:06:53,229
monitoring it can actually take an

201
00:06:53,229 --> 00:06:54,759
action from that to help resolve the

202
00:06:54,759 --> 00:06:56,409
issue because although you can identify

203
00:06:56,409 --> 00:06:57,909
it and where you can detect it you still

204
00:06:57,909 --> 00:06:59,620
need to you know actually do something

205
00:06:59,620 --> 00:07:04,629
about it and generally we we would use a

206
00:07:04,629 --> 00:07:06,550
framework to pick which is kisses today

207
00:07:06,550 --> 00:07:08,949
so instead of you know becoming the

208
00:07:08,949 --> 00:07:11,020
subject matter expert and literally

209
00:07:11,020 --> 00:07:13,060
everything in your enterprise you can

210
00:07:13,060 --> 00:07:14,680
instead turn to people who already like

211
00:07:14,680 --> 00:07:16,810
you can get a like a good inventory list

212
00:07:16,810 --> 00:07:18,669
of what you have and then say ok so

213
00:07:18,669 --> 00:07:20,889
which platforms do we have and have we

214
00:07:20,889 --> 00:07:23,020
covered the entire kill chain so you can

215
00:07:23,020 --> 00:07:24,580
use I take it you kind of see this this

216
00:07:24,580 --> 00:07:27,129
this part at the bottom at the back ok

217
00:07:27,129 --> 00:07:29,469
so I'm essentially it goes from the if

218
00:07:29,469 --> 00:07:31,090
from the start if the kill chain so

219
00:07:31,090 --> 00:07:33,039
initial access to or well near the start

220
00:07:33,039 --> 00:07:34,240
of the kill chain for so from

221
00:07:34,240 --> 00:07:36,370
essentially as far as close to the start

222
00:07:36,370 --> 00:07:38,050
of the Hilton as we can do something

223
00:07:38,050 --> 00:07:39,580
about it because like reconnaissance and

224
00:07:39,580 --> 00:07:41,169
though Senator can't really like a side

225
00:07:41,169 --> 00:07:42,849
come you know like good even currently

226
00:07:42,849 --> 00:07:44,319
do much to I thought but it goes all the

227
00:07:44,319 --> 00:07:46,270
way from a national access check upon

228
00:07:46,270 --> 00:07:48,069
the control and exfiltration collection

229
00:07:48,069 --> 00:07:49,750
lateral movement discovery credential

230
00:07:49,750 --> 00:07:52,569
access the defense evasion and like at

231
00:07:52,569 --> 00:07:53,169
all

232
00:07:53,169 --> 00:07:54,610
so this is the major attack framework in

233
00:07:54,610 --> 00:07:57,430
particular and this will give a summary

234
00:07:57,430 --> 00:08:00,669
of each of the individual

235
00:08:00,669 --> 00:08:02,500
vulnerabilities and that list goes way

236
00:08:02,500 --> 00:08:04,000
way down but it would never fit on the

237
00:08:04,000 --> 00:08:06,810
slide so it'll give a summary of each

238
00:08:06,810 --> 00:08:08,800
individual vulnerability or each

239
00:08:08,800 --> 00:08:12,189
individual like the tactic used by

240
00:08:12,189 --> 00:08:14,710
attackers on each platform and then

241
00:08:14,710 --> 00:08:16,509
following one of these so like like

242
00:08:16,509 --> 00:08:18,279
anyone in the urbanisation could go okay

243
00:08:18,279 --> 00:08:20,469
given enough time why are we with all of

244
00:08:20,469 --> 00:08:23,050
these like with each of these boxes what

245
00:08:23,050 --> 00:08:24,370
are we doing to detect it I'm going to

246
00:08:24,370 --> 00:08:26,259
be doing to stop it so that's a good way

247
00:08:26,259 --> 00:08:28,150
for you to change the problem of let's

248
00:08:28,150 --> 00:08:29,259
this affects the security of our

249
00:08:29,259 --> 00:08:31,810
enterprise into here is how we're going

250
00:08:31,810 --> 00:08:33,940
to fix the security of our enterprise

251
00:08:33,940 --> 00:08:35,919
depth by bet and we know exactly where

252
00:08:35,919 --> 00:08:38,049
we stand with each piece and when

253
00:08:38,049 --> 00:08:39,669
something changes so let's say like we

254
00:08:39,669 --> 00:08:42,429
get new like we got an attack in or we

255
00:08:42,429 --> 00:08:43,899
might get a server we can again

256
00:08:43,899 --> 00:08:46,089
reference this chart to say kind of okay

257
00:08:46,089 --> 00:08:48,250
where are we in terms of plugging the

258
00:08:48,250 --> 00:08:49,519
holes

259
00:08:49,519 --> 00:08:51,750
and generally the development of a use

260
00:08:51,750 --> 00:08:53,430
case although there are there are tons

261
00:08:53,430 --> 00:08:54,810
of frameworks for developing them and

262
00:08:54,810 --> 00:08:56,160
there's lots of different like like

263
00:08:56,160 --> 00:08:58,050
ideologies on on what's the best way

264
00:08:58,050 --> 00:09:00,000
Daniel that's something like this so it

265
00:09:00,000 --> 00:09:01,800
starts off with like an objective like

266
00:09:01,800 --> 00:09:03,450
what are you trying to what are you

267
00:09:03,450 --> 00:09:05,399
trying to do stop any character usually

268
00:09:05,399 --> 00:09:08,040
there's threads so what what's the

269
00:09:08,040 --> 00:09:09,680
threat of happening what's the risk here

270
00:09:09,680 --> 00:09:13,050
so he's and stakeholders who is

271
00:09:13,050 --> 00:09:16,740
responsible not only for like actively

272
00:09:16,740 --> 00:09:18,839
working without a set or without part of

273
00:09:18,839 --> 00:09:20,430
the business but then who will also be

274
00:09:20,430 --> 00:09:22,230
involved in the process of fixing it or

275
00:09:22,230 --> 00:09:24,480
the process of mitigating it or ethics I

276
00:09:24,480 --> 00:09:26,370
have to data breach it would be mostly

277
00:09:26,370 --> 00:09:29,060
gali so on what data will we need to

278
00:09:29,060 --> 00:09:31,769
tomato to monitor and detect it what

279
00:09:31,769 --> 00:09:33,510
logic would we need to filter out the

280
00:09:33,510 --> 00:09:35,910
events we don't want and then we test

281
00:09:35,910 --> 00:09:37,890
that logic and then we'd assign priority

282
00:09:37,890 --> 00:09:40,260
to so given the data given D and I

283
00:09:40,260 --> 00:09:41,490
initially find it quite weird the

284
00:09:41,490 --> 00:09:43,079
priority was at the end because surely

285
00:09:43,079 --> 00:09:45,180
he decides the priority before you start

286
00:09:45,180 --> 00:09:46,410
development on it and that way you can

287
00:09:46,410 --> 00:09:48,600
fix the hardest things first but

288
00:09:48,600 --> 00:09:50,670
different vulnerability is well have

289
00:09:50,670 --> 00:09:52,769
different issues worth detecting them

290
00:09:52,769 --> 00:09:55,320
and depending on how well on or reliably

291
00:09:55,320 --> 00:09:58,110
you can detect them it might be in mind

292
00:09:58,110 --> 00:09:59,370
a different priority so it doesn't it

293
00:09:59,370 --> 00:10:04,170
doesn't make sense to decide on behind

294
00:10:04,170 --> 00:10:06,480
me behind behind major an alert or an

295
00:10:06,480 --> 00:10:10,200
event is at the end so I'm gonna run

296
00:10:10,200 --> 00:10:14,100
through very briefly there are some

297
00:10:14,100 --> 00:10:16,050
though there are some parts I skip over

298
00:10:16,050 --> 00:10:17,459
it if anyone's super familiar with

299
00:10:17,459 --> 00:10:19,079
Windows internals or kravinoff

300
00:10:19,079 --> 00:10:20,520
specifically it'll be reagent because

301
00:10:20,520 --> 00:10:22,589
this really doesn't cover the half of

302
00:10:22,589 --> 00:10:24,720
what it should this is 30 minutes soft

303
00:10:24,720 --> 00:10:27,750
so that's okay so essentially the

304
00:10:27,750 --> 00:10:31,380
Kerberos attack is as an attack on

305
00:10:31,380 --> 00:10:33,390
Wenders Kerberos which allows an

306
00:10:33,390 --> 00:10:35,130
attacker to he already has in the crank

307
00:10:35,130 --> 00:10:36,810
on the domain she asked for their

308
00:10:36,810 --> 00:10:38,790
privileges she and the client which owns

309
00:10:38,790 --> 00:10:41,910
a service and generally a client search

310
00:10:41,910 --> 00:10:43,230
of services attached to them have higher

311
00:10:43,230 --> 00:10:45,390
privileges just like just because of the

312
00:10:45,390 --> 00:10:47,190
way enterprises were coming like if if

313
00:10:47,190 --> 00:10:49,380
you're running like a batch service you

314
00:10:49,380 --> 00:10:50,490
like generally you're not just going to

315
00:10:50,490 --> 00:10:52,410
be you know I got like so many works in

316
00:10:52,410 --> 00:10:55,740
sales or so on and so forth so by online

317
00:10:55,740 --> 00:10:57,839
it's on the attack matrix the minor

318
00:10:57,839 --> 00:10:58,900
attack

319
00:10:58,900 --> 00:11:00,880
framework I showed you earlier that

320
00:11:00,880 --> 00:11:02,680
would come under credential access which

321
00:11:02,680 --> 00:11:07,300
is it's not like it definitely does not

322
00:11:07,300 --> 00:11:10,240
need fixed if like I'm sorry okay that's

323
00:11:10,240 --> 00:11:11,680
wrong it doesn't affect it definitely

324
00:11:11,680 --> 00:11:13,990
isn't the most urgent thing to be fixed

325
00:11:13,990 --> 00:11:15,130
of course because it's not you know like

326
00:11:15,130 --> 00:11:16,570
initial access it's not open to the

327
00:11:16,570 --> 00:11:17,650
internet but it certainly is a

328
00:11:17,650 --> 00:11:19,270
consideration if you're looking to look

329
00:11:19,270 --> 00:11:20,890
at the security of your organization

330
00:11:20,890 --> 00:11:22,900
like a holistic way and actually make

331
00:11:22,900 --> 00:11:24,880
decisions about it and the reason we

332
00:11:24,880 --> 00:11:26,920
don't want Kerberos and a Kerberos thing

333
00:11:26,920 --> 00:11:31,080
is that well yeah I talked about the

334
00:11:31,080 --> 00:11:33,390
service Clinton some of my religious and

335
00:11:33,390 --> 00:11:35,710
Kerberos ticket logs are not stored by

336
00:11:35,710 --> 00:11:37,600
default so unless we actively see a cat

337
00:11:37,600 --> 00:11:39,970
or at least in the 2016 server they're

338
00:11:39,970 --> 00:11:41,650
not so ready for me I'm not sure it's

339
00:11:41,650 --> 00:11:46,540
changed by them the if if you're not

340
00:11:46,540 --> 00:11:48,040
making like the very effort to address

341
00:11:48,040 --> 00:11:49,390
this vulnerability it might go

342
00:11:49,390 --> 00:11:51,100
completely on log there might be like a

343
00:11:51,100 --> 00:11:53,440
maybe a my googley undetected nuts you

344
00:11:53,440 --> 00:11:55,410
know not something you want and

345
00:11:55,410 --> 00:11:57,520
ultimately like the reason why you're

346
00:11:57,520 --> 00:11:58,930
hearing about this here and not on like

347
00:11:58,930 --> 00:12:00,610
a front page headline saying when dues

348
00:12:00,610 --> 00:12:03,730
is broken is that when you and entire

349
00:12:03,730 --> 00:12:05,500
enterprise follows best practices so for

350
00:12:05,500 --> 00:12:07,810
instance we only create services under

351
00:12:07,810 --> 00:12:09,370
managed service accounts which have very

352
00:12:09,370 --> 00:12:10,830
very strong passwords and they're very

353
00:12:10,830 --> 00:12:13,510
unlike an underrated managed services in

354
00:12:13,510 --> 00:12:16,839
a very sensible way or we have you know

355
00:12:16,839 --> 00:12:18,490
a strong password for the account were

356
00:12:18,490 --> 00:12:21,100
creating the service on or we enable the

357
00:12:21,100 --> 00:12:24,339
AES Kerberos encryption which there's

358
00:12:24,339 --> 00:12:25,540
nobody's done because I guess it's

359
00:12:25,540 --> 00:12:27,520
slower and it's it takes time except

360
00:12:27,520 --> 00:12:29,620
runtime so when all those best practices

361
00:12:29,620 --> 00:12:31,870
are followed we don't have to detect

362
00:12:31,870 --> 00:12:32,950
this at all because it's not an issue

363
00:12:32,950 --> 00:12:35,230
right if someone I'll go into how it

364
00:12:35,230 --> 00:12:37,210
works exactly in a second but the point

365
00:12:37,210 --> 00:12:38,850
I'm trying to make here is that

366
00:12:38,850 --> 00:12:41,920
detections don't always have to be okay

367
00:12:41,920 --> 00:12:43,150
we've heard of the detection we detected

368
00:12:43,150 --> 00:12:44,650
all the time it just funds to lower the

369
00:12:44,650 --> 00:12:46,720
risk to the organization so if the

370
00:12:46,720 --> 00:12:48,730
reality is that not all enterprises are

371
00:12:48,730 --> 00:12:50,140
perfect then we should definitely write

372
00:12:50,140 --> 00:12:51,820
rules to the fact what happens when it's

373
00:12:51,820 --> 00:12:53,320
like something slips up or policy isn't

374
00:12:53,320 --> 00:12:56,290
followed or like like an admin makes a

375
00:12:56,290 --> 00:12:59,170
like a fast like a fast fix and then

376
00:12:59,170 --> 00:13:00,459
that fast effect stays there for three

377
00:13:00,459 --> 00:13:03,060
years you know it's like things ago so

378
00:13:03,060 --> 00:13:04,870
in order to understand

379
00:13:04,870 --> 00:13:06,670
Kerberos thing really need to join

380
00:13:06,670 --> 00:13:08,410
Kerberos so hey behavior no site

381
00:13:08,410 --> 00:13:10,670
Kerberos works first

382
00:13:10,670 --> 00:13:14,330
yeah that's so essentially card losses

383
00:13:14,330 --> 00:13:15,590
is a technique based authentication

384
00:13:15,590 --> 00:13:18,260
system and it sorts this is good because

385
00:13:18,260 --> 00:13:21,080
it allows a single sign-on or aid single

386
00:13:21,080 --> 00:13:22,820
sign-on and stops you from just like

387
00:13:22,820 --> 00:13:23,840
something on the network and listening

388
00:13:23,840 --> 00:13:25,760
for like like a client sending a

389
00:13:25,760 --> 00:13:28,370
password to the DC and the most

390
00:13:28,370 --> 00:13:30,710
important thing is essentially the key

391
00:13:30,710 --> 00:13:32,540
distribution center contains three

392
00:13:32,540 --> 00:13:34,010
services the authentication service

393
00:13:34,010 --> 00:13:35,330
which you don't really care about on the

394
00:13:35,330 --> 00:13:37,240
tech a crafting service so when I log in

395
00:13:37,240 --> 00:13:39,560
originally when I log into when there's

396
00:13:39,560 --> 00:13:40,910
enough time to keep myself I'll use the

397
00:13:40,910 --> 00:13:42,710
authentication service do I exist yes my

398
00:13:42,710 --> 00:13:44,450
on the drinking caustic and then they'll

399
00:13:44,450 --> 00:13:47,350
give me a ticket granting ticket once I

400
00:13:47,350 --> 00:13:49,490
log in and using this ticket granting

401
00:13:49,490 --> 00:13:52,730
ticket I can then use that she asked the

402
00:13:52,730 --> 00:13:54,980
key distribution center for a service

403
00:13:54,980 --> 00:13:58,090
ticket for a particular service and the

404
00:13:58,090 --> 00:14:00,230
for the interesting thing about this is

405
00:14:00,230 --> 00:14:05,000
that once the way the service studio

406
00:14:05,000 --> 00:14:07,040
works is I then as a client I will take

407
00:14:07,040 --> 00:14:09,590
that to the to the network resource I'm

408
00:14:09,590 --> 00:14:12,140
not accessing or service or like

409
00:14:12,140 --> 00:14:14,870
resource or whatever and the way they

410
00:14:14,870 --> 00:14:17,090
know that that is legitimate is that

411
00:14:17,090 --> 00:14:19,670
it's encrypted with them secret so like

412
00:14:19,670 --> 00:14:21,530
if I'm in that resource and I know my

413
00:14:21,530 --> 00:14:23,660
passwords password I just use my secret

414
00:14:23,660 --> 00:14:25,580
to decrypt the service ticket and I knew

415
00:14:25,580 --> 00:14:27,260
that that's a legitimate ticket because

416
00:14:27,260 --> 00:14:28,310
I can decrypt it and I can read it

417
00:14:28,310 --> 00:14:31,640
because it's using my secret and the the

418
00:14:31,640 --> 00:14:34,370
key distribution center is she's not

419
00:14:34,370 --> 00:14:36,260
ticket and I trust them so ergo I trust

420
00:14:36,260 --> 00:14:38,270
this thing but the issue with that is

421
00:14:38,270 --> 00:14:41,630
that when we it enables anyone who

422
00:14:41,630 --> 00:14:43,880
requests a service tickets you have

423
00:14:43,880 --> 00:14:46,790
access to that hash or that a secret

424
00:14:46,790 --> 00:14:49,160
sorry and that and in this kiss is the

425
00:14:49,160 --> 00:14:51,710
hush and withhold offsets so anything

426
00:14:51,710 --> 00:14:54,200
before Windows Server 2008 I think would

427
00:14:54,200 --> 00:14:57,020
use a very very old rc4 implementation

428
00:14:57,020 --> 00:14:59,090
of the encryption which means that

429
00:14:59,090 --> 00:15:00,980
cracking them offline isn't particularly

430
00:15:00,980 --> 00:15:03,020
stressful and like that the margin of

431
00:15:03,020 --> 00:15:04,790
where we consider a crack of a password

432
00:15:04,790 --> 00:15:07,640
gustan quite significantly so this is a

433
00:15:07,640 --> 00:15:09,590
although it is only a financial access

434
00:15:09,590 --> 00:15:11,360
this is a very real issue that is quite

435
00:15:11,360 --> 00:15:12,770
it is something that we need to manage

436
00:15:12,770 --> 00:15:15,850
on a detection level as well so

437
00:15:15,850 --> 00:15:18,770
essentially the highest awkward work

438
00:15:18,770 --> 00:15:21,790
with daily Internet users hee-hee

439
00:15:21,790 --> 00:15:24,100
five servers and making it with inside

440
00:15:24,100 --> 00:15:25,240
spi and we've ended up with bits of

441
00:15:25,240 --> 00:15:27,820
PowerShell we can grab the hash from the

442
00:15:27,820 --> 00:15:29,620
service ticket when we request it using

443
00:15:29,620 --> 00:15:31,300
a using some tools or many cuts or

444
00:15:31,300 --> 00:15:33,399
whatever when we can crack it offline

445
00:15:33,399 --> 00:15:37,360
away from front of like obviously the ad

446
00:15:37,360 --> 00:15:38,350
is not going to hear but I definitely

447
00:15:38,350 --> 00:15:39,490
crack it offline because that's

448
00:15:39,490 --> 00:15:41,470
something we can do anywhere and then a

449
00:15:41,470 --> 00:15:44,040
lot we've got credentials provided it's

450
00:15:44,040 --> 00:15:48,699
provided it's um the the password weak

451
00:15:48,699 --> 00:15:51,490
enough so how do we stop this we can

452
00:15:51,490 --> 00:15:53,800
follow up again follow best practices

453
00:15:53,800 --> 00:15:55,060
but that's not really a security

454
00:15:55,060 --> 00:15:56,800
strategy is it is like a pie in the sky

455
00:15:56,800 --> 00:16:00,010
dream so we're gonna have to try and

456
00:16:00,010 --> 00:16:01,870
detect it and then once we spoiled it we

457
00:16:01,870 --> 00:16:04,060
can then take an action to like secure

458
00:16:04,060 --> 00:16:05,529
it then because life software isn't

459
00:16:05,529 --> 00:16:07,959
perfect right so if we create our own

460
00:16:07,959 --> 00:16:09,670
environment with no noise this is gonna

461
00:16:09,670 --> 00:16:11,260
be easy to identify and there are going

462
00:16:11,260 --> 00:16:14,019
to be I am Doug I'm gonna show you how I

463
00:16:14,019 --> 00:16:16,269
built up to essentially either having a

464
00:16:16,269 --> 00:16:20,410
curd car boosting detection but this

465
00:16:20,410 --> 00:16:22,240
isn't going to work realistically in an

466
00:16:22,240 --> 00:16:23,529
enterprise environment with like some

467
00:16:23,529 --> 00:16:26,260
sort of like change to it because again

468
00:16:26,260 --> 00:16:28,089
as I said enterprise's aren't perfect

469
00:16:28,089 --> 00:16:30,100
and that is the the bottle we're dealing

470
00:16:30,100 --> 00:16:31,329
with and that's fine I mean like it's

471
00:16:31,329 --> 00:16:33,310
not like I don't have to wait until

472
00:16:33,310 --> 00:16:34,510
everyone else does their jobs perfectly

473
00:16:34,510 --> 00:16:35,860
and before I can start improving

474
00:16:35,860 --> 00:16:41,970
security so that's no problem generally

475
00:16:41,970 --> 00:16:44,889
the things in an enterprise which will

476
00:16:44,889 --> 00:16:46,569
help searches like this is specifically

477
00:16:46,569 --> 00:16:48,149
with carbo's hang out how to thank

478
00:16:48,149 --> 00:16:52,269
service accounts that that may use a

479
00:16:52,269 --> 00:16:54,880
third-party program to track and like

480
00:16:54,880 --> 00:16:56,410
the unveil with the security of service

481
00:16:56,410 --> 00:16:58,230
accounts so whenever we search for

482
00:16:58,230 --> 00:17:01,240
people requesting Mike tickets there's

483
00:17:01,240 --> 00:17:03,010
going to be a few coins which well an

484
00:17:03,010 --> 00:17:04,689
awful lot more so if we had like some

485
00:17:04,689 --> 00:17:05,650
kind of lock up or some kind of

486
00:17:05,650 --> 00:17:07,089
centralized like repository for these

487
00:17:07,089 --> 00:17:08,140
acquaints region soldier that might

488
00:17:08,140 --> 00:17:09,359
that's no problem

489
00:17:09,359 --> 00:17:12,220
again if she's got an active purple team

490
00:17:12,220 --> 00:17:14,859
or the red team I guess and I'm not sure

491
00:17:14,859 --> 00:17:15,939
I'd like the term purple team but

492
00:17:15,939 --> 00:17:18,970
essentially internally it's all false we

493
00:17:18,970 --> 00:17:20,699
have a team which tests other

494
00:17:20,699 --> 00:17:22,540
departments and then uses that

495
00:17:22,540 --> 00:17:23,859
information to feed back to them and say

496
00:17:23,859 --> 00:17:24,970
hey guys this is what we need to be

497
00:17:24,970 --> 00:17:26,799
doing better as a as a group this is

498
00:17:26,799 --> 00:17:29,410
what we need to be like like having this

499
00:17:29,410 --> 00:17:32,020
setup is bad and then so on and so forth

500
00:17:32,020 --> 00:17:34,059
so again that I'd likely to be covering

501
00:17:34,059 --> 00:17:35,059
so we can filter these are

502
00:17:35,059 --> 00:17:37,730
and a proper threshold for how many

503
00:17:37,730 --> 00:17:39,230
service tickets is too many because if

504
00:17:39,230 --> 00:17:42,110
you've got quite a large ad there's a or

505
00:17:42,110 --> 00:17:44,450
have you if you've got quite a large a

506
00:17:44,450 --> 00:17:45,889
large environment there's going to be

507
00:17:45,889 --> 00:17:48,080
like generally a lot of service tickets

508
00:17:48,080 --> 00:17:52,659
being used so that will specify from

509
00:17:52,659 --> 00:17:55,399
person to person so maybe I'm cookies

510
00:17:55,399 --> 00:17:57,249
not so much time I've got left

511
00:17:57,249 --> 00:18:00,610
building or local testing environment

512
00:18:00,610 --> 00:18:06,320
you like so what's happen to my slides

513
00:18:06,320 --> 00:18:07,730
okay that this isn't sauce down I'm a

514
00:18:07,730 --> 00:18:09,590
little scared though I left the slide

515
00:18:09,590 --> 00:18:11,899
but um essentially what we need to test

516
00:18:11,899 --> 00:18:13,669
this involves a benign controller with a

517
00:18:13,669 --> 00:18:16,039
certain domain a victim privilege

518
00:18:16,039 --> 00:18:17,539
decline with the dodgy easily cracked

519
00:18:17,539 --> 00:18:18,799
password and the reason the husband

520
00:18:18,799 --> 00:18:19,909
privilege is a so we can demonstrate

521
00:18:19,909 --> 00:18:21,440
that this can be used for financial

522
00:18:21,440 --> 00:18:24,470
access for like privilege escalation and

523
00:18:24,470 --> 00:18:26,059
improperly registered service tied to

524
00:18:26,059 --> 00:18:27,230
the victim account with the / password

525
00:18:27,230 --> 00:18:28,909
that we shouldn't do but that's fine and

526
00:18:28,909 --> 00:18:30,769
then on the attacker side we're gonna

527
00:18:30,769 --> 00:18:32,360
need a single when booth client detected

528
00:18:32,360 --> 00:18:34,369
lock connected to others either min I

529
00:18:34,369 --> 00:18:35,809
client the client preferably on

530
00:18:35,809 --> 00:18:37,249
privilege the game to demonstrate the

531
00:18:37,249 --> 00:18:41,950
privilege escalation on spectator so

532
00:18:41,950 --> 00:18:44,749
Ohio nurse we do this well I mean the

533
00:18:44,749 --> 00:18:47,360
setting up locally on your own box is

534
00:18:47,360 --> 00:18:49,039
preferable because I mean I know how

535
00:18:49,039 --> 00:18:50,480
many of your students but certainly as a

536
00:18:50,480 --> 00:18:52,730
student I wouldn't be able to afford AWS

537
00:18:52,730 --> 00:18:54,590
or anything we thought so

538
00:18:54,590 --> 00:18:56,409
when those images are freely available

539
00:18:56,409 --> 00:18:59,419
evaluation copies I'm pretty sure this

540
00:18:59,419 --> 00:19:01,549
includes all on all the new so

541
00:19:01,549 --> 00:19:04,070
everyone's as well it does go back quite

542
00:19:04,070 --> 00:19:05,240
a while so you can't get a copy of

543
00:19:05,240 --> 00:19:07,970
Windows 7 which are either or even

544
00:19:07,970 --> 00:19:11,360
vested to test the the the per and

545
00:19:11,360 --> 00:19:13,879
encryption thing I was talking about so

546
00:19:13,879 --> 00:19:15,110
essentially once you have it if the

547
00:19:15,110 --> 00:19:17,840
images just spend them up and then set

548
00:19:17,840 --> 00:19:19,940
them up stick them on the same internal

549
00:19:19,940 --> 00:19:22,100
network and there's a lot of others and

550
00:19:22,100 --> 00:19:24,889
as far as setting them up goose I'm

551
00:19:24,889 --> 00:19:26,330
quite limited in time here and there's a

552
00:19:26,330 --> 00:19:27,499
lot of people who know a lot more about

553
00:19:27,499 --> 00:19:29,149
ID than I do who can tell you the exact

554
00:19:29,149 --> 00:19:30,499
best practice way to do things and the

555
00:19:30,499 --> 00:19:33,919
reason why things are so again I was

556
00:19:33,919 --> 00:19:35,149
gonna stick the whole Lincoln but if you

557
00:19:35,149 --> 00:19:36,499
literally Google starting up an Active

558
00:19:36,499 --> 00:19:37,850
Directory Law part one that's the first

559
00:19:37,850 --> 00:19:40,220
result and then if you're looking for

560
00:19:40,220 --> 00:19:41,990
home lab guides which specifically point

561
00:19:41,990 --> 00:19:43,490
to Kerberos day and the bite like

562
00:19:43,490 --> 00:19:44,990
setting up massive environments which

563
00:19:44,990 --> 00:19:46,669
like send you their real service traffic

564
00:19:46,669 --> 00:19:47,280
and that sort of

565
00:19:47,280 --> 00:19:49,500
you can pass an actual detection which

566
00:19:49,500 --> 00:19:53,580
takes a lot of time you can go to the

567
00:19:53,580 --> 00:19:56,910
late read blog which is run by my ex boy

568
00:19:56,910 --> 00:20:01,860
2600 and sabi X which here on a great

569
00:20:01,860 --> 00:20:04,740
workshop on this last steel clunk last

570
00:20:04,740 --> 00:20:06,390
year I'm gonna so I shouldn't lose guys

571
00:20:06,390 --> 00:20:10,440
and death sex blog on pen test on blob

572
00:20:10,440 --> 00:20:11,910
which I followed myself which is a great

573
00:20:11,910 --> 00:20:14,010
resource as a few there's a there's a

574
00:20:14,010 --> 00:20:16,650
few really good things on that site and

575
00:20:16,650 --> 00:20:20,580
so again the assuming we've set it up to

576
00:20:20,580 --> 00:20:22,620
use it so we need to find the tools so

577
00:20:22,620 --> 00:20:24,780
again carb roasting is literally just

578
00:20:24,780 --> 00:20:27,540
requesting the service principal name so

579
00:20:27,540 --> 00:20:29,820
whenever I set up a service attached in

580
00:20:29,820 --> 00:20:30,990
a client's if it requires authentication

581
00:20:30,990 --> 00:20:34,440
then on the like a setup and SPN or

582
00:20:34,440 --> 00:20:36,930
service principle then forth so with raw

583
00:20:36,930 --> 00:20:39,360
power shell you can pretty easy pretty

584
00:20:39,360 --> 00:20:42,630
easily a numerate 3 the service prince

585
00:20:42,630 --> 00:20:45,300
william's on with the min and then find

586
00:20:45,300 --> 00:20:46,260
out what your clients are attached to

587
00:20:46,260 --> 00:20:48,510
them and then you can go okay this is a

588
00:20:48,510 --> 00:20:51,510
computer a client because most services

589
00:20:51,510 --> 00:20:53,400
or some services well beyond computer

590
00:20:53,400 --> 00:20:54,870
science which they have strong default

591
00:20:54,870 --> 00:20:56,430
passwords so there are no go so you can

592
00:20:56,430 --> 00:20:58,980
find specifically services running on

593
00:20:58,980 --> 00:21:01,650
user accounts or you can use so these

594
00:21:01,650 --> 00:21:03,990
are these are github so they'd like a V

595
00:21:03,990 --> 00:21:05,550
just like boots backslash Rubeus you'll

596
00:21:05,550 --> 00:21:08,010
find the github page and this is the

597
00:21:08,010 --> 00:21:09,840
latest and greatest kerb roosting

598
00:21:09,840 --> 00:21:13,080
framework Midna C sharp bye bye bye guy

599
00:21:13,080 --> 00:21:15,180
called harm joy he is he knows a lot

600
00:21:15,180 --> 00:21:16,200
about the stuff and there's a lot of

601
00:21:16,200 --> 00:21:17,970
resources about Kerberos and breaking it

602
00:21:17,970 --> 00:21:20,700
and messing with it to attack and then

603
00:21:20,700 --> 00:21:23,790
Nedim hazard has a couple has a couple

604
00:21:23,790 --> 00:21:25,020
of car bursting scripts which are quite

605
00:21:25,020 --> 00:21:26,640
helpful and don't run in c-sharp so here

606
00:21:26,640 --> 00:21:28,110
literally just if you just got the

607
00:21:28,110 --> 00:21:29,550
environment and you just want to run the

608
00:21:29,550 --> 00:21:31,650
script then that's also great for this

609
00:21:31,650 --> 00:21:33,570
also I mean it takes a while to get

610
00:21:33,570 --> 00:21:36,540
working so assuming we do that and

611
00:21:36,540 --> 00:21:39,300
through it we've then got the this is

612
00:21:39,300 --> 00:21:41,370
look like this is the full event windows

613
00:21:41,370 --> 00:21:42,510
is around four seven six nine

614
00:21:42,510 --> 00:21:44,010
but the things you want to pay attention

615
00:21:44,010 --> 00:21:45,390
to or the service information up there

616
00:21:45,390 --> 00:21:47,760
for the service name and then the ticket

617
00:21:47,760 --> 00:21:49,830
options Technic encryption type and fill

618
00:21:49,830 --> 00:21:51,630
you're good so obviously we're not

619
00:21:51,630 --> 00:21:53,640
interested in I requests for tickets

620
00:21:53,640 --> 00:21:57,060
don't feel we're interested in specific

621
00:21:57,060 --> 00:22:00,140
encryption types there and

622
00:22:00,140 --> 00:22:01,850
I didn't put it in the slide but I think

623
00:22:01,850 --> 00:22:06,559
it's 1700 X 12 and I said I think I said

624
00:22:06,559 --> 00:22:08,720
no sure or don't find out I understand -

625
00:22:08,720 --> 00:22:10,730
do you see that the dollar sign that the

626
00:22:10,730 --> 00:22:13,039
service name engine means is associated

627
00:22:13,039 --> 00:22:14,779
with a computer a cranked and thus just

628
00:22:14,779 --> 00:22:16,370
no video so we need to search for

629
00:22:16,370 --> 00:22:17,720
services we shouldn't have that that's

630
00:22:17,720 --> 00:22:21,169
another lemon or we can do sorry on

631
00:22:21,169 --> 00:22:25,279
whose and also a lot of the FFA op I get

632
00:22:25,279 --> 00:22:28,549
if you opt for this welcome of the room

633
00:22:28,549 --> 00:22:38,500
every opts for this logging a lot of the

634
00:22:38,500 --> 00:22:42,049
requests will be for krbtgt which is for

635
00:22:42,049 --> 00:22:43,850
the technical thing service so like

636
00:22:43,850 --> 00:22:46,220
that's not gonna get the car burst and

637
00:22:46,220 --> 00:22:48,320
so we can get that out we can filter out

638
00:22:48,320 --> 00:22:49,850
machine accounts we can felt the right

639
00:22:49,850 --> 00:22:52,730
things which feel and we can look for

640
00:22:52,730 --> 00:22:55,820
the ticket encryption type so once we

641
00:22:55,820 --> 00:22:57,740
this is all still in windows this is all

642
00:22:57,740 --> 00:22:59,149
still it's still in our environments if

643
00:22:59,149 --> 00:23:00,380
you'd also want to set up some sort of

644
00:23:00,380 --> 00:23:02,899
like seam type applications we can talk

645
00:23:02,899 --> 00:23:06,260
about elk very quickly so elk is a busy

646
00:23:06,260 --> 00:23:08,600
elastic stock which is not sufficient my

647
00:23:08,600 --> 00:23:10,010
should always stop using out but

648
00:23:10,010 --> 00:23:14,419
essentially you just did with logs - and

649
00:23:14,419 --> 00:23:21,289
beats yes so essentially beats are they

650
00:23:21,289 --> 00:23:23,000
essentially like like a if anyone's

651
00:23:23,000 --> 00:23:24,019
familiar with Splunk they're essentially

652
00:23:24,019 --> 00:23:25,549
a forwarder there's a different type of

653
00:23:25,549 --> 00:23:26,480
different data and they're all with

654
00:23:26,480 --> 00:23:28,039
different configuration options which i

655
00:23:28,039 --> 00:23:32,419
think is but me and then log starch

656
00:23:32,419 --> 00:23:35,149
takes those logs in and indexes them

657
00:23:35,149 --> 00:23:36,679
correctly and then you can use elastic

658
00:23:36,679 --> 00:23:38,990
search which is a some of the squad

659
00:23:38,990 --> 00:23:40,340
processing language and what she can

660
00:23:40,340 --> 00:23:42,350
search I did it and then Cabana

661
00:23:42,350 --> 00:23:44,210
pits at all in the lovely dashboards a

662
00:23:44,210 --> 00:23:46,250
nice list for you and it also allows you

663
00:23:46,250 --> 00:23:49,130
to set up like similar some of the

664
00:23:49,130 --> 00:23:50,330
things to spawn to which is like

665
00:23:50,330 --> 00:23:53,840
scheduled searches on the large sand so

666
00:23:53,840 --> 00:23:55,340
with this detection

667
00:23:55,340 --> 00:23:57,350
looks something like that and again I

668
00:23:57,350 --> 00:23:58,669
know it's not very visible but we can

669
00:23:58,669 --> 00:24:01,370
see I'm very left the event ID is four

670
00:24:01,370 --> 00:24:04,250
seven six nine it doesn't end in a

671
00:24:04,250 --> 00:24:07,039
dollar sign it is not the ticket

672
00:24:07,039 --> 00:24:11,539
granting service I genuinely camera no

673
00:24:11,539 --> 00:24:13,520
that's another machine name

674
00:24:13,520 --> 00:24:16,910
filter and we know what pass I'm about

675
00:24:16,910 --> 00:24:20,030
the encryption type so it's quite

676
00:24:20,030 --> 00:24:23,059
literally like looking at okay so that's

677
00:24:23,059 --> 00:24:24,559
essentially it so don't try their work

678
00:24:24,559 --> 00:24:25,880
because there's no real support for out

679
00:24:25,880 --> 00:24:28,929
we can use a whole bunch of other ones

680
00:24:28,960 --> 00:24:32,420
essentially you know I didn't I didn't

681
00:24:32,420 --> 00:24:34,150
work without God and I wouldn't ever

682
00:24:34,150 --> 00:24:36,350
like put money on now because of the

683
00:24:36,350 --> 00:24:37,700
crosses for too much essentially the

684
00:24:37,700 --> 00:24:39,500
take away under a Security's pretty

685
00:24:39,500 --> 00:24:41,929
messy Kerberos is scuffed on building a

686
00:24:41,929 --> 00:24:43,280
lab is a great way to spend your time as

687
00:24:43,280 --> 00:24:44,660
it takes you so much of a deep technical

688
00:24:44,660 --> 00:24:46,490
concepts you really have no place to

689
00:24:46,490 --> 00:24:56,750
learn where else any questions hi base

690
00:24:56,750 --> 00:25:03,830
you're the dictionary events one like

691
00:25:03,830 --> 00:25:05,720
edr products like like a y square and

692
00:25:05,720 --> 00:25:09,920
stuff to monitor um I haven't looked at

693
00:25:09,920 --> 00:25:11,360
it I'm far too junior to know from

694
00:25:11,360 --> 00:25:13,970
experience but I would definitely say if

695
00:25:13,970 --> 00:25:16,760
there was a ADR tool and point detection

696
00:25:16,760 --> 00:25:19,010
response tool or something similar which

697
00:25:19,010 --> 00:25:21,620
didn't rely on Windows Windows all the

698
00:25:21,620 --> 00:25:23,450
vents on the agent because a my issue of

699
00:25:23,450 --> 00:25:24,770
these type of things are the agent to

700
00:25:24,770 --> 00:25:26,420
deploy it takes so long and make an

701
00:25:26,420 --> 00:25:27,530
entire environment it's probably not

702
00:25:27,530 --> 00:25:29,390
worth it but I think right at time I did

703
00:25:29,390 --> 00:25:30,860
are be completely at the time sir

704
00:25:30,860 --> 00:25:32,690
okay so thank you so much for your

705
00:25:32,690 --> 00:25:35,380
questions about

