1
00:00:02,560 --> 00:00:04,790
as you already said welcome to our

2
00:00:04,790 --> 00:00:06,470
presentation about the security of

3
00:00:06,470 --> 00:00:09,309
security of a security camera

4
00:00:09,309 --> 00:00:11,870
so about about a year ago actually

5
00:00:11,870 --> 00:00:13,880
during my undergrads I had to do a

6
00:00:13,880 --> 00:00:17,480
project and I decided to analyze an IOT

7
00:00:17,480 --> 00:00:18,950
camera because I thought that's it's a

8
00:00:18,950 --> 00:00:20,570
very it's a recent topic it's

9
00:00:20,570 --> 00:00:24,590
interesting topic and it's becoming more

10
00:00:24,590 --> 00:00:27,800
and more important and so I thought okay

11
00:00:27,800 --> 00:00:30,170
what could be interesting so I chose a

12
00:00:30,170 --> 00:00:33,680
camera and I did actually find some very

13
00:00:33,680 --> 00:00:35,600
interesting stuff which I'm gonna share

14
00:00:35,600 --> 00:00:37,609
with you today so first of all a little

15
00:00:37,609 --> 00:00:40,249
bit about myself as already mentioned my

16
00:00:40,249 --> 00:00:41,899
name is Clarence I'm currently studying

17
00:00:41,899 --> 00:00:44,389
advanced security and digital forensics

18
00:00:44,389 --> 00:00:47,569
at Napier which is a master's course I

19
00:00:47,569 --> 00:00:49,909
am a member of and you say as you can

20
00:00:49,909 --> 00:00:54,049
see and I am also on Twitter if anyone

21
00:00:54,049 --> 00:00:55,429
would follow me I'm not really very

22
00:00:55,429 --> 00:01:01,069
active but yeah alright so let's get to

23
00:01:01,069 --> 00:01:03,220
the interesting part the actual camera

24
00:01:03,220 --> 00:01:06,049
now the camera I used that choice was

25
00:01:06,049 --> 00:01:11,750
the delaying dcs-932l it's marketed or

26
00:01:11,750 --> 00:01:13,730
described by d-link as the complete

27
00:01:13,730 --> 00:01:15,860
surveillance solution for your home or

28
00:01:15,860 --> 00:01:19,870
small office so it's aimed at home use

29
00:01:19,870 --> 00:01:22,100
and what it is is essentially it's a

30
00:01:22,100 --> 00:01:22,970
security camera

31
00:01:22,970 --> 00:01:26,210
it's operated by a web interface which

32
00:01:26,210 --> 00:01:27,770
means it's connected to a network which

33
00:01:27,770 --> 00:01:29,690
is great for us because we can actually

34
00:01:29,690 --> 00:01:31,820
see if we can do something with it

35
00:01:31,820 --> 00:01:35,570
um it has some cool features like motion

36
00:01:35,570 --> 00:01:38,630
detection and email notifications and

37
00:01:38,630 --> 00:01:40,190
especially those email notifications

38
00:01:40,190 --> 00:01:45,200
will become important later on so there

39
00:01:45,200 --> 00:01:46,670
actually there are so many different

40
00:01:46,670 --> 00:01:48,980
camera models especially just from just

41
00:01:48,980 --> 00:01:51,170
from that manufacturer available so

42
00:01:51,170 --> 00:01:52,790
basically the actual decision for this

43
00:01:52,790 --> 00:01:55,520
it was kind of for this device was kind

44
00:01:55,520 --> 00:01:58,370
of random like this he just chose the

45
00:01:58,370 --> 00:02:01,880
one that popped up on Amazon but yeah I

46
00:02:01,880 --> 00:02:03,200
mean it's basically the same thing with

47
00:02:03,200 --> 00:02:06,260
other devices so let's have a look at

48
00:02:06,260 --> 00:02:10,509
the actual web interface of the camera

49
00:02:10,699 --> 00:02:12,319
and you can already see the first

50
00:02:12,319 --> 00:02:17,600
problem it says the browser using may

51
00:02:17,600 --> 00:02:20,840
have difficulties please use Internet

52
00:02:20,840 --> 00:02:23,090
Explorer or Safari now especially for me

53
00:02:23,090 --> 00:02:25,970
as as a Linux user that's not what I

54
00:02:25,970 --> 00:02:28,030
want to hear at all

55
00:02:28,030 --> 00:02:31,790
but and interesting enough this actually

56
00:02:31,790 --> 00:02:34,760
just appeared with the the most recent

57
00:02:34,760 --> 00:02:36,709
version so all over in versions that

58
00:02:36,709 --> 00:02:39,980
that problem did not occur so they

59
00:02:39,980 --> 00:02:41,780
actually changed for the worse in the

60
00:02:41,780 --> 00:02:44,750
recent apple and there isn't update but

61
00:02:44,750 --> 00:02:50,180
um yeah so this is the actual interface

62
00:02:50,180 --> 00:02:53,420
as you can see it's kind of looks kind

63
00:02:53,420 --> 00:02:56,769
of old kind of static um it's not very

64
00:02:56,769 --> 00:02:59,690
it's not very impressive as you can see

65
00:02:59,690 --> 00:03:02,170
it's very straightforward to this menu

66
00:03:02,170 --> 00:03:04,750
you can see the model of the camera and

67
00:03:04,750 --> 00:03:07,040
also you can see basically the heart of

68
00:03:07,040 --> 00:03:09,080
the camera the actual video stream here

69
00:03:09,080 --> 00:03:11,780
on the main page and then there's the

70
00:03:11,780 --> 00:03:12,980
other settings everything user

71
00:03:12,980 --> 00:03:19,910
management and so on on other pages so I

72
00:03:19,910 --> 00:03:22,070
had people look into that interface and

73
00:03:22,070 --> 00:03:24,560
function very interesting floors very

74
00:03:24,560 --> 00:03:27,680
strange things as well but I'm gonna go

75
00:03:27,680 --> 00:03:29,390
through now so basically first of all

76
00:03:29,390 --> 00:03:31,130
and now I'm just gonna go through all

77
00:03:31,130 --> 00:03:33,700
those findings and then I'm gonna

78
00:03:33,700 --> 00:03:38,299
basically present a possible process

79
00:03:38,299 --> 00:03:41,150
that an attacker could use to to use

80
00:03:41,150 --> 00:03:45,340
those flows so the first thing is

81
00:03:45,340 --> 00:03:48,739
encryption the first thing I noticed

82
00:03:48,739 --> 00:03:50,420
when I when I logged into the camera is

83
00:03:50,420 --> 00:03:54,079
um everything on authentication on the

84
00:03:54,079 --> 00:03:56,000
camera is on the web interface he is

85
00:03:56,000 --> 00:03:57,829
done I have basic authentication so you

86
00:03:57,829 --> 00:03:59,329
get that little pop-up and you have to

87
00:03:59,329 --> 00:04:01,250
enter the credentials now basic

88
00:04:01,250 --> 00:04:03,170
authentication on its own doesn't

89
00:04:03,170 --> 00:04:05,780
provide any any hashing or encryption or

90
00:04:05,780 --> 00:04:08,810
whatever of credentials so it's like

91
00:04:08,810 --> 00:04:10,070
that it can be potentially vulnerable

92
00:04:10,070 --> 00:04:12,280
usually it should use at least with

93
00:04:12,280 --> 00:04:14,930
HTTPS to at least make the transit

94
00:04:14,930 --> 00:04:18,350
secure the camera actually does support

95
00:04:18,350 --> 00:04:21,168
HTTPS but it's not enforced so if you

96
00:04:21,168 --> 00:04:22,370
just type in the IP address of the

97
00:04:22,370 --> 00:04:23,750
camera it doesn't redirect you to the

98
00:04:23,750 --> 00:04:24,410
ich

99
00:04:24,410 --> 00:04:28,100
to DPS side so you have to manually type

100
00:04:28,100 --> 00:04:31,730
in HTTP : - - which obviously a lot of

101
00:04:31,730 --> 00:04:32,750
people aren't gonna do because they

102
00:04:32,750 --> 00:04:34,670
don't even know about it so most of the

103
00:04:34,670 --> 00:04:37,430
time the credentials are sent in plain

104
00:04:37,430 --> 00:04:44,530
text which obviously is not a thing also

105
00:04:44,530 --> 00:04:47,030
another bad side effect of that that I

106
00:04:47,030 --> 00:04:49,850
realized was logging out of that camera

107
00:04:49,850 --> 00:04:53,150
is basically impossible honestly there's

108
00:04:53,150 --> 00:04:54,440
a lock out if you look at that there is

109
00:04:54,440 --> 00:04:56,360
a lockout button here it just doesn't do

110
00:04:56,360 --> 00:04:58,400
anything at all it just shows you

111
00:04:58,400 --> 00:05:00,830
something it shows me like we had Europe

112
00:05:00,830 --> 00:05:02,360
being locked out now but doesn't lock

113
00:05:02,360 --> 00:05:05,390
you out doesn't do anything um also

114
00:05:05,390 --> 00:05:07,520
closing the window didn't help closing

115
00:05:07,520 --> 00:05:09,650
the browser didn't help clearing cookies

116
00:05:09,650 --> 00:05:12,470
didn't help what did it in the end was

117
00:05:12,470 --> 00:05:15,080
clearing active sessions from the

118
00:05:15,080 --> 00:05:16,460
history of the browser which is a

119
00:05:16,460 --> 00:05:19,040
setting that I didn't really still

120
00:05:19,040 --> 00:05:20,510
really know if I had to actually look it

121
00:05:20,510 --> 00:05:22,490
up but it is exactly that's the only way

122
00:05:22,490 --> 00:05:24,280
I could actually lock out that camera

123
00:05:24,280 --> 00:05:29,530
which is very strange to say the least

124
00:05:31,580 --> 00:05:33,890
I now want to user accounts and password

125
00:05:33,890 --> 00:05:37,310
guidelines so there are some very bad

126
00:05:37,310 --> 00:05:38,810
design choices there so first of all

127
00:05:38,810 --> 00:05:40,340
there are two two different types of

128
00:05:40,340 --> 00:05:42,110
accounts and there's the admin account

129
00:05:42,110 --> 00:05:43,940
that's always there it's always exactly

130
00:05:43,940 --> 00:05:46,880
one admin account it has full access to

131
00:05:46,880 --> 00:05:48,230
everything on the interface which

132
00:05:48,230 --> 00:05:50,330
basically the video stream and all the

133
00:05:50,330 --> 00:05:53,180
settings and the user name can't be

134
00:05:53,180 --> 00:05:57,230
changed is always admin from and it's

135
00:05:57,230 --> 00:05:59,330
actually within the camera you'll see

136
00:05:59,330 --> 00:06:00,560
that later it's actually handled

137
00:06:00,560 --> 00:06:03,860
differently than the other accounts mm

138
00:06:03,860 --> 00:06:06,440
for that account the password can be

139
00:06:06,440 --> 00:06:09,410
anything between 0 and 32 characters so

140
00:06:09,410 --> 00:06:10,700
you can actually have an empty password

141
00:06:10,700 --> 00:06:13,430
if you want to and you limit it to ASCII

142
00:06:13,430 --> 00:06:14,930
characters so that kind of limits the

143
00:06:14,930 --> 00:06:18,020
key space as well and then there is a

144
00:06:18,020 --> 00:06:20,060
second type which is just a normal user

145
00:06:20,060 --> 00:06:21,710
account or you can have an arbitrary

146
00:06:21,710 --> 00:06:23,840
number of those accounts can be anything

147
00:06:23,840 --> 00:06:26,780
between 0 and I didn't check how many

148
00:06:26,780 --> 00:06:29,110
you can put in but yeah any amount for

149
00:06:29,110 --> 00:06:31,880
these types of accounts the password is

150
00:06:31,880 --> 00:06:34,490
actually limited to 8 characters which

151
00:06:34,490 --> 00:06:37,010
is basically nothing

152
00:06:37,010 --> 00:06:38,840
the minimum should be 8 maybe but not

153
00:06:38,840 --> 00:06:44,420
the maximum so all that means that it's

154
00:06:44,420 --> 00:06:46,100
possible the camera makes it possible

155
00:06:46,100 --> 00:06:47,830
for users to a very weak security

156
00:06:47,830 --> 00:06:50,620
because it doesn't enforce any any

157
00:06:50,620 --> 00:06:55,610
baselines and the thing is people are

158
00:06:55,610 --> 00:06:58,280
going to use weak passwords because it's

159
00:06:58,280 --> 00:06:59,780
the convenient thing they chose they

160
00:06:59,780 --> 00:07:01,070
choose passwords are easy to remember

161
00:07:01,070 --> 00:07:04,730
easy to type in so if the device doesn't

162
00:07:04,730 --> 00:07:07,070
force people to use at least some

163
00:07:07,070 --> 00:07:09,260
security standard people aren't going to

164
00:07:09,260 --> 00:07:12,230
do that because they don't really have a

165
00:07:12,230 --> 00:07:14,660
lot of people that don't really have a

166
00:07:14,660 --> 00:07:17,510
strong sense of security so they can't

167
00:07:17,510 --> 00:07:26,420
they can't judge that another very

168
00:07:26,420 --> 00:07:30,350
strange thing regarding passwords and

169
00:07:30,350 --> 00:07:33,650
user accounts is when you look at the

170
00:07:33,650 --> 00:07:35,750
HTML code of the user management page on

171
00:07:35,750 --> 00:07:39,700
the on the interface you can see that's

172
00:07:39,700 --> 00:07:43,600
the actual of the admin password is

173
00:07:43,600 --> 00:07:47,930
immediately included in that page as the

174
00:07:47,930 --> 00:07:50,840
hash it's just always there even if this

175
00:07:50,840 --> 00:07:52,490
is not even specifically the change

176
00:07:52,490 --> 00:07:54,050
password or anything page it's just

177
00:07:54,050 --> 00:07:56,240
always in the user management page it's

178
00:07:56,240 --> 00:07:58,460
hash so it's not plain text but the hash

179
00:07:58,460 --> 00:08:01,450
is md5 without any salt or anything so

180
00:08:01,450 --> 00:08:08,150
yeah and then it gets better because if

181
00:08:08,150 --> 00:08:12,260
you change the admin password the client

182
00:08:12,260 --> 00:08:14,930
actually saw in the the password the new

183
00:08:14,930 --> 00:08:16,250
password that you put in and the

184
00:08:16,250 --> 00:08:19,580
password that's in here is compared on

185
00:08:19,580 --> 00:08:22,130
the client side in JavaScript and if

186
00:08:22,130 --> 00:08:23,750
they match then the new password

187
00:08:23,750 --> 00:08:26,210
submitted to the server and updated so

188
00:08:26,210 --> 00:08:28,250
there is no control over what's

189
00:08:28,250 --> 00:08:29,270
happening there because obviously if

190
00:08:29,270 --> 00:08:31,850
it's JavaScript the client can change

191
00:08:31,850 --> 00:08:33,559
whatever you wants and do whatever you

192
00:08:33,559 --> 00:08:35,140
want basically

193
00:08:35,140 --> 00:08:38,390
so obviously passwords even if it's just

194
00:08:38,390 --> 00:08:40,700
a hash shouldn't just be included in an

195
00:08:40,700 --> 00:08:44,210
HTML code and logic like that any logic

196
00:08:44,210 --> 00:08:45,320
in general but logic like that

197
00:08:45,320 --> 00:08:47,150
especially should not be on the client

198
00:08:47,150 --> 00:08:51,130
side it should all be on the server

199
00:08:53,449 --> 00:08:56,939
now another thing that's just a bad

200
00:08:56,939 --> 00:09:00,449
design choice for me is um there's this

201
00:09:00,449 --> 00:09:02,970
option in the menu where you can disable

202
00:09:02,970 --> 00:09:06,529
authentication for a specific sub page

203
00:09:06,529 --> 00:09:09,449
and that page so that pages slash image

204
00:09:09,449 --> 00:09:13,769
JPEG or CGI and if you access that it

205
00:09:13,769 --> 00:09:16,259
gives you like a snapshot as an image

206
00:09:16,259 --> 00:09:18,569
off the video stream so you can't

207
00:09:18,569 --> 00:09:20,749
actually disable authentication for that

208
00:09:20,749 --> 00:09:24,269
which I don't really see the use case

209
00:09:24,269 --> 00:09:26,249
for that because as I said this camera

210
00:09:26,249 --> 00:09:28,290
is meant for home use and maybe small

211
00:09:28,290 --> 00:09:30,569
offices so there's no really a use case

212
00:09:30,569 --> 00:09:33,869
for having for having a public I'm

213
00:09:33,869 --> 00:09:36,209
public image base or elect public video

214
00:09:36,209 --> 00:09:39,269
stream and the thing is you could say

215
00:09:39,269 --> 00:09:42,209
yeah so just don't enable it but again

216
00:09:42,209 --> 00:09:44,489
if there's the option to have a market

217
00:09:44,489 --> 00:09:45,779
if there's an option that's more

218
00:09:45,779 --> 00:09:47,399
convenient a lot of people are going to

219
00:09:47,399 --> 00:09:50,040
use that without thinking about that

220
00:09:50,040 --> 00:09:52,350
they might actually give random people

221
00:09:52,350 --> 00:09:55,649
on the internet access to their camera

222
00:09:55,649 --> 00:10:02,160
feed is it Kenya it encourages users to

223
00:10:02,160 --> 00:10:08,129
to reduce our own security level now

224
00:10:08,129 --> 00:10:09,449
let's look at something that's an actual

225
00:10:09,449 --> 00:10:12,019
bucket not just a bad design choice I

226
00:10:12,019 --> 00:10:14,910
realized that while I was playing around

227
00:10:14,910 --> 00:10:17,610
with the different pages that some of

228
00:10:17,610 --> 00:10:19,619
the pages on the web server didn't ask

229
00:10:19,619 --> 00:10:21,059
for any authentication they just

230
00:10:21,059 --> 00:10:23,189
immediately gave me requests forbidden

231
00:10:23,189 --> 00:10:24,869
when I tried to access them I just

232
00:10:24,869 --> 00:10:27,089
couldn't even put in any credentials and

233
00:10:27,089 --> 00:10:28,980
I seemed strange to me because I expect

234
00:10:28,980 --> 00:10:30,749
to get at least the usual basic

235
00:10:30,749 --> 00:10:32,879
authentication pop up asking for

236
00:10:32,879 --> 00:10:34,619
credentials but I didn't I just got

237
00:10:34,619 --> 00:10:37,410
nothing and especially one of those

238
00:10:37,410 --> 00:10:40,410
files this one years after CGI slash

239
00:10:40,410 --> 00:10:42,569
common that CGI kind of look interesting

240
00:10:42,569 --> 00:10:46,139
to me and so I kind of wanted to see

241
00:10:46,139 --> 00:10:46,739
what's in there

242
00:10:46,739 --> 00:10:50,009
and after trying a few things basically

243
00:10:50,009 --> 00:10:52,259
actually just by chance I found out that

244
00:10:52,259 --> 00:10:54,899
um when I intercepted the request and

245
00:10:54,899 --> 00:10:55,949
added a referrer

246
00:10:55,949 --> 00:10:59,730
to the HTTP request it suddenly worked I

247
00:10:59,730 --> 00:11:00,990
could access

248
00:11:00,990 --> 00:11:03,330
Paige and that refer is completely

249
00:11:03,330 --> 00:11:05,100
arbitrary it can be any string the only

250
00:11:05,100 --> 00:11:07,800
thing that matters is that it says refer

251
00:11:07,800 --> 00:11:09,510
that the field is in the header you can

252
00:11:09,510 --> 00:11:10,890
even leave it empty if you want to it

253
00:11:10,890 --> 00:11:12,480
just has to be there and then it

254
00:11:12,480 --> 00:11:15,029
suddenly worked and I could get this

255
00:11:15,029 --> 00:11:17,130
file here and then I saw actually yeah

256
00:11:17,130 --> 00:11:19,470
the file it is actually in in fact very

257
00:11:19,470 --> 00:11:23,730
interesting because there's some cool

258
00:11:23,730 --> 00:11:25,440
information about the camera that you

259
00:11:25,440 --> 00:11:27,320
normally wouldn't have or shouldn't have

260
00:11:27,320 --> 00:11:30,089
definitely shouldn't have so this could

261
00:11:30,089 --> 00:11:31,589
be an excellent source for recon as well

262
00:11:31,589 --> 00:11:34,200
so you have this you have the model and

263
00:11:34,200 --> 00:11:38,520
firmware and firmware version build Burt

264
00:11:38,520 --> 00:11:41,360
build number harder version as well

265
00:11:41,360 --> 00:11:43,950
there's a field called location that the

266
00:11:43,950 --> 00:11:48,360
user can set if if they weren't so it's

267
00:11:48,360 --> 00:11:49,709
not always going to be set like in my

268
00:11:49,709 --> 00:11:51,240
case I mean this is for my camera I

269
00:11:51,240 --> 00:11:55,080
didn't set it but if it's if there's

270
00:11:55,080 --> 00:11:56,550
something in there it might give you a

271
00:11:56,550 --> 00:11:58,230
clue as to what where the camera is

272
00:11:58,230 --> 00:12:00,270
maybe which room it is or something like

273
00:12:00,270 --> 00:12:03,720
that if it's in someone's house and last

274
00:12:03,720 --> 00:12:05,940
but not least there's some network

275
00:12:05,940 --> 00:12:07,200
information as well so you have the IP

276
00:12:07,200 --> 00:12:09,000
address off the camera you have the

277
00:12:09,000 --> 00:12:10,410
netmask and you have the IP address of

278
00:12:10,410 --> 00:12:12,750
the router so you get a basic idea of of

279
00:12:12,750 --> 00:12:15,899
the topology of the network that the

280
00:12:15,899 --> 00:12:17,220
camera is in which is also very

281
00:12:17,220 --> 00:12:19,079
interesting and something before

282
00:12:19,079 --> 00:12:31,200
necessarily so after looking around

283
00:12:31,200 --> 00:12:32,750
looking around for a while

284
00:12:32,750 --> 00:12:36,420
ocula go back for a second um so after

285
00:12:36,420 --> 00:12:38,730
looking around in that CGI a folder for

286
00:12:38,730 --> 00:12:40,020
a while that I mentioned where that

287
00:12:40,020 --> 00:12:42,180
combat CGI file was in I noticed there

288
00:12:42,180 --> 00:12:44,370
are some other interesting looking files

289
00:12:44,370 --> 00:12:46,440
in there as well files that were called

290
00:12:46,440 --> 00:12:48,660
something like system that CGI or user

291
00:12:48,660 --> 00:12:52,020
list of CGI unfortunately I couldn't I

292
00:12:52,020 --> 00:12:53,760
couldn't use the same trick I'd used

293
00:12:53,760 --> 00:12:55,050
before like the Rivera it didn't work

294
00:12:55,050 --> 00:12:58,770
but I figure out that if you actually

295
00:12:58,770 --> 00:13:01,950
lock into the camera and then use the

296
00:13:01,950 --> 00:13:03,450
referrer as well so you need those two

297
00:13:03,450 --> 00:13:08,160
things then you can access them and now

298
00:13:08,160 --> 00:13:11,610
let's have a look at those files so you

299
00:13:11,610 --> 00:13:14,230
can already see the big big problem here

300
00:13:14,230 --> 00:13:17,140
password password password all the clear

301
00:13:17,140 --> 00:13:18,970
tracks nothing hashed all in clear in

302
00:13:18,970 --> 00:13:22,390
plain text in the camera so as you can

303
00:13:22,390 --> 00:13:24,160
see ya you have the admin password in

304
00:13:24,160 --> 00:13:26,980
here and that's why I meant when I said

305
00:13:26,980 --> 00:13:28,930
that those two accounts are those two

306
00:13:28,930 --> 00:13:30,010
types of accounts are handled

307
00:13:30,010 --> 00:13:31,540
differently so if the athlete that's

308
00:13:31,540 --> 00:13:33,760
managed in here in systems of CGI and

309
00:13:33,760 --> 00:13:35,770
you have all the other normal users with

310
00:13:35,770 --> 00:13:39,850
their passwords also in plain text and

311
00:13:39,850 --> 00:13:43,630
then there's this thing here emails so I

312
00:13:43,630 --> 00:13:44,560
mentioned earlier you have email

313
00:13:44,560 --> 00:13:46,240
notifications you can enable email

314
00:13:46,240 --> 00:13:50,550
notifications if if the motion detector

315
00:13:50,550 --> 00:13:54,400
detects motion then you can have the

316
00:13:54,400 --> 00:13:58,540
camera send you an email with a short

317
00:13:58,540 --> 00:14:02,590
bit of video to alert you so to do that

318
00:14:02,590 --> 00:14:04,350
to be able to do that the camera needs

319
00:14:04,350 --> 00:14:07,270
an existing email account to send those

320
00:14:07,270 --> 00:14:09,340
emails from and you have to put

321
00:14:09,340 --> 00:14:11,290
credentials in for that so what you can

322
00:14:11,290 --> 00:14:12,730
see here is exactly that you have the

323
00:14:12,730 --> 00:14:13,600
email account

324
00:14:13,600 --> 00:14:15,840
you have the username which is usually

325
00:14:15,840 --> 00:14:18,640
count as well and you have the password

326
00:14:18,640 --> 00:14:22,140
for that email account which is visible

327
00:14:22,140 --> 00:14:24,460
which you also shouldn't really get that

328
00:14:24,460 --> 00:14:27,850
easily now quick reminder it's not

329
00:14:27,850 --> 00:14:30,850
actually that bad because as I said you

330
00:14:30,850 --> 00:14:32,260
have to be logged in as the admin user

331
00:14:32,260 --> 00:14:35,200
so you not anyone can just see that but

332
00:14:35,200 --> 00:14:37,590
still just the fact that all those

333
00:14:37,590 --> 00:14:39,550
passwords and everything are stored in

334
00:14:39,550 --> 00:14:41,950
plain text there just shows that the

335
00:14:41,950 --> 00:14:43,890
developers they just didn't have any

336
00:14:43,890 --> 00:14:47,140
awareness for security whatsoever so the

337
00:14:47,140 --> 00:14:51,030
whole back-end is flawed in that sense

338
00:14:52,470 --> 00:14:58,450
and we can use that so basically let's

339
00:14:58,450 --> 00:15:01,390
go through a possible way to exploit the

340
00:15:01,390 --> 00:15:03,580
stuff that I showed before so obviously

341
00:15:03,580 --> 00:15:05,770
it starts with getting the IP address

342
00:15:05,770 --> 00:15:09,670
the address of the actual camera that

343
00:15:09,670 --> 00:15:12,640
you want to attack or just eat them so

344
00:15:12,640 --> 00:15:13,960
either you have a specific camera that

345
00:15:13,960 --> 00:15:17,380
you already know the s you add the IP

346
00:15:17,380 --> 00:15:19,330
address off because you know exactly

347
00:15:19,330 --> 00:15:21,160
what it is or because you found it

348
00:15:21,160 --> 00:15:23,170
during recon or something or you could

349
00:15:23,170 --> 00:15:28,060
just or an attacker could just ran

350
00:15:28,060 --> 00:15:29,710
you choose a camera that you can find

351
00:15:29,710 --> 00:15:31,630
them very easily on showdown for example

352
00:15:31,630 --> 00:15:33,250
for example you can find thousands of

353
00:15:33,250 --> 00:15:36,720
cameras I'll get to that later as well

354
00:15:36,720 --> 00:15:39,370
know now that you have the IP address

355
00:15:39,370 --> 00:15:41,950
what you can do is you can brute force a

356
00:15:41,950 --> 00:15:42,460
password

357
00:15:42,460 --> 00:15:44,440
we know that the admin account always

358
00:15:44,440 --> 00:15:45,790
has the same username so we don't have

359
00:15:45,790 --> 00:15:47,650
to guess anything with that and we know

360
00:15:47,650 --> 00:15:50,290
that the password is potentially quite

361
00:15:50,290 --> 00:15:52,600
weak so we can't read brute force I

362
00:15:52,600 --> 00:15:55,720
wrote I wrote a little very little proof

363
00:15:55,720 --> 00:15:58,120
of concept script that basically just

364
00:15:58,120 --> 00:16:00,640
goes through the list of 100 most common

365
00:16:00,640 --> 00:16:03,010
passwords until and tries to locking

366
00:16:03,010 --> 00:16:05,980
with those until it gets status 200 so a

367
00:16:05,980 --> 00:16:08,830
successful login and then just prints

368
00:16:08,830 --> 00:16:11,980
the password obviously this can be made

369
00:16:11,980 --> 00:16:14,140
a lot more sophisticated this is just to

370
00:16:14,140 --> 00:16:16,150
show to show my point

371
00:16:16,150 --> 00:16:20,320
I could paralyze it and so on all right

372
00:16:20,320 --> 00:16:22,600
now after getting that password which

373
00:16:22,600 --> 00:16:24,040
obviously depending on the password

374
00:16:24,040 --> 00:16:25,780
depending on the password might not be

375
00:16:25,780 --> 00:16:28,210
that easy but it will be in a lot of

376
00:16:28,210 --> 00:16:30,640
case in love the cases with that

377
00:16:30,640 --> 00:16:32,260
password you can now log in and

378
00:16:32,260 --> 00:16:34,960
basically you already lost so what you

379
00:16:34,960 --> 00:16:36,580
can do is you can get the video stream

380
00:16:36,580 --> 00:16:39,580
for example so my script just takes that

381
00:16:39,580 --> 00:16:42,420
snapshot / image the one I showed before

382
00:16:42,420 --> 00:16:46,240
second stash image starts as well /

383
00:16:46,240 --> 00:16:49,630
image / jpg dot CGI just download that

384
00:16:49,630 --> 00:16:51,700
file add a snapshot as cheap as a JPEG

385
00:16:51,700 --> 00:16:54,640
you could also just get a whole stream

386
00:16:54,640 --> 00:16:56,110
if you wanted to if you just add those

387
00:16:56,110 --> 00:16:57,610
pictures together because you just

388
00:16:57,610 --> 00:17:01,120
reload if you want to and then the last

389
00:17:01,120 --> 00:17:03,310
thing or the second to last thing you do

390
00:17:03,310 --> 00:17:05,680
is use that trick with what's your

391
00:17:05,680 --> 00:17:07,270
locked in you can add a refer to your

392
00:17:07,270 --> 00:17:10,030
request and you can get the email

393
00:17:10,030 --> 00:17:11,859
credentials from the email don't CGI

394
00:17:11,859 --> 00:17:15,540
file now once you have those credentials

395
00:17:15,540 --> 00:17:18,819
you can login to that person's email

396
00:17:18,819 --> 00:17:20,200
account so you have something like that

397
00:17:20,200 --> 00:17:24,400
now this is basically to do that to try

398
00:17:24,400 --> 00:17:26,530
it out if or if it's all working I just

399
00:17:26,530 --> 00:17:29,560
set up set up a demo account on a demo

400
00:17:29,560 --> 00:17:31,600
gmail account set up on the camera just

401
00:17:31,600 --> 00:17:33,130
to go through the whole thing so that's

402
00:17:33,130 --> 00:17:35,710
basically you have super secret messages

403
00:17:35,710 --> 00:17:38,410
private messages what's or whatever that

404
00:17:38,410 --> 00:17:41,570
you can access so now what you have is

405
00:17:41,570 --> 00:17:45,300
when you have this we went from just

406
00:17:45,300 --> 00:17:47,130
knowing the IP address or just knowing

407
00:17:47,130 --> 00:17:50,510
that the camera is there we went to

408
00:17:50,510 --> 00:17:52,730
having a view into someone's home and

409
00:17:52,730 --> 00:17:55,350
the video feed and someone's email

410
00:17:55,350 --> 00:17:58,110
account within a very short amount of

411
00:17:58,110 --> 00:17:59,910
time and that's even more concerning

412
00:17:59,910 --> 00:18:03,360
what's even more concerning is that the

413
00:18:03,360 --> 00:18:05,670
script I use is less than 30 lines long

414
00:18:05,670 --> 00:18:08,010
it's not very complicated it's quite a

415
00:18:08,010 --> 00:18:10,590
simple script and it really doesn't take

416
00:18:10,590 --> 00:18:14,490
long either to do it um so that's you

417
00:18:14,490 --> 00:18:17,580
can see howhow that's very bad design

418
00:18:17,580 --> 00:18:22,980
there on the camera I know let's talk

419
00:18:22,980 --> 00:18:26,750
about firmware versions for a minute so

420
00:18:26,750 --> 00:18:29,610
as I mentioned the original research I

421
00:18:29,610 --> 00:18:31,950
did was a while ago a year ago in

422
00:18:31,950 --> 00:18:35,400
January 2018 actually so the version I

423
00:18:35,400 --> 00:18:37,650
used back then the version I pasted this

424
00:18:37,650 --> 00:18:40,980
whole talk on was 2.1 for since then

425
00:18:40,980 --> 00:18:43,530
there were two updates to point one six

426
00:18:43,530 --> 00:18:47,429
and one seven that fixed most of the

427
00:18:47,429 --> 00:18:49,200
problems that I mentioned basically all

428
00:18:49,200 --> 00:18:52,920
of them and therefore make basically

429
00:18:52,920 --> 00:18:54,540
make the attack impossible so you can't

430
00:18:54,540 --> 00:18:56,850
get any passwords anymore at least with

431
00:18:56,850 --> 00:19:00,120
at least with that method so that's good

432
00:19:00,120 --> 00:19:03,240
news generally however as far as I could

433
00:19:03,240 --> 00:19:05,640
tell I briefly looked at at the new

434
00:19:05,640 --> 00:19:10,200
version and I think the the back end

435
00:19:10,200 --> 00:19:11,490
hasn't changed at all so the passwords

436
00:19:11,490 --> 00:19:13,590
are still stored in plain text you just

437
00:19:13,590 --> 00:19:16,230
can't access them that easy anymore

438
00:19:16,230 --> 00:19:18,900
but I'm sure there's still a way to do

439
00:19:18,900 --> 00:19:23,429
that if you look hard enough so it's

440
00:19:23,429 --> 00:19:25,980
just I mean they did at least address

441
00:19:25,980 --> 00:19:28,080
the problem and generally make this

442
00:19:28,080 --> 00:19:31,260
offer better even if the general core is

443
00:19:31,260 --> 00:19:33,360
still flawed but you know take what you

444
00:19:33,360 --> 00:19:38,100
get now you could think okay

445
00:19:38,100 --> 00:19:39,570
everything's fine the issues affects

446
00:19:39,570 --> 00:19:45,540
mostly devices kind of secure however if

447
00:19:45,540 --> 00:19:48,179
you look at that I just made a little

448
00:19:48,179 --> 00:19:50,790
graph of different than the firmware

449
00:19:50,790 --> 00:19:52,380
versions that I could find in the wild

450
00:19:52,380 --> 00:19:54,999
actually basically today

451
00:19:54,999 --> 00:19:57,759
so these are versions so as you can see

452
00:19:57,759 --> 00:20:00,249
these are very old versions in some

453
00:20:00,249 --> 00:20:02,409
cases very very old and so you can see

454
00:20:02,409 --> 00:20:03,940
there are a lot of hundreds of devices

455
00:20:03,940 --> 00:20:07,479
there with very old versions with some

456
00:20:07,479 --> 00:20:09,309
of those versions actually still have a

457
00:20:09,309 --> 00:20:11,590
lot more vulnerabilities like c'mon

458
00:20:11,590 --> 00:20:13,539
Jackson's and stuff like that they can

459
00:20:13,539 --> 00:20:19,599
use to do even more and I so I got that

460
00:20:19,599 --> 00:20:22,090
graph by searching for the for that

461
00:20:22,090 --> 00:20:24,759
specific device model on Showdown and

462
00:20:24,759 --> 00:20:26,830
then I got a list of all the IP

463
00:20:26,830 --> 00:20:29,109
addresses and then I got the versions

464
00:20:29,109 --> 00:20:33,639
from that to assess that so these are

465
00:20:33,639 --> 00:20:35,950
only devices that are available on the

466
00:20:35,950 --> 00:20:38,099
internet accessible on the internet

467
00:20:38,099 --> 00:20:40,899
because obviously I can't get any info

468
00:20:40,899 --> 00:20:43,299
on devices that are in local in local

469
00:20:43,299 --> 00:20:46,960
networks without committing a crime but

470
00:20:46,960 --> 00:20:49,979
I'm guessing it's going to be the same

471
00:20:49,979 --> 00:20:53,080
with these cameras as well I don't think

472
00:20:53,080 --> 00:20:56,229
there are going to be more more recent

473
00:20:56,229 --> 00:20:59,169
versions and there's a reason why there

474
00:20:59,169 --> 00:21:01,090
are so many very old version still

475
00:21:01,090 --> 00:21:02,559
around for that and I'm going to come to

476
00:21:02,559 --> 00:21:06,909
that in a minute because another thing

477
00:21:06,909 --> 00:21:08,320
you have to take nakhon which makes this

478
00:21:08,320 --> 00:21:10,659
far worse is there are a lot of

479
00:21:10,659 --> 00:21:12,549
different models for that camera so

480
00:21:12,549 --> 00:21:13,869
these are just fourteen different ones

481
00:21:13,869 --> 00:21:15,669
where we're know for sure that they use

482
00:21:15,669 --> 00:21:19,029
the same firmware I just found those by

483
00:21:19,029 --> 00:21:20,739
looking through the specs on delay

484
00:21:20,739 --> 00:21:24,999
support website actually there's a much

485
00:21:24,999 --> 00:21:27,419
largest larger attack surface there are

486
00:21:27,419 --> 00:21:31,539
just in that TCS model series there are

487
00:21:31,539 --> 00:21:33,249
about a hundred and twenty different

488
00:21:33,249 --> 00:21:35,999
models a lot of which are going to use

489
00:21:35,999 --> 00:21:38,889
that firm way up with slight variations

490
00:21:38,889 --> 00:21:42,070
depending on their features but there

491
00:21:42,070 --> 00:21:43,840
are definitely a lot a lot more devices

492
00:21:43,840 --> 00:21:46,179
than what I showed in that graph in the

493
00:21:46,179 --> 00:21:49,979
wild on the internet accessible and

494
00:21:49,979 --> 00:22:01,269
vulnerable right so basically this

495
00:22:01,269 --> 00:22:02,889
camera is just another example that

496
00:22:02,889 --> 00:22:05,559
shows how far away from being secure a

497
00:22:05,559 --> 00:22:08,230
lot of IOT

498
00:22:08,230 --> 00:22:10,390
smart-home devices are nowadays because

499
00:22:10,390 --> 00:22:12,070
you read about it all the time you hear

500
00:22:12,070 --> 00:22:13,390
in other talks something that where

501
00:22:13,390 --> 00:22:14,710
people just find horrible

502
00:22:14,710 --> 00:22:17,350
vulnerabilities in devices like that and

503
00:22:17,350 --> 00:22:19,480
it's especially bad for this kind of

504
00:22:19,480 --> 00:22:21,730
device because they potentially give an

505
00:22:21,730 --> 00:22:25,780
attacker such insight into a person's

506
00:22:25,780 --> 00:22:27,460
personal life

507
00:22:27,460 --> 00:22:30,850
much more than other devices which is

508
00:22:30,850 --> 00:22:33,760
very concerning and now for me there are

509
00:22:33,760 --> 00:22:35,980
kind of three big lessons that come from

510
00:22:35,980 --> 00:22:39,370
lessons or mitigation strategies that

511
00:22:39,370 --> 00:22:42,309
user can employ to kind of try and make

512
00:22:42,309 --> 00:22:44,020
these at least try and make the devices

513
00:22:44,020 --> 00:22:46,809
a lot a lot more secure even though the

514
00:22:46,809 --> 00:22:49,530
device as such might not be as secure

515
00:22:49,530 --> 00:22:53,830
and now this is kind of I mean most of

516
00:22:53,830 --> 00:22:55,840
that is known I just wanted to get it

517
00:22:55,840 --> 00:22:58,510
out as again so the first is obviously

518
00:22:58,510 --> 00:23:01,080
strong passwords long passwords

519
00:23:01,080 --> 00:23:03,070
especially in this case for the admin

520
00:23:03,070 --> 00:23:04,900
user because the name can't be changed

521
00:23:04,900 --> 00:23:06,549
so this only the password has to be

522
00:23:06,549 --> 00:23:10,390
guessed that's the thing about the

523
00:23:10,390 --> 00:23:12,640
camera about this camera it allows bad

524
00:23:12,640 --> 00:23:15,190
passwords and as I said that's it's

525
00:23:15,190 --> 00:23:16,630
convenient so people are going to do

526
00:23:16,630 --> 00:23:18,490
that so there needs to be a lot more

527
00:23:18,490 --> 00:23:20,440
awareness on password security on both

528
00:23:20,440 --> 00:23:22,660
the developers side and the user side

529
00:23:22,660 --> 00:23:26,530
and the second thing is regular updates

530
00:23:26,530 --> 00:23:30,940
and I mentioned there's a reason for why

531
00:23:30,940 --> 00:23:32,530
there are so many old versions it's

532
00:23:32,530 --> 00:23:35,020
because the cap the camera or dealing

533
00:23:35,020 --> 00:23:37,690
couldn't possibly have made it harder to

534
00:23:37,690 --> 00:23:39,940
update the firmware so first of all

535
00:23:39,940 --> 00:23:41,860
there are no notifications if the

536
00:23:41,860 --> 00:23:43,570
viewers miss out whatsoever so you have

537
00:23:43,570 --> 00:23:45,250
to check the support website regularly

538
00:23:45,250 --> 00:23:47,740
and what you have to do is you have to

539
00:23:47,740 --> 00:23:49,540
go to the support website choose your

540
00:23:49,540 --> 00:23:51,490
model off your camera choose your

541
00:23:51,490 --> 00:23:53,230
hardware version which is somewhere on

542
00:23:53,230 --> 00:23:55,720
this code here on the back so you have

543
00:23:55,720 --> 00:23:59,470
to find out I'll find that out then you

544
00:23:59,470 --> 00:24:02,530
have to download the the firmware binary

545
00:24:02,530 --> 00:24:03,669
and you have to upload it on the

546
00:24:03,669 --> 00:24:05,440
interface of the camera and then you can

547
00:24:05,440 --> 00:24:07,870
install it so it's such a long process

548
00:24:07,870 --> 00:24:09,730
that a user that's not that doesn't

549
00:24:09,730 --> 00:24:11,950
really know about tech it's definitely

550
00:24:11,950 --> 00:24:14,400
not going to do at least not regularly

551
00:24:14,400 --> 00:24:16,960
which explains why there are so many

552
00:24:16,960 --> 00:24:19,900
very very old versions around

553
00:24:19,900 --> 00:24:22,060
if something some cases people might not

554
00:24:22,060 --> 00:24:24,660
even know that there are updates at all

555
00:24:24,660 --> 00:24:28,390
and so again there needs to be this this

556
00:24:28,390 --> 00:24:31,090
process should be a lot easier it should

557
00:24:31,090 --> 00:24:32,890
be straightforward there should be

558
00:24:32,890 --> 00:24:34,630
notifications it should basically just

559
00:24:34,630 --> 00:24:37,080
pop up and say there's a new update

560
00:24:37,080 --> 00:24:40,870
installed please and number three

561
00:24:40,870 --> 00:24:43,960
probably the biggest one do not make

562
00:24:43,960 --> 00:24:45,730
your devices available on the Internet

563
00:24:45,730 --> 00:24:49,960
I saw the the basic the first search and

564
00:24:49,960 --> 00:24:51,790
show diet for that specific model showed

565
00:24:51,790 --> 00:24:53,920
me about more than six thousand devices

566
00:24:53,920 --> 00:24:56,920
and that's just one model out of 120 and

567
00:24:56,920 --> 00:24:59,230
that's just one series of models so a

568
00:24:59,230 --> 00:25:01,690
lot of devices are just available on the

569
00:25:01,690 --> 00:25:03,840
internet and love them are vulnerable to

570
00:25:03,840 --> 00:25:10,290
some variations of different flaws so

571
00:25:10,290 --> 00:25:13,200
don't there's there's two sides to that

572
00:25:13,200 --> 00:25:16,180
because on the one hand it obviously if

573
00:25:16,180 --> 00:25:18,280
the camera is if the cameras bad

574
00:25:18,280 --> 00:25:20,620
then it might be hacked and you have

575
00:25:20,620 --> 00:25:23,110
especially I personal info that sleeps

576
00:25:23,110 --> 00:25:26,470
or email accounts or video streams or

577
00:25:26,470 --> 00:25:29,080
stuff like that but also it can be kind

578
00:25:29,080 --> 00:25:30,610
of a way in for a hacker into your

579
00:25:30,610 --> 00:25:32,680
network in some cases depending on the

580
00:25:32,680 --> 00:25:35,380
vulnerabilities so you can compromise

581
00:25:35,380 --> 00:25:37,270
your whole network and with people

582
00:25:37,270 --> 00:25:38,950
having more and more different devices

583
00:25:38,950 --> 00:25:41,710
that the tech services just gets a lot

584
00:25:41,710 --> 00:25:43,170
bigger if you have those available

585
00:25:43,170 --> 00:25:45,640
accessible on the Internet so if you

586
00:25:45,640 --> 00:25:48,370
actually need to for some reason access

587
00:25:48,370 --> 00:25:52,420
that outside of your local network just

588
00:25:52,420 --> 00:25:54,940
use a VPN which again obviously I get is

589
00:25:54,940 --> 00:25:57,910
a problem for normal users like non tech

590
00:25:57,910 --> 00:26:00,550
users because again it's not that easy

591
00:26:00,550 --> 00:26:02,140
to just set up it is getting easier

592
00:26:02,140 --> 00:26:04,990
nowadays but that it's it's an ongoing

593
00:26:04,990 --> 00:26:07,300
thing to make that easier for for

594
00:26:07,300 --> 00:26:12,340
everyone and that's all for me I hope

595
00:26:12,340 --> 00:26:13,960
you enjoyed it thank you for listening

596
00:26:13,960 --> 00:26:17,020
and thank you so any sec for giving me

597
00:26:17,020 --> 00:26:19,510
the opportunity to do this my first ever

598
00:26:19,510 --> 00:26:20,760
conference talk here

599
00:26:20,760 --> 00:26:23,879
[Music]

