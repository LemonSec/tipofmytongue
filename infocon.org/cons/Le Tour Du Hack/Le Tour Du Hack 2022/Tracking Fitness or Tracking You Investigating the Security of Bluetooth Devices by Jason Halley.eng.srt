1
00:00:05,040 --> 00:00:07,359
right um afternoon everyone and welcome

2
00:00:07,359 --> 00:00:09,200
uh as is quite obvious i think we're

3
00:00:09,200 --> 00:00:10,400
going to be talking about the security

4
00:00:10,400 --> 00:00:13,360
of fitness tracking devices i.e

5
00:00:13,360 --> 00:00:14,719
fitbits

6
00:00:14,719 --> 00:00:17,199
and apple watchers and the smart

7
00:00:17,199 --> 00:00:19,359
watchers and the cheaper sort of fitness

8
00:00:19,359 --> 00:00:21,520
only trackers just out of curiosity can

9
00:00:21,520 --> 00:00:23,600
i show our hands who owns some kind of

10
00:00:23,600 --> 00:00:25,279
smart watch or fitness tracker that they

11
00:00:25,279 --> 00:00:26,800
use

12
00:00:26,800 --> 00:00:28,960
almost all of you that's that's

13
00:00:28,960 --> 00:00:30,240
interesting i wonder how many of you

14
00:00:30,240 --> 00:00:31,920
will want to keep using it when we

15
00:00:31,920 --> 00:00:33,200
finished

16
00:00:33,200 --> 00:00:36,320
but uh just briefly on who i am my

17
00:00:36,320 --> 00:00:38,000
name's jason haley as you will have read

18
00:00:38,000 --> 00:00:40,079
in the program i am not jason burling he

19
00:00:40,079 --> 00:00:42,320
is presenting on track three

20
00:00:42,320 --> 00:00:44,079
i now take a pause as you all get up and

21
00:00:44,079 --> 00:00:45,200
leave because you actually wanted to go

22
00:00:45,200 --> 00:00:47,200
to that talk instead

23
00:00:47,200 --> 00:00:48,399
uh but

24
00:00:48,399 --> 00:00:50,559
i digress uh i'm a bachelor's of

25
00:00:50,559 --> 00:00:52,239
engineering cybersecurity forensic

26
00:00:52,239 --> 00:00:53,680
graduate i've recently completed my

27
00:00:53,680 --> 00:00:54,559
degree

28
00:00:54,559 --> 00:00:57,039
um during that time i've been a i've

29
00:00:57,039 --> 00:00:59,039
acted as a threat research and content

30
00:00:59,039 --> 00:01:00,640
intern with

31
00:01:00,640 --> 00:01:03,760
a security uh security provider company

32
00:01:03,760 --> 00:01:05,519
i won't name

33
00:01:05,519 --> 00:01:06,960
my dissertation is on fitness tracker

34
00:01:06,960 --> 00:01:09,680
security so yes this is based on my

35
00:01:09,680 --> 00:01:11,119
dissertation work that i've undertaken

36
00:01:11,119 --> 00:01:12,479
during my final year

37
00:01:12,479 --> 00:01:14,320
i've recently accepted an offer to join

38
00:01:14,320 --> 00:01:16,240
capgemini as a security analyst so i'll

39
00:01:16,240 --> 00:01:18,560
be joining them sometime in uh shortly

40
00:01:18,560 --> 00:01:19,680
in the future

41
00:01:19,680 --> 00:01:22,159
and i've i have been an anysec member

42
00:01:22,159 --> 00:01:23,520
since second year and i occasionally

43
00:01:23,520 --> 00:01:27,119
play ctfs and i'm not completely rubbish

44
00:01:27,119 --> 00:01:28,560
if you've seen me before then you may

45
00:01:28,560 --> 00:01:31,200
remember me from such presentations as

46
00:01:31,200 --> 00:01:33,280
comparing cyber security to a shrunken

47
00:01:33,280 --> 00:01:34,400
ship

48
00:01:34,400 --> 00:01:36,159
and attempting to rick roll an audience

49
00:01:36,159 --> 00:01:39,439
without first conducting an av check

50
00:01:39,439 --> 00:01:42,000
i did conduct an av check this morning

51
00:01:42,000 --> 00:01:43,360
and in terms of anything outside of

52
00:01:43,360 --> 00:01:44,799
security all you really need to know is

53
00:01:44,799 --> 00:01:47,040
this

54
00:01:47,680 --> 00:01:49,840
i like dancing

55
00:01:49,840 --> 00:01:51,700
i like trains

56
00:01:51,700 --> 00:01:53,119
[Music]

57
00:01:53,119 --> 00:01:54,720
i cannot watch that without doing the

58
00:01:54,720 --> 00:01:56,799
hand gesture don't ask me why but yes

59
00:01:56,799 --> 00:01:58,399
i'm a closet train spotter here is me on

60
00:01:58,399 --> 00:01:59,759
the footplate of the flying scotsman in

61
00:01:59,759 --> 00:02:01,280
carlisle

62
00:02:01,280 --> 00:02:02,719
so getting back to the topic at hand

63
00:02:02,719 --> 00:02:04,320
what are we actually going to talk about

64
00:02:04,320 --> 00:02:07,040
well we'll look briefly at some of the

65
00:02:07,040 --> 00:02:09,919
um issues and such that exist

66
00:02:09,919 --> 00:02:11,360
when it comes to the security of the

67
00:02:11,360 --> 00:02:13,360
privacy of these devices we'll look at

68
00:02:13,360 --> 00:02:15,120
hardware that we're going to use when

69
00:02:15,120 --> 00:02:16,560
looking at these the software that we're

70
00:02:16,560 --> 00:02:18,560
going to use that's quite brief actually

71
00:02:18,560 --> 00:02:19,920
and then the main the main meter

72
00:02:19,920 --> 00:02:21,200
potatoes will be the floors and the

73
00:02:21,200 --> 00:02:22,720
impacts

74
00:02:22,720 --> 00:02:24,480
that i've discovered in the process of

75
00:02:24,480 --> 00:02:26,400
doing my dissertation and the possible

76
00:02:26,400 --> 00:02:29,040
defenses that could be used to protect

77
00:02:29,040 --> 00:02:30,879
yourself against those

78
00:02:30,879 --> 00:02:33,680
so why should you care

79
00:02:33,680 --> 00:02:35,599
well medical information isn't a

80
00:02:35,599 --> 00:02:36,720
password

81
00:02:36,720 --> 00:02:39,360
you can't change it if it gets breached

82
00:02:39,360 --> 00:02:41,519
you can't change your ecg readout from a

83
00:02:41,519 --> 00:02:43,040
particular date and time once it's

84
00:02:43,040 --> 00:02:44,239
happened it's happened and you're never

85
00:02:44,239 --> 00:02:45,840
going to be able to change that again

86
00:02:45,840 --> 00:02:47,280
whereas if your password gets breached

87
00:02:47,280 --> 00:02:48,400
you can quite easily change your

88
00:02:48,400 --> 00:02:49,599
password

89
00:02:49,599 --> 00:02:51,680
this is a it's an enhanced form of

90
00:02:51,680 --> 00:02:53,360
personal identifiable information and

91
00:02:53,360 --> 00:02:56,879
it's being gathered 24 7 365 anytime you

92
00:02:56,879 --> 00:02:58,400
are wearing your smart watch or your

93
00:02:58,400 --> 00:02:59,840
fitness tracker

94
00:02:59,840 --> 00:03:03,200
on the right there you'll see a list of

95
00:03:03,200 --> 00:03:05,360
sensors and data points that can be

96
00:03:05,360 --> 00:03:07,680
collected by the latest apple watch and

97
00:03:07,680 --> 00:03:09,760
at the bottom there you'll see the list

98
00:03:09,760 --> 00:03:12,319
of communication uh capabilities that

99
00:03:12,319 --> 00:03:15,120
has so not only what wi-fi bluetooth

100
00:03:15,120 --> 00:03:16,800
that you'd expect but also gps to

101
00:03:16,800 --> 00:03:18,239
accurately position yourself anywhere in

102
00:03:18,239 --> 00:03:20,560
the world and also 4g so even without

103
00:03:20,560 --> 00:03:22,560
your phone

104
00:03:22,560 --> 00:03:24,319
as a more modern and potentially more

105
00:03:24,319 --> 00:03:26,159
expensive

106
00:03:26,159 --> 00:03:28,159
smart device like this would be able to

107
00:03:28,159 --> 00:03:30,239
continue capturing data and transmitting

108
00:03:30,239 --> 00:03:31,680
it

109
00:03:31,680 --> 00:03:35,280
does anybody recognize what this is

110
00:03:40,159 --> 00:03:42,319
no it is not any advance on it's one of

111
00:03:42,319 --> 00:03:46,040
the afghanistan bases

112
00:03:46,159 --> 00:03:48,400
no

113
00:03:48,640 --> 00:03:50,879
no

114
00:03:51,360 --> 00:03:53,360
no

115
00:03:53,360 --> 00:03:55,920
no this is in fact in this is in fact a

116
00:03:55,920 --> 00:03:57,840
satellite photo from australia it's a

117
00:03:57,840 --> 00:03:59,680
facility known as pine gap and

118
00:03:59,680 --> 00:04:01,360
officially it's run by the australian

119
00:04:01,360 --> 00:04:03,439
defense forces however a significant

120
00:04:03,439 --> 00:04:05,040
number of the people who work there are

121
00:04:05,040 --> 00:04:07,360
americans and is effectively an american

122
00:04:07,360 --> 00:04:09,519
signals intelligence facility but these

123
00:04:09,519 --> 00:04:11,360
lines in orange and different shades of

124
00:04:11,360 --> 00:04:13,280
red that you can see around the facility

125
00:04:13,280 --> 00:04:15,120
that's actually a heat map from from an

126
00:04:15,120 --> 00:04:17,040
app called strava which a lot of people

127
00:04:17,040 --> 00:04:18,720
use to track their workout activity when

128
00:04:18,720 --> 00:04:20,720
they go running cycling whatever it is

129
00:04:20,720 --> 00:04:22,720
they choose to do

130
00:04:22,720 --> 00:04:25,120
and in 2017 this heat map was released

131
00:04:25,120 --> 00:04:26,880
that clearly showed

132
00:04:26,880 --> 00:04:28,560
the border of this facility in its

133
00:04:28,560 --> 00:04:29,680
location

134
00:04:29,680 --> 00:04:31,680
with uh american troops who had

135
00:04:31,680 --> 00:04:33,040
obviously gone for a run around the

136
00:04:33,040 --> 00:04:35,120
border walk around the border fence as

137
00:04:35,120 --> 00:04:37,280
part of their daily exercise

138
00:04:37,280 --> 00:04:39,120
and this led this was because by default

139
00:04:39,120 --> 00:04:41,199
if you had an account with strava

140
00:04:41,199 --> 00:04:44,000
you gave permission to share that data

141
00:04:44,000 --> 00:04:46,000
with

142
00:04:46,000 --> 00:04:47,440
strava and they could do what they want

143
00:04:47,440 --> 00:04:49,360
with it including release it publicly

144
00:04:49,360 --> 00:04:50,960
and also by default there were no

145
00:04:50,960 --> 00:04:53,440
private zones that existed

146
00:04:53,440 --> 00:04:56,479
in uh in strava meaning that no matter

147
00:04:56,479 --> 00:04:58,080
how close you were to a place of home

148
00:04:58,080 --> 00:05:00,400
place of work or indeed classified

149
00:05:00,400 --> 00:05:01,759
intelligence facilities in the middle of

150
00:05:01,759 --> 00:05:03,440
the australian outback

151
00:05:03,440 --> 00:05:04,960
it would continue to track your precise

152
00:05:04,960 --> 00:05:07,680
location when you were doing exercise it

153
00:05:07,680 --> 00:05:09,759
was also proved to be very

154
00:05:09,759 --> 00:05:11,039
simple

155
00:05:11,039 --> 00:05:13,120
from this data breach to identify user

156
00:05:13,120 --> 00:05:15,280
names profile pictures and if people

157
00:05:15,280 --> 00:05:16,479
were tracking it using strava

158
00:05:16,479 --> 00:05:18,320
potentially their heart rate and this

159
00:05:18,320 --> 00:05:19,440
isn't the only case where this has

160
00:05:19,440 --> 00:05:21,360
revealed troop movements

161
00:05:21,360 --> 00:05:22,800
it's been possible to see build up of

162
00:05:22,800 --> 00:05:24,400
troops on certain islands in the south

163
00:05:24,400 --> 00:05:27,280
china sea by chinese armed forces based

164
00:05:27,280 --> 00:05:28,560
on them

165
00:05:28,560 --> 00:05:30,160
showing up in heat maps once they've

166
00:05:30,160 --> 00:05:31,120
looked at

167
00:05:31,120 --> 00:05:34,639
been stationed at that location

168
00:05:34,800 --> 00:05:36,880
so in addition to poor privacy bluetooth

169
00:05:36,880 --> 00:05:38,880
is very hard as it turns out because a

170
00:05:38,880 --> 00:05:41,120
lot of things use the 2.4 gigahertz

171
00:05:41,120 --> 00:05:43,280
radio space to communicate not only

172
00:05:43,280 --> 00:05:46,000
bluetooth but wi-fi and others

173
00:05:46,000 --> 00:05:47,280
interference is very common in this

174
00:05:47,280 --> 00:05:49,199
frequency range so it's why you have a

175
00:05:49,199 --> 00:05:50,560
situation where

176
00:05:50,560 --> 00:05:52,479
bluetooth bluetooth will continuously

177
00:05:52,479 --> 00:05:54,639
hop between different channels different

178
00:05:54,639 --> 00:05:57,759
uh sub frequencies effectively to

179
00:05:57,759 --> 00:05:59,280
avoid this interference and keep a

180
00:05:59,280 --> 00:06:01,199
stable connection that diagram you can

181
00:06:01,199 --> 00:06:02,639
see there is the

182
00:06:02,639 --> 00:06:05,600
is uh the likelihood of any particular

183
00:06:05,600 --> 00:06:07,759
channel being selected it's uh called a

184
00:06:07,759 --> 00:06:10,960
channel switching algorithm

185
00:06:11,280 --> 00:06:12,800
there's also been recent controversy

186
00:06:12,800 --> 00:06:13,919
with some of the companies that

187
00:06:13,919 --> 00:06:16,479
manufacture these devices so cheaper

188
00:06:16,479 --> 00:06:18,319
advice is from

189
00:06:18,319 --> 00:06:20,560
huawei xiaomi and other companies that

190
00:06:20,560 --> 00:06:22,880
you may or may not have heard of before

191
00:06:22,880 --> 00:06:23,840
um

192
00:06:23,840 --> 00:06:26,000
were considerably in it less expensive

193
00:06:26,000 --> 00:06:28,560
than devices from the more known uh

194
00:06:28,560 --> 00:06:30,880
manufacturers like say apple or fitbit

195
00:06:30,880 --> 00:06:32,479
and when the apple and fitbit devices

196
00:06:32,479 --> 00:06:36,080
sold out people turned to devices like

197
00:06:36,080 --> 00:06:38,479
uh from the likes of xiaomi who sold

198
00:06:38,479 --> 00:06:40,960
13.4 million units in just one quarter

199
00:06:40,960 --> 00:06:42,400
of 2020

200
00:06:42,400 --> 00:06:44,400
of one of their devices the xiaomi mi

201
00:06:44,400 --> 00:06:45,759
band 5.

202
00:06:45,759 --> 00:06:47,520
of course huawei has been banned from

203
00:06:47,520 --> 00:06:49,599
the uk's 5g network because of the

204
00:06:49,599 --> 00:06:51,280
accusations that they've been spying on

205
00:06:51,280 --> 00:06:52,560
users and spying on behalf of the

206
00:06:52,560 --> 00:06:54,479
chinese state

207
00:06:54,479 --> 00:06:55,759
which has

208
00:06:55,759 --> 00:06:57,599
put a distrust in a lot of these brands

209
00:06:57,599 --> 00:06:59,919
despite the fact that there is as of yet

210
00:06:59,919 --> 00:07:02,400
no evidence that any of the

211
00:07:02,400 --> 00:07:05,120
devices sold at least to individuals

212
00:07:05,120 --> 00:07:06,720
have actually been used to compromise it

213
00:07:06,720 --> 00:07:10,720
uh or used uh in spying

214
00:07:10,720 --> 00:07:13,199
one moment

215
00:07:14,880 --> 00:07:16,720
it's definitely not a security bottle

216
00:07:16,720 --> 00:07:19,120
honest

217
00:07:19,680 --> 00:07:20,880
so let's go and have a look at the

218
00:07:20,880 --> 00:07:22,319
hardware so what we're hacking and with

219
00:07:22,319 --> 00:07:24,080
what we're going to hack it so these are

220
00:07:24,080 --> 00:07:26,319
the two main items of bluetooth

221
00:07:26,319 --> 00:07:27,919
hardware as mentioned before the xiaomi

222
00:07:27,919 --> 00:07:30,400
mi band 5 which is a very inexpensive

223
00:07:30,400 --> 00:07:32,560
device cost generally between 20 and 30

224
00:07:32,560 --> 00:07:34,080
pounds depending what voucher code is

225
00:07:34,080 --> 00:07:36,000
available on amazon

226
00:07:36,000 --> 00:07:37,840
as i said it's extremely popular they

227
00:07:37,840 --> 00:07:40,000
sold over 13 million units just in one

228
00:07:40,000 --> 00:07:42,319
quarter of 2020 and it has some of the

229
00:07:42,319 --> 00:07:45,599
more common uh sensors and measuring

230
00:07:45,599 --> 00:07:47,280
capability you'll find on most of these

231
00:07:47,280 --> 00:07:50,000
devices i.e an accelerometer gyroscope

232
00:07:50,000 --> 00:07:51,520
and heart rate measurement

233
00:07:51,520 --> 00:07:53,520
you don't tend to find many of the

234
00:07:53,520 --> 00:07:55,280
especially cheaper devices that can

235
00:07:55,280 --> 00:07:56,840
carry out an

236
00:07:56,840 --> 00:07:59,520
ecg on the right there

237
00:07:59,520 --> 00:08:01,199
is a passive bluetooth capture device

238
00:08:01,199 --> 00:08:02,879
called the adafruit bluefruit ellie

239
00:08:02,879 --> 00:08:03,919
friend

240
00:08:03,919 --> 00:08:05,840
henceforth to be called the blue fruit

241
00:08:05,840 --> 00:08:07,360
because i don't want to say that long

242
00:08:07,360 --> 00:08:08,319
name

243
00:08:08,319 --> 00:08:10,240
that's a more that's a passive capture

244
00:08:10,240 --> 00:08:12,479
vice so it doesn't actively

245
00:08:12,479 --> 00:08:14,160
transmit data or at least it doesn't the

246
00:08:14,160 --> 00:08:17,599
way it's been programmed um it's made to

247
00:08:17,599 --> 00:08:18,560
debug

248
00:08:18,560 --> 00:08:20,720
bluetooth implementations and mainly

249
00:08:20,720 --> 00:08:22,960
feeds packets into packet capture

250
00:08:22,960 --> 00:08:25,039
software like wireshark and that just

251
00:08:25,039 --> 00:08:26,879
uses a standard bluetooth radio it's the

252
00:08:26,879 --> 00:08:29,440
firmware that actually it fitted um it's

253
00:08:29,440 --> 00:08:30,960
the firmware that device comes with that

254
00:08:30,960 --> 00:08:32,479
enables the functionality rather than

255
00:08:32,479 --> 00:08:34,000
the any special sort of really

256
00:08:34,000 --> 00:08:35,519
specialized hardware

257
00:08:35,519 --> 00:08:37,679
except for the fact that

258
00:08:37,679 --> 00:08:39,839
for some reason the controller on the

259
00:08:39,839 --> 00:08:42,320
device expects a com port on your

260
00:08:42,320 --> 00:08:44,560
computer and i don't have a computer

261
00:08:44,560 --> 00:08:46,800
from the 20th century so in that case

262
00:08:46,800 --> 00:08:48,080
you end up having to set it up a little

263
00:08:48,080 --> 00:08:49,760
bit something like this a virtual driver

264
00:08:49,760 --> 00:08:51,680
feeding into python which then goes

265
00:08:51,680 --> 00:08:53,360
through nordic semiconductors plug-in

266
00:08:53,360 --> 00:08:56,399
and into wireshark

267
00:08:56,399 --> 00:08:58,160
the other hardware i'm going to be using

268
00:08:58,160 --> 00:09:00,399
or i have used is a huawei p10 which

269
00:09:00,399 --> 00:09:02,640
will act as the attacking device

270
00:09:02,640 --> 00:09:03,519
in

271
00:09:03,519 --> 00:09:05,120
reality you could use really any android

272
00:09:05,120 --> 00:09:07,519
smartphone and an iphone 12 which i

273
00:09:07,519 --> 00:09:10,560
installed the me fit app onto to connect

274
00:09:10,560 --> 00:09:11,519
to the

275
00:09:11,519 --> 00:09:14,720
uh xiaomi mi band 5 itself

276
00:09:14,720 --> 00:09:16,800
now i had some great crazy justification

277
00:09:16,800 --> 00:09:19,440
about why i chose these devices in my

278
00:09:19,440 --> 00:09:21,360
original dissertation but as this is a

279
00:09:21,360 --> 00:09:23,200
bit more of a casual setting i can admit

280
00:09:23,200 --> 00:09:24,880
i chose these devices because i already

281
00:09:24,880 --> 00:09:26,560
owned them and i'm a broke student and i

282
00:09:26,560 --> 00:09:27,920
don't want to go out and buy smartphones

283
00:09:27,920 --> 00:09:30,399
all the time

284
00:09:30,560 --> 00:09:32,160
so the software this one's quite brief

285
00:09:32,160 --> 00:09:33,600
there's three main pieces of software

286
00:09:33,600 --> 00:09:36,560
we're using wireshark i would presume

287
00:09:36,560 --> 00:09:38,000
most people here have heard of open

288
00:09:38,000 --> 00:09:40,160
source packet capture software only used

289
00:09:40,160 --> 00:09:42,240
for capturing network traffic but can be

290
00:09:42,240 --> 00:09:43,519
used for capturing other kinds of

291
00:09:43,519 --> 00:09:45,360
traffic including bluetooth if you have

292
00:09:45,360 --> 00:09:48,399
the right plug-in and the right hardware

293
00:09:48,399 --> 00:09:50,480
an app called nrf connect from nordic

294
00:09:50,480 --> 00:09:52,720
semiconductor running on android so that

295
00:09:52,720 --> 00:09:54,399
enables you to scan for bluetooth

296
00:09:54,399 --> 00:09:56,320
devices uh investigate their

297
00:09:56,320 --> 00:09:58,000
functionality and in some cases write

298
00:09:58,000 --> 00:09:59,680
values to them

299
00:09:59,680 --> 00:10:01,040
uh

300
00:10:01,040 --> 00:10:03,279
in a way that

301
00:10:03,279 --> 00:10:06,160
the it knows the format of the expected

302
00:10:06,160 --> 00:10:08,160
value so you can it makes it much easier

303
00:10:08,160 --> 00:10:10,959
to write values than some other programs

304
00:10:10,959 --> 00:10:13,120
an app called bt inspector from george

305
00:10:13,120 --> 00:10:15,519
gar's side that's on the ios side that

306
00:10:15,519 --> 00:10:16,880
can be used for similar sorts of

307
00:10:16,880 --> 00:10:18,240
activities but it doesn't let you

308
00:10:18,240 --> 00:10:20,079
pre-format the

309
00:10:20,079 --> 00:10:23,199
value you want to write

310
00:10:24,160 --> 00:10:25,040
so

311
00:10:25,040 --> 00:10:27,200
science in it we don't really know it

312
00:10:27,200 --> 00:10:28,959
but we're going to try it anyway as tom

313
00:10:28,959 --> 00:10:30,640
scott once said so let's move on to what

314
00:10:30,640 --> 00:10:32,800
we actually tried so

315
00:10:32,800 --> 00:10:34,560
this is an unpaired advertising packet

316
00:10:34,560 --> 00:10:36,480
so this is the when you turn the fitness

317
00:10:36,480 --> 00:10:37,680
tracker on

318
00:10:37,680 --> 00:10:39,360
and

319
00:10:39,360 --> 00:10:40,959
excuse me when you turn the finish

320
00:10:40,959 --> 00:10:42,320
tracker on it's not connected to

321
00:10:42,320 --> 00:10:43,760
anything this is the type of packet it

322
00:10:43,760 --> 00:10:45,680
will continually transmit and it will

323
00:10:45,680 --> 00:10:47,920
transmit over and over and over again

324
00:10:47,920 --> 00:10:49,920
for as long as you let it really

325
00:10:49,920 --> 00:10:51,440
and i've picked out some of the more

326
00:10:51,440 --> 00:10:54,079
relevant more important things

327
00:10:54,079 --> 00:10:55,519
one of which being the channel selection

328
00:10:55,519 --> 00:10:57,440
algorithm which is number two

329
00:10:57,440 --> 00:10:59,120
the number one algorithm was considered

330
00:10:59,120 --> 00:11:00,880
weaker and easier to predict what

331
00:11:00,880 --> 00:11:03,200
channel the device would switch to

332
00:11:03,200 --> 00:11:04,800
which wouldn't be ideal if you're able

333
00:11:04,800 --> 00:11:06,800
to predict that

334
00:11:06,800 --> 00:11:08,399
the public bluetooth address so this

335
00:11:08,399 --> 00:11:11,040
device tells everyone what its address

336
00:11:11,040 --> 00:11:13,279
is even those who wouldn't need to know

337
00:11:13,279 --> 00:11:15,279
it so this way you can you've now

338
00:11:15,279 --> 00:11:17,279
uniquely identified the device because

339
00:11:17,279 --> 00:11:19,200
that address is set but in hardware and

340
00:11:19,200 --> 00:11:20,959
can't easily be changed at least

341
00:11:20,959 --> 00:11:22,399
normally we'll get back to that near the

342
00:11:22,399 --> 00:11:23,920
end

343
00:11:23,920 --> 00:11:25,519
there's also a list of bluetooth low

344
00:11:25,519 --> 00:11:29,200
energy and br edr compatibility modes

345
00:11:29,200 --> 00:11:31,440
br edr effectively just means

346
00:11:31,440 --> 00:11:33,040
normal bluetooth that's base rate and

347
00:11:33,040 --> 00:11:34,480
enhanced data rate but it effectively

348
00:11:34,480 --> 00:11:36,399
just means normal bluetooth

349
00:11:36,399 --> 00:11:38,000
about whether which device can act as a

350
00:11:38,000 --> 00:11:40,800
host and a controller

351
00:11:40,800 --> 00:11:42,399
and then the bottom you have the oem

352
00:11:42,399 --> 00:11:45,600
details which is anhui huami information

353
00:11:45,600 --> 00:11:47,600
technology company limited which i

354
00:11:47,600 --> 00:11:50,079
thought was quite strange because

355
00:11:50,079 --> 00:11:52,160
i was told i was buying a xiaomi device

356
00:11:52,160 --> 00:11:54,399
not an anhui huami information

357
00:11:54,399 --> 00:11:56,560
technology company limited device

358
00:11:56,560 --> 00:11:59,360
but a quick look on fcc later

359
00:11:59,360 --> 00:12:02,079
on the fcc website finds a you find a

360
00:12:02,079 --> 00:12:04,399
filing for a device from that company

361
00:12:04,399 --> 00:12:07,200
called the amazfit band 5. so it turns

362
00:12:07,200 --> 00:12:08,480
out that

363
00:12:08,480 --> 00:12:09,920
a lot of these cheaper devices they're

364
00:12:09,920 --> 00:12:12,320
just rebranded among companies

365
00:12:12,320 --> 00:12:14,320
and sold under many different brands

366
00:12:14,320 --> 00:12:18,560
such as amazfit or xiaomi or whatever

367
00:12:18,639 --> 00:12:21,040
so that's great we can uniquely identify

368
00:12:21,040 --> 00:12:22,320
the device

369
00:12:22,320 --> 00:12:23,680
actually it's not so great if you're the

370
00:12:23,680 --> 00:12:25,519
one using the device

371
00:12:25,519 --> 00:12:27,920
but of course it's not like we can uh we

372
00:12:27,920 --> 00:12:30,959
can determine signal strength from this

373
00:12:30,959 --> 00:12:33,040
oh wait yes we can

374
00:12:33,040 --> 00:12:35,040
but it's definitely only one application

375
00:12:35,040 --> 00:12:37,200
that can uh can read this right so it's

376
00:12:37,200 --> 00:12:39,519
not very popular right

377
00:12:39,519 --> 00:12:41,279
nope you can read signal strength in any

378
00:12:41,279 --> 00:12:43,279
number of applications

379
00:12:43,279 --> 00:12:45,680
both in scientific figures and just

380
00:12:45,680 --> 00:12:47,440
random percentages

381
00:12:47,440 --> 00:12:49,600
making it very easy to track a device

382
00:12:49,600 --> 00:12:51,680
similar to how

383
00:12:51,680 --> 00:12:53,680
agents during world war ii behind enemy

384
00:12:53,680 --> 00:12:55,839
lines would be located

385
00:12:55,839 --> 00:12:57,839
through examining signal strength and

386
00:12:57,839 --> 00:12:59,760
direction

387
00:12:59,760 --> 00:13:00,880
and in fact

388
00:13:00,880 --> 00:13:02,320
in my dissertation i write about an

389
00:13:02,320 --> 00:13:04,320
experiment i did where i had someone

390
00:13:04,320 --> 00:13:07,279
place this fitness tracker randomly in

391
00:13:07,279 --> 00:13:08,399
the um

392
00:13:08,399 --> 00:13:10,320
in the student halls that i lived in

393
00:13:10,320 --> 00:13:12,000
and i was able to find it about half the

394
00:13:12,000 --> 00:13:13,519
time it would take me to manually search

395
00:13:13,519 --> 00:13:15,760
all the rooms

396
00:13:15,760 --> 00:13:17,519
here's an obligatory mean

397
00:13:17,519 --> 00:13:19,839
my gps is off how is you tracking me

398
00:13:19,839 --> 00:13:21,200
because your watch is broadcasting your

399
00:13:21,200 --> 00:13:22,959
location to everyone and of course if

400
00:13:22,959 --> 00:13:24,560
you have more than one person using any

401
00:13:24,560 --> 00:13:26,320
sort of these applications you could

402
00:13:26,320 --> 00:13:27,760
simply have three people carry out a

403
00:13:27,760 --> 00:13:29,839
triangulation and locate the individual

404
00:13:29,839 --> 00:13:32,639
relatively easily

405
00:13:32,880 --> 00:13:34,880
so that's not great but of course none

406
00:13:34,880 --> 00:13:36,399
of that involves actually connecting to

407
00:13:36,399 --> 00:13:37,519
the device

408
00:13:37,519 --> 00:13:39,199
so what if

409
00:13:39,199 --> 00:13:41,680
i'm able to connect to the device

410
00:13:41,680 --> 00:13:43,120
uh well before i cover that i just want

411
00:13:43,120 --> 00:13:47,600
to briefly explain this hierarchy here

412
00:13:47,600 --> 00:13:50,000
so the in a lot of these apps uh

413
00:13:50,000 --> 00:13:52,000
different values you see are broken down

414
00:13:52,000 --> 00:13:54,079
first of all by profile a set of

415
00:13:54,079 --> 00:13:55,920
predefined services so for example

416
00:13:55,920 --> 00:13:58,000
there's a heart rate profile which isn't

417
00:13:58,000 --> 00:13:59,279
actually programmed into the fitness

418
00:13:59,279 --> 00:14:00,959
tracker itself

419
00:14:00,959 --> 00:14:02,800
but it's a standard that lists

420
00:14:02,800 --> 00:14:04,639
a predefined set of services that would

421
00:14:04,639 --> 00:14:06,560
need to be included or some of them can

422
00:14:06,560 --> 00:14:09,600
be optional if you wanted to

423
00:14:09,600 --> 00:14:11,279
carry out that function obviously

424
00:14:11,279 --> 00:14:12,880
there's profiles for other things like

425
00:14:12,880 --> 00:14:14,639
glucose monitoring and different things

426
00:14:14,639 --> 00:14:15,680
like this

427
00:14:15,680 --> 00:14:17,360
the service is just a logical group of

428
00:14:17,360 --> 00:14:19,440
data

429
00:14:19,440 --> 00:14:21,279
and the characteristic is a single data

430
00:14:21,279 --> 00:14:23,600
point so heart rate measurement would in

431
00:14:23,600 --> 00:14:26,480
itself be a single data point

432
00:14:26,480 --> 00:14:28,320
now to get any of this though i would

433
00:14:28,320 --> 00:14:31,360
need to be able to de-auth the user

434
00:14:31,360 --> 00:14:33,680
effectively cause their smartphone to

435
00:14:33,680 --> 00:14:36,959
disconnect from the fitness tracker

436
00:14:36,959 --> 00:14:38,480
or carry out some sort of denial of

437
00:14:38,480 --> 00:14:40,480
service now if this can be done or you

438
00:14:40,480 --> 00:14:41,920
can get at them during the pairing

439
00:14:41,920 --> 00:14:44,480
process then a stealth connection as

440
00:14:44,480 --> 00:14:47,040
i've called it here is possible

441
00:14:47,040 --> 00:14:48,160
because

442
00:14:48,160 --> 00:14:51,040
if you're pairing using the me fit app

443
00:14:51,040 --> 00:14:53,120
the fitness tracker will vibrate and

444
00:14:53,120 --> 00:14:54,639
flash up a little confirmation screen

445
00:14:54,639 --> 00:14:56,079
where you have to press the tick before

446
00:14:56,079 --> 00:14:58,800
the devices will pair if you attempt to

447
00:14:58,800 --> 00:15:01,839
pair through an app like say nrf connect

448
00:15:01,839 --> 00:15:04,160
it doesn't put up this confirmation it

449
00:15:04,160 --> 00:15:05,600
just pairs

450
00:15:05,600 --> 00:15:07,199
so if you were able to deal with the

451
00:15:07,199 --> 00:15:09,519
user from their fitness tracker you

452
00:15:09,519 --> 00:15:10,880
could then connect to it without the

453
00:15:10,880 --> 00:15:12,720
user becoming aware of it which is far

454
00:15:12,720 --> 00:15:15,279
from ideal

455
00:15:15,760 --> 00:15:17,839
and sure enough under heart rate under

456
00:15:17,839 --> 00:15:19,519
the heart rate service

457
00:15:19,519 --> 00:15:21,680
there is a characteristic called heart

458
00:15:21,680 --> 00:15:23,600
rate measurement and that value can be

459
00:15:23,600 --> 00:15:25,120
read from the device and apparently my

460
00:15:25,120 --> 00:15:26,720
heart rate was quite high or a little

461
00:15:26,720 --> 00:15:28,320
bit above resting

462
00:15:28,320 --> 00:15:29,680
when i read this it was 80 beats per

463
00:15:29,680 --> 00:15:32,000
minute

464
00:15:32,639 --> 00:15:34,959
and indeed i found this

465
00:15:34,959 --> 00:15:36,959
value which can both be read and written

466
00:15:36,959 --> 00:15:39,440
to the new alert value and as i was

467
00:15:39,440 --> 00:15:41,519
saying about nrfconnect it understands

468
00:15:41,519 --> 00:15:44,079
the expected format of this value i.e

469
00:15:44,079 --> 00:15:46,000
the name of the type of notification a

470
00:15:46,000 --> 00:15:47,199
call

471
00:15:47,199 --> 00:15:49,600
the number of them one and the message

472
00:15:49,600 --> 00:15:50,959
which would generally be the number or

473
00:15:50,959 --> 00:15:53,279
the contact who is calling you which i

474
00:15:53,279 --> 00:15:54,800
included as any sec

475
00:15:54,800 --> 00:15:57,120
and when you write this

476
00:15:57,120 --> 00:15:58,240
to the

477
00:15:58,240 --> 00:16:01,120
fitness tracker to the xiaomi mi band

478
00:16:01,120 --> 00:16:02,639
it starts vibrating on your wrist

479
00:16:02,639 --> 00:16:04,480
informing you that nusec is calling you

480
00:16:04,480 --> 00:16:05,920
and a couple of you will recognize this

481
00:16:05,920 --> 00:16:07,279
picture because i posted this on my

482
00:16:07,279 --> 00:16:10,000
twitter on april fool's day which may

483
00:16:10,000 --> 00:16:12,560
not be the best idea i ever had

484
00:16:12,560 --> 00:16:14,800
but uh i did i decided to have a little

485
00:16:14,800 --> 00:16:16,959
bit of a captured competition to ask why

486
00:16:16,959 --> 00:16:18,480
is elliot our president of current

487
00:16:18,480 --> 00:16:22,560
president of any set calling me

488
00:16:22,560 --> 00:16:23,920
now i i

489
00:16:23,920 --> 00:16:25,279
there weren't that many there wasn't

490
00:16:25,279 --> 00:16:26,880
that many entries have been if i'm being

491
00:16:26,880 --> 00:16:28,720
honest but i did offer a prize although

492
00:16:28,720 --> 00:16:30,079
i didn't reveal what it was until today

493
00:16:30,079 --> 00:16:32,000
it is in fact this miniature of

494
00:16:32,000 --> 00:16:34,240
glenfiddich single malt scotch

495
00:16:34,240 --> 00:16:35,839
and after conferring with the third

496
00:16:35,839 --> 00:16:37,920
party and agree which was the funniest

497
00:16:37,920 --> 00:16:38,880
reply

498
00:16:38,880 --> 00:16:41,519
we concluded that the winner is drumroll

499
00:16:41,519 --> 00:16:43,839
please

500
00:16:46,079 --> 00:16:49,040
does my bomb look big in this from tia

501
00:16:49,040 --> 00:16:52,160
is tia here can i

502
00:16:52,160 --> 00:16:54,399
yes i think her talk might have overrun

503
00:16:54,399 --> 00:16:56,079
well well done to tia and i'll make sure

504
00:16:56,079 --> 00:16:57,279
that she gets this before the end of the

505
00:16:57,279 --> 00:17:00,240
day before we hit the pub

506
00:17:00,720 --> 00:17:04,040
sorry dominic

507
00:17:06,079 --> 00:17:07,919
dominic was the first to send in a reply

508
00:17:07,919 --> 00:17:09,599
on the basis that no one else would and

509
00:17:09,599 --> 00:17:11,599
that he would win by default

510
00:17:11,599 --> 00:17:13,679
he was unsuccessful in this because i

511
00:17:13,679 --> 00:17:15,119
tried to drum up more support on social

512
00:17:15,119 --> 00:17:16,839
media

513
00:17:16,839 --> 00:17:19,839
sorry anyway

514
00:17:19,839 --> 00:17:21,919
back to the topic at hand

515
00:17:21,919 --> 00:17:23,919
so i mentioned that in order to connect

516
00:17:23,919 --> 00:17:26,559
to the person's uh tracker via stealth

517
00:17:26,559 --> 00:17:27,679
you'll need to carry out some sort of

518
00:17:27,679 --> 00:17:29,200
deal thing or potentially denial of

519
00:17:29,200 --> 00:17:31,280
service attack

520
00:17:31,280 --> 00:17:32,640
so one of the experiments i carried out

521
00:17:32,640 --> 00:17:34,400
was to test whether denial of service

522
00:17:34,400 --> 00:17:36,880
attack was possible

523
00:17:36,880 --> 00:17:38,240
and the attack that i was using was

524
00:17:38,240 --> 00:17:39,919
effectively uh what could be referred to

525
00:17:39,919 --> 00:17:42,160
as a ping of death the idea being to

526
00:17:42,160 --> 00:17:43,919
flood the device with so many ping

527
00:17:43,919 --> 00:17:46,080
requests

528
00:17:46,080 --> 00:17:47,520
that either i take up all the

529
00:17:47,520 --> 00:17:49,280
transmission time with it replying to my

530
00:17:49,280 --> 00:17:51,039
ping request and it can't transmit back

531
00:17:51,039 --> 00:17:53,919
to where it's supposed to

532
00:17:53,919 --> 00:17:55,200
or

533
00:17:55,200 --> 00:17:56,960
i overwhelm the processor and the

534
00:17:56,960 --> 00:17:58,880
software crashes

535
00:17:58,880 --> 00:18:00,880
the tool i used to do that was l2 ping

536
00:18:00,880 --> 00:18:03,200
it's part of a package called blues uh

537
00:18:03,200 --> 00:18:04,559
that you should be able to get on most

538
00:18:04,559 --> 00:18:06,160
linux distros although i'm using kali

539
00:18:06,160 --> 00:18:08,160
linux here because

540
00:18:08,160 --> 00:18:09,520
well because cali lyrics and i'm a

541
00:18:09,520 --> 00:18:11,679
hacker so canon comes with a card

542
00:18:11,679 --> 00:18:13,120
um

543
00:18:13,120 --> 00:18:17,120
and discovered that 668 bytes not 669

544
00:18:17,120 --> 00:18:19,760
unfortunately is the maximum uh ping

545
00:18:19,760 --> 00:18:21,200
message length that you can send if you

546
00:18:21,200 --> 00:18:23,280
send any longer then you get an error

547
00:18:23,280 --> 00:18:24,320
that you can see at the bottom there

548
00:18:24,320 --> 00:18:26,720
reading send failed message too long the

549
00:18:26,720 --> 00:18:28,000
arguments in that are quite simple it's

550
00:18:28,000 --> 00:18:29,919
the message length the number of ping

551
00:18:29,919 --> 00:18:31,840
messages you want to send and the

552
00:18:31,840 --> 00:18:33,200
bluetooth address that you want to send

553
00:18:33,200 --> 00:18:34,880
it to which we established in the first

554
00:18:34,880 --> 00:18:36,160
experiment that we were able to find

555
00:18:36,160 --> 00:18:37,760
that

556
00:18:37,760 --> 00:18:39,840
so the way i tested this

557
00:18:39,840 --> 00:18:42,480
and it looked very weird at the time was

558
00:18:42,480 --> 00:18:44,480
to walk for 15 minutes

559
00:18:44,480 --> 00:18:46,640
around innocent well in a circle more in

560
00:18:46,640 --> 00:18:49,520
a rectangle around the um the jack

561
00:18:49,520 --> 00:18:50,960
hillby computing center at murston

562
00:18:50,960 --> 00:18:52,559
campus

563
00:18:52,559 --> 00:18:54,799
with a fitness tracker on on my wrist

564
00:18:54,799 --> 00:18:57,679
tracking live tracking a walking workout

565
00:18:57,679 --> 00:18:59,840
to my phone in my pocket carrying my

566
00:18:59,840 --> 00:19:02,000
laptop which is spamming ping packets

567
00:19:02,000 --> 00:19:04,080
continuously

568
00:19:04,080 --> 00:19:06,000
in a loop and yes i did physical

569
00:19:06,000 --> 00:19:08,559
exercise i was surprised as well

570
00:19:08,559 --> 00:19:09,600
and this was the outcome of that

571
00:19:09,600 --> 00:19:11,440
exercise after i completed it as you can

572
00:19:11,440 --> 00:19:13,919
see there's not really any gap there's

573
00:19:13,919 --> 00:19:15,440
no gap in this heart rate tracking and

574
00:19:15,440 --> 00:19:19,120
no sort of vertical jump at any point

575
00:19:19,120 --> 00:19:23,440
which um i concluded in uh was um

576
00:19:23,440 --> 00:19:25,600
excuse me

577
00:19:25,600 --> 00:19:27,039
i concluded that

578
00:19:27,039 --> 00:19:28,720
this denial of service wasn't successful

579
00:19:28,720 --> 00:19:29,919
because we weren't able to interrupt

580
00:19:29,919 --> 00:19:31,520
that normal transmission

581
00:19:31,520 --> 00:19:33,280
of this data from the fitness tracker

582
00:19:33,280 --> 00:19:36,000
back to the phone

583
00:19:36,240 --> 00:19:38,000
so then we moved on oh then i moved on

584
00:19:38,000 --> 00:19:40,080
rather than try passive capturing

585
00:19:40,080 --> 00:19:43,600
so effectively rather than

586
00:19:43,840 --> 00:19:45,679
uh interfering with the device simply to

587
00:19:45,679 --> 00:19:47,600
read that data that's going between it

588
00:19:47,600 --> 00:19:49,440
and the phone and see what you can get

589
00:19:49,440 --> 00:19:50,840
from

590
00:19:50,840 --> 00:19:53,360
it now what i found was that the

591
00:19:53,360 --> 00:19:55,120
bluetooth tracker itself continues to

592
00:19:55,120 --> 00:19:57,919
advertise that it exists in a broadcast

593
00:19:57,919 --> 00:19:59,360
packet that you can see at the bottom

594
00:19:59,360 --> 00:20:00,160
there

595
00:20:00,160 --> 00:20:01,520
to everything

596
00:20:01,520 --> 00:20:03,679
even when it is connected

597
00:20:03,679 --> 00:20:04,480
to

598
00:20:04,480 --> 00:20:07,360
a smartphone it simply advertises the

599
00:20:07,360 --> 00:20:09,200
fact that it can't

600
00:20:09,200 --> 00:20:10,799
connect to anything else so it's saying

601
00:20:10,799 --> 00:20:12,320
look at me i'm here

602
00:20:12,320 --> 00:20:14,320
but you can't connect to me

603
00:20:14,320 --> 00:20:15,760
which of course makes tracking even

604
00:20:15,760 --> 00:20:17,360
easier because even when the person's

605
00:20:17,360 --> 00:20:19,360
using the device you would still be able

606
00:20:19,360 --> 00:20:21,200
to re to use the broadcast packets if

607
00:20:21,200 --> 00:20:22,400
nothing else

608
00:20:22,400 --> 00:20:25,360
to successfully track it

609
00:20:25,360 --> 00:20:27,120
uh but these were all the adafruit was

610
00:20:27,120 --> 00:20:29,120
capturing which shouldn't be how the

611
00:20:29,120 --> 00:20:31,360
adafruit functions um from meeting other

612
00:20:31,360 --> 00:20:32,640
people's dissertation they've been able

613
00:20:32,640 --> 00:20:34,720
to use this to successfully capture

614
00:20:34,720 --> 00:20:37,679
data packets even if they were encrypted

615
00:20:37,679 --> 00:20:38,960
obviously they wouldn't make any sense

616
00:20:38,960 --> 00:20:40,159
unless you were able to decrypt them but

617
00:20:40,159 --> 00:20:41,760
it wasn't capturing anything other than

618
00:20:41,760 --> 00:20:43,600
these advertising packets

619
00:20:43,600 --> 00:20:45,520
which was strange but it was okay i had

620
00:20:45,520 --> 00:20:47,120
a backup method

621
00:20:47,120 --> 00:20:48,720
that backup method was to use hci

622
00:20:48,720 --> 00:20:50,480
logging so that's a host controller

623
00:20:50,480 --> 00:20:52,400
interface log which is a function in the

624
00:20:52,400 --> 00:20:53,919
developer settings of most android

625
00:20:53,919 --> 00:20:54,799
phones

626
00:20:54,799 --> 00:20:56,880
where you can effectively say log all

627
00:20:56,880 --> 00:20:58,480
the bluetooth traffic packets that are

628
00:20:58,480 --> 00:21:00,960
sent to or from this device creates a

629
00:21:00,960 --> 00:21:02,640
little log file you pull that out to

630
00:21:02,640 --> 00:21:04,640
your computer opening wireshark and you

631
00:21:04,640 --> 00:21:07,520
can analyze it however you wish

632
00:21:07,520 --> 00:21:08,799
as i said that can be turned on the

633
00:21:08,799 --> 00:21:10,480
developer settings or you can turn it on

634
00:21:10,480 --> 00:21:13,120
the android debugging shell

635
00:21:13,120 --> 00:21:14,880
which is great

636
00:21:14,880 --> 00:21:16,559
except for the fact that

637
00:21:16,559 --> 00:21:19,039
on some manufacturer's implementation of

638
00:21:19,039 --> 00:21:20,400
android

639
00:21:20,400 --> 00:21:22,559
it simply doesn't work it won't

640
00:21:22,559 --> 00:21:24,559
even if you manually set the value to

641
00:21:24,559 --> 00:21:25,840
true in

642
00:21:25,840 --> 00:21:27,280
the adb shell

643
00:21:27,280 --> 00:21:28,799
you'll find that when you read out the

644
00:21:28,799 --> 00:21:30,799
file again it says that it's set to

645
00:21:30,799 --> 00:21:34,640
false so it won't create a log file

646
00:21:34,640 --> 00:21:37,120
which is far from ideal you can see that

647
00:21:37,120 --> 00:21:40,080
just here so this is me attempting to um

648
00:21:40,080 --> 00:21:42,640
this is me cutting the

649
00:21:42,640 --> 00:21:44,559
contents of the bluetooth configuration

650
00:21:44,559 --> 00:21:46,159
file

651
00:21:46,159 --> 00:21:49,440
and uh does this laser it does yeah

652
00:21:49,440 --> 00:21:50,400
so

653
00:21:50,400 --> 00:21:52,320
you can see the bt snoop log output

654
00:21:52,320 --> 00:21:53,760
basically whether i'm going to log the

655
00:21:53,760 --> 00:21:55,840
output of my bluetooth traffic is set to

656
00:21:55,840 --> 00:21:58,240
false despite the fact that i set it to

657
00:21:58,240 --> 00:22:01,600
true and also this bt snoop file name

658
00:22:01,600 --> 00:22:03,919
this log file that's supposed to exist

659
00:22:03,919 --> 00:22:05,120
doesn't exist anywhere in the file

660
00:22:05,120 --> 00:22:07,280
system because there's no point creating

661
00:22:07,280 --> 00:22:08,320
it because it would just be an empty

662
00:22:08,320 --> 00:22:10,480
file so at this point i felt kind of

663
00:22:10,480 --> 00:22:12,640
like this

664
00:22:12,640 --> 00:22:15,520
that hadn't gone well at all as clarkson

665
00:22:15,520 --> 00:22:17,200
might say

666
00:22:17,200 --> 00:22:18,960
but we'd still discovered some things

667
00:22:18,960 --> 00:22:21,280
that uh were could be caused for concern

668
00:22:21,280 --> 00:22:22,880
and that actions could be taken to

669
00:22:22,880 --> 00:22:24,640
defend to defend against so that's what

670
00:22:24,640 --> 00:22:26,159
i'm going to look at like finally the

671
00:22:26,159 --> 00:22:28,320
defenses

672
00:22:28,320 --> 00:22:29,440
let's see how we're doing timelines

673
00:22:29,440 --> 00:22:31,919
we're okay right so one of the defenses

674
00:22:31,919 --> 00:22:34,559
is address cycling so a lot of the

675
00:22:34,559 --> 00:22:36,240
attacks as you might have seen

676
00:22:36,240 --> 00:22:39,200
rely on knowing the unique

677
00:22:39,200 --> 00:22:41,120
bluetooth address of

678
00:22:41,120 --> 00:22:43,280
the device you wish to attack

679
00:22:43,280 --> 00:22:45,520
if that changes such as say in windows

680
00:22:45,520 --> 00:22:46,960
where you're able to have

681
00:22:46,960 --> 00:22:48,799
a mac address changing every time you

682
00:22:48,799 --> 00:22:50,799
connect to a network

683
00:22:50,799 --> 00:22:52,000
if you're able to do that for your

684
00:22:52,000 --> 00:22:53,520
bluetooth devices

685
00:22:53,520 --> 00:22:55,280
this would confuse attackers and prevent

686
00:22:55,280 --> 00:22:56,720
long-term attacks because you may hard

687
00:22:56,720 --> 00:22:58,159
code one

688
00:22:58,159 --> 00:23:01,120
uh address into your attack only to find

689
00:23:01,120 --> 00:23:03,039
that by the time you run that attack the

690
00:23:03,039 --> 00:23:04,320
address has changed the device has

691
00:23:04,320 --> 00:23:07,200
changed and you're unable to

692
00:23:07,200 --> 00:23:09,520
you're unable to um continue your attack

693
00:23:09,520 --> 00:23:12,240
because that address is no longer valid

694
00:23:12,240 --> 00:23:13,760
i had to look to see if anyone already

695
00:23:13,760 --> 00:23:15,360
did this and it turns out apple actually

696
00:23:15,360 --> 00:23:17,760
already does this if you look in their

697
00:23:17,760 --> 00:23:19,600
security information for watch os they

698
00:23:19,600 --> 00:23:20,720
tell you that

699
00:23:20,720 --> 00:23:22,720
the device address is rotated at 15

700
00:23:22,720 --> 00:23:24,720
minute intervals

701
00:23:24,720 --> 00:23:26,159
which is good and they even mention it

702
00:23:26,159 --> 00:23:27,520
reduces the risk of the device being

703
00:23:27,520 --> 00:23:29,039
locally tracked if it broadcasts a

704
00:23:29,039 --> 00:23:30,960
persistent identifier

705
00:23:30,960 --> 00:23:32,400
literally the problem we were trying to

706
00:23:32,400 --> 00:23:34,480
solve from address cycling

707
00:23:34,480 --> 00:23:36,080
good on apple for doing something good

708
00:23:36,080 --> 00:23:38,559
instead of responding to bogus requests

709
00:23:38,559 --> 00:23:40,240
from fake law enforcement looking for

710
00:23:40,240 --> 00:23:42,880
data as was announced a couple days ago

711
00:23:42,880 --> 00:23:45,279
i suppose you win some you lose some

712
00:23:45,279 --> 00:23:46,880
anyway so

713
00:23:46,880 --> 00:23:48,400
what else can we do potentially about

714
00:23:48,400 --> 00:23:49,919
tracking well if a bluetooth device is

715
00:23:49,919 --> 00:23:51,360
only supposed to

716
00:23:51,360 --> 00:23:53,200
talk to one device

717
00:23:53,200 --> 00:23:54,480
instead of having it constantly

718
00:23:54,480 --> 00:23:57,120
broadcast to everything else i exist but

719
00:23:57,120 --> 00:23:59,200
you can't interact with me

720
00:23:59,200 --> 00:24:01,919
just don't do that only transmit when

721
00:24:01,919 --> 00:24:03,440
you need to

722
00:24:03,440 --> 00:24:04,880
if you

723
00:24:04,880 --> 00:24:06,320
reduce the amount of transmissions

724
00:24:06,320 --> 00:24:07,600
you're making to only those which are

725
00:24:07,600 --> 00:24:09,760
necessary for the functionality i.e

726
00:24:09,760 --> 00:24:11,200
those between

727
00:24:11,200 --> 00:24:13,600
the device and the phone that it's

728
00:24:13,600 --> 00:24:15,200
already paired to

729
00:24:15,200 --> 00:24:16,960
then it doesn't leave nothing for the

730
00:24:16,960 --> 00:24:18,960
hacker to track as i've said here but at

731
00:24:18,960 --> 00:24:20,960
least significantly less for a hacker to

732
00:24:20,960 --> 00:24:22,000
track

733
00:24:22,000 --> 00:24:23,840
and makes it considerably more difficult

734
00:24:23,840 --> 00:24:25,840
then to

735
00:24:25,840 --> 00:24:29,360
exploit that in any sort of way

736
00:24:29,840 --> 00:24:32,240
so these are the three three takeaways

737
00:24:32,240 --> 00:24:33,840
that i think are the most important

738
00:24:33,840 --> 00:24:35,360
anyway uh you might think differently

739
00:24:35,360 --> 00:24:36,320
but

740
00:24:36,320 --> 00:24:38,960
uh bluetooth is easy and hard at the

741
00:24:38,960 --> 00:24:40,240
same time

742
00:24:40,240 --> 00:24:42,080
because

743
00:24:42,080 --> 00:24:43,679
you control someone or attack their

744
00:24:43,679 --> 00:24:45,840
bluetooth fitness tracker using nothing

745
00:24:45,840 --> 00:24:48,080
but the phone that we almost all have in

746
00:24:48,080 --> 00:24:50,320
our pockets

747
00:24:50,320 --> 00:24:51,840
but yet

748
00:24:51,840 --> 00:24:53,520
reliably capturing bluetooth packets

749
00:24:53,520 --> 00:24:55,679
could be so difficult that oftentimes

750
00:24:55,679 --> 00:24:57,440
you'd have to resort to a device which

751
00:24:57,440 --> 00:24:59,039
captures the entirety of the 2.4

752
00:24:59,039 --> 00:25:01,440
gigahertz radio space which would cost

753
00:25:01,440 --> 00:25:03,360
you several thousand dollars and i can't

754
00:25:03,360 --> 00:25:05,039
afford one of those because i'm a broke

755
00:25:05,039 --> 00:25:08,640
student at least and now i am

756
00:25:08,640 --> 00:25:10,559
uh users need to be more aware of what's

757
00:25:10,559 --> 00:25:12,720
being gathered and who can view it

758
00:25:12,720 --> 00:25:15,039
so a lot of not a lot of peop

759
00:25:15,039 --> 00:25:17,520
of uh ordinary users for one of a better

760
00:25:17,520 --> 00:25:19,600
word would have a threat model and

761
00:25:19,600 --> 00:25:22,400
probably wouldn't factor in

762
00:25:22,400 --> 00:25:25,039
uh any additional risk that having you

763
00:25:25,039 --> 00:25:26,799
know a heart rate monitor an ecg

764
00:25:26,799 --> 00:25:28,880
notification engine on their wrist 24 7

765
00:25:28,880 --> 00:25:29,840
would do

766
00:25:29,840 --> 00:25:32,640
and they probably haven't considered

767
00:25:32,640 --> 00:25:34,320
whether

768
00:25:34,320 --> 00:25:36,720
they are except they accept that kind of

769
00:25:36,720 --> 00:25:38,000
data gathering

770
00:25:38,000 --> 00:25:40,640
the same way that a lot of people

771
00:25:40,640 --> 00:25:43,360
have used facebook for so long but

772
00:25:43,360 --> 00:25:45,039
they know they sort of know that

773
00:25:45,039 --> 00:25:46,559
facebook's gathering a lot of data on

774
00:25:46,559 --> 00:25:47,279
them

775
00:25:47,279 --> 00:25:48,880
but they don't know they don't

776
00:25:48,880 --> 00:25:50,880
investigate it specifically and they

777
00:25:50,880 --> 00:25:52,159
even no matter what they seem to know

778
00:25:52,159 --> 00:25:54,400
about it they don't

779
00:25:54,400 --> 00:25:55,600
attempt to

780
00:25:55,600 --> 00:25:56,640
stop

781
00:25:56,640 --> 00:25:58,720
uh using facebook or control their data

782
00:25:58,720 --> 00:26:00,720
in any sort of way

783
00:26:00,720 --> 00:26:02,159
and the final one there is that most of

784
00:26:02,159 --> 00:26:04,240
these issues can't really be fixed by

785
00:26:04,240 --> 00:26:05,679
the user it's annoying because a lot of

786
00:26:05,679 --> 00:26:07,360
them relate to just the way the

787
00:26:07,360 --> 00:26:08,799
bluetooth standard or the way these

788
00:26:08,799 --> 00:26:11,760
devices that run proprietary code

789
00:26:11,760 --> 00:26:14,000
have been programmed

790
00:26:14,000 --> 00:26:15,919
and so what you really have what we

791
00:26:15,919 --> 00:26:18,159
really need is for the people designing

792
00:26:18,159 --> 00:26:20,159
manufacturing these devices

793
00:26:20,159 --> 00:26:23,520
and standardization uh organizations so

794
00:26:23,520 --> 00:26:24,720
people who are creating things for

795
00:26:24,720 --> 00:26:26,320
standards like bluetooth bluetooth low

796
00:26:26,320 --> 00:26:27,679
energy

797
00:26:27,679 --> 00:26:29,600
they need to make these changes or force

798
00:26:29,600 --> 00:26:31,120
organizations to make these changes

799
00:26:31,120 --> 00:26:32,320
because

800
00:26:32,320 --> 00:26:34,000
they're not a thing users can do for us

801
00:26:34,000 --> 00:26:36,320
that can generally do for themselves

802
00:26:36,320 --> 00:26:37,679
but

803
00:26:37,679 --> 00:26:39,279
the companies that make these devices

804
00:26:39,279 --> 00:26:40,240
aren't

805
00:26:40,240 --> 00:26:42,640
going aren't likely to change them

806
00:26:42,640 --> 00:26:44,080
unless they're forced to because why

807
00:26:44,080 --> 00:26:45,120
would they they can just leave it the

808
00:26:45,120 --> 00:26:46,880
same way and continue to make a crap

809
00:26:46,880 --> 00:26:48,799
load of money selling 13 million units

810
00:26:48,799 --> 00:26:51,279
in one quarter

811
00:26:51,279 --> 00:26:52,880
so um that's it for me thank you very

812
00:26:52,880 --> 00:26:54,799
much for for coming and not for running

813
00:26:54,799 --> 00:26:56,159
away when i gave you the opportunity to

814
00:26:56,159 --> 00:26:58,400
go to track three instead i hope you've

815
00:26:58,400 --> 00:27:00,000
enjoyed i hope you learned something

816
00:27:00,000 --> 00:27:02,400
thank you to enusek for inviting me to

817
00:27:02,400 --> 00:27:04,880
give this presentation today and uh if

818
00:27:04,880 --> 00:27:06,960
we have time i'll be willing to take any

819
00:27:06,960 --> 00:27:09,630
questions thanks

820
00:27:09,630 --> 00:27:13,259
[Applause]

821
00:27:15,760 --> 00:27:19,640
do we have any questions

822
00:27:22,320 --> 00:27:23,919
oh there's one hold up i'll see if i can

823
00:27:23,919 --> 00:27:25,679
throw the cube

824
00:27:25,679 --> 00:27:27,279
okay yeah that's fine shout out your

825
00:27:27,279 --> 00:27:30,600
question then

826
00:27:37,520 --> 00:27:39,360
um

827
00:27:39,360 --> 00:27:41,200
so just for the recording there um you

828
00:27:41,200 --> 00:27:43,520
asked whether consumers can better how

829
00:27:43,520 --> 00:27:45,520
consumers could audit

830
00:27:45,520 --> 00:27:46,559
devices that they're looking at

831
00:27:46,559 --> 00:27:47,919
purchasing before they decide to buy

832
00:27:47,919 --> 00:27:49,520
them

833
00:27:49,520 --> 00:27:51,200
that that's that's quite difficult due

834
00:27:51,200 --> 00:27:53,679
to the nature of proprietary code etc

835
00:27:53,679 --> 00:27:55,360
and the issues that

836
00:27:55,360 --> 00:27:56,960
even technical people can have in trying

837
00:27:56,960 --> 00:27:58,080
to capture

838
00:27:58,080 --> 00:27:59,919
data from these things

839
00:27:59,919 --> 00:28:02,480
the best thing would just be to

840
00:28:02,480 --> 00:28:04,640
i i would guess google google the device

841
00:28:04,640 --> 00:28:06,640
name with you know keywords like

842
00:28:06,640 --> 00:28:08,640
vulnerability or floor have a look and

843
00:28:08,640 --> 00:28:09,919
see if anything's been discovered by

844
00:28:09,919 --> 00:28:12,960
security researchers and published

845
00:28:12,960 --> 00:28:16,880
or even just look at the specifications

846
00:28:16,880 --> 00:28:18,559
on the manufacturer's website and look

847
00:28:18,559 --> 00:28:21,279
at what are they set what do

848
00:28:21,279 --> 00:28:22,080
they

849
00:28:22,080 --> 00:28:24,720
purport to do to keep the device secure

850
00:28:24,720 --> 00:28:27,039
like apple publicly states that their

851
00:28:27,039 --> 00:28:29,279
devices rotate bluetooth addresses every

852
00:28:29,279 --> 00:28:30,399
15 minutes

853
00:28:30,399 --> 00:28:32,720
i at least in my research didn't find

854
00:28:32,720 --> 00:28:36,720
anyone else who did the same thing

855
00:28:38,240 --> 00:28:41,200
anyone else have a question

856
00:28:43,200 --> 00:28:45,760
seeing and hearing none

857
00:28:45,760 --> 00:28:49,879
guess that means i'm done thank you

