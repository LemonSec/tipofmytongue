1
00:00:02,930 --> 00:00:07,640
the lessons managers license managers

2
00:00:05,210 --> 00:00:10,340
can bring you a lot of problems or can

3
00:00:07,640 --> 00:00:12,469
be your best friends it depends on how

4
00:00:10,340 --> 00:00:15,440
you work with them so first of all I

5
00:00:12,469 --> 00:00:18,110
would like to introduce us what we do we

6
00:00:15,440 --> 00:00:20,420
we work at Kaspersky Lab ics-cert team

7
00:00:18,110 --> 00:00:24,349
this is an industrial control system

8
00:00:20,420 --> 00:00:26,599
cyber emergency response team will we do

9
00:00:24,349 --> 00:00:29,660
the different penetration testing

10
00:00:26,599 --> 00:00:32,360
vulnerability research also the

11
00:00:29,660 --> 00:00:35,930
protection different things for our

12
00:00:32,360 --> 00:00:38,990
customers and for the whole world we do

13
00:00:35,930 --> 00:00:40,580
different City FS we create city s so

14
00:00:38,990 --> 00:00:45,110
today actually

15
00:00:40,580 --> 00:00:47,449
today our ennio Kaspersky industrial

16
00:00:45,110 --> 00:00:49,550
city have start so you're more than

17
00:00:47,450 --> 00:00:52,070
welcome to participate in that type of

18
00:00:49,550 --> 00:00:57,290
competition so we you see the link it's

19
00:00:52,070 --> 00:01:00,730
HTTP city of those especially calm so we

20
00:00:57,290 --> 00:01:03,260
have really cool tasks and the finals

21
00:01:00,730 --> 00:01:06,160
those are qualifications and the finals

22
00:01:03,260 --> 00:01:08,780
will take place in Singapore next year

23
00:01:06,160 --> 00:01:11,869
we have created a couple years ago

24
00:01:08,780 --> 00:01:14,720
automatic bartenders so well kaput

25
00:01:11,870 --> 00:01:16,250
because ocupado a rock but father's and

26
00:01:14,720 --> 00:01:19,789
we also two different other cool stuff

27
00:01:16,250 --> 00:01:22,460
so lessons managers as far as you know

28
00:01:19,790 --> 00:01:25,130
there are different ways to do the

29
00:01:22,460 --> 00:01:26,899
license licensing for different types of

30
00:01:25,130 --> 00:01:28,899
the software so as you remember for

31
00:01:26,900 --> 00:01:31,550
example in the Windows operating system

32
00:01:28,900 --> 00:01:36,650
like in XP you need to provide the

33
00:01:31,550 --> 00:01:39,380
distri that makes your version of

34
00:01:36,650 --> 00:01:42,320
windows operation systems valid like

35
00:01:39,380 --> 00:01:46,280
license sometimes you need to provide

36
00:01:42,320 --> 00:01:50,330
the token so I have here like like this

37
00:01:46,280 --> 00:01:54,590
talking like there's tokens so if you

38
00:01:50,330 --> 00:01:57,140
have software installed you need to plug

39
00:01:54,590 --> 00:02:01,119
in the USB token and then software

40
00:01:57,140 --> 00:02:03,680
understands that the valid version of

41
00:02:01,119 --> 00:02:06,799
token is being installed and everything

42
00:02:03,680 --> 00:02:07,729
works perfectly so basically all these

43
00:02:06,799 --> 00:02:13,030
license man

44
00:02:07,729 --> 00:02:17,000
they are anti-piracy thing they can be

45
00:02:13,030 --> 00:02:19,760
software or hardware guys sometimes

46
00:02:17,000 --> 00:02:22,129
they're self-made for one company by the

47
00:02:19,760 --> 00:02:24,890
same company so we will be bringing some

48
00:02:22,129 --> 00:02:28,399
examples of that and in most of the

49
00:02:24,890 --> 00:02:31,910
cases they being used as the third party

50
00:02:28,400 --> 00:02:35,420
code in like a bigger system so for

51
00:02:31,910 --> 00:02:38,000
example if you install some sort of

52
00:02:35,420 --> 00:02:41,349
software the license management drivers

53
00:02:38,000 --> 00:02:44,090
being installed automatically

54
00:02:41,349 --> 00:02:46,578
unfortunately some of the vendors that

55
00:02:44,090 --> 00:02:49,190
are using that type of installation they

56
00:02:46,579 --> 00:02:52,010
do not check any security of those

57
00:02:49,190 --> 00:02:56,599
license managers and there is a plain

58
00:02:52,010 --> 00:02:59,780
trust issue so they basically trust that

59
00:02:56,599 --> 00:03:04,540
code that being in the package of the

60
00:02:59,780 --> 00:03:07,310
main software installation package and

61
00:03:04,540 --> 00:03:10,069
so today we would like to start with the

62
00:03:07,310 --> 00:03:13,579
first example its Siemens automated

63
00:03:10,069 --> 00:03:17,208
license managers so we will be bringing

64
00:03:13,579 --> 00:03:20,299
only the statistics for this this

65
00:03:17,209 --> 00:03:22,670
license management so this is the

66
00:03:20,299 --> 00:03:25,700
example of the company who created their

67
00:03:22,670 --> 00:03:29,480
license manager only for the internal

68
00:03:25,700 --> 00:03:31,880
purposes so for example if you study if

69
00:03:29,480 --> 00:03:34,340
you know about the industrial control

70
00:03:31,880 --> 00:03:37,600
systems especially the Siemens

71
00:03:34,340 --> 00:03:40,690
automation software you can see that

72
00:03:37,600 --> 00:03:43,760
usually like in 90 percent of the cases

73
00:03:40,690 --> 00:03:47,290
the Siemens automated license manager is

74
00:03:43,760 --> 00:03:50,840
being installed with the whole package

75
00:03:47,290 --> 00:03:53,750
this license manager was studied by

76
00:03:50,840 --> 00:03:56,270
different researchers

77
00:03:53,750 --> 00:03:59,900
for the Las Vegas was it seven eight

78
00:03:56,270 --> 00:04:01,900
years and the thing is that basically

79
00:03:59,900 --> 00:04:05,060
50% of those discovered vulnerabilities

80
00:04:01,900 --> 00:04:08,480
belong to our team so we started the

81
00:04:05,060 --> 00:04:13,100
research in 2016 and usually like once

82
00:04:08,480 --> 00:04:14,869
or twice a year we try again to find the

83
00:04:13,100 --> 00:04:17,810
vulnerabilities in Siemens automatic

84
00:04:14,870 --> 00:04:20,180
license manager and we usually say have

85
00:04:17,810 --> 00:04:21,140
success in DES so as you can see there

86
00:04:20,180 --> 00:04:23,000
are different types of the

87
00:04:21,140 --> 00:04:25,490
vulnerabilities being discovered in the

88
00:04:23,000 --> 00:04:27,470
binary file so not only typical binary

89
00:04:25,490 --> 00:04:30,520
vulnerabilities that allow you to do the

90
00:04:27,470 --> 00:04:33,500
remote code execution but also different

91
00:04:30,520 --> 00:04:37,690
injections like path reverb best

92
00:04:33,500 --> 00:04:40,970
terminals and all those kind of things

93
00:04:37,690 --> 00:04:45,040
so sometimes it can bring you a lot of

94
00:04:40,970 --> 00:04:48,740
problem the second case is our research

95
00:04:45,040 --> 00:04:52,130
started two years ago two years ago yes

96
00:04:48,740 --> 00:04:54,830
to open and have here you go this is a G

97
00:04:52,130 --> 00:04:58,520
multi it's a huge company and they also

98
00:04:54,830 --> 00:05:01,520
do the license management business they

99
00:04:58,520 --> 00:05:04,280
work in the business-to-business

100
00:05:01,520 --> 00:05:07,400
thing so basically they provide the OEM

101
00:05:04,280 --> 00:05:09,739
software and so the first results shows

102
00:05:07,400 --> 00:05:13,159
us that well everything was really bad

103
00:05:09,740 --> 00:05:15,380
so in couple minutes early we'll talk

104
00:05:13,160 --> 00:05:17,330
about technical details talk about how

105
00:05:15,380 --> 00:05:21,469
they for some reason removed all the

106
00:05:17,330 --> 00:05:23,960
internal protections so we realized that

107
00:05:21,470 --> 00:05:27,650
this type of license manager is being

108
00:05:23,960 --> 00:05:30,510
used super widely liked by a huge huge

109
00:05:27,650 --> 00:05:33,359
companies like IBM HP

110
00:05:30,510 --> 00:05:36,330
use that type of license management for

111
00:05:33,360 --> 00:05:39,180
the internal software and everything and

112
00:05:36,330 --> 00:05:41,099
it being used by like banks and bestowal

113
00:05:39,180 --> 00:05:46,140
control systems to telecommunications

114
00:05:41,100 --> 00:05:49,200
software all the big players we have

115
00:05:46,140 --> 00:05:51,659
seen so with different penetration tests

116
00:05:49,200 --> 00:05:53,880
for our customers and in different

117
00:05:51,660 --> 00:05:55,860
locations in different types of the

118
00:05:53,880 --> 00:05:58,710
company's supported by different types

119
00:05:55,860 --> 00:06:02,640
of the software and hardware we noticed

120
00:05:58,710 --> 00:06:09,599
one really strange binary file

121
00:06:02,640 --> 00:06:11,880
it's has elements dot exe so first we

122
00:06:09,600 --> 00:06:14,280
thought that it's imagined of some

123
00:06:11,880 --> 00:06:15,900
stranger's strange thing but then we

124
00:06:14,280 --> 00:06:18,780
started studying and we realized that

125
00:06:15,900 --> 00:06:24,179
this is a basically basically a binary

126
00:06:18,780 --> 00:06:27,419
file of 40 lessons management and for

127
00:06:24,180 --> 00:06:29,250
this is this is the software and

128
00:06:27,420 --> 00:06:33,540
hardware thing so basically you need to

129
00:06:29,250 --> 00:06:36,840
use this token and the software part so

130
00:06:33,540 --> 00:06:39,570
this is the graphical example how those

131
00:06:36,840 --> 00:06:43,650
license management tokens looks like you

132
00:06:39,570 --> 00:06:45,510
might see them in different types of the

133
00:06:43,650 --> 00:06:48,919
business over you even might use it

134
00:06:45,510 --> 00:06:52,560
already so and now certainly we'll

135
00:06:48,920 --> 00:06:55,740
explain more details of what's what is

136
00:06:52,560 --> 00:06:57,810
it made for and what types of the things

137
00:06:55,740 --> 00:07:02,250
are being inside of the binary first and

138
00:06:57,810 --> 00:07:04,530
everything hello everybody in additional

139
00:07:02,250 --> 00:07:08,460
you should know the Gemalto is a safe

140
00:07:04,530 --> 00:07:11,849
net or a legend because jamaat bought

141
00:07:08,460 --> 00:07:14,849
safe net segments like a sounds more

142
00:07:11,850 --> 00:07:18,170
popular this is

143
00:07:14,850 --> 00:07:22,590
hardware's of advanced software solution

144
00:07:18,170 --> 00:07:27,510
hardware part is talking Latimer's audio

145
00:07:22,590 --> 00:07:31,919
and the software part contains drivers

146
00:07:27,510 --> 00:07:34,909
were services web application some a lot

147
00:07:31,920 --> 00:07:34,910
of wireless

148
00:07:35,080 --> 00:07:44,930
show you how you can install it so

149
00:07:39,610 --> 00:07:49,849
giri's there are three ways first way

150
00:07:44,930 --> 00:07:56,259
you plug in the lake token into the

151
00:07:49,849 --> 00:08:02,419
Windows PC with Windows resistant

152
00:07:56,259 --> 00:08:06,770
windows in the divide the token and I

153
00:08:02,419 --> 00:08:10,099
took an ID and try to search it in

154
00:08:06,770 --> 00:08:14,960
Windows updates and download their

155
00:08:10,099 --> 00:08:19,128
software driver also driver who also

156
00:08:14,960 --> 00:08:26,960
with driver services installed service

157
00:08:19,129 --> 00:08:30,949
opens port 1947 the second second way to

158
00:08:26,960 --> 00:08:34,098
stall his petition is manually download

159
00:08:30,949 --> 00:08:39,560
from the site damata or SafeNet is

160
00:08:34,099 --> 00:08:43,339
available the winner will be done the

161
00:08:39,559 --> 00:08:49,609
same way is a first kiss except that

162
00:08:43,339 --> 00:08:53,269
also port number 1947 would be added to

163
00:08:49,610 --> 00:08:56,779
the exceptional firewall but in this

164
00:08:53,269 --> 00:09:01,720
case you will be notified ih I'll show

165
00:08:56,779 --> 00:09:07,519
you about the ated open the port and the

166
00:09:01,720 --> 00:09:12,110
case is like hidden installation if by

167
00:09:07,519 --> 00:09:14,870
some software for example SCADA or

168
00:09:12,110 --> 00:09:19,100
something and during installation the

169
00:09:14,870 --> 00:09:22,100
this super looper also installed and the

170
00:09:19,100 --> 00:09:27,140
port also will be opened but nobody

171
00:09:22,100 --> 00:09:31,089
tells you that open the port is open and

172
00:09:27,140 --> 00:09:33,189
everyone can connected to you

173
00:09:31,089 --> 00:09:38,290
ok

174
00:09:33,190 --> 00:09:44,320
what if this is live with the bigger

175
00:09:38,290 --> 00:09:48,969
screen we found were not what this is

176
00:09:44,320 --> 00:09:53,230
great of one crush and one main feature

177
00:09:48,970 --> 00:09:56,290
of the this process as per that exact is

178
00:09:53,230 --> 00:10:00,780
there is no and there is no software

179
00:09:56,290 --> 00:10:05,130
protection no as no Aztec cameras no

180
00:10:00,780 --> 00:10:11,400
this so it's easy to exploit and if you

181
00:10:05,130 --> 00:10:11,400
can see that this is small okay

182
00:10:11,440 --> 00:10:16,960
the exception is application the

183
00:10:15,070 --> 00:10:24,310
exception is application try to execute

184
00:10:16,960 --> 00:10:28,360
code at address it's our lot it's too

185
00:10:24,310 --> 00:10:31,569
hard to see nowadays because nowadays we

186
00:10:28,360 --> 00:10:36,820
are a lot of protection to start doing

187
00:10:31,570 --> 00:10:41,590
this way and we was wondering why they

188
00:10:36,820 --> 00:10:43,930
remove all protection we don't know so

189
00:10:41,590 --> 00:10:46,480
if you in this case it's easily to

190
00:10:43,930 --> 00:10:51,459
exploit simple right

191
00:10:46,480 --> 00:10:58,400
rope chain pop operate a small and I

192
00:10:51,460 --> 00:10:59,980
will show how this exploited works and

193
00:10:58,400 --> 00:11:03,410
[Music]

194
00:10:59,980 --> 00:11:07,160
so in the quick statistics before the

195
00:11:03,410 --> 00:11:10,939
lathe this is just a short number of

196
00:11:07,160 --> 00:11:14,209
vulnerabilities identified in Gemalto

197
00:11:10,940 --> 00:11:15,800
husband lessons management so there were

198
00:11:14,210 --> 00:11:19,330
different types of the remote code

199
00:11:15,800 --> 00:11:22,520
execution with the rivet head privileges

200
00:11:19,330 --> 00:11:25,820
we identified a really strange behavior

201
00:11:22,520 --> 00:11:31,279
when the remote attacker could capture

202
00:11:25,820 --> 00:11:34,190
the ntlm hash of the user under which

203
00:11:31,279 --> 00:11:37,339
privileges the binary is being around

204
00:11:34,190 --> 00:11:42,350
and so every time the binary is being

205
00:11:37,339 --> 00:11:45,620
run under the system privileges so we

206
00:11:42,350 --> 00:11:48,470
managed to capture the system in

207
00:11:45,620 --> 00:11:51,529
tantalum fish and when we reported it to

208
00:11:48,470 --> 00:11:56,029
the vendor they said like so so what we

209
00:11:51,529 --> 00:11:58,010
said like okay you might do the like

210
00:11:56,029 --> 00:12:00,260
hitch bypass attack or something like

211
00:11:58,010 --> 00:12:02,209
that and they said like no this is a

212
00:12:00,260 --> 00:12:05,569
system user it's just impossible to do

213
00:12:02,209 --> 00:12:08,660
so we consider it as the vulnerability

214
00:12:05,570 --> 00:12:11,900
and the really strange behavior and also

215
00:12:08,660 --> 00:12:14,270
we have identified another strange

216
00:12:11,900 --> 00:12:17,390
behavior that allows you to do the

217
00:12:14,270 --> 00:12:18,980
remote configuration with the remote

218
00:12:17,390 --> 00:12:22,420
manipulations with the configuration

219
00:12:18,980 --> 00:12:27,100
file so basically you can remotely

220
00:12:22,420 --> 00:12:31,060
insert insert your own what is a deep

221
00:12:27,100 --> 00:12:34,550
proxy proxy server for the updates and

222
00:12:31,060 --> 00:12:38,239
in terms of the so basically you can

223
00:12:34,550 --> 00:12:40,819
insert malicious proxy server and insert

224
00:12:38,240 --> 00:12:43,070
the malicious binary so for the updates

225
00:12:40,820 --> 00:12:46,600
so and right now we will be showing the

226
00:12:43,070 --> 00:12:46,600
remote code execution tomorrow

227
00:12:53,399 --> 00:13:00,959
okay so we're starting the attackers

228
00:12:56,649 --> 00:13:00,959
machine and the victims machined

229
00:13:07,510 --> 00:13:16,300
[Music]

230
00:13:09,540 --> 00:13:19,779
so whatever to machine it's like windows

231
00:13:16,300 --> 00:13:24,550
it's totally updated so now the nobility

232
00:13:19,779 --> 00:13:29,769
in Windows and so to machine first

233
00:13:24,550 --> 00:13:35,589
machine these IP address is attacker the

234
00:13:29,769 --> 00:13:39,959
second machine is a victim and between

235
00:13:35,589 --> 00:13:45,040
them words internal internal network

236
00:13:39,959 --> 00:13:46,149
first of all every victim as I talk to

237
00:13:45,040 --> 00:13:48,160
you

238
00:13:46,149 --> 00:13:50,079
it's possible to download the

239
00:13:48,160 --> 00:13:53,319
application this is a vulnerable one

240
00:13:50,079 --> 00:13:59,109
repetition now it's already a fix it

241
00:13:53,320 --> 00:14:03,930
and we will told you can see that safe

242
00:13:59,110 --> 00:14:03,930
net incorporation because gemalto also

243
00:14:05,579 --> 00:14:16,859
installation next next next fall Asia

244
00:14:21,680 --> 00:14:24,829
[Music]

245
00:14:24,880 --> 00:14:30,630
Oh certainly

246
00:14:41,690 --> 00:14:50,840
okay you can see that who is

247
00:14:45,790 --> 00:14:56,990
notification that port number 1947 is

248
00:14:50,840 --> 00:15:10,540
opened okay finish also it was added in

249
00:14:56,990 --> 00:15:19,250
the firewall exceptions it's everything

250
00:15:10,540 --> 00:15:24,130
don't want the bound okay this it's

251
00:15:19,250 --> 00:15:24,130
allowed to accept any connection

252
00:15:24,900 --> 00:15:35,900
[Music]

253
00:15:30,890 --> 00:15:40,520
so with now let's try to this this

254
00:15:35,900 --> 00:15:44,540
application opens port 1947 and use

255
00:15:40,520 --> 00:15:47,420
either binary or HTTP protocol it

256
00:15:44,540 --> 00:15:51,500
depends of the first four bytes let's

257
00:15:47,420 --> 00:15:55,540
try to connect to connect to the victim

258
00:15:51,500 --> 00:15:55,540
machine using Internet Explorer

259
00:15:56,210 --> 00:15:59,909
[Music]

260
00:16:14,329 --> 00:16:19,459
you consider this is a small education

261
00:16:16,999 --> 00:16:25,399
it's forbidden so it opened but it's

262
00:16:19,459 --> 00:16:29,410
forbidden we can by default connection

263
00:16:25,399 --> 00:16:34,990
only La Brea but there is a one appeal

264
00:16:29,410 --> 00:16:37,939
which can switch off this teacher

265
00:16:34,990 --> 00:16:44,649
remotely without any authorization I

266
00:16:37,939 --> 00:16:50,599
will show this script number one hey

267
00:16:44,649 --> 00:16:53,120
this success refresh that's it

268
00:16:50,600 --> 00:16:58,430
this is picture it's not reliable test

269
00:16:53,120 --> 00:17:03,350
our Casa as vendor told us within no way

270
00:16:58,430 --> 00:17:07,069
you can see admin control but this is

271
00:17:03,350 --> 00:17:10,309
custom web application it's not a batch

272
00:17:07,069 --> 00:17:16,970
or something this custom and it's

273
00:17:10,309 --> 00:17:22,579
possible there's something like this is

274
00:17:16,970 --> 00:17:28,120
like update form and we find one field

275
00:17:22,579 --> 00:17:32,000
was vulnerable in this in this form and

276
00:17:28,119 --> 00:17:33,408
we'll create an exploit it's easy to

277
00:17:32,000 --> 00:17:38,179
create as I told you there is no

278
00:17:33,409 --> 00:17:40,520
protection its we only it's manually

279
00:17:38,179 --> 00:17:46,480
possible to create rope chain like in

280
00:17:40,520 --> 00:17:55,970
beginning of 19th and let's try to

281
00:17:46,480 --> 00:17:59,809
attack first of all we should use and

282
00:17:55,970 --> 00:18:05,570
cut that you we sent the exploit to the

283
00:17:59,809 --> 00:18:07,460
victim and when it was it it will it

284
00:18:05,570 --> 00:18:10,270
will it will make a reverse connection

285
00:18:07,460 --> 00:18:10,270
to our PC

286
00:18:10,820 --> 00:18:24,090
this is port number 4/4 4/4 success so

287
00:18:20,220 --> 00:18:32,820
we're these two script number two we

288
00:18:24,090 --> 00:18:39,770
send the exploit to the victim okay you

289
00:18:32,820 --> 00:18:47,879
can see this is the not cut received

290
00:18:39,770 --> 00:18:51,960
connection and using ipconfig okay we at

291
00:18:47,880 --> 00:19:03,570
the victim computer you can see the

292
00:18:51,960 --> 00:19:05,909
address and more Who am I I see stem so

293
00:19:03,570 --> 00:19:12,799
we can do everything with the remote

294
00:19:05,909 --> 00:19:20,820
computer now that's it okay so great

295
00:19:12,799 --> 00:19:22,260
results okay so quick results so after

296
00:19:20,820 --> 00:19:24,480
after we have reported all the

297
00:19:22,260 --> 00:19:27,379
vulnerable jamal tech company made a

298
00:19:24,480 --> 00:19:31,409
really huge step in terms of the

299
00:19:27,380 --> 00:19:34,799
internal and external security so they

300
00:19:31,409 --> 00:19:37,950
basically and started working much

301
00:19:34,799 --> 00:19:39,389
better with the external security

302
00:19:37,950 --> 00:19:41,370
reports they fixed all the rumor

303
00:19:39,390 --> 00:19:45,169
abilities in a very short period of time

304
00:19:41,370 --> 00:19:49,620
and we have identified that there is a

305
00:19:45,169 --> 00:19:54,990
response time for vulnerability reports

306
00:19:49,620 --> 00:19:57,120
was way shorter than in before so the

307
00:19:54,990 --> 00:20:00,210
next example the third example is

308
00:19:57,120 --> 00:20:03,939
FlexNet license manager this is a very

309
00:20:00,210 --> 00:20:05,740
new research that we have finished just

310
00:20:03,940 --> 00:20:09,670
couple three weeks ago or something like

311
00:20:05,740 --> 00:20:13,480
this and what is it this is this license

312
00:20:09,670 --> 00:20:17,040
manager is made by our company they they

313
00:20:13,480 --> 00:20:21,520
are also a security player I mean they

314
00:20:17,040 --> 00:20:24,310
have some kind of security services and

315
00:20:21,520 --> 00:20:28,150
I guess software something like this so

316
00:20:24,310 --> 00:20:31,870
their their license manager works as the

317
00:20:28,150 --> 00:20:35,770
business-to-business thing so they

318
00:20:31,870 --> 00:20:38,469
provide a third-party code in in like

319
00:20:35,770 --> 00:20:40,570
other installation packages and we

320
00:20:38,470 --> 00:20:43,480
notice the some of the industrial

321
00:20:40,570 --> 00:20:45,790
control systems for example in default

322
00:20:43,480 --> 00:20:48,430
installation package have to license

323
00:20:45,790 --> 00:20:51,129
manager managers the Jamaat the previous

324
00:20:48,430 --> 00:20:52,900
one and this from the Flex net so they

325
00:20:51,130 --> 00:20:56,470
work at the industrial control system

326
00:20:52,900 --> 00:20:58,060
field double installation rate and they

327
00:20:56,470 --> 00:21:00,340
have a very interesting feature that

328
00:20:58,060 --> 00:21:02,770
will we will be talking about is the

329
00:21:00,340 --> 00:21:05,800
customization for the vendors so they

330
00:21:02,770 --> 00:21:07,120
can provide the default license manager

331
00:21:05,800 --> 00:21:09,310
all they can do some different

332
00:21:07,120 --> 00:21:13,840
customization that can lead to huge

333
00:21:09,310 --> 00:21:20,889
security problems so some quick

334
00:21:13,840 --> 00:21:22,990
explanation of what is it for so they we

335
00:21:20,890 --> 00:21:26,830
studied only software part of this type

336
00:21:22,990 --> 00:21:29,940
of the license manager it has the TCP

337
00:21:26,830 --> 00:21:32,199
port open two seven zero zero zero and

338
00:21:29,940 --> 00:21:34,570
we have found some interesting

339
00:21:32,200 --> 00:21:37,960
information about how the binary was

340
00:21:34,570 --> 00:21:40,629
compiled and the thing is that most of

341
00:21:37,960 --> 00:21:42,970
the internal security mechanisms are

342
00:21:40,630 --> 00:21:44,620
turned on and this is a this is really

343
00:21:42,970 --> 00:21:49,140
good

344
00:21:44,620 --> 00:21:52,780
so right now Sergei will explain the

345
00:21:49,140 --> 00:21:55,840
basically the research details how we

346
00:21:52,780 --> 00:21:58,470
started this research house the static

347
00:21:55,840 --> 00:21:58,470
the checksum

348
00:22:00,970 --> 00:22:12,860
first two for all we collected all

349
00:22:06,710 --> 00:22:16,700
traffic to report 2700 and it's it's not

350
00:22:12,860 --> 00:22:17,360
compressed with various can the

351
00:22:16,700 --> 00:22:23,080
plaintext

352
00:22:17,360 --> 00:22:28,250
could be dropped and we decide the way

353
00:22:23,080 --> 00:22:34,879
so let's do the stupid father that

354
00:22:28,250 --> 00:22:43,970
father and to like maybe maybe we fight

355
00:22:34,880 --> 00:22:49,070
Suffolk and yes admission if it is also

356
00:22:43,970 --> 00:22:54,010
one feature of this application its work

357
00:22:49,070 --> 00:22:57,070
like a legal abutment so if you install

358
00:22:54,010 --> 00:23:01,340
first not application it will try to

359
00:22:57,070 --> 00:23:04,520
find the neighbors to connect and

360
00:23:01,340 --> 00:23:08,809
collect some information about a demo

361
00:23:04,520 --> 00:23:14,510
license maybe I didn't figure out and so

362
00:23:08,809 --> 00:23:20,360
it's the camera looks like botnet about

363
00:23:14,510 --> 00:23:24,950
the binary this is whoa one burner who

364
00:23:20,360 --> 00:23:27,549
opens the port it's a girl they're not

365
00:23:24,950 --> 00:23:30,880
exact I will show you later where is

366
00:23:27,549 --> 00:23:33,740
interesting how to code carpod extreme

367
00:23:30,880 --> 00:23:38,179
developers didn't remove any net

368
00:23:33,740 --> 00:23:42,890
information we can see how it was built

369
00:23:38,179 --> 00:23:46,760
where it was built and some strange are

370
00:23:42,890 --> 00:23:55,020
called hidden folders flex net in the

371
00:23:46,760 --> 00:24:00,629
sea folder so we will find

372
00:23:55,020 --> 00:24:06,750
in after after our research who we would

373
00:24:00,630 --> 00:24:09,780
move up like five vulnerabilities and

374
00:24:06,750 --> 00:24:14,910
the one logical progression is collation

375
00:24:09,780 --> 00:24:17,129
of customization and weather

376
00:24:14,910 --> 00:24:25,170
I will show you a live demo of the

377
00:24:17,130 --> 00:24:27,300
explosion it's very a lot more deeper so

378
00:24:25,170 --> 00:24:33,440
as I told you there is a longer there

379
00:24:27,300 --> 00:24:38,790
that exact process it opens TCP port

380
00:24:33,440 --> 00:24:42,510
2700 it use custom protocol we

381
00:24:38,790 --> 00:24:46,950
discovered that in this protocol there

382
00:24:42,510 --> 00:24:49,980
is checksums to checksums I have never

383
00:24:46,950 --> 00:24:58,890
seen that before I will show how it

384
00:24:49,980 --> 00:25:02,040
works it's it's quite easy to reverse

385
00:24:58,890 --> 00:25:06,540
people because there is no code

386
00:25:02,040 --> 00:25:09,750
protection it's easier to use a reverse

387
00:25:06,540 --> 00:25:14,490
tool when I eat either draw two rivers

388
00:25:09,750 --> 00:25:17,400
and to see how it works inside so that

389
00:25:14,490 --> 00:25:23,090
about a custom protocol is the first

390
00:25:17,400 --> 00:25:26,480
bite the comic made by a bliss to

391
00:25:23,090 --> 00:25:32,610
case-mate occupied and the special case

392
00:25:26,480 --> 00:25:36,900
it may divide to F in hex the first case

393
00:25:32,610 --> 00:25:40,560
very simple the second part of the

394
00:25:36,900 --> 00:25:46,620
protocol is a checksum checksum is for

395
00:25:40,560 --> 00:25:53,370
the control of the like stability in the

396
00:25:46,620 --> 00:25:55,229
it plays you we can if we want to

397
00:25:53,370 --> 00:26:00,780
further the application

398
00:25:55,230 --> 00:26:08,570
we can't like center like a trash data

399
00:26:00,780 --> 00:26:14,010
we should fix this field to do like to

400
00:26:08,570 --> 00:26:17,820
call like a lot of cases in the binary

401
00:26:14,010 --> 00:26:20,760
so this checks some calculated very

402
00:26:17,820 --> 00:26:25,710
simple it's assumed of all bytes in the

403
00:26:20,760 --> 00:26:32,220
package except the itself the second

404
00:26:25,710 --> 00:26:38,490
case the first byte is to F the checksum

405
00:26:32,220 --> 00:26:42,660
is first 20 bytes assume of 20 bytes of

406
00:26:38,490 --> 00:26:45,390
the packet the second check soon I will

407
00:26:42,660 --> 00:26:54,750
show you later how what it look like a

408
00:26:45,390 --> 00:26:59,520
Serie C 16 and left and method method so

409
00:26:54,750 --> 00:27:02,940
if we want to call some action we should

410
00:26:59,520 --> 00:27:05,809
point the method I will show you later

411
00:27:02,940 --> 00:27:08,370
and they dated to the attach the method

412
00:27:05,809 --> 00:27:12,360
we have no idea about the minutes

413
00:27:08,370 --> 00:27:18,080
yes also how to collect it about the I

414
00:27:12,360 --> 00:27:22,168
told you about the like the first check

415
00:27:18,080 --> 00:27:24,740
sum of all the first case its sum of all

416
00:27:22,169 --> 00:27:33,900
bytes of the packet the second case is

417
00:27:24,740 --> 00:27:37,980
so of 20 bytes 1 1 point X at X so you

418
00:27:33,900 --> 00:27:42,000
can see the part of code and laser you

419
00:27:37,980 --> 00:27:46,790
know it's like I see receives 16

420
00:27:42,000 --> 00:27:49,650
modification but table is completed very

421
00:27:46,790 --> 00:27:55,230
like very funny you can see the

422
00:27:49,650 --> 00:27:58,140
easter-egg there is constant it if you

423
00:27:55,230 --> 00:28:01,430
print it down to the top

424
00:27:58,140 --> 00:28:05,180
this 1 3 8 5 p.m.

425
00:28:01,430 --> 00:28:14,870
it's like a smile it's I don't know why

426
00:28:05,180 --> 00:28:19,309
developer like booted it's like fun so

427
00:28:14,870 --> 00:28:22,459
we decided to do a stupid visor it's we

428
00:28:19,309 --> 00:28:25,790
were all sent the trash some random data

429
00:28:22,460 --> 00:28:29,809
to the port 2700 and see the refs

430
00:28:25,790 --> 00:28:32,510
reaction of application and fix the

431
00:28:29,809 --> 00:28:36,020
check soon both we know they're ugly

432
00:28:32,510 --> 00:28:43,510
so we modificated the tag data fix the

433
00:28:36,020 --> 00:28:47,780
song answer to the to to the application

434
00:28:43,510 --> 00:28:51,890
application also has a log file and it

435
00:28:47,780 --> 00:28:54,950
show if we see the locally the log file

436
00:28:51,890 --> 00:28:58,250
there are will pay a lot of in a strange

437
00:28:54,950 --> 00:29:01,700
like you can see when borrow a temporal

438
00:28:58,250 --> 00:29:04,790
to and raised in the quotes the number

439
00:29:01,700 --> 00:29:07,550
it's number is odd like our method so we

440
00:29:04,790 --> 00:29:14,000
discovered like the name of the method

441
00:29:07,550 --> 00:29:18,230
so maybe some special methods and our

442
00:29:14,000 --> 00:29:23,390
visor was work and what case was very

443
00:29:18,230 --> 00:29:25,700
interested deprecation application was

444
00:29:23,390 --> 00:29:29,090
shut down that's it

445
00:29:25,700 --> 00:29:33,710
without an exception by design and more

446
00:29:29,090 --> 00:29:36,139
it both the line in the log file it's

447
00:29:33,710 --> 00:29:38,660
alleged shutdown so the reason like

448
00:29:36,140 --> 00:29:42,730
comment without authorization we can

449
00:29:38,660 --> 00:29:46,610
shut down the process okay yes it's

450
00:29:42,730 --> 00:29:50,050
logical dose by design well there are

451
00:29:46,610 --> 00:29:50,050
the other told us this is a teacher

452
00:29:51,980 --> 00:30:00,080
we tried we substituted fuel Faisal is

453
00:29:57,110 --> 00:30:03,590
like okay but it's not enough who tried

454
00:30:00,080 --> 00:30:06,919
to use with I fell after your father is

455
00:30:03,590 --> 00:30:11,929
American father loop we is other like

456
00:30:06,920 --> 00:30:15,530
fit to the windows eyepatch all for a

457
00:30:11,930 --> 00:30:18,740
fart and socket receive said it was work

458
00:30:15,530 --> 00:30:22,960
for one day

459
00:30:18,740 --> 00:30:30,350
and after that profit over less than 400

460
00:30:22,960 --> 00:30:32,600
for vulnerabilities but you know okay

461
00:30:30,350 --> 00:30:36,939
sorry I was solving the city of this

462
00:30:32,600 --> 00:30:41,389
right now okay so do you flex not

463
00:30:36,940 --> 00:30:45,980
unfortunately so we started searching

464
00:30:41,390 --> 00:30:48,470
this manager for the some customization

465
00:30:45,980 --> 00:30:50,830
and we found one really huge vendor that

466
00:30:48,470 --> 00:30:52,520
was really interesting to study

467
00:30:50,830 --> 00:30:54,710
unfortunately right now we cannot

468
00:30:52,520 --> 00:30:57,740
disclose the vendor we can do will be

469
00:30:54,710 --> 00:31:01,730
able to do it is after December

470
00:30:57,740 --> 00:31:03,860
something s image before they do the

471
00:31:01,730 --> 00:31:05,360
customization and this type of the

472
00:31:03,860 --> 00:31:08,090
customization brought us a very

473
00:31:05,360 --> 00:31:11,659
interesting box so in the wild you

474
00:31:08,090 --> 00:31:15,050
basically cannot see it very often it's

475
00:31:11,660 --> 00:31:17,210
a logical local privilege escalation so

476
00:31:15,050 --> 00:31:18,680
usually if you see the local privilege

477
00:31:17,210 --> 00:31:22,940
escalation it's more like binary

478
00:31:18,680 --> 00:31:25,400
vulnerability and well there is always a

479
00:31:22,940 --> 00:31:28,250
risk to crush something that you the

480
00:31:25,400 --> 00:31:32,300
binary vulnerability exploitation and

481
00:31:28,250 --> 00:31:34,880
here we see the logical local privilege

482
00:31:32,300 --> 00:31:40,310
escalation that gives you straight

483
00:31:34,880 --> 00:31:42,770
system privileges and also if you take

484
00:31:40,310 --> 00:31:44,240
this customization you will see all the

485
00:31:42,770 --> 00:31:45,889
same vulnerabilities that we found

486
00:31:44,240 --> 00:31:48,320
before the logical

487
00:31:45,890 --> 00:31:50,950
shutdown process shutdown and everything

488
00:31:48,320 --> 00:31:53,860
so basically in the customization

489
00:31:50,950 --> 00:31:58,630
see more bugs than more vulnerabilities

490
00:31:53,860 --> 00:32:00,668
than in default installation and we will

491
00:31:58,630 --> 00:32:03,909
be showing right now the live demo of

492
00:32:00,669 --> 00:32:08,679
local privilege escalation with one very

493
00:32:03,909 --> 00:32:10,570
interesting thing so everyone like all

494
00:32:08,679 --> 00:32:12,549
the developers of Windows separation

495
00:32:10,570 --> 00:32:15,070
system they were lying to you saying

496
00:32:12,549 --> 00:32:17,889
that there is no desktop for system user

497
00:32:15,070 --> 00:32:19,450
during this exploitation we will be

498
00:32:17,889 --> 00:32:23,408
showing the first time in the history

499
00:32:19,450 --> 00:32:28,320
the desktop of a building system user

500
00:32:23,409 --> 00:32:28,320
okay so we have down

501
00:33:02,090 --> 00:33:17,689
oh yes okay so this is the windows they

502
00:33:14,630 --> 00:33:24,169
pick our secret together application is

503
00:33:17,690 --> 00:33:28,539
already installed we will open like user

504
00:33:24,169 --> 00:33:36,260
limited permissions its standard user

505
00:33:28,539 --> 00:33:39,440
can't even create folder at the example

506
00:33:36,260 --> 00:33:49,640
if we try to create the folder to the

507
00:33:39,440 --> 00:33:54,490
individuals no no it's I think okay it's

508
00:33:49,640 --> 00:33:57,669
possible but there is okay this is

509
00:33:54,490 --> 00:34:05,000
limited user is for sure

510
00:33:57,669 --> 00:34:07,909
it's possible to create the files in the

511
00:34:05,000 --> 00:34:11,780
root folder and ooh

512
00:34:07,909 --> 00:34:16,089
Oh not files folder and the folder will

513
00:34:11,780 --> 00:34:23,419
be possible to create a file in a file

514
00:34:16,089 --> 00:34:26,000
and so the process is launched the

515
00:34:23,418 --> 00:34:29,540
reason we use it the first lot logical

516
00:34:26,000 --> 00:34:38,589
those as I told you okay let's let us

517
00:34:29,540 --> 00:34:43,000
switch off okay you can see information

518
00:34:38,589 --> 00:34:47,239
it's like tools by design it's inside

519
00:34:43,000 --> 00:34:50,210
installed with the Flex net also like

520
00:34:47,239 --> 00:34:55,368
you can use as like a user and send the

521
00:34:50,210 --> 00:35:00,849
shuttle comment okay yes so it's

522
00:34:55,369 --> 00:35:00,849
shutdown and after that it's possible to

523
00:35:01,869 --> 00:35:05,849
to modificated

524
00:35:05,089 --> 00:35:11,900
one

525
00:35:05,849 --> 00:35:14,940
a license manager config file this dude

526
00:35:11,900 --> 00:35:17,700
you can see it config file it's our

527
00:35:14,940 --> 00:35:21,839
custom config file but this field or one

528
00:35:17,700 --> 00:35:27,149
field is very interesting there is this

529
00:35:21,839 --> 00:35:31,710
gene will drop a cropped and edit dotnet

530
00:35:27,150 --> 00:35:35,730
exam and lunched by the service when it

531
00:35:31,710 --> 00:35:40,109
starts so it's the limitation on the

532
00:35:35,730 --> 00:35:45,990
tech bytes that's why we will create we

533
00:35:40,109 --> 00:35:50,730
will do the next way create the folder

534
00:35:45,990 --> 00:35:54,118
why and create the white dot example

535
00:35:50,730 --> 00:35:57,720
I'll show you contained and we needn't

536
00:35:54,119 --> 00:36:03,420
to add the dot exact because it will do

537
00:35:57,720 --> 00:36:07,040
edit can then save it so first we should

538
00:36:03,420 --> 00:36:13,730
create them as I told them well it's

539
00:36:07,040 --> 00:36:21,380
possible to create folder why and copy

540
00:36:13,730 --> 00:36:21,380
the you can see the file

541
00:36:26,619 --> 00:36:34,369
you know it's it's simple it's create

542
00:36:30,980 --> 00:36:36,200
this service and started seeing their

543
00:36:34,369 --> 00:36:40,820
exact that's it it's file

544
00:36:36,200 --> 00:36:45,830
we've user interaction type we compiled

545
00:36:40,820 --> 00:36:51,070
it and there is y dot excel file okay we

546
00:36:45,830 --> 00:36:54,348
got it to this order and also we've

547
00:36:51,070 --> 00:36:59,869
various installed some service with one

548
00:36:54,349 --> 00:37:03,770
custom port we can send the packet and

549
00:36:59,869 --> 00:37:07,580
eat a whale will start the again the

550
00:37:03,770 --> 00:37:12,609
service Eliza license manager it's like

551
00:37:07,580 --> 00:37:12,609
a feature that's also ok start service

552
00:37:13,690 --> 00:37:21,349
and you can see the first of the history

553
00:37:17,090 --> 00:37:29,000
the the stop of sister or user okay

554
00:37:21,349 --> 00:37:39,160
Oh a view message once Nick okay this is

555
00:37:29,000 --> 00:37:42,280
the scope of system user I system so

556
00:37:39,160 --> 00:37:42,279
that's it

557
00:37:53,599 --> 00:38:01,430
so in conclusion of this research so the

558
00:37:57,310 --> 00:38:06,950
most of the fix is gonna show up after

559
00:38:01,430 --> 00:38:08,509
this member xx this here we can we can

560
00:38:06,950 --> 00:38:10,879
definitely say that these guys are using

561
00:38:08,510 --> 00:38:13,839
a security development lifecycle during

562
00:38:10,880 --> 00:38:17,259
the development process and

563
00:38:13,839 --> 00:38:18,609
which is really good because there are

564
00:38:17,259 --> 00:38:20,380
some vulnerabilities that we have a

565
00:38:18,609 --> 00:38:23,319
reported one is the remote code

566
00:38:20,380 --> 00:38:26,009
execution so and we can say that it was

567
00:38:23,319 --> 00:38:28,960
pretty hard to execute the code and

568
00:38:26,009 --> 00:38:32,200
based on our previous researcher we

569
00:38:28,960 --> 00:38:35,920
still believe that we still have more

570
00:38:32,200 --> 00:38:36,848
things to research in this area so what

571
00:38:35,920 --> 00:38:39,190
next

572
00:38:36,849 --> 00:38:41,410
we plan to continue researching

573
00:38:39,190 --> 00:38:43,299
different other different license

574
00:38:41,410 --> 00:38:46,140
managers because it looks like for us a

575
00:38:43,299 --> 00:38:49,329
great and interesting topic for research

576
00:38:46,140 --> 00:38:53,200
as well as the other common and

577
00:38:49,329 --> 00:38:56,829
cross-platform multi vendor solutions

578
00:38:53,200 --> 00:38:58,718
and technologies because there are if it

579
00:38:56,829 --> 00:39:00,670
turns out that there are different many

580
00:38:58,719 --> 00:39:04,150
types of the technologies that are being

581
00:39:00,670 --> 00:39:07,660
used by many multiple vendors and those

582
00:39:04,150 --> 00:39:10,839
technologies can be a very bad thing for

583
00:39:07,660 --> 00:39:13,868
those vendors and we plan to publish a

584
00:39:10,839 --> 00:39:19,150
bigger research paper in the q1 or q2 of

585
00:39:13,869 --> 00:39:22,809
the next year s the conclusion we would

586
00:39:19,150 --> 00:39:25,269
like to have a short message that so if

587
00:39:22,809 --> 00:39:28,839
you're a vendor you just cannot trust

588
00:39:25,269 --> 00:39:31,660
anyone so it just it might sound really

589
00:39:28,839 --> 00:39:33,489
obvious but not so many vendors are

590
00:39:31,660 --> 00:39:36,450
listening to it so if you are in

591
00:39:33,489 --> 00:39:39,849
including the third-party code in your

592
00:39:36,450 --> 00:39:42,279
system it might be but you should do the

593
00:39:39,849 --> 00:39:45,009
code checking every time you should took

594
00:39:42,279 --> 00:39:47,049
the vulnerability research you should

595
00:39:45,009 --> 00:39:49,960
always implement all the security

596
00:39:47,049 --> 00:39:53,170
features and mechanisms having by

597
00:39:49,960 --> 00:39:56,799
default by many compilers you need to

598
00:39:53,170 --> 00:39:58,040
have the red team or vulnerable internal

599
00:39:56,799 --> 00:40:01,130
vulnerability

600
00:39:58,040 --> 00:40:04,100
Church - who is practicing a lot in

601
00:40:01,130 --> 00:40:06,830
fussing fussing technologies because if

602
00:40:04,100 --> 00:40:08,839
you invest time and money into the

603
00:40:06,830 --> 00:40:10,640
fighting it will remove most of the

604
00:40:08,840 --> 00:40:15,110
binary vulnerabilities on the first

605
00:40:10,640 --> 00:40:17,060
second of the third run and will also

606
00:40:15,110 --> 00:40:19,340
advise you to do the third-party

607
00:40:17,060 --> 00:40:21,410
vulnerability research so basically it's

608
00:40:19,340 --> 00:40:23,570
like hiring the third-party company

609
00:40:21,410 --> 00:40:26,779
because basically they receiving the

610
00:40:23,570 --> 00:40:27,830
money for finding the box and again

611
00:40:26,780 --> 00:40:31,250
trust no one

612
00:40:27,830 --> 00:40:33,549
Soviets it might be obvious but you need

613
00:40:31,250 --> 00:40:35,990
to always keep in mind if you're a

614
00:40:33,550 --> 00:40:39,740
business to business customer so there

615
00:40:35,990 --> 00:40:42,560
are several obvious recommendations we

616
00:40:39,740 --> 00:40:45,109
don't if you want to attach them so like

617
00:40:42,560 --> 00:40:47,210
implementing defense and depth

618
00:40:45,110 --> 00:40:50,890
strategies and everything all those kind

619
00:40:47,210 --> 00:40:54,200
of things and if you are researcher we

620
00:40:50,890 --> 00:40:56,180
we want you to do the only responsible

621
00:40:54,200 --> 00:40:58,430
disclosure so if you have identified the

622
00:40:56,180 --> 00:41:03,740
vulnerability reported directly to the

623
00:40:58,430 --> 00:41:05,450
vendor wait for the until the vendor is

624
00:41:03,740 --> 00:41:07,959
fixed and you can publish like the

625
00:41:05,450 --> 00:41:10,310
research white paper and everything and

626
00:41:07,960 --> 00:41:12,170
it's really good to study common

627
00:41:10,310 --> 00:41:14,480
technologies and multi vendor

628
00:41:12,170 --> 00:41:16,730
technologists because if you're a

629
00:41:14,480 --> 00:41:19,310
penetration tester it helps you a lot

630
00:41:16,730 --> 00:41:21,830
during the project so let's say you have

631
00:41:19,310 --> 00:41:25,310
like a window separation system with all

632
00:41:21,830 --> 00:41:27,680
the installed features and everything

633
00:41:25,310 --> 00:41:31,570
but you have that a tiny little license

634
00:41:27,680 --> 00:41:33,430
manager that is not being studied by

635
00:41:31,570 --> 00:41:37,150
the researchers and you have like that

636
00:41:33,430 --> 00:41:38,919
huge you know security thing that helps

637
00:41:37,150 --> 00:41:40,990
you to get into the system and

638
00:41:38,920 --> 00:41:43,240
everything so studying the third-party

639
00:41:40,990 --> 00:41:45,279
code is very interesting and challenging

640
00:41:43,240 --> 00:41:48,609
and helps you a lot in the penetration

641
00:41:45,280 --> 00:41:51,090
testing so thank you really for your

642
00:41:48,610 --> 00:41:51,090
attention

