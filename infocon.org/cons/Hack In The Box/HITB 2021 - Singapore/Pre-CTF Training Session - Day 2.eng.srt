1
00:00:31,119 --> 00:00:33,040
all right i think i think that's pretty

2
00:00:33,040 --> 00:00:35,200
much everybody who's going to come right

3
00:00:35,200 --> 00:00:36,239
now

4
00:00:36,239 --> 00:00:37,600
uh

5
00:00:37,600 --> 00:00:39,040
other people might be joining a bit late

6
00:00:39,040 --> 00:00:41,520
they might join us a bit late so

7
00:00:41,520 --> 00:00:42,840
um hello

8
00:00:42,840 --> 00:00:46,160
everybody uh again my name is yusuf and

9
00:00:46,160 --> 00:00:50,640
uh alongside me is my partner ahmed and

10
00:00:50,640 --> 00:00:53,600
welcome to the day two of training so

11
00:00:53,600 --> 00:00:55,840
today is going to be exciting today

12
00:00:55,840 --> 00:00:57,280
we're gonna move on in the material

13
00:00:57,280 --> 00:01:00,559
we're going to have a lot more fun

14
00:01:00,559 --> 00:01:02,719
and we're finally going to get to

15
00:01:02,719 --> 00:01:03,680
hacking

16
00:01:03,680 --> 00:01:06,320
services submitting flags and moving up

17
00:01:06,320 --> 00:01:08,720
on that scoreboard all right so let's

18
00:01:08,720 --> 00:01:10,720
start by i'm going to start by sharing

19
00:01:10,720 --> 00:01:13,360
my screen

20
00:01:13,360 --> 00:01:15,759
right and you guys just give me

21
00:01:15,759 --> 00:01:19,200
any signal that you can see

22
00:01:20,080 --> 00:01:22,240
yes we can see

23
00:01:22,240 --> 00:01:24,720
all right thank you so let's take a look

24
00:01:24,720 --> 00:01:26,159
at the scoreboard which is the biggest

25
00:01:26,159 --> 00:01:29,040
thing that has changed all right so

26
00:01:29,040 --> 00:01:31,200
it as you can see there are some teams

27
00:01:31,200 --> 00:01:34,560
who were very busy all night and they

28
00:01:34,560 --> 00:01:36,400
hacked all services so you can see that

29
00:01:36,400 --> 00:01:39,040
all four services have been hacked and

30
00:01:39,040 --> 00:01:41,040
flags are being stolen from them and so

31
00:01:41,040 --> 00:01:42,240
they moved up

32
00:01:42,240 --> 00:01:45,280
on the leaderboard some teams only

33
00:01:45,280 --> 00:01:47,520
managed to exploit two services some

34
00:01:47,520 --> 00:01:50,320
teams got one service and it's fine for

35
00:01:50,320 --> 00:01:52,320
the rest of you that you didn't do much

36
00:01:52,320 --> 00:01:54,159
which is fine some teams are going to

37
00:01:54,159 --> 00:01:55,600
jump a little bit ahead maybe they have

38
00:01:55,600 --> 00:01:57,200
experience with the platform they've

39
00:01:57,200 --> 00:01:59,040
done this sort of thing before

40
00:01:59,040 --> 00:02:01,200
and that's more than fine okay don't get

41
00:02:01,200 --> 00:02:02,880
demotivated don't think oh we're going

42
00:02:02,880 --> 00:02:04,560
to get destroyed now there's no point no

43
00:02:04,560 --> 00:02:06,560
there's always a chance all right if all

44
00:02:06,560 --> 00:02:08,479
of you are put on equal ground things

45
00:02:08,479 --> 00:02:10,239
would be a little bit more different all

46
00:02:10,239 --> 00:02:12,080
right especially since some of you

47
00:02:12,080 --> 00:02:13,840
attended the training so late at night

48
00:02:13,840 --> 00:02:15,760
and you had to sleep after it so don't

49
00:02:15,760 --> 00:02:17,760
worry about it now i can see that a lot

50
00:02:17,760 --> 00:02:19,840
of you guys have your services as down

51
00:02:19,840 --> 00:02:21,040
like

52
00:02:21,040 --> 00:02:23,200
a lot of teams have their services down

53
00:02:23,200 --> 00:02:25,520
and i think i know the issue behind that

54
00:02:25,520 --> 00:02:28,319
so i need everybody who's here to ssh

55
00:02:28,319 --> 00:02:30,640
into your

56
00:02:30,640 --> 00:02:33,280
your virtual machines okay as i am right

57
00:02:33,280 --> 00:02:35,720
now and i need you to do

58
00:02:35,720 --> 00:02:38,319
df-h slash

59
00:02:38,319 --> 00:02:39,120
now

60
00:02:39,120 --> 00:02:41,760
if your virtual machine tells you that

61
00:02:41,760 --> 00:02:44,080
you have no space left

62
00:02:44,080 --> 00:02:46,959
you have 0gb of space left

63
00:02:46,959 --> 00:02:47,760
then

64
00:02:47,760 --> 00:02:50,640
you probably left your tcp dump command

65
00:02:50,640 --> 00:02:53,519
running all night and it just made 150

66
00:02:53,519 --> 00:02:55,200
gb pcap file

67
00:02:55,200 --> 00:02:57,200
and so the system has no more space so

68
00:02:57,200 --> 00:02:58,959
your services are down

69
00:02:58,959 --> 00:03:01,120
so if that is the case

70
00:03:01,120 --> 00:03:04,000
go into your tmux sessions or go find

71
00:03:04,000 --> 00:03:06,239
the tcp dump command that was running

72
00:03:06,239 --> 00:03:09,840
and kill it and remove the pcap files

73
00:03:09,840 --> 00:03:12,319
all right now for everybody else if

74
00:03:12,319 --> 00:03:14,000
you're now now once you guys i'll give

75
00:03:14,000 --> 00:03:15,840
you a couple of seconds to remove the

76
00:03:15,840 --> 00:03:18,959
pcaps and fix your space issues if that

77
00:03:18,959 --> 00:03:20,560
is what happened because that's what

78
00:03:20,560 --> 00:03:22,239
happened to me as well i logged in and i

79
00:03:22,239 --> 00:03:24,959
had 0gb of space so i was like oh i left

80
00:03:24,959 --> 00:03:26,959
the p-cap running all night by accident

81
00:03:26,959 --> 00:03:28,879
so here we go

82
00:03:28,879 --> 00:03:30,640
usually in the competition you would

83
00:03:30,640 --> 00:03:32,080
remove the p cap every once in a while

84
00:03:32,080 --> 00:03:34,319
you would clear it just empty it

85
00:03:34,319 --> 00:03:38,798
obviously nobody needs 150 gbp gap

86
00:03:39,440 --> 00:03:40,239
so

87
00:03:40,239 --> 00:03:42,560
i'm assuming now that most of you have

88
00:03:42,560 --> 00:03:44,959
logged in and you've started to you know

89
00:03:44,959 --> 00:03:46,879
fix up everything so the first thing

90
00:03:46,879 --> 00:03:47,920
we're going to do is we're going to

91
00:03:47,920 --> 00:03:50,000
restart our services now you have two

92
00:03:50,000 --> 00:03:51,840
ways of doing this you can either

93
00:03:51,840 --> 00:03:53,760
restore the snapshot that you took

94
00:03:53,760 --> 00:03:55,680
yesterday the initial snapshot that you

95
00:03:55,680 --> 00:03:57,360
took yesterday

96
00:03:57,360 --> 00:03:59,040
from the cloud console

97
00:03:59,040 --> 00:04:01,040
but you'll lose anything that you might

98
00:04:01,040 --> 00:04:02,640
have installed on the machine especially

99
00:04:02,640 --> 00:04:04,560
current so if you set up quarant with me

100
00:04:04,560 --> 00:04:06,799
yesterday you will lose it if you

101
00:04:06,799 --> 00:04:09,519
restore your snapshot however

102
00:04:09,519 --> 00:04:12,000
you you can reinstall it if that's what

103
00:04:12,000 --> 00:04:13,519
you want if you feel like it's better to

104
00:04:13,519 --> 00:04:15,360
just go back to a default state

105
00:04:15,360 --> 00:04:16,880
especially for those of you who might

106
00:04:16,880 --> 00:04:18,478
have issues essentially into their

107
00:04:18,478 --> 00:04:20,160
machines in the first place

108
00:04:20,160 --> 00:04:22,240
if you can't even like your machine is

109
00:04:22,240 --> 00:04:24,400
not even responding to you trying to log

110
00:04:24,400 --> 00:04:26,320
in it's best to just restore the

111
00:04:26,320 --> 00:04:27,440
snapshot

112
00:04:27,440 --> 00:04:28,880
all right and you can install carrant

113
00:04:28,880 --> 00:04:30,720
again you guys have the slides and you

114
00:04:30,720 --> 00:04:32,320
have all the materials so speaking of

115
00:04:32,320 --> 00:04:34,000
slides i'm going to drop in the slides

116
00:04:34,000 --> 00:04:35,840
here for some people actually i'm going

117
00:04:35,840 --> 00:04:37,680
to wait a bit before i drop the slides

118
00:04:37,680 --> 00:04:38,479
because

119
00:04:38,479 --> 00:04:40,080
i feel like some teams are going to just

120
00:04:40,080 --> 00:04:41,919
get too excited and go and start

121
00:04:41,919 --> 00:04:43,759
exploiting and that's not quite what i

122
00:04:43,759 --> 00:04:45,759
want them to do right now so i need you

123
00:04:45,759 --> 00:04:47,280
guys to stay with me as much as you can

124
00:04:47,280 --> 00:04:48,240
i promise we're going to get to the

125
00:04:48,240 --> 00:04:50,720
exploiting part as fast as possible

126
00:04:50,720 --> 00:04:53,199
so let's restart our services since most

127
00:04:53,199 --> 00:04:54,880
of our services apparently on the

128
00:04:54,880 --> 00:04:57,600
scoreboard are mumble and down

129
00:04:57,600 --> 00:04:59,520
so you're going to go to slash home

130
00:04:59,520 --> 00:05:00,720
you're going to see all your different

131
00:05:00,720 --> 00:05:02,479
services you're going to go into your

132
00:05:02,479 --> 00:05:04,160
services one by one so i'm going to

133
00:05:04,160 --> 00:05:05,680
start with coffee pot and you're going

134
00:05:05,680 --> 00:05:07,759
to run the following command docker

135
00:05:07,759 --> 00:05:09,039
compose

136
00:05:09,039 --> 00:05:12,479
up dash dash build

137
00:05:12,479 --> 00:05:14,080
dash dash force

138
00:05:14,080 --> 00:05:15,520
recreate

139
00:05:15,520 --> 00:05:17,840
and dash d so what this is what this is

140
00:05:17,840 --> 00:05:19,039
doing is that we're forcing the

141
00:05:19,039 --> 00:05:20,880
container to be rebuilt from scratch

142
00:05:20,880 --> 00:05:23,280
again and we're redeploying it and we're

143
00:05:23,280 --> 00:05:24,560
putting it in the background so we're

144
00:05:24,560 --> 00:05:25,600
letting the container run in the

145
00:05:25,600 --> 00:05:27,680
background this is to restart all our

146
00:05:27,680 --> 00:05:30,000
containers back to the initial state so

147
00:05:30,000 --> 00:05:32,160
that any exploits any issues that might

148
00:05:32,160 --> 00:05:34,320
have happened are now gone so i'm gonna

149
00:05:34,320 --> 00:05:36,160
copy this command if my terminal would

150
00:05:36,160 --> 00:05:37,120
let me

151
00:05:37,120 --> 00:05:39,919
and paste it here okay

152
00:05:39,919 --> 00:05:42,080
all of you go one by one into your so

153
00:05:42,080 --> 00:05:45,360
i'm gonna do this on coffee pot

154
00:05:45,360 --> 00:05:47,199
and that just rebuilds the coffee pot

155
00:05:47,199 --> 00:05:49,120
container it's recreating the service

156
00:05:49,120 --> 00:05:52,280
right now

157
00:05:55,120 --> 00:05:57,039
and it's done all right

158
00:05:57,039 --> 00:05:58,319
and now i'm going to go back so i'm

159
00:05:58,319 --> 00:05:59,759
going to go back to home

160
00:05:59,759 --> 00:06:01,680
and there's another service free life so

161
00:06:01,680 --> 00:06:02,639
i'm going to go to free life i'm going

162
00:06:02,639 --> 00:06:04,240
to paste the command again i'm going to

163
00:06:04,240 --> 00:06:06,960
rebuild free life that's it free life is

164
00:06:06,960 --> 00:06:07,759
done

165
00:06:07,759 --> 00:06:08,960
we're gonna go into the next service

166
00:06:08,960 --> 00:06:10,479
health monitor we're gonna rebuild

167
00:06:10,479 --> 00:06:13,120
health monitor

168
00:06:13,520 --> 00:06:14,800
there we go

169
00:06:14,800 --> 00:06:15,600
and

170
00:06:15,600 --> 00:06:17,520
nope i wanted to type ls

171
00:06:17,520 --> 00:06:19,120
we're gonna go into nasa rasa our final

172
00:06:19,120 --> 00:06:22,080
service and we are going to rebuild

173
00:06:22,080 --> 00:06:24,800
asarasa

174
00:06:25,199 --> 00:06:26,000
all right

175
00:06:26,000 --> 00:06:27,919
now i have a feeling someone must must

176
00:06:27,919 --> 00:06:29,520
have probably logged into my quran

177
00:06:29,520 --> 00:06:31,280
overnight and just destroyed it so i'm

178
00:06:31,280 --> 00:06:33,600
just going to stop my current service

179
00:06:33,600 --> 00:06:35,280
you guys can feel free to leave your

180
00:06:35,280 --> 00:06:37,440
current services running as long as you

181
00:06:37,440 --> 00:06:39,520
guys just double check on your current

182
00:06:39,520 --> 00:06:41,600
services double check that you guys

183
00:06:41,600 --> 00:06:43,120
added authentication and everything is

184
00:06:43,120 --> 00:06:44,960
going well other than that i'm going to

185
00:06:44,960 --> 00:06:46,479
take mine down because i don't need them

186
00:06:46,479 --> 00:06:49,479
anymore

187
00:06:53,599 --> 00:06:54,880
if you guys also feel like you don't

188
00:06:54,880 --> 00:06:56,800
need your current services you can do

189
00:06:56,800 --> 00:06:59,120
docker compose down inside current all

190
00:06:59,120 --> 00:07:00,000
right

191
00:07:00,000 --> 00:07:01,680
and we're back

192
00:07:01,680 --> 00:07:03,199
to how we were

193
00:07:03,199 --> 00:07:05,199
so all my services should be up if i go

194
00:07:05,199 --> 00:07:09,280
to the scoreboard i am org one

195
00:07:09,520 --> 00:07:11,520
where is org one or guan and you can see

196
00:07:11,520 --> 00:07:13,919
all my services are green up

197
00:07:13,919 --> 00:07:15,440
and i'm gonna explain what the

198
00:07:15,440 --> 00:07:16,800
scoreboard means you guys are seeing a

199
00:07:16,800 --> 00:07:18,319
lot of numbers here and i'm going to

200
00:07:18,319 --> 00:07:19,440
explain

201
00:07:19,440 --> 00:07:21,360
what all these numbers mean

202
00:07:21,360 --> 00:07:22,160
okay

203
00:07:22,160 --> 00:07:24,160
let's start with

204
00:07:24,160 --> 00:07:25,520
let's start with with the colors you're

205
00:07:25,520 --> 00:07:27,599
seeing here all right

206
00:07:27,599 --> 00:07:29,440
so

207
00:07:29,440 --> 00:07:31,280
let's look at green so these arrows at

208
00:07:31,280 --> 00:07:33,039
the bottom under each service that means

209
00:07:33,039 --> 00:07:35,039
the service is up and this is the

210
00:07:35,039 --> 00:07:36,720
percentage sla

211
00:07:36,720 --> 00:07:37,680
okay

212
00:07:37,680 --> 00:07:39,520
so this team

213
00:07:39,520 --> 00:07:40,720
this team

214
00:07:40,720 --> 00:07:44,080
has 94 percent

215
00:07:44,080 --> 00:07:47,360
sla kind of all right they've been up

216
00:07:47,360 --> 00:07:49,599
94 of the game all their services have

217
00:07:49,599 --> 00:07:52,960
been up 90 plus percent some people

218
00:07:52,960 --> 00:07:54,960
for example like team number six right

219
00:07:54,960 --> 00:07:56,240
now

220
00:07:56,240 --> 00:07:58,240
or in the sixth position has most of

221
00:07:58,240 --> 00:08:00,000
their services are down and they've been

222
00:08:00,000 --> 00:08:02,400
up only 26 of the game

223
00:08:02,400 --> 00:08:04,479
some teams their services are mumbling

224
00:08:04,479 --> 00:08:07,039
so they're sort of working

225
00:08:07,039 --> 00:08:08,639
you know mumble i thought we did we

226
00:08:08,639 --> 00:08:10,240
discussed mumbo yesterday which means

227
00:08:10,240 --> 00:08:12,000
that the service isn't working properly

228
00:08:12,000 --> 00:08:13,520
so this is probably they tried to patch

229
00:08:13,520 --> 00:08:15,440
their service and they didn't patch it

230
00:08:15,440 --> 00:08:17,120
properly

231
00:08:17,120 --> 00:08:18,400
um

232
00:08:18,400 --> 00:08:20,560
most of services are mumble these could

233
00:08:20,560 --> 00:08:22,720
be as a result of exploits like bad

234
00:08:22,720 --> 00:08:24,479
exploits that destroyed the service and

235
00:08:24,479 --> 00:08:25,840
that's fine all you got to do is reset

236
00:08:25,840 --> 00:08:28,080
your containers and you're going to be

237
00:08:28,080 --> 00:08:29,680
as good as new so you can see a lot of

238
00:08:29,680 --> 00:08:31,520
teams now have started to restart their

239
00:08:31,520 --> 00:08:34,000
services and your sla is going up as you

240
00:08:34,000 --> 00:08:35,039
can see

241
00:08:35,039 --> 00:08:37,599
your sla sees here so the average sla

242
00:08:37,599 --> 00:08:39,440
you can expand your team you'll see the

243
00:08:39,440 --> 00:08:42,880
average sla is 52 and flag points

244
00:08:42,880 --> 00:08:44,640
and this number right here is your flag

245
00:08:44,640 --> 00:08:46,160
points that is your score and it's

246
00:08:46,160 --> 00:08:48,959
affected by sla

247
00:08:48,959 --> 00:08:51,839
now flag points are separated on each

248
00:08:51,839 --> 00:08:55,200
service right here so they earned 34 000

249
00:08:55,200 --> 00:08:56,160
points

250
00:08:56,160 --> 00:08:59,040
from coffee pot 240 points from free

251
00:08:59,040 --> 00:09:03,040
life 188 health monitor 283 nasa rasa

252
00:09:03,040 --> 00:09:04,640
and you can even see these smaller

253
00:09:04,640 --> 00:09:06,839
numbers under each

254
00:09:06,839 --> 00:09:09,440
surface these these this is how many

255
00:09:09,440 --> 00:09:11,760
flags have been stolen so they stole

256
00:09:11,760 --> 00:09:14,720
1084 flags from coffee pot they stole 8

257
00:09:14,720 --> 00:09:17,440
000 flags for free life 4 800 for health

258
00:09:17,440 --> 00:09:19,040
monitor and so on

259
00:09:19,040 --> 00:09:20,959
and in the red that's how many flags

260
00:09:20,959 --> 00:09:22,959
they lost how many flags were stolen

261
00:09:22,959 --> 00:09:24,240
from them

262
00:09:24,240 --> 00:09:26,160
all right and you can see here in the

263
00:09:26,160 --> 00:09:29,120
bottom a total so in total they stole 22

264
00:09:29,120 --> 00:09:32,480
8 22 000 flags almost and they lost only

265
00:09:32,480 --> 00:09:35,600
175 so this team really patched up their

266
00:09:35,600 --> 00:09:37,120
services as fast as possible you can

267
00:09:37,120 --> 00:09:39,200
even see that there's a team here that

268
00:09:39,200 --> 00:09:41,440
never lost the flag in coffee pot so

269
00:09:41,440 --> 00:09:43,760
they probably found the bug first people

270
00:09:43,760 --> 00:09:46,560
patched it and they called it a day

271
00:09:46,560 --> 00:09:47,440
all right

272
00:09:47,440 --> 00:09:49,040
so let's let's keep going so this

273
00:09:49,040 --> 00:09:50,560
scoreboard is definitely going to change

274
00:09:50,560 --> 00:09:52,480
overnight you guys can ignore these

275
00:09:52,480 --> 00:09:53,760
teams that were

276
00:09:53,760 --> 00:09:55,600
busy all night okay

277
00:09:55,600 --> 00:09:57,279
and you guys can just

278
00:09:57,279 --> 00:09:58,880
focus on yourselves you keep going all

279
00:09:58,880 --> 00:10:01,279
right it's just the training anyway so

280
00:10:01,279 --> 00:10:03,120
stay motivated it's all about the

281
00:10:03,120 --> 00:10:04,800
experience it's all about the fun it's

282
00:10:04,800 --> 00:10:06,320
all about finding the exploits and

283
00:10:06,320 --> 00:10:07,600
writing them and getting used to the

284
00:10:07,600 --> 00:10:08,640
whole thing

285
00:10:08,640 --> 00:10:09,680
so

286
00:10:09,680 --> 00:10:12,560
with that being said let's move on to

287
00:10:12,560 --> 00:10:15,600
our material for today

288
00:10:15,600 --> 00:10:18,160
this is yesterday's material and welcome

289
00:10:18,160 --> 00:10:19,920
to day two material

290
00:10:19,920 --> 00:10:21,600
so

291
00:10:21,600 --> 00:10:24,160
let's get started

292
00:10:24,160 --> 00:10:26,160
today we're going to be explaining what

293
00:10:26,160 --> 00:10:27,680
you should expect when you look at a

294
00:10:27,680 --> 00:10:29,440
services code base what we mean like

295
00:10:29,440 --> 00:10:32,399
what what files do you expect how you

296
00:10:32,399 --> 00:10:34,399
should expect everything to be assembled

297
00:10:34,399 --> 00:10:35,760
then we're finally going to get to the

298
00:10:35,760 --> 00:10:37,440
good part which is finding

299
00:10:37,440 --> 00:10:39,760
vulnerabilities in our services we're

300
00:10:39,760 --> 00:10:41,760
going to be exploiting them and patching

301
00:10:41,760 --> 00:10:43,279
them and then we're going to learn about

302
00:10:43,279 --> 00:10:45,200
something called an attack defense

303
00:10:45,200 --> 00:10:48,079
exploit farm and these are amazing tools

304
00:10:48,079 --> 00:10:50,240
just like quarant that really really

305
00:10:50,240 --> 00:10:52,240
help and can make a big difference in

306
00:10:52,240 --> 00:10:54,720
how efficient you are in capturing flags

307
00:10:54,720 --> 00:10:57,440
in an attack defense competition right

308
00:10:57,440 --> 00:10:59,440
so let's move on so let's talk about

309
00:10:59,440 --> 00:11:00,959
flags although we kind of did talk about

310
00:11:00,959 --> 00:11:03,519
this yesterday flags are usually found

311
00:11:03,519 --> 00:11:06,480
and stored in databases in services but

312
00:11:06,480 --> 00:11:08,160
can also be found in the file system in

313
00:11:08,160 --> 00:11:10,000
some cases it all depends on the

314
00:11:10,000 --> 00:11:12,320
vulnerability so remember i told you

315
00:11:12,320 --> 00:11:15,120
guys when your services start up you

316
00:11:15,120 --> 00:11:16,800
should pay attention to when the check

317
00:11:16,800 --> 00:11:19,680
system inserts flags into your system

318
00:11:19,680 --> 00:11:22,640
and where do they show up so for example

319
00:11:22,640 --> 00:11:25,200
let's let's take an example here let me

320
00:11:25,200 --> 00:11:28,320
login to my nasa rasa surface

321
00:11:28,320 --> 00:11:29,320
so

322
00:11:29,320 --> 00:11:31,920
10.60.100.3 nasa rasa runs on port 80.

323
00:11:31,920 --> 00:11:34,240
okay where are the flags so i can go to

324
00:11:34,240 --> 00:11:35,200
users

325
00:11:35,200 --> 00:11:37,839
oh boy someone had a lot of fun here

326
00:11:37,839 --> 00:11:40,399
how am i supposed to okay well this is

327
00:11:40,399 --> 00:11:42,480
what happens when you have 20 000 people

328
00:11:42,480 --> 00:11:44,240
exploiting your service

329
00:11:44,240 --> 00:11:46,320
things happen

330
00:11:46,320 --> 00:11:48,079
i have no clue how i'm gonna be able to

331
00:11:48,079 --> 00:11:50,160
find the service right now find the

332
00:11:50,160 --> 00:11:52,560
actual uh user

333
00:11:52,560 --> 00:11:53,680
please

334
00:11:53,680 --> 00:11:55,200
you know what we'll we'll check on this

335
00:11:55,200 --> 00:11:57,839
in a second

336
00:11:58,399 --> 00:11:59,680
we'll come back to the service in a

337
00:11:59,680 --> 00:12:01,360
minute

338
00:12:01,360 --> 00:12:03,440
this is this is all automated exploit

339
00:12:03,440 --> 00:12:04,880
scripts that are signing up for the

340
00:12:04,880 --> 00:12:05,920
service

341
00:12:05,920 --> 00:12:07,920
uh because part of the

342
00:12:07,920 --> 00:12:10,160
part of the vulnerability is pretty much

343
00:12:10,160 --> 00:12:12,719
signing up

344
00:12:13,920 --> 00:12:15,680
come on

345
00:12:15,680 --> 00:12:17,279
waiting for the check system to drop in

346
00:12:17,279 --> 00:12:18,800
a new

347
00:12:18,800 --> 00:12:19,920
so

348
00:12:19,920 --> 00:12:21,600
we know that the check system drops in

349
00:12:21,600 --> 00:12:23,839
new flags every 60 seconds which is how

350
00:12:23,839 --> 00:12:26,720
long a round is

351
00:12:27,279 --> 00:12:29,760
okay here we go finally so we see a

352
00:12:29,760 --> 00:12:31,440
bunch of exploits happening here and

353
00:12:31,440 --> 00:12:33,040
then we see

354
00:12:33,040 --> 00:12:35,120
a user that got put that's out of place

355
00:12:35,120 --> 00:12:37,200
called you know it's just two names

356
00:12:37,200 --> 00:12:39,680
so we see this user we see that they

357
00:12:39,680 --> 00:12:41,519
registered as some random generated

358
00:12:41,519 --> 00:12:42,639
username

359
00:12:42,639 --> 00:12:44,160
and

360
00:12:44,160 --> 00:12:46,240
if we somehow go into the database and

361
00:12:46,240 --> 00:12:48,079
look at this user you're gonna find out

362
00:12:48,079 --> 00:12:50,880
that this user actually uploads a flag

363
00:12:50,880 --> 00:12:54,399
in the description of their profile

364
00:12:54,399 --> 00:12:57,200
okay so you somehow have to find a way

365
00:12:57,200 --> 00:12:59,920
to log in as this user and take the

366
00:12:59,920 --> 00:13:02,480
secret private message that they can put

367
00:13:02,480 --> 00:13:04,880
under their profile that's the flag so

368
00:13:04,880 --> 00:13:06,240
it's we're looking for some sort of

369
00:13:06,240 --> 00:13:08,720
authentication bypass authentication bug

370
00:13:08,720 --> 00:13:10,079
all right you can find out more and more

371
00:13:10,079 --> 00:13:12,240
by exploring the code but you have to be

372
00:13:12,240 --> 00:13:14,320
familiar with your services watch where

373
00:13:14,320 --> 00:13:16,800
the check system uploads flags into your

374
00:13:16,800 --> 00:13:19,839
services carrant can help with that you

375
00:13:19,839 --> 00:13:21,360
guys can watch when the check system is

376
00:13:21,360 --> 00:13:23,600
putting flags in and just track where

377
00:13:23,600 --> 00:13:25,519
they end up landing in your system all

378
00:13:25,519 --> 00:13:26,320
right

379
00:13:26,320 --> 00:13:28,480
so moving on we know that the flag

380
00:13:28,480 --> 00:13:31,360
format is this regex so 31 random

381
00:13:31,360 --> 00:13:34,480
characters and it ends with an equal

382
00:13:34,480 --> 00:13:36,079
and this is an example

383
00:13:36,079 --> 00:13:38,399
and your goal is to steal these flags

384
00:13:38,399 --> 00:13:39,920
from the other team's services and

385
00:13:39,920 --> 00:13:42,079
submit them to the check system to gain

386
00:13:42,079 --> 00:13:44,320
points right

387
00:13:44,320 --> 00:13:46,800
so the game time is split into rounds

388
00:13:46,800 --> 00:13:48,800
all right and in hacking the box these

389
00:13:48,800 --> 00:13:51,519
rounds are one minute long so every 60

390
00:13:51,519 --> 00:13:52,639
seconds

391
00:13:52,639 --> 00:13:54,800
check system is going to add new flags

392
00:13:54,800 --> 00:13:56,560
and the check system is going to check

393
00:13:56,560 --> 00:13:58,880
your services every minute

394
00:13:58,880 --> 00:14:01,360
and the flags that are valid for being

395
00:14:01,360 --> 00:14:04,000
submitted for submission are the flags

396
00:14:04,000 --> 00:14:06,959
that have a lifetime of 15 minutes

397
00:14:06,959 --> 00:14:08,320
so

398
00:14:08,320 --> 00:14:11,360
flags expire 15 rounds later so if you

399
00:14:11,360 --> 00:14:14,800
try to submit a flag and it's been

400
00:14:14,800 --> 00:14:17,519
in the game for 14 minutes it will be

401
00:14:17,519 --> 00:14:20,800
valid but once it becomes 15 minutes old

402
00:14:20,800 --> 00:14:22,880
it stops being valid so you should try

403
00:14:22,880 --> 00:14:25,440
to limit yourself try to ignore any

404
00:14:25,440 --> 00:14:27,920
flags that are older than 15 minutes all

405
00:14:27,920 --> 00:14:29,760
right and we'll talk about this more

406
00:14:29,760 --> 00:14:30,959
when we're talking about building

407
00:14:30,959 --> 00:14:33,519
exploits and exploit farm and all that

408
00:14:33,519 --> 00:14:36,880
so service code base structure

409
00:14:36,880 --> 00:14:38,720
each service as we know has a docker

410
00:14:38,720 --> 00:14:40,399
compose file and a docker file which

411
00:14:40,399 --> 00:14:41,760
contain information about how the

412
00:14:41,760 --> 00:14:44,160
container is built and deployed what

413
00:14:44,160 --> 00:14:46,560
libraries are being installed what

414
00:14:46,560 --> 00:14:48,320
system packages are being installed all

415
00:14:48,320 --> 00:14:49,920
that stuff you can find in the docker

416
00:14:49,920 --> 00:14:52,160
file and docker compose

417
00:14:52,160 --> 00:14:54,240
and depending on the language that the

418
00:14:54,240 --> 00:14:56,639
service is written in the logic can be

419
00:14:56,639 --> 00:14:58,480
in a few files for example you might

420
00:14:58,480 --> 00:15:00,160
just be lucky enough to have

421
00:15:00,160 --> 00:15:01,920
main dot pi and that's pretty much the

422
00:15:01,920 --> 00:15:04,399
entire service or you might be unlucky

423
00:15:04,399 --> 00:15:07,279
and you'll have a big django service so

424
00:15:07,279 --> 00:15:09,360
if you've ever dealt with django in

425
00:15:09,360 --> 00:15:12,160
python you know that it's like 300 files

426
00:15:12,160 --> 00:15:13,680
all over the place

427
00:15:13,680 --> 00:15:15,600
each doing a different thing all right

428
00:15:15,600 --> 00:15:17,279
that's why it's recommended that if you

429
00:15:17,279 --> 00:15:19,680
see a bunch of files you see a framework

430
00:15:19,680 --> 00:15:21,199
that you're not familiar with or a

431
00:15:21,199 --> 00:15:23,199
language you're not familiar with it's

432
00:15:23,199 --> 00:15:25,360
best to google because sometimes some of

433
00:15:25,360 --> 00:15:27,279
these files are going to be

434
00:15:27,279 --> 00:15:28,959
you know just

435
00:15:28,959 --> 00:15:30,800
they're they're not useless but they're

436
00:15:30,800 --> 00:15:32,480
generated by the framework or by the

437
00:15:32,480 --> 00:15:34,399
language they don't actually contain any

438
00:15:34,399 --> 00:15:35,759
logic there

439
00:15:35,759 --> 00:15:36,880
all right

440
00:15:36,880 --> 00:15:38,240
and you're going to see examples of this

441
00:15:38,240 --> 00:15:40,160
in a second so what are the services

442
00:15:40,160 --> 00:15:41,279
that we have

443
00:15:41,279 --> 00:15:44,000
we have nasa rasa which is a php web app

444
00:15:44,000 --> 00:15:46,480
with an exposed mysql database

445
00:15:46,480 --> 00:15:48,720
we have health monitor which is a web

446
00:15:48,720 --> 00:15:50,560
app written in go all of these are web

447
00:15:50,560 --> 00:15:53,759
apps you have coffee pot it's a cgi

448
00:15:53,759 --> 00:15:56,240
script written in bash and free life it

449
00:15:56,240 --> 00:15:58,560
is a django web app written in python so

450
00:15:58,560 --> 00:16:00,880
we have php go bash and python four

451
00:16:00,880 --> 00:16:02,560
different languages four different

452
00:16:02,560 --> 00:16:04,480
frameworks it's all different but

453
00:16:04,480 --> 00:16:05,519
they're all

454
00:16:05,519 --> 00:16:06,720
they have one thing in common they're

455
00:16:06,720 --> 00:16:08,720
all web apps

456
00:16:08,720 --> 00:16:11,040
so the first thing we're going to do is

457
00:16:11,040 --> 00:16:12,480
we're going to

458
00:16:12,480 --> 00:16:14,079
talk about techniques to finding

459
00:16:14,079 --> 00:16:15,759
vulnerabilities but before that let's

460
00:16:15,759 --> 00:16:17,199
take a look at the code shall we let's

461
00:16:17,199 --> 00:16:18,880
just let's just double check what i just

462
00:16:18,880 --> 00:16:20,720
said so let's just go

463
00:16:20,720 --> 00:16:22,320
let's just go to home so i'm gonna go to

464
00:16:22,320 --> 00:16:23,199
home

465
00:16:23,199 --> 00:16:24,800
okay and we have

466
00:16:24,800 --> 00:16:27,440
the four services i'm gonna list copybot

467
00:16:27,440 --> 00:16:28,880
and you see that there's a second folder

468
00:16:28,880 --> 00:16:30,880
inside it called coffeepotservice so

469
00:16:30,880 --> 00:16:33,120
when i list it there's another folder i

470
00:16:33,120 --> 00:16:35,120
see a dockerfile which can give me an

471
00:16:35,120 --> 00:16:36,800
idea so let's cat this docker file let's

472
00:16:36,800 --> 00:16:39,440
let's read this docker file so i see

473
00:16:39,440 --> 00:16:41,920
that we have ubuntu 16

474
00:16:41,920 --> 00:16:45,040
and we're just copying a bunch of

475
00:16:45,040 --> 00:16:48,240
so we're adding a the coffeepot folder

476
00:16:48,240 --> 00:16:49,680
into the container we're running some

477
00:16:49,680 --> 00:16:52,320
permissions and we're basically just

478
00:16:52,320 --> 00:16:54,399
running the coffee pot web server

479
00:16:54,399 --> 00:16:56,560
wow that that's pretty much simple

480
00:16:56,560 --> 00:16:58,560
okay let's take a look at the source

481
00:16:58,560 --> 00:17:00,240
code so coffee pot coffee pot surface

482
00:17:00,240 --> 00:17:02,399
and coffee pot you'll see here that we

483
00:17:02,399 --> 00:17:05,119
do have a cgi script so that's how you

484
00:17:05,119 --> 00:17:06,559
know you can tell you just see

485
00:17:06,559 --> 00:17:08,319
coffeepot.cgi

486
00:17:08,319 --> 00:17:09,439
and

487
00:17:09,439 --> 00:17:11,039
and that's pretty much all you need to

488
00:17:11,039 --> 00:17:14,240
know so take a look at coffeepot cgi

489
00:17:14,240 --> 00:17:16,559
and it's essentially a cgi script

490
00:17:16,559 --> 00:17:18,319
written in batch bash and we'll talk

491
00:17:18,319 --> 00:17:20,319
about this we'll explore this later all

492
00:17:20,319 --> 00:17:22,319
right

493
00:17:22,319 --> 00:17:24,160
next service free life let's see what's

494
00:17:24,160 --> 00:17:26,480
inside free life we have another docker

495
00:17:26,480 --> 00:17:28,640
compose file so let's open let's open

496
00:17:28,640 --> 00:17:30,799
free life we see that free life is

497
00:17:30,799 --> 00:17:32,960
actually just straight up a python

498
00:17:32,960 --> 00:17:34,559
docker container so we know it's a

499
00:17:34,559 --> 00:17:36,960
python web app they're adding and it

500
00:17:36,960 --> 00:17:39,679
says right here install django and just

501
00:17:39,679 --> 00:17:42,000
pip install django and they just run the

502
00:17:42,000 --> 00:17:44,240
django web app so you know you start to

503
00:17:44,240 --> 00:17:47,120
see keywords django and python you know

504
00:17:47,120 --> 00:17:49,200
it helps you google let's look at health

505
00:17:49,200 --> 00:17:50,880
monitor let's read health monitors

506
00:17:50,880 --> 00:17:52,320
docker container

507
00:17:52,320 --> 00:17:55,520
so cat health monitor docker file

508
00:17:55,520 --> 00:17:58,080
we see immediately it's a go line

509
00:17:58,080 --> 00:18:00,400
container it's straight up it's a go app

510
00:18:00,400 --> 00:18:02,000
you can see that they're initializing

511
00:18:02,000 --> 00:18:03,440
and they're building the service and

512
00:18:03,440 --> 00:18:05,200
they just run

513
00:18:05,200 --> 00:18:07,120
health monitor after it's been built so

514
00:18:07,120 --> 00:18:09,840
now you know that it's go

515
00:18:09,840 --> 00:18:11,679
so you see the docker files really can

516
00:18:11,679 --> 00:18:13,360
give you an idea

517
00:18:13,360 --> 00:18:15,760
about what what what to expect and

518
00:18:15,760 --> 00:18:17,840
what's happening so in nasa rasa it's

519
00:18:17,840 --> 00:18:19,600
not that simple we have to go we have to

520
00:18:19,600 --> 00:18:21,760
cut the docker file we see again it's

521
00:18:21,760 --> 00:18:22,960
php

522
00:18:22,960 --> 00:18:24,720
it's a php container running apache and

523
00:18:24,720 --> 00:18:26,000
they're just copying code in they're

524
00:18:26,000 --> 00:18:28,799
installing some extension php extensions

525
00:18:28,799 --> 00:18:31,440
like mysql and that stuff and they're

526
00:18:31,440 --> 00:18:33,679
just running the service

527
00:18:33,679 --> 00:18:35,919
okay so these can give you hints and

528
00:18:35,919 --> 00:18:37,600
it's always important to look at these

529
00:18:37,600 --> 00:18:39,600
docker files what if they're installing

530
00:18:39,600 --> 00:18:41,360
like for example that ubuntu 16

531
00:18:41,360 --> 00:18:43,280
container does it have any default

532
00:18:43,280 --> 00:18:45,200
packages that might be vulnerable does

533
00:18:45,200 --> 00:18:47,440
it have any are they doing anything

534
00:18:47,440 --> 00:18:50,080
specific in the docker files are they

535
00:18:50,080 --> 00:18:52,320
installing any specific libraries that

536
00:18:52,320 --> 00:18:54,240
might be outdated or you know they're

537
00:18:54,240 --> 00:18:56,080
doing any specific practices and we're

538
00:18:56,080 --> 00:18:57,440
going to talk about that so first thing

539
00:18:57,440 --> 00:18:59,520
you should do is check the docker

540
00:18:59,520 --> 00:19:01,440
related files

541
00:19:01,440 --> 00:19:03,120
also look at the docker compose files as

542
00:19:03,120 --> 00:19:05,200
well is there any specific version of

543
00:19:05,200 --> 00:19:06,720
any libraries being installed are they

544
00:19:06,720 --> 00:19:08,720
outdated are there any specific system

545
00:19:08,720 --> 00:19:10,400
settings that are being applied that are

546
00:19:10,400 --> 00:19:13,120
insecure are there any exposed services

547
00:19:13,120 --> 00:19:15,280
with weak or even no authentication or

548
00:19:15,280 --> 00:19:17,120
even hard-coded creds

549
00:19:17,120 --> 00:19:18,799
the second thing you should do is just

550
00:19:18,799 --> 00:19:21,280
go through the code like any normal

551
00:19:21,280 --> 00:19:23,360
defender would do open the code in your

552
00:19:23,360 --> 00:19:25,360
favorite code editor and just walk step

553
00:19:25,360 --> 00:19:27,760
by step look at look at all the lines

554
00:19:27,760 --> 00:19:29,440
try to find something that just looks

555
00:19:29,440 --> 00:19:30,799
out of place

556
00:19:30,799 --> 00:19:32,960
or the third option is well if you kind

557
00:19:32,960 --> 00:19:34,400
of give up on the service or you just

558
00:19:34,400 --> 00:19:36,640
don't want to bother going through you

559
00:19:36,640 --> 00:19:38,240
know trying to go through the code wait

560
00:19:38,240 --> 00:19:39,840
for another team to exploit it and then

561
00:19:39,840 --> 00:19:42,000
just steal their exploit

562
00:19:42,000 --> 00:19:43,679
three of the three of these are

563
00:19:43,679 --> 00:19:46,720
perfectly valid strategies so

564
00:19:46,720 --> 00:19:48,799
for our first thing first break for

565
00:19:48,799 --> 00:19:50,240
today i know the break came in a little

566
00:19:50,240 --> 00:19:52,240
bit early but we're going to give you

567
00:19:52,240 --> 00:19:54,160
guys a hands-on activity i want you guys

568
00:19:54,160 --> 00:19:55,679
to go take a look at the nasa rasa

569
00:19:55,679 --> 00:19:58,160
service okay use the three steps that

570
00:19:58,160 --> 00:19:59,760
were mentioned in the previous slide and

571
00:19:59,760 --> 00:20:01,760
i'm gonna i'm gonna keep it like this

572
00:20:01,760 --> 00:20:03,520
okay

573
00:20:03,520 --> 00:20:05,120
and

574
00:20:05,120 --> 00:20:07,200
go ahead take a look at the nasa asset

575
00:20:07,200 --> 00:20:09,760
service i'll give you guys 15 to 20

576
00:20:09,760 --> 00:20:12,559
minutes come back in 15 to 20 minutes

577
00:20:12,559 --> 00:20:14,080
take a look and

578
00:20:14,080 --> 00:20:15,520
try to see if you can find the most

579
00:20:15,520 --> 00:20:17,360
obvious vulnerability now don't patch it

580
00:20:17,360 --> 00:20:19,039
yet don't touch anything if you find out

581
00:20:19,039 --> 00:20:20,480
that's great don't touch it because

582
00:20:20,480 --> 00:20:23,200
we're going to need it in a second but

583
00:20:23,200 --> 00:20:25,280
find out what it is all right and we'll

584
00:20:25,280 --> 00:20:27,280
be back in

585
00:20:27,280 --> 00:20:29,280
15 to 20 minutes all right i'll put a

586
00:20:29,280 --> 00:20:34,280
timer for 20 minutes see you guys at 20.

587
00:41:03,280 --> 00:41:06,560
hello and welcome welcome back everybody

588
00:41:06,560 --> 00:41:08,160
i was literally eating a sandwich and i

589
00:41:08,160 --> 00:41:10,319
saw that we had 30 seconds i had to eat

590
00:41:10,319 --> 00:41:12,160
the sandwich faster than i've eaten

591
00:41:12,160 --> 00:41:13,760
anything in my life

592
00:41:13,760 --> 00:41:16,000
so

593
00:41:16,079 --> 00:41:17,200
let's

594
00:41:17,200 --> 00:41:18,800
come back to the come back to the

595
00:41:18,800 --> 00:41:20,240
presentation come back to the zoom call

596
00:41:20,240 --> 00:41:21,599
everybody so

597
00:41:21,599 --> 00:41:25,040
what you guys think the vulnerability is

598
00:41:25,040 --> 00:41:27,359
talk talk to me what do you think the

599
00:41:27,359 --> 00:41:29,839
vulnerability is in nasa nasa most

600
00:41:29,839 --> 00:41:33,160
obvious thing

601
00:41:34,720 --> 00:41:37,839
nice that's correct the exposed mysql

602
00:41:37,839 --> 00:41:40,000
database everybody has the same

603
00:41:40,000 --> 00:41:42,400
credentials everybody has

604
00:41:42,400 --> 00:41:44,960
access to the database why even bother

605
00:41:44,960 --> 00:41:46,400
trying to hack the service you can just

606
00:41:46,400 --> 00:41:48,319
log into the mysql database and grab the

607
00:41:48,319 --> 00:41:50,000
flags and that's what we're going to be

608
00:41:50,000 --> 00:41:51,440
talking about that is our first

609
00:41:51,440 --> 00:41:54,079
vulnerability good job guys

610
00:41:54,079 --> 00:41:54,800
so

611
00:41:54,800 --> 00:41:58,640
by looking at the docker compose files

612
00:41:58,800 --> 00:42:01,040
you found out that hey let's look at the

613
00:42:01,040 --> 00:42:03,200
docker let's look at the docker composer

614
00:42:03,200 --> 00:42:06,400
they are specifying a mysql user and

615
00:42:06,400 --> 00:42:09,200
password directly in the docker compose

616
00:42:09,200 --> 00:42:10,560
file

617
00:42:10,560 --> 00:42:11,520
to

618
00:42:11,520 --> 00:42:13,680
the um service

619
00:42:13,680 --> 00:42:14,720
like

620
00:42:14,720 --> 00:42:17,040
that means all the other teams have the

621
00:42:17,040 --> 00:42:19,200
same username and password combo and all

622
00:42:19,200 --> 00:42:21,200
the other teams

623
00:42:21,200 --> 00:42:23,839
have the same docker compose file

624
00:42:23,839 --> 00:42:26,079
meaning that we can just

625
00:42:26,079 --> 00:42:27,920
so we can just log into other people's

626
00:42:27,920 --> 00:42:30,720
databases and call it a day i will share

627
00:42:30,720 --> 00:42:32,079
the powerpoint now so now that we've

628
00:42:32,079 --> 00:42:33,440
talked about the first vulnerability and

629
00:42:33,440 --> 00:42:34,400
things are going to be a little bit

630
00:42:34,400 --> 00:42:36,800
chaotic now

631
00:42:36,800 --> 00:42:39,520
but i can share with you guys

632
00:42:39,520 --> 00:42:44,040
the day two here we go

633
00:42:47,359 --> 00:42:50,480
that's day two training

634
00:42:55,520 --> 00:42:57,359
so

635
00:42:57,359 --> 00:42:58,720
now that you guys know this i i know

636
00:42:58,720 --> 00:43:00,640
some of you are going to just go and run

637
00:43:00,640 --> 00:43:02,480
to your databases or run to your command

638
00:43:02,480 --> 00:43:04,240
lines and try and log into as many teams

639
00:43:04,240 --> 00:43:05,839
as possible but i need to i need you to

640
00:43:05,839 --> 00:43:06,880
stay with me

641
00:43:06,880 --> 00:43:08,160
for just a second okay because we're

642
00:43:08,160 --> 00:43:10,400
going to talk about exploit writing

643
00:43:10,400 --> 00:43:13,680
all right so

644
00:43:13,680 --> 00:43:16,000
now in the case of nasa rasa the flags

645
00:43:16,000 --> 00:43:17,760
are stored in the message column in the

646
00:43:17,760 --> 00:43:20,000
planets table and we can check that so

647
00:43:20,000 --> 00:43:21,119
i'm going to go

648
00:43:21,119 --> 00:43:22,480
mysql

649
00:43:22,480 --> 00:43:26,680
i'm logging in as nasa

650
00:43:26,880 --> 00:43:29,119
the password is and i'll just copy the

651
00:43:29,119 --> 00:43:30,720
password from the

652
00:43:30,720 --> 00:43:33,599
docker compose uh should have another

653
00:43:33,599 --> 00:43:36,319
ssh terminal here

654
00:43:36,319 --> 00:43:41,640
let me just let me just cat nasa

655
00:43:42,960 --> 00:43:44,800
let's run mysql

656
00:43:44,800 --> 00:43:48,000
do i even have the mysql client

657
00:43:48,000 --> 00:43:51,119
please my skill no i don't so sudo apt

658
00:43:51,119 --> 00:43:53,359
install

659
00:43:53,359 --> 00:43:55,680
dash client

660
00:43:55,680 --> 00:43:59,200
thanks hamid for the password

661
00:44:00,880 --> 00:44:03,839
so now i have the mysql client

662
00:44:03,839 --> 00:44:06,240
let's

663
00:44:06,720 --> 00:44:08,400
yeah you sent the password here thank

664
00:44:08,400 --> 00:44:11,200
you so mysql let's first connect to my

665
00:44:11,200 --> 00:44:14,079
own database so nasarasa password like

666
00:44:14,079 --> 00:44:16,880
this i'm connecting to the nasarasa

667
00:44:16,880 --> 00:44:19,440
database

668
00:44:19,680 --> 00:44:20,960
oh i forgot to include the most

669
00:44:20,960 --> 00:44:24,119
important thing dash h host

670
00:44:24,119 --> 00:44:26,319
127.2.0.1 i'm connected to myself and

671
00:44:26,319 --> 00:44:28,640
i'm logged in there you go

672
00:44:28,640 --> 00:44:31,680
i can say show tables

673
00:44:31,680 --> 00:44:33,280
and i see that there's

674
00:44:33,280 --> 00:44:36,000
planets so i can do select star from

675
00:44:36,000 --> 00:44:37,839
planets

676
00:44:37,839 --> 00:44:40,800
and there we go you see all these flags

677
00:44:40,800 --> 00:44:42,880
right here

678
00:44:42,880 --> 00:44:45,920
all these flags in the message column

679
00:44:45,920 --> 00:44:47,440
all right you can see some people are

680
00:44:47,440 --> 00:44:49,119
also trying to test on my service for

681
00:44:49,119 --> 00:44:51,839
some sql injection all right

682
00:44:51,839 --> 00:44:52,560
so

683
00:44:52,560 --> 00:44:54,480
i see boon stars and other people left

684
00:44:54,480 --> 00:44:56,880
messages here that's nice and

685
00:44:56,880 --> 00:45:00,400
that's that's basically the flags

686
00:45:00,400 --> 00:45:02,880
so you can do select

687
00:45:02,880 --> 00:45:06,319
message from planets

688
00:45:07,040 --> 00:45:09,520
oh who dropped my database

689
00:45:09,520 --> 00:45:10,880
thank you guys

690
00:45:10,880 --> 00:45:13,040
someone just logged in and just dropped

691
00:45:13,040 --> 00:45:15,200
my database

692
00:45:15,200 --> 00:45:17,280
i mean makes makes sense

693
00:45:17,280 --> 00:45:19,040
so good thing that someone did that we

694
00:45:19,040 --> 00:45:21,200
can talk about that so

695
00:45:21,200 --> 00:45:22,800
uh let's say you find a vulnerability

696
00:45:22,800 --> 00:45:25,839
like this like an exposed database okay

697
00:45:25,839 --> 00:45:27,839
are you allowed this is going to be

698
00:45:27,839 --> 00:45:30,480
important are you allowed to go in and

699
00:45:30,480 --> 00:45:32,800
mess with other teams flags

700
00:45:32,800 --> 00:45:35,359
the answer is no

701
00:45:35,359 --> 00:45:37,280
all right because it's not fair because

702
00:45:37,280 --> 00:45:39,359
right now i'm going to lose sla

703
00:45:39,359 --> 00:45:41,280
why am i going to lose sla because my

704
00:45:41,280 --> 00:45:43,280
flags are and my service is going to

705
00:45:43,280 --> 00:45:45,359
show up as corrupt because i lost all my

706
00:45:45,359 --> 00:45:47,920
flags right the serve the check system

707
00:45:47,920 --> 00:45:49,440
is going to try to retrieve previous

708
00:45:49,440 --> 00:45:51,599
flags but it can't do that anymore

709
00:45:51,599 --> 00:45:53,839
because someone dropped my database

710
00:45:53,839 --> 00:45:55,359
all right so

711
00:45:55,359 --> 00:45:57,040
i'm going to start losing sla and that

712
00:45:57,040 --> 00:45:58,240
and another thing we're going to talk

713
00:45:58,240 --> 00:45:59,359
about

714
00:45:59,359 --> 00:46:01,280
you can't

715
00:46:01,280 --> 00:46:04,000
put in fake flags as well so let's say

716
00:46:04,000 --> 00:46:06,160
you have a regex right here right

717
00:46:06,160 --> 00:46:09,040
i can't just start copying this regex

718
00:46:09,040 --> 00:46:10,800
and flooding people's databases with

719
00:46:10,800 --> 00:46:12,839
flags you're not allowed to do that

720
00:46:12,839 --> 00:46:15,599
and and this is funny and everything we

721
00:46:15,599 --> 00:46:17,200
can laugh about it that's that's i

722
00:46:17,200 --> 00:46:18,880
actually did not see this coming so good

723
00:46:18,880 --> 00:46:22,319
job to ever drop my database but

724
00:46:22,319 --> 00:46:24,319
one very important thing

725
00:46:24,319 --> 00:46:26,319
if you do this in the competition it

726
00:46:26,319 --> 00:46:28,319
might be fun for a couple of minutes but

727
00:46:28,319 --> 00:46:29,839
then you'll get banned

728
00:46:29,839 --> 00:46:31,920
all right because it's not fair

729
00:46:31,920 --> 00:46:34,079
you can't drop flags and you can't add

730
00:46:34,079 --> 00:46:37,200
flags either right it just confuses

731
00:46:37,200 --> 00:46:40,240
other teams it causes them to lose sla

732
00:46:40,240 --> 00:46:42,640
and it's not their fault and it's just

733
00:46:42,640 --> 00:46:44,960
it's not okay all right

734
00:46:44,960 --> 00:46:47,520
you can steal flags silently go ahead

735
00:46:47,520 --> 00:46:49,200
live life

736
00:46:49,200 --> 00:46:50,960
uh but you can't

737
00:46:50,960 --> 00:46:53,200
start you know ruining their their

738
00:46:53,200 --> 00:46:54,960
service on purpose

739
00:46:54,960 --> 00:46:56,960
all right and be careful all traffic in

740
00:46:56,960 --> 00:46:58,960
the competition is monitored

741
00:46:58,960 --> 00:47:01,920
so if you start doing this and teams

742
00:47:01,920 --> 00:47:03,760
start complaining that oh my database

743
00:47:03,760 --> 00:47:05,440
keeps getting dropped every round what's

744
00:47:05,440 --> 00:47:06,800
happening

745
00:47:06,800 --> 00:47:08,800
very simply the game admins they'll go

746
00:47:08,800 --> 00:47:10,240
to the game router they see all the

747
00:47:10,240 --> 00:47:12,079
traffic and you'll be found out in a

748
00:47:12,079 --> 00:47:14,000
couple of minutes and that's it you

749
00:47:14,000 --> 00:47:15,839
don't want to be disqualified over over

750
00:47:15,839 --> 00:47:17,040
something like this

751
00:47:17,040 --> 00:47:19,280
and in attack and defense a very big

752
00:47:19,280 --> 00:47:20,480
point so i know that was a little bit

753
00:47:20,480 --> 00:47:22,800
serious just don't worry that that's

754
00:47:22,800 --> 00:47:25,440
fine for now but

755
00:47:25,440 --> 00:47:26,400
in

756
00:47:26,400 --> 00:47:28,480
in in the actual game attacking defense

757
00:47:28,480 --> 00:47:30,480
the goal is to be as stealthy as

758
00:47:30,480 --> 00:47:33,520
possible you don't want to be found out

759
00:47:33,520 --> 00:47:36,559
you want to be silent imagine how loud

760
00:47:36,559 --> 00:47:38,800
it is to drop another team's database

761
00:47:38,800 --> 00:47:41,520
imagine how loud it is to just

762
00:47:41,520 --> 00:47:43,839
wipe their database or fill to flood

763
00:47:43,839 --> 00:47:46,160
their database with flags right so

764
00:47:46,160 --> 00:47:47,920
you're not allowed to do that okay in

765
00:47:47,920 --> 00:47:49,520
any way shape or form even if you have

766
00:47:49,520 --> 00:47:51,440
code execution all that stuff don't do

767
00:47:51,440 --> 00:47:54,240
that all right

768
00:47:54,880 --> 00:47:57,040
so moving on

769
00:47:57,040 --> 00:47:57,920
uh

770
00:47:57,920 --> 00:47:59,760
i'm gonna have to wait so whoever

771
00:47:59,760 --> 00:48:01,839
whoever dropped my entire database i

772
00:48:01,839 --> 00:48:04,319
have to rebuild my service now hoping

773
00:48:04,319 --> 00:48:05,440
that

774
00:48:05,440 --> 00:48:07,760
it comes back up

775
00:48:07,760 --> 00:48:10,559
so build

776
00:48:11,040 --> 00:48:13,359
all right

777
00:48:13,760 --> 00:48:14,559
so

778
00:48:14,559 --> 00:48:16,240
i'll wait for my database to come back

779
00:48:16,240 --> 00:48:18,240
up and we'll give it a couple of seconds

780
00:48:18,240 --> 00:48:20,240
so how do we patch this but moreover

781
00:48:20,240 --> 00:48:21,680
instead of talking about patching let's

782
00:48:21,680 --> 00:48:23,280
talk about exploiting right so we want

783
00:48:23,280 --> 00:48:26,400
to automate this typing in mysql every

784
00:48:26,400 --> 00:48:28,480
single time and like changing the ip

785
00:48:28,480 --> 00:48:29,760
address so i want to log into a

786
00:48:29,760 --> 00:48:34,040
different teams database 10.60.101

787
00:48:34,079 --> 00:48:37,240
for example.3

788
00:48:37,359 --> 00:48:39,680
i think 101 might not be up

789
00:48:39,680 --> 00:48:41,920
or maybe they change the password maybe

790
00:48:41,920 --> 00:48:43,920
102

791
00:48:43,920 --> 00:48:44,960
maybe

792
00:48:44,960 --> 00:48:48,480
any other team anyone 20.

793
00:48:48,480 --> 00:48:49,920
no

794
00:48:49,920 --> 00:48:53,440
51 okay 51.

795
00:48:53,440 --> 00:48:54,880
no you guys you can't change the

796
00:48:54,880 --> 00:48:56,800
password you need the password to be to

797
00:48:56,800 --> 00:48:58,880
be unchanged so if i can't log in

798
00:48:58,880 --> 00:49:00,720
because the password is different

799
00:49:00,720 --> 00:49:03,359
there's no point

800
00:49:03,359 --> 00:49:04,480
30 to

801
00:49:04,480 --> 00:49:06,480
45

802
00:49:06,480 --> 00:49:07,760
all right so i locked it to 45

803
00:49:07,760 --> 00:49:09,839
immediately so as i was doing select

804
00:49:09,839 --> 00:49:12,400
message from planets no why is it also

805
00:49:12,400 --> 00:49:16,000
empty did someone

806
00:49:16,000 --> 00:49:18,880
is it actually called message or

807
00:49:18,880 --> 00:49:21,839
yeah it's called message

808
00:49:22,720 --> 00:49:24,720
ah someone someone emptied everybody's

809
00:49:24,720 --> 00:49:27,439
databases

810
00:49:28,720 --> 00:49:30,640
someone just someone just destroyed

811
00:49:30,640 --> 00:49:33,598
everyone's database

812
00:49:40,160 --> 00:49:42,839
that is interesting i wonder if that's

813
00:49:42,839 --> 00:49:44,880
automated that can't be automated

814
00:49:44,880 --> 00:49:46,960
because my database was filled

815
00:49:46,960 --> 00:49:49,760
a couple of seconds ago

816
00:49:49,760 --> 00:49:51,760
come on i need to just find any team

817
00:49:51,760 --> 00:49:53,520
whatsoever anybody you know what i'm

818
00:49:53,520 --> 00:49:56,559
just gonna find a team

819
00:49:56,640 --> 00:50:00,640
team seven all right thank you guys

820
00:50:00,640 --> 00:50:02,559
all right let's see did someone really

821
00:50:02,559 --> 00:50:05,200
just wipe out

822
00:50:05,200 --> 00:50:07,599
everybody's database no

823
00:50:07,599 --> 00:50:09,440
okay so you guys can check your own

824
00:50:09,440 --> 00:50:11,280
databases if you got wiped out just

825
00:50:11,280 --> 00:50:14,079
follow what i did which is the i rebuilt

826
00:50:14,079 --> 00:50:16,720
the database

827
00:50:16,880 --> 00:50:18,400
all right and hopefully they'll just

828
00:50:18,400 --> 00:50:20,400
leave you alone for now so see the

829
00:50:20,400 --> 00:50:22,160
reason why this is unfair you'll go

830
00:50:22,160 --> 00:50:23,680
right now and you'll check the

831
00:50:23,680 --> 00:50:26,160
scoreboard so right now you'll see that

832
00:50:26,160 --> 00:50:28,319
most of our services see see everybody's

833
00:50:28,319 --> 00:50:30,880
nasa nasa service corrupt corrupt

834
00:50:30,880 --> 00:50:32,880
corrupt corrupt corrupt and you're

835
00:50:32,880 --> 00:50:34,319
losing sla

836
00:50:34,319 --> 00:50:36,720
and you're gonna lose sla for an entire

837
00:50:36,720 --> 00:50:38,640
15 rounds

838
00:50:38,640 --> 00:50:40,400
because remember we said that valid

839
00:50:40,400 --> 00:50:41,920
flags

840
00:50:41,920 --> 00:50:44,640
are 15 minutes long so this the check

841
00:50:44,640 --> 00:50:46,960
system needs to find those flags so i'm

842
00:50:46,960 --> 00:50:48,720
going to lose flags for the next 15

843
00:50:48,720 --> 00:50:50,160
minutes i'm going to lose sla for the

844
00:50:50,160 --> 00:50:53,680
next 15 minutes and that's not fair

845
00:50:53,680 --> 00:50:54,480
so

846
00:50:54,480 --> 00:50:56,160
when you guys find a vulnerability like

847
00:50:56,160 --> 00:50:58,079
this like an exposed database like an

848
00:50:58,079 --> 00:50:59,200
exposed

849
00:50:59,200 --> 00:51:00,400
um

850
00:51:00,400 --> 00:51:03,280
a nosql database or even an sql

851
00:51:03,280 --> 00:51:04,319
injection

852
00:51:04,319 --> 00:51:05,680
you know like an sql injection

853
00:51:05,680 --> 00:51:08,640
vulnerability uh anything at all you

854
00:51:08,640 --> 00:51:11,680
can't mess with existing flags right you

855
00:51:11,680 --> 00:51:13,440
can't you're not allowed to just go in

856
00:51:13,440 --> 00:51:14,960
and wipe the databases clean that's not

857
00:51:14,960 --> 00:51:15,920
fair

858
00:51:15,920 --> 00:51:17,599
okay so right now we're gonna talk a bit

859
00:51:17,599 --> 00:51:19,359
about exploiting so don't patch it yet

860
00:51:19,359 --> 00:51:20,880
it's a very simple patch but don't patch

861
00:51:20,880 --> 00:51:22,640
it yet because i want to show you guys

862
00:51:22,640 --> 00:51:25,119
the exploit how it works and how it's

863
00:51:25,119 --> 00:51:26,240
like you know

864
00:51:26,240 --> 00:51:28,160
how it actually works

865
00:51:28,160 --> 00:51:30,399
uh

866
00:51:30,880 --> 00:51:33,119
ahmed if you're here with us

867
00:51:33,119 --> 00:51:35,119
can you please make sure that the

868
00:51:35,119 --> 00:51:37,920
organization too

869
00:51:37,920 --> 00:51:40,000
can you go into the vm and restart all

870
00:51:40,000 --> 00:51:41,680
their services because i think if

871
00:51:41,680 --> 00:51:44,319
everybody patches at least i can have

872
00:51:44,319 --> 00:51:46,160
one person to hack

873
00:51:46,160 --> 00:51:47,359
i think

874
00:51:47,359 --> 00:51:49,440
organization two is me right

875
00:51:49,440 --> 00:51:50,790
yeah yeah so i'm telling you

876
00:51:50,790 --> 00:51:52,240
[Music]

877
00:51:52,240 --> 00:51:53,839
fix all right

878
00:51:53,839 --> 00:51:54,800
uh

879
00:51:54,800 --> 00:51:58,000
let's get started all right okay okay

880
00:51:58,000 --> 00:52:00,559
thank you so let's move on

881
00:52:00,559 --> 00:52:03,520
we need to steal flags and we need to

882
00:52:03,520 --> 00:52:05,440
submit them to the check system all

883
00:52:05,440 --> 00:52:07,200
right and we're going to need that same

884
00:52:07,200 --> 00:52:09,040
secret team token so you guys remember

885
00:52:09,040 --> 00:52:10,720
that token that you guys used to log

886
00:52:10,720 --> 00:52:13,280
into the cloud console you need that and

887
00:52:13,280 --> 00:52:15,280
so this is this is the curl command so

888
00:52:15,280 --> 00:52:17,440
how do you submit flex manually let's

889
00:52:17,440 --> 00:52:18,720
just assume you want to submit a flag

890
00:52:18,720 --> 00:52:20,000
manually

891
00:52:20,000 --> 00:52:22,960
you have to send an http put request

892
00:52:22,960 --> 00:52:24,960
to 10 10 10 10

893
00:52:24,960 --> 00:52:26,079
flags

894
00:52:26,079 --> 00:52:27,119
okay

895
00:52:27,119 --> 00:52:29,839
with your team token in the header

896
00:52:29,839 --> 00:52:32,240
and the flags in the form of an array in

897
00:52:32,240 --> 00:52:33,839
the body what does that what does that

898
00:52:33,839 --> 00:52:35,760
mean so let's come here so i'm going to

899
00:52:35,760 --> 00:52:37,520
take this call command and i'm going to

900
00:52:37,520 --> 00:52:39,680
put it here let's see what does that

901
00:52:39,680 --> 00:52:41,440
mean

902
00:52:41,440 --> 00:52:44,160
so you see this you see this command i

903
00:52:44,160 --> 00:52:46,720
am adding a header here to the scroll

904
00:52:46,720 --> 00:52:48,960
command called x theme token

905
00:52:48,960 --> 00:52:49,760
okay

906
00:52:49,760 --> 00:52:52,000
and in this i'm going to put my token

907
00:52:52,000 --> 00:52:53,440
okay so i'm going to put my token in

908
00:52:53,440 --> 00:52:56,079
front of you guys because i trust you

909
00:52:56,079 --> 00:52:57,440
there's not really much you can do with

910
00:52:57,440 --> 00:52:59,520
the token anyway

911
00:52:59,520 --> 00:53:02,319
where is token

912
00:53:02,319 --> 00:53:05,119
token okay

913
00:53:05,200 --> 00:53:06,319
and

914
00:53:06,319 --> 00:53:08,079
you see this array right here this is an

915
00:53:08,079 --> 00:53:09,359
array of flags

916
00:53:09,359 --> 00:53:10,240
right

917
00:53:10,240 --> 00:53:12,400
so i'm going to come here and i'm going

918
00:53:12,400 --> 00:53:14,400
to

919
00:53:14,400 --> 00:53:15,680
remove this

920
00:53:15,680 --> 00:53:18,079
and nope okay i accidentally submitted

921
00:53:18,079 --> 00:53:19,839
it i didn't want to do that

922
00:53:19,839 --> 00:53:21,119
okay

923
00:53:21,119 --> 00:53:23,280
and i'm going to put here a real flag

924
00:53:23,280 --> 00:53:26,079
instead okay so let me log in for

925
00:53:26,079 --> 00:53:29,839
example to some random person's database

926
00:53:29,839 --> 00:53:32,480
select message

927
00:53:32,480 --> 00:53:34,160
from planets

928
00:53:34,160 --> 00:53:36,559
okay let me grab one flag the latest

929
00:53:36,559 --> 00:53:39,280
flag thank you

930
00:53:39,280 --> 00:53:41,280
go back to my call command

931
00:53:41,280 --> 00:53:44,400
and replace this

932
00:53:44,559 --> 00:53:46,640
with the flag all right and it says here

933
00:53:46,640 --> 00:53:50,000
flag accepted i got 37 points

934
00:53:50,000 --> 00:53:53,200
37 flag points

935
00:53:53,599 --> 00:53:54,720
and that's it that's how you submit

936
00:53:54,720 --> 00:53:56,559
flags so if i go to the scoreboard now

937
00:53:56,559 --> 00:54:00,240
i'm i am marked as org one

938
00:54:00,240 --> 00:54:01,920
all right when the scoreboard updates

939
00:54:01,920 --> 00:54:04,160
next round i will jump by a lot of

940
00:54:04,160 --> 00:54:08,640
points because i just submitted a flag

941
00:54:08,880 --> 00:54:10,559
we can even refresh right now just to

942
00:54:10,559 --> 00:54:12,079
force it to update

943
00:54:12,079 --> 00:54:14,000
all right so the check system needs to

944
00:54:14,000 --> 00:54:15,359
catch up

945
00:54:15,359 --> 00:54:18,319
but yeah that's how you submit flags

946
00:54:18,319 --> 00:54:20,000
that's pretty much it you grab flags and

947
00:54:20,000 --> 00:54:22,319
you send them with a curl request or an

948
00:54:22,319 --> 00:54:24,720
http put request and that's it now i

949
00:54:24,720 --> 00:54:25,839
know you guys are going to be busy right

950
00:54:25,839 --> 00:54:27,839
now trying to steal everybody's flags

951
00:54:27,839 --> 00:54:29,200
everybody's trying to steal everybody's

952
00:54:29,200 --> 00:54:31,440
flags and submit them for some points

953
00:54:31,440 --> 00:54:33,040
and you can you can go ahead but if you

954
00:54:33,040 --> 00:54:34,720
stick with me if you stay with me for a

955
00:54:34,720 --> 00:54:36,799
second i'll show you how you can get a

956
00:54:36,799 --> 00:54:39,040
lot more points much faster so you don't

957
00:54:39,040 --> 00:54:40,640
have to do it manually yourself even

958
00:54:40,640 --> 00:54:42,799
with even faster than a python script

959
00:54:42,799 --> 00:54:45,920
okay you can see right now that i jumped

960
00:54:45,920 --> 00:54:47,920
to eighth place you know and it even

961
00:54:47,920 --> 00:54:50,119
says i stole 38

962
00:54:50,119 --> 00:54:53,040
38.26 flag points okay notice how my

963
00:54:53,040 --> 00:54:54,799
service is still corrupt i'm still

964
00:54:54,799 --> 00:54:56,240
losing sla

965
00:54:56,240 --> 00:54:59,040
can you imagine so again deleting flags

966
00:54:59,040 --> 00:55:00,799
and messing with flags is a very serious

967
00:55:00,799 --> 00:55:03,280
thing don't do that right so let's move

968
00:55:03,280 --> 00:55:04,799
on

969
00:55:04,799 --> 00:55:06,559
so we just successfully submitted our

970
00:55:06,559 --> 00:55:08,799
first flag we stole our first flag and

971
00:55:08,799 --> 00:55:11,280
we submitted it that's great awesome

972
00:55:11,280 --> 00:55:13,359
what now i want to automate this i want

973
00:55:13,359 --> 00:55:15,599
to write this in a script so let's talk

974
00:55:15,599 --> 00:55:17,760
about writing scripts obviously the best

975
00:55:17,760 --> 00:55:20,160
language i can recommend is python

976
00:55:20,160 --> 00:55:21,200
however

977
00:55:21,200 --> 00:55:24,000
you are more than welcome to write

978
00:55:24,000 --> 00:55:26,799
exploit scripts in any language you pick

979
00:55:26,799 --> 00:55:28,319
hell if you want to write an exploit

980
00:55:28,319 --> 00:55:29,760
script in assembly i mean you're going

981
00:55:29,760 --> 00:55:31,839
to waste a lot of time but nobody's

982
00:55:31,839 --> 00:55:34,640
stopping you you're more than welcome to

983
00:55:34,640 --> 00:55:36,240
but you're just going to waste a lot of

984
00:55:36,240 --> 00:55:38,160
time and python is great because it has

985
00:55:38,160 --> 00:55:40,960
a lot of libraries for very quick you

986
00:55:40,960 --> 00:55:42,319
know let's say you want to interface

987
00:55:42,319 --> 00:55:43,760
with the data with the

988
00:55:43,760 --> 00:55:46,000
database very easily you'll just google

989
00:55:46,000 --> 00:55:48,720
 database python library and that's

990
00:55:48,720 --> 00:55:51,440
it you'll be good to go so i recommend

991
00:55:51,440 --> 00:55:53,680
python python two or three that's pretty

992
00:55:53,680 --> 00:55:57,040
much your choice i would recommend three

993
00:55:57,040 --> 00:55:59,359
but python is the best language but if

994
00:55:59,359 --> 00:56:00,880
you write ruby for example another

995
00:56:00,880 --> 00:56:02,799
scripting language that's fine you want

996
00:56:02,799 --> 00:56:05,200
to write go for concurrency you want to

997
00:56:05,200 --> 00:56:06,960
write

998
00:56:06,960 --> 00:56:09,760
javascript i don't know why you do that

999
00:56:09,760 --> 00:56:12,480
any language up to you all right just

1000
00:56:12,480 --> 00:56:14,559
python is best you should always learn

1001
00:56:14,559 --> 00:56:17,359
python so let's talk about the format

1002
00:56:17,359 --> 00:56:19,920
how should you write exploits now i'm

1003
00:56:19,920 --> 00:56:21,839
specifying a specific format you're

1004
00:56:21,839 --> 00:56:23,599
pretty much free to pick whatever format

1005
00:56:23,599 --> 00:56:25,200
you want you can write your scripts in

1006
00:56:25,200 --> 00:56:27,440
whatever way you want but the reason why

1007
00:56:27,440 --> 00:56:29,040
i am telling you to use a specific

1008
00:56:29,040 --> 00:56:32,000
format is because we're going to later

1009
00:56:32,000 --> 00:56:34,720
import those scripts into something we

1010
00:56:34,720 --> 00:56:36,960
call an exploit farm and you'll see how

1011
00:56:36,960 --> 00:56:39,839
amazingly useful this exploit form is

1012
00:56:39,839 --> 00:56:41,760
you'll see how important it is

1013
00:56:41,760 --> 00:56:42,640
all right

1014
00:56:42,640 --> 00:56:44,480
so the exploit script

1015
00:56:44,480 --> 00:56:46,960
should take a single ip address as a

1016
00:56:46,960 --> 00:56:48,880
command line argument

1017
00:56:48,880 --> 00:56:51,599
and print every flag that it steals

1018
00:56:51,599 --> 00:56:54,160
separated by a new line all right and

1019
00:56:54,160 --> 00:56:56,000
it's recommended it's very recommended

1020
00:56:56,000 --> 00:56:58,559
to include some hard-coded timeouts in

1021
00:56:58,559 --> 00:57:00,319
your script so let's say timeout of 20

1022
00:57:00,319 --> 00:57:02,640
seconds 10 seconds because some teams

1023
00:57:02,640 --> 00:57:04,720
might slow down their service on purpose

1024
00:57:04,720 --> 00:57:06,640
so some teams might make it so that

1025
00:57:06,640 --> 00:57:10,559
their service responds in 40 seconds

1026
00:57:10,559 --> 00:57:13,839
you know they they throttle the internet

1027
00:57:13,839 --> 00:57:15,359
on their service

1028
00:57:15,359 --> 00:57:17,280
okay so that means your script will just

1029
00:57:17,280 --> 00:57:19,599
stay there waiting waiting forever

1030
00:57:19,599 --> 00:57:21,359
hoping to connect to the database and it

1031
00:57:21,359 --> 00:57:23,440
might take 40 seconds which is a lot of

1032
00:57:23,440 --> 00:57:24,400
time

1033
00:57:24,400 --> 00:57:27,280
reducing the chances that you exploit

1034
00:57:27,280 --> 00:57:31,200
another team all right so

1035
00:57:31,200 --> 00:57:34,079
let's let's move on so this is the

1036
00:57:34,079 --> 00:57:36,480
exploit script that i wrote

1037
00:57:36,480 --> 00:57:39,760
for nasa rasa's open database right and

1038
00:57:39,760 --> 00:57:41,359
i'm going to open it up for you guys

1039
00:57:41,359 --> 00:57:43,359
right now because i need to change

1040
00:57:43,359 --> 00:57:45,359
actually a couple of things about it

1041
00:57:45,359 --> 00:57:47,520
so

1042
00:57:47,520 --> 00:57:51,240
it was a

1043
00:57:54,880 --> 00:57:57,280
right let's open the exploit folder and

1044
00:57:57,280 --> 00:58:00,960
visual code my favorite code editor

1045
00:58:00,960 --> 00:58:02,160
so

1046
00:58:02,160 --> 00:58:04,000
nope not the service exploit we want the

1047
00:58:04,000 --> 00:58:05,839
database exploit so

1048
00:58:05,839 --> 00:58:08,559
you can realize here that this exploit

1049
00:58:08,559 --> 00:58:10,799
connects to exposed mysql and steals

1050
00:58:10,799 --> 00:58:12,720
flags okay

1051
00:58:12,720 --> 00:58:15,920
i import a pi mysql library and i import

1052
00:58:15,920 --> 00:58:18,559
sys and the reason why i am i import sys

1053
00:58:18,559 --> 00:58:20,880
is like i said the argument the ip

1054
00:58:20,880 --> 00:58:22,960
address is the first argument on the

1055
00:58:22,960 --> 00:58:25,520
command line so i take the argument

1056
00:58:25,520 --> 00:58:26,960
which is the host we're going to attack

1057
00:58:26,960 --> 00:58:29,200
and i save it i have hard-coded here the

1058
00:58:29,200 --> 00:58:30,400
username and password that we're going

1059
00:58:30,400 --> 00:58:31,599
to use

1060
00:58:31,599 --> 00:58:34,079
very simple script i just connect

1061
00:58:34,079 --> 00:58:35,680
with to the host with the username and

1062
00:58:35,680 --> 00:58:37,040
password

1063
00:58:37,040 --> 00:58:39,440
i'm connecting to the database the nasa

1064
00:58:39,440 --> 00:58:41,040
rasa database i have a connection

1065
00:58:41,040 --> 00:58:43,280
timeout of 10 seconds

1066
00:58:43,280 --> 00:58:45,200
and don't worry about cursor class this

1067
00:58:45,200 --> 00:58:46,799
is just straight up from the

1068
00:58:46,799 --> 00:58:49,359
documentation all right if any exception

1069
00:58:49,359 --> 00:58:51,839
happens incorrect password or timeout or

1070
00:58:51,839 --> 00:58:53,280
anything just exit the script i don't

1071
00:58:53,280 --> 00:58:54,480
want to waste time

1072
00:58:54,480 --> 00:58:57,680
okay and then i'm selecting message from

1073
00:58:57,680 --> 00:58:58,960
planets

1074
00:58:58,960 --> 00:59:00,480
where and then there's a field called

1075
00:59:00,480 --> 00:59:02,559
edit at

1076
00:59:02,559 --> 00:59:04,240
and this is just me checking that the

1077
00:59:04,240 --> 00:59:06,960
flag is one minute old and you know what

1078
00:59:06,960 --> 00:59:09,280
we can remove all of this

1079
00:59:09,280 --> 00:59:11,280
all of that you can remove all that give

1080
00:59:11,280 --> 00:59:13,680
me all the messages so give me

1081
00:59:13,680 --> 00:59:15,359
everything

1082
00:59:15,359 --> 00:59:17,599
all the flags and the planets table and

1083
00:59:17,599 --> 00:59:18,960
we're going to talk about why you might

1084
00:59:18,960 --> 00:59:20,400
be wondering right now oh what if the

1085
00:59:20,400 --> 00:59:22,079
flag is expired what if it's old what if

1086
00:59:22,079 --> 00:59:23,599
it's duplicate we're going to talk about

1087
00:59:23,599 --> 00:59:24,960
that all right

1088
00:59:24,960 --> 00:59:27,599
and all i do is i i execute this sql

1089
00:59:27,599 --> 00:59:28,640
statement

1090
00:59:28,640 --> 00:59:31,520
and for every single flag i print it on

1091
00:59:31,520 --> 00:59:32,480
a new line

1092
00:59:32,480 --> 00:59:34,480
and then i end it with this print

1093
00:59:34,480 --> 00:59:37,040
nothing flush equal true and this is

1094
00:59:37,040 --> 00:59:38,480
important it says i have a note here

1095
00:59:38,480 --> 00:59:40,880
that says important for destructive form

1096
00:59:40,880 --> 00:59:42,240
and that's the exploit form we're going

1097
00:59:42,240 --> 00:59:43,760
to be using okay it has in the

1098
00:59:43,760 --> 00:59:45,359
documentation that you should always

1099
00:59:45,359 --> 00:59:47,520
flush std out

1100
00:59:47,520 --> 00:59:49,760
at the end of your script okay and this

1101
00:59:49,760 --> 00:59:52,319
is just you know if just remember to put

1102
00:59:52,319 --> 00:59:54,160
these always at the end of your scripts

1103
00:59:54,160 --> 00:59:56,480
this print whatever

1104
00:59:56,480 --> 00:59:58,720
print nothing flush equal true okay

1105
00:59:58,720 --> 00:59:59,920
again you'll have the links to

1106
00:59:59,920 --> 01:00:01,359
destructive farm you can go read their

1107
01:00:01,359 --> 01:00:03,839
documentation and i'll show you how how

1108
01:00:03,839 --> 01:00:06,000
that works okay and this is the exploit

1109
01:00:06,000 --> 01:00:07,760
script right now i can i can genuinely

1110
01:00:07,760 --> 01:00:09,280
run this right now

1111
01:00:09,280 --> 01:00:12,240
i can take this

1112
01:00:12,880 --> 01:00:15,200
and i can say python

1113
01:00:15,200 --> 01:00:17,359
and

1114
01:00:17,359 --> 01:00:20,960
i want to run this db exploit on 10.60

1115
01:00:20,960 --> 01:00:23,200
let's run it on myself for example

1116
01:00:23,200 --> 01:00:25,520
it connects dumps all the flags on a new

1117
01:00:25,520 --> 01:00:27,280
line and leaves

1118
01:00:27,280 --> 01:00:32,000
okay i can point this at tm51

1119
01:00:33,440 --> 01:00:35,119
it's taking some time

1120
01:00:35,119 --> 01:00:37,440
and again it has 10 seconds so in those

1121
01:00:37,440 --> 01:00:39,440
10 seconds if it can't connect i tell it

1122
01:00:39,440 --> 01:00:40,880
to give up

1123
01:00:40,880 --> 01:00:43,119
and it gives up okay so something went

1124
01:00:43,119 --> 01:00:46,000
wrong uh but a different team at team 12

1125
01:00:46,000 --> 01:00:48,480
again log in dump their flags and that's

1126
01:00:48,480 --> 01:00:50,720
that okay so there we go we verified

1127
01:00:50,720 --> 01:00:52,960
that our exploit works and that it's not

1128
01:00:52,960 --> 01:00:56,799
going to waste time on on on databases

1129
01:00:56,799 --> 01:00:58,640
that might be patched or or there's

1130
01:00:58,640 --> 01:01:01,599
connection issues or it's dropped or all

1131
01:01:01,599 --> 01:01:03,520
that stuff all right

1132
01:01:03,520 --> 01:01:05,280
so now what now what we wrote our

1133
01:01:05,280 --> 01:01:07,200
exploit script again and we want to

1134
01:01:07,200 --> 01:01:09,440
automate this even further i want to

1135
01:01:09,440 --> 01:01:12,240
automate this python exploit such that

1136
01:01:12,240 --> 01:01:14,799
every 60 seconds

1137
01:01:14,799 --> 01:01:16,000
every round

1138
01:01:16,000 --> 01:01:18,720
it will run the exploits again

1139
01:01:18,720 --> 01:01:21,359
and grab all the flags automatically

1140
01:01:21,359 --> 01:01:23,520
read those flags and submit them and

1141
01:01:23,520 --> 01:01:27,040
only submit the non-duplicates okay only

1142
01:01:27,040 --> 01:01:29,280
submit non-duplicates and submit valid

1143
01:01:29,280 --> 01:01:32,160
flags so how can we automate that that

1144
01:01:32,160 --> 01:01:34,480
is where exploit farms come into play

1145
01:01:34,480 --> 01:01:36,960
that's where the most vital component

1146
01:01:36,960 --> 01:01:40,480
which is exploit farms comes into play

1147
01:01:40,480 --> 01:01:42,160
all right and you guys don't worry about

1148
01:01:42,160 --> 01:01:44,400
trying to screenshot this and copy it

1149
01:01:44,400 --> 01:01:45,520
down you guys will have all these

1150
01:01:45,520 --> 01:01:47,040
scripts at the end but if you want to

1151
01:01:47,040 --> 01:01:49,040
follow along you're more than welcome to

1152
01:01:49,040 --> 01:01:50,000
okay

1153
01:01:50,000 --> 01:01:51,359
so

1154
01:01:51,359 --> 01:01:53,119
using an exploit farm in an attack

1155
01:01:53,119 --> 01:01:55,760
defense what are they exploit farms are

1156
01:01:55,760 --> 01:01:58,000
tools that allow for the automatic

1157
01:01:58,000 --> 01:01:59,440
exploitation of discovered

1158
01:01:59,440 --> 01:02:01,359
vulnerabilities and the submission of

1159
01:02:01,359 --> 01:02:02,960
the stolen flags

1160
01:02:02,960 --> 01:02:05,359
this allows teams to easily grab flags

1161
01:02:05,359 --> 01:02:06,799
without having to worry about syncing

1162
01:02:06,799 --> 01:02:08,319
exploits with rounds running them

1163
01:02:08,319 --> 01:02:10,640
manually validating flags and all that

1164
01:02:10,640 --> 01:02:12,880
stuff the exploit farm that we are going

1165
01:02:12,880 --> 01:02:14,480
to be using in this training is

1166
01:02:14,480 --> 01:02:16,880
destructive farm now it's called

1167
01:02:16,880 --> 01:02:19,680
destructive farm and

1168
01:02:19,680 --> 01:02:21,680
one person told me this and i think it

1169
01:02:21,680 --> 01:02:23,599
was andrew i think it's it's it's called

1170
01:02:23,599 --> 01:02:26,319
destructive farm not because it destroys

1171
01:02:26,319 --> 01:02:28,240
but because the person who wrote it is

1172
01:02:28,240 --> 01:02:29,760
part of a team a ctf team called

1173
01:02:29,760 --> 01:02:31,839
destructive all right

1174
01:02:31,839 --> 01:02:34,000
and this is their documentation and it

1175
01:02:34,000 --> 01:02:35,599
comes in two pieces and we're going to

1176
01:02:35,599 --> 01:02:36,960
talk about exploit form right now you

1177
01:02:36,960 --> 01:02:38,240
guys are going to set it up with me

1178
01:02:38,240 --> 01:02:39,280
we're going to do it together we're

1179
01:02:39,280 --> 01:02:41,039
going to have it running all right

1180
01:02:41,039 --> 01:02:43,599
so setting up destructive farm server so

1181
01:02:43,599 --> 01:02:46,559
destructive farm comes in two pieces a

1182
01:02:46,559 --> 01:02:48,640
server and the client so i need you all

1183
01:02:48,640 --> 01:02:50,160
to pay attention with me all right

1184
01:02:50,160 --> 01:02:51,760
follow my commands first thing we're

1185
01:02:51,760 --> 01:02:53,200
going to do is we're going to grab this

1186
01:02:53,200 --> 01:02:54,880
i'm going to paste it in chat

1187
01:02:54,880 --> 01:02:57,359
we're going to install python 3.

1188
01:02:57,359 --> 01:02:59,280
so go into your vault images

1189
01:02:59,280 --> 01:03:03,839
and install python 3 right

1190
01:03:04,400 --> 01:03:08,440
give it a second while it runs

1191
01:03:39,200 --> 01:03:41,039
and i'm done

1192
01:03:41,039 --> 01:03:42,720
so i'm done and i'm done installing

1193
01:03:42,720 --> 01:03:44,720
python3 okay might take a couple more

1194
01:03:44,720 --> 01:03:46,880
seconds for you guys but that's fine

1195
01:03:46,880 --> 01:03:47,920
next thing we're going to do is we're

1196
01:03:47,920 --> 01:03:49,440
simply going to copy again this git

1197
01:03:49,440 --> 01:03:50,799
clone command and i'm going to paste it

1198
01:03:50,799 --> 01:03:52,720
in the chat

1199
01:03:52,720 --> 01:03:54,079
all right

1200
01:03:54,079 --> 01:03:55,920
and we're going to clone

1201
01:03:55,920 --> 01:03:57,760
destructive farm make sure you're in the

1202
01:03:57,760 --> 01:03:59,280
home directory okay you don't want to be

1203
01:03:59,280 --> 01:04:02,079
in slash home slash you know some one of

1204
01:04:02,079 --> 01:04:04,480
your services sub directories okay be in

1205
01:04:04,480 --> 01:04:07,359
your home directory and just

1206
01:04:07,359 --> 01:04:10,000
get clone destructive form okay

1207
01:04:10,000 --> 01:04:11,039
now

1208
01:04:11,039 --> 01:04:13,440
for we're going to cd into destructive

1209
01:04:13,440 --> 01:04:14,400
farm

1210
01:04:14,400 --> 01:04:16,079
server so we're going to the server

1211
01:04:16,079 --> 01:04:18,559
folder of destructive farm okay

1212
01:04:18,559 --> 01:04:20,960
and we're just going to install

1213
01:04:20,960 --> 01:04:23,400
the requirements so pip install

1214
01:04:23,400 --> 01:04:25,359
requirements.txt so we're installing all

1215
01:04:25,359 --> 01:04:27,839
the requirements

1216
01:04:30,160 --> 01:04:32,319
all right great so we installed all the

1217
01:04:32,319 --> 01:04:33,680
requirements right here installed all

1218
01:04:33,680 --> 01:04:36,799
the libraries that it that it needs

1219
01:04:36,799 --> 01:04:39,520
and how do we get it to run so one very

1220
01:04:39,520 --> 01:04:41,039
important thing is that we have to

1221
01:04:41,039 --> 01:04:43,520
configure a destructive farm we have to

1222
01:04:43,520 --> 01:04:46,160
tell it how to talk to the check system

1223
01:04:46,160 --> 01:04:47,839
and how often to talk to the track

1224
01:04:47,839 --> 01:04:49,920
system and how often

1225
01:04:49,920 --> 01:04:52,160
to and like how to recognize our

1226
01:04:52,160 --> 01:04:53,280
exploits

1227
01:04:53,280 --> 01:04:55,359
all right so

1228
01:04:55,359 --> 01:04:57,760
you're gonna find a fold a file

1229
01:04:57,760 --> 01:05:01,039
in this server folder called config.pipe

1230
01:05:01,039 --> 01:05:03,599
so open that up in nano or your other

1231
01:05:03,599 --> 01:05:05,039
favorite editor

1232
01:05:05,039 --> 01:05:06,400
and you're gonna notice that there's

1233
01:05:06,400 --> 01:05:09,200
already some things happening here

1234
01:05:09,200 --> 01:05:11,119
so let's start with the first line it

1235
01:05:11,119 --> 01:05:14,960
wants to know how it can attack

1236
01:05:14,960 --> 01:05:17,359
different teams what's the network and

1237
01:05:17,359 --> 01:05:19,359
nano has the formatting a little bit

1238
01:05:19,359 --> 01:05:21,119
wrong so nano is a little bit confused

1239
01:05:21,119 --> 01:05:22,640
about this and has this marked as a

1240
01:05:22,640 --> 01:05:24,240
comment but it's not a comment don't

1241
01:05:24,240 --> 01:05:25,920
worry about it we're going to come here

1242
01:05:25,920 --> 01:05:27,920
to this 10.0.0.0.

1243
01:05:27,920 --> 01:05:29,920
you see how it's it's looping it's

1244
01:05:29,920 --> 01:05:32,960
replacing the last number

1245
01:05:32,960 --> 01:05:34,960
with the team with the team name with

1246
01:05:34,960 --> 01:05:36,720
the team number that's not how it works

1247
01:05:36,720 --> 01:05:40,559
in our network our network is 10.60

1248
01:05:40,559 --> 01:05:42,559
and the variable that changes is

1249
01:05:42,559 --> 01:05:44,160
actually this number right here so we're

1250
01:05:44,160 --> 01:05:45,920
going to put the curly braces here

1251
01:05:45,920 --> 01:05:47,839
instead and we're going to change this

1252
01:05:47,839 --> 01:05:50,319
last number to three

1253
01:05:50,319 --> 01:05:53,680
so this is how we successfully loop

1254
01:05:53,680 --> 01:05:55,520
between

1255
01:05:55,520 --> 01:05:57,039
all the different teams all right and

1256
01:05:57,039 --> 01:05:58,640
you can even change the loop right here

1257
01:05:58,640 --> 01:06:00,319
so you see how it's only looping between

1258
01:06:00,319 --> 01:06:03,119
1 and 30. we don't want that we have

1259
01:06:03,119 --> 01:06:05,440
like 50 teams here so you can change

1260
01:06:05,440 --> 01:06:06,640
that

1261
01:06:06,640 --> 01:06:09,200
and make it for example let's go to the

1262
01:06:09,200 --> 01:06:10,799
scoreboard and see how many teams are

1263
01:06:10,799 --> 01:06:13,599
here although most of the teams are down

1264
01:06:13,599 --> 01:06:16,400
so i'm going to say you have about

1265
01:06:16,400 --> 01:06:18,160
well we can't really judge it like that

1266
01:06:18,160 --> 01:06:19,680
because all these teams are all over the

1267
01:06:19,680 --> 01:06:20,960
place

1268
01:06:20,960 --> 01:06:22,400
uh

1269
01:06:22,400 --> 01:06:23,920
let's just you know what for now let's

1270
01:06:23,920 --> 01:06:25,599
just keep it

1271
01:06:25,599 --> 01:06:26,720
60.

1272
01:06:26,720 --> 01:06:28,480
okay

1273
01:06:28,480 --> 01:06:31,200
you're looping on 60 teams you're

1274
01:06:31,200 --> 01:06:34,480
running the exploit on 60 teams okay

1275
01:06:34,480 --> 01:06:37,200
so let's save

1276
01:06:37,359 --> 01:06:39,280
we have 53 teams exact all right i'll

1277
01:06:39,280 --> 01:06:41,599
just keep the 53 teams here

1278
01:06:41,599 --> 01:06:42,960
thanks mohan

1279
01:06:42,960 --> 01:06:45,200
so

1280
01:06:45,440 --> 01:06:48,319
the flag format is essentially the flag

1281
01:06:48,319 --> 01:06:50,160
regex and this one

1282
01:06:50,160 --> 01:06:52,880
actually works this matches our regex we

1283
01:06:52,880 --> 01:06:54,559
have a number of characters either

1284
01:06:54,559 --> 01:06:57,599
letters or numbers 31 times and an equal

1285
01:06:57,599 --> 01:06:59,119
sign at the end so i know some of you

1286
01:06:59,119 --> 01:07:00,880
are going to be like oh but it could be

1287
01:07:00,880 --> 01:07:02,559
where's the backslash w it's supposed to

1288
01:07:02,559 --> 01:07:05,200
be a backslash wl if you guys know regex

1289
01:07:05,200 --> 01:07:08,400
backslash w essentially means a to zero

1290
01:07:08,400 --> 01:07:09,440
to nine

1291
01:07:09,440 --> 01:07:10,400
okay

1292
01:07:10,400 --> 01:07:11,920
so i'm just going to leave this without

1293
01:07:11,920 --> 01:07:15,200
saving all right and it's back all right

1294
01:07:15,200 --> 01:07:17,920
now this is where this section down here

1295
01:07:17,920 --> 01:07:22,559
is where we configure the protocol that

1296
01:07:22,559 --> 01:07:24,400
no no lower case

1297
01:07:24,400 --> 01:07:26,079
flags don't contain lowercase it's all

1298
01:07:26,079 --> 01:07:27,520
uppercase have you ever seen in any of

1299
01:07:27,520 --> 01:07:30,559
the flags lowercase no it's it's a to z

1300
01:07:30,559 --> 01:07:32,960
however backslash w in python does

1301
01:07:32,960 --> 01:07:35,520
contain lowercase letters yes that

1302
01:07:35,520 --> 01:07:37,520
that's correct but

1303
01:07:37,520 --> 01:07:39,200
the actual regex is actually all

1304
01:07:39,200 --> 01:07:40,319
uppercase

1305
01:07:40,319 --> 01:07:41,680
if you're feeling if you're feeling kind

1306
01:07:41,680 --> 01:07:43,119
of panicked you can just add a to z

1307
01:07:43,119 --> 01:07:46,720
lowercase here it's no worries

1308
01:07:49,680 --> 01:07:50,480
right

1309
01:07:50,480 --> 01:07:54,640
okay so moving on from the flag format

1310
01:07:54,960 --> 01:07:56,400
you can see here that there are some

1311
01:07:56,400 --> 01:07:57,520
presets

1312
01:07:57,520 --> 01:08:00,079
okay the presets for check system

1313
01:08:00,079 --> 01:08:02,160
configurations you can see this the one

1314
01:08:02,160 --> 01:08:05,119
that's uncommented right now is ru ctf

1315
01:08:05,119 --> 01:08:07,440
tcp all right and that's not what we're

1316
01:08:07,440 --> 01:08:09,359
using you actually want to come down

1317
01:08:09,359 --> 01:08:12,960
here to ru ctf http and that is the

1318
01:08:12,960 --> 01:08:14,880
check system that we're using

1319
01:08:14,880 --> 01:08:15,839
and

1320
01:08:15,839 --> 01:08:18,238
change this ip address change the system

1321
01:08:18,238 --> 01:08:19,439
url

1322
01:08:19,439 --> 01:08:23,040
to the check system so 10.10.10.10

1323
01:08:23,040 --> 01:08:26,080
and the system token well

1324
01:08:26,080 --> 01:08:26,960
you

1325
01:08:26,960 --> 01:08:29,198
need to drop in here

1326
01:08:29,198 --> 01:08:32,479
your secret team token all right

1327
01:08:32,479 --> 01:08:34,640
that's what it uses to authenticate to

1328
01:08:34,640 --> 01:08:36,000
the check system

1329
01:08:36,000 --> 01:08:37,520
all right and you can come down here and

1330
01:08:37,520 --> 01:08:39,359
let's look at other things here

1331
01:08:39,359 --> 01:08:40,080
so

1332
01:08:40,080 --> 01:08:42,479
the server will not

1333
01:08:42,479 --> 01:08:44,799
will submit not more than submit flag

1334
01:08:44,799 --> 01:08:47,439
limit every submit period seconds so

1335
01:08:47,439 --> 01:08:49,520
every five seconds it will not submit

1336
01:08:49,520 --> 01:08:51,759
more than 50 flags and that default is

1337
01:08:51,759 --> 01:08:53,198
perfectly fine

1338
01:08:53,198 --> 01:08:56,158
and we have to tell it here how long

1339
01:08:56,158 --> 01:08:58,399
does it can a flag go on until it's

1340
01:08:58,399 --> 01:09:01,600
considered expired

1341
01:09:01,600 --> 01:09:02,799
okay

1342
01:09:02,799 --> 01:09:04,080
and

1343
01:09:04,080 --> 01:09:06,238
we can say here it has it at five

1344
01:09:06,238 --> 01:09:07,920
minutes we're gonna just tell it the

1345
01:09:07,920 --> 01:09:10,880
actual expiration of a flag which is 15

1346
01:09:10,880 --> 01:09:15,359
minutes flags expire 15 minutes okay

1347
01:09:15,359 --> 01:09:17,198
now this is the password for the web

1348
01:09:17,198 --> 01:09:18,719
interface now it's important for you

1349
01:09:18,719 --> 01:09:21,198
guys to have this

1350
01:09:21,198 --> 01:09:23,520
uh to put this to a strong password

1351
01:09:23,520 --> 01:09:26,080
because your server is going to be

1352
01:09:26,080 --> 01:09:29,279
exposed to everybody on the game network

1353
01:09:29,279 --> 01:09:30,158
okay

1354
01:09:30,158 --> 01:09:31,759
i'm gonna leave it to one two three four

1355
01:09:31,759 --> 01:09:33,759
because we're all going to have the same

1356
01:09:33,759 --> 01:09:35,198
service running and there is nothing

1357
01:09:35,198 --> 01:09:37,679
greedy you can benefit so

1358
01:09:37,679 --> 01:09:39,520
go ahead if you want to log in i mean

1359
01:09:39,520 --> 01:09:40,880
you shouldn't you should kind of focus

1360
01:09:40,880 --> 01:09:42,399
on your own service but

1361
01:09:42,399 --> 01:09:43,839
what what can happen

1362
01:09:43,839 --> 01:09:46,158
all right

1363
01:09:46,158 --> 01:09:47,120
so

1364
01:09:47,120 --> 01:09:49,600
now we're done configuring config.pi

1365
01:09:49,600 --> 01:09:52,480
i'm going to close this

1366
01:09:52,560 --> 01:09:53,679
and

1367
01:09:53,679 --> 01:09:56,080
now that we've configured config.pi we

1368
01:09:56,080 --> 01:09:57,360
can come here

1369
01:09:57,360 --> 01:10:00,880
and run startserver.sh

1370
01:10:00,880 --> 01:10:02,159
all we're going to do is do start

1371
01:10:02,159 --> 01:10:05,519
server.sh like this

1372
01:10:05,679 --> 01:10:07,199
and it's running

1373
01:10:07,199 --> 01:10:08,800
okay of course you might want to put

1374
01:10:08,800 --> 01:10:11,520
this in a tmux session so let's do that

1375
01:10:11,520 --> 01:10:13,520
so i'm going to open a new tmux session

1376
01:10:13,520 --> 01:10:15,520
or tmux and i'm going to run

1377
01:10:15,520 --> 01:10:17,840
the

1378
01:10:17,920 --> 01:10:20,239
start server script there

1379
01:10:20,239 --> 01:10:22,320
if you guys are stuck inside tmux and

1380
01:10:22,320 --> 01:10:23,360
you don't know how to leave and you're

1381
01:10:23,360 --> 01:10:24,880
like what is happening you just do

1382
01:10:24,880 --> 01:10:27,920
control b and then d

1383
01:10:27,920 --> 01:10:30,000
for detach okay for those of you haven't

1384
01:10:30,000 --> 01:10:31,440
used i would highly recommend you get

1385
01:10:31,440 --> 01:10:34,000
used to tmux or screen both of them do

1386
01:10:34,000 --> 01:10:35,120
the same thing

1387
01:10:35,120 --> 01:10:36,239
because you want to be able to run

1388
01:10:36,239 --> 01:10:37,920
things in the background all right so

1389
01:10:37,920 --> 01:10:39,280
now we have

1390
01:10:39,280 --> 01:10:40,800
our server

1391
01:10:40,800 --> 01:10:42,159
running in the background and we can

1392
01:10:42,159 --> 01:10:45,199
access it on port

1393
01:10:45,199 --> 01:10:47,520
well i don't remember what port let's

1394
01:10:47,520 --> 01:10:49,120
let's find out i must have written it in

1395
01:10:49,120 --> 01:10:50,960
the slides

1396
01:10:50,960 --> 01:10:54,400
board 5000 yes so you can come here and

1397
01:10:54,400 --> 01:10:56,400
go 10

1398
01:10:56,400 --> 01:10:58,080
60.

1399
01:10:58,080 --> 01:11:01,679
100 in my case port 5000

1400
01:11:01,679 --> 01:11:04,640
all right so

1401
01:11:04,640 --> 01:11:06,719
huh what is the username

1402
01:11:06,719 --> 01:11:10,400
that is great i don't remember that

1403
01:11:10,800 --> 01:11:12,560
let's just come here down to the farm

1404
01:11:12,560 --> 01:11:15,760
server more details

1405
01:11:15,840 --> 01:11:20,000
credentials credentials credentials

1406
01:11:20,159 --> 01:11:21,600
oh you can use the password one two

1407
01:11:21,600 --> 01:11:24,560
three four and any login to enter any

1408
01:11:24,560 --> 01:11:27,440
login work so any username all right

1409
01:11:27,440 --> 01:11:28,159
so

1410
01:11:28,159 --> 01:11:31,159
10.60.100.3

1411
01:11:31,280 --> 01:11:34,560
port 5000 for i'll just use admin

1412
01:11:34,560 --> 01:11:36,400
and as long as the password is one two

1413
01:11:36,400 --> 01:11:38,320
three four and you're in

1414
01:11:38,320 --> 01:11:39,520
all right

1415
01:11:39,520 --> 01:11:40,400
so

1416
01:11:40,400 --> 01:11:42,320
you get this nice

1417
01:11:42,320 --> 01:11:44,159
you know interface and nothing's really

1418
01:11:44,159 --> 01:11:45,920
happening here okay nothing really

1419
01:11:45,920 --> 01:11:48,159
happened

1420
01:11:48,159 --> 01:11:49,600
there's nothing happening here this is

1421
01:11:49,600 --> 01:11:51,760
just where you would see where your

1422
01:11:51,760 --> 01:11:54,239
flags are being submitted all right we

1423
01:11:54,239 --> 01:11:56,640
have to add exploits how do we add

1424
01:11:56,640 --> 01:11:58,640
exploits to our amazing

1425
01:11:58,640 --> 01:11:59,920
nice

1426
01:11:59,920 --> 01:12:01,679
and interesting

1427
01:12:01,679 --> 01:12:04,000
exploit form well

1428
01:12:04,000 --> 01:12:06,320
we are gonna talk about that

1429
01:12:06,320 --> 01:12:08,640
so you guys are gonna have to and set up

1430
01:12:08,640 --> 01:12:11,360
the the destructive farm client on your

1431
01:12:11,360 --> 01:12:13,760
own machines of course you can run the

1432
01:12:13,760 --> 01:12:16,320
destructive farm client on the server as

1433
01:12:16,320 --> 01:12:18,159
well but for now we're gonna run it on

1434
01:12:18,159 --> 01:12:20,239
our own machines so

1435
01:12:20,239 --> 01:12:22,320
destructive client destructive farm

1436
01:12:22,320 --> 01:12:24,560
client this is where you will run your

1437
01:12:24,560 --> 01:12:26,560
exploits so you run your exploits on

1438
01:12:26,560 --> 01:12:28,719
your own machines and this is better

1439
01:12:28,719 --> 01:12:30,480
uh just so that you know you don't have

1440
01:12:30,480 --> 01:12:32,080
to worry about uploading your exploits

1441
01:12:32,080 --> 01:12:33,760
to the server and all that stuff

1442
01:12:33,760 --> 01:12:35,280
although obviously if you want your

1443
01:12:35,280 --> 01:12:36,880
exploits to be running overnight you

1444
01:12:36,880 --> 01:12:39,120
would upload it to the server okay but

1445
01:12:39,120 --> 01:12:42,080
in a real competition uh usually they

1446
01:12:42,080 --> 01:12:44,800
don't leave the game network open 24 7.

1447
01:12:44,800 --> 01:12:46,000
usually there's like oh well you're

1448
01:12:46,000 --> 01:12:47,600
going to play from

1449
01:12:47,600 --> 01:12:49,520
8 a.m to 9 p.m and then we're going to

1450
01:12:49,520 --> 01:12:50,960
close the network so

1451
01:12:50,960 --> 01:12:52,159
you don't have to worry about that but

1452
01:12:52,159 --> 01:12:53,440
anyway

1453
01:12:53,440 --> 01:12:56,960
for those of you using windows i

1454
01:12:56,960 --> 01:12:58,400
i'm sorry

1455
01:12:58,400 --> 01:13:00,000
you really shouldn't be using windows

1456
01:13:00,000 --> 01:13:01,600
for these kind of competitions anyway i

1457
01:13:01,600 --> 01:13:03,760
hope you have a linux terminal somewhere

1458
01:13:03,760 --> 01:13:06,320
wsl or a vm or absolutely anything at

1459
01:13:06,320 --> 01:13:09,040
all but if not i'll try my best to try

1460
01:13:09,040 --> 01:13:10,400
and accommodate you

1461
01:13:10,400 --> 01:13:11,679
and

1462
01:13:11,679 --> 01:13:13,360
teach you how this runs so essentially

1463
01:13:13,360 --> 01:13:14,719
because we're going to be downloading a

1464
01:13:14,719 --> 01:13:16,320
python script onto our machines and

1465
01:13:16,320 --> 01:13:18,880
running it so if you're on windows and

1466
01:13:18,880 --> 01:13:20,480
manually go to this link so i'm going to

1467
01:13:20,480 --> 01:13:23,040
copy this command right here

1468
01:13:23,040 --> 01:13:25,040
if you're on windows manually go to the

1469
01:13:25,040 --> 01:13:27,199
bitly link and just download that python

1470
01:13:27,199 --> 01:13:29,040
script and save it somewhere that you

1471
01:13:29,040 --> 01:13:31,360
can run all right if you're on linux run

1472
01:13:31,360 --> 01:13:33,840
the command as is so since i'm on mac

1473
01:13:33,840 --> 01:13:35,199
and that's pretty much

1474
01:13:35,199 --> 01:13:37,120
linux in disguise

1475
01:13:37,120 --> 01:13:39,280
i'm going to go to our nice

1476
01:13:39,280 --> 01:13:41,120
folder that we created

1477
01:13:41,120 --> 01:13:42,159
um

1478
01:13:42,159 --> 01:13:44,640
i try to be training and download the

1479
01:13:44,640 --> 01:13:45,679
script

1480
01:13:45,679 --> 01:13:47,760
right and i downloaded the start display

1481
01:13:47,760 --> 01:13:50,719
dot dot pi i'm gonna just make it chmod

1482
01:13:50,719 --> 01:13:53,040
plus

1483
01:13:53,760 --> 01:13:55,120
all right just so that it's it's

1484
01:13:55,120 --> 01:13:57,679
executable

1485
01:13:57,679 --> 01:14:00,480
and now we have to start

1486
01:14:00,480 --> 01:14:03,440
the exploit okay we can start sploit and

1487
01:14:03,440 --> 01:14:04,320
we're going to take a look at the

1488
01:14:04,320 --> 01:14:05,600
arguments

1489
01:14:05,600 --> 01:14:09,040
okay let's look at the arguments here

1490
01:14:09,040 --> 01:14:11,040
so what are these arguments

1491
01:14:11,040 --> 01:14:12,840
so you can see here that we're running

1492
01:14:12,840 --> 01:14:14,800
startsploit.5 okay that's our

1493
01:14:14,800 --> 01:14:16,640
destructive farm client

1494
01:14:16,640 --> 01:14:18,880
we're giving it as an argument

1495
01:14:18,880 --> 01:14:22,480
the exploit this is the exploit file so

1496
01:14:22,480 --> 01:14:24,080
this is the exploit we're going to run

1497
01:14:24,080 --> 01:14:25,840
in this case i called it exploit.pi but

1498
01:14:25,840 --> 01:14:27,840
i'm actually going to pass the full path

1499
01:14:27,840 --> 01:14:29,920
to my python exploit

1500
01:14:29,920 --> 01:14:33,040
server url is where the

1501
01:14:33,040 --> 01:14:35,600
where the destructive farm server is

1502
01:14:35,600 --> 01:14:39,520
okay so in my case it's dot 100 okay so

1503
01:14:39,520 --> 01:14:41,280
you got to point this towards your

1504
01:14:41,280 --> 01:14:44,080
destructive farm server

1505
01:14:44,080 --> 01:14:45,199
and

1506
01:14:45,199 --> 01:14:46,560
in my case

1507
01:14:46,560 --> 01:14:48,480
an alias is what you want to call this

1508
01:14:48,480 --> 01:14:50,400
exploit what is this exploit i'm running

1509
01:14:50,400 --> 01:14:52,400
right now so let's let's fill this out

1510
01:14:52,400 --> 01:14:54,000
what do i mean by this

1511
01:14:54,000 --> 01:14:57,120
so where is my exploit my exploit is in

1512
01:14:57,120 --> 01:14:58,719
workspace

1513
01:14:58,719 --> 01:15:01,520
ctf training

1514
01:15:01,520 --> 01:15:06,080
services nasarasa exploit db exploit.pi

1515
01:15:06,080 --> 01:15:08,080
that's the full path and the alias what

1516
01:15:08,080 --> 01:15:09,920
do i want to call this exploit i want to

1517
01:15:09,920 --> 01:15:11,679
call this nasa

1518
01:15:11,679 --> 01:15:14,960
rasa underscore mysql that is the name

1519
01:15:14,960 --> 01:15:19,040
of the exploit and i hit enter

1520
01:15:19,440 --> 01:15:21,600
okay so this the dash dash is weird

1521
01:15:21,600 --> 01:15:22,719
there we go

1522
01:15:22,719 --> 01:15:24,320
and it's connected and all of a sudden

1523
01:15:24,320 --> 01:15:26,560
you see you get this wild output and

1524
01:15:26,560 --> 01:15:29,600
what it's doing is that it's looping my

1525
01:15:29,600 --> 01:15:32,000
exploit script immediately across all

1526
01:15:32,000 --> 01:15:34,400
the teams immediately stealing all their

1527
01:15:34,400 --> 01:15:35,760
flags

1528
01:15:35,760 --> 01:15:37,520
and sending them

1529
01:15:37,520 --> 01:15:40,080
right now to my destructive farm client

1530
01:15:40,080 --> 01:15:42,320
so i refresh i see that all of a sudden

1531
01:15:42,320 --> 01:15:43,520
i got all this

1532
01:15:43,520 --> 01:15:46,320
i got all these flags stolen from so

1533
01:15:46,320 --> 01:15:48,080
many different teams some of them are

1534
01:15:48,080 --> 01:15:50,159
queued so you can see that destructive

1535
01:15:50,159 --> 01:15:52,960
farm is waiting for a couple of more

1536
01:15:52,960 --> 01:15:55,679
seconds before it sends more flags

1537
01:15:55,679 --> 01:15:57,280
and you go to the scoreboard you're

1538
01:15:57,280 --> 01:15:58,880
gonna see i should be flying higher

1539
01:15:58,880 --> 01:16:01,440
right now

1540
01:16:01,679 --> 01:16:06,280
let's go where is org one

1541
01:16:09,760 --> 01:16:11,679
orgs1 why didn't it update yet i'm

1542
01:16:11,679 --> 01:16:13,520
pretty sure i stole more than one flag

1543
01:16:13,520 --> 01:16:15,440
trust me i think we just have to wait

1544
01:16:15,440 --> 01:16:18,719
for the check system to kick in

1545
01:16:19,679 --> 01:16:21,360
come on check system

1546
01:16:21,360 --> 01:16:25,199
i stole more than one flag i promise

1547
01:16:26,560 --> 01:16:28,560
i will wait for it to wake up there we

1548
01:16:28,560 --> 01:16:30,239
go where did i go holy crap i jumped

1549
01:16:30,239 --> 01:16:33,360
four positions i immediately gained

1550
01:16:33,360 --> 01:16:35,199
7 000 points

1551
01:16:35,199 --> 01:16:37,760
from stealing 168

1552
01:16:37,760 --> 01:16:38,920
uh

1553
01:16:38,920 --> 01:16:42,560
168 flags hey ai that's all right i

1554
01:16:42,560 --> 01:16:45,040
shared the the slides earlier uh i think

1555
01:16:45,040 --> 01:16:47,199
i can copy the slides again for you

1556
01:16:47,199 --> 01:16:49,840
yes yes i can do that for you no worries

1557
01:16:49,840 --> 01:16:52,480
no worries my friend

1558
01:16:52,480 --> 01:16:54,480
here you go

1559
01:16:54,480 --> 01:16:56,480
i hope that works yeah so that's i'm

1560
01:16:56,480 --> 01:16:58,080
uploading the slides again

1561
01:16:58,080 --> 01:16:59,280
there you go

1562
01:16:59,280 --> 01:17:03,040
you can follow along catch up to us

1563
01:17:03,040 --> 01:17:05,520
no worries so as you can see right now i

1564
01:17:05,520 --> 01:17:08,080
am jumping on the scoreboard immediately

1565
01:17:08,080 --> 01:17:10,320
destructive farm is receiving all these

1566
01:17:10,320 --> 01:17:12,320
flags and i can go back to my terminal

1567
01:17:12,320 --> 01:17:14,159
and my exploits are just gonna keep

1568
01:17:14,159 --> 01:17:15,040
running

1569
01:17:15,040 --> 01:17:17,360
every 50 seconds

1570
01:17:17,360 --> 01:17:19,679
my exploits are gonna run just before

1571
01:17:19,679 --> 01:17:21,600
the new round or just near the end of

1572
01:17:21,600 --> 01:17:24,480
the of of the round and see now it's

1573
01:17:24,480 --> 01:17:26,560
launching attack number two

1574
01:17:26,560 --> 01:17:28,000
and i'm gonna

1575
01:17:28,000 --> 01:17:30,159
steal a bunch of and i'm gonna get a

1576
01:17:30,159 --> 01:17:32,000
bunch of flags all over again as it runs

1577
01:17:32,000 --> 01:17:34,960
my exploits all over again

1578
01:17:34,960 --> 01:17:35,840
okay

1579
01:17:35,840 --> 01:17:37,600
and that's that's the whole point that's

1580
01:17:37,600 --> 01:17:41,040
the beauty behind an x and exploit farm

1581
01:17:41,040 --> 01:17:42,400
all i got to do is just keep this

1582
01:17:42,400 --> 01:17:44,080
running i can forget about it i don't

1583
01:17:44,080 --> 01:17:45,760
have to worry about anything i don't

1584
01:17:45,760 --> 01:17:47,760
have to worry about no duplicate flags i

1585
01:17:47,760 --> 01:17:49,840
don't have to worry about expired flags

1586
01:17:49,840 --> 01:17:53,360
you know why because the exploit farm is

1587
01:17:53,360 --> 01:17:54,960
actually the one that submits the flags

1588
01:17:54,960 --> 01:17:56,640
to the check system so what's what's

1589
01:17:56,640 --> 01:17:59,600
going on here my client is running the

1590
01:17:59,600 --> 01:18:00,880
exploit

1591
01:18:00,880 --> 01:18:04,080
gathering all the flags and sending them

1592
01:18:04,080 --> 01:18:05,679
to

1593
01:18:05,679 --> 01:18:07,199
the

1594
01:18:07,199 --> 01:18:09,679
exploit farm the server right here the

1595
01:18:09,679 --> 01:18:12,400
server receives the flag

1596
01:18:12,400 --> 01:18:14,560
checks if it's already submitted this

1597
01:18:14,560 --> 01:18:18,000
flag before checks if this flag is valid

1598
01:18:18,000 --> 01:18:20,560
and then submits the flag

1599
01:18:20,560 --> 01:18:22,320
you see so you don't have to worry about

1600
01:18:22,320 --> 01:18:23,760
duplicate flags you don't have to worry

1601
01:18:23,760 --> 01:18:25,840
about anything the exploit farm takes

1602
01:18:25,840 --> 01:18:28,400
care of all of that for you it does all

1603
01:18:28,400 --> 01:18:29,920
that for you

1604
01:18:29,920 --> 01:18:31,840
all you got to do is just feed it flags

1605
01:18:31,840 --> 01:18:33,199
and it'll just keep

1606
01:18:33,199 --> 01:18:35,440
throwing and i can even see i can take a

1607
01:18:35,440 --> 01:18:36,880
look at the rejected flags right now

1608
01:18:36,880 --> 01:18:39,040
like i can filter show me all rejected

1609
01:18:39,040 --> 01:18:41,280
flags and i can see you know there are

1610
01:18:41,280 --> 01:18:43,199
some flags that are already submitted

1611
01:18:43,199 --> 01:18:45,040
some flags that are too old and so it

1612
01:18:45,040 --> 01:18:47,520
will remember it will remember that oh

1613
01:18:47,520 --> 01:18:49,040
these flags are too old if i get them

1614
01:18:49,040 --> 01:18:52,480
again i should never submit them again

1615
01:18:52,480 --> 01:18:54,400
and that's that again

1616
01:18:54,400 --> 01:18:57,360
i cannot emphasize how important it is

1617
01:18:57,360 --> 01:18:59,679
to have these exploit farms running if

1618
01:18:59,679 --> 01:19:01,679
you try to play an attack defense ctf

1619
01:19:01,679 --> 01:19:03,440
and you don't have an exploit farm

1620
01:19:03,440 --> 01:19:06,080
running you might as well just

1621
01:19:06,080 --> 01:19:08,000
manually keep running your exploits

1622
01:19:08,000 --> 01:19:10,000
every 60 seconds and

1623
01:19:10,000 --> 01:19:11,120
may

1624
01:19:11,120 --> 01:19:13,360
god have mercy on your soul

1625
01:19:13,360 --> 01:19:15,440
you know because it's going to take you

1626
01:19:15,440 --> 01:19:17,440
forever to try and catch up with these

1627
01:19:17,440 --> 01:19:20,400
teams who are also using exploit farms

1628
01:19:20,400 --> 01:19:21,360
all right

1629
01:19:21,360 --> 01:19:23,600
so i'm giving you guys all a second so

1630
01:19:23,600 --> 01:19:25,520
now let's talk about patching so quickly

1631
01:19:25,520 --> 01:19:26,880
people are stealing flags from each

1632
01:19:26,880 --> 01:19:28,800
other what can we do

1633
01:19:28,800 --> 01:19:31,040
well you can patch

1634
01:19:31,040 --> 01:19:32,640
how do we patch

1635
01:19:32,640 --> 01:19:34,560
well that's very simple so first before

1636
01:19:34,560 --> 01:19:36,000
we talk about patching let's talk about

1637
01:19:36,000 --> 01:19:38,480
effective exploits so when you build an

1638
01:19:38,480 --> 01:19:40,080
exploit you have to keep these questions

1639
01:19:40,080 --> 01:19:42,719
in mind can you ensure that your exploit

1640
01:19:42,719 --> 01:19:45,280
bypasses some simple fixes

1641
01:19:45,280 --> 01:19:47,920
so this this doesn't apply in this case

1642
01:19:47,920 --> 01:19:50,960
but what if there is some sql injection

1643
01:19:50,960 --> 01:19:53,520
bug and you wrote an exploit for it and

1644
01:19:53,520 --> 01:19:55,440
you notice that some teams

1645
01:19:55,440 --> 01:19:58,640
are simply filtering the word select or

1646
01:19:58,640 --> 01:20:00,080
union

1647
01:20:00,080 --> 01:20:01,600
from the payloads

1648
01:20:01,600 --> 01:20:03,840
you should make sure that your exploit

1649
01:20:03,840 --> 01:20:06,719
bypasses all these simple fixes

1650
01:20:06,719 --> 01:20:09,440
encode it and hex encode it in base 64

1651
01:20:09,440 --> 01:20:11,840
change spaces to comments all that good

1652
01:20:11,840 --> 01:20:14,560
stuff pretend like you're evading

1653
01:20:14,560 --> 01:20:17,040
a web application firewall make your

1654
01:20:17,040 --> 01:20:19,920
exploit as

1655
01:20:19,920 --> 01:20:22,960
complex as possible encode it many times

1656
01:20:22,960 --> 01:20:25,120
if you have to so that you can make sure

1657
01:20:25,120 --> 01:20:27,280
that the only way a team

1658
01:20:27,280 --> 01:20:29,760
can stop your exploit from running is

1659
01:20:29,760 --> 01:20:32,239
that if they actually actually fix the

1660
01:20:32,239 --> 01:20:35,199
core cause of the exploit okay

1661
01:20:35,199 --> 01:20:37,440
second very important

1662
01:20:37,440 --> 01:20:39,280
how can you ensure that your exploit

1663
01:20:39,280 --> 01:20:42,719
isn't wasting time on broken surfaces

1664
01:20:42,719 --> 01:20:44,480
what if a service is just dead it's not

1665
01:20:44,480 --> 01:20:46,159
responding you don't want your script to

1666
01:20:46,159 --> 01:20:49,199
stay there for 60 seconds hung up

1667
01:20:49,199 --> 01:20:51,440
hoping that that you know it's just

1668
01:20:51,440 --> 01:20:52,639
wasting your time or you could be

1669
01:20:52,639 --> 01:20:54,480
attacking other teams

1670
01:20:54,480 --> 01:20:56,560
and how can you optimize your exploit to

1671
01:20:56,560 --> 01:20:59,600
run as fast as possible time time time

1672
01:20:59,600 --> 01:21:00,960
is important

1673
01:21:00,960 --> 01:21:03,280
okay trust me you do not want an exploit

1674
01:21:03,280 --> 01:21:05,440
that takes five minutes to run you gotta

1675
01:21:05,440 --> 01:21:06,960
keep keep trying to squeeze every

1676
01:21:06,960 --> 01:21:08,239
millisecond

1677
01:21:08,239 --> 01:21:10,400
right you don't have to worry too much

1678
01:21:10,400 --> 01:21:12,400
because the flags again expire in 15

1679
01:21:12,400 --> 01:21:14,000
minutes you have 15 minutes to grab the

1680
01:21:14,000 --> 01:21:17,120
flag but you don't want to waste time

1681
01:21:17,120 --> 01:21:20,320
okay you don't want to waste time

1682
01:21:20,960 --> 01:21:23,440
all right let's come here so how can you

1683
01:21:23,440 --> 01:21:25,360
guys protect yourselves so a lot of you

1684
01:21:25,360 --> 01:21:27,840
guys are like oh my god my flags are

1685
01:21:27,840 --> 01:21:29,679
disappearing out of thin air what can i

1686
01:21:29,679 --> 01:21:30,480
do

1687
01:21:30,480 --> 01:21:32,320
all right very simple i'll tell you what

1688
01:21:32,320 --> 01:21:35,280
you can do let's talk about patching

1689
01:21:35,280 --> 01:21:37,760
so we can either prevent the database

1690
01:21:37,760 --> 01:21:40,400
from being exposed to all players

1691
01:21:40,400 --> 01:21:42,080
or we can change the password to the

1692
01:21:42,080 --> 01:21:45,040
database or both

1693
01:21:45,040 --> 01:21:46,000
all right

1694
01:21:46,000 --> 01:21:47,679
so the database doesn't need to be

1695
01:21:47,679 --> 01:21:49,920
exposed everybody knows the number one

1696
01:21:49,920 --> 01:21:51,679
rule of databases is you never expose

1697
01:21:51,679 --> 01:21:54,080
them to the internet let's change that

1698
01:21:54,080 --> 01:21:56,480
all right so let's go into our nasa rasa

1699
01:21:56,480 --> 01:21:57,440
service

1700
01:21:57,440 --> 01:22:00,320
let's look at the docker compose file

1701
01:22:00,320 --> 01:22:01,199
okay

1702
01:22:01,199 --> 01:22:02,800
you see this ports

1703
01:22:02,800 --> 01:22:04,639
this ports right here

1704
01:22:04,639 --> 01:22:06,239
what does this mean

1705
01:22:06,239 --> 01:22:09,600
this means that it's taking

1706
01:22:09,600 --> 01:22:13,440
port 3306 inside the container

1707
01:22:13,440 --> 01:22:14,639
okay

1708
01:22:14,639 --> 01:22:17,520
and it's forwarding it

1709
01:22:17,520 --> 01:22:20,560
to port 3306

1710
01:22:20,560 --> 01:22:22,800
on the host

1711
01:22:22,800 --> 01:22:25,600
but if you don't explicitly

1712
01:22:25,600 --> 01:22:28,320
specify what ip address to listen on it

1713
01:22:28,320 --> 01:22:30,320
will listen on zero zero zero zero which

1714
01:22:30,320 --> 01:22:32,480
is exposed so we can simply tell our

1715
01:22:32,480 --> 01:22:34,960
database hey why don't you listen

1716
01:22:34,960 --> 01:22:38,719
on localhost instead okay

1717
01:22:38,719 --> 01:22:40,320
still keep the same username and

1718
01:22:40,320 --> 01:22:41,920
password if you want to nobody will ever

1719
01:22:41,920 --> 01:22:44,239
be able to touch it anyway so why bother

1720
01:22:44,239 --> 01:22:46,239
just make it listen locally

1721
01:22:46,239 --> 01:22:48,400
all right and i gotta check if this

1722
01:22:48,400 --> 01:22:49,760
actually works

1723
01:22:49,760 --> 01:22:52,880
so let me make sure so i'm going to say

1724
01:22:52,880 --> 01:22:55,280
again build

1725
01:22:55,280 --> 01:22:58,480
force recreate

1726
01:22:58,560 --> 01:23:01,360
and dash d

1727
01:23:02,000 --> 01:23:04,159
mysql

1728
01:23:04,159 --> 01:23:05,920
okay it's not called mysql it's called

1729
01:23:05,920 --> 01:23:08,960
something else but here we go

1730
01:23:10,719 --> 01:23:13,520
and i do docker ps

1731
01:23:13,520 --> 01:23:16,560
and you see mysql

1732
01:23:17,120 --> 01:23:21,360
mysql it says here that port 3306 is

1733
01:23:21,360 --> 01:23:24,400
forwarded but locally if you guys try to

1734
01:23:24,400 --> 01:23:26,159
log in i want you guys to try and log in

1735
01:23:26,159 --> 01:23:29,040
now you guys know the mysql command

1736
01:23:29,040 --> 01:23:31,520
i'll send it over

1737
01:23:31,520 --> 01:23:33,120
see if you can

1738
01:23:33,120 --> 01:23:34,800
see if you can

1739
01:23:34,800 --> 01:23:36,639
log into my database

1740
01:23:36,639 --> 01:23:38,960
okay so i'll give you team three like

1741
01:23:38,960 --> 01:23:39,920
this

1742
01:23:39,920 --> 01:23:42,159
there you go and run this

1743
01:23:42,159 --> 01:23:44,159
this is you attempting to connect to my

1744
01:23:44,159 --> 01:23:47,879
database right now

1745
01:23:48,000 --> 01:23:49,679
you can try

1746
01:23:49,679 --> 01:23:52,560
but you shouldn't be able to

1747
01:23:52,560 --> 01:23:53,679
it'll just tell you that you can't

1748
01:23:53,679 --> 01:23:56,639
connect the ip address the port is not

1749
01:23:56,639 --> 01:23:58,880
open

1750
01:24:00,480 --> 01:24:02,639
am i right so

1751
01:24:02,639 --> 01:24:03,520
tell me

1752
01:24:03,520 --> 01:24:04,880
can you guys connect or you can't

1753
01:24:04,880 --> 01:24:06,000
connect

1754
01:24:06,000 --> 01:24:08,719
tell me in the chat

1755
01:24:11,520 --> 01:24:12,880
you can't connect

1756
01:24:12,880 --> 01:24:14,560
and that's and that's and that's one

1757
01:24:14,560 --> 01:24:16,560
thing we just solved the database from

1758
01:24:16,560 --> 01:24:19,520
being exposed that's a simple line all i

1759
01:24:19,520 --> 01:24:21,120
did was change the docker composer and

1760
01:24:21,120 --> 01:24:23,440
you can see all i did was add this extra

1761
01:24:23,440 --> 01:24:26,480
line i made it explicitly listen on

1762
01:24:26,480 --> 01:24:29,280
localhost which means my service my

1763
01:24:29,280 --> 01:24:31,360
service can still access

1764
01:24:31,360 --> 01:24:33,920
so nasa so the php service can still

1765
01:24:33,920 --> 01:24:35,920
access my database

1766
01:24:35,920 --> 01:24:37,760
but they can't

1767
01:24:37,760 --> 01:24:40,000
other teams can't access my database so

1768
01:24:40,000 --> 01:24:42,400
now people are i'm essentially i patched

1769
01:24:42,400 --> 01:24:44,239
myself and i'm going to stop losing

1770
01:24:44,239 --> 01:24:45,679
flags

1771
01:24:45,679 --> 01:24:47,600
all right so i'm expecting all of you

1772
01:24:47,600 --> 01:24:48,800
are going to start doing that really

1773
01:24:48,800 --> 01:24:50,320
soon and it's going to be almost

1774
01:24:50,320 --> 01:24:51,679
impossible to

1775
01:24:51,679 --> 01:24:54,080
steal flags from other people

1776
01:24:54,080 --> 01:24:55,920
regarding this specific vulnerability

1777
01:24:55,920 --> 01:24:57,440
and that's that's more than fine that

1778
01:24:57,440 --> 01:24:59,520
that's how the game works

1779
01:24:59,520 --> 01:25:00,480
right

1780
01:25:00,480 --> 01:25:02,080
and let's say you want to change the

1781
01:25:02,080 --> 01:25:03,679
password let's say you want to change

1782
01:25:03,679 --> 01:25:05,520
the password right just for the sake of

1783
01:25:05,520 --> 01:25:07,760
security if you do change the password

1784
01:25:07,760 --> 01:25:09,199
you're going to have to remember you

1785
01:25:09,199 --> 01:25:10,719
have to change the password somewhere in

1786
01:25:10,719 --> 01:25:13,280
the code so if we look at the code

1787
01:25:13,280 --> 01:25:15,030
let's say let's go to

1788
01:25:15,030 --> 01:25:16,719
[Music]

1789
01:25:16,719 --> 01:25:17,920
inc

1790
01:25:17,920 --> 01:25:20,199
you see there's a db.php there's a

1791
01:25:20,199 --> 01:25:22,639
database.php right here

1792
01:25:22,639 --> 01:25:24,639
and so this database of php again the

1793
01:25:24,639 --> 01:25:27,199
credentials are in are in the code so

1794
01:25:27,199 --> 01:25:29,679
whatever password you change outside you

1795
01:25:29,679 --> 01:25:31,600
have to change the database

1796
01:25:31,600 --> 01:25:33,679
credentials right here

1797
01:25:33,679 --> 01:25:35,840
okay just to make sure that my service

1798
01:25:35,840 --> 01:25:37,440
is running fine that nasa rasa is not

1799
01:25:37,440 --> 01:25:39,280
complaining i'm gonna actually go to

1800
01:25:39,280 --> 01:25:40,960
nasa right here

1801
01:25:40,960 --> 01:25:43,120
and check that it can actually access my

1802
01:25:43,120 --> 01:25:45,600
mysql database and again i get no errors

1803
01:25:45,600 --> 01:25:49,520
everything's working just fine

1804
01:25:51,120 --> 01:25:54,120
right

1805
01:25:55,840 --> 01:25:57,440
and so that's that's one that's one

1806
01:25:57,440 --> 01:26:00,800
vulnerability we just patched right now

1807
01:26:00,800 --> 01:26:02,239
if you change the password or host the

1808
01:26:02,239 --> 01:26:03,600
database locally is that the legal way

1809
01:26:03,600 --> 01:26:04,800
to patch

1810
01:26:04,800 --> 01:26:05,920
yes

1811
01:26:05,920 --> 01:26:06,639
so

1812
01:26:06,639 --> 01:26:08,800
that you you you are allowed to patch

1813
01:26:08,800 --> 01:26:11,600
any way that you want okay that's that's

1814
01:26:11,600 --> 01:26:13,040
fine it's fine you joined a little bit

1815
01:26:13,040 --> 01:26:15,360
late you you are allowed to to patch it

1816
01:26:15,360 --> 01:26:17,280
like that change the password and host

1817
01:26:17,280 --> 01:26:19,280
it locally that's more than fine

1818
01:26:19,280 --> 01:26:21,440
again why are we changing it to locally

1819
01:26:21,440 --> 01:26:23,440
because the check system the check

1820
01:26:23,440 --> 01:26:24,560
system

1821
01:26:24,560 --> 01:26:27,440
never almost rarely cares about your

1822
01:26:27,440 --> 01:26:28,800
exposed database so you're going to

1823
01:26:28,800 --> 01:26:31,120
notice i'm not losing sla why am i not

1824
01:26:31,120 --> 01:26:33,520
losing sla because

1825
01:26:33,520 --> 01:26:34,800
well

1826
01:26:34,800 --> 01:26:36,880
because the jack system doesn't care

1827
01:26:36,880 --> 01:26:38,560
it's not about the database it's about

1828
01:26:38,560 --> 01:26:40,000
the service

1829
01:26:40,000 --> 01:26:42,320
okay now let's say let's say that for

1830
01:26:42,320 --> 01:26:44,719
some reason the check system is actually

1831
01:26:44,719 --> 01:26:47,040
checking whether your database is up for

1832
01:26:47,040 --> 01:26:48,880
some reason

1833
01:26:48,880 --> 01:26:51,600
okay in that case

1834
01:26:51,600 --> 01:26:53,360
don't make it listen locally just change

1835
01:26:53,360 --> 01:26:55,679
the password and you're that's more than

1836
01:26:55,679 --> 01:26:58,000
fine you're allowed to do that it's even

1837
01:26:58,000 --> 01:27:00,719
better to change the password and leave

1838
01:27:00,719 --> 01:27:02,880
the service open because that might

1839
01:27:02,880 --> 01:27:05,360
waste time in other teams trying to

1840
01:27:05,360 --> 01:27:06,480
connect to your server because they

1841
01:27:06,480 --> 01:27:08,560
actually have to connect and negotiate

1842
01:27:08,560 --> 01:27:10,159
and be like he's using my password oh

1843
01:27:10,159 --> 01:27:11,760
that's incorrect which is a few

1844
01:27:11,760 --> 01:27:13,199
milliseconds

1845
01:27:13,199 --> 01:27:16,159
a few milliseconds slower than getting

1846
01:27:16,159 --> 01:27:17,679
an error

1847
01:27:17,679 --> 01:27:20,400
that the port is just closed

1848
01:27:20,400 --> 01:27:21,280
yeah

1849
01:27:21,280 --> 01:27:24,639
so you got to think about it like that

1850
01:27:25,920 --> 01:27:27,600
will there be multiple vulnerabilities

1851
01:27:27,600 --> 01:27:30,800
like more than three on the application

1852
01:27:30,800 --> 01:27:31,679
well

1853
01:27:31,679 --> 01:27:33,600
that's pretty much up to the service

1854
01:27:33,600 --> 01:27:35,040
sometimes there are unintended

1855
01:27:35,040 --> 01:27:36,880
vulnerabilities sometimes you can patch

1856
01:27:36,880 --> 01:27:38,320
a vulnerability and introduce another

1857
01:27:38,320 --> 01:27:41,199
one sometimes you can

1858
01:27:41,199 --> 01:27:43,120
sometimes the database is exposed and

1859
01:27:43,120 --> 01:27:44,800
there's just one more vulnerability

1860
01:27:44,800 --> 01:27:46,800
apart from that it's really up to the

1861
01:27:46,800 --> 01:27:48,880
service it could be anything

1862
01:27:48,880 --> 01:27:50,880
you just have to keep looking keep

1863
01:27:50,880 --> 01:27:52,719
stealing exploits from other teams keep

1864
01:27:52,719 --> 01:27:55,040
an eye on what's being exploited keep an

1865
01:27:55,040 --> 01:27:57,199
eye on what's happening and

1866
01:27:57,199 --> 01:28:01,520
you'll you'll you'll be able to find out

1867
01:28:01,520 --> 01:28:02,719
so

1868
01:28:02,719 --> 01:28:05,280
moving on so we finally we finally

1869
01:28:05,280 --> 01:28:07,040
exploited our first service and we

1870
01:28:07,040 --> 01:28:08,800
finally patched our first service but

1871
01:28:08,800 --> 01:28:09,840
guess what

1872
01:28:09,840 --> 01:28:11,360
there's another vulnerability in

1873
01:28:11,360 --> 01:28:15,120
nasarasa we're not done yet we are more

1874
01:28:15,120 --> 01:28:17,280
than done i mean not more than done

1875
01:28:17,280 --> 01:28:19,600
we're not done yet

1876
01:28:19,600 --> 01:28:21,600
okay we have a long way to go

1877
01:28:21,600 --> 01:28:24,320
right there's an actual vulnerability in

1878
01:28:24,320 --> 01:28:25,840
nasarasa

1879
01:28:25,840 --> 01:28:28,320
and let's talk about that so looking

1880
01:28:28,320 --> 01:28:29,280
again

1881
01:28:29,280 --> 01:28:30,560
look again

1882
01:28:30,560 --> 01:28:31,639
again at the

1883
01:28:31,639 --> 01:28:34,320
dockercompose.yml and db.php

1884
01:28:34,320 --> 01:28:35,760
is there anything that catches your

1885
01:28:35,760 --> 01:28:36,880
attention

1886
01:28:36,880 --> 01:28:40,080
well let's go let's take a look

1887
01:28:40,080 --> 01:28:42,560
i want you guys to take a look and tell

1888
01:28:42,560 --> 01:28:44,960
me does anything catch your eye is there

1889
01:28:44,960 --> 01:28:47,360
any specific settings that are being

1890
01:28:47,360 --> 01:28:49,360
enforced

1891
01:28:49,360 --> 01:28:51,840
that usually don't that you usually

1892
01:28:51,840 --> 01:28:53,600
don't see when you're just trying to set

1893
01:28:53,600 --> 01:28:56,920
up a database

1894
01:29:00,000 --> 01:29:01,840
there's no wrong answers you guys can

1895
01:29:01,840 --> 01:29:05,120
keep asking that's fine

1896
01:29:05,120 --> 01:29:06,320
keep guessing

1897
01:29:06,320 --> 01:29:08,239
just tell me in the chat do you see

1898
01:29:08,239 --> 01:29:10,080
anything anything catches your eye

1899
01:29:10,080 --> 01:29:11,120
something that

1900
01:29:11,120 --> 01:29:12,480
that

1901
01:29:12,480 --> 01:29:13,920
okay root password so what are they

1902
01:29:13,920 --> 01:29:15,600
doing with the root password so the root

1903
01:29:15,600 --> 01:29:17,360
password they're just setting an

1904
01:29:17,360 --> 01:29:19,360
environment variable here random root

1905
01:29:19,360 --> 01:29:21,600
password they're sending it to yes

1906
01:29:21,600 --> 01:29:23,600
and if you go look at the documentation

1907
01:29:23,600 --> 01:29:25,440
for docker mysql

1908
01:29:25,440 --> 01:29:27,679
you'll see that this just randomizes the

1909
01:29:27,679 --> 01:29:30,639
root password every boot so that's fine

1910
01:29:30,639 --> 01:29:32,800
that's okay but good job you paid

1911
01:29:32,800 --> 01:29:35,199
attention to something all right what

1912
01:29:35,199 --> 01:29:36,960
else

1913
01:29:36,960 --> 01:29:39,600
are there any specific options

1914
01:29:39,600 --> 01:29:41,679
that they're setting any any specific

1915
01:29:41,679 --> 01:29:45,280
options that they're overriding

1916
01:29:45,440 --> 01:29:47,120
i'll give you a hint it's not in that

1917
01:29:47,120 --> 01:29:50,480
it's not in the nasa www at all it's

1918
01:29:50,480 --> 01:29:54,159
it's here it's right here

1919
01:29:54,159 --> 01:29:57,199
more importantly it's right

1920
01:29:57,199 --> 01:29:59,519
here

1921
01:30:00,080 --> 01:30:01,199
yes

1922
01:30:01,199 --> 01:30:03,120
so something in the command they're

1923
01:30:03,120 --> 01:30:05,679
enforcing a specific character set

1924
01:30:05,679 --> 01:30:07,280
okay i know you can't see the full

1925
01:30:07,280 --> 01:30:09,199
command but the the last part doesn't

1926
01:30:09,199 --> 01:30:11,120
really matter the the

1927
01:30:11,120 --> 01:30:13,360
skip character client handshake that

1928
01:30:13,360 --> 01:30:15,199
doesn't really matter it's this part

1929
01:30:15,199 --> 01:30:17,120
right here so they are setting a

1930
01:30:17,120 --> 01:30:19,520
specific character set

1931
01:30:19,520 --> 01:30:21,360
and you might not be familiar with this

1932
01:30:21,360 --> 01:30:23,199
that's fine you're like okay maybe this

1933
01:30:23,199 --> 01:30:24,560
is hard to catch how am i supposed to

1934
01:30:24,560 --> 01:30:26,080
understand that

1935
01:30:26,080 --> 01:30:27,360
how am i supposed to catch that but you

1936
01:30:27,360 --> 01:30:28,719
should always google everything and

1937
01:30:28,719 --> 01:30:30,080
you're about to learn about the very

1938
01:30:30,080 --> 01:30:32,159
interesting vulnerability that you can

1939
01:30:32,159 --> 01:30:34,800
have in mysql if you pick the wrong

1940
01:30:34,800 --> 01:30:36,239
characters at that

1941
01:30:36,239 --> 01:30:37,120
okay

1942
01:30:37,120 --> 01:30:39,679
so there is a vulnerability that exists

1943
01:30:39,679 --> 01:30:41,679
in mysql

1944
01:30:41,679 --> 01:30:43,360
well it's not exactly a vulnerability

1945
01:30:43,360 --> 01:30:46,000
it's kind of a logic bug and you have to

1946
01:30:46,000 --> 01:30:48,000
it's not available by default it's only

1947
01:30:48,000 --> 01:30:50,320
when you pick a specific character set

1948
01:30:50,320 --> 01:30:53,520
so you can change the character set

1949
01:30:53,520 --> 01:30:56,159
okay that the database is using

1950
01:30:56,159 --> 01:30:57,360
all right you want the database to use a

1951
01:30:57,360 --> 01:30:59,360
different character set and we are

1952
01:30:59,360 --> 01:31:01,440
enforcing a character set right now

1953
01:31:01,440 --> 01:31:06,000
called utf-8 mb4 unicode ci

1954
01:31:06,000 --> 01:31:07,920
all right and if we google if we google

1955
01:31:07,920 --> 01:31:10,159
this

1956
01:31:11,679 --> 01:31:14,000
so let's learn like

1957
01:31:14,000 --> 01:31:15,360
is there anything is there anything

1958
01:31:15,360 --> 01:31:17,360
happening here and you can read and you

1959
01:31:17,360 --> 01:31:19,679
can try to understand what's happening

1960
01:31:19,679 --> 01:31:20,719
okay

1961
01:31:20,719 --> 01:31:22,400
but for now let's look let's look for

1962
01:31:22,400 --> 01:31:28,360
the actual mysql reference okay from

1963
01:31:30,000 --> 01:31:32,960
let's try to control f and look for our

1964
01:31:32,960 --> 01:31:34,560
so we see right here

1965
01:31:34,560 --> 01:31:36,159
that

1966
01:31:36,159 --> 01:31:39,760
there is an attribute called pad space

1967
01:31:39,760 --> 01:31:42,800
and other versions other other character

1968
01:31:42,800 --> 01:31:45,840
sets don't have this pad space

1969
01:31:45,840 --> 01:31:48,080
attribute you can even try to set up

1970
01:31:48,080 --> 01:31:50,080
your own mysql database through docker

1971
01:31:50,080 --> 01:31:52,159
you'll realize that they don't set

1972
01:31:52,159 --> 01:31:54,960
pad space by default now what does pad

1973
01:31:54,960 --> 01:31:57,120
space mean well

1974
01:31:57,120 --> 01:31:59,360
its results can can can be very

1975
01:31:59,360 --> 01:32:01,360
catastrophic especially when trying to

1976
01:32:01,360 --> 01:32:02,960
do authentication

1977
01:32:02,960 --> 01:32:05,040
let me log into my own database

1978
01:32:05,040 --> 01:32:06,159
all right

1979
01:32:06,159 --> 01:32:07,840
so i can log in with my to my own

1980
01:32:07,840 --> 01:32:09,120
database

1981
01:32:09,120 --> 01:32:11,440
uh with the same credentials okay

1982
01:32:11,440 --> 01:32:13,040
because again i don't i didn't change

1983
01:32:13,040 --> 01:32:14,639
the credentials i only made it listen

1984
01:32:14,639 --> 01:32:15,679
locally

1985
01:32:15,679 --> 01:32:17,920
here i am

1986
01:32:17,920 --> 01:32:22,480
so in sql if you do select hello

1987
01:32:22,480 --> 01:32:24,480
okay equals

1988
01:32:24,480 --> 01:32:26,880
hello

1989
01:32:26,880 --> 01:32:28,320
what do you think the output of this is

1990
01:32:28,320 --> 01:32:32,559
this true or false in sql

1991
01:32:35,679 --> 01:32:37,920
it's true yeah hello is equal to hello

1992
01:32:37,920 --> 01:32:40,800
one you get a one hello is hello that's

1993
01:32:40,800 --> 01:32:43,440
correct now what about this

1994
01:32:43,440 --> 01:32:48,320
hello equal to hello space

1995
01:32:49,280 --> 01:32:51,760
in any other programming language hello

1996
01:32:51,760 --> 01:32:56,639
equals hello space would give you false

1997
01:32:56,639 --> 01:32:59,679
right because it's not the same however

1998
01:32:59,679 --> 01:33:02,239
because of the specific character set

1999
01:33:02,239 --> 01:33:04,639
that we're using and it has an attribute

2000
01:33:04,639 --> 01:33:07,600
called pad space when you run this you

2001
01:33:07,600 --> 01:33:09,520
get true

2002
01:33:09,520 --> 01:33:11,360
can you imagine what that leads to

2003
01:33:11,360 --> 01:33:13,600
imagine the following statement select

2004
01:33:13,600 --> 01:33:15,679
star from users

2005
01:33:15,679 --> 01:33:16,800
where

2006
01:33:16,800 --> 01:33:18,960
and then

2007
01:33:18,960 --> 01:33:21,360
username equals

2008
01:33:21,360 --> 01:33:24,159
admin space

2009
01:33:24,159 --> 01:33:27,040
you can now using this you can now log

2010
01:33:27,040 --> 01:33:30,320
in as other users because mysql thanks

2011
01:33:30,320 --> 01:33:32,239
to the pad space attribute it will

2012
01:33:32,239 --> 01:33:35,120
ignore you can add so many spaces here

2013
01:33:35,120 --> 01:33:36,960
you'll still get one

2014
01:33:36,960 --> 01:33:38,800
do these two strings look the same to

2015
01:33:38,800 --> 01:33:41,600
you they don't look remotely the same

2016
01:33:41,600 --> 01:33:43,760
hello equals and then hello in a million

2017
01:33:43,760 --> 01:33:46,880
spaces but because of pad space it

2018
01:33:46,880 --> 01:33:48,159
ignores

2019
01:33:48,159 --> 01:33:50,960
white space it ignores trailing white

2020
01:33:50,960 --> 01:33:54,080
space when doing comparisons

2021
01:33:54,080 --> 01:33:57,120
and that is the main vulnerability

2022
01:33:57,120 --> 01:33:59,520
inside of nasa rasa how does that

2023
01:33:59,520 --> 01:34:01,040
vulnerability work why is that a

2024
01:34:01,040 --> 01:34:03,440
vulnerability i can show you right now

2025
01:34:03,440 --> 01:34:06,080
let's go to my own service all right i'm

2026
01:34:06,080 --> 01:34:07,440
going to go to my own so this is my own

2027
01:34:07,440 --> 01:34:09,280
nasa asset service and i'm going to go

2028
01:34:09,280 --> 01:34:10,800
to the users

2029
01:34:10,800 --> 01:34:12,400
and i can see that the check system here

2030
01:34:12,400 --> 01:34:13,360
is

2031
01:34:13,360 --> 01:34:15,600
is has inserted let's go to this user

2032
01:34:15,600 --> 01:34:17,120
because we know this user was created by

2033
01:34:17,120 --> 01:34:18,480
the check system

2034
01:34:18,480 --> 01:34:21,440
this user signed up with this username

2035
01:34:21,440 --> 01:34:23,440
i'm going to take their username

2036
01:34:23,440 --> 01:34:24,400
okay

2037
01:34:24,400 --> 01:34:25,600
and i'm going to sign up i'm going to

2038
01:34:25,600 --> 01:34:27,920
make a new username same first name same

2039
01:34:27,920 --> 01:34:30,080
last name and the username i'm going to

2040
01:34:30,080 --> 01:34:31,440
add a space

2041
01:34:31,440 --> 01:34:32,719
at the end of the username i'm actually

2042
01:34:32,719 --> 01:34:34,560
going to add two spaces for goodmeasure

2043
01:34:34,560 --> 01:34:36,239
and the password is just the same

2044
01:34:36,239 --> 01:34:38,480
username and i'm going to sign up

2045
01:34:38,480 --> 01:34:40,960
when i click on my username

2046
01:34:40,960 --> 01:34:44,080
the database gets confused it thinks

2047
01:34:44,080 --> 01:34:45,280
that i

2048
01:34:45,280 --> 01:34:47,520
am the same username that the check

2049
01:34:47,520 --> 01:34:49,280
system placed in and i can see here

2050
01:34:49,280 --> 01:34:52,159
message visible only to you and i get

2051
01:34:52,159 --> 01:34:53,360
the flag

2052
01:34:53,360 --> 01:34:55,840
thanks to pad space and this this this

2053
01:34:55,840 --> 01:34:57,760
is this is vulnerability is known as pad

2054
01:34:57,760 --> 01:34:59,440
space collation

2055
01:34:59,440 --> 01:35:02,480
right i'll type in the chat add space

2056
01:35:02,480 --> 01:35:03,679
collision

2057
01:35:03,679 --> 01:35:06,400
all right because of the character set

2058
01:35:06,400 --> 01:35:10,239
that i'm using in mysql i can now bypass

2059
01:35:10,239 --> 01:35:12,320
authentication because i can simply sign

2060
01:35:12,320 --> 01:35:14,480
up with the username that has the same

2061
01:35:14,480 --> 01:35:16,239
username as the user that i want to log

2062
01:35:16,239 --> 01:35:19,280
in as and add so many spaces to the end

2063
01:35:19,280 --> 01:35:20,639
and then just log in

2064
01:35:20,639 --> 01:35:23,040
and when the database comes to show me

2065
01:35:23,040 --> 01:35:25,520
information it will get confused it will

2066
01:35:25,520 --> 01:35:26,880
think that i

2067
01:35:26,880 --> 01:35:29,920
am that original username with no spaces

2068
01:35:29,920 --> 01:35:31,280
and it's going to show me it's going to

2069
01:35:31,280 --> 01:35:33,600
give me access to their private the

2070
01:35:33,600 --> 01:35:36,880
private messages right here

2071
01:35:36,960 --> 01:35:39,040
and so that's why if you go right now to

2072
01:35:39,040 --> 01:35:40,719
users this is what these people are

2073
01:35:40,719 --> 01:35:43,600
exploiting they are creating random

2074
01:35:43,600 --> 01:35:47,520
usernames all right they are signing up

2075
01:35:47,520 --> 01:35:49,040
with the same they are signing up and

2076
01:35:49,040 --> 01:35:52,639
you'll notice look if i select this

2077
01:35:52,639 --> 01:35:54,480
oh well it won't show me but there's

2078
01:35:54,480 --> 01:35:57,040
actually a space okay there's actually a

2079
01:35:57,040 --> 01:36:00,080
space that is what the exploit is

2080
01:36:00,080 --> 01:36:03,119
taking the latest username

2081
01:36:03,119 --> 01:36:06,000
okay taking the latest username that the

2082
01:36:06,000 --> 01:36:07,760
check system placed in and we know it

2083
01:36:07,760 --> 01:36:09,600
comes in the form of like two names like

2084
01:36:09,600 --> 01:36:10,560
this

2085
01:36:10,560 --> 01:36:11,840
okay

2086
01:36:11,840 --> 01:36:14,639
and taking reading the username

2087
01:36:14,639 --> 01:36:17,840
going to going to the main page

2088
01:36:17,840 --> 01:36:20,560
creating a new user

2089
01:36:20,560 --> 01:36:23,119
while adding spaces at the end and

2090
01:36:23,119 --> 01:36:25,199
signing up and then you go to your own

2091
01:36:25,199 --> 01:36:27,119
page and you'll get the flag

2092
01:36:27,119 --> 01:36:28,800
that sounds a little bit complicated and

2093
01:36:28,800 --> 01:36:30,400
you're like wow i gotta run this every

2094
01:36:30,400 --> 01:36:33,199
second and we have a couple of issues

2095
01:36:33,199 --> 01:36:35,119
so many people are running the exploit

2096
01:36:35,119 --> 01:36:36,800
look the number of users is just it's

2097
01:36:36,800 --> 01:36:39,360
just a bunch of garbage right here

2098
01:36:39,360 --> 01:36:41,280
right how am i supposed to filter the

2099
01:36:41,280 --> 01:36:43,760
garbage from the actual from the actual

2100
01:36:43,760 --> 01:36:45,840
users and i'll tell you something even

2101
01:36:45,840 --> 01:36:47,360
sneakier i'll tell you something even

2102
01:36:47,360 --> 01:36:51,600
sneakier if we take a look at my exploit

2103
01:36:51,600 --> 01:36:52,639
okay

2104
01:36:52,639 --> 01:36:55,360
let's take a look at my exploit

2105
01:36:55,360 --> 01:36:57,520
this is my service exploit right here uh

2106
01:36:57,520 --> 01:36:59,199
i'm using a couple of important

2107
01:36:59,199 --> 01:37:01,040
libraries i'm using

2108
01:37:01,040 --> 01:37:03,119
beautiful soup which allows me to parse

2109
01:37:03,119 --> 01:37:05,600
html if you've ever done web development

2110
01:37:05,600 --> 01:37:07,360
beautiful beautiful soup is kind of like

2111
01:37:07,360 --> 01:37:08,960
jquery

2112
01:37:08,960 --> 01:37:10,400
right or

2113
01:37:10,400 --> 01:37:13,760
document dot you know get element by id

2114
01:37:13,760 --> 01:37:15,600
get element by that stuff lets you move

2115
01:37:15,600 --> 01:37:18,080
through html all right and i'm using the

2116
01:37:18,080 --> 01:37:21,360
requests library to make http requests

2117
01:37:21,360 --> 01:37:23,199
and this faker library we're going to

2118
01:37:23,199 --> 01:37:26,239
get to it so again this the script works

2119
01:37:26,239 --> 01:37:27,360
the same way

2120
01:37:27,360 --> 01:37:29,760
i got the host ip address

2121
01:37:29,760 --> 01:37:30,560
okay

2122
01:37:30,560 --> 01:37:33,040
host ip address right here

2123
01:37:33,040 --> 01:37:35,360
and i'm starting a request session so

2124
01:37:35,360 --> 01:37:37,360
any the reason why i do this is any any

2125
01:37:37,360 --> 01:37:40,080
cookies that i get or anything are saved

2126
01:37:40,080 --> 01:37:41,280
and i'm

2127
01:37:41,280 --> 01:37:43,280
going to the slash users page the first

2128
01:37:43,280 --> 01:37:45,119
thing that my code is doing is it goes

2129
01:37:45,119 --> 01:37:47,360
to the slash users page and it takes the

2130
01:37:47,360 --> 01:37:50,800
html and it feeds it into beautiful soup

2131
01:37:50,800 --> 01:37:53,520
and i look for the cla the div

2132
01:37:53,520 --> 01:37:56,560
a div with the class user how do how

2133
01:37:56,560 --> 01:37:58,480
does that look like well let's go to the

2134
01:37:58,480 --> 01:38:01,760
users page let's go to view

2135
01:38:01,760 --> 01:38:04,080
view source code i'm looking for a div

2136
01:38:04,080 --> 01:38:08,000
right here i can see this div right here

2137
01:38:08,080 --> 01:38:10,719
with class equal user

2138
01:38:10,719 --> 01:38:11,520
okay

2139
01:38:11,520 --> 01:38:13,679
that's exactly what i'm doing

2140
01:38:13,679 --> 01:38:17,760
div class user and i find all links i'm

2141
01:38:17,760 --> 01:38:19,760
trying to find all the different links

2142
01:38:19,760 --> 01:38:21,760
right here

2143
01:38:21,760 --> 01:38:24,320
so these guys slash users 1790 slash

2144
01:38:24,320 --> 01:38:26,480
users1789 slash users all that stuff i'm

2145
01:38:26,480 --> 01:38:27,920
trying to get all that

2146
01:38:27,920 --> 01:38:29,040
all right

2147
01:38:29,040 --> 01:38:31,040
now the next step

2148
01:38:31,040 --> 01:38:35,040
is that i go to that users page so my

2149
01:38:35,040 --> 01:38:36,000
script

2150
01:38:36,000 --> 01:38:37,440
starts going

2151
01:38:37,440 --> 01:38:39,440
to these links right here starts going

2152
01:38:39,440 --> 01:38:41,119
to them okay only the first one though

2153
01:38:41,119 --> 01:38:44,000
it only takes the top which is actually

2154
01:38:44,000 --> 01:38:46,880
a bad thing in my script i shouldn't

2155
01:38:46,880 --> 01:38:48,560
only take the top user because what if

2156
01:38:48,560 --> 01:38:50,239
the top user is something like in this

2157
01:38:50,239 --> 01:38:52,480
case it's not the check system the check

2158
01:38:52,480 --> 01:38:54,800
system didn't put this it's the this is

2159
01:38:54,800 --> 01:38:56,400
by another team trying to log into my

2160
01:38:56,400 --> 01:38:59,040
service right so i should actually try

2161
01:38:59,040 --> 01:39:02,480
to loop over all of the links that i get

2162
01:39:02,480 --> 01:39:05,280
okay but in any case let's just focus on

2163
01:39:05,280 --> 01:39:08,080
on this right now so

2164
01:39:08,080 --> 01:39:10,560
i try to get i look for a span with the

2165
01:39:10,560 --> 01:39:12,480
class label success

2166
01:39:12,480 --> 01:39:13,679
let's see how that looks like so let's

2167
01:39:13,679 --> 01:39:15,040
click on any of these guys let's click

2168
01:39:15,040 --> 01:39:16,159
on this guy

2169
01:39:16,159 --> 01:39:18,320
and that's a view source code let's look

2170
01:39:18,320 --> 01:39:19,840
for a span

2171
01:39:19,840 --> 01:39:22,639
right here i see here span

2172
01:39:22,639 --> 01:39:25,600
label with the class label success

2173
01:39:25,600 --> 01:39:26,400
okay

2174
01:39:26,400 --> 01:39:28,719
why do i look for this html element

2175
01:39:28,719 --> 01:39:31,440
because it contains the username look

2176
01:39:31,440 --> 01:39:33,760
they registered at time blah blah blah

2177
01:39:33,760 --> 01:39:35,840
as and then their username and that's

2178
01:39:35,840 --> 01:39:38,239
what i'm looking for so i'm extracting

2179
01:39:38,239 --> 01:39:40,159
their username you can see here that i

2180
01:39:40,159 --> 01:39:43,119
split by the space

2181
01:39:43,119 --> 01:39:46,480
okay i split by space

2182
01:39:46,480 --> 01:39:47,840
and

2183
01:39:47,840 --> 01:39:50,400
i get the last the last element in the

2184
01:39:50,400 --> 01:39:52,320
array so if i if you split this string

2185
01:39:52,320 --> 01:39:55,119
right here by space

2186
01:39:55,119 --> 01:39:57,360
and you do of element minus one you'll

2187
01:39:57,360 --> 01:39:58,480
get this one

2188
01:39:58,480 --> 01:40:00,960
so i always get the username

2189
01:40:00,960 --> 01:40:01,760
then

2190
01:40:01,760 --> 01:40:04,239
i initialize faker

2191
01:40:04,239 --> 01:40:06,719
why do i do this because look how i'm

2192
01:40:06,719 --> 01:40:09,360
signing up i'm signing up so i go to the

2193
01:40:09,360 --> 01:40:12,159
sign up and i send a post request i send

2194
01:40:12,159 --> 01:40:15,840
first name equal fake first name

2195
01:40:15,840 --> 01:40:19,520
and fake last name i am making my sign

2196
01:40:19,520 --> 01:40:21,600
ups look like as if they came from the

2197
01:40:21,600 --> 01:40:23,280
check system

2198
01:40:23,280 --> 01:40:24,080
okay

2199
01:40:24,080 --> 01:40:27,360
what does that mean let me show you

2200
01:40:28,560 --> 01:40:31,280
so i'm gonna do python okay

2201
01:40:31,280 --> 01:40:32,159
from

2202
01:40:32,159 --> 01:40:35,199
faker import faker i'm gonna do fake

2203
01:40:35,199 --> 01:40:37,280
equal faker like this and then look at

2204
01:40:37,280 --> 01:40:40,519
this fake.unique.firstname

2205
01:40:42,080 --> 01:40:44,639
it's giving me random fake

2206
01:40:44,639 --> 01:40:46,159
first names

2207
01:40:46,159 --> 01:40:49,199
and i can combine this plus space

2208
01:40:49,199 --> 01:40:50,480
plus

2209
01:40:50,480 --> 01:40:53,119
fake.unique

2210
01:40:53,119 --> 01:40:55,920
dot last name

2211
01:40:56,400 --> 01:40:59,920
and look it's fake full names

2212
01:40:59,920 --> 01:41:02,159
just like the check system

2213
01:41:02,159 --> 01:41:05,119
my exploit signs up rather than this

2214
01:41:05,119 --> 01:41:06,239
obvious

2215
01:41:06,239 --> 01:41:08,000
rather than this obvious chaos that's

2216
01:41:08,000 --> 01:41:10,239
happening right here if i go to my users

2217
01:41:10,239 --> 01:41:11,840
list

2218
01:41:11,840 --> 01:41:12,800
okay

2219
01:41:12,800 --> 01:41:15,199
rather than this very obvious chaos

2220
01:41:15,199 --> 01:41:16,560
that's happening right here i can

2221
01:41:16,560 --> 01:41:18,639
clearly tell something is happening

2222
01:41:18,639 --> 01:41:20,960
i'm being sneaky i'm trying to stay

2223
01:41:20,960 --> 01:41:23,360
under the radar i'm signing up with very

2224
01:41:23,360 --> 01:41:25,840
normal names

2225
01:41:25,840 --> 01:41:27,840
okay why would i

2226
01:41:27,840 --> 01:41:29,360
try to

2227
01:41:29,360 --> 01:41:31,760
scare the people who are running the

2228
01:41:31,760 --> 01:41:35,600
service by signing up with a name

2229
01:41:35,600 --> 01:41:37,679
that very obviously looks like someone

2230
01:41:37,679 --> 01:41:40,080
is logging into my service

2231
01:41:40,080 --> 01:41:41,440
get me

2232
01:41:41,440 --> 01:41:42,880
so that's the idea so i'm using this

2233
01:41:42,880 --> 01:41:45,119
faker library to sign up with fake first

2234
01:41:45,119 --> 01:41:46,400
names and last names

2235
01:41:46,400 --> 01:41:48,639
so that i'm stay under the radar and you

2236
01:41:48,639 --> 01:41:51,600
can see right here that i log in

2237
01:41:51,600 --> 01:41:55,280
with latest username plus space

2238
01:41:55,280 --> 01:41:57,040
i add a space and you can actually i can

2239
01:41:57,040 --> 01:41:59,760
multiply this space for example with a

2240
01:41:59,760 --> 01:42:02,159
random you know like a random a random

2241
01:42:02,159 --> 01:42:04,320
number each time just in case i want to

2242
01:42:04,320 --> 01:42:06,000
evade any detection in this case i'm

2243
01:42:06,000 --> 01:42:07,600
just going to multiply by four i'm just

2244
01:42:07,600 --> 01:42:11,199
gonna post four spaces all right and i

2245
01:42:11,199 --> 01:42:12,960
generate a random password again using

2246
01:42:12,960 --> 01:42:15,360
faker right here so fake dot unique

2247
01:42:15,360 --> 01:42:17,520
password length equal 30 special

2248
01:42:17,520 --> 01:42:19,920
characters equal false

2249
01:42:19,920 --> 01:42:21,600
okay

2250
01:42:21,600 --> 01:42:23,119
and

2251
01:42:23,119 --> 01:42:24,800
and that's pretty much it

2252
01:42:24,800 --> 01:42:26,400
i sign up

2253
01:42:26,400 --> 01:42:27,520
and

2254
01:42:27,520 --> 01:42:31,600
i log in with the new user okay i log in

2255
01:42:31,600 --> 01:42:34,320
and i immediately grab the flag

2256
01:42:34,320 --> 01:42:37,199
from a div i find a div called with a

2257
01:42:37,199 --> 01:42:39,199
class planet message

2258
01:42:39,199 --> 01:42:41,119
and i just grab the text

2259
01:42:41,119 --> 01:42:43,440
and that's pretty much it

2260
01:42:43,440 --> 01:42:45,199
now let's loop this let's loop this

2261
01:42:45,199 --> 01:42:46,639
because this might be this might be

2262
01:42:46,639 --> 01:42:48,159
wrong so far so

2263
01:42:48,159 --> 01:42:51,280
what i'm going to do is

2264
01:42:52,080 --> 01:42:54,400
time to do some some development live on

2265
01:42:54,400 --> 01:42:57,400
stream

2266
01:42:58,320 --> 01:43:02,799
okay so find all and i want to print

2267
01:43:03,199 --> 01:43:06,638
latest users href

2268
01:43:07,199 --> 01:43:09,600
comment out the rest so i want a loop

2269
01:43:09,600 --> 01:43:12,159
i want to loop over

2270
01:43:12,159 --> 01:43:13,360
all

2271
01:43:13,360 --> 01:43:15,440
the

2272
01:43:15,440 --> 01:43:17,760
the users that have signed up okay

2273
01:43:17,760 --> 01:43:21,920
domino services nasa rasa nope

2274
01:43:22,400 --> 01:43:23,600
exploit

2275
01:43:23,600 --> 01:43:25,600
service i call this exploit service

2276
01:43:25,600 --> 01:43:26,719
exploit

2277
01:43:26,719 --> 01:43:29,280
and i want to point it at myself

2278
01:43:29,280 --> 01:43:31,519
okay

2279
01:43:32,239 --> 01:43:34,000
none type object is not

2280
01:43:34,000 --> 01:43:38,280
callable what what is happening

2281
01:43:41,360 --> 01:43:43,199
why is this not working

2282
01:43:43,199 --> 01:43:45,199
okay it found one what if i want to find

2283
01:43:45,199 --> 01:43:47,440
all

2284
01:43:47,920 --> 01:43:50,920
hello

2285
01:43:52,480 --> 01:43:55,520
oh it's f find underscore all okay yeah

2286
01:43:55,520 --> 01:43:57,280
you got to be careful

2287
01:43:57,280 --> 01:44:00,400
and i get an array

2288
01:44:02,960 --> 01:44:07,480
what that that doesn't make sense

2289
01:44:17,360 --> 01:44:20,159
yes development i love development guys

2290
01:44:20,159 --> 01:44:23,360
don't you love development

2291
01:44:24,320 --> 01:44:26,719
why is it not giving me an array of all

2292
01:44:26,719 --> 01:44:29,360
the links

2293
01:44:29,679 --> 01:44:31,920
ah here we go

2294
01:44:31,920 --> 01:44:35,560
beautiful soup

2295
01:44:35,600 --> 01:44:38,880
get all links

2296
01:44:44,000 --> 01:44:49,159
oh it's find all right i tried find all

2297
01:44:49,440 --> 01:44:51,760
i swear if it gives me an error

2298
01:44:51,760 --> 01:44:52,960
i still got

2299
01:44:52,960 --> 01:44:54,880
that makes no sense

2300
01:44:54,880 --> 01:44:57,040
why why i'm pretty sure i have more than

2301
01:44:57,040 --> 01:44:59,679
one user

2302
01:45:00,560 --> 01:45:03,040
look at this i have like a billion users

2303
01:45:03,040 --> 01:45:06,239
why are you doing this to me

2304
01:45:11,360 --> 01:45:14,559
find all on the first

2305
01:45:14,840 --> 01:45:19,760
find but i don't want to find all divs

2306
01:45:19,920 --> 01:45:22,480
you get me

2307
01:45:22,480 --> 01:45:26,879
i i i don't want to find all divs

2308
01:45:27,440 --> 01:45:29,360
i want to there's just one div anyway

2309
01:45:29,360 --> 01:45:30,639
you get me

2310
01:45:30,639 --> 01:45:33,119
if i come here and i open the source the

2311
01:45:33,119 --> 01:45:35,679
source code

2312
01:45:36,239 --> 01:45:38,560
there's only one div on top here div

2313
01:45:38,560 --> 01:45:41,199
user oh there are many users oh i'm so

2314
01:45:41,199 --> 01:45:42,080
sorry

2315
01:45:42,080 --> 01:45:43,440
you are right you are right you are

2316
01:45:43,440 --> 01:45:46,879
right oh i am very stupid

2317
01:45:48,000 --> 01:45:50,639
thank you bless you

2318
01:45:50,639 --> 01:45:52,560
all right

2319
01:45:52,560 --> 01:45:54,480
so now we're gonna have to loop over all

2320
01:45:54,480 --> 01:45:58,159
these guys i see thank you so much for

2321
01:45:58,159 --> 01:46:00,800
making me pay attention to that so for

2322
01:46:00,800 --> 01:46:01,920
user

2323
01:46:01,920 --> 01:46:04,639
and latest

2324
01:46:04,639 --> 01:46:06,560
user href

2325
01:46:06,560 --> 01:46:09,199
i have to take user link for example

2326
01:46:09,199 --> 01:46:14,239
equal user dot find a

2327
01:46:15,760 --> 01:46:19,920
dot and then how did they do it here

2328
01:46:23,199 --> 01:46:25,280
dot get

2329
01:46:25,280 --> 01:46:26,400
href

2330
01:46:26,400 --> 01:46:28,239
you know and let's just try that user

2331
01:46:28,239 --> 01:46:30,480
link

2332
01:46:32,800 --> 01:46:34,159
you know there's a way of automating

2333
01:46:34,159 --> 01:46:35,520
this right because if you notice

2334
01:46:35,520 --> 01:46:36,400
something

2335
01:46:36,400 --> 01:46:37,600
there's kind of an eye door

2336
01:46:37,600 --> 01:46:40,159
vulnerability here right

2337
01:46:40,159 --> 01:46:41,679
you know how to go to every user and

2338
01:46:41,679 --> 01:46:44,239
there's just a number right here

2339
01:46:44,239 --> 01:46:45,920
i can literally just take this number

2340
01:46:45,920 --> 01:46:49,679
and loop like 20 numbers back

2341
01:46:49,920 --> 01:46:51,360
so there are so many different ways of

2342
01:46:51,360 --> 01:46:54,839
writing this exploit

2343
01:46:55,679 --> 01:46:57,679
i don't need to worry about you know i

2344
01:46:57,679 --> 01:46:59,920
don't even have to do the the whole

2345
01:46:59,920 --> 01:47:01,920
parsing this html i can just literally

2346
01:47:01,920 --> 01:47:03,119
just

2347
01:47:03,119 --> 01:47:05,520
come here and just you know start

2348
01:47:05,520 --> 01:47:08,880
messing with this number

2349
01:47:08,880 --> 01:47:10,080
but yeah

2350
01:47:10,080 --> 01:47:11,360
let's let's just continue what we're

2351
01:47:11,360 --> 01:47:13,360
doing though so let's let's run the

2352
01:47:13,360 --> 01:47:15,679
script one more time

2353
01:47:15,679 --> 01:47:18,960
wow and i get a link of all the users

2354
01:47:18,960 --> 01:47:23,199
uh on the on the board that's nice

2355
01:47:23,199 --> 01:47:24,880
so i'm just gonna come here and i'm

2356
01:47:24,880 --> 01:47:27,760
going to uncomment these guys and i am

2357
01:47:27,760 --> 01:47:30,000
going to grab

2358
01:47:30,000 --> 01:47:32,000
the code this code and i'm going to

2359
01:47:32,000 --> 01:47:35,119
paste it right here

2360
01:47:35,119 --> 01:47:36,560
got to be careful with python because

2361
01:47:36,560 --> 01:47:39,840
they loves it loves its indentation

2362
01:47:39,840 --> 01:47:42,159
so we are

2363
01:47:42,159 --> 01:47:43,840
going to

2364
01:47:43,840 --> 01:47:46,960
user link

2365
01:47:47,119 --> 01:47:48,880
and it grabs the username latest

2366
01:47:48,880 --> 01:47:50,960
username and we're going to print

2367
01:47:50,960 --> 01:47:52,400
latest

2368
01:47:52,400 --> 01:47:53,920
username

2369
01:47:53,920 --> 01:47:55,280
so this should get us a list of all

2370
01:47:55,280 --> 01:47:57,920
usernames

2371
01:48:00,880 --> 01:48:02,719
all right it didn't work all the time

2372
01:48:02,719 --> 01:48:04,719
and that's weird

2373
01:48:04,719 --> 01:48:07,520
why did it not work all the time

2374
01:48:07,520 --> 01:48:09,040
let's just print

2375
01:48:09,040 --> 01:48:11,360
this

2376
01:48:16,840 --> 01:48:22,320
that's odd it should have worked

2377
01:48:23,360 --> 01:48:24,639
why is it working sometimes and

2378
01:48:24,639 --> 01:48:27,280
sometimes not

2379
01:48:27,520 --> 01:48:29,600
i mean i i mean maybe it's filtering

2380
01:48:29,600 --> 01:48:31,600
duplicates

2381
01:48:31,600 --> 01:48:34,400
i can't

2382
01:48:34,960 --> 01:48:37,360
oh some names have extra spaces on the

2383
01:48:37,360 --> 01:48:39,840
back you're right wait that's actually

2384
01:48:39,840 --> 01:48:40,800
good

2385
01:48:40,800 --> 01:48:42,159
that is actually good that's actually

2386
01:48:42,159 --> 01:48:44,880
good we can that means we're ignoring

2387
01:48:44,880 --> 01:48:46,880
the usernames with extra spaces in the

2388
01:48:46,880 --> 01:48:48,480
back

2389
01:48:48,480 --> 01:48:50,320
isn't that isn't that good so i can come

2390
01:48:50,320 --> 01:48:52,400
here for example and say i'm going to

2391
01:48:52,400 --> 01:48:54,719
make an empty array here called

2392
01:48:54,719 --> 01:48:56,320
users

2393
01:48:56,320 --> 01:48:58,719
let's say check system

2394
01:48:58,719 --> 01:49:01,040
users and it's an empty array

2395
01:49:01,040 --> 01:49:03,360
and

2396
01:49:04,400 --> 01:49:05,280
if

2397
01:49:05,280 --> 01:49:08,639
latest username

2398
01:49:09,119 --> 01:49:12,400
all right does not equal just a space

2399
01:49:12,400 --> 01:49:14,880
right if it's not just a space then we

2400
01:49:14,880 --> 01:49:18,239
can add it to our array

2401
01:49:19,840 --> 01:49:22,320
of usernames to exploit so now now you

2402
01:49:22,320 --> 01:49:23,520
can print

2403
01:49:23,520 --> 01:49:25,280
check system users

2404
01:49:25,280 --> 01:49:26,840
and you'll have a

2405
01:49:26,840 --> 01:49:30,400
list of users that you know for sure

2406
01:49:30,400 --> 01:49:33,280
what happened here

2407
01:49:35,599 --> 01:49:38,159
if latest username is not

2408
01:49:38,159 --> 01:49:39,679
you know what okay

2409
01:49:39,679 --> 01:49:41,679
let's just say is i think there's dot

2410
01:49:41,679 --> 01:49:43,840
empty

2411
01:49:44,480 --> 01:49:48,598
how can you check if

2412
01:49:58,320 --> 01:50:00,639
we can just do dot strip

2413
01:50:00,639 --> 01:50:02,400
to be honest you know we can just you're

2414
01:50:02,400 --> 01:50:05,360
actually right you can actually write if

2415
01:50:05,360 --> 01:50:06,880
yeah yeah that's that's actually good

2416
01:50:06,880 --> 01:50:08,639
that's good oh you guys are python

2417
01:50:08,639 --> 01:50:10,480
experts right here everybody is i

2418
01:50:10,480 --> 01:50:13,759
thought i was good at python

2419
01:50:14,159 --> 01:50:15,599
there's a billion ways to write it

2420
01:50:15,599 --> 01:50:16,639
thankfully yeah i'm going to go with

2421
01:50:16,639 --> 01:50:18,480
that one so if lan

2422
01:50:18,480 --> 01:50:20,719
if length and while it's stripped is

2423
01:50:20,719 --> 01:50:23,119
still greater than zero then we append

2424
01:50:23,119 --> 01:50:26,639
yeah that's right let's do that

2425
01:50:26,960 --> 01:50:28,880
nice there we go we got two usernames

2426
01:50:28,880 --> 01:50:30,560
directly from the check system we know

2427
01:50:30,560 --> 01:50:32,400
that these usernames were generated by

2428
01:50:32,400 --> 01:50:33,679
the check system

2429
01:50:33,679 --> 01:50:36,080
and just for debugging i'm going to

2430
01:50:36,080 --> 01:50:39,080
print

2431
01:50:40,639 --> 01:50:42,960
just for just for debugging i'm going to

2432
01:50:42,960 --> 01:50:45,520
print this

2433
01:50:45,520 --> 01:50:47,760
okay

2434
01:50:51,360 --> 01:50:53,119
and there we go so these guys probably

2435
01:50:53,119 --> 01:50:54,800
have a bunch of spaces at the end yeah i

2436
01:50:54,800 --> 01:50:57,119
can i can well i don't think my terminal

2437
01:50:57,119 --> 01:50:58,400
is accurate

2438
01:50:58,400 --> 01:50:59,520
but yeah

2439
01:50:59,520 --> 01:51:01,920
there you go you grabbed users that are

2440
01:51:01,920 --> 01:51:03,840
only that were only placed by the check

2441
01:51:03,840 --> 01:51:06,840
system

2442
01:51:07,440 --> 01:51:09,280
again if you guys are like panicked and

2443
01:51:09,280 --> 01:51:10,880
you're like oh what if these were not

2444
01:51:10,880 --> 01:51:12,800
placed by the check system what if you

2445
01:51:12,800 --> 01:51:15,599
know what if you actually uh what if we

2446
01:51:15,599 --> 01:51:17,360
actually wanted to try and exploit them

2447
01:51:17,360 --> 01:51:18,960
that's very simple all you got to do is

2448
01:51:18,960 --> 01:51:20,639
just come here

2449
01:51:20,639 --> 01:51:23,920
and strip the text itself

2450
01:51:23,920 --> 01:51:25,520
okay

2451
01:51:25,520 --> 01:51:27,840
and i think so this is this will give us

2452
01:51:27,840 --> 01:51:30,639
a complete list of usernames even the

2453
01:51:30,639 --> 01:51:32,639
ones that might be fake and put by other

2454
01:51:32,639 --> 01:51:36,400
people okay that's fine

2455
01:51:39,040 --> 01:51:40,800
see but what we want to do is we want to

2456
01:51:40,800 --> 01:51:42,000
make sure they're unique so i'm going to

2457
01:51:42,000 --> 01:51:44,560
create a set over here a python set

2458
01:51:44,560 --> 01:51:47,119
and i'm going to say

2459
01:51:47,119 --> 01:51:48,400
check system

2460
01:51:48,400 --> 01:51:50,320
users dot

2461
01:51:50,320 --> 01:51:51,840
uh

2462
01:51:51,840 --> 01:51:53,440
how do you push

2463
01:51:53,440 --> 01:51:56,159
does it append

2464
01:51:56,480 --> 01:51:58,800
append into a set yeah i mean it's not

2465
01:51:58,800 --> 01:52:00,960
it's complaining

2466
01:52:00,960 --> 01:52:02,719
but you should be able to append into a

2467
01:52:02,719 --> 01:52:04,960
set

2468
01:52:06,400 --> 01:52:08,320
oh that's a dick oh my god sorry i'm

2469
01:52:08,320 --> 01:52:10,880
just gonna do set like this yes yes

2470
01:52:10,880 --> 01:52:12,880
there we go why why are you complaining

2471
01:52:12,880 --> 01:52:15,880
set

2472
01:52:17,119 --> 01:52:18,880
see it's not called it's not called that

2473
01:52:18,880 --> 01:52:20,320
i think it's uh

2474
01:52:20,320 --> 01:52:21,679
add add

2475
01:52:21,679 --> 01:52:25,119
in a set set its ad yes yes yes there

2476
01:52:25,119 --> 01:52:26,000
you go

2477
01:52:26,000 --> 01:52:28,960
thank you there we go we have a unique

2478
01:52:28,960 --> 01:52:31,119
set of usernames

2479
01:52:31,119 --> 01:52:33,599
all right so now now we increased maybe

2480
01:52:33,599 --> 01:52:36,000
the potential of our script finding more

2481
01:52:36,000 --> 01:52:38,239
even more vulnerabilities uh even more

2482
01:52:38,239 --> 01:52:39,840
sort of usernames to

2483
01:52:39,840 --> 01:52:42,159
to hijack okay so what are you gonna do

2484
01:52:42,159 --> 01:52:43,520
very simply

2485
01:52:43,520 --> 01:52:45,040
you we are still going to do this so

2486
01:52:45,040 --> 01:52:46,880
we're going to loop over

2487
01:52:46,880 --> 01:52:49,119
i'm going to uncomment all this

2488
01:52:49,119 --> 01:52:52,639
all right and i'm going to loop for user

2489
01:52:52,639 --> 01:52:53,679
again

2490
01:52:53,679 --> 01:52:56,000
in check system users all right so these

2491
01:52:56,000 --> 01:52:59,040
are the users we want to exploit

2492
01:52:59,040 --> 01:53:01,440
we are going to

2493
01:53:01,440 --> 01:53:03,520
sign up with that user so i'm going to

2494
01:53:03,520 --> 01:53:05,679
do user right here

2495
01:53:05,679 --> 01:53:07,920
and four spaces we are signing up with

2496
01:53:07,920 --> 01:53:10,639
four spaces for every single username

2497
01:53:10,639 --> 01:53:11,679
okay

2498
01:53:11,679 --> 01:53:14,320
and with a random password every time

2499
01:53:14,320 --> 01:53:15,920
and we're just we're signing up with

2500
01:53:15,920 --> 01:53:17,760
that user okay

2501
01:53:17,760 --> 01:53:20,080
if the signup doesn't work we leave

2502
01:53:20,080 --> 01:53:22,880
immediately okay then what happens next

2503
01:53:22,880 --> 01:53:25,199
is we log in with that user let's come

2504
01:53:25,199 --> 01:53:27,760
in here let's let's tabulate that we log

2505
01:53:27,760 --> 01:53:29,760
in with that user if the login doesn't

2506
01:53:29,760 --> 01:53:30,639
work

2507
01:53:30,639 --> 01:53:33,280
we exit the script immediately oh what

2508
01:53:33,280 --> 01:53:35,679
happened

2509
01:53:36,719 --> 01:53:38,080
all right

2510
01:53:38,080 --> 01:53:40,800
there we go

2511
01:53:40,800 --> 01:53:42,639
no please

2512
01:53:42,639 --> 01:53:43,760
okay

2513
01:53:43,760 --> 01:53:44,639
uh

2514
01:53:44,639 --> 01:53:46,960
and last but not least we are going to

2515
01:53:46,960 --> 01:53:48,960
uncomment this part and we're going to

2516
01:53:48,960 --> 01:53:51,440
get the planet posted by the user we're

2517
01:53:51,440 --> 01:53:53,280
going to try to find

2518
01:53:53,280 --> 01:53:54,719
the uh

2519
01:53:54,719 --> 01:53:56,159
so we're going to take this

2520
01:53:56,159 --> 01:53:57,199
i'm going to separate this on a

2521
01:53:57,199 --> 01:53:58,560
different line i'm going to put a try

2522
01:53:58,560 --> 01:53:59,840
catch okay

2523
01:53:59,840 --> 01:54:04,239
because what if if we're accidentally

2524
01:54:04,560 --> 01:54:06,840
logging

2525
01:54:06,840 --> 01:54:09,840
in i'm i'm so confused i'm trying to

2526
01:54:09,840 --> 01:54:11,280
write like three different languages at

2527
01:54:11,280 --> 01:54:13,040
the same time

2528
01:54:13,040 --> 01:54:13,920
okay

2529
01:54:13,920 --> 01:54:16,960
so if for any reason

2530
01:54:16,960 --> 01:54:18,400
there's an exception that happens for

2531
01:54:18,400 --> 01:54:20,400
example this user doesn't actually have

2532
01:54:20,400 --> 01:54:21,440
a flag

2533
01:54:21,440 --> 01:54:22,719
okay

2534
01:54:22,719 --> 01:54:25,599
then we will just continue otherwise we

2535
01:54:25,599 --> 01:54:27,520
can print it

2536
01:54:27,520 --> 01:54:30,320
okay so sometimes some users will will

2537
01:54:30,320 --> 01:54:33,040
be fake users put in by other people and

2538
01:54:33,040 --> 01:54:35,280
we don't want to worry about that right

2539
01:54:35,280 --> 01:54:38,480
so there we go

2540
01:54:38,560 --> 01:54:41,440
now we can try running our script

2541
01:54:41,440 --> 01:54:43,199
everything looks good everything feels

2542
01:54:43,199 --> 01:54:45,440
good

2543
01:54:46,560 --> 01:54:47,760
oh god

2544
01:54:47,760 --> 01:54:50,159
failed to parse whoa what is happening

2545
01:54:50,159 --> 01:54:52,400
here

2546
01:54:53,520 --> 01:54:55,440
i think we need to call it

2547
01:54:55,440 --> 01:54:57,760
something else other than user maybe

2548
01:54:57,760 --> 01:55:00,159
let's just call it uh

2549
01:55:00,159 --> 01:55:02,880
exp user just for the sake of

2550
01:55:02,880 --> 01:55:05,840
you know

2551
01:55:08,239 --> 01:55:09,599
and we had to change it right here as

2552
01:55:09,599 --> 01:55:12,320
well i think

2553
01:55:15,920 --> 01:55:19,520
ooh get the planet posted by the user

2554
01:55:19,520 --> 01:55:21,920
and we have to go

2555
01:55:21,920 --> 01:55:22,960
to there

2556
01:55:22,960 --> 01:55:24,960
oh that's going to be interesting how

2557
01:55:24,960 --> 01:55:28,520
can we do that

2558
01:55:33,920 --> 01:55:35,760
i need to somehow

2559
01:55:35,760 --> 01:55:39,119
get their profile number

2560
01:55:39,599 --> 01:55:41,599
how can we do that

2561
01:55:41,599 --> 01:55:45,800
how can we get the profile number

2562
01:55:52,320 --> 01:55:54,960
so there are so many ways to do it but

2563
01:55:54,960 --> 01:55:56,960
i mean you could do a

2564
01:55:56,960 --> 01:55:59,040
it could be a set

2565
01:55:59,040 --> 01:56:01,840
we can do a dictionary

2566
01:56:02,000 --> 01:56:04,320
so you could be pushing dictionaries but

2567
01:56:04,320 --> 01:56:06,080
i don't i don't think that would work

2568
01:56:06,080 --> 01:56:07,679
though

2569
01:56:07,679 --> 01:56:09,920
so let's say for example user

2570
01:56:09,920 --> 01:56:11,599
is this

2571
01:56:11,599 --> 01:56:14,719
and then we're pushing an id

2572
01:56:14,719 --> 01:56:17,360
and let's say

2573
01:56:21,119 --> 01:56:22,639
user

2574
01:56:22,639 --> 01:56:24,719
link

2575
01:56:24,719 --> 01:56:26,239
okay

2576
01:56:26,239 --> 01:56:28,400
so for axp user

2577
01:56:28,400 --> 01:56:29,599
don't worry about what i'm doing i'm

2578
01:56:29,599 --> 01:56:31,840
just mumbling to myself but i i know

2579
01:56:31,840 --> 01:56:34,000
what i'm doing

2580
01:56:34,000 --> 01:56:35,760
for those of you who are

2581
01:56:35,760 --> 01:56:37,679
fast enough to understand what i'm doing

2582
01:56:37,679 --> 01:56:42,040
that that's that's amazing news

2583
01:56:43,040 --> 01:56:44,239
id

2584
01:56:44,239 --> 01:56:47,360
i think that might work

2585
01:56:47,360 --> 01:56:50,239
unhashable type dict of course

2586
01:56:50,239 --> 01:56:53,520
of course i was doing this to myself

2587
01:56:53,520 --> 01:56:56,880
use a tuple yeah yeah yeah yeah so we'll

2588
01:56:56,880 --> 01:56:58,800
use another tuple like this it'll be

2589
01:56:58,800 --> 01:57:02,639
user link and latest username

2590
01:57:02,639 --> 01:57:04,239
so essentially what i'm trying to do is

2591
01:57:04,239 --> 01:57:06,639
i'm trying to save the usernames and

2592
01:57:06,639 --> 01:57:08,800
their link to their profile page at the

2593
01:57:08,800 --> 01:57:10,880
same time okay that's what i'm trying to

2594
01:57:10,880 --> 01:57:12,639
do

2595
01:57:12,639 --> 01:57:14,639
so that when i do the second loop of

2596
01:57:14,639 --> 01:57:17,280
only unique users

2597
01:57:17,280 --> 01:57:18,719
i

2598
01:57:18,719 --> 01:57:20,400
have access

2599
01:57:20,400 --> 01:57:22,320
to both the link

2600
01:57:22,320 --> 01:57:24,480
and the username

2601
01:57:24,480 --> 01:57:26,159
thanks for that so let's see what

2602
01:57:26,159 --> 01:57:27,760
happens now

2603
01:57:27,760 --> 01:57:29,040
there we go

2604
01:57:29,040 --> 01:57:32,159
and we're grabbing flags

2605
01:57:34,560 --> 01:57:36,880
that's great so we now have a working

2606
01:57:36,880 --> 01:57:38,560
exploit and that's amazing and you know

2607
01:57:38,560 --> 01:57:41,599
what i can immediately copy that same

2608
01:57:41,599 --> 01:57:43,840
start exploit command remember for the

2609
01:57:43,840 --> 01:57:45,599
for the check system sorry for the

2610
01:57:45,599 --> 01:57:46,880
exploit farm

2611
01:57:46,880 --> 01:57:49,119
i can just copy that same command again

2612
01:57:49,119 --> 01:57:51,760
let's let me copy it

2613
01:57:51,760 --> 01:57:55,679
where was it somewhere here

2614
01:57:57,760 --> 01:58:00,320
come on where are you start split that

2615
01:58:00,320 --> 01:58:01,679
bite there we go

2616
01:58:01,679 --> 01:58:04,000
okay

2617
01:58:04,000 --> 01:58:05,679
and i can actually just come straight up

2618
01:58:05,679 --> 01:58:08,159
here and i'm going to change these

2619
01:58:08,159 --> 01:58:10,880
dashes and so what is this exploit this

2620
01:58:10,880 --> 01:58:13,520
exploit is nasa rasa

2621
01:58:13,520 --> 01:58:16,719
um web okay

2622
01:58:16,719 --> 01:58:21,199
and my server is at that ip address and

2623
01:58:21,199 --> 01:58:22,480
it's called

2624
01:58:22,480 --> 01:58:25,599
server url and the exploit is located in

2625
01:58:25,599 --> 01:58:28,080
workspace

2626
01:58:28,080 --> 01:58:30,800
uh ctf training

2627
01:58:30,800 --> 01:58:32,159
services

2628
01:58:32,159 --> 01:58:34,960
nasarasa

2629
01:58:36,320 --> 01:58:38,719
what was it called service split

2630
01:58:38,719 --> 01:58:40,880
there you go

2631
01:58:40,880 --> 01:58:43,599
oh sorry i wasn't in my temporary i

2632
01:58:43,599 --> 01:58:44,960
wasn't in my

2633
01:58:44,960 --> 01:58:46,159
hitb

2634
01:58:46,159 --> 01:58:48,800
training and there we go a brand new

2635
01:58:48,800 --> 01:58:51,280
exploit just like that

2636
01:58:51,280 --> 01:58:52,880
and that's fine some people have their

2637
01:58:52,880 --> 01:58:54,480
services down so you're getting this

2638
01:58:54,480 --> 01:58:57,360
connection refused bug

2639
01:58:57,360 --> 01:58:59,440
and that's okay there we go i'm stealing

2640
01:58:59,440 --> 01:59:01,199
flags from other people

2641
01:59:01,199 --> 01:59:03,599
some teams have their services down so

2642
01:59:03,599 --> 01:59:06,159
i'm getting this these exceptions

2643
01:59:06,159 --> 01:59:09,598
that's pretty much that's fine

2644
01:59:15,119 --> 01:59:18,639
yes thank you andre so uh your exploits

2645
01:59:18,639 --> 01:59:20,400
can output so andre is making a very

2646
01:59:20,400 --> 01:59:21,920
good point that your exploits can

2647
01:59:21,920 --> 01:59:24,639
contain output other than flag you can

2648
01:59:24,639 --> 01:59:26,560
print other stuff that's fine because

2649
01:59:26,560 --> 01:59:29,280
the farm will actually use the regex

2650
01:59:29,280 --> 01:59:31,599
to only pull out

2651
01:59:31,599 --> 01:59:34,239
the flags from your output

2652
01:59:34,239 --> 01:59:35,040
okay

2653
01:59:35,040 --> 01:59:37,920
and so there you go now if i go to my my

2654
01:59:37,920 --> 01:59:39,679
exploit form

2655
01:59:39,679 --> 01:59:42,800
let's reset the zoom on this

2656
01:59:42,800 --> 01:59:44,800
you see that i now have two exploits i

2657
01:59:44,800 --> 01:59:46,880
have nasa rasa web running and stealing

2658
01:59:46,880 --> 01:59:49,360
flags and i have nasa rasa mysql running

2659
01:59:49,360 --> 01:59:51,599
and stealing flags and like again like i

2660
01:59:51,599 --> 01:59:52,880
said again the beauty of the check

2661
01:59:52,880 --> 01:59:54,800
system is that i don't have to worry

2662
01:59:54,800 --> 01:59:56,639
about any of that i just i wrote the

2663
01:59:56,639 --> 01:59:58,880
exploit and i launched it and i can

2664
01:59:58,880 --> 02:00:01,760
leave it going on exploiting the other

2665
02:00:01,760 --> 02:00:03,119
teams

2666
02:00:03,119 --> 02:00:05,360
okay

2667
02:00:06,000 --> 02:00:09,360
go back and look at the scoreboard

2668
02:00:10,159 --> 02:00:12,400
i have i've stolen 500

2669
02:00:12,400 --> 02:00:14,960
562 flags and i think i nobody nobody

2670
02:00:14,960 --> 02:00:15,760
stole

2671
02:00:15,760 --> 02:00:17,520
any more like no i think i'm still

2672
02:00:17,520 --> 02:00:19,280
losing flags thanks to the pad space

2673
02:00:19,280 --> 02:00:21,280
coalition so let's talk let's talk about

2674
02:00:21,280 --> 02:00:23,599
the pad space collation what is what is

2675
02:00:23,599 --> 02:00:25,760
the easiest way to fix this bug we still

2676
02:00:25,760 --> 02:00:28,000
have we need to fix this pad space bug

2677
02:00:28,000 --> 02:00:30,239
right how do you fix it well the best

2678
02:00:30,239 --> 02:00:32,080
way to fix it is just to come down to

2679
02:00:32,080 --> 02:00:33,599
this command part

2680
02:00:33,599 --> 02:00:34,560
and just

2681
02:00:34,560 --> 02:00:38,239
stop setting a specific

2682
02:00:38,239 --> 02:00:40,320
character set why are you trying to set

2683
02:00:40,320 --> 02:00:42,159
a specific character set

2684
02:00:42,159 --> 02:00:44,639
just use the default and the default one

2685
02:00:44,639 --> 02:00:46,719
in mysql doesn't have pad space

2686
02:00:46,719 --> 02:00:48,400
collision by the way

2687
02:00:48,400 --> 02:00:49,520
so just

2688
02:00:49,520 --> 02:00:52,080
turn it off

2689
02:00:52,239 --> 02:00:53,520
and there you go i'm going to rebuild my

2690
02:00:53,520 --> 02:00:55,840
database

2691
02:00:58,239 --> 02:01:00,000
so docker compose

2692
02:01:00,000 --> 02:01:01,920
up dash dash build

2693
02:01:01,920 --> 02:01:03,440
force recreate

2694
02:01:03,440 --> 02:01:05,598
d

2695
02:01:06,480 --> 02:01:08,719
it's rebuilding

2696
02:01:08,719 --> 02:01:11,599
and it's up

2697
02:01:11,599 --> 02:01:14,560
and i can even go like this let me again

2698
02:01:14,560 --> 02:01:17,440
connect to my database locally and let's

2699
02:01:17,440 --> 02:01:20,000
let's check can i do can i do that trick

2700
02:01:20,000 --> 02:01:22,000
so can i select

2701
02:01:22,000 --> 02:01:23,199
hello

2702
02:01:23,199 --> 02:01:26,080
equals hello space

2703
02:01:26,080 --> 02:01:28,560
i get zero you get

2704
02:01:28,560 --> 02:01:30,960
false

2705
02:01:31,679 --> 02:01:34,000
okay

2706
02:01:34,320 --> 02:01:35,760
you've successfully patched the path

2707
02:01:35,760 --> 02:01:38,639
space coalition although by the way

2708
02:01:38,639 --> 02:01:40,880
you might think that's it but

2709
02:01:40,880 --> 02:01:42,800
there's this there's another secret

2710
02:01:42,800 --> 02:01:44,960
somewhere in here all right if you look

2711
02:01:44,960 --> 02:01:47,599
at the db.php

2712
02:01:47,599 --> 02:01:51,400
you can see that

2713
02:01:51,840 --> 02:01:55,760
in all the in all when it creates tables

2714
02:01:55,760 --> 02:01:57,599
when it's creating tables

2715
02:01:57,599 --> 02:01:59,920
look it's forcing a specific collision

2716
02:01:59,920 --> 02:02:01,040
look here

2717
02:02:01,040 --> 02:02:03,440
it's forcing that collate it's it's

2718
02:02:03,440 --> 02:02:06,080
forcing that character set on the table

2719
02:02:06,080 --> 02:02:08,159
so you're not done yet you should

2720
02:02:08,159 --> 02:02:10,639
investigate the code so the final final

2721
02:02:10,639 --> 02:02:14,480
piece of the puzzle is to remove this

2722
02:02:14,480 --> 02:02:16,159
and keep it like this now i have to

2723
02:02:16,159 --> 02:02:19,199
rebuild my service as well so don't just

2724
02:02:19,199 --> 02:02:20,880
remove from the docker compose and think

2725
02:02:20,880 --> 02:02:22,159
that your life is okay you should

2726
02:02:22,159 --> 02:02:24,880
investigate all the code see if that

2727
02:02:24,880 --> 02:02:29,280
that word that that phrase you know

2728
02:02:29,280 --> 02:02:31,840
this ut

2729
02:02:31,840 --> 02:02:34,239
mb4 unicode ci see if it exists anywhere

2730
02:02:34,239 --> 02:02:36,400
in the code try to look around so now i

2731
02:02:36,400 --> 02:02:39,199
can fully 100 patch my surface

2732
02:02:39,199 --> 02:02:40,080
so

2733
02:02:40,080 --> 02:02:42,719
i bring it up it's rebuilding

2734
02:02:42,719 --> 02:02:44,239
it's going to take longer now because i

2735
02:02:44,239 --> 02:02:47,520
actually changed the code for nasa rasa

2736
02:02:47,520 --> 02:02:49,440
and i'll show you that my service runs

2737
02:02:49,440 --> 02:02:52,919
perfectly fine

2738
02:03:15,599 --> 02:03:19,360
yes ai you will have access to these uh

2739
02:03:19,360 --> 02:03:21,360
once the training is done yeah you guys

2740
02:03:21,360 --> 02:03:24,719
will be able to see all these

2741
02:03:27,440 --> 02:03:29,199
and there you go my service is running

2742
02:03:29,199 --> 02:03:30,960
let's just let me just make sure that my

2743
02:03:30,960 --> 02:03:32,719
services actually haven't destroyed my

2744
02:03:32,719 --> 02:03:35,360
service so let's go to nasa rasa and

2745
02:03:35,360 --> 02:03:37,520
there you go it's it's running perfectly

2746
02:03:37,520 --> 02:03:38,880
fine

2747
02:03:38,880 --> 02:03:40,480
service is up and running and i'm

2748
02:03:40,480 --> 02:03:44,239
patched and i'm gonna stop losing flags

2749
02:03:44,239 --> 02:03:46,880
while still grabbing flags thanks to the

2750
02:03:46,880 --> 02:03:48,560
thanks to the exploits that are

2751
02:03:48,560 --> 02:03:50,159
continuously running

2752
02:03:50,159 --> 02:03:53,638
from other teams

2753
02:03:58,400 --> 02:03:59,440
and that's

2754
02:03:59,440 --> 02:04:00,800
and that's and that's pretty much the

2755
02:04:00,800 --> 02:04:02,880
beauty of attack and defense you can

2756
02:04:02,880 --> 02:04:05,040
even see by the way see right here how

2757
02:04:05,040 --> 02:04:07,199
often attacks happen so you can see that

2758
02:04:07,199 --> 02:04:09,280
coffee pot there are 14 attacks per

2759
02:04:09,280 --> 02:04:11,199
round happening or 14 flags being stolen

2760
02:04:11,199 --> 02:04:12,239
per round

2761
02:04:12,239 --> 02:04:16,799
72 flags per round 50 to 66

2762
02:04:17,840 --> 02:04:19,199
this gives you an idea about what

2763
02:04:19,199 --> 02:04:20,639
services are most commonly being

2764
02:04:20,639 --> 02:04:22,639
exploited

2765
02:04:22,639 --> 02:04:24,560
all right

2766
02:04:24,560 --> 02:04:26,000
we can move on with the material now we

2767
02:04:26,000 --> 02:04:28,320
still got services to look at

2768
02:04:28,320 --> 02:04:29,520
so

2769
02:04:29,520 --> 02:04:32,400
i'm going to give you guys another

2770
02:04:32,400 --> 02:04:34,000
can you try running my exploit again

2771
02:04:34,000 --> 02:04:36,239
against my own service yes that is

2772
02:04:36,239 --> 02:04:38,239
actually a great idea since you want to

2773
02:04:38,239 --> 02:04:40,960
make sure that it's fixed now

2774
02:04:40,960 --> 02:04:43,040
please move away zoom

2775
02:04:43,040 --> 02:04:45,360
thing all right

2776
02:04:45,360 --> 02:04:47,440
here it is right ready to guess my own

2777
02:04:47,440 --> 02:04:49,839
service

2778
02:04:50,840 --> 02:04:53,360
nothing this is the this is the database

2779
02:04:53,360 --> 02:04:54,960
exploit right let's use the service

2780
02:04:54,960 --> 02:04:57,679
split right here

2781
02:05:03,040 --> 02:05:05,520
it's just probably waiting waiting

2782
02:05:05,520 --> 02:05:07,599
waiting it's going user by user user by

2783
02:05:07,599 --> 02:05:09,520
user trying to sign up and nothing

2784
02:05:09,520 --> 02:05:11,920
happened

2785
02:05:13,440 --> 02:05:14,639
there you go

2786
02:05:14,639 --> 02:05:16,639
i get no flags anymore for my own

2787
02:05:16,639 --> 02:05:19,639
service

2788
02:05:23,599 --> 02:05:26,079
that's proof that we patched it

2789
02:05:26,079 --> 02:05:28,159
when other teams try to you know mess

2790
02:05:28,159 --> 02:05:30,560
around and you have to keep exploring

2791
02:05:30,560 --> 02:05:32,159
maybe there's an extra bug i mean right

2792
02:05:32,159 --> 02:05:33,920
now we know that there is no i'm telling

2793
02:05:33,920 --> 02:05:35,760
you there's no extra bug

2794
02:05:35,760 --> 02:05:38,000
but you never know

2795
02:05:38,000 --> 02:05:40,560
right so there you go you're patched

2796
02:05:40,560 --> 02:05:42,719
and you're you've saved yourself from

2797
02:05:42,719 --> 02:05:44,320
your flags being stolen

2798
02:05:44,320 --> 02:05:47,040
so now we're gonna go on quite a bit of

2799
02:05:47,040 --> 02:05:48,560
a long break here we're going to go on a

2800
02:05:48,560 --> 02:05:50,560
30-minute break okay

2801
02:05:50,560 --> 02:05:51,840
just because i've been talking for a

2802
02:05:51,840 --> 02:05:52,639
while

2803
02:05:52,639 --> 02:05:55,840
and i want you guys to go ahead go look

2804
02:05:55,840 --> 02:05:58,159
at coffee bot all right

2805
02:05:58,159 --> 02:06:00,000
and try to figure out what the

2806
02:06:00,000 --> 02:06:02,320
vulnerability is so we're basically done

2807
02:06:02,320 --> 02:06:03,840
with with material

2808
02:06:03,840 --> 02:06:04,880
okay

2809
02:06:04,880 --> 02:06:05,679
but

2810
02:06:05,679 --> 02:06:07,920
i am going to

2811
02:06:07,920 --> 02:06:09,280
walk you through the vulnerability and

2812
02:06:09,280 --> 02:06:11,440
coffee pot as well okay

2813
02:06:11,440 --> 02:06:13,760
so i'm gonna put us again on a 30 minute

2814
02:06:13,760 --> 02:06:14,840
30 minute

2815
02:06:14,840 --> 02:06:19,440
break you guys can go ahead

2816
02:06:19,440 --> 02:06:21,040
and take a look at

2817
02:06:21,040 --> 02:06:23,520
coffee pot or if if you feel like you

2818
02:06:23,520 --> 02:06:24,639
know

2819
02:06:24,639 --> 02:06:26,159
you don't want to take a look just at

2820
02:06:26,159 --> 02:06:28,960
least go drink water freshen up and be

2821
02:06:28,960 --> 02:06:30,800
back here in 30 minutes alright we'll

2822
02:06:30,800 --> 02:06:34,360
see you guys on 30.

2823
02:36:39,439 --> 02:36:42,319
all right welcome back everybody from

2824
02:36:42,319 --> 02:36:44,000
our 30 minute break

2825
02:36:44,000 --> 02:36:45,760
so

2826
02:36:45,760 --> 02:36:46,960
tell me guys

2827
02:36:46,960 --> 02:36:49,120
what have you found so far what

2828
02:36:49,120 --> 02:36:51,040
vulnerability have you found in the

2829
02:36:51,040 --> 02:36:54,840
coffee pot service

2830
02:37:07,520 --> 02:37:08,640
nobody

2831
02:37:08,640 --> 02:37:11,680
anybody at all

2832
02:37:13,120 --> 02:37:15,760
command injection yes if there is a

2833
02:37:15,760 --> 02:37:18,080
command injection and that's fine and

2834
02:37:18,080 --> 02:37:20,800
that's fine antoine uh we'll we'll get

2835
02:37:20,800 --> 02:37:22,319
to it right now i'll explain it to you

2836
02:37:22,319 --> 02:37:23,600
so

2837
02:37:23,600 --> 02:37:26,399
there is actually command injection

2838
02:37:26,399 --> 02:37:27,120
in

2839
02:37:27,120 --> 02:37:29,200
coffee pot all right so let's take a

2840
02:37:29,200 --> 02:37:31,200
look at the code together and

2841
02:37:31,200 --> 02:37:34,160
i'll point it out for you alright

2842
02:37:34,160 --> 02:37:36,240
so let's go to my machine

2843
02:37:36,240 --> 02:37:39,199
let's go to

2844
02:37:41,200 --> 02:37:44,760
ctf training

2845
02:37:50,399 --> 02:37:52,160
and let's look at the service

2846
02:37:52,160 --> 02:37:53,840
all right

2847
02:37:53,840 --> 02:37:57,040
so coffee pot surface

2848
02:37:57,439 --> 02:38:01,640
and let's look at coffee coffeepot.cgi

2849
02:38:02,399 --> 02:38:03,280
okay

2850
02:38:03,280 --> 02:38:05,439
so

2851
02:38:05,439 --> 02:38:07,920
let's see here so it says here that the

2852
02:38:07,920 --> 02:38:12,800
coffee pot is implementing rfc2324

2853
02:38:12,800 --> 02:38:13,680
okay

2854
02:38:13,680 --> 02:38:15,920
what is rfce2324

2855
02:38:15,920 --> 02:38:19,359
if we go on google and you find out

2856
02:38:19,359 --> 02:38:22,479
this is the hypertext coffee bot control

2857
02:38:22,479 --> 02:38:24,560
protocol all right

2858
02:38:24,560 --> 02:38:27,120
it was an april fool's prank but it's an

2859
02:38:27,120 --> 02:38:29,920
actual rfc how to control coffee pots

2860
02:38:29,920 --> 02:38:31,760
using hd

2861
02:38:31,760 --> 02:38:34,080
http it's a protocol

2862
02:38:34,080 --> 02:38:37,600
used similar to http to talk to

2863
02:38:37,600 --> 02:38:40,840
coffee pots all right

2864
02:38:40,840 --> 02:38:42,640
and

2865
02:38:42,640 --> 02:38:44,880
we can see here

2866
02:38:44,880 --> 02:38:47,920
and and let's try to find out where the

2867
02:38:47,920 --> 02:38:49,359
bug is

2868
02:38:49,359 --> 02:38:52,399
right do you guys have an idea where

2869
02:38:52,399 --> 02:38:55,200
directly in the code the book is you

2870
02:38:55,200 --> 02:38:59,040
guys have a line for example

2871
02:39:00,800 --> 02:39:03,840
if anybody found it

2872
02:39:05,600 --> 02:39:09,760
line 81 where it is taking your input

2873
02:39:09,760 --> 02:39:13,680
and running echo next to it that may be

2874
02:39:13,680 --> 02:39:14,800
correct

2875
02:39:14,800 --> 02:39:16,720
so we can verify because i have the

2876
02:39:16,720 --> 02:39:18,960
write-up right here so we can actually

2877
02:39:18,960 --> 02:39:22,160
walk through the write-up

2878
02:39:22,560 --> 02:39:26,399
let's see here uh

2879
02:39:26,640 --> 02:39:30,240
can i get my hands

2880
02:39:31,680 --> 02:39:34,319
on the write-up

2881
02:39:35,840 --> 02:39:39,200
so it turns out it turns out that the

2882
02:39:39,200 --> 02:39:41,680
only bug

2883
02:39:41,680 --> 02:39:43,520
or the only known bug

2884
02:39:43,520 --> 02:39:46,399
is this line actually

2885
02:39:46,399 --> 02:39:50,000
echo edition count plus one

2886
02:39:50,000 --> 02:39:51,600
okay

2887
02:39:51,600 --> 02:39:54,160
85

2888
02:39:54,240 --> 02:39:56,640
well it's 87 on my annoying which is

2889
02:39:56,640 --> 02:39:57,520
this

2890
02:39:57,520 --> 02:39:58,720
this double

2891
02:39:58,720 --> 02:40:00,240
double brackets you see how all of them

2892
02:40:00,240 --> 02:40:02,399
are curly brace except this one is

2893
02:40:02,399 --> 02:40:03,520
double

2894
02:40:03,520 --> 02:40:06,319
double bracket double curved bracket so

2895
02:40:06,319 --> 02:40:08,640
that indicates

2896
02:40:08,640 --> 02:40:10,560
that indicates that that this is not

2897
02:40:10,560 --> 02:40:13,279
being filtered properly okay and so to

2898
02:40:13,279 --> 02:40:15,840
exploit the bugs the attacker could send

2899
02:40:15,840 --> 02:40:17,920
this value as an initial ingredient

2900
02:40:17,920 --> 02:40:19,359
count

2901
02:40:19,359 --> 02:40:21,840
okay

2902
02:40:24,240 --> 02:40:25,920
it clears out the file due to error one

2903
02:40:25,920 --> 02:40:27,680
plus one well

2904
02:40:27,680 --> 02:40:29,840
what happens is that you could you could

2905
02:40:29,840 --> 02:40:32,399
pass this as an ingredient count

2906
02:40:32,399 --> 02:40:35,120
you can cut all the pots grab grip the

2907
02:40:35,120 --> 02:40:36,160
flag

2908
02:40:36,160 --> 02:40:38,319
and store them in a pot that you control

2909
02:40:38,319 --> 02:40:41,279
pot one two three four

2910
02:40:41,279 --> 02:40:42,160
okay

2911
02:40:42,160 --> 02:40:43,760
and then

2912
02:40:43,760 --> 02:40:45,680
you have to add you have to ask the

2913
02:40:45,680 --> 02:40:47,359
surface to add one more ingredient and

2914
02:40:47,359 --> 02:40:50,319
then that command gets executed

2915
02:40:50,319 --> 02:40:51,439
okay

2916
02:40:51,439 --> 02:40:53,200
this is a very simple very simple

2917
02:40:53,200 --> 02:40:55,680
example of the exploit all right is that

2918
02:40:55,680 --> 02:40:58,240
you're you're trying to create

2919
02:40:58,240 --> 02:40:59,920
a

2920
02:40:59,920 --> 02:41:01,520
you're trying to add

2921
02:41:01,520 --> 02:41:03,920
an ingredient rum how much of that

2922
02:41:03,920 --> 02:41:05,520
ingredient are you adding well you're

2923
02:41:05,520 --> 02:41:07,680
adding this and you're injecting the

2924
02:41:07,680 --> 02:41:11,040
command cat pot slash grip flag and put

2925
02:41:11,040 --> 02:41:13,200
it in a pot that you control pot one two

2926
02:41:13,200 --> 02:41:14,560
three four

2927
02:41:14,560 --> 02:41:15,680
okay

2928
02:41:15,680 --> 02:41:17,680
then you're creating some random pot and

2929
02:41:17,680 --> 02:41:20,000
you're telling it to create that that

2930
02:41:20,000 --> 02:41:21,600
cough that coffee pot with that

2931
02:41:21,600 --> 02:41:24,560
ingredient and you can now go and grab

2932
02:41:24,560 --> 02:41:27,200
pot one two three four

2933
02:41:27,200 --> 02:41:29,600
okay you can now grab

2934
02:41:29,600 --> 02:41:32,399
the pot one two three four and take

2935
02:41:32,399 --> 02:41:37,599
the uh uh grab the flags from it okay

2936
02:41:38,000 --> 02:41:40,560
you guys sometimes you're just like what

2937
02:41:40,560 --> 02:41:41,920
is happening so let's just go to coffee

2938
02:41:41,920 --> 02:41:43,520
pot okay it's on port three two five

2939
02:41:43,520 --> 02:41:47,800
five right so 10.60.10.3.3255

2940
02:41:49,359 --> 02:41:50,160
okay

2941
02:41:50,160 --> 02:41:52,640
you can see that you can add

2942
02:41:52,640 --> 02:41:54,000
all right so let's choose a part let's

2943
02:41:54,000 --> 02:41:57,120
choose part 100 okay we're going to set

2944
02:41:57,120 --> 02:41:58,800
right and we should actually open open

2945
02:41:58,800 --> 02:42:00,560
the network here so we can see requests

2946
02:42:00,560 --> 02:42:03,359
that are being made so you you did set

2947
02:42:03,359 --> 02:42:04,640
okay

2948
02:42:04,640 --> 02:42:05,600
and

2949
02:42:05,600 --> 02:42:09,040
you can just look at the headers so

2950
02:42:09,040 --> 02:42:13,120
you use the prop find method okay

2951
02:42:13,120 --> 02:42:14,319
and

2952
02:42:14,319 --> 02:42:17,040
you just you just initiated part 100

2953
02:42:17,040 --> 02:42:18,080
you're like i'm going to create a part

2954
02:42:18,080 --> 02:42:21,920
called plot 100 and like okay

2955
02:42:23,439 --> 02:42:25,520
and now we're going to add

2956
02:42:25,520 --> 02:42:27,680
we're going to add

2957
02:42:27,680 --> 02:42:32,080
so 1 2 3 4 of rom and it's trying to

2958
02:42:32,080 --> 02:42:35,359
give us give us a sample a sample flag

2959
02:42:35,359 --> 02:42:36,640
a sample flag okay we're just going to

2960
02:42:36,640 --> 02:42:38,240
keep this as is

2961
02:42:38,240 --> 02:42:41,840
and then we're going to start

2962
02:42:42,000 --> 02:42:44,560
so you can see that we see brew

2963
02:42:44,560 --> 02:42:48,240
and then it does profile one more time

2964
02:42:49,040 --> 02:42:51,040
and and there you go okay so it's

2965
02:42:51,040 --> 02:42:54,319
brewing right now so pot 100 information

2966
02:42:54,319 --> 02:42:56,880
brewing

2967
02:42:57,600 --> 02:42:59,840
okay

2968
02:43:00,640 --> 02:43:03,200
any any other questions and we can stop

2969
02:43:03,200 --> 02:43:04,240
it

2970
02:43:04,240 --> 02:43:06,319
and it just says nope okay looks like we

2971
02:43:06,319 --> 02:43:08,800
can't look looks like we can't stop and

2972
02:43:08,800 --> 02:43:10,720
we can keep adding

2973
02:43:10,720 --> 02:43:13,200
adding ingredients right here

2974
02:43:13,200 --> 02:43:17,359
okay put using the put we're adding rum

2975
02:43:20,720 --> 02:43:23,359
and that's pretty much it

2976
02:43:23,359 --> 02:43:25,520
because i probably like what and and

2977
02:43:25,520 --> 02:43:27,600
what is happening right now

2978
02:43:27,600 --> 02:43:28,960
well

2979
02:43:28,960 --> 02:43:31,600
let's see what is inside so let's let's

2980
02:43:31,600 --> 02:43:33,840
try to do this so curl thank okay we're

2981
02:43:33,840 --> 02:43:36,479
going to do dash x prop find

2982
02:43:36,479 --> 02:43:38,479
okay

2983
02:43:38,479 --> 02:43:41,479
10.60.100.33255

2984
02:43:44,720 --> 02:43:45,600
pot

2985
02:43:45,600 --> 02:43:47,600
100.

2986
02:43:47,600 --> 02:43:49,680
this tells us it gives us the

2987
02:43:49,680 --> 02:43:52,080
information about this pot that's what

2988
02:43:52,080 --> 02:43:55,840
it does so we have one almond milk three

2989
02:43:55,840 --> 02:43:57,840
one whole milk three almonds four risky

2990
02:43:57,840 --> 02:43:59,840
six rum the flag temperature and the

2991
02:43:59,840 --> 02:44:01,439
state

2992
02:44:01,439 --> 02:44:03,120
so you can if you can do command

2993
02:44:03,120 --> 02:44:04,800
injection and you can create your own

2994
02:44:04,800 --> 02:44:06,880
pot you can change one of these to

2995
02:44:06,880 --> 02:44:09,040
contain just a list of flags and that's

2996
02:44:09,040 --> 02:44:12,160
exactly what we're trying to do

2997
02:44:12,560 --> 02:44:15,359
the amount that we're adding

2998
02:44:15,359 --> 02:44:17,200
we're injecting into the amount that

2999
02:44:17,200 --> 02:44:18,720
we're adding okay that's that's where

3000
02:44:18,720 --> 02:44:20,720
the command injection happens

3001
02:44:20,720 --> 02:44:22,960
here

3002
02:44:25,120 --> 02:44:26,880
it would be better if i had burp or

3003
02:44:26,880 --> 02:44:27,920
something

3004
02:44:27,920 --> 02:44:30,920
uh

3005
02:44:33,920 --> 02:44:37,880
let's try to find the put request

3006
02:44:47,600 --> 02:44:50,640
okay you see this accept additions

3007
02:44:50,640 --> 02:44:52,560
so we're trying to tell it to brew and

3008
02:44:52,560 --> 02:44:54,000
what are we brewing

3009
02:44:54,000 --> 02:44:55,439
we're brewing and then there's a header

3010
02:44:55,439 --> 02:44:57,200
called accept additions

3011
02:44:57,200 --> 02:44:58,479
okay

3012
02:44:58,479 --> 02:45:00,720
and it's putting whole milk one of old

3013
02:45:00,720 --> 02:45:03,600
milk almond 2 whisky 3 rum 4 all right

3014
02:45:03,600 --> 02:45:05,840
and so the x the vulnerability is this

3015
02:45:05,840 --> 02:45:08,240
count this number this number right here

3016
02:45:08,240 --> 02:45:11,439
as it tries to process it

3017
02:45:12,840 --> 02:45:16,880
okay it comes here and when it comes to

3018
02:45:16,880 --> 02:45:18,479
run it that actually creates a command

3019
02:45:18,479 --> 02:45:19,760
injection

3020
02:45:19,760 --> 02:45:22,080
that count that you send

3021
02:45:22,080 --> 02:45:23,920
i might not be making sense am i making

3022
02:45:23,920 --> 02:45:28,760
sense i don't know if i'm making sense

3023
02:45:34,800 --> 02:45:37,439
do you guys get me do you not get me

3024
02:45:37,439 --> 02:45:39,600
are you kind of confused are you like

3025
02:45:39,600 --> 02:45:43,840
show us the exploit and we'll understand

3026
02:45:47,600 --> 02:45:50,399
confused okay

3027
02:45:51,600 --> 02:45:54,960
all right okay i saw that coming um

3028
02:45:54,960 --> 02:45:58,560
okay so

3029
02:45:59,279 --> 02:46:00,319
uh

3030
02:46:00,319 --> 02:46:02,160
let's let's let's map it out in text

3031
02:46:02,160 --> 02:46:04,399
okay

3032
02:46:04,640 --> 02:46:07,359
what can we do so we can prop find

3033
02:46:07,359 --> 02:46:10,240
okay and a url pot

3034
02:46:10,240 --> 02:46:12,880
and some number here this

3035
02:46:12,880 --> 02:46:14,880
gives information

3036
02:46:14,880 --> 02:46:16,560
about

3037
02:46:16,560 --> 02:46:18,240
what okay

3038
02:46:18,240 --> 02:46:20,000
what else can we do

3039
02:46:20,000 --> 02:46:22,479
we can

3040
02:46:22,640 --> 02:46:24,800
looking at these requests right here

3041
02:46:24,800 --> 02:46:28,640
we can use the request brew

3042
02:46:28,640 --> 02:46:30,960
okay slash pot

3043
02:46:30,960 --> 02:46:32,640
xxx

3044
02:46:32,640 --> 02:46:33,840
starts

3045
02:46:33,840 --> 02:46:36,840
brewing the pot

3046
02:46:36,840 --> 02:46:38,800
okay

3047
02:46:38,800 --> 02:46:41,120
however when we brew pay attention to

3048
02:46:41,120 --> 02:46:43,120
brew when we brew there is a heading

3049
02:46:43,120 --> 02:46:45,680
called accept additions which lets us

3050
02:46:45,680 --> 02:46:48,000
specify the initial number

3051
02:46:48,000 --> 02:46:48,960
of

3052
02:46:48,960 --> 02:46:50,720
ingredients so this i'm going to tab

3053
02:46:50,720 --> 02:46:53,200
here and make accept addition

3054
02:46:53,200 --> 02:46:57,840
lets us specify the number

3055
02:46:59,359 --> 02:47:00,800
of each

3056
02:47:00,800 --> 02:47:03,040
ingredient

3057
02:47:03,040 --> 02:47:04,399
then finally

3058
02:47:04,399 --> 02:47:05,760
we have

3059
02:47:05,760 --> 02:47:07,279
the put method

3060
02:47:07,279 --> 02:47:09,439
put right here somewhere right here come

3061
02:47:09,439 --> 02:47:11,120
on

3062
02:47:11,120 --> 02:47:13,680
put we have put

3063
02:47:13,680 --> 02:47:17,680
slashpot xxx

3064
02:47:18,240 --> 02:47:20,720
allows us to add

3065
02:47:20,720 --> 02:47:22,560
ingredients

3066
02:47:22,560 --> 02:47:26,000
into already existing pots

3067
02:47:26,000 --> 02:47:28,399
what header does it take it takes an

3068
02:47:28,399 --> 02:47:30,399
addition header which

3069
02:47:30,399 --> 02:47:33,439
the type of vulnera the

3070
02:47:33,439 --> 02:47:36,960
type of ingredient

3071
02:47:37,439 --> 02:47:40,319
to increment it just increments it

3072
02:47:40,319 --> 02:47:41,680
okay so maybe let's just put some

3073
02:47:41,680 --> 02:47:44,800
separation here between these lines

3074
02:47:44,800 --> 02:47:46,880
there we go okay these are the three

3075
02:47:46,880 --> 02:47:49,040
things that you can do

3076
02:47:49,040 --> 02:47:50,160
okay

3077
02:47:50,160 --> 02:47:52,479
you you do http request prop find you

3078
02:47:52,479 --> 02:47:55,040
get information you can brew a pot and

3079
02:47:55,040 --> 02:47:56,319
it takes a header called accept

3080
02:47:56,319 --> 02:47:58,560
additions and you specify the number of

3081
02:47:58,560 --> 02:47:59,920
each ingredient

3082
02:47:59,920 --> 02:48:02,080
or you can and then you can while while

3083
02:48:02,080 --> 02:48:04,319
something is already brewing or before

3084
02:48:04,319 --> 02:48:06,479
it even brews you can put

3085
02:48:06,479 --> 02:48:09,040
and add ingredients into that existing

3086
02:48:09,040 --> 02:48:09,840
pot

3087
02:48:09,840 --> 02:48:11,439
okay and the addition

3088
02:48:11,439 --> 02:48:13,760
addition header let's specify the type

3089
02:48:13,760 --> 02:48:15,359
of ingredient

3090
02:48:15,359 --> 02:48:18,000
so for example for example

3091
02:48:18,000 --> 02:48:20,240
let's come here i'm going to set my pot

3092
02:48:20,240 --> 02:48:22,080
to 500

3093
02:48:22,080 --> 02:48:23,520
all right i'm gonna have zero of

3094
02:48:23,520 --> 02:48:26,160
everything and i'm gonna start brewing

3095
02:48:26,160 --> 02:48:28,080
okay

3096
02:48:28,080 --> 02:48:31,840
then i can i want to add let's say one

3097
02:48:31,840 --> 02:48:34,240
milk okay so let's look at the latest

3098
02:48:34,240 --> 02:48:37,279
request that's going to happen

3099
02:48:37,279 --> 02:48:39,279
click and i can come here to try to find

3100
02:48:39,279 --> 02:48:42,160
the put see what do i want to put i want

3101
02:48:42,160 --> 02:48:43,120
to put

3102
02:48:43,120 --> 02:48:45,200
whole milk

3103
02:48:45,200 --> 02:48:47,520
so that's the type of ingredient and it

3104
02:48:47,520 --> 02:48:50,479
will increment it in the code in the

3105
02:48:50,479 --> 02:48:52,880
code looking back at the code

3106
02:48:52,880 --> 02:48:54,960
okay

3107
02:48:54,960 --> 02:48:56,840
if you are trying to put

3108
02:48:56,840 --> 02:48:59,600
something okay and it's a pot that

3109
02:48:59,600 --> 02:49:00,880
exists

3110
02:49:00,880 --> 02:49:03,120
okay

3111
02:49:03,120 --> 02:49:05,680
then we read the pot

3112
02:49:05,680 --> 02:49:08,479
for every single line

3113
02:49:08,479 --> 02:49:10,960
okay we split this is splitting this is

3114
02:49:10,960 --> 02:49:12,960
splitting by the

3115
02:49:12,960 --> 02:49:15,359
the the column okay because look when

3116
02:49:15,359 --> 02:49:16,880
you when you looked at the output at

3117
02:49:16,880 --> 02:49:18,479
prop find let's let's open another

3118
02:49:18,479 --> 02:49:20,640
formula let's open another terminal

3119
02:49:20,640 --> 02:49:24,319
and let's make this big

3120
02:49:24,840 --> 02:49:28,880
curl prop find

3121
02:49:28,880 --> 02:49:31,880
10.60.100.33255

3122
02:49:32,479 --> 02:49:35,279
slash spot 500.

3123
02:49:35,279 --> 02:49:38,640
right it's splitting every line by that

3124
02:49:38,640 --> 02:49:41,279
that that colon right there okay

3125
02:49:41,279 --> 02:49:43,200
so the addition is what we're trying to

3126
02:49:43,200 --> 02:49:44,240
add okay

3127
02:49:44,240 --> 02:49:46,399
if addition

3128
02:49:46,399 --> 02:49:48,319
is not equal to what we're trying to add

3129
02:49:48,319 --> 02:49:51,520
so remember how how we send we send the

3130
02:49:51,520 --> 02:49:53,359
http edition

3131
02:49:53,359 --> 02:49:55,279
in the uh

3132
02:49:55,279 --> 02:49:56,960
in the header this one the addition

3133
02:49:56,960 --> 02:49:57,920
header

3134
02:49:57,920 --> 02:50:00,880
addition header so it's checking

3135
02:50:00,880 --> 02:50:02,880
we we sent for example in this case we

3136
02:50:02,880 --> 02:50:04,800
sent whole milk okay uh homework is

3137
02:50:04,800 --> 02:50:06,479
about example let's talk about ram we

3138
02:50:06,479 --> 02:50:08,560
sent to rom is this

3139
02:50:08,560 --> 02:50:12,000
ram no is this wrong no is this

3140
02:50:12,000 --> 02:50:15,439
rum no is this wrong yes

3141
02:50:15,439 --> 02:50:17,520
and then it executes so this is what

3142
02:50:17,520 --> 02:50:19,520
it's checking finally when we get to the

3143
02:50:19,520 --> 02:50:21,439
thing we do want to increment

3144
02:50:21,439 --> 02:50:24,240
it doesn't escape it properly as you can

3145
02:50:24,240 --> 02:50:25,520
see

3146
02:50:25,520 --> 02:50:28,319
this this is bad escaping

3147
02:50:28,319 --> 02:50:30,640
okay this allows us to run this actual

3148
02:50:30,640 --> 02:50:34,000
command in bash count the variable count

3149
02:50:34,000 --> 02:50:36,479
remember how look count is user input

3150
02:50:36,479 --> 02:50:40,160
it's reading our count command

3151
02:50:40,560 --> 02:50:42,880
count so when it comes to pass it to

3152
02:50:42,880 --> 02:50:44,960
this expression right here

3153
02:50:44,960 --> 02:50:47,680
this actually executes it as a bash

3154
02:50:47,680 --> 02:50:48,800
command

3155
02:50:48,800 --> 02:50:50,640
so that's why that's why the first thing

3156
02:50:50,640 --> 02:50:52,640
we have to do is specify

3157
02:50:52,640 --> 02:50:53,359
the

3158
02:50:53,359 --> 02:50:55,520
vulnerable count that's why the

3159
02:50:55,520 --> 02:50:57,760
vulnerability is in the count

3160
02:50:57,760 --> 02:50:59,120
and then when we try to add that

3161
02:50:59,120 --> 02:51:00,960
ingredient one more time our command is

3162
02:51:00,960 --> 02:51:02,399
executed

3163
02:51:02,399 --> 02:51:05,120
now are you getting closer

3164
02:51:05,120 --> 02:51:07,760
to understanding what's happening

3165
02:51:07,760 --> 02:51:10,080
yes

3166
02:51:12,640 --> 02:51:15,040
yes okay that's that's great so let me

3167
02:51:15,040 --> 02:51:16,800
let me show you this in practice let's

3168
02:51:16,800 --> 02:51:18,960
do it from the command line step by step

3169
02:51:18,960 --> 02:51:21,120
okay i want to

3170
02:51:21,120 --> 02:51:22,000
brew

3171
02:51:22,000 --> 02:51:25,120
i'm going to create a new part okay i'm

3172
02:51:25,120 --> 02:51:29,040
going to call this spot 1337 for example

3173
02:51:29,040 --> 02:51:29,840
okay

3174
02:51:29,840 --> 02:51:33,040
i want to brew a brand new pot

3175
02:51:33,040 --> 02:51:34,479
and

3176
02:51:34,479 --> 02:51:35,920
my headers

3177
02:51:35,920 --> 02:51:38,160
are going to be the ingredients so i'm

3178
02:51:38,160 --> 02:51:40,800
going to make

3179
02:51:43,840 --> 02:51:44,960
i just want to take a look at how the

3180
02:51:44,960 --> 02:51:46,720
ingredients look like

3181
02:51:46,720 --> 02:51:49,279
there's a brew okay accept additions

3182
02:51:49,279 --> 02:51:50,160
okay

3183
02:51:50,160 --> 02:51:52,960
so i'm going to come here

3184
02:51:53,359 --> 02:51:54,560
accept

3185
02:51:54,560 --> 02:51:56,399
additions

3186
02:51:56,399 --> 02:51:58,960
and i want to add for i'm going to use

3187
02:51:58,960 --> 02:52:02,240
the ram for example okay to exploit

3188
02:52:02,240 --> 02:52:05,840
all right so i'm gonna say rum

3189
02:52:06,240 --> 02:52:09,680
and then we're gonna copy the exploit

3190
02:52:09,680 --> 02:52:11,279
no don't launch this code that's not

3191
02:52:11,279 --> 02:52:14,240
what i wanted to do i want it to go grab

3192
02:52:14,240 --> 02:52:16,479
the exploit

3193
02:52:16,479 --> 02:52:20,240
this right here you see this

3194
02:52:25,040 --> 02:52:27,760
instead so usually what we put here is a

3195
02:52:27,760 --> 02:52:30,720
number you put a number here

3196
02:52:30,720 --> 02:52:32,880
but this time we're not putting a number

3197
02:52:32,880 --> 02:52:35,359
we're putting some sort of command bash

3198
02:52:35,359 --> 02:52:37,600
injection

3199
02:52:37,600 --> 02:52:41,120
okay and what does this do this will

3200
02:52:41,120 --> 02:52:43,279
cat parts

3201
02:52:43,279 --> 02:52:45,920
and grip the one pots that contain a

3202
02:52:45,920 --> 02:52:47,680
flag and it's going to put them in pot

3203
02:52:47,680 --> 02:52:50,479
one two three four

3204
02:52:50,479 --> 02:52:52,479
okay let's actually change this and make

3205
02:52:52,479 --> 02:52:55,760
this one three three seven zero okay so

3206
02:52:55,760 --> 02:52:57,359
a part with just one three three seven

3207
02:52:57,359 --> 02:52:59,279
and zero at the end

3208
02:52:59,279 --> 02:53:01,600
okay

3209
02:53:02,560 --> 02:53:03,680
no please

3210
02:53:03,680 --> 02:53:07,439
just let me run this in peace okay

3211
02:53:07,439 --> 02:53:09,279
that's what this is going to let us do

3212
02:53:09,279 --> 02:53:11,040
all right and i actually actually almost

3213
02:53:11,040 --> 02:53:12,960
injected myself because i was doing it

3214
02:53:12,960 --> 02:53:16,000
in double quotations and my my shell was

3215
02:53:16,000 --> 02:53:18,160
was trying to classify that okay here we

3216
02:53:18,160 --> 02:53:18,880
go

3217
02:53:18,880 --> 02:53:21,120
so now we created a pot

3218
02:53:21,120 --> 02:53:25,520
pot 1337 oh my god it exists okay

3219
02:53:25,520 --> 02:53:26,880
i'm gonna create pot one three three

3220
02:53:26,880 --> 02:53:28,080
seven one

3221
02:53:28,080 --> 02:53:29,920
okay

3222
02:53:29,920 --> 02:53:32,160
now

3223
02:53:32,319 --> 02:53:34,720
usually you would put a number here

3224
02:53:34,720 --> 02:53:36,800
okay but now we put this weird injection

3225
02:53:36,800 --> 02:53:40,240
thing all right this this bash injection

3226
02:53:40,240 --> 02:53:42,080
now when we tell

3227
02:53:42,080 --> 02:53:44,080
coffee when we tell coffee pot we want

3228
02:53:44,080 --> 02:53:45,760
to put

3229
02:53:45,760 --> 02:53:48,160
we want to put we want to increment that

3230
02:53:48,160 --> 02:53:50,319
ingredient okay in this case we're

3231
02:53:50,319 --> 02:53:53,680
incrementing in gree in the pot

3232
02:53:53,680 --> 02:53:55,439
what are we incrementing we are

3233
02:53:55,439 --> 02:53:57,040
incrementing and then we have to come

3234
02:53:57,040 --> 02:53:58,319
here and see

3235
02:53:58,319 --> 02:54:01,519
what header does it take

3236
02:54:03,920 --> 02:54:05,040
where is put

3237
02:54:05,040 --> 02:54:06,640
come on show me i put

3238
02:54:06,640 --> 02:54:10,160
oh there we go there's a put here no

3239
02:54:10,160 --> 02:54:11,040
but

3240
02:54:11,040 --> 02:54:13,040
it's called addition the addition header

3241
02:54:13,040 --> 02:54:14,240
okay

3242
02:54:14,240 --> 02:54:15,760
what

3243
02:54:15,760 --> 02:54:18,319
what ingredient

3244
02:54:18,319 --> 02:54:20,720
are you trying to to increment we want

3245
02:54:20,720 --> 02:54:23,120
to increment from

3246
02:54:23,120 --> 02:54:25,120
and so it's going to go to rom it's

3247
02:54:25,120 --> 02:54:26,720
going to read this

3248
02:54:26,720 --> 02:54:28,880
as a number and it's going to attempt to

3249
02:54:28,880 --> 02:54:30,800
increment it which is actually going to

3250
02:54:30,800 --> 02:54:33,439
end up executing our command

3251
02:54:33,439 --> 02:54:36,080
so let's run

3252
02:54:43,279 --> 02:54:45,200
it's kind of frozen for a second there

3253
02:54:45,200 --> 02:54:46,840
that's that's not

3254
02:54:46,840 --> 02:54:50,640
good i think i might have

3255
02:54:50,960 --> 02:54:52,880
messed up something but here we go we'll

3256
02:54:52,880 --> 02:54:55,839
wait for it to come back

3257
02:55:00,800 --> 02:55:02,800
do you think so you think data it's

3258
02:55:02,800 --> 02:55:05,279
waiting for data

3259
02:55:05,279 --> 02:55:08,640
you can make it verbose so

3260
02:55:08,880 --> 02:55:11,439
let's make it verbose

3261
02:55:11,439 --> 02:55:14,840
added thank you thank you so

3262
02:55:14,840 --> 02:55:18,240
much and there you go now if we go if we

3263
02:55:18,240 --> 02:55:21,199
go prop find

3264
02:55:21,920 --> 02:55:24,160
that new part we created

3265
02:55:24,160 --> 02:55:26,880
okay 13370

3266
02:55:26,880 --> 02:55:29,439
we get a list of flags it read all the

3267
02:55:29,439 --> 02:55:32,960
parts and it dumped all their flags

3268
02:55:34,800 --> 02:55:39,199
we did it command injection there you go

3269
02:55:41,439 --> 02:55:44,000
and so you can you can very easily very

3270
02:55:44,000 --> 02:55:46,319
easily write this into a python script

3271
02:55:46,319 --> 02:55:47,760
and you're going to do the same exact

3272
02:55:47,760 --> 02:55:49,680
thing again we can even run there's

3273
02:55:49,680 --> 02:55:52,160
already a python script for this so i'm

3274
02:55:52,160 --> 02:55:53,920
going to run

3275
02:55:53,920 --> 02:55:55,120
i'm going to run it i'm going to show

3276
02:55:55,120 --> 02:55:56,840
you

3277
02:55:56,840 --> 02:56:00,720
workspace ctf training services coffee

3278
02:56:00,720 --> 02:56:02,479
pot exploit

3279
02:56:02,479 --> 02:56:04,399
coffee pot exploit okay i'm gonna

3280
02:56:04,399 --> 02:56:07,119
exploit myself

3281
02:56:08,399 --> 02:56:10,960
and there you go

3282
02:56:11,520 --> 02:56:13,920
and i can immediately immediately take

3283
02:56:13,920 --> 02:56:16,479
this exploit right here and do the same

3284
02:56:16,479 --> 02:56:18,640
thing i did with everything else so i'm

3285
02:56:18,640 --> 02:56:20,960
going to cd into my hack in the box

3286
02:56:20,960 --> 02:56:22,960
directory and i'm going to do start

3287
02:56:22,960 --> 02:56:27,120
split and i'm going to take this okay

3288
02:56:27,120 --> 02:56:28,399
and

3289
02:56:28,399 --> 02:56:30,960
server

3290
02:56:31,760 --> 02:56:33,680
what was it was it actually server

3291
02:56:33,680 --> 02:56:35,359
address let me just pause this what was

3292
02:56:35,359 --> 02:56:36,479
it

3293
02:56:36,479 --> 02:56:39,439
server url and alias okay so i'm going

3294
02:56:39,439 --> 02:56:41,840
to go

3295
02:56:42,880 --> 02:56:45,600
server url

3296
02:56:45,600 --> 02:56:49,600
http 10.60 100.3

3297
02:56:49,600 --> 02:56:52,880
on port 5000 that's where

3298
02:56:52,880 --> 02:56:54,479
destructive farm is running

3299
02:56:54,479 --> 02:56:55,680
and alias

3300
02:56:55,680 --> 02:56:57,279
this is

3301
02:56:57,279 --> 02:56:59,840
coffee pot

3302
02:57:03,359 --> 02:57:05,200
and so it's already complaining because

3303
02:57:05,200 --> 02:57:07,200
it's like please use a shebang at the

3304
02:57:07,200 --> 02:57:10,080
top of your script so let's take that

3305
02:57:10,080 --> 02:57:12,160
and please print the new line and call

3306
02:57:12,160 --> 02:57:13,760
flush

3307
02:57:13,760 --> 02:57:14,880
okay

3308
02:57:14,880 --> 02:57:15,760
so

3309
02:57:15,760 --> 02:57:17,680
let's edit our exploit very quickly to

3310
02:57:17,680 --> 02:57:20,080
do that

3311
02:57:20,640 --> 02:57:21,920
so at the top here you're going to put

3312
02:57:21,920 --> 02:57:23,760
the shebang

3313
02:57:23,760 --> 02:57:25,439
and at the bottom

3314
02:57:25,439 --> 02:57:28,319
you're going to print

3315
02:57:28,319 --> 02:57:31,039
you're going to flush

3316
02:57:31,200 --> 02:57:33,359
equal true

3317
02:57:33,359 --> 02:57:34,880
there you go

3318
02:57:34,880 --> 02:57:37,839
okay

3319
02:57:39,439 --> 02:57:41,439
let's just make sure that got put yeah

3320
02:57:41,439 --> 02:57:44,240
all right there you go

3321
02:57:45,200 --> 02:57:48,240
now we can try

3322
02:57:48,560 --> 02:57:50,720
and there you go that is a lot of flags

3323
02:57:50,720 --> 02:57:53,439
oh dear god

3324
02:57:53,439 --> 02:57:55,279
and there you go again go to your

3325
02:57:55,279 --> 02:57:57,760
destructive form refresh now you're now

3326
02:57:57,760 --> 02:58:00,080
i'm stealing flags from coffee pot

3327
02:58:00,080 --> 02:58:01,600
i'm stealing a hell lot of flags from

3328
02:58:01,600 --> 02:58:04,840
coffee pot

3329
02:58:06,000 --> 02:58:09,439
that is oh my god that's like eight

3330
02:58:09,520 --> 02:58:12,000
ten pages of coffee pot flax

3331
02:58:12,000 --> 02:58:14,640
what happened

3332
02:58:15,200 --> 02:58:16,800
oh wow okay

3333
02:58:16,800 --> 02:58:19,600
that is that is that is uh that is

3334
02:58:19,600 --> 02:58:21,279
impressive of course most of them are

3335
02:58:21,279 --> 02:58:24,080
old flags as you can see you know

3336
02:58:24,080 --> 02:58:25,600
but that's fine

3337
02:58:25,600 --> 02:58:27,920
all right so we'll come here and

3338
02:58:27,920 --> 02:58:30,000
you'll see that i am now capturing

3339
02:58:30,000 --> 02:58:32,800
coffee pot flags

3340
02:58:32,800 --> 02:58:36,000
so i'm still constantly exploiting

3341
02:58:36,000 --> 02:58:38,640
again nasaras of nasarasa flags both

3342
02:58:38,640 --> 02:58:40,800
from the database and from the service

3343
02:58:40,800 --> 02:58:43,439
and i am exploiting i am now exploiting

3344
02:58:43,439 --> 02:58:45,600
coffee pot flags now you might be

3345
02:58:45,600 --> 02:58:46,479
wondering

3346
02:58:46,479 --> 02:58:50,160
how can i fix this well

3347
02:58:52,800 --> 02:58:56,000
no no they did fix it look

3348
02:58:56,000 --> 02:58:59,840
uh red rocket they only lost 33 35 flags

3349
02:58:59,840 --> 02:59:02,000
this team only lost no flags they

3350
02:59:02,000 --> 02:59:03,920
patched it immediately and the other

3351
02:59:03,920 --> 02:59:06,399
teams are losing much less flags

3352
02:59:06,399 --> 02:59:08,640
okay so very quickly i can just come

3353
02:59:08,640 --> 02:59:10,880
here and i think the way to fix this is

3354
02:59:10,880 --> 02:59:11,920
just to

3355
02:59:11,920 --> 02:59:15,240
make this

3356
02:59:15,520 --> 02:59:17,520
double brace like this if i understood

3357
02:59:17,520 --> 02:59:19,920
if i remember bash correctly

3358
02:59:19,920 --> 02:59:23,760
is my bash knowledge correct

3359
02:59:27,040 --> 02:59:30,399
i think that's the way to fix it

3360
02:59:31,120 --> 02:59:34,800
just make it the same as everything

3361
02:59:40,479 --> 02:59:42,479
well i'll leave that up to you guys to

3362
02:59:42,479 --> 02:59:44,399
to double check

3363
02:59:44,399 --> 02:59:46,960
you guys can see why this is a a bug in

3364
02:59:46,960 --> 02:59:49,680
google how to make it uh

3365
02:59:49,680 --> 02:59:50,880
uh

3366
02:59:50,880 --> 02:59:52,399
how to make it patch but i'm i'm

3367
02:59:52,399 --> 02:59:54,640
assuming it's the curly brace again my

3368
02:59:54,640 --> 02:59:57,920
bash experience is not it's not amazing

3369
02:59:57,920 --> 02:59:59,439
but yeah

3370
02:59:59,439 --> 03:00:01,680
and that's coffee pot for you so again i

3371
03:00:01,680 --> 03:00:03,200
i know i know this might be a little bit

3372
03:00:03,200 --> 03:00:04,960
scary you're like okay one second we

3373
03:00:04,960 --> 03:00:07,920
were dealing with openmysql databases

3374
03:00:07,920 --> 03:00:09,520
and

3375
03:00:09,520 --> 03:00:11,680
you were we were we were dealing with

3376
03:00:11,680 --> 03:00:14,080
mysql databases and just very simple

3377
03:00:14,080 --> 03:00:16,640
obvious things now all of a sudden this

3378
03:00:16,640 --> 03:00:18,399
is very scary i don't know what's

3379
03:00:18,399 --> 03:00:20,160
happening how was i supposed to find

3380
03:00:20,160 --> 03:00:21,680
that how was i supposed to understand

3381
03:00:21,680 --> 03:00:24,319
that but most of you had the correct

3382
03:00:24,319 --> 03:00:27,040
idea most of you knew it was rce you

3383
03:00:27,040 --> 03:00:28,560
just had to find the proper place where

3384
03:00:28,560 --> 03:00:30,560
it is and remember

3385
03:00:30,560 --> 03:00:32,960
this is a very obvious exploit in your

3386
03:00:32,960 --> 03:00:35,920
pickup logs you will see this exploit

3387
03:00:35,920 --> 03:00:38,399
and you can very easily see like okay

3388
03:00:38,399 --> 03:00:40,720
i might not understand what's happening

3389
03:00:40,720 --> 03:00:43,439
but i know they're sending requests that

3390
03:00:43,439 --> 03:00:45,840
look like this

3391
03:00:45,840 --> 03:00:47,920
okay and they're sending a request right

3392
03:00:47,920 --> 03:00:50,240
after it to add that ingredient that

3393
03:00:50,240 --> 03:00:51,760
they just poisoned

3394
03:00:51,760 --> 03:00:55,439
so i'm going to just copy the same thing

3395
03:00:55,439 --> 03:00:58,160
all right so you might you don't need to

3396
03:00:58,160 --> 03:01:00,160
always constantly understand what the

3397
03:01:00,160 --> 03:01:01,680
bug is

3398
03:01:01,680 --> 03:01:03,600
there's always the defensive side you

3399
03:01:03,600 --> 03:01:05,359
can run so most of you right now i'm

3400
03:01:05,359 --> 03:01:07,120
running these exploit scripts right now

3401
03:01:07,120 --> 03:01:09,520
most of you right now can just go

3402
03:01:09,520 --> 03:01:12,720
and have uh

3403
03:01:13,200 --> 03:01:14,800
you you can't uh

3404
03:01:14,800 --> 03:01:16,000
current

3405
03:01:16,000 --> 03:01:18,080
current running okay

3406
03:01:18,080 --> 03:01:19,520
and you're gonna catch these exploits

3407
03:01:19,520 --> 03:01:21,520
from me from the other teams you can

3408
03:01:21,520 --> 03:01:23,279
even take a look at how the other teams

3409
03:01:23,279 --> 03:01:24,960
are exploiting it

3410
03:01:24,960 --> 03:01:26,160
all right

3411
03:01:26,160 --> 03:01:28,160
try to do simple fixes try to do some

3412
03:01:28,160 --> 03:01:31,040
regex like twy said he's fixed it with a

3413
03:01:31,040 --> 03:01:32,880
regex filter maybe there's a way to

3414
03:01:32,880 --> 03:01:35,359
bypass that regex filter maybe there's

3415
03:01:35,359 --> 03:01:37,040
maybe you know regex is not the way to

3416
03:01:37,040 --> 03:01:38,240
go

3417
03:01:38,240 --> 03:01:40,479
so there's always there's always a way

3418
03:01:40,479 --> 03:01:42,319
you know there's always things to do

3419
03:01:42,319 --> 03:01:44,479
okay

3420
03:01:44,479 --> 03:01:46,319
okay let's let's come to the slides i

3421
03:01:46,319 --> 03:01:48,720
think that's pretty much it so we're

3422
03:01:48,720 --> 03:01:50,720
going to email you or drop in the

3423
03:01:50,720 --> 03:01:52,640
discord please join the discord again

3424
03:01:52,640 --> 03:01:54,160
we're gonna we're gonna email you or

3425
03:01:54,160 --> 03:01:55,840
drop in the discord a link to all the

3426
03:01:55,840 --> 03:01:59,040
services and the write-ups soon

3427
03:01:59,040 --> 03:02:01,680
right after this training okay please do

3428
03:02:01,680 --> 03:02:03,200
join the discord because the discord is

3429
03:02:03,200 --> 03:02:04,640
where you will be able to ask questions

3430
03:02:04,640 --> 03:02:06,800
when this training is over like how how

3431
03:02:06,800 --> 03:02:08,720
much longer the network will be up how

3432
03:02:08,720 --> 03:02:10,880
much time you guys have before we take

3433
03:02:10,880 --> 03:02:12,800
down the network and all that stuff

3434
03:02:12,800 --> 03:02:15,840
feel free to use that though that link

3435
03:02:15,840 --> 03:02:17,760
to all the write-ups as a guide to help

3436
03:02:17,760 --> 03:02:19,520
you find exploits and other services

3437
03:02:19,520 --> 03:02:21,680
that you might get stuck in however i

3438
03:02:21,680 --> 03:02:23,439
would tell you there are two services

3439
03:02:23,439 --> 03:02:24,800
that we still didn't touch right now

3440
03:02:24,800 --> 03:02:27,520
health monitor and free life go take a

3441
03:02:27,520 --> 03:02:29,359
look at them try to find the exploits in

3442
03:02:29,359 --> 03:02:31,040
them steal the exploits from the other

3443
03:02:31,040 --> 03:02:33,040
teams all the exploits are running right

3444
03:02:33,040 --> 03:02:34,640
now so you should very easily be able to

3445
03:02:34,640 --> 03:02:36,720
steal experts from other teams

3446
03:02:36,720 --> 03:02:39,200
and you are encouraged to do the to do

3447
03:02:39,200 --> 03:02:40,479
it yourself

3448
03:02:40,479 --> 03:02:42,560
write the exploits yourself launch them

3449
03:02:42,560 --> 03:02:44,399
on destructive farm and just see the

3450
03:02:44,399 --> 03:02:46,000
flags pouring

3451
03:02:46,000 --> 03:02:48,479
all right the network uh as far as i

3452
03:02:48,479 --> 03:02:51,439
remember will be up maybe for one more

3453
03:02:51,439 --> 03:02:54,640
day maybe two more days again so get to

3454
03:02:54,640 --> 03:02:56,880
work on this as fast as you can do you

3455
03:02:56,880 --> 03:02:59,120
know that this stream and the previous

3456
03:02:59,120 --> 03:03:00,800
stream will be up on youtube you guys

3457
03:03:00,800 --> 03:03:02,479
can re-watch this as many times as you

3458
03:03:02,479 --> 03:03:05,359
want i i'm gonna upload the

3459
03:03:05,359 --> 03:03:08,080
powerpoint onto discord so everybody can

3460
03:03:08,080 --> 03:03:09,600
download it off discord in case you

3461
03:03:09,600 --> 03:03:11,120
missed it

3462
03:03:11,120 --> 03:03:13,359
and feel free feel free to ask questions

3463
03:03:13,359 --> 03:03:15,200
on the discord if you guys run into any

3464
03:03:15,200 --> 03:03:16,800
tools you want to use if you guys run

3465
03:03:16,800 --> 03:03:18,800
into any any other

3466
03:03:18,800 --> 03:03:21,279
uh you know questions you have about

3467
03:03:21,279 --> 03:03:23,920
ways that you can block services or

3468
03:03:23,920 --> 03:03:26,399
defend or stuff like that go ahead and

3469
03:03:26,399 --> 03:03:28,800
remember there are so many services out

3470
03:03:28,800 --> 03:03:30,160
there that you can practice on you don't

3471
03:03:30,160 --> 03:03:32,479
need to stick to these five you guys can

3472
03:03:32,479 --> 03:03:35,920
go to the ru ctfe on github

3473
03:03:35,920 --> 03:03:38,880
so let's just go

3474
03:03:39,359 --> 03:03:42,399
and you can go to the hacker dom profile

3475
03:03:42,399 --> 03:03:44,960
and you can see that for they have a lot

3476
03:03:44,960 --> 03:03:48,160
of ctfs that you can just go

3477
03:03:48,160 --> 03:03:50,960
and see every ctf has

3478
03:03:50,960 --> 03:03:53,760
um so let's go for example

3479
03:03:53,760 --> 03:03:56,479
ctf cup they have services

3480
03:03:56,479 --> 03:03:58,240
they have three services and you guys

3481
03:03:58,240 --> 03:04:00,080
can deploy them again it's just docker

3482
03:04:00,080 --> 03:04:02,160
they're all docker containers in the end

3483
03:04:02,160 --> 03:04:05,279
so go ahead run the docker containers

3484
03:04:05,279 --> 03:04:06,160
and

3485
03:04:06,160 --> 03:04:08,080
look at the write-ups look at the

3486
03:04:08,080 --> 03:04:10,720
exploits and everything and try to try

3487
03:04:10,720 --> 03:04:12,399
to solve them yourself look at the code

3488
03:04:12,399 --> 03:04:15,359
you have an endless endless repository

3489
03:04:15,359 --> 03:04:16,800
endless account of of endless

3490
03:04:16,800 --> 03:04:19,120
repositories filled with different ctfs

3491
03:04:19,120 --> 03:04:20,479
filled with different

3492
03:04:20,479 --> 03:04:22,319
services that you can keep endlessly

3493
03:04:22,319 --> 03:04:24,160
practicing on okay you don't have to be

3494
03:04:24,160 --> 03:04:26,560
stuck to these four c these four of

3495
03:04:26,560 --> 03:04:29,279
course you won't have the entire system

3496
03:04:29,279 --> 03:04:30,479
that's true

3497
03:04:30,479 --> 03:04:32,399
so you won't have a bond image and you

3498
03:04:32,399 --> 03:04:34,160
won't have all that but still you can

3499
03:04:34,160 --> 03:04:36,479
practice on on what's important which is

3500
03:04:36,479 --> 03:04:40,319
finding vulnerabilities

3501
03:04:40,319 --> 03:04:41,279
all right

3502
03:04:41,279 --> 03:04:44,399
any other questions guys

3503
03:04:47,439 --> 03:04:49,680
i'm gonna move my exploits very soon to

3504
03:04:49,680 --> 03:04:51,680
my server so they're running

3505
03:04:51,680 --> 03:04:54,880
uh all the time okay so even if these

3506
03:04:54,880 --> 03:04:57,279
other teams stop exploiting you guys

3507
03:04:57,279 --> 03:04:59,439
don't worry i'm gonna keep running

3508
03:04:59,439 --> 03:05:02,080
my exploits for coffee pot and nasa nasa

3509
03:05:02,080 --> 03:05:03,040
all right

3510
03:05:03,040 --> 03:05:04,560
but uh if you guys have any other

3511
03:05:04,560 --> 03:05:06,880
questions i'm uh i'm right here you can

3512
03:05:06,880 --> 03:05:08,240
ask them before the

3513
03:05:08,240 --> 03:05:11,200
before we call it a day

3514
03:05:11,200 --> 03:05:14,920
any questions right now

3515
03:05:26,000 --> 03:05:30,760
hey no worries i'm glad

3516
03:05:32,080 --> 03:05:34,479
okay i'm gonna assume that uh

3517
03:05:34,479 --> 03:05:35,920
uh i'm either

3518
03:05:35,920 --> 03:05:38,240
i'm either very good at explaining

3519
03:05:38,240 --> 03:05:40,399
or you guys just don't have questions uh

3520
03:05:40,399 --> 03:05:41,920
right now

3521
03:05:41,920 --> 03:05:43,680
thank you guys so much for the for the

3522
03:05:43,680 --> 03:05:45,920
kind i i enjoyed getting this session

3523
03:05:45,920 --> 03:05:48,240
with you me and ahmed so thank you so

3524
03:05:48,240 --> 03:05:50,800
much for being here we can't wait to see

3525
03:05:50,800 --> 03:05:53,600
you guys at the pre-qualifications and

3526
03:05:53,600 --> 03:05:57,120
hopefully in the next final round

3527
03:05:57,120 --> 03:05:59,680
uh hopefully so work hard go on the

3528
03:05:59,680 --> 03:06:02,479
discord ask questions we hope to see you

3529
03:06:02,479 --> 03:06:03,520
there

3530
03:06:03,520 --> 03:06:05,200
and thank you guys so much for attending

3531
03:06:05,200 --> 03:06:09,640
this session see you next time

3532
03:06:37,520 --> 03:06:39,600
you

