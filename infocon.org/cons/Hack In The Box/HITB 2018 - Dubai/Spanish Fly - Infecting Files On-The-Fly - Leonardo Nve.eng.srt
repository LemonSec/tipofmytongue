1
00:00:24,460 --> 00:00:32,950
thank you very<font color="#E5E5E5"> much okay okay I'm I'm</font>

2
00:00:32,200 --> 00:00:38,040
Leonardo

3
00:00:32,950 --> 00:00:42,989
I work as a<font color="#E5E5E5"> routine leader with a team</font>

4
00:00:38,040 --> 00:00:46,059
were also do pen testers<font color="#E5E5E5"> when testing</font>

5
00:00:42,989 --> 00:00:50,080
<font color="#CCCCCC">also in a training</font><font color="#E5E5E5"> of hacking technique</font>

6
00:00:46,059 --> 00:00:55,420
is security research<font color="#E5E5E5"> it's always on the</font>

7
00:00:50,080 --> 00:00:58,989
on offensive security because is funnier

8
00:00:55,420 --> 00:01:02,049
than<font color="#CCCCCC"> the defensive security and I</font>

9
00:00:58,989 --> 00:01:06,880
naturally from Spain and Equatorial

10
00:01:02,049 --> 00:01:13,110
<font color="#E5E5E5">Guinea mix it so I'm very proud of my</font>

11
00:01:06,880 --> 00:01:18,060
countries why I'm talking about

12
00:01:13,110 --> 00:01:23,439
<font color="#E5E5E5">infecting files because still nowadays</font>

13
00:01:18,060 --> 00:01:29,410
you can find<font color="#CCCCCC"> websites with popular</font>

14
00:01:23,439 --> 00:01:34,589
<font color="#E5E5E5">software that lets you to download via</font>

15
00:01:29,410 --> 00:01:38,830
HTTP<font color="#CCCCCC"> without any encryption</font><font color="#E5E5E5"> for example</font>

16
00:01:34,590 --> 00:01:39,310
VLC<font color="#CCCCCC"> or visit whenever</font><font color="#E5E5E5"> you want to to</font>

17
00:01:38,830 --> 00:01:45,250
call

18
00:01:39,310 --> 00:01:49,120
it's a very popular<font color="#E5E5E5"> video player</font><font color="#CCCCCC"> you can</font>

19
00:01:45,250 --> 00:01:51,580
still download it using HTTP for<font color="#E5E5E5"> example</font>

20
00:01:49,120 --> 00:01:53,440
if you<font color="#E5E5E5"> go to the main</font><font color="#CCCCCC"> webpage and</font><font color="#E5E5E5"> you</font>

21
00:01:51,580 --> 00:01:55,990
<font color="#CCCCCC">hit download</font>

22
00:01:53,440 --> 00:02:02,830
there are several<font color="#E5E5E5"> mirrors some mirror</font>

23
00:01:55,990 --> 00:02:06,850
<font color="#E5E5E5">are HTTP</font><font color="#CCCCCC"> HTTPS and another mirrors for</font>

24
00:02:02,830 --> 00:02:11,379
example that one from from Spain<font color="#E5E5E5"> is</font>

25
00:02:06,850 --> 00:02:15,730
still HTTP<font color="#E5E5E5"> you have</font><font color="#CCCCCC"> also one mirror of</font>

26
00:02:11,379 --> 00:02:20,579
the own domain called<font color="#E5E5E5"> download with your</font>

27
00:02:15,730 --> 00:02:26,649
<font color="#E5E5E5">LAN that</font><font color="#CCCCCC"> all is also</font><font color="#E5E5E5"> HTTP also if anyone</font>

28
00:02:20,580 --> 00:02:31,529
<font color="#E5E5E5">wants</font><font color="#CCCCCC"> to download this program</font><font color="#E5E5E5"> from the</font>

29
00:02:26,650 --> 00:02:34,569
original source<font color="#E5E5E5"> he will do using HTTP</font>

30
00:02:31,529 --> 00:02:36,040
<font color="#CCCCCC">older plot of or other platform for</font>

31
00:02:34,569 --> 00:02:38,859
<font color="#E5E5E5">example to run low</font>

32
00:02:36,040 --> 00:02:43,090
<font color="#E5E5E5">windows the secret evil is a media if</font>

33
00:02:38,860 --> 00:02:48,239
you<font color="#E5E5E5"> download some drivers you are going</font>

34
00:02:43,090 --> 00:02:48,239
to download<font color="#CCCCCC"> it</font><font color="#E5E5E5"> using HTTP and</font><font color="#CCCCCC"> encrypted</font>

35
00:02:48,930 --> 00:02:59,610
this is how it must<font color="#E5E5E5"> be</font><font color="#CCCCCC"> https encrypted</font>

36
00:02:56,040 --> 00:03:03,459
<font color="#CCCCCC">okay</font><font color="#E5E5E5"> real while everyone is</font><font color="#CCCCCC"> ok with</font><font color="#E5E5E5"> that</font>

37
00:02:59,610 --> 00:03:06,430
<font color="#E5E5E5">but the problem</font><font color="#CCCCCC"> for example with</font><font color="#E5E5E5"> ultra</font>

38
00:03:03,459 --> 00:03:11,099
<font color="#CCCCCC">Rubini</font><font color="#E5E5E5"> see also</font><font color="#CCCCCC"> a popular program</font><font color="#E5E5E5"> is</font>

39
00:03:06,430 --> 00:03:14,470
that the download<font color="#E5E5E5"> page half this is</font>

40
00:03:11,099 --> 00:03:22,738
reference<font color="#CCCCCC"> when you click download is a</font>

41
00:03:14,470 --> 00:03:27,370
<font color="#E5E5E5">reference to an</font><font color="#CCCCCC"> HTTPS URL on HTTP so</font>

42
00:03:22,739 --> 00:03:31,680
every hacker security professional will

43
00:03:27,370 --> 00:03:38,980
know that<font color="#E5E5E5"> a simple SSL strip attack</font>

44
00:03:31,680 --> 00:03:42,940
<font color="#CCCCCC">can't translate that to</font><font color="#E5E5E5"> http so you are</font>

45
00:03:38,980 --> 00:03:49,839
factors with with<font color="#E5E5E5"> that the policies is</font>

46
00:03:42,940 --> 00:03:52,780
not<font color="#E5E5E5"> well implemented also when I talk</font>

47
00:03:49,840 --> 00:03:55,540
about<font color="#E5E5E5"> download files or when other</font>

48
00:03:52,780 --> 00:03:58,450
people talk about download files<font color="#E5E5E5"> they</font>

49
00:03:55,540 --> 00:04:03,790
<font color="#E5E5E5">always talk about B files</font>

50
00:03:58,450 --> 00:04:08,349
I mean<font color="#E5E5E5"> execute files Excel files but we</font>

51
00:04:03,790 --> 00:04:14,380
not only<font color="#E5E5E5"> download Excel files</font><font color="#CCCCCC"> we only we</font>

52
00:04:08,349 --> 00:04:21,389
also<font color="#E5E5E5"> download</font><font color="#CCCCCC"> sit files for example the</font>

53
00:04:14,380 --> 00:04:28,690
mg<font color="#E5E5E5"> 4 for</font><font color="#CCCCCC"> MCOs document files of office</font>

54
00:04:21,389 --> 00:04:33,370
<font color="#E5E5E5">PDFs as a security professional probably</font>

55
00:04:28,690 --> 00:04:37,419
we take care<font color="#E5E5E5"> of where we get the</font>

56
00:04:33,370 --> 00:04:41,740
<font color="#E5E5E5">exercise but our defenses are low when</font>

57
00:04:37,419 --> 00:04:44,260
we download for example<font color="#E5E5E5"> a zip file we</font>

58
00:04:41,740 --> 00:04:45,010
don't think<font color="#E5E5E5"> that a zip file can</font><font color="#CCCCCC"> be</font>

59
00:04:44,260 --> 00:04:49,140
infected

60
00:04:45,010 --> 00:04:49,140
docx files could<font color="#CCCCCC"> be infected</font>

61
00:04:50,100 --> 00:04:59,580
so<font color="#E5E5E5"> exactly what I'm going to talk</font><font color="#CCCCCC"> about</font>

62
00:04:55,140 --> 00:05:01,930
<font color="#E5E5E5">gum</font><font color="#CCCCCC"> mark</font><font color="#E5E5E5"> and explain it</font><font color="#CCCCCC"> you know</font><font color="#E5E5E5"> that</font>

63
00:04:59,580 --> 00:05:04,590
<font color="#E5E5E5">probably you know that grandma group is</font>

64
00:05:01,930 --> 00:05:09,990
a European company<font color="#E5E5E5"> that makes</font>

65
00:05:04,590 --> 00:05:13,919
surveillance software have been hacked

66
00:05:09,990 --> 00:05:18,240
<font color="#CCCCCC">some</font><font color="#E5E5E5"> years</font><font color="#CCCCCC"> ago four years ago I think</font>

67
00:05:13,920 --> 00:05:22,780
<font color="#CCCCCC">and there was a leak and they publish</font>

68
00:05:18,240 --> 00:05:25,270
the sower and<font color="#CCCCCC"> the internal general</font>

69
00:05:22,780 --> 00:05:32,020
promotional videos for<font color="#CCCCCC"> example</font><font color="#E5E5E5"> this one</font>

70
00:05:25,270 --> 00:05:35,830
<font color="#E5E5E5">is where they they have a tool called</font>

71
00:05:32,020 --> 00:05:40,390
<font color="#E5E5E5">fin fly that to a</font><font color="#CCCCCC"> man-in-the-middle</font>

72
00:05:35,830 --> 00:05:44,620
<font color="#CCCCCC">attack and when an attacker download</font>

73
00:05:40,390 --> 00:05:49,570
<font color="#E5E5E5">something for example in a hotel they</font>

74
00:05:44,620 --> 00:05:52,270
implement<font color="#E5E5E5"> their an attack - in fact they</font>

75
00:05:49,570 --> 00:05:58,630
find they download this is<font color="#E5E5E5"> the reason</font>

76
00:05:52,270 --> 00:06:04,359
<font color="#CCCCCC">that I</font><font color="#E5E5E5"> started to research about this</font>

77
00:05:58,630 --> 00:06:07,419
how it can be<font color="#CCCCCC"> done by me</font><font color="#E5E5E5"> not with</font>

78
00:06:04,360 --> 00:06:10,810
commercial server so commercial tools

79
00:06:07,419 --> 00:06:15,310
<font color="#E5E5E5">first as I said</font><font color="#CCCCCC"> they</font><font color="#E5E5E5"> become a group so</font>

80
00:06:10,810 --> 00:06:19,240
<font color="#E5E5E5">we're Phil Fisher is</font><font color="#CCCCCC"> the back of the</font>

81
00:06:15,310 --> 00:06:23,970
tools<font color="#CCCCCC"> fin Franklin is the tool</font><font color="#E5E5E5"> to do on</font>

82
00:06:19,240 --> 00:06:28,690
the fly infections also hacking team

83
00:06:23,970 --> 00:06:33,700
have been<font color="#E5E5E5"> hot three years ago after</font>

84
00:06:28,690 --> 00:06:38,050
gamma<font color="#CCCCCC"> and the hacker</font><font color="#E5E5E5"> parties</font><font color="#CCCCCC"> did the</font>

85
00:06:33,700 --> 00:06:41,229
tools a lot of<font color="#CCCCCC"> Gyges of information with</font>

86
00:06:38,050 --> 00:06:45,520
that information<font color="#E5E5E5"> you</font><font color="#CCCCCC"> can find</font><font color="#E5E5E5"> the</font>

87
00:06:41,230 --> 00:06:48,960
network<font color="#CCCCCC"> nagar injector is it is a nice</font>

88
00:06:45,520 --> 00:06:53,080
<font color="#CCCCCC">size ally new system</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> also do that</font>

89
00:06:48,960 --> 00:06:56,198
they they had a tool to<font color="#CCCCCC"> infect</font><font color="#E5E5E5"> on the</font>

90
00:06:53,080 --> 00:07:02,050
<font color="#E5E5E5">fly files there are commercial tools</font>

91
00:06:56,199 --> 00:07:07,319
but also exists some free tools<font color="#E5E5E5"> for</font>

92
00:07:02,050 --> 00:07:12,009
example<font color="#CCCCCC"> P injector</font><font color="#E5E5E5"> the injector is a</font>

93
00:07:07,319 --> 00:07:18,069
lightweight<font color="#E5E5E5"> software</font><font color="#CCCCCC"> planned to run on</font>

94
00:07:12,009 --> 00:07:21,189
<font color="#E5E5E5">our raspberry P for</font><font color="#CCCCCC"> example</font><font color="#E5E5E5"> it allows</font>

95
00:07:18,069 --> 00:07:25,650
<font color="#E5E5E5">you to in fact</font><font color="#CCCCCC"> P files</font>

96
00:07:21,189 --> 00:07:28,060
<font color="#E5E5E5">Saku tables Windows executable files</font><font color="#CCCCCC"> ok</font>

97
00:07:25,650 --> 00:07:30,549
<font color="#CCCCCC">you have to do the man in the middle</font>

98
00:07:28,060 --> 00:07:31,719
etc the problem<font color="#CCCCCC"> of this tool is not</font>

99
00:07:30,550 --> 00:07:36,849
maintain it anymore

100
00:07:31,719 --> 00:07:39,669
<font color="#CCCCCC">I think that on github the the last</font>

101
00:07:36,849 --> 00:07:41,878
upload the<font color="#E5E5E5"> last modification is about</font>

102
00:07:39,669 --> 00:07:45,909
<font color="#E5E5E5">three years ago</font>

103
00:07:41,879 --> 00:07:48,569
it's the same with PDF or butter factory

104
00:07:45,909 --> 00:07:48,569
proxy

105
00:07:50,039 --> 00:07:56,469
it's not melting anymore

106
00:07:52,750 --> 00:08:02,259
the last medication is the last<font color="#E5E5E5"> push is</font>

107
00:07:56,469 --> 00:08:07,180
from<font color="#CCCCCC"> 2003 years</font><font color="#E5E5E5"> ago I think it in fact</font>

108
00:08:02,259 --> 00:08:12,509
not only executable files<font color="#E5E5E5"> also from from</font>

109
00:08:07,180 --> 00:08:17,319
<font color="#CCCCCC">Windows</font><font color="#E5E5E5"> also from Linux and Mac</font><font color="#CCCCCC"> Matz oh</font>

110
00:08:12,509 --> 00:08:23,740
it also in fact I didn't<font color="#CCCCCC"> read it</font>

111
00:08:17,319 --> 00:08:29,319
zip files but as I said no<font color="#CCCCCC"> Montini</font>

112
00:08:23,740 --> 00:08:33,789
anymore what<font color="#E5E5E5"> there</font><font color="#CCCCCC"> are more tools</font><font color="#E5E5E5"> that</font>

113
00:08:29,319 --> 00:08:36,539
are not<font color="#E5E5E5"> really important because also</font>

114
00:08:33,789 --> 00:08:41,169
are too<font color="#CCCCCC"> old or they have several</font><font color="#E5E5E5"> issues</font>

115
00:08:36,539 --> 00:08:44,829
<font color="#E5E5E5">normal issues iPhone on general with</font>

116
00:08:41,169 --> 00:08:48,730
that tools first<font color="#E5E5E5"> the resource of the</font>

117
00:08:44,829 --> 00:08:53,689
secret<font color="#E5E5E5"> tables of the icons some tools</font>

118
00:08:48,730 --> 00:08:59,269
<font color="#CCCCCC">what they do what they do is to</font><font color="#E5E5E5"> change</font>

119
00:08:53,690 --> 00:09:03,110
the<font color="#CCCCCC"> secret table by another so the</font>

120
00:08:59,269 --> 00:09:05,769
target<font color="#CCCCCC"> is download file</font><font color="#E5E5E5"> they change</font><font color="#CCCCCC"> this</font>

121
00:09:03,110 --> 00:09:12,620
<font color="#CCCCCC">secret table they are</font><font color="#E5E5E5"> not going to find</font>

122
00:09:05,769 --> 00:09:15,620
the<font color="#E5E5E5"> the right icon so the</font><font color="#CCCCCC"> tragedy will</font>

123
00:09:12,620 --> 00:09:19,370
detect the infection or will be

124
00:09:15,620 --> 00:09:22,069
suspicious<font color="#CCCCCC"> about that and</font><font color="#E5E5E5"> in an attack</font>

125
00:09:19,370 --> 00:09:24,920
in<font color="#E5E5E5"> a real attack in a red team or</font>

126
00:09:22,069 --> 00:09:29,889
wherever you don't want the<font color="#E5E5E5"> attacker</font>

127
00:09:24,920 --> 00:09:33,920
don't want to to to<font color="#E5E5E5"> be detected</font>

128
00:09:29,889 --> 00:09:38,029
<font color="#E5E5E5">antivirus also we are going to see that</font>

129
00:09:33,920 --> 00:09:42,410
later<font color="#CCCCCC"> the methods of infection normally</font>

130
00:09:38,029 --> 00:09:47,350
are detected by anti viruses the

131
00:09:42,410 --> 00:09:47,350
signatures of the<font color="#E5E5E5"> secret tables</font>

132
00:09:47,709 --> 00:09:57,680
sometimes I saw that the Arenal code<font color="#E5E5E5"> the</font>

133
00:09:53,420 --> 00:10:03,349
<font color="#E5E5E5">Arenal program is not executed so if you</font>

134
00:09:57,680 --> 00:10:07,430
change<font color="#E5E5E5"> the file or you infect a file the</font>

135
00:10:03,350 --> 00:10:12,100
target hit it<font color="#E5E5E5"> click on it and the</font>

136
00:10:07,430 --> 00:10:15,439
malware<font color="#E5E5E5"> is executed but the</font><font color="#CCCCCC"> original</font>

137
00:10:12,100 --> 00:10:17,480
purpose<font color="#E5E5E5"> of</font><font color="#CCCCCC"> that secure table is not it's</font>

138
00:10:15,439 --> 00:10:19,630
<font color="#E5E5E5">not done you are going to be detected of</font>

139
00:10:17,480 --> 00:10:24,130
course

140
00:10:19,630 --> 00:10:28,220
also<font color="#CCCCCC"> during</font><font color="#E5E5E5"> this research I found that</font>

141
00:10:24,130 --> 00:10:32,180
several files do auto entirety checks<font color="#CCCCCC"> I</font>

142
00:10:28,220 --> 00:10:37,100
mean for example<font color="#E5E5E5"> Videoland in Windows if</font>

143
00:10:32,180 --> 00:10:40,399
you modify the file itself when<font color="#E5E5E5"> you run</font>

144
00:10:37,100 --> 00:10:46,699
it the<font color="#CCCCCC"> VLC will detect</font><font color="#E5E5E5"> that had to be</font>

145
00:10:40,399 --> 00:10:51,230
<font color="#CCCCCC">modified and we launched an alert</font><font color="#E5E5E5"> other</font>

146
00:10:46,699 --> 00:10:52,930
problems has<font color="#E5E5E5"> us see as I said all the</font>

147
00:10:51,230 --> 00:10:59,160
files that

148
00:10:52,930 --> 00:10:59,160
we download are not executables<font color="#E5E5E5"> not all</font>

149
00:11:01,260 --> 00:11:12,790
also this one thing what do you think

150
00:11:07,529 --> 00:11:13,420
that<font color="#CCCCCC"> on-the-fly</font><font color="#E5E5E5"> means when I talking</font>

151
00:11:12,790 --> 00:11:18,569
<font color="#CCCCCC">about</font>

152
00:11:13,420 --> 00:11:22,150
in fact on<font color="#CCCCCC"> the fly what what is that</font>

153
00:11:18,570 --> 00:11:27,490
<font color="#E5E5E5">think that we are</font><font color="#CCCCCC"> doing</font><font color="#E5E5E5"> man in the</font>

154
00:11:22,150 --> 00:11:30,660
middle<font color="#E5E5E5"> as usual we</font><font color="#CCCCCC"> are diverting</font><font color="#E5E5E5"> the</font>

155
00:11:27,490 --> 00:11:34,320
communication to<font color="#CCCCCC"> approxi</font><font color="#E5E5E5"> through a proxy</font>

156
00:11:30,660 --> 00:11:38,020
so on the<font color="#E5E5E5"> fly what means</font><font color="#CCCCCC"> what our</font>

157
00:11:34,320 --> 00:11:44,260
products a proxy do normally when you

158
00:11:38,020 --> 00:11:46,770
download a file<font color="#CCCCCC"> ok</font><font color="#E5E5E5"> for example</font><font color="#CCCCCC"> ok when</font>

159
00:11:44,260 --> 00:11:50,140
we download a file<font color="#CCCCCC"> this is what happens</font>

160
00:11:46,770 --> 00:11:55,600
<font color="#CCCCCC">you see the bar the progress is cetera</font>

161
00:11:50,140 --> 00:11:57,370
cetera now think that you<font color="#CCCCCC"> are</font><font color="#E5E5E5"> on a</font>

162
00:11:55,600 --> 00:12:01,089
<font color="#CCCCCC">man-in-the-middle and now you have a</font>

163
00:11:57,370 --> 00:12:05,070
proxy<font color="#E5E5E5"> server here I'm using bulb for</font>

164
00:12:01,089 --> 00:12:08,100
example the target clicks and is waiting

165
00:12:05,070 --> 00:12:12,040
nothing happens

166
00:12:08,100 --> 00:12:14,339
tell you<font color="#E5E5E5"> you say what the fuck where</font><font color="#CCCCCC"> is</font>

167
00:12:12,040 --> 00:12:14,339
the file

168
00:12:14,459 --> 00:12:22,359
no is no file<font color="#E5E5E5"> is</font><font color="#CCCCCC"> in Europe but the</font>

169
00:12:18,580 --> 00:12:26,160
<font color="#E5E5E5">Russia is sinking that is I'm sorry</font><font color="#CCCCCC"> that</font>

170
00:12:22,360 --> 00:12:29,050
<font color="#CCCCCC">Sapir aunt</font><font color="#E5E5E5"> first we have the file so</font>

171
00:12:26,160 --> 00:12:33,100
what's the problem there<font color="#E5E5E5"> the problem</font><font color="#CCCCCC"> is</font>

172
00:12:29,050 --> 00:12:41,160
<font color="#E5E5E5">that if the file is big and we</font><font color="#CCCCCC"> are done</font>

173
00:12:33,100 --> 00:12:46,089
loading<font color="#CCCCCC"> 51 megabytes</font><font color="#E5E5E5"> the the proxy first</font>

174
00:12:41,160 --> 00:12:50,050
download the file and<font color="#CCCCCC"> then it</font><font color="#E5E5E5"> send it to</font>

175
00:12:46,089 --> 00:12:55,360
the to the target so<font color="#E5E5E5"> that does the</font><font color="#CCCCCC"> light</font>

176
00:12:50,050 --> 00:12:58,209
<font color="#E5E5E5">time this is really</font><font color="#CCCCCC"> bad because for</font>

177
00:12:55,360 --> 00:13:00,640
<font color="#CCCCCC">example in this</font><font color="#E5E5E5"> case the target can say</font>

178
00:12:58,209 --> 00:13:04,060
oh it's not<font color="#E5E5E5"> working</font><font color="#CCCCCC"> and click again and</font>

179
00:13:00,640 --> 00:13:06,329
<font color="#E5E5E5">click again on detected error so that is</font>

180
00:13:04,060 --> 00:13:10,439
not real on the

181
00:13:06,329 --> 00:13:15,868
to<font color="#CCCCCC"> download the file infect it and send</font>

182
00:13:10,439 --> 00:13:21,920
it that's not real on the fly<font color="#E5E5E5"> so that's</font>

183
00:13:15,869 --> 00:13:25,759
<font color="#CCCCCC">what this is what I'm why I explained</font>

184
00:13:21,920 --> 00:13:29,248
the client<font color="#E5E5E5"> requests the file the proxy</font>

185
00:13:25,759 --> 00:13:31,829
downloads the file<font color="#CCCCCC"> then there is a file</font>

186
00:13:29,249 --> 00:13:35,579
modification if you<font color="#CCCCCC"> infect it and then</font>

187
00:13:31,829 --> 00:13:37,679
send to<font color="#E5E5E5"> the victim that's you can</font>

188
00:13:35,579 --> 00:13:41,479
calculate more<font color="#CCCCCC"> or less the the total</font>

189
00:13:37,679 --> 00:13:47,429
time<font color="#E5E5E5"> and it depends</font><font color="#CCCCCC"> the connection speed</font>

190
00:13:41,480 --> 00:13:52,559
<font color="#E5E5E5">so if if you are on a broadband</font><font color="#CCCCCC"> the file</font>

191
00:13:47,429 --> 00:13:57,059
is not<font color="#E5E5E5"> too big</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> we can accept this</font>

192
00:13:52,559 --> 00:14:01,499
<font color="#E5E5E5">but it is too big</font><font color="#CCCCCC"> or your connection is</font>

193
00:13:57,059 --> 00:14:05,749
not very fast<font color="#CCCCCC"> if your if the attacker is</font>

194
00:14:01,499 --> 00:14:13,679
doing<font color="#E5E5E5"> a for</font><font color="#CCCCCC"> example routes ap attack</font>

195
00:14:05,749 --> 00:14:21,149
<font color="#CCCCCC">that time can be very</font><font color="#E5E5E5"> that wait sign can</font>

196
00:14:13,679 --> 00:14:25,199
<font color="#CCCCCC">be detected what</font><font color="#E5E5E5"> I purpose this</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> the</font>

197
00:14:21,149 --> 00:14:29,160
way an attacker have to do that<font color="#E5E5E5"> the</font>

198
00:14:25,199 --> 00:14:33,979
<font color="#E5E5E5">client request the file the proxy starts</font>

199
00:14:29,160 --> 00:14:39,719
to download<font color="#E5E5E5"> the data stream of that file</font>

200
00:14:33,980 --> 00:14:43,379
<font color="#CCCCCC">the proxy must modify the data stream</font><font color="#E5E5E5"> to</font>

201
00:14:39,720 --> 00:14:47,910
infect the file and send each data

202
00:14:43,379 --> 00:14:52,980
stream in the on the same way to the

203
00:14:47,910 --> 00:14:54,988
victim<font color="#E5E5E5"> so now you have you still have a</font>

204
00:14:52,980 --> 00:15:01,470
dependence in of the connection<font color="#E5E5E5"> speed</font>

205
00:14:54,989 --> 00:15:05,399
but the target the client will see the

206
00:15:01,470 --> 00:15:07,730
file downloading so it can say oh it's

207
00:15:05,399 --> 00:15:10,339
go

208
00:15:07,730 --> 00:15:13,910
slow<font color="#E5E5E5"> if you</font><font color="#CCCCCC"> are</font><font color="#E5E5E5"> using a slow connection</font>

209
00:15:10,339 --> 00:15:17,299
<font color="#CCCCCC">r3 he for example or you are</font><font color="#E5E5E5"> don't love</font>

210
00:15:13,910 --> 00:15:20,449
<font color="#E5E5E5">in our</font><font color="#CCCCCC"> really big file</font><font color="#E5E5E5"> but the client</font>

211
00:15:17,299 --> 00:15:27,169
will see the<font color="#E5E5E5"> process working the</font>

212
00:15:20,449 --> 00:15:31,639
download working finally the total<font color="#E5E5E5"> time</font>

213
00:15:27,169 --> 00:15:34,189
will be the<font color="#E5E5E5"> same of the proxy that lost</font>

214
00:15:31,639 --> 00:15:37,100
the time for my files<font color="#CCCCCC"> modification and</font>

215
00:15:34,189 --> 00:15:44,259
then send it the<font color="#E5E5E5"> total time will be the</font>

216
00:15:37,100 --> 00:15:52,249
same<font color="#E5E5E5"> but the the client will not see any</font>

217
00:15:44,259 --> 00:15:55,809
awful process there now we have to to

218
00:15:52,249 --> 00:16:00,649
know how to modify<font color="#E5E5E5"> that data stream</font>

219
00:15:55,809 --> 00:16:02,988
before<font color="#E5E5E5"> having the</font><font color="#CCCCCC"> complete file so we</font>

220
00:16:00,649 --> 00:16:13,220
are<font color="#E5E5E5"> going to see that we now</font><font color="#CCCCCC"> depends on</font>

221
00:16:02,989 --> 00:16:15,859
<font color="#E5E5E5">the file format so some facts if we know</font>

222
00:16:13,220 --> 00:16:21,529
the file format<font color="#E5E5E5"> and we know how we are</font>

223
00:16:15,859 --> 00:16:25,309
<font color="#CCCCCC">going</font><font color="#E5E5E5"> to infect it modify it we can</font>

224
00:16:21,529 --> 00:16:30,649
<font color="#CCCCCC">guest the future modification of the</font>

225
00:16:25,309 --> 00:16:34,939
file at the beginning normally<font color="#E5E5E5"> we are</font>

226
00:16:30,649 --> 00:16:39,109
using HTTP<font color="#E5E5E5"> and talking about HTTP we</font>

227
00:16:34,939 --> 00:16:45,349
know the<font color="#CCCCCC"> original size</font><font color="#E5E5E5"> of the original</font>

228
00:16:39,109 --> 00:16:47,439
file<font color="#CCCCCC"> that that size is</font><font color="#E5E5E5"> on HTTP header</font>

229
00:16:45,350 --> 00:16:55,480
content<font color="#E5E5E5"> length on the content</font><font color="#CCCCCC"> layer</font><font color="#E5E5E5"> we</font>

230
00:16:47,439 --> 00:16:59,419
we<font color="#E5E5E5"> are</font><font color="#CCCCCC"> going to see the complete decides</font>

231
00:16:55,480 --> 00:17:02,889
which are<font color="#CCCCCC"> going</font><font color="#E5E5E5"> to be the file size</font>

232
00:16:59,419 --> 00:17:06,679
which are<font color="#E5E5E5"> going to be the</font><font color="#CCCCCC"> content length</font>

233
00:17:02,889 --> 00:17:10,819
so how grow how the file will grow

234
00:17:06,679 --> 00:17:13,250
sometimes<font color="#E5E5E5"> we can know</font><font color="#CCCCCC"> that and sometimes</font>

235
00:17:10,819 --> 00:17:14,928
not<font color="#CCCCCC"> it depends on the file format we</font><font color="#E5E5E5"> are</font>

236
00:17:13,250 --> 00:17:19,130
going to see before

237
00:17:14,929 --> 00:17:22,730
also questions is<font color="#CCCCCC"> the that file</font><font color="#E5E5E5"> have a</font>

238
00:17:19,130 --> 00:17:26,270
<font color="#CCCCCC">serious</font><font color="#E5E5E5"> CRC we are going to modify that</font>

239
00:17:22,730 --> 00:17:29,179
CRC we can calculate<font color="#E5E5E5"> the CRC where the</font>

240
00:17:26,270 --> 00:17:33,408
killers<font color="#E5E5E5"> which are going to be the</font>

241
00:17:29,179 --> 00:17:38,419
hitters<font color="#E5E5E5"> or the modified file so we have</font>

242
00:17:33,409 --> 00:17:44,179
to study<font color="#E5E5E5"> file format per file marked and</font>

243
00:17:38,419 --> 00:17:48,980
I used the investigation the research of

244
00:17:44,179 --> 00:17:54,110
<font color="#CCCCCC">Ang</font><font color="#E5E5E5"> Albertini please</font><font color="#CCCCCC"> a security</font>

245
00:17:48,980 --> 00:17:59,380
researcher<font color="#CCCCCC"> and that</font><font color="#E5E5E5"> does</font><font color="#CCCCCC"> describe many</font>

246
00:17:54,110 --> 00:18:05,270
many many file formats<font color="#E5E5E5"> so I use his</font>

247
00:17:59,380 --> 00:18:13,669
research for<font color="#CCCCCC"> that ok</font><font color="#E5E5E5"> first I'm going to</font>

248
00:18:05,270 --> 00:18:18,470
talk<font color="#CCCCCC"> about P infection this</font><font color="#E5E5E5"> is the</font>

249
00:18:13,669 --> 00:18:27,640
graphic that<font color="#E5E5E5"> I'm Albertini did about the</font>

250
00:18:18,470 --> 00:18:31,480
format of the of<font color="#E5E5E5"> P</font><font color="#CCCCCC"> okay this is the same</font>

251
00:18:27,640 --> 00:18:38,570
in a<font color="#E5E5E5"> P this this a lot of documentation</font>

252
00:18:31,480 --> 00:18:41,830
<font color="#CCCCCC">you have several sections as I have a</font>

253
00:18:38,570 --> 00:18:46,549
book that<font color="#E5E5E5"> you have several</font><font color="#CCCCCC"> sections</font>

254
00:18:41,830 --> 00:18:50,270
which we<font color="#E5E5E5"> really care about</font><font color="#CCCCCC"> that if how</font>

255
00:18:46,549 --> 00:18:54,559
to add sections<font color="#CCCCCC"> to appear format and the</font>

256
00:18:50,270 --> 00:18:57,139
resource section<font color="#E5E5E5"> the</font><font color="#CCCCCC"> resource section is</font>

257
00:18:54,559 --> 00:19:02,600
important because on the modified file

258
00:18:57,140 --> 00:19:06,590
we I want to put the same icon so

259
00:19:02,600 --> 00:19:10,939
initially<font color="#E5E5E5"> I</font><font color="#CCCCCC"> started to research</font><font color="#E5E5E5"> how I</font>

260
00:19:06,590 --> 00:19:15,799
can extract an icon and then put it on

261
00:19:10,940 --> 00:19:20,000
<font color="#E5E5E5">the modified file</font><font color="#CCCCCC"> finally I saw that the</font>

262
00:19:15,799 --> 00:19:23,600
structure<font color="#E5E5E5"> is really complicated and</font><font color="#CCCCCC"> it's</font>

263
00:19:20,000 --> 00:19:24,659
not well documented<font color="#CCCCCC"> so I decided to</font>

264
00:19:23,600 --> 00:19:27,449
<font color="#E5E5E5">follow</font>

265
00:19:24,659 --> 00:19:33,809
<font color="#CCCCCC">a different way</font><font color="#E5E5E5"> and you are going</font><font color="#CCCCCC"> to see</font>

266
00:19:27,450 --> 00:19:39,179
that<font color="#E5E5E5"> okay this is what I'm going to</font>

267
00:19:33,809 --> 00:19:43,499
<font color="#CCCCCC">demonstrate</font><font color="#E5E5E5"> it is the executable</font><font color="#CCCCCC"> secret</font>

268
00:19:39,179 --> 00:19:47,669
<font color="#E5E5E5">table infection as I said the arena's a</font>

269
00:19:43,499 --> 00:19:49,889
good excel file must<font color="#E5E5E5"> be executed the</font>

270
00:19:47,669 --> 00:19:53,340
process must be desperate<font color="#CCCCCC"> for the user</font>

271
00:19:49,889 --> 00:19:57,629
<font color="#E5E5E5">to the target and I have to take care of</font>

272
00:19:53,340 --> 00:20:00,029
<font color="#CCCCCC">their file name because I won</font><font color="#E5E5E5"> the</font>

273
00:19:57,629 --> 00:20:03,658
protections<font color="#E5E5E5"> of the files one is define</font>

274
00:20:00,029 --> 00:20:07,349
<font color="#E5E5E5">name because the</font><font color="#CCCCCC"> reputation the windows</font>

275
00:20:03,659 --> 00:20:10,619
take<font color="#E5E5E5"> take care about that the digital</font>

276
00:20:07,349 --> 00:20:16,168
signature has another protection<font color="#CCCCCC"> and a</font>

277
00:20:10,619 --> 00:20:19,019
directed<font color="#E5E5E5"> check as I said option</font><font color="#CCCCCC"> one to</font>

278
00:20:16,169 --> 00:20:23,609
infect the files<font color="#CCCCCC"> this</font><font color="#E5E5E5"> is one of the</font>

279
00:20:19,019 --> 00:20:26,609
oldest way to infect<font color="#E5E5E5"> a secret rebel is</font>

280
00:20:23,609 --> 00:20:29,820
to add the malware code<font color="#E5E5E5"> at the</font><font color="#CCCCCC"> end of</font>

281
00:20:26,609 --> 00:20:32,269
the file<font color="#E5E5E5"> change the entry point on the</font>

282
00:20:29,820 --> 00:20:36,389
header of the file

283
00:20:32,269 --> 00:20:41,429
remove the digital signature<font color="#CCCCCC"> the</font><font color="#E5E5E5"> frame</font>

284
00:20:36,389 --> 00:20:44,158
<font color="#E5E5E5">the</font><font color="#CCCCCC"> final file will not be sign it the</font>

285
00:20:41,429 --> 00:20:47,309
new<font color="#CCCCCC"> College have to be executed and then</font>

286
00:20:44,159 --> 00:20:53,729
call to the original code<font color="#E5E5E5"> this is the</font>

287
00:20:47,309 --> 00:20:59,249
way the<font color="#E5E5E5"> problem with this</font><font color="#CCCCCC"> technique is</font>

288
00:20:53,729 --> 00:21:03,409
<font color="#CCCCCC">that okay</font><font color="#E5E5E5"> first you can after that if</font>

289
00:20:59,249 --> 00:21:07,889
<font color="#E5E5E5">you have a certificate to sign that file</font>

290
00:21:03,409 --> 00:21:10,950
but the<font color="#CCCCCC"> auto integrity check that some</font>

291
00:21:07,889 --> 00:21:15,779
files<font color="#E5E5E5"> have will fail this is a</font>

292
00:21:10,950 --> 00:21:18,389
well-known<font color="#E5E5E5"> method very anti viruses will</font>

293
00:21:15,779 --> 00:21:20,940
take care<font color="#E5E5E5"> of the new for the new site we</font>

294
00:21:18,389 --> 00:21:25,008
<font color="#E5E5E5">can predict because it's the arena file</font>

295
00:21:20,940 --> 00:21:28,440
<font color="#E5E5E5">plus the new code is easy to calculate</font>

296
00:21:25,009 --> 00:21:32,210
<font color="#E5E5E5">and with this method</font><font color="#CCCCCC"> you preserve the</font>

297
00:21:28,440 --> 00:21:37,610
icon there<font color="#E5E5E5"> is another matter</font>

298
00:21:32,210 --> 00:21:41,390
is to<font color="#E5E5E5"> add the Arenal file to a malware</font>

299
00:21:37,610 --> 00:21:43,790
<font color="#E5E5E5">not the malware to the renal files</font><font color="#CCCCCC"> die I</font>

300
00:21:41,390 --> 00:21:46,520
mean they're in a fight inside<font color="#E5E5E5"> the</font>

301
00:21:43,790 --> 00:21:52,760
<font color="#CCCCCC">malware in a section then the</font><font color="#E5E5E5"> malware</font>

302
00:21:46,520 --> 00:21:55,250
<font color="#E5E5E5">execute its magic and then copy that</font>

303
00:21:52,760 --> 00:21:59,180
section to external file and then

304
00:21:55,250 --> 00:22:03,350
execute this is the area you<font color="#E5E5E5"> have the</font>

305
00:21:59,180 --> 00:22:07,490
<font color="#E5E5E5">Arenal file and you put that file inside</font>

306
00:22:03,350 --> 00:22:10,250
<font color="#E5E5E5">the malware then and then to the</font><font color="#CCCCCC"> malware</font>

307
00:22:07,490 --> 00:22:15,320
you add a copy of the resource section

308
00:22:10,250 --> 00:22:23,620
<font color="#E5E5E5">with that you have the malware will have</font>

309
00:22:15,320 --> 00:22:28,100
the<font color="#E5E5E5"> icons of the of the original</font><font color="#CCCCCC"> one and</font>

310
00:22:23,620 --> 00:22:32,899
we can copy that blob section outside to

311
00:22:28,100 --> 00:22:35,000
a sternal<font color="#E5E5E5"> file and execute that again</font>

312
00:22:32,900 --> 00:22:35,600
<font color="#CCCCCC">and the secretary will can be signature</font>

313
00:22:35,000 --> 00:22:38,630
posteriorly

314
00:22:35,600 --> 00:22:40,370
if you have a<font color="#E5E5E5"> valid certificate</font><font color="#CCCCCC"> as you</font>

315
00:22:38,630 --> 00:22:44,600
copy the research section you<font color="#CCCCCC"> are going</font>

316
00:22:40,370 --> 00:22:46,879
to have the icon the size you<font color="#E5E5E5"> can</font>

317
00:22:44,600 --> 00:22:49,610
predict the size is the original one

318
00:22:46,880 --> 00:22:53,420
plus the malware plus the<font color="#CCCCCC"> original</font>

319
00:22:49,610 --> 00:22:59,300
resource section son I like men<font color="#CCCCCC"> you have</font>

320
00:22:53,420 --> 00:23:02,290
to put here now we don't have<font color="#E5E5E5"> the</font>

321
00:22:59,300 --> 00:23:06,340
<font color="#CCCCCC">problem of the outer integrity check</font>

322
00:23:02,290 --> 00:23:10,790
<font color="#E5E5E5">because now what we do</font><font color="#CCCCCC"> is to copy the</font>

323
00:23:06,340 --> 00:23:13,689
<font color="#CCCCCC">Arenal file outside</font><font color="#E5E5E5"> and run it so the</font>

324
00:23:10,790 --> 00:23:17,120
Arenal file is not modificated<font color="#E5E5E5"> so</font><font color="#CCCCCC"> the</font>

325
00:23:13,690 --> 00:23:21,350
<font color="#CCCCCC">outer integrity check is not a problem</font>

326
00:23:17,120 --> 00:23:27,800
<font color="#E5E5E5">anymore</font><font color="#CCCCCC"> ok</font>

327
00:23:21,350 --> 00:23:32,379
I'm going to do a demo<font color="#CCCCCC"> ok I quote proof</font>

328
00:23:27,800 --> 00:23:32,379
<font color="#E5E5E5">of concept a tool called EDM</font>

329
00:23:33,210 --> 00:23:44,130
what's this tool is it's a<font color="#CCCCCC"> proxy when</font>

330
00:23:39,840 --> 00:23:49,240
when a browser downloads an excel file

331
00:23:44,130 --> 00:23:52,900
<font color="#CCCCCC">it's checked the excel file add to the</font>

332
00:23:49,240 --> 00:23:59,200
malware<font color="#CCCCCC"> new data section change the size</font>

333
00:23:52,900 --> 00:24:02,140
of<font color="#E5E5E5"> the sections then start to send the</font>

334
00:23:59,200 --> 00:24:06,640
new secret<font color="#E5E5E5"> able to the client so the</font>

335
00:24:02,140 --> 00:24:10,419
client<font color="#E5E5E5"> since the start since it click on</font>

336
00:24:06,640 --> 00:24:12,179
<font color="#CCCCCC">the file</font><font color="#E5E5E5"> he will see that something</font><font color="#CCCCCC"> is</font>

337
00:24:10,419 --> 00:24:17,080
done loading

338
00:24:12,179 --> 00:24:21,760
so<font color="#CCCCCC"> since first</font><font color="#E5E5E5"> the malware then sends</font>

339
00:24:17,080 --> 00:24:26,080
the original executable then<font color="#CCCCCC"> sends the</font>

340
00:24:21,760 --> 00:24:29,860
research section to<font color="#E5E5E5"> have the icon how</font>

341
00:24:26,080 --> 00:24:34,480
the proxy detects that the target is

342
00:24:29,860 --> 00:24:37,510
downloading an excel file using<font color="#CCCCCC"> the</font>

343
00:24:34,480 --> 00:24:39,510
<font color="#E5E5E5">content-type</font><font color="#CCCCCC"> header it check if least</font>

344
00:24:37,510 --> 00:24:43,799
<font color="#E5E5E5">that content a killer application</font>

345
00:24:39,510 --> 00:24:48,010
<font color="#CCCCCC">updated octet stream is a general</font>

346
00:24:43,799 --> 00:24:50,080
content<font color="#E5E5E5"> type</font><font color="#CCCCCC"> for binary data</font><font color="#E5E5E5"> but it</font>

347
00:24:48,010 --> 00:24:53,919
checks if is application/octet-stream

348
00:24:50,080 --> 00:25:01,918
<font color="#CCCCCC">and also the</font><font color="#E5E5E5"> extinction of the file is</font>

349
00:24:53,919 --> 00:25:28,900
dot X so it is<font color="#E5E5E5"> started to infect it</font><font color="#CCCCCC"> okay</font>

350
00:25:01,919 --> 00:25:36,490
<font color="#CCCCCC">that's me</font><font color="#E5E5E5"> give me some other screen</font><font color="#CCCCCC"> ok</font>

351
00:25:28,900 --> 00:25:40,419
<font color="#E5E5E5">this</font><font color="#CCCCCC"> is the proxy here this</font><font color="#E5E5E5"> is the</font>

352
00:25:36,490 --> 00:25:44,230
configuration<font color="#E5E5E5"> for for infection in fact</font>

353
00:25:40,419 --> 00:25:44,809
in<font color="#CCCCCC"> XA executables what we are going</font><font color="#E5E5E5"> to</font>

354
00:25:44,230 --> 00:25:49,999
<font color="#CCCCCC">do</font>

355
00:25:44,809 --> 00:25:56,860
is here is to<font color="#CCCCCC"> create a new malware that</font>

356
00:25:49,999 --> 00:26:01,850
will join<font color="#E5E5E5"> two executables for one site</font>

357
00:25:56,860 --> 00:26:06,949
on the calc<font color="#E5E5E5"> for example and the one that</font>

358
00:26:01,850 --> 00:26:12,469
the target<font color="#E5E5E5"> will download after that this</font>

359
00:26:06,950 --> 00:26:15,679
a launcher launcher is the is the one

360
00:26:12,470 --> 00:26:22,789
<font color="#E5E5E5">that is going to copy both sections and</font>

361
00:26:15,679 --> 00:26:27,259
copy it outside and<font color="#E5E5E5"> then run it</font><font color="#CCCCCC"> what I I</font>

362
00:26:22,789 --> 00:26:31,190
did what this launcher do is to copy<font color="#E5E5E5"> as</font>

363
00:26:27,259 --> 00:26:34,820
I said the<font color="#CCCCCC"> two executables</font><font color="#E5E5E5"> outside I put</font>

364
00:26:31,190 --> 00:26:43,029
these<font color="#E5E5E5"> these file names</font><font color="#CCCCCC"> okay I'm just</font>

365
00:26:34,820 --> 00:26:43,029
going<font color="#CCCCCC"> to execute</font><font color="#E5E5E5"> a tit</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> the next</font>

366
00:26:43,629 --> 00:27:06,799
proxy so at the<font color="#E5E5E5"> start it create the</font>

367
00:26:50,419 --> 00:27:13,899
malware<font color="#E5E5E5"> and it's is waiting and now it's</font>

368
00:27:06,799 --> 00:27:13,899
a<font color="#E5E5E5"> Windows directly</font>

369
00:27:19,620 --> 00:27:44,669
for example<font color="#CCCCCC"> we see</font><font color="#E5E5E5"> let's go to the last</font>

370
00:27:31,480 --> 00:27:44,670
one<font color="#E5E5E5"> windows</font><font color="#CCCCCC"> okay first</font><font color="#E5E5E5"> without proxy</font>

371
00:27:44,760 --> 00:27:53,129
<font color="#CCCCCC">save file</font><font color="#E5E5E5"> as I said we had a</font><font color="#CCCCCC"> good speed</font>

372
00:27:52,120 --> 00:27:57,159
good

373
00:27:53,130 --> 00:28:01,390
this is a normal download<font color="#E5E5E5"> what everyone</font>

374
00:27:57,160 --> 00:28:18,160
see<font color="#E5E5E5"> and we want that with the infection</font>

375
00:28:01,390 --> 00:28:21,820
to see the same perfect have here they

376
00:28:18,160 --> 00:28:30,880
<font color="#E5E5E5">will see with the icon us do you see etc</font>

377
00:28:21,820 --> 00:28:34,950
now we simulate<font color="#CCCCCC"> Melinda</font><font color="#E5E5E5"> middle someone</font>

378
00:28:30,880 --> 00:28:39,850
is rejecting the<font color="#CCCCCC"> connection through</font>

379
00:28:34,950 --> 00:28:42,900
through a proxy<font color="#E5E5E5"> and we again download</font>

380
00:28:39,850 --> 00:28:42,899
<font color="#E5E5E5">the same file</font>

381
00:28:44,250 --> 00:29:00,150
something happened because<font color="#E5E5E5"> was</font><font color="#CCCCCC"> because</font>

382
00:28:48,480 --> 00:29:00,150
the<font color="#CCCCCC"> Cauchy</font><font color="#E5E5E5"> cash</font><font color="#CCCCCC"> okay scratch it</font>

383
00:29:03,960 --> 00:29:21,130
<font color="#CCCCCC">you</font><font color="#E5E5E5"> sub catch okay okay we see here</font>

384
00:29:15,120 --> 00:29:27,189
starting to to work save file<font color="#E5E5E5"> and as we</font>

385
00:29:21,130 --> 00:29:32,640
see we see the<font color="#E5E5E5"> same process okay now we</font>

386
00:29:27,190 --> 00:29:32,640
see that the size<font color="#CCCCCC"> is</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> little bit bigger</font>

387
00:29:32,970 --> 00:29:49,320
the speed is<font color="#E5E5E5"> the same so there is no</font>

388
00:29:37,840 --> 00:29:52,770
problems okay<font color="#CCCCCC"> what the proceed it is</font>

389
00:29:49,320 --> 00:29:55,689
analyzing the<font color="#CCCCCC"> first</font><font color="#E5E5E5"> byte of the</font>

390
00:29:52,770 --> 00:29:59,160
<font color="#E5E5E5">executable it predicted the</font>

391
00:29:55,690 --> 00:30:02,860
modifications on<font color="#E5E5E5"> the file and change it</font>

392
00:29:59,160 --> 00:30:06,630
on<font color="#CCCCCC"> the under hitter</font><font color="#E5E5E5"> okay</font>

393
00:30:02,860 --> 00:30:21,399
it<font color="#CCCCCC"> calculates the resources etc cetera</font>

394
00:30:06,630 --> 00:30:25,300
now we have let me see<font color="#E5E5E5"> okay</font>

395
00:30:21,400 --> 00:30:33,220
<font color="#E5E5E5">this is the renal one this is the second</font>

396
00:30:25,300 --> 00:30:36,159
one<font color="#E5E5E5"> if we click here do you ask me</font><font color="#CCCCCC"> do</font>

397
00:30:33,220 --> 00:30:39,100
<font color="#CCCCCC">you</font><font color="#E5E5E5"> see check that the arena of</font><font color="#CCCCCC"> the as</font>

398
00:30:36,160 --> 00:30:42,640
the file the data<font color="#E5E5E5"> of the file is unknown</font>

399
00:30:39,100 --> 00:30:48,730
because<font color="#E5E5E5"> we didn't sign it but if we</font>

400
00:30:42,640 --> 00:30:53,410
execute<font color="#E5E5E5"> it</font><font color="#CCCCCC"> we have the calc</font><font color="#E5E5E5"> okay and the</font>

401
00:30:48,730 --> 00:30:59,160
stallion<font color="#CCCCCC"> we have both okay</font><font color="#E5E5E5"> and it was</font>

402
00:30:53,410 --> 00:30:59,160
transparent<font color="#CCCCCC"> for the for the target</font>

403
00:31:03,829 --> 00:31:14,549
let's go back<font color="#CCCCCC"> okay he says this is the</font>

404
00:31:09,119 --> 00:31:23,629
<font color="#E5E5E5">instruction for</font><font color="#CCCCCC"> Excel file now I'm going</font>

405
00:31:14,549 --> 00:31:29,609
<font color="#E5E5E5">to talk about zip files the zip files is</font>

406
00:31:23,629 --> 00:31:35,899
a format<font color="#E5E5E5"> made by</font><font color="#CCCCCC"> Viki where the format</font>

407
00:31:29,609 --> 00:31:39,899
is basically<font color="#E5E5E5"> sitting east each file is</font>

408
00:31:35,899 --> 00:31:45,359
compress it individually and<font color="#CCCCCC"> put it</font>

409
00:31:39,899 --> 00:31:49,079
together<font color="#E5E5E5"> on on the</font><font color="#CCCCCC"> C so the first file</font>

410
00:31:45,359 --> 00:31:51,779
will have a local file<font color="#CCCCCC"> either</font><font color="#E5E5E5"> they</font>

411
00:31:49,079 --> 00:31:56,609
compress it files that data and at a

412
00:31:51,779 --> 00:31:59,369
<font color="#E5E5E5">scripture then is the second file the</font>

413
00:31:56,609 --> 00:32:03,478
<font color="#E5E5E5">same either file data</font><font color="#CCCCCC"> another</font>

414
00:31:59,369 --> 00:32:07,559
description<font color="#E5E5E5"> then and the N files then</font>

415
00:32:03,479 --> 00:32:08,450
<font color="#CCCCCC">Sun here's on record if the zip file is</font>

416
00:32:07,559 --> 00:32:15,329
encrypted

417
00:32:08,450 --> 00:32:22,589
<font color="#E5E5E5">finally central directory with CRC's an</font>

418
00:32:15,329 --> 00:32:26,129
index of all the<font color="#CCCCCC"> files okay on the</font><font color="#E5E5E5"> local</font>

419
00:32:22,589 --> 00:32:29,239
file here is the first<font color="#E5E5E5"> thing you</font><font color="#CCCCCC"> see</font>

420
00:32:26,129 --> 00:32:33,509
there<font color="#E5E5E5"> we are going to find a signature</font>

421
00:32:29,239 --> 00:32:37,039
<font color="#CCCCCC">okay the version of SIP some flags</font><font color="#E5E5E5"> what</font>

422
00:32:33,509 --> 00:32:43,009
the kind of compression<font color="#E5E5E5"> half the</font>

423
00:32:37,039 --> 00:32:47,029
modification time education<font color="#CCCCCC"> dates etc</font>

424
00:32:43,009 --> 00:32:51,929
<font color="#CCCCCC">crc32 of the header</font>

425
00:32:47,029 --> 00:32:55,339
no sorry of<font color="#E5E5E5"> the file and the</font><font color="#CCCCCC"> compresses</font>

426
00:32:51,929 --> 00:32:58,739
<font color="#E5E5E5">size of the file data and the</font>

427
00:32:55,339 --> 00:33:04,739
<font color="#E5E5E5">uncompressed size of the file data then</font>

428
00:32:58,739 --> 00:33:09,929
the file<font color="#CCCCCC"> named</font><font color="#E5E5E5"> after</font><font color="#CCCCCC"> this Caesar we are</font>

429
00:33:04,739 --> 00:33:13,250
going we find the<font color="#CCCCCC"> compress data after</font>

430
00:33:09,929 --> 00:33:16,910
that the data description<font color="#E5E5E5"> again is the</font>

431
00:33:13,250 --> 00:33:18,680
<font color="#CCCCCC">it's redundant information the crc32 the</font>

432
00:33:16,910 --> 00:33:26,120
<font color="#CCCCCC">compressor site and their compressor</font>

433
00:33:18,680 --> 00:33:28,880
<font color="#CCCCCC">sites after</font><font color="#E5E5E5"> any</font><font color="#CCCCCC"> fill all files</font><font color="#E5E5E5"> we are</font>

434
00:33:26,120 --> 00:33:32,989
going to find a central directory where

435
00:33:28,880 --> 00:33:41,240
there is files either<font color="#CCCCCC"> an index to</font><font color="#E5E5E5"> all</font>

436
00:33:32,990 --> 00:33:46,220
files hitters with again the the same

437
00:33:41,240 --> 00:33:52,460
information so is not very complicated

438
00:33:46,220 --> 00:33:56,270
<font color="#CCCCCC">and at the end this</font><font color="#E5E5E5"> is for multi multi</font>

439
00:33:52,460 --> 00:34:02,660
files etc<font color="#CCCCCC"> cetera</font><font color="#E5E5E5"> here</font><font color="#CCCCCC"> too in fact</font><font color="#E5E5E5"> in</font>

440
00:33:56,270 --> 00:34:06,260
fact<font color="#E5E5E5"> zip files we are going to to see</font><font color="#CCCCCC"> to</font>

441
00:34:02,660 --> 00:34:09,830
to take<font color="#CCCCCC"> a bunch</font><font color="#E5E5E5"> of that the first thing</font>

442
00:34:06,260 --> 00:34:12,560
you<font color="#CCCCCC"> see is the file name</font><font color="#E5E5E5"> and the size of</font>

443
00:34:09,830 --> 00:34:17,620
<font color="#E5E5E5">the file so when you start to download</font>

444
00:34:12,560 --> 00:34:21,440
<font color="#E5E5E5">the data stream of zip file</font><font color="#CCCCCC"> you can see</font>

445
00:34:17,620 --> 00:34:26,389
first<font color="#E5E5E5"> if the name</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the file you are</font>

446
00:34:21,440 --> 00:34:31,370
going to download<font color="#E5E5E5"> so</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> infect that the</font>

447
00:34:26,389 --> 00:34:34,960
client<font color="#E5E5E5"> starts to download a zip file the</font>

448
00:34:31,370 --> 00:34:39,580
proxy<font color="#E5E5E5"> stars</font><font color="#CCCCCC"> downloads the data</font><font color="#E5E5E5"> stream</font>

449
00:34:34,960 --> 00:34:45,020
see<font color="#CCCCCC"> they say the</font><font color="#E5E5E5"> local file hither and</font>

450
00:34:39,580 --> 00:34:48,860
check do I want to infect this file<font color="#E5E5E5"> this</font>

451
00:34:45,020 --> 00:34:55,489
is for<font color="#CCCCCC"> example a jpg file it don't want</font>

452
00:34:48,860 --> 00:34:59,150
<font color="#E5E5E5">if it is a</font><font color="#CCCCCC"> dll sprawling is it depends</font>

453
00:34:55,489 --> 00:35:01,040
how you configure that the BMP you don't

454
00:34:59,150 --> 00:35:03,650
want to in fact<font color="#E5E5E5"> if you don't want to</font>

455
00:35:01,040 --> 00:35:08,090
infect that<font color="#E5E5E5"> file you send the file to</font>

456
00:35:03,650 --> 00:35:13,790
the<font color="#E5E5E5"> client</font><font color="#CCCCCC"> it's on the fly remember if</font>

457
00:35:08,090 --> 00:35:16,940
we<font color="#E5E5E5"> if we</font><font color="#CCCCCC"> want to infect</font><font color="#E5E5E5"> that file</font><font color="#CCCCCC"> we</font>

458
00:35:13,790 --> 00:35:19,730
first we need to download the<font color="#CCCCCC"> whole file</font>

459
00:35:16,940 --> 00:35:21,530
to uncompress it we can in fact they

460
00:35:19,730 --> 00:35:27,530
compress it<font color="#E5E5E5"> in</font>

461
00:35:21,530 --> 00:35:30,860
so we get the uncompressed data we

462
00:35:27,530 --> 00:35:34,000
decompress that<font color="#E5E5E5"> data so we get a file we</font>

463
00:35:30,860 --> 00:35:38,960
infect the file with external program

464
00:35:34,000 --> 00:35:43,600
<font color="#E5E5E5">then in fact then we compress that file</font>

465
00:35:38,960 --> 00:35:48,020
<font color="#E5E5E5">again we</font><font color="#CCCCCC"> push that on the data stream</font>

466
00:35:43,600 --> 00:35:52,060
what happened here<font color="#E5E5E5"> you need to</font><font color="#CCCCCC"> wait</font>

467
00:35:48,020 --> 00:35:59,960
until<font color="#E5E5E5"> you have the compressed file so</font>

468
00:35:52,060 --> 00:36:04,700
and we want to to have the the line of

469
00:35:59,960 --> 00:36:12,200
the download<font color="#E5E5E5"> work for that</font><font color="#CCCCCC"> I used two</font>

470
00:36:04,700 --> 00:36:15,319
tricks<font color="#E5E5E5"> the first one is you can put on</font>

471
00:36:12,200 --> 00:36:17,960
the tool<font color="#CCCCCC"> -</font><font color="#E5E5E5"> in fact a parameter you can</font>

472
00:36:15,320 --> 00:36:21,980
<font color="#E5E5E5">write a parameter</font><font color="#CCCCCC"> that is the file if</font>

473
00:36:17,960 --> 00:36:27,320
the<font color="#E5E5E5"> compressed file is bigger than a</font>

474
00:36:21,980 --> 00:36:32,450
value<font color="#E5E5E5"> done in fact that okay</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> example</font>

475
00:36:27,320 --> 00:36:37,640
if the file is bigger than 100 megabytes

476
00:36:32,450 --> 00:36:40,129
and you are in a slow connection don't

477
00:36:37,640 --> 00:36:48,920
<font color="#E5E5E5">in fact that because I prefer to in fact</font>

478
00:36:40,130 --> 00:36:51,890
other files<font color="#CCCCCC"> that can</font><font color="#E5E5E5"> be</font><font color="#CCCCCC"> detected so as I</font>

479
00:36:48,920 --> 00:36:57,200
said there is the lie with big<font color="#CCCCCC"> composite</font>

480
00:36:51,890 --> 00:37:00,259
<font color="#E5E5E5">file</font><font color="#CCCCCC"> I had initially</font><font color="#E5E5E5"> a problem a problem</font>

481
00:36:57,200 --> 00:37:03,109
<font color="#CCCCCC">with</font><font color="#E5E5E5"> encrypted zip files I put there</font>

482
00:37:00,260 --> 00:37:07,310
being<font color="#E5E5E5"> so resolve it but now it's all wet</font>

483
00:37:03,110 --> 00:37:11,060
if the proxy detect that the tip is

484
00:37:07,310 --> 00:37:13,310
encrypted<font color="#CCCCCC"> we don't have the password it</font>

485
00:37:11,060 --> 00:37:19,759
<font color="#CCCCCC">passed the</font><font color="#E5E5E5"> data stream and done in fact</font>

486
00:37:13,310 --> 00:37:26,000
it the size which is the size the final

487
00:37:19,760 --> 00:37:28,950
size<font color="#CCCCCC"> of</font><font color="#E5E5E5"> the C file we don't know that</font>

488
00:37:26,000 --> 00:37:33,960
initially was the<font color="#E5E5E5"> file size</font><font color="#CCCCCC"> plus</font>

489
00:37:28,950 --> 00:37:37,879
infected data and some padding<font color="#E5E5E5"> was</font><font color="#CCCCCC"> the</font>

490
00:37:33,960 --> 00:37:41,250
<font color="#E5E5E5">initial idea</font><font color="#CCCCCC"> the initial code I made is</font>

491
00:37:37,880 --> 00:37:50,910
okay if<font color="#CCCCCC"> the new malware</font><font color="#E5E5E5"> I'm going to add</font>

492
00:37:41,250 --> 00:37:54,270
is 1k<font color="#CCCCCC"> for example I will increment in 30</font>

493
00:37:50,910 --> 00:37:57,629
case the size and<font color="#E5E5E5"> then padding at the</font>

494
00:37:54,270 --> 00:38:04,800
end of the file<font color="#CCCCCC"> if if</font><font color="#E5E5E5"> there</font><font color="#CCCCCC"> if finally</font>

495
00:37:57,630 --> 00:38:11,190
<font color="#E5E5E5">the file is is smaller but finally eyes</font>

496
00:38:04,800 --> 00:38:13,860
<font color="#E5E5E5">I saw that you don't need to know the</font>

497
00:38:11,190 --> 00:38:18,870
size you don't<font color="#E5E5E5"> need to put a</font><font color="#CCCCCC"> content</font>

498
00:38:13,860 --> 00:38:22,530
length on HTTP that<font color="#CCCCCC"> here</font><font color="#E5E5E5"> that's tails to</font>

499
00:38:18,870 --> 00:38:24,569
<font color="#CCCCCC">the browser the size of the file you are</font>

500
00:38:22,530 --> 00:38:28,470
downloading<font color="#E5E5E5"> is not needed it's not</font>

501
00:38:24,570 --> 00:38:33,690
mandatory<font color="#E5E5E5"> it works</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> are going to see</font>

502
00:38:28,470 --> 00:38:41,310
the effects also<font color="#CCCCCC"> I</font><font color="#E5E5E5"> added the capability</font>

503
00:38:33,690 --> 00:38:44,010
<font color="#E5E5E5">of adding files on inside feet now to</font>

504
00:38:41,310 --> 00:38:49,799
detect the proceed to detect that you

505
00:38:44,010 --> 00:38:52,500
are downloading<font color="#E5E5E5"> a zip file</font><font color="#CCCCCC"> its</font><font color="#E5E5E5"> it check</font>

506
00:38:49,800 --> 00:38:54,800
the content type<font color="#CCCCCC"> header</font><font color="#E5E5E5"> and check that</font>

507
00:38:52,500 --> 00:38:57,170
<font color="#E5E5E5">the content time is application</font><font color="#CCCCCC"> zip or</font>

508
00:38:54,800 --> 00:38:59,580
if it's the generic

509
00:38:57,170 --> 00:39:08,970
<font color="#E5E5E5">application/octet-stream it</font>

510
00:38:59,580 --> 00:39:20,069
check the extension to dot zip<font color="#CCCCCC"> okay just</font>

511
00:39:08,970 --> 00:39:27,569
going<font color="#CCCCCC"> to do demonstration the zip</font>

512
00:39:20,070 --> 00:39:31,530
configure here is distinction<font color="#E5E5E5"> or you can</font>

513
00:39:27,570 --> 00:39:36,760
put the file name for<font color="#CCCCCC"> example if the zip</font>

514
00:39:31,530 --> 00:39:40,720
have say tube dot<font color="#E5E5E5"> X for example</font>

515
00:39:36,760 --> 00:39:45,670
<font color="#CCCCCC">in fact that file or candy by extension</font>

516
00:39:40,720 --> 00:39:51,890
<font color="#E5E5E5">example all dot HTML files with a size</font>

517
00:39:45,670 --> 00:39:59,600
less<font color="#CCCCCC"> than</font><font color="#E5E5E5"> 10 K in fact with this</font>

518
00:39:51,890 --> 00:40:03,589
external<font color="#E5E5E5"> command if is a CPP code for</font>

519
00:39:59,600 --> 00:40:09,529
<font color="#E5E5E5">example we have this extension</font><font color="#CCCCCC"> the file</font>

520
00:40:03,590 --> 00:40:12,320
<font color="#E5E5E5">is less than</font><font color="#CCCCCC"> 10 K</font><font color="#E5E5E5"> you can't open the</font>

521
00:40:09,530 --> 00:40:15,800
file and<font color="#E5E5E5"> change this a stream for this</font>

522
00:40:12,320 --> 00:40:19,220
other stream this<font color="#E5E5E5"> is another feature I</font>

523
00:40:15,800 --> 00:40:22,910
added<font color="#CCCCCC"> you don't need here to to change</font>

524
00:40:19,220 --> 00:40:28,149
<font color="#E5E5E5">the to use a standard command you can</font>

525
00:40:22,910 --> 00:40:32,240
simply do a string change on<font color="#E5E5E5"> text files</font>

526
00:40:28,150 --> 00:40:35,630
<font color="#E5E5E5">if</font><font color="#CCCCCC"> file is a dot X file</font>

527
00:40:32,240 --> 00:40:38,060
less than 300<font color="#CCCCCC"> case ok</font>

528
00:40:35,630 --> 00:40:43,280
in fact it was<font color="#CCCCCC"> using this external</font>

529
00:40:38,060 --> 00:40:49,180
program for<font color="#CCCCCC"> example is a text</font><font color="#E5E5E5"> file the</font>

530
00:40:43,280 --> 00:40:55,090
directly directly<font color="#E5E5E5"> a string change this</font>

531
00:40:49,180 --> 00:41:01,040
test we can add more modifications etc

532
00:40:55,090 --> 00:41:03,770
we also can download add files to<font color="#E5E5E5"> the</font>

533
00:41:01,040 --> 00:41:08,779
<font color="#CCCCCC">seep</font><font color="#E5E5E5"> so inside the zip create a</font>

534
00:41:03,770 --> 00:41:11,780
directory called<font color="#CCCCCC"> layout and add</font><font color="#E5E5E5"> a file</font>

535
00:41:08,780 --> 00:41:16,160
with this name this is<font color="#CCCCCC"> the</font><font color="#E5E5E5"> local path of</font>

536
00:41:11,780 --> 00:41:22,370
the file we<font color="#CCCCCC"> want to add ok so you can't</font>

537
00:41:16,160 --> 00:41:29,890
to the<font color="#E5E5E5"> proxy this modify seat okay so</font>

538
00:41:22,370 --> 00:41:34,720
here without<font color="#CCCCCC"> proxy</font><font color="#E5E5E5"> download is too</font><font color="#CCCCCC"> big</font>

539
00:41:29,890 --> 00:41:34,720
<font color="#CCCCCC">way</font><font color="#E5E5E5"> too</font><font color="#CCCCCC"> fast</font>

540
00:41:35,420 --> 00:41:45,610
a small one<font color="#CCCCCC"> to two not all have</font><font color="#E5E5E5"> C files</font>

541
00:41:43,190 --> 00:41:45,610
here

542
00:41:47,580 --> 00:42:06,390
<font color="#E5E5E5">and</font><font color="#CCCCCC"> easy yes</font><font color="#E5E5E5"> 552 I think it's a fast</font>

543
00:41:54,250 --> 00:42:23,740
connection<font color="#E5E5E5"> okay</font><font color="#CCCCCC"> say five yes okay now</font>

544
00:42:06,390 --> 00:42:30,040
<font color="#CCCCCC">it's fast without cash this is the other</font>

545
00:42:23,740 --> 00:42:43,240
<font color="#E5E5E5">one which which was the direction I</font>

546
00:42:30,040 --> 00:42:48,160
clicked<font color="#CCCCCC"> to</font><font color="#E5E5E5"> to six download the same</font><font color="#CCCCCC"> ok</font>

547
00:42:43,240 --> 00:43:03,310
finally download it complete<font color="#CCCCCC"> it ok now</font>

548
00:42:48,160 --> 00:43:08,830
with proxy<font color="#E5E5E5"> exile perception not enough</font>

549
00:43:03,310 --> 00:43:12,790
parent to modify okay<font color="#E5E5E5"> here</font>

550
00:43:08,830 --> 00:43:18,190
oh<font color="#CCCCCC"> there is a lot</font><font color="#E5E5E5"> of here we see in the</font>

551
00:43:12,790 --> 00:43:20,350
law<font color="#CCCCCC"> that it is as if detected</font><font color="#E5E5E5"> because</font>

552
00:43:18,190 --> 00:43:22,180
<font color="#CCCCCC">the</font><font color="#E5E5E5"> using content type application</font><font color="#CCCCCC"> seep</font>

553
00:43:20,350 --> 00:43:26,650
<font color="#E5E5E5">so it's fine</font>

554
00:43:22,180 --> 00:43:30,640
VLC<font color="#E5E5E5"> 2 to 6 thanks</font><font color="#CCCCCC"> txt okay now the text</font>

555
00:43:26,650 --> 00:43:34,630
<font color="#E5E5E5">is in Spanish I realized right now</font><font color="#CCCCCC"> okay</font>

556
00:43:30,640 --> 00:43:38,080
changing changing<font color="#E5E5E5"> the streams because we</font>

557
00:43:34,630 --> 00:43:46,930
write that<font color="#CCCCCC"> I configure</font><font color="#E5E5E5"> that this to</font>

558
00:43:38,080 --> 00:43:48,620
change<font color="#E5E5E5"> HTML to EML the things the</font>

559
00:43:46,930 --> 00:43:55,430
x-files

560
00:43:48,620 --> 00:44:04,569
and inserting files<font color="#E5E5E5"> okay so odd I didn't</font>

561
00:43:55,430 --> 00:44:07,009
check I<font color="#CCCCCC"> don't</font><font color="#E5E5E5"> know which was the</font>

562
00:44:04,570 --> 00:44:14,150
modified<font color="#CCCCCC"> I think it's this one</font>

563
00:44:07,010 --> 00:44:16,760
yes<font color="#CCCCCC"> oh I didn't let me repeat we I</font>

564
00:44:14,150 --> 00:44:28,430
didn't show<font color="#E5E5E5"> you one thing</font><font color="#CCCCCC"> now it's in</font>

565
00:44:16,760 --> 00:44:35,480
the cache fuck<font color="#CCCCCC"> okay close one</font><font color="#E5E5E5"> in just to</font>

566
00:44:28,430 --> 00:44:44,960
show<font color="#CCCCCC"> you what happens if you remove the</font>

567
00:44:35,480 --> 00:44:47,990
content<font color="#E5E5E5"> length okay fine if you remove</font>

568
00:44:44,960 --> 00:44:51,020
the content<font color="#E5E5E5"> length</font><font color="#CCCCCC"> you're going to see</font>

569
00:44:47,990 --> 00:44:53,149
that the file is downloading and the<font color="#E5E5E5"> bar</font>

570
00:44:51,020 --> 00:44:55,610
<font color="#CCCCCC">is moving</font><font color="#E5E5E5"> but it's not in the same way</font>

571
00:44:53,150 --> 00:44:59,690
yeah you<font color="#E5E5E5"> are not going to see the</font>

572
00:44:55,610 --> 00:45:02,960
progress<font color="#E5E5E5"> why because the the browser</font>

573
00:44:59,690 --> 00:45:05,140
don't know how much time is going<font color="#CCCCCC"> to</font>

574
00:45:02,960 --> 00:45:08,330
take because<font color="#E5E5E5"> you don't know initially</font>

575
00:45:05,140 --> 00:45:13,879
<font color="#E5E5E5">the content length but it still works</font>

576
00:45:08,330 --> 00:45:24,610
still it still works<font color="#CCCCCC"> okay now if we go</font>

577
00:45:13,880 --> 00:45:24,610
<font color="#E5E5E5">to the other downloads it is only one</font>

578
00:45:27,460 --> 00:45:38,810
here they see the first<font color="#E5E5E5"> one</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> changed</font>

579
00:45:34,580 --> 00:45:49,790
<font color="#E5E5E5">this one I think the size is exactly the</font>

580
00:45:38,810 --> 00:45:58,450
same check<font color="#E5E5E5"> this modified okay here we</font>

581
00:45:49,790 --> 00:46:05,720
see the<font color="#CCCCCC"> added file</font><font color="#E5E5E5"> an image okay</font>

582
00:45:58,450 --> 00:46:38,109
if<font color="#E5E5E5"> I look for a text file</font><font color="#CCCCCC"> I don't know</font>

583
00:46:05,720 --> 00:46:38,109
where is any come on me txt<font color="#E5E5E5"> okay</font>

584
00:46:39,190 --> 00:46:53,690
for example here<font color="#E5E5E5"> I said change here the</font>

585
00:46:46,250 --> 00:46:55,520
a or all for<font color="#E5E5E5"> example okay if we find I</font>

586
00:46:53,690 --> 00:47:02,000
know that there is but I don't<font color="#CCCCCC"> know</font>

587
00:46:55,520 --> 00:47:11,210
<font color="#E5E5E5">where</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> HT</font><font color="#CCCCCC"> h HTML</font><font color="#E5E5E5"> yeah I had it</font><font color="#CCCCCC"> an an</font>

588
00:47:02,000 --> 00:47:17,030
<font color="#E5E5E5">alert</font><font color="#CCCCCC"> said infected and</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> things</font><font color="#E5E5E5"> so I</font>

589
00:47:11,210 --> 00:47:20,540
don't<font color="#E5E5E5"> know why why this one is they come</font>

590
00:47:17,030 --> 00:47:29,180
the infected one are smaller than this

591
00:47:20,540 --> 00:47:40,509
one this<font color="#E5E5E5"> is the infected okay</font>

592
00:47:29,180 --> 00:47:40,509
<font color="#E5E5E5">this is the infected one what the fuck</font>

593
00:47:46,660 --> 00:47:54,440
why<font color="#E5E5E5"> I think I</font><font color="#CCCCCC"> forgot and I download all</font>

594
00:47:52,490 --> 00:47:58,910
all the files through<font color="#E5E5E5"> the proxy because</font>

595
00:47:54,440 --> 00:48:10,640
<font color="#E5E5E5">I see all the VLC</font>

596
00:47:58,910 --> 00:48:13,788
in fact it<font color="#E5E5E5"> okay okay</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> one is</font><font color="#CCCCCC"> not</font>

597
00:48:10,640 --> 00:48:17,328
infected<font color="#E5E5E5"> okay</font><font color="#CCCCCC"> this is the real one</font>

598
00:48:13,789 --> 00:48:20,450
without the<font color="#E5E5E5"> Leo directory etc etc and</font>

599
00:48:17,329 --> 00:48:34,599
the other are<font color="#E5E5E5"> the infected one not know</font>

600
00:48:20,450 --> 00:48:38,509
why<font color="#E5E5E5"> okay now I'm going to explain</font>

601
00:48:34,599 --> 00:48:43,390
<font color="#E5E5E5">OpenOffice XML OpenOffice XML is</font>

602
00:48:38,510 --> 00:48:54,740
basically Microsoft Microsoft Office

603
00:48:43,390 --> 00:48:59,150
documents look<font color="#CCCCCC"> X DX x LS X so this</font><font color="#E5E5E5"> is a</font>

604
00:48:54,740 --> 00:49:03,439
standard<font color="#CCCCCC"> and it's basically a zip file</font>

605
00:48:59,150 --> 00:49:08,200
and docx files<font color="#E5E5E5"> the office files are C</font>

606
00:49:03,440 --> 00:49:15,440
files with some<font color="#E5E5E5"> tips insider the</font><font color="#CCCCCC"> zips</font>

607
00:49:08,200 --> 00:49:18,558
<font color="#E5E5E5">mostly are XML files which represent the</font>

608
00:49:15,440 --> 00:49:23,539
contents and<font color="#E5E5E5"> relationships of the file</font>

609
00:49:18,559 --> 00:49:31,609
<font color="#E5E5E5">you also can find image files or other</font>

610
00:49:23,539 --> 00:49:34,849
<font color="#E5E5E5">objects you directly can do unzip of a</font>

611
00:49:31,609 --> 00:49:38,109
document<font color="#E5E5E5"> file so you are going do</font>

612
00:49:34,849 --> 00:49:44,829
<font color="#E5E5E5">insight you are going to see that files</font>

613
00:49:38,109 --> 00:49:51,828
<font color="#E5E5E5">so in fact document file office files is</font>

614
00:49:44,829 --> 00:49:57,130
similar to C files<font color="#CCCCCC"> okay is -</font><font color="#E5E5E5"> is the</font><font color="#CCCCCC"> same</font>

615
00:49:51,829 --> 00:50:03,650
<font color="#E5E5E5">process to open the file modify the XML</font>

616
00:49:57,130 --> 00:50:07,130
files at any file if if you need it and

617
00:50:03,650 --> 00:50:09,920
<font color="#E5E5E5">under this for example from exploit you</font>

618
00:50:07,130 --> 00:50:13,359
can embed it RTF

619
00:50:09,920 --> 00:50:19,520
all that things<font color="#E5E5E5"> how to detect that the</font>

620
00:50:13,359 --> 00:50:20,930
target is downloading<font color="#CCCCCC"> office file okay</font>

621
00:50:19,520 --> 00:50:23,930
with the content<font color="#E5E5E5"> type</font>

622
00:50:20,930 --> 00:50:32,839
again if the content type is the generic

623
00:50:23,930 --> 00:50:50,868
<font color="#E5E5E5">you have to check also the</font><font color="#CCCCCC"> distension go</font>

624
00:50:32,839 --> 00:50:55,099
to directly<font color="#E5E5E5"> to the demo if you go to the</font>

625
00:50:50,869 --> 00:50:58,700
config<font color="#E5E5E5"> in fact office are going to see</font>

626
00:50:55,099 --> 00:51:06,710
that is<font color="#E5E5E5"> it will be simple the name of</font>

627
00:50:58,700 --> 00:51:14,419
the file<font color="#CCCCCC"> you want</font><font color="#E5E5E5"> to modify it</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> text</font>

628
00:51:06,710 --> 00:51:17,000
files directly<font color="#E5E5E5"> what I do is do a string</font>

629
00:51:14,420 --> 00:51:22,880
change so if you<font color="#E5E5E5"> find this</font><font color="#CCCCCC"> a strain</font>

630
00:51:17,000 --> 00:51:25,910
chain from to this other and that and

631
00:51:22,880 --> 00:51:29,500
that<font color="#E5E5E5"> things for</font><font color="#CCCCCC"> example if you want</font><font color="#E5E5E5"> to</font>

632
00:51:25,910 --> 00:51:34,960
add something before the overwrite<font color="#CCCCCC"> tag</font>

633
00:51:29,500 --> 00:51:38,480
<font color="#E5E5E5">so it's change the initial overwrite by</font>

634
00:51:34,960 --> 00:51:46,329
this computer<font color="#E5E5E5"> string and then add they</font>

635
00:51:38,480 --> 00:51:50,210
overwrite the same with document etc<font color="#E5E5E5"> etc</font>

636
00:51:46,329 --> 00:51:53,540
<font color="#E5E5E5">you have to study a little bit how</font><font color="#CCCCCC"> to in</font>

637
00:51:50,210 --> 00:52:00,040
get things inside<font color="#E5E5E5"> the office inside the</font>

638
00:51:53,540 --> 00:52:05,779
<font color="#CCCCCC">document also</font><font color="#E5E5E5"> for this example we add</font><font color="#CCCCCC"> to</font>

639
00:52:00,040 --> 00:52:08,750
<font color="#E5E5E5">two files</font><font color="#CCCCCC"> ok to the document</font><font color="#E5E5E5"> one is Han</font>

640
00:52:05,780 --> 00:52:17,049
<font color="#E5E5E5">only object and the other file is</font><font color="#CCCCCC"> our</font>

641
00:52:08,750 --> 00:52:17,049
image directly so just go to<font color="#E5E5E5"> proxy</font>

642
00:52:30,640 --> 00:52:47,299
<font color="#CCCCCC">they have directly here one document</font>

643
00:52:35,390 --> 00:52:59,629
<font color="#E5E5E5">that you can download via those okay</font>

644
00:52:47,299 --> 00:53:06,170
let's browse here<font color="#E5E5E5"> example of document</font>

645
00:52:59,630 --> 00:53:11,329
<font color="#E5E5E5">that is get by HTTP first</font><font color="#CCCCCC"> stick</font><font color="#E5E5E5"> first</font>

646
00:53:06,170 --> 00:53:25,299
without proxy this is fast<font color="#CCCCCC"> oh</font><font color="#E5E5E5"> sorry</font>

647
00:53:11,329 --> 00:53:25,299
document<font color="#CCCCCC"> ok save file download</font><font color="#E5E5E5"> it now</font>

648
00:53:27,339 --> 00:53:49,808
first<font color="#E5E5E5"> use the proxy now put the same</font>

649
00:53:36,469 --> 00:53:49,809
file<font color="#CCCCCC"> proxies regime</font>

650
00:53:51,009 --> 00:53:59,200
<font color="#CCCCCC">see happened yes</font>

651
00:53:56,269 --> 00:54:02,468
something happened with<font color="#E5E5E5"> the property I</font>

652
00:53:59,200 --> 00:54:02,468
love it

653
00:54:04,479 --> 00:54:08,450
<font color="#CCCCCC">ok</font>

654
00:54:05,630 --> 00:54:16,210
this is the<font color="#E5E5E5"> Arenal one and this is</font><font color="#CCCCCC"> a</font>

655
00:54:08,450 --> 00:54:18,779
modified<font color="#CCCCCC"> one</font><font color="#E5E5E5"> it's almost the double ok</font>

656
00:54:16,210 --> 00:54:27,550
yes<font color="#CCCCCC"> around</font><font color="#E5E5E5"> office</font>

657
00:54:18,780 --> 00:54:32,040
document and modified<font color="#E5E5E5"> one we</font><font color="#CCCCCC"> added here</font>

658
00:54:27,550 --> 00:54:37,750
<font color="#CCCCCC">an object Hey</font><font color="#E5E5E5"> we are really</font><font color="#CCCCCC"> a vision</font>

659
00:54:32,040 --> 00:54:42,400
it's a<font color="#E5E5E5"> it is very simple it's an object</font>

660
00:54:37,750 --> 00:54:46,210
<font color="#CCCCCC">that can be</font><font color="#E5E5E5"> done</font><font color="#CCCCCC"> the economy is going</font><font color="#E5E5E5"> to</font>

661
00:54:42,400 --> 00:54:53,619
<font color="#E5E5E5">change</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> a lolly object okay so for</font>

662
00:54:46,210 --> 00:54:59,109
attacks you have<font color="#CCCCCC"> to be</font><font color="#E5E5E5"> creative</font><font color="#CCCCCC"> if we</font>

663
00:54:53,619 --> 00:54:59,290
change the name<font color="#E5E5E5"> okay let's let's go do</font>

664
00:54:59,109 --> 00:55:09,880
<font color="#E5E5E5">it</font>

665
00:54:59,290 --> 00:55:13,029
<font color="#E5E5E5">play with the</font><font color="#CCCCCC"> infected to sleep yes you</font>

666
00:55:09,880 --> 00:55:15,760
open it we are going<font color="#CCCCCC"> to see that is</font>

667
00:55:13,030 --> 00:55:22,000
<font color="#CCCCCC">asset file and insane</font>

668
00:55:15,760 --> 00:55:26,680
inside the<font color="#E5E5E5"> file is now our object</font><font color="#CCCCCC"> and</font>

669
00:55:22,000 --> 00:55:31,089
the media this image is added<font color="#E5E5E5"> you</font><font color="#CCCCCC"> can</font>

670
00:55:26,680 --> 00:55:34,230
<font color="#E5E5E5">compare it with the renal one and that's</font>

671
00:55:31,089 --> 00:55:34,230
<font color="#E5E5E5">how the proxy works</font>

672
00:55:36,119 --> 00:55:55,210
<font color="#CCCCCC">okay informing it so other file types</font><font color="#E5E5E5"> it</font>

673
00:55:46,780 --> 00:56:00,339
is to do<font color="#CCCCCC"> I planned to do the same with</font>

674
00:55:55,210 --> 00:56:07,569
PDFs with rar files with<font color="#CCCCCC"> tar</font><font color="#E5E5E5"> GC</font><font color="#CCCCCC"> epoca</font>

675
00:56:00,339 --> 00:56:13,779
files<font color="#CCCCCC"> I choose</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> stadiums</font><font color="#E5E5E5"> because I</font>

676
00:56:07,569 --> 00:56:18,060
still see<font color="#CCCCCC"> web page URLs on HTTP to</font>

677
00:56:13,780 --> 00:56:18,060
download that kind<font color="#E5E5E5"> of files so</font>

678
00:56:18,190 --> 00:56:27,099
if I see<font color="#CCCCCC"> that I see okay we can in fact</font>

679
00:56:20,890 --> 00:56:32,109
that we can in get things there<font color="#CCCCCC"> I know</font>

680
00:56:27,099 --> 00:56:37,269
how but this is a<font color="#E5E5E5"> one-man</font><font color="#CCCCCC"> proof</font><font color="#E5E5E5"> of</font>

681
00:56:32,109 --> 00:56:40,690
<font color="#E5E5E5">concept so if someone wants</font><font color="#CCCCCC"> to help you</font>

682
00:56:37,269 --> 00:56:42,488
are welcome because<font color="#E5E5E5"> this I loved a lot</font>

683
00:56:40,690 --> 00:56:46,650
<font color="#CCCCCC">of</font><font color="#E5E5E5"> things to do</font>

684
00:56:42,489 --> 00:56:50,529
they said this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> tensions in project</font>

685
00:56:46,650 --> 00:56:56,319
for a<font color="#E5E5E5"> long future also true in fact</font>

686
00:56:50,529 --> 00:56:57,819
<font color="#E5E5E5">torrent files</font><font color="#CCCCCC"> macaw sticks this</font><font color="#E5E5E5"> image</font>

687
00:56:56,319 --> 00:57:01,529
dmg<font color="#E5E5E5"> epic</font>

688
00:56:57,819 --> 00:57:06,099
<font color="#CCCCCC">pkg also it's very</font><font color="#E5E5E5"> interesting</font>

689
00:57:01,529 --> 00:57:10,979
<font color="#CCCCCC">- in fact</font><font color="#E5E5E5"> class files that</font><font color="#CCCCCC"> exist inside</font>

690
00:57:06,099 --> 00:57:17,529
<font color="#E5E5E5">jar files that are also zip files so</font>

691
00:57:10,979 --> 00:57:21,220
basically the the code to modify files

692
00:57:17,529 --> 00:57:26,710
inside jar it's already done<font color="#E5E5E5"> is the same</font>

693
00:57:21,220 --> 00:57:33,129
<font color="#E5E5E5">at</font><font color="#CCCCCC"> Sipan office document about</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> IDM</font>

694
00:57:26,710 --> 00:57:39,880
the program in to do is to<font color="#E5E5E5"> part it to</font>

695
00:57:33,130 --> 00:57:44,650
see the promise made in in<font color="#CCCCCC"> python i want</font>

696
00:57:39,880 --> 00:57:48,640
to part it<font color="#E5E5E5"> to see to to to make</font><font color="#CCCCCC"> it work</font>

697
00:57:44,650 --> 00:57:53,619
<font color="#CCCCCC">on embedded devices to do that on on</font>

698
00:57:48,640 --> 00:57:58,239
<font color="#CCCCCC">reuters and to add high ability also i</font>

699
00:57:53,619 --> 00:58:05,549
want new technique is for for infection

700
00:57:58,239 --> 00:58:08,229
on<font color="#E5E5E5"> the fly</font><font color="#CCCCCC"> i were researching</font>

701
00:58:05,549 --> 00:58:16,329
<font color="#CCCCCC">me and a friend we are researching about</font>

702
00:58:08,229 --> 00:58:18,819
avoiding<font color="#CCCCCC"> the pee signature</font><font color="#E5E5E5"> check the</font>

703
00:58:16,329 --> 00:58:24,759
result of that research<font color="#E5E5E5"> is</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> last</font>

704
00:58:18,819 --> 00:58:27,830
week<font color="#CCCCCC"> we could in fact one one file and</font>

705
00:58:24,759 --> 00:58:31,070
<font color="#CCCCCC">that file is still</font>

706
00:58:27,830 --> 00:58:36,200
<font color="#E5E5E5">Cygnet without a certificate without our</font>

707
00:58:31,070 --> 00:58:40,490
own certificate<font color="#CCCCCC"> so for our next dog</font><font color="#E5E5E5"> it</font>

708
00:58:36,200 --> 00:58:44,960
it will be<font color="#E5E5E5"> very interesting</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> the EDM</font>

709
00:58:40,490 --> 00:58:50,390
is<font color="#E5E5E5"> happy</font><font color="#CCCCCC"> wanna cheat that's</font><font color="#E5E5E5"> the end</font>

710
00:58:44,960 --> 00:58:53,500
if anyone have some question no

711
00:58:50,390 --> 00:58:55,910
questions from<font color="#E5E5E5"> the floor</font>

712
00:58:53,500 --> 00:58:58,100
well<font color="#CCCCCC"> alright thank you very much</font>

713
00:58:55,910 --> 00:59:00,170
<font color="#E5E5E5">Leonardo really appreciate you wrapping</font>

714
00:58:58,100 --> 00:59:02,950
up the last talk in this track<font color="#CCCCCC"> today</font>

715
00:59:00,170 --> 00:59:02,950
<font color="#E5E5E5">thank you</font>

