1
00:00:24,630 --> 00:00:35,230
hello<font color="#E5E5E5"> today we will be talking</font><font color="#CCCCCC"> about</font><font color="#E5E5E5"> a</font>

2
00:00:30,360 --> 00:00:41,260
<font color="#E5E5E5">security alarm but before that I'd like</font>

3
00:00:35,230 --> 00:00:42,790
<font color="#CCCCCC">to say a few words about myself I am</font>

4
00:00:41,260 --> 00:00:45,519
indeed lead researcher it's possible

5
00:00:42,790 --> 00:00:47,170
security<font color="#E5E5E5"> we do penetration testing</font>

6
00:00:45,520 --> 00:00:50,110
consulting and training stuff like that

7
00:00:47,170 --> 00:00:52,239
<font color="#CCCCCC">and I am quite active on</font><font color="#E5E5E5"> Twitter does</font>

8
00:00:50,110 --> 00:00:53,890
the<font color="#E5E5E5"> only social network I use you know</font>

9
00:00:52,239 --> 00:00:57,510
because it doesn't try to fool you<font color="#CCCCCC"> into</font>

10
00:00:53,890 --> 00:01:00,310
some some privacy<font color="#E5E5E5"> that's not better but</font>

11
00:00:57,510 --> 00:01:03,309
both by day and<font color="#E5E5E5"> by night</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> focus on</font>

12
00:01:00,310 --> 00:01:05,410
different<font color="#E5E5E5"> things one of that</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> that for</font>

13
00:01:03,309 --> 00:01:09,190
full of analysis<font color="#E5E5E5"> which is what allowed</font>

14
00:01:05,410 --> 00:01:11,470
me<font color="#CCCCCC"> to research how this protocol</font><font color="#E5E5E5"> works</font>

15
00:01:09,190 --> 00:01:13,149
which allowed me to look<font color="#E5E5E5"> into it</font>

16
00:01:11,470 --> 00:01:15,160
all<font color="#E5E5E5"> traverse engineering right this is</font>

17
00:01:13,149 --> 00:01:17,440
what it's<font color="#E5E5E5"> all about and part of the</font>

18
00:01:15,160 --> 00:01:19,060
presentation<font color="#E5E5E5"> is going to be about giving</font>

19
00:01:17,440 --> 00:01:23,020
you the<font color="#CCCCCC"> tools and</font><font color="#E5E5E5"> giving you the skills</font>

20
00:01:19,060 --> 00:01:25,899
<font color="#E5E5E5">the audience here today</font><font color="#CCCCCC"> and online to be</font>

21
00:01:23,020 --> 00:01:28,030
<font color="#E5E5E5">able to repeat these things for the</font>

22
00:01:25,899 --> 00:01:31,270
system or<font color="#E5E5E5"> for a different system</font><font color="#CCCCCC"> if you</font>

23
00:01:28,030 --> 00:01:32,799
so wish<font color="#CCCCCC"> I also do social</font><font color="#E5E5E5"> engineering</font><font color="#CCCCCC"> so</font>

24
00:01:31,270 --> 00:01:34,780
some people<font color="#E5E5E5"> say</font><font color="#CCCCCC"> it should be</font><font color="#E5E5E5"> careful but</font>

25
00:01:32,799 --> 00:01:38,850
maybe I'm not that good<font color="#CCCCCC"> you know in that</font>

26
00:01:34,780 --> 00:01:41,799
and I have been doing<font color="#E5E5E5"> IT security for</font>

27
00:01:38,850 --> 00:01:43,270
quite<font color="#CCCCCC"> many years</font><font color="#E5E5E5"> so I got bored with the</font>

28
00:01:41,799 --> 00:01:44,740
technical<font color="#E5E5E5"> stuff so I also do legal</font>

29
00:01:43,270 --> 00:01:46,990
dimension<font color="#E5E5E5"> from time to time like policy</font>

30
00:01:44,740 --> 00:01:49,990
documents<font color="#E5E5E5"> ISO standards and stuff like</font>

31
00:01:46,990 --> 00:01:54,220
that anyway let's talk<font color="#CCCCCC"> about</font><font color="#E5E5E5"> security</font>

32
00:01:49,990 --> 00:01:56,439
alarms many of you<font color="#CCCCCC"> have a secured</font><font color="#E5E5E5"> alarm</font>

33
00:01:54,220 --> 00:02:00,400
system in your home or maybe<font color="#E5E5E5"> in your</font>

34
00:01:56,439 --> 00:02:04,689
<font color="#E5E5E5">office the goal of a security</font><font color="#CCCCCC"> alarm is</font>

35
00:02:00,400 --> 00:02:09,399
of course to protect<font color="#E5E5E5"> you in case of a</font>

36
00:02:04,689 --> 00:02:12,430
break-in<font color="#CCCCCC"> and some</font><font color="#E5E5E5"> security alarms have</font>

37
00:02:09,399 --> 00:02:14,489
gotten really<font color="#E5E5E5"> good in achieving this</font>

38
00:02:12,430 --> 00:02:14,489
goal

39
00:02:19,080 --> 00:02:22,589
[Music]

40
00:02:25,090 --> 00:02:31,090
so some of them are literally<font color="#E5E5E5"> preventing</font>

41
00:02:28,300 --> 00:02:34,300
attacks<font color="#E5E5E5"> like like this one demonstrated</font>

42
00:02:31,090 --> 00:02:36,010
here it's a small screen<font color="#E5E5E5"> alarm system</font>

43
00:02:34,300 --> 00:02:38,860
and when<font color="#E5E5E5"> the alarm</font><font color="#CCCCCC"> goes off it just</font>

44
00:02:36,010 --> 00:02:40,390
<font color="#E5E5E5">prevents the attacker to</font><font color="#CCCCCC"> be able</font><font color="#E5E5E5"> to see</font>

45
00:02:38,860 --> 00:02:44,050
and to be<font color="#CCCCCC"> able</font><font color="#E5E5E5"> to do whatever they're</font>

46
00:02:40,390 --> 00:02:46,208
there to do but it's still a security

47
00:02:44,050 --> 00:02:49,060
<font color="#E5E5E5">alarm and it still has its owner</font>

48
00:02:46,209 --> 00:02:53,230
abilities<font color="#E5E5E5"> so the question we were asking</font>

49
00:02:49,060 --> 00:02:57,840
today<font color="#E5E5E5"> is what could go wrong with an</font>

50
00:02:53,230 --> 00:03:03,130
alarm system<font color="#E5E5E5"> let me ask you something</font>

51
00:02:57,840 --> 00:03:05,440
when did you last change the code for

52
00:03:03,130 --> 00:03:07,810
<font color="#E5E5E5">your alarm</font><font color="#CCCCCC"> system at home or when was</font>

53
00:03:05,440 --> 00:03:10,420
the code<font color="#CCCCCC"> laws</font><font color="#E5E5E5"> changed for your alarm</font>

54
00:03:07,810 --> 00:03:12,190
<font color="#CCCCCC">system at work for</font><font color="#E5E5E5"> who of you it</font><font color="#CCCCCC"> has</font>

55
00:03:10,420 --> 00:03:14,768
<font color="#CCCCCC">been in the</font><font color="#E5E5E5"> last</font><font color="#CCCCCC"> three months can</font><font color="#E5E5E5"> I have</font>

56
00:03:12,190 --> 00:03:19,950
a show<font color="#CCCCCC"> of hands last three months last</font>

57
00:03:14,769 --> 00:03:23,890
<font color="#E5E5E5">12 months a year never anyone never okay</font>

58
00:03:19,950 --> 00:03:25,750
so these<font color="#E5E5E5"> codes we usually don't don't</font>

59
00:03:23,890 --> 00:03:27,369
change them right even though we can we

60
00:03:25,750 --> 00:03:29,530
don't change we<font color="#E5E5E5"> don't change them when</font>

61
00:03:27,370 --> 00:03:33,359
they're<font color="#CCCCCC"> installed</font><font color="#E5E5E5"> so one thing</font><font color="#CCCCCC"> that</font>

62
00:03:29,530 --> 00:03:37,600
could go wrong<font color="#E5E5E5"> what if an adversary</font>

63
00:03:33,359 --> 00:03:40,060
could<font color="#E5E5E5"> fold</font><font color="#CCCCCC"> a system with a small device</font>

64
00:03:37,600 --> 00:03:44,170
and slowly<font color="#CCCCCC"> brute force</font><font color="#E5E5E5"> your four-digit</font>

65
00:03:40,060 --> 00:03:45,640
code of course there are lock outs<font color="#E5E5E5"> if an</font>

66
00:03:44,170 --> 00:03:48,010
attacker were to come on your premises

67
00:03:45,640 --> 00:03:51,069
<font color="#E5E5E5">and try to punch in the</font><font color="#CCCCCC"> code it</font><font color="#E5E5E5"> would</font>

68
00:03:48,010 --> 00:03:55,149
block the system after<font color="#CCCCCC"> a couple attempts</font>

69
00:03:51,069 --> 00:03:57,548
usually five attempts but if an attacker

70
00:03:55,150 --> 00:04:00,639
were to install<font color="#E5E5E5"> an automatic</font><font color="#CCCCCC"> device</font><font color="#E5E5E5"> they</font>

71
00:03:57,549 --> 00:04:04,060
could brute force<font color="#CCCCCC"> the system</font><font color="#E5E5E5"> slowly say</font>

72
00:04:00,639 --> 00:04:08,319
four codes<font color="#E5E5E5"> per hour with four codes per</font>

73
00:04:04,060 --> 00:04:10,359
hour we get 96<font color="#CCCCCC"> tries per day you know</font>

74
00:04:08,319 --> 00:04:12,548
what that<font color="#E5E5E5"> gives us we can test all</font>

75
00:04:10,359 --> 00:04:15,359
<font color="#CCCCCC">four-digit pins</font><font color="#E5E5E5"> in three and a half</font>

76
00:04:12,549 --> 00:04:18,660
months<font color="#E5E5E5"> and since you don't change them</font>

77
00:04:15,359 --> 00:04:23,979
well attacker can simply brute force

78
00:04:18,660 --> 00:04:25,460
your code there are some other<font color="#CCCCCC"> things</font>

79
00:04:23,979 --> 00:04:29,210
<font color="#CCCCCC">that can go wrong</font>

80
00:04:25,460 --> 00:04:31,789
so the goal<font color="#CCCCCC"> of an alarm</font><font color="#E5E5E5"> system is to</font>

81
00:04:29,210 --> 00:04:34,400
<font color="#E5E5E5">provide you the peace of mind the</font>

82
00:04:31,789 --> 00:04:37,280
question is do we get the peace of<font color="#E5E5E5"> mind</font>

83
00:04:34,400 --> 00:04:39,739
<font color="#E5E5E5">or do we</font><font color="#CCCCCC"> have</font><font color="#E5E5E5"> something to worry about</font>

84
00:04:37,280 --> 00:04:42,739
<font color="#E5E5E5">in addition to what we</font><font color="#CCCCCC"> would</font><font color="#E5E5E5"> have</font>

85
00:04:39,740 --> 00:04:47,780
otherwise<font color="#E5E5E5"> so let's look at one typical</font>

86
00:04:42,740 --> 00:04:50,120
scenario this<font color="#CCCCCC"> is a warehouse</font><font color="#E5E5E5"> it stores</font>

87
00:04:47,780 --> 00:04:52,549
your stuff<font color="#E5E5E5"> maybe your company selling</font>

88
00:04:50,120 --> 00:04:55,460
hardware<font color="#E5E5E5"> you're stuck in there maybe</font>

89
00:04:52,550 --> 00:04:57,979
<font color="#E5E5E5">you're selling food maybe just you have</font>

90
00:04:55,460 --> 00:05:02,320
expensive<font color="#CCCCCC"> equipment that's used to make</font>

91
00:04:57,979 --> 00:05:05,360
<font color="#CCCCCC">different merchandise</font><font color="#E5E5E5"> in there right and</font>

92
00:05:02,320 --> 00:05:07,430
it's a large<font color="#CCCCCC"> warehouse so you would</font>

93
00:05:05,360 --> 00:05:09,380
usually<font color="#E5E5E5"> on such a system you have like a</font>

94
00:05:07,430 --> 00:05:11,270
<font color="#E5E5E5">keypad or two</font><font color="#CCCCCC"> you would have some</font>

95
00:05:09,380 --> 00:05:13,669
sensors like passive infrared sensors

96
00:05:11,270 --> 00:05:15,919
the detect movement<font color="#E5E5E5"> or magnetic sensors</font>

97
00:05:13,669 --> 00:05:19,430
that detect when a door or<font color="#CCCCCC"> window is</font>

98
00:05:15,919 --> 00:05:22,460
open but in reality<font color="#E5E5E5"> what happens with</font>

99
00:05:19,430 --> 00:05:25,070
these large deployments is that there's

100
00:05:22,460 --> 00:05:28,099
a main<font color="#E5E5E5"> entrance</font><font color="#CCCCCC"> right on the left here</font>

101
00:05:25,070 --> 00:05:31,550
for<font color="#CCCCCC"> example and some of the keypads</font><font color="#E5E5E5"> get</font>

102
00:05:28,099 --> 00:05:34,909
rarely<font color="#E5E5E5"> used so they're there they're</font>

103
00:05:31,550 --> 00:05:37,789
working<font color="#E5E5E5"> but no one uses it for a week</font>

104
00:05:34,909 --> 00:05:40,340
<font color="#CCCCCC">maybe</font><font color="#E5E5E5"> for a month no one goes there</font><font color="#CCCCCC"> and</font>

105
00:05:37,789 --> 00:05:42,979
checks on the condition of<font color="#E5E5E5"> the keypad</font>

106
00:05:40,340 --> 00:05:45,409
<font color="#E5E5E5">and sometimes keypads are being</font>

107
00:05:42,979 --> 00:05:46,719
installed outside<font color="#E5E5E5"> so you can disarm the</font>

108
00:05:45,409 --> 00:05:52,490
system before<font color="#E5E5E5"> entering the premises</font>

109
00:05:46,720 --> 00:05:56,690
<font color="#CCCCCC">right so what if attacker was able to</font>

110
00:05:52,490 --> 00:05:59,180
<font color="#E5E5E5">use that remote keypad of your device to</font>

111
00:05:56,690 --> 00:06:01,969
<font color="#E5E5E5">extract some</font><font color="#CCCCCC"> information about your</font>

112
00:05:59,180 --> 00:06:07,669
security zoning or about your security

113
00:06:01,970 --> 00:06:11,620
configuration were maybe attacker could

114
00:06:07,669 --> 00:06:15,289
use that keypad that<font color="#E5E5E5"> you aren't using to</font>

115
00:06:11,620 --> 00:06:18,620
extract the code<font color="#E5E5E5"> you</font><font color="#CCCCCC"> use</font><font color="#E5E5E5"> to disarm the</font>

116
00:06:15,289 --> 00:06:20,509
system<font color="#CCCCCC"> directly without guessing so</font>

117
00:06:18,620 --> 00:06:25,909
that's an attack we're going to<font color="#E5E5E5"> look at</font>

118
00:06:20,509 --> 00:06:29,210
today so once again the goal of the rest

119
00:06:25,909 --> 00:06:33,590
of the presentations here<font color="#E5E5E5"> is to acquaint</font>

120
00:06:29,210 --> 00:06:37,700
here with a system<font color="#CCCCCC"> that I</font><font color="#E5E5E5"> tested and to</font>

121
00:06:33,590 --> 00:06:39,289
let you repeat the research yourself<font color="#CCCCCC"> to</font>

122
00:06:37,700 --> 00:06:41,449
be able<font color="#E5E5E5"> to look into</font>

123
00:06:39,289 --> 00:06:45,020
<font color="#CCCCCC">you</font><font color="#E5E5E5"> don't know to be able to</font><font color="#CCCCCC"> test the</font>

124
00:06:41,449 --> 00:06:48,919
<font color="#CCCCCC">security of</font><font color="#E5E5E5"> some closed systems that you</font>

125
00:06:45,020 --> 00:06:50,210
don't have the source<font color="#CCCCCC"> code for and of</font>

126
00:06:48,919 --> 00:06:53,270
course we're gonna<font color="#E5E5E5"> have a live demo</font><font color="#CCCCCC"> as</font>

127
00:06:50,210 --> 00:06:55,068
you can probably<font color="#E5E5E5"> tell from this huge box</font>

128
00:06:53,270 --> 00:06:59,389
over<font color="#CCCCCC"> here</font><font color="#E5E5E5"> that's gonna be at the very</font>

129
00:06:55,069 --> 00:07:03,499
end so<font color="#CCCCCC"> let's talk about what-what I</font>

130
00:06:59,389 --> 00:07:06,589
tested there so<font color="#E5E5E5"> some time ago I</font><font color="#CCCCCC"> looked</font>

131
00:07:03,499 --> 00:07:08,270
into into<font color="#CCCCCC"> this secure system here</font><font color="#E5E5E5"> it's</font>

132
00:07:06,589 --> 00:07:11,180
made<font color="#E5E5E5"> by paradox security systems it's a</font>

133
00:07:08,270 --> 00:07:13,188
<font color="#E5E5E5">Canadian</font><font color="#CCCCCC"> company</font><font color="#E5E5E5"> with some history it's</font>

134
00:07:11,180 --> 00:07:15,919
quite<font color="#E5E5E5"> popular in some parts</font><font color="#CCCCCC"> of the world</font>

135
00:07:13,189 --> 00:07:20,059
not<font color="#CCCCCC"> only Canada and it's</font><font color="#E5E5E5"> considered the</font>

136
00:07:15,919 --> 00:07:22,938
<font color="#E5E5E5">cheaper alternative by some</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> like DSC</font>

137
00:07:20,059 --> 00:07:24,709
or some other larger vendors<font color="#E5E5E5"> and what</font>

138
00:07:22,939 --> 00:07:27,860
they make is basically<font color="#E5E5E5"> modulo security</font>

139
00:07:24,709 --> 00:07:29,689
alarms that means<font color="#E5E5E5"> it's an alarm</font><font color="#CCCCCC"> that you</font>

140
00:07:27,860 --> 00:07:31,729
can expand or rather that the company

141
00:07:29,689 --> 00:07:33,379
<font color="#CCCCCC">that installs the alarm for you can</font>

142
00:07:31,729 --> 00:07:35,599
expand they have three<font color="#CCCCCC"> different</font>

143
00:07:33,379 --> 00:07:37,520
versions<font color="#E5E5E5"> of this Spectre</font><font color="#CCCCCC"> SP it's just</font>

144
00:07:35,599 --> 00:07:39,860
<font color="#E5E5E5">expandable security systems it's the</font>

145
00:07:37,520 --> 00:07:41,930
<font color="#E5E5E5">entry version it's the cheapest one</font>

146
00:07:39,860 --> 00:07:43,909
<font color="#E5E5E5">right then we have ever which</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> high</font>

147
00:07:41,930 --> 00:07:46,699
security<font color="#CCCCCC"> and</font><font color="#E5E5E5"> access systems it's meant</font>

148
00:07:43,909 --> 00:07:49,719
for places where<font color="#E5E5E5"> you need higher</font>

149
00:07:46,699 --> 00:07:53,029
<font color="#CCCCCC">security</font><font color="#E5E5E5"> and the third one they added</font>

150
00:07:49,719 --> 00:07:54,558
the loft<font color="#E5E5E5"> is</font><font color="#CCCCCC"> maggle on that's wireless</font>

151
00:07:53,029 --> 00:07:56,689
security systems if you<font color="#E5E5E5"> don't want to</font>

152
00:07:54,559 --> 00:07:58,009
ruin the walls on your new house<font color="#CCCCCC"> you can</font>

153
00:07:56,689 --> 00:07:59,779
<font color="#CCCCCC">just have a wireless</font><font color="#E5E5E5"> system and it</font>

154
00:07:58,009 --> 00:08:02,539
<font color="#CCCCCC">communicates wirelessly</font><font color="#E5E5E5"> and the question</font>

155
00:07:59,779 --> 00:08:04,729
to ask here<font color="#E5E5E5"> is is the</font><font color="#CCCCCC"> protocol secure</font>

156
00:08:02,539 --> 00:08:06,318
<font color="#E5E5E5">because for the wireless system is even</font>

157
00:08:04,729 --> 00:08:08,479
more important<font color="#E5E5E5"> because there's</font><font color="#CCCCCC"> nothing</font>

158
00:08:06,319 --> 00:08:11,379
preventing<font color="#E5E5E5"> the attacker from capturing</font>

159
00:08:08,479 --> 00:08:13,490
the data<font color="#CCCCCC"> it's simply about decryption I</font>

160
00:08:11,379 --> 00:08:15,949
want to acknowledge<font color="#E5E5E5"> some prior research</font>

161
00:08:13,490 --> 00:08:18,769
has been done on particular systems as

162
00:08:15,949 --> 00:08:21,169
well<font color="#CCCCCC"> so there's been</font><font color="#E5E5E5"> some work on</font>

163
00:08:18,769 --> 00:08:23,749
<font color="#E5E5E5">interfacing with SP series</font><font color="#CCCCCC"> the spectral</font>

164
00:08:21,169 --> 00:08:25,490
series the low<font color="#E5E5E5"> security series via</font>

165
00:08:23,749 --> 00:08:28,969
<font color="#CCCCCC">combis it's been done by Martyn</font>

166
00:08:25,490 --> 00:08:30,830
<font color="#CCCCCC">horizon-- of</font><font color="#E5E5E5"> and he did publish a</font>

167
00:08:28,969 --> 00:08:32,630
partially<font color="#E5E5E5"> working code</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> small bit of</font>

168
00:08:30,830 --> 00:08:35,568
<font color="#E5E5E5">code but moved on to doing serial</font>

169
00:08:32,630 --> 00:08:38,500
research and there's been some<font color="#E5E5E5"> work on</font>

170
00:08:35,568 --> 00:08:42,769
working with<font color="#E5E5E5"> Mogollon systems via serial</font>

171
00:08:38,500 --> 00:08:44,720
<font color="#CCCCCC">it's all our forms but there's this one</font>

172
00:08:42,769 --> 00:08:47,420
one<font color="#E5E5E5"> person from Lithuania which is a</font>

173
00:08:44,720 --> 00:08:49,939
country<font color="#E5E5E5"> nearby</font><font color="#CCCCCC"> Latvia</font><font color="#E5E5E5"> Gettys Romanovs</font>

174
00:08:47,420 --> 00:08:52,969
cos who<font color="#E5E5E5"> actually posted some code</font><font color="#CCCCCC"> on</font>

175
00:08:49,939 --> 00:08:54,860
github<font color="#E5E5E5"> but once again this code</font>

176
00:08:52,970 --> 00:08:57,439
the deal with<font color="#CCCCCC"> cereal and</font><font color="#E5E5E5"> I'm gonna show</font>

177
00:08:54,860 --> 00:08:59,990
<font color="#E5E5E5">you in a minute why it's not applicable</font>

178
00:08:57,439 --> 00:09:02,209
to possible security<font color="#E5E5E5"> attacks</font><font color="#CCCCCC"> it's good</font>

179
00:08:59,990 --> 00:09:04,160
<font color="#E5E5E5">to interface with</font><font color="#CCCCCC"> your system but</font>

180
00:09:02,209 --> 00:09:09,410
security is not really directly<font color="#E5E5E5"> affected</font>

181
00:09:04,160 --> 00:09:11,029
from that of<font color="#E5E5E5"> course when I found the</font>

182
00:09:09,410 --> 00:09:13,279
problems<font color="#E5E5E5"> I'm talking about</font><font color="#CCCCCC"> today I</font>

183
00:09:11,029 --> 00:09:16,100
<font color="#E5E5E5">contacted</font><font color="#CCCCCC"> the company</font>

184
00:09:13,279 --> 00:09:20,509
<font color="#CCCCCC">Bartek</font><font color="#E5E5E5"> security systems what I got at</font>

185
00:09:16,100 --> 00:09:22,459
first<font color="#E5E5E5"> was you</font><font color="#CCCCCC"> know we don't think you</font>

186
00:09:20,509 --> 00:09:24,110
actually<font color="#E5E5E5"> have anything so I just sent an</font>

187
00:09:22,459 --> 00:09:26,119
<font color="#E5E5E5">email saying hey</font><font color="#CCCCCC"> I found</font><font color="#E5E5E5"> the problem</font>

188
00:09:24,110 --> 00:09:29,540
<font color="#CCCCCC">your system say</font><font color="#E5E5E5"> you know the answer</font><font color="#CCCCCC"> no</font>

189
00:09:26,120 --> 00:09:32,480
you're<font color="#E5E5E5"> not sure</font><font color="#CCCCCC"> and they asked for</font><font color="#E5E5E5"> more</font>

190
00:09:29,540 --> 00:09:34,939
data<font color="#E5E5E5"> so as a huge researcher I of course</font>

191
00:09:32,480 --> 00:09:36,680
<font color="#E5E5E5">went ahead and tried to establish a</font>

192
00:09:34,939 --> 00:09:40,599
secure contact with their<font color="#E5E5E5"> security team</font>

193
00:09:36,680 --> 00:09:44,029
<font color="#E5E5E5">instead of just sending it to support</font><font color="#CCCCCC"> I</font>

194
00:09:40,600 --> 00:09:45,709
was met with what was<font color="#E5E5E5"> clearly no process</font>

195
00:09:44,029 --> 00:09:47,949
<font color="#E5E5E5">there was</font><font color="#CCCCCC"> no responsible slaughter no</font>

196
00:09:45,709 --> 00:09:51,050
vulnerability handled process there<font color="#CCCCCC"> I</font>

197
00:09:47,949 --> 00:09:52,430
ended up talking with with the support

198
00:09:51,050 --> 00:09:55,160
they promised<font color="#CCCCCC"> to</font><font color="#E5E5E5"> forward some of my</font>

199
00:09:52,430 --> 00:09:56,719
emails<font color="#CCCCCC"> to security</font><font color="#E5E5E5"> and the last email</font>

200
00:09:55,160 --> 00:09:58,969
<font color="#E5E5E5">the last technical email</font><font color="#CCCCCC"> was sent</font><font color="#E5E5E5"> to</font>

201
00:09:56,720 --> 00:10:01,610
<font color="#E5E5E5">them was you</font><font color="#CCCCCC"> know there's a problem on</font>

202
00:09:58,970 --> 00:10:04,790
the comm bus you can intercept the codes

203
00:10:01,610 --> 00:10:07,160
<font color="#CCCCCC">that was as technical as I got and they</font>

204
00:10:04,790 --> 00:10:08,930
said<font color="#CCCCCC"> Thanks the information</font><font color="#E5E5E5"> has been</font>

205
00:10:07,160 --> 00:10:11,000
<font color="#E5E5E5">dealt with even</font><font color="#CCCCCC"> though I never</font><font color="#E5E5E5"> got</font><font color="#CCCCCC"> to</font>

206
00:10:08,930 --> 00:10:12,969
send<font color="#E5E5E5"> them my proof of concept or or</font>

207
00:10:11,000 --> 00:10:16,040
describe what it is<font color="#CCCCCC"> exactly so I</font>

208
00:10:12,970 --> 00:10:17,660
inquired<font color="#E5E5E5"> further and what I got was this</font>

209
00:10:16,040 --> 00:10:19,279
<font color="#E5E5E5">magnificent email and for obvious</font>

210
00:10:17,660 --> 00:10:20,660
<font color="#CCCCCC">security reasons it is our</font><font color="#E5E5E5"> policy to</font>

211
00:10:19,279 --> 00:10:23,089
<font color="#E5E5E5">never discuss engineering matters</font>

212
00:10:20,660 --> 00:10:24,290
outside<font color="#CCCCCC"> of the company and thus we</font><font color="#E5E5E5"> will</font>

213
00:10:23,089 --> 00:10:27,769
<font color="#E5E5E5">not be commenting further than this</font>

214
00:10:24,290 --> 00:10:30,290
issue so I gave them<font color="#E5E5E5"> some time and a</font>

215
00:10:27,769 --> 00:10:34,579
<font color="#CCCCCC">couple years later I'm here</font><font color="#E5E5E5"> doing public</font>

216
00:10:30,290 --> 00:10:38,719
disclosure<font color="#E5E5E5"> on on the thing</font><font color="#CCCCCC"> so let's take</font>

217
00:10:34,579 --> 00:10:41,239
a look at how the system<font color="#CCCCCC"> is</font><font color="#E5E5E5"> set up each</font>

218
00:10:38,720 --> 00:10:43,910
of their<font color="#E5E5E5"> security systems is modular but</font>

219
00:10:41,240 --> 00:10:45,769
it does consists of the master<font color="#E5E5E5"> that</font><font color="#CCCCCC"> is</font>

220
00:10:43,910 --> 00:10:47,600
<font color="#CCCCCC">the master panel is the heart</font><font color="#E5E5E5"> of the</font>

221
00:10:45,769 --> 00:10:50,300
<font color="#CCCCCC">system you can call it</font><font color="#E5E5E5"> the motherboard</font>

222
00:10:47,600 --> 00:10:52,490
<font color="#E5E5E5">this is a cheaper version from spectra</font>

223
00:10:50,300 --> 00:10:55,069
this is SP 65 in fact the cheapest one

224
00:10:52,490 --> 00:10:59,300
you<font color="#E5E5E5"> can get I think is around 40 euros</font>

225
00:10:55,069 --> 00:11:01,339
maybe<font color="#E5E5E5"> 50 euros to get this one then we</font>

226
00:10:59,300 --> 00:11:03,439
have<font color="#E5E5E5"> some ancillary</font><font color="#CCCCCC"> x' right</font><font color="#E5E5E5"> you need</font>

227
00:11:01,339 --> 00:11:04,730
<font color="#CCCCCC">the</font><font color="#E5E5E5"> battery in case the bad guys</font><font color="#CCCCCC"> cut</font>

228
00:11:03,439 --> 00:11:06,860
your power supply you still need the

229
00:11:04,730 --> 00:11:07,110
system<font color="#E5E5E5"> to</font><font color="#CCCCCC"> work</font><font color="#E5E5E5"> of course you have the</font>

230
00:11:06,860 --> 00:11:09,660
power

231
00:11:07,110 --> 00:11:12,600
supply as<font color="#E5E5E5"> well like transformer you have</font>

232
00:11:09,660 --> 00:11:15,000
a siren<font color="#CCCCCC"> like a loudspeaker</font><font color="#E5E5E5"> that that</font>

233
00:11:12,600 --> 00:11:17,490
alerts your neighbors<font color="#E5E5E5"> when an intrusion</font>

234
00:11:15,000 --> 00:11:19,230
happening of<font color="#CCCCCC"> course there are combat</font>

235
00:11:17,490 --> 00:11:23,250
slaves<font color="#E5E5E5"> and this presentation is actually</font>

236
00:11:19,230 --> 00:11:25,680
focusing<font color="#E5E5E5"> on</font><font color="#CCCCCC"> compass specifically so we</font>

237
00:11:23,250 --> 00:11:27,120
<font color="#CCCCCC">are going</font><font color="#E5E5E5"> to look at the</font><font color="#CCCCCC"> Commerce</font>

238
00:11:25,680 --> 00:11:29,790
protocol and these are some of<font color="#E5E5E5"> the</font>

239
00:11:27,120 --> 00:11:32,070
examples of<font color="#E5E5E5"> Campos devices the feature</font>

240
00:11:29,790 --> 00:11:34,860
of<font color="#CCCCCC"> combis this common</font><font color="#E5E5E5"> bus it's a</font>

241
00:11:32,070 --> 00:11:37,890
<font color="#CCCCCC">property</font><font color="#E5E5E5"> bus made by them is that it</font>

242
00:11:34,860 --> 00:11:39,660
provides two-way communication so the

243
00:11:37,890 --> 00:11:42,529
slave<font color="#E5E5E5"> device can</font><font color="#CCCCCC"> communicate with the</font>

244
00:11:39,660 --> 00:11:45,600
panel<font color="#CCCCCC"> with the master device</font><font color="#E5E5E5"> both ways</font>

245
00:11:42,529 --> 00:11:48,689
<font color="#CCCCCC">notable example of kombis slave is a</font>

246
00:11:45,600 --> 00:11:49,890
keypad every keypad is a combo slave but

247
00:11:48,690 --> 00:11:51,660
<font color="#E5E5E5">there are also some other examples</font><font color="#CCCCCC"> like</font>

248
00:11:49,890 --> 00:11:53,640
here you<font color="#CCCCCC"> can</font><font color="#E5E5E5"> see this green one it's a</font>

249
00:11:51,660 --> 00:11:56,610
printer module so you<font color="#E5E5E5"> can as you can see</font>

250
00:11:53,640 --> 00:11:58,890
you can connect<font color="#E5E5E5"> the</font><font color="#CCCCCC"> good-old parallel</font>

251
00:11:56,610 --> 00:12:00,450
port to connect the printer<font color="#E5E5E5"> you can use</font>

252
00:11:58,890 --> 00:12:02,430
a serial port and<font color="#E5E5E5"> you</font><font color="#CCCCCC"> can use even the</font>

253
00:12:00,450 --> 00:12:03,690
USB so in case you want<font color="#CCCCCC"> to connect a</font>

254
00:12:02,430 --> 00:12:06,269
printer<font color="#E5E5E5"> to your alarm system you're</font>

255
00:12:03,690 --> 00:12:08,579
covered so you<font color="#E5E5E5"> can use</font><font color="#CCCCCC"> com+ to connect</font>

256
00:12:06,269 --> 00:12:10,019
to<font color="#E5E5E5"> to your printer or there are some</font>

257
00:12:08,579 --> 00:12:12,839
other devices like<font color="#E5E5E5"> listening where you</font>

258
00:12:10,019 --> 00:12:14,880
can call a<font color="#E5E5E5"> system and spy on on what's</font>

259
00:12:12,839 --> 00:12:21,839
happening in<font color="#E5E5E5"> in your apartment or in</font>

260
00:12:14,880 --> 00:12:23,870
your office<font color="#E5E5E5"> via microphone of course</font>

261
00:12:21,839 --> 00:12:26,670
every year alarm system has to have

262
00:12:23,870 --> 00:12:29,459
sensors<font color="#E5E5E5"> and those are</font><font color="#CCCCCC"> zone interrupt</font>

263
00:12:26,670 --> 00:12:32,370
devices in paradox<font color="#CCCCCC"> which means it's just</font>

264
00:12:29,459 --> 00:12:34,439
an<font color="#CCCCCC"> input device</font><font color="#E5E5E5"> two wires ground and and</font>

265
00:12:32,370 --> 00:12:36,390
<font color="#CCCCCC">jean-jean wire and it measures measures</font>

266
00:12:34,440 --> 00:12:38,630
<font color="#E5E5E5">resistance which allows</font><font color="#CCCCCC"> for chaining</font><font color="#E5E5E5"> you</font>

267
00:12:36,390 --> 00:12:40,920
can connect multiple of them on<font color="#E5E5E5"> one line</font>

268
00:12:38,630 --> 00:12:43,079
<font color="#E5E5E5">and some of the examples</font><font color="#CCCCCC"> are magnetic</font>

269
00:12:40,920 --> 00:12:45,390
sensors passive infrared sensors<font color="#E5E5E5"> panic</font>

270
00:12:43,079 --> 00:12:47,939
buttons the simple stuff<font color="#E5E5E5"> and it's one</font>

271
00:12:45,390 --> 00:12:50,130
<font color="#E5E5E5">way you only get input from the device</font>

272
00:12:47,940 --> 00:12:54,600
you<font color="#CCCCCC"> cannot cannot communicate it back</font>

273
00:12:50,130 --> 00:12:58,160
and<font color="#CCCCCC"> PJM modules</font><font color="#E5E5E5"> is just around this is</font>

274
00:12:54,600 --> 00:13:01,079
<font color="#CCCCCC">output this allows you</font><font color="#E5E5E5"> to configure your</font>

275
00:12:58,160 --> 00:13:03,420
alarm<font color="#CCCCCC"> system on specific</font><font color="#E5E5E5"> conditions on</font>

276
00:13:01,079 --> 00:13:06,300
specific criteria<font color="#E5E5E5"> like say movement in</font>

277
00:13:03,420 --> 00:13:11,189
area 1 but not area 2 or zone 1 and zone

278
00:13:06,300 --> 00:13:13,949
2 to switch on a PGM output and<font color="#E5E5E5"> it can</font>

279
00:13:11,190 --> 00:13:16,560
drive a device up<font color="#E5E5E5"> to 100 milliamps</font><font color="#CCCCCC"> which</font>

280
00:13:13,949 --> 00:13:19,500
<font color="#CCCCCC">really with a really with</font><font color="#E5E5E5"> the relay you</font>

281
00:13:16,560 --> 00:13:21,229
can of course<font color="#CCCCCC"> drive like a light bulb or</font>

282
00:13:19,500 --> 00:13:23,220
something<font color="#CCCCCC"> more powerful</font>

283
00:13:21,230 --> 00:13:25,770
so that's another<font color="#E5E5E5"> thing that</font><font color="#CCCCCC"> we have</font>

284
00:13:23,220 --> 00:13:28,080
there<font color="#E5E5E5"> and of</font><font color="#CCCCCC"> course there</font><font color="#E5E5E5"> are serial</font>

285
00:13:25,770 --> 00:13:30,990
devices<font color="#E5E5E5"> which is what most of the</font>

286
00:13:28,080 --> 00:13:34,380
research<font color="#E5E5E5"> has been on so far</font><font color="#CCCCCC"> it's an</font>

287
00:13:30,990 --> 00:13:36,030
rs-485 protocol and some<font color="#E5E5E5"> examples</font>

288
00:13:34,380 --> 00:13:41,070
include serial converters<font color="#CCCCCC"> that convert</font>

289
00:13:36,030 --> 00:13:43,050
it to<font color="#E5E5E5"> USB or or classic serial rs-232 IP</font>

290
00:13:41,070 --> 00:13:45,600
modules just<font color="#CCCCCC"> send modules so mention</font>

291
00:13:43,050 --> 00:13:48,569
that this device which is as we will see

292
00:13:45,600 --> 00:13:50,990
<font color="#CCCCCC">today not very secure it even has IP</font>

293
00:13:48,570 --> 00:13:53,850
connectivity these days and you know

294
00:13:50,990 --> 00:13:56,100
it's on the internet out there<font color="#E5E5E5"> with</font>

295
00:13:53,850 --> 00:13:57,870
protocols<font color="#E5E5E5"> that</font><font color="#CCCCCC"> are written</font><font color="#E5E5E5"> I would</font>

296
00:13:56,100 --> 00:14:02,000
<font color="#E5E5E5">imagine a quality similar to what we'll</font>

297
00:13:57,870 --> 00:14:06,090
see<font color="#E5E5E5"> today and today we're looking at</font>

298
00:14:02,000 --> 00:14:08,990
<font color="#CCCCCC">level 192 which is the expensive one</font>

299
00:14:06,090 --> 00:14:11,460
<font color="#E5E5E5">this is the secure one the high security</font>

300
00:14:08,990 --> 00:14:14,670
<font color="#E5E5E5">system this is what we have here today</font>

301
00:14:11,460 --> 00:14:16,770
<font color="#CCCCCC">and I'd like to</font><font color="#E5E5E5"> point out some</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the</font>

302
00:14:14,670 --> 00:14:18,479
<font color="#CCCCCC">things on the panel right</font><font color="#E5E5E5"> remember I'm</font>

303
00:14:16,770 --> 00:14:19,980
going<font color="#E5E5E5"> through step step by step so</font>

304
00:14:18,480 --> 00:14:23,280
everyone can follow and everyone<font color="#E5E5E5"> can</font>

305
00:14:19,980 --> 00:14:24,870
repeat the research<font color="#E5E5E5"> if they intend to so</font>

306
00:14:23,280 --> 00:14:27,540
if<font color="#E5E5E5"> you look at the panel we of course</font>

307
00:14:24,870 --> 00:14:29,490
have<font color="#E5E5E5"> some power connectors right we have</font>

308
00:14:27,540 --> 00:14:31,469
according<font color="#CCCCCC"> to the</font><font color="#E5E5E5"> instruction manual we</font>

309
00:14:29,490 --> 00:14:34,710
have<font color="#CCCCCC"> sixteen point five</font><font color="#E5E5E5"> volts AC</font>

310
00:14:31,470 --> 00:14:36,690
alternating current input there through

311
00:14:34,710 --> 00:14:39,420
the transformer<font color="#E5E5E5"> we have the battery</font>

312
00:14:36,690 --> 00:14:41,760
connector for<font color="#CCCCCC"> 12-volt</font><font color="#E5E5E5"> acid battery and</font>

313
00:14:39,420 --> 00:14:44,280
we have the real-time<font color="#E5E5E5"> clock battery for</font>

314
00:14:41,760 --> 00:14:46,200
three<font color="#CCCCCC"> volts which is</font><font color="#E5E5E5"> used when your main</font>

315
00:14:44,280 --> 00:14:48,980
battery fails<font color="#E5E5E5"> an alarm system doesn't</font>

316
00:14:46,200 --> 00:14:53,580
<font color="#E5E5E5">work</font><font color="#CCCCCC"> at all at least your clock stays</font>

317
00:14:48,980 --> 00:14:54,840
<font color="#CCCCCC">moving</font><font color="#E5E5E5"> forward we have the</font><font color="#CCCCCC"> kombis which</font>

318
00:14:53,580 --> 00:14:58,430
is what we're<font color="#CCCCCC"> talking about here</font><font color="#E5E5E5"> today</font>

319
00:14:54,840 --> 00:15:03,630
so the<font color="#CCCCCC"> combis consists of four wires</font>

320
00:14:58,430 --> 00:15:06,359
here<font color="#E5E5E5"> and nicely for the Installer</font>

321
00:15:03,630 --> 00:15:07,680
there's also another<font color="#CCCCCC"> comm bus connector</font>

322
00:15:06,360 --> 00:15:09,750
called serial keypad where you can

323
00:15:07,680 --> 00:15:12,300
connect directly on the panel but for an

324
00:15:09,750 --> 00:15:14,550
attacker the panel is usually hidden far

325
00:15:12,300 --> 00:15:18,270
away from<font color="#E5E5E5"> the door it's usually</font><font color="#CCCCCC"> hidden</font>

326
00:15:14,550 --> 00:15:19,920
the<font color="#CCCCCC"> furthest corner of the building</font>

327
00:15:18,270 --> 00:15:23,520
<font color="#CCCCCC">where you</font><font color="#E5E5E5"> cannot access it and it's</font>

328
00:15:19,920 --> 00:15:25,140
<font color="#E5E5E5">correct</font><font color="#CCCCCC"> to do so</font><font color="#E5E5E5"> so we're more</font>

329
00:15:23,520 --> 00:15:27,079
interested<font color="#CCCCCC"> in</font><font color="#E5E5E5"> the compass it actually</font>

330
00:15:25,140 --> 00:15:30,240
goes to the keypads<font color="#E5E5E5"> and other</font>

331
00:15:27,080 --> 00:15:33,960
intelligent<font color="#E5E5E5"> devices and of course I</font>

332
00:15:30,240 --> 00:15:34,800
can't skip and I have to mention the

333
00:15:33,960 --> 00:15:36,209
other

334
00:15:34,800 --> 00:15:38,719
protocols that<font color="#CCCCCC"> are</font><font color="#E5E5E5"> there</font><font color="#CCCCCC"> on the panel</font>

335
00:15:36,209 --> 00:15:42,599
the serial protocol<font color="#E5E5E5"> rs-485 of course</font>

336
00:15:38,720 --> 00:15:44,940
voice dialer which<font color="#E5E5E5"> is used for dialing</font><font color="#CCCCCC"> a</font>

337
00:15:42,600 --> 00:15:46,769
<font color="#E5E5E5">modem via voice you know calling the</font>

338
00:15:44,940 --> 00:15:48,450
police automatically<font color="#E5E5E5"> and saying we're</font>

339
00:15:46,769 --> 00:15:51,750
being there's a<font color="#CCCCCC"> break-in come to this</font>

340
00:15:48,450 --> 00:15:53,339
<font color="#E5E5E5">address</font><font color="#CCCCCC"> and Menke</font><font color="#E5E5E5"> this is quite a cool</font>

341
00:15:51,750 --> 00:15:56,610
one and if someone would like<font color="#CCCCCC"> to</font>

342
00:15:53,339 --> 00:15:58,800
<font color="#E5E5E5">research it I'd be glad so main key is</font>

343
00:15:56,610 --> 00:16:00,779
<font color="#E5E5E5">this interesting protocol where they</font>

344
00:15:58,800 --> 00:16:03,000
have this USB<font color="#E5E5E5"> stick</font><font color="#CCCCCC"> that you can plug</font><font color="#E5E5E5"> in</font>

345
00:16:00,779 --> 00:16:04,500
<font color="#E5E5E5">the</font><font color="#CCCCCC"> computer and then the second side of</font>

346
00:16:03,000 --> 00:16:06,839
<font color="#E5E5E5">the stick</font><font color="#CCCCCC"> you have a connector that goes</font>

347
00:16:04,500 --> 00:16:09,540
<font color="#E5E5E5">into there into mem key if you</font><font color="#CCCCCC"> plug it</font>

348
00:16:06,839 --> 00:16:11,399
into the panel<font color="#E5E5E5"> it can either copy all</font>

349
00:16:09,540 --> 00:16:13,050
the control configuration from<font color="#E5E5E5"> the panel</font>

350
00:16:11,399 --> 00:16:14,910
<font color="#E5E5E5">or write the</font><font color="#CCCCCC"> configuration from</font><font color="#E5E5E5"> the USB</font>

351
00:16:13,050 --> 00:16:16,649
<font color="#E5E5E5">key to the panel so it's quite a cool</font>

352
00:16:14,910 --> 00:16:20,839
one<font color="#CCCCCC"> I would</font><font color="#E5E5E5"> imagine there might be some</font>

353
00:16:16,649 --> 00:16:20,839
security<font color="#E5E5E5"> vulnerabilities there as well</font>

354
00:16:21,079 --> 00:16:28,229
<font color="#E5E5E5">so how do</font><font color="#CCCCCC"> we proceed with reverse</font>

355
00:16:25,019 --> 00:16:33,510
engineering this<font color="#E5E5E5"> panel this high</font>

356
00:16:28,230 --> 00:16:36,779
security panel these are the<font color="#E5E5E5"> hardware</font>

357
00:16:33,510 --> 00:16:39,060
tools that you'll<font color="#CCCCCC"> need digital signal</font>

358
00:16:36,779 --> 00:16:41,189
oscilloscope<font color="#E5E5E5"> can also help a lot I</font>

359
00:16:39,060 --> 00:16:42,869
<font color="#E5E5E5">started with that but turned out I</font>

360
00:16:41,190 --> 00:16:45,420
didn't need<font color="#CCCCCC"> to so you</font><font color="#E5E5E5"> have</font><font color="#CCCCCC"> a logic</font>

361
00:16:42,870 --> 00:16:49,110
analyzer<font color="#CCCCCC"> you have an let's say Arduino</font>

362
00:16:45,420 --> 00:16:50,819
Uno<font color="#CCCCCC"> that you can</font><font color="#E5E5E5"> use to talk to</font><font color="#CCCCCC"> the</font>

363
00:16:49,110 --> 00:16:53,430
device right you have these ports<font color="#E5E5E5"> here</font>

364
00:16:50,820 --> 00:16:58,500
that you can<font color="#E5E5E5"> use to connect to the</font>

365
00:16:53,430 --> 00:17:03,060
<font color="#E5E5E5">device now let's take a closer look at</font>

366
00:16:58,500 --> 00:17:06,209
comm<font color="#E5E5E5"> bus</font><font color="#CCCCCC"> so as we know come</font><font color="#E5E5E5"> bus consists</font>

367
00:17:03,060 --> 00:17:07,770
of<font color="#CCCCCC"> four wires and if we take a look at</font>

368
00:17:06,209 --> 00:17:11,339
an installation we<font color="#E5E5E5"> will see the wires</font>

369
00:17:07,770 --> 00:17:16,109
use the colors red black green and

370
00:17:11,339 --> 00:17:18,418
<font color="#E5E5E5">yellow it's a four wire brass</font><font color="#CCCCCC"> one thing</font>

371
00:17:16,109 --> 00:17:21,059
particular about<font color="#E5E5E5"> combos is that all the</font>

372
00:17:18,419 --> 00:17:24,660
slaves<font color="#E5E5E5"> and the master are electrically</font>

373
00:17:21,059 --> 00:17:26,220
connected<font color="#E5E5E5"> on each of the wires so it's a</font>

374
00:17:24,660 --> 00:17:28,199
direct connection there's no magic

375
00:17:26,220 --> 00:17:30,660
there's no switches nor routers nothing

376
00:17:28,199 --> 00:17:33,380
like that it's a it's an electric level

377
00:17:30,660 --> 00:17:37,760
<font color="#E5E5E5">connection between all of them in</font>

378
00:17:33,380 --> 00:17:41,370
practice it of<font color="#E5E5E5"> course means that what</font>

379
00:17:37,760 --> 00:17:43,530
one slave sees all the other slaves see

380
00:17:41,370 --> 00:17:47,409
as well<font color="#E5E5E5"> because there are</font><font color="#CCCCCC"> no active</font>

381
00:17:43,530 --> 00:17:51,460
components on the wire<font color="#E5E5E5"> even no diode sir</font>

382
00:17:47,410 --> 00:17:54,910
all the slaves<font color="#E5E5E5"> communicate in the same</font>

383
00:17:51,460 --> 00:17:58,510
space<font color="#E5E5E5"> now if you look at the right side</font>

384
00:17:54,910 --> 00:18:03,880
of<font color="#CCCCCC"> the slide</font><font color="#E5E5E5"> these are some layers that</font>

385
00:17:58,510 --> 00:18:06,280
I deduced<font color="#E5E5E5"> might be under combos so this</font>

386
00:18:03,880 --> 00:18:09,580
is not official documentation<font color="#E5E5E5"> this is</font>

387
00:18:06,280 --> 00:18:11,320
just what I looking at<font color="#CCCCCC"> comm bus protocol</font>

388
00:18:09,580 --> 00:18:12,669
how I structured it<font color="#E5E5E5"> so</font><font color="#CCCCCC"> it's easier for</font>

389
00:18:11,320 --> 00:18:14,470
<font color="#E5E5E5">me</font><font color="#CCCCCC"> to talk</font><font color="#E5E5E5"> about it</font>

390
00:18:12,670 --> 00:18:17,260
so there's electrical layer at the

391
00:18:14,470 --> 00:18:20,550
<font color="#E5E5E5">bottom</font><font color="#CCCCCC"> electrical layer talks about</font>

392
00:18:17,260 --> 00:18:23,800
voltage levels about<font color="#E5E5E5"> which wire is which</font>

393
00:18:20,550 --> 00:18:25,780
<font color="#E5E5E5">right then we have</font><font color="#CCCCCC"> the signal layer over</font>

394
00:18:23,800 --> 00:18:28,800
there and signal layer<font color="#E5E5E5"> talks about</font>

395
00:18:25,780 --> 00:18:32,440
frequency<font color="#E5E5E5"> the clock cycle</font><font color="#CCCCCC"> the bit with</font>

396
00:18:28,800 --> 00:18:34,210
<font color="#CCCCCC">that delay between packets so that's</font>

397
00:18:32,440 --> 00:18:37,750
level<font color="#CCCCCC"> stop signal level stop</font><font color="#E5E5E5"> then we</font>

398
00:18:34,210 --> 00:18:40,240
have the<font color="#CCCCCC"> Acathla</font><font color="#E5E5E5"> and packet layer</font><font color="#CCCCCC"> talks</font>

399
00:18:37,750 --> 00:18:43,750
<font color="#E5E5E5">about packet format how the</font><font color="#CCCCCC"> checks infer</font>

400
00:18:40,240 --> 00:18:45,910
made the command layer<font color="#E5E5E5"> describe</font>

401
00:18:43,750 --> 00:18:48,550
different commands<font color="#E5E5E5"> that</font><font color="#CCCCCC"> exists on</font><font color="#E5E5E5"> the</font>

402
00:18:45,910 --> 00:18:51,850
comm bus<font color="#E5E5E5"> and finally the payload layer</font>

403
00:18:48,550 --> 00:18:54,550
talks about encoding<font color="#E5E5E5"> some of the data so</font>

404
00:18:51,850 --> 00:18:57,610
<font color="#E5E5E5">I did a full analysis on on</font><font color="#CCCCCC"> kompis and</font>

405
00:18:54,550 --> 00:19:00,040
this is what I came<font color="#E5E5E5"> up</font><font color="#CCCCCC"> with</font><font color="#E5E5E5"> let's take a</font>

406
00:18:57,610 --> 00:19:01,300
look at it layer<font color="#CCCCCC"> by layer</font><font color="#E5E5E5"> so once</font><font color="#CCCCCC"> again</font>

407
00:19:00,040 --> 00:19:03,909
how can<font color="#E5E5E5"> you reverse engineer yourself</font>

408
00:19:01,300 --> 00:19:06,010
<font color="#CCCCCC">right if you if you buy a demo</font><font color="#E5E5E5"> kit like</font>

409
00:19:03,910 --> 00:19:09,670
that for I don't<font color="#CCCCCC"> know</font><font color="#E5E5E5"> like a couple</font>

410
00:19:06,010 --> 00:19:11,830
<font color="#CCCCCC">hundred</font><font color="#E5E5E5"> euros and you look at the keypad</font>

411
00:19:09,670 --> 00:19:13,780
this is what you get<font color="#E5E5E5"> right if you turn</font>

412
00:19:11,830 --> 00:19:15,429
the keypad around<font color="#E5E5E5"> on the other side you</font>

413
00:19:13,780 --> 00:19:18,340
will<font color="#CCCCCC"> see these connectors</font><font color="#E5E5E5"> and you will</font>

414
00:19:15,430 --> 00:19:19,990
see some wires going<font color="#E5E5E5"> in this white large</font>

415
00:19:18,340 --> 00:19:24,580
wire here is the<font color="#E5E5E5"> compas it goes to your</font>

416
00:19:19,990 --> 00:19:26,590
<font color="#E5E5E5">panel you may also have a zone connector</font>

417
00:19:24,580 --> 00:19:28,750
here<font color="#E5E5E5"> right if you have let's say the</font>

418
00:19:26,590 --> 00:19:32,040
keypad<font color="#E5E5E5"> is</font><font color="#CCCCCC"> near a door the zone connector</font>

419
00:19:28,750 --> 00:19:35,260
might go to the<font color="#CCCCCC"> sensor on</font><font color="#E5E5E5"> the door and</font>

420
00:19:32,040 --> 00:19:38,649
then it would be sent through<font color="#CCCCCC"> the combis</font>

421
00:19:35,260 --> 00:19:40,090
<font color="#CCCCCC">to the panel itself but you're</font>

422
00:19:38,650 --> 00:19:42,880
<font color="#E5E5E5">interested in the</font><font color="#CCCCCC"> combos here which is</font>

423
00:19:40,090 --> 00:19:44,740
<font color="#E5E5E5">yellow green black and red so not</font>

424
00:19:42,880 --> 00:19:46,960
<font color="#E5E5E5">knowing anything about the system what</font>

425
00:19:44,740 --> 00:19:49,360
is something<font color="#CCCCCC"> that</font><font color="#E5E5E5"> we can do we can</font><font color="#CCCCCC"> take</font>

426
00:19:46,960 --> 00:19:53,440
a multimeter<font color="#E5E5E5"> and we can start sticking</font>

427
00:19:49,360 --> 00:19:53,889
<font color="#E5E5E5">it in different places on</font><font color="#CCCCCC"> the keypad of</font>

428
00:19:53,440 --> 00:19:56,560
course

429
00:19:53,890 --> 00:19:59,500
so we've already identified<font color="#CCCCCC"> that these</font>

430
00:19:56,560 --> 00:20:01,270
four<font color="#E5E5E5"> wires are the</font><font color="#CCCCCC"> combos and black and</font>

431
00:19:59,500 --> 00:20:03,159
red<font color="#CCCCCC"> as we know</font><font color="#E5E5E5"> from</font>

432
00:20:01,270 --> 00:20:04,600
Electrical Engineering is usually used

433
00:20:03,159 --> 00:20:08,529
for<font color="#E5E5E5"> powering right so let's try those</font>

434
00:20:04,600 --> 00:20:10,149
<font color="#E5E5E5">let's measure voltage at first let's</font>

435
00:20:08,529 --> 00:20:11,590
measure resistance<font color="#CCCCCC"> between black and</font><font color="#E5E5E5"> the</font>

436
00:20:10,149 --> 00:20:13,570
ground<font color="#CCCCCC"> let's see if it's</font><font color="#E5E5E5"> really the</font>

437
00:20:11,590 --> 00:20:15,309
ground<font color="#E5E5E5"> right and measuring resistance we</font>

438
00:20:13,570 --> 00:20:17,980
get 0 that means black is our ground

439
00:20:15,309 --> 00:20:20,110
<font color="#E5E5E5">right then we can measure the</font><font color="#CCCCCC"> voltage</font>

440
00:20:17,980 --> 00:20:23,200
between black<font color="#CCCCCC"> and red</font><font color="#E5E5E5"> it measures the</font>

441
00:20:20,110 --> 00:20:25,570
<font color="#CCCCCC">voltage we get a stable DC</font><font color="#E5E5E5"> direct</font>

442
00:20:23,200 --> 00:20:29,289
<font color="#E5E5E5">current on there that means red is power</font>

443
00:20:25,570 --> 00:20:30,879
<font color="#E5E5E5">right so we have clearly</font><font color="#CCCCCC"> identified the</font>

444
00:20:29,289 --> 00:20:33,220
black and the<font color="#E5E5E5"> red wire</font><font color="#CCCCCC"> they're</font><font color="#E5E5E5"> just two</font>

445
00:20:30,880 --> 00:20:35,950
<font color="#E5E5E5">wires remaining the yellow and the green</font>

446
00:20:33,220 --> 00:20:39,700
<font color="#E5E5E5">right so we can</font><font color="#CCCCCC"> plug our multimeter in</font>

447
00:20:35,950 --> 00:20:41,289
there and you know we don't get any

448
00:20:39,700 --> 00:20:44,169
normal voltage reading do we get it

449
00:20:41,289 --> 00:20:46,120
fluctuating a bit so those might<font color="#E5E5E5"> be date</font>

450
00:20:44,169 --> 00:20:50,649
wires but<font color="#E5E5E5"> you have to go deeper we have</font>

451
00:20:46,120 --> 00:20:53,408
to go further<font color="#E5E5E5"> so to do that we have to</font>

452
00:20:50,649 --> 00:20:56,139
<font color="#E5E5E5">look at the signal layer and if we use a</font>

453
00:20:53,409 --> 00:20:58,390
<font color="#E5E5E5">device</font><font color="#CCCCCC"> like salad logic</font><font color="#E5E5E5"> analyzer</font><font color="#CCCCCC"> that I</font>

454
00:20:56,140 --> 00:20:59,669
showed<font color="#CCCCCC"> you</font><font color="#E5E5E5"> previously this</font><font color="#CCCCCC"> is what</font><font color="#E5E5E5"> we</font>

455
00:20:58,390 --> 00:21:03,399
get

456
00:20:59,669 --> 00:21:05,710
so I connect<font color="#CCCCCC"> one probe to</font><font color="#E5E5E5"> the green wire</font>

457
00:21:03,399 --> 00:21:09,219
<font color="#E5E5E5">one probe to yellow wire as indicated</font>

458
00:21:05,710 --> 00:21:11,620
<font color="#CCCCCC">here and this is signal I get and from</font>

459
00:21:09,220 --> 00:21:14,590
here<font color="#E5E5E5"> looking at a time scale time scale</font>

460
00:21:11,620 --> 00:21:17,080
<font color="#E5E5E5">I already get a lot of information</font><font color="#CCCCCC"> out</font>

461
00:21:14,590 --> 00:21:19,090
<font color="#CCCCCC">of here so what I can</font><font color="#E5E5E5"> see is</font><font color="#CCCCCC"> that yellow</font>

462
00:21:17,080 --> 00:21:23,500
is<font color="#E5E5E5"> clock right if I take a look at it</font>

463
00:21:19,090 --> 00:21:26,439
<font color="#E5E5E5">yellow is</font><font color="#CCCCCC"> either down or</font><font color="#E5E5E5"> is going 1 0 1</font>

464
00:21:23,500 --> 00:21:30,039
<font color="#E5E5E5">0</font><font color="#CCCCCC"> 0 so it's clearly</font><font color="#E5E5E5"> clocks there is no</font>

465
00:21:26,440 --> 00:21:32,409
data in there<font color="#E5E5E5"> and the green then of</font>

466
00:21:30,039 --> 00:21:34,750
<font color="#E5E5E5">course our remains to be data because we</font>

467
00:21:32,409 --> 00:21:39,309
see some<font color="#E5E5E5"> changes we see irregularities</font>

468
00:21:34,750 --> 00:21:41,649
<font color="#E5E5E5">different patterns on there we can also</font>

469
00:21:39,309 --> 00:21:44,049
read<font color="#CCCCCC"> from here there are 14 milliseconds</font>

470
00:21:41,649 --> 00:21:46,629
between packet bursts right so one

471
00:21:44,049 --> 00:21:48,580
packet ends here at approximately 70

472
00:21:46,630 --> 00:21:51,270
milliseconds<font color="#E5E5E5"> and the second packet</font>

473
00:21:48,580 --> 00:21:55,000
starts<font color="#E5E5E5"> here at the proximately 110</font>

474
00:21:51,270 --> 00:21:57,070
milliseconds<font color="#E5E5E5"> and we can also see that</font>

475
00:21:55,000 --> 00:21:59,620
<font color="#E5E5E5">one clock cycle is</font><font color="#CCCCCC"> 1 millisecond</font><font color="#E5E5E5"> right</font>

476
00:21:57,070 --> 00:22:01,960
<font color="#E5E5E5">if you look at the clock here up down</font>

477
00:21:59,620 --> 00:22:03,729
and back<font color="#CCCCCC"> to the beginning it's 1</font>

478
00:22:01,960 --> 00:22:06,309
millisecond that means the<font color="#E5E5E5"> signal is 1</font>

479
00:22:03,730 --> 00:22:09,809
kilohertz easily readable with<font color="#E5E5E5"> a with an</font>

480
00:22:06,309 --> 00:22:12,730
<font color="#E5E5E5">Arduino</font><font color="#CCCCCC"> if not a high frequency at all</font>

481
00:22:09,809 --> 00:22:14,020
so looking at the signal encoding we

482
00:22:12,730 --> 00:22:16,450
zoom in a bit<font color="#E5E5E5"> this is</font>

483
00:22:14,020 --> 00:22:21,340
one single short packet<font color="#E5E5E5"> we just zoomed</font>

484
00:22:16,450 --> 00:22:25,930
in here<font color="#CCCCCC"> and if</font><font color="#E5E5E5"> we take a look at it we</font>

485
00:22:21,340 --> 00:22:29,350
<font color="#CCCCCC">can see that</font><font color="#E5E5E5"> when</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> clock is high the</font>

486
00:22:25,930 --> 00:22:32,200
data is<font color="#E5E5E5"> also always high that means it's</font>

487
00:22:29,350 --> 00:22:35,290
all<font color="#E5E5E5"> once so it's nothing there right we</font>

488
00:22:32,200 --> 00:22:38,530
can<font color="#CCCCCC"> conclude that</font><font color="#E5E5E5"> only when the clock is</font>

489
00:22:35,290 --> 00:22:40,120
low<font color="#E5E5E5"> there are some differences on the</font>

490
00:22:38,530 --> 00:22:42,730
data line for example<font color="#CCCCCC"> here</font><font color="#E5E5E5"> we have</font><font color="#CCCCCC"> low</font>

491
00:22:40,120 --> 00:22:44,199
<font color="#E5E5E5">clock and load</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> a low clock and high</font>

492
00:22:42,730 --> 00:22:46,360
data but if you look at high<font color="#CCCCCC"> clock</font><font color="#E5E5E5"> the</font>

493
00:22:44,200 --> 00:22:48,760
green ones here it's<font color="#E5E5E5"> always also</font><font color="#CCCCCC"> hard</font>

494
00:22:46,360 --> 00:22:51,610
<font color="#E5E5E5">the</font><font color="#CCCCCC"> deadline so our initial conclusion</font>

495
00:22:48,760 --> 00:22:56,020
is<font color="#CCCCCC"> that</font><font color="#E5E5E5"> what</font><font color="#CCCCCC"> o'clock is low we see</font><font color="#E5E5E5"> data</font>

496
00:22:51,610 --> 00:22:59,169
on the Green Line<font color="#E5E5E5"> and indeed if we take</font>

497
00:22:56,020 --> 00:23:03,310
a look at the bits this what we<font color="#E5E5E5"> get we</font>

498
00:22:59,170 --> 00:23:04,750
get a<font color="#E5E5E5"> packet</font><font color="#CCCCCC"> 0c 9 1 2 d 2</font><font color="#E5E5E5"> 1 which as we</font>

499
00:23:03,310 --> 00:23:09,129
will see<font color="#CCCCCC"> later is a legitimate</font><font color="#E5E5E5"> packet</font>

500
00:23:04,750 --> 00:23:12,430
for<font color="#E5E5E5"> for</font><font color="#CCCCCC"> Kumba's but we have to keep</font>

501
00:23:09,130 --> 00:23:16,720
something in mind combos is a<font color="#E5E5E5"> two-way</font>

502
00:23:12,430 --> 00:23:18,520
protocol<font color="#E5E5E5"> keypad communicates with the</font>

503
00:23:16,720 --> 00:23:23,440
panel and panel communicates back to the

504
00:23:18,520 --> 00:23:26,320
keypad<font color="#CCCCCC"> so clearly we have</font><font color="#E5E5E5"> made we are</font>

505
00:23:23,440 --> 00:23:29,550
missing something<font color="#E5E5E5"> here so the question</font>

506
00:23:26,320 --> 00:23:31,480
<font color="#CCCCCC">is what and doing some</font><font color="#E5E5E5"> more</font><font color="#CCCCCC"> research</font>

507
00:23:29,550 --> 00:23:37,450
<font color="#E5E5E5">couple</font><font color="#CCCCCC"> tens of minutes maybe</font><font color="#E5E5E5"> couple</font>

508
00:23:31,480 --> 00:23:41,530
<font color="#E5E5E5">hours</font><font color="#CCCCCC"> into it we can conclude that the</font>

509
00:23:37,450 --> 00:23:43,900
clock actually<font color="#E5E5E5"> indicates which side of</font>

510
00:23:41,530 --> 00:23:45,280
the<font color="#CCCCCC"> communications is talking</font><font color="#E5E5E5"> what we</font>

511
00:23:43,900 --> 00:23:48,940
<font color="#CCCCCC">identified here previously</font><font color="#E5E5E5"> was</font><font color="#CCCCCC"> the</font>

512
00:23:45,280 --> 00:23:52,450
master talking when the clock<font color="#CCCCCC"> the yellow</font>

513
00:23:48,940 --> 00:23:56,560
one is<font color="#E5E5E5"> high master sending data when the</font>

514
00:23:52,450 --> 00:23:58,360
clock is low<font color="#E5E5E5"> slave is sending data so</font>

515
00:23:56,560 --> 00:24:01,470
it's a two-way<font color="#CCCCCC"> communication channel</font>

516
00:23:58,360 --> 00:24:04,469
where each bit goes from different side

517
00:24:01,470 --> 00:24:04,470
right

518
00:24:05,940 --> 00:24:12,510
so how do we set up the<font color="#CCCCCC"> hardware to read</font>

519
00:24:09,290 --> 00:24:14,280
the<font color="#E5E5E5"> data so this is a compass wire</font>

520
00:24:12,510 --> 00:24:16,830
<font color="#E5E5E5">coming here we are not</font><font color="#CCCCCC"> using the voltage</font>

521
00:24:14,280 --> 00:24:19,649
wire of course<font color="#CCCCCC"> the voltage on</font><font color="#E5E5E5"> there by</font>

522
00:24:16,830 --> 00:24:22,649
the way is 12 volts<font color="#E5E5E5"> so you shouldn't</font>

523
00:24:19,650 --> 00:24:24,390
stick it<font color="#CCCCCC"> directly into Arduino</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> the</font>

524
00:24:22,650 --> 00:24:28,440
voltage the maximum voltage<font color="#E5E5E5"> on the</font>

525
00:24:24,390 --> 00:24:31,080
<font color="#E5E5E5">signal wires</font><font color="#CCCCCC"> is higher than Rd notorious</font>

526
00:24:28,440 --> 00:24:34,260
<font color="#E5E5E5">as well this is why we</font><font color="#CCCCCC"> add resistors</font>

527
00:24:31,080 --> 00:24:36,090
<font color="#E5E5E5">this</font><font color="#CCCCCC"> setup</font><font color="#E5E5E5"> here is great for reading it</font>

528
00:24:34,260 --> 00:24:38,280
will not<font color="#E5E5E5"> work</font><font color="#CCCCCC"> for writing because we set</font>

529
00:24:36,090 --> 00:24:40,590
<font color="#E5E5E5">it but you can use pulldown resistors to</font>

530
00:24:38,280 --> 00:24:43,230
to be able<font color="#E5E5E5"> to write to</font><font color="#CCCCCC"> the compass as</font>

531
00:24:40,590 --> 00:24:46,439
well if you<font color="#E5E5E5"> wish so so resistors here</font>

532
00:24:43,230 --> 00:24:50,190
are to limit the voltage going<font color="#E5E5E5"> into the</font>

533
00:24:46,440 --> 00:24:51,990
arena and<font color="#CCCCCC"> the current draw how do we do</font>

534
00:24:50,190 --> 00:24:54,180
with<font color="#E5E5E5"> it in</font><font color="#CCCCCC"> two bytes it's actually super</font>

535
00:24:51,990 --> 00:24:58,320
<font color="#CCCCCC">easy</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> is this is alt text this is</font>

536
00:24:54,180 --> 00:25:01,200
<font color="#CCCCCC">pseudo</font><font color="#E5E5E5"> code but the</font><font color="#CCCCCC"> codes</font><font color="#E5E5E5"> running on the</font>

537
00:24:58,320 --> 00:25:03,600
<font color="#E5E5E5">Dino is that simple so we wait for</font><font color="#CCCCCC"> a</font>

538
00:25:01,200 --> 00:25:06,090
clock change when clock change happens

539
00:25:03,600 --> 00:25:07,949
we wait 15 microseconds<font color="#E5E5E5"> just to be sure</font>

540
00:25:06,090 --> 00:25:09,689
<font color="#E5E5E5">that we are</font><font color="#CCCCCC"> not</font><font color="#E5E5E5"> missing the first byte</font>

541
00:25:07,950 --> 00:25:11,970
<font color="#CCCCCC">right some disenfranchising may be</font>

542
00:25:09,690 --> 00:25:14,370
<font color="#E5E5E5">happening there and then we see if clock</font>

543
00:25:11,970 --> 00:25:17,870
is high<font color="#CCCCCC"> monster may be talking</font><font color="#E5E5E5"> if clock</font>

544
00:25:14,370 --> 00:25:23,639
is low<font color="#CCCCCC"> slate may be talking right and</font>

545
00:25:17,870 --> 00:25:26,010
since we found<font color="#E5E5E5"> out that slave is pulling</font>

546
00:25:23,640 --> 00:25:28,530
down to send one but<font color="#CCCCCC"> Monster is pulling</font>

547
00:25:26,010 --> 00:25:30,660
up we need to<font color="#E5E5E5"> invert the slave data of</font>

548
00:25:28,530 --> 00:25:33,360
course<font color="#E5E5E5"> right so that's what you do here</font>

549
00:25:30,660 --> 00:25:37,740
we invert the<font color="#E5E5E5"> slave slave data over</font><font color="#CCCCCC"> here</font>

550
00:25:33,360 --> 00:25:40,320
and we added<font color="#E5E5E5"> to the bits that</font><font color="#CCCCCC"> we're</font>

551
00:25:37,740 --> 00:25:44,480
<font color="#E5E5E5">collecting</font><font color="#CCCCCC"> and when we see</font><font color="#E5E5E5"> more than</font><font color="#CCCCCC"> two</font>

552
00:25:40,320 --> 00:25:46,379
milliseconds<font color="#E5E5E5"> idle signal on the clock</font>

553
00:25:44,480 --> 00:25:47,820
remember the clock cycle<font color="#CCCCCC"> was</font><font color="#E5E5E5"> one</font>

554
00:25:46,380 --> 00:25:50,070
millisecond so more than<font color="#CCCCCC"> 2 milliseconds</font>

555
00:25:47,820 --> 00:25:52,139
<font color="#E5E5E5">we are sure that nothing is</font><font color="#CCCCCC"> being sent</font>

556
00:25:50,070 --> 00:25:54,629
then we look if<font color="#CCCCCC"> we have gathering data</font>

557
00:25:52,140 --> 00:25:56,940
<font color="#E5E5E5">and they print it out over serial so</font>

558
00:25:54,630 --> 00:26:01,770
that's as easy<font color="#E5E5E5"> as it goes that's how we</font>

559
00:25:56,940 --> 00:26:05,280
take a look at the<font color="#E5E5E5"> actual signal level</font>

560
00:26:01,770 --> 00:26:08,340
on the comm bus now let's take a look at

561
00:26:05,280 --> 00:26:10,910
the packet level when we are done with

562
00:26:08,340 --> 00:26:14,490
signal level what you're left with<font color="#E5E5E5"> is</font>

563
00:26:10,910 --> 00:26:17,750
these packets<font color="#CCCCCC"> for example here's one</font>

564
00:26:14,490 --> 00:26:19,680
this<font color="#E5E5E5"> is an event packet it starts with E</font>

565
00:26:17,750 --> 00:26:22,500
that's a hex code

566
00:26:19,680 --> 00:26:24,870
something that's an event<font color="#CCCCCC"> and what we</font>

567
00:26:22,500 --> 00:26:27,030
see here<font color="#CCCCCC"> is the command the</font><font color="#E5E5E5"> first bit</font>

568
00:26:24,870 --> 00:26:29,340
yellow one<font color="#CCCCCC"> was the first byte sorry is</font>

569
00:26:27,030 --> 00:26:30,810
the command<font color="#E5E5E5"> the yellow one</font><font color="#CCCCCC"> at the very</font>

570
00:26:29,340 --> 00:26:34,199
<font color="#CCCCCC">end do we</font><font color="#E5E5E5"> see the green one</font><font color="#CCCCCC"> dot two</font>

571
00:26:30,810 --> 00:26:37,710
<font color="#CCCCCC">checksum so there is some checksum built</font>

572
00:26:34,200 --> 00:26:40,950
in to prevent errors happening<font color="#E5E5E5"> on the</font>

573
00:26:37,710 --> 00:26:44,970
wire and then there are<font color="#CCCCCC"> eight</font><font color="#E5E5E5"> bits that</font>

574
00:26:40,950 --> 00:26:47,100
are unused<font color="#E5E5E5"> just zeros in the end here</font><font color="#CCCCCC"> is</font>

575
00:26:44,970 --> 00:26:48,270
different<font color="#E5E5E5"> command this is</font><font color="#CCCCCC"> zero C this is</font>

576
00:26:47,100 --> 00:26:50,250
<font color="#CCCCCC">o'clock command it's clock</font>

577
00:26:48,270 --> 00:26:51,780
synchronization command<font color="#E5E5E5"> it's shorter</font><font color="#CCCCCC"> it</font>

578
00:26:50,250 --> 00:26:54,750
doesn't have<font color="#E5E5E5"> checksum but the long ones</font>

579
00:26:51,780 --> 00:26:58,080
<font color="#E5E5E5">usually</font><font color="#CCCCCC"> do looking at this live</font><font color="#E5E5E5"> is a bit</font>

580
00:26:54,750 --> 00:26:59,130
different<font color="#E5E5E5"> slave starts as you saw from</font>

581
00:26:58,080 --> 00:27:04,409
previous slide if<font color="#CCCCCC"> you were paying</font>

582
00:26:59,130 --> 00:27:06,240
<font color="#E5E5E5">attention with an unused byte that</font><font color="#CCCCCC"> is</font>

583
00:27:04,410 --> 00:27:08,490
because some low powered slaves may take

584
00:27:06,240 --> 00:27:12,540
some time to<font color="#E5E5E5"> notice that the clock has</font>

585
00:27:08,490 --> 00:27:16,070
started<font color="#CCCCCC"> started being sent and that's</font>

586
00:27:12,540 --> 00:27:19,080
where it's possible<font color="#E5E5E5"> that this byte may</font>

587
00:27:16,070 --> 00:27:21,330
the slave may not be able<font color="#CCCCCC"> to send the</font>

588
00:27:19,080 --> 00:27:23,370
byte as fast that is why I believe<font color="#E5E5E5"> the</font>

589
00:27:21,330 --> 00:27:27,899
protocol mandates the first byte by the

590
00:27:23,370 --> 00:27:29,610
slave<font color="#CCCCCC"> is always unset unused</font><font color="#E5E5E5"> then it's</font>

591
00:27:27,900 --> 00:27:32,400
followed<font color="#CCCCCC"> by the</font><font color="#E5E5E5"> channel request second</font>

592
00:27:29,610 --> 00:27:35,129
byte is set to<font color="#CCCCCC"> two which means</font><font color="#E5E5E5"> that</font>

593
00:27:32,400 --> 00:27:37,050
slave<font color="#E5E5E5"> wants to talk</font><font color="#CCCCCC"> and in this case</font>

594
00:27:35,130 --> 00:27:39,240
it's<font color="#E5E5E5"> it common zero means there's no</font>

595
00:27:37,050 --> 00:27:40,919
command<font color="#E5E5E5"> this is what happens when slave</font>

596
00:27:39,240 --> 00:27:42,240
wants<font color="#E5E5E5"> to talk right because we have</font>

597
00:27:40,920 --> 00:27:45,660
<font color="#E5E5E5">multiple slaves multiple keepers</font>

598
00:27:42,240 --> 00:27:46,920
multiple devices on the<font color="#E5E5E5"> combos and if</font>

599
00:27:45,660 --> 00:27:48,450
multiple doesn't want to talk<font color="#E5E5E5"> at the</font>

600
00:27:46,920 --> 00:27:52,290
same<font color="#E5E5E5"> time this</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> what they</font><font color="#CCCCCC"> use to</font>

601
00:27:48,450 --> 00:27:54,390
<font color="#CCCCCC">indicate that they</font><font color="#E5E5E5"> want talk um here is</font>

602
00:27:52,290 --> 00:27:58,980
a different command<font color="#E5E5E5"> this is a command</font>

603
00:27:54,390 --> 00:28:00,870
<font color="#E5E5E5">we're and code is being entered on one</font>

604
00:27:58,980 --> 00:28:02,250
of the<font color="#E5E5E5"> keypads again it starts with</font>

605
00:28:00,870 --> 00:28:05,929
<font color="#E5E5E5">channel request it starts the command</font>

606
00:28:02,250 --> 00:28:12,360
and there's a checksum at the end and

607
00:28:05,930 --> 00:28:16,290
then we have an unused<font color="#E5E5E5"> byte there as</font>

608
00:28:12,360 --> 00:28:20,189
well checksum<font color="#E5E5E5"> is calculated is super</font>

609
00:28:16,290 --> 00:28:25,350
easy<font color="#E5E5E5"> so it's basically summary checksum</font>

610
00:28:20,190 --> 00:28:28,410
over 100 over 100 in hex

611
00:28:25,350 --> 00:28:30,330
so we're<font color="#CCCCCC"> 236</font><font color="#E5E5E5"> or run byte it rolls over</font>

612
00:28:28,410 --> 00:28:32,760
and<font color="#E5E5E5"> you start to calculate from the</font>

613
00:28:30,330 --> 00:28:33,850
command meaning that in this case<font color="#E5E5E5"> in the</font>

614
00:28:32,760 --> 00:28:36,100
last<font color="#E5E5E5"> line here</font>

615
00:28:33,850 --> 00:28:40,178
take the<font color="#CCCCCC"> zero - into account when you</font>

616
00:28:36,100 --> 00:28:41,980
<font color="#CCCCCC">calculus Jackson right so</font><font color="#E5E5E5"> that's how you</font>

617
00:28:40,179 --> 00:28:44,320
do<font color="#E5E5E5"> the checksum let's</font><font color="#CCCCCC"> look at some</font>

618
00:28:41,980 --> 00:28:46,630
specific commands<font color="#E5E5E5"> because</font><font color="#CCCCCC"> I also</font><font color="#E5E5E5"> decoded</font>

619
00:28:44,320 --> 00:28:47,980
<font color="#E5E5E5">some of the commands and one of the</font>

620
00:28:46,630 --> 00:28:50,110
<font color="#E5E5E5">commander's we can see in the demo is</font>

621
00:28:47,980 --> 00:28:52,450
the heartbeat command or the<font color="#E5E5E5"> clock</font>

622
00:28:50,110 --> 00:28:53,620
command<font color="#CCCCCC"> an example of the command is</font>

623
00:28:52,450 --> 00:28:57,340
seen right<font color="#CCCCCC"> here behind me</font>

624
00:28:53,620 --> 00:29:00,399
<font color="#CCCCCC">zero CAA 1011 I said what does</font><font color="#E5E5E5"> really</font>

625
00:28:57,340 --> 00:29:02,500
<font color="#E5E5E5">mean this is how it works</font>

626
00:29:00,400 --> 00:29:07,740
so<font color="#CCCCCC"> 0c is a heartbeat or clock command</font>

627
00:29:02,500 --> 00:29:07,740
<font color="#E5E5E5">and next byte is a sequence number and</font>

628
00:29:07,770 --> 00:29:13,840
sequence number it goes<font color="#CCCCCC"> +1</font><font color="#E5E5E5"> all the time</font>

629
00:29:11,679 --> 00:29:17,380
and then it rotates back to<font color="#CCCCCC"> 0</font><font color="#E5E5E5"> right from</font>

630
00:29:13,840 --> 00:29:20,590
<font color="#CCCCCC">0 to 255</font><font color="#E5E5E5"> but what's also important</font><font color="#CCCCCC"> is</font>

631
00:29:17,380 --> 00:29:24,520
<font color="#CCCCCC">the last bit or whether the</font><font color="#E5E5E5"> sequence</font>

632
00:29:20,590 --> 00:29:27,939
number<font color="#E5E5E5"> is even or odd if the sequence</font>

633
00:29:24,520 --> 00:29:31,740
number is<font color="#CCCCCC"> even then the data being sent</font>

634
00:29:27,940 --> 00:29:37,240
is the day<font color="#E5E5E5"> of the month and the hour</font>

635
00:29:31,740 --> 00:29:43,350
<font color="#E5E5E5">like in this</font><font color="#CCCCCC"> example here</font><font color="#E5E5E5"> right it says</font>

636
00:29:37,240 --> 00:29:47,350
<font color="#CCCCCC">its 16th of the month and our</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> 17</font><font color="#E5E5E5"> and</font>

637
00:29:43,350 --> 00:29:50,289
if the bit<font color="#CCCCCC"> is odd then</font><font color="#E5E5E5"> minutes and</font>

638
00:29:47,350 --> 00:29:52,439
seconds are being sent right in that

639
00:29:50,289 --> 00:29:58,890
case those<font color="#CCCCCC"> two</font><font color="#E5E5E5"> last bytes would mean</font>

640
00:29:52,440 --> 00:30:00,850
respected<font color="#E5E5E5"> would mean minutes and seconds</font>

641
00:29:58,890 --> 00:30:03,039
for the code entry<font color="#E5E5E5"> it's more interesting</font>

642
00:30:00,850 --> 00:30:04,928
<font color="#CCCCCC">because this is where the holy grail is</font>

643
00:30:03,039 --> 00:30:06,820
right<font color="#E5E5E5"> remember if you have this keypad</font>

644
00:30:04,929 --> 00:30:09,250
as the other side of the warehouse it's

645
00:30:06,820 --> 00:30:11,530
not<font color="#E5E5E5"> being used we can connect a small or</font>

646
00:30:09,250 --> 00:30:13,990
maybe<font color="#E5E5E5"> not</font><font color="#CCCCCC"> so small device even</font><font color="#E5E5E5"> to the</font>

647
00:30:11,530 --> 00:30:16,990
keypad to the<font color="#E5E5E5"> comm</font><font color="#CCCCCC"> bus</font><font color="#E5E5E5"> and we can leave</font>

648
00:30:13,990 --> 00:30:20,289
<font color="#E5E5E5">it there and wait for someone</font><font color="#CCCCCC"> to come</font>

649
00:30:16,990 --> 00:30:23,500
<font color="#CCCCCC">and use the</font><font color="#E5E5E5"> system and then we</font><font color="#CCCCCC"> can see</font>

650
00:30:20,289 --> 00:30:26,950
is<font color="#CCCCCC"> data being sent</font><font color="#E5E5E5"> now this command here</font>

651
00:30:23,500 --> 00:30:29,679
decodes<font color="#CCCCCC"> to that this of course is sent</font>

652
00:30:26,950 --> 00:30:35,490
by<font color="#E5E5E5"> the slave as indicated by 0 0 0</font><font color="#CCCCCC"> 2 at</font>

653
00:30:29,679 --> 00:30:39,850
the beginning<font color="#CCCCCC"> here we have the user type</font>

654
00:30:35,490 --> 00:30:40,690
here<font color="#E5E5E5"> and if the first bit of the</font><font color="#CCCCCC"> user</font>

655
00:30:39,850 --> 00:30:43,149
type is<font color="#CCCCCC"> 1</font>

656
00:30:40,690 --> 00:30:44,110
it's a programmer<font color="#CCCCCC"> so</font><font color="#E5E5E5"> programmer is a</font>

657
00:30:43,150 --> 00:30:46,870
user

658
00:30:44,110 --> 00:30:47,740
it's like<font color="#E5E5E5"> installer it's an employee if</font>

659
00:30:46,870 --> 00:30:50,020
the company doesn't

660
00:30:47,740 --> 00:30:52,990
<font color="#E5E5E5">your</font><font color="#CCCCCC"> security alarm they have higher</font>

661
00:30:50,020 --> 00:30:55,240
access levels they can reprogram the

662
00:30:52,990 --> 00:30:58,150
whole system if it's not one<font color="#CCCCCC"> it's a</font>

663
00:30:55,240 --> 00:31:00,210
normal user<font color="#CCCCCC"> Ct is the code type right</font>

664
00:30:58,150 --> 00:31:03,700
what kind<font color="#E5E5E5"> of code is being</font><font color="#CCCCCC"> typed in and</font>

665
00:31:00,210 --> 00:31:06,370
as you may have guessed<font color="#CCCCCC"> CC is the code</font>

666
00:31:03,700 --> 00:31:09,340
itself<font color="#E5E5E5"> so in this example you</font><font color="#CCCCCC"> can see</font>

667
00:31:06,370 --> 00:31:12,550
that<font color="#E5E5E5"> the code being typed on the keypad</font>

668
00:31:09,340 --> 00:31:14,379
is<font color="#CCCCCC"> one</font><font color="#E5E5E5"> two</font><font color="#CCCCCC"> three four which</font><font color="#E5E5E5"> is quite an</font>

669
00:31:12,550 --> 00:31:18,450
<font color="#E5E5E5">easy case</font><font color="#CCCCCC"> because they do have small</font>

670
00:31:14,380 --> 00:31:21,130
<font color="#E5E5E5">amount of obfuscation</font><font color="#CCCCCC"> in there and then</font>

671
00:31:18,450 --> 00:31:23,440
there is a serial number<font color="#CCCCCC"> of</font><font color="#E5E5E5"> the sort</font>

672
00:31:21,130 --> 00:31:25,690
device as well<font color="#CCCCCC"> because all the devices</font>

673
00:31:23,440 --> 00:31:31,330
<font color="#E5E5E5">on the</font><font color="#CCCCCC"> combi</font><font color="#E5E5E5"> are being enumerated when</font>

674
00:31:25,690 --> 00:31:33,840
the system boots<font color="#E5E5E5"> up at first and I would</font>

675
00:31:31,330 --> 00:31:37,419
wager that they have some<font color="#E5E5E5"> kind of</font>

676
00:31:33,840 --> 00:31:39,879
authentication<font color="#CCCCCC"> on their source</font>

677
00:31:37,420 --> 00:31:42,730
identification so seeing if the code is

678
00:31:39,880 --> 00:31:44,590
<font color="#E5E5E5">coming from real device the thing is it</font>

679
00:31:42,730 --> 00:31:49,030
<font color="#E5E5E5">seems to me easier to spoof the</font><font color="#CCCCCC"> neva</font>

680
00:31:44,590 --> 00:31:51,010
nether net because it's just<font color="#E5E5E5"> four by</font>

681
00:31:49,030 --> 00:31:53,320
<font color="#E5E5E5">serial</font><font color="#CCCCCC"> number</font><font color="#E5E5E5"> which actually matches</font>

682
00:31:51,010 --> 00:31:55,270
what you have on the back of your keypad

683
00:31:53,320 --> 00:31:58,000
on<font color="#CCCCCC"> or the back of your device</font><font color="#E5E5E5"> and of</font>

684
00:31:55,270 --> 00:32:03,160
course there's a checksum<font color="#E5E5E5"> cut computed</font>

685
00:31:58,000 --> 00:32:04,809
using your rules<font color="#E5E5E5"> already described now</font>

686
00:32:03,160 --> 00:32:10,000
let's look at<font color="#E5E5E5"> the payloads right this is</font>

687
00:32:04,809 --> 00:32:11,950
<font color="#CCCCCC">a</font><font color="#E5E5E5"> final</font><font color="#CCCCCC"> level of combos as we saw from</font>

688
00:32:10,000 --> 00:32:15,280
<font color="#E5E5E5">these examples</font><font color="#CCCCCC"> and as cake as I can</font>

689
00:32:11,950 --> 00:32:18,760
confirm from other commands there<font color="#E5E5E5"> is no</font>

690
00:32:15,280 --> 00:32:25,720
encryption<font color="#E5E5E5"> used on the comm bus for the</font>

691
00:32:18,760 --> 00:32:30,730
<font color="#E5E5E5">payloads text is sent as fixed length</font>

692
00:32:25,720 --> 00:32:32,590
<font color="#CCCCCC">string</font><font color="#E5E5E5"> ASCII string</font><font color="#CCCCCC"> and it's often 16</font>

693
00:32:30,730 --> 00:32:35,350
characters it's the most common length

694
00:32:32,590 --> 00:32:43,020
of the text<font color="#CCCCCC"> and it uses</font><font color="#E5E5E5"> space character</font>

695
00:32:35,350 --> 00:32:46,870
as a filler<font color="#CCCCCC"> to</font><font color="#E5E5E5"> send the shorter string</font>

696
00:32:43,020 --> 00:32:50,830
numbers are<font color="#CCCCCC"> usually</font><font color="#E5E5E5"> packed binary code</font>

697
00:32:46,870 --> 00:32:52,389
decimal as you saw for<font color="#CCCCCC"> example the code</font>

698
00:32:50,830 --> 00:32:54,309
on<font color="#E5E5E5"> the previous slide it was one two</font>

699
00:32:52,390 --> 00:32:56,980
<font color="#E5E5E5">three four</font><font color="#CCCCCC"> even though the decimal</font>

700
00:32:54,309 --> 00:32:58,600
values for those hex values are

701
00:32:56,980 --> 00:32:59,900
<font color="#CCCCCC">different but</font><font color="#E5E5E5"> it's BCD binary code</font>

702
00:32:58,600 --> 00:33:03,459
decimal

703
00:32:59,900 --> 00:33:06,110
but there is<font color="#E5E5E5"> one thing they tried to do</font>

704
00:33:03,460 --> 00:33:07,880
<font color="#E5E5E5">they try to do some investigation</font><font color="#CCCCCC"> so in</font>

705
00:33:06,110 --> 00:33:10,580
case<font color="#CCCCCC"> your</font><font color="#E5E5E5"> pink</font><font color="#CCCCCC"> coat or any other</font>

706
00:33:07,880 --> 00:33:13,730
constant has zero<font color="#E5E5E5"> we replace</font><font color="#CCCCCC"> it with a</font>

707
00:33:10,580 --> 00:33:16,100
so it's<font color="#E5E5E5"> not that easy</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> they don't have</font>

708
00:33:13,730 --> 00:33:20,930
an<font color="#CCCCCC"> encryption but at least we have some</font>

709
00:33:16,100 --> 00:33:24,919
level of obfuscation<font color="#E5E5E5"> so now is that</font>

710
00:33:20,930 --> 00:33:31,070
being<font color="#E5E5E5"> said I'm gonna show you some demo</font>

711
00:33:24,920 --> 00:33:33,080
<font color="#E5E5E5">and the official manual says</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> before</font>

712
00:33:31,070 --> 00:33:36,770
<font color="#CCCCCC">connecting a module to the combos you</font>

713
00:33:33,080 --> 00:33:38,720
<font color="#E5E5E5">have to remove the AC power and the</font>

714
00:33:36,770 --> 00:33:40,700
battery power<font color="#E5E5E5"> from the control panel</font>

715
00:33:38,720 --> 00:33:42,020
<font color="#CCCCCC">well we don't have time</font><font color="#E5E5E5"> for that so</font>

716
00:33:40,700 --> 00:33:43,400
<font color="#CCCCCC">we're not</font><font color="#E5E5E5"> going to be</font><font color="#CCCCCC"> doing that we're</font>

717
00:33:42,020 --> 00:33:48,190
just<font color="#E5E5E5"> going</font><font color="#CCCCCC"> to connect</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> to a live</font>

718
00:33:43,400 --> 00:33:51,140
system<font color="#E5E5E5"> here so I can have a keypad here</font>

719
00:33:48,190 --> 00:33:55,640
let me<font color="#CCCCCC"> show it to</font><font color="#E5E5E5"> you I have a keypad</font>

720
00:33:51,140 --> 00:33:59,150
<font color="#E5E5E5">right here it has</font><font color="#CCCCCC"> Columbus wire</font><font color="#E5E5E5"> going in</font>

721
00:33:55,640 --> 00:34:01,010
<font color="#E5E5E5">and what an attacker can do attacker can</font>

722
00:33:59,150 --> 00:34:05,930
cut<font color="#E5E5E5"> into the compost water at any point</font>

723
00:34:01,010 --> 00:34:07,790
<font color="#E5E5E5">and access the wires in here right you</font>

724
00:34:05,930 --> 00:34:12,440
can strip the<font color="#E5E5E5"> isolation from the small</font>

725
00:34:07,790 --> 00:34:17,000
wires here<font color="#CCCCCC"> and then we can use</font><font color="#E5E5E5"> our</font>

726
00:34:12,440 --> 00:34:21,470
device<font color="#CCCCCC"> to actually read what's on the</font>

727
00:34:17,000 --> 00:34:26,389
<font color="#E5E5E5">comm bus so now I'm gonna switch back</font><font color="#CCCCCC"> to</font>

728
00:34:21,469 --> 00:34:28,520
<font color="#CCCCCC">the laptop just for 30 seconds and show</font>

729
00:34:26,389 --> 00:34:31,009
you the<font color="#CCCCCC"> other</font><font color="#E5E5E5"> part of the demo here so</font>

730
00:34:28,520 --> 00:34:33,649
I'm gonna<font color="#E5E5E5"> launch a serial terminal that</font>

731
00:34:31,010 --> 00:34:36,530
will read what's happening<font color="#E5E5E5"> on the device</font>

732
00:34:33,649 --> 00:34:39,620
<font color="#E5E5E5">currently it may be some random data</font>

733
00:34:36,530 --> 00:34:42,080
<font color="#E5E5E5">maybe some garbage because</font><font color="#CCCCCC"> the wires are</font>

734
00:34:39,620 --> 00:34:43,819
just loose they're not even grounded so

735
00:34:42,080 --> 00:34:45,830
<font color="#E5E5E5">we're lucky to have zeros I'm gonna</font>

736
00:34:43,820 --> 00:34:48,050
switch<font color="#CCCCCC"> back to the</font><font color="#E5E5E5"> camera here and I'm</font>

737
00:34:45,830 --> 00:34:50,509
<font color="#E5E5E5">gonna now connect the wires that</font><font color="#CCCCCC"> go into</font>

738
00:34:48,050 --> 00:34:52,330
Arduino through the resistors<font color="#CCCCCC"> to the</font>

739
00:34:50,510 --> 00:34:54,649
combos here<font color="#E5E5E5"> I'm gonna start with ground</font>

740
00:34:52,330 --> 00:34:58,700
so I'm gonna make<font color="#CCCCCC"> sure that my signals</font>

741
00:34:54,649 --> 00:35:02,180
are grounded<font color="#E5E5E5"> and this is how an attacker</font>

742
00:34:58,700 --> 00:35:05,740
<font color="#E5E5E5">could do it as well of</font><font color="#CCCCCC"> course so then</font>

743
00:35:02,180 --> 00:35:05,740
I'm gonna connect<font color="#E5E5E5"> the clock</font>

744
00:35:11,300 --> 00:35:19,680
<font color="#CCCCCC">right that is the</font><font color="#E5E5E5"> yellow of course okay</font>

745
00:35:17,099 --> 00:35:22,109
and then I'm gonna connect finally the

746
00:35:19,680 --> 00:35:24,359
data which<font color="#CCCCCC"> is</font><font color="#E5E5E5"> a green one</font><font color="#CCCCCC"> right we make</font>

747
00:35:22,109 --> 00:35:29,759
a<font color="#E5E5E5"> small</font><font color="#CCCCCC"> cut in the solution of</font><font color="#E5E5E5"> the cable</font>

748
00:35:24,359 --> 00:35:32,340
<font color="#E5E5E5">and we pinch into the green one and we</font>

749
00:35:29,760 --> 00:35:38,520
<font color="#E5E5E5">make sure</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> everything is secure</font><font color="#CCCCCC"> on</font>

750
00:35:32,340 --> 00:35:44,190
<font color="#E5E5E5">there including</font><font color="#CCCCCC"> the including the</font><font color="#E5E5E5"> clock</font>

751
00:35:38,520 --> 00:35:49,070
of course so this<font color="#E5E5E5"> is how an attacker</font>

752
00:35:44,190 --> 00:35:55,320
could connect to<font color="#CCCCCC"> the combis thank you</font>

753
00:35:49,070 --> 00:35:57,450
now if we take a look at the data being

754
00:35:55,320 --> 00:35:59,430
sent<font color="#E5E5E5"> we all can already see some</font><font color="#CCCCCC"> data</font>

755
00:35:57,450 --> 00:36:02,430
being processed<font color="#E5E5E5"> and</font><font color="#CCCCCC"> that is that small</font>

756
00:35:59,430 --> 00:36:05,339
script I showed you on the<font color="#CCCCCC"> screen it's</font>

757
00:36:02,430 --> 00:36:08,250
<font color="#E5E5E5">basically six useful lines of pseudocode</font>

758
00:36:05,340 --> 00:36:11,070
<font color="#CCCCCC">it's already processing</font><font color="#E5E5E5"> we see</font><font color="#CCCCCC"> 0c which</font>

759
00:36:08,250 --> 00:36:13,080
is what<font color="#E5E5E5"> that was the clock or the</font>

760
00:36:11,070 --> 00:36:16,470
<font color="#CCCCCC">heartbeat command and we have zeros</font>

761
00:36:13,080 --> 00:36:20,819
being sent back on the other bytes<font color="#E5E5E5"> ones</font>

762
00:36:16,470 --> 00:36:23,129
other bits from the<font color="#E5E5E5"> keypad</font><font color="#CCCCCC"> now this is</font>

763
00:36:20,820 --> 00:36:26,460
unreadable<font color="#E5E5E5"> for most of you I guess right</font>

764
00:36:23,130 --> 00:36:29,730
who don't read hex<font color="#E5E5E5"> at a huge speed so</font>

765
00:36:26,460 --> 00:36:34,920
what I'm gonna do now is I'm<font color="#E5E5E5"> gonna use</font><font color="#CCCCCC"> a</font>

766
00:36:29,730 --> 00:36:45,420
Python script<font color="#E5E5E5"> to interpret this data</font>

767
00:36:34,920 --> 00:36:47,579
here<font color="#E5E5E5"> so</font><font color="#CCCCCC"> I'm going to</font><font color="#E5E5E5"> launch</font>

768
00:36:45,420 --> 00:36:50,040
<font color="#CCCCCC">scripted connects the same</font><font color="#E5E5E5"> serial and we</font>

769
00:36:47,579 --> 00:36:52,440
can see one<font color="#E5E5E5"> packet sends the date and an</font>

770
00:36:50,040 --> 00:36:56,069
hour and the<font color="#CCCCCC"> other packet sends the</font>

771
00:36:52,440 --> 00:36:59,520
minute and the second right so we<font color="#E5E5E5"> can</font>

772
00:36:56,069 --> 00:37:01,950
see it quite nicely<font color="#CCCCCC"> here</font><font color="#E5E5E5"> sometimes it</font>

773
00:36:59,520 --> 00:37:06,690
doesn't<font color="#E5E5E5"> send</font><font color="#CCCCCC"> the date but</font><font color="#E5E5E5"> usually it's</font>

774
00:37:01,950 --> 00:37:08,759
interleaved<font color="#CCCCCC"> one by one right so in order</font>

775
00:37:06,690 --> 00:37:10,710
to see something useful<font color="#E5E5E5"> we of</font><font color="#CCCCCC"> course</font>

776
00:37:08,760 --> 00:37:12,750
can't have this on the screen<font color="#CCCCCC"> because we</font>

777
00:37:10,710 --> 00:37:15,540
<font color="#E5E5E5">are getting this multiple times</font><font color="#CCCCCC"> per</font>

778
00:37:12,750 --> 00:37:20,970
second<font color="#E5E5E5"> so</font><font color="#CCCCCC"> now I'm gonna modify my script</font>

779
00:37:15,540 --> 00:37:25,589
<font color="#E5E5E5">to</font><font color="#CCCCCC"> mute the timestamp or heartbeat</font>

780
00:37:20,970 --> 00:37:28,950
<font color="#E5E5E5">packets I'm gonna relaunch it and now</font>

781
00:37:25,589 --> 00:37:34,220
let me clear<font color="#CCCCCC"> screen so it's nicer and</font>

782
00:37:28,950 --> 00:37:36,540
now it's muting the<font color="#CCCCCC"> heartbeat right but</font>

783
00:37:34,220 --> 00:37:40,078
what I see I see<font color="#E5E5E5"> all</font><font color="#CCCCCC"> there are packets</font>

784
00:37:36,540 --> 00:37:43,049
<font color="#E5E5E5">let's say you open the door for</font><font color="#CCCCCC"> your</font>

785
00:37:40,079 --> 00:37:46,920
office<font color="#CCCCCC"> and what happens is is being</font>

786
00:37:43,049 --> 00:37:50,009
immediately<font color="#CCCCCC"> sent over combos and all the</font>

787
00:37:46,920 --> 00:37:52,859
<font color="#E5E5E5">panels now know that zone number one in</font>

788
00:37:50,010 --> 00:37:54,900
area number<font color="#CCCCCC"> one has</font><font color="#E5E5E5"> been opened we also</font>

789
00:37:52,859 --> 00:37:56,670
have some indication right<font color="#CCCCCC"> letter</font><font color="#E5E5E5"> T</font>

790
00:37:54,900 --> 00:37:58,500
means there are troubles<font color="#E5E5E5"> in this case</font>

791
00:37:56,670 --> 00:38:00,150
the trouble<font color="#CCCCCC"> for the system is</font><font color="#E5E5E5"> that I</font>

792
00:37:58,500 --> 00:38:02,970
don't<font color="#CCCCCC"> have</font><font color="#E5E5E5"> an RTC battery so the clock</font>

793
00:38:00,150 --> 00:38:06,480
may be off then<font color="#E5E5E5"> we go in we close the</font>

794
00:38:02,970 --> 00:38:08,430
door behind us<font color="#CCCCCC"> and we see that the zone</font>

795
00:38:06,480 --> 00:38:10,170
<font color="#CCCCCC">1 is</font><font color="#E5E5E5"> closed and we see</font><font color="#CCCCCC"> indication Z</font>

796
00:38:08,430 --> 00:38:14,098
which<font color="#E5E5E5"> means that all zones are</font><font color="#CCCCCC"> secured</font>

797
00:38:10,170 --> 00:38:16,260
at that moment<font color="#CCCCCC"> right</font><font color="#E5E5E5"> we can also trigger</font>

798
00:38:14,099 --> 00:38:18,660
some passive inferred sensors right for

799
00:38:16,260 --> 00:38:20,970
<font color="#CCCCCC">example this one here zone 3 opened</font>

800
00:38:18,660 --> 00:38:22,950
closed and so on<font color="#E5E5E5"> right so that's we can</font>

801
00:38:20,970 --> 00:38:25,200
already read<font color="#CCCCCC"> that</font><font color="#E5E5E5"> which is where most of</font>

802
00:38:22,950 --> 00:38:28,529
the current<font color="#E5E5E5"> research online ends at they</font>

803
00:38:25,200 --> 00:38:33,180
just want to interface<font color="#CCCCCC"> with their</font>

804
00:38:28,530 --> 00:38:35,819
systems<font color="#E5E5E5"> but</font><font color="#CCCCCC"> not me I want to</font><font color="#E5E5E5"> make sure</font>

805
00:38:33,180 --> 00:38:38,940
<font color="#E5E5E5">this is me secure and to make sure</font><font color="#CCCCCC"> the</font>

806
00:38:35,819 --> 00:38:45,329
<font color="#E5E5E5">system is secure</font><font color="#CCCCCC"> I need to try and hack</font>

807
00:38:38,940 --> 00:38:50,670
it<font color="#CCCCCC"> so let's say someone now comes to the</font>

808
00:38:45,329 --> 00:38:52,500
keypad at the far end of your warehouse

809
00:38:50,670 --> 00:38:54,839
where the attacker has installed the

810
00:38:52,500 --> 00:38:59,270
<font color="#E5E5E5">connection they open up the keypad</font><font color="#CCCCCC"> and</font>

811
00:38:54,839 --> 00:38:59,270
<font color="#E5E5E5">then type in a code right</font>

812
00:39:00,579 --> 00:39:09,710
as soon<font color="#CCCCCC"> as the CODIS typed</font><font color="#E5E5E5"> it sent over</font>

813
00:39:05,000 --> 00:39:11,329
<font color="#CCCCCC">combos and</font><font color="#E5E5E5"> the system decodes it and the</font>

814
00:39:09,710 --> 00:39:14,900
serial numbers shown as<font color="#E5E5E5"> well I can</font>

815
00:39:11,329 --> 00:39:17,180
remove some<font color="#E5E5E5"> bytes from the serial just</font>

816
00:39:14,900 --> 00:39:19,960
to protect the specific device number I

817
00:39:17,180 --> 00:39:23,779
have<font color="#E5E5E5"> and attacker could also see that</font>

818
00:39:19,960 --> 00:39:28,339
<font color="#CCCCCC">this code was incorrect</font><font color="#E5E5E5"> it was not a</font>

819
00:39:23,779 --> 00:39:30,109
correct code right<font color="#E5E5E5"> okay but that's the</font>

820
00:39:28,339 --> 00:39:32,720
device at the far end of the warehouse

821
00:39:30,109 --> 00:39:35,150
<font color="#E5E5E5">it's not being</font><font color="#CCCCCC"> used the attacker has</font>

822
00:39:32,720 --> 00:39:37,009
connected<font color="#E5E5E5"> over there but let's imagine</font>

823
00:39:35,150 --> 00:39:38,480
that<font color="#E5E5E5"> now you come to work and you use</font>

824
00:39:37,009 --> 00:39:42,099
the keypad that<font color="#E5E5E5"> you usually use every</font>

825
00:39:38,480 --> 00:39:46,250
day<font color="#CCCCCC"> and you got your keypads</font><font color="#E5E5E5"> and you</font>

826
00:39:42,099 --> 00:39:49,490
type in your<font color="#CCCCCC"> PIN code your code in here</font>

827
00:39:46,250 --> 00:39:55,609
<font color="#E5E5E5">on a different keypad right the active</font>

828
00:39:49,490 --> 00:39:57,589
keypad<font color="#E5E5E5"> it's still being sent over the</font>

829
00:39:55,609 --> 00:40:01,130
combos to<font color="#E5E5E5"> all the devices on the combos</font>

830
00:39:57,589 --> 00:40:02,839
<font color="#E5E5E5">right and we can see the code typed in</font>

831
00:40:01,130 --> 00:40:06,049
here<font color="#CCCCCC"> zero one seven eight in</font><font color="#E5E5E5"> this case</font>

832
00:40:02,839 --> 00:40:09,680
from<font color="#E5E5E5"> a different device and it's</font><font color="#CCCCCC"> Excel</font>

833
00:40:06,049 --> 00:40:10,910
accepted so the code is correct<font color="#E5E5E5"> and by</font>

834
00:40:09,680 --> 00:40:14,299
the way we can<font color="#E5E5E5"> also see that it was a</font>

835
00:40:10,910 --> 00:40:21,890
duress code<font color="#CCCCCC"> right so we</font><font color="#E5E5E5"> can even even</font>

836
00:40:14,299 --> 00:40:23,329
get<font color="#E5E5E5"> that finally even if</font><font color="#CCCCCC"> you use</font>

837
00:40:21,890 --> 00:40:25,578
<font color="#E5E5E5">something that's not connected</font><font color="#CCCCCC"> to combos</font>

838
00:40:23,329 --> 00:40:27,230
<font color="#CCCCCC">like for example</font><font color="#E5E5E5"> many of these devices</font>

839
00:40:25,579 --> 00:40:29,630
including this one<font color="#E5E5E5"> now come with a</font>

840
00:40:27,230 --> 00:40:32,509
remote<font color="#E5E5E5"> you don't have to remember code</font>

841
00:40:29,630 --> 00:40:35,539
you can simply press<font color="#E5E5E5"> a button and things</font>

842
00:40:32,509 --> 00:40:38,000
<font color="#E5E5E5">will happen it's wireless</font><font color="#CCCCCC"> it goes</font>

843
00:40:35,539 --> 00:40:42,740
directly to this<font color="#E5E5E5"> arrow panel it's not</font>

844
00:40:38,000 --> 00:40:45,680
speaking combos but still because<font color="#E5E5E5"> every</font>

845
00:40:42,740 --> 00:40:48,049
panel needs<font color="#E5E5E5"> to know the status of the</font>

846
00:40:45,680 --> 00:40:49,879
<font color="#E5E5E5">system this data is</font><font color="#CCCCCC"> being</font><font color="#E5E5E5"> sent over</font>

847
00:40:48,049 --> 00:40:52,400
combos<font color="#E5E5E5"> I press the</font><font color="#CCCCCC"> log button here I get</font>

848
00:40:49,880 --> 00:40:54,619
red light<font color="#CCCCCC"> and we</font><font color="#E5E5E5"> can see that remote</font>

849
00:40:52,400 --> 00:40:58,160
button<font color="#E5E5E5"> lock was pressed just configured</font>

850
00:40:54,619 --> 00:41:01,789
for user<font color="#CCCCCC"> 1 right where we can as well</font>

851
00:40:58,160 --> 00:41:03,529
unlock it of course<font color="#E5E5E5"> right here right and</font>

852
00:41:01,789 --> 00:41:06,319
<font color="#E5E5E5">even there are some more buttons right</font>

853
00:41:03,529 --> 00:41:09,140
we can press<font color="#CCCCCC"> the buttons right</font><font color="#E5E5E5"> or we can</font>

854
00:41:06,319 --> 00:41:11,240
press<font color="#CCCCCC"> the</font><font color="#E5E5E5"> information button so it's all</font>

855
00:41:09,140 --> 00:41:11,970
being<font color="#E5E5E5"> sent over combos and so being</font>

856
00:41:11,240 --> 00:41:17,939
trans

857
00:41:11,970 --> 00:41:22,618
tribe using the code that<font color="#E5E5E5"> I wrote so</font>

858
00:41:17,940 --> 00:41:35,430
that's the demo<font color="#E5E5E5"> let us get</font><font color="#CCCCCC"> back</font><font color="#E5E5E5"> to the</font>

859
00:41:22,619 --> 00:41:37,500
slides on their<font color="#CCCCCC"> web page right now</font><font color="#E5E5E5"> this</font>

860
00:41:35,430 --> 00:41:41,879
<font color="#E5E5E5">is what the company says about this</font>

861
00:41:37,500 --> 00:41:43,170
panel a 192<font color="#E5E5E5"> digger plugs and digger plug</font>

862
00:41:41,880 --> 00:41:45,619
several<font color="#E5E5E5"> assistants provide the highest</font>

863
00:41:43,170 --> 00:41:48,180
level<font color="#CCCCCC"> of</font><font color="#E5E5E5"> protection for</font><font color="#CCCCCC"> banks</font>

864
00:41:45,619 --> 00:41:50,580
<font color="#CCCCCC">high-security</font><font color="#E5E5E5"> military and government</font>

865
00:41:48,180 --> 00:41:53,390
sites<font color="#E5E5E5"> which various residential homes</font>

866
00:41:50,580 --> 00:41:56,730
<font color="#E5E5E5">and any place for maximum security is</font>

867
00:41:53,390 --> 00:42:05,520
essential so well that's<font color="#E5E5E5"> the best they</font>

868
00:41:56,730 --> 00:42:09,750
<font color="#CCCCCC">have apparently</font><font color="#E5E5E5"> in summary so the impact</font>

869
00:42:05,520 --> 00:42:12,690
of the research that<font color="#E5E5E5"> we did here</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> built</font>

870
00:42:09,750 --> 00:42:15,690
some hardware<font color="#E5E5E5"> and the decoding software</font>

871
00:42:12,690 --> 00:42:18,230
<font color="#E5E5E5">are out as well</font><font color="#CCCCCC"> that means it's now</font>

872
00:42:15,690 --> 00:42:21,839
available<font color="#E5E5E5"> publicly the company has had</font>

873
00:42:18,230 --> 00:42:25,500
<font color="#E5E5E5">enough</font><font color="#CCCCCC"> time to look at the problems to</font>

874
00:42:21,839 --> 00:42:27,119
fix them if they wish to<font color="#CCCCCC"> and I hope</font><font color="#E5E5E5"> that</font>

875
00:42:25,500 --> 00:42:31,680
<font color="#E5E5E5">other people</font><font color="#CCCCCC"> will use it</font><font color="#E5E5E5"> for good and</font>

876
00:42:27,119 --> 00:42:36,030
<font color="#CCCCCC">will be able</font><font color="#E5E5E5"> to test their own systems</font>

877
00:42:31,680 --> 00:42:38,848
I<font color="#CCCCCC"> hope partially transparent and striped</font>

878
00:42:36,030 --> 00:42:41,250
<font color="#E5E5E5">the combust protocol on the command</font>

879
00:42:38,849 --> 00:42:43,530
level<font color="#E5E5E5"> so the lower layers are done</font><font color="#CCCCCC"> the</font>

880
00:42:41,250 --> 00:42:46,980
command layer<font color="#E5E5E5"> it's partially transcribed</font>

881
00:42:43,530 --> 00:42:49,230
<font color="#CCCCCC">I think I've covered maybe 60 to</font><font color="#E5E5E5"> 80</font>

882
00:42:46,980 --> 00:42:51,030
<font color="#CCCCCC">percent of it so you can get a lot</font><font color="#E5E5E5"> of</font>

883
00:42:49,230 --> 00:42:53,880
information<font color="#CCCCCC"> still</font><font color="#E5E5E5"> some of the commands</font>

884
00:42:51,030 --> 00:42:57,089
will come up as unknown<font color="#E5E5E5"> so there's still</font>

885
00:42:53,880 --> 00:42:59,010
<font color="#E5E5E5">some</font><font color="#CCCCCC"> work to</font><font color="#E5E5E5"> be done and the possible</font>

886
00:42:57,089 --> 00:43:02,180
attacks that<font color="#E5E5E5"> I talked about at</font><font color="#CCCCCC"> the</font>

887
00:42:59,010 --> 00:43:05,760
beginning of<font color="#E5E5E5"> the presentation they can</font>

888
00:43:02,180 --> 00:43:06,960
affect anyone<font color="#E5E5E5"> especially</font><font color="#CCCCCC"> when you have</font>

889
00:43:05,760 --> 00:43:10,770
<font color="#E5E5E5">installed the system thinking it's a</font>

890
00:43:06,960 --> 00:43:16,740
<font color="#E5E5E5">hard security system but in fact it's</font>

891
00:43:10,770 --> 00:43:19,619
<font color="#CCCCCC">vulnerable to some pretty basic 90s</font><font color="#E5E5E5"> air</font>

892
00:43:16,740 --> 00:43:24,660
security<font color="#E5E5E5"> flaws or rather lack of</font>

893
00:43:19,619 --> 00:43:25,590
security so of course my research even

894
00:43:24,660 --> 00:43:27,839
though

895
00:43:25,590 --> 00:43:31,440
<font color="#CCCCCC">I tend to</font><font color="#E5E5E5"> try and</font><font color="#CCCCCC"> find more</font><font color="#E5E5E5"> abilities</font>

896
00:43:27,840 --> 00:43:36,270
and systems<font color="#CCCCCC"> I</font><font color="#E5E5E5"> always want to provide</font><font color="#CCCCCC"> the</font>

897
00:43:31,440 --> 00:43:39,570
<font color="#E5E5E5">solution to</font><font color="#CCCCCC"> fix the problem if they want</font>

898
00:43:36,270 --> 00:43:42,600
<font color="#CCCCCC">to sew solutions that</font><font color="#E5E5E5"> can provide here</font>

899
00:43:39,570 --> 00:43:46,620
are some of you may say there are<font color="#E5E5E5"> a bit</font>

900
00:43:42,600 --> 00:43:49,580
over the<font color="#CCCCCC"> top</font><font color="#E5E5E5"> a bit</font><font color="#CCCCCC"> too much and it's</font>

901
00:43:46,620 --> 00:43:52,970
true it can be done simpler<font color="#E5E5E5"> if needed</font>

902
00:43:49,580 --> 00:43:56,160
however if done in a simple<font color="#CCCCCC"> manner</font>

903
00:43:52,970 --> 00:43:56,939
<font color="#E5E5E5">there's risk of implementing bad</font>

904
00:43:56,160 --> 00:43:59,759
<font color="#CCCCCC">selfmade</font>

905
00:43:56,940 --> 00:44:01,320
cryptography so since the systems are

906
00:43:59,760 --> 00:44:03,750
powerful enough<font color="#E5E5E5"> these days</font><font color="#CCCCCC"> all the</font>

907
00:44:01,320 --> 00:44:06,660
modules are powerful or can be powerful

908
00:44:03,750 --> 00:44:09,150
<font color="#CCCCCC">enough with low power consumption</font><font color="#E5E5E5"> huge</font>

909
00:44:06,660 --> 00:44:12,629
processing power and small a form<font color="#E5E5E5"> factor</font>

910
00:44:09,150 --> 00:44:16,830
<font color="#CCCCCC">I think we need encryption commander of</font>

911
00:44:12,630 --> 00:44:18,840
course and with powerful devices<font color="#CCCCCC"> a good</font>

912
00:44:16,830 --> 00:44:20,299
protocol that's been vetted and tested

913
00:44:18,840 --> 00:44:24,720
is<font color="#E5E5E5"> the same we used for banking online</font>

914
00:44:20,300 --> 00:44:26,790
<font color="#CCCCCC">we</font><font color="#E5E5E5"> can use TLS</font><font color="#CCCCCC"> right once again it may</font>

915
00:44:24,720 --> 00:44:28,410
be<font color="#E5E5E5"> a bit</font><font color="#CCCCCC"> too much</font><font color="#E5E5E5"> but</font><font color="#CCCCCC"> implementing your</font>

916
00:44:26,790 --> 00:44:30,810
<font color="#CCCCCC">own homemade security protocols</font>

917
00:44:28,410 --> 00:44:37,740
cryptography protocols sometimes<font color="#E5E5E5"> ends</font>

918
00:44:30,810 --> 00:44:39,420
well mostly doesn't how do we implement

919
00:44:37,740 --> 00:44:41,089
TLS in a system<font color="#E5E5E5"> that's not connected</font><font color="#CCCCCC"> to</font>

920
00:44:39,420 --> 00:44:44,010
the<font color="#E5E5E5"> Internet</font>

921
00:44:41,090 --> 00:44:46,470
all components<font color="#E5E5E5"> should ship from the</font>

922
00:44:44,010 --> 00:44:50,550
factory<font color="#CCCCCC"> with certificate authority in</font>

923
00:44:46,470 --> 00:44:52,589
their trust or of<font color="#E5E5E5"> course as an added</font>

924
00:44:50,550 --> 00:44:55,230
benefit if paradox security is listening

925
00:44:52,590 --> 00:44:58,380
to<font color="#E5E5E5"> this this also would</font><font color="#CCCCCC"> allow them to</font>

926
00:44:55,230 --> 00:45:00,660
<font color="#E5E5E5">sell</font><font color="#CCCCCC"> licenses right</font><font color="#E5E5E5"> see</font><font color="#CCCCCC"> a works for</font><font color="#E5E5E5"> 10</font>

927
00:44:58,380 --> 00:45:03,410
years or 20<font color="#E5E5E5"> years</font><font color="#CCCCCC"> and then expires so</font>

928
00:45:00,660 --> 00:45:07,259
that's that's<font color="#E5E5E5"> also there we also need</font>

929
00:45:03,410 --> 00:45:08,700
mutual<font color="#CCCCCC"> slavemaster authentication it's</font>

930
00:45:07,260 --> 00:45:10,560
not about<font color="#E5E5E5"> encryption it's not only about</font>

931
00:45:08,700 --> 00:45:13,620
protecting the<font color="#E5E5E5"> data it's also about</font>

932
00:45:10,560 --> 00:45:19,470
making<font color="#CCCCCC"> sure that</font><font color="#E5E5E5"> unauthorized</font><font color="#CCCCCC"> combis</font>

933
00:45:13,620 --> 00:45:22,049
slaves<font color="#E5E5E5"> do not send in any data client</font>

934
00:45:19,470 --> 00:45:27,810
certificates can<font color="#CCCCCC"> be used for</font><font color="#E5E5E5"> that easy</font>

935
00:45:22,050 --> 00:45:32,010
<font color="#E5E5E5">part of TLS right and that can be used</font>

936
00:45:27,810 --> 00:45:36,490
each panel can ship with a client

937
00:45:32,010 --> 00:45:38,589
certificate now in addition<font color="#E5E5E5"> to that</font>

938
00:45:36,490 --> 00:45:41,439
in addition to TLS<font color="#E5E5E5"> I believe in security</font>

939
00:45:38,589 --> 00:45:44,049
in depth so I think that sensitive

940
00:45:41,440 --> 00:45:47,200
payloads<font color="#E5E5E5"> like codes should</font><font color="#CCCCCC"> also be</font>

941
00:45:44,050 --> 00:45:49,210
encrypted<font color="#CCCCCC"> in addition to TLS and it</font>

942
00:45:47,200 --> 00:45:53,020
could be<font color="#E5E5E5"> easily done with unique per</font>

943
00:45:49,210 --> 00:45:55,530
panel key almost no<font color="#E5E5E5"> one in this room</font>

944
00:45:53,020 --> 00:45:58,839
<font color="#E5E5E5">installs the security</font><font color="#CCCCCC"> systems themselves</font>

945
00:45:55,530 --> 00:46:02,710
<font color="#CCCCCC">we trust professionals to do it and when</font>

946
00:45:58,839 --> 00:46:07,720
professional comes to install it if the

947
00:46:02,710 --> 00:46:10,839
manufacturer would provide this it would

948
00:46:07,720 --> 00:46:13,270
<font color="#E5E5E5">be possible</font><font color="#CCCCCC"> for them to synchronize a</font>

949
00:46:10,839 --> 00:46:15,630
unique key<font color="#E5E5E5"> so all the</font><font color="#CCCCCC"> devices connected</font>

950
00:46:13,270 --> 00:46:19,630
<font color="#CCCCCC">to a single master</font><font color="#E5E5E5"> to a single</font><font color="#CCCCCC"> panel and</font>

951
00:46:15,630 --> 00:46:24,940
that way we can have sensitive payload

952
00:46:19,630 --> 00:46:28,089
encryption as well now<font color="#E5E5E5"> a bit but</font><font color="#CCCCCC"> for the</font>

953
00:46:24,940 --> 00:46:30,450
<font color="#E5E5E5">research and I know some of you here</font>

954
00:46:28,089 --> 00:46:33,940
love<font color="#E5E5E5"> to hack signals or love to hack</font>

955
00:46:30,450 --> 00:46:37,180
other stuff so if<font color="#CCCCCC"> you're if you'd like</font>

956
00:46:33,940 --> 00:46:38,440
to contribute<font color="#E5E5E5"> it's gonna be it</font><font color="#CCCCCC"> is on</font>

957
00:46:37,180 --> 00:46:41,770
<font color="#CCCCCC">github</font><font color="#E5E5E5"> and I'm gonna show you the link</font>

958
00:46:38,440 --> 00:46:45,130
<font color="#CCCCCC">so please contribute</font><font color="#E5E5E5"> please please help</font>

959
00:46:41,770 --> 00:46:49,060
<font color="#E5E5E5">me put</font><font color="#CCCCCC"> advanced security search here</font>

960
00:46:45,130 --> 00:46:52,720
another understand how really secure<font color="#E5E5E5"> are</font>

961
00:46:49,060 --> 00:46:56,320
we when we were using<font color="#E5E5E5"> security alarm</font>

962
00:46:52,720 --> 00:46:59,020
systems<font color="#E5E5E5"> so one thing that I need to test</font>

963
00:46:56,320 --> 00:47:01,270
still is denial of service attacks<font color="#CCCCCC"> is</font>

964
00:46:59,020 --> 00:47:03,930
there a possibility<font color="#E5E5E5"> for the attacker to</font>

965
00:47:01,270 --> 00:47:07,060
come in and simply<font color="#CCCCCC"> disable the system</font>

966
00:47:03,930 --> 00:47:09,250
<font color="#E5E5E5">right because why do</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> have the battery</font>

967
00:47:07,060 --> 00:47:10,750
for<font color="#E5E5E5"> the system we have it so</font><font color="#CCCCCC"> that the</font>

968
00:47:09,250 --> 00:47:14,470
attacker<font color="#CCCCCC"> cannot</font><font color="#E5E5E5"> simply cut the power</font>

969
00:47:10,750 --> 00:47:16,240
line to<font color="#CCCCCC"> your house and break in that's</font>

970
00:47:14,470 --> 00:47:19,000
why the battery is there but is there

971
00:47:16,240 --> 00:47:24,459
some<font color="#E5E5E5"> other type of</font><font color="#CCCCCC"> attack that we use</font><font color="#E5E5E5"> to</font>

972
00:47:19,000 --> 00:47:27,010
<font color="#E5E5E5">disable the</font><font color="#CCCCCC"> system immediately emulating</font>

973
00:47:24,460 --> 00:47:30,430
a slave<font color="#E5E5E5"> is an interesting</font><font color="#CCCCCC"> avenue of</font>

974
00:47:27,010 --> 00:47:32,890
research<font color="#E5E5E5"> so actually setting up pulldown</font>

975
00:47:30,430 --> 00:47:35,080
resistors on their<font color="#CCCCCC"> reno side and trying</font>

976
00:47:32,890 --> 00:47:37,420
to emulate<font color="#E5E5E5"> this</font><font color="#CCCCCC"> life trying to send in</font>

977
00:47:35,080 --> 00:47:38,859
<font color="#E5E5E5">data trying to guess</font><font color="#CCCCCC"> the pin</font><font color="#E5E5E5"> code for</font>

978
00:47:37,420 --> 00:47:41,220
<font color="#CCCCCC">example over a period of three and</font><font color="#E5E5E5"> a</font>

979
00:47:38,859 --> 00:47:44,290
half<font color="#E5E5E5"> months</font>

980
00:47:41,220 --> 00:47:46,540
combos over radio very interesting topic

981
00:47:44,290 --> 00:47:48,109
<font color="#E5E5E5">remember</font><font color="#CCCCCC"> these Nagaland systems those</font>

982
00:47:46,540 --> 00:47:51,750
are wireless

983
00:47:48,109 --> 00:47:56,009
so if not our<font color="#CCCCCC"> Wireless</font><font color="#E5E5E5"> does I still talk</font>

984
00:47:51,750 --> 00:47:57,420
<font color="#CCCCCC">comm bus is it still</font><font color="#E5E5E5"> not encrypted if so</font>

985
00:47:56,010 --> 00:47:59,670
it means the attacker<font color="#E5E5E5"> doesn't even have</font>

986
00:47:57,420 --> 00:48:01,890
to connect to your wires that<font color="#E5E5E5"> you</font><font color="#CCCCCC"> can't</font>

987
00:47:59,670 --> 00:48:04,470
<font color="#CCCCCC">appoint an antenna in the general</font>

988
00:48:01,890 --> 00:48:05,640
direction<font color="#E5E5E5"> of your house or office to</font>

989
00:48:04,470 --> 00:48:07,649
listen<font color="#E5E5E5"> to what's happening</font><font color="#CCCCCC"> a compass</font>

990
00:48:05,640 --> 00:48:09,779
<font color="#E5E5E5">these are open questions</font><font color="#CCCCCC"> I don't know</font>

991
00:48:07,650 --> 00:48:12,030
but if it's the same<font color="#CCCCCC"> combat without</font>

992
00:48:09,780 --> 00:48:13,910
encryption<font color="#E5E5E5"> or with weak encryption then</font>

993
00:48:12,030 --> 00:48:16,950
we got a<font color="#E5E5E5"> problem</font>

994
00:48:13,910 --> 00:48:18,509
<font color="#E5E5E5">radio frequency attacks those are quite</font>

995
00:48:16,950 --> 00:48:22,558
<font color="#E5E5E5">interesting</font><font color="#CCCCCC"> as well and I've started</font>

996
00:48:18,510 --> 00:48:24,030
looking<font color="#CCCCCC"> at that and months</font><font color="#E5E5E5"> ago so this</font>

997
00:48:22,559 --> 00:48:30,740
is different<font color="#CCCCCC"> protocol is not combos</font>

998
00:48:24,030 --> 00:48:33,420
it's being sent over 433 megahertz and

999
00:48:30,740 --> 00:48:35,759
the question is is<font color="#E5E5E5"> it secure enough or</font>

1000
00:48:33,420 --> 00:48:40,099
is it just<font color="#E5E5E5"> a rolling code that's been</font>

1001
00:48:35,760 --> 00:48:43,410
defeated<font color="#E5E5E5"> on cars some time ago already</font>

1002
00:48:40,099 --> 00:48:45,089
finally other<font color="#E5E5E5"> fun part that I'd really</font>

1003
00:48:43,410 --> 00:48:46,259
like to do<font color="#E5E5E5"> but it does take a lot of</font>

1004
00:48:45,089 --> 00:48:49,049
<font color="#E5E5E5">time and is a completely different</font>

1005
00:48:46,260 --> 00:48:50,700
<font color="#CCCCCC">tabbing</font><font color="#E5E5E5"> of research is reverse</font>

1006
00:48:49,049 --> 00:48:53,759
engineering the firmer<font color="#E5E5E5"> right instead</font><font color="#CCCCCC"> of</font>

1007
00:48:50,700 --> 00:48:56,788
looking at<font color="#E5E5E5"> the live</font><font color="#CCCCCC"> system just looking</font>

1008
00:48:53,760 --> 00:48:58,740
at how the<font color="#E5E5E5"> firmer is set up trying to</font>

1009
00:48:56,789 --> 00:49:02,279
dump the contents of the<font color="#CCCCCC"> memory of</font><font color="#E5E5E5"> the</font>

1010
00:48:58,740 --> 00:49:05,669
panel<font color="#E5E5E5"> trying to see if I can get to the</font>

1011
00:49:02,279 --> 00:49:09,270
assembly behind it trying<font color="#CCCCCC"> to see how the</font>

1012
00:49:05,670 --> 00:49:11,520
codes are stored on<font color="#E5E5E5"> the panel itself can</font>

1013
00:49:09,270 --> 00:49:14,670
a visitor to<font color="#CCCCCC"> your office acts as a</font>

1014
00:49:11,520 --> 00:49:20,640
system<font color="#E5E5E5"> and dump your codes unnoticed for</font>

1015
00:49:14,670 --> 00:49:23,910
example so that that is that<font color="#E5E5E5"> for the</font>

1016
00:49:20,640 --> 00:49:25,890
research that<font color="#E5E5E5"> I'd like to</font><font color="#CCCCCC"> look</font><font color="#E5E5E5"> at the</font>

1017
00:49:23,910 --> 00:49:28,020
slides will be<font color="#CCCCCC"> on Clearasil to work of</font>

1018
00:49:25,890 --> 00:49:30,240
course<font color="#CCCCCC"> also on</font><font color="#E5E5E5"> official site</font><font color="#CCCCCC"> for the</font>

1019
00:49:28,020 --> 00:49:32,670
conference<font color="#E5E5E5"> and the source code is</font>

1020
00:49:30,240 --> 00:49:34,770
available on github<font color="#CCCCCC"> comm 0ki</font>

1021
00:49:32,670 --> 00:49:37,829
paradox<font color="#E5E5E5"> so you can take a look at that</font>

1022
00:49:34,770 --> 00:49:40,640
you<font color="#E5E5E5"> can play around if you have system</font>

1023
00:49:37,829 --> 00:49:43,380
<font color="#CCCCCC">like that of course</font><font color="#E5E5E5"> do it legally and</font>

1024
00:49:40,640 --> 00:49:46,450
please do contribute<font color="#E5E5E5"> if you find</font>

1025
00:49:43,380 --> 00:49:49,430
anything<font color="#E5E5E5"> interesting</font><font color="#CCCCCC"> thank you very</font><font color="#E5E5E5"> much</font>

1026
00:49:46,450 --> 00:49:52,319
[Applause]

1027
00:49:49,430 --> 00:49:55,129
thank you so<font color="#E5E5E5"> much</font><font color="#CCCCCC"> girlís do we have any</font>

1028
00:49:52,319 --> 00:49:55,130
<font color="#CCCCCC">questions</font><font color="#E5E5E5"> from the crowd</font>

1029
00:49:55,819 --> 00:50:12,509
anyone right<font color="#CCCCCC"> thank you</font><font color="#E5E5E5"> so much</font><font color="#CCCCCC"> your</font>

1030
00:50:09,510 --> 00:50:16,410
presentation<font color="#E5E5E5"> was</font><font color="#CCCCCC"> very helpful I have a</font>

1031
00:50:12,510 --> 00:50:17,910
<font color="#E5E5E5">question as</font><font color="#CCCCCC"> you have</font><font color="#E5E5E5"> demonstrated</font><font color="#CCCCCC"> in</font>

1032
00:50:16,410 --> 00:50:20,308
order to conduct<font color="#E5E5E5"> such type of heart</font>

1033
00:50:17,910 --> 00:50:22,529
<font color="#CCCCCC">attack</font><font color="#E5E5E5"> so that</font><font color="#CCCCCC"> means the physical</font>

1034
00:50:20,309 --> 00:50:23,789
security<font color="#E5E5E5"> is already pleased right so</font>

1035
00:50:22,529 --> 00:50:25,470
that means you<font color="#E5E5E5"> have a bigger plot</font>

1036
00:50:23,789 --> 00:50:28,380
problem<font color="#CCCCCC"> attacker is already in your</font>

1037
00:50:25,470 --> 00:50:30,240
<font color="#CCCCCC">environment so how do you see such type</font>

1038
00:50:28,380 --> 00:50:35,150
<font color="#CCCCCC">of an implant</font><font color="#E5E5E5"> in plantation by the</font>

1039
00:50:30,240 --> 00:50:39,118
hacker<font color="#E5E5E5"> in any secured</font><font color="#CCCCCC"> environment in</font>

1040
00:50:35,150 --> 00:50:41,910
especially in secure environments delay

1041
00:50:39,119 --> 00:50:44,490
is not<font color="#CCCCCC"> used for</font><font color="#E5E5E5"> alarm so as soon as</font><font color="#CCCCCC"> you</font>

1042
00:50:41,910 --> 00:50:46,710
open up<font color="#CCCCCC"> door or alarm goes off its</font>

1043
00:50:44,490 --> 00:50:47,910
<font color="#E5E5E5">configurable but in highly secure</font>

1044
00:50:46,710 --> 00:50:51,690
environments<font color="#E5E5E5"> it will configure it like</font>

1045
00:50:47,910 --> 00:50:53,578
that so that<font color="#CCCCCC"> means in turn that the</font>

1046
00:50:51,690 --> 00:50:56,490
<font color="#E5E5E5">keypad has to be</font><font color="#CCCCCC"> outside the secure zone</font>

1047
00:50:53,579 --> 00:50:59,069
<font color="#CCCCCC">rozelle are not to go off and if the</font>

1048
00:50:56,490 --> 00:51:01,828
keypads outside and<font color="#E5E5E5"> attacker can access</font>

1049
00:50:59,069 --> 00:51:03,390
it and of course<font color="#CCCCCC"> it's just the prelude</font>

1050
00:51:01,829 --> 00:51:05,339
to<font color="#E5E5E5"> further research for example</font><font color="#CCCCCC"> for</font>

1051
00:51:03,390 --> 00:51:07,609
<font color="#E5E5E5">combos over radio where you can access</font>

1052
00:51:05,339 --> 00:51:07,609
<font color="#CCCCCC">it remotely</font>

1053
00:51:07,670 --> 00:51:19,019
<font color="#E5E5E5">any more questions may be all right then</font>

1054
00:51:16,829 --> 00:51:22,100
<font color="#E5E5E5">if that was it then thank you so much</font>

1055
00:51:19,019 --> 00:51:25,379
<font color="#CCCCCC">release for you thanks I'll</font><font color="#E5E5E5"> be around</font>

1056
00:51:22,100 --> 00:51:25,380
[Applause]

