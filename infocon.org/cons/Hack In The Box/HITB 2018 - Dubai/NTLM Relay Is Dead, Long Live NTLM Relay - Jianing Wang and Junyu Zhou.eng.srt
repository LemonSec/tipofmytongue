1
00:00:24,570 --> 00:00:32,610
hello guys<font color="#CCCCCC"> today our topic is about</font>

2
00:00:28,800 --> 00:00:35,519
<font color="#E5E5E5">until</font><font color="#CCCCCC"> my relay as well know and he'll</font>

3
00:00:32,610 --> 00:00:39,570
<font color="#CCCCCC">Marilla</font><font color="#E5E5E5"> it's an agent</font><font color="#CCCCCC"> exploit method in</font>

4
00:00:35,519 --> 00:00:43,739
all has many restrictions<font color="#E5E5E5"> and it needs</font>

5
00:00:39,570 --> 00:00:46,290
to be hard to have<font color="#CCCCCC"> a rebirth so we will</font>

6
00:00:43,739 --> 00:00:48,449
<font color="#E5E5E5">talk about some tricks to make in TM</font>

7
00:00:46,290 --> 00:00:54,379
really great again<font color="#E5E5E5"> yeah and he I'm</font>

8
00:00:48,449 --> 00:00:59,189
<font color="#E5E5E5">really sad lonely</font><font color="#CCCCCC"> winter I'm a relay</font><font color="#E5E5E5"> and</font>

9
00:00:54,379 --> 00:01:02,309
I'm doing<font color="#E5E5E5"> and my twitter name is 75</font>

10
00:00:59,189 --> 00:01:06,270
<font color="#CCCCCC">thought I'm from oops City</font><font color="#E5E5E5"> after</font><font color="#CCCCCC"> him</font><font color="#E5E5E5"> and</font>

11
00:01:02,309 --> 00:01:10,590
I'm<font color="#CCCCCC"> two years Oh cheekbone</font><font color="#E5E5E5"> winner</font><font color="#CCCCCC"> simple</font>

12
00:01:06,270 --> 00:01:14,610
is a<font color="#E5E5E5"> contest in China talking into smart</font>

13
00:01:10,590 --> 00:01:19,229
life and here is my<font color="#E5E5E5"> chin hub you can</font>

14
00:01:14,610 --> 00:01:23,820
<font color="#E5E5E5">find some useful tools here and he's my</font>

15
00:01:19,229 --> 00:01:26,670
mates<font color="#E5E5E5"> hello I'm Johnny</font><font color="#CCCCCC"> this is</font><font color="#E5E5E5"> my</font>

16
00:01:23,820 --> 00:01:29,339
<font color="#CCCCCC">twitter i'm from the</font><font color="#E5E5E5"> security</font><font color="#CCCCCC"> circular a</font>

17
00:01:26,670 --> 00:01:31,950
<font color="#E5E5E5">security team</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> is my blog</font><font color="#E5E5E5"> you</font>

18
00:01:29,340 --> 00:01:39,290
can<font color="#CCCCCC"> find some</font><font color="#E5E5E5"> consolation test article</font>

19
00:01:31,950 --> 00:01:42,479
on days<font color="#E5E5E5"> and</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> are all from</font><font color="#CCCCCC"> tangential</font>

20
00:01:39,290 --> 00:01:48,140
securities<font color="#CCCCCC"> from lab and we are we have</font>

21
00:01:42,479 --> 00:01:51,000
security<font color="#CCCCCC"> researcher and</font><font color="#E5E5E5"> pen tester</font><font color="#CCCCCC"> okay</font>

22
00:01:48,140 --> 00:01:54,180
<font color="#E5E5E5">today we will talk about in hammer relay</font>

23
00:01:51,000 --> 00:01:57,869
we are first we<font color="#E5E5E5"> all talk about some</font><font color="#CCCCCC"> NTM</font>

24
00:01:54,180 --> 00:02:02,010
relay basics and the some<font color="#CCCCCC"> noon and he</font>

25
00:01:57,869 --> 00:02:04,979
are<font color="#CCCCCC"> merrily attacks</font><font color="#E5E5E5"> next we will talk</font>

26
00:02:02,010 --> 00:02:09,420
about our new findings<font color="#E5E5E5"> a new way to send</font>

27
00:02:04,979 --> 00:02:13,349
<font color="#CCCCCC">current shows in bruises and a mb</font>

28
00:02:09,419 --> 00:02:15,599
reflection attack rebirth<font color="#E5E5E5"> finally we all</font>

29
00:02:13,349 --> 00:02:19,738
talk about<font color="#CCCCCC"> how to defend against and he</font>

30
00:02:15,599 --> 00:02:22,209
merrily attacks so let's start with

31
00:02:19,739 --> 00:02:26,269
entirely<font color="#E5E5E5"> basics</font>

32
00:02:22,209 --> 00:02:29,209
what is auntie em auntie em is called

33
00:02:26,269 --> 00:02:31,580
<font color="#E5E5E5">until a manager</font><font color="#CCCCCC"> it is a protocol for</font>

34
00:02:29,209 --> 00:02:35,540
authentication integrity and

35
00:02:31,580 --> 00:02:38,959
confidentiality<font color="#CCCCCC"> it is</font><font color="#E5E5E5"> a challenge</font>

36
00:02:35,540 --> 00:02:42,290
<font color="#E5E5E5">response authentication protocol he only</font>

37
00:02:38,959 --> 00:02:45,620
has three messages have<font color="#CCCCCC"> one message</font>

38
00:02:42,290 --> 00:02:48,709
it's for negotiation type<font color="#CCCCCC"> two message is</font>

39
00:02:45,620 --> 00:02:52,459
for challenge and<font color="#E5E5E5"> have three message</font>

40
00:02:48,709 --> 00:02:55,280
<font color="#E5E5E5">it's for authentication in my soup</font>

41
00:02:52,459 --> 00:03:01,579
Microsoft<font color="#E5E5E5"> Windows</font><font color="#CCCCCC"> there is</font><font color="#E5E5E5"> a interface</font>

42
00:02:55,280 --> 00:03:05,060
called Microsoft web security<font color="#CCCCCC"> supports</font>

43
00:03:01,579 --> 00:03:10,750
provider<font color="#E5E5E5"> and it can be implemented by n</font>

44
00:03:05,060 --> 00:03:10,750
<font color="#E5E5E5">TR M which is called n CRM as at the P</font>

45
00:03:10,930 --> 00:03:17,599
<font color="#CCCCCC">okay let's move to the three types</font><font color="#E5E5E5"> of</font>

46
00:03:13,489 --> 00:03:21,319
message and type<font color="#E5E5E5"> one message is for</font>

47
00:03:17,599 --> 00:03:24,280
negotiation the client wants to<font color="#CCCCCC"> login to</font>

48
00:03:21,319 --> 00:03:28,100
<font color="#CCCCCC">the</font><font color="#E5E5E5"> server and the client sends some</font>

49
00:03:24,280 --> 00:03:32,780
basic information<font color="#CCCCCC"> with</font><font color="#E5E5E5"> itself</font><font color="#CCCCCC"> to the</font>

50
00:03:28,100 --> 00:03:36,400
server<font color="#E5E5E5"> and ask for a login</font><font color="#CCCCCC"> and the</font>

51
00:03:32,780 --> 00:03:41,450
server we are written a challenge<font color="#E5E5E5"> and</font>

52
00:03:36,400 --> 00:03:46,549
<font color="#E5E5E5">ask for the proof of credentials of</font><font color="#CCCCCC"> the</font>

53
00:03:41,450 --> 00:03:49,700
client so after the<font color="#E5E5E5"> client get a</font>

54
00:03:46,549 --> 00:03:51,739
<font color="#E5E5E5">challenge and</font><font color="#CCCCCC"> it calculus with the</font>

55
00:03:49,700 --> 00:03:55,339
password with clients password and the

56
00:03:51,739 --> 00:03:58,489
challenge and it will get our challenge

57
00:03:55,340 --> 00:04:01,190
response<font color="#E5E5E5"> the client since the challenge</font>

58
00:03:58,489 --> 00:04:04,639
<font color="#E5E5E5">response to the server and the server</font>

59
00:04:01,190 --> 00:04:07,430
checks<font color="#E5E5E5"> of the challenge response is</font>

60
00:04:04,639 --> 00:04:11,660
right or<font color="#CCCCCC"> not</font><font color="#E5E5E5"> and finish the</font>

61
00:04:07,430 --> 00:04:14,810
authentication<font color="#E5E5E5"> and there are some</font>

62
00:04:11,660 --> 00:04:19,789
protocols<font color="#E5E5E5"> using</font><font color="#CCCCCC"> n TR</font><font color="#E5E5E5"> method the P such</font>

63
00:04:14,810 --> 00:04:24,889
as<font color="#E5E5E5"> SMB a DDD p LD a pianist microsoft</font>

64
00:04:19,789 --> 00:04:26,599
secure server so before we come to

65
00:04:24,889 --> 00:04:29,690
<font color="#CCCCCC">Auntie</font><font color="#E5E5E5"> arm really attacks</font>

66
00:04:26,599 --> 00:04:32,860
<font color="#E5E5E5">that's about let's talk about windows</font>

67
00:04:29,690 --> 00:04:32,860
name<font color="#CCCCCC"> resolution first</font>

68
00:04:33,199 --> 00:04:43,400
oh when<font color="#CCCCCC"> you</font><font color="#E5E5E5"> accessor</font><font color="#CCCCCC"> do</font><font color="#E5E5E5"> man the windows</font>

69
00:04:41,240 --> 00:04:47,539
we are resolved the<font color="#CCCCCC"> dolmen</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> our IP</font>

70
00:04:43,400 --> 00:04:50,299
<font color="#E5E5E5">address so it's fallen</font><font color="#CCCCCC"> its it abates the</font>

71
00:04:47,539 --> 00:04:53,628
<font color="#E5E5E5">following order first it will look up</font>

72
00:04:50,300 --> 00:04:57,529
<font color="#E5E5E5">the name from the</font><font color="#CCCCCC"> host file and next the</font>

73
00:04:53,629 --> 00:05:00,699
we all perform a duet query<font color="#E5E5E5"> if not fund</font>

74
00:04:57,529 --> 00:05:05,360
it we all look up the local lmhosts file

75
00:05:00,699 --> 00:05:08,779
if<font color="#E5E5E5"> also means it will use</font><font color="#CCCCCC"> a RM</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> our</font>

76
00:05:05,360 --> 00:05:16,129
and<font color="#CCCCCC"> Andy and add these two protocols to</font>

77
00:05:08,779 --> 00:05:20,659
get a real IP so what is a RM n<font color="#CCCCCC"> r it</font><font color="#E5E5E5"> is</font>

78
00:05:16,129 --> 00:05:26,120
a link-local multicast<font color="#E5E5E5"> name</font><font color="#CCCCCC"> resolution</font>

79
00:05:20,659 --> 00:05:30,800
and it is based<font color="#E5E5E5"> on UDP and here is a</font>

80
00:05:26,120 --> 00:05:35,240
sample packet and ambien<font color="#E5E5E5"> earth it is it</font>

81
00:05:30,800 --> 00:05:38,930
is NetBIOS name service it use it is

82
00:05:35,240 --> 00:05:43,159
typically based on<font color="#CCCCCC"> Ubu db2 and it is a</font>

83
00:05:38,930 --> 00:05:48,050
broadcast protocol and<font color="#E5E5E5"> its sauce and</font>

84
00:05:43,159 --> 00:05:51,229
despot are both<font color="#E5E5E5"> 137 and here is a sample</font>

85
00:05:48,050 --> 00:05:54,169
packet<font color="#E5E5E5"> you can see the salt pot and</font>

86
00:05:51,229 --> 00:05:56,870
despot<font color="#E5E5E5"> above the</font><font color="#CCCCCC"> 137 and there is a</font>

87
00:05:54,169 --> 00:06:03,430
famous exploit called per channel and

88
00:05:56,870 --> 00:06:10,479
the that exploit<font color="#E5E5E5"> use this feature and</font>

89
00:06:03,430 --> 00:06:13,729
<font color="#E5E5E5">NBS and can be easily spoofed here is a</font>

90
00:06:10,479 --> 00:06:15,740
<font color="#E5E5E5">excellent tool called responder we can</font>

91
00:06:13,729 --> 00:06:19,818
use this tool<font color="#E5E5E5"> to spoof these two</font>

92
00:06:15,740 --> 00:06:22,360
protocols<font color="#E5E5E5"> so the attacker can be any</font>

93
00:06:19,819 --> 00:06:22,360
host

94
00:06:23,560 --> 00:06:32,120
so what after<font color="#CCCCCC"> that and there is a</font>

95
00:06:28,330 --> 00:06:36,580
<font color="#E5E5E5">special host called debrief Heidi which</font>

96
00:06:32,120 --> 00:06:39,550
means web proxy auto-discovery protocol

97
00:06:36,580 --> 00:06:46,568
and

98
00:06:39,550 --> 00:06:50,020
by default the in the internet<font color="#E5E5E5"> internet</font>

99
00:06:46,569 --> 00:06:53,860
properties<font color="#CCCCCC"> automatically detect pro-q</font>

100
00:06:50,020 --> 00:06:58,060
<font color="#E5E5E5">settings and is set to true so the</font>

101
00:06:53,860 --> 00:07:02,879
windows we<font color="#E5E5E5"> are first access HTTP da ba</font>

102
00:06:58,060 --> 00:07:08,409
dee da ba da da dat to finish a<font color="#CCCCCC"> PC file</font>

103
00:07:02,879 --> 00:07:11,530
<font color="#E5E5E5">the PC file contains some proxy rows so</font>

104
00:07:08,409 --> 00:07:16,319
which means if the the attacker can

105
00:07:11,530 --> 00:07:19,479
hijack the loop ID the weak team will

106
00:07:16,319 --> 00:07:24,039
get the PC file from the attacker and

107
00:07:19,479 --> 00:07:25,840
<font color="#CCCCCC">the attacker can be the proxy server so</font>

108
00:07:24,039 --> 00:07:29,020
after the attacker become the proxy

109
00:07:25,840 --> 00:07:35,679
server<font color="#E5E5E5"> the attacker can insert</font><font color="#CCCCCC"> any HTML</font>

110
00:07:29,020 --> 00:07:38,620
<font color="#E5E5E5">tags in the HTTP response</font><font color="#CCCCCC"> ok please on</font>

111
00:07:35,680 --> 00:07:41,889
this<font color="#CCCCCC"> knowledgebase</font><font color="#E5E5E5"> acknowledges let's</font>

112
00:07:38,620 --> 00:07:46,270
see a typical<font color="#E5E5E5"> until merrily attack what</font>

113
00:07:41,889 --> 00:07:49,030
does this look like first the attacker

114
00:07:46,270 --> 00:07:52,750
wants to<font color="#CCCCCC"> login to the server</font><font color="#E5E5E5"> as Adam as</font>

115
00:07:49,030 --> 00:07:56,559
victim but<font color="#E5E5E5"> the attacker doesn't know the</font>

116
00:07:52,750 --> 00:07:58,930
<font color="#E5E5E5">victims passwords so the the server</font>

117
00:07:56,560 --> 00:08:04,810
denies the logging<font color="#E5E5E5"> of the attacker and</font>

118
00:07:58,930 --> 00:08:09,789
<font color="#CCCCCC">the attacker ways until the victim want</font>

119
00:08:04,810 --> 00:08:12,449
to access example example.com<font color="#E5E5E5"> and it</font>

120
00:08:09,789 --> 00:08:16,289
will check the de loop ID first

121
00:08:12,449 --> 00:08:21,069
so the victim asks who<font color="#CCCCCC"> is the</font><font color="#E5E5E5"> VAD and</font>

122
00:08:16,289 --> 00:08:25,779
<font color="#E5E5E5">the attacker can give a fig response and</font>

123
00:08:21,069 --> 00:08:29,590
it<font color="#E5E5E5"> says I'm</font><font color="#CCCCCC"> wwp ID you</font><font color="#E5E5E5"> can get pizza</font>

124
00:08:25,779 --> 00:08:33,099
file from me<font color="#E5E5E5"> and the</font><font color="#CCCCCC"> PACA file says the</font>

125
00:08:29,590 --> 00:08:36,250
attacker<font color="#E5E5E5"> is also the proxy server so the</font>

126
00:08:33,099 --> 00:08:40,740
victim believes that the attacker is the

127
00:08:36,250 --> 00:08:44,140
proxy<font color="#E5E5E5"> server and it asked us the</font>

128
00:08:40,740 --> 00:08:49,810
attacker for the response of<font color="#E5E5E5"> example</font>

129
00:08:44,140 --> 00:08:54,490
calm and the attacker just<font color="#E5E5E5"> hijacks</font><font color="#CCCCCC"> the</font>

130
00:08:49,810 --> 00:08:58,060
response and inject<font color="#E5E5E5"> and here we upload</font>

131
00:08:54,490 --> 00:09:00,670
this tag this<font color="#CCCCCC"> evil image tag is</font><font color="#E5E5E5"> the</font>

132
00:08:58,060 --> 00:09:05,829
sauce plans to the<font color="#CCCCCC"> attacker</font><font color="#E5E5E5"> semi sour</font>

133
00:09:00,670 --> 00:09:08,890
and after the<font color="#CCCCCC"> WIC team passes the</font>

134
00:09:05,830 --> 00:09:13,000
response<font color="#CCCCCC"> we are</font><font color="#E5E5E5"> launched a request</font><font color="#CCCCCC"> to</font>

135
00:09:08,890 --> 00:09:15,310
<font color="#E5E5E5">the attackers at</font><font color="#CCCCCC"> NBS our yeah as the</font>

136
00:09:13,000 --> 00:09:18,340
whiff team and the attacker<font color="#E5E5E5"> are in the</font>

137
00:09:15,310 --> 00:09:23,709
same<font color="#E5E5E5"> Internet the</font><font color="#CCCCCC"> WIC team we all send</font>

138
00:09:18,340 --> 00:09:26,740
<font color="#CCCCCC">is credentials automatically and the WIC</font>

139
00:09:23,710 --> 00:09:30,700
team will<font color="#E5E5E5"> perform the three three step</font>

140
00:09:26,740 --> 00:09:33,520
loss login first<font color="#E5E5E5"> the WIC team will send</font>

141
00:09:30,700 --> 00:09:34,680
<font color="#E5E5E5">the type of a message for negotiation to</font>

142
00:09:33,520 --> 00:09:38,260
the attacker

143
00:09:34,680 --> 00:09:41,589
<font color="#E5E5E5">after the attacker receives the</font><font color="#CCCCCC"> table</font>

144
00:09:38,260 --> 00:09:47,290
message it<font color="#E5E5E5"> just force the</font><font color="#CCCCCC"> Tiwa message</font>

145
00:09:41,590 --> 00:09:52,030
to the server and the server responds

146
00:09:47,290 --> 00:09:56,230
<font color="#CCCCCC">with a challenge to the attacker</font><font color="#E5E5E5"> and the</font>

147
00:09:52,030 --> 00:10:01,630
attacker just<font color="#E5E5E5"> relays the challenge to</font>

148
00:09:56,230 --> 00:10:04,690
<font color="#E5E5E5">the victim and the with team calculus</font>

149
00:10:01,630 --> 00:10:07,810
the challenge response<font color="#E5E5E5"> and sin to the</font>

150
00:10:04,690 --> 00:10:13,270
attacker the attacker<font color="#E5E5E5"> just forward this</font>

151
00:10:07,810 --> 00:10:15,760
challenge response to this<font color="#CCCCCC"> hour so the</font>

152
00:10:13,270 --> 00:10:18,370
victim<font color="#E5E5E5"> believes the attacker is the</font>

153
00:10:15,760 --> 00:10:23,470
server and the server believes the

154
00:10:18,370 --> 00:10:27,210
attacker is the victim so the attacker

155
00:10:23,470 --> 00:10:30,610
can<font color="#CCCCCC"> login to the server successfully</font><font color="#E5E5E5"> and</font>

156
00:10:27,210 --> 00:10:33,910
I know what for the with him<font color="#E5E5E5"> it past can</font>

157
00:10:30,610 --> 00:10:37,570
send any response to<font color="#CCCCCC"> the victim just cut</font>

158
00:10:33,910 --> 00:10:41,130
off<font color="#E5E5E5"> the connection so the attacker can</font>

159
00:10:37,570 --> 00:10:44,080
<font color="#CCCCCC">log into</font><font color="#E5E5E5"> the server as victim and</font>

160
00:10:41,130 --> 00:10:48,730
sometimes the victim and the server<font color="#E5E5E5"> is</font>

161
00:10:44,080 --> 00:10:52,210
<font color="#E5E5E5">the</font><font color="#CCCCCC"> same machine this</font><font color="#E5E5E5"> the victim since</font>

162
00:10:48,730 --> 00:10:54,370
the credentials<font color="#E5E5E5"> for one protocol and the</font>

163
00:10:52,210 --> 00:10:56,580
attacker will release the<font color="#E5E5E5"> credentials to</font>

164
00:10:54,370 --> 00:11:01,510
<font color="#CCCCCC">back to</font><font color="#E5E5E5"> the victims</font>

165
00:10:56,580 --> 00:11:05,230
yeah<font color="#E5E5E5"> and they may be the summation</font>

166
00:11:01,510 --> 00:11:08,550
unless you some real-world attacks the

167
00:11:05,230 --> 00:11:11,920
<font color="#E5E5E5">first one is called FMB reflect attack</font>

168
00:11:08,550 --> 00:11:17,170
when the<font color="#CCCCCC"> weak team access</font><font color="#E5E5E5"> a UNC path or</font>

169
00:11:11,920 --> 00:11:19,479
of our protocol<font color="#CCCCCC"> just like this and the</font>

170
00:11:17,170 --> 00:11:23,560
weak team we<font color="#CCCCCC"> are since is Crenshaw's</font>

171
00:11:19,480 --> 00:11:26,100
automatically the attacker<font color="#E5E5E5"> contrasted</font>

172
00:11:23,560 --> 00:11:30,670
reflects the<font color="#E5E5E5"> clinic</font><font color="#CCCCCC"> chose to</font><font color="#E5E5E5"> the victims</font>

173
00:11:26,100 --> 00:11:36,540
<font color="#CCCCCC">MB server</font><font color="#E5E5E5"> and the attacker can achieve</font>

174
00:11:30,670 --> 00:11:41,050
<font color="#CCCCCC">rcee why are starting a service and this</font>

175
00:11:36,540 --> 00:11:43,990
attack can be performed easily and the

176
00:11:41,050 --> 00:11:47,530
<font color="#E5E5E5">Microsoft released a patch called MS</font>

177
00:11:43,990 --> 00:11:51,880
zero eight zero six eight and in this

178
00:11:47,530 --> 00:11:58,000
patch<font color="#E5E5E5"> it stopped at</font><font color="#CCCCCC"> MB to</font><font color="#E5E5E5"> SMB relay on</font>

179
00:11:51,880 --> 00:12:01,120
the same machine and years<font color="#E5E5E5"> later there</font>

180
00:11:58,000 --> 00:12:04,270
comes another exploit called hot potato

181
00:12:01,120 --> 00:12:09,970
and this implore this exploit works on

182
00:12:04,270 --> 00:12:12,760
Windows<font color="#CCCCCC"> 7 this</font><font color="#E5E5E5"> employed for a start a</font>

183
00:12:09,970 --> 00:12:17,580
web server on<font color="#E5E5E5"> the local host and</font><font color="#CCCCCC"> bans on</font>

184
00:12:12,760 --> 00:12:20,410
port 80<font color="#E5E5E5"> and it will hijack wpad and</font>

185
00:12:17,580 --> 00:12:25,180
redirect<font color="#CCCCCC"> to Windows Defender</font><font color="#E5E5E5"> updates to</font>

186
00:12:20,410 --> 00:12:31,089
the web server the web server will<font color="#E5E5E5"> ask</font>

187
00:12:25,180 --> 00:12:34,209
for<font color="#E5E5E5"> 4:01 ntlm authentication and we all</font>

188
00:12:31,090 --> 00:12:38,560
relate the credentials<font color="#E5E5E5"> to</font><font color="#CCCCCC"> the local SME</font>

189
00:12:34,210 --> 00:12:45,550
server so the hot potato<font color="#CCCCCC"> is</font><font color="#E5E5E5"> Floyd can</font>

190
00:12:38,560 --> 00:12:49,329
log into local SMB<font color="#E5E5E5"> as system so this</font>

191
00:12:45,550 --> 00:12:56,140
this is<font color="#CCCCCC"> Floyd can be used as a privilege</font>

192
00:12:49,330 --> 00:12:59,710
allocation and it use release crazy

193
00:12:56,140 --> 00:13:05,230
shots from<font color="#E5E5E5"> a TDP to the</font><font color="#CCCCCC"> at MB on the</font>

194
00:12:59,710 --> 00:13:07,960
same machine<font color="#E5E5E5"> and Microsoft released</font>

195
00:13:05,230 --> 00:13:12,790
another patch called<font color="#E5E5E5"> MS one six zero</font>

196
00:13:07,960 --> 00:13:15,279
<font color="#E5E5E5">seven five in this patch the fixed relay</font>

197
00:13:12,790 --> 00:13:19,149
credentials from<font color="#E5E5E5"> a local ad TDP</font>

198
00:13:15,279 --> 00:13:21,459
<font color="#CCCCCC">- look our item is over so there comes</font>

199
00:13:19,149 --> 00:13:27,370
to<font color="#E5E5E5"> the question is Cynthia I'm really</font>

200
00:13:21,459 --> 00:13:30,128
that here the answer is no we<font color="#CCCCCC"> can still</font>

201
00:13:27,370 --> 00:13:35,230
release<font color="#E5E5E5"> create credentials to another</font>

202
00:13:30,129 --> 00:13:38,589
<font color="#E5E5E5">merchant we can relay from FMB to</font>

203
00:13:35,230 --> 00:13:41,379
<font color="#CCCCCC">Microsoft Exchange server because</font>

204
00:13:38,589 --> 00:13:45,129
<font color="#E5E5E5">Exchange</font><font color="#CCCCCC"> Server is</font><font color="#E5E5E5"> exchange web so</font><font color="#CCCCCC"> it's</font>

205
00:13:41,379 --> 00:13:48,639
<font color="#E5E5E5">suppose ntlm authentication and there</font>

206
00:13:45,129 --> 00:13:53,949
are many useful web api s<font color="#E5E5E5"> and we can</font>

207
00:13:48,639 --> 00:13:57,910
even<font color="#CCCCCC"> achieve RCE</font><font color="#E5E5E5"> wire a one a ball or to</font>

208
00:13:53,949 --> 00:14:00,910
look client<font color="#E5E5E5"> so if you have a warrant</font><font color="#CCCCCC"> or</font>

209
00:13:57,910 --> 00:14:03,699
<font color="#E5E5E5">to look you may be attacked your</font>

210
00:14:00,910 --> 00:14:07,029
computer<font color="#E5E5E5"> may become may be compromised</font>

211
00:14:03,699 --> 00:14:13,479
and<font color="#CCCCCC"> we can still really item be to</font>

212
00:14:07,029 --> 00:14:17,459
another<font color="#CCCCCC"> machines EMB</font><font color="#E5E5E5"> as long as the two</font>

213
00:14:13,480 --> 00:14:22,839
<font color="#E5E5E5">machines share the same credentials and</font>

214
00:14:17,459 --> 00:14:26,439
here we have a demo the first<font color="#E5E5E5"> demo we</font>

215
00:14:22,839 --> 00:14:29,920
all relay<font color="#E5E5E5"> credentials to Microsoft</font>

216
00:14:26,439 --> 00:14:33,099
<font color="#E5E5E5">Exchange</font><font color="#CCCCCC"> Server</font><font color="#E5E5E5"> we used these tools here</font>

217
00:14:29,920 --> 00:14:35,709
<font color="#E5E5E5">or responder a responder is used for</font>

218
00:14:33,100 --> 00:14:38,199
spoof<font color="#E5E5E5"> windows name resolution and</font><font color="#CCCCCC"> in</font>

219
00:14:35,709 --> 00:14:40,809
<font color="#CCCCCC">theorem relate to it appears this tool</font>

220
00:14:38,199 --> 00:14:43,599
is used<font color="#CCCCCC"> for relay credentials to</font>

221
00:14:40,809 --> 00:15:01,870
<font color="#CCCCCC">exchange server and we just asked these</font>

222
00:14:43,600 --> 00:15:05,019
<font color="#CCCCCC">two</font><font color="#E5E5E5"> tools and see the video</font><font color="#CCCCCC"> and we</font><font color="#E5E5E5"> will</font>

223
00:15:01,870 --> 00:15:13,170
start this I will check<font color="#E5E5E5"> the</font><font color="#CCCCCC"> outlook</font>

224
00:15:05,019 --> 00:15:16,070
client<font color="#CCCCCC"> it was it works and we will</font>

225
00:15:13,170 --> 00:15:16,069
<font color="#E5E5E5">these two</font><font color="#CCCCCC"> trolls</font>

226
00:15:28,630 --> 00:15:41,040
and the<font color="#CCCCCC"> week team opens chrome</font><font color="#E5E5E5"> just</font>

227
00:15:33,519 --> 00:15:41,040
<font color="#E5E5E5">opens chrome and close it</font>

228
00:15:50,320 --> 00:15:59,130
and after we opened

229
00:15:56,040 --> 00:16:11,009
look again<font color="#E5E5E5"> we can see a calculator is</font>

230
00:15:59,130 --> 00:16:13,740
popped up and another demo about<font color="#CCCCCC"> relay</font>

231
00:16:11,009 --> 00:16:17,870
credentials to another<font color="#E5E5E5"> machine and these</font>

232
00:16:13,740 --> 00:16:21,870
two<font color="#CCCCCC"> machine share the same credential</font>

233
00:16:17,870 --> 00:16:42,899
<font color="#CCCCCC">the windows 7 and windows 10 these two</font>

234
00:16:21,870 --> 00:16:43,769
<font color="#E5E5E5">machine share the same credentials we</font>

235
00:16:42,899 --> 00:16:46,009
also

236
00:16:43,769 --> 00:16:46,009
<font color="#E5E5E5">to us</font>

237
00:17:02,510 --> 00:17:13,670
and user talk<font color="#E5E5E5"> cotton</font><font color="#CCCCCC"> TM really adds and</font>

238
00:17:12,040 --> 00:17:24,460
with

239
00:17:13,670 --> 00:17:30,680
<font color="#E5E5E5">to support and the WIC team access the</font>

240
00:17:24,460 --> 00:17:34,250
attackers<font color="#CCCCCC"> feek</font><font color="#E5E5E5"> semi sour and it will</font>

241
00:17:30,680 --> 00:17:40,640
<font color="#CCCCCC">since the cream</font><font color="#E5E5E5"> sauce</font><font color="#CCCCCC"> and we just relays</font>

242
00:17:34,250 --> 00:17:47,720
<font color="#CCCCCC">it we release it to the</font><font color="#E5E5E5"> Windows 10</font><font color="#CCCCCC"> and</font>

243
00:17:40,640 --> 00:17:51,470
get the ntlm hash and<font color="#CCCCCC"> and we can use the</font>

244
00:17:47,720 --> 00:17:57,050
pass pass the<font color="#E5E5E5"> hash attack and we can</font>

245
00:17:51,470 --> 00:18:01,090
start<font color="#E5E5E5"> a calculator on the Windows</font><font color="#CCCCCC"> 10 or</font>

246
00:17:57,050 --> 00:18:01,090
just copy the entire my heart

247
00:18:32,669 --> 00:18:36,679
<font color="#E5E5E5">pops up the calculator</font>

248
00:18:49,020 --> 00:19:02,040
<font color="#E5E5E5">now is administrator yeah okay</font><font color="#CCCCCC"> afters</font>

249
00:18:58,800 --> 00:19:06,990
<font color="#CCCCCC">two demos</font><font color="#E5E5E5"> people may ask</font><font color="#CCCCCC"> we had to</font><font color="#E5E5E5"> get a</font>

250
00:19:02,040 --> 00:19:09,750
SME request we can<font color="#E5E5E5"> get a SME request</font>

251
00:19:06,990 --> 00:19:13,260
from the browser<font color="#E5E5E5"> from the word from the</font>

252
00:19:09,750 --> 00:19:18,060
PDF from<font color="#CCCCCC"> the</font><font color="#E5E5E5"> Explorer and the most</font>

253
00:19:13,260 --> 00:19:22,170
common one is<font color="#CCCCCC"> the Barossa</font><font color="#E5E5E5"> and here is a</font>

254
00:19:18,060 --> 00:19:28,110
table<font color="#E5E5E5"> that shows the the modern</font><font color="#CCCCCC"> process</font>

255
00:19:22,170 --> 00:19:32,490
<font color="#E5E5E5">whether this</font><font color="#CCCCCC"> was durability or</font><font color="#E5E5E5"> RMB from</font>

256
00:19:28,110 --> 00:19:37,340
the people we can see only<font color="#CCCCCC"> IE on</font><font color="#E5E5E5"> Windows</font>

257
00:19:32,490 --> 00:19:41,040
<font color="#E5E5E5">7 and chrome suppose wpad</font>

258
00:19:37,340 --> 00:19:48,419
which means the<font color="#CCCCCC"> attacker can be the Evo</font>

259
00:19:41,040 --> 00:19:56,120
proxy server<font color="#E5E5E5"> in these two process and we</font>

260
00:19:48,420 --> 00:20:00,510
<font color="#E5E5E5">can say chrome blocks the</font><font color="#CCCCCC"> SMB excels so</font>

261
00:19:56,120 --> 00:20:03,479
when we access a<font color="#CCCCCC"> dtdv</font><font color="#E5E5E5"> web pages it</font>

262
00:20:00,510 --> 00:20:08,600
cannot send the credentials

263
00:20:03,480 --> 00:20:13,410
odd automatically because it blocks it

264
00:20:08,600 --> 00:20:15,899
so we cannot attack<font color="#E5E5E5"> IE or edge and</font>

265
00:20:13,410 --> 00:20:19,230
windows<font color="#CCCCCC"> then</font><font color="#E5E5E5"> remotely without the user</font>

266
00:20:15,900 --> 00:20:22,500
<font color="#E5E5E5">interaction because the week the</font>

267
00:20:19,230 --> 00:20:26,760
attacker cannot be proxy server<font color="#E5E5E5"> and he</font>

268
00:20:22,500 --> 00:20:30,450
cannot insert a<font color="#CCCCCC"> new attack so if you</font>

269
00:20:26,760 --> 00:20:33,950
want to<font color="#CCCCCC"> attack</font><font color="#E5E5E5"> these</font><font color="#CCCCCC"> two bruises the</font>

270
00:20:30,450 --> 00:20:38,850
<font color="#CCCCCC">weak team needs to bruise attackers page</font>

271
00:20:33,950 --> 00:20:43,530
and we cannot attack<font color="#E5E5E5"> chrome remotely</font>

272
00:20:38,850 --> 00:20:47,310
<font color="#E5E5E5">because chrome blocks requests to the</font>

273
00:20:43,530 --> 00:20:52,800
FME server<font color="#E5E5E5"> because we are not allowed to</font>

274
00:20:47,310 --> 00:20:56,490
<font color="#CCCCCC">load loca Rico's local resource</font><font color="#E5E5E5"> and we</font>

275
00:20:52,800 --> 00:20:59,250
cannot reflect<font color="#E5E5E5"> credentials to</font><font color="#CCCCCC"> Adam be</font><font color="#E5E5E5"> on</font>

276
00:20:56,490 --> 00:21:02,480
the same machine<font color="#CCCCCC"> because of these two</font>

277
00:20:59,250 --> 00:21:05,090
parties so let's talk

278
00:21:02,480 --> 00:21:08,919
this question again<font color="#E5E5E5"> is sincere I'm</font>

279
00:21:05,090 --> 00:21:16,580
really that the answer<font color="#E5E5E5"> is almost and</font>

280
00:21:08,919 --> 00:21:19,040
<font color="#CCCCCC">auntie I'm really miss rebirth</font><font color="#E5E5E5"> okay just</font>

281
00:21:16,580 --> 00:21:21,649
now<font color="#E5E5E5"> my main has gave us an introduction</font>

282
00:21:19,040 --> 00:21:26,740
to<font color="#E5E5E5"> the railroads way of using an</font><font color="#CCCCCC"> indium</font>

283
00:21:21,650 --> 00:21:26,740
relate attack we<font color="#E5E5E5"> can all say well it</font>

284
00:21:27,190 --> 00:21:31,460
Microsoft has also<font color="#CCCCCC"> provide many patches</font>

285
00:21:30,380 --> 00:21:34,309
to against it

286
00:21:31,460 --> 00:21:36,590
so the indium relay attacks<font color="#E5E5E5"> really that</font>

287
00:21:34,309 --> 00:21:42,168
after our research we brought new hope

288
00:21:36,590 --> 00:21:45,500
<font color="#E5E5E5">to this time patient as mentioned</font>

289
00:21:42,169 --> 00:21:48,799
earlier<font color="#CCCCCC"> Thank You MSSP</font><font color="#E5E5E5"> can be used to</font>

290
00:21:45,500 --> 00:21:52,010
complain<font color="#E5E5E5"> and</font><font color="#CCCCCC"> erm authentication for the</font>

291
00:21:48,799 --> 00:21:55,970
various<font color="#CCCCCC"> servers</font><font color="#E5E5E5"> here</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> will</font><font color="#CCCCCC"> introduce</font><font color="#E5E5E5"> in</font>

292
00:21:52,010 --> 00:21:58,100
here<font color="#E5E5E5"> identification based on HTTP now</font>

293
00:21:55,970 --> 00:22:00,650
<font color="#E5E5E5">now that we are talking</font><font color="#CCCCCC"> of talking</font><font color="#E5E5E5"> about</font>

294
00:21:58,100 --> 00:22:04,480
HTTP servers<font color="#E5E5E5"> the</font><font color="#CCCCCC"> professors are</font><font color="#E5E5E5"> at a</font>

295
00:22:00,650 --> 00:22:04,480
peacoat that it has to be a mentioned

296
00:22:05,260 --> 00:22:11,960
<font color="#E5E5E5">virus liberal professor has implemented</font>

297
00:22:08,000 --> 00:22:14,350
<font color="#E5E5E5">a ntlm authentication</font><font color="#CCCCCC"> some service</font><font color="#E5E5E5"> but</font>

298
00:22:11,960 --> 00:22:16,910
they<font color="#E5E5E5"> are also different in</font>

299
00:22:14,350 --> 00:22:19,309
implementation<font color="#E5E5E5"> of</font><font color="#CCCCCC"> the each browser i</font>

300
00:22:16,910 --> 00:22:21,520
will introduce those difference one by

301
00:22:19,309 --> 00:22:21,520
one

302
00:22:22,600 --> 00:22:30,049
<font color="#E5E5E5">okay let's take a look</font><font color="#CCCCCC"> at the what</font><font color="#E5E5E5"> and</font>

303
00:22:26,330 --> 00:22:32,509
<font color="#CCCCCC">here</font><font color="#E5E5E5"> at indication over the HTTP first</font>

304
00:22:30,049 --> 00:22:35,929
the professor exists the<font color="#CCCCCC"> webpage that</font>

305
00:22:32,509 --> 00:22:37,249
<font color="#E5E5E5">need needs Pentium and</font><font color="#CCCCCC"> erm</font><font color="#E5E5E5"> and the</font>

306
00:22:35,929 --> 00:22:40,220
<font color="#E5E5E5">decays indication</font>

307
00:22:37,249 --> 00:22:43,249
after receiving<font color="#E5E5E5"> the request the server</font>

308
00:22:40,220 --> 00:22:46,820
check if the HTTP<font color="#CCCCCC"> hunter contains the</font>

309
00:22:43,249 --> 00:22:51,249
dedication information<font color="#E5E5E5"> if it doesn't it</font>

310
00:22:46,820 --> 00:22:55,189
<font color="#E5E5E5">retains the for one studious code and</font>

311
00:22:51,249 --> 00:22:57,919
<font color="#E5E5E5">top the user that</font><font color="#CCCCCC"> we are not an</font>

312
00:22:55,190 --> 00:23:01,070
<font color="#E5E5E5">Authenticator after the professor</font>

313
00:22:57,919 --> 00:23:06,049
reserved<font color="#E5E5E5"> eat it defends the patch needs</font>

314
00:23:01,070 --> 00:23:09,980
<font color="#CCCCCC">an tiem identification so the professor</font>

315
00:23:06,049 --> 00:23:13,908
we are<font color="#CCCCCC"> take the first step in him and</font>

316
00:23:09,980 --> 00:23:17,480
him<font color="#CCCCCC"> SS Pinochet</font><font color="#E5E5E5"> it is</font><font color="#CCCCCC"> also</font><font color="#E5E5E5"> called have</font>

317
00:23:13,909 --> 00:23:20,720
one message<font color="#E5E5E5"> after</font><font color="#CCCCCC"> the store receiving</font>

318
00:23:17,480 --> 00:23:23,779
the tap one message from the<font color="#E5E5E5"> professor's</font>

319
00:23:20,720 --> 00:23:26,929
it with hands<font color="#CCCCCC"> and he MSSP challenging</font>

320
00:23:23,779 --> 00:23:28,820
<font color="#E5E5E5">it's also called tap to message and when</font>

321
00:23:26,929 --> 00:23:31,639
the professor gets the challenging<font color="#E5E5E5"> it</font>

322
00:23:28,820 --> 00:23:34,340
<font color="#E5E5E5">were</font><font color="#CCCCCC"> harshly with</font><font color="#E5E5E5"> the users credentials</font>

323
00:23:31,639 --> 00:23:36,469
and the generate taps<font color="#E5E5E5"> three message</font>

324
00:23:34,340 --> 00:23:38,749
after the<font color="#E5E5E5"> register we serve the type</font>

325
00:23:36,470 --> 00:23:43,369
<font color="#CCCCCC">three message is we are used the same</font>

326
00:23:38,749 --> 00:23:46,820
same same<font color="#CCCCCC"> month</font><font color="#E5E5E5"> to calculate</font><font color="#CCCCCC"> Hoshi so we</font>

327
00:23:43,369 --> 00:23:50,389
are comparing a hash<font color="#E5E5E5"> comparing the</font>

328
00:23:46,820 --> 00:23:52,460
<font color="#CCCCCC">hashes if it is the same and</font><font color="#E5E5E5"> ham</font>

329
00:23:50,389 --> 00:23:55,508
authentication we are complete and the

330
00:23:52,460 --> 00:23:55,509
resource is returned

331
00:23:55,930 --> 00:24:02,030
so how to send windows credential

332
00:23:59,470 --> 00:24:07,460
credentials<font color="#E5E5E5"> automatically improviser</font>

333
00:24:02,030 --> 00:24:10,430
<font color="#E5E5E5">this is interesting the questions open</font>

334
00:24:07,460 --> 00:24:12,530
the is it is we can<font color="#E5E5E5"> see as follow on the</font>

335
00:24:10,430 --> 00:24:15,230
automatic<font color="#E5E5E5"> lock only</font><font color="#CCCCCC"> in the internet</font>

336
00:24:12,530 --> 00:24:19,220
<font color="#E5E5E5">after</font><font color="#CCCCCC"> our machine is during the auto man</font>

337
00:24:15,230 --> 00:24:24,650
<font color="#CCCCCC">will access when ie</font><font color="#E5E5E5"> access a non fqdn</font>

338
00:24:19,220 --> 00:24:27,680
hostname you will make it<font color="#CCCCCC"> TS</font><font color="#E5E5E5"> TS query is</font>

339
00:24:24,650 --> 00:24:30,440
first for<font color="#E5E5E5"> example if the domain name is</font>

340
00:24:27,680 --> 00:24:34,000
the<font color="#E5E5E5"> transient</font><font color="#CCCCCC"> on calm and the hostname</font>

341
00:24:30,440 --> 00:24:38,780
<font color="#CCCCCC">is the</font><font color="#E5E5E5"> first hour</font>

342
00:24:34,000 --> 00:24:42,680
yes require we are what is<font color="#E5E5E5"> the fair so</font>

343
00:24:38,780 --> 00:24:47,120
first our<font color="#CCCCCC"> tones tension don't come at</font>

344
00:24:42,680 --> 00:24:49,040
the address if the<font color="#E5E5E5"> HTTP port of this</font>

345
00:24:47,120 --> 00:24:51,169
house is a<font color="#CCCCCC"> qiyam</font>

346
00:24:49,040 --> 00:24:55,820
authentication it will also be

347
00:24:51,170 --> 00:24:59,500
automatically and educated them so if

348
00:24:55,820 --> 00:25:03,250
they enjoy<font color="#E5E5E5"> so if so when is is</font><font color="#CCCCCC"> they</font>

349
00:24:59,500 --> 00:25:04,490
sorry<font color="#E5E5E5"> is the internet environment</font>

350
00:25:03,250 --> 00:25:06,950
<font color="#E5E5E5">windows</font>

351
00:25:04,490 --> 00:25:11,290
suppose the some ways to<font color="#E5E5E5"> check the</font>

352
00:25:06,950 --> 00:25:11,290
weather at the<font color="#CCCCCC"> UI are is a internet zone</font>

353
00:25:12,350 --> 00:25:19,709
there are two API<font color="#E5E5E5"> help us to determine</font>

354
00:25:16,650 --> 00:25:21,780
<font color="#E5E5E5">state whether the URL is</font><font color="#CCCCCC"> Internet</font><font color="#E5E5E5"> the</font>

355
00:25:19,710 --> 00:25:24,180
first<font color="#CCCCCC"> error is the process you are</font>

356
00:25:21,780 --> 00:25:34,889
action<font color="#E5E5E5"> and the other</font><font color="#CCCCCC"> one is the map you</font>

357
00:25:24,180 --> 00:25:39,720
are<font color="#CCCCCC"> two</font><font color="#E5E5E5"> zone so what is about the policy</font>

358
00:25:34,890 --> 00:25:42,570
<font color="#E5E5E5">and the zone there are many types policy</font>

359
00:25:39,720 --> 00:25:46,140
has been provided by<font color="#CCCCCC"> the Microsoft but</font>

360
00:25:42,570 --> 00:25:49,070
now I will mention the<font color="#E5E5E5"> two and here the</font>

361
00:25:46,140 --> 00:25:51,990
first one<font color="#E5E5E5"> is the URL policy credentials</font>

362
00:25:49,070 --> 00:25:55,050
<font color="#E5E5E5">challenge logging</font><font color="#CCCCCC"> ok</font><font color="#E5E5E5"> another one is the</font>

363
00:25:51,990 --> 00:26:00,660
USA<font color="#E5E5E5"> URL policy credentials must approach</font>

364
00:25:55,050 --> 00:26:03,240
users<font color="#CCCCCC"> the</font><font color="#E5E5E5"> second wonder which means prod</font>

365
00:26:00,660 --> 00:26:06,150
the user to enter<font color="#E5E5E5"> the username and the</font>

366
00:26:03,240 --> 00:26:09,530
<font color="#CCCCCC">password</font><font color="#E5E5E5"> generally in the second</font>

367
00:26:06,150 --> 00:26:12,450
apologies the<font color="#CCCCCC"> weather the user really</font>

368
00:26:09,530 --> 00:26:14,639
should really to be remanded by the

369
00:26:12,450 --> 00:26:19,230
patent<font color="#E5E5E5"> box depends on the value of the</font>

370
00:26:14,640 --> 00:26:21,840
zone looking at this table<font color="#E5E5E5"> unless the at</font>

371
00:26:19,230 --> 00:26:24,270
least the different means<font color="#CCCCCC"> repeat</font>

372
00:26:21,840 --> 00:26:26,399
<font color="#CCCCCC">represented by the different</font><font color="#E5E5E5"> values and</font>

373
00:26:24,270 --> 00:26:30,570
<font color="#E5E5E5">the rather to user the user would</font>

374
00:26:26,400 --> 00:26:34,260
automatically<font color="#CCCCCC"> login for</font><font color="#E5E5E5"> example if you</font>

375
00:26:30,570 --> 00:26:37,080
<font color="#CCCCCC">enter URL</font><font color="#E5E5E5"> the policy is URL credentials</font>

376
00:26:34,260 --> 00:26:42,530
<font color="#E5E5E5">master prompt user</font><font color="#CCCCCC"> but the song value is</font>

377
00:26:37,080 --> 00:26:42,530
<font color="#CCCCCC">1 which</font><font color="#E5E5E5"> also automatically locks in</font>

378
00:26:45,050 --> 00:26:49,759
based on the<font color="#E5E5E5"> two</font>

379
00:26:46,669 --> 00:26:53,960
api's we around a program for testing

380
00:26:49,759 --> 00:26:57,950
and fun different features on the on the

381
00:26:53,960 --> 00:27:00,739
Windows<font color="#E5E5E5"> 7 and Windows 10 the network</font>

382
00:26:57,950 --> 00:27:03,799
environment with<font color="#E5E5E5"> tester on working group</font>

383
00:27:00,739 --> 00:27:05,929
environment<font color="#E5E5E5"> why would we choose the</font>

384
00:27:03,799 --> 00:27:09,559
<font color="#E5E5E5">working group environment because</font><font color="#CCCCCC"> you</font>

385
00:27:05,929 --> 00:27:11,690
<font color="#CCCCCC">know enterprise</font><font color="#E5E5E5"> because in your</font>

386
00:27:09,559 --> 00:27:14,059
enterprise intranet<font color="#E5E5E5"> there are generally</font>

387
00:27:11,690 --> 00:27:16,519
two<font color="#CCCCCC"> environments</font><font color="#E5E5E5"> one is the working</font>

388
00:27:14,059 --> 00:27:21,019
group environment<font color="#E5E5E5"> and another one is the</font>

389
00:27:16,519 --> 00:27:24,399
domain environment<font color="#E5E5E5"> when the professor's</font>

390
00:27:21,019 --> 00:27:27,440
<font color="#E5E5E5">encounter the hostname</font><font color="#CCCCCC"> tab addressed in</font>

391
00:27:24,399 --> 00:27:30,049
domain environment is automatically

392
00:27:27,440 --> 00:27:34,820
erase the current domain name to the

393
00:27:30,049 --> 00:27:37,639
<font color="#CCCCCC">hostname and and its determines the or</font>

394
00:27:34,820 --> 00:27:40,039
no fqdn<font color="#CCCCCC"> tabs addressed as a local</font>

395
00:27:37,639 --> 00:27:41,899
internet zone<font color="#E5E5E5"> because the domain</font>

396
00:27:40,039 --> 00:27:44,929
<font color="#E5E5E5">environment is the chassis</font><font color="#CCCCCC"> the chassis</font>

397
00:27:41,899 --> 00:27:48,289
the<font color="#E5E5E5"> environment but it's not a</font><font color="#CCCCCC"> same-day</font>

398
00:27:44,929 --> 00:27:51,289
<font color="#CCCCCC">palace number is not</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> same in the</font>

399
00:27:48,289 --> 00:27:57,109
working group environment which is less

400
00:27:51,289 --> 00:28:01,970
secure environment so we can see this

401
00:27:57,109 --> 00:28:05,029
table<font color="#E5E5E5"> if you on Windows 10 you would</font>

402
00:28:01,970 --> 00:28:09,100
have<font color="#CCCCCC"> two windows telling the URL the</font>

403
00:28:05,029 --> 00:28:12,409
policy will be URL policy credentials

404
00:28:09,100 --> 00:28:16,369
credentials conditional format and the

405
00:28:12,409 --> 00:28:26,490
<font color="#E5E5E5">song value is</font><font color="#CCCCCC"> 1 but in Windows Windows 7</font>

406
00:28:16,369 --> 00:28:29,799
the value is the<font color="#CCCCCC"> 3cr difference so</font>

407
00:28:26,490 --> 00:28:34,720
the professor how to implement this

408
00:28:29,799 --> 00:28:37,539
feature<font color="#E5E5E5"> and the groom and the Firefox</font>

409
00:28:34,720 --> 00:28:40,090
both used a function come they can use

410
00:28:37,539 --> 00:28:44,730
default correlations which the function

411
00:28:40,090 --> 00:28:47,830
<font color="#E5E5E5">returns</font><font color="#CCCCCC"> to they are automatically</font><font color="#E5E5E5"> logged</font>

412
00:28:44,730 --> 00:28:50,080
<font color="#E5E5E5">when they return in first the user is</font>

413
00:28:47,830 --> 00:28:50,908
<font color="#E5E5E5">remanded to enter the username and</font><font color="#CCCCCC"> the</font>

414
00:28:50,080 --> 00:28:54,189
<font color="#E5E5E5">password</font>

415
00:28:50,909 --> 00:28:57,730
<font color="#E5E5E5">magic room is respecting the internet</font>

416
00:28:54,190 --> 00:29:02,370
<font color="#E5E5E5">explorer</font><font color="#CCCCCC"> setting but also</font><font color="#E5E5E5"> but the</font>

417
00:28:57,730 --> 00:29:06,429
<font color="#E5E5E5">Firefox is depends on the user setting</font>

418
00:29:02,370 --> 00:29:09,959
if you want to automatic automatically

419
00:29:06,429 --> 00:29:13,120
<font color="#E5E5E5">log in you</font><font color="#CCCCCC"> need</font><font color="#E5E5E5"> to you need o open the</font>

420
00:29:09,960 --> 00:29:15,539
about config and<font color="#E5E5E5"> then</font><font color="#CCCCCC"> set this value</font><font color="#E5E5E5"> to</font>

421
00:29:13,120 --> 00:29:15,539
<font color="#CCCCCC">2</font>

422
00:29:18,779 --> 00:29:26,169
so now we can do a<font color="#E5E5E5"> check room remotely</font>

423
00:29:23,010 --> 00:29:29,010
because the chrome we are automatically

424
00:29:26,169 --> 00:29:34,090
send the<font color="#E5E5E5"> credential in the</font><font color="#CCCCCC"> internet song</font>

425
00:29:29,010 --> 00:29:37,120
is over<font color="#CCCCCC"> the HTTP</font><font color="#E5E5E5"> another another</font>

426
00:29:34,090 --> 00:29:40,020
interesting is the amazing<font color="#CCCCCC"> a</font><font color="#E5E5E5"> chrome or</font>

427
00:29:37,120 --> 00:29:40,020
<font color="#CCCCCC">Munich</font><font color="#E5E5E5"> box</font>

428
00:29:42,809 --> 00:29:49,480
and then<font color="#E5E5E5"> it has and the it</font><font color="#CCCCCC"> has the</font>

429
00:29:46,660 --> 00:29:52,300
environment is also<font color="#E5E5E5"> in what guru</font>

430
00:29:49,480 --> 00:29:58,330
environment and<font color="#CCCCCC"> a</font><font color="#E5E5E5"> Windows 10 and the</font>

431
00:29:52,300 --> 00:30:01,540
chrome chrome 17 if victims have

432
00:29:58,330 --> 00:30:04,330
anything in common<font color="#E5E5E5"> in box such as today</font>

433
00:30:01,540 --> 00:30:06,639
news<font color="#E5E5E5"> and then the windows were asked who</font>

434
00:30:04,330 --> 00:30:10,210
is today news<font color="#E5E5E5"> throughout the name</font>

435
00:30:06,640 --> 00:30:12,610
resolution<font color="#E5E5E5"> attack can also read by</font>

436
00:30:10,210 --> 00:30:17,590
disproving<font color="#CCCCCC"> I'm the today news</font><font color="#E5E5E5"> and need</font>

437
00:30:12,610 --> 00:30:20,350
you to<font color="#CCCCCC"> company over HTTP and here</font>

438
00:30:17,590 --> 00:30:22,270
identification and then chrome

439
00:30:20,350 --> 00:30:25,629
determines the today news<font color="#E5E5E5"> is an</font><font color="#CCCCCC"> Internet</font>

440
00:30:22,270 --> 00:30:29,020
<font color="#CCCCCC">zone so it will automatically</font><font color="#E5E5E5"> log avid</font>

441
00:30:25,630 --> 00:30:31,960
as the attacker can sometimes the

442
00:30:29,020 --> 00:30:34,530
credentials and<font color="#E5E5E5"> then rely relays due to</font>

443
00:30:31,960 --> 00:30:34,530
the<font color="#E5E5E5"> other machine</font>

444
00:30:36,150 --> 00:30:49,120
so can we rely relay the credentials<font color="#CCCCCC"> to</font>

445
00:30:40,450 --> 00:30:52,920
the<font color="#E5E5E5"> same machine the SM SM</font>

446
00:30:49,120 --> 00:30:56,080
<font color="#E5E5E5">SMB with reflection or</font><font color="#CCCCCC"> texture rebirth</font>

447
00:30:52,920 --> 00:30:58,870
<font color="#CCCCCC">assemble correct credentials</font><font color="#E5E5E5"> reflection</font>

448
00:30:56,080 --> 00:31:01,419
attack was<font color="#E5E5E5"> discovered</font><font color="#CCCCCC"> ten years ten</font>

449
00:30:58,870 --> 00:31:05,080
years ago<font color="#E5E5E5"> and the Mac</font><font color="#CCCCCC"> software fixed in</font>

450
00:31:01,420 --> 00:31:13,410
<font color="#E5E5E5">within the MSF</font><font color="#CCCCCC"> or zero eight zero six</font>

451
00:31:05,080 --> 00:31:18,120
eight patch<font color="#E5E5E5"> King in 2000</font>

452
00:31:13,410 --> 00:31:22,140
tada mm f-14a<font color="#CCCCCC"> James photo put forward</font>

453
00:31:18,120 --> 00:31:25,679
<font color="#E5E5E5">across protect and</font><font color="#CCCCCC"> hem and grm relay</font>

454
00:31:22,140 --> 00:31:27,900
attack<font color="#E5E5E5"> what</font><font color="#CCCCCC"> a Murray what I'm</font><font color="#E5E5E5"> introduce</font>

455
00:31:25,680 --> 00:31:30,420
today<font color="#CCCCCC"> is they use the same of the future</font>

456
00:31:27,900 --> 00:31:33,330
<font color="#E5E5E5">of the Chara</font><font color="#CCCCCC"> to complex this</font><font color="#E5E5E5"> attack</font>

457
00:31:30,420 --> 00:31:36,380
<font color="#E5E5E5">James</font><font color="#CCCCCC"> funk that's the way attack are</font>

458
00:31:33,330 --> 00:31:41,909
used for local privilege escalation and

459
00:31:36,380 --> 00:31:44,010
always<font color="#E5E5E5"> can do</font><font color="#CCCCCC"> sae the operation is</font>

460
00:31:41,910 --> 00:31:48,180
divided into<font color="#E5E5E5"> the following five steps</font>

461
00:31:44,010 --> 00:31:51,360
<font color="#E5E5E5">the first one is using attack the victim</font>

462
00:31:48,180 --> 00:31:54,240
uses the java application to access the

463
00:31:51,360 --> 00:31:57,600
<font color="#E5E5E5">webpage which needs and</font><font color="#CCCCCC"> IAM and here m</font>

464
00:31:54,240 --> 00:32:00,000
identification<font color="#E5E5E5"> and then the attacker can</font>

465
00:31:57,600 --> 00:32:06,060
<font color="#E5E5E5">study stay in the net and yamaha she</font>

466
00:32:00,000 --> 00:32:09,660
from<font color="#E5E5E5"> the</font><font color="#CCCCCC"> weak team after after studying</font>

467
00:32:06,060 --> 00:32:13,620
<font color="#E5E5E5">the and him Ned and him</font><font color="#CCCCCC"> Hoshi</font><font color="#E5E5E5"> attack</font>

468
00:32:09,660 --> 00:32:17,610
<font color="#E5E5E5">reflect reflect a and here net and him</font>

469
00:32:13,620 --> 00:32:21,989
<font color="#CCCCCC">Hoshi to the Ripton symbol servers</font><font color="#E5E5E5"> now</font>

470
00:32:17,610 --> 00:32:25,139
it's the same machine because they ng

471
00:32:21,990 --> 00:32:29,730
net and him<font color="#CCCCCC"> Hoshi from the victim so</font>

472
00:32:25,140 --> 00:32:34,020
they and he net and him<font color="#CCCCCC"> Hoshi is</font><font color="#E5E5E5"> correct</font>

473
00:32:29,730 --> 00:32:39,900
<font color="#CCCCCC">describe and then the identification</font>

474
00:32:34,020 --> 00:32:42,840
<font color="#E5E5E5">will be successfully</font><font color="#CCCCCC"> lost</font><font color="#E5E5E5"> the attacker</font>

475
00:32:39,900 --> 00:32:51,060
can attack can do<font color="#E5E5E5"> sae while studying or</font>

476
00:32:42,840 --> 00:32:54,770
remote<font color="#E5E5E5"> services wink</font><font color="#CCCCCC"> enjoy</font><font color="#E5E5E5"> was an HTTP</font>

477
00:32:51,060 --> 00:32:59,909
request<font color="#CCCCCC"> when a java application</font><font color="#E5E5E5"> has</font><font color="#CCCCCC"> the</font>

478
00:32:54,770 --> 00:33:03,810
SSRIs or<font color="#E5E5E5"> XX</font><font color="#CCCCCC"> e1</font><font color="#E5E5E5"> ability it</font><font color="#CCCCCC"> can issue HTTP</font>

479
00:32:59,910 --> 00:33:06,510
<font color="#CCCCCC">request</font><font color="#E5E5E5"> in the SSL vulnerability only</font>

480
00:33:03,810 --> 00:33:11,240
HTTP<font color="#E5E5E5"> requires certain</font><font color="#CCCCCC"> through the</font><font color="#E5E5E5"> jdk</font>

481
00:33:06,510 --> 00:33:11,240
build class<font color="#E5E5E5"> lambda HTTP URL connection</font>

482
00:33:11,540 --> 00:33:21,450
<font color="#CCCCCC">they</font><font color="#E5E5E5"> are automatically company the net</font>

483
00:33:15,690 --> 00:33:24,450
and IAM at<font color="#E5E5E5"> ntlm authentication when</font>

484
00:33:21,450 --> 00:33:28,249
exploding exploding the

485
00:33:24,450 --> 00:33:33,379
xme<font color="#CCCCCC"> one ability</font><font color="#E5E5E5"> you can defend the</font>

486
00:33:28,249 --> 00:33:38,399
<font color="#E5E5E5">integrity to poach the you are a URI and</font>

487
00:33:33,379 --> 00:33:40,259
the<font color="#CCCCCC"> XML professor</font><font color="#E5E5E5"> will choose the way of</font>

488
00:33:38,399 --> 00:33:43,949
connection according to the protocol<font color="#E5E5E5"> and</font>

489
00:33:40,259 --> 00:33:49,230
will automatically use HTTP URL

490
00:33:43,950 --> 00:33:52,980
connection to send HTTP<font color="#E5E5E5"> requests throat</font>

491
00:33:49,230 --> 00:34:01,980
sauce to attack her surface<font color="#E5E5E5"> we can get</font>

492
00:33:52,980 --> 00:34:05,359
net and here<font color="#E5E5E5"> mihashi so where the</font><font color="#CCCCCC"> Java</font>

493
00:34:01,980 --> 00:34:09,240
can automatically indium identification

494
00:34:05,359 --> 00:34:11,969
when<font color="#E5E5E5"> the request is sent by the HTTP URL</font>

495
00:34:09,239 --> 00:34:17,098
connection to request is actually<font color="#E5E5E5"> stand</font>

496
00:34:11,969 --> 00:34:19,799
out while<font color="#E5E5E5"> they write</font><font color="#CCCCCC"> request</font><font color="#E5E5E5"> and then</font>

497
00:34:17,099 --> 00:34:21,710
the user returns<font color="#E5E5E5"> therefore</font><font color="#CCCCCC"> well as</font>

498
00:34:19,799 --> 00:34:25,230
indicating after receiving the request

499
00:34:21,710 --> 00:34:30,119
the<font color="#CCCCCC"> service</font><font color="#E5E5E5"> request a process doesn't</font>

500
00:34:25,230 --> 00:34:33,960
<font color="#E5E5E5">the end some function in the HTTP URL</font>

501
00:34:30,119 --> 00:34:37,109
connection<font color="#CCCCCC"> fentons a server needs</font><font color="#E5E5E5"> ntlm</font>

502
00:34:33,960 --> 00:34:40,490
authentication and then either<font color="#CCCCCC"> way are</font>

503
00:34:37,109 --> 00:34:43,069
<font color="#CCCCCC">called a carer server authentication</font>

504
00:34:40,489 --> 00:34:46,049
function and is retained a

505
00:34:43,069 --> 00:34:49,469
authentication object which contains<font color="#E5E5E5"> the</font>

506
00:34:46,049 --> 00:34:52,349
authentication information they<font color="#E5E5E5"> are very</font>

507
00:34:49,469 --> 00:34:55,980
important<font color="#CCCCCC"> field in this cattle server</font>

508
00:34:52,349 --> 00:34:59,359
authentication carousel at indication

509
00:34:55,980 --> 00:35:06,540
function<font color="#E5E5E5"> this field is</font><font color="#CCCCCC"> the transparent</font>

510
00:34:59,359 --> 00:35:08,759
transparence<font color="#CCCCCC"> and gem server if this</font>

511
00:35:06,540 --> 00:35:11,640
field is<font color="#E5E5E5"> they always choose the username</font>

512
00:35:08,760 --> 00:35:14,569
and<font color="#CCCCCC"> the password will be picked</font><font color="#E5E5E5"> up from</font>

513
00:35:11,640 --> 00:35:17,569
the current log<font color="#E5E5E5"> log on user credentials</font>

514
00:35:14,569 --> 00:35:17,569
<font color="#CCCCCC">automatically</font>

515
00:35:22,270 --> 00:35:30,530
the process of defining a child child

516
00:35:26,500 --> 00:35:31,160
<font color="#CCCCCC">chance parents and him</font><font color="#E5E5E5"> Cyril is</font><font color="#CCCCCC"> 2 step</font>

517
00:35:30,530 --> 00:35:34,870
process

518
00:35:31,160 --> 00:35:39,920
the first step is the<font color="#E5E5E5"> determinant as a</font>

519
00:35:34,870 --> 00:35:44,900
<font color="#CCCCCC">support</font><font color="#E5E5E5"> transparent as in the NTM</font>

520
00:35:39,920 --> 00:35:49,070
<font color="#E5E5E5">authentication process and another one</font>

521
00:35:44,900 --> 00:35:53,120
<font color="#E5E5E5">is</font><font color="#CCCCCC"> the is</font><font color="#E5E5E5"> trusted estate</font><font color="#CCCCCC"> we can see</font><font color="#E5E5E5"> this</font>

522
00:35:49,070 --> 00:35:59,150
code<font color="#E5E5E5"> this function is always retained -</font>

523
00:35:53,120 --> 00:36:04,330
so<font color="#E5E5E5"> they say try transparent</font><font color="#CCCCCC"> antium</font>

524
00:35:59,150 --> 00:36:04,330
server is always true on the windows

525
00:36:09,160 --> 00:36:17,540
so let's took a look at the<font color="#E5E5E5"> process of</font>

526
00:36:12,290 --> 00:36:21,920
SMB credential reflections<font color="#CCCCCC"> attack attack</font>

527
00:36:17,540 --> 00:36:25,190
is the HTTP server that needs<font color="#CCCCCC"> that</font>

528
00:36:21,920 --> 00:36:29,150
requires the<font color="#E5E5E5"> intent occasion and the</font>

529
00:36:25,190 --> 00:36:33,890
victim is<font color="#CCCCCC"> the machine that provide to</font>

530
00:36:29,150 --> 00:36:38,060
SMB<font color="#E5E5E5"> services this can be it can be a</font>

531
00:36:33,890 --> 00:36:41,089
server or<font color="#E5E5E5"> PC because the SMB services is</font>

532
00:36:38,060 --> 00:36:45,170
<font color="#CCCCCC">provided by default on the windows</font><font color="#E5E5E5"> the</font>

533
00:36:41,090 --> 00:36:47,600
victim since<font color="#E5E5E5"> they request</font><font color="#CCCCCC"> the packet as</font>

534
00:36:45,170 --> 00:36:50,930
the show in the<font color="#E5E5E5"> picture which the first</font>

535
00:36:47,600 --> 00:36:53,540
step in the NT authentication<font color="#E5E5E5"> some flags</font>

536
00:36:50,930 --> 00:36:58,040
are said in<font color="#CCCCCC"> the negotiated flags field</font>

537
00:36:53,540 --> 00:37:00,380
and is and<font color="#CCCCCC"> that a cruncher grunts</font>

538
00:36:58,040 --> 00:37:05,060
computer lamb and<font color="#E5E5E5"> bro operating system</font>

539
00:37:00,380 --> 00:37:10,820
racing are also provided the information

540
00:37:05,060 --> 00:37:14,570
<font color="#E5E5E5">is encoded by the base 16</font><font color="#CCCCCC"> 4 and send it</font>

541
00:37:10,820 --> 00:37:17,860
under<font color="#CCCCCC"> state in the authorization felt in</font>

542
00:37:14,570 --> 00:37:17,860
the HTTP handler

543
00:37:19,110 --> 00:37:25,840
after the attack received the victim

544
00:37:21,910 --> 00:37:28,890
<font color="#E5E5E5">antium SSP negotiation its dozen this is</font>

545
00:37:25,840 --> 00:37:33,300
<font color="#E5E5E5">thus the</font><font color="#CCCCCC"> same thing with the victims</font><font color="#E5E5E5"> SMB</font>

546
00:37:28,890 --> 00:37:40,680
services while system is the<font color="#CCCCCC"> pentium SSB</font>

547
00:37:33,300 --> 00:37:43,840
SSB negotiation over<font color="#E5E5E5"> the SMB the victim</font>

548
00:37:40,680 --> 00:37:46,149
returns the MGM challenging to the

549
00:37:43,840 --> 00:37:48,520
<font color="#E5E5E5">attacker</font><font color="#CCCCCC"> the attacker doesn't</font>

550
00:37:46,150 --> 00:37:52,180
immediately generate<font color="#CCCCCC"> type</font><font color="#E5E5E5"> 3 message</font>

551
00:37:48,520 --> 00:37:55,690
<font color="#E5E5E5">after receiving</font><font color="#CCCCCC"> say challenge para</font>

552
00:37:52,180 --> 00:37:58,899
instead<font color="#E5E5E5"> o</font><font color="#CCCCCC"> storage the challenge we</font><font color="#E5E5E5"> need</font>

553
00:37:55,690 --> 00:38:09,760
to pay<font color="#CCCCCC"> attention to</font><font color="#E5E5E5"> the negotiate a to</font>

554
00:37:58,900 --> 00:38:12,090
the flags at this time is the AC<font color="#E5E5E5"> the</font>

555
00:38:09,760 --> 00:38:12,090
<font color="#E5E5E5">attacker</font>

556
00:38:12,520 --> 00:38:18,620
abandoned in<font color="#E5E5E5"> the travel step in the</font>

557
00:38:15,260 --> 00:38:20,900
interim<font color="#CCCCCC"> at indication over the HTTP in</font>

558
00:38:18,620 --> 00:38:24,350
this step<font color="#CCCCCC"> a check not only transferred</font>

559
00:38:20,900 --> 00:38:27,320
<font color="#E5E5E5">ng I am at challenge but also modified</font>

560
00:38:24,350 --> 00:38:30,529
as a negotiated<font color="#CCCCCC"> Flags</font><font color="#E5E5E5"> place</font><font color="#CCCCCC"> pay</font>

561
00:38:27,320 --> 00:38:34,010
attention to the<font color="#E5E5E5"> picture the</font><font color="#CCCCCC"> tab to</font>

562
00:38:30,530 --> 00:38:37,180
message to<font color="#CCCCCC"> help to message to</font><font color="#E5E5E5"> returned</font>

563
00:38:34,010 --> 00:38:42,650
<font color="#E5E5E5">by the attacker at this time the</font>

564
00:38:37,180 --> 00:38:49,790
negotiated<font color="#E5E5E5"> flags become the 0y modified</font>

565
00:38:42,650 --> 00:38:52,730
those flag negotiating the<font color="#E5E5E5"> flags changed</font>

566
00:38:49,790 --> 00:38:55,520
from the<font color="#E5E5E5"> ACA to a zero we note that the</font>

567
00:38:52,730 --> 00:38:57,920
boundary of<font color="#E5E5E5"> the</font><font color="#CCCCCC"> C is the one one zero</font>

568
00:38:55,520 --> 00:39:00,500
<font color="#CCCCCC">zero we change two bits</font>

569
00:38:57,920 --> 00:39:04,100
both of them are changed from<font color="#E5E5E5"> one to</font>

570
00:39:00,500 --> 00:39:07,460
<font color="#E5E5E5">zero so they are flat they are a flag</font>

571
00:39:04,100 --> 00:39:12,980
from the<font color="#E5E5E5"> setting to unsend him see us in</font>

572
00:39:07,460 --> 00:39:15,890
the<font color="#E5E5E5"> two flagging set sail to flag the</font>

573
00:39:12,980 --> 00:39:25,910
first day is always<font color="#CCCCCC"> dying and the next</font>

574
00:39:15,890 --> 00:39:29,839
one is the<font color="#CCCCCC"> oh</font><font color="#E5E5E5"> for why we</font><font color="#CCCCCC"> need to</font>

575
00:39:25,910 --> 00:39:32,750
to change the<font color="#E5E5E5"> beads because we don't</font>

576
00:39:29,839 --> 00:39:36,020
know the<font color="#E5E5E5"> signature see so we only need</font>

577
00:39:32,750 --> 00:39:39,289
<font color="#E5E5E5">to</font><font color="#CCCCCC"> unsend</font><font color="#E5E5E5"> it another</font><font color="#CCCCCC"> one's we need</font><font color="#E5E5E5"> to</font>

578
00:39:36,020 --> 00:39:42,220
spoof is the server and<font color="#E5E5E5"> client</font><font color="#CCCCCC"> are</font><font color="#E5E5E5"> not</font>

579
00:39:39,289 --> 00:39:42,220
on the same<font color="#CCCCCC"> machine</font>

580
00:39:43,330 --> 00:39:48,259
after<font color="#CCCCCC"> a wick team receives the</font><font color="#E5E5E5"> challenge</font>

581
00:39:45,980 --> 00:39:52,520
<font color="#CCCCCC">in sync by the attack</font><font color="#E5E5E5"> either way I use</font>

582
00:39:48,260 --> 00:39:55,070
<font color="#CCCCCC">the gradient and kiamashi to perform the</font>

583
00:39:52,520 --> 00:39:59,210
net and<font color="#CCCCCC"> the mihashi on</font><font color="#E5E5E5"> this challenge</font>

584
00:39:55,070 --> 00:40:03,200
<font color="#CCCCCC">and</font><font color="#E5E5E5"> then it will send the net and</font>

585
00:39:59,210 --> 00:40:08,410
<font color="#CCCCCC">hamachi to attacker to the</font><font color="#E5E5E5"> attacker this</font>

586
00:40:03,200 --> 00:40:08,410
is a<font color="#CCCCCC"> an tiem</font><font color="#E5E5E5"> an indication of the HTTP</font>

587
00:40:09,220 --> 00:40:16,069
so attack and attack we<font color="#CCCCCC"> are forwards the</font>

588
00:40:13,550 --> 00:40:19,190
net and I'm Hoshi to the routing<font color="#E5E5E5"> chamber</font>

589
00:40:16,070 --> 00:40:21,740
servers<font color="#E5E5E5"> SMB services complaint in the</font>

590
00:40:19,190 --> 00:40:26,320
process of forwarding the victim<font color="#E5E5E5"> or</font>

591
00:40:21,740 --> 00:40:29,689
<font color="#E5E5E5">encored engines to the victim after</font><font color="#CCCCCC"> the</font>

592
00:40:26,320 --> 00:40:33,040
SMB<font color="#E5E5E5"> is identically the by the attacker</font>

593
00:40:29,690 --> 00:40:37,450
<font color="#E5E5E5">some servers are starting</font><font color="#CCCCCC"> the by using</font>

594
00:40:33,040 --> 00:40:47,270
<font color="#CCCCCC">TCE</font><font color="#E5E5E5"> or RPC - I see</font>

595
00:40:37,450 --> 00:40:50,419
so this victim<font color="#CCCCCC"> has been</font><font color="#E5E5E5"> found so let's</font>

596
00:40:47,270 --> 00:40:54,350
see a real<font color="#E5E5E5"> real</font><font color="#CCCCCC"> work</font><font color="#E5E5E5"> a casino</font><font color="#CCCCCC"> case</font><font color="#E5E5E5"> I</font>

597
00:40:50,420 --> 00:40:58,910
found<font color="#E5E5E5"> our</font><font color="#CCCCCC"> xxe one ability in the patch</font>

598
00:40:54,350 --> 00:41:03,799
in<font color="#E5E5E5"> product sometimes ago I can use the</font>

599
00:40:58,910 --> 00:41:07,359
this<font color="#CCCCCC"> exact c2</font><font color="#E5E5E5"> complaint the RC RC e with</font>

600
00:41:03,800 --> 00:41:12,220
<font color="#E5E5E5">the attack vector</font><font color="#CCCCCC"> e we mentioned earlier</font>

601
00:41:07,360 --> 00:41:17,000
<font color="#CCCCCC">on</font><font color="#E5E5E5"> this project is it's for the database</font>

602
00:41:12,220 --> 00:41:22,430
<font color="#E5E5E5">design and the conference configuration</font>

603
00:41:17,000 --> 00:41:27,970
<font color="#E5E5E5">permit is the XML if the product opens a</font>

604
00:41:22,430 --> 00:41:35,790
crafty the configuration file is<font color="#E5E5E5"> where</font>

605
00:41:27,970 --> 00:41:38,399
the<font color="#E5E5E5"> bells leads to XX e in Java</font><font color="#CCCCCC"> XX</font><font color="#E5E5E5"> e</font>

606
00:41:35,790 --> 00:41:41,100
<font color="#E5E5E5">availability we usually use either to</font>

607
00:41:38,400 --> 00:41:44,640
really fly<font color="#CCCCCC"> with</font><font color="#E5E5E5"> the fails and line</font>

608
00:41:41,100 --> 00:41:48,810
services<font color="#E5E5E5"> but those are but</font><font color="#CCCCCC"> paths or are</font>

609
00:41:44,640 --> 00:41:51,089
limited we have<font color="#E5E5E5"> a</font><font color="#CCCCCC"> we we know</font><font color="#E5E5E5"> we have</font>

610
00:41:48,810 --> 00:41:56,610
talking<font color="#E5E5E5"> about</font><font color="#CCCCCC"> it by</font><font color="#E5E5E5"> the talk is cheap</font><font color="#CCCCCC"> I</font>

611
00:41:51,090 --> 00:42:00,000
will show me they share I will show they

612
00:41:56,610 --> 00:42:06,270
<font color="#E5E5E5">or demo for for the SMB credential</font>

613
00:42:00,000 --> 00:42:10,470
attack okay it<font color="#E5E5E5"> is attack around</font><font color="#CCCCCC"> the</font>

614
00:42:06,270 --> 00:42:25,220
<font color="#CCCCCC">tools</font><font color="#E5E5E5"> is lambda in short relay we were</font>

615
00:42:10,470 --> 00:42:32,779
released the truth this is<font color="#CCCCCC"> a crafted</font>

616
00:42:25,220 --> 00:42:37,830
configuration<font color="#E5E5E5"> fail and</font><font color="#CCCCCC"> they induced a</font>

617
00:42:32,780 --> 00:42:43,020
product to open it and<font color="#E5E5E5"> then we</font><font color="#CCCCCC"> cuz they</font>

618
00:42:37,830 --> 00:42:47,180
we got the<font color="#CCCCCC"> ng M Hoshi</font><font color="#E5E5E5"> we can use the</font>

619
00:42:43,020 --> 00:42:47,180
<font color="#CCCCCC">pasta Hoshi</font><font color="#E5E5E5"> - I see</font>

620
00:42:54,590 --> 00:42:57,639
[Music]

621
00:43:05,470 --> 00:43:18,370
<font color="#E5E5E5">okay</font><font color="#CCCCCC"> Jake I've already</font><font color="#E5E5E5"> is pop it</font><font color="#CCCCCC"> on so</font>

622
00:43:15,550 --> 00:43:21,010
<font color="#E5E5E5">to defend against the</font><font color="#CCCCCC"> unjam relay for</font>

623
00:43:18,370 --> 00:43:23,080
the client side I suggest the<font color="#CCCCCC"> message</font>

624
00:43:21,010 --> 00:43:28,390
<font color="#CCCCCC">asta that</font><font color="#E5E5E5"> disabled automatically logging</font>

625
00:43:23,080 --> 00:43:32,520
in<font color="#E5E5E5"> Internet when the environment is it's</font>

626
00:43:28,390 --> 00:43:38,049
the group environment and then disabled

627
00:43:32,520 --> 00:43:44,230
disabled the wpad<font color="#CCCCCC"> you also can blocked a</font>

628
00:43:38,050 --> 00:43:47,530
TCP<font color="#E5E5E5"> well what's really nice well</font><font color="#CCCCCC"> they</font>

629
00:43:44,230 --> 00:43:50,320
<font color="#CCCCCC">fire fault</font><font color="#E5E5E5"> if you if you want if you</font>

630
00:43:47,530 --> 00:43:55,000
don't<font color="#E5E5E5"> provide</font><font color="#CCCCCC"> this SMB server you can</font>

631
00:43:50,320 --> 00:43:58,210
plug the four four<font color="#E5E5E5"> five pot for the</font>

632
00:43:55,000 --> 00:44:00,910
<font color="#E5E5E5">server-side</font><font color="#CCCCCC"> you can enable the SMB sign</font>

633
00:43:58,210 --> 00:44:05,440
<font color="#E5E5E5">but the SMB sign is enabled by default</font>

634
00:44:00,910 --> 00:44:07,690
on domain controller if not if you are

635
00:44:05,440 --> 00:44:12,420
<font color="#E5E5E5">not domain control you need to you need</font>

636
00:44:07,690 --> 00:44:16,930
enable it by yourself<font color="#E5E5E5"> another is for the</font>

637
00:44:12,420 --> 00:44:19,870
exchange web<font color="#E5E5E5"> servers</font><font color="#CCCCCC"> I suggested the</font>

638
00:44:16,930 --> 00:44:24,759
exchange web server should be<font color="#CCCCCC"> viewed on</font>

639
00:44:19,870 --> 00:44:27,790
the<font color="#CCCCCC"> Internet if the exchange</font><font color="#E5E5E5"> web service</font>

640
00:44:24,760 --> 00:44:34,240
is not used<font color="#E5E5E5"> you can disable access</font>

641
00:44:27,790 --> 00:44:42,400
access to eat here is our material

642
00:44:34,240 --> 00:44:44,669
<font color="#E5E5E5">friends and and I want the special thank</font>

643
00:44:42,400 --> 00:44:47,500
to the<font color="#CCCCCC"> Tom Keifer and the flower code</font>

644
00:44:44,670 --> 00:44:52,150
<font color="#E5E5E5">jewelry our research we</font><font color="#CCCCCC"> have give us</font>

645
00:44:47,500 --> 00:44:56,070
beautiful<font color="#E5E5E5"> otherwise there are also a lot</font>

646
00:44:52,150 --> 00:44:59,800
of the<font color="#E5E5E5"> always on the tools to help me</font>

647
00:44:56,070 --> 00:45:05,040
<font color="#CCCCCC">complain this research</font><font color="#E5E5E5"> impact and</font>

648
00:44:59,800 --> 00:45:05,040
respond and the<font color="#E5E5E5"> term related to EWS</font>

649
00:45:06,280 --> 00:45:17,240
<font color="#E5E5E5">okay thank</font><font color="#CCCCCC"> you for</font><font color="#E5E5E5"> your attention</font><font color="#CCCCCC"> this</font>

650
00:45:08,510 --> 00:45:35,990
<font color="#CCCCCC">is a our tools we put we release it is</font>

651
00:45:17,240 --> 00:45:40,279
any questions you mentioned in your talk

652
00:45:35,990 --> 00:45:44,479
that<font color="#E5E5E5"> you're modifying the flags of the</font>

653
00:45:40,280 --> 00:45:46,490
<font color="#E5E5E5">negotiate message yeah how are you doing</font>

654
00:45:44,480 --> 00:45:56,119
that without breaking<font color="#E5E5E5"> the signature</font>

655
00:45:46,490 --> 00:45:59,000
that's on<font color="#E5E5E5"> these messages</font><font color="#CCCCCC"> because</font><font color="#E5E5E5"> we set</font>

656
00:45:56,119 --> 00:46:01,790
at<font color="#E5E5E5"> the Sun the Sun the flat the sign a</font>

657
00:45:59,000 --> 00:46:02,680
flag<font color="#CCCCCC"> to the</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> zero</font><font color="#E5E5E5"> so we</font><font color="#CCCCCC"> don't need a</font>

658
00:46:01,790 --> 00:46:05,840
sign

659
00:46:02,680 --> 00:46:07,089
yes but if you<font color="#CCCCCC"> look at and the Wireshark</font>

660
00:46:05,840 --> 00:46:12,220
<font color="#E5E5E5">in the next message</font>

661
00:46:07,090 --> 00:46:15,730
yeah there's a node one after I think

662
00:46:12,220 --> 00:46:15,730
the third message

663
00:46:15,760 --> 00:46:25,359
you mean that<font color="#CCCCCC"> Oh in</font><font color="#E5E5E5"> that type I mean the</font>

664
00:46:20,660 --> 00:46:30,770
<font color="#CCCCCC">make if you see the type three message</font>

665
00:46:25,359 --> 00:46:33,200
have a theory<font color="#E5E5E5"> method yes yes</font><font color="#CCCCCC"> on the</font>

666
00:46:30,770 --> 00:46:36,680
<font color="#E5E5E5">bottom you see Mick</font><font color="#CCCCCC"> which is a signature</font>

667
00:46:33,200 --> 00:46:38,810
based on all three the messages and as

668
00:46:36,680 --> 00:46:41,118
far<font color="#E5E5E5"> as I know if you change any</font><font color="#CCCCCC"> flags</font>

669
00:46:38,810 --> 00:46:42,290
<font color="#E5E5E5">then this signature will be in pellets</font>

670
00:46:41,119 --> 00:46:44,960
and<font color="#E5E5E5"> it won't work</font>

671
00:46:42,290 --> 00:46:56,089
but that was<font color="#CCCCCC"> not your experience</font><font color="#E5E5E5"> or how</font>

672
00:46:44,960 --> 00:47:01,280
did<font color="#E5E5E5"> you solve this</font><font color="#CCCCCC"> we may not understand</font>

673
00:46:56,089 --> 00:47:04,210
the<font color="#CCCCCC"> question properly</font><font color="#E5E5E5"> we talk in private</font>

674
00:47:01,280 --> 00:47:08,330
so sorry<font color="#CCCCCC"> about that you show of anyone</font>

675
00:47:04,210 --> 00:47:10,280
what you saw new partner<font color="#CCCCCC"> canonical flag</font>

676
00:47:08,330 --> 00:47:13,580
<font color="#E5E5E5">and the signature</font><font color="#CCCCCC"> Johanna hydrogen</font>

677
00:47:10,280 --> 00:47:16,700
hydrogen<font color="#E5E5E5"> when in its minimum</font><font color="#CCCCCC"> indigo and</font>

678
00:47:13,580 --> 00:47:17,640
Hema<font color="#CCCCCC"> Google meant with of our energy to</font>

679
00:47:16,700 --> 00:47:21,990
<font color="#CCCCCC">it</font>

680
00:47:17,640 --> 00:47:24,150
<font color="#CCCCCC">ah to rule over</font><font color="#E5E5E5"> all yurui your sign of</font>

681
00:47:21,990 --> 00:47:26,970
<font color="#CCCCCC">hiding</font><font color="#E5E5E5"> you got the material</font><font color="#CCCCCC"> no so</font>

682
00:47:24,150 --> 00:47:29,519
instead when the<font color="#E5E5E5"> flex change the</font>

683
00:47:26,970 --> 00:47:34,439
signature should be invalid<font color="#E5E5E5"> right uh how</font>

684
00:47:29,519 --> 00:47:39,479
do you solo flag<font color="#E5E5E5"> you wanna sing</font><font color="#CCCCCC"> juju if</font>

685
00:47:34,440 --> 00:47:42,299
the flag is not changed the the process

686
00:47:39,480 --> 00:47:45,900
will<font color="#CCCCCC"> be cut out</font><font color="#E5E5E5"> we cannot perform</font>

687
00:47:42,299 --> 00:47:50,509
Saturday<font color="#E5E5E5"> so we</font><font color="#CCCCCC"> if we want to</font><font color="#E5E5E5"> perform</font>

688
00:47:45,900 --> 00:47:50,510
this<font color="#E5E5E5"> tag we needed to change this flag</font>

689
00:47:51,650 --> 00:47:55,670
okay ha ha ha

690
00:48:00,650 --> 00:48:05,789
<font color="#CCCCCC">alright</font><font color="#E5E5E5"> that I think that's all the</font>

691
00:48:03,480 --> 00:48:10,819
questions we have<font color="#E5E5E5"> thank you long journey</font>

692
00:48:05,789 --> 00:48:10,819
<font color="#CCCCCC">and</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> Geneva for</font><font color="#E5E5E5"> the talk thank you</font>

