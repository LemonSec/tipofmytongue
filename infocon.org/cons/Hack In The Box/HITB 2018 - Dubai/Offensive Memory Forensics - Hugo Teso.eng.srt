1
00:00:24,439 --> 00:00:30,380
good afternoon<font color="#E5E5E5"> thanks for coming</font>

2
00:00:28,070 --> 00:00:32,630
<font color="#CCCCCC">I was already</font><font color="#E5E5E5"> introduced I'm afraid this</font>

3
00:00:30,380 --> 00:00:34,970
<font color="#E5E5E5">time my talk is not gonna go around the</font>

4
00:00:32,630 --> 00:00:37,190
aviation or airplanes it's gonna be

5
00:00:34,970 --> 00:00:40,489
going<font color="#E5E5E5"> around the concept of memory</font>

6
00:00:37,190 --> 00:00:42,920
forensics and actually in approach I

7
00:00:40,489 --> 00:00:47,660
followed to try to defeat memory

8
00:00:42,920 --> 00:00:50,210
forensics<font color="#CCCCCC"> okay so let's start okay this</font>

9
00:00:47,660 --> 00:00:51,860
is<font color="#CCCCCC"> a</font><font color="#E5E5E5"> kind of the organization of</font><font color="#CCCCCC"> the of</font>

10
00:00:50,210 --> 00:00:54,589
the talk<font color="#E5E5E5"> we're going to be dividing</font><font color="#CCCCCC"> it</font>

11
00:00:51,860 --> 00:00:57,019
in four phases<font color="#CCCCCC"> although I can let you</font>

12
00:00:54,589 --> 00:00:58,580
<font color="#CCCCCC">know</font><font color="#E5E5E5"> really</font><font color="#CCCCCC"> that one of them we will</font>

13
00:00:57,019 --> 00:01:00,440
have<font color="#CCCCCC"> to make it for</font><font color="#E5E5E5"> whoever is</font>

14
00:00:58,580 --> 00:01:02,030
interested<font color="#E5E5E5"> after</font><font color="#CCCCCC"> the talk</font><font color="#E5E5E5"> because we</font>

15
00:01:00,440 --> 00:01:03,949
actually<font color="#CCCCCC"> can't have or don't have all</font>

16
00:01:02,030 --> 00:01:06,170
the time<font color="#E5E5E5"> to to stretch all the content</font>

17
00:01:03,950 --> 00:01:08,600
here<font color="#CCCCCC"> ok I'm going to take my</font><font color="#E5E5E5"> glasses</font>

18
00:01:06,170 --> 00:01:11,000
because I see nothing<font color="#E5E5E5"> otherwise now I</font>

19
00:01:08,600 --> 00:01:14,419
<font color="#CCCCCC">don't see you but at least I'm not blind</font>

20
00:01:11,000 --> 00:01:16,399
<font color="#CCCCCC">ok so let's begin with the background</font>

21
00:01:14,420 --> 00:01:18,619
the story behind this<font color="#E5E5E5"> research</font><font color="#CCCCCC"> that I'm</font>

22
00:01:16,399 --> 00:01:22,119
presenting<font color="#CCCCCC"> here now okay</font><font color="#E5E5E5"> long story</font>

23
00:01:18,619 --> 00:01:25,850
<font color="#CCCCCC">short this research</font><font color="#E5E5E5"> began in January</font>

24
00:01:22,119 --> 00:01:27,410
2016<font color="#CCCCCC"> when a friend of</font><font color="#E5E5E5"> mine and organizer</font>

25
00:01:25,850 --> 00:01:30,770
<font color="#E5E5E5">of another security conference in</font>

26
00:01:27,410 --> 00:01:33,320
Finland called<font color="#CCCCCC"> t2</font><font color="#E5E5E5"> throw me a challenge</font>

27
00:01:30,770 --> 00:01:35,810
<font color="#CCCCCC">ok he already knew that</font><font color="#E5E5E5"> I'm quite keen</font>

28
00:01:33,320 --> 00:01:38,539
<font color="#E5E5E5">on developing my own offensive security</font>

29
00:01:35,810 --> 00:01:41,150
<font color="#E5E5E5">tools for purely</font><font color="#CCCCCC"> research purposes</font><font color="#E5E5E5"> while</font>

30
00:01:38,540 --> 00:01:43,250
he is actually<font color="#E5E5E5"> quite focused on the</font>

31
00:01:41,150 --> 00:01:46,220
<font color="#CCCCCC">defences part of it</font><font color="#E5E5E5"> so forensics</font>

32
00:01:43,250 --> 00:01:47,990
<font color="#E5E5E5">analysis</font><font color="#CCCCCC"> and especially</font><font color="#E5E5E5"> he is quite keen</font>

33
00:01:46,220 --> 00:01:51,320
on<font color="#E5E5E5"> the memory forensics analysis</font>

34
00:01:47,990 --> 00:01:54,740
discipline so he<font color="#E5E5E5"> told me if I could try</font>

35
00:01:51,320 --> 00:01:58,309
to<font color="#E5E5E5"> find a way</font><font color="#CCCCCC"> to make my offensive</font>

36
00:01:54,740 --> 00:02:00,560
security<font color="#CCCCCC"> tools</font><font color="#E5E5E5"> proof bulletproof against</font>

37
00:01:58,310 --> 00:02:03,530
<font color="#E5E5E5">his memory forensic skills and</font>

38
00:02:00,560 --> 00:02:06,320
techniques and hands I had one<font color="#E5E5E5"> year to</font>

39
00:02:03,530 --> 00:02:08,929
<font color="#CCCCCC">to try to do</font><font color="#E5E5E5"> the feet or win that</font>

40
00:02:06,320 --> 00:02:10,160
challenge<font color="#CCCCCC"> ok</font><font color="#E5E5E5"> and the result of</font><font color="#CCCCCC"> that</font>

41
00:02:08,929 --> 00:02:13,459
<font color="#E5E5E5">challenge is what we are going to be</font>

42
00:02:10,160 --> 00:02:16,519
explaining explaining here but not<font color="#E5E5E5"> just</font>

43
00:02:13,459 --> 00:02:18,350
the the the<font color="#CCCCCC"> results of the of the</font>

44
00:02:16,519 --> 00:02:21,190
research<font color="#E5E5E5"> seminar so Trina</font><font color="#CCCCCC"> lead the</font>

45
00:02:18,350 --> 00:02:25,160
process on<font color="#CCCCCC"> how I decided to approach</font>

46
00:02:21,190 --> 00:02:27,620
this<font color="#CCCCCC"> this research ok so the first</font><font color="#E5E5E5"> thing</font>

47
00:02:25,160 --> 00:02:29,840
I had to do<font color="#E5E5E5"> after accepting the</font>

48
00:02:27,620 --> 00:02:33,500
challenge<font color="#E5E5E5"> because I had to accept the</font>

49
00:02:29,840 --> 00:02:36,560
challenge<font color="#E5E5E5"> there is no no no no other</font>

50
00:02:33,500 --> 00:02:39,949
option<font color="#CCCCCC"> ok was to to kind of train myself</font>

51
00:02:36,560 --> 00:02:41,450
<font color="#CCCCCC">ok because</font><font color="#E5E5E5"> the first thing you you got</font>

52
00:02:39,949 --> 00:02:44,480
<font color="#E5E5E5">to do is</font>

53
00:02:41,450 --> 00:02:46,700
<font color="#E5E5E5">is to get familiar</font><font color="#CCCCCC"> with</font><font color="#E5E5E5"> with the field</font>

54
00:02:44,480 --> 00:02:48,980
<font color="#CCCCCC">you're</font><font color="#E5E5E5"> gonna be targeting in this case</font>

55
00:02:46,700 --> 00:02:51,500
memory<font color="#CCCCCC"> forensics right</font><font color="#E5E5E5"> so you have to</font>

56
00:02:48,980 --> 00:02:53,268
know yourself<font color="#CCCCCC"> in this case I was aware</font>

57
00:02:51,500 --> 00:02:56,200
of my own knowledge and skills in<font color="#CCCCCC"> the</font>

58
00:02:53,269 --> 00:02:58,730
offensive<font color="#CCCCCC"> security field let's say but</font>

59
00:02:56,200 --> 00:03:02,569
<font color="#E5E5E5">even though I was</font><font color="#CCCCCC"> aware of</font><font color="#E5E5E5"> the high</font>

60
00:02:58,730 --> 00:03:04,940
skills of my my friend<font color="#E5E5E5"> not during this</font>

61
00:03:02,569 --> 00:03:08,660
challenge but while still friend<font color="#E5E5E5"> on</font>

62
00:03:04,940 --> 00:03:11,329
memory forensics<font color="#CCCCCC"> I was</font><font color="#E5E5E5"> also aware</font><font color="#CCCCCC"> of my</font>

63
00:03:08,660 --> 00:03:12,379
lack<font color="#CCCCCC"> of expertise in that field right</font><font color="#E5E5E5"> so</font>

64
00:03:11,330 --> 00:03:13,760
the first thing I had to do was to

65
00:03:12,379 --> 00:03:15,920
increase my knowledge in memory

66
00:03:13,760 --> 00:03:19,670
forensics<font color="#E5E5E5"> otherwise it would be hard to</font>

67
00:03:15,920 --> 00:03:23,958
<font color="#E5E5E5">defeat them so first step</font><font color="#CCCCCC"> ask for help</font>

68
00:03:19,670 --> 00:03:26,510
<font color="#CCCCCC">ok so I</font><font color="#E5E5E5"> just</font><font color="#CCCCCC"> ask</font><font color="#E5E5E5"> for</font><font color="#CCCCCC"> help</font><font color="#E5E5E5"> to the to the</font>

69
00:03:23,959 --> 00:03:29,000
people<font color="#E5E5E5"> I knew I happen to know that are</font>

70
00:03:26,510 --> 00:03:32,599
somehow familiar<font color="#CCCCCC"> with the with</font><font color="#E5E5E5"> the field</font>

71
00:03:29,000 --> 00:03:36,319
memory forensics<font color="#CCCCCC"> first and foremost of</font>

72
00:03:32,599 --> 00:03:40,880
<font color="#CCCCCC">course my</font><font color="#E5E5E5"> Challenger Tommy and the guy</font>

73
00:03:36,319 --> 00:03:42,708
in the<font color="#E5E5E5"> middle is the</font><font color="#CCCCCC"> outsole of</font><font color="#E5E5E5"> reverse</font>

74
00:03:40,880 --> 00:03:45,739
<font color="#CCCCCC">engineering framework</font><font color="#E5E5E5"> but</font><font color="#CCCCCC"> also memory</font>

75
00:03:42,709 --> 00:03:49,100
forensics on forensics tool<font color="#E5E5E5"> radar l2 and</font>

76
00:03:45,739 --> 00:03:51,470
many other people right<font color="#E5E5E5"> so I gather some</font>

77
00:03:49,100 --> 00:03:54,200
<font color="#E5E5E5">information from them and tips and</font>

78
00:03:51,470 --> 00:03:57,470
recommendations<font color="#E5E5E5"> and one of them was</font>

79
00:03:54,200 --> 00:03:59,540
obviously to actually read this book<font color="#CCCCCC"> ok</font>

80
00:03:57,470 --> 00:04:02,180
it's like<font color="#E5E5E5"> the book of memory forensics</font>

81
00:03:59,540 --> 00:04:04,280
<font color="#E5E5E5">because it's really good because it's a</font>

82
00:04:02,180 --> 00:04:06,859
kind<font color="#E5E5E5"> of mandatory read and also because</font>

83
00:04:04,280 --> 00:04:09,139
it's the<font color="#E5E5E5"> only one</font><font color="#CCCCCC"> okay so I got this</font>

84
00:04:06,859 --> 00:04:11,239
<font color="#E5E5E5">book and I started to read</font><font color="#CCCCCC"> about the art</font>

85
00:04:09,139 --> 00:04:13,280
<font color="#E5E5E5">of memory forensics like welcome</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> the</font>

86
00:04:11,239 --> 00:04:15,829
wonderful world of memory forensics just

87
00:04:13,280 --> 00:04:18,889
<font color="#CCCCCC">that read and you say</font><font color="#E5E5E5"> ok</font><font color="#CCCCCC"> for instance</font>

88
00:04:15,829 --> 00:04:21,310
101<font color="#CCCCCC"> ok</font><font color="#E5E5E5"> so starting now I'm gonna call it</font>

89
00:04:18,889 --> 00:04:26,240
<font color="#CCCCCC">mm 6 because I like to shorten words and</font>

90
00:04:21,310 --> 00:04:28,220
looks like<font color="#CCCCCC"> mm 6 is like the part of the</font>

91
00:04:26,240 --> 00:04:31,430
<font color="#E5E5E5">digital</font><font color="#CCCCCC"> forensics discipline</font><font color="#E5E5E5"> that it's</font>

92
00:04:28,220 --> 00:04:34,430
<font color="#E5E5E5">focusing specifically on the analysis of</font>

93
00:04:31,430 --> 00:04:37,220
volatile data that has some advantages

94
00:04:34,430 --> 00:04:39,530
over disk forensics<font color="#E5E5E5"> over</font><font color="#CCCCCC"> a network</font>

95
00:04:37,220 --> 00:04:42,200
forensics it has some drawbacks<font color="#E5E5E5"> it's a</font>

96
00:04:39,530 --> 00:04:43,880
complex discipline complicated<font color="#CCCCCC"> a lot</font><font color="#E5E5E5"> of</font>

97
00:04:42,200 --> 00:04:46,039
theory<font color="#E5E5E5"> and then after reading and</font>

98
00:04:43,880 --> 00:04:48,320
reading and reading<font color="#E5E5E5"> I realized that</font><font color="#CCCCCC"> ok I</font>

99
00:04:46,039 --> 00:04:50,630
had to step to stop again<font color="#E5E5E5"> take a step</font>

100
00:04:48,320 --> 00:04:51,260
<font color="#E5E5E5">back and realize</font><font color="#CCCCCC"> ok maybe</font><font color="#E5E5E5"> that's not the</font>

101
00:04:50,630 --> 00:04:53,700
best<font color="#E5E5E5"> approach</font>

102
00:04:51,260 --> 00:04:57,360
<font color="#CCCCCC">ok I'll get</font><font color="#E5E5E5"> more people</font><font color="#CCCCCC"> welcome</font>

103
00:04:53,700 --> 00:04:59,900
so let's analyze<font color="#CCCCCC"> it's</font><font color="#E5E5E5"> a it's the</font>

104
00:04:57,360 --> 00:05:03,690
discipline is called memory<font color="#E5E5E5"> forensics</font>

105
00:04:59,900 --> 00:05:05,820
<font color="#E5E5E5">meaning that it's the the process the</font>

106
00:05:03,690 --> 00:05:07,530
art<font color="#E5E5E5"> the discipline the science of</font>

107
00:05:05,820 --> 00:05:10,620
<font color="#E5E5E5">applying forensics technique forensic</font>

108
00:05:07,530 --> 00:05:12,330
techniques to memory<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> great</font>

109
00:05:10,620 --> 00:05:16,440
something<font color="#E5E5E5"> I realize while reading that</font>

110
00:05:12,330 --> 00:05:17,909
book<font color="#E5E5E5"> is</font><font color="#CCCCCC"> that actually I had a problem</font><font color="#E5E5E5"> on</font>

111
00:05:16,440 --> 00:05:20,490
the<font color="#CCCCCC"> root of my knowledge is that</font>

112
00:05:17,910 --> 00:05:23,630
actually had not such a good knowledge

113
00:05:20,490 --> 00:05:27,060
on memory<font color="#CCCCCC"> it's</font><font color="#E5E5E5"> a right so before even I</font>

114
00:05:23,630 --> 00:05:29,969
targeted the<font color="#CCCCCC"> the forensics part of it</font>

115
00:05:27,060 --> 00:05:32,610
I had to<font color="#E5E5E5"> increase a lot badly my</font>

116
00:05:29,970 --> 00:05:35,220
knowledge on memory management<font color="#E5E5E5"> okay of</font>

117
00:05:32,610 --> 00:05:40,470
course<font color="#CCCCCC"> the problem</font><font color="#E5E5E5"> was but which memory</font>

118
00:05:35,220 --> 00:05:42,690
<font color="#CCCCCC">okay Windows Linux OS X iOS</font><font color="#E5E5E5"> Android</font><font color="#CCCCCC"> qnx</font>

119
00:05:40,470 --> 00:05:45,540
<font color="#E5E5E5">there are so many platforms over there</font>

120
00:05:42,690 --> 00:05:48,390
and all of<font color="#CCCCCC"> them have different</font><font color="#E5E5E5"> slightly</font>

121
00:05:45,540 --> 00:05:50,940
or massive<font color="#E5E5E5"> different management memory</font>

122
00:05:48,390 --> 00:05:53,070
management architecture<font color="#CCCCCC"> and processes I</font>

123
00:05:50,940 --> 00:05:55,020
had to defy to decide for<font color="#E5E5E5"> one right so I</font>

124
00:05:53,070 --> 00:05:57,990
<font color="#CCCCCC">came back</font><font color="#E5E5E5"> to my Challenger I asked him</font>

125
00:05:55,020 --> 00:06:02,340
and he<font color="#CCCCCC"> decided that I had to target</font>

126
00:05:57,990 --> 00:06:03,780
<font color="#E5E5E5">Windows memory forensics</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> for some</font>

127
00:06:02,340 --> 00:06:05,460
reason<font color="#CCCCCC"> he's</font><font color="#E5E5E5"> one</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> those persons that I</font>

128
00:06:03,780 --> 00:06:07,229
still believe<font color="#CCCCCC"> that</font><font color="#E5E5E5"> the important</font>

129
00:06:05,460 --> 00:06:09,359
information in this<font color="#E5E5E5"> world is storing</font>

130
00:06:07,230 --> 00:06:11,070
Windows<font color="#CCCCCC"> machines</font><font color="#E5E5E5"> so I had to target</font>

131
00:06:09,360 --> 00:06:15,930
<font color="#E5E5E5">Windows not my favorite platform</font><font color="#CCCCCC"> but a</font>

132
00:06:11,070 --> 00:06:18,360
we<font color="#E5E5E5"> can't do that so let's go</font><font color="#CCCCCC"> and they go</font>

133
00:06:15,930 --> 00:06:22,080
deeper into<font color="#CCCCCC"> the memory</font><font color="#E5E5E5"> and memory</font>

134
00:06:18,360 --> 00:06:25,320
<font color="#CCCCCC">management okay so memory in this case</font>

135
00:06:22,080 --> 00:06:28,950
<font color="#E5E5E5">it makes it read refers to the memory</font>

136
00:06:25,320 --> 00:06:32,250
that<font color="#CCCCCC"> we call drum</font><font color="#E5E5E5"> remember okay so the</font>

137
00:06:28,950 --> 00:06:35,090
volatile memory<font color="#E5E5E5"> now there is an issue</font>

138
00:06:32,250 --> 00:06:37,440
<font color="#E5E5E5">here is that operating systems enhance</font>

139
00:06:35,090 --> 00:06:39,679
memory forensics<font color="#E5E5E5"> they don't really work</font>

140
00:06:37,440 --> 00:06:41,670
with<font color="#CCCCCC"> RAM</font><font color="#E5E5E5"> they work with something</font>

141
00:06:39,680 --> 00:06:44,250
<font color="#E5E5E5">different</font><font color="#CCCCCC"> slightly different that is</font>

142
00:06:41,670 --> 00:06:46,350
called built on memory<font color="#E5E5E5"> okay and digital</font>

143
00:06:44,250 --> 00:06:47,880
memory happens to be the RAM memory<font color="#E5E5E5"> the</font>

144
00:06:46,350 --> 00:06:50,730
physical<font color="#E5E5E5"> memory that you have on your</font>

145
00:06:47,880 --> 00:06:54,180
laptops and computers and<font color="#E5E5E5"> phones plus</font>

146
00:06:50,730 --> 00:06:56,190
something<font color="#E5E5E5"> so I stayed like two or</font><font color="#CCCCCC"> three</font>

147
00:06:54,180 --> 00:06:59,570
<font color="#E5E5E5">weeks reading about memory built on</font>

148
00:06:56,190 --> 00:07:02,730
memory until<font color="#E5E5E5"> I</font><font color="#CCCCCC"> came up with blessing</font>

149
00:06:59,570 --> 00:07:04,409
website Microsoft that<font color="#E5E5E5"> explains</font>

150
00:07:02,730 --> 00:07:05,580
something<font color="#E5E5E5"> very important to me</font><font color="#CCCCCC"> that was</font>

151
00:07:04,410 --> 00:07:06,650
<font color="#E5E5E5">driving me crazy</font>

152
00:07:05,580 --> 00:07:09,650
<font color="#E5E5E5">is</font>

153
00:07:06,650 --> 00:07:12,380
in<font color="#E5E5E5"> Windows environment for some reason</font>

154
00:07:09,650 --> 00:07:15,080
the concept the term<font color="#E5E5E5"> built on memory is</font>

155
00:07:12,380 --> 00:07:17,510
<font color="#CCCCCC">actually a polymorphic term meaning it</font>

156
00:07:15,080 --> 00:07:20,300
has<font color="#E5E5E5"> more than one meaning it depends on</font>

157
00:07:17,510 --> 00:07:22,640
the context<font color="#E5E5E5"> and also on who is talking</font>

158
00:07:20,300 --> 00:07:25,460
<font color="#E5E5E5">to that right so let's see both meanings</font>

159
00:07:22,640 --> 00:07:27,229
so one of<font color="#E5E5E5"> them is</font><font color="#CCCCCC"> that the built on</font>

160
00:07:25,460 --> 00:07:28,789
memory is a physical memory plus

161
00:07:27,230 --> 00:07:31,430
<font color="#E5E5E5">something called a page file let's go</font>

162
00:07:28,790 --> 00:07:35,270
and see<font color="#CCCCCC"> that okay so built on memory</font>

163
00:07:31,430 --> 00:07:36,590
<font color="#CCCCCC">okay in the left ok</font><font color="#E5E5E5"> is actually the</font>

164
00:07:35,270 --> 00:07:38,780
<font color="#CCCCCC">physical memory</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> you have on</font><font color="#E5E5E5"> your</font>

165
00:07:36,590 --> 00:07:40,849
laptops<font color="#E5E5E5"> or devices plus a page file</font>

166
00:07:38,780 --> 00:07:43,640
something<font color="#E5E5E5"> a store on the hard drive</font><font color="#CCCCCC"> ok</font>

167
00:07:40,850 --> 00:07:44,930
<font color="#CCCCCC">Tony here is that it brings back</font>

168
00:07:43,640 --> 00:07:47,630
<font color="#CCCCCC">memories because</font><font color="#E5E5E5"> actually this is a</font>

169
00:07:44,930 --> 00:07:51,080
concept that<font color="#E5E5E5"> it had to be implemented on</font>

170
00:07:47,630 --> 00:07:53,390
the<font color="#E5E5E5"> days in which the computers needed</font>

171
00:07:51,080 --> 00:07:54,770
more memory that actually they<font color="#E5E5E5"> could</font>

172
00:07:53,390 --> 00:07:56,719
have because it was expensive

173
00:07:54,770 --> 00:08:00,020
right<font color="#E5E5E5"> so they had to come up with an</font>

174
00:07:56,720 --> 00:08:01,790
idea<font color="#CCCCCC"> to extend</font><font color="#E5E5E5"> the physical memory</font><font color="#CCCCCC"> ok</font>

175
00:08:00,020 --> 00:08:04,370
<font color="#E5E5E5">that the operating system</font><font color="#CCCCCC"> had available</font>

176
00:08:01,790 --> 00:08:07,310
<font color="#E5E5E5">by adding something more so they decided</font>

177
00:08:04,370 --> 00:08:09,560
<font color="#CCCCCC">to extend</font><font color="#E5E5E5"> it beautifully with some</font>

178
00:08:07,310 --> 00:08:13,370
additional memory stored on the hard

179
00:08:09,560 --> 00:08:15,670
drive<font color="#E5E5E5"> ok so to make it a little more</font>

180
00:08:13,370 --> 00:08:18,290
<font color="#E5E5E5">simple and</font><font color="#CCCCCC"> standard for you</font><font color="#E5E5E5"> ok</font><font color="#CCCCCC"> butyl is</font>

181
00:08:15,670 --> 00:08:20,840
<font color="#CCCCCC">the equivalent of physical memory but</font>

182
00:08:18,290 --> 00:08:23,180
combining DRAM<font color="#E5E5E5"> plus some memory store on</font>

183
00:08:20,840 --> 00:08:25,669
the hard drive<font color="#E5E5E5"> he seemed easy so far now</font>

184
00:08:23,180 --> 00:08:31,070
this memory<font color="#E5E5E5"> ok</font>

185
00:08:25,670 --> 00:08:33,590
<font color="#CCCCCC">it is divided</font><font color="#E5E5E5"> in unit the</font><font color="#CCCCCC"> unit in the</font>

186
00:08:31,070 --> 00:08:35,480
built on memory are called<font color="#E5E5E5"> pages while</font>

187
00:08:33,590 --> 00:08:37,640
in the physical memory<font color="#E5E5E5"> they are called</font>

188
00:08:35,480 --> 00:08:39,409
frames<font color="#E5E5E5"> the only purpose for</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> is not</font>

189
00:08:37,640 --> 00:08:42,799
to confuse<font color="#CCCCCC"> us</font><font color="#E5E5E5"> all the demon is to do</font>

190
00:08:39,409 --> 00:08:45,319
that is just<font color="#CCCCCC"> to differentiate ok when we</font>

191
00:08:42,799 --> 00:08:48,349
are<font color="#CCCCCC"> talking about</font><font color="#E5E5E5"> memory in the built on</font>

192
00:08:45,320 --> 00:08:51,410
memory or in the<font color="#E5E5E5"> physical memory</font><font color="#CCCCCC"> ok and</font>

193
00:08:48,350 --> 00:08:53,810
there is one rule that every single<font color="#CCCCCC"> page</font>

194
00:08:51,410 --> 00:08:55,579
in the beta memory has<font color="#E5E5E5"> one equivalent in</font>

195
00:08:53,810 --> 00:08:57,530
the physical<font color="#E5E5E5"> memory</font><font color="#CCCCCC"> what is actually</font>

196
00:08:55,580 --> 00:08:59,930
stored<font color="#E5E5E5"> but as you can see from the</font>

197
00:08:57,530 --> 00:09:01,760
arrows here hopefully you<font color="#CCCCCC"> can see the</font>

198
00:08:59,930 --> 00:09:03,589
equivalent<font color="#CCCCCC"> is not one-to-one so page 1</font>

199
00:09:01,760 --> 00:09:05,390
<font color="#E5E5E5">doesn't really need to</font><font color="#CCCCCC"> be a start on</font>

200
00:09:03,590 --> 00:09:07,280
frame 1<font color="#CCCCCC"> ok because</font><font color="#E5E5E5"> as long</font><font color="#CCCCCC"> as you use</font>

201
00:09:05,390 --> 00:09:08,990
<font color="#E5E5E5">the</font><font color="#CCCCCC"> computer memory</font><font color="#E5E5E5"> gets used and free</font>

202
00:09:07,280 --> 00:09:11,060
it<font color="#E5E5E5"> and use and</font><font color="#CCCCCC"> read it gets mixed</font><font color="#E5E5E5"> Maps</font>

203
00:09:08,990 --> 00:09:13,280
and there is something<font color="#CCCCCC"> called memory</font>

204
00:09:11,060 --> 00:09:15,020
management unit that<font color="#E5E5E5"> it's a tiny</font>

205
00:09:13,280 --> 00:09:17,390
component on your computer that<font color="#E5E5E5"> actually</font>

206
00:09:15,020 --> 00:09:19,550
<font color="#E5E5E5">takes care of translating or finding one</font>

207
00:09:17,390 --> 00:09:20,089
in<font color="#E5E5E5"> order so if the operating system</font>

208
00:09:19,550 --> 00:09:22,430
<font color="#E5E5E5">needs</font><font color="#CCCCCC"> to</font>

209
00:09:20,089 --> 00:09:24,019
find where the page<font color="#CCCCCC"> 3 is located he's</font>

210
00:09:22,430 --> 00:09:25,849
<font color="#E5E5E5">gonna ask the MMU and</font><font color="#CCCCCC"> it's</font><font color="#E5E5E5"> gonna say</font>

211
00:09:24,019 --> 00:09:27,620
it's stored on frame<font color="#E5E5E5"> 2 that happens to</font>

212
00:09:25,850 --> 00:09:29,660
<font color="#E5E5E5">be on the hard drive or could be on the</font>

213
00:09:27,620 --> 00:09:32,749
run<font color="#E5E5E5"> and</font><font color="#CCCCCC"> it's gonna</font><font color="#E5E5E5"> actually be changing</font>

214
00:09:29,660 --> 00:09:34,759
constantly<font color="#CCCCCC"> right now if it's gonna</font><font color="#E5E5E5"> make</font>

215
00:09:32,749 --> 00:09:36,649
<font color="#CCCCCC">it easier for you</font><font color="#E5E5E5"> and it certainly does</font>

216
00:09:34,759 --> 00:09:39,230
for me<font color="#CCCCCC"> you can consider based</font><font color="#E5E5E5"> on frames</font>

217
00:09:36,649 --> 00:09:40,879
just like any other unit of memory<font color="#E5E5E5"> like</font>

218
00:09:39,230 --> 00:09:43,009
by<font color="#E5E5E5"> its beats megabytes</font><font color="#CCCCCC"> these kind of</font>

219
00:09:40,879 --> 00:09:44,870
<font color="#E5E5E5">things right it's just</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> random unit so</font>

220
00:09:43,009 --> 00:09:49,160
you can say how<font color="#E5E5E5"> many memory is being</font>

221
00:09:44,870 --> 00:09:51,410
<font color="#CCCCCC">used on for a</font><font color="#E5E5E5"> certain process okay now</font>

222
00:09:49,160 --> 00:09:53,420
and<font color="#CCCCCC"> that's what</font><font color="#E5E5E5"> gets a little bit more</font>

223
00:09:51,410 --> 00:09:56,509
complicated<font color="#E5E5E5"> built on memory it's also</font>

224
00:09:53,420 --> 00:09:58,128
known or understood as the<font color="#E5E5E5"> collection</font><font color="#CCCCCC"> of</font>

225
00:09:56,509 --> 00:10:01,009
pages<font color="#CCCCCC"> that</font><font color="#E5E5E5"> we already know what is</font><font color="#CCCCCC"> that</font>

226
00:09:58,129 --> 00:10:03,499
<font color="#E5E5E5">okay it's cut in memory of a process</font>

227
00:10:01,009 --> 00:10:04,550
working<font color="#E5E5E5"> set Wow that's like a lot of</font>

228
00:10:03,499 --> 00:10:05,930
<font color="#CCCCCC">information</font><font color="#E5E5E5"> no worries</font>

229
00:10:04,550 --> 00:10:08,779
we're gonna<font color="#E5E5E5"> see</font><font color="#CCCCCC"> that now</font><font color="#E5E5E5"> okay let's</font>

230
00:10:05,930 --> 00:10:10,969
explain the<font color="#E5E5E5"> other concept okay back to</font>

231
00:10:08,779 --> 00:10:14,629
<font color="#CCCCCC">the same diagram okay</font><font color="#E5E5E5"> we have this</font>

232
00:10:10,970 --> 00:10:16,699
memory with pages assigned to frames and

233
00:10:14,629 --> 00:10:19,519
the MMU<font color="#E5E5E5"> making transmissions cool now</font>

234
00:10:16,699 --> 00:10:22,189
what do we know is<font color="#CCCCCC"> that in any running</font>

235
00:10:19,519 --> 00:10:23,779
<font color="#CCCCCC">system we have processes</font><font color="#E5E5E5"> it can</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> the</font>

236
00:10:22,189 --> 00:10:25,969
applications<font color="#E5E5E5"> we're running</font><font color="#CCCCCC"> okay like for</font>

237
00:10:23,779 --> 00:10:28,279
<font color="#CCCCCC">example PowerPoint in my laptop right</font>

238
00:10:25,970 --> 00:10:31,160
now<font color="#E5E5E5"> okay and this process is loaded in</font>

239
00:10:28,279 --> 00:10:33,620
memory it's using<font color="#E5E5E5"> memory okay and it's</font>

240
00:10:31,160 --> 00:10:37,279
using<font color="#CCCCCC"> memory in built on memory</font><font color="#E5E5E5"> so it</font>

241
00:10:33,620 --> 00:10:39,949
has a sign some amount of<font color="#E5E5E5"> pages that is</font>

242
00:10:37,279 --> 00:10:44,240
going to be growing<font color="#E5E5E5"> or reducing over</font>

243
00:10:39,949 --> 00:10:46,339
time<font color="#E5E5E5"> okay so</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> whatever process</font><font color="#CCCCCC"> okay</font>

244
00:10:44,240 --> 00:10:48,379
the collection<font color="#E5E5E5"> of pages</font><font color="#CCCCCC"> the amount of</font>

245
00:10:46,339 --> 00:10:50,809
pages assigned to<font color="#E5E5E5"> that process in built</font>

246
00:10:48,379 --> 00:10:54,920
on memory<font color="#E5E5E5"> it's called the address space</font>

247
00:10:50,809 --> 00:10:57,860
<font color="#E5E5E5">or built on memory for that process okay</font>

248
00:10:54,920 --> 00:11:00,620
now we<font color="#E5E5E5"> have both definitions obviously</font>

249
00:10:57,860 --> 00:11:04,339
all these pages in<font color="#CCCCCC"> mutant memory have</font>

250
00:11:00,620 --> 00:11:06,529
their own frames<font color="#E5E5E5"> in physical</font><font color="#CCCCCC"> memory and</font>

251
00:11:04,339 --> 00:11:09,410
to the collection<font color="#E5E5E5"> of those we call it</font>

252
00:11:06,529 --> 00:11:11,509
the working set<font color="#E5E5E5"> okay</font>

253
00:11:09,410 --> 00:11:12,949
I know lots of terms<font color="#CCCCCC"> it just to give you</font>

254
00:11:11,509 --> 00:11:14,089
some background<font color="#E5E5E5"> idea how memory works</font>

255
00:11:12,949 --> 00:11:15,319
because actually we're going<font color="#E5E5E5"> to</font><font color="#CCCCCC"> be</font>

256
00:11:14,089 --> 00:11:17,120
<font color="#E5E5E5">working with memory the entire</font>

257
00:11:15,319 --> 00:11:19,490
presentation<font color="#E5E5E5"> right so it's kind of a</font>

258
00:11:17,120 --> 00:11:22,939
necessary<font color="#E5E5E5"> now for those of you that have</font>

259
00:11:19,490 --> 00:11:24,499
done<font color="#CCCCCC"> some exploitation or</font><font color="#E5E5E5"> offensive</font>

260
00:11:22,939 --> 00:11:27,139
security memory and all<font color="#E5E5E5"> these kind of</font>

261
00:11:24,499 --> 00:11:30,110
<font color="#E5E5E5">things memory corruption bugs it may be</font>

262
00:11:27,139 --> 00:11:32,179
easier for<font color="#E5E5E5"> you</font><font color="#CCCCCC"> to understand that if I</font>

263
00:11:30,110 --> 00:11:33,560
tell you<font color="#E5E5E5"> that these addresses space will</font>

264
00:11:32,179 --> 00:11:35,480
<font color="#CCCCCC">term memory for whatever process</font>

265
00:11:33,560 --> 00:11:38,569
<font color="#E5E5E5">you already have seen that many times</font>

266
00:11:35,480 --> 00:11:41,990
<font color="#E5E5E5">just okay the way you will see</font><font color="#CCCCCC"> that on</font>

267
00:11:38,570 --> 00:11:44,120
the left<font color="#E5E5E5"> now okay so that is the</font>

268
00:11:41,990 --> 00:11:46,700
<font color="#E5E5E5">beautiful address space built on memory</font>

269
00:11:44,120 --> 00:11:49,550
of a process<font color="#E5E5E5"> in memory so to make it</font>

270
00:11:46,700 --> 00:11:51,800
even<font color="#CCCCCC"> more simple</font><font color="#E5E5E5"> Tara okay the mutual</font>

271
00:11:49,550 --> 00:11:53,300
address space of<font color="#CCCCCC"> a project of any</font>

272
00:11:51,800 --> 00:11:55,579
process<font color="#CCCCCC"> that you've almost one you're</font>

273
00:11:53,300 --> 00:11:57,439
familiar<font color="#E5E5E5"> with okay it's</font><font color="#CCCCCC"> just that in</font>

274
00:11:55,580 --> 00:12:00,350
<font color="#CCCCCC">mutant memory whenever you run the</font>

275
00:11:57,440 --> 00:12:01,760
program<font color="#CCCCCC"> okay and it has some it has to</font>

276
00:12:00,350 --> 00:12:03,440
be a<font color="#E5E5E5"> stores on</font><font color="#CCCCCC"> wet ride there is no</font>

277
00:12:01,760 --> 00:12:05,240
magic going<font color="#E5E5E5"> on the computer</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> that's</font>

278
00:12:03,440 --> 00:12:08,350
in the physical<font color="#CCCCCC"> memory</font><font color="#E5E5E5"> in these frames</font>

279
00:12:05,240 --> 00:12:11,750
<font color="#E5E5E5">it can be in RAM on your hard drive</font><font color="#CCCCCC"> okay</font>

280
00:12:08,350 --> 00:12:14,480
now obviously<font color="#E5E5E5"> to keep making things more</font>

281
00:12:11,750 --> 00:12:16,400
interesting<font color="#E5E5E5"> here computers</font><font color="#CCCCCC"> would be</font>

282
00:12:14,480 --> 00:12:18,140
useless<font color="#CCCCCC"> if</font><font color="#E5E5E5"> only one process would be</font>

283
00:12:16,400 --> 00:12:20,750
able<font color="#E5E5E5"> to</font><font color="#CCCCCC"> be running at</font><font color="#E5E5E5"> a time right</font><font color="#CCCCCC"> so</font>

284
00:12:18,140 --> 00:12:23,210
<font color="#CCCCCC">eventually all these devices</font><font color="#E5E5E5"> were able</font>

285
00:12:20,750 --> 00:12:25,460
to<font color="#E5E5E5"> actually run more than</font><font color="#CCCCCC"> one process</font>

286
00:12:23,210 --> 00:12:27,830
<font color="#E5E5E5">obviously</font><font color="#CCCCCC"> each of those processes would</font>

287
00:12:25,460 --> 00:12:30,110
have its own built<font color="#E5E5E5"> already space orbiter</font>

288
00:12:27,830 --> 00:12:33,020
memory that would have its equivalent on

289
00:12:30,110 --> 00:12:36,650
<font color="#E5E5E5">the physical memory</font><font color="#CCCCCC"> DRAM</font><font color="#E5E5E5"> or hard drive</font>

290
00:12:33,020 --> 00:12:39,380
okay<font color="#E5E5E5"> class okay</font><font color="#CCCCCC"> there is</font><font color="#E5E5E5"> this</font>

291
00:12:36,650 --> 00:12:41,900
differentiation<font color="#CCCCCC"> in memory</font><font color="#E5E5E5"> in modern</font>

292
00:12:39,380 --> 00:12:43,520
operating<font color="#E5E5E5"> systems between user space and</font>

293
00:12:41,900 --> 00:12:44,360
kernel space there<font color="#E5E5E5"> are more but let's</font>

294
00:12:43,520 --> 00:12:47,930
keep it simple<font color="#CCCCCC"> right</font>

295
00:12:44,360 --> 00:12:50,000
so on top<font color="#CCCCCC"> of the built on memory that we</font>

296
00:12:47,930 --> 00:12:53,569
already<font color="#CCCCCC"> explained every</font><font color="#E5E5E5"> single process</font>

297
00:12:50,000 --> 00:12:57,470
<font color="#E5E5E5">has a tiny amount of memory reserved in</font>

298
00:12:53,570 --> 00:12:59,930
<font color="#E5E5E5">the kernel space okay always</font><font color="#CCCCCC"> on top</font><font color="#E5E5E5"> of</font>

299
00:12:57,470 --> 00:13:02,480
the whole<font color="#E5E5E5"> kernel space that it's loaded</font>

300
00:12:59,930 --> 00:13:05,719
in memory<font color="#E5E5E5"> okay so that's gonna be</font><font color="#CCCCCC"> your</font>

301
00:13:02,480 --> 00:13:07,430
<font color="#E5E5E5">playground here and that's where the</font>

302
00:13:05,720 --> 00:13:08,990
explanation on memory management on

303
00:13:07,430 --> 00:13:11,630
<font color="#CCCCCC">Windows is gonna end up I</font><font color="#E5E5E5"> wanted to keep</font>

304
00:13:08,990 --> 00:13:13,850
it<font color="#CCCCCC"> simple and not lose the</font><font color="#E5E5E5"> the audience</font>

305
00:13:11,630 --> 00:13:15,860
in the first five minutes<font color="#E5E5E5"> thirty</font><font color="#CCCCCC"> minutes</font>

306
00:13:13,850 --> 00:13:17,900
actually<font color="#E5E5E5"> okay</font><font color="#CCCCCC"> now some of you may be</font>

307
00:13:15,860 --> 00:13:19,730
wondering<font color="#E5E5E5"> but I know a little bit</font><font color="#CCCCCC"> about</font>

308
00:13:17,900 --> 00:13:21,500
forensics<font color="#CCCCCC"> and I know that if I'm gonna</font>

309
00:13:19,730 --> 00:13:22,550
be<font color="#E5E5E5"> studying this memory what I'm not</font>

310
00:13:21,500 --> 00:13:25,010
<font color="#E5E5E5">going to be</font><font color="#CCCCCC"> looking</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> for these</font>

311
00:13:22,550 --> 00:13:28,579
artifacts that is the<font color="#E5E5E5"> files open</font>

312
00:13:25,010 --> 00:13:30,560
<font color="#E5E5E5">registry created</font><font color="#CCCCCC"> greed and the network</font>

313
00:13:28,580 --> 00:13:32,120
activity and so on so<font color="#CCCCCC"> on so where is</font>

314
00:13:30,560 --> 00:13:34,550
that<font color="#CCCCCC"> because we are just looking at</font>

315
00:13:32,120 --> 00:13:37,040
<font color="#CCCCCC">memory right</font><font color="#E5E5E5"> okay the real answer is</font>

316
00:13:34,550 --> 00:13:39,469
<font color="#CCCCCC">that all that</font><font color="#E5E5E5"> stuff is what it has</font><font color="#CCCCCC"> to be</font>

317
00:13:37,040 --> 00:13:43,430
<font color="#E5E5E5">okay</font><font color="#CCCCCC"> it's on the hard drive okay</font>

318
00:13:39,470 --> 00:13:45,680
now<font color="#E5E5E5"> meaning the limitation of memory</font>

319
00:13:43,430 --> 00:13:46,849
forensics<font color="#E5E5E5"> is that for any specific</font>

320
00:13:45,680 --> 00:13:50,239
process<font color="#E5E5E5"> you</font>

321
00:13:46,850 --> 00:13:53,449
only<font color="#E5E5E5"> gonna be able to</font><font color="#CCCCCC"> analyze okay</font><font color="#E5E5E5"> those</font>

322
00:13:50,240 --> 00:13:55,459
<font color="#E5E5E5">resources that</font><font color="#CCCCCC"> were being induced by</font>

323
00:13:53,449 --> 00:13:57,949
that<font color="#E5E5E5"> process in the moment where you</font>

324
00:13:55,459 --> 00:13:59,268
<font color="#CCCCCC">capture that</font><font color="#E5E5E5"> memory because at that</font>

325
00:13:57,949 --> 00:14:01,790
<font color="#CCCCCC">moment that's gonna</font><font color="#E5E5E5"> be loaded into</font>

326
00:13:59,269 --> 00:14:04,550
memory<font color="#E5E5E5"> remember memory forensics okay no</font>

327
00:14:01,790 --> 00:14:07,189
these forensics<font color="#E5E5E5"> so if we take a</font><font color="#CCCCCC"> snapshot</font>

328
00:14:04,550 --> 00:14:09,229
of the<font color="#E5E5E5"> computer memory</font><font color="#CCCCCC"> right now</font><font color="#E5E5E5"> you're</font>

329
00:14:07,190 --> 00:14:11,899
<font color="#E5E5E5">going to be able</font><font color="#CCCCCC"> to find the butyl</font>

330
00:14:09,230 --> 00:14:14,180
address space<font color="#E5E5E5"> of PowerPoint plus these</font>

331
00:14:11,899 --> 00:14:15,230
file and if at that moment<font color="#CCCCCC"> PowerPoint is</font>

332
00:14:14,180 --> 00:14:16,609
trying to check<font color="#E5E5E5"> for a date with</font>

333
00:14:15,230 --> 00:14:19,009
Microsoft you're<font color="#E5E5E5"> gonna see that network</font>

334
00:14:16,610 --> 00:14:20,420
activity also<font color="#E5E5E5"> and so on but you will not</font>

335
00:14:19,009 --> 00:14:22,100
<font color="#E5E5E5">be able to see all the powerpoints I</font>

336
00:14:20,420 --> 00:14:25,880
<font color="#E5E5E5">have</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> my hard drive because I'm not</font>

337
00:14:22,100 --> 00:14:29,389
opening all of<font color="#E5E5E5"> them right okay so far</font>

338
00:14:25,880 --> 00:14:31,220
that the part about memory management<font color="#CCCCCC"> on</font>

339
00:14:29,389 --> 00:14:33,829
<font color="#E5E5E5">Windows now gonna go a little bit for</font>

340
00:14:31,220 --> 00:14:35,899
the forensics so I created like

341
00:14:33,829 --> 00:14:38,120
gazillion different versions of<font color="#E5E5E5"> the</font>

342
00:14:35,899 --> 00:14:39,740
slides and to explain forensics<font color="#E5E5E5"> okay and</font>

343
00:14:38,120 --> 00:14:42,199
I<font color="#E5E5E5"> realize none of</font><font color="#CCCCCC"> they actually work</font>

344
00:14:39,740 --> 00:14:44,149
because<font color="#CCCCCC"> it's a huge</font><font color="#E5E5E5"> massive field</font><font color="#CCCCCC"> okay</font>

345
00:14:42,199 --> 00:14:48,979
with many many different<font color="#CCCCCC"> types of</font>

346
00:14:44,149 --> 00:14:50,990
techniques and concepts<font color="#E5E5E5"> and tools and it</font>

347
00:14:48,980 --> 00:14:53,089
was impossible<font color="#E5E5E5"> to put that in a single</font>

348
00:14:50,990 --> 00:14:54,829
<font color="#CCCCCC">slide deck okay so let me try</font><font color="#E5E5E5"> to give</font>

349
00:14:53,089 --> 00:14:56,569
you<font color="#E5E5E5"> an example</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> then we can see after</font>

350
00:14:54,829 --> 00:14:58,370
<font color="#E5E5E5">the talk a little bit more</font><font color="#CCCCCC"> hands-on</font>

351
00:14:56,569 --> 00:15:00,469
approach on<font color="#CCCCCC"> how to</font><font color="#E5E5E5"> actually perform</font>

352
00:14:58,370 --> 00:15:03,230
<font color="#E5E5E5">Emily Frances will sit</font><font color="#CCCCCC"> alone okay so</font>

353
00:15:00,470 --> 00:15:05,720
let's say that<font color="#E5E5E5"> we do receive as a memory</font>

354
00:15:03,230 --> 00:15:10,100
<font color="#CCCCCC">for</font><font color="#E5E5E5"> the six</font><font color="#CCCCCC"> analysts the memory</font><font color="#E5E5E5"> dump of</font>

355
00:15:05,720 --> 00:15:12,050
a machine<font color="#CCCCCC"> okay it's</font><font color="#E5E5E5"> like one of</font><font color="#CCCCCC"> those</font><font color="#E5E5E5"> I</font>

356
00:15:10,100 --> 00:15:13,939
don't<font color="#E5E5E5"> know you can see that</font><font color="#CCCCCC"> on the</font>

357
00:15:12,050 --> 00:15:16,339
<font color="#E5E5E5">bottom</font><font color="#CCCCCC"> left</font><font color="#E5E5E5"> okay</font>

358
00:15:13,939 --> 00:15:19,519
it's one of<font color="#E5E5E5"> those games where you start</font>

359
00:15:16,339 --> 00:15:22,339
the game<font color="#E5E5E5"> and you</font><font color="#CCCCCC"> just see a black screen</font>

360
00:15:19,519 --> 00:15:23,990
<font color="#E5E5E5">in a tiny light area where your</font>

361
00:15:22,339 --> 00:15:25,819
character is and they call the rest<font color="#E5E5E5"> the</font>

362
00:15:23,990 --> 00:15:28,579
fog wall<font color="#E5E5E5"> okay and you have to move</font>

363
00:15:25,819 --> 00:15:30,769
around<font color="#E5E5E5"> to kind of discover the map okay</font>

364
00:15:28,579 --> 00:15:33,680
<font color="#CCCCCC">if you have to play games</font><font color="#E5E5E5"> that's quite</font>

365
00:15:30,769 --> 00:15:35,779
common<font color="#CCCCCC"> okay now one</font><font color="#E5E5E5"> thing you know when</font>

366
00:15:33,680 --> 00:15:38,589
you play these games<font color="#E5E5E5"> and now you know</font>

367
00:15:35,779 --> 00:15:41,300
when you do memory analysis is<font color="#E5E5E5"> that</font>

368
00:15:38,589 --> 00:15:43,759
whenever you<font color="#CCCCCC"> start moving around okay</font>

369
00:15:41,300 --> 00:15:45,889
you're gonna find known<font color="#CCCCCC"> elements</font><font color="#E5E5E5"> you'll</font>

370
00:15:43,759 --> 00:15:50,269
know<font color="#E5E5E5"> you're gonna find trees rocks</font>

371
00:15:45,889 --> 00:15:53,600
<font color="#E5E5E5">flowers</font><font color="#CCCCCC"> rivers</font><font color="#E5E5E5"> walkways all these kind</font>

372
00:15:50,269 --> 00:15:55,760
of<font color="#E5E5E5"> things right so the art of memory</font>

373
00:15:53,600 --> 00:15:58,720
forensics is actually just the amount of

374
00:15:55,760 --> 00:16:00,610
<font color="#CCCCCC">the</font><font color="#E5E5E5"> group of tools and</font>

375
00:15:58,720 --> 00:16:03,100
techniques<font color="#E5E5E5"> that is gonna allow you to</font>

376
00:16:00,610 --> 00:16:06,029
properly<font color="#E5E5E5"> place all that okay and get a</font>

377
00:16:03,100 --> 00:16:09,699
full<font color="#E5E5E5"> picture of that a specific memory</font>

378
00:16:06,029 --> 00:16:11,709
<font color="#E5E5E5">okay</font><font color="#CCCCCC"> I know</font><font color="#E5E5E5"> it's far from technical but</font>

379
00:16:09,699 --> 00:16:13,060
well it's already 15<font color="#CCCCCC"> minutes and we just</font>

380
00:16:11,709 --> 00:16:14,800
<font color="#E5E5E5">started with the training part on the</font>

381
00:16:13,060 --> 00:16:16,239
<font color="#E5E5E5">top right where he had to talk about</font>

382
00:16:14,800 --> 00:16:19,628
defeating<font color="#E5E5E5"> memory for instance we just</font>

383
00:16:16,240 --> 00:16:23,199
<font color="#CCCCCC">started looking at that okay so that's</font>

384
00:16:19,629 --> 00:16:26,680
<font color="#CCCCCC">gonna</font><font color="#E5E5E5"> be it for the theory</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the of the</font>

385
00:16:23,199 --> 00:16:28,930
talk<font color="#E5E5E5"> okay obviously being that a</font>

386
00:16:26,680 --> 00:16:31,209
challenge<font color="#CCCCCC"> okay at some point the</font>

387
00:16:28,930 --> 00:16:32,800
challenge had to<font color="#CCCCCC"> occur okay that was</font>

388
00:16:31,209 --> 00:16:35,589
remember a challenge that<font color="#E5E5E5"> was thrown to</font>

389
00:16:32,800 --> 00:16:37,839
me by this<font color="#E5E5E5"> guy okay so on that first</font>

390
00:16:35,589 --> 00:16:38,620
presentation I made<font color="#CCCCCC"> of these results</font><font color="#E5E5E5"> at</font>

391
00:16:37,839 --> 00:16:42,009
<font color="#E5E5E5">this point</font>

392
00:16:38,620 --> 00:16:45,180
<font color="#E5E5E5">okay well the</font><font color="#CCCCCC"> channeling had to be</font>

393
00:16:42,009 --> 00:16:47,470
placed so what were the rules and the

394
00:16:45,180 --> 00:16:49,839
conditions for the challenge<font color="#E5E5E5"> okay what</font>

395
00:16:47,470 --> 00:16:51,759
<font color="#CCCCCC">two representative on the stage</font><font color="#E5E5E5"> okay one</font>

396
00:16:49,839 --> 00:16:53,920
would be the Spanish<font color="#E5E5E5"> team that would be</font>

397
00:16:51,759 --> 00:16:55,689
<font color="#E5E5E5">me that would be the offensive guy and</font>

398
00:16:53,920 --> 00:16:57,370
on the other side<font color="#CCCCCC"> will</font><font color="#E5E5E5"> have the the</font>

399
00:16:55,689 --> 00:16:59,800
<font color="#CCCCCC">finish team that's from Finland that</font>

400
00:16:57,370 --> 00:17:02,829
<font color="#CCCCCC">would be Toby</font><font color="#E5E5E5"> that you saw over there</font>

401
00:16:59,800 --> 00:17:05,438
<font color="#E5E5E5">okay now</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> goal for the Spanish team</font>

402
00:17:02,829 --> 00:17:08,799
would<font color="#CCCCCC"> be to avoid</font><font color="#E5E5E5"> the detection of my</font>

403
00:17:05,439 --> 00:17:11,199
implant<font color="#E5E5E5"> okay by</font><font color="#CCCCCC"> the Finnish team while</font>

404
00:17:08,799 --> 00:17:14,319
the<font color="#E5E5E5"> Finnish team goal would be to detect</font>

405
00:17:11,199 --> 00:17:17,799
my implant<font color="#E5E5E5"> in a memory</font><font color="#CCCCCC"> DOM</font><font color="#E5E5E5"> using memory</font>

406
00:17:14,319 --> 00:17:20,889
forensic techniques<font color="#E5E5E5"> now the target the</font>

407
00:17:17,799 --> 00:17:23,049
target<font color="#E5E5E5"> had to be also agreed right okay</font>

408
00:17:20,890 --> 00:17:27,699
we agreed<font color="#E5E5E5"> that the target would be a</font>

409
00:17:23,049 --> 00:17:29,679
Windows 10<font color="#E5E5E5"> okay machine infected now to</font>

410
00:17:27,699 --> 00:17:32,200
make it<font color="#E5E5E5"> a</font><font color="#CCCCCC"> little bit more easy</font><font color="#E5E5E5"> for them</font>

411
00:17:29,679 --> 00:17:35,950
not<font color="#E5E5E5"> that much for me we also agreed that</font>

412
00:17:32,200 --> 00:17:38,250
the machine would<font color="#CCCCCC"> have to be infected</font>

413
00:17:35,950 --> 00:17:41,500
<font color="#CCCCCC">with a very specific implant a</font>

414
00:17:38,250 --> 00:17:43,720
meterpreter by<font color="#E5E5E5"> Metasploit framework one</font>

415
00:17:41,500 --> 00:17:46,929
of the easiest<font color="#E5E5E5"> implants to detect by</font>

416
00:17:43,720 --> 00:17:48,610
memory for each other<font color="#CCCCCC"> okay so my goal</font>

417
00:17:46,929 --> 00:17:50,500
was not to hide one<font color="#CCCCCC"> of my own</font>

418
00:17:48,610 --> 00:17:53,020
developments and<font color="#E5E5E5"> told that</font><font color="#CCCCCC"> with my</font>

419
00:17:50,500 --> 00:17:54,789
<font color="#CCCCCC">advantage but to hide something</font><font color="#E5E5E5"> well</font>

420
00:17:53,020 --> 00:17:58,929
<font color="#E5E5E5">known and well known to be easy to</font>

421
00:17:54,789 --> 00:18:01,360
detect<font color="#E5E5E5"> okay obviously</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> needed a</font>

422
00:17:58,929 --> 00:18:03,309
referee because<font color="#CCCCCC"> well</font><font color="#E5E5E5"> that's a challenge</font>

423
00:18:01,360 --> 00:18:04,750
and we<font color="#E5E5E5"> are gonna be cheating not the</font>

424
00:18:03,309 --> 00:18:06,639
finish but I'm<font color="#E5E5E5"> a Spanish so I'm gonna be</font>

425
00:18:04,750 --> 00:18:10,519
cheating<font color="#E5E5E5"> okay</font>

426
00:18:06,639 --> 00:18:12,678
let's be honest<font color="#E5E5E5"> so that was the guy that</font>

427
00:18:10,519 --> 00:18:14,690
<font color="#E5E5E5">was</font><font color="#CCCCCC"> a well-known</font><font color="#E5E5E5"> memory forensics</font>

428
00:18:12,679 --> 00:18:17,210
<font color="#E5E5E5">analysts expert also one of the guys I</font>

429
00:18:14,690 --> 00:18:19,940
<font color="#CCCCCC">was</font><font color="#E5E5E5"> asking about in one</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> previous</font>

430
00:18:17,210 --> 00:18:22,100
<font color="#E5E5E5">slides</font><font color="#CCCCCC"> and he would be the</font><font color="#E5E5E5"> one taking</font>

431
00:18:19,940 --> 00:18:22,940
<font color="#E5E5E5">care</font><font color="#CCCCCC"> of the of making sure that</font>

432
00:18:22,100 --> 00:18:26,090
everything was<font color="#CCCCCC"> in place</font>

433
00:18:22,940 --> 00:18:28,480
<font color="#E5E5E5">okay and well that's</font><font color="#CCCCCC"> the sentence he he</font>

434
00:18:26,090 --> 00:18:31,879
<font color="#E5E5E5">told about me when</font><font color="#CCCCCC"> I explained how I</font>

435
00:18:28,480 --> 00:18:32,570
defeated this<font color="#E5E5E5"> okay and</font><font color="#CCCCCC"> obviously as any</font>

436
00:18:31,879 --> 00:18:36,949
other challenge

437
00:18:32,570 --> 00:18:40,158
<font color="#CCCCCC">it must be rules okay now at some point</font>

438
00:18:36,950 --> 00:18:42,740
we did the challenge<font color="#CCCCCC"> took place</font><font color="#E5E5E5"> okay and</font>

439
00:18:40,159 --> 00:18:45,379
at some<font color="#E5E5E5"> point we had</font><font color="#CCCCCC"> to decide</font><font color="#E5E5E5"> if I had</font>

440
00:18:42,740 --> 00:18:48,169
been<font color="#CCCCCC"> beaten or</font><font color="#E5E5E5"> if he had been</font><font color="#CCCCCC"> in instead</font>

441
00:18:45,379 --> 00:18:50,600
okay well obviously we don't<font color="#E5E5E5"> have time</font>

442
00:18:48,169 --> 00:18:52,399
<font color="#E5E5E5">here</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> actually make the challenge</font>

443
00:18:50,600 --> 00:18:54,830
happen but let me explain<font color="#CCCCCC"> something that</font>

444
00:18:52,399 --> 00:18:56,809
<font color="#CCCCCC">I can</font><font color="#E5E5E5"> show in the after talk one thing</font>

445
00:18:54,830 --> 00:18:58,759
<font color="#CCCCCC">when I was considering for the challenge</font>

446
00:18:56,809 --> 00:19:00,499
<font color="#CCCCCC">okay for</font><font color="#E5E5E5"> this guy to come into the stage</font>

447
00:18:58,759 --> 00:19:02,809
<font color="#CCCCCC">take</font><font color="#E5E5E5"> control of the</font><font color="#CCCCCC"> machine</font><font color="#E5E5E5"> and do a</font>

448
00:19:00,499 --> 00:19:05,029
<font color="#E5E5E5">live memory</font><font color="#CCCCCC"> forensic</font><font color="#E5E5E5"> analysis of that</font>

449
00:19:02,809 --> 00:19:07,340
machine would<font color="#CCCCCC"> be that in the end for</font><font color="#E5E5E5"> the</font>

450
00:19:05,029 --> 00:19:09,950
attendees<font color="#E5E5E5"> that would be black screen</font>

451
00:19:07,340 --> 00:19:11,449
with<font color="#CCCCCC"> the terminal in a lot</font><font color="#E5E5E5"> of comments</font>

452
00:19:09,950 --> 00:19:13,399
and letters and<font color="#CCCCCC"> text going</font><font color="#E5E5E5"> up and down</font>

453
00:19:11,450 --> 00:19:17,389
<font color="#E5E5E5">and everybody would be you know like him</font>

454
00:19:13,399 --> 00:19:19,580
like falling<font color="#CCCCCC"> asleep right so that was I</font>

455
00:19:17,389 --> 00:19:23,149
was not<font color="#E5E5E5"> realized I don't have classes</font>

456
00:19:19,580 --> 00:19:24,860
but I<font color="#E5E5E5"> kind of show you okay so that was</font>

457
00:19:23,149 --> 00:19:26,570
not<font color="#CCCCCC"> a good ideas I decided I needed the</font>

458
00:19:24,860 --> 00:19:28,189
graphical user interface<font color="#E5E5E5"> I need to make</font>

459
00:19:26,570 --> 00:19:31,490
it<font color="#E5E5E5"> more visual for the attendees and</font>

460
00:19:28,190 --> 00:19:33,649
there happened to be some some user

461
00:19:31,490 --> 00:19:35,360
interfaces for<font color="#E5E5E5"> volatility recall this</font>

462
00:19:33,649 --> 00:19:36,739
memory forensic tools but<font color="#CCCCCC"> they're</font>

463
00:19:35,360 --> 00:19:39,168
web-based and<font color="#CCCCCC"> Indian is just the same</font>

464
00:19:36,740 --> 00:19:42,320
<font color="#E5E5E5">but inside a web browser so point was</font>

465
00:19:39,169 --> 00:19:45,379
defeated<font color="#E5E5E5"> right so what I</font><font color="#CCCCCC"> did instead was</font>

466
00:19:42,320 --> 00:19:47,090
<font color="#CCCCCC">to develop</font><font color="#E5E5E5"> my own GUI graphical user</font>

467
00:19:45,379 --> 00:19:48,889
interface with a twist

468
00:19:47,090 --> 00:19:52,639
<font color="#CCCCCC">let me show you this if I can manage</font>

469
00:19:48,889 --> 00:20:09,949
<font color="#E5E5E5">okay this is the life one of</font><font color="#CCCCCC"> the live</font>

470
00:19:52,639 --> 00:20:13,309
<font color="#CCCCCC">the</font><font color="#E5E5E5"> most of this</font><font color="#CCCCCC"> only</font><font color="#E5E5E5"> before the</font>

471
00:20:09,950 --> 00:20:16,039
presentation<font color="#E5E5E5"> okay so what I did is</font>

472
00:20:13,309 --> 00:20:18,529
instead<font color="#CCCCCC"> of</font><font color="#E5E5E5"> creating a graphical user</font>

473
00:20:16,039 --> 00:20:19,280
interface I decided to change the

474
00:20:18,529 --> 00:20:21,690
meaning<font color="#CCCCCC"> of</font><font color="#E5E5E5"> the</font>

475
00:20:19,280 --> 00:20:25,530
instead of a graphical user interface I

476
00:20:21,690 --> 00:20:27,450
created a game<font color="#CCCCCC"> user</font><font color="#E5E5E5"> interface so I</font>

477
00:20:25,530 --> 00:20:30,420
created something that<font color="#CCCCCC"> I called many</font>

478
00:20:27,450 --> 00:20:32,820
sick mansion<font color="#CCCCCC"> it's a reference</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> an old</font>

479
00:20:30,420 --> 00:20:36,420
game that<font color="#CCCCCC"> I like to play okay</font><font color="#E5E5E5"> so what I</font>

480
00:20:32,820 --> 00:20:38,310
created is this let me press that<font color="#E5E5E5"> so</font>

481
00:20:36,420 --> 00:20:40,530
this<font color="#CCCCCC"> is the map of</font><font color="#E5E5E5"> the game okay</font>

482
00:20:38,310 --> 00:20:41,370
that's where our<font color="#CCCCCC"> player</font><font color="#E5E5E5"> start in here</font>

483
00:20:40,530 --> 00:20:45,180
<font color="#E5E5E5">okay</font>

484
00:20:41,370 --> 00:20:48,149
the numbers are the locations for the

485
00:20:45,180 --> 00:20:48,780
<font color="#CCCCCC">host the people in that mansion here</font>

486
00:20:48,150 --> 00:20:51,360
<font color="#E5E5E5">okay</font>

487
00:20:48,780 --> 00:20:53,490
and each<font color="#E5E5E5"> I mean what</font><font color="#CCCCCC"> you're</font><font color="#E5E5E5"> seeing here</font>

488
00:20:51,360 --> 00:20:56,070
<font color="#CCCCCC">is a visual representation</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> the memory</font>

489
00:20:53,490 --> 00:20:58,350
<font color="#E5E5E5">layout of a Windows machine</font><font color="#CCCCCC"> actually the</font>

490
00:20:56,070 --> 00:21:00,149
<font color="#CCCCCC">user</font><font color="#E5E5E5"> space the kernel space is the</font>

491
00:20:58,350 --> 00:21:01,679
<font color="#E5E5E5">basement and it's like the hidden part</font>

492
00:21:00,150 --> 00:21:03,120
of<font color="#E5E5E5"> the game right</font><font color="#CCCCCC"> here in order</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> be</font>

493
00:21:01,680 --> 00:21:04,220
able<font color="#E5E5E5"> to</font><font color="#CCCCCC"> go</font><font color="#E5E5E5"> down</font><font color="#CCCCCC"> to the condo space you</font>

494
00:21:03,120 --> 00:21:08,340
have<font color="#CCCCCC"> to</font><font color="#E5E5E5"> find your</font><font color="#CCCCCC"> way in</font>

495
00:21:04,220 --> 00:21:11,190
<font color="#E5E5E5">okay so each of these rooms</font><font color="#CCCCCC"> okay that</font>

496
00:21:08,340 --> 00:21:15,659
has a number<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> it's hosting a guest</font>

497
00:21:11,190 --> 00:21:18,870
of that house<font color="#CCCCCC"> while in the one</font><font color="#E5E5E5"> over</font><font color="#CCCCCC"> here</font>

498
00:21:15,660 --> 00:21:21,600
we have the common area<font color="#E5E5E5"> so in here you</font>

499
00:21:18,870 --> 00:21:23,969
have dynamically created a<font color="#E5E5E5"> different</font>

500
00:21:21,600 --> 00:21:26,610
guest<font color="#E5E5E5"> one for each of</font><font color="#CCCCCC"> the common</font>

501
00:21:23,970 --> 00:21:29,190
processes<font color="#E5E5E5"> of a normally running Windows</font>

502
00:21:26,610 --> 00:21:30,899
machine<font color="#E5E5E5"> okay there is a plugin for</font>

503
00:21:29,190 --> 00:21:33,030
volatility that<font color="#CCCCCC"> you execute</font><font color="#E5E5E5"> is going to</font>

504
00:21:30,900 --> 00:21:34,320
tell you the common processes<font color="#E5E5E5"> that are</font>

505
00:21:33,030 --> 00:21:36,360
<font color="#E5E5E5">always found by default in the new</font>

506
00:21:34,320 --> 00:21:39,179
running<font color="#E5E5E5"> Windows machine all all those</font>

507
00:21:36,360 --> 00:21:41,610
<font color="#E5E5E5">are gonna be there</font><font color="#CCCCCC"> while the non common</font>

508
00:21:39,180 --> 00:21:44,640
ones are<font color="#E5E5E5"> all</font><font color="#CCCCCC"> gonna be</font><font color="#E5E5E5"> hosted in their</font>

509
00:21:41,610 --> 00:21:47,189
own specific rooms okay<font color="#E5E5E5"> and you're like</font>

510
00:21:44,640 --> 00:21:49,580
<font color="#CCCCCC">kind of a detective moving around</font><font color="#E5E5E5"> okay</font>

511
00:21:47,190 --> 00:21:52,140
and<font color="#CCCCCC"> you</font><font color="#E5E5E5"> have to query the different</font>

512
00:21:49,580 --> 00:21:54,330
guests on the party<font color="#E5E5E5"> okay and try</font><font color="#CCCCCC"> to</font>

513
00:21:52,140 --> 00:21:56,760
figure<font color="#E5E5E5"> out who steal something so you</font>

514
00:21:54,330 --> 00:21:59,790
have to find the your way you<font color="#E5E5E5"> have to</font>

515
00:21:56,760 --> 00:22:03,060
find the<font color="#CCCCCC"> guest</font><font color="#E5E5E5"> okay let me see yeah</font>

516
00:21:59,790 --> 00:22:04,980
so you move here<font color="#E5E5E5"> okay and I</font><font color="#CCCCCC"> think this</font>

517
00:22:03,060 --> 00:22:06,090
is the<font color="#E5E5E5"> butler this is going to be the</font>

518
00:22:04,980 --> 00:22:08,040
guy that<font color="#E5E5E5"> is going to be flipping you</font>

519
00:22:06,090 --> 00:22:11,429
okay<font color="#E5E5E5"> and that's the one that is gonna be</font>

520
00:22:08,040 --> 00:22:13,470
telling<font color="#E5E5E5"> you where</font><font color="#CCCCCC"> the guests are</font><font color="#E5E5E5"> you</font>

521
00:22:11,430 --> 00:22:14,910
have this help<font color="#E5E5E5"> you have the map you have</font>

522
00:22:13,470 --> 00:22:18,000
<font color="#CCCCCC">a bunch of</font><font color="#E5E5E5"> his</font><font color="#CCCCCC"> pals</font><font color="#E5E5E5"> because</font><font color="#CCCCCC"> well it's</font>

523
00:22:14,910 --> 00:22:21,060
kind of a fantasy<font color="#CCCCCC"> game</font><font color="#E5E5E5"> okay and if you</font><font color="#CCCCCC"> I</font>

524
00:22:18,000 --> 00:22:23,340
<font color="#CCCCCC">think it</font><font color="#E5E5E5"> was yeah it was</font><font color="#CCCCCC"> gee for</font><font color="#E5E5E5"> the</font>

525
00:22:21,060 --> 00:22:24,480
guests<font color="#E5E5E5"> okay makes sense right</font><font color="#CCCCCC"> so you can</font>

526
00:22:23,340 --> 00:22:26,909
see that<font color="#E5E5E5"> the regular guests</font>

527
00:22:24,480 --> 00:22:29,160
<font color="#E5E5E5">okay the guests in the common room here</font>

528
00:22:26,910 --> 00:22:31,050
are all normal<font color="#E5E5E5"> windows services plus be</font>

529
00:22:29,160 --> 00:22:32,370
built or box because that<font color="#E5E5E5"> was a</font><font color="#CCCCCC"> realtor</font>

530
00:22:31,050 --> 00:22:34,740
<font color="#E5E5E5">box machine and he</font>

531
00:22:32,370 --> 00:22:37,110
you have the non-common ones<font color="#CCCCCC"> okay that</font>

532
00:22:34,740 --> 00:22:39,180
was<font color="#E5E5E5"> not always present and you can use</font>

533
00:22:37,110 --> 00:22:41,729
numbers<font color="#CCCCCC"> to quickly jump between the</font>

534
00:22:39,180 --> 00:22:43,590
different places of the<font color="#E5E5E5"> game so instead</font>

535
00:22:41,730 --> 00:22:45,059
of watching<font color="#E5E5E5"> somebody typing you don't</font>

536
00:22:43,590 --> 00:22:46,559
want to<font color="#E5E5E5"> spend the whole hour go change</font>

537
00:22:45,059 --> 00:22:48,600
somebody walking<font color="#CCCCCC"> around in a game</font><font color="#E5E5E5"> right</font>

538
00:22:46,559 --> 00:22:50,430
<font color="#E5E5E5">okay so that was the game and</font><font color="#CCCCCC"> that's</font>

539
00:22:48,600 --> 00:22:51,929
<font color="#E5E5E5">something I can show you after the talk</font>

540
00:22:50,430 --> 00:22:53,640
that<font color="#CCCCCC"> we don't have</font><font color="#E5E5E5"> time in here and</font>

541
00:22:51,930 --> 00:22:55,350
that's what we use to<font color="#CCCCCC"> show the</font><font color="#E5E5E5"> people</font>

542
00:22:53,640 --> 00:22:57,960
how to<font color="#E5E5E5"> perform a memory</font><font color="#CCCCCC"> four and six in</font>

543
00:22:55,350 --> 00:22:59,879
a more<font color="#E5E5E5"> visual way okay and a little bit</font>

544
00:22:57,960 --> 00:23:02,640
more fun<font color="#CCCCCC"> okay that's a reason the</font><font color="#E5E5E5"> other</font>

545
00:22:59,880 --> 00:23:04,380
guy called me a lunatic<font color="#E5E5E5"> okay</font><font color="#CCCCCC"> so let me</font>

546
00:23:02,640 --> 00:23:06,150
go<font color="#CCCCCC"> back</font><font color="#E5E5E5"> to the slides and</font><font color="#CCCCCC"> we continue</font>

547
00:23:04,380 --> 00:23:07,920
okay<font color="#E5E5E5"> just one second</font><font color="#CCCCCC"> they're actually</font>

548
00:23:06,150 --> 00:23:10,240
quite good of time maybe I have time

549
00:23:07,920 --> 00:23:13,319
after<font color="#CCCCCC"> the talk</font><font color="#E5E5E5"> to show it around okay</font>

550
00:23:10,240 --> 00:23:13,319
[Music]

551
00:23:20,180 --> 00:23:23,370
[Music]

552
00:23:22,160 --> 00:23:27,360
okay

553
00:23:23,370 --> 00:23:29,370
right<font color="#E5E5E5"> so in a normal presentation like</font>

554
00:23:27,360 --> 00:23:32,669
<font color="#CCCCCC">this one</font><font color="#E5E5E5"> but take it to our</font><font color="#CCCCCC"> system one</font>

555
00:23:29,370 --> 00:23:36,030
move<font color="#E5E5E5"> at this moment I would have</font><font color="#CCCCCC"> done</font>

556
00:23:32,670 --> 00:23:37,679
the analysis of the platform and we

557
00:23:36,030 --> 00:23:40,050
would have seen if he<font color="#E5E5E5"> managed or not to</font>

558
00:23:37,679 --> 00:23:42,390
find it<font color="#CCCCCC"> and in any</font><font color="#E5E5E5"> case now comes the</font>

559
00:23:40,050 --> 00:23:44,669
<font color="#CCCCCC">decode mode like in a good game right</font>

560
00:23:42,390 --> 00:23:47,580
<font color="#E5E5E5">I mean Spanish</font><font color="#CCCCCC"> you cheat you find a</font><font color="#E5E5E5"> good</font>

561
00:23:44,670 --> 00:23:49,679
mode<font color="#E5E5E5"> the god mode sorry and then you you</font>

562
00:23:47,580 --> 00:23:51,000
see<font color="#E5E5E5"> how it's it's working inside right I</font>

563
00:23:49,679 --> 00:23:52,920
don't<font color="#E5E5E5"> have this in Spanish guy here oh</font>

564
00:23:51,000 --> 00:23:56,250
he has<font color="#CCCCCC"> dealt with Spanish him before</font><font color="#E5E5E5"> and</font>

565
00:23:52,920 --> 00:23:59,940
he completely agrees with me<font color="#E5E5E5"> most</font>

566
00:23:56,250 --> 00:24:04,020
probably<font color="#E5E5E5"> in the second year okay</font><font color="#CCCCCC"> so for</font>

567
00:23:59,940 --> 00:24:05,910
<font color="#E5E5E5">your information by the way Tommy he</font>

568
00:24:04,020 --> 00:24:08,429
couldn't make<font color="#E5E5E5"> it healthy seus to that</font>

569
00:24:05,910 --> 00:24:10,470
challenge<font color="#E5E5E5"> what he says</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> issues I</font>

570
00:24:08,429 --> 00:24:13,559
said that he<font color="#E5E5E5"> was a scared so instead of</font>

571
00:24:10,470 --> 00:24:16,470
him the referee actually was performing

572
00:24:13,559 --> 00:24:19,440
the analysis for two weeks before the

573
00:24:16,470 --> 00:24:21,120
confidence<font color="#E5E5E5"> okay and life on the stage I</font>

574
00:24:19,440 --> 00:24:22,440
<font color="#E5E5E5">call him and</font><font color="#CCCCCC"> asked him if he had</font><font color="#E5E5E5"> managed</font>

575
00:24:21,120 --> 00:24:25,320
<font color="#E5E5E5">to find the implant or not the answer</font>

576
00:24:22,440 --> 00:24:27,600
was yes<font color="#CCCCCC"> then I talked him but you found</font>

577
00:24:25,320 --> 00:24:29,399
both<font color="#E5E5E5"> of them or just one in his a just</font>

578
00:24:27,600 --> 00:24:30,959
one and you didn't find<font color="#E5E5E5"> it</font><font color="#CCCCCC"> because I</font>

579
00:24:29,400 --> 00:24:33,750
actually placed one normal<font color="#CCCCCC"> metal brother</font>

580
00:24:30,960 --> 00:24:36,450
so you<font color="#CCCCCC"> could see something here</font><font color="#E5E5E5"> but not</font>

581
00:24:33,750 --> 00:24:39,650
<font color="#E5E5E5">the the hidden one okay so let's go to</font>

582
00:24:36,450 --> 00:24:44,220
the god mode<font color="#E5E5E5"> okay</font>

583
00:24:39,650 --> 00:24:46,110
yep so when I was after<font color="#E5E5E5"> studying a</font>

584
00:24:44,220 --> 00:24:48,660
<font color="#E5E5E5">little bit memory and memory forensics I</font>

585
00:24:46,110 --> 00:24:51,120
was trying to<font color="#E5E5E5"> decide how</font><font color="#CCCCCC"> to do that okay</font>

586
00:24:48,660 --> 00:24:54,210
<font color="#CCCCCC">I kind of impose myself</font><font color="#E5E5E5"> a bunch of</font>

587
00:24:51,120 --> 00:24:56,600
<font color="#E5E5E5">requirements</font><font color="#CCCCCC"> okay whatever</font><font color="#E5E5E5"> solution or</font>

588
00:24:54,210 --> 00:25:00,030
approach I decided to follow how to

589
00:24:56,600 --> 00:25:02,899
require<font color="#E5E5E5"> no deep operating system</font>

590
00:25:00,030 --> 00:25:05,430
<font color="#E5E5E5">whatever memory skills okay</font>

591
00:25:02,900 --> 00:25:09,450
whatever the<font color="#E5E5E5"> solution would require no</font>

592
00:25:05,430 --> 00:25:12,630
deep memory forensic skills and whatever

593
00:25:09,450 --> 00:25:15,480
the solution had<font color="#E5E5E5"> to be multi-platform</font>

594
00:25:12,630 --> 00:25:17,520
<font color="#E5E5E5">because I don't work much if I can work</font>

595
00:25:15,480 --> 00:25:20,160
less<font color="#E5E5E5"> okay so if you do it do it well now</font>

596
00:25:17,520 --> 00:25:24,600
why of this requirement<font color="#CCCCCC"> obviously if I</font>

597
00:25:20,160 --> 00:25:26,760
try to defeat<font color="#E5E5E5"> that by using deep memory</font>

598
00:25:24,600 --> 00:25:29,370
or memory forensic skills<font color="#E5E5E5"> I will</font><font color="#CCCCCC"> try to</font>

599
00:25:26,760 --> 00:25:32,280
<font color="#E5E5E5">play this game in my</font><font color="#CCCCCC"> opponent's train</font>

600
00:25:29,370 --> 00:25:33,689
his area of expertise<font color="#E5E5E5"> that's that's not</font>

601
00:25:32,280 --> 00:25:35,550
going<font color="#E5E5E5"> to work because I mean I've been</font>

602
00:25:33,690 --> 00:25:37,800
<font color="#E5E5E5">studying</font><font color="#CCCCCC"> that for</font><font color="#E5E5E5"> I don't know six</font>

603
00:25:35,550 --> 00:25:39,330
months<font color="#E5E5E5"> by that time and he had</font><font color="#CCCCCC"> been</font><font color="#E5E5E5"> six</font>

604
00:25:37,800 --> 00:25:40,740
years<font color="#E5E5E5"> ten years whereas he is always</font>

605
00:25:39,330 --> 00:25:42,540
<font color="#E5E5E5">gonna know more than me</font>

606
00:25:40,740 --> 00:25:47,160
<font color="#CCCCCC">about memory and</font><font color="#E5E5E5"> memory forensics right</font>

607
00:25:42,540 --> 00:25:49,860
not good<font color="#E5E5E5"> so instead of that I had to</font>

608
00:25:47,160 --> 00:25:53,250
find<font color="#E5E5E5"> a</font><font color="#CCCCCC"> different way so what way do we</font>

609
00:25:49,860 --> 00:25:54,600
<font color="#E5E5E5">avoid the presence detection so you</font>

610
00:25:53,250 --> 00:25:57,680
<font color="#CCCCCC">compromised</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> Machine</font><font color="#E5E5E5"> you do</font>

611
00:25:54,600 --> 00:25:59,610
<font color="#E5E5E5">absolutely nothing to make anybody</font>

612
00:25:57,680 --> 00:26:00,900
suspicious that you are there<font color="#E5E5E5"> so</font>

613
00:25:59,610 --> 00:26:03,389
nobody's going<font color="#CCCCCC"> to be looking for you and</font>

614
00:26:00,900 --> 00:26:05,730
then<font color="#CCCCCC"> your hidden cannot make sense</font><font color="#E5E5E5"> if a</font>

615
00:26:03,390 --> 00:26:08,760
problem<font color="#E5E5E5"> that was a challenge in which I</font>

616
00:26:05,730 --> 00:26:10,680
had<font color="#E5E5E5"> to provide the the</font><font color="#CCCCCC"> victim</font><font color="#E5E5E5"> the memory</font>

617
00:26:08,760 --> 00:26:12,240
<font color="#E5E5E5">dump so already</font><font color="#CCCCCC"> the suspicious was there</font>

618
00:26:10,680 --> 00:26:15,000
right<font color="#E5E5E5"> so not really gonna work at least</font>

619
00:26:12,240 --> 00:26:17,220
<font color="#E5E5E5">for</font><font color="#CCCCCC"> the challenge</font><font color="#E5E5E5"> avoid that position</font>

620
00:26:15,000 --> 00:26:19,190
what does it mean it means<font color="#E5E5E5"> that most of</font>

621
00:26:17,220 --> 00:26:21,990
<font color="#E5E5E5">the time the analysis of the memory of</font>

622
00:26:19,190 --> 00:26:24,240
suspicious machine is not performed live

623
00:26:21,990 --> 00:26:26,490
what you do is<font color="#E5E5E5"> to connect something into</font>

624
00:26:24,240 --> 00:26:28,380
that<font color="#CCCCCC"> computer and you make a memory</font><font color="#E5E5E5"> dump</font>

625
00:26:26,490 --> 00:26:29,910
<font color="#E5E5E5">you</font><font color="#CCCCCC"> made like taking a snapshot of</font><font color="#E5E5E5"> the</font>

626
00:26:28,380 --> 00:26:31,620
running memory in that<font color="#E5E5E5"> moment and then</font>

627
00:26:29,910 --> 00:26:33,150
<font color="#CCCCCC">you take it</font><font color="#E5E5E5"> offline to your own</font><font color="#CCCCCC"> analyst</font>

628
00:26:31,620 --> 00:26:35,840
<font color="#E5E5E5">laptop and you do the analysis there</font>

629
00:26:33,150 --> 00:26:39,330
right<font color="#CCCCCC"> so maybe the approach would be to</font>

630
00:26:35,840 --> 00:26:41,459
<font color="#E5E5E5">do something to prevent my implant for</font>

631
00:26:39,330 --> 00:26:44,460
being copied<font color="#E5E5E5"> if such a thing happens</font>

632
00:26:41,460 --> 00:26:46,440
<font color="#E5E5E5">okay</font><font color="#CCCCCC"> it would be tricky because</font><font color="#E5E5E5"> in the</font>

633
00:26:44,460 --> 00:26:48,420
end I'm giving the memory dump for the

634
00:26:46,440 --> 00:26:51,900
challenge right<font color="#E5E5E5"> so how can I prove that</font>

635
00:26:48,420 --> 00:26:53,010
<font color="#CCCCCC">I not really working another option</font>

636
00:26:51,900 --> 00:26:56,280
would be to<font color="#E5E5E5"> abort</font>

637
00:26:53,010 --> 00:26:57,690
the analyst detection say so they have

638
00:26:56,280 --> 00:26:59,309
the implant they have<font color="#E5E5E5"> the memory</font><font color="#CCCCCC"> damn</font><font color="#E5E5E5"> it</font>

639
00:26:57,690 --> 00:27:01,230
is there<font color="#E5E5E5"> but somehow you managed to</font>

640
00:26:59,309 --> 00:27:02,668
<font color="#E5E5E5">avoid them detecting you that's where we</font>

641
00:27:01,230 --> 00:27:05,309
come<font color="#E5E5E5"> to the requirement</font><font color="#CCCCCC"> that would</font>

642
00:27:02,669 --> 00:27:07,440
require usually memory or memory

643
00:27:05,309 --> 00:27:10,200
financing schemes to try to find some

644
00:27:07,440 --> 00:27:12,270
hidden property of the memory management

645
00:27:10,200 --> 00:27:14,220
of<font color="#CCCCCC"> Windows and how volatility or</font>

646
00:27:12,270 --> 00:27:15,780
whatever the tool is<font color="#E5E5E5"> doing that tricky</font>

647
00:27:14,220 --> 00:27:18,900
<font color="#CCCCCC">okay so what options do we have</font>

648
00:27:15,780 --> 00:27:20,879
<font color="#E5E5E5">one option is</font><font color="#CCCCCC"> just minding your own</font>

649
00:27:18,900 --> 00:27:23,100
business in memory<font color="#E5E5E5"> they detect you</font>

650
00:27:20,880 --> 00:27:26,280
trying to<font color="#E5E5E5"> avoid detection and well</font>

651
00:27:23,100 --> 00:27:28,139
delete a cube<font color="#E5E5E5"> bad luck the other option</font>

652
00:27:26,280 --> 00:27:30,270
is the<font color="#CCCCCC"> same but</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> kind of try to take</font>

653
00:27:28,140 --> 00:27:30,780
<font color="#E5E5E5">some active measures to avoid the</font>

654
00:27:30,270 --> 00:27:33,418
<font color="#E5E5E5">detection</font>

655
00:27:30,780 --> 00:27:36,928
<font color="#E5E5E5">somehow</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> but in the end if they find</font>

656
00:27:33,419 --> 00:27:40,559
<font color="#E5E5E5">you you're done</font><font color="#CCCCCC"> right now the third</font>

657
00:27:36,929 --> 00:27:42,360
option would be<font color="#CCCCCC"> to</font><font color="#E5E5E5"> well if they detect</font>

658
00:27:40,559 --> 00:27:44,428
you<font color="#E5E5E5"> okay you are trying to be a little</font>

659
00:27:42,360 --> 00:27:46,770
more<font color="#CCCCCC"> aggressive in</font><font color="#E5E5E5"> the way</font><font color="#CCCCCC"> you pre try</font>

660
00:27:44,429 --> 00:27:50,130
to to prevent the detection<font color="#E5E5E5"> right and</font>

661
00:27:46,770 --> 00:27:53,490
that's true<font color="#CCCCCC"> okay but at that</font><font color="#E5E5E5"> moment in</font>

662
00:27:50,130 --> 00:27:56,100
testimony of you can run<font color="#E5E5E5"> because they</font>

663
00:27:53,490 --> 00:27:58,590
already<font color="#E5E5E5"> know you're here</font><font color="#CCCCCC"> right so</font><font color="#E5E5E5"> I came</font>

664
00:27:56,100 --> 00:28:02,639
<font color="#E5E5E5">up</font><font color="#CCCCCC"> with the fourth option the one I like</font>

665
00:27:58,590 --> 00:28:05,340
it<font color="#E5E5E5"> if they are gonna find you well you</font>

666
00:28:02,640 --> 00:28:07,650
fight<font color="#E5E5E5"> and you fight back</font>

667
00:28:05,340 --> 00:28:09,209
<font color="#E5E5E5">okay that's what I call the offensive</font>

668
00:28:07,650 --> 00:28:11,460
approach remember the title of the<font color="#E5E5E5"> call</font>

669
00:28:09,210 --> 00:28:13,860
<font color="#E5E5E5">the top right so offensive memory</font>

670
00:28:11,460 --> 00:28:15,270
forensics now<font color="#E5E5E5"> let's say this is funny</font>

671
00:28:13,860 --> 00:28:16,740
<font color="#E5E5E5">this is okay but how will you implement</font>

672
00:28:15,270 --> 00:28:18,780
<font color="#E5E5E5">that</font><font color="#CCCCCC"> I mean the</font><font color="#E5E5E5"> idea is cool right</font>

673
00:28:16,740 --> 00:28:20,370
<font color="#CCCCCC">you're</font><font color="#E5E5E5"> bringing all that to your own</font>

674
00:28:18,780 --> 00:28:23,070
area<font color="#CCCCCC"> of expertise instead of their own</font>

675
00:28:20,370 --> 00:28:25,199
<font color="#E5E5E5">right that's kind of</font><font color="#CCCCCC"> the smart</font><font color="#E5E5E5"> yeah but</font>

676
00:28:23,070 --> 00:28:27,689
how do<font color="#E5E5E5"> you apply</font><font color="#CCCCCC"> that okay</font><font color="#E5E5E5"> let's see how</font>

677
00:28:25,200 --> 00:28:31,559
a<font color="#E5E5E5"> normal procedure of a memory analysis</font>

678
00:28:27,690 --> 00:28:34,620
works<font color="#E5E5E5"> okay still</font><font color="#CCCCCC"> gotten time great</font><font color="#E5E5E5"> so</font>

679
00:28:31,559 --> 00:28:36,840
let's say<font color="#E5E5E5"> that this Tommy</font>

680
00:28:34,620 --> 00:28:38,939
received<font color="#CCCCCC"> a memory dump</font><font color="#E5E5E5"> that we have here</font>

681
00:28:36,840 --> 00:28:42,750
on the<font color="#E5E5E5"> bottom okay now that Windows</font>

682
00:28:38,940 --> 00:28:46,470
machine<font color="#E5E5E5"> and he may</font><font color="#CCCCCC"> be using tools like</font>

683
00:28:42,750 --> 00:28:49,799
<font color="#CCCCCC">redline</font><font color="#E5E5E5"> Volare volatility recall</font>

684
00:28:46,470 --> 00:28:52,799
<font color="#E5E5E5">whatever to</font><font color="#CCCCCC"> analyzing okay so what he</font>

685
00:28:49,799 --> 00:28:54,929
<font color="#E5E5E5">does</font><font color="#CCCCCC"> okay it's our of course obviously</font>

686
00:28:52,799 --> 00:28:56,910
sorry for that<font color="#E5E5E5"> the memory</font><font color="#CCCCCC"> dam has this</font>

687
00:28:54,929 --> 00:28:59,340
tiny<font color="#CCCCCC"> meterpreter</font><font color="#E5E5E5"> because we are not</font>

688
00:28:56,910 --> 00:29:01,260
preventing the<font color="#E5E5E5"> creation okay the metal</font>

689
00:28:59,340 --> 00:29:03,149
<font color="#E5E5E5">pattern is there</font><font color="#CCCCCC"> oh</font><font color="#E5E5E5"> whatever the</font>

690
00:29:01,260 --> 00:29:06,360
implants<font color="#E5E5E5"> okay so first thing he does is</font>

691
00:29:03,150 --> 00:29:08,630
well he triggers<font color="#E5E5E5"> one of those tools</font>

692
00:29:06,360 --> 00:29:11,639
and<font color="#E5E5E5"> tells them okay hello volatility or</font>

693
00:29:08,630 --> 00:29:13,320
<font color="#CCCCCC">redline</font><font color="#E5E5E5"> get me whatever amount of</font>

694
00:29:11,640 --> 00:29:16,020
<font color="#CCCCCC">information</font><font color="#E5E5E5"> a specific amount of</font>

695
00:29:13,320 --> 00:29:17,460
<font color="#E5E5E5">information on that memory</font><font color="#CCCCCC"> dam</font><font color="#E5E5E5"> okay so</font>

696
00:29:16,020 --> 00:29:19,560
in the case<font color="#CCCCCC"> of volatility or recall</font>

697
00:29:17,460 --> 00:29:22,830
you're executing a<font color="#CCCCCC"> plug-in</font><font color="#E5E5E5"> it's planning</font>

698
00:29:19,560 --> 00:29:24,389
is a specific action and to request<font color="#E5E5E5"> for</font>

699
00:29:22,830 --> 00:29:26,220
<font color="#E5E5E5">something like for</font><font color="#CCCCCC"> example I have this</font>

700
00:29:24,390 --> 00:29:27,990
anonymous<font color="#E5E5E5"> memory</font><font color="#CCCCCC"> dump</font><font color="#E5E5E5"> tell me what</font>

701
00:29:26,220 --> 00:29:30,240
platform it came from is<font color="#CCCCCC"> that Windows</font><font color="#E5E5E5"> is</font>

702
00:29:27,990 --> 00:29:33,390
<font color="#CCCCCC">Allah knows its SX whatever</font>

703
00:29:30,240 --> 00:29:34,650
so obviously the<font color="#E5E5E5"> plug-in is going to go</font>

704
00:29:33,390 --> 00:29:36,390
to volatility that<font color="#E5E5E5"> it's going to go to</font>

705
00:29:34,650 --> 00:29:39,240
<font color="#E5E5E5">Python and whatever the tool is gonna</font>

706
00:29:36,390 --> 00:29:40,920
end up<font color="#E5E5E5"> querying reading and I seen</font>

707
00:29:39,240 --> 00:29:43,560
something<font color="#E5E5E5"> from the memory dump</font>

708
00:29:40,920 --> 00:29:45,600
okay now that information<font color="#CCCCCC"> is</font><font color="#E5E5E5"> going to go</font>

709
00:29:43,560 --> 00:29:48,149
back<font color="#E5E5E5"> to the tool that in turn is gonna</font>

710
00:29:45,600 --> 00:29:50,189
end up<font color="#E5E5E5"> being presented to Tommy</font><font color="#CCCCCC"> okay</font>

711
00:29:48,150 --> 00:29:52,800
that's pretty<font color="#CCCCCC"> much how it works okay now</font>

712
00:29:50,190 --> 00:29:55,050
it's his job<font color="#E5E5E5"> and expertise and skills to</font>

713
00:29:52,800 --> 00:29:56,610
properly<font color="#CCCCCC"> analyze the information that he</font>

714
00:29:55,050 --> 00:29:58,710
receives and follow the rules<font color="#E5E5E5"> and the</font>

715
00:29:56,610 --> 00:30:04,790
clues and<font color="#CCCCCC"> try to find</font><font color="#E5E5E5"> what</font><font color="#CCCCCC"> be</font><font color="#E5E5E5"> some</font>

716
00:29:58,710 --> 00:30:09,270
memory<font color="#CCCCCC"> okay now what if on</font><font color="#E5E5E5"> top of</font>

717
00:30:04,790 --> 00:30:12,389
meterpreter<font color="#E5E5E5"> okay do add something else</font>

718
00:30:09,270 --> 00:30:14,010
<font color="#E5E5E5">on</font><font color="#CCCCCC"> that memory dump not</font><font color="#E5E5E5"> on the memory</font>

719
00:30:12,390 --> 00:30:15,750
<font color="#E5E5E5">line itself</font><font color="#CCCCCC"> right</font><font color="#E5E5E5"> but on the compromised</font>

720
00:30:14,010 --> 00:30:19,950
<font color="#E5E5E5">machine</font><font color="#CCCCCC"> so it's</font><font color="#E5E5E5"> going</font><font color="#CCCCCC"> to end up in the</font>

721
00:30:15,750 --> 00:30:23,760
memory<font color="#CCCCCC"> Dom</font><font color="#E5E5E5"> okay and that something else</font>

722
00:30:19,950 --> 00:30:25,440
when the tools are reading the memory so

723
00:30:23,760 --> 00:30:31,020
are actually touching<font color="#CCCCCC"> this memory dump</font>

724
00:30:25,440 --> 00:30:34,620
somehow<font color="#E5E5E5"> okay managed to copy itself okay</font>

725
00:30:31,020 --> 00:30:37,950
into<font color="#E5E5E5"> the running space</font><font color="#CCCCCC"> okay the visual</font>

726
00:30:34,620 --> 00:30:41,280
memory<font color="#CCCCCC"> of those tools</font><font color="#E5E5E5"> and after that</font>

727
00:30:37,950 --> 00:30:43,110
<font color="#E5E5E5">okay the only purpose of this something</font>

728
00:30:41,280 --> 00:30:45,870
that<font color="#E5E5E5"> we will see is just to make sure</font>

729
00:30:43,110 --> 00:30:47,040
<font color="#E5E5E5">that whatever information goes back to</font>

730
00:30:45,870 --> 00:30:50,879
Tommy is tainted

731
00:30:47,040 --> 00:30:53,639
so we hide whatever we want to have

732
00:30:50,880 --> 00:30:55,830
hidden<font color="#E5E5E5"> okay</font><font color="#CCCCCC"> I mean that's the concern</font>

733
00:30:53,640 --> 00:30:57,660
okay<font color="#E5E5E5"> that would be cool right</font><font color="#CCCCCC"> so it's</font>

734
00:30:55,830 --> 00:31:00,689
<font color="#E5E5E5">like a rootkit okay you would you get it</font>

735
00:30:57,660 --> 00:31:03,030
there and you're<font color="#CCCCCC"> just making</font><font color="#E5E5E5"> sure</font><font color="#CCCCCC"> that</font>

736
00:31:00,690 --> 00:31:05,490
the<font color="#E5E5E5"> information</font><font color="#CCCCCC"> that you</font><font color="#E5E5E5"> want is kept</font>

737
00:31:03,030 --> 00:31:06,810
<font color="#E5E5E5">hidden from Tommy if Tommy is not</font><font color="#CCCCCC"> able</font>

738
00:31:05,490 --> 00:31:09,270
is not receiving<font color="#CCCCCC"> that from the tools</font>

739
00:31:06,810 --> 00:31:11,370
there is<font color="#E5E5E5"> no clues to follow</font><font color="#CCCCCC"> it's hard to</font>

740
00:31:09,270 --> 00:31:13,470
find<font color="#E5E5E5"> anything right now how do you find</font>

741
00:31:11,370 --> 00:31:16,139
that<font color="#E5E5E5"> in the</font><font color="#CCCCCC"> specific case</font><font color="#E5E5E5"> of volatility</font>

742
00:31:13,470 --> 00:31:18,420
for example<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> if you take a look at</font>

743
00:31:16,140 --> 00:31:20,250
how volatile it is made you<font color="#CCCCCC"> can see that</font>

744
00:31:18,420 --> 00:31:24,090
<font color="#E5E5E5">its volatility</font>

745
00:31:20,250 --> 00:31:26,940
some common class to deal with a massive

746
00:31:24,090 --> 00:31:30,149
<font color="#E5E5E5">amount of plugins so volatility is</font>

747
00:31:26,940 --> 00:31:32,610
pretty much all about plugins<font color="#E5E5E5"> okay so</font>

748
00:31:30,150 --> 00:31:36,000
what I<font color="#E5E5E5"> did I was looking for</font>

749
00:31:32,610 --> 00:31:38,280
vulnerabilities here<font color="#CCCCCC"> okay so you have</font>

750
00:31:36,000 --> 00:31:41,460
volatility<font color="#E5E5E5"> that</font><font color="#CCCCCC"> is just a Python program</font>

751
00:31:38,280 --> 00:31:43,860
you have<font color="#E5E5E5"> the plug-in</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> you are</font>

752
00:31:41,460 --> 00:31:46,380
actually<font color="#E5E5E5"> executing okay that it's</font>

753
00:31:43,860 --> 00:31:50,100
program in Python<font color="#E5E5E5"> so in your execution</font>

754
00:31:46,380 --> 00:31:52,010
Python that most commonly<font color="#E5E5E5"> 99% of the</font>

755
00:31:50,100 --> 00:31:54,480
time is using some<font color="#E5E5E5"> Python modules</font>

756
00:31:52,010 --> 00:31:57,000
usually developed by some third parties

757
00:31:54,480 --> 00:31:57,630
so volatility may be<font color="#E5E5E5"> properly coded and</font>

758
00:31:57,000 --> 00:31:59,640
<font color="#CCCCCC">I'll read</font><font color="#E5E5E5"> it</font>

759
00:31:57,630 --> 00:32:01,470
Python for sure dis gonna be properly

760
00:31:59,640 --> 00:32:03,150
audited by now<font color="#E5E5E5"> okay three versions on</font>

761
00:32:01,470 --> 00:32:05,580
that most<font color="#E5E5E5"> police quite solid</font>

762
00:32:03,150 --> 00:32:07,110
but the<font color="#CCCCCC"> third-party</font><font color="#E5E5E5"> modules</font><font color="#CCCCCC"> the</font>

763
00:32:05,580 --> 00:32:08,340
libraries<font color="#E5E5E5"> we all know what happened with</font>

764
00:32:07,110 --> 00:32:10,320
<font color="#CCCCCC">that right there is something</font><font color="#E5E5E5"> going on</font>

765
00:32:08,340 --> 00:32:12,000
now with no GS that people is scared

766
00:32:10,320 --> 00:32:14,010
because<font color="#CCCCCC"> oh</font><font color="#E5E5E5"> nobody</font><font color="#CCCCCC"> is really taking care</font>

767
00:32:12,000 --> 00:32:16,470
<font color="#CCCCCC">for those third-party dependencies okay</font>

768
00:32:14,010 --> 00:32:19,590
so what I<font color="#E5E5E5"> decided to do is let's look</font>

769
00:32:16,470 --> 00:32:22,799
for some Python modules not volatility

770
00:32:19,590 --> 00:32:25,530
plugins but<font color="#E5E5E5"> Python modules okay that get</font>

771
00:32:22,799 --> 00:32:27,990
loaded<font color="#E5E5E5"> or used by pretty</font><font color="#CCCCCC"> much any</font>

772
00:32:25,530 --> 00:32:30,418
<font color="#E5E5E5">execution of volatility and then let's</font>

773
00:32:27,990 --> 00:32:33,720
look for vulnerabilities there looks

774
00:32:30,419 --> 00:32:37,919
like<font color="#E5E5E5"> the easiest path less resistance so</font>

775
00:32:33,720 --> 00:32:39,330
how do we<font color="#E5E5E5"> look for vulnerabilities</font><font color="#CCCCCC"> do we</font>

776
00:32:37,919 --> 00:32:41,309
do<font color="#CCCCCC"> fasting</font><font color="#E5E5E5"> okay</font>

777
00:32:39,330 --> 00:32:42,960
I'm mainly a researcher I'm not looking

778
00:32:41,309 --> 00:32:44,940
for gazillion bucks here so I usually

779
00:32:42,960 --> 00:32:45,419
<font color="#E5E5E5">don't do fasting like large-scale</font>

780
00:32:44,940 --> 00:32:48,120
fasting

781
00:32:45,419 --> 00:32:52,169
<font color="#E5E5E5">initially the money</font><font color="#CCCCCC"> narrative hunting</font>

782
00:32:48,120 --> 00:32:54,899
but in<font color="#E5E5E5"> this case Spanish</font><font color="#CCCCCC"> cheaters but we</font>

783
00:32:52,169 --> 00:32:56,850
are also lazy<font color="#CCCCCC"> so what</font><font color="#E5E5E5"> I did is I use a</font>

784
00:32:54,900 --> 00:32:59,610
concept called human<font color="#E5E5E5"> fasting</font><font color="#CCCCCC"> so this</font>

785
00:32:56,850 --> 00:33:01,740
<font color="#E5E5E5">gentleman here sharp mind brilliant</font>

786
00:32:59,610 --> 00:33:05,280
person<font color="#E5E5E5"> the author of a very</font><font color="#CCCCCC"> an awesome</font>

787
00:33:01,740 --> 00:33:07,049
tool<font color="#E5E5E5"> okay has something some</font>

788
00:33:05,280 --> 00:33:09,928
<font color="#E5E5E5">characteristics one of them is brilliant</font>

789
00:33:07,049 --> 00:33:11,760
<font color="#E5E5E5">it's an excellent developer</font><font color="#CCCCCC"> lots of</font>

790
00:33:09,929 --> 00:33:15,539
<font color="#CCCCCC">knowledge in</font><font color="#E5E5E5"> reversing in forensics and</font>

791
00:33:11,760 --> 00:33:19,830
he deeply deeply<font color="#E5E5E5"> in the root and the</font>

792
00:33:15,539 --> 00:33:23,400
core in<font color="#E5E5E5"> the heart hates Python</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> like</font>

793
00:33:19,830 --> 00:33:25,320
really<font color="#E5E5E5"> really badly</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> so there is one</font>

794
00:33:23,400 --> 00:33:27,539
<font color="#E5E5E5">thing about them every time he is forced</font>

795
00:33:25,320 --> 00:33:30,210
to use<font color="#E5E5E5"> Python somehow manages to crash</font>

796
00:33:27,539 --> 00:33:32,070
it every single time no matter if it's a

797
00:33:30,210 --> 00:33:33,059
hello world program<font color="#E5E5E5"> he's</font><font color="#CCCCCC"> going to crash</font>

798
00:33:32,070 --> 00:33:36,840
<font color="#CCCCCC">for</font><font color="#E5E5E5"> him</font>

799
00:33:33,059 --> 00:33:38,700
he is so deeply hating<font color="#E5E5E5"> Python that he's</font>

800
00:33:36,840 --> 00:33:41,309
gonna<font color="#E5E5E5"> share those crashes with all the</font>

801
00:33:38,700 --> 00:33:44,879
Python lovers<font color="#E5E5E5"> that he knows like me so</font>

802
00:33:41,309 --> 00:33:46,470
how<font color="#E5E5E5"> did I fast Python</font><font color="#CCCCCC"> I just went</font><font color="#E5E5E5"> to the</font>

803
00:33:44,879 --> 00:33:48,149
<font color="#CCCCCC">chats</font><font color="#E5E5E5"> that I have with him and started</font>

804
00:33:46,470 --> 00:33:49,679
to scroll up looking for a crash that

805
00:33:48,149 --> 00:33:53,939
would be exploitable in a plug in<font color="#CCCCCC"> the</font>

806
00:33:49,679 --> 00:33:57,720
heart and it worked<font color="#CCCCCC"> so I had the</font>

807
00:33:53,940 --> 00:33:59,190
vulnerability thanks<font color="#CCCCCC"> pancakes</font><font color="#E5E5E5"> okay so</font>

808
00:33:57,720 --> 00:34:03,450
now we<font color="#E5E5E5"> have the vulnerability that's</font>

809
00:33:59,190 --> 00:34:09,050
good okay so now let's recap<font color="#E5E5E5"> okay</font><font color="#CCCCCC"> a</font>

810
00:34:03,450 --> 00:34:12,810
little<font color="#CCCCCC"> bit</font><font color="#E5E5E5"> so what we have is a Windows</font>

811
00:34:09,050 --> 00:34:15,649
10 memory<font color="#E5E5E5"> dump with a meterpreter</font><font color="#CCCCCC"> and</font>

812
00:34:12,810 --> 00:34:19,199
something that has<font color="#E5E5E5"> my tiny face there</font>

813
00:34:15,649 --> 00:34:21,629
that at some<font color="#CCCCCC"> point is going to</font><font color="#E5E5E5"> be moved</font>

814
00:34:19,199 --> 00:34:22,918
or copied into a<font color="#E5E5E5"> memory dump</font><font color="#CCCCCC"> because</font>

815
00:34:21,629 --> 00:34:24,149
somebody's suspecting that there<font color="#E5E5E5"> is</font>

816
00:34:22,918 --> 00:34:28,020
something<font color="#E5E5E5"> wrong with the</font><font color="#CCCCCC"> Machine</font><font color="#E5E5E5"> right</font>

817
00:34:24,149 --> 00:34:29,879
<font color="#E5E5E5">and at some point</font><font color="#CCCCCC"> volatility in this</font>

818
00:34:28,020 --> 00:34:32,489
case we will expand<font color="#E5E5E5"> later</font><font color="#CCCCCC"> okay it's</font>

819
00:34:29,879 --> 00:34:36,060
<font color="#E5E5E5">going</font><font color="#CCCCCC"> to be</font><font color="#E5E5E5"> analyzing these memory dump</font>

820
00:34:32,489 --> 00:34:37,799
and by<font color="#E5E5E5"> somehow using or abusing that</font>

821
00:34:36,060 --> 00:34:40,649
<font color="#CCCCCC">vulnerability we are going to manage to</font>

822
00:34:37,800 --> 00:34:43,260
move this whatever into the running

823
00:34:40,649 --> 00:34:47,790
<font color="#CCCCCC">other space the the running</font><font color="#E5E5E5"> process of</font>

824
00:34:43,260 --> 00:34:49,679
<font color="#E5E5E5">Python okay and it's gonna turn itself</font>

825
00:34:47,790 --> 00:34:50,969
in<font color="#CCCCCC"> it's gonna activate itself</font><font color="#E5E5E5"> and it's</font>

826
00:34:49,679 --> 00:34:53,849
gonna<font color="#E5E5E5"> turn</font><font color="#CCCCCC"> that into</font><font color="#E5E5E5"> some</font><font color="#CCCCCC"> kind of in</font>

827
00:34:50,969 --> 00:34:56,339
memory rootkit<font color="#E5E5E5"> okay so in the end the</font>

828
00:34:53,849 --> 00:34:59,880
approach I decided to follow at concept

829
00:34:56,339 --> 00:35:01,828
<font color="#E5E5E5">level is to weaponize</font><font color="#CCCCCC"> a memory dump</font><font color="#E5E5E5"> wait</font>

830
00:34:59,880 --> 00:35:06,240
to use the<font color="#E5E5E5"> memory dump to actually</font>

831
00:35:01,829 --> 00:35:08,910
attack<font color="#CCCCCC"> the analyst</font><font color="#E5E5E5"> okay obviously this</font>

832
00:35:06,240 --> 00:35:13,439
<font color="#E5E5E5">is all fancy</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> but this</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> only well</font>

833
00:35:08,910 --> 00:35:15,839
<font color="#E5E5E5">so how do you do that okay well these we</font>

834
00:35:13,440 --> 00:35:18,450
<font color="#E5E5E5">are talking now is</font><font color="#CCCCCC"> Windows as a target</font>

835
00:35:15,839 --> 00:35:20,819
<font color="#CCCCCC">built on machine</font><font color="#E5E5E5"> right and we have to</font>

836
00:35:18,450 --> 00:35:24,029
<font color="#CCCCCC">use meterpreter</font><font color="#E5E5E5"> so it's gonna be</font><font color="#CCCCCC"> meteor</font>

837
00:35:20,819 --> 00:35:25,710
better for<font color="#E5E5E5"> Windows</font><font color="#CCCCCC"> okay now we do know</font>

838
00:35:24,030 --> 00:35:28,050
<font color="#E5E5E5">or I can let</font><font color="#CCCCCC"> you know</font><font color="#E5E5E5"> now that</font>

839
00:35:25,710 --> 00:35:30,060
meterpreter has disability<font color="#E5E5E5"> that once in</font>

840
00:35:28,050 --> 00:35:32,040
memory<font color="#E5E5E5"> it's gonna allow</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> upload</font>

841
00:35:30,060 --> 00:35:34,650
<font color="#E5E5E5">into the memory</font><font color="#CCCCCC"> of whatever compromised</font>

842
00:35:32,040 --> 00:35:36,900
machine<font color="#CCCCCC"> I random</font><font color="#E5E5E5"> DLL</font><font color="#CCCCCC"> that you have coded</font>

843
00:35:34,650 --> 00:35:39,030
to expand the capabilities<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> so what</font>

844
00:35:36,900 --> 00:35:42,000
I<font color="#E5E5E5"> decided to do is to code a DLL</font>

845
00:35:39,030 --> 00:35:45,119
okay<font color="#E5E5E5"> that is gonna be uploaded into</font>

846
00:35:42,000 --> 00:35:46,420
meterpreter<font color="#E5E5E5"> after any compromise okay</font>

847
00:35:45,119 --> 00:35:49,029
now<font color="#E5E5E5"> that</font>

848
00:35:46,420 --> 00:35:51,760
is gonna be there sitting<font color="#E5E5E5"> floating in</font>

849
00:35:49,029 --> 00:35:53,319
memory<font color="#CCCCCC"> send mode</font><font color="#E5E5E5"> doing nothing minding</font>

850
00:35:51,760 --> 00:35:56,319
its own business<font color="#E5E5E5"> but it's gonna have a</font>

851
00:35:53,319 --> 00:35:59,288
trigger<font color="#E5E5E5"> okay in that trigger when it</font>

852
00:35:56,319 --> 00:36:02,019
executes is gonna execute<font color="#CCCCCC"> and exploit</font>

853
00:35:59,289 --> 00:36:05,680
<font color="#E5E5E5">okay that then is gonna execute some</font>

854
00:36:02,019 --> 00:36:08,049
code<font color="#E5E5E5"> that is gonna be a rootkit running</font>

855
00:36:05,680 --> 00:36:10,808
in memory whose only purpose is<font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> be</font>

856
00:36:08,049 --> 00:36:14,349
to hide<font color="#E5E5E5"> the presence</font><font color="#CCCCCC"> of matter printer</font>

857
00:36:10,809 --> 00:36:14,980
from in this case let's say volatility

858
00:36:14,349 --> 00:36:17,740
<font color="#E5E5E5">okay</font>

859
00:36:14,980 --> 00:36:19,869
<font color="#E5E5E5">in CBC as a concept</font><font color="#CCCCCC"> IDs is still easy</font>

860
00:36:17,740 --> 00:36:21,519
<font color="#CCCCCC">okay now remember what I</font><font color="#E5E5E5"> said about</font>

861
00:36:19,869 --> 00:36:24,490
<font color="#E5E5E5">being lazy if I do it once I do it</font>

862
00:36:21,519 --> 00:36:25,720
properly<font color="#E5E5E5"> okay</font><font color="#CCCCCC"> the thing is well if I do</font>

863
00:36:24,490 --> 00:36:30,149
that I<font color="#CCCCCC"> do it</font>

864
00:36:25,720 --> 00:36:33,788
for<font color="#E5E5E5"> Windows follow SX</font><font color="#CCCCCC"> and for</font><font color="#E5E5E5"> Linux why</font>

865
00:36:30,150 --> 00:36:35,740
well because<font color="#E5E5E5"> I never knew in advance if</font>

866
00:36:33,789 --> 00:36:38,829
when the moment<font color="#E5E5E5"> of the challenge</font><font color="#CCCCCC"> come</font>

867
00:36:35,740 --> 00:36:40,720
Tommy is going<font color="#E5E5E5"> to be</font><font color="#CCCCCC"> using a</font><font color="#E5E5E5"> u.s. X</font>

868
00:36:38,829 --> 00:36:43,180
machine<font color="#CCCCCC"> a Windows machine or a Linux</font>

869
00:36:40,720 --> 00:36:46,209
machine<font color="#E5E5E5"> to</font><font color="#CCCCCC"> perform the analysis so what</font>

870
00:36:43,180 --> 00:36:48,578
<font color="#CCCCCC">I will exploit I</font><font color="#E5E5E5"> code</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> has</font><font color="#CCCCCC"> to be</font>

871
00:36:46,210 --> 00:36:51,250
able<font color="#E5E5E5"> to run on</font><font color="#CCCCCC"> all three</font><font color="#E5E5E5"> platforms</font><font color="#CCCCCC"> so I</font>

872
00:36:48,579 --> 00:36:53,910
have to<font color="#E5E5E5"> create 3d levels one that is</font>

873
00:36:51,250 --> 00:36:56,140
<font color="#CCCCCC">connects trigger to exploit if the</font>

874
00:36:53,910 --> 00:36:59,319
analysis is happening on Windows another

875
00:36:56,140 --> 00:37:01,480
one on OS X<font color="#E5E5E5"> and one Linux wow that's a</font>

876
00:36:59,319 --> 00:37:04,029
lot of<font color="#E5E5E5"> middle of dll's</font>

877
00:37:01,480 --> 00:37:05,799
because then you know limit our

878
00:37:04,029 --> 00:37:07,269
exploitation<font color="#E5E5E5"> you know that you have to</font>

879
00:37:05,799 --> 00:37:09,670
take care<font color="#E5E5E5"> something about architecture</font>

880
00:37:07,269 --> 00:37:13,118
<font color="#CCCCCC">it's not gonna</font><font color="#E5E5E5"> be a</font><font color="#CCCCCC"> 32</font><font color="#E5E5E5"> it's gonna be a</font>

881
00:37:09,670 --> 00:37:15,490
64 woof gets complicated<font color="#CCCCCC"> so what if</font>

882
00:37:13,119 --> 00:37:18,549
instead<font color="#E5E5E5"> while we do is we create one</font>

883
00:37:15,490 --> 00:37:19,899
single<font color="#E5E5E5"> DLL</font><font color="#CCCCCC"> okay with one single trigger</font>

884
00:37:18,549 --> 00:37:22,089
because<font color="#E5E5E5"> the Motability is gonna be</font>

885
00:37:19,900 --> 00:37:24,609
common okay<font color="#CCCCCC"> with one thing</font><font color="#E5E5E5"> on exploit</font>

886
00:37:22,089 --> 00:37:26,769
that<font color="#E5E5E5"> is</font><font color="#CCCCCC"> gonna be</font><font color="#E5E5E5"> running or be</font><font color="#CCCCCC"> able</font><font color="#E5E5E5"> to</font>

887
00:37:24,609 --> 00:37:28,359
work on<font color="#E5E5E5"> all</font><font color="#CCCCCC"> the platforms</font><font color="#E5E5E5"> and then it's</font>

888
00:37:26,769 --> 00:37:29,859
<font color="#E5E5E5">going to execute the real key that is</font>

889
00:37:28,359 --> 00:37:32,740
<font color="#CCCCCC">gonna be</font><font color="#E5E5E5"> working on all the platforms</font><font color="#CCCCCC"> in</font>

890
00:37:29,859 --> 00:37:35,920
<font color="#CCCCCC">every single architecture</font><font color="#E5E5E5"> okay not</font><font color="#CCCCCC"> 60</font>

891
00:37:32,740 --> 00:37:39,819
not 16<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> okay that's what I had to do</font>

892
00:37:35,920 --> 00:37:41,890
with one final<font color="#E5E5E5"> twist okay I'm gonna give</font>

893
00:37:39,819 --> 00:37:44,349
that<font color="#E5E5E5"> guy the</font><font color="#CCCCCC"> rental machine for</font><font color="#E5E5E5"> two</font>

894
00:37:41,890 --> 00:37:46,680
weeks<font color="#CCCCCC"> is he gonna be</font><font color="#E5E5E5"> using volatility</font>

895
00:37:44,349 --> 00:37:49,240
<font color="#E5E5E5">most poly is he gonna be using only</font>

896
00:37:46,680 --> 00:37:53,919
volatility was probably<font color="#E5E5E5"> not</font><font color="#CCCCCC"> he's gonna</font>

897
00:37:49,240 --> 00:37:57,729
be using as many<font color="#E5E5E5"> tools</font><font color="#CCCCCC"> as he can use so</font>

898
00:37:53,920 --> 00:37:59,380
whatever they exploit I create it has to

899
00:37:57,730 --> 00:38:00,130
be one exploit for volatility another

900
00:37:59,380 --> 00:38:03,220
word for Rico

901
00:38:00,130 --> 00:38:05,410
as many tools as I can think<font color="#E5E5E5"> of what</font>

902
00:38:03,220 --> 00:38:07,720
news<font color="#E5E5E5"> it was extremely easy to find</font>

903
00:38:05,410 --> 00:38:09,490
vulnerabilities on these forensics

904
00:38:07,720 --> 00:38:12,970
memory forensic software<font color="#E5E5E5"> or</font><font color="#CCCCCC"> forensics</font>

905
00:38:09,490 --> 00:38:16,509
over<font color="#CCCCCC"> internal okay-y</font><font color="#E5E5E5"> as it happens so</font>

906
00:38:12,970 --> 00:38:19,060
often<font color="#E5E5E5"> even in 2018 almost 19 nowadays</font>

907
00:38:16,510 --> 00:38:20,860
for some reason<font color="#CCCCCC"> defensive security</font>

908
00:38:19,060 --> 00:38:22,360
software the software the appliance is

909
00:38:20,860 --> 00:38:25,660
that the people<font color="#E5E5E5"> developed to protect</font>

910
00:38:22,360 --> 00:38:27,580
<font color="#CCCCCC">something they feel themselves</font><font color="#E5E5E5"> immune to</font>

911
00:38:25,660 --> 00:38:29,740
attacks<font color="#E5E5E5"> so they don't care about the</font>

912
00:38:27,580 --> 00:38:31,990
<font color="#E5E5E5">security of their own platform</font><font color="#CCCCCC"> ok so it</font>

913
00:38:29,740 --> 00:38:33,640
was easy to know let's go a bit

914
00:38:31,990 --> 00:38:37,899
<font color="#CCCCCC">technical but not too much ok this is</font>

915
00:38:33,640 --> 00:38:39,940
not the goal of<font color="#CCCCCC"> this talk</font><font color="#E5E5E5"> so the first</font>

916
00:38:37,900 --> 00:38:42,490
thing to<font color="#CCCCCC"> make it</font><font color="#E5E5E5"> happen would</font><font color="#CCCCCC"> be to</font>

917
00:38:39,940 --> 00:38:44,560
detect architecture<font color="#E5E5E5"> ok so once the</font>

918
00:38:42,490 --> 00:38:46,750
exploit is<font color="#E5E5E5"> triggered you're able to</font>

919
00:38:44,560 --> 00:38:49,060
<font color="#E5E5E5">execute a bunch of bytes here and there</font>

920
00:38:46,750 --> 00:38:51,990
the first<font color="#CCCCCC"> thing is</font><font color="#E5E5E5"> to detect if</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> going</font>

921
00:38:49,060 --> 00:38:54,670
<font color="#E5E5E5">to be running in a 32-bit or 64-bit</font>

922
00:38:51,990 --> 00:38:57,220
architecture<font color="#CCCCCC"> ok for</font><font color="#E5E5E5"> that in Internet</font>

923
00:38:54,670 --> 00:38:59,560
there is this tiny useful piece of

924
00:38:57,220 --> 00:39:03,069
information<font color="#CCCCCC"> that we just</font><font color="#E5E5E5"> to buy it</font>

925
00:38:59,560 --> 00:39:05,680
<font color="#CCCCCC">ok you're going to be able</font><font color="#E5E5E5"> to do that</font>

926
00:39:03,070 --> 00:39:07,390
because<font color="#CCCCCC"> 4 different</font><font color="#E5E5E5"> architecture is</font>

927
00:39:05,680 --> 00:39:12,370
<font color="#E5E5E5">going to</font><font color="#CCCCCC"> just do slightly</font><font color="#E5E5E5"> different</font>

928
00:39:07,390 --> 00:39:14,589
<font color="#CCCCCC">things</font><font color="#E5E5E5"> so by setting to 0 the</font><font color="#CCCCCC"> value of a</font>

929
00:39:12,370 --> 00:39:16,450
single<font color="#E5E5E5"> register in memory</font><font color="#CCCCCC"> okay and then</font>

930
00:39:14,590 --> 00:39:17,800
triggering this to bite<font color="#CCCCCC"> ok the only</font>

931
00:39:16,450 --> 00:39:20,790
<font color="#CCCCCC">thing you have to</font><font color="#E5E5E5"> do then</font><font color="#CCCCCC"> is to check</font>

932
00:39:17,800 --> 00:39:22,870
the<font color="#CCCCCC"> value of</font><font color="#E5E5E5"> this register</font><font color="#CCCCCC"> okay and</font>

933
00:39:20,790 --> 00:39:26,380
<font color="#E5E5E5">depending on the value you're gonna know</font>

934
00:39:22,870 --> 00:39:28,660
immediately if<font color="#E5E5E5"> it's 32 or 64 good half</font>

935
00:39:26,380 --> 00:39:30,820
of<font color="#E5E5E5"> it is done now obviously after that</font>

936
00:39:28,660 --> 00:39:33,250
<font color="#E5E5E5">when you need</font><font color="#CCCCCC"> to do is to determine the</font>

937
00:39:30,820 --> 00:39:36,160
<font color="#E5E5E5">operating system okay then we have</font>

938
00:39:33,250 --> 00:39:39,370
<font color="#CCCCCC">another slightly useful trick</font><font color="#E5E5E5"> okay and</font>

939
00:39:36,160 --> 00:39:42,549
that's over<font color="#E5E5E5"> there</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> that tiny amount</font>

940
00:39:39,370 --> 00:39:44,500
<font color="#E5E5E5">of piece of code</font><font color="#CCCCCC"> okay it's gonna behave</font>

941
00:39:42,550 --> 00:39:47,410
<font color="#E5E5E5">here down there it's gonna behave</font>

942
00:39:44,500 --> 00:39:52,240
differently depending on the operating

943
00:39:47,410 --> 00:39:57,100
system<font color="#E5E5E5"> okay and that's gonna allow you</font>

944
00:39:52,240 --> 00:40:02,500
<font color="#E5E5E5">okay to know if it's a</font><font color="#CCCCCC"> Linux in 32 if</font>

945
00:39:57,100 --> 00:40:04,690
it's a<font color="#E5E5E5"> Windows in 64 Linux in 64 or if</font>

946
00:40:02,500 --> 00:40:08,850
not by default<font color="#E5E5E5"> continue the flow of the</font>

947
00:40:04,690 --> 00:40:12,490
key execution<font color="#E5E5E5"> to Windows 32 okay this is</font>

948
00:40:08,850 --> 00:40:14,288
a little bit the code by<font color="#CCCCCC"> using radar</font>

949
00:40:12,490 --> 00:40:15,939
<font color="#E5E5E5">okay</font>

950
00:40:14,289 --> 00:40:18,099
he's going to show you that<font color="#E5E5E5"> exactly the</font>

951
00:40:15,940 --> 00:40:19,240
same by<font color="#E5E5E5"> the same code for</font><font color="#CCCCCC"> different</font>

952
00:40:18,099 --> 00:40:20,740
<font color="#E5E5E5">architectures it's going to behave</font>

953
00:40:19,240 --> 00:40:23,770
<font color="#CCCCCC">differently</font><font color="#E5E5E5"> okay</font>

954
00:40:20,740 --> 00:40:25,209
<font color="#E5E5E5">and now one second I still have I want</font>

955
00:40:23,770 --> 00:40:27,549
<font color="#CCCCCC">sometimes four minutes and we're almost</font>

956
00:40:25,210 --> 00:40:30,060
<font color="#E5E5E5">done here</font><font color="#CCCCCC"> so let me</font><font color="#E5E5E5"> switch the screens</font>

957
00:40:27,549 --> 00:40:34,230
again<font color="#E5E5E5"> one moment okay</font><font color="#CCCCCC"> just one second</font>

958
00:40:30,060 --> 00:40:34,230
[Music]

959
00:40:36,599 --> 00:40:45,900
<font color="#CCCCCC">whoo that's</font><font color="#E5E5E5"> a terminal okay so what I</font>

960
00:40:40,480 --> 00:40:49,089
did<font color="#E5E5E5"> is I</font><font color="#CCCCCC"> just put in a tiny binary</font><font color="#E5E5E5"> okay</font>

961
00:40:45,900 --> 00:40:50,710
these very<font color="#E5E5E5"> same code so we are opening</font>

962
00:40:49,089 --> 00:40:57,430
that<font color="#E5E5E5"> with</font><font color="#CCCCCC"> radar oh let</font><font color="#E5E5E5"> me try to</font>

963
00:40:50,710 --> 00:41:01,210
<font color="#E5E5E5">increase</font><font color="#CCCCCC"> the size</font><font color="#E5E5E5"> of the of the font let</font>

964
00:40:57,430 --> 00:41:07,690
me see if I can do<font color="#CCCCCC"> that here make text</font>

965
00:41:01,210 --> 00:41:11,530
bigger and make text bigger<font color="#E5E5E5"> okay and one</font>

966
00:41:07,690 --> 00:41:12,940
more<font color="#CCCCCC"> time</font><font color="#E5E5E5"> okay now</font><font color="#CCCCCC"> so the first thing</font>

967
00:41:11,530 --> 00:41:14,920
we're going to do<font color="#CCCCCC"> after opening this</font>

968
00:41:12,940 --> 00:41:17,260
with radar<font color="#E5E5E5"> that it's like so much</font>

969
00:41:14,920 --> 00:41:20,319
intimidating<font color="#CCCCCC"> Tully's tell them to</font>

970
00:41:17,260 --> 00:41:22,059
<font color="#CCCCCC">analyze the binary that's</font><font color="#E5E5E5"> it and now</font>

971
00:41:20,319 --> 00:41:23,920
we're<font color="#E5E5E5"> gonna tell him to show</font><font color="#CCCCCC"> it in a</font>

972
00:41:22,059 --> 00:41:25,990
more friendly<font color="#E5E5E5"> way that's the graph view</font>

973
00:41:23,920 --> 00:41:27,369
<font color="#E5E5E5">okay it's not really</font><font color="#CCCCCC"> that useful because</font>

974
00:41:25,990 --> 00:41:29,578
it's a big graph so we're going<font color="#E5E5E5"> to be</font>

975
00:41:27,369 --> 00:41:32,920
using<font color="#CCCCCC"> the zoom out functionality sorry</font>

976
00:41:29,579 --> 00:41:34,720
<font color="#E5E5E5">okay there we are here it is so we</font><font color="#CCCCCC"> only</font>

977
00:41:32,920 --> 00:41:36,849
have<font color="#E5E5E5"> the basic blocks here the</font><font color="#CCCCCC"> diagram</font>

978
00:41:34,720 --> 00:41:39,308
<font color="#E5E5E5">the</font><font color="#CCCCCC"> tree graph of the execution of</font><font color="#E5E5E5"> the</font>

979
00:41:36,849 --> 00:41:41,109
program<font color="#E5E5E5"> no need to see the actual</font><font color="#CCCCCC"> code</font>

980
00:41:39,309 --> 00:41:43,599
is the one<font color="#CCCCCC"> I already</font><font color="#E5E5E5"> saw on the slides</font>

981
00:41:41,109 --> 00:41:45,848
<font color="#E5E5E5">okay</font><font color="#CCCCCC"> and you just have here that is a</font><font color="#E5E5E5"> an</font>

982
00:41:43,599 --> 00:41:47,440
elimination process<font color="#E5E5E5"> okay do you first</font>

983
00:41:45,849 --> 00:41:49,569
determine<font color="#CCCCCC"> the</font><font color="#E5E5E5"> architecture based on the</font>

984
00:41:47,440 --> 00:41:51,599
architecture<font color="#CCCCCC"> you do another test</font><font color="#E5E5E5"> and by</font>

985
00:41:49,569 --> 00:41:53,859
elimination<font color="#E5E5E5"> you go to one or</font><font color="#CCCCCC"> another</font>

986
00:41:51,599 --> 00:41:55,599
operating<font color="#E5E5E5"> system</font><font color="#CCCCCC"> and the only</font><font color="#E5E5E5"> thing you</font>

987
00:41:53,859 --> 00:41:58,240
have to<font color="#CCCCCC"> do is to put the specific code</font>

988
00:41:55,599 --> 00:42:00,400
the<font color="#CCCCCC"> rootkit</font><font color="#E5E5E5"> itself in each of these tiny</font>

989
00:41:58,240 --> 00:42:02,288
boxes for<font color="#CCCCCC"> each of the operating systems</font>

990
00:42:00,400 --> 00:42:04,359
in architectures<font color="#CCCCCC"> okay</font>

991
00:42:02,289 --> 00:42:06,760
that at high level view<font color="#CCCCCC"> simplified is</font>

992
00:42:04,359 --> 00:42:09,578
how you can create<font color="#E5E5E5"> a simple multi</font>

993
00:42:06,760 --> 00:42:10,319
architecture<font color="#E5E5E5"> I think I can do yeah</font>

994
00:42:09,579 --> 00:42:12,400
that's even<font color="#E5E5E5"> easier</font>

995
00:42:10,319 --> 00:42:14,380
how can you can do a multi collector

996
00:42:12,400 --> 00:42:17,260
operating system exploit<font color="#E5E5E5"> okay</font>

997
00:42:14,380 --> 00:42:21,480
now unfortunately<font color="#E5E5E5"> things are not always</font>

998
00:42:17,260 --> 00:42:24,140
<font color="#E5E5E5">so easy</font><font color="#CCCCCC"> okay so if I come here again and</font>

999
00:42:21,480 --> 00:42:30,440
<font color="#CCCCCC">I do</font>

1000
00:42:24,140 --> 00:42:32,930
me<font color="#CCCCCC"> be you slideshow here yeah so</font>

1001
00:42:30,440 --> 00:42:34,700
unfortunately<font color="#CCCCCC"> even though this is quite</font>

1002
00:42:32,930 --> 00:42:36,649
easy<font color="#E5E5E5"> there is something called real</font>

1003
00:42:34,700 --> 00:42:38,390
<font color="#CCCCCC">world and in the real world this doesn't</font>

1004
00:42:36,650 --> 00:42:40,670
<font color="#E5E5E5">really work anymore</font><font color="#CCCCCC"> okay there is this</font>

1005
00:42:38,390 --> 00:42:44,240
memory protection techniques here<font color="#E5E5E5"> to ant</font>

1006
00:42:40,670 --> 00:42:46,310
exploit technologies<font color="#CCCCCC"> okay and I'm</font><font color="#E5E5E5"> afraid</font>

1007
00:42:44,240 --> 00:42:48,259
is<font color="#CCCCCC"> not gonna work like that</font>

1008
00:42:46,310 --> 00:42:49,910
so in order to make it<font color="#E5E5E5"> work on the real</font>

1009
00:42:48,260 --> 00:42:53,120
world<font color="#E5E5E5"> and I actually needed that to work</font>

1010
00:42:49,910 --> 00:42:54,710
on a real platform<font color="#CCCCCC"> okay one of the</font>

1011
00:42:53,120 --> 00:42:56,810
approaches that<font color="#E5E5E5"> you have and one I</font>

1012
00:42:54,710 --> 00:42:59,420
<font color="#E5E5E5">decided</font><font color="#CCCCCC"> to go for is to use blob caches</font>

1013
00:42:56,810 --> 00:43:01,009
which is well I<font color="#E5E5E5"> hope you know</font><font color="#CCCCCC"> what is</font>

1014
00:42:59,420 --> 00:43:03,590
<font color="#CCCCCC">rob</font><font color="#E5E5E5"> because I don't really think I</font><font color="#CCCCCC"> have</font>

1015
00:43:01,010 --> 00:43:05,720
time<font color="#CCCCCC"> to explain</font><font color="#E5E5E5"> them here okay</font><font color="#CCCCCC"> so I do</font>

1016
00:43:03,590 --> 00:43:08,060
have my<font color="#CCCCCC"> abilities I have</font><font color="#E5E5E5"> my limitations</font>

1017
00:43:05,720 --> 00:43:09,560
and<font color="#E5E5E5"> I reach my limitation in here okay</font>

1018
00:43:08,060 --> 00:43:11,600
was fighting with<font color="#CCCCCC"> that problem</font><font color="#E5E5E5"> for some</font>

1019
00:43:09,560 --> 00:43:12,799
time and then I<font color="#CCCCCC"> sometime I decided I</font>

1020
00:43:11,600 --> 00:43:15,860
needed<font color="#CCCCCC"> help okay</font>

1021
00:43:12,800 --> 00:43:18,800
and then this guy<font color="#CCCCCC"> here</font><font color="#E5E5E5"> is one of most</font>

1022
00:43:15,860 --> 00:43:21,440
<font color="#E5E5E5">the most fast and brilliant</font><font color="#CCCCCC"> reversals</font>

1023
00:43:18,800 --> 00:43:22,820
and exploiters<font color="#CCCCCC"> I have known but</font><font color="#E5E5E5"> likes to</font>

1024
00:43:21,440 --> 00:43:25,460
be a<font color="#E5E5E5"> little bit hidden right</font><font color="#CCCCCC"> he's gonna</font>

1025
00:43:22,820 --> 00:43:27,350
<font color="#E5E5E5">make a presentation hopefully soon</font><font color="#CCCCCC"> look</font>

1026
00:43:25,460 --> 00:43:30,110
for it but<font color="#CCCCCC"> then I just decided</font><font color="#E5E5E5"> to ask</font>

1027
00:43:27,350 --> 00:43:32,270
him<font color="#CCCCCC"> for help and he kind</font><font color="#E5E5E5"> of send me in</font>

1028
00:43:30,110 --> 00:43:35,390
five minutes<font color="#CCCCCC"> a drawing</font><font color="#E5E5E5"> of a concept in a</font>

1029
00:43:32,270 --> 00:43:36,890
ton of you know<font color="#CCCCCC"> piece</font><font color="#E5E5E5"> of paper that he</font>

1030
00:43:35,390 --> 00:43:39,379
<font color="#E5E5E5">just happened to happen I</font><font color="#CCCCCC"> don't know</font>

1031
00:43:36,890 --> 00:43:42,560
and he<font color="#E5E5E5"> came in</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> asking me a question</font>

1032
00:43:39,380 --> 00:43:44,690
<font color="#CCCCCC">he's</font><font color="#E5E5E5"> like</font><font color="#CCCCCC"> eat</font><font color="#E5E5E5"> the size of the vulnerable</font>

1033
00:43:42,560 --> 00:43:47,870
baffled different for<font color="#CCCCCC"> each platform I</font>

1034
00:43:44,690 --> 00:43:50,300
went I check I say yes<font color="#E5E5E5"> and say okay what</font>

1035
00:43:47,870 --> 00:43:51,440
if<font color="#CCCCCC"> you do</font><font color="#E5E5E5"> that but he recommended me to</font>

1036
00:43:50,300 --> 00:43:55,070
<font color="#E5E5E5">do was the following</font>

1037
00:43:51,440 --> 00:43:57,260
<font color="#CCCCCC">okay now this thing in blue here is the</font>

1038
00:43:55,070 --> 00:43:59,810
<font color="#CCCCCC">size of the buffer</font><font color="#E5E5E5"> that you have to fill</font>

1039
00:43:57,260 --> 00:44:02,330
up<font color="#E5E5E5"> to</font><font color="#CCCCCC"> trigger the exploit</font><font color="#E5E5E5"> okay basic</font>

1040
00:43:59,810 --> 00:44:05,180
<font color="#E5E5E5">memory corruption</font><font color="#CCCCCC"> okay now the size is</font>

1041
00:44:02,330 --> 00:44:08,569
<font color="#CCCCCC">different meaning</font><font color="#E5E5E5"> that if you</font><font color="#CCCCCC"> execute</font>

1042
00:44:05,180 --> 00:44:10,790
the exploit<font color="#E5E5E5"> in OS X okay you have to</font>

1043
00:44:08,570 --> 00:44:13,160
make sure<font color="#CCCCCC"> to have the address of the</font>

1044
00:44:10,790 --> 00:44:15,050
<font color="#CCCCCC">first execution</font><font color="#E5E5E5"> part in here while if</font>

1045
00:44:13,160 --> 00:44:16,790
it's in<font color="#E5E5E5"> Windows is gonna be there and on</font>

1046
00:44:15,050 --> 00:44:19,760
<font color="#CCCCCC">linux</font><font color="#E5E5E5"> is gonna be there instantly</font>

1047
00:44:16,790 --> 00:44:22,460
<font color="#E5E5E5">simplified but they are different okay</font>

1048
00:44:19,760 --> 00:44:25,340
so what he told me is<font color="#E5E5E5"> okay then why</font>

1049
00:44:22,460 --> 00:44:28,850
<font color="#CCCCCC">don't you</font><font color="#E5E5E5"> just put different</font><font color="#CCCCCC"> drop chains</font>

1050
00:44:25,340 --> 00:44:32,420
in different locations<font color="#CCCCCC"> of the file</font>

1051
00:44:28,850 --> 00:44:34,490
different offsets okay and then based on

1052
00:44:32,420 --> 00:44:36,410
<font color="#CCCCCC">that knowledge</font><font color="#E5E5E5"> you can control the flow</font>

1053
00:44:34,490 --> 00:44:37,700
<font color="#E5E5E5">of the execution once we use this</font>

1054
00:44:36,410 --> 00:44:40,730
previous tiny

1055
00:44:37,700 --> 00:44:43,160
pieces of code<font color="#CCCCCC"> okay so to make it</font><font color="#E5E5E5"> a</font>

1056
00:44:40,730 --> 00:44:45,830
<font color="#CCCCCC">little</font><font color="#E5E5E5"> more peaceful</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> so you trigger</font>

1057
00:44:43,160 --> 00:44:49,850
<font color="#E5E5E5">the exploit okay happens to be on OS X</font>

1058
00:44:45,830 --> 00:44:51,710
<font color="#E5E5E5">so you know SX</font><font color="#CCCCCC"> you feel all that</font><font color="#E5E5E5"> and</font>

1059
00:44:49,850 --> 00:44:53,480
whether<font color="#CCCCCC"> the</font><font color="#E5E5E5"> program is regaining</font>

1060
00:44:51,710 --> 00:44:54,020
execution it's going to read this

1061
00:44:53,480 --> 00:44:57,640
address

1062
00:44:54,020 --> 00:45:00,890
so in this<font color="#E5E5E5"> address</font><font color="#CCCCCC"> you just</font><font color="#E5E5E5"> increase the</font>

1063
00:44:57,640 --> 00:45:04,670
<font color="#CCCCCC">the</font><font color="#E5E5E5"> address okay</font><font color="#CCCCCC"> of the keeps execution</font>

1064
00:45:00,890 --> 00:45:07,970
<font color="#E5E5E5">to by unknown offset where you already</font>

1065
00:45:04,670 --> 00:45:10,190
<font color="#CCCCCC">know that</font><font color="#E5E5E5"> you have stored the over there</font>

1066
00:45:07,970 --> 00:45:12,379
they always<font color="#CCCCCC"> external</font><font color="#E5E5E5"> chain and it's just</font>

1067
00:45:10,190 --> 00:45:15,650
<font color="#E5E5E5">gonna jump there and execute the</font><font color="#CCCCCC"> or</font>

1068
00:45:12,380 --> 00:45:18,560
<font color="#CCCCCC">sex-specific rootkit while</font><font color="#E5E5E5"> if it's just</font>

1069
00:45:15,650 --> 00:45:20,180
a<font color="#E5E5E5"> Linux</font><font color="#CCCCCC"> okay it's gonna</font><font color="#E5E5E5"> do the same here</font>

1070
00:45:18,560 --> 00:45:22,340
and if it's<font color="#E5E5E5"> Windows it's gonna fall</font>

1071
00:45:20,180 --> 00:45:24,470
directly<font color="#E5E5E5"> in the window shop chain you</font>

1072
00:45:22,340 --> 00:45:26,270
just need to arrange that<font color="#CCCCCC"> okay it</font>

1073
00:45:24,470 --> 00:45:28,160
requires a lot of work<font color="#E5E5E5"> okay because the</font>

1074
00:45:26,270 --> 00:45:30,050
memory is<font color="#CCCCCC"> not</font><font color="#E5E5E5"> only so predictable but</font>

1075
00:45:28,160 --> 00:45:30,859
the basic<font color="#CCCCCC"> concept would</font><font color="#E5E5E5"> be like that</font>

1076
00:45:30,050 --> 00:45:34,820
<font color="#E5E5E5">okay</font>

1077
00:45:30,860 --> 00:45:37,880
and finally<font color="#E5E5E5"> okay almost</font><font color="#CCCCCC"> done time and</font>

1078
00:45:34,820 --> 00:45:39,530
what now<font color="#E5E5E5"> you managed</font><font color="#CCCCCC"> to get that ok</font><font color="#E5E5E5"> in</font>

1079
00:45:37,880 --> 00:45:42,050
real world<font color="#E5E5E5"> well the post exploitation</font>

1080
00:45:39,530 --> 00:45:44,120
would be quite a straightforward<font color="#CCCCCC"> let's</font>

1081
00:45:42,050 --> 00:45:46,250
remember this was for a challenge<font color="#CCCCCC"> okay</font>

1082
00:45:44,120 --> 00:45:48,950
so what I decided to do to make it<font color="#E5E5E5"> a</font>

1083
00:45:46,250 --> 00:45:51,350
<font color="#CCCCCC">little</font><font color="#E5E5E5"> more interesting is obviously</font>

1084
00:45:48,950 --> 00:45:53,689
<font color="#E5E5E5">what I'm</font><font color="#CCCCCC"> gonna be doing</font><font color="#E5E5E5"> is to hide</font><font color="#CCCCCC"> the</font>

1085
00:45:51,350 --> 00:45:56,000
<font color="#CCCCCC">presence</font><font color="#E5E5E5"> of metal</font><font color="#CCCCCC"> platter in that memory</font>

1086
00:45:53,690 --> 00:45:58,130
dump from<font color="#E5E5E5"> the analyst okay but I'm gonna</font>

1087
00:45:56,000 --> 00:46:00,470
include a counter<font color="#CCCCCC"> okay</font>

1088
00:45:58,130 --> 00:46:03,440
in the execution<font color="#CCCCCC"> of that</font><font color="#E5E5E5"> with</font>

1089
00:46:00,470 --> 00:46:07,370
persistence<font color="#CCCCCC"> okay so I can know how many</font>

1090
00:46:03,440 --> 00:46:09,830
times the memory<font color="#E5E5E5"> is being read okay</font><font color="#CCCCCC"> and</font>

1091
00:46:07,370 --> 00:46:12,680
whenever the counter reaches some a

1092
00:46:09,830 --> 00:46:15,980
specific amount<font color="#E5E5E5"> then at that point we're</font>

1093
00:46:12,680 --> 00:46:18,350
gonna<font color="#E5E5E5"> just remove the implant okay so we</font>

1094
00:46:15,980 --> 00:46:20,420
<font color="#E5E5E5">are giving some</font><font color="#CCCCCC"> chances to the analyst</font>

1095
00:46:18,350 --> 00:46:23,240
to<font color="#CCCCCC"> actually be able</font><font color="#E5E5E5"> to figure</font><font color="#CCCCCC"> out what's</font>

1096
00:46:20,420 --> 00:46:25,610
going<font color="#E5E5E5"> on in here right obviously</font><font color="#CCCCCC"> there</font>

1097
00:46:23,240 --> 00:46:27,439
<font color="#CCCCCC">was an issue here is</font><font color="#E5E5E5"> after my talk a</font>

1098
00:46:25,610 --> 00:46:31,490
bunch<font color="#E5E5E5"> of people would</font><font color="#CCCCCC"> have access to</font>

1099
00:46:27,440 --> 00:46:33,650
<font color="#CCCCCC">that very same a memory dump</font><font color="#E5E5E5"> and they</font>

1100
00:46:31,490 --> 00:46:35,330
would know all that<font color="#E5E5E5"> I don't</font><font color="#CCCCCC"> wanna you</font>

1101
00:46:33,650 --> 00:46:37,370
know<font color="#E5E5E5"> share my</font><font color="#CCCCCC"> 0 they said my</font><font color="#E5E5E5"> exploits</font>

1102
00:46:35,330 --> 00:46:40,220
just for free<font color="#CCCCCC"> ok so what</font><font color="#E5E5E5"> I did also</font>

1103
00:46:37,370 --> 00:46:42,080
<font color="#E5E5E5">included another check for date so a</font>

1104
00:46:40,220 --> 00:46:45,379
<font color="#E5E5E5">couple of days before the presentation</font>

1105
00:46:42,080 --> 00:46:47,120
<font color="#E5E5E5">or three days okay if the execution</font>

1106
00:46:45,380 --> 00:46:49,310
happened again<font color="#E5E5E5"> then we will</font><font color="#CCCCCC"> jump</font>

1107
00:46:47,120 --> 00:46:50,819
straight<font color="#CCCCCC"> to</font><font color="#E5E5E5"> the remove</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> because</font><font color="#CCCCCC"> then</font>

1108
00:46:49,310 --> 00:46:52,589
we make<font color="#E5E5E5"> sure</font><font color="#CCCCCC"> that the</font>

1109
00:46:50,819 --> 00:46:54,058
the after the presentation the talk they

1110
00:46:52,589 --> 00:46:56,189
can't go<font color="#CCCCCC"> back and steal all my data</font>

1111
00:46:54,059 --> 00:46:58,589
we're doing more manual analysis

1112
00:46:56,189 --> 00:47:00,660
well obviously on the real world<font color="#E5E5E5"> you</font>

1113
00:46:58,589 --> 00:47:02,279
would<font color="#CCCCCC"> just straight jump into the</font><font color="#E5E5E5"> dream</font>

1114
00:47:00,660 --> 00:47:05,819
move and try<font color="#E5E5E5"> to make sure</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> nobody is</font>

1115
00:47:02,279 --> 00:47:09,329
it's<font color="#E5E5E5"> going</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> be finding your your stuff</font>

1116
00:47:05,819 --> 00:47:12,538
<font color="#E5E5E5">okay</font><font color="#CCCCCC"> so before we go</font><font color="#E5E5E5"> to the last slide</font>

1117
00:47:09,329 --> 00:47:15,390
<font color="#CCCCCC">what would be okay</font><font color="#E5E5E5"> the conclusion here</font>

1118
00:47:12,539 --> 00:47:18,269
for me at least<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> what I just</font><font color="#CCCCCC"> said</font>

1119
00:47:15,390 --> 00:47:20,729
<font color="#E5E5E5">okay when I prepare all that I thought</font>

1120
00:47:18,269 --> 00:47:22,258
this is<font color="#E5E5E5"> never gonna work because based</font>

1121
00:47:20,729 --> 00:47:24,410
<font color="#E5E5E5">on my experience passed long ago</font>

1122
00:47:22,259 --> 00:47:26,699
<font color="#CCCCCC">experience in the</font><font color="#E5E5E5"> antivirus</font><font color="#CCCCCC"> industry</font>

1123
00:47:24,410 --> 00:47:29,279
<font color="#E5E5E5">whenever you are dealing with evidence</font>

1124
00:47:26,699 --> 00:47:31,319
or in the<font color="#E5E5E5"> antabuse case with mugwort</font>

1125
00:47:29,279 --> 00:47:33,299
potential<font color="#E5E5E5"> malware you are gonna be</font>

1126
00:47:31,319 --> 00:47:35,009
executing the analysis in a sandbox

1127
00:47:33,299 --> 00:47:36,719
<font color="#E5E5E5">environment highly controlled</font>

1128
00:47:35,009 --> 00:47:38,219
environment<font color="#E5E5E5"> okay well everything is</font>

1129
00:47:36,719 --> 00:47:40,249
monitored<font color="#E5E5E5"> everything is controlled so</font>

1130
00:47:38,219 --> 00:47:42,209
<font color="#E5E5E5">they are going to detect that explode</font>

1131
00:47:40,249 --> 00:47:43,890
exploitation they're gonna see what's

1132
00:47:42,209 --> 00:47:47,308
going on<font color="#CCCCCC"> they're gonna be</font><font color="#E5E5E5"> finding me</font>

1133
00:47:43,890 --> 00:47:49,459
<font color="#E5E5E5">what I realize is that again for some</font>

1134
00:47:47,309 --> 00:47:52,109
reason<font color="#CCCCCC"> these guys</font><font color="#E5E5E5"> don't feel threatened</font>

1135
00:47:49,459 --> 00:47:53,848
<font color="#E5E5E5">okay so they're just running that</font><font color="#CCCCCC"> on the</font>

1136
00:47:52,109 --> 00:47:55,709
normal machines with no normal security

1137
00:47:53,849 --> 00:47:57,089
<font color="#CCCCCC">or special security</font><font color="#E5E5E5"> measures so you're</font>

1138
00:47:55,709 --> 00:47:59,669
actually<font color="#E5E5E5"> just exploiting any other</font>

1139
00:47:57,089 --> 00:48:00,058
desktop<font color="#E5E5E5"> environment okay there is no</font>

1140
00:47:59,669 --> 00:48:01,709
nothing

1141
00:48:00,059 --> 00:48:04,409
yeah the<font color="#CCCCCC"> only</font><font color="#E5E5E5"> thing they have sometimes</font>

1142
00:48:01,709 --> 00:48:06,719
<font color="#CCCCCC">is just a snapshot of the the Machine so</font>

1143
00:48:04,409 --> 00:48:08,640
after that or<font color="#E5E5E5"> some time they can just</font>

1144
00:48:06,719 --> 00:48:11,429
install it<font color="#E5E5E5"> back and get it fresh okay</font>

1145
00:48:08,640 --> 00:48:13,859
<font color="#E5E5E5">but they have</font><font color="#CCCCCC"> nothing to detect so I'm</font>

1146
00:48:11,429 --> 00:48:16,799
afraid it worked<font color="#CCCCCC"> it is</font><font color="#E5E5E5"> working as of</font>

1147
00:48:13,859 --> 00:48:18,630
today because none of the<font color="#CCCCCC"> people I</font><font color="#E5E5E5"> I</font>

1148
00:48:16,799 --> 00:48:21,089
inform out those<font color="#E5E5E5"> molarities were</font>

1149
00:48:18,630 --> 00:48:22,949
actually interested<font color="#CCCCCC"> in</font><font color="#E5E5E5"> that so and as</font>

1150
00:48:21,089 --> 00:48:24,119
far as<font color="#E5E5E5"> I know the memory</font><font color="#CCCCCC"> foreign six</font>

1151
00:48:22,949 --> 00:48:25,380
<font color="#CCCCCC">analyst</font><font color="#E5E5E5"> out</font><font color="#CCCCCC"> there they're still not</font>

1152
00:48:24,119 --> 00:48:28,289
protecting<font color="#E5E5E5"> or monitoring their own</font>

1153
00:48:25,380 --> 00:48:30,659
<font color="#CCCCCC">platforms so as of as a concept</font>

1154
00:48:28,289 --> 00:48:33,449
these still works<font color="#E5E5E5"> nowadays</font><font color="#CCCCCC"> and that's</font>

1155
00:48:30,659 --> 00:48:37,439
how I managed<font color="#CCCCCC"> to defeat or win the</font>

1156
00:48:33,449 --> 00:48:40,970
challenge<font color="#E5E5E5"> okay</font><font color="#CCCCCC"> and that would be so if</font>

1157
00:48:37,439 --> 00:48:42,379
you have any questions thank you you

1158
00:48:40,970 --> 00:48:44,540
for your breaks off from<font color="#E5E5E5"> memory</font>

1159
00:48:42,380 --> 00:48:47,140
forensics how do we have any questions

1160
00:48:44,540 --> 00:48:47,140
<font color="#E5E5E5">in the room</font>

1161
00:48:48,339 --> 00:48:55,819
<font color="#E5E5E5">yes we have one hello</font>

1162
00:48:53,900 --> 00:48:57,619
my wife is<font color="#CCCCCC"> watching me I'm testing high</font>

1163
00:48:55,819 --> 00:49:00,050
because<font color="#CCCCCC"> this Benny stream so somewhere</font>

1164
00:48:57,619 --> 00:49:01,730
<font color="#CCCCCC">in there is a camera so hello Elly what</font>

1165
00:49:00,050 --> 00:49:03,650
what did<font color="#E5E5E5"> the guy say to you the the</font>

1166
00:49:01,730 --> 00:49:06,440
<font color="#CCCCCC">judge what was his response</font><font color="#E5E5E5"> to you the</font>

1167
00:49:03,650 --> 00:49:08,420
judge for the<font color="#E5E5E5"> contest</font><font color="#CCCCCC"> there</font><font color="#E5E5E5"> are</font>

1168
00:49:06,440 --> 00:49:12,349
brilliant<font color="#CCCCCC"> and lunatic</font><font color="#E5E5E5"> you are brilliant</font>

1169
00:49:08,420 --> 00:49:14,359
<font color="#E5E5E5">military</font><font color="#CCCCCC"> yeah you</font><font color="#E5E5E5"> are actually</font><font color="#CCCCCC"> one of</font>

1170
00:49:12,349 --> 00:49:16,099
them was the referee<font color="#E5E5E5"> that in the end was</font>

1171
00:49:14,359 --> 00:49:17,900
<font color="#CCCCCC">the one doing</font><font color="#E5E5E5"> the analysis the one that</font>

1172
00:49:16,099 --> 00:49:20,270
was kind of<font color="#E5E5E5"> defeated was mad at me</font><font color="#CCCCCC"> a</font>

1173
00:49:17,900 --> 00:49:22,339
little<font color="#CCCCCC"> bit because I was exploiting his</font>

1174
00:49:20,270 --> 00:49:23,990
<font color="#E5E5E5">machine and he didn't like it</font><font color="#CCCCCC"> and he was</font>

1175
00:49:22,339 --> 00:49:26,328
not on<font color="#E5E5E5"> the stage to defend itself but</font>

1176
00:49:23,990 --> 00:49:35,868
himself idea<font color="#E5E5E5"> now we're friends again</font><font color="#CCCCCC"> I</font>

1177
00:49:26,329 --> 00:49:37,670
think<font color="#CCCCCC"> I think</font><font color="#E5E5E5"> so so anybody</font><font color="#CCCCCC"> else if I</font>

1178
00:49:35,869 --> 00:49:39,710
have<font color="#E5E5E5"> seen yeah have you seen</font><font color="#CCCCCC"> real-life</font>

1179
00:49:37,670 --> 00:49:42,589
examples the same kind<font color="#E5E5E5"> of hiding in</font>

1180
00:49:39,710 --> 00:49:44,869
memory<font color="#E5E5E5"> because from memory analysis I've</font>

1181
00:49:42,589 --> 00:49:47,390
done I wouldn't I would not have found

1182
00:49:44,869 --> 00:49:48,950
the<font color="#CCCCCC"> mower and I suppose</font><font color="#E5E5E5"> many of the</font>

1183
00:49:47,390 --> 00:49:52,368
participants<font color="#E5E5E5"> here would not have found</font>

1184
00:49:48,950 --> 00:49:54,770
it the<font color="#E5E5E5"> question is how many of our</font>

1185
00:49:52,369 --> 00:49:57,500
machines are exploited in the<font color="#E5E5E5"> same way</font>

1186
00:49:54,770 --> 00:49:59,060
and we're not<font color="#E5E5E5"> able</font><font color="#CCCCCC"> to detect</font><font color="#E5E5E5"> I wouldn't</font>

1187
00:49:57,500 --> 00:50:01,069
know as you said I'm not aware of any

1188
00:49:59,060 --> 00:50:02,990
case but<font color="#CCCCCC"> that may mean that</font><font color="#E5E5E5"> it's not</font>

1189
00:50:01,069 --> 00:50:05,089
being<font color="#CCCCCC"> used or is not being detected</font><font color="#E5E5E5"> so</font>

1190
00:50:02,990 --> 00:50:08,779
this is security<font color="#E5E5E5"> that's our common they</font>

1191
00:50:05,089 --> 00:50:10,369
<font color="#CCCCCC">stop at you them no so I can tell</font><font color="#E5E5E5"> you I</font>

1192
00:50:08,780 --> 00:50:12,230
<font color="#CCCCCC">never use that on the wild ok this</font><font color="#E5E5E5"> is</font>

1193
00:50:10,369 --> 00:50:17,340
purely for research purposes and<font color="#CCCCCC"> that's</font>

1194
00:50:12,230 --> 00:50:21,010
it I'm a good guy<font color="#E5E5E5"> another question here</font>

1195
00:50:17,340 --> 00:50:22,690
<font color="#CCCCCC">nobody should but</font><font color="#E5E5E5"> a good guy actually</font><font color="#CCCCCC"> a</font>

1196
00:50:21,010 --> 00:50:26,050
comment and a question

1197
00:50:22,690 --> 00:50:30,010
you should have ended the<font color="#E5E5E5"> last slide</font>

1198
00:50:26,050 --> 00:50:31,810
with the<font color="#E5E5E5"> that and having you know your</font>

1199
00:50:30,010 --> 00:50:34,110
your adversary<font color="#CCCCCC"> on the ground or</font>

1200
00:50:31,810 --> 00:50:37,450
something<font color="#E5E5E5"> bleeding that should have been</font>

1201
00:50:34,110 --> 00:50:39,460
<font color="#E5E5E5">slide um I'm just saying that it for the</font>

1202
00:50:37,450 --> 00:50:41,620
video<font color="#E5E5E5"> you know if you're the street</font>

1203
00:50:39,460 --> 00:50:43,540
fighter<font color="#E5E5E5"> you should you should have had</font>

1204
00:50:41,620 --> 00:50:46,210
<font color="#E5E5E5">your adversary on</font><font color="#CCCCCC"> the ground bleeding</font>

1205
00:50:43,540 --> 00:50:48,400
something<font color="#E5E5E5"> for no no need</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> that but</font>

1206
00:50:46,210 --> 00:50:50,980
but the<font color="#E5E5E5"> question I have so you mentioned</font>

1207
00:50:48,400 --> 00:50:53,110
a lot<font color="#CCCCCC"> of the automation</font><font color="#E5E5E5"> like the memory</font>

1208
00:50:50,980 --> 00:50:54,370
forensics<font color="#CCCCCC"> automation tool like</font><font color="#E5E5E5"> radar and</font>

1209
00:50:53,110 --> 00:50:56,080
volatility

1210
00:50:54,370 --> 00:50:58,930
what happened<font color="#E5E5E5"> if someone just cracked it</font>

1211
00:50:56,080 --> 00:51:02,529
open<font color="#CCCCCC"> and windbg and and just did</font><font color="#E5E5E5"> it</font>

1212
00:50:58,930 --> 00:51:05,319
manually<font color="#E5E5E5"> can you know like really</font>

1213
00:51:02,530 --> 00:51:08,320
intricately what and<font color="#CCCCCC"> step the stacks and</font>

1214
00:51:05,320 --> 00:51:11,440
look through<font color="#CCCCCC"> it I mean if you execute</font>

1215
00:51:08,320 --> 00:51:13,120
<font color="#E5E5E5">the volatility you stop it with a</font>

1216
00:51:11,440 --> 00:51:14,530
debugger and<font color="#E5E5E5"> then you go step by step do</font>

1217
00:51:13,120 --> 00:51:16,299
a proper analysis of the<font color="#CCCCCC"> frying time</font>

1218
00:51:14,530 --> 00:51:18,250
you're gonna find it<font color="#E5E5E5"> because</font><font color="#CCCCCC"> I didn't</font>

1219
00:51:16,300 --> 00:51:19,840
prepare today I mean<font color="#E5E5E5"> also</font><font color="#CCCCCC"> ant</font>

1220
00:51:18,250 --> 00:51:21,580
<font color="#E5E5E5">expectation and anti debugging</font>

1221
00:51:19,840 --> 00:51:23,920
techniques that would<font color="#E5E5E5"> be like no no just</font>

1222
00:51:21,580 --> 00:51:26,080
too much<font color="#E5E5E5"> no no if they do that with a</font>

1223
00:51:23,920 --> 00:51:28,270
debugger<font color="#E5E5E5"> they both have done that with a</font>

1224
00:51:26,080 --> 00:51:30,700
debugger it would be either<font color="#E5E5E5"> easy to find</font>

1225
00:51:28,270 --> 00:51:32,440
and by the way no I don't have the

1226
00:51:30,700 --> 00:51:34,240
<font color="#CCCCCC">beautiful machine</font><font color="#E5E5E5"> with this on</font><font color="#CCCCCC"> my laptop</font>

1227
00:51:32,440 --> 00:51:35,800
<font color="#CCCCCC">no need to steal it</font><font color="#E5E5E5"> if you're gonna use</font>

1228
00:51:34,240 --> 00:51:37,209
<font color="#E5E5E5">the game it's</font><font color="#CCCCCC"> ok but no need</font><font color="#E5E5E5"> to run away</font>

1229
00:51:35,800 --> 00:51:41,230
with it there is no exploit here no

1230
00:51:37,210 --> 00:51:46,120
nothing<font color="#E5E5E5"> ok any more questions from the</font>

1231
00:51:41,230 --> 00:51:48,580
<font color="#E5E5E5">room no then I</font><font color="#CCCCCC"> wanna</font><font color="#E5E5E5"> thank you about</font>

1232
00:51:46,120 --> 00:51:50,520
this about<font color="#E5E5E5"> your story about this not so</font>

1233
00:51:48,580 --> 00:51:56,140
flawless victory<font color="#E5E5E5"> it was full of flaws</font>

1234
00:51:50,520 --> 00:52:00,100
and and in about<font color="#E5E5E5"> eight minutes</font><font color="#CCCCCC"> from now</font>

1235
00:51:56,140 --> 00:52:01,390
we'll<font color="#CCCCCC"> have the</font><font color="#E5E5E5"> next speaker and I hope</font>

1236
00:52:00,100 --> 00:52:04,120
to see you there he will<font color="#E5E5E5"> be</font><font color="#CCCCCC"> talking</font>

1237
00:52:01,390 --> 00:52:06,310
<font color="#E5E5E5">about a simple</font><font color="#CCCCCC"> implementation of a</font>

1238
00:52:04,120 --> 00:52:10,290
hardware wallets<font color="#CCCCCC"> H wallets</font>

1239
00:52:06,310 --> 00:52:10,290
[Applause]

