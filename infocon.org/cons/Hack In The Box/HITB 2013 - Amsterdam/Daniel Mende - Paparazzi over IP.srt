1
00:00:02,159 --> 00:00:07,570
well

2
00:00:07,570 --> 00:00:14,570
okay I'll

3
00:00:15,730 --> 00:00:21,720
yes for

4
00:00:21,720 --> 00:00:25,290
yet hello everybody at arm nice to see

5
00:00:25,290 --> 00:00:30,120
so much people here this early so you
all survived yesterday night that's

6
00:00:30,120 --> 00:00:33,460
a good time okay um

7
00:00:33,460 --> 00:00:37,090
hello again I'm Daniel

8
00:00:37,090 --> 00:00:41,060
and I will talk a little bit about the

9
00:00:41,060 --> 00:00:44,060
this camera in front

10
00:00:44,060 --> 00:00:47,780
obviously I that's why I love you
because that's cool camera

11
00:00:47,780 --> 00:00:51,110
as net so I'll

12
00:00:51,110 --> 00:00:55,870
yeah okay we will go through the agenda
for a short moment so I got a little

13
00:00:55,870 --> 00:00:56,800
introduction

14
00:00:56,800 --> 00:01:00,399
um why are we in to this topic arm
what's the

15
00:01:00,399 --> 00:01:03,540
Reza and where is the security coming
into play

16
00:01:03,540 --> 00:01:08,270
than I had a look at the specific
network interfaces of this camera so

17
00:01:08,270 --> 00:01:12,159
for us we've gone through the transfer
protocols after wats

18
00:01:12,159 --> 00:01:16,260
I would say a world of lawyers on the
communication modes of the cameras

19
00:01:16,260 --> 00:01:20,530
and specific attacks against those
communication modes in the end there

20
00:01:20,530 --> 00:01:22,210
will be some conclusions

21
00:01:22,210 --> 00:01:28,690
but we got to this releases okay so um

22
00:01:28,690 --> 00:01:32,320
Canon recently put out the serious of

23
00:01:32,320 --> 00:01:37,049
high and DSLR cameras with
network-enabled interfaces

24
00:01:37,049 --> 00:01:42,640
so I'll we did some research on those
cameras and

25
00:01:42,640 --> 00:01:46,229
a try to clone point out all the
security flaws involved

26
00:01:46,229 --> 00:01:49,939
and reasonable attack pass against those
security flaws

27
00:01:49,939 --> 00:01:54,790
so I'm speaking about the can flagship
camera which is the one the axe

28
00:01:54,790 --> 00:01:59,119
you see in front here and you know that
the camera again

29
00:01:59,119 --> 00:02:02,500
are it's not that big real but it's
quite heavy

30
00:02:02,500 --> 00:02:06,140
so and at can you say

31
00:02:06,140 --> 00:02:09,800
got some really nice marketing they say
okay we know God and

32
00:02:09,800 --> 00:02:14,580
built in Ethernet port but a lot of fast
and easy transfer of images directly to

33
00:02:14,580 --> 00:02:15,230
the clout

34
00:02:15,230 --> 00:02:18,310
I'll also there is

35
00:02:18,310 --> 00:02:21,470
a wireless interface on this cover-up so

36
00:02:21,470 --> 00:02:25,540
you can even upload the images to the
cloud from any hot spots around the

37
00:02:25,540 --> 00:02:26,410
world

38
00:02:26,410 --> 00:02:29,720
so is not amazing up

39
00:02:29,720 --> 00:02:34,500
yeah SEC this camera got in really fun
at port on the site

40
00:02:34,500 --> 00:02:38,390
and the worse one of the main reasons
for

41
00:02:38,390 --> 00:02:42,360
looking into this camera getting into
all the protocols and stuff

42
00:02:42,360 --> 00:02:45,520
on look if cannon to go top

43
00:02:45,520 --> 00:02:50,040
and kind of implementing the network
interfaces so

44
00:02:50,040 --> 00:02:53,640
as i sat there is also a wireless
interface available for the camera it

45
00:02:53,640 --> 00:02:54,250
comes

46
00:02:54,250 --> 00:02:58,989
in form of a little adapter you have to
you're screwed on with some proprietary

47
00:02:58,989 --> 00:03:00,300
connection

48
00:03:00,300 --> 00:03:04,069
and it's all really expensive stuff so
only for profile

49
00:03:04,069 --> 00:03:07,870
photographers arm on one swift too much
money

50
00:03:07,870 --> 00:03:12,220
I'll yeah actually it's a nice torrid

51
00:03:12,220 --> 00:03:16,750
but is it secures the question so

52
00:03:16,750 --> 00:03:21,069
who is the target who is concerned about
security reasons with

53
00:03:21,069 --> 00:03:25,540
those kind of cameras yeah it's mainly
the target they came missed the right

54
00:03:25,540 --> 00:03:26,250
earth

55
00:03:26,250 --> 00:03:29,420
as you see that using a bunch of those
cameras

56
00:03:29,420 --> 00:03:33,459
and standing there in Kerala it's just
taking some photos

57
00:03:33,459 --> 00:03:36,769
and near believe me

58
00:03:36,769 --> 00:03:40,269
um like photojournalists really love to
feature

59
00:03:40,269 --> 00:03:43,430
of the network interface and the wifi
connection

60
00:03:43,430 --> 00:03:47,909
because they can instantly review the
pictures on the iPad I'm

61
00:03:47,909 --> 00:03:51,230
just pushed some some screens

62
00:03:51,230 --> 00:03:55,250
uploaded to wherever the images are
supposed to go

63
00:03:55,250 --> 00:03:59,239
so it's really nice in case of the image
flow

64
00:03:59,239 --> 00:04:05,709
so your also nice and some other cases
but we will see you

65
00:04:05,709 --> 00:04:09,599
okay what could possibly go wrong

66
00:04:09,599 --> 00:04:12,799
if we were able to the i'd get the

67
00:04:12,799 --> 00:04:15,870
real I needed it footage forrest so

68
00:04:15,870 --> 00:04:19,829
download all the uncensored pictures
from the camera directly

69
00:04:19,829 --> 00:04:23,939
from the event or what would happen

70
00:04:23,939 --> 00:04:29,009
if we were able to upload some images to
the camera like put on some bad images

71
00:04:29,009 --> 00:04:32,550
you don't want to have in your camera
and 1.02 photographer

72
00:04:32,550 --> 00:04:37,300
to some security guys he got really bad
images you should take a look at that

73
00:04:37,300 --> 00:04:40,479
camera are even worse

74
00:04:40,479 --> 00:04:44,830
what happens if were able to turn the
camera in the surveillance device

75
00:04:44,830 --> 00:04:49,369
ok so

76
00:04:49,369 --> 00:04:52,699
will get onto this first

77
00:04:52,699 --> 00:04:56,039
ripped the underlying transport protocol

78
00:04:56,039 --> 00:04:59,389
which is obviously you got some

79
00:04:59,389 --> 00:05:03,529
layer 2 connection you finna although
way flan

80
00:05:03,529 --> 00:05:06,639
arm its own

81
00:05:06,639 --> 00:05:10,710
stand that you cannot port and also it
stand up

82
00:05:10,710 --> 00:05:14,539
while Islam there's nothing special
about that feed

83
00:05:14,539 --> 00:05:19,520
arm from communication modes all use
than a TCP IP

84
00:05:19,520 --> 00:05:23,869
by which I mean ipv4 there is no ipv6
come around the

85
00:05:23,869 --> 00:05:27,909
support from the camera yet but Deng

86
00:05:27,909 --> 00:05:34,559
yeah I don't think they will get any
ipv6 support in the near future

87
00:05:34,559 --> 00:05:38,449
okay so speaking about traditional
attacks

88
00:05:38,449 --> 00:05:42,180
we first had a look on player to have
the camera which means

89
00:05:42,180 --> 00:05:46,020
like all the spooky even its tough one
to two

90
00:05:46,020 --> 00:05:50,550
means like op scooping arm this is
possible on the camera

91
00:05:50,550 --> 00:05:54,189
so the camera doesn't hold any sticky
%ah pantries or

92
00:05:54,189 --> 00:05:57,289
anything fancy like this you can just

93
00:05:57,289 --> 00:06:00,999
up in real time just replace of entries

94
00:06:00,999 --> 00:06:04,319
and you in the optics

95
00:06:04,319 --> 00:06:07,339
also if you start flooding the camera
with

96
00:06:07,339 --> 00:06:10,399
when high amount of network packets us
like

97
00:06:10,399 --> 00:06:15,080
I did the test with some some I'm
operate quests

98
00:06:15,080 --> 00:06:19,379
then you will get to limit of around 100
packets per second

99
00:06:19,379 --> 00:06:24,379
before the network stack up the camera
completely dice

100
00:06:24,379 --> 00:06:29,059
market yeah I'm one could say it's an
embedded device it's not made for

101
00:06:29,059 --> 00:06:34,589
like handling network traffic but also
if I gotta a 6k camera

102
00:06:34,589 --> 00:06:39,059
it should be possible to process more
than 100 packets per second

103
00:06:39,059 --> 00:06:42,169
all by the way I was speaking about ipv6

104
00:06:42,169 --> 00:06:46,270
some funny thing we figured out if you
put this camera and a network

105
00:06:46,270 --> 00:06:49,330
which is ipv6 enabled the network stack

106
00:06:49,330 --> 00:06:53,429
immediately dice so I guess that's this
because

107
00:06:53,429 --> 00:06:58,319
it can probably handle all the multicast
traffic

108
00:06:58,319 --> 00:07:01,659
Barack I'm not quite sure so but I just

109
00:07:01,659 --> 00:07:04,990
figured out aka of the cameras are
working so for you

110
00:07:04,990 --> 00:07:10,050
better should disable ipv6

111
00:07:10,050 --> 00:07:14,069
so those nothing fancy you are nothing
new so we moved on to the

112
00:07:14,069 --> 00:07:17,449
next up a layer which is that TCPIP

113
00:07:17,449 --> 00:07:22,080
arm this VIP issues for all further
communications

114
00:07:22,080 --> 00:07:26,529
I don't think the camera even implements
like annually please stack

115
00:07:26,529 --> 00:07:30,469
um also when speaking about the CPU
wanna to

116
00:07:30,469 --> 00:07:33,919
check if it's possible to terminate
established connections

117
00:07:33,919 --> 00:07:38,800
this is also easy me doable while your
sending some TCP resets

118
00:07:38,800 --> 00:07:42,459
you just have to hit the right window
I'll

119
00:07:42,459 --> 00:07:46,659
which also isn't that hard because of
the crappy TCP stack

120
00:07:46,659 --> 00:07:49,699
so there is no window arm

121
00:07:49,699 --> 00:07:53,259
changing in size or anything fancy like
up

122
00:07:53,259 --> 00:07:57,199
okay remember the last point arm will
come back to this

123
00:07:57,199 --> 00:08:01,229
in the end

124
00:08:01,229 --> 00:08:04,929
so okay that's so far from the network
site

125
00:08:04,929 --> 00:08:09,050
there's nothing fancy it uses a effin at
ECPI peep

126
00:08:09,050 --> 00:08:13,169
not worried very well implemented part

127
00:08:13,169 --> 00:08:16,550
man its kinda working most of the time

128
00:08:16,550 --> 00:08:20,489
so let's have a look at communication
modes to camera

129
00:08:20,489 --> 00:08:25,099
got problem for so-called communication
modes which you can configure

130
00:08:25,099 --> 00:08:28,689
over the menu on the back of the camera
both of our

131
00:08:28,689 --> 00:08:31,830
okay you got some FTP Upload malt

132
00:08:31,830 --> 00:08:35,649
you got them deal in a moat we're
getting to this point in detail in

133
00:08:35,649 --> 00:08:36,719
second

134
00:08:36,719 --> 00:08:41,159
um he also got a built-in web server and
you got in moat that

135
00:08:41,159 --> 00:08:44,610
is called yes utility malt we'll see
what what

136
00:08:44,610 --> 00:08:48,100
Heights beyond that later on

137
00:08:48,100 --> 00:08:52,860
okay so first the FTP Upload mold

138
00:08:52,860 --> 00:08:56,930
this is and nothing really spectacular

139
00:08:56,930 --> 00:09:02,079
it's just a camera speaking FTP so you
configure and target FTP server

140
00:09:02,079 --> 00:09:06,690
on the back of the camera arm which is
kind of a real pain because you have to

141
00:09:06,690 --> 00:09:07,680
dial in

142
00:09:07,680 --> 00:09:10,779
all the numbers why over

143
00:09:10,779 --> 00:09:14,839
whatever but I love the back you've just
got a few patterns so

144
00:09:14,839 --> 00:09:18,170
of know it's hard to configured

145
00:09:18,170 --> 00:09:21,670
you're a target server in the
credentials on the camera if you try to

146
00:09:21,670 --> 00:09:24,410
use secure passwords

147
00:09:24,410 --> 00:09:28,170
arm once you get all this configured on
the camera

148
00:09:28,170 --> 00:09:31,250
and you got this network mode enabled

149
00:09:31,250 --> 00:09:35,480
and take some photos 2 photos are
immediately uploaded

150
00:09:35,480 --> 00:09:39,110
to the FTP server

151
00:09:39,110 --> 00:09:42,879
market yet that might come in handy for
some photographer

152
00:09:42,879 --> 00:09:46,629
who just wants to upload images directly
to the cloud

153
00:09:46,629 --> 00:09:51,730
this way much scar it goes the status

154
00:09:51,730 --> 00:09:55,949
factors so the downside with the FTP
Upload motus yeah oh well

155
00:09:55,949 --> 00:10:00,149
FTP is clear text so want to get

156
00:10:00,149 --> 00:10:03,639
your hands on a date are you can easily
extract

157
00:10:03,639 --> 00:10:09,439
all the credentials as well as to
complete data transmission

158
00:10:09,439 --> 00:10:12,709
Sol uploaded pictures

159
00:10:12,709 --> 00:10:16,160
can be extracted from a network problem

160
00:10:16,160 --> 00:10:19,290
so if you are able to sniff

161
00:10:19,290 --> 00:10:22,660
today to traffic after camera in this
communication mode

162
00:10:22,660 --> 00:10:26,709
you will get all the images as well as
all the a state credentials for the FTP

163
00:10:26,709 --> 00:10:28,730
server

164
00:10:28,730 --> 00:10:33,089
order I just got this pointed out your
little bit so

165
00:10:33,089 --> 00:10:37,089
are for those of you never extracted
something from

166
00:10:37,089 --> 00:10:41,170
FTP stream or but safe from harm

167
00:10:41,170 --> 00:10:44,750
TCP connection in general they're all

168
00:10:44,750 --> 00:10:48,660
a there is one nice little too which is
called TCP flow all

169
00:10:48,660 --> 00:10:52,310
you just call it um over

170
00:10:52,310 --> 00:10:55,500
network numbers argument and it will
extract

171
00:10:55,500 --> 00:11:01,110
all the TCP sessions that are in this
network traits

172
00:11:01,110 --> 00:11:04,490
so once you get the TCP sessions
extracted

173
00:11:04,490 --> 00:11:08,699
you can call some to like for most which
just

174
00:11:08,699 --> 00:11:11,870
the flight data recovery so it looks for

175
00:11:11,870 --> 00:11:14,980
images in this state the stream

176
00:11:14,980 --> 00:11:19,319
aunt your just fro the malt

177
00:11:19,319 --> 00:11:24,720
have Tapex and after what you got all
the images that were transferred over

178
00:11:24,720 --> 00:11:27,040
the network

179
00:11:27,040 --> 00:11:30,040
psalm also this is nothing fancy here

180
00:11:30,040 --> 00:11:33,220
just for completeness sake

181
00:11:33,220 --> 00:11:36,759
there is an FTP Upload mode if you use a
moat be aware

182
00:11:36,759 --> 00:11:41,350
FTPS uninterrupted and everyone who sees
your data traffic

183
00:11:41,350 --> 00:11:47,970
is able to expected credentials as well
as the images

184
00:11:47,970 --> 00:11:51,560
saw okay let's move on to the next mod

185
00:11:51,560 --> 00:11:56,060
the so-called the eliminate deal in a
stands for digital Living Network

186
00:11:56,060 --> 00:11:57,350
Alliance

187
00:11:57,350 --> 00:12:00,959
which is an Alliance of mostly vendors

188
00:12:00,959 --> 00:12:04,290
who defined some specs

189
00:12:04,290 --> 00:12:07,860
for exchanging media files

190
00:12:07,860 --> 00:12:10,949
arm first suspect suffocate devices

191
00:12:10,949 --> 00:12:14,370
use I'll UPnP

192
00:12:14,370 --> 00:12:17,399
for discovering each other so

193
00:12:17,399 --> 00:12:20,430
that also means that once the cameras in
this mall

194
00:12:20,430 --> 00:12:23,779
it starts screaming you pinky

195
00:12:23,779 --> 00:12:26,800
against some meticulous address

196
00:12:26,800 --> 00:12:31,019
so we will easily find the camera in
this networking alt

197
00:12:31,019 --> 00:12:34,100
than all what

198
00:12:34,100 --> 00:12:38,569
up than a deal in a also defines

199
00:12:38,569 --> 00:12:42,990
guidelines for file formats and coatings
and resolution

200
00:12:42,990 --> 00:12:47,709
so maybe if you're if your TV is still
in a

201
00:12:47,709 --> 00:12:51,209
compliant in any way it supports some

202
00:12:51,209 --> 00:12:55,569
a specified file formats let's say like
day pack or like

203
00:12:55,569 --> 00:12:58,699
and pick files and also

204
00:12:58,699 --> 00:13:01,920
in specific resolutions

205
00:13:01,920 --> 00:13:04,959
and after what stealing a also defines
the

206
00:13:04,959 --> 00:13:09,019
X a small to get to those media files
which is in this case

207
00:13:09,019 --> 00:13:14,040
HTML and HTTP and XML

208
00:13:14,040 --> 00:13:17,589
so in this motor camera files up

209
00:13:17,589 --> 00:13:22,040
like a web server and on a web server
are some

210
00:13:22,040 --> 00:13:25,170
XML files which just described nigga
from

211
00:13:25,170 --> 00:13:28,839
the repealing the ready device you can
find the file listing

212
00:13:28,839 --> 00:13:32,189
within this XML file or I'm

213
00:13:32,189 --> 00:13:37,519
I got some nice live pictures for you

214
00:13:37,519 --> 00:13:42,589
packet so again the cons with this
network notice

215
00:13:42,589 --> 00:13:46,129
deal in a cup no authentication at all

216
00:13:46,129 --> 00:13:49,389
so ver isn't any authentication defiant

217
00:13:49,389 --> 00:13:54,350
authentication is being able to speak to
the device

218
00:13:54,350 --> 00:13:58,050
also there are no restrictions in case
of who can see you

219
00:13:58,050 --> 00:14:01,740
which pictures are which pictures are

220
00:14:01,740 --> 00:14:07,800
I'll scene anyway are who's able to
download those pictures

221
00:14:07,800 --> 00:14:11,540
so want to get the camera in this
network mode connect that

222
00:14:11,540 --> 00:14:15,029
and you're able to speak to the camera
you can download

223
00:14:15,029 --> 00:14:18,139
all images it just need invalid

224
00:14:18,139 --> 00:14:21,529
deal in a client aunt have

225
00:14:21,529 --> 00:14:26,029
deal in a race using HTTP XML also your
bros I could be

226
00:14:26,029 --> 00:14:31,139
and the other night life are somebody
else sprawls up

227
00:14:31,139 --> 00:14:34,459
so in this mode it's also not hard to
get

228
00:14:34,459 --> 00:14:37,699
your fingers on the foot you just have
to browse and

229
00:14:37,699 --> 00:14:44,559
to to the camera and almost human tissue
like

230
00:14:44,559 --> 00:14:48,920
okay yeah that's kinda boring

231
00:14:48,920 --> 00:14:52,350
and was the first to network moats and
both are

232
00:14:52,350 --> 00:14:57,930
like broken by the site but it's okay if
you're aware of this and if you want to

233
00:14:57,930 --> 00:14:58,809
use FTP

234
00:14:58,809 --> 00:15:05,809
just use FTP

235
00:15:06,629 --> 00:15:10,069
so okay um

236
00:15:10,069 --> 00:15:14,170
let's move on to the next malt which is
the built-in web server

237
00:15:14,170 --> 00:15:18,170
re: abouts always a great idea
especially when it comes to embedded

238
00:15:18,170 --> 00:15:19,730
devices

239
00:15:19,730 --> 00:15:26,680
I would say every embedded device should
happen built-in web server

240
00:15:26,680 --> 00:15:29,720
I'll of so

241
00:15:29,720 --> 00:15:33,100
this our communication mode this call to

242
00:15:33,100 --> 00:15:38,769
W FTP server are sometimes also say WTF
so over

243
00:15:38,769 --> 00:15:43,939
um which is the wireless file
transmitter sophomore

244
00:15:43,939 --> 00:15:47,410
I also got some really nice marketing
from

245
00:15:47,410 --> 00:15:50,579
can you say to see a use a web browser
to

246
00:15:50,579 --> 00:15:54,569
capture view and download images
remotely

247
00:15:54,569 --> 00:15:57,600
so that implies you can also remote
control the camera

248
00:15:57,600 --> 00:16:03,809
wired a built-in web browser none that
might come in handy

249
00:16:03,809 --> 00:16:06,930
bottom the question is

250
00:16:06,930 --> 00:16:10,360
is the web server secure

251
00:16:10,360 --> 00:16:17,089
arm its users and browser interface with
a lot of HX in the background

252
00:16:17,089 --> 00:16:21,269
so again HTTP and XML

253
00:16:21,269 --> 00:16:24,769
so those to types of

254
00:16:24,769 --> 00:16:28,720
horribly the HTTP protocol and XML
parser needs to be

255
00:16:28,720 --> 00:16:32,470
within the camera their reuse all the
time

256
00:16:32,470 --> 00:16:35,899
but the embedded Web server is only
capable

257
00:16:35,899 --> 00:16:39,519
of the HTTP GET method all the other
methods

258
00:16:39,519 --> 00:16:43,639
are not implement not even the hat of
something like this

259
00:16:43,639 --> 00:16:50,639
so it's just a very small very stupid
web server

260
00:16:50,939 --> 00:16:56,589
occur arm the good news is that they're
is some kind of indication in this mold

261
00:16:56,589 --> 00:17:00,619
so you for sprawls through a landing
page or login page

262
00:17:00,619 --> 00:17:05,429
and there is some HTTP basic
authentication

263
00:17:05,429 --> 00:17:08,789
this again as not so good because again

264
00:17:08,789 --> 00:17:13,409
if you're like in the better flow if you
have your hands on the traffic

265
00:17:13,409 --> 00:17:17,829
you could extract the authentication
credentials as well

266
00:17:17,829 --> 00:17:22,309
um but okay this it to be basic request

267
00:17:22,309 --> 00:17:25,459
is actually a cent only once on the
login page

268
00:17:25,459 --> 00:17:29,399
and after wat a Session II session
cookies used

269
00:17:29,399 --> 00:17:33,130
for further affect the case

270
00:17:33,130 --> 00:17:37,200
so on the first view that doesn't look
so pat

271
00:17:37,200 --> 00:17:41,059
first there is authentication and okay
maybe it's not the

272
00:17:41,059 --> 00:17:44,380
best authentication method but they only
use it once

273
00:17:44,380 --> 00:17:48,510
arm after what's there are some other
mechanism

274
00:17:48,510 --> 00:17:51,549
so but here's the downside

275
00:17:51,549 --> 00:17:55,279
that's what the cookie looks like

276
00:17:55,279 --> 00:17:58,350
what could possibly go wrong

277
00:17:58,350 --> 00:18:02,980
your euro its and 4-byte session ID

278
00:18:02,980 --> 00:18:06,909
I'll by the way it's more like

279
00:18:06,909 --> 00:18:10,570
this this number spaces all X

280
00:18:10,570 --> 00:18:14,279
so again it's more like to bite session
ID

281
00:18:14,279 --> 00:18:18,529
which is not that much

282
00:18:18,529 --> 00:18:23,840
arm so what the fuck

283
00:18:23,840 --> 00:18:27,370
okay a

284
00:18:27,370 --> 00:18:30,549
we've implemented nice little brute
force of a session ID

285
00:18:30,549 --> 00:18:34,000
just to have a shot or proof-of-concept

286
00:18:34,000 --> 00:18:37,669
I can so to you and it was implemented
in like

287
00:18:37,669 --> 00:18:42,570
yes six lines of Python so real hard
work

288
00:18:42,570 --> 00:18:46,740
are what it does it just text all
possible session ID's

289
00:18:46,740 --> 00:18:50,200
and but downside is to check

290
00:18:50,200 --> 00:18:54,539
every of those ideas that takes about 20
minutes

291
00:18:54,539 --> 00:18:57,630
because again the web server which is
billed in this

292
00:18:57,630 --> 00:19:02,380
kind of not the past one and it's not
that responsive

293
00:19:02,380 --> 00:19:06,270
so every request takes and amount of
time

294
00:19:06,270 --> 00:19:10,549
and that's why I drams upping the ante
to like 20 minutes to check also denied

295
00:19:10,549 --> 00:19:13,840
its

296
00:19:13,840 --> 00:19:17,020
okay I got a short video of this

297
00:19:17,020 --> 00:19:21,230
just two give you an idea

298
00:19:21,230 --> 00:19:28,230
wanted looks like see

299
00:19:29,279 --> 00:19:34,070
you know

300
00:19:34,070 --> 00:19:37,950
okay so this is just a

301
00:19:37,950 --> 00:19:43,210
the little brute forcing script which is
now

302
00:19:43,210 --> 00:19:46,830
running against the camera you see a
cape 1000 ideas

303
00:19:46,830 --> 00:19:50,000
checked and

304
00:19:50,000 --> 00:19:53,700
it just runs and keeps trying each
session ID

305
00:19:53,700 --> 00:19:56,810
no against the login page because the
login page is the

306
00:19:56,810 --> 00:20:00,610
very good diet indicator if you're
successfully

307
00:20:00,610 --> 00:20:04,320
figured out the right session ID or not
because it's s

308
00:20:04,320 --> 00:20:08,660
um if you come within session ID thats
ability just

309
00:20:08,660 --> 00:20:12,420
prompts you to log in again but if you
came with such an idea but is

310
00:20:12,420 --> 00:20:16,350
validate it just redirects you to the
main site

311
00:20:16,350 --> 00:20:19,790
okay so we just all

312
00:20:19,790 --> 00:20:23,490
browse to the camera once to see

313
00:20:23,490 --> 00:20:27,350
okay I'll sorry to use a

314
00:20:27,350 --> 00:20:31,260
a somebody is that the camera you don't
gotta write session ID

315
00:20:31,260 --> 00:20:34,870
please go to the login page and login
again may be lost

316
00:20:34,870 --> 00:20:38,840
your cookie somehow but none

317
00:20:38,840 --> 00:20:42,390
we already got the cookie we just need
to put it in there

318
00:20:42,390 --> 00:20:45,710
type session ID

319
00:20:45,710 --> 00:20:49,070
that the value the sirohi

320
00:20:49,070 --> 00:20:53,410
and

321
00:20:53,410 --> 00:20:56,550
you submit the cookie chains and
reloading the page

322
00:20:56,550 --> 00:21:00,670
and afterwards to see we're successfully
authenticated

323
00:21:00,670 --> 00:21:03,670
and this is the nice interface

324
00:21:03,670 --> 00:21:06,880
and now we can remotely control the
camera

325
00:21:06,880 --> 00:21:11,460
ok

326
00:21:11,460 --> 00:21:16,820
so just to give you an idea of how easy
it is to break this

327
00:21:16,820 --> 00:21:23,820
to bite session ID put it so what's
possible once you figure out the right

328
00:21:24,680 --> 00:21:25,160
ID

329
00:21:25,160 --> 00:21:28,270
you got full access to as you saw

330
00:21:28,270 --> 00:21:34,470
and the BTU and mold like the life you
you can also download all stock images

331
00:21:34,470 --> 00:21:37,670
or you can set some settings on the
camera like

332
00:21:37,670 --> 00:21:42,410
you can't put your name inside the field
which is start

333
00:21:42,410 --> 00:21:46,090
in every picture on making

334
00:21:46,090 --> 00:21:49,320
you like the author of the picture

335
00:21:49,320 --> 00:21:52,380
all the owner no

336
00:21:52,380 --> 00:21:56,370
could come in handy if you wanna wanna
get some

337
00:21:56,370 --> 00:22:01,010
some money for pictures which argues
when it says in the exit

338
00:22:01,010 --> 00:22:05,030
okay so you surf we proved that support

339
00:22:05,030 --> 00:22:08,310
um the only thing you need to make this
attack work

340
00:22:08,310 --> 00:22:12,490
is somebody which is authenticated to
the web server so they need to be at

341
00:22:12,490 --> 00:22:14,260
least the phone bill its social

342
00:22:14,260 --> 00:22:21,260
market yes i sat in it camera in the

343
00:22:21,580 --> 00:22:25,390
WTF server mode you need a valid session

344
00:22:25,390 --> 00:22:29,460
antonin some minutes of time just two
brute force the session

345
00:22:29,460 --> 00:22:33,780
you aka

346
00:22:33,780 --> 00:22:37,610
um I was still for communication mode

347
00:22:37,610 --> 00:22:41,030
and just two not

348
00:22:41,030 --> 00:22:44,600
or you I will jump right into the last
mold

349
00:22:44,600 --> 00:22:47,940
the one at least I'm personally think is
the

350
00:22:47,940 --> 00:22:51,470
most interesting one because it was a
little bit challenging it wasn't that

351
00:22:51,470 --> 00:22:54,420
easy as FTP or the short session ID

352
00:22:54,420 --> 00:22:58,430
all yep this is the yes utility mold

353
00:22:58,430 --> 00:23:02,370
AK I said JK I wanna be rude because
business

354
00:23:02,370 --> 00:23:06,660
as close to Route as you couldn't get on
the camera without

355
00:23:06,660 --> 00:23:13,020
injecting some custom shalt okay

356
00:23:13,020 --> 00:23:16,370
arm here's a screenshot of the yes
utility

357
00:23:16,370 --> 00:23:20,030
that's a tool you install on your
Windows on Mac PC

358
00:23:20,030 --> 00:23:23,610
arm to remotely control the camera

359
00:23:23,610 --> 00:23:26,980
so you can like almost images

360
00:23:26,980 --> 00:23:30,410
a you can going to the remote shooting
stuff

361
00:23:30,410 --> 00:23:34,710
arm missus

362
00:23:34,710 --> 00:23:38,840
whatever remote control of the camera
looks like you got the life you love you

363
00:23:38,840 --> 00:23:39,490
get some

364
00:23:39,490 --> 00:23:43,320
camera controls on the on the right and
so all

365
00:23:43,320 --> 00:23:46,430
so this is more or less

366
00:23:46,430 --> 00:23:53,230
were the attacker wants to go you want
to be able to see the life you have the

367
00:23:53,230 --> 00:23:53,870
camera

368
00:23:53,870 --> 00:23:57,080
are to start want to take some photos

369
00:23:57,080 --> 00:24:02,940
or to download the images so this mode
allows you

370
00:24:02,940 --> 00:24:07,140
the remote control of every non manual

371
00:24:07,140 --> 00:24:10,640
I'll camera function which means I can

372
00:24:10,640 --> 00:24:15,040
concert everything I could set in the
menu I can turn the Lance

373
00:24:15,040 --> 00:24:19,320
or I can take the landscape of that's
the only thing I can to

374
00:24:19,320 --> 00:24:22,480
but everything else is possible well

375
00:24:22,480 --> 00:24:26,580
with this proprietary mold also I can

376
00:24:26,580 --> 00:24:29,880
up and download images

377
00:24:29,880 --> 00:24:33,690
aunt possibly even Morris I'm here in

378
00:24:33,690 --> 00:24:37,280
able to do even more so

379
00:24:37,280 --> 00:24:40,860
I need to put some more time in but
maybe it's also possible to

380
00:24:40,860 --> 00:24:44,440
regret quotes aren't like the camera
gonna

381
00:24:44,440 --> 00:24:50,670
built-in microphone if I can just turn
this on remotely that would be great

382
00:24:50,670 --> 00:24:54,500
by now the way around this just to start
movie recording and download the movie

383
00:24:54,500 --> 00:24:55,280
after what's

384
00:24:55,280 --> 00:25:02,200
because that also the song played a
safety inside of the movie 5

385
00:25:02,200 --> 00:25:06,490
ok so let's speak technically about the
world

386
00:25:06,490 --> 00:25:09,920
the yes it till it IMO to some marketing
name

387
00:25:09,920 --> 00:25:15,660
all it uses internally PTP IP for
communication

388
00:25:15,660 --> 00:25:19,090
maybe some of you have heard about PTP

389
00:25:19,090 --> 00:25:22,790
for picture Transfer Protocol which is

390
00:25:22,790 --> 00:25:25,960
used on almost every

391
00:25:25,960 --> 00:25:29,220
media device distaste like

392
00:25:29,220 --> 00:25:32,220
every camera out there way and that
would mode

393
00:25:32,220 --> 00:25:35,730
or even with them use P part uses

394
00:25:35,730 --> 00:25:40,810
PTP PTP comes from the

395
00:25:40,810 --> 00:25:43,920
from use B side of the camera

396
00:25:43,920 --> 00:25:47,420
or even if you got some Monae part

397
00:25:47,420 --> 00:25:50,770
mp3 player they also speak p2p I P

398
00:25:50,770 --> 00:25:54,050
not not be to be ok im sorry just p2p

399
00:25:54,050 --> 00:25:58,270
um the camera just goes a step further

400
00:25:58,270 --> 00:26:02,400
and uses PTP over the IP protocol

401
00:26:02,400 --> 00:26:05,780
and also there is some magic discovery
happening

402
00:26:05,780 --> 00:26:09,180
because once you connect the camera to
the network and gotta right software

403
00:26:09,180 --> 00:26:11,620
installed on your computer

404
00:26:11,620 --> 00:26:15,520
there's just a magic pop up on yourself
but it's a sucker I have found some

405
00:26:15,520 --> 00:26:19,460
Cam'ron what do you wanna do

406
00:26:19,460 --> 00:26:22,490
um what s

407
00:26:22,490 --> 00:26:26,440
kinda or a first thought that's a good
sign in the network mode

408
00:26:26,440 --> 00:26:29,740
you need an initial camera software
powering

409
00:26:29,740 --> 00:26:33,330
so you need to put the camera in and
pairing mode manually

410
00:26:33,330 --> 00:26:37,950
wilder menu in the back and down will
just pop up on you know

411
00:26:37,950 --> 00:26:42,330
computer into a phone then uninitialized
camera do you want to pair with this

412
00:26:42,330 --> 00:26:43,730
camera now

413
00:26:43,730 --> 00:26:47,110
and then you click on the outer on

414
00:26:47,110 --> 00:26:51,750
are might have a screenshot somewhere
arm

415
00:26:51,750 --> 00:26:54,960
and under computer or your

416
00:26:54,960 --> 00:27:00,630
instance of the year suitability on your
computer is sparing with the camera

417
00:27:00,630 --> 00:27:05,200
so initially I thought there was some of
Education data exchange

418
00:27:05,200 --> 00:27:08,900
which would make sense and this point of
the step because

419
00:27:08,900 --> 00:27:12,680
if you got an initial pairing you should
exchange real

420
00:27:12,680 --> 00:27:19,680
are heart a vindication pate

421
00:27:21,360 --> 00:27:22,679
so

422
00:27:22,679 --> 00:27:25,649
I'll yet the camera must be put into
this mold

423
00:27:25,649 --> 00:27:29,690
manually so you can't do this remotely
and

424
00:27:29,690 --> 00:27:33,210
also the camera signals the need for
pairing

425
00:27:33,210 --> 00:27:37,510
while multicast DNS so

426
00:27:37,510 --> 00:27:41,820
this looks like this that's just the

427
00:27:41,820 --> 00:27:45,880
my to cast the NS pack up Smith from the
camera

428
00:27:45,880 --> 00:27:50,220
and it's just somewhere in here

429
00:27:50,220 --> 00:27:53,240
so far can end up come

430
00:27:53,240 --> 00:27:58,139
and it's a Canon digital camera and also
there is a magic field the

431
00:27:58,139 --> 00:28:02,120
Tidd canada.com which is alcee rose

432
00:28:02,120 --> 00:28:05,299
a1 in all caps if the camera is

433
00:28:05,299 --> 00:28:09,240
in the pairing state so this is quite
easy

434
00:28:09,240 --> 00:28:12,760
detectable like multicast DNS

435
00:28:12,760 --> 00:28:15,809
can be received everywhere I

436
00:28:15,809 --> 00:28:19,779
in the network because it sent to
broadcast address

437
00:28:19,779 --> 00:28:25,630
and so once you find the camera network
sending this magic string

438
00:28:25,630 --> 00:28:29,480
you know okay now I'm ready to go I
can't just start pairing with the camera

439
00:28:29,480 --> 00:28:33,700
yep

440
00:28:33,700 --> 00:28:36,760
this is how the utility looks if it's

441
00:28:36,760 --> 00:28:40,049
detects 10 these multicast DNS packet us

442
00:28:40,049 --> 00:28:43,730
it will just pop up and display the

443
00:28:43,730 --> 00:28:47,019
you the name of the camera the mac
address and the IP address

444
00:28:47,019 --> 00:28:52,740
okay

445
00:28:52,740 --> 00:28:56,260
after Wall the client software

446
00:28:56,260 --> 00:28:59,820
connects the camera in this case while

447
00:28:59,820 --> 00:29:04,289
p2p I P to initialized the

448
00:29:04,289 --> 00:29:08,860
exchange of authentication theory arm

449
00:29:08,860 --> 00:29:13,100
you getting authentication field inside
of p2p IPTV

450
00:29:13,100 --> 00:29:17,289
which is used to transmit the
authentication data you want to use

451
00:29:17,289 --> 00:29:21,970
and the authentication peering state if
the camera is

452
00:29:21,970 --> 00:29:25,649
successfully regardless of the
credentials their

453
00:29:25,649 --> 00:29:29,360
just safet aunt start somewhere

454
00:29:29,360 --> 00:29:33,000
on the camera I'll

455
00:29:33,000 --> 00:29:36,820
the authentication data its name to you
which should be the host name

456
00:29:36,820 --> 00:29:42,750
and some magic to you I did actor

457
00:29:42,750 --> 00:29:46,480
let think a little bit deeper into this
magic protocol

458
00:29:46,480 --> 00:29:49,750
PTP I P which some

459
00:29:49,750 --> 00:29:53,970
of you it's like use be over IP because
it's just a

460
00:29:53,970 --> 00:29:57,309
original picture Transfer Protocol

461
00:29:57,309 --> 00:30:00,559
which was designed for use on use P but

462
00:30:00,559 --> 00:30:04,529
in this case it's just arm used over to
use TCP

463
00:30:04,529 --> 00:30:07,820
so you got all some

464
00:30:07,820 --> 00:30:11,470
ice little small to see packages because
a

465
00:30:11,470 --> 00:30:15,679
packages on the USB bus I'll doesn't get
the

466
00:30:15,679 --> 00:30:18,760
that pic on maximum size

467
00:30:18,760 --> 00:30:22,970
so you will have no problem with with
TCP in the case

468
00:30:22,970 --> 00:30:27,850
market so

469
00:30:27,850 --> 00:30:32,299
PTP I P stands for picture Transfer
Protocol over Internet Protocol

470
00:30:32,299 --> 00:30:36,039
its specified and I S all

471
00:30:36,039 --> 00:30:39,210
and it's done at us by the International

472
00:30:39,210 --> 00:30:43,700
emitting industrial Industry Association
so again

473
00:30:43,700 --> 00:30:47,049
some companies sitting together all

474
00:30:47,049 --> 00:30:53,429
just throwing out some specs from

475
00:30:53,429 --> 00:30:58,020
the pic from artists quite easy it's
Justin wrapper for the

476
00:30:58,020 --> 00:31:01,070
p2p protocol and it at

477
00:31:01,070 --> 00:31:05,090
two fields which is I'll and field and
the Type field

478
00:31:05,090 --> 00:31:12,090
and after wats and just follows the PTP
daytime on call

479
00:31:12,289 --> 00:31:16,179
this is just a screenshot of the
layering so you get the

480
00:31:16,179 --> 00:31:19,330
PTP on top and then you get different

481
00:31:19,330 --> 00:31:23,429
packet types which came from the p2p
IPTV

482
00:31:23,429 --> 00:31:28,260
type field and then again you got TCPIP
and a network where people

483
00:31:28,260 --> 00:31:32,580
um

484
00:31:32,580 --> 00:31:36,629
there is one interesting packet type

485
00:31:36,629 --> 00:31:39,700
in the p2p IP specification which is the

486
00:31:39,700 --> 00:31:44,299
PTP I P unit command request so

487
00:31:44,299 --> 00:31:48,139
this is more or less way to start your
p2p IP connection

488
00:31:48,139 --> 00:31:52,710
this is the initial packet you sent to
the camera for authenticating yourself

489
00:31:52,710 --> 00:31:53,750
or for opening

490
00:31:53,750 --> 00:31:57,690
are MPTP IP session and

491
00:31:57,690 --> 00:32:01,460
this come on I includes

492
00:32:01,460 --> 00:32:05,070
the authentication data which is and

493
00:32:05,070 --> 00:32:09,450
16 bites to you I T and then host name
string

494
00:32:09,450 --> 00:32:13,049
I'm market when I first saw this apart

495
00:32:13,049 --> 00:32:16,190
a wall this looks really secure

496
00:32:16,190 --> 00:32:19,570
figure like and hostname spring and

497
00:32:19,570 --> 00:32:26,480
and 16 byte secret I would be hot to
brute-force

498
00:32:26,480 --> 00:32:29,940
from yep this is what the pack it looks
in hex

499
00:32:29,940 --> 00:32:33,149
so you got packet length in front

500
00:32:33,149 --> 00:32:37,679
a you got the packet type of two walks
which in this case is just

501
00:32:37,679 --> 00:32:41,549
a1 for the in it month request

502
00:32:41,549 --> 00:32:46,700
then you got the GUID this blue string

503
00:32:46,700 --> 00:32:51,720
I'll which is your secret to share it
with the camera

504
00:32:51,720 --> 00:32:56,889
after what you got the hostname which in
this case is just a string so other

505
00:32:56,889 --> 00:33:00,409
encoded in you to have 16

506
00:33:00,409 --> 00:33:03,580
and yeah after what say you got some
trailer

507
00:33:03,580 --> 00:33:08,090
which just as a kid with fact that it's
finished your

508
00:33:08,090 --> 00:33:13,580
in packet remember the blue string for a
second

509
00:33:13,580 --> 00:33:19,510
because we will need this again

510
00:33:19,510 --> 00:33:22,789
make it so let's speak a little bit

511
00:33:22,789 --> 00:33:26,289
of the attack against this network malt

512
00:33:26,289 --> 00:33:31,369
so obviously you have to somehow bypass
the authentication

513
00:33:31,369 --> 00:33:34,440
its not as easy as it might seem

514
00:33:34,440 --> 00:33:40,480
because gifts on the authentication data
is 16 but long

515
00:33:40,480 --> 00:33:43,580
from but

516
00:33:43,580 --> 00:33:47,450
yeah after investigating the case little
bit

517
00:33:47,450 --> 00:33:50,549
arm

518
00:33:50,549 --> 00:33:53,820
the hostname for forest is Mia

519
00:33:53,820 --> 00:33:57,919
easily discoverable if you use in
Windows or Mac PC

520
00:33:57,919 --> 00:34:01,260
because in the default settings they
just spam

521
00:34:01,260 --> 00:34:04,990
the hostname all over the network to
just have to listen for a while

522
00:34:04,990 --> 00:34:09,040
in the network and you see all the hop
hosts that are connected to the network

523
00:34:09,040 --> 00:34:11,800
including the hostnames

524
00:34:11,800 --> 00:34:16,569
so given but the camera is a non
environment word was

525
00:34:16,569 --> 00:34:20,669
appeared initially you could imagine
that

526
00:34:20,669 --> 00:34:25,500
also the hostess a its present in a
network so you just have to try all the

527
00:34:25,500 --> 00:34:27,339
host names to see

528
00:34:27,339 --> 00:34:30,659
in the network than

529
00:34:30,659 --> 00:34:34,490
also GUID

530
00:34:34,490 --> 00:34:38,609
which after some looking and searching

531
00:34:38,609 --> 00:34:42,980
I figured out is not stored on your
client software

532
00:34:42,980 --> 00:34:46,179
as one would imagine because you got
this initial pairing

533
00:34:46,179 --> 00:34:49,540
and both exchange credentials credential
so they should

534
00:34:49,540 --> 00:34:53,460
both store the credentials locally

535
00:34:53,460 --> 00:34:57,349
but it's not start on the host site

536
00:34:57,349 --> 00:35:01,319
its only stored on the camera up and
once the camera

537
00:35:01,319 --> 00:35:05,440
connect to network in the use utility
mode

538
00:35:05,440 --> 00:35:09,520
HD just starts broadcasting the GUID

539
00:35:09,520 --> 00:35:13,290
or somehow obfuscated to you I D

540
00:35:13,290 --> 00:35:17,260
or UPnP again so

541
00:35:17,260 --> 00:35:20,359
connecting to the network just listening
to the

542
00:35:20,359 --> 00:35:26,150
multicast traffic and you're fine again

543
00:35:26,150 --> 00:35:31,310
as you can see this is one of the
packages from impaired camera

544
00:35:31,310 --> 00:35:35,170
and you know that the magic string that
the idea that can end up com

545
00:35:35,170 --> 00:35:38,930
isn't alcee rose to one and all F

546
00:35:38,930 --> 00:35:44,800
but in this case it is just looks like
some random stupid

547
00:35:44,800 --> 00:35:48,420
but after comparing arm

548
00:35:48,420 --> 00:35:52,210
a network trace from the from Canon

549
00:35:52,210 --> 00:35:56,410
your suitability software where I just

550
00:35:56,410 --> 00:35:59,680
put out the identification string you

551
00:35:59,680 --> 00:36:03,260
remember the blue string from some
flights ago

552
00:36:03,260 --> 00:36:08,580
I I saw a book book last part of both
strings match

553
00:36:08,580 --> 00:36:12,430
so on their walls no good obfuscation

554
00:36:12,430 --> 00:36:16,940
they try to hide it but not good enough

555
00:36:16,940 --> 00:36:20,400
so just I just threw out

556
00:36:20,400 --> 00:36:23,470
some other pie from cold and

557
00:36:23,470 --> 00:36:26,810
once you put this little nice string

558
00:36:26,810 --> 00:36:29,869
I'll inside the cult and

559
00:36:29,869 --> 00:36:32,940
yet to some magic after wats

560
00:36:32,940 --> 00:36:35,980
again the same blistering ASEAN

561
00:36:35,980 --> 00:36:39,619
in the in it come on to request some
flights

562
00:36:39,619 --> 00:36:45,569
ago will pop-up

563
00:36:45,569 --> 00:36:49,780
like it so all

564
00:36:49,780 --> 00:36:53,940
next thing after getting the
authentication data

565
00:36:53,940 --> 00:36:57,500
is to actually connect to the camera but
terrorists again

566
00:36:57,500 --> 00:37:01,000
want onsite of this communication mode
it only

567
00:37:01,000 --> 00:37:04,780
allows one connection in parallel

568
00:37:04,780 --> 00:37:08,760
so if there is a client already
connected we need to disconnect this

569
00:37:08,760 --> 00:37:09,430
client

570
00:37:09,430 --> 00:37:13,040
to make the to us the flock free

571
00:37:13,040 --> 00:37:16,359
so we were able to connect to the camera

572
00:37:16,359 --> 00:37:20,319
arm as I mentioned in the beginning yet
TCP reset the tax

573
00:37:20,319 --> 00:37:24,510
just working fine you have

574
00:37:24,510 --> 00:37:28,440
really big TCP frame arm

575
00:37:28,440 --> 00:37:32,750
the frame doesn't change in land
prospectus really lazy

576
00:37:32,750 --> 00:37:35,819
so you don't have to worry about up

577
00:37:35,819 --> 00:37:39,880
most of the things making TCP reset hard
to do

578
00:37:39,880 --> 00:37:44,580
you can just send out a few TCP resort
packages

579
00:37:44,580 --> 00:37:49,790
maybe not more than 100 per second
because the networks that ties

580
00:37:49,790 --> 00:37:53,830
but again this also disconnect the user
for so

581
00:37:53,830 --> 00:37:56,869
you could go the easy way or

582
00:37:56,869 --> 00:38:01,830
the hard way

583
00:38:01,830 --> 00:38:05,080
make it so and now we're almost finished

584
00:38:05,080 --> 00:38:09,160
we gotta earn whole attack power of so
first we

585
00:38:09,160 --> 00:38:12,310
just listen for the camera up to
broadcast

586
00:38:12,310 --> 00:38:17,910
the authentication data while multicast
DNS

587
00:38:17,910 --> 00:38:21,560
band we just need to the obfuscate the
authentication data

588
00:38:21,560 --> 00:38:27,030
so we got the right to you I D string to
authenticate with the camera

589
00:38:27,030 --> 00:38:30,069
um then we need to disconnect

590
00:38:30,069 --> 00:38:34,410
probably connect the client

591
00:38:34,410 --> 00:38:37,599
and of the what's connect via p2p I P

592
00:38:37,599 --> 00:38:41,849
on have some fun arm

593
00:38:41,849 --> 00:38:45,660
while implementing this attack I figured
out the

594
00:38:45,660 --> 00:38:48,910
park part wasn't to you

595
00:38:48,910 --> 00:38:52,609
listen for the camera or the obvious
Katie authentication data

596
00:38:52,609 --> 00:38:56,260
the hard part in this attack actually
wants to find

597
00:38:56,260 --> 00:39:01,430
library which is capable of proper p2p
IP happened

598
00:39:01,430 --> 00:39:05,349
because as a set before p2p IP is

599
00:39:05,349 --> 00:39:09,400
you know group denies protocol
standardized

600
00:39:09,400 --> 00:39:12,540
bought a some vendors and

601
00:39:12,540 --> 00:39:18,180
it's loaded with member proprietary
extensions

602
00:39:18,180 --> 00:39:21,430
so you get very little um

603
00:39:21,430 --> 00:39:26,830
like default stuff you can do in the
protocol

604
00:39:26,830 --> 00:39:32,839
arm and you got Vera a lot of Ben the
proprietary stuff

605
00:39:32,839 --> 00:39:39,839
and finding a library which is able to
to the stuff really was the hard part

606
00:39:40,859 --> 00:39:47,859
okay so I got a little them on this as
well

607
00:39:48,069 --> 00:39:52,630
this time not on the movie but I'm

608
00:39:52,630 --> 00:39:57,810
trying to do this life your okay so I
just lunch stop be

609
00:39:57,810 --> 00:40:01,069
on the tool the tool now start listening
for

610
00:40:01,069 --> 00:40:05,270
multicast DNS sent from the camera

611
00:40:05,270 --> 00:40:09,619
I will note just turn on the camera

612
00:40:09,619 --> 00:40:14,240
and it will need some seconds to
connected away flan to get an IP address

613
00:40:14,240 --> 00:40:16,319
where the age to keep

614
00:40:16,319 --> 00:40:20,069
and then it starts broadcasting

615
00:40:20,069 --> 00:40:24,869
to secret session identified after there
we go

616
00:40:24,869 --> 00:40:29,089
you see the camera what's fault

617
00:40:29,089 --> 00:40:32,390
we got an IP address of the camera we
also gotta

618
00:40:32,390 --> 00:40:35,549
to you I D the obfuscated

619
00:40:35,549 --> 00:40:39,660
and after wats I use T Lipsy photo 22

620
00:40:39,660 --> 00:40:42,869
connect to the camera

621
00:40:42,869 --> 00:40:46,490
and what we can do now this first

622
00:40:46,490 --> 00:40:49,630
just a readout all the configuration of
the camera

623
00:40:49,630 --> 00:40:53,210
so you see for example which lens
attached

624
00:40:53,210 --> 00:40:57,170
I have no clue what's wrong with the

625
00:40:57,170 --> 00:41:04,170
present

626
00:41:08,770 --> 00:41:10,590
okay you also see you go

627
00:41:10,590 --> 00:41:13,670
battery level and all that stuff

628
00:41:13,670 --> 00:41:17,320
your I'm sorry for this

629
00:41:17,320 --> 00:41:20,970
you also see the dialed in ep it or

630
00:41:20,970 --> 00:41:24,160
and you see which which camera model it
is

631
00:41:24,160 --> 00:41:27,160
Majlis ok so the next

632
00:41:27,160 --> 00:41:30,960
think yes market almost too slow

633
00:41:30,960 --> 00:41:34,610
talking too much showing to last

634
00:41:34,610 --> 00:41:38,000
you okay we're connected

635
00:41:38,000 --> 00:41:44,120
began and

636
00:41:44,120 --> 00:41:48,180
come on after getting the configuration
we can just

637
00:41:48,180 --> 00:41:53,080
get a file listing of the camera and
then stop downloading

638
00:41:53,080 --> 00:41:56,600
the files that are stored on the camera

639
00:41:56,600 --> 00:41:59,790
and you can see here

640
00:41:59,790 --> 00:42:06,220
what I was drinking for breakfast and

641
00:42:06,220 --> 00:42:09,550
it away from its kinda flow

642
00:42:09,550 --> 00:42:16,550
or the images are really really pick 1

643
00:42:20,170 --> 00:42:21,650
I'll yet

644
00:42:21,650 --> 00:42:24,780
all wall I K

645
00:42:24,780 --> 00:42:28,570
so UCF took a picture while the

646
00:42:28,570 --> 00:42:32,320
the keynote what's happening in the
other room and

647
00:42:32,320 --> 00:42:35,840
yeah imagine that could be your footage

648
00:42:35,840 --> 00:42:38,950
if you're a professional photographer
and

649
00:42:38,950 --> 00:42:42,290
using this kind of communication mode

650
00:42:42,290 --> 00:42:47,000
with the camera what the all like it but
it

651
00:42:47,000 --> 00:42:50,490
even gets better we not only can
download

652
00:42:50,490 --> 00:42:55,580
all the taken pictures we can also get

653
00:42:55,580 --> 00:42:59,070
a more or less live stream from the
camera all

654
00:42:59,070 --> 00:43:06,070
you

655
00:43:08,930 --> 00:43:13,050
and with successfully for

656
00:43:13,050 --> 00:43:20,050
camera into an surveillance device here

657
00:43:36,319 --> 00:43:38,240
um

658
00:43:38,240 --> 00:43:42,390
okay so up what does this mean

659
00:43:42,390 --> 00:43:46,579
um if some photographer

660
00:43:46,579 --> 00:43:49,740
using and unsecured network

661
00:43:49,740 --> 00:43:54,650
like Europe hotels way Flom aren't that
the hot spot in the next %ah box

662
00:43:54,650 --> 00:43:58,730
or in some other network um which

663
00:43:58,730 --> 00:44:02,690
isn't very unlikely just think about
some big event

664
00:44:02,690 --> 00:44:06,109
I'll don't almost anybody

665
00:44:06,109 --> 00:44:09,859
with just a little bit of knowledge im
the same network

666
00:44:09,859 --> 00:44:13,279
your is able to

667
00:44:13,279 --> 00:44:17,720
download images from the camera and in
some communication modes

668
00:44:17,720 --> 00:44:21,269
good museum even able to

669
00:44:21,269 --> 00:44:25,690
two more nasty stuff like stop the
recording of a video

670
00:44:25,690 --> 00:44:29,490
that all the audio out of the video soul

671
00:44:29,490 --> 00:44:33,289
this camera really is a surveillance
device

672
00:44:33,289 --> 00:44:37,240
if you like to okay

673
00:44:37,240 --> 00:44:40,640
um this brings me to

674
00:44:40,640 --> 00:44:44,000
direction of the end of the presentation

675
00:44:44,000 --> 00:44:48,730
arm which other countermeasures what can
you do to protect yourself from somebody

676
00:44:48,730 --> 00:44:50,210
else stealing your pictures

677
00:44:50,210 --> 00:44:54,210
me in there is not much to do

678
00:44:54,210 --> 00:44:57,299
because you can't just use the network
moats

679
00:44:57,299 --> 00:45:01,630
communication modes or don't use them on

680
00:45:01,630 --> 00:45:04,769
the only thing you can do its enabled
functionality

681
00:45:04,769 --> 00:45:07,930
only and trusted networks and

682
00:45:07,930 --> 00:45:11,589
if you use waif learn make sure

683
00:45:11,589 --> 00:45:17,289
away Flynn has a trip to properly and
also make sure it's

684
00:45:17,289 --> 00:45:20,450
not Starbucks Waveland from around the
corner

685
00:45:20,450 --> 00:45:25,039
I care

686
00:45:25,039 --> 00:45:29,440
um the conclusions arm as

687
00:45:29,440 --> 00:45:33,529
both cameras get bigger and bigger and
more expensive for

688
00:45:33,529 --> 00:45:37,900
they also get more and more networking
capabilities

689
00:45:37,900 --> 00:45:41,930
so including some full-blown I P stacks

690
00:45:41,930 --> 00:45:46,019
hopefully we'll see an ipv6 take in the
future as well

691
00:45:46,019 --> 00:45:50,170
I'll so once more this brings some

692
00:45:50,170 --> 00:45:53,779
I'll some tech possibilities

693
00:45:53,779 --> 00:45:58,329
to the devices that you have not thought
of before

694
00:45:58,329 --> 00:46:03,170
so roof art of doing and TCP reset
attack against

695
00:46:03,170 --> 00:46:08,299
and the Salar I don't think they're up

696
00:46:08,299 --> 00:46:12,769
lot of you out there and

697
00:46:12,769 --> 00:46:15,950
it also shows that this device is are

698
00:46:15,950 --> 00:46:18,980
implemented with all security in mind

699
00:46:18,980 --> 00:46:24,779
at all or without too much security in
mind yet been at least try to implement

700
00:46:24,779 --> 00:46:27,779
a vindication tool for communication
modes

701
00:46:27,779 --> 00:46:32,670
made up they failed but anyway state at
least try to

702
00:46:32,670 --> 00:46:37,410
okay so

703
00:46:37,410 --> 00:46:40,509
before I come to the end let's see

704
00:46:40,509 --> 00:46:44,259
what our next steps so can also

705
00:46:44,259 --> 00:46:48,599
recently-released arm a new consumer
great

706
00:46:48,599 --> 00:46:54,009
the Salar for you're sixty this also
features a built-in wireless access

707
00:46:54,009 --> 00:46:54,529
point

708
00:46:54,529 --> 00:46:59,509
so it even gets better and this build an
access point is

709
00:46:59,509 --> 00:47:02,720
I love for you little nice iDevice

710
00:47:02,720 --> 00:47:07,019
for your Android device connecting to
the camera while built in hotspot

711
00:47:07,019 --> 00:47:10,869
and then do some nasty stuff with

712
00:47:10,869 --> 00:47:14,950
some communication protocols I need to
figure out

713
00:47:14,950 --> 00:47:19,259
if I need to bat I would but it's HTTP
an XML

714
00:47:19,259 --> 00:47:23,240
ago because those %uh those who already
implemented in the camera

715
00:47:23,240 --> 00:47:26,299
and also

716
00:47:26,299 --> 00:47:30,039
can put out the new serious of 4k
camcorder

717
00:47:30,039 --> 00:47:34,599
just last week I think the x8 when an
exit 25

718
00:47:34,599 --> 00:47:37,839
and those two also feature 'em

719
00:47:37,839 --> 00:47:41,170
some network moats there

720
00:47:41,170 --> 00:47:45,150
yep it's amazing a fret can you say

721
00:47:45,150 --> 00:47:50,380
and they advertise them with on your
direkt movie upload to YouTube or

722
00:47:50,380 --> 00:47:51,279
Facebook

723
00:47:51,279 --> 00:47:54,650
so yet all your footage to the clout

724
00:47:54,650 --> 00:47:59,730
it's amazing of um I haven't had the
chance to take a look

725
00:47:59,730 --> 00:48:03,309
and on a third the sixty or one of those
two

726
00:48:03,309 --> 00:48:06,779
guys part if when we just anybody

727
00:48:06,779 --> 00:48:11,750
owns an you're sixty nobody

728
00:48:11,750 --> 00:48:16,099
off to bed I just want to put my fingers
on an

729
00:48:16,099 --> 00:48:19,109
on a need is a network trees so

730
00:48:19,109 --> 00:48:24,410
maybe erase your pictures before but I
won't break the camera

731
00:48:24,410 --> 00:48:28,690
so I would be happy if somebody willing
to use

732
00:48:28,690 --> 00:48:32,759
and shows up with and within 60 but

733
00:48:32,759 --> 00:48:36,009
your until now that hasn't happened but

734
00:48:36,009 --> 00:48:39,400
decide the next steps and also

735
00:48:39,400 --> 00:48:42,880
from quite interesting if I A

736
00:48:42,880 --> 00:48:46,289
if I will hear something from can and
future

737
00:48:46,289 --> 00:48:49,630
so at try to get in contact with them

738
00:48:49,630 --> 00:48:54,989
before giving a talk before releasing
this publicly part

739
00:48:54,989 --> 00:48:59,430
they got no like sort

740
00:48:59,430 --> 00:49:03,650
I haven't found anybody who wanted to
listen to me

741
00:49:03,650 --> 00:49:07,230
wanna try to explain the attacks to can

742
00:49:07,230 --> 00:49:10,420
for its not that easy to get in contact
with

743
00:49:10,420 --> 00:49:14,640
somebody who turned help me know

744
00:49:14,640 --> 00:49:19,239
okay so earth never time enough thank
you for use

745
00:49:19,239 --> 00:49:23,099
and other any questions a pic we gotta
run

746
00:49:23,099 --> 00:49:27,190
10 minutes left for questions s inside
for questions yep

747
00:49:27,190 --> 00:49:34,190
any questions for Daniel back

748
00:49:36,170 --> 00:49:41,210
yeah no so you you've got all the stocks
and lot of the protocols only allow one

749
00:49:41,210 --> 00:49:42,350
user at a time

750
00:49:42,350 --> 00:49:46,720
sorry this way to Wade not loud enough

751
00:49:46,720 --> 00:49:50,080
art can understand you okay are that's
much better

752
00:49:50,080 --> 00:49:54,590
okay waiver own so you've got sparkles
the only allow one user at a time

753
00:49:54,590 --> 00:49:58,570
but you've got these nice discovery
protocols how is he would be too

754
00:49:58,570 --> 00:50:01,650
test on a man in the middle attack so
the

755
00:50:01,650 --> 00:50:05,200
the chat with Clyde things he's talking
to the camera and the camera things he's

756
00:50:05,200 --> 00:50:05,810
done still

757
00:50:05,810 --> 00:50:08,810
littered with client but in fact they're
all speaking to you

758
00:50:08,810 --> 00:50:13,240
Joe of course what one could do such a
thing getting man in the middle position

759
00:50:13,240 --> 00:50:13,650
is

760
00:50:13,650 --> 00:50:17,860
quite easy as this camera is highly
responsive to upsman think

761
00:50:17,860 --> 00:50:22,570
so just takes slip of a tool and you're
in a

762
00:50:22,570 --> 00:50:28,480
layer 2 man in the middle and than it
depends on which network Motor Inn

763
00:50:28,480 --> 00:50:31,770
you could do an FTP man in the middle
but you don't need to

764
00:50:31,770 --> 00:50:35,660
just need to get the network dongle you

765
00:50:35,660 --> 00:50:39,060
from I I could think golf

766
00:50:39,060 --> 00:50:43,820
also and p2p I P man in the middle if
you want to do that

767
00:50:43,820 --> 00:50:47,090
arm but could also be possible they're
just

768
00:50:47,090 --> 00:50:51,380
TCP based protocols to ride and small
proxy for those protocols

769
00:50:51,380 --> 00:50:55,550
no problem so because it before you just
need to ship all the data through

770
00:50:55,550 --> 00:51:00,010
and just the time around the bits you
just want to turn on or off

771
00:51:00,010 --> 00:51:03,250
sorry about that should be up so livable

772
00:51:03,250 --> 00:51:07,060
okay great thanks from

773
00:51:07,060 --> 00:51:10,560
any more questions on their

774
00:51:10,560 --> 00:51:14,160
to up

775
00:51:14,160 --> 00:51:17,340
hi I'm I have question I was wondering

776
00:51:17,340 --> 00:51:20,740
would be very difficult to inject other
pictures into the

777
00:51:20,740 --> 00:51:25,760
can refer to stream and if so what would
it mean for news-gathering organizations

778
00:51:25,760 --> 00:51:29,560
to to upload some investors to recover
our own

779
00:51:29,560 --> 00:51:33,100
yet that's also possible arm

780
00:51:33,100 --> 00:51:38,310
in the yes utility mode so in the lost
up to 40 presented

781
00:51:38,310 --> 00:51:42,150
there is the capability of uploading
data to the camera

782
00:51:42,150 --> 00:51:46,550
and yet as i mentioned in the beginning
it would be possible

783
00:51:46,550 --> 00:51:50,690
if you want to build some crazy attack
scenario 22

784
00:51:50,690 --> 00:51:54,240
point out the photographer you don't
like upload some

785
00:51:54,240 --> 00:51:57,370
that images on his camera and I'm just

786
00:51:57,370 --> 00:52:01,660
go to the next police officer and point
that the cameraman

787
00:52:01,660 --> 00:52:04,910
and have them let let them have a look
at the images

788
00:52:04,910 --> 00:52:09,910
so

789
00:52:09,910 --> 00:52:13,720
though mother or your so

790
00:52:13,720 --> 00:52:18,110
I'm wondering if you'd be willing to
share the HTTP Server fingerprint

791
00:52:18,110 --> 00:52:21,590
for the purposes of potentially finding
more these things connected to the

792
00:52:21,590 --> 00:52:22,260
Internet

793
00:52:22,260 --> 00:52:29,260
of course awesome thinking of course
Yahoo

794
00:52:30,210 --> 00:52:36,210
if it's gone

795
00:52:36,210 --> 00:52:40,710
yeah and would it be better if it
connected web site for test

796
00:52:40,710 --> 00:52:44,520
and then post to your father's he said
the fly maxis

797
00:52:44,520 --> 00:52:47,810
to to sort through what

798
00:52:47,810 --> 00:52:52,240
upload the pictures on the website and
then you can get them from your computer

799
00:52:52,240 --> 00:52:55,490
instead the exchanges via protocols

800
00:52:55,490 --> 00:52:59,120
you're right that there would be the

801
00:52:59,120 --> 00:53:02,480
secure way to do this to not use the
year

802
00:53:02,480 --> 00:53:05,760
so much praise them network mode of the
camera

803
00:53:05,760 --> 00:53:11,060
is that what you mean year folks to a
settlement which is more secure

804
00:53:11,060 --> 00:53:14,770
maybe assists and stuff like that

805
00:53:14,770 --> 00:53:18,010
you're right market

806
00:53:18,010 --> 00:53:21,380
um more questions

807
00:53:21,380 --> 00:53:28,380
would you be willing to share a little
bit more about how you got to the

808
00:53:29,870 --> 00:53:31,230
surveillance

809
00:53:31,230 --> 00:53:36,460
the remote surveillance mode is that
based on an existing functionality that

810
00:53:36,460 --> 00:53:37,970
users is supposed to have

811
00:53:37,970 --> 00:53:42,970
yes it earlier that you could just
recorded video and then access the video

812
00:53:42,970 --> 00:53:46,690
that is that Remote View mode a
legitimate thing

813
00:53:46,690 --> 00:53:50,450
that you found a way to hijack know it
it's absolutely legitimate so the

814
00:53:50,450 --> 00:53:52,590
software is also using this feature

815
00:53:52,590 --> 00:53:57,510
to give you an preview of the of the
life image so you can manually focus the

816
00:53:57,510 --> 00:53:58,620
lands or

817
00:53:58,620 --> 00:54:02,390
anything else before taking the actual
picture so it's just

818
00:54:02,390 --> 00:54:07,610
no what you do in in terms of the camera
is you just put the camera into the life

819
00:54:07,610 --> 00:54:07,980
you know

820
00:54:07,980 --> 00:54:11,710
multi-use so you open the shutter you

821
00:54:11,710 --> 00:54:16,240
remove the Miro and I'm the sensor is
just recording images

822
00:54:16,240 --> 00:54:20,090
like 40 full HD video but not saving
them

823
00:54:20,090 --> 00:54:23,190
and 1 I'm doing some just pulling

824
00:54:23,190 --> 00:54:26,880
a lower resolution preview image of the
sensor and

825
00:54:26,880 --> 00:54:30,090
getting it over the network and
displaying it on if

826
00:54:30,090 --> 00:54:34,020
if I'm not an uncrowded area and the way
flown connectivity is

827
00:54:34,020 --> 00:54:37,350
a good and stable from able to 24

828
00:54:37,350 --> 00:54:40,790
images per second so I got a real nice

829
00:54:40,790 --> 00:54:44,180
a.m. video thanks

830
00:54:44,180 --> 00:54:49,050
you more questions

831
00:54:49,050 --> 00:54:54,550
more question over there yeah

832
00:54:54,550 --> 00:54:58,720
um it will be possible because I didn't
hear that word will be possible to

833
00:54:58,720 --> 00:55:02,040
actually delete or form up the flashcard
order

834
00:55:02,040 --> 00:55:05,130
if everything will be from

835
00:55:05,130 --> 00:55:09,000
I'm saying yes which means

836
00:55:09,000 --> 00:55:12,570
its its possible to format carts

837
00:55:12,570 --> 00:55:17,930
inside of the camera I have not found
proprietary can and control

838
00:55:17,930 --> 00:55:21,180
to trigger the form of over or p2p IPTV

839
00:55:21,180 --> 00:55:24,890
but I think it should be possible there
is a whole bunch of

840
00:55:24,890 --> 00:55:28,200
anonymous proprietary functions you can
call

841
00:55:28,200 --> 00:55:32,020
just not right all of them but

842
00:55:32,020 --> 00:55:39,020
I bet there is a way to form a pic of
okay

843
00:55:45,050 --> 00:55:48,460
pay you try to a responsible to closure
with Canon

844
00:55:48,460 --> 00:55:51,720
and they didn't listen so now what

845
00:55:51,720 --> 00:55:54,869
what about legal implications and what
effort

846
00:55:54,869 --> 00:55:58,190
to the care arm my point of view

847
00:55:58,190 --> 00:56:01,570
is that those sparks are less

848
00:56:01,570 --> 00:56:04,970
implementation ok box like I

849
00:56:04,970 --> 00:56:09,040
don't need to to fill some Buffalo to
get some

850
00:56:09,040 --> 00:56:13,280
of overflow happening there are more
design issues

851
00:56:13,280 --> 00:56:17,099
liked the the camera is designed to work
exactly like this

852
00:56:17,099 --> 00:56:20,300
so there from from Canon signed a full

853
00:56:20,300 --> 00:56:24,770
point of view there are is no bach the
camera just does what it's supposed to

854
00:56:24,770 --> 00:56:25,170
do

855
00:56:25,170 --> 00:56:29,230
soul I'm not quite sure if there is any

856
00:56:29,230 --> 00:56:32,369
legal implication but

857
00:56:32,369 --> 00:56:35,940
people who use the camera should be
aware of this

858
00:56:35,940 --> 00:56:39,190
and should know when to activate the
waif London want mark to

859
00:56:39,190 --> 00:56:42,200
so that's why I'm standing here in front

860
00:56:42,200 --> 00:56:47,740
even without speaking to can quick

861
00:56:47,740 --> 00:56:52,020
think you're running a bit long time as
well so I just wanna thank you very much

862
00:56:52,020 --> 00:56:52,750
Daniel

863
00:56:52,750 --> 00:56:57,040
no a good he

