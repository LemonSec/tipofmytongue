1
00:00:02,159 --> 00:00:08,690
well

2
00:00:08,690 --> 00:00:15,690
well

3
00:00:15,730 --> 00:00:22,730
yes

4
00:00:22,930 --> 00:00:25,950
pay everybody %ah

5
00:00:25,950 --> 00:00:29,340
I think this rainy weather to death this
makes head

6
00:00:29,340 --> 00:00:33,730
last time I was in Amsterdam assignee
I'm

7
00:00:33,730 --> 00:00:37,559
so I'll talk about the authorization
protocol or to be my heart

8
00:00:37,559 --> 00:00:41,070
and both Facebook's implementation this
but for this

9
00:00:41,070 --> 00:00:44,150
critical so the topic becomes for

10
00:00:44,150 --> 00:00:47,400
you have in store another talk our
fellow

11
00:00:47,400 --> 00:00:50,840
trickiest date up using Twitter's API
and

12
00:00:50,840 --> 00:00:55,140
both so indeed weekend

13
00:00:55,140 --> 00:00:58,370
had such progress we have we have no

14
00:00:58,370 --> 00:01:01,750
with where get millions of users on
Facebook

15
00:01:01,750 --> 00:01:05,339
share their data a good meals %uh
developers

16
00:01:05,339 --> 00:01:09,149
which means they're dating for a
different purpose a sleek advertisement

17
00:01:09,149 --> 00:01:12,810
entertainment for first edition for
anything else

18
00:01:12,810 --> 00:01:16,220
and and because physicians critical is
something which

19
00:01:16,220 --> 00:01:20,270
gives both sites I'll

20
00:01:20,270 --> 00:01:24,880
the user's and the developers we to you
retreated 8 a.m.

21
00:01:24,880 --> 00:01:29,050
to use this data and give some kind of
control about this process

22
00:01:29,050 --> 00:01:34,380
so and I'll explain that there is still

23
00:01:34,380 --> 00:01:37,929
much of stuff should understand to build
secure

24
00:01:37,929 --> 00:01:44,929
of implementation so first

25
00:01:46,300 --> 00:01:50,090
by myself experiencing oath

26
00:01:50,090 --> 00:01:53,410
was mostly restricted Bielsa driven by
by that

27
00:01:53,410 --> 00:01:56,539
Facebook but about for so

28
00:01:56,539 --> 00:02:01,149
am everything which could be salt I
would be a major issue here

29
00:02:01,149 --> 00:02:04,509
it if it's Napster quickness

30
00:02:04,509 --> 00:02:08,220
or its Park Facebook to some third-party
application

31
00:02:08,220 --> 00:02:12,020
our if it can be exploited directly for
executing court

32
00:02:12,020 --> 00:02:16,000
or for stealing private data it's not a
major issue

33
00:02:16,000 --> 00:02:23,000
so but elsa from nick de mas y studying
human State University I tried to fit

34
00:02:27,200 --> 00:02:31,090
every everything about the both and
background to a slight

35
00:02:31,090 --> 00:02:34,550
and when you head another talking to the
about the oath

36
00:02:34,550 --> 00:02:38,300
so you should have at least some
background how this product over expert

37
00:02:38,300 --> 00:02:38,990
anyway

38
00:02:38,990 --> 00:02:42,060
first there are four actors this
critical

39
00:02:42,060 --> 00:02:45,680
resource-poor arthritis clamped which is
two-thirds

40
00:02:45,680 --> 00:02:49,450
by the publication Texas his data and to
his first caller

41
00:02:49,450 --> 00:02:53,040
there's also the authorization and point
and the case for Facebook

42
00:02:53,040 --> 00:02:57,060
authorization endpoint and resource for
others for server

43
00:02:57,060 --> 00:03:01,120
assessing so the simple idea that the
password

44
00:03:01,120 --> 00:03:05,820
was never given to the third party
application all the excess talk on there

45
00:03:05,820 --> 00:03:06,870
were many

46
00:03:06,870 --> 00:03:10,520
text below to you to the our
implementation

47
00:03:10,520 --> 00:03:13,890
I just put a couple of things also

48
00:03:13,890 --> 00:03:19,000
it's a PT that my coworker I work on the
cough is not here so I'm missing lots of

49
00:03:19,000 --> 00:03:20,050
cool books by him

50
00:03:20,050 --> 00:03:25,270
but anyway there are also fundamental
problems

51
00:03:25,270 --> 00:03:29,940
mark McCord I think the most notable is
a session excision which was filed

52
00:03:29,940 --> 00:03:33,410
to I'm in the coast to points ago

53
00:03:33,410 --> 00:03:37,120
I'm because its there was

54
00:03:37,120 --> 00:03:40,660
interference between the bike standards
and the

55
00:03:40,660 --> 00:03:43,760
actual business impact I think it was
cool

56
00:03:43,760 --> 00:03:50,760
favorite so

57
00:03:50,890 --> 00:03:53,300
another's simple idea which place behind

58
00:03:53,300 --> 00:03:56,319
the authorization protocol for both 2.0

59
00:03:56,319 --> 00:03:59,580
is it the data

60
00:03:59,580 --> 00:04:03,599
that kind of credentials excess targets
for course are transmitted

61
00:04:03,599 --> 00:04:07,000
I'm crossed demand we by other rhetorics

62
00:04:07,000 --> 00:04:10,840
so expert just to picture

63
00:04:10,840 --> 00:04:16,900
to flows there's this too Flo spanked
cause 2.0 the first is in place ground

64
00:04:16,900 --> 00:04:17,440
floor

65
00:04:17,440 --> 00:04:20,750
and others through this group for
rightful

66
00:04:20,750 --> 00:04:23,930
us with the first one is considered up

67
00:04:23,930 --> 00:04:27,020
some pointless security because it gives

68
00:04:27,020 --> 00:04:31,110
the dirty the Texas talking to
third-party applications look

69
00:04:31,110 --> 00:04:35,660
at point C and the second floor could be
used

70
00:04:35,660 --> 00:04:38,950
if correctly implemented for the
authorization first

71
00:04:38,950 --> 00:04:42,350
because I'll the clan testy exchange

72
00:04:42,350 --> 00:04:46,450
the code look at that point C it's
called not it's not to talk

73
00:04:46,450 --> 00:04:49,630
it should exchange it for talking using
the secret key

74
00:04:49,630 --> 00:04:52,720
and this make and flow D&D

75
00:04:52,720 --> 00:04:56,860
I'll is never seen never seem to user

76
00:04:56,860 --> 00:05:02,460
it happens Olympic so what makes

77
00:05:02,460 --> 00:05:06,150
interesting to explore the cause 2.0 and
its implementation

78
00:05:06,150 --> 00:05:09,390
Facebook first I'll because

79
00:05:09,390 --> 00:05:12,830
oath 2.0 is a per-post air-sea standard

80
00:05:12,830 --> 00:05:16,630
I think lights placed

81
00:05:16,630 --> 00:05:22,100
this it there as a some kind of
replacement for old

82
00:05:22,100 --> 00:05:25,479
2.1 but anyway north to Port up

83
00:05:25,479 --> 00:05:30,180
one .0 but anyway the first version of
growth is still a life

84
00:05:30,180 --> 00:05:33,280
I'll another reason this

85
00:05:33,280 --> 00:05:36,600
that Facebook is for largest platform
for developers

86
00:05:36,600 --> 00:05:39,680
they're good militants abusers $1
billion I think

87
00:05:39,680 --> 00:05:42,880
and ten million applications so

88
00:05:42,880 --> 00:05:46,479
you would never think you would never
see the same problems

89
00:05:46,479 --> 00:05:50,470
the Facebook has I mean at that scale
and this killer Facebook

90
00:05:50,470 --> 00:05:54,720
and Elsa turn out to be that there's
large attack surface

91
00:05:54,720 --> 00:05:58,090
which is pearl export I'll

92
00:05:58,090 --> 00:06:02,590
there are those who look fourth reason I
tried to fit into the picture

93
00:06:02,590 --> 00:06:06,700
so

94
00:06:06,700 --> 00:06:12,120
I'll I would define a threat modeling to
and a pretty standard

95
00:06:12,120 --> 00:06:15,720
wait for all the researchers research
the authorization protocol

96
00:06:15,720 --> 00:06:20,000
Oct simply answers one question what
harmful could happen

97
00:06:20,000 --> 00:06:23,130
if I click the malicious link so

98
00:06:23,130 --> 00:06:26,690
exposing private data

99
00:06:26,690 --> 00:06:30,220
or invoking some unwanted actions could
be

100
00:06:30,220 --> 00:06:34,310
before and if you have a Nexus talking
so League next organs

101
00:06:34,310 --> 00:06:39,479
would be interesting to me also sign in
to fear

102
00:06:39,479 --> 00:06:43,460
into third party account with the
Facebook authentication

103
00:06:43,460 --> 00:06:47,080
will be also interesting for me its
authentication bypass

104
00:06:47,080 --> 00:06:52,140
and executing code I mean the CrossFit
scripting would be the perfect tool

105
00:06:52,140 --> 00:06:58,570
of breaking the protocol because it
would allow everything so I will start

106
00:06:58,570 --> 00:07:00,400
with a very very busy book

107
00:07:00,400 --> 00:07:03,849
but very simple

108
00:07:03,849 --> 00:07:08,419
yet very hard March so descriptor
external

109
00:07:08,419 --> 00:07:11,760
11 status fish be expose talking first
drink

110
00:07:11,760 --> 00:07:15,640
state if said instead of cash so this is

111
00:07:15,640 --> 00:07:18,659
dirt violation the standard and

112
00:07:18,659 --> 00:07:22,099
it could be easily exploit too low to
leak

113
00:07:22,099 --> 00:07:25,849
and extorting just entered the picture

114
00:07:25,849 --> 00:07:29,490
to the somewhere inside client-side

115
00:07:29,490 --> 00:07:33,849
then temperate you're right point this
page

116
00:07:33,849 --> 00:07:38,270
and then letting the user click the link
when if logos to you

117
00:07:38,270 --> 00:07:42,010
to the beach where the redirect your
eight points

118
00:07:42,010 --> 00:07:46,860
you pictures being loaded from your
server and you just pick up the river

119
00:07:46,860 --> 00:07:50,659
well it's very simple just booked
picture inside the bank

120
00:07:50,659 --> 00:07:53,880
so used to being a vacationing as an
example

121
00:07:53,880 --> 00:07:58,010
and lick the exit stalkers

122
00:07:58,010 --> 00:08:01,520
so very easy to understand very easy to
sport

123
00:08:01,520 --> 00:08:05,190
way with this I'm worth talking about it
at all

124
00:08:05,190 --> 00:08:10,150
up will how would you much every part of
this book may be

125
00:08:10,150 --> 00:08:13,350
one 1 year ago and it's still not budge

126
00:08:13,350 --> 00:08:16,430
completely guess if you get external
developers

127
00:08:16,430 --> 00:08:20,009
which stark up to your practical you can
change everything

128
00:08:20,009 --> 00:08:24,990
without its without breaking something
so

129
00:08:24,990 --> 00:08:28,110
it will remind us that the design books

130
00:08:28,110 --> 00:08:32,430
are the most expensive so but not only
designed bucks

131
00:08:32,430 --> 00:08:36,510
are headache in the next paragraph

132
00:08:36,510 --> 00:08:40,719
I'll talk about the piece of code reason
my facebook in order to use

133
00:08:40,719 --> 00:08:44,160
simplify the developer stuffed well what

134
00:08:44,160 --> 00:08:49,589
she was created his dick a dust is
actually can be defined as follows:

135
00:08:49,589 --> 00:08:53,120
given day string with the euro fragment

136
00:08:53,120 --> 00:08:57,360
how to safely parse this and hope to see
if the transmit this detect a

137
00:08:57,360 --> 00:08:59,069
third-party application

138
00:08:59,069 --> 00:09:02,520
so JavaScript is Decatur's

139
00:09:02,520 --> 00:09:06,060
lots of stuff but the main thing is just
transmission of tacos

140
00:09:06,060 --> 00:09:12,170
from euro fragment to the applications
to me

141
00:09:12,170 --> 00:09:15,569
so the floor works like

142
00:09:15,569 --> 00:09:18,870
like this week so everything's been
strong

143
00:09:18,870 --> 00:09:21,870
the Facebook for a safe room

144
00:09:21,870 --> 00:09:26,360
for various reasons because if different
browser behavior

145
00:09:26,360 --> 00:09:29,579
ever it consists of two iframes or

146
00:09:29,579 --> 00:09:32,660
window Jeffrey the first

147
00:09:32,660 --> 00:09:35,949
top frame think actual Brooks a friend
bottom

148
00:09:35,949 --> 00:09:40,010
is the window and the bottom iframe

149
00:09:40,010 --> 00:09:43,959
calls the trucks messed function well
the ProSafe ring

150
00:09:43,959 --> 00:09:47,160
I'll with that function implementation
calls

151
00:09:47,160 --> 00:09:50,720
post message: interest me the actual X
is talking to the

152
00:09:50,720 --> 00:09:54,949
applications to me well the buck is

153
00:09:54,949 --> 00:09:58,209
the bar was that there was no orange
checks so

154
00:09:58,209 --> 00:10:02,770
I was simply loading and setting out the
Facebook ProSafe ring

155
00:10:02,770 --> 00:10:05,930
prepared for some trusted application
injected

156
00:10:05,930 --> 00:10:09,199
into Michael to me so I'll

157
00:10:09,199 --> 00:10:12,890
that way I'll eat II get talk to us

158
00:10:12,890 --> 00:10:16,630
which were supposed to belong to you
some trusted application

159
00:10:16,630 --> 00:10:20,829
not not to me so I think

160
00:10:20,829 --> 00:10:25,069
but box for submitted to Facebook we're
going to this issue

161
00:10:25,069 --> 00:10:28,110
because the parched this the eight
boards checks

162
00:10:28,110 --> 00:10:31,770
but the edit this correctly then the
porch to gain

163
00:10:31,770 --> 00:10:35,430
I think my bike was just one of those
bikes freeway

164
00:10:35,430 --> 00:10:39,069
tempered their director eight-point and
fickle versions

165
00:10:39,069 --> 00:10:42,720
approaching where there were no there
were

166
00:10:42,720 --> 00:10:45,740
eat there was origin checks

167
00:10:45,740 --> 00:10:50,780
so I bet this small Chasidic a script
this

168
00:10:50,780 --> 00:10:55,380
tests demand because density of bucks
case a facebook

169
00:10:55,380 --> 00:10:59,440
and also this is exactly the case world

170
00:10:59,440 --> 00:11:02,750
there's something completely beyond the
standard so

171
00:11:02,750 --> 00:11:06,370
the both standard doesn't define how to
constrict

172
00:11:06,370 --> 00:11:09,579
transmit and the Facebook implemented
sums

173
00:11:09,579 --> 00:11:16,579
something out a standard and get lunch
box

174
00:11:17,569 --> 00:11:21,310
so the next fearful be about I would
call this

175
00:11:21,310 --> 00:11:25,300
attack for both defense mechanism for
extras

176
00:11:25,300 --> 00:11:31,500
it's your friend so the whole dust for
this chapter would be hard to extort

177
00:11:31,500 --> 00:11:34,949
hope to leak excess Targus with the

178
00:11:34,949 --> 00:11:38,100
with 3x with your real

179
00:11:38,100 --> 00:11:41,290
so first I think everybody's

180
00:11:41,290 --> 00:11:44,540
have seen Eagle SoCal hatchback ish

181
00:11:44,540 --> 00:11:48,040
to Facebook so it can be abused to

182
00:11:48,040 --> 00:11:51,040
full data from safe please

183
00:11:51,040 --> 00:11:54,560
safer excess Targus it's called fragment
into the

184
00:11:54,560 --> 00:11:57,790
urals pay into the hero perimeters

185
00:11:57,790 --> 00:12:01,040
where this sensitive data

186
00:12:01,040 --> 00:12:04,120
he's vulnerable to the where referee
Phil

187
00:12:04,120 --> 00:12:08,110
so estimated maybe for five bucks I
don't remember

188
00:12:08,110 --> 00:12:12,170
the all worked for the Prius and wait
first three picks some permitted

189
00:12:12,170 --> 00:12:17,140
Facebook page thank you full next organs
from the rural fragment

190
00:12:17,140 --> 00:12:23,320
then to redirect your on demand and that
think the referee Phil

191
00:12:23,320 --> 00:12:27,310
I will not give the you all those parks

192
00:12:27,310 --> 00:12:30,430
description because well the

193
00:12:30,430 --> 00:12:33,450
expedition method is more interesting

194
00:12:33,450 --> 00:12:38,790
those books because they were pretty
much simple

195
00:12:38,790 --> 00:12:42,839
another euro history was really to you

196
00:12:42,839 --> 00:12:46,519
the I application are seeing

197
00:12:46,519 --> 00:12:49,850
Howard I'll give more details our

198
00:12:49,850 --> 00:12:54,390
she works Facebook so basically there is
a vacation there's a

199
00:12:54,390 --> 00:12:57,660
Facebook controller their different
iframes

200
00:12:57,660 --> 00:13:00,950
and they talk to each other this some
messages

201
00:13:00,950 --> 00:13:04,010
and the application can invoke some
calls so

202
00:13:04,010 --> 00:13:07,470
ask Facebook to do something

203
00:13:07,470 --> 00:13:11,050
and there was a special method called
get has

204
00:13:11,050 --> 00:13:15,130
it was just obviously to get forecast
pounds

205
00:13:15,130 --> 00:13:18,560
and if you remember that excess talking

206
00:13:18,560 --> 00:13:21,720
seed inside this s so a bill

207
00:13:21,720 --> 00:13:26,010
application which Justin over this cold
get the full has clinton's

208
00:13:26,010 --> 00:13:29,790
and I'll still relate the has bank
medication to be

209
00:13:29,790 --> 00:13:34,310
bus filters on to direct your right

210
00:13:34,310 --> 00:13:37,700
so I think this method I mean the

211
00:13:37,700 --> 00:13:41,700
get test method was used for perimeter
spicy to

212
00:13:41,700 --> 00:13:45,490
application or worse for

213
00:13:45,490 --> 00:13:49,519
for navigation purposes and
certification I don't know

214
00:13:49,519 --> 00:13:52,990
I think it was legacy method was removed
cysts

215
00:13:52,990 --> 00:13:58,579
right after I reported this book so
nobody used it

216
00:13:58,579 --> 00:14:02,220
so alligators a few seconds to
understand how this will work

217
00:14:02,220 --> 00:14:06,920
first sending the message to the proxy
iframe

218
00:14:06,920 --> 00:14:11,690
RC message then posting this message

219
00:14:11,690 --> 00:14:14,889
that had been this message by the
Facebook a controller

220
00:14:14,889 --> 00:14:20,470
then the Facebook exposed the fall has
condoms

221
00:14:20,470 --> 00:14:25,829
to the application to come to me

222
00:14:25,829 --> 00:14:29,740
so what's interesting here that if
you've got free

223
00:14:29,740 --> 00:14:33,540
based navigation to you

224
00:14:33,540 --> 00:14:36,589
authorization and point to me think
twice whole

225
00:14:36,589 --> 00:14:39,790
how it coexist with your with your

226
00:14:39,790 --> 00:14:46,790
out something fish

227
00:15:02,720 --> 00:15:06,399
Facebook also shipped out to SoCal PHP
is the key

228
00:15:06,399 --> 00:15:09,769
and in this paragraph I will talk about

229
00:15:09,769 --> 00:15:13,680
more interesting issues some such

230
00:15:13,680 --> 00:15:17,089
is pressing the authentication and
exceeding search

231
00:15:17,089 --> 00:15:20,610
so will be

232
00:15:20,610 --> 00:15:24,529
using the glance not Facebook itself and

233
00:15:24,529 --> 00:15:27,870
what's interesting here that I'm going
to abuse the

234
00:15:27,870 --> 00:15:32,269
at some point bulletproof authorization
called ground floor

235
00:15:32,269 --> 00:15:36,170
not the implicit ground floor so

236
00:15:36,170 --> 00:15:42,000
looking into the PHP is the key code

237
00:15:42,000 --> 00:15:45,959
what we can see that the cold

238
00:15:45,959 --> 00:15:50,649
issued with an intruder curator so
standard

239
00:15:50,649 --> 00:15:55,510
the coast 2.0 ass said that stealing
called

240
00:15:55,510 --> 00:15:59,019
very director I tempering gives nothing
because

241
00:15:59,019 --> 00:16:02,500
if you just temperate to redirect here
right answer make

242
00:16:02,500 --> 00:16:06,260
code to the third party applications it
will not

243
00:16:06,260 --> 00:16:10,430
typical because at the back and flow to
alaska Facebook

244
00:16:10,430 --> 00:16:14,029
like give me the access token and
director right

245
00:16:14,029 --> 00:16:18,269
was like this this refrigerator and the
facebook says

246
00:16:18,269 --> 00:16:21,690
no people issued for another Richard so

247
00:16:21,690 --> 00:16:24,709
you will not be able to bypass the
Facebook authentication but

248
00:16:24,709 --> 00:16:27,870
using the Facebook PHP is decades as
possible

249
00:16:27,870 --> 00:16:31,010
so whenever you still be

250
00:16:31,010 --> 00:16:35,010
code with temporary offer any richer I

251
00:16:35,010 --> 00:16:40,420
when they do it right wants to Facebook
com you can just submit this cold

252
00:16:40,420 --> 00:16:44,930
and you will be authenticated so look at
these

253
00:16:44,930 --> 00:16:48,820
two piece of code first gives you

254
00:16:48,820 --> 00:16:52,529
the demonstration other so there is
another thing

255
00:16:52,529 --> 00:16:56,050
Facebook call center quest sexually
juice on object

256
00:16:56,050 --> 00:16:59,750
with Texas talking more with code: and
signed

257
00:16:59,750 --> 00:17:03,940
I think it's part of oath 1.0 standard

258
00:17:03,940 --> 00:17:07,230
and the thing is that

259
00:17:07,230 --> 00:17:10,470
according to PSP is the key logic these

260
00:17:10,470 --> 00:17:14,750
kind of education is more priority over
called based authentication

261
00:17:14,750 --> 00:17:17,839
and also look E

262
00:17:17,839 --> 00:17:22,000
at the bottom piece of code our this an
inquest

263
00:17:22,000 --> 00:17:25,109
sparked birth from I'll the

264
00:17:25,110 --> 00:17:29,280
actually real printers and there are no
CS rep checks

265
00:17:29,280 --> 00:17:33,250
so the session fixation is possible up

266
00:17:33,250 --> 00:17:36,850
which sites use to PHP SDK its own a
scope

267
00:17:36,850 --> 00:17:41,120
I've checked everything with the news
was one thing is

268
00:17:41,120 --> 00:17:44,919
I think it was freelance for the call so
everything talk right now

269
00:17:44,919 --> 00:17:48,350
worked on that site so I could babe
either education could

270
00:17:48,350 --> 00:17:51,580
say the session and who knows

271
00:17:51,580 --> 00:17:54,610
well I think many clans

272
00:17:54,610 --> 00:17:58,390
use PHP SDK many of them of course
tonight by skipped

273
00:17:58,390 --> 00:18:01,990
not look inside so

274
00:18:01,990 --> 00:18:08,990
don't trust the external is the key and
I think PHP SDK is not for a safe

275
00:18:09,020 --> 00:18:12,050
education if you would like to implement
the

276
00:18:12,050 --> 00:18:16,320
slant for Facebook you should break your
plantation from scratch

277
00:18:16,320 --> 00:18:22,860
the service/site through this print for
implementation am

278
00:18:22,860 --> 00:18:26,780
and also bucks question so you can see
the source code

279
00:18:26,780 --> 00:18:33,780
into the game could help some time ago
Facebook change

280
00:18:36,559 --> 00:18:39,650
the eulogy of building applications so
first

281
00:18:39,650 --> 00:18:44,140
it was just Beach if you know page with
some markup language

282
00:18:44,140 --> 00:18:47,740
I think it was cold X FBML

283
00:18:47,740 --> 00:18:53,390
on now Facebook application is actually
the iframe

284
00:18:53,390 --> 00:18:56,860
which is loaded and say to Facebook
window

285
00:18:56,860 --> 00:19:00,270
and d the way the application works

286
00:19:00,270 --> 00:19:03,530
out with the publication controller the
wait

287
00:19:03,530 --> 00:19:06,840
2x with Facebook is kind of

288
00:19:06,840 --> 00:19:10,510
sent box called because it can gif

289
00:19:10,510 --> 00:19:15,049
cannot retrieve detail about user
directly it can on the invoke

290
00:19:15,049 --> 00:19:18,409
the RPC calls to the other controller
and a controller

291
00:19:18,409 --> 00:19:24,950
if the database to the application so

292
00:19:24,950 --> 00:19:28,630
felt one massacre a sequel this cultural
a look

293
00:19:28,630 --> 00:19:34,130
in order to

294
00:19:34,130 --> 00:19:37,700
render this day like I'll just Facebook

295
00:19:37,700 --> 00:19:41,870
made a request choose special endpoint
retreat that you saw

296
00:19:41,870 --> 00:19:45,760
but his own contains the data and the
Facebook show this dialect

297
00:19:45,760 --> 00:19:52,040
user wheres

298
00:19:52,040 --> 00:19:55,330
the health care well think that

299
00:19:55,330 --> 00:19:59,870
the same important used for daily
rendering was used for of

300
00:19:59,870 --> 00:20:04,540
because the North authorization they
look sick

301
00:20:04,540 --> 00:20:07,850
also the same and for injuries heard PHP

302
00:20:07,850 --> 00:20:11,780
every control most to the parameters for
this call

303
00:20:11,780 --> 00:20:18,169
so we could said Terry 3 redirect your
ID for this call

304
00:20:18,169 --> 00:20:21,970
you few seconds to understand so for
simple

305
00:20:21,970 --> 00:20:25,490
to you post message then

306
00:20:25,490 --> 00:20:28,800
the Facebook pro se frame

307
00:20:28,800 --> 00:20:32,700
delivery this message to the Facebook
controller Facebook major crest

308
00:20:32,700 --> 00:20:36,690
to the daily endpoint

309
00:20:36,690 --> 00:20:39,950
then the receiving of the

310
00:20:39,950 --> 00:20:44,630
testing process requests for Facebook
thriller somehow handled this message

311
00:20:44,630 --> 00:20:50,950
so both Heather how do you think the
chase on could be parsed

312
00:20:50,950 --> 00:20:55,820
well just simply it'll

313
00:20:55,820 --> 00:20:59,490
so when I saw the evil eye so that I
could exploited up to the process

314
00:20:59,490 --> 00:21:01,820
scripting

315
00:21:01,820 --> 00:21:05,130
our we cannot just redirect

316
00:21:05,130 --> 00:21:08,240
to remember that the day like

317
00:21:08,240 --> 00:21:12,669
and point is also the oath point so we
can sit there directly right

318
00:21:12,669 --> 00:21:17,110
and to you trade to redirect the flow
into something

319
00:21:17,110 --> 00:21:22,980
some interesting Europe but

320
00:21:22,980 --> 00:21:26,559
the checks redirects are not permitted
so

321
00:21:26,559 --> 00:21:33,559
if the across to me

322
00:21:34,330 --> 00:21:39,940
so any another method to you

323
00:21:39,940 --> 00:21:43,100
to make calls on pick up for Facebook to
come to me

324
00:21:43,100 --> 00:21:46,590
so in order to sit there redirect a
right to point to something interesting

325
00:21:46,590 --> 00:21:48,070
I need to first

326
00:21:48,070 --> 00:21:51,649
iight to set their direct you're right
to point to the same

327
00:21:51,649 --> 00:21:55,649
the main where their crest was on

328
00:21:55,649 --> 00:22:01,309
invoked from and also any to control
this for director right because

329
00:22:01,309 --> 00:22:06,190
I there was one check if they're greater
to rate was not too long

330
00:22:06,190 --> 00:22:09,340
to use the application well the

331
00:22:09,340 --> 00:22:14,770
call was not handled it all

332
00:22:14,770 --> 00:22:17,780
so there was only 21

333
00:22:17,780 --> 00:22:22,690
way to papers this

334
00:22:22,690 --> 00:22:25,950
by of bach to the flesh transport

335
00:22:25,950 --> 00:22:31,399
so

336
00:22:31,399 --> 00:22:35,950
she answered two extremes with the flesh
transport if you connect with the same

337
00:22:35,950 --> 00:22:38,990
channel they can talk to each other

338
00:22:38,990 --> 00:22:42,429
and the thing was there is a secret nah
civilization

339
00:22:42,429 --> 00:22:46,500
to the GS is the key so an hour

340
00:22:46,500 --> 00:22:50,030
the secret hospice some kind of Defense
which is made

341
00:22:50,030 --> 00:22:53,070
in order to

342
00:22:53,070 --> 00:22:57,340
on tonight any any communication with
the unknown object

343
00:22:57,340 --> 00:23:00,580
so this up for proxy spf

344
00:23:00,580 --> 00:23:03,780
doesn't know this signals this

345
00:23:03,780 --> 00:23:06,970
spring chick someone other proxy object
from

346
00:23:06,970 --> 00:23:10,679
my own to me I will not know this
signals

347
00:23:10,679 --> 00:23:14,140
so I don't be able to you submit

348
00:23:14,140 --> 00:23:17,970
I'll to invoke some interesting facts
functions to choose

349
00:23:17,970 --> 00:23:21,300
GS sticky but but was

350
00:23:21,300 --> 00:23:24,380
that the proxy the spf

351
00:23:24,380 --> 00:23:28,320
did not implement the on civilization

352
00:23:28,320 --> 00:23:31,620
into the input for top

353
00:23:31,620 --> 00:23:34,990
so imagine what will happen

354
00:23:34,990 --> 00:23:39,220
if I'm if I inject instead to Facebook
first a frame

355
00:23:39,220 --> 00:23:43,360
my only friend the malicious proxy
notice we have

356
00:23:43,360 --> 00:23:47,530
will transmit message to the proxy spf
the proxy doesn't

357
00:23:47,530 --> 00:23:51,409
this check signals transmits the message

358
00:23:51,409 --> 00:23:54,790
and to the GST

359
00:23:54,790 --> 00:23:59,510
then everything feels because in Aus
business

360
00:23:59,510 --> 00:24:03,159
doesn't create to respond to the
purified Billy but

361
00:24:03,159 --> 00:24:06,750
I in my case

362
00:24:06,750 --> 00:24:10,550
ok if this low flow I need only to
submit message into the Facebook

363
00:24:10,550 --> 00:24:14,010
controller and I didn't get to you

364
00:24:14,010 --> 00:24:17,370
submit any almost to the control occurs
there is no most

365
00:24:17,370 --> 00:24:22,570
host check so

366
00:24:22,570 --> 00:24:27,419
I just answer to iframes

367
00:24:27,419 --> 00:24:30,450
with the to spf

368
00:24:30,450 --> 00:24:34,220
frames and concert this Thursday frame

369
00:24:34,220 --> 00:24:37,690
which start flow

370
00:24:37,690 --> 00:24:41,580
actually the up for a free man at

371
00:24:41,580 --> 00:24:44,580
the middle a frame think that T are
connected

372
00:24:44,580 --> 00:24:47,960
the but my friend thinks that the upper
iframe special

373
00:24:47,960 --> 00:24:51,100
jess is the key its Facebook let's go

374
00:24:51,100 --> 00:24:54,370
and thick copper iframe thinks that the
bottom

375
00:24:54,370 --> 00:24:58,620
stuff is going I of

376
00:24:58,620 --> 00:25:01,790
well from from prospect Frank

377
00:25:01,790 --> 00:25:05,000
so I just abused this this flow
inserting

378
00:25:05,000 --> 00:25:08,320
another 30-day free the connect to each
other

379
00:25:08,320 --> 00:25:11,690
the up refereeing thinks that

380
00:25:11,690 --> 00:25:14,700
the origin is facing face political

381
00:25:14,700 --> 00:25:18,800
the middle a frame doesn't ability the
porch at all

382
00:25:18,800 --> 00:25:22,010
so through the day 3 objects pays

383
00:25:22,010 --> 00:25:25,600
initiate the flow and the upper iframe

384
00:25:25,600 --> 00:25:29,350
transmits the message to the Facebook a
controller now the origin

385
00:25:29,350 --> 00:25:33,980
is exactly the face but I'm then the
Facebook may request you

386
00:25:33,980 --> 00:25:37,050
the delicate point and them

387
00:25:37,050 --> 00:25:40,159
as a director or a point it's something
interesting

388
00:25:40,159 --> 00:25:43,389
I need to find quality the container for
the JavaScript

389
00:25:43,389 --> 00:25:48,340
well appeals cannot cut above the to
respect to the Facebook

390
00:25:48,340 --> 00:25:53,290
kiss well there is no way to do this

391
00:25:53,290 --> 00:26:00,280
have chosen to you rough over JavaScript
to picture

392
00:26:00,280 --> 00:26:03,389
so pound

393
00:26:03,389 --> 00:26:07,149
the another program was that d

394
00:26:07,149 --> 00:26:10,340
safe image PHP proxy

395
00:26:10,340 --> 00:26:13,810
respectful the picture so opened the
picture

396
00:26:13,810 --> 00:26:17,909
them build it beat my so its memory and
then affect everything to gain

397
00:26:17,909 --> 00:26:22,020
so to you to insert some

398
00:26:22,020 --> 00:26:25,090
meaningful payload was impossible I

399
00:26:25,090 --> 00:26:28,090
divided failed into two parts stage 0

400
00:26:28,090 --> 00:26:31,129
stage 1 so stay 0

401
00:26:31,129 --> 00:26:35,950
was very small thing just on

402
00:26:35,950 --> 00:26:40,530
allow it to you elite my own code

403
00:26:40,530 --> 00:26:44,760
and the safe image to PHP script itself

404
00:26:44,760 --> 00:26:48,450
he said another mitigation from Facebook

405
00:26:48,450 --> 00:26:51,639
it made impossible

406
00:26:51,639 --> 00:26:55,010
leaking see your real into their

407
00:26:55,010 --> 00:27:02,010
licking their effort from Facebook to
remember the first book

408
00:27:07,899 --> 00:27:10,889
a link to the URL string for the river

409
00:27:10,889 --> 00:27:15,360
so it wasn't possible to redirect to
something on Facebook com because

410
00:27:15,360 --> 00:27:18,840
even the all external content from
Facebook

411
00:27:18,840 --> 00:27:22,440
is showed through the safe image PHP so
all the pictures

412
00:27:22,440 --> 00:27:25,700
all the efforts meant you have is a
going through

413
00:27:25,700 --> 00:27:29,009
this proxy this kind of Defense for
Facebook

414
00:27:29,009 --> 00:27:33,720
I decided to send it to you this defense
mechanism in order to you

415
00:27:33,720 --> 00:27:40,720
explore the excess so it probs had my
picture from my own domain through a

416
00:27:44,320 --> 00:27:44,700
safe

417
00:27:44,700 --> 00:27:47,779
image PHP van the

418
00:27:47,779 --> 00:27:51,230
image was executed by the evil people
hander

419
00:27:51,230 --> 00:27:54,389
and well the excess was exploited

420
00:27:54,389 --> 00:27:57,960
so

421
00:27:57,960 --> 00:28:02,440
this box for something interesting for
me because

422
00:28:02,440 --> 00:28:06,039
its another way to exploit the
well-known process cryptic books

423
00:28:06,039 --> 00:28:09,240
well it's not only about filtering it's
not gonna be about

424
00:28:09,240 --> 00:28:12,279
reflecting something I'll with both

425
00:28:12,279 --> 00:28:17,100
you're good you new way to explore Texas
and with the Argosy

426
00:28:17,100 --> 00:28:20,990
you can also use videos

427
00:28:20,990 --> 00:28:24,250
icon for flow well what's

428
00:28:24,250 --> 00:28:27,409
what's another interesting issues it
well

429
00:28:27,409 --> 00:28:32,240
I if you think about the whole web
service

430
00:28:32,240 --> 00:28:36,039
click as notes as a contraflow

431
00:28:36,039 --> 00:28:39,759
the both redirects themself are kind of

432
00:28:39,759 --> 00:28:44,559
eros from notes and that can be used to
propagate your javascript

433
00:28:44,559 --> 00:28:49,679
so if you could redirect to your and
I'll

434
00:28:49,679 --> 00:28:54,210
showed a look point or any other
important it can lead to excess

435
00:28:54,210 --> 00:28:59,889
if you well let's get some practice
kerosene

436
00:28:59,889 --> 00:29:04,799
so

437
00:29:04,799 --> 00:29:07,799
dream I talk

438
00:29:07,799 --> 00:29:12,379
I I think all the books were related to
you

439
00:29:12,379 --> 00:29:16,230
tempering their refrigerator will indeed
if you

440
00:29:16,230 --> 00:29:20,429
leak something was referred any to use
redirect page

441
00:29:20,429 --> 00:29:25,059
to the some controlled use

442
00:29:25,059 --> 00:29:28,190
in some control way so

443
00:29:28,190 --> 00:29:32,110
if you explore the talking transferred
during direct to you

444
00:29:32,110 --> 00:29:35,539
for example I give his parameters for
the

445
00:29:35,539 --> 00:29:39,370
for iframe for you just three directors

446
00:29:39,370 --> 00:29:44,980
alt proxy if you explore it his bank
navigation if you pull data from the

447
00:29:44,980 --> 00:29:45,389
Hess

448
00:29:45,389 --> 00:29:51,480
you also tempers are directly right and
also if you're using the SDK education

449
00:29:51,480 --> 00:29:52,529
the issue was

450
00:29:52,529 --> 00:29:57,409
that the creature I was tempting so

451
00:29:57,409 --> 00:30:00,700
the standards the oath

452
00:30:00,700 --> 00:30:06,070
2.0 said that the rate you're right

453
00:30:06,070 --> 00:30:09,379
I think may be or should be static

454
00:30:09,379 --> 00:30:13,399
or at least they can be waitlisted but

455
00:30:13,399 --> 00:30:16,850
I think that the the standards pas 2.0

456
00:30:16,850 --> 00:30:19,990
this statement should be changed must
because

457
00:30:19,990 --> 00:30:24,019
Inc is a facebook just single weakness
in the standards

458
00:30:24,019 --> 00:30:27,919
let to you I think five different ways

459
00:30:27,919 --> 00:30:34,919
choose use Facebook

460
00:30:38,919 --> 00:30:42,750
so that's all I've got any questions

461
00:30:42,750 --> 00:30:49,750
I would be happy to answer them any
questions from grief

462
00:30:56,360 --> 00:30:59,990
right about your own it excesses
exploits

463
00:30:59,990 --> 00:31:05,310
based on the picture and the same rights
that

464
00:31:05,310 --> 00:31:08,890
you have that teacher with villagers
could

465
00:31:08,890 --> 00:31:13,910
code in this picture also valid to
ability to the script execution

466
00:31:13,910 --> 00:31:17,860
say that you'll yeah and the you have it
a heater

467
00:31:17,860 --> 00:31:21,860
is a GA if indicted by its its binary
bytes

468
00:31:21,860 --> 00:31:25,820
and poetry will it be chipped
surveillance does

469
00:31:25,820 --> 00:31:29,050
your let me

470
00:31:29,050 --> 00:31:34,090
attractive it's late so there is another

471
00:31:34,090 --> 00:31:37,130
mitigation at Facebook controller it's
called

472
00:31:37,130 --> 00:31:41,570
actual message I don't know how many
have you looked into the Facebook

473
00:31:41,570 --> 00:31:45,220
controllers are script called if there
are any just raise your hand

474
00:31:45,220 --> 00:31:50,320
I think now so up both his song

475
00:31:50,320 --> 00:31:53,960
responses from Facebook are its

476
00:31:53,960 --> 00:31:57,800
so infinite loop

477
00:31:57,800 --> 00:32:01,090
stated into the beginning so you can
inject this

478
00:32:01,090 --> 00:32:04,140
chase on into your page export texas'
simple week

479
00:32:04,140 --> 00:32:08,210
in order to cut this first part first
night bites

480
00:32:08,210 --> 00:32:12,390
at this juice on religious or response
there's a

481
00:32:12,390 --> 00:32:17,530
and chill response function to the up
controllers and I just abused this

482
00:32:17,530 --> 00:32:18,940
function in order to cut

483
00:32:18,940 --> 00:32:22,320
9 interest in bytes at the image so

484
00:32:22,320 --> 00:32:25,400
the header starts this JF not

485
00:32:25,400 --> 00:32:28,480
87 a and something that and then goes

486
00:32:28,480 --> 00:32:32,780
slash and then strain so

487
00:32:32,780 --> 00:32:36,350
then string and somewhere are

488
00:32:36,350 --> 00:32:42,760
it's a comment right and to stand you

489
00:32:42,760 --> 00:32:45,850
our brings so

490
00:32:45,850 --> 00:32:49,010
I'll the contrail day to start right

491
00:32:49,010 --> 00:32:52,340
an at this part Heather where the length

492
00:32:52,340 --> 00:32:55,920
was given and give so with PNG

493
00:32:55,920 --> 00:32:59,880
this magic didn't work p

494
00:32:59,880 --> 00:33:03,210
any other questions no

495
00:33:03,210 --> 00:33:05,670
alright ok thank you very much 100 for
your talks

