1
00:00:02,190 --> 00:00:08,380
well

2
00:00:08,380 --> 00:00:15,380
yeah I'll

3
00:00:15,750 --> 00:00:22,750
yes

4
00:00:23,680 --> 00:00:25,400
thank you I have

5
00:00:25,400 --> 00:00:29,560
my talk is so about a orchestrating a
fire sale

6
00:00:29,560 --> 00:00:32,950
or like die hard like scenarios for

7
00:00:32,950 --> 00:00:36,290
upbringing Dutch large systems to their
knees

8
00:00:36,290 --> 00:00:41,370
I love the

9
00:00:41,370 --> 00:00:44,870
I found some crucial for abilities in

10
00:00:44,870 --> 00:00:48,239
the way that alarmed I owners
communicate

11
00:00:48,239 --> 00:00:51,830
with the a ARC's Tyler receive centers

12
00:00:51,830 --> 00:00:55,089
a and that's what I'm gonna talk to you
about

13
00:00:55,089 --> 00:00:58,159
first I'm gonna talk a little bit about
me

14
00:00:58,159 --> 00:01:03,030
a I'm a reverse engineer a I stumbled
upon this by accident

15
00:01:03,030 --> 00:01:07,330
a because I was just prefers engineering
s

16
00:01:07,330 --> 00:01:10,770
a in my day job I work at Nick F

17
00:01:10,770 --> 00:01:13,909
the Dutch National Institute for
subatomic physics

18
00:01:13,909 --> 00:01:17,240
where we do a I do projects

19
00:01:17,240 --> 00:01:20,770
for up a supporting

20
00:01:20,770 --> 00:01:27,770
physicists a on the grid

21
00:01:28,149 --> 00:01:32,140
that's interesting

22
00:01:32,140 --> 00:01:35,790
a and a

23
00:01:35,790 --> 00:01:39,049
I'm the free and open source software
developer I've

24
00:01:39,049 --> 00:01:42,899
work that some by the past life been
patching Linux kernel and a lot of

25
00:01:42,899 --> 00:01:43,710
Debian

26
00:01:43,710 --> 00:01:48,179
a a packages have my patches

27
00:01:48,179 --> 00:01:51,399
I'm also the cofounder and treasure of

28
00:01:51,399 --> 00:01:55,360
better this the hackerspace and I'm a
sport and

29
00:01:55,360 --> 00:01:58,979
that's actually where I a I started this
project on

30
00:01:58,979 --> 00:02:02,460
because we have an alarm system

31
00:02:02,460 --> 00:02:05,909
and are alarm system

32
00:02:05,909 --> 00:02:08,940
reports to the alarm receive center

33
00:02:08,940 --> 00:02:12,440
but I actually want to get all this
information as well

34
00:02:12,440 --> 00:02:15,709
so why are they the only ones who get
these defense

35
00:02:15,709 --> 00:02:18,930
I want to to have these stew la gum

36
00:02:18,930 --> 00:02:23,150
and to see what the hell is going on at
a record pace if someone is breaking in

37
00:02:23,150 --> 00:02:23,959
I wanna know

38
00:02:23,959 --> 00:02:27,220
and I want our community to know that
somebody's breaking in case

39
00:02:27,220 --> 00:02:31,540
someone in the communities gotta be in
the neighborhood to check it out

40
00:02:31,540 --> 00:02:34,650
so we broadcast all this

41
00:02:34,650 --> 00:02:39,340
on IRC let's actually working right now
I'm

42
00:02:39,340 --> 00:02:43,090
so let's take a look at the protocols

43
00:02:43,090 --> 00:02:46,730
so what is out there a

44
00:02:46,730 --> 00:02:50,359
for those not familiar with alarm
systems there's

45
00:02:50,359 --> 00:02:54,190
a a couple of legacy hemlock particles

46
00:02:54,190 --> 00:02:58,069
actually there's tons more variations a
but these are the

47
00:02:58,069 --> 00:03:01,750
the most important ones I'm the

48
00:03:01,750 --> 00:03:05,319
a Seattle and there's the extent that
SIA

49
00:03:05,319 --> 00:03:09,859
for a lock and they're still Ademco
contact ID a

50
00:03:09,859 --> 00:03:13,280
and all the other protocols are actually

51
00:03:13,280 --> 00:03:17,400
evolved from the alar protocols a

52
00:03:17,400 --> 00:03:21,730
on the IP landscape we have

53
00:03:21,730 --> 00:03:25,579
a CIA chess thats HS for highly secure

54
00:03:25,579 --> 00:03:28,590
it is not a

55
00:03:28,590 --> 00:03:32,299
we have fable on second P that is so

56
00:03:32,299 --> 00:03:35,720
pro-growth actually try to implemented
crypto

57
00:03:35,720 --> 00:03:38,889
but failed in in quite a bit of

58
00:03:38,889 --> 00:03:43,819
a of what they were trying to do now
there's a car on proprietary protocol

59
00:03:43,819 --> 00:03:47,120
thats a a not

60
00:03:47,120 --> 00:03:49,300
really all that

61
00:03:49,300 --> 00:03:54,349
a leaky except that they have the option
to turn off encryption

62
00:03:54,349 --> 00:03:57,459
not working and then there's a

63
00:03:57,459 --> 00:04:01,610
yet I'm quite the protocol which is very
simple I have not actually looked at it

64
00:04:01,610 --> 00:04:05,379
key properly but I've so have seen
several messages that were completely

65
00:04:05,379 --> 00:04:07,340
identical so I know it's not good crypto

66
00:04:07,340 --> 00:04:10,580
so I'm gonna checked that out later

67
00:04:10,580 --> 00:04:14,310
and there there's the American Standard
& a German standard which I have not

68
00:04:14,310 --> 00:04:17,290
looked at all because I have to pay for
it standards

69
00:04:17,290 --> 00:04:22,639
and I do want to do so

70
00:04:22,639 --> 00:04:25,770
um there's a fatal problem with

71
00:04:25,770 --> 00:04:29,639
the industry a there's a couple fatal

72
00:04:29,639 --> 00:04:33,960
assumptions that are made a couple fail
mistakes

73
00:04:33,960 --> 00:04:37,350
and I'm gonna talk to you about two
particles

74
00:04:37,350 --> 00:04:41,240
the CHS and Fable second be and

75
00:04:41,240 --> 00:04:45,760
how big the problem really is but first
I'm gonna talk

76
00:04:45,760 --> 00:04:49,610
due to couples assumptions that seem to
be go around in the

77
00:04:49,610 --> 00:04:53,080
security industry a or at least the

78
00:04:53,080 --> 00:04:56,820
to non digital security industry I'm

79
00:04:56,820 --> 00:04:59,940
well what are the things they were
actually

80
00:04:59,940 --> 00:05:03,740
actively trying to do the same for the
pin it's like

81
00:05:03,740 --> 00:05:08,700
okay I can have a secure connection just
by

82
00:05:08,700 --> 00:05:12,099
a setting up

83
00:05:12,099 --> 00:05:15,210
certification policy for Internet
service providers

84
00:05:15,210 --> 00:05:18,320
so if I certified internet service
provider

85
00:05:18,320 --> 00:05:21,849
that they have secure communication or
or some sort of

86
00:05:21,849 --> 00:05:26,120
they're good enough infrastructure and
then I'm going to appear with them

87
00:05:26,120 --> 00:05:27,360
directly and

88
00:05:27,360 --> 00:05:30,870
that everything must be secure right no

89
00:05:30,870 --> 00:05:34,280
that's not how the internet works a

90
00:05:34,280 --> 00:05:38,490
you cannot trust back it on the internet

91
00:05:38,490 --> 00:05:43,000
so if you certify an ISP it's not going
to help you have to treat the entire

92
00:05:43,000 --> 00:05:46,690
chain as being untrusted purse are not
doing

93
00:05:46,690 --> 00:05:49,950
well

94
00:05:49,950 --> 00:05:54,139
sources just can't be trusted well i've
seen this assumption and a couple of

95
00:05:54,139 --> 00:05:55,060
protocols

96
00:05:55,060 --> 00:05:58,690
um if the source IP matches

97
00:05:58,690 --> 00:06:01,870
it must be legit no it is not it is not

98
00:06:01,870 --> 00:06:04,950
and analog system anymore you cannot con

99
00:06:04,950 --> 00:06:08,020
you cannot trust the caller ID a.m. and

100
00:06:08,020 --> 00:06:11,870
even in the analog world he couldn't
rusty contact ID anyway

101
00:06:11,870 --> 00:06:17,389
bad

102
00:06:17,389 --> 00:06:22,439
a well apparently they do not think a
session can be hijacked

103
00:06:22,439 --> 00:06:26,210
a so they assume that

104
00:06:26,210 --> 00:06:30,089
on the Internet back its all from the
same pier which

105
00:06:30,089 --> 00:06:35,129
is incorrect as well a

106
00:06:35,129 --> 00:06:41,830
yeah I don't think I have to explain
that to this crowd

107
00:06:41,830 --> 00:06:47,300
this one is actually pretty interesting
um if I haven't proprietary protocol

108
00:06:47,300 --> 00:06:51,870
and I you some fancy encryption which my
electric tactics

109
00:06:51,870 --> 00:06:55,750
came up with hum nobody can test the

110
00:06:55,750 --> 00:06:58,770
the coat this it's got to be secure
right

111
00:06:58,770 --> 00:07:03,020
well no the avatar next product catalog

112
00:07:03,020 --> 00:07:07,680
specifies that its impossible to
decipher the message using

113
00:07:07,680 --> 00:07:11,139
their ca$h test protocol well

114
00:07:11,139 --> 00:07:14,539
we're gonna look at it later and see how
secure really is

115
00:07:14,539 --> 00:07:18,319
but I can guarantee you it is not
impossible

116
00:07:18,319 --> 00:07:25,319
but I like to do impossible things
before breakfast anyway so

117
00:07:27,030 --> 00:07:30,130
yeah all certification very interesting

118
00:07:30,130 --> 00:07:34,320
so the security industry works

119
00:07:34,320 --> 00:07:37,480
a lot with certifications I

120
00:07:37,480 --> 00:07:41,190
if you have a certificate on your
product it means that secure

121
00:07:41,190 --> 00:07:44,420
no matter what vulnerabilities are in
there

122
00:07:44,420 --> 00:07:47,970
strongest to certificates on it their
insurance companies are happy

123
00:07:47,970 --> 00:07:51,860
and their product will be good enough it
will be secure

124
00:07:51,860 --> 00:07:57,760
if fact the after Nick send out a
security bollard center customer saying

125
00:07:57,760 --> 00:08:01,070
we emphasize that he uncovered from
abilities do not

126
00:08:01,070 --> 00:08:04,420
influence the product certification
really

127
00:08:04,420 --> 00:08:09,840
interesting so the certification
actually means nothing

128
00:08:09,840 --> 00:08:13,010
exactly it doesn't mean anything

129
00:08:13,010 --> 00:08:16,320
it does not mean it secure which

130
00:08:16,320 --> 00:08:23,320
day to sue that it is same for this
proprietary protocol

131
00:08:23,790 --> 00:08:27,250
I mean if I send it back at and I
crafted a specific way on the other side

132
00:08:27,250 --> 00:08:28,750
candy-coated

133
00:08:28,750 --> 00:08:33,280
must be impossible

134
00:08:33,280 --> 00:08:36,770
for others to do this yeah no

135
00:08:36,770 --> 00:08:39,960
that's not true we can reverse engineer
this no problem

136
00:08:39,960 --> 00:08:44,100
same for this one all

137
00:08:44,100 --> 00:08:47,920
if its peak the same protocol it must be
a valid Pierre so

138
00:08:47,920 --> 00:08:51,340
if I can establish a communication we
actually speak the same language

139
00:08:51,340 --> 00:08:54,680
the other side must be trusted right no

140
00:08:54,680 --> 00:09:01,100
role this one is actually the one that
was made

141
00:09:01,100 --> 00:09:04,770
by feeble for their second the protocol

142
00:09:04,770 --> 00:09:08,730
they have implemented crypto they could
have done it right

143
00:09:08,730 --> 00:09:13,020
but a they're almost got it right

144
00:09:13,020 --> 00:09:18,050
the encryption but they did not actually
fair fight

145
00:09:18,050 --> 00:09:21,090
who they were sending it to they did not
do a

146
00:09:21,090 --> 00:09:25,270
identity checks so basically we're
during ours a security

147
00:09:25,270 --> 00:09:29,070
a and using that to send out a

148
00:09:29,070 --> 00:09:32,460
encrypt it AF ski for a session key

149
00:09:32,460 --> 00:09:35,540
so if there were done if they would have
done it right

150
00:09:35,540 --> 00:09:38,530
that would have have a secure connection
but no way to know what they were

151
00:09:38,530 --> 00:09:39,150
talking to

152
00:09:39,150 --> 00:09:46,150
incorrect encryption is not enough

153
00:09:47,689 --> 00:09:50,649
this is actually the cairo case I'll

154
00:09:50,649 --> 00:09:53,850
if you are security company

155
00:09:53,850 --> 00:09:58,809
and you give your I'm alarm centers the
option to disable

156
00:09:58,809 --> 00:10:03,040
the encryption you cannot assume that
they're not gonna do this in a life

157
00:10:03,040 --> 00:10:03,920
deployment

158
00:10:03,920 --> 00:10:07,579
I've actually seen alarm receive centers
operate

159
00:10:07,579 --> 00:10:10,800
without encryption and the encryption in
the Cairo

160
00:10:10,800 --> 00:10:14,779
for a cause also the identification
because they use a rotating key

161
00:10:14,779 --> 00:10:18,569
and it would be secure if it was unable
because the key

162
00:10:18,569 --> 00:10:22,309
was only know to the other party and if
the

163
00:10:22,309 --> 00:10:26,149
key matches to encryption you would have

164
00:10:26,149 --> 00:10:30,189
at least know that the other side has
the proper key but if your gonna turn

165
00:10:30,189 --> 00:10:31,290
off the encryption

166
00:10:31,290 --> 00:10:35,860
you're actually making the entire
protocol anonymous again and is actually

167
00:10:35,860 --> 00:10:39,470
alive deployment right now in the
security industry

168
00:10:39,470 --> 00:10:42,610
its yeah

169
00:10:42,610 --> 00:10:46,300
apparently it is easier for

170
00:10:46,300 --> 00:10:50,220
I am the alarm receive centers to

171
00:10:50,220 --> 00:10:53,420
have their technicians that are on site
just

172
00:10:53,420 --> 00:10:56,439
plugin something and configure the IP
and say

173
00:10:56,439 --> 00:10:59,910
okay now it's secure but it's not and

174
00:10:59,910 --> 00:11:04,740
just enable the encryption make sure the
other side for figures a key

175
00:11:04,740 --> 00:11:08,110
or whatever but turning it off

176
00:11:08,110 --> 00:11:15,110
that don't have this option

177
00:11:15,760 --> 00:11:18,870
and the final assumption there are made
is like

178
00:11:18,870 --> 00:11:22,620
a if your alarm system electronics
engineer

179
00:11:22,620 --> 00:11:26,180
it does not mean you understand Internet
Security a

180
00:11:26,180 --> 00:11:30,010
this mean you can't design it but you
can assume that you cat

181
00:11:30,010 --> 00:11:33,680
a Internet Security is a business

182
00:11:33,680 --> 00:11:36,840
you can I mean if there would have used
something like

183
00:11:36,840 --> 00:11:40,130
SL for secure communication channel they
would a floating

184
00:11:40,130 --> 00:11:43,850
they would at least of low this to a
library that would actually do all the

185
00:11:43,850 --> 00:11:44,880
security for them

186
00:11:44,880 --> 00:11:47,970
but the way it's implemented now

187
00:11:47,970 --> 00:11:51,090
everybody's string0 source obfuscation

188
00:11:51,090 --> 00:11:54,300
methods and actually not secure in any
way

189
00:11:54,300 --> 00:11:58,350
a so don't have your

190
00:11:58,350 --> 00:12:02,030
electronics engineers design your
security have security engineers tonight

191
00:12:02,030 --> 00:12:02,650
security

192
00:12:02,650 --> 00:12:08,210
well let's go through the alarm dialer
basics

193
00:12:08,210 --> 00:12:12,280
um there's a couple Akram so much
lighter try to limit them

194
00:12:12,280 --> 00:12:17,630
but there's a couple I i cannot really
avoid

195
00:12:17,630 --> 00:12:21,360
there's a t-test alarm transfer
equipment or I'm

196
00:12:21,360 --> 00:12:25,970
actual a trying to call that the dire as
much as possible dollar receive Center

197
00:12:25,970 --> 00:12:29,570
which is basically to operator a on the
other hand

198
00:12:29,570 --> 00:12:34,180
over the a alarm receiving and that one
is actually the

199
00:12:34,180 --> 00:12:38,780
person that's going to call the police
if there's a problem there's a prom key

200
00:12:38,780 --> 00:12:41,960
that's a unique account code for
building thats

201
00:12:41,960 --> 00:12:45,500
sequentially handed out so that's one to
ten thousand

202
00:12:45,500 --> 00:12:49,320
up from coats for any given protocol

203
00:12:49,320 --> 00:12:54,310
a that it he is the starter it sends out
the alarms

204
00:12:54,310 --> 00:12:57,470
here she just says basic
acknowledgements

205
00:12:57,470 --> 00:13:01,440
a something you should know is that

206
00:13:01,440 --> 00:13:05,130
inside because they're see our coats and
its to

207
00:13:05,130 --> 00:13:08,580
character coats thats like burglary
alarm

208
00:13:08,580 --> 00:13:13,940
purple restore hum tamper alarm if
somebody's tampering with the sensor

209
00:13:13,940 --> 00:13:15,239
or

210
00:13:15,239 --> 00:13:18,259
I'm the panic alarm which is so the
robbery button

211
00:13:18,259 --> 00:13:22,089
if you're a bank can you have a the said
every counter

212
00:13:22,089 --> 00:13:25,879
I'm suppress it lol alarm is being sent
out to

213
00:13:25,879 --> 00:13:30,929
the I receive Center saying panic alarm
if you want to restore this you hacked

214
00:13:30,929 --> 00:13:31,980
have to have a key

215
00:13:31,980 --> 00:13:35,379
to actually a lot the button and then
the panic restore is

216
00:13:35,379 --> 00:13:41,579
being sent out over the wire well

217
00:13:41,579 --> 00:13:45,319
let's look at first for a call um

218
00:13:45,319 --> 00:13:48,779
see a highly secure

219
00:13:48,779 --> 00:13:52,439
its protocol designed by alpha Tronix

220
00:13:52,439 --> 00:13:58,389
for their own products a it was designed
to think in 1993 1992

221
00:13:58,389 --> 00:14:01,589
a its impossible to decipher

222
00:14:01,589 --> 00:14:04,850
according to the 2013 catalog

223
00:14:04,850 --> 00:14:09,119
a well a TI secure

224
00:14:09,119 --> 00:14:13,379
reviews so I don't know how many view
connection

225
00:14:13,379 --> 00:14:17,369
read this but if you have seen this
presentation before

226
00:14:17,369 --> 00:14:21,069
try not to speak but I'll can any big
guess

227
00:14:21,069 --> 00:14:28,069
which site for this would use just yell

228
00:14:31,300 --> 00:14:34,990
okay have cracked that's okay um

229
00:14:34,990 --> 00:14:38,380
you are looking at a packet

230
00:14:38,380 --> 00:14:42,180
this is a packet this being sent out
from the dialer

231
00:14:42,180 --> 00:14:46,730
to the particle this is actually a
protocol the sector are you looking at

232
00:14:46,730 --> 00:14:50,720
hi its cool Wireshark and

233
00:14:50,720 --> 00:14:53,930
a this is the have

234
00:14:53,930 --> 00:14:57,230
basically a basic IP header and

235
00:14:57,230 --> 00:15:00,620
from the highlighted parts for

236
00:15:00,620 --> 00:15:06,390
okay from the highlighted part that's
actually the particle part

237
00:15:06,390 --> 00:15:09,560
so what think you actually see

238
00:15:09,560 --> 00:15:13,620
is that there's a repeating pattern in
here a

239
00:15:13,620 --> 00:15:20,620
we see here that there's a lot of b6 b6
b6 b6 b6 b6 b6 b6 going on

240
00:15:21,060 --> 00:15:24,260
this means that this not proper crypto

241
00:15:24,260 --> 00:15:28,830
it cannot be proper crypto my first
instinct when I saw this was

242
00:15:28,830 --> 00:15:31,990
okay let's try and get this to work
source I for

243
00:15:31,990 --> 00:15:35,140
it rains or dis entire string would be
six

244
00:15:35,140 --> 00:15:38,380
well

245
00:15:38,380 --> 00:15:41,670
irate and made a small script for test
just

246
00:15:41,670 --> 00:15:44,680
exporting to by Terry from hah

247
00:15:44,680 --> 00:15:47,900
for Wireshark just pay student bison

248
00:15:47,900 --> 00:15:51,770
exhort with b6 that's so what you see
here

249
00:15:51,770 --> 00:15:56,130
it well

250
00:15:56,130 --> 00:16:00,430
we have indecipherable message some of
them is actually not pass key

251
00:16:00,430 --> 00:16:04,950
so on forgive me if so you can read all
the characters

252
00:16:04,950 --> 00:16:08,690
but you can actually see that this is a
station registration request

253
00:16:08,690 --> 00:16:13,970
this is actually the heart of the
protocol in this

254
00:16:13,970 --> 00:16:16,990
couples minutes we've actually broken

255
00:16:16,990 --> 00:16:21,890
the protocol already I give this
presentation to a couple of

256
00:16:21,890 --> 00:16:25,640
a a security people

257
00:16:25,640 --> 00:16:28,640
a just about 30% of the Dutch people

258
00:16:28,640 --> 00:16:32,180
the security people and

259
00:16:32,180 --> 00:16:37,240
actually that was just blurted out
people blurted out the key as well

260
00:16:37,240 --> 00:16:40,770
having this is not hard to do it's
actually

261
00:16:40,770 --> 00:16:44,290
very very simple so what you see here is
that

262
00:16:44,290 --> 00:16:47,650
there's the a act a CLX 1.7

263
00:16:47,650 --> 00:16:51,300
that his the dialer if I stay

264
00:16:51,300 --> 00:16:55,450
and it's trying to register to the our
alarm perceive Center

265
00:16:55,450 --> 00:16:58,510
what we also see is 1255

266
00:16:58,510 --> 00:17:01,720
which is actually an incorrectly and
coated prom code

267
00:17:01,720 --> 00:17:06,370
their encoding just is actually a
decimal value the encoding it has tax

268
00:17:06,370 --> 00:17:10,220
which is incorrect but put was making my
life easier

269
00:17:10,220 --> 00:17:13,650
because I can just see in the hex that

270
00:17:13,650 --> 00:17:17,540
that is actually from Kirk so thank you

271
00:17:17,540 --> 00:17:21,400
but my life easier so

272
00:17:21,400 --> 00:17:26,490
all okay the return back at

273
00:17:26,490 --> 00:17:30,180
I don't know if you can actually see
this but can anybody guess

274
00:17:30,180 --> 00:17:34,890
what key this would be

275
00:17:34,890 --> 00:17:38,540
excellent we've now cracked the return
package as well

276
00:17:38,540 --> 00:17:41,590
so we have the registration renewal

277
00:17:41,590 --> 00:17:44,600
request have asserted registration
renewal

278
00:17:44,600 --> 00:17:48,550
and is directing it to a different port
for the rest of the communication

279
00:17:48,550 --> 00:17:52,800
but this is actually the heart of the
entire protocol it would just

280
00:17:52,800 --> 00:17:56,330
give out this year code in this session

281
00:17:56,330 --> 00:18:00,160
this way um and it's not really secure

282
00:18:00,160 --> 00:18:04,420
I mean I would not say in my product
catalog

283
00:18:04,420 --> 00:18:07,720
but this is impossible to decipher
because

284
00:18:07,720 --> 00:18:11,920
well we've deciphered the Peter back
pretty quickly

285
00:18:11,920 --> 00:18:17,310
didn't so what do we have

286
00:18:17,310 --> 00:18:20,770
a we have the packet length

287
00:18:20,770 --> 00:18:24,700
based in the first I'll part of the
packet

288
00:18:24,700 --> 00:18:28,270
first 4 bytes that we have the device
tame

289
00:18:28,270 --> 00:18:32,820
that sucks dick sort if the desktop from
coating process for wax

290
00:18:32,820 --> 00:18:37,500
we have the actual message was just
ASCII string a given away everything

291
00:18:37,500 --> 00:18:41,580
and that we have a csection get a check
to was a bit more work

292
00:18:41,580 --> 00:18:46,640
a because

293
00:18:46,640 --> 00:18:50,420
well I was thinking a bit too hard about
this

294
00:18:50,420 --> 00:18:53,720
how seeing a sixteen bit key

295
00:18:53,720 --> 00:18:57,390
and was trying all the algorithms like
CRC and

296
00:18:57,390 --> 00:19:01,350
all the CCAT values us your seat and to
see if she 16

297
00:19:01,350 --> 00:19:05,040
shift why doesn't this work

298
00:19:05,040 --> 00:19:09,260
well then I just put all the messages
together and I saw

299
00:19:09,260 --> 00:19:12,840
well larger pack it seems to generally
give

300
00:19:12,840 --> 00:19:17,460
higher checksums think missus AWD a
check you shouldn't do that

301
00:19:17,460 --> 00:19:21,420
but it must be either multiplication or

302
00:19:21,420 --> 00:19:24,660
addition if it's getting higher with the
decreased back and neck

303
00:19:24,660 --> 00:19:27,890
so it's like home maybe to some before
the bites

304
00:19:27,890 --> 00:19:31,140
yes it is stop actually a check so

305
00:19:31,140 --> 00:19:34,600
shit so there we go

306
00:19:34,600 --> 00:19:37,750
that the entire protocol just in a
nutshell

307
00:19:37,750 --> 00:19:41,200
though I have a code on line for

308
00:19:41,200 --> 00:19:45,710
a for just for a call a

309
00:19:45,710 --> 00:19:48,730
the ca$h SARC

310
00:19:48,730 --> 00:19:52,460
implementation I do not have the exploit
code for this

311
00:19:52,460 --> 00:19:55,670
harm to actually send out alarms

312
00:19:55,670 --> 00:20:00,190
but it's very possible to do a I have a

313
00:20:00,190 --> 00:20:04,340
a second P air-sea implementation
already which is the other protocol

314
00:20:04,340 --> 00:20:08,510
we're gonna talk about just a little bit
later um

315
00:20:08,510 --> 00:20:11,720
and I have supportable database

316
00:20:11,720 --> 00:20:16,240
event handlers and Jason Bach I receive
notification already working on the

317
00:20:16,240 --> 00:20:17,400
cairo iris touch

318
00:20:17,400 --> 00:20:20,910
implementation and that's a prior to
your protocol

319
00:20:20,910 --> 00:20:23,970
I'm still working on it I can tell you
that

320
00:20:23,970 --> 00:20:27,310
does use every five somes forever

321
00:20:27,310 --> 00:20:31,720
back at the the first Exelis md5 sum of
previous back at

322
00:20:31,720 --> 00:20:35,320
so we can actually check settlement
check that the sessions a valid

323
00:20:35,320 --> 00:20:39,740
and the Restless arc for encoded which
is not a strong security

324
00:20:39,740 --> 00:20:44,840
I am but it still is impractical to
decipher given the number of messages

325
00:20:44,840 --> 00:20:45,660
that are

326
00:20:45,660 --> 00:20:49,070
going out there and the key is rotating
every back at

327
00:20:49,070 --> 00:20:55,890
so I think it's good enough assuming
your purchase an able to sleep okay so

328
00:20:55,890 --> 00:20:57,400
this is actually what I'm doing

329
00:20:57,400 --> 00:21:00,550
had been there already today um

330
00:21:00,550 --> 00:21:04,030
this is published just small just too
small for you to see

331
00:21:04,030 --> 00:21:07,280
but what you basically see is a opening
report

332
00:21:07,280 --> 00:21:10,300
closing report this is dis is your see

333
00:21:10,300 --> 00:21:14,390
just tired she claimed and I just give
out a large defense

334
00:21:14,390 --> 00:21:18,120
for example here was a burglar alarm a

335
00:21:18,120 --> 00:21:21,220
the Berkeley zone violated well-armed
pay

336
00:21:21,220 --> 00:21:25,280
that's not right but then we see that a
couple minutes later

337
00:21:25,280 --> 00:21:29,120
so I can even reduce %ah that

338
00:21:29,120 --> 00:21:32,580
doping report the account was disarmed
and then

339
00:21:32,580 --> 00:21:36,950
actually the Berkeley was restored the
condition has been eliminated this was

340
00:21:36,950 --> 00:21:37,470
all

341
00:21:37,470 --> 00:21:41,060
in the span of two minutes so somebody
was probably just too late

342
00:21:41,060 --> 00:21:45,020
entering the key him to keep at that's
okay

343
00:21:45,020 --> 00:21:48,580
that happens the rest you see just
basically

344
00:21:48,580 --> 00:21:51,910
disarms arms justice is just so live in
Plantation

345
00:21:51,910 --> 00:21:55,720
doctor space of this protocol so you can
actually see that is

346
00:21:55,720 --> 00:22:02,720
is very possible to attack this and
decipher this

347
00:22:02,800 --> 00:22:07,110
but a couple things we should keep in
mind for designing a protocol

348
00:22:07,110 --> 00:22:10,160
we must protect it protected from

349
00:22:10,160 --> 00:22:15,490
packet injections a if we don't

350
00:22:15,490 --> 00:22:18,760
we don't have we could get some

351
00:22:18,760 --> 00:22:21,780
bogus data and will all be

352
00:22:21,780 --> 00:22:25,010
screwed we need to have

353
00:22:25,010 --> 00:22:28,470
a strong cipher we need to have strong
encryption on this

354
00:22:28,470 --> 00:22:31,800
back its because there are sensitive we
can't

355
00:22:31,800 --> 00:22:35,560
have anyone he faking this stuff they
have to be signed

356
00:22:35,560 --> 00:22:39,000
we have to no that the actual back at

357
00:22:39,000 --> 00:22:42,240
came from the source that we know

358
00:22:42,240 --> 00:22:45,580
his the building that is being protected

359
00:22:45,580 --> 00:22:48,840
we have to a fair fight identity

360
00:22:48,840 --> 00:22:54,380
otherwise it won't work and we have to
have fort secrecy

361
00:22:54,380 --> 00:22:58,520
does anybody here for is anybody here
familiar with

362
00:22:58,520 --> 00:23:03,890
what forward secrecy means forward
secrecy

363
00:23:03,890 --> 00:23:07,570
I see just one hand actually Fort
secrecy means that

364
00:23:07,570 --> 00:23:12,060
if at some point the private key is
leaked a

365
00:23:12,060 --> 00:23:15,960
you should not be able to decipher all
the past messages

366
00:23:15,960 --> 00:23:19,550
that's being sent between two the the
dialer or

367
00:23:19,550 --> 00:23:22,980
or whatever to source and the
destination you need to have

368
00:23:22,980 --> 00:23:26,160
a session cipher like diffie-hellman

369
00:23:26,160 --> 00:23:29,770
that will make sure that the rest for
the session is actually

370
00:23:29,770 --> 00:23:34,500
key to being secure because that's not
stored anywhere you cannot

371
00:23:34,500 --> 00:23:37,710
this key is not stored so you actually
have a session key

372
00:23:37,710 --> 00:23:41,780
that you just gonna throw away in a

373
00:23:41,780 --> 00:23:45,950
because if you actually for example leak
there is a private key

374
00:23:45,950 --> 00:23:50,110
in this setup woman just replace the
certificate

375
00:23:50,110 --> 00:23:54,860
put in a new one and you're fine the
past

376
00:23:54,860 --> 00:23:57,930
back its are well maybe lost a few
wilder's

377
00:23:57,930 --> 00:24:01,000
he was being compromised but anything
before that

378
00:24:01,000 --> 00:24:04,800
you cannot decipher and everything after
that you can't decipher either

379
00:24:04,800 --> 00:24:08,280
that says think I'll forward secrecy you
can't actually

380
00:24:08,280 --> 00:24:13,340
just leak the price you so you can
actually make private key is long should

381
00:24:13,340 --> 00:24:13,770
just

382
00:24:13,770 --> 00:24:18,550
replace it again

383
00:24:18,550 --> 00:24:21,580
this protocol however I'm sorry

384
00:24:21,580 --> 00:24:26,650
it's a pretty bad there's no identity
verification

385
00:24:26,650 --> 00:24:32,190
and CHS there's no such a production the
interaction between the

386
00:24:32,190 --> 00:24:35,340
ARC done I receive Center and I'm
transfer equipment

387
00:24:35,340 --> 00:24:39,780
is completely predictable this awesome
story implications

388
00:24:39,780 --> 00:24:43,610
one of them is is because they're using
you to pee packets

389
00:24:43,610 --> 00:24:46,610
I can send from my laptop a session

390
00:24:46,610 --> 00:24:51,650
from a source that I don't even have
axis2 has set up a session because

391
00:24:51,650 --> 00:24:55,850
I know what the response is going to be
the handshake is completely predictable

392
00:24:55,850 --> 00:24:59,000
I know which porn I'm gonna get redirect
to

393
00:24:59,000 --> 00:25:03,080
widely second-guessed I'll

394
00:25:03,080 --> 00:25:07,480
this way I can just attack alarm system
and actually not being

395
00:25:07,480 --> 00:25:11,470
traceable also the prom coats

396
00:25:11,470 --> 00:25:14,930
the building codes are completely
predictable

397
00:25:14,930 --> 00:25:19,560
that's one to ten thousand I can write a
script that

398
00:25:19,560 --> 00:25:22,580
just sets burglar alarm on all of them

399
00:25:22,580 --> 00:25:29,580
and that's actually have some strong
implications

400
00:25:33,880 --> 00:25:38,980
I can do a man in the military back I
can intercept back at

401
00:25:38,980 --> 00:25:42,690
to send out only the packets that I
actually want to alarm receive center to

402
00:25:42,690 --> 00:25:43,410
know about

403
00:25:43,410 --> 00:25:46,860
if I just get get in the middle

404
00:25:46,860 --> 00:25:49,940
that's actually not

405
00:25:49,940 --> 00:25:53,440
the all major pain in this park all

406
00:25:53,440 --> 00:25:58,640
the biggest pain right now is that I can
send false alarms

407
00:25:58,640 --> 00:26:02,000
from anywhere while remaining anonymous

408
00:26:02,000 --> 00:26:05,160
I can just have a script on my laptop

409
00:26:05,160 --> 00:26:09,060
that would just trigger the alarm at
other alarm receive centers

410
00:26:09,060 --> 00:26:13,130
and they would go berserk they would
call the police in the first four

411
00:26:13,130 --> 00:26:13,980
message just

412
00:26:13,980 --> 00:26:17,790
may be the first 10 messages after that
they'll start scratching their hats a

413
00:26:17,790 --> 00:26:18,460
wire

414
00:26:18,460 --> 00:26:23,970
all my customers in all our that
completely negates the police response

415
00:26:23,970 --> 00:26:27,160
there this

416
00:26:27,160 --> 00:26:30,520
implication of this sending untraceable

417
00:26:30,520 --> 00:26:34,500
false alarms the I can actually do work

418
00:26:34,500 --> 00:26:37,890
a denial-of-service on the alarm centers

419
00:26:37,890 --> 00:26:43,010
all of them I can float their screams
they won't be able to respond to a valid

420
00:26:43,010 --> 00:26:43,670
call had

421
00:26:43,670 --> 00:26:46,870
there's not gonna be any fire alarms
anymore

422
00:26:46,870 --> 00:26:50,880
it's not gonna be if burglar response
and there's also not going to be a

423
00:26:50,880 --> 00:26:52,470
robbery response anymore

424
00:26:52,470 --> 00:26:57,050
if two zones

425
00:26:57,050 --> 00:27:01,470
on a given client are activated then

426
00:27:01,470 --> 00:27:06,090
the alarm is considered confirmed
because it cannot be a sensor

427
00:27:06,090 --> 00:27:06,910
malfunction

428
00:27:06,910 --> 00:27:10,690
because normally if the sensor
malfunctions

429
00:27:10,690 --> 00:27:14,730
there's one sensor going off that's okay

430
00:27:14,730 --> 00:27:18,820
you just sent the owner of the building
to it progenitor

431
00:27:18,820 --> 00:27:22,180
whatever at checkout why the alarm is
going off

432
00:27:22,180 --> 00:27:26,610
if you have two alarms it means probably
that there somebody in the building

433
00:27:26,610 --> 00:27:29,820
so that to confirm the alarm

434
00:27:29,820 --> 00:27:33,200
that means the police is being called

435
00:27:33,200 --> 00:27:36,460
for that'll are so you can actually just

436
00:27:36,460 --> 00:27:40,460
to a denial serves the police response
because at some point they're gonna stop

437
00:27:40,460 --> 00:27:41,720
caring about this stuff

438
00:27:41,720 --> 00:27:46,690
and then you can't pull off a big heist

439
00:27:46,690 --> 00:27:50,190
while nobody cares because

440
00:27:50,190 --> 00:27:54,100
take an oath care because they don't
actually know which alarm is valid

441
00:27:54,100 --> 00:27:54,620
anymore

442
00:27:54,620 --> 00:27:59,380
which can have some pretty big
implications

443
00:27:59,380 --> 00:28:02,790
I mean

444
00:28:02,790 --> 00:28:07,010
I don't know if anybody seemed I art 3d
with all the dump trucks with gold

445
00:28:07,010 --> 00:28:11,610
keep the cops busy on the other side but

446
00:28:11,610 --> 00:28:15,000
I mean it works if just can't keep the
cops are a few here

447
00:28:15,000 --> 00:28:18,990
I mean you have plenty of time to
actually pull off your ice

448
00:28:18,990 --> 00:28:24,779
no problem

449
00:28:24,779 --> 00:28:31,779
its it's very very bad

450
00:28:32,269 --> 00:28:36,570
but the problem is not I can do this
because I want

451
00:28:36,570 --> 00:28:40,690
all to the real problem is anybody can
do this

452
00:28:40,690 --> 00:28:43,909
I mean have a look at this protocol for
five minutes

453
00:28:43,909 --> 00:28:47,639
have already deciphered the crypto
crypto

454
00:28:47,639 --> 00:28:51,590
okay maybe few guys did it

455
00:28:51,590 --> 00:28:55,769
take more time ido that's not gonna b
day

456
00:28:55,769 --> 00:28:59,840
I know it's not going to be days the
stuff is bad

457
00:28:59,840 --> 00:29:03,350
has agreed to be broken it has to be
fixed

458
00:29:03,350 --> 00:29:09,469
it really has to be fixed

459
00:29:09,469 --> 00:29:13,149
then there's the other protocol the

460
00:29:13,149 --> 00:29:16,269
this is the brunch organization of

461
00:29:16,269 --> 00:29:20,489
all Dutch alarm institutes in the
Netherlands thereof

462
00:29:20,489 --> 00:29:27,489
United a and they have designed a row
protocol this because from 1986 1987 I

463
00:29:28,499 --> 00:29:28,929
think

464
00:29:28,929 --> 00:29:32,079
a basically what they do

465
00:29:32,079 --> 00:29:36,629
if they send out the ours a public key
of the large receive center 280

466
00:29:36,629 --> 00:29:40,539
the dialer

467
00:29:40,539 --> 00:29:44,379
eighty then uses to public key

468
00:29:44,379 --> 00:29:48,279
to send out the as: 120

469
00:29:48,279 --> 00:29:53,239
session key then you have a secure
communication channel

470
00:29:53,239 --> 00:29:56,249
right space be secure

471
00:29:56,249 --> 00:29:59,529
well if they had done it right

472
00:29:59,529 --> 00:30:02,779
you would have a secure communication
channel if

473
00:30:02,779 --> 00:30:06,059
day for didn't forget about this thing
called secure cryptographic

474
00:30:06,059 --> 00:30:09,299
batting which a lot going to too deeply

475
00:30:09,299 --> 00:30:12,589
if you don't mind but I can be secure

476
00:30:12,589 --> 00:30:16,609
no all there's a secure channel sure

477
00:30:16,609 --> 00:30:20,399
but who are you talking to you just
don't know

478
00:30:20,399 --> 00:30:23,649
because you not storing the public key
and you can get a different public key

479
00:30:23,649 --> 00:30:24,469
for every session

480
00:30:24,469 --> 00:30:29,129
you cannot start a public key so you
don't know who you're talking to

481
00:30:29,129 --> 00:30:36,129
and again that has a strong implications

482
00:30:38,020 --> 00:30:42,230
well

483
00:30:42,230 --> 00:30:46,970
yep there's no identity verification in
this protocol and get

484
00:30:46,970 --> 00:30:50,620
again they could have done this I mean
there were using are as a

485
00:30:50,620 --> 00:30:53,820
they could have done this just order
publickey

486
00:30:53,820 --> 00:30:57,190
let the other guy send out their public
key let them sign something

487
00:30:57,190 --> 00:31:04,190
and you know at least we're talking to
that's what I sell dust

488
00:31:06,529 --> 00:31:09,279
problem now is we can to a man in the
middle attack

489
00:31:09,279 --> 00:31:13,059
on this for a call because well

490
00:31:13,059 --> 00:31:16,240
we can just get in between senator a
public a

491
00:31:16,240 --> 00:31:19,450
will have special to the to the dialer

492
00:31:19,450 --> 00:31:25,520
sure no problem but we can also send
false alarms from anywhere because

493
00:31:25,520 --> 00:31:29,100
that entity of the diners not verified
anywhere

494
00:31:29,100 --> 00:31:32,230
at all again same problem

495
00:31:32,230 --> 00:31:36,700
the

496
00:31:36,700 --> 00:31:41,510
particles basically set up that it
trusts the messages

497
00:31:41,510 --> 00:31:47,200
that it perceives they were using in
secure cryptographic padding

498
00:31:47,200 --> 00:31:51,260
I don't know if you're familiar with
this okay

499
00:31:51,260 --> 00:31:56,549
a if you're using cars a you can only
use

500
00:31:56,549 --> 00:31:59,590
a 41 before her say will

501
00:31:59,590 --> 00:32:03,380
a thousand 24 you can

502
00:32:03,380 --> 00:32:07,049
securely encrypt 117 bytes

503
00:32:07,049 --> 00:32:10,970
but you have to have the rest but secure
cryptographic banning if you're using

504
00:32:10,970 --> 00:32:15,159
the first few bites they're not around
them enough it's a Modelo crypto

505
00:32:15,159 --> 00:32:19,350
meaning that um in the original spec

506
00:32:19,350 --> 00:32:22,950
they were using the first byte has
actually something significant

507
00:32:22,950 --> 00:32:27,570
but you can't because you always the car
lose that bites because

508
00:32:27,570 --> 00:32:31,320
the first bites in the key is going to
be

509
00:32:31,320 --> 00:32:35,789
a about that the top

510
00:32:35,789 --> 00:32:41,970
for the entire protocol a

511
00:32:41,970 --> 00:32:45,440
a it's basically just a division by the
key

512
00:32:45,440 --> 00:32:49,340
sort of so it cannot be higher than the
key

513
00:32:49,340 --> 00:32:52,910
on the first bite but if you're going to
use this for something significant

514
00:32:52,910 --> 00:32:56,640
well they're gonna lose data you gonna
have to

515
00:32:56,640 --> 00:33:00,530
bat this quick random numbers they
didn't

516
00:33:00,530 --> 00:33:03,890
so the implication of this is also that

517
00:33:03,890 --> 00:33:07,610
we can do a chosen ciphertext attack
I'll

518
00:33:07,610 --> 00:33:10,740
for sell out shows a cipher tax we can
actually

519
00:33:10,740 --> 00:33:14,730
gets the key or at least get to contest
the messages

520
00:33:14,730 --> 00:33:17,910
because well sorry

521
00:33:17,910 --> 00:33:22,809
you're not using ours a the way it's
supposed to doesn't work that way

522
00:33:22,809 --> 00:33:26,530
and there's also no 42 percy the could
have done this

523
00:33:26,530 --> 00:33:30,400
easily just like adding a layer of
defeat hellman but

524
00:33:30,400 --> 00:33:35,049
you know if I have the private key I
can't equip the entire defense history

525
00:33:35,049 --> 00:33:38,100
again it's pretty bad

526
00:33:38,100 --> 00:33:42,340
same here we can do a fire sale

527
00:33:42,340 --> 00:33:46,419
the only real difference here

528
00:33:46,419 --> 00:33:49,840
his that my source IP is traceable

529
00:33:49,840 --> 00:33:52,940
because there's actually a session the
session is not

530
00:33:52,940 --> 00:33:56,299
predictable so if I have to attack
anything using

531
00:33:56,299 --> 00:33:59,380
disparate call I would either give up my

532
00:33:59,380 --> 00:34:02,990
source IP or produce an unlimited
network act or

533
00:34:02,990 --> 00:34:06,160
to attack this I mean it's not a problem

534
00:34:06,160 --> 00:34:09,639
I can do this it's just a little bit
more

535
00:34:09,639 --> 00:34:12,960
difficult not impossible at all

536
00:34:12,960 --> 00:34:19,960
it's a very real threat so what happened

537
00:34:21,150 --> 00:34:24,320
I reported this problem in CHS

538
00:34:24,320 --> 00:34:27,650
in said August 2012 12 Tronix

539
00:34:27,650 --> 00:34:31,700
I got no response but

540
00:34:31,700 --> 00:34:34,700
I don't have really time to follow it up
so

541
00:34:34,700 --> 00:34:40,040
but I did have time to a to another park
August that's fun

542
00:34:40,040 --> 00:34:43,510
a I reported that a Sept

543
00:34:43,510 --> 00:34:48,980
I got no response just about three weeks
later we did a small-scale publication

544
00:34:48,980 --> 00:34:51,400
attack in the relevant when he sits on a
Dell data box

545
00:34:51,400 --> 00:34:55,310
a I was actually to talk a

546
00:34:55,310 --> 00:34:59,230
refer to earlier where we actually just
did cracked this protocol

547
00:34:59,230 --> 00:35:02,970
life on stage um

548
00:35:02,970 --> 00:35:09,210
that actually help interesting

549
00:35:09,210 --> 00:35:12,140
through okay

550
00:35:12,140 --> 00:35:17,990
I feel like to what's going on here yeah

551
00:35:17,990 --> 00:35:22,230
think it's a problem at great

552
00:35:22,230 --> 00:35:26,430
her interesting um

553
00:35:26,430 --> 00:35:30,480
then in January 2013 I started asking
the Dutch

554
00:35:30,480 --> 00:35:33,650
National Center its national
cybersecurity center for help

555
00:35:33,650 --> 00:35:37,120
and they actually have assigned a
coordinator for this

556
00:35:37,120 --> 00:35:40,950
to coordinate with all the branches of
the alarm

557
00:35:40,950 --> 00:35:44,830
industry the security industry to help
coordinate this

558
00:35:44,830 --> 00:35:50,770
and um what the first response was from
of attorney says

559
00:35:50,770 --> 00:35:54,690
could you please remove your publication
I'm sorry

560
00:35:54,690 --> 00:36:00,970
i cant it was out of my hands at that
time

561
00:36:00,970 --> 00:36:04,370
a fabled and a9 which is actually

562
00:36:04,370 --> 00:36:08,340
a nice actually the 10 designed a
protocol for for fable

563
00:36:08,340 --> 00:36:13,010
they responded well actually hired a
security company because they realized

564
00:36:13,010 --> 00:36:13,430
that

565
00:36:13,430 --> 00:36:18,140
a der Electronics Engineers cannot
designed a security protocol

566
00:36:18,140 --> 00:36:22,250
the higher to secure certified secure to
do an assessment

567
00:36:22,250 --> 00:36:26,220
force ass ment of the protocol they
basically came up with the same thing

568
00:36:26,220 --> 00:36:29,520
had already told them so that was good
for them the hat

569
00:36:29,520 --> 00:36:34,150
to sources verifying the same thing the
heart pine security to

570
00:36:34,150 --> 00:36:38,680
help fix protocol there's actually a new
version of the protocol fell below

571
00:36:38,680 --> 00:36:43,200
so could house that's good Cairo on

572
00:36:43,200 --> 00:36:46,240
actually called me later and a

573
00:36:46,240 --> 00:36:49,990
they told me a they offered me

574
00:36:49,990 --> 00:36:55,190
a fully configured I receive Center 28
my testing of their protocol

575
00:36:55,190 --> 00:36:59,570
which is really helpful thank you I'm

576
00:36:59,570 --> 00:37:03,220
but now there still is a problem

577
00:37:03,220 --> 00:37:06,740
there are thousands

578
00:37:06,740 --> 00:37:10,750
tens of thousands ove and secure devices
out there

579
00:37:10,750 --> 00:37:13,920
most of them get maintenance

580
00:37:13,920 --> 00:37:18,320
once a year because their boxes starts
it

581
00:37:18,320 --> 00:37:21,940
in the I'll in the buildings

582
00:37:21,940 --> 00:37:26,300
all the customers so they have to go
drive

583
00:37:26,300 --> 00:37:30,230
in a car to every customer to update the
firmware to load the new protocols

584
00:37:30,230 --> 00:37:34,550
but the main problem with this protocol
as long as its naval

585
00:37:34,550 --> 00:37:38,510
I can send the false alarms on the
receive centers

586
00:37:38,510 --> 00:37:44,080
snow problem I can do this

587
00:37:44,080 --> 00:37:47,980
so until the very last one of their
customers dispatched

588
00:37:47,980 --> 00:37:52,660
the protocol has to be enabled so this
is still

589
00:37:52,660 --> 00:37:56,460
a real threat anybody

590
00:37:56,460 --> 00:38:01,750
can send out these alarms

591
00:38:01,750 --> 00:38:07,660
yep how are they going to fix this well
they're gonna have to upgrade or for

592
00:38:07,660 --> 00:38:08,250
worse

593
00:38:08,250 --> 00:38:11,829
everywhere I receive centers have to go
first

594
00:38:11,829 --> 00:38:16,180
and then all the customers that's going
to be done in the next few months

595
00:38:16,180 --> 00:38:19,589
Indian tyre Netherlands just to fix this

596
00:38:19,589 --> 00:38:23,380
in the meantime take could

597
00:38:23,380 --> 00:38:28,770
have two separate systems one for secure
protocols or not known broken protocols

598
00:38:28,770 --> 00:38:33,839
a to isolate them from the a secure
protocols

599
00:38:33,839 --> 00:38:36,900
so if you have an attack

600
00:38:36,900 --> 00:38:39,940
one of the systems goes haywire the
other one still

601
00:38:39,940 --> 00:38:45,339
has sort of reasonably trusted data
because you can't trust the data anymore

602
00:38:45,339 --> 00:38:48,630
the Kansas the data they're getting at
all

603
00:38:48,630 --> 00:38:54,860
that's all wrong

604
00:38:54,860 --> 00:38:57,580
CF a my coat and get up

605
00:38:57,580 --> 00:39:01,780
you can love check out the alarm
receiving police station

606
00:39:01,780 --> 00:39:06,700
a if you have stacks a lot of particles

607
00:39:06,700 --> 00:39:09,880
give it to me I am very interested

608
00:39:09,880 --> 00:39:13,240
a I also have some specs of my own

609
00:39:13,240 --> 00:39:17,560
such a little particles if you want them
I can give them to you a

610
00:39:17,560 --> 00:39:21,540
but if any one of you has a dialer which
have not mentioned

611
00:39:21,540 --> 00:39:25,120
very interested in reverse engineering
as well because

612
00:39:25,120 --> 00:39:32,060
to stuff really has to be fixed

613
00:39:32,060 --> 00:39:36,690
so thank you um check out some of the
other products working on

614
00:39:36,690 --> 00:39:43,690
a and are there any questions

615
00:39:50,490 --> 00:39:54,500
no it's not on yet

616
00:39:54,500 --> 00:39:58,109
chance at have you had a chance to look
at the updated version of the second

617
00:39:58,109 --> 00:39:58,390
thing

618
00:39:58,390 --> 00:40:02,920
I have a look at the a great for him and
it's actually looking pretty good

619
00:40:02,920 --> 00:40:07,410
a their fixed all the for abilities that
I could see

620
00:40:07,410 --> 00:40:10,849
a on cats David

621
00:40:10,849 --> 00:40:16,980
they've actually done a good job i'ma I
don't think unqualified to cracked that

622
00:40:16,980 --> 00:40:23,980
so it's good

623
00:40:28,969 --> 00:40:31,939
I I was kinda wondering thats you
mentioned the steps

624
00:40:31,939 --> 00:40:35,499
very simple X or up attack a

625
00:40:35,499 --> 00:40:39,400
wits with two numbers and are these
numbers always the same for a free

626
00:40:39,400 --> 00:40:43,079
to points between clients and sensor

627
00:40:43,079 --> 00:40:46,400
or is terribly some dynamic behavior a

628
00:40:46,400 --> 00:40:49,429
yeah I used to think so

629
00:40:49,429 --> 00:40:52,959
when I get my first presentation I
thought this was fixed

630
00:40:52,959 --> 00:40:56,699
um but then I look at look at the
firmware

631
00:40:56,699 --> 00:41:00,819
actually saw that there's a look at
table for every packet

632
00:41:00,819 --> 00:41:04,039
it gets locked up something in the
header

633
00:41:04,039 --> 00:41:08,439
that triggers it and the ciphers
actually

634
00:41:08,439 --> 00:41:11,640
a a rotating

635
00:41:11,640 --> 00:41:14,660
cipher based on psalm value

636
00:41:14,660 --> 00:41:18,479
that set in the first 4 bytes have or
cheetah a

637
00:41:18,479 --> 00:41:22,469
fourth to six by so I think in the
protocol

638
00:41:22,469 --> 00:41:26,199
pop its hard coat in the firmware both
on the

639
00:41:26,199 --> 00:41:29,640
I receive center side as on the ATT site
so yes

640
00:41:29,640 --> 00:41:34,469
in real deployments I've only seen these
two numbers but I know they can be other

641
00:41:34,469 --> 00:41:38,429
numbers but I mean it would be very very
easy to crack

642
00:41:38,429 --> 00:41:42,529
just do a statistical analysis or just
look at the back and just

643
00:41:42,529 --> 00:41:49,529
falls apart so yeah

644
00:41:53,440 --> 00:41:56,609
what is it what is that the time between
and

645
00:41:56,609 --> 00:42:00,099
authenticating yourself to TN IRC sale

646
00:42:00,099 --> 00:42:03,780
if you say I would say yes I am at this
alarm system

647
00:42:03,780 --> 00:42:07,619
right after that the real arm system
would say

648
00:42:07,619 --> 00:42:10,940
with the I O Si think that noted the
alarm

649
00:42:10,940 --> 00:42:15,849
sandalwood think that I am deal on
system are how do they

650
00:42:15,849 --> 00:42:20,549
and sale you don't you don't actually
have to

651
00:42:20,549 --> 00:42:23,859
the time is not even relevant I mean

652
00:42:23,859 --> 00:42:27,400
a you can just trigger alarm anyway

653
00:42:27,400 --> 00:42:30,849
or subpoena restore anyway but

654
00:42:30,849 --> 00:42:34,559
but not triggering the triggering the
alarm just because it authenticates as

655
00:42:34,559 --> 00:42:34,960
well

656
00:42:34,960 --> 00:42:37,970
it's a CS I'm here I'm I'm fine I
presume

657
00:42:37,970 --> 00:42:41,089
I am no it does not indicate

658
00:42:41,089 --> 00:42:44,380
well it sets up a session but it does
not really authenticate

659
00:42:44,380 --> 00:42:47,890
so you can just create another session

660
00:42:47,890 --> 00:42:51,990
and send out a different back at the
time is 9 for relevant

661
00:42:51,990 --> 00:42:55,760
and what is the like spend opposition

662
00:42:55,760 --> 00:42:59,670
um that various it's not to find

663
00:42:59,670 --> 00:43:03,240
looking so until the firmware is
rebooted

664
00:43:03,240 --> 00:43:06,980
or whatever it's not defined and the

665
00:43:06,980 --> 00:43:10,990
does the alarm central keep the gives
the old session open

666
00:43:10,990 --> 00:43:14,059
when when I start a new session from 10

667
00:43:14,059 --> 00:43:18,230
another device does keep the old such an
open okay this is all you to keep based

668
00:43:18,230 --> 00:43:21,710
so it's not actually a session as such

669
00:43:21,710 --> 00:43:24,799
um there's a handshake and the beginning

670
00:43:24,799 --> 00:43:28,450
of when that defies boots after that
it's just

671
00:43:28,450 --> 00:43:31,450
matter for sending the alarms for you P
so

672
00:43:31,450 --> 00:43:36,710
no it's not timing is not an issue

673
00:43:36,710 --> 00:43:41,579
or anything just you can you can send
anything okay at

674
00:43:41,579 --> 00:43:48,579
thank you

675
00:43:49,240 --> 00:43:51,670
you said you had a Lucas move the
firmware

676
00:43:51,670 --> 00:43:55,260
for these dollars I'm fistful how to get
the firmware

677
00:43:55,260 --> 00:43:58,320
a second of all if you have literally
exploits in the Commons

678
00:43:58,320 --> 00:44:02,710
um I got for mostly by pressing the

679
00:44:02,710 --> 00:44:06,880
a great for more buttons on the device
and just capturing the traffic

680
00:44:06,880 --> 00:44:11,630
because that's another problem I haven't
even mentioned this

681
00:44:11,630 --> 00:44:14,750
um when you press update

682
00:44:14,750 --> 00:44:18,940
it will just call contact a fixed IP
address to get the update

683
00:44:18,940 --> 00:44:23,020
it doesn't is over and secure protocol
it's not signed

684
00:44:23,020 --> 00:44:27,360
if you want to have your own code in
there

685
00:44:27,360 --> 00:44:30,390
is hijacked that specific IP

686
00:44:30,390 --> 00:44:35,620
and send out force for worse yeah only
problem is you have to manually

687
00:44:35,620 --> 00:44:39,410
pressler update from about on the device
but

688
00:44:39,410 --> 00:44:42,540
that's how I got them just by capturing
in

689
00:44:42,540 --> 00:44:45,750
Wireshark and just saving the entire
dialogue

690
00:44:45,750 --> 00:44:52,750
and cropping out what's not relevant

691
00:44:56,490 --> 00:45:01,570
questions Oct

692
00:45:01,570 --> 00:45:05,600
excellent research really cool I'm and
we mention just a bit about the

693
00:45:05,600 --> 00:45:07,140
disclosure

694
00:45:07,140 --> 00:45:12,060
parse them p11 re just a bit more I was
a response were Diaz town 2d

695
00:45:12,060 --> 00:45:15,410
a couple questions for you or was it
simply just accept your

696
00:45:15,410 --> 00:45:18,450
findings and I think you do was it um

697
00:45:18,450 --> 00:45:22,930
it was a bit mixed a because it's
actually cheaper recalls

698
00:45:22,930 --> 00:45:26,850
house orders two parties evolve X were
there's more party

699
00:45:26,850 --> 00:45:31,560
parties involved so um with some of them
I get the vibe that they were being

700
00:45:31,560 --> 00:45:32,350
annoyed

701
00:45:32,350 --> 00:45:37,100
a so why do we have to fix this and is
everything broken anyway

702
00:45:37,100 --> 00:45:40,770
um yeah a

703
00:45:40,770 --> 00:45:44,150
not the proper response actually feeble
a

704
00:45:44,150 --> 00:45:48,290
hand a night just we're very happy to
accommodate this hand

705
00:45:48,290 --> 00:45:51,580
actually from their point of view was
okay forget

706
00:45:51,580 --> 00:45:55,910
now we can actually reviewed protocols
that we have in place for this

707
00:45:55,910 --> 00:45:59,880
because apparently there's no protocol
in place for

708
00:45:59,880 --> 00:46:02,960
security incidents have the security
companies

709
00:46:02,960 --> 00:46:06,670
yeah so there were like

710
00:46:06,670 --> 00:46:11,240
I'll actually yeah good point we have to
implement these these particles

711
00:46:11,240 --> 00:46:14,990
and they were actually very happy that I
reported them um

712
00:46:14,990 --> 00:46:21,990
and not just started exploiting them
because I could have done that

713
00:46:23,950 --> 00:46:27,309
anyone else have any questions into

714
00:46:27,309 --> 00:46:29,940
alright well thank you very much welcome

