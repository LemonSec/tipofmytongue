1
00:00:00,000 --> 00:00:18,330
hello everyone my happy to be here in
singapore and my talk about it talk

2
00:00:18,330 --> 00:00:25,349
about summer seen about a medias tekrar
proper form and let me introduce myself

3
00:00:25,350 --> 00:00:32,850
I'm member of the trend micro 30
discovered him i got ranked one of

4
00:00:32,850 --> 00:00:39,000
Google Android we RP last year and I
also discovered some zero-day attacks in

5
00:00:39,000 --> 00:00:47,039
the weather in $MONTH 2015 my research
interests are enjoyed flash player OS X

6
00:00:47,039 --> 00:00:58,739
and iOS attacker I is a system-on-chip
serious developed by and video for

7
00:00:58,739 --> 00:01:07,350
mobile device media allows that terrible
forms are the world's fastest mobile

8
00:01:07,350 --> 00:01:15,960
processes that many is not device using
technical platform like google nexus

9
00:01:15,960 --> 00:01:24,059
nigh to go pick some sea and the
Chromebooks and there are also many car

10
00:01:24,060 --> 00:01:31,890
brands you use the integra platform like
a Tesla rolls-royce bentley and BMW so

11
00:01:31,890 --> 00:01:38,909
separate platforms security quality had
why they impact our daily lives funding

12
00:01:38,909 --> 00:01:50,310
and patching deGrasse inability it was
to do i only had one nexus 9 my handle

13
00:01:50,310 --> 00:01:58,979
where I began to do research on the
grappler form google nexus 9 is released

14
00:01:58,979 --> 00:02:04,079
were released on $MONTH november two
thousand the 40 it is a tablet to

15
00:02:04,079 --> 00:02:11,160
co-developer by HTC and Google and now

16
00:02:11,160 --> 00:02:18,030
that's nice using tech rock a one
platform iphone some kind of more bags

17
00:02:18,030 --> 00:02:27,750
of it and your exploits for this box so
i will reduce some of these facts and

18
00:02:27,750 --> 00:02:38,190
why interesting export i find this
bastard i could audit you can download

19
00:02:38,190 --> 00:02:41,190
and the . econo of Nexus device

20
00:02:42,090 --> 00:02:51,030
google has a very good guy before you
can add your feedback information into

21
00:02:51,030 --> 00:02:55,170
the common source and the period of your
own tobacco no image

22
00:02:55,170 --> 00:03:04,890
personally I like youth suicide as a
cody the tool you really you can order

23
00:03:04,890 --> 00:03:11,250
the code from attack surface to the
corner there are some typical attack

24
00:03:11,250 --> 00:03:24,120
surface such as device knows and CFS
prop FS and the system called when you

25
00:03:24,120 --> 00:03:30,090
find the suspicious bastard you can
construct a POC and the use your own

26
00:03:30,090 --> 00:03:36,120
deepak economy due to the back of the pc
you can get the condo panic information

27
00:03:36,120 --> 00:03:49,410
under this photo data system dropbox and
there are some back examples iphone the

28
00:03:49,410 --> 00:03:56,670
first one it seen driver and we host to
control we're handling while

29
00:03:56,670 --> 00:04:07,799
control/command we can see that this
tower can be exist by any other and in

30
00:04:07,800 --> 00:04:15,810
the source code today the integral flow
when Kayla ababa the lumber officers and

31
00:04:15,810 --> 00:04:21,060
the peroxide I input in from user US
base

32
00:04:22,620 --> 00:04:29,370
automatic the multiplication can cause
the integral flow and the integra floor

33
00:04:29,370 --> 00:04:35,820
we are called we're called cream milk to
allocate a smaller bother then we want

34
00:04:35,820 --> 00:04:48,870
see the second example it easy in driver
and we hosted TPU we're handling while

35
00:04:48,870 --> 00:04:57,360
control/command just driver also can be
accessed by anyone you can see the code

36
00:04:57,360 --> 00:05:08,220
to oculus offset the code doesn't the
chapter is offset so you if we can put a

37
00:05:08,220 --> 00:05:20,580
data value to the member set we are
right 6502 are no address but you for we

38
00:05:20,580 --> 00:05:21,359
can

39
00:05:21,360 --> 00:05:30,780
Lichter way to address well your way we
can write 6502 where 2n 2n control the

40
00:05:30,780 --> 00:05:43,710
color address this valley in the camera
driver camera driver can be accessed in

41
00:05:43,710 --> 00:05:50,130
the media server process it didn't need
a privilege media or camera

42
00:05:51,870 --> 00:05:59,490
this package is a this condition back
you can see this loss we're handling one

43
00:05:59,490 --> 00:06:05,160
could I'll control mount the mutex the
scope of the mutants in other we're good

44
00:06:05,160 --> 00:06:12,630
the lock that in the protect the camera
remove device so you can call us out

45
00:06:12,630 --> 00:06:20,400
free allow me to do some other way

46
00:06:20,400 --> 00:06:27,239
advertisement for google google study
the enjoy the inability rewards program

47
00:06:27,240 --> 00:06:35,969
at two jus 2015 it now rewards 64 peeps
Nexus device

48
00:06:36,470 --> 00:06:46,190
and we were the backs of 64 Peter Nexus
device taking just three backs about for

49
00:06:46,190 --> 00:06:52,940
example you can get 40 40 southern the
US dollars if you are the first reporter

50
00:06:52,940 --> 00:06:56,990
and there's some heated three beauty
part 6 points

51
00:06:58,070 --> 00:07:08,900
ok now i will try to exploit the first
back then take your flow back

52
00:07:10,070 --> 00:07:18,620
so what we we get after fest grounds so
so wonderful family either to read and

53
00:07:18,620 --> 00:07:25,760
write and model register and each time
you're you're really right to register

54
00:07:25,760 --> 00:07:33,710
you can specify while offset and
seconded to operate to the agarose block

55
00:07:33,710 --> 00:07:41,150
side is that is the basic account to
operate you should know that Bo where

56
00:07:41,150 --> 00:07:52,280
people barrier to avoid the crash but if
you want to overflowed to the magical

57
00:07:52,280 --> 00:08:03,679
multiplication the lumber offset that
must be a very big value so let's check

58
00:08:03,680 --> 00:08:10,580
that the color deeply when the obvious
right shoot because we know a curiously

59
00:08:10,580 --> 00:08:15,590
that you control you can you can you can
we control the bass in your space so we

60
00:08:15,590 --> 00:08:23,000
can sit a cure to choose to stay the
execution at this place means it will

61
00:08:23,000 --> 00:08:28,340
write to register so they execution
flowing like these

62
00:08:28,970 --> 00:08:39,650
k milk at a battle and copy from user
have to fear the buffer then enter into

63
00:08:39,650 --> 00:08:42,650
a while loop

64
00:08:44,159 --> 00:08:53,189
each time reader and offset from us
bases by calling getting de rigueur

65
00:08:53,190 --> 00:09:01,589
offset and then culture and we host
right and more your rags to write the

66
00:09:01,589 --> 00:09:04,589
perfect content to the register

67
00:09:05,430 --> 00:09:12,540
well we're riding you can do it you can
specify an officer readout from user

68
00:09:12,540 --> 00:09:18,839
base and the three remaining remaining
in the oxide so the peroxide is the

69
00:09:18,839 --> 00:09:32,519
country so we can set block side 24
means you can write for bias to register

70
00:09:32,519 --> 00:09:41,129
just so number of said that shouldn't be
a normal value because we don't want a

71
00:09:41,129 --> 00:09:49,649
check for flow when we're ready to
register at this is the function rather

72
00:09:49,649 --> 00:09:57,899
to register say thanks kitchen floor is
this the first wedding date

73
00:09:57,899 --> 00:10:07,050
very good read to arrogate to input
offset and the bank account to write you

74
00:10:07,050 --> 00:10:14,219
for the offset and the county is very
are already did it turn right so well

75
00:10:14,220 --> 00:10:26,519
use to the rec register so well you see
the from the King malkova when the

76
00:10:26,519 --> 00:10:35,490
oculus readies force they say that
another branch as s branch excluding

77
00:10:35,490 --> 00:10:44,279
follow either similar with Argus writing
the true in the while loops we get an

78
00:10:44,279 --> 00:10:51,180
offset from user space by calling
getting older and then and then call and

79
00:10:51,180 --> 00:10:57,040
we host to read and model register to
read the from register

80
00:10:57,040 --> 00:11:03,459
and they're right so values to the
Cayman opava so in this branch we have

81
00:11:03,459 --> 00:11:05,199
we have a chance of tool

82
00:11:05,199 --> 00:11:13,660
alright a 10-minute baba so we can set
the blocks at process 24 means your time

83
00:11:13,660 --> 00:11:25,389
reading 4 bytes from register and arise
them to Kim malkova I this animal lumber

84
00:11:25,389 --> 00:11:31,569
officers for the beer we're big value
because we want to make the internal

85
00:11:31,569 --> 00:11:39,430
flow by intel core flow in my luck we
allocate a smaller bottle to be alright

86
00:11:39,430 --> 00:11:44,199
so you people equal number of assets

87
00:11:44,199 --> 00:11:49,269
either way bigger bigger value as the
well look in the kodo where be a huge

88
00:11:49,269 --> 00:11:57,610
loop almost infinite you can see why are
offset so if number of silver peak value

89
00:11:57,610 --> 00:12:07,510
to while local use it is almost an
inference see the river from function of

90
00:12:07,510 --> 00:12:13,060
a real reform register and we host read
more radius we can said that big

91
00:12:13,060 --> 00:12:19,719
excluding flow isn't a similar with the
right where did the register but rather

92
00:12:19,720 --> 00:12:27,459
than offset an account first if with the
offset + icon are worried then read from

93
00:12:27,459 --> 00:12:31,268
the register and the right to the papa

94
00:12:31,269 --> 00:12:42,819
so we master solid to u infinity loop
problem if we want to all right to keep

95
00:12:42,819 --> 00:12:48,639
me locked after we can take a look at
their way that are red ready to record

96
00:12:48,639 --> 00:12:53,199
for machine you know already the
direction between you too weird

97
00:12:53,199 --> 00:13:03,310
check the offset and count RP good then
resource size or not and it will also

98
00:13:03,310 --> 00:13:09,969
check it was the officer and the count
will cause an integral flow or not

99
00:13:10,480 --> 00:13:19,269
so if we said offset either sets off the
toy very big value you can we are called

100
00:13:19,269 --> 00:13:25,839
the to check fear and anger will return
error when when when did record and

101
00:13:25,839 --> 00:13:33,910
error we can see that the model
recklessly we returned error and the

102
00:13:33,910 --> 00:13:40,420
while loop so and we hosted read the
morning registration error and the free

103
00:13:40,420 --> 00:13:46,449
that came out of bathroom and read error
so well look we breaks while loop so

104
00:13:46,449 --> 00:13:53,529
after we all right to come into battle
we can set one where one peak value to

105
00:13:53,529 --> 00:14:01,029
the offset and it will get a user ghetto
ppl offset from US base and the passing

106
00:14:01,029 --> 00:14:07,510
pass it pass it over to your host to
read more model reckless and then break

107
00:14:07,510 --> 00:14:13,029
the while loop so this message that we
are all over the infinite little problem

108
00:14:13,029 --> 00:14:26,110
so now shorty is summarize what we have
we helped an integer overflow back at

109
00:14:26,110 --> 00:14:34,000
this integral of about can continue to
hip bath all right and keep buffer size

110
00:14:34,000 --> 00:14:40,389
we can control the hip bar side because
we can control the politicizing

111
00:14:40,389 --> 00:14:46,720
multiplied the number of sets a week we
also can control the hip Papa or red

112
00:14:46,720 --> 00:14:56,440
angus because we can control the offset
you can see we set the clocks had 24 and

113
00:14:56,440 --> 00:15:03,069
uttam alright four bytes and asset happy
go after to break so we can we can enjoy

114
00:15:03,069 --> 00:15:14,229
the already next the two already
contention we may have a chance to

115
00:15:14,230 --> 00:15:19,990
control because we can ride two values
to the register first and the readout

116
00:15:19,990 --> 00:15:23,270
from meat but we need to a one

117
00:15:23,270 --> 00:15:32,090
is experiment so i do this i read many
magical number to register and the

118
00:15:32,090 --> 00:15:39,860
reason out and to do this operation
several times and what I found you

119
00:15:39,860 --> 00:15:47,690
what iphone r- to memory out the memory
out without a problem register is in the

120
00:15:47,690 --> 00:15:55,490
sandwich you have when you're you some
fixed offset is always zero well you're

121
00:15:55,490 --> 00:16:02,030
using some other fixed offset we've
always met remember we read to and when

122
00:16:02,030 --> 00:16:13,310
you're in other opposite is some random
warrior the memory out is like this we

123
00:16:13,310 --> 00:16:22,130
write natural number 22 the register and
they read out we want in some offset is

124
00:16:22,130 --> 00:16:28,460
always a magical on but we read and the
sum of says is always zero and other

125
00:16:28,460 --> 00:16:31,460
upset you some random murder

126
00:16:35,060 --> 00:16:41,569
so now what we have we have a hip bath
all right about keep a sudden we can

127
00:16:41,570 --> 00:16:44,600
control you can control your father
already thanks

128
00:16:44,600 --> 00:16:49,940
we also can control the already left
over either content that we can all

129
00:16:49,940 --> 00:16:57,620
write a four x 60 or 80 or four base
it's a magical number we can specify the

130
00:16:57,620 --> 00:16:58,490
magic number

131
00:16:58,490 --> 00:17:02,390
so what's the next

132
00:17:03,170 --> 00:17:17,450
alright what what object we should to
all right Sarah three choice our the

133
00:17:17,450 --> 00:17:25,610
first choice is the finishing point we
can overwrite function pointer to a for

134
00:17:25,609 --> 00:17:34,149
example a user space function . and if
we four are you following us

135
00:17:34,150 --> 00:17:43,180
nothing to beat Nexus device this is ok
because on 32-bit device SME p or p cha

136
00:17:43,180 --> 00:17:54,040
pxn is not enabled button to go next
night is a 66 64-bit you guys to SME pz

137
00:17:54,040 --> 00:17:57,520
neighborhood so season not a good choice

138
00:17:58,300 --> 00:18:01,300
the second choice

139
00:18:01,990 --> 00:18:13,360
it's a writer and object . but this just
object contain a function . just choices

140
00:18:13,360 --> 00:18:23,740
I is good to be good because sm AP is
not enabled the arm and even 64-bit next

141
00:18:23,740 --> 00:18:39,880
device but this choice need our p2r to
route because you count directly read or

142
00:18:39,880 --> 00:18:46,450
write the economy memory you need and
you need our p22 the reader and the

143
00:18:46,450 --> 00:18:56,650
right just did the last choice leader
the structures surrounding inform this

144
00:18:56,650 --> 00:19:05,020
is the best one because we know today
the address we meet feared in strapped

145
00:19:05,020 --> 00:19:12,129
thread info if it does adjust limiter is
aware peak value means that you the

146
00:19:12,130 --> 00:19:25,570
space can access common memory if we all
right addressed limited 2-1 to you the

147
00:19:25,570 --> 00:19:32,860
space thread can read and write
arbitrary common memory directly

148
00:19:33,520 --> 00:19:40,090
this is the best one because because
this choices doesn't need any RG

149
00:19:41,990 --> 00:19:54,860
so how to overwrite distract the threat
info city into the definition of the

150
00:19:54,860 --> 00:20:04,820
strategy involved and what we have what
we have is what we have now we can

151
00:20:04,820 --> 00:20:16,879
control the all right length so we can
only alright 16 bytes and then we can

152
00:20:16,880 --> 00:20:27,200
control the already content EG time four
bytes the file should be sterile or

153
00:20:27,200 --> 00:20:37,610
other specified number so we can
overwrite to flex their 220 and

154
00:20:37,610 --> 00:20:46,428
overwrite to adjust limited to minus law
we can achieve these bags that power

155
00:20:46,429 --> 00:20:59,540
back so you but if I want to all right
to threaten involved i want this kind of

156
00:20:59,540 --> 00:21:05,510
memory memory out i want the came
medical battle Justin in friend or in

157
00:21:05,510 --> 00:21:15,470
front of steps adapts really inform and
then we just over all right 16 bytes to

158
00:21:15,470 --> 00:21:24,110
craft to next step after you've struck
the surrounding oh so this is my my plan

159
00:21:24,110 --> 00:21:37,969
first I create man israel italy wheels
then we are supreme many abstract

160
00:21:37,970 --> 00:21:47,030
threading involved on the keep on the
corner hip and I've after threat create

161
00:21:47,030 --> 00:21:52,910
created i begin to free some of these
threat at the same time I

162
00:21:53,650 --> 00:22:00,730
I had another threat and asteroids
trigger the back to kingman opava and oh

163
00:22:00,730 --> 00:22:02,950
alright 16 bytes

164
00:22:02,950 --> 00:22:11,320
I'll talk to the bathroom first first 80
x 720 the second by second day by 72

165
00:22:11,320 --> 00:22:20,679
minus man as well as a chemical battle
we are occupied to free memory of one

166
00:22:20,680 --> 00:22:31,750
structure strategy involved after doing
this each each life threat isn't she

167
00:22:31,750 --> 00:22:37,600
live surrounded check if you can read
the column memory directly from

168
00:22:37,600 --> 00:22:49,419
userspace bye-bye-bye a trick for the
pipe to test we read from pack if it was

169
00:22:49,420 --> 00:22:55,330
red can read content can read a column
memory direct directly in usability user

170
00:22:55,330 --> 00:23:05,230
base means that we've refined the crafty
to threaten for because to this threat

171
00:23:05,230 --> 00:23:18,910
see the memory layout menu first to
leave I spree many instruct threatening

172
00:23:18,910 --> 00:23:31,660
for on the hip by creating many threat
and then i picking to exist you exist

173
00:23:31,660 --> 00:23:39,250
the Menace rest of your course some of
some some instructions very involved

174
00:23:39,250 --> 00:23:51,790
being free and at the same time I trick
the back to came milk 666 in que pasa to

175
00:23:51,790 --> 00:23:59,800
occupy one frayed struck the input and
then overwrite 16 bytes to the next

176
00:23:59,800 --> 00:24:03,250
structure is ready

177
00:24:05,530 --> 00:24:20,680
how can i assure the Occupy success
first day I Supreme big lumber of a

178
00:24:20,680 --> 00:24:28,600
strategy involved so sterling for which
which are located lately

179
00:24:29,140 --> 00:24:34,120
we're literally we're be continued
continuous because because we need it

180
00:24:34,120 --> 00:24:43,929
occupied the different occup our order
or almost all the hip memory so the

181
00:24:43,930 --> 00:24:52,180
strategy involved and locate the lady
will be continued continuous III only

182
00:24:52,180 --> 00:25:01,930
free few of them and the free direct
strappy reading for allocated lately and

183
00:25:01,930 --> 00:25:09,280
I I don't free continuous reading for
only one out of six continuous threat

184
00:25:09,280 --> 00:25:22,930
will be afraid we can check the
pseudocode this is the Dakota i spray

185
00:25:22,930 --> 00:25:29,980
the threading info you can see I used
piece rather created to create a many

186
00:25:29,980 --> 00:25:42,700
stress and I see the PID of each threat
yet in the tid irate after just search

187
00:25:42,700 --> 00:25:54,970
this thread created I not five each
threat to check it in need of free

188
00:25:54,970 --> 00:26:07,600
yourself or not so we can see this is a
serious threat each thread thread will

189
00:26:07,600 --> 00:26:14,679
check the tid by comparing the t idea
received and

190
00:26:16,950 --> 00:26:23,789
done we can see that the code check the
index of this rather is bigger than this

191
00:26:23,789 --> 00:26:28,889
threshold or not and only you

192
00:26:28,889 --> 00:26:44,879
Oh while top six will be afraid if the
thread so do your life up after a

193
00:26:44,880 --> 00:26:54,510
festive signal it will receive the
second signal from men set master at to

194
00:26:54,510 --> 00:27:01,950
check you either Karen read a Connor
address that directly by using reapplied

195
00:27:01,950 --> 00:27:12,360
if we really kind of memory is
successful then we get the crap teat

196
00:27:12,360 --> 00:27:24,629
threat which you can read and the right
column memory so if you even a really

197
00:27:24,630 --> 00:27:30,960
kind of success we call it a threat and
we can still read and write memory in

198
00:27:30,960 --> 00:27:47,010
this threat so finally we get to threat
which can read and write a column memory

199
00:27:47,010 --> 00:28:00,120
we can we can get the address of you
need a task and I scenics enforcing by

200
00:28:00,120 --> 00:28:09,479
analyzing the Condor image because the
reason and no ka asar our Nexus the

201
00:28:09,480 --> 00:28:22,260
device we research I such from uni tax
because every every every task every

202
00:28:22,260 --> 00:28:27,520
task is a link link into the United half
so I such from any you

203
00:28:27,520 --> 00:28:33,940
attacks you need a task to get a current
task by reading common memory from user

204
00:28:33,940 --> 00:28:44,410
space after after finding the current
task we can change is a creator of of

205
00:28:44,410 --> 00:28:50,980
contacts current house up before doing
this we need to disable the ceramics

206
00:28:50,980 --> 00:29:05,950
reinforcing so after after doing this
but we wrote to google nexus not so what

207
00:29:05,950 --> 00:29:14,470
about Tesla I don't have a tester to
test but I know that tests are using

208
00:29:14,470 --> 00:29:21,430
tech roster a platform where where i was
browsing is on the $DAY century . of

209
00:29:21,430 --> 00:29:28,480
terror plot platform you can use
something like ubuntu plus the grocery

210
00:29:28,480 --> 00:29:36,280
so I thought about that can find some
tech wrap up dropbox with the other car

211
00:29:36,280 --> 00:29:48,070
so i searched the grass three platform
and the form of that nexus silly is

212
00:29:48,070 --> 00:29:55,120
based on a grocery chat grocery also so
I don't know the second most common

213
00:29:55,120 --> 00:30:03,760
source code of the Nexus 7 and order the
Code construct POC and test on nexus 7

214
00:30:03,760 --> 00:30:11,470
then I report i reported the back this
box to test and got some reward is it

215
00:30:11,470 --> 00:30:19,780
this is it ok to demo

216
00:30:36,120 --> 00:30:42,090
you some help

217
00:30:42,960 --> 00:31:16,320
oh I check sees

218
00:31:52,999 --> 00:31:59,989
ok ok

219
00:32:51,900 --> 00:32:54,900
this is the demo

220
00:33:26,310 --> 00:33:43,980
because of that it is with some time to
spray the many many stress was

221
00:33:43,980 --> 00:34:01,770
successful and i would like to thank my
colleague ahead and head and shower and

222
00:34:01,770 --> 00:34:09,239
wish you which rule thank you very much
single and my presentation

