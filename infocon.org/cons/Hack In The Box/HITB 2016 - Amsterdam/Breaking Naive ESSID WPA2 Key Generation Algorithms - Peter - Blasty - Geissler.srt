1
00:00:14,560 --> 00:00:17,620
all rights welcome everybody

2
00:00:17,620 --> 00:00:24,369
I'm . Gosselaar and this is a stick as
we trust our I had an alternate title

3
00:00:24,369 --> 00:00:29,230
slide it was this but since i'm feeling
a bit ill and not feeling too jumpy

4
00:00:29,230 --> 00:00:30,040
today

5
00:00:30,040 --> 00:00:35,530
I didn't want to buy a gas with it so
before continue as you can probably

6
00:00:35,530 --> 00:00:42,220
notice my voice is in the best i think
this is not how much for normal yes we

7
00:00:42,220 --> 00:00:43,660
had lots of fun

8
00:00:43,660 --> 00:00:48,099
the past few days and this is why my
voice is messed up

9
00:00:48,910 --> 00:00:54,940
so please bear with me I hope we can
make to our you see me checking away I

10
00:00:54,940 --> 00:00:57,760
like saira or other things

11
00:00:57,760 --> 00:01:05,740
thats related to the face so before we
continue to do just a quick off outline

12
00:01:05,740 --> 00:01:07,689
of we're going about talking about to
that

13
00:01:07,689 --> 00:01:13,360
so I'm going to do a who what why the
typical thing we're going to be talking

14
00:01:13,360 --> 00:01:19,420
about a a target device that is
specifically our targets for well this

15
00:01:19,420 --> 00:01:20,619
presentation

16
00:01:20,619 --> 00:01:25,600
well the presentation is a result of
that device armed

17
00:01:25,600 --> 00:01:29,079
we're going to be talking a bit about
dynamic instrumentation

18
00:01:30,009 --> 00:01:35,409
yeah we're going to be talking about
dynamic instrumentation

19
00:01:35,409 --> 00:01:39,700
I would do it in the past and how we do
it nowadays using newer tools and we

20
00:01:39,700 --> 00:01:44,139
were methods of course there's going to
be some takeaways and some conclusive

21
00:01:44,139 --> 00:01:47,289
stuff i have some bonus material

22
00:01:47,830 --> 00:01:50,830
and of course there's room for Q&A at
the end

23
00:01:52,870 --> 00:01:58,510
so first of all why am i amazing already
said i'd done introduction I don't think

24
00:01:58,510 --> 00:02:03,610
that's one percent fair but i'm an
independent security researcher from the

25
00:02:03,610 --> 00:02:06,429
Netherlands are

26
00:02:06,430 --> 00:02:12,160
I did some stuff done in two weeks small
white box might have one in your living

27
00:02:12,160 --> 00:02:17,020
room maybe your kids have one if it's
capable of running copied games more I

28
00:02:17,020 --> 00:02:20,860
have nothing to do with that but the
groundwork for debt is something i did a

29
00:02:20,860 --> 00:02:24,610
long time ago I wrote a bunch of
exploits

30
00:02:24,610 --> 00:02:33,490
some bar some other stuff not yours you
can find them up on my webpage you are

31
00:02:33,490 --> 00:02:39,160
free to download free to use to come
with my license but I got some talks a

32
00:02:39,160 --> 00:02:40,870
lot of confidence

33
00:02:40,870 --> 00:02:43,959
why thank you for the sea

34
00:02:43,959 --> 00:02:48,700
Cheers most notably jack in the box of
course

35
00:02:48,700 --> 00:02:56,290
Oh age em in an ambulance t2 in Finland
armed and well people might know me from

36
00:02:56,890 --> 00:02:59,980
CTF stuff we play with iron bars and
team

37
00:03:00,580 --> 00:03:05,920
well by now we're a bunch of has-beens
but back in the days we used to rank

38
00:03:05,920 --> 00:03:09,250
fairly I we want a bunch of competition
so that was fun

39
00:03:09,250 --> 00:03:13,480
so today whatever going to be talking
about it be

40
00:03:13,480 --> 00:03:16,959
we gotta talk about default Wi-Fi
credentials

41
00:03:16,959 --> 00:03:23,440
yeah this is still offering in 2016 that
don't really know why but people get

42
00:03:23,440 --> 00:03:28,359
Wi-Fi capable boxes all the time and
they come with a nice sticker on the

43
00:03:28,360 --> 00:03:29,230
bottom

44
00:03:29,230 --> 00:03:34,299
let's take her as a bunch of default
credentials which you can use to connect

45
00:03:34,300 --> 00:03:39,519
to Wi-Fi and you think that most people
change in his credentials to some some

46
00:03:39,519 --> 00:03:45,400
custom credential but turns out many
people including myself i still use the

47
00:03:45,400 --> 00:03:46,900
default credentials from my mother

48
00:03:46,900 --> 00:03:53,080
I did until along well - I figured out
it was broken but they still use the

49
00:03:53,080 --> 00:03:57,130
default credentials so you'd be
surprised how useful are recovering

50
00:03:57,130 --> 00:04:00,190
default credentials is in order to break
to a Wi-Fi network

51
00:04:00,190 --> 00:04:06,880
we're also going to talk about dealing
with or what i like to call painful or

52
00:04:06,880 --> 00:04:13,240
alien code if you have an executable for
our windows or linux uh it's it's

53
00:04:13,240 --> 00:04:16,660
somewhat trivial to disassemble it and
make sense of it but if you have an

54
00:04:16,660 --> 00:04:21,580
executable for an a4a operating system
or running some with architecture or

55
00:04:21,579 --> 00:04:26,950
some some are you done half of it
becomes painful arm to deal with

56
00:04:28,120 --> 00:04:34,570
so again I about the what we're going to
be talking about i just mentioned be

57
00:04:34,570 --> 00:04:39,280
stickers right well last night I did a
Google image search

58
00:04:39,280 --> 00:04:46,210
I turned up a few of dots are if you
look at them some of them are was

59
00:04:46,210 --> 00:04:48,880
somewhat reasonable what i mean by first
look

60
00:04:48,880 --> 00:04:51,969
but for example the the clearspot one on
the right

61
00:04:51,970 --> 00:04:58,000
if you look at the SSID name and then
you look at the Wi-Fi password and

62
00:04:58,000 --> 00:05:03,490
there's some similarities there right at
that feels quite turkey arm

63
00:05:03,490 --> 00:05:07,330
yes so basically this is we're going to
be talking about today figuring out a

64
00:05:07,330 --> 00:05:10,900
way to recover that Wi-Fi password

65
00:05:12,100 --> 00:05:17,830
while in case of this defies just based
on the network name SSID essid issue

66
00:05:17,830 --> 00:05:20,770
said arm

67
00:05:20,770 --> 00:05:24,430
let's see is there anything older
interested in the screenshot

68
00:05:24,430 --> 00:05:27,700
I don't think so just just various ones
right just so you get the idea

69
00:05:28,390 --> 00:05:32,200
so of course there's been some prior
work by others

70
00:05:32,200 --> 00:05:39,880
I don't know if anyone ever use SD keys
here or all maybe a speedtouch modem but

71
00:05:39,880 --> 00:05:45,219
SD keys used to be a very popular
utility for breaking into speedtouch

72
00:05:45,220 --> 00:05:51,160
mobs it was released back in two
thousand eight of these types of attacks

73
00:05:51,160 --> 00:05:57,669
and this type of research has been going
on for a while and then more recently

74
00:05:58,930 --> 00:06:03,850
a bunch of guys from the rock bottom
University in the Netherlands

75
00:06:03,850 --> 00:06:08,110
well first of all they published the
paper and I think it was used next

76
00:06:08,110 --> 00:06:12,550
called scrutinizing wpa2 possible
generation algorithms in wireless

77
00:06:12,550 --> 00:06:16,930
routers which was a huge inspiration for
this work

78
00:06:17,770 --> 00:06:24,280
this paper is very fake in the sense
that they go broadly over out a ministry

79
00:06:24,280 --> 00:06:29,109
cover things but i do not give you the
specific magic numbers seeds

80
00:06:29,110 --> 00:06:34,810
implementations and algorithms so i
decided it might be fun to take their

81
00:06:34,810 --> 00:06:40,870
work as an inspiration and see if i can
actually implement one of these

82
00:06:40,870 --> 00:06:43,870
algorithms and see if we can recover
some password

83
00:06:45,510 --> 00:06:53,640
so our target for today is is my
internets cable modem I have at home

84
00:06:53,640 --> 00:07:02,490
actually a Technicolor 7200 used to be
but still very widespread modem one of

85
00:07:02,490 --> 00:07:06,870
the biggest good eyes peas you pea she
used to ship them to everyone in the

86
00:07:06,870 --> 00:07:13,260
Netherlands and this new pc is not just
a Dutch thing it's also not a part of

87
00:07:13,260 --> 00:07:19,560
europe germany switzerland that type of
stuff so this is one used to be very

88
00:07:19,560 --> 00:07:23,910
widespread couple years ago I recently
started replacing them with others

89
00:07:25,310 --> 00:07:29,210
it remains to be seen right adults
suffer from the same issues

90
00:07:30,020 --> 00:07:35,630
if you see it in advertisements it looks
kinda like this more awesome right

91
00:07:35,630 --> 00:07:43,219
green shit coming from the button nice
nice gradient arm but we're more

92
00:07:43,220 --> 00:07:47,960
interested in is this right interface
this thing you can see there's a course

93
00:07:47,960 --> 00:07:51,409
BNC connector on there to connect with
your cable network

94
00:07:51,410 --> 00:07:55,130
there's two plain or telephone system
ports in there

95
00:07:55,130 --> 00:07:57,870
to connect your your old landline fall
and

96
00:07:57,870 --> 00:08:03,270
connect them true voice over IP to the
internet then there's a bunch of

97
00:08:03,270 --> 00:08:08,969
ethernet ports for connecting various
computer in your local area network USB

98
00:08:08,970 --> 00:08:11,100
port

99
00:08:11,100 --> 00:08:16,500
I might talk a bit more about this later
but it's not really useful in most

100
00:08:16,500 --> 00:08:18,270
configurations

101
00:08:18,270 --> 00:08:23,520
uh yeah and then of course there's a
sticker right so that the bottom of the

102
00:08:23,520 --> 00:08:28,049
box on the side of the structure we
finally sticker arm and as a bunch of

103
00:08:28,050 --> 00:08:31,410
details on it so we can see there's a
serial number on there

104
00:08:32,280 --> 00:08:37,770
the cable modem mac address from them
and then there's an empty a mac address

105
00:08:37,770 --> 00:08:45,689
and then we have two sets of our
societies and default credentials so the

106
00:08:45,690 --> 00:08:50,250
mountain is capable of working involved
to the four th models and five years

107
00:08:50,250 --> 00:08:50,910
what

108
00:08:50,910 --> 00:08:56,280
and depending on which Modi said to
maybe i think is also combined with the

109
00:08:56,280 --> 00:09:08,430
SSID changes and wpa2 plus raise changes
possible if we rip off the outside the

110
00:09:08,430 --> 00:09:12,209
top cover of the of the modern world the
modern device

111
00:09:12,210 --> 00:09:17,340
are we can see this this is actually not
what she because you're really there a

112
00:09:17,340 --> 00:09:19,500
cable so the door to the board

113
00:09:19,500 --> 00:09:26,580
what I found there is a dybbuk port
serial port if you look on the left is

114
00:09:26,580 --> 00:09:30,180
hard to see but there's more wires going
on the to the bottom side of the port

115
00:09:31,200 --> 00:09:38,190
that's where I connected the spy flash
in order to dump it actually below does

116
00:09:38,190 --> 00:09:43,770
he think is another serial port that you
can easily see because the heat sink his

117
00:09:43,770 --> 00:09:49,920
own but later on I also connected so I i
made some modifications to the device

118
00:09:49,920 --> 00:09:57,569
that was essentially least to me by my
isp so i probably in violation of

119
00:09:57,570 --> 00:09:58,890
something here

120
00:09:58,890 --> 00:10:02,069
I'm not entirely issue

121
00:10:02,070 --> 00:10:07,380
they're like I mention I found two
serial ports on this board

122
00:10:08,910 --> 00:10:15,990
she reports can be used in a default
configuration where you have to eight

123
00:10:15,990 --> 00:10:18,690
bits no parity bits and one stop it

124
00:10:18,690 --> 00:10:26,250
the most most default configuration ever
and they operate at 115200 about

125
00:10:26,250 --> 00:10:29,100
personal matters

126
00:10:29,100 --> 00:10:34,800
yeah and one of the serial ports start
spitting out data

127
00:10:34,800 --> 00:10:41,069
really right after you plug the power in
the model but the other one also get

128
00:10:41,070 --> 00:10:46,380
your awkward but it starts a bit later
and so i'll put on the first serial port

129
00:10:46,380 --> 00:10:52,980
starts with some broadcom bootloader
output and then eventually transgresses

130
00:10:52,980 --> 00:10:59,760
into a what they call it course it's a
real time operating system boot look out

131
00:10:59,760 --> 00:11:04,590
look at some point does second serial
port will also start giving your output

132
00:11:04,590 --> 00:11:09,030
but this looks like a regular linux
kernel boots or something we've all seen

133
00:11:09,030 --> 00:11:13,020
before a tree falls in the linux kernel
board we know what the booth looks like

134
00:11:13,020 --> 00:11:18,030
so it's easy to recognize but it's not
the paul that is the linux start booting

135
00:11:18,030 --> 00:11:22,079
for later than the equals part plus

136
00:11:22,080 --> 00:11:29,430
so what's going on here this is a dual
core cpu and actually use one chord to

137
00:11:29,430 --> 00:11:34,069
run the real-time operating system he
cost and they use the other cord

138
00:11:34,070 --> 00:11:40,160
run a linux girl and then I was thinking
this is going to give you all kinds of

139
00:11:40,160 --> 00:11:44,750
issues that because you have one big
block of ram and you need to share

140
00:11:44,750 --> 00:11:49,160
between lessons but they did it just
half the ramming the upper half is used

141
00:11:49,160 --> 00:11:53,660
by another linux part and then the lower
offer a machines but equals part

142
00:11:53,660 --> 00:11:57,709
so this is interesting we have a modern
is running through operating system

143
00:11:57,710 --> 00:12:00,590
simultaneously for some reason

144
00:12:00,590 --> 00:12:08,060
turns out it wasn't actually that
interesting we get to Italy so I set out

145
00:12:08,060 --> 00:12:13,939
to dump this by flash is more so it's a
small LED paint chip on the board

146
00:12:13,940 --> 00:12:19,610
luckily these parts are very
standardized and specifications out

147
00:12:19,610 --> 00:12:21,110
there

148
00:12:21,110 --> 00:12:24,590
the pin out this is a standard I tree

149
00:12:24,590 --> 00:12:28,850
even if you don't can't can't find the
data sheet for the exact part you can

150
00:12:28,850 --> 00:12:32,390
just wire them up in a way you would
wire up a typical spy flash

151
00:12:33,440 --> 00:12:38,210
I did them to spy for less using the
good fat

152
00:12:38,720 --> 00:12:43,490
it's a small piece of hardware by Travis
good spit

153
00:12:43,490 --> 00:12:46,610
you might have heard of this guy does
amazing work

154
00:12:46,610 --> 00:12:51,560
crazy work all kinds of weird shit but
he also came up with this small board

155
00:12:51,560 --> 00:12:53,000
arm

156
00:12:53,000 --> 00:12:56,750
I was once donated one of these boards
and I was like well why don't you use a

157
00:12:56,750 --> 00:13:00,560
fellow actors a piece of hardware to to
do my own acting work right

158
00:13:01,190 --> 00:13:05,570
such as broad a spy flash client invited

159
00:13:06,290 --> 00:13:12,110
so the good weather is a device with
msp430 microcontroller which does all

160
00:13:12,110 --> 00:13:13,280
the heavy lifting

161
00:13:13,280 --> 00:13:19,550
did so I all that sort of stuff and then
he has a small protocol going on over to

162
00:13:19,550 --> 00:13:25,849
use be truly ftdi so there's a USB to
serial converter on there and the nice

163
00:13:25,850 --> 00:13:28,940
thing is you can program everything in
high-level pilot

164
00:13:28,940 --> 00:13:33,140
so including things like dumping spy
flash barking flesh ideas and all that

165
00:13:33,140 --> 00:13:36,890
stuff is implemented in part because
it's really easy through to use them to

166
00:13:36,890 --> 00:13:39,380
hack into to adapt that sort of thing

167
00:13:39,380 --> 00:13:43,910
I before I start solving with a flash
chip

168
00:13:44,510 --> 00:13:49,280
I was talking to some friends I don't
necessarily want to avoid the

169
00:13:49,280 --> 00:13:54,050
shouldering shouldering is too bad as
all I see should have been more in that

170
00:13:54,050 --> 00:13:56,120
tiny not really like

171
00:13:56,120 --> 00:14:01,340
SMD so learning station or anything you
don't need super false hardware was

172
00:14:01,340 --> 00:14:07,730
looking into avoiding soldiers are so I
find out about these clips they

173
00:14:07,730 --> 00:14:09,560
apparently work really well

174
00:14:09,560 --> 00:14:14,689
r and then I was talking to my friends
brand smoke Eric and he mentioned he

175
00:14:14,690 --> 00:14:18,830
built one of those clips himself and i
find it really I'll area so i thought

176
00:14:18,830 --> 00:14:23,810
i'd include a picture he took a wrench
included some some parts to it

177
00:14:24,410 --> 00:14:29,480
so here's a wrench in just the ball clip
for chips and then the second one is

178
00:14:29,480 --> 00:14:36,080
even more get that using like a back
from one from a line of clothing line to

179
00:14:36,080 --> 00:14:37,550
make his own clip

180
00:14:37,550 --> 00:14:42,140
so it goes to show that I did not end up
using any of these clips whatever i just

181
00:14:42,140 --> 00:14:48,140
sold directly to the pins but people can
get very creative with common items in

182
00:14:48,140 --> 00:14:50,449
order to build their own clips

183
00:14:50,450 --> 00:14:57,950
apparently from branches back so I back
to the serial port if we turn on the

184
00:14:57,950 --> 00:15:00,620
device and we look at the first year old
boy

185
00:15:00,620 --> 00:15:07,820
we can see his output you can see the
bootloader starting you can see it's

186
00:15:07,820 --> 00:15:10,190
indentifying a spy flesh

187
00:15:10,190 --> 00:15:15,560
I was hurting Heidi is bringing out the
size for us the block size that's really

188
00:15:15,560 --> 00:15:20,150
nice right and then there's also a nand
flash and so despite flesh is really

189
00:15:20,150 --> 00:15:23,839
small it's just a megabyte right so is
contained some book called it contains

190
00:15:23,839 --> 00:15:28,850
enough to bootstrap the system which
then we'll probably read more stuff from

191
00:15:28,850 --> 00:15:33,770
the nand flash which is 64 megabytes 64
megabytes might not seem like a lot but

192
00:15:33,770 --> 00:15:38,390
for another device you can store an
entire root file system down in a

193
00:15:38,390 --> 00:15:42,620
criminal and all that sort of stuff you
wouldn't be able to fit inside of our I

194
00:15:42,620 --> 00:15:48,320
one megabyte spy flash right arm once
you have the bottom we also see it says

195
00:15:48,320 --> 00:15:52,970
reading a flash map at offset f30 and
the sizes that

196
00:15:52,970 --> 00:16:01,790
so if we look at the dump from the spy
flash and we go to an offset FF 30 we

197
00:16:01,790 --> 00:16:04,219
can see has some kind of partition table
here

198
00:16:04,220 --> 00:16:09,140
so then and is split up in various
partitions

199
00:16:10,490 --> 00:16:16,459
well which is interesting later but
first we need to get a dump of the

200
00:16:16,459 --> 00:16:20,869
actual man flesh in order to to extract
those petitions at all but if you look

201
00:16:20,870 --> 00:16:25,730
at you can see that arm as a small herer
and this is just from looking at the

202
00:16:25,730 --> 00:16:31,640
heck state or a Jacuzzi some partition
labels so some data which might be might

203
00:16:31,640 --> 00:16:35,839
be offsets into the mountain national
boom

204
00:16:35,839 --> 00:16:40,880
let's look a bit more at the bootloader
it's a really nice boot longer because

205
00:16:40,880 --> 00:16:43,610
at the moment it starts

206
00:16:43,610 --> 00:16:49,459
eventually it will give you this message
it says enter 12 or press p within two

207
00:16:49,459 --> 00:16:50,239
seconds

208
00:16:50,240 --> 00:16:55,700
so if you press one is going to boot
image one from the from the nand flash

209
00:16:55,700 --> 00:16:59,870
system and if you press to its going to
boot image - so there's a data recovery

210
00:16:59,870 --> 00:17:04,459
system where one image gets corrupt that
then you can stay with into the second a

211
00:17:04,459 --> 00:17:07,220
marriage and is normally done
automatically

212
00:17:07,220 --> 00:17:13,220
but you also have the option to override
is the room you'd both but then there's

213
00:17:13,220 --> 00:17:17,780
also the option to press p ride and when
you press . you get turned into it is

214
00:17:17,780 --> 00:17:19,550
really nice menu

215
00:17:19,550 --> 00:17:23,659
i wish i had a screenshot it for you but
I don't and the man who gives you a

216
00:17:23,660 --> 00:17:25,040
bunch of options

217
00:17:25,040 --> 00:17:29,928
one of them is Buddha systems normal the
other is boot the system from tftp

218
00:17:29,929 --> 00:17:37,130
there's an option to read memory is a
peak as an option to ride memory like a

219
00:17:37,130 --> 00:17:38,060
bug

220
00:17:38,060 --> 00:17:41,720
and then there's an option to jump to an
arbitrary address

221
00:17:41,720 --> 00:17:45,710
if you're like so if every combined

222
00:17:45,710 --> 00:17:50,150
well if you combine the park and the
jump to address we can write coats on my

223
00:17:50,150 --> 00:17:52,130
memory right and we can jump to it

224
00:17:52,130 --> 00:17:58,400
so this is a nice factor for getting
code execution really early on in the

225
00:17:58,400 --> 00:18:04,070
food chain before the actual devices
boutique insist on the bootloader so r

226
00:18:04,760 --> 00:18:08,840
I mean there's also the option of
booting it from tftp ride with the ftp

227
00:18:08,840 --> 00:18:14,240
sounds complicated afternoon networking
stuff and enough so I looked a bit more

228
00:18:14,240 --> 00:18:17,179
into the peak box stuff right arm

229
00:18:17,179 --> 00:18:20,510
I came up with this really ugly script

230
00:18:20,510 --> 00:18:24,590
it's a Python script as you can see on
the left I was going to do is it's going

231
00:18:24,590 --> 00:18:29,418
to comfort a binary file into a bunch of
commands that gets enter the serial port

232
00:18:30,500 --> 00:18:34,190
I'm search about programmer that I
couldn't get by serial to work to talk

233
00:18:34,190 --> 00:18:39,320
to the sheriff . directly from button
was giving me all kinds of issues so i

234
00:18:39,320 --> 00:18:44,570
end up generating a shell script from
the piling God and that's a really ugly

235
00:18:44,570 --> 00:18:47,809
shell script that goes out for her for
hundreds and thousands of lines while

236
00:18:47,809 --> 00:18:53,299
depending on your input file but it
works really well as you can see i have

237
00:18:53,299 --> 00:18:56,418
to try on some sleeps very small sleeps

238
00:18:56,419 --> 00:19:00,500
if I didn't do that then things will
break I don't know why but this is

239
00:19:00,500 --> 00:19:03,770
important

240
00:19:03,770 --> 00:19:07,970
so yeah we had to dump the nand flash
right then bring the spy flash is easy

241
00:19:07,970 --> 00:19:12,980
it'sit's 18s oh IC chip like this it
it's 10 minutes of soldering and a bit

242
00:19:12,980 --> 00:19:14,600
of good father working you have it

243
00:19:14,600 --> 00:19:19,129
but if you want to interface with a nand
flash which usually coming T sub

244
00:19:19,130 --> 00:19:24,799
packages that things are very depends
are very tiny and soldiering to this

245
00:19:24,799 --> 00:19:29,900
type of of chip is no I'm not is you
need some bear equipment for is not

246
00:19:29,900 --> 00:19:35,120
impossible i've seen people do it it's
it's not the way i would prefer to do

247
00:19:35,120 --> 00:19:39,709
this so I thought maybe we can do a
software approach to to dump the nand

248
00:19:39,710 --> 00:19:42,320
right arm

249
00:19:42,320 --> 00:19:47,720
sorry i add this code execution thing i
didn't really write any useful college

250
00:19:47,720 --> 00:19:49,090
yet but I verified that it

251
00:19:49,090 --> 00:19:53,560
works because if you trigger an
exception as exception handler which

252
00:19:53,560 --> 00:19:56,980
will show you where to cpu crashed and
what is in every register so you can

253
00:19:56,980 --> 00:20:01,420
write a tiny bit of shell called see
what it does he was executed properly so

254
00:20:01,420 --> 00:20:05,320
i was able to verify that i was like
well I can leverage the same thing to

255
00:20:05,320 --> 00:20:10,929
them the nand flash maybe but don't have
to talk to Nana controller right so I

256
00:20:10,930 --> 00:20:14,800
need to know what and control which is
what bits do I flip and what registers

257
00:20:14,800 --> 00:20:21,159
in order to trigger a secretary from the
nand flash and then get the data hours

258
00:20:21,160 --> 00:20:24,280
and I mean it sounds like it sounds like
work

259
00:20:24,280 --> 00:20:29,710
so what if we what if we look for
existing nand flash routines that are

260
00:20:29,710 --> 00:20:34,480
already part of the boot loader and we
just jump into those routines and let

261
00:20:34,480 --> 00:20:39,610
them do all the heavy lifting for us and
we get the date out that we still left

262
00:20:39,610 --> 00:20:42,610
with the problem that we need to get a
date out of the system

263
00:20:43,240 --> 00:20:47,710
well of course we have our serial ports
we could split the diet that back out

264
00:20:47,710 --> 00:20:49,030
over the serial port

265
00:20:49,030 --> 00:20:55,870
so what we do is we automate a series of
box to apply - are called using the

266
00:20:55,870 --> 00:20:57,459
script I just showed you

267
00:20:57,460 --> 00:21:03,520
and eventually we trigger to jump to
address option and well I started off

268
00:21:03,520 --> 00:21:07,570
writing all this discarding it makes
assembly because it is its a mix best

269
00:21:07,570 --> 00:21:08,320
device

270
00:21:08,320 --> 00:21:13,780
we're riding assembly called can get
tiresome really quick so i decided to

271
00:21:13,780 --> 00:21:20,560
switch to just writing it and see which
at all would be hard but turns out is

272
00:21:20,560 --> 00:21:23,919
not that hard you have to write it but
if your own startup called make sure the

273
00:21:23,920 --> 00:21:26,770
stack pointer set up correctly

274
00:21:26,770 --> 00:21:30,129
and maybe some red register
initialization but after that you can

275
00:21:30,130 --> 00:21:33,970
get a clean environment for executing
see card as long as you you compile and

276
00:21:33,970 --> 00:21:39,880
Link it properly so that's nice instead
of writing dirty is MX and just do it

277
00:21:39,880 --> 00:21:40,990
and see

278
00:21:40,990 --> 00:21:45,610
so if you have a look better for look at
my see codya arm

279
00:21:46,150 --> 00:21:49,840
we can see i define a new type for this
function pointer

280
00:21:51,070 --> 00:21:58,149
we have one for your could see it writes
a chapter to the serial port and then we

281
00:21:58,150 --> 00:22:03,520
have a knot upon 4 nand flash read which
is able to read a page or more pages

282
00:22:03,520 --> 00:22:08,590
from the nand flash for you so it does
all the hard work for you and all we did

283
00:22:08,590 --> 00:22:12,439
was while we found those routines and
then the bootloader

284
00:22:12,440 --> 00:22:17,450
and we said the point is to them and
then then then we just call them from

285
00:22:17,450 --> 00:22:19,580
our secret right

286
00:22:19,580 --> 00:22:24,530
that just a quick note at the bottom you
see a little compilation line for the

287
00:22:24,530 --> 00:22:26,168
thing that using

288
00:22:26,169 --> 00:22:31,299
MIPS cross-compiler higher i got from
the internets because i didn't feel like

289
00:22:31,299 --> 00:22:37,359
building just see myself hard work if
you have to build you see yourself you

290
00:22:37,359 --> 00:22:42,100
have to build GC mpfr there's a whole
bunch of dependencies you have to

291
00:22:42,100 --> 00:22:45,039
configure it in the right way and if
you've done that it will not work so

292
00:22:45,039 --> 00:22:50,529
using pre-compiled to change is great
that I often see people doing very

293
00:22:50,529 --> 00:22:56,529
stupid things where they do in order to
grab a shell crowd from a compile father

294
00:22:56,529 --> 00:23:00,340
to object dump and then they grab the
xbox from the object them up with or

295
00:23:00,340 --> 00:23:03,970
something like that don't want to see
any of that anymore so i'll teach you

296
00:23:03,970 --> 00:23:09,759
guys how to use object copy and you just
tell it to copy just a text segment up

297
00:23:09,759 --> 00:23:14,409
with binary you're given an alpha into
binary and you have all your upper body

298
00:23:14,409 --> 00:23:15,730
and not by me

299
00:23:15,730 --> 00:23:22,179
you don't need to use grab object of Arc
set could wash you know that's what are

300
00:23:22,179 --> 00:23:28,059
they have finding the symbols to
facilitate that is not dumping it's not

301
00:23:28,059 --> 00:23:31,840
really hard we need two functions right
we need a function to write a check to

302
00:23:31,840 --> 00:23:37,689
the serial port are or we need to write
a function that that low-level you are

303
00:23:37,690 --> 00:23:42,820
by ourselves which sounds like work but
doesn't actually get much work because

304
00:23:42,820 --> 00:23:45,939
you are peripherals are very easy to
control

305
00:23:46,509 --> 00:23:51,460
usually have our a TX register which
ratchet data to and then you have a

306
00:23:51,460 --> 00:23:56,769
status register which keep calling to
make sure that your read when fully true

307
00:23:56,769 --> 00:23:58,450
or rightfully true and then

308
00:23:58,450 --> 00:24:02,260
when the best answers from the register
you can do the next one

309
00:24:03,760 --> 00:24:08,110
I didn't end up doing that I ended up
finding just the function with just four

310
00:24:08,110 --> 00:24:11,439
me and then we need of course that
function

311
00:24:11,440 --> 00:24:19,660
I cash out here to nand flash read so I
eventually I i open up this thing tied

312
00:24:19,660 --> 00:24:24,940
up and as strengths are nice rides we
always go by string references through

313
00:24:24,940 --> 00:24:31,720
to find data in in a big block so i find
the string which says nand flash read

314
00:24:31,720 --> 00:24:39,280
reading out that Lang that a la gata so
it's very apparent that since this is at

315
00:24:39,280 --> 00:24:44,050
the start of our routine that is to do
extreme left in right so we're never

316
00:24:44,050 --> 00:24:48,310
going to trigger and that flashes will
see death but it also tells us that dish

317
00:24:48,310 --> 00:24:52,450
is the function called nand flasher it
because it says right there so just give

318
00:24:52,450 --> 00:24:57,100
it a name and flash read and then since
there's a print of there we can see the

319
00:24:57,100 --> 00:25:00,429
arguments and we automatically figure
out the order of the arguments as well

320
00:25:00,430 --> 00:25:03,880
so that that's really nice

321
00:25:03,880 --> 00:25:08,050
now we have to do your pussy like I said
sometimes it doesn't have to be

322
00:25:08,050 --> 00:25:09,010
complicated

323
00:25:09,010 --> 00:25:13,090
you have a simple pair and you ride to
the

324
00:25:13,090 --> 00:25:16,120
register to TX that's it

325
00:25:16,120 --> 00:25:20,080
I'm a quitter just written this myself
but it ended up not doing it

326
00:25:20,590 --> 00:25:23,830
arm so yeah

327
00:25:24,400 --> 00:25:27,460
using these did this this small piece of
C code

328
00:25:28,450 --> 00:25:33,340
i was able to dump other net it took a
long while

329
00:25:33,340 --> 00:25:36,399
because the serial port is not super
fast

330
00:25:36,400 --> 00:25:42,520
so yeah I just left it running overnight
and then i'm not sure it spits out a ski

331
00:25:42,520 --> 00:25:47,500
x instead of binary crap and the way I
set it up as i just use screen as a

332
00:25:47,500 --> 00:25:50,680
terminal emulator i see lots of people
using me Nicole and peacock home

333
00:25:50,680 --> 00:25:51,970
whatever the fuck com

334
00:25:51,970 --> 00:25:56,020
don't use that just your screen right
screen is an actual internal I could

335
00:25:56,020 --> 00:26:01,510
also the serial port is fine if your
lunch cream with device through a serial

336
00:26:01,510 --> 00:26:04,900
port and then you can specify about
right behind it so you don't know if you

337
00:26:04,900 --> 00:26:06,880
have to use STI renting it

338
00:26:06,880 --> 00:26:10,600
it's really great you can set screen up
to do logging

339
00:26:10,600 --> 00:26:14,469
so whenever any day this coming into
your screen or write to lock all right

340
00:26:14,470 --> 00:26:17,170
so I had this really a key weird thingy

341
00:26:17,170 --> 00:26:21,070
I set it up i left the ground over not a
good night of sleep and when I came back

342
00:26:21,070 --> 00:26:26,770
I part look for our group that old ask X
and turn it into a binary fuck

343
00:26:26,770 --> 00:26:31,780
so I had a dumpling and now we need to
split these names up

344
00:26:31,780 --> 00:26:35,080
we can't win another ingenious button
script that's ten lines

345
00:26:35,650 --> 00:26:39,850
it takes a couple arguments one is the
filename and there's an offset then

346
00:26:39,850 --> 00:26:41,139
there's the size right

347
00:26:41,140 --> 00:26:45,130
so we can carve blocks from a file it's
super easy and then there's a fourth

348
00:26:45,130 --> 00:26:47,770
argument which is the output file -
right

349
00:26:47,770 --> 00:26:54,790
so are we went over the partition table
earlier and from the difficult but we

350
00:26:54,790 --> 00:26:57,820
can tell they're all the partitions
start and what their links are so so we

351
00:26:57,820 --> 00:26:58,990
use this to

352
00:26:58,990 --> 00:27:04,360
extract this is not a shell script to
extract all these sections from the

353
00:27:04,360 --> 00:27:11,678
necklace and two separate files and then
just like a monkey would do we run file

354
00:27:11,679 --> 00:27:19,090
on all of this which gives us lots of
false positives and no really useful

355
00:27:19,090 --> 00:27:22,270
signatures hit that make any sense at
all

356
00:27:22,270 --> 00:27:31,000
so what we do is we look at the first 10
bytes for every file we notice that some

357
00:27:31,000 --> 00:27:37,480
of them start with you be you be is you
BFFs

358
00:27:37,480 --> 00:27:43,840
I think something originally developed
by nokia file system designed

359
00:27:43,840 --> 00:27:48,879
specifically for manflesh so does all
sorts of interesting things that error

360
00:27:48,880 --> 00:27:54,070
correction that blocks and moving things
around to prevent wear and tear of man

361
00:27:54,070 --> 00:27:57,550
flesh arm

362
00:27:57,550 --> 00:28:02,530
so yeah we still had to get a
decompressed image of of the the equals

363
00:28:02,530 --> 00:28:04,720
I want to analyze

364
00:28:04,720 --> 00:28:10,330
so if we go through the output of the
bootloader again we see at some point

365
00:28:10,330 --> 00:28:17,080
it's going to decompress and i'll see to
my image do a sort of memory address

366
00:28:18,280 --> 00:28:24,129
I was like well I could I can do that
manly so I I carved out the the lsat the

367
00:28:24,130 --> 00:28:29,050
major can try various also to my
utilities on it but I couldn't go to

368
00:28:29,050 --> 00:28:35,409
work and what if after trying many many
tools for three hours you get fed up he

369
00:28:35,410 --> 00:28:40,120
look for an alternative life seems like
everyone likes to like to change

370
00:28:40,120 --> 00:28:43,270
something else that's my background
background not sure of his office

371
00:28:43,270 --> 00:28:49,270
location or just just being annoying in
general or but so I i came up with a

372
00:28:49,270 --> 00:28:50,559
different way right

373
00:28:50,559 --> 00:28:55,178
I had this way to do a code execution
really early on so i could patch figs

374
00:28:55,179 --> 00:29:00,880
what if we insert a cold patch right
after it is done decompressing the

375
00:29:00,880 --> 00:29:05,380
buffer to memory and then be just done
the decompressed buffer over to serial

376
00:29:05,380 --> 00:29:10,570
port on your computer then we don't need
to worry about this compression at all

377
00:29:10,570 --> 00:29:15,460
we just let the system do all the hard
work for US Army right Toralei sexy

378
00:29:15,460 --> 00:29:21,760
cards and small oak and the result is a
decompress equals binary that we can now

379
00:29:21,760 --> 00:29:28,059
actually loaded into either pro or
disassembler and make sense of

380
00:29:28,600 --> 00:29:33,550
so let's let's in let's enter your
course I don't know any of you ever

381
00:29:33,550 --> 00:29:34,300
wrote them

382
00:29:34,300 --> 00:29:39,639
reverse engineering real-time operating
systems but it's annoying because

383
00:29:39,640 --> 00:29:44,770
usually have one big monolithic block
with everything stashed inside various

384
00:29:44,770 --> 00:29:48,220
processes finished talking with you it's
all in a big bla pride

385
00:29:48,220 --> 00:29:51,850
so the same goes for it cost

386
00:29:51,850 --> 00:29:58,090
we ended up with a 24 mega byte block
which has all this stuff going on and if

387
00:29:58,090 --> 00:30:01,990
you load it into either a all you have
to get a cup of coffee and another one

388
00:30:01,990 --> 00:30:06,190
and walk around your apartment for a few
times and when you get back it might be

389
00:30:06,190 --> 00:30:09,970
done out to analyzing the thing because
it's really huge banner and we wonder

390
00:30:09,970 --> 00:30:13,240
what real-time operating systems are
used for

391
00:30:13,240 --> 00:30:16,720
well I i hope they don't use equals for
the brand new deal

392
00:30:16,720 --> 00:30:20,410
do not use PX works for spacecraft

393
00:30:20,410 --> 00:30:24,970
yeah I just rather than we could pay
today but yeah it's a real time

394
00:30:24,970 --> 00:30:28,809
operating system laughter purpose but
when dealing with them from my analysis

395
00:30:28,809 --> 00:30:34,870
. if you can get quite a no it's not
quite your linux or your windows or

396
00:30:34,870 --> 00:30:36,449
something that is widely known

397
00:30:36,450 --> 00:30:42,660
document yeah we talked earlier about
the system being a doable system right

398
00:30:42,660 --> 00:30:49,590
and the linux part initially interested
me a lot because I mean I know linux I

399
00:30:49,590 --> 00:30:55,169
know embedded linux so much more my my
area I was like if you attack that first

400
00:30:55,170 --> 00:30:57,510
maybe something interesting is going on
there

401
00:30:57,510 --> 00:31:02,580
back then I didn't even understand why
this defies has two operating systems

402
00:31:02,580 --> 00:31:04,860
running in parallel right

403
00:31:04,860 --> 00:31:10,020
so it turns out if you go back to one of
the first things i want to use B port on

404
00:31:10,020 --> 00:31:10,920
that modem

405
00:31:10,920 --> 00:31:15,000
so the purpose of the USB port is to
provide you with

406
00:31:15,540 --> 00:31:18,690
I think DLNA capabilities such

407
00:31:18,690 --> 00:31:24,180
so you can plug in USB stick with
finding the amount of a fee for like a

408
00:31:24,180 --> 00:31:27,810
movie on there and then it will share it
over your network and so i'll make it

409
00:31:27,810 --> 00:31:29,610
accessible to your television

410
00:31:29,610 --> 00:31:35,729
I'm not sure how this is supposed to
work but as it turns out the the system

411
00:31:35,730 --> 00:31:40,620
is configured and set up in such a way
that these linux kernel actually boots

412
00:31:40,620 --> 00:31:45,300
but then it needs to set up networking
and the init scripts the end of the

413
00:31:45,300 --> 00:31:47,879
scripts where it is not working are
completely broken

414
00:31:47,880 --> 00:31:52,380
so the system is never going to come up
in a way that that Linux is able to talk

415
00:31:52,380 --> 00:31:57,420
to anything so laughing - original
intent was for dland purposes at the

416
00:31:57,420 --> 00:31:58,110
most

417
00:31:58,110 --> 00:32:03,659
I species don't use that functionality
that there are still lots of leftovers

418
00:32:03,660 --> 00:32:04,890
and shoulders

419
00:32:04,890 --> 00:32:10,470
a lot of people in the Netherlands who
have arm linux kernel running in there

420
00:32:10,470 --> 00:32:14,130
no wiring cabinet that they're not aware
after that is not doing anything it's

421
00:32:14,130 --> 00:32:15,110
just sitting there

422
00:32:15,110 --> 00:32:21,530
and being pretty but yeah I initially I
didn't realize this I i wanted to get

423
00:32:21,530 --> 00:32:27,230
into this little spot as well right arm
around another hook which patches the

424
00:32:27,230 --> 00:32:33,200
booth arguments for the lantern or
memory and the way this is a bit Hecky

425
00:32:33,200 --> 00:32:38,510
so you have to use linux boot our school
online and it has various options for

426
00:32:38,510 --> 00:32:39,650
the colonel

427
00:32:39,650 --> 00:32:46,100
but i want to match the string with us
also stuff behind it so if I would make

428
00:32:46,100 --> 00:32:49,040
it longer I would run into trouble I
mean shorter first of course not

429
00:32:49,040 --> 00:32:53,090
probably could get it out materialize
but longer an issue if i wanted to do

430
00:32:53,090 --> 00:32:54,530
any every row work

431
00:32:54,530 --> 00:33:00,379
so what I did is there is also the about
rate is in the in the booth arguments

432
00:33:00,380 --> 00:33:07,220
and it was set to 15 20 but that's
pretty long right 15 20 g removed bunch

433
00:33:07,220 --> 00:33:11,660
of characters you drop the baud rate 296
00 you win a bunch of character there

434
00:33:11,660 --> 00:33:15,290
and then removed from all the current
options with your fingers are not as

435
00:33:15,290 --> 00:33:20,840
important or elephant and then you can
append in it is being a site right so

436
00:33:20,840 --> 00:33:23,990
now when you boot the thing with your
memory purchase in place you will get

437
00:33:23,990 --> 00:33:29,030
dropped into a natural chill and then I
learned that the networking was broken

438
00:33:29,030 --> 00:33:32,418
and the linux system wasn't set up in a
way it's supposed to be set up side that

439
00:33:32,419 --> 00:33:35,120
was just useless just saying i was doing
nothing

440
00:33:35,120 --> 00:33:40,370
I wasted all this effort for nothing but
so we still have the 20 megabytes 24

441
00:33:40,370 --> 00:33:46,070
microwave equals binary then you wonder
how do you do with a 20 by make about

442
00:33:46,070 --> 00:33:47,270
binary I mean

443
00:33:47,270 --> 00:33:50,990
well you don't it's a lot of calls I
mean 20 megawatts of car

444
00:33:50,990 --> 00:33:56,450
there's also a date and a minute it's a
lot right so usually when you're refers

445
00:33:56,450 --> 00:33:59,929
to engineering something you're looking
for something right you you have a goal

446
00:33:59,929 --> 00:34:03,110
in mind I want to figure out this part
i'm going to figure out that part you

447
00:34:03,110 --> 00:34:05,990
cannot say i want to refer to this firm

448
00:34:05,990 --> 00:34:07,730
you can say the firm's is

449
00:34:07,730 --> 00:34:11,480
this is 24 megabyte thing I got a very
first of all you want

450
00:34:11,480 --> 00:34:15,860
so you need to have some specific
government for example when I was

451
00:34:15,860 --> 00:34:19,940
looking for a nand flash routines what
we have we have string references to go

452
00:34:19,940 --> 00:34:24,320
buy it starts with NAND flash read so we
can use that as a point for indentifying

453
00:34:24,320 --> 00:34:30,140
things but so yeah i was using static
revenger engineering you can find some

454
00:34:30,139 --> 00:34:34,400
things but then we're also dealing with
Miss card right we don't have a

455
00:34:34,400 --> 00:34:40,160
decompiler for mips we actually once we
get down to the very details we need to

456
00:34:40,159 --> 00:34:44,299
understand next instructions and maybe
there's lots of MIPS instructions and we

457
00:34:44,300 --> 00:34:45,860
need to make sense of that

458
00:34:45,860 --> 00:34:49,310
so we could introduce some dynamic
instrumentation maybe

459
00:34:50,239 --> 00:34:54,739
of course there's also hands waving and
guesswork also works really well during

460
00:34:54,739 --> 00:34:59,330
reverse engineering trust me if you can
make educated guesses or like have good

461
00:34:59,330 --> 00:35:06,799
hunches that that it helps look so i was
reading the paper by roof built in the

462
00:35:06,800 --> 00:35:13,430
other guys that inspired me and and one
way they talked about for running part

463
00:35:13,430 --> 00:35:20,870
of all for example Niko's image is by
using q mu 2 mu in your mouth are what

464
00:35:20,870 --> 00:35:26,750
is the large to do is run a are for
example a arm linux binder or middle

465
00:35:26,750 --> 00:35:30,650
innings binary or what actually is
binary on your your regular into

466
00:35:30,650 --> 00:35:31,370
computer

467
00:35:31,370 --> 00:35:37,490
this is q mu ah so it is as if you were
executing a binary on the linux system

468
00:35:37,490 --> 00:35:41,000
racha if the linux kernel intercession
of the linux is calls and all its them

469
00:35:41,000 --> 00:35:46,670
so we write a very tiny program we
compile it using a mystical

470
00:35:46,670 --> 00:35:52,820
cross-compiler you make it use the linux
and map cisco to request a new memory

471
00:35:52,820 --> 00:35:58,670
mapping which led to make this memory
mapping readable writable and executable

472
00:35:59,210 --> 00:36:05,660
so it is really everything goes that we
make a big enough to store the entire

473
00:36:05,660 --> 00:36:10,759
equals from binary inside this mapping
now we copy the entire equals mirror

474
00:36:10,760 --> 00:36:15,020
thing in there and then while you can
you can't just jump to the entry point

475
00:36:15,020 --> 00:36:15,380
and

476
00:36:15,380 --> 00:36:19,549
expect anything to happen but you can't
jump through very specific points in the

477
00:36:19,549 --> 00:36:22,430
cold and get out come from there

478
00:36:22,430 --> 00:36:28,038
for example if you found on our routine
which does some computation and doesn't

479
00:36:28,039 --> 00:36:32,299
touch any hardware doesn't do anything
complicated then we can just jump to it

480
00:36:32,299 --> 00:36:38,480
and get the rest from their routine so
this is a very useful way for quickly

481
00:36:38,480 --> 00:36:44,569
evaluating some things are but it
doesn't give you a whole lot of control

482
00:36:44,569 --> 00:36:49,819
I mean you could still attached gb and
influence things that way but well it's

483
00:36:49,819 --> 00:36:51,529
it's a bit cumbersome

484
00:36:51,529 --> 00:36:54,589
of course you have to have to write C
cards also commercial

485
00:36:54,589 --> 00:36:59,480
let's talk a bit about the algorithm
shoes

486
00:36:59,480 --> 00:37:03,980
so like I said this device has a serial
number which is written on the sticker

487
00:37:03,980 --> 00:37:08,960
as also printed sticker on the box and
the serial number is used to generate

488
00:37:08,960 --> 00:37:16,490
their SSID but the serial number is also
used to generate to wpa2 pre-shared key

489
00:37:16,490 --> 00:37:24,859
so you have the serial number from which
day s ideas generated and you have the

490
00:37:24,859 --> 00:37:29,299
same serial number from which the wpa
key is generated but we do not have the

491
00:37:29,299 --> 00:37:30,500
serial number

492
00:37:30,500 --> 00:37:34,250
if we can't get through the box and look
at the sticker on the bottom but we do

493
00:37:34,250 --> 00:37:39,170
have the SSID and we do know that the
essence ideas generated based on the

494
00:37:39,170 --> 00:37:40,220
serial number

495
00:37:40,220 --> 00:37:43,519
so what if we could go back that would
be needed bad

496
00:37:43,519 --> 00:37:49,008
well turns out you can go back but you
will end up with some collisions

497
00:37:49,009 --> 00:37:53,750
so the serial number is a bit longer
than this idea is so you lose some

498
00:37:53,750 --> 00:37:56,900
position there but it's not too bad

499
00:37:56,900 --> 00:38:02,359
you can get about 15 collisions pair as
ID so you end up with a list of 15

500
00:38:02,359 --> 00:38:07,130
possible serial numbers for every one of
the serial numbers you can generate the

501
00:38:07,130 --> 00:38:09,109
valid wpa2 key

502
00:38:09,109 --> 00:38:13,640
there's only one so you end up with 15
passwords for a Wi-Fi network fisting

503
00:38:13,640 --> 00:38:15,410
possible passwords

504
00:38:15,410 --> 00:38:19,920
yeah and trying 15 fostered by and

505
00:38:19,920 --> 00:38:23,730
is it is totally possible there's a bit
of a timeout but you could do it in a

506
00:38:23,730 --> 00:38:28,020
minute or sell side doesn't ever
required to us is just go through a man

507
00:38:29,190 --> 00:38:35,309
yeah and then we profit right because we
be managed to recover key so I was

508
00:38:35,309 --> 00:38:43,319
talking about doing this using 2 mu
before arm and then I why didn't

509
00:38:43,319 --> 00:38:46,890
completely finish this research and I
drop this for a while I started looking

510
00:38:46,890 --> 00:38:51,720
into it again and i saw this new hip
thing on the Twitterverse is all the

511
00:38:51,720 --> 00:38:59,069
rage called unicorn emulator that I
started looking into this has already

512
00:38:59,069 --> 00:39:04,319
used our capstone which is a
disassembler library invites all I don't

513
00:39:04,319 --> 00:39:06,270
see any less python bindings tool

514
00:39:06,270 --> 00:39:12,630
this is from the same people i would say
the capstone qual quality leaves

515
00:39:12,630 --> 00:39:17,160
something to be desired but the effort
is great and the same goes for unicorn

516
00:39:17,160 --> 00:39:24,240
and the upcoming piece down similar
library side decided to give that a go

517
00:39:24,240 --> 00:39:26,939
and see if you could help me in any way

518
00:39:26,940 --> 00:39:32,910
so using unicorn we can really easily
spot on an emulator for for any of the

519
00:39:32,910 --> 00:39:38,970
the cpu backends that um you support and
then we can instrumental simulate to

520
00:39:38,970 --> 00:39:43,828
release me and you can do this from your
favorite languages like C but they also

521
00:39:43,829 --> 00:39:48,690
have bindings for biting go I think you
can even do it in no jazz things like

522
00:39:48,690 --> 00:39:52,170
that so I wanted to give it a go

523
00:39:52,170 --> 00:39:56,400
so make sure to check out the web page
that really awesome log on with a

524
00:39:56,400 --> 00:39:57,059
unicorn

525
00:39:57,059 --> 00:40:00,359
I mean come on that that's awesome

526
00:40:00,359 --> 00:40:07,650
so let's look a bit at the API for your
record you can you can initialize the

527
00:40:07,650 --> 00:40:13,319
emulator with literally one line of code
and then the future we need most are a

528
00:40:13,319 --> 00:40:15,808
register read register all right

529
00:40:15,809 --> 00:40:19,290
it can use this in order to initialize
some soup you register for example I

530
00:40:19,290 --> 00:40:22,829
want to call this function and now
destroyed arguments i'm going to set of

531
00:40:22,829 --> 00:40:27,900
registers with the right argument and
jump into it are of course is memory

532
00:40:27,900 --> 00:40:30,690
read and write if you need to do
introspection of the of the current

533
00:40:30,690 --> 00:40:31,390
memory image

534
00:40:31,390 --> 00:40:35,650
you can easily met new memory so you
could say are we have a memory block

535
00:40:35,650 --> 00:40:40,930
here from with this big and with these
permissions that sort of thing and then

536
00:40:40,930 --> 00:40:43,240
the really cool things you can define
hooks

537
00:40:43,240 --> 00:40:50,950
so you can set up hooks for all types of
events for that start executing a new

538
00:40:50,950 --> 00:40:56,410
basic block looks like an executor than
a memory fetch that is our map for that

539
00:40:56,410 --> 00:41:01,779
sort of thing that goes really easy to
trap where exceptions and and deal with

540
00:41:01,779 --> 00:41:08,920
with things on a high level from from
biting cards for example from see so you

541
00:41:08,920 --> 00:41:14,799
unicorn is awesome so then it was
december last year

542
00:41:15,650 --> 00:41:23,270
we travel down to Germany for a sec
conference and I already made progress

543
00:41:23,270 --> 00:41:28,940
on this project as far that i recorded
the entire algorithm but my algorithm

544
00:41:28,940 --> 00:41:34,100
recovery was a mix assembly to see
translation which look really really

545
00:41:34,100 --> 00:41:35,390
really ugly

546
00:41:35,390 --> 00:41:39,020
there was a lot of shifting and
multiplication and subtraction going on

547
00:41:39,020 --> 00:41:45,770
it's probably not like the original code
look like so it was a direct translation

548
00:41:45,770 --> 00:41:48,290
of mix assembly to see it was really
ugly

549
00:41:48,290 --> 00:41:52,279
so we're playing beer pong more night
and I know if you guys know this game

550
00:41:52,280 --> 00:41:53,570
which you have farm

551
00:41:53,570 --> 00:41:56,900
we have a table and a bunch of cops and
you should post to control a little

552
00:41:56,900 --> 00:42:01,190
ping-pong ball in in the other teams
cups and then they have to drink the

553
00:42:01,190 --> 00:42:05,720
beer it somewhere thing but we're
playing this and I charge chatting with

554
00:42:05,720 --> 00:42:09,830
this guy and yeah he doesn't want to be
credible his real name so it goes with

555
00:42:09,830 --> 00:42:14,690
poop finger I'm sorry but he offered his
help to make the secret more sane to

556
00:42:14,690 --> 00:42:20,090
play some more pong and we wrote that
code and it was done and note that so

557
00:42:20,090 --> 00:42:22,360
yeah over the course of a few bears

558
00:42:22,360 --> 00:42:28,570
UPC keys don't see it was born and this
is the the utility that around to

559
00:42:28,570 --> 00:42:31,870
recover these wpa presence

560
00:42:31,870 --> 00:42:34,870
so let's go over the culture is to a bit

561
00:42:35,410 --> 00:42:42,160
so we have is again not the most pretty
colorful but we have we have for nested

562
00:42:42,160 --> 00:42:46,830
for loops rise in order to generate a

563
00:42:46,830 --> 00:42:52,860
a serial number so you can see those the
looks of a maximum duration counter

564
00:42:52,860 --> 00:42:58,650
carefully chosen by the natural that we
have a sprint f line to construct the

565
00:42:58,650 --> 00:43:03,720
serial number based on these these these
tried and then we have to magic numbers

566
00:43:03,720 --> 00:43:09,540
depending on whether you want to crack a
240 giggles network or 5 years never

567
00:43:09,540 --> 00:43:14,250
turns out these numbers aren't really
get magical i think if you turn them

568
00:43:14,250 --> 00:43:16,320
into signed integers day

569
00:43:16,320 --> 00:43:21,300
are they actually match the frequency of
the Wi-Fi trying to correct what

570
00:43:21,300 --> 00:43:24,870
initially we assume this was a some
magic number

571
00:43:24,870 --> 00:43:28,259
someone that he might be said now that's
not magic

572
00:43:28,260 --> 00:43:32,280
let's look at the number in decimal I
fun anyway

573
00:43:32,280 --> 00:43:37,830
I'm so then the rest of the body of the
cracker - does this is initialize an mp5

574
00:43:37,830 --> 00:43:45,750
thing it copy somebody into an error
cost function which we call mango then

575
00:43:45,750 --> 00:43:52,200
it then it concatenates two numbers that
make snowman d 5 and then there's

576
00:43:52,200 --> 00:43:55,680
pressure which we call harsh to posh
spice to pass

577
00:43:56,490 --> 00:44:02,669
extra pass yeah which does the final
boss and generates the wpa two fresh

578
00:44:02,670 --> 00:44:06,480
so if you look at the manual function

579
00:44:06,480 --> 00:44:12,450
this is the rest of the fingers hard
work before before it was this short it

580
00:44:12,450 --> 00:44:16,859
was this really long a readable uncle
SI's piece of shifts obstructions and

581
00:44:16,860 --> 00:44:21,600
ads and then he's like you know this
blog of five addition as a ship that

582
00:44:21,600 --> 00:44:23,640
this is the multiplication do it

583
00:44:23,640 --> 00:44:29,160
didn't you see that I'm right now i can
see that would think so yeah we

584
00:44:29,160 --> 00:44:33,029
implement this mango routine and then
there's two more magic numbers i think

585
00:44:33,030 --> 00:44:34,440
these are actually magic

586
00:44:34,440 --> 00:44:37,830
I couldn't figure out of Eric figure out
what the numbers all right like to know

587
00:44:37,830 --> 00:44:42,509
but I think these are magic numbers then
we and then we have the arctic blast

588
00:44:42,510 --> 00:44:50,880
mention if you're generating a wpa two
parter or boss which in general you want

589
00:44:50,880 --> 00:44:55,140
to avoid certain characters of course
because they can become hard to

590
00:44:55,140 --> 00:45:00,930
distinguish when you from a paper from
the screen so whenever they encounter an

591
00:45:00,930 --> 00:45:07,080
i or an owl or now in our password they
will go to the next chair because eyes &

592
00:45:07,080 --> 00:45:11,759
L's and house are not going to check for
passwords it could be confused for zeros

593
00:45:11,760 --> 00:45:16,230
or I school be confused else or else
could be confused for eyes and it gets

594
00:45:16,230 --> 00:45:21,720
it gets really hot and they added this
routine also do some multiplication and

595
00:45:21,720 --> 00:45:27,089
some shifting which again was initially
formerly before putting stepped in and

596
00:45:27,090 --> 00:45:33,090
and worked his magic arm so i guess i
guess we could show this off

597
00:45:33,990 --> 00:45:38,759
think about the most confident live them
have ever done because it still has been

598
00:45:38,760 --> 00:45:40,170
out for months

599
00:45:40,170 --> 00:45:43,230
I have to change the line and the guts
at judge's work out

600
00:45:44,130 --> 00:45:50,970
let's see if ya but actually I my
keyword is not working can show

601
00:45:50,970 --> 00:46:00,720
okay let's see so you have you to go to
pursue keys and we run up there you go

602
00:46:01,380 --> 00:46:03,300
and I know if you look

603
00:46:03,300 --> 00:46:06,780
yeah this is the password to my home
Wi-Fi

604
00:46:06,780 --> 00:46:09,870
did you happen to drive by miles tonight

605
00:46:09,870 --> 00:46:15,210
you find this idea that looks like this
is a truck

606
00:46:15,210 --> 00:46:18,210
this posture is this the court one

607
00:46:19,410 --> 00:46:23,759
so as you can see we have a list all who

608
00:46:23,760 --> 00:46:35,580
how many is it let's see 23 possible
keys but right now i'm also i'm putting

609
00:46:35,580 --> 00:46:36,330
the

610
00:46:36,330 --> 00:46:40,860
combinations for about 24 yards and five
years if you make that distinction

611
00:46:40,860 --> 00:46:42,750
you're left with half of that

612
00:46:42,750 --> 00:46:48,450
so you have about 10 keys to try on a
wpa to protect the password for for one

613
00:46:48,450 --> 00:46:53,490
of these UPC devices now arm

614
00:46:53,490 --> 00:47:00,089
let's see saw some small wrap ups and
takeaways for you

615
00:47:00,090 --> 00:47:03,930
how much time do we still laugh i think
i have someone's materials and all alone

616
00:47:05,100 --> 00:47:08,130
78

617
00:47:08,130 --> 00:47:12,810
I've been talking to this one well okay
so don't forget to change your default

618
00:47:12,810 --> 00:47:15,450
credentials please just change them

619
00:47:15,450 --> 00:47:20,790
I see that I piece are not changing to
us a model where on initial setup of

620
00:47:20,790 --> 00:47:21,900
your device

621
00:47:21,900 --> 00:47:26,280
you're forced to set a new password
which i think is the correct way because

622
00:47:26,280 --> 00:47:31,710
apparently I don't know engineers and
then the screw up these algorithms all

623
00:47:31,710 --> 00:47:35,340
the time so you just have to force you
to change and then password

624
00:47:36,480 --> 00:47:40,410
he had don't rely on these algorithms
change your password is one of the same

625
00:47:40,410 --> 00:47:45,420
people don't be afraid of equals or
fedex works or any real time operating

626
00:47:45,420 --> 00:47:49,500
system from the point of view of a
researcher I mean and it's still machine

627
00:47:49,500 --> 00:47:54,540
card right we can peel it apart and make
sense of it was put together by human so

628
00:47:54,540 --> 00:48:00,810
it should be able to be constructed by
humans as well write our yes i do this

629
00:48:00,810 --> 00:48:03,630
forever image has a bunch more surprises

630
00:48:03,630 --> 00:48:07,060
turns out and not just the UPC is PR

631
00:48:07,060 --> 00:48:13,120
i'm using myself that as algorithms but
the same firm Ramage also contains

632
00:48:13,120 --> 00:48:15,250
algorithms for a bell

633
00:48:15,250 --> 00:48:23,560
belgian nice be I think dumb song
something true on Wi-Fi something that I

634
00:48:23,560 --> 00:48:24,580
know something there

635
00:48:24,580 --> 00:48:28,210
just got the office expansion is being
fly I have no idea

636
00:48:30,400 --> 00:48:34,060
I China as a bunch of Chinese I species
also in down

637
00:48:34,060 --> 00:48:37,150
so in one frame rate which is this for a
while

638
00:48:37,150 --> 00:48:41,260
about ten algorithms for ten different
ISPs as just that called that is not

639
00:48:41,260 --> 00:48:45,250
ever called but disease compilers are
not very good at cleaning out that the

640
00:48:45,250 --> 00:48:49,510
death card so you get all the bonus
stuff in there as well it's really need

641
00:48:49,510 --> 00:48:53,440
someone to look at it i can send you an
image I I don't have time to do all of

642
00:48:53,440 --> 00:48:58,270
these were there ya are not a small
thing

643
00:48:59,170 --> 00:49:04,480
it's kind of hard to see what you can
see here is a Raspberry Pi which has a

644
00:49:04,480 --> 00:49:06,280
small LCD screen

645
00:49:06,280 --> 00:49:10,960
technol top it's running 20 line best
script

646
00:49:10,960 --> 00:49:15,220
there is continuously looking for new
Wi-Fi networks if it finds one that

647
00:49:15,220 --> 00:49:23,709
matches you pc and then five digits are
you know recover some keys and it seems

648
00:49:23,710 --> 00:49:29,590
here that is that devices is variable to
attach a small battery and you put this

649
00:49:29,590 --> 00:49:34,480
in your backpack and then travel around
town of it and then when you get out we

650
00:49:34,480 --> 00:49:35,590
have some nice wrestles

651
00:49:35,590 --> 00:49:40,990
I only implemented the proof of culture
for this I didn't actually God and the

652
00:49:40,990 --> 00:49:43,569
ID works great it works right and it
looks fancy

653
00:49:43,570 --> 00:49:50,860
so I also set up a small our web servers
on my webpage where if you're not

654
00:49:50,860 --> 00:49:53,270
capable of compiling c code

655
00:49:53,270 --> 00:49:58,750
it could just use the web for you uh
yeah this is also a

656
00:49:58,750 --> 00:50:04,930
the provider to provider find out about
my to really early on but they're like

657
00:50:04,930 --> 00:50:07,899
this is a see file people have to
compile it you have to know about

658
00:50:07,900 --> 00:50:11,710
computers in order to use this this is
not a big business risk at all

659
00:50:12,310 --> 00:50:15,310
and then I put up the web surface

660
00:50:16,240 --> 00:50:22,569
yeah let's say that that we didn't day
there was some romo arm there was

661
00:50:23,300 --> 00:50:28,670
news posing for UPC in Austria laughing
where they manage that they mention that

662
00:50:28,670 --> 00:50:32,660
they were going to sue me for the
researcher so I tweeted the body's like

663
00:50:32,660 --> 00:50:34,069
a guys are going to sue me

664
00:50:34,070 --> 00:50:38,780
and then within an hour I an email from
you pursuing the netherlands and like I

665
00:50:38,780 --> 00:50:42,050
think there's some communication
conflict here and I want to sue you

666
00:50:42,050 --> 00:50:44,880
actually want to talk to you

667
00:50:44,880 --> 00:50:50,309
so I went over to the office and we have
been a discussion with that's in the end

668
00:50:50,309 --> 00:50:52,200
yes I can't really talk about that

669
00:50:52,200 --> 00:50:56,160
long story short that they are working
on fixing these things they are aware of

670
00:50:56,160 --> 00:50:59,910
these things is hard for them to fix
their offender that sources technology

671
00:50:59,910 --> 00:51:04,319
from favorite places and they they do
some analysis before they push it out

672
00:51:04,319 --> 00:51:08,339
but they don't have to have the
capability to in-depth analysis yet but

673
00:51:08,339 --> 00:51:10,440
they're fixing it so that's cool right

674
00:51:10,440 --> 00:51:13,300
there's another guy

675
00:51:13,300 --> 00:51:18,160
you made a similar app surface it looks
much nicer than mine he's very good at

676
00:51:18,160 --> 00:51:26,020
sees as an HTML but I figured out that
if you are at support for different

677
00:51:26,020 --> 00:51:28,120
prefixes for the serial numbers

678
00:51:28,120 --> 00:51:32,109
it also supports you bc in Germany
Austria and all those other countries

679
00:51:32,110 --> 00:51:38,290
the only difference is that they have a
different prefecture serial numbers if

680
00:51:38,290 --> 00:51:39,460
you not

681
00:51:39,460 --> 00:51:43,000
that's it if you want to contact me you
can send me an email

682
00:51:43,000 --> 00:51:47,950
I've pgp I idol and I are seized and
after

683
00:51:47,950 --> 00:51:50,950
so thanks for listenin

684
00:51:53,650 --> 00:52:09,340
yeah very entertaining any questions
from the audience got one here

685
00:52:14,619 --> 00:52:18,220
yo you know how many hours did you spend
on this

686
00:52:20,109 --> 00:52:26,019
it was a lunch break project no no and
honestly like in between work

687
00:52:26,540 --> 00:52:31,640
sometimes you get away from work I do is
for an hour but in reality it's taken

688
00:52:31,640 --> 00:52:34,970
many weeks because uh doing that many
lunch breaks

689
00:52:34,970 --> 00:52:40,759
yes I has taken some weeks and our all
on out here and and I mean between

690
00:52:40,760 --> 00:52:44,210
chatting to friends like what do you
think about it should i do I approach it

691
00:52:44,210 --> 00:52:45,530
like this should try dad

692
00:52:45,530 --> 00:52:50,000
so it's it's hard to say how many hours
it would have taken me total it

693
00:52:50,000 --> 00:52:53,210
it's a progress - it's hard to say

694
00:52:53,810 --> 00:52:56,810
yeah the other questions

695
00:52:57,950 --> 00:53:00,230
all right thank you guys

