1
00:00:07,870 --> 00:00:15,080
hello everyone yes my name is<font color="#CCCCCC"> Dmitry</font><font color="#E5E5E5"> and</font>

2
00:00:12,240 --> 00:00:18,650
<font color="#CCCCCC">mycolic and</font><font color="#E5E5E5"> I we are going to</font>

3
00:00:15,080 --> 00:00:21,759
today our<font color="#E5E5E5"> new talk hacking</font><font color="#CCCCCC"> peers PLP</font>

4
00:00:18,650 --> 00:00:26,028
system but first<font color="#E5E5E5"> of all as</font><font color="#CCCCCC"> usual give</font><font color="#E5E5E5"> me</font>

5
00:00:21,760 --> 00:00:29,029
let me say<font color="#CCCCCC"> few words about myself as you</font>

6
00:00:26,029 --> 00:00:31,340
know<font color="#E5E5E5"> my</font><font color="#CCCCCC"> name is</font><font color="#E5E5E5"> Dimitri and I'm head of</font>

7
00:00:29,029 --> 00:00:33,530
security consulting at<font color="#CCCCCC"> ERP scan company</font>

8
00:00:31,340 --> 00:00:36,560
in<font color="#E5E5E5"> earpiece cane company I'm responsible</font>

9
00:00:33,530 --> 00:00:40,090
for<font color="#E5E5E5"> security assessment penetration</font><font color="#CCCCCC"> test</font>

10
00:00:36,560 --> 00:00:42,770
and all resourcing related with

11
00:00:40,090 --> 00:00:46,820
different<font color="#E5E5E5"> ERP systems and especially</font>

12
00:00:42,770 --> 00:00:49,070
<font color="#E5E5E5">those related to ACP hi everyone my name</font>

13
00:00:46,820 --> 00:00:51,800
is<font color="#CCCCCC"> Vadim and I am skills research</font><font color="#E5E5E5"> at</font>

14
00:00:49,070 --> 00:00:53,960
viscom company<font color="#CCCCCC"> I am</font><font color="#E5E5E5"> interested at</font>

15
00:00:51,800 --> 00:00:59,390
encryption business application security

16
00:00:53,960 --> 00:01:01,940
and reverse engineering great so and few

17
00:00:59,390 --> 00:01:04,460
words<font color="#CCCCCC"> about our company as I said before</font>

18
00:01:01,940 --> 00:01:06,800
<font color="#E5E5E5">we both work for ERP scan it is a</font>

19
00:01:04,459 --> 00:01:09,500
security company with headquarters in

20
00:01:06,800 --> 00:01:11,720
Palo Alto<font color="#CCCCCC"> also have</font><font color="#E5E5E5"> offices around the</font>

21
00:01:09,500 --> 00:01:16,280
<font color="#CCCCCC">world in the</font><font color="#E5E5E5"> United States Denmark</font>

22
00:01:11,720 --> 00:01:18,160
Australia<font color="#E5E5E5"> our</font><font color="#CCCCCC"> researchers found a lot</font><font color="#E5E5E5"> of</font>

23
00:01:16,280 --> 00:01:22,190
vulnerabilities in different types of

24
00:01:18,160 --> 00:01:25,759
enterprise software<font color="#CCCCCC"> ERP system like sa P</font>

25
00:01:22,190 --> 00:01:30,530
Oracle<font color="#E5E5E5"> also we made a lot</font><font color="#CCCCCC"> of jokes about</font>

26
00:01:25,760 --> 00:01:35,000
<font color="#CCCCCC">that</font><font color="#E5E5E5"> and probably we are going to do one</font>

27
00:01:30,530 --> 00:01:37,880
more<font color="#CCCCCC"> so let's stop at</font><font color="#E5E5E5"> this slide</font><font color="#CCCCCC"> you can</font>

28
00:01:35,000 --> 00:01:39,860
<font color="#E5E5E5">see our</font><font color="#CCCCCC"> agenda for today</font><font color="#E5E5E5"> the first of</font>

29
00:01:37,880 --> 00:01:41,630
all<font color="#CCCCCC"> will make a little introduction in</font>

30
00:01:39,860 --> 00:01:43,700
point-of-sale world<font color="#E5E5E5"> after that we will</font>

31
00:01:41,630 --> 00:01:46,729
touch upon<font color="#E5E5E5"> a</font><font color="#CCCCCC"> Talks delivered by other</font>

32
00:01:43,700 --> 00:01:49,040
researchers about<font color="#E5E5E5"> POS and next</font><font color="#CCCCCC"> week will</font>

33
00:01:46,730 --> 00:01:52,190
<font color="#E5E5E5">be our motivation</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> this research why</font>

34
00:01:49,040 --> 00:01:54,110
and how we choose our<font color="#E5E5E5"> targets we also</font>

35
00:01:52,190 --> 00:01:56,720
tell you a little about the business<font color="#E5E5E5"> day</font>

36
00:01:54,110 --> 00:01:58,760
<font color="#E5E5E5">of typical store it is important because</font>

37
00:01:56,720 --> 00:02:03,640
it<font color="#E5E5E5"> is necessary for understanding how</font>

38
00:01:58,760 --> 00:02:09,229
POS works we are<font color="#E5E5E5"> going to describe</font>

39
00:02:03,640 --> 00:02:15,860
architecture of<font color="#E5E5E5"> two POS system sa PPOs</font>

40
00:02:09,229 --> 00:02:18,230
<font color="#CCCCCC">and oracle micros</font><font color="#E5E5E5"> and and of course</font><font color="#CCCCCC"> will</font>

41
00:02:15,860 --> 00:02:20,810
describe some<font color="#CCCCCC"> of our</font><font color="#E5E5E5"> findings we are</font>

42
00:02:18,230 --> 00:02:23,359
going to show<font color="#E5E5E5"> how a checker can use</font>

43
00:02:20,810 --> 00:02:25,540
these issues for<font color="#CCCCCC"> their profits and</font>

44
00:02:23,360 --> 00:02:28,860
finally we talk about solutions

45
00:02:25,540 --> 00:02:32,640
<font color="#CCCCCC">mitigation and fixes from vendor side</font>

46
00:02:28,860 --> 00:02:33,660
some conclusion world and let me start

47
00:02:32,640 --> 00:02:38,250
with<font color="#CCCCCC"> history</font>

48
00:02:33,660 --> 00:02:41,160
it was 1871<font color="#E5E5E5"> and James</font><font color="#CCCCCC"> jacket pretty</font>

49
00:02:38,250 --> 00:02:41,880
<font color="#E5E5E5">opened his first saloon but there was a</font>

50
00:02:41,160 --> 00:02:44,579
<font color="#E5E5E5">problem</font>

51
00:02:41,880 --> 00:02:46,710
some of<font color="#E5E5E5"> Rich's employees took money from</font>

52
00:02:44,580 --> 00:02:50,030
customers<font color="#E5E5E5"> and put them in their pocket</font>

53
00:02:46,710 --> 00:02:52,980
instead<font color="#CCCCCC"> of depositing</font><font color="#E5E5E5"> money indeed for</font>

54
00:02:50,030 --> 00:02:56,280
<font color="#CCCCCC">for paying for food drinks and</font><font color="#E5E5E5"> other</font>

55
00:02:52,980 --> 00:02:58,320
<font color="#E5E5E5">goals so that's why James invented a</font>

56
00:02:56,280 --> 00:03:02,340
<font color="#E5E5E5">mechanism that could record the cash</font>

57
00:02:58,320 --> 00:03:05,250
transaction made at his saloon<font color="#E5E5E5"> you can</font>

58
00:03:02,340 --> 00:03:07,320
see how this invention looks on the

59
00:03:05,250 --> 00:03:10,650
right part<font color="#E5E5E5"> of this light because on the</font>

60
00:03:07,320 --> 00:03:13,470
<font color="#E5E5E5">left part of the slide you can see James</font>

61
00:03:10,650 --> 00:03:16,680
yeah<font color="#E5E5E5"> it looks like this invention looks</font>

62
00:03:13,470 --> 00:03:18,120
like<font color="#CCCCCC"> a clock</font><font color="#E5E5E5"> with keyboard the main idea</font>

63
00:03:16,680 --> 00:03:21,180
was<font color="#E5E5E5"> then when customer made a purchase</font>

64
00:03:18,120 --> 00:03:24,120
the<font color="#CCCCCC"> Cassiar must push a special button</font>

65
00:03:21,180 --> 00:03:27,230
<font color="#CCCCCC">with a price and then at time at the</font>

66
00:03:24,120 --> 00:03:29,970
clock<font color="#E5E5E5"> increased at the</font><font color="#CCCCCC"> end of the day</font>

67
00:03:27,230 --> 00:03:35,518
<font color="#E5E5E5">Jacob could compare the amount of money</font>

68
00:03:29,970 --> 00:03:38,459
from cash box with<font color="#CCCCCC"> vindication</font><font color="#E5E5E5"> on this</font>

69
00:03:35,519 --> 00:03:41,580
clock<font color="#CCCCCC"> so of</font><font color="#E5E5E5"> course the system was</font><font color="#CCCCCC"> not</font>

70
00:03:38,459 --> 00:03:44,430
ideal because tricky seller could only

71
00:03:41,580 --> 00:03:46,920
pretend that<font color="#CCCCCC"> he uses</font><font color="#E5E5E5"> the cash register</font>

72
00:03:44,430 --> 00:03:50,790
or click<font color="#CCCCCC"> on the button with</font><font color="#E5E5E5"> a lower</font>

73
00:03:46,920 --> 00:03:54,298
<font color="#E5E5E5">price and when no one saw he acted even</font>

74
00:03:50,790 --> 00:03:56,340
<font color="#E5E5E5">easier she just moved</font><font color="#CCCCCC"> the arrows back so</font>

75
00:03:54,299 --> 00:03:58,950
this story<font color="#E5E5E5"> is an excellent example that</font>

76
00:03:56,340 --> 00:04:01,230
you<font color="#E5E5E5"> should</font><font color="#CCCCCC"> add it to the security of</font>

77
00:03:58,950 --> 00:04:04,768
<font color="#E5E5E5">such system horizon from</font><font color="#CCCCCC"> the very</font>

78
00:04:01,230 --> 00:04:06,660
beginning<font color="#E5E5E5"> of their existence so in</font><font color="#CCCCCC"> our</font>

79
00:04:04,769 --> 00:04:08,810
days point-of-sale system is a

80
00:04:06,660 --> 00:04:10,829
<font color="#CCCCCC">combination of hardware and software</font>

81
00:04:08,810 --> 00:04:13,980
<font color="#CCCCCC">that allows merchants to take</font>

82
00:04:10,830 --> 00:04:16,950
transaction<font color="#E5E5E5"> and simplified de</font><font color="#CCCCCC"> natal a</font>

83
00:04:13,980 --> 00:04:21,570
key<font color="#E5E5E5"> business operations the most</font>

84
00:04:16,950 --> 00:04:24,630
familiar example of POS system will be

85
00:04:21,570 --> 00:04:27,120
the checkout<font color="#CCCCCC"> counter at retail</font><font color="#E5E5E5"> or</font>

86
00:04:24,630 --> 00:04:29,310
grocery store<font color="#E5E5E5"> however there are many</font>

87
00:04:27,120 --> 00:04:31,020
<font color="#E5E5E5">more forms of point-of-sale systems used</font>

88
00:04:29,310 --> 00:04:36,479
in<font color="#E5E5E5"> many business types like restaurant</font>

89
00:04:31,020 --> 00:04:39,359
<font color="#E5E5E5">casinos hotels etc probably all of you</font>

90
00:04:36,479 --> 00:04:42,570
saw these devices<font color="#CCCCCC"> but what about</font>

91
00:04:39,360 --> 00:04:45,180
security<font color="#E5E5E5"> is a digital actual problem</font>

92
00:04:42,570 --> 00:04:47,159
if<font color="#E5E5E5"> Google about</font><font color="#CCCCCC"> POS hacking we will</font>

93
00:04:45,180 --> 00:04:51,660
<font color="#E5E5E5">return us a lot of results about hacking</font>

94
00:04:47,160 --> 00:04:55,110
POS terminals as a<font color="#E5E5E5"> hardware device but</font>

95
00:04:51,660 --> 00:04:57,210
not about<font color="#CCCCCC"> cache or workstation</font><font color="#E5E5E5"> we</font>

96
00:04:55,110 --> 00:04:59,490
<font color="#E5E5E5">decided to check some of this previous</font>

97
00:04:57,210 --> 00:05:06,150
works some<font color="#E5E5E5"> of non-research have been</font>

98
00:04:59,490 --> 00:05:09,780
made in<font color="#CCCCCC"> 200 2012-2016</font><font color="#E5E5E5"> let's do a quick</font>

99
00:05:06,150 --> 00:05:11,849
tour through this<font color="#E5E5E5"> most interesting talks</font>

100
00:05:09,780 --> 00:05:13,590
<font color="#E5E5E5">and we start with</font><font color="#CCCCCC"> Lukas</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> choice key</font>

101
00:05:11,850 --> 00:05:17,400
who presented his research<font color="#E5E5E5"> at blackhat</font>

102
00:05:13,590 --> 00:05:20,520
<font color="#E5E5E5">years 2014 he analyzed small and large</font>

103
00:05:17,400 --> 00:05:23,370
incidents<font color="#E5E5E5"> and demonstrated that</font><font color="#CCCCCC"> endeavor</font>

104
00:05:20,520 --> 00:05:26,159
<font color="#CCCCCC">stated that some security problems with</font>

105
00:05:23,370 --> 00:05:28,860
POS devices for example<font color="#CCCCCC"> he showed that</font>

106
00:05:26,160 --> 00:05:30,890
<font color="#E5E5E5">next stripe cards contain unencrypted</font>

107
00:05:28,860 --> 00:05:34,740
<font color="#CCCCCC">insensitivity data as it can be easily</font>

108
00:05:30,890 --> 00:05:37,110
<font color="#CCCCCC">cloned or</font><font color="#E5E5E5"> EMV chip contains make stripe</font>

109
00:05:34,740 --> 00:05:40,770
equivalent that data are encrypted<font color="#E5E5E5"> and</font>

110
00:05:37,110 --> 00:05:43,020
can be dumped<font color="#CCCCCC"> by a checker</font><font color="#E5E5E5"> from</font><font color="#CCCCCC"> RAM the</font>

111
00:05:40,770 --> 00:05:44,940
another research after<font color="#CCCCCC"> it by</font><font color="#E5E5E5"> eros</font>

112
00:05:43,020 --> 00:05:49,590
<font color="#E5E5E5">Anderson and the same at the</font><font color="#CCCCCC"> same they</font>

113
00:05:44,940 --> 00:05:53,010
had us 2014 he wrote about<font color="#E5E5E5"> the relay</font>

114
00:05:49,590 --> 00:05:56,789
attack of 2007 and no peanut hack an

115
00:05:53,010 --> 00:05:59,099
attacker could control terminal<font color="#E5E5E5"> and as a</font>

116
00:05:56,790 --> 00:06:02,760
result trick the<font color="#E5E5E5"> card and terminal and</font>

117
00:05:59,100 --> 00:06:05,850
provide a transaction next<font color="#E5E5E5"> Niels and</font>

118
00:06:02,760 --> 00:06:08,430
John Butler<font color="#E5E5E5"> gained a great result in</font>

119
00:06:05,850 --> 00:06:10,500
hacking<font color="#CCCCCC"> peers terminal</font><font color="#E5E5E5"> they found a lot</font>

120
00:06:08,430 --> 00:06:13,080
of default password and<font color="#CCCCCC"> hard core</font>

121
00:06:10,500 --> 00:06:15,120
credentials<font color="#CCCCCC"> a code execution in context</font>

122
00:06:13,080 --> 00:06:17,609
of payment application and control

123
00:06:15,120 --> 00:06:19,350
anything in POS terminal they can

124
00:06:17,610 --> 00:06:21,420
<font color="#E5E5E5">applaud</font><font color="#CCCCCC"> and execute malicious code on</font>

125
00:06:19,350 --> 00:06:23,820
terminal<font color="#E5E5E5"> using USB or Bluetooth</font>

126
00:06:21,420 --> 00:06:26,460
connection and additionally can do

127
00:06:23,820 --> 00:06:28,640
anything using<font color="#CCCCCC"> Ian the</font><font color="#E5E5E5"> card and deck</font>

128
00:06:26,460 --> 00:06:31,289
batter<font color="#CCCCCC"> floor vulnerability</font>

129
00:06:28,640 --> 00:06:34,020
<font color="#CCCCCC">Peter</font><font color="#E5E5E5"> feel more in his research said</font>

130
00:06:31,290 --> 00:06:38,040
<font color="#CCCCCC">about clone cards</font><font color="#E5E5E5"> clone transaction and</font>

131
00:06:34,020 --> 00:06:40,500
a payment<font color="#E5E5E5"> transaction flow as a result</font>

132
00:06:38,040 --> 00:06:42,420
<font color="#E5E5E5">he said that we can't clone card</font>

133
00:06:40,500 --> 00:06:46,320
economically<font color="#E5E5E5"> but we can clone</font>

134
00:06:42,420 --> 00:06:48,690
transactions<font color="#E5E5E5"> and finally star milk</font>

135
00:06:46,320 --> 00:06:50,969
<font color="#E5E5E5">Jessica and his talk hacking challenge</font>

136
00:06:48,690 --> 00:06:54,419
steal a<font color="#E5E5E5"> car it</font><font color="#CCCCCC"> was not clear from</font><font color="#E5E5E5"> the</font>

137
00:06:50,970 --> 00:06:56,220
<font color="#E5E5E5">talk name but Jessica wrote presented</font>

138
00:06:54,419 --> 00:06:58,469
interesting to<font color="#E5E5E5"> JJ</font>

139
00:06:56,220 --> 00:07:00,870
<font color="#CCCCCC">she tracking tool for men in</font><font color="#E5E5E5"> the middle</font>

140
00:06:58,470 --> 00:07:02,430
<font color="#E5E5E5">attack against Bluetooth connections one</font>

141
00:07:00,870 --> 00:07:04,980
of the possibilities is to make<font color="#E5E5E5"> a</font><font color="#CCCCCC"> man's</font>

142
00:07:02,430 --> 00:07:07,290
<font color="#E5E5E5">me to attack against mobile POS device</font>

143
00:07:04,980 --> 00:07:12,350
and<font color="#E5E5E5"> sniffs in</font><font color="#CCCCCC"> TV information at</font><font color="#E5E5E5"> this</font>

144
00:07:07,290 --> 00:07:14,520
<font color="#CCCCCC">light</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> can see a screenshot from</font>

145
00:07:12,350 --> 00:07:18,030
demonstration of<font color="#E5E5E5"> this type</font><font color="#CCCCCC"> of man in the</font>

146
00:07:14,520 --> 00:07:19,950
<font color="#E5E5E5">middle attack so I taught me some words</font>

147
00:07:18,030 --> 00:07:22,799
about why did we choose pure software

148
00:07:19,950 --> 00:07:26,130
<font color="#E5E5E5">for our research</font><font color="#CCCCCC"> runs off of expression</font>

149
00:07:22,800 --> 00:07:29,940
is structure and architecture of<font color="#CCCCCC"> various</font>

150
00:07:26,130 --> 00:07:32,250
payment<font color="#E5E5E5"> processing here it is so the</font>

151
00:07:29,940 --> 00:07:34,890
first consigners swipe where cars on

152
00:07:32,250 --> 00:07:37,470
periods devices to purchase goods<font color="#E5E5E5"> and</font>

153
00:07:34,890 --> 00:07:41,909
services repairs devices and credit card

154
00:07:37,470 --> 00:07:45,450
data to<font color="#E5E5E5"> POS system secondly</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> POS system</font>

155
00:07:41,910 --> 00:07:49,260
contact<font color="#E5E5E5"> payment service provider which</font>

156
00:07:45,450 --> 00:07:52,680
contact<font color="#CCCCCC"> to acquires dependent or credit</font>

157
00:07:49,260 --> 00:07:56,340
card<font color="#E5E5E5"> brand or type was used when</font>

158
00:07:52,680 --> 00:07:59,520
acquires<font color="#E5E5E5"> use the credit card network to</font>

159
00:07:56,340 --> 00:08:02,580
contact<font color="#E5E5E5"> great card issuers issue certain</font>

160
00:07:59,520 --> 00:08:06,390
transition status to acquires<font color="#E5E5E5"> via card</font>

161
00:08:02,580 --> 00:08:09,599
brands<font color="#CCCCCC"> network finally requires</font><font color="#E5E5E5"> then</font>

162
00:08:06,390 --> 00:08:12,150
pass on the authorization to PSP<font color="#E5E5E5"> who</font>

163
00:08:09,600 --> 00:08:15,470
falls into<font color="#E5E5E5"> POS system and periods</font>

164
00:08:12,150 --> 00:08:17,729
devices which complete<font color="#E5E5E5"> and reduction</font>

165
00:08:15,470 --> 00:08:21,240
<font color="#CCCCCC">risking occasion occurs in a matter of</font>

166
00:08:17,730 --> 00:08:24,600
seconds<font color="#E5E5E5"> so what do we have</font><font color="#CCCCCC"> now</font><font color="#E5E5E5"> this is</font>

167
00:08:21,240 --> 00:08:26,550
<font color="#CCCCCC">plainly</font><font color="#E5E5E5"> processing all connections here</font>

168
00:08:24,600 --> 00:08:29,370
are encrypted<font color="#E5E5E5"> and general scoochie level</font>

169
00:08:26,550 --> 00:08:34,110
is<font color="#E5E5E5"> rather high but</font><font color="#CCCCCC"> where s part is not</font>

170
00:08:29,370 --> 00:08:38,370
so fortified works<font color="#E5E5E5"> we have mentioned</font><font color="#CCCCCC"> are</font>

171
00:08:34,110 --> 00:08:41,339
near here and here and<font color="#CCCCCC"> before</font><font color="#E5E5E5"> what will</font>

172
00:08:38,370 --> 00:08:44,360
<font color="#CCCCCC">be if you try to attack</font><font color="#E5E5E5"> not consumers or</font>

173
00:08:41,339 --> 00:08:47,610
<font color="#E5E5E5">terminals but the back end</font><font color="#CCCCCC"> of POS system</font>

174
00:08:44,360 --> 00:08:51,390
what will be if you can manipulate

175
00:08:47,610 --> 00:08:53,250
prices or<font color="#E5E5E5"> settings</font><font color="#CCCCCC"> could be very</font>

176
00:08:51,390 --> 00:08:55,620
interesting<font color="#CCCCCC"> cause pain information was</font>

177
00:08:53,250 --> 00:09:01,350
not just through terminals but<font color="#E5E5E5"> PS</font>

178
00:08:55,620 --> 00:09:03,420
software to show<font color="#CCCCCC"> so I think some was</font>

179
00:09:01,350 --> 00:09:07,860
about business<font color="#E5E5E5"> day for based</font><font color="#CCCCCC"> on the</font>

180
00:09:03,420 --> 00:09:09,260
<font color="#E5E5E5">stallion of</font><font color="#CCCCCC"> protests every day the store</font>

181
00:09:07,860 --> 00:09:12,740
manager<font color="#E5E5E5"> opens</font>

182
00:09:09,260 --> 00:09:18,410
a store then<font color="#CCCCCC"> a manager opens terminals</font>

183
00:09:12,740 --> 00:09:24,230
<font color="#E5E5E5">and which get updates and information</font>

184
00:09:18,410 --> 00:09:27,620
<font color="#E5E5E5">for a server so after that business day</font>

185
00:09:24,230 --> 00:09:30,770
begins<font color="#CCCCCC"> junuh day all transformation goes</font>

186
00:09:27,620 --> 00:09:34,970
through a terminal<font color="#E5E5E5"> like logs receives</font>

187
00:09:30,770 --> 00:09:37,279
returns cache entry and<font color="#CCCCCC"> hour</font><font color="#E5E5E5"> so at the</font>

188
00:09:34,970 --> 00:09:40,310
end<font color="#E5E5E5"> of the day when Ranger closes</font>

189
00:09:37,279 --> 00:09:43,430
terminals terminals<font color="#CCCCCC"> sent log information</font>

190
00:09:40,310 --> 00:09:45,890
<font color="#CCCCCC">to the server and the</font><font color="#E5E5E5"> ninja closes the</font>

191
00:09:43,430 --> 00:09:49,399
store and no transaction can<font color="#CCCCCC"> be done</font>

192
00:09:45,890 --> 00:09:53,569
<font color="#E5E5E5">until the stores closed so how did we</font>

193
00:09:49,399 --> 00:09:56,089
<font color="#E5E5E5">choose PS system this top pane contains</font>

194
00:09:53,570 --> 00:09:59,060
<font color="#E5E5E5">at the same time large and mid-sized</font>

195
00:09:56,089 --> 00:10:02,899
<font color="#E5E5E5">period software vendors we decided to</font>

196
00:09:59,060 --> 00:10:07,910
check<font color="#CCCCCC"> Rogers first and we choose a city</font>

197
00:10:02,899 --> 00:10:10,130
<font color="#E5E5E5">company</font><font color="#CCCCCC"> SAT is a worldwide leader in</font>

198
00:10:07,910 --> 00:10:12,709
enterprise<font color="#E5E5E5"> applications in terms of</font>

199
00:10:10,130 --> 00:10:15,320
<font color="#CCCCCC">software and software</font><font color="#E5E5E5"> related service</font>

200
00:10:12,709 --> 00:10:17,170
revenue based on<font color="#E5E5E5"> market capitalization</font>

201
00:10:15,320 --> 00:10:22,190
wherever world's third largest

202
00:10:17,170 --> 00:10:26,689
independent software<font color="#CCCCCC"> manufacturer so who</font>

203
00:10:22,190 --> 00:10:29,740
is SAT<font color="#E5E5E5"> POS my description from SAT side</font>

204
00:10:26,690 --> 00:10:33,140
says that<font color="#CCCCCC"> it's client-server</font>

205
00:10:29,740 --> 00:10:35,209
point-of-sale solution known as<font color="#E5E5E5"> traverse</font>

206
00:10:33,140 --> 00:10:41,270
the transaction where prior to its

207
00:10:35,209 --> 00:10:44,029
acquisition by<font color="#E5E5E5"> a CD in 2005 SPPs meets</font>

208
00:10:41,270 --> 00:10:47,029
the needs of a wild<font color="#CCCCCC"> variety of retailers</font>

209
00:10:44,029 --> 00:10:49,959
<font color="#E5E5E5">with the benefits of our 50 years or for</font>

210
00:10:47,029 --> 00:10:53,140
final<font color="#CCCCCC"> development and customization</font>

211
00:10:49,959 --> 00:10:56,829
<font color="#E5E5E5">retail customers include the partner</font><font color="#CCCCCC"> gas</font>

212
00:10:53,140 --> 00:10:59,480
big<font color="#E5E5E5"> box and other or tail verticals</font>

213
00:10:56,829 --> 00:11:02,060
additionally the solution is offered

214
00:10:59,480 --> 00:11:04,670
with powerful back office applications

215
00:11:02,060 --> 00:11:10,130
for in-depth store manager

216
00:11:04,670 --> 00:11:12,770
management and reporting<font color="#E5E5E5"> this is POS</font><font color="#CCCCCC"> se</font>

217
00:11:10,130 --> 00:11:15,439
<font color="#CCCCCC">PPS architecture instead of a</font><font color="#E5E5E5"> typical</font>

218
00:11:12,770 --> 00:11:18,319
for<font color="#CCCCCC"> the point-of-sale solutions it</font>

219
00:11:15,440 --> 00:11:21,000
consists of point-of-sale client

220
00:11:18,320 --> 00:11:24,440
applications running on the

221
00:11:21,000 --> 00:11:28,440
front<font color="#E5E5E5"> office to process POS transactions</font>

222
00:11:24,440 --> 00:11:31,200
so server applications<font color="#CCCCCC"> when</font><font color="#E5E5E5"> stores back</font>

223
00:11:28,440 --> 00:11:35,690
office<font color="#CCCCCC"> to serve connective operative and</font>

224
00:11:31,200 --> 00:11:39,270
administrative needs and so configurator

225
00:11:35,690 --> 00:11:42,150
application run in the<font color="#E5E5E5"> head office</font><font color="#CCCCCC"> to a</font>

226
00:11:39,270 --> 00:11:45,810
low central configuration<font color="#CCCCCC"> we didn't</font>

227
00:11:42,150 --> 00:11:51,840
<font color="#E5E5E5">check mobile point-of-sale system so our</font>

228
00:11:45,810 --> 00:11:54,780
architecture was like this and at this

229
00:11:51,840 --> 00:11:58,920
<font color="#CCCCCC">flight you can see how POS terminal</font>

230
00:11:54,780 --> 00:12:02,400
<font color="#E5E5E5">looks like</font><font color="#CCCCCC"> a cashier and manager</font>

231
00:11:58,920 --> 00:12:06,599
functions general<font color="#E5E5E5"> information window</font><font color="#CCCCCC"> in</font>

232
00:12:02,400 --> 00:12:11,370
<font color="#CCCCCC">tutoria instructions</font><font color="#E5E5E5"> receipt Arya and</font>

233
00:12:06,600 --> 00:12:15,750
total<font color="#CCCCCC"> stops</font><font color="#E5E5E5"> Turia</font><font color="#CCCCCC"> so it's cashiers</font><font color="#E5E5E5"> and</font>

234
00:12:11,370 --> 00:12:16,830
ranges who use these functions<font color="#E5E5E5"> this</font>

235
00:12:15,750 --> 00:12:19,560
extra<font color="#E5E5E5"> store</font>

236
00:12:16,830 --> 00:12:22,530
looks like<font color="#E5E5E5"> administrator can start and</font>

237
00:12:19,560 --> 00:12:25,560
stop<font color="#CCCCCC"> it's</font><font color="#E5E5E5"> the server application look</font>

238
00:12:22,530 --> 00:12:28,980
for current actions and configure backup

239
00:12:25,560 --> 00:12:31,589
service and<font color="#E5E5E5"> the</font><font color="#CCCCCC"> back complications this</font>

240
00:12:28,980 --> 00:12:35,850
extra server<font color="#E5E5E5"> should be always</font><font color="#CCCCCC"> on for</font>

241
00:12:31,589 --> 00:12:38,089
<font color="#CCCCCC">called SCP POS more so this is store</font>

242
00:12:35,850 --> 00:12:41,280
manager there are several units like

243
00:12:38,089 --> 00:12:47,040
administration<font color="#E5E5E5"> family instance and</font>

244
00:12:41,280 --> 00:12:52,890
others which<font color="#CCCCCC"> tour manager can configure</font>

245
00:12:47,040 --> 00:12:56,400
to<font color="#E5E5E5"> set store settings oh this is</font><font color="#CCCCCC"> toe</font>

246
00:12:52,890 --> 00:12:59,640
configurator<font color="#CCCCCC"> whereas some mean with</font>

247
00:12:56,400 --> 00:13:02,130
submenu where<font color="#E5E5E5"> region administrator can</font>

248
00:12:59,640 --> 00:13:03,930
change parameters after<font color="#CCCCCC"> the</font>

249
00:13:02,130 --> 00:13:06,060
configuration administrator<font color="#E5E5E5"> converts</font>

250
00:13:03,930 --> 00:13:09,120
settings to special files with with

251
00:13:06,060 --> 00:13:13,670
<font color="#E5E5E5">button so let's go deeper</font>

252
00:13:09,120 --> 00:13:18,540
- SVP place system and<font color="#CCCCCC"> without plan</font>

253
00:13:13,670 --> 00:13:22,770
so our first part is processing<font color="#CCCCCC"> between</font>

254
00:13:18,540 --> 00:13:25,980
a head<font color="#E5E5E5"> office and store server after</font>

255
00:13:22,770 --> 00:13:28,350
<font color="#CCCCCC">that we'll discuss</font><font color="#E5E5E5"> communication inside</font>

256
00:13:25,980 --> 00:13:31,800
so server between database<font color="#CCCCCC"> store manager</font>

257
00:13:28,350 --> 00:13:34,790
and access server<font color="#E5E5E5"> and the last part will</font>

258
00:13:31,800 --> 00:13:39,030
be<font color="#CCCCCC"> pairs</font><font color="#E5E5E5"> client and extra server</font>

259
00:13:34,790 --> 00:13:41,939
so so configurator<font color="#E5E5E5"> is an application</font>

260
00:13:39,030 --> 00:13:45,089
used by administrator to configure

261
00:13:41,940 --> 00:13:49,470
<font color="#E5E5E5">everything please the intention a belief</font>

262
00:13:45,090 --> 00:13:52,410
in in<font color="#E5E5E5"> a CPS system like users term of</font>

263
00:13:49,470 --> 00:13:57,320
the parents security settings and<font color="#E5E5E5"> hours</font>

264
00:13:52,410 --> 00:13:57,319
<font color="#E5E5E5">so using a pretty nice interface</font>

265
00:13:57,470 --> 00:14:04,080
condensator can converse can set every

266
00:14:00,780 --> 00:14:05,970
settings and parameters<font color="#E5E5E5"> he wants after</font>

267
00:14:04,080 --> 00:14:08,520
web configurator converts the settings

268
00:14:05,970 --> 00:14:11,820
into special files safe<font color="#CCCCCC"> when in</font>

269
00:14:08,520 --> 00:14:15,600
paramdham<font color="#E5E5E5"> tree and create a new file</font>

270
00:14:11,820 --> 00:14:17,990
with name new part<font color="#E5E5E5"> of gog uncertain</font>

271
00:14:15,600 --> 00:14:21,120
needs to copy this file to<font color="#CCCCCC"> extras server</font>

272
00:14:17,990 --> 00:14:24,020
<font color="#CCCCCC">we know the file new part of</font><font color="#E5E5E5"> gog</font>

273
00:14:21,120 --> 00:14:26,280
especially because it's like a trigger

274
00:14:24,020 --> 00:14:28,770
<font color="#CCCCCC">explosive application search with file</font>

275
00:14:26,280 --> 00:14:31,910
in Perm<font color="#CCCCCC"> lib through every 30</font><font color="#E5E5E5"> seconds and</font>

276
00:14:28,770 --> 00:14:34,470
if it finds it<font color="#E5E5E5"> through the file then all</font>

277
00:14:31,910 --> 00:14:37,469
parameter files will be<font color="#E5E5E5"> checked for</font>

278
00:14:34,470 --> 00:14:40,530
updates and applied after<font color="#CCCCCC"> it's server</font>

279
00:14:37,470 --> 00:14:44,610
delete<font color="#E5E5E5"> new part of th e file and is</font>

280
00:14:40,530 --> 00:14:47,730
waiting<font color="#E5E5E5"> for well now with you so this</font><font color="#CCCCCC"> is</font>

281
00:14:44,610 --> 00:14:51,150
<font color="#E5E5E5">extra server file key texture</font><font color="#CCCCCC"> here you</font>

282
00:14:47,730 --> 00:14:53,280
can see<font color="#CCCCCC"> sign directory and where is the</font>

283
00:14:51,150 --> 00:14:56,840
parent directory here where are some

284
00:14:53,280 --> 00:15:01,110
files<font color="#E5E5E5"> configure files like</font><font color="#CCCCCC"> Sheila</font><font color="#E5E5E5"> mask</font>

285
00:14:56,840 --> 00:15:04,440
<font color="#CCCCCC">cache</font><font color="#E5E5E5"> and oil for example file</font><font color="#CCCCCC"> synonym</font>

286
00:15:01,110 --> 00:15:07,140
mask contains credit card<font color="#E5E5E5"> mask in your</font>

287
00:15:04,440 --> 00:15:09,840
<font color="#E5E5E5">seat</font><font color="#CCCCCC"> Cashel file contains information</font>

288
00:15:07,140 --> 00:15:13,010
<font color="#CCCCCC">about cashiers and managers and</font><font color="#E5E5E5"> Louis</font>

289
00:15:09,840 --> 00:15:16,860
with personal<font color="#E5E5E5"> data and credentials</font>

290
00:15:13,010 --> 00:15:19,410
layout describes appearance of a

291
00:15:16,860 --> 00:15:20,270
point-of-sale terminals so all

292
00:15:19,410 --> 00:15:23,819
<font color="#CCCCCC">parameters from</font><font color="#E5E5E5"> a</font>

293
00:15:20,270 --> 00:15:26,660
<font color="#E5E5E5">configurator</font><font color="#CCCCCC"> a new</font><font color="#E5E5E5"> city needs to copy</font>

294
00:15:23,820 --> 00:15:30,810
here in<font color="#CCCCCC"> punitively</font>

295
00:15:26,660 --> 00:15:33,420
here we<font color="#CCCCCC"> had part two</font><font color="#E5E5E5"> so</font>

296
00:15:30,810 --> 00:15:34,500
<font color="#E5E5E5">store manager is application use the</font>

297
00:15:33,420 --> 00:15:37,050
configure

298
00:15:34,500 --> 00:15:39,270
store settings so we<font color="#E5E5E5"> can divide all</font>

299
00:15:37,050 --> 00:15:43,079
possible functions on two parts by<font color="#CCCCCC"> using</font>

300
00:15:39,270 --> 00:15:45,540
ports<font color="#E5E5E5"> the first one is database port so</font>

301
00:15:43,080 --> 00:15:47,870
so manager resembles Vesto configurator

302
00:15:45,540 --> 00:15:53,459
<font color="#CCCCCC">at this part but if you</font>

303
00:15:47,870 --> 00:15:57,450
database and interacts all changes in it

304
00:15:53,460 --> 00:15:59,880
and the second part is poor<font color="#CCCCCC"> 22:02 we</font>

305
00:15:57,450 --> 00:16:02,580
found it when we scan<font color="#CCCCCC"> explore several</font>

306
00:15:59,880 --> 00:16:06,689
<font color="#CCCCCC">ports</font><font color="#E5E5E5"> and check the stands user</font>

307
00:16:02,580 --> 00:16:08,910
interface<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is Tom manger we go to a</font>

308
00:16:06,690 --> 00:16:12,240
new station menu then to store

309
00:16:08,910 --> 00:16:15,380
administration<font color="#E5E5E5"> and we will see all</font>

310
00:16:12,240 --> 00:16:19,170
terminals connected to our<font color="#CCCCCC"> x2 server</font>

311
00:16:15,380 --> 00:16:22,860
<font color="#CCCCCC">there are some functions like open/close</font>

312
00:16:19,170 --> 00:16:25,319
<font color="#CCCCCC">monitor turtles and round end of day so</font>

313
00:16:22,860 --> 00:16:29,070
let's click on<font color="#E5E5E5"> monitor terminal button</font>

314
00:16:25,320 --> 00:16:30,920
and<font color="#CCCCCC"> make the transaction</font><font color="#E5E5E5"> all information</font>

315
00:16:29,070 --> 00:16:35,220
<font color="#E5E5E5">about transaction appears at this window</font>

316
00:16:30,920 --> 00:16:39,060
so<font color="#E5E5E5"> it's looks like</font><font color="#CCCCCC"> we received we</font>

317
00:16:35,220 --> 00:16:42,840
capture traffic and<font color="#E5E5E5"> s remember report is</font>

318
00:16:39,060 --> 00:16:44,550
<font color="#CCCCCC">22:02 and with all search in the</font>

319
00:16:42,840 --> 00:16:48,000
connotation shows that<font color="#E5E5E5"> it's talent</font>

320
00:16:44,550 --> 00:16:50,430
protocol it seems that store manager

321
00:16:48,000 --> 00:16:53,280
just sent a text<font color="#CCCCCC"> comment like monitor</font>

322
00:16:50,430 --> 00:16:56,849
terminal<font color="#CCCCCC"> seven</font><font color="#E5E5E5"> star and receives POS</font>

323
00:16:53,280 --> 00:16:59,850
terminals data<font color="#E5E5E5"> in</font><font color="#CCCCCC"> she's produced a</font>

324
00:16:56,850 --> 00:17:02,840
<font color="#CCCCCC">parasternal</font><font color="#E5E5E5"> data so try to connect with</font>

325
00:16:59,850 --> 00:17:07,650
<font color="#CCCCCC">sport using telnet</font><font color="#E5E5E5"> and here</font><font color="#CCCCCC"> we are</font>

326
00:17:02,840 --> 00:17:10,370
<font color="#E5E5E5">iterative it responds us with a</font><font color="#CCCCCC"> welcome</font>

327
00:17:07,650 --> 00:17:13,320
message and<font color="#E5E5E5"> with</font><font color="#CCCCCC"> point of sale built</font>

328
00:17:10,369 --> 00:17:16,800
we sent a help comment<font color="#E5E5E5"> it shows us</font>

329
00:17:13,319 --> 00:17:19,619
possible functions<font color="#CCCCCC"> where are our 17</font><font color="#E5E5E5"> the</font>

330
00:17:16,800 --> 00:17:23,669
most interesting are<font color="#E5E5E5"> open terminal open</font>

331
00:17:19,619 --> 00:17:25,889
store<font color="#CCCCCC"> close terminal</font><font color="#E5E5E5"> shorter</font><font color="#CCCCCC"> no and</font><font color="#E5E5E5"> shut</font>

332
00:17:23,670 --> 00:17:29,370
<font color="#CCCCCC">down I think there is</font><font color="#E5E5E5"> no need to</font><font color="#CCCCCC"> explain</font>

333
00:17:25,890 --> 00:17:33,180
<font color="#CCCCCC">what is this functions</font><font color="#E5E5E5"> Lucas is clear</font>

334
00:17:29,370 --> 00:17:43,560
from<font color="#CCCCCC"> where name and let's look a little</font>

335
00:17:33,180 --> 00:17:45,840
<font color="#E5E5E5">demo</font><font color="#CCCCCC"> so here you</font><font color="#E5E5E5"> can see we made a</font>

336
00:17:43,560 --> 00:17:51,740
talent connection to the extra server

337
00:17:45,840 --> 00:17:55,919
<font color="#E5E5E5">when we push a help common there are 17</font>

338
00:17:51,740 --> 00:18:00,870
functions<font color="#E5E5E5"> after</font><font color="#CCCCCC"> that we type show all</font>

339
00:17:55,920 --> 00:18:01,540
<font color="#CCCCCC">turns</font><font color="#E5E5E5"> and we receive our free connected</font>

340
00:18:00,870 --> 00:18:05,560
terminal

341
00:18:01,540 --> 00:18:06,280
and one is<font color="#E5E5E5"> online so we should get your</font>

342
00:18:05,560 --> 00:18:11,830
number

343
00:18:06,280 --> 00:18:15,220
1010<font color="#E5E5E5"> with terminal</font><font color="#CCCCCC"> number is seven so we</font>

344
00:18:11,830 --> 00:18:19,689
push<font color="#CCCCCC"> Moines of terminal comment and then</font>

345
00:18:15,220 --> 00:18:20,610
purchase<font color="#E5E5E5"> something as I remember it's my</font>

346
00:18:19,690 --> 00:18:25,890
<font color="#E5E5E5">book</font>

347
00:18:20,610 --> 00:18:25,889
yep so this part

348
00:18:26,050 --> 00:18:32,820
kasher<font color="#E5E5E5"> scan barcode and information</font>

349
00:18:29,590 --> 00:18:39,990
<font color="#CCCCCC">about the item appears at our terminal</font>

350
00:18:32,820 --> 00:18:46,540
so then cashier finished a transaction

351
00:18:39,990 --> 00:18:50,050
<font color="#CCCCCC">and she will swipe</font><font color="#E5E5E5"> a card and here we</font>

352
00:18:46,540 --> 00:18:50,710
<font color="#E5E5E5">can see all information will seek on our</font>

353
00:18:50,050 --> 00:18:55,090
<font color="#E5E5E5">terminal</font>

354
00:18:50,710 --> 00:18:59,950
we<font color="#E5E5E5"> founding application and mechanism so</font>

355
00:18:55,090 --> 00:19:02,350
<font color="#E5E5E5">with yep after that we started searching</font>

356
00:18:59,950 --> 00:19:07,210
for<font color="#E5E5E5"> any special and stick with functions</font>

357
00:19:02,350 --> 00:19:11,070
methods and<font color="#CCCCCC"> backdoors and</font><font color="#E5E5E5"> found with</font><font color="#CCCCCC"> its</font>

358
00:19:07,210 --> 00:19:15,460
<font color="#E5E5E5">to store procedures in database with</font>

359
00:19:11,070 --> 00:19:19,629
which create a default user with<font color="#E5E5E5"> name</font>

360
00:19:15,460 --> 00:19:22,030
back and password or and<font color="#E5E5E5"> it's funny but</font>

361
00:19:19,630 --> 00:19:26,170
we are not talking<font color="#CCCCCC"> about recent</font><font color="#E5E5E5"> we made</font>

362
00:19:22,030 --> 00:19:31,050
realest of XPS file<font color="#E5E5E5"> it was not so hard</font>

363
00:19:26,170 --> 00:19:35,490
to<font color="#E5E5E5"> find functions control</font><font color="#CCCCCC"> poor 22:02</font>

364
00:19:31,050 --> 00:19:40,330
using comma<font color="#CCCCCC"> return from health common</font>

365
00:19:35,490 --> 00:19:43,780
<font color="#E5E5E5">there are 74 methods with the same</font>

366
00:19:40,330 --> 00:19:46,179
<font color="#E5E5E5">structure in opposite of 17 showing in</font>

367
00:19:43,780 --> 00:19:48,940
help return there is no information

368
00:19:46,180 --> 00:19:51,900
<font color="#CCCCCC">about them in</font><font color="#E5E5E5"> official documents and</font>

369
00:19:48,940 --> 00:19:53,890
search<font color="#CCCCCC"> they but not all web works</font><font color="#E5E5E5"> file</font>

370
00:19:51,900 --> 00:19:57,040
we are talking<font color="#CCCCCC"> about the</font><font color="#E5E5E5"> most</font>

371
00:19:53,890 --> 00:20:00,850
interesting<font color="#E5E5E5"> and working</font><font color="#CCCCCC"> so the first</font>

372
00:19:57,040 --> 00:20:07,500
<font color="#E5E5E5">comment is a p.m.</font><font color="#CCCCCC"> validate password is</font>

373
00:20:00,850 --> 00:20:10,480
comment<font color="#CCCCCC"> allow to</font><font color="#E5E5E5"> believe to validate</font>

374
00:20:07,500 --> 00:20:13,750
<font color="#E5E5E5">cashiers or managers credentials</font>

375
00:20:10,480 --> 00:20:15,309
it returns<font color="#E5E5E5"> three different responses so</font>

376
00:20:13,750 --> 00:20:18,570
<font color="#CCCCCC">0</font><font color="#E5E5E5"> for correct password</font>

377
00:20:15,309 --> 00:20:21,850
and Logan<font color="#CCCCCC"> one for</font><font color="#E5E5E5"> incorrect password and</font>

378
00:20:18,570 --> 00:20:27,009
one zero<font color="#CCCCCC"> well there is no user with such</font>

379
00:20:21,850 --> 00:20:30,610
Logan it's clear that anybody can just

380
00:20:27,009 --> 00:20:36,840
<font color="#E5E5E5">blue</font><font color="#CCCCCC"> Cash's credentials or</font><font color="#E5E5E5"> manager</font>

381
00:20:30,610 --> 00:20:41,350
potentials at<font color="#CCCCCC"> got access</font><font color="#E5E5E5"> to POS terminal</font>

382
00:20:36,840 --> 00:20:44,259
locally but not remote<font color="#CCCCCC"> we hate brutes so</font>

383
00:20:41,350 --> 00:20:49,049
that's why I want to<font color="#E5E5E5"> now a function like</font>

384
00:20:44,259 --> 00:20:53,169
<font color="#CCCCCC">ap and reset password this function just</font>

385
00:20:49,049 --> 00:20:58,720
change<font color="#E5E5E5"> cashiers password</font><font color="#CCCCCC"> without any</font>

386
00:20:53,169 --> 00:21:01,919
<font color="#E5E5E5">authentication mechanism so we can just</font>

387
00:20:58,720 --> 00:21:04,960
<font color="#E5E5E5">change it and get access to the system</font>

388
00:21:01,919 --> 00:21:07,899
<font color="#E5E5E5">well how interesting part method</font><font color="#CCCCCC"> bar is</font>

389
00:21:04,960 --> 00:21:09,990
file operations we can<font color="#CCCCCC"> read files on</font>

390
00:21:07,899 --> 00:21:14,789
server using file open<font color="#E5E5E5"> and five read</font>

391
00:21:09,990 --> 00:21:17,259
functions where is no relation so we

392
00:21:14,789 --> 00:21:20,799
even type a file open comment and

393
00:21:17,259 --> 00:21:25,360
receives file ID and after<font color="#E5E5E5"> that we can</font>

394
00:21:20,799 --> 00:21:40,929
use this ID to read file content so see

395
00:21:25,360 --> 00:21:46,090
another demo<font color="#E5E5E5"> okay so here we connect to</font>

396
00:21:40,929 --> 00:21:51,059
telnet port at extra servers and we have

397
00:21:46,090 --> 00:21:56,918
a user with<font color="#E5E5E5"> login</font><font color="#CCCCCC"> number four four</font><font color="#E5E5E5"> four</font>

398
00:21:51,059 --> 00:21:58,869
password seven eight a so it turns out

399
00:21:56,919 --> 00:22:04,299
<font color="#E5E5E5">zero code</font><font color="#CCCCCC"> recent letters are right</font>

400
00:21:58,869 --> 00:22:10,709
correct we<font color="#E5E5E5"> sent another message with a</font>

401
00:22:04,299 --> 00:22:10,710
password<font color="#E5E5E5"> but with wrong password and</font>

402
00:22:13,320 --> 00:22:16,320
yeah

403
00:22:17,930 --> 00:22:25,280
it<font color="#CCCCCC"> turns us one foot</font><font color="#E5E5E5"> so it's the</font>

404
00:22:22,140 --> 00:22:30,320
<font color="#E5E5E5">password is</font><font color="#CCCCCC"> incorrect</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> Zack</font><font color="#E5E5E5"> you can</font>

405
00:22:25,280 --> 00:22:35,160
assume<font color="#E5E5E5"> blue or credentials you know</font>

406
00:22:30,320 --> 00:22:39,689
which I enter<font color="#E5E5E5"> but you use</font><font color="#CCCCCC"> it that</font>

407
00:22:35,160 --> 00:22:43,350
doesn't<font color="#E5E5E5"> exist after server it turns 1 0</font>

408
00:22:39,690 --> 00:22:46,740
code<font color="#E5E5E5"> yep</font>

409
00:22:43,350 --> 00:22:53,340
what is now a part as I said we<font color="#E5E5E5"> can just</font>

410
00:22:46,740 --> 00:22:55,880
reset password yeah yeah<font color="#E5E5E5"> so we connect</font>

411
00:22:53,340 --> 00:23:01,020
the extra server from<font color="#E5E5E5"> our local machine</font>

412
00:22:55,880 --> 00:23:04,160
this<font color="#E5E5E5"> is a terminal window at this part</font>

413
00:23:01,020 --> 00:23:10,530
we show that<font color="#CCCCCC"> relations are right</font>

414
00:23:04,160 --> 00:23:13,650
password is a tape a paid a so we

415
00:23:10,530 --> 00:23:18,300
connect to a server and<font color="#E5E5E5"> we set password</font>

416
00:23:13,650 --> 00:23:20,450
<font color="#CCCCCC">on ours</font><font color="#E5E5E5"> like change p1 or</font><font color="#CCCCCC"> something like</font>

417
00:23:18,300 --> 00:23:20,450
this

418
00:23:27,630 --> 00:23:38,180
<font color="#E5E5E5">he</font><font color="#CCCCCC"> turns zero so our</font><font color="#E5E5E5"> Commons was</font>

419
00:23:31,860 --> 00:23:42,050
insecure now we can enter<font color="#CCCCCC"> for four and</font>

420
00:23:38,180 --> 00:23:42,050
enter our new password

421
00:23:47,180 --> 00:24:00,550
sopia<font color="#CCCCCC"> we fully control the SS terminal</font>

422
00:23:51,670 --> 00:24:02,930
yeah<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> great so let's talk</font><font color="#CCCCCC"> about</font>

423
00:24:00,550 --> 00:24:05,800
communication between<font color="#E5E5E5"> cashier</font>

424
00:24:02,930 --> 00:24:08,120
workstation and<font color="#CCCCCC"> tour server</font>

425
00:24:05,800 --> 00:24:12,200
POS client connect to the store server

426
00:24:08,120 --> 00:24:14,360
<font color="#E5E5E5">and talks of it using port number</font><font color="#CCCCCC"> 22</font>

427
00:24:12,200 --> 00:24:16,460
<font color="#CCCCCC">Double L all information like</font>

428
00:24:14,360 --> 00:24:18,740
<font color="#E5E5E5">transaction configuration and</font>

429
00:24:16,460 --> 00:24:21,440
maintenance data is transfer including

430
00:24:18,740 --> 00:24:24,260
this port at the beginning of<font color="#E5E5E5"> the day</font>

431
00:24:21,440 --> 00:24:26,480
when store manager opens terminal<font color="#CCCCCC"> it</font>

432
00:24:24,260 --> 00:24:28,940
sends a request something<font color="#E5E5E5"> like hey</font>

433
00:24:26,480 --> 00:24:31,370
server<font color="#CCCCCC"> wake</font><font color="#E5E5E5"> up sent me new parameters</font>

434
00:24:28,940 --> 00:24:34,670
price changes<font color="#E5E5E5"> sales information</font><font color="#CCCCCC"> new</font>

435
00:24:31,370 --> 00:24:37,360
discounts etc<font color="#E5E5E5"> at the</font><font color="#CCCCCC"> end of the day when</font>

436
00:24:34,670 --> 00:24:39,830
manager<font color="#CCCCCC"> close terminal and</font><font color="#E5E5E5"> close store</font>

437
00:24:37,360 --> 00:24:43,280
<font color="#E5E5E5">POS workstation sends log file to</font><font color="#CCCCCC"> the</font>

438
00:24:39,830 --> 00:24:46,100
server this process called<font color="#CCCCCC"> polling and</font>

439
00:24:43,280 --> 00:24:49,220
of course right after<font color="#E5E5E5"> each purchase the</font>

440
00:24:46,100 --> 00:24:51,919
POS client send data about this purchase

441
00:24:49,220 --> 00:24:55,460
to<font color="#E5E5E5"> the server so we captured traffic</font>

442
00:24:51,920 --> 00:24:57,320
between POS client and PS server during

443
00:24:55,460 --> 00:25:00,260
the polling<font color="#E5E5E5"> process and</font><font color="#CCCCCC"> discovered</font><font color="#E5E5E5"> an</font>

444
00:24:57,320 --> 00:25:02,000
<font color="#E5E5E5">interesting thing as I said before</font>

445
00:25:00,260 --> 00:25:05,030
during the polling process

446
00:25:02,000 --> 00:25:08,120
POS clients since<font color="#E5E5E5"> logs to the server and</font>

447
00:25:05,030 --> 00:25:09,680
also<font color="#E5E5E5"> download new parameters we notice</font>

448
00:25:08,120 --> 00:25:12,530
that packet with<font color="#CCCCCC"> parameters requests</font>

449
00:25:09,680 --> 00:25:14,600
looks like that packet contains<font color="#E5E5E5"> type of</font>

450
00:25:12,530 --> 00:25:17,389
<font color="#E5E5E5">request length and information about</font>

451
00:25:14,600 --> 00:25:20,330
<font color="#E5E5E5">what</font><font color="#CCCCCC"> filed POS server should return</font><font color="#E5E5E5"> in</font>

452
00:25:17,390 --> 00:25:22,940
response and what is<font color="#CCCCCC"> interesting that</font><font color="#E5E5E5"> is</font>

453
00:25:20,330 --> 00:25:26,090
there no information relate with session

454
00:25:22,940 --> 00:25:28,550
or authentication we repeated this

455
00:25:26,090 --> 00:25:31,669
<font color="#E5E5E5">request from</font><font color="#CCCCCC"> non-terminal computer and</font>

456
00:25:28,550 --> 00:25:35,000
it returns<font color="#E5E5E5"> the same result</font><font color="#CCCCCC"> it means that</font>

457
00:25:31,670 --> 00:25:38,560
there is an authentication between<font color="#E5E5E5"> POS</font>

458
00:25:35,000 --> 00:25:41,800
client POS workstation<font color="#E5E5E5"> and POS server</font>

459
00:25:38,560 --> 00:25:44,810
<font color="#E5E5E5">after</font><font color="#CCCCCC"> some experiments we got working</font>

460
00:25:41,800 --> 00:25:48,470
<font color="#E5E5E5">POC</font><font color="#CCCCCC"> for reading any file</font><font color="#E5E5E5"> from the</font>

461
00:25:44,810 --> 00:25:50,960
<font color="#E5E5E5">service file system protocol</font><font color="#CCCCCC"> result as</font>

462
00:25:48,470 --> 00:25:53,870
that<font color="#E5E5E5"> our possibilities are much more</font>

463
00:25:50,960 --> 00:25:55,780
than<font color="#CCCCCC"> just reading to the files on this</font>

464
00:25:53,870 --> 00:25:59,929
<font color="#E5E5E5">slide you</font><font color="#CCCCCC"> can see the</font><font color="#E5E5E5"> different type of</font>

465
00:25:55,780 --> 00:26:00,450
messages that<font color="#E5E5E5"> POS client can send to the</font>

466
00:25:59,930 --> 00:26:06,049
<font color="#E5E5E5">server</font>

467
00:26:00,450 --> 00:26:06,049
for example we can write<font color="#CCCCCC"> articles</font><font color="#E5E5E5"> server</font>

468
00:26:06,230 --> 00:26:10,320
from that we must send home these three

469
00:26:09,179 --> 00:26:13,440
packets

470
00:26:10,320 --> 00:26:15,899
the first one is<font color="#E5E5E5"> s type request which</font>

471
00:26:13,440 --> 00:26:18,659
contains packet rails file<font color="#E5E5E5"> path on the</font>

472
00:26:15,899 --> 00:26:21,869
Express server where we<font color="#E5E5E5"> write our data</font>

473
00:26:18,659 --> 00:26:25,590
<font color="#E5E5E5">in size of sending</font><font color="#CCCCCC"> data the second one</font>

474
00:26:21,869 --> 00:26:28,649
is<font color="#E5E5E5"> F type packet this packet contains</font>

475
00:26:25,590 --> 00:26:32,220
length<font color="#CCCCCC"> in</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> and data that</font><font color="#E5E5E5"> we want</font><font color="#CCCCCC"> to</font>

476
00:26:28,649 --> 00:26:35,729
write to the server<font color="#E5E5E5"> right and finally</font>

477
00:26:32,220 --> 00:26:38,220
the third packet this<font color="#E5E5E5"> packet sit i</font>

478
00:26:35,730 --> 00:26:40,830
packet means end of file transmission

479
00:26:38,220 --> 00:26:43,159
and after that Express<font color="#CCCCCC"> sever handle</font>

480
00:26:40,830 --> 00:26:45,649
<font color="#E5E5E5">request a new file appears on the server</font>

481
00:26:43,159 --> 00:26:49,609
<font color="#CCCCCC">if everything was</font><font color="#E5E5E5"> correct</font>

482
00:26:45,649 --> 00:26:53,158
<font color="#E5E5E5">Sarah will send G type good message</font>

483
00:26:49,609 --> 00:26:58,139
interesting thing this<font color="#E5E5E5"> interesting this</font>

484
00:26:53,159 --> 00:27:00,239
is if we send a packet with incorrect

485
00:26:58,139 --> 00:27:03,109
length information<font color="#E5E5E5"> Express error will</font>

486
00:27:00,239 --> 00:27:06,840
delete the file specified in the packet

487
00:27:03,109 --> 00:27:09,840
<font color="#CCCCCC">to resume</font><font color="#E5E5E5"> an attacker can use port</font>

488
00:27:06,840 --> 00:27:12,320
number 22<font color="#E5E5E5"> double</font><font color="#CCCCCC"> o for communication</font>

489
00:27:09,840 --> 00:27:14,730
with SP POS server for<font color="#E5E5E5"> applauding</font>

490
00:27:12,320 --> 00:27:17,850
<font color="#E5E5E5">downloading and the leading path on the</font>

491
00:27:14,730 --> 00:27:19,710
server<font color="#E5E5E5"> without any authentication let me</font>

492
00:27:17,850 --> 00:27:22,070
show you a quick demonstration of<font color="#E5E5E5"> these</font>

493
00:27:19,710 --> 00:27:22,070
possibilities

494
00:27:30,149 --> 00:27:37,619
so<font color="#E5E5E5"> there's a file system</font><font color="#CCCCCC"> directory on</font>

495
00:27:35,459 --> 00:27:40,799
<font color="#E5E5E5">the Express server there is a checker</font>

496
00:27:37,619 --> 00:27:45,089
console<font color="#E5E5E5"> now we can just send those</font>

497
00:27:40,799 --> 00:27:50,849
requests<font color="#E5E5E5"> and we got new file on</font><font color="#CCCCCC"> the</font>

498
00:27:45,089 --> 00:27:53,579
<font color="#E5E5E5">server with hello world any</font><font color="#CCCCCC"> okay now we</font>

499
00:27:50,849 --> 00:27:58,109
can<font color="#E5E5E5"> read this file for</font><font color="#CCCCCC"> that we can</font><font color="#E5E5E5"> send</font>

500
00:27:53,579 --> 00:28:02,729
another<font color="#CCCCCC"> request yes we got</font><font color="#E5E5E5"> a response</font>

501
00:27:58,109 --> 00:28:06,899
<font color="#E5E5E5">hello world and finally we can</font>

502
00:28:02,729 --> 00:28:14,249
manipulate<font color="#CCCCCC"> we can delete the file for</font>

503
00:28:06,899 --> 00:28:19,008
that<font color="#E5E5E5"> we can send</font><font color="#CCCCCC"> another request yeah</font>

504
00:28:14,249 --> 00:28:21,689
so that's how we can<font color="#E5E5E5"> manipulate files</font>

505
00:28:19,009 --> 00:28:25,879
remotely without<font color="#CCCCCC"> modification</font><font color="#E5E5E5"> it's</font>

506
00:28:21,689 --> 00:28:25,879
really important<font color="#E5E5E5"> because on the files</font>

507
00:28:26,239 --> 00:28:35,339
files<font color="#CCCCCC"> really</font><font color="#E5E5E5"> base for all things in SP</font>

508
00:28:31,109 --> 00:28:37,799
POS now as far as store manager

509
00:28:35,339 --> 00:28:40,589
connection with<font color="#CCCCCC"> Express POS sir is not</font>

510
00:28:37,799 --> 00:28:43,289
validating peers client connection<font color="#E5E5E5"> are</font>

511
00:28:40,589 --> 00:28:46,289
miserable<font color="#CCCCCC"> aiding to it</font><font color="#E5E5E5"> means we</font><font color="#CCCCCC"> have now</font>

512
00:28:43,289 --> 00:28:49,709
to<font color="#CCCCCC"> vernel</font><font color="#E5E5E5"> abilities let's see what can</font>

513
00:28:46,289 --> 00:28:51,749
we do<font color="#E5E5E5"> if we mix them the</font><font color="#CCCCCC"> next</font><font color="#E5E5E5"> part of</font>

514
00:28:49,709 --> 00:28:55,289
<font color="#E5E5E5">our talk</font><font color="#CCCCCC"> contains some little thoughts</font>

515
00:28:51,749 --> 00:28:56,959
about possible<font color="#E5E5E5"> attack scenarios but</font>

516
00:28:55,289 --> 00:29:00,389
before that let me<font color="#E5E5E5"> show you</font>

517
00:28:56,959 --> 00:29:03,739
typical<font color="#E5E5E5"> common store</font><font color="#CCCCCC"> architecture</font><font color="#E5E5E5"> there</font>

518
00:29:00,389 --> 00:29:07,019
is a store server and POS client in<font color="#E5E5E5"> you</font>

519
00:29:03,739 --> 00:29:09,689
in additional<font color="#E5E5E5"> to that there are some</font>

520
00:29:07,019 --> 00:29:13,219
local peripheral device like barcode

521
00:29:09,689 --> 00:29:15,989
readers<font color="#CCCCCC"> waves card readers</font><font color="#E5E5E5"> and others</font>

522
00:29:13,219 --> 00:29:17,939
some<font color="#E5E5E5"> of these device like</font><font color="#CCCCCC"> waves can be</font>

523
00:29:15,989 --> 00:29:21,059
accessible for customers and for

524
00:29:17,939 --> 00:29:24,269
attackers<font color="#E5E5E5"> - how can I check</font><font color="#CCCCCC"> your use</font>

525
00:29:21,059 --> 00:29:26,519
them<font color="#E5E5E5"> of course and a checker can use</font>

526
00:29:24,269 --> 00:29:31,829
them for gaining<font color="#E5E5E5"> access</font><font color="#CCCCCC"> to internal</font>

527
00:29:26,519 --> 00:29:34,739
store<font color="#CCCCCC"> network like here you can see that</font>

528
00:29:31,829 --> 00:29:42,649
network cable<font color="#E5E5E5"> cables are available for</font>

529
00:29:34,739 --> 00:29:42,649
an attacker all right here or like that

530
00:29:43,399 --> 00:29:49,198
very very<font color="#E5E5E5"> good gonna check us so it</font>

531
00:29:47,039 --> 00:29:51,209
means that<font color="#CCCCCC"> we had access</font><font color="#E5E5E5"> to the store</font>

532
00:29:49,199 --> 00:29:54,569
network<font color="#CCCCCC"> shouldn't</font><font color="#E5E5E5"> be a big</font><font color="#CCCCCC"> problem for</font>

533
00:29:51,209 --> 00:29:58,009
<font color="#E5E5E5">an attacker or I took this picture</font>

534
00:29:54,569 --> 00:30:00,779
<font color="#E5E5E5">yesterday</font><font color="#CCCCCC"> during speaker party I</font>

535
00:29:58,009 --> 00:30:05,279
probably I can get access<font color="#E5E5E5"> to the POS</font>

536
00:30:00,779 --> 00:30:10,829
system easily<font color="#CCCCCC"> as last resort an attacker</font>

537
00:30:05,279 --> 00:30:13,289
<font color="#E5E5E5">can get a job as a cashier</font><font color="#CCCCCC"> of avec ok</font>

538
00:30:10,829 --> 00:30:16,198
<font color="#E5E5E5">for their attacks</font><font color="#CCCCCC"> an attacker can simply</font>

539
00:30:13,289 --> 00:30:19,199
replace device like<font color="#CCCCCC"> weight by his</font>

540
00:30:16,199 --> 00:30:23,639
malicious malicious<font color="#CCCCCC"> Raspberry Pi</font><font color="#E5E5E5"> and</font>

541
00:30:19,199 --> 00:30:26,669
make some fun<font color="#E5E5E5"> so we are inside and work</font>

542
00:30:23,639 --> 00:30:29,309
<font color="#E5E5E5">what is next but first of all let me</font>

543
00:30:26,669 --> 00:30:33,419
<font color="#E5E5E5">remember you some facts</font><font color="#CCCCCC"> so what do we</font>

544
00:30:29,309 --> 00:30:35,489
<font color="#E5E5E5">have now we know that first</font><font color="#CCCCCC"> of all store</font>

545
00:30:33,419 --> 00:30:38,759
configurator creates configuration file

546
00:30:35,489 --> 00:30:42,749
<font color="#CCCCCC">an express server will apply them</font><font color="#E5E5E5"> if it</font>

547
00:30:38,759 --> 00:30:46,169
find a new party<font color="#CCCCCC"> re-trigger file second</font>

548
00:30:42,749 --> 00:30:50,489
we can write any data we want in any

549
00:30:46,169 --> 00:30:54,089
file on<font color="#E5E5E5"> Express server using port 2 2 0</font>

550
00:30:50,489 --> 00:30:57,689
0<font color="#CCCCCC"> third POS workstation update</font><font color="#E5E5E5"> the</font>

551
00:30:54,089 --> 00:31:00,539
parameters<font color="#E5E5E5"> after opening and finally we</font>

552
00:30:57,689 --> 00:31:06,419
<font color="#E5E5E5">can close and open POS workstation using</font>

553
00:31:00,539 --> 00:31:09,779
<font color="#E5E5E5">telnet port 2 2 0 2 and what do we need</font>

554
00:31:06,419 --> 00:31:11,609
<font color="#E5E5E5">is it as an access to the local local</font>

555
00:31:09,779 --> 00:31:14,519
network<font color="#E5E5E5"> and you saw that is not a</font>

556
00:31:11,609 --> 00:31:17,639
problem so the whole scheme<font color="#E5E5E5"> of attack</font>

557
00:31:14,519 --> 00:31:19,589
works like this<font color="#CCCCCC"> in a checker rice</font>

558
00:31:17,639 --> 00:31:22,889
<font color="#E5E5E5">configuration file that he was on</font>

559
00:31:19,589 --> 00:31:24,749
Express server using port 2200

560
00:31:22,889 --> 00:31:25,168
configuration file could<font color="#E5E5E5"> be</font><font color="#CCCCCC"> very</font>

561
00:31:24,749 --> 00:31:27,779
different

562
00:31:25,169 --> 00:31:31,259
it could be credit card<font color="#E5E5E5"> mask it item</font>

563
00:31:27,779 --> 00:31:33,779
price or a new discount<font color="#E5E5E5"> after</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> and a</font>

564
00:31:31,259 --> 00:31:37,069
checker<font color="#E5E5E5"> writes new palm TRG file on</font>

565
00:31:33,779 --> 00:31:39,929
Express server using the<font color="#E5E5E5"> same for 2200</font>

566
00:31:37,069 --> 00:31:43,199
<font color="#CCCCCC">Express</font><font color="#E5E5E5"> Sarah finds the trigger file and</font>

567
00:31:39,929 --> 00:31:45,779
applies<font color="#E5E5E5"> new</font><font color="#CCCCCC"> attacker settings</font><font color="#E5E5E5"> some of</font>

568
00:31:43,199 --> 00:31:48,869
this is written as<font color="#CCCCCC"> writes in database</font>

569
00:31:45,779 --> 00:31:51,149
like<font color="#E5E5E5"> prom information for example after</font>

570
00:31:48,869 --> 00:31:53,938
<font color="#CCCCCC">that an attacker</font><font color="#E5E5E5"> needs to deliver new</font>

571
00:31:51,149 --> 00:31:55,370
settings to<font color="#CCCCCC"> the cache server stations</font>

572
00:31:53,939 --> 00:31:57,710
and for that

573
00:31:55,370 --> 00:32:00,620
<font color="#CCCCCC">she sends a</font><font color="#E5E5E5"> close term message on</font>

574
00:31:57,710 --> 00:32:03,500
<font color="#CCCCCC">express</font><font color="#E5E5E5"> several telnet port as an option</font>

575
00:32:00,620 --> 00:32:06,530
<font color="#E5E5E5">he can just wait until the end of</font>

576
00:32:03,500 --> 00:32:09,050
business day after<font color="#CCCCCC"> getting closed</font>

577
00:32:06,530 --> 00:32:11,860
<font color="#E5E5E5">journal comment Express server</font><font color="#CCCCCC"> sends a</font>

578
00:32:09,050 --> 00:32:14,480
closing request to POS workstations

579
00:32:11,860 --> 00:32:16,699
after that an attacker sends an open

580
00:32:14,480 --> 00:32:19,370
chair message on<font color="#E5E5E5"> Express several</font>

581
00:32:16,700 --> 00:32:21,760
challenge<font color="#E5E5E5"> but again</font><font color="#CCCCCC"> and Express server</font>

582
00:32:19,370 --> 00:32:24,500
application opens POS workstations

583
00:32:21,760 --> 00:32:26,960
during opening process<font color="#E5E5E5"> POS workstation</font>

584
00:32:24,500 --> 00:32:30,170
<font color="#CCCCCC">sent requests</font><font color="#E5E5E5"> to Express server and</font>

585
00:32:26,960 --> 00:32:33,860
download checklist settings and apply

586
00:32:30,170 --> 00:32:37,130
<font color="#E5E5E5">them so that's all we can</font><font color="#CCCCCC"> control almost</font>

587
00:32:33,860 --> 00:32:39,889
<font color="#CCCCCC">every parameter in SP POS system</font><font color="#E5E5E5"> by by</font>

588
00:32:37,130 --> 00:32:42,020
this way<font color="#E5E5E5"> for example we can change price</font>

589
00:32:39,890 --> 00:32:46,250
for any item or create special discount

590
00:32:42,020 --> 00:32:48,290
for us but we know all<font color="#CCCCCC"> of</font><font color="#E5E5E5"> you likes</font>

591
00:32:46,250 --> 00:32:49,970
remote<font color="#CCCCCC"> komal execution</font><font color="#E5E5E5"> and what is the</font>

592
00:32:48,290 --> 00:32:51,800
back if there are no remote<font color="#CCCCCC"> coding</font>

593
00:32:49,970 --> 00:32:54,050
<font color="#E5E5E5">confusion and</font><font color="#CCCCCC"> you're</font><font color="#E5E5E5"> right</font>

594
00:32:51,800 --> 00:32:58,159
we are the same<font color="#E5E5E5"> way that's why we found</font>

595
00:32:54,050 --> 00:32:59,990
<font color="#E5E5E5">one more interesting detail actually</font>

596
00:32:58,160 --> 00:33:01,370
<font color="#CCCCCC">remote code execution will be a big</font>

597
00:32:59,990 --> 00:33:04,840
<font color="#E5E5E5">problem in case</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> Linux operating</font>

598
00:33:01,370 --> 00:33:07,489
system using this file upload<font color="#CCCCCC"> and</font>

599
00:33:04,840 --> 00:33:10,370
vulnerability<font color="#CCCCCC"> an attacker can add new</font>

600
00:33:07,490 --> 00:33:14,240
SSH keys and use them<font color="#CCCCCC"> for getting SSH</font>

601
00:33:10,370 --> 00:33:16,729
access but<font color="#CCCCCC"> SPPs works only in</font><font color="#E5E5E5"> Windows</font>

602
00:33:14,240 --> 00:33:18,920
environment but<font color="#E5E5E5"> we notice that when</font>

603
00:33:16,730 --> 00:33:22,270
Express server application starts or

604
00:33:18,920 --> 00:33:26,990
updates parameters its search for

605
00:33:22,270 --> 00:33:30,800
experiment bhe and<font color="#CCCCCC"> stop TN dot exe files</font>

606
00:33:26,990 --> 00:33:33,020
<font color="#CCCCCC">and if they exist it will execute them</font>

607
00:33:30,800 --> 00:33:35,930
<font color="#E5E5E5">and nothing can stop</font><font color="#CCCCCC"> us now from</font>

608
00:33:33,020 --> 00:33:39,770
applauding shell and getting full

609
00:33:35,930 --> 00:33:43,280
control of Express server so the whole

610
00:33:39,770 --> 00:33:45,770
vector<font color="#CCCCCC"> forgetting shell is we write x PS</font>

611
00:33:43,280 --> 00:33:47,600
<font color="#E5E5E5">param dot PHP file with</font><font color="#CCCCCC"> back connect</font>

612
00:33:45,770 --> 00:33:50,930
comments in the main<font color="#E5E5E5"> Express server</font>

613
00:33:47,600 --> 00:33:53,949
directory<font color="#E5E5E5"> we write new</font><font color="#CCCCCC"> prime dot GOG</font><font color="#E5E5E5"> in</font>

614
00:33:50,930 --> 00:33:56,990
<font color="#CCCCCC">current directory for triggering</font><font color="#E5E5E5"> a blaze</font>

615
00:33:53,950 --> 00:33:59,360
<font color="#E5E5E5">after that we are waiting for 30 seconds</font>

616
00:33:56,990 --> 00:34:01,820
until Express server finds the trigger

617
00:33:59,360 --> 00:34:05,600
file after that<font color="#CCCCCC"> express or deletes</font>

618
00:34:01,820 --> 00:34:08,529
<font color="#E5E5E5">trigger file search</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> XPS param dot</font>

619
00:34:05,600 --> 00:34:10,569
PHP file<font color="#E5E5E5"> and execute</font><font color="#CCCCCC"> it</font>

620
00:34:08,530 --> 00:34:12,669
we have written a<font color="#E5E5E5"> river</font><font color="#CCCCCC"> cell so Express</font>

621
00:34:10,570 --> 00:34:15,490
server makes a bad connection to<font color="#CCCCCC"> our</font>

622
00:34:12,668 --> 00:34:17,379
specified<font color="#E5E5E5"> IP address and port number now</font>

623
00:34:15,489 --> 00:34:23,408
we can send any comment that we want and

624
00:34:17,379 --> 00:34:24,879
<font color="#CCCCCC">we fully control ASAP POS server</font><font color="#E5E5E5"> now let</font>

625
00:34:23,409 --> 00:34:27,940
<font color="#E5E5E5">me show you a full demonstration how an</font>

626
00:34:24,879 --> 00:34:47,040
attacker can buy a new MacBook<font color="#E5E5E5"> Pro for</font>

627
00:34:27,940 --> 00:34:47,040
<font color="#E5E5E5">$3 nope yes so</font>

628
00:34:50,639 --> 00:35:00,640
there is a POS workstation<font color="#E5E5E5"> and let us</font>

629
00:34:55,418 --> 00:35:03,700
make<font color="#CCCCCC"> a</font><font color="#E5E5E5"> common purchase</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> kasher</font>

630
00:35:00,640 --> 00:35:05,890
should scan barcode and you get

631
00:35:03,700 --> 00:35:10,169
<font color="#E5E5E5">information about price in</font><font color="#CCCCCC"> our case</font>

632
00:35:05,890 --> 00:35:15,790
microprobe cost almost<font color="#E5E5E5"> $900</font>

633
00:35:10,170 --> 00:35:20,530
now<font color="#CCCCCC"> buyer</font><font color="#E5E5E5"> give them give a to cash or</font>

634
00:35:15,790 --> 00:35:25,840
their credit<font color="#E5E5E5"> card swipe credit card cash</font>

635
00:35:20,530 --> 00:35:30,760
or approve this purchase<font color="#E5E5E5"> and that's all</font>

636
00:35:25,840 --> 00:35:34,540
everything is fine now let me<font color="#CCCCCC"> show how</font>

637
00:35:30,760 --> 00:35:39,640
<font color="#E5E5E5">any checker can do this purchase but</font>

638
00:35:34,540 --> 00:35:45,100
before that he needs to<font color="#CCCCCC"> compromise</font><font color="#E5E5E5"> plus</font>

639
00:35:39,640 --> 00:35:48,970
client<font color="#E5E5E5"> so here we have a checkers screen</font>

640
00:35:45,100 --> 00:35:51,220
and three<font color="#CCCCCC"> windows from that way one</font>

641
00:35:48,970 --> 00:35:54,399
<font color="#E5E5E5">windows is waiting</font><font color="#CCCCCC"> at least in port 1 3</font>

642
00:35:51,220 --> 00:35:58,209
3 7<font color="#E5E5E5"> and waiting for she'll forever</font><font color="#CCCCCC"> shell</font>

643
00:35:54,400 --> 00:36:02,040
another one on the port 1 3<font color="#CCCCCC"> 3 8 this</font><font color="#E5E5E5"> is</font>

644
00:35:58,210 --> 00:36:06,540
<font color="#E5E5E5">port is waiting for credit cards</font><font color="#CCCCCC"> and</font>

645
00:36:02,040 --> 00:36:12,310
there is a output from our malicious

646
00:36:06,540 --> 00:36:16,270
<font color="#CCCCCC">raspberry pi and when a check and when</font>

647
00:36:12,310 --> 00:36:21,160
an attacker<font color="#E5E5E5"> connect this</font><font color="#CCCCCC"> Raspberry Pi to</font>

648
00:36:16,270 --> 00:36:25,930
<font color="#E5E5E5">the internal network this</font><font color="#CCCCCC"> our our script</font>

649
00:36:21,160 --> 00:36:30,100
will try to find Express port and after

650
00:36:25,930 --> 00:36:35,319
successful firing execute<font color="#E5E5E5"> all necessary</font>

651
00:36:30,100 --> 00:36:39,750
step for changing price for changing

652
00:36:35,320 --> 00:36:42,130
received etc now we got the shell

653
00:36:39,750 --> 00:36:46,390
automatically because we have remote

654
00:36:42,130 --> 00:36:49,770
code execution<font color="#E5E5E5"> so it means we can</font>

655
00:36:46,390 --> 00:36:49,770
control server

656
00:36:52,700 --> 00:37:04,919
that's how<font color="#E5E5E5"> POS workstation looks during</font>

657
00:37:01,590 --> 00:37:09,780
<font color="#E5E5E5">this process our exploit sends</font><font color="#CCCCCC"> closed</font>

658
00:37:04,920 --> 00:37:12,930
terminal message and POS terminal<font color="#E5E5E5"> sense</font>

659
00:37:09,780 --> 00:37:19,160
look<font color="#CCCCCC"> logs to the</font><font color="#E5E5E5"> server</font>

660
00:37:12,930 --> 00:37:24,799
POS server right after that our exploit

661
00:37:19,160 --> 00:37:27,390
sense<font color="#E5E5E5"> open terminal and SSP workstation</font>

662
00:37:24,800 --> 00:37:29,940
is opening and during this opening

663
00:37:27,390 --> 00:37:37,580
process<font color="#E5E5E5"> download new settings and</font><font color="#CCCCCC"> apply</font>

664
00:37:29,940 --> 00:37:42,630
them now if we will try to buy again

665
00:37:37,580 --> 00:37:48,270
<font color="#CCCCCC">MacBook Pro again we</font><font color="#E5E5E5"> need to scan</font>

666
00:37:42,630 --> 00:37:51,330
barcode of our<font color="#E5E5E5"> mug book now we can see</font>

667
00:37:48,270 --> 00:37:57,240
<font color="#E5E5E5">that price for the MacBook Pro equal</font><font color="#CCCCCC"> $3</font>

668
00:37:51,330 --> 00:38:01,140
<font color="#E5E5E5">regular price is almost $900 but we can</font>

669
00:37:57,240 --> 00:38:04,379
buy it for only<font color="#E5E5E5"> for</font><font color="#CCCCCC"> three</font><font color="#E5E5E5"> dollars again</font>

670
00:38:01,140 --> 00:38:07,140
<font color="#E5E5E5">we provide to the kisser our credit card</font>

671
00:38:04,380 --> 00:38:11,960
or someone provided<font color="#CCCCCC"> get to the</font><font color="#E5E5E5"> cash</font><font color="#CCCCCC"> a</font>

672
00:38:07,140 --> 00:38:11,960
credit<font color="#E5E5E5"> card swipe it</font>

673
00:38:18,240 --> 00:38:30,310
now we can see total savings good deal

674
00:38:24,210 --> 00:38:35,980
<font color="#E5E5E5">so and POS server now sends</font><font color="#CCCCCC"> out credit</font>

675
00:38:30,310 --> 00:38:37,690
<font color="#CCCCCC">cards to their checkers yeah yes and</font>

676
00:38:35,980 --> 00:38:40,510
let's check<font color="#E5E5E5"> received</font>

677
00:38:37,690 --> 00:38:44,110
let's compare receipts<font color="#CCCCCC"> before a check</font>

678
00:38:40,510 --> 00:38:48,430
and after a check as you<font color="#E5E5E5"> can see we can</font>

679
00:38:44,110 --> 00:38:50,020
also<font color="#CCCCCC"> manipulate up multiple information</font>

680
00:38:48,430 --> 00:38:57,480
which<font color="#E5E5E5"> will be on the</font><font color="#CCCCCC"> receipt</font>

681
00:38:50,020 --> 00:39:03,480
now<font color="#CCCCCC"> we can see price change and and now</font>

682
00:38:57,480 --> 00:39:03,480
<font color="#E5E5E5">information about credit card unmasked</font>

683
00:39:05,700 --> 00:39:13,930
yeah footer also we can<font color="#E5E5E5"> change the</font>

684
00:39:10,000 --> 00:39:18,040
future<font color="#E5E5E5"> of receipt so it means an</font>

685
00:39:13,930 --> 00:39:21,220
attacker can control everything every

686
00:39:18,040 --> 00:39:22,900
part of<font color="#E5E5E5"> a</font><font color="#CCCCCC"> sa</font><font color="#E5E5E5"> PPS system without any</font>

687
00:39:21,220 --> 00:39:27,339
authentication<font color="#CCCCCC"> we just need to get</font>

688
00:39:22,900 --> 00:39:32,170
<font color="#CCCCCC">access to internal network</font><font color="#E5E5E5"> so let's talk</font>

689
00:39:27,340 --> 00:39:34,690
about encryption<font color="#E5E5E5"> in</font><font color="#CCCCCC"> sa PPS system</font><font color="#E5E5E5"> so yep</font>

690
00:39:32,170 --> 00:39:36,900
<font color="#E5E5E5">according</font><font color="#CCCCCC"> to the plantation following</font>

691
00:39:34,690 --> 00:39:39,580
tables and counts are affected by

692
00:39:36,900 --> 00:39:42,490
encryption implementation which is<font color="#E5E5E5"> an</font>

693
00:39:39,580 --> 00:39:45,310
<font color="#CCCCCC">our</font><font color="#E5E5E5"> table include</font><font color="#CCCCCC"> the register where</font>

694
00:39:42,490 --> 00:39:47,410
<font color="#CCCCCC">memory</font><font color="#E5E5E5"> is a list of counts and stop</font>

695
00:39:45,310 --> 00:39:50,200
passages which are affected by the

696
00:39:47,410 --> 00:39:52,690
encryption<font color="#E5E5E5"> too and we can depreciate</font>

697
00:39:50,200 --> 00:39:55,029
<font color="#E5E5E5">encryption level so for example</font>

698
00:39:52,690 --> 00:40:00,510
<font color="#CCCCCC">employers pass of are stored as cash</font>

699
00:39:55,030 --> 00:40:03,610
value and here encryption level<font color="#CCCCCC"> 4 and a</font>

700
00:40:00,510 --> 00:40:06,250
reference number of a card is stored as

701
00:40:03,610 --> 00:40:08,710
<font color="#E5E5E5">triple des cipher text and have</font>

702
00:40:06,250 --> 00:40:10,450
encryption level 3 so this tables are

703
00:40:08,710 --> 00:40:15,100
<font color="#CCCCCC">very important</font><font color="#E5E5E5"> cause</font><font color="#CCCCCC"> release</font><font color="#E5E5E5"> information</font>

704
00:40:10,450 --> 00:40:19,870
<font color="#CCCCCC">about about transactions and about</font>

705
00:40:15,100 --> 00:40:22,360
credit cards so a CP POS<font color="#E5E5E5"> uses TW</font>

706
00:40:19,870 --> 00:40:23,980
security tool for encryption<font color="#E5E5E5"> it creates</font>

707
00:40:22,360 --> 00:40:28,540
a special<font color="#E5E5E5"> security container with a</font>

708
00:40:23,980 --> 00:40:30,010
password<font color="#E5E5E5"> so this container couldn't be</font>

709
00:40:28,540 --> 00:40:33,910
exported import

710
00:40:30,010 --> 00:40:36,040
already without<font color="#E5E5E5"> pacification</font><font color="#CCCCCC"> the</font>

711
00:40:33,910 --> 00:40:39,910
<font color="#E5E5E5">container should be the same at all</font>

712
00:40:36,040 --> 00:40:42,940
<font color="#CCCCCC">sa</font><font color="#E5E5E5"> PPS elements like clients</font><font color="#CCCCCC"> F</font><font color="#E5E5E5"> server</font>

713
00:40:39,910 --> 00:40:44,589
<font color="#E5E5E5">store manager and so configurator</font><font color="#CCCCCC"> the</font>

714
00:40:42,940 --> 00:40:47,590
sensitive data is<font color="#CCCCCC"> included in every</font>

715
00:40:44,590 --> 00:40:51,220
<font color="#CCCCCC">process level but matter is one</font>

716
00:40:47,590 --> 00:40:54,910
exception<font color="#CCCCCC"> this parameter is set by store</font>

717
00:40:51,220 --> 00:40:58,600
configurator by administrator and it's

718
00:40:54,910 --> 00:41:02,350
<font color="#E5E5E5">converted in</font><font color="#CCCCCC"> S key file and is sent to</font>

719
00:40:58,600 --> 00:41:05,020
<font color="#CCCCCC">extras server so Antakya can just change</font>

720
00:41:02,350 --> 00:41:08,770
encryption key<font color="#E5E5E5"> talking to no</font><font color="#CCCCCC"> value and</font>

721
00:41:05,020 --> 00:41:12,070
this way<font color="#E5E5E5"> he will switch off encryption</font>

722
00:41:08,770 --> 00:41:14,170
mechanism<font color="#CCCCCC"> in fuse transactions and you</font>

723
00:41:12,070 --> 00:41:17,370
can ask<font color="#E5E5E5"> me what about</font><font color="#CCCCCC"> data have</font><font color="#E5E5E5"> been</font>

724
00:41:14,170 --> 00:41:22,810
acquitted before where is another<font color="#CCCCCC"> tool</font>

725
00:41:17,370 --> 00:41:25,569
like talking clip this tool<font color="#E5E5E5"> can force</font>

726
00:41:22,810 --> 00:41:28,500
and<font color="#CCCCCC"> creat sensitive data in database if</font>

727
00:41:25,570 --> 00:41:31,900
we<font color="#CCCCCC"> both know</font><font color="#E5E5E5"> encryption and</font><font color="#CCCCCC"> rain creep</font>

728
00:41:28,500 --> 00:41:34,930
recessive data with a new key<font color="#E5E5E5"> when this</font>

729
00:41:31,900 --> 00:41:37,560
tool rink reads data first it<font color="#CCCCCC"> decrypts</font>

730
00:41:34,930 --> 00:41:41,529
<font color="#E5E5E5">it and after that increase one more time</font>

731
00:41:37,560 --> 00:41:44,500
so we<font color="#E5E5E5"> can</font><font color="#CCCCCC"> damp the clear the plaintext</font>

732
00:41:41,530 --> 00:41:49,420
<font color="#E5E5E5">data from the memory using</font><font color="#CCCCCC"> frida for</font>

733
00:41:44,500 --> 00:41:54,160
example so attacker<font color="#E5E5E5"> vector will be with</font>

734
00:41:49,420 --> 00:41:57,400
talking<font color="#E5E5E5"> creep process gets encrypted</font>

735
00:41:54,160 --> 00:42:01,470
data from<font color="#E5E5E5"> a database then</font><font color="#CCCCCC"> decrypt this</font>

736
00:41:57,400 --> 00:42:04,570
<font color="#E5E5E5">data at this moment attacker runs</font>

737
00:42:01,470 --> 00:42:07,540
freezing<font color="#CCCCCC"> tool and still sensitive</font>

738
00:42:04,570 --> 00:42:10,360
situation from<font color="#E5E5E5"> a memory then talking</font>

739
00:42:07,540 --> 00:42:12,720
<font color="#E5E5E5">creep process increase data and send</font>

740
00:42:10,360 --> 00:42:16,840
encrypted data to<font color="#E5E5E5"> database</font>

741
00:42:12,720 --> 00:42:20,169
it's not about mobility<font color="#CCCCCC"> but</font><font color="#E5E5E5"> it seems</font>

742
00:42:16,840 --> 00:42:22,930
<font color="#E5E5E5">that if an attacker compromised</font><font color="#CCCCCC"> extra</font>

743
00:42:20,170 --> 00:42:26,650
server<font color="#E5E5E5"> it gets information about also</font>

744
00:42:22,930 --> 00:42:30,480
<font color="#CCCCCC">into data</font><font color="#E5E5E5"> and all credit cards in the</font>

745
00:42:26,650 --> 00:42:34,480
system that's<font color="#E5E5E5"> not</font><font color="#CCCCCC"> about fixes</font><font color="#E5E5E5"> but</font><font color="#CCCCCC"> SCP</font>

746
00:42:30,480 --> 00:42:37,900
team made so security<font color="#CCCCCC"> note was released</font>

747
00:42:34,480 --> 00:42:41,680
on<font color="#E5E5E5"> the</font><font color="#CCCCCC"> july patch day with this is</font>

748
00:42:37,900 --> 00:42:43,710
serious<font color="#CCCCCC"> information about it in this</font>

749
00:42:41,680 --> 00:42:46,470
fashion is an<font color="#CCCCCC"> archive we've</font>

750
00:42:43,710 --> 00:42:47,760
<font color="#CCCCCC">new files we</font><font color="#E5E5E5"> can find X phase</font><font color="#CCCCCC"> the text</font>

751
00:42:46,470 --> 00:42:50,759
<font color="#E5E5E5">and</font><font color="#CCCCCC"> Express control</font>

752
00:42:47,760 --> 00:42:54,000
I'm Alabama among them when when idea is

753
00:42:50,760 --> 00:42:57,330
if I care and if an attacker could send

754
00:42:54,000 --> 00:43:00,119
something<font color="#E5E5E5"> on poor</font><font color="#CCCCCC"> 22:02 and control</font>

755
00:42:57,330 --> 00:43:03,810
<font color="#E5E5E5">turbos we as defense team should</font>

756
00:43:00,119 --> 00:43:08,089
restrict<font color="#E5E5E5"> an access to</font><font color="#CCCCCC"> his</font><font color="#E5E5E5"> for a new</font>

757
00:43:03,810 --> 00:43:12,839
parameter<font color="#E5E5E5"> appears at Express server</font>

758
00:43:08,089 --> 00:43:15,690
back-office<font color="#E5E5E5"> IP address so we this</font>

759
00:43:12,839 --> 00:43:19,200
parameter determines connections between

760
00:43:15,690 --> 00:43:21,990
extra server and measure and extract

761
00:43:19,200 --> 00:43:24,450
manager<font color="#E5E5E5"> so the default value is</font><font color="#CCCCCC"> the</font>

762
00:43:21,990 --> 00:43:28,220
local host and we checked and<font color="#E5E5E5"> changed of</font>

763
00:43:24,450 --> 00:43:33,060
a patch and we find a way<font color="#CCCCCC"> to</font><font color="#E5E5E5"> when bypass</font>

764
00:43:28,220 --> 00:43:35,819
so there<font color="#E5E5E5"> are two cases how so manager</font>

765
00:43:33,060 --> 00:43:37,290
could be installed<font color="#CCCCCC"> my</font><font color="#E5E5E5"> first is when it</font>

766
00:43:35,820 --> 00:43:40,349
was<font color="#E5E5E5"> installed on the same machine and</font>

767
00:43:37,290 --> 00:43:42,990
<font color="#E5E5E5">there are way well it was installed on</font>

768
00:43:40,349 --> 00:43:46,290
<font color="#E5E5E5">the remote machine so</font><font color="#CCCCCC"> Antakya vector</font>

769
00:43:42,990 --> 00:43:50,609
will be<font color="#E5E5E5"> the same and let's took a case</font>

770
00:43:46,290 --> 00:43:52,529
with a<font color="#E5E5E5"> monster manger so the court walk</font>

771
00:43:50,609 --> 00:43:55,799
is<font color="#CCCCCC"> store manager tries to connect</font><font color="#E5E5E5"> the</font>

772
00:43:52,530 --> 00:43:59,000
<font color="#E5E5E5">extra server on port 22 0 2 extra server</font>

773
00:43:55,800 --> 00:44:01,650
open config file<font color="#E5E5E5"> it's a local</font><font color="#CCCCCC"> loading e</font>

774
00:43:59,000 --> 00:44:06,450
then get back office IP address

775
00:44:01,650 --> 00:44:09,570
parameter check it and accept if IP

776
00:44:06,450 --> 00:44:12,390
<font color="#CCCCCC">others</font><font color="#E5E5E5"> and apparently will do are the</font>

777
00:44:09,570 --> 00:44:14,700
same<font color="#CCCCCC"> isn't right if an attacker tries to</font>

778
00:44:12,390 --> 00:44:18,299
do the<font color="#E5E5E5"> same thing access server open</font>

779
00:44:14,700 --> 00:44:24,149
settings get parameter<font color="#CCCCCC"> check and reject</font>

780
00:44:18,300 --> 00:44:27,599
<font color="#CCCCCC">the connection but we still have animal</font>

781
00:44:24,150 --> 00:44:31,020
code execution<font color="#CCCCCC"> maybe a city team</font><font color="#E5E5E5"> did not</font>

782
00:44:27,599 --> 00:44:34,410
<font color="#E5E5E5">vice the second polar ability but at the</font>

783
00:44:31,020 --> 00:44:36,780
moment we can do anything<font color="#CCCCCC"> we could add</font>

784
00:44:34,410 --> 00:44:40,310
<font color="#CCCCCC">extra</font><font color="#E5E5E5"> server that's why we can just</font>

785
00:44:36,780 --> 00:44:43,290
rewrite<font color="#E5E5E5"> makeups IP address parameter and</font>

786
00:44:40,310 --> 00:44:46,920
then<font color="#E5E5E5"> I take a tries to connect the extra</font>

787
00:44:43,290 --> 00:44:49,279
server<font color="#CCCCCC"> Explorer sir open settings</font><font color="#E5E5E5"> yes</font>

788
00:44:46,920 --> 00:44:52,859
because<font color="#E5E5E5"> echo address is our scipy and</font>

789
00:44:49,280 --> 00:44:57,390
well check this IP<font color="#E5E5E5"> compare and accept</font>

790
00:44:52,859 --> 00:44:57,660
the connection<font color="#CCCCCC"> so globally</font><font color="#E5E5E5"> if there is</font>

791
00:44:57,390 --> 00:45:00,578
no

792
00:44:57,660 --> 00:45:03,399
vulnerability on<font color="#E5E5E5"> port 2200</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> screw the</font>

793
00:45:00,579 --> 00:45:06,099
page will really save sailors from

794
00:45:03,400 --> 00:45:09,369
external attacker<font color="#E5E5E5"> but what is the</font><font color="#CCCCCC"> longer</font>

795
00:45:06,099 --> 00:45:12,009
<font color="#CCCCCC">way out there and it's a</font><font color="#E5E5E5"> problem so</font><font color="#CCCCCC"> we</font>

796
00:45:09,369 --> 00:45:15,609
reported<font color="#CCCCCC"> ACP team that with another</font>

797
00:45:12,009 --> 00:45:18,190
<font color="#E5E5E5">vulnerability</font><font color="#CCCCCC"> but we still have a remote</font>

798
00:45:15,609 --> 00:45:20,440
code execution by a similar<font color="#E5E5E5"> fast made an</font>

799
00:45:18,190 --> 00:45:22,890
additional security page<font color="#E5E5E5"> but we was</font>

800
00:45:20,440 --> 00:45:29,589
<font color="#E5E5E5">really surprised</font>

801
00:45:22,890 --> 00:45:29,828
so<font color="#E5E5E5"> we released one more patch</font><font color="#CCCCCC"> five days</font>

802
00:45:29,589 --> 00:45:35,019
<font color="#E5E5E5">ago</font>

803
00:45:29,829 --> 00:45:38,200
we're obviously 18th so we don't have

804
00:45:35,019 --> 00:45:40,839
<font color="#E5E5E5">much time to check this page but it</font>

805
00:45:38,200 --> 00:45:43,269
seems that<font color="#CCCCCC"> SCP team have changed</font>

806
00:45:40,839 --> 00:45:45,970
communication between client application

807
00:45:43,269 --> 00:45:48,519
and extra server<font color="#CCCCCC"> where</font><font color="#E5E5E5"> additionally some</font>

808
00:45:45,970 --> 00:45:53,430
chain updates in encryption mechanism

809
00:45:48,519 --> 00:46:01,140
because a crypto<font color="#CCCCCC"> libels</font><font color="#E5E5E5"> in this patch so</font>

810
00:45:53,430 --> 00:46:04,450
<font color="#E5E5E5">well it is now one secret to know so</font>

811
00:46:01,140 --> 00:46:09,400
<font color="#CCCCCC">salt passages we mentioned at the</font>

812
00:46:04,450 --> 00:46:13,660
beginning<font color="#E5E5E5"> of this talk with a</font><font color="#CCCCCC"> backdoor</font>

813
00:46:09,400 --> 00:46:18,039
<font color="#E5E5E5">or user must be deleted so maybe it's</font>

814
00:46:13,660 --> 00:46:21,098
critical but we<font color="#CCCCCC"> don't think so okay we</font>

815
00:46:18,039 --> 00:46:24,309
wondered if<font color="#CCCCCC"> everything is bad with the</font>

816
00:46:21,099 --> 00:46:25,900
security<font color="#E5E5E5"> of other POS vendors</font><font color="#CCCCCC"> okay let's</font>

817
00:46:24,309 --> 00:46:29,940
mention one more<font color="#E5E5E5"> question</font>

818
00:46:25,900 --> 00:46:32,859
Oracle Mike Ross so what is<font color="#E5E5E5"> the micros</font>

819
00:46:29,940 --> 00:46:36,220
initially micros<font color="#E5E5E5"> developed by the same</font>

820
00:46:32,859 --> 00:46:39,848
company and means modular integrated

821
00:46:36,220 --> 00:46:42,848
cash register operating systems<font color="#E5E5E5"> Michaels</font>

822
00:46:39,849 --> 00:46:45,999
develop hardware and software for<font color="#E5E5E5"> cruise</font>

823
00:46:42,849 --> 00:46:49,509
lines<font color="#CCCCCC"> specialty markets hotels</font>

824
00:46:45,999 --> 00:46:51,700
<font color="#E5E5E5">restaurants etc in 2014 Oracle bought</font>

825
00:46:49,509 --> 00:46:54,910
micros and<font color="#E5E5E5"> now we know this product</font><font color="#CCCCCC"> has</font>

826
00:46:51,700 --> 00:46:56,769
Oracle Symphony if we talk<font color="#CCCCCC"> about the</font>

827
00:46:54,910 --> 00:46:58,839
security<font color="#E5E5E5"> of micros it is worth</font>

828
00:46:56,769 --> 00:47:01,269
mentioning that the<font color="#CCCCCC"> uncheck errs have</font>

829
00:46:58,839 --> 00:47:05,769
already tried to<font color="#E5E5E5"> compromise the micros</font>

830
00:47:01,269 --> 00:47:07,689
for getting profit in 2016 many<font color="#E5E5E5"> internal</font>

831
00:47:05,769 --> 00:47:11,118
<font color="#E5E5E5">wrote the micros was hacked</font>

832
00:47:07,690 --> 00:47:14,029
but after<font color="#CCCCCC"> fact-checking</font><font color="#E5E5E5"> we found</font>

833
00:47:11,119 --> 00:47:18,049
now that attackers<font color="#CCCCCC"> got access to the</font>

834
00:47:14,029 --> 00:47:20,450
micros customer portal<font color="#CCCCCC"> micros</font><font color="#E5E5E5"> POS</font>

835
00:47:18,049 --> 00:47:24,589
workstation or clients data<font color="#E5E5E5"> wasn't</font>

836
00:47:20,450 --> 00:47:26,118
compromised as practice shot<font color="#E5E5E5"> finding and</font>

837
00:47:24,589 --> 00:47:29,288
<font color="#CCCCCC">Sarah with my cross is not very</font>

838
00:47:26,119 --> 00:47:31,970
difficult<font color="#CCCCCC"> well-known methods</font><font color="#E5E5E5"> like such</font>

839
00:47:29,289 --> 00:47:34,910
searching in<font color="#E5E5E5"> show round Google or</font>

840
00:47:31,970 --> 00:47:36,828
sensors are great for<font color="#E5E5E5"> this on this slide</font>

841
00:47:34,910 --> 00:47:39,049
<font color="#CCCCCC">you can</font><font color="#E5E5E5"> see result of searching in</font>

842
00:47:36,829 --> 00:47:46,359
<font color="#E5E5E5">Shoreham search engine you can see that</font>

843
00:47:39,049 --> 00:47:49,160
a lot<font color="#CCCCCC"> of micros server exists in</font><font color="#E5E5E5"> u.s.</font>

844
00:47:46,359 --> 00:47:51,049
<font color="#E5E5E5">let's have a briefly view on the</font>

845
00:47:49,160 --> 00:47:54,038
architecture of micros<font color="#E5E5E5"> again we have</font>

846
00:47:51,049 --> 00:47:58,809
<font color="#E5E5E5">three main parts here workstation</font>

847
00:47:54,039 --> 00:48:00,950
<font color="#CCCCCC">back-office and head office this is how</font>

848
00:47:58,809 --> 00:48:04,670
administrator interface of<font color="#CCCCCC"> Horicon</font>

849
00:48:00,950 --> 00:48:08,930
microscopes<font color="#CCCCCC"> for me it looks</font><font color="#E5E5E5"> more modern</font>

850
00:48:04,670 --> 00:48:11,390
than<font color="#CCCCCC"> sa PPOs administrator interface</font><font color="#E5E5E5"> but</font>

851
00:48:08,930 --> 00:48:18,348
not all<font color="#E5E5E5"> micros components have such a</font>

852
00:48:11,390 --> 00:48:20,739
clear interface for<font color="#CCCCCC"> example if you will</font>

853
00:48:18,349 --> 00:48:23,239
try to if you try to configure a

854
00:48:20,739 --> 00:48:26,509
<font color="#E5E5E5">workstation POS workstation</font><font color="#CCCCCC"> you will see</font>

855
00:48:23,239 --> 00:48:28,700
windows like<font color="#CCCCCC"> this at first glance it's</font>

856
00:48:26,509 --> 00:48:32,630
it is very unclear what they want from

857
00:48:28,700 --> 00:48:33,950
us<font color="#CCCCCC"> we didn't find in official</font>

858
00:48:32,630 --> 00:48:36,579
documentation what exactly it is

859
00:48:33,950 --> 00:48:39,379
<font color="#E5E5E5">necessary</font><font color="#CCCCCC"> to enter</font><font color="#E5E5E5"> in these windows</font><font color="#CCCCCC"> and</font>

860
00:48:36,579 --> 00:48:42,019
only searching on special forums enable

861
00:48:39,380 --> 00:48:43,789
us to find out<font color="#E5E5E5"> the answer it turned out</font>

862
00:48:42,019 --> 00:48:46,129
<font color="#CCCCCC">that in</font><font color="#E5E5E5"> order to gain access to the</font>

863
00:48:43,789 --> 00:48:48,710
configuration<font color="#CCCCCC"> of to do the calculation</font>

864
00:48:46,130 --> 00:48:50,839
possibilities the user must<font color="#E5E5E5"> be from a</font>

865
00:48:48,710 --> 00:48:53,210
number of mathematical actions with

866
00:48:50,839 --> 00:48:55,880
displayed digits<font color="#E5E5E5"> he must multiply</font><font color="#CCCCCC"> the</font>

867
00:48:53,210 --> 00:48:59,269
first two<font color="#CCCCCC"> digits and add the fourth and</font>

868
00:48:55,880 --> 00:49:02,660
sixth number<font color="#E5E5E5"> to that</font><font color="#CCCCCC"> and result will be</font>

869
00:48:59,269 --> 00:49:07,220
<font color="#CCCCCC">the answer</font><font color="#E5E5E5"> how we should know that</font><font color="#CCCCCC"> we</font>

870
00:49:02,660 --> 00:49:10,038
don't<font color="#E5E5E5"> know that's how micros protocol</font>

871
00:49:07,220 --> 00:49:12,319
looks<font color="#E5E5E5"> you can see that micros uses HTTP</font>

872
00:49:10,039 --> 00:49:16,400
for<font color="#E5E5E5"> communication and sense mix of</font>

873
00:49:12,319 --> 00:49:19,839
binary<font color="#E5E5E5"> and XML data as a payload</font><font color="#CCCCCC"> in post</font>

874
00:49:16,400 --> 00:49:22,400
<font color="#E5E5E5">request okay let's go closer to the</font>

875
00:49:19,839 --> 00:49:24,080
vulnerabilities<font color="#E5E5E5"> honestly we didn't have</font>

876
00:49:22,400 --> 00:49:26,420
enough time<font color="#CCCCCC"> for</font>

877
00:49:24,080 --> 00:49:28,759
searching<font color="#CCCCCC"> Oracle microwave had some</font>

878
00:49:26,420 --> 00:49:30,640
issues we found possibilities to get

879
00:49:28,760 --> 00:49:33,470
information about POS workstations

880
00:49:30,640 --> 00:49:36,290
<font color="#E5E5E5">information about database issues that</font>

881
00:49:33,470 --> 00:49:40,730
allows to read any file from POS again

882
00:49:36,290 --> 00:49:42,279
and you just<font color="#E5E5E5"> related we allow us to</font>

883
00:49:40,730 --> 00:49:45,320
drill your<font color="#CCCCCC"> dinero</font><font color="#E5E5E5"> solicitor</font>

884
00:49:42,280 --> 00:49:48,230
that's how one of these<font color="#E5E5E5"> information</font>

885
00:49:45,320 --> 00:49:51,050
disclosed looks<font color="#E5E5E5"> an attacker can get</font>

886
00:49:48,230 --> 00:49:54,970
information about version about internal

887
00:49:51,050 --> 00:49:59,510
IP address about tables<font color="#E5E5E5"> about hardware</font>

888
00:49:54,970 --> 00:50:02,629
about battery etc anonymously<font color="#E5E5E5"> without</font>

889
00:49:59,510 --> 00:50:04,730
<font color="#CCCCCC">education or this example</font><font color="#E5E5E5"> of arbitrary</font>

890
00:50:02,630 --> 00:50:08,780
file reading<font color="#E5E5E5"> an attacker can read any</font>

891
00:50:04,730 --> 00:50:11,180
file<font color="#E5E5E5"> from this from POS workstation we</font>

892
00:50:08,780 --> 00:50:14,810
dedicate<font color="#E5E5E5"> to two important files Symphony</font>

893
00:50:11,180 --> 00:50:17,870
in style dot XML<font color="#E5E5E5"> or DB config dot XML</font>

894
00:50:14,810 --> 00:50:20,690
that<font color="#E5E5E5"> contains usernames and encrypted</font>

895
00:50:17,870 --> 00:50:23,000
password for connection to database also

896
00:50:20,690 --> 00:50:25,460
<font color="#CCCCCC">I'd like</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> share some default values of</font>

897
00:50:23,000 --> 00:50:28,690
micros like default account micros

898
00:50:25,460 --> 00:50:31,580
micros default encryption passphrase

899
00:50:28,690 --> 00:50:33,710
<font color="#CCCCCC">default database accounts maybe</font><font color="#E5E5E5"> it will</font>

900
00:50:31,580 --> 00:50:38,000
<font color="#E5E5E5">be helpful during the penetration test</font>

901
00:50:33,710 --> 00:50:41,270
of<font color="#E5E5E5"> Oracle micros so few conclusion</font>

902
00:50:38,000 --> 00:50:44,570
worlds<font color="#E5E5E5"> as you can see POS it is not only</font>

903
00:50:41,270 --> 00:50:47,690
pin<font color="#E5E5E5"> pairs and post terminals</font><font color="#CCCCCC"> also it is</font>

904
00:50:44,570 --> 00:50:50,120
big infrastructure<font color="#CCCCCC"> behind our small</font>

905
00:50:47,690 --> 00:50:52,820
research so that<font color="#E5E5E5"> state of</font><font color="#CCCCCC"> security of</font>

906
00:50:50,120 --> 00:50:55,460
this infrastructure<font color="#E5E5E5"> is not as good as we</font>

907
00:50:52,820 --> 00:50:57,500
would<font color="#E5E5E5"> like so simple</font><font color="#CCCCCC"> backs like missing</font>

908
00:50:55,460 --> 00:50:59,780
authorization checks<font color="#CCCCCC"> still exists</font><font color="#E5E5E5"> and</font>

909
00:50:57,500 --> 00:51:03,800
brings big potential for<font color="#CCCCCC"> the fraud</font><font color="#E5E5E5"> and</font>

910
00:50:59,780 --> 00:51:05,780
attacks on<font color="#E5E5E5"> a customer data</font><font color="#CCCCCC"> and yes</font>

911
00:51:03,800 --> 00:51:07,010
<font color="#CCCCCC">that's all for</font><font color="#E5E5E5"> this moment</font><font color="#CCCCCC"> if you have</font>

912
00:51:05,780 --> 00:51:10,640
any question we will<font color="#E5E5E5"> be happy to</font><font color="#CCCCCC"> answer</font>

913
00:51:07,010 --> 00:51:16,130
on them thank<font color="#E5E5E5"> you</font><font color="#CCCCCC"> very much thank</font><font color="#E5E5E5"> you</font>

914
00:51:10,640 --> 00:51:21,080
<font color="#E5E5E5">thank you very much great icons</font>

915
00:51:16,130 --> 00:51:23,270
any questions<font color="#CCCCCC"> from the</font><font color="#E5E5E5"> floor probably</font>

916
00:51:21,080 --> 00:51:26,529
offstage then or if they any questions

917
00:51:23,270 --> 00:51:26,530
thank you<font color="#E5E5E5"> very</font><font color="#CCCCCC"> much very much</font>

