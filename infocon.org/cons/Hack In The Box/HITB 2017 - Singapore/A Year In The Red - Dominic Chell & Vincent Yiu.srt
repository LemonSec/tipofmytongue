1
00:00:07,700 --> 00:00:13,250
good afternoon<font color="#E5E5E5"> welcome</font><font color="#CCCCCC"> to our</font><font color="#E5E5E5"> talk</font><font color="#CCCCCC"> are</font>

2
00:00:09,740 --> 00:00:15,049
<font color="#CCCCCC">you in</font><font color="#E5E5E5"> the red so our talk today is</font>

3
00:00:13,250 --> 00:00:16,279
<font color="#E5E5E5">discussing some of the advances in red</font>

4
00:00:15,049 --> 00:00:18,380
team<font color="#CCCCCC"> tactics that</font><font color="#E5E5E5"> have come to light</font>

5
00:00:16,279 --> 00:00:19,789
<font color="#E5E5E5">over the past twelve or so months</font><font color="#CCCCCC"> and we</font>

6
00:00:18,380 --> 00:00:22,038
tried to<font color="#CCCCCC"> cover a broad range of areas</font>

7
00:00:19,789 --> 00:00:23,810
<font color="#E5E5E5">starting from the outside</font><font color="#CCCCCC"> with recon and</font>

8
00:00:22,039 --> 00:00:26,509
<font color="#E5E5E5">infiltration through to establishing</font>

9
00:00:23,810 --> 00:00:27,349
<font color="#E5E5E5">situ and lateral movement</font><font color="#CCCCCC"> we'll talk</font>

10
00:00:26,509 --> 00:00:29,269
about<font color="#E5E5E5"> some of the things that we've</font>

11
00:00:27,349 --> 00:00:31,189
found<font color="#E5E5E5"> most interesting including the</font>

12
00:00:29,269 --> 00:00:32,870
tools and techniques<font color="#E5E5E5"> released by other</font>

13
00:00:31,189 --> 00:00:34,280
researchers as<font color="#CCCCCC"> well as some of</font><font color="#E5E5E5"> the tools</font>

14
00:00:32,870 --> 00:00:35,980
<font color="#CCCCCC">that we've developed</font><font color="#E5E5E5"> in-house and that</font>

15
00:00:34,280 --> 00:00:37,940
proved useful to us on our<font color="#CCCCCC"> engagement</font>

16
00:00:35,980 --> 00:00:40,760
and so there<font color="#E5E5E5"> will be a few tools that</font>

17
00:00:37,940 --> 00:00:42,260
<font color="#CCCCCC">we've we'll talk about</font><font color="#E5E5E5"> through</font><font color="#CCCCCC"> our</font>

18
00:00:40,760 --> 00:00:47,480
presentation<font color="#CCCCCC"> most of them are available</font>

19
00:00:42,260 --> 00:00:48,410
<font color="#E5E5E5">and I'll get her page so my name is</font>

20
00:00:47,480 --> 00:00:51,319
<font color="#CCCCCC">donna char</font><font color="#E5E5E5"> work for a company</font><font color="#CCCCCC"> called</font>

21
00:00:48,410 --> 00:00:52,849
mb/sec where<font color="#E5E5E5"> i've overall got overall</font>

22
00:00:51,320 --> 00:00:56,210
responsibility for the company's<font color="#CCCCCC"> see</font>

23
00:00:52,850 --> 00:00:57,679
<font color="#E5E5E5">best star and red team services this is</font>

24
00:00:56,210 --> 00:00:59,920
the third<font color="#E5E5E5"> time I've spoken it hacking</font>

25
00:00:57,679 --> 00:01:02,539
<font color="#E5E5E5">box so thank you for welcoming</font><font color="#CCCCCC"> me back</font>

26
00:00:59,920 --> 00:01:04,309
yeah I'm Vincent you and I work

27
00:01:02,539 --> 00:01:08,090
alongside<font color="#CCCCCC"> dominic on the active reach</font>

28
00:01:04,309 --> 00:01:15,320
team<font color="#CCCCCC"> I'm dessert</font><font color="#E5E5E5"> yes is my first hack in</font>

29
00:01:08,090 --> 00:01:17,869
the<font color="#CCCCCC"> box</font><font color="#E5E5E5"> talk and confidence</font><font color="#CCCCCC"> actually so</font>

30
00:01:15,320 --> 00:01:20,000
from our perspective over the past few

31
00:01:17,869 --> 00:01:22,579
years<font color="#E5E5E5"> we've known photo being paid to</font>

32
00:01:20,000 --> 00:01:23,960
<font color="#E5E5E5">red team exercises</font><font color="#CCCCCC"> in particular over</font>

33
00:01:22,579 --> 00:01:25,309
<font color="#CCCCCC">the past twelve months or</font><font color="#E5E5E5"> so as a</font>

34
00:01:23,960 --> 00:01:26,899
company we've got a lot more clients

35
00:01:25,310 --> 00:01:29,600
coming to<font color="#E5E5E5"> us asking us about red team</font>

36
00:01:26,899 --> 00:01:31,100
over traditional penetration testing I'm

37
00:01:29,600 --> 00:01:32,809
not sure exactly why this is but I

38
00:01:31,100 --> 00:01:34,789
suspect it's partly<font color="#E5E5E5"> to do with buy-in</font>

39
00:01:32,810 --> 00:01:36,079
from the<font color="#CCCCCC"> regulators</font><font color="#E5E5E5"> so we've seen the</font>

40
00:01:34,790 --> 00:01:37,610
<font color="#E5E5E5">development of structured frameworks</font>

41
00:01:36,079 --> 00:01:40,070
that<font color="#E5E5E5"> provide a more formal</font><font color="#CCCCCC"> approach to</font>

42
00:01:37,610 --> 00:01:42,289
conducting<font color="#E5E5E5"> red team simulations so</font><font color="#CCCCCC"> we</font>

43
00:01:40,070 --> 00:01:44,119
<font color="#E5E5E5">now got things like the C best scheme in</font>

44
00:01:42,290 --> 00:01:47,000
the UK<font color="#E5E5E5"> that's backed by</font><font color="#CCCCCC"> the Bank of</font>

45
00:01:44,119 --> 00:01:48,259
England the<font color="#E5E5E5"> FCA and the NCSC we've got</font>

46
00:01:47,000 --> 00:01:50,270
equivalents in<font color="#CCCCCC"> other countries such as</font>

47
00:01:48,259 --> 00:01:51,710
<font color="#E5E5E5">the</font><font color="#CCCCCC"> TB scheme</font><font color="#E5E5E5"> over in</font><font color="#CCCCCC"> Elin Netherlands</font>

48
00:01:50,270 --> 00:01:53,390
which is backed by<font color="#E5E5E5"> the</font><font color="#CCCCCC"> Central Bank</font><font color="#E5E5E5"> of</font>

49
00:01:51,710 --> 00:01:57,798
Netherlands<font color="#E5E5E5"> and we've got the ICAST</font>

50
00:01:53,390 --> 00:01:58,969
scheme<font color="#E5E5E5"> over in Hong</font><font color="#CCCCCC"> Kong</font><font color="#E5E5E5"> so like yin and</font>

51
00:01:57,799 --> 00:02:01,880
yang is red teaming becomes more

52
00:01:58,969 --> 00:02:03,919
prominent<font color="#CCCCCC"> so</font><font color="#E5E5E5"> does blue teaming advances</font>

53
00:02:01,880 --> 00:02:06,229
in defensive controls the wider adoption

54
00:02:03,920 --> 00:02:08,600
of some boxing<font color="#E5E5E5"> technologies such as</font>

55
00:02:06,229 --> 00:02:10,550
Microsoft<font color="#CCCCCC"> ATA</font><font color="#E5E5E5"> lapse device guard</font>

56
00:02:08,600 --> 00:02:13,100
credential guard<font color="#CCCCCC"> as well as the rise of</font>

57
00:02:10,550 --> 00:02:15,020
threat hunting that<font color="#E5E5E5"> is teams that are</font>

58
00:02:13,100 --> 00:02:16,790
proactively in<font color="#E5E5E5"> iterally searching</font>

59
00:02:15,020 --> 00:02:18,940
through networks looking for threats<font color="#E5E5E5"> and</font>

60
00:02:16,790 --> 00:02:21,620
making red teaming considerably harder

61
00:02:18,940 --> 00:02:23,180
so as such the red team must<font color="#E5E5E5"> have all</font>

62
00:02:21,620 --> 00:02:24,739
and that was<font color="#CCCCCC"> really the inspiration for</font>

63
00:02:23,180 --> 00:02:25,390
<font color="#E5E5E5">this talk because</font><font color="#CCCCCC"> we believe there's</font>

64
00:02:24,739 --> 00:02:27,709
been<font color="#E5E5E5"> some really interesting</font>

65
00:02:25,390 --> 00:02:30,260
developments over the<font color="#E5E5E5"> past 12 to 18</font>

66
00:02:27,709 --> 00:02:31,580
months so I'm<font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> pass</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> over</font><font color="#CCCCCC"> to</font>

67
00:02:30,260 --> 00:02:32,780
Vincent<font color="#CCCCCC"> he'll talk about some of the</font>

68
00:02:31,580 --> 00:02:36,680
<font color="#E5E5E5">tools that we've developed</font><font color="#CCCCCC"> in the area</font>

69
00:02:32,780 --> 00:02:39,739
of recon so traditionally reconnaissance

70
00:02:36,680 --> 00:02:42,530
has been performed against<font color="#CCCCCC"> organizations</font>

71
00:02:39,739 --> 00:02:44,840
to sort of understand what the targets

72
00:02:42,530 --> 00:02:47,510
<font color="#E5E5E5">physical presences</font><font color="#CCCCCC"> their regional</font>

73
00:02:44,840 --> 00:02:48,620
presence and you know just to sort<font color="#E5E5E5"> of</font>

74
00:02:47,510 --> 00:02:50,298
understand more about<font color="#E5E5E5"> a type</font>

75
00:02:48,620 --> 00:02:53,840
<font color="#E5E5E5">organization before</font><font color="#CCCCCC"> you begin the</font>

76
00:02:50,299 --> 00:02:55,790
infiltration<font color="#E5E5E5"> phase and so one</font><font color="#CCCCCC"> thing that</font>

77
00:02:53,840 --> 00:02:57,950
<font color="#E5E5E5">kept cropping up for us was email</font>

78
00:02:55,790 --> 00:02:59,959
collection<font color="#E5E5E5"> so a lot of time we would</font>

79
00:02:57,950 --> 00:03:02,119
<font color="#CCCCCC">have to collect emails for a</font><font color="#E5E5E5"> tiger</font>

80
00:02:59,959 --> 00:03:03,500
<font color="#E5E5E5">organization for use in like</font>

81
00:03:02,120 --> 00:03:06,280
spearfishing or<font color="#CCCCCC"> passwords bringing</font>

82
00:03:03,500 --> 00:03:09,019
attacks against<font color="#E5E5E5"> external infrastructure</font>

83
00:03:06,280 --> 00:03:12,019
so traditionally email collections being

84
00:03:09,019 --> 00:03:14,390
performed<font color="#CCCCCC"> using search engines like</font>

85
00:03:12,019 --> 00:03:16,640
<font color="#CCCCCC">Google and</font><font color="#E5E5E5"> Bing</font><font color="#CCCCCC"> maybe social</font><font color="#E5E5E5"> media like</font>

86
00:03:14,390 --> 00:03:18,230
Twitter<font color="#CCCCCC"> and Facebook</font><font color="#E5E5E5"> unlikely</font><font color="#CCCCCC"> because in</font>

87
00:03:16,640 --> 00:03:21,349
enterprise<font color="#CCCCCC"> environments you're</font><font color="#E5E5E5"> less</font>

88
00:03:18,230 --> 00:03:24,129
likely<font color="#CCCCCC"> to find</font><font color="#E5E5E5"> email addresses in</font>

89
00:03:21,349 --> 00:03:26,959
personal social<font color="#CCCCCC"> media like Facebook</font>

90
00:03:24,129 --> 00:03:27,888
<font color="#CCCCCC">LinkedIn</font><font color="#E5E5E5"> is the more prominent one so</font>

91
00:03:26,959 --> 00:03:37,220
we're<font color="#E5E5E5"> going</font><font color="#CCCCCC"> to talk about that a bit</font>

92
00:03:27,889 --> 00:03:41,239
<font color="#CCCCCC">more here so email</font><font color="#E5E5E5"> collection</font><font color="#CCCCCC"> it's quite</font>

93
00:03:37,220 --> 00:03:42,859
prominent and why is it<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> so yeah</font>

94
00:03:41,239 --> 00:03:47,180
we're just<font color="#CCCCCC"> gonna focus on LinkedIn here</font>

95
00:03:42,859 --> 00:03:49,970
and I'll talk a<font color="#E5E5E5"> bit about why so on the</font>

96
00:03:47,180 --> 00:03:54,109
<font color="#E5E5E5">left yeah on the left here</font><font color="#CCCCCC"> you can see</font>

97
00:03:49,970 --> 00:03:57,560
<font color="#E5E5E5">lot you can see my</font><font color="#CCCCCC"> name and my title MD</font>

98
00:03:54,109 --> 00:04:00,139
sir the<font color="#CCCCCC"> university I</font><font color="#E5E5E5"> went to</font><font color="#CCCCCC"> and the</font>

99
00:03:57,560 --> 00:04:03,290
company I work out and I have my<font color="#E5E5E5"> sort of</font>

100
00:04:00,139 --> 00:04:04,880
<font color="#E5E5E5">like geographical location as well so</font>

101
00:04:03,290 --> 00:04:07,190
that's<font color="#E5E5E5"> a</font><font color="#CCCCCC"> lot that's important</font>

102
00:04:04,880 --> 00:04:11,030
information<font color="#CCCCCC"> when you're trying to narrow</font>

103
00:04:07,190 --> 00:04:13,160
down a<font color="#E5E5E5"> target a list of targets to a</font>

104
00:04:11,030 --> 00:04:14,840
specific region if say<font color="#CCCCCC"> for example I</font>

105
00:04:13,160 --> 00:04:16,728
only<font color="#CCCCCC"> watched</font><font color="#E5E5E5"> attack of the UK presence</font>

106
00:04:14,840 --> 00:04:20,238
<font color="#E5E5E5">as opposed to like say Asia learn what</font>

107
00:04:16,728 --> 00:04:22,820
will<font color="#E5E5E5"> come in handy additionally on</font>

108
00:04:20,238 --> 00:04:25,070
LinkedIn you<font color="#CCCCCC"> can</font><font color="#E5E5E5"> search by the company</font>

109
00:04:22,820 --> 00:04:28,280
name<font color="#E5E5E5"> so if you search</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> example here</font>

110
00:04:25,070 --> 00:04:30,349
General Motors<font color="#E5E5E5"> we can then click on the</font>

111
00:04:28,280 --> 00:04:31,880
company's profile page<font color="#E5E5E5"> and you can see</font>

112
00:04:30,349 --> 00:04:34,400
like there's actually<font color="#CCCCCC"> a link on the page</font>

113
00:04:31,880 --> 00:04:35,520
which allows<font color="#E5E5E5"> you to like click</font><font color="#CCCCCC"> on and</font>

114
00:04:34,400 --> 00:04:39,239
<font color="#E5E5E5">see all of their employees</font>

115
00:04:35,520 --> 00:04:42,479
so that filtering helps<font color="#CCCCCC"> save us having</font>

116
00:04:39,240 --> 00:04:44,699
to<font color="#CCCCCC"> deal with</font><font color="#E5E5E5"> filtering ourselves and so</font>

117
00:04:42,479 --> 00:04:46,409
the issue here<font color="#E5E5E5"> in</font><font color="#CCCCCC"> LinkedIn is great but</font>

118
00:04:44,699 --> 00:04:49,050
<font color="#E5E5E5">a lot of tools we found</font><font color="#CCCCCC"> were broken and</font>

119
00:04:46,410 --> 00:04:51,449
<font color="#E5E5E5">so mainly</font><font color="#CCCCCC"> due</font><font color="#E5E5E5"> to user interface</font><font color="#CCCCCC"> updates</font>

120
00:04:49,050 --> 00:04:54,060
over the past year and some tools were

121
00:04:51,449 --> 00:04:57,720
using<font color="#E5E5E5"> them like</font><font color="#CCCCCC"> LinkedIn that the</font>

122
00:04:54,060 --> 00:04:59,310
LinkedIn API which was fraught<font color="#CCCCCC"> old so we</font>

123
00:04:57,720 --> 00:05:02,819
went ahead<font color="#CCCCCC"> and developed a tool called</font>

124
00:04:59,310 --> 00:05:05,400
LinkedIn<font color="#CCCCCC"> this</font><font color="#E5E5E5"> was meant to streamline</font>

125
00:05:02,819 --> 00:05:07,680
the collection process<font color="#CCCCCC"> so</font><font color="#E5E5E5"> ideally I'd</font>

126
00:05:05,400 --> 00:05:09,960
want to<font color="#E5E5E5"> just give it a company name and</font>

127
00:05:07,680 --> 00:05:12,240
<font color="#CCCCCC">their domain and five</font><font color="#E5E5E5"> minutes later I'll</font>

128
00:05:09,960 --> 00:05:15,810
<font color="#CCCCCC">have a nice list of email addresses for</font>

129
00:05:12,240 --> 00:05:19,199
that<font color="#CCCCCC"> Tiger organization so this is based</font>

130
00:05:15,810 --> 00:05:21,449
off<font color="#E5E5E5"> Danny crustal scraper</font><font color="#CCCCCC"> and so I kept</font>

131
00:05:19,199 --> 00:05:24,180
<font color="#CCCCCC">said of I fixed the UI issues and I've</font>

132
00:05:21,449 --> 00:05:28,050
also implemented an email<font color="#E5E5E5"> format</font>

133
00:05:24,180 --> 00:05:29,699
prediction<font color="#E5E5E5"> using the hunter and API I'm</font>

134
00:05:28,050 --> 00:05:31,909
so<font color="#CCCCCC"> here's a quick demo of the</font><font color="#E5E5E5"> LinkedIn</font>

135
00:05:29,699 --> 00:05:31,909
<font color="#CCCCCC">to</font>

136
00:05:42,860 --> 00:05:47,999
so here we're<font color="#CCCCCC"> running the tool and we</font>

137
00:05:45,479 --> 00:05:50,969
begin<font color="#CCCCCC"> by</font><font color="#E5E5E5"> putting in the target company's</font>

138
00:05:47,999 --> 00:05:54,599
name<font color="#E5E5E5"> and start filling out</font><font color="#CCCCCC"> Li sort of</font>

139
00:05:50,969 --> 00:05:56,009
options here I put<font color="#E5E5E5"> General Motors calm</font>

140
00:05:54,599 --> 00:05:58,169
because<font color="#E5E5E5"> I thought that</font><font color="#CCCCCC"> was</font><font color="#E5E5E5"> General</font>

141
00:05:56,009 --> 00:06:02,389
<font color="#E5E5E5">Motors</font><font color="#CCCCCC"> domain but then I soon found out</font>

142
00:05:58,169 --> 00:06:02,389
later GM<font color="#E5E5E5"> calm so go</font><font color="#CCCCCC"> ahead and fix up</font>

143
00:06:03,169 --> 00:06:11,878
<font color="#CCCCCC">yeah let's put Auto to</font><font color="#E5E5E5"> automatically</font>

144
00:06:06,389 --> 00:06:14,009
perform the prefix detection<font color="#CCCCCC"> ok it</font>

145
00:06:11,879 --> 00:06:15,860
begins scraping<font color="#E5E5E5"> so here we can see like</font>

146
00:06:14,009 --> 00:06:18,659
<font color="#CCCCCC">the</font><font color="#E5E5E5"> some</font><font color="#CCCCCC"> headless profiles found what's</font>

147
00:06:15,860 --> 00:06:21,300
due to<font color="#CCCCCC"> the fatwa</font><font color="#E5E5E5"> the account what I'm</font>

148
00:06:18,659 --> 00:06:23,069
using on<font color="#CCCCCC"> LinkedIn doesn't have a third</font>

149
00:06:21,300 --> 00:06:25,710
<font color="#CCCCCC">degree connection to the target</font><font color="#E5E5E5"> so it</font>

150
00:06:23,069 --> 00:06:27,240
can't see<font color="#E5E5E5"> that profile so so soon sort</font>

151
00:06:25,710 --> 00:06:30,029
of like improve<font color="#E5E5E5"> these results you</font><font color="#CCCCCC"> can</font>

152
00:06:27,240 --> 00:06:31,740
begin connecting with<font color="#E5E5E5"> people within that</font>

153
00:06:30,029 --> 00:06:33,479
organization because<font color="#CCCCCC"> they're</font><font color="#E5E5E5"> more likely</font>

154
00:06:31,740 --> 00:06:35,969
<font color="#E5E5E5">to be connected</font><font color="#CCCCCC"> in some way</font><font color="#E5E5E5"> to another</font>

155
00:06:33,479 --> 00:06:40,099
<font color="#CCCCCC">employee</font><font color="#E5E5E5"> and might improve look at the</font>

156
00:06:35,969 --> 00:06:42,839
results<font color="#E5E5E5"> so it outputs two formats</font>

157
00:06:40,099 --> 00:06:44,930
<font color="#CCCCCC">there's a HTML</font><font color="#E5E5E5"> report which soft gives</font>

158
00:06:42,839 --> 00:06:48,270
you like the image<font color="#CCCCCC"> like a profile photo</font>

159
00:06:44,930 --> 00:06:50,009
their title and location<font color="#E5E5E5"> so that's great</font>

160
00:06:48,270 --> 00:06:51,719
<font color="#CCCCCC">for you know</font><font color="#E5E5E5"> just scrolling through and</font>

161
00:06:50,009 --> 00:06:55,469
<font color="#E5E5E5">having a</font><font color="#CCCCCC"> look at people's photos but</font>

162
00:06:51,719 --> 00:07:00,060
we've got another format<font color="#E5E5E5"> a CSV format as</font>

163
00:06:55,469 --> 00:07:02,250
well so<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is more handy for and</font>

164
00:07:00,060 --> 00:07:03,870
<font color="#E5E5E5">penetration testers and the search</font>

165
00:07:02,250 --> 00:07:06,289
because that you<font color="#E5E5E5"> can learn just</font><font color="#CCCCCC"> click</font>

166
00:07:03,870 --> 00:07:08,279
and start filtering by location or title

167
00:07:06,289 --> 00:07:11,460
removing and people you<font color="#E5E5E5"> don't</font><font color="#CCCCCC"> want to</font>

168
00:07:08,279 --> 00:07:13,259
fish or an target and then yeah you can

169
00:07:11,460 --> 00:07:14,938
<font color="#CCCCCC">just slightly column and cut and paste</font>

170
00:07:13,259 --> 00:07:17,419
it into a text file<font color="#E5E5E5"> for importing into</font>

171
00:07:14,939 --> 00:07:17,419
<font color="#E5E5E5">other tools</font>

172
00:07:27,060 --> 00:07:33,880
so now<font color="#CCCCCC"> dumb it's going to talk a bit</font>

173
00:07:30,310 --> 00:07:35,080
about infiltration<font color="#CCCCCC"> soon filtration is</font>

174
00:07:33,880 --> 00:07:36,849
sometimes one<font color="#CCCCCC"> of the hardest</font><font color="#E5E5E5"> parts of</font>

175
00:07:35,080 --> 00:07:38,139
<font color="#E5E5E5">our</font><font color="#CCCCCC"> team exercise and traditionally a</font>

176
00:07:36,849 --> 00:07:38,610
<font color="#CCCCCC">lot of</font><font color="#E5E5E5"> focus has been on things</font><font color="#CCCCCC"> like</font>

177
00:07:38,139 --> 00:07:41,259
fishing

178
00:07:38,610 --> 00:07:43,780
but this<font color="#E5E5E5"> taxes is often closely</font><font color="#CCCCCC"> watched</font>

179
00:07:41,259 --> 00:07:44,860
by<font color="#E5E5E5"> and the blue team so unless you're</font>

180
00:07:43,780 --> 00:07:47,020
creating a particularly low noise

181
00:07:44,860 --> 00:07:48,940
targeted spearfishing campaign there's

182
00:07:47,020 --> 00:07:50,440
potential for<font color="#CCCCCC"> you to get spotted</font><font color="#E5E5E5"> so we</font>

183
00:07:48,940 --> 00:07:51,969
were particularly interested<font color="#CCCCCC"> in other</font>

184
00:07:50,440 --> 00:07:54,910
vectors to target corporate networks

185
00:07:51,970 --> 00:07:56,680
aside<font color="#E5E5E5"> from fishing although I do have to</font>

186
00:07:54,910 --> 00:07:57,909
admit<font color="#E5E5E5"> in some</font><font color="#CCCCCC"> cases it</font><font color="#E5E5E5"> may just be as</font>

187
00:07:56,680 --> 00:08:00,130
simple<font color="#CCCCCC"> as sending your target a</font>

188
00:07:57,909 --> 00:08:01,630
carefully crafted<font color="#CCCCCC"> fishing email asking</font>

189
00:08:00,130 --> 00:08:04,930
<font color="#E5E5E5">them to</font><font color="#CCCCCC"> run a Python</font><font color="#E5E5E5"> command on the</font>

190
00:08:01,630 --> 00:08:06,940
terminal of their MacBook however as we

191
00:08:04,930 --> 00:08:09,340
<font color="#E5E5E5">found out in this case even this isn't</font>

192
00:08:06,940 --> 00:08:10,659
<font color="#CCCCCC">foolproof as when they</font><font color="#E5E5E5"> were providing</font>

193
00:08:09,340 --> 00:08:12,099
<font color="#CCCCCC">tech supports poor old Colin when we</font>

194
00:08:10,659 --> 00:08:13,810
encountered issues with the version of

195
00:08:12,099 --> 00:08:17,650
Python<font color="#E5E5E5"> open SSL that was on his Mac when</font>

196
00:08:13,810 --> 00:08:19,120
we're trying<font color="#E5E5E5"> to run our payload so</font>

197
00:08:17,650 --> 00:08:20,770
there's been some really interesting

198
00:08:19,120 --> 00:08:21,909
developments in targeting exchange

199
00:08:20,770 --> 00:08:23,500
environments<font color="#CCCCCC"> over the past twelve months</font>

200
00:08:21,909 --> 00:08:25,719
<font color="#CCCCCC">as well</font><font color="#E5E5E5"> as some really</font><font color="#CCCCCC"> impressive</font>

201
00:08:23,500 --> 00:08:27,009
<font color="#CCCCCC">tooling that has been</font><font color="#E5E5E5"> released and so</font>

202
00:08:25,720 --> 00:08:29,110
<font color="#E5E5E5">particularly there's been tools like</font>

203
00:08:27,009 --> 00:08:30,789
<font color="#CCCCCC">male sniper and ruler which can be used</font>

204
00:08:29,110 --> 00:08:32,800
to perform<font color="#E5E5E5"> password guessing attacks</font>

205
00:08:30,789 --> 00:08:35,049
against exchange as well<font color="#CCCCCC"> as in some</font>

206
00:08:32,799 --> 00:08:36,069
cases injects arbitrary<font color="#CCCCCC"> Awa rules to</font><font color="#E5E5E5"> get</font>

207
00:08:35,049 --> 00:08:39,819
<font color="#E5E5E5">in code execution on the</font><font color="#CCCCCC"> user's</font>

208
00:08:36,070 --> 00:08:40,719
workstation<font color="#CCCCCC"> with</font><font color="#E5E5E5"> this in mind we start</font>

209
00:08:39,820 --> 00:08:43,000
to think<font color="#CCCCCC"> about some of</font><font color="#E5E5E5"> the other</font>

210
00:08:40,719 --> 00:08:44,860
services<font color="#CCCCCC"> that are exposed and also</font>

211
00:08:43,000 --> 00:08:46,930
integrated<font color="#E5E5E5"> into Active Directory</font><font color="#CCCCCC"> and one</font>

212
00:08:44,860 --> 00:08:50,940
that kind of crept<font color="#E5E5E5"> and kept cropping up</font>

213
00:08:46,930 --> 00:08:52,779
to us was an link or sky for business

214
00:08:50,940 --> 00:08:54,700
but<font color="#CCCCCC"> unfortunately</font><font color="#E5E5E5"> we couldn't actually</font>

215
00:08:52,779 --> 00:08:58,540
find<font color="#E5E5E5"> any real kind of research targeting</font>

216
00:08:54,700 --> 00:08:59,709
these services<font color="#CCCCCC"> so Skype for business or</font>

217
00:08:58,540 --> 00:09:01,750
Microsoft<font color="#CCCCCC"> links it was formerly known</font>

218
00:08:59,709 --> 00:09:05,439
typically comes in one<font color="#CCCCCC"> of two flavors</font>

219
00:09:01,750 --> 00:09:08,170
and that<font color="#E5E5E5"> is using an</font><font color="#CCCCCC"> on-premise</font><font color="#E5E5E5"> and sky</font>

220
00:09:05,440 --> 00:09:11,350
for business server or the hosted

221
00:09:08,170 --> 00:09:15,130
<font color="#E5E5E5">cloud-based federated sky for business</font>

222
00:09:11,350 --> 00:09:16,540
installation<font color="#E5E5E5"> fortunately for us kind of</font>

223
00:09:15,130 --> 00:09:17,709
identifying whether an<font color="#CCCCCC"> organization is</font>

224
00:09:16,540 --> 00:09:22,569
<font color="#CCCCCC">using Skype for business is</font><font color="#E5E5E5"> actually</font>

225
00:09:17,709 --> 00:09:23,949
<font color="#E5E5E5">relatively trivial because the the</font>

226
00:09:22,570 --> 00:09:25,750
service<font color="#CCCCCC"> actually supports the</font><font color="#E5E5E5"> concepts</font>

227
00:09:23,950 --> 00:09:28,750
of also discovery so that is and they'll

228
00:09:25,750 --> 00:09:30,430
typically<font color="#E5E5E5"> be certain DNS entries on the</font>

229
00:09:28,750 --> 00:09:32,650
target<font color="#E5E5E5"> domain</font><font color="#CCCCCC"> things like link</font><font color="#E5E5E5"> discover</font>

230
00:09:30,430 --> 00:09:34,000
dot whatever<font color="#E5E5E5"> the company's domain is or</font>

231
00:09:32,650 --> 00:09:35,890
link discover internal about whatever

232
00:09:34,000 --> 00:09:37,660
the company's<font color="#CCCCCC"> domain is</font><font color="#E5E5E5"> and aside from</font>

233
00:09:35,890 --> 00:09:39,220
<font color="#CCCCCC">that the services that the</font>

234
00:09:37,660 --> 00:09:40,360
<font color="#CCCCCC">scottie business</font><font color="#E5E5E5"> sports are actually</font>

235
00:09:39,220 --> 00:09:42,160
relatively distinct if they've got

236
00:09:40,360 --> 00:09:43,330
relatively<font color="#E5E5E5"> stinky service banners so you</font>

237
00:09:42,160 --> 00:09:47,980
can quickly<font color="#E5E5E5"> find them on things like</font>

238
00:09:43,330 --> 00:09:49,660
<font color="#E5E5E5">show them so we were particularly</font>

239
00:09:47,980 --> 00:09:51,190
<font color="#E5E5E5">interested in how widespread sky for</font>

240
00:09:49,660 --> 00:09:52,900
<font color="#E5E5E5">business deployments were so we ran a</font>

241
00:09:51,190 --> 00:09:55,360
quick<font color="#E5E5E5"> DNS enumeration across the Alexa</font>

242
00:09:52,900 --> 00:09:56,560
top 1<font color="#E5E5E5"> million we found that roughly 26</font>

243
00:09:55,360 --> 00:09:58,960
percent<font color="#E5E5E5"> of them were using Skype for</font>

244
00:09:56,560 --> 00:10:02,050
<font color="#CCCCCC">business</font><font color="#E5E5E5"> and off that</font><font color="#CCCCCC"> 3.7</font><font color="#E5E5E5"> central using</font>

245
00:09:58,960 --> 00:10:03,250
office 365<font color="#E5E5E5"> so as I mentioned</font><font color="#CCCCCC"> because the</font>

246
00:10:02,050 --> 00:10:05,079
sky for business typically integrates

247
00:10:03,250 --> 00:10:06,790
into<font color="#CCCCCC"> aad and</font><font color="#E5E5E5"> we believe this might</font>

248
00:10:05,080 --> 00:10:09,400
<font color="#E5E5E5">provide a useful</font><font color="#CCCCCC"> opportunity to identify</font>

249
00:10:06,790 --> 00:10:10,900
<font color="#CCCCCC">ad credentials from</font><font color="#E5E5E5"> the internet but</font>

250
00:10:09,400 --> 00:10:11,980
unfortunately there were<font color="#CCCCCC"> no real tools</font>

251
00:10:10,900 --> 00:10:14,290
around<font color="#E5E5E5"> to communicate with these</font>

252
00:10:11,980 --> 00:10:16,780
<font color="#E5E5E5">services and this led to the</font><font color="#CCCCCC"> development</font>

253
00:10:14,290 --> 00:10:19,030
<font color="#E5E5E5">of an in-house at all and it's now</font>

254
00:10:16,780 --> 00:10:19,510
<font color="#CCCCCC">available on our github page called</font><font color="#E5E5E5"> link</font>

255
00:10:19,030 --> 00:10:22,180
sniper

256
00:10:19,510 --> 00:10:25,420
<font color="#CCCCCC">I said link sniper can be used to</font><font color="#E5E5E5"> target</font>

257
00:10:22,180 --> 00:10:26,589
<font color="#CCCCCC">spam</font><font color="#E5E5E5"> Skype for business services and</font><font color="#CCCCCC"> one</font>

258
00:10:25,420 --> 00:10:28,060
of the first<font color="#E5E5E5"> things we need to do when</font>

259
00:10:26,590 --> 00:10:29,350
developing<font color="#E5E5E5"> link sniper was really kind</font>

260
00:10:28,060 --> 00:10:31,390
<font color="#CCCCCC">of understand how the authentication</font>

261
00:10:29,350 --> 00:10:33,520
works<font color="#E5E5E5"> and what we found was</font><font color="#CCCCCC"> at Skype for</font>

262
00:10:31,390 --> 00:10:36,730
business such as<font color="#CCCCCC"> eSports</font><font color="#E5E5E5"> ntlm kerberos</font>

263
00:10:33,520 --> 00:10:38,980
and<font color="#CCCCCC"> a wealth of education</font><font color="#E5E5E5"> the one that</font>

264
00:10:36,730 --> 00:10:41,380
appeared to<font color="#E5E5E5"> work the easiest for us was</font>

265
00:10:38,980 --> 00:10:42,340
a<font color="#CCCCCC"> Wharf and this was is</font><font color="#E5E5E5"> actually</font>

266
00:10:41,380 --> 00:10:44,290
relatively<font color="#E5E5E5"> straightforward</font><font color="#CCCCCC"> to implement</font>

267
00:10:42,340 --> 00:10:47,110
<font color="#E5E5E5">so there wasn't any real documentation</font>

268
00:10:44,290 --> 00:10:50,170
<font color="#E5E5E5">on this but we</font><font color="#CCCCCC"> found</font><font color="#E5E5E5"> that as long as you</font>

269
00:10:47,110 --> 00:10:52,060
<font color="#CCCCCC">provide a certain post request to descry</font>

270
00:10:50,170 --> 00:10:54,099
<font color="#E5E5E5">for business service with a grant type</font>

271
00:10:52,060 --> 00:10:56,050
of password<font color="#E5E5E5"> then it actually is</font><font color="#CCCCCC"> just a</font>

272
00:10:54,100 --> 00:10:57,400
case of<font color="#E5E5E5"> spying a username and password</font>

273
00:10:56,050 --> 00:11:00,189
<font color="#CCCCCC">which is was relatively straightforward</font>

274
00:10:57,400 --> 00:11:02,650
<font color="#CCCCCC">to implement</font><font color="#E5E5E5"> but given the service</font><font color="#CCCCCC"> also</font>

275
00:11:00,190 --> 00:11:04,420
<font color="#CCCCCC">sports</font><font color="#E5E5E5"> and NC lemon Kerberos there's</font>

276
00:11:02,650 --> 00:11:05,709
also<font color="#E5E5E5"> potential to do things like pass</font>

277
00:11:04,420 --> 00:11:08,610
the<font color="#E5E5E5"> hash</font><font color="#CCCCCC"> and pass the ticket type</font>

278
00:11:05,710 --> 00:11:08,610
attacks<font color="#E5E5E5"> against</font><font color="#CCCCCC"> Skype for business</font>

279
00:11:08,620 --> 00:11:13,090
so we implementing that into<font color="#E5E5E5"> link sniper</font>

280
00:11:11,020 --> 00:11:15,670
<font color="#CCCCCC">and it works relatively well</font><font color="#E5E5E5"> and again</font>

281
00:11:13,090 --> 00:11:18,910
start<font color="#CCCCCC"> on-premise services and but what</font>

282
00:11:15,670 --> 00:11:20,620
we quickly found was that the this<font color="#E5E5E5"> Roth</font>

283
00:11:18,910 --> 00:11:23,949
type isn't<font color="#E5E5E5"> actually supported in office</font>

284
00:11:20,620 --> 00:11:26,470
365<font color="#E5E5E5"> office 365 users and ws-trust</font>

285
00:11:23,950 --> 00:11:28,660
and<font color="#E5E5E5"> rst authentication so these are the</font>

286
00:11:26,470 --> 00:11:31,540
core fundamental protocols that are<font color="#CCCCCC"> used</font>

287
00:11:28,660 --> 00:11:34,420
<font color="#E5E5E5">by Microsoft security</font><font color="#CCCCCC"> tarin services and</font>

288
00:11:31,540 --> 00:11:36,550
<font color="#CCCCCC">ad FS</font><font color="#E5E5E5"> but this again was relatively well</font>

289
00:11:34,420 --> 00:11:38,140
documented<font color="#E5E5E5"> on</font><font color="#CCCCCC"> MSDN so we were able to</font>

290
00:11:36,550 --> 00:11:39,939
<font color="#CCCCCC">implement this into the link sniper and</font>

291
00:11:38,140 --> 00:11:41,530
that basically<font color="#E5E5E5"> gave us a tool that we</font>

292
00:11:39,940 --> 00:11:42,850
were able<font color="#CCCCCC"> to use to perform password</font>

293
00:11:41,530 --> 00:11:44,490
spraying password<font color="#E5E5E5"> brute-force attacks</font>

294
00:11:42,850 --> 00:11:47,260
against<font color="#E5E5E5"> and Skype for business</font>

295
00:11:44,490 --> 00:11:48,760
environments and we're also currently

296
00:11:47,260 --> 00:11:50,530
<font color="#CCCCCC">working on some</font><font color="#E5E5E5"> additional functionality</font>

297
00:11:48,760 --> 00:11:51,610
<font color="#CCCCCC">which I'll talk about in a couple of</font>

298
00:11:50,530 --> 00:11:55,649
<font color="#CCCCCC">slides but first log</font>

299
00:11:51,610 --> 00:11:55,649
view<font color="#E5E5E5"> and a quick demo of the tool so</font>

300
00:12:03,240 --> 00:12:07,839
<font color="#E5E5E5">link snipers implemented as a PowerShell</font>

301
00:12:05,950 --> 00:12:10,480
<font color="#E5E5E5">module and there's a number of</font>

302
00:12:07,839 --> 00:12:12,220
commandlets<font color="#E5E5E5"> so I'll just quickly</font><font color="#CCCCCC"> showing</font>

303
00:12:10,480 --> 00:12:13,839
<font color="#E5E5E5">you that I've got</font><font color="#CCCCCC"> a text file just</font><font color="#E5E5E5"> with</font>

304
00:12:12,220 --> 00:12:15,550
a bunch of kind<font color="#E5E5E5"> of email addresses</font><font color="#CCCCCC"> in</font>

305
00:12:13,839 --> 00:12:17,769
for our organization<font color="#E5E5E5"> and we're going to</font>

306
00:12:15,550 --> 00:12:20,079
spray the password<font color="#E5E5E5"> welcome one against</font>

307
00:12:17,769 --> 00:12:22,240
this the<font color="#E5E5E5"> MD set company so the first</font>

308
00:12:20,079 --> 00:12:24,040
thing<font color="#CCCCCC"> link sniper does is it will do the</font>

309
00:12:22,240 --> 00:12:25,750
<font color="#E5E5E5">auto</font><font color="#CCCCCC"> discovery and find the relevant</font>

310
00:12:24,040 --> 00:12:28,180
authentication endpoints<font color="#CCCCCC"> to scout for</font>

311
00:12:25,750 --> 00:12:29,740
<font color="#CCCCCC">business it will then basically spray</font>

312
00:12:28,180 --> 00:12:31,209
the<font color="#CCCCCC"> welcome one password</font><font color="#E5E5E5"> against all the</font>

313
00:12:29,740 --> 00:12:32,410
enumerated email addresses<font color="#CCCCCC"> so if you've</font>

314
00:12:31,209 --> 00:12:34,000
<font color="#CCCCCC">used something</font><font color="#E5E5E5"> like the LinkedIn</font><font color="#CCCCCC"> it's</font>

315
00:12:32,410 --> 00:12:35,649
all that Vincent demonstrated you've

316
00:12:34,000 --> 00:12:37,450
done your email collection<font color="#CCCCCC"> you can then</font>

317
00:12:35,649 --> 00:12:39,519
spray a password against all<font color="#E5E5E5"> those</font>

318
00:12:37,450 --> 00:12:42,040
emails and<font color="#E5E5E5"> figure out and in this case</font>

319
00:12:39,519 --> 00:12:43,540
<font color="#CCCCCC">Scott</font><font color="#E5E5E5"> link snipers identified one for</font>

320
00:12:42,040 --> 00:12:45,250
the<font color="#CCCCCC"> Joe doc bob</font><font color="#E5E5E5"> shoes or MD</font><font color="#CCCCCC"> say that</font>

321
00:12:43,540 --> 00:12:46,779
<font color="#CCCCCC">Cody at UK and</font><font color="#E5E5E5"> it's told us that</font><font color="#CCCCCC"> that</font>

322
00:12:45,250 --> 00:12:48,640
<font color="#CCCCCC">Savard set of credentials we could now</font>

323
00:12:46,779 --> 00:12:50,670
use<font color="#E5E5E5"> that</font><font color="#CCCCCC"> credentials to kind of</font><font color="#E5E5E5"> get</font>

324
00:12:48,640 --> 00:13:01,449
access to the<font color="#CCCCCC"> guy's sky for</font><font color="#E5E5E5"> business</font>

325
00:12:50,670 --> 00:13:03,000
environment so while describing<font color="#E5E5E5"> Skype</font>

326
00:13:01,449 --> 00:13:05,529
authentication I briefly<font color="#CCCCCC"> mentioned</font>

327
00:13:03,000 --> 00:13:07,990
Federation<font color="#CCCCCC"> but I didn't actually explain</font>

328
00:13:05,529 --> 00:13:09,760
what it<font color="#CCCCCC"> is</font><font color="#E5E5E5"> so officially it's a way of</font>

329
00:13:07,990 --> 00:13:11,829
providing single sign-on across

330
00:13:09,760 --> 00:13:13,360
boundaries<font color="#E5E5E5"> but</font><font color="#CCCCCC"> unofficially it's a way</font>

331
00:13:11,829 --> 00:13:15,000
<font color="#E5E5E5">of exposing Active Directory to the</font>

332
00:13:13,360 --> 00:13:16,949
<font color="#E5E5E5">Internet which from an offensive</font>

333
00:13:15,000 --> 00:13:20,829
perspective is<font color="#CCCCCC"> actually pretty awesome</font>

334
00:13:16,949 --> 00:13:22,899
<font color="#E5E5E5">so essentially what you can do with</font>

335
00:13:20,829 --> 00:13:24,160
federated services is you can share the

336
00:13:22,899 --> 00:13:25,839
identity of<font color="#E5E5E5"> someone</font><font color="#CCCCCC"> within your</font>

337
00:13:24,160 --> 00:13:28,390
organization with<font color="#CCCCCC"> your trusted business</font>

338
00:13:25,839 --> 00:13:30,640
<font color="#E5E5E5">partners now that might</font><font color="#CCCCCC"> be from one</font>

339
00:13:28,390 --> 00:13:32,170
domain to another<font color="#E5E5E5"> ie company</font><font color="#CCCCCC"> aids</font>

340
00:13:30,640 --> 00:13:33,970
<font color="#E5E5E5">company</font><font color="#CCCCCC"> B or it could be</font><font color="#E5E5E5"> from one</font>

341
00:13:32,170 --> 00:13:35,349
<font color="#E5E5E5">company to Microsoft themselves this</font>

342
00:13:33,970 --> 00:13:37,570
would this<font color="#CCCCCC"> would then allow</font><font color="#E5E5E5"> you to do</font>

343
00:13:35,350 --> 00:13:40,810
things<font color="#CCCCCC"> like and use cloud services such</font>

344
00:13:37,570 --> 00:13:42,130
<font color="#CCCCCC">as office 365 with your internal ad and</font>

345
00:13:40,810 --> 00:13:44,170
so why<font color="#E5E5E5"> is this interesting</font><font color="#CCCCCC"> why is this</font>

346
00:13:42,130 --> 00:13:46,720
relevant<font color="#E5E5E5"> to</font><font color="#CCCCCC"> sky</font><font color="#E5E5E5"> well when we started to</font>

347
00:13:44,170 --> 00:13:48,339
look<font color="#CCCCCC"> at</font><font color="#E5E5E5"> how some of the attacks against</font>

348
00:13:46,720 --> 00:13:49,329
<font color="#E5E5E5">sky for business will perform we</font>

349
00:13:48,339 --> 00:13:51,160
discovered this kind of really

350
00:13:49,329 --> 00:13:53,410
<font color="#E5E5E5">interesting option in the office this is</font>

351
00:13:51,160 --> 00:13:55,540
<font color="#E5E5E5">five admin panel</font><font color="#CCCCCC"> so under this kind of</font>

352
00:13:53,410 --> 00:13:58,120
<font color="#CCCCCC">external communications tab there was an</font>

353
00:13:55,540 --> 00:13:59,980
option saying public public I<font color="#E5E5E5"> am</font>

354
00:13:58,120 --> 00:14:01,660
connectivity let people use Skype for

355
00:13:59,980 --> 00:14:03,790
<font color="#CCCCCC">business to communicate with Skype users</font>

356
00:14:01,660 --> 00:14:06,040
outside<font color="#CCCCCC"> of</font><font color="#E5E5E5"> the organization</font><font color="#CCCCCC"> so what does</font>

357
00:14:03,790 --> 00:14:07,870
this mean well basically<font color="#E5E5E5"> it means</font>

358
00:14:06,040 --> 00:14:10,180
is if I've<font color="#CCCCCC"> got an federated</font>

359
00:14:07,870 --> 00:14:11,829
authentication turned on and another

360
00:14:10,180 --> 00:14:13,269
<font color="#E5E5E5">company has that means that I can</font>

361
00:14:11,829 --> 00:14:16,479
<font color="#E5E5E5">actually just go ahead and talk to any</font>

362
00:14:13,269 --> 00:14:17,980
of<font color="#E5E5E5"> their users</font><font color="#CCCCCC"> and this is this</font><font color="#E5E5E5"> has</font>

363
00:14:16,480 --> 00:14:19,870
proved<font color="#E5E5E5"> really useful to us during Red</font>

364
00:14:17,980 --> 00:14:23,709
<font color="#E5E5E5">Team exercises because we've basically</font>

365
00:14:19,870 --> 00:14:25,089
<font color="#E5E5E5">been able to directly talk to employees</font>

366
00:14:23,709 --> 00:14:29,619
within<font color="#E5E5E5"> a company</font><font color="#CCCCCC"> without actually having</font>

367
00:14:25,089 --> 00:14:32,980
<font color="#E5E5E5">a an account within their office 365</font>

368
00:14:29,620 --> 00:14:35,529
environment<font color="#CCCCCC"> so it also allows us to do</font>

369
00:14:32,980 --> 00:14:37,360
<font color="#E5E5E5">other things aside from kind of direct</font>

370
00:14:35,529 --> 00:14:38,860
iron-based<font color="#E5E5E5"> spearfishing we can also do</font>

371
00:14:37,360 --> 00:14:40,329
things<font color="#CCCCCC"> like user enumeration so we can</font>

372
00:14:38,860 --> 00:14:43,060
verify whether we<font color="#CCCCCC"> murderesses are</font>

373
00:14:40,329 --> 00:14:44,560
correct or<font color="#CCCCCC"> not we can actually get</font><font color="#E5E5E5"> in</font>

374
00:14:43,060 --> 00:14:46,268
presence whether it<font color="#CCCCCC"> users online</font><font color="#E5E5E5"> at a</font>

375
00:14:44,560 --> 00:14:47,560
given time which is also<font color="#E5E5E5"> useful if we're</font>

376
00:14:46,269 --> 00:14:51,100
<font color="#E5E5E5">doing things</font><font color="#CCCCCC"> like a physical reading</font>

377
00:14:47,560 --> 00:14:54,069
exercise so what we<font color="#CCCCCC"> actually did to</font>

378
00:14:51,100 --> 00:14:55,990
abuse<font color="#CCCCCC"> this was we went</font><font color="#E5E5E5"> and created a new</font>

379
00:14:54,069 --> 00:14:58,810
account<font color="#E5E5E5"> on office 365 called Skype</font>

380
00:14:55,990 --> 00:15:01,360
supports and using<font color="#CCCCCC"> this Skype support</font>

381
00:14:58,810 --> 00:15:02,469
account<font color="#E5E5E5"> on the kind of</font><font color="#CCCCCC"> left-hand side</font><font color="#E5E5E5"> so</font>

382
00:15:01,360 --> 00:15:03,759
<font color="#E5E5E5">this is</font><font color="#CCCCCC"> the kind of</font><font color="#E5E5E5"> view</font><font color="#CCCCCC"> that the</font>

383
00:15:02,470 --> 00:15:06,730
attacker<font color="#E5E5E5"> would get we were actually able</font>

384
00:15:03,759 --> 00:15:09,550
<font color="#E5E5E5">to send</font><font color="#CCCCCC"> messages to</font><font color="#E5E5E5"> in this case the</font><font color="#CCCCCC"> the</font>

385
00:15:06,730 --> 00:15:11,230
<font color="#E5E5E5">MD</font><font color="#CCCCCC"> tech</font><font color="#E5E5E5"> organization to this</font><font color="#CCCCCC"> jobox user</font>

386
00:15:09,550 --> 00:15:12,639
<font color="#E5E5E5">and this is what the jobox user would</font>

387
00:15:11,230 --> 00:15:14,410
see<font color="#CCCCCC"> he would basically see he's got</font><font color="#E5E5E5"> an</font>

388
00:15:12,639 --> 00:15:15,790
<font color="#CCCCCC">IM coming in</font><font color="#E5E5E5"> saying you know there's</font>

389
00:15:14,410 --> 00:15:17,740
<font color="#E5E5E5">been</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> skype update</font><font color="#CCCCCC"> you need to kind of</font>

390
00:15:15,790 --> 00:15:19,779
download and run this this<font color="#E5E5E5"> executable</font>

391
00:15:17,740 --> 00:15:21,790
and if you if you were looking<font color="#E5E5E5"> at it</font>

392
00:15:19,779 --> 00:15:23,139
<font color="#CCCCCC">from this perspective and this as</font><font color="#E5E5E5"> I said</font>

393
00:15:21,790 --> 00:15:24,699
this<font color="#E5E5E5"> is what the kind of</font><font color="#CCCCCC"> the victim</font>

394
00:15:23,139 --> 00:15:27,069
would see there's not too much to<font color="#CCCCCC"> give</font>

395
00:15:24,699 --> 00:15:29,800
it away that that user isn't<font color="#E5E5E5"> part of</font>

396
00:15:27,069 --> 00:15:31,949
Skype or part of<font color="#E5E5E5"> his</font><font color="#CCCCCC"> organisation</font><font color="#E5E5E5"> except</font>

397
00:15:29,800 --> 00:15:34,120
for this<font color="#E5E5E5"> little area</font><font color="#CCCCCC"> here that</font><font color="#E5E5E5"> says</font>

398
00:15:31,949 --> 00:15:36,040
external<font color="#CCCCCC"> network and that's</font><font color="#E5E5E5"> basically</font>

399
00:15:34,120 --> 00:15:37,480
<font color="#E5E5E5">the only distinguishing factor that</font>

400
00:15:36,040 --> 00:15:39,939
shows that it's not<font color="#E5E5E5"> part of the mb/sec</font>

401
00:15:37,480 --> 00:15:41,170
organization and if he wanted to kind of

402
00:15:39,940 --> 00:15:42,430
drill down<font color="#E5E5E5"> into the contacts</font><font color="#CCCCCC"> he could</font>

403
00:15:41,170 --> 00:15:44,800
actually see what email address the

404
00:15:42,430 --> 00:15:47,019
music was created<font color="#E5E5E5"> with or what the</font>

405
00:15:44,800 --> 00:15:48,459
<font color="#E5E5E5">emerges the account had and in this case</font>

406
00:15:47,019 --> 00:15:49,870
what we<font color="#CCCCCC"> actually did was and we found</font>

407
00:15:48,459 --> 00:15:51,489
<font color="#E5E5E5">like a Microsoft domain that just</font>

408
00:15:49,870 --> 00:15:53,829
expired<font color="#E5E5E5"> and we went and</font><font color="#CCCCCC"> registered it</font>

409
00:15:51,490 --> 00:15:55,839
<font color="#CCCCCC">and so basically if he did</font><font color="#E5E5E5"> look into</font>

410
00:15:53,829 --> 00:16:00,760
that he would<font color="#CCCCCC"> actually see that it's a</font>

411
00:15:55,839 --> 00:16:02,589
valid<font color="#CCCCCC"> Microsoft name so kind of</font><font color="#E5E5E5"> moving</font>

412
00:16:00,760 --> 00:16:04,959
<font color="#E5E5E5">on from infiltration but in a in a</font>

413
00:16:02,589 --> 00:16:06,040
relatively similar area and we'll talk

414
00:16:04,959 --> 00:16:07,388
about<font color="#E5E5E5"> some of</font><font color="#CCCCCC"> the things that</font><font color="#E5E5E5"> we've</font><font color="#CCCCCC"> seen</font>

415
00:16:06,040 --> 00:16:09,370
<font color="#CCCCCC">developed from the perspective of</font>

416
00:16:07,389 --> 00:16:11,259
defensive evasion see the tricks<font color="#CCCCCC"> that</font>

417
00:16:09,370 --> 00:16:12,610
have come to light<font color="#CCCCCC"> for evading specific</font>

418
00:16:11,259 --> 00:16:15,420
security products or<font color="#E5E5E5"> blue</font><font color="#CCCCCC"> ting</font>

419
00:16:12,610 --> 00:16:15,420
monitoring tactics

420
00:16:16,010 --> 00:16:20,510
so as the<font color="#E5E5E5"> first line of defense and</font><font color="#CCCCCC"> the</font>

421
00:16:19,040 --> 00:16:23,000
corporate<font color="#E5E5E5"> web proxy is often a good</font>

422
00:16:20,510 --> 00:16:24,740
place to<font color="#CCCCCC"> kind</font><font color="#E5E5E5"> of firm up your controls</font>

423
00:16:23,000 --> 00:16:26,690
<font color="#CCCCCC">and one of the controls that</font><font color="#E5E5E5"> we often</font>

424
00:16:24,740 --> 00:16:27,980
see<font color="#CCCCCC"> organizations implement</font><font color="#E5E5E5"> to limit the</font>

425
00:16:26,690 --> 00:16:29,930
sites<font color="#E5E5E5"> that can be</font><font color="#CCCCCC"> accessed through their</font>

426
00:16:27,980 --> 00:16:31,940
proxy is the concept of categorization<font color="#CCCCCC"> a</font>

427
00:16:29,930 --> 00:16:34,089
lot of companies consider customization

428
00:16:31,940 --> 00:16:36,530
to be a security<font color="#E5E5E5"> boundary we don't and</font>

429
00:16:34,090 --> 00:16:38,510
so what does categorization do well

430
00:16:36,530 --> 00:16:40,990
<font color="#E5E5E5">effectively allows you to black hole</font>

431
00:16:38,510 --> 00:16:43,760
unknown or<font color="#CCCCCC"> run</font><font color="#E5E5E5"> categorized sites or</font>

432
00:16:40,990 --> 00:16:46,490
<font color="#E5E5E5">restrict and users to accessing</font><font color="#CCCCCC"> only</font>

433
00:16:43,760 --> 00:16:48,590
sites of a certain category so for

434
00:16:46,490 --> 00:16:50,780
<font color="#E5E5E5">example you can configure your proxy to</font>

435
00:16:48,590 --> 00:16:53,060
say maybe<font color="#E5E5E5"> only allow users</font><font color="#CCCCCC"> to access</font>

436
00:16:50,780 --> 00:16:54,500
business<font color="#E5E5E5"> sites and they could block</font>

437
00:16:53,060 --> 00:16:56,540
sites of a certain category maybe you

438
00:16:54,500 --> 00:16:58,580
don't want users<font color="#CCCCCC"> to access my adult</font>

439
00:16:56,540 --> 00:17:01,849
sites or sites containing profanity<font color="#E5E5E5"> you</font>

440
00:16:58,580 --> 00:17:03,980
can do that<font color="#CCCCCC"> with</font><font color="#E5E5E5"> categorization now that</font>

441
00:17:01,850 --> 00:17:06,440
is obviously<font color="#CCCCCC"> a problem if you're a Red</font>

442
00:17:03,980 --> 00:17:08,300
<font color="#CCCCCC">Team</font><font color="#E5E5E5"> because if you're trying</font><font color="#CCCCCC"> to coerce</font>

443
00:17:06,440 --> 00:17:11,660
<font color="#CCCCCC">the user into accessing</font><font color="#E5E5E5"> your fishing</font>

444
00:17:08,300 --> 00:17:14,180
site or maybe you want to<font color="#E5E5E5"> kind of get</font>

445
00:17:11,660 --> 00:17:16,070
egress<font color="#E5E5E5"> out to your c2 channel it</font>

446
00:17:14,180 --> 00:17:17,090
actually<font color="#CCCCCC"> means that</font><font color="#E5E5E5"> the the host that</font>

447
00:17:16,069 --> 00:17:19,730
<font color="#E5E5E5">you're using the site that you're using</font>

448
00:17:17,089 --> 00:17:21,409
needs to be<font color="#E5E5E5"> categorized so the</font>

449
00:17:19,730 --> 00:17:23,329
traditional approach to<font color="#E5E5E5"> kind of evading</font>

450
00:17:21,410 --> 00:17:25,010
<font color="#E5E5E5">this is using tools like cut my fish or</font>

451
00:17:23,329 --> 00:17:27,050
domain hunter which will basically allow

452
00:17:25,010 --> 00:17:29,120
<font color="#E5E5E5">you to find sites that have already been</font>

453
00:17:27,050 --> 00:17:33,590
categorized and that are<font color="#E5E5E5"> just expiring</font>

454
00:17:29,120 --> 00:17:35,929
and available<font color="#E5E5E5"> for purchase the problem</font>

455
00:17:33,590 --> 00:17:38,929
with this is<font color="#CCCCCC"> that</font><font color="#E5E5E5"> you can't actually</font>

456
00:17:35,930 --> 00:17:41,090
<font color="#CCCCCC">often find target relevant sites so say</font>

457
00:17:38,930 --> 00:17:43,820
for<font color="#E5E5E5"> example we were targeting something</font>

458
00:17:41,090 --> 00:17:45,919
<font color="#E5E5E5">like</font><font color="#CCCCCC"> my Bank of</font><font color="#E5E5E5"> America we couldn't say</font>

459
00:17:43,820 --> 00:17:47,060
<font color="#CCCCCC">for example go and register</font><font color="#E5E5E5"> like or find</font>

460
00:17:45,920 --> 00:17:48,710
the site saying<font color="#E5E5E5"> like Bank of America</font>

461
00:17:47,060 --> 00:17:50,000
services<font color="#CCCCCC"> com so we</font><font color="#E5E5E5"> couldn't find</font>

462
00:17:48,710 --> 00:17:52,970
<font color="#E5E5E5">something that was specifically tailored</font>

463
00:17:50,000 --> 00:17:54,890
to<font color="#CCCCCC"> that organization so what</font><font color="#E5E5E5"> we started</font>

464
00:17:52,970 --> 00:17:56,750
to<font color="#E5E5E5"> do was</font><font color="#CCCCCC"> actually do some research on</font>

465
00:17:54,890 --> 00:17:58,220
how<font color="#E5E5E5"> categorization was implemented how</font>

466
00:17:56,750 --> 00:18:00,620
the proxy services<font color="#E5E5E5"> were actually</font>

467
00:17:58,220 --> 00:18:02,180
determining the the<font color="#E5E5E5"> relevant</font><font color="#CCCCCC"> category</font>

468
00:18:00,620 --> 00:18:03,770
for certain sites and we found some

469
00:18:02,180 --> 00:18:05,300
weaknesses<font color="#CCCCCC"> in this implementation and we</font>

470
00:18:03,770 --> 00:18:09,920
went on to<font color="#CCCCCC"> the upper talk or</font><font color="#E5E5E5"> chameleon</font>

471
00:18:05,300 --> 00:18:12,320
which<font color="#E5E5E5"> we'll demonstrate</font><font color="#CCCCCC"> for you so what</font>

472
00:18:09,920 --> 00:18:14,150
we found was<font color="#CCCCCC"> that in some cases these</font>

473
00:18:12,320 --> 00:18:15,950
<font color="#E5E5E5">sites didn't</font><font color="#CCCCCC"> actually</font><font color="#E5E5E5"> even have to exist</font>

474
00:18:14,150 --> 00:18:18,680
<font color="#E5E5E5">because</font><font color="#CCCCCC"> of the</font><font color="#E5E5E5"> bugs in the</font><font color="#CCCCCC"> catalyzation</font>

475
00:18:15,950 --> 00:18:21,020
site so in this case we've like

476
00:18:18,680 --> 00:18:23,900
<font color="#E5E5E5">registered a new domain</font><font color="#CCCCCC"> and we've been</font>

477
00:18:21,020 --> 00:18:26,510
able to categorize<font color="#E5E5E5"> it as banking on IBM</font>

478
00:18:23,900 --> 00:18:28,310
x-force<font color="#CCCCCC"> is</font><font color="#E5E5E5"> category</font><font color="#CCCCCC"> sites so basically</font>

479
00:18:26,510 --> 00:18:29,629
<font color="#E5E5E5">that means</font><font color="#CCCCCC"> that anybody</font><font color="#E5E5E5"> who's using</font><font color="#CCCCCC"> one</font>

480
00:18:28,310 --> 00:18:32,179
of these IBM

481
00:18:29,630 --> 00:18:33,850
proxy's will actually see this domain

482
00:18:32,180 --> 00:18:37,070
<font color="#CCCCCC">has been a banking site</font>

483
00:18:33,850 --> 00:18:39,050
similarly we found a bug in<font color="#E5E5E5"> the way</font>

484
00:18:37,070 --> 00:18:41,419
McAfee determines<font color="#E5E5E5"> categorizations so we</font>

485
00:18:39,050 --> 00:18:43,310
were<font color="#CCCCCC"> able to register</font><font color="#E5E5E5"> a domain called</font>

486
00:18:41,420 --> 00:18:46,670
foo which didn't<font color="#E5E5E5"> even exist free</font><font color="#CCCCCC"> comm</font>

487
00:18:43,310 --> 00:18:49,669
and we coerced<font color="#CCCCCC"> any</font><font color="#E5E5E5"> any McAfee proxy into</font>

488
00:18:46,670 --> 00:18:51,260
thinking again this is a banking<font color="#E5E5E5"> site so</font>

489
00:18:49,670 --> 00:18:53,240
<font color="#E5E5E5">that would actually</font><font color="#CCCCCC"> allow us to go on it</font>

490
00:18:51,260 --> 00:18:55,520
<font color="#E5E5E5">and use these sites if we</font><font color="#CCCCCC"> went</font><font color="#E5E5E5"> in</font><font color="#CCCCCC"> to</font>

491
00:18:53,240 --> 00:18:58,010
<font color="#CCCCCC">register them</font><font color="#E5E5E5"> and for our c2 or phishing</font>

492
00:18:55,520 --> 00:19:01,510
sites<font color="#E5E5E5"> I'm so I'll give you a quick demo</font>

493
00:18:58,010 --> 00:19:01,510
of<font color="#E5E5E5"> the</font><font color="#CCCCCC"> chameleon tool</font>

494
00:19:11,309 --> 00:19:15,639
so basically what I'm doing<font color="#E5E5E5"> here</font><font color="#CCCCCC"> is</font>

495
00:19:13,480 --> 00:19:19,720
creating a new host so I've created a

496
00:19:15,640 --> 00:19:21,909
new host called<font color="#CCCCCC"> situ apt Wanda info and</font>

497
00:19:19,720 --> 00:19:23,529
just to prove that<font color="#E5E5E5"> the the host was also</font>

498
00:19:21,909 --> 00:19:27,610
<font color="#CCCCCC">lit as I said</font><font color="#E5E5E5"> literally</font><font color="#CCCCCC"> just created it</font>

499
00:19:23,529 --> 00:19:29,529
<font color="#CCCCCC">I'll just do a quick look up on it then</font>

500
00:19:27,610 --> 00:19:30,729
I'm going<font color="#E5E5E5"> to use chameleon tool</font><font color="#CCCCCC"> though</font>

501
00:19:29,529 --> 00:19:33,029
<font color="#CCCCCC">the</font><font color="#E5E5E5"> chameleon tool and I'm going</font><font color="#CCCCCC"> to tell</font>

502
00:19:30,730 --> 00:19:36,669
it<font color="#CCCCCC"> to categorize this newly created host</font>

503
00:19:33,029 --> 00:19:39,490
as finance or banking so the first proxy

504
00:19:36,669 --> 00:19:42,880
targets is a<font color="#CCCCCC"> Bluecoat and basically we</font>

505
00:19:39,490 --> 00:19:44,649
<font color="#E5E5E5">found a bug in the way</font><font color="#CCCCCC"> Bluecoat does</font><font color="#E5E5E5"> its</font>

506
00:19:42,880 --> 00:19:47,470
verification in that if you clone a

507
00:19:44,649 --> 00:19:50,709
certain<font color="#CCCCCC"> sy</font><font color="#E5E5E5"> you made some changes to the</font>

508
00:19:47,470 --> 00:19:52,840
the page that you're cloning<font color="#E5E5E5"> when blue</font>

509
00:19:50,710 --> 00:19:54,370
coat checks its category<font color="#E5E5E5"> it will go with</font>

510
00:19:52,840 --> 00:19:55,658
whatever the original<font color="#CCCCCC"> site was so in</font>

511
00:19:54,370 --> 00:19:57,850
this case we've<font color="#CCCCCC"> been able to</font><font color="#E5E5E5"> trick it</font>

512
00:19:55,659 --> 00:19:59,669
into thinking that<font color="#CCCCCC"> our site</font><font color="#E5E5E5"> our newly</font>

513
00:19:57,850 --> 00:20:01,899
created host is a<font color="#E5E5E5"> financial services so</font>

514
00:19:59,669 --> 00:20:03,730
and we can<font color="#CCCCCC"> go</font><font color="#E5E5E5"> on and verify this by</font>

515
00:20:01,899 --> 00:20:06,250
going<font color="#E5E5E5"> to</font><font color="#CCCCCC"> Bluecoats website and we'll</font>

516
00:20:03,730 --> 00:20:08,740
<font color="#E5E5E5">just pop in the new host</font><font color="#CCCCCC"> situ</font><font color="#E5E5E5"> apt one</font>

517
00:20:06,250 --> 00:20:10,299
that info<font color="#E5E5E5"> and will now check out what</font>

518
00:20:08,740 --> 00:20:12,190
category it thinks that blue code blue

519
00:20:10,299 --> 00:20:14,230
<font color="#E5E5E5">coat</font><font color="#CCCCCC"> thinks this is and you can see it</font>

520
00:20:12,190 --> 00:20:16,510
comes<font color="#E5E5E5"> up as financial</font><font color="#CCCCCC"> services</font><font color="#E5E5E5"> so now</font>

521
00:20:14,230 --> 00:20:18,159
any user who's any organization who's

522
00:20:16,510 --> 00:20:20,440
using<font color="#E5E5E5"> blue coat as their corporate proxy</font>

523
00:20:18,159 --> 00:20:22,419
will allow or will<font color="#CCCCCC"> basically believe</font>

524
00:20:20,440 --> 00:20:25,529
that<font color="#CCCCCC"> see</font><font color="#E5E5E5"> to the apt</font><font color="#CCCCCC"> Wanda info is a</font>

525
00:20:22,419 --> 00:20:25,529
financial<font color="#CCCCCC"> services site</font>

526
00:20:34,390 --> 00:20:40,750
so I'm<font color="#CCCCCC"> gonna pressure</font><font color="#E5E5E5"> back over to</font><font color="#CCCCCC"> vin</font>

527
00:20:36,890 --> 00:20:43,970
<font color="#E5E5E5">he'll talk about</font><font color="#CCCCCC"> some boxing right so</font>

528
00:20:40,750 --> 00:20:46,040
traditionally<font color="#E5E5E5"> antivirus has limitations</font>

529
00:20:43,970 --> 00:20:49,370
<font color="#E5E5E5">due</font><font color="#CCCCCC"> to the fad</font><font color="#E5E5E5"> lightly realizing</font>

530
00:20:46,040 --> 00:20:52,610
signatures and basically put poor

531
00:20:49,370 --> 00:20:54,770
heuristics<font color="#E5E5E5"> so malware some boxes have</font>

532
00:20:52,610 --> 00:20:58,280
started to<font color="#E5E5E5"> come about now as a way to</font>

533
00:20:54,770 --> 00:21:00,920
allow<font color="#CCCCCC"> for organizations to</font><font color="#E5E5E5"> bring in</font>

534
00:20:58,280 --> 00:21:02,389
these<font color="#E5E5E5"> some sort of analysis process in</font>

535
00:21:00,920 --> 00:21:04,700
an automated fashion<font color="#E5E5E5"> into their</font>

536
00:21:02,390 --> 00:21:06,320
organization<font color="#E5E5E5"> so you</font><font color="#CCCCCC"> could go ahead and</font>

537
00:21:04,700 --> 00:21:09,410
<font color="#CCCCCC">then buy one of these appliances and</font>

538
00:21:06,320 --> 00:21:10,939
then start putting<font color="#CCCCCC"> files in for it</font><font color="#E5E5E5"> to</font>

539
00:21:09,410 --> 00:21:13,310
<font color="#E5E5E5">end process and then tell</font><font color="#CCCCCC"> your whether</font>

540
00:21:10,940 --> 00:21:16,510
it's<font color="#E5E5E5"> malicious or not and so that sort</font>

541
00:21:13,310 --> 00:21:19,190
of takes<font color="#CCCCCC"> it</font><font color="#E5E5E5"> away</font><font color="#CCCCCC"> from having</font><font color="#E5E5E5"> to use</font>

542
00:21:16,510 --> 00:21:22,280
human analysts like go<font color="#E5E5E5"> ahead and do like</font>

543
00:21:19,190 --> 00:21:27,080
manually as well<font color="#E5E5E5"> and so you know it's</font>

544
00:21:22,280 --> 00:21:29,270
quite useful<font color="#CCCCCC"> yes and but so the idea is</font>

545
00:21:27,080 --> 00:21:31,550
like the file that you suspect<font color="#E5E5E5"> is</font>

546
00:21:29,270 --> 00:21:33,980
malware<font color="#E5E5E5"> is like executed within an</font>

547
00:21:31,550 --> 00:21:35,419
isolated<font color="#CCCCCC"> in controlled environment</font><font color="#E5E5E5"> there</font>

548
00:21:33,980 --> 00:21:37,310
are<font color="#CCCCCC"> cases</font><font color="#E5E5E5"> where</font><font color="#CCCCCC"> we have</font><font color="#E5E5E5"> found that</font>

549
00:21:35,420 --> 00:21:39,110
<font color="#E5E5E5">people have misconfigured it for</font>

550
00:21:37,310 --> 00:21:41,840
whatever<font color="#E5E5E5"> reason and the sandbox can</font>

551
00:21:39,110 --> 00:21:45,679
<font color="#E5E5E5">connects out which isn't the</font><font color="#CCCCCC"> best sort</font>

552
00:21:41,840 --> 00:21:47,720
of practice so wait does is it executes

553
00:21:45,680 --> 00:21:49,160
<font color="#CCCCCC">file examines what it does and let it</font>

554
00:21:47,720 --> 00:21:51,380
looks for<font color="#E5E5E5"> these malicious indicators</font>

555
00:21:49,160 --> 00:21:53,810
actually go back sir yeah malicious

556
00:21:51,380 --> 00:21:56,510
indicators so malicious indicators can

557
00:21:53,810 --> 00:21:58,490
be actions such as reading<font color="#E5E5E5"> from the</font>

558
00:21:56,510 --> 00:22:00,970
registry dropping<font color="#CCCCCC"> a file to disk and</font>

559
00:21:58,490 --> 00:22:06,290
execute in it or<font color="#CCCCCC"> connecting out to a</font>

560
00:22:00,970 --> 00:22:08,750
domain and so as a quick case<font color="#CCCCCC"> study</font><font color="#E5E5E5"> I'm</font>

561
00:22:06,290 --> 00:22:12,080
gonna have a quick<font color="#E5E5E5"> chat</font><font color="#CCCCCC"> about</font><font color="#E5E5E5"> fire I am</font>

562
00:22:08,750 --> 00:22:14,120
<font color="#CCCCCC">MPs the malware</font><font color="#E5E5E5"> protection system so</font>

563
00:22:12,080 --> 00:22:17,000
across a lot<font color="#CCCCCC"> of organizations that we</font>

564
00:22:14,120 --> 00:22:19,040
<font color="#E5E5E5">have seen fire being deployed the issues</font>

565
00:22:17,000 --> 00:22:21,170
<font color="#E5E5E5">are generally due to the way like its</font>

566
00:22:19,040 --> 00:22:23,300
architecture or how<font color="#E5E5E5"> its placed within</font>

567
00:22:21,170 --> 00:22:27,170
<font color="#E5E5E5">the organization now it's being</font><font color="#CCCCCC"> used</font><font color="#E5E5E5"> as</font>

568
00:22:23,300 --> 00:22:29,450
part of<font color="#E5E5E5"> the security</font><font color="#CCCCCC"> stack so</font><font color="#E5E5E5"> I was</font>

569
00:22:27,170 --> 00:22:31,610
<font color="#E5E5E5">looking on the fire right website</font><font color="#CCCCCC"> if you</font>

570
00:22:29,450 --> 00:22:33,580
actually<font color="#CCCCCC"> saw in the web mps perspective</font>

571
00:22:31,610 --> 00:22:37,370
where you're actually scanning web links

572
00:22:33,580 --> 00:22:39,649
we<font color="#CCCCCC"> have found what you like HTTP would</font>

573
00:22:37,370 --> 00:22:40,909
work fine but<font color="#E5E5E5"> there's actually separate</font>

574
00:22:39,650 --> 00:22:42,440
<font color="#CCCCCC">fire i</font><font color="#E5E5E5"> appliance that</font><font color="#CCCCCC"> you're supposed to</font>

575
00:22:40,910 --> 00:22:44,870
<font color="#E5E5E5">buy lock allows you</font><font color="#CCCCCC"> to learn the-- crypt</font>

576
00:22:42,440 --> 00:22:47,690
<font color="#E5E5E5">HTTP traffic so that what</font><font color="#CCCCCC"> left's implies</font>

577
00:22:44,870 --> 00:22:48,379
<font color="#CCCCCC">is law if you start sending</font><font color="#E5E5E5"> links to of</font>

578
00:22:47,690 --> 00:22:51,000
it

579
00:22:48,380 --> 00:22:53,970
over<font color="#E5E5E5"> HTTP it's not going to decrypt what</font>

580
00:22:51,000 --> 00:22:56,460
that<font color="#CCCCCC"> what payload and Sun boxer</font><font color="#E5E5E5"> so it's</font>

581
00:22:53,970 --> 00:22:58,590
like issues like like usually across

582
00:22:56,460 --> 00:23:00,480
organizations and another thing is

583
00:22:58,590 --> 00:23:04,649
<font color="#E5E5E5">usually due to</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> limitations in the</font>

584
00:23:00,480 --> 00:23:07,860
sandbox itself<font color="#E5E5E5"> so the file types</font><font color="#CCCCCC"> it does</font>

585
00:23:04,650 --> 00:23:09,690
sandbox<font color="#E5E5E5"> and</font><font color="#CCCCCC"> RM such as</font><font color="#E5E5E5"> executables and</font>

586
00:23:07,860 --> 00:23:12,540
libraries or office<font color="#CCCCCC"> melt malware</font>

587
00:23:09,690 --> 00:23:14,460
documents archives and shortcuts<font color="#E5E5E5"> so</font>

588
00:23:12,540 --> 00:23:17,639
that's all great we were<font color="#CCCCCC"> already</font><font color="#E5E5E5"> sort of</font>

589
00:23:14,460 --> 00:23:19,710
<font color="#E5E5E5">expect</font><font color="#CCCCCC"> luck</font><font color="#E5E5E5"> to you know to sandbox</font><font color="#CCCCCC"> oh</font>

590
00:23:17,640 --> 00:23:22,110
but what we didn't really<font color="#CCCCCC"> expect is like</font>

591
00:23:19,710 --> 00:23:24,720
it<font color="#E5E5E5"> doesn't some</font><font color="#CCCCCC"> box HTML applications or</font>

592
00:23:22,110 --> 00:23:26,689
<font color="#CCCCCC">JavaScript files so at least quite</font>

593
00:23:24,720 --> 00:23:31,740
commonly<font color="#E5E5E5"> use now</font><font color="#CCCCCC"> in like the</font><font color="#E5E5E5"> wild and</font>

594
00:23:26,690 --> 00:23:34,110
<font color="#E5E5E5">you know if the sandbox isn't putting</font>

595
00:23:31,740 --> 00:23:37,320
the processing<font color="#E5E5E5"> these files and it's sort</font>

596
00:23:34,110 --> 00:23:39,959
<font color="#E5E5E5">of there's a this gap now in like what</font>

597
00:23:37,320 --> 00:23:43,320
the technology<font color="#CCCCCC"> are using to detect</font><font color="#E5E5E5"> these</font>

598
00:23:39,960 --> 00:23:46,410
sort of<font color="#E5E5E5"> attacked and another thing we</font>

599
00:23:43,320 --> 00:23:48,840
found was like the fire<font color="#E5E5E5"> I</font><font color="#CCCCCC"> and PS uses</font>

600
00:23:46,410 --> 00:23:52,230
predefined guest images so these guest

601
00:23:48,840 --> 00:23:54,629
images are<font color="#CCCCCC"> actually updated every month</font>

602
00:23:52,230 --> 00:23:57,450
or so<font color="#CCCCCC"> I'm so they say</font><font color="#E5E5E5"> on the</font><font color="#CCCCCC"> website</font>

603
00:23:54,630 --> 00:23:59,790
<font color="#CCCCCC">anyways and then basically</font><font color="#E5E5E5"> because the</font>

604
00:23:57,450 --> 00:24:02,310
predefined<font color="#E5E5E5"> anyone</font><font color="#CCCCCC"> I can get one of these</font>

605
00:23:59,790 --> 00:24:04,260
fire I and PS boxes<font color="#CCCCCC"> you</font><font color="#E5E5E5"> can go</font><font color="#CCCCCC"> ahead</font><font color="#E5E5E5"> and</font>

606
00:24:02,310 --> 00:24:05,310
start reverse engineering it and look at

607
00:24:04,260 --> 00:24:07,590
<font color="#E5E5E5">start looking into the sandbox</font>

608
00:24:05,310 --> 00:24:09,389
<font color="#E5E5E5">environment and then you</font><font color="#CCCCCC"> can find items</font>

609
00:24:07,590 --> 00:24:12,560
<font color="#E5E5E5">that you can key off of</font><font color="#CCCCCC"> and not execute</font>

610
00:24:09,390 --> 00:24:15,180
what if you ain't within the<font color="#E5E5E5"> sandbox</font>

611
00:24:12,560 --> 00:24:18,379
yeah<font color="#E5E5E5"> and then because it's predefined</font>

612
00:24:15,180 --> 00:24:20,340
you can't really<font color="#E5E5E5"> you main join these</font>

613
00:24:18,380 --> 00:24:22,260
images and<font color="#E5E5E5"> if you can't do main join</font>

614
00:24:20,340 --> 00:24:23,790
these images it basically<font color="#E5E5E5"> means like the</font>

615
00:24:22,260 --> 00:24:25,320
<font color="#CCCCCC">images</font><font color="#E5E5E5"> never the main</font><font color="#CCCCCC"> joins all you have</font>

616
00:24:23,790 --> 00:24:27,960
to do is make the payload not execute

617
00:24:25,320 --> 00:24:29,580
when you're in<font color="#E5E5E5"> an</font><font color="#CCCCCC"> on demand environment</font>

618
00:24:27,960 --> 00:24:30,930
<font color="#CCCCCC">if you're in the enterprise environment</font>

619
00:24:29,580 --> 00:24:34,800
like it's more likely<font color="#CCCCCC"> all machines</font>

620
00:24:30,930 --> 00:24:37,670
should<font color="#E5E5E5"> be the main join another sort of</font>

621
00:24:34,800 --> 00:24:41,460
<font color="#E5E5E5">like put detection thing that we've seen</font>

622
00:24:37,670 --> 00:24:43,140
<font color="#CCCCCC">crockpot quite recently is the idea for</font>

623
00:24:41,460 --> 00:24:44,850
<font color="#E5E5E5">our next generation endpoint detection</font>

624
00:24:43,140 --> 00:24:47,820
and response through solutions such<font color="#CCCCCC"> as</font>

625
00:24:44,850 --> 00:24:50,820
like carbon black<font color="#CCCCCC"> so carbon</font><font color="#E5E5E5"> black</font>

626
00:24:47,820 --> 00:24:52,620
provides and like security<font color="#E5E5E5"> operation</font>

627
00:24:50,820 --> 00:24:54,659
centers with<font color="#E5E5E5"> the oversight of the</font>

628
00:24:52,620 --> 00:24:58,649
process<font color="#CCCCCC"> spawn genes</font><font color="#E5E5E5"> what I mean by</font><font color="#CCCCCC"> pros</font>

629
00:24:54,660 --> 00:24:59,190
<font color="#CCCCCC">are spawn chains such as like</font><font color="#E5E5E5"> a parent</font>

630
00:24:58,650 --> 00:25:01,760
and child

631
00:24:59,190 --> 00:25:04,100
sort of like relationship so I'll talk

632
00:25:01,760 --> 00:25:08,000
a bit<font color="#E5E5E5"> more about what I mean</font><font color="#CCCCCC"> by Lucknow</font>

633
00:25:04,100 --> 00:25:10,429
so quite a common one<font color="#E5E5E5"> is like the MSHDA</font>

634
00:25:08,000 --> 00:25:13,550
<font color="#CCCCCC">taxi spawn and PowerShell directly</font><font color="#E5E5E5"> so</font>

635
00:25:10,430 --> 00:25:15,350
the default payload in Empire and

636
00:25:13,550 --> 00:25:18,950
<font color="#E5E5E5">kawatte strike as well as metabolic</font>

637
00:25:15,350 --> 00:25:22,790
framework which i think is<font color="#E5E5E5"> the</font><font color="#CCCCCC"> MSH no</font>

638
00:25:18,950 --> 00:25:26,600
it's the HT a - psh payload format is

639
00:25:22,790 --> 00:25:30,080
like<font color="#E5E5E5"> the the container MSHDA XE will</font>

640
00:25:26,600 --> 00:25:31,790
spawn<font color="#CCCCCC"> the partial</font><font color="#E5E5E5"> the XE and process so</font>

641
00:25:30,080 --> 00:25:33,110
if you can detect<font color="#E5E5E5"> this relationship then</font>

642
00:25:31,790 --> 00:25:35,990
you<font color="#CCCCCC"> obviously know what something</font>

643
00:25:33,110 --> 00:25:39,649
malicious is happening because why would

644
00:25:35,990 --> 00:25:41,180
someone open the MSHDA<font color="#E5E5E5"> that XE container</font>

645
00:25:39,650 --> 00:25:43,040
and start<font color="#E5E5E5"> executing PowerShell unless</font>

646
00:25:41,180 --> 00:25:46,610
you're doing<font color="#E5E5E5"> it</font><font color="#CCCCCC"> for malicious purposes</font>

647
00:25:43,040 --> 00:25:48,350
<font color="#E5E5E5">and then in terms of like command line</font>

648
00:25:46,610 --> 00:25:51,860
login we've noticed<font color="#CCCCCC"> like an increase in</font>

649
00:25:48,350 --> 00:25:53,600
like command line login so such as

650
00:25:51,860 --> 00:25:56,120
<font color="#CCCCCC">looking for keywords like dashing code</font>

651
00:25:53,600 --> 00:26:00,169
the command or<font color="#E5E5E5"> any subset substring of</font>

652
00:25:56,120 --> 00:26:02,479
<font color="#CCCCCC">up to around Dash DN</font><font color="#E5E5E5"> C so yeah that's</font>

653
00:26:00,170 --> 00:26:05,840
quite<font color="#CCCCCC"> likes</font><font color="#E5E5E5"> use quite often by for</font>

654
00:26:02,480 --> 00:26:09,950
actors<font color="#CCCCCC"> to put a full payload Stasia</font><font color="#E5E5E5"> and</font>

655
00:26:05,840 --> 00:26:11,570
inside the single command also like long

656
00:26:09,950 --> 00:26:13,610
PowerShell commands in the command line

657
00:26:11,570 --> 00:26:15,020
<font color="#CCCCCC">if you're a</font><font color="#E5E5E5"> developer or a sysadmin</font>

658
00:26:13,610 --> 00:26:16,689
you're more likely to<font color="#E5E5E5"> just run</font>

659
00:26:15,020 --> 00:26:18,590
PowerShell that XE and start<font color="#CCCCCC"> write</font><font color="#E5E5E5"> and</font>

660
00:26:16,690 --> 00:26:20,360
executing commands from<font color="#CCCCCC"> within the</font>

661
00:26:18,590 --> 00:26:25,100
console as opposed to<font color="#E5E5E5"> over the command</font>

662
00:26:20,360 --> 00:26:27,590
line so a more<font color="#CCCCCC"> indicates</font><font color="#E5E5E5"> law so now</font><font color="#CCCCCC"> I've</font>

663
00:26:25,100 --> 00:26:28,969
talked about<font color="#E5E5E5"> these sort of things</font><font color="#CCCCCC"> like</font>

664
00:26:27,590 --> 00:26:31,010
they might<font color="#E5E5E5"> be</font><font color="#CCCCCC"> looking out for here's how</font>

665
00:26:28,970 --> 00:26:33,530
you bypass them so if they're looking

666
00:26:31,010 --> 00:26:36,080
<font color="#CCCCCC">for - encoded commander - encoded</font><font color="#E5E5E5"> one</font>

667
00:26:33,530 --> 00:26:37,639
<font color="#E5E5E5">let's quite often overlooked is -</font><font color="#CCCCCC"> EC</font><font color="#E5E5E5"> so</font>

668
00:26:36,080 --> 00:26:40,610
<font color="#E5E5E5">it because that's not</font><font color="#CCCCCC"> a substring of -</font>

669
00:26:37,640 --> 00:26:42,500
encoded command and I've also found<font color="#CCCCCC"> that</font>

670
00:26:40,610 --> 00:26:44,750
<font color="#E5E5E5">you can use a</font><font color="#CCCCCC"> Unicode characters and</font>

671
00:26:42,500 --> 00:26:46,940
replacement for the dashes so if they've

672
00:26:44,750 --> 00:26:49,640
got<font color="#CCCCCC"> a regex going on for em - encoded</font>

673
00:26:46,940 --> 00:26:52,430
command if<font color="#E5E5E5"> I - is part of the</font><font color="#CCCCCC"> Reg</font>

674
00:26:49,640 --> 00:26:54,380
<font color="#E5E5E5">excellent if you're not using an ASCII -</font>

675
00:26:52,430 --> 00:26:56,870
anymore<font color="#E5E5E5"> you can you know hopefully</font>

676
00:26:54,380 --> 00:26:58,520
bypass that<font color="#CCCCCC"> reg X so if you could open</font>

677
00:26:56,870 --> 00:27:00,739
the<font color="#CCCCCC"> character map and go</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> is two</font>

678
00:26:58,520 --> 00:27:02,450
<font color="#CCCCCC">zero one five you can find that longer</font><font color="#E5E5E5"> -</font>

679
00:27:00,740 --> 00:27:03,800
there's<font color="#E5E5E5"> actually a few more dashes that</font>

680
00:27:02,450 --> 00:27:08,140
you can use but I'll<font color="#E5E5E5"> leaflet to</font>

681
00:27:03,800 --> 00:27:11,659
whoever's gonna try and exploit to find

682
00:27:08,140 --> 00:27:14,020
so what if you're looking for<font color="#CCCCCC"> a invoke</font>

683
00:27:11,660 --> 00:27:15,080
expression<font color="#CCCCCC"> now in volt web request</font><font color="#E5E5E5"> so</font>

684
00:27:14,020 --> 00:27:16,970
<font color="#CCCCCC">what</font>

685
00:27:15,080 --> 00:27:19,250
explanation invoke expression<font color="#CCCCCC"> is the</font>

686
00:27:16,970 --> 00:27:22,279
command look like you used<font color="#E5E5E5"> to execute a</font>

687
00:27:19,250 --> 00:27:25,490
script block and learn the<font color="#CCCCCC"> involve</font><font color="#E5E5E5"> web</font>

688
00:27:22,279 --> 00:27:28,820
<font color="#E5E5E5">request is used to download and files</font>

689
00:27:25,490 --> 00:27:31,940
off<font color="#E5E5E5"> the offer URL so here's a quick</font>

690
00:27:28,820 --> 00:27:34,309
proof of concept but with this is just

691
00:27:31,940 --> 00:27:36,559
<font color="#E5E5E5">PowerShell executing PowerShell using</font>

692
00:27:34,309 --> 00:27:38,899
the dot notation here in placement fully

693
00:27:36,559 --> 00:27:40,639
invoke expression and then here's<font color="#CCCCCC"> the</font>

694
00:27:38,899 --> 00:27:42,168
<font color="#CCCCCC">invoked web request but instead of</font><font color="#E5E5E5"> doing</font>

695
00:27:40,640 --> 00:27:45,220
the web request we're going to use and

696
00:27:42,169 --> 00:27:48,200
<font color="#E5E5E5">let's look up to do a DNS record</font><font color="#CCCCCC"> look</font><font color="#E5E5E5"> so</font>

697
00:27:45,220 --> 00:27:50,750
<font color="#CCCCCC">Lester's a text record lookup for calc</font>

698
00:27:48,200 --> 00:27:52,940
<font color="#E5E5E5">Vincent you doctor at UK which responds</font>

699
00:27:50,750 --> 00:27:55,610
with help that<font color="#E5E5E5"> XE and then the dot</font>

700
00:27:52,940 --> 00:27:57,190
<font color="#E5E5E5">notation will execute lot more and</font>

701
00:27:55,610 --> 00:28:00,439
<font color="#E5E5E5">listen</font><font color="#CCCCCC"> a little bit</font>

702
00:27:57,190 --> 00:28:01,970
<font color="#E5E5E5">Daniel Bohannon has released invoke</font>

703
00:28:00,440 --> 00:28:04,190
<font color="#E5E5E5">Creole crafter a bit early run in the</font>

704
00:28:01,970 --> 00:28:08,389
year<font color="#E5E5E5"> what this allows you to do quite</font>

705
00:28:04,190 --> 00:28:09,409
<font color="#E5E5E5">easily is just supply it with a a target</font>

706
00:28:08,389 --> 00:28:11,750
<font color="#CCCCCC">PowerShell script</font><font color="#E5E5E5"> that you want to</font>

707
00:28:09,409 --> 00:28:14,210
execute<font color="#E5E5E5"> and then it will create a cradle</font>

708
00:28:11,750 --> 00:28:16,820
for<font color="#E5E5E5"> you like an office</font><font color="#CCCCCC"> gate cradle</font>

709
00:28:14,210 --> 00:28:19,940
<font color="#E5E5E5">similar to what you would</font><font color="#CCCCCC"> have used for</font>

710
00:28:16,820 --> 00:28:23,480
<font color="#CCCCCC">traditional sort</font><font color="#E5E5E5"> of like staging</font><font color="#CCCCCC"> before</font>

711
00:28:19,940 --> 00:28:25,250
the code so what if the<font color="#CCCCCC"> detects an MSHA</font>

712
00:28:23,480 --> 00:28:27,740
taxi spawned<font color="#CCCCCC"> powershell</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> XE like I</font>

713
00:28:25,250 --> 00:28:29,149
spoke about<font color="#E5E5E5"> before</font><font color="#CCCCCC"> so Matt Nelson has</font>

714
00:28:27,740 --> 00:28:32,120
made me aware<font color="#CCCCCC"> you could actually use the</font>

715
00:28:29,149 --> 00:28:34,399
SW<font color="#CCCCCC"> BAM locate a common object</font><font color="#E5E5E5"> to spawn</font>

716
00:28:32,120 --> 00:28:37,090
them the type process<font color="#E5E5E5"> under like the</font><font color="#CCCCCC"> WMI</font>

717
00:28:34,399 --> 00:28:40,129
process which is<font color="#CCCCCC"> an degree on my prvs</font>

718
00:28:37,090 --> 00:28:42,010
<font color="#E5E5E5">exe so then in that scenario if you use</font>

719
00:28:40,130 --> 00:28:44,659
this comm<font color="#CCCCCC"> objects' it'll shoppers</font>

720
00:28:42,010 --> 00:28:46,039
wmii<font color="#CCCCCC"> PRV</font><font color="#E5E5E5"> i see that</font><font color="#CCCCCC"> i actually</font><font color="#E5E5E5"> spawning</font>

721
00:28:44,659 --> 00:28:46,820
<font color="#E5E5E5">the powershell that see as opposed to</font>

722
00:28:46,039 --> 00:28:48,289
MSHDA

723
00:28:46,820 --> 00:28:49,939
so if they were<font color="#E5E5E5"> looking for that parent</font>

724
00:28:48,289 --> 00:28:53,299
<font color="#CCCCCC">and charles relationship before that you</font>

725
00:28:49,940 --> 00:28:54,830
might not detect it<font color="#E5E5E5"> anymore there's also</font>

726
00:28:53,299 --> 00:28:58,250
a new moniker<font color="#CCCCCC"> that you can now</font><font color="#E5E5E5"> use to</font>

727
00:28:54,830 --> 00:29:00,590
<font color="#E5E5E5">spawn it on the Explorer that XE</font><font color="#CCCCCC"> mats</font>

728
00:28:58,250 --> 00:29:01,970
<font color="#E5E5E5">also posted on this Twitter so yeah a</font>

729
00:29:00,590 --> 00:29:03,379
<font color="#E5E5E5">lot I'll probably make it a bit</font><font color="#CCCCCC"> more</font>

730
00:29:01,970 --> 00:29:09,019
<font color="#CCCCCC">difficult for them to</font><font color="#E5E5E5"> these assets in</font>

731
00:29:03,380 --> 00:29:10,940
the future so MD sir<font color="#CCCCCC"> Dom's actually</font>

732
00:29:09,019 --> 00:29:14,059
created a tool called and power DNS

733
00:29:10,940 --> 00:29:16,880
which allows you<font color="#CCCCCC"> to stage a full payload</font>

734
00:29:14,059 --> 00:29:18,850
<font color="#CCCCCC">all entirely over DNS</font><font color="#E5E5E5"> using a PowerShell</font>

735
00:29:16,880 --> 00:29:22,519
DNS quite<font color="#CCCCCC"> sort of</font><font color="#E5E5E5"> like download Gradle</font>

736
00:29:18,850 --> 00:29:24,699
as opposed<font color="#E5E5E5"> to using the</font><font color="#CCCCCC"> web web sort of</font>

737
00:29:22,519 --> 00:29:28,010
<font color="#E5E5E5">like get requests</font>

738
00:29:24,700 --> 00:29:28,820
so traditionally if<font color="#E5E5E5"> you use a web</font>

739
00:29:28,010 --> 00:29:30,649
<font color="#CCCCCC">request</font><font color="#E5E5E5"> it might be</font>

740
00:29:28,820 --> 00:29:32,539
lots<font color="#E5E5E5"> of by proxy but if you're doing</font>

741
00:29:30,649 --> 00:29:34,428
<font color="#E5E5E5">that all over DNS unless you've got like</font>

742
00:29:32,539 --> 00:29:35,990
some DNS filtering going on<font color="#E5E5E5"> like awesome</font>

743
00:29:34,429 --> 00:29:37,429
<font color="#CCCCCC">I could</font><font color="#E5E5E5"> block to the mains learn it's</font>

744
00:29:35,990 --> 00:29:41,509
<font color="#E5E5E5">not going to it's not subject to</font>

745
00:29:37,429 --> 00:29:43,549
categorization<font color="#E5E5E5"> type issues and if you're</font>

746
00:29:41,509 --> 00:29:45,889
in the highly segregated<font color="#E5E5E5"> area of the</font>

747
00:29:43,549 --> 00:29:47,658
network<font color="#E5E5E5"> say you can only receive</font><font color="#CCCCCC"> emails</font>

748
00:29:45,889 --> 00:29:50,000
but you can't actually access<font color="#CCCCCC"> it and</font>

749
00:29:47,659 --> 00:29:51,230
<font color="#E5E5E5">it's a download the payload or whatnot</font>

750
00:29:50,000 --> 00:29:52,549
if you've attached that payload<font color="#E5E5E5"> then</font>

751
00:29:51,230 --> 00:29:54,169
it's made<font color="#E5E5E5"> it through all of like these</font>

752
00:29:52,549 --> 00:29:57,019
sort<font color="#E5E5E5"> of like</font><font color="#CCCCCC"> defenses into a highly</font>

753
00:29:54,169 --> 00:29:58,880
segregated area the DNS might still be

754
00:29:57,019 --> 00:30:04,070
<font color="#E5E5E5">allowed out if you weren't able to</font>

755
00:29:58,880 --> 00:30:06,470
<font color="#E5E5E5">connect out via HTTP so just going to</font>

756
00:30:04,070 --> 00:30:08,799
show<font color="#E5E5E5"> you a quick demo of the power DNS</font>

757
00:30:06,470 --> 00:30:08,799
tool now

758
00:30:19,610 --> 00:30:24,750
<font color="#E5E5E5">okay so essentially what it's doing is</font>

759
00:30:21,779 --> 00:30:26,460
it<font color="#E5E5E5"> basically gives</font><font color="#CCCCCC"> you a very short and</font>

760
00:30:24,750 --> 00:30:29,639
of<font color="#E5E5E5"> powershell one-liner</font><font color="#CCCCCC"> which you can</font>

761
00:30:26,460 --> 00:30:30,720
then embed<font color="#CCCCCC"> into</font><font color="#E5E5E5"> your payload so in this</font>

762
00:30:29,639 --> 00:30:33,539
case we're<font color="#CCCCCC"> just going to embed it into</font>

763
00:30:30,720 --> 00:30:35,460
<font color="#CCCCCC">HD a file so you can see that the the</font>

764
00:30:33,539 --> 00:30:36,870
one line is very very straightforward<font color="#E5E5E5"> it</font>

765
00:30:35,460 --> 00:30:39,809
could be something you could<font color="#CCCCCC"> even type</font>

766
00:30:36,870 --> 00:30:41,129
<font color="#CCCCCC">if</font><font color="#E5E5E5"> you wanted to and then if we we win</font>

767
00:30:39,809 --> 00:30:43,428
the<font color="#CCCCCC"> HTA what it will do</font><font color="#E5E5E5"> is it</font><font color="#CCCCCC"> will</font>

768
00:30:41,129 --> 00:30:45,840
trigger a number of kind<font color="#CCCCCC"> of DNS requests</font>

769
00:30:43,429 --> 00:30:47,580
which you can kind<font color="#CCCCCC"> of see populating on</font>

770
00:30:45,840 --> 00:30:49,139
the<font color="#CCCCCC"> left-hand side so the way it works</font>

771
00:30:47,580 --> 00:30:51,210
<font color="#CCCCCC">is essentially</font><font color="#E5E5E5"> there's a</font><font color="#CCCCCC"> PowerShell</font>

772
00:30:49,139 --> 00:30:53,219
scripts that's read in and it creates

773
00:30:51,210 --> 00:30:58,730
<font color="#E5E5E5">like a stage which embeds in the first</font>

774
00:30:53,220 --> 00:31:00,929
block<font color="#CCCCCC"> of the DNS text record the</font>

775
00:30:58,730 --> 00:31:02,909
download cradle will then retrieve<font color="#E5E5E5"> that</font>

776
00:31:00,929 --> 00:31:04,139
<font color="#CCCCCC">and stage a request and</font><font color="#E5E5E5"> then use it</font><font color="#CCCCCC"> to</font>

777
00:31:02,909 --> 00:31:05,759
basically retrieve the rest of the

778
00:31:04,139 --> 00:31:07,110
<font color="#E5E5E5">PowerShell scripts so effectively</font><font color="#CCCCCC"> what</font>

779
00:31:05,759 --> 00:31:09,320
<font color="#CCCCCC">it allows you</font><font color="#E5E5E5"> to do is execute any</font>

780
00:31:07,110 --> 00:31:11,879
<font color="#E5E5E5">PowerShell script over DNS completely</font>

781
00:31:09,320 --> 00:31:15,620
<font color="#E5E5E5">and in our case what I did was basically</font>

782
00:31:11,879 --> 00:31:18,000
<font color="#CCCCCC">just grab a ball strike and</font><font color="#E5E5E5"> beacon</font>

783
00:31:15,620 --> 00:31:19,559
stager<font color="#CCCCCC"> and you can see we've now got the</font>

784
00:31:18,000 --> 00:31:22,009
the implant on<font color="#CCCCCC"> the left-hand side with a</font>

785
00:31:19,559 --> 00:31:22,009
couple<font color="#CCCCCC"> strike</font>

786
00:31:29,820 --> 00:31:32,859
<font color="#CCCCCC">alright so now I'm</font><font color="#E5E5E5"> going to talk a</font>

787
00:31:31,690 --> 00:31:40,359
<font color="#E5E5E5">little bit about commanding control</font>

788
00:31:32,859 --> 00:31:41,678
advances yeah<font color="#E5E5E5"> great so</font><font color="#CCCCCC"> domain fronting</font>

789
00:31:40,359 --> 00:31:43,168
is actually being<font color="#E5E5E5"> quite an interesting</font>

790
00:31:41,679 --> 00:31:45,820
<font color="#E5E5E5">technique over the past</font><font color="#CCCCCC"> twelve months</font>

791
00:31:43,169 --> 00:31:47,559
<font color="#CCCCCC">quite a lot of red teamers have started</font>

792
00:31:45,820 --> 00:31:48,970
to<font color="#E5E5E5"> look</font><font color="#CCCCCC"> into this I know quite a few red</font>

793
00:31:47,559 --> 00:31:51,009
teams in the<font color="#E5E5E5"> u.s. I've started</font><font color="#CCCCCC"> using</font>

794
00:31:48,970 --> 00:31:53,649
this sort of technique<font color="#E5E5E5"> I've actually</font>

795
00:31:51,009 --> 00:31:55,149
quite recently actually<font color="#E5E5E5"> four days ago I</font>

796
00:31:53,649 --> 00:31:56,768
was<font color="#E5E5E5"> looking on various tool for some of</font>

797
00:31:55,149 --> 00:31:59,709
like<font color="#CCCCCC"> the domains that I've found</font><font color="#E5E5E5"> and I</font>

798
00:31:56,769 --> 00:32:02,320
found like<font color="#E5E5E5"> one guy was</font><font color="#CCCCCC"> using it</font><font color="#E5E5E5"> so yeah</font>

799
00:31:59,710 --> 00:32:06,220
it's starting<font color="#E5E5E5"> to make</font><font color="#CCCCCC"> its way out into</font>

800
00:32:02,320 --> 00:32:08,950
<font color="#CCCCCC">the</font><font color="#E5E5E5"> public oh yes so traditionally the</font>

801
00:32:06,220 --> 00:32:12,340
main<font color="#CCCCCC"> fronting is being used as in like</font>

802
00:32:08,950 --> 00:32:15,039
the<font color="#E5E5E5"> tour</font><font color="#CCCCCC"> tour</font><font color="#E5E5E5"> product</font><font color="#CCCCCC"> or service as a</font>

803
00:32:12,340 --> 00:32:17,350
<font color="#E5E5E5">way to bypass</font><font color="#CCCCCC"> the censorship</font><font color="#E5E5E5"> issues in</font>

804
00:32:15,039 --> 00:32:18,429
certain<font color="#E5E5E5"> countries here we're going to</font>

805
00:32:17,350 --> 00:32:22,029
<font color="#E5E5E5">use it to mask out or malicious</font>

806
00:32:18,429 --> 00:32:25,690
infrastructure so we researched into<font color="#E5E5E5"> the</font>

807
00:32:22,029 --> 00:32:28,210
<font color="#E5E5E5">CloudFront CDN for so</font><font color="#CCCCCC"> amazon's content</font>

808
00:32:25,690 --> 00:32:31,239
delivery network<font color="#E5E5E5"> for using the domain</font>

809
00:32:28,210 --> 00:32:33,070
fronting technique so what you do for

810
00:32:31,239 --> 00:32:35,200
<font color="#CCCCCC">domain printing is basically</font><font color="#E5E5E5"> connect to</font>

811
00:32:33,070 --> 00:32:36,999
any edge node and specify our host

812
00:32:35,200 --> 00:32:39,190
header of<font color="#CCCCCC"> your specific node and</font><font color="#E5E5E5"> then it</font>

813
00:32:36,999 --> 00:32:42,279
will grab the<font color="#E5E5E5"> the resources</font><font color="#CCCCCC"> from your</font>

814
00:32:39,190 --> 00:32:44,679
specific<font color="#E5E5E5"> instance so as a quick example</font>

815
00:32:42,279 --> 00:32:47,379
<font color="#E5E5E5">if you connected to</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> zero that a degree</font>

816
00:32:44,679 --> 00:32:48,970
of static calm<font color="#E5E5E5"> and let's all do a DNS</font>

817
00:32:47,379 --> 00:32:51,309
<font color="#CCCCCC">lookup and</font><font color="#E5E5E5"> they're always off to an</font>

818
00:32:48,970 --> 00:32:53,350
<font color="#CCCCCC">amazon edge node and then when you</font>

819
00:32:51,309 --> 00:32:56,049
supply<font color="#CCCCCC"> it in subscribe host header in</font>

820
00:32:53,350 --> 00:32:58,480
the HTTP<font color="#CCCCCC"> for your in</font><font color="#E5E5E5"> my</font><font color="#CCCCCC"> instant star</font>

821
00:32:56,049 --> 00:33:00,759
<font color="#CCCCCC">fragment net and then look</font><font color="#E5E5E5"> for that cat</font>

822
00:32:58,480 --> 00:33:02,590
dot<font color="#E5E5E5"> jpg it might not exist on a zero</font>

823
00:33:00,759 --> 00:33:05,200
<font color="#CCCCCC">that a degree of static calm but it will</font>

824
00:33:02,590 --> 00:33:07,779
actually<font color="#E5E5E5"> grab it from my instance so</font>

825
00:33:05,200 --> 00:33:13,269
<font color="#E5E5E5">that lets me basically hide it behind</font>

826
00:33:07,779 --> 00:33:14,739
<font color="#E5E5E5">this domain so</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> organizations use</font>

827
00:33:13,269 --> 00:33:16,239
and CloudFront might not want to<font color="#E5E5E5"> use</font><font color="#CCCCCC"> the</font>

828
00:33:14,739 --> 00:33:18,279
CloudFront dotnet domain so what do they

829
00:33:16,239 --> 00:33:20,619
do they go<font color="#E5E5E5"> ahead</font><font color="#CCCCCC"> and use cname records</font>

830
00:33:18,279 --> 00:33:24,340
<font color="#E5E5E5">to allow them</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> use the wrong domain</font>

831
00:33:20,619 --> 00:33:26,470
<font color="#E5E5E5">instead of the one forced by a content</font>

832
00:33:24,340 --> 00:33:29,340
delivery network so this was quite

833
00:33:26,470 --> 00:33:34,539
<font color="#CCCCCC">interesting if you set a cname record to</font>

834
00:33:29,340 --> 00:33:35,590
<font color="#E5E5E5">give it dot cosmic net and a land-based</font>

835
00:33:34,539 --> 00:33:38,379
<font color="#CCCCCC">will actually use it</font>

836
00:33:35,590 --> 00:33:40,899
<font color="#E5E5E5">so I went ahead and scanned the</font><font color="#CCCCCC"> Alexa</font>

837
00:33:38,379 --> 00:33:42,040
top<font color="#E5E5E5"> 1 million</font><font color="#CCCCCC"> forint cname records to</font>

838
00:33:40,899 --> 00:33:44,620
the conference

839
00:33:42,040 --> 00:33:47,530
delivery network<font color="#CCCCCC"> quick scan of</font><font color="#E5E5E5"> the top 1</font>

840
00:33:44,620 --> 00:33:50,530
million there<font color="#E5E5E5"> was 15,000</font><font color="#CCCCCC"> ish domains</font>

841
00:33:47,530 --> 00:33:54,399
<font color="#E5E5E5">I've put these all on my like github</font>

842
00:33:50,530 --> 00:33:56,080
<font color="#E5E5E5">Asia so as a quick</font><font color="#CCCCCC"> example of what sort</font>

843
00:33:54,400 --> 00:33:59,050
of domains<font color="#E5E5E5"> that</font><font color="#CCCCCC"> were I was able to find</font>

844
00:33:56,080 --> 00:34:03,040
<font color="#CCCCCC">I</font><font color="#E5E5E5"> were financials such as API the HSBC</font>

845
00:33:59,050 --> 00:34:05,139
<font color="#CCCCCC">comm my favorite one was</font><font color="#E5E5E5"> I see the end</font>

846
00:34:03,040 --> 00:34:07,960
<font color="#E5E5E5">are</font><font color="#CCCCCC"> a zero that's</font><font color="#E5E5E5"> like the Arizona</font>

847
00:34:05,140 --> 00:34:09,510
government<font color="#CCCCCC"> and that was also one I found</font>

848
00:34:07,960 --> 00:34:11,740
<font color="#E5E5E5">that was being used</font><font color="#CCCCCC"> like four days</font><font color="#E5E5E5"> ago</font>

849
00:34:09,510 --> 00:34:13,179
<font color="#E5E5E5">but there's the Bank of</font><font color="#CCCCCC"> Melbourne so</font>

850
00:34:11,739 --> 00:34:14,379
there's<font color="#E5E5E5"> quite a few interesting domains</font>

851
00:34:13,179 --> 00:34:18,940
<font color="#E5E5E5">that you could use</font><font color="#CCCCCC"> to mask your</font>

852
00:34:14,380 --> 00:34:20,770
infrastructure so a few drawbacks with

853
00:34:18,940 --> 00:34:23,080
domain<font color="#E5E5E5"> fronting is like it'll only</font><font color="#CCCCCC"> work</font>

854
00:34:20,770 --> 00:34:25,000
if the<font color="#E5E5E5"> proxy</font><font color="#CCCCCC"> is an RFC two six one six</font>

855
00:34:23,080 --> 00:34:30,190
compliant section<font color="#CCCCCC"> fourteen twenty three</font>

856
00:34:25,000 --> 00:34:32,770
which basically rewrites the<font color="#E5E5E5"> request we</font>

857
00:34:30,190 --> 00:34:34,750
found an anomaly<font color="#CCCCCC"> where I'm so fast web</font>

858
00:34:32,770 --> 00:34:36,820
gate with and it<font color="#E5E5E5"> seemed to</font><font color="#CCCCCC"> be</font><font color="#E5E5E5"> compliant</font>

859
00:34:34,750 --> 00:34:38,350
and yeah so if you're up against so

860
00:34:36,820 --> 00:34:41,679
<font color="#CCCCCC">first web gateway link and</font><font color="#E5E5E5"> just go</font><font color="#CCCCCC"> ahead</font>

861
00:34:38,350 --> 00:34:47,949
and use the<font color="#CCCCCC"> domain</font><font color="#E5E5E5"> fronting technique if</font>

862
00:34:41,679 --> 00:34:50,230
<font color="#E5E5E5">you wanted to ideally I usually say use</font>

863
00:34:47,949 --> 00:34:52,149
<font color="#E5E5E5">domain fronting after you've already</font>

864
00:34:50,230 --> 00:34:54,100
infiltrate the organization using like

865
00:34:52,149 --> 00:34:55,929
<font color="#E5E5E5">the traditional</font><font color="#CCCCCC"> c</font><font color="#E5E5E5"> to sort of thing and</font>

866
00:34:54,100 --> 00:34:58,360
then you<font color="#CCCCCC"> can use this to establish</font>

867
00:34:55,929 --> 00:34:59,770
long-term<font color="#CCCCCC"> c2 if the main fronting would</font>

868
00:34:58,360 --> 00:35:01,240
work so<font color="#E5E5E5"> after you've already infiltrated</font>

869
00:34:59,770 --> 00:35:03,580
it's a lot easier<font color="#CCCCCC"> for</font><font color="#E5E5E5"> you to do that</font>

870
00:35:01,240 --> 00:35:06,580
<font color="#E5E5E5">until</font><font color="#CCCCCC"> a recon to sort</font><font color="#E5E5E5"> of like figure the</font>

871
00:35:03,580 --> 00:35:09,180
configuration of the proxy and however

872
00:35:06,580 --> 00:35:11,590
<font color="#E5E5E5">the main fencing technique will work</font><font color="#CCCCCC"> a</font>

873
00:35:09,180 --> 00:35:13,540
lot<font color="#CCCCCC"> of people have also said well if</font>

874
00:35:11,590 --> 00:35:16,150
there's no root CA installed on the

875
00:35:13,540 --> 00:35:18,130
target<font color="#CCCCCC"> machine you can probably TLS the</font>

876
00:35:16,150 --> 00:35:18,610
<font color="#E5E5E5">connection so use</font><font color="#CCCCCC"> HTTP</font><font color="#E5E5E5"> and that will</font>

877
00:35:18,130 --> 00:35:20,500
work

878
00:35:18,610 --> 00:35:21,940
I found<font color="#CCCCCC"> organizations where it's</font>

879
00:35:20,500 --> 00:35:25,450
configured properly and it will drop the

880
00:35:21,940 --> 00:35:27,790
<font color="#E5E5E5">packets if it can't inspect it so yeah</font>

881
00:35:25,450 --> 00:35:29,230
<font color="#E5E5E5">so more fall I am</font><font color="#CCCCCC"> after you've over the</font>

882
00:35:27,790 --> 00:35:32,350
infiltrate<font color="#E5E5E5"> then you can figure out</font>

883
00:35:29,230 --> 00:35:33,970
whether little works or thing and so

884
00:35:32,350 --> 00:35:36,690
it's<font color="#CCCCCC"> a</font><font color="#E5E5E5"> quick demo of the domain fronting</font>

885
00:35:33,970 --> 00:35:36,689
sort of technique

886
00:35:46,430 --> 00:35:50,220
right so on the left here<font color="#CCCCCC"> I beginning</font>

887
00:35:48,690 --> 00:35:52,680
like listing the DNS cache of<font color="#E5E5E5"> the</font>

888
00:35:50,220 --> 00:35:54,390
<font color="#E5E5E5">machine</font><font color="#CCCCCC"> so there's no like</font><font color="#E5E5E5"> records</font><font color="#CCCCCC"> ler</font>

889
00:35:52,680 --> 00:35:56,490
I've run the domain<font color="#CCCCCC"> friends in payload</font>

890
00:35:54,390 --> 00:35:59,460
<font color="#E5E5E5">and on the right we can immediately see</font>

891
00:35:56,490 --> 00:36:01,950
I see<font color="#E5E5E5"> the under</font><font color="#CCCCCC"> a CEO of pop up and it</font>

892
00:35:59,460 --> 00:36:04,619
sticks it<font color="#CCCCCC"> until cash</font><font color="#E5E5E5"> and there's def</font>

893
00:36:01,950 --> 00:36:07,769
taught us a spending curve and there's

894
00:36:04,619 --> 00:36:09,509
one more in the UK<font color="#E5E5E5"> so you could actually</font>

895
00:36:07,769 --> 00:36:11,930
create<font color="#E5E5E5"> a payload that uses thousands of</font>

896
00:36:09,509 --> 00:36:13,950
these<font color="#CCCCCC"> domains and it all send the right</font>

897
00:36:11,930 --> 00:36:16,140
potentially send the blue team off on a

898
00:36:13,950 --> 00:36:18,569
wild<font color="#CCCCCC"> goose chase trying to find all of</font>

899
00:36:16,140 --> 00:36:20,490
<font color="#E5E5E5">these domains and</font><font color="#CCCCCC"> block worm that</font><font color="#E5E5E5"> was</font>

900
00:36:18,569 --> 00:36:24,150
<font color="#E5E5E5">just a quick test to make sure</font><font color="#CCCCCC"> that I've</font>

901
00:36:20,490 --> 00:36:25,470
got<font color="#CCCCCC"> em</font><font color="#E5E5E5"> to a</font><font color="#CCCCCC"> c2 and prove that</font><font color="#E5E5E5"> then if</font>

902
00:36:24,150 --> 00:36:28,950
you<font color="#E5E5E5"> list it by</font><font color="#CCCCCC"> ID unless you</font><font color="#E5E5E5"> actually</font>

903
00:36:25,470 --> 00:36:31,799
<font color="#CCCCCC">sealer every name is actually resolved</font>

904
00:36:28,950 --> 00:36:33,779
to a different edge node<font color="#E5E5E5"> so it</font><font color="#CCCCCC"> means</font>

905
00:36:31,799 --> 00:36:35,839
there's potentially more nodes that<font color="#CCCCCC"> I'll</font>

906
00:36:33,779 --> 00:36:41,490
have to<font color="#E5E5E5"> block off at the block and by IP</font>

907
00:36:35,839 --> 00:36:44,549
<font color="#E5E5E5">here's a quick view of the yeah</font><font color="#CCCCCC"> off</font><font color="#E5E5E5"> the</font>

908
00:36:41,490 --> 00:36:46,200
paper the<font color="#CCCCCC"> coms</font><font color="#E5E5E5"> itself so it's connecting</font>

909
00:36:44,549 --> 00:36:47,460
<font color="#CCCCCC">to probably like a</font><font color="#E5E5E5"> to see the end of</font><font color="#CCCCCC"> a</font>

910
00:36:46,200 --> 00:36:49,769
see that girl what<font color="#CCCCCC"> anyway is an edge</font>

911
00:36:47,460 --> 00:36:51,869
node and that's my particular and

912
00:36:49,769 --> 00:36:54,508
<font color="#E5E5E5">CloudFront instance that my malicious</font>

913
00:36:51,869 --> 00:36:57,240
instance and it's grabbing<font color="#CCCCCC"> lightly</font>

914
00:36:54,509 --> 00:37:07,279
activity sort<font color="#CCCCCC"> of like resource and then</font>

915
00:36:57,240 --> 00:37:07,279
it returns<font color="#CCCCCC"> with the calm okay</font>

916
00:37:13,859 --> 00:37:19,499
so I'm just going<font color="#CCCCCC"> to talk about lateral</font>

917
00:37:16,979 --> 00:37:22,410
<font color="#E5E5E5">movement now so lateral movement</font>

918
00:37:19,499 --> 00:37:27,808
techniques have pretty much been reduced

919
00:37:22,410 --> 00:37:32,940
<font color="#E5E5E5">to</font><font color="#CCCCCC"> px exact WMI</font><font color="#E5E5E5"> powershell remoting</font><font color="#CCCCCC"> RDP</font>

920
00:37:27,809 --> 00:37:35,369
so pretty useful techniques but we found

921
00:37:32,940 --> 00:37:37,140
situations where you might<font color="#CCCCCC"> be in like a</font>

922
00:37:35,369 --> 00:37:39,329
sandboxed environment which doesn't

923
00:37:37,140 --> 00:37:40,680
<font color="#E5E5E5">allow out and like outbound</font>

924
00:37:39,329 --> 00:37:43,890
<font color="#CCCCCC">communication</font><font color="#E5E5E5"> so the rest of the network</font>

925
00:37:40,680 --> 00:37:45,779
<font color="#CCCCCC">so sis admins can only like RDP into</font><font color="#E5E5E5"> the</font>

926
00:37:43,890 --> 00:37:47,848
<font color="#CCCCCC">dmz perhaps</font><font color="#E5E5E5"> and you've compromised</font>

927
00:37:45,779 --> 00:37:50,219
something inside the DMZ<font color="#CCCCCC"> so if you were</font>

928
00:37:47,849 --> 00:37:51,690
to let attack outwards from the<font color="#E5E5E5"> DMZ</font><font color="#CCCCCC"> then</font>

929
00:37:50,219 --> 00:37:52,499
you might<font color="#CCCCCC"> use the</font><font color="#E5E5E5"> techniques such as</font>

930
00:37:51,690 --> 00:37:56,489
like this one

931
00:37:52,499 --> 00:37:58,348
so RDP when you connect<font color="#CCCCCC"> into target</font>

932
00:37:56,489 --> 00:38:00,690
machine you could mount your drives and

933
00:37:58,349 --> 00:38:02,519
<font color="#E5E5E5">if you mount your drives on your</font><font color="#CCCCCC"> desk</font>

934
00:38:00,690 --> 00:38:05,369
it basically exposes<font color="#E5E5E5"> this backslash</font>

935
00:38:02,519 --> 00:38:08,218
<font color="#E5E5E5">backslash T s quite</font><font color="#CCCCCC"> Batchelor C Drive on</font>

936
00:38:05,369 --> 00:38:09,660
the<font color="#E5E5E5"> target session inside the RDP</font>

937
00:38:08,219 --> 00:38:11,369
session and then you can learn

938
00:38:09,660 --> 00:38:14,180
<font color="#CCCCCC">drag-and-drop files like back and</font><font color="#E5E5E5"> forth</font>

939
00:38:11,369 --> 00:38:18,119
<font color="#CCCCCC">between your</font><font color="#E5E5E5"> host machine and the the</font>

940
00:38:14,180 --> 00:38:19,558
the<font color="#E5E5E5"> server so that's quite useful and</font>

941
00:38:18,119 --> 00:38:21,660
<font color="#E5E5E5">quite</font><font color="#CCCCCC"> a lot of</font><font color="#E5E5E5"> people</font><font color="#CCCCCC"> use like system</font>

942
00:38:19,559 --> 00:38:23,190
admins might use like<font color="#E5E5E5"> to earn drop</font>

943
00:38:21,660 --> 00:38:27,180
updates into<font color="#E5E5E5"> the environment if they</font>

944
00:38:23,190 --> 00:38:30,150
<font color="#CCCCCC">needed to so what we</font><font color="#E5E5E5"> created</font><font color="#CCCCCC"> was a RDP</font>

945
00:38:27,180 --> 00:38:32,308
inception you basically put this into

946
00:38:30,150 --> 00:38:33,869
the start folder of the RDP<font color="#E5E5E5"> session</font><font color="#CCCCCC"> so</font>

947
00:38:32,309 --> 00:38:36,089
you've compromised<font color="#E5E5E5"> this web app or this</font>

948
00:38:33,869 --> 00:38:38,640
database<font color="#E5E5E5"> and then you start deploying</font>

949
00:38:36,089 --> 00:38:42,089
this<font color="#E5E5E5"> sort of like technique next time</font>

950
00:38:38,640 --> 00:38:44,670
the sysadmin logs in with<font color="#E5E5E5"> mount drives</font>

951
00:38:42,089 --> 00:38:46,828
mounted it will infect his machine

952
00:38:44,670 --> 00:38:49,319
so it'll infect his machine next time he

953
00:38:46,829 --> 00:38:52,920
logs in you'll<font color="#E5E5E5"> get a shell on his</font>

954
00:38:49,319 --> 00:38:54,538
machine<font color="#E5E5E5"> so he's only so between him and</font>

955
00:38:52,920 --> 00:38:56,130
the the<font color="#E5E5E5"> target environment he's only</font>

956
00:38:54,539 --> 00:38:58,799
allowed three<font color="#CCCCCC"> three eight</font><font color="#E5E5E5"> nine</font><font color="#CCCCCC"> inwards</font>

957
00:38:56,130 --> 00:39:00,660
<font color="#E5E5E5">so you wouldn't have been able</font><font color="#CCCCCC"> to attack</font>

958
00:38:58,799 --> 00:39:03,569
outwards in any other way using<font color="#E5E5E5"> like the</font>

959
00:39:00,660 --> 00:39:06,749
<font color="#CCCCCC">network and so let's sort</font><font color="#E5E5E5"> of like whims</font>

960
00:39:03,569 --> 00:39:10,499
of<font color="#CCCCCC"> words</font><font color="#E5E5E5"> and in fact so here's a quick</font>

961
00:39:06,749 --> 00:39:13,828
diagram<font color="#CCCCCC"> where down here were</font>

962
00:39:10,499 --> 00:39:16,078
establishing<font color="#CCCCCC"> c2 over like redirector</font>

963
00:39:13,829 --> 00:39:18,119
<font color="#E5E5E5">will compromise this database server and</font>

964
00:39:16,079 --> 00:39:20,369
this database<font color="#E5E5E5"> server can't see anything</font>

965
00:39:18,119 --> 00:39:22,380
<font color="#E5E5E5">and any of this so it can't connect</font>

966
00:39:20,369 --> 00:39:24,749
outwards to any of these<font color="#E5E5E5"> machines but</font>

967
00:39:22,380 --> 00:39:27,810
the file<font color="#E5E5E5"> server or</font><font color="#CCCCCC"> like maybe</font><font color="#E5E5E5"> even</font><font color="#CCCCCC"> this</font>

968
00:39:24,749 --> 00:39:28,980
could connect in<font color="#E5E5E5"> very create now</font>

969
00:39:27,810 --> 00:39:31,830
so that's amazing<font color="#CCCCCC"> and</font><font color="#E5E5E5"> then there's</font>

970
00:39:28,980 --> 00:39:34,440
<font color="#E5E5E5">systems I've</font><font color="#CCCCCC"> men over here he's at home</font>

971
00:39:31,830 --> 00:39:36,360
and he's a<font color="#E5E5E5"> VP and then maybe and then I</font>

972
00:39:34,440 --> 00:39:37,710
<font color="#CCCCCC">de peeing into a jump box are you peeing</font>

973
00:39:36,360 --> 00:39:40,830
into<font color="#CCCCCC"> the</font><font color="#E5E5E5"> domain controller for whatever</font>

974
00:39:37,710 --> 00:39:42,210
reason it's theoretical and then he had

975
00:39:40,830 --> 00:39:44,670
<font color="#CCCCCC">the peasants</font><font color="#E5E5E5"> a file server and finally</font>

976
00:39:42,210 --> 00:39:46,470
<font color="#E5E5E5">into the database so if in these steps</font>

977
00:39:44,670 --> 00:39:48,000
he mounts<font color="#CCCCCC"> his drives like say from</font><font color="#E5E5E5"> the</font>

978
00:39:46,470 --> 00:39:51,209
file server into the database server

979
00:39:48,000 --> 00:39:53,310
<font color="#E5E5E5">then this technique</font><font color="#CCCCCC"> could work in such a</font>

980
00:39:51,210 --> 00:39:55,770
<font color="#E5E5E5">way where it will</font><font color="#CCCCCC"> in fact</font><font color="#E5E5E5"> the server and</font>

981
00:39:53,310 --> 00:39:57,450
<font color="#E5E5E5">then if he</font><font color="#CCCCCC"> has mount drives mount with</font>

982
00:39:55,770 --> 00:39:59,430
here<font color="#E5E5E5"> it will in</font><font color="#CCCCCC"> fact this and then</font>

983
00:39:57,450 --> 00:40:00,930
eventually<font color="#E5E5E5"> loop all the way upwards by</font>

984
00:39:59,430 --> 00:40:02,430
at<font color="#E5E5E5"> this point at the file server you</font>

985
00:40:00,930 --> 00:40:03,899
might or it might be<font color="#CCCCCC"> like an internal</font>

986
00:40:02,430 --> 00:40:06,270
file server you might<font color="#E5E5E5"> already be in</font><font color="#CCCCCC"> a</font>

987
00:40:03,900 --> 00:40:09,570
<font color="#CCCCCC">position on</font><font color="#E5E5E5"> network where</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> can begin</font>

988
00:40:06,270 --> 00:40:15,030
attacking<font color="#CCCCCC"> these</font><font color="#E5E5E5"> own of a sort of</font><font color="#CCCCCC"> I'm</font>

989
00:40:09,570 --> 00:40:16,730
assets in the organization<font color="#CCCCCC"> so just to</font>

990
00:40:15,030 --> 00:40:19,370
<font color="#E5E5E5">get an understanding of how like</font>

991
00:40:16,730 --> 00:40:23,370
applicable<font color="#E5E5E5"> list of technique is I</font>

992
00:40:19,370 --> 00:40:25,410
surveyed the<font color="#CCCCCC"> round home</font><font color="#E5E5E5"> 27 people</font><font color="#CCCCCC"> in the</font>

993
00:40:23,370 --> 00:40:27,839
<font color="#E5E5E5">InfoSec community had basically put up a</font>

994
00:40:25,410 --> 00:40:29,970
poll on<font color="#CCCCCC"> Twitter</font><font color="#E5E5E5"> now</font><font color="#CCCCCC"> 50</font><font color="#E5E5E5"> percent said they</font>

995
00:40:27,840 --> 00:40:32,910
did mount the drives at least once or

996
00:40:29,970 --> 00:40:34,649
<font color="#E5E5E5">twice</font><font color="#CCCCCC"> in my life so</font><font color="#E5E5E5"> it's quite</font>

997
00:40:32,910 --> 00:40:36,240
applicable<font color="#CCCCCC"> I think even more</font><font color="#E5E5E5"> forces</font>

998
00:40:34,650 --> 00:40:40,920
admins where they have the<font color="#E5E5E5"> drag-and-drop</font>

999
00:40:36,240 --> 00:40:46,500
<font color="#E5E5E5">update since an environment maybe and so</font>

1000
00:40:40,920 --> 00:40:47,910
posh about<font color="#E5E5E5"> hundred aunts this so if</font>

1001
00:40:46,500 --> 00:40:48,810
you've done any<font color="#E5E5E5"> kind of red teaming</font>

1002
00:40:47,910 --> 00:40:50,730
you're probably familiar with a tool

1003
00:40:48,810 --> 00:40:51,779
<font color="#E5E5E5">called</font><font color="#CCCCCC"> bloodhound I couldn't really not</font>

1004
00:40:50,730 --> 00:40:53,340
mention it because<font color="#E5E5E5"> it's one</font><font color="#CCCCCC"> of the</font>

1005
00:40:51,780 --> 00:40:55,110
biggest advances in kind<font color="#E5E5E5"> of red team</font>

1006
00:40:53,340 --> 00:40:56,010
<font color="#CCCCCC">tactics that</font><font color="#E5E5E5"> have come</font><font color="#CCCCCC"> slight in</font><font color="#E5E5E5"> the</font>

1007
00:40:55,110 --> 00:40:57,420
past<font color="#E5E5E5"> twelve or so months</font>

1008
00:40:56,010 --> 00:41:01,920
it's also one of our<font color="#E5E5E5"> kind of favorite</font>

1009
00:40:57,420 --> 00:41:05,430
tools so bloodhound basically allows you

1010
00:41:01,920 --> 00:41:07,860
to query a lot of retrieve a lot<font color="#CCCCCC"> of</font>

1011
00:41:05,430 --> 00:41:09,690
<font color="#CCCCCC">information from ad</font><font color="#E5E5E5"> things like user</font>

1012
00:41:07,860 --> 00:41:13,590
sessions<font color="#CCCCCC"> group memberships</font>

1013
00:41:09,690 --> 00:41:15,930
<font color="#E5E5E5">local admin rights and basically it will</font>

1014
00:41:13,590 --> 00:41:19,380
use this information<font color="#CCCCCC"> to provide a visual</font>

1015
00:41:15,930 --> 00:41:20,730
mapping of the ad environment and<font color="#E5E5E5"> this</font>

1016
00:41:19,380 --> 00:41:22,800
visual mapping will actually allow you

1017
00:41:20,730 --> 00:41:24,840
to<font color="#E5E5E5"> better understand your ad</font>

1018
00:41:22,800 --> 00:41:27,210
infrastructure but it'll also allow<font color="#CCCCCC"> you</font>

1019
00:41:24,840 --> 00:41:29,730
<font color="#CCCCCC">to actually</font><font color="#E5E5E5"> identify pass to escalate</font>

1020
00:41:27,210 --> 00:41:33,120
privileges<font color="#E5E5E5"> based on the relationships</font>

1021
00:41:29,730 --> 00:41:34,560
between all<font color="#CCCCCC"> these kind of objects so if</font>

1022
00:41:33,120 --> 00:41:37,020
we look at a<font color="#E5E5E5"> quick example let's say</font>

1023
00:41:34,560 --> 00:41:39,690
we've fished a user called Alice and

1024
00:41:37,020 --> 00:41:41,160
Alice is a member of the<font color="#CCCCCC"> helpdesk</font><font color="#E5E5E5"> group</font>

1025
00:41:39,690 --> 00:41:42,420
and<font color="#CCCCCC"> now how</font>

1026
00:41:41,160 --> 00:41:43,770
this group is<font color="#CCCCCC"> also a member of the</font>

1027
00:41:42,420 --> 00:41:45,450
support group<font color="#E5E5E5"> and that may not be</font>

1028
00:41:43,770 --> 00:41:48,829
<font color="#E5E5E5">immediately</font><font color="#CCCCCC"> obvious to</font><font color="#E5E5E5"> you when you're</font>

1029
00:41:45,450 --> 00:41:51,299
<font color="#E5E5E5">kind of compromised Alice's machine and</font>

1030
00:41:48,829 --> 00:41:52,710
what also<font color="#E5E5E5"> may not</font><font color="#CCCCCC"> be obvious</font><font color="#E5E5E5"> to you</font>

1031
00:41:51,299 --> 00:41:54,119
straight<font color="#CCCCCC"> away is that</font><font color="#E5E5E5"> the support group</font>

1032
00:41:52,710 --> 00:41:55,349
is<font color="#CCCCCC"> actually got admin rights on them</font>

1033
00:41:54,119 --> 00:41:57,900
something<font color="#E5E5E5"> like maybe the</font><font color="#CCCCCC"> sharepoint</font>

1034
00:41:55,349 --> 00:41:59,369
<font color="#CCCCCC">server and at that given</font><font color="#E5E5E5"> time there's a</font>

1035
00:41:57,900 --> 00:42:02,339
domain admin logged<font color="#E5E5E5"> on to the sharepoint</font>

1036
00:41:59,369 --> 00:42:05,630
server so<font color="#E5E5E5"> that basically gives us a very</font>

1037
00:42:02,339 --> 00:42:09,779
quick path to escalate privileges to<font color="#E5E5E5"> da</font>

1038
00:42:05,630 --> 00:42:11,640
now<font color="#CCCCCC"> what</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> we'll actually</font><font color="#E5E5E5"> retrieve all</font>

1039
00:42:09,780 --> 00:42:13,140
this information<font color="#E5E5E5"> and produce a graph</font>

1040
00:42:11,640 --> 00:42:14,759
that<font color="#E5E5E5"> something looks a little bit</font>

1041
00:42:13,140 --> 00:42:16,770
similar to<font color="#E5E5E5"> this and it's</font><font color="#CCCCCC"> actually</font><font color="#E5E5E5"> got</font>

1042
00:42:14,760 --> 00:42:18,900
multiple paths<font color="#E5E5E5"> to actually go from</font><font color="#CCCCCC"> the</font>

1043
00:42:16,770 --> 00:42:20,430
Alice user<font color="#CCCCCC"> appear to</font><font color="#E5E5E5"> the domain admin</font>

1044
00:42:18,900 --> 00:42:22,500
down here so if<font color="#CCCCCC"> we think about that</font><font color="#E5E5E5"> a</font>

1045
00:42:20,430 --> 00:42:25,440
fictitious case that I<font color="#E5E5E5"> just mentioned</font><font color="#CCCCCC"> we</font>

1046
00:42:22,500 --> 00:42:26,970
<font color="#CCCCCC">can see Alice is a member of the help</font>

1047
00:42:25,440 --> 00:42:29,490
<font color="#CCCCCC">desk group</font><font color="#E5E5E5"> which is a member of the</font>

1048
00:42:26,970 --> 00:42:31,470
support group which has got admin rights

1049
00:42:29,490 --> 00:42:33,509
to the<font color="#CCCCCC"> SharePoint Server which has got a</font>

1050
00:42:31,470 --> 00:42:35,129
domain<font color="#CCCCCC"> admin logged on</font><font color="#E5E5E5"> so we could</font>

1051
00:42:33,510 --> 00:42:37,650
<font color="#E5E5E5">basically use</font><font color="#CCCCCC"> this information to very</font>

1052
00:42:35,130 --> 00:42:42,119
quickly go<font color="#CCCCCC"> from a normal user to and the</font>

1053
00:42:37,650 --> 00:42:45,150
main admin but it didn't<font color="#CCCCCC"> really stop</font>

1054
00:42:42,119 --> 00:42:46,319
there so in May this year the developers

1055
00:42:45,150 --> 00:42:50,520
<font color="#CCCCCC">of</font><font color="#E5E5E5"> bloodhound released another major</font>

1056
00:42:46,319 --> 00:42:52,440
update which basically<font color="#E5E5E5"> then used access</font>

1057
00:42:50,520 --> 00:42:55,230
control entities or access control lists

1058
00:42:52,440 --> 00:42:57,750
<font color="#E5E5E5">as a of an additional attack path for</font>

1059
00:42:55,230 --> 00:43:00,690
<font color="#CCCCCC">publish escalation</font><font color="#E5E5E5"> so and specifically</font>

1060
00:42:57,750 --> 00:43:02,700
now bloodhound will map out<font color="#CCCCCC"> all the ACLs</font>

1061
00:43:00,690 --> 00:43:04,859
for all<font color="#CCCCCC"> ad objects and it will attempt</font>

1062
00:43:02,700 --> 00:43:07,049
to<font color="#E5E5E5"> identify potentially misconfigured</font>

1063
00:43:04,859 --> 00:43:09,210
<font color="#E5E5E5">access control entities that can use</font>

1064
00:43:07,049 --> 00:43:12,240
approved escalation so these include

1065
00:43:09,210 --> 00:43:13,980
<font color="#CCCCCC">things like</font><font color="#E5E5E5"> the the force</font><font color="#CCCCCC"> Change</font>

1066
00:43:12,240 --> 00:43:16,319
<font color="#CCCCCC">Password</font><font color="#E5E5E5"> attribute which will basically</font>

1067
00:43:13,980 --> 00:43:18,660
allow<font color="#E5E5E5"> you to change the password of a</font>

1068
00:43:16,319 --> 00:43:20,339
target user<font color="#E5E5E5"> without knowing the current</font>

1069
00:43:18,660 --> 00:43:21,990
value so<font color="#E5E5E5"> this is typically things that</font>

1070
00:43:20,339 --> 00:43:24,599
you might<font color="#E5E5E5"> see</font><font color="#CCCCCC"> influence it on like</font><font color="#E5E5E5"> help</font>

1071
00:43:21,990 --> 00:43:27,359
<font color="#E5E5E5">desk objects or but you know that are</font>

1072
00:43:24,599 --> 00:43:30,660
<font color="#CCCCCC">influenced</font><font color="#E5E5E5"> with an ad it may there's</font>

1073
00:43:27,359 --> 00:43:32,220
<font color="#E5E5E5">also also find things like the the</font>

1074
00:43:30,660 --> 00:43:35,308
generic<font color="#E5E5E5"> price attribute which basically</font>

1075
00:43:32,220 --> 00:43:37,618
allows you<font color="#CCCCCC"> to update any kind of</font><font color="#E5E5E5"> non</font>

1076
00:43:35,309 --> 00:43:39,329
<font color="#E5E5E5">protective targets</font><font color="#CCCCCC"> object and so you</font>

1077
00:43:37,619 --> 00:43:40,890
could implicate something like the

1078
00:43:39,329 --> 00:43:42,329
script<font color="#CCCCCC"> path</font><font color="#E5E5E5"> parameter which will</font>

1079
00:43:40,890 --> 00:43:44,069
basically allow<font color="#CCCCCC"> you to</font><font color="#E5E5E5"> configure a</font>

1080
00:43:42,329 --> 00:43:48,990
command that<font color="#E5E5E5"> gets executed the next</font><font color="#CCCCCC"> time</font>

1081
00:43:44,069 --> 00:43:51,000
that user kind<font color="#E5E5E5"> of</font><font color="#CCCCCC"> lives on so we're</font>

1082
00:43:48,990 --> 00:43:53,250
always kind<font color="#E5E5E5"> of interested in automating</font>

1083
00:43:51,000 --> 00:43:54,609
a lot of the things<font color="#E5E5E5"> that we do on red</font>

1084
00:43:53,250 --> 00:43:57,670
team exercises<font color="#E5E5E5"> main</font>

1085
00:43:54,609 --> 00:43:59,529
for implementing a streamlining<font color="#CCCCCC"> you know</font>

1086
00:43:57,670 --> 00:44:00,819
<font color="#CCCCCC">imprinting and speeding apart our kind</font>

1087
00:43:59,529 --> 00:44:02,529
of<font color="#E5E5E5"> exploitation process because you</font>

1088
00:44:00,819 --> 00:44:03,759
never know how quickly the<font color="#E5E5E5"> blue team are</font>

1089
00:44:02,529 --> 00:44:07,029
going<font color="#E5E5E5"> to find you and kind of kick you</font>

1090
00:44:03,759 --> 00:44:08,730
<font color="#E5E5E5">off the network</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> Vincent actually went</font>

1091
00:44:07,029 --> 00:44:11,019
in developed a tool called<font color="#E5E5E5"> angry puppy</font>

1092
00:44:08,730 --> 00:44:12,609
<font color="#E5E5E5">and what angry puppy does is it's</font>

1093
00:44:11,019 --> 00:44:15,700
basically<font color="#E5E5E5"> a</font><font color="#CCCCCC"> Kabul script strike</font>

1094
00:44:12,609 --> 00:44:19,029
aggressive scripts which will allow you

1095
00:44:15,700 --> 00:44:22,149
to<font color="#E5E5E5"> import some of the the</font><font color="#CCCCCC"> bloodhound</font>

1096
00:44:19,029 --> 00:44:23,980
<font color="#E5E5E5">Jason export so you can identify a</font>

1097
00:44:22,150 --> 00:44:26,049
particular attack path within bloodhound

1098
00:44:23,980 --> 00:44:27,789
<font color="#CCCCCC">and you can export the</font><font color="#E5E5E5"> Jason and then</font>

1099
00:44:26,049 --> 00:44:29,920
<font color="#E5E5E5">you can import it into cobalt strike and</font>

1100
00:44:27,789 --> 00:44:31,480
then angry puppy will automatically

1101
00:44:29,920 --> 00:44:34,420
execute<font color="#E5E5E5"> that for you so you don't</font>

1102
00:44:31,480 --> 00:44:36,430
actually have<font color="#CCCCCC"> to manually need to log on</font>

1103
00:44:34,420 --> 00:44:37,900
<font color="#E5E5E5">to all the systems like dump the hashes</font>

1104
00:44:36,430 --> 00:44:40,149
dump the passwords<font color="#E5E5E5"> from those system</font>

1105
00:44:37,900 --> 00:44:42,880
<font color="#CCCCCC">reuse them</font><font color="#E5E5E5"> to log on to what the next</font>

1106
00:44:40,150 --> 00:44:44,289
<font color="#CCCCCC">node in the chain angry</font><font color="#E5E5E5"> puppy will</font>

1107
00:44:42,880 --> 00:44:46,900
automatically do this for you and<font color="#E5E5E5"> it</font>

1108
00:44:44,289 --> 00:44:49,569
<font color="#E5E5E5">will kick back a kind</font><font color="#CCCCCC"> of SMB beacon on</font>

1109
00:44:46,900 --> 00:44:51,400
each of those<font color="#CCCCCC"> systems and then I believe</font>

1110
00:44:49,569 --> 00:44:53,799
<font color="#E5E5E5">that they're planning to implement and</font>

1111
00:44:51,400 --> 00:44:54,940
the<font color="#CCCCCC"> currently</font><font color="#E5E5E5"> only sports the kind of</font>

1112
00:44:53,799 --> 00:44:56,440
<font color="#E5E5E5">credential</font><font color="#CCCCCC"> retriever what they're</font>

1113
00:44:54,940 --> 00:44:59,289
planning<font color="#E5E5E5"> to implement the kind of</font>

1114
00:44:56,440 --> 00:45:01,900
misconfigured<font color="#E5E5E5"> ACLs in the future so</font>

1115
00:44:59,289 --> 00:45:13,779
<font color="#CCCCCC">we'll give</font><font color="#E5E5E5"> you a quick demo of the angry</font>

1116
00:45:01,900 --> 00:45:15,999
<font color="#E5E5E5">puppy tool so this is in the tap path</font>

1117
00:45:13,779 --> 00:45:18,069
<font color="#CCCCCC">like we've decided</font><font color="#E5E5E5"> to execute you know</font>

1118
00:45:15,999 --> 00:45:23,140
so from the desktop user to desktop

1119
00:45:18,069 --> 00:45:25,690
support<font color="#E5E5E5"> I export the JSON for in blue</font>

1120
00:45:23,140 --> 00:45:27,578
town<font color="#E5E5E5"> so I've exported it go back</font><font color="#CCCCCC"> into</font>

1121
00:45:25,690 --> 00:45:30,910
<font color="#E5E5E5">call what strike go to the target</font>

1122
00:45:27,579 --> 00:45:33,190
<font color="#E5E5E5">session type in angry puppy I learn can</font>

1123
00:45:30,910 --> 00:45:35,640
just let select the JSON file<font color="#CCCCCC"> that</font><font color="#E5E5E5"> I</font>

1124
00:45:33,190 --> 00:45:37,930
want<font color="#CCCCCC"> to be a tap a flat one</font><font color="#E5E5E5"> executes and</font>

1125
00:45:35,640 --> 00:45:40,900
choose the sort of like lateral movement

1126
00:45:37,930 --> 00:45:42,819
technique on the comms<font color="#E5E5E5"> and</font><font color="#CCCCCC"> I just like</font>

1127
00:45:40,900 --> 00:45:46,180
<font color="#E5E5E5">run it and it will go ahead and execute</font>

1128
00:45:42,819 --> 00:45:48,819
<font color="#CCCCCC">this for me so this</font><font color="#E5E5E5"> is more</font><font color="#CCCCCC"> useful in</font>

1129
00:45:46,180 --> 00:45:51,009
larger sort of like attack paths where

1130
00:45:48,819 --> 00:45:52,720
it can execute it in minutes as opposed

1131
00:45:51,009 --> 00:45:54,220
to if you were<font color="#CCCCCC"> doing</font><font color="#E5E5E5"> it manually it</font>

1132
00:45:52,720 --> 00:46:02,890
might take a bit<font color="#CCCCCC"> longer and you've got a</font>

1133
00:45:54,220 --> 00:46:03,160
human error<font color="#CCCCCC"> involved</font><font color="#E5E5E5"> as well so yeah so</font>

1134
00:46:02,890 --> 00:46:04,569
now

1135
00:46:03,160 --> 00:46:07,629
it's finished executing the<font color="#CCCCCC"> attack path</font>

1136
00:46:04,570 --> 00:46:20,830
and obtained<font color="#CCCCCC"> access to the EM support</font>

1137
00:46:07,630 --> 00:46:22,600
group<font color="#E5E5E5"> okay so um so what's next</font><font color="#CCCCCC"> well</font>

1138
00:46:20,830 --> 00:46:24,100
while the past kind<font color="#E5E5E5"> of</font><font color="#CCCCCC"> 12</font><font color="#E5E5E5"> months have</font>

1139
00:46:22,600 --> 00:46:26,259
been<font color="#CCCCCC"> pretty exciting from a reading</font>

1140
00:46:24,100 --> 00:46:27,790
<font color="#CCCCCC">perspective</font><font color="#E5E5E5"> the advances in blue team</font>

1141
00:46:26,260 --> 00:46:31,210
<font color="#CCCCCC">tactics have meant</font><font color="#E5E5E5"> that we need to</font>

1142
00:46:27,790 --> 00:46:32,470
continually keep evolving<font color="#CCCCCC"> so</font><font color="#E5E5E5"> personally</font>

1143
00:46:31,210 --> 00:46:35,260
I think<font color="#E5E5E5"> we'll start to see more research</font>

1144
00:46:32,470 --> 00:46:37,629
<font color="#E5E5E5">into defensive evasion particularly</font>

1145
00:46:35,260 --> 00:46:40,110
things like<font color="#CCCCCC"> device</font><font color="#E5E5E5"> guard credential card</font>

1146
00:46:37,630 --> 00:46:42,430
<font color="#E5E5E5">they'll come under more scrutiny as</font>

1147
00:46:40,110 --> 00:46:46,030
organizations start to you know Windows

1148
00:46:42,430 --> 00:46:47,830
10<font color="#E5E5E5"> becomes more widely adopted and then</font>

1149
00:46:46,030 --> 00:46:49,360
generally<font color="#CCCCCC"> speaking</font><font color="#E5E5E5"> I really kind of</font>

1150
00:46:47,830 --> 00:46:51,759
expect the area of red teaming to grow

1151
00:46:49,360 --> 00:46:54,100
further so<font color="#E5E5E5"> perhaps we'll see the</font>

1152
00:46:51,760 --> 00:46:55,810
increase<font color="#CCCCCC"> in more sectors specific</font>

1153
00:46:54,100 --> 00:46:57,850
framework<font color="#E5E5E5"> so things similar to the C</font>

1154
00:46:55,810 --> 00:47:00,730
best<font color="#E5E5E5"> and</font><font color="#CCCCCC"> tiba and I cuss schemes</font><font color="#E5E5E5"> that I</font>

1155
00:46:57,850 --> 00:47:02,980
mentioned but outside<font color="#CCCCCC"> of Finance maybe</font>

1156
00:47:00,730 --> 00:47:07,240
targeting<font color="#E5E5E5"> and you know something like</font>

1157
00:47:02,980 --> 00:47:08,530
<font color="#E5E5E5">power or other kind of sectors and</font>

1158
00:47:07,240 --> 00:47:11,439
finally we just<font color="#E5E5E5"> like to say thanks</font>

1159
00:47:08,530 --> 00:47:13,900
really<font color="#E5E5E5"> to all the kind of researchers</font>

1160
00:47:11,440 --> 00:47:15,700
<font color="#E5E5E5">that we mentioned in our talk so you</font><font color="#CCCCCC"> can</font>

1161
00:47:13,900 --> 00:47:16,780
find you<font color="#CCCCCC"> can follow some of these guys</font>

1162
00:47:15,700 --> 00:47:19,000
on<font color="#CCCCCC"> Switzer they're always</font><font color="#E5E5E5"> kind</font><font color="#CCCCCC"> of</font>

1163
00:47:16,780 --> 00:47:20,890
kicking<font color="#E5E5E5"> out interesting stuff all the</font>

1164
00:47:19,000 --> 00:47:23,860
tools<font color="#CCCCCC"> that</font><font color="#E5E5E5"> we talked about in addition</font>

1165
00:47:20,890 --> 00:47:26,049
to some others are available<font color="#CCCCCC"> on the</font><font color="#E5E5E5"> MDC</font>

1166
00:47:23,860 --> 00:47:27,100
active<font color="#CCCCCC"> breach</font><font color="#E5E5E5"> github page where you can</font>

1167
00:47:26,050 --> 00:47:32,410
kind of use them in your<font color="#E5E5E5"> own</font><font color="#CCCCCC"> writing</font>

1168
00:47:27,100 --> 00:47:34,270
exercises<font color="#CCCCCC"> so any questions we've got a</font>

1169
00:47:32,410 --> 00:47:37,350
couple of<font color="#E5E5E5"> minutes</font><font color="#CCCCCC"> left so if anyone's</font>

1170
00:47:34,270 --> 00:47:41,500
got anything<font color="#E5E5E5"> you want to ask feel free</font>

1171
00:47:37,350 --> 00:47:43,600
any questions or maybe questions<font color="#E5E5E5"> off the</font>

1172
00:47:41,500 --> 00:47:46,180
stage maybe during lunch time which

1173
00:47:43,600 --> 00:47:49,460
<font color="#E5E5E5">happens right up to this</font><font color="#CCCCCC"> well thank</font><font color="#E5E5E5"> you</font>

1174
00:47:46,180 --> 00:47:52,759
very<font color="#E5E5E5"> much then</font><font color="#CCCCCC"> Dominic</font><font color="#E5E5E5"> Vincent</font>

1175
00:47:49,460 --> 00:47:52,760
[Applause]

