1
00:00:02,110 --> 00:00:20,110
predictor metric guys here are ethnic
thank you very much

2
00:00:20,110 --> 00:00:23,630
usually at the beginning of my talk is
five minutes battling with the projector

3
00:00:23,630 --> 00:00:29,990
trying to get it to work so very nice to
not have to do that today anyway so I

4
00:00:29,990 --> 00:00:35,339
guess they don't need too big of an
introduction most of what I do

5
00:00:35,340 --> 00:00:42,250
Sakura Con is contesting vulnerability
assessment but when I do about 95% of

6
00:00:42,250 --> 00:00:49,370
the time so I was pretty good I can't
complain that much of the Washington

7
00:00:49,370 --> 00:00:56,760
dc-area we focus about half on critical
infrastructure and skate up and the

8
00:00:56,760 --> 00:01:02,890
other half government and commercial so
I spent about half of my time and power

9
00:01:02,890 --> 00:01:08,320
plants and dreamed up at dawn and the
other half and we're government

10
00:01:08,320 --> 00:01:16,530
buildings we have a pretty nice to give
me a pretty unique perspective on our

11
00:01:16,530 --> 00:01:24,190
world right now I did co-author a book
on creating awareness program if you are

12
00:01:24,190 --> 00:01:27,820
a glutton for punishment be sure to
write a book about a topic that everyone

13
00:01:27,820 --> 00:01:33,830
hates it was pretty interesting but some
of the same principles that are

14
00:01:33,830 --> 00:01:38,560
discussed in the book war today though
still apply

15
00:01:38,560 --> 00:01:44,080
I do a lot of social engineering as part
of my job I do a lot of training as well

16
00:01:44,080 --> 00:01:46,780
so this year

17
00:01:46,780 --> 00:01:51,049
thought RFID and I taught social
engineering if you want to learn more

18
00:01:51,049 --> 00:01:55,070
about that I got lucky

19
00:01:55,070 --> 00:02:01,720
access so I got into physical access is
kind of a means to an end as a pen

20
00:02:01,720 --> 00:02:09,179
tester during red thing and sometimes
our flags are not domain admin yeah

21
00:02:09,179 --> 00:02:16,319
everybody come up sometime the the flag
is something different sometimes it see

22
00:02:16,319 --> 00:02:21,119
if you can get in there you can
compromise the server we don't care how

23
00:02:21,120 --> 00:02:26,290
you do it so it's been interesting to
see how some of our our client really

24
00:02:26,290 --> 00:02:30,730
evolved in the way that they look at
penetration testing and they're starting

25
00:02:30,730 --> 00:02:35,799
to see the big picture here so I'm
definitely not an expert on physical

26
00:02:35,800 --> 00:02:41,769
access systems I love myself as an
enthusiast I learned a lot here and

27
00:02:41,769 --> 00:02:50,380
there that I picked up along the way and
learning more everyday so here it is

28
00:02:50,380 --> 00:02:52,880
that I chose this topic today

29
00:02:52,880 --> 00:02:58,100
quick overview so the topology for
physical access systems as a little bit

30
00:02:58,100 --> 00:03:01,810
different than what we're used to seeing
my teeth rattle that I'd take some time

31
00:03:01,810 --> 00:03:08,680
there then we'll talk about why it's so
bad and we'll get into some cool attack

32
00:03:08,680 --> 00:03:13,320
services and exploit toward the end and
will tie it all together and I'll walk

33
00:03:13,320 --> 00:03:21,570
you through one of our recent engagement
the wipers Alexa systems they're

34
00:03:21,570 --> 00:03:27,420
everywhere everywhere everywhere
somebody you swipe the card every where

35
00:03:27,420 --> 00:03:34,339
somebody can keep up through the airport
I saw lots of the lots of good card

36
00:03:34,340 --> 00:03:36,350
readers at the airport today

37
00:03:36,350 --> 00:03:40,858
sure some of you to be trained to get
here

38
00:03:40,859 --> 00:03:49,540
great same principles apply no I did not
have the card I really admired it and

39
00:03:49,540 --> 00:03:54,420
contemplated but i did not bring any
equipment with me a lot of times when I

40
00:03:54,420 --> 00:03:57,819
get these talks that non technical
conferences nobody will come up close to

41
00:03:57,819 --> 00:04:00,750
me because they're afraid I'm gonna
steal their information from their cards

42
00:04:00,750 --> 00:04:05,150
none of that today no equipment nothing
up my sleeve

43
00:04:05,150 --> 00:04:13,069
we should be good a less obvious places
where these types of systems hotels are

44
00:04:13,069 --> 00:04:14,768
staying at the hotel here

45
00:04:14,769 --> 00:04:21,780
card you used to tap into your room that
the high-frequency access card resisted

46
00:04:21,779 --> 00:04:28,469
that temptation to still there in school
a lot of the schools at least in the

47
00:04:28,470 --> 00:04:33,760
states the stile have some type of
access card or some kind of access

48
00:04:33,760 --> 00:04:37,659
control to get into the building when
they have the doors locked during the

49
00:04:37,659 --> 00:04:43,820
day as I have children that's a personal
interest to me because if they're

50
00:04:43,820 --> 00:04:48,650
running a vulnerable system I would like
to help them fix that so my children are

51
00:04:48,650 --> 00:04:55,690
safer in school so what exactly is a
physical access system so for the

52
00:04:55,690 --> 00:04:59,840
longest time when I was first starting
out using these an interesting to me

53
00:04:59,840 --> 00:05:05,280
that meant card and card reader and that
was really all that I had looked at in

54
00:05:05,280 --> 00:05:08,849
the past but there's there's a whole lot
of other infrastructure that supports

55
00:05:08,849 --> 00:05:15,479
that basically it's a group of
components that will control access to a

56
00:05:15,479 --> 00:05:20,210
certain area we're gonna stop them

57
00:05:20,210 --> 00:05:25,539
happy little obvious I'm gonna be a
little bit new the control point

58
00:05:25,539 --> 00:05:30,770
probably a pretty good one to start so
this is usually where you have to

59
00:05:30,770 --> 00:05:36,250
present a credentials of this could be
something like a door or gate men

60
00:05:36,250 --> 00:05:42,259
trapped in a few of those around here at
the train station when you put your car

61
00:05:42,259 --> 00:05:47,349
down to have your card or card so that
the the turnstile opens that that they

62
00:05:47,349 --> 00:05:51,719
access control one little thing that
you're tapping your card to call the

63
00:05:51,720 --> 00:05:57,190
reader pretty obvious they're the card
is usually a physical access referred to

64
00:05:57,190 --> 00:06:00,820
you as a critical so it doesn't
necessarily have to be a card

65
00:06:00,820 --> 00:06:08,780
credentials look like this little tax
people could put on their key chains we

66
00:06:08,780 --> 00:06:15,270
have a lot of those in office buildings
in the states have different sweeps of

67
00:06:15,270 --> 00:06:19,650
different folks a lot of times though
use those tags a because they're cheap

68
00:06:19,650 --> 00:06:24,539
Mb because they're very easy to set up
and fortunately they're also very

69
00:06:24,539 --> 00:06:32,280
vulnerable which will get into the
access card if you've got two main

70
00:06:32,280 --> 00:06:37,388
varieties we've got low frequency and
we've got high frequency the

71
00:06:37,389 --> 00:06:44,409
low-frequency there they operate at $125
hurts and it just hope the small amount

72
00:06:44,409 --> 00:06:48,810
of data on there that's why you see
these ones used a lot in the lower end

73
00:06:48,810 --> 00:06:52,840
systems most of the key fobs and tags
that you have are gonna be a

74
00:06:52,840 --> 00:06:57,758
low-frequency occasionally there are
some high frequency ones but for the

75
00:06:57,759 --> 00:07:02,070
most part those are gonna be low
frequency tags there

76
00:07:02,070 --> 00:07:08,330
unencrypted whatever is on there is
there for the taking your easyLink card

77
00:07:08,330 --> 00:07:14,389
is is not low-frequency by the way train
fares for today anyway

78
00:07:14,389 --> 00:07:21,580
hyper good cigars so these lines are
more of the wave of the future yes they

79
00:07:21,580 --> 00:07:27,580
operate at 13.5 six megahertz and the
reason this is so that we can put more

80
00:07:27,580 --> 00:07:30,700
data into the way of so

81
00:07:30,700 --> 00:07:37,120
a low-frequency card and you present
that the reader to be basically means

82
00:07:37,120 --> 00:07:43,660
that it is reddit but then there's that
delay you'll get between when the reader

83
00:07:43,660 --> 00:07:49,200
beauty and the turnstile opens so for
the low-frequency cards because they are

84
00:07:49,200 --> 00:07:54,430
so slow it doesn't send a lot of data so
we wanted to send more data you would be

85
00:07:54,430 --> 00:07:59,060
standing there for five ten fifteen
seconds and in high volume environment

86
00:07:59,060 --> 00:08:04,190
so that's just not acceptable so that's
why we're starting to switch more to the

87
00:08:04,190 --> 00:08:10,340
high-frequency card so the one down here
on the bottom get my laser pointer out

88
00:08:10,340 --> 00:08:17,640
here this car here this is actually hard
so inside of the skirt you got your your

89
00:08:17,640 --> 00:08:22,570
chips here and here is where the data
lives on the card that little piece of

90
00:08:22,570 --> 00:08:28,440
data that we're going to use our
credential so the outside and I hear

91
00:08:28,440 --> 00:08:37,860
their butts are high frequency antenna
so usually have a high frequency lets

92
00:08:37,860 --> 00:08:42,900
you but sometimes they do have both for
environment where they're trying to

93
00:08:42,900 --> 00:08:50,860
gravitate away from the low-frequency so
basically what happens is when we put

94
00:08:50,860 --> 00:08:56,480
this up to the reader the Reader will
power the little chip inside and it will

95
00:08:56,480 --> 00:09:02,040
broadcast our data to the reader so the
low-frequency car it's kind of like

96
00:09:02,040 --> 00:09:07,240
children they just shout out their
information over and over again the low

97
00:09:07,240 --> 00:09:14,130
frequency is always high on billy hi I'm
Billy it's not capable of interacting in

98
00:09:14,130 --> 00:09:21,400
any other way closer why these are used
in lower insistence that the

99
00:09:21,400 --> 00:09:27,490
high-frequency cards they're capable of
two-way interaction so that's why you'll

100
00:09:27,490 --> 00:09:29,570
see a lot of these used

101
00:09:29,570 --> 00:09:34,270
and the airport for instance highly
controlled areas where they they want a

102
00:09:34,270 --> 00:09:40,670
little bit of extra security there will
also touch on that a little bit later

103
00:09:40,670 --> 00:09:49,990
baylon how that works with little visual
to gonna go along with that is basically

104
00:09:49,990 --> 00:09:54,700
what happens when we present our card to
the reader will notice that I've got

105
00:09:54,700 --> 00:09:58,670
these two numbers of years so in
physical access on these cards we have

106
00:09:58,670 --> 00:10:03,410
few pieces of data we've got our
facility code and that's usually gonna

107
00:10:03,410 --> 00:10:07,780
be the same for every system and then
we've got her card number so this is

108
00:10:07,780 --> 00:10:14,120
what will be unique to the cardholder as
you can see in the low-frequency we go

109
00:10:14,120 --> 00:10:19,890
pretty slow so we don't want folks
standing there for a long time that's

110
00:10:19,890 --> 00:10:25,439
why it only transmit the facility code
on the card number of high frequency as

111
00:10:25,440 --> 00:10:29,290
you can see we've got to get a lot of
extra here so they've added some

112
00:10:29,290 --> 00:10:37,380
encryption to this it's not very good
encryption but it is nonetheless when

113
00:10:37,380 --> 00:10:43,410
the reader actually the card reader does
not make any decisions it's basically

114
00:10:43,410 --> 00:10:48,420
just a repeater though it will read the
data and just spit it out on the other

115
00:10:48,420 --> 00:10:54,110
side to the access control panel so from
the reader to the access control panel

116
00:10:54,110 --> 00:11:01,270
that is actually copper wire not the
reason for this being the systems they

117
00:11:01,270 --> 00:11:07,460
can't tolerate network latency because
if they have a delay getting back and

118
00:11:07,460 --> 00:11:10,140
forth to the server then you've got
people standing there

119
00:11:10,140 --> 00:11:14,300
tapping their card over and over again
waiting to get into the building so

120
00:11:14,300 --> 00:11:20,550
currently there is used copper wire for
that reason for the access control panel

121
00:11:20,550 --> 00:11:26,160
it's just a small bore dorothea a photo
of it here in a few minutes not very

122
00:11:26,160 --> 00:11:32,410
intelligent it has a few basic jobs its
biggest job is to translate so it will

123
00:11:32,410 --> 00:11:38,959
decode the data and it will read the
data for the facility go to the card

124
00:11:38,960 --> 00:11:40,300
number and comparative

125
00:11:40,300 --> 00:11:45,579
access let us know if you noticed down
here the numbers that I have on the

126
00:11:45,580 --> 00:11:48,890
chips in the card here

127
00:11:48,890 --> 00:11:55,600
the facility code on the card number or
kind of spaced out I D people would

128
00:11:55,600 --> 00:12:00,160
think that this is a security feature
but in the physical security world this

129
00:12:00,160 --> 00:12:05,319
is only custom formatting for the you
don't buy heard from anybody else this

130
00:12:05,320 --> 00:12:11,440
is a primary example of security through
obscurity right now they just want to

131
00:12:11,440 --> 00:12:16,480
try to lock you into being able to only
buy from them and we're going to see a

132
00:12:16,480 --> 00:12:22,030
lot of that in the next slide the
physical access world is very behind I T

133
00:12:22,030 --> 00:12:26,990
and that's so we've got these little
control boards that are making all of

134
00:12:26,990 --> 00:12:31,690
this it all of the decisions they do
have a mother ship the access control

135
00:12:31,690 --> 00:12:36,840
server that's why everybody will
maintain the list of all the card

136
00:12:36,840 --> 00:12:42,540
numbers and the groups and who's allowed
to to go where normally windows I have

137
00:12:42,540 --> 00:12:48,719
not in my experience you know you know
on Windows access control server I

138
00:12:48,720 --> 00:12:53,850
highly doubt that they're out there look
at some of the other things that are in

139
00:12:53,850 --> 00:12:59,980
her though this is kind of cool the card
format details live in the server that's

140
00:12:59,980 --> 00:13:03,480
going to be important when we get to
some of the other it taxes 22 why that

141
00:13:03,480 --> 00:13:09,530
that's cool then we got our door
components so after the controller read

142
00:13:09,530 --> 00:13:14,420
the card number compare that to the
access list and yes this card numbers

143
00:13:14,420 --> 00:13:22,319
active and it is allowed to open this
door it will send the signal to the door

144
00:13:22,320 --> 00:13:27,220
contact the door contractors Bora mag
lock doors the ones with the magnets

145
00:13:27,220 --> 00:13:35,640
have a good one that the hotel rooms
have them but I know everybody staying

146
00:13:35,640 --> 00:13:41,670
at the hotel probably using the school's
you swipe the card you wait you can't

147
00:13:41,670 --> 00:13:45,170
act you usually don't hear that click
very much

148
00:13:45,170 --> 00:13:50,800
and it releases the magnet so that you
can open the door electric straight is

149
00:13:50,800 --> 00:13:58,510
just a camper device that will send back
to the control server whether the door

150
00:13:58,510 --> 00:14:04,120
is open or closed so if the door is not
closed but it should be that will set an

151
00:14:04,120 --> 00:14:10,440
alarm for somebody to go and look but
normally they don't and then we've got a

152
00:14:10,440 --> 00:14:14,350
request for the invite at the door

153
00:14:14,350 --> 00:14:18,500
the inside of the door when you're ready
to leave the control area sometimes at

154
00:14:18,500 --> 00:14:23,160
the motion sensor that will release the
magnetic lock sometimes but the button

155
00:14:23,160 --> 00:14:28,240
sometimes used to scan your card to get
out a lot of good example for all of

156
00:14:28,240 --> 00:14:34,350
that even in the train station at the
request to exit when you swipe your card

157
00:14:34,350 --> 00:14:42,760
on the way out if we put that into a
more of a graphical representation is

158
00:14:42,760 --> 00:14:48,540
basically our flow so the weekend
protocol is the protocol that the

159
00:14:48,540 --> 00:14:56,019
controller understand and it's basically
just like a modified binary very very

160
00:14:56,019 --> 00:14:59,420
basic documentation up there if you're
interested

161
00:14:59,420 --> 00:15:05,800
it's it's not too hard to pick up so
that the language in the protocol that

162
00:15:05,800 --> 00:15:10,689
is using to talk back and forth but
again that's that's happening on copper

163
00:15:10,690 --> 00:15:20,579
so if we were to networks therefore by
we're not gonna see this traffic here we

164
00:15:20,579 --> 00:15:26,029
will see some of this traffic where the
controller talks to the mothership but

165
00:15:26,029 --> 00:15:31,130
this only happens a couple of times a
day does not happen very often so this

166
00:15:31,130 --> 00:15:36,160
tiny little circuit board here is really
what's making all of our decisions for

167
00:15:36,160 --> 00:15:41,199
us during the day as to who was allowed
to enter or exit certain areas of

168
00:15:41,199 --> 00:15:49,209
certain time so very rarely will be used
to talk to each other when we saw the

169
00:15:49,209 --> 00:15:55,880
reader just a repeater whatever it
reopened it out to the controller the

170
00:15:55,880 --> 00:15:57,270
controller is very important

171
00:15:57,270 --> 00:16:03,829
often forgotten I here's a diagram
because I help illustrate a little bit

172
00:16:03,830 --> 00:16:04,640
better

173
00:16:04,640 --> 00:16:08,510
the door contacts are you look at the
top here have another picture later on

174
00:16:08,510 --> 00:16:14,180
we'll make it a little easier for you to
tell which ones are my Glocks and which

175
00:16:14,180 --> 00:16:21,290
ones are strictly is here or reader and
then not all doors have a request to

176
00:16:21,290 --> 00:16:28,810
exit do not depend on the way that the
environment setup each of these

177
00:16:28,810 --> 00:16:37,880
controllers can handle between 10 and 16
never take exit points doors

178
00:16:37,880 --> 00:16:43,100
elevators so in larger environment
you're gonna find that these are two

179
00:16:43,100 --> 00:16:48,550
years and they're structured a lot of my
client floor of the building will have

180
00:16:48,550 --> 00:16:53,800
its own controller though there are lots
of little controllers out there that are

181
00:16:53,800 --> 00:16:59,990
making the decisions for us and some of
your more mature implementations we have

182
00:16:59,990 --> 00:17:05,660
the main control panel and the main
control panel is the only one that talks

183
00:17:05,660 --> 00:17:12,180
to the talks to our access control
server so we were again looking at

184
00:17:12,180 --> 00:17:16,450
network traffic we wouldn't really see
these guys talking to anybody because

185
00:17:16,450 --> 00:17:22,870
they speak to each other and the main
controller panel on copper kind of

186
00:17:22,869 --> 00:17:26,739
important to understand because as I T
people we automatically think you fear

187
00:17:26,740 --> 00:17:31,460
not we can capture that data one way or
another so that will make a big

188
00:17:31,460 --> 00:17:39,049
difference in the kind of attacks that
we can do

189
00:17:39,049 --> 00:17:44,759
personality of security and this one is
one of the biggest reasons why we have

190
00:17:44,759 --> 00:17:49,820
trouble in the physical access world
security and computer security are

191
00:17:49,820 --> 00:17:54,269
responsible for the same thing we're
both supposed to be protecting the data

192
00:17:54,269 --> 00:18:00,139
that lives in the servers in our
environment but the physical fight is

193
00:18:00,139 --> 00:18:05,879
undervalued so if you tell somebody of
the work in cybersecurity usually you

194
00:18:05,879 --> 00:18:12,070
get the computers and stuff but if you
tell somebody that you were gonna

195
00:18:12,070 --> 00:18:18,330
physical security you kind of get the oh
well you get a better job someday I mean

196
00:18:18,330 --> 00:18:25,259
that's just temporary rate but again
we're protecting the same thing so don't

197
00:18:25,259 --> 00:18:30,259
need some culture shift here the
controls are designed very differently

198
00:18:30,259 --> 00:18:32,470
in the physical access world as well

199
00:18:32,470 --> 00:18:36,129
the controls are pretty much just
designed and implemented by an

200
00:18:36,129 --> 00:18:43,748
electrical contractor or a vendor and
that's it there's no security steps

201
00:18:43,749 --> 00:18:54,590
involved there but the more that we rely
on these intelligence systems to

202
00:18:54,590 --> 00:18:59,619
maintain and control access to more of
we need the network and the components

203
00:18:59,619 --> 00:19:05,119
to be secure but nobody really thought
about that yet so the physical access

204
00:19:05,119 --> 00:19:09,600
world is really really about 15 years
behind I T

205
00:19:09,600 --> 00:19:16,299
if you think about the way security was
nineteen nineties early 2014 different

206
00:19:16,299 --> 00:19:20,929
than what it is today right you know
there there is no maturity model for

207
00:19:20,929 --> 00:19:28,399
these guys there aren't really
responsible disclosure programs for

208
00:19:28,399 --> 00:19:34,119
physical security vendors if they find a
vulnerability most of the time it is not

209
00:19:34,119 --> 00:19:39,369
reported when you start looking at the
V's you'll notice that there's not

210
00:19:39,369 --> 00:19:45,629
really a lot of information on physical
access vendors and they're very reliant

211
00:19:45,629 --> 00:19:50,149
on my team but they don't understand I T
and that's really where we start to have

212
00:19:50,149 --> 00:19:51,360
a big problem

213
00:19:51,360 --> 00:19:55,459
especially with the new systems

214
00:19:55,460 --> 00:20:02,360
the newer systems when they install the
physical access control server and

215
00:20:02,360 --> 00:20:11,340
they'll put be control panel then the
control panels the new ones can talk

216
00:20:11,340 --> 00:20:16,520
tcp/ip if you put them on the network
they still make a lot of their decisions

217
00:20:16,520 --> 00:20:20,460
that a lot of their communication is
still copper they decided to move a lot

218
00:20:20,460 --> 00:20:25,059
of that to do CPR I P just for
monitoring purposes so it's more of

219
00:20:25,059 --> 00:20:31,520
their for your health and configuration
purposes not for actual operation that

220
00:20:31,520 --> 00:20:35,690
sounds all well and good except when we
look at the architecture and we look at

221
00:20:35,690 --> 00:20:40,820
how it installed the physical security
people will say hey we need these hooked

222
00:20:40,820 --> 00:20:45,590
up to the network and we need one of
those things because we understand that

223
00:20:45,590 --> 00:20:54,449
that's that's cure but that's what we
want network problem I got you here

224
00:20:54,450 --> 00:20:59,000
addresses will put all your stuff up
make sure that it works in your good to

225
00:20:59,000 --> 00:21:05,360
go under comes in pills firewall guy we
need these six ports open so that this

226
00:21:05,360 --> 00:21:11,360
can communicate and once everything
works it's forgotten but what's

227
00:21:11,360 --> 00:21:16,590
important is that because they didn't
involve anybody insecurity is usually

228
00:21:16,590 --> 00:21:21,409
routable to everywhere so there's
there's really no point in having the

229
00:21:21,410 --> 00:21:25,210
feeling because it's not doing its job
but the physical access people don't

230
00:21:25,210 --> 00:21:30,700
know that because they don't understand
I D and the cyber security people are

231
00:21:30,700 --> 00:21:37,250
involved in the network I did my job you
said you wanted to feelin so we're gonna

232
00:21:37,250 --> 00:21:42,580
see a lot of things like that throughout
the presentation to small little mishaps

233
00:21:42,580 --> 00:21:51,980
things that we and I D did a long time
ago though because this is so reliant we

234
00:21:51,980 --> 00:21:55,780
put a lot of trust in the vendors on the
physical access side there's not a lot

235
00:21:55,780 --> 00:21:58,290
of evaluation that happens

236
00:21:58,290 --> 00:22:02,030
and it had a global is one of the
largest vendors out there for physical

237
00:22:02,030 --> 00:22:09,570
access I'm sure that you've seen their
readers around their kind of everywhere

238
00:22:09,570 --> 00:22:14,800
obvious I'm not but they decided that
when they started to go to high

239
00:22:14,800 --> 00:22:19,629
frequency that they would encrypt things
but again before physical access people

240
00:22:19,630 --> 00:22:23,050
they don't understand the same
principles that we do and I T so they

241
00:22:23,050 --> 00:22:30,870
decided that they were going to encrypt
everything and they did so with the same

242
00:22:30,870 --> 00:22:37,459
all of the standard security eyebrows
around the world has the same private

243
00:22:37,460 --> 00:22:44,120
key and their thought was well nobody
would be able to figure out what it was

244
00:22:44,120 --> 00:22:50,370
Tripathi almost five years ago now there
was a presentation by a group of

245
00:22:50,370 --> 00:22:54,469
researchers basically extracted the
private key from one of these readers

246
00:22:54,470 --> 00:23:02,900
and tested it and they can reproduce use
encrypted I + card using that key though

247
00:23:02,900 --> 00:23:08,740
this was a big problem but hid again
because they don't have responsible

248
00:23:08,740 --> 00:23:13,260
disclosure in the same things that we
have on the ID's ID just basically kind

249
00:23:13,260 --> 00:23:18,320
of brushed it off and they said well you
know a few people that do that there's

250
00:23:18,320 --> 00:23:23,480
not really a threat there was some of
the problems that we have at one of the

251
00:23:23,480 --> 00:23:28,620
Paramount problems and physical access
now we've got all these systems and this

252
00:23:28,620 --> 00:23:32,739
is the latest and greatest and physical
access out there with the same private

253
00:23:32,740 --> 00:23:38,710
key everywhere this is important because
it's gonna be able to enable us to

254
00:23:38,710 --> 00:23:44,420
reduce our own wounds of the card
because we have the key physical

255
00:23:44,420 --> 00:23:50,580
security culture is also a problem you
know and I feel we're very used to the

256
00:23:50,580 --> 00:23:56,919
break fix update it kind of environment
Tuesday and all of that stuff

257
00:23:56,920 --> 00:24:02,380
patches and whatnot on the physical side
once that system is installed everybody

258
00:24:02,380 --> 00:24:03,480
forgets about it

259
00:24:03,480 --> 00:24:08,460
the server Group maintains the Windows
Server for access control they make sure

260
00:24:08,460 --> 00:24:09,600
that it's up

261
00:24:09,600 --> 00:24:13,879
and that it gets patched but aside from
that nobody's really looking at this

262
00:24:13,880 --> 00:24:17,309
offer that's installed in what's
happening there

263
00:24:17,309 --> 00:24:22,789
the lack of technical understanding we
discussed earlier just kind of adds to

264
00:24:22,789 --> 00:24:26,950
the problem because the physical
security people don't know to ask the

265
00:24:26,950 --> 00:24:31,289
right questions they don't do not know
what those questions are there also very

266
00:24:31,289 --> 00:24:37,230
vendor loyal so when we exploited the
psych class vulnerability recently on a

267
00:24:37,230 --> 00:24:42,620
plantation road although this is how we
did it this is what happened this is why

268
00:24:42,620 --> 00:24:46,428
we were able to do this year's hear the
things that you can do to kind of help

269
00:24:46,429 --> 00:24:52,960
offset this risk they took it to the
vendor who you can actually buy from a

270
00:24:52,960 --> 00:24:57,710
droid 2 global direct you have to buy
for you know a contractor they they took

271
00:24:57,710 --> 00:25:02,500
the report to the vendor in the vendor
said well that's not really true it

272
00:25:02,500 --> 00:25:08,530
doesn't work that way and that was good
enough for them all the bender said that

273
00:25:08,530 --> 00:25:13,720
that's not a problem and we went to a
steak dinner was good there they're very

274
00:25:13,720 --> 00:25:17,490
loyal to their vendors so they don't
quite understand the whole independent

275
00:25:17,490 --> 00:25:23,520
security researcher yet hopefully we can
change that but let's look at some of

276
00:25:23,520 --> 00:25:28,090
the attack services gotta love the cool
things that we can do here to know what

277
00:25:28,090 --> 00:25:31,760
we understand all of the pieces we can
start to look at how they fit together

278
00:25:31,760 --> 00:25:38,280
in ways that we can attack them so I
want to focus just on access cards here

279
00:25:38,280 --> 00:25:43,620
but I do think it's important to at
least review some of the attacks that

280
00:25:43,620 --> 00:25:47,260
are out there so if you want to read
more about it I've got some reference

281
00:25:47,260 --> 00:25:53,929
links in here that you can go check it
out earlier days of access card attacks

282
00:25:53,929 --> 00:25:58,090
we had the property market three the
proximate free for those of you who may

283
00:25:58,090 --> 00:26:05,959
not be familiar RFID research tool we
use it for research we would never use

284
00:26:05,960 --> 00:26:11,840
it for malicious purposes over the
problem with the Prophet mark while that

285
00:26:11,840 --> 00:26:19,260
looks very small it's about the size of
your hand but it needs an antenna

286
00:26:19,260 --> 00:26:24,260
power supply to the antenna for
low-frequency kurt is about the size of

287
00:26:24,260 --> 00:26:30,580
a CD so then you would in turn up the
cable approximate and then I am normally

288
00:26:30,580 --> 00:26:35,179
used like a cell phone battery pack like
a small juice pack it doesn't need very

289
00:26:35,180 --> 00:26:39,850
much power you got all these things and
you're supposed to be able to carry them

290
00:26:39,850 --> 00:26:44,179
and be able to get close to somebody to
record their their card data without

291
00:26:44,180 --> 00:26:49,800
being noticed and the read range on the
park mercury was just a few centimetres

292
00:26:49,800 --> 00:26:53,300
it's very hard to get this close to
somebody's access card without making it

293
00:26:53,300 --> 00:26:59,840
very awkward so we looked at some
different ways to disguise it was my

294
00:26:59,840 --> 00:27:05,209
RFID binder of Douma I like to call it I
just took a regular binder from the

295
00:27:05,210 --> 00:27:10,250
office supply store and could open the
back part of it so that we could conceal

296
00:27:10,250 --> 00:27:14,190
everything inside so even if somebody
were to pick this up and just physically

297
00:27:14,190 --> 00:27:20,110
examine it would look just like a
regular binder so you gotta work for you

298
00:27:20,110 --> 00:27:25,840
at the bottom and then my little juice
pack on the site and then I got the

299
00:27:25,840 --> 00:27:31,139
internet here on the other side so you
can see definitely the size of a CD that

300
00:27:31,140 --> 00:27:35,170
made it a lot more portable so when I
was walking and I needed to get close to

301
00:27:35,170 --> 00:27:39,480
somebody and I could kind of bump them
with it the problem with a binder was

302
00:27:39,480 --> 00:27:45,120
leather was preventing the card from
getting power because the prop mark

303
00:27:45,120 --> 00:27:49,620
doesn't output a lot of power device
it's not meant to be used in the field

304
00:27:49,620 --> 00:27:56,209
with these cables here came loose a lot
and it would lose all of its data if the

305
00:27:56,210 --> 00:28:03,470
cable came loose it was not very field
friendly we did start to use the grid it

306
00:28:03,470 --> 00:28:07,130
if you have not used to get it before
it's designed to hold all of your little

307
00:28:07,130 --> 00:28:12,250
other than and all together in your bag
it's perfect for the box marked because

308
00:28:12,250 --> 00:28:16,210
it hold everything in place so nothing
is shifting around so we didn't have the

309
00:28:16,210 --> 00:28:21,210
problem with the cables coming undone
you put the antenna right on the corner

310
00:28:21,210 --> 00:28:24,960
you put this whole thing inside of a
laptop sleeve and then you can be a lot

311
00:28:24,960 --> 00:28:26,010
more mobile and

312
00:28:26,010 --> 00:28:31,110
gonna swing it as you're walking and you
know how to get close to somebody

313
00:28:31,110 --> 00:28:36,030
accidentally typed them with it and
that's ok I got a lot to read that

314
00:28:36,030 --> 00:28:42,300
Starbucks in the morning with but again
you're still limited to just a few

315
00:28:42,300 --> 00:28:50,280
centimetres pretty awkward years ago the
folks at Fox really started to take some

316
00:28:50,280 --> 00:28:54,970
steps to help us with that for now I
have some cool long range readers that

317
00:28:54,970 --> 00:29:00,960
basically take a working access card
reader and modified so that we can

318
00:29:00,960 --> 00:29:13,350
record the data it's about one foot
square about an inch or so not portable

319
00:29:13,350 --> 00:29:17,889
you can put it in a messenger bag or a
small backpack or a big lady bag usually

320
00:29:17,890 --> 00:29:23,990
use the big lady bag and walk around and
get your good stuff you can use it for a

321
00:29:23,990 --> 00:29:28,450
few different technologies but you have
to buy a different reader for each one

322
00:29:28,450 --> 00:29:34,220
of these so the readers there about five
or six hundred dollars each

323
00:29:34,220 --> 00:29:40,770
gets expensive so normally we just have
one per team of everybody having their

324
00:29:40,770 --> 00:29:47,360
own it doesn't quite understand custom
card formats though so if you have a

325
00:29:47,360 --> 00:29:51,540
client who uses a different card format
for one reason or another

326
00:29:51,540 --> 00:29:57,030
probably because that's what the vendors
sold them because it's secure sometimes

327
00:29:57,030 --> 00:30:01,129
it confuses the long range reader ninety
percent of the time it does the job

328
00:30:01,130 --> 00:30:05,510
though so basically takes the the
weekend up but that we discussed earlier

329
00:30:05,510 --> 00:30:11,060
from the reader through here in our
little PCB Ward writes all of the

330
00:30:11,060 --> 00:30:17,679
contents to the microSD into a flat tax
file and it was just reading recorded

331
00:30:17,680 --> 00:30:25,290
read and record the bishop box design
used a lot of double A batteries and

332
00:30:25,290 --> 00:30:28,290
this would only power it for a few hours

333
00:30:28,290 --> 00:30:33,889
and then the batteries would would I got
pretty expensive kind of annoying

334
00:30:33,890 --> 00:30:40,150
because a lot of batteries to change all
the time but it but it did the job

335
00:30:40,150 --> 00:30:45,550
instead of having to worry about
juggling approximate query if we walked

336
00:30:45,550 --> 00:30:51,230
around at lunch time we would have a
really nice output file that had the bit

337
00:30:51,230 --> 00:30:57,740
kind of the card its value would
facilitate code was the card number and

338
00:30:57,740 --> 00:31:01,200
then if you want the bond areas there
but this is all the information that it

339
00:31:01,200 --> 00:31:07,640
had been coated from the binary lot of
time right now I have the two pieces of

340
00:31:07,640 --> 00:31:12,260
information that I need I can use the
property market my hotel room to write

341
00:31:12,260 --> 00:31:16,750
the card the copies of the cards so
there's a lot of time a lot of effort

342
00:31:16,750 --> 00:31:24,020
the read range on this is about three
feed so that's a pretty far you can get

343
00:31:24,020 --> 00:31:28,639
a lot of courtroom without getting all
awkward it was worth every last penny

344
00:31:28,640 --> 00:31:34,890
that I spent on this with other folks
decided to take that design and run with

345
00:31:34,890 --> 00:31:35,320
it

346
00:31:35,320 --> 00:31:40,399
to try to improve it a little bit and
they started using a lot of

347
00:31:40,400 --> 00:31:47,510
the New Order No pieces so does the same
thing basically they just don't mount it

348
00:31:47,510 --> 00:31:52,879
this is a low frequency reader that
they're showing here so you can actually

349
00:31:52,880 --> 00:31:57,680
fit everything inside of it and put its
cover back on except for the battery

350
00:31:57,680 --> 00:32:02,800
there on the outside though the battery
pack replaces the 12 double A batteries

351
00:32:02,800 --> 00:32:07,830
that you're always having to change if
you're interested in making one of these

352
00:32:07,830 --> 00:32:13,860
for your so I recommend this power bank
is what are used in ours it's good to

353
00:32:13,860 --> 00:32:19,669
have a 12 volt output them and that will
power the device for six-plus hours and

354
00:32:19,670 --> 00:32:24,010
really the reader is so good you don't
really need six plus hours to get what

355
00:32:24,010 --> 00:32:32,050
you're out there are some rfid-based
attacks but again this is kind of behind

356
00:32:32,050 --> 00:32:36,790
the curve on a lot of a low-tech

357
00:32:36,790 --> 00:32:43,510
actually put the card number on most of
the cards writing your password on your

358
00:32:43,510 --> 00:32:49,180
bed and leaving it there and ever
changing it so that's that's kind of

359
00:32:49,180 --> 00:32:53,910
interesting so this opens up a lot of
different avenues for social engineering

360
00:32:53,910 --> 00:32:59,050
sometimes we just do phone calls and
impersonate security employees and get

361
00:32:59,050 --> 00:33:03,220
the employee to read at the numbers off
of the back of the numbers on the back

362
00:33:03,220 --> 00:33:04,390
here

363
00:33:04,390 --> 00:33:08,850
smaller five digit one here this is the
card number this year as the order

364
00:33:08,850 --> 00:33:13,379
tracking number so this is so they're
they're supplier can look up their card

365
00:33:13,380 --> 00:33:19,140
information in case they need to know
what what to order so you really want to

366
00:33:19,140 --> 00:33:24,670
do some social engineering on the vendor
you can try but I haven't had too

367
00:33:24,670 --> 00:33:29,980
there's always an easier way but this
only gets us 50% of the way we only have

368
00:33:29,980 --> 00:33:35,220
a card number you don't have the
facility kudiye but that's ok because

369
00:33:35,220 --> 00:33:42,840
they also printed on the label that goes
on the Bucs why I'm not exactly sure you

370
00:33:42,840 --> 00:33:47,990
can buy these on ebay and other social
engineering opportunity that we like to

371
00:33:47,990 --> 00:33:48,280
you

372
00:33:48,280 --> 00:33:54,629
we find out their supplier for their
access cards and call and ask them you

373
00:33:54,630 --> 00:33:58,650
know what the next train do that they
need based on the left range

374
00:33:58,650 --> 00:34:04,800
verify their information so we found a
lot of social engineering attacks it's

375
00:34:04,800 --> 00:34:10,000
much easier to provide misinformation to
get your target to correct you instead

376
00:34:10,000 --> 00:34:17,870
of just flat out asking if I tell them
I'm working on your your next order I

377
00:34:17,870 --> 00:34:21,839
have her number three thousand one
hundred and fifty-five last year

378
00:34:21,840 --> 00:34:27,350
sequence with facility 12 and I know the
12 isn't right

379
00:34:27,350 --> 00:34:34,759
usually they'll just correct me oh no
it's not 12 its 122 they left I left and

380
00:34:34,760 --> 00:34:40,970
you know I thank them and wish them a
good day so then we have both pieces and

381
00:34:40,969 --> 00:34:45,739
we didn't need any equipment but the
phone that's kind of cool little cheaper

382
00:34:45,739 --> 00:34:53,279
that way about the reader very
intelligent but we can still tap into it

383
00:34:53,280 --> 00:34:58,770
if we would like to see this is a new
device that was showcased at blackhat

384
00:34:58,770 --> 00:35:05,009
this year I have one of these I have not
tried it myself

385
00:35:05,010 --> 00:35:12,160
small the folks that made our Canadian
compared to the Canadian going basically

386
00:35:12,160 --> 00:35:18,440
these very little base here you attached
to wires in the back of the reader

387
00:35:18,440 --> 00:35:23,090
through the readers are pretty easy to
pull off a wall and then you can install

388
00:35:23,090 --> 00:35:28,940
that little piece in the wall and it
will collect all of the information and

389
00:35:28,940 --> 00:35:33,080
send it to your phone via bluetooth you
get close enough so that you don't even

390
00:35:33,080 --> 00:35:37,730
have to worry about taking it out again
because that just increases your chance

391
00:35:37,730 --> 00:35:42,840
of being discovered it also saves them
all local in case you do want to

392
00:35:42,840 --> 00:35:44,010
retrieve it and

393
00:35:44,010 --> 00:35:51,400
for your your card off manually now it
also has a replay action so if i'm

394
00:35:51,400 --> 00:35:55,910
standing close by with my phone and
somebody comes and swipe their card that

395
00:35:55,910 --> 00:36:00,890
opens the door I can actually send a
replay command to the key to replay that

396
00:36:00,890 --> 00:36:05,950
same information to open the door for me
or for one of my coworkers and it looks

397
00:36:05,950 --> 00:36:12,149
like im texting on my phone so if you
want to check it out they have the

398
00:36:12,150 --> 00:36:17,080
presentation here in the hardware list
they did sell a few a black hat I think

399
00:36:17,080 --> 00:36:25,819
they were $20 so the very cheap solution
to being able to get in the software for

400
00:36:25,820 --> 00:36:27,000
your phone is free

401
00:36:27,000 --> 00:36:34,710
comes with a device required to exit
devices we talked about these just a

402
00:36:34,710 --> 00:36:39,880
little bit in the beginning and I'm sure
that everybody has seen these controlled

403
00:36:39,880 --> 00:36:44,330
areas thus it right above the doors and
usually when you start to approach them

404
00:36:44,330 --> 00:36:50,120
you'll hear a click click is it
releasing the magistrate

405
00:36:50,120 --> 00:36:56,819
actually releasing the door lock this is
cool because from the other side of the

406
00:36:56,820 --> 00:37:01,600
door we can start to use this to our
advantage especially in a door like this

407
00:37:01,600 --> 00:37:06,850
so I mentioned earlier that we were
going to point out one that had magnetic

408
00:37:06,850 --> 00:37:11,160
locks so this is where the magnetic
plate and the door so when it get the

409
00:37:11,160 --> 00:37:19,399
unlock signal it will signal the magnet
to release on the door door though

410
00:37:19,400 --> 00:37:25,920
physical security perspective one of
which is there's a really nice gap in

411
00:37:25,920 --> 00:37:32,060
between the door and a really nice gap
underneath we're going to use those to

412
00:37:32,060 --> 00:37:39,140
our advantage to trigger that requested
device and on a side note on the outside

413
00:37:39,140 --> 00:37:44,650
so if it doesn't work you can just take
the Doral go that way

414
00:37:44,650 --> 00:37:50,790
pretty easy you can just hit the bottom
with a hammer with him just pop off and

415
00:37:50,790 --> 00:37:55,750
you just kind of like the door off to
the side for our

416
00:37:55,750 --> 00:38:00,020
space in between and underneath of the
door if we want to signal the requested

417
00:38:00,020 --> 00:38:03,830
a device which is a very sophisticated
piece of equipment

418
00:38:03,830 --> 00:38:09,020
singer I like to use the one that says
we love our customers because it makes

419
00:38:09,020 --> 00:38:13,520
me smile when I see it in their report
I'm pretty sure they do not do the same

420
00:38:13,520 --> 00:38:17,650
humor but that's ok so basically we
won't do the coat hanger and we've all

421
00:38:17,650 --> 00:38:23,100
heard a little bit we make a little flag
and we slide could hire between both

422
00:38:23,100 --> 00:38:26,529
space and the doors and we just wave it
around enough to activate that request

423
00:38:26,530 --> 00:38:30,710
device and you'll know that it's
released because you'll hear a big chunk

424
00:38:30,710 --> 00:38:38,100
from the clip from where it's releasing
the door as you're out walking around in

425
00:38:38,100 --> 00:38:41,049
your daily life when you start to go
through doors I can turn out of the

426
00:38:41,050 --> 00:38:45,890
office or in and out of the mall just
start listening to be amazed at how many

427
00:38:45,890 --> 00:38:50,720
of these devices are around I put a
video clip in here I don't know if it

428
00:38:50,720 --> 00:38:54,450
will work or not this is how quickly you
can pop one of these doors open and it

429
00:38:54,450 --> 00:39:05,109
work so all he did was lie to hang up
and put it right against the request an

430
00:39:05,110 --> 00:39:07,210
apartment or three seconds

431
00:39:07,210 --> 00:39:14,370
top that works most of the time however
there are some folks that have adjusted

432
00:39:14,370 --> 00:39:20,009
read range of the device to be further
out from the door to prevent people like

433
00:39:20,010 --> 00:39:25,050
me from putting a coat hanger underneath
and waving it around so if you have

434
00:39:25,050 --> 00:39:29,320
another very sophisticated piece of
equipment that I use for that big

435
00:39:29,320 --> 00:39:34,410
balloons and the ones that you used to
make the animals because they're bigger

436
00:39:34,410 --> 00:39:39,910
you put it underneath the door to use a
hand pump to inflate it and you wait

437
00:39:39,910 --> 00:39:43,799
until it's just about ready to pop and
you let go and on the other side of the

438
00:39:43,800 --> 00:39:49,810
door the balloon goes like this and it
clicks and the door opens the only

439
00:39:49,810 --> 00:39:53,279
problem with this is when the door
doesn't open and you have a very large

440
00:39:53,280 --> 00:39:58,300
stack of balloons on the other side that
you can't get to a little bit awkward

441
00:39:58,300 --> 00:40:01,950
the next day with the client like I
don't know what you're cleaning crew was

442
00:40:01,950 --> 00:40:04,180
doing you should check on that

443
00:40:04,180 --> 00:40:12,910
that I don't know no clue man exit is is
cool a lot of these new systems have a

444
00:40:12,910 --> 00:40:19,520
lot of nice features I we had a client
that means doors and their data center

445
00:40:19,520 --> 00:40:23,230
they're very proud of these doors
they're basically work like the ones at

446
00:40:23,230 --> 00:40:28,910
the grocery store and we know why they
need to be stores but what they liked it

447
00:40:28,910 --> 00:40:32,069
so if they have their hands full they
could just kind of Swype and then the

448
00:40:32,069 --> 00:40:35,930
door was just automatically open for
them it did have a request

449
00:40:35,930 --> 00:40:41,040
exit enabled on it so they had to bed
and bad out you could account for the

450
00:40:41,040 --> 00:40:46,599
time that they were in the data center
but unfortunately sometimes things are

451
00:40:46,599 --> 00:40:55,309
very easily defeated just giving it a
shelf that was a pretty awkward moment

452
00:40:55,309 --> 00:41:02,420
230 didn't scan anything he just pushed
it open fire regulation in the states

453
00:41:02,420 --> 00:41:09,520
requires that the door be able to freely
open in case of a fire alarm there's a

454
00:41:09,520 --> 00:41:13,710
better way to implement it and it's not
look away so we did help them fix that

455
00:41:13,710 --> 00:41:22,630
they were not nearly as amused as we go
back to the control panel remember the

456
00:41:22,630 --> 00:41:27,420
earlier slide that have highlighting
that tiny little circuit board it's so

457
00:41:27,420 --> 00:41:31,180
important and nobody thinks about it
once it works anymore

458
00:41:31,180 --> 00:41:38,220
some of our environment that we go into
there are 10 to 20 and sometimes thirty

459
00:41:38,220 --> 00:41:43,549
of these devices in their environment
for all of the buildings so not just the

460
00:41:43,549 --> 00:41:49,049
campus that we're on it will also
control the building doors for you to

461
00:41:49,049 --> 00:41:50,890
other cities

462
00:41:50,890 --> 00:41:55,558
kinda cool that's always a fun demo if
we get into their system we can open the

463
00:41:55,559 --> 00:42:04,390
door in Michigan when we're sitting in
washington D C felony so the controllers

464
00:42:04,390 --> 00:42:09,270
because they have started putting the
connection on them for health monitoring

465
00:42:09,270 --> 00:42:10,990
reasons

466
00:42:10,990 --> 00:42:17,729
diagnostic reasons are reachable 99% of
the time from the general IP space back

467
00:42:17,730 --> 00:42:19,380
to that billion problem

468
00:42:19,380 --> 00:42:23,490
tiny thing tiny things that we have
learned over the years and I T that

469
00:42:23,490 --> 00:42:29,680
physical access has not so it's pretty
easy to find them once you understand

470
00:42:29,680 --> 00:42:34,500
what exactly it is that you're looking
for the very exciting when you get the

471
00:42:34,500 --> 00:42:39,970
scan results back though they're not
very intelligent they have tiny little

472
00:42:39,970 --> 00:42:45,669
web servers sometimes there's an FTP
server on their commanders have a

473
00:42:45,670 --> 00:42:51,640
centipede open i'm talking like
public-private strength I don't normally

474
00:42:51,640 --> 00:42:56,009
must without too much because it's
pretty easy to discern the device into a

475
00:42:56,010 --> 00:43:01,110
reboot loop and I don't want to change
their string so we just encourage them

476
00:43:01,110 --> 00:43:05,400
to disable that because they don't need
it I don't even know what US and then p

477
00:43:05,400 --> 00:43:12,790
is they don't need it enabled anonymous
FTP this one of my favorite you can just

478
00:43:12,790 --> 00:43:17,359
anonymous FTP to the device and start
looking around and most of the time when

479
00:43:17,359 --> 00:43:22,259
you do that you'll find passwords for
the controller and for some of the other

480
00:43:22,260 --> 00:43:25,890
systems like for the server will look at
one here in just a minute

481
00:43:25,890 --> 00:43:30,690
the devices again though they're very
their single board computers they don't

482
00:43:30,690 --> 00:43:35,380
even really have a full PCP IP stack I
don't think they're very fragile so

483
00:43:35,380 --> 00:43:43,480
talking like and sometimes cannot come
over so if you're going to look at some

484
00:43:43,480 --> 00:43:47,520
of the used to be kind and gentle with
it you can port scan it but slow down

485
00:43:47,520 --> 00:43:54,160
usually go see a web server that the
open on there and it will only work in

486
00:43:54,160 --> 00:43:58,940
Internet Explorer very often I endorse
Internet Explorer but this is one of the

487
00:43:58,940 --> 00:44:05,160
instances where you need it requires
firing up the windows via AIM to check

488
00:44:05,160 --> 00:44:11,109
it out but this is how their miss out on
a lot of pent house because when you run

489
00:44:11,109 --> 00:44:14,480
the script to take a screenshot of the
pages of the checking each web page in

490
00:44:14,480 --> 00:44:15,590
your results

491
00:44:15,590 --> 00:44:20,970
you just get a blank screen so that's
one way that you can tell pretty quickly

492
00:44:20,970 --> 00:44:26,000
that there's probably something more
here don't change the settings on their

493
00:44:26,000 --> 00:44:29,109
very fragile and they'll have to have
the vendor coming in and they may not be

494
00:44:29,109 --> 00:44:34,369
able to fix some of the controllers are
very expensive and the range of $10,000

495
00:44:34,369 --> 00:44:39,200
plus so we really don't want to break
those if you're gonna look for these on

496
00:44:39,200 --> 00:44:47,140
the network they have open like I
mentioned before a teepee for dat open

497
00:44:47,140 --> 00:44:56,040
usually telnet sometimes telnet yeah
9999 that's a big one and if you telnet

498
00:44:56,040 --> 00:45:01,550
9999 it would dump you into the
configuration menu doesn't ask you for a

499
00:45:01,550 --> 00:45:06,530
password it just assumed you belong
there and we'll just drop your right

500
00:45:06,530 --> 00:45:12,150
into where you need to be fantastic but
what can they tell us all remember what

501
00:45:12,150 --> 00:45:17,200
they hold their basically the bouncer at
the door right you're not on the list

502
00:45:17,200 --> 00:45:21,348
you can come in you're on the list you
can come in you're on the list but

503
00:45:21,349 --> 00:45:25,470
you're only allowed to come in between
eight and five during the day so you

504
00:45:25,470 --> 00:45:31,859
can't commit right now so they have a
lot of data that we could use wanted to

505
00:45:31,859 --> 00:45:37,299
make her own if we wanted to write a
card at that point so if I'm in a test

506
00:45:37,300 --> 00:45:41,500
where we don't compromise the physical
access server but we get access to some

507
00:45:41,500 --> 00:45:48,410
other used or controllers it's full of
bad numbers we can just make valid bed

508
00:45:48,410 --> 00:45:49,259
is all day long

509
00:45:49,260 --> 00:45:54,609
ok here's one of the sample
configurations from one of the

510
00:45:54,609 --> 00:46:00,880
intelligent controllers and other you
probably can't see that very well from

511
00:46:00,880 --> 00:46:07,859
the audience but it's got a loud Telnet
connections trust everybody because

512
00:46:07,859 --> 00:46:12,060
we're very trusting it

513
00:46:12,060 --> 00:46:17,609
configuration to a backup server every
day via FTP so the bottom here you'll

514
00:46:17,609 --> 00:46:23,750
see FTP login username is back up an FTP
password is blank know what was

515
00:46:23,750 --> 00:46:27,910
entertaining with this was that we were
able to use that to get into the access

516
00:46:27,910 --> 00:46:33,390
control server itself and pulled out all
the passwords from there

517
00:46:33,390 --> 00:46:38,540
under control their entire tournament
kind of a problem

518
00:46:38,540 --> 00:46:42,020
some of the more intelligent controllers
like I mentioned before they've got some

519
00:46:42,020 --> 00:46:48,259
stuff on there for diagnostic testing
and health monitoring very chatty web

520
00:46:48,260 --> 00:46:53,090
server helpful it doesn't require a
password you to sit on port 80 with

521
00:46:53,090 --> 00:46:59,390
Internet Explorer and it will tell you
whatever do you wanna know it so helpful

522
00:46:59,390 --> 00:47:04,259
that it will tell you that hey this is
my IP and these are all of my friends

523
00:47:04,260 --> 00:47:08,620
are all the devices that are around me
that I can see on the network but I can

524
00:47:08,620 --> 00:47:12,000
run diagnostics on as well

525
00:47:12,000 --> 00:47:18,460
ok it's also cool drop down menu here
that will take you as a shortcut to

526
00:47:18,460 --> 00:47:23,890
every controller that it knows about it
might have neighbors might have been

527
00:47:23,890 --> 00:47:27,950
neighbors if you happened to hit the
master controller had talked about

528
00:47:27,950 --> 00:47:34,120
earlier than you can see all of them
useful because you can start to use the

529
00:47:34,120 --> 00:47:38,170
youth to figure out there usually based
on their names where in the building at

530
00:47:38,170 --> 00:47:44,550
control I don't know I was going to do
something and opens like the data center

531
00:47:44,550 --> 00:47:53,280
or in our state environment control room
because I hate it when you do that it's

532
00:47:53,280 --> 00:47:56,710
very chatty also got a tiny little
database on it

533
00:47:56,710 --> 00:48:04,500
about all kinds of great stuff like
personnel and tracking and it's

534
00:48:04,500 --> 00:48:10,030
basically just its axis log here all of
the bands that I received the day the

535
00:48:10,030 --> 00:48:16,710
time the best number and what group they
belong to so now I can just make copies

536
00:48:16,710 --> 00:48:20,670
of all of these cards if I want we can
use a different access to kurd each time

537
00:48:20,670 --> 00:48:24,980
we want to go into the building will
make it very difficult for them to trace

538
00:48:24,980 --> 00:48:28,640
if they're paying attention which they
probably aren't because of the Bell

539
00:48:28,640 --> 00:48:32,740
about to find where it is coming from

540
00:48:32,740 --> 00:48:37,000
know if they figure out that the first
batch here

541
00:48:37,000 --> 00:48:43,400
is compromised and they deactivated mine
I've got five hundred more will just

542
00:48:43,400 --> 00:48:47,660
like all through their it makes it
difficult on the physical access side to

543
00:48:47,660 --> 00:48:54,109
understand what's happening there is
also a tall cold vertex will go out and

544
00:48:54,110 --> 00:48:57,940
help you look for some of the
controllers but this is specific to hID

545
00:48:57,940 --> 00:49:02,670
Global controllers so it's cool does a
lot of fun things but if your client is

546
00:49:02,670 --> 00:49:09,430
it using HIV controllers that's not
gonna help you know we've talked about

547
00:49:09,430 --> 00:49:13,950
everything but the mothership and our
mother ship in this case is usually a

548
00:49:13,950 --> 00:49:21,609
Windows server that has some software on
there pretty much all that it sometimes

549
00:49:21,610 --> 00:49:26,070
will be smaller and implementations they
will have their database locally on the

550
00:49:26,070 --> 00:49:31,440
box so not only will you have access to
the software that you can view and

551
00:49:31,440 --> 00:49:36,460
modify the access control groups you can
also doesn't want the database take it

552
00:49:36,460 --> 00:49:41,130
with you and look at it later in your
hotel room and then you have everybody's

553
00:49:41,130 --> 00:49:41,890
card number

554
00:49:41,890 --> 00:49:47,350
everybody's Access Group what card
format looks like and so on

555
00:49:47,350 --> 00:49:58,000
pretty useful things moving its usually
name something Indiana like which is the

556
00:49:58,000 --> 00:50:02,330
name of the software that they use for
access control little comments and

557
00:50:02,330 --> 00:50:06,620
things that give it away so sometimes
it's not nearly as hard to find as you

558
00:50:06,620 --> 00:50:12,259
might think the key word leaked of your
person through NASA's result area look

559
00:50:12,260 --> 00:50:16,940
at first and then maps are some of the
big ones life list in there for you you

560
00:50:16,940 --> 00:50:21,650
can look for the rest sometimes you
don't have to try to locate the network

561
00:50:21,650 --> 00:50:26,350
we all know showdown right just find it
on the internet

562
00:50:26,350 --> 00:50:29,830
why worry about trying to get internal
access somewhere if I can just get it

563
00:50:29,830 --> 00:50:35,920
from school I'm kinda lazy when it comes
to pen testing so if I can find

564
00:50:35,920 --> 00:50:40,190
something like this and not have to
worry about getting internal access and

565
00:50:40,190 --> 00:50:40,839
compromise

566
00:50:40,839 --> 00:50:46,009
another host and using it as a jump box
I won't because they don't need to so

567
00:50:46,009 --> 00:50:50,269
some of the key word that I've got here
though they're fun to search for injured

568
00:50:50,269 --> 00:50:58,640
in just be polite ok they're gonna have
a bad day eventually other resources so

569
00:50:58,640 --> 00:51:05,308
physical security people again they
don't think I see people their

570
00:51:05,309 --> 00:51:12,619
SharePoint site and email and whatnot
will be full card numbers

571
00:51:12,619 --> 00:51:18,499
card formats all the stuff that you need
so if for example you get access to one

572
00:51:18,499 --> 00:51:22,899
of the security officers account network
you can probably find all the

573
00:51:22,900 --> 00:51:27,170
information that you need to create
batters or login information for the

574
00:51:27,170 --> 00:51:32,479
actual physical access server somewhere
in Dearborn or somewhere other e-mail or

575
00:51:32,479 --> 00:51:36,499
a lot of their own how-to guides have
all the passwords in them because

576
00:51:36,499 --> 00:51:43,609
security guards are expected to remember
passwords I guess in the state security

577
00:51:43,609 --> 00:51:48,719
guards hang out with a weapon the front
door but remembering passwords as hard

578
00:51:48,719 --> 00:51:54,759
so they don't have to do that part never
quite understood their workstations are

579
00:51:54,759 --> 00:52:00,130
great targets to actually use one of
those recently at an engagement that I

580
00:52:00,130 --> 00:52:05,759
was on we had all their data at a time
from all the Recon the site I could tell

581
00:52:05,759 --> 00:52:09,569
that they were probably using iCloud
cards based on the readers

582
00:52:09,569 --> 00:52:13,910
the pictures of the readers that I got
from Google Street View already knew

583
00:52:13,910 --> 00:52:17,598
what equipment to pack which was great
because those readers or condo

584
00:52:17,599 --> 00:52:21,599
you know heavy and you gotta take all
three you then it's interesting at the

585
00:52:21,599 --> 00:52:26,619
airport in New basically what kind of
technology they were using because they

586
00:52:26,619 --> 00:52:29,590
were broadcasting photos of their
readers on the

587
00:52:29,590 --> 00:52:37,520
I haven't even left an hour to know what
I need to do we used whatever to finance

588
00:52:37,520 --> 00:52:44,500
company photos where people have left
their ID cards on for the picture so we

589
00:52:44,500 --> 00:52:49,960
have on these printers at the office
here you can buy these on ebay $100

590
00:52:49,960 --> 00:52:54,400
pretty good so this will basically just
print on top of the access card so you

591
00:52:54,400 --> 00:52:58,760
know there's none of this I don't do
this run to Kinkos thing and try to sell

592
00:52:58,760 --> 00:53:02,400
for laminated and get all the bubbles
out so that it looks like a good card

593
00:53:02,400 --> 00:53:09,260
anymore we just using free software and
design it and printed or so so will

594
00:53:09,260 --> 00:53:11,400
leave with a big step

595
00:53:11,400 --> 00:53:17,819
look like batters and then once we're
there will get the data and program 13

596
00:53:17,819 --> 00:53:23,770
runs were kinda hangin out we got some
good captures we got some good card data

597
00:53:23,770 --> 00:53:30,000
with a long range reader and we noticed
that one of the Securities stations in

598
00:53:30,000 --> 00:53:34,289
the visitor center four o'clock every
day they left it open like everybody

599
00:53:34,289 --> 00:53:38,260
went home at four o'clock the other
security solutions somebody was always

600
00:53:38,260 --> 00:53:45,730
out but this one was always be from 4
p.m. to 7 a.m. the next day we use one

601
00:53:45,730 --> 00:53:56,240
of our cards that we looked at the day
of or in there one night and so I'm

602
00:53:56,240 --> 00:54:01,689
pretty sure the wireless keyboard then
because of the keyboard and captured

603
00:54:01,690 --> 00:54:06,619
over two strokes you know their account
information for the doom and their

604
00:54:06,619 --> 00:54:10,369
account information for the server they
have to be loaded into the access

605
00:54:10,369 --> 00:54:15,190
control server each day so that they can
see who's active in his not some of the

606
00:54:15,190 --> 00:54:18,859
more sophisticated systems for the
guards when you scan your badge and it

607
00:54:18,859 --> 00:54:23,690
looks up the idea it will pop up a
picture if they're paying attention

608
00:54:23,690 --> 00:54:26,569
which they probably aren't there
supposed to look at the picture and look

609
00:54:26,569 --> 00:54:32,480
at you can be sure that you know you
match the picture on the bed they don't

610
00:54:32,480 --> 00:54:38,210
always do that so those pictures by the
way are usually stored on a open network

611
00:54:38,210 --> 00:54:43,609
share I wanted to be sure that my
picture came up I could just replaced

612
00:54:43,609 --> 00:54:48,980
with a picture of me I did put in one of
them that I was gonna replace all of the

613
00:54:48,980 --> 00:54:54,440
pictures with mine would have to look at
me all the time but I decided that I

614
00:54:54,440 --> 00:55:01,150
wasn't very polite so we got all kinds
of great credentials 2346 worth of

615
00:55:01,150 --> 00:55:05,380
credentials because they were coming in
and out as we were collecting keystrokes

616
00:55:05,380 --> 00:55:11,900
go back again with another duplicated
kurd

617
00:55:11,900 --> 00:55:17,310
we've already have some cards and that's
cool but the title

618
00:55:17,310 --> 00:55:26,009
the physical access server is always
kind of domain admin of the physical

619
00:55:26,010 --> 00:55:32,750
access world better some of the vendors
how they're not really the security game

620
00:55:32,750 --> 00:55:37,970
yet I know who decided this was a great
idea but physical access software is

621
00:55:37,970 --> 00:55:41,700
usually very expensive and very hard to
get so if I wanted to put the client on

622
00:55:41,700 --> 00:55:46,980
my it would be difficult for me to get a
copy but I don't need to you because

623
00:55:46,980 --> 00:55:58,230
they made a mobile app for iPhone and
the Android and all you have to do is

624
00:55:58,230 --> 00:56:01,860
connect to their wireless which we were
able to do a very easily since we had

625
00:56:01,860 --> 00:56:07,050
valid credentials that were used for the
keylogger weird in New the IP address of

626
00:56:07,050 --> 00:56:12,270
the server from the keylogger data that
we had collected and then we just put

627
00:56:12,270 --> 00:56:16,360
the credentials in so there's always
amuses me and that you can turn off

628
00:56:16,360 --> 00:56:23,240
encryption because you know hard and set
up the certificate on the server from

629
00:56:23,240 --> 00:56:28,129
the parking lot we have access to their
physical access system instead of

630
00:56:28,130 --> 00:56:31,920
cloning card I don't really have to do
that I can just wait until my team

631
00:56:31,920 --> 00:56:33,650
member gets up to the door

632
00:56:33,650 --> 00:56:38,010
go into the door control for that
specific door and just hit the temporary

633
00:56:38,010 --> 00:56:43,200
unlock button and unlock the door of
their purchase no card needed and you

634
00:56:43,200 --> 00:56:47,720
can do this for all of the doors or you
can tell it to lock them all and not let

635
00:56:47,720 --> 00:56:52,149
anybody leave it at that point out that
kind of our domain admin of the physical

636
00:56:52,150 --> 00:56:57,610
access world right because if I can
disable the head of security is bad I

637
00:56:57,610 --> 00:57:02,140
mean what else is there for me to do so
but really how some of these

638
00:57:02,140 --> 00:57:07,140
vulnerabilities smaller ones that
together so there are a lot

639
00:57:07,140 --> 00:57:14,150
to do to really start to security system
there's a long road ahead they're

640
00:57:14,150 --> 00:57:18,730
usually fifteen years behind us and I do
and it's going to require a really big

641
00:57:18,730 --> 00:57:22,600
culture ship to really help them
understand these vulnerabilities and

642
00:57:22,600 --> 00:57:30,310
help them take steps to prevent them a
lot of preventable all passwords and

643
00:57:30,310 --> 00:57:32,410
encryption again

644
00:57:32,410 --> 00:57:37,970
circa 1999 for us and I T we just have
to help them catch up so I'm working on

645
00:57:37,970 --> 00:57:38,520
it

646
00:57:38,520 --> 00:57:44,610
checklist for them to hopefully use with
a security body from the networks to

647
00:57:44,610 --> 00:57:48,250
help them look at some of these pieces
in their own network and evaluate

648
00:57:48,250 --> 00:57:53,240
themselves if they can't afford for a
consultant to come in and do it for them

649
00:57:53,240 --> 00:57:58,669
thoughts on this if you've seen it in
the wild very interested in hearing them

650
00:57:58,670 --> 00:58:03,420
pretty much just me and my MacBook right
now that are trying to help everybody

651
00:58:03,420 --> 00:58:12,090
out there are always looking for new
ideas and I am out of time but I will be

652
00:58:12,090 --> 00:58:14,280
around today and tomorrow

653
00:58:14,280 --> 00:58:18,960
your questions or if you'd like to talk
about it I would love to thank you so

654
00:58:18,960 --> 00:58:19,010
much

