1
00:00:16,560 --> 00:00:17,680
hello everyone

2
00:00:17,680 --> 00:00:20,240
this is guardian i'm very glad to be

3
00:00:20,240 --> 00:00:21,119
here and

4
00:00:21,119 --> 00:00:23,920
share my research followings and h and

5
00:00:23,920 --> 00:00:25,199
tv today

6
00:00:25,199 --> 00:00:28,480
we really appreciate the opportunity

7
00:00:28,480 --> 00:00:31,599
so our live show shared today is a

8
00:00:31,599 --> 00:00:33,840
breaking siemens systematic assignment

9
00:00:33,840 --> 00:00:35,440
plc protection

10
00:00:35,440 --> 00:00:40,000
mechanism before i begin i would like to

11
00:00:40,000 --> 00:00:42,399
introduce myself lukik

12
00:00:42,399 --> 00:00:45,760
my name is gautien from xi'an channel

13
00:00:45,760 --> 00:00:48,239
currently an industry control system

14
00:00:48,239 --> 00:00:49,680
security researcher

15
00:00:49,680 --> 00:00:52,719
and ms focus the research may

16
00:00:52,719 --> 00:00:56,160
focus on plc design scada industrial

17
00:00:56,160 --> 00:00:56,800
increment

18
00:00:56,800 --> 00:01:00,800
at sister working includes things like

19
00:01:00,800 --> 00:01:03,199
vulnerability marketing industry field

20
00:01:03,199 --> 00:01:04,479
security testing and

21
00:01:04,479 --> 00:01:08,080
evaluation for the past few years and

22
00:01:08,080 --> 00:01:11,200
i have reported several when you've been

23
00:01:11,200 --> 00:01:13,040
changed to siemens

24
00:01:13,040 --> 00:01:16,240
courses schneider and so on go data

25
00:01:16,240 --> 00:01:17,119
series

26
00:01:17,119 --> 00:01:19,840
and of course sex notes from these

27
00:01:19,840 --> 00:01:20,880
countries

28
00:01:20,880 --> 00:01:23,840
it will have any questions or ideas

29
00:01:23,840 --> 00:01:26,880
regarding the security of spectre or

30
00:01:26,880 --> 00:01:29,759
industry control system please feel free

31
00:01:29,759 --> 00:01:30,880
to contact me

32
00:01:30,880 --> 00:01:33,600
here is my email i'm looking forward to

33
00:01:33,600 --> 00:01:36,000
your emails

34
00:01:36,000 --> 00:01:39,200
so here is the layout of today's

35
00:01:39,200 --> 00:01:42,000
prostitution first of all i will give a

36
00:01:42,000 --> 00:01:42,479
brief

37
00:01:42,479 --> 00:01:45,759
introduction our semantic plc

38
00:01:45,759 --> 00:01:49,360
and its vacation series including what

39
00:01:49,360 --> 00:01:52,880
cr senior is our symmetric policies have

40
00:01:52,880 --> 00:01:57,119
what's your plc protects protection

41
00:01:57,119 --> 00:02:02,000
like this is and why and launcher breaks

42
00:02:02,000 --> 00:02:05,360
what possible implications

43
00:02:05,360 --> 00:02:09,038
after breaking the necklace and so on

44
00:02:09,038 --> 00:02:12,160
followable followed by more detailed

45
00:02:12,160 --> 00:02:14,400
explanations of how to break the

46
00:02:14,400 --> 00:02:16,480
protection practice

47
00:02:16,480 --> 00:02:19,680
that is according to different

48
00:02:19,680 --> 00:02:22,800
series of products

49
00:02:22,800 --> 00:02:26,319
ok let's get started semantic is a plc

50
00:02:26,319 --> 00:02:29,280
produced by siemens for industry there

51
00:02:29,280 --> 00:02:30,640
are several symmetry

52
00:02:30,640 --> 00:02:33,760
symmetric series products lag and

53
00:02:33,760 --> 00:02:37,760
s 3 and s5 passive were outdated

54
00:02:37,760 --> 00:02:41,040
and withdrawing for the market the

55
00:02:41,040 --> 00:02:44,959
latest series of now is s7

56
00:02:44,959 --> 00:02:47,519
which has been the most popular pc in

57
00:02:47,519 --> 00:02:48,800
the market

58
00:02:48,800 --> 00:02:51,440
and use in areas of critical

59
00:02:51,440 --> 00:02:52,560
infrastructure

60
00:02:52,560 --> 00:02:55,760
such as energy power grid water

61
00:02:55,760 --> 00:02:57,040
automation

62
00:02:57,040 --> 00:03:01,760
manufacturing and other scenarios

63
00:03:01,840 --> 00:03:04,560
thematic plc has a variety of built in

64
00:03:04,560 --> 00:03:05,920
security mirrors

65
00:03:05,920 --> 00:03:08,560
and we will look into ones regarding

66
00:03:08,560 --> 00:03:11,599
axis control protection today

67
00:03:11,599 --> 00:03:14,800
access protection provides comprehensive

68
00:03:14,800 --> 00:03:16,840
protection against

69
00:03:16,840 --> 00:03:20,280
unauthorised configuration chips

70
00:03:20,280 --> 00:03:23,280
authorizations can be used to against

71
00:03:23,280 --> 00:03:26,319
separate rights

72
00:03:27,519 --> 00:03:31,040
access protection provides comprehensive

73
00:03:31,040 --> 00:03:32,080
protection

74
00:03:32,080 --> 00:03:34,959
against on authorized configuration

75
00:03:34,959 --> 00:03:36,159
sheets

76
00:03:36,159 --> 00:03:39,200
authorization dates can be used to

77
00:03:39,200 --> 00:03:42,400
assign separate rights to different user

78
00:03:42,400 --> 00:03:43,519
goals

79
00:03:43,519 --> 00:03:45,599
different authorization group has

80
00:03:45,599 --> 00:03:47,680
differential authorization needs to

81
00:03:47,680 --> 00:03:48,239
perform

82
00:03:48,239 --> 00:03:51,200
different activities breaking the

83
00:03:51,200 --> 00:03:52,480
authorization group

84
00:03:52,480 --> 00:03:55,360
binary will allow us to perform

85
00:03:55,360 --> 00:03:56,480
sensitive

86
00:03:56,480 --> 00:03:59,519
season 2 attaches outside

87
00:03:59,519 --> 00:04:02,959
of our authorization be like

88
00:04:02,959 --> 00:04:06,159
a lack of application downloading

89
00:04:06,159 --> 00:04:08,720
uploading starting and installing of the

90
00:04:08,720 --> 00:04:09,760
controller

91
00:04:09,760 --> 00:04:12,640
which are all designed to be secured by

92
00:04:12,640 --> 00:04:13,400
highly

93
00:04:13,400 --> 00:04:16,639
authorizationally enemies account

94
00:04:16,639 --> 00:04:20,000
enemies conducting them could have

95
00:04:20,000 --> 00:04:22,880
potentially lead surveillance failure in

96
00:04:22,880 --> 00:04:24,960
addition i passed the authorization

97
00:04:24,960 --> 00:04:26,840
concise

98
00:04:26,840 --> 00:04:29,759
collider in addition bypass

99
00:04:29,759 --> 00:04:32,560
the authorization could let us sky the

100
00:04:32,560 --> 00:04:35,120
co-application program for the consumer

101
00:04:35,120 --> 00:04:38,320
which may be the most widely pretended

102
00:04:38,320 --> 00:04:43,160
technique quiz and call completing with

103
00:04:43,160 --> 00:04:46,000
competitivities or a company

104
00:04:46,000 --> 00:04:49,040
if the content decrees are acquired by

105
00:04:49,040 --> 00:04:52,320
age for its competitors

106
00:04:52,320 --> 00:04:55,520
it's their staging for the company

107
00:04:55,520 --> 00:04:59,280
so for whatever reasons the excess

108
00:04:59,280 --> 00:05:02,880
protection that the mechanism

109
00:05:02,880 --> 00:05:06,639
is brushed already or related activities

110
00:05:06,639 --> 00:05:10,000
devices and even our physical life could

111
00:05:10,000 --> 00:05:14,080
be rotationally at risk

112
00:05:14,080 --> 00:05:16,479
first let's take a look at the

113
00:05:16,479 --> 00:05:18,880
assignment together series

114
00:05:18,880 --> 00:05:21,680
which has a chinese world with live four

115
00:05:21,680 --> 00:05:23,600
password protection

116
00:05:23,600 --> 00:05:26,880
and swissly we can't upload the

117
00:05:26,880 --> 00:05:28,560
application

118
00:05:28,560 --> 00:05:31,759
program even with a correct

119
00:05:31,759 --> 00:05:34,960
password so it's supposed to be a quite

120
00:05:34,960 --> 00:05:35,919
a secret

121
00:05:35,919 --> 00:05:38,639
mechanism regarding the protection of

122
00:05:38,639 --> 00:05:40,199
the core

123
00:05:40,199 --> 00:05:43,039
internatory property

124
00:05:43,039 --> 00:05:46,160
but there is always a way to bypass it

125
00:05:46,160 --> 00:05:49,919
let's see how after some analysis

126
00:05:49,919 --> 00:05:52,479
we understood that there are several

127
00:05:52,479 --> 00:05:53,199
steps

128
00:05:53,199 --> 00:05:56,960
in zero new for protection

129
00:05:56,960 --> 00:06:00,319
mechanism first we need to search

130
00:06:00,319 --> 00:06:01,600
earlier for

131
00:06:01,600 --> 00:06:04,720
password in the system block and

132
00:06:04,720 --> 00:06:07,919
then calculate a cypher test using a

133
00:06:07,919 --> 00:06:08,960
spare

134
00:06:08,960 --> 00:06:13,120
specific angle algorithm

135
00:06:13,120 --> 00:06:15,120
after comparing the result is

136
00:06:15,120 --> 00:06:16,400
downloading

137
00:06:16,400 --> 00:06:19,759
use pbi protocol and then save

138
00:06:19,759 --> 00:06:23,120
into episode chief now

139
00:06:23,120 --> 00:06:26,400
that they know the password information

140
00:06:26,400 --> 00:06:29,680
is in the aep zone the general idea is

141
00:06:29,680 --> 00:06:32,960
disorderly reading information

142
00:06:32,960 --> 00:06:35,680
out of it changing the password live

143
00:06:35,680 --> 00:06:36,960
byte

144
00:06:36,960 --> 00:06:39,120
loading the key parameters of the

145
00:06:39,120 --> 00:06:42,160
original system block to the controller

146
00:06:42,160 --> 00:06:45,199
and mesh a cab and

147
00:06:45,199 --> 00:06:48,400
machine accomplished let's take

148
00:06:48,400 --> 00:06:51,759
a look and show it in multitude

149
00:06:51,759 --> 00:06:55,120
the picture on the left is a screenshot

150
00:06:55,120 --> 00:06:58,960
of the aap zone and in the middle

151
00:06:58,960 --> 00:07:01,919
is our self-made debugging turkish so

152
00:07:01,919 --> 00:07:02,800
that we could

153
00:07:02,800 --> 00:07:06,800
frequently read from and write your e p

154
00:07:06,800 --> 00:07:10,000
zone with easy the diabolo

155
00:07:10,000 --> 00:07:13,599
on the right is a contained our eep zone

156
00:07:13,599 --> 00:07:17,680
after analysis we found that batch

157
00:07:17,680 --> 00:07:20,960
we found the best for its password leave

158
00:07:20,960 --> 00:07:25,599
and show in the red box here zero for

159
00:07:25,599 --> 00:07:28,319
accessibility and bytes for the

160
00:07:28,319 --> 00:07:30,880
interrupted password and show

161
00:07:30,880 --> 00:07:34,240
in the blue box here the incorrupted

162
00:07:34,240 --> 00:07:37,759
nihal 123 password however

163
00:07:37,759 --> 00:07:41,199
soon we altering the password new patch

164
00:07:41,199 --> 00:07:45,280
so that we can the y in stereo

165
00:07:45,280 --> 00:07:48,400
level 4 is not enough bypass the

166
00:07:48,400 --> 00:07:49,599
authorization

167
00:07:49,599 --> 00:07:52,479
since the plc use another two bytes or

168
00:07:52,479 --> 00:07:53,599
rarification

169
00:07:53,599 --> 00:07:57,120
in eu which is a familiar

170
00:07:57,120 --> 00:08:01,520
accomplished to bridge but

171
00:08:01,520 --> 00:08:06,560
we had was much idea to buy passage

172
00:08:06,639 --> 00:08:09,280
the idea is let intercept solve the

173
00:08:09,280 --> 00:08:10,240
problem

174
00:08:10,240 --> 00:08:13,919
we can exchange extract

175
00:08:13,919 --> 00:08:16,879
we can extract the parameters of the

176
00:08:16,879 --> 00:08:18,080
saturn

177
00:08:18,080 --> 00:08:21,280
block from the unwritten original beam

178
00:08:21,280 --> 00:08:21,840
field

179
00:08:21,840 --> 00:08:25,520
application claim clinch to

180
00:08:25,520 --> 00:08:29,199
a capsule the parameters to ppi

181
00:08:29,199 --> 00:08:32,479
message and install it back into plc

182
00:08:32,479 --> 00:08:35,039
so that plc can go through the

183
00:08:35,039 --> 00:08:36,159
verification

184
00:08:36,159 --> 00:08:39,200
for you pirate with

185
00:08:39,200 --> 00:08:42,559
possible link by change we now bypass

186
00:08:42,559 --> 00:08:43,440
the new 4

187
00:08:43,440 --> 00:08:46,560
authorization and get the code

188
00:08:46,560 --> 00:08:50,800
application inside in the plc

189
00:08:50,800 --> 00:08:54,240
now let's take a look at siemens

190
00:08:54,240 --> 00:08:57,519
and s7 together smart poc

191
00:08:57,519 --> 00:09:00,880
designed for azure market for this

192
00:09:00,880 --> 00:09:02,080
series of plc

193
00:09:02,080 --> 00:09:05,440
we performed a mar in the middle

194
00:09:05,440 --> 00:09:08,720
attack to staff the traffic between the

195
00:09:08,720 --> 00:09:10,959
plc and the configuration

196
00:09:10,959 --> 00:09:14,000
software we tried to decipher

197
00:09:14,000 --> 00:09:17,680
the hidden information embedded in the

198
00:09:17,680 --> 00:09:18,720
traffic

199
00:09:18,720 --> 00:09:22,560
and found something quick in shape

200
00:09:22,560 --> 00:09:25,920
in interest we try to

201
00:09:25,920 --> 00:09:28,320
decipher the hiding information embedded

202
00:09:28,320 --> 00:09:30,640
in the traffic and found something

203
00:09:30,640 --> 00:09:33,600
quite interesting which will help us

204
00:09:33,600 --> 00:09:35,440
guide the password hence

205
00:09:35,440 --> 00:09:39,279
first the access protection

206
00:09:39,279 --> 00:09:42,080
first of all we still need to know the

207
00:09:42,080 --> 00:09:42,959
algorithm

208
00:09:42,959 --> 00:09:46,680
of its authorization or how it password

209
00:09:46,680 --> 00:09:48,320
protection

210
00:09:48,320 --> 00:09:51,680
is in claimanted

211
00:09:51,680 --> 00:09:54,399
after some research is found that there

212
00:09:54,399 --> 00:09:55,200
is a

213
00:09:55,200 --> 00:09:57,760
four-star challenge response process

214
00:09:57,760 --> 00:09:58,240
forced

215
00:09:58,240 --> 00:10:02,079
the claim to initiate the process

216
00:10:02,079 --> 00:10:05,120
and request the plc variant number

217
00:10:05,120 --> 00:10:08,399
are key and then the plc retains with

218
00:10:08,399 --> 00:10:11,440
22 page challenge and

219
00:10:11,440 --> 00:10:14,880
then the claim testing the response

220
00:10:14,880 --> 00:10:18,640
a calculated 20 bytes hash value

221
00:10:18,640 --> 00:10:23,200
and 40 the plc life is a challenging

222
00:10:23,200 --> 00:10:26,240
challenge response peer and reaching the

223
00:10:26,240 --> 00:10:30,399
corresponding result since the 20 bytes

224
00:10:30,399 --> 00:10:32,640
hash value can be obtained from the

225
00:10:32,640 --> 00:10:33,920
traffic

226
00:10:33,920 --> 00:10:37,120
we then need to know which algorithm

227
00:10:37,120 --> 00:10:40,320
is used to get this value

228
00:10:40,320 --> 00:10:43,440
provided with the 22 byte pc

229
00:10:43,440 --> 00:10:46,240
challenge and the password signed by the

230
00:10:46,240 --> 00:10:46,880
user

231
00:10:46,880 --> 00:10:51,200
to do that we reverse the

232
00:10:51,200 --> 00:10:55,200
calm l7 to steer in the stair 7

233
00:10:55,200 --> 00:10:59,440
microphone configuration software

234
00:10:59,440 --> 00:11:02,480
after lenses the algorithm

235
00:11:02,480 --> 00:11:04,720
is like this there are three key

236
00:11:04,720 --> 00:11:05,519
variables

237
00:11:05,519 --> 00:11:09,920
the input password and

238
00:11:09,920 --> 00:11:12,160
22 bytes are key written by the

239
00:11:12,160 --> 00:11:13,279
controller

240
00:11:13,279 --> 00:11:16,959
and the hardcore king story in the

241
00:11:16,959 --> 00:11:19,839
controller the fourth step is to do a

242
00:11:19,839 --> 00:11:20,399
shower

243
00:11:20,399 --> 00:11:22,800
calculation of the password and the

244
00:11:22,800 --> 00:11:23,920
first two

245
00:11:23,920 --> 00:11:26,959
points of the r key get x

246
00:11:26,959 --> 00:11:31,360
the last 20 bytes of arcane are y

247
00:11:31,360 --> 00:11:36,160
and x y is used on input parameter

248
00:11:36,160 --> 00:11:39,680
the first two bytes or arcane

249
00:11:39,680 --> 00:11:42,880
are used to replace the

250
00:11:42,880 --> 00:11:46,640
13 and 14

251
00:11:46,640 --> 00:11:49,360
bytes of the hardcore king inside the

252
00:11:49,360 --> 00:11:50,720
plc

253
00:11:50,720 --> 00:11:53,760
after the replacement a new hardcoding

254
00:11:53,760 --> 00:11:54,839
is

255
00:11:54,839 --> 00:11:57,760
created following two guys

256
00:11:57,760 --> 00:12:01,279
20 by hash value we use x

257
00:12:01,279 --> 00:12:04,720
y and the new hard cocaine to perform or

258
00:12:04,720 --> 00:12:05,120
h

259
00:12:05,120 --> 00:12:08,839
max xiaowai our zoo

260
00:12:08,839 --> 00:12:11,839
algorithm

261
00:12:12,079 --> 00:12:15,279
at this point we have the 22 bytes

262
00:12:15,279 --> 00:12:16,800
arcane

263
00:12:16,800 --> 00:12:20,560
the hardcore king and the 20

264
00:12:20,560 --> 00:12:24,560
byte has value and i have employee

265
00:12:24,560 --> 00:12:27,519
maintained a script to calculate through

266
00:12:27,519 --> 00:12:28,720
the hush

267
00:12:28,720 --> 00:12:31,360
then we try to bridge the axis

268
00:12:31,360 --> 00:12:33,360
protection by cracking

269
00:12:33,360 --> 00:12:37,839
the user input password with

270
00:12:37,839 --> 00:12:41,440
offline brute force attack

271
00:12:41,440 --> 00:12:44,480
so the whole process would be staffing

272
00:12:44,480 --> 00:12:45,040
the

273
00:12:45,040 --> 00:12:47,279
traffic to the location the

274
00:12:47,279 --> 00:12:48,880
authorization information

275
00:12:48,880 --> 00:12:52,000
and then proof is

276
00:12:52,000 --> 00:12:55,200
brute force the password we have tested

277
00:12:55,200 --> 00:12:55,600
that

278
00:12:55,600 --> 00:12:59,279
a six digital password only took about

279
00:12:59,279 --> 00:13:02,720
13 seconds on a normal pc so

280
00:13:02,720 --> 00:13:06,480
it's quite feasible

281
00:13:06,480 --> 00:13:10,000
okay s7

282
00:13:10,000 --> 00:13:13,600
300 400 is the most widely used

283
00:13:13,600 --> 00:13:16,480
large purses in the industry field

284
00:13:16,480 --> 00:13:17,600
enterprises

285
00:13:17,600 --> 00:13:20,160
they are main user in the control our

286
00:13:20,160 --> 00:13:21,920
critical infrastructure

287
00:13:21,920 --> 00:13:25,360
such as students melting oil department

288
00:13:25,360 --> 00:13:26,240
management

289
00:13:26,240 --> 00:13:29,760
and other screens

290
00:13:29,760 --> 00:13:33,040
access control protection of its

291
00:13:33,040 --> 00:13:35,760
series has been clear cracked through

292
00:13:35,760 --> 00:13:36,399
the past

293
00:13:36,399 --> 00:13:40,720
few years with only brute force attacks

294
00:13:40,720 --> 00:13:43,920
and conresponding tools have been

295
00:13:43,920 --> 00:13:45,040
released

296
00:13:45,040 --> 00:13:47,839
what we are going to talk about today is

297
00:13:47,839 --> 00:13:49,680
following mystery information

298
00:13:49,680 --> 00:13:53,600
through the protection project fields

299
00:13:53,600 --> 00:13:56,320
and use the information to break through

300
00:13:56,320 --> 00:13:57,040
excess

301
00:13:57,040 --> 00:14:01,040
protection mechanism

302
00:14:01,120 --> 00:14:04,560
first we found h-a-t-t-r

303
00:14:04,560 --> 00:14:07,760
and g-1 dbt field

304
00:14:07,760 --> 00:14:11,040
in the project field for which we found

305
00:14:11,040 --> 00:14:11,680
the

306
00:14:11,680 --> 00:14:15,040
cipher test we found the corresponding

307
00:14:15,040 --> 00:14:16,240
corruption

308
00:14:16,240 --> 00:14:20,079
algorithm by reverse the step 7

309
00:14:20,079 --> 00:14:23,279
and 7 which come x

310
00:14:23,279 --> 00:14:26,880
dot dl field as shown in the diagram on

311
00:14:26,880 --> 00:14:27,440
the

312
00:14:27,440 --> 00:14:30,959
right these this other algorithm

313
00:14:30,959 --> 00:14:34,079
is a simple xor in russian and

314
00:14:34,079 --> 00:14:36,880
ciphertext information is other change

315
00:14:36,880 --> 00:14:38,560
through xor

316
00:14:38,560 --> 00:14:41,600
encouraging then we can judge a

317
00:14:41,600 --> 00:14:43,680
corresponding

318
00:14:43,680 --> 00:14:47,440
eruption script with the ciphertext

319
00:14:47,440 --> 00:14:50,880
to guide the corresponding planned test

320
00:14:50,880 --> 00:14:54,160
password once we get the plan test

321
00:14:54,160 --> 00:14:57,760
password we get a direct access to

322
00:14:57,760 --> 00:15:03,199
the s7 300 400 plc controller

323
00:15:03,199 --> 00:15:06,959
finally let's take a look at the ice

324
00:15:06,959 --> 00:15:10,079
7 10 header series which

325
00:15:10,079 --> 00:15:13,279
is the most secure series of the whole

326
00:15:13,279 --> 00:15:15,519
siemens plc products

327
00:15:15,519 --> 00:15:19,920
its latest version v4 is a high-end plc

328
00:15:19,920 --> 00:15:23,040
in channel with more comprehensive

329
00:15:23,040 --> 00:15:24,480
security features

330
00:15:24,480 --> 00:15:28,079
and its access project mechanism

331
00:15:28,079 --> 00:15:31,279
favors from other theories

332
00:15:31,279 --> 00:15:34,480
the ice seven child hazard

333
00:15:34,480 --> 00:15:38,320
plc has three different passwords with

334
00:15:38,320 --> 00:15:42,399
separate permissions any action with the

335
00:15:42,399 --> 00:15:44,800
13 permission view can only

336
00:15:44,800 --> 00:15:47,600
be granted with the corresponding

337
00:15:47,600 --> 00:15:48,480
permission

338
00:15:48,480 --> 00:15:51,680
new password similarly

339
00:15:51,680 --> 00:15:56,240
the overall security of the s7

340
00:15:56,240 --> 00:16:00,480
child hydraulic series is very strong

341
00:16:00,480 --> 00:16:03,600
the 32 bytes which integrated

342
00:16:03,600 --> 00:16:07,440
reflection maxim and the communication

343
00:16:07,440 --> 00:16:10,480
protocol s7 complex are projected by

344
00:16:10,480 --> 00:16:14,639
a varietal magazine

345
00:16:14,959 --> 00:16:18,000
which can should be bypassed use a

346
00:16:18,000 --> 00:16:18,880
similar

347
00:16:18,880 --> 00:16:22,560
similar technique we mentioned before

348
00:16:22,560 --> 00:16:25,920
however he is passing the harsh

349
00:16:25,920 --> 00:16:29,199
attack to deal with this situation

350
00:16:29,199 --> 00:16:32,240
this this attack was very effective for

351
00:16:32,240 --> 00:16:35,040
breaking the excess protection of

352
00:16:35,040 --> 00:16:38,720
of the s7 shell hazard

353
00:16:38,720 --> 00:16:42,880
series here is how we did it

354
00:16:42,880 --> 00:16:46,240
first the first step is to get access to

355
00:16:46,240 --> 00:16:47,600
the

356
00:16:47,600 --> 00:16:50,800
s7 shell header memory which can be

357
00:16:50,800 --> 00:16:54,759
done in two ways the first is explain

358
00:16:54,759 --> 00:16:57,920
vulnerability and use a tool

359
00:16:57,920 --> 00:17:00,800
to dump out the memory this is when your

360
00:17:00,800 --> 00:17:02,959
ability is likely to be

361
00:17:02,959 --> 00:17:05,679
a hardware form which can't be fully

362
00:17:05,679 --> 00:17:06,720
fixed

363
00:17:06,720 --> 00:17:10,160
with a span with a

364
00:17:10,160 --> 00:17:13,119
special access function of your arch we

365
00:17:13,119 --> 00:17:13,760
can create

366
00:17:13,760 --> 00:17:16,799
a script to read out all

367
00:17:16,799 --> 00:17:20,000
to out all the contains our giving

368
00:17:20,000 --> 00:17:20,720
address

369
00:17:20,720 --> 00:17:24,079
and future and hence we will have the

370
00:17:24,079 --> 00:17:26,319
memory of the device

371
00:17:26,319 --> 00:17:29,440
the second method is hardware disorderly

372
00:17:29,440 --> 00:17:33,280
the nq281 that store forward

373
00:17:33,280 --> 00:17:36,960
and application date can be soldered

374
00:17:36,960 --> 00:17:39,840
and use a logical program to take out

375
00:17:39,840 --> 00:17:42,559
all of the content

376
00:17:42,559 --> 00:17:45,440
the second step is to look for key

377
00:17:45,440 --> 00:17:46,080
information

378
00:17:46,080 --> 00:17:49,360
from the memory you tried in the first

379
00:17:49,360 --> 00:17:53,840
step the memory of i7 channel header has

380
00:17:53,840 --> 00:17:57,120
totally our behavioral change h

381
00:17:57,120 --> 00:17:59,840
and bits which starts with the

382
00:17:59,840 --> 00:18:01,440
bootloader followed by

383
00:18:01,440 --> 00:18:03,919
the whole video and application page of

384
00:18:03,919 --> 00:18:05,440
the device

385
00:18:05,440 --> 00:18:09,679
with a last the latest forward

386
00:18:09,679 --> 00:18:14,000
worry of s7 2015 c

387
00:18:14,000 --> 00:18:18,400
in detail may 2021 and the opportunity

388
00:18:18,400 --> 00:18:21,600
is closed segment read only date

389
00:18:21,600 --> 00:18:24,240
segment and the starting address and the

390
00:18:24,240 --> 00:18:25,360
length of the date

391
00:18:25,360 --> 00:18:29,280
segment the corresponding the compared

392
00:18:29,280 --> 00:18:32,320
sudo code is also obtained by

393
00:18:32,320 --> 00:18:35,919
loading the code segment content

394
00:18:35,919 --> 00:18:39,520
using ida the third

395
00:18:39,520 --> 00:18:41,760
and the most important step is to find

396
00:18:41,760 --> 00:18:42,880
out

397
00:18:42,880 --> 00:18:45,919
is exactly where the password

398
00:18:45,919 --> 00:18:49,200
is stored after the reverse of the

399
00:18:49,200 --> 00:18:52,799
code process module omsp call manage

400
00:18:52,799 --> 00:18:56,720
dot dl it's found that the password is

401
00:18:56,720 --> 00:18:59,200
stored in the

402
00:18:59,200 --> 00:19:02,799
form of someone the hmi access

403
00:19:02,799 --> 00:19:06,240
protection password 20 page hash

404
00:19:06,240 --> 00:19:09,760
grid access protection password hash

405
00:19:09,760 --> 00:19:13,039
for access production buzzer hash

406
00:19:13,039 --> 00:19:16,640
all all the password hash are stored in

407
00:19:16,640 --> 00:19:17,280
the

408
00:19:17,280 --> 00:19:20,640
memory of the bss segment in

409
00:19:20,640 --> 00:19:23,840
exit order at this point when the

410
00:19:23,840 --> 00:19:25,600
password is set to none

411
00:19:25,600 --> 00:19:30,240
you can locate edge in the bss section

412
00:19:30,240 --> 00:19:34,559
which starts with the noun passwords

413
00:19:34,559 --> 00:19:41,280
sha 1 characteristic da da3983

414
00:19:41,600 --> 00:19:44,880
if all passwords are not set to now

415
00:19:44,880 --> 00:19:48,000
you can start from vrmost on zero zero

416
00:19:48,000 --> 00:19:52,160
zero zeros and look for 20 bites of the

417
00:19:52,160 --> 00:19:52,799
charlene

418
00:19:52,799 --> 00:19:56,799
feature that prestige

419
00:19:57,360 --> 00:20:00,880
once successfully located the 20 byte

420
00:20:00,880 --> 00:20:01,919
harsh

421
00:20:01,919 --> 00:20:05,679
we could launch a requirement

422
00:20:05,679 --> 00:20:08,799
x 34 dbg

423
00:20:08,799 --> 00:20:11,440
and the configurations of the rtr ie to

424
00:20:11,440 --> 00:20:12,080
locate

425
00:20:12,080 --> 00:20:15,200
the password in corruption process

426
00:20:15,200 --> 00:20:17,679
we then replace the run hash directly

427
00:20:17,679 --> 00:20:19,840
with the 23

428
00:20:19,840 --> 00:20:23,200
quite harsh we thought in the memorator

429
00:20:23,200 --> 00:20:26,240
performed has a harsh check

430
00:20:26,240 --> 00:20:29,840
in this case with the bridge the s7

431
00:20:29,840 --> 00:20:33,600
trail hydra access protection magnitude

432
00:20:33,600 --> 00:20:36,880
the following is the demo of the attack

433
00:20:36,880 --> 00:20:40,960
first we create a new project

434
00:20:40,960 --> 00:20:44,000
and upload the application program on

435
00:20:44,000 --> 00:20:44,880
the plc

436
00:20:44,880 --> 00:20:48,960
should be brushed

437
00:20:48,960 --> 00:20:52,640
and then we mount

438
00:20:52,640 --> 00:20:57,200
x 74 dbg enter a random password

439
00:20:57,200 --> 00:21:00,400
continue the process until we hit the

440
00:21:00,400 --> 00:21:00,880
broke

441
00:21:00,880 --> 00:21:04,480
point or the password in corruption

442
00:21:04,480 --> 00:21:07,760
habits replace the 20

443
00:21:07,760 --> 00:21:10,480
byte harsh

444
00:21:12,159 --> 00:21:16,000
continue the process

445
00:21:16,000 --> 00:21:19,600
now we have successfully used the

446
00:21:19,600 --> 00:21:22,400
text to bypass the protection and the

447
00:21:22,400 --> 00:21:23,600
concern

448
00:21:23,600 --> 00:21:26,799
performs the desert action

449
00:21:26,799 --> 00:21:30,640
like uploading applications

450
00:21:30,640 --> 00:21:34,960
stop and run the plc controller

451
00:21:34,960 --> 00:21:37,280
okay

452
00:21:38,080 --> 00:21:41,200
in may 2021 siemens released the

453
00:21:41,200 --> 00:21:45,840
latest from work rolling

454
00:21:51,919 --> 00:21:54,720
addressed a lot of security issues such

455
00:21:54,720 --> 00:21:55,120
as

456
00:21:55,120 --> 00:21:58,960
enhancing the exception of cpu access

457
00:21:58,960 --> 00:22:00,640
new password

458
00:22:00,640 --> 00:22:03,120
in writing will say configuration date

459
00:22:03,120 --> 00:22:04,559
and use tis to

460
00:22:04,559 --> 00:22:07,440
achieve secure pgpc and html

461
00:22:07,440 --> 00:22:08,480
communication

462
00:22:08,480 --> 00:22:10,720
however we found a very interesting

463
00:22:10,720 --> 00:22:11,520
thing

464
00:22:11,520 --> 00:22:15,440
we have a s7 channel 15c

465
00:22:15,440 --> 00:22:19,280
favorite forward upper grade 2

466
00:22:19,280 --> 00:22:23,919
y 4 5 0 volt

467
00:22:23,919 --> 00:22:27,280
i application with excel protection

468
00:22:27,280 --> 00:22:30,720
was configured and installed

469
00:22:30,720 --> 00:22:33,919
into the upgrade plc user

470
00:22:33,919 --> 00:22:38,080
using tra way 13. at this point

471
00:22:38,080 --> 00:22:41,039
we need to upload an application or

472
00:22:41,039 --> 00:22:41,600
create

473
00:22:41,600 --> 00:22:44,799
a new project use gra a password

474
00:22:44,799 --> 00:22:48,159
input box should pop up and let us enter

475
00:22:48,159 --> 00:22:51,919
the correct password however

476
00:22:51,919 --> 00:22:55,120
when they upload the application gra

477
00:22:55,120 --> 00:23:00,080
didn't pop up any authority

478
00:23:00,080 --> 00:23:04,400
tra didn't pop up early authorization

479
00:23:04,400 --> 00:23:07,039
interaction and just upload the

480
00:23:07,039 --> 00:23:09,120
application with the password

481
00:23:09,120 --> 00:23:12,559
we don't know why this happened when it

482
00:23:12,559 --> 00:23:17,200
was clear a bug without any details

483
00:23:17,200 --> 00:23:20,000
we could guide access to the password

484
00:23:20,000 --> 00:23:21,200
protected

485
00:23:21,200 --> 00:23:24,640
project we have gone through the

486
00:23:24,640 --> 00:23:27,840
audio update information of siemens

487
00:23:27,840 --> 00:23:31,120
in detail which mentioned that the phone

488
00:23:31,120 --> 00:23:31,840
video with

489
00:23:31,840 --> 00:23:35,520
enhanced security feature must cover

490
00:23:35,520 --> 00:23:40,000
with the step 7 v17 basic software

491
00:23:40,000 --> 00:23:43,039
in order to arrive for by the latest

492
00:23:43,039 --> 00:23:46,080
version gra

493
00:23:46,080 --> 00:23:50,960
we 17 and 4 way ray450

494
00:23:50,960 --> 00:23:54,480
also suffering the path

495
00:23:54,480 --> 00:23:58,000
the hash passing attack we need to find

496
00:23:58,000 --> 00:24:01,760
the software for stat 7

497
00:24:01,760 --> 00:24:05,279
resetting basic unfortunately

498
00:24:05,279 --> 00:24:08,799
as of may 20 2021

499
00:24:08,799 --> 00:24:11,600
we have yet to find the official

500
00:24:11,600 --> 00:24:13,039
download address

501
00:24:13,039 --> 00:24:16,159
or any information on this software

502
00:24:16,159 --> 00:24:19,360
if you are interested in this issue

503
00:24:19,360 --> 00:24:22,159
feel free to contact us for future

504
00:24:22,159 --> 00:24:23,279
information and

505
00:24:23,279 --> 00:24:25,919
discussion

506
00:24:26,880 --> 00:24:30,240
so far we have covered several axes

507
00:24:30,240 --> 00:24:33,520
per texturing force and this to

508
00:24:33,520 --> 00:24:36,880
bridge the protection mechanism

509
00:24:36,880 --> 00:24:39,760
and as plc manufacturers how can we

510
00:24:39,760 --> 00:24:40,880
enhance

511
00:24:40,880 --> 00:24:43,600
access protection security features to

512
00:24:43,600 --> 00:24:44,159
prevent

513
00:24:44,159 --> 00:24:47,360
such attacks let's start by

514
00:24:47,360 --> 00:24:50,080
looking at ways to enhance security from

515
00:24:50,080 --> 00:24:51,600
the configuration

516
00:24:51,600 --> 00:24:55,039
software first somewhat sure

517
00:24:55,039 --> 00:24:57,279
code protection can increase can be

518
00:24:57,279 --> 00:24:58,080
added to

519
00:24:58,080 --> 00:25:00,960
improve the difficulty our reserve

520
00:25:00,960 --> 00:25:02,080
energy

521
00:25:02,080 --> 00:25:06,320
such as the co code of a fast

522
00:25:06,320 --> 00:25:09,840
alpha station now adding a high

523
00:25:09,840 --> 00:25:12,960
security shield for the software the

524
00:25:12,960 --> 00:25:13,440
second

525
00:25:13,440 --> 00:25:16,960
is the interdust the idea

526
00:25:16,960 --> 00:25:21,360
of neutral authorization

527
00:25:21,360 --> 00:25:23,600
so that the plc and the configurations

528
00:25:23,600 --> 00:25:26,000
of the world is the right thought

529
00:25:26,000 --> 00:25:28,640
neutrally the third is to use the

530
00:25:28,640 --> 00:25:30,480
interruption

531
00:25:30,480 --> 00:25:33,840
technology to strengthen the protection

532
00:25:33,840 --> 00:25:37,360
of protect fields because sometimes

533
00:25:37,360 --> 00:25:40,320
protect fuels

534
00:25:40,320 --> 00:25:43,279
attacking veterans that the author were

535
00:25:43,279 --> 00:25:44,480
looked at

536
00:25:44,480 --> 00:25:47,520
with project fields one can obtain the

537
00:25:47,520 --> 00:25:49,279
password information

538
00:25:49,279 --> 00:25:52,480
which can be used to brush possible

539
00:25:52,480 --> 00:25:55,679
protection like be shown in

540
00:25:55,679 --> 00:25:59,600
about s7 300 example

541
00:25:59,600 --> 00:26:02,080
let's take a look at some ways to

542
00:26:02,080 --> 00:26:06,080
enhance security from a plc consumer

543
00:26:06,080 --> 00:26:08,640
first sensitive information should be

544
00:26:08,640 --> 00:26:11,039
stored in the chest block

545
00:26:11,039 --> 00:26:14,080
we can be referred to by software or

546
00:26:14,080 --> 00:26:14,720
hardware

547
00:26:14,720 --> 00:26:18,080
for example interruption case challenges

548
00:26:18,080 --> 00:26:21,360
core acquisitions and other information

549
00:26:21,360 --> 00:26:22,240
should be

550
00:26:22,240 --> 00:26:26,080
placed in the chest block to prevent age

551
00:26:26,080 --> 00:26:30,799
from being easily obtained by meniscus

552
00:26:30,799 --> 00:26:33,919
attachers the second is to end

553
00:26:33,919 --> 00:26:38,320
neutrally mandatory

554
00:26:38,320 --> 00:26:43,678
the second is to end neutral

555
00:26:44,080 --> 00:26:46,559
the second is the actual neutral

556
00:26:46,559 --> 00:26:48,159
authorization between

557
00:26:48,159 --> 00:26:50,880
the clinch and the plc such as the

558
00:26:50,880 --> 00:26:52,799
clinch and the plc

559
00:26:52,799 --> 00:26:56,480
controller are authentication

560
00:26:56,480 --> 00:27:00,080
neutrally the survey is the

561
00:27:00,080 --> 00:27:03,279
mandatory possible experiences settings

562
00:27:03,279 --> 00:27:06,240
this is very necessary at this stage in

563
00:27:06,240 --> 00:27:07,120
the industry

564
00:27:07,120 --> 00:27:11,520
things few people said passwords for plc

565
00:27:11,520 --> 00:27:14,960
are only send big password

566
00:27:14,960 --> 00:27:18,480
which can be easily cracked by proof

567
00:27:18,480 --> 00:27:21,279
broad force attacks a fourth strong

568
00:27:21,279 --> 00:27:22,000
password

569
00:27:22,000 --> 00:27:25,039
can prevent such attacks the fourth

570
00:27:25,039 --> 00:27:25,520
point

571
00:27:25,520 --> 00:27:29,120
is to end physical hardware protects

572
00:27:29,120 --> 00:27:32,159
protection techniques which is

573
00:27:32,159 --> 00:27:36,159
the simplest and the most feasible which

574
00:27:36,159 --> 00:27:38,080
prevents the hardware design and

575
00:27:38,080 --> 00:27:39,520
knowledge from being

576
00:27:39,520 --> 00:27:42,480
stolen and the cool information from

577
00:27:42,480 --> 00:27:44,320
being altitude

578
00:27:44,320 --> 00:27:47,440
the ball emissions are common method of

579
00:27:47,440 --> 00:27:49,120
protection

580
00:27:49,120 --> 00:27:52,159
we are sure there are much more this

581
00:27:52,159 --> 00:27:53,600
method can be used

582
00:27:53,600 --> 00:27:57,120
in the design of plc and its clinch

583
00:27:57,120 --> 00:28:00,080
software use this method it can

584
00:28:00,080 --> 00:28:01,360
effectively prevent

585
00:28:01,360 --> 00:28:04,559
much shows for obvious rush

586
00:28:04,559 --> 00:28:08,000
of the access protection

587
00:28:08,000 --> 00:28:12,799
it will also make our and poc users feel

588
00:28:12,799 --> 00:28:15,600
more confident and secure and will

589
00:28:15,600 --> 00:28:16,159
prevent

590
00:28:16,159 --> 00:28:19,919
some uh altruist

591
00:28:19,919 --> 00:28:23,559
at protectors on our critique

592
00:28:23,559 --> 00:28:27,600
infrastructure but it's a marathon

593
00:28:27,600 --> 00:28:31,120
and only consists vaguely

594
00:28:31,120 --> 00:28:33,919
and comprehensive protection can ensure

595
00:28:33,919 --> 00:28:34,320
that

596
00:28:34,320 --> 00:28:37,600
our critical impression i see from a

597
00:28:37,600 --> 00:28:38,240
test

598
00:28:38,240 --> 00:28:43,360
like the ukraine power voltage

599
00:28:43,360 --> 00:28:46,960
okay that's all for today's prostitution

600
00:28:46,960 --> 00:28:49,520
thank you all for joining the talk if

601
00:28:49,520 --> 00:28:50,720
you have any question

602
00:28:50,720 --> 00:28:54,240
please feel free to if you have any

603
00:28:54,240 --> 00:28:55,120
question

604
00:28:55,120 --> 00:28:59,840
please feel free to contact me

605
00:29:03,640 --> 00:29:06,640
bye

