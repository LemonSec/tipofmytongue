1
00:00:15,440 --> 00:00:16,480
welcome

2
00:00:16,480 --> 00:00:20,080
the session is story of the fishermen

3
00:00:20,080 --> 00:00:22,640
dissecting fission techniques of cloud

4
00:00:22,640 --> 00:00:23,199
dragon

5
00:00:23,199 --> 00:00:25,760
apt

6
00:00:27,039 --> 00:00:29,519
i'm chilling for or you can call me

7
00:00:29,519 --> 00:00:30,640
linda

8
00:00:30,640 --> 00:00:33,520
i'm currently working in tmt5 as a

9
00:00:33,520 --> 00:00:36,160
senior the intelligence analyst

10
00:00:36,160 --> 00:00:38,480
and i've been invited to different

11
00:00:38,480 --> 00:00:40,000
international conference

12
00:00:40,000 --> 00:00:43,840
including black cat or cold blue vitcon

13
00:00:43,840 --> 00:00:45,200
etc

14
00:00:45,200 --> 00:00:48,399
and i focus on apt attacks and financial

15
00:00:48,399 --> 00:00:51,039
instructions

16
00:00:51,520 --> 00:00:56,320
i love shin dot aol is my personal id

17
00:00:56,320 --> 00:00:59,680
in the internet and a three

18
00:00:59,680 --> 00:01:03,760
intention research is tt5 sometimes

19
00:01:03,760 --> 00:01:06,880
i am a speaker of security conference

20
00:01:06,880 --> 00:01:10,159
like koble and blackhead my research

21
00:01:10,159 --> 00:01:14,080
focused on f and pt

22
00:01:14,080 --> 00:01:16,799
before we get started let's go through

23
00:01:16,799 --> 00:01:19,360
what we're going to discuss today

24
00:01:19,360 --> 00:01:21,840
at the very first place of course we are

25
00:01:21,840 --> 00:01:23,040
going to define

26
00:01:23,040 --> 00:01:25,439
the group cloud dragon we will talk

27
00:01:25,439 --> 00:01:26,320
about the group

28
00:01:26,320 --> 00:01:28,960
and how we just how the definition of

29
00:01:28,960 --> 00:01:30,560
this group

30
00:01:30,560 --> 00:01:33,920
and uh in this conference we will be

31
00:01:33,920 --> 00:01:36,799
very uh like technical we will go very

32
00:01:36,799 --> 00:01:37,520
deeper

33
00:01:37,520 --> 00:01:40,479
to the technical part so instead the

34
00:01:40,479 --> 00:01:42,000
second and the third part

35
00:01:42,000 --> 00:01:44,000
we will talk about the techniques and

36
00:01:44,000 --> 00:01:47,119
the malware being used by this group

37
00:01:47,119 --> 00:01:49,920
and of course at the very last part

38
00:01:49,920 --> 00:01:52,079
we'll give a key takeaway

39
00:01:52,079 --> 00:01:56,639
of all the presentation of today

40
00:01:57,520 --> 00:02:00,640
so who is claude reagan

41
00:02:00,640 --> 00:02:02,640
there are actually a lot of names that

42
00:02:02,640 --> 00:02:03,840
you might have

43
00:02:03,840 --> 00:02:06,159
heard of or you've been heard that

44
00:02:06,159 --> 00:02:08,878
others connected to this group

45
00:02:08,878 --> 00:02:13,120
including abd37 or kimsuki

46
00:02:13,120 --> 00:02:16,000
we tried to divided the kimsuki into two

47
00:02:16,000 --> 00:02:16,800
different

48
00:02:16,800 --> 00:02:20,319
group the first one is the kimsuki

49
00:02:20,319 --> 00:02:23,360
released by kaspersky in their report

50
00:02:23,360 --> 00:02:26,879
back in 2013 and another one is the

51
00:02:26,879 --> 00:02:28,720
public new kimsuki

52
00:02:28,720 --> 00:02:31,760
that you can see in current years in a

53
00:02:31,760 --> 00:02:35,040
lot of news or a lot of reports

54
00:02:35,040 --> 00:02:38,560
um like three or four years ago we tried

55
00:02:38,560 --> 00:02:40,720
to connect the apd37

56
00:02:40,720 --> 00:02:44,319
with the public known kimsuki with the

57
00:02:44,319 --> 00:02:46,959
shell code we found on they are

58
00:02:46,959 --> 00:02:48,480
identical

59
00:02:48,480 --> 00:02:51,519
however after years of research and

60
00:02:51,519 --> 00:02:55,519
further analysis we think it actually

61
00:02:55,519 --> 00:02:59,120
can be divided this way the kaspersky

62
00:02:59,120 --> 00:03:00,159
kimsuki

63
00:03:00,159 --> 00:03:04,720
in 2013 will be called keep dragon by us

64
00:03:04,720 --> 00:03:07,920
and the public known kimsuki

65
00:03:07,920 --> 00:03:10,319
is the character of today the clown

66
00:03:10,319 --> 00:03:12,720
dragon

67
00:03:13,680 --> 00:03:16,720
so let's see how cloud dragon be a

68
00:03:16,720 --> 00:03:17,680
fisherman

69
00:03:17,680 --> 00:03:20,879
how do they work and how do they perform

70
00:03:20,879 --> 00:03:23,040
their techniques

71
00:03:23,040 --> 00:03:25,519
first we like to talk about their target

72
00:03:25,519 --> 00:03:27,040
scope

73
00:03:27,040 --> 00:03:30,239
in the victims we've observed we found

74
00:03:30,239 --> 00:03:30,959
them

75
00:03:30,959 --> 00:03:34,080
attacking these countries including

76
00:03:34,080 --> 00:03:37,680
south korea united states japan

77
00:03:37,680 --> 00:03:40,720
and some countries in the europe region

78
00:03:40,720 --> 00:03:43,360
and of course for their target in the

79
00:03:43,360 --> 00:03:44,560
industry

80
00:03:44,560 --> 00:03:48,239
they like to attack like government

81
00:03:48,239 --> 00:03:49,360
agencies

82
00:03:49,360 --> 00:03:52,640
research institutes military financial

83
00:03:52,640 --> 00:03:53,840
structure

84
00:03:53,840 --> 00:03:56,959
and high-tech companies or aerospace and

85
00:03:56,959 --> 00:03:58,799
energy

86
00:03:58,799 --> 00:04:00,400
there are actually other service

87
00:04:00,400 --> 00:04:02,720
providers being abused

88
00:04:02,720 --> 00:04:05,599
including those that are large the

89
00:04:05,599 --> 00:04:06,560
largest one

90
00:04:06,560 --> 00:04:09,920
in south korea like daum and never

91
00:04:09,920 --> 00:04:12,879
and others are being used widely in

92
00:04:12,879 --> 00:04:14,080
other countries

93
00:04:14,080 --> 00:04:17,918
like outlook.com or gmail

94
00:04:17,918 --> 00:04:21,279
um these are the official sites of uh

95
00:04:21,279 --> 00:04:25,360
the uh largest web portal of south korea

96
00:04:25,360 --> 00:04:28,479
the dom and neighbor take a deeper

97
00:04:28,479 --> 00:04:32,080
look at the domain name of the site

98
00:04:32,080 --> 00:04:35,120
because we are too sure um

99
00:04:35,120 --> 00:04:38,400
the registered ones but since uh not all

100
00:04:38,400 --> 00:04:40,720
of you are from south korea so might not

101
00:04:40,720 --> 00:04:41,600
be so

102
00:04:41,600 --> 00:04:44,880
um familiar with their domain so we have

103
00:04:44,880 --> 00:04:46,240
the real one

104
00:04:46,240 --> 00:04:49,840
the spelling on the right and

105
00:04:49,840 --> 00:04:53,040
as you can see this is what the actors

106
00:04:53,040 --> 00:04:56,400
register instead of neighbor they

107
00:04:56,400 --> 00:04:59,919
register no more and for sure

108
00:04:59,919 --> 00:05:02,960
down in another way

109
00:05:02,960 --> 00:05:08,160
and gmail and since we all know gmail so

110
00:05:08,160 --> 00:05:11,440
that's what they register

111
00:05:11,440 --> 00:05:14,240
so as you can see there are a lot of

112
00:05:14,240 --> 00:05:15,039
domains

113
00:05:15,039 --> 00:05:17,440
uh that we can categorize into four

114
00:05:17,440 --> 00:05:18,720
different groups

115
00:05:18,720 --> 00:05:22,000
of course there are others but basically

116
00:05:22,000 --> 00:05:25,919
there are four groups including neighbor

117
00:05:25,919 --> 00:05:28,960
down microsoft the outlook

118
00:05:28,960 --> 00:05:33,199
and google so how do they actually works

119
00:05:33,199 --> 00:05:36,720
how do they um access the how do they

120
00:05:36,720 --> 00:05:40,400
attack the victims um this is the

121
00:05:40,400 --> 00:05:43,600
this is how it works first they will

122
00:05:43,600 --> 00:05:44,639
attend the

123
00:05:44,639 --> 00:05:48,080
accounts access then

124
00:05:48,080 --> 00:05:50,960
they will retrieve the contacts in the

125
00:05:50,960 --> 00:05:52,000
accounts

126
00:05:52,000 --> 00:05:56,080
and send vision emails to these contacts

127
00:05:56,080 --> 00:05:58,319
since they are sending fashion emails

128
00:05:58,319 --> 00:05:59,600
that could be

129
00:05:59,600 --> 00:06:02,639
again they can attend more

130
00:06:02,639 --> 00:06:06,080
access to different accounts in other

131
00:06:06,080 --> 00:06:09,280
words this is how it works uh

132
00:06:09,280 --> 00:06:12,319
from the vision email if we assume

133
00:06:12,319 --> 00:06:15,280
one can bring another two different

134
00:06:15,280 --> 00:06:16,960
email accounts

135
00:06:16,960 --> 00:06:20,160
then the more you will uh

136
00:06:20,160 --> 00:06:23,520
impact so at the very end

137
00:06:23,520 --> 00:06:26,080
it will be thousands of email accounts

138
00:06:26,080 --> 00:06:27,280
being abused

139
00:06:27,280 --> 00:06:31,199
or being accessed but how does this

140
00:06:31,199 --> 00:06:35,840
how does these all these work

141
00:06:36,160 --> 00:06:39,199
i'm going to introduce their delivery

142
00:06:39,199 --> 00:06:40,639
method

143
00:06:40,639 --> 00:06:43,280
are there many have two ways to send

144
00:06:43,280 --> 00:06:44,639
vision email

145
00:06:44,639 --> 00:06:48,960
php mailer and send grid

146
00:06:48,960 --> 00:06:52,360
the first is php mailer

147
00:06:52,360 --> 00:06:57,280
php miller is an open source project

148
00:06:57,280 --> 00:07:00,479
it is a powerful php library

149
00:07:00,479 --> 00:07:03,840
developer can easily send email with php

150
00:07:03,840 --> 00:07:04,880
mailer

151
00:07:04,880 --> 00:07:08,400
it's supported authentication methods

152
00:07:08,400 --> 00:07:11,520
such as plan tls or

153
00:07:11,520 --> 00:07:15,599
os and etc it can also

154
00:07:15,599 --> 00:07:18,639
attach file uh to attach like

155
00:07:18,639 --> 00:07:22,240
a decoy or some model

156
00:07:22,240 --> 00:07:25,280
using phd mailer send a large

157
00:07:25,280 --> 00:07:30,000
number of email is not a difficult thing

158
00:07:30,000 --> 00:07:33,199
if the actor sent from compromise

159
00:07:33,199 --> 00:07:36,240
site the sender ip will not be

160
00:07:36,240 --> 00:07:39,120
able to check

161
00:07:40,080 --> 00:07:43,599
this is an open directory on call dragon

162
00:07:43,599 --> 00:07:47,599
c2 we can see phpmailer

163
00:07:47,599 --> 00:07:50,960
folder here i sort all the open

164
00:07:50,960 --> 00:07:54,799
directory into factory below

165
00:07:55,599 --> 00:07:59,280
there is a html release

166
00:07:59,280 --> 00:08:04,240
package here under the module folder

167
00:08:04,240 --> 00:08:09,520
the version of psg mailer is 6.0.7

168
00:08:09,520 --> 00:08:12,840
which was released in

169
00:08:12,840 --> 00:08:16,080
2019 with summers

170
00:08:16,080 --> 00:08:20,720
they use this method for a long time

171
00:08:20,720 --> 00:08:24,560
this test.py

172
00:08:24,560 --> 00:08:28,160
is a email list for testing

173
00:08:28,160 --> 00:08:31,599
those email in this file may be the

174
00:08:31,599 --> 00:08:35,919
actor's email this dot py

175
00:08:35,919 --> 00:08:40,760
is the email list of target

176
00:08:40,760 --> 00:08:44,000
mailer.php is the main program

177
00:08:44,000 --> 00:08:48,720
which send email by using query screen

178
00:08:48,720 --> 00:08:52,839
it can say email to a super 50

179
00:08:52,839 --> 00:08:56,000
email but the content

180
00:08:56,000 --> 00:08:59,519
of mailer.php

181
00:08:59,519 --> 00:09:04,560
can be observed in open directory

182
00:09:04,560 --> 00:09:07,839
final is sender.py

183
00:09:07,839 --> 00:09:11,279
this read the list of mail and make

184
00:09:11,279 --> 00:09:13,839
requests

185
00:09:14,880 --> 00:09:19,360
this is the content of standard rpy

186
00:09:19,360 --> 00:09:22,560
there is three arguments in the send

187
00:09:22,560 --> 00:09:25,680
mail function to email

188
00:09:25,680 --> 00:09:28,959
to gmail and avatar

189
00:09:28,959 --> 00:09:32,640
uil we summarize this is

190
00:09:32,640 --> 00:09:36,560
an operation which affects account

191
00:09:36,560 --> 00:09:41,200
irregular active detect of google

192
00:09:41,200 --> 00:09:44,959
the email will send the backup email

193
00:09:44,959 --> 00:09:49,599
of target with a vision link

194
00:09:49,760 --> 00:09:53,040
the wolf law is shown us below

195
00:09:53,040 --> 00:09:56,080
center dot py with this dot py

196
00:09:56,080 --> 00:10:00,120
and make requests to mailer.php

197
00:10:00,120 --> 00:10:04,480
miller.psp will use php miller library

198
00:10:04,480 --> 00:10:05,440
to send

199
00:10:05,440 --> 00:10:09,680
phishing email to target

200
00:10:10,959 --> 00:10:15,360
except open directory we also discover

201
00:10:15,360 --> 00:10:18,640
the footprint of php mailer from

202
00:10:18,640 --> 00:10:19,600
victim's

203
00:10:19,600 --> 00:10:22,880
email you can see that

204
00:10:22,880 --> 00:10:26,480
cloud dragon uses a fax center email

205
00:10:26,480 --> 00:10:29,440
in phishing

206
00:10:31,360 --> 00:10:35,440
the second delivery method is sand grid

207
00:10:35,440 --> 00:10:40,000
sangri is a email delivered service

208
00:10:40,000 --> 00:10:44,800
you can send 100 email per day for free

209
00:10:44,800 --> 00:10:48,000
if the poll loves program language

210
00:10:48,000 --> 00:10:52,240
php is no exception

211
00:10:53,200 --> 00:10:58,000
here is another open directory case

212
00:10:58,560 --> 00:11:01,920
the architecture is similar to previous

213
00:11:01,920 --> 00:11:03,120
one

214
00:11:03,120 --> 00:11:06,399
the main phishing program is under

215
00:11:06,399 --> 00:11:11,440
ch folder transform.jp

216
00:11:11,440 --> 00:11:15,920
is the main program to send email

217
00:11:15,920 --> 00:11:19,680
on the sending the3 dot py

218
00:11:19,680 --> 00:11:22,959
is a script to make requests

219
00:11:22,959 --> 00:11:26,320
the one dot txt

220
00:11:26,320 --> 00:11:30,720
is the target list and

221
00:11:30,720 --> 00:11:34,320
curity d1 the pp

222
00:11:34,320 --> 00:11:37,279
is its log

223
00:11:37,680 --> 00:11:41,440
you can see here is a enc url

224
00:11:41,440 --> 00:11:45,600
dot php is used to include the private

225
00:11:45,600 --> 00:11:47,680
screen

226
00:11:47,680 --> 00:11:51,040
of the link the detail of

227
00:11:51,040 --> 00:11:54,839
encrypt url will be discussed in next

228
00:11:54,839 --> 00:11:56,240
part

229
00:11:56,240 --> 00:11:59,279
final is the release package

230
00:11:59,279 --> 00:12:04,000
of sen wheat from its changelog

231
00:12:04,000 --> 00:12:07,440
its version is 7.3.0

232
00:12:07,440 --> 00:12:11,320
which is released in

233
00:12:11,320 --> 00:12:14,320
2019

234
00:12:16,399 --> 00:12:19,720
this is the content of transform

235
00:12:19,720 --> 00:12:23,440
v3.py it's released

236
00:12:23,440 --> 00:12:27,519
here and make requests here

237
00:12:27,519 --> 00:12:30,560
uh okay uh you can see the actor didn't

238
00:12:30,560 --> 00:12:34,000
forget to make a look

239
00:12:35,440 --> 00:12:39,040
the wolf law is shown here

240
00:12:39,040 --> 00:12:43,399
transform v3 dot py with

241
00:12:43,399 --> 00:12:46,639
z1.dst and make requests

242
00:12:46,639 --> 00:12:49,839
to the standing php

243
00:12:49,839 --> 00:12:53,680
file and the trend phone dot php

244
00:12:53,680 --> 00:12:57,040
include query string by your enc

245
00:12:57,040 --> 00:13:00,079
url and

246
00:13:00,079 --> 00:13:03,440
send the email by your

247
00:13:03,440 --> 00:13:07,839
send with service

248
00:13:08,880 --> 00:13:12,399
from a real vision email we can see

249
00:13:12,399 --> 00:13:17,680
sync with info in the email header

250
00:13:17,680 --> 00:13:23,040
here is the sangri and here sangrit

251
00:13:24,240 --> 00:13:27,519
from previous two cats we can know

252
00:13:27,519 --> 00:13:31,920
cloud dragon is good at python and php

253
00:13:31,920 --> 00:13:34,880
there are stronger rating but not good

254
00:13:34,880 --> 00:13:37,040
at bloating

255
00:13:37,040 --> 00:13:40,160
in order to execute php

256
00:13:40,160 --> 00:13:43,519
code they put all related code

257
00:13:43,519 --> 00:13:47,519
to web service and let's call

258
00:13:47,519 --> 00:13:51,519
because the code be leaked

259
00:13:53,199 --> 00:13:57,040
the next part is the evolution of

260
00:13:57,040 --> 00:14:00,720
vision we will ensure deals three types

261
00:14:00,720 --> 00:14:01,040
of

262
00:14:01,040 --> 00:14:04,240
fission let's see how to be a big

263
00:14:04,240 --> 00:14:06,880
fisherman

264
00:14:08,000 --> 00:14:11,680
first of all i'm going to introduce

265
00:14:11,680 --> 00:14:15,120
traditional fishing method this is a

266
00:14:15,120 --> 00:14:16,800
real fishing site

267
00:14:16,800 --> 00:14:20,079
obtained in 2019

268
00:14:20,079 --> 00:14:24,079
the page is very similar to the real one

269
00:14:24,079 --> 00:14:27,279
but there is a bug because

270
00:14:27,279 --> 00:14:30,959
in the real website there should be

271
00:14:30,959 --> 00:14:35,279
a an advertisement on the right side

272
00:14:35,279 --> 00:14:39,600
but if you are the user of adblock

273
00:14:39,600 --> 00:14:44,800
you may not find this bug

274
00:14:44,800 --> 00:14:48,160
okay the query stream of this website

275
00:14:48,160 --> 00:14:51,680
is very simple pyramint and

276
00:14:51,680 --> 00:14:54,800
is used to control different modes

277
00:14:54,800 --> 00:14:57,760
there are four modes here will input

278
00:14:57,760 --> 00:14:59,600
password for my info

279
00:14:59,600 --> 00:15:02,959
and will input password will download

280
00:15:02,959 --> 00:15:03,680
and change

281
00:15:03,680 --> 00:15:06,800
password those are

282
00:15:06,800 --> 00:15:11,120
on the page for fishing

283
00:15:11,120 --> 00:15:15,279
and the pyramid token help

284
00:15:15,279 --> 00:15:19,199
is the best system for encoded

285
00:15:19,199 --> 00:15:21,920
username

286
00:15:23,199 --> 00:15:27,199
the structure is shown as follow

287
00:15:27,199 --> 00:15:31,839
mobile detect wp is a common element

288
00:15:31,839 --> 00:15:35,040
of cloud dragon

289
00:15:35,120 --> 00:15:38,079
it's distinguished mobile phone and

290
00:15:38,079 --> 00:15:40,800
computer user and

291
00:15:40,800 --> 00:15:45,240
lead them to different vision patch

292
00:15:45,240 --> 00:15:48,079
download.js is often used to

293
00:15:48,079 --> 00:15:53,199
show decoy and download something

294
00:15:53,480 --> 00:15:56,480
arrow.php will

295
00:15:56,480 --> 00:15:59,759
appear when the query stream

296
00:15:59,759 --> 00:16:03,199
plus error this is used to

297
00:16:03,199 --> 00:16:07,040
prevent other people from random lists

298
00:16:07,040 --> 00:16:10,079
to the website and discover it

299
00:16:10,079 --> 00:16:13,920
is a vision website

300
00:16:14,160 --> 00:16:17,680
most of the process control

301
00:16:17,680 --> 00:16:23,839
will be implemented in index.php

302
00:16:25,120 --> 00:16:28,240
log is another common element

303
00:16:28,240 --> 00:16:30,880
in cloud dragon's vision site it's used

304
00:16:30,880 --> 00:16:32,000
to lock

305
00:16:32,000 --> 00:16:36,160
a user's behavior and credential

306
00:16:36,160 --> 00:16:40,000
mobile underscore and pc on the score of

307
00:16:40,000 --> 00:16:40,480
the

308
00:16:40,480 --> 00:16:43,839
prefix are the content of vision

309
00:16:43,839 --> 00:16:48,320
mode patch victim data

310
00:16:48,320 --> 00:16:51,440
will be recalled

311
00:16:51,440 --> 00:16:55,920
and stored in the results folder

312
00:16:57,120 --> 00:17:00,959
the wolf flow is shown us below

313
00:17:00,959 --> 00:17:05,679
the entry point is index index.php

314
00:17:05,679 --> 00:17:10,480
if the priority stream pass failed

315
00:17:10,480 --> 00:17:14,720
the error stream will be shown

316
00:17:14,720 --> 00:17:17,839
and if it's past success

317
00:17:17,839 --> 00:17:21,280
it will detect

318
00:17:21,280 --> 00:17:25,119
the display according to the device and

319
00:17:25,119 --> 00:17:27,359
mode

320
00:17:27,359 --> 00:17:30,480
final login credential

321
00:17:30,480 --> 00:17:33,360
are recorded in the result folder

322
00:17:33,360 --> 00:17:34,280
through

323
00:17:34,280 --> 00:17:37,280
dr.php

324
00:17:38,000 --> 00:17:40,080
so we are going to share another

325
00:17:40,080 --> 00:17:41,039
traditional

326
00:17:41,039 --> 00:17:44,080
phishing case i know most of you might

327
00:17:44,080 --> 00:17:46,320
lose your patients think that why are

328
00:17:46,320 --> 00:17:48,320
you always talking about the traditional

329
00:17:48,320 --> 00:17:49,919
one instead of talking about the

330
00:17:49,919 --> 00:17:52,160
evolution and new things

331
00:17:52,160 --> 00:17:54,480
because there's still something new

332
00:17:54,480 --> 00:17:56,799
compared to the previous case

333
00:17:56,799 --> 00:17:59,520
so we are still going to share and to

334
00:17:59,520 --> 00:18:00,080
talk about

335
00:18:00,080 --> 00:18:03,120
it in this case they are trying to

336
00:18:03,120 --> 00:18:03,760
target

337
00:18:03,760 --> 00:18:08,000
the apple user so as you can see

338
00:18:08,000 --> 00:18:10,559
the first string is is as well very

339
00:18:10,559 --> 00:18:11,440
simple

340
00:18:11,440 --> 00:18:14,160
but there are some difference including

341
00:18:14,160 --> 00:18:15,280
the first one

342
00:18:15,280 --> 00:18:18,320
the perimeter m is missing

343
00:18:18,320 --> 00:18:21,280
why what does that mean that means that

344
00:18:21,280 --> 00:18:22,720
they are not creating

345
00:18:22,720 --> 00:18:26,000
other a different vision mode and what's

346
00:18:26,000 --> 00:18:28,720
the reason behind we think there

347
00:18:28,720 --> 00:18:31,440
there might be two um two possible

348
00:18:31,440 --> 00:18:32,480
reasons

349
00:18:32,480 --> 00:18:35,760
including um perhaps that that is the

350
00:18:35,760 --> 00:18:37,679
only apple login page

351
00:18:37,679 --> 00:18:41,280
it has or the actors

352
00:18:41,280 --> 00:18:44,400
were just too tired to create other

353
00:18:44,400 --> 00:18:48,000
mode and there's another new uh

354
00:18:48,000 --> 00:18:50,160
parameter called last

355
00:18:50,160 --> 00:18:53,679
it means the index of the exits page

356
00:18:53,679 --> 00:18:56,480
that will be redirected after the user

357
00:18:56,480 --> 00:18:58,960
login

358
00:19:00,799 --> 00:19:03,600
as you can see the website structure is

359
00:19:03,600 --> 00:19:05,200
actually similar to the

360
00:19:05,200 --> 00:19:09,200
previous one but please look at the

361
00:19:09,200 --> 00:19:12,240
the first line in the very top um

362
00:19:12,240 --> 00:19:16,240
there is a decoy document in this

363
00:19:16,240 --> 00:19:19,440
oh in this case

364
00:19:19,440 --> 00:19:21,440
and there are two other things to be

365
00:19:21,440 --> 00:19:23,200
highlighted the first one

366
00:19:23,200 --> 00:19:27,400
is the link php it will jump to

367
00:19:27,400 --> 00:19:28,720
index.ht.php

368
00:19:28,720 --> 00:19:32,320
with a specific query string

369
00:19:32,320 --> 00:19:35,600
and for the pdf php because in in this

370
00:19:35,600 --> 00:19:36,080
case

371
00:19:36,080 --> 00:19:39,280
we have the decode document so this php

372
00:19:39,280 --> 00:19:40,240
will display

373
00:19:40,240 --> 00:19:44,320
the pdf document

374
00:19:44,720 --> 00:19:47,840
and from the decor document uh like we

375
00:19:47,840 --> 00:19:49,039
show here

376
00:19:49,039 --> 00:19:51,320
uh it's obvious they are saying like

377
00:19:51,320 --> 00:19:53,760
2020 a happy new year

378
00:19:53,760 --> 00:19:56,960
so this attack is targeting um

379
00:19:56,960 --> 00:20:01,520
in last year during the new year times

380
00:20:01,520 --> 00:20:04,640
so to a quick wrap-up uh we think that

381
00:20:04,640 --> 00:20:04,960
the

382
00:20:04,960 --> 00:20:08,320
text runs in this way first

383
00:20:08,320 --> 00:20:11,280
the actor might send emails to their

384
00:20:11,280 --> 00:20:12,400
target

385
00:20:12,400 --> 00:20:14,880
and the target the email itself might

386
00:20:14,880 --> 00:20:15,840
contain

387
00:20:15,840 --> 00:20:19,440
either the pdf php or the link

388
00:20:19,440 --> 00:20:22,559
php and both of them will

389
00:20:22,559 --> 00:20:25,919
be redirect to the index.php

390
00:20:25,919 --> 00:20:28,400
which will then trigger the apple login

391
00:20:28,400 --> 00:20:29,280
page

392
00:20:29,280 --> 00:20:32,799
so the victim or the target will see the

393
00:20:32,799 --> 00:20:36,159
the page you see at the very first

394
00:20:36,159 --> 00:20:39,360
and finally uh similar not similar but

395
00:20:39,360 --> 00:20:40,159
the same as

396
00:20:40,159 --> 00:20:43,679
previous one the lock php will

397
00:20:43,679 --> 00:20:46,640
do the same thing it will record the

398
00:20:46,640 --> 00:20:47,600
information

399
00:20:47,600 --> 00:20:51,919
and save them to the folder result

400
00:20:51,919 --> 00:20:57,760
so that is the traditional vision cases

401
00:20:58,960 --> 00:21:01,919
after reviewing a traditional vision

402
00:21:01,919 --> 00:21:03,039
skill

403
00:21:03,039 --> 00:21:06,080
finally we are going to show something

404
00:21:06,080 --> 00:21:07,520
new

405
00:21:07,520 --> 00:21:10,559
first is proxy mirror

406
00:21:10,559 --> 00:21:14,000
it's implemented with ph party

407
00:21:14,000 --> 00:21:17,840
an open source project the advantages

408
00:21:17,840 --> 00:21:20,960
are as follows because the

409
00:21:20,960 --> 00:21:24,720
color get the content of real site

410
00:21:24,720 --> 00:21:28,400
in real time so the fishing page

411
00:21:28,400 --> 00:21:32,559
will update itself and the update cost

412
00:21:32,559 --> 00:21:37,120
of actual is relatively small

413
00:21:37,120 --> 00:21:40,960
php process can easily modify

414
00:21:40,960 --> 00:21:44,400
the content during the

415
00:21:44,400 --> 00:21:47,919
following process another

416
00:21:47,919 --> 00:21:51,520
advantage is different from traditional

417
00:21:51,520 --> 00:21:53,039
fish

418
00:21:53,039 --> 00:21:56,840
proxy mirror is connected to the real

419
00:21:56,840 --> 00:21:58,240
website

420
00:21:58,240 --> 00:22:01,679
therefore the account and password

421
00:22:01,679 --> 00:22:05,200
can be verified i believe

422
00:22:05,200 --> 00:22:08,159
there are a lot of people who forget the

423
00:22:08,159 --> 00:22:09,600
right password

424
00:22:09,600 --> 00:22:13,840
in traditional fishing

425
00:22:15,280 --> 00:22:18,559
next we will use a real cast

426
00:22:18,559 --> 00:22:21,600
to discreet this trick

427
00:22:21,600 --> 00:22:24,720
the phishing email of proxy mirror is

428
00:22:24,720 --> 00:22:25,280
showing

429
00:22:25,280 --> 00:22:28,960
us below the email content

430
00:22:28,960 --> 00:22:33,360
is an abnormal login of account

431
00:22:33,360 --> 00:22:37,039
there is a link with encrypt

432
00:22:37,039 --> 00:22:41,039
query string on the email here is the

433
00:22:41,039 --> 00:22:46,000
encryption first unique

434
00:22:46,240 --> 00:22:49,600
after click link it

435
00:22:49,600 --> 00:22:52,720
redirects to an other vision site

436
00:22:52,720 --> 00:22:55,520
and the current string will be decreased

437
00:22:55,520 --> 00:22:56,000
into

438
00:22:56,000 --> 00:22:58,799
plain text

439
00:23:02,159 --> 00:23:05,600
on the reading above is the link

440
00:23:05,600 --> 00:23:08,799
in the email after

441
00:23:08,799 --> 00:23:12,240
counting to cc one the browser

442
00:23:12,240 --> 00:23:16,080
is with director cc2 and pull the query

443
00:23:16,080 --> 00:23:18,240
string

444
00:23:18,240 --> 00:23:21,360
we can we recall this technique

445
00:23:21,360 --> 00:23:25,520
you are not happy the hopping point

446
00:23:25,520 --> 00:23:29,120
can limited visitor and avoid

447
00:23:29,120 --> 00:23:32,880
be checked most of email scanner

448
00:23:32,880 --> 00:23:36,080
can do dynamic check the

449
00:23:36,080 --> 00:23:39,840
redirect it can only see the hopping

450
00:23:39,840 --> 00:23:40,400
point

451
00:23:40,400 --> 00:23:44,000
cc1 not the real fishing side

452
00:23:44,000 --> 00:23:47,279
cc2 if the hopping point

453
00:23:47,279 --> 00:23:50,480
is down the fishing site

454
00:23:50,480 --> 00:23:54,720
will disappear it makes difficult

455
00:23:54,720 --> 00:23:59,279
to check vision sign for researchers

456
00:24:00,960 --> 00:24:04,400
then see the firing stream of proxy

457
00:24:04,400 --> 00:24:07,919
mirror pyramid patch

458
00:24:07,919 --> 00:24:13,760
is the best symbol encoded username

459
00:24:13,760 --> 00:24:17,679
and parent p is

460
00:24:17,679 --> 00:24:21,360
another press 16 for in code

461
00:24:21,360 --> 00:24:24,720
after decode there are three

462
00:24:24,720 --> 00:24:29,600
field uh split with slash

463
00:24:29,600 --> 00:24:34,320
the first field is are called vip

464
00:24:34,320 --> 00:24:38,000
and the second and third field

465
00:24:38,000 --> 00:24:41,200
will be a fourth digit number

466
00:24:41,200 --> 00:24:44,720
like 101 102

467
00:24:44,720 --> 00:24:49,919
which is the e6 patch index

468
00:24:50,400 --> 00:24:53,679
pair means you is the

469
00:24:53,679 --> 00:25:01,279
proxy target url

470
00:25:01,279 --> 00:25:04,799
so this is uh today's first demo

471
00:25:04,799 --> 00:25:07,919
i'm going to show the proxy mirror this

472
00:25:07,919 --> 00:25:12,000
is the uh vision vision site

473
00:25:12,000 --> 00:25:15,520
built by cloud dragon and it's used

474
00:25:15,520 --> 00:25:19,600
proxy mirror technique so i'm going to

475
00:25:19,600 --> 00:25:22,640
test the process function in

476
00:25:22,640 --> 00:25:26,000
this demo so to test

477
00:25:26,000 --> 00:25:29,840
the function of proxy

478
00:25:29,840 --> 00:25:34,000
i need to change the parameter u

479
00:25:34,000 --> 00:25:37,520
which is the target

480
00:25:37,520 --> 00:25:42,159
of the target of proxy

481
00:25:42,159 --> 00:25:45,520
and i enter the down.net which is

482
00:25:45,520 --> 00:25:48,640
another proto in korea

483
00:25:48,640 --> 00:25:52,000
oh you can see that this

484
00:25:52,000 --> 00:25:55,760
proxy has a redirect function

485
00:25:55,760 --> 00:25:59,440
so even i enter down down

486
00:25:59,440 --> 00:26:03,600
it redirect to www.net

487
00:26:03,600 --> 00:26:06,799
and you can see all of the

488
00:26:06,799 --> 00:26:11,840
html elements are processed

489
00:26:13,120 --> 00:26:16,240
so uh we

490
00:26:16,240 --> 00:26:20,000
entered down and this proceed

491
00:26:20,000 --> 00:26:23,039
work very well all elements are

492
00:26:23,039 --> 00:26:26,400
correct okay so

493
00:26:26,400 --> 00:26:39,840
let's look this demo again

494
00:27:01,919 --> 00:27:06,080
okay so now we know that the process

495
00:27:06,080 --> 00:27:10,559
is work let's see how to use proxy to

496
00:27:10,559 --> 00:27:12,320
fishing

497
00:27:12,320 --> 00:27:15,760
first the proxy will connect to the real

498
00:27:15,760 --> 00:27:16,720
login

499
00:27:16,720 --> 00:27:20,320
page which is number this in this case

500
00:27:20,320 --> 00:27:24,000
and change the login firm

501
00:27:24,000 --> 00:27:27,760
then after the user the victim

502
00:27:27,760 --> 00:27:31,520
stop me the username and password

503
00:27:31,520 --> 00:27:35,200
um the process will send the username

504
00:27:35,200 --> 00:27:38,559
and password to log file

505
00:27:38,559 --> 00:27:42,720
and real site if the response

506
00:27:42,720 --> 00:27:46,840
of real site shows that is login

507
00:27:46,840 --> 00:27:49,120
successful

508
00:27:49,120 --> 00:27:52,720
the username and password will be

509
00:27:52,720 --> 00:27:56,799
sent to confirm.php

510
00:27:56,799 --> 00:28:00,559
this step increases the availability

511
00:28:00,559 --> 00:28:03,840
of vision information

512
00:28:07,760 --> 00:28:11,840
here is an other proximity road demo

513
00:28:11,840 --> 00:28:15,200
i'm going to show on if the

514
00:28:15,200 --> 00:28:18,799
actor get my correct the username and

515
00:28:18,799 --> 00:28:20,799
password how the

516
00:28:20,799 --> 00:28:23,840
vision side work

517
00:28:23,919 --> 00:28:26,000
so the first step i entered a

518
00:28:26,000 --> 00:28:28,960
processimal vision site

519
00:28:28,960 --> 00:28:32,399
and that is my username and i copy my

520
00:28:32,399 --> 00:28:33,840
password from

521
00:28:33,840 --> 00:28:37,039
password management

522
00:28:38,559 --> 00:28:43,279
my password manager and i click submit

523
00:28:43,600 --> 00:28:47,120
okay let's put the video

524
00:28:47,120 --> 00:28:50,799
and we can see here

525
00:28:50,799 --> 00:28:54,480
here on the vision side

526
00:28:54,480 --> 00:28:57,840
send a request to confirm the

527
00:28:57,840 --> 00:29:01,840
and the query string is my username

528
00:29:01,840 --> 00:29:05,199
and password

529
00:29:05,679 --> 00:29:10,080
so um after the phishing site

530
00:29:10,080 --> 00:29:13,200
checklist of a availability

531
00:29:13,200 --> 00:29:16,960
of my account and login success

532
00:29:16,960 --> 00:29:21,440
it will be redirect to the real

533
00:29:21,440 --> 00:29:27,600
the real site which is mail.number.com

534
00:29:27,600 --> 00:29:41,840
let's see this demo again

535
00:30:00,640 --> 00:30:03,679
okay today's final evolution

536
00:30:03,679 --> 00:30:08,240
of vision is vision dot

537
00:30:08,240 --> 00:30:11,600
more and more web service provide

538
00:30:11,600 --> 00:30:14,720
to fact authentication

539
00:30:14,720 --> 00:30:17,760
when user login the system

540
00:30:17,760 --> 00:30:21,679
requires a one-time password

541
00:30:21,679 --> 00:30:25,520
which can receive from some app

542
00:30:25,520 --> 00:30:28,960
or sms

543
00:30:28,960 --> 00:30:32,000
cloud dragon as a professional

544
00:30:32,000 --> 00:30:35,679
fisherman fishing with two fact

545
00:30:35,679 --> 00:30:40,960
authentication is not a difficulty

546
00:30:41,120 --> 00:30:44,960
vision box content two service

547
00:30:44,960 --> 00:30:50,320
fishing website and vision bot

548
00:30:50,320 --> 00:30:55,600
they use objects to communicate with

549
00:30:55,600 --> 00:30:59,919
vision buffs synchronize the operator

550
00:30:59,919 --> 00:31:02,960
browser in the c2 with

551
00:31:02,960 --> 00:31:05,840
selenium

552
00:31:06,960 --> 00:31:12,320
okay so we start from the real case

553
00:31:12,399 --> 00:31:15,679
this is this case is

554
00:31:15,679 --> 00:31:20,159
target service down

555
00:31:22,240 --> 00:31:25,760
the link is the same as proxy mirror is

556
00:31:25,760 --> 00:31:26,320
used

557
00:31:26,320 --> 00:31:30,399
the url hopping technique

558
00:31:30,399 --> 00:31:33,519
so uh the link in email

559
00:31:33,519 --> 00:31:36,640
uh will uh jump to

560
00:31:36,640 --> 00:31:39,600
uh link to the hobby point and redirect

561
00:31:39,600 --> 00:31:41,760
to the vision site

562
00:31:41,760 --> 00:31:44,960
and here uh is the

563
00:31:44,960 --> 00:31:48,320
you send the same key and send iv

564
00:31:48,320 --> 00:31:50,720
value

565
00:31:52,080 --> 00:31:56,159
okay let's see the the query string

566
00:31:56,159 --> 00:32:00,000
the parameter token help

567
00:32:00,000 --> 00:32:03,360
it's the same it's username but this

568
00:32:03,360 --> 00:32:04,080
time

569
00:32:04,080 --> 00:32:09,200
it's belong best 164 encode

570
00:32:09,200 --> 00:32:12,320
parent end is the most

571
00:32:12,320 --> 00:32:17,039
the detailed analysis of more will show

572
00:32:17,039 --> 00:32:21,200
in the next in the next page

573
00:32:21,200 --> 00:32:24,799
and the pyramid last

574
00:32:24,799 --> 00:32:30,000
is the index of this patch

575
00:32:32,000 --> 00:32:35,039
okay so before we introduce

576
00:32:35,039 --> 00:32:38,399
the more patch there are something you

577
00:32:38,399 --> 00:32:39,519
should know

578
00:32:39,519 --> 00:32:43,679
um there are two authentication methods

579
00:32:43,679 --> 00:32:44,159
for

580
00:32:44,159 --> 00:32:48,480
the service and one is down and other

581
00:32:48,480 --> 00:32:51,600
is kakao the login page

582
00:32:51,600 --> 00:32:55,440
of two are different

583
00:32:55,440 --> 00:32:58,720
so the vision box is very smart

584
00:32:58,720 --> 00:33:02,159
vision box will automatically recognize

585
00:33:02,159 --> 00:33:03,200
the type of

586
00:33:03,200 --> 00:33:06,960
account and display different patch

587
00:33:06,960 --> 00:33:10,240
this is the patch of our

588
00:33:10,240 --> 00:33:14,080
vision bus show you can see

589
00:33:14,080 --> 00:33:18,320
it's a simple login page

590
00:33:19,519 --> 00:33:23,200
this is an other mod called login

591
00:33:23,200 --> 00:33:26,799
opt this is the patch for receive

592
00:33:26,799 --> 00:33:30,320
otp call and input the otp

593
00:33:30,320 --> 00:33:33,600
call to the system

594
00:33:33,600 --> 00:33:36,640
different from the real patch this

595
00:33:36,640 --> 00:33:39,679
page is static but

596
00:33:39,679 --> 00:33:42,960
the real side patch will show the phone

597
00:33:42,960 --> 00:33:45,360
number

598
00:33:46,960 --> 00:33:50,399
and next is verify mode

599
00:33:50,399 --> 00:33:53,760
this is to imitate

600
00:33:53,760 --> 00:33:56,799
the user after loki

601
00:33:56,799 --> 00:34:00,240
need to confirm the password

602
00:34:00,240 --> 00:34:02,640
again

603
00:34:05,679 --> 00:34:09,040
and the next one is edit mode

604
00:34:09,040 --> 00:34:12,320
this patch is meaning to check user

605
00:34:12,320 --> 00:34:15,440
into changing their password

606
00:34:15,440 --> 00:34:18,960
and it's presumed

607
00:34:18,960 --> 00:34:22,000
to be matched with the previous verify

608
00:34:22,000 --> 00:34:22,639
mode

609
00:34:22,639 --> 00:34:25,918
to allow to to let victim

610
00:34:25,918 --> 00:34:29,199
to believe it's okay to change the

611
00:34:29,199 --> 00:34:35,520
password here

612
00:34:35,520 --> 00:34:38,879
okay so i'm going to introduce how

613
00:34:38,879 --> 00:34:44,000
fishing bar fishing with two factor

614
00:34:44,239 --> 00:34:48,000
15 with visit vision site

615
00:34:48,000 --> 00:34:51,440
here login page and input his account

616
00:34:51,440 --> 00:34:54,960
and password the vision box will receive

617
00:34:54,960 --> 00:34:58,240
it and open a browser

618
00:34:58,240 --> 00:35:01,520
to the real website and try

619
00:35:01,520 --> 00:35:05,119
use this account and password to docking

620
00:35:05,119 --> 00:35:08,160
after successful noki

621
00:35:08,160 --> 00:35:12,800
the browser will show otp patch now

622
00:35:12,800 --> 00:35:15,839
and after but

623
00:35:15,839 --> 00:35:20,240
disney otp it will redirect

624
00:35:20,240 --> 00:35:23,760
the victim page from login page to otp

625
00:35:23,760 --> 00:35:25,920
patch

626
00:35:25,920 --> 00:35:30,160
the 15 will receive the ocp

627
00:35:30,160 --> 00:35:33,440
call from his mobile

628
00:35:33,440 --> 00:35:39,599
and enter the otp code to the otp patch

629
00:35:39,760 --> 00:35:43,440
the bot will receive the otp code and

630
00:35:43,440 --> 00:35:46,720
immediately input the otp code to the

631
00:35:46,720 --> 00:35:47,839
browser

632
00:35:47,839 --> 00:35:51,440
so now the browser is logging

633
00:35:51,440 --> 00:35:54,960
our company successful

634
00:35:54,960 --> 00:35:58,400
and the bot will redirect the

635
00:35:58,400 --> 00:36:02,640
victim page into the real website

636
00:36:02,640 --> 00:36:05,599
victim cannot identify the logins that

637
00:36:05,599 --> 00:36:06,800
is done by

638
00:36:06,800 --> 00:36:09,599
a vision

639
00:36:10,800 --> 00:36:14,160
this is the final demo today i'm going

640
00:36:14,160 --> 00:36:15,200
to show how

641
00:36:15,200 --> 00:36:18,640
fishing bud work

642
00:36:18,640 --> 00:36:21,520
we obtain the fish bath source code from

643
00:36:21,520 --> 00:36:23,200
open directory

644
00:36:23,200 --> 00:36:27,359
in this demo video the left hand side

645
00:36:27,359 --> 00:36:30,320
will be c to psi and the right hand side

646
00:36:30,320 --> 00:36:33,599
will be big inside

647
00:36:34,000 --> 00:36:37,280
so the first thing is i actually

648
00:36:37,280 --> 00:36:38,560
launched the

649
00:36:38,560 --> 00:36:41,200
fishing boat you can see it's just a

650
00:36:41,200 --> 00:36:42,240
python script

651
00:36:42,240 --> 00:36:46,000
and listen part

652
00:36:46,160 --> 00:36:49,359
and next are in victim side

653
00:36:49,359 --> 00:36:53,200
i within the

654
00:36:53,200 --> 00:36:57,200
fishing website okay

655
00:36:57,200 --> 00:37:00,640
when i when the fishing website

656
00:37:00,640 --> 00:37:04,079
sends account info to

657
00:37:04,079 --> 00:37:07,599
the fishing box the fishing bar open

658
00:37:07,599 --> 00:37:11,760
browser automatically and

659
00:37:11,760 --> 00:37:14,880
the browser is a real

660
00:37:14,880 --> 00:37:19,200
car called patch

661
00:37:19,200 --> 00:37:22,320
and in phishing site i

662
00:37:22,320 --> 00:37:27,520
enter my password and click submit

663
00:37:31,359 --> 00:37:34,800
the box will receive my credential

664
00:37:34,800 --> 00:37:38,240
and fill the account information to the

665
00:37:38,240 --> 00:37:38,800
real

666
00:37:38,800 --> 00:37:43,119
website so now the real website

667
00:37:43,119 --> 00:37:46,720
are just redirect to the uh one

668
00:37:46,720 --> 00:37:50,079
on the otp page and the vision sign

669
00:37:50,079 --> 00:37:54,400
will redirect to but you can see here

670
00:37:54,400 --> 00:37:58,079
the real side has my phone but the fixed

671
00:37:58,079 --> 00:38:04,079
side didn't didn't have

672
00:38:04,079 --> 00:38:08,240
i enter my otp code

673
00:38:08,240 --> 00:38:12,720
received from sns

674
00:38:13,119 --> 00:38:16,800
okay so the bots

675
00:38:16,800 --> 00:38:20,400
just got my otp code and filled

676
00:38:20,400 --> 00:38:25,280
the otp code to the real website

677
00:38:25,280 --> 00:38:29,200
so now uh the phishing part

678
00:38:29,200 --> 00:38:33,280
just control my account now

679
00:38:33,280 --> 00:38:37,359
wow and the victim side

680
00:38:37,359 --> 00:38:42,000
will redirect to the uh real website

681
00:38:42,000 --> 00:38:46,160
uh the other sense that now

682
00:38:46,160 --> 00:38:48,399
wow

683
00:38:51,520 --> 00:38:57,119
i know what you want let's see this demo

684
00:38:58,839 --> 00:39:01,839
again

685
00:40:29,040 --> 00:40:32,880
in the next chapter we will introduce

686
00:40:32,880 --> 00:40:36,480
the malware they used

687
00:40:36,640 --> 00:40:39,440
clone dragon doesn't just send a

688
00:40:39,440 --> 00:40:40,720
phishing email

689
00:40:40,720 --> 00:40:44,480
to get users account cloud dragon also

690
00:40:44,480 --> 00:40:45,359
use

691
00:40:45,359 --> 00:40:49,119
stolen account to send malicious email

692
00:40:49,119 --> 00:40:52,880
this social engineer technique to

693
00:40:52,880 --> 00:40:56,160
let a victim to click the

694
00:40:56,160 --> 00:40:59,359
attached file in the malicious email the

695
00:40:59,359 --> 00:41:00,079
common

696
00:41:00,079 --> 00:41:03,839
malicious file format such as

697
00:41:03,839 --> 00:41:06,960
win pe when installer

698
00:41:06,960 --> 00:41:10,400
wsn script h dot a

699
00:41:10,400 --> 00:41:14,160
hts script macro document and

700
00:41:14,160 --> 00:41:17,760
it's fully hwp

701
00:41:17,760 --> 00:41:20,800
next we will introduce two

702
00:41:20,800 --> 00:41:23,920
well-known malware

703
00:41:23,920 --> 00:41:27,280
of cloud dragon baby shark and

704
00:41:27,280 --> 00:41:29,839
jim buck

705
00:41:30,720 --> 00:41:34,000
in 2019

706
00:41:34,000 --> 00:41:38,000
you need 42 published to baby sharks

707
00:41:38,000 --> 00:41:42,800
reports let's quickly review

708
00:41:42,800 --> 00:41:46,400
the malicious micro document

709
00:41:46,400 --> 00:41:50,480
will download an hta file

710
00:41:50,480 --> 00:41:53,920
and the hta file use

711
00:41:53,920 --> 00:41:57,440
three channel to um

712
00:41:57,440 --> 00:42:00,640
fetch the command

713
00:42:00,839 --> 00:42:06,520
is express.php

714
00:42:06,520 --> 00:42:09,760
upload.php and the

715
00:42:09,760 --> 00:42:13,119
uh c2 uh has a lot of

716
00:42:13,119 --> 00:42:16,720
inquiry payload uh such as

717
00:42:16,720 --> 00:42:20,960
partial format will hq like

718
00:42:20,960 --> 00:42:24,880
uh dir excuse some

719
00:42:24,880 --> 00:42:29,040
program and keylog and other sound

720
00:42:29,040 --> 00:42:32,240
script type backdoor

721
00:42:32,240 --> 00:42:36,000
and moreover on the

722
00:42:36,000 --> 00:42:39,839
back door can be some

723
00:42:39,839 --> 00:42:45,839
pe format executable file

724
00:42:45,839 --> 00:42:48,880
and the way the way to identify baby

725
00:42:48,880 --> 00:42:49,839
shock

726
00:42:49,839 --> 00:42:52,960
is very simple it has

727
00:42:52,960 --> 00:42:56,160
a unique transportation

728
00:42:56,160 --> 00:42:59,359
encryption method the

729
00:42:59,359 --> 00:43:02,880
decrypt function is in

730
00:43:02,880 --> 00:43:06,640
the htf file

731
00:43:06,640 --> 00:43:09,680
okay you can see the decryption function

732
00:43:09,680 --> 00:43:11,680
like this

733
00:43:11,680 --> 00:43:15,920
and the payload download from the c2

734
00:43:15,920 --> 00:43:19,440
will be decrypt to plain text

735
00:43:19,440 --> 00:43:22,560
in hta

736
00:43:25,520 --> 00:43:28,880
in 2020 we find a

737
00:43:28,880 --> 00:43:32,640
new baby shop simple

738
00:43:32,720 --> 00:43:37,440
in the uh maker document

739
00:43:37,440 --> 00:43:40,079
there are two main functions the first

740
00:43:40,079 --> 00:43:40,480
one

741
00:43:40,480 --> 00:43:44,240
is similar to the previous baby shock

742
00:43:44,240 --> 00:43:48,960
it's removed of its macro protection

743
00:43:48,960 --> 00:43:52,960
and the second function is to drop

744
00:43:52,960 --> 00:43:56,480
a vbs file the vbs

745
00:43:56,480 --> 00:44:00,240
file will collect the antivirus inform

746
00:44:00,240 --> 00:44:03,760
and send it back to the c2 through

747
00:44:03,760 --> 00:44:07,359
his php mr mark that

748
00:44:07,359 --> 00:44:10,720
actor collect this information and carry

749
00:44:10,720 --> 00:44:12,000
out the antivirus

750
00:44:12,000 --> 00:44:15,440
testing for the next stage of

751
00:44:15,440 --> 00:44:18,240
the backdoor

752
00:44:19,680 --> 00:44:22,800
and you can see the same encryption

753
00:44:22,800 --> 00:44:23,359
method

754
00:44:23,359 --> 00:44:26,960
still exists but the decryption function

755
00:44:26,960 --> 00:44:29,760
is not used to

756
00:44:29,760 --> 00:44:33,040
to decrease the second stage payload

757
00:44:33,040 --> 00:44:36,800
it is used to decrease the include vb

758
00:44:36,800 --> 00:44:37,680
script

759
00:44:37,680 --> 00:44:40,399
in macro

760
00:44:40,720 --> 00:44:45,119
after decrypt function in the macro

761
00:44:45,119 --> 00:44:48,319
you can see the plain text will be

762
00:44:48,319 --> 00:44:52,480
called and if you look closely

763
00:44:52,480 --> 00:44:56,240
you can find the send decrypt function

764
00:44:56,240 --> 00:44:59,680
inside you need to decree

765
00:44:59,680 --> 00:45:05,119
three times to get the final payload

766
00:45:05,119 --> 00:45:08,560
the next malware is gembak

767
00:45:08,560 --> 00:45:13,359
as known as epoc or auto update

768
00:45:13,359 --> 00:45:18,079
we first thing is in the 2019

769
00:45:18,079 --> 00:45:21,119
and still is still

770
00:45:21,119 --> 00:45:25,520
widely used now dream bug

771
00:45:25,520 --> 00:45:28,720
is the main factor of cloud dragon in

772
00:45:28,720 --> 00:45:29,599
addition to

773
00:45:29,599 --> 00:45:32,800
windows version there's

774
00:45:32,800 --> 00:45:35,920
an android version now here

775
00:45:35,920 --> 00:45:38,720
is the introduce of windows version

776
00:45:38,720 --> 00:45:40,960
dream bug

777
00:45:40,960 --> 00:45:44,160
we can see that

778
00:45:44,400 --> 00:45:47,599
we can see here the two

779
00:45:47,599 --> 00:45:53,440
earlier samples have uh is pdb string

780
00:45:53,440 --> 00:45:56,720
when we discover the first simple

781
00:45:56,720 --> 00:46:00,400
incubation we use the pronunciation

782
00:46:00,400 --> 00:46:03,839
of incubation in korean to name this

783
00:46:03,839 --> 00:46:05,680
malware

784
00:46:05,680 --> 00:46:09,119
later we found an other sample

785
00:46:09,119 --> 00:46:12,800
ah apple seed maybe this bagel

786
00:46:12,800 --> 00:46:17,839
vector should be called utopia

787
00:46:19,920 --> 00:46:23,119
the most common delivery method for

788
00:46:23,119 --> 00:46:24,160
dream bug

789
00:46:24,160 --> 00:46:28,160
is through wsf script

790
00:46:28,160 --> 00:46:32,880
there are two best 64

791
00:46:32,880 --> 00:46:36,160
encoded file in the

792
00:46:36,160 --> 00:46:39,200
script and the script the script

793
00:46:39,200 --> 00:46:43,839
file will decode and drop and execute

794
00:46:45,839 --> 00:46:50,400
the workflow is shown as follow

795
00:46:50,400 --> 00:46:55,040
ws f script drop 2 file

796
00:46:55,040 --> 00:46:59,680
decoy and dreamback the common format of

797
00:46:59,680 --> 00:47:00,720
decoy

798
00:47:00,720 --> 00:47:04,000
is hwp pdf

799
00:47:04,000 --> 00:47:07,200
and office document

800
00:47:07,200 --> 00:47:10,400
gemba will be excused

801
00:47:10,400 --> 00:47:14,640
by reduce server 32

802
00:47:14,640 --> 00:47:17,920
this is because dreambox usually has

803
00:47:17,920 --> 00:47:23,040
an install function dll register server

804
00:47:23,040 --> 00:47:26,400
which is the entry point of radius

805
00:47:26,400 --> 00:47:26,960
server

806
00:47:26,960 --> 00:47:30,800
32 in some version

807
00:47:30,800 --> 00:47:38,079
jumbo will inject into its floor

808
00:47:38,079 --> 00:47:41,680
dreambox will copy it itself

809
00:47:41,680 --> 00:47:45,119
to the windows defender folder

810
00:47:45,119 --> 00:47:48,400
under app data and

811
00:47:48,400 --> 00:47:51,680
rename to auto update

812
00:47:51,680 --> 00:47:54,880
the and set up

813
00:47:54,880 --> 00:48:00,000
a registry to be persistent

814
00:48:02,559 --> 00:48:06,319
in order to avoid anti-virus signature

815
00:48:06,319 --> 00:48:07,359
skin

816
00:48:07,359 --> 00:48:11,040
most of string in jambach

817
00:48:11,040 --> 00:48:14,079
are encrypted

818
00:48:14,800 --> 00:48:17,839
the decryption function is shown

819
00:48:17,839 --> 00:48:21,440
as below i know um it's

820
00:48:21,440 --> 00:48:25,599
a a little bit hard to read

821
00:48:25,599 --> 00:48:30,160
so i prepare a point some version

822
00:48:30,160 --> 00:48:33,200
okay you can see the cipher is

823
00:48:33,200 --> 00:48:36,640
a head string so first uh

824
00:48:36,640 --> 00:48:40,640
convert it back to the byte array

825
00:48:40,640 --> 00:48:44,079
and the header

826
00:48:44,079 --> 00:48:48,240
uh 16 byte under key

827
00:48:48,240 --> 00:48:52,960
and the remaining data is the cipher

828
00:48:52,960 --> 00:48:57,040
and put length into a variance

829
00:48:57,040 --> 00:49:00,079
x or decryption we will

830
00:49:00,079 --> 00:49:04,960
got a we will get the plain text

831
00:49:06,800 --> 00:49:11,119
the decision string is here

832
00:49:11,119 --> 00:49:14,319
is here you can see that they

833
00:49:14,319 --> 00:49:17,680
are all windows api

834
00:49:17,680 --> 00:49:21,280
yes dreambox build its owner

835
00:49:21,280 --> 00:49:24,720
importable when is

836
00:49:24,720 --> 00:49:31,839
when the program is stuck

837
00:49:32,640 --> 00:49:36,160
all of data sent by gembach

838
00:49:36,160 --> 00:49:40,720
are increased by the following algorithm

839
00:49:40,720 --> 00:49:44,160
the data will be compressed

840
00:49:44,160 --> 00:49:47,200
into deep file format

841
00:49:47,200 --> 00:49:50,319
and then it will generate

842
00:49:50,319 --> 00:49:53,599
random bytes of

843
00:49:53,599 --> 00:49:56,640
16 byte key and

844
00:49:56,640 --> 00:50:01,359
doing a xor equation

845
00:50:01,359 --> 00:50:04,400
and after encryption

846
00:50:04,400 --> 00:50:08,720
the data it will calculate

847
00:50:08,720 --> 00:50:12,240
a checksum to put here

848
00:50:12,240 --> 00:50:16,559
and final put a metric header

849
00:50:16,559 --> 00:50:20,400
which is similar to pdf files header

850
00:50:20,400 --> 00:50:27,839
in the beginning

851
00:50:28,000 --> 00:50:31,040
the packages file is shown

852
00:50:31,040 --> 00:50:34,079
as below you can see

853
00:50:34,079 --> 00:50:37,359
the magic header

854
00:50:38,079 --> 00:50:41,119
and the crc checksum

855
00:50:41,119 --> 00:50:44,880
and 16 bytes x4 key

856
00:50:44,880 --> 00:50:48,079
and the encryption data here

857
00:50:48,079 --> 00:50:51,440
so all the upload file

858
00:50:51,440 --> 00:50:57,040
will be this format in dreambug

859
00:50:57,599 --> 00:51:01,280
here is my script to decrypt the

860
00:51:01,280 --> 00:51:04,480
file of course i didn't

861
00:51:04,480 --> 00:51:09,839
verify crc

862
00:51:10,880 --> 00:51:14,319
there are four main comments in dreambug

863
00:51:14,319 --> 00:51:17,440
the command lever you

864
00:51:17,440 --> 00:51:20,559
e eq execute

865
00:51:20,559 --> 00:51:25,079
windows commencio vial

866
00:51:25,079 --> 00:51:28,079
cnd.exe and return the

867
00:51:28,079 --> 00:51:31,760
extrusion result for common one

868
00:51:31,760 --> 00:51:35,760
it will execute a drl using reduce

869
00:51:35,760 --> 00:51:37,359
server 32

870
00:51:37,359 --> 00:51:41,119
for comment 2 it will execute dll

871
00:51:41,119 --> 00:51:44,480
in memory for comment 3

872
00:51:44,480 --> 00:51:47,760
it will upload file which

873
00:51:47,760 --> 00:51:51,839
actual one

874
00:51:53,680 --> 00:51:57,200
in addition to junebus command

875
00:51:57,200 --> 00:52:00,880
there are several functions in gemba

876
00:52:00,880 --> 00:52:06,160
i call it spec function here

877
00:52:07,119 --> 00:52:09,920
there are keyboard monitor screen

878
00:52:09,920 --> 00:52:11,119
monitor

879
00:52:11,119 --> 00:52:15,760
folder monitor and usb monitor

880
00:52:15,760 --> 00:52:18,880
jump up will check whether

881
00:52:18,880 --> 00:52:22,400
this file exists in the

882
00:52:22,400 --> 00:52:25,760
flag folder which is in the work

883
00:52:25,760 --> 00:52:28,960
directory if the file

884
00:52:28,960 --> 00:52:32,400
is it the corresponding

885
00:52:32,400 --> 00:52:36,559
function will be turned on

886
00:52:39,040 --> 00:52:42,160
here is the second function

887
00:52:42,160 --> 00:52:46,400
screen monitor it will take screenshot

888
00:52:46,400 --> 00:52:49,599
and upload it to c2

889
00:52:49,599 --> 00:52:53,520
you can see the essential windows api

890
00:52:53,520 --> 00:52:58,160
ok desktop window here

891
00:52:58,720 --> 00:53:01,839
and the keyboard monitor will recur

892
00:53:01,839 --> 00:53:05,599
keylog and upload it to c2

893
00:53:05,599 --> 00:53:09,040
the spatial key will transduce

894
00:53:09,040 --> 00:53:12,319
specific text like

895
00:53:12,319 --> 00:53:16,000
back tab enter

896
00:53:16,000 --> 00:53:19,280
control and pause

897
00:53:20,800 --> 00:53:24,079
the folder monitor will monitor three

898
00:53:24,079 --> 00:53:25,440
users

899
00:53:25,440 --> 00:53:29,200
border desktop download

900
00:53:29,200 --> 00:53:33,359
and document if there is a new file

901
00:53:33,359 --> 00:53:36,640
in those folder jumbo will

902
00:53:36,640 --> 00:53:43,200
upload it to c2 immediately

903
00:53:43,200 --> 00:53:46,800
the usb monitor will monitor

904
00:53:46,800 --> 00:53:50,640
if there is a remove removable device

905
00:53:50,640 --> 00:53:53,839
plug e if the

906
00:53:53,839 --> 00:53:57,280
device inserts it will

907
00:53:57,280 --> 00:54:01,520
issue a comment dir

908
00:54:01,520 --> 00:54:04,640
slash s

909
00:54:04,640 --> 00:54:07,359
this comment means to list all the

910
00:54:07,359 --> 00:54:09,520
directory and file

911
00:54:09,520 --> 00:54:14,240
under this removable device

912
00:54:14,240 --> 00:54:17,520
and this result

913
00:54:17,520 --> 00:54:21,520
will upload it to c2

914
00:54:21,760 --> 00:54:25,359
in dreambox traffic pattern there are 5

915
00:54:25,359 --> 00:54:26,960
query string

916
00:54:26,960 --> 00:54:30,000
for community with c2

917
00:54:30,000 --> 00:54:33,200
use pyramid and earth mod

918
00:54:33,200 --> 00:54:36,799
identify mod a

919
00:54:36,799 --> 00:54:40,960
pin a heartbeat mod b

920
00:54:40,960 --> 00:54:44,000
upload file to c2

921
00:54:44,000 --> 00:54:49,119
mod c download the coming from c2

922
00:54:49,119 --> 00:54:52,720
mod d dd the comment

923
00:54:52,720 --> 00:54:56,880
on c2 and mod e

924
00:54:56,880 --> 00:55:00,319
it will download the new version

925
00:55:00,319 --> 00:55:07,839
german bug and upgrade itself

926
00:55:08,880 --> 00:55:12,000
so now we are going to make conclusion

927
00:55:12,000 --> 00:55:15,119
we will now give a quick wrap up of what

928
00:55:15,119 --> 00:55:15,520
our

929
00:55:15,520 --> 00:55:19,359
presentation today uh has the first

930
00:55:19,359 --> 00:55:22,319
we talk about the group cloud dragon how

931
00:55:22,319 --> 00:55:24,480
we define the group including its

932
00:55:24,480 --> 00:55:28,319
target scope and the the services

933
00:55:28,319 --> 00:55:31,680
have been abused and the second part

934
00:55:31,680 --> 00:55:34,480
we talked about on their fishing skills

935
00:55:34,480 --> 00:55:35,520
their

936
00:55:35,520 --> 00:55:38,559
advanced and interesting fishing skills

937
00:55:38,559 --> 00:55:41,119
from their delivery method to the

938
00:55:41,119 --> 00:55:42,079
traditional

939
00:55:42,079 --> 00:55:45,839
fishing skills which is similar to

940
00:55:45,839 --> 00:55:46,799
others

941
00:55:46,799 --> 00:55:50,160
and to their two evolution including

942
00:55:50,160 --> 00:55:53,920
proxy mirror and fishing bot

943
00:55:53,920 --> 00:55:56,079
and the very last part we talked about

944
00:55:56,079 --> 00:55:59,440
there uh the mower they've been used

945
00:55:59,440 --> 00:56:02,480
including the the popular one baby shark

946
00:56:02,480 --> 00:56:05,760
um its new findings and a thorough

947
00:56:05,760 --> 00:56:06,720
analysis

948
00:56:06,720 --> 00:56:10,799
on his favorite malware kojimbak

949
00:56:10,799 --> 00:56:14,160
so this is uh the presentation for today

950
00:56:14,160 --> 00:56:16,400
and may you have any kind of question

951
00:56:16,400 --> 00:56:17,920
regarding this group or

952
00:56:17,920 --> 00:56:21,680
any things regarding apt in apac

953
00:56:21,680 --> 00:56:25,200
please feel free to contact us as our

954
00:56:25,200 --> 00:56:31,839
email account thank you

955
00:56:49,680 --> 00:56:51,759
you

