1
00:00:09,280 --> 00:00:11,120
uh welcome to my talk it's called

2
00:00:11,120 --> 00:00:12,880
malicious contracts

3
00:00:12,880 --> 00:00:15,120
and it's uh towards the development of a

4
00:00:15,120 --> 00:00:17,199
fully auto anonymous

5
00:00:17,199 --> 00:00:20,720
smart contract powered rootkit

6
00:00:21,520 --> 00:00:23,760
i'll give a little

7
00:00:23,760 --> 00:00:26,720
so today we'll be talking about

8
00:00:26,720 --> 00:00:29,519
ethereum what are smart contracts

9
00:00:29,519 --> 00:00:32,320
what is a rootkit

10
00:00:32,320 --> 00:00:35,760
the problems with traditional

11
00:00:36,079 --> 00:00:38,480
the problems in attribution with

12
00:00:38,480 --> 00:00:41,360
traditional rootkit approaches

13
00:00:41,360 --> 00:00:44,320
how using a smart contract for rootkit

14
00:00:44,320 --> 00:00:45,360
c2

15
00:00:45,360 --> 00:00:48,559
is a much better way to do that

16
00:00:48,559 --> 00:00:50,719
and provides full anonymity for an

17
00:00:50,719 --> 00:00:52,399
attacker

18
00:00:52,399 --> 00:00:54,239
i'll be giving a little demo and then

19
00:00:54,239 --> 00:00:55,120
we'll be talking a bit about

20
00:00:55,120 --> 00:00:58,120
countermeasures

21
00:00:58,879 --> 00:01:00,800
so about us

22
00:01:00,800 --> 00:01:02,559
um

23
00:01:02,559 --> 00:01:05,760
i'm chris i used to be the uh former cso

24
00:01:05,760 --> 00:01:07,680
of dark matter uh

25
00:01:07,680 --> 00:01:09,840
then i was the cease of karim

26
00:01:09,840 --> 00:01:11,680
and most recently i'm working on a

27
00:01:11,680 --> 00:01:13,920
fintech startup

28
00:01:13,920 --> 00:01:15,360
which is trying to create the citibank

29
00:01:15,360 --> 00:01:16,799
of d5

30
00:01:16,799 --> 00:01:18,720
long story short we're creating a durham

31
00:01:18,720 --> 00:01:20,479
stablecoin

32
00:01:20,479 --> 00:01:22,400
and a merchant acceptance layer around

33
00:01:22,400 --> 00:01:24,640
that

34
00:01:24,880 --> 00:01:26,240
i've been doing a lot of research over

35
00:01:26,240 --> 00:01:27,600
the years in rootkits and rookie

36
00:01:27,600 --> 00:01:29,439
technology

37
00:01:29,439 --> 00:01:30,640
and

38
00:01:30,640 --> 00:01:32,880
many many years ago 2010

39
00:01:32,880 --> 00:01:34,079
just the last time i spoke at a

40
00:01:34,079 --> 00:01:35,200
conference

41
00:01:35,200 --> 00:01:37,119
at defcon 18 i talked about an android

42
00:01:37,119 --> 00:01:38,960
colonel rookit

43
00:01:38,960 --> 00:01:40,159
i was supposed to be joined by

44
00:01:40,159 --> 00:01:41,520
kipriyanova

45
00:01:41,520 --> 00:01:42,640
today

46
00:01:42,640 --> 00:01:45,360
uh unfortunately his pcr expired before

47
00:01:45,360 --> 00:01:47,360
he could board his flights uh and he

48
00:01:47,360 --> 00:01:49,040
won't be able to join us

49
00:01:49,040 --> 00:01:50,560
but he's the chief hacking officer of

50
00:01:50,560 --> 00:01:52,159
panthera labs and a great friend for

51
00:01:52,159 --> 00:01:54,960
many many years now and he was basically

52
00:01:54,960 --> 00:01:57,280
the guy who helped secure

53
00:01:57,280 --> 00:01:59,520
multiple olympic games over over the

54
00:01:59,520 --> 00:02:02,560
years that they were happening

55
00:02:03,280 --> 00:02:05,600
so how many of you here and i i can't

56
00:02:05,600 --> 00:02:07,040
see who's virtually but how many of you

57
00:02:07,040 --> 00:02:08,878
here know what ethereum is maybe show

58
00:02:08,878 --> 00:02:10,160
hands

59
00:02:10,160 --> 00:02:11,038
yeah

60
00:02:11,038 --> 00:02:12,160
awesome

61
00:02:12,160 --> 00:02:13,520
so

62
00:02:13,520 --> 00:02:15,040
it's considered the world's biggest

63
00:02:15,040 --> 00:02:17,920
distributed computer

64
00:02:17,920 --> 00:02:19,120
and

65
00:02:19,120 --> 00:02:21,680
when you run an ethereum client on your

66
00:02:21,680 --> 00:02:22,879
compute on your

67
00:02:22,879 --> 00:02:24,720
ethereum wallet or client on your on

68
00:02:24,720 --> 00:02:26,879
your computer

69
00:02:26,879 --> 00:02:28,879
basically you can access this whole

70
00:02:28,879 --> 00:02:31,760
massive network and

71
00:02:31,760 --> 00:02:35,200
um it's it's a blockchain uh and

72
00:02:35,200 --> 00:02:38,640
unlike prior blockchains like bitcoin

73
00:02:38,640 --> 00:02:41,680
um what made ethereum special is this

74
00:02:41,680 --> 00:02:45,440
this functionality of smart contracts

75
00:02:45,440 --> 00:02:47,599
eth is the native cryptocurrency of the

76
00:02:47,599 --> 00:02:48,640
platform

77
00:02:48,640 --> 00:02:50,319
and if you can if you if you've been

78
00:02:50,319 --> 00:02:51,840
following the markets it's gained quite

79
00:02:51,840 --> 00:02:53,200
some momentum

80
00:02:53,200 --> 00:02:56,720
and is quite valuable these days

81
00:02:58,560 --> 00:02:59,680
so

82
00:02:59,680 --> 00:03:01,519
a smart contract how many of you guys

83
00:03:01,519 --> 00:03:03,280
know what a smart contract is

84
00:03:03,280 --> 00:03:05,120
yeah awesome

85
00:03:05,120 --> 00:03:07,360
so smart contracts run on the ethereum

86
00:03:07,360 --> 00:03:09,760
blockchain and basically it's a program

87
00:03:09,760 --> 00:03:11,100
that

88
00:03:11,100 --> 00:03:12,400
[Music]

89
00:03:12,400 --> 00:03:13,599
just like you have on your normal

90
00:03:13,599 --> 00:03:15,760
computer and you install programs

91
00:03:15,760 --> 00:03:17,760
that those programs only run on your

92
00:03:17,760 --> 00:03:19,200
computer they don't run on other

93
00:03:19,200 --> 00:03:20,720
people's computers they only run on your

94
00:03:20,720 --> 00:03:21,760
computer

95
00:03:21,760 --> 00:03:23,200
in ethereum

96
00:03:23,200 --> 00:03:25,440
uh by deploying a smart contract every

97
00:03:25,440 --> 00:03:26,799
single

98
00:03:26,799 --> 00:03:28,480
node or computer that's connected to the

99
00:03:28,480 --> 00:03:30,640
blockchain suddenly has access to the

100
00:03:30,640 --> 00:03:33,760
same computer or same same sorry same uh

101
00:03:33,760 --> 00:03:35,360
smart contract same program that you

102
00:03:35,360 --> 00:03:36,799
created

103
00:03:36,799 --> 00:03:38,640
um and what's the what's the use of the

104
00:03:38,640 --> 00:03:40,239
smart contract well kind of like the

105
00:03:40,239 --> 00:03:41,440
name kind of gives it away it's a

106
00:03:41,440 --> 00:03:43,280
contract but it's a it's a contract

107
00:03:43,280 --> 00:03:44,879
that's that's

108
00:03:44,879 --> 00:03:46,720
codified by code

109
00:03:46,720 --> 00:03:47,680
so

110
00:03:47,680 --> 00:03:49,760
if we were to take an example of a real

111
00:03:49,760 --> 00:03:51,519
estate transaction where one party wants

112
00:03:51,519 --> 00:03:52,959
to sell a house once a party wants to

113
00:03:52,959 --> 00:03:54,720
buy the house

114
00:03:54,720 --> 00:03:57,040
and there's usually a real estate broker

115
00:03:57,040 --> 00:03:58,879
involved in that transaction and then

116
00:03:58,879 --> 00:04:01,120
there's the land registry who just

117
00:04:01,120 --> 00:04:03,840
swaps the names on the title deed

118
00:04:03,840 --> 00:04:06,239
that's the traditional way of of doing a

119
00:04:06,239 --> 00:04:08,720
contractual

120
00:04:08,720 --> 00:04:09,920
collection

121
00:04:09,920 --> 00:04:12,480
exchange

122
00:04:12,640 --> 00:04:14,239
of course there's lots of inefficiencies

123
00:04:14,239 --> 00:04:15,680
in that process as we all know and are

124
00:04:15,680 --> 00:04:17,279
all aware of

125
00:04:17,279 --> 00:04:19,040
in a smart contract

126
00:04:19,040 --> 00:04:21,918
we basically put the rules of that deal

127
00:04:21,918 --> 00:04:23,759
in code

128
00:04:23,759 --> 00:04:26,400
uh in that case let's say the smart

129
00:04:26,400 --> 00:04:28,160
contract would own the title dude it

130
00:04:28,160 --> 00:04:29,520
would currently be in the owner of the

131
00:04:29,520 --> 00:04:32,240
buyer of the seller sorry

132
00:04:32,240 --> 00:04:33,840
and as soon as the

133
00:04:33,840 --> 00:04:35,440
buyer

134
00:04:35,440 --> 00:04:37,680
sends money to the smart contract the

135
00:04:37,680 --> 00:04:39,680
smart contract will change name on title

136
00:04:39,680 --> 00:04:41,600
d and send it to the buyer

137
00:04:41,600 --> 00:04:43,840
no third parties involved it's all done

138
00:04:43,840 --> 00:04:46,240
autonomously seamlessly

139
00:04:46,240 --> 00:04:48,080
and and very swiftly

140
00:04:48,080 --> 00:04:50,240
so smart contracts that's just one

141
00:04:50,240 --> 00:04:52,240
example of like a transaction that can

142
00:04:52,240 --> 00:04:53,919
be done on smart contract but there's

143
00:04:53,919 --> 00:04:55,280
many other types of transactions that

144
00:04:55,280 --> 00:04:57,280
can be done on smart contracts so you

145
00:04:57,280 --> 00:04:58,880
can create smart contracts that

146
00:04:58,880 --> 00:05:00,479
basically

147
00:05:00,479 --> 00:05:03,360
send value from one person to another

148
00:05:03,360 --> 00:05:05,520
a lot of the cryptocurrency tokens that

149
00:05:05,520 --> 00:05:07,280
you hear about

150
00:05:07,280 --> 00:05:11,039
are running on smart contracts um

151
00:05:11,039 --> 00:05:12,639
so so there's different types of smart

152
00:05:12,639 --> 00:05:14,320
contracts and they

153
00:05:14,320 --> 00:05:15,840
and they're created for different types

154
00:05:15,840 --> 00:05:18,638
of use cases

155
00:05:20,960 --> 00:05:22,240
how many of you guys are familiar with

156
00:05:22,240 --> 00:05:25,120
the rootkit what that is yeah seems like

157
00:05:25,120 --> 00:05:26,880
a few hands here awesome

158
00:05:26,880 --> 00:05:28,320
so

159
00:05:28,320 --> 00:05:30,960
if i'm an attacker and i hack into a box

160
00:05:30,960 --> 00:05:33,120
and i want to stay hidden

161
00:05:33,120 --> 00:05:35,120
then what i'm going to do is i'm going

162
00:05:35,120 --> 00:05:37,120
to install some software on that box it

163
00:05:37,120 --> 00:05:38,720
doesn't matter how i got in but let's

164
00:05:38,720 --> 00:05:40,400
assume i've already got in

165
00:05:40,400 --> 00:05:41,680
i'm going to install some software on

166
00:05:41,680 --> 00:05:43,039
that box that what that what that

167
00:05:43,039 --> 00:05:45,520
software does is it basically has the

168
00:05:45,520 --> 00:05:48,639
attacker's presence on that machine

169
00:05:48,639 --> 00:05:50,960
and there's various ways that attackers

170
00:05:50,960 --> 00:05:53,520
do that one way is they um

171
00:05:53,520 --> 00:05:55,919
let's say you type

172
00:05:55,919 --> 00:05:57,600
you type a directory listing on your

173
00:05:57,600 --> 00:05:58,560
machine

174
00:05:58,560 --> 00:06:00,000
and you see all the good files and all

175
00:06:00,000 --> 00:06:01,840
the bad files that are there

176
00:06:01,840 --> 00:06:03,520
uh if there was no wiki you would see

177
00:06:03,520 --> 00:06:04,960
all the all the good files and all the

178
00:06:04,960 --> 00:06:07,840
bad files but a rootkit can modify the

179
00:06:07,840 --> 00:06:09,280
system so that

180
00:06:09,280 --> 00:06:11,199
you're when you type a directory listing

181
00:06:11,199 --> 00:06:13,120
on your machine you only see the good

182
00:06:13,120 --> 00:06:15,280
files and it hides all the attackers bad

183
00:06:15,280 --> 00:06:17,120
files

184
00:06:17,120 --> 00:06:18,639
and there's different types of rootkits

185
00:06:18,639 --> 00:06:20,240
there's user land root kits that run in

186
00:06:20,240 --> 00:06:21,600
the user land there's kernel level

187
00:06:21,600 --> 00:06:23,680
rookies that run in the kernel

188
00:06:23,680 --> 00:06:25,120
kernel is better because it can be

189
00:06:25,120 --> 00:06:27,600
bypassed very easily

190
00:06:27,600 --> 00:06:31,039
and can be detected very easily

191
00:06:31,039 --> 00:06:32,800
long story shore

192
00:06:32,800 --> 00:06:33,600
a

193
00:06:33,600 --> 00:06:35,280
is basically a malicious program that

194
00:06:35,280 --> 00:06:36,319
runs on a computer that has an

195
00:06:36,319 --> 00:06:39,199
attacker's presence

196
00:06:39,919 --> 00:06:41,600
now

197
00:06:41,600 --> 00:06:43,680
what's the traditional approach

198
00:06:43,680 --> 00:06:46,560
of an attacker accessing the root kit

199
00:06:46,560 --> 00:06:49,120
the machine you see over here

200
00:06:49,120 --> 00:06:51,440
is the target machine the one with the

201
00:06:51,440 --> 00:06:52,880
the virus installed the look it

202
00:06:52,880 --> 00:06:55,280
installed so usually

203
00:06:55,280 --> 00:06:56,240
um

204
00:06:56,240 --> 00:06:58,560
an attacker what they do

205
00:06:58,560 --> 00:07:00,720
is they install a rocket on the machine

206
00:07:00,720 --> 00:07:02,960
and then

207
00:07:03,680 --> 00:07:05,360
it sends commands

208
00:07:05,360 --> 00:07:10,000
back to this to the attacker's jump box

209
00:07:10,319 --> 00:07:11,280
and

210
00:07:11,280 --> 00:07:14,080
and the attacker is able to

211
00:07:14,080 --> 00:07:15,919
control the target machine that they've

212
00:07:15,919 --> 00:07:17,520
compromised

213
00:07:17,520 --> 00:07:19,039
through that intermittent jump box

214
00:07:19,039 --> 00:07:21,440
they've done the reason why an attacker

215
00:07:21,440 --> 00:07:23,199
does not want the root kick connecting

216
00:07:23,199 --> 00:07:25,520
directly back to them to their home ip

217
00:07:25,520 --> 00:07:26,560
address

218
00:07:26,560 --> 00:07:28,560
is is because of attribution

219
00:07:28,560 --> 00:07:30,400
because if somebody knew

220
00:07:30,400 --> 00:07:32,479
that the attackers that the the the

221
00:07:32,479 --> 00:07:34,080
compromise machine is directly attacked

222
00:07:34,080 --> 00:07:35,919
connecting to the attacker they'd be

223
00:07:35,919 --> 00:07:37,759
able to go to the isp and so on and so

224
00:07:37,759 --> 00:07:39,599
forth and basically put the attacker in

225
00:07:39,599 --> 00:07:42,160
jail or get him in trouble

226
00:07:42,160 --> 00:07:44,479
so what attackers do is they

227
00:07:44,479 --> 00:07:45,599
they use

228
00:07:45,599 --> 00:07:48,639
an intermittent jump box to prevent a

229
00:07:48,639 --> 00:07:51,919
direct attribution back to them

230
00:07:51,919 --> 00:07:53,039
now

231
00:07:53,039 --> 00:07:54,639
there's a drawback for the for an

232
00:07:54,639 --> 00:07:57,199
attacker in this approach and the

233
00:07:57,199 --> 00:08:00,160
the drawback is that

234
00:08:00,160 --> 00:08:01,840
the rootkit that you install on the

235
00:08:01,840 --> 00:08:03,120
machine

236
00:08:03,120 --> 00:08:04,960
it needs to know

237
00:08:04,960 --> 00:08:07,680
what what that what that jump box is it

238
00:08:07,680 --> 00:08:09,039
needs to know the ip address of that

239
00:08:09,039 --> 00:08:11,280
jump box it needs to know where to send

240
00:08:11,280 --> 00:08:13,759
that callback connection to

241
00:08:13,759 --> 00:08:15,120
and

242
00:08:15,120 --> 00:08:17,520
our whole industries in cyber security a

243
00:08:17,520 --> 00:08:19,680
lot of the forensics works that we do

244
00:08:19,680 --> 00:08:21,199
when a company calls us and says hey

245
00:08:21,199 --> 00:08:23,360
we've been compromised what we do

246
00:08:23,360 --> 00:08:25,680
is we go to the company we find out that

247
00:08:25,680 --> 00:08:27,360
the server has been compromised we take

248
00:08:27,360 --> 00:08:30,080
out the hard drive we perform a forensic

249
00:08:30,080 --> 00:08:30,960
image

250
00:08:30,960 --> 00:08:32,880
and we try to identify

251
00:08:32,880 --> 00:08:34,880
malicious software on the drive

252
00:08:34,880 --> 00:08:36,320
once we found the malicious software on

253
00:08:36,320 --> 00:08:37,919
the drive it could be a driver it could

254
00:08:37,919 --> 00:08:40,240
be a kernel module it could be a

255
00:08:40,240 --> 00:08:42,000
modified binary that doesn't match the

256
00:08:42,000 --> 00:08:46,320
distributions md5 or sha sums

257
00:08:46,320 --> 00:08:48,399
we then start to look at that specific

258
00:08:48,399 --> 00:08:50,560
binary and we try to reverse engineer it

259
00:08:50,560 --> 00:08:53,600
and the whole point is we try to find

260
00:08:53,600 --> 00:08:56,320
that thing in the middle the jump box

261
00:08:56,320 --> 00:08:57,440
because that's

262
00:08:57,440 --> 00:08:59,200
what tells us where the attacker came

263
00:08:59,200 --> 00:09:01,120
from and based on where the attacker

264
00:09:01,120 --> 00:09:02,560
came from

265
00:09:02,560 --> 00:09:04,399
we can tell

266
00:09:04,399 --> 00:09:06,399
maybe you know which country they're

267
00:09:06,399 --> 00:09:07,680
coming from

268
00:09:07,680 --> 00:09:09,920
what other people or companies have they

269
00:09:09,920 --> 00:09:11,120
attacked

270
00:09:11,120 --> 00:09:14,160
so on and so forth

271
00:09:15,120 --> 00:09:16,800
so

272
00:09:16,800 --> 00:09:19,440
what attackers try to do to prevent that

273
00:09:19,440 --> 00:09:21,120
kind of like

274
00:09:21,120 --> 00:09:23,279
direct attribution back is they add more

275
00:09:23,279 --> 00:09:25,360
intermittent servers so here there's

276
00:09:25,360 --> 00:09:28,080
like two hops between the target server

277
00:09:28,080 --> 00:09:29,600
but it could be ten it could be twenty

278
00:09:29,600 --> 00:09:30,880
could be a hundred

279
00:09:30,880 --> 00:09:32,080
but

280
00:09:32,080 --> 00:09:33,920
that increases the the cost for an

281
00:09:33,920 --> 00:09:36,880
attacker they basically have to go

282
00:09:36,880 --> 00:09:39,920
hack into more servers buy more

283
00:09:39,920 --> 00:09:43,839
vps with bitcoin or whatever they use

284
00:09:43,839 --> 00:09:46,800
and and buy a lot more throwaway servers

285
00:09:46,800 --> 00:09:49,440
in order for them to put in line

286
00:09:49,440 --> 00:09:51,120
between themselves and the target server

287
00:09:51,120 --> 00:09:53,600
to make attribution more difficult

288
00:09:53,600 --> 00:09:54,800
and

289
00:09:54,800 --> 00:09:57,279
attackers get lazy because it's a high

290
00:09:57,279 --> 00:09:59,200
cost for them to replicate and send up

291
00:09:59,200 --> 00:10:01,440
all this infrastructure they tend to

292
00:10:01,440 --> 00:10:03,600
reuse it so they'll use the same

293
00:10:03,600 --> 00:10:05,920
infrastructure to attack

294
00:10:05,920 --> 00:10:07,839
to attack me to attack company a to

295
00:10:07,839 --> 00:10:09,279
attack company b

296
00:10:09,279 --> 00:10:10,800
and a lot of

297
00:10:10,800 --> 00:10:13,040
attribution these days is looking at

298
00:10:13,040 --> 00:10:14,560
shared infrastructure used across

299
00:10:14,560 --> 00:10:16,959
various attacker groups

300
00:10:16,959 --> 00:10:18,640
there's a case here with microsoft

301
00:10:18,640 --> 00:10:20,959
they're saying uh what tracking attacker

302
00:10:20,959 --> 00:10:22,399
email infrastructure tells us about

303
00:10:22,399 --> 00:10:23,920
persistent criminal operations for

304
00:10:23,920 --> 00:10:26,640
example this is a well-defined thing in

305
00:10:26,640 --> 00:10:29,200
forensics and incident response

306
00:10:29,200 --> 00:10:30,560
whereby you look at the shared

307
00:10:30,560 --> 00:10:32,959
infrastructure that attackers use across

308
00:10:32,959 --> 00:10:34,240
campaigns

309
00:10:34,240 --> 00:10:36,399
you look at the md5 hashes the binaries

310
00:10:36,399 --> 00:10:37,600
and so on and so forth and see where

311
00:10:37,600 --> 00:10:39,600
these things have been shared

312
00:10:39,600 --> 00:10:42,640
and used in other attacks

313
00:10:42,640 --> 00:10:43,440
so

314
00:10:43,440 --> 00:10:45,200
these are the drawbacks this is this is

315
00:10:45,200 --> 00:10:47,279
how attackers currently try to solve the

316
00:10:47,279 --> 00:10:48,560
problem

317
00:10:48,560 --> 00:10:51,839
but what if there was a better solution

318
00:10:51,839 --> 00:10:52,880
and

319
00:10:52,880 --> 00:10:54,720
this is where we start talking about

320
00:10:54,720 --> 00:10:56,720
blockchain and you know you're going to

321
00:10:56,720 --> 00:10:58,480
say this is a really weird thing to do

322
00:10:58,480 --> 00:11:01,120
how does blockchain help us with c2

323
00:11:01,120 --> 00:11:02,720
infrastructure well i'll kind of tell

324
00:11:02,720 --> 00:11:04,800
you how

325
00:11:04,800 --> 00:11:06,959
well

326
00:11:08,640 --> 00:11:11,120
when when we create a transaction on a

327
00:11:11,120 --> 00:11:12,240
blockchain doesn't matter which

328
00:11:12,240 --> 00:11:15,360
blockchain you use when you communicate

329
00:11:15,360 --> 00:11:17,839
with a blockchain or a smart contract

330
00:11:17,839 --> 00:11:19,440
all your communication with that smart

331
00:11:19,440 --> 00:11:20,959
contract and that blockchain is

332
00:11:20,959 --> 00:11:22,480
completely anonymous

333
00:11:22,480 --> 00:11:24,640
nobody logs your ip address nobody logs

334
00:11:24,640 --> 00:11:26,800
your

335
00:11:27,200 --> 00:11:30,240
your username nobody logs uh

336
00:11:30,240 --> 00:11:32,640
your browser identity and every blogs

337
00:11:32,640 --> 00:11:34,720
logs absolutely anything when you

338
00:11:34,720 --> 00:11:36,720
interact with a smart contract

339
00:11:36,720 --> 00:11:38,720
there's nothing there that anybody can

340
00:11:38,720 --> 00:11:41,760
tell that is directly related to you and

341
00:11:41,760 --> 00:11:44,079
nobody knows who created a specific

342
00:11:44,079 --> 00:11:46,640
smart contract who who sent

343
00:11:46,640 --> 00:11:48,320
who what's the real identity between

344
00:11:48,320 --> 00:11:51,360
person a and person b

345
00:11:52,240 --> 00:11:54,560
this is what you see

346
00:11:54,560 --> 00:11:56,800
when you interact with a smart contract

347
00:11:56,800 --> 00:11:58,800
or you send value from one person to

348
00:11:58,800 --> 00:12:01,040
another person over in a third network

349
00:12:01,040 --> 00:12:04,160
or any other network what you see is

350
00:12:04,160 --> 00:12:06,000
from

351
00:12:06,000 --> 00:12:08,000
this address

352
00:12:08,000 --> 00:12:10,800
to this address these are public key

353
00:12:10,800 --> 00:12:13,680
wallets these are

354
00:12:13,680 --> 00:12:16,320
ethereum addresses in this case we're

355
00:12:16,320 --> 00:12:18,240
using another protocol called matic

356
00:12:18,240 --> 00:12:20,399
polygon

357
00:12:20,399 --> 00:12:21,920
but that's literally all you see and

358
00:12:21,920 --> 00:12:23,600
that doesn't tell you much

359
00:12:23,600 --> 00:12:25,839
you can't geo-locate that you don't know

360
00:12:25,839 --> 00:12:27,839
where it's coming from

361
00:12:27,839 --> 00:12:30,240
and you can't really tell um what's

362
00:12:30,240 --> 00:12:32,399
happened there well you can't tell that

363
00:12:32,399 --> 00:12:34,240
value went from person a to person b but

364
00:12:34,240 --> 00:12:35,920
you can't really tell

365
00:12:35,920 --> 00:12:39,560
who's behind it

366
00:12:40,800 --> 00:12:42,560
and

367
00:12:42,560 --> 00:12:44,480
now

368
00:12:44,480 --> 00:12:46,000
there's

369
00:12:46,000 --> 00:12:48,320
there's ways you can actually and what

370
00:12:48,320 --> 00:12:50,240
i'm saying is not entirely correct

371
00:12:50,240 --> 00:12:52,480
so there's ways you can you can't find

372
00:12:52,480 --> 00:12:54,800
who's behind it and that's only if the

373
00:12:54,800 --> 00:12:56,720
attacker is not very smart

374
00:12:56,720 --> 00:12:58,399
but i'll tell you how they can be a bit

375
00:12:58,399 --> 00:12:59,600
smarter

376
00:12:59,600 --> 00:13:02,399
and the way you can tell is by using uh

377
00:13:02,399 --> 00:13:04,480
what are called on-chain tools

378
00:13:04,480 --> 00:13:06,880
like chain analysis so because

379
00:13:06,880 --> 00:13:09,440
everything on the blockchain is recorded

380
00:13:09,440 --> 00:13:11,519
you could basically start from the

381
00:13:11,519 --> 00:13:12,800
origin

382
00:13:12,800 --> 00:13:14,560
and work your way through the previous

383
00:13:14,560 --> 00:13:15,920
transactions

384
00:13:15,920 --> 00:13:18,720
eventually figuring out where this guy

385
00:13:18,720 --> 00:13:21,040
got his original bitcoin from or his

386
00:13:21,040 --> 00:13:23,040
original ethereum from and that's

387
00:13:23,040 --> 00:13:24,000
usually

388
00:13:24,000 --> 00:13:25,519
on exchange

389
00:13:25,519 --> 00:13:27,519
and there's a lot of blockchain forensic

390
00:13:27,519 --> 00:13:28,720
firms

391
00:13:28,720 --> 00:13:31,519
spacing up these days that make a huge

392
00:13:31,519 --> 00:13:33,440
business out of tracing transactions

393
00:13:33,440 --> 00:13:34,480
like this

394
00:13:34,480 --> 00:13:36,399
and one of the key use cases is for

395
00:13:36,399 --> 00:13:40,320
track uh tracking uh elict money flows

396
00:13:40,320 --> 00:13:41,519
uh

397
00:13:41,519 --> 00:13:43,839
for example when there was the case was

398
00:13:43,839 --> 00:13:46,959
silk road many many years ago ago which

399
00:13:46,959 --> 00:13:50,639
was a narcotics marketplace a lot of the

400
00:13:50,639 --> 00:13:52,959
floors the elite flows that and where

401
00:13:52,959 --> 00:13:55,279
these funds eventually ended up to and

402
00:13:55,279 --> 00:13:57,680
who was behind secret

403
00:13:57,680 --> 00:14:00,320
this type of analysis was used

404
00:14:00,320 --> 00:14:01,519
however

405
00:14:01,519 --> 00:14:03,680
there's ways you can

406
00:14:03,680 --> 00:14:06,560
obfuscate your your traces

407
00:14:06,560 --> 00:14:08,320
and so long as you don't buy your

408
00:14:08,320 --> 00:14:10,240
bitcoin from an exchange which allow

409
00:14:10,240 --> 00:14:12,000
which asks you to provide your kyc

410
00:14:12,000 --> 00:14:13,519
documents

411
00:14:13,519 --> 00:14:15,760
and one is using mixers which confuse

412
00:14:15,760 --> 00:14:18,160
the transactions and shuffle them across

413
00:14:18,160 --> 00:14:19,440
many others

414
00:14:19,440 --> 00:14:21,120
it's very akin to money laundering

415
00:14:21,120 --> 00:14:22,480
something like that

416
00:14:22,480 --> 00:14:23,920
another

417
00:14:23,920 --> 00:14:26,480
use case is where you can use

418
00:14:26,480 --> 00:14:28,639
testnet coins

419
00:14:28,639 --> 00:14:30,560
you can still interact with a blockchain

420
00:14:30,560 --> 00:14:33,120
on a different network uh testnet

421
00:14:33,120 --> 00:14:35,279
network and a test net network is

422
00:14:35,279 --> 00:14:37,360
basically the exact same it's think

423
00:14:37,360 --> 00:14:38,880
about it as a

424
00:14:38,880 --> 00:14:40,880
as a uat testing network it's not the

425
00:14:40,880 --> 00:14:42,160
production network because the uat

426
00:14:42,160 --> 00:14:43,519
testing network

427
00:14:43,519 --> 00:14:45,519
so you can use like the uat testing

428
00:14:45,519 --> 00:14:47,839
network with testnet coins

429
00:14:47,839 --> 00:14:50,800
and they're services that give you free

430
00:14:50,800 --> 00:14:53,199
test net coins in order to deploy

431
00:14:53,199 --> 00:14:55,279
contracts with and because you're not

432
00:14:55,279 --> 00:14:56,560
getting them from any exchange you're

433
00:14:56,560 --> 00:14:59,120
not getting them for any public sources

434
00:14:59,120 --> 00:15:01,680
and it's all in single use specifically

435
00:15:01,680 --> 00:15:03,920
for this pursuit of creating this

436
00:15:03,920 --> 00:15:06,800
anonymous infrastructure

437
00:15:06,800 --> 00:15:10,800
you can remain undetected

438
00:15:11,680 --> 00:15:13,600
so

439
00:15:13,600 --> 00:15:15,120
what you see here is a little smart

440
00:15:15,120 --> 00:15:16,800
contract i created

441
00:15:16,800 --> 00:15:18,160
are any of you guys familiar smart

442
00:15:18,160 --> 00:15:19,760
contract programming

443
00:15:19,760 --> 00:15:22,000
yeah cool

444
00:15:22,000 --> 00:15:23,760
there's a few smart contract programming

445
00:15:23,760 --> 00:15:25,360
languages there's something called

446
00:15:25,360 --> 00:15:27,680
solidity which is the normal one there's

447
00:15:27,680 --> 00:15:30,719
something called uh

448
00:15:30,800 --> 00:15:32,560
viper which is what i've used here viper

449
00:15:32,560 --> 00:15:34,800
is pythonic it uses like a python type

450
00:15:34,800 --> 00:15:36,959
like syntax it's not really python but

451
00:15:36,959 --> 00:15:39,759
it kind of looks like python

452
00:15:39,759 --> 00:15:41,920
what this smart contract does is

453
00:15:41,920 --> 00:15:44,000
absolutely looks very innocent like if

454
00:15:44,000 --> 00:15:46,240
anybody's if like a cyber security guy

455
00:15:46,240 --> 00:15:48,639
saw this they'd be like

456
00:15:48,639 --> 00:15:50,800
well what does it do it sets a it has an

457
00:15:50,800 --> 00:15:52,160
admin function

458
00:15:52,160 --> 00:15:55,279
or it takes a takes somebody's address

459
00:15:55,279 --> 00:15:58,240
and just sets sets it as an admin

460
00:15:58,240 --> 00:16:01,120
and then it has a reporter function

461
00:16:01,120 --> 00:16:03,199
and all that reporter function does is

462
00:16:03,199 --> 00:16:05,440
it says log fx

463
00:16:05,440 --> 00:16:07,600
whatever address you give it and

464
00:16:07,600 --> 00:16:10,000
whatever stream you supply

465
00:16:10,000 --> 00:16:12,399
so literally all it does

466
00:16:12,399 --> 00:16:15,279
is if the buyer is an authorized user of

467
00:16:15,279 --> 00:16:18,000
this smart contract if he's an admin

468
00:16:18,000 --> 00:16:19,040
then

469
00:16:19,040 --> 00:16:21,360
if i call the reporter function then all

470
00:16:21,360 --> 00:16:22,399
it's going to do

471
00:16:22,399 --> 00:16:24,000
is it's going to log if you see on the

472
00:16:24,000 --> 00:16:26,240
very top there it says event

473
00:16:26,240 --> 00:16:28,720
sender string it's just going to send an

474
00:16:28,720 --> 00:16:30,560
event on the blockchain and an event on

475
00:16:30,560 --> 00:16:32,639
a blockchain is like a log it's like a

476
00:16:32,639 --> 00:16:34,000
system log

477
00:16:34,000 --> 00:16:36,240
so sending an event on the blockchain

478
00:16:36,240 --> 00:16:38,160
that um

479
00:16:38,160 --> 00:16:40,880
that our rootkit will be tuned to listen

480
00:16:40,880 --> 00:16:43,199
to and then act on and do certain

481
00:16:43,199 --> 00:16:45,759
instructions on

482
00:16:45,759 --> 00:16:48,240
now this is one way we're sending an

483
00:16:48,240 --> 00:16:51,360
event we're sending a a transaction to

484
00:16:51,360 --> 00:16:53,600
our smart contract the smart contract is

485
00:16:53,600 --> 00:16:55,759
sending an event on the blockchain our

486
00:16:55,759 --> 00:16:57,519
rook is going to listen to that but we

487
00:16:57,519 --> 00:16:59,680
have no way of hearing back from the

488
00:16:59,680 --> 00:17:01,279
rootkit and knowing what it's with the

489
00:17:01,279 --> 00:17:02,480
responses

490
00:17:02,480 --> 00:17:04,799
of that transaction are

491
00:17:04,799 --> 00:17:06,480
there's ways you can do it i won't get

492
00:17:06,480 --> 00:17:08,240
into it in this talk it's a bit more

493
00:17:08,240 --> 00:17:10,400
complicated and very involved the long

494
00:17:10,400 --> 00:17:13,199
story short you use the same methodology

495
00:17:13,199 --> 00:17:14,880
but in reverse

496
00:17:14,880 --> 00:17:18,079
your root kit would instead

497
00:17:18,079 --> 00:17:19,119
back

498
00:17:19,119 --> 00:17:20,880
have some value attached to it would

499
00:17:20,880 --> 00:17:22,720
have its own public private key it would

500
00:17:22,720 --> 00:17:24,799
be set as an admin on this contract and

501
00:17:24,799 --> 00:17:27,359
itself would send the contra transaction

502
00:17:27,359 --> 00:17:29,760
back to this event with a response of

503
00:17:29,760 --> 00:17:33,840
whatever transaction sent to it and your

504
00:17:33,840 --> 00:17:35,919
client side

505
00:17:35,919 --> 00:17:37,280
command controller whatever you want to

506
00:17:37,280 --> 00:17:39,120
call it will pick up that and get the

507
00:17:39,120 --> 00:17:42,879
responses back from the rootkit

508
00:17:44,840 --> 00:17:46,559
so

509
00:17:46,559 --> 00:17:47,760
how it works

510
00:17:47,760 --> 00:17:50,160
is the attacker executes the smart

511
00:17:50,160 --> 00:17:51,520
contract

512
00:17:51,520 --> 00:17:52,400
the

513
00:17:52,400 --> 00:17:56,480
smart contract emits this fx event

514
00:17:56,480 --> 00:17:57,840
and

515
00:17:57,840 --> 00:18:00,640
through this effects event uh it

516
00:18:00,640 --> 00:18:02,320
contains very strings

517
00:18:02,320 --> 00:18:04,720
these various strings could be

518
00:18:04,720 --> 00:18:06,559
download a command

519
00:18:06,559 --> 00:18:08,000
run

520
00:18:08,000 --> 00:18:10,240
run a command it could be

521
00:18:10,240 --> 00:18:11,039
uh

522
00:18:11,039 --> 00:18:13,840
now run this executable on the on the

523
00:18:13,840 --> 00:18:14,720
on the

524
00:18:14,720 --> 00:18:15,840
on the compromise machine that's

525
00:18:15,840 --> 00:18:17,520
basically ransomware or it could be shut

526
00:18:17,520 --> 00:18:20,080
down the machine it could be r minus rf

527
00:18:20,080 --> 00:18:22,000
delete everything on the machine it

528
00:18:22,000 --> 00:18:23,520
could be whatever

529
00:18:23,520 --> 00:18:26,639
whatever you want it to

530
00:18:26,840 --> 00:18:30,159
be so

531
00:18:30,720 --> 00:18:32,160
that's

532
00:18:32,160 --> 00:18:35,360
high level the logic and because it's a

533
00:18:35,360 --> 00:18:36,799
smart contract that's giving the

534
00:18:36,799 --> 00:18:38,880
commands the rookit that rookie is

535
00:18:38,880 --> 00:18:40,640
listening for

536
00:18:40,640 --> 00:18:43,360
uh there's no attribution right there's

537
00:18:43,360 --> 00:18:46,640
no ip addresses logged if anybody

538
00:18:46,640 --> 00:18:49,200
if as a cyber security person

539
00:18:49,200 --> 00:18:52,080
if i find this rootkit on

540
00:18:52,080 --> 00:18:55,840
on my box on my server and i look at it

541
00:18:55,840 --> 00:18:57,440
all i see is that it's accepting

542
00:18:57,440 --> 00:18:59,120
commands from a blockchain i'll be like

543
00:18:59,120 --> 00:19:00,480
okay that's great

544
00:19:00,480 --> 00:19:02,559
um kind of cool but

545
00:19:02,559 --> 00:19:04,320
how do i find out who sent those

546
00:19:04,320 --> 00:19:05,360
commands

547
00:19:05,360 --> 00:19:07,280
all i'll be able to see

548
00:19:07,280 --> 00:19:09,039
i'll then go to this to the smart

549
00:19:09,039 --> 00:19:10,799
contract address and i'll see which

550
00:19:10,799 --> 00:19:12,320
address was sending commands to that

551
00:19:12,320 --> 00:19:14,320
smart contract and i'll just see it's a

552
00:19:14,320 --> 00:19:16,480
dummy address with more value or

553
00:19:16,480 --> 00:19:17,600
whatever

554
00:19:17,600 --> 00:19:19,679
and because it's come from webster or

555
00:19:19,679 --> 00:19:21,679
some other test net coins

556
00:19:21,679 --> 00:19:24,960
i can't back pedal and find out who

557
00:19:24,960 --> 00:19:26,320
if it came from an exchange or not

558
00:19:26,320 --> 00:19:27,600
because it didn't

559
00:19:27,600 --> 00:19:30,480
so this creates a completely

560
00:19:30,480 --> 00:19:32,160
anonymous

561
00:19:32,160 --> 00:19:34,799
c2 infrastructure for rootkits

562
00:19:34,799 --> 00:19:36,880
and reduces the complexity in the cost

563
00:19:36,880 --> 00:19:39,039
for an attacker to almost nothing they

564
00:19:39,039 --> 00:19:40,080
don't have to set up shared

565
00:19:40,080 --> 00:19:41,280
infrastructure they don't have to do any

566
00:19:41,280 --> 00:19:42,799
of that stuff anymore

567
00:19:42,799 --> 00:19:44,240
all they have to do

568
00:19:44,240 --> 00:19:46,720
is is connect the existing roof kits to

569
00:19:46,720 --> 00:19:50,000
this c2 infrastructure

570
00:19:50,000 --> 00:19:51,520
so

571
00:19:51,520 --> 00:19:54,160
demo time

572
00:19:54,640 --> 00:19:55,679
um

573
00:19:55,679 --> 00:19:59,360
i hope the demo gods are kind to us

574
00:19:59,360 --> 00:20:01,760
and wi-fi being fidgety and stuff so i'm

575
00:20:01,760 --> 00:20:03,840
going to try and give a live demo

576
00:20:03,840 --> 00:20:06,240
if it doesn't work for whatever reason i

577
00:20:06,240 --> 00:20:07,840
have a backup video that i can show you

578
00:20:07,840 --> 00:20:10,158
as well

579
00:20:12,000 --> 00:20:14,080
so i've already deployed the smart

580
00:20:14,080 --> 00:20:16,559
contract

581
00:20:16,640 --> 00:20:18,320
sorry guys

582
00:20:18,320 --> 00:20:21,919
how can i get my screen up here

583
00:20:21,919 --> 00:20:23,919
it's all good

584
00:20:23,919 --> 00:20:25,679
sorry guys

585
00:20:25,679 --> 00:20:28,159
so as i was saying um

586
00:20:28,159 --> 00:20:30,480
this is something called ethereum remix

587
00:20:30,480 --> 00:20:32,480
it's basically a smart contract

588
00:20:32,480 --> 00:20:34,400
deployment platform

589
00:20:34,400 --> 00:20:36,799
um i've already deployed the smart

590
00:20:36,799 --> 00:20:38,080
contract

591
00:20:38,080 --> 00:20:40,480
it's running over here

592
00:20:40,480 --> 00:20:42,000
and it's the exact same one i showed you

593
00:20:42,000 --> 00:20:43,760
guys

594
00:20:43,760 --> 00:20:46,159
what i'm also going to do

595
00:20:46,159 --> 00:20:48,559
oops

596
00:20:48,559 --> 00:20:50,159
i'll make that smaller because it's made

597
00:20:50,159 --> 00:20:52,240
it massive

598
00:20:52,240 --> 00:20:54,640
is i'll run

599
00:20:54,640 --> 00:20:57,919
the rootkit

600
00:21:00,720 --> 00:21:03,840
okay yep

601
00:21:06,799 --> 00:21:08,240
let me just check something sorry about

602
00:21:08,240 --> 00:21:10,480
that

603
00:21:12,720 --> 00:21:14,240
what i have here

604
00:21:14,240 --> 00:21:16,159
before i get into running the route is

605
00:21:16,159 --> 00:21:17,760
the rookit itself

606
00:21:17,760 --> 00:21:20,000
and what the rookie does

607
00:21:20,000 --> 00:21:21,360
is

608
00:21:21,360 --> 00:21:22,880
long story short it connects the

609
00:21:22,880 --> 00:21:25,440
contract to the events

610
00:21:25,440 --> 00:21:27,280
that affects thing

611
00:21:27,280 --> 00:21:29,679
and it listens for events that come from

612
00:21:29,679 --> 00:21:31,600
that fx

613
00:21:31,600 --> 00:21:33,360
on the blockchain so it's long story

614
00:21:33,360 --> 00:21:35,679
short it's monitoring that contract and

615
00:21:35,679 --> 00:21:38,320
the effects events that are sent to it

616
00:21:38,320 --> 00:21:39,919
and then as soon as

617
00:21:39,919 --> 00:21:40,880
uh

618
00:21:40,880 --> 00:21:45,440
an event is detected on that fx log

619
00:21:45,440 --> 00:21:47,520
then it comes to this

620
00:21:47,520 --> 00:21:50,000
method that's called handle event

621
00:21:50,000 --> 00:21:52,080
it extracts some parameters and checks

622
00:21:52,080 --> 00:21:54,240
if

623
00:21:54,480 --> 00:21:56,799
if we center the hello message if we did

624
00:21:56,799 --> 00:21:59,280
it executes an operating system command

625
00:21:59,280 --> 00:22:01,919
called ls which shows my files

626
00:22:01,919 --> 00:22:03,840
but that operating system file could be

627
00:22:03,840 --> 00:22:05,919
that operating system command can be any

628
00:22:05,919 --> 00:22:08,320
command we choose it could be

629
00:22:08,320 --> 00:22:09,840
delete the whole box

630
00:22:09,840 --> 00:22:11,679
remove all the files it could be shut

631
00:22:11,679 --> 00:22:13,200
down it could be absolutely anything you

632
00:22:13,200 --> 00:22:16,760
wanted to be there

633
00:22:28,159 --> 00:22:30,000
so cool

634
00:22:30,000 --> 00:22:33,280
that's running and listening for events

635
00:22:33,280 --> 00:22:34,960
what we're going to do now is we're

636
00:22:34,960 --> 00:22:36,159
going to

637
00:22:36,159 --> 00:22:38,400
invoke the reporter function with a

638
00:22:38,400 --> 00:22:42,400
message hello that if you remember

639
00:22:42,400 --> 00:22:45,200
my smart contract was listening for

640
00:22:45,200 --> 00:22:47,039
what's popped up over here

641
00:22:47,039 --> 00:22:50,080
is uh my ethereum wallet it's we're

642
00:22:50,080 --> 00:22:51,440
running on a different network called

643
00:22:51,440 --> 00:22:54,400
polygon it's faster and cheaper but bear

644
00:22:54,400 --> 00:22:55,600
with me

645
00:22:55,600 --> 00:22:57,520
um and what we're going to do right now

646
00:22:57,520 --> 00:23:01,840
is we're basically uh sending

647
00:23:02,960 --> 00:23:06,159
we're sending um

648
00:23:06,640 --> 00:23:08,880
we're basically what you see here is

649
00:23:08,880 --> 00:23:10,320
contract interaction we're interacting

650
00:23:10,320 --> 00:23:12,159
with this contract we're calling this

651
00:23:12,159 --> 00:23:14,000
reporter method

652
00:23:14,000 --> 00:23:16,080
with a hello message

653
00:23:16,080 --> 00:23:17,360
and what's happening in this black

654
00:23:17,360 --> 00:23:19,440
screen is it's listening for on that

655
00:23:19,440 --> 00:23:21,039
contract for the hello message to come

656
00:23:21,039 --> 00:23:23,120
through and what we hope to achieve is

657
00:23:23,120 --> 00:23:25,120
as soon as the contract successfully

658
00:23:25,120 --> 00:23:27,280
executes as you'll see on the left black

659
00:23:27,280 --> 00:23:28,400
thing here

660
00:23:28,400 --> 00:23:32,679
a directory listing of my files

661
00:23:39,840 --> 00:23:41,360
cool

662
00:23:41,360 --> 00:23:42,400
hey

663
00:23:42,400 --> 00:23:44,640
it worked

664
00:23:44,640 --> 00:23:45,520
so

665
00:23:45,520 --> 00:23:47,440
uh yeah

666
00:23:47,440 --> 00:23:48,840
now

667
00:23:48,840 --> 00:23:51,840
that's basically ran

668
00:23:51,840 --> 00:23:53,760
everything

669
00:23:53,760 --> 00:23:55,760
you got a directory listing of my files

670
00:23:55,760 --> 00:23:57,279
but this could be i don't know whatever

671
00:23:57,279 --> 00:23:58,960
you want it to be it could be you know

672
00:23:58,960 --> 00:24:00,960
what let's create a file let's create a

673
00:24:00,960 --> 00:24:02,640
file on the system

674
00:24:02,640 --> 00:24:04,960
uh it could be

675
00:24:04,960 --> 00:24:07,679
create an account

676
00:24:08,320 --> 00:24:09,840
roger you're giving me a tough job man

677
00:24:09,840 --> 00:24:11,760
but let's do it

678
00:24:11,760 --> 00:24:14,000
delete everything how about i make it

679
00:24:14,000 --> 00:24:15,520
shut down

680
00:24:15,520 --> 00:24:17,200
i'll shut it down but then i'll have to

681
00:24:17,200 --> 00:24:20,400
do the presentation solo

682
00:24:21,039 --> 00:24:23,360
yeah

683
00:24:27,960 --> 00:24:32,039
okay uh

684
00:24:32,320 --> 00:24:34,240
yeah

685
00:24:34,240 --> 00:24:36,480
oh

686
00:24:40,640 --> 00:24:43,520
the screen you know like as soon as this

687
00:24:43,520 --> 00:24:44,799
executes it's gonna shut down my

688
00:24:44,799 --> 00:24:46,640
computer so i won't have a presentation

689
00:24:46,640 --> 00:24:48,880
anymore but then we can just take take

690
00:24:48,880 --> 00:24:50,320
it a bit offline

691
00:24:50,320 --> 00:24:53,360
maybe what i do

692
00:24:53,360 --> 00:24:55,200
before i execute it is i actually talk

693
00:24:55,200 --> 00:24:56,640
to you a bit about counter measures and

694
00:24:56,640 --> 00:24:58,159
then i'll go back

695
00:24:58,159 --> 00:24:59,520
um

696
00:24:59,520 --> 00:25:00,640
so

697
00:25:00,640 --> 00:25:02,159
counter measures like

698
00:25:02,159 --> 00:25:03,679
what i've talked about today is like

699
00:25:03,679 --> 00:25:05,440
some pretty scary stuff it sounds very

700
00:25:05,440 --> 00:25:07,760
scary and all that stuff but

701
00:25:07,760 --> 00:25:11,440
how do you prevent this from the

702
00:25:11,679 --> 00:25:13,039
from the get-go how do you prevent this

703
00:25:13,039 --> 00:25:15,440
from happening right

704
00:25:15,440 --> 00:25:17,760
the usual advice applies you know run a

705
00:25:17,760 --> 00:25:18,960
hardened network everything that

706
00:25:18,960 --> 00:25:20,559
cybersecurity people we know we preach

707
00:25:20,559 --> 00:25:22,880
about always applies

708
00:25:22,880 --> 00:25:25,919
but in addition in this use case

709
00:25:25,919 --> 00:25:27,440
you need to monitor

710
00:25:27,440 --> 00:25:29,520
outbound connections on your network for

711
00:25:29,520 --> 00:25:30,960
blockchain

712
00:25:30,960 --> 00:25:31,760
uh

713
00:25:31,760 --> 00:25:32,960
networks

714
00:25:32,960 --> 00:25:34,400
so if you have a sock or something or

715
00:25:34,400 --> 00:25:35,919
some sort of outbound monitoring make

716
00:25:35,919 --> 00:25:37,679
sure that that's block monitoring for

717
00:25:37,679 --> 00:25:39,760
blockchain transactions

718
00:25:39,760 --> 00:25:42,159
uh now that's becomes a bit of a mouse

719
00:25:42,159 --> 00:25:43,120
game because there's a hyper

720
00:25:43,120 --> 00:25:44,640
proliferation of blockchain networks out

721
00:25:44,640 --> 00:25:46,400
there there's one coming up every single

722
00:25:46,400 --> 00:25:47,440
day

723
00:25:47,440 --> 00:25:50,559
and it's further compounded by

724
00:25:50,559 --> 00:25:54,320
there's various sas based not rpc based

725
00:25:54,320 --> 00:25:56,960
uh ways to interact with with blockchain

726
00:25:56,960 --> 00:25:58,000
networks

727
00:25:58,000 --> 00:25:59,600
like infuror if you guys are familiar

728
00:25:59,600 --> 00:26:01,360
with that it's like basically interact

729
00:26:01,360 --> 00:26:03,600
with blockchain over http and because

730
00:26:03,600 --> 00:26:05,440
http is very is like

731
00:26:05,440 --> 00:26:07,200
ubiquitous in a corporate network it's

732
00:26:07,200 --> 00:26:10,080
very hard for you to block it

733
00:26:10,080 --> 00:26:12,640
but there's ways you know

734
00:26:12,640 --> 00:26:14,159
chain analysis if you're lucky and they

735
00:26:14,159 --> 00:26:16,559
came through

736
00:26:16,720 --> 00:26:18,559
went through an exchange and they're not

737
00:26:18,559 --> 00:26:20,480
very intelligent

738
00:26:20,480 --> 00:26:21,600
but now

739
00:26:21,600 --> 00:26:25,719
let's go back to the cool stuff

740
00:26:26,799 --> 00:26:29,760
and shut down my machine

741
00:26:30,240 --> 00:26:31,520
with a rookie

742
00:26:31,520 --> 00:26:33,840
ah i can't see my screen

743
00:26:33,840 --> 00:26:35,600
okay

744
00:26:35,600 --> 00:26:38,720
i might need your help again

745
00:26:38,720 --> 00:26:40,240
oh okay

746
00:26:40,240 --> 00:26:41,679
that kind of sucks

747
00:26:41,679 --> 00:26:44,000
because now i can't see my screen

748
00:26:44,000 --> 00:26:46,850
but i'll try and do it over here

749
00:26:46,850 --> 00:26:50,050
[Music]

750
00:26:53,279 --> 00:26:56,279
oops

751
00:27:13,039 --> 00:27:13,919
wait

752
00:27:13,919 --> 00:27:18,600
wait wait let's do it properly

753
00:27:38,880 --> 00:27:40,880
yeah cool

754
00:27:40,880 --> 00:27:44,360
let's do it properly

755
00:27:51,919 --> 00:27:56,279
and let's go here again

756
00:28:07,279 --> 00:28:08,880
what i'm doing here is just making it go

757
00:28:08,880 --> 00:28:10,240
faster

758
00:28:10,240 --> 00:28:11,679
paying more for the transaction but

759
00:28:11,679 --> 00:28:15,240
don't worry about that

760
00:28:20,799 --> 00:28:22,480
so yeah that's it

761
00:28:22,480 --> 00:28:23,679
thank you

762
00:28:23,679 --> 00:28:24,880
do we have any questions from the

763
00:28:24,880 --> 00:28:26,799
audience

764
00:28:26,799 --> 00:28:29,520
are there any open source root rootkits

765
00:28:29,520 --> 00:28:30,559
or

766
00:28:30,559 --> 00:28:33,600
exploitation tools or anything that is

767
00:28:33,600 --> 00:28:35,760
currently using blockchain

768
00:28:35,760 --> 00:28:37,679
non to my knowledge to my knowledge and

769
00:28:37,679 --> 00:28:40,000
i did a lot of open source investigation

770
00:28:40,000 --> 00:28:42,320
around this i think this is

771
00:28:42,320 --> 00:28:44,640
the first time documented time this has

772
00:28:44,640 --> 00:28:46,080
been used

773
00:28:46,080 --> 00:28:47,520
um

774
00:28:47,520 --> 00:28:48,960
and because it has the potential of

775
00:28:48,960 --> 00:28:51,200
massive abuse i don't intend to make

776
00:28:51,200 --> 00:28:54,080
this public

777
00:28:54,240 --> 00:28:55,679
so it's it's just showing the

778
00:28:55,679 --> 00:28:57,440
methodology behind something like this

779
00:28:57,440 --> 00:28:58,640
at present

780
00:28:58,640 --> 00:29:01,360
i do expect it to be used though

781
00:29:01,360 --> 00:29:04,799
it's quite a effective way to stay

782
00:29:04,799 --> 00:29:07,799
hidden

