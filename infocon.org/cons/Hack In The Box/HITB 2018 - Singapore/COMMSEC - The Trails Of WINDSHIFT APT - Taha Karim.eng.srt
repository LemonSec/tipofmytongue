1
00:00:09,679 --> 00:00:16,400
thank you I want to thank hacking the

2
00:00:12,830 --> 00:00:22,880
box for<font color="#E5E5E5"> this opportunity to allow me</font><font color="#CCCCCC"> to</font>

3
00:00:16,400 --> 00:00:25,390
speak in this<font color="#E5E5E5"> contact</font><font color="#CCCCCC"> track so we will</font>

4
00:00:22,880 --> 00:00:31,909
start right now

5
00:00:25,390 --> 00:00:33,530
yeah<font color="#E5E5E5"> in the trail of</font><font color="#CCCCCC"> wind shift apt</font><font color="#E5E5E5"> just</font>

6
00:00:31,910 --> 00:00:36,500
a little bit about myself<font color="#CCCCCC"> I've been</font>

7
00:00:33,530 --> 00:00:40,010
doing<font color="#CCCCCC"> reverse engineering for last</font>

8
00:00:36,500 --> 00:00:42,350
decade mostly<font color="#E5E5E5"> malware I've been working</font>

9
00:00:40,010 --> 00:00:45,470
with previous companies like fire small

10
00:00:42,350 --> 00:00:50,150
<font color="#E5E5E5">tech so I've been doing</font><font color="#CCCCCC"> this apt malware</font>

11
00:00:45,470 --> 00:00:51,440
for a long time and this<font color="#CCCCCC"> is</font><font color="#E5E5E5"> something</font>

12
00:00:50,150 --> 00:00:53,839
<font color="#E5E5E5">very unique</font>

13
00:00:51,440 --> 00:00:57,400
kind of<font color="#E5E5E5"> different</font><font color="#CCCCCC"> from what we see</font>

14
00:00:53,839 --> 00:01:01,670
usually from commodity apt groups and

15
00:00:57,400 --> 00:01:04,519
hopefully you enjoy this talk<font color="#CCCCCC"> so let's</font>

16
00:01:01,670 --> 00:01:08,060
talk about apt myths and definitions

17
00:01:04,519 --> 00:01:09,500
<font color="#CCCCCC">before</font><font color="#E5E5E5"> so you might</font><font color="#CCCCCC"> think that ap team</font>

18
00:01:08,060 --> 00:01:16,340
is<font color="#E5E5E5"> always something that is always</font>

19
00:01:09,500 --> 00:01:20,270
advanced that use<font color="#CCCCCC"> steeled tools but</font>

20
00:01:16,340 --> 00:01:22,910
let's<font color="#E5E5E5"> take it this way here actually</font><font color="#CCCCCC"> an</font>

21
00:01:20,270 --> 00:01:25,970
EPT is that is as advanced as their

22
00:01:22,910 --> 00:01:28,250
target<font color="#CCCCCC"> if the target is</font><font color="#E5E5E5"> not very secure</font>

23
00:01:25,970 --> 00:01:30,679
<font color="#CCCCCC">which is a small company</font><font color="#E5E5E5"> they're not</font>

24
00:01:28,250 --> 00:01:32,810
going<font color="#E5E5E5"> to use their top-secret tool you</font>

25
00:01:30,680 --> 00:01:36,560
can use probably something<font color="#CCCCCC"> that that's</font>

26
00:01:32,810 --> 00:01:41,170
<font color="#E5E5E5">very simple let's take a target that's</font>

27
00:01:36,560 --> 00:01:43,670
running Windows<font color="#CCCCCC"> XP with absolutely no AV</font>

28
00:01:41,170 --> 00:01:47,650
the advance<font color="#E5E5E5"> of the apt will not go there</font>

29
00:01:43,670 --> 00:01:50,060
<font color="#CCCCCC">and burn as your day or burn an implant</font>

30
00:01:47,650 --> 00:01:52,490
<font color="#CCCCCC">but</font><font color="#E5E5E5"> he's just going</font><font color="#CCCCCC"> to use</font><font color="#E5E5E5"> probably a</font>

31
00:01:50,060 --> 00:01:56,450
pony stealer<font color="#CCCCCC"> and he</font><font color="#E5E5E5"> will still be able</font>

32
00:01:52,490 --> 00:01:58,820
<font color="#CCCCCC">to extra trade the information so apt</font>

33
00:01:56,450 --> 00:02:01,280
doesn't mean<font color="#CCCCCC"> always advance that's</font><font color="#E5E5E5"> the</font>

34
00:01:58,820 --> 00:02:06,380
point I'm trying to make here<font color="#E5E5E5"> also I</font>

35
00:02:01,280 --> 00:02:09,110
come with this diagram I'll say this is

36
00:02:06,380 --> 00:02:12,859
what I<font color="#E5E5E5"> used measure if any</font><font color="#CCCCCC"> PT actor is</font>

37
00:02:09,110 --> 00:02:16,129
<font color="#CCCCCC">addressed or not we have three things</font><font color="#E5E5E5"> we</font>

38
00:02:12,860 --> 00:02:21,319
<font color="#CCCCCC">have the</font><font color="#E5E5E5"> OPSEC success rate and the</font>

39
00:02:16,129 --> 00:02:23,060
detection so<font color="#E5E5E5"> OPSEC usually is very</font>

40
00:02:21,319 --> 00:02:25,819
important obviously

41
00:02:23,060 --> 00:02:28,370
and this is something<font color="#CCCCCC"> that</font><font color="#E5E5E5"> we can</font>

42
00:02:25,819 --> 00:02:31,179
measure<font color="#CCCCCC"> a nepeta with for example</font><font color="#E5E5E5"> if an</font>

43
00:02:28,370 --> 00:02:33,230
<font color="#E5E5E5">EPT have a very bad OPSEC let's say</font>

44
00:02:31,180 --> 00:02:35,780
<font color="#E5E5E5">registering some domain names and you</font>

45
00:02:33,230 --> 00:02:37,549
can just do<font color="#E5E5E5"> who is</font><font color="#CCCCCC"> and you see the email</font>

46
00:02:35,780 --> 00:02:39,950
<font color="#E5E5E5">of</font><font color="#CCCCCC"> the person who urges</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> the domain</font>

47
00:02:37,550 --> 00:02:42,230
<font color="#E5E5E5">that's obviously a very bad object but</font>

48
00:02:39,950 --> 00:02:44,000
if you see any<font color="#CCCCCC"> apt actor who's</font><font color="#E5E5E5"> changing</font>

49
00:02:42,230 --> 00:02:46,160
<font color="#E5E5E5">from infrastructure to another and</font>

50
00:02:44,000 --> 00:02:50,600
registering the domain in a way that you

51
00:02:46,160 --> 00:02:52,870
cannot see anonymous way and<font color="#E5E5E5"> also they</font>

52
00:02:50,600 --> 00:02:55,880
evade all<font color="#CCCCCC"> typos</font><font color="#E5E5E5"> all kind of tracking</font>

53
00:02:52,870 --> 00:02:58,760
they leave no trace behind<font color="#E5E5E5"> them that's</font>

54
00:02:55,880 --> 00:03:01,489
obviously an apt with a very good<font color="#CCCCCC"> object</font>

55
00:02:58,760 --> 00:03:03,709
same goes for the success rate is

56
00:03:01,489 --> 00:03:06,650
<font color="#CCCCCC">disability was able to</font><font color="#E5E5E5"> persist in your</font>

57
00:03:03,709 --> 00:03:10,819
environment<font color="#E5E5E5"> they were able to</font><font color="#CCCCCC"> exfiltrate</font>

58
00:03:06,650 --> 00:03:13,340
information to reach<font color="#E5E5E5"> how far the</font>

59
00:03:10,819 --> 00:03:15,290
disability went inside your network<font color="#CCCCCC"> what</font>

60
00:03:13,340 --> 00:03:18,350
type of information is<font color="#E5E5E5"> apt got from your</font>

61
00:03:15,290 --> 00:03:21,500
network<font color="#E5E5E5"> also</font><font color="#CCCCCC"> goes we</font><font color="#E5E5E5"> is also related to</font>

62
00:03:18,350 --> 00:03:23,750
detection detection is are they noisy

63
00:03:21,500 --> 00:03:25,940
you<font color="#CCCCCC"> dick create alerts</font><font color="#E5E5E5"> inside your</font>

64
00:03:23,750 --> 00:03:28,700
environment<font color="#CCCCCC"> or</font><font color="#E5E5E5"> they've been there for</font>

65
00:03:25,940 --> 00:03:30,170
two years<font color="#E5E5E5"> with zero alerts right this so</font>

66
00:03:28,700 --> 00:03:32,359
this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> what I'm using me personally</font>

67
00:03:30,170 --> 00:03:33,798
from<font color="#E5E5E5"> my experience to measure who I'm</font>

68
00:03:32,360 --> 00:03:36,860
dealing<font color="#E5E5E5"> with is it like an advanced with</font>

69
00:03:33,799 --> 00:03:39,860
one or just commodity type of a PT's

70
00:03:36,860 --> 00:03:42,950
right<font color="#E5E5E5"> so as you know dark matter</font>

71
00:03:39,860 --> 00:03:45,170
we are<font color="#E5E5E5"> cyber security company in the</font>

72
00:03:42,950 --> 00:03:49,578
Middle<font color="#E5E5E5"> East where legions region we are</font>

73
00:03:45,170 --> 00:03:53,328
<font color="#E5E5E5">lead in cyber security</font><font color="#CCCCCC"> and we usually</font>

74
00:03:49,579 --> 00:03:57,910
<font color="#E5E5E5">publish a lot of research white papers</font>

75
00:03:53,329 --> 00:04:00,680
around<font color="#CCCCCC"> apt targeting the Middle East</font>

76
00:03:57,910 --> 00:04:03,079
<font color="#CCCCCC">some examples here we have Greenberg</font>

77
00:04:00,680 --> 00:04:06,590
<font color="#CCCCCC">Ulrich muddy water if you follow in the</font>

78
00:04:03,079 --> 00:04:08,690
Middle East<font color="#CCCCCC"> voicings</font><font color="#E5E5E5"> these names will I</font>

79
00:04:06,590 --> 00:04:10,840
mean you probably heard<font color="#E5E5E5"> about Greenberg</font>

80
00:04:08,690 --> 00:04:14,720
<font color="#E5E5E5">or week so those are</font><font color="#CCCCCC"> like very known</font>

81
00:04:10,840 --> 00:04:18,168
famous I'll say<font color="#E5E5E5"> apt targeting the GCC</font>

82
00:04:14,720 --> 00:04:21,350
<font color="#CCCCCC">region</font><font color="#E5E5E5"> most of this apt will rely on</font>

83
00:04:18,168 --> 00:04:24,590
open<font color="#CCCCCC"> source tools we call them like</font>

84
00:04:21,350 --> 00:04:28,340
<font color="#CCCCCC">copy-paste actor this is a huge one</font>

85
00:04:24,590 --> 00:04:30,739
called<font color="#CCCCCC"> patchwork who they</font><font color="#E5E5E5"> just use open</font>

86
00:04:28,340 --> 00:04:32,359
source<font color="#E5E5E5"> so nothing else so they do that</font>

87
00:04:30,740 --> 00:04:34,310
in a way that<font color="#CCCCCC"> we cannot track them</font>

88
00:04:32,360 --> 00:04:36,530
<font color="#CCCCCC">easily</font><font color="#E5E5E5"> and we don't know who is</font><font color="#CCCCCC"> behind</font>

89
00:04:34,310 --> 00:04:38,360
it some<font color="#E5E5E5"> of them</font>

90
00:04:36,530 --> 00:04:41,179
they're gonna<font color="#E5E5E5"> use a custom tools they're</font>

91
00:04:38,360 --> 00:04:43,310
gonna use<font color="#E5E5E5"> their own self they made the</font>

92
00:04:41,180 --> 00:04:45,170
program their own implant<font color="#E5E5E5"> their own</font>

93
00:04:43,310 --> 00:04:47,060
<font color="#CCCCCC">backdoor and</font><font color="#E5E5E5"> this is where it's getting</font>

94
00:04:45,170 --> 00:04:49,040
<font color="#E5E5E5">exciting because it means</font><font color="#CCCCCC"> that these</font>

95
00:04:47,060 --> 00:04:51,830
<font color="#E5E5E5">guys have a couple of developers they</font>

96
00:04:49,040 --> 00:04:54,320
have project management<font color="#CCCCCC"> they have you</font>

97
00:04:51,830 --> 00:04:57,560
<font color="#CCCCCC">know</font><font color="#E5E5E5"> they need to follow</font><font color="#CCCCCC"> SDLC</font>

98
00:04:54,320 --> 00:05:00,560
programming they need to be poured their

99
00:04:57,560 --> 00:05:04,640
sample to<font color="#CCCCCC"> be able</font><font color="#E5E5E5"> to run</font><font color="#CCCCCC"> all type of</font>

100
00:05:00,560 --> 00:05:08,060
versions of<font color="#E5E5E5"> Windows for</font><font color="#CCCCCC"> example so when</font>

101
00:05:04,640 --> 00:05:11,960
<font color="#E5E5E5">we have this type</font><font color="#CCCCCC"> of adversary we're</font>

102
00:05:08,060 --> 00:05:17,330
probably dealing<font color="#E5E5E5"> with the real apt with</font>

103
00:05:11,960 --> 00:05:20,299
a very<font color="#E5E5E5"> noticeable experience level once</font>

104
00:05:17,330 --> 00:05:24,140
they have<font color="#CCCCCC"> their custom tools they</font>

105
00:05:20,300 --> 00:05:27,320
actually unlock the glorifying lifetime

106
00:05:24,140 --> 00:05:33,289
apt attribution so<font color="#E5E5E5"> all now everyone said</font>

107
00:05:27,320 --> 00:05:37,909
<font color="#CCCCCC">ok this</font><font color="#E5E5E5"> is a PT 28 yeah so if we go back</font>

108
00:05:33,290 --> 00:05:40,550
<font color="#CCCCCC">to our actors in the list we have over</font>

109
00:05:37,910 --> 00:05:44,900
<font color="#CCCCCC">ik</font><font color="#E5E5E5"> so or ik they use mimic</font><font color="#CCCCCC"> ads Uno's</font>

110
00:05:40,550 --> 00:05:46,850
mimic ads<font color="#CCCCCC"> ok</font><font color="#E5E5E5"> couple of people so me me</font>

111
00:05:44,900 --> 00:05:49,700
<font color="#E5E5E5">cats is a very known tools if you guys</font>

112
00:05:46,850 --> 00:05:51,410
doing<font color="#CCCCCC"> pen</font><font color="#E5E5E5"> testing offensive great</font>

113
00:05:49,700 --> 00:05:53,060
<font color="#CCCCCC">teaming so that's the tool that we</font>

114
00:05:51,410 --> 00:05:55,400
usually use<font color="#E5E5E5"> to you know do some</font>

115
00:05:53,060 --> 00:05:57,410
<font color="#E5E5E5">privilege escalation to create some</font>

116
00:05:55,400 --> 00:06:00,289
golden tickets and<font color="#CCCCCC"> things like</font><font color="#E5E5E5"> that so</font>

117
00:05:57,410 --> 00:06:03,500
<font color="#CCCCCC">what</font><font color="#E5E5E5"> these</font><font color="#CCCCCC"> guys did you know you take</font>

118
00:06:00,290 --> 00:06:06,110
<font color="#CCCCCC">mini cats</font><font color="#E5E5E5"> from scratch compile it you</font>

119
00:06:03,500 --> 00:06:08,479
throw it<font color="#E5E5E5"> on a canal environment</font><font color="#CCCCCC"> he will</font>

120
00:06:06,110 --> 00:06:11,120
get<font color="#E5E5E5"> it will get detected so what these</font>

121
00:06:08,479 --> 00:06:14,330
<font color="#CCCCCC">guys did they took a</font><font color="#E5E5E5"> very old version of</font>

122
00:06:11,120 --> 00:06:16,580
<font color="#CCCCCC">mini cats and actually what they've</font><font color="#E5E5E5"> done</font>

123
00:06:14,330 --> 00:06:20,120
<font color="#E5E5E5">is they just changed some strings</font>

124
00:06:16,580 --> 00:06:21,560
<font color="#E5E5E5">because obviously</font><font color="#CCCCCC"> Yarra detection is a</font>

125
00:06:20,120 --> 00:06:25,370
static detection the most of the time

126
00:06:21,560 --> 00:06:29,630
<font color="#CCCCCC">they do detection of streams</font><font color="#E5E5E5"> so here we</font>

127
00:06:25,370 --> 00:06:32,060
<font color="#E5E5E5">are sorry so here we see ature left this</font>

128
00:06:29,630 --> 00:06:35,150
is the<font color="#CCCCCC"> original</font><font color="#E5E5E5"> mini cats at your right</font>

129
00:06:32,060 --> 00:06:37,250
<font color="#E5E5E5">the custom version of unicast that all</font>

130
00:06:35,150 --> 00:06:39,229
<font color="#E5E5E5">rig</font><font color="#CCCCCC"> use</font><font color="#E5E5E5"> and as you can</font><font color="#CCCCCC"> see there are</font>

131
00:06:37,250 --> 00:06:41,630
were just<font color="#CCCCCC"> on string replacement they</font>

132
00:06:39,229 --> 00:06:46,159
<font color="#E5E5E5">changed the strings with no obvious ones</font>

133
00:06:41,630 --> 00:06:48,950
<font color="#E5E5E5">and that was enough to bypass a static</font>

134
00:06:46,160 --> 00:06:51,950
detection it works like that<font color="#E5E5E5"> but yeah</font>

135
00:06:48,950 --> 00:06:54,320
it's actually working similar another

136
00:06:51,950 --> 00:06:57,440
function that<font color="#CCCCCC"> I found in actually I just</font>

137
00:06:54,320 --> 00:06:59,719
<font color="#E5E5E5">doing the diff of this assembly and</font><font color="#CCCCCC"> you</font>

138
00:06:57,440 --> 00:07:03,650
can see that<font color="#CCCCCC"> clearly is the</font><font color="#E5E5E5"> same</font>

139
00:06:59,720 --> 00:07:07,940
function<font color="#CCCCCC"> but these things are changed</font><font color="#E5E5E5"> so</font>

140
00:07:03,650 --> 00:07:10,460
<font color="#E5E5E5">why</font><font color="#CCCCCC"> in how wind shift apt is different</font>

141
00:07:07,940 --> 00:07:12,610
<font color="#CCCCCC">so why I'm saying</font><font color="#E5E5E5"> is different</font><font color="#CCCCCC"> why it's</font>

142
00:07:10,460 --> 00:07:17,620
a big<font color="#E5E5E5"> deal while I'm</font><font color="#CCCCCC"> talking about</font><font color="#E5E5E5"> it</font>

143
00:07:12,610 --> 00:07:20,630
very simple it's a pure intelligence

144
00:07:17,620 --> 00:07:23,600
<font color="#E5E5E5">cyber-espionage actors they are</font><font color="#CCCCCC"> after</font>

145
00:07:20,630 --> 00:07:26,960
individuals right they're<font color="#E5E5E5"> not</font><font color="#CCCCCC"> after</font>

146
00:07:23,600 --> 00:07:29,180
companies the after specific<font color="#CCCCCC"> people and</font>

147
00:07:26,960 --> 00:07:34,070
so the<font color="#CCCCCC"> N</font><font color="#E5E5E5"> I choose one person they're</font>

148
00:07:29,180 --> 00:07:35,930
gonna hack<font color="#CCCCCC"> her or his email personal</font>

149
00:07:34,070 --> 00:07:37,940
emails<font color="#E5E5E5"> and from there they're gonna</font>

150
00:07:35,930 --> 00:07:41,960
<font color="#E5E5E5">expert rate as most affirmation as they</font>

151
00:07:37,940 --> 00:07:44,570
can<font color="#E5E5E5"> they also use other actors malware</font>

152
00:07:41,960 --> 00:07:46,669
so it's very<font color="#E5E5E5"> hard</font><font color="#CCCCCC"> to work</font><font color="#E5E5E5"> on attribution</font>

153
00:07:44,570 --> 00:07:49,700
<font color="#E5E5E5">piece because these guys are reusing</font>

154
00:07:46,670 --> 00:07:54,970
other malware<font color="#E5E5E5"> that is</font><font color="#CCCCCC"> flagged</font><font color="#E5E5E5"> as part of</font>

155
00:07:49,700 --> 00:07:58,219
other groups and they've really<font color="#E5E5E5"> directly</font>

156
00:07:54,970 --> 00:08:01,130
targets with malware they usually do

157
00:07:58,220 --> 00:08:03,890
<font color="#E5E5E5">spearfishing the whole year and once or</font>

158
00:08:01,130 --> 00:08:06,080
<font color="#CCCCCC">twice a year</font><font color="#E5E5E5"> they're gonna approach</font>

159
00:08:03,890 --> 00:08:08,150
someone<font color="#CCCCCC"> with a malware</font><font color="#E5E5E5"> and they're gonna</font>

160
00:08:06,080 --> 00:08:11,419
<font color="#E5E5E5">try to infect the target but they take a</font>

161
00:08:08,150 --> 00:08:13,900
lot of time<font color="#E5E5E5"> to do that and the fact that</font>

162
00:08:11,420 --> 00:08:18,500
they are going<font color="#CCCCCC"> after</font><font color="#E5E5E5"> specific</font>

163
00:08:13,900 --> 00:08:20,900
<font color="#E5E5E5">individuals and not companies I mean</font>

164
00:08:18,500 --> 00:08:23,990
that what<font color="#CCCCCC"> helped</font><font color="#E5E5E5"> them staying under</font><font color="#CCCCCC"> the</font>

165
00:08:20,900 --> 00:08:27,080
<font color="#CCCCCC">radar for a long time because personal</font>

166
00:08:23,990 --> 00:08:29,570
computers usually<font color="#E5E5E5"> they don't have</font>

167
00:08:27,080 --> 00:08:32,179
security<font color="#E5E5E5"> solutions and even if they have</font>

168
00:08:29,570 --> 00:08:33,460
you<font color="#CCCCCC"> just click on block or put any</font>

169
00:08:32,179 --> 00:08:35,870
current<font color="#CCCCCC"> in and that's it</font>

170
00:08:33,460 --> 00:08:38,090
well if you have a trigger in a company

171
00:08:35,870 --> 00:08:39,020
<font color="#E5E5E5">then it's gonna alert to the stock then</font>

172
00:08:38,090 --> 00:08:41,090
<font color="#E5E5E5">you're gonna call the</font><font color="#CCCCCC"> Institute's</font>

173
00:08:39,020 --> 00:08:43,100
responding and I do investigation<font color="#E5E5E5"> so</font>

174
00:08:41,090 --> 00:08:48,830
this is basically<font color="#CCCCCC"> how they stayed under</font>

175
00:08:43,100 --> 00:08:51,770
the<font color="#E5E5E5"> radar let's talk about the mo so</font>

176
00:08:48,830 --> 00:08:54,530
<font color="#E5E5E5">these guys actually well I don't we</font>

177
00:08:51,770 --> 00:08:59,600
<font color="#E5E5E5">don't know from which country they</font>

178
00:08:54,530 --> 00:09:02,779
operate<font color="#E5E5E5"> from but I'm gonna explain</font><font color="#CCCCCC"> you</font>

179
00:08:59,600 --> 00:09:05,569
all<font color="#E5E5E5"> the faces that</font><font color="#CCCCCC"> they</font>

180
00:09:02,779 --> 00:09:07,009
<font color="#CCCCCC">and we're gonna talk</font><font color="#E5E5E5"> a little bit about</font>

181
00:09:05,569 --> 00:09:09,920
attribution<font color="#CCCCCC"> again</font>

182
00:09:07,009 --> 00:09:11,660
so the<font color="#CCCCCC"> recon phase</font><font color="#E5E5E5"> that's actually the</font>

183
00:09:09,920 --> 00:09:15,889
first<font color="#E5E5E5"> phase it's the longest phase and</font>

184
00:09:11,660 --> 00:09:18,980
actually they<font color="#E5E5E5"> maintain a couple of fake</font>

185
00:09:15,889 --> 00:09:21,470
personas<font color="#CCCCCC"> so they have fake LinkedIn</font>

186
00:09:18,980 --> 00:09:23,240
<font color="#E5E5E5">accounts</font><font color="#CCCCCC"> Facebook Twitter Instagram</font><font color="#E5E5E5"> they</font>

187
00:09:21,470 --> 00:09:25,189
are all<font color="#CCCCCC"> over</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> place so</font><font color="#E5E5E5"> what they</font>

188
00:09:23,240 --> 00:09:28,040
<font color="#E5E5E5">trying</font><font color="#CCCCCC"> to do is they trying to</font><font color="#E5E5E5"> get the</font>

189
00:09:25,189 --> 00:09:29,689
first contact with individuals<font color="#CCCCCC"> in order</font>

190
00:09:28,040 --> 00:09:31,939
<font color="#E5E5E5">to get their email address or their</font>

191
00:09:29,689 --> 00:09:35,569
phone numbers or the contact<font color="#E5E5E5"> list where</font>

192
00:09:31,939 --> 00:09:37,430
they also develop<font color="#E5E5E5"> sometimes apps on the</font>

193
00:09:35,569 --> 00:09:39,319
Play<font color="#E5E5E5"> Store</font><font color="#CCCCCC"> these apps were stealing</font>

194
00:09:37,430 --> 00:09:41,959
information<font color="#E5E5E5"> such as contact lists in</font>

195
00:09:39,319 --> 00:09:45,349
reading your<font color="#E5E5E5"> SMS this is an example of</font>

196
00:09:41,959 --> 00:09:47,089
one app<font color="#CCCCCC"> that we found and we publish a</font>

197
00:09:45,350 --> 00:09:48,740
blog about<font color="#E5E5E5"> it</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> who has Google to shut</font>

198
00:09:47,089 --> 00:09:54,319
down the<font color="#CCCCCC"> iPhone Play Store because this</font>

199
00:09:48,740 --> 00:09:58,220
app was malicious an<font color="#E5E5E5"> example here it's a</font>

200
00:09:54,319 --> 00:10:01,699
very<font color="#E5E5E5"> funny because it's</font><font color="#CCCCCC"> actually</font><font color="#E5E5E5"> the</font>

201
00:09:58,220 --> 00:10:04,399
<font color="#E5E5E5">same</font><font color="#CCCCCC"> person with the same picture and it</font>

202
00:10:01,699 --> 00:10:07,670
<font color="#E5E5E5">has different accounts Facebook</font><font color="#CCCCCC"> Twitter</font>

203
00:10:04,399 --> 00:10:11,389
Instagram yeah

204
00:10:07,670 --> 00:10:14,769
LinkedIn as you can see the LinkedIn

205
00:10:11,389 --> 00:10:16,850
account have more than 500<font color="#E5E5E5"> connections</font>

206
00:10:14,769 --> 00:10:19,250
<font color="#CCCCCC">actually what they did they took a</font>

207
00:10:16,850 --> 00:10:23,779
<font color="#E5E5E5">picture of</font><font color="#CCCCCC"> a legitimate legitimate</font>

208
00:10:19,250 --> 00:10:26,000
<font color="#CCCCCC">person and using</font><font color="#E5E5E5"> Google</font><font color="#CCCCCC"> cash and things</font>

209
00:10:23,779 --> 00:10:28,670
like<font color="#E5E5E5"> that</font><font color="#CCCCCC"> we found that this person is</font>

210
00:10:26,000 --> 00:10:30,350
<font color="#CCCCCC">living in Latin America</font><font color="#E5E5E5"> she</font><font color="#CCCCCC"> has nothing</font>

211
00:10:28,670 --> 00:10:34,849
<font color="#E5E5E5">to do</font><font color="#CCCCCC"> with this but they took her</font>

212
00:10:30,350 --> 00:10:38,779
picture<font color="#CCCCCC"> and use them to attract people</font>

213
00:10:34,850 --> 00:10:40,639
and to approach people<font color="#E5E5E5"> right but</font>

214
00:10:38,779 --> 00:10:43,160
something<font color="#CCCCCC"> very</font><font color="#E5E5E5"> interesting is</font><font color="#CCCCCC"> the</font>

215
00:10:40,639 --> 00:10:45,019
<font color="#E5E5E5">Twitter account because you know Twitter</font>

216
00:10:43,160 --> 00:10:47,660
if it's not private<font color="#CCCCCC"> its public</font><font color="#E5E5E5"> so you</font>

217
00:10:45,019 --> 00:10:51,170
can see all the tweets<font color="#CCCCCC"> and</font><font color="#E5E5E5"> there is a</font>

218
00:10:47,660 --> 00:10:53,180
very nice tool<font color="#CCCCCC"> this is our scene</font><font color="#E5E5E5"> one</font><font color="#CCCCCC"> on</font>

219
00:10:51,170 --> 00:10:56,149
<font color="#E5E5E5">one or on Twitter so there is a tool</font>

220
00:10:53,180 --> 00:10:59,180
called tweet<font color="#E5E5E5"> analyzer by source so</font>

221
00:10:56,149 --> 00:11:00,860
<font color="#CCCCCC">shout-out</font><font color="#E5E5E5"> to users if</font><font color="#CCCCCC"> you watching you</font>

222
00:10:59,180 --> 00:11:03,439
run it against a Twitter account<font color="#CCCCCC"> it will</font>

223
00:11:00,860 --> 00:11:05,709
tell you<font color="#E5E5E5"> the weekly activity of a</font>

224
00:11:03,439 --> 00:11:09,769
certain<font color="#E5E5E5"> Twitter account from the start</font>

225
00:11:05,709 --> 00:11:13,099
<font color="#E5E5E5">now for this Twitter account she tweeted</font>

226
00:11:09,769 --> 00:11:16,190
about<font color="#CCCCCC"> 200</font><font color="#E5E5E5"> tweets for the last two years</font>

227
00:11:13,100 --> 00:11:20,740
<font color="#E5E5E5">and something very interesting</font>

228
00:11:16,190 --> 00:11:23,860
is Friday<font color="#E5E5E5"> there was absolutely no twins</font>

229
00:11:20,740 --> 00:11:28,010
<font color="#E5E5E5">she's not normal</font><font color="#CCCCCC"> if you take a</font>

230
00:11:23,860 --> 00:11:30,290
legitimate<font color="#CCCCCC"> Twitter account let's say</font><font color="#E5E5E5"> the</font>

231
00:11:28,010 --> 00:11:30,830
<font color="#E5E5E5">grog if the grog is here or much you</font>

232
00:11:30,290 --> 00:11:33,170
swish

233
00:11:30,830 --> 00:11:36,980
these guys are posting every day so

234
00:11:33,170 --> 00:11:40,339
clearly<font color="#E5E5E5"> you won't see a gap and actually</font>

235
00:11:36,980 --> 00:11:42,650
<font color="#E5E5E5">this gap tell us something it's not a</font>

236
00:11:40,340 --> 00:11:45,020
coincidence but<font color="#E5E5E5"> it tells us</font><font color="#CCCCCC"> that maybe</font>

237
00:11:42,650 --> 00:11:48,079
the<font color="#CCCCCC"> person operating</font><font color="#E5E5E5"> this Twitter</font>

238
00:11:45,020 --> 00:11:50,510
account<font color="#CCCCCC"> is in the Middle</font><font color="#E5E5E5"> East</font><font color="#CCCCCC"> because in</font>

239
00:11:48,080 --> 00:11:54,230
Middle East as you guys probably know we

240
00:11:50,510 --> 00:11:56,720
<font color="#E5E5E5">don't work Friday right so I don't</font><font color="#CCCCCC"> know</font>

241
00:11:54,230 --> 00:11:57,470
if it's requested<font color="#E5E5E5"> this or not but this</font>

242
00:11:56,720 --> 00:12:00,050
is<font color="#E5E5E5"> what we found</font>

243
00:11:57,470 --> 00:12:02,360
right<font color="#E5E5E5"> so this</font><font color="#CCCCCC"> is something you</font><font color="#E5E5E5"> guys can</font>

244
00:12:00,050 --> 00:12:04,130
do if you<font color="#E5E5E5"> investigating Twitter accounts</font>

245
00:12:02,360 --> 00:12:06,770
<font color="#E5E5E5">sometimes if the guys are don't be</font>

246
00:12:04,130 --> 00:12:09,020
<font color="#CCCCCC">naughty put the GLA</font><font color="#E5E5E5"> is your location</font><font color="#CCCCCC"> on</font>

247
00:12:06,770 --> 00:12:11,270
<font color="#E5E5E5">their tweet so you can easily flag on</font>

248
00:12:09,020 --> 00:12:14,380
which country<font color="#CCCCCC"> they post a tweet</font><font color="#E5E5E5"> but</font>

249
00:12:11,270 --> 00:12:17,120
otherwise you use stuff<font color="#CCCCCC"> like this to</font>

250
00:12:14,380 --> 00:12:23,270
obviously see from where these<font color="#E5E5E5"> guys</font>

251
00:12:17,120 --> 00:12:25,490
<font color="#CCCCCC">operate</font><font color="#E5E5E5"> just an example</font><font color="#CCCCCC"> second face they</font>

252
00:12:23,270 --> 00:12:26,600
actually<font color="#CCCCCC"> approach people</font><font color="#E5E5E5"> via LinkedIn</font>

253
00:12:25,490 --> 00:12:30,530
they ask you<font color="#CCCCCC"> for an email address</font>

254
00:12:26,600 --> 00:12:34,100
<font color="#E5E5E5">personal images gmail account</font><font color="#CCCCCC"> and they</font>

255
00:12:30,530 --> 00:12:37,790
start sending<font color="#CCCCCC"> you emails and within</font><font color="#E5E5E5"> the</font>

256
00:12:34,100 --> 00:12:40,570
emails<font color="#E5E5E5"> there's a tracking code</font><font color="#CCCCCC"> that they</font>

257
00:12:37,790 --> 00:12:42,829
use and they can<font color="#E5E5E5"> see from where actually</font>

258
00:12:40,570 --> 00:12:45,950
first<font color="#CCCCCC"> of all they see if you open the</font>

259
00:12:42,830 --> 00:12:48,850
email<font color="#E5E5E5"> they can see also from</font><font color="#CCCCCC"> where you</font>

260
00:12:45,950 --> 00:12:51,440
<font color="#E5E5E5">open the email</font><font color="#CCCCCC"> like your geolocation</font><font color="#E5E5E5"> and</font>

261
00:12:48,850 --> 00:12:55,190
they use like regular emails<font color="#E5E5E5"> like</font><font color="#CCCCCC"> this</font>

262
00:12:51,440 --> 00:12:58,340
one so they just copy past content from

263
00:12:55,190 --> 00:13:00,530
local<font color="#E5E5E5"> media and they sent you an email</font>

264
00:12:58,340 --> 00:13:03,560
like<font color="#CCCCCC"> this</font><font color="#E5E5E5"> every day they</font><font color="#CCCCCC"> send you an</font>

265
00:13:00,530 --> 00:13:06,860
email and<font color="#E5E5E5"> they watching your click</font>

266
00:13:03,560 --> 00:13:09,739
habits so they create some relation with

267
00:13:06,860 --> 00:13:11,870
you without you<font color="#E5E5E5"> knowing for the long</font>

268
00:13:09,740 --> 00:13:14,180
<font color="#E5E5E5">term so these guys</font><font color="#CCCCCC"> are playing</font><font color="#E5E5E5"> for the</font>

269
00:13:11,870 --> 00:13:19,190
long term<font color="#CCCCCC"> rights a very long term</font>

270
00:13:14,180 --> 00:13:21,829
<font color="#E5E5E5">campaign and within this email this is</font>

271
00:13:19,190 --> 00:13:27,750
the source of email you<font color="#CCCCCC"> can see like</font>

272
00:13:21,830 --> 00:13:31,199
<font color="#CCCCCC">this was my email read blank that if I</font>

273
00:13:27,750 --> 00:13:32,399
and as soon as you open this email<font color="#E5E5E5"> they</font>

274
00:13:31,199 --> 00:13:34,258
get they receive<font color="#E5E5E5"> this</font><font color="#CCCCCC"> site for</font>

275
00:13:32,399 --> 00:13:35,939
notification<font color="#E5E5E5"> they know your IP address</font>

276
00:13:34,259 --> 00:13:37,889
your user agent so they know what

277
00:13:35,939 --> 00:13:40,290
operating system you're running<font color="#E5E5E5"> and they</font>

278
00:13:37,889 --> 00:13:42,439
also know<font color="#E5E5E5"> I just hide it but they know</font>

279
00:13:40,290 --> 00:13:47,519
<font color="#E5E5E5">your</font><font color="#CCCCCC"> location they know</font><font color="#E5E5E5"> from which</font>

280
00:13:42,439 --> 00:13:50,969
country<font color="#E5E5E5"> you open the email it's actually</font>

281
00:13:47,519 --> 00:13:53,040
very<font color="#E5E5E5"> dangerous because they</font><font color="#CCCCCC"> sending this</font>

282
00:13:50,970 --> 00:13:56,129
every day<font color="#E5E5E5"> so basically every day they</font>

283
00:13:53,040 --> 00:14:00,449
know where<font color="#E5E5E5"> you at it's kind of some type</font>

284
00:13:56,129 --> 00:14:02,040
<font color="#CCCCCC">of tracking</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> is very dangerous after</font>

285
00:14:00,449 --> 00:14:04,709
that they moved to the credential

286
00:14:02,040 --> 00:14:06,899
harvesting so what they do once they

287
00:14:04,709 --> 00:14:08,579
build this relation with you once you

288
00:14:06,899 --> 00:14:09,470
know<font color="#CCCCCC"> the always Center email</font><font color="#E5E5E5"> sometimes</font>

289
00:14:08,579 --> 00:14:12,930
you're<font color="#E5E5E5"> going</font><font color="#CCCCCC"> to send</font><font color="#E5E5E5"> you an email</font>

290
00:14:09,470 --> 00:14:14,399
telling you that your<font color="#E5E5E5"> password we need</font>

291
00:14:12,930 --> 00:14:18,060
to change<font color="#E5E5E5"> your password</font><font color="#CCCCCC"> you know regular</font>

292
00:14:14,399 --> 00:14:22,019
<font color="#E5E5E5">spearfishing but they do it in a certain</font>

293
00:14:18,060 --> 00:14:24,899
<font color="#E5E5E5">way</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> very targeted and very</font>

294
00:14:22,019 --> 00:14:28,500
legitimate<font color="#E5E5E5"> and it's very hard to detect</font>

295
00:14:24,899 --> 00:14:30,329
if it's a fake email or not<font color="#CCCCCC"> and they</font>

296
00:14:28,500 --> 00:14:33,959
also use domains the where they host

297
00:14:30,329 --> 00:14:35,939
their spearfishing platform<font color="#CCCCCC"> they</font>

298
00:14:33,959 --> 00:14:37,709
<font color="#CCCCCC">resistor domains with free notes</font><font color="#E5E5E5"> or</font><font color="#CCCCCC"> free</font>

299
00:14:35,939 --> 00:14:41,670
<font color="#CCCCCC">now is a free service</font><font color="#E5E5E5"> you can just</font><font color="#CCCCCC"> go</font>

300
00:14:37,709 --> 00:14:44,508
<font color="#CCCCCC">there resistor</font><font color="#E5E5E5"> an email and as soon as</font>

301
00:14:41,670 --> 00:14:47,639
they register the email the spearfishing

302
00:14:44,509 --> 00:14:50,160
<font color="#E5E5E5">they shut down the</font><font color="#CCCCCC"> whole in one</font><font color="#E5E5E5"> day</font><font color="#CCCCCC"> like</font>

303
00:14:47,639 --> 00:14:52,110
<font color="#E5E5E5">basically they register a domain pointed</font>

304
00:14:50,160 --> 00:14:54,029
to the spear<font color="#CCCCCC"> phishing platform they with</font>

305
00:14:52,110 --> 00:14:56,189
24 hours and they shut<font color="#CCCCCC"> down the</font><font color="#E5E5E5"> domain</font>

306
00:14:54,029 --> 00:14:58,949
<font color="#E5E5E5">they create another one which make them</font>

307
00:14:56,189 --> 00:15:02,160
very<font color="#CCCCCC"> hard</font><font color="#E5E5E5"> actually to detect by span</font>

308
00:14:58,949 --> 00:15:05,790
<font color="#CCCCCC">holes or you know</font><font color="#E5E5E5"> those spam filtering</font>

309
00:15:02,160 --> 00:15:08,370
<font color="#E5E5E5">engines they also use the</font><font color="#CCCCCC"> GT</font><font color="#E5E5E5"> mate SSL</font>

310
00:15:05,790 --> 00:15:11,519
certificate<font color="#E5E5E5"> so they go and they buy they</font>

311
00:15:08,370 --> 00:15:13,529
are actually they either use free SSL or

312
00:15:11,519 --> 00:15:22,050
let's encrypt or they<font color="#CCCCCC"> even buy real</font>

313
00:15:13,529 --> 00:15:25,170
<font color="#CCCCCC">comodo certificates an example that's</font>

314
00:15:22,050 --> 00:15:29,040
<font color="#E5E5E5">for</font><font color="#CCCCCC"> example for auto</font><font color="#E5E5E5"> web access so they</font>

315
00:15:25,170 --> 00:15:31,110
sent you<font color="#E5E5E5"> this email with your real email</font>

316
00:15:29,040 --> 00:15:33,300
address here<font color="#E5E5E5"> it's configurable so they</font>

317
00:15:31,110 --> 00:15:36,420
can put your real email<font color="#CCCCCC"> address in cello</font>

318
00:15:33,300 --> 00:15:40,859
hey your account got compromised<font color="#CCCCCC"> blah</font>

319
00:15:36,420 --> 00:15:43,800
blah blah change your password they<font color="#E5E5E5"> also</font>

320
00:15:40,860 --> 00:15:46,500
do it using<font color="#E5E5E5"> the cloud you know iCloud</font>

321
00:15:43,800 --> 00:15:50,699
<font color="#E5E5E5">but if they know you have a MacBook or</font>

322
00:15:46,500 --> 00:15:53,760
iOS this<font color="#E5E5E5"> sends you this right they also</font>

323
00:15:50,700 --> 00:16:00,180
<font color="#E5E5E5">send you SMS so everything looks</font>

324
00:15:53,760 --> 00:16:03,120
legitimate here an<font color="#CCCCCC"> example would eat a</font>

325
00:16:00,180 --> 00:16:06,569
<font color="#CCCCCC">salad</font><font color="#E5E5E5"> so it is a lot is</font><font color="#CCCCCC"> a one</font><font color="#E5E5E5"> of the</font>

326
00:16:03,120 --> 00:16:09,450
<font color="#E5E5E5">biggest ISPs we have in the UAE and this</font>

327
00:16:06,570 --> 00:16:12,000
is clearly an email SMS they also sent

328
00:16:09,450 --> 00:16:13,830
<font color="#CCCCCC">to your phone you click on it you are</font>

329
00:16:12,000 --> 00:16:16,620
redirected<font color="#CCCCCC"> to this page</font><font color="#E5E5E5"> and you give</font>

330
00:16:13,830 --> 00:16:22,380
<font color="#E5E5E5">away your information as you can see</font>

331
00:16:16,620 --> 00:16:24,930
<font color="#E5E5E5">HTTP</font><font color="#CCCCCC"> real certificate so 24 hours later</font>

332
00:16:22,380 --> 00:16:26,939
<font color="#E5E5E5">they shut down the domain and that's it</font>

333
00:16:24,930 --> 00:16:28,530
<font color="#E5E5E5">if you</font><font color="#CCCCCC"> do an investigation someone send</font>

334
00:16:26,940 --> 00:16:32,040
<font color="#E5E5E5">you the link if you look at it the day</font>

335
00:16:28,530 --> 00:16:33,900
after<font color="#CCCCCC"> is gone</font><font color="#E5E5E5"> right so they really know</font>

336
00:16:32,040 --> 00:16:37,520
<font color="#CCCCCC">what they doing</font><font color="#E5E5E5"> and they've been doing</font>

337
00:16:33,900 --> 00:16:41,040
<font color="#E5E5E5">it for</font><font color="#CCCCCC"> years</font><font color="#E5E5E5"> and nobody actually noticed</font>

338
00:16:37,520 --> 00:16:43,590
so it's very kind<font color="#E5E5E5"> of very dangerous here</font>

339
00:16:41,040 --> 00:16:46,140
is an example with Gmail and they scare

340
00:16:43,590 --> 00:16:47,940
<font color="#CCCCCC">you the cello</font><font color="#E5E5E5"> hey</font><font color="#CCCCCC"> if they know you from</font>

341
00:16:46,140 --> 00:16:50,880
<font color="#E5E5E5">certain countries they say hey your</font>

342
00:16:47,940 --> 00:16:53,720
<font color="#CCCCCC">Gmail account was opened from Iran from</font>

343
00:16:50,880 --> 00:16:56,520
<font color="#E5E5E5">Tehran click to change your password</font>

344
00:16:53,720 --> 00:17:00,690
they say oh<font color="#E5E5E5"> my god my MA got hacked you</font>

345
00:16:56,520 --> 00:17:03,510
click and actually<font color="#E5E5E5"> here it's a their own</font>

346
00:17:00,690 --> 00:17:06,440
<font color="#E5E5E5">spearfishing platform it's a custom tool</font>

347
00:17:03,510 --> 00:17:09,980
they use they built it have<font color="#E5E5E5"> HTTPS</font><font color="#CCCCCC"> and</font>

348
00:17:06,440 --> 00:17:12,750
here they put automatically your email

349
00:17:09,980 --> 00:17:15,240
with the<font color="#E5E5E5"> basic</font><font color="#CCCCCC"> C phone URL</font><font color="#E5E5E5"> so you can</font>

350
00:17:12,750 --> 00:17:17,550
clearly see<font color="#CCCCCC"> the type of</font><font color="#E5E5E5"> you know they</font>

351
00:17:15,240 --> 00:17:19,349
it's a kind<font color="#E5E5E5"> of advanced type of</font>

352
00:17:17,550 --> 00:17:27,720
spearfishing it's not something that<font color="#E5E5E5"> you</font>

353
00:17:19,349 --> 00:17:30,389
<font color="#E5E5E5">can easily fly</font><font color="#CCCCCC"> ok</font><font color="#E5E5E5"> after</font><font color="#CCCCCC"> that this</font>

354
00:17:27,720 --> 00:17:32,430
happens once or twice a year<font color="#CCCCCC"> and</font><font color="#E5E5E5"> this</font>

355
00:17:30,390 --> 00:17:34,770
phase is<font color="#CCCCCC"> really when they are desperate</font>

356
00:17:32,430 --> 00:17:37,590
when they cannot get<font color="#CCCCCC"> to your email and</font>

357
00:17:34,770 --> 00:17:39,629
they really need<font color="#E5E5E5"> to</font><font color="#CCCCCC"> access</font><font color="#E5E5E5"> your computer</font>

358
00:17:37,590 --> 00:17:41,490
for<font color="#E5E5E5"> some reason they're gonna do the</font>

359
00:17:39,630 --> 00:17:44,730
hacking<font color="#E5E5E5"> target so the end this is the</font>

360
00:17:41,490 --> 00:17:47,490
face where they actually<font color="#E5E5E5"> use malware and</font>

361
00:17:44,730 --> 00:17:49,460
this is how we found the<font color="#CCCCCC"> Mac OS malware</font>

362
00:17:47,490 --> 00:17:52,020
<font color="#E5E5E5">that be using is such a big deal because</font>

363
00:17:49,460 --> 00:17:53,380
<font color="#CCCCCC">you know</font><font color="#E5E5E5"> a Mac OS</font><font color="#CCCCCC"> malware's are not</font>

364
00:17:52,020 --> 00:17:56,980
<font color="#CCCCCC">hundred-thousand are like</font>

365
00:17:53,380 --> 00:17:59,830
we hundred or 200 known families<font color="#E5E5E5"> today</font>

366
00:17:56,980 --> 00:18:02,080
<font color="#E5E5E5">and this is kind of new type</font><font color="#CCCCCC"> of malware</font>

367
00:17:59,830 --> 00:18:04,840
they<font color="#CCCCCC"> used I'm going to talk</font><font color="#E5E5E5"> about it</font>

368
00:18:02,080 --> 00:18:08,800
later<font color="#E5E5E5"> on</font><font color="#CCCCCC"> but they use that they send it</font>

369
00:18:04,840 --> 00:18:11,679
<font color="#CCCCCC">to you via emails I'll tell you the</font>

370
00:18:08,800 --> 00:18:13,450
infection vector how it works<font color="#E5E5E5"> and what</font>

371
00:18:11,680 --> 00:18:15,010
<font color="#E5E5E5">these guys did they put a real</font>

372
00:18:13,450 --> 00:18:16,900
<font color="#CCCCCC">separation between the</font><font color="#E5E5E5"> command and</font>

373
00:18:15,010 --> 00:18:21,520
<font color="#E5E5E5">control servers and the</font><font color="#CCCCCC"> spearfishing</font>

374
00:18:16,900 --> 00:18:24,040
<font color="#E5E5E5">infrastructure why because if they host</font>

375
00:18:21,520 --> 00:18:26,710
<font color="#E5E5E5">the command control server inside the</font>

376
00:18:24,040 --> 00:18:29,649
<font color="#E5E5E5">Spearfish infrastructure if the</font><font color="#CCCCCC"> Maori</font>

377
00:18:26,710 --> 00:18:31,630
got detected then you can trace

378
00:18:29,650 --> 00:18:33,340
everything<font color="#E5E5E5"> you know where is the</font><font color="#CCCCCC"> spare</font>

379
00:18:31,630 --> 00:18:35,410
<font color="#E5E5E5">fish in it you can start</font><font color="#CCCCCC"> doing your</font>

380
00:18:33,340 --> 00:18:37,899
threat Intel but the fact that is

381
00:18:35,410 --> 00:18:40,360
completely separate<font color="#E5E5E5"> they keep the spare</font>

382
00:18:37,900 --> 00:18:42,130
fishing very away from the command

383
00:18:40,360 --> 00:18:43,959
control<font color="#E5E5E5"> servers so even the command</font>

384
00:18:42,130 --> 00:18:46,060
control<font color="#E5E5E5"> server got compromised they</font>

385
00:18:43,960 --> 00:18:47,980
still have the<font color="#E5E5E5"> spare fishing</font><font color="#CCCCCC"> nobody</font>

386
00:18:46,060 --> 00:18:51,879
knows where is it<font color="#CCCCCC"> so this</font><font color="#E5E5E5"> how they do</font>

387
00:18:47,980 --> 00:18:53,590
<font color="#E5E5E5">and actually I traced all their servers</font>

388
00:18:51,880 --> 00:18:56,290
their infrastructure<font color="#E5E5E5"> as you can see</font>

389
00:18:53,590 --> 00:18:58,360
<font color="#E5E5E5">there is a real separation between the</font>

390
00:18:56,290 --> 00:19:00,159
command<font color="#CCCCCC"> and control and</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> spearfishing</font>

391
00:18:58,360 --> 00:19:05,830
infrastructure is a real separation

392
00:19:00,160 --> 00:19:09,390
<font color="#E5E5E5">between the two the last phase they</font>

393
00:19:05,830 --> 00:19:13,020
disappear as<font color="#E5E5E5"> soon as they do the attack</font>

394
00:19:09,390 --> 00:19:16,960
they go away<font color="#CCCCCC"> how they go away they</font>

395
00:19:13,020 --> 00:19:19,660
change providers<font color="#CCCCCC"> VPS providers they</font>

396
00:19:16,960 --> 00:19:21,760
probably hack into other servers<font color="#E5E5E5"> so</font><font color="#CCCCCC"> we'd</font>

397
00:19:19,660 --> 00:19:23,950
<font color="#CCCCCC">only</font><font color="#E5E5E5"> know how</font><font color="#CCCCCC"> to get</font><font color="#E5E5E5"> the access but so I</font>

398
00:19:21,760 --> 00:19:25,930
did some analysis on the type of VPS

399
00:19:23,950 --> 00:19:27,940
they usually prefer the VPS I use

400
00:19:25,930 --> 00:19:30,820
bitcoins will allow me to<font color="#E5E5E5"> make them stay</font>

401
00:19:27,940 --> 00:19:32,800
anonymous<font color="#CCCCCC"> somehow but what they go and</font>

402
00:19:30,820 --> 00:19:35,050
use some bulletproof hosting services so

403
00:19:32,800 --> 00:19:37,500
<font color="#E5E5E5">providers so this is something they do</font>

404
00:19:35,050 --> 00:19:39,580
every<font color="#E5E5E5"> six months so they use a</font>

405
00:19:37,500 --> 00:19:41,290
infrastructure they shut it<font color="#E5E5E5"> down</font><font color="#CCCCCC"> they</font>

406
00:19:39,580 --> 00:19:43,389
move<font color="#E5E5E5"> to another world etcetera</font><font color="#CCCCCC"> etcetera</font>

407
00:19:41,290 --> 00:19:46,030
<font color="#E5E5E5">so</font><font color="#CCCCCC"> that's why I call them</font><font color="#E5E5E5"> Winship</font>

408
00:19:43,390 --> 00:19:48,600
<font color="#E5E5E5">because I didn't find any</font><font color="#CCCCCC"> other name so</font>

409
00:19:46,030 --> 00:19:51,220
they're<font color="#E5E5E5"> actually very hard to track</font>

410
00:19:48,600 --> 00:19:52,419
which means they have<font color="#E5E5E5"> people behind they</font>

411
00:19:51,220 --> 00:19:53,590
<font color="#CCCCCC">have people who manage the</font>

412
00:19:52,420 --> 00:19:55,630
infrastructure<font color="#CCCCCC"> you</font><font color="#E5E5E5"> have people who</font>

413
00:19:53,590 --> 00:19:57,280
<font color="#E5E5E5">manage</font><font color="#CCCCCC"> the non were</font><font color="#E5E5E5"> that people</font><font color="#CCCCCC"> who send</font>

414
00:19:55,630 --> 00:20:00,580
email that people<font color="#CCCCCC"> who manage the</font><font color="#E5E5E5"> Twitter</font>

415
00:19:57,280 --> 00:20:04,629
<font color="#E5E5E5">account</font><font color="#CCCCCC"> I mean it's a huge company who's</font>

416
00:20:00,580 --> 00:20:07,010
<font color="#CCCCCC">behind this here's an</font><font color="#E5E5E5"> example for they</font>

417
00:20:04,630 --> 00:20:09,320
were for example<font color="#E5E5E5"> operating on</font>

418
00:20:07,010 --> 00:20:11,600
our white card and then they move<font color="#CCCCCC"> two</font>

419
00:20:09,320 --> 00:20:14,870
bodies LLC<font color="#E5E5E5"> so but this is</font><font color="#CCCCCC"> a kind</font><font color="#E5E5E5"> of</font>

420
00:20:11,600 --> 00:20:17,449
playground<font color="#CCCCCC"> very known if you know</font><font color="#E5E5E5"> about</font>

421
00:20:14,870 --> 00:20:21,250
<font color="#CCCCCC">dark hotel they were hosted in in body</font>

422
00:20:17,450 --> 00:20:25,400
<font color="#CCCCCC">cells</font><font color="#E5E5E5"> so this is only for one particular</font>

423
00:20:21,250 --> 00:20:26,840
domain<font color="#CCCCCC"> as you can see let's talk about</font>

424
00:20:25,400 --> 00:20:29,780
the<font color="#CCCCCC"> tool set</font>

425
00:20:26,840 --> 00:20:33,620
so we dark matter and covered<font color="#E5E5E5"> a couple</font>

426
00:20:29,780 --> 00:20:36,320
of<font color="#CCCCCC"> McCoy samples so I'm gonna</font><font color="#E5E5E5"> go through</font>

427
00:20:33,620 --> 00:20:39,979
<font color="#CCCCCC">each of</font><font color="#E5E5E5"> them</font><font color="#CCCCCC"> and trying to explain</font><font color="#E5E5E5"> like</font>

428
00:20:36,320 --> 00:20:42,439
how<font color="#E5E5E5"> they work etc there</font><font color="#CCCCCC"> is a very last</font>

429
00:20:39,980 --> 00:20:44,990
one here it's a Windows malware it's

430
00:20:42,440 --> 00:20:47,030
actually<font color="#E5E5E5"> just a drop</font><font color="#CCCCCC"> down loader it</font>

431
00:20:44,990 --> 00:20:50,180
download<font color="#E5E5E5"> unknown malware so the normal</font>

432
00:20:47,030 --> 00:20:52,370
ways actually<font color="#CCCCCC"> is the second stage and it</font>

433
00:20:50,180 --> 00:20:55,580
was<font color="#CCCCCC"> removed from</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> c2 server so for</font>

434
00:20:52,370 --> 00:21:00,320
now<font color="#CCCCCC"> it's</font><font color="#E5E5E5"> unconfirmed but the the for the</font>

435
00:20:55,580 --> 00:21:02,929
<font color="#E5E5E5">four others are</font><font color="#CCCCCC"> confused I'm gonna start</font>

436
00:21:00,320 --> 00:21:06,980
<font color="#E5E5E5">with the first one so this</font><font color="#CCCCCC"> is Winchell</font>

437
00:21:02,930 --> 00:21:08,600
<font color="#E5E5E5">it's a sign it Mac OS Malloy</font><font color="#CCCCCC"> sign it</font>

438
00:21:06,980 --> 00:21:10,220
means<font color="#E5E5E5"> like gatekeeper</font><font color="#CCCCCC"> will just say okay</font>

439
00:21:08,600 --> 00:21:12,919
<font color="#CCCCCC">you can run no problem</font>

440
00:21:10,220 --> 00:21:17,630
so<font color="#CCCCCC"> its</font><font color="#E5E5E5"> developers you know sign it with</font>

441
00:21:12,920 --> 00:21:19,730
a developer ID<font color="#E5E5E5"> this</font><font color="#CCCCCC"> man</font><font color="#E5E5E5"> will go after</font>

442
00:21:17,630 --> 00:21:22,580
this<font color="#E5E5E5"> file with certain extensions and</font>

443
00:21:19,730 --> 00:21:25,390
<font color="#E5E5E5">then it will expect extra trade them the</font>

444
00:21:22,580 --> 00:21:29,300
persistence is done via<font color="#E5E5E5"> login items</font><font color="#CCCCCC"> and</font>

445
00:21:25,390 --> 00:21:32,690
actually they use<font color="#E5E5E5"> aes-256 ECB</font><font color="#CCCCCC"> to encrypt</font>

446
00:21:29,300 --> 00:21:36,530
the streams<font color="#E5E5E5"> the yes key is hard coding</font>

447
00:21:32,690 --> 00:21:39,260
inside the sample<font color="#E5E5E5"> so the</font><font color="#CCCCCC"> first operation</font>

448
00:21:36,530 --> 00:21:42,770
of this was in<font color="#E5E5E5"> 2017 and the infection</font>

449
00:21:39,260 --> 00:21:45,620
vector<font color="#E5E5E5"> we're</font><font color="#CCCCCC"> gonna talk about</font><font color="#E5E5E5"> it is they</font>

450
00:21:42,770 --> 00:21:48,530
use a spear phishing email with a link

451
00:21:45,620 --> 00:21:52,100
that<font color="#CCCCCC"> means once</font><font color="#E5E5E5"> you click on it it's</font>

452
00:21:48,530 --> 00:21:56,000
<font color="#CCCCCC">going to</font><font color="#E5E5E5"> do something very uncommon</font><font color="#CCCCCC"> I'll</font>

453
00:21:52,100 --> 00:21:58,250
say<font color="#E5E5E5"> before going to</font><font color="#CCCCCC"> that here is the</font>

454
00:21:56,000 --> 00:22:00,320
email<font color="#E5E5E5"> that they sent you the source of</font>

455
00:21:58,250 --> 00:22:02,480
the emails as you can see we can<font color="#E5E5E5"> still</font>

456
00:22:00,320 --> 00:22:05,960
find<font color="#CCCCCC"> was my</font><font color="#E5E5E5"> email read they</font><font color="#CCCCCC"> can always</font>

457
00:22:02,480 --> 00:22:09,770
track what you do and the malware comes

458
00:22:05,960 --> 00:22:14,480
as a image stored into Google<font color="#CCCCCC"> user</font>

459
00:22:09,770 --> 00:22:16,970
account<font color="#CCCCCC"> and once you click here you have</font>

460
00:22:14,480 --> 00:22:18,770
a specially crafted web page<font color="#E5E5E5"> so the</font>

461
00:22:16,970 --> 00:22:20,509
specially crafted web page what it does

462
00:22:18,770 --> 00:22:22,099
<font color="#CCCCCC">is very sneaky so</font>

463
00:22:20,509 --> 00:22:24,799
actually they give you a zip file to

464
00:22:22,099 --> 00:22:26,899
<font color="#E5E5E5">download and safari by default if</font><font color="#CCCCCC"> you</font>

465
00:22:24,799 --> 00:22:29,989
have a zip file<font color="#CCCCCC"> it will automatically</font>

466
00:22:26,899 --> 00:22:34,998
extract the file and<font color="#E5E5E5"> store in your file</font>

467
00:22:29,989 --> 00:22:37,940
system and they call a URL scheme here

468
00:22:34,999 --> 00:22:39,919
it's a custom URL scheme they call right

469
00:22:37,940 --> 00:22:40,539
after<font color="#CCCCCC"> and they repeat that</font><font color="#E5E5E5"> every three</font>

470
00:22:39,919 --> 00:22:42,859
seconds

471
00:22:40,539 --> 00:22:45,199
what does mean it means<font color="#E5E5E5"> that this</font>

472
00:22:42,859 --> 00:22:47,658
<font color="#CCCCCC">malware</font><font color="#E5E5E5"> here have some sort of custom</font>

473
00:22:45,199 --> 00:22:49,820
URL scheme in it so once you download<font color="#CCCCCC"> it</font>

474
00:22:47,659 --> 00:22:51,499
<font color="#E5E5E5">if the page is still running it's going</font>

475
00:22:49,820 --> 00:22:59,499
to automatically launch this<font color="#E5E5E5"> malware</font>

476
00:22:51,499 --> 00:23:02,959
using the custom URL scheme<font color="#CCCCCC"> the thing is</font>

477
00:22:59,499 --> 00:23:06,019
they did a<font color="#E5E5E5"> little typo</font><font color="#CCCCCC"> on the Euro</font>

478
00:23:02,959 --> 00:23:08,690
scheme<font color="#E5E5E5"> so thankfully the attack didn't</font>

479
00:23:06,019 --> 00:23:15,709
<font color="#CCCCCC">work because</font><font color="#E5E5E5"> it was</font><font color="#CCCCCC"> here open URL</font><font color="#E5E5E5"> they</font>

480
00:23:08,690 --> 00:23:18,979
missed the<font color="#CCCCCC"> l</font><font color="#E5E5E5"> and he didn't work what</font><font color="#CCCCCC"> so</font>

481
00:23:15,709 --> 00:23:21,409
yeah first<font color="#E5E5E5"> attack actually failed but</font>

482
00:23:18,979 --> 00:23:24,079
the other ones didn't feel the one<font color="#CCCCCC"> it</font>

483
00:23:21,409 --> 00:23:28,429
came<font color="#E5E5E5"> after but this one from 2017 a view</font>

484
00:23:24,079 --> 00:23:32,359
that was their first<font color="#E5E5E5"> attempt yeah okay</font>

485
00:23:28,429 --> 00:23:36,649
so I'm just<font color="#CCCCCC"> gonna tell you</font><font color="#E5E5E5"> why this</font>

486
00:23:32,359 --> 00:23:39,319
worked<font color="#E5E5E5"> how come just by downloading</font><font color="#CCCCCC"> a</font>

487
00:23:36,649 --> 00:23:47,228
file you can<font color="#CCCCCC"> open a browser</font><font color="#E5E5E5"> around the</font>

488
00:23:39,319 --> 00:23:47,229
file how come<font color="#CCCCCC"> have a video</font><font color="#E5E5E5"> here</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> know</font>

489
00:23:48,099 --> 00:23:56,389
yeah so<font color="#E5E5E5"> actually there's something</font>

490
00:23:52,789 --> 00:23:58,629
<font color="#E5E5E5">called launch services database</font><font color="#CCCCCC"> so long</font>

491
00:23:56,389 --> 00:24:01,189
service database is a demon that runs

492
00:23:58,629 --> 00:24:03,439
<font color="#E5E5E5">they have it launch service is</font><font color="#CCCCCC"> a demon</font>

493
00:24:01,190 --> 00:24:05,269
<font color="#E5E5E5">and actually as soon as it's your new</font>

494
00:24:03,440 --> 00:24:07,129
file<font color="#E5E5E5"> it's gonna</font><font color="#CCCCCC"> store all the</font>

495
00:24:05,269 --> 00:24:10,039
information<font color="#E5E5E5"> about the file including the</font>

496
00:24:07,129 --> 00:24:12,829
<font color="#CCCCCC">custom</font><font color="#E5E5E5"> URL scheme whether the current</font>

497
00:24:10,039 --> 00:24:15,619
user admin or not admin the custom your

498
00:24:12,829 --> 00:24:18,019
<font color="#E5E5E5">skin will get stored inside the</font><font color="#CCCCCC"> launch</font>

499
00:24:15,619 --> 00:24:20,389
<font color="#E5E5E5">slavery database so here are just</font>

500
00:24:18,019 --> 00:24:26,209
<font color="#CCCCCC">changed showing that it's not an</font><font color="#E5E5E5"> admin</font>

501
00:24:20,389 --> 00:24:30,918
user<font color="#CCCCCC"> it's a normal</font><font color="#E5E5E5"> user and there is a</font>

502
00:24:26,209 --> 00:24:34,370
binary called<font color="#E5E5E5"> LS register on Mac this</font>

503
00:24:30,919 --> 00:24:43,490
binary<font color="#E5E5E5"> will just dump dump the</font>

504
00:24:34,370 --> 00:24:45,860
<font color="#E5E5E5">no service database yeah so as soon</font><font color="#CCCCCC"> as</font>

505
00:24:43,490 --> 00:24:48,020
you find<font color="#E5E5E5"> it because actually</font><font color="#CCCCCC"> is in a</font>

506
00:24:45,860 --> 00:24:50,120
path somewhere<font color="#E5E5E5"> so I always do a</font><font color="#CCCCCC"> find</font>

507
00:24:48,020 --> 00:24:52,190
<font color="#E5E5E5">command I</font><font color="#CCCCCC"> can't remember this so now I'm</font>

508
00:24:50,120 --> 00:24:54,770
gonna<font color="#E5E5E5"> dump so dump all the services</font>

509
00:24:52,190 --> 00:24:57,470
database<font color="#E5E5E5"> I'm looking for the</font><font color="#CCCCCC"> custom URL</font>

510
00:24:54,770 --> 00:24:59,300
scheme didn't find it<font color="#E5E5E5"> now I'm gonna do</font>

511
00:24:57,470 --> 00:25:02,030
is I'm gonna just put the malware inside

512
00:24:59,300 --> 00:25:04,330
the share I'm just gonna brush through

513
00:25:02,030 --> 00:25:06,500
it<font color="#E5E5E5"> nothing else</font>

514
00:25:04,330 --> 00:25:09,409
so<font color="#E5E5E5"> I browse to it</font>

515
00:25:06,500 --> 00:25:11,720
<font color="#E5E5E5">that's the malware do again here you go</font>

516
00:25:09,410 --> 00:25:13,970
it's<font color="#CCCCCC"> resistor itself to the launch</font>

517
00:25:11,720 --> 00:25:18,290
service database without<font color="#E5E5E5"> any user</font>

518
00:25:13,970 --> 00:25:20,000
interaction and yeah it's science so

519
00:25:18,290 --> 00:25:24,678
here we<font color="#E5E5E5"> check in just a signature of</font>

520
00:25:20,000 --> 00:25:29,330
this<font color="#CCCCCC"> malware as you can see</font><font color="#E5E5E5"> it's sign it</font>

521
00:25:24,679 --> 00:25:33,260
with a<font color="#CCCCCC"> Apple developer</font><font color="#E5E5E5"> education problem</font>

522
00:25:29,330 --> 00:25:35,379
with this is now we're gonna do as the

523
00:25:33,260 --> 00:25:41,480
web page<font color="#CCCCCC"> we're</font><font color="#E5E5E5"> gonna run our browser and</font>

524
00:25:35,380 --> 00:25:43,309
<font color="#CCCCCC">just type in the custom URL scheme</font><font color="#E5E5E5"> and</font>

525
00:25:41,480 --> 00:25:46,160
<font color="#E5E5E5">you will see the malware will just</font>

526
00:25:43,309 --> 00:25:48,530
launch itself<font color="#E5E5E5"> you can put</font><font color="#CCCCCC"> or</font><font color="#E5E5E5"> whatever</font>

527
00:25:46,160 --> 00:25:50,059
<font color="#E5E5E5">you want to</font><font color="#CCCCCC"> put there you have a user</font>

528
00:25:48,530 --> 00:25:53,000
constant<font color="#CCCCCC"> pop-up they'll tell you are you</font>

529
00:25:50,059 --> 00:25:57,139
<font color="#E5E5E5">sure you want to run this file and you</font>

530
00:25:53,000 --> 00:25:58,580
open<font color="#CCCCCC"> say yes so the name</font><font color="#E5E5E5"> of the file</font><font color="#CCCCCC"> is</font>

531
00:25:57,140 --> 00:26:01,280
controlled by<font color="#E5E5E5"> attacker so if the</font>

532
00:25:58,580 --> 00:26:03,770
attackers name the file as<font color="#E5E5E5"> Safari or</font>

533
00:26:01,280 --> 00:26:07,690
<font color="#E5E5E5">mail most of user will get tricked and</font>

534
00:26:03,770 --> 00:26:12,440
they click on yes so here<font color="#E5E5E5"> it is running</font>

535
00:26:07,690 --> 00:26:15,710
so yeah that's actually<font color="#E5E5E5"> the technique</font>

536
00:26:12,440 --> 00:26:17,360
they use so<font color="#E5E5E5"> on</font><font color="#CCCCCC"> Windows</font><font color="#E5E5E5"> this is not</font>

537
00:26:15,710 --> 00:26:19,460
<font color="#E5E5E5">possible because on</font><font color="#CCCCCC"> Windows</font><font color="#E5E5E5"> you want to</font>

538
00:26:17,360 --> 00:26:22,790
create a custom<font color="#CCCCCC"> URL scheme you need to</font>

539
00:26:19,460 --> 00:26:24,679
be admin we need to be admin to<font color="#CCCCCC"> add a</font>

540
00:26:22,790 --> 00:26:26,000
custom URL scheme<font color="#CCCCCC"> I need to do it by</font>

541
00:26:24,679 --> 00:26:31,250
hand<font color="#E5E5E5"> you need to add a register key</font>

542
00:26:26,000 --> 00:26:34,160
under HK class<font color="#CCCCCC"> route you need</font><font color="#E5E5E5"> to add a</font>

543
00:26:31,250 --> 00:26:37,850
key there I need to<font color="#CCCCCC"> be admin right on</font>

544
00:26:34,160 --> 00:26:43,540
Mac you<font color="#CCCCCC"> don't need to be admin so that's</font>

545
00:26:37,850 --> 00:26:43,540
actually the<font color="#CCCCCC"> technique they use</font>

546
00:26:44,970 --> 00:26:58,320
yeah something interesting about this

547
00:26:53,460 --> 00:27:00,150
sample is it looks<font color="#E5E5E5"> like one of the</font>

548
00:26:58,320 --> 00:27:02,760
samples from 2012 which<font color="#CCCCCC"> is a</font>

549
00:27:00,150 --> 00:27:06,289
surveillance<font color="#E5E5E5"> malware</font><font color="#CCCCCC"> so I went all these</font>

550
00:27:02,760 --> 00:27:10,379
<font color="#CCCCCC">samples from 2012 actually I found</font><font color="#E5E5E5"> some</font>

551
00:27:06,289 --> 00:27:12,658
code<font color="#CCCCCC"> reuse so the code that</font><font color="#E5E5E5"> was reused</font>

552
00:27:10,380 --> 00:27:15,120
it here was a function helper function

553
00:27:12,659 --> 00:27:17,730
<font color="#CCCCCC">that</font><font color="#E5E5E5"> was the last</font><font color="#CCCCCC"> eight byte of a file</font>

554
00:27:15,120 --> 00:27:20,280
<font color="#E5E5E5">and I</font><font color="#CCCCCC"> found the exact same function</font><font color="#E5E5E5"> on</font>

555
00:27:17,730 --> 00:27:23,070
this new sample which is<font color="#CCCCCC"> a sign of</font><font color="#E5E5E5"> code</font>

556
00:27:20,280 --> 00:27:25,918
<font color="#E5E5E5">reuse it means this guy for some reason</font>

557
00:27:23,070 --> 00:27:30,120
they get access<font color="#CCCCCC"> to the source code</font><font color="#E5E5E5"> of a</font>

558
00:27:25,919 --> 00:27:34,500
malware<font color="#E5E5E5"> from 2012</font><font color="#CCCCCC"> and the malware from</font>

559
00:27:30,120 --> 00:27:37,110
2012 was there was an attribution by

560
00:27:34,500 --> 00:27:39,750
<font color="#E5E5E5">Norman group and I said this is part of</font>

561
00:27:37,110 --> 00:27:42,449
<font color="#E5E5E5">Operation hangover or</font><font color="#CCCCCC"> app</font><font color="#E5E5E5"> insecurity</font>

562
00:27:39,750 --> 00:27:48,780
which is a Indian company doing

563
00:27:42,450 --> 00:27:51,510
offensive type<font color="#E5E5E5"> of work but it's from</font>

564
00:27:48,780 --> 00:27:53,820
2012<font color="#CCCCCC"> and actually these companies</font><font color="#E5E5E5"> closed</font>

565
00:27:51,510 --> 00:27:56,640
the<font color="#E5E5E5"> business it doesn't exist anymore</font>

566
00:27:53,820 --> 00:27:58,049
<font color="#E5E5E5">but these guys</font><font color="#CCCCCC"> have this sample they</font>

567
00:27:56,640 --> 00:28:00,510
have the source code they<font color="#E5E5E5"> modified the</font>

568
00:27:58,049 --> 00:28:02,570
source code and<font color="#E5E5E5"> they use</font><font color="#CCCCCC"> it again</font><font color="#E5E5E5"> to</font>

569
00:28:00,510 --> 00:28:07,289
hack into government<font color="#E5E5E5"> so it's kind of</font>

570
00:28:02,570 --> 00:28:09,299
unusual<font color="#CCCCCC"> I'll say win Selby's</font><font color="#E5E5E5"> a second</font>

571
00:28:07,289 --> 00:28:10,520
variant<font color="#E5E5E5"> this</font><font color="#CCCCCC"> one is</font><font color="#E5E5E5"> very simple they</font>

572
00:28:09,299 --> 00:28:15,000
just<font color="#E5E5E5"> send it as an email attachment</font>

573
00:28:10,520 --> 00:28:18,480
<font color="#CCCCCC">that's</font><font color="#E5E5E5"> pretty much it</font><font color="#CCCCCC"> it has</font>

574
00:28:15,000 --> 00:28:21,390
similarities<font color="#E5E5E5"> with the sofa see apt you</font>

575
00:28:18,480 --> 00:28:24,059
<font color="#E5E5E5">know</font><font color="#CCCCCC"> there's</font><font color="#E5E5E5"> a complex</font><font color="#CCCCCC"> wessex malware</font>

576
00:28:21,390 --> 00:28:26,370
they used and this one<font color="#E5E5E5"> they actually</font>

577
00:28:24,059 --> 00:28:28,620
<font color="#CCCCCC">used reachability</font><font color="#E5E5E5"> framework to test if</font>

578
00:28:26,370 --> 00:28:30,030
google.com can which to<font color="#CCCCCC"> do that come</font>

579
00:28:28,620 --> 00:28:32,879
<font color="#CCCCCC">it's a way to test if the internet</font>

580
00:28:30,030 --> 00:28:34,799
<font color="#CCCCCC">connection is working</font><font color="#E5E5E5"> actually they use</font>

581
00:28:32,880 --> 00:28:37,500
the exact<font color="#CCCCCC"> same</font><font color="#E5E5E5"> technique here in this</font>

582
00:28:34,799 --> 00:28:41,309
sample<font color="#E5E5E5"> which is kind of kind of strange</font>

583
00:28:37,500 --> 00:28:44,490
and<font color="#E5E5E5"> complex</font><font color="#CCCCCC"> where</font><font color="#E5E5E5"> six are being</font><font color="#CCCCCC"> hosted</font>

584
00:28:41,309 --> 00:28:49,799
in<font color="#CCCCCC"> ultra house be V which is a provider</font>

585
00:28:44,490 --> 00:28:55,620
into<font color="#E5E5E5"> a you know Netherlands and actually</font>

586
00:28:49,799 --> 00:28:58,670
hang over to what was hosted within<font color="#E5E5E5"> the</font>

587
00:28:55,620 --> 00:29:01,590
same provider<font color="#E5E5E5"> in 2012 so</font>

588
00:28:58,670 --> 00:29:03,810
we<font color="#E5E5E5"> probably start seeing something right</font>

589
00:29:01,590 --> 00:29:08,159
now<font color="#CCCCCC"> but this clearly</font><font color="#E5E5E5"> a relation between</font>

590
00:29:03,810 --> 00:29:10,980
the<font color="#E5E5E5"> two somehow so we have wind tape so</font>

591
00:29:08,160 --> 00:29:13,800
wind tape is a another malware<font color="#E5E5E5"> but this</font>

592
00:29:10,980 --> 00:29:17,250
one takes screenshots<font color="#E5E5E5"> of</font><font color="#CCCCCC"> the user</font><font color="#E5E5E5"> so</font>

593
00:29:13,800 --> 00:29:20,399
basically it's downloaded by wind<font color="#CCCCCC"> she'll</font>

594
00:29:17,250 --> 00:29:26,040
be the previous<font color="#E5E5E5"> sample that's the HTTP</font>

595
00:29:20,400 --> 00:29:29,790
request<font color="#CCCCCC"> downloading</font><font color="#E5E5E5"> the green tape so</font>

596
00:29:26,040 --> 00:29:31,830
<font color="#CCCCCC">winter what it does take screenshot</font><font color="#E5E5E5"> send</font>

597
00:29:29,790 --> 00:29:34,830
the screenshot to<font color="#CCCCCC"> the c2 server</font><font color="#E5E5E5"> remove</font>

598
00:29:31,830 --> 00:29:35,189
the screenshot<font color="#CCCCCC"> I</font><font color="#E5E5E5"> repeat that's what it</font>

599
00:29:34,830 --> 00:29:37,050
<font color="#E5E5E5">does</font>

600
00:29:35,190 --> 00:29:39,810
so it constantly taking screenshots of

601
00:29:37,050 --> 00:29:44,040
your<font color="#CCCCCC"> desktop and sending the image to a</font>

602
00:29:39,810 --> 00:29:48,300
c2 server<font color="#CCCCCC"> it's kind of funny because we</font>

603
00:29:44,040 --> 00:29:52,860
found some classes<font color="#CCCCCC"> written in Pharisees</font>

604
00:29:48,300 --> 00:29:56,600
<font color="#CCCCCC">or</font><font color="#E5E5E5"> Pharisee</font><font color="#CCCCCC"> or Persian</font><font color="#E5E5E5"> language we found</font>

605
00:29:52,860 --> 00:30:00,270
for example goalie goalie so goalie in a

606
00:29:56,600 --> 00:30:04,260
Pharisee means flower and<font color="#CCCCCC"> nanaki means</font>

607
00:30:00,270 --> 00:30:07,379
salt<font color="#E5E5E5"> so it's kind of very strange that</font>

608
00:30:04,260 --> 00:30:09,660
we<font color="#E5E5E5"> found this name classes written</font>

609
00:30:07,380 --> 00:30:14,940
Pharisee<font color="#E5E5E5"> so it looks</font><font color="#CCCCCC"> like someone trying</font>

610
00:30:09,660 --> 00:30:18,150
to you know work<font color="#E5E5E5"> on kind of false the</font>

611
00:30:14,940 --> 00:30:21,020
attribution<font color="#CCCCCC"> or make us believe that some</font>

612
00:30:18,150 --> 00:30:24,000
Persian<font color="#E5E5E5"> speaking actors are behind this</font>

613
00:30:21,020 --> 00:30:28,170
the swing encryption for this one was

614
00:30:24,000 --> 00:30:30,870
<font color="#CCCCCC">just using</font><font color="#E5E5E5"> this with a with an IV so I</font>

615
00:30:28,170 --> 00:30:35,720
<font color="#E5E5E5">just wrote the</font><font color="#CCCCCC"> Objective C using</font><font color="#E5E5E5"> C</font>

616
00:30:30,870 --> 00:30:41,340
<font color="#E5E5E5">script to decrypt it</font><font color="#CCCCCC"> a small demo</font>

617
00:30:35,720 --> 00:30:51,740
showing this actually<font color="#E5E5E5"> malware taking</font>

618
00:30:41,340 --> 00:30:51,740
screenshots very full screen<font color="#CCCCCC"> okay</font>

619
00:30:58,850 --> 00:31:05,269
[Music]

620
00:31:00,230 --> 00:31:05,269
<font color="#CCCCCC">yep yeah I got it thanks</font>

621
00:31:05,419 --> 00:31:13,799
<font color="#E5E5E5">fullscreen</font><font color="#CCCCCC"> yeah so the Monroy name is</font>

622
00:31:10,169 --> 00:31:15,990
LSD<font color="#CCCCCC"> it's in desktop as you can see it's</font>

623
00:31:13,799 --> 00:31:20,639
here it's here so<font color="#E5E5E5"> I</font><font color="#CCCCCC"> just double click on</font>

624
00:31:15,990 --> 00:31:23,509
it and<font color="#E5E5E5"> watch carefully what happens so</font>

625
00:31:20,639 --> 00:31:27,600
it's gonna persist inside<font color="#CCCCCC"> a user library</font>

626
00:31:23,509 --> 00:31:33,990
<font color="#E5E5E5">at</font><font color="#CCCCCC"> a-z that app this</font><font color="#E5E5E5"> is where it</font>

627
00:31:27,600 --> 00:31:35,939
persists and actually it goes<font color="#CCCCCC"> to the</font>

628
00:31:33,990 --> 00:31:38,070
<font color="#E5E5E5">boundary</font><font color="#CCCCCC"> source folder is this is where</font>

629
00:31:35,940 --> 00:31:40,159
it gonna store the<font color="#E5E5E5"> screenshots so watch</font>

630
00:31:38,070 --> 00:31:44,629
carefully<font color="#E5E5E5"> here is the screenshot and</font>

631
00:31:40,159 --> 00:31:50,639
then disappears<font color="#E5E5E5"> that's gonna come</font><font color="#CCCCCC"> again</font>

632
00:31:44,629 --> 00:31:53,490
so every<font color="#CCCCCC"> 5 seconds</font><font color="#E5E5E5"> or so he's here he's</font>

633
00:31:50,639 --> 00:31:56,219
<font color="#E5E5E5">gone so I try to copy it but so I'm</font>

634
00:31:53,490 --> 00:32:00,929
gonna copy<font color="#E5E5E5"> it now so as soon as it</font>

635
00:31:56,220 --> 00:32:08,309
appears<font color="#CCCCCC"> I just try to copy it yeah table</font>

636
00:32:00,929 --> 00:32:11,549
<font color="#E5E5E5">click on it and as</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> can</font><font color="#CCCCCC"> see it's a</font>

637
00:32:08,309 --> 00:32:19,799
screenshot<font color="#E5E5E5"> so what happens to</font><font color="#CCCCCC"> this</font>

638
00:32:11,549 --> 00:32:27,259
screenshot actually is is actually<font color="#CCCCCC"> I'm</font>

639
00:32:19,799 --> 00:32:29,970
<font color="#E5E5E5">gonna just send another video here yep</font>

640
00:32:27,259 --> 00:32:34,200
and<font color="#E5E5E5"> you will see that this screenshot is</font>

641
00:32:29,970 --> 00:32:38,159
actually sent<font color="#E5E5E5"> to the c2 server right</font>

642
00:32:34,200 --> 00:32:41,190
away<font color="#E5E5E5"> and then is from so it's kind of a</font>

643
00:32:38,159 --> 00:32:43,889
big deal<font color="#CCCCCC"> because we never see something</font>

644
00:32:41,190 --> 00:32:46,440
<font color="#E5E5E5">like</font><font color="#CCCCCC"> that till now like not</font><font color="#E5E5E5"> no other</font>

645
00:32:43,889 --> 00:32:49,649
malware<font color="#E5E5E5"> does this so it's kind of</font>

646
00:32:46,440 --> 00:32:51,480
something new actually and also<font color="#E5E5E5"> people</font>

647
00:32:49,649 --> 00:32:54,928
need<font color="#E5E5E5"> to see this</font><font color="#CCCCCC"> in real life</font><font color="#E5E5E5"> so they</font>

648
00:32:51,480 --> 00:32:57,119
<font color="#E5E5E5">can understand the impact</font><font color="#CCCCCC"> of this so as</font>

649
00:32:54,929 --> 00:32:59,940
you can see<font color="#CCCCCC"> all</font><font color="#E5E5E5"> these post requests are</font>

650
00:32:57,119 --> 00:33:05,009
all<font color="#CCCCCC"> sending</font><font color="#E5E5E5"> the picture as you can see</font>

651
00:32:59,940 --> 00:33:09,210
to the<font color="#CCCCCC"> c2 server all right so that's a</font>

652
00:33:05,009 --> 00:33:11,240
real real world example that I just<font color="#CCCCCC"> show</font>

653
00:33:09,210 --> 00:33:11,240
you

654
00:33:14,600 --> 00:33:22,250
one last<font color="#E5E5E5"> note about</font><font color="#CCCCCC"> this mac</font><font color="#E5E5E5"> OS malware</font>

655
00:33:17,429 --> 00:33:26,779
they all use<font color="#CCCCCC"> hard-coded es key using</font>

656
00:33:22,250 --> 00:33:30,169
utf-16<font color="#CCCCCC"> little-endian so now utf-8</font>

657
00:33:26,779 --> 00:33:33,090
<font color="#E5E5E5">services and they use some sort of</font>

658
00:33:30,169 --> 00:33:34,860
<font color="#CCCCCC">Danish keyboard to write those type of</font>

659
00:33:33,090 --> 00:33:38,100
<font color="#E5E5E5">characters</font><font color="#CCCCCC"> but those are the hard-coded</font>

660
00:33:34,860 --> 00:33:40,340
keys that were found on each of these

661
00:33:38,100 --> 00:33:40,340
samples

662
00:33:41,490 --> 00:33:46,620
that's the<font color="#CCCCCC"> Windows variant that</font><font color="#E5E5E5"> we found</font>

663
00:33:44,399 --> 00:33:48,689
<font color="#CCCCCC">wind drop is actually a Windows malware</font>

664
00:33:46,620 --> 00:33:51,299
talking to the same<font color="#CCCCCC"> situ server as the</font>

665
00:33:48,690 --> 00:33:53,549
other<font color="#E5E5E5"> Mac OS malware so the same</font><font color="#CCCCCC"> c2</font>

666
00:33:51,299 --> 00:33:56,908
server<font color="#CCCCCC"> talked to Windows malware to Mac</font>

667
00:33:53,549 --> 00:33:58,320
OS malware<font color="#E5E5E5"> and this one what it does</font>

668
00:33:56,909 --> 00:34:00,419
it's when it's run it took all the

669
00:33:58,320 --> 00:34:02,580
information<font color="#E5E5E5"> current user pass et cetera</font>

670
00:34:00,419 --> 00:34:05,009
<font color="#E5E5E5">send it to the server and then it</font>

671
00:34:02,580 --> 00:34:06,899
downloads another stage and we<font color="#CCCCCC"> were</font><font color="#E5E5E5"> not</font>

672
00:34:05,009 --> 00:34:08,819
<font color="#E5E5E5">able to figure out what</font><font color="#CCCCCC"> this stage is</font>

673
00:34:06,899 --> 00:34:10,109
because<font color="#E5E5E5"> it was removed from the c2</font>

674
00:34:08,819 --> 00:34:13,290
server but this is<font color="#E5E5E5"> something we're</font>

675
00:34:10,109 --> 00:34:16,440
currently<font color="#CCCCCC"> working on that will be the</font>

676
00:34:13,290 --> 00:34:18,869
tool set<font color="#CCCCCC"> for this</font><font color="#E5E5E5"> particular malware the</font>

677
00:34:16,440 --> 00:34:22,349
<font color="#CCCCCC">Windows one the decryption routine was</font>

678
00:34:18,869 --> 00:34:24,810
kind of different<font color="#E5E5E5"> because it was using a</font>

679
00:34:22,349 --> 00:34:27,300
standalone function<font color="#E5E5E5"> that does the</font>

680
00:34:24,810 --> 00:34:29,909
decryption<font color="#E5E5E5"> so figure out why not we can</font>

681
00:34:27,300 --> 00:34:31,500
so that's<font color="#CCCCCC"> a function</font><font color="#E5E5E5"> actually and it's</font>

682
00:34:29,909 --> 00:34:33,060
the same function<font color="#E5E5E5"> called everywhere to</font>

683
00:34:31,500 --> 00:34:34,770
decrypt all the strings so I was

684
00:34:33,060 --> 00:34:37,828
<font color="#E5E5E5">figuring out why not June just doing</font>

685
00:34:34,770 --> 00:34:39,629
emulation<font color="#E5E5E5"> because you don't want to</font>

686
00:34:37,829 --> 00:34:41,250
spend<font color="#E5E5E5"> a lot of time in</font><font color="#CCCCCC"> some time</font><font color="#E5E5E5"> when</font>

687
00:34:39,629 --> 00:34:43,168
you<font color="#CCCCCC"> are now is in something</font><font color="#E5E5E5"> you need to</font>

688
00:34:41,250 --> 00:34:45,418
<font color="#E5E5E5">have answers in within the day so</font>

689
00:34:43,168 --> 00:34:48,149
sometimes<font color="#CCCCCC"> you don't need to go through</font>

690
00:34:45,418 --> 00:34:50,690
<font color="#E5E5E5">all the decryption function so you just</font>

691
00:34:48,149 --> 00:34:54,388
need<font color="#CCCCCC"> to emulate</font><font color="#E5E5E5"> it and see what it</font><font color="#CCCCCC"> does</font>

692
00:34:50,690 --> 00:34:56,909
and doesn't people who does that with

693
00:34:54,389 --> 00:34:58,650
radar<font color="#E5E5E5"> and I thought it's good idea to do</font>

694
00:34:56,909 --> 00:35:02,040
it in<font color="#E5E5E5"> binary ninja to be kind of</font>

695
00:34:58,650 --> 00:35:03,599
different<font color="#CCCCCC"> from other people so we're</font>

696
00:35:02,040 --> 00:35:06,300
gonna decrypt the strings of this

697
00:35:03,599 --> 00:35:09,180
malware using unicorn in giant<font color="#E5E5E5"> using</font>

698
00:35:06,300 --> 00:35:12,480
binary ninja<font color="#E5E5E5"> Ripper and some ninja</font>

699
00:35:09,180 --> 00:35:16,649
skills<font color="#E5E5E5"> well</font><font color="#CCCCCC"> you're safe this it's not</font>

700
00:35:12,480 --> 00:35:21,550
<font color="#E5E5E5">really ninja skills but you know it's</font>

701
00:35:16,650 --> 00:35:28,090
still<font color="#CCCCCC"> okay</font>

702
00:35:21,550 --> 00:35:36,850
screen<font color="#CCCCCC"> ah sorry one second</font>

703
00:35:28,090 --> 00:35:43,660
yeah<font color="#E5E5E5"> yeah</font><font color="#CCCCCC"> full screen okay</font><font color="#E5E5E5"> so that's the</font>

704
00:35:36,850 --> 00:35:47,410
the binary so<font color="#CCCCCC"> a regular PE file x86 yeah</font>

705
00:35:43,660 --> 00:35:50,080
<font color="#E5E5E5">that's the basically the two point</font><font color="#CCCCCC"> and</font>

706
00:35:47,410 --> 00:35:52,120
actually<font color="#E5E5E5"> you see that's the the</font>

707
00:35:50,080 --> 00:35:54,040
encrypted strings and it goes through

708
00:35:52,120 --> 00:35:56,109
the same function<font color="#CCCCCC"> so the same function</font>

709
00:35:54,040 --> 00:35:57,550
does<font color="#E5E5E5"> the decryption</font><font color="#CCCCCC"> and the function</font><font color="#E5E5E5"> is</font>

710
00:35:56,110 --> 00:36:01,480
here that does the decryption<font color="#E5E5E5"> is</font>

711
00:35:57,550 --> 00:36:03,490
standalone function<font color="#E5E5E5"> and actually the</font>

712
00:36:01,480 --> 00:36:08,770
value the<font color="#CCCCCC"> current</font><font color="#E5E5E5"> point on the string is</font>

713
00:36:03,490 --> 00:36:11,140
on<font color="#E5E5E5"> ECX and it does some operations on</font>

714
00:36:08,770 --> 00:36:14,530
the current character<font color="#CCCCCC"> depending on a</font>

715
00:36:11,140 --> 00:36:17,529
value<font color="#E5E5E5"> that is EXO</font><font color="#CCCCCC"> dependent that value</font>

716
00:36:14,530 --> 00:36:21,850
either they decrement<font color="#CCCCCC"> ax</font><font color="#E5E5E5"> c CX either</font>

717
00:36:17,530 --> 00:36:24,700
they add 3 or this<font color="#CCCCCC"> subtractive value so</font>

718
00:36:21,850 --> 00:36:26,410
we<font color="#E5E5E5"> can clearly since</font><font color="#CCCCCC"> it's</font><font color="#E5E5E5"> a standalone</font>

719
00:36:24,700 --> 00:36:28,509
function<font color="#E5E5E5"> we can clearly emulate this</font>

720
00:36:26,410 --> 00:36:32,470
function<font color="#E5E5E5"> and be able</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> decrypt the</font>

721
00:36:28,510 --> 00:36:36,130
<font color="#E5E5E5">strings without the need to rewrite a</font>

722
00:36:32,470 --> 00:36:40,990
plugging in either pro whatever to

723
00:36:36,130 --> 00:36:42,610
decrypt<font color="#CCCCCC"> I mean to write</font><font color="#E5E5E5"> algorithm to</font>

724
00:36:40,990 --> 00:36:44,770
decrypt<font color="#CCCCCC"> the stream</font><font color="#E5E5E5"> you can just emulate</font>

725
00:36:42,610 --> 00:36:46,960
the function and job will be done<font color="#E5E5E5"> so</font>

726
00:36:44,770 --> 00:36:49,840
here we're gonna<font color="#E5E5E5"> use Reaper</font>

727
00:36:46,960 --> 00:36:52,570
so Reaper is a very powerful<font color="#CCCCCC"> binary</font>

728
00:36:49,840 --> 00:36:57,670
image of plugging what<font color="#CCCCCC"> it's</font><font color="#E5E5E5"> gonna do is</font>

729
00:36:52,570 --> 00:36:59,590
gonna<font color="#E5E5E5"> generate</font><font color="#CCCCCC"> Python class where Y here</font>

730
00:36:57,670 --> 00:37:02,140
it looks kind of scary with a lot<font color="#E5E5E5"> of</font>

731
00:36:59,590 --> 00:37:04,270
code so what it<font color="#E5E5E5"> does is take the code</font>

732
00:37:02,140 --> 00:37:06,970
section the data<font color="#E5E5E5"> section map the memory</font>

733
00:37:04,270 --> 00:37:08,350
set the protections<font color="#E5E5E5"> and then set the</font>

734
00:37:06,970 --> 00:37:11,049
entry point and start<font color="#E5E5E5"> the emulation</font>

735
00:37:08,350 --> 00:37:14,040
<font color="#CCCCCC">that's what it does so I'm gonna close</font>

736
00:37:11,050 --> 00:37:19,210
<font color="#E5E5E5">this file and</font><font color="#CCCCCC"> open another one using</font>

737
00:37:14,040 --> 00:37:21,210
sublime yeah this is more readable<font color="#E5E5E5"> so as</font>

738
00:37:19,210 --> 00:37:24,220
you can<font color="#CCCCCC"> see we have the code section</font>

739
00:37:21,210 --> 00:37:28,330
data section what it does is just<font color="#E5E5E5"> gonna</font>

740
00:37:24,220 --> 00:37:29,919
you know map the mini memory<font color="#E5E5E5"> write them</font>

741
00:37:28,330 --> 00:37:33,240
their change protection execute them

742
00:37:29,920 --> 00:37:35,440
that's what it does as you can see the

743
00:37:33,240 --> 00:37:37,899
the memory address of the<font color="#CCCCCC"> star</font>

744
00:37:35,440 --> 00:37:39,670
art is<font color="#CCCCCC"> four</font><font color="#E5E5E5"> zero</font><font color="#CCCCCC"> four zero ten is</font>

745
00:37:37,900 --> 00:37:43,119
exactly the same<font color="#E5E5E5"> one and</font><font color="#CCCCCC"> we Anna saw the</font>

746
00:37:39,670 --> 00:37:46,329
emulation<font color="#CCCCCC"> but something very</font><font color="#E5E5E5"> important</font>

747
00:37:43,119 --> 00:37:48,369
is<font color="#E5E5E5"> we can do actually hooks for every op</font>

748
00:37:46,329 --> 00:37:50,290
code that is executed<font color="#CCCCCC"> so every time you</font>

749
00:37:48,369 --> 00:37:52,210
see an OP code you<font color="#CCCCCC"> have a hook and you</font>

750
00:37:50,290 --> 00:37:54,910
can do whatever you want<font color="#E5E5E5"> whatever</font>

751
00:37:52,210 --> 00:37:57,000
<font color="#E5E5E5">operation you want so</font><font color="#CCCCCC"> there's</font><font color="#E5E5E5"> a function</font>

752
00:37:54,910 --> 00:37:59,078
<font color="#CCCCCC">called</font><font color="#E5E5E5"> hook code so we just need</font><font color="#CCCCCC"> to</font>

753
00:37:57,000 --> 00:38:00,760
declare these functions<font color="#E5E5E5"> as virtual</font>

754
00:37:59,079 --> 00:38:03,760
functions so<font color="#E5E5E5"> we need to create our class</font>

755
00:38:00,760 --> 00:38:05,950
<font color="#E5E5E5">generate from it and define the function</font>

756
00:38:03,760 --> 00:38:12,900
and then define whatever<font color="#E5E5E5"> operation you</font>

757
00:38:05,950 --> 00:38:16,720
want<font color="#CCCCCC"> to do there and we have done this</font>

758
00:38:12,900 --> 00:38:20,380
here<font color="#E5E5E5"> so we define hook code and actually</font>

759
00:38:16,720 --> 00:38:24,098
in hooker what<font color="#E5E5E5"> I've done is as soon as I</font>

760
00:38:20,380 --> 00:38:26,050
see I<font color="#CCCCCC"> return</font><font color="#E5E5E5"> it means that I</font><font color="#CCCCCC"> finished</font>

761
00:38:24,099 --> 00:38:29,500
the decryption<font color="#E5E5E5"> and since I know it's in</font>

762
00:38:26,050 --> 00:38:32,680
<font color="#E5E5E5">ECX so all I have to do is dump the</font>

763
00:38:29,500 --> 00:38:34,990
value that point is X minus the length

764
00:38:32,680 --> 00:38:36,578
of the strings because<font color="#E5E5E5"> actually the</font>

765
00:38:34,990 --> 00:38:38,560
string<font color="#E5E5E5"> got the cripton memory but it</font>

766
00:38:36,579 --> 00:38:42,849
stays to where where is it<font color="#E5E5E5"> so I</font><font color="#CCCCCC"> just</font>

767
00:38:38,560 --> 00:38:45,849
need<font color="#E5E5E5"> to check ECX subscribe the land and</font>

768
00:38:42,849 --> 00:38:47,710
dump exactly<font color="#E5E5E5"> this play this memory</font><font color="#CCCCCC"> does</font>

769
00:38:45,849 --> 00:38:50,950
not<font color="#CCCCCC"> have the</font><font color="#E5E5E5"> decrypted same string</font>

770
00:38:47,710 --> 00:38:53,020
waiting<font color="#E5E5E5"> for me so this is all what I've</font>

771
00:38:50,950 --> 00:38:55,359
done<font color="#E5E5E5"> here</font>

772
00:38:53,020 --> 00:38:57,730
it took me<font color="#E5E5E5"> okay it took me like an hour</font>

773
00:38:55,359 --> 00:39:00,279
to<font color="#E5E5E5"> write</font><font color="#CCCCCC"> this but I'm</font><font color="#E5E5E5"> sure if you have a</font>

774
00:38:57,730 --> 00:39:01,930
template<font color="#E5E5E5"> you</font><font color="#CCCCCC"> can reuse it for</font><font color="#E5E5E5"> any type</font>

775
00:39:00,280 --> 00:39:04,660
of function<font color="#E5E5E5"> and</font><font color="#CCCCCC"> you're not going to</font>

776
00:39:01,930 --> 00:39:06,520
<font color="#E5E5E5">spend too much time doing it</font><font color="#CCCCCC"> and here</font>

777
00:39:04,660 --> 00:39:09,190
I'm just<font color="#E5E5E5"> going to run this</font><font color="#CCCCCC"> Python class</font>

778
00:39:06,520 --> 00:39:11,380
and you<font color="#E5E5E5"> will see the results so</font><font color="#CCCCCC"> I put</font>

779
00:39:09,190 --> 00:39:14,859
here<font color="#E5E5E5"> the disassembly</font><font color="#CCCCCC"> I will run the</font>

780
00:39:11,380 --> 00:39:16,990
Python code<font color="#CCCCCC"> that will do the emulation</font>

781
00:39:14,859 --> 00:39:20,770
<font color="#E5E5E5">for you</font><font color="#CCCCCC"> I did some pretty</font><font color="#E5E5E5"> printing to</font>

782
00:39:16,990 --> 00:39:23,618
show you like the the<font color="#E5E5E5"> results as you can</font>

783
00:39:20,770 --> 00:39:27,540
see in<font color="#E5E5E5"> blue is the</font><font color="#CCCCCC"> encrypted</font><font color="#E5E5E5"> string in</font>

784
00:39:23,619 --> 00:39:29,300
yellow is the decrypted one there you go

785
00:39:27,540 --> 00:39:33,650
so actually

786
00:39:29,300 --> 00:39:36,740
worked<font color="#E5E5E5"> without having me to understand</font>

787
00:39:33,650 --> 00:39:39,710
the decryption routine I just see from

788
00:39:36,740 --> 00:39:47,689
<font color="#E5E5E5">where it start from</font><font color="#CCCCCC"> what it ends DD</font>

789
00:39:39,710 --> 00:39:59,300
emulation<font color="#E5E5E5"> and</font><font color="#CCCCCC"> down the ECX alright go</font>

790
00:39:47,690 --> 00:40:03,290
<font color="#E5E5E5">back to the slides attribution</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> what I</font>

791
00:39:59,300 --> 00:40:06,260
mean here<font color="#CCCCCC"> is we have an actor using a</font>

792
00:40:03,290 --> 00:40:10,160
source code from<font color="#E5E5E5"> a malware</font><font color="#CCCCCC"> dating from</font>

793
00:40:06,260 --> 00:40:12,020
2012<font color="#CCCCCC"> reusing it</font><font color="#E5E5E5"> today the the company</font>

794
00:40:10,160 --> 00:40:12,740
that<font color="#CCCCCC"> runs</font><font color="#E5E5E5"> the malware actually closes</font>

795
00:40:12,020 --> 00:40:15,110
<font color="#E5E5E5">out of business</font>

796
00:40:12,740 --> 00:40:17,540
so it looks like<font color="#E5E5E5"> either this actor</font>

797
00:40:15,110 --> 00:40:21,490
<font color="#CCCCCC">actually hacked into the servers of this</font>

798
00:40:17,540 --> 00:40:23,810
company or bought the source code or

799
00:40:21,490 --> 00:40:26,209
some someone working<font color="#E5E5E5"> at</font><font color="#CCCCCC"> the previous</font>

800
00:40:23,810 --> 00:40:29,180
<font color="#E5E5E5">company sell the source code to these</font>

801
00:40:26,210 --> 00:40:30,950
guys<font color="#E5E5E5"> but clearly these guys are reusing</font>

802
00:40:29,180 --> 00:40:34,040
the source code because even on the last

803
00:40:30,950 --> 00:40:37,310
variant that<font color="#E5E5E5"> we found we saw signs of</font>

804
00:40:34,040 --> 00:40:38,960
modifications<font color="#E5E5E5"> and signs of code changes</font>

805
00:40:37,310 --> 00:40:43,430
it means that<font color="#E5E5E5"> these</font><font color="#CCCCCC"> guys</font><font color="#E5E5E5"> really had</font>

806
00:40:38,960 --> 00:40:45,410
their<font color="#E5E5E5"> source code of this malware</font><font color="#CCCCCC"> we</font>

807
00:40:43,430 --> 00:40:47,500
also did some analysis compared with

808
00:40:45,410 --> 00:40:51,049
<font color="#CCCCCC">what happening you know with other</font>

809
00:40:47,500 --> 00:40:54,530
actors with this actor called<font color="#CCCCCC"> bio mood</font>

810
00:40:51,050 --> 00:40:57,890
apt so it's track it by<font color="#CCCCCC"> bailing cut</font><font color="#E5E5E5"> you</font>

811
00:40:54,530 --> 00:41:00,170
guys know<font color="#CCCCCC"> billion cut so if you do try</font>

812
00:40:57,890 --> 00:41:04,040
to<font color="#E5E5E5"> Intel cyber espionage you you know</font>

813
00:41:00,170 --> 00:41:05,660
who is been in cat<font color="#CCCCCC"> cities</font><font color="#E5E5E5"> the lab being</font>

814
00:41:04,040 --> 00:41:08,060
<font color="#CCCCCC">cut all these</font><font color="#E5E5E5"> guys they're doing</font><font color="#CCCCCC"> great</font>

815
00:41:05,660 --> 00:41:11,480
stuff<font color="#CCCCCC"> so these guys are tracking Bahamut</font>

816
00:41:08,060 --> 00:41:15,730
<font color="#CCCCCC">apt and actually for some reason we</font>

817
00:41:11,480 --> 00:41:18,650
found the exact same MO<font color="#E5E5E5"> as</font><font color="#CCCCCC"> these guys</font><font color="#E5E5E5"> so</font>

818
00:41:15,730 --> 00:41:21,500
<font color="#CCCCCC">ature right is</font><font color="#E5E5E5"> wind</font><font color="#CCCCCC"> shape apt at your</font>

819
00:41:18,650 --> 00:41:25,010
left is bound as you see they're<font color="#CCCCCC"> using</font>

820
00:41:21,500 --> 00:41:29,330
the<font color="#E5E5E5"> same type of</font><font color="#CCCCCC"> MO they send you an</font>

821
00:41:25,010 --> 00:41:30,980
<font color="#CCCCCC">email with</font><font color="#E5E5E5"> tracking news you know some</font>

822
00:41:29,330 --> 00:41:33,890
content the duplicate<font color="#E5E5E5"> content send it to</font>

823
00:41:30,980 --> 00:41:38,840
you from a gmail account<font color="#E5E5E5"> they also have</font>

824
00:41:33,890 --> 00:41:41,680
their<font color="#E5E5E5"> LinkedIn account as well</font><font color="#CCCCCC"> you know</font>

825
00:41:38,840 --> 00:41:46,060
it's<font color="#CCCCCC"> kind of similar so that's the</font>

826
00:41:41,680 --> 00:41:48,940
she does the band they also send SMS

827
00:41:46,060 --> 00:41:50,230
<font color="#E5E5E5">same as Winship so</font><font color="#CCCCCC"> they're using</font><font color="#E5E5E5"> exactly</font>

828
00:41:48,940 --> 00:41:57,550
the same<font color="#CCCCCC"> techniques</font>

829
00:41:50,230 --> 00:42:00,730
<font color="#E5E5E5">okay and</font><font color="#CCCCCC"> building cat they went through</font>

830
00:41:57,550 --> 00:42:04,240
<font color="#CCCCCC">all the this was while ago so the</font><font color="#E5E5E5"> guys</font>

831
00:42:00,730 --> 00:42:08,140
<font color="#E5E5E5">did a</font><font color="#CCCCCC"> mistake OPSEC mistake</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> they</font>

832
00:42:04,240 --> 00:42:10,600
left<font color="#CCCCCC"> the email</font><font color="#E5E5E5"> address inside the</font>

833
00:42:08,140 --> 00:42:12,549
resistor domains so these guys were able

834
00:42:10,600 --> 00:42:14,950
<font color="#E5E5E5">to recover all the email</font><font color="#CCCCCC"> addresses that</font>

835
00:42:12,550 --> 00:42:17,500
you're gonna see something here they<font color="#CCCCCC"> all</font>

836
00:42:14,950 --> 00:42:20,649
<font color="#CCCCCC">always use</font><font color="#E5E5E5"> the English name followed</font>

837
00:42:17,500 --> 00:42:23,650
with a number right if you see<font color="#CCCCCC"> their</font>

838
00:42:20,650 --> 00:42:27,520
wind shift<font color="#CCCCCC"> it's kind</font><font color="#E5E5E5"> of the same English</font>

839
00:42:23,650 --> 00:42:29,620
<font color="#E5E5E5">name like current van or</font><font color="#CCCCCC"> worn in port</font>

840
00:42:27,520 --> 00:42:32,920
and there is a number<font color="#CCCCCC"> so it's kind of</font>

841
00:42:29,620 --> 00:42:37,089
mail.com and dark area so this<font color="#E5E5E5"> some some</font>

842
00:42:32,920 --> 00:42:42,160
kind<font color="#E5E5E5"> of of similarities right</font><font color="#CCCCCC"> there to</font>

843
00:42:37,090 --> 00:42:45,250
<font color="#E5E5E5">conclude this talk</font><font color="#CCCCCC"> so IP security is</font>

844
00:42:42,160 --> 00:42:49,359
from 2012<font color="#E5E5E5"> they probably got highly</font>

845
00:42:45,250 --> 00:42:51,880
likely either targeted by wind shift or

846
00:42:49,360 --> 00:42:54,340
they have their<font color="#E5E5E5"> tools stolen by a rogue</font>

847
00:42:51,880 --> 00:42:57,000
<font color="#CCCCCC">employee</font><font color="#E5E5E5"> we don't know or the tools were</font>

848
00:42:54,340 --> 00:43:01,960
sold to<font color="#E5E5E5"> a</font><font color="#CCCCCC"> third party but we have</font><font color="#E5E5E5"> facts</font>

849
00:42:57,000 --> 00:43:04,450
the fact<font color="#E5E5E5"> number one is the app</font>

850
00:43:01,960 --> 00:43:07,750
<font color="#CCCCCC">insecurity tools are reusing now today</font>

851
00:43:04,450 --> 00:43:11,109
<font color="#E5E5E5">to hack into government the fact number</font>

852
00:43:07,750 --> 00:43:15,370
two is we<font color="#E5E5E5"> found a lot of overlap with</font>

853
00:43:11,110 --> 00:43:20,350
existing apt actors by<font color="#E5E5E5"> mood so</font><font color="#CCCCCC"> fuzzy etc</font>

854
00:43:15,370 --> 00:43:23,799
<font color="#E5E5E5">and the fact</font><font color="#CCCCCC"> number three is</font><font color="#E5E5E5"> winch if a</font>

855
00:43:20,350 --> 00:43:27,640
<font color="#E5E5E5">PC are currently targeting</font><font color="#CCCCCC"> government's</font>

856
00:43:23,800 --> 00:43:29,800
using a pin security tools so that's

857
00:43:27,640 --> 00:43:33,190
pretty<font color="#E5E5E5"> much it</font><font color="#CCCCCC"> that's the the research</font>

858
00:43:29,800 --> 00:43:37,330
is about<font color="#CCCCCC"> and in</font><font color="#E5E5E5"> the next week's we can</font>

859
00:43:33,190 --> 00:43:39,520
publish<font color="#E5E5E5"> a blog</font><font color="#CCCCCC"> about a technical blog</font><font color="#E5E5E5"> so</font>

860
00:43:37,330 --> 00:43:41,290
<font color="#CCCCCC">gonna just document all these samples</font>

861
00:43:39,520 --> 00:43:43,470
<font color="#CCCCCC">that we found</font><font color="#E5E5E5"> we're going to provide</font>

862
00:43:41,290 --> 00:43:45,550
detection rules we're gonna provide

863
00:43:43,470 --> 00:43:50,129
<font color="#E5E5E5">disinfection routines and things like</font>

864
00:43:45,550 --> 00:43:55,210
that<font color="#E5E5E5"> we're also going to publish a</font>

865
00:43:50,130 --> 00:43:55,599
<font color="#CCCCCC">Macbook lockdown guide</font><font color="#E5E5E5"> that you guys can</font>

866
00:43:55,210 --> 00:43:58,660
<font color="#E5E5E5">use</font>

867
00:43:55,599 --> 00:44:01,930
lock<font color="#CCCCCC"> down your</font><font color="#E5E5E5"> MacBooks so here are some</font>

868
00:43:58,660 --> 00:44:03,430
references<font color="#CCCCCC"> if you guys interested</font><font color="#E5E5E5"> and I</font>

869
00:44:01,930 --> 00:44:09,519
would like<font color="#E5E5E5"> to thank you for</font><font color="#CCCCCC"> your</font>

870
00:44:03,430 --> 00:44:12,460
attendance<font color="#CCCCCC"> thank</font><font color="#E5E5E5"> you you guys have any</font>

871
00:44:09,519 --> 00:44:15,839
<font color="#E5E5E5">questions thank you for your talk are</font>

872
00:44:12,460 --> 00:44:15,839
there any questions<font color="#E5E5E5"> from the</font><font color="#CCCCCC"> audience</font>

873
00:44:19,380 --> 00:44:26,619
hi my name is kami<font color="#CCCCCC"> I want to ask for</font><font color="#E5E5E5"> the</font>

874
00:44:23,979 --> 00:44:29,259
sample that was the periodic<font color="#E5E5E5"> screenshots</font>

875
00:44:26,619 --> 00:44:31,690
<font color="#E5E5E5">was the traffic</font><font color="#CCCCCC"> if I wanted</font><font color="#E5E5E5"> to show</font><font color="#CCCCCC"> the</font>

876
00:44:29,259 --> 00:44:33,819
<font color="#E5E5E5">Wireshark traffic right was</font><font color="#CCCCCC"> de</font><font color="#E5E5E5"> traffic</font>

877
00:44:31,690 --> 00:44:37,359
<font color="#CCCCCC">was infected how was it</font>

878
00:44:33,819 --> 00:44:39,569
encrypted<font color="#E5E5E5"> no actually the beacon the</font>

879
00:44:37,359 --> 00:44:42,910
beacon was<font color="#CCCCCC"> hard-coded in his sample and</font>

880
00:44:39,569 --> 00:44:45,670
the sample that was sent was<font color="#CCCCCC"> a zip file</font>

881
00:44:42,910 --> 00:44:48,129
<font color="#CCCCCC">so there</font><font color="#E5E5E5"> was no absolutely no encryption</font>

882
00:44:45,670 --> 00:44:51,369
<font color="#E5E5E5">at the network level so the screenshots</font>

883
00:44:48,130 --> 00:44:53,619
were sent in clear text<font color="#CCCCCC"> the download</font>

884
00:44:51,369 --> 00:44:56,380
second stage was Donald inside the zip

885
00:44:53,619 --> 00:45:00,059
file<font color="#E5E5E5"> that's all so and the flight</font><font color="#CCCCCC"> are</font>

886
00:44:56,380 --> 00:45:03,999
<font color="#E5E5E5">exfiltrated are sent inside zip pipes so</font>

887
00:45:00,059 --> 00:45:12,190
it's under zip<font color="#CCCCCC"> fun thanks yeah no</font>

888
00:45:03,999 --> 00:45:16,589
encryptions thank you

889
00:45:12,190 --> 00:45:19,329
my question was about<font color="#E5E5E5"> so he said that</font>

890
00:45:16,589 --> 00:45:20,828
<font color="#E5E5E5">these guys only operate once or twice</font>

891
00:45:19,329 --> 00:45:22,749
here I mean they they<font color="#CCCCCC"> come from</font><font color="#E5E5E5"> they try</font>

892
00:45:20,829 --> 00:45:26,289
and compromise someone once and twice a

893
00:45:22,749 --> 00:45:29,618
year and the the period<font color="#CCCCCC"> in which they</font>

894
00:45:26,289 --> 00:45:31,660
plan the attack is you know in his

895
00:45:29,619 --> 00:45:35,229
<font color="#E5E5E5">measured in years like one one to two</font>

896
00:45:31,660 --> 00:45:36,519
years and<font color="#CCCCCC"> you</font><font color="#E5E5E5"> also said they target</font>

897
00:45:35,229 --> 00:45:39,279
individuals<font color="#CCCCCC"> and they don't</font><font color="#E5E5E5"> target</font>

898
00:45:36,519 --> 00:45:41,859
companies so it's easy enough<font color="#E5E5E5"> to</font>

899
00:45:39,279 --> 00:45:45,130
understand why these groups<font color="#E5E5E5"> attack</font>

900
00:45:41,859 --> 00:45:47,170
companies there's a lot of value to to

901
00:45:45,130 --> 00:45:48,849
get from these type of<font color="#CCCCCC"> attacks but do</font>

902
00:45:47,170 --> 00:45:51,099
you have any<font color="#E5E5E5"> information about why that</font>

903
00:45:48,849 --> 00:45:53,049
the the type of<font color="#E5E5E5"> people that they are</font>

904
00:45:51,099 --> 00:45:55,420
that<font color="#E5E5E5"> they're targeting because it must</font>

905
00:45:53,049 --> 00:45:58,229
<font color="#E5E5E5">be a very specific profile that they</font>

906
00:45:55,420 --> 00:46:01,390
going after for it to be worth it

907
00:45:58,229 --> 00:46:04,450
<font color="#CCCCCC">otherwise you</font><font color="#E5E5E5"> know if that if they're</font>

908
00:46:01,390 --> 00:46:07,150
hacking<font color="#CCCCCC"> a couple of average people</font><font color="#E5E5E5"> pay</font>

909
00:46:04,450 --> 00:46:09,140
it wouldn't really be rentable so<font color="#E5E5E5"> I</font>

910
00:46:07,150 --> 00:46:10,579
<font color="#E5E5E5">don't</font><font color="#CCCCCC"> if you have any information about</font>

911
00:46:09,140 --> 00:46:14,538
kind<font color="#E5E5E5"> of people they're going after and</font>

912
00:46:10,579 --> 00:46:16,700
why<font color="#E5E5E5"> yeah so I can't say much about the</font>

913
00:46:14,539 --> 00:46:19,670
<font color="#E5E5E5">people they're targeting but those</font>

914
00:46:16,700 --> 00:46:22,788
people have<font color="#E5E5E5"> something I mean they work</font>

915
00:46:19,670 --> 00:46:24,740
at certain entities<font color="#E5E5E5"> right</font><font color="#CCCCCC"> mostly</font>

916
00:46:22,789 --> 00:46:29,240
government<font color="#E5E5E5"> so they are looking after</font>

917
00:46:24,740 --> 00:46:33,339
<font color="#E5E5E5">these people</font><font color="#CCCCCC"> we had a case where one</font>

918
00:46:29,240 --> 00:46:38,000
person opened the personal<font color="#E5E5E5"> email account</font>

919
00:46:33,339 --> 00:46:40,519
<font color="#E5E5E5">inside the</font><font color="#CCCCCC"> corporate environment and</font>

920
00:46:38,000 --> 00:46:43,099
actually downloaded the malware<font color="#E5E5E5"> inside</font>

921
00:46:40,519 --> 00:46:46,189
the corporate government corporate

922
00:46:43,099 --> 00:46:48,529
environment and they were able to

923
00:46:46,190 --> 00:46:50,839
<font color="#E5E5E5">expedite</font><font color="#CCCCCC"> these files I mean this</font>

924
00:46:48,529 --> 00:46:53,660
individual<font color="#E5E5E5"> was created a personal</font><font color="#CCCCCC"> email</font>

925
00:46:50,839 --> 00:46:55,069
<font color="#CCCCCC">and used it within</font><font color="#E5E5E5"> use day I work for</font>

926
00:46:53,660 --> 00:46:57,859
example<font color="#E5E5E5"> or in the office</font>

927
00:46:55,069 --> 00:47:00,680
and yeah I cannot say much about it<font color="#CCCCCC"> yeah</font>

928
00:46:57,859 --> 00:47:01,730
<font color="#E5E5E5">but</font><font color="#CCCCCC"> okay it's it's a it's an individual</font>

929
00:47:00,680 --> 00:47:04,990
that was<font color="#CCCCCC"> targeted</font>

930
00:47:01,730 --> 00:47:08,690
there was<font color="#E5E5E5"> approached it via LinkedIn and</font>

931
00:47:04,990 --> 00:47:11,390
and you know that's<font color="#E5E5E5"> how they</font><font color="#CCCCCC"> actually</font>

932
00:47:08,690 --> 00:47:14,390
approached<font color="#E5E5E5"> this person and they were</font>

933
00:47:11,390 --> 00:47:16,549
lucky<font color="#CCCCCC"> enough</font><font color="#E5E5E5"> to have this person</font><font color="#CCCCCC"> up in</font>

934
00:47:14,390 --> 00:47:19,009
her personal emails inside the corporate

935
00:47:16,549 --> 00:47:21,109
environment<font color="#E5E5E5"> so they were</font><font color="#CCCCCC"> able to get</font>

936
00:47:19,009 --> 00:47:24,140
corporate files as well<font color="#E5E5E5"> it just seems</font>

937
00:47:21,109 --> 00:47:26,058
that<font color="#E5E5E5"> the reward to to risk ratio that is</font>

938
00:47:24,140 --> 00:47:28,670
<font color="#E5E5E5">very unbalanced to like if they don't</font>

939
00:47:26,059 --> 00:47:32,480
<font color="#CCCCCC">actually get</font><font color="#E5E5E5"> to that target but because</font>

940
00:47:28,670 --> 00:47:33,920
it's not a mass mass targeting<font color="#E5E5E5"> approach</font>

941
00:47:32,480 --> 00:47:35,750
<font color="#E5E5E5">they're very</font><font color="#CCCCCC"> specific about who they</font>

942
00:47:33,920 --> 00:47:38,119
target<font color="#E5E5E5"> if they miss their target you</font>

943
00:47:35,750 --> 00:47:40,819
know all the<font color="#CCCCCC"> resources they put towards</font>

944
00:47:38,119 --> 00:47:45,890
compromising that passing so goes to

945
00:47:40,819 --> 00:47:49,730
waste<font color="#CCCCCC"> in</font><font color="#E5E5E5"> a sense so I think from their</font>

946
00:47:45,890 --> 00:47:52,400
mo<font color="#CCCCCC"> it looks like a they have all the</font>

947
00:47:49,730 --> 00:47:55,910
properties<font color="#CCCCCC"> of a state-sponsored</font><font color="#E5E5E5"> type of</font>

948
00:47:52,400 --> 00:47:57,799
factor<font color="#E5E5E5"> okay these are not</font><font color="#CCCCCC"> amateurs or</font>

949
00:47:55,910 --> 00:48:00,308
guys sitting somewhere<font color="#CCCCCC"> in a cave doing</font>

950
00:47:57,799 --> 00:48:04,038
their things this is like a sponsored

951
00:48:00,309 --> 00:48:08,000
<font color="#E5E5E5">state-sponsored</font><font color="#CCCCCC"> advisory</font><font color="#E5E5E5"> so they have a</font>

952
00:48:04,039 --> 00:48:11,240
budget<font color="#E5E5E5"> they have resources and he</font>

953
00:48:08,000 --> 00:48:13,430
they've been there<font color="#CCCCCC"> since 2016 and they</font>

954
00:48:11,240 --> 00:48:16,519
are in the long term and are<font color="#E5E5E5"> very</font>

955
00:48:13,430 --> 00:48:19,098
persistent<font color="#CCCCCC"> so they're gonna spend the</font>

956
00:48:16,519 --> 00:48:21,529
<font color="#CCCCCC">whole time in</font><font color="#E5E5E5"> needed to get inside</font><font color="#CCCCCC"> a</font>

957
00:48:19,099 --> 00:48:22,430
<font color="#E5E5E5">computer of a certain</font><font color="#CCCCCC"> target either by</font>

958
00:48:21,529 --> 00:48:25,550
using<font color="#CCCCCC"> Spearfish</font>

959
00:48:22,430 --> 00:48:28,220
for a long period of<font color="#CCCCCC"> time</font><font color="#E5E5E5"> or if they are</font>

960
00:48:25,550 --> 00:48:31,910
hopeless<font color="#CCCCCC"> they're gonna reuse another</font>

961
00:48:28,220 --> 00:48:33,709
malware<font color="#CCCCCC"> is to target</font><font color="#E5E5E5"> this individual so</font>

962
00:48:31,910 --> 00:48:36,109
<font color="#CCCCCC">that even</font><font color="#E5E5E5"> when</font><font color="#CCCCCC"> we found the</font><font color="#E5E5E5"> model is not</font>

963
00:48:33,710 --> 00:48:38,030
<font color="#E5E5E5">easy to</font><font color="#CCCCCC"> do the attribution to</font><font color="#E5E5E5"> them as</font>

964
00:48:36,109 --> 00:48:41,839
<font color="#E5E5E5">you see here they use a malware for</font>

965
00:48:38,030 --> 00:48:43,970
another actor<font color="#E5E5E5"> so they really know</font><font color="#CCCCCC"> what</font>

966
00:48:41,839 --> 00:48:48,170
they<font color="#CCCCCC"> doing and they have a very</font><font color="#E5E5E5"> very</font>

967
00:48:43,970 --> 00:48:48,799
<font color="#E5E5E5">good OPSEC and as I said they work for</font>

968
00:48:48,170 --> 00:48:53,030
the<font color="#CCCCCC"> long-term</font>

969
00:48:48,800 --> 00:48:54,829
<font color="#E5E5E5">they don't mind spending one year there</font>

970
00:48:53,030 --> 00:48:57,800
<font color="#E5E5E5">was a case where they literally spent</font>

971
00:48:54,829 --> 00:49:00,490
<font color="#E5E5E5">one year to get inside one target came</font>

972
00:48:57,800 --> 00:49:04,040
here they took one year<font color="#CCCCCC"> so one year of</font>

973
00:49:00,490 --> 00:49:06,649
emails<font color="#E5E5E5"> tracking spearfishing additional</font>

974
00:49:04,040 --> 00:49:09,770
harvesting<font color="#E5E5E5"> didn't work and in one day</font>

975
00:49:06,650 --> 00:49:13,099
<font color="#E5E5E5">they sent an</font><font color="#CCCCCC"> attachment with the</font><font color="#E5E5E5"> link</font>

976
00:49:09,770 --> 00:49:16,640
and<font color="#E5E5E5"> you know so yeah I think they have</font>

977
00:49:13,099 --> 00:49:19,579
budget and they have resources<font color="#E5E5E5"> and yeah</font>

978
00:49:16,640 --> 00:49:23,589
it happens thank you very<font color="#E5E5E5"> much</font><font color="#CCCCCC"> no</font><font color="#E5E5E5"> work</font>

979
00:49:19,579 --> 00:49:23,589
<font color="#CCCCCC">Thanks are there any more</font><font color="#E5E5E5"> questions</font>

980
00:49:24,819 --> 00:49:30,140
<font color="#E5E5E5">sorry another question here so this is</font>

981
00:49:27,589 --> 00:49:33,290
relating to<font color="#CCCCCC"> the</font><font color="#E5E5E5"> sample</font><font color="#CCCCCC"> data</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> typo</font><font color="#E5E5E5"> in</font>

982
00:49:30,140 --> 00:49:36,920
the open URL<font color="#CCCCCC"> a missing</font><font color="#E5E5E5"> L so I'm curious</font>

983
00:49:33,290 --> 00:49:38,509
<font color="#E5E5E5">when these or any kind of characters</font>

984
00:49:36,920 --> 00:49:41,150
<font color="#E5E5E5">like these tests are palos today</font>

985
00:49:38,510 --> 00:49:43,609
generally tested before<font color="#CCCCCC"> they</font><font color="#E5E5E5"> sent out</font>

986
00:49:41,150 --> 00:49:45,559
and also<font color="#E5E5E5"> when they do has</font><font color="#CCCCCC"> their it's</font>

987
00:49:43,609 --> 00:49:48,828
like a second second follow-up question

988
00:49:45,559 --> 00:49:51,500
<font color="#E5E5E5">like when they are historical DNS</font>

989
00:49:48,829 --> 00:49:54,730
resolvers<font color="#E5E5E5"> are records is it has a has</font>

990
00:49:51,500 --> 00:49:57,829
there been any apt groups have been

991
00:49:54,730 --> 00:49:59,720
shaped have been tracked based on like

992
00:49:57,829 --> 00:50:02,329
<font color="#E5E5E5">the initial testing that they have done</font>

993
00:49:59,720 --> 00:50:05,000
and the<font color="#E5E5E5"> DNS resolutions was captured and</font>

994
00:50:02,329 --> 00:50:08,170
this because<font color="#CCCCCC"> this is related to the</font>

995
00:50:05,000 --> 00:50:10,280
concept<font color="#CCCCCC"> we are saying</font><font color="#E5E5E5"> they keep the</font>

996
00:50:08,170 --> 00:50:12,770
spearfishing infrastructure and the

997
00:50:10,280 --> 00:50:15,980
other<font color="#E5E5E5"> infrastructure used to generate</font>

998
00:50:12,770 --> 00:50:19,520
<font color="#E5E5E5">all these payloads on very different</font><font color="#CCCCCC"> so</font>

999
00:50:15,980 --> 00:50:21,470
has historical<font color="#E5E5E5"> DNS like while people are</font>

1000
00:50:19,520 --> 00:50:26,450
<font color="#CCCCCC">testing the initial pillow being used to</font>

1001
00:50:21,470 --> 00:50:30,169
track<font color="#E5E5E5"> the origin of so for this</font>

1002
00:50:26,450 --> 00:50:33,500
particular actor<font color="#CCCCCC"> I didn't see anything</font>

1003
00:50:30,170 --> 00:50:36,230
documented or a company<font color="#E5E5E5"> who went after</font>

1004
00:50:33,500 --> 00:50:39,170
<font color="#E5E5E5">these guys because these guys</font>

1005
00:50:36,230 --> 00:50:42,980
<font color="#CCCCCC">are actually</font><font color="#E5E5E5"> very specific to the GCC</font>

1006
00:50:39,170 --> 00:50:47,000
<font color="#E5E5E5">region in particular</font><font color="#CCCCCC"> the UAE okay so</font>

1007
00:50:42,980 --> 00:50:50,030
from<font color="#E5E5E5"> that that's the fact that other US</font>

1008
00:50:47,000 --> 00:50:53,119
companies<font color="#CCCCCC"> or other</font><font color="#E5E5E5"> big vendors security</font>

1009
00:50:50,030 --> 00:50:55,880
vendors won't<font color="#CCCCCC"> probably track these guys</font>

1010
00:50:53,119 --> 00:50:59,150
and most<font color="#CCCCCC"> of the since these guys are</font>

1011
00:50:55,880 --> 00:51:00,700
talking<font color="#CCCCCC"> in personal computer</font><font color="#E5E5E5"> most of</font>

1012
00:50:59,150 --> 00:51:03,170
<font color="#CCCCCC">these personal</font><font color="#E5E5E5"> computer they probably</font>

1013
00:51:00,700 --> 00:51:06,770
<font color="#CCCCCC">MacBooks</font><font color="#E5E5E5"> they probably don't</font><font color="#CCCCCC"> have an</font>

1014
00:51:03,170 --> 00:51:08,630
Eevee<font color="#CCCCCC"> so if you go check on</font><font color="#E5E5E5"> virus</font><font color="#CCCCCC"> so</font>

1015
00:51:06,770 --> 00:51:12,310
<font color="#CCCCCC">toad you</font><font color="#E5E5E5"> will not find the hashes at all</font>

1016
00:51:08,630 --> 00:51:15,490
so those are completely unknown hashes

1017
00:51:12,310 --> 00:51:18,490
<font color="#CCCCCC">we are in</font><font color="#E5E5E5"> position of these hashes</font><font color="#CCCCCC"> and</font>

1018
00:51:15,490 --> 00:51:21,470
<font color="#E5E5E5">we are currently</font><font color="#CCCCCC"> working on them</font><font color="#E5E5E5"> but</font>

1019
00:51:18,490 --> 00:51:23,509
from<font color="#E5E5E5"> my</font><font color="#CCCCCC"> understanding is there is</font><font color="#E5E5E5"> no</font>

1020
00:51:21,470 --> 00:51:26,060
<font color="#CCCCCC">other</font><font color="#E5E5E5"> company who who know about this</font>

1021
00:51:23,510 --> 00:51:30,310
<font color="#CCCCCC">sector</font><font color="#E5E5E5"> the second fact is this actor is</font>

1022
00:51:26,060 --> 00:51:32,660
looking after personal computers so

1023
00:51:30,310 --> 00:51:34,549
which<font color="#E5E5E5"> means they're</font><font color="#CCCCCC"> not targeting</font>

1024
00:51:32,660 --> 00:51:35,899
<font color="#E5E5E5">corporate environment if they target</font>

1025
00:51:34,550 --> 00:51:39,770
corporate environment again<font color="#CCCCCC"> and leave</font>

1026
00:51:35,900 --> 00:51:41,630
traces<font color="#CCCCCC"> they can</font><font color="#E5E5E5"> leave samples so IR will</font>

1027
00:51:39,770 --> 00:51:43,280
<font color="#E5E5E5">take the samples we probably upload them</font>

1028
00:51:41,630 --> 00:51:47,390
some some just upload them<font color="#E5E5E5"> to</font><font color="#CCCCCC"> my school</font>

1029
00:51:43,280 --> 00:51:52,340
so until now<font color="#E5E5E5"> nothing was disclosed about</font>

1030
00:51:47,390 --> 00:51:54,020
<font color="#E5E5E5">this sector and from we naan unna we are</font>

1031
00:51:52,340 --> 00:51:57,920
not aware<font color="#CCCCCC"> that days</font><font color="#E5E5E5"> another vendor</font><font color="#CCCCCC"> was</font>

1032
00:51:54,020 --> 00:52:01,340
<font color="#E5E5E5">tracking these actors so yeah now for</font>

1033
00:51:57,920 --> 00:52:05,090
the mistake they did on the open URL the

1034
00:52:01,340 --> 00:52:07,040
<font color="#CCCCCC">euro scheme I'm not really</font><font color="#E5E5E5"> sure what</font>

1035
00:52:05,090 --> 00:52:10,520
they did<font color="#CCCCCC"> a mistake</font><font color="#E5E5E5"> it happens because</font>

1036
00:52:07,040 --> 00:52:13,580
sometimes they they<font color="#E5E5E5"> work on under</font>

1037
00:52:10,520 --> 00:52:15,230
pressure for<font color="#CCCCCC"> example the somebody told</font>

1038
00:52:13,580 --> 00:52:17,840
<font color="#CCCCCC">him okay we need to get</font><font color="#E5E5E5"> sent an email</font>

1039
00:52:15,230 --> 00:52:20,660
right now<font color="#CCCCCC"> without even testing anything</font>

1040
00:52:17,840 --> 00:52:22,670
<font color="#CCCCCC">they probably did a</font><font color="#E5E5E5"> mistake there</font><font color="#CCCCCC"> it</font>

1041
00:52:20,660 --> 00:52:24,890
happens so<font color="#E5E5E5"> this is clearly a</font><font color="#CCCCCC"> mistake</font>

1042
00:52:22,670 --> 00:52:27,470
they did and<font color="#CCCCCC"> also now only</font><font color="#E5E5E5"> I found a</font>

1043
00:52:24,890 --> 00:52:29,690
<font color="#CCCCCC">couple of coding mistakes inside the</font>

1044
00:52:27,470 --> 00:52:32,060
malware<font color="#CCCCCC"> for example it's registered two</font>

1045
00:52:29,690 --> 00:52:33,740
times inside<font color="#E5E5E5"> the login</font><font color="#CCCCCC"> items</font><font color="#E5E5E5"> it's</font>

1046
00:52:32,060 --> 00:52:36,170
possibly doing only one time why because

1047
00:52:33,740 --> 00:52:38,118
<font color="#CCCCCC">in the entry point</font><font color="#E5E5E5"> they put</font><font color="#CCCCCC"> the</font>

1048
00:52:36,170 --> 00:52:41,000
persistence routine<font color="#E5E5E5"> inside the entry</font>

1049
00:52:38,119 --> 00:52:43,040
point<font color="#CCCCCC"> so when the malware runs copy</font>

1050
00:52:41,000 --> 00:52:45,260
itself runs<font color="#E5E5E5"> the second time it persists</font>

1051
00:52:43,040 --> 00:52:47,900
the second time so there were a<font color="#E5E5E5"> lot of</font>

1052
00:52:45,260 --> 00:52:49,670
<font color="#E5E5E5">programming mistakes but the malware</font>

1053
00:52:47,900 --> 00:52:52,880
<font color="#E5E5E5">that</font><font color="#CCCCCC"> it's from</font><font color="#E5E5E5"> 2007</font>

1054
00:52:49,670 --> 00:52:56,119
the version<font color="#CCCCCC"> wins he'll</font><font color="#E5E5E5"> be from 2018 is a</font>

1055
00:52:52,880 --> 00:52:58,670
complete rewrite and they clearly did a

1056
00:52:56,119 --> 00:53:01,160
lot<font color="#E5E5E5"> of progress</font><font color="#CCCCCC"> and now the</font><font color="#E5E5E5"> sample they</font>

1057
00:52:58,670 --> 00:53:04,010
have now with<font color="#E5E5E5"> the LS didn't want to take</font>

1058
00:53:01,160 --> 00:53:06,200
screenshots<font color="#CCCCCC"> I</font><font color="#E5E5E5"> are working perfectly</font><font color="#CCCCCC"> you</font>

1059
00:53:04,010 --> 00:53:12,940
don't have any any mistakes<font color="#E5E5E5"> in their</font>

1060
00:53:06,200 --> 00:53:12,939
code<font color="#E5E5E5"> so far are</font><font color="#CCCCCC"> they any more questions</font>

1061
00:53:13,539 --> 00:53:20,119
sorry just now you have hidden that<font color="#E5E5E5"> URL</font>

1062
00:53:17,660 --> 00:53:21,710
<font color="#E5E5E5">so I couldn't see the</font><font color="#CCCCCC"> day use the is</font>

1063
00:53:20,119 --> 00:53:24,470
this attacker use any kind of

1064
00:53:21,710 --> 00:53:27,880
typosquatting domains to redirect<font color="#CCCCCC"> their</font>

1065
00:53:24,470 --> 00:53:32,029
users sorry typo<font color="#CCCCCC"> squating domains</font>

1066
00:53:27,880 --> 00:53:33,559
cookies<font color="#E5E5E5"> no is</font><font color="#CCCCCC"> so typosquatting</font><font color="#E5E5E5"> domain</font>

1067
00:53:32,029 --> 00:53:36,880
<font color="#CCCCCC">where like</font><font color="#E5E5E5"> a something</font><font color="#CCCCCC"> like</font><font color="#E5E5E5"> is</font>

1068
00:53:33,559 --> 00:53:40,880
google.com<font color="#CCCCCC"> B is they change it to</font>

1069
00:53:36,880 --> 00:53:41,359
<font color="#E5E5E5">Google's</font><font color="#CCCCCC"> Calm Oh so domain type was</font>

1070
00:53:40,880 --> 00:53:45,049
<font color="#CCCCCC">query</font>

1071
00:53:41,359 --> 00:53:47,750
<font color="#E5E5E5">yep</font><font color="#CCCCCC"> yes they do this a lot</font><font color="#E5E5E5"> yeah all the</font>

1072
00:53:45,049 --> 00:53:50,869
domains they do our domain typosquatting

1073
00:53:47,750 --> 00:53:54,349
<font color="#E5E5E5">so they're gonna use like</font><font color="#CCCCCC"> Google with</font>

1074
00:53:50,869 --> 00:53:57,549
two L's or<font color="#E5E5E5"> - or whatever and they do</font>

1075
00:53:54,349 --> 00:54:00,109
that a lot they do<font color="#E5E5E5"> that of course not</font>

1076
00:53:57,549 --> 00:54:01,759
victims<font color="#E5E5E5"> will not pay attention so they</font>

1077
00:54:00,109 --> 00:54:04,578
<font color="#CCCCCC">would just</font><font color="#E5E5E5"> click so this is what we do</font>

1078
00:54:01,759 --> 00:54:05,089
<font color="#E5E5E5">and this is very common</font><font color="#CCCCCC"> very common in</font>

1079
00:54:04,579 --> 00:54:08,089
Middle East

1080
00:54:05,089 --> 00:54:10,609
EPG actors they use a lot<font color="#CCCCCC"> domain type of</font>

1081
00:54:08,089 --> 00:54:12,230
squad<font color="#E5E5E5"> in terms of copyright we having a</font>

1082
00:54:10,609 --> 00:54:16,279
challenges as<font color="#E5E5E5"> well to take down those</font>

1083
00:54:12,230 --> 00:54:19,670
domains so what what we have done for

1084
00:54:16,279 --> 00:54:22,849
<font color="#E5E5E5">this</font><font color="#CCCCCC"> particular case all these mal words</font>

1085
00:54:19,670 --> 00:54:25,160
were talking to two domains<font color="#E5E5E5"> and we</font>

1086
00:54:22,849 --> 00:54:28,670
<font color="#CCCCCC">actually took down the domain so work</font>

1087
00:54:25,160 --> 00:54:31,308
with with<font color="#CCCCCC"> GRI for example so we block</font>

1088
00:54:28,670 --> 00:54:33,619
<font color="#CCCCCC">the</font><font color="#E5E5E5"> access to these domains and also</font><font color="#CCCCCC"> we</font>

1089
00:54:31,309 --> 00:54:36,619
use that to identify<font color="#E5E5E5"> who are</font><font color="#CCCCCC"> the other</font>

1090
00:54:33,619 --> 00:54:39,950
victims<font color="#E5E5E5"> the way how the we did so we</font>

1091
00:54:36,619 --> 00:54:42,500
focused<font color="#E5E5E5"> on the malware command control</font>

1092
00:54:39,950 --> 00:54:44,569
service because those are in priority

1093
00:54:42,500 --> 00:54:45,890
more critical<font color="#CCCCCC"> because</font><font color="#E5E5E5"> are they are</font>

1094
00:54:44,569 --> 00:54:48,288
responsible<font color="#CCCCCC"> or</font><font color="#E5E5E5"> fixed</font><font color="#CCCCCC"> with right</font>

1095
00:54:45,890 --> 00:54:50,629
information<font color="#CCCCCC"> so the first thing we did is</font>

1096
00:54:48,289 --> 00:54:56,839
we shut down<font color="#E5E5E5"> these two domains</font><font color="#CCCCCC"> and we</font>

1097
00:54:50,630 --> 00:54:58,880
work with<font color="#E5E5E5"> our</font><font color="#CCCCCC"> i2c or other you know</font><font color="#E5E5E5"> you</font>

1098
00:54:56,839 --> 00:55:00,980
know individuals who<font color="#E5E5E5"> are targeted and we</font>

1099
00:54:58,880 --> 00:55:02,900
<font color="#E5E5E5">actually currently working on an</font>

1100
00:55:00,980 --> 00:55:06,230
investigation<font color="#CCCCCC"> on this</font>

1101
00:55:02,900 --> 00:55:08,150
just me<font color="#CCCCCC"> yeah you're</font><font color="#E5E5E5"> welcome okay that's</font>

1102
00:55:06,230 --> 00:55:09,829
all the<font color="#CCCCCC"> time we have</font><font color="#E5E5E5"> so if</font><font color="#CCCCCC"> you have any</font>

1103
00:55:08,150 --> 00:55:12,200
<font color="#E5E5E5">more questions or follow-up questions</font>

1104
00:55:09,829 --> 00:55:17,410
please do<font color="#CCCCCC"> not hesitate to</font><font color="#E5E5E5"> ask him</font>

1105
00:55:12,200 --> 00:55:17,410
afterwards<font color="#E5E5E5"> thank you again</font><font color="#CCCCCC"> thank you</font>

