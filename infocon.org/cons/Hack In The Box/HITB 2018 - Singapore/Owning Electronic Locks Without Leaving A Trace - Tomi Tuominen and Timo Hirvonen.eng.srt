1
00:00:13,460 --> 00:00:21,330
our story began in 1974<font color="#E5E5E5"> when news of a</font>

2
00:00:18,869 --> 00:00:25,140
tragedy reached Norwegian<font color="#CCCCCC"> Mach engineer</font>

3
00:00:21,330 --> 00:00:28,049
<font color="#CCCCCC">tour sign s just</font><font color="#E5E5E5"> filled</font><font color="#CCCCCC"> with American</font>

4
00:00:25,140 --> 00:00:31,770
<font color="#E5E5E5">singer</font><font color="#CCCCCC"> Connie Francis have been attempt</font>

5
00:00:28,050 --> 00:00:33,690
by an intruder in her hotel room<font color="#CCCCCC"> tour</font>

6
00:00:31,770 --> 00:00:37,559
<font color="#E5E5E5">couldn't believe that this had</font><font color="#CCCCCC"> happened</font>

7
00:00:33,690 --> 00:00:39,870
<font color="#E5E5E5">she resolved there and</font><font color="#CCCCCC"> then to</font><font color="#E5E5E5"> invent a</font>

8
00:00:37,559 --> 00:00:44,280
door opening system<font color="#E5E5E5"> that would</font><font color="#CCCCCC"> provide a</font>

9
00:00:39,870 --> 00:00:48,510
unique key for every hotel<font color="#E5E5E5"> guest his</font>

10
00:00:44,280 --> 00:00:52,590
invention was<font color="#E5E5E5"> big card and</font><font color="#CCCCCC"> he changed</font>

11
00:00:48,510 --> 00:00:53,070
<font color="#E5E5E5">the whole lock industry for</font><font color="#CCCCCC"> decades to</font>

12
00:00:52,590 --> 00:00:55,380
come

13
00:00:53,070 --> 00:00:58,380
hotel guests<font color="#CCCCCC"> all</font><font color="#E5E5E5"> over the world could</font>

14
00:00:55,380 --> 00:01:02,219
finally feel safe and<font color="#E5E5E5"> secure</font><font color="#CCCCCC"> when</font><font color="#E5E5E5"> they</font>

15
00:00:58,380 --> 00:01:05,040
arrived at<font color="#E5E5E5"> their destinations</font><font color="#CCCCCC"> Gerhard</font>

16
00:01:02,219 --> 00:01:08,410
<font color="#CCCCCC">el-sayf has been an industry pioneer and</font>

17
00:01:05,040 --> 00:01:14,870
world<font color="#E5E5E5"> leading brand for 40 years</font>

18
00:01:08,410 --> 00:01:14,869
[Music]

19
00:01:32,660 --> 00:01:50,759
[Music]

20
00:01:48,259 --> 00:01:52,430
we couldn't<font color="#E5E5E5"> think of any way</font><font color="#CCCCCC"> to make it</font>

21
00:01:50,759 --> 00:01:57,509
<font color="#E5E5E5">more dramatic</font>

22
00:01:52,430 --> 00:02:02,180
so these impacts about 166<font color="#CCCCCC"> countries for</font>

23
00:01:57,509 --> 00:02:06,390
the 2015 minions of door locks<font color="#E5E5E5"> worldwide</font>

24
00:02:02,180 --> 00:02:09,479
or<font color="#E5E5E5"> if you're a more visual type it</font>

25
00:02:06,390 --> 00:02:11,670
reflects<font color="#E5E5E5"> to these type of brands so we</font>

26
00:02:09,479 --> 00:02:15,270
don't<font color="#CCCCCC"> really know exactly</font><font color="#E5E5E5"> which hotel</font>

27
00:02:11,670 --> 00:02:18,420
<font color="#E5E5E5">chains and facilities</font><font color="#CCCCCC"> are affected or</font>

28
00:02:15,270 --> 00:02:21,480
<font color="#E5E5E5">impacted but these are the references</font>

29
00:02:18,420 --> 00:02:23,760
that<font color="#CCCCCC"> Asolo gives publicly or if you're</font>

30
00:02:21,480 --> 00:02:28,380
<font color="#E5E5E5">even more visual type it translates</font>

31
00:02:23,760 --> 00:02:32,280
these type of<font color="#E5E5E5"> places globally around</font><font color="#CCCCCC"> the</font>

32
00:02:28,380 --> 00:02:37,650
world<font color="#CCCCCC"> also this type of</font><font color="#E5E5E5"> things like</font>

33
00:02:32,280 --> 00:02:40,380
luxury<font color="#E5E5E5"> yachts and marine cruisers we are</font>

34
00:02:37,650 --> 00:02:44,180
the Penn<font color="#E5E5E5"> & Teller</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> InfoSec with one</font>

35
00:02:40,380 --> 00:02:47,400
notable<font color="#E5E5E5"> exception we are not rich or</font>

36
00:02:44,180 --> 00:02:51,780
<font color="#E5E5E5">famous or funny</font><font color="#CCCCCC"> and the shorter guy</font>

37
00:02:47,400 --> 00:02:54,600
actually<font color="#E5E5E5"> talks right demo so I'm moving</font>

38
00:02:51,780 --> 00:02:57,690
on<font color="#CCCCCC"> so we both work we come from</font><font color="#E5E5E5"> this</font>

39
00:02:54,600 --> 00:03:00,600
<font color="#E5E5E5">small distant country called Finland we</font>

40
00:02:57,690 --> 00:03:02,010
both work<font color="#CCCCCC"> for f-secure and that</font><font color="#E5E5E5"> that's</font>

41
00:03:00,600 --> 00:03:03,930
<font color="#E5E5E5">pretty much the only</font><font color="#CCCCCC"> thing that we're</font>

42
00:03:02,010 --> 00:03:07,798
<font color="#E5E5E5">gonna say about that</font><font color="#CCCCCC"> so the story goes</font>

43
00:03:03,930 --> 00:03:10,380
<font color="#CCCCCC">back</font><font color="#E5E5E5"> to 2003</font><font color="#CCCCCC"> when we</font><font color="#E5E5E5"> were attending</font><font color="#CCCCCC"> an</font>

44
00:03:07,799 --> 00:03:12,810
invite-only hacker conference in<font color="#E5E5E5"> german</font>

45
00:03:10,380 --> 00:03:17,250
<font color="#E5E5E5">Berlin called ph-neutral</font>

46
00:03:12,810 --> 00:03:20,220
and once we got back<font color="#CCCCCC"> to our hotel room</font>

47
00:03:17,250 --> 00:03:22,440
<font color="#E5E5E5">our colleagues or friends laptop had</font>

48
00:03:20,220 --> 00:03:27,230
been stole or stolen from his<font color="#E5E5E5"> locked</font>

49
00:03:22,440 --> 00:03:30,269
hotel room and we<font color="#E5E5E5"> reported that incident</font>

50
00:03:27,230 --> 00:03:33,268
<font color="#CCCCCC">to the</font><font color="#E5E5E5"> hotel management but they didn't</font>

51
00:03:30,269 --> 00:03:35,670
really<font color="#E5E5E5"> take us seriously and I can't</font>

52
00:03:33,269 --> 00:03:38,790
<font color="#E5E5E5">really</font><font color="#CCCCCC"> think of any reason why because</font>

53
00:03:35,670 --> 00:03:42,000
<font color="#E5E5E5">we were fine distinguished bunch of</font>

54
00:03:38,790 --> 00:03:44,459
gentlemen there<font color="#E5E5E5"> but they told us that</font>

55
00:03:42,000 --> 00:03:47,790
<font color="#E5E5E5">there was nothing suspicious going on</font>

56
00:03:44,459 --> 00:03:50,700
<font color="#E5E5E5">and everything looked exactly as it</font>

57
00:03:47,790 --> 00:03:53,459
<font color="#CCCCCC">should</font><font color="#E5E5E5"> so that got us thinking how is it</font>

58
00:03:50,700 --> 00:03:56,668
possible that<font color="#E5E5E5"> our friend's laptop had</font>

59
00:03:53,459 --> 00:03:57,520
been stolen<font color="#CCCCCC"> from</font><font color="#E5E5E5"> his hotel</font><font color="#CCCCCC"> room locked</font>

60
00:03:56,669 --> 00:04:01,840
<font color="#E5E5E5">hotel</font>

61
00:03:57,520 --> 00:04:05,220
if I may add<font color="#E5E5E5"> so we decided to go where</font>

62
00:04:01,840 --> 00:04:08,220
<font color="#E5E5E5">no</font><font color="#CCCCCC"> gender neutral has ever gone</font><font color="#E5E5E5"> before</font>

63
00:04:05,220 --> 00:04:11,470
<font color="#CCCCCC">went to our favorite search engine and</font>

64
00:04:08,220 --> 00:04:14,440
started<font color="#E5E5E5"> looking for clues</font><font color="#CCCCCC"> if there has</font>

65
00:04:11,470 --> 00:04:16,930
been any prior art<font color="#E5E5E5"> to this system called</font>

66
00:04:14,440 --> 00:04:20,529
<font color="#E5E5E5">green card and they're</font><font color="#CCCCCC"> absolutely zero</font>

67
00:04:16,930 --> 00:04:24,340
<font color="#CCCCCC">hits</font><font color="#E5E5E5"> so challenge accepted and we</font>

68
00:04:20,529 --> 00:04:27,039
decided<font color="#E5E5E5"> to take a look and if</font><font color="#CCCCCC"> you look</font>

69
00:04:24,340 --> 00:04:30,010
at these<font color="#E5E5E5"> type of things</font><font color="#CCCCCC"> there</font><font color="#E5E5E5"> are a few</font>

70
00:04:27,040 --> 00:04:33,070
ways<font color="#E5E5E5"> how</font><font color="#CCCCCC"> you can approach them so we</font>

71
00:04:30,010 --> 00:04:36,400
built our own attack tree<font color="#E5E5E5"> the first one</font>

72
00:04:33,070 --> 00:04:38,290
<font color="#E5E5E5">being physical lock so obviously you can</font>

73
00:04:36,400 --> 00:04:40,900
<font color="#E5E5E5">take a look at the physical lock and see</font>

74
00:04:38,290 --> 00:04:42,700
if you can bump<font color="#E5E5E5"> key it or do some other</font>

75
00:04:40,900 --> 00:04:45,549
techniques which allows you to<font color="#CCCCCC"> bypass</font>

76
00:04:42,700 --> 00:04:48,039
<font color="#E5E5E5">the physical lock itself then you have</font>

77
00:04:45,550 --> 00:04:50,110
an option<font color="#CCCCCC"> of going after</font><font color="#E5E5E5"> the electronic</font>

78
00:04:48,040 --> 00:04:53,830
lock itself so you can reprogram the

79
00:04:50,110 --> 00:04:57,130
lock<font color="#E5E5E5"> you can you can do stuff</font><font color="#CCCCCC"> with the</font>

80
00:04:53,830 --> 00:05:00,669
<font color="#E5E5E5">firmware or maybe you can bypass it</font><font color="#CCCCCC"> with</font>

81
00:04:57,130 --> 00:05:04,260
<font color="#CCCCCC">four super magnets then you have access</font>

82
00:05:00,670 --> 00:05:06,790
<font color="#E5E5E5">tokens in this case</font><font color="#CCCCCC"> ultralight cards and</font>

83
00:05:04,260 --> 00:05:09,120
then of<font color="#CCCCCC"> course you have the</font><font color="#E5E5E5"> backend</font>

84
00:05:06,790 --> 00:05:12,190
system which controls everything

85
00:05:09,120 --> 00:05:15,310
most people seem to think<font color="#CCCCCC"> that if you</font>

86
00:05:12,190 --> 00:05:17,080
are using a fine<font color="#CCCCCC"> hotel like</font><font color="#E5E5E5"> this all the</font>

87
00:05:15,310 --> 00:05:20,350
doors are connected to the<font color="#CCCCCC"> back-end</font>

88
00:05:17,080 --> 00:05:23,740
<font color="#E5E5E5">system that's not the case all the doors</font>

89
00:05:20,350 --> 00:05:27,460
are kind<font color="#CCCCCC"> of</font><font color="#E5E5E5"> standalone so they usually</font>

90
00:05:23,740 --> 00:05:30,460
consists of a battery<font color="#CCCCCC"> a small</font><font color="#E5E5E5"> real time</font>

91
00:05:27,460 --> 00:05:33,219
<font color="#E5E5E5">clock and a small chip that contains the</font>

92
00:05:30,460 --> 00:05:35,770
actual<font color="#E5E5E5"> logic so there is no centralized</font>

93
00:05:33,220 --> 00:05:39,060
repository for logs<font color="#CCCCCC"> or anything like</font>

94
00:05:35,770 --> 00:05:43,210
<font color="#E5E5E5">that</font><font color="#CCCCCC"> we'll get back to that</font><font color="#E5E5E5"> later on</font>

95
00:05:39,060 --> 00:05:45,340
so first if you have something<font color="#E5E5E5"> like this</font>

96
00:05:43,210 --> 00:05:48,969
do you<font color="#E5E5E5"> need to understand the target the</font>

97
00:05:45,340 --> 00:05:51,340
<font color="#E5E5E5">only thing we had was</font><font color="#CCCCCC"> this car and it</font>

98
00:05:48,970 --> 00:05:53,530
doesn't<font color="#E5E5E5"> really tell you</font><font color="#CCCCCC"> that much</font><font color="#E5E5E5"> except</font>

99
00:05:51,340 --> 00:05:56,500
<font color="#CCCCCC">that it's</font><font color="#E5E5E5"> back in the</font><font color="#CCCCCC"> day used</font><font color="#E5E5E5"> to be a</font>

100
00:05:53,530 --> 00:05:58,390
small<font color="#CCCCCC"> Norwegian</font><font color="#E5E5E5"> company that came up</font>

101
00:05:56,500 --> 00:06:01,390
with the idea that<font color="#E5E5E5"> yeah you need</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> have</font>

102
00:05:58,390 --> 00:06:05,520
a unique key for every<font color="#E5E5E5"> lock thanks look</font>

103
00:06:01,390 --> 00:06:08,560
<font color="#E5E5E5">and and this</font><font color="#CCCCCC"> is what we had</font><font color="#E5E5E5"> back</font><font color="#CCCCCC"> then</font>

104
00:06:05,520 --> 00:06:10,870
all we started our hacking spree by

105
00:06:08,560 --> 00:06:12,910
going after<font color="#E5E5E5"> the FTP service these</font>

106
00:06:10,870 --> 00:06:15,430
how hacking looked like back<font color="#CCCCCC"> in the day</font>

107
00:06:12,910 --> 00:06:18,220
so you you scan for anonymous FTP

108
00:06:15,430 --> 00:06:20,020
service<font color="#E5E5E5"> and you download</font><font color="#CCCCCC"> all the ghooost</font>

109
00:06:18,220 --> 00:06:24,430
<font color="#E5E5E5">goods because people don't really know</font>

110
00:06:20,020 --> 00:06:26,500
how FTP works<font color="#E5E5E5"> and once you have this is</font>

111
00:06:24,430 --> 00:06:30,130
<font color="#E5E5E5">this piece of</font><font color="#CCCCCC"> software</font><font color="#E5E5E5"> that is used</font><font color="#CCCCCC"> to</font>

112
00:06:26,500 --> 00:06:32,050
<font color="#E5E5E5">program the logs and this is the demo</font>

113
00:06:30,130 --> 00:06:36,210
database<font color="#E5E5E5"> and then you have you manuals</font>

114
00:06:32,050 --> 00:06:40,030
and and so<font color="#E5E5E5"> on then we looked the</font><font color="#CCCCCC"> patents</font>

115
00:06:36,210 --> 00:06:42,390
most people nowadays think<font color="#CCCCCC"> that patents</font>

116
00:06:40,030 --> 00:06:46,059
<font color="#E5E5E5">are kind</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> useless</font><font color="#CCCCCC"> but at this</font><font color="#E5E5E5"> time</font>

117
00:06:42,390 --> 00:06:48,610
<font color="#E5E5E5">patents were a trove of</font><font color="#CCCCCC"> information so</font>

118
00:06:46,060 --> 00:06:51,180
you could find all sorts of diagrams

119
00:06:48,610 --> 00:06:54,070
explaining how these locks work also

120
00:06:51,180 --> 00:06:56,590
mechanically but<font color="#E5E5E5"> also the electronics</font><font color="#CCCCCC"> so</font>

121
00:06:54,070 --> 00:06:58,690
you you would<font color="#CCCCCC"> have information like what</font>

122
00:06:56,590 --> 00:07:02,919
kind of<font color="#CCCCCC"> information would be stored on</font>

123
00:06:58,690 --> 00:07:05,050
on those actual tracks<font color="#E5E5E5"> and what kind of</font>

124
00:07:02,920 --> 00:07:08,680
data<font color="#E5E5E5"> would be</font><font color="#CCCCCC"> stored on the</font><font color="#E5E5E5"> card</font>

125
00:07:05,050 --> 00:07:10,690
possibly it also contains interesting

126
00:07:08,680 --> 00:07:14,190
<font color="#E5E5E5">pieces of</font><font color="#CCCCCC"> information so how many</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> you</font>

127
00:07:10,690 --> 00:07:16,900
<font color="#CCCCCC">knew that if you have a</font><font color="#E5E5E5"> magstripe card</font>

128
00:07:14,190 --> 00:07:19,540
<font color="#E5E5E5">it's actually most of the time it's read</font>

129
00:07:16,900 --> 00:07:22,090
when you take it out not when you put it

130
00:07:19,540 --> 00:07:24,490
in because it's five style five times

131
00:07:22,090 --> 00:07:28,239
more reliable to read it when you take

132
00:07:24,490 --> 00:07:29,950
<font color="#E5E5E5">it</font><font color="#CCCCCC"> out</font><font color="#E5E5E5"> so many of our peers who try to</font>

133
00:07:28,240 --> 00:07:34,420
analyze this<font color="#E5E5E5"> have been reading the</font>

134
00:07:29,950 --> 00:07:39,190
<font color="#CCCCCC">bitstream to</font><font color="#E5E5E5"> the wrong direction</font><font color="#CCCCCC"> so</font>

135
00:07:34,420 --> 00:07:41,440
physical locks the first thing that<font color="#CCCCCC"> we</font>

136
00:07:39,190 --> 00:07:44,610
tried<font color="#CCCCCC"> was bypassing</font><font color="#E5E5E5"> the physical lock</font>

137
00:07:41,440 --> 00:07:47,200
<font color="#E5E5E5">without leaving any visible marks and</font>

138
00:07:44,610 --> 00:07:49,210
obviously if you want to do that you

139
00:07:47,200 --> 00:07:51,490
need<font color="#CCCCCC"> to get your</font><font color="#E5E5E5"> hands on a physical</font>

140
00:07:49,210 --> 00:07:54,580
lock so that's<font color="#E5E5E5"> exactly</font><font color="#CCCCCC"> what we did we</font>

141
00:07:51,490 --> 00:07:56,830
ordered one on<font color="#CCCCCC"> eBay then we started</font>

142
00:07:54,580 --> 00:07:59,380
<font color="#E5E5E5">analyzing the lock trying all</font><font color="#CCCCCC"> sorts of</font>

143
00:07:56,830 --> 00:08:02,200
different<font color="#E5E5E5"> tricks for example we tried</font>

144
00:07:59,380 --> 00:08:04,420
<font color="#CCCCCC">using strong magnets</font><font color="#E5E5E5"> to open the lock</font><font color="#CCCCCC"> we</font>

145
00:08:02,200 --> 00:08:07,960
also tried<font color="#E5E5E5"> hitting the lock with a</font>

146
00:08:04,420 --> 00:08:09,490
rubber hammer<font color="#E5E5E5"> to open it now remember</font>

147
00:08:07,960 --> 00:08:13,120
that<font color="#E5E5E5"> the goal was to open the lock</font>

148
00:08:09,490 --> 00:08:15,480
<font color="#E5E5E5">without leaving any visible marks maybe</font>

149
00:08:13,120 --> 00:08:18,370
<font color="#E5E5E5">not that surprisingly we failed</font>

150
00:08:15,480 --> 00:08:21,400
ASSA ABLOY has been creating<font color="#CCCCCC"> these locks</font>

151
00:08:18,370 --> 00:08:24,520
for decades and the mechanical locks<font color="#E5E5E5"> are</font>

152
00:08:21,400 --> 00:08:27,878
of very<font color="#E5E5E5"> high quality</font><font color="#CCCCCC"> so no</font>

153
00:08:24,520 --> 00:08:30,460
<font color="#E5E5E5">doing this later we learned from our</font>

154
00:08:27,879 --> 00:08:35,440
<font color="#E5E5E5">Dutch friends that if you have about 10</font>

155
00:08:30,460 --> 00:08:37,569
seconds<font color="#CCCCCC"> and $1</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> can do this the</font><font color="#E5E5E5"> way</font>

156
00:08:35,440 --> 00:08:40,930
<font color="#E5E5E5">you do it is that you</font><font color="#CCCCCC"> have a piece of</font>

157
00:08:37,570 --> 00:08:44,649
<font color="#E5E5E5">thick metal wire or a coat hanger</font><font color="#CCCCCC"> you</font>

158
00:08:40,929 --> 00:08:47,290
slide it under<font color="#CCCCCC"> the door</font><font color="#E5E5E5"> then you twist</font>

159
00:08:44,649 --> 00:08:49,959
it upwards and<font color="#CCCCCC"> you use that coat hanger</font>

160
00:08:47,290 --> 00:08:52,689
to<font color="#E5E5E5"> pull the handle from the inside of</font>

161
00:08:49,959 --> 00:08:55,540
<font color="#E5E5E5">the hotel room in a minute we're</font><font color="#CCCCCC"> gonna</font>

162
00:08:52,690 --> 00:08:58,390
<font color="#E5E5E5">see the same trick from the inside of</font>

163
00:08:55,540 --> 00:09:02,649
<font color="#CCCCCC">the</font><font color="#E5E5E5"> hotel room so you slide the coat</font>

164
00:08:58,390 --> 00:09:09,510
hanger<font color="#E5E5E5"> under the door then you turn</font><font color="#CCCCCC"> it</font>

165
00:09:02,649 --> 00:09:11,890
up like<font color="#CCCCCC"> that</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> you pull the handle</font>

166
00:09:09,510 --> 00:09:13,779
<font color="#E5E5E5">that's what it takes to bypass the</font>

167
00:09:11,890 --> 00:09:16,360
mechanical lock<font color="#E5E5E5"> now if you want to</font>

168
00:09:13,779 --> 00:09:17,770
protect yourself<font color="#E5E5E5"> against this what you</font>

169
00:09:16,360 --> 00:09:20,740
can do is that you<font color="#E5E5E5"> can put a towel</font>

170
00:09:17,770 --> 00:09:24,939
<font color="#E5E5E5">between the door</font><font color="#CCCCCC"> and the handle</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> that</font>

171
00:09:20,740 --> 00:09:27,130
will prevent this attack<font color="#E5E5E5"> we needed a</font>

172
00:09:24,940 --> 00:09:29,620
better plan<font color="#CCCCCC"> bypassing the mechanical</font>

173
00:09:27,130 --> 00:09:33,220
lock didn't work so<font color="#CCCCCC"> we started focusing</font>

174
00:09:29,620 --> 00:09:35,560
on bypassing the electronic lock<font color="#CCCCCC"> and the</font>

175
00:09:33,220 --> 00:09:39,040
approach that<font color="#E5E5E5"> we took here was to try</font><font color="#CCCCCC"> to</font>

176
00:09:35,560 --> 00:09:41,560
<font color="#E5E5E5">reprogram</font><font color="#CCCCCC"> the law like domi already</font>

177
00:09:39,040 --> 00:09:44,410
mentioned we had<font color="#E5E5E5"> found the lock link</font>

178
00:09:41,560 --> 00:09:45,819
<font color="#CCCCCC">software on an FTP site</font><font color="#E5E5E5"> and that's the</font>

179
00:09:44,410 --> 00:09:49,120
piece of<font color="#CCCCCC"> software that</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> use to</font>

180
00:09:45,820 --> 00:09:52,300
reprogram<font color="#E5E5E5"> the locks in order to run the</font>

181
00:09:49,120 --> 00:09:55,420
software<font color="#CCCCCC"> you</font><font color="#E5E5E5"> need one of these</font><font color="#CCCCCC"> comb back</font>

182
00:09:52,300 --> 00:09:57,010
<font color="#E5E5E5">I pack handheld computers those were</font>

183
00:09:55,420 --> 00:09:59,860
quite popular<font color="#CCCCCC"> at the time not that</font>

184
00:09:57,010 --> 00:10:02,800
popular<font color="#CCCCCC"> anymore</font><font color="#E5E5E5"> so we got one of those</font>

185
00:09:59,860 --> 00:10:05,350
and we got the software<font color="#E5E5E5"> running we did</font>

186
00:10:02,800 --> 00:10:08,290
some analysis<font color="#E5E5E5"> on the software and we</font>

187
00:10:05,350 --> 00:10:10,480
realized that<font color="#E5E5E5"> all the interesting</font><font color="#CCCCCC"> stuff</font>

188
00:10:08,290 --> 00:10:12,910
<font color="#E5E5E5">actually doesn't happen in the software</font>

189
00:10:10,480 --> 00:10:17,860
<font color="#CCCCCC">it happens in a component called a</font>

190
00:10:12,910 --> 00:10:20,770
contact<font color="#E5E5E5"> card so that's</font><font color="#CCCCCC"> number 5</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> you</font>

191
00:10:17,860 --> 00:10:23,910
see in that photo<font color="#CCCCCC"> so what you do is you</font>

192
00:10:20,770 --> 00:10:26,620
connect that contact card to the Compaq

193
00:10:23,910 --> 00:10:28,660
handheld computer and the<font color="#CCCCCC"> other end of</font>

194
00:10:26,620 --> 00:10:31,630
the<font color="#E5E5E5"> device the large</font><font color="#CCCCCC"> end that you see on</font>

195
00:10:28,660 --> 00:10:33,730
the photo<font color="#CCCCCC"> you</font><font color="#E5E5E5"> slide that to the lock</font>

196
00:10:31,630 --> 00:10:36,310
<font color="#E5E5E5">just like you do with a key card</font><font color="#CCCCCC"> you</font>

197
00:10:33,730 --> 00:10:37,600
slide it there and then you<font color="#CCCCCC"> can program</font>

198
00:10:36,310 --> 00:10:40,268
<font color="#E5E5E5">the</font><font color="#CCCCCC"> lock and it</font>

199
00:10:37,600 --> 00:10:42,160
<font color="#E5E5E5">that piece of</font><font color="#CCCCCC"> hardware that</font><font color="#E5E5E5"> implements</font>

200
00:10:40,269 --> 00:10:45,639
all the interesting stuff<font color="#CCCCCC"> that's needed</font>

201
00:10:42,160 --> 00:10:48,519
for reprogramming<font color="#CCCCCC"> the</font><font color="#E5E5E5"> lock the</font>

202
00:10:45,639 --> 00:10:50,860
unfortunate thing was that we couldn't

203
00:10:48,519 --> 00:10:54,250
get our hands on<font color="#CCCCCC"> one of</font><font color="#E5E5E5"> these</font><font color="#CCCCCC"> conduct</font>

204
00:10:50,860 --> 00:10:57,399
cars you<font color="#CCCCCC"> couldn't buy it on</font><font color="#E5E5E5"> eBay or</font>

205
00:10:54,250 --> 00:11:01,180
anything<font color="#E5E5E5"> so again yet another dead end</font>

206
00:10:57,399 --> 00:11:05,050
we<font color="#E5E5E5"> couldn't we</font><font color="#CCCCCC"> couldn't get anything out</font>

207
00:11:01,180 --> 00:11:06,459
<font color="#E5E5E5">of this research track however I would</font>

208
00:11:05,050 --> 00:11:10,319
say<font color="#E5E5E5"> that we were on the right track</font>

209
00:11:06,459 --> 00:11:14,619
<font color="#E5E5E5">because clearly this attack is feasible</font>

210
00:11:10,319 --> 00:11:18,099
<font color="#E5E5E5">because in 2010 we learned about the</font>

211
00:11:14,620 --> 00:11:21,690
assassination of mahmoud al<font color="#CCCCCC"> babu</font><font color="#E5E5E5"> he was</font>

212
00:11:18,100 --> 00:11:25,300
<font color="#E5E5E5">so</font><font color="#CCCCCC"> hamas officer</font><font color="#E5E5E5"> and allegedly he was</font>

213
00:11:21,690 --> 00:11:29,370
murdered by Mossad in a hotel room<font color="#E5E5E5"> in</font>

214
00:11:25,300 --> 00:11:33,008
<font color="#CCCCCC">dubai</font><font color="#E5E5E5"> and according to the dubai police</font>

215
00:11:29,370 --> 00:11:34,660
<font color="#E5E5E5">investigation the way they were able to</font>

216
00:11:33,009 --> 00:11:38,259
access<font color="#E5E5E5"> the hotel room was that</font><font color="#CCCCCC"> they used</font>

217
00:11:34,660 --> 00:11:42,370
<font color="#CCCCCC">this exact</font><font color="#E5E5E5"> piece of software called lock</font>

218
00:11:38,259 --> 00:11:45,370
<font color="#E5E5E5">link to reprogram</font><font color="#CCCCCC"> the lock</font><font color="#E5E5E5"> now the</font>

219
00:11:42,370 --> 00:11:48,220
downside<font color="#E5E5E5"> in this attack is that first of</font>

220
00:11:45,370 --> 00:11:49,990
all if you reprogram the lock<font color="#E5E5E5"> you can</font>

221
00:11:48,220 --> 00:11:53,519
later see that yes the lock was

222
00:11:49,990 --> 00:11:56,560
reprogrammed<font color="#CCCCCC"> so it does leave a trace</font>

223
00:11:53,519 --> 00:11:58,990
<font color="#CCCCCC">secondly if your goal is to</font><font color="#E5E5E5"> be able to</font>

224
00:11:56,560 --> 00:12:02,050
enter multiple hotel rooms<font color="#E5E5E5"> you need to</font>

225
00:11:58,990 --> 00:12:06,480
<font color="#E5E5E5">reprogram</font><font color="#CCCCCC"> each and every lock so we</font>

226
00:12:02,050 --> 00:12:06,479
decided<font color="#CCCCCC"> that</font><font color="#E5E5E5"> we need a more elegant plan</font>

227
00:12:06,839 --> 00:12:13,689
so we go then<font color="#CCCCCC"> do the access tokens</font><font color="#E5E5E5"> so</font>

228
00:12:11,380 --> 00:12:15,519
here the<font color="#E5E5E5"> success criteria would be that</font>

229
00:12:13,689 --> 00:12:18,449
we<font color="#CCCCCC"> are</font><font color="#E5E5E5"> able to clone an access</font><font color="#CCCCCC"> token</font>

230
00:12:15,519 --> 00:12:20,920
<font color="#E5E5E5">which should be doable in most cases or</font>

231
00:12:18,449 --> 00:12:23,258
<font color="#E5E5E5">produce an access</font><font color="#CCCCCC"> token that</font><font color="#E5E5E5"> has more</font>

232
00:12:20,920 --> 00:12:26,589
privileges and<font color="#CCCCCC"> buy more</font><font color="#E5E5E5"> privileges I</font>

233
00:12:23,259 --> 00:12:29,949
mean that if I'm in room<font color="#E5E5E5"> 1 and I need to</font>

234
00:12:26,589 --> 00:12:32,920
impersonate<font color="#CCCCCC"> Thema who's on room 2 I can</font>

235
00:12:29,949 --> 00:12:35,649
create a card that<font color="#E5E5E5"> will impersonate</font><font color="#CCCCCC"> the</font>

236
00:12:32,920 --> 00:12:38,139
<font color="#CCCCCC">thymus card</font><font color="#E5E5E5"> it's more</font><font color="#CCCCCC"> handily that way</font>

237
00:12:35,649 --> 00:12:41,620
when you're emptying them<font color="#E5E5E5"> anymore and</font>

238
00:12:38,139 --> 00:12:44,380
and of<font color="#CCCCCC"> course you could have a master</font>

239
00:12:41,620 --> 00:12:47,649
token that<font color="#E5E5E5"> gives you access to all the</font>

240
00:12:44,380 --> 00:12:50,080
doors<font color="#E5E5E5"> so we needed a plans first we need</font>

241
00:12:47,649 --> 00:12:52,420
to understand how<font color="#CCCCCC"> Magistrate works then</font>

242
00:12:50,080 --> 00:12:55,600
we get a<font color="#CCCCCC"> max rep encoder/decoder we</font><font color="#E5E5E5"> give</font>

243
00:12:52,420 --> 00:12:59,050
<font color="#CCCCCC">few hotel cards and so</font><font color="#E5E5E5"> on so there we go</font>

244
00:12:55,600 --> 00:13:01,630
max<font color="#CCCCCC"> type card is the bond that</font><font color="#E5E5E5"> you're</font>

245
00:12:59,050 --> 00:13:04,150
typically<font color="#E5E5E5"> used to seeing in your wallet</font>

246
00:13:01,630 --> 00:13:04,900
many of the credit cards still have a

247
00:13:04,150 --> 00:13:08,199
credit card

248
00:13:04,900 --> 00:13:12,630
and most of those cards<font color="#E5E5E5"> have three</font>

249
00:13:08,200 --> 00:13:15,700
<font color="#E5E5E5">different tracks these are standardized</font>

250
00:13:12,630 --> 00:13:19,660
<font color="#E5E5E5">but</font><font color="#CCCCCC"> unfortunately</font><font color="#E5E5E5"> evolved for research</font>

251
00:13:15,700 --> 00:13:23,380
<font color="#E5E5E5">purposes</font><font color="#CCCCCC"> you don't really do</font><font color="#E5E5E5"> anything</font>

252
00:13:19,660 --> 00:13:26,380
with<font color="#E5E5E5"> this information because many of</font>

253
00:13:23,380 --> 00:13:30,790
the locking systems use completely

254
00:13:26,380 --> 00:13:32,980
proprietary<font color="#E5E5E5"> things so that the</font><font color="#CCCCCC"> syntax</font>

255
00:13:30,790 --> 00:13:34,630
might be that there is<font color="#CCCCCC"> a start Sentinel</font>

256
00:13:32,980 --> 00:13:37,540
there is some data<font color="#E5E5E5"> there's an</font><font color="#CCCCCC"> end</font><font color="#E5E5E5"> send</font>

257
00:13:34,630 --> 00:13:40,210
you know and<font color="#E5E5E5"> something called LRC which</font>

258
00:13:37,540 --> 00:13:44,800
is basically a checksum but for example

259
00:13:40,210 --> 00:13:46,930
in<font color="#CCCCCC"> min cards case there is the the hotel</font>

260
00:13:44,800 --> 00:13:48,939
<font color="#CCCCCC">may choose to use track number one and</font>

261
00:13:46,930 --> 00:13:51,459
<font color="#CCCCCC">two</font><font color="#E5E5E5"> for different purposes let's say</font>

262
00:13:48,940 --> 00:13:54,640
<font color="#E5E5E5">mini bars or loyalty programs or</font>

263
00:13:51,460 --> 00:13:56,920
whatever<font color="#E5E5E5"> but the third one should third</font>

264
00:13:54,640 --> 00:14:00,280
track on<font color="#CCCCCC"> the mag</font><font color="#E5E5E5"> stripe</font><font color="#CCCCCC"> holds the</font><font color="#E5E5E5"> actual</font>

265
00:13:56,920 --> 00:14:03,130
<font color="#CCCCCC">main card log data so in</font><font color="#E5E5E5"> order to</font>

266
00:14:00,280 --> 00:14:07,540
analyze that<font color="#E5E5E5"> you need to have a piece of</font>

267
00:14:03,130 --> 00:14:10,650
<font color="#CCCCCC">software and a hardware to do that we</font>

268
00:14:07,540 --> 00:14:14,500
used this one which<font color="#CCCCCC"> is a german</font>

269
00:14:10,650 --> 00:14:16,360
manufactured encoder<font color="#E5E5E5"> teague decoder</font><font color="#CCCCCC"> and</font>

270
00:14:14,500 --> 00:14:18,610
this is a beautiful piece<font color="#CCCCCC"> of hardware</font>

271
00:14:16,360 --> 00:14:21,790
<font color="#E5E5E5">because it doesn't do any decoding or</font>

272
00:14:18,610 --> 00:14:24,670
encoding<font color="#E5E5E5"> on this hardware its software</font>

273
00:14:21,790 --> 00:14:27,610
<font color="#E5E5E5">only and it comes with this really good</font>

274
00:14:24,670 --> 00:14:31,569
piece<font color="#CCCCCC"> of</font><font color="#E5E5E5"> software that enables you to do</font>

275
00:14:27,610 --> 00:14:34,780
<font color="#CCCCCC">max type analysis manual</font><font color="#E5E5E5"> so here you can</font>

276
00:14:31,570 --> 00:14:36,880
see the<font color="#CCCCCC"> modulation of this of the track</font>

277
00:14:34,780 --> 00:14:39,240
here you can see on the upper right hand

278
00:14:36,880 --> 00:14:42,100
corner<font color="#CCCCCC"> you can see this wide speed</font><font color="#E5E5E5"> and</font>

279
00:14:39,240 --> 00:14:44,170
here's some analysis of the data<font color="#E5E5E5"> you can</font>

280
00:14:42,100 --> 00:14:46,660
<font color="#E5E5E5">also see</font><font color="#CCCCCC"> that most probably</font><font color="#E5E5E5"> this card</font>

281
00:14:44,170 --> 00:14:49,420
has been<font color="#E5E5E5"> used at</font><font color="#CCCCCC"> least twice</font><font color="#E5E5E5"> because</font><font color="#CCCCCC"> of</font>

282
00:14:46,660 --> 00:14:52,150
the of the<font color="#CCCCCC"> of these patterns</font><font color="#E5E5E5"> if it would</font>

283
00:14:49,420 --> 00:14:55,150
have<font color="#CCCCCC"> been</font><font color="#E5E5E5"> used only once they could have</font>

284
00:14:52,150 --> 00:14:57,630
<font color="#CCCCCC">only</font><font color="#E5E5E5"> one</font><font color="#CCCCCC"> of these kind of patterns</font><font color="#E5E5E5"> it's</font>

285
00:14:55,150 --> 00:15:00,340
also very<font color="#E5E5E5"> very handy because some of the</font>

286
00:14:57,630 --> 00:15:03,480
at<font color="#E5E5E5"> least in Scandinavia many of the</font>

287
00:15:00,340 --> 00:15:05,880
parking lots<font color="#E5E5E5"> they use these kind of</font><font color="#CCCCCC"> next</font>

288
00:15:03,480 --> 00:15:08,070
cards and what they do is that they use

289
00:15:05,880 --> 00:15:10,560
within<font color="#E5E5E5"> a one track they use two</font>

290
00:15:08,070 --> 00:15:12,959
<font color="#CCCCCC">different</font><font color="#E5E5E5"> types of modulation as a copy</font>

291
00:15:10,560 --> 00:15:15,000
protection scheme<font color="#E5E5E5"> so that</font><font color="#CCCCCC"> you're</font><font color="#E5E5E5"> not</font>

292
00:15:12,959 --> 00:15:17,069
able to clone the card<font color="#E5E5E5"> usually</font><font color="#CCCCCC"> with a</font>

293
00:15:15,000 --> 00:15:20,220
regular<font color="#E5E5E5"> hardware with this hardware you</font>

294
00:15:17,070 --> 00:15:22,199
can<font color="#CCCCCC"> do it easily I didn't</font><font color="#E5E5E5"> say that</font><font color="#CCCCCC"> then</font>

295
00:15:20,220 --> 00:15:25,589
we had to get<font color="#CCCCCC"> you hold up cards and</font><font color="#E5E5E5"> by</font>

296
00:15:22,199 --> 00:15:28,769
few I say like few hundred or a few

297
00:15:25,589 --> 00:15:30,779
thousand or or<font color="#CCCCCC"> even more luckily we</font><font color="#E5E5E5"> have</font>

298
00:15:28,769 --> 00:15:33,930
friends in<font color="#CCCCCC"> low places that were able to</font>

299
00:15:30,779 --> 00:15:37,410
supply<font color="#CCCCCC"> us plenty of cards that</font><font color="#E5E5E5"> enabled</font>

300
00:15:33,930 --> 00:15:39,029
us to do the analysis then we<font color="#CCCCCC"> decided</font>

301
00:15:37,410 --> 00:15:42,899
that<font color="#E5E5E5"> we will just reverse engineer the</font>

302
00:15:39,029 --> 00:15:44,790
track<font color="#E5E5E5"> data on on these cards and be done</font>

303
00:15:42,899 --> 00:15:48,389
with<font color="#E5E5E5"> it</font><font color="#CCCCCC"> this is how the card looks like</font>

304
00:15:44,790 --> 00:15:51,060
<font color="#CCCCCC">and while you can</font><font color="#E5E5E5"> maybe use some data</font>

305
00:15:48,389 --> 00:15:54,360
<font color="#E5E5E5">out</font><font color="#CCCCCC"> of it maybe they are using some sort</font>

306
00:15:51,060 --> 00:15:58,410
of<font color="#E5E5E5"> sort pattern or</font><font color="#CCCCCC"> something</font><font color="#E5E5E5"> but these</font>

307
00:15:54,360 --> 00:16:01,350
<font color="#CCCCCC">need not really work</font><font color="#E5E5E5"> it might sound</font>

308
00:15:58,410 --> 00:16:04,410
stupid<font color="#CCCCCC"> but this approach has been</font><font color="#E5E5E5"> very</font>

309
00:16:01,350 --> 00:16:07,920
very solid<font color="#E5E5E5"> for other types of hotel cars</font>

310
00:16:04,410 --> 00:16:10,290
previously to the point that when major

311
00:16:07,920 --> 00:16:13,380
malfunction gave his talk about<font color="#CCCCCC"> next</font>

312
00:16:10,290 --> 00:16:15,810
<font color="#CCCCCC">type madness and showed a bit stream</font>

313
00:16:13,380 --> 00:16:19,139
<font color="#E5E5E5">there pretty much everybody in Berlin</font>

314
00:16:15,810 --> 00:16:22,829
knew that that was<font color="#CCCCCC"> Alexander Platz Park</font>

315
00:16:19,139 --> 00:16:24,720
in that<font color="#CCCCCC"> wasn't on</font><font color="#E5E5E5"> track so at this point</font>

316
00:16:22,829 --> 00:16:26,779
we didn't really<font color="#E5E5E5"> care about the elegance</font>

317
00:16:24,720 --> 00:16:31,199
anymore<font color="#E5E5E5"> which just made it a</font><font color="#CCCCCC"> better plan</font>

318
00:16:26,779 --> 00:16:33,360
so new plan<font color="#E5E5E5"> was that we will acquire the</font>

319
00:16:31,199 --> 00:16:35,399
vision<font color="#E5E5E5"> software which is basically the</font>

320
00:16:33,360 --> 00:16:37,410
software<font color="#E5E5E5"> that</font><font color="#CCCCCC"> is being used as as a</font>

321
00:16:35,399 --> 00:16:40,290
back-end solution for provisioning these

322
00:16:37,410 --> 00:16:42,329
cards<font color="#E5E5E5"> and then we would reverse engineer</font>

323
00:16:40,290 --> 00:16:45,000
the software and then we would<font color="#E5E5E5"> just go</font>

324
00:16:42,329 --> 00:16:48,329
on<font color="#CCCCCC"> from there</font><font color="#E5E5E5"> so acquiring software</font>

325
00:16:45,000 --> 00:16:50,519
<font color="#E5E5E5">really easy because of internet so you</font>

326
00:16:48,329 --> 00:16:54,029
just do some Google magic<font color="#E5E5E5"> and then you</font>

327
00:16:50,519 --> 00:16:57,149
can download the whole<font color="#E5E5E5"> full installation</font>

328
00:16:54,029 --> 00:16:59,790
CD<font color="#E5E5E5"> and the</font><font color="#CCCCCC"> command accompanying manual</font>

329
00:16:57,149 --> 00:17:01,470
so the PDF<font color="#CCCCCC"> that comes with it</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> then</font>

330
00:16:59,790 --> 00:17:03,779
you<font color="#CCCCCC"> just reverse engineer the software</font>

331
00:17:01,470 --> 00:17:05,309
<font color="#E5E5E5">and you'll be done</font><font color="#CCCCCC"> with it</font><font color="#E5E5E5"> right</font><font color="#CCCCCC"> oh well</font>

332
00:17:03,779 --> 00:17:07,530
it turns<font color="#E5E5E5"> out that it's</font><font color="#CCCCCC"> not that</font><font color="#E5E5E5"> easy</font>

333
00:17:05,309 --> 00:17:10,559
<font color="#E5E5E5">first you need</font><font color="#CCCCCC"> to read and understand</font>

334
00:17:07,530 --> 00:17:13,918
<font color="#E5E5E5">product manuals</font><font color="#CCCCCC"> and when I see it read</font>

335
00:17:10,559 --> 00:17:16,670
and understand<font color="#CCCCCC"> I mean like 500 pages of</font>

336
00:17:13,919 --> 00:17:20,150
<font color="#CCCCCC">those and that became</font>

337
00:17:16,670 --> 00:17:22,280
such a<font color="#E5E5E5"> complicated task that we have to</font>

338
00:17:20,150 --> 00:17:25,010
do<font color="#E5E5E5"> our</font><font color="#CCCCCC"> own mind map</font><font color="#E5E5E5"> in order to</font>

339
00:17:22,280 --> 00:17:26,990
understand this when<font color="#E5E5E5"> we showed these</font><font color="#CCCCCC"> to</font>

340
00:17:25,010 --> 00:17:28,790
the sry guys they told us that<font color="#E5E5E5"> we</font>

341
00:17:26,990 --> 00:17:31,130
actually<font color="#E5E5E5"> have a better documentation of</font>

342
00:17:28,790 --> 00:17:31,820
the system than they do<font color="#E5E5E5"> and if you zoom</font>

343
00:17:31,130 --> 00:17:34,100
<font color="#E5E5E5">in</font>

344
00:17:31,820 --> 00:17:36,620
we<font color="#CCCCCC"> actually documented each and every</font>

345
00:17:34,100 --> 00:17:39,560
piece<font color="#CCCCCC"> of things so for example here we</font>

346
00:17:36,620 --> 00:17:41,389
<font color="#CCCCCC">have some use cases that map the actions</font>

347
00:17:39,560 --> 00:17:43,490
<font color="#E5E5E5">so if you click on a</font><font color="#CCCCCC"> use</font><font color="#E5E5E5"> case it</font>

348
00:17:41,390 --> 00:17:46,100
actually documents<font color="#CCCCCC"> it's documented</font><font color="#E5E5E5"> here</font>

349
00:17:43,490 --> 00:17:48,500
what happens there and it goes and<font color="#E5E5E5"> on</font>

350
00:17:46,100 --> 00:17:50,990
and on and on<font color="#E5E5E5"> so we have fields of</font>

351
00:17:48,500 --> 00:17:53,180
interest here like<font color="#E5E5E5"> user you need user</font>

352
00:17:50,990 --> 00:17:56,960
identification how does it that work or

353
00:17:53,180 --> 00:18:01,670
how the randomness works<font color="#CCCCCC"> and well you</font>

354
00:17:56,960 --> 00:18:03,410
get<font color="#CCCCCC"> the idea</font><font color="#E5E5E5"> the best thing here was</font>

355
00:18:01,670 --> 00:18:06,560
that<font color="#E5E5E5"> once we went through</font><font color="#CCCCCC"> all the</font>

356
00:18:03,410 --> 00:18:08,990
manuals and documented everything<font color="#E5E5E5"> we</font>

357
00:18:06,560 --> 00:18:13,730
<font color="#E5E5E5">realize</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> you can become a hacker by</font>

358
00:18:08,990 --> 00:18:16,010
reading a manual and the way it works is

359
00:18:13,730 --> 00:18:18,140
that we had one<font color="#E5E5E5"> issue when</font><font color="#CCCCCC"> we install</font>

360
00:18:16,010 --> 00:18:21,260
the software<font color="#CCCCCC"> we didn't really</font><font color="#E5E5E5"> have a</font>

361
00:18:18,140 --> 00:18:23,000
license<font color="#CCCCCC"> for it</font><font color="#E5E5E5"> so for</font><font color="#CCCCCC"> a while we</font><font color="#E5E5E5"> figured</font>

362
00:18:21,260 --> 00:18:25,970
that<font color="#CCCCCC"> ok maybe we just need to go</font>

363
00:18:23,000 --> 00:18:29,060
<font color="#CCCCCC">old-school</font><font color="#E5E5E5"> and crack it but then</font><font color="#CCCCCC"> FEMA</font>

364
00:18:25,970 --> 00:18:31,580
figured out a way a better way<font color="#E5E5E5"> which is</font>

365
00:18:29,060 --> 00:18:35,179
just<font color="#CCCCCC"> read the manual because this is</font>

366
00:18:31,580 --> 00:18:37,790
from the manual<font color="#E5E5E5"> and it has an example</font>

367
00:18:35,180 --> 00:18:40,190
<font color="#CCCCCC">and theme of just entered those values</font>

368
00:18:37,790 --> 00:18:43,909
to the actual program and use you<font color="#E5E5E5"> can</font>

369
00:18:40,190 --> 00:18:46,190
use<font color="#E5E5E5"> the manual</font><font color="#CCCCCC"> document it feels</font><font color="#E5E5E5"> and</font>

370
00:18:43,910 --> 00:18:50,630
enable your<font color="#E5E5E5"> licensed copy</font><font color="#CCCCCC"> operation</font>

371
00:18:46,190 --> 00:18:52,660
green<font color="#E5E5E5"> card software so that's</font><font color="#CCCCCC"> how you</font>

372
00:18:50,630 --> 00:18:55,250
become a hacker<font color="#E5E5E5"> that's how we got here</font>

373
00:18:52,660 --> 00:18:57,680
<font color="#E5E5E5">so the next plan was to build a hotel</font>

374
00:18:55,250 --> 00:18:59,810
<font color="#CCCCCC">when and why we didn't have enough time</font>

375
00:18:57,680 --> 00:19:04,580
<font color="#CCCCCC">for that we</font><font color="#E5E5E5"> just decided to build a lab</font>

376
00:18:59,810 --> 00:19:07,669
which looked something like<font color="#CCCCCC"> this and at</font>

377
00:19:04,580 --> 00:19:10,340
this point<font color="#E5E5E5"> we figured out that</font><font color="#CCCCCC"> ok we</font>

378
00:19:07,670 --> 00:19:13,850
can't really<font color="#CCCCCC"> use magstripe for this and</font>

379
00:19:10,340 --> 00:19:16,580
the issue we had was<font color="#CCCCCC"> that</font><font color="#E5E5E5"> this for</font><font color="#CCCCCC"> while</font>

380
00:19:13,850 --> 00:19:19,879
this piece of<font color="#E5E5E5"> hardware is super fine for</font>

381
00:19:16,580 --> 00:19:24,230
most<font color="#E5E5E5"> of the things it's super unreliable</font>

382
00:19:19,880 --> 00:19:26,180
<font color="#E5E5E5">so if you swipe the same card twice</font><font color="#CCCCCC"> you</font>

383
00:19:24,230 --> 00:19:28,040
might end up having<font color="#CCCCCC"> a two</font><font color="#E5E5E5"> different</font>

384
00:19:26,180 --> 00:19:30,230
dumps of it and if you're<font color="#E5E5E5"> doing</font>

385
00:19:28,040 --> 00:19:33,110
resurgence<font color="#E5E5E5"> it's it's</font><font color="#CCCCCC"> bit</font><font color="#E5E5E5"> pain</font>

386
00:19:30,230 --> 00:19:35,960
full thing when you don't know if the

387
00:19:33,110 --> 00:19:37,969
dump<font color="#E5E5E5"> that the values that you have are</font>

388
00:19:35,960 --> 00:19:40,419
actually<font color="#E5E5E5"> real or they're just</font><font color="#CCCCCC"> some</font>

389
00:19:37,970 --> 00:19:43,100
writing errors or<font color="#E5E5E5"> encoding errors</font><font color="#CCCCCC"> and</font>

390
00:19:40,419 --> 00:19:46,940
what we would<font color="#E5E5E5"> have me need was this</font>

391
00:19:43,100 --> 00:19:49,399
<font color="#E5E5E5">device unfortunately it costs thousands</font>

392
00:19:46,940 --> 00:19:52,760
<font color="#E5E5E5">of euros and we</font><font color="#CCCCCC"> couldn't</font><font color="#E5E5E5"> really afford</font>

393
00:19:49,400 --> 00:19:55,070
that so we figured that<font color="#CCCCCC"> okay forget this</font>

394
00:19:52,760 --> 00:19:57,410
as well<font color="#CCCCCC"> and we're just gonna build</font><font color="#E5E5E5"> a lab</font>

395
00:19:55,070 --> 00:19:59,600
with an<font color="#CCCCCC"> rfid</font><font color="#E5E5E5"> reader</font><font color="#CCCCCC"> it doesn't really</font>

396
00:19:57,410 --> 00:20:02,000
matter because<font color="#CCCCCC"> rfid is a kind</font><font color="#E5E5E5"> of a new</font>

397
00:19:59,600 --> 00:20:05,719
new kid in the block<font color="#E5E5E5"> anyways so we</font>

398
00:20:02,000 --> 00:20:09,020
decided<font color="#CCCCCC"> to go for this initially we went</font>

399
00:20:05,720 --> 00:20:11,240
for this because<font color="#E5E5E5"> of the documentation</font><font color="#CCCCCC"> so</font>

400
00:20:09,020 --> 00:20:13,370
the documentation said that we should be

401
00:20:11,240 --> 00:20:16,480
able<font color="#E5E5E5"> to get the lab environment</font><font color="#CCCCCC"> working</font>

402
00:20:13,370 --> 00:20:20,209
<font color="#E5E5E5">with this encoder decoder</font><font color="#CCCCCC"> and</font>

403
00:20:16,480 --> 00:20:22,520
immediately<font color="#CCCCCC"> twenty hours later we</font><font color="#E5E5E5"> were</font>

404
00:20:20,210 --> 00:20:24,530
<font color="#E5E5E5">able to get it work this story is so</font>

405
00:20:22,520 --> 00:20:27,080
embarrassing that<font color="#E5E5E5"> I'm only gonna share</font>

406
00:20:24,530 --> 00:20:28,370
<font color="#CCCCCC">it here with you and a few thousand</font>

407
00:20:27,080 --> 00:20:30,649
<font color="#CCCCCC">people</font><font color="#E5E5E5"> who will watch the video</font>

408
00:20:28,370 --> 00:20:33,439
afterwards<font color="#E5E5E5"> so</font><font color="#CCCCCC"> we didn't really</font><font color="#E5E5E5"> realize</font>

409
00:20:30,650 --> 00:20:35,299
because<font color="#E5E5E5"> our</font><font color="#CCCCCC"> blob had been built with the</font>

410
00:20:33,440 --> 00:20:38,210
Mac strive in mind<font color="#CCCCCC"> so we didn't really</font>

411
00:20:35,299 --> 00:20:41,000
<font color="#CCCCCC">realize that</font><font color="#E5E5E5"> you need to actually rerun</font>

412
00:20:38,210 --> 00:20:43,370
the<font color="#CCCCCC"> installer</font><font color="#E5E5E5"> before it installs all the</font>

413
00:20:41,000 --> 00:20:45,830
<font color="#E5E5E5">walks or all the building blocks</font><font color="#CCCCCC"> needed</font>

414
00:20:43,370 --> 00:20:48,168
for the RFID<font color="#E5E5E5"> things so we spent like 20</font>

415
00:20:45,830 --> 00:20:50,389
<font color="#CCCCCC">hours</font><font color="#E5E5E5"> debugging</font><font color="#CCCCCC"> event why aren't these</font>

416
00:20:48,169 --> 00:20:51,020
<font color="#E5E5E5">DLL so loading them and why isn't it</font>

417
00:20:50,390 --> 00:20:53,780
working

418
00:20:51,020 --> 00:20:56,900
and then finally figured<font color="#E5E5E5"> out that oh we</font>

419
00:20:53,780 --> 00:20:59,030
need<font color="#E5E5E5"> to rerun the</font><font color="#CCCCCC"> setup dot exe</font><font color="#E5E5E5"> and then</font>

420
00:20:56,900 --> 00:21:01,160
we got it working<font color="#CCCCCC"> and we were able to</font>

421
00:20:59,030 --> 00:21:03,460
provision our own course on<font color="#E5E5E5"> our lab</font>

422
00:21:01,160 --> 00:21:06,230
environment<font color="#CCCCCC"> this</font><font color="#E5E5E5"> is this</font><font color="#CCCCCC"> beautiful</font>

423
00:21:03,460 --> 00:21:09,830
delfield<font color="#E5E5E5"> enabled piece of software that</font>

424
00:21:06,230 --> 00:21:14,210
<font color="#E5E5E5">allows</font><font color="#CCCCCC"> you to to do write</font><font color="#E5E5E5"> your own key</font>

425
00:21:09,830 --> 00:21:18,168
cards then we have to acquire a working

426
00:21:14,210 --> 00:21:20,450
knowledge of<font color="#CCCCCC"> RFID</font><font color="#E5E5E5"> and the problem was</font>

427
00:21:18,169 --> 00:21:22,460
<font color="#CCCCCC">that we had never</font><font color="#E5E5E5"> done anything with</font>

428
00:21:20,450 --> 00:21:26,750
RFID and that kind<font color="#E5E5E5"> of explains why this</font>

429
00:21:22,460 --> 00:21:28,940
<font color="#E5E5E5">took 15</font><font color="#CCCCCC"> years</font><font color="#E5E5E5"> from us so it turns out</font>

430
00:21:26,750 --> 00:21:32,240
<font color="#CCCCCC">that there is</font><font color="#E5E5E5"> a lot to be</font><font color="#CCCCCC"> learned about</font>

431
00:21:28,940 --> 00:21:35,090
RFID<font color="#CCCCCC"> but in this case they are using</font>

432
00:21:32,240 --> 00:21:38,710
mostly ultralight or ultralight ev1

433
00:21:35,090 --> 00:21:42,199
<font color="#CCCCCC">cards and these are not crypto cards</font><font color="#E5E5E5"> in</font>

434
00:21:38,710 --> 00:21:42,980
themselves<font color="#E5E5E5"> so</font><font color="#CCCCCC"> they are just you can</font>

435
00:21:42,200 --> 00:21:45,830
think of them

436
00:21:42,980 --> 00:21:48,710
<font color="#E5E5E5">as as like a glorified</font><font color="#CCCCCC"> a USB stick more</font>

437
00:21:45,830 --> 00:21:51,428
or<font color="#E5E5E5"> less they</font><font color="#CCCCCC"> are just</font><font color="#E5E5E5"> storing data the</font>

438
00:21:48,710 --> 00:21:54,860
ev1<font color="#CCCCCC"> is a slightly better version of</font>

439
00:21:51,429 --> 00:21:58,520
<font color="#CCCCCC">ultralight meaning that it has a shared</font>

440
00:21:54,860 --> 00:22:01,159
secret<font color="#E5E5E5"> but that</font><font color="#CCCCCC"> has nothing</font><font color="#E5E5E5"> to do</font><font color="#CCCCCC"> with</font>

441
00:21:58,520 --> 00:22:04,760
security<font color="#CCCCCC"> it's basically just a feature</font>

442
00:22:01,160 --> 00:22:08,919
that is is trying to stop cloning these

443
00:22:04,760 --> 00:22:11,960
carbs<font color="#E5E5E5"> so it's a shared secret that gets</font>

444
00:22:08,919 --> 00:22:14,030
broadcast<font color="#E5E5E5"> it when</font><font color="#CCCCCC"> you're you're when</font>

445
00:22:11,960 --> 00:22:16,460
you're accessing<font color="#E5E5E5"> your</font><font color="#CCCCCC"> lock with this</font>

446
00:22:14,030 --> 00:22:18,799
ultralight ev1<font color="#E5E5E5"> card and if you have a</font>

447
00:22:16,460 --> 00:22:21,169
fine piece of hardware like proxmark you

448
00:22:18,799 --> 00:22:25,179
can just listen<font color="#E5E5E5"> to that traffic and get</font>

449
00:22:21,169 --> 00:22:28,370
the shared secret<font color="#E5E5E5"> from that handshake</font>

450
00:22:25,179 --> 00:22:30,460
once we finally had<font color="#E5E5E5"> the software running</font>

451
00:22:28,370 --> 00:22:33,620
<font color="#E5E5E5">and we were able to create the key cards</font>

452
00:22:30,460 --> 00:22:35,990
<font color="#E5E5E5">it was easy to start reverse engineering</font>

453
00:22:33,620 --> 00:22:38,870
the thing one<font color="#CCCCCC"> of</font><font color="#E5E5E5"> the first things that</font>

454
00:22:35,990 --> 00:22:41,990
we<font color="#E5E5E5"> did was since we had hundreds of</font>

455
00:22:38,870 --> 00:22:46,070
<font color="#E5E5E5">those RFID cards we dumped</font><font color="#CCCCCC"> the data from</font>

456
00:22:41,990 --> 00:22:49,250
those hotel key cards and simply looking

457
00:22:46,070 --> 00:22:54,580
<font color="#E5E5E5">at the data on the cards it was easy</font>

458
00:22:49,250 --> 00:22:57,080
<font color="#E5E5E5">easy to</font><font color="#CCCCCC"> notice this 33 byte sequence</font><font color="#E5E5E5"> and</font>

459
00:22:54,580 --> 00:22:59,418
the reason why<font color="#E5E5E5"> that sequence looked</font>

460
00:22:57,080 --> 00:23:02,059
familiar was that those were<font color="#CCCCCC"> very</font>

461
00:22:59,419 --> 00:23:05,390
similar<font color="#CCCCCC"> to the 33 bytes</font><font color="#E5E5E5"> that you have on</font>

462
00:23:02,059 --> 00:23:08,270
the<font color="#CCCCCC"> mac stripe cards</font><font color="#E5E5E5"> and this is exactly</font>

463
00:23:05,390 --> 00:23:10,429
<font color="#CCCCCC">the same</font><font color="#E5E5E5"> format that you have there so</font>

464
00:23:08,270 --> 00:23:13,370
you have 33 bytes<font color="#E5E5E5"> and the first one is a</font>

465
00:23:10,429 --> 00:23:15,320
checksum byte which<font color="#CCCCCC"> also works as an</font>

466
00:23:13,370 --> 00:23:18,350
encryption<font color="#E5E5E5"> key</font><font color="#CCCCCC"> and when I say encryption</font>

467
00:23:15,320 --> 00:23:23,330
I mean<font color="#E5E5E5"> a single byte XOR so a very</font>

468
00:23:18,350 --> 00:23:26,870
simple<font color="#E5E5E5"> increase the challenge with the</font>

469
00:23:23,330 --> 00:23:30,049
day<font color="#E5E5E5"> that is that the format sucks so</font>

470
00:23:26,870 --> 00:23:32,989
let's say you have a one byte logical

471
00:23:30,049 --> 00:23:35,510
value<font color="#E5E5E5"> it might be that you</font><font color="#CCCCCC"> need to</font><font color="#E5E5E5"> take</font>

472
00:23:32,990 --> 00:23:38,270
five bits from<font color="#CCCCCC"> here and then you take</font>

473
00:23:35,510 --> 00:23:41,750
<font color="#E5E5E5">two bits from here</font><font color="#CCCCCC"> and then</font><font color="#E5E5E5"> the final</font>

474
00:23:38,270 --> 00:23:43,730
bit from another offset so the logical

475
00:23:41,750 --> 00:23:47,330
values are collected from small

476
00:23:43,730 --> 00:23:50,030
collection of<font color="#E5E5E5"> bits and in order to</font>

477
00:23:47,330 --> 00:23:52,189
understand the structure of<font color="#E5E5E5"> the data to</font>

478
00:23:50,030 --> 00:23:55,309
<font color="#CCCCCC">document it and also to visualize it</font>

479
00:23:52,190 --> 00:23:56,580
<font color="#CCCCCC">with things like</font><font color="#E5E5E5"> this we used guide I</font>

480
00:23:55,309 --> 00:23:58,918
struct

481
00:23:56,580 --> 00:24:01,889
<font color="#E5E5E5">this is a pretty nice tool so what you</font>

482
00:23:58,919 --> 00:24:04,110
do is you<font color="#E5E5E5"> first describe the data you</font>

483
00:24:01,890 --> 00:24:07,140
describe the<font color="#CCCCCC"> sequence of</font><font color="#E5E5E5"> bits and bytes</font>

484
00:24:04,110 --> 00:24:10,168
<font color="#CCCCCC">you</font><font color="#E5E5E5"> basically just label the bytes and</font>

485
00:24:07,140 --> 00:24:12,809
bits<font color="#E5E5E5"> and after that you can</font><font color="#CCCCCC"> combine</font>

486
00:24:10,169 --> 00:24:15,330
those into<font color="#E5E5E5"> logical values like</font><font color="#CCCCCC"> you can</font>

487
00:24:12,809 --> 00:24:17,039
see on the last line so you have five

488
00:24:15,330 --> 00:24:20,610
bits and two bits<font color="#E5E5E5"> and one</font><font color="#CCCCCC"> bit and</font>

489
00:24:17,039 --> 00:24:23,100
combine it<font color="#E5E5E5"> into a single value once</font>

490
00:24:20,610 --> 00:24:24,809
you've done<font color="#E5E5E5"> this you can generate the</font>

491
00:24:23,100 --> 00:24:28,889
kind<font color="#E5E5E5"> of graphs that I just showed you</font>

492
00:24:24,809 --> 00:24:31,649
<font color="#CCCCCC">and the other nice thing is that from</font>

493
00:24:28,889 --> 00:24:33,840
<font color="#CCCCCC">that definition you can create a</font>

494
00:24:31,649 --> 00:24:36,199
de-serialize<font color="#CCCCCC"> err for your favorite</font>

495
00:24:33,840 --> 00:24:39,059
programming<font color="#CCCCCC"> language so you</font><font color="#E5E5E5"> just</font>

496
00:24:36,200 --> 00:24:40,919
automatically process<font color="#E5E5E5"> the</font><font color="#CCCCCC"> Declaration of</font>

497
00:24:39,059 --> 00:24:42,990
<font color="#CCCCCC">the data and then</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> have a</font>

498
00:24:40,919 --> 00:24:46,380
de-serialize<font color="#E5E5E5"> err in our case we used</font>

499
00:24:42,990 --> 00:24:48,269
<font color="#E5E5E5">Python</font><font color="#CCCCCC"> so this was</font><font color="#E5E5E5"> fairly nice tool to</font>

500
00:24:46,380 --> 00:24:53,010
<font color="#CCCCCC">help with the documentation</font><font color="#E5E5E5"> and</font>

501
00:24:48,269 --> 00:24:54,929
<font color="#CCCCCC">visualization of the data and once we</font>

502
00:24:53,010 --> 00:24:57,029
more or less understood or at least we

503
00:24:54,929 --> 00:24:58,980
thought we understood<font color="#CCCCCC"> the structure</font><font color="#E5E5E5"> of</font>

504
00:24:57,029 --> 00:25:01,440
the data we were able<font color="#E5E5E5"> to start the quest</font>

505
00:24:58,980 --> 00:25:04,320
for<font color="#E5E5E5"> the master key so the master key is</font>

506
00:25:01,440 --> 00:25:08,010
something that<font color="#CCCCCC"> opens all the doors</font><font color="#E5E5E5"> in</font>

507
00:25:04,320 --> 00:25:10,860
the<font color="#CCCCCC"> hotel</font><font color="#E5E5E5"> the first thing that we tried</font>

508
00:25:08,010 --> 00:25:14,789
<font color="#E5E5E5">was simply updating the facility code on</font>

509
00:25:10,860 --> 00:25:17,219
the master key facility code is<font color="#E5E5E5"> simply a</font>

510
00:25:14,789 --> 00:25:19,590
number<font color="#E5E5E5"> that uniquely identifies</font><font color="#CCCCCC"> the</font>

511
00:25:17,220 --> 00:25:22,470
hotel so what we<font color="#E5E5E5"> did was we</font><font color="#CCCCCC"> created a</font>

512
00:25:19,590 --> 00:25:24,870
master key in our lab environment<font color="#E5E5E5"> we</font>

513
00:25:22,470 --> 00:25:27,240
updated the facility<font color="#E5E5E5"> code to match a</font>

514
00:25:24,870 --> 00:25:30,809
real hotel<font color="#E5E5E5"> and then we tried that key in</font>

515
00:25:27,240 --> 00:25:32,970
<font color="#E5E5E5">that real hotel</font><font color="#CCCCCC"> and we failed it didn't</font>

516
00:25:30,809 --> 00:25:35,519
work it would have been awesome is if

517
00:25:32,970 --> 00:25:37,230
<font color="#E5E5E5">this would have</font><font color="#CCCCCC"> worked</font><font color="#E5E5E5"> but no at this</font>

518
00:25:35,519 --> 00:25:42,320
<font color="#E5E5E5">point we were actually concealed quite</font>

519
00:25:37,230 --> 00:25:44,880
far from<font color="#E5E5E5"> the solution so we decided</font><font color="#CCCCCC"> ok</font>

520
00:25:42,320 --> 00:25:45,928
<font color="#E5E5E5">let's take a step back</font><font color="#CCCCCC"> let's try</font>

521
00:25:44,880 --> 00:25:49,559
something more<font color="#E5E5E5"> simple</font>

522
00:25:45,929 --> 00:25:54,299
let's try cloning a normal guest keycard

523
00:25:49,559 --> 00:25:58,230
<font color="#CCCCCC">so real</font><font color="#E5E5E5"> hotel again</font><font color="#CCCCCC"> we failed</font><font color="#E5E5E5"> and this</font>

524
00:25:54,299 --> 00:26:00,059
should have<font color="#CCCCCC"> been simple I mean</font><font color="#E5E5E5"> there's</font>

525
00:25:58,230 --> 00:26:02,820
no reason<font color="#E5E5E5"> why why this this wouldn't</font>

526
00:26:00,059 --> 00:26:06,510
<font color="#CCCCCC">work so we had to do some more reverse</font>

527
00:26:02,820 --> 00:26:08,610
engineering<font color="#E5E5E5"> and at some point we learned</font>

528
00:26:06,510 --> 00:26:09,690
that if<font color="#CCCCCC"> you look at the data</font><font color="#E5E5E5"> on the</font>

529
00:26:08,610 --> 00:26:12,840
<font color="#CCCCCC">keycard</font>

530
00:26:09,690 --> 00:26:15,630
the last<font color="#E5E5E5"> four bytes are a checksum</font>

531
00:26:12,840 --> 00:26:17,399
generated by the vision<font color="#E5E5E5"> software that</font>

532
00:26:15,630 --> 00:26:21,630
the<font color="#CCCCCC"> hotel's used to create those key</font>

533
00:26:17,400 --> 00:26:24,480
cards<font color="#CCCCCC"> and that checksum ties the day the</font>

534
00:26:21,630 --> 00:26:29,010
back to the unique identifier of<font color="#E5E5E5"> that</font>

535
00:26:24,480 --> 00:26:31,710
RFID card so if we would<font color="#E5E5E5"> have fused</font>

536
00:26:29,010 --> 00:26:34,620
<font color="#CCCCCC">those</font><font color="#E5E5E5"> Chinese</font><font color="#CCCCCC"> RFID</font><font color="#E5E5E5"> cards where you can</font>

537
00:26:31,710 --> 00:26:37,080
also control<font color="#CCCCCC"> the UID</font><font color="#E5E5E5"> we wouldn't have</font>

538
00:26:34,620 --> 00:26:39,600
<font color="#E5E5E5">had this problem</font><font color="#CCCCCC"> but since we didn't</font>

539
00:26:37,080 --> 00:26:42,240
<font color="#E5E5E5">control the UID the cloning failed</font>

540
00:26:39,600 --> 00:26:45,659
<font color="#CCCCCC">because we didn't have</font><font color="#E5E5E5"> the correct</font>

541
00:26:42,240 --> 00:26:47,370
checksum<font color="#CCCCCC"> at the end of the data once we</font>

542
00:26:45,660 --> 00:26:50,100
had<font color="#CCCCCC"> reverse-engineer the software we</font>

543
00:26:47,370 --> 00:26:52,320
knew how to calculate<font color="#E5E5E5"> the RFID checksum</font>

544
00:26:50,100 --> 00:26:55,560
and<font color="#E5E5E5"> then we were finally able to create</font>

545
00:26:52,320 --> 00:27:00,050
a<font color="#E5E5E5"> physical tag that is a clone of a real</font>

546
00:26:55,560 --> 00:27:03,240
<font color="#E5E5E5">hotel key so at least some some progress</font>

547
00:27:00,050 --> 00:27:05,909
the next logical<font color="#E5E5E5"> step was to try to</font>

548
00:27:03,240 --> 00:27:08,610
simulate a key<font color="#CCCCCC"> so instead of writing a</font>

549
00:27:05,910 --> 00:27:10,950
physical tag that<font color="#CCCCCC"> you can use we wanted</font>

550
00:27:08,610 --> 00:27:15,270
to simulate a key with the<font color="#CCCCCC"> proxmark</font>

551
00:27:10,950 --> 00:27:18,110
<font color="#E5E5E5">device that we were using here's the</font>

552
00:27:15,270 --> 00:27:21,150
device<font color="#E5E5E5"> so that's the revision</font><font color="#CCCCCC"> 3 and</font>

553
00:27:18,110 --> 00:27:25,830
that's very capable device<font color="#E5E5E5"> I mean you</font>

554
00:27:21,150 --> 00:27:28,680
can read<font color="#CCCCCC"> RFID right RFID tags you can</font>

555
00:27:25,830 --> 00:27:32,340
<font color="#E5E5E5">simulate them you can do lots of things</font>

556
00:27:28,680 --> 00:27:35,160
very powerful<font color="#E5E5E5"> for some reason we didn't</font>

557
00:27:32,340 --> 00:27:39,659
get the simulation working though we

558
00:27:35,160 --> 00:27:42,450
failed<font color="#E5E5E5"> and this was probably one</font><font color="#CCCCCC"> of the</font>

559
00:27:39,660 --> 00:27:44,970
most challenging<font color="#E5E5E5"> things</font><font color="#CCCCCC"> to debug during</font>

560
00:27:42,450 --> 00:27:51,390
the whole<font color="#E5E5E5"> research this almost turned us</font>

561
00:27:44,970 --> 00:27:54,390
into an alcoholic<font color="#CCCCCC"> luckily just almost</font><font color="#E5E5E5"> so</font>

562
00:27:51,390 --> 00:27:56,340
here you can see the state diagram of a

563
00:27:54,390 --> 00:27:59,090
<font color="#E5E5E5">my for</font><font color="#CCCCCC"> ultralight card</font><font color="#E5E5E5"> the state diagram</font>

564
00:27:56,340 --> 00:28:02,550
<font color="#E5E5E5">isn't really anything</font><font color="#CCCCCC"> that complicated</font>

565
00:27:59,090 --> 00:28:03,990
<font color="#E5E5E5">but before you can read any data from</font>

566
00:28:02,550 --> 00:28:06,120
the card or before you can write any

567
00:28:03,990 --> 00:28:08,820
data to the card<font color="#E5E5E5"> you need to reach this</font>

568
00:28:06,120 --> 00:28:11,120
active state<font color="#E5E5E5"> and the way you get</font><font color="#CCCCCC"> to the</font>

569
00:28:08,820 --> 00:28:14,159
active<font color="#E5E5E5"> state is through a process</font><font color="#CCCCCC"> called</font>

570
00:28:11,120 --> 00:28:15,840
<font color="#E5E5E5">anti-collision and the reason they have</font>

571
00:28:14,160 --> 00:28:18,150
the<font color="#E5E5E5"> anti-collision process is that it</font>

572
00:28:15,840 --> 00:28:20,220
might happen<font color="#CCCCCC"> that you have a reader and</font>

573
00:28:18,150 --> 00:28:23,220
then<font color="#E5E5E5"> within the field of the</font><font color="#CCCCCC"> reader you</font>

574
00:28:20,220 --> 00:28:25,350
<font color="#CCCCCC">have</font><font color="#E5E5E5"> two different RFID tags</font>

575
00:28:23,220 --> 00:28:28,680
so there<font color="#E5E5E5"> needs to be a process for the</font>

576
00:28:25,350 --> 00:28:30,870
reader<font color="#CCCCCC"> to select to</font><font color="#E5E5E5"> which tag it wants</font>

577
00:28:28,680 --> 00:28:33,450
to talk<font color="#CCCCCC"> to</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> basically the first</font><font color="#E5E5E5"> asks</font>

578
00:28:30,870 --> 00:28:35,550
<font color="#E5E5E5">that okay what tax do we have both of</font>

579
00:28:33,450 --> 00:28:38,430
<font color="#E5E5E5">the</font><font color="#CCCCCC"> tag</font><font color="#E5E5E5"> saying yeah I'm here then it</font>

580
00:28:35,550 --> 00:28:40,020
says<font color="#E5E5E5"> okay</font><font color="#CCCCCC"> now it's your turn to talk you</font>

581
00:28:38,430 --> 00:28:42,360
shut<font color="#CCCCCC"> up and then the other way around</font>

582
00:28:40,020 --> 00:28:45,930
<font color="#CCCCCC">and</font><font color="#E5E5E5"> that way the reader can</font><font color="#CCCCCC"> hold the</font>

583
00:28:42,360 --> 00:28:47,729
<font color="#E5E5E5">multiple</font><font color="#CCCCCC"> different tags it's really not</font>

584
00:28:45,930 --> 00:28:50,520
<font color="#CCCCCC">that</font><font color="#E5E5E5"> complicated</font><font color="#CCCCCC"> it's it's a fairly</font>

585
00:28:47,730 --> 00:28:53,670
simple protocol you<font color="#CCCCCC"> can think of</font><font color="#E5E5E5"> it like</font>

586
00:28:50,520 --> 00:28:56,010
<font color="#CCCCCC">a simple handshake</font><font color="#E5E5E5"> and you can imagine</font>

587
00:28:53,670 --> 00:28:59,270
our frustration that it was this simple

588
00:28:56,010 --> 00:29:02,129
<font color="#CCCCCC">handshake that was clearly</font><font color="#E5E5E5"> failing</font><font color="#CCCCCC"> and</font>

589
00:28:59,270 --> 00:29:04,530
<font color="#E5E5E5">we were using a very</font><font color="#CCCCCC"> well known device</font>

590
00:29:02,130 --> 00:29:08,700
proxmark so we thought<font color="#CCCCCC"> that okay</font><font color="#E5E5E5"> this</font>

591
00:29:04,530 --> 00:29:09,180
should work now<font color="#E5E5E5"> that I know what was the</font>

592
00:29:08,700 --> 00:29:11,730
problem

593
00:29:09,180 --> 00:29:14,430
I can<font color="#E5E5E5"> I can also easily see why it</font>

594
00:29:11,730 --> 00:29:18,180
didn't work<font color="#E5E5E5"> because the protocol is a</font>

595
00:29:14,430 --> 00:29:20,340
mess<font color="#CCCCCC"> we had to do a lot of reading we</font>

596
00:29:18,180 --> 00:29:22,160
went back to<font color="#E5E5E5"> the ISO standards we</font>

597
00:29:20,340 --> 00:29:25,649
actually went<font color="#E5E5E5"> back</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> the ISO standard</font>

598
00:29:22,160 --> 00:29:28,950
<font color="#E5E5E5">that</font><font color="#CCCCCC"> defines how the</font><font color="#E5E5E5"> communication works</font>

599
00:29:25,650 --> 00:29:32,520
<font color="#E5E5E5">on the radio level how you're supposed</font>

600
00:29:28,950 --> 00:29:35,250
to transmit<font color="#E5E5E5"> and receive data and this is</font>

601
00:29:32,520 --> 00:29:39,480
<font color="#CCCCCC">a wonderful protocol I mean this is</font>

602
00:29:35,250 --> 00:29:41,850
simply awesome<font color="#E5E5E5"> depending on what command</font>

603
00:29:39,480 --> 00:29:45,060
you're using<font color="#E5E5E5"> and depending</font><font color="#CCCCCC"> on</font><font color="#E5E5E5"> what day</font>

604
00:29:41,850 --> 00:29:48,899
<font color="#CCCCCC">that you're sending there's a different</font>

605
00:29:45,060 --> 00:29:52,050
delay<font color="#E5E5E5"> that the court has</font><font color="#CCCCCC"> to wait before</font>

606
00:29:48,900 --> 00:29:54,930
it replies back to the reader<font color="#E5E5E5"> so</font><font color="#CCCCCC"> based</font>

607
00:29:52,050 --> 00:29:57,930
on the command and the data sent by the

608
00:29:54,930 --> 00:30:02,940
reader the tag<font color="#E5E5E5"> has</font><font color="#CCCCCC"> to wait</font><font color="#E5E5E5"> for a</font>

609
00:29:57,930 --> 00:30:05,250
different delay<font color="#E5E5E5"> and this is probably a</font>

610
00:30:02,940 --> 00:30:08,460
very<font color="#CCCCCC"> good</font><font color="#E5E5E5"> reason behind all this I don't</font>

611
00:30:05,250 --> 00:30:10,290
<font color="#E5E5E5">really understand physics or or signal</font>

612
00:30:08,460 --> 00:30:11,790
processing or<font color="#E5E5E5"> anything just</font><font color="#CCCCCC"> probably a</font>

613
00:30:10,290 --> 00:30:15,080
good reason<font color="#E5E5E5"> why it was designed this way</font>

614
00:30:11,790 --> 00:30:18,180
<font color="#CCCCCC">but this this was</font><font color="#E5E5E5"> where the problem was</font>

615
00:30:15,080 --> 00:30:21,179
<font color="#E5E5E5">so the proxmark didn't simply used the</font>

616
00:30:18,180 --> 00:30:23,550
correct delay<font color="#E5E5E5"> so once we identified the</font>

617
00:30:21,180 --> 00:30:25,530
problem it was<font color="#CCCCCC"> very simple to patch we</font>

618
00:30:23,550 --> 00:30:30,600
created a patch then we did a pull

619
00:30:25,530 --> 00:30:33,000
<font color="#CCCCCC">request to the IceMen</font><font color="#E5E5E5"> fork the the patch</font>

620
00:30:30,600 --> 00:30:34,590
was merged and now<font color="#E5E5E5"> it's it's publicly</font>

621
00:30:33,000 --> 00:30:37,510
<font color="#CCCCCC">available for</font><font color="#E5E5E5"> everyone</font>

622
00:30:34,590 --> 00:30:40,629
because the through this that without

623
00:30:37,510 --> 00:30:42,100
devices like<font color="#E5E5E5"> proxmark</font><font color="#CCCCCC"> I mean it's</font>

624
00:30:40,630 --> 00:30:44,050
<font color="#E5E5E5">probably fair to</font><font color="#CCCCCC"> say that we would</font><font color="#E5E5E5"> have</font>

625
00:30:42,100 --> 00:30:46,209
<font color="#E5E5E5">never finished</font><font color="#CCCCCC"> these research I mean we</font>

626
00:30:44,050 --> 00:30:48,970
<font color="#E5E5E5">don't</font><font color="#CCCCCC"> have</font><font color="#E5E5E5"> the skills</font><font color="#CCCCCC"> to build devices</font>

627
00:30:46,210 --> 00:30:50,980
<font color="#E5E5E5">like</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> so we were very</font><font color="#CCCCCC"> lucky</font><font color="#E5E5E5"> to have</font>

628
00:30:48,970 --> 00:30:53,860
<font color="#E5E5E5">that kind of</font><font color="#CCCCCC"> devices available and</font>

629
00:30:50,980 --> 00:30:58,360
hopefully<font color="#E5E5E5"> this was a small way of being</font>

630
00:30:53,860 --> 00:31:00,850
able to give<font color="#E5E5E5"> back to the community okay</font>

631
00:30:58,360 --> 00:31:04,719
now<font color="#CCCCCC"> we're</font><font color="#E5E5E5"> able to simulate</font><font color="#CCCCCC"> keycards some</font>

632
00:31:00,850 --> 00:31:07,419
progress at<font color="#CCCCCC"> least so now we need</font><font color="#E5E5E5"> to</font>

633
00:31:04,720 --> 00:31:10,840
understand what<font color="#CCCCCC"> are the relevant values</font>

634
00:31:07,420 --> 00:31:14,800
within those<font color="#E5E5E5"> 33 bytes there's multiple</font>

635
00:31:10,840 --> 00:31:16,810
<font color="#CCCCCC">logical values within</font><font color="#E5E5E5"> that 33 bytes now</font>

636
00:31:14,800 --> 00:31:19,300
if you reverse<font color="#CCCCCC"> engineer the software</font><font color="#E5E5E5"> and</font>

637
00:31:16,810 --> 00:31:21,129
if you look at the database<font color="#E5E5E5"> and if you</font>

638
00:31:19,300 --> 00:31:24,220
read all<font color="#E5E5E5"> the manuals and patents and</font>

639
00:31:21,130 --> 00:31:27,430
<font color="#E5E5E5">other documentation you can find out</font>

640
00:31:24,220 --> 00:31:30,130
that most of<font color="#E5E5E5"> those values have names</font>

641
00:31:27,430 --> 00:31:33,460
<font color="#E5E5E5">like human readable human understandable</font>

642
00:31:30,130 --> 00:31:36,160
names<font color="#E5E5E5"> and you can imagine that</font><font color="#CCCCCC"> that some</font>

643
00:31:33,460 --> 00:31:38,170
of those names<font color="#CCCCCC"> sound much more</font><font color="#E5E5E5"> exciting</font>

644
00:31:36,160 --> 00:31:40,740
and<font color="#E5E5E5"> interesting and</font><font color="#CCCCCC"> promising than other</font>

645
00:31:38,170 --> 00:31:43,150
names so<font color="#E5E5E5"> obviously when we were trying</font>

646
00:31:40,740 --> 00:31:46,510
different<font color="#E5E5E5"> values and trying to identify</font>

647
00:31:43,150 --> 00:31:49,060
the interesting fields we first focused

648
00:31:46,510 --> 00:31:51,400
on those<font color="#E5E5E5"> fields that had a really</font>

649
00:31:49,060 --> 00:31:53,649
promising<font color="#E5E5E5"> sounding name this is</font><font color="#CCCCCC"> a</font>

650
00:31:51,400 --> 00:31:57,130
totally made-up<font color="#E5E5E5"> name but if the name</font><font color="#CCCCCC"> of</font>

651
00:31:53,650 --> 00:32:00,220
<font color="#E5E5E5">the field would</font><font color="#CCCCCC"> be that like</font><font color="#E5E5E5"> master key</font>

652
00:31:57,130 --> 00:32:02,530
enabled<font color="#E5E5E5"> yes or no that sounds like</font><font color="#CCCCCC"> a</font>

653
00:32:00,220 --> 00:32:09,460
promising<font color="#E5E5E5"> name if you want to create a</font>

654
00:32:02,530 --> 00:32:11,500
master key<font color="#E5E5E5"> didn't work we were focused</font>

655
00:32:09,460 --> 00:32:15,040
<font color="#E5E5E5">on</font><font color="#CCCCCC"> the most promising sounding fields</font>

656
00:32:11,500 --> 00:32:18,250
but no luck<font color="#CCCCCC"> and this this was a very</font>

657
00:32:15,040 --> 00:32:20,500
<font color="#E5E5E5">disappointing part of the research I</font>

658
00:32:18,250 --> 00:32:23,800
<font color="#CCCCCC">mean we were like this this</font><font color="#E5E5E5"> should have</font>

659
00:32:20,500 --> 00:32:27,520
already<font color="#CCCCCC"> worked so we had to sit down</font><font color="#E5E5E5"> and</font>

660
00:32:23,800 --> 00:32:31,120
figure<font color="#E5E5E5"> out a different</font><font color="#CCCCCC"> approach for</font>

661
00:32:27,520 --> 00:32:35,170
creating<font color="#E5E5E5"> the master key</font><font color="#CCCCCC"> and we came up</font>

662
00:32:31,120 --> 00:32:38,919
<font color="#CCCCCC">with one thanks</font><font color="#E5E5E5"> to our connections we</font>

663
00:32:35,170 --> 00:32:41,860
were able<font color="#CCCCCC"> to get a</font><font color="#E5E5E5"> working master key</font>

664
00:32:38,920 --> 00:32:44,520
the real hotel<font color="#E5E5E5"> so we were</font><font color="#CCCCCC"> able to borrow</font>

665
00:32:41,860 --> 00:32:47,350
<font color="#E5E5E5">a real master key to a hotel and we</font>

666
00:32:44,520 --> 00:32:50,670
<font color="#E5E5E5">cloned that one and what we started</font>

667
00:32:47,350 --> 00:32:53,010
doing<font color="#E5E5E5"> was we started crafting</font>

668
00:32:50,670 --> 00:32:56,850
the fields study corrupting the values

669
00:32:53,010 --> 00:32:59,790
on<font color="#E5E5E5"> that</font><font color="#CCCCCC"> card one by</font><font color="#E5E5E5"> one and if the stuff</font>

670
00:32:56,850 --> 00:33:02,189
<font color="#E5E5E5">if the card stopped working after</font><font color="#CCCCCC"> we had</font>

671
00:32:59,790 --> 00:33:04,590
<font color="#CCCCCC">corrupted a field</font><font color="#E5E5E5"> we knew that okay</font><font color="#CCCCCC"> his</font>

672
00:33:02,190 --> 00:33:09,179
field is relevant<font color="#E5E5E5"> if you want to create</font>

673
00:33:04,590 --> 00:33:12,389
<font color="#E5E5E5">a valid master key and this was the</font>

674
00:33:09,179 --> 00:33:15,750
process<font color="#E5E5E5"> that</font><font color="#CCCCCC"> finally led us to</font>

675
00:33:12,390 --> 00:33:18,809
identifying the<font color="#CCCCCC"> relevant values</font><font color="#E5E5E5"> on the</font>

676
00:33:15,750 --> 00:33:23,940
card<font color="#E5E5E5"> fortunately there's not that many</font>

677
00:33:18,809 --> 00:33:28,350
important values however<font color="#E5E5E5"> we had one</font>

678
00:33:23,940 --> 00:33:29,900
value and one<font color="#E5E5E5"> problem and</font><font color="#CCCCCC"> keyspace</font><font color="#E5E5E5"> was</font>

679
00:33:28,350 --> 00:33:34,199
one of them

680
00:33:29,900 --> 00:33:36,840
<font color="#E5E5E5">the value had so many bits that if if</font>

681
00:33:34,200 --> 00:33:40,440
you simply<font color="#E5E5E5"> wanted</font><font color="#CCCCCC"> to figure out</font><font color="#E5E5E5"> what's</font>

682
00:33:36,840 --> 00:33:43,918
the correct<font color="#E5E5E5"> value the only approach you</font>

683
00:33:40,440 --> 00:33:45,690
could take was to<font color="#E5E5E5"> brute</font><font color="#CCCCCC"> force</font><font color="#E5E5E5"> it seems</font>

684
00:33:43,919 --> 00:33:48,120
that it seemed<font color="#E5E5E5"> that there was no logic</font>

685
00:33:45,690 --> 00:33:50,309
behind<font color="#E5E5E5"> it so we we just had to brute</font>

686
00:33:48,120 --> 00:33:53,309
force<font color="#CCCCCC"> it</font><font color="#E5E5E5"> and the natural way to do it</font>

687
00:33:50,309 --> 00:33:57,950
for<font color="#CCCCCC"> us was to</font><font color="#E5E5E5"> create a custom proxmark</font>

688
00:33:53,309 --> 00:34:01,710
firmware so that's what we did

689
00:33:57,950 --> 00:34:04,130
simulating a card<font color="#E5E5E5"> is easy with</font><font color="#CCCCCC"> proxmox</font>

690
00:34:01,710 --> 00:34:06,360
<font color="#E5E5E5">there's already a function for that so</font>

691
00:34:04,130 --> 00:34:09,899
there was nothing nothing really

692
00:34:06,360 --> 00:34:11,879
difficult there we just gave it<font color="#E5E5E5"> slightly</font>

693
00:34:09,899 --> 00:34:14,989
different data every time<font color="#E5E5E5"> so what we</font>

694
00:34:11,879 --> 00:34:18,989
were doing<font color="#CCCCCC"> was modifying that</font><font color="#E5E5E5"> one value</font>

695
00:34:14,989 --> 00:34:22,080
<font color="#E5E5E5">the more challenging part was that when</font>

696
00:34:18,989 --> 00:34:24,569
<font color="#E5E5E5">you bring a key card to the lock it</font>

697
00:34:22,080 --> 00:34:27,179
tries<font color="#CCCCCC"> to read it and if you</font><font color="#E5E5E5"> hold it</font>

698
00:34:24,570 --> 00:34:29,730
there<font color="#E5E5E5"> it tries to read it again so what</font>

699
00:34:27,179 --> 00:34:31,700
we basically<font color="#CCCCCC"> had to</font><font color="#E5E5E5"> do was pull out the</font>

700
00:34:29,730 --> 00:34:34,320
<font color="#E5E5E5">card just like a human would do if you</font>

701
00:34:31,699 --> 00:34:36,089
show the card to<font color="#CCCCCC"> the lock and it gives</font>

702
00:34:34,320 --> 00:34:39,570
you a red light you<font color="#CCCCCC"> probably take</font><font color="#E5E5E5"> the</font>

703
00:34:36,090 --> 00:34:42,119
card back and then show it<font color="#E5E5E5"> to the reader</font>

704
00:34:39,570 --> 00:34:46,770
<font color="#E5E5E5">again so this is something that we had</font>

705
00:34:42,119 --> 00:34:50,369
to do in<font color="#E5E5E5"> software</font><font color="#CCCCCC"> we had to find a</font><font color="#E5E5E5"> way</font>

706
00:34:46,770 --> 00:34:53,079
of somehow<font color="#E5E5E5"> turning off the</font><font color="#CCCCCC"> radio field</font>

707
00:34:50,369 --> 00:34:54,909
the most most straightforward way that

708
00:34:53,079 --> 00:34:57,210
we found was<font color="#E5E5E5"> to simply turn</font><font color="#CCCCCC"> off the</font>

709
00:34:54,909 --> 00:35:00,490
field and we<font color="#E5E5E5"> did that by turning</font>

710
00:34:57,210 --> 00:35:04,089
<font color="#E5E5E5">proxmark back to a reader so instead of</font>

711
00:35:00,490 --> 00:35:05,828
acting as an RFID tag<font color="#CCCCCC"> it acted as a</font>

712
00:35:04,089 --> 00:35:07,839
reader<font color="#E5E5E5"> and</font><font color="#CCCCCC"> that was enough to turn the</font>

713
00:35:05,829 --> 00:35:10,690
<font color="#E5E5E5">field and then the lock thought</font><font color="#CCCCCC"> but okay</font>

714
00:35:07,839 --> 00:35:13,240
there's no more key present<font color="#E5E5E5"> and once we</font>

715
00:35:10,690 --> 00:35:14,980
go back to simulating a<font color="#CCCCCC"> card the field</font>

716
00:35:13,240 --> 00:35:18,098
is enabled<font color="#CCCCCC"> again</font><font color="#E5E5E5"> and then the log is</font>

717
00:35:14,980 --> 00:35:20,910
like oh there's a<font color="#CCCCCC"> new card</font><font color="#E5E5E5"> and simply</font>

718
00:35:18,099 --> 00:35:28,089
<font color="#E5E5E5">doing this in a loop we were able to try</font>

719
00:35:20,910 --> 00:35:29,980
multiple<font color="#E5E5E5"> cards in a row the speed wasn't</font>

720
00:35:28,089 --> 00:35:33,160
really that great we were able<font color="#CCCCCC"> to try</font>

721
00:35:29,980 --> 00:35:34,930
about<font color="#E5E5E5"> one card per second</font><font color="#CCCCCC"> and what this</font>

722
00:35:33,160 --> 00:35:37,149
<font color="#E5E5E5">means in</font><font color="#CCCCCC"> practice is that okay if you</font>

723
00:35:34,930 --> 00:35:39,190
have a 4-bit value<font color="#E5E5E5"> you can try all the</font>

724
00:35:37,150 --> 00:35:42,579
different<font color="#CCCCCC"> combinations in 16 seconds not</font>

725
00:35:39,190 --> 00:35:45,369
bad<font color="#CCCCCC"> if you go up to</font><font color="#E5E5E5"> 16 bits it already</font>

726
00:35:42,579 --> 00:35:46,390
<font color="#E5E5E5">takes 18 hours and if you have more than</font>

727
00:35:45,369 --> 00:35:50,710
16 bits

728
00:35:46,390 --> 00:35:54,400
I mean it's game<font color="#CCCCCC"> older it's doable</font>

729
00:35:50,710 --> 00:35:56,380
<font color="#E5E5E5">theoretically but not in practice so</font>

730
00:35:54,400 --> 00:36:00,569
<font color="#E5E5E5">even though we were</font><font color="#CCCCCC"> able to prove foster</font>

731
00:35:56,380 --> 00:36:00,569
values<font color="#CCCCCC"> it still wasn't</font><font color="#E5E5E5"> good enough</font><font color="#CCCCCC"> so</font>

732
00:36:01,109 --> 00:36:06,308
<font color="#CCCCCC">going</font><font color="#E5E5E5"> back with that so at this point</font>

733
00:36:04,240 --> 00:36:08,890
<font color="#E5E5E5">many of you might be wondering like okay</font>

734
00:36:06,309 --> 00:36:12,099
why do you guys didn't reverse engineer

735
00:36:08,890 --> 00:36:12,759
the thing to death and then went on with

736
00:36:12,099 --> 00:36:16,510
<font color="#CCCCCC">that</font>

737
00:36:12,760 --> 00:36:19,660
it's the<font color="#E5E5E5"> reason the answer is quite</font>

738
00:36:16,510 --> 00:36:23,890
<font color="#E5E5E5">simple</font><font color="#CCCCCC"> it would not have helped so all</font>

739
00:36:19,660 --> 00:36:26,700
these installations<font color="#CCCCCC"> are unique</font><font color="#E5E5E5"> so the</font>

740
00:36:23,890 --> 00:36:30,700
the values many of the<font color="#CCCCCC"> values get</font>

741
00:36:26,700 --> 00:36:34,118
deployed at the<font color="#E5E5E5"> install time and</font><font color="#CCCCCC"> we</font>

742
00:36:30,700 --> 00:36:38,589
realized this once we got<font color="#CCCCCC"> access to</font><font color="#E5E5E5"> that</font>

743
00:36:34,119 --> 00:36:41,890
master<font color="#CCCCCC"> key of a real valid</font><font color="#E5E5E5"> hotel so that</font>

744
00:36:38,589 --> 00:36:45,099
got<font color="#E5E5E5"> us thinking like okay so how does</font>

745
00:36:41,890 --> 00:36:47,470
<font color="#E5E5E5">this actually work</font><font color="#CCCCCC"> I mean we are to two</font>

746
00:36:45,099 --> 00:36:49,630
simple hillybillies but<font color="#E5E5E5"> I mean that</font>

747
00:36:47,470 --> 00:36:51,790
there has to be thousands of cars

748
00:36:49,630 --> 00:36:54,160
worldwide<font color="#E5E5E5"> who are installing these</font>

749
00:36:51,790 --> 00:36:58,119
systems and there has to be a process

750
00:36:54,160 --> 00:37:00,279
<font color="#CCCCCC">and with our</font><font color="#E5E5E5"> mad googling skills we were</font>

751
00:36:58,119 --> 00:37:00,810
<font color="#E5E5E5">able to find out that there is</font><font color="#CCCCCC"> a thing</font>

752
00:37:00,280 --> 00:37:04,230
<font color="#CCCCCC">called</font>

753
00:37:00,810 --> 00:37:07,170
Table University<font color="#E5E5E5"> and while we didn't</font>

754
00:37:04,230 --> 00:37:09,510
break<font color="#E5E5E5"> into that website</font><font color="#CCCCCC"> we figured out</font>

755
00:37:07,170 --> 00:37:12,150
<font color="#CCCCCC">that there has to be a process</font><font color="#E5E5E5"> how you</font>

756
00:37:09,510 --> 00:37:15,810
deploy these cars how you deploy these

757
00:37:12,150 --> 00:37:19,170
systems how you<font color="#E5E5E5"> install this and because</font>

758
00:37:15,810 --> 00:37:21,750
<font color="#CCCCCC">we had a bunch of</font><font color="#E5E5E5"> cards from all</font><font color="#CCCCCC"> around</font>

759
00:37:19,170 --> 00:37:24,330
<font color="#E5E5E5">the</font><font color="#CCCCCC"> world and we had dumped all those</font>

760
00:37:21,750 --> 00:37:26,700
<font color="#E5E5E5">cards we were able</font><font color="#CCCCCC"> to do analysis</font><font color="#E5E5E5"> on</font>

761
00:37:24,330 --> 00:37:30,450
<font color="#E5E5E5">those cards and then go back</font><font color="#CCCCCC"> to the</font>

762
00:37:26,700 --> 00:37:32,060
drawing<font color="#E5E5E5"> board and figure out that yes we</font>

763
00:37:30,450 --> 00:37:35,189
can<font color="#E5E5E5"> there is actually a process</font>

764
00:37:32,060 --> 00:37:38,040
vulnerability that we can use in order

765
00:37:35,190 --> 00:37:40,920
to<font color="#CCCCCC"> reduce this key space</font><font color="#E5E5E5"> so instead of</font>

766
00:37:38,040 --> 00:37:43,230
having gazillion bits to go through we

767
00:37:40,920 --> 00:37:45,180
were able<font color="#CCCCCC"> to narrow</font><font color="#E5E5E5"> it down to a point</font>

768
00:37:43,230 --> 00:37:48,900
where the<font color="#E5E5E5"> brute-forcing only takes about</font>

769
00:37:45,180 --> 00:37:57,270
<font color="#CCCCCC">ten to ten to twenty seconds</font><font color="#E5E5E5"> and this</font><font color="#CCCCCC"> is</font>

770
00:37:48,900 --> 00:37:59,430
how it looks<font color="#E5E5E5"> like so victim checks into</font>

771
00:37:57,270 --> 00:38:03,060
a hotel<font color="#CCCCCC"> I think that you have</font><font color="#E5E5E5"> done</font>

772
00:37:59,430 --> 00:38:09,870
multiple times<font color="#E5E5E5"> leaves a</font><font color="#CCCCCC"> record</font><font color="#E5E5E5"> on the</font>

773
00:38:03,060 --> 00:38:12,180
table by accident<font color="#CCCCCC"> and for us it takes</font>

774
00:38:09,870 --> 00:38:14,970
about with proxmark it takes about<font color="#CCCCCC"> half</font>

775
00:38:12,180 --> 00:38:19,350
a second to clone a card and then we can

776
00:38:14,970 --> 00:38:22,410
pick any lock in that hotel and fine as

777
00:38:19,350 --> 00:38:26,610
<font color="#CCCCCC">long as needed to find the master key</font>

778
00:38:22,410 --> 00:38:29,100
<font color="#E5E5E5">and to prove that we actually</font><font color="#CCCCCC"> were</font><font color="#E5E5E5"> able</font>

779
00:38:26,610 --> 00:38:32,340
to create<font color="#E5E5E5"> the master key</font><font color="#CCCCCC"> if you push</font>

780
00:38:29,100 --> 00:38:35,310
those elevator buttons without<font color="#E5E5E5"> the</font>

781
00:38:32,340 --> 00:38:38,730
proper key<font color="#E5E5E5"> they will just go back</font><font color="#CCCCCC"> to the</font>

782
00:38:35,310 --> 00:38:41,580
<font color="#CCCCCC">daemon</font><font color="#E5E5E5"> state and if you enable our</font><font color="#CCCCCC"> user</font>

783
00:38:38,730 --> 00:38:44,130
<font color="#E5E5E5">master</font><font color="#CCCCCC"> key you're</font><font color="#E5E5E5"> able to go to any</font>

784
00:38:41,580 --> 00:38:46,350
floor<font color="#E5E5E5"> which means that you have we</font>

785
00:38:44,130 --> 00:38:48,660
actually<font color="#E5E5E5"> were able to create</font><font color="#CCCCCC"> a master</font>

786
00:38:46,350 --> 00:38:56,819
key<font color="#E5E5E5"> and by doing these we were able</font><font color="#CCCCCC"> to</font>

787
00:38:48,660 --> 00:39:00,899
do<font color="#E5E5E5"> with me Don breaking off so the title</font>

788
00:38:56,820 --> 00:39:03,000
<font color="#E5E5E5">of the talk is something to do with</font>

789
00:39:00,900 --> 00:39:07,650
ghosts right<font color="#E5E5E5"> goes</font><font color="#CCCCCC"> to no walks</font>

790
00:39:03,000 --> 00:39:12,390
<font color="#E5E5E5">so what does it mean how do you become a</font>

791
00:39:07,650 --> 00:39:14,340
ghost<font color="#CCCCCC"> so you have the access tokens</font><font color="#E5E5E5"> you</font>

792
00:39:12,390 --> 00:39:19,290
have the electronic<font color="#CCCCCC"> clock</font>

793
00:39:14,340 --> 00:39:21,750
and if we're looking at<font color="#E5E5E5"> this lock this</font>

794
00:39:19,290 --> 00:39:25,110
device like<font color="#CCCCCC"> I mentioned earlier it's a</font>

795
00:39:21,750 --> 00:39:27,060
standalone<font color="#E5E5E5"> device it collects some data</font>

796
00:39:25,110 --> 00:39:29,010
<font color="#E5E5E5">when you're using it but it's pretty</font>

797
00:39:27,060 --> 00:39:31,950
dumb it doesn't really<font color="#E5E5E5"> communicate with</font>

798
00:39:29,010 --> 00:39:35,100
anything else<font color="#CCCCCC"> on the card so this walk</font>

799
00:39:31,950 --> 00:39:38,520
is<font color="#E5E5E5"> actually programmed when you use</font><font color="#CCCCCC"> your</font>

800
00:39:35,100 --> 00:39:42,900
card<font color="#E5E5E5"> that card progress programs to</font><font color="#CCCCCC"> lock</font>

801
00:39:38,520 --> 00:39:46,800
<font color="#E5E5E5">every time so what would</font><font color="#CCCCCC"> it require</font><font color="#E5E5E5"> to</font>

802
00:39:42,900 --> 00:39:51,030
<font color="#E5E5E5">see this attack or do forensics on this</font>

803
00:39:46,800 --> 00:39:55,200
that<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> do</font><font color="#CCCCCC"> to prove</font><font color="#E5E5E5"> that it was these</font>

804
00:39:51,030 --> 00:39:58,500
two<font color="#CCCCCC"> hillbillies doing the attack so it</font>

805
00:39:55,200 --> 00:40:01,290
first of all what we can do that<font color="#E5E5E5"> there</font>

806
00:39:58,500 --> 00:40:03,840
<font color="#E5E5E5">are those three phases there is the one</font>

807
00:40:01,290 --> 00:40:06,540
where<font color="#CCCCCC"> we clone the token or use</font><font color="#E5E5E5"> our own</font>

808
00:40:03,840 --> 00:40:09,600
card<font color="#E5E5E5"> or expired key guard</font><font color="#CCCCCC"> it doesn't</font>

809
00:40:06,540 --> 00:40:11,850
matter if any card<font color="#E5E5E5"> from</font><font color="#CCCCCC"> that facility</font>

810
00:40:09,600 --> 00:40:16,080
<font color="#CCCCCC">will do</font><font color="#E5E5E5"> it doesn't have to work</font><font color="#CCCCCC"> even</font>

811
00:40:11,850 --> 00:40:18,509
<font color="#E5E5E5">anymore and then we clone that card and</font>

812
00:40:16,080 --> 00:40:21,509
then we use proxmark<font color="#E5E5E5"> to generate all</font>

813
00:40:18,510 --> 00:40:24,510
those possible values and then test run

814
00:40:21,510 --> 00:40:27,750
the<font color="#E5E5E5"> test cases against a lock we can do</font>

815
00:40:24,510 --> 00:40:30,330
that against a single<font color="#E5E5E5"> lock so let's say</font>

816
00:40:27,750 --> 00:40:32,760
<font color="#CCCCCC">that we find a storage</font><font color="#E5E5E5"> room we just go</font>

817
00:40:30,330 --> 00:40:35,880
there<font color="#E5E5E5"> and brute force</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> against</font><font color="#CCCCCC"> that or</font>

818
00:40:32,760 --> 00:40:38,700
the garage<font color="#E5E5E5"> door or we can</font><font color="#CCCCCC"> distribute it</font>

819
00:40:35,880 --> 00:40:41,880
across multiple<font color="#E5E5E5"> locks so</font><font color="#CCCCCC"> you have one</font>

820
00:40:38,700 --> 00:40:44,310
corridor<font color="#E5E5E5"> full</font><font color="#CCCCCC"> of books we can try</font><font color="#E5E5E5"> for</font>

821
00:40:41,880 --> 00:40:49,890
<font color="#CCCCCC">each and every lock we</font><font color="#E5E5E5"> can try it only</font>

822
00:40:44,310 --> 00:40:53,779
once<font color="#CCCCCC"> and one with the block does it</font>

823
00:40:49,890 --> 00:40:56,819
records an audit trail if we look at the

824
00:40:53,780 --> 00:41:00,060
specification if the most advanced<font color="#CCCCCC"> walk</font>

825
00:40:56,820 --> 00:41:05,460
types<font color="#E5E5E5"> have 600 events</font>

826
00:41:00,060 --> 00:41:08,670
stored on<font color="#CCCCCC"> that lock and</font><font color="#E5E5E5"> the values</font><font color="#CCCCCC"> stay</font>

827
00:41:05,460 --> 00:41:11,970
<font color="#E5E5E5">stored there</font><font color="#CCCCCC"> our user ID code issue area</font>

828
00:41:08,670 --> 00:41:15,450
code<font color="#E5E5E5"> time of the event and then few bits</font>

829
00:41:11,970 --> 00:41:19,500
that are most of them<font color="#E5E5E5"> confess specific</font>

830
00:41:15,450 --> 00:41:21,990
so you<font color="#CCCCCC"> can decide that that</font><font color="#E5E5E5"> this</font>

831
00:41:19,500 --> 00:41:24,330
override<font color="#CCCCCC"> function actually</font><font color="#E5E5E5"> means that if</font>

832
00:41:21,990 --> 00:41:27,660
you lock the door

833
00:41:24,330 --> 00:41:29,819
from inside physically<font color="#E5E5E5"> is the maid</font>

834
00:41:27,660 --> 00:41:32,940
<font color="#E5E5E5">allowed to</font><font color="#CCCCCC"> overwrite</font><font color="#E5E5E5"> that with the</font>

835
00:41:29,820 --> 00:41:35,870
electronic key card or the<font color="#E5E5E5"> override</font><font color="#CCCCCC"> the</font>

836
00:41:32,940 --> 00:41:39,510
electronic lock with with her key card

837
00:41:35,870 --> 00:41:42,720
<font color="#E5E5E5">so those type of things</font><font color="#CCCCCC"> the problem here</font>

838
00:41:39,510 --> 00:41:47,190
<font color="#E5E5E5">that</font><font color="#CCCCCC"> the only field that the attacker</font>

839
00:41:42,720 --> 00:41:49,529
does not control is a<font color="#CCCCCC"> timestamp so we</font>

840
00:41:47,190 --> 00:41:52,530
can we have multiple options here we can

841
00:41:49,530 --> 00:41:55,140
either<font color="#E5E5E5"> right there so much data</font><font color="#CCCCCC"> that the</font>

842
00:41:52,530 --> 00:41:57,570
buffer overflows and it's just filled

843
00:41:55,140 --> 00:42:00,839
with meaningless junk<font color="#E5E5E5"> or we can forge</font>

844
00:41:57,570 --> 00:42:04,380
<font color="#E5E5E5">the data to contain any type</font><font color="#CCCCCC"> of actions</font>

845
00:42:00,840 --> 00:42:07,470
we<font color="#CCCCCC"> can frame the hotel owner</font><font color="#E5E5E5"> or anybody</font>

846
00:42:04,380 --> 00:42:11,930
that<font color="#CCCCCC"> they have done actions on that</font><font color="#E5E5E5"> door</font>

847
00:42:07,470 --> 00:42:15,870
lock or even if we wouldn't do anything

848
00:42:11,930 --> 00:42:17,730
<font color="#E5E5E5">what it would</font><font color="#CCCCCC"> require is that remember</font>

849
00:42:15,870 --> 00:42:21,779
<font color="#E5E5E5">these beautiful</font><font color="#CCCCCC"> most small piece of</font>

850
00:42:17,730 --> 00:42:24,510
device<font color="#E5E5E5"> in order</font><font color="#CCCCCC"> to get access</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> that</font>

851
00:42:21,780 --> 00:42:27,240
audit trail<font color="#CCCCCC"> you need to physically walk</font>

852
00:42:24,510 --> 00:42:29,490
to each and every lock and collect the

853
00:42:27,240 --> 00:42:33,000
<font color="#E5E5E5">data from there and then do analysis on</font>

854
00:42:29,490 --> 00:42:37,589
<font color="#E5E5E5">it based on</font><font color="#CCCCCC"> everything that</font><font color="#E5E5E5"> we have seen</font>

855
00:42:33,000 --> 00:42:40,860
<font color="#E5E5E5">it's not going to happen</font><font color="#CCCCCC"> so it's it's</font>

856
00:42:37,590 --> 00:42:44,070
<font color="#E5E5E5">basically impossible to do any sort of</font>

857
00:42:40,860 --> 00:42:46,740
reliable<font color="#E5E5E5"> forensic to the any of these</font>

858
00:42:44,070 --> 00:42:51,300
logs when the<font color="#CCCCCC"> only</font><font color="#E5E5E5"> thing you have is</font>

859
00:42:46,740 --> 00:42:57,060
<font color="#CCCCCC">probably a</font><font color="#E5E5E5"> timestamp</font><font color="#CCCCCC"> so that's how you</font>

860
00:42:51,300 --> 00:43:02,190
become a ghost and at this point the

861
00:42:57,060 --> 00:43:09,320
only<font color="#E5E5E5"> thing</font><font color="#CCCCCC"> left was like a post</font><font color="#E5E5E5"> like a</font>

862
00:43:02,190 --> 00:43:09,320
<font color="#E5E5E5">moss some of you might have</font>

863
00:43:10,700 --> 00:43:15,480
some of you might<font color="#CCCCCC"> recognize</font><font color="#E5E5E5"> this fine</font>

864
00:43:13,590 --> 00:43:18,690
<font color="#E5E5E5">gentleman</font><font color="#CCCCCC"> Charlie Miller</font><font color="#E5E5E5"> and Chris</font>

865
00:43:15,480 --> 00:43:23,520
<font color="#CCCCCC">valasek oh there's one more thing</font>

866
00:43:18,690 --> 00:43:25,110
so remember when I briefly<font color="#CCCCCC"> mentioned</font>

867
00:43:23,520 --> 00:43:29,850
that there is<font color="#E5E5E5"> also this back-end</font>

868
00:43:25,110 --> 00:43:32,820
component so if you were to hire a

869
00:43:29,850 --> 00:43:34,799
professional pentesting company or a

870
00:43:32,820 --> 00:43:37,500
<font color="#E5E5E5">company</font><font color="#CCCCCC"> that does any sort of</font>

871
00:43:34,800 --> 00:43:41,040
<font color="#CCCCCC">application level assessments or host</font>

872
00:43:37,500 --> 00:43:42,720
reviews<font color="#E5E5E5"> or that kind</font><font color="#CCCCCC"> of things</font><font color="#E5E5E5"> this is</font>

873
00:43:41,040 --> 00:43:45,570
<font color="#E5E5E5">the thing</font><font color="#CCCCCC"> that they would do first</font><font color="#E5E5E5"> and</font>

874
00:43:42,720 --> 00:43:48,480
this<font color="#E5E5E5"> is also what we</font><font color="#CCCCCC"> did kind</font><font color="#E5E5E5"> of first</font>

875
00:43:45,570 --> 00:43:50,970
so we had this idea<font color="#CCCCCC"> that</font><font color="#E5E5E5"> okay let's look</font>

876
00:43:48,480 --> 00:43:53,640
<font color="#E5E5E5">at</font><font color="#CCCCCC"> the scenarios where we</font><font color="#E5E5E5"> were we would</font>

877
00:43:50,970 --> 00:43:56,640
compromise<font color="#E5E5E5"> a single device at the</font>

878
00:43:53,640 --> 00:43:58,589
reception<font color="#CCCCCC"> or we would</font><font color="#E5E5E5"> take a look at the</font>

879
00:43:56,640 --> 00:44:01,560
<font color="#CCCCCC">backend like if we can access it</font>

880
00:43:58,590 --> 00:44:03,660
<font color="#E5E5E5">remotely</font><font color="#CCCCCC"> so the plan</font><font color="#E5E5E5"> was that we will</font>

881
00:44:01,560 --> 00:44:06,870
once again reverse engineer the software

882
00:44:03,660 --> 00:44:09,629
to death and then to see if we can post

883
00:44:06,870 --> 00:44:11,609
even<font color="#E5E5E5"> more so this is how it looks like</font>

884
00:44:09,630 --> 00:44:15,660
it<font color="#CCCCCC"> looks solid</font><font color="#E5E5E5"> piece</font><font color="#CCCCCC"> of engineering</font>

885
00:44:11,610 --> 00:44:17,610
<font color="#E5E5E5">right</font><font color="#CCCCCC"> Norwegian style</font><font color="#E5E5E5"> and the first</font>

886
00:44:15,660 --> 00:44:19,500
thing<font color="#CCCCCC"> that we did was that we based on</font>

887
00:44:17,610 --> 00:44:22,170
<font color="#E5E5E5">the</font><font color="#CCCCCC"> manual we were able to find out that</font>

888
00:44:19,500 --> 00:44:26,360
<font color="#CCCCCC">these guys are</font><font color="#E5E5E5"> actually using remote</font>

889
00:44:22,170 --> 00:44:29,430
sharing so standard<font color="#CCCCCC"> Windows networking</font>

890
00:44:26,360 --> 00:44:32,280
<font color="#CCCCCC">back in the day I accidentally reversed</font>

891
00:44:29,430 --> 00:44:34,950
<font color="#CCCCCC">their whole SMB safe stack so I knew I</font>

892
00:44:32,280 --> 00:44:37,290
know a thing or<font color="#E5E5E5"> two about the</font><font color="#CCCCCC"> Windows</font>

893
00:44:34,950 --> 00:44:39,210
networking<font color="#E5E5E5"> stuff but it proved out to be</font>

894
00:44:37,290 --> 00:44:42,930
useless in this case so<font color="#E5E5E5"> you couldn't</font>

895
00:44:39,210 --> 00:44:45,330
<font color="#E5E5E5">really access this remotely and we tried</font>

896
00:44:42,930 --> 00:44:47,640
<font color="#E5E5E5">it and yes if you're in the same network</font>

897
00:44:45,330 --> 00:44:49,830
<font color="#CCCCCC">there</font><font color="#E5E5E5"> is a there</font><font color="#CCCCCC"> is a chance that you</font>

898
00:44:47,640 --> 00:44:52,379
might be<font color="#CCCCCC"> able</font><font color="#E5E5E5"> to access it but it was</font>

899
00:44:49,830 --> 00:44:54,779
<font color="#E5E5E5">kind of a dead</font><font color="#CCCCCC"> end but then we looked</font><font color="#E5E5E5"> at</font>

900
00:44:52,380 --> 00:44:57,930
<font color="#E5E5E5">the database and it turns out</font><font color="#CCCCCC"> that</font>

901
00:44:54,780 --> 00:45:00,920
vision<font color="#E5E5E5"> is running</font><font color="#CCCCCC"> Sybase adaptive server</font>

902
00:44:57,930 --> 00:45:03,960
anywhere the<font color="#CCCCCC"> wizards on that port</font><font color="#E5E5E5"> and</font>

903
00:45:00,920 --> 00:45:07,980
the database passwords are derived from

904
00:45:03,960 --> 00:45:09,720
magic constants<font color="#E5E5E5"> so now if you</font><font color="#CCCCCC"> go back to</font>

905
00:45:07,980 --> 00:45:12,630
what I said earlier<font color="#CCCCCC"> all these</font>

906
00:45:09,720 --> 00:45:16,049
installations are custom so they change

907
00:45:12,630 --> 00:45:18,660
from one<font color="#CCCCCC"> installation to another</font><font color="#E5E5E5"> but</font>

908
00:45:16,050 --> 00:45:20,220
these are the default credentials so if

909
00:45:18,660 --> 00:45:23,149
you want to play with<font color="#E5E5E5"> the demo database</font>

910
00:45:20,220 --> 00:45:26,609
<font color="#E5E5E5">this gives you DBA level access</font>

911
00:45:23,150 --> 00:45:28,500
so we tried those out against the demo

912
00:45:26,610 --> 00:45:30,210
<font color="#CCCCCC">database and we got full system</font>

913
00:45:28,500 --> 00:45:33,810
<font color="#CCCCCC">compromised we were able to do whatever</font>

914
00:45:30,210 --> 00:45:36,660
<font color="#E5E5E5">the</font><font color="#CCCCCC"> only requirement was that we need to</font>

915
00:45:33,810 --> 00:45:38,910
be physically<font color="#E5E5E5"> in the same</font><font color="#CCCCCC"> network and by</font>

916
00:45:36,660 --> 00:45:42,810
physically I mean<font color="#CCCCCC"> as long as the Wi-Fi</font>

917
00:45:38,910 --> 00:45:44,640
antenna carries us so we dumped the

918
00:45:42,810 --> 00:45:46,650
<font color="#CCCCCC">whole database scheme and found some</font>

919
00:45:44,640 --> 00:45:49,319
really really interesting<font color="#CCCCCC"> information</font>

920
00:45:46,650 --> 00:45:55,140
there for<font color="#CCCCCC"> example you have employee data</font>

921
00:45:49,320 --> 00:45:57,150
there so this hack allows us to I mean

922
00:45:55,140 --> 00:45:59,400
<font color="#CCCCCC">that what was not</font><font color="#E5E5E5"> mentioned earlier yes</font>

923
00:45:57,150 --> 00:46:01,830
we were<font color="#E5E5E5"> able to emulate all the guests</font>

924
00:45:59,400 --> 00:46:04,440
<font color="#E5E5E5">but we are also able to emulate</font><font color="#CCCCCC"> all the</font>

925
00:46:01,830 --> 00:46:08,310
employee key cards<font color="#E5E5E5"> so we can emulate</font>

926
00:46:04,440 --> 00:46:10,890
<font color="#E5E5E5">anybody</font><font color="#CCCCCC"> orson or impersonate anybody</font><font color="#E5E5E5"> so</font>

927
00:46:08,310 --> 00:46:14,610
it<font color="#CCCCCC"> gives</font><font color="#E5E5E5"> us access to the employee</font>

928
00:46:10,890 --> 00:46:18,540
roster<font color="#E5E5E5"> but also to all the guest data</font>

929
00:46:14,610 --> 00:46:21,030
that the hotel has and we recognized

930
00:46:18,540 --> 00:46:24,150
that and this<font color="#E5E5E5"> is how</font><font color="#CCCCCC"> it looks</font><font color="#E5E5E5"> like we</font>

931
00:46:21,030 --> 00:46:26,430
just<font color="#CCCCCC"> get access the only requirement is</font>

932
00:46:24,150 --> 00:46:29,040
that<font color="#CCCCCC"> we</font><font color="#E5E5E5"> need to have an access to</font><font color="#CCCCCC"> the</font>

933
00:46:26,430 --> 00:46:32,569
same<font color="#CCCCCC"> network and then we can dump all</font>

934
00:46:29,040 --> 00:46:36,570
the customers and their respective

935
00:46:32,570 --> 00:46:39,180
<font color="#E5E5E5">bitstream from their data so we just</font>

936
00:46:36,570 --> 00:46:41,580
<font color="#CCCCCC">copy/paste those values</font><font color="#E5E5E5"> put them into a</font>

937
00:46:39,180 --> 00:46:44,129
card or emulate them with proxmark<font color="#E5E5E5"> and</font>

938
00:46:41,580 --> 00:46:50,360
we we<font color="#CCCCCC"> can again impersonate anybody in</font>

939
00:46:44,130 --> 00:46:50,360
<font color="#CCCCCC">that hotel</font><font color="#E5E5E5"> greetings today</font><font color="#CCCCCC"> vidal so</font>

940
00:46:57,040 --> 00:47:08,720
so conclusions<font color="#E5E5E5"> if you're not smart you</font>

941
00:47:04,280 --> 00:47:11,870
<font color="#CCCCCC">have to be persistent</font><font color="#E5E5E5"> it took us 15</font>

942
00:47:08,720 --> 00:47:14,990
<font color="#CCCCCC">years of on-and-off research during this</font>

943
00:47:11,870 --> 00:47:18,230
so some other people they play soccer<font color="#CCCCCC"> or</font>

944
00:47:14,990 --> 00:47:20,660
do some<font color="#E5E5E5"> other stupid</font><font color="#CCCCCC"> stuff</font><font color="#E5E5E5"> for us it's</font>

945
00:47:18,230 --> 00:47:24,320
<font color="#E5E5E5">been this and few other projects we</font>

946
00:47:20,660 --> 00:47:26,149
don't claim<font color="#E5E5E5"> that</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> is unique</font><font color="#CCCCCC"> I mean</font>

947
00:47:24,320 --> 00:47:28,700
most probably most<font color="#E5E5E5"> of you would</font><font color="#CCCCCC"> be able</font>

948
00:47:26,150 --> 00:47:32,720
<font color="#E5E5E5">to do this just</font><font color="#CCCCCC"> even a few months of</font>

949
00:47:28,700 --> 00:47:37,549
active research<font color="#E5E5E5"> this was</font><font color="#CCCCCC"> a fun project</font>

950
00:47:32,720 --> 00:47:40,009
<font color="#CCCCCC">and we learned a lot</font><font color="#E5E5E5"> by doing this one</font>

951
00:47:37,550 --> 00:47:42,950
<font color="#E5E5E5">of the main takeaways was that doing</font>

952
00:47:40,010 --> 00:47:47,240
physical access controls<font color="#E5E5E5"> control systems</font>

953
00:47:42,950 --> 00:47:49,730
securely<font color="#E5E5E5"> is super difficult you have</font><font color="#CCCCCC"> to</font>

954
00:47:47,240 --> 00:47:51,560
<font color="#CCCCCC">get the</font><font color="#E5E5E5"> mechanics right you have to get</font>

955
00:47:49,730 --> 00:47:52,910
the signaling right you have to

956
00:47:51,560 --> 00:47:55,220
understand something<font color="#CCCCCC"> about</font>

957
00:47:52,910 --> 00:47:57,950
software-defined radio or<font color="#E5E5E5"> RFID</font>

958
00:47:55,220 --> 00:48:00,770
communications in general<font color="#E5E5E5"> you</font><font color="#CCCCCC"> have</font><font color="#E5E5E5"> to be</font>

959
00:47:57,950 --> 00:48:03,740
good at software engineer and<font color="#E5E5E5"> you need</font>

960
00:48:00,770 --> 00:48:06,050
to have a solid<font color="#CCCCCC"> SDLC processes in</font><font color="#E5E5E5"> place</font>

961
00:48:03,740 --> 00:48:10,879
and<font color="#CCCCCC"> and so on the list</font><font color="#E5E5E5"> goes on</font><font color="#CCCCCC"> and on</font>

962
00:48:06,050 --> 00:48:14,150
and<font color="#CCCCCC"> on</font><font color="#E5E5E5"> and it is super challenging to do</font>

963
00:48:10,880 --> 00:48:16,970
with right<font color="#E5E5E5"> there is this old wisdom that</font>

964
00:48:14,150 --> 00:48:19,310
the attacker<font color="#E5E5E5"> only needs to succeed once</font>

965
00:48:16,970 --> 00:48:22,879
and the defender<font color="#CCCCCC"> has to succeed</font><font color="#E5E5E5"> all the</font>

966
00:48:19,310 --> 00:48:25,940
time we don't<font color="#E5E5E5"> really</font><font color="#CCCCCC"> believe in that</font><font color="#E5E5E5"> but</font>

967
00:48:22,880 --> 00:48:29,270
it is<font color="#E5E5E5"> difficult to do this</font><font color="#CCCCCC"> properly</font>

968
00:48:25,940 --> 00:48:32,150
<font color="#CCCCCC">because</font><font color="#E5E5E5"> effectively old it also requires</font>

969
00:48:29,270 --> 00:48:34,940
a seamless cooperation<font color="#CCCCCC"> between all the</font>

970
00:48:32,150 --> 00:48:37,760
<font color="#E5E5E5">people are who</font><font color="#CCCCCC"> are part</font><font color="#E5E5E5"> of the product</font>

971
00:48:34,940 --> 00:48:39,740
development development process<font color="#CCCCCC"> so it is</font>

972
00:48:37,760 --> 00:48:42,530
a challenging<font color="#CCCCCC"> thing to do</font><font color="#E5E5E5"> properly</font><font color="#CCCCCC"> I</font>

973
00:48:39,740 --> 00:48:44,959
would<font color="#E5E5E5"> like to thank as a boy</font><font color="#CCCCCC"> they</font>

974
00:48:42,530 --> 00:48:47,810
treated us with<font color="#CCCCCC"> respect</font><font color="#E5E5E5"> when we reported</font>

975
00:48:44,960 --> 00:48:50,300
this to<font color="#E5E5E5"> them they took this very very</font>

976
00:48:47,810 --> 00:48:52,130
<font color="#E5E5E5">seriously</font><font color="#CCCCCC"> the first meeting we had was</font>

977
00:48:50,300 --> 00:48:54,410
with their CTO and their head of

978
00:48:52,130 --> 00:48:55,310
engineering<font color="#E5E5E5"> and we been cooperating with</font>

979
00:48:54,410 --> 00:48:58,040
them ever since

980
00:48:55,310 --> 00:49:02,690
and most<font color="#CCCCCC"> probably if you go there you</font>

981
00:48:58,040 --> 00:49:04,670
<font color="#E5E5E5">will you will</font><font color="#CCCCCC"> see more</font><font color="#E5E5E5"> about what</font>

982
00:49:02,690 --> 00:49:07,070
they've<font color="#E5E5E5"> been</font><font color="#CCCCCC"> doing about</font><font color="#E5E5E5"> this we are</font>

983
00:49:04,670 --> 00:49:09,370
also happy to report<font color="#E5E5E5"> that this hotel</font><font color="#CCCCCC"> is</font>

984
00:49:07,070 --> 00:49:09,370
patched

985
00:49:10,240 --> 00:49:15,319
so<font color="#E5E5E5"> well done organizers have thanks for</font>

986
00:49:13,790 --> 00:49:18,200
letting the<font color="#CCCCCC"> hotel</font><font color="#E5E5E5"> management to know</font>

987
00:49:15,320 --> 00:49:20,600
most probably<font color="#CCCCCC"> and we would also like to</font>

988
00:49:18,200 --> 00:49:25,009
give give some shoutouts to our good

989
00:49:20,600 --> 00:49:27,230
friends<font color="#CCCCCC"> we we would not have been able</font>

990
00:49:25,010 --> 00:49:31,310
<font color="#CCCCCC">to do this without help from from our</font>

991
00:49:27,230 --> 00:49:33,140
friends we'd really like<font color="#CCCCCC"> to give a big</font>

992
00:49:31,310 --> 00:49:35,990
hand to the<font color="#E5E5E5"> whole hacking</font><font color="#CCCCCC"> community</font>

993
00:49:33,140 --> 00:49:38,060
because<font color="#E5E5E5"> lately it's been too much</font>

994
00:49:35,990 --> 00:49:41,359
<font color="#CCCCCC">InfoSec drama and look too little</font>

995
00:49:38,060 --> 00:49:51,200
<font color="#CCCCCC">hacking</font><font color="#E5E5E5"> so we would like</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> get</font><font color="#CCCCCC"> back to</font>

996
00:49:41,360 --> 00:49:55,010
old<font color="#E5E5E5"> school so thank you any questions</font>

997
00:49:51,200 --> 00:49:57,859
from the<font color="#CCCCCC"> floor we'll take questions</font>

998
00:49:55,010 --> 00:50:00,020
<font color="#E5E5E5">offstage</font><font color="#CCCCCC"> then yeah thank you very</font><font color="#E5E5E5"> much</font>

999
00:49:57,860 --> 00:50:01,940
<font color="#E5E5E5">Tommy and TiVo</font><font color="#CCCCCC"> that was a very</font>

1000
00:50:00,020 --> 00:50:03,650
entertaining<font color="#E5E5E5"> and</font><font color="#CCCCCC"> very informative talk</font>

1001
00:50:01,940 --> 00:50:05,300
<font color="#E5E5E5">thank you good to</font><font color="#CCCCCC"> know that we're all</font>

1002
00:50:03,650 --> 00:50:06,950
<font color="#E5E5E5">safe everyone who slay is staying in</font>

1003
00:50:05,300 --> 00:50:09,790
this hotel<font color="#CCCCCC"> they're all in</font><font color="#E5E5E5"> good hands</font>

1004
00:50:06,950 --> 00:50:14,830
thank you<font color="#CCCCCC"> very</font><font color="#E5E5E5"> much thank you</font>

1005
00:50:09,790 --> 00:50:14,830
[Applause]

