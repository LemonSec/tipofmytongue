1
00:00:09,740 --> 00:00:17,160
thank you thank<font color="#E5E5E5"> you everybody and let's</font>

2
00:00:14,309 --> 00:00:22,220
speak about Wi-Fi<font color="#CCCCCC"> phishing and</font><font color="#E5E5E5"> red</font>

3
00:00:17,160 --> 00:00:25,530
teaming so usual introduction you can

4
00:00:22,220 --> 00:00:29,130
<font color="#E5E5E5">just see it later on</font><font color="#CCCCCC"> the slides it's not</font>

5
00:00:25,530 --> 00:00:31,770
important<font color="#CCCCCC"> so what</font><font color="#E5E5E5"> we are going</font><font color="#CCCCCC"> to speak</font>

6
00:00:29,130 --> 00:00:34,800
about<font color="#CCCCCC"> today</font><font color="#E5E5E5"> so I will give up very very</font>

7
00:00:31,770 --> 00:00:38,040
<font color="#E5E5E5">quick</font><font color="#CCCCCC"> introduction about</font><font color="#E5E5E5"> the topics then</font>

8
00:00:34,800 --> 00:00:42,720
we will speak<font color="#CCCCCC"> briefly about</font><font color="#E5E5E5"> what is WPA</font>

9
00:00:38,040 --> 00:00:46,019
and wpa2<font color="#CCCCCC"> Enterprise another very quick</font>

10
00:00:42,720 --> 00:00:46,589
introduction<font color="#CCCCCC"> about the</font><font color="#E5E5E5"> basic for WPA</font>

11
00:00:46,019 --> 00:00:51,479
enterprise

12
00:00:46,589 --> 00:00:53,100
<font color="#E5E5E5">aking and then what</font><font color="#CCCCCC"> knew about</font><font color="#E5E5E5"> this this</font>

13
00:00:51,479 --> 00:00:55,350
talk like actually it's not something

14
00:00:53,100 --> 00:00:57,900
<font color="#CCCCCC">very new</font><font color="#E5E5E5"> but these are something</font><font color="#CCCCCC"> that we</font>

15
00:00:55,350 --> 00:00:59,640
encountered in<font color="#CCCCCC"> a red teaming engagement</font>

16
00:00:57,900 --> 00:01:06,509
<font color="#E5E5E5">so I want to speak</font><font color="#CCCCCC"> about this</font><font color="#E5E5E5"> experience</font>

17
00:00:59,640 --> 00:01:09,810
<font color="#CCCCCC">so a quick note about</font><font color="#E5E5E5"> red teaming red</font>

18
00:01:06,510 --> 00:01:13,680
teaming usually as of as objective<font color="#E5E5E5"> not</font>

19
00:01:09,810 --> 00:01:16,320
to stress every defense mechanism that

20
00:01:13,680 --> 00:01:19,590
<font color="#CCCCCC">is in place to protect an</font><font color="#E5E5E5"> asset but</font>

21
00:01:16,320 --> 00:01:21,990
instead<font color="#CCCCCC"> is to obtain a goal or one of</font>

22
00:01:19,590 --> 00:01:24,810
these<font color="#CCCCCC"> asset so the difference</font><font color="#E5E5E5"> from</font><font color="#CCCCCC"> my</font>

23
00:01:21,990 --> 00:01:27,839
normal<font color="#E5E5E5"> assessment is that</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> don't I</font>

24
00:01:24,810 --> 00:01:30,060
don't<font color="#CCCCCC"> care</font><font color="#E5E5E5"> to stress all the physical</font>

25
00:01:27,840 --> 00:01:32,910
<font color="#CCCCCC">security stuff</font><font color="#E5E5E5"> cyber security and human</font>

26
00:01:30,060 --> 00:01:36,240
security<font color="#E5E5E5"> I'm only interested in getting</font>

27
00:01:32,910 --> 00:01:39,450
<font color="#CCCCCC">one</font><font color="#E5E5E5"> of the critical asset</font><font color="#CCCCCC"> that I have</font>

28
00:01:36,240 --> 00:01:41,460
<font color="#E5E5E5">the</font><font color="#CCCCCC"> goal this</font><font color="#E5E5E5"> is just a quick</font>

29
00:01:39,450 --> 00:01:46,010
<font color="#CCCCCC">introduction about</font><font color="#E5E5E5"> a red teaming</font>

30
00:01:41,460 --> 00:01:49,320
engagement so why are<font color="#E5E5E5"> we interested</font>

31
00:01:46,010 --> 00:01:52,020
during a red teaming engagement<font color="#E5E5E5"> on Wi-Fi</font>

32
00:01:49,320 --> 00:01:56,360
and specifically<font color="#CCCCCC"> enterprise Wi-Fi</font>

33
00:01:52,020 --> 00:01:59,220
networks because usually we<font color="#E5E5E5"> have</font>

34
00:01:56,360 --> 00:02:01,830
hundreds if<font color="#E5E5E5"> not thousands of</font><font color="#CCCCCC"> different</font>

35
00:01:59,220 --> 00:02:04,320
users and<font color="#CCCCCC"> each user</font><font color="#E5E5E5"> usually can choose</font>

36
00:02:01,830 --> 00:02:07,679
his own password<font color="#E5E5E5"> so it's very possible</font>

37
00:02:04,320 --> 00:02:10,619
<font color="#E5E5E5">to find a weak password to connect to</font>

38
00:02:07,680 --> 00:02:13,019
the enterprise<font color="#E5E5E5"> Wi-Fi network we can try</font>

39
00:02:10,619 --> 00:02:16,470
to reuse the credential for for<font color="#CCCCCC"> example</font>

40
00:02:13,019 --> 00:02:19,170
<font color="#CCCCCC">OWA in</font><font color="#E5E5E5"> access email access and</font><font color="#CCCCCC"> whatever</font>

41
00:02:16,470 --> 00:02:21,480
<font color="#E5E5E5">because often the authentication in</font>

42
00:02:19,170 --> 00:02:22,890
place is sort of single sign-on so we

43
00:02:21,480 --> 00:02:26,190
can use the<font color="#E5E5E5"> same credential for</font>

44
00:02:22,890 --> 00:02:27,899
<font color="#CCCCCC">being inside</font><font color="#E5E5E5"> the enterprise network that</font>

45
00:02:26,190 --> 00:02:29,940
<font color="#CCCCCC">also means that</font><font color="#E5E5E5"> we</font><font color="#CCCCCC"> can either</font><font color="#E5E5E5"> direct</font>

46
00:02:27,900 --> 00:02:32,130
access to the company<font color="#CCCCCC"> intranet network</font>

47
00:02:29,940 --> 00:02:35,490
and<font color="#E5E5E5"> that's very useful for</font><font color="#CCCCCC"> getting the</font>

48
00:02:32,130 --> 00:02:37,440
goal that<font color="#CCCCCC"> we spoke</font><font color="#E5E5E5"> before</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> moreover</font>

49
00:02:35,490 --> 00:02:39,870
since most of<font color="#E5E5E5"> the time we are speaking</font>

50
00:02:37,440 --> 00:02:41,910
about<font color="#E5E5E5"> windows-based</font><font color="#CCCCCC"> Network we</font><font color="#E5E5E5"> can also</font>

51
00:02:39,870 --> 00:02:44,220
launch a series<font color="#E5E5E5"> of other attacks on the</font>

52
00:02:41,910 --> 00:02:45,090
network that<font color="#CCCCCC"> we</font><font color="#E5E5E5"> all know like responder</font>

53
00:02:44,220 --> 00:02:48,989
and<font color="#E5E5E5"> it's kind</font><font color="#CCCCCC"> of fun</font>

54
00:02:45,090 --> 00:02:51,510
and finally usually<font color="#CCCCCC"> enterprise Wi-Fi</font>

55
00:02:48,989 --> 00:02:53,520
network also<font color="#E5E5E5"> provides us interred access</font>

56
00:02:51,510 --> 00:02:56,579
<font color="#E5E5E5">that</font><font color="#CCCCCC"> is also</font><font color="#E5E5E5"> very useful to exfiltrate</font>

57
00:02:53,520 --> 00:02:59,280
<font color="#E5E5E5">the data that we</font><font color="#CCCCCC"> are interested in so</font>

58
00:02:56,580 --> 00:03:01,980
that's<font color="#E5E5E5"> what makes</font><font color="#CCCCCC"> enterprise Wi-Fi a</font>

59
00:02:59,280 --> 00:03:03,959
very<font color="#CCCCCC"> interesting</font><font color="#E5E5E5"> point of entry during</font><font color="#CCCCCC"> a</font>

60
00:03:01,980 --> 00:03:05,970
red teaming engagement and the last

61
00:03:03,959 --> 00:03:08,400
thing that I<font color="#E5E5E5"> forgot to</font><font color="#CCCCCC"> put here is that</font>

62
00:03:05,970 --> 00:03:10,680
<font color="#E5E5E5">we can get this kind of access remote</font><font color="#CCCCCC"> I</font>

63
00:03:08,400 --> 00:03:17,310
mean I<font color="#E5E5E5"> don't have to get</font><font color="#CCCCCC"> inside the</font>

64
00:03:10,680 --> 00:03:23,400
facility usually so what's the security

65
00:03:17,310 --> 00:03:25,110
<font color="#E5E5E5">in WPA enterprise so WPA enterprise</font><font color="#CCCCCC"> -</font>

66
00:03:23,400 --> 00:03:27,360
<font color="#E5E5E5">poor dynamic delivery of master keys</font>

67
00:03:25,110 --> 00:03:28,829
that means that heavy user as his own

68
00:03:27,360 --> 00:03:31,980
password and<font color="#E5E5E5"> therefore his</font><font color="#CCCCCC"> own</font>

69
00:03:28,829 --> 00:03:34,860
encryption key<font color="#E5E5E5"> and so if even</font><font color="#CCCCCC"> if I know</font>

70
00:03:31,980 --> 00:03:37,790
<font color="#E5E5E5">the key to access</font><font color="#CCCCCC"> the network I cannot</font>

71
00:03:34,860 --> 00:03:42,150
decrypt the traffic of other users<font color="#CCCCCC"> the</font>

72
00:03:37,790 --> 00:03:44,040
<font color="#CCCCCC">authentication relies on the 802.1 X</font>

73
00:03:42,150 --> 00:03:47,250
authentication standard<font color="#E5E5E5"> that basically</font>

74
00:03:44,040 --> 00:03:49,769
gives me<font color="#CCCCCC"> our</font><font color="#E5E5E5"> array our framework in</font>

75
00:03:47,250 --> 00:03:52,560
<font color="#CCCCCC">which I can create my own</font><font color="#E5E5E5"> authentication</font>

76
00:03:49,769 --> 00:03:54,870
methods that are the EAP methods and

77
00:03:52,560 --> 00:04:01,010
that depends<font color="#E5E5E5"> on the infrastructure that</font>

78
00:03:54,870 --> 00:04:03,750
<font color="#E5E5E5">I want to build usually on open source</font>

79
00:04:01,010 --> 00:04:05,489
<font color="#E5E5E5">usually this kind of authentication is</font>

80
00:04:03,750 --> 00:04:07,950
based on<font color="#E5E5E5"> open source</font><font color="#CCCCCC"> software that</font><font color="#E5E5E5"> is</font>

81
00:04:05,489 --> 00:04:10,530
<font color="#E5E5E5">free radius or more recently or say PD</font>

82
00:04:07,950 --> 00:04:12,869
and this is also what we<font color="#E5E5E5"> use to attack</font>

83
00:04:10,530 --> 00:04:18,238
this network we will use a patch version

84
00:04:12,870 --> 00:04:22,979
<font color="#E5E5E5">of this kind of software so as I said we</font>

85
00:04:18,238 --> 00:04:25,950
have a lot<font color="#CCCCCC"> of different authentication</font>

86
00:04:22,979 --> 00:04:29,430
<font color="#E5E5E5">methods that we can develop using this</font>

87
00:04:25,950 --> 00:04:31,469
framework here but most of<font color="#CCCCCC"> the time the</font>

88
00:04:29,430 --> 00:04:33,570
<font color="#CCCCCC">idea is the following so when the client</font>

89
00:04:31,470 --> 00:04:34,950
<font color="#CCCCCC">gives the Authenticator and then we</font>

90
00:04:33,570 --> 00:04:36,248
<font color="#CCCCCC">videoed indication</font><font color="#E5E5E5"> server so the</font>

91
00:04:34,950 --> 00:04:39,099
Authenticator

92
00:04:36,249 --> 00:04:41,679
never stores the the keys<font color="#E5E5E5"> the secrets</font>

93
00:04:39,099 --> 00:04:44,739
from the password<font color="#E5E5E5"> so even</font><font color="#CCCCCC"> UVA</font><font color="#E5E5E5"> have a</font>

94
00:04:41,679 --> 00:04:46,989
vulnerability<font color="#E5E5E5"> inside our router we don't</font>

95
00:04:44,739 --> 00:04:47,589
have direct<font color="#CCCCCC"> access to the credentials of</font>

96
00:04:46,989 --> 00:04:51,068
the<font color="#E5E5E5"> user</font>

97
00:04:47,589 --> 00:04:53,259
he said<font color="#E5E5E5"> standard WPA personal the keys</font>

98
00:04:51,069 --> 00:04:55,079
or the password<font color="#E5E5E5"> to access the network is</font>

99
00:04:53,259 --> 00:04:57,969
stored inside<font color="#CCCCCC"> the router of course</font>

100
00:04:55,079 --> 00:04:59,559
because there's the router that<font color="#E5E5E5"> handle</font>

101
00:04:57,969 --> 00:05:01,239
the authentication in this case the<font color="#CCCCCC"> root</font>

102
00:04:59,559 --> 00:05:02,399
are only<font color="#E5E5E5"> handled the communication</font>

103
00:05:01,239 --> 00:05:04,419
between the<font color="#CCCCCC"> client</font><font color="#E5E5E5"> and the</font>

104
00:05:02,399 --> 00:05:09,779
<font color="#CCCCCC">authentication server it usually is</font>

105
00:05:04,419 --> 00:05:12,998
inside<font color="#E5E5E5"> the intranet or inside a network</font>

106
00:05:09,779 --> 00:05:16,119
so<font color="#E5E5E5"> we do request to authenticate then</font>

107
00:05:12,999 --> 00:05:18,279
the Authenticator forward<font color="#E5E5E5"> our request to</font>

108
00:05:16,119 --> 00:05:21,669
the radius server

109
00:05:18,279 --> 00:05:24,459
and then the radius server sent to the

110
00:05:21,669 --> 00:05:26,459
client<font color="#CCCCCC"> ok to authenticate me to use this</font>

111
00:05:24,459 --> 00:05:31,059
specific method that will be<font color="#E5E5E5"> see later</font>

112
00:05:26,459 --> 00:05:32,949
<font color="#E5E5E5">the client will do stuff like encrypting</font>

113
00:05:31,059 --> 00:05:37,209
the key and all these<font color="#E5E5E5"> kind of things</font>

114
00:05:32,949 --> 00:05:39,369
<font color="#E5E5E5">there is a and Shake in here and then if</font>

115
00:05:37,209 --> 00:05:41,919
the password<font color="#CCCCCC"> is correct</font><font color="#E5E5E5"> in the</font><font color="#CCCCCC"> encrypted</font>

116
00:05:39,369 --> 00:05:44,699
<font color="#E5E5E5">password is correct</font><font color="#CCCCCC"> the radio send an</font>

117
00:05:41,919 --> 00:05:47,498
acceptance packet<font color="#E5E5E5"> so there is another</font>

118
00:05:44,699 --> 00:05:49,569
<font color="#E5E5E5">difference between standard WPA and</font>

119
00:05:47,499 --> 00:05:52,869
<font color="#CCCCCC">enterprise</font><font color="#E5E5E5"> that the usually in</font>

120
00:05:49,569 --> 00:05:55,209
enterprise network we<font color="#CCCCCC"> also validate the</font>

121
00:05:52,869 --> 00:05:59,019
certificate of the<font color="#CCCCCC"> so at least of the</font>

122
00:05:55,209 --> 00:06:00,999
server so<font color="#E5E5E5"> that means that when I try to</font>

123
00:05:59,019 --> 00:06:04,059
connect<font color="#CCCCCC"> that</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> a new network</font><font color="#E5E5E5"> I</font><font color="#CCCCCC"> have</font><font color="#E5E5E5"> to</font>

124
00:06:00,999 --> 00:06:06,219
accept the certificate<font color="#CCCCCC"> that the server</font>

125
00:06:04,059 --> 00:06:08,589
is presenting and then I will<font color="#E5E5E5"> use this</font>

126
00:06:06,219 --> 00:06:11,619
certificate<font color="#E5E5E5"> to encapsulate and encrypt</font>

127
00:06:08,589 --> 00:06:15,659
my data<font color="#E5E5E5"> for the authentication and the</font>

128
00:06:11,619 --> 00:06:18,369
communication so these are some of the

129
00:06:15,659 --> 00:06:20,139
<font color="#CCCCCC">available methods that are the most</font>

130
00:06:18,369 --> 00:06:25,269
<font color="#E5E5E5">common one actually the most common</font><font color="#CCCCCC"> one</font>

131
00:06:20,139 --> 00:06:28,089
<font color="#CCCCCC">is probably PAP that is the small</font>

132
00:06:25,269 --> 00:06:31,029
standard that<font color="#CCCCCC"> windows</font><font color="#E5E5E5"> will use but also</font>

133
00:06:28,089 --> 00:06:35,499
EAP TLS<font color="#E5E5E5"> is quite it's not very common</font>

134
00:06:31,029 --> 00:06:37,058
<font color="#E5E5E5">because it requires one step that</font><font color="#CCCCCC"> is</font>

135
00:06:35,499 --> 00:06:38,889
really not<font color="#CCCCCC"> very</font><font color="#E5E5E5"> straightforward to</font>

136
00:06:37,059 --> 00:06:42,189
<font color="#CCCCCC">implement that is the certificate</font>

137
00:06:38,889 --> 00:06:44,829
<font color="#E5E5E5">installed inside of the clients so if I</font>

138
00:06:42,189 --> 00:06:46,539
want the server to<font color="#CCCCCC"> validate the clients</font>

139
00:06:44,829 --> 00:06:48,879
also<font color="#CCCCCC"> so to avoid me in the middle</font>

140
00:06:46,539 --> 00:06:50,110
attacks<font color="#CCCCCC"> I also need to</font><font color="#E5E5E5"> push my</font>

141
00:06:48,879 --> 00:06:52,270
certificate to all my

142
00:06:50,110 --> 00:06:54,700
<font color="#CCCCCC">clients</font><font color="#E5E5E5"> in order</font><font color="#CCCCCC"> to that for them to</font><font color="#E5E5E5"> be</font>

143
00:06:52,270 --> 00:06:57,549
able<font color="#CCCCCC"> to validate the server</font><font color="#E5E5E5"> so this is</font>

144
00:06:54,700 --> 00:07:03,039
the main issue here<font color="#E5E5E5"> and that's why P EAP</font>

145
00:06:57,550 --> 00:07:07,660
<font color="#CCCCCC">is the most used one at the moment so</font>

146
00:07:03,040 --> 00:07:09,940
what is<font color="#CCCCCC"> P aap</font><font color="#E5E5E5"> basically we have a pastor</font>

147
00:07:07,660 --> 00:07:11,680
<font color="#CCCCCC">bed password-based authentication for</font>

148
00:07:09,940 --> 00:07:14,200
the device and a certificate<font color="#E5E5E5"> based</font>

149
00:07:11,680 --> 00:07:16,140
authentication for the server the source

150
00:07:14,200 --> 00:07:17,920
for the clients to<font color="#E5E5E5"> verify the server</font>

151
00:07:16,140 --> 00:07:21,610
<font color="#CCCCCC">actually the password-based</font>

152
00:07:17,920 --> 00:07:23,490
<font color="#E5E5E5">authentication can also be implemented</font>

153
00:07:21,610 --> 00:07:26,710
with<font color="#CCCCCC"> the certificate or</font><font color="#E5E5E5"> smart cards</font>

154
00:07:23,490 --> 00:07:29,170
<font color="#E5E5E5">nowadays but you know when you speak</font>

155
00:07:26,710 --> 00:07:31,030
<font color="#E5E5E5">into Wi-Fi network most of the time we</font>

156
00:07:29,170 --> 00:07:32,800
<font color="#E5E5E5">only</font><font color="#CCCCCC"> had</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> password because</font><font color="#E5E5E5"> I want to</font>

157
00:07:31,030 --> 00:07:36,400
be able<font color="#E5E5E5"> to access also from my mobile</font>

158
00:07:32,800 --> 00:07:38,020
phone<font color="#CCCCCC"> etc this</font><font color="#E5E5E5"> mode most pop as I said</font>

159
00:07:36,400 --> 00:07:42,520
is the<font color="#CCCCCC"> most</font><font color="#E5E5E5"> popular</font><font color="#CCCCCC"> enterprise Wi-Fi</font>

160
00:07:38,020 --> 00:07:44,770
<font color="#CCCCCC">security mechanism and again the PAP has</font>

161
00:07:42,520 --> 00:07:48,039
his own standards<font color="#CCCCCC"> and the most</font><font color="#E5E5E5"> used one</font>

162
00:07:44,770 --> 00:07:50,409
is EAP mschap with you<font color="#CCCCCC"> most of</font><font color="#E5E5E5"> you</font>

163
00:07:48,040 --> 00:07:52,330
already probably<font color="#E5E5E5"> saw this kind of of</font>

164
00:07:50,410 --> 00:07:54,070
stander here because it has native

165
00:07:52,330 --> 00:07:55,870
support on<font color="#E5E5E5"> all the</font><font color="#CCCCCC"> windows</font><font color="#E5E5E5"> machine also</font>

166
00:07:54,070 --> 00:07:57,730
<font color="#E5E5E5">the old ones and as we know in</font>

167
00:07:55,870 --> 00:08:00,130
enterprise network there is<font color="#E5E5E5"> always a</font>

168
00:07:57,730 --> 00:08:01,990
Windows<font color="#E5E5E5"> XP machine somewhere that</font><font color="#CCCCCC"> needs</font>

169
00:08:00,130 --> 00:08:06,600
to be<font color="#E5E5E5"> connected to the</font><font color="#CCCCCC"> network so that's</font>

170
00:08:01,990 --> 00:08:06,600
<font color="#E5E5E5">why this is</font><font color="#CCCCCC"> still the most standard</font><font color="#E5E5E5"> one</font>

171
00:08:08,310 --> 00:08:12,600
<font color="#CCCCCC">okay</font><font color="#E5E5E5"> that was the very quick</font>

172
00:08:10,930 --> 00:08:15,940
introduction<font color="#CCCCCC"> about</font>

173
00:08:12,600 --> 00:08:18,940
<font color="#CCCCCC">WPA enterprise so what will you</font><font color="#E5E5E5"> what how</font>

174
00:08:15,940 --> 00:08:23,200
can we attack<font color="#E5E5E5"> Windows sorry WPA</font>

175
00:08:18,940 --> 00:08:27,420
enterprise network so basically we use

176
00:08:23,200 --> 00:08:31,330
as a<font color="#E5E5E5"> set patch</font><font color="#CCCCCC"> version of of--steak PD</font>

177
00:08:27,420 --> 00:08:34,600
yeah that basically<font color="#E5E5E5"> allow me not only to</font>

178
00:08:31,330 --> 00:08:36,250
obtain the - sorry<font color="#E5E5E5"> - a try to</font>

179
00:08:34,600 --> 00:08:38,790
authenticate<font color="#CCCCCC"> the</font><font color="#E5E5E5"> client but it also</font>

180
00:08:36,250 --> 00:08:41,020
prompts<font color="#E5E5E5"> me and then write me the</font>

181
00:08:38,789 --> 00:08:43,510
credentials of the encrypted credential

182
00:08:41,020 --> 00:08:47,380
<font color="#E5E5E5">that the user ID try to to use to</font><font color="#CCCCCC"> attack</font>

183
00:08:43,510 --> 00:08:51,010
<font color="#CCCCCC">to connect the network</font><font color="#E5E5E5"> so the idea is</font>

184
00:08:47,380 --> 00:08:53,980
that<font color="#E5E5E5"> sorry the idea is that we create a</font>

185
00:08:51,010 --> 00:08:56,290
fake<font color="#CCCCCC"> network</font><font color="#E5E5E5"> probably the same name as</font>

186
00:08:53,980 --> 00:08:58,510
the<font color="#CCCCCC"> real one or</font><font color="#E5E5E5"> a similar name and try</font>

187
00:08:56,290 --> 00:09:01,300
to<font color="#CCCCCC"> lure the user into connect to our</font>

188
00:08:58,510 --> 00:09:03,220
<font color="#CCCCCC">network and</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> fourth to send with us</font>

189
00:09:01,300 --> 00:09:08,319
the encrypted credential that

190
00:09:03,220 --> 00:09:10,959
we need to crack so as I said<font color="#E5E5E5"> bit but as</font>

191
00:09:08,319 --> 00:09:12,790
I<font color="#E5E5E5"> said before</font><font color="#CCCCCC"> PAP but also eap-tls</font>

192
00:09:10,959 --> 00:09:15,969
use a server-side certificate so the

193
00:09:12,790 --> 00:09:17,920
user have<font color="#CCCCCC"> to connect</font><font color="#E5E5E5"> I have to accept</font>

194
00:09:15,970 --> 00:09:21,310
the<font color="#CCCCCC"> certificate that</font><font color="#E5E5E5"> the server presents</font>

195
00:09:17,920 --> 00:09:23,979
<font color="#E5E5E5">so when I create my own fake access</font>

196
00:09:21,310 --> 00:09:26,739
point<font color="#CCCCCC"> the user will be get will get a</font>

197
00:09:23,980 --> 00:09:28,720
prompt<font color="#CCCCCC"> saying wait the</font><font color="#E5E5E5"> certificate is</font>

198
00:09:26,740 --> 00:09:31,629
changed<font color="#E5E5E5"> do you want to accept it or</font><font color="#CCCCCC"> not</font>

199
00:09:28,720 --> 00:09:34,149
most<font color="#E5E5E5"> of the time the</font><font color="#CCCCCC"> people said ok</font>

200
00:09:31,629 --> 00:09:37,660
accept it but<font color="#E5E5E5"> sometimes there is an</font>

201
00:09:34,149 --> 00:09:39,009
option<font color="#CCCCCC"> sorry these</font><font color="#E5E5E5"> already</font><font color="#CCCCCC"> spoke about I</font>

202
00:09:37,660 --> 00:09:41,350
will tell you how we<font color="#CCCCCC"> talked about the</font>

203
00:09:39,009 --> 00:09:43,600
option<font color="#E5E5E5"> later so most of the time the</font>

204
00:09:41,350 --> 00:09:45,339
user will accept the prompt<font color="#E5E5E5"> and then he</font>

205
00:09:43,600 --> 00:09:52,509
stole<font color="#E5E5E5"> the new certificate and send a</font>

206
00:09:45,339 --> 00:09:54,879
credential<font color="#E5E5E5"> ok quick thing about</font><font color="#CCCCCC"> mschap</font>

207
00:09:52,509 --> 00:09:58,480
<font color="#E5E5E5">with you</font><font color="#CCCCCC"> most</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> you probably already</font>

208
00:09:54,879 --> 00:10:00,759
<font color="#E5E5E5">know but</font><font color="#CCCCCC"> ok we speak about</font><font color="#E5E5E5"> that also</font>

209
00:09:58,480 --> 00:10:03,850
later on<font color="#E5E5E5"> and that's fine</font><font color="#CCCCCC"> so what do we</font>

210
00:10:00,759 --> 00:10:07,029
<font color="#CCCCCC">use during a red teaming attack</font><font color="#E5E5E5"> to to</font>

211
00:10:03,850 --> 00:10:08,680
get this<font color="#CCCCCC"> kind of information so in red</font>

212
00:10:07,029 --> 00:10:11,800
teaming as<font color="#CCCCCC"> I said we can do everything</font>

213
00:10:08,680 --> 00:10:14,949
<font color="#E5E5E5">right we can go</font><font color="#CCCCCC"> on client side</font><font color="#E5E5E5"> drop some</font>

214
00:10:11,800 --> 00:10:17,800
some<font color="#E5E5E5"> I don't know for like raspberry pi</font>

215
00:10:14,949 --> 00:10:19,508
and then wait<font color="#E5E5E5"> we don't have a very</font>

216
00:10:17,800 --> 00:10:23,109
<font color="#CCCCCC">specific time limit so we</font><font color="#E5E5E5"> can attack on</font>

217
00:10:19,509 --> 00:10:24,910
the night<font color="#E5E5E5"> on the day everything so for</font>

218
00:10:23,110 --> 00:10:27,129
example in this<font color="#E5E5E5"> case what we use is a</font>

219
00:10:24,910 --> 00:10:28,779
<font color="#CCCCCC">very simple drop box machine which is</font>

220
00:10:27,129 --> 00:10:31,209
basically<font color="#E5E5E5"> our</font><font color="#CCCCCC"> Asbury pie with</font><font color="#E5E5E5"> some</font>

221
00:10:28,779 --> 00:10:33,879
custom software<font color="#E5E5E5"> of some modification of</font>

222
00:10:31,209 --> 00:10:35,500
<font color="#E5E5E5">our standard Kali Linux an external</font>

223
00:10:33,879 --> 00:10:38,559
battery to let you run for like a couple

224
00:10:35,500 --> 00:10:40,449
<font color="#CCCCCC">of days</font><font color="#E5E5E5"> and then forget</font><font color="#CCCCCC"> about that</font><font color="#E5E5E5"> of</font>

225
00:10:38,559 --> 00:10:42,790
course an external on Wi-Fi antenna to

226
00:10:40,449 --> 00:10:44,800
get in<font color="#E5E5E5"> longer range because when the</font>

227
00:10:42,790 --> 00:10:46,660
clients when their victims

228
00:10:44,800 --> 00:10:49,329
try to<font color="#CCCCCC"> connects they will try to connect</font>

229
00:10:46,660 --> 00:10:51,309
the most powerful<font color="#CCCCCC"> networking at the time</font>

230
00:10:49,329 --> 00:10:53,829
so we<font color="#E5E5E5"> want to be the most powerful</font>

231
00:10:51,309 --> 00:10:58,089
<font color="#CCCCCC">natural the time</font><font color="#E5E5E5"> and then optionally we</font>

232
00:10:53,829 --> 00:11:00,489
also use sometimes<font color="#E5E5E5"> 3G or 4G dongle so</font>

233
00:10:58,089 --> 00:11:02,860
that we can connect<font color="#E5E5E5"> actually that</font><font color="#CCCCCC"> drop</font>

234
00:11:00,490 --> 00:11:05,259
machine connects<font color="#E5E5E5"> back</font><font color="#CCCCCC"> to us and we can</font>

235
00:11:02,860 --> 00:11:07,720
query for<font color="#E5E5E5"> for credential and check the</font>

236
00:11:05,259 --> 00:11:09,550
status of<font color="#E5E5E5"> the machine or reboot it or</font>

237
00:11:07,720 --> 00:11:12,040
reset if something goes<font color="#CCCCCC"> wrong</font><font color="#E5E5E5"> and</font>

238
00:11:09,550 --> 00:11:16,149
<font color="#CCCCCC">sometime you also use some 3d printers</font>

239
00:11:12,040 --> 00:11:19,240
to<font color="#CCCCCC"> create a proper box</font><font color="#E5E5E5"> for putting the</font>

240
00:11:16,149 --> 00:11:20,620
<font color="#CCCCCC">Dropbox</font><font color="#E5E5E5"> machine and then hide</font><font color="#CCCCCC"> it</font>

241
00:11:19,240 --> 00:11:24,689
somewhere<font color="#E5E5E5"> like I don't know maybe you</font>

242
00:11:20,620 --> 00:11:27,759
saw in the<font color="#E5E5E5"> street</font><font color="#CCCCCC"> is like a</font><font color="#E5E5E5"> poison</font><font color="#CCCCCC"> rat</font>

243
00:11:24,689 --> 00:11:31,329
<font color="#E5E5E5">box that is very common no one want to</font>

244
00:11:27,759 --> 00:11:33,180
<font color="#E5E5E5">touch</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> because</font><font color="#CCCCCC"> says</font><font color="#E5E5E5"> paws on dead so</font>

245
00:11:31,329 --> 00:11:47,469
it's it's pretty convenient to store

246
00:11:33,180 --> 00:11:49,449
<font color="#CCCCCC">drop</font><font color="#E5E5E5"> box machine</font><font color="#CCCCCC"> okay so that's that's</font>

247
00:11:47,470 --> 00:11:52,120
quite<font color="#CCCCCC"> easy</font><font color="#E5E5E5"> I mean this is common</font>

248
00:11:49,449 --> 00:11:55,990
<font color="#CCCCCC">knowledge nothing</font><font color="#E5E5E5"> new here but during</font>

249
00:11:52,120 --> 00:11:59,410
one<font color="#E5E5E5"> of the our engagement we found an</font>

250
00:11:55,990 --> 00:12:01,360
issue that<font color="#E5E5E5"> basically our victims didn't</font>

251
00:11:59,410 --> 00:12:02,889
get the prompt for<font color="#E5E5E5"> the new certificate</font>

252
00:12:01,360 --> 00:12:06,910
therefore they could not<font color="#E5E5E5"> connect to our</font>

253
00:12:02,889 --> 00:12:08,319
fake access point<font color="#E5E5E5"> so we started to</font>

254
00:12:06,910 --> 00:12:10,689
<font color="#CCCCCC">investigate</font><font color="#E5E5E5"> the problem</font><font color="#CCCCCC"> we try</font><font color="#E5E5E5"> to</font>

255
00:12:08,319 --> 00:12:15,160
reproduce with our own devices<font color="#E5E5E5"> and we</font>

256
00:12:10,689 --> 00:12:18,069
found sorry<font color="#E5E5E5"> and we found that there is</font>

257
00:12:15,160 --> 00:12:21,219
<font color="#E5E5E5">an</font><font color="#CCCCCC"> option on</font><font color="#E5E5E5"> Windows</font><font color="#CCCCCC"> machines that</font>

258
00:12:18,069 --> 00:12:24,219
allows the computer to automatically

259
00:12:21,220 --> 00:12:26,069
drop any certificate<font color="#CCCCCC"> it</font><font color="#E5E5E5"> is not in a</font>

260
00:12:24,220 --> 00:12:28,929
trusted<font color="#CCCCCC"> Microsoft root CA</font>

261
00:12:26,069 --> 00:12:31,410
<font color="#CCCCCC">so basically when we generate our own</font>

262
00:12:28,929 --> 00:12:34,509
certificate<font color="#CCCCCC"> of course our certificate is</font>

263
00:12:31,410 --> 00:12:37,240
self generated right<font color="#E5E5E5"> so it's not</font><font color="#CCCCCC"> present</font>

264
00:12:34,509 --> 00:12:39,939
in our in a standard trust<font color="#E5E5E5"> Microsoft</font>

265
00:12:37,240 --> 00:12:42,160
root CA and therefore the victim machine

266
00:12:39,939 --> 00:12:43,839
<font color="#E5E5E5">automatically drop it and doesn't even</font>

267
00:12:42,160 --> 00:12:45,910
prompt<font color="#E5E5E5"> the user to accept the new</font>

268
00:12:43,839 --> 00:12:49,089
certificate the for no credential the

269
00:12:45,910 --> 00:12:54,009
for which cannot access the victim<font color="#CCCCCC"> hash</font>

270
00:12:49,089 --> 00:12:56,649
<font color="#E5E5E5">or password so</font><font color="#CCCCCC"> what what's the idea the</font>

271
00:12:54,009 --> 00:13:01,540
<font color="#CCCCCC">idea is to get a trusted Microsoft root</font>

272
00:12:56,649 --> 00:13:04,990
CA certificate<font color="#E5E5E5"> so this is the portion of</font>

273
00:13:01,540 --> 00:13:06,969
the<font color="#CCCCCC"> root certificate</font><font color="#E5E5E5"> in Microsoft</font>

274
00:13:04,990 --> 00:13:08,920
Windows at the moment<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> updated</font>

275
00:13:06,970 --> 00:13:11,860
like<font color="#E5E5E5"> I think yesterday</font><font color="#CCCCCC"> or something like</font>

276
00:13:08,920 --> 00:13:19,469
<font color="#E5E5E5">that so do you know how many of you</font>

277
00:13:11,860 --> 00:13:19,470
recognize<font color="#E5E5E5"> this name here no one</font>

278
00:13:21,060 --> 00:13:28,680
this is let's encrypt<font color="#CCCCCC"> SIA</font><font color="#E5E5E5"> so Microsoft</font>

279
00:13:25,680 --> 00:13:32,030
recently added<font color="#CCCCCC"> the let's encrypt</font><font color="#E5E5E5"> CR to</font>

280
00:13:28,680 --> 00:13:35,699
the<font color="#E5E5E5"> trusted root of the Windows machines</font>

281
00:13:32,030 --> 00:13:38,280
<font color="#CCCCCC">so that means</font><font color="#E5E5E5"> that we can get a free</font>

282
00:13:35,700 --> 00:13:41,010
<font color="#CCCCCC">certificate</font><font color="#E5E5E5"> that we can use to</font>

283
00:13:38,280 --> 00:13:42,990
authenticate<font color="#E5E5E5"> the sorry</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> validate our</font>

284
00:13:41,010 --> 00:13:44,850
certificate to the clients<font color="#E5E5E5"> and therefore</font>

285
00:13:42,990 --> 00:13:52,920
<font color="#E5E5E5">from</font><font color="#CCCCCC"> them to accept a new certificate</font>

286
00:13:44,850 --> 00:13:55,440
<font color="#CCCCCC">and enter their credential so to</font><font color="#E5E5E5"> wrap</font><font color="#CCCCCC"> up</font>

287
00:13:52,920 --> 00:13:57,599
the idea the idea<font color="#E5E5E5"> is to create a</font>

288
00:13:55,440 --> 00:14:00,510
<font color="#E5E5E5">phishing domain a standard phishing</font>

289
00:13:57,600 --> 00:14:02,760
domain<font color="#E5E5E5"> something that is similar</font><font color="#CCCCCC"> to the</font>

290
00:14:00,510 --> 00:14:05,370
corporation we want attack I here used

291
00:14:02,760 --> 00:14:07,620
like how my<font color="#E5E5E5"> company's the website is</font>

292
00:14:05,370 --> 00:14:10,440
<font color="#E5E5E5">opposing force</font><font color="#CCCCCC"> dot IT</font><font color="#E5E5E5"> I try to use up</font>

293
00:14:07,620 --> 00:14:15,600
<font color="#E5E5E5">for that IT and then maybe a subdomain</font>

294
00:14:10,440 --> 00:14:18,150
<font color="#E5E5E5">to make it more realistic</font><font color="#CCCCCC"> ok then</font><font color="#E5E5E5"> we use</font>

295
00:14:15,600 --> 00:14:20,010
third<font color="#CCCCCC"> bots that</font><font color="#E5E5E5"> is the tool that let's</font>

296
00:14:18,150 --> 00:14:24,780
encrypt provides us to create a new

297
00:14:20,010 --> 00:14:27,840
<font color="#CCCCCC">certificate</font><font color="#E5E5E5"> for our subdomain we save</font>

298
00:14:24,780 --> 00:14:32,329
the<font color="#CCCCCC"> certificate on</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> new mesh on the</font>

299
00:14:27,840 --> 00:14:39,000
our Dropbox machine inside the AUSA APD

300
00:14:32,330 --> 00:14:40,320
WP directory food chain and the private

301
00:14:39,000 --> 00:14:43,740
key these<font color="#E5E5E5"> are the two files that we</font><font color="#CCCCCC"> need</font>

302
00:14:40,320 --> 00:14:46,080
and then<font color="#E5E5E5"> we can finally get the</font>

303
00:14:43,740 --> 00:14:48,840
credential from<font color="#E5E5E5"> the victim so in this</font>

304
00:14:46,080 --> 00:14:51,630
way we can bypass the option that

305
00:14:48,840 --> 00:15:01,980
<font color="#E5E5E5">windows a set to validate</font><font color="#CCCCCC"> a certificate</font>

306
00:14:51,630 --> 00:15:05,090
before<font color="#E5E5E5"> prompting the user so what are we</font>

307
00:15:01,980 --> 00:15:07,260
trying<font color="#E5E5E5"> to do now the idea now is to</font>

308
00:15:05,090 --> 00:15:09,540
<font color="#E5E5E5">developing a</font><font color="#CCCCCC"> small tool and was more</font>

309
00:15:07,260 --> 00:15:13,290
script that automatically will get us

310
00:15:09,540 --> 00:15:16,469
<font color="#E5E5E5">illumine obtain the specific certificate</font>

311
00:15:13,290 --> 00:15:19,020
certificate from from the<font color="#CCCCCC"> third bot and</font>

312
00:15:16,470 --> 00:15:22,740
set up the fake access point with with

313
00:15:19,020 --> 00:15:24,960
such certificates so using<font color="#CCCCCC"> esos APD in</font>

314
00:15:22,740 --> 00:15:27,750
that way we can<font color="#CCCCCC"> just execute the script</font>

315
00:15:24,960 --> 00:15:29,490
<font color="#E5E5E5">on the Dropbox deploy the Dropbox and</font>

316
00:15:27,750 --> 00:15:31,860
<font color="#E5E5E5">forget</font><font color="#CCCCCC"> about</font><font color="#E5E5E5"> that for a</font><font color="#CCCCCC"> couple of</font><font color="#E5E5E5"> days</font>

317
00:15:29,490 --> 00:15:34,260
and then check<font color="#CCCCCC"> for the credential so</font>

318
00:15:31,860 --> 00:15:34,830
this is the idea and<font color="#E5E5E5"> that's we plan to</font>

319
00:15:34,260 --> 00:15:37,050
do<font color="#CCCCCC"> two</font>

320
00:15:34,830 --> 00:15:39,300
release the tool on github in I don't

321
00:15:37,050 --> 00:15:41,089
<font color="#CCCCCC">know</font><font color="#E5E5E5"> maybe a couple</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> weeks now</font><font color="#CCCCCC"> still</font>

322
00:15:39,300 --> 00:15:43,920
trying<font color="#CCCCCC"> to</font><font color="#E5E5E5"> figure out what is the best</font>

323
00:15:41,090 --> 00:15:48,180
provider for domains and these kind of

324
00:15:43,920 --> 00:15:52,410
<font color="#E5E5E5">things</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> that that's my very simple</font>

325
00:15:48,180 --> 00:15:53,670
talk in my opinion one the the we

326
00:15:52,410 --> 00:15:55,140
<font color="#E5E5E5">actually spent a couple of days to</font>

327
00:15:53,670 --> 00:15:57,990
figure<font color="#E5E5E5"> out</font><font color="#CCCCCC"> what's the</font><font color="#E5E5E5"> problem there and</font>

328
00:15:55,140 --> 00:15:59,730
this kind<font color="#E5E5E5"> of engagement so maybe some of</font>

329
00:15:57,990 --> 00:16:01,850
you will face the<font color="#CCCCCC"> same</font><font color="#E5E5E5"> issue and now you</font>

330
00:15:59,730 --> 00:16:05,640
have a possible answer for that<font color="#E5E5E5"> so</font>

331
00:16:01,850 --> 00:16:07,500
please<font color="#E5E5E5"> ask me some</font><font color="#CCCCCC"> question</font><font color="#E5E5E5"> because then</font>

332
00:16:05,640 --> 00:16:11,520
we<font color="#E5E5E5"> have lunch and we</font><font color="#CCCCCC"> can</font><font color="#E5E5E5"> forget about</font>

333
00:16:07,500 --> 00:16:17,250
this thank you<font color="#CCCCCC"> very much</font>

334
00:16:11,520 --> 00:16:19,410
any questions from the<font color="#CCCCCC"> audience</font><font color="#E5E5E5"> okay</font>

335
00:16:17,250 --> 00:16:21,840
<font color="#CCCCCC">well do keep in mind that</font><font color="#E5E5E5"> if you do come</font>

336
00:16:19,410 --> 00:16:26,280
up<font color="#E5E5E5"> with any questions</font><font color="#CCCCCC"> you'll be</font><font color="#E5E5E5"> around</font>

337
00:16:21,840 --> 00:16:29,460
<font color="#E5E5E5">so don't have lunch like you where is</font>

338
00:16:26,280 --> 00:16:33,240
the<font color="#E5E5E5"> final</font><font color="#CCCCCC"> ok so right now it's time for</font>

339
00:16:29,460 --> 00:16:37,590
<font color="#CCCCCC">a lunch we'll start back up</font><font color="#E5E5E5"> in one hour</font>

340
00:16:33,240 --> 00:16:39,480
so<font color="#CCCCCC"> be here at 2 p.m. to catch</font><font color="#E5E5E5"> up</font><font color="#CCCCCC"> with</font>

341
00:16:37,590 --> 00:16:42,390
the<font color="#E5E5E5"> next track for all the paying</font>

342
00:16:39,480 --> 00:16:44,310
<font color="#CCCCCC">attorneys there will be lunch on</font><font color="#E5E5E5"> the</font>

343
00:16:42,390 --> 00:16:48,449
ground floor<font color="#E5E5E5"> in the lobby</font><font color="#CCCCCC"> at the room</font>

344
00:16:44,310 --> 00:16:50,250
<font color="#CCCCCC">ashen</font><font color="#E5E5E5"> elk so I hope to see you</font><font color="#CCCCCC"> again</font><font color="#E5E5E5"> in</font>

345
00:16:48,450 --> 00:16:52,360
<font color="#CCCCCC">one hour</font><font color="#E5E5E5"> and give it up one more time</font>

346
00:16:50,250 --> 00:16:55,789
for<font color="#E5E5E5"> Mateo thank you</font>

347
00:16:52,360 --> 00:16:55,789
[Applause]

