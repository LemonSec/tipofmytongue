1
00:00:11,740 --> 00:00:18,280
good afternoon everyone

2
00:00:13,950 --> 00:00:20,740
<font color="#E5E5E5">morning</font><font color="#CCCCCC"> I know</font><font color="#E5E5E5"> okay</font><font color="#CCCCCC"> I need coffee for</font>

3
00:00:18,280 --> 00:00:22,570
sure<font color="#CCCCCC"> I had a bad night</font><font color="#E5E5E5"> today I was</font>

4
00:00:20,740 --> 00:00:26,369
working<font color="#CCCCCC"> on something that you probably</font>

5
00:00:22,570 --> 00:00:26,369
<font color="#CCCCCC">see in the end of the talk</font>

6
00:00:26,670 --> 00:00:31,449
good morning everyone my<font color="#CCCCCC"> name is Vito</font>

7
00:00:28,869 --> 00:00:34,660
<font color="#CCCCCC">nakum Luke and I'm here with my friend</font>

8
00:00:31,449 --> 00:00:40,170
<font color="#CCCCCC">Nicholas</font><font color="#E5E5E5"> coloring I'm myself from</font>

9
00:00:34,660 --> 00:00:44,379
<font color="#E5E5E5">kaspersky lab</font><font color="#CCCCCC"> Nicholas is from DBS</font><font color="#E5E5E5"> bank</font>

10
00:00:40,170 --> 00:00:46,320
<font color="#E5E5E5">so today we're going to talk about</font><font color="#CCCCCC"> food</font>

11
00:00:44,379 --> 00:00:49,659
disk encryption from perspective<font color="#E5E5E5"> of</font>

12
00:00:46,320 --> 00:00:52,690
forensic<font color="#E5E5E5"> analysts</font><font color="#CCCCCC"> marver analysts that</font>

13
00:00:49,659 --> 00:00:55,180
<font color="#E5E5E5">needs to do work remotely</font><font color="#CCCCCC"> imagine</font><font color="#E5E5E5"> that</font>

14
00:00:52,690 --> 00:00:57,129
you have a problem<font color="#E5E5E5"> somewhere distant</font>

15
00:00:55,180 --> 00:01:01,000
<font color="#E5E5E5">from your office and you need to</font><font color="#CCCCCC"> locate</font>

16
00:00:57,129 --> 00:01:03,040
<font color="#E5E5E5">and a copy mobile or understand how the</font>

17
00:01:01,000 --> 00:01:05,349
<font color="#E5E5E5">system was breached</font><font color="#CCCCCC"> but you have a</font>

18
00:01:03,040 --> 00:01:07,330
<font color="#E5E5E5">challenge of who</font><font color="#CCCCCC"> drove</font><font color="#E5E5E5"> encryption that</font>

19
00:01:05,349 --> 00:01:10,169
uses proprietary algorithm that<font color="#E5E5E5"> has no</font>

20
00:01:07,330 --> 00:01:14,170
<font color="#E5E5E5">support or from the open source world</font>

21
00:01:10,170 --> 00:01:17,980
and a little warning if there are some

22
00:01:14,170 --> 00:01:21,130
underaged individuals in the room<font color="#E5E5E5"> it's</font>

23
00:01:17,980 --> 00:01:23,410
<font color="#E5E5E5">time</font><font color="#CCCCCC"> to live</font><font color="#E5E5E5"> also if you are scared of</font>

24
00:01:21,130 --> 00:01:25,270
deep technical<font color="#E5E5E5"> content</font><font color="#CCCCCC"> I recommend to</font>

25
00:01:23,410 --> 00:01:27,369
<font color="#E5E5E5">leave now because</font><font color="#CCCCCC"> we have pretty</font>

26
00:01:25,270 --> 00:01:32,500
compressed<font color="#E5E5E5"> technical presentation there</font>

27
00:01:27,370 --> 00:01:33,850
will<font color="#CCCCCC"> be very little</font><font color="#E5E5E5"> water so you want to</font>

28
00:01:32,500 --> 00:01:36,970
say a few<font color="#CCCCCC"> words all yourself ok</font><font color="#E5E5E5"> we will</font>

29
00:01:33,850 --> 00:01:39,429
skip and<font color="#CCCCCC"> go straight to</font><font color="#E5E5E5"> the to the point</font>

30
00:01:36,970 --> 00:01:40,780
<font color="#E5E5E5">I actually presented last year</font><font color="#CCCCCC"> about</font>

31
00:01:39,430 --> 00:01:43,510
this project<font color="#E5E5E5"> it's an open source project</font>

32
00:01:40,780 --> 00:01:45,640
<font color="#CCCCCC">called bit Scout that allows you to</font>

33
00:01:43,510 --> 00:01:48,280
build<font color="#CCCCCC"> your own live CD that can use for</font>

34
00:01:45,640 --> 00:01:50,590
remote digital forensics<font color="#E5E5E5"> and malware</font>

35
00:01:48,280 --> 00:01:54,159
<font color="#E5E5E5">analysis and triage so it's minimal in</font>

36
00:01:50,590 --> 00:01:55,210
size and<font color="#CCCCCC"> has</font><font color="#E5E5E5"> a certain principle</font><font color="#CCCCCC"> to be</font>

37
00:01:54,159 --> 00:01:56,830
<font color="#E5E5E5">implemented there it has to be</font>

38
00:01:55,210 --> 00:02:00,070
forensically sound like whereas that

39
00:01:56,830 --> 00:02:02,230
means it has not modified the system

40
00:02:00,070 --> 00:02:04,809
where it's booted<font color="#E5E5E5"> shall be simple and</font>

41
00:02:02,230 --> 00:02:06,430
customizable<font color="#E5E5E5"> it has to be extendable at</font>

42
00:02:04,810 --> 00:02:07,780
runtime<font color="#E5E5E5"> so you have to</font><font color="#CCCCCC"> install it</font><font color="#E5E5E5"> you</font>

43
00:02:06,430 --> 00:02:10,959
should be<font color="#CCCCCC"> able to install additional</font>

44
00:02:07,780 --> 00:02:12,819
packages and libraries<font color="#E5E5E5"> and so on</font><font color="#CCCCCC"> it</font>

45
00:02:10,959 --> 00:02:15,040
should<font color="#E5E5E5"> work over slow in our stable</font>

46
00:02:12,819 --> 00:02:18,730
networks<font color="#E5E5E5"> we actually use it many times</font>

47
00:02:15,040 --> 00:02:20,319
<font color="#E5E5E5">including</font><font color="#CCCCCC"> some cases where a computer</font><font color="#E5E5E5"> in</font>

48
00:02:18,730 --> 00:02:24,160
Africa was compromised and<font color="#E5E5E5"> I had to</font>

49
00:02:20,319 --> 00:02:25,780
exfiltrate you know some evidence of

50
00:02:24,160 --> 00:02:32,829
of the<font color="#CCCCCC"> compromised</font><font color="#E5E5E5"> and analyze that</font>

51
00:02:25,780 --> 00:02:35,590
without<font color="#CCCCCC"> coping</font><font color="#E5E5E5"> the whole disk it is it's</font>

52
00:02:32,830 --> 00:02:38,200
using<font color="#CCCCCC"> your VPN certificate and SSH keys</font>

53
00:02:35,590 --> 00:02:40,270
to provide<font color="#E5E5E5"> your remote access to to the</font>

54
00:02:38,200 --> 00:02:43,450
box<font color="#CCCCCC"> so basically it's a live CD</font><font color="#E5E5E5"> that</font>

55
00:02:40,270 --> 00:02:46,390
runs Linux<font color="#CCCCCC"> starts Open VPN</font><font color="#E5E5E5"> provides you</font>

56
00:02:43,450 --> 00:02:48,549
with SSH access<font color="#E5E5E5"> over this may p.m. so</font>

57
00:02:46,390 --> 00:02:50,170
<font color="#E5E5E5">that you can use a bunch of</font><font color="#CCCCCC"> open-source</font>

58
00:02:48,550 --> 00:02:53,230
<font color="#CCCCCC">tools that is available in the Linux</font>

59
00:02:50,170 --> 00:02:55,510
world she<font color="#E5E5E5"> analyzed a disk to</font><font color="#CCCCCC"> analyze the</font>

60
00:02:53,230 --> 00:02:56,950
malware<font color="#E5E5E5"> analyze its configuration files</font>

61
00:02:55,510 --> 00:02:59,980
<font color="#E5E5E5">and copy any</font><font color="#CCCCCC"> times</font><font color="#E5E5E5"> that you want</font>

62
00:02:56,950 --> 00:03:02,739
<font color="#E5E5E5">that system and in this talk we</font>

63
00:02:59,980 --> 00:03:03,670
delivered last<font color="#E5E5E5"> year there was assumption</font>

64
00:03:02,740 --> 00:03:06,250
that there is no<font color="#E5E5E5"> pool disk encryption</font>

65
00:03:03,670 --> 00:03:07,720
<font color="#E5E5E5">the difference this year is that we are</font>

66
00:03:06,250 --> 00:03:10,750
doing<font color="#CCCCCC"> the wasteful drive encryption now</font>

67
00:03:07,720 --> 00:03:12,490
so it's minimal in interface<font color="#CCCCCC"> bit</font><font color="#E5E5E5"> Scott</font>

68
00:03:10,750 --> 00:03:16,240
has the only<font color="#E5E5E5"> graphical picture</font><font color="#CCCCCC"> on the</font>

69
00:03:12,490 --> 00:03:19,950
boot splash<font color="#E5E5E5"> after</font><font color="#CCCCCC"> you bullet it has to</font>

70
00:03:16,240 --> 00:03:22,690
<font color="#E5E5E5">keep this size low that's why the user</font>

71
00:03:19,950 --> 00:03:24,820
<font color="#E5E5E5">the owner of the machine compromised</font>

72
00:03:22,690 --> 00:03:29,050
machine sees only the<font color="#E5E5E5"> screen with a very</font>

73
00:03:24,820 --> 00:03:31,269
simple text-based UI<font color="#E5E5E5"> where the owner can</font>

74
00:03:29,050 --> 00:03:33,250
enable certain features may<font color="#E5E5E5"> be set up</font>

75
00:03:31,270 --> 00:03:37,570
<font color="#CCCCCC">network if required</font><font color="#E5E5E5"> and provide access</font>

76
00:03:33,250 --> 00:03:39,310
approve access<font color="#E5E5E5"> of</font><font color="#CCCCCC"> the for the export</font>

77
00:03:37,570 --> 00:03:46,720
remotely connecting to that host<font color="#E5E5E5"> to</font>

78
00:03:39,310 --> 00:03:50,170
specific drives and the the<font color="#E5E5E5"> idea of this</font>

79
00:03:46,720 --> 00:03:52,420
system also is partly<font color="#E5E5E5"> based on layers of</font>

80
00:03:50,170 --> 00:03:54,970
<font color="#E5E5E5">virtualization to protect from</font>

81
00:03:52,420 --> 00:03:56,950
accidental tampering<font color="#E5E5E5"> or malicious expert</font>

82
00:03:54,970 --> 00:03:59,109
<font color="#E5E5E5">working remotely and then</font><font color="#CCCCCC"> planting some</font>

83
00:03:56,950 --> 00:04:01,179
evidence so the<font color="#E5E5E5"> export actually works</font>

84
00:03:59,110 --> 00:04:05,260
<font color="#E5E5E5">within container so is Linux containers</font>

85
00:04:01,180 --> 00:04:07,360
<font color="#CCCCCC">Foley's</font><font color="#E5E5E5"> so the expert SSH in to the</font>

86
00:04:05,260 --> 00:04:09,609
container which has<font color="#E5E5E5"> certain you know</font>

87
00:04:07,360 --> 00:04:12,370
layer of isolation<font color="#E5E5E5"> and it's running</font><font color="#CCCCCC"> as</font>

88
00:04:09,610 --> 00:04:13,990
<font color="#CCCCCC">an</font><font color="#E5E5E5"> privilege user however there is a</font>

89
00:04:12,370 --> 00:04:15,700
root user simulated within the container

90
00:04:13,990 --> 00:04:18,190
so<font color="#CCCCCC"> that allows you to</font><font color="#E5E5E5"> install additional</font>

91
00:04:15,700 --> 00:04:23,469
<font color="#E5E5E5">packages or change any pretty pretty</font>

92
00:04:18,190 --> 00:04:25,530
<font color="#E5E5E5">much or any file inside so the only</font>

93
00:04:23,470 --> 00:04:28,060
<font color="#E5E5E5">thing that the owner needs to</font><font color="#CCCCCC"> do</font>

94
00:04:25,530 --> 00:04:29,919
<font color="#E5E5E5">normally if it's the HTTP everything is</font>

95
00:04:28,060 --> 00:04:31,480
automatically<font color="#CCCCCC"> configured the only thing</font>

96
00:04:29,920 --> 00:04:34,390
that the owner<font color="#E5E5E5"> needs to</font><font color="#CCCCCC"> do essential is</font>

97
00:04:31,480 --> 00:04:36,310
to<font color="#CCCCCC"> map physical drive</font><font color="#E5E5E5"> to a virtual drive</font>

98
00:04:34,390 --> 00:04:37,900
<font color="#E5E5E5">within the container that is available</font>

99
00:04:36,310 --> 00:04:45,040
<font color="#E5E5E5">as</font><font color="#CCCCCC"> a read-only</font><font color="#E5E5E5"> block</font>

100
00:04:37,900 --> 00:04:46,539
to the expert<font color="#E5E5E5"> that's how it's done like</font>

101
00:04:45,040 --> 00:04:49,410
I<font color="#E5E5E5"> said there are</font><font color="#CCCCCC"> multiple layers of</font>

102
00:04:46,539 --> 00:04:53,110
<font color="#CCCCCC">virtualization</font><font color="#E5E5E5"> that protect from</font>

103
00:04:49,410 --> 00:04:55,570
accidental changes<font color="#CCCCCC"> all the salt</font><font color="#E5E5E5"> drive</font>

104
00:04:53,110 --> 00:04:58,389
<font color="#E5E5E5">because if we are going</font><font color="#CCCCCC"> to use this</font>

105
00:04:55,570 --> 00:05:00,310
approach<font color="#CCCCCC"> in court for example if you</font>

106
00:04:58,389 --> 00:05:02,320
want<font color="#CCCCCC"> to really acquire disk</font><font color="#E5E5E5"> image in</font><font color="#CCCCCC"> a</font>

107
00:05:00,310 --> 00:05:04,060
forensically sound manner<font color="#E5E5E5"> we have</font><font color="#CCCCCC"> to</font>

108
00:05:02,320 --> 00:05:07,719
guarantee<font color="#CCCCCC"> that</font><font color="#E5E5E5"> there</font><font color="#CCCCCC"> will be no change</font>

109
00:05:04,060 --> 00:05:10,660
is done<font color="#E5E5E5"> to the drive</font><font color="#CCCCCC"> so it has to remain</font>

110
00:05:07,720 --> 00:05:12,310
untouched<font color="#CCCCCC"> that's why we have this live</font>

111
00:05:10,660 --> 00:05:15,039
CD<font color="#E5E5E5"> and everything is happening in the</font>

112
00:05:12,310 --> 00:05:17,560
RAM<font color="#E5E5E5"> after you shut down machine like not</font>

113
00:05:15,039 --> 00:05:19,780
a<font color="#E5E5E5"> single bit shall be flipped or changed</font>

114
00:05:17,560 --> 00:05:24,729
on the on the hard drive of<font color="#E5E5E5"> that machine</font>

115
00:05:19,780 --> 00:05:27,729
<font color="#CCCCCC">so this is essential now</font><font color="#E5E5E5"> network setup</font>

116
00:05:24,729 --> 00:05:30,460
allows us to connect over<font color="#E5E5E5"> VPN by default</font>

117
00:05:27,729 --> 00:05:32,440
but<font color="#CCCCCC"> the user of course</font><font color="#E5E5E5"> can enable direct</font>

118
00:05:30,460 --> 00:05:34,299
<font color="#E5E5E5">access</font><font color="#CCCCCC"> from the land</font><font color="#E5E5E5"> so for the for the</font>

119
00:05:32,440 --> 00:05:37,960
demo we will use direct access because

120
00:05:34,300 --> 00:05:41,620
<font color="#E5E5E5">it just simpler instead of using VPN so</font>

121
00:05:37,960 --> 00:05:44,109
we can<font color="#CCCCCC"> necessarily into the box and then</font>

122
00:05:41,620 --> 00:05:46,840
control it<font color="#E5E5E5"> so certain words are can be</font>

123
00:05:44,110 --> 00:05:49,449
forwarded<font color="#E5E5E5"> from that container to the</font>

124
00:05:46,840 --> 00:05:53,080
<font color="#CCCCCC">over the VPN to the</font><font color="#E5E5E5"> expert so that we</font>

125
00:05:49,449 --> 00:05:55,389
can start additional services including

126
00:05:53,080 --> 00:05:59,560
<font color="#E5E5E5">virtual machine like we will show you in</font>

127
00:05:55,389 --> 00:06:02,260
<font color="#CCCCCC">few moments</font><font color="#E5E5E5"> yeah that's what I was</font>

128
00:05:59,560 --> 00:06:04,990
<font color="#E5E5E5">saying about access from land and</font><font color="#CCCCCC"> also</font>

129
00:06:02,260 --> 00:06:06,340
if you<font color="#CCCCCC"> are the owner and the expert at</font>

130
00:06:04,990 --> 00:06:07,870
the same time if you use<font color="#E5E5E5"> it in</font><font color="#CCCCCC"> your</font><font color="#E5E5E5"> own</font>

131
00:06:06,340 --> 00:06:10,780
environment in your own network you can

132
00:06:07,870 --> 00:06:12,419
also<font color="#CCCCCC"> login to the hostess to know</font><font color="#E5E5E5"> to the</font>

133
00:06:10,780 --> 00:06:17,229
container

134
00:06:12,419 --> 00:06:21,880
now<font color="#E5E5E5"> let's we have prepared three</font><font color="#CCCCCC"> demos</font>

135
00:06:17,229 --> 00:06:24,039
we normally show<font color="#E5E5E5"> it live</font><font color="#CCCCCC"> but due to the</font>

136
00:06:21,880 --> 00:06:25,870
<font color="#CCCCCC">time constraints</font><font color="#E5E5E5"> it has to be faster</font>

137
00:06:24,039 --> 00:06:28,479
<font color="#CCCCCC">than usual</font><font color="#E5E5E5"> and there is no space for</font>

138
00:06:25,870 --> 00:06:31,150
typos and<font color="#E5E5E5"> redoing things so you're going</font>

139
00:06:28,479 --> 00:06:32,949
<font color="#E5E5E5">to show some recording</font><font color="#CCCCCC"> in the end if we</font>

140
00:06:31,150 --> 00:06:34,179
have time<font color="#E5E5E5"> I'll show you something that</font>

141
00:06:32,949 --> 00:06:38,400
we prepared specially for<font color="#E5E5E5"> hack in the</font>

142
00:06:34,180 --> 00:06:42,340
<font color="#E5E5E5">box so let's start from the</font><font color="#CCCCCC"> first demo</font>

143
00:06:38,400 --> 00:06:44,739
you don't explain<font color="#E5E5E5"> the show so we have a</font>

144
00:06:42,340 --> 00:06:47,469
<font color="#E5E5E5">compromised system running Windows</font><font color="#CCCCCC"> 10</font>

145
00:06:44,740 --> 00:06:51,490
the system as a full disk encryption as

146
00:06:47,469 --> 00:06:53,199
we<font color="#E5E5E5"> explained is going to</font>

147
00:06:51,490 --> 00:06:55,990
<font color="#CCCCCC">to have some challenges to run all the</font>

148
00:06:53,199 --> 00:06:58,150
tools that<font color="#E5E5E5"> we commonly commonly have and</font>

149
00:06:55,990 --> 00:07:01,270
as as you can remember<font color="#E5E5E5"> we are over</font><font color="#CCCCCC"> the</font>

150
00:06:58,150 --> 00:07:04,090
networks<font color="#E5E5E5"> in a faraway place where the</font>

151
00:07:01,270 --> 00:07:06,370
expert is going<font color="#CCCCCC"> to remote in so the</font>

152
00:07:04,090 --> 00:07:09,270
owner has created a live CD has booted

153
00:07:06,370 --> 00:07:11,500
up<font color="#E5E5E5"> they come from my system and now</font>

154
00:07:09,270 --> 00:07:13,960
<font color="#CCCCCC">we'll run</font><font color="#E5E5E5"> the permission that</font><font color="#CCCCCC"> we tally</font>

155
00:07:11,500 --> 00:07:18,580
<font color="#E5E5E5">just</font><font color="#CCCCCC"> explained</font><font color="#E5E5E5"> so this is the booting of</font>

156
00:07:13,960 --> 00:07:21,909
<font color="#E5E5E5">it</font><font color="#CCCCCC"> Scout a bit faster than the</font><font color="#E5E5E5"> IANA</font><font color="#CCCCCC"> maps</font>

157
00:07:18,580 --> 00:07:25,300
<font color="#E5E5E5">a network</font><font color="#CCCCCC"> grant</font><font color="#E5E5E5"> you access to the to the</font>

158
00:07:21,910 --> 00:07:28,449
expert<font color="#E5E5E5"> and</font><font color="#CCCCCC"> we'll map the</font><font color="#E5E5E5"> disk from</font><font color="#CCCCCC"> the</font>

159
00:07:25,300 --> 00:07:34,870
physical disk to<font color="#CCCCCC"> the virtual virtual</font>

160
00:07:28,449 --> 00:07:36,639
<font color="#E5E5E5">disk in the in the container so the</font>

161
00:07:34,870 --> 00:07:38,889
owner will select specifically the<font color="#E5E5E5"> disk</font>

162
00:07:36,639 --> 00:07:41,740
he wants to move to<font color="#CCCCCC"> authorize SDA in</font>

163
00:07:38,889 --> 00:07:45,880
that particular<font color="#E5E5E5"> case and</font><font color="#CCCCCC"> we'll map it to</font>

164
00:07:41,740 --> 00:07:49,180
evidence<font color="#E5E5E5"> zero in the container all right</font>

165
00:07:45,880 --> 00:07:51,490
so now the expert can remotely connect

166
00:07:49,180 --> 00:07:55,930
to<font color="#E5E5E5"> the virtual</font><font color="#CCCCCC"> machine at</font><font color="#E5E5E5"> all sorry to</font>

167
00:07:51,490 --> 00:08:01,870
the container<font color="#E5E5E5"> and we will perform the</font>

168
00:07:55,930 --> 00:08:03,849
<font color="#E5E5E5">analysis so after a bit</font><font color="#CCCCCC"> of setup we</font>

169
00:08:01,870 --> 00:08:06,400
consider this<font color="#E5E5E5"> can so</font><font color="#CCCCCC"> that this mounted</font>

170
00:08:03,849 --> 00:08:09,400
as<font color="#E5E5E5"> evidence</font><font color="#CCCCCC"> zero I will</font><font color="#E5E5E5"> contain two main</font>

171
00:08:06,400 --> 00:08:10,440
partitions the the first<font color="#CCCCCC"> one is a small</font>

172
00:08:09,400 --> 00:08:13,530
<font color="#CCCCCC">one is the</font><font color="#E5E5E5"> good one</font>

173
00:08:10,440 --> 00:08:17,349
followed<font color="#CCCCCC"> by the main main disk that</font><font color="#E5E5E5"> is</font>

174
00:08:13,530 --> 00:08:20,948
<font color="#CCCCCC">twelve</font><font color="#E5E5E5"> of our gigs and it is this disk</font>

175
00:08:17,349 --> 00:08:23,319
that we will<font color="#CCCCCC"> analyze so we will look</font>

176
00:08:20,949 --> 00:08:26,229
specifically at the<font color="#E5E5E5"> offset so we want to</font>

177
00:08:23,319 --> 00:08:28,599
see what is the content<font color="#E5E5E5"> of the disk if</font>

178
00:08:26,229 --> 00:08:30,460
we look at the content<font color="#E5E5E5"> of the disk and</font>

179
00:08:28,599 --> 00:08:33,490
add the offset of<font color="#CCCCCC"> the first partition</font>

180
00:08:30,460 --> 00:08:35,409
the boot partition has<font color="#E5E5E5"> expected we are</font>

181
00:08:33,490 --> 00:08:40,990
going to see it<font color="#CCCCCC"> clearer</font><font color="#E5E5E5"> because it is</font>

182
00:08:35,409 --> 00:08:43,689
where<font color="#E5E5E5"> Windows is starting from all right</font>

183
00:08:40,990 --> 00:08:46,810
<font color="#E5E5E5">so we</font><font color="#CCCCCC"> can</font><font color="#E5E5E5"> see the end here has had a no</font>

184
00:08:43,690 --> 00:08:51,339
surprise here<font color="#E5E5E5"> now let's calculate the</font>

185
00:08:46,810 --> 00:08:54,189
offset<font color="#E5E5E5"> for the second partition and this</font>

186
00:08:51,339 --> 00:09:00,640
time when<font color="#CCCCCC"> we see the content</font><font color="#E5E5E5"> well it's</font>

187
00:08:54,190 --> 00:09:03,670
encrypted<font color="#CCCCCC"> we</font><font color="#E5E5E5"> can't recognize it</font><font color="#CCCCCC"> all</font>

188
00:09:00,640 --> 00:09:06,069
<font color="#E5E5E5">right so first to prepare the</font>

189
00:09:03,670 --> 00:09:07,719
the demo we<font color="#CCCCCC"> are going to create a shot</font>

190
00:09:06,070 --> 00:09:09,850
folder<font color="#E5E5E5"> and we are going to put some</font>

191
00:09:07,720 --> 00:09:12,970
tools<font color="#E5E5E5"> in it so the expert from his</font>

192
00:09:09,850 --> 00:09:15,720
machine will use<font color="#CCCCCC"> SCP copy the binaries</font>

193
00:09:12,970 --> 00:09:19,360
we are going to use for the next<font color="#E5E5E5"> demo</font>

194
00:09:15,720 --> 00:09:20,830
<font color="#E5E5E5">then subsequently</font><font color="#CCCCCC"> as so we are</font>

195
00:09:19,360 --> 00:09:23,800
<font color="#E5E5E5">processing process Explorer in</font>

196
00:09:20,830 --> 00:09:25,780
particular<font color="#E5E5E5"> and then subsequently we are</font>

197
00:09:23,800 --> 00:09:28,930
going to create a<font color="#E5E5E5"> virtual machine</font><font color="#CCCCCC"> the</font>

198
00:09:25,780 --> 00:09:31,870
virtual machine will read the

199
00:09:28,930 --> 00:09:34,599
<font color="#CCCCCC">information from the mounted disk</font><font color="#E5E5E5"> and</font>

200
00:09:31,870 --> 00:09:38,650
all the right instruction will be<font color="#E5E5E5"> on a</font>

201
00:09:34,600 --> 00:09:40,960
differential<font color="#CCCCCC"> disk that</font><font color="#E5E5E5"> will be stored in</font>

202
00:09:38,650 --> 00:09:43,180
<font color="#E5E5E5">a</font><font color="#CCCCCC"> Kyoko</font><font color="#E5E5E5"> file you just to add a few words</font>

203
00:09:40,960 --> 00:09:45,640
<font color="#CCCCCC">the virtual machine will use</font><font color="#E5E5E5"> the</font>

204
00:09:43,180 --> 00:09:47,819
<font color="#CCCCCC">original hard drive in</font><font color="#E5E5E5"> write protection</font>

205
00:09:45,640 --> 00:09:51,310
<font color="#CCCCCC">mode so</font><font color="#E5E5E5"> all right operations will be</font>

206
00:09:47,820 --> 00:09:52,990
sent<font color="#CCCCCC"> to this</font><font color="#E5E5E5"> this file everything to</font>

207
00:09:51,310 --> 00:09:55,750
<font color="#CCCCCC">queue</font><font color="#E5E5E5"> call so it's like differential</font>

208
00:09:52,990 --> 00:09:59,410
file<font color="#CCCCCC"> and we are going</font><font color="#E5E5E5"> to start now the</font>

209
00:09:55,750 --> 00:10:00,940
<font color="#E5E5E5">original machine within the VM in any</font>

210
00:09:59,410 --> 00:10:03,339
case it wouldn't have been<font color="#E5E5E5"> possible to</font>

211
00:10:00,940 --> 00:10:06,070
do otherwise<font color="#E5E5E5"> because windows need to</font>

212
00:10:03,340 --> 00:10:08,340
write certain<font color="#E5E5E5"> things during the boot</font>

213
00:10:06,070 --> 00:10:12,610
<font color="#E5E5E5">sequence unless you know the owner has</font>

214
00:10:08,340 --> 00:10:14,830
mounted the<font color="#E5E5E5"> disk as read-only so once we</font>

215
00:10:12,610 --> 00:10:17,680
have<font color="#CCCCCC"> created that virtual disk</font><font color="#E5E5E5"> and we</font>

216
00:10:14,830 --> 00:10:21,460
are<font color="#E5E5E5"> going to to use</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> by creating a</font>

217
00:10:17,680 --> 00:10:23,890
virtual machine<font color="#E5E5E5"> we are using</font><font color="#CCCCCC"> qmu so here</font>

218
00:10:21,460 --> 00:10:26,620
we<font color="#E5E5E5"> can see that the virtual file</font><font color="#CCCCCC"> a</font>

219
00:10:23,890 --> 00:10:28,600
virtual disk is very small<font color="#CCCCCC"> Windows has</font>

220
00:10:26,620 --> 00:10:31,720
not booted yet so we create the virtual

221
00:10:28,600 --> 00:10:33,840
machine now we are<font color="#E5E5E5"> using this virtual</font>

222
00:10:31,720 --> 00:10:37,450
disk as<font color="#E5E5E5"> the main disk</font>

223
00:10:33,840 --> 00:10:39,550
we are also allowing to connect to the

224
00:10:37,450 --> 00:10:44,530
screen<font color="#CCCCCC"> through a spice protocol</font><font color="#E5E5E5"> and</font>

225
00:10:39,550 --> 00:10:46,750
<font color="#E5E5E5">lastly we are allowing</font><font color="#CCCCCC"> some bad</font><font color="#E5E5E5"> start to</font>

226
00:10:44,530 --> 00:10:48,850
act as<font color="#E5E5E5"> our shared folder so we can</font>

227
00:10:46,750 --> 00:10:54,460
<font color="#E5E5E5">transfer files between the virtual</font>

228
00:10:48,850 --> 00:10:55,990
machine and<font color="#E5E5E5"> the under container so let's</font>

229
00:10:54,460 --> 00:11:00,070
connect<font color="#CCCCCC"> to the virtual machine</font><font color="#E5E5E5"> booting</font>

230
00:10:55,990 --> 00:11:01,120
up of a spice as explained the<font color="#E5E5E5"> disk is</font>

231
00:11:00,070 --> 00:11:03,220
encrypted we don't know what's the

232
00:11:01,120 --> 00:11:07,060
protocol but<font color="#CCCCCC"> then the owner will</font><font color="#E5E5E5"> have to</font>

233
00:11:03,220 --> 00:11:12,070
<font color="#CCCCCC">keep the the password and the user that</font>

234
00:11:07,060 --> 00:11:16,989
we can connect with<font color="#E5E5E5"> is unprivileged so</font>

235
00:11:12,070 --> 00:11:19,720
let's verify<font color="#E5E5E5"> that we also know</font>

236
00:11:16,990 --> 00:11:21,399
this this machine was known to have

237
00:11:19,720 --> 00:11:25,240
connections to<font color="#CCCCCC"> a non command and control</font>

238
00:11:21,399 --> 00:11:28,089
server<font color="#CCCCCC"> it</font><font color="#E5E5E5"> has been identified by</font><font color="#CCCCCC"> the by</font>

239
00:11:25,240 --> 00:11:29,800
the<font color="#E5E5E5"> sock so we just validate that by</font>

240
00:11:28,089 --> 00:11:34,709
<font color="#E5E5E5">doing</font><font color="#CCCCCC"> that stat we can see there's a</font>

241
00:11:29,800 --> 00:11:37,060
connection<font color="#E5E5E5"> to</font><font color="#CCCCCC"> 1:3 1.25 higher and so on</font>

242
00:11:34,709 --> 00:11:41,229
<font color="#E5E5E5">so let's copy the tools from</font><font color="#CCCCCC"> the</font>

243
00:11:37,060 --> 00:11:43,449
<font color="#E5E5E5">container to the windows we CD to that</font>

244
00:11:41,230 --> 00:11:47,320
folder and then we are going<font color="#E5E5E5"> to start</font>

245
00:11:43,449 --> 00:11:49,439
process<font color="#E5E5E5"> Explorer with process Explorer</font>

246
00:11:47,320 --> 00:11:52,570
<font color="#E5E5E5">we can see that there's a PowerShell</font>

247
00:11:49,440 --> 00:11:55,870
process running we can<font color="#E5E5E5"> see the</font>

248
00:11:52,570 --> 00:11:58,000
connection<font color="#E5E5E5"> made by the</font><font color="#CCCCCC"> powershell but we</font>

249
00:11:55,870 --> 00:11:59,709
cannot<font color="#E5E5E5"> have</font><font color="#CCCCCC"> any detail because we are</font><font color="#E5E5E5"> in</font>

250
00:11:58,000 --> 00:12:01,269
<font color="#CCCCCC">privileged</font><font color="#E5E5E5"> and apparently this process</font>

251
00:11:59,709 --> 00:12:03,910
has<font color="#CCCCCC"> been started</font><font color="#E5E5E5"> with a higher instance</font>

252
00:12:01,269 --> 00:12:11,589
<font color="#E5E5E5">so we</font><font color="#CCCCCC"> have access denied</font><font color="#E5E5E5"> for the user or</font>

253
00:12:03,910 --> 00:12:13,990
the process<font color="#CCCCCC"> alright so we are</font><font color="#E5E5E5"> privileged</font>

254
00:12:11,589 --> 00:12:15,910
<font color="#E5E5E5">and we want to use</font><font color="#CCCCCC"> our tools</font><font color="#E5E5E5"> as</font>

255
00:12:13,990 --> 00:12:18,010
privileged user so<font color="#E5E5E5"> we are going to</font>

256
00:12:15,910 --> 00:12:20,050
demonstrate one<font color="#CCCCCC"> of the technique we</font><font color="#E5E5E5"> stop</font>

257
00:12:18,010 --> 00:12:23,589
the virtual machine with them the

258
00:12:20,050 --> 00:12:26,439
content<font color="#E5E5E5"> of the RAM on disk and then we</font>

259
00:12:23,589 --> 00:12:29,949
are going<font color="#E5E5E5"> to use a the interactive</font>

260
00:12:26,440 --> 00:12:34,990
console of volatility<font color="#E5E5E5"> to examine and</font>

261
00:12:29,949 --> 00:12:37,269
modify this<font color="#E5E5E5"> this memory file so first we</font>

262
00:12:34,990 --> 00:12:41,290
know that<font color="#CCCCCC"> on Windows the first first</font>

263
00:12:37,269 --> 00:12:44,860
process started is<font color="#E5E5E5"> score system and as a</font>

264
00:12:41,290 --> 00:12:46,980
fixed process ID<font color="#E5E5E5"> process ID</font><font color="#CCCCCC"> foe and it</font>

265
00:12:44,860 --> 00:12:51,699
has the<font color="#E5E5E5"> highest authority on the system</font>

266
00:12:46,980 --> 00:12:54,250
so we will<font color="#E5E5E5"> try to steal the security</font>

267
00:12:51,699 --> 00:12:58,269
token of that process and affected to

268
00:12:54,250 --> 00:13:02,019
our CMD dot exe<font color="#E5E5E5"> so highlighted we can</font>

269
00:12:58,269 --> 00:13:05,260
see the security<font color="#CCCCCC"> token of system process</font>

270
00:13:02,019 --> 00:13:07,810
<font color="#E5E5E5">we can see the offset of the security</font>

271
00:13:05,260 --> 00:13:11,350
token of CMD<font color="#E5E5E5"> dot exe so now that we</font>

272
00:13:07,810 --> 00:13:13,779
clean the memory<font color="#E5E5E5"> add the</font><font color="#CCCCCC"> offset of CMD</font>

273
00:13:11,350 --> 00:13:22,600
<font color="#E5E5E5">dot exe we will allocate the security</font>

274
00:13:13,779 --> 00:13:24,939
token of system so the the effect of

275
00:13:22,600 --> 00:13:27,670
that is<font color="#E5E5E5"> that by right if it works well</font>

276
00:13:24,940 --> 00:13:30,100
<font color="#CCCCCC">or CMD dot exe now should</font><font color="#E5E5E5"> be owned by</font>

277
00:13:27,670 --> 00:13:33,069
system<font color="#CCCCCC"> allowing us</font><font color="#E5E5E5"> to have</font>

278
00:13:30,100 --> 00:13:35,050
<font color="#E5E5E5">privilege on on</font><font color="#CCCCCC"> Windows so as you can</font>

279
00:13:33,069 --> 00:13:37,240
<font color="#E5E5E5">see now we are in</font><font color="#CCCCCC"> t system and we can</font>

280
00:13:35,050 --> 00:13:40,560
<font color="#E5E5E5">start a process Explorer that was</font>

281
00:13:37,240 --> 00:13:44,139
started from CMD as<font color="#E5E5E5"> NC Authority system</font>

282
00:13:40,560 --> 00:13:46,540
<font color="#E5E5E5">so now we can see it was</font><font color="#CCCCCC"> a bit fast</font><font color="#E5E5E5"> but</font>

283
00:13:44,139 --> 00:13:51,699
we can see the<font color="#E5E5E5"> command line arguments of</font>

284
00:13:46,540 --> 00:13:53,560
<font color="#CCCCCC">powershell</font><font color="#E5E5E5"> and for easier</font><font color="#CCCCCC"> decoding of</font>

285
00:13:51,699 --> 00:13:56,889
the<font color="#E5E5E5"> payload we will store it into</font>

286
00:13:53,560 --> 00:13:59,709
<font color="#CCCCCC">notepad</font><font color="#E5E5E5"> into a file and we will copy</font>

287
00:13:56,889 --> 00:14:01,870
<font color="#CCCCCC">that file via shot folder onto the</font>

288
00:13:59,709 --> 00:14:04,119
container<font color="#E5E5E5"> where the expert command</font>

289
00:14:01,870 --> 00:14:08,680
<font color="#CCCCCC">pilate's</font><font color="#E5E5E5"> it with all the Linux tools we</font>

290
00:14:04,120 --> 00:14:12,040
<font color="#CCCCCC">are familiar with so this</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> done now</font>

291
00:14:08,680 --> 00:14:14,949
from the container<font color="#CCCCCC"> we just can we</font>

292
00:14:12,040 --> 00:14:18,490
consider see our file and then we can

293
00:14:14,949 --> 00:14:24,339
use<font color="#CCCCCC"> base64 to decode the the payload</font>

294
00:14:18,490 --> 00:14:27,970
after removing<font color="#CCCCCC"> the unnecessary</font><font color="#E5E5E5"> star so</font>

295
00:14:24,339 --> 00:14:30,370
we<font color="#E5E5E5"> can see doing so that we</font><font color="#CCCCCC"> have the IP</font>

296
00:14:27,970 --> 00:14:33,220
address<font color="#CCCCCC"> highlighted one free one two</font>

297
00:14:30,370 --> 00:14:36,310
five and<font color="#E5E5E5"> it</font><font color="#CCCCCC"> is it was the the command</font>

298
00:14:33,220 --> 00:14:41,350
and control server<font color="#E5E5E5"> that the PowerShell</font>

299
00:14:36,310 --> 00:14:43,899
was connecting to<font color="#E5E5E5"> and we also can see a</font>

300
00:14:41,350 --> 00:14:49,410
security token<font color="#E5E5E5"> that was used for the</font>

301
00:14:43,899 --> 00:14:53,199
communication to avoid snooping<font color="#CCCCCC"> bye</font><font color="#E5E5E5"> bye</font>

302
00:14:49,410 --> 00:14:56,050
<font color="#E5E5E5">bye</font><font color="#CCCCCC"> analyst so that was the first demo</font>

303
00:14:53,199 --> 00:14:58,060
<font color="#CCCCCC">we managed to access the compromised</font>

304
00:14:56,050 --> 00:15:00,729
machine<font color="#CCCCCC"> we had we managed to perform</font><font color="#E5E5E5"> the</font>

305
00:14:58,060 --> 00:15:03,399
forensics analysis<font color="#CCCCCC"> on the live live</font>

306
00:15:00,730 --> 00:15:06,550
system when I mean<font color="#E5E5E5"> live it has been</font>

307
00:15:03,399 --> 00:15:09,189
booted up<font color="#E5E5E5"> but because of the mechanism</font>

308
00:15:06,550 --> 00:15:12,069
we have<font color="#E5E5E5"> explained earlier there is</font><font color="#CCCCCC"> no</font>

309
00:15:09,189 --> 00:15:14,800
<font color="#CCCCCC">trace on the machine</font><font color="#E5E5E5"> itself once we will</font>

310
00:15:12,069 --> 00:15:18,939
good everything is<font color="#E5E5E5"> calm</font><font color="#CCCCCC"> the second demo</font>

311
00:15:14,800 --> 00:15:20,829
we assume that<font color="#CCCCCC"> there is no user to</font><font color="#E5E5E5"> log</font>

312
00:15:18,939 --> 00:15:23,589
<font color="#CCCCCC">into the machine so we will have to</font>

313
00:15:20,829 --> 00:15:24,910
<font color="#E5E5E5">first find a</font><font color="#CCCCCC"> mechanism to login</font><font color="#E5E5E5"> and a</font>

314
00:15:23,589 --> 00:15:27,459
<font color="#E5E5E5">second</font><font color="#CCCCCC"> mechanism to elevate our</font>

315
00:15:24,910 --> 00:15:29,589
<font color="#E5E5E5">privilege the two technique that we are</font>

316
00:15:27,459 --> 00:15:31,839
demonstrating<font color="#E5E5E5"> here are commonly used in</font>

317
00:15:29,589 --> 00:15:35,589
penetration testing we didn't invent<font color="#E5E5E5"> it</font>

318
00:15:31,839 --> 00:15:37,120
specifically<font color="#E5E5E5"> so for this similar to the</font>

319
00:15:35,589 --> 00:15:39,490
first demo<font color="#E5E5E5"> but using another technique</font>

320
00:15:37,120 --> 00:15:41,620
<font color="#E5E5E5">we are using the</font><font color="#CCCCCC"> concept of virtual</font>

321
00:15:39,490 --> 00:15:43,520
machine where<font color="#CCCCCC"> we can save a snapshot so</font>

322
00:15:41,620 --> 00:15:47,899
we<font color="#E5E5E5"> saved</font><font color="#CCCCCC"> a snapshot on disk</font>

323
00:15:43,520 --> 00:15:50,630
using the safe<font color="#E5E5E5"> VM</font><font color="#CCCCCC"> command from Q</font><font color="#E5E5E5"> mu we</font>

324
00:15:47,899 --> 00:15:54,620
can<font color="#CCCCCC"> see the file that</font><font color="#E5E5E5"> is 500 over Meg</font><font color="#CCCCCC"> no</font>

325
00:15:50,630 --> 00:15:56,959
surprise<font color="#E5E5E5"> here and then directly with</font>

326
00:15:54,620 --> 00:16:00,370
<font color="#E5E5E5">exited we are going to modify that that</font>

327
00:15:56,959 --> 00:16:03,099
<font color="#CCCCCC">RAM</font><font color="#E5E5E5"> disk</font><font color="#CCCCCC"> at ROM file so we search for a</font>

328
00:16:00,370 --> 00:16:06,980
specific string that we have identified

329
00:16:03,100 --> 00:16:09,230
that<font color="#CCCCCC"> will contain basically</font><font color="#E5E5E5"> a registry</font>

330
00:16:06,980 --> 00:16:12,170
key<font color="#E5E5E5"> where the accessibility system is</font>

331
00:16:09,230 --> 00:16:16,820
working<font color="#E5E5E5"> and we</font><font color="#CCCCCC"> are</font><font color="#E5E5E5"> going to replace set</font>

332
00:16:12,170 --> 00:16:18,949
<font color="#CCCCCC">HC dot exe</font><font color="#E5E5E5"> by cmd.exe</font><font color="#CCCCCC"> that will be</font>

333
00:16:16,820 --> 00:16:20,870
convenient for<font color="#E5E5E5"> us just a quick comment</font>

334
00:16:18,950 --> 00:16:24,170
<font color="#E5E5E5">the set HC is the</font><font color="#CCCCCC"> Windows standard</font>

335
00:16:20,870 --> 00:16:26,570
executable that<font color="#CCCCCC"> is started whenever you</font>

336
00:16:24,170 --> 00:16:28,790
press shift<font color="#CCCCCC"> 5 times by default</font><font color="#E5E5E5"> Windows</font>

337
00:16:26,570 --> 00:16:30,709
starts<font color="#E5E5E5"> enable any context of any process</font>

338
00:16:28,790 --> 00:16:32,870
<font color="#E5E5E5">whatever your bin Laden over at</font><font color="#CCCCCC"> logged</font>

339
00:16:30,709 --> 00:16:34,969
<font color="#E5E5E5">in session that one is designed to</font>

340
00:16:32,870 --> 00:16:38,089
enable high contrast theme for people

341
00:16:34,970 --> 00:16:41,390
with<font color="#E5E5E5"> no lower eyesight record well I</font>

342
00:16:38,089 --> 00:16:44,510
said so<font color="#CCCCCC"> and</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> the registry hive in</font>

343
00:16:41,390 --> 00:16:47,510
<font color="#E5E5E5">the</font><font color="#CCCCCC"> RAM</font><font color="#E5E5E5"> of Windows OS that we have just</font>

344
00:16:44,510 --> 00:16:49,700
modified to<font color="#E5E5E5"> seem</font><font color="#CCCCCC"> the x/z</font><font color="#E5E5E5"> you see they</font>

345
00:16:47,510 --> 00:16:52,250
change<font color="#E5E5E5"> from set</font><font color="#CCCCCC"> HDX you</font><font color="#E5E5E5"> are going to</font>

346
00:16:49,700 --> 00:16:55,310
start seeing<font color="#E5E5E5"> the XZ by pressing shift by</font>

347
00:16:52,250 --> 00:16:58,370
x so we have directly modified the

348
00:16:55,310 --> 00:17:00,199
snapshot of the virtual machine<font color="#E5E5E5"> and now</font>

349
00:16:58,370 --> 00:17:03,800
we just<font color="#E5E5E5"> need to restore the snapshot and</font>

350
00:17:00,200 --> 00:17:05,660
by restoring<font color="#E5E5E5"> the snapshot</font><font color="#CCCCCC"> when when</font>

351
00:17:03,800 --> 00:17:07,819
window<font color="#E5E5E5"> when windows will resume the</font>

352
00:17:05,660 --> 00:17:11,150
execution we indeed should have place

353
00:17:07,819 --> 00:17:15,050
<font color="#CCCCCC">our trick so we are pressing 5 times</font><font color="#E5E5E5"> the</font>

354
00:17:11,150 --> 00:17:17,270
shift key and then<font color="#E5E5E5"> a console comes in</font><font color="#CCCCCC"> -</font>

355
00:17:15,050 --> 00:17:19,250
for<font color="#E5E5E5"> convenience we are just going to</font>

356
00:17:17,270 --> 00:17:22,129
<font color="#E5E5E5">change</font><font color="#CCCCCC"> the password</font><font color="#E5E5E5"> of a privileged user</font>

357
00:17:19,250 --> 00:17:26,059
<font color="#E5E5E5">but we could have added our own or many</font>

358
00:17:22,130 --> 00:17:27,709
other<font color="#E5E5E5"> tricks</font><font color="#CCCCCC"> to to login so now that</font><font color="#E5E5E5"> we</font>

359
00:17:26,059 --> 00:17:31,070
<font color="#E5E5E5">have change a password by tapping 1 2 3</font>

360
00:17:27,709 --> 00:17:44,630
<font color="#E5E5E5">as a privileged</font><font color="#CCCCCC"> user we can login as</font>

361
00:17:31,070 --> 00:17:47,750
<font color="#CCCCCC">administrator alright so now we want</font><font color="#E5E5E5"> to</font>

362
00:17:44,630 --> 00:17:50,500
have<font color="#CCCCCC"> access to the to the filesystem and</font>

363
00:17:47,750 --> 00:17:54,559
<font color="#E5E5E5">do more analysis because you will see</font>

364
00:17:50,500 --> 00:17:56,900
<font color="#E5E5E5">after copying some of the tools we we</font>

365
00:17:54,559 --> 00:17:59,180
identified as a malicious file

366
00:17:56,900 --> 00:18:01,130
and we can't do<font color="#CCCCCC"> anything</font><font color="#E5E5E5"> from from</font>

367
00:17:59,180 --> 00:18:02,720
<font color="#CCCCCC">windows itself it's</font><font color="#E5E5E5"> actually a good kid</font>

368
00:18:01,130 --> 00:18:08,810
<font color="#E5E5E5">and the</font><font color="#CCCCCC"> rootkit is preventing us</font><font color="#E5E5E5"> from</font>

369
00:18:02,720 --> 00:18:10,820
doing<font color="#CCCCCC"> the</font><font color="#E5E5E5"> analysis directly so after</font>

370
00:18:08,810 --> 00:18:13,490
copying our files we<font color="#E5E5E5"> go to the to the</font>

371
00:18:10,820 --> 00:18:15,200
folder and we will start Sara<font color="#CCCCCC"> Yara is a</font>

372
00:18:13,490 --> 00:18:17,840
tool<font color="#CCCCCC"> that will search for specific</font>

373
00:18:15,200 --> 00:18:21,950
patterns on the<font color="#CCCCCC"> disk</font><font color="#E5E5E5"> on any of the file</font>

374
00:18:17,840 --> 00:18:25,010
<font color="#E5E5E5">and we are looking for</font><font color="#CCCCCC"> some generic</font>

375
00:18:21,950 --> 00:18:27,800
malware signatures<font color="#E5E5E5"> and we</font><font color="#CCCCCC"> see that</font><font color="#E5E5E5"> there</font>

376
00:18:25,010 --> 00:18:31,220
are two files<font color="#CCCCCC"> that cannot</font><font color="#E5E5E5"> be open we can</font>

377
00:18:27,800 --> 00:18:32,770
see<font color="#E5E5E5"> NTFS</font><font color="#CCCCCC"> that sees that</font><font color="#E5E5E5"> we will not</font>

378
00:18:31,220 --> 00:18:35,330
<font color="#E5E5E5">analyze and we can see something</font>

379
00:18:32,770 --> 00:18:40,070
<font color="#CCCCCC">suspicious at least from</font><font color="#E5E5E5"> the name her</font>

380
00:18:35,330 --> 00:18:43,520
<font color="#E5E5E5">killer</font><font color="#CCCCCC"> dodges so if we go now with the</font>

381
00:18:40,070 --> 00:18:46,250
Explorer to the driver folder<font color="#CCCCCC"> under</font>

382
00:18:43,520 --> 00:18:48,230
system 22 so<font color="#CCCCCC"> we're going to show</font><font color="#E5E5E5"> you</font>

383
00:18:46,250 --> 00:18:53,750
some side effects of rootkit activity on

384
00:18:48,230 --> 00:18:56,450
your<font color="#E5E5E5"> systems so</font><font color="#CCCCCC"> we can</font><font color="#E5E5E5"> see the the per</font>

385
00:18:53,750 --> 00:18:56,990
kilo<font color="#E5E5E5"> dot this file so the file itself is</font>

386
00:18:56,450 --> 00:18:59,210
<font color="#E5E5E5">not hidden</font>

387
00:18:56,990 --> 00:19:01,460
however by looking at the<font color="#CCCCCC"> properties of</font>

388
00:18:59,210 --> 00:19:04,730
the file<font color="#E5E5E5"> we don't have access</font><font color="#CCCCCC"> to any of</font>

389
00:19:01,460 --> 00:19:09,320
<font color="#E5E5E5">the security information or any other</font>

390
00:19:04,730 --> 00:19:11,150
meaningful<font color="#E5E5E5"> they detail about it then we</font>

391
00:19:09,320 --> 00:19:14,149
<font color="#E5E5E5">we decided to copy the file somewhere</font>

392
00:19:11,150 --> 00:19:15,740
else<font color="#CCCCCC"> so first we</font><font color="#E5E5E5"> have some Samara</font><font color="#CCCCCC"> by</font>

393
00:19:14,150 --> 00:19:19,250
looking at the<font color="#E5E5E5"> properties when we copy</font>

394
00:19:15,740 --> 00:19:24,920
it<font color="#CCCCCC"> let's say on the</font><font color="#E5E5E5"> desktop then we have</font>

395
00:19:19,250 --> 00:19:26,810
yet another error we can<font color="#E5E5E5"> see the if I</font>

396
00:19:24,920 --> 00:19:31,880
actually<font color="#CCCCCC"> copy</font><font color="#E5E5E5"> it actually says that the</font>

397
00:19:26,810 --> 00:19:34,220
CD is not inserted into the<font color="#E5E5E5"> drive</font><font color="#CCCCCC"> see so</font>

398
00:19:31,880 --> 00:19:36,320
if we<font color="#E5E5E5"> create a file here folder called</font>

399
00:19:34,220 --> 00:19:38,810
<font color="#CCCCCC">Bakula there is no problem however if we</font>

400
00:19:36,320 --> 00:19:40,429
rename that file per kilo<font color="#CCCCCC"> dot sees the</font>

401
00:19:38,810 --> 00:19:51,050
system will not<font color="#E5E5E5"> allow</font><font color="#CCCCCC"> us to do</font><font color="#E5E5E5"> some</font>

402
00:19:40,430 --> 00:19:53,570
<font color="#E5E5E5">similar error so we maybe we should be</font>

403
00:19:51,050 --> 00:19:56,570
tempted<font color="#CCCCCC"> to open</font><font color="#E5E5E5"> the file</font><font color="#CCCCCC"> I was not paid</font>

404
00:19:53,570 --> 00:19:58,550
or<font color="#E5E5E5"> any other tool so by starting notepad</font>

405
00:19:56,570 --> 00:20:01,010
on that specific file<font color="#CCCCCC"> we should see the</font>

406
00:19:58,550 --> 00:20:03,620
content rightfully<font color="#CCCCCC"> note that is my</font>

407
00:20:01,010 --> 00:20:05,330
<font color="#CCCCCC">favorite interrogate - you can detect</font>

408
00:20:03,620 --> 00:20:07,610
the presence<font color="#E5E5E5"> by just opening the file</font>

409
00:20:05,330 --> 00:20:09,669
and all kind of<font color="#E5E5E5"> awkward messages will</font>

410
00:20:07,610 --> 00:20:09,669
appear

411
00:20:09,730 --> 00:20:13,870
and if we try to<font color="#E5E5E5"> open</font><font color="#CCCCCC"> it directly from</font>

412
00:20:11,409 --> 00:20:17,019
<font color="#CCCCCC">the from</font><font color="#E5E5E5"> the UI</font><font color="#CCCCCC"> we will have the same</font>

413
00:20:13,870 --> 00:20:20,350
<font color="#E5E5E5">some kind of error it's a bit different</font>

414
00:20:17,019 --> 00:20:21,700
<font color="#CCCCCC">yeah I just occurred</font><font color="#E5E5E5"> because it says</font>

415
00:20:20,350 --> 00:20:31,570
<font color="#CCCCCC">that</font><font color="#E5E5E5"> the drive see probably is not</font>

416
00:20:21,700 --> 00:20:34,330
<font color="#CCCCCC">formatted</font><font color="#E5E5E5"> all right so we need to find a</font>

417
00:20:31,570 --> 00:20:37,240
way<font color="#E5E5E5"> to access</font><font color="#CCCCCC"> it so one of the technique</font>

418
00:20:34,330 --> 00:20:38,580
<font color="#CCCCCC">that we found again</font><font color="#E5E5E5"> it is not that the</font>

419
00:20:37,240 --> 00:20:41,320
purpose of<font color="#E5E5E5"> this presentation is not</font>

420
00:20:38,580 --> 00:20:42,399
<font color="#E5E5E5">specifically to show all the techniques</font>

421
00:20:41,320 --> 00:20:44,649
<font color="#CCCCCC">to the 4 & 6</font>

422
00:20:42,399 --> 00:20:47,439
but leverage the capability of bit<font color="#CCCCCC"> Scout</font>

423
00:20:44,649 --> 00:20:50,080
<font color="#E5E5E5">to boot</font><font color="#CCCCCC"> virtual machine and have a lot</font>

424
00:20:47,440 --> 00:20:51,639
<font color="#CCCCCC">of access just this is more applicable</font>

425
00:20:50,080 --> 00:20:53,408
for<font color="#CCCCCC"> three</font><font color="#E5E5E5"> are actually when you can</font>

426
00:20:51,639 --> 00:20:54,639
actually<font color="#CCCCCC"> interact with</font><font color="#E5E5E5"> the system</font><font color="#CCCCCC"> and</font>

427
00:20:53,409 --> 00:20:56,200
you<font color="#CCCCCC"> see the</font><font color="#E5E5E5"> traffic you see</font><font color="#CCCCCC"> the</font>

428
00:20:54,639 --> 00:20:59,350
<font color="#E5E5E5">processes you</font><font color="#CCCCCC"> can dump them opinions</font>

429
00:20:56,200 --> 00:21:00,850
<font color="#E5E5E5">inspect them in the lab and you can even</font>

430
00:20:59,350 --> 00:21:02,379
<font color="#E5E5E5">install security products if</font><font color="#CCCCCC"> you want</font>

431
00:21:00,850 --> 00:21:08,340
like a scanner and then goes<font color="#CCCCCC"> through</font><font color="#E5E5E5"> the</font>

432
00:21:02,380 --> 00:21:11,440
whole<font color="#CCCCCC"> Drive so here I just started a</font>

433
00:21:08,340 --> 00:21:12,039
process called<font color="#CCCCCC"> network</font><font color="#E5E5E5"> black device</font>

434
00:21:11,440 --> 00:21:16,360
server

435
00:21:12,039 --> 00:21:18,399
it<font color="#E5E5E5"> will basically map the content of the</font>

436
00:21:16,360 --> 00:21:23,010
<font color="#E5E5E5">disk and expose it as a service so that</font>

437
00:21:18,399 --> 00:21:23,010
<font color="#E5E5E5">from the container</font><font color="#CCCCCC"> we can</font><font color="#E5E5E5"> connect to it</font>

438
00:21:23,409 --> 00:21:29,019
this requires<font color="#E5E5E5"> elevation or privilege so</font>

439
00:21:26,769 --> 00:21:32,799
as a supervised mode the owner as to

440
00:21:29,019 --> 00:21:35,950
allow this specific<font color="#CCCCCC"> command once the</font>

441
00:21:32,799 --> 00:21:38,649
command<font color="#E5E5E5"> is exposed we can see the the</font>

442
00:21:35,950 --> 00:21:41,169
server itself is responding<font color="#E5E5E5"> and serving</font>

443
00:21:38,649 --> 00:21:44,229
the<font color="#E5E5E5"> content of the of the disk that is</font>

444
00:21:41,169 --> 00:21:47,200
required<font color="#E5E5E5"> and therefore we know we can</font>

445
00:21:44,230 --> 00:21:53,289
have access<font color="#E5E5E5"> to the disk so now we just</font>

446
00:21:47,200 --> 00:21:55,330
<font color="#CCCCCC">need to so</font><font color="#E5E5E5"> that the file</font><font color="#CCCCCC"> is actually on</font>

447
00:21:53,289 --> 00:21:57,610
the disk<font color="#E5E5E5"> just a few words actually this</font>

448
00:21:55,330 --> 00:21:59,769
network<font color="#CCCCCC"> blog device you can export it</font>

449
00:21:57,610 --> 00:22:01,330
right from the VM<font color="#E5E5E5"> all the network all</font>

450
00:21:59,769 --> 00:22:02,830
<font color="#CCCCCC">the internet somewhere in a different</font>

451
00:22:01,330 --> 00:22:06,850
place so<font color="#E5E5E5"> you'll see the blog device</font>

452
00:22:02,830 --> 00:22:08,769
which is of size<font color="#CCCCCC"> equal to the</font><font color="#E5E5E5"> drive on</font>

453
00:22:06,850 --> 00:22:11,769
that<font color="#E5E5E5"> impacted system you can access any</font>

454
00:22:08,769 --> 00:22:15,279
sector any byte all the tcp/ip<font color="#E5E5E5"> without</font>

455
00:22:11,769 --> 00:22:19,679
copying the whole image<font color="#E5E5E5"> so since we have</font>

456
00:22:15,279 --> 00:22:21,430
this<font color="#E5E5E5"> network device file that can be</font>

457
00:22:19,679 --> 00:22:25,090
exposed

458
00:22:21,430 --> 00:22:28,240
we will we<font color="#CCCCCC"> will try to</font><font color="#E5E5E5"> mount it and</font>

459
00:22:25,090 --> 00:22:31,059
expose<font color="#E5E5E5"> it to the system first we can</font><font color="#CCCCCC"> use</font>

460
00:22:28,240 --> 00:22:34,330
a<font color="#CCCCCC"> fellas from slow skid</font><font color="#E5E5E5"> to look</font>

461
00:22:31,059 --> 00:22:37,690
specifically for<font color="#E5E5E5"> the the offset of all</font>

462
00:22:34,330 --> 00:22:39,460
the files and<font color="#CCCCCC"> metadata associated so we</font>

463
00:22:37,690 --> 00:22:42,730
can see some reading we<font color="#E5E5E5"> can see the</font>

464
00:22:39,460 --> 00:22:51,010
content<font color="#E5E5E5"> of the of the filesystem</font>

465
00:22:42,730 --> 00:22:58,330
<font color="#CCCCCC">and we</font><font color="#E5E5E5"> can identify our file and so we</font>

466
00:22:51,010 --> 00:23:00,700
can either identify our file<font color="#E5E5E5"> all right</font>

467
00:22:58,330 --> 00:23:07,870
<font color="#E5E5E5">so popular Pecola is here we can we can</font>

468
00:23:00,700 --> 00:23:11,290
see it<font color="#E5E5E5"> now</font><font color="#CCCCCC"> let's mount the</font><font color="#E5E5E5"> last one the</font>

469
00:23:07,870 --> 00:23:15,520
disk using<font color="#E5E5E5"> the mount command</font><font color="#CCCCCC"> and we will</font>

470
00:23:11,290 --> 00:23:17,740
create a<font color="#CCCCCC"> Amenti</font><font color="#E5E5E5"> C Drive once it is</font>

471
00:23:15,520 --> 00:23:20,200
mounted we just can access the remote

472
00:23:17,740 --> 00:23:22,840
filesystem<font color="#E5E5E5"> as if it was local and we can</font>

473
00:23:20,200 --> 00:23:26,140
see the content of<font color="#E5E5E5"> the file and we</font><font color="#CCCCCC"> can</font>

474
00:23:22,840 --> 00:23:27,510
see oops sorry<font color="#E5E5E5"> yeah we could see the</font>

475
00:23:26,140 --> 00:23:30,640
content of<font color="#E5E5E5"> the file and it was</font>

476
00:23:27,510 --> 00:23:33,640
executable<font color="#E5E5E5"> and now we can copy and do</font>

477
00:23:30,640 --> 00:23:35,050
the analysis of the of the rootkit<font color="#E5E5E5"> so</font>

478
00:23:33,640 --> 00:23:37,510
just to<font color="#E5E5E5"> summarize</font><font color="#CCCCCC"> what happened in the</font>

479
00:23:35,050 --> 00:23:40,360
previous<font color="#CCCCCC"> demo we started the VM on</font><font color="#E5E5E5"> the</font>

480
00:23:37,510 --> 00:23:42,970
original system with with<font color="#CCCCCC"> write</font>

481
00:23:40,360 --> 00:23:45,909
protection<font color="#E5E5E5"> then we started the NBD</font>

482
00:23:42,970 --> 00:23:47,320
server service<font color="#E5E5E5"> inside of that VM and</font>

483
00:23:45,910 --> 00:23:49,450
<font color="#E5E5E5">then we kind of</font><font color="#CCCCCC"> exported</font><font color="#E5E5E5"> already</font>

484
00:23:47,320 --> 00:23:51,520
decrypted block block device the drive

485
00:23:49,450 --> 00:23:54,520
see that we can access<font color="#E5E5E5"> all the network</font>

486
00:23:51,520 --> 00:23:56,470
we<font color="#CCCCCC"> can mount</font><font color="#E5E5E5"> it to our own system and</font>

487
00:23:54,520 --> 00:24:01,270
then export any files that<font color="#E5E5E5"> you want to</font>

488
00:23:56,470 --> 00:24:04,660
rank<font color="#E5E5E5"> as any</font><font color="#CCCCCC"> files that we want now</font><font color="#E5E5E5"> we</font>

489
00:24:01,270 --> 00:24:06,580
will level<font color="#E5E5E5"> it up a little bit so imagine</font>

490
00:24:04,660 --> 00:24:08,920
that we<font color="#E5E5E5"> have an ST a malware that</font>

491
00:24:06,580 --> 00:24:11,428
actually killed the system so Windows

492
00:24:08,920 --> 00:24:15,309
doesn't<font color="#CCCCCC"> even start in</font><font color="#E5E5E5"> Safe Mode in</font>

493
00:24:11,429 --> 00:24:17,320
regular in normal mode and what can we

494
00:24:15,309 --> 00:24:19,178
do can we<font color="#E5E5E5"> still extract files if we</font>

495
00:24:17,320 --> 00:24:21,760
<font color="#CCCCCC">cannot leverage</font><font color="#E5E5E5"> Windows itself we cannot</font>

496
00:24:19,179 --> 00:24:23,920
start<font color="#E5E5E5"> NDB service anymore so there is no</font>

497
00:24:21,760 --> 00:24:25,510
<font color="#E5E5E5">windows</font><font color="#CCCCCC"> process that</font><font color="#E5E5E5"> started it just</font>

498
00:24:23,920 --> 00:24:28,990
<font color="#E5E5E5">goes into the blue screen whenever we</font>

499
00:24:25,510 --> 00:24:31,090
try to boot it just a quick example<font color="#CCCCCC"> of</font>

500
00:24:28,990 --> 00:24:32,980
<font color="#CCCCCC">that so it can be due to incredible</font>

501
00:24:31,090 --> 00:24:34,418
<font color="#E5E5E5">incompatibility with Windows version or</font>

502
00:24:32,980 --> 00:24:37,139
just buggy

503
00:24:34,419 --> 00:24:42,190
kid<font color="#E5E5E5"> so what can we do with such system</font>

504
00:24:37,139 --> 00:24:45,100
so we're gonna copy some Python<font color="#CCCCCC"> tools</font>

505
00:24:42,190 --> 00:24:47,139
<font color="#E5E5E5">minor tools that we created for this</font>

506
00:24:45,100 --> 00:24:49,059
particular<font color="#E5E5E5"> scenario and you show you</font>

507
00:24:47,139 --> 00:24:52,090
<font color="#E5E5E5">some</font><font color="#CCCCCC"> additional</font><font color="#E5E5E5"> techniques so first</font>

508
00:24:49,059 --> 00:24:54,759
you'll create files pipes that we will

509
00:24:52,090 --> 00:24:57,100
attach to<font color="#E5E5E5"> the virtual machines</font><font color="#CCCCCC"> comp or</font>

510
00:24:54,759 --> 00:24:58,899
serial port we're going to use that to

511
00:24:57,100 --> 00:25:01,119
communicate<font color="#E5E5E5"> with some of the code</font><font color="#CCCCCC"> inside</font>

512
00:24:58,899 --> 00:25:03,939
<font color="#E5E5E5">of</font><font color="#CCCCCC"> the VM</font><font color="#E5E5E5"> so we're</font><font color="#CCCCCC"> going to actually</font>

513
00:25:01,119 --> 00:25:07,649
patch the brain of the VM using the

514
00:25:03,940 --> 00:25:07,649
debugger<font color="#E5E5E5"> attached to the hypervisor</font><font color="#CCCCCC"> so</font>

515
00:25:08,700 --> 00:25:12,909
<font color="#CCCCCC">first we created these pipes</font><font color="#E5E5E5"> this is for</font>

516
00:25:11,200 --> 00:25:15,850
input<font color="#CCCCCC"> and output from the serial port</font>

517
00:25:12,909 --> 00:25:19,769
<font color="#CCCCCC">then</font><font color="#E5E5E5"> we are going</font><font color="#CCCCCC"> to start key mu and</font>

518
00:25:15,850 --> 00:25:22,209
you<font color="#CCCCCC"> can see it's attached to the same</font>

519
00:25:19,769 --> 00:25:24,159
<font color="#CCCCCC">defile this will start</font><font color="#E5E5E5"> the debugger and</font>

520
00:25:22,210 --> 00:25:26,769
<font color="#E5E5E5">the machine in the suspected and</font>

521
00:25:24,159 --> 00:25:29,259
suspended mode<font color="#E5E5E5"> then we</font><font color="#CCCCCC"> see that we</font>

522
00:25:26,769 --> 00:25:32,710
specify the become one shall be attached

523
00:25:29,259 --> 00:25:36,730
to<font color="#CCCCCC"> the guest or serial pair of files it</font>

524
00:25:32,710 --> 00:25:39,549
automatically<font color="#CCCCCC"> appends dot</font><font color="#E5E5E5"> in dot out so</font>

525
00:25:36,730 --> 00:25:43,600
once we<font color="#E5E5E5"> run it machine is suspended now</font>

526
00:25:39,549 --> 00:25:46,289
so next let's see<font color="#E5E5E5"> what we see the screen</font>

527
00:25:43,600 --> 00:25:49,509
oh sure<font color="#CCCCCC"> there's blacks</font><font color="#E5E5E5"> I will skip that</font>

528
00:25:46,289 --> 00:25:52,859
<font color="#CCCCCC">next we attach the debugger to that to</font>

529
00:25:49,509 --> 00:25:56,559
<font color="#CCCCCC">that machine so gdb now is attached to</font>

530
00:25:52,859 --> 00:25:58,149
<font color="#E5E5E5">to the guest within the VM so what we</font>

531
00:25:56,559 --> 00:26:01,090
<font color="#E5E5E5">will do next you set a breakpoint at</font>

532
00:25:58,149 --> 00:26:06,668
this magic position which is where a

533
00:26:01,090 --> 00:26:08,080
bias of PC loads the the MBR code<font color="#E5E5E5"> this</font>

534
00:26:06,669 --> 00:26:12,039
<font color="#E5E5E5">is what will be the first byte</font><font color="#CCCCCC"> I've</font>

535
00:26:08,080 --> 00:26:18,279
executed<font color="#E5E5E5"> when you start the PC</font><font color="#CCCCCC"> taking</font>

536
00:26:12,039 --> 00:26:19,899
from the disk<font color="#E5E5E5"> so first we press continue</font>

537
00:26:18,279 --> 00:26:22,629
in the debugger<font color="#CCCCCC"> and this is where the</font>

538
00:26:19,899 --> 00:26:25,178
<font color="#E5E5E5">first breakpoint it is</font><font color="#CCCCCC"> and it hits and</font>

539
00:26:22,629 --> 00:26:27,730
this is where full disk encryption loads

540
00:26:25,179 --> 00:26:30,340
its support word decrypt encoder drag to

541
00:26:27,730 --> 00:26:33,340
let<font color="#CCCCCC"> windows</font><font color="#E5E5E5"> boot it sets up certain</font>

542
00:26:30,340 --> 00:26:35,949
hooks and or the<font color="#E5E5E5"> interrupt for this guy</font>

543
00:26:33,340 --> 00:26:39,399
or<font color="#CCCCCC"> interrupts to enable transparent</font>

544
00:26:35,950 --> 00:26:44,820
<font color="#E5E5E5">access to to the drive and</font><font color="#CCCCCC"> that code</font>

545
00:26:39,399 --> 00:26:44,820
works in in the real<font color="#CCCCCC"> mode so</font>

546
00:26:45,220 --> 00:26:49,390
after that the two<font color="#E5E5E5"> disk encryption</font>

547
00:26:47,950 --> 00:26:52,210
sharks will recover the<font color="#E5E5E5"> original</font>

548
00:26:49,390 --> 00:26:54,880
<font color="#E5E5E5">Microsoft Windows MBR and start</font>

549
00:26:52,210 --> 00:26:58,350
<font color="#E5E5E5">executing that with the hooks for</font><font color="#CCCCCC"> the</font>

550
00:26:54,880 --> 00:27:02,169
disk i/o setup<font color="#E5E5E5"> so we're gonna continue</font>

551
00:26:58,350 --> 00:27:03,969
again to see when it hits second time<font color="#E5E5E5"> so</font>

552
00:27:02,169 --> 00:27:05,590
now the full disk encryption software

553
00:27:03,970 --> 00:27:10,299
<font color="#CCCCCC">asked us for</font><font color="#E5E5E5"> the password</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> once we</font>

554
00:27:05,590 --> 00:27:13,629
<font color="#E5E5E5">enter this we hit our break point</font><font color="#CCCCCC"> so now</font>

555
00:27:10,299 --> 00:27:18,250
if<font color="#E5E5E5"> you</font><font color="#CCCCCC"> look at</font><font color="#E5E5E5"> the location</font><font color="#CCCCCC"> of this 7000</font>

556
00:27:13,630 --> 00:27:24,100
in in the<font color="#E5E5E5"> RAM</font><font color="#CCCCCC"> there will be original</font>

557
00:27:18,250 --> 00:27:27,280
Microsoft<font color="#CCCCCC"> in the our code so at this</font>

558
00:27:24,100 --> 00:27:29,620
<font color="#E5E5E5">stage this transparent</font><font color="#CCCCCC"> access to the</font>

559
00:27:27,280 --> 00:27:32,168
encrypted<font color="#E5E5E5"> sectors is set up and we're</font>

560
00:27:29,620 --> 00:27:34,239
<font color="#CCCCCC">going to</font><font color="#E5E5E5"> leverage this so we will put</font>

561
00:27:32,169 --> 00:27:37,030
our own<font color="#E5E5E5"> code instead of the Microsoft</font>

562
00:27:34,240 --> 00:27:39,429
<font color="#CCCCCC">MDR will be like a tiny implant that</font>

563
00:27:37,030 --> 00:27:42,520
actually listens<font color="#CCCCCC"> put the serial port to</font>

564
00:27:39,429 --> 00:27:45,039
<font color="#CCCCCC">the comm port and it can help us read</font>

565
00:27:42,520 --> 00:27:47,650
the<font color="#CCCCCC"> sector's so how do we actually put</font>

566
00:27:45,039 --> 00:27:49,510
this into the<font color="#CCCCCC"> RAM of</font><font color="#E5E5E5"> the of the guest</font>

567
00:27:47,650 --> 00:27:52,539
<font color="#E5E5E5">but this</font><font color="#CCCCCC"> will leverage</font>

568
00:27:49,510 --> 00:27:54,549
<font color="#E5E5E5">Linux feature to expose memory maps of</font>

569
00:27:52,539 --> 00:27:57,789
the processes so you can see there is a

570
00:27:54,549 --> 00:27:59,168
file<font color="#CCCCCC"> that</font><font color="#E5E5E5"> is inside of</font><font color="#CCCCCC"> the every where</font>

571
00:27:57,789 --> 00:28:01,179
every process there is<font color="#CCCCCC"> a file</font><font color="#E5E5E5"> in the</font>

572
00:27:59,169 --> 00:28:02,500
root<font color="#CCCCCC"> filesystem where the memory maps</font>

573
00:28:01,179 --> 00:28:04,390
are exposed this<font color="#E5E5E5"> is the beginning and</font>

574
00:28:02,500 --> 00:28:05,799
<font color="#E5E5E5">the end of the of the map corresponding</font>

575
00:28:04,390 --> 00:28:09,520
<font color="#CCCCCC">to</font><font color="#E5E5E5"> certain module loaded into the</font>

576
00:28:05,799 --> 00:28:14,799
process of qmo so our<font color="#E5E5E5"> task is to</font><font color="#CCCCCC"> find</font>

577
00:28:09,520 --> 00:28:19,179
<font color="#E5E5E5">the largest memory region that shall by</font>

578
00:28:14,799 --> 00:28:21,460
size<font color="#E5E5E5"> be equal to the size of power.yes</font>

579
00:28:19,179 --> 00:28:24,700
<font color="#CCCCCC">ram so we're going to</font><font color="#E5E5E5"> do a little bit of</font>

580
00:28:21,460 --> 00:28:28,929
shell scripting<font color="#E5E5E5"> sort and find the</font>

581
00:28:24,700 --> 00:28:31,120
<font color="#E5E5E5">largest the largest region of allocated</font>

582
00:28:28,929 --> 00:28:37,330
memory inside of qmo process to patch

583
00:28:31,120 --> 00:28:39,850
its memory<font color="#E5E5E5"> live</font><font color="#CCCCCC"> see so you get an ADD</font>

584
00:28:37,330 --> 00:28:42,520
sort by the first column which

585
00:28:39,850 --> 00:28:45,610
represents<font color="#CCCCCC"> the size</font><font color="#E5E5E5"> of the region so you</font>

586
00:28:42,520 --> 00:28:48,460
can see here<font color="#CCCCCC"> five three six millions by</font>

587
00:28:45,610 --> 00:28:50,678
<font color="#CCCCCC">it's actually 512 megabytes which is</font>

588
00:28:48,460 --> 00:28:52,960
equal<font color="#E5E5E5"> to RM so now we will</font><font color="#CCCCCC"> use this</font>

589
00:28:50,679 --> 00:28:57,770
<font color="#E5E5E5">simple Python</font><font color="#CCCCCC"> script that opens</font><font color="#E5E5E5"> another</font>

590
00:28:52,960 --> 00:29:00,920
file inside<font color="#E5E5E5"> of the process inside the</font>

591
00:28:57,770 --> 00:29:04,940
<font color="#CCCCCC">a subsystem</font><font color="#E5E5E5"> and the file called ma'am</font>

592
00:29:00,920 --> 00:29:08,240
<font color="#E5E5E5">contains physical memory</font><font color="#CCCCCC"> both attributes</font>

593
00:29:04,940 --> 00:29:11,990
<font color="#CCCCCC">all memory of the process</font><font color="#E5E5E5"> corresponding</font>

594
00:29:08,240 --> 00:29:14,270
<font color="#E5E5E5">to</font><font color="#CCCCCC"> qmo this is how we can</font><font color="#E5E5E5"> access any</font>

595
00:29:11,990 --> 00:29:16,880
region inside and patch memory of<font color="#CCCCCC"> qiyama</font>

596
00:29:14,270 --> 00:29:20,660
<font color="#CCCCCC">live by this we will patch the memory of</font>

597
00:29:16,880 --> 00:29:25,430
the<font color="#E5E5E5"> guest as well so you use the script</font>

598
00:29:20,660 --> 00:29:28,070
<font color="#E5E5E5">to insert this tiny snippet of code in</font>

599
00:29:25,430 --> 00:29:32,780
16-bit assembler that will do the job

600
00:29:28,070 --> 00:29:35,960
for us the rest<font color="#E5E5E5"> of</font><font color="#CCCCCC"> the job so</font><font color="#E5E5E5"> okay this</font>

601
00:29:32,780 --> 00:29:40,100
first bytes<font color="#E5E5E5"> so once we run it you can</font>

602
00:29:35,960 --> 00:29:41,900
<font color="#CCCCCC">see that MBR has</font><font color="#E5E5E5"> changed so and now it</font>

603
00:29:40,100 --> 00:29:43,730
will be executed<font color="#CCCCCC"> under</font><font color="#E5E5E5"> reason infinite</font>

604
00:29:41,900 --> 00:29:46,960
loop where it listens<font color="#E5E5E5"> for commands</font>

605
00:29:43,730 --> 00:30:00,110
<font color="#CCCCCC">overcome work and dust</font><font color="#E5E5E5"> discrete and</font>

606
00:29:46,960 --> 00:30:02,330
discrete operations so next we are

607
00:30:00,110 --> 00:30:04,639
continuing the the<font color="#E5E5E5"> guest so you see that</font>

608
00:30:02,330 --> 00:30:06,530
actually<font color="#E5E5E5"> it sticks</font>

609
00:30:04,640 --> 00:30:11,600
sorry it's it gets<font color="#E5E5E5"> stuck in in the</font>

610
00:30:06,530 --> 00:30:14,030
internet loop and then I wanted<font color="#CCCCCC"> to show</font>

611
00:30:11,600 --> 00:30:17,600
<font color="#E5E5E5">you the partition before decrypting and</font>

612
00:30:14,030 --> 00:30:21,490
not the decryption so<font color="#CCCCCC"> you'll list the</font>

613
00:30:17,600 --> 00:30:25,030
partition table<font color="#E5E5E5"> all that's already</font>

614
00:30:21,490 --> 00:30:29,120
<font color="#CCCCCC">ok that's</font><font color="#E5E5E5"> let's reading this sector from</font>

615
00:30:25,030 --> 00:30:31,220
from the drive<font color="#CCCCCC"> through</font><font color="#E5E5E5"> another tool that</font>

616
00:30:29,120 --> 00:30:33,260
interacts with<font color="#CCCCCC"> this implant inside of</font>

617
00:30:31,220 --> 00:30:40,850
<font color="#CCCCCC">NBR</font><font color="#E5E5E5"> so probably will see the decrypted</font>

618
00:30:33,260 --> 00:30:44,110
code here so we<font color="#CCCCCC"> pass</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> bit of qmo but</font>

619
00:30:40,850 --> 00:30:49,550
it will flash memory power<font color="#E5E5E5"> as serial</font>

620
00:30:44,110 --> 00:30:52,969
pipe file and the offset to<font color="#CCCCCC"> the disk</font>

621
00:30:49,550 --> 00:30:54,860
sector that<font color="#E5E5E5"> you want to read so if you</font>

622
00:30:52,970 --> 00:30:56,450
convert it to the hacks<font color="#E5E5E5"> and I</font><font color="#CCCCCC"> ask you</font>

623
00:30:54,860 --> 00:31:00,580
you can see that<font color="#E5E5E5"> drive see now is</font>

624
00:30:56,450 --> 00:31:03,410
decrypted so we can access<font color="#CCCCCC"> the sector</font>

625
00:31:00,580 --> 00:31:07,820
this<font color="#E5E5E5"> is good but how about accessing the</font>

626
00:31:03,410 --> 00:31:10,220
<font color="#E5E5E5">the whole disk so for that we wrote the</font>

627
00:31:07,820 --> 00:31:11,210
fuse use driver in<font color="#E5E5E5"> Python that actually</font>

628
00:31:10,220 --> 00:31:12,649
does sector

629
00:31:11,210 --> 00:31:15,620
by sector interaction and the<font color="#E5E5E5"> rich</font>

630
00:31:12,649 --> 00:31:16,760
sectors<font color="#CCCCCC"> on-demand fuse actually it's a</font>

631
00:31:15,620 --> 00:31:20,570
nice technology<font color="#CCCCCC"> that allows you to</font>

632
00:31:16,760 --> 00:31:22,100
<font color="#E5E5E5">implement user mode drivers</font><font color="#CCCCCC"> so for this</font>

633
00:31:20,570 --> 00:31:25,520
will create a<font color="#E5E5E5"> directory where we will</font>

634
00:31:22,100 --> 00:31:27,949
map<font color="#CCCCCC"> we will create a virtual virtual</font>

635
00:31:25,520 --> 00:31:30,440
file that is an image a projection of

636
00:31:27,950 --> 00:31:32,929
the whole decrypted<font color="#E5E5E5"> drive scene and let</font>

637
00:31:30,440 --> 00:31:34,279
me start<font color="#E5E5E5"> this</font><font color="#CCCCCC"> Python script in the other</font>

638
00:31:32,929 --> 00:31:38,149
terminal I'll show you the contents of

639
00:31:34,279 --> 00:31:40,490
<font color="#E5E5E5">that directory so it contains file</font>

640
00:31:38,149 --> 00:31:43,399
called disk you see itself gigabytes<font color="#E5E5E5"> our</font>

641
00:31:40,490 --> 00:31:44,779
<font color="#CCCCCC">Ram of</font><font color="#E5E5E5"> the whole thing of the live CD is</font>

642
00:31:43,399 --> 00:31:46,340
actually or gigabytes of course it

643
00:31:44,779 --> 00:31:49,460
cannot contain the whole file it's it's

644
00:31:46,340 --> 00:31:51,408
a virtual file whenever we access any

645
00:31:49,460 --> 00:31:53,450
<font color="#CCCCCC">part of</font><font color="#E5E5E5"> this file it will dynamically</font>

646
00:31:51,409 --> 00:31:58,520
provide you with the<font color="#E5E5E5"> data that you want</font>

647
00:31:53,450 --> 00:31:59,990
<font color="#E5E5E5">that's what fuse allows you to do and</font>

648
00:31:58,520 --> 00:32:02,450
you don't<font color="#CCCCCC"> need</font><font color="#E5E5E5"> super</font><font color="#CCCCCC"> privileges for that</font>

649
00:31:59,990 --> 00:32:04,789
<font color="#CCCCCC">so we open</font><font color="#E5E5E5"> this disk and we can work</font>

650
00:32:02,450 --> 00:32:07,309
with this we will navigate to<font color="#CCCCCC"> the</font>

651
00:32:04,789 --> 00:32:11,179
beginning<font color="#E5E5E5"> of the drive see you can see</font>

652
00:32:07,309 --> 00:32:13,340
that it's decrypted partition so now we

653
00:32:11,179 --> 00:32:15,590
can<font color="#CCCCCC"> apply any other</font><font color="#E5E5E5"> tools</font><font color="#CCCCCC"> to work with</font>

654
00:32:13,340 --> 00:32:21,590
the<font color="#E5E5E5"> partition</font><font color="#CCCCCC"> bypassing the layer of</font>

655
00:32:15,590 --> 00:32:23,809
full disk encryption so some forensic

656
00:32:21,590 --> 00:32:27,139
<font color="#E5E5E5">tools just to list the partitions again</font>

657
00:32:23,809 --> 00:32:29,418
you're going<font color="#E5E5E5"> to use</font><font color="#CCCCCC"> that to list the</font>

658
00:32:27,140 --> 00:32:30,710
<font color="#CCCCCC">filesystem</font><font color="#E5E5E5"> contents of course we can</font>

659
00:32:29,419 --> 00:32:32,390
find<font color="#E5E5E5"> interesting paths and you can see</font>

660
00:32:30,710 --> 00:32:36,830
<font color="#E5E5E5">actually it prints plus every time you</font>

661
00:32:32,390 --> 00:32:39,409
try to read a block of sectors from from

662
00:32:36,830 --> 00:32:40,850
<font color="#E5E5E5">that</font><font color="#CCCCCC"> ya</font><font color="#E5E5E5"> see that</font><font color="#CCCCCC"> it's reading and</font>

663
00:32:39,409 --> 00:32:42,740
reading and reading because<font color="#E5E5E5"> it's</font>

664
00:32:40,850 --> 00:32:50,600
<font color="#E5E5E5">Traverse you know the whole directory</font>

665
00:32:42,740 --> 00:32:52,760
structure of that guest can see the

666
00:32:50,600 --> 00:32:57,740
files on that<font color="#CCCCCC"> system and you can of</font>

667
00:32:52,760 --> 00:33:02,090
course<font color="#CCCCCC"> inspect any</font><font color="#E5E5E5"> anytime stem so</font><font color="#CCCCCC"> that</font>

668
00:32:57,740 --> 00:33:04,700
we want<font color="#E5E5E5"> to operate</font><font color="#CCCCCC"> cyclists this is cool</font>

669
00:33:02,090 --> 00:33:06,620
but<font color="#E5E5E5"> how about accessing</font><font color="#CCCCCC"> the the files</font>

670
00:33:04,700 --> 00:33:08,450
themselves and see them as a directory

671
00:33:06,620 --> 00:33:11,059
mounted to your<font color="#E5E5E5"> system it's possible as</font>

672
00:33:08,450 --> 00:33:13,340
well requires a couple<font color="#CCCCCC"> of</font><font color="#E5E5E5"> supervised</font>

673
00:33:11,059 --> 00:33:16,309
commands<font color="#E5E5E5"> that shall run outside of the</font>

674
00:33:13,340 --> 00:33:21,220
container<font color="#E5E5E5"> so</font><font color="#CCCCCC"> we're going to start</font><font color="#E5E5E5"> the</font>

675
00:33:16,309 --> 00:33:21,220
same<font color="#E5E5E5"> fuse driver with a few options</font>

676
00:33:22,060 --> 00:33:25,870
to create another fused directory and

677
00:33:23,770 --> 00:33:29,980
then mounted so here essentially is that

678
00:33:25,870 --> 00:33:38,320
<font color="#E5E5E5">we mount the NTFS partition to our live</font>

679
00:33:29,980 --> 00:33:41,700
CD in RM once we mounted this we can go

680
00:33:38,320 --> 00:33:44,980
<font color="#E5E5E5">and</font><font color="#CCCCCC"> just explore it be folders and files</font>

681
00:33:41,700 --> 00:33:46,690
through this<font color="#E5E5E5"> VM bridge</font><font color="#CCCCCC"> and this is done</font>

682
00:33:44,980 --> 00:33:48,640
<font color="#E5E5E5">before windows started booting that</font>

683
00:33:46,690 --> 00:33:49,960
means there are<font color="#CCCCCC"> no changes whatsoever it</font>

684
00:33:48,640 --> 00:33:51,640
<font color="#E5E5E5">is a clean image</font>

685
00:33:49,960 --> 00:33:53,470
forensic<font color="#E5E5E5"> release ound that you can copy</font>

686
00:33:51,640 --> 00:33:56,260
all the network if<font color="#E5E5E5"> you want</font><font color="#CCCCCC"> we only use</font>

687
00:33:53,470 --> 00:33:59,950
<font color="#E5E5E5">B</font><font color="#CCCCCC"> Drive attached to the same system so</font>

688
00:33:56,260 --> 00:34:03,100
far<font color="#E5E5E5"> it's untouched</font><font color="#CCCCCC"> it doesn't</font><font color="#E5E5E5"> include</font>

689
00:33:59,950 --> 00:34:04,840
<font color="#E5E5E5">any changes</font><font color="#CCCCCC"> implemented done during the</font>

690
00:34:03,100 --> 00:34:06,610
pudding and of course you can scan the

691
00:34:04,840 --> 00:34:18,759
files you can access any file<font color="#CCCCCC"> code there</font>

692
00:34:06,610 --> 00:34:26,259
is no rootkit running and yeah this<font color="#E5E5E5"> is</font>

693
00:34:18,760 --> 00:34:28,000
<font color="#E5E5E5">the I think we ran out of time</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> so</font>

694
00:34:26,260 --> 00:34:29,860
we wanted<font color="#CCCCCC"> to show you something you can</font>

695
00:34:28,000 --> 00:34:32,500
you can<font color="#E5E5E5"> look for us outside maybe</font>

696
00:34:29,860 --> 00:34:35,740
assurance of it<font color="#CCCCCC"> yeah basically well what</font>

697
00:34:32,500 --> 00:34:38,530
I<font color="#E5E5E5"> was</font><font color="#CCCCCC"> working on this night how did they</font>

698
00:34:35,739 --> 00:34:40,389
show<font color="#E5E5E5"> the I was asked</font><font color="#CCCCCC"> whether it's</font>

699
00:34:38,530 --> 00:34:42,700
possible<font color="#CCCCCC"> by people who soul is</font>

700
00:34:40,389 --> 00:34:45,400
previously<font color="#E5E5E5"> if it's possible to</font><font color="#CCCCCC"> actually</font>

701
00:34:42,699 --> 00:34:47,649
cure such system<font color="#E5E5E5"> you can remove the</font>

702
00:34:45,400 --> 00:34:49,270
<font color="#E5E5E5">files from it if you can write to</font><font color="#CCCCCC"> the</font>

703
00:34:47,650 --> 00:34:50,920
encrypted<font color="#E5E5E5"> drive and apparently</font>

704
00:34:49,270 --> 00:34:52,690
theoretically it is possible but

705
00:34:50,920 --> 00:34:55,780
practically it's not easy to do

706
00:34:52,690 --> 00:34:58,450
so it<font color="#E5E5E5"> requires some</font><font color="#CCCCCC"> extra extra code in</font>

707
00:34:55,780 --> 00:35:01,540
there in that implant that we put into

708
00:34:58,450 --> 00:35:03,339
MBR<font color="#E5E5E5"> but that's what I worked on this</font>

709
00:35:01,540 --> 00:35:05,140
night I think<font color="#E5E5E5"> due to</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> time</font>

710
00:35:03,340 --> 00:35:06,790
constraints I'm not going to show<font color="#E5E5E5"> it</font>

711
00:35:05,140 --> 00:35:11,100
because it may take another seven eight

712
00:35:06,790 --> 00:35:13,300
<font color="#CCCCCC">minutes but it is</font><font color="#E5E5E5"> possible</font><font color="#CCCCCC"> to actually</font>

713
00:35:11,100 --> 00:35:15,009
<font color="#E5E5E5">provide this right access and then you</font>

714
00:35:13,300 --> 00:35:16,480
can mount the<font color="#CCCCCC"> filesystem in the read</font>

715
00:35:15,010 --> 00:35:18,850
<font color="#E5E5E5">write mode and then you can clean the</font>

716
00:35:16,480 --> 00:35:20,920
<font color="#CCCCCC">system if you want so in case you are</font>

717
00:35:18,850 --> 00:35:23,200
stuck with proprietary encryption which

718
00:35:20,920 --> 00:35:26,380
doesn't<font color="#E5E5E5"> provide you any other external</font>

719
00:35:23,200 --> 00:35:28,120
<font color="#E5E5E5">tools to to mount</font><font color="#CCCCCC"> these especially</font><font color="#E5E5E5"> from</font>

720
00:35:26,380 --> 00:35:30,160
the Linux world<font color="#E5E5E5"> a lot of limitations</font>

721
00:35:28,120 --> 00:35:34,940
<font color="#CCCCCC">like proprietary commercial</font><font color="#E5E5E5"> products</font>

722
00:35:30,160 --> 00:35:37,160
then this<font color="#E5E5E5"> approach allows you to inspect</font>

723
00:35:34,940 --> 00:35:40,069
system in jet<font color="#CCCCCC"> jacket</font><font color="#E5E5E5"> and you see this is</font>

724
00:35:37,160 --> 00:35:42,259
a vendor agnostic so we didn't<font color="#E5E5E5"> actually</font>

725
00:35:40,069 --> 00:35:43,460
modify and reverse engineer the code<font color="#CCCCCC"> of</font>

726
00:35:42,260 --> 00:35:46,250
<font color="#E5E5E5">encryption we don't know how I think</font>

727
00:35:43,460 --> 00:35:49,160
<font color="#E5E5E5">actually encrypts we just leverage the</font>

728
00:35:46,250 --> 00:35:53,980
code whatever<font color="#E5E5E5"> is there and we can do</font><font color="#CCCCCC"> no</font>

729
00:35:49,160 --> 00:35:58,428
<font color="#E5E5E5">job that's</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> thank you</font><font color="#CCCCCC"> very</font><font color="#E5E5E5"> much</font>

730
00:35:53,980 --> 00:35:58,429
[Applause]

