1
00:00:10,360 --> 00:00:15,309
<font color="#E5E5E5">all right so hello everyone thank you</font>

2
00:00:12,790 --> 00:00:17,950
<font color="#E5E5E5">for</font><font color="#CCCCCC"> joining this stuff today so yeah I</font>

3
00:00:15,309 --> 00:00:21,610
am<font color="#CCCCCC"> Rommel and I'm a model researcher and</font>

4
00:00:17,950 --> 00:00:24,009
<font color="#E5E5E5">I'm</font><font color="#CCCCCC"> based here in Singapore</font><font color="#E5E5E5"> so my talk</font>

5
00:00:21,610 --> 00:00:27,039
<font color="#E5E5E5">today is entitled inter enough</font>

6
00:00:24,009 --> 00:00:29,650
<font color="#CCCCCC">internet-of-things battle</font><font color="#E5E5E5"> of the bots so</font>

7
00:00:27,039 --> 00:00:31,980
to give<font color="#CCCCCC"> you an idea this</font><font color="#E5E5E5"> talk is based</font>

8
00:00:29,650 --> 00:00:35,500
on<font color="#E5E5E5"> our research for the past year and</font>

9
00:00:31,980 --> 00:00:37,360
since we we were monitoring<font color="#E5E5E5"> Mirai botnet</font>

10
00:00:35,500 --> 00:00:40,870
<font color="#CCCCCC">and all related</font><font color="#E5E5E5"> samples to it</font>

11
00:00:37,360 --> 00:00:43,449
so let's take<font color="#CCCCCC"> a look</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> here is a</font>

12
00:00:40,870 --> 00:00:43,870
overview<font color="#E5E5E5"> of what we'll be discussing</font>

13
00:00:43,449 --> 00:00:46,449
<font color="#E5E5E5">today</font>

14
00:00:43,870 --> 00:00:49,690
so first is a brief introduction<font color="#CCCCCC"> of</font>

15
00:00:46,449 --> 00:00:52,269
Mirai<font color="#E5E5E5"> second is anti analysis and</font>

16
00:00:49,690 --> 00:00:55,570
encryption<font color="#E5E5E5"> of its configuration</font><font color="#CCCCCC"> if there</font>

17
00:00:52,269 --> 00:00:58,330
are any<font color="#E5E5E5"> changes the next one is the our</font>

18
00:00:55,570 --> 00:01:00,610
lab setup and honeypot so how did<font color="#E5E5E5"> we get</font>

19
00:00:58,330 --> 00:01:03,220
all the samples<font color="#E5E5E5"> that will be presented</font>

20
00:01:00,610 --> 00:01:06,159
<font color="#CCCCCC">today</font><font color="#E5E5E5"> and lastly it's the</font><font color="#CCCCCC"> malaria</font>

21
00:01:03,220 --> 00:01:08,320
<font color="#CCCCCC">variance</font><font color="#E5E5E5"> so we will compare them from</font>

22
00:01:06,159 --> 00:01:11,229
the original<font color="#CCCCCC"> source code of me ride and</font>

23
00:01:08,320 --> 00:01:16,089
the changes of<font color="#E5E5E5"> the</font><font color="#CCCCCC"> variance then lastly</font>

24
00:01:11,229 --> 00:01:19,930
is the popular<font color="#E5E5E5"> variants so with the</font>

25
00:01:16,090 --> 00:01:23,610
overview so just to refresh<font color="#E5E5E5"> your memory</font>

26
00:01:19,930 --> 00:01:27,640
<font color="#CCCCCC">on Mirai so we just take</font><font color="#E5E5E5"> a look on</font><font color="#CCCCCC"> some</font>

27
00:01:23,610 --> 00:01:30,820
news that made two years<font color="#CCCCCC"> ago</font><font color="#E5E5E5"> so the</font>

28
00:01:27,640 --> 00:01:34,240
first one is<font color="#E5E5E5"> the first attack on Krebs</font>

29
00:01:30,820 --> 00:01:37,570
on security<font color="#E5E5E5"> so this guy is famous</font>

30
00:01:34,240 --> 00:01:40,390
journalist in computer<font color="#CCCCCC"> security and the</font>

31
00:01:37,570 --> 00:01:43,570
attack cost<font color="#E5E5E5"> aside to be offline for four</font>

32
00:01:40,390 --> 00:01:49,890
days<font color="#E5E5E5"> and the record traffic was around</font>

33
00:01:43,570 --> 00:01:53,830
620<font color="#CCCCCC"> gigabyte</font><font color="#E5E5E5"> per second</font><font color="#CCCCCC"> next attack is</font>

34
00:01:49,890 --> 00:01:56,890
against<font color="#E5E5E5"> in its infrastructure so it made</font>

35
00:01:53,830 --> 00:02:00,158
<font color="#E5E5E5">popular websites like Twitter Spotify</font>

36
00:01:56,890 --> 00:02:02,260
and reddit<font color="#E5E5E5"> unavailable to users</font><font color="#CCCCCC"> so we</font>

37
00:02:00,159 --> 00:02:06,580
<font color="#CCCCCC">can see already like the immediate</font>

38
00:02:02,260 --> 00:02:12,069
impact of Mirai<font color="#CCCCCC"> 2 years</font><font color="#E5E5E5"> ago so not</font><font color="#CCCCCC"> only</font>

39
00:02:06,580 --> 00:02:13,810
<font color="#CCCCCC">that so</font><font color="#E5E5E5"> another study showed that DDoS</font>

40
00:02:12,069 --> 00:02:18,519
<font color="#CCCCCC">is also bad for businesses that are</font>

41
00:02:13,810 --> 00:02:21,360
<font color="#E5E5E5">being targeted</font><font color="#CCCCCC"> so roughly 8%</font><font color="#E5E5E5"> of Dean's</font>

42
00:02:18,520 --> 00:02:23,690
customers base<font color="#CCCCCC"> stop using their services</font>

43
00:02:21,360 --> 00:02:27,200
<font color="#CCCCCC">after they were</font><font color="#E5E5E5"> after</font>

44
00:02:23,690 --> 00:02:32,810
were<font color="#CCCCCC"> apart</font><font color="#E5E5E5"> so this was also a huge loss</font>

45
00:02:27,200 --> 00:02:34,820
to<font color="#CCCCCC"> bean the next</font><font color="#E5E5E5"> are you talk about the</font>

46
00:02:32,810 --> 00:02:39,410
first appearance of Mirai

47
00:02:34,820 --> 00:02:42,620
so it was coded by minus n<font color="#E5E5E5"> PI or his aka</font>

48
00:02:39,410 --> 00:02:45,980
and the source code was<font color="#CCCCCC"> released in hub</font>

49
00:02:42,620 --> 00:02:49,220
forums on September 20 2016 so this is

50
00:02:45,980 --> 00:02:50,780
the actual post by<font color="#CCCCCC"> Anna senpai and he</font>

51
00:02:49,220 --> 00:02:54,710
also released<font color="#E5E5E5"> the source code in this</font>

52
00:02:50,780 --> 00:02:56,990
post<font color="#E5E5E5"> so the good</font><font color="#CCCCCC"> news</font><font color="#E5E5E5"> is since certain</font>

53
00:02:54,710 --> 00:03:00,260
<font color="#CCCCCC">information from his posting this</font>

54
00:02:56,990 --> 00:03:03,470
posting<font color="#E5E5E5"> led</font><font color="#CCCCCC"> to identifying the authors</font>

55
00:03:00,260 --> 00:03:05,959
so fast<font color="#E5E5E5"> forward after all the</font>

56
00:03:03,470 --> 00:03:09,340
investigations<font color="#CCCCCC"> the author</font><font color="#E5E5E5"> behind this</font>

57
00:03:05,960 --> 00:03:13,640
<font color="#CCCCCC">mirror botnet was pleaded guilty last</font>

58
00:03:09,340 --> 00:03:16,160
December 2017 so when there's a good

59
00:03:13,640 --> 00:03:18,170
<font color="#E5E5E5">news there's also some bad news</font><font color="#CCCCCC"> since</font>

60
00:03:16,160 --> 00:03:21,320
<font color="#E5E5E5">this is now open source the source code</font>

61
00:03:18,170 --> 00:03:24,140
of<font color="#E5E5E5"> Mirai so anyone can use it</font>

62
00:03:21,320 --> 00:03:25,970
including you or me or like any cyber

63
00:03:24,140 --> 00:03:29,720
criminal can just reuse the<font color="#E5E5E5"> code and</font>

64
00:03:25,970 --> 00:03:32,870
they can<font color="#E5E5E5"> create their own botnet so in</font>

65
00:03:29,720 --> 00:03:35,030
this<font color="#E5E5E5"> course and maybe when they create</font>

66
00:03:32,870 --> 00:03:38,060
their own botnet<font color="#CCCCCC"> botnet</font><font color="#E5E5E5"> they can also</font>

67
00:03:35,030 --> 00:03:41,420
have the same impact as<font color="#CCCCCC"> merrily on what</font>

68
00:03:38,060 --> 00:03:43,040
they<font color="#E5E5E5"> did like to Dean and Krebs so now</font>

69
00:03:41,420 --> 00:03:46,850
this is<font color="#CCCCCC"> the problem that</font><font color="#E5E5E5"> we have and</font>

70
00:03:43,040 --> 00:03:50,239
many<font color="#E5E5E5"> called many variants or we can say</font>

71
00:03:46,850 --> 00:03:52,640
copycats of Mirai have been<font color="#E5E5E5"> modifying</font>

72
00:03:50,239 --> 00:03:55,850
the<font color="#E5E5E5"> source code</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> infect more and more</font>

73
00:03:52,640 --> 00:03:58,160
<font color="#E5E5E5">IOT devices so we</font><font color="#CCCCCC"> will</font><font color="#E5E5E5"> take a more</font>

74
00:03:55,850 --> 00:04:04,280
detailed<font color="#CCCCCC"> look on mirror</font><font color="#E5E5E5"> variants later</font>

75
00:03:58,160 --> 00:04:06,320
on so<font color="#E5E5E5"> if any of you maybe have looked up</font>

76
00:04:04,280 --> 00:04:08,630
<font color="#E5E5E5">the source code of</font><font color="#CCCCCC"> Mariah so these are</font>

77
00:04:06,320 --> 00:04:10,910
<font color="#E5E5E5">the main</font><font color="#CCCCCC"> components included in</font><font color="#E5E5E5"> the</font>

78
00:04:08,630 --> 00:04:13,340
source code<font color="#CCCCCC"> so we have the command and</font>

79
00:04:10,910 --> 00:04:16,040
control server<font color="#E5E5E5"> we have the report server</font>

80
00:04:13,340 --> 00:04:19,450
<font color="#E5E5E5">we have the loader and</font><font color="#CCCCCC"> we have the</font><font color="#E5E5E5"> bot</font>

81
00:04:16,040 --> 00:04:22,340
<font color="#E5E5E5">so this bot here this is the one that is</font>

82
00:04:19,450 --> 00:04:25,430
installed in the<font color="#E5E5E5"> infected device so this</font>

83
00:04:22,340 --> 00:04:28,070
<font color="#E5E5E5">is the payload so this</font><font color="#CCCCCC"> bot</font><font color="#E5E5E5"> has three</font>

84
00:04:25,430 --> 00:04:31,580
functions<font color="#E5E5E5"> first is their attack so this</font>

85
00:04:28,070 --> 00:04:34,669
is this<font color="#E5E5E5"> includes the DDoS attacks next</font>

86
00:04:31,580 --> 00:04:37,370
is the killer<font color="#CCCCCC"> this is</font><font color="#E5E5E5"> the one functions</font>

87
00:04:34,669 --> 00:04:39,109
to stop the

88
00:04:37,370 --> 00:04:41,150
processes like maybe other botnets are

89
00:04:39,110 --> 00:04:43,880
running there so it can kill those

90
00:04:41,150 --> 00:04:46,698
processes then scanner so this is to

91
00:04:43,880 --> 00:04:51,350
infect more IOT devices so it<font color="#CCCCCC"> acts like</font>

92
00:04:46,699 --> 00:04:53,690
it acts like<font color="#CCCCCC"> sour worm who to have</font>

93
00:04:51,350 --> 00:04:56,150
better<font color="#CCCCCC"> understanding on</font><font color="#E5E5E5"> how the</font>

94
00:04:53,690 --> 00:04:58,729
infection chain works by MRI so we have

95
00:04:56,150 --> 00:05:01,429
here<font color="#CCCCCC"> restart here so the infected IOT</font>

96
00:04:58,729 --> 00:05:05,240
device so the bot module is installed

97
00:05:01,430 --> 00:05:08,540
<font color="#E5E5E5">here and then what it does is that's a</font>

98
00:05:05,240 --> 00:05:10,520
telnet port scan so it uses<font color="#CCCCCC"> the</font><font color="#E5E5E5"> default</font>

99
00:05:08,540 --> 00:05:13,360
credentials so it already has a list<font color="#E5E5E5"> of</font>

100
00:05:10,520 --> 00:05:17,120
default<font color="#E5E5E5"> credentials then after</font>

101
00:05:13,360 --> 00:05:20,630
successfully successfully<font color="#CCCCCC"> logging in</font>

102
00:05:17,120 --> 00:05:22,639
that IOT device<font color="#E5E5E5"> it will report the IP</font>

103
00:05:20,630 --> 00:05:24,919
and the credentials<font color="#CCCCCC"> to the report</font><font color="#E5E5E5"> server</font>

104
00:05:22,639 --> 00:05:27,620
so this is was<font color="#E5E5E5"> the other component that</font>

105
00:05:24,919 --> 00:05:29,630
<font color="#E5E5E5">we mentioned then having the IP and</font>

106
00:05:27,620 --> 00:05:31,850
credentials already so we have<font color="#E5E5E5"> here the</font>

107
00:05:29,630 --> 00:05:35,240
loader so this loader will be the one

108
00:05:31,850 --> 00:05:38,630
who will install the<font color="#E5E5E5"> bot in the infected</font>

109
00:05:35,240 --> 00:05:42,919
device so now<font color="#E5E5E5"> we will have another</font>

110
00:05:38,630 --> 00:05:44,750
<font color="#E5E5E5">infected device so once this device is</font>

111
00:05:42,919 --> 00:05:47,299
infected it will just<font color="#E5E5E5"> repeat the same</font>

112
00:05:44,750 --> 00:05:50,539
process so it will<font color="#E5E5E5"> scan again some</font>

113
00:05:47,300 --> 00:05:52,580
random IPS then if it's in fact<font color="#E5E5E5"> that if</font>

114
00:05:50,539 --> 00:05:56,030
it's<font color="#CCCCCC"> vulnerable then it will infect this</font>

115
00:05:52,580 --> 00:05:58,639
<font color="#E5E5E5">and another thing once it's infected</font>

116
00:05:56,030 --> 00:06:00,940
it will report now to the C&C server

117
00:05:58,639 --> 00:06:03,320
like telling them<font color="#E5E5E5"> telling the C&C that</font>

118
00:06:00,940 --> 00:06:05,389
this device is infected<font color="#E5E5E5"> and it can</font>

119
00:06:03,320 --> 00:06:09,710
<font color="#E5E5E5">already receive commands like whichever</font>

120
00:06:05,389 --> 00:06:13,430
<font color="#E5E5E5">the</font><font color="#CCCCCC"> CSE wants then next is we have here</font>

121
00:06:09,710 --> 00:06:16,880
<font color="#E5E5E5">the botnet botnet admin so at the bottom</font>

122
00:06:13,430 --> 00:06:19,699
<font color="#CCCCCC">that what net admin can sell or rent out</font>

123
00:06:16,880 --> 00:06:22,550
the use<font color="#E5E5E5"> of the botnets here so he can</font>

124
00:06:19,699 --> 00:06:25,370
rent it out or sell to<font color="#CCCCCC"> a botnet user or</font>

125
00:06:22,550 --> 00:06:28,880
let's say a fraudster here so once the

126
00:06:25,370 --> 00:06:31,520
fraudster gets access<font color="#CCCCCC"> to</font><font color="#E5E5E5"> the botnet</font><font color="#CCCCCC"> he</font>

127
00:06:28,880 --> 00:06:34,460
can send commands to the<font color="#E5E5E5"> C&C server then</font>

128
00:06:31,520 --> 00:06:36,799
<font color="#CCCCCC">the C&C</font><font color="#E5E5E5"> server will send attack commands</font>

129
00:06:34,460 --> 00:06:41,479
<font color="#E5E5E5">to the infected devices then this</font>

130
00:06:36,800 --> 00:06:43,960
<font color="#E5E5E5">infected devices will do a DDoS to its</font>

131
00:06:41,479 --> 00:06:50,900
target<font color="#E5E5E5"> so basically this is the</font>

132
00:06:43,960 --> 00:06:53,000
<font color="#E5E5E5">infection chain of Mirai and justice</font>

133
00:06:50,900 --> 00:06:57,200
<font color="#E5E5E5">summary so this are the attacks</font>

134
00:06:53,000 --> 00:07:02,479
<font color="#E5E5E5">available to me</font><font color="#CCCCCC"> right so</font><font color="#E5E5E5"> this is all in</font>

135
00:06:57,200 --> 00:07:05,510
the source code the<font color="#E5E5E5"> next is we have the</font>

136
00:07:02,479 --> 00:07:12,590
<font color="#E5E5E5">anti analysis and the encryption of</font><font color="#CCCCCC"> the</font>

137
00:07:05,510 --> 00:07:17,150
configuration table of<font color="#E5E5E5"> Mirai so this is</font>

138
00:07:12,590 --> 00:07:20,330
the<font color="#CCCCCC"> binary</font><font color="#E5E5E5"> hex view of one of the mirror</font>

139
00:07:17,150 --> 00:07:23,690
samples that we encountered so else<font color="#CCCCCC"> the</font>

140
00:07:20,330 --> 00:07:26,030
header<font color="#E5E5E5"> so most samples is not encrypted</font>

141
00:07:23,690 --> 00:07:29,090
<font color="#E5E5E5">by any custom powers like when we</font>

142
00:07:26,030 --> 00:07:32,539
compare<font color="#E5E5E5"> it to Windows so usually it</font><font color="#CCCCCC"> is</font>

143
00:07:29,090 --> 00:07:34,520
just<font color="#CCCCCC"> backed</font><font color="#E5E5E5"> by upx so basically if it's</font>

144
00:07:32,539 --> 00:07:39,529
just<font color="#E5E5E5"> backed by upx it should be</font><font color="#CCCCCC"> easily</font>

145
00:07:34,520 --> 00:07:42,260
be<font color="#CCCCCC"> decompressed</font><font color="#E5E5E5"> but what the variants</font>

146
00:07:39,529 --> 00:07:45,110
authors do is they<font color="#CCCCCC"> change this one</font><font color="#E5E5E5"> so</font>

147
00:07:42,260 --> 00:07:49,039
this would be the proper header should

148
00:07:45,110 --> 00:07:52,940
be<font color="#CCCCCC"> upx</font><font color="#E5E5E5"> exclamation point but this one is</font>

149
00:07:49,039 --> 00:07:56,960
changed by<font color="#CCCCCC"> SMD</font><font color="#E5E5E5"> J so what happens is if</font>

150
00:07:52,940 --> 00:08:00,020
we<font color="#CCCCCC"> use</font><font color="#E5E5E5"> the upx tool to decompress this</font>

151
00:07:56,960 --> 00:08:03,229
file it will fail<font color="#CCCCCC"> so if we do automation</font>

152
00:08:00,020 --> 00:08:07,520
then it cannot decrypt<font color="#E5E5E5"> I cannot</font>

153
00:08:03,229 --> 00:08:10,550
decompress the sample properly so what

154
00:08:07,520 --> 00:08:13,580
we do we just change this<font color="#E5E5E5"> value here to</font>

155
00:08:10,550 --> 00:08:17,289
its proper header which is<font color="#E5E5E5"> upx</font><font color="#CCCCCC"> and we</font>

156
00:08:13,580 --> 00:08:24,229
<font color="#CCCCCC">are able</font><font color="#E5E5E5"> to decompress</font><font color="#CCCCCC"> it easily and</font>

157
00:08:17,289 --> 00:08:26,719
then next one is so not only<font color="#CCCCCC"> snd J we</font>

158
00:08:24,229 --> 00:08:30,460
found that numerous values<font color="#E5E5E5"> were change</font>

159
00:08:26,719 --> 00:08:33,860
in those<font color="#E5E5E5"> upx headers so we have around</font>

160
00:08:30,460 --> 00:08:39,559
18<font color="#CCCCCC"> different headers that</font><font color="#E5E5E5"> been has been</font>

161
00:08:33,860 --> 00:08:42,409
<font color="#E5E5E5">modified so</font><font color="#CCCCCC"> Disorderlies if you have an</font>

162
00:08:39,559 --> 00:08:44,810
<font color="#E5E5E5">Vivian idea on the configuration table</font>

163
00:08:42,409 --> 00:08:46,850
that we are talking<font color="#CCCCCC"> about so this</font><font color="#E5E5E5"> again</font>

164
00:08:44,810 --> 00:08:50,599
is based<font color="#E5E5E5"> on our source</font><font color="#CCCCCC"> code so we have</font>

165
00:08:46,850 --> 00:08:54,890
here is the C&C domain<font color="#E5E5E5"> we have the CNC</font>

166
00:08:50,600 --> 00:08:58,040
port the table scan domain and<font color="#CCCCCC"> scan CB</font>

167
00:08:54,890 --> 00:09:00,530
port<font color="#CCCCCC"> so for this</font><font color="#E5E5E5"> values the in hex these</font>

168
00:08:58,040 --> 00:09:03,170
are the<font color="#E5E5E5"> encrypted ones so to decrypt</font>

169
00:09:00,530 --> 00:09:05,449
this<font color="#E5E5E5"> when this is the</font><font color="#CCCCCC"> crypt</font>

170
00:09:03,170 --> 00:09:09,170
you will get<font color="#CCCCCC"> this value so</font><font color="#E5E5E5"> CNC changed</font>

171
00:09:05,450 --> 00:09:11,959
me so for those variants they just

172
00:09:09,170 --> 00:09:15,709
change this one<font color="#E5E5E5"> to change their own CNC</font>

173
00:09:11,959 --> 00:09:19,130
<font color="#E5E5E5">and goes the same with the others</font><font color="#CCCCCC"> so how</font>

174
00:09:15,709 --> 00:09:22,000
does the<font color="#E5E5E5"> decryption of</font><font color="#CCCCCC"> Mira</font><font color="#E5E5E5"> work so</font>

175
00:09:19,130 --> 00:09:25,970
let's take a look here about to the crib

176
00:09:22,000 --> 00:09:29,120
<font color="#CCCCCC">so basically it has a table key here</font><font color="#E5E5E5"> so</font>

177
00:09:25,970 --> 00:09:32,380
here I just<font color="#CCCCCC"> happened here to</font><font color="#E5E5E5"> see here so</font>

178
00:09:29,120 --> 00:09:36,470
<font color="#CCCCCC">this is our dead beef so what it</font><font color="#E5E5E5"> does</font>

179
00:09:32,380 --> 00:09:39,920
it's just<font color="#E5E5E5"> use our</font><font color="#CCCCCC"> xor algorithm</font><font color="#E5E5E5"> so it's</font>

180
00:09:36,470 --> 00:09:42,829
quite<font color="#E5E5E5"> simple so it XOR each</font><font color="#CCCCCC"> byte of this</font>

181
00:09:39,920 --> 00:09:48,670
<font color="#E5E5E5">table key so if we XOR each byte each</font>

182
00:09:42,829 --> 00:09:51,920
other<font color="#E5E5E5"> we'll get</font><font color="#CCCCCC"> a value of 0 x 22</font><font color="#E5E5E5"> and</font>

183
00:09:48,670 --> 00:09:53,990
this value here when we accelerate<font color="#CCCCCC"> the</font>

184
00:09:51,920 --> 00:09:56,870
encrypted<font color="#E5E5E5"> configuration table we should</font>

185
00:09:53,990 --> 00:09:59,690
be able to dump the configuration table

186
00:09:56,870 --> 00:10:02,300
when example here is<font color="#E5E5E5"> the</font><font color="#CCCCCC"> C&C port so</font><font color="#E5E5E5"> I</font>

187
00:09:59,690 --> 00:10:07,100
showed it in<font color="#E5E5E5"> the previous slide so we</font>

188
00:10:02,300 --> 00:10:14,089
<font color="#CCCCCC">have</font><font color="#E5E5E5"> 22 and 35 so XOR in 22 to 22 is 0</font>

189
00:10:07,100 --> 00:10:17,089
then X or 22 235 is 17 hex or 23 in

190
00:10:14,089 --> 00:10:22,040
decimal so I computed<font color="#E5E5E5"> this yesterday</font><font color="#CCCCCC"> so</font>

191
00:10:17,089 --> 00:10:24,949
it should<font color="#E5E5E5"> be correct so next one since</font>

192
00:10:22,040 --> 00:10:29,180
we already<font color="#E5E5E5"> know</font><font color="#CCCCCC"> that Maria just</font><font color="#E5E5E5"> uses our</font>

193
00:10:24,949 --> 00:10:31,699
XOR algorithm<font color="#E5E5E5"> so this are the XOR keys</font>

194
00:10:29,180 --> 00:10:33,890
that we were able<font color="#E5E5E5"> to identify that</font>

195
00:10:31,699 --> 00:10:37,069
malaria<font color="#CCCCCC"> burials are</font><font color="#E5E5E5"> using so</font>

196
00:10:33,890 --> 00:10:40,189
approximately<font color="#E5E5E5"> 47 different</font><font color="#CCCCCC"> XOR kiss use</font>

197
00:10:37,070 --> 00:10:43,430
and<font color="#E5E5E5"> this are the top</font><font color="#CCCCCC"> 5</font><font color="#E5E5E5"> that we found so</font>

198
00:10:40,190 --> 00:10:46,579
purchase the dead beef or<font color="#CCCCCC"> C or X 22</font><font color="#E5E5E5"> so</font>

199
00:10:43,430 --> 00:10:50,390
this includes Mirai<font color="#E5E5E5"> so we found that 27</font>

200
00:10:46,579 --> 00:10:54,290
variants are using this<font color="#E5E5E5"> and we have 54</font>

201
00:10:50,390 --> 00:10:56,689
45 then another<font color="#E5E5E5"> interesting is this 0 so</font>

202
00:10:54,290 --> 00:10:58,880
13 variants are using it<font color="#E5E5E5"> so it means</font>

203
00:10:56,690 --> 00:11:01,160
<font color="#CCCCCC">that the configuration table was not</font>

204
00:10:58,880 --> 00:11:04,550
<font color="#E5E5E5">encrypted so we can see</font><font color="#CCCCCC"> everything the</font>

205
00:11:01,160 --> 00:11:06,529
<font color="#E5E5E5">CNC the port that it uses so we can see</font>

206
00:11:04,550 --> 00:11:09,490
<font color="#E5E5E5">everything maybe it was used for testing</font>

207
00:11:06,529 --> 00:11:14,930
purposes<font color="#E5E5E5"> or maybe they</font><font color="#CCCCCC"> just forgot to</font>

208
00:11:09,490 --> 00:11:16,220
encrypt the configuration and next is

209
00:11:14,930 --> 00:11:21,319
<font color="#E5E5E5">caching life</font>

210
00:11:16,220 --> 00:11:23,600
samples<font color="#E5E5E5"> with our honeypot so we started</font>

211
00:11:21,320 --> 00:11:26,720
<font color="#CCCCCC">a project</font><font color="#E5E5E5"> last</font><font color="#CCCCCC"> year in</font><font color="#E5E5E5"> our team so we</font>

212
00:11:23,600 --> 00:11:30,230
call it the<font color="#CCCCCC"> KY project or kill all I</font><font color="#E5E5E5"> Oh</font>

213
00:11:26,720 --> 00:11:32,870
<font color="#E5E5E5">T botnets project so we just use static</font>

214
00:11:30,230 --> 00:11:34,820
<font color="#E5E5E5">analysis then we automate the decryption</font>

215
00:11:32,870 --> 00:11:37,700
<font color="#E5E5E5">of the configuration table so as</font>

216
00:11:34,820 --> 00:11:40,040
<font color="#E5E5E5">mentioned</font><font color="#CCCCCC"> it just uses XOR algorithm</font><font color="#E5E5E5"> so</font>

217
00:11:37,700 --> 00:11:42,770
it<font color="#CCCCCC"> should be we could automate</font><font color="#E5E5E5"> this</font>

218
00:11:40,040 --> 00:11:46,790
process<font color="#E5E5E5"> the next is and packing of known</font>

219
00:11:42,770 --> 00:11:49,040
<font color="#E5E5E5">powers so it it just uses upx so we just</font>

220
00:11:46,790 --> 00:11:50,660
decompress<font color="#CCCCCC"> it upx and see if the header</font>

221
00:11:49,040 --> 00:11:53,150
is correct<font color="#E5E5E5"> if it's not then we just</font>

222
00:11:50,660 --> 00:11:54,620
change<font color="#E5E5E5"> it to</font><font color="#CCCCCC"> upx</font><font color="#E5E5E5"> then we will be able to</font>

223
00:11:53,150 --> 00:11:56,209
decompress it<font color="#E5E5E5"> then after</font><font color="#CCCCCC"> the</font>

224
00:11:54,620 --> 00:11:59,810
<font color="#E5E5E5">decompressing it we can get the</font>

225
00:11:56,210 --> 00:12:03,850
configuration table then also we collect

226
00:11:59,810 --> 00:12:06,380
the CNC servers and download<font color="#CCCCCC"> URLs</font>

227
00:12:03,850 --> 00:12:09,950
through the result of this<font color="#E5E5E5"> project for</font>

228
00:12:06,380 --> 00:12:14,570
<font color="#E5E5E5">the</font><font color="#CCCCCC"> past year we collected around</font><font color="#E5E5E5"> 21,000</font>

229
00:12:09,950 --> 00:12:18,200
samples then from this<font color="#E5E5E5"> 21,000 samples we</font>

230
00:12:14,570 --> 00:12:21,170
got<font color="#E5E5E5"> 15,000 samples that are related</font><font color="#CCCCCC"> to</font>

231
00:12:18,200 --> 00:12:25,940
me<font color="#E5E5E5"> right botnet the next one is we</font>

232
00:12:21,170 --> 00:12:28,339
identified 120 variants<font color="#CCCCCC"> 130 violence is</font>

233
00:12:25,940 --> 00:12:31,010
a lot but I'll explain<font color="#E5E5E5"> here</font><font color="#CCCCCC"> how we were</font>

234
00:12:28,340 --> 00:12:33,890
<font color="#E5E5E5">able to get this much then we have Bluff</font>

235
00:12:31,010 --> 00:12:39,740
listed around 500 plus command and

236
00:12:33,890 --> 00:12:43,730
control servers so just an<font color="#E5E5E5"> overview of</font>

237
00:12:39,740 --> 00:12:48,130
<font color="#CCCCCC">our</font><font color="#E5E5E5"> honeypot so we use a low blow</font>

238
00:12:43,730 --> 00:12:51,290
interaction honeypot<font color="#E5E5E5"> so we have here</font><font color="#CCCCCC"> our</font>

239
00:12:48,130 --> 00:12:53,870
<font color="#E5E5E5">product here so we use</font><font color="#CCCCCC"> FortiGate so this</font>

240
00:12:51,290 --> 00:12:58,430
is the one facing<font color="#CCCCCC"> the internet so every</font>

241
00:12:53,870 --> 00:13:01,520
traffic<font color="#E5E5E5"> that goes into port 23 and 23 23</font>

242
00:12:58,430 --> 00:13:04,459
23<font color="#CCCCCC"> I will be routed to</font><font color="#E5E5E5"> our test</font><font color="#CCCCCC"> network</font>

243
00:13:01,520 --> 00:13:08,770
<font color="#E5E5E5">so once it's inside the test network so</font>

244
00:13:04,460 --> 00:13:11,030
our<font color="#E5E5E5"> 48 again or any router</font><font color="#CCCCCC"> it will</font>

245
00:13:08,770 --> 00:13:14,060
direct the traffic to<font color="#CCCCCC"> our virtual</font>

246
00:13:11,030 --> 00:13:16,910
<font color="#E5E5E5">machine so this virtual</font><font color="#CCCCCC"> machine has two</font>

247
00:13:14,060 --> 00:13:18,920
components so<font color="#E5E5E5"> first is the</font><font color="#CCCCCC"> backend</font><font color="#E5E5E5"> so</font>

248
00:13:16,910 --> 00:13:21,110
this one<font color="#CCCCCC"> is one that</font><font color="#E5E5E5"> collects all the</font>

249
00:13:18,920 --> 00:13:24,530
data<font color="#E5E5E5"> from our honeypot and this one here</font>

250
00:13:21,110 --> 00:13:27,800
<font color="#E5E5E5">is</font><font color="#CCCCCC"> the honeypot itself so all the data</font>

251
00:13:24,530 --> 00:13:30,379
gathered here the samples the URL

252
00:13:27,800 --> 00:13:33,199
being downloaded<font color="#CCCCCC"> we'll go back here to</font>

253
00:13:30,379 --> 00:13:35,629
our type system<font color="#E5E5E5"> and this guy will be</font>

254
00:13:33,199 --> 00:13:41,809
<font color="#E5E5E5">trial system will be the one to be to</font>

255
00:13:35,629 --> 00:13:45,069
analyze<font color="#CCCCCC"> the data yeah and next so how do</font>

256
00:13:41,809 --> 00:13:48,290
<font color="#E5E5E5">we identify the mirror</font><font color="#CCCCCC"> variants so</font>

257
00:13:45,069 --> 00:13:50,988
originally<font color="#E5E5E5"> minerally was named after by</font>

258
00:13:48,290 --> 00:13:53,839
the strings or a command this<font color="#CCCCCC"> being</font>

259
00:13:50,989 --> 00:13:58,879
busybox me right<font color="#E5E5E5"> and me right up let not</font>

260
00:13:53,839 --> 00:14:01,790
<font color="#E5E5E5">phone so this is not a valid command so</font>

261
00:13:58,879 --> 00:14:03,980
it it is here since<font color="#E5E5E5"> these are commands</font>

262
00:14:01,790 --> 00:14:05,959
to determine if it<font color="#CCCCCC"> has successfully</font>

263
00:14:03,980 --> 00:14:09,079
brute force its way to our<font color="#CCCCCC"> target</font><font color="#E5E5E5"> and</font>

264
00:14:05,959 --> 00:14:12,349
<font color="#E5E5E5">IOT device so</font><font color="#CCCCCC"> Mirai was named with the</font>

265
00:14:09,079 --> 00:14:15,229
<font color="#E5E5E5">string so the same with the variant so</font>

266
00:14:12,350 --> 00:14:19,009
we have here an<font color="#CCCCCC"> example from</font><font color="#E5E5E5"> convict</font>

267
00:14:15,230 --> 00:14:21,860
configuration table of<font color="#E5E5E5"> amira variant so</font>

268
00:14:19,009 --> 00:14:22,639
it it changes you changes this one so

269
00:14:21,860 --> 00:14:25,100
<font color="#CCCCCC">beam</font><font color="#E5E5E5"> busybox</font>

270
00:14:22,639 --> 00:14:33,290
OMG a so we<font color="#E5E5E5"> can just name this variant</font>

271
00:14:25,100 --> 00:14:35,269
or OMG then next this<font color="#CCCCCC"> is the all the</font>

272
00:14:33,290 --> 00:14:39,410
<font color="#CCCCCC">variants</font><font color="#E5E5E5"> that we were able to identify</font>

273
00:14:35,269 --> 00:14:42,259
for the past year so this<font color="#E5E5E5"> is a word</font>

274
00:14:39,410 --> 00:14:46,399
cloud<font color="#E5E5E5"> so the bigger the word means that</font>

275
00:14:42,259 --> 00:14:48,410
it has more samples so we it's pretty

276
00:14:46,399 --> 00:14:50,679
obvious<font color="#E5E5E5"> already on who are the big names</font>

277
00:14:48,410 --> 00:14:54,589
here<font color="#E5E5E5"> sorry</font>

278
00:14:50,679 --> 00:14:56,259
<font color="#E5E5E5">yeah and you can also take a look on</font>

279
00:14:54,589 --> 00:14:58,939
some<font color="#CCCCCC"> of them maybe you you have</font>

280
00:14:56,259 --> 00:15:02,920
<font color="#E5E5E5">encountered them or heard before</font><font color="#CCCCCC"> like</font>

281
00:14:58,939 --> 00:15:06,368
<font color="#E5E5E5">Masuda maybe or okiru so yeah these are</font>

282
00:15:02,920 --> 00:15:10,939
<font color="#CCCCCC">all the variants that we have identified</font>

283
00:15:06,369 --> 00:15:17,480
<font color="#E5E5E5">so next slide so this is the variant</font>

284
00:15:10,939 --> 00:15:21,529
count so before 2018<font color="#CCCCCC"> we only identified</font>

285
00:15:17,480 --> 00:15:24,769
14 versions of<font color="#CCCCCC"> mirai</font><font color="#E5E5E5"> but now in the</font>

286
00:15:21,529 --> 00:15:29,350
european tape in<font color="#CCCCCC"> it suddenly</font><font color="#E5E5E5"> jump 41 in</font>

287
00:15:24,769 --> 00:15:32,929
<font color="#CCCCCC">January</font><font color="#E5E5E5"> so this also is in lines since</font>

288
00:15:29,350 --> 00:15:33,919
<font color="#E5E5E5">by this time instead of using brute</font>

289
00:15:32,929 --> 00:15:35,990
force logins

290
00:15:33,919 --> 00:15:39,139
<font color="#CCCCCC">manera</font><font color="#E5E5E5"> variants were using known</font>

291
00:15:35,990 --> 00:15:41,290
exploits so yeah that<font color="#E5E5E5"> was a big change</font>

292
00:15:39,139 --> 00:15:44,120
<font color="#E5E5E5">so we can</font><font color="#CCCCCC"> also see the trend</font>

293
00:15:41,290 --> 00:15:47,000
<font color="#E5E5E5">that it's going up every month</font><font color="#CCCCCC"> so by</font>

294
00:15:44,120 --> 00:15:53,990
<font color="#E5E5E5">August we already have 127</font><font color="#CCCCCC"> minute</font>

295
00:15:47,000 --> 00:15:57,020
<font color="#E5E5E5">variants</font><font color="#CCCCCC"> active so here is a sample</font>

296
00:15:53,990 --> 00:16:00,710
count for each<font color="#E5E5E5"> month of 2018 that we</font>

297
00:15:57,020 --> 00:16:03,439
process<font color="#E5E5E5"> so generally we had 2000 so if</font>

298
00:16:00,710 --> 00:16:05,660
you can see like every month<font color="#E5E5E5"> we almost</font>

299
00:16:03,440 --> 00:16:09,410
<font color="#CCCCCC">process more than more than</font><font color="#E5E5E5"> a thousand</font>

300
00:16:05,660 --> 00:16:11,930
samples then for example<font color="#E5E5E5"> here at me we</font>

301
00:16:09,410 --> 00:16:12,740
<font color="#E5E5E5">only have like</font><font color="#CCCCCC"> one thousand four hundred</font>

302
00:16:11,930 --> 00:16:17,000
<font color="#CCCCCC">five</font>

303
00:16:12,740 --> 00:16:20,750
so comparing it to the previous<font color="#CCCCCC"> slide so</font>

304
00:16:17,000 --> 00:16:23,750
<font color="#E5E5E5">April had 76 but May had 81 so there was</font>

305
00:16:20,750 --> 00:16:26,390
only<font color="#E5E5E5"> an increase by</font><font color="#CCCCCC"> five</font><font color="#E5E5E5"> so it would</font>

306
00:16:23,750 --> 00:16:28,460
mean<font color="#CCCCCC"> that since there are only</font><font color="#E5E5E5"> five new</font>

307
00:16:26,390 --> 00:16:30,800
variants<font color="#E5E5E5"> then there were also less</font>

308
00:16:28,460 --> 00:16:33,410
samples that we were that were being

309
00:16:30,800 --> 00:16:36,530
processed<font color="#E5E5E5"> then another example</font><font color="#CCCCCC"> here is</font>

310
00:16:33,410 --> 00:16:39,110
July so this was the peak<font color="#E5E5E5"> so we had a</font>

311
00:16:36,530 --> 00:16:42,650
lot<font color="#CCCCCC"> of samples</font><font color="#E5E5E5"> here so as we can see</font>

312
00:16:39,110 --> 00:16:46,580
July here so from 98<font color="#E5E5E5"> from June it jumped</font>

313
00:16:42,650 --> 00:16:53,300
<font color="#CCCCCC">to 117 so they were 19 new</font><font color="#E5E5E5"> variants in</font>

314
00:16:46,580 --> 00:16:55,670
July<font color="#E5E5E5"> so just last month so now</font><font color="#CCCCCC"> just to</font>

315
00:16:53,300 --> 00:16:59,180
filter out more the<font color="#E5E5E5"> data so we</font><font color="#CCCCCC"> have a</font>

316
00:16:55,670 --> 00:17:02,660
<font color="#E5E5E5">sample count per variant</font><font color="#CCCCCC"> so most samples</font>

317
00:16:59,180 --> 00:17:05,000
are still in me right so this shows<font color="#CCCCCC"> that</font>

318
00:17:02,660 --> 00:17:09,050
a lot of<font color="#E5E5E5"> people or a lot of cyber</font>

319
00:17:05,000 --> 00:17:10,880
<font color="#E5E5E5">criminals are testing</font><font color="#CCCCCC"> right maybe a lot</font>

320
00:17:09,050 --> 00:17:13,250
of<font color="#E5E5E5"> them are script kiddies who wants to</font>

321
00:17:10,880 --> 00:17:16,430
learn using<font color="#E5E5E5"> the</font><font color="#CCCCCC"> bots but a few are</font>

322
00:17:13,250 --> 00:17:19,130
really<font color="#E5E5E5"> are skillful on want to modify in</font>

323
00:17:16,430 --> 00:17:26,240
the<font color="#E5E5E5"> bot so again here we</font><font color="#CCCCCC"> have</font><font color="#E5E5E5"> the top</font><font color="#CCCCCC"> 5</font>

324
00:17:19,130 --> 00:17:28,610
<font color="#CCCCCC">mirai sora o re</font><font color="#E5E5E5"> Jojo and Daddy</font><font color="#CCCCCC"> l33t so</font>

325
00:17:26,240 --> 00:17:33,370
now we<font color="#CCCCCC"> proceed to the</font><font color="#E5E5E5"> targeted</font>

326
00:17:28,610 --> 00:17:37,250
architectures by<font color="#CCCCCC"> MRI</font><font color="#E5E5E5"> so all this here</font>

327
00:17:33,370 --> 00:17:39,439
<font color="#CCCCCC">Arijit</font><font color="#E5E5E5"> the boss can</font><font color="#CCCCCC"> be built the</font><font color="#E5E5E5"> bot can</font>

328
00:17:37,250 --> 00:17:43,370
be built<font color="#E5E5E5"> compatible for this</font>

329
00:17:39,440 --> 00:17:46,370
architecture so all of this<font color="#E5E5E5"> here we have</font>

330
00:17:43,370 --> 00:17:53,870
<font color="#CCCCCC">our</font><font color="#E5E5E5"> meats super</font><font color="#CCCCCC"> edge</font><font color="#E5E5E5"> spark</font><font color="#CCCCCC"> Motorola</font>

331
00:17:46,370 --> 00:17:54,830
<font color="#E5E5E5">Intel PowerPC AMD and IBM then next not</font>

332
00:17:53,870 --> 00:17:57,889
only this<font color="#CCCCCC"> Mira</font>

333
00:17:54,830 --> 00:18:01,039
<font color="#CCCCCC">audience and exploits to his</font><font color="#E5E5E5"> its arsenal</font>

334
00:17:57,890 --> 00:18:04,070
<font color="#E5E5E5">it also wants</font><font color="#CCCCCC"> to target</font><font color="#E5E5E5"> more devices so</font>

335
00:18:01,039 --> 00:18:05,539
by<font color="#CCCCCC"> doing this it</font><font color="#E5E5E5"> adds a new architecture</font>

336
00:18:04,070 --> 00:18:08,240
to target so this is the art

337
00:18:05,539 --> 00:18:11,120
<font color="#E5E5E5">international are compact processor so</font>

338
00:18:08,240 --> 00:18:13,580
this was discovered<font color="#CCCCCC"> January 2018 just</font>

339
00:18:11,120 --> 00:18:16,668
<font color="#E5E5E5">this year so it was initially</font><font color="#CCCCCC"> used by</font>

340
00:18:13,580 --> 00:18:19,789
<font color="#E5E5E5">Akira</font><font color="#CCCCCC"> Berlin and this is this was quite</font>

341
00:18:16,669 --> 00:18:22,309
a<font color="#E5E5E5"> big nuisance around 1.5 billion</font>

342
00:18:19,789 --> 00:18:26,600
<font color="#E5E5E5">products are dispatched per year using</font>

343
00:18:22,309 --> 00:18:28,158
this processor so if<font color="#E5E5E5"> okiru could in</font><font color="#CCCCCC"> fact</font>

344
00:18:26,600 --> 00:18:32,149
like just a<font color="#E5E5E5"> portion of these devices</font>

345
00:18:28,159 --> 00:18:35,000
then it could be<font color="#CCCCCC"> a big botnet</font><font color="#E5E5E5"> then after</font>

346
00:18:32,149 --> 00:18:38,149
okiru so other variants also<font color="#E5E5E5"> joining the</font>

347
00:18:35,000 --> 00:18:38,600
<font color="#E5E5E5">arc architecture so we have this six</font>

348
00:18:38,149 --> 00:18:42,860
here

349
00:18:38,600 --> 00:18:49,730
Masuda<font color="#E5E5E5"> or me root sauce chicken wings</font>

350
00:18:42,860 --> 00:18:52,459
<font color="#E5E5E5">and wicked so now we will take a look at</font>

351
00:18:49,730 --> 00:18:55,669
the exploits so it's quite a lot<font color="#E5E5E5"> so we</font>

352
00:18:52,460 --> 00:18:58,610
were able<font color="#CCCCCC"> to detect</font><font color="#E5E5E5"> 28 exploits being</font>

353
00:18:55,669 --> 00:19:02,059
used by the<font color="#CCCCCC"> mineral variants</font><font color="#E5E5E5"> so at least</font>

354
00:18:58,610 --> 00:19:05,360
16 16 of them are<font color="#E5E5E5"> an unauthenticated</font>

355
00:19:02,059 --> 00:19:07,760
<font color="#E5E5E5">exploits meaning that doesn't need to</font>

356
00:19:05,360 --> 00:19:10,399
have to login or doesn't<font color="#CCCCCC"> mid-valley</font>

357
00:19:07,760 --> 00:19:13,789
potentials to exploit an IOT device so

358
00:19:10,399 --> 00:19:17,719
this is quite<font color="#E5E5E5"> dangerous then 14 of the</font>

359
00:19:13,789 --> 00:19:20,419
exploits are from 2017 and 2018<font color="#CCCCCC"> so for</font>

360
00:19:17,720 --> 00:19:22,100
users that<font color="#E5E5E5"> don't pass their IOT device</font>

361
00:19:20,419 --> 00:19:24,789
<font color="#E5E5E5">even though they change their password</font>

362
00:19:22,100 --> 00:19:28,178
<font color="#E5E5E5">are still vulnerable by these exploits</font>

363
00:19:24,789 --> 00:19:32,090
so we have here the brands<font color="#CCCCCC"> that are</font>

364
00:19:28,179 --> 00:19:36,919
affected by the 28 exploits<font color="#E5E5E5"> so it ranges</font>

365
00:19:32,090 --> 00:19:39,199
<font color="#CCCCCC">from routers modems CCTV DVR IP cameras</font>

366
00:19:36,919 --> 00:19:42,110
web apps and<font color="#E5E5E5"> also minor software</font>

367
00:19:39,200 --> 00:19:44,269
products so for the specific vulnerable

368
00:19:42,110 --> 00:19:50,529
product maybe you<font color="#E5E5E5"> can just check online</font>

369
00:19:44,269 --> 00:19:55,010
<font color="#E5E5E5">on which a product is vulnerable to this</font>

370
00:19:50,529 --> 00:19:58,340
then now<font color="#CCCCCC"> we will proceed on</font><font color="#E5E5E5"> the main</font>

371
00:19:55,010 --> 00:20:01,970
variants by MRI so<font color="#CCCCCC"> Satori</font>

372
00:19:58,340 --> 00:20:05,059
or okiru so it was believed to<font color="#E5E5E5"> be coded</font>

373
00:20:01,970 --> 00:20:07,730
by<font color="#CCCCCC"> Nexus</font><font color="#E5E5E5"> data so this name was always in</font>

374
00:20:05,059 --> 00:20:09,730
the configuration table

375
00:20:07,730 --> 00:20:13,280
and this is one of<font color="#E5E5E5"> the most popular</font>

376
00:20:09,730 --> 00:20:16,850
modification of<font color="#E5E5E5"> Mirai so the loader was</font>

377
00:20:13,280 --> 00:20:19,490
<font color="#E5E5E5">embedded in its</font><font color="#CCCCCC"> pot then it included the</font>

378
00:20:16,850 --> 00:20:21,679
architecture art architecture<font color="#CCCCCC"> tastarga</font>

379
00:20:19,490 --> 00:20:24,740
<font color="#CCCCCC">so as we mentioned a</font><font color="#E5E5E5"> while ago</font><font color="#CCCCCC"> then it</font>

380
00:20:21,680 --> 00:20:29,750
<font color="#CCCCCC">uses exploits</font><font color="#E5E5E5"> to spread and one version</font>

381
00:20:24,740 --> 00:20:32,570
<font color="#CCCCCC">of it mines cryptocurrency</font><font color="#E5E5E5"> so let's take</font>

382
00:20:29,750 --> 00:20:35,480
a look on it<font color="#E5E5E5"> at its timeline so we first</font>

383
00:20:32,570 --> 00:20:40,879
saw this on December 2017

384
00:20:35,480 --> 00:20:43,250
so this CBE 2017<font color="#CCCCCC"> 17 to 1/5 buy</font><font color="#E5E5E5"> from</font>

385
00:20:40,880 --> 00:20:45,980
Huawei<font color="#E5E5E5"> so this is our remote code</font>

386
00:20:43,250 --> 00:20:49,490
execution<font color="#CCCCCC"> so by the time there were</font><font color="#E5E5E5"> no</font>

387
00:20:45,980 --> 00:20:51,970
details<font color="#E5E5E5"> of this exploit so we assume</font>

388
00:20:49,490 --> 00:20:56,180
<font color="#CCCCCC">that this vulnerability</font><font color="#E5E5E5"> used by this</font>

389
00:20:51,970 --> 00:21:00,470
botnet was<font color="#E5E5E5"> zero day and it was in fact a</font>

390
00:20:56,180 --> 00:21:04,220
zero<font color="#E5E5E5"> day and other exploits here are</font>

391
00:21:00,470 --> 00:21:08,960
from 2014<font color="#E5E5E5"> from</font><font color="#CCCCCC"> Realty targeting the</font>

392
00:21:04,220 --> 00:21:12,800
<font color="#E5E5E5">realtek SDK then we have here the CVE</font>

393
00:21:08,960 --> 00:21:17,810
2017 from<font color="#E5E5E5"> the Wi-Fi come so this one is</font>

394
00:21:12,800 --> 00:21:20,600
also important since around<font color="#CCCCCC"> 185,000</font>

395
00:21:17,810 --> 00:21:26,000
Wi-Fi cameras are vulnerable to<font color="#E5E5E5"> this one</font>

396
00:21:20,600 --> 00:21:29,179
this exploit and we have here docume OS

397
00:21:26,000 --> 00:21:31,700
<font color="#E5E5E5">command injection</font><font color="#CCCCCC"> to d-link</font><font color="#E5E5E5"> and HTTP</font>

398
00:21:29,180 --> 00:21:36,380
basic authentication bypass in go<font color="#E5E5E5"> ahead</font>

399
00:21:31,700 --> 00:21:39,680
<font color="#CCCCCC">web</font><font color="#E5E5E5"> then the interesting</font><font color="#CCCCCC"> stuff in this</font>

400
00:21:36,380 --> 00:21:42,590
<font color="#E5E5E5">one is this TV here right here so it</font>

401
00:21:39,680 --> 00:21:46,880
targets the<font color="#CCCCCC"> Claymore miner software so</font>

402
00:21:42,590 --> 00:21:50,560
what the botnet<font color="#E5E5E5"> do is it scans port 3 3</font>

403
00:21:46,880 --> 00:21:55,820
<font color="#E5E5E5">3 then it targets the claimer software</font>

404
00:21:50,560 --> 00:21:57,950
<font color="#E5E5E5">mining so what it what it do it changes</font>

405
00:21:55,820 --> 00:22:00,950
the destination wallet<font color="#E5E5E5"> so instead of</font>

406
00:21:57,950 --> 00:22:04,520
<font color="#CCCCCC">going to</font><font color="#E5E5E5"> the host or</font><font color="#CCCCCC"> the proper user it</font>

407
00:22:00,950 --> 00:22:07,610
changes the destination wallet to its

408
00:22:04,520 --> 00:22:10,490
own so<font color="#CCCCCC"> as you can see there</font><font color="#E5E5E5"> are command</font>

409
00:22:07,610 --> 00:22:17,000
here so we try<font color="#E5E5E5"> to check the</font><font color="#CCCCCC"> value of</font>

410
00:22:10,490 --> 00:22:21,580
this wallet<font color="#E5E5E5"> and as of general from I</font>

411
00:22:17,000 --> 00:22:25,570
<font color="#E5E5E5">think it just been used for a month so</font>

412
00:22:21,580 --> 00:22:30,080
the last payout was January 29 2018<font color="#CCCCCC"> and</font>

413
00:22:25,570 --> 00:22:32,960
it has been paid around<font color="#CCCCCC"> 3.33</font><font color="#E5E5E5"> at areum so</font>

414
00:22:30,080 --> 00:22:35,720
<font color="#E5E5E5">on generally the value</font><font color="#CCCCCC"> of at areum was</font><font color="#E5E5E5"> I</font>

415
00:22:32,960 --> 00:22:38,029
think around<font color="#CCCCCC"> one thousand US</font><font color="#E5E5E5"> dollar but</font>

416
00:22:35,720 --> 00:22:41,539
now it drop<font color="#CCCCCC"> already so by January</font><font color="#E5E5E5"> it</font>

417
00:22:38,029 --> 00:22:46,700
<font color="#CCCCCC">earned around 3.3 K</font><font color="#E5E5E5"> US dollar in a month</font>

418
00:22:41,539 --> 00:22:52,190
<font color="#E5E5E5">because</font><font color="#CCCCCC"> of this one and now we have the</font>

419
00:22:46,700 --> 00:22:55,340
next<font color="#E5E5E5"> version we call it</font><font color="#CCCCCC"> OMG or oo</font><font color="#E5E5E5"> MGA so</font>

420
00:22:52,190 --> 00:22:58,009
this turns out<font color="#CCCCCC"> II</font><font color="#E5E5E5"> devices into proxy</font>

421
00:22:55,340 --> 00:23:00,019
servers<font color="#E5E5E5"> so it contains still the</font>

422
00:22:58,009 --> 00:23:02,179
original<font color="#CCCCCC"> mirror I so it can still attack</font>

423
00:23:00,019 --> 00:23:04,909
it has<font color="#E5E5E5"> the killer and the scanner</font>

424
00:23:02,179 --> 00:23:07,970
functions then it<font color="#E5E5E5"> uses brute force to</font>

425
00:23:04,909 --> 00:23:12,230
<font color="#CCCCCC">login so you don't</font><font color="#E5E5E5"> have any exploit then</font>

426
00:23:07,970 --> 00:23:14,600
we discovered this in<font color="#CCCCCC"> February 2018 so</font>

427
00:23:12,230 --> 00:23:18,379
it uses<font color="#CCCCCC"> the</font><font color="#E5E5E5"> three proxy</font><font color="#CCCCCC"> it's a it is an</font>

428
00:23:14,600 --> 00:23:21,080
<font color="#CCCCCC">open-source</font><font color="#E5E5E5"> proxy server and how how</font>

429
00:23:18,379 --> 00:23:23,480
does<font color="#E5E5E5"> it turn</font><font color="#CCCCCC"> the IOT device to a proxy</font>

430
00:23:21,080 --> 00:23:26,960
<font color="#E5E5E5">server</font><font color="#CCCCCC"> so it</font><font color="#E5E5E5"> generates two random parts</font>

431
00:23:23,480 --> 00:23:30,950
for HTTP<font color="#E5E5E5"> and sub proxies</font><font color="#CCCCCC"> as you can see</font>

432
00:23:26,960 --> 00:23:37,100
here then from<font color="#E5E5E5"> there it will try</font><font color="#CCCCCC"> to</font>

433
00:23:30,950 --> 00:23:39,799
allow<font color="#CCCCCC"> traffic by so for the</font><font color="#E5E5E5"> proxy to</font>

434
00:23:37,100 --> 00:23:41,658
work properly<font color="#CCCCCC"> so if I roll a firewall</font>

435
00:23:39,799 --> 00:23:44,539
<font color="#CCCCCC">rule must</font><font color="#E5E5E5"> be added to allow the traffic</font>

436
00:23:41,659 --> 00:23:46,340
on the<font color="#E5E5E5"> randomly</font><font color="#CCCCCC"> generated ports</font><font color="#E5E5E5"> so once</font>

437
00:23:44,539 --> 00:23:49,970
the ports are generated<font color="#E5E5E5"> they are</font>

438
00:23:46,340 --> 00:23:52,820
reported at the C&C so we have here the

439
00:23:49,970 --> 00:23:56,990
command to add the firewall rule to<font color="#CCCCCC"> that</font>

440
00:23:52,820 --> 00:23:59,210
to that<font color="#CCCCCC"> port that generated port</font><font color="#E5E5E5"> so this</font>

441
00:23:56,990 --> 00:24:01,730
was<font color="#E5E5E5"> also significant in cyber criminals</font>

442
00:23:59,210 --> 00:24:03,830
can also earn money by renting out<font color="#CCCCCC"> this</font>

443
00:24:01,730 --> 00:24:06,320
proxy servers to other criminals who

444
00:24:03,830 --> 00:24:12,889
wants to hide their identity<font color="#E5E5E5"> or their</font>

445
00:24:06,320 --> 00:24:16,250
<font color="#E5E5E5">location so</font><font color="#CCCCCC"> next we we just</font><font color="#E5E5E5"> sum up this</font>

446
00:24:12,889 --> 00:24:18,590
<font color="#CCCCCC">Orissa</font><font color="#E5E5E5"> wicked and Omni variants since</font>

447
00:24:16,250 --> 00:24:21,559
the since<font color="#E5E5E5"> we believe that they were</font>

448
00:24:18,590 --> 00:24:24,139
coded by the<font color="#E5E5E5"> same malware author so the</font>

449
00:24:21,559 --> 00:24:27,379
author calls himself weekend<font color="#CCCCCC"> so with</font>

450
00:24:24,139 --> 00:24:30,860
this friend called<font color="#CCCCCC"> karma</font><font color="#E5E5E5"> of hope so</font>

451
00:24:27,379 --> 00:24:33,678
<font color="#CCCCCC">sorry you</font><font color="#E5E5E5"> Sora the this botnet uses</font>

452
00:24:30,860 --> 00:24:34,939
<font color="#CCCCCC">original Linux so this is a</font><font color="#E5E5E5"> cross</font>

453
00:24:33,679 --> 00:24:37,070
<font color="#E5E5E5">compiler</font><font color="#CCCCCC"> so</font>

454
00:24:34,940 --> 00:24:38,930
it is much easier<font color="#CCCCCC"> for the authors to</font>

455
00:24:37,070 --> 00:24:42,050
compile the<font color="#CCCCCC"> bot in different</font>

456
00:24:38,930 --> 00:24:44,030
architectures then this<font color="#CCCCCC"> variance or</font>

457
00:24:42,050 --> 00:24:47,810
commonly<font color="#E5E5E5"> uses exploits</font><font color="#CCCCCC"> other than</font>

458
00:24:44,030 --> 00:24:51,070
default passwords<font color="#E5E5E5"> and one of the sample</font>

459
00:24:47,810 --> 00:24:53,929
that<font color="#CCCCCC"> we found includes 11 exploits in it</font>

460
00:24:51,070 --> 00:24:57,639
<font color="#E5E5E5">so again</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> will try</font><font color="#CCCCCC"> to show a timeline</font>

461
00:24:53,930 --> 00:25:00,290
who<font color="#E5E5E5"> may be I think it's too small but</font>

462
00:24:57,640 --> 00:25:03,860
the first that we discovered was<font color="#CCCCCC"> over</font>

463
00:25:00,290 --> 00:25:06,080
<font color="#CCCCCC">Lisa it was</font><font color="#E5E5E5"> November 2017 so for this</font>

464
00:25:03,860 --> 00:25:12,320
time it was<font color="#E5E5E5"> just using default passwords</font>

465
00:25:06,080 --> 00:25:15,800
<font color="#E5E5E5">but as 2018 came he added exploits</font><font color="#CCCCCC"> like</font>

466
00:25:12,320 --> 00:25:18,649
every month then just June<font color="#E5E5E5"> think this is</font>

467
00:25:15,800 --> 00:25:23,480
June so<font color="#E5E5E5"> we found a sample that includes</font>

468
00:25:18,650 --> 00:25:26,090
all<font color="#CCCCCC"> this exploits so so this</font><font color="#E5E5E5"> version</font>

469
00:25:23,480 --> 00:25:28,190
<font color="#E5E5E5">takes advantage of using known</font><font color="#CCCCCC"> exploit</font>

470
00:25:26,090 --> 00:25:31,340
so these are all known exploits<font color="#E5E5E5"> rather</font>

471
00:25:28,190 --> 00:25:33,800
than discovering<font color="#CCCCCC"> zero day since this is</font>

472
00:25:31,340 --> 00:25:37,459
also<font color="#CCCCCC"> practical since</font><font color="#E5E5E5"> users don't usually</font>

473
00:25:33,800 --> 00:25:45,110
update their products and many<font color="#E5E5E5"> users are</font>

474
00:25:37,460 --> 00:25:47,090
<font color="#CCCCCC">just used and forget so with the number</font>

475
00:25:45,110 --> 00:25:49,639
<font color="#CCCCCC">of exploits in it so how does</font><font color="#E5E5E5"> this</font>

476
00:25:47,090 --> 00:25:53,120
<font color="#CCCCCC">variants</font><font color="#E5E5E5"> are</font><font color="#CCCCCC"> to switch exploit the use</font>

477
00:25:49,640 --> 00:25:55,790
in the vulnerable device<font color="#E5E5E5"> so what it does</font>

478
00:25:53,120 --> 00:25:58,969
is scan specific<font color="#CCCCCC"> ports by initiating a</font>

479
00:25:55,790 --> 00:26:01,399
<font color="#CCCCCC">rocket</font><font color="#E5E5E5"> scene so for example here it</font>

480
00:25:58,970 --> 00:26:06,020
tries<font color="#CCCCCC"> to connect to this part so we have</font>

481
00:26:01,400 --> 00:26:09,980
888<font color="#E5E5E5"> 443 80 and 81 so if it was able</font><font color="#CCCCCC"> to</font>

482
00:26:06,020 --> 00:26:11,900
establish<font color="#E5E5E5"> or check that this</font><font color="#CCCCCC"> up this</font>

483
00:26:09,980 --> 00:26:14,270
<font color="#E5E5E5">port is open it will use the</font>

484
00:26:11,900 --> 00:26:16,730
<font color="#CCCCCC">corresponding exploit so for example</font>

485
00:26:14,270 --> 00:26:21,320
port 88 is found to<font color="#CCCCCC"> be open it will use</font>

486
00:26:16,730 --> 00:26:23,090
the<font color="#CCCCCC"> RCE Netgear dgn 1000 exploit</font><font color="#E5E5E5"> so it</font>

487
00:26:21,320 --> 00:26:28,700
was the same with other exploits

488
00:26:23,090 --> 00:26:33,590
mentioned and to<font color="#CCCCCC"> finish</font><font color="#E5E5E5"> it up so this</font>

489
00:26:28,700 --> 00:26:35,960
<font color="#E5E5E5">one is just</font><font color="#CCCCCC"> like from omni</font><font color="#E5E5E5"> botnet so it</font>

490
00:26:33,590 --> 00:26:39,439
was<font color="#E5E5E5"> just mocking Brian Krebs so this is</font>

491
00:26:35,960 --> 00:26:42,380
the face of Brian Krebs here so for

492
00:26:39,440 --> 00:26:44,990
vulnerability devices so maybe<font color="#E5E5E5"> start</font>

493
00:26:42,380 --> 00:26:48,720
getting web servers or and it tries to

494
00:26:44,990 --> 00:26:51,750
<font color="#E5E5E5">remove the HTML</font><font color="#CCCCCC"> login that HTML</font>

495
00:26:48,720 --> 00:26:54,270
the<font color="#E5E5E5"> file here so</font><font color="#CCCCCC"> when it</font><font color="#E5E5E5"> once it removes</font>

496
00:26:51,750 --> 00:26:56,789
<font color="#E5E5E5">this one it will download it</font><font color="#CCCCCC"> will</font>

497
00:26:54,270 --> 00:26:59,370
download this<font color="#E5E5E5"> one meme so this is this</font>

498
00:26:56,789 --> 00:27:02,370
<font color="#E5E5E5">is the download URL and it will replace</font>

499
00:26:59,370 --> 00:27:04,199
<font color="#CCCCCC">it to be as</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> login</font><font color="#E5E5E5"> that HTML so if</font>

500
00:27:02,370 --> 00:27:06,510
you're the infected user then<font color="#E5E5E5"> you go to</font>

501
00:27:04,200 --> 00:27:10,470
your<font color="#CCCCCC"> login that HTML you</font><font color="#E5E5E5"> will see the</font>

502
00:27:06,510 --> 00:27:13,590
<font color="#E5E5E5">screen in your IOT device so it says it</font>

503
00:27:10,470 --> 00:27:15,990
<font color="#E5E5E5">says here use stop right there so once</font>

504
00:27:13,590 --> 00:27:18,449
your router fix no problem<font color="#E5E5E5"> send an email</font>

505
00:27:15,990 --> 00:27:21,630
<font color="#CCCCCC">to</font><font color="#E5E5E5"> Krebs on security at gmail.com and</font>

506
00:27:18,450 --> 00:27:27,570
<font color="#E5E5E5">we'll have it fixed awesome and Scarface</font>

507
00:27:21,630 --> 00:27:30,780
is<font color="#E5E5E5"> your daddy and now some</font><font color="#CCCCCC"> final</font>

508
00:27:27,570 --> 00:27:34,230
thoughts on<font color="#CCCCCC"> Mira barians</font><font color="#E5E5E5"> and our talk</font>

509
00:27:30,780 --> 00:27:38,220
today<font color="#E5E5E5"> so we still expect more exploits</font>

510
00:27:34,230 --> 00:27:41,820
that<font color="#E5E5E5"> will be added and then still more</font>

511
00:27:38,220 --> 00:27:43,590
<font color="#CCCCCC">vines will be appearing then another</font>

512
00:27:41,820 --> 00:27:45,780
thing<font color="#E5E5E5"> also is a modification of</font>

513
00:27:43,590 --> 00:27:48,178
encryption<font color="#E5E5E5"> of configuration</font><font color="#CCCCCC"> tables since</font>

514
00:27:45,780 --> 00:27:50,520
it's already predictable<font color="#E5E5E5"> maybe some</font>

515
00:27:48,179 --> 00:27:53,820
malware<font color="#E5E5E5"> author will try to change</font><font color="#CCCCCC"> it</font>

516
00:27:50,520 --> 00:27:55,980
then next is other means<font color="#CCCCCC"> to monetize in</font>

517
00:27:53,820 --> 00:28:00,990
fact that IOT devices other<font color="#E5E5E5"> than crypto</font>

518
00:27:55,980 --> 00:28:03,809
mining and proxy servers so as of now we

519
00:28:00,990 --> 00:28:05,669
have<font color="#E5E5E5"> many hub views experimented and</font>

520
00:28:03,809 --> 00:28:09,389
modified the code<font color="#CCCCCC"> for their own liking</font>

521
00:28:05,669 --> 00:28:12,990
<font color="#E5E5E5">and purpose variants have many variants</font>

522
00:28:09,390 --> 00:28:15,059
<font color="#E5E5E5">want to have a piece of the</font><font color="#CCCCCC"> IOT pie and</font>

523
00:28:12,990 --> 00:28:17,940
they are battling<font color="#E5E5E5"> to compromise more and</font>

524
00:28:15,059 --> 00:28:20,370
more vulnerability IOT devices so the

525
00:28:17,940 --> 00:28:28,950
question still<font color="#CCCCCC"> remains</font><font color="#E5E5E5"> who will be the</font>

526
00:28:20,370 --> 00:28:30,928
<font color="#E5E5E5">next me right thank you and thank you</font>

527
00:28:28,950 --> 00:28:33,830
very<font color="#E5E5E5"> much for mal yeah thank you are</font>

528
00:28:30,929 --> 00:28:33,830
there<font color="#CCCCCC"> any questions</font><font color="#E5E5E5"> from the</font><font color="#CCCCCC"> audience</font>

529
00:28:34,159 --> 00:28:37,650
<font color="#CCCCCC">ok if there</font><font color="#E5E5E5"> are no further</font><font color="#CCCCCC"> questions</font>

530
00:28:36,270 --> 00:28:38,908
please keep<font color="#E5E5E5"> your mind</font><font color="#CCCCCC"> that rimmel will</font>

531
00:28:37,650 --> 00:28:39,780
be available for the<font color="#CCCCCC"> rest of</font><font color="#E5E5E5"> the day</font>

532
00:28:38,909 --> 00:28:41,700
here<font color="#E5E5E5"> at a conference</font>

533
00:28:39,780 --> 00:28:46,129
<font color="#CCCCCC">so ask any questions that may come to</font>

534
00:28:41,700 --> 00:28:46,130
<font color="#CCCCCC">mind later</font><font color="#E5E5E5"> on thank you again</font><font color="#CCCCCC"> rimmel</font>

