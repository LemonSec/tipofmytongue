1
00:00:12,440 --> 00:00:13,490
up

2
00:00:13,490 --> 00:00:20,490
for school

3
00:00:28,259 --> 00:00:32,989
thank you very good precision of our
name so I think it's the first time

4
00:00:32,989 --> 00:00:34,780
someone pronounced incorrectly

5
00:00:34,780 --> 00:00:38,940
maybe they fight and your Italian is
something to do with it so I love you

6
00:00:38,940 --> 00:00:39,550
buddy.

7
00:00:39,550 --> 00:00:43,269
were honor to be here this I anniversary

8
00:00:43,269 --> 00:00:47,190
additional back in the box were
extremely jet lag because we are out

9
00:00:47,190 --> 00:00:48,840
yesterday I mean night so

10
00:00:48,840 --> 00:00:52,210
I apologize in advance if we we will

11
00:00:52,210 --> 00:00:55,840
of nonsense throughout the talk as usual

12
00:00:55,840 --> 00:00:59,850
but more than usual this time so yeah
could be really a problem

13
00:00:59,850 --> 00:01:03,440
so so the up we're gonna talk

14
00:01:03,440 --> 00:01:06,680
I'm raise then and there say I okay

15
00:01:06,680 --> 00:01:10,229
is moored at Miami okay so it a sibling

16
00:01:10,229 --> 00:01:13,960
on so we're going to talk about fred
goes to additional payment system

17
00:01:13,960 --> 00:01:16,970
are which is a way for us to do talk
about

18
00:01:16,970 --> 00:01:20,880
a few challenges that we fought our
interesting when hacking in bed to see

19
00:01:20,880 --> 00:01:21,450
since

20
00:01:21,450 --> 00:01:24,720
and the way to approach them and at the
end

21
00:01:24,720 --> 00:01:27,979
we will we will feature an example of
such

22
00:01:27,979 --> 00:01:31,710
act against and certain Apple device

23
00:01:31,710 --> 00:01:36,720
so embedded system so we have a lot of a
slide so we will try to go through fast

24
00:01:36,720 --> 00:01:38,430
that is awesome content so

25
00:01:38,430 --> 00:01:42,630
what does it mean an embedded system so
embedded system definition is

26
00:01:42,630 --> 00:01:47,869
is is a system which is part above are
more complex system

27
00:01:47,869 --> 00:01:51,220
and he's designed to do a very very
specific function

28
00:01:51,220 --> 00:01:54,829
arm so a for instance

29
00:01:54,829 --> 00:01:58,869
I'll 00 love you know examples of
embedded system

30
00:01:58,869 --> 00:02:03,229
a network router is a very a device
which is a very specific purposes so

31
00:02:03,229 --> 00:02:06,790
it's not like a general PCHR a computer
so it is referred to as an embedded

32
00:02:06,790 --> 00:02:07,520
system

33
00:02:07,520 --> 00:02:11,120
a printer could be an embedded system a
point-of-sale device

34
00:02:11,120 --> 00:02:15,329
smart cards are concerned about it sees
them automotive equipment

35
00:02:15,329 --> 00:02:18,440
we talk about in the posse are embedded
system Yani Tseng

36
00:02:18,440 --> 00:02:22,919
and so on also are if you have any
further and car on your laptop and as

37
00:02:22,919 --> 00:02:24,340
its own few more a tad

38
00:02:24,340 --> 00:02:27,530
is also considered to be an embedded
system are

39
00:02:27,530 --> 00:02:30,840
system management controller so prefer a
controller since on

40
00:02:30,840 --> 00:02:35,699
and is embedded system they can be just
microcontrollers weeds

41
00:02:35,699 --> 00:02:40,030
are more or less advanced of
functionality and

42
00:02:40,030 --> 00:02:41,460
and tiny

43
00:02:41,460 --> 00:02:46,220
few more so or they can also be more
complex systems

44
00:02:46,220 --> 00:02:49,970
I would fall real-time weiss's such as
its worst attacks

45
00:02:49,970 --> 00:02:54,690
systems so it's a very you know it's a
very large error very complex there

46
00:02:54,690 --> 00:02:55,520
there there

47
00:02:55,520 --> 00:02:58,610
you know several points to make so so
the talk

48
00:02:58,610 --> 00:03:04,090
we're gonna make I'll focuses on a few
specific issues that we fought our

49
00:03:04,090 --> 00:03:07,980
interesting because of course this field
is has been discussed

50
00:03:07,980 --> 00:03:12,430
you know to great lengths before and
there are many many presentation about

51
00:03:12,430 --> 00:03:17,590
exploding into the system so we try to
show you about a few specific items

52
00:03:17,590 --> 00:03:19,430
which we think are very unusual

53
00:03:19,430 --> 00:03:22,720
art they might have also on historical
value

54
00:03:22,720 --> 00:03:26,040
hand that we think are interesting too
to

55
00:03:26,040 --> 00:03:29,180
to discuss on so

56
00:03:29,180 --> 00:03:32,490
are yup 01

57
00:03:32,490 --> 00:03:36,220
one of the first thing that usually we
do and when we start talking

58
00:03:36,220 --> 00:03:39,700
an embedded system is you know um

59
00:03:39,700 --> 00:03:42,790
we are starting looking for a some
debugging

60
00:03:42,790 --> 00:03:45,980
so console interfacing to the in bed

61
00:03:45,980 --> 00:03:49,010
um and the vast majority of the

62
00:03:49,010 --> 00:03:53,300
but the system is usually the the Expos
interfaces like you know

63
00:03:53,300 --> 00:03:56,820
a serial interfaces like rice 22 in this
case

64
00:03:56,820 --> 00:04:00,170
or a OJ a quartz

65
00:04:00,170 --> 00:04:05,580
or tolsey on in the case will follow
suit on the interface it's a

66
00:04:05,580 --> 00:04:09,650
it's very easy in to use it to use those
kind

67
00:04:09,650 --> 00:04:13,020
interface and it's very easy to you to
find out

68
00:04:13,020 --> 00:04:16,630
eventually the pin out of of the
interface itself

69
00:04:16,630 --> 00:04:20,450
in the case you don't documentation of
of the interface

70
00:04:20,450 --> 00:04:23,730
with DJ taga thing scandia

71
00:04:23,730 --> 00:04:26,920
a more complex especially the

72
00:04:26,920 --> 00:04:30,850
especially the procedure of finding out
to the

73
00:04:30,850 --> 00:04:34,230
the interface pinout can be very the

74
00:04:34,230 --> 00:04:38,580
complex and time-consuming Anna and the

75
00:04:38,580 --> 00:04:44,200
board manufacturers vendors can be
sometimes they can implement to I'll

76
00:04:44,200 --> 00:04:48,870
are more protections or software
protections by other protection I mean

77
00:04:48,870 --> 00:04:51,990
Tom o0 I'm racist or serb on Fuse

78
00:04:51,990 --> 00:04:55,520
or every protection that makes

79
00:04:55,520 --> 00:04:59,450
the a jay Park interface not operating
at all

80
00:04:59,450 --> 00:05:03,210
so you need to actually this older or
solar

81
00:05:03,210 --> 00:05:07,900
racist or some the board so you need to
perform in electric analysis of the

82
00:05:07,900 --> 00:05:08,500
bargain

83
00:05:08,500 --> 00:05:12,360
understand what what you need to do
before starting actually using the

84
00:05:12,360 --> 00:05:16,320
the data interface so by social
protection I mean

85
00:05:16,320 --> 00:05:20,010
a.m. sometimes a me the vendor

86
00:05:20,010 --> 00:05:23,210
can't pretend a custom initialization
sequence

87
00:05:23,210 --> 00:05:28,200
sequence then can be very very complex
in terms of a

88
00:05:28,200 --> 00:05:31,370
timing full

89
00:05:31,370 --> 00:05:34,710
by buying the city's issue sequence a
mean that you have to other

90
00:05:34,710 --> 00:05:37,800
to perform some a some sequence

91
00:05:37,800 --> 00:05:41,440
some electric I see elect electric a
sequence

92
00:05:41,440 --> 00:05:45,140
against the j2ee interface so for
response you have to

93
00:05:45,140 --> 00:05:49,280
upkeep upkeep I E 1 pin for I don't know

94
00:05:49,280 --> 00:05:52,729
to me second Sen and after that you

95
00:05:52,729 --> 00:05:56,010
you can actually use use the gtalk the
tape port

96
00:05:56,010 --> 00:06:00,080
up so I say for serial interface

97
00:06:00,080 --> 00:06:04,850
the it's a very it's very easy and the
process of discovering the pin out the

98
00:06:04,850 --> 00:06:05,690
straightforward

99
00:06:05,690 --> 00:06:10,190
you have just called act a.m. usually we
use a logical analyzer

100
00:06:10,190 --> 00:06:14,490
you can just the you can just do this
ignore on approach you can just connect

101
00:06:14,490 --> 00:06:14,979
every

102
00:06:14,979 --> 00:06:18,669
enough to be exposed by the interface to
the logical analyzer

103
00:06:18,669 --> 00:06:22,479
you starts to your your city for you
start to see if

104
00:06:22,479 --> 00:06:25,970
all the all the the the change in the

105
00:06:25,970 --> 00:06:29,030
DC notes that you are on monitoring

106
00:06:29,030 --> 00:06:32,820
you're able to your target the device
because of course you know during the

107
00:06:32,820 --> 00:06:35,820
during the procedure about the device

108
00:06:35,820 --> 00:06:40,210
usually from usually eat her

109
00:06:40,210 --> 00:06:43,350
883 lake summed up the on the

110
00:06:43,350 --> 00:06:46,470
DC console and the

111
00:06:46,470 --> 00:06:50,169
of course at this point we we wait for
some that are coming out

112
00:06:50,169 --> 00:06:53,350
to to one of the peace that we are
monitoring at that time

113
00:06:53,350 --> 00:06:56,470
use this will be you know a good TX
candidate

114
00:06:56,470 --> 00:07:00,450
well at this point at this point

115
00:07:00,450 --> 00:07:04,919
it's very important to be able to
estimate all this you will permit this

116
00:07:04,919 --> 00:07:08,159
you see is usually very easy so we just
just you know

117
00:07:08,159 --> 00:07:11,490
we just have to estimate the ball great
looking at the time

118
00:07:11,490 --> 00:07:16,729
of seeking a we just to estimate the BB
pistol beat the party in

119
00:07:16,729 --> 00:07:19,950
of course the to be taller /url

120
00:07:19,950 --> 00:07:23,800
be the other thing that can be really
beat knowing it's the

121
00:07:23,800 --> 00:07:28,940
its to to understand the logic because
sometimes we ever see the interface that

122
00:07:28,940 --> 00:07:33,030
that will tweet inverted logic that
means that we need to are they

123
00:07:33,030 --> 00:07:37,260
a.m. a not and not see you quit before

124
00:07:37,260 --> 00:07:40,849
before of the the SUNY

125
00:07:40,849 --> 00:07:44,240
and of course a as far as we know we
know that the

126
00:07:44,240 --> 00:07:48,979
X weekend we can try to brute force for
for Brax

127
00:07:48,979 --> 00:07:52,979
looking good some feedback on the
previously found that these

128
00:07:52,979 --> 00:07:56,300
and that's pretty pretty simple

129
00:07:56,300 --> 00:08:00,490
here we have an example of logical
analyzer connected to

130
00:08:00,490 --> 00:08:03,529
all the pieces posted by this this
interface

131
00:08:03,529 --> 00:08:07,260
and yeah at some point rebooting the
device

132
00:08:07,260 --> 00:08:10,909
we can see that there is some data out
from from the interfaces

133
00:08:10,909 --> 00:08:14,539
John being space to space some

134
00:08:14,539 --> 00:08:18,969
something else an and yeah and here we
have a

135
00:08:18,969 --> 00:08:24,229
the a picture of very simple secret that
its use

136
00:08:24,229 --> 00:08:27,630
sometimes so depending by devoted

137
00:08:27,630 --> 00:08:31,110
of the serial interface we maybe need
the

138
00:08:31,110 --> 00:08:34,990
some voltage conversion before actually
going to the

139
00:08:34,990 --> 00:08:38,060
to to RPC or some US

140
00:08:38,060 --> 00:08:41,390
some serial to USB converter you need to
perform

141
00:08:41,390 --> 00:08:46,150
a vote that's conversion from ppl from
05

142
00:08:46,150 --> 00:08:49,230
its -12 last load

143
00:08:49,230 --> 00:08:53,700
but you and that's it for this year CIA
interface

144
00:08:53,700 --> 00:08:58,010
on so is safe for the Jake dawg things
can be more complicated

145
00:08:58,010 --> 00:09:02,930
and that's because Jake the GUI
interface it's not fully standardized

146
00:09:02,930 --> 00:09:06,800
income cell phone number and position of
the peace in knowing

147
00:09:06,800 --> 00:09:12,490
in the interface so every vendor could
do basically whatever whatever whatever

148
00:09:12,490 --> 00:09:15,920
he wants and the mmm

149
00:09:15,920 --> 00:09:19,940
the the other important thing to
understand is that sometimes

150
00:09:19,940 --> 00:09:24,220
found in the Jeep 40s not so interesting
because

151
00:09:24,220 --> 00:09:27,870
a also the features that can be
implemented through this

152
00:09:27,870 --> 00:09:32,600
the scene two-face is something that its
vendor dependents and some vendor

153
00:09:32,600 --> 00:09:36,930
just will be DJ support for boundaries
con

154
00:09:36,930 --> 00:09:40,910
boundary scan feature what what does it
mean it means that with each

155
00:09:40,910 --> 00:09:44,640
with does Jake accords we can just a

156
00:09:44,640 --> 00:09:48,330
we can just perform some electrical
passed the to see if

157
00:09:48,330 --> 00:09:52,050
the connection between the different
integrated circuits on the

158
00:09:52,050 --> 00:09:56,020
on the Jaipur chain are connected are
properly connected them out

159
00:09:56,020 --> 00:10:00,460
up the other features that it's more
interesting when you are

160
00:10:00,460 --> 00:10:04,330
talking to some embedded devices the
issue the bugging feature

161
00:10:04,330 --> 00:10:07,850
up it means that through digital port
you can perform

162
00:10:07,850 --> 00:10:11,260
a more a bus operations against the CPU
lights

163
00:10:11,260 --> 00:10:14,820
you single stepping back pointing and
you know I think full

164
00:10:14,820 --> 00:10:18,500
assist the read/write assisted the

165
00:10:18,500 --> 00:10:21,620
to the system memory awesome 3d

166
00:10:21,620 --> 00:10:26,820
to reject a stunning the Jaipur so the
process

167
00:10:26,820 --> 00:10:31,440
the processing on a finding that being
out of the Jaipur interface

168
00:10:31,440 --> 00:10:35,220
it's more complicated to the to the
serial

169
00:10:35,220 --> 00:10:38,580
suing to interface on

170
00:10:38,580 --> 00:10:41,750
and the Jacob or so

171
00:10:41,750 --> 00:10:45,089
can the sometimes exposed a large number
of beans

172
00:10:45,089 --> 00:10:48,470
but we have to focus our attention only
to be so

173
00:10:48,470 --> 00:10:53,220
this set of bees a so we are focusing
our attention

174
00:10:53,220 --> 00:10:56,580
only two that's the plane best about
this clock and

175
00:10:56,580 --> 00:11:00,820
small select and of course okay we have
also keep in mind that

176
00:11:00,820 --> 00:11:03,930
it can be that's why is it

177
00:11:03,930 --> 00:11:07,310
up being that that we need to to to keep

178
00:11:07,310 --> 00:11:10,540
to keep it high in order to be to
protect their

179
00:11:10,540 --> 00:11:14,959
than ideological to protect the rise
above

180
00:11:14,959 --> 00:11:18,310
and of course oh so BCC and ground they
are also

181
00:11:18,310 --> 00:11:21,829
so interesting so first thing we always
start

182
00:11:21,829 --> 00:11:24,850
we start finding the wrong that's easy
because we

183
00:11:24,850 --> 00:11:29,070
just just usually usually using a with
the matter we can

184
00:11:29,070 --> 00:11:32,589
we can check for sure seek within the
board so

185
00:11:32,589 --> 00:11:35,680
from knowing knowing where the ground is

186
00:11:35,680 --> 00:11:38,959
is located in some point the flow of
blood weekend

187
00:11:38,959 --> 00:11:43,180
estimated the the position of being in
the tape again

188
00:11:43,180 --> 00:11:48,139
after doing this up we have to estimate
today the DBCC

189
00:11:48,139 --> 00:11:51,579
because we have to keep the BCC in the
ground outside

190
00:11:51,579 --> 00:11:55,720
the range of the pin that we we want to
logic police con

191
00:11:55,720 --> 00:12:00,000
and that the phone to BCC we can use
this this technique it's fairly

192
00:12:00,000 --> 00:12:03,750
um easy and then and it works

193
00:12:03,750 --> 00:12:07,329
we can just the use a progress the store

194
00:12:07,329 --> 00:12:10,470
something our own I don't know few under
the homes

195
00:12:10,470 --> 00:12:13,870
it the it really depends by devote part
of the

196
00:12:13,870 --> 00:12:16,889
of the J to get the fish you are walking

197
00:12:16,889 --> 00:12:20,680
working with effete if the interface
it's working with 50 yds

198
00:12:20,680 --> 00:12:23,750
it would be safe to use a $500 on to
cause

199
00:12:23,750 --> 00:12:28,320
you know the the idea behind behind this
is that we want to keep the car and

200
00:12:28,320 --> 00:12:33,220
the current above do something like fan
media empires

201
00:12:33,220 --> 00:12:36,779
on and if you are if you are working
with an interface working with

202
00:12:36,779 --> 00:12:39,930
lot free votes you can just use a free
on

203
00:12:39,930 --> 00:12:45,670
book owns arrest and what what we do is
basically we try to pull down

204
00:12:45,670 --> 00:12:49,110
every single every single pin in the
Jaipur or and

205
00:12:49,110 --> 00:12:53,180
when when we phone sumpin that it's not
easily

206
00:12:53,180 --> 00:12:57,490
you know it cannot be easily cool down

207
00:12:57,490 --> 00:13:01,620
with a with a $5,500 on register it
means that

208
00:13:01,620 --> 00:13:05,019
it will be a good VCC candidate

209
00:13:05,019 --> 00:13:08,380
so at this time we have BCC and we have
ground

210
00:13:08,380 --> 00:13:12,029
so we can start actually per floor you
can start to

211
00:13:12,029 --> 00:13:16,560
to actually perform a scan against the
against all the peace in the Jeep

212
00:13:16,560 --> 00:13:21,019
booked in order to find this the east
side of beans

213
00:13:21,019 --> 00:13:24,800
up so I'll

214
00:13:24,800 --> 00:13:29,509
this coming the this coming means
cutting that that we are going to use

215
00:13:29,509 --> 00:13:32,819
a it does be the to be a this

216
00:13:32,819 --> 00:13:38,060
this the speech has to be to present the
large number of GPAs this is very useful

217
00:13:38,060 --> 00:13:39,740
especially when you're standing

218
00:13:39,740 --> 00:13:43,470
a Big Data Corp it a look a large number
of peace

219
00:13:43,470 --> 00:13:47,839
we don't want to to you not to Manuel
remove the move contact us using this

220
00:13:47,839 --> 00:13:48,740
number C

221
00:13:48,740 --> 00:13:52,610
and that's why we are looking for some
device wheat with a lot of

222
00:13:52,610 --> 00:13:57,149
educate us um view all your speed is not
relevant during the GITEX cutting

223
00:13:57,149 --> 00:13:58,519
process because

224
00:13:58,519 --> 00:14:01,600
on because it's something that its
control it

225
00:14:01,600 --> 00:14:05,990
by the we do it with them with a

226
00:14:05,990 --> 00:14:09,240
with that the clock with that this clock
signal

227
00:14:09,240 --> 00:14:13,089
so it can it can be controlled by
discounting device

228
00:14:13,089 --> 00:14:16,120
a and yeah microcontrollers are the
perfect

229
00:14:16,120 --> 00:14:19,940
the perfect tool for for doing this job
because they have a large number of

230
00:14:19,940 --> 00:14:21,019
chaos in

231
00:14:21,019 --> 00:14:24,790
and they are fast enough to to do the
job up

232
00:14:24,790 --> 00:14:28,709
so here in this night's a do is the

233
00:14:28,709 --> 00:14:32,500
the top for the up will

234
00:14:32,500 --> 00:14:36,240
state machine what is the thought that
the up control there is a

235
00:14:36,240 --> 00:14:39,810
from is a 16 is a 16

236
00:14:39,810 --> 00:14:43,490
us stage state machine

237
00:14:43,490 --> 00:14:49,040
that basically control it so the logical
me inside the DJ puck to 'em

238
00:14:49,040 --> 00:14:52,149
of the of the integrated see and

239
00:14:52,149 --> 00:14:55,540
a.m. so we have three different stunning

240
00:14:55,540 --> 00:14:59,839
strategies a they are all based good

241
00:14:59,839 --> 00:15:04,160
they are all bases on the same concept
basically the idea is that week

242
00:15:04,160 --> 00:15:07,160
boot we we week bush a law

243
00:15:07,160 --> 00:15:10,879
logical pattern 1010 and so on

244
00:15:10,879 --> 00:15:14,660
in the TV in the TDI a.m. in the TDI

245
00:15:14,660 --> 00:15:21,100
the best that I mean in we we controlled
the clock so we'll raise

246
00:15:21,100 --> 00:15:25,430
we the raisin full we make a rising

247
00:15:25,430 --> 00:15:28,980
rising edge and the following is on
their own slope

248
00:15:28,980 --> 00:15:33,060
and we we got to look for the for some
that are coming out

249
00:15:33,060 --> 00:15:37,040
to the to be that thou and we can of
course

250
00:15:37,040 --> 00:15:40,500
we can estimate if the spot attorneys
the same that we have

251
00:15:40,500 --> 00:15:44,029
boosting today didn't the TDI on

252
00:15:44,029 --> 00:15:47,680
on this this stand

253
00:15:47,680 --> 00:15:50,790
which is a fist on the strategy really
the fence by

254
00:15:50,790 --> 00:15:54,769
we cheese the the common which is the
default common

255
00:15:54,769 --> 00:15:58,449
that it's a implemented the by the
vendor

256
00:15:58,449 --> 00:16:01,779
in that specific J so sometimes a

257
00:16:01,779 --> 00:16:07,410
they did someplace in the the default
common these the bypass instruction

258
00:16:07,410 --> 00:16:10,449
something something I S something I see

259
00:16:10,449 --> 00:16:14,589
be the call um

260
00:16:14,589 --> 00:16:18,620
yeah I i mean i i just the I would just
stop europe

261
00:16:18,620 --> 00:16:21,870
mmm talking about the Jaipur stunning
because

262
00:16:21,870 --> 00:16:25,779
a few are you interested in to this
topic we can just the

263
00:16:25,779 --> 00:16:29,279
maybe you can just us after and we can
we can show you

264
00:16:29,279 --> 00:16:34,439
%ah little bit more relaxed simple Sen
and other things but

265
00:16:34,439 --> 00:16:39,410
but yeah it's a as say the key can be
very complicated depending by

266
00:16:39,410 --> 00:16:42,939
but what the Pandora the vendor be

267
00:16:42,939 --> 00:16:47,050
device up the other thing that it's very
important when we

268
00:16:47,050 --> 00:16:50,170
were when we started knocking a an
embedded system

269
00:16:50,170 --> 00:16:53,540
is you know is a we first of all we

270
00:16:53,540 --> 00:16:57,139
usually are interesting too I think the
few more of their vice

271
00:16:57,139 --> 00:17:01,110
itself and lot of time the the few
months of its

272
00:17:01,110 --> 00:17:04,370
stored indicator the flash memories

273
00:17:04,370 --> 00:17:07,560
and usually a.m. nowadays

274
00:17:07,560 --> 00:17:10,939
these flash memories a.m. are speaking
to

275
00:17:10,939 --> 00:17:14,540
two main protocol its SPI and they score
see

276
00:17:14,540 --> 00:17:17,740
oh yeah well as some must-see it's the
same

277
00:17:17,740 --> 00:17:21,290
it's a score see at the end am

278
00:17:21,290 --> 00:17:24,530
and the here vendors Kenny

279
00:17:24,530 --> 00:17:27,780
cannot simply meant some sort the first
elections

280
00:17:27,780 --> 00:17:31,530
some sort of you know us control um

281
00:17:31,530 --> 00:17:34,630
process and sometimes

282
00:17:34,630 --> 00:17:38,550
in order to be able to have for read
right process for the memories

283
00:17:38,550 --> 00:17:43,060
a.m. we have to %uh physically removed
those memories from

284
00:17:43,060 --> 00:17:46,110
to physically the so that the memory the
Chi from the

285
00:17:46,110 --> 00:17:51,790
from the board because otherwise from
you last see it's impossible to bypass

286
00:17:51,790 --> 00:17:55,300
by possibly defend the restriction

287
00:17:55,300 --> 00:17:58,960
and so yeah on this is an example

288
00:17:58,960 --> 00:18:02,980
noriko sold this is a %uh

289
00:18:02,980 --> 00:18:06,210
this is an SPI memory the so they're
from from the board

290
00:18:06,210 --> 00:18:09,710
and in this way using using tools like a

291
00:18:09,710 --> 00:18:13,240
the FTD module over this month

292
00:18:13,240 --> 00:18:17,480
Yaritza NSP I to you for not going back
thirty XT

293
00:18:17,480 --> 00:18:21,180
school as you can see they are very very
small this is

294
00:18:21,180 --> 00:18:24,730
the season rj-45 connector uses you
speak

295
00:18:24,730 --> 00:18:28,350
just make you an idea of thing

296
00:18:28,350 --> 00:18:31,450
and yet you have various solution here

297
00:18:31,450 --> 00:18:35,130
in order to be able to read to read the
data from the from the memory

298
00:18:35,130 --> 00:18:39,280
you can use a custom program at
microcontroller and we have an example

299
00:18:39,280 --> 00:18:42,030
here I i'm not going to show it because

300
00:18:42,030 --> 00:18:46,870
to be weekly on and so using
microcontrollers it's it's quite easy to

301
00:18:46,870 --> 00:18:49,040
perform you know to make a breach

302
00:18:49,040 --> 00:18:52,530
between the SPI interface of the memory
and the

303
00:18:52,530 --> 00:18:56,370
and moderates like txt for instance so
you can send

304
00:18:56,370 --> 00:19:00,090
the data from the SPI China the memory
to the

305
00:19:00,090 --> 00:19:03,470
to the TCPIP stream

306
00:19:03,470 --> 00:19:07,700
or you can use the you can use a to its
like flax from

307
00:19:07,700 --> 00:19:10,800
flesh is compatible with the FTD for

308
00:19:10,800 --> 00:19:13,870
with this module or you can use

309
00:19:13,870 --> 00:19:19,730
SPI spicy come back to sleep the sting

310
00:19:19,730 --> 00:19:23,090
okay so yeah I think so you did good
grocery that

311
00:19:23,090 --> 00:19:26,750
yeah I try to be to be

312
00:19:26,750 --> 00:19:29,940
we you understand so

313
00:19:29,940 --> 00:19:33,610
up so we mention of course that's a

314
00:19:33,610 --> 00:19:37,580
that sometimes you you might need to to
read the actual physical memory for

315
00:19:37,580 --> 00:19:38,300
getting

316
00:19:38,300 --> 00:19:42,320
I forgetting to fear were of course
eventually one of the things you want to

317
00:19:42,320 --> 00:19:45,850
do anyone exploit system is specially if
you also have an update

318
00:19:45,850 --> 00:19:49,179
in your hands and you won outright
modified out in order to push it to your

319
00:19:49,179 --> 00:19:49,929
device

320
00:19:49,929 --> 00:19:52,750
is a God in the same what kind of check
some other team is being implemented

321
00:19:52,750 --> 00:19:54,409
because of course if you

322
00:19:54,409 --> 00:19:58,610
if you mess with VMware if you change it
that check someone on match

323
00:19:58,610 --> 00:20:02,700
any sometimes can be trivial it can be
extremely easy and sometimes can be

324
00:20:02,700 --> 00:20:06,679
quite complicated and quite boring and
tedious 22

325
00:20:06,679 --> 00:20:11,110
I to to do of course the to get the good
news is that

326
00:20:11,110 --> 00:20:16,250
in these area still nowadays I would say
to 95 percent overall the embedded

327
00:20:16,250 --> 00:20:17,890
firmware is on

328
00:20:17,890 --> 00:20:22,090
on on the system we talk about you don't
have any security professional

329
00:20:22,090 --> 00:20:22,870
seamstress

330
00:20:22,870 --> 00:20:25,950
verification you you might have been la
Borie

331
00:20:25,950 --> 00:20:29,539
check some same place by there mostly
for integrity reasons and not for

332
00:20:29,539 --> 00:20:31,909
security reasons even if sometimes

333
00:20:31,909 --> 00:20:35,159
their use for security arm in

334
00:20:35,159 --> 00:20:38,210
in the way that as you don't know dr.
greedy you know

335
00:20:38,210 --> 00:20:42,090
its obfuscated to you then they think it
is a security measure in this is very

336
00:20:42,090 --> 00:20:42,640
calm

337
00:20:42,640 --> 00:20:46,279
I mean every time we approach wanna be
cease and desist this is how it is

338
00:20:46,279 --> 00:20:50,010
on so when you have a few more and you

339
00:20:50,010 --> 00:20:52,990
are due to some we take on anyone
understand what kinda checked some other

340
00:20:52,990 --> 00:20:54,179
reading these issues

341
00:20:54,179 --> 00:20:58,750
um Mozilla ties were talking about CRC
42 or variance and of course

342
00:20:58,750 --> 00:21:01,870
one of the main things that you
shouldn't look for is the polynomial

343
00:21:01,870 --> 00:21:02,850
which is used

344
00:21:02,850 --> 00:21:06,130
are for doing a computation so if you
find

345
00:21:06,130 --> 00:21:10,990
destroying or rather if you find the
reverse representation of

346
00:21:10,990 --> 00:21:14,559
the sprawling don't know which is just
under one using crc32

347
00:21:14,559 --> 00:21:17,710
so if you find the string you you will
know

348
00:21:17,710 --> 00:21:21,309
you know for sure unless you know
there's a chance that that's

349
00:21:21,309 --> 00:21:25,970
up 'cause are used for something else
that you're dealing with a CRC 42

350
00:21:25,970 --> 00:21:30,200
but there are some some some some
exception to this true

351
00:21:30,200 --> 00:21:33,830
I which we think I were discussing so
first of all

352
00:21:33,830 --> 00:21:37,940
once you identify 2.0 know once you you
you try to figure out what what would

353
00:21:37,940 --> 00:21:40,010
other means we're talking about

354
00:21:40,010 --> 00:21:43,330
there's one very good important thing to
keep in mind is that most

355
00:21:43,330 --> 00:21:48,179
a CRC other regions they came in at at
95 following what's a call as the rocks

356
00:21:48,179 --> 00:21:49,650
off the rocks of model

357
00:21:49,650 --> 00:21:54,360
so the rocks for the mall the specified
standard prom enters that can reach unit

358
00:21:54,360 --> 00:21:54,730
can

359
00:21:54,730 --> 00:21:59,460
change apply to a stunner augury do and
from there you can reproduce all the

360
00:21:59,460 --> 00:22:02,080
different flavor subjects a mockery

361
00:22:02,080 --> 00:22:05,380
so for instance if you wanna have
display

362
00:22:05,380 --> 00:22:09,289
represents your c16 crc32 the POSIX
variant

363
00:22:09,289 --> 00:22:13,700
or stunt RC SC 42 or chance you're see
which is a valiant

364
00:22:13,700 --> 00:22:17,880
CRC we can old we can always do that by

365
00:22:17,880 --> 00:22:21,950
a representing the scrum so the
polynomial

366
00:22:21,950 --> 00:22:25,409
are which is what's used for generating
CRC

367
00:22:25,409 --> 00:22:28,690
we have a need any so he's Asian factor
are

368
00:22:28,690 --> 00:22:32,960
we have or %ah mentors which tell us how
the different bites untreated

369
00:22:32,960 --> 00:22:36,360
in two different stages and we have a
value which is

370
00:22:36,360 --> 00:22:39,460
soared to the final output and then

371
00:22:39,460 --> 00:22:45,049
there's also check which eases on the
check some of the ASCII string 123 456

372
00:22:45,049 --> 00:22:46,010
789

373
00:22:46,010 --> 00:22:49,309
which is very useful when you want to
compare stand I'll

374
00:22:49,309 --> 00:22:53,850
which kinda bothering discussion about
and and so for instance

375
00:22:53,850 --> 00:22:57,179
even if you find the polynomial which is

376
00:22:57,179 --> 00:23:02,500
related CSC 42 in my not beast undersea
SC 42 free said

377
00:23:02,500 --> 00:23:05,809
jam CRC it's a variant CRC 42

378
00:23:05,809 --> 00:23:08,980
which the fares also for it for text or
out

379
00:23:08,980 --> 00:23:13,610
check and and and Easter bullion's any
needs to completely different results

380
00:23:13,610 --> 00:23:17,789
and you might be fooled by the fact that
you will find out polynomial might be

381
00:23:17,789 --> 00:23:21,059
short and its US east on the CSC for you
to be in use

382
00:23:21,059 --> 00:23:24,110
and then you mine or realize that he
said is Jen CRC

383
00:23:24,110 --> 00:23:29,529
because because it's a different favor
are and once you know these changes

384
00:23:29,529 --> 00:23:33,429
you know in the different because then
you know what to look for in the ass in

385
00:23:33,429 --> 00:23:33,860
Li

386
00:23:33,860 --> 00:23:37,429
and you know you understand exactly
which kinda boundaries and we're

387
00:23:37,429 --> 00:23:38,779
discussing about

388
00:23:38,779 --> 00:23:42,289
however the problem is that not every

389
00:23:42,289 --> 00:23:45,539
CRC flavor it's can be apartment rise

390
00:23:45,539 --> 00:23:49,710
with the rocks or model which leads to
more interesting

391
00:23:49,710 --> 00:23:53,309
so for instance this is that Ruby

392
00:23:53,309 --> 00:23:57,549
code which shows how to generate a table
for the CRC to

393
00:23:57,549 --> 00:24:02,029
applications are table is a way to cash

394
00:24:02,029 --> 00:24:05,460
a to pre compute I specifics that

395
00:24:05,460 --> 00:24:10,640
up the CRC algorithm to defining a table
which is then use for look op

396
00:24:10,640 --> 00:24:13,770
when you perform the checks and
computation

397
00:24:13,770 --> 00:24:17,120
the reason why this is don is purely for
performance

398
00:24:17,120 --> 00:24:20,159
and this is also very important because
you can also find

399
00:24:20,159 --> 00:24:25,090
table of course in your field work ot
and no one which table this president of

400
00:24:25,090 --> 00:24:26,880
course can also lead you to understand

401
00:24:26,880 --> 00:24:30,590
exactly what kind about William is being
implemented

402
00:24:30,590 --> 00:24:34,210
so so this generates a table using the
reverse

403
00:24:34,210 --> 00:24:39,500
are polynomial for specific algorithm
are the polynomial your is the only

404
00:24:39,500 --> 00:24:42,799
great different criteria for generating
stable

405
00:24:42,799 --> 00:24:46,360
and this is the Agri in generations so
the example shown

406
00:24:46,360 --> 00:24:51,620
your is by using the table so the table
is being generated in his mean looked ap

407
00:24:51,620 --> 00:24:54,830
year for specific index which relates to
the

408
00:24:54,830 --> 00:24:59,120
to the position on entry in the table
and it's a waste 150

409
00:24:59,120 --> 00:25:03,090
6 entries or otherwise you can do

410
00:25:03,090 --> 00:25:06,240
you can apply to polynomial manually
every single time

411
00:25:06,240 --> 00:25:09,720
and again this is more time consuming
and these

412
00:25:09,720 --> 00:25:13,919
and we show both ways to do it this
follows

413
00:25:13,919 --> 00:25:17,549
the rocks of models so we have been he
said he's a strong back door

414
00:25:17,549 --> 00:25:20,870
we have a CSO route value we have the
polynomial

415
00:25:20,870 --> 00:25:23,929
and so on all however

416
00:25:23,929 --> 00:25:27,240
there's one flavor CRCE or more than one

417
00:25:27,240 --> 00:25:32,890
which are it is CRC it was specifying
that dropped version of POSIX

418
00:25:32,890 --> 00:25:36,110
so not standard policy but its dropped
11

419
00:25:36,110 --> 00:25:39,659
SK's and you cannot be parting prize
will be on

420
00:25:39,659 --> 00:25:43,429
their rock some model but nonetheless
you will find it to a incall

421
00:25:43,429 --> 00:25:46,760
out there and so first of all we can see
that the

422
00:25:46,760 --> 00:25:51,230
table the pair's so this is a polynomial
which is being used which is one of just

423
00:25:51,230 --> 00:25:52,220
under once we

424
00:25:52,220 --> 00:25:57,289
show you before are but there's an
exception if the index 0 we have these

425
00:25:57,289 --> 00:25:58,340
values here

426
00:25:58,340 --> 00:26:01,649
so that's one up the different

427
00:26:01,649 --> 00:26:05,070
about things that you have in the table
%uh and

428
00:26:05,070 --> 00:26:09,299
if we see the aftra all agreed in this
is the version with the table we see

429
00:26:09,299 --> 00:26:09,950
these

430
00:26:09,950 --> 00:26:13,429
protocol has an exceptionally index t0

431
00:26:13,429 --> 00:26:17,539
then you don't have this number lookup
for the table but you replace

432
00:26:17,539 --> 00:26:22,059
you replace the index are we don't we go
by you which you're keeping track for

433
00:26:22,059 --> 00:26:23,220
every time you find

434
00:26:23,220 --> 00:26:27,140
0 as a index and this difference

435
00:26:27,140 --> 00:26:31,919
yeah make it so that the algorithm
cannot be Parma tries by the rocks of

436
00:26:31,919 --> 00:26:32,990
modern because

437
00:26:32,990 --> 00:26:37,370
even if you if we are dealing with the
same barometers the actual core are

438
00:26:37,370 --> 00:26:40,960
going really means is like the
difference and he's not even in a way

439
00:26:40,960 --> 00:26:44,830
which will make your life much more
complicated when you try to understand

440
00:26:44,830 --> 00:26:47,260
why this is not the issue for you too

441
00:26:47,260 --> 00:26:50,649
and so but if you know that this is the
case then it's easy to spot

442
00:26:50,649 --> 00:26:53,830
in the ass recalled I'll you know

443
00:26:53,830 --> 00:26:57,460
in retrospect but but this is one very
tricky example

444
00:26:57,460 --> 00:27:02,190
and Indian this is the same without the
table again we had the exception

445
00:27:02,190 --> 00:27:05,980
and one of the reasons why these ongoing
is being used today is because we some

446
00:27:05,980 --> 00:27:06,970
cold out there

447
00:27:06,970 --> 00:27:11,690
which were firstly it's not very clearly
mentions that based on the CSC 42 were

448
00:27:11,690 --> 00:27:17,019
in some vendors there you picking up so
so for reasons we can have

449
00:27:17,019 --> 00:27:20,570
in the while you can find dropped nine
version of the standard

450
00:27:20,570 --> 00:27:24,620
draft 11 or the draft 12 and they all
lead to different

451
00:27:24,620 --> 00:27:27,700
to defriend two different results at the
end

452
00:27:27,700 --> 00:27:31,899
on and he's are not Parma drive by Rock
something on

453
00:27:31,899 --> 00:27:35,179
are opposed to just under POSIX
arboretum

454
00:27:35,179 --> 00:27:39,690
the or the CRC 42 which is common use
nowadays by

455
00:27:39,690 --> 00:27:43,350
by Bekasi or or by also the Ethernet

456
00:27:43,350 --> 00:27:47,760
op different packets other I did link
layer you have

457
00:27:47,760 --> 00:27:51,250
I you have CRC computation been
performed with these

458
00:27:51,250 --> 00:27:54,779
up so we think this is an interesting
being which

459
00:27:54,779 --> 00:27:57,940
is not up easy the

460
00:27:57,940 --> 00:28:01,230
cannot be easily found on the on on the
web is not

461
00:28:01,230 --> 00:28:04,580
so we fought that it was relevant to
discuss it and

462
00:28:04,580 --> 00:28:07,899
any it's out you know what are the
challenges that you have

463
00:28:07,899 --> 00:28:11,039
when trying to to upload I meet a few
more

464
00:28:11,039 --> 00:28:14,169
of course also if you know which are
going to me is being applied

465
00:28:14,169 --> 00:28:17,269
one of the things that you can also do
of course if you wanna

466
00:28:17,269 --> 00:28:21,110
try to match the check some rather than
then try to rebuild your own you can

467
00:28:21,110 --> 00:28:23,480
also try to find lesions there several

468
00:28:23,480 --> 00:28:27,890
there is a few tools out there which
allows you you out for

469
00:28:27,890 --> 00:28:31,500
arbitrary bites a freedom in in in

470
00:28:31,500 --> 00:28:35,750
in in the in the payload you're trying
to create a check some for

471
00:28:35,750 --> 00:28:38,840
you can you can find a way to create a
pale

472
00:28:38,840 --> 00:28:43,510
which matches unknown check some as long
a key as you have a lease for bites that

473
00:28:43,510 --> 00:28:45,279
you can arbitrary control

474
00:28:45,279 --> 00:28:49,149
which is often the case so dots you know
knowing the algorithm

475
00:28:49,149 --> 00:28:53,549
knowing that you can also don't bother
about change in a few words change in a

476
00:28:53,549 --> 00:28:54,409
check some

477
00:28:54,409 --> 00:28:58,580
supposed to check some me somehow are
quoted somewhere else in the cold and

478
00:28:58,580 --> 00:29:00,100
you don't have access to that

479
00:29:00,100 --> 00:29:04,860
you can had your payload colliding we
did check some so you can major changes

480
00:29:04,860 --> 00:29:07,740
in sea of an output which would produce
the same check some

481
00:29:07,740 --> 00:29:11,110
of the original paper but of course you
need ya green

482
00:29:11,110 --> 00:29:15,549
the proper are going for fun so that was
one thing

483
00:29:15,549 --> 00:29:18,890
next thing are in might be that you

484
00:29:18,890 --> 00:29:23,669
you don't have the firmware or or thing
we cannot be easily reverse engineer

485
00:29:23,669 --> 00:29:27,559
and body I mean so love to preview the
axes that has been discussed you that

486
00:29:27,559 --> 00:29:30,850
you actually have access to the system
so you can be on the system

487
00:29:30,850 --> 00:29:34,600
and you can copy your buying a reason
you can execute your binaries

488
00:29:34,600 --> 00:29:38,600
or sometimes you you you are in an
operating system which

489
00:29:38,600 --> 00:29:41,860
allows you to have kernel modules

490
00:29:41,860 --> 00:29:45,779
are which is extremely common or you can
modify to minor itself

491
00:29:45,779 --> 00:29:50,210
and inject and inject code is suppose
you want to debug

492
00:29:50,210 --> 00:29:54,309
really want to reverse engineer some
specific custom driver which is embedded

493
00:29:54,309 --> 00:29:55,330
in occur

494
00:29:55,330 --> 00:29:59,789
which is not easy to expose the
userspace are in the system uses to

495
00:29:59,789 --> 00:30:02,820
axis some kind of people each
information so cryptographic %eh

496
00:30:02,820 --> 00:30:03,909
exchange

497
00:30:03,909 --> 00:30:07,659
or you know talking to some other device
which is important

498
00:30:07,659 --> 00:30:10,980
I and you know most of the time this is
the case Israel

499
00:30:10,980 --> 00:30:14,889
your life scenarios you have the
medicine which specific drivers

500
00:30:14,889 --> 00:30:18,230
including a colonel and they're not
expose at all to the userspace of the

501
00:30:18,230 --> 00:30:20,340
embedded system also because the
userspace

502
00:30:20,340 --> 00:30:23,570
on embedded system it's not something
any issues because you don't log on to

503
00:30:23,570 --> 00:30:24,440
the system

504
00:30:24,440 --> 00:30:28,320
so you have you brought you last and and
little attention is paid to

505
00:30:28,320 --> 00:30:32,549
to the kind of boxes that is given to
use a space so we may be really hard to

506
00:30:32,549 --> 00:30:34,000
understand what's going on

507
00:30:34,000 --> 00:30:38,090
%uh even if the code is inside so what
you can do

508
00:30:38,090 --> 00:30:41,470
its NBC's you know its on

509
00:30:41,470 --> 00:30:45,179
to do and its can be straightforward can
be tricky but it's very rewarding when

510
00:30:45,179 --> 00:30:45,870
you do it

511
00:30:45,870 --> 00:30:49,690
you can patch to colonel I to run time a
few ways to

512
00:30:49,690 --> 00:30:53,169
12 modules or you can pass the binary
uploaded and then

513
00:30:53,169 --> 00:30:56,929
put debugging helper within the code
allow you to understand

514
00:30:56,929 --> 00:31:01,130
house a specific function works without
having to reverse is near the mall

515
00:31:01,130 --> 00:31:05,620
so of course you know even if you are in
2012

516
00:31:05,620 --> 00:31:09,289
most embedded systems real-time embedded
system that he did that ma'am

517
00:31:09,289 --> 00:31:13,559
and you can frighten read from it which
means that if you wanna Jukka fonction

518
00:31:13,559 --> 00:31:18,120
you just need to have function pointer I
love the function you want a jock

519
00:31:18,120 --> 00:31:21,389
you need a new function pointer of
function which somehow you inject an

520
00:31:21,389 --> 00:31:22,649
internal memory or

521
00:31:22,649 --> 00:31:26,340
I did get a few more up to go because
your module his head

522
00:31:26,340 --> 00:31:29,570
and you can open that men you seek to
the pointer

523
00:31:29,570 --> 00:31:32,580
and then you replace the pointer with
your new one

524
00:31:32,580 --> 00:31:37,659
you know it's very easy to do and you
can also do even if you don't have the

525
00:31:37,659 --> 00:31:40,809
US development toolkit this is really
important

526
00:31:40,809 --> 00:31:46,130
on in real time whites is especially up
you have a stunner shared objects

527
00:31:46,130 --> 00:31:49,580
which are load as Karen marge is in
Evony the low overhead

528
00:31:49,580 --> 00:31:53,500
we descriptors of the module is loaded
you can grab one of those which are

529
00:31:53,500 --> 00:31:56,000
usually present on the feisty some on
the flash

530
00:31:56,000 --> 00:32:00,130
you can modify time and I and then have
your own code within the module

531
00:32:00,130 --> 00:32:04,090
are and you can also load East without
having to OCS is that men

532
00:32:04,090 --> 00:32:07,500
and I'm going I'm going to explain why
don't you don't need US development

533
00:32:07,500 --> 00:32:08,460
toolkit which

534
00:32:08,460 --> 00:32:11,730
is anyway available in most cases but
this is important

535
00:32:11,730 --> 00:32:16,669
so this is one example of of how you you
see you I jack a function so you define

536
00:32:16,669 --> 00:32:16,919
a

537
00:32:16,889 --> 00:32:22,130
a you define a propping function which
is going to be shown in the next slide

538
00:32:22,130 --> 00:32:25,820
and so in that way you have a pointer to
a thinker in memory

539
00:32:25,820 --> 00:32:29,450
so that's your phone then depending on

540
00:32:29,450 --> 00:32:32,630
on how what kinda like the treachery
dealing with are

541
00:32:32,630 --> 00:32:36,720
you create a jump Yuki you create the
absolutely opcode

542
00:32:36,720 --> 00:32:40,029
Fort the jump that you need for going to
be addressed

543
00:32:40,029 --> 00:32:43,399
or overall got function so here uses

544
00:32:43,399 --> 00:32:47,139
meets in this case these a the result of
Dez

545
00:32:47,139 --> 00:32:50,620
is that the proper opcode for jumping to
on some point

546
00:32:50,620 --> 00:32:53,880
on you create a placeholder which is
just

547
00:32:53,880 --> 00:32:58,960
character a array for you original
function because you don't want to mess

548
00:32:58,960 --> 00:33:00,970
up with the functionality of the sixth

549
00:33:00,970 --> 00:33:04,600
you wanna drop existing punches you know
where you don't affect their behavior

550
00:33:04,600 --> 00:33:07,850
because effectively a beard and of
course RI

551
00:33:07,850 --> 00:33:11,019
you have nothing to the up and then

552
00:33:11,019 --> 00:33:15,279
you can you can define a prototype

553
00:33:15,279 --> 00:33:18,570
Fort the function you want to inspect in

554
00:33:18,570 --> 00:33:21,820
appointee to the address of the
functional older

555
00:33:21,820 --> 00:33:25,029
and this will allow you to return back

556
00:33:25,029 --> 00:33:29,269
to the to the to the function which were
holding so so in this case what uses see

557
00:33:29,269 --> 00:33:32,460
just as a graphical user interface to
assembly okay

558
00:33:32,460 --> 00:33:36,289
is just for making be more simple on

559
00:33:36,289 --> 00:33:39,970
and if you don't have US development
toolkit so you don't have

560
00:33:39,970 --> 00:33:43,870
the scene was results for the function
on you my knee is usually very easy to

561
00:33:43,870 --> 00:33:46,860
find them within the current called
because you can always identified

562
00:33:46,860 --> 00:33:48,539
assisting call table

563
00:33:48,539 --> 00:33:52,000
in the sea single table on the ordering

564
00:33:52,000 --> 00:33:56,720
of the city schools ninety percent of
the cases

565
00:33:56,720 --> 00:34:01,019
eat respects this on their ordering of
the sea school numbers

566
00:34:01,019 --> 00:34:04,899
for the did labor or for which data
lysis the right from

567
00:34:04,899 --> 00:34:08,450
so most other ties yes the sometimes it
can be

568
00:34:08,450 --> 00:34:13,780
him links still if you not a pointer to
the men copy season call for reasons

569
00:34:13,780 --> 00:34:17,230
you know it a point to you can just to
find a prototype for attendees will

570
00:34:17,230 --> 00:34:19,250
allow you to access that function

571
00:34:19,250 --> 00:34:22,639
my writing secord you know mass we
possibly too much

572
00:34:22,639 --> 00:34:25,659
and you don't need the developmental you
for doing that just need a compiler for

573
00:34:25,659 --> 00:34:27,950
the specific CPU architecture

574
00:34:27,950 --> 00:34:32,100
and what you can do you call PDX easing
function in a placeholder

575
00:34:32,100 --> 00:34:35,980
so you keep it there you replace the
function pointer

576
00:34:35,980 --> 00:34:39,590
with your own pointed to your own the
backing function and you to bug in

577
00:34:39,590 --> 00:34:40,460
function

578
00:34:40,460 --> 00:34:45,419
the interesting thing still you don't
need to add the exact number of

579
00:34:45,419 --> 00:34:47,470
arguments of the existing function

580
00:34:47,470 --> 00:34:51,030
because the way the stock is handler it
will still work you will

581
00:34:51,030 --> 00:34:55,110
still not break the system if you place
15 arguments here

582
00:34:55,110 --> 00:34:58,750
are its huge you're always safe

583
00:34:58,750 --> 00:35:02,510
you put your custom cold just for you
know how you can print

584
00:35:02,510 --> 00:35:06,970
are some more you know some weiss's they
have a special version of print af which

585
00:35:06,970 --> 00:35:10,100
brings to the serial console for reasons
which is really handy

586
00:35:10,100 --> 00:35:13,860
so you can bring the content that the
pointers which are getting

587
00:35:13,860 --> 00:35:17,540
you can also decide to follow them if
you want and then you just go back to

588
00:35:17,540 --> 00:35:18,850
original function

589
00:35:18,850 --> 00:35:22,220
so for instance the see if that one
specific driver which is talking to

590
00:35:22,220 --> 00:35:25,540
achieve which is exchanging
cryptographic keys on the system

591
00:35:25,540 --> 00:35:28,600
and you don't understand how that word
by by reverses year in the US

592
00:35:28,600 --> 00:35:32,819
you if you drop the function and you
display the arguments in this way you

593
00:35:32,820 --> 00:35:34,050
will intercept the key

594
00:35:34,050 --> 00:35:37,910
we out of back into functioning called
and and then of course

595
00:35:37,910 --> 00:35:41,810
once you do doubts of course other than
the body in here you can also add your

596
00:35:41,810 --> 00:35:43,850
custom code so if you wanna lie

597
00:35:43,850 --> 00:35:47,660
about a specific arguments which have
been passed through the system

598
00:35:47,660 --> 00:35:50,920
if you wanna intercept them in change in
that is all

599
00:35:50,920 --> 00:35:55,190
up quite easy to do and you can also do
we without US development toolkit so

600
00:35:55,190 --> 00:35:55,850
it's quite

601
00:35:55,850 --> 00:35:59,540
it's quite on and you know to get the

602
00:35:59,540 --> 00:36:03,480
as I mentioned before to see school
table this is when they were is

603
00:36:03,480 --> 00:36:06,540
is fairly easy to to look up

604
00:36:06,540 --> 00:36:12,250
in not kernel image or remember you
because it's a very long the stove

605
00:36:12,250 --> 00:36:15,260
pointers which are very close to each
other so

606
00:36:15,260 --> 00:36:19,710
and in once you have been there all was
in order so you have 6012 free for find

607
00:36:19,710 --> 00:36:20,330
us on:

608
00:36:20,330 --> 00:36:23,600
and then you can reflect to the ordering
for US family or

609
00:36:23,600 --> 00:36:27,640
if you ever a binary on the seas then a
you know what the buyer is performing

610
00:36:27,640 --> 00:36:28,010
like

611
00:36:28,010 --> 00:36:31,870
LS of course you can also try and look
depending on

612
00:36:31,870 --> 00:36:35,370
whites leant or you can look at the
standard library by it can be.

613
00:36:35,370 --> 00:36:38,820
became easy-clean for are the pointer
uv-vis

614
00:36:38,820 --> 00:36:42,250
these functions court you with easy I
say

615
00:36:42,250 --> 00:36:46,270
still take some time but it's quite will
do about it 12 possible to do this kind

616
00:36:46,270 --> 00:36:47,680
of Colonel patching

617
00:36:47,680 --> 00:36:50,920
completely blind in relation to the US
your target

618
00:36:50,920 --> 00:36:54,240
we think it's speedy it's a very nice

619
00:36:54,240 --> 00:36:57,510
approach so which I where

620
00:36:57,510 --> 00:37:02,359
okay I get and of course he felt
question my love these which examples

621
00:37:02,359 --> 00:37:03,819
later you can approach as

622
00:37:03,819 --> 00:37:06,839
it's it's it's good so

623
00:37:06,839 --> 00:37:10,810
we discuss how to you know oxen's I of
course we discuss out to

624
00:37:10,810 --> 00:37:14,970
you know very fight you know not we did
approach personal copy because I would

625
00:37:14,970 --> 00:37:15,650
take

626
00:37:15,650 --> 00:37:20,390
many many hours but we discussed a few
interesting makes about such

627
00:37:20,390 --> 00:37:23,780
check somebody they show in and we
discuss the current batch bit

628
00:37:23,780 --> 00:37:26,970
on so let's do a practical example are
so

629
00:37:26,970 --> 00:37:30,819
10 example with big just for educational
reasons here

630
00:37:30,819 --> 00:37:34,060
are but it's interesting because we
don't think I mean we have in series

631
00:37:34,060 --> 00:37:39,290
anywhere on is you know attacking the
Apple SMC which is

632
00:37:39,290 --> 00:37:42,790
%ah these consider on internal amended
some system

633
00:37:42,790 --> 00:37:45,810
which is present on on all into base up
a lot

634
00:37:45,810 --> 00:37:48,910
so the SMC is the system management
controller

635
00:37:48,910 --> 00:37:52,319
I'll it's something its and embedded
microcontroller which

636
00:37:52,319 --> 00:37:56,690
you can also find another system like on
my ThinkPad laptop freezes

637
00:37:56,690 --> 00:37:59,829
is very common and usually can play two
roles

638
00:37:59,829 --> 00:38:03,220
you can act as system management
controller

639
00:38:03,220 --> 00:38:08,190
or keeper controller or both so when you
access a keeper controller when you have

640
00:38:08,190 --> 00:38:09,910
the matrics kind of the cube or

641
00:38:09,910 --> 00:38:13,160
it is being handled by on

642
00:38:13,160 --> 00:38:17,380
and so whiteys is interesting because
Apple allows the firmware upgrade for

643
00:38:17,380 --> 00:38:18,500
this as MC

644
00:38:18,500 --> 00:38:21,720
and so we show you know are you can
investigate

645
00:38:21,720 --> 00:38:25,440
and now you can less arbitrary feelers
are

646
00:38:25,440 --> 00:38:29,780
and you it said easy straightforward
nice process to do

647
00:38:29,780 --> 00:38:34,490
so the SMC are is their use is used for
sever

648
00:38:34,490 --> 00:38:37,589
reasons as may need for management

649
00:38:37,589 --> 00:38:41,089
monitoring of the power management over
the battery

650
00:38:41,089 --> 00:38:44,119
on the system he can use as a

651
00:38:44,119 --> 00:38:47,950
SBI breach that which allows you to
store some dates out

652
00:38:47,950 --> 00:38:52,349
on on in the bias but you know on on a
custom flash

653
00:38:52,349 --> 00:38:55,440
provides the ACPI of the interface

654
00:38:55,440 --> 00:38:59,430
he can also provide offering and
shifting offering up some signals in on

655
00:38:59,430 --> 00:39:01,920
Celebrity shifting if you need to talk
to

656
00:39:01,920 --> 00:39:05,950
two components which have different
voltage levels

657
00:39:05,950 --> 00:39:10,410
so it's convenient n it's completely
custom programmable function

658
00:39:10,410 --> 00:39:15,050
so it's not that you by Danny any
operates you need to program

659
00:39:15,050 --> 00:39:18,240
so on Apple sees them doesn't manage to
keep or

660
00:39:18,240 --> 00:39:21,609
just manage arm the power

661
00:39:21,609 --> 00:39:25,079
related keys on on on on the system

662
00:39:25,079 --> 00:39:29,940
arm in and man is the display lead
open/close activity

663
00:39:29,940 --> 00:39:34,359
side in motion sensor are the ambient
light sensing the keyboard light

664
00:39:34,359 --> 00:39:35,970
indicator lights the battery

665
00:39:35,970 --> 00:39:40,190
and so so it's it's a very important

666
00:39:40,190 --> 00:39:44,440
piece of equipment that you have there
arm economic where this interesting can

667
00:39:44,440 --> 00:39:46,710
be query by US so it is a clear

668
00:39:46,710 --> 00:39:52,349
and I would say publish way of ok into
rocking from userspace with the chip

669
00:39:52,349 --> 00:39:56,359
so you can retrieve what are called the
SNC keys from the cheap or you can write

670
00:39:56,359 --> 00:39:57,180
to that

671
00:39:57,180 --> 00:40:00,920
and he skis they give you information
about are lights

672
00:40:00,920 --> 00:40:05,510
activity are the battery side as he gets
present or charging and so on

673
00:40:05,510 --> 00:40:08,569
you get that from the SMC you get the
RPM

674
00:40:08,569 --> 00:40:12,109
you get you can sets the RPM something
different fans

675
00:40:12,109 --> 00:40:16,640
are there's a new job action timer which
had no idea what it is maybe someone

676
00:40:16,640 --> 00:40:20,069
which expert in Apple and it would mean
jobs and Tyrese

677
00:40:20,069 --> 00:40:23,220
I like to think that when you step dad
ninja pops up

678
00:40:23,220 --> 00:40:27,210
and with you I think that we should buy
awesome

679
00:40:27,210 --> 00:40:31,210
you can get the Quran the voltage and
song of the sea view this is just a

680
00:40:31,210 --> 00:40:32,030
subset of

681
00:40:32,030 --> 00:40:35,790
I'll the actor was there are many more
on motion sensor configuration register

682
00:40:35,790 --> 00:40:38,170
and so all kind things

683
00:40:38,170 --> 00:40:41,329
so the apt at five year the energy from
from Apple

684
00:40:41,329 --> 00:40:46,099
on which can be mounted you know you can
do all of these on

685
00:40:46,099 --> 00:40:49,329
you notice it doesn't matter what you do
it's you don't need need to be a make-up

686
00:40:49,329 --> 00:40:50,180
sex

687
00:40:50,180 --> 00:40:54,640
aren't you you get at GZ compressed cpio
archive name pay does

688
00:40:54,640 --> 00:40:57,920
which contains some interesting fights
so one UN

689
00:40:57,920 --> 00:41:01,490
year 5 binary and you get

690
00:41:01,490 --> 00:41:05,240
to SNC fis which actually contain

691
00:41:05,240 --> 00:41:09,730
so the if i Rana is a universal you
defined by Reza which means

692
00:41:09,730 --> 00:41:13,400
it's it's a binary designed to be
launched in a pretty good stage

693
00:41:13,400 --> 00:41:16,980
in in in up that would States

694
00:41:16,980 --> 00:41:20,680
people epic people state on on

695
00:41:20,680 --> 00:41:24,170
in the in what's the bias of your Apple
App

696
00:41:24,170 --> 00:41:27,319
which is the their own version of the if
I

697
00:41:27,319 --> 00:41:31,849
and I you be said about you if I a lot
so Apple uses their own by and

698
00:41:31,849 --> 00:41:35,900
no use you if I but still this is it you
know universal if I back

699
00:41:35,900 --> 00:41:42,630
r4 32-bit and 64-bit out mean if I don't
think Apple as any for you

700
00:41:42,630 --> 00:41:46,750
buzzers anyway so this this on binary is
blast

701
00:41:46,750 --> 00:41:51,430
with a blessed come on but by your your
your how to mod installer for execution

702
00:41:51,430 --> 00:41:52,550
on the first boot

703
00:41:52,550 --> 00:41:55,960
and as a now commence it takes %uh did

704
00:41:55,960 --> 00:41:59,980
the Fillmore are depending on the part
number of your laptop

705
00:41:59,980 --> 00:42:03,950
so the fear of course are checked for
integrity but a fresh application

706
00:42:03,950 --> 00:42:07,069
and you know let's wanted to know how
this

707
00:42:07,069 --> 00:42:11,160
integrity check for so this is the fly
on

708
00:42:11,160 --> 00:42:15,680
are its been cut down for for for
brevity of course

709
00:42:15,680 --> 00:42:19,030
still in 25 you have these series of
strings

710
00:42:19,030 --> 00:42:22,540
and then at some point you the data
begins so

711
00:42:22,540 --> 00:42:26,050
are once we looked at its it looked
fairly familiar

712
00:42:26,050 --> 00:42:31,579
up but it's not I just under format but
it's very close to several standards but

713
00:42:31,579 --> 00:42:33,480
it has its own pic like this so

714
00:42:33,480 --> 00:42:37,040
so visible the eight-year means hash
data

715
00:42:37,040 --> 00:42:40,770
DS we well this is our interpretation

716
00:42:40,770 --> 00:42:43,920
anyway the security data nd contains the

717
00:42:43,920 --> 00:42:47,589
actual data blocks and he seems to be
some kinda bug station they

718
00:42:47,589 --> 00:42:50,640
up so probably checks information each
year

719
00:42:50,640 --> 00:42:54,630
and then you actually have the data of

720
00:42:54,630 --> 00:42:57,829
so these

721
00:42:57,829 --> 00:43:02,790
of course very easy to spot release
length so twenty you have twenty bite 64

722
00:43:02,790 --> 00:43:04,160
X 64 bytes

723
00:43:04,160 --> 00:43:09,829
and on and the seems to be a memory
address of the actual

724
00:43:09,829 --> 00:43:14,250
or or anyway I'm of said of the actual
scheme where which is being

725
00:43:14,250 --> 00:43:17,250
which is being placed your arm

726
00:43:17,250 --> 00:43:21,430
so in the check some turns out it's
quite easy so if we see the slide

727
00:43:21,430 --> 00:43:25,079
here I'll we CDF and then o0 sandwich

728
00:43:25,079 --> 00:43:28,410
this value your is bf sure to inspire
you

729
00:43:28,410 --> 00:43:32,069
easier to and of course when the end
date added value something different but

730
00:43:32,069 --> 00:43:33,329
it turns out

731
00:43:33,329 --> 00:43:37,980
that's quite very simple it's resembles
a bit it's not quite the same idea

732
00:43:37,980 --> 00:43:39,190
resemble the ass wreck

733
00:43:39,190 --> 00:43:43,010
54 mint and in some ways was mean
tonight's format

734
00:43:43,010 --> 00:43:46,099
so the check some he's not other that
did

735
00:43:46,099 --> 00:43:49,720
that there are at least two significant
bites the some oval the bites contained

736
00:43:49,720 --> 00:43:50,490
within the date

737
00:43:50,490 --> 00:43:54,640
so here we some bf models euros and of
course the lease to see me think that

738
00:43:54,640 --> 00:43:57,819
let least significant byte his bf and

739
00:43:57,819 --> 00:44:01,150
and so on so so it's really
straightforward to

740
00:44:01,150 --> 00:44:04,940
actually up we calculate these

741
00:44:04,940 --> 00:44:08,250
these value once you modify wannabes

742
00:44:08,250 --> 00:44:12,619
one of these wanna data block it's also
easy to make it coli

743
00:44:12,619 --> 00:44:16,059
because you know that the N only this
psalm has too much

744
00:44:16,059 --> 00:44:19,630
did the checks arm and the

745
00:44:19,630 --> 00:44:23,040
the hash date that's your I dick

746
00:44:23,040 --> 00:44:27,480
the number of crashes that the sections
is exactly like the number of the

747
00:44:27,480 --> 00:44:31,540
data sections so each of these represent
the some

748
00:44:31,540 --> 00:44:35,099
overall the the hashes for the data
block

749
00:44:35,099 --> 00:44:38,200
on so as it is i text you the some the
checks and

750
00:44:38,200 --> 00:44:43,010
each sixty-four bison data block nd
security date the section which is this

751
00:44:43,010 --> 00:44:43,430
one

752
00:44:43,430 --> 00:44:47,109
here represent this some ok all the ash

753
00:44:47,109 --> 00:44:50,440
state sections so it's like over redound
to check some

754
00:44:50,440 --> 00:44:53,520
you check some yeah you checked each

755
00:44:53,520 --> 00:44:56,670
like a much you ask you each you check
something she needed that they too

756
00:44:56,670 --> 00:45:00,200
up you have a check some for their some
above the checksums

757
00:45:00,200 --> 00:45:03,210
and then you have a check some for the
sum the checksums

758
00:45:03,210 --> 00:45:06,210
up the checks so and once you know these

759
00:45:06,210 --> 00:45:09,349
it is pretty straight forward to to to
modify

760
00:45:09,349 --> 00:45:13,050
she's very trivial you know I did buy
change it and then opted to check some

761
00:45:13,050 --> 00:45:16,780
or if you want to find on to find these

762
00:45:16,780 --> 00:45:21,369
on so so I was the first that seconds
that we need

763
00:45:21,369 --> 00:45:26,020
to to understand the architecture so one
of the things that you might try to do

764
00:45:26,020 --> 00:45:26,859
is is that

765
00:45:26,859 --> 00:45:30,339
you know the first relevant data block
being it because before the seats

766
00:45:30,339 --> 00:45:34,020
it's not useful they said the case at
ale offset

767
00:45:34,020 --> 00:45:37,510
8,000 except 8,000 arm

768
00:45:37,510 --> 00:45:42,130
we could speculate that 00 here so if
this is a massively representation that

769
00:45:42,130 --> 00:45:43,920
these is are probably not

770
00:45:43,920 --> 00:45:47,339
so not called me yours yours yours yours
yours yours

771
00:45:47,339 --> 00:45:51,780
depends on what the alignment so but of
course

772
00:45:51,780 --> 00:45:54,940
why do they would consumer products %ah

773
00:45:54,940 --> 00:45:58,640
you know you online and you find several
pictures of the ports

774
00:45:58,640 --> 00:46:02,410
if you don't wanna open your own laptop
and breaking apart

775
00:46:02,410 --> 00:46:06,829
so you want to I think C dot com you
find a nice picture of the boar

776
00:46:06,829 --> 00:46:10,970
and you find this fellow here which
actually turns out to be

777
00:46:10,970 --> 00:46:14,000
Iran SI's HHS to vase amounts

778
00:46:14,000 --> 00:46:17,730
2000 2117 family sixty

779
00:46:17,730 --> 00:46:22,700
beat my computer which ease specifically
designed or

780
00:46:22,700 --> 00:46:25,990
actually it is employed by several
manufacturers

781
00:46:25,990 --> 00:46:29,200
as SMC %ah unit

782
00:46:29,200 --> 00:46:32,619
so you know all chances

783
00:46:32,619 --> 00:46:35,619
point to this cheap as being the actual
are

784
00:46:35,619 --> 00:46:38,700
recipe and all the firmware with see

785
00:46:38,700 --> 00:46:43,540
it's a fairy Tatum very nice components
sixty me architecture

786
00:46:43,540 --> 00:46:46,770
when it's easy to buy some ROM eighty
buy some ROM and yes

787
00:46:46,770 --> 00:46:51,740
loss in value we I swear see isn't gone
on to the jungle merger exist silly

788
00:46:51,740 --> 00:46:52,890
interface

789
00:46:52,890 --> 00:46:56,050
and 11 actually he as a keyword of a
control

790
00:46:56,050 --> 00:46:59,329
matrics con are is a low pin count
interphase

791
00:46:59,329 --> 00:47:02,390
any as are large number of generic

792
00:47:02,390 --> 00:47:06,170
your ports and all these you can read
from the opposite of

793
00:47:06,170 --> 00:47:10,750
on the cheap and once you have the top
issue the chip 47 architecture

794
00:47:10,750 --> 00:47:14,040
and you're all set instruction set are
solo

795
00:47:14,040 --> 00:47:17,359
I'll we by matching the structure sack
to

796
00:47:17,359 --> 00:47:23,230
to the bike that you seem to be more you
you can easily see that five days 0089

797
00:47:23,230 --> 00:47:26,880
8 seeks is none other than a jump to an
absolute address

798
00:47:26,880 --> 00:47:30,559
so these represent jump to offset 89

799
00:47:30,559 --> 00:47:35,190
8 6 and of course you also have a new
development toolkit for these

800
00:47:35,190 --> 00:47:39,079
so you can also use a quick bite at fort
so

801
00:47:39,079 --> 00:47:43,740
the very dirty way of doing it I mean we
just show the they're all

802
00:47:43,740 --> 00:47:49,050
my two young your weed own we were not
fancy when I assure you I abroad so on

803
00:47:49,050 --> 00:47:50,530
we'd like you to show the bear

804
00:47:50,530 --> 00:47:54,730
its then if you wanna be more lead to
that of course you can use old

805
00:47:54,730 --> 00:47:57,809
your tools so you callout the

806
00:47:57,809 --> 00:48:01,470
the data blocks Witcher which are
interesting for you

807
00:48:01,470 --> 00:48:05,559
and you converts the ASCII
representation

808
00:48:05,559 --> 00:48:09,130
of the exodus from our values to their
actual

809
00:48:09,130 --> 00:48:12,140
a binary by you still you do that

810
00:48:12,140 --> 00:48:16,670
with this one line in here it converts
easily readable file

811
00:48:16,670 --> 00:48:20,160
to an actual by where you can just rings
on it then you can

812
00:48:20,160 --> 00:48:23,980
you can disassembly then if you have the
I

813
00:48:23,980 --> 00:48:26,980
the H 8300

814
00:48:26,980 --> 00:48:30,069
development toolkit which is available
online you point to this

815
00:48:30,069 --> 00:48:33,530
right start address which is in this
case offset

816
00:48:33,530 --> 00:48:38,210
X 1000 you you could get a picture and
you can disassemble

817
00:48:38,210 --> 00:48:42,339
the cold and we can see that matches our
expectation the first

818
00:48:42,339 --> 00:48:45,369
the first instruction ease a jump to

819
00:48:45,369 --> 00:48:50,349
X 8986 so and once you have these have
chorus

820
00:48:50,349 --> 00:48:53,349
a the the great thing is

821
00:48:53,349 --> 00:48:56,940
is you're dealing with %ah simply it is
using a microcontroller

822
00:48:56,940 --> 00:49:00,559
so you you get the doctor she in the
doctor should will tell you

823
00:49:00,559 --> 00:49:04,089
exactly what every registered means arm

824
00:49:04,089 --> 00:49:07,559
before and outs you need to understand
where the data section is

825
00:49:07,559 --> 00:49:11,410
of course on the field were recent data
section here

826
00:49:11,410 --> 00:49:14,640
and freezes these offsets here

827
00:49:14,640 --> 00:49:18,059
they actually convert to streets so

828
00:49:18,059 --> 00:49:21,180
this is II and a statement

829
00:49:21,180 --> 00:49:24,680
where depending on on the state about
specific

830
00:49:24,680 --> 00:49:27,819
I register which is looked up before we

831
00:49:27,819 --> 00:49:31,480
reply to an SMC peak wary we'd

832
00:49:31,480 --> 00:49:36,670
different streets and the strings a
present in the binary so we see that in

833
00:49:36,670 --> 00:49:39,640
the specific case for the specific theme
where

834
00:49:39,640 --> 00:49:43,460
we just Eva shit all RX seven thousand
still

835
00:49:43,460 --> 00:49:47,910
everything that you see in the codes as
reference

836
00:49:47,910 --> 00:49:51,900
free says one E AF E you will find

837
00:49:51,900 --> 00:49:55,280
in the actual binary untouched in 17

838
00:49:55,280 --> 00:49:59,869
AF so once you know at the races shift
in the office address in between the

839
00:49:59,869 --> 00:50:01,380
Texans that the section

840
00:50:01,380 --> 00:50:05,210
which relates to how the binary slater
placing too the address space

841
00:50:05,210 --> 00:50:08,609
of the microcontroller once know that
but the ones you know this you can

842
00:50:08,609 --> 00:50:09,589
resolve

843
00:50:09,589 --> 00:50:13,680
all the different day top a related
parameters

844
00:50:13,680 --> 00:50:17,240
strings you know values whatever which
are present in the binary

845
00:50:17,240 --> 00:50:20,280
in these greatly helps in understanding
what because he's doing

846
00:50:20,280 --> 00:50:24,369
or if you want to modify to return under
strings

847
00:50:24,369 --> 00:50:28,180
in place of the one that is currently
report

848
00:50:28,180 --> 00:50:33,369
and also we discuss that the main
function on Kirby says mc4

849
00:50:33,369 --> 00:50:37,609
to the use spaces to set to give keys
you can find you find all the keys

850
00:50:37,609 --> 00:50:39,079
within the binary

851
00:50:39,079 --> 00:50:42,910
and you have this nice table we tell you
the key name

852
00:50:42,910 --> 00:50:47,380
that type of the key and then you have
some kind of of sits here

853
00:50:47,380 --> 00:50:51,099
a turns out that freezes if you're
asking for it

854
00:50:51,099 --> 00:50:55,359
the key he which gives you the number of

855
00:50:55,359 --> 00:50:59,089
SMC keys which are configure in the
system

856
00:50:59,089 --> 00:51:03,990
we can see that these address I'll

857
00:51:03,990 --> 00:51:07,069
Street straightforwardly points with the
data section itself

858
00:51:07,069 --> 00:51:10,970
so if we perform the same count amount
shifting

859
00:51:10,970 --> 00:51:15,829
the same calculation we go back here and
this is exactly the body which is being

860
00:51:15,829 --> 00:51:16,490
returned

861
00:51:16,490 --> 00:51:20,980
when you carry the SMC for a key command
which is the number of SMC keys which is

862
00:51:20,980 --> 00:51:24,359
in this case 172 so immediately

863
00:51:24,359 --> 00:51:28,040
you have the way if you wanna know me
too fancy to modify

864
00:51:28,040 --> 00:51:31,559
stopped its keys which are being
returned or to exchange

865
00:51:31,559 --> 00:51:36,200
to change the dynamic he's to stop skis
you know just by changing the offsets

866
00:51:36,200 --> 00:51:36,849
your

867
00:51:36,849 --> 00:51:40,369
arm because this is the actual table
which is used by Jasen Lee called

868
00:51:40,369 --> 00:51:45,420
to do the lookup over the keys which are
being asked over its interface

869
00:51:45,420 --> 00:51:48,500
and also if you relate the

870
00:51:48,500 --> 00:51:52,990
a registers which are being addressed by
Diaz and lead to the doctor she

871
00:51:52,990 --> 00:51:56,210
which now you have because you know with
the architecture is

872
00:51:56,210 --> 00:51:59,410
it's straightforward to to you know

873
00:51:59,410 --> 00:52:03,410
to the assemble things like these to
their relevant ice percy

874
00:52:03,410 --> 00:52:07,099
on components so if you look at the got
the street freezes

875
00:52:07,099 --> 00:52:10,430
you will see thats saw

876
00:52:10,430 --> 00:52:15,819
FB 8 8 is actually the register for the
ice pussy boss control prices

877
00:52:15,819 --> 00:52:18,930
register or the second i square seaport

878
00:52:18,930 --> 00:52:22,720
and depending on the beats which are
being cleared

879
00:52:22,720 --> 00:52:27,470
or Sat on that specific register you
with the doctor should printed you know

880
00:52:27,470 --> 00:52:28,680
exactly

881
00:52:28,680 --> 00:52:33,670
what happens here so in this case the
device's settings labor dresses for

882
00:52:33,670 --> 00:52:36,859
talking to over yes we're see so so

883
00:52:36,859 --> 00:52:40,230
once you have this knowledge once you
have the doctor she

884
00:52:40,230 --> 00:52:43,839
of the microcontroller you really can
get deep into

885
00:52:43,839 --> 00:52:47,380
what exactly the unit is doing in terms
of communication

886
00:52:47,380 --> 00:52:50,680
and you know in mind a complicated but
it's actually pretty straightforward

887
00:52:50,680 --> 00:52:51,339
issue

888
00:52:51,339 --> 00:52:55,430
you you are in the specific mindset arm

889
00:52:55,430 --> 00:52:58,890
and this is another is example here all

890
00:52:58,890 --> 00:53:03,799
freezes this is the battery the maximum
number of support a battery

891
00:53:03,799 --> 00:53:07,220
which is up which is addressed your

892
00:53:07,220 --> 00:53:10,440
and freezes is logic which ex if it's
you know

893
00:53:10,440 --> 00:53:13,819
one or not these major no one or not
throughout the coat

894
00:53:13,819 --> 00:53:18,480
are soup so so you can also see how the
dynamic keys

895
00:53:18,480 --> 00:53:22,349
are actually I'll bean 310

896
00:53:22,349 --> 00:53:25,480
which their communicated to use or so so

897
00:53:25,480 --> 00:53:29,140
by having his knowledge you can
introduce arbitrary function on

898
00:53:29,140 --> 00:53:33,130
in the SMC component you can use all the
generic

899
00:53:33,130 --> 00:53:36,390
I euros which are connected somewhere in
the system for for that you need to

900
00:53:36,390 --> 00:53:36,960
debug

901
00:53:36,960 --> 00:53:41,200
a little more but you know by having
these knowledge by having that then

902
00:53:41,200 --> 00:53:45,490
the SMC keys by being able to query dem
it also allows you a very nice way to

903
00:53:45,490 --> 00:53:46,859
debug your code

904
00:53:46,859 --> 00:53:50,549
because from the US you can query he's
so you can put some debugging function

905
00:53:50,549 --> 00:53:52,180
on you for your custom firmware

906
00:53:52,180 --> 00:53:56,260
exposed through the S&P's up which which
is quite cool

907
00:53:56,260 --> 00:53:59,829
and you can also had in this feedback is
weak right you can also

908
00:53:59,829 --> 00:54:05,260
ride to the SMC have some specific he's
handled by your own functions

909
00:54:05,260 --> 00:54:09,099
and then to function on you up on that
so so

910
00:54:09,099 --> 00:54:13,430
its week we go from knowing nothing
about the system finding Justin Upton's

911
00:54:13,430 --> 00:54:13,790
from

912
00:54:13,790 --> 00:54:19,069
Apple to two ways to which you know in a
TI I consider PD

913
00:54:19,069 --> 00:54:22,589
a convenient to have in order to to do
the back

914
00:54:22,589 --> 00:54:26,020
arm so and then of course you can you
can do

915
00:54:26,020 --> 00:54:29,480
you know this is we should for
educational example only so

916
00:54:29,480 --> 00:54:33,140
if you do the single brick the system we
do not pay for it but

917
00:54:33,140 --> 00:54:36,500
you know it can be a great starting
point for all you that want to do evil

918
00:54:36,500 --> 00:54:38,589
deeds I don't know what you want to do

919
00:54:38,589 --> 00:54:43,010
with SMC modification you know or or
just to explore how the system works but

920
00:54:43,010 --> 00:54:44,670
it's a classic example

921
00:54:44,670 --> 00:54:47,990
over in bed it's just the subsystems
which is

922
00:54:47,990 --> 00:54:51,559
not protected you know way because the
security

923
00:54:51,559 --> 00:54:56,420
houses just I i dnt is just integrity
verification

924
00:54:56,420 --> 00:55:00,059
he simply serve more of our deware which
can be modified from US

925
00:55:00,059 --> 00:55:04,010
you can be down from uses basic can be
quite from userspace and indeed taps

926
00:55:04,010 --> 00:55:07,470
on the CCM into different see since like
battery

927
00:55:07,470 --> 00:55:10,780
and so on so it's a classic example

928
00:55:10,780 --> 00:55:14,970
interesting and and its fairly easy to
do that its

929
00:55:14,970 --> 00:55:19,030
it was good for eyes and education
example in our case and

930
00:55:19,030 --> 00:55:22,290
and we hope you find it on interest

931
00:55:22,290 --> 00:55:25,740
so are we have no time left

932
00:55:25,740 --> 00:55:28,990
are Dez I'll was I want your
presentation

933
00:55:28,990 --> 00:55:33,000
we hope that I know there was a lot of
content on no we spoke very fast we hope

934
00:55:33,000 --> 00:55:33,650
that

935
00:55:33,650 --> 00:55:37,170
it was interesting to you on to see
these kind of things if you have any

936
00:55:37,170 --> 00:55:38,589
questions I think

937
00:55:38,589 --> 00:55:42,940
this time we have five minutes for for
questions otherwise

938
00:55:42,940 --> 00:55:47,020
these ask our you can approach is later
we're always happy to discuss

939
00:55:47,020 --> 00:55:53,359
thanks thank you very much

940
00:55:53,359 --> 00:55:58,240
questions

941
00:55:58,240 --> 00:56:05,240
don't be shy only shy up with a video in
the meantime

942
00:56:08,599 --> 00:56:12,450
this is the actual flashing ups it's
gone

943
00:56:12,450 --> 00:56:17,470
can you

944
00:56:17,470 --> 00:56:21,079
he's got some flashing on the Modify SMC
on the Mac

945
00:56:21,079 --> 00:56:24,380
from the if I shall execute the flasher

946
00:56:24,380 --> 00:56:28,069
and that some money Fyfe more being
uploaded on the system

947
00:56:28,069 --> 00:56:32,059
when you do that the on will go me
because

948
00:56:32,059 --> 00:56:36,510
the season price to be conservative so
when you disable the SMC the fans

949
00:56:36,510 --> 00:56:40,619
are always on maximum speed soon as the
update starts the

950
00:56:40,619 --> 00:56:43,690
and goes down to see some reports and
then you have your code

951
00:56:43,690 --> 00:56:47,690
on on the 6th

952
00:56:47,690 --> 00:56:51,190
so no questions well

953
00:56:51,190 --> 00:56:58,190
then thank you andrea in the nearly a
let's give them a big round of applause

954
00:57:10,730 --> 00:57:12,940
face

955
00:57:12,940 --> 00:57:19,940
sleep

