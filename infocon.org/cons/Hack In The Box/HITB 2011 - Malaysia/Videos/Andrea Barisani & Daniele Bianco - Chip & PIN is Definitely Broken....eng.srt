1
00:00:15,870 --> 00:00:19,050
so hello everyone it's really good to be

2
00:00:19,050 --> 00:00:22,140
here will here two years ago it's really

3
00:00:22,140 --> 00:00:25,740
good to be back and do another talk so

4
00:00:25,740 --> 00:00:29,820
I'm Andrea and vanilla so this talk was

5
00:00:29,820 --> 00:00:33,420
actually done by four of us it was done

6
00:00:33,420 --> 00:00:35,370
also with Adam nori and Zach Franken

7
00:00:35,370 --> 00:00:37,770
from aperture lives which unfortunately

8
00:00:37,770 --> 00:00:41,370
they couldn't be here so we talked about

9
00:00:41,370 --> 00:00:46,290
a credit card skimming related to a new

10
00:00:46,290 --> 00:00:48,690
technology called EMV which involves

11
00:00:48,690 --> 00:00:53,850
having a chip on your credit card so and

12
00:00:53,850 --> 00:00:55,859
also as you will see I'm not sure how

13
00:00:55,859 --> 00:00:57,989
many of you have seen our presentation

14
00:00:57,989 --> 00:01:01,079
we always try to put a silly video in

15
00:01:01,079 --> 00:01:03,629
our presentation which proves how you

16
00:01:03,629 --> 00:01:05,970
can use our techniques to to get girls

17
00:01:05,970 --> 00:01:07,680
because we think it's very important as

18
00:01:07,680 --> 00:01:10,110
a message to show that you can use these

19
00:01:10,110 --> 00:01:12,480
highly technical techniques also for for

20
00:01:12,480 --> 00:01:13,800
you know the greater good you know

21
00:01:13,800 --> 00:01:15,810
otherwise you end up with a very boring

22
00:01:15,810 --> 00:01:18,180
talk that no one remembers you know so

23
00:01:18,180 --> 00:01:19,710
at the end the middle of the

24
00:01:19,710 --> 00:01:21,240
presentation there would be a very silly

25
00:01:21,240 --> 00:01:22,590
movie that will ruin our reputation

26
00:01:22,590 --> 00:01:25,320
completely so look forward to that so

27
00:01:25,320 --> 00:01:27,810
what is he in the MV is a standard which

28
00:01:27,810 --> 00:01:30,210
has been developed by MasterCard and

29
00:01:30,210 --> 00:01:33,120
Visa and also Europe a which is what

30
00:01:33,120 --> 00:01:35,460
regulates when you use credit cards that

31
00:01:35,460 --> 00:01:37,050
use at ship so every time you see a

32
00:01:37,050 --> 00:01:39,090
credit card we get cheap it means that

33
00:01:39,090 --> 00:01:42,300
the EMV protocol is being spoken by the

34
00:01:42,300 --> 00:01:44,340
car and by the terminal which reads the

35
00:01:44,340 --> 00:01:46,920
card and this this technology is

36
00:01:46,920 --> 00:01:48,960
marketed as chip and pin in many

37
00:01:48,960 --> 00:01:51,360
countries and as well as other names

38
00:01:51,360 --> 00:01:54,120
every country can decide to market it in

39
00:01:54,120 --> 00:01:59,190
different ways so why how they move into

40
00:01:59,190 --> 00:02:01,110
a new standard which involve the chip so

41
00:02:01,110 --> 00:02:03,240
the the the reason is pretty obvious

42
00:02:03,240 --> 00:02:06,090
it's because they want to move away from

43
00:02:06,090 --> 00:02:08,160
acts right because as we know and as

44
00:02:08,160 --> 00:02:09,780
it's been pointed out by Adam Laurie

45
00:02:09,780 --> 00:02:12,030
several times in any stocks the mag

46
00:02:12,030 --> 00:02:13,560
stripe is completely insecure you can

47
00:02:13,560 --> 00:02:15,480
clone you can scheme scheme is the act

48
00:02:15,480 --> 00:02:17,790
of cloning the car by using a special

49
00:02:17,790 --> 00:02:20,160
device credit card would max very very

50
00:02:20,160 --> 00:02:22,560
very easily there's nothing on secure

51
00:02:22,560 --> 00:02:26,099
about that technology one other reason

52
00:02:26,099 --> 00:02:29,110
is because you can do offline Calvary

53
00:02:29,110 --> 00:02:30,940
occasion and transaction approval which

54
00:02:30,940 --> 00:02:33,220
means that your credit card terminal in

55
00:02:33,220 --> 00:02:35,650
order to approve the transaction doesn't

56
00:02:35,650 --> 00:02:37,630
need to actually make a connection to

57
00:02:37,630 --> 00:02:40,240
the backend in order to validate the car

58
00:02:40,240 --> 00:02:42,190
you can do everything on its own which

59
00:02:42,190 --> 00:02:45,100
is considered to be a feature somehow

60
00:02:45,100 --> 00:02:48,070
but we'll see why this is not a really a

61
00:02:48,070 --> 00:02:49,690
good thing and also you can have

62
00:02:49,690 --> 00:02:51,790
multiple applications on one car so you

63
00:02:51,790 --> 00:02:53,230
just don't have one night robe you have

64
00:02:53,230 --> 00:02:55,660
a chip which can support different kind

65
00:02:55,660 --> 00:02:58,150
of applications so you can add your

66
00:02:58,150 --> 00:03:00,490
debit card and your credit card in one

67
00:03:00,490 --> 00:03:02,680
car you can potentially also have a visa

68
00:03:02,680 --> 00:03:04,690
in a master color one color but of

69
00:03:04,690 --> 00:03:05,800
course they don't do that from a

70
00:03:05,800 --> 00:03:07,630
marketing perspective but you can also

71
00:03:07,630 --> 00:03:10,270
have that so these are one of the

72
00:03:10,270 --> 00:03:12,070
reasons however it is one big problem

73
00:03:12,070 --> 00:03:14,650
which really what's contact our research

74
00:03:14,650 --> 00:03:16,570
as well as research from from other

75
00:03:16,570 --> 00:03:19,959
security researchers is that this

76
00:03:19,959 --> 00:03:22,330
technology allows for a liability shift

77
00:03:22,330 --> 00:03:25,239
so what does it mean it means that while

78
00:03:25,239 --> 00:03:27,700
the liability shifts away from from the

79
00:03:27,700 --> 00:03:29,470
merchant to the bank which is a good

80
00:03:29,470 --> 00:03:32,470
thing and it is also one of the the ways

81
00:03:32,470 --> 00:03:34,090
that he's been using for actually

82
00:03:34,090 --> 00:03:37,420
pushing the technology because merchants

83
00:03:37,420 --> 00:03:40,030
they have to implement they have to buy

84
00:03:40,030 --> 00:03:41,799
terminals with the MV in order to have

85
00:03:41,799 --> 00:03:44,350
the liability shifted away from them but

86
00:03:44,350 --> 00:03:47,830
also there's a roaring trend of making

87
00:03:47,830 --> 00:03:50,950
the car holder liable in case there was

88
00:03:50,950 --> 00:03:53,410
an EMV transaction which use the correct

89
00:03:53,410 --> 00:03:56,830
pin because the pin is becoming the

90
00:03:56,830 --> 00:03:59,620
proof of the car holder presence it is

91
00:03:59,620 --> 00:04:01,630
considered to be this magic secure

92
00:04:01,630 --> 00:04:04,030
number that if for any reason it is

93
00:04:04,030 --> 00:04:06,340
given away it means that you the car

94
00:04:06,340 --> 00:04:08,860
holder was negligent in storing it may

95
00:04:08,860 --> 00:04:10,630
be because you you voted on a piece of

96
00:04:10,630 --> 00:04:15,519
paper or you you disclose it someone and

97
00:04:15,519 --> 00:04:17,470
this of course if it turns out that the

98
00:04:17,470 --> 00:04:20,440
pain is not actually a very secure piece

99
00:04:20,440 --> 00:04:22,270
of information it turns out to be a

100
00:04:22,270 --> 00:04:27,100
problem and that's why we think security

101
00:04:27,100 --> 00:04:30,210
of the EMV protocol is really important

102
00:04:30,210 --> 00:04:32,830
also depending on the bank and depending

103
00:04:32,830 --> 00:04:36,280
on the country the liability protection

104
00:04:36,280 --> 00:04:38,080
might not apply to ATM transactions

105
00:04:38,080 --> 00:04:39,789
because of course when you when you go

106
00:04:39,789 --> 00:04:41,090
to an ATM and

107
00:04:41,090 --> 00:04:42,980
you always have to use the pin for ATM

108
00:04:42,980 --> 00:04:44,600
transactions you can get cash directly

109
00:04:44,600 --> 00:04:47,480
and that's why sometimes the liability

110
00:04:47,480 --> 00:04:50,000
does not apply there so this is one

111
00:04:50,000 --> 00:04:52,910
example of this problem which happened

112
00:04:52,910 --> 00:04:54,770
very recently in june of this year it

113
00:04:54,770 --> 00:04:57,590
actually happen after we presented our

114
00:04:57,590 --> 00:04:59,360
research so there's been a fraud case

115
00:04:59,360 --> 00:05:01,940
481 thousand dollars where someone

116
00:05:01,940 --> 00:05:04,580
bought a race car with a credit card

117
00:05:04,580 --> 00:05:08,360
like which is funny and and of course

118
00:05:08,360 --> 00:05:10,400
the customer said i never did that and

119
00:05:10,400 --> 00:05:12,530
and the bank said our records show that

120
00:05:12,530 --> 00:05:14,630
this was a chip in pink transaction this

121
00:05:14,630 --> 00:05:16,250
means the customer personal card and

122
00:05:16,250 --> 00:05:17,870
personal pin number were using carrying

123
00:05:17,870 --> 00:05:19,669
out this transaction as a result the

124
00:05:19,669 --> 00:05:21,410
customer is liable for the transaction

125
00:05:21,410 --> 00:05:23,270
and this is exactly what we're talking

126
00:05:23,270 --> 00:05:24,919
about and this guy's in a lawsuit right

127
00:05:24,919 --> 00:05:26,450
now with a bang trying to prove that he

128
00:05:26,450 --> 00:05:29,030
didn't buy a car a race car actually

129
00:05:29,030 --> 00:05:32,690
with his credit card um so so the

130
00:05:32,690 --> 00:05:35,150
adoption on vm v is is quite massive in

131
00:05:35,150 --> 00:05:37,639
Europe I mean nearly every single

132
00:05:37,639 --> 00:05:41,470
country in Europe now implements MV and

133
00:05:41,470 --> 00:05:45,550
even if this technology is supposed to

134
00:05:45,550 --> 00:05:48,380
migrate away from the mag stripe max

135
00:05:48,380 --> 00:05:50,150
stripe is still accepted pretty much

136
00:05:50,150 --> 00:05:52,340
everyone in Europe because as long as

137
00:05:52,340 --> 00:05:53,900
every single country in the world or

138
00:05:53,900 --> 00:05:55,330
every single country which is

139
00:05:55,330 --> 00:05:58,220
considering important by the banks does

140
00:05:58,220 --> 00:06:00,710
not move to the chip of course we still

141
00:06:00,710 --> 00:06:03,020
need to add the mag stripe on the

142
00:06:03,020 --> 00:06:05,180
terminals and on the cards because we

143
00:06:05,180 --> 00:06:06,560
don't want people to travel abroad

144
00:06:06,560 --> 00:06:08,960
having a car which as the tube and then

145
00:06:08,960 --> 00:06:12,200
having the car not working so so this is

146
00:06:12,200 --> 00:06:13,789
a problem because max I prefer back is

147
00:06:13,789 --> 00:06:17,000
still accepted and and there's a fan of

148
00:06:17,000 --> 00:06:18,830
thing you can always trigger a max rug

149
00:06:18,830 --> 00:06:20,840
fall back with your car so if you swipe

150
00:06:20,840 --> 00:06:23,720
a card which has a chip the max I will

151
00:06:23,720 --> 00:06:25,340
tell the reader that you have a chip and

152
00:06:25,340 --> 00:06:27,110
as women always say oh well you have a

153
00:06:27,110 --> 00:06:29,060
chip so we got to use the chip but then

154
00:06:29,060 --> 00:06:30,800
if you put a chip which is not readable

155
00:06:30,800 --> 00:06:32,900
or if you insert the card in the wrong

156
00:06:32,900 --> 00:06:34,910
way then the terminal won't be able to

157
00:06:34,910 --> 00:06:36,919
read the chip and will say okay let's

158
00:06:36,919 --> 00:06:39,590
use the max right so you can always fall

159
00:06:39,590 --> 00:06:42,110
back to max right regardless of the fact

160
00:06:42,110 --> 00:06:45,050
that your card as the chip which pretty

161
00:06:45,050 --> 00:06:47,120
much at this point defies the point of

162
00:06:47,120 --> 00:06:51,380
of the chip because if you can see if

163
00:06:51,380 --> 00:06:52,360
you can skim

164
00:06:52,360 --> 00:06:53,860
the max wrote you can still use it

165
00:06:53,860 --> 00:06:55,810
despite the fact that the MV is widely

166
00:06:55,810 --> 00:06:58,509
adopted so those reading in research

167
00:06:58,509 --> 00:07:00,550
about the MV are done by the excellent

168
00:07:00,550 --> 00:07:02,229
group of researchers a Cambridge so

169
00:07:02,229 --> 00:07:04,449
where they shown is that you can

170
00:07:04,449 --> 00:07:07,180
actually steal a car and use the car

171
00:07:07,180 --> 00:07:09,069
without a pin which of course defines

172
00:07:09,069 --> 00:07:12,250
the point of Chip and PIN and this was

173
00:07:12,250 --> 00:07:14,680
an implementation flaw actually not

174
00:07:14,680 --> 00:07:17,139
another design flaw so this blog can

175
00:07:17,139 --> 00:07:19,599
potentially be fixed but of course it's

176
00:07:19,599 --> 00:07:21,430
not going to be fixed only one bank I

177
00:07:21,430 --> 00:07:23,620
can fix it because they're being very

178
00:07:23,620 --> 00:07:26,919
lazy and also every time you have one of

179
00:07:26,919 --> 00:07:28,930
these problems in mercy claims that it's

180
00:07:28,930 --> 00:07:30,879
very difficult and impractical to do

181
00:07:30,879 --> 00:07:33,580
these kind of attacks and we're going to

182
00:07:33,580 --> 00:07:36,279
talk about that so what our research

183
00:07:36,279 --> 00:07:39,389
does it follows up from the Cambridge

184
00:07:39,389 --> 00:07:42,759
research and we see first of all what

185
00:07:42,759 --> 00:07:45,370
can we do with skimming so skimming

186
00:07:45,370 --> 00:07:47,050
means that we have a need an electronic

187
00:07:47,050 --> 00:07:48,819
device which can intercept the

188
00:07:48,819 --> 00:07:50,259
communication between the car and the

189
00:07:50,259 --> 00:07:54,189
terminal so what can we do with with

190
00:07:54,189 --> 00:07:56,500
with the chip and pin skimmer okay so

191
00:07:56,500 --> 00:07:59,560
you probably heard the term skimming

192
00:07:59,560 --> 00:08:01,930
refer to max rhymes so when you steal

193
00:08:01,930 --> 00:08:03,759
the information from a max raipur car

194
00:08:03,759 --> 00:08:07,719
you use a mag stripe skimmer and we're

195
00:08:07,719 --> 00:08:09,219
going to see what we can do with a chip

196
00:08:09,219 --> 00:08:12,430
skimmer and we're going to see if we can

197
00:08:12,430 --> 00:08:15,569
harvest the pins because again though a

198
00:08:15,569 --> 00:08:17,770
critical component of the liability

199
00:08:17,770 --> 00:08:21,129
shift on point of sales terminals and we

200
00:08:21,129 --> 00:08:24,009
ignore mag stripe skimming because I

201
00:08:24,009 --> 00:08:26,469
mean lots of other people ready talk

202
00:08:26,469 --> 00:08:29,259
about that so this is an example of ATM

203
00:08:29,259 --> 00:08:31,649
skimmers that are being used right now

204
00:08:31,649 --> 00:08:34,479
you can see here this device here was

205
00:08:34,479 --> 00:08:36,909
actually overlaid on the ATM and it

206
00:08:36,909 --> 00:08:39,429
contains an EMV skimmer units and

207
00:08:39,429 --> 00:08:41,948
usually what you have while you skim the

208
00:08:41,948 --> 00:08:43,929
mag stripe you also need some kind of

209
00:08:43,929 --> 00:08:47,740
camera or a phone that can actually look

210
00:08:47,740 --> 00:08:50,380
on the pin pad and then see when you're

211
00:08:50,380 --> 00:08:53,529
typing your PIN Oh which of course it's

212
00:08:53,529 --> 00:08:56,050
a very manual process you need someone

213
00:08:56,050 --> 00:08:58,810
to correlate the timing between whatever

214
00:08:58,810 --> 00:09:01,600
is fetched by this device and whatever

215
00:09:01,600 --> 00:09:03,810
is recorded by the camera and you gotta

216
00:09:03,810 --> 00:09:07,449
you know understand the hand gesture and

217
00:09:07,449 --> 00:09:10,270
get the pin one other option more

218
00:09:10,270 --> 00:09:12,520
invasive you can overlay a fake pin pad

219
00:09:12,520 --> 00:09:15,010
on the ATM which can also relate

220
00:09:15,010 --> 00:09:17,290
information over gsm see more or

221
00:09:17,290 --> 00:09:18,790
whatever this is actually one our

222
00:09:18,790 --> 00:09:22,240
example of on chips sorry a magistrate

223
00:09:22,240 --> 00:09:25,959
skimmer so we predict that of course

224
00:09:25,959 --> 00:09:28,690
when Max type goes away but also on

225
00:09:28,690 --> 00:09:30,399
point-of-sale terminals that skimming

226
00:09:30,399 --> 00:09:32,319
the chip will become the next big thing

227
00:09:32,319 --> 00:09:35,079
because the chip interface is accessible

228
00:09:35,079 --> 00:09:37,510
by design so it becomes impossible for

229
00:09:37,510 --> 00:09:39,940
the user to verify if a chip skimmer is

230
00:09:39,940 --> 00:09:42,279
being inserted or not if you have a

231
00:09:42,279 --> 00:09:43,899
match type schema on a point of sales

232
00:09:43,899 --> 00:09:45,850
you might be able if you're if you're a

233
00:09:45,850 --> 00:09:48,010
10 if you're if you put enough attention

234
00:09:48,010 --> 00:09:50,140
you might be able to understand if there

235
00:09:50,140 --> 00:09:51,970
are two max right heads instead of just

236
00:09:51,970 --> 00:09:53,680
one but if you have a chip skimmer

237
00:09:53,680 --> 00:09:54,880
inside the terminal there's no way you

238
00:09:54,880 --> 00:09:57,940
can see it so on an EMV steamer can

239
00:09:57,940 --> 00:09:59,860
really go undetected for a very very

240
00:09:59,860 --> 00:10:02,829
long time which of course it's a problem

241
00:10:02,829 --> 00:10:05,589
so the industry lots to point fingers

242
00:10:05,589 --> 00:10:07,600
and impracticality the industry says

243
00:10:07,600 --> 00:10:09,699
well if you can implement a chip skimmer

244
00:10:09,699 --> 00:10:11,170
it kind of looks like this this is going

245
00:10:11,170 --> 00:10:12,910
to be your chip skimmer okay you gotta

246
00:10:12,910 --> 00:10:14,079
need a fuel thing is going to be

247
00:10:14,079 --> 00:10:16,120
something big and very impractical you

248
00:10:16,120 --> 00:10:18,010
would spend lots of money so I will

249
00:10:18,010 --> 00:10:20,769
never work so that's why we did this so

250
00:10:20,769 --> 00:10:22,750
this maybe you want to talk about it

251
00:10:22,750 --> 00:10:26,470
yeah sure so this is a yeah it doesn't

252
00:10:26,470 --> 00:10:29,740
look like like a shuttle so yeah this is

253
00:10:29,740 --> 00:10:35,800
a env skimmer prototype it's quite

254
00:10:35,800 --> 00:10:39,519
simple they didn't the old logical part

255
00:10:39,519 --> 00:10:41,740
of the skimmer is contained in a single

256
00:10:41,740 --> 00:10:46,060
integrated circuit and basically this

257
00:10:46,060 --> 00:10:49,930
this kind of schema offers a lot of

258
00:10:49,930 --> 00:10:53,260
advantage for instance the installation

259
00:10:53,260 --> 00:10:55,269
of the Akuma itself is quite you know

260
00:10:55,269 --> 00:10:58,590
easy because we you can wear

261
00:10:58,590 --> 00:11:01,770
can do is to work the virtual skimmer on

262
00:11:01,770 --> 00:11:05,220
a special code and that allows you to

263
00:11:05,220 --> 00:11:08,420
insert the skimmer and to into the

264
00:11:08,420 --> 00:11:12,540
because lot of the of the PS device and

265
00:11:12,540 --> 00:11:14,730
the dead out of course is this terminal

266
00:11:14,730 --> 00:11:17,220
is open challenge that we have seen the

267
00:11:17,220 --> 00:11:20,040
skimmer inside but once it's inside you

268
00:11:20,040 --> 00:11:22,920
will never be able to save the other

269
00:11:22,920 --> 00:11:28,400
advantages that this kind of Skinner as

270
00:11:28,400 --> 00:11:32,190
it's that it can be powered by D here's

271
00:11:32,190 --> 00:11:34,500
the by itself so it doesn't require any

272
00:11:34,500 --> 00:11:38,190
external battery or something and of

273
00:11:38,190 --> 00:11:41,070
course the data that he can collect from

274
00:11:41,070 --> 00:11:44,460
the from the transactions can be

275
00:11:44,460 --> 00:11:47,640
downloaded in I don't know in a second

276
00:11:47,640 --> 00:11:50,790
moment by using a special card that can

277
00:11:50,790 --> 00:11:54,450
be recognized by the skimmer itself and

278
00:11:54,450 --> 00:11:57,780
as I said the development effort is

279
00:11:57,780 --> 00:12:01,470
quite lethal and it's it's quite cheap

280
00:12:01,470 --> 00:12:03,900
and and as we can see this is extremely

281
00:12:03,900 --> 00:12:06,270
thin I mean you can if you if you want

282
00:12:06,270 --> 00:12:07,980
to see this device and close we can of

283
00:12:07,980 --> 00:12:09,750
course show it to you after presentation

284
00:12:09,750 --> 00:12:12,870
it is very very very thin and it really

285
00:12:12,870 --> 00:12:17,130
can go on the cat undetected sir so let

286
00:12:17,130 --> 00:12:19,770
me show you wanting a few examples of

287
00:12:19,770 --> 00:12:22,260
why these devices can actually be

288
00:12:22,260 --> 00:12:24,180
inserted inside a point-of-sale device

289
00:12:24,180 --> 00:12:26,460
without being noticed so because of

290
00:12:26,460 --> 00:12:27,990
course these devices they have

291
00:12:27,990 --> 00:12:32,550
tamper-proof sensors so we analyze free

292
00:12:32,550 --> 00:12:34,610
devices which are the most commonly

293
00:12:34,610 --> 00:12:37,470
deployed around Europe ninety percent of

294
00:12:37,470 --> 00:12:39,840
the terminals around Europe are made

295
00:12:39,840 --> 00:12:41,640
from these brands and are exactly these

296
00:12:41,640 --> 00:12:43,890
models so this is the first one we

297
00:12:43,890 --> 00:12:47,010
analyzed and so this is the actuals

298
00:12:47,010 --> 00:12:50,790
marker enclosure here so our device goes

299
00:12:50,790 --> 00:12:53,250
right inside here and you would never be

300
00:12:53,250 --> 00:12:55,410
able to see that is actually in certain

301
00:12:55,410 --> 00:12:58,680
here and so remember this design because

302
00:12:58,680 --> 00:13:01,590
we're going to get back to actually this

303
00:13:01,590 --> 00:13:05,340
enclosure here and if we open the device

304
00:13:05,340 --> 00:13:08,280
we see that actually there are some

305
00:13:08,280 --> 00:13:09,260
security

306
00:13:09,260 --> 00:13:13,460
so this pin over here makes contact with

307
00:13:13,460 --> 00:13:16,580
the actual stresses of the terminal and

308
00:13:16,580 --> 00:13:19,490
you have two pins one here and one here

309
00:13:19,490 --> 00:13:22,550
and so what happens is that when you

310
00:13:22,550 --> 00:13:24,950
open the device if you try to mess with

311
00:13:24,950 --> 00:13:27,290
the device the security pins gets

312
00:13:27,290 --> 00:13:30,470
triggered and it will erase the security

313
00:13:30,470 --> 00:13:32,630
module of the terminal that's its

314
00:13:32,630 --> 00:13:34,880
primary function and the secondary

315
00:13:34,880 --> 00:13:37,070
functioning is it will prevent the

316
00:13:37,070 --> 00:13:39,200
terminal to actual reward so the

317
00:13:39,200 --> 00:13:41,840
security module is a piece of is a chip

318
00:13:41,840 --> 00:13:43,730
on the formula which is powered by a

319
00:13:43,730 --> 00:13:46,430
battery and all the symmetric key which

320
00:13:46,430 --> 00:13:49,250
is actually used for verifying that the

321
00:13:49,250 --> 00:13:51,740
car is actually legitimate but the

322
00:13:51,740 --> 00:13:53,510
interesting thing is that the security

323
00:13:53,510 --> 00:13:55,430
module is actually not used by EMV at

324
00:13:55,430 --> 00:13:57,830
all the security module is used by

325
00:13:57,830 --> 00:13:59,450
propriety application that needs a

326
00:13:59,450 --> 00:14:01,550
symmetric key to be shared between the

327
00:14:01,550 --> 00:14:04,130
car and the terminal so so that function

328
00:14:04,130 --> 00:14:08,270
is actually not proactive for EMV

329
00:14:08,270 --> 00:14:10,670
protection but of course the fact that

330
00:14:10,670 --> 00:14:14,180
the device it's actually starts working

331
00:14:14,180 --> 00:14:15,320
then of course that's a problem for

332
00:14:15,320 --> 00:14:16,850
every single transaction that you're

333
00:14:16,850 --> 00:14:19,070
trying to do but the problem is that

334
00:14:19,070 --> 00:14:21,950
these security pins they actually do not

335
00:14:21,950 --> 00:14:25,430
protect the the chip interface in all

336
00:14:25,430 --> 00:14:27,890
our times we were able to insert the

337
00:14:27,890 --> 00:14:29,630
skimming device without actually

338
00:14:29,630 --> 00:14:32,600
triggering any of these of these sensors

339
00:14:32,600 --> 00:14:35,620
because this is the actual enclosure of

340
00:14:35,620 --> 00:14:38,470
of this marker and there is nothing

341
00:14:38,470 --> 00:14:41,630
which there's no sensor there's no

342
00:14:41,630 --> 00:14:44,090
volumetric censored is nothing here that

343
00:14:44,090 --> 00:14:47,480
would actually prevent a skimmer from

344
00:14:47,480 --> 00:14:49,010
being inserted and this is the actual

345
00:14:49,010 --> 00:14:53,750
security module of the terminal this is

346
00:14:53,750 --> 00:14:55,370
its battery and this is the one that is

347
00:14:55,370 --> 00:14:58,790
actually being protected by the pins so

348
00:14:58,790 --> 00:15:02,870
you also have security pins here

349
00:15:02,870 --> 00:15:05,540
protecting the pin pad so if you're

350
00:15:05,540 --> 00:15:10,760
trying to slide something are within the

351
00:15:10,760 --> 00:15:13,610
the pin pad layer and the actual board

352
00:15:13,610 --> 00:15:16,370
then you will cut the connection of

353
00:15:16,370 --> 00:15:19,510
these pins and that will also

354
00:15:19,510 --> 00:15:23,080
trigger to security the intrusion sensor

355
00:15:23,080 --> 00:15:25,470
of the device preventing the device our

356
00:15:25,470 --> 00:15:29,920
work so but all of this really doesn't

357
00:15:29,920 --> 00:15:32,260
prevent a bad things to happen this is

358
00:15:32,260 --> 00:15:35,980
one other device which we analyzed which

359
00:15:35,980 --> 00:15:38,140
is very well done in the inside so we

360
00:15:38,140 --> 00:15:40,480
see again here so this is a pin pad

361
00:15:40,480 --> 00:15:42,550
protection so in case you're tapping

362
00:15:42,550 --> 00:15:44,740
your pain and you don't want the

363
00:15:44,740 --> 00:15:46,900
merchant to see the pin we have the

364
00:15:46,900 --> 00:15:48,550
Maxwell period here and this is the

365
00:15:48,550 --> 00:15:52,600
actual smarter enclosure and this unit

366
00:15:52,600 --> 00:15:54,490
is actually very well done inside so we

367
00:15:54,490 --> 00:15:57,520
have one security switch again which

368
00:15:57,520 --> 00:15:59,350
prevents if you if you just try to open

369
00:15:59,350 --> 00:16:02,230
the device that will be triggered by the

370
00:16:02,230 --> 00:16:07,720
way um again security switches over here

371
00:16:07,720 --> 00:16:11,110
one is a news the other one is used and

372
00:16:11,110 --> 00:16:12,910
this is the actual security module which

373
00:16:12,910 --> 00:16:14,560
is also well protected if you try to

374
00:16:14,560 --> 00:16:18,280
slide everything through in a won't work

375
00:16:18,280 --> 00:16:21,070
but as we can see this the actual smart

376
00:16:21,070 --> 00:16:23,710
an enclosure is completely of course

377
00:16:23,710 --> 00:16:25,600
it's very hard to protected because if

378
00:16:25,600 --> 00:16:26,770
you want to insert your card in the

379
00:16:26,770 --> 00:16:29,290
first place then then how do you protect

380
00:16:29,290 --> 00:16:34,000
it we also have the security things here

381
00:16:34,000 --> 00:16:35,620
for a pimp odd and this is actual

382
00:16:35,620 --> 00:16:40,060
pimping and so these are the security

383
00:16:40,060 --> 00:16:42,670
hints but what you can do with this

384
00:16:42,670 --> 00:16:44,590
device this is pretty funny the fact

385
00:16:44,590 --> 00:16:46,480
that he has a pin pad protection here

386
00:16:46,480 --> 00:16:48,580
actually helps you in skimming the pimp

387
00:16:48,580 --> 00:16:50,710
I be if you if you really want so we

388
00:16:50,710 --> 00:16:53,080
built a prototype that creates an

389
00:16:53,080 --> 00:16:55,960
overlaid pin but here and then it slides

390
00:16:55,960 --> 00:16:58,240
inside the axial smarter and enclosure

391
00:16:58,240 --> 00:17:01,330
to actually to actually skim the max

392
00:17:01,330 --> 00:17:03,820
right so this is how it's supposed to

393
00:17:03,820 --> 00:17:06,609
work and what we did we created a fake

394
00:17:06,609 --> 00:17:09,849
pinned back plate which could just be

395
00:17:09,849 --> 00:17:12,459
overlaid so this is this is the device

396
00:17:12,459 --> 00:17:14,829
compromise with the overlaid pin pad and

397
00:17:14,829 --> 00:17:17,140
it would be very difficult to see in am

398
00:17:17,140 --> 00:17:19,359
showing it as a secret underneath and

399
00:17:19,359 --> 00:17:21,550
the actual micro radar going inside that

400
00:17:21,550 --> 00:17:24,400
yeah sure our skimmer goes inside this

401
00:17:24,400 --> 00:17:26,319
micro rigor so so the point we're trying

402
00:17:26,319 --> 00:17:28,540
to make is that no matter what kind of

403
00:17:28,540 --> 00:17:30,520
physical protection you will try to

404
00:17:30,520 --> 00:17:31,370
implement on your

405
00:17:31,370 --> 00:17:33,050
device there will always be a chance for

406
00:17:33,050 --> 00:17:35,240
actually skimming things mechanical if

407
00:17:35,240 --> 00:17:37,610
you really want to and this is another

408
00:17:37,610 --> 00:17:41,800
view of the device being been skimmed

409
00:17:41,800 --> 00:17:44,120
then there's also this device which was

410
00:17:44,120 --> 00:17:49,309
really fun so this device again it tries

411
00:17:49,309 --> 00:17:52,160
to have security pins there's one here

412
00:17:52,160 --> 00:17:53,930
for actually protecting the security

413
00:17:53,930 --> 00:17:56,080
module which is powered by this battery

414
00:17:56,080 --> 00:18:00,110
and it does a decent job however it has

415
00:18:00,110 --> 00:18:03,770
one big problem so here this view will

416
00:18:03,770 --> 00:18:06,620
see that we have these this part where

417
00:18:06,620 --> 00:18:09,500
we have exposed the actually the actual

418
00:18:09,500 --> 00:18:11,150
sim interfaced assuming that the

419
00:18:11,150 --> 00:18:12,620
interface that connects to the actual

420
00:18:12,620 --> 00:18:14,450
chip and also the interface which

421
00:18:14,450 --> 00:18:16,580
connects to to the actual pin pad and

422
00:18:16,580 --> 00:18:18,650
the problem is that while if you

423
00:18:18,650 --> 00:18:20,750
dismantle the device you trigger the

424
00:18:20,750 --> 00:18:22,640
sensor and this device will start from

425
00:18:22,640 --> 00:18:25,429
working what you can do you can lift the

426
00:18:25,429 --> 00:18:29,059
LCD display and you can expose these two

427
00:18:29,059 --> 00:18:32,480
chips and nothing nothing will ever be

428
00:18:32,480 --> 00:18:36,110
trigger so what you can do and we tested

429
00:18:36,110 --> 00:18:37,790
this you can do it in less than 10

430
00:18:37,790 --> 00:18:40,100
minutes if you have your device you can

431
00:18:40,100 --> 00:18:44,110
carefully detach this display without

432
00:18:44,110 --> 00:18:47,870
without dismantling the device without

433
00:18:47,870 --> 00:18:51,920
opening anything and you will expose so

434
00:18:51,920 --> 00:18:55,280
you got step 1 and you will expose these

435
00:18:55,280 --> 00:18:57,530
two contacts and once you've done that

436
00:18:57,530 --> 00:19:00,500
you can install on something I don't

437
00:19:00,500 --> 00:19:02,600
know if you ever have your wii your

438
00:19:02,600 --> 00:19:04,640
nintendo wii but you have some plugs

439
00:19:04,640 --> 00:19:06,679
that they get overlaid on the chip and

440
00:19:06,679 --> 00:19:08,990
they intercept all the pin so that you

441
00:19:08,990 --> 00:19:10,460
can you you will get the keypad

442
00:19:10,460 --> 00:19:12,470
information from here and you will also

443
00:19:12,470 --> 00:19:15,679
get access to the actual smart card

444
00:19:15,679 --> 00:19:18,410
which is being inserted and then you can

445
00:19:18,410 --> 00:19:21,350
put the LCD display backing and no one

446
00:19:21,350 --> 00:19:23,720
there's no there's no way that no one

447
00:19:23,720 --> 00:19:25,610
will ever detect that you've done

448
00:19:25,610 --> 00:19:29,090
something like this so from a tamper

449
00:19:29,090 --> 00:19:30,890
proof point of view you can always play

450
00:19:30,890 --> 00:19:32,600
really nasty things with a point-of-sale

451
00:19:32,600 --> 00:19:34,640
devices you always have to assume that

452
00:19:34,640 --> 00:19:36,830
your point-of-sale device is really not

453
00:19:36,830 --> 00:19:38,990
trusted which which means that it

454
00:19:38,990 --> 00:19:40,940
putting the painting inside it's it's

455
00:19:40,940 --> 00:19:42,279
you know it's

456
00:19:42,279 --> 00:19:44,229
no the most secure thing but we'll see

457
00:19:44,229 --> 00:19:47,049
how things are actually much worse than

458
00:19:47,049 --> 00:19:49,690
this so so we think that the fact that

459
00:19:49,690 --> 00:19:51,849
you you can mechanically have these

460
00:19:51,849 --> 00:19:54,070
devices and most important it can insert

461
00:19:54,070 --> 00:19:55,749
something like this within the

462
00:19:55,749 --> 00:19:57,399
point-of-sale device without triggering

463
00:19:57,399 --> 00:19:59,590
anything we think it's problematic and

464
00:19:59,590 --> 00:20:01,389
now we're going to talk about what you

465
00:20:01,389 --> 00:20:03,909
can actually get which kind of data you

466
00:20:03,909 --> 00:20:06,070
can get by using this device and how you

467
00:20:06,070 --> 00:20:08,469
can leverage any attacks from from this

468
00:20:08,469 --> 00:20:10,419
but as we think we're bored you'll

469
00:20:10,419 --> 00:20:12,219
enough so this is this is the part where

470
00:20:12,219 --> 00:20:14,889
we show how you can get those with our

471
00:20:14,889 --> 00:20:16,299
research because we think it's very

472
00:20:16,299 --> 00:20:18,009
important not to bore the audience and

473
00:20:18,009 --> 00:20:20,200
if you seen our presentation two years

474
00:20:20,200 --> 00:20:21,580
ago you will know that there's an

475
00:20:21,580 --> 00:20:24,099
ongoing start of this very cheesy movies

476
00:20:24,099 --> 00:20:26,469
so to any of you that hasn't seen our

477
00:20:26,469 --> 00:20:29,200
movies it's the evil hacker versus the

478
00:20:29,200 --> 00:20:31,149
failed porn star of course I'm the evil

479
00:20:31,149 --> 00:20:34,960
hacker knees the film poster I'm the

480
00:20:34,960 --> 00:20:37,960
pastor I decide what to do and so we had

481
00:20:37,960 --> 00:20:41,589
a series of epic failure by the failed

482
00:20:41,589 --> 00:20:44,379
porn star it was typing on on his laptop

483
00:20:44,379 --> 00:20:46,539
and it was frickin laser beams that were

484
00:20:46,539 --> 00:20:48,460
actually analyzing the keystrokes and

485
00:20:48,460 --> 00:20:50,109
then the evil hacker was actually being

486
00:20:50,109 --> 00:20:51,909
able to intercept everything that we was

487
00:20:51,909 --> 00:20:53,589
typing this was talking two years ago

488
00:20:53,589 --> 00:20:56,349
this is actually can be done for real so

489
00:20:56,349 --> 00:20:59,499
this is the face of epic fail and this

490
00:20:59,499 --> 00:21:01,839
is the return of investment okay so this

491
00:21:01,839 --> 00:21:03,419
is this is a business-friendly

492
00:21:03,419 --> 00:21:06,070
presentation if you see if you show this

493
00:21:06,070 --> 00:21:08,289
lie to your manager you will be able to

494
00:21:08,289 --> 00:21:10,359
get budget for every kind of attack you

495
00:21:10,359 --> 00:21:13,450
wanna you want to investigate so so yes

496
00:21:13,450 --> 00:21:15,759
so return of investment so it really

497
00:21:15,759 --> 00:21:18,039
works so now we're going to show you how

498
00:21:18,039 --> 00:21:20,469
you can do this thing by with credit

499
00:21:20,469 --> 00:21:26,559
cards so come on how are you a very

500
00:21:26,559 --> 00:21:29,129
expensive

501
00:21:37,630 --> 00:21:43,480
so my arm is sunglasses

502
00:21:55,369 --> 00:21:58,789
do you think

503
00:22:13,600 --> 00:22:15,659
ah

504
00:22:35,810 --> 00:22:38,810
ok

505
00:22:51,430 --> 00:22:54,430
here

506
00:23:12,250 --> 00:23:16,030
nothing you're not

507
00:23:23,980 --> 00:23:26,040
Oh

508
00:23:34,279 --> 00:23:36,369
you

509
00:23:49,660 --> 00:23:51,690
Oh

510
00:23:54,410 --> 00:23:57,620
we are

511
00:24:01,330 --> 00:24:10,190
so thanks so your experience may differ

512
00:24:10,190 --> 00:24:12,109
so if you do this and it doesn't work

513
00:24:12,109 --> 00:24:14,570
done to us okay it's not our fault it

514
00:24:14,570 --> 00:24:16,609
might be because you're not Italian I

515
00:24:16,609 --> 00:24:18,499
don't know it might just not work also

516
00:24:18,499 --> 00:24:21,590
i'm not sure why when when your credit

517
00:24:21,590 --> 00:24:23,210
card on where you say that you are alone

518
00:24:23,210 --> 00:24:26,059
I mean why was it your lighter his own

519
00:24:26,059 --> 00:24:28,309
improvisation is vital in this role I

520
00:24:28,309 --> 00:24:31,099
have to say so anyway so let's get to

521
00:24:31,099 --> 00:24:35,559
the boring part back again so go ahead

522
00:24:35,559 --> 00:24:40,309
so the informations and the in the chips

523
00:24:40,309 --> 00:24:45,109
is a our story in in a file system so

524
00:24:45,109 --> 00:24:47,749
the data is organized in different

525
00:24:47,749 --> 00:24:52,190
applications files and records and the

526
00:24:52,190 --> 00:24:55,940
way so the time now basically talk to

527
00:24:55,940 --> 00:24:59,869
the card using formalism that that's

528
00:24:59,869 --> 00:25:03,710
called a PDA with messages and a PDO

529
00:25:03,710 --> 00:25:06,589
messages are using are used for reading

530
00:25:06,589 --> 00:25:09,320
the records and dishing comments from

531
00:25:09,320 --> 00:25:12,830
the terminal to the card here we have to

532
00:25:12,830 --> 00:25:16,599
take samples the first one is select

533
00:25:16,599 --> 00:25:19,249
basically basically the common that's

534
00:25:19,249 --> 00:25:21,499
selected which application to use them

535
00:25:21,499 --> 00:25:22,999
on the card and the second one is a

536
00:25:22,999 --> 00:25:27,649
verified thing yeah we see look sorry we

537
00:25:27,649 --> 00:25:29,869
will see a little bit more about the in

538
00:25:29,869 --> 00:25:33,259
verification in the next place so

539
00:25:33,259 --> 00:25:36,859
basically what's our skimmer does is to

540
00:25:36,859 --> 00:25:38,989
intercept the communication between the

541
00:25:38,989 --> 00:25:41,239
the card and the terminal shop we are

542
00:25:41,239 --> 00:25:44,029
making a man-in-the-middle a usual met

543
00:25:44,029 --> 00:25:46,969
men in the middle so during the

544
00:25:46,969 --> 00:25:48,710
communication between the terminal end

545
00:25:48,710 --> 00:25:52,159
and the carb the first step is you know

546
00:25:52,159 --> 00:25:54,859
the finish to initially to be the

547
00:25:54,859 --> 00:25:56,509
application processing that means that

548
00:25:56,509 --> 00:25:59,210
the terminal basically select which

549
00:25:59,210 --> 00:26:02,389
application to use actual is the

550
00:26:02,389 --> 00:26:05,179
operator that select using using new you

551
00:26:05,179 --> 00:26:07,759
know the terminal operators can select

552
00:26:07,759 --> 00:26:09,530
if using be

553
00:26:09,530 --> 00:26:11,750
you know if the card contains different

554
00:26:11,750 --> 00:26:16,040
application which one is is going to use

555
00:26:16,040 --> 00:26:19,280
real application data so basically the

556
00:26:19,280 --> 00:26:23,150
terminal reads all the records that are

557
00:26:23,150 --> 00:26:25,400
interesting for me for making the actual

558
00:26:25,400 --> 00:26:29,300
transaction from from the card and after

559
00:26:29,300 --> 00:26:33,200
the DoD application data is read we have

560
00:26:33,200 --> 00:26:38,770
to perform the data authentication and

561
00:26:38,770 --> 00:26:44,720
decoder verification and after that you

562
00:26:44,720 --> 00:26:47,530
know the actual transaction rossum and

563
00:26:47,530 --> 00:26:50,360
finally we have the issue of processing

564
00:26:50,360 --> 00:26:53,300
this is an optional step and it's used

565
00:26:53,300 --> 00:26:56,240
by by the issue of raisins I don't have

566
00:26:56,240 --> 00:27:02,960
to change the pin on the card so the

567
00:27:02,960 --> 00:27:05,210
application button the card is stored

568
00:27:05,210 --> 00:27:10,220
using a ball kv formalism and here we

569
00:27:10,220 --> 00:27:12,770
have a couple of different examples

570
00:27:12,770 --> 00:27:17,900
couple of different tags I don't know I

571
00:27:17,900 --> 00:27:19,670
mean the first one is the application

572
00:27:19,670 --> 00:27:23,900
identifier can be visa or mastercard or

573
00:27:23,900 --> 00:27:26,450
whatever the second one is the language

574
00:27:26,450 --> 00:27:29,270
the language preference tag in this case

575
00:27:29,270 --> 00:27:31,480
you know the language preference is set

576
00:27:31,480 --> 00:27:35,510
on Italian English French and so the

577
00:27:35,510 --> 00:27:37,100
Nilla spy language in reference is

578
00:27:37,100 --> 00:27:39,590
broken so as a second language instead

579
00:27:39,590 --> 00:27:42,020
of English yes German every time it goes

580
00:27:42,020 --> 00:27:44,570
abroad in the end says things in German

581
00:27:44,570 --> 00:27:45,890
which of course you cannot understand

582
00:27:45,890 --> 00:27:48,470
which is so if that's messed up that's

583
00:27:48,470 --> 00:27:51,890
weird one of the Sun oh yeah tuckwell no

584
00:27:51,890 --> 00:27:54,410
discretionary data and talk to her own

585
00:27:54,410 --> 00:27:57,380
data we see little bit more about those

586
00:27:57,380 --> 00:28:02,750
two trucks the next slides so we are

587
00:28:02,750 --> 00:28:05,540
other interesting things or like the the

588
00:28:05,540 --> 00:28:09,590
credit card number da yen the card or

589
00:28:09,590 --> 00:28:13,130
the verification method list and you

590
00:28:13,130 --> 00:28:15,980
know I'm gonna see where we can see the

591
00:28:15,980 --> 00:28:18,770
name and of course you have the counter

592
00:28:18,770 --> 00:28:21,440
the transaction and the pin try counter

593
00:28:21,440 --> 00:28:23,810
in order to be able you know understand

594
00:28:23,810 --> 00:28:27,440
if if you are over with the we dip in a

595
00:28:27,440 --> 00:28:32,180
trice so the first question that we

596
00:28:32,180 --> 00:28:35,960
posed ourselves was just by getting this

597
00:28:35,960 --> 00:28:39,500
data which is red in the clear by the

598
00:28:39,500 --> 00:28:42,740
terminal from the car can we do a max

599
00:28:42,740 --> 00:28:46,520
tracfone so because we have the name we

600
00:28:46,520 --> 00:28:48,710
have the expiration date we have truck

601
00:28:48,710 --> 00:28:51,350
one in fact to a truck one discretionary

602
00:28:51,350 --> 00:28:53,330
data and truck one equivalent data which

603
00:28:53,330 --> 00:28:55,610
is actually a copy of what is on the max

604
00:28:55,610 --> 00:28:59,450
right so can we do a max I ballon so it

605
00:28:59,450 --> 00:29:01,040
used to be that gas you can do one

606
00:29:01,040 --> 00:29:02,660
hundred percent body max right clone

607
00:29:02,660 --> 00:29:04,640
from the chip so if you skim the chip

608
00:29:04,640 --> 00:29:06,350
you can counter max web and then you can

609
00:29:06,350 --> 00:29:08,000
use the card whatever you want as a

610
00:29:08,000 --> 00:29:10,790
match for so they figure that out after

611
00:29:10,790 --> 00:29:13,010
a few years and they follow maybe it's a

612
00:29:13,010 --> 00:29:18,380
bad thing um and and now they put a free

613
00:29:18,380 --> 00:29:21,500
visits number which is different on the

614
00:29:21,500 --> 00:29:23,150
cheap compared to the one on the max

615
00:29:23,150 --> 00:29:25,460
tribe so when you try to make a clone

616
00:29:25,460 --> 00:29:27,230
from the chip to the max right you will

617
00:29:27,230 --> 00:29:30,920
get everything right except for the free

618
00:29:30,920 --> 00:29:34,160
Regis number which is the actual cvv so

619
00:29:34,160 --> 00:29:37,910
and and then that this difference evv

620
00:29:37,910 --> 00:29:40,940
they call it I cvv so a nowadays it

621
00:29:40,940 --> 00:29:42,650
should be present on every single card

622
00:29:42,650 --> 00:29:48,260
so the problem is that on knowing that

623
00:29:48,260 --> 00:29:51,080
the entire security of the data right

624
00:29:51,080 --> 00:29:53,960
from the chip is based on a three digits

625
00:29:53,960 --> 00:29:56,000
number when it comes to corn into a max

626
00:29:56,000 --> 00:30:00,830
rub is really worrying because if I chip

627
00:30:00,830 --> 00:30:03,260
skimmer is installed again it can really

628
00:30:03,260 --> 00:30:04,880
go undetected for a very long time and

629
00:30:04,880 --> 00:30:06,890
it can potentially skin thousands of

630
00:30:06,890 --> 00:30:09,350
cards every day which means that if you

631
00:30:09,350 --> 00:30:11,720
try a random cvv number you will get one

632
00:30:11,720 --> 00:30:13,940
of them right or even more than one of

633
00:30:13,940 --> 00:30:17,180
them right and also many backends many

634
00:30:17,180 --> 00:30:20,060
bank back and staying film to warn the

635
00:30:20,060 --> 00:30:22,670
customer or to trigger any alert if you

636
00:30:22,670 --> 00:30:26,000
try going to to to swipe a max I which

637
00:30:26,000 --> 00:30:28,610
as the incorrect cvv number you will

638
00:30:28,610 --> 00:30:29,990
never get an alert we actually tested

639
00:30:29,990 --> 00:30:33,650
this so you know it is better than doing

640
00:30:33,650 --> 00:30:36,049
one hundred percent accurate clone but

641
00:30:36,049 --> 00:30:38,540
it still you know it still doesn't

642
00:30:38,540 --> 00:30:41,780
protect and of course we think this is a

643
00:30:41,780 --> 00:30:43,549
problem so this is one thing that you

644
00:30:43,549 --> 00:30:46,040
can do and again as well I said before

645
00:30:46,040 --> 00:30:48,620
if you swipe a mag stripe which has a

646
00:30:48,620 --> 00:30:51,290
cell release code which tells to the

647
00:30:51,290 --> 00:30:52,940
terminal oh well you have a chip then

648
00:30:52,940 --> 00:30:54,350
you can always insert a cheap which

649
00:30:54,350 --> 00:30:56,360
doesn't work and you will be able to

650
00:30:56,360 --> 00:30:58,549
swipe the max rep again so what about

651
00:30:58,549 --> 00:31:00,500
online usage so can we use the data

652
00:31:00,500 --> 00:31:02,390
which is present on the chip to actually

653
00:31:02,390 --> 00:31:04,370
make an online usage so so you would

654
00:31:04,370 --> 00:31:06,410
finger nowadays every website you know

655
00:31:06,410 --> 00:31:08,600
ask you for the security code which is

656
00:31:08,600 --> 00:31:09,919
the code which is written on the back of

657
00:31:09,919 --> 00:31:12,140
the car or on the front of the car for

658
00:31:12,140 --> 00:31:14,660
American Express on and you also might

659
00:31:14,660 --> 00:31:16,490
think that you have verified by visa and

660
00:31:16,490 --> 00:31:18,559
mastercard securecode which protect you

661
00:31:18,559 --> 00:31:20,090
with an additional password but

662
00:31:20,090 --> 00:31:21,860
surprisingly the number of websites

663
00:31:21,860 --> 00:31:24,799
which don't check is these values in

664
00:31:24,799 --> 00:31:27,230
still nowadays warning and actually was

665
00:31:27,230 --> 00:31:29,179
very ironic while we were developing

666
00:31:29,179 --> 00:31:31,580
this talk my credit card got thought it

667
00:31:31,580 --> 00:31:35,540
and got followed by only stealing the

668
00:31:35,540 --> 00:31:36,890
information that you can actually read

669
00:31:36,890 --> 00:31:40,429
from the chip and Adam Lori's son Carl

670
00:31:40,429 --> 00:31:43,040
also got flooded so what are the chances

671
00:31:43,040 --> 00:31:45,770
are actually two speakers out of four

672
00:31:45,770 --> 00:31:48,410
being flooded while developing this song

673
00:31:48,410 --> 00:31:51,650
I think it really proves our point so so

674
00:31:51,650 --> 00:31:53,090
what they did they use my credit card

675
00:31:53,090 --> 00:31:54,470
information on the Dolce and Gabbana

676
00:31:54,470 --> 00:31:57,980
website very a climber and because this

677
00:31:57,980 --> 00:32:00,679
website as an optional security code so

678
00:32:00,679 --> 00:32:02,450
if you don't put a security code your

679
00:32:02,450 --> 00:32:04,400
transaction will go through and you will

680
00:32:04,400 --> 00:32:06,679
get your goods delivered in 24 hours so

681
00:32:06,679 --> 00:32:08,570
what they did they got two thousand

682
00:32:08,570 --> 00:32:11,480
dollars of merchandise and then two

683
00:32:11,480 --> 00:32:13,100
hundred dollars of merchandise and they

684
00:32:13,100 --> 00:32:15,650
sent the twenty-dollar merchandise to me

685
00:32:15,650 --> 00:32:19,220
as a gift pay with my own money which

686
00:32:19,220 --> 00:32:21,200
was very nice you know they were

687
00:32:21,200 --> 00:32:23,419
probably doing for testing if you know

688
00:32:23,419 --> 00:32:26,270
if my credit card really works um and

689
00:32:26,270 --> 00:32:28,669
and I didn't check it nowadays they

690
00:32:28,669 --> 00:32:30,230
still do that they have they've been

691
00:32:30,230 --> 00:32:32,000
doing this for a very long time and also

692
00:32:32,000 --> 00:32:33,500
there are companies that the entire

693
00:32:33,500 --> 00:32:34,250
exists

694
00:32:34,250 --> 00:32:36,620
is based on brokering transactions

695
00:32:36,620 --> 00:32:38,570
without security code they assume the

696
00:32:38,570 --> 00:32:40,490
liability in case of bodies being

697
00:32:40,490 --> 00:32:42,470
reported and they do that because they

698
00:32:42,470 --> 00:32:44,660
know that the percentage of fraudulent

699
00:32:44,660 --> 00:32:47,090
transaction not being reported is much

700
00:32:47,090 --> 00:32:48,740
higher than the ones that gets recorded

701
00:32:48,740 --> 00:32:50,810
so they use my credit card on one of

702
00:32:50,810 --> 00:32:52,730
these very dodgy companies that just

703
00:32:52,730 --> 00:32:55,010
gives you cash just when you give them a

704
00:32:55,010 --> 00:32:56,630
credit card number and also not

705
00:32:56,630 --> 00:32:58,700
chocolate website so they got chocolate

706
00:32:58,700 --> 00:33:00,680
which yeah that's good I would have done

707
00:33:00,680 --> 00:33:02,210
the same thing I would about chocolate

708
00:33:02,210 --> 00:33:06,890
so so we mentioned offline data

709
00:33:06,890 --> 00:33:09,140
authentication when it comes to the

710
00:33:09,140 --> 00:33:10,550
credit card transaction so what is it

711
00:33:10,550 --> 00:33:14,710
about so there are three different

712
00:33:14,710 --> 00:33:18,620
methods to put in order to perform

713
00:33:18,620 --> 00:33:22,580
offline that authentication and so there

714
00:33:22,580 --> 00:33:26,380
are three different families of of cards

715
00:33:26,380 --> 00:33:29,480
usda calls the DDA cards and the CTA

716
00:33:29,480 --> 00:33:33,470
card so we are talking about the method

717
00:33:33,470 --> 00:33:35,540
used by the terminal in order to

718
00:33:35,540 --> 00:33:39,380
validate the data the data present on on

719
00:33:39,380 --> 00:33:44,270
the card so this doesn't apply to the

720
00:33:44,270 --> 00:33:47,920
ATM transactions because ATM always goes

721
00:33:47,920 --> 00:33:52,820
online and the other important thing to

722
00:33:52,820 --> 00:33:56,060
notice is that Visa and MasterCard they

723
00:33:56,060 --> 00:33:58,360
mandated that all the cards issued after

724
00:33:58,360 --> 00:34:05,660
the 2011 should use at least DDA but

725
00:34:05,660 --> 00:34:07,760
this is really not here with jealousy

726
00:34:07,760 --> 00:34:09,980
cards issued in 2011 which don't you see

727
00:34:09,980 --> 00:34:12,199
da and anyway we'll see later that this

728
00:34:12,199 --> 00:34:14,000
is Tori awareness is not important

729
00:34:14,000 --> 00:34:16,250
actually right now in our past we mean

730
00:34:16,250 --> 00:34:19,129
we testified on the majority 40 yards

731
00:34:19,129 --> 00:34:21,770
and out of 40 cards only one was earlier

732
00:34:21,770 --> 00:34:24,469
I USDA and my new car which I got this

733
00:34:24,469 --> 00:34:26,929
year because mine was flooded is

734
00:34:26,929 --> 00:34:29,510
actually a steel and sta car and he will

735
00:34:29,510 --> 00:34:32,929
expire 2015 but again we'll see it does

736
00:34:32,929 --> 00:34:35,179
not matter i am the other thing that i'm

737
00:34:35,179 --> 00:34:38,800
missing this is this is a relevant also

738
00:34:38,800 --> 00:34:41,630
you know for offline transaction because

739
00:34:41,630 --> 00:34:44,000
this mechanism allow you to enable an

740
00:34:44,000 --> 00:34:46,699
offline transaction when when it's it's

741
00:34:46,699 --> 00:34:49,489
supported of course offline transactions

742
00:34:49,489 --> 00:34:52,880
and now i have that cornering you on in

743
00:34:52,880 --> 00:34:55,639
Europe but but but see ya this is the

744
00:34:55,639 --> 00:34:57,680
relevant for ya and also keep in mind

745
00:34:57,680 --> 00:34:59,210
that this Tanner was actually designed

746
00:34:59,210 --> 00:35:01,460
to enable offline transactions so if we

747
00:35:01,460 --> 00:35:03,350
find flaws in our plan transaction are

748
00:35:03,350 --> 00:35:05,240
being performed of course it means that

749
00:35:05,240 --> 00:35:07,690
the vehicle whole point of sack system

750
00:35:07,690 --> 00:35:12,800
so stl cars are the cheapest and the

751
00:35:12,800 --> 00:35:15,290
most widely used energy maybe because

752
00:35:15,290 --> 00:35:20,090
they are the cheapest the cheapest oh so

753
00:35:20,090 --> 00:35:24,230
basically at what what is use its in

754
00:35:24,230 --> 00:35:27,190
this kind of card is a static signature

755
00:35:27,190 --> 00:35:31,280
and asymmetric is used for the online

756
00:35:31,280 --> 00:35:36,500
transaction and the the important thing

757
00:35:36,500 --> 00:35:38,780
about this card is that they can only

758
00:35:38,780 --> 00:35:42,230
perform enough Liam Payne verification

759
00:35:42,230 --> 00:35:44,660
in clear text so the pain is always sign

760
00:35:44,660 --> 00:35:46,700
from the car to the terminal in clear

761
00:35:46,700 --> 00:35:49,370
text with this kind of when you have the

762
00:35:49,370 --> 00:35:51,050
offline pin verification you can also

763
00:35:51,050 --> 00:35:53,450
have online unification obviously if you

764
00:35:53,450 --> 00:35:55,250
have a deal if it's offline so is clear

765
00:35:55,250 --> 00:35:59,960
so let's play do play cards are more

766
00:35:59,960 --> 00:36:02,780
expensive because the Diablo involved in

767
00:36:02,780 --> 00:36:05,030
this kind of card is different they they

768
00:36:05,030 --> 00:36:10,610
are the encryption coprocessor inside

769
00:36:10,610 --> 00:36:14,660
they did the actual direction so

770
00:36:14,660 --> 00:36:17,060
basically in this kind of they are able

771
00:36:17,060 --> 00:36:19,700
to perform a proper encryption and they

772
00:36:19,700 --> 00:36:21,380
are able to perform a dynamic data

773
00:36:21,380 --> 00:36:24,570
validation so basically determined

774
00:36:24,570 --> 00:36:27,750
exchange a random number and and they

775
00:36:27,750 --> 00:36:33,060
perform a dynamic debt validation and in

776
00:36:33,060 --> 00:36:36,240
this case your flame in verification can

777
00:36:36,240 --> 00:36:38,640
be clear past or in ciphered because

778
00:36:38,640 --> 00:36:41,520
they have did the proper i deciphered

779
00:36:41,520 --> 00:36:46,020
the proper cryptographic coprocessor so

780
00:36:46,020 --> 00:36:49,710
so what can you do by knowing all of

781
00:36:49,710 --> 00:36:53,580
this so sta cards as the signature

782
00:36:53,580 --> 00:36:55,590
verification is not dynamic it means you

783
00:36:55,590 --> 00:36:58,170
can claim the car because the signature

784
00:36:58,170 --> 00:36:59,850
is just a piece of text that applies to

785
00:36:59,850 --> 00:37:02,610
the data and you can use it without pin

786
00:37:02,610 --> 00:37:04,560
for offline transactions or even with

787
00:37:04,560 --> 00:37:05,670
the thing the thing is that you can

788
00:37:05,670 --> 00:37:07,410
clone the car and you can have it say

789
00:37:07,410 --> 00:37:10,050
yes forever pin verification because the

790
00:37:10,050 --> 00:37:11,850
terminal I asks the pin to the car and

791
00:37:11,850 --> 00:37:14,280
the car says oh yes that's value or no

792
00:37:14,280 --> 00:37:16,440
that's not valid so if you make a clone

793
00:37:16,440 --> 00:37:18,240
you can make a film that will say yes to

794
00:37:18,240 --> 00:37:21,090
everything you want but this only works

795
00:37:21,090 --> 00:37:23,310
for offline transaction because online

796
00:37:23,310 --> 00:37:27,090
transactions they still use a cryptogram

797
00:37:27,090 --> 00:37:28,680
which is based on a symmetric key which

798
00:37:28,680 --> 00:37:31,620
you cannot clone easily because that's

799
00:37:31,620 --> 00:37:33,450
what smarticles are all about but for

800
00:37:33,450 --> 00:37:35,040
offline transactions you can do whatever

801
00:37:35,040 --> 00:37:37,080
you want because you can create a fake

802
00:37:37,080 --> 00:37:38,670
lip program and the terminal will have

803
00:37:38,670 --> 00:37:41,250
no way to actually understand if the

804
00:37:41,250 --> 00:37:42,750
great program is legitimate or not

805
00:37:42,750 --> 00:37:45,930
because the terminal relies on SDA in

806
00:37:45,930 --> 00:37:47,460
order to check that your card is valid

807
00:37:47,460 --> 00:37:50,580
and of course SDA in this card in this

808
00:37:50,580 --> 00:37:52,350
case would be valid because you can just

809
00:37:52,350 --> 00:37:56,940
count so a DD a car loan is ineffective

810
00:37:56,940 --> 00:37:59,370
for offline and online transaction

811
00:37:59,370 --> 00:38:00,690
however there are two things that you

812
00:38:00,690 --> 00:38:02,460
can do the first thing is you can

813
00:38:02,460 --> 00:38:04,530
prevent the ball ed DEA card to pass

814
00:38:04,530 --> 00:38:06,570
offline transaction and then you can

815
00:38:06,570 --> 00:38:09,870
create a fake cryptogram which means

816
00:38:09,870 --> 00:38:12,750
that you can still have an offline

817
00:38:12,750 --> 00:38:14,430
transaction that eventually will never

818
00:38:14,430 --> 00:38:17,790
go through also what you can do as every

819
00:38:17,790 --> 00:38:19,830
single terminal and every single card is

820
00:38:19,830 --> 00:38:23,010
required to support SDA you can just

821
00:38:23,010 --> 00:38:26,160
present an SD a car with the data that

822
00:38:26,160 --> 00:38:28,110
you get off the DDA you can always

823
00:38:28,110 --> 00:38:30,180
downgrade to that so it really doesn't

824
00:38:30,180 --> 00:38:31,920
matter what kind of looks and technology

825
00:38:31,920 --> 00:38:34,380
use you can always pull the terminal in

826
00:38:34,380 --> 00:38:36,180
case of offline transactions which

827
00:38:36,180 --> 00:38:37,519
defies the point of

828
00:38:37,519 --> 00:38:39,409
is technology being pushed for offline

829
00:38:39,409 --> 00:38:41,779
transactions but the good news is that

830
00:38:41,779 --> 00:38:43,729
offline transactions are very rare in

831
00:38:43,729 --> 00:38:47,089
Europe so this is not really a good

832
00:38:47,089 --> 00:38:50,959
attack scenario it just shows you slowly

833
00:38:50,959 --> 00:38:52,819
that this protocol is very badly

834
00:38:52,819 --> 00:38:55,939
designed so so what we discussed so far

835
00:38:55,939 --> 00:38:58,609
is that you can steal the data in order

836
00:38:58,609 --> 00:39:01,279
to potentially go into max right with

837
00:39:01,279 --> 00:39:03,169
some effort to brute force your three

838
00:39:03,169 --> 00:39:05,479
digits number and also we know that the

839
00:39:05,479 --> 00:39:07,399
camera jicaque shows that you can use a

840
00:39:07,399 --> 00:39:10,130
stolen car without the pain and this is

841
00:39:10,130 --> 00:39:11,599
an implementation flow because what

842
00:39:11,599 --> 00:39:13,939
actually did you when the verify pin

843
00:39:13,939 --> 00:39:15,890
command happens they will tell the

844
00:39:15,890 --> 00:39:17,809
terminal yeah sure the pin was correct

845
00:39:17,809 --> 00:39:19,699
and they will never say anything to the

846
00:39:19,699 --> 00:39:22,039
card so the colors never verified the

847
00:39:22,039 --> 00:39:23,749
pain but terminal things that apenas

848
00:39:23,749 --> 00:39:25,729
being ferried about the peanuts been

849
00:39:25,729 --> 00:39:27,499
verified and the transaction will go

850
00:39:27,499 --> 00:39:29,329
through however this is an

851
00:39:29,329 --> 00:39:30,979
implementation flaw because there's a

852
00:39:30,979 --> 00:39:32,719
piece of information which is sent by

853
00:39:32,719 --> 00:39:34,939
the card in the cryptogram which will

854
00:39:34,939 --> 00:39:37,609
tell the back end hey I never verify the

855
00:39:37,609 --> 00:39:39,890
pin and the terminal was send to the

856
00:39:39,890 --> 00:39:42,619
back end hey I did verify the pain so

857
00:39:42,619 --> 00:39:44,509
the back end could correlate these two

858
00:39:44,509 --> 00:39:46,849
numbers and see hey wait a minute the

859
00:39:46,849 --> 00:39:48,469
terminal says it verified the pin by the

860
00:39:48,469 --> 00:39:50,509
car did not so that's the problem so you

861
00:39:50,509 --> 00:39:52,309
can immediately know that this attack

862
00:39:52,309 --> 00:39:54,169
has been taken place and the only reason

863
00:39:54,169 --> 00:39:56,119
why this stock is being prevented is

864
00:39:56,119 --> 00:39:58,549
because most implementation they really

865
00:39:58,549 --> 00:40:00,019
suck because when you have a Stumbler

866
00:40:00,019 --> 00:40:01,849
which is published in four books which

867
00:40:01,849 --> 00:40:03,949
one hundred pages long and no standard

868
00:40:03,949 --> 00:40:05,749
needs to be as long as that if you have

869
00:40:05,749 --> 00:40:07,639
a standard which is that long it is

870
00:40:07,639 --> 00:40:09,199
broken no matter what you can just look

871
00:40:09,199 --> 00:40:10,459
at the paper you say that's broken

872
00:40:10,459 --> 00:40:12,739
because there are too many pages and and

873
00:40:12,739 --> 00:40:14,630
and what happens is that they get

874
00:40:14,630 --> 00:40:16,339
implementation wrong because this is too

875
00:40:16,339 --> 00:40:19,939
complex but if this attack is fixed

876
00:40:19,939 --> 00:40:22,639
remember the liability shift can we

877
00:40:22,639 --> 00:40:24,919
still get the pin can we still harvest

878
00:40:24,919 --> 00:40:26,539
the pin and then use a stolen card

879
00:40:26,539 --> 00:40:28,969
because that would be a massive problem

880
00:40:28,969 --> 00:40:30,859
from the final customer and remember if

881
00:40:30,859 --> 00:40:31,939
you have the pin you can go to an ATM

882
00:40:31,939 --> 00:40:36,769
and you can get cash so we talked about

883
00:40:36,769 --> 00:40:39,319
the CVM list which is published by the

884
00:40:39,319 --> 00:40:42,679
card and read by the terminal so the CDM

885
00:40:42,679 --> 00:40:45,229
list tells the terminal the way the car

886
00:40:45,229 --> 00:40:47,569
all the verification can happen so we

887
00:40:47,569 --> 00:40:50,250
have things like plain tex been very

888
00:40:50,250 --> 00:40:52,590
education and cipher peon verified

889
00:40:52,590 --> 00:40:55,080
online plain tex bean verification and

890
00:40:55,080 --> 00:40:57,270
signature web the signature or we have

891
00:40:57,270 --> 00:40:59,700
no verification at all so when you pay

892
00:40:59,700 --> 00:41:02,370
in toll roads you have no time to sign

893
00:41:02,370 --> 00:41:04,560
anything or to type up in that's when no

894
00:41:04,560 --> 00:41:07,140
CBM is being selected and this is a list

895
00:41:07,140 --> 00:41:09,750
so the car presents a list of methods to

896
00:41:09,750 --> 00:41:12,660
the terminal and the terminal can select

897
00:41:12,660 --> 00:41:14,730
them in the order of priority if the

898
00:41:14,730 --> 00:41:16,470
terminal doesn't support one for any

899
00:41:16,470 --> 00:41:17,970
reason you can skip to the next one and

900
00:41:17,970 --> 00:41:20,850
so on so if your credit card as

901
00:41:20,850 --> 00:41:22,860
signature first and then pin

902
00:41:22,860 --> 00:41:25,680
verification you will likely always have

903
00:41:25,680 --> 00:41:28,080
to sign if you have been verification

904
00:41:28,080 --> 00:41:30,510
first and then signature if the terminal

905
00:41:30,510 --> 00:41:32,360
supports it then you get pin

906
00:41:32,360 --> 00:41:34,650
verification otherwise it will skip to

907
00:41:34,650 --> 00:41:36,210
the next one and it will ask for a

908
00:41:36,210 --> 00:41:40,890
signature so this list used not to be

909
00:41:40,890 --> 00:41:46,850
signed by SDA all DDA are within the car

910
00:41:46,850 --> 00:41:51,930
now they sign it because they want this

911
00:41:51,930 --> 00:41:53,910
place to be tamper proof because they

912
00:41:53,910 --> 00:41:56,070
want you cannot mess with with this list

913
00:41:56,070 --> 00:41:59,730
so it is commonly believed that if you

914
00:41:59,730 --> 00:42:02,970
have a signature or in cipher it in

915
00:42:02,970 --> 00:42:04,860
verify online or insightful pin

916
00:42:04,860 --> 00:42:07,950
verification by acc present and selected

917
00:42:07,950 --> 00:42:10,050
then the pin is not sent by the terminal

918
00:42:10,050 --> 00:42:11,820
to the card in a clear text or not sent

919
00:42:11,820 --> 00:42:14,490
to the car at all and it believes that

920
00:42:14,490 --> 00:42:15,810
only when you have plain text mean

921
00:42:15,810 --> 00:42:18,240
verification present and selected from

922
00:42:18,240 --> 00:42:20,400
the cv emily's then you can harvest the

923
00:42:20,400 --> 00:42:23,070
pin okay so this is some kind of

924
00:42:23,070 --> 00:42:26,610
protection they built they built in so I

925
00:42:26,610 --> 00:42:28,770
assume a scenario where we only have DDA

926
00:42:28,770 --> 00:42:31,050
cars so the modern one is actually a

927
00:42:31,050 --> 00:42:33,630
most modern standard which is called CDA

928
00:42:33,630 --> 00:42:35,640
which is combined that authentication

929
00:42:35,640 --> 00:42:38,610
which combines the event occasion with

930
00:42:38,610 --> 00:42:40,170
the actual cryptogram but we're never

931
00:42:40,170 --> 00:42:42,960
seeing that use with cheap cars it's

932
00:42:42,960 --> 00:42:45,690
just used with rfid card which is entire

933
00:42:45,690 --> 00:42:48,390
new chapter so assume that we have DDA

934
00:42:48,390 --> 00:42:50,280
cars we assume we have a secure CVM

935
00:42:50,280 --> 00:42:52,650
which only says in cipher peon verified

936
00:42:52,650 --> 00:42:54,930
online or in ciphering being verified by

937
00:42:54,930 --> 00:42:57,720
the card can we stop harvester plane so

938
00:42:57,720 --> 00:42:59,580
there's a piece of information called

939
00:42:59,580 --> 00:43:01,070
each action coats on

940
00:43:01,070 --> 00:43:03,830
car and these are core the issuer action

941
00:43:03,830 --> 00:43:06,380
codes which are paired with the terminal

942
00:43:06,380 --> 00:43:07,940
action codes which is a similar

943
00:43:07,940 --> 00:43:09,620
attribute which is present on the

944
00:43:09,620 --> 00:43:11,960
terminal so what these attributes do

945
00:43:11,960 --> 00:43:14,200
they specify which failure condition

946
00:43:14,200 --> 00:43:18,080
trigger online transactions so to give

947
00:43:18,080 --> 00:43:20,870
you one example this one example of

948
00:43:20,870 --> 00:43:23,380
issuer action codes president visa cards

949
00:43:23,380 --> 00:43:26,960
these action codes here say do not deny

950
00:43:26,960 --> 00:43:29,120
a transaction without attempting to go

951
00:43:29,120 --> 00:43:33,740
online if offline SDA fails transmitted

952
00:43:33,740 --> 00:43:36,740
rose action online so you have one piece

953
00:43:36,740 --> 00:43:40,090
of data on the card which is signed

954
00:43:40,090 --> 00:43:42,890
which can tell the terminal what to do

955
00:43:42,890 --> 00:43:45,920
if the signature verification fails and

956
00:43:45,920 --> 00:43:48,980
the terminal will honor that so this

957
00:43:48,980 --> 00:43:51,350
this is a security problem you cannot

958
00:43:51,350 --> 00:43:54,560
have a piece of data which is sign which

959
00:43:54,560 --> 00:43:56,600
if the signature is invalidated letting

960
00:43:56,600 --> 00:43:57,980
can still turn determine our what to do

961
00:43:57,980 --> 00:44:00,920
and this is a problem because when we

962
00:44:00,920 --> 00:44:03,380
needed to in every test of terminal and

963
00:44:03,380 --> 00:44:04,760
color combination if you always

964
00:44:04,760 --> 00:44:06,680
manipulate the action code so that

965
00:44:06,680 --> 00:44:08,750
messing with the CVM list would not

966
00:44:08,750 --> 00:44:11,150
result in offline rejection which is a

967
00:44:11,150 --> 00:44:13,010
key component if you want to change the

968
00:44:13,010 --> 00:44:17,600
CVM list and the thing is that the

969
00:44:17,600 --> 00:44:19,760
modified cv emily is even if the

970
00:44:19,760 --> 00:44:22,220
signature gets invalidated is always

971
00:44:22,220 --> 00:44:24,470
honored by the terminal so no matter

972
00:44:24,470 --> 00:44:27,020
what the CVM list is no matter what the

973
00:44:27,020 --> 00:44:29,990
type of the car is you can always force

974
00:44:29,990 --> 00:44:32,360
plain tex pin verification performed by

975
00:44:32,360 --> 00:44:34,760
the card so no matter what they do on

976
00:44:34,760 --> 00:44:38,360
the card side you can always force the

977
00:44:38,360 --> 00:44:40,160
pin to be transmitted in the clear text

978
00:44:40,160 --> 00:44:42,890
to the to the card which means that you

979
00:44:42,890 --> 00:44:45,290
can always skim the pin no matter what

980
00:44:45,290 --> 00:44:47,900
so all the security features that are in

981
00:44:47,900 --> 00:44:49,370
place for protecting the pin you're

982
00:44:49,370 --> 00:44:50,750
completely useless because you can

983
00:44:50,750 --> 00:44:53,420
always perform a classic downgrade

984
00:44:53,420 --> 00:44:55,670
attack and this is one example of the

985
00:44:55,670 --> 00:44:59,510
pin being intercepted by the schemer so

986
00:44:59,510 --> 00:45:03,200
this is a transaction log of a DD a card

987
00:45:03,200 --> 00:45:06,560
with online pin verification only so we

988
00:45:06,560 --> 00:45:08,540
see that we select the visa application

989
00:45:08,540 --> 00:45:11,750
we read the data files here and then we

990
00:45:11,750 --> 00:45:12,849
generate the quick

991
00:45:12,849 --> 00:45:15,069
which this is the actual part where the

992
00:45:15,069 --> 00:45:18,700
transaction goes online if we change the

993
00:45:18,700 --> 00:45:20,680
CVM list and the action codes in this

994
00:45:20,680 --> 00:45:23,349
case we get exactly the same thing but

995
00:45:23,349 --> 00:45:26,589
at some point we witness the pin the pin

996
00:45:26,589 --> 00:45:29,430
verification so we see that the pin 1234

997
00:45:29,430 --> 00:45:34,299
was actually been sniffed here by the

998
00:45:34,299 --> 00:45:36,339
skimmer and then we have the online

999
00:45:36,339 --> 00:45:38,349
transaction with the same car with our

1000
00:45:38,349 --> 00:45:39,579
skimmer just performing a

1001
00:45:39,579 --> 00:45:43,479
man-in-the-middle attack which means

1002
00:45:43,479 --> 00:45:46,509
that your schema can nicely get all the

1003
00:45:46,509 --> 00:45:47,950
public information that we discussed

1004
00:45:47,950 --> 00:45:50,200
before and the pin number there's no

1005
00:45:50,200 --> 00:45:52,210
camera being involved is no manual

1006
00:45:52,210 --> 00:45:54,309
correlation that you need to do you hook

1007
00:45:54,309 --> 00:45:56,259
up the skimmer and at the end of the day

1008
00:45:56,259 --> 00:45:57,640
or at the end of the week you go there

1009
00:45:57,640 --> 00:45:59,140
with your special car and you get a

1010
00:45:59,140 --> 00:46:01,029
nicely formatted file which gives you

1011
00:46:01,029 --> 00:46:03,279
name number expiration date or yet

1012
00:46:03,279 --> 00:46:05,200
information and the pin number with a

1013
00:46:05,200 --> 00:46:08,109
hundred percent accuracy um and this

1014
00:46:08,109 --> 00:46:09,579
little at the back end can do two

1015
00:46:09,579 --> 00:46:11,140
detectives because what they will detect

1016
00:46:11,140 --> 00:46:13,259
it is that the SDA fail which can happen

1017
00:46:13,259 --> 00:46:17,829
for several reasons to be honest and we

1018
00:46:17,829 --> 00:46:19,960
don't think it's a realistic scenario to

1019
00:46:19,960 --> 00:46:22,479
just block a car because SDA failed and

1020
00:46:22,479 --> 00:46:26,589
anyway as the CDM result which is a

1021
00:46:26,589 --> 00:46:28,210
piece of information which is sent to

1022
00:46:28,210 --> 00:46:31,599
the back into to to let the backend know

1023
00:46:31,599 --> 00:46:34,180
what cut all the verification method has

1024
00:46:34,180 --> 00:46:36,430
been performed it only includes the last

1025
00:46:36,430 --> 00:46:38,200
car all the verification method being

1026
00:46:38,200 --> 00:46:41,019
fine so one of the options that you can

1027
00:46:41,019 --> 00:46:45,729
do you can get the pin you can relay the

1028
00:46:45,729 --> 00:46:48,549
wrong pin back to the car and then you

1029
00:46:48,549 --> 00:46:51,160
can present in your CDN list online pin

1030
00:46:51,160 --> 00:46:53,950
verification and in the CVM result that

1031
00:46:53,950 --> 00:46:56,289
the backends will see that we only see

1032
00:46:56,289 --> 00:46:58,660
the last CDM which has been fine which

1033
00:46:58,660 --> 00:47:00,309
is online peanut verification it means

1034
00:47:00,309 --> 00:47:01,719
that of course you get pumped it twice

1035
00:47:01,719 --> 00:47:03,579
for the pin but you just might think

1036
00:47:03,579 --> 00:47:05,440
that you will just pop it in incorrectly

1037
00:47:05,440 --> 00:47:08,410
so several ways that you can you can do

1038
00:47:08,410 --> 00:47:10,059
for actually avoiding back in detection

1039
00:47:10,059 --> 00:47:15,160
um there's also there's also one other

1040
00:47:15,160 --> 00:47:17,859
option which we didn't test because we

1041
00:47:17,859 --> 00:47:20,140
didn't have time it might also be

1042
00:47:20,140 --> 00:47:22,630
possible to exploit the fact that the

1043
00:47:22,630 --> 00:47:24,849
actual offline that authentication is

1044
00:47:24,849 --> 00:47:25,690
not really

1045
00:47:25,690 --> 00:47:28,060
in a very strong way to the actual

1046
00:47:28,060 --> 00:47:30,640
pre-program generation or it is tied in

1047
00:47:30,640 --> 00:47:32,650
ways that can be manipulated so you

1048
00:47:32,650 --> 00:47:35,290
might be possible to to present a valid

1049
00:47:35,290 --> 00:47:38,050
SDA cards for the actual offline

1050
00:47:38,050 --> 00:47:39,370
authentication and for the

1051
00:47:39,370 --> 00:47:41,560
authentication phase with the CD emily's

1052
00:47:41,560 --> 00:47:43,750
and then use a real car for the actual

1053
00:47:43,750 --> 00:47:46,180
transaction which means that the back

1054
00:47:46,180 --> 00:47:47,980
and we see everything being done

1055
00:47:47,980 --> 00:47:52,480
correctly um so CDA which is combined

1056
00:47:52,480 --> 00:47:54,700
that authentication it was designed to

1057
00:47:54,700 --> 00:47:56,800
prevent against similar attacks but the

1058
00:47:56,800 --> 00:47:58,990
problem is that you can always force you

1059
00:47:58,990 --> 00:48:01,270
can always prevent the CDA you relevant

1060
00:48:01,270 --> 00:48:03,820
attributes to be seen from the terminal

1061
00:48:03,820 --> 00:48:06,490
and you can always downgrade a CD a car

1062
00:48:06,490 --> 00:48:08,980
to DD arrow to SDA so you can always do

1063
00:48:08,980 --> 00:48:11,860
on these kind of tricks and of course

1064
00:48:11,860 --> 00:48:14,500
you will see so they did they did SDA

1065
00:48:14,500 --> 00:48:17,050
and it wasn't good enough so then they

1066
00:48:17,050 --> 00:48:18,880
did DBA and it wasn't still good enough

1067
00:48:18,880 --> 00:48:21,130
and then they did CDA you can see there

1068
00:48:21,130 --> 00:48:24,720
is a trend of mistakes being made or

1069
00:48:24,720 --> 00:48:28,030
actually very bad design and and of

1070
00:48:28,030 --> 00:48:29,980
course hatching these things it's not

1071
00:48:29,980 --> 00:48:33,400
easy for the industry so this protocol

1072
00:48:33,400 --> 00:48:36,580
is really not properly designed and

1073
00:48:36,580 --> 00:48:37,930
that's why we think it should be really

1074
00:48:37,930 --> 00:48:39,820
give a place which of course you will

1075
00:48:39,820 --> 00:48:42,310
never happen so we think that the EMV

1076
00:48:42,310 --> 00:48:44,260
schema really possess a serious fright

1077
00:48:44,260 --> 00:48:45,910
due to the ease installation and

1078
00:48:45,910 --> 00:48:48,190
difficult detection you can still

1079
00:48:48,190 --> 00:48:51,700
nowadays in 2011 use the data that your

1080
00:48:51,700 --> 00:48:54,070
scheme are for attempt to do a

1081
00:48:54,070 --> 00:48:57,220
mascarpone or choosing on online website

1082
00:48:57,220 --> 00:48:59,380
as I've been you know a victim of that

1083
00:48:59,380 --> 00:49:01,750
so that really happens and most

1084
00:49:01,750 --> 00:49:04,510
important this magic number that really

1085
00:49:04,510 --> 00:49:06,970
in in many countries shifts the

1086
00:49:06,970 --> 00:49:10,600
liability on to you remember $80,000 of

1087
00:49:10,600 --> 00:49:13,720
fraud being being claimed and being

1088
00:49:13,720 --> 00:49:16,420
debated in court the pin can always be

1089
00:49:16,420 --> 00:49:19,180
intercepted always despite the car type

1090
00:49:19,180 --> 00:49:22,090
and despite the configuration that's

1091
00:49:22,090 --> 00:49:24,520
present on the car and this enables full

1092
00:49:24,520 --> 00:49:26,560
usage if you sell a car and raises

1093
00:49:26,560 --> 00:49:30,370
serious liability considerations um we

1094
00:49:30,370 --> 00:49:32,110
got then response which of course was

1095
00:49:32,110 --> 00:49:34,420
useless they say well the full payment

1096
00:49:34,420 --> 00:49:35,860
process take into account suitable

1097
00:49:35,860 --> 00:49:37,160
compromise yourself

1098
00:49:37,160 --> 00:49:39,900
mastercard spokesman response was very

1099
00:49:39,900 --> 00:49:42,030
nice it said in an interview that the

1100
00:49:42,030 --> 00:49:44,130
EMV system is simply too complex for an

1101
00:49:44,130 --> 00:49:47,610
easy fix which first of all is not true

1102
00:49:47,610 --> 00:49:49,920
and second of all if you really think

1103
00:49:49,920 --> 00:49:51,990
that it means you gotta replace piece

1104
00:49:51,990 --> 00:49:54,840
right away because if your system is so

1105
00:49:54,840 --> 00:49:56,850
complex that you cannot hatch it for

1106
00:49:56,850 --> 00:49:59,460
security reasons you're doomed what if

1107
00:49:59,460 --> 00:50:01,560
we find a new linearity which is even

1108
00:50:01,560 --> 00:50:04,080
more serious than this one okay what

1109
00:50:04,080 --> 00:50:05,490
what are you going to do are you going

1110
00:50:05,490 --> 00:50:06,720
to tell me that the system is to

1111
00:50:06,720 --> 00:50:08,550
complies that you cannot catch it it is

1112
00:50:08,550 --> 00:50:11,400
a basic property of every system and you

1113
00:50:11,400 --> 00:50:12,960
should be able to patch it in case of

1114
00:50:12,960 --> 00:50:15,690
security problem so you know that really

1115
00:50:15,690 --> 00:50:18,450
was a bad response and actually again it

1116
00:50:18,450 --> 00:50:20,010
can be fixed of course you pray

1117
00:50:20,010 --> 00:50:22,050
compatibility with a standard so we got

1118
00:50:22,050 --> 00:50:23,490
to change the starter in order to fix

1119
00:50:23,490 --> 00:50:27,210
this but in the Netherlands the whole

1120
00:50:27,210 --> 00:50:28,770
has been reportedly closed by updating

1121
00:50:28,770 --> 00:50:32,010
on POS firmer with a version with

1122
00:50:32,010 --> 00:50:34,500
disables plain text in verification for

1123
00:50:34,500 --> 00:50:36,210
domestic cards because in the

1124
00:50:36,210 --> 00:50:38,280
Netherlands they know that every single

1125
00:50:38,280 --> 00:50:41,340
card is DDA issued in the country so

1126
00:50:41,340 --> 00:50:43,980
what did he decide okay when we see that

1127
00:50:43,980 --> 00:50:46,980
a card comes from our country we disable

1128
00:50:46,980 --> 00:50:50,400
our plain tex bean verification now i'm

1129
00:50:50,400 --> 00:50:52,619
not saying that they really fix the

1130
00:50:52,619 --> 00:50:55,920
problem we didn't test this but we don't

1131
00:50:55,920 --> 00:50:57,330
think that every terminal in the

1132
00:50:57,330 --> 00:50:59,609
Netherlands has every single critical

1133
00:50:59,609 --> 00:51:01,740
number that was issued in the

1134
00:51:01,740 --> 00:51:04,140
Netherlands we think that they check the

1135
00:51:04,140 --> 00:51:05,970
country code and the country code is not

1136
00:51:05,970 --> 00:51:08,550
signed so maybe if you change the

1137
00:51:08,550 --> 00:51:11,430
country code you disable this so you

1138
00:51:11,430 --> 00:51:12,990
know you haven't careful but anyway so

1139
00:51:12,990 --> 00:51:15,300
they this was you know after hacking

1140
00:51:15,300 --> 00:51:17,280
about Sam source am I right to write

1141
00:51:17,280 --> 00:51:19,200
before so they felt threatened by the

1142
00:51:19,200 --> 00:51:21,450
fact that this previous presentation was

1143
00:51:21,450 --> 00:51:23,250
being performed so they shut down every

1144
00:51:23,250 --> 00:51:24,750
single pui seng the country for four

1145
00:51:24,750 --> 00:51:27,420
hours people were very pissed because of

1146
00:51:27,420 --> 00:51:30,600
this but they fix it so it can be done

1147
00:51:30,600 --> 00:51:34,650
of course you can be done so we still

1148
00:51:34,650 --> 00:51:37,080
think that this standard should be you

1149
00:51:37,080 --> 00:51:39,060
know replace if possible by will never

1150
00:51:39,060 --> 00:51:41,400
happen you know what should really be

1151
00:51:41,400 --> 00:51:43,290
happening you should have bubble crypto

1152
00:51:43,290 --> 00:51:45,690
because you can with a smart girl being

1153
00:51:45,690 --> 00:51:48,690
implemented by the car to the back end

1154
00:51:48,690 --> 00:51:49,170
you know

1155
00:51:49,170 --> 00:51:51,270
so even if you don't trust the terminal

1156
00:51:51,270 --> 00:51:53,190
it doesn't matter so because no

1157
00:51:53,190 --> 00:51:54,660
information is sent in clear and this

1158
00:51:54,660 --> 00:51:56,609
can be done the terminals cannot be

1159
00:51:56,609 --> 00:51:59,369
trusted the pin input and verification

1160
00:51:59,369 --> 00:52:01,020
so the other can find on the car itself

1161
00:52:01,020 --> 00:52:04,349
which latest NFC technology you know

1162
00:52:04,349 --> 00:52:06,510
where you actually put a pin on the

1163
00:52:06,510 --> 00:52:07,920
phone they're moving into the right

1164
00:52:07,920 --> 00:52:09,750
direction I have to say of course it is

1165
00:52:09,750 --> 00:52:11,520
scary to have your PIN verification on a

1166
00:52:11,520 --> 00:52:14,819
phone which runs millions of different

1167
00:52:14,819 --> 00:52:17,940
applications but you know conceptually

1168
00:52:17,940 --> 00:52:20,069
it might be a good way to approach this

1169
00:52:20,069 --> 00:52:22,589
problem and terminals cannot be trusted

1170
00:52:22,589 --> 00:52:24,500
i mean remember this first terminal that

1171
00:52:24,500 --> 00:52:27,480
that we show you looks fine right you

1172
00:52:27,480 --> 00:52:29,520
know no problem with that but then you

1173
00:52:29,520 --> 00:52:31,500
have a pink but skin underneath because

1174
00:52:31,500 --> 00:52:33,240
it what you can do you can lift off this

1175
00:52:33,240 --> 00:52:36,359
thing in half a second in half a second

1176
00:52:36,359 --> 00:52:39,000
that thing's pops off you put your thing

1177
00:52:39,000 --> 00:52:40,980
you put it back and you're done two

1178
00:52:40,980 --> 00:52:43,260
seconds it really what is taken we have

1179
00:52:43,260 --> 00:52:44,760
this board without two switches that

1180
00:52:44,760 --> 00:52:47,010
actually is very thin as well could be

1181
00:52:47,010 --> 00:52:50,280
thinner that actually can relay the pin

1182
00:52:50,280 --> 00:52:52,020
information back to you so you know even

1183
00:52:52,020 --> 00:52:54,329
if we do these elegant EMV protocol

1184
00:52:54,329 --> 00:52:56,280
downgrading attacks you can never trust

1185
00:52:56,280 --> 00:52:59,910
your terminal never ever on and so

1186
00:52:59,910 --> 00:53:01,740
recommendation of course you can patch

1187
00:53:01,740 --> 00:53:03,420
EMV just disable plaint that's being

1188
00:53:03,420 --> 00:53:06,089
verification you know and always do

1189
00:53:06,089 --> 00:53:07,799
things online it doesn't matter if you

1190
00:53:07,799 --> 00:53:09,780
only have SDA cards we actually spoke to

1191
00:53:09,780 --> 00:53:12,150
the banks and when we explained to them

1192
00:53:12,150 --> 00:53:15,059
out EMV words they were like well we

1193
00:53:15,059 --> 00:53:16,559
don't need all of these offline stuff

1194
00:53:16,559 --> 00:53:17,790
because we have an online infrastructure

1195
00:53:17,790 --> 00:53:20,849
which is good enough anyway so this this

1196
00:53:20,849 --> 00:53:22,890
technology which is being pushed for

1197
00:53:22,890 --> 00:53:25,170
enabling offline transaction is actually

1198
00:53:25,170 --> 00:53:27,900
not that valuable to most banks in fact

1199
00:53:27,900 --> 00:53:30,900
in the US they're moving to mva right

1200
00:53:30,900 --> 00:53:34,109
now because they have to because we want

1201
00:53:34,109 --> 00:53:35,790
again everyone to move away from mag

1202
00:53:35,790 --> 00:53:39,000
stripe in order to 24 implement EMV for

1203
00:53:39,000 --> 00:53:41,849
saving cause they want avoid doing all

1204
00:53:41,849 --> 00:53:43,710
your flying few more things and they

1205
00:53:43,710 --> 00:53:44,970
want to do everything online because

1206
00:53:44,970 --> 00:53:46,140
they know they always have good

1207
00:53:46,140 --> 00:53:49,440
connectivity so it this is one of these

1208
00:53:49,440 --> 00:53:51,510
scenarios where in order to save cost

1209
00:53:51,510 --> 00:53:53,160
you actually increase the security of

1210
00:53:53,160 --> 00:53:55,530
your system which is good because if you

1211
00:53:55,530 --> 00:53:57,869
only implement the online part the pin

1212
00:53:57,869 --> 00:53:59,670
will never be transmitted to your car

1213
00:53:59,670 --> 00:54:01,450
you will never need all

1214
00:54:01,450 --> 00:54:03,579
you know you will only use the cheap for

1215
00:54:03,579 --> 00:54:05,560
the cryptogram generation which is

1216
00:54:05,560 --> 00:54:08,050
exactly what he's supposed to do so you

1217
00:54:08,050 --> 00:54:09,400
know I could do everything my line and

1218
00:54:09,400 --> 00:54:11,530
just be happy with it instead of making

1219
00:54:11,530 --> 00:54:14,950
things more complex so and scary thing

1220
00:54:14,950 --> 00:54:18,760
are after we did our first presentation

1221
00:54:18,760 --> 00:54:21,190
of this kind we have reports that

1222
00:54:21,190 --> 00:54:24,910
skimmers dated 2008 so before our

1223
00:54:24,910 --> 00:54:26,530
presentation so we're not responsible

1224
00:54:26,530 --> 00:54:28,690
for this which is good and being

1225
00:54:28,690 --> 00:54:30,550
reported in the wild by law enforcement

1226
00:54:30,550 --> 00:54:32,589
after yeah this presentation was made

1227
00:54:32,589 --> 00:54:34,210
available so let me show you what they

1228
00:54:34,210 --> 00:54:37,320
did because it's actually interesting

1229
00:54:37,320 --> 00:54:41,920
this is a for me now criminally you know

1230
00:54:41,920 --> 00:54:45,490
built ships skimmer are very you know

1231
00:54:45,490 --> 00:54:46,839
much more professionally made an

1232
00:54:46,839 --> 00:54:49,060
excellent better than our quote this is

1233
00:54:49,060 --> 00:54:51,490
actually an antenna here which can be

1234
00:54:51,490 --> 00:54:53,859
used to relay the information over

1235
00:54:53,859 --> 00:54:56,710
wireless it has a serial number on it

1236
00:54:56,710 --> 00:54:59,470
which is really scary so they need more

1237
00:54:59,470 --> 00:55:01,359
by one and if you remember the enclosure

1238
00:55:01,359 --> 00:55:04,420
of the first of the first point of sale

1239
00:55:04,420 --> 00:55:07,569
here it is so what they did they pull up

1240
00:55:07,569 --> 00:55:10,750
the actual entire ship's log and they

1241
00:55:10,750 --> 00:55:12,640
have replaced it with something that has

1242
00:55:12,640 --> 00:55:16,300
this thing inside you know and we think

1243
00:55:16,300 --> 00:55:17,950
that we're using this back in the days

1244
00:55:17,950 --> 00:55:20,230
where we're actually you could just

1245
00:55:20,230 --> 00:55:22,300
point max right by the way we don't

1246
00:55:22,300 --> 00:55:24,040
think there were so elaborate you

1247
00:55:24,040 --> 00:55:29,849
actually skin the pin but that's only a

1248
00:55:29,849 --> 00:55:33,609
software the issue you know the hard

1249
00:55:33,609 --> 00:55:35,500
work is going to be exactly the same so

1250
00:55:35,500 --> 00:55:38,050
people are already doing this in the

1251
00:55:38,050 --> 00:55:40,060
wild and it is very important to know

1252
00:55:40,060 --> 00:55:42,700
how you can leverage your attack by this

1253
00:55:42,700 --> 00:55:45,579
technology so well thank you very much

1254
00:55:45,579 --> 00:55:46,630
for your attention if you have any

1255
00:55:46,630 --> 00:55:50,200
questions we other thing not zero

1256
00:55:50,200 --> 00:55:52,240
minutes how does it work well let's just

1257
00:55:52,240 --> 00:55:56,530
do one question okay I'm anybody or I'm

1258
00:55:56,530 --> 00:55:58,990
sure they would prefer to us you during

1259
00:55:58,990 --> 00:56:01,390
break in person ya in person okay and

1260
00:56:01,390 --> 00:56:03,040
also if you want to see the devices come

1261
00:56:03,040 --> 00:56:04,420
to us thank you very much for your time

1262
00:56:04,420 --> 00:56:06,770
I hope you enjoyed it included Danielle

1263
00:56:06,770 --> 00:56:10,010
you very much thank you also for your

1264
00:56:10,010 --> 00:56:13,930
oscar-winning movie yes

