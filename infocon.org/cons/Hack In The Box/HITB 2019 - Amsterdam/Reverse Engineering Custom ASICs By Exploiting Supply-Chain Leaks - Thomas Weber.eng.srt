1
00:00:19,470 --> 00:00:26,529
hello thank you for coming my talk is

2
00:00:24,099 --> 00:00:29,560
about reverse engineering custom Isaac's

3
00:00:26,529 --> 00:00:38,830
by exploiting potential supply chain

4
00:00:29,560 --> 00:00:41,410
leaks so Who am I

5
00:00:38,830 --> 00:00:44,530
my name is Thomas I am working for

6
00:00:41,410 --> 00:00:48,069
second salt in wayna it's my employer

7
00:00:44,530 --> 00:00:51,190
since 2015 and yeah we have offices

8
00:00:48,070 --> 00:00:58,180
around the world and are quite present

9
00:00:51,190 --> 00:00:59,080
all over Europe short outline what I'm

10
00:00:58,180 --> 00:01:01,989
talking about

11
00:00:59,080 --> 00:01:04,530
today I want to give you an introduction

12
00:01:01,989 --> 00:01:07,600
so what is an ASIC what's what are

13
00:01:04,530 --> 00:01:12,100
embedded systems which are built around

14
00:01:07,600 --> 00:01:15,509
this this application specific

15
00:01:12,100 --> 00:01:18,658
integrated circuits also the dangers of

16
00:01:15,510 --> 00:01:22,750
supply chains how you can lose some

17
00:01:18,659 --> 00:01:27,460
intellectual property and what are the

18
00:01:22,750 --> 00:01:29,560
points which are critical how to do

19
00:01:27,460 --> 00:01:31,660
reverse engineering without having an

20
00:01:29,560 --> 00:01:34,720
scanning electron microscope or a

21
00:01:31,660 --> 00:01:37,030
focused ion beam station because I guess

22
00:01:34,720 --> 00:01:42,610
most of you don't have access to such

23
00:01:37,030 --> 00:01:47,080
devices pretty expensive and yeah some

24
00:01:42,610 --> 00:01:49,710
demo some live debugging some printing

25
00:01:47,080 --> 00:01:51,670
out of device which has an

26
00:01:49,710 --> 00:01:54,130
application-specific integrated circuit

27
00:01:51,670 --> 00:01:56,620
which is completely undocumented and

28
00:01:54,130 --> 00:01:58,960
where your thumbs get any documentation

29
00:01:56,620 --> 00:02:02,380
on the internet or get any glue from the

30
00:01:58,960 --> 00:02:07,059
window because it's not labeled with any

31
00:02:02,380 --> 00:02:09,609
window and yeah a small fun fact at the

32
00:02:07,060 --> 00:02:14,049
end of the presentation so what is an

33
00:02:09,610 --> 00:02:17,560
ASIC who cares and where it is used so

34
00:02:14,049 --> 00:02:20,470
Asics are basically every chips which

35
00:02:17,560 --> 00:02:23,920
are in your mobile phone which are in

36
00:02:20,470 --> 00:02:28,829
your laptop PC in your IP camera and so

37
00:02:23,920 --> 00:02:32,179
on it's it's just liberation of

38
00:02:28,829 --> 00:02:34,760
application-specific integrated circuit

39
00:02:32,180 --> 00:02:37,040
and it can be that it can come in every

40
00:02:34,760 --> 00:02:40,489
shape so it can be a system-on-chip it

41
00:02:37,040 --> 00:02:43,370
can be a single CPU it can be a dynamic

42
00:02:40,489 --> 00:02:46,189
Ram it can be an end memory and and so

43
00:02:43,370 --> 00:02:51,170
on everywhere where you have logic

44
00:02:46,189 --> 00:02:55,819
inside and yeah when doors around the

45
00:02:51,170 --> 00:02:58,969
world there are numerous produce Asics

46
00:02:55,819 --> 00:03:01,909
and use them for different applications

47
00:02:58,969 --> 00:03:04,400
so for radio frequency for custom

48
00:03:01,909 --> 00:03:06,950
instruction sets and so on so there are

49
00:03:04,400 --> 00:03:11,209
many many many many many types of Asics

50
00:03:06,950 --> 00:03:13,608
around the world and yeah where it is

51
00:03:11,209 --> 00:03:16,340
used and you just look in your pocket

52
00:03:13,609 --> 00:03:19,329
you have your mobile phone and there are

53
00:03:16,340 --> 00:03:21,739
the Asics inside and many of them are

54
00:03:19,329 --> 00:03:23,900
commercial off-the-shelf Asics so where

55
00:03:21,739 --> 00:03:25,819
you get documentation and it just google

56
00:03:23,900 --> 00:03:29,299
the label which is printed on the

57
00:03:25,819 --> 00:03:32,899
package but there are also some chips

58
00:03:29,299 --> 00:03:37,849
without any documentation so don't find

59
00:03:32,900 --> 00:03:40,909
anything on the internet about it it

60
00:03:37,849 --> 00:03:42,888
gets hard when it's a complete custom

61
00:03:40,909 --> 00:03:46,340
solution so when it's for example a

62
00:03:42,889 --> 00:03:49,729
system on chip which which which is

63
00:03:46,340 --> 00:03:53,859
produced by some third party vendor for

64
00:03:49,729 --> 00:03:57,650
one vendor who wants to produce custom

65
00:03:53,859 --> 00:03:59,750
system on chip and yeah most of the time

66
00:03:57,650 --> 00:04:02,810
there is not even a label printed on it

67
00:03:59,750 --> 00:04:05,150
and yeah the architectures unknown the

68
00:04:02,810 --> 00:04:07,959
pinna of this unknown everything is

69
00:04:05,150 --> 00:04:12,769
unknown so no we don't have a datasheet

70
00:04:07,959 --> 00:04:16,370
I was curious about the programmable

71
00:04:12,769 --> 00:04:19,579
logic devices the PLC's in this case

72
00:04:16,370 --> 00:04:24,710
from Siemens because yeah they have a

73
00:04:19,579 --> 00:04:28,099
lot of them and yeah I just removed the

74
00:04:24,710 --> 00:04:30,650
housing and looked into the these PLC's

75
00:04:28,099 --> 00:04:35,000
because they are computers basically

76
00:04:30,650 --> 00:04:38,539
like everything and they have custom

77
00:04:35,000 --> 00:04:41,240
system-on-chip solutions inside they are

78
00:04:38,539 --> 00:04:45,320
appearances which are completely unknown

79
00:04:41,240 --> 00:04:50,270
so you don't find a datasheet when you

80
00:04:45,320 --> 00:04:53,390
search for both of them so yeah that was

81
00:04:50,270 --> 00:04:56,299
the challenge can I identify some debug

82
00:04:53,390 --> 00:04:59,960
port or anything else so it expands if

83
00:04:56,300 --> 00:05:05,420
option would be decapping looking into

84
00:04:59,960 --> 00:05:09,200
the the yeah 10 20 30 nanometer

85
00:05:05,420 --> 00:05:10,970
structures and making pictures and doing

86
00:05:09,200 --> 00:05:14,510
reverse engineering of that so for that

87
00:05:10,970 --> 00:05:17,150
you need electron microscopes focused

88
00:05:14,510 --> 00:05:20,719
ion beam stations and so on and a lot of

89
00:05:17,150 --> 00:05:24,830
time so no I don't have a lot of money

90
00:05:20,720 --> 00:05:28,010
and a lot of time so I use the cheap

91
00:05:24,830 --> 00:05:31,130
option just buying a lot of PC piece

92
00:05:28,010 --> 00:05:33,890
which you can find on the internet which

93
00:05:31,130 --> 00:05:37,940
have ease system on the same system on

94
00:05:33,890 --> 00:05:41,120
chips which are on the PLC's and start

95
00:05:37,940 --> 00:05:42,950
to reverse-engineer because you can you

96
00:05:41,120 --> 00:05:46,520
can buy a lot of PLC's but it's

97
00:05:42,950 --> 00:05:51,860
expensive to 260 bucks something like

98
00:05:46,520 --> 00:05:54,740
that and yeah so I just hunted for such

99
00:05:51,860 --> 00:05:59,450
PC piece on top all and Aliexpress and

100
00:05:54,740 --> 00:06:05,120
so on yeah so that was good news for our

101
00:05:59,450 --> 00:06:11,090
CFO because it was cheap and he was

102
00:06:05,120 --> 00:06:13,220
happy so what are the dangers of losing

103
00:06:11,090 --> 00:06:17,419
intellectual property when you want to

104
00:06:13,220 --> 00:06:20,480
produce PCPs with custom system-on-chip

105
00:06:17,420 --> 00:06:24,220
solutions then you have to give your

106
00:06:20,480 --> 00:06:27,290
blueprint to a third party vendor or

107
00:06:24,220 --> 00:06:31,070
whatever manufacturer and when you are

108
00:06:27,290 --> 00:06:36,050
the IP owner the orange circle on the

109
00:06:31,070 --> 00:06:38,210
right then you wants to get ya millions

110
00:06:36,050 --> 00:06:41,390
thousands of pcps with the

111
00:06:38,210 --> 00:06:43,880
system-on-chip solutions and give it to

112
00:06:41,390 --> 00:06:46,219
a manufacturer this manufacturer says ok

113
00:06:43,880 --> 00:06:49,820
I can't buy all the other parts

114
00:06:46,220 --> 00:06:52,910
capacitors resistors and so on from from

115
00:06:49,820 --> 00:06:56,400
other vendors from fertile windows but

116
00:06:52,910 --> 00:06:59,580
the system-on-chip solution has to be

117
00:06:56,400 --> 00:07:03,719
has to be created by some specialized

118
00:06:59,580 --> 00:07:07,680
chips EPS so they get the blueprint from

119
00:07:03,720 --> 00:07:12,240
this manufacturer and yeah you see the

120
00:07:07,680 --> 00:07:15,150
two red circles these two parties have

121
00:07:12,240 --> 00:07:18,540
your blueprints so when something is

122
00:07:15,150 --> 00:07:23,340
leaked because of rechecked and lands on

123
00:07:18,540 --> 00:07:27,300
eBay or from a waste site or Alibaba

124
00:07:23,340 --> 00:07:30,810
Papa whatever then your intellectual

125
00:07:27,300 --> 00:07:36,139
property can get exposed to people like

126
00:07:30,810 --> 00:07:39,990
me and yeah the other possibility is

127
00:07:36,139 --> 00:07:42,479
after market issues when you you are the

128
00:07:39,990 --> 00:07:45,990
window and have a contract to some

129
00:07:42,479 --> 00:07:50,159
customer where provides devices and some

130
00:07:45,990 --> 00:07:55,500
devices yeah I just got just old and

131
00:07:50,160 --> 00:07:59,010
they get yes also to the e-waste site or

132
00:07:55,500 --> 00:08:02,370
land on some ecommerce ecommerce website

133
00:07:59,010 --> 00:08:06,719
then yeah it's the same issue because

134
00:08:02,370 --> 00:08:09,840
the PCP gets exposed to hackers and to

135
00:08:06,720 --> 00:08:15,930
researchers and yeah that was in this

136
00:08:09,840 --> 00:08:19,549
case the cheap option because yeah I was

137
00:08:15,930 --> 00:08:21,990
informed before giving this talk that

138
00:08:19,550 --> 00:08:24,410
it's not a supply chain League but I

139
00:08:21,990 --> 00:08:28,080
will say that later

140
00:08:24,410 --> 00:08:31,219
yeah I stopped it with material chasing

141
00:08:28,080 --> 00:08:34,500
and landed on top ah with the same trip

142
00:08:31,219 --> 00:08:39,450
some weird ports so these PC peace are

143
00:08:34,500 --> 00:08:42,809
not part of the usual PLC's and yeah

144
00:08:39,450 --> 00:08:45,900
they were from a shinto may you maybe

145
00:08:42,809 --> 00:08:47,910
know the city and flew around the world

146
00:08:45,900 --> 00:08:51,839
because my colleagues from Singapore

147
00:08:47,910 --> 00:08:54,540
just forwarded this to me and yeah it

148
00:08:51,839 --> 00:08:59,070
was a weird story but it had a long

149
00:08:54,540 --> 00:09:02,370
travel and then it landed in the hot web

150
00:08:59,070 --> 00:09:05,900
app in Vienna and you see the the boards

151
00:09:02,370 --> 00:09:10,150
had different quality so some of them

152
00:09:05,900 --> 00:09:14,709
a little bit yeah better than others but

153
00:09:10,150 --> 00:09:18,079
yeah one of them worked actually and

154
00:09:14,710 --> 00:09:20,570
yeah it's the same for the second type

155
00:09:18,080 --> 00:09:23,630
of system on chip which I investigated

156
00:09:20,570 --> 00:09:28,040
during my research was was the newer one

157
00:09:23,630 --> 00:09:31,270
and yeah I found them on the same side

158
00:09:28,040 --> 00:09:37,579
the same seller but I got a better prize

159
00:09:31,270 --> 00:09:40,400
you see just 11 euro and yeah it they

160
00:09:37,580 --> 00:09:45,110
looked the same so the same good or bad

161
00:09:40,400 --> 00:09:47,540
quality whatever but it was not it was

162
00:09:45,110 --> 00:09:51,290
not the PCP I ordered I got a different

163
00:09:47,540 --> 00:09:54,410
one like tinder yeah

164
00:09:51,290 --> 00:09:58,069
profile pics on dating websites but

165
00:09:54,410 --> 00:10:01,280
anyway it was the same chip so okay so I

166
00:09:58,070 --> 00:10:04,880
started to investigate with the first

167
00:10:01,280 --> 00:10:06,280
batch of PC piece I get from from the

168
00:10:04,880 --> 00:10:09,530
POC

169
00:10:06,280 --> 00:10:12,199
with with the same system on chip and I

170
00:10:09,530 --> 00:10:15,860
started to investigate with which parts

171
00:10:12,200 --> 00:10:19,180
of the PCP which which system on chips I

172
00:10:15,860 --> 00:10:22,070
know so where can I find a datasheet and

173
00:10:19,180 --> 00:10:26,359
what is what so you can see on the back

174
00:10:22,070 --> 00:10:30,800
side is the dynamic Ram and also in the

175
00:10:26,360 --> 00:10:34,190
in the center is the flash memory and it

176
00:10:30,800 --> 00:10:37,060
looks pretty much the same like the

177
00:10:34,190 --> 00:10:40,100
actual PLC but it was not the same and

178
00:10:37,060 --> 00:10:43,189
you can also spot on the right picture

179
00:10:40,100 --> 00:10:46,690
in the center there's a header looks

180
00:10:43,190 --> 00:10:50,990
suspicious what can it be

181
00:10:46,690 --> 00:10:52,970
first of all I took the PCP with the

182
00:10:50,990 --> 00:10:55,580
lowest quality and removed all of the

183
00:10:52,970 --> 00:11:00,380
the parts to create some kind of

184
00:10:55,580 --> 00:11:03,590
circuitry so cymatic like so that I can

185
00:11:00,380 --> 00:11:05,450
just draw which pins are connected to

186
00:11:03,590 --> 00:11:07,640
the RAM which pins are connected to the

187
00:11:05,450 --> 00:11:11,060
power which pins are connected to the

188
00:11:07,640 --> 00:11:12,920
flash memory and so on to start reverse

189
00:11:11,060 --> 00:11:17,270
engineering of the pin out of the actual

190
00:11:12,920 --> 00:11:19,240
system on chip and the header you saw

191
00:11:17,270 --> 00:11:24,009
before is

192
00:11:19,240 --> 00:11:25,749
yeah it looked like a jtech program

193
00:11:24,009 --> 00:11:29,290
interface and program debug interface

194
00:11:25,749 --> 00:11:32,410
and in the lab in Ghana we have a custom

195
00:11:29,290 --> 00:11:34,929
solution for brute-forcing che tech

196
00:11:32,410 --> 00:11:38,290
interfaces but you can also do it with

197
00:11:34,929 --> 00:11:43,920
jtagulator our Torino jtech enum and

198
00:11:38,290 --> 00:11:48,279
yeah there are many tools and yeah after

199
00:11:43,920 --> 00:11:50,618
after connecting my device device what I

200
00:11:48,279 --> 00:11:56,769
have here you can look at it afterwards

201
00:11:50,619 --> 00:11:58,869
I got this peanut and I attached a

202
00:11:56,769 --> 00:12:03,759
debugger and was was curious because

203
00:11:58,869 --> 00:12:06,999
nothing nothing worked so I thought okay

204
00:12:03,759 --> 00:12:09,249
sometimes there are some activating

205
00:12:06,999 --> 00:12:11,139
deactivating pins when you pulled it

206
00:12:09,249 --> 00:12:14,529
high it is activated when you pulled low

207
00:12:11,139 --> 00:12:19,240
it's deactivated or vice-versa and there

208
00:12:14,529 --> 00:12:22,449
was some small resistor which which was

209
00:12:19,240 --> 00:12:25,360
next to the to the pins of the of the

210
00:12:22,449 --> 00:12:28,628
debug interface and I just tried it out

211
00:12:25,360 --> 00:12:31,779
and it worked so I got access to the

212
00:12:28,629 --> 00:12:35,079
debug interface and had all the options

213
00:12:31,779 --> 00:12:37,929
which which are the same like the

214
00:12:35,079 --> 00:12:42,008
options from a developer and yeah that

215
00:12:37,929 --> 00:12:45,459
was great but yeah it was a little bit

216
00:12:42,009 --> 00:12:50,740
bit hard to figure that out and I also

217
00:12:45,459 --> 00:12:52,628
got the chip ID of of this of the system

218
00:12:50,740 --> 00:12:56,069
on chip and when you look on the

219
00:12:52,629 --> 00:12:59,319
internet it's yeah it does not exist but

220
00:12:56,069 --> 00:13:03,128
anyway it's a complete custom solution

221
00:12:59,319 --> 00:13:07,240
and I have also a small small figure

222
00:13:03,129 --> 00:13:10,540
where you can see which part of the chip

223
00:13:07,240 --> 00:13:12,910
ID means what so what is the what is the

224
00:13:10,540 --> 00:13:15,160
part number what is the window code and

225
00:13:12,910 --> 00:13:17,529
so on and the last bit is always one so

226
00:13:15,160 --> 00:13:22,000
when you get a chip ID which has a zero

227
00:13:17,529 --> 00:13:25,490
last bit and it's maybe not right so

228
00:13:22,000 --> 00:13:27,470
yeah there are also some other

229
00:13:25,490 --> 00:13:29,780
interesting things because when you

230
00:13:27,470 --> 00:13:33,740
brute force the JTAG interface you does

231
00:13:29,780 --> 00:13:36,470
not get the resets the system reset just

232
00:13:33,740 --> 00:13:40,040
the reset of the state machine of jtech

233
00:13:36,470 --> 00:13:43,430
and yeah I was thinking about how how

234
00:13:40,040 --> 00:13:46,480
can I figure that out so that that's

235
00:13:43,430 --> 00:13:51,530
really hard because it can be anything

236
00:13:46,480 --> 00:13:54,530
the best the best guess is the pin might

237
00:13:51,530 --> 00:13:57,260
be bounced to VDD with a pull-up

238
00:13:54,530 --> 00:14:00,380
resistor or it might be bounced to

239
00:13:57,260 --> 00:14:06,410
really deal why I a transistor to switch

240
00:14:00,380 --> 00:14:09,320
it and yeah it's it's it's not always

241
00:14:06,410 --> 00:14:10,790
clear but on the second port on the

242
00:14:09,320 --> 00:14:14,090
second system-on-chip

243
00:14:10,790 --> 00:14:16,939
I figured that out and in that case it

244
00:14:14,090 --> 00:14:19,910
was switched to ground by a transistor

245
00:14:16,940 --> 00:14:23,180
so on the actual device when I remove

246
00:14:19,910 --> 00:14:25,010
this transistor on the backside it

247
00:14:23,180 --> 00:14:29,329
actually works but you can use to solve

248
00:14:25,010 --> 00:14:33,069
the system reason and yeah that's really

249
00:14:29,330 --> 00:14:36,770
funny the easy probe is just to

250
00:14:33,070 --> 00:14:39,110
short-circuit the ground that the

251
00:14:36,770 --> 00:14:42,140
suspect that reset reset pin to ground

252
00:14:39,110 --> 00:14:44,870
and when it leads up or is completely

253
00:14:42,140 --> 00:14:48,350
dark or just stopping what it is doing

254
00:14:44,870 --> 00:14:52,190
then you can be sure that's reset but

255
00:14:48,350 --> 00:14:57,380
yeah be careful that you don't kill the

256
00:14:52,190 --> 00:14:59,510
other ones for for grass engineering

257
00:14:57,380 --> 00:15:01,990
pins where you don't know the interface

258
00:14:59,510 --> 00:15:05,630
because there is no attached a memory or

259
00:15:01,990 --> 00:15:07,550
or other system on chip it's a little

260
00:15:05,630 --> 00:15:09,590
bit hard because you cannot be sure is

261
00:15:07,550 --> 00:15:12,170
it an input is it an output is it an

262
00:15:09,590 --> 00:15:15,110
input and output or what it is what it

263
00:15:12,170 --> 00:15:19,310
is doing so when you imagine on the left

264
00:15:15,110 --> 00:15:22,490
side the inner Burke's of of the Asics

265
00:15:19,310 --> 00:15:25,160
or just the actual circuitry and on the

266
00:15:22,490 --> 00:15:28,820
right the pin of the ASIC you have some

267
00:15:25,160 --> 00:15:32,780
kind of of protection circuitry in

268
00:15:28,820 --> 00:15:35,449
between and also some kind of when it is

269
00:15:32,780 --> 00:15:37,790
outputs than just output logic when

270
00:15:35,449 --> 00:15:41,269
this input just input logic and when it

271
00:15:37,790 --> 00:15:45,230
is input and output both and you can

272
00:15:41,269 --> 00:15:48,799
measure the resistance of all these free

273
00:15:45,230 --> 00:15:53,269
options so when you have a pin where you

274
00:15:48,799 --> 00:15:57,259
know that it is input or output or in

275
00:15:53,269 --> 00:15:59,329
and out then you can just just probe the

276
00:15:57,259 --> 00:16:03,649
other means where don't know what

277
00:15:59,329 --> 00:16:05,959
purpose they have whether they are yeah

278
00:16:03,649 --> 00:16:08,089
this this kind of pins because you know

279
00:16:05,959 --> 00:16:11,049
the resistance you can just you can just

280
00:16:08,089 --> 00:16:14,959
use some simple resistance measurement

281
00:16:11,049 --> 00:16:17,720
exactly for that purpose but yeah I

282
00:16:14,959 --> 00:16:21,469
didn't I didn't use that here because it

283
00:16:17,720 --> 00:16:23,329
was yeah easier and I found the most

284
00:16:21,470 --> 00:16:27,709
interfaces and yeah

285
00:16:23,329 --> 00:16:29,929
so for decapping the chips because there

286
00:16:27,709 --> 00:16:35,988
is just the label Japan and some number

287
00:16:29,929 --> 00:16:38,600
I used sulfuric acid it's it smells not

288
00:16:35,989 --> 00:16:41,600
so good so be careful and don't do it at

289
00:16:38,600 --> 00:16:44,779
home but you get beautiful pictures with

290
00:16:41,600 --> 00:16:47,720
a confocal microscope and you can also

291
00:16:44,779 --> 00:16:50,239
read some labels and in that case it was

292
00:16:47,720 --> 00:16:56,149
designed by fuji to you you can spot it

293
00:16:50,239 --> 00:16:58,669
here maybe fuji to 2007 and you were

294
00:16:56,149 --> 00:17:01,459
also able to spot which of these pins

295
00:16:58,669 --> 00:17:04,369
are connected and which not so when they

296
00:17:01,459 --> 00:17:07,309
were connected to some outputs then you

297
00:17:04,369 --> 00:17:08,898
see some some small notch here and other

298
00:17:07,309 --> 00:17:11,000
pins which were not connected are

299
00:17:08,898 --> 00:17:13,129
completely clean and you can also

300
00:17:11,000 --> 00:17:17,388
sometimes you can also spot some not

301
00:17:13,130 --> 00:17:19,309
connect labels down there and I was also

302
00:17:17,388 --> 00:17:25,309
digging through literature so which

303
00:17:19,309 --> 00:17:29,029
architecture can it be and yeah what

304
00:17:25,309 --> 00:17:33,200
what was really really used at this time

305
00:17:29,029 --> 00:17:36,380
for such program at programmable logic

306
00:17:33,200 --> 00:17:37,760
devices and yeah there were different

307
00:17:36,380 --> 00:17:42,470
options erm

308
00:17:37,760 --> 00:17:44,570
Fujitsu risk and fqm see and yeah

309
00:17:42,470 --> 00:17:48,019
to be sure I just removed the flash

310
00:17:44,570 --> 00:17:48,909
memory used the custom solution to read

311
00:17:48,019 --> 00:17:51,730
the flash

312
00:17:48,910 --> 00:17:54,190
memory and then I thought okay it's

313
00:17:51,730 --> 00:17:56,860
which it's a risk because when I loaded

314
00:17:54,190 --> 00:18:00,780
into a de pro set it too fruity to risk

315
00:17:56,860 --> 00:18:04,750
then it looks like some function some

316
00:18:00,780 --> 00:18:07,060
multiple functions yeah but just one of

317
00:18:04,750 --> 00:18:10,420
the one of the pains were not connected

318
00:18:07,060 --> 00:18:15,100
of my reader after fixing that I saw

319
00:18:10,420 --> 00:18:17,380
okay it's a RM and yeah I just I also

320
00:18:15,100 --> 00:18:20,590
got some some strings out there which

321
00:18:17,380 --> 00:18:24,720
get referenced in either and then I was

322
00:18:20,590 --> 00:18:27,220
able to draw some kind of somatic of

323
00:18:24,720 --> 00:18:29,080
something some kind of diagram where is

324
00:18:27,220 --> 00:18:32,520
the core where are the modules which

325
00:18:29,080 --> 00:18:35,500
modules are embedded into this firm and

326
00:18:32,520 --> 00:18:40,440
yeah that was really cool

327
00:18:35,500 --> 00:18:46,300
I also identified that it may be a rm9

328
00:18:40,440 --> 00:18:47,890
26 or 946 but I was not not really sure

329
00:18:46,300 --> 00:18:49,960
because of the instructions that you

330
00:18:47,890 --> 00:18:53,950
cannot say it's all the time for the

331
00:18:49,960 --> 00:18:57,580
second batch I did the same also started

332
00:18:53,950 --> 00:19:01,780
with removing the the flash chip and the

333
00:18:57,580 --> 00:19:05,649
system on chip and it was also it was

334
00:19:01,780 --> 00:19:10,420
also a RM but a different architecture

335
00:19:05,650 --> 00:19:13,030
and identified that by removing the spi

336
00:19:10,420 --> 00:19:15,580
flash the small one here there's also a

337
00:19:13,030 --> 00:19:17,620
NAND flash the SPI flash just contains

338
00:19:15,580 --> 00:19:21,820
the bootloader so it was not so much

339
00:19:17,620 --> 00:19:24,909
code but it was enough to to see which

340
00:19:21,820 --> 00:19:28,149
architecture which which CPU

341
00:19:24,910 --> 00:19:30,670
architecture at least was used and it

342
00:19:28,150 --> 00:19:33,730
was produced by renesis and not Fujitsu

343
00:19:30,670 --> 00:19:37,900
this time so that's also the neuro

344
00:19:33,730 --> 00:19:40,540
series of these logic devices and yeah

345
00:19:37,900 --> 00:19:45,190
it was it had some similarities to our

346
00:19:40,540 --> 00:19:48,820
tech 200 P and 400 so they were also

347
00:19:45,190 --> 00:19:51,640
designed for such logic devices in an

348
00:19:48,820 --> 00:19:56,200
industrial environment and it was also

349
00:19:51,640 --> 00:20:00,850
possible to brute-force jtag in that

350
00:19:56,200 --> 00:20:02,250
case so from the PCP which was not the

351
00:20:00,850 --> 00:20:04,350
one that I ordered

352
00:20:02,250 --> 00:20:07,500
because I got the wrong one but it was

353
00:20:04,350 --> 00:20:10,049
better because it has it had some header

354
00:20:07,500 --> 00:20:12,240
with jtech on it the other one had no

355
00:20:10,049 --> 00:20:15,000
header with jtech so it was it was fine

356
00:20:12,240 --> 00:20:20,789
- yeah and I also identified that it was

357
00:20:15,000 --> 00:20:23,789
cortex are for revision one pp 3 so was

358
00:20:20,789 --> 00:20:27,629
pretty nice and then I modified some

359
00:20:23,789 --> 00:20:34,230
real Bertie device so yeah

360
00:20:27,630 --> 00:20:37,190
broke 260 euro but whatever you have to

361
00:20:34,230 --> 00:20:40,380
do it when you want to be successful and

362
00:20:37,190 --> 00:20:43,080
yeah when you when you stop the CPU in

363
00:20:40,380 --> 00:20:45,150
that case a watchdog runs on an internal

364
00:20:43,080 --> 00:20:48,090
hardware module which is embedded in the

365
00:20:45,150 --> 00:20:50,580
system on chip and yeah when you leave

366
00:20:48,090 --> 00:20:54,090
it too long stops then it clears the

367
00:20:50,580 --> 00:20:56,149
whole framework from the device that was

368
00:20:54,090 --> 00:21:00,899
not nice but at least you can program it

369
00:20:56,150 --> 00:21:02,909
but I saw that after after after

370
00:21:00,900 --> 00:21:05,940
attaching to it and reading and writing

371
00:21:02,909 --> 00:21:10,100
some values so yeah I broke free of the

372
00:21:05,940 --> 00:21:15,500
devices but yeah I have a small demo

373
00:21:10,100 --> 00:21:18,658
where I where I have brought some POC

374
00:21:15,500 --> 00:21:21,450
one of the of the board's that I used in

375
00:21:18,659 --> 00:21:24,720
the heart will happen when I and a

376
00:21:21,450 --> 00:21:26,220
programmer and basically it's just the

377
00:21:24,720 --> 00:21:30,210
programmer which is connected to the

378
00:21:26,220 --> 00:21:33,539
modified device and yeah the super fancy

379
00:21:30,210 --> 00:21:34,320
heart was just doing you at USP that's

380
00:21:33,539 --> 00:21:38,010
it

381
00:21:34,320 --> 00:21:43,439
the new interface of the PLC was I think

382
00:21:38,010 --> 00:21:47,280
it was you can find it in a paper of a

383
00:21:43,440 --> 00:21:52,980
researcher from the WiiU Amsterdam so

384
00:21:47,280 --> 00:21:55,860
you know in the same city and yeah I

385
00:21:52,980 --> 00:21:57,480
just you this used it and I got the

386
00:21:55,860 --> 00:22:00,209
memory address the memory mapped i/o

387
00:21:57,480 --> 00:22:03,570
address for the Ewart from a colleague

388
00:22:00,210 --> 00:22:05,340
from a doctor ali abbas him he provided

389
00:22:03,570 --> 00:22:08,189
the you had addressed to me because he

390
00:22:05,340 --> 00:22:10,649
did a lot of research by removing this

391
00:22:08,190 --> 00:22:14,280
bootloader I mentioned before injecting

392
00:22:10,649 --> 00:22:15,780
codes and yeah soldiering it back and

393
00:22:14,280 --> 00:22:18,629
all this stuff

394
00:22:15,780 --> 00:22:20,850
he pulled off the whole firmware and got

395
00:22:18,630 --> 00:22:26,310
the whole memory maps ooh yeah he helped

396
00:22:20,850 --> 00:22:27,090
me a little bit okay let's hope that it

397
00:22:26,310 --> 00:22:29,190
works

398
00:22:27,090 --> 00:22:34,080
so I have written a small assembly

399
00:22:29,190 --> 00:22:37,620
program and this terminal is just just a

400
00:22:34,080 --> 00:22:41,429
USB connection to the PLC and I hope

401
00:22:37,620 --> 00:22:46,739
when I make program yeah then it outputs

402
00:22:41,430 --> 00:22:50,730
hex both 2019 and carriage return line

403
00:22:46,740 --> 00:22:53,370
feed Auto and yeah that's coming out of

404
00:22:50,730 --> 00:22:56,060
the PLC so I don't have to remove the

405
00:22:53,370 --> 00:22:58,679
flash memory the flash memory chip

406
00:22:56,060 --> 00:23:02,100
reprogram it a soldier back I can just

407
00:22:58,680 --> 00:23:05,700
use jtech on this system on trip where I

408
00:23:02,100 --> 00:23:09,570
don't have any documentation yeah and

409
00:23:05,700 --> 00:23:14,490
you can also use the live debugger so I

410
00:23:09,570 --> 00:23:16,320
will restart it jail Inc that's that

411
00:23:14,490 --> 00:23:20,160
that's just a software environment for

412
00:23:16,320 --> 00:23:25,429
this half with debugger and by typing

413
00:23:20,160 --> 00:23:25,430
connect and you type it in right away

414
00:23:25,850 --> 00:23:34,860
you can just attach to the to this

415
00:23:29,370 --> 00:23:38,129
processor you see cortex r4 and I have

416
00:23:34,860 --> 00:23:42,510
also connected software the system reset

417
00:23:38,130 --> 00:23:46,500
and you can just type our zero and then

418
00:23:42,510 --> 00:23:51,920
it stops running so there is no output

419
00:23:46,500 --> 00:23:56,400
coming out then you can just can just

420
00:23:51,920 --> 00:24:06,360
set it to default reprogram it and it

421
00:23:56,400 --> 00:24:09,800
works so yeah fun fact was we had we had

422
00:24:06,360 --> 00:24:13,590
some telephone call some corresponds

423
00:24:09,800 --> 00:24:16,530
corresponding with Siemens and they told

424
00:24:13,590 --> 00:24:19,500
us yeah it's not a supply chain leak

425
00:24:16,530 --> 00:24:21,930
it's just an aftermarket issue but that

426
00:24:19,500 --> 00:24:23,850
was a good information to me because

427
00:24:21,930 --> 00:24:27,779
when it's an aftermarket issue then it

428
00:24:23,850 --> 00:24:30,299
means this device is is sold so

429
00:24:27,779 --> 00:24:34,169
this PCP which I get with the cheetah

430
00:24:30,299 --> 00:24:37,889
Kara is actually sold and yeah then I

431
00:24:34,169 --> 00:24:42,899
looked through some some yeah shops

432
00:24:37,889 --> 00:24:46,978
websites whatever and I saw that yeah

433
00:24:42,899 --> 00:24:49,439
pretty similar so s7 200 smart and I

434
00:24:46,979 --> 00:24:53,009
figured out that it was mainly sold in

435
00:24:49,440 --> 00:24:55,590
India and China but not in Europe and

436
00:24:53,009 --> 00:24:56,070
that's the reason why I was not aware of

437
00:24:55,590 --> 00:24:58,709
that

438
00:24:56,070 --> 00:25:02,279
but you see the similarities that's just

439
00:24:58,710 --> 00:25:04,440
another serious with fewer outputs and

440
00:25:02,279 --> 00:25:07,049
inputs but it's basically the same so

441
00:25:04,440 --> 00:25:08,789
you see there is the same header there

442
00:25:07,049 --> 00:25:10,499
is also a battery there is the

443
00:25:08,789 --> 00:25:11,279
system-on-chip the interfaces are the

444
00:25:10,499 --> 00:25:21,330
same and so on

445
00:25:11,279 --> 00:25:24,749
so yeah so do you have questions thank

446
00:25:21,330 --> 00:25:28,049
you so much for your presentation we

447
00:25:24,749 --> 00:25:33,589
have the time for question probably so

448
00:25:28,049 --> 00:25:36,599
is there any from the audience so here

449
00:25:33,589 --> 00:25:40,259
what is the time frame that you spend on

450
00:25:36,599 --> 00:25:44,639
this project also actually figuring out

451
00:25:40,259 --> 00:25:47,399
the JTAG was few days but waiting for

452
00:25:44,639 --> 00:25:51,149
the PCPs searching the piece of piece

453
00:25:47,399 --> 00:25:56,008
writing all the stuff together weeks

454
00:25:51,149 --> 00:25:58,168
months maybe but no working on it few

455
00:25:56,009 --> 00:26:00,210
days it's not so complicated when you

456
00:25:58,169 --> 00:26:02,899
are when you have some practice then

457
00:26:00,210 --> 00:26:05,539
it's definitely possible and in few days

458
00:26:02,899 --> 00:26:07,768
thank you

459
00:26:05,539 --> 00:26:17,908
any other question like a quick one

460
00:26:07,769 --> 00:26:21,179
probably still have one minute okay were

461
00:26:17,909 --> 00:26:26,129
you able to retrieve the firmware from

462
00:26:21,179 --> 00:26:28,799
the chip as I told you it was cleared

463
00:26:26,129 --> 00:26:32,279
after the watch torque recognized that

464
00:26:28,799 --> 00:26:34,649
it was stopped but when you do it at the

465
00:26:32,279 --> 00:26:37,230
first time then you can can read the

466
00:26:34,649 --> 00:26:45,840
data out from the dynamic Ram

467
00:26:37,230 --> 00:26:47,040
so yes I would say 70% yeah okay so

468
00:26:45,840 --> 00:26:50,120
thank you once again

469
00:26:47,040 --> 00:26:54,180
and thank you for sharing your knowledge

470
00:26:50,120 --> 00:26:54,179
[Applause]

471
00:26:59,100 --> 00:27:01,159
you

