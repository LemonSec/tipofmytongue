1
00:00:26,880 --> 00:00:33,350
all right I'm happy to see you guys I'm

2
00:00:29,820 --> 00:00:35,570
happy very a lot of people here still if

3
00:00:33,350 --> 00:00:39,930
Strassmann talked all these two days

4
00:00:35,570 --> 00:00:40,739
today's very busy so I'm pretty happy to

5
00:00:39,930 --> 00:00:43,620
be here

6
00:00:40,739 --> 00:00:46,050
10th year anniversary so we hope to to

7
00:00:43,620 --> 00:00:47,760
share something interesting for you if

8
00:00:46,050 --> 00:00:49,830
your question I do understand something

9
00:00:47,760 --> 00:00:53,400
just raise your hand let's try to make

10
00:00:49,830 --> 00:00:56,550
it a bit more like interactive so that's

11
00:00:53,400 --> 00:00:58,320
the research we did me federico jonathan

12
00:00:56,550 --> 00:01:01,409
and if you ever colleagues you see on

13
00:00:58,320 --> 00:01:04,110
screen big group we all work for Tremec

14
00:01:01,409 --> 00:01:07,110
research so the idea was to look into

15
00:01:04,110 --> 00:01:09,600
the security of industrial protocols

16
00:01:07,110 --> 00:01:11,880
protocols that are used for example in

17
00:01:09,600 --> 00:01:14,309
cranes as well as a bunch of other

18
00:01:11,880 --> 00:01:16,229
machineries like drillers inve

19
00:01:14,310 --> 00:01:18,659
alternative sector logistics sectors

20
00:01:16,229 --> 00:01:21,870
everywhere so a radio controller like

21
00:01:18,659 --> 00:01:24,120
this one you see on screen all right so

22
00:01:21,870 --> 00:01:26,670
these radio controllers have been around

23
00:01:24,120 --> 00:01:28,740
for many years so we made a kind of

24
00:01:26,670 --> 00:01:30,780
survey of different vendors and we

25
00:01:28,740 --> 00:01:34,169
figure out that we've been around for 25

26
00:01:30,780 --> 00:01:36,810
30 years you see like from way all the

27
00:01:34,170 --> 00:01:40,380
controllers up in the 90s to the most

28
00:01:36,810 --> 00:01:42,719
recent one the tap joystick and sun so

29
00:01:40,380 --> 00:01:44,880
obvious controller 'made are made of a

30
00:01:42,719 --> 00:01:48,630
receiver like Viswa you see on-screen

31
00:01:44,880 --> 00:01:51,839
which is pretty much a photo of this

32
00:01:48,630 --> 00:01:54,359
gentleman now here so the receiver is

33
00:01:51,840 --> 00:01:58,679
made to be connected to the machine you

34
00:01:54,359 --> 00:02:00,979
want to make remote enabled so you can

35
00:01:58,679 --> 00:02:03,299
connect it to any machine you want and

36
00:02:00,979 --> 00:02:06,320
the receiver of course receive commands

37
00:02:03,299 --> 00:02:10,020
from the transmitter that's very simple

38
00:02:06,320 --> 00:02:12,150
so the transmitter you have one like

39
00:02:10,020 --> 00:02:13,860
visual maybe you can circulate here in

40
00:02:12,150 --> 00:02:16,380
the audience first line so people can

41
00:02:13,860 --> 00:02:19,530
give it a try there are different

42
00:02:16,380 --> 00:02:22,200
buttons and you can operate of course

43
00:02:19,530 --> 00:02:23,340
the machine which is connected to to the

44
00:02:22,200 --> 00:02:27,149
receiver

45
00:02:23,340 --> 00:02:29,190
we have transmitter like this one

46
00:02:27,150 --> 00:02:30,660
whatever just battles while we have more

47
00:02:29,190 --> 00:02:32,640
than one whatever choice Nick Matt

48
00:02:30,660 --> 00:02:33,790
they're pretty much similar to each

49
00:02:32,640 --> 00:02:37,059
other

50
00:02:33,790 --> 00:02:40,060
very used as I said in a different

51
00:02:37,060 --> 00:02:45,010
situations we're using a horse crane

52
00:02:40,060 --> 00:02:48,370
like this inside the big factories very

53
00:02:45,010 --> 00:02:51,640
used in construction sites for example

54
00:02:48,370 --> 00:02:55,239
to move like concrete pants around or to

55
00:02:51,640 --> 00:02:58,569
move if you want like cars like big

56
00:02:55,239 --> 00:03:02,290
trucks and so on as well as what's

57
00:02:58,569 --> 00:03:03,849
called Auto crane that are used in a for

58
00:03:02,290 --> 00:03:06,578
example logistic to move things around

59
00:03:03,849 --> 00:03:09,640
and so on and so forth so a lot of

60
00:03:06,579 --> 00:03:10,780
different application going from mining

61
00:03:09,640 --> 00:03:13,358
you can see here

62
00:03:10,780 --> 00:03:17,129
drillers you can see it in industrial

63
00:03:13,359 --> 00:03:21,280
application logistics to move containers

64
00:03:17,129 --> 00:03:24,670
agriculture so and so forth so given the

65
00:03:21,280 --> 00:03:26,620
extension of this radio controller we

66
00:03:24,670 --> 00:03:28,030
say ok let's let's take a look at verse

67
00:03:26,620 --> 00:03:31,510
one you know that seems to be like an

68
00:03:28,030 --> 00:03:35,049
important asset for our economy so let's

69
00:03:31,510 --> 00:03:39,160
see if there are any potential risks all

70
00:03:35,049 --> 00:03:40,840
right so to do that we start with what

71
00:03:39,160 --> 00:03:45,209
we call preliminary on time on-site

72
00:03:40,840 --> 00:03:48,760
testing or if you want wardriving

73
00:03:45,209 --> 00:03:51,299
so what we did we we went with Federico

74
00:03:48,760 --> 00:03:54,069
we both live near Milan not from Italy

75
00:03:51,299 --> 00:03:58,000
so we we went with this car

76
00:03:54,069 --> 00:04:00,790
it's more like what is it like a small

77
00:03:58,000 --> 00:04:02,290
Fiat but you know we basically we had

78
00:04:00,790 --> 00:04:06,668
like antennas you know it's typical

79
00:04:02,290 --> 00:04:08,220
wardriving activities we have our were

80
00:04:06,669 --> 00:04:10,930
driving kit here made of a laptop

81
00:04:08,220 --> 00:04:13,540
software-defined radio two of them

82
00:04:10,930 --> 00:04:15,669
actually for both one but know about

83
00:04:13,540 --> 00:04:19,930
software fine radio one is the blade RF

84
00:04:15,669 --> 00:04:21,609
the other one is a tooth and mmm that we

85
00:04:19,930 --> 00:04:24,700
did a bit of 10 stick around or visiting

86
00:04:21,608 --> 00:04:27,250
different facilities factories as well

87
00:04:24,700 --> 00:04:31,810
as a construction site and so on and so

88
00:04:27,250 --> 00:04:33,690
forth overall doing something like few

89
00:04:31,810 --> 00:04:37,449
weeks we came across something like

90
00:04:33,690 --> 00:04:40,790
seven different vendors being used

91
00:04:37,449 --> 00:04:43,160
widely in all these facilities

92
00:04:40,790 --> 00:04:45,380
we have vendor from Taiwan very much

93
00:04:43,160 --> 00:04:48,500
prevalent some vendor friendly of course

94
00:04:45,380 --> 00:04:52,130
whenever is one from Japan and one from

95
00:04:48,500 --> 00:04:54,940
Germany and we took a look at the

96
00:04:52,130 --> 00:04:58,010
website of these vendors veggies tribute

97
00:04:54,940 --> 00:05:00,980
globally worldwide so we thought it was

98
00:04:58,010 --> 00:05:04,099
a good set of vendor to look at because

99
00:05:00,980 --> 00:05:06,200
they recover all different you know main

100
00:05:04,100 --> 00:05:10,280
nation in the world from China to US

101
00:05:06,200 --> 00:05:12,830
Europe so we are the good testing set if

102
00:05:10,280 --> 00:05:15,409
you want as I said we use this of the

103
00:05:12,830 --> 00:05:16,940
fine radio for that I'm not going much

104
00:05:15,410 --> 00:05:19,160
entertained to this I guess you guys

105
00:05:16,940 --> 00:05:21,860
must like know what they are it's a

106
00:05:19,160 --> 00:05:25,130
standard technology to implement radius

107
00:05:21,860 --> 00:05:26,750
via software the computer very easy to

108
00:05:25,130 --> 00:05:30,110
use there are different models would go

109
00:05:26,750 --> 00:05:34,460
from a hundred bucks to five hundred and

110
00:05:30,110 --> 00:05:38,450
son and so we started by developing a

111
00:05:34,460 --> 00:05:41,870
small code in a form of glue righty-o

112
00:05:38,450 --> 00:05:43,460
flow chart Mirage is a software let's

113
00:05:41,870 --> 00:05:45,710
values to implements of the refine

114
00:05:43,460 --> 00:05:47,900
radius so you can see that you we have a

115
00:05:45,710 --> 00:05:51,409
code on the left that allow us to record

116
00:05:47,900 --> 00:05:53,390
so we can record a radio signal record

117
00:05:51,410 --> 00:05:56,240
some traffic that is stream over the

118
00:05:53,390 --> 00:05:59,570
radio over over being over here so we

119
00:05:56,240 --> 00:06:01,670
have our of the final radio and we have

120
00:05:59,570 --> 00:06:06,290
we dumped the content that come from

121
00:06:01,670 --> 00:06:08,810
here into final then here we have a the

122
00:06:06,290 --> 00:06:11,840
flow chart that actually reply such

123
00:06:08,810 --> 00:06:14,540
traffic so it reads from a file and it

124
00:06:11,840 --> 00:06:15,919
transmitted over there okay so it's very

125
00:06:14,540 --> 00:06:18,170
simple it's like you have a microphone

126
00:06:15,920 --> 00:06:22,370
here on the left and you have a speaker

127
00:06:18,170 --> 00:06:25,460
on the right right so we went we did our

128
00:06:22,370 --> 00:06:27,440
primary on-site testing and can you

129
00:06:25,460 --> 00:06:33,049
guess what happened I'm going to show

130
00:06:27,440 --> 00:06:34,760
you a small video here so as you can see

131
00:06:33,050 --> 00:06:38,510
on screen that's ecstatic the flow chart

132
00:06:34,760 --> 00:06:41,270
I show you before so this is me holding

133
00:06:38,510 --> 00:06:42,680
out holding talking with your parrot or

134
00:06:41,270 --> 00:06:46,450
on the other side while it smoking a

135
00:06:42,680 --> 00:06:48,860
cigarette I'm there with my hands in a

136
00:06:46,450 --> 00:06:51,440
images and I have a video controller

137
00:06:48,860 --> 00:06:53,879
here so this is one of the radio control

138
00:06:51,440 --> 00:06:57,029
array I was showing before

139
00:06:53,879 --> 00:06:59,610
we have federico Makar Federico is going

140
00:06:57,029 --> 00:07:02,039
to reply a park app that we collect

141
00:06:59,610 --> 00:07:04,919
previously as you can see here that's a

142
00:07:02,039 --> 00:07:11,089
big crane and you have a big crane

143
00:07:04,919 --> 00:07:14,429
moving like this easily when we did the

144
00:07:11,089 --> 00:07:18,809
second test we went to facility where

145
00:07:14,429 --> 00:07:22,169
they rained out - crane street crane on

146
00:07:18,809 --> 00:07:24,629
a on a auto here is the same

147
00:07:22,169 --> 00:07:28,049
that's my laptop I run the script that's

148
00:07:24,629 --> 00:07:30,929
a blade RF great to my laptop that's the

149
00:07:28,050 --> 00:07:33,689
original transmitter nobody's touching

150
00:07:30,929 --> 00:07:41,448
it and you will see soon what will

151
00:07:33,689 --> 00:07:41,449
happen here - TV on - plane moving up

152
00:07:51,589 --> 00:07:58,889
all right so let's describe a bit here

153
00:07:56,429 --> 00:08:01,859
where is we where is the problem so this

154
00:07:58,889 --> 00:08:04,379
is very simple and I'm going to describe

155
00:08:01,860 --> 00:08:06,329
to you wive is happening so suppose you

156
00:08:04,379 --> 00:08:08,219
have a transmitter I want to send a

157
00:08:06,329 --> 00:08:10,139
command like hop they know like in

158
00:08:08,219 --> 00:08:13,558
example Val - crane moving out - crane

159
00:08:10,139 --> 00:08:15,959
hub so what transmitter does encode this

160
00:08:13,559 --> 00:08:18,079
command in the message transmit the

161
00:08:15,959 --> 00:08:21,869
message over there message number one

162
00:08:18,079 --> 00:08:24,209
the message arrived to the receiver this

163
00:08:21,869 --> 00:08:26,269
one what the receiver does it decode the

164
00:08:24,209 --> 00:08:31,589
message and they execute the command

165
00:08:26,269 --> 00:08:33,750
very simple if the transmitter send in

166
00:08:31,589 --> 00:08:36,448
our command let's say the same command

167
00:08:33,750 --> 00:08:38,938
up again what else meter does is

168
00:08:36,448 --> 00:08:40,978
generated another message called message

169
00:08:38,938 --> 00:08:42,870
number to send a message over there a

170
00:08:40,979 --> 00:08:45,000
message arrived its way to a receiver

171
00:08:42,870 --> 00:08:47,759
and so on and so forth so if you want to

172
00:08:45,000 --> 00:08:50,130
send multiple command up up up I'm going

173
00:08:47,759 --> 00:08:53,550
to generate multiple messages so the

174
00:08:50,130 --> 00:08:58,410
first question to you guys is for this

175
00:08:53,550 --> 00:09:05,630
radio protocol to be secure all these

176
00:08:58,410 --> 00:09:05,630
messages should look like yeah mark

177
00:09:17,870 --> 00:09:24,540
perfect so the answer was this message

178
00:09:22,050 --> 00:09:27,449
should be different even if you are

179
00:09:24,540 --> 00:09:29,880
transmitting the same message they

180
00:09:27,450 --> 00:09:32,130
should all look different because if

181
00:09:29,880 --> 00:09:34,439
they don't look different what an

182
00:09:32,130 --> 00:09:39,030
attacker can do can record the first

183
00:09:34,440 --> 00:09:40,710
message can reply the first message is

184
00:09:39,030 --> 00:09:43,680
message number two and of course the

185
00:09:40,710 --> 00:09:45,420
receiver will execute the command and of

186
00:09:43,680 --> 00:09:47,969
course this is not the case we test all

187
00:09:45,420 --> 00:09:50,160
the vendors here and all the vendors

188
00:09:47,970 --> 00:09:51,810
were vulnerable to with a very simple

189
00:09:50,160 --> 00:09:56,069
attack because all the message will be

190
00:09:51,810 --> 00:09:59,040
same so this is called record reply

191
00:09:56,070 --> 00:10:00,900
attack is one of them in attachment we

192
00:09:59,040 --> 00:10:03,750
will go and describe during this

193
00:10:00,900 --> 00:10:07,560
presentation so as I said you can record

194
00:10:03,750 --> 00:10:09,960
here command and reply the command so

195
00:10:07,560 --> 00:10:14,310
will now make a small demo to show you

196
00:10:09,960 --> 00:10:17,250
how this attack is performing in reality

197
00:10:14,310 --> 00:10:21,000
against our I want to fake crane down

198
00:10:17,250 --> 00:10:24,570
here so this is the transmitter dono is

199
00:10:21,000 --> 00:10:27,840
off just put it here this is our blade

200
00:10:24,570 --> 00:10:32,760
RF connected to the laptop so we switch

201
00:10:27,840 --> 00:10:35,850
here I execute can you see guys but it's

202
00:10:32,760 --> 00:10:42,810
not much to see anyhow because it's like

203
00:10:35,850 --> 00:10:45,240
this so what the blade RF will do will

204
00:10:42,810 --> 00:10:47,069
reply a korma a message with a previous

205
00:10:45,240 --> 00:10:50,460
recall before we talk about moving on

206
00:10:47,070 --> 00:10:57,180
the right and the crane will operate as

207
00:10:50,460 --> 00:11:00,300
a consequence stop all right but what

208
00:10:57,180 --> 00:11:03,150
about if attacker is more smart is more

209
00:11:00,300 --> 00:11:05,670
intelligent so you want to do more than

210
00:11:03,150 --> 00:11:10,670
this because this is very simple now so

211
00:11:05,670 --> 00:11:14,969
suppose you have your garage opener and

212
00:11:10,670 --> 00:11:17,250
instead of replying the same message an

213
00:11:14,970 --> 00:11:17,800
opening on your garage I'm going to open

214
00:11:17,250 --> 00:11:19,750
old

215
00:11:17,800 --> 00:11:22,180
garage so what about if I and they stand

216
00:11:19,750 --> 00:11:24,279
on the package of a packet is creating I

217
00:11:22,180 --> 00:11:26,739
want to modify that so he's allowed to

218
00:11:24,279 --> 00:11:28,570
do arbitrary code execution so to do

219
00:11:26,740 --> 00:11:31,630
that as I said that the attacker has to

220
00:11:28,570 --> 00:11:34,209
understand how a radio protocol is made

221
00:11:31,630 --> 00:11:36,490
what is in the packet in the radio

222
00:11:34,209 --> 00:11:38,380
packet so to do that he has to do of

223
00:11:36,490 --> 00:11:40,420
course reverse engineering

224
00:11:38,380 --> 00:11:42,339
so as you you know you have a sample if

225
00:11:40,420 --> 00:11:44,140
a binary sample you have to the stare

226
00:11:42,339 --> 00:11:46,089
water by the sample does you reverse

227
00:11:44,140 --> 00:11:47,890
engineer your buyer sample for example

228
00:11:46,089 --> 00:11:49,420
to figure out if it's a malware or not

229
00:11:47,890 --> 00:11:50,829
your it's the same use a reverse

230
00:11:49,420 --> 00:11:52,269
engineer technique so there are

231
00:11:50,829 --> 00:11:54,670
techniques to reverse engineer a radio

232
00:11:52,269 --> 00:11:57,760
protocol to understand how the protocol

233
00:11:54,670 --> 00:12:01,839
looks like so if there is a checksum how

234
00:11:57,760 --> 00:12:05,980
the checksum is looks like if there is a

235
00:12:01,839 --> 00:12:07,630
sinker code or not so in that case what

236
00:12:05,980 --> 00:12:10,329
an attacker can do can understand how

237
00:12:07,630 --> 00:12:12,490
the checksum is made of and what he can

238
00:12:10,329 --> 00:12:16,209
do consequently can for example replace

239
00:12:12,490 --> 00:12:20,050
the command up that move out to Crane

240
00:12:16,209 --> 00:12:24,270
you know up to command that could be

241
00:12:20,050 --> 00:12:27,339
like could simulate in emergence

242
00:12:24,270 --> 00:12:30,100
so all this transmitter they have a

243
00:12:27,339 --> 00:12:31,810
button here on the top so we operate or

244
00:12:30,100 --> 00:12:34,450
in case there is an emergency

245
00:12:31,810 --> 00:12:38,020
emerges like a problem like he can stop

246
00:12:34,450 --> 00:12:41,740
immediately the Machine the crane by

247
00:12:38,020 --> 00:12:43,680
pushing this button down at this of

248
00:12:41,740 --> 00:12:48,510
course the attacker can do that he can

249
00:12:43,680 --> 00:12:50,859
record any arbitrary message he can van

250
00:12:48,510 --> 00:12:52,630
reply the message what a modified

251
00:12:50,860 --> 00:12:55,060
version of a message so he's going to

252
00:12:52,630 --> 00:12:57,550
reply the up command with a emergent

253
00:12:55,060 --> 00:13:00,969
stop commander he will compute the

254
00:12:57,550 --> 00:13:03,760
correct checksum for recommend and send

255
00:13:00,970 --> 00:13:06,640
it but not once you will send it once

256
00:13:03,760 --> 00:13:10,529
twice three times so it will basically

257
00:13:06,640 --> 00:13:12,640
cause denial of service of a production

258
00:13:10,529 --> 00:13:14,769
so what does it mean it means that you

259
00:13:12,640 --> 00:13:17,439
have an attacker ready sit outside of a

260
00:13:14,769 --> 00:13:21,060
factory with this molecule like verse it

261
00:13:17,440 --> 00:13:23,980
can block the production roughly Craner

262
00:13:21,060 --> 00:13:26,229
block any kind of logistic communication

263
00:13:23,980 --> 00:13:30,310
and so on so we have a demo for this as

264
00:13:26,230 --> 00:13:36,540
well so you mind passing way

265
00:13:30,310 --> 00:13:36,540
transmitter to someone here in room

266
00:13:42,149 --> 00:13:48,850
so here we have a small scrip that

267
00:13:45,240 --> 00:13:51,670
implement what I previously said so what

268
00:13:48,850 --> 00:13:56,319
you will do is send multiple emergent

269
00:13:51,670 --> 00:13:58,959
stop commands so that pointer what will

270
00:13:56,319 --> 00:14:03,248
happen is that the crane will stop

271
00:13:58,959 --> 00:14:11,920
operating even if you operate or want to

272
00:14:03,249 --> 00:14:14,860
move a crane even but you see the LED is

273
00:14:11,920 --> 00:14:17,579
there they will stay consistently off

274
00:14:14,860 --> 00:14:20,769
right even if I'm trying to restart

275
00:14:17,579 --> 00:14:24,969
those safety relays there's no way I can

276
00:14:20,769 --> 00:14:27,910
I can use the crane anymore right maybe

277
00:14:24,970 --> 00:14:33,519
for small intervals but then goes off

278
00:14:27,910 --> 00:14:41,230
again so it's still off okay let me stop

279
00:14:33,519 --> 00:14:43,839
this all right so this looks pretty easy

280
00:14:41,230 --> 00:14:45,850
on people but you know might not be

281
00:14:43,839 --> 00:14:49,149
necessary for things so I'm going to now

282
00:14:45,850 --> 00:14:53,470
- we are going all together to dig into

283
00:14:49,149 --> 00:14:57,850
the domain of reverse engineering a

284
00:14:53,470 --> 00:14:59,079
radio protocol so what how it looks like

285
00:14:57,850 --> 00:15:02,110
where it should start so you should

286
00:14:59,079 --> 00:15:04,269
start by purchasing the device you want

287
00:15:02,110 --> 00:15:07,149
a target of course so in our case is

288
00:15:04,269 --> 00:15:11,079
this gentleman here is a the mark is a

289
00:15:07,149 --> 00:15:12,699
JUCO and this is with a cover which is

290
00:15:11,079 --> 00:15:14,649
without the cover and is actually the

291
00:15:12,699 --> 00:15:16,929
gentleman down there and you have of

292
00:15:14,649 --> 00:15:18,579
course the transmitter so what you're

293
00:15:16,929 --> 00:15:21,129
not good do you're gonna opening up

294
00:15:18,579 --> 00:15:23,949
figuring out how it's made

295
00:15:21,129 --> 00:15:26,110
if there is an MCU iminium silver are if

296
00:15:23,949 --> 00:15:28,748
there is a range of chipset which kind

297
00:15:26,110 --> 00:15:32,050
of red chips there are so in this case

298
00:15:28,749 --> 00:15:33,710
where was this red chips a TR sec 1 1 2

299
00:15:32,050 --> 00:15:36,810
0

300
00:15:33,710 --> 00:15:40,380
this is the original one with a kind of

301
00:15:36,810 --> 00:15:41,790
cage made of a product or two Co you

302
00:15:40,380 --> 00:15:44,430
take out the cage you understand how the

303
00:15:41,790 --> 00:15:46,500
chips is made of its out every type of

304
00:15:44,430 --> 00:15:47,939
chipset that runs that point you can

305
00:15:46,500 --> 00:15:51,540
look at the data sheet try to figure out

306
00:15:47,940 --> 00:15:52,620
how it's connected with MCU so if you

307
00:15:51,540 --> 00:15:54,480
get all the different pins from the

308
00:15:52,620 --> 00:15:56,130
board and so on and so forth I try to

309
00:15:54,480 --> 00:16:02,190
understand how the communication looks

310
00:15:56,130 --> 00:16:03,870
like you can start tackling the the

311
00:16:02,190 --> 00:16:06,840
radio protocol by doing the reverse

312
00:16:03,870 --> 00:16:10,200
engineering of a signal so this is a

313
00:16:06,840 --> 00:16:12,300
tool called UNH unified radio acre is a

314
00:16:10,200 --> 00:16:15,930
tool that allows you to look into

315
00:16:12,300 --> 00:16:17,819
protocol radio protocol so you know you

316
00:16:15,930 --> 00:16:19,979
have the signal between it's

317
00:16:17,820 --> 00:16:21,840
transmitting over here and if you're

318
00:16:19,980 --> 00:16:27,270
smart enough you can see that there are

319
00:16:21,840 --> 00:16:31,790
four different lines here so each line

320
00:16:27,270 --> 00:16:34,199
is actually different frequency that the

321
00:16:31,790 --> 00:16:37,380
transmitter use to communicate a

322
00:16:34,200 --> 00:16:39,060
different symbol so since you have four

323
00:16:37,380 --> 00:16:41,130
of them you can understand that where

324
00:16:39,060 --> 00:16:44,910
are the symbols might be for example 1 1

325
00:16:41,130 --> 00:16:48,240
1 0 0 0 0 1 another things you can point

326
00:16:44,910 --> 00:16:51,990
out is that in the first part here of a

327
00:16:48,240 --> 00:16:54,390
of the packet only two layers or two

328
00:16:51,990 --> 00:16:56,040
frequency reuse or two symbols if you

329
00:16:54,390 --> 00:16:59,220
want while on the rest of the packet

330
00:16:56,040 --> 00:17:01,829
there are four symbol that are used so

331
00:16:59,220 --> 00:17:06,750
this already gives an idea of which kind

332
00:17:01,830 --> 00:17:09,690
of modulation has been chosen by by who

333
00:17:06,750 --> 00:17:11,459
develop the fever of each device of

334
00:17:09,690 --> 00:17:14,070
course we seem sizing again

335
00:17:11,459 --> 00:17:17,130
easy but it's not really easy so no Jana

336
00:17:14,069 --> 00:17:19,649
Janata will dig a bit deeper into this

337
00:17:17,130 --> 00:17:22,470
domain and what is more in reverse

338
00:17:19,650 --> 00:17:28,470
engineer can do to figure out how they

339
00:17:22,470 --> 00:17:31,200
the signal is made of so if anyone has

340
00:17:28,470 --> 00:17:33,000
kind of worked with STRs at this level I

341
00:17:31,200 --> 00:17:35,010
mean it can be very challenging right

342
00:17:33,000 --> 00:17:37,350
and you can get into situations where

343
00:17:35,010 --> 00:17:39,660
very quickly where you're looking at

344
00:17:37,350 --> 00:17:41,939
signals but you really don't have any

345
00:17:39,660 --> 00:17:43,530
confirmation that what you've decoded or

346
00:17:41,940 --> 00:17:45,690
that what you're looking at is correct

347
00:17:43,530 --> 00:17:46,600
and you may have to go through lots of

348
00:17:45,690 --> 00:17:48,490
different iteration

349
00:17:46,600 --> 00:17:51,189
and testing and trials to kind of

350
00:17:48,490 --> 00:17:53,700
understand that you're on the right path

351
00:17:51,190 --> 00:17:56,590
and it's easy to take wrong paths right

352
00:17:53,700 --> 00:17:59,559
you know is this noise is this data does

353
00:17:56,590 --> 00:18:01,928
this look right you know when it's all

354
00:17:59,559 --> 00:18:04,120
correct it will work but if something is

355
00:18:01,929 --> 00:18:06,100
just slightly wrong it won't right so

356
00:18:04,120 --> 00:18:10,418
what are some other techniques we can

357
00:18:06,100 --> 00:18:12,668
use right and as mentioned you know many

358
00:18:10,419 --> 00:18:14,890
times radio chips are used and lots of

359
00:18:12,669 --> 00:18:18,669
times they have simple serial interfaces

360
00:18:14,890 --> 00:18:21,940
like spy and others and it makes sense

361
00:18:18,669 --> 00:18:24,700
that anything that can happen on the

362
00:18:21,940 --> 00:18:28,230
radio any state any messages transmitted

363
00:18:24,700 --> 00:18:31,000
and received anything like this can is

364
00:18:28,230 --> 00:18:32,950
transmitted over spy right so if you can

365
00:18:31,000 --> 00:18:36,580
instrument spy you can always know the

366
00:18:32,950 --> 00:18:38,799
radio state right combine this with the

367
00:18:36,580 --> 00:18:41,020
fact that you can of course find data

368
00:18:38,799 --> 00:18:42,850
sheets for these parts and you can look

369
00:18:41,020 --> 00:18:45,010
at the spy registers and you can see

370
00:18:42,850 --> 00:18:46,990
that again all the configuration

371
00:18:45,010 --> 00:18:49,900
information is stored conveniently in

372
00:18:46,990 --> 00:18:55,120
registers right so again comparing that

373
00:18:49,900 --> 00:18:57,309
to reversing RF at the signal level this

374
00:18:55,120 --> 00:18:59,408
gives you very precise information about

375
00:18:57,309 --> 00:19:02,490
what frequency the radio is tuned to

376
00:18:59,409 --> 00:19:05,350
what sync words are being used what

377
00:19:02,490 --> 00:19:07,419
deviation amount for FSK would be used

378
00:19:05,350 --> 00:19:09,280
what kind of modulations are being used

379
00:19:07,419 --> 00:19:12,010
right so if you can instrument at this

380
00:19:09,280 --> 00:19:18,129
level you can save yourself some time

381
00:19:12,010 --> 00:19:20,169
right so we created a tool right we took

382
00:19:18,130 --> 00:19:23,110
a logic analyzer we took raw waveforms

383
00:19:20,169 --> 00:19:26,500
we converted them to spy right we looked

384
00:19:23,110 --> 00:19:29,110
at the register reads and writes but as

385
00:19:26,500 --> 00:19:31,000
you can imagine if you're kind of doing

386
00:19:29,110 --> 00:19:33,549
the kind of research we were with many

387
00:19:31,000 --> 00:19:35,530
different devices many different buttons

388
00:19:33,549 --> 00:19:37,418
you have many different states that you

389
00:19:35,530 --> 00:19:40,090
want to examine you might want to look

390
00:19:37,419 --> 00:19:42,070
at what happens when the device boots is

391
00:19:40,090 --> 00:19:44,260
there a pairing sequence is there crypto

392
00:19:42,070 --> 00:19:46,450
exchange what happens when the device is

393
00:19:44,260 --> 00:19:49,480
idle we saw things like heart beats and

394
00:19:46,450 --> 00:19:52,750
stuff so ultimately you have to do lots

395
00:19:49,480 --> 00:19:55,809
of analysis and reading spy reads and

396
00:19:52,750 --> 00:19:58,179
writes you know at this level of course

397
00:19:55,809 --> 00:20:00,190
can be very tedious right and so these

398
00:19:58,179 --> 00:20:03,879
are some examples of our kind of

399
00:20:00,190 --> 00:20:05,769
first first layer of tooling right you

400
00:20:03,879 --> 00:20:08,259
know you can see these are addresses and

401
00:20:05,769 --> 00:20:11,799
these are data but staring at this all

402
00:20:08,259 --> 00:20:14,379
day is gonna get very tedious right so

403
00:20:11,799 --> 00:20:16,149
what do you do right well luckily again

404
00:20:14,379 --> 00:20:16,959
in the data sheets all the registers are

405
00:20:16,149 --> 00:20:18,729
there right

406
00:20:16,960 --> 00:20:21,940
you can literally cut and paste all the

407
00:20:18,730 --> 00:20:23,649
names and make references to these

408
00:20:21,940 --> 00:20:27,129
registers in order to assist your

409
00:20:23,649 --> 00:20:29,789
decoding right and then once you have

410
00:20:27,129 --> 00:20:33,279
registered names then you can kind of

411
00:20:29,789 --> 00:20:36,610
build a system that's easier to read and

412
00:20:33,279 --> 00:20:39,370
easier to use right but still even with

413
00:20:36,610 --> 00:20:42,129
names you have hundreds of registers or

414
00:20:39,370 --> 00:20:44,949
thousands of register accesses and so it

415
00:20:42,129 --> 00:20:47,350
can be challenging right so again at

416
00:20:44,950 --> 00:20:50,710
this level this is an example when we

417
00:20:47,350 --> 00:20:52,059
applied some more decoding you know just

418
00:20:50,710 --> 00:20:54,940
even if you don't know anything about

419
00:20:52,059 --> 00:20:55,389
this radio you can kind of in Intuit

420
00:20:54,940 --> 00:20:57,549
that

421
00:20:55,389 --> 00:20:59,168
oh it's reading signal strength that

422
00:20:57,549 --> 00:21:01,418
something is happening with the radio

423
00:20:59,169 --> 00:21:04,120
it's going idle it's looking for the

424
00:21:01,419 --> 00:21:07,419
number of received bytes it's actually

425
00:21:04,120 --> 00:21:10,360
reading the bytes etc right so this

426
00:21:07,419 --> 00:21:16,299
would be easily identified as a receive

427
00:21:10,360 --> 00:21:18,039
loop right but again you're gonna still

428
00:21:16,299 --> 00:21:20,259
be digging through many many many

429
00:21:18,039 --> 00:21:23,289
accesses so what we decided to do is

430
00:21:20,259 --> 00:21:25,600
create an emulator right so we take the

431
00:21:23,289 --> 00:21:27,669
streaming set of spy operations and we

432
00:21:25,600 --> 00:21:30,969
emulate the register states that are

433
00:21:27,669 --> 00:21:33,730
described in the datasheet and of course

434
00:21:30,970 --> 00:21:35,679
default values for registers are also

435
00:21:33,730 --> 00:21:37,299
described in the data sheets so you know

436
00:21:35,679 --> 00:21:39,700
kind of the initial conditions that you

437
00:21:37,299 --> 00:21:41,889
need to apply to your emulator right and

438
00:21:39,700 --> 00:21:43,600
this is important because even between

439
00:21:41,889 --> 00:21:46,090
revisions of silicon and things like

440
00:21:43,600 --> 00:21:49,240
this default states can change meaning

441
00:21:46,090 --> 00:21:50,830
if a certain firmware is run on the same

442
00:21:49,240 --> 00:21:54,279
chip but a different revision you can

443
00:21:50,830 --> 00:21:55,870
get slightly different behaviors but we

444
00:21:54,279 --> 00:21:58,990
accounted for that by looking into the

445
00:21:55,870 --> 00:22:03,158
data sheets to find these defaults and

446
00:21:58,990 --> 00:22:05,620
of course dumping the state at any point

447
00:22:03,159 --> 00:22:07,330
is really key right and again this helps

448
00:22:05,620 --> 00:22:10,059
us to get to the point we want to be

449
00:22:07,330 --> 00:22:12,340
which is what is the what are the

450
00:22:10,059 --> 00:22:13,490
parameters of this signal at the time of

451
00:22:12,340 --> 00:22:16,389
transmission

452
00:22:13,490 --> 00:22:20,450
reception or any other point right so

453
00:22:16,390 --> 00:22:22,370
you can set triggers in this process and

454
00:22:20,450 --> 00:22:25,340
when you have a transmission you can

455
00:22:22,370 --> 00:22:27,290
dump the state right so this is an

456
00:22:25,340 --> 00:22:29,990
example of kind of what our emulator

457
00:22:27,290 --> 00:22:32,809
dump looked like you can see the

458
00:22:29,990 --> 00:22:34,520
configurations the various radio signal

459
00:22:32,809 --> 00:22:36,920
parameters are all captured here right

460
00:22:34,520 --> 00:22:38,870
here we have the values the number of

461
00:22:36,920 --> 00:22:40,940
reads that were performed and writes so

462
00:22:38,870 --> 00:22:43,250
you can kind of get an idea of how the

463
00:22:40,940 --> 00:22:45,080
software is working if certain registers

464
00:22:43,250 --> 00:22:52,910
are being accessed or if they're not and

465
00:22:45,080 --> 00:22:54,620
things like that right so we also we had

466
00:22:52,910 --> 00:22:59,090
the expertise to work in the SDR field

467
00:22:54,620 --> 00:23:02,120
so we created new radio blocks to

468
00:22:59,090 --> 00:23:03,500
emulate the protocols that we were

469
00:23:02,120 --> 00:23:06,500
interested and this is just kind of an

470
00:23:03,500 --> 00:23:10,280
example and one thing we like to do also

471
00:23:06,500 --> 00:23:12,380
is to use stuff like zmq to be able to

472
00:23:10,280 --> 00:23:16,690
push messages in and out from other

473
00:23:12,380 --> 00:23:19,100
Python and modules and other tools right

474
00:23:16,690 --> 00:23:21,230
so and this is kind of an example of

475
00:23:19,100 --> 00:23:23,240
types of messages we would take right

476
00:23:21,230 --> 00:23:25,100
it's just a simple Python dictionary

477
00:23:23,240 --> 00:23:27,860
where it says we want the preamble to be

478
00:23:25,100 --> 00:23:29,840
a z' we want the sync word to be this we

479
00:23:27,860 --> 00:23:30,620
want the address field to be this and

480
00:23:29,840 --> 00:23:32,928
the Paila

481
00:23:30,620 --> 00:23:35,090
we wanted to transmit etc right so it's

482
00:23:32,929 --> 00:23:38,150
kind of a pretty simple interface but it

483
00:23:35,090 --> 00:23:43,879
allows you more interactivity with more

484
00:23:38,150 --> 00:23:45,950
tools from new radio so we plug this all

485
00:23:43,880 --> 00:23:47,809
together right and ultimately what that

486
00:23:45,950 --> 00:23:49,370
what we have now with all of this

487
00:23:47,809 --> 00:23:52,790
assembled together is we can process

488
00:23:49,370 --> 00:23:55,010
waveforms off the spy bus but it meant

489
00:23:52,790 --> 00:23:57,080
to our emulator create messages during

490
00:23:55,010 --> 00:23:59,179
transmit and reception pass those

491
00:23:57,080 --> 00:24:01,520
messages into the new radio and have an

492
00:23:59,179 --> 00:24:03,350
actual signal over-the-air right so

493
00:24:01,520 --> 00:24:05,510
literally you could attach probes to a

494
00:24:03,350 --> 00:24:07,790
physical device and have a companion

495
00:24:05,510 --> 00:24:12,830
software radio acting just like the

496
00:24:07,790 --> 00:24:14,750
target radio analyzing so one of the key

497
00:24:12,830 --> 00:24:16,250
benefits of this is since it's all in

498
00:24:14,750 --> 00:24:18,260
software now you can instrument it at

499
00:24:16,250 --> 00:24:20,660
any layer if your modulation isn't

500
00:24:18,260 --> 00:24:22,820
correct or you're having some problems

501
00:24:20,660 --> 00:24:25,690
or you want to look deeper into how

502
00:24:22,820 --> 00:24:27,100
protocol is working again you have

503
00:24:25,690 --> 00:24:29,169
software in front of you and then you

504
00:24:27,100 --> 00:24:33,639
can instrument it and inspect debug

505
00:24:29,169 --> 00:24:35,799
change and at this point too we had kind

506
00:24:33,639 --> 00:24:38,590
of a global team with limited devices so

507
00:24:35,799 --> 00:24:40,360
I did a lot of this work from logs and

508
00:24:38,590 --> 00:24:43,750
spy captures and data sheets and I never

509
00:24:40,360 --> 00:24:48,459
actually touched a device during the

510
00:24:43,750 --> 00:24:50,620
process of building the emulator so this

511
00:24:48,460 --> 00:24:53,860
is just an example example there's some

512
00:24:50,620 --> 00:24:55,779
logs and triggers and we instantiate the

513
00:24:53,860 --> 00:25:01,449
emulator and it runs until the

514
00:24:55,779 --> 00:25:04,000
transmitted and just breaks and this is

515
00:25:01,450 --> 00:25:05,409
a more complicated view I realize it's

516
00:25:04,000 --> 00:25:07,750
hard to read but it's kind of there for

517
00:25:05,409 --> 00:25:11,470
reference but this is a set of standard

518
00:25:07,750 --> 00:25:14,110
new radio blocks that I used in order to

519
00:25:11,470 --> 00:25:16,919
recreate the radio with the exception of

520
00:25:14,110 --> 00:25:19,750
a couple ones we have some specific

521
00:25:16,919 --> 00:25:22,480
decoding which is done for the protocol

522
00:25:19,750 --> 00:25:25,539
and then the new radio also didn't have

523
00:25:22,480 --> 00:25:27,279
a pre-canned way of demodulating for FSK

524
00:25:25,539 --> 00:25:33,129
so we implemented implemented this as

525
00:25:27,279 --> 00:25:35,769
well and then Fetty is going to talk a

526
00:25:33,129 --> 00:25:38,250
little bit more about the reversing

527
00:25:35,769 --> 00:25:43,450
process Thank You Jonathan

528
00:25:38,250 --> 00:25:46,299
hi everyone so if you paid enough

529
00:25:43,450 --> 00:25:48,580
attention we haven't told you how we

530
00:25:46,299 --> 00:25:50,529
figured the pay low structure yet we

531
00:25:48,580 --> 00:25:55,269
told you we figure it out we told you we

532
00:25:50,529 --> 00:25:57,360
could figure out the CRC and you know

533
00:25:55,269 --> 00:26:00,730
but we haven't told you how we did it

534
00:25:57,360 --> 00:26:04,389
all we knew at this point in time was

535
00:26:00,730 --> 00:26:08,139
that we had the CC 11:20 which is not

536
00:26:04,389 --> 00:26:09,668
very different from the CC 1101 but

537
00:26:08,139 --> 00:26:12,969
enough different to make it very very

538
00:26:09,669 --> 00:26:18,250
difficult to use the 1101 for talking to

539
00:26:12,970 --> 00:26:20,860
the 1120 and using Jonathan's emulator

540
00:26:18,250 --> 00:26:22,899
we were able to find out what was the

541
00:26:20,860 --> 00:26:25,149
configuration of the radio before the

542
00:26:22,899 --> 00:26:27,518
transmission so we could tell among the

543
00:26:25,149 --> 00:26:30,729
other things that for example if you

544
00:26:27,519 --> 00:26:33,159
open the datasheet you can tell that

545
00:26:30,730 --> 00:26:36,369
it's using standard packet format so

546
00:26:33,159 --> 00:26:38,259
that's already some good news right but

547
00:26:36,369 --> 00:26:39,159
still what we really want to figure out

548
00:26:38,259 --> 00:26:42,880
is what

549
00:26:39,160 --> 00:26:44,770
in there because this CRC is not the CRC

550
00:26:42,880 --> 00:26:47,500
that Marco was talking about this is a

551
00:26:44,770 --> 00:26:50,379
CRC that is inserted automatically by

552
00:26:47,500 --> 00:26:52,660
the transmitter right and is calculated

553
00:26:50,380 --> 00:26:55,240
on the data field on the length address

554
00:26:52,660 --> 00:26:58,780
and sync word if they're used right and

555
00:26:55,240 --> 00:27:00,760
it's removed in transmission sorry in

556
00:26:58,780 --> 00:27:02,470
reader when it's received and this was

557
00:27:00,760 --> 00:27:04,780
one of the things that caused some

558
00:27:02,470 --> 00:27:07,060
trouble I remember that we were replying

559
00:27:04,780 --> 00:27:09,610
with a radio we were replying the

560
00:27:07,060 --> 00:27:11,440
basically the spy logs right the data

561
00:27:09,610 --> 00:27:14,469
that was pushed onto the transmission

562
00:27:11,440 --> 00:27:17,140
FIFO and we wouldn't see any activity on

563
00:27:14,470 --> 00:27:19,570
the radio sorry the the receiver would

564
00:27:17,140 --> 00:27:21,670
not pick it up so we we tried multiple

565
00:27:19,570 --> 00:27:23,200
times maybe the strength is not enough

566
00:27:21,670 --> 00:27:24,490
maybe we're missing something the

567
00:27:23,200 --> 00:27:25,210
preamble is not right we tried

568
00:27:24,490 --> 00:27:27,130
everything

569
00:27:25,210 --> 00:27:29,740
and then at some point we looked at the

570
00:27:27,130 --> 00:27:33,130
you know the datasheet and say oh it's

571
00:27:29,740 --> 00:27:34,750
removed by the receiver and inserted

572
00:27:33,130 --> 00:27:36,700
automatically in transmissions so that's

573
00:27:34,750 --> 00:27:39,460
why we don't see it on the spy right

574
00:27:36,700 --> 00:27:42,550
what you send on the spy is basically

575
00:27:39,460 --> 00:27:44,920
just the the data and you address in the

576
00:27:42,550 --> 00:27:47,169
length right and then the radio will you

577
00:27:44,920 --> 00:27:53,500
know package it nicely with preamble and

578
00:27:47,170 --> 00:27:55,330
all the rest and just transmit it so how

579
00:27:53,500 --> 00:27:57,180
do we figure out this because this is

580
00:27:55,330 --> 00:28:00,189
the important part this is where the

581
00:27:57,180 --> 00:28:03,250
vendor has done customization this is

582
00:28:00,190 --> 00:28:06,760
where the vendor have hopefully baked in

583
00:28:03,250 --> 00:28:09,520
some security or try to you know do

584
00:28:06,760 --> 00:28:11,590
stuff and make sure that the protocol is

585
00:28:09,520 --> 00:28:13,510
obscure enough that nobody will have

586
00:28:11,590 --> 00:28:18,580
enough time to reverse it and figure it

587
00:28:13,510 --> 00:28:22,300
out right but we had enough time so we

588
00:28:18,580 --> 00:28:25,210
started by looking at the same

589
00:28:22,300 --> 00:28:28,080
transmission for the same command right

590
00:28:25,210 --> 00:28:31,570
over time and we noticed something that

591
00:28:28,080 --> 00:28:34,050
you may say oh this is just a payload

592
00:28:31,570 --> 00:28:36,460
you may say oh mat this looked like the

593
00:28:34,050 --> 00:28:38,830
like a rolling code right you see the

594
00:28:36,460 --> 00:28:41,350
first the first bite right it's rolling

595
00:28:38,830 --> 00:28:44,800
it's counting up and then the rest of

596
00:28:41,350 --> 00:28:48,429
the data looks kind of different all the

597
00:28:44,800 --> 00:28:51,490
time it is different all the time so we

598
00:28:48,430 --> 00:28:52,690
can aware okay wait reply attack is

599
00:28:51,490 --> 00:28:54,809
working

600
00:28:52,690 --> 00:28:57,489
but the packets are all different and

601
00:28:54,809 --> 00:28:59,830
then I see a progressive number the

602
00:28:57,489 --> 00:29:01,479
first field what what's going on here is

603
00:28:59,830 --> 00:29:06,580
it rolling code this is not rolling code

604
00:29:01,479 --> 00:29:09,909
right so we took long long captures like

605
00:29:06,580 --> 00:29:11,590
we you know just shorted the all the

606
00:29:09,909 --> 00:29:13,649
switches and kept the logic analyzer

607
00:29:11,590 --> 00:29:16,959
attached to the bus for like minutes

608
00:29:13,649 --> 00:29:19,059
until we exhausted the the search space

609
00:29:16,960 --> 00:29:23,499
basically of this first byte until we

610
00:29:19,059 --> 00:29:25,960
got all the you know FF numbers and then

611
00:29:23,499 --> 00:29:29,440
we decided to do the opposite right we

612
00:29:25,960 --> 00:29:31,539
noticed that if we fix if we you know

613
00:29:29,440 --> 00:29:33,849
short all the payloads that we got for

614
00:29:31,539 --> 00:29:36,220
all the commands and keep the the first

615
00:29:33,849 --> 00:29:38,349
byte fixed we also notice that something

616
00:29:36,220 --> 00:29:40,149
else is remaining fixed not not really

617
00:29:38,349 --> 00:29:42,009
everything like you see there are some

618
00:29:40,149 --> 00:29:44,978
differences here but you see that there

619
00:29:42,009 --> 00:29:47,320
are four bytes here that are kind of

620
00:29:44,979 --> 00:29:50,559
interesting right so we isolated that

621
00:29:47,320 --> 00:29:54,158
the first byte was sequential right but

622
00:29:50,559 --> 00:29:56,918
we could kind of find versions so to

623
00:29:54,159 --> 00:30:05,080
speak of the same of the same commands

624
00:29:56,919 --> 00:30:06,669
right so we were going somewhere the

625
00:30:05,080 --> 00:30:13,359
clicker is not going anywhere

626
00:30:06,669 --> 00:30:15,220
Marko's okay okay so those four bytes

627
00:30:13,359 --> 00:30:18,220
looked interesting right

628
00:30:15,220 --> 00:30:20,259
they look interesting because if we go

629
00:30:18,220 --> 00:30:23,200
back and we open up the cage and we look

630
00:30:20,259 --> 00:30:25,629
in the back of the other receiver or the

631
00:30:23,200 --> 00:30:32,679
transmitter here we find something that

632
00:30:25,629 --> 00:30:35,109
reads 2010 778 so maybe it's a pairing

633
00:30:32,679 --> 00:30:37,809
code maybe it's four byte I mean it's

634
00:30:35,109 --> 00:30:39,999
written one raw we don't know separators

635
00:30:37,809 --> 00:30:42,849
but it looks like four bytes of stuff

636
00:30:39,999 --> 00:30:45,399
right and it's constant right sort of

637
00:30:42,849 --> 00:30:53,289
constant with the same let's call it

638
00:30:45,399 --> 00:30:55,359
sequential ID or seed okay so we we

639
00:30:53,289 --> 00:30:55,809
reconfigure the transmitter and the

640
00:30:55,359 --> 00:30:58,178
receiver

641
00:30:55,809 --> 00:31:00,460
they have USB ports you can reprogram

642
00:30:58,179 --> 00:31:02,649
the pairing code just in case you want

643
00:31:00,460 --> 00:31:05,080
to you know change your password every

644
00:31:02,649 --> 00:31:06,639
week in your Korean controller or

645
00:31:05,080 --> 00:31:08,409
industrial controller you can

646
00:31:06,640 --> 00:31:11,290
change the pairing code on both receiver

647
00:31:08,410 --> 00:31:14,440
and transmitter so we left one of them

648
00:31:11,290 --> 00:31:16,270
set to the default one and since we

649
00:31:14,440 --> 00:31:18,310
don't know anything about crypto I don't

650
00:31:16,270 --> 00:31:21,610
know anything about crypto I set the

651
00:31:18,310 --> 00:31:23,050
other one to zero right I did the say we

652
00:31:21,610 --> 00:31:24,580
did the same thing on another receiver

653
00:31:23,050 --> 00:31:26,830
transmitter and we set everything to 0

654
00:31:24,580 --> 00:31:31,330
let's see what happens right let's see

655
00:31:26,830 --> 00:31:34,350
if we can figure out something he if we

656
00:31:31,330 --> 00:31:37,570
lower the same packets with the same

657
00:31:34,350 --> 00:31:40,810
sequential ID taken in on to two

658
00:31:37,570 --> 00:31:43,600
different configuration you see that you

659
00:31:40,810 --> 00:31:47,169
can you can unmask basically the pairing

660
00:31:43,600 --> 00:31:49,330
code if you know how this might be

661
00:31:47,170 --> 00:31:51,670
called please tell me because I don't

662
00:31:49,330 --> 00:31:53,740
know it I mean we couldn't figure out it

663
00:31:51,670 --> 00:31:55,450
it just looks like a shift register

664
00:31:53,740 --> 00:31:57,910
something if you look at all the payload

665
00:31:55,450 --> 00:32:00,130
but you couldn't figure out a name so we

666
00:31:57,910 --> 00:32:03,490
found out the second for the remaining

667
00:32:00,130 --> 00:32:05,680
four bytes are pairing code encrypted or

668
00:32:03,490 --> 00:32:09,310
office gated with some rolling mechanism

669
00:32:05,680 --> 00:32:10,930
of some sort there's an error in the

670
00:32:09,310 --> 00:32:12,639
slide what says pairing code it's

671
00:32:10,930 --> 00:32:15,370
actually the command because if you look

672
00:32:12,640 --> 00:32:18,280
there in the remaining four last four

673
00:32:15,370 --> 00:32:20,860
sorry four bytes

674
00:32:18,280 --> 00:32:24,010
what you have is that you know this is

675
00:32:20,860 --> 00:32:27,580
0-1 somewhere okay we found that every

676
00:32:24,010 --> 00:32:29,050
time we were pressing button x1 look at

677
00:32:27,580 --> 00:32:31,840
this column here every time we were

678
00:32:29,050 --> 00:32:35,770
pressing X 1 we would see 0 1 here

679
00:32:31,840 --> 00:32:38,620
except for those but we were confused by

680
00:32:35,770 --> 00:32:41,500
this as well but we found that these

681
00:32:38,620 --> 00:32:43,989
were heartbeat signals that every once

682
00:32:41,500 --> 00:32:46,210
in awhile the transmitter would send so

683
00:32:43,990 --> 00:32:48,610
that's our zero command right then there

684
00:32:46,210 --> 00:32:50,650
is the one command then if you go around

685
00:32:48,610 --> 00:32:54,699
your numerate all of them you find out

686
00:32:50,650 --> 00:32:56,920
that in that position if you ignore 0 1

687
00:32:54,700 --> 00:32:59,920
0 2 0 3 0 4 and so on

688
00:32:56,920 --> 00:33:03,510
you get all the commands selectively so

689
00:32:59,920 --> 00:33:07,660
you can write your own package basically

690
00:33:03,510 --> 00:33:09,820
so this gives us I wouldn't call it a

691
00:33:07,660 --> 00:33:12,160
different attack it's more like a

692
00:33:09,820 --> 00:33:13,780
different attack primitive like we could

693
00:33:12,160 --> 00:33:16,360
re-implemented of the attacks that we

694
00:33:13,780 --> 00:33:16,870
have shown before including the do s and

695
00:33:16,360 --> 00:33:19,209
so on

696
00:33:16,870 --> 00:33:20,399
using this command injection primitive

697
00:33:19,210 --> 00:33:24,510
which is a little more

698
00:33:20,400 --> 00:33:27,540
you know fine and selective so once you

699
00:33:24,510 --> 00:33:29,430
have one packet or no packet and the

700
00:33:27,540 --> 00:33:31,620
pairing code you can figure out what the

701
00:33:29,430 --> 00:33:37,010
packet can be and you can forge your own

702
00:33:31,620 --> 00:33:39,840
commands luckily these devices I said

703
00:33:37,010 --> 00:33:42,120
transmits heartbeat signals every two

704
00:33:39,840 --> 00:33:43,649
seconds right so you get very easily you

705
00:33:42,120 --> 00:33:46,530
can capture one packet that's all you

706
00:33:43,650 --> 00:33:48,060
need right you are in the range you get

707
00:33:46,530 --> 00:33:50,399
one packet you can forge every other

708
00:33:48,060 --> 00:33:52,470
packet okay you create a server brain

709
00:33:50,400 --> 00:33:54,990
Bowl table so to speak

710
00:33:52,470 --> 00:33:57,030
so we reimplemented the e stop abuse and

711
00:33:54,990 --> 00:34:01,190
we implemented another attack that we

712
00:33:57,030 --> 00:34:04,740
haven't spoken about it yet very briefly

713
00:34:01,190 --> 00:34:07,830
these devices some vendors offer what is

714
00:34:04,740 --> 00:34:10,380
called repairing mechanism that lets say

715
00:34:07,830 --> 00:34:12,569
that you want to have to crane operators

716
00:34:10,380 --> 00:34:15,810
or two machine operators with two

717
00:34:12,570 --> 00:34:19,350
different and independent transmitters

718
00:34:15,810 --> 00:34:21,090
pair to the same remote sorry to the

719
00:34:19,350 --> 00:34:23,610
same receiver you don't want to climb up

720
00:34:21,090 --> 00:34:25,290
the crane and do you know repairing of

721
00:34:23,610 --> 00:34:27,570
everything right they offer a so called

722
00:34:25,290 --> 00:34:30,270
pairing mechanism by which pushing

723
00:34:27,570 --> 00:34:33,630
proper buttons you can put both of them

724
00:34:30,270 --> 00:34:35,820
in pairing mode right and then you push

725
00:34:33,630 --> 00:34:38,429
a certain sequence on the transmitter

726
00:34:35,820 --> 00:34:42,330
and it will send a sort of a seed right

727
00:34:38,429 --> 00:34:44,668
to complete the repairing some vendors

728
00:34:42,330 --> 00:34:47,100
do it right in the sense that they have

729
00:34:44,668 --> 00:34:49,408
physical buttons on both so you really

730
00:34:47,100 --> 00:34:52,469
have to be there if you want to start

731
00:34:49,409 --> 00:34:54,330
the pairing procedure other vendors all

732
00:34:52,469 --> 00:34:57,899
you have to do is to be there within the

733
00:34:54,330 --> 00:35:00,180
first four minutes from the boot and the

734
00:34:57,900 --> 00:35:03,120
receiver will accept pairing codes

735
00:35:00,180 --> 00:35:07,620
sorry pairing packets so you can either

736
00:35:03,120 --> 00:35:09,960
forge or replay a pairing packet and you

737
00:35:07,620 --> 00:35:11,339
hijack if you want you can even kick out

738
00:35:09,960 --> 00:35:13,050
the previous receiver because you can

739
00:35:11,340 --> 00:35:15,840
you know send a different pairing code

740
00:35:13,050 --> 00:35:17,760
right so the legitimate operator won't

741
00:35:15,840 --> 00:35:25,320
be able to use their code anymore

742
00:35:17,760 --> 00:35:27,030
sorry their their transmitter anymore if

743
00:35:25,320 --> 00:35:29,550
we want to

744
00:35:27,030 --> 00:35:32,370
step up a little bit and introduce

745
00:35:29,550 --> 00:35:35,820
another type of attackers if you think

746
00:35:32,370 --> 00:35:38,430
of a state-sponsored level kind of

747
00:35:35,820 --> 00:35:42,330
attacks these devices as I said before

748
00:35:38,430 --> 00:35:43,980
come with USB port the reason is you

749
00:35:42,330 --> 00:35:47,850
want to be able to reflect the firmware

750
00:35:43,980 --> 00:35:50,460
if you send it into maintenance front to

751
00:35:47,850 --> 00:35:51,900
the system integrator you the system

752
00:35:50,460 --> 00:35:57,480
integrator might be able to reconfigure

753
00:35:51,900 --> 00:35:59,580
it some vendor even sell a tablet with

754
00:35:57,480 --> 00:36:01,770
the software for configuring thus these

755
00:35:59,580 --> 00:36:04,590
devices directly to the client so the

756
00:36:01,770 --> 00:36:06,590
client can purchase the USB dongle the

757
00:36:04,590 --> 00:36:08,430
iPad or whatever or a computer

758
00:36:06,590 --> 00:36:11,010
pre-configured to change all the

759
00:36:08,430 --> 00:36:12,750
parameters and the parameters can be I

760
00:36:11,010 --> 00:36:15,030
don't know I want to reconfigure the

761
00:36:12,750 --> 00:36:16,650
mapping of the buttons I want to change

762
00:36:15,030 --> 00:36:18,810
the frequency slightly because I want to

763
00:36:16,650 --> 00:36:21,060
avoid interference this I can change the

764
00:36:18,810 --> 00:36:24,810
pairing code so these are getting more

765
00:36:21,060 --> 00:36:27,299
and more flexible right and the vendor

766
00:36:24,810 --> 00:36:30,150
is giving out some of these flexibility

767
00:36:27,300 --> 00:36:32,760
as an added value to the market and

768
00:36:30,150 --> 00:36:34,650
people who want it I mean if if they

769
00:36:32,760 --> 00:36:37,790
didn't want them then then they wouldn't

770
00:36:34,650 --> 00:36:40,050
sell tablets pre-configured for

771
00:36:37,790 --> 00:36:43,529
reconfiguring there's these devices

772
00:36:40,050 --> 00:36:46,190
right so you can think that there might

773
00:36:43,530 --> 00:36:49,440
be some places in this supply chain

774
00:36:46,190 --> 00:36:53,460
where either one machine is compromised

775
00:36:49,440 --> 00:36:56,370
or one machine is malicious right and is

776
00:36:53,460 --> 00:36:59,820
trying to interfere with the flashing

777
00:36:56,370 --> 00:37:03,509
procedure so what we did is we wanted to

778
00:36:59,820 --> 00:37:06,420
assess to what extent this would be

779
00:37:03,510 --> 00:37:09,240
possible so for all the vendors that we

780
00:37:06,420 --> 00:37:12,090
have looked at into our lab we purchase

781
00:37:09,240 --> 00:37:15,689
also the dis dongles and we spend some

782
00:37:12,090 --> 00:37:18,570
times with his saga my colleague Philip

783
00:37:15,690 --> 00:37:20,790
was not he's not here is from the taipei

784
00:37:18,570 --> 00:37:23,340
office he spent quite a lot of time on

785
00:37:20,790 --> 00:37:25,650
this and what we did basically is we

786
00:37:23,340 --> 00:37:27,600
initiated the pairing procedure sorry

787
00:37:25,650 --> 00:37:30,390
the the configuration procedure from the

788
00:37:27,600 --> 00:37:33,509
software and we were able to intercept

789
00:37:30,390 --> 00:37:36,330
you just hook into you tap into the UART

790
00:37:33,510 --> 00:37:38,980
basically use logic analyzer then you

791
00:37:36,330 --> 00:37:42,279
decode the protocol

792
00:37:38,980 --> 00:37:46,390
you know what the MCU is in this case

793
00:37:42,280 --> 00:37:48,160
was a msp430 is fairly popular there's a

794
00:37:46,390 --> 00:37:51,190
simple bootloader and then there is a

795
00:37:48,160 --> 00:37:55,240
password which usually is used to

796
00:37:51,190 --> 00:37:57,099
protect from reading the firmware but

797
00:37:55,240 --> 00:37:59,169
you can also protect it from write in

798
00:37:57,099 --> 00:38:00,880
the firmware right and then on top of

799
00:37:59,170 --> 00:38:03,280
that you can do complex stuff at the

800
00:38:00,880 --> 00:38:05,109
firmware level such as integrity check

801
00:38:03,280 --> 00:38:08,050
verification you want to make sure that

802
00:38:05,109 --> 00:38:11,049
you know nobody can read your

803
00:38:08,050 --> 00:38:16,450
intellectual property we found out that

804
00:38:11,050 --> 00:38:18,910
if you look at here there's an AK and a

805
00:38:16,450 --> 00:38:20,919
K we try to supply the wrong password

806
00:38:18,910 --> 00:38:22,990
right that we were able to intercept

807
00:38:20,920 --> 00:38:25,420
during the initial programming procedure

808
00:38:22,990 --> 00:38:28,270
so they were sending the programming

809
00:38:25,420 --> 00:38:30,550
password in clear and the second one we

810
00:38:28,270 --> 00:38:32,500
try with the right password and then it

811
00:38:30,550 --> 00:38:34,780
responded with an AK so we were able to

812
00:38:32,500 --> 00:38:37,990
write firmware with no master-race

813
00:38:34,780 --> 00:38:40,329
protection we were also able to read the

814
00:38:37,990 --> 00:38:42,189
firmware we took a look at it with Ida

815
00:38:40,329 --> 00:38:44,980
and we found out that the integrity

816
00:38:42,190 --> 00:38:47,109
check procedure was not supported by

817
00:38:44,980 --> 00:38:49,780
hardware it was not supported by any

818
00:38:47,109 --> 00:38:52,210
form of even very weak and poorly

819
00:38:49,780 --> 00:38:54,520
implemented PKI it was just an integrity

820
00:38:52,210 --> 00:38:56,410
function baked into the firmware itself

821
00:38:54,520 --> 00:39:01,119
so I could write my own firmware that

822
00:38:56,410 --> 00:39:03,279
verifies its own validity ok on top of

823
00:39:01,119 --> 00:39:06,339
that even if you don't want to do all of

824
00:39:03,280 --> 00:39:08,530
these fancy stuff the software that is

825
00:39:06,339 --> 00:39:11,140
used to reprogram these devices do not

826
00:39:08,530 --> 00:39:12,250
have any form of authentication right so

827
00:39:11,140 --> 00:39:14,170
you don't want if you don't want to do

828
00:39:12,250 --> 00:39:16,750
fancy stuff you can just you can use

829
00:39:14,170 --> 00:39:18,369
auto it or auto IT to automate the

830
00:39:16,750 --> 00:39:20,319
clicking on a compromised computer and

831
00:39:18,369 --> 00:39:22,240
you can reprogram the device without any

832
00:39:20,319 --> 00:39:23,740
any kind of authentication needed

833
00:39:22,240 --> 00:39:29,259
there's no interaction it's completely

834
00:39:23,740 --> 00:39:31,060
unattended so yes it is feasible to

835
00:39:29,260 --> 00:39:34,020
backdoor this firm or if you want

836
00:39:31,060 --> 00:39:39,119
because the integrity is not guaranteed

837
00:39:34,020 --> 00:39:42,280
so we have malicious reprogram last part

838
00:39:39,119 --> 00:39:45,180
if you wear the armory booth I've demoed

839
00:39:42,280 --> 00:39:47,470
a small dongle device I've put together

840
00:39:45,180 --> 00:39:51,359
exactly because I I wasn't able to

841
00:39:47,470 --> 00:39:53,640
figure out how to talk to the CC 11001

842
00:39:51,360 --> 00:39:58,050
sorry to the FCC 11:20 using this

843
00:39:53,640 --> 00:40:00,660
ec-1101 but I want to introduce this

844
00:39:58,050 --> 00:40:05,040
topic from another angle right the angle

845
00:40:00,660 --> 00:40:06,690
is what if the attacker is not within

846
00:40:05,040 --> 00:40:09,180
the range what if the attacker is not

847
00:40:06,690 --> 00:40:11,700
able to stay within the one kilometer

848
00:40:09,180 --> 00:40:15,629
line-of-sight kind of range well the

849
00:40:11,700 --> 00:40:17,669
barrier from SDR to radio dongles - you

850
00:40:15,630 --> 00:40:19,740
know self-made device and things like

851
00:40:17,670 --> 00:40:22,020
that shows that it's going lower in

852
00:40:19,740 --> 00:40:24,359
normal nowhere so the threat model from

853
00:40:22,020 --> 00:40:26,670
this point of view is different than it

854
00:40:24,360 --> 00:40:30,330
was for example ten years ago probably

855
00:40:26,670 --> 00:40:33,630
when these devices were designed so now

856
00:40:30,330 --> 00:40:36,990
with very low investment and if you want

857
00:40:33,630 --> 00:40:41,460
very low effort new attackers come into

858
00:40:36,990 --> 00:40:44,819
into the scene so for example you can

859
00:40:41,460 --> 00:40:47,640
create a device such as this with an 3g

860
00:40:44,820 --> 00:40:50,760
modem or with a 2g modem that will allow

861
00:40:47,640 --> 00:40:52,490
an attacker to be you know local while

862
00:40:50,760 --> 00:40:55,290
being to the other side of the world

863
00:40:52,490 --> 00:40:56,759
right you put one transceiver on one

864
00:40:55,290 --> 00:40:58,110
side and another transceiver to the

865
00:40:56,760 --> 00:41:00,830
other side and you can you can bridge

866
00:40:58,110 --> 00:41:03,330
the two and then you can do fun stuff I

867
00:41:00,830 --> 00:41:07,170
want to give you a short demo if you

868
00:41:03,330 --> 00:41:15,960
haven't had a chance to come to our to

869
00:41:07,170 --> 00:41:18,480
our booth in while if you have any

870
00:41:15,960 --> 00:41:21,300
questions that come to your mind now

871
00:41:18,480 --> 00:41:29,310
feel free to ask Marco I'm going to

872
00:41:21,300 --> 00:41:31,970
Marco's not here anymore okay let's just

873
00:41:29,310 --> 00:41:31,970
put it on top

874
00:42:01,650 --> 00:42:12,340
okay alright so the experience is

875
00:42:08,980 --> 00:42:16,090
similar to our FCAT if you're familiar

876
00:42:12,340 --> 00:42:19,210
with RF cat the idea of the tool is that

877
00:42:16,090 --> 00:42:24,580
the radio is modular so you can change

878
00:42:19,210 --> 00:42:27,250
it I've I've abstracted the details of

879
00:42:24,580 --> 00:42:31,540
the radio driver and if you have ever

880
00:42:27,250 --> 00:42:33,490
used a CC 11 something chip you know how

881
00:42:31,540 --> 00:42:35,490
painful it might be to talk to these

882
00:42:33,490 --> 00:42:38,890
devices they have a very complex

883
00:42:35,490 --> 00:42:40,209
register register settings it's very

884
00:42:38,890 --> 00:42:42,580
difficult to figure out the right

885
00:42:40,210 --> 00:42:45,040
register setting so I try to abstract

886
00:42:42,580 --> 00:42:46,509
most of it and then trying to make it

887
00:42:45,040 --> 00:42:48,670
modular so that if you want to target

888
00:42:46,510 --> 00:42:51,160
another type of radio and you don't want

889
00:42:48,670 --> 00:42:53,050
to use the new radio you can detach the

890
00:42:51,160 --> 00:42:56,920
module and attach the right module and

891
00:42:53,050 --> 00:42:59,440
you should be kind of good to go it

892
00:42:56,920 --> 00:43:01,960
comes in two versions there's a serial

893
00:42:59,440 --> 00:43:04,510
version and the cellular version and the

894
00:43:01,960 --> 00:43:13,180
Wi-Fi version so you can you can bridge

895
00:43:04,510 --> 00:43:24,550
it as you want as you need okay okay let

896
00:43:13,180 --> 00:43:24,980
me just reset it for okay okay so now

897
00:43:24,550 --> 00:43:27,530
the

898
00:43:24,980 --> 00:43:36,440
is telling me that is set to the default

899
00:43:27,530 --> 00:43:38,510
setting and it's responding as Jonathan

900
00:43:36,440 --> 00:43:40,900
said the the registers figuring out the

901
00:43:38,510 --> 00:43:44,180
register setting requires either

902
00:43:40,900 --> 00:43:45,980
guessing a lot if you know the radio

903
00:43:44,180 --> 00:43:48,799
parameters and then using RF studio

904
00:43:45,980 --> 00:43:52,280
smart RF studio to figure out the

905
00:43:48,800 --> 00:43:54,589
registers or you tap into the spy if you

906
00:43:52,280 --> 00:43:58,880
can and then you know exactly what the

907
00:43:54,589 --> 00:44:02,900
values are so I've made this already so

908
00:43:58,880 --> 00:44:04,910
I will just copy and paste what the

909
00:44:02,900 --> 00:44:07,520
dongle is doing now is setting the

910
00:44:04,910 --> 00:44:11,810
registers one after another so now it's

911
00:44:07,520 --> 00:44:13,940
ready do you remember I told you before

912
00:44:11,810 --> 00:44:16,790
about the various commands we figured

913
00:44:13,940 --> 00:44:19,640
out that if you observe at a specific

914
00:44:16,790 --> 00:44:22,400
position if you observe the right value

915
00:44:19,640 --> 00:44:24,410
you can you can obtain another command

916
00:44:22,400 --> 00:44:31,640
all right so now I'm going to turn on

917
00:44:24,410 --> 00:44:34,399
the transmitter okay so I'm in a

918
00:44:31,640 --> 00:44:35,540
realistic scenario so to speak we're in

919
00:44:34,400 --> 00:44:38,960
a construction site

920
00:44:35,540 --> 00:44:40,819
the devices set there maybe no one is

921
00:44:38,960 --> 00:44:43,520
doing anything right I'm not lucky

922
00:44:40,819 --> 00:44:45,950
enough to be able to intercept the

923
00:44:43,520 --> 00:44:48,710
commander that I want to Forge

924
00:44:45,950 --> 00:44:57,950
all I need is a heartbeat right so this

925
00:44:48,710 --> 00:44:58,609
guy now is transmitting a heartbeat of

926
00:44:57,950 --> 00:45:00,618
course I could

927
00:44:58,609 --> 00:45:04,940
receive but now I don't want to receive

928
00:45:00,619 --> 00:45:07,759
all I want to do is to anytime I see one

929
00:45:04,940 --> 00:45:09,680
packet I modified on the fly without

930
00:45:07,759 --> 00:45:11,029
going back and forth from the host to

931
00:45:09,680 --> 00:45:15,589
the dongle everything is happening on

932
00:45:11,029 --> 00:45:19,720
the dongle I write a rule that says look

933
00:45:15,589 --> 00:45:24,259
down here every time you see a packet

934
00:45:19,720 --> 00:45:28,759
modify it and at position eight make a

935
00:45:24,259 --> 00:45:31,249
sort of whatever is there with CMD + CMD

936
00:45:28,759 --> 00:45:34,339
in this case is x1 so you can create

937
00:45:31,249 --> 00:45:36,230
various rules x2 x3 you can create all

938
00:45:34,339 --> 00:45:38,630
of the library all of the library of

939
00:45:36,230 --> 00:45:40,670
commands that you want or just to

940
00:45:38,630 --> 00:45:43,220
recreate the scenario that Marko showed

941
00:45:40,670 --> 00:45:49,430
before with an emergency stop

942
00:45:43,220 --> 00:45:55,390
I can install hang on I haven't saved

943
00:45:49,430 --> 00:45:55,390
the East stop comment I have to paste it

944
00:45:55,509 --> 00:46:03,769
okay I'll just try again so I'm gonna

945
00:46:01,970 --> 00:46:06,470
tell the dongle that I want to have a

946
00:46:03,769 --> 00:46:09,529
packet modification rule such as this

947
00:46:06,470 --> 00:46:12,649
one so every time I I see a packet

948
00:46:09,529 --> 00:46:15,950
insert at position 7 the value that is

949
00:46:12,650 --> 00:46:19,160
there exhort with its top and then I

950
00:46:15,950 --> 00:46:21,558
started to repeat mode repeat mode is

951
00:46:19,160 --> 00:46:23,779
nice because every time it sees a packet

952
00:46:21,559 --> 00:46:26,960
it changes the packet and retransmitted

953
00:46:23,779 --> 00:46:30,920
right right away so it's perfect to

954
00:46:26,960 --> 00:46:32,509
create interactive protocols and it's

955
00:46:30,920 --> 00:46:34,849
kind of efficient because everything

956
00:46:32,509 --> 00:46:37,309
happens on the dongle so now it's in

957
00:46:34,849 --> 00:46:39,170
denial-of-service already and i'm trying

958
00:46:37,309 --> 00:46:42,589
to restart it but there's no way even if

959
00:46:39,170 --> 00:46:44,749
i keep the start button pressed kind of

960
00:46:42,589 --> 00:46:47,420
works but doesn't because every time it

961
00:46:44,749 --> 00:46:49,220
sees one packet is gonna burst five

962
00:46:47,420 --> 00:46:54,069
packets or how many packets you want to

963
00:46:49,220 --> 00:46:54,069
retransmit change the way you told it

964
00:46:56,140 --> 00:47:03,578
and of course I can create my data page

965
00:46:58,730 --> 00:47:07,099
of my database of command once I know

966
00:47:03,579 --> 00:47:08,780
the packets so I can do like I can

967
00:47:07,099 --> 00:47:12,530
restart

968
00:47:08,780 --> 00:47:20,590
I can restart it and then do I don't

969
00:47:12,530 --> 00:47:20,590
know x1 and times something like that

970
00:47:21,250 --> 00:47:34,940
okay so where were we

971
00:47:29,960 --> 00:47:39,500
ant okay this is probably the part that

972
00:47:34,940 --> 00:47:41,440
most of you would like to hear about we

973
00:47:39,500 --> 00:47:44,180
start with save the best for the last

974
00:47:41,440 --> 00:47:46,670
with of course we of course did a long

975
00:47:44,180 --> 00:47:49,370
responsible disclosure process and long

976
00:47:46,670 --> 00:47:52,040
because you can imagine that some of

977
00:47:49,370 --> 00:47:55,339
this vendor might not be ready to hear

978
00:47:52,040 --> 00:47:57,110
what we had for them simply like it

979
00:47:55,340 --> 00:47:58,780
happens for the embedded world in

980
00:47:57,110 --> 00:48:03,080
general and for industrial systems

981
00:47:58,780 --> 00:48:06,010
vendors in this space might not know

982
00:48:03,080 --> 00:48:09,350
what we're talking about but we had

983
00:48:06,010 --> 00:48:11,600
several mixed responses some of them

984
00:48:09,350 --> 00:48:15,830
said okay here is the patch I'll release

985
00:48:11,600 --> 00:48:18,799
it immediately some of them said no they

986
00:48:15,830 --> 00:48:21,110
didn't say anything they never responded

987
00:48:18,800 --> 00:48:23,510
some of them responded and say I will

988
00:48:21,110 --> 00:48:26,720
not fix it because it's by design and I

989
00:48:23,510 --> 00:48:29,690
want to keep it like this some of them

990
00:48:26,720 --> 00:48:31,609
said oh the product is end-of-life all

991
00:48:29,690 --> 00:48:33,890
right so I don't want to support it and

992
00:48:31,610 --> 00:48:36,410
the question here how long is the life

993
00:48:33,890 --> 00:48:39,859
like acceptable life for these products

994
00:48:36,410 --> 00:48:41,839
right one year two years 20 years we

995
00:48:39,860 --> 00:48:42,980
found products in on the field that were

996
00:48:41,840 --> 00:48:45,230
there for 20 years

997
00:48:42,980 --> 00:48:49,220
right what are the chances that they

998
00:48:45,230 --> 00:48:52,430
will they will get patched some vendors

999
00:48:49,220 --> 00:48:55,310
initially responded a bit harshly they

1000
00:48:52,430 --> 00:48:56,720
said maybe you should talk to our legal

1001
00:48:55,310 --> 00:49:00,410
office because we're thinking about

1002
00:48:56,720 --> 00:49:03,350
suing you but then we kind of you know

1003
00:49:00,410 --> 00:49:06,020
found a way to talk to them and at the

1004
00:49:03,350 --> 00:49:08,960
end of the day they patched so great

1005
00:49:06,020 --> 00:49:11,090
work from CDI or colleagues from trend

1006
00:49:08,960 --> 00:49:14,090
that went through this pretty painful

1007
00:49:11,090 --> 00:49:18,010
but successful disclosure problem

1008
00:49:14,090 --> 00:49:21,509
disclosure yeah problem Freudian slips

1009
00:49:18,010 --> 00:49:23,579
conclusions so we found several pair

1010
00:49:21,509 --> 00:49:26,669
vulnerabilities all of them can be

1011
00:49:23,579 --> 00:49:29,429
summarized under the umbrella of there's

1012
00:49:26,669 --> 00:49:31,319
no encryption whatsoever if there is a

1013
00:49:29,429 --> 00:49:32,999
rolling code because we can call it a

1014
00:49:31,319 --> 00:49:35,159
rolling code the one we saw before

1015
00:49:32,999 --> 00:49:37,319
it wasn't enforced at all we were able

1016
00:49:35,159 --> 00:49:39,209
to forge packet so the receiver is not

1017
00:49:37,319 --> 00:49:42,029
enforcing the rolling the

1018
00:49:39,209 --> 00:49:43,979
synchronization there was no protection

1019
00:49:42,029 --> 00:49:48,449
in the vendors that we have examined at

1020
00:49:43,979 --> 00:49:50,189
a formal level and so we hope that you

1021
00:49:48,449 --> 00:49:52,499
know with this talk and similar talks

1022
00:49:50,189 --> 00:49:55,979
we'll be able to raise a little bit the

1023
00:49:52,499 --> 00:49:59,519
bar we're very happy that we were able

1024
00:49:55,979 --> 00:50:03,928
to gain the attention of standardisation

1025
00:49:59,519 --> 00:50:07,198
committee in Germany that said that they

1026
00:50:03,929 --> 00:50:11,939
were using our work to push for an

1027
00:50:07,199 --> 00:50:15,179
amendment in the requirement for these

1028
00:50:11,939 --> 00:50:17,519
devices to be able to operate in real

1029
00:50:15,179 --> 00:50:20,489
environments in the same way they have

1030
00:50:17,519 --> 00:50:22,468
to have an emergency button they should

1031
00:50:20,489 --> 00:50:25,079
not be vulnerable to a reply attack at

1032
00:50:22,469 --> 00:50:31,589
least reply attack right that's a bare

1033
00:50:25,079 --> 00:50:36,179
minimum to us so for vendors you see a

1034
00:50:31,589 --> 00:50:38,099
shooting use this for vendors what we

1035
00:50:36,179 --> 00:50:40,229
hope that we will see in the future is

1036
00:50:38,099 --> 00:50:41,939
that they will use open and standard

1037
00:50:40,229 --> 00:50:46,138
technologies there are some vendors that

1038
00:50:41,939 --> 00:50:48,689
use ble for instance at least use

1039
00:50:46,139 --> 00:50:50,699
rolling code even though it's not secure

1040
00:50:48,689 --> 00:50:52,678
but at least these devices will be more

1041
00:50:50,699 --> 00:50:56,399
secure than your garage door or air as

1042
00:50:52,679 --> 00:51:00,539
the cure of your garage door opener use

1043
00:50:56,399 --> 00:51:03,239
some protection on the firmware and make

1044
00:51:00,539 --> 00:51:07,739
sure that you educate your users for

1045
00:51:03,239 --> 00:51:09,959
maintaining them and on the user side we

1046
00:51:07,739 --> 00:51:14,189
hope that they will be able to you know

1047
00:51:09,959 --> 00:51:18,089
promote vendors to you know use updates

1048
00:51:14,189 --> 00:51:20,879
and make sure that will will apply so

1049
00:51:18,089 --> 00:51:23,159
with this I think we should you know all

1050
00:51:20,880 --> 00:51:25,529
come back to stage for questions if you

1051
00:51:23,159 --> 00:51:28,139
guys have any if you're interested in

1052
00:51:25,529 --> 00:51:30,630
details we have two versions of the

1053
00:51:28,139 --> 00:51:32,699
paper we have the white paper by Trend

1054
00:51:30,630 --> 00:51:35,390
Micro Research and we have the academic

1055
00:51:32,699 --> 00:51:38,900
paper that will be presented in

1056
00:51:35,390 --> 00:51:42,950
June at Denver in göteborg her in Sweden

1057
00:51:38,900 --> 00:51:49,670
please make sure you you come thank you

1058
00:51:42,950 --> 00:51:51,680
very much thank you thank you so much

1059
00:51:49,670 --> 00:52:00,220
for your presentation are there any

1060
00:51:51,680 --> 00:52:04,009
questions yes Marcus he's going to be a

1061
00:52:00,220 --> 00:52:06,439
super technical question no no it won't

1062
00:52:04,010 --> 00:52:11,990
be thanks for the great presentation

1063
00:52:06,440 --> 00:52:14,960
guys my question is I like the reversing

1064
00:52:11,990 --> 00:52:19,609
approach on spy end so my question is

1065
00:52:14,960 --> 00:52:21,019
you mentioned you had access to the from

1066
00:52:19,609 --> 00:52:23,240
our update process

1067
00:52:21,019 --> 00:52:26,720
why didn't you approach that from the

1068
00:52:23,240 --> 00:52:29,299
from the end of the trends meta or

1069
00:52:26,720 --> 00:52:35,240
receiver has to be some kind of

1070
00:52:29,299 --> 00:52:36,890
controller and you could get you didn't

1071
00:52:35,240 --> 00:52:39,828
choose to take the possibility to have a

1072
00:52:36,890 --> 00:52:42,700
look at the application layer I guess

1073
00:52:39,829 --> 00:52:46,069
it's easier to start from this end

1074
00:52:42,700 --> 00:52:49,339
Phillip Phillip did it our our colleague

1075
00:52:46,069 --> 00:52:52,250
Phillip did it honestly he managed to

1076
00:52:49,339 --> 00:52:56,390
extract a firmer towards the you know

1077
00:52:52,250 --> 00:52:58,789
like 80% of this work and he confirmed

1078
00:52:56,390 --> 00:53:01,609
how the structure of the payload of that

1079
00:52:58,789 --> 00:53:08,029
particular vendor was made so we could

1080
00:53:01,609 --> 00:53:10,430
confirm that but not all vendors are you

1081
00:53:08,029 --> 00:53:12,410
know not leaving you know the not all

1082
00:53:10,430 --> 00:53:14,180
vendors are leaving on protection not no

1083
00:53:12,410 --> 00:53:16,038
protection on the device so for this

1084
00:53:14,180 --> 00:53:18,348
particular one we couldn't we couldn't

1085
00:53:16,039 --> 00:53:20,150
extract it for more easily right we

1086
00:53:18,349 --> 00:53:22,400
couldn't interject the update procedure

1087
00:53:20,150 --> 00:53:24,670
because we didn't have the firm or

1088
00:53:22,400 --> 00:53:27,650
itself all we had was the configuration

1089
00:53:24,670 --> 00:53:31,819
tool not a reprogramming tool right so

1090
00:53:27,650 --> 00:53:34,130
it's a mixed situation and also

1091
00:53:31,819 --> 00:53:35,990
ultimately we wanted to show that there

1092
00:53:34,130 --> 00:53:37,279
are multiple type of attackers the

1093
00:53:35,990 --> 00:53:38,990
attacker that can be you know very

1094
00:53:37,279 --> 00:53:40,640
physical so to speak on the on the

1095
00:53:38,990 --> 00:53:43,758
device the attacker can be just only

1096
00:53:40,640 --> 00:53:45,078
radio so we stressed a lot to make it

1097
00:53:43,759 --> 00:53:46,940
just with radio at the beginning and

1098
00:53:45,079 --> 00:53:48,110
then we went into spy and then towards

1099
00:53:46,940 --> 00:53:51,530
the end to the Fermilab

1100
00:53:48,110 --> 00:53:54,080
yeah and specifically in the protocols

1101
00:53:51,530 --> 00:53:56,570
we looked at the application layers part

1102
00:53:54,080 --> 00:53:58,370
of the payload wasn't so complex that it

1103
00:53:56,570 --> 00:54:01,550
wasn't obvious right or that we couldn't

1104
00:53:58,370 --> 00:54:03,950
reverse it now the one that fed ace well

1105
00:54:01,550 --> 00:54:05,840
that we spoke about with the X ORS and

1106
00:54:03,950 --> 00:54:07,879
keys that one was a little bit more

1107
00:54:05,840 --> 00:54:09,380
complicated but we were able to get it

1108
00:54:07,880 --> 00:54:12,200
without having to go through the process

1109
00:54:09,380 --> 00:54:14,750
of reversing but certainly there's going

1110
00:54:12,200 --> 00:54:21,310
to be situations where that will help

1111
00:54:14,750 --> 00:54:21,310
right okay are there any other questions

1112
00:54:23,950 --> 00:54:27,830
No

1113
00:54:25,190 --> 00:54:29,000
then I would like to ask for a big round

1114
00:54:27,830 --> 00:54:29,779
of applause again for these guys

1115
00:54:29,000 --> 00:54:36,299
presentation

1116
00:54:29,780 --> 00:54:36,299
[Applause]

1117
00:54:41,580 --> 00:54:43,640
you

