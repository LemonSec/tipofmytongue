1
00:00:26,890 --> 00:00:35,350
hello everyone today I'm just talk about

2
00:00:31,119 --> 00:00:39,540
how to automate either find the bugs in

3
00:00:35,350 --> 00:00:44,620
Windows 10 our topic is about logical

4
00:00:39,540 --> 00:00:48,790
privilege escalation bags first let me

5
00:00:44,620 --> 00:00:49,739
introduce ourselves we are all from

6
00:00:48,790 --> 00:00:53,140
Tencent

7
00:00:49,739 --> 00:00:56,790
Tencent is the name of a company for

8
00:00:53,140 --> 00:00:59,949
nobody works for any tensions and

9
00:00:56,790 --> 00:01:02,650
Tencent is also a largest social media

10
00:00:59,949 --> 00:01:04,870
and entertainment company in China well

11
00:01:02,650 --> 00:01:07,570
from tension a secret issue a new lab

12
00:01:04,870 --> 00:01:13,270
now we are just a focus on real world

13
00:01:07,570 --> 00:01:19,500
security research and I am win she here

14
00:01:13,270 --> 00:01:23,920
is my partner shooting I divide today's

15
00:01:19,500 --> 00:01:27,729
presentations to five steps the first I

16
00:01:23,920 --> 00:01:32,350
will introduce you the logical box in

17
00:01:27,729 --> 00:01:34,770
Windows turns systems services and then

18
00:01:32,350 --> 00:01:39,460
we'll do some case studies based on

19
00:01:34,770 --> 00:01:42,729
historical bags then we will know how to

20
00:01:39,460 --> 00:01:45,280
do back discovery and the automated is

21
00:01:42,730 --> 00:01:52,930
processing finally we'll do some works

22
00:01:45,280 --> 00:01:56,920
about exploit development so you may ask

23
00:01:52,930 --> 00:02:02,620
me why I choose logical backs the first

24
00:01:56,920 --> 00:02:05,590
is about stability so all of us knows a

25
00:02:02,620 --> 00:02:09,908
memory co-option bagus is not already

26
00:02:05,590 --> 00:02:12,879
stable with a 10-count wall or other

27
00:02:09,908 --> 00:02:16,120
competitions the competitor is just

28
00:02:12,879 --> 00:02:19,840
wrong their exploit again and again by

29
00:02:16,120 --> 00:02:23,760
say ODIs that is very euro and the

30
00:02:19,840 --> 00:02:27,730
signal why is it is very easy to exploit

31
00:02:23,760 --> 00:02:32,470
for there is many medications in Windows

32
00:02:27,730 --> 00:02:36,480
10 the day just a lack CFG te pasa are

33
00:02:32,470 --> 00:02:40,210
that is many mitigations true value is

34
00:02:36,480 --> 00:02:42,549
family asura found two caches virus

35
00:02:40,210 --> 00:02:44,640
and combine them together to game

36
00:02:42,550 --> 00:02:49,210
privilege escalations

37
00:02:44,640 --> 00:02:52,209
so what could not you best do that is

38
00:02:49,210 --> 00:02:54,070
the answer is or that memory corruption

39
00:02:52,210 --> 00:02:59,680
Paris could do that could you

40
00:02:54,070 --> 00:03:03,340
and including sandbox escape or code

41
00:02:59,680 --> 00:03:05,440
executions and privileges creations

42
00:03:03,340 --> 00:03:14,860
today we are mainly focus on privilege

43
00:03:05,440 --> 00:03:19,510
escalation backs so let's see the

44
00:03:14,860 --> 00:03:22,300
pictures the medium interpreter users

45
00:03:19,510 --> 00:03:25,750
who communicates with the system

46
00:03:22,300 --> 00:03:29,530
services and system service could do

47
00:03:25,750 --> 00:03:34,170
fire operations and the registry modify

48
00:03:29,530 --> 00:03:36,490
or to copy some handlers or to some deal

49
00:03:34,170 --> 00:03:46,079
operations just like a lot of some

50
00:03:36,490 --> 00:03:50,140
libraries or do some other scenes so for

51
00:03:46,080 --> 00:03:53,560
for examples we'll choose two ballasts

52
00:03:50,140 --> 00:03:55,239
for the kids studies the historical

53
00:03:53,560 --> 00:03:59,020
example we choose the aviary

54
00:03:55,240 --> 00:04:02,230
representives example one is about an

55
00:03:59,020 --> 00:04:05,320
arbitrary tsa rewrite back after we

56
00:04:02,230 --> 00:04:09,700
explore it we can gain full control of

57
00:04:05,320 --> 00:04:14,590
any fare we want the back to is just

58
00:04:09,700 --> 00:04:17,560
about arbitrary faerie bag and then

59
00:04:14,590 --> 00:04:20,560
contains the following problems the

60
00:04:17,560 --> 00:04:22,960
first way is a past elimination problems

61
00:04:20,560 --> 00:04:25,840
it's very you are in those

62
00:04:22,960 --> 00:04:34,090
vulnerabilities and the second of why is

63
00:04:25,840 --> 00:04:38,830
time of check and time of use and let's

64
00:04:34,090 --> 00:04:42,849
say the first bag is seen task scheduler

65
00:04:38,830 --> 00:04:45,370
service and when we call an LPC

66
00:04:42,850 --> 00:04:48,280
interfaces we could figure this of an

67
00:04:45,370 --> 00:04:49,550
abilities and the can control of any

68
00:04:48,280 --> 00:04:53,450
fail

69
00:04:49,550 --> 00:04:55,610
before analyze this part we need to know

70
00:04:53,450 --> 00:05:03,680
some fundamental knowledge ease about

71
00:04:55,610 --> 00:05:07,400
her a RPC and AOPA is called advanced

72
00:05:03,680 --> 00:05:12,980
local procedural cause which is a part

73
00:05:07,400 --> 00:05:16,400
of Windows IPC so ideal which called

74
00:05:12,980 --> 00:05:20,210
Microsoft in the interface definition

75
00:05:16,400 --> 00:05:26,179
language is a bridge between claims and

76
00:05:20,210 --> 00:05:27,650
a surveyor in LPC so that LPC becomes a

77
00:05:26,180 --> 00:05:30,740
bridge between the client and a server

78
00:05:27,650 --> 00:05:33,349
and a we could use the ideal to

79
00:05:30,740 --> 00:05:42,050
communicate with a system service and a

80
00:05:33,350 --> 00:05:46,220
co is function so how could we analyze

81
00:05:42,050 --> 00:05:50,480
those interfaces we need a tool named

82
00:05:46,220 --> 00:05:52,490
obviously V or it is a very strong and

83
00:05:50,480 --> 00:05:56,960
powerful tools that we could analyze

84
00:05:52,490 --> 00:06:00,200
those interfaces and also there you can

85
00:05:56,960 --> 00:06:04,370
see the futures the registered LPC

86
00:06:00,200 --> 00:06:06,770
interfaces is marked as green so that

87
00:06:04,370 --> 00:06:15,170
means we could just call it directly

88
00:06:06,770 --> 00:06:20,539
with ideal code and interfaces but this

89
00:06:15,170 --> 00:06:23,450
tools is not very beautiful in some ways

90
00:06:20,540 --> 00:06:26,060
because some of these have structure may

91
00:06:23,450 --> 00:06:29,180
be missing so that you need to do the

92
00:06:26,060 --> 00:06:31,880
reverse engineering by yourself with a

93
00:06:29,180 --> 00:06:35,060
top row and the fix that has structure

94
00:06:31,880 --> 00:06:43,640
when you are able to fix all 10

95
00:06:35,060 --> 00:06:46,700
structures this software could fix it so

96
00:06:43,640 --> 00:06:49,729
the problem is clear we need to find a

97
00:06:46,700 --> 00:06:53,270
targeted tol which is related to the

98
00:06:49,730 --> 00:06:56,390
help you see interfaces in a visa viewer

99
00:06:53,270 --> 00:06:57,650
and use Ida Pro to do the reverse

100
00:06:56,390 --> 00:07:00,260
engineering

101
00:06:57,650 --> 00:07:04,760
you should beware of the sensitive

102
00:07:00,260 --> 00:07:09,169
operations and some function call which

103
00:07:04,760 --> 00:07:15,860
is to say we grant the SL to some fail

104
00:07:09,169 --> 00:07:19,430
or if some fail for this one abilities

105
00:07:15,860 --> 00:07:22,910
we could see the interfaces in the

106
00:07:19,430 --> 00:07:27,949
target idea fails and we could have find

107
00:07:22,910 --> 00:07:31,430
its in the coyote affair and a reverse

108
00:07:27,949 --> 00:07:34,070
it to job university that your idea of

109
00:07:31,430 --> 00:07:38,930
code and you will find this collar is

110
00:07:34,070 --> 00:07:43,150
you to print DSL to torch Apfel the data

111
00:07:38,930 --> 00:07:48,260
structures just look like this it

112
00:07:43,150 --> 00:07:52,669
receives two parameters the first one is

113
00:07:48,260 --> 00:07:57,520
a pass and a second Y is a si si s TBL

114
00:07:52,669 --> 00:08:03,729
strings which is security descriptor for

115
00:07:57,520 --> 00:08:08,479
the FL and after a reverse engineering

116
00:08:03,729 --> 00:08:12,070
we find the string is just convert to

117
00:08:08,479 --> 00:08:18,860
the security descriptor for this DSL

118
00:08:12,070 --> 00:08:22,520
operations and if I were to use update

119
00:08:18,860 --> 00:08:23,560
functions to update the target fails the

120
00:08:22,520 --> 00:08:26,719
SAO

121
00:08:23,560 --> 00:08:31,760
so you can find if you use the

122
00:08:26,720 --> 00:08:33,919
cannulation bags to limit late the pass

123
00:08:31,760 --> 00:08:39,319
to task

124
00:08:33,919 --> 00:08:43,250
photos so how can we passage some of you

125
00:08:39,320 --> 00:08:46,480
may know we have some ways to reflect

126
00:08:43,250 --> 00:08:50,450
those file operations to another place

127
00:08:46,480 --> 00:08:53,800
but today we are talking about the

128
00:08:50,450 --> 00:08:56,920
technology behind them so

129
00:08:53,800 --> 00:09:05,639
Mike Posner shooting could you please

130
00:08:56,920 --> 00:09:10,920
share the details behind them yes yes

131
00:09:05,639 --> 00:09:18,519
there are three ways to do this Junction

132
00:09:10,920 --> 00:09:22,899
Harley ink and to a SMAP let's look at

133
00:09:18,519 --> 00:09:28,989
junction first windows powers or command

134
00:09:22,899 --> 00:09:37,029
name dough make link in CMD to make

135
00:09:28,989 --> 00:09:41,019
symbolic links this picture shows of

136
00:09:37,029 --> 00:09:43,540
this command we can use this augment G

137
00:09:41,019 --> 00:09:47,769
to make a directory Junction

138
00:09:43,540 --> 00:09:51,189
as the name says Junction is o is only

139
00:09:47,769 --> 00:09:54,489
create it only can be used for true

140
00:09:51,189 --> 00:09:58,748
directories can't create with file and

141
00:09:54,489 --> 00:10:02,589
directory or fell and fell but what

142
00:09:58,749 --> 00:10:06,269
happened in the make link command let's

143
00:10:02,589 --> 00:10:06,269
take a closer look

144
00:10:07,370 --> 00:10:15,740
okay this finger this figure shows the

145
00:10:11,160 --> 00:10:20,250
rewards code for the inflammation of the

146
00:10:15,740 --> 00:10:25,350
Macklin command we can see that it

147
00:10:20,250 --> 00:10:30,390
removes the NTFS control fail function

148
00:10:25,350 --> 00:10:35,310
to create a junction but what is the

149
00:10:30,390 --> 00:10:38,970
NTFS control well as we know the windows

150
00:10:35,310 --> 00:10:43,229
API to SL l control is used for

151
00:10:38,970 --> 00:10:47,640
communication with Colonel travels from

152
00:10:43,230 --> 00:10:51,750
user mode space in fact Demoiselle

153
00:10:47,640 --> 00:10:57,000
control we'll check the ioctl tab if the

154
00:10:51,750 --> 00:11:02,120
ioctl is FS CTL it William walk and he

155
00:10:57,000 --> 00:11:06,330
FS control fell function the NTFS

156
00:11:02,120 --> 00:11:13,410
control fell function is responsible for

157
00:11:06,330 --> 00:11:16,320
handing file system created requests it

158
00:11:13,410 --> 00:11:20,670
receives the panels from the user mode

159
00:11:16,320 --> 00:11:24,990
until create the airpipe exit and send

160
00:11:20,670 --> 00:11:28,800
it to the fastest in tower according to

161
00:11:24,990 --> 00:11:34,320
this figure we can see it in walk and he

162
00:11:28,800 --> 00:11:38,280
FS control fell with FS CTL said repass

163
00:11:34,320 --> 00:11:41,430
point control code to him the import

164
00:11:38,280 --> 00:11:47,370
power is associated with the control

165
00:11:41,430 --> 00:11:50,250
code when the control code is FS CTL

166
00:11:47,370 --> 00:11:57,089
said we pass quite the input power is a

167
00:11:50,250 --> 00:11:59,820
repast date power structure okay and

168
00:11:57,089 --> 00:12:03,060
there is a field named we passed a

169
00:11:59,820 --> 00:12:04,550
repast tag in the repast state powers

170
00:12:03,060 --> 00:12:07,279
crowd

171
00:12:04,550 --> 00:12:11,000
it can be said through different values

172
00:12:07,279 --> 00:12:14,060
but the most common will values are I

173
00:12:11,000 --> 00:12:19,100
alway past had a simple link and our

174
00:12:14,060 --> 00:12:22,640
repast tab mantra point let's took

175
00:12:19,100 --> 00:12:25,070
another look at the progress figure we

176
00:12:22,640 --> 00:12:29,240
can see that the aisle we passed tag

177
00:12:25,070 --> 00:12:32,170
match point tag was used when creating

178
00:12:29,240 --> 00:12:32,170
the junction

179
00:12:34,370 --> 00:12:41,360
the make link command also has a

180
00:12:36,860 --> 00:12:44,839
function to create simple link leaks it

181
00:12:41,360 --> 00:12:48,589
will realize our new windows API create

182
00:12:44,839 --> 00:12:52,459
a simple lead link the windows a peccary

183
00:12:48,589 --> 00:12:55,970
the symbolic link is located near

184
00:12:52,459 --> 00:13:00,138
Canopus about the RL and this figure

185
00:12:55,970 --> 00:13:03,350
shows the rewards code of each we can

186
00:13:00,139 --> 00:13:07,579
see create a symbolic link invoke the

187
00:13:03,350 --> 00:13:13,809
NTFS control fell with IO repast had a

188
00:13:07,579 --> 00:13:17,300
symbolic okay let's take a small summary

189
00:13:13,809 --> 00:13:21,680
there are two commonly used repast ever

190
00:13:17,300 --> 00:13:26,269
why is our repast ergo symbolic and the

191
00:13:21,680 --> 00:13:30,170
other is a repast head mod pointer when

192
00:13:26,269 --> 00:13:32,779
you awoke her NTFS profile with our

193
00:13:30,170 --> 00:13:36,378
repast Hephzibah link the filesystem

194
00:13:32,779 --> 00:13:41,029
trailer will create the NTFS symbolic

195
00:13:36,379 --> 00:13:45,470
link and it can be used for file or

196
00:13:41,029 --> 00:13:49,189
directory we invoke NTFS control fairies

197
00:13:45,470 --> 00:13:52,850
will reap a segment pointer the first

198
00:13:49,189 --> 00:13:59,209
system trail will create the NTFS mount

199
00:13:52,850 --> 00:14:03,699
point it only used for directory ok we

200
00:13:59,209 --> 00:14:08,479
now know how to create a repast point

201
00:14:03,699 --> 00:14:13,689
the next tab is estate o we want to know

202
00:14:08,480 --> 00:14:17,929
what happens when we open a repast point

203
00:14:13,689 --> 00:14:21,679
we will maybe open a file the Windows

204
00:14:17,929 --> 00:14:25,279
kernel first looks for this object in

205
00:14:21,679 --> 00:14:28,670
the corner object directory but the

206
00:14:25,279 --> 00:14:34,029
kernel object manager only knows the

207
00:14:28,670 --> 00:14:38,929
entry pass so a concision is necessary

208
00:14:34,029 --> 00:14:43,279
for example when we open sea test test

209
00:14:38,929 --> 00:14:46,949
of fail the until was passed name to ng

210
00:14:43,279 --> 00:14:55,410
past named function how was that

211
00:14:46,950 --> 00:14:59,750
pass through Antipas in the corner

212
00:14:55,410 --> 00:15:03,260
object manager OPP vocab object name is

213
00:14:59,750 --> 00:15:06,720
responsible for founding and named

214
00:15:03,260 --> 00:15:12,689
Colonel object in the corner object

215
00:15:06,720 --> 00:15:17,250
library the object directory is composed

216
00:15:12,690 --> 00:15:20,790
of Directory objects but if the current

217
00:15:17,250 --> 00:15:24,420
path is not what you actually object the

218
00:15:20,790 --> 00:15:27,209
OPP lookup object name function will

219
00:15:24,420 --> 00:15:32,490
call the past function of this object

220
00:15:27,210 --> 00:15:34,310
tab in this figure C is a kernel

221
00:15:32,490 --> 00:15:39,000
symbolic object

222
00:15:34,310 --> 00:15:42,060
note that chrono savelic object and NTFS

223
00:15:39,000 --> 00:15:46,650
symbolic links are two completely

224
00:15:42,060 --> 00:15:50,339
different scenes because c is a kernel

225
00:15:46,650 --> 00:15:55,949
symbolic object obj lookup object name

226
00:15:50,340 --> 00:15:59,100
we'll call his pass function the past

227
00:15:55,950 --> 00:16:05,250
method of the Windows kernel similar

228
00:15:59,100 --> 00:16:07,980
link object is OPP pass symbolic link

229
00:16:05,250 --> 00:16:10,590
function it covered

230
00:16:07,980 --> 00:16:15,660
the symbolic object to the real

231
00:16:10,590 --> 00:16:21,120
directory object now the file path is

232
00:16:15,660 --> 00:16:29,370
the res heart this volume 9 test test

233
00:16:21,120 --> 00:16:35,930
affair how this volume 9 is a Pronovias

234
00:16:29,370 --> 00:16:41,970
object OPP lookup object named realized

235
00:16:35,930 --> 00:16:45,449
it is not a directory object so ovp

236
00:16:41,970 --> 00:16:49,830
lookup object name will invoke the u.s.

237
00:16:45,450 --> 00:16:53,970
objects first function i hope you pass

238
00:16:49,830 --> 00:16:58,290
the west and passing the romanian name

239
00:16:53,970 --> 00:17:00,190
as argument to LP path device function

240
00:16:58,290 --> 00:17:03,610
created or kernel

241
00:17:00,190 --> 00:17:08,260
object as the contest of this open

242
00:17:03,610 --> 00:17:11,949
operation it in Crete RP package and

243
00:17:08,260 --> 00:17:20,170
said it to the associated a file system

244
00:17:11,949 --> 00:17:25,360
grammar but if we have already created

245
00:17:20,170 --> 00:17:31,300
past point F as a well return status

246
00:17:25,359 --> 00:17:36,250
repast true IOP past us function then

247
00:17:31,300 --> 00:17:39,909
the IOP past us return the status

248
00:17:36,250 --> 00:17:43,990
reports to OPP lookup object name

249
00:17:39,910 --> 00:17:48,270
function the OPP look happen object name

250
00:17:43,990 --> 00:17:51,010
function returns made the stateís

251
00:17:48,270 --> 00:17:57,340
theatres will you return the better

252
00:17:51,010 --> 00:18:03,040
underlying if is status repast it will

253
00:17:57,340 --> 00:18:07,179
be passed again use the return value but

254
00:18:03,040 --> 00:18:14,580
this is the implementation principle of

255
00:18:07,180 --> 00:18:18,070
we passed point and the Microsoft

256
00:18:14,580 --> 00:18:22,320
provide some information that how

257
00:18:18,070 --> 00:18:29,159
Windows APs there is the repast point

258
00:18:22,320 --> 00:18:44,310
you can find you to add MST a some

259
00:18:29,160 --> 00:18:47,920
windows APR 19 2014 11 2001 delayed fell

260
00:18:44,310 --> 00:18:50,980
went in a file function open fell you to

261
00:18:47,920 --> 00:18:54,250
use until open file function with the

262
00:18:50,980 --> 00:19:00,480
fell open repast point flyable and each

263
00:18:54,250 --> 00:19:00,480
will now to return status we pass code

264
00:19:03,260 --> 00:19:13,260
we also can use make link command with

265
00:19:08,130 --> 00:19:17,790
to create our hardening is invoke the

266
00:19:13,260 --> 00:19:21,510
windows API create high link W the

267
00:19:17,790 --> 00:19:25,139
windows API created link W will a walk

268
00:19:21,510 --> 00:19:29,190
and he API and he said information fell

269
00:19:25,140 --> 00:19:33,419
function and he said information

270
00:19:29,190 --> 00:19:36,840
function allocate or add eiope with rpm

271
00:19:33,419 --> 00:19:40,890
G said information major function code

272
00:19:36,840 --> 00:19:44,990
and set fell information class value in

273
00:19:40,890 --> 00:19:51,080
our piece is that location struct and

274
00:19:44,990 --> 00:19:55,130
then until certain information fair

275
00:19:51,080 --> 00:19:59,780
standard disruption to the diverse

276
00:19:55,130 --> 00:20:04,470
object which the kernel fell of the

277
00:19:59,780 --> 00:20:09,000
kunafa object associated with in Iran

278
00:20:04,470 --> 00:20:10,919
that us associated wrist of wisdom fell

279
00:20:09,000 --> 00:20:15,630
object is the filesystem

280
00:20:10,919 --> 00:20:19,860
device so the FST will receive this

281
00:20:15,630 --> 00:20:22,110
error purist and it will set the HAR

282
00:20:19,860 --> 00:20:28,129
link a better way

283
00:20:22,110 --> 00:20:28,129
the highly only beautiful reflect fell

284
00:20:33,200 --> 00:20:41,210
double cut above has remarked in and he

285
00:20:37,169 --> 00:20:46,580
pass is usually appoint you to global

286
00:20:41,210 --> 00:20:50,030
double cut remark pass for example

287
00:20:46,580 --> 00:20:54,590
double pet remark global route is

288
00:20:50,030 --> 00:20:59,549
pointing to global turbo petrol mark

289
00:20:54,590 --> 00:21:03,689
global route but if we point double

290
00:20:59,549 --> 00:21:08,940
hazard map to paste named object Schrute

291
00:21:03,690 --> 00:21:12,630
US map then when we open double has

292
00:21:08,940 --> 00:21:15,180
remarked global route the directory we

293
00:21:12,630 --> 00:21:20,970
actually opened is paste

294
00:21:15,180 --> 00:21:24,900
named object global root the important

295
00:21:20,970 --> 00:21:30,630
thing is that all windows API and up use

296
00:21:24,900 --> 00:21:33,690
double question mark pass therefore we

297
00:21:30,630 --> 00:21:42,830
can use the as map to redirect objects

298
00:21:33,690 --> 00:21:47,040
that windows ApS operations for example

299
00:21:42,830 --> 00:21:52,710
parks proxies a want to open a file

300
00:21:47,040 --> 00:21:56,280
named C test the pass has to fail before

301
00:21:52,710 --> 00:22:00,180
the open operation we created us map for

302
00:21:56,280 --> 00:22:03,570
process a map question mark bubble

303
00:22:00,180 --> 00:22:08,190
question mark point to place named

304
00:22:03,570 --> 00:22:13,820
objects then we create a chrono symbolic

305
00:22:08,190 --> 00:22:19,430
object named phase name the object C and

306
00:22:13,820 --> 00:22:25,500
link it to give us heart this heart is

307
00:22:19,430 --> 00:22:33,420
volume for know that the real TC is

308
00:22:25,500 --> 00:22:39,240
reverse hard disk volume Mario when the

309
00:22:33,420 --> 00:22:44,760
prophecy say opened fell C test pass has

310
00:22:39,240 --> 00:22:51,060
the film firstly seat has surpassed SF l

311
00:22:44,760 --> 00:22:57,270
will chord to Tom Poquette remark seat

312
00:22:51,060 --> 00:23:02,879
as a pest has a fell in an TTL thought

313
00:22:57,270 --> 00:23:08,820
ERL by RTI otis pass name to and he

314
00:23:02,880 --> 00:23:13,140
passed name secondly topo question mark

315
00:23:08,820 --> 00:23:21,480
retract to face named object by device

316
00:23:13,140 --> 00:23:25,950
map and OPP lookup object named function

317
00:23:21,480 --> 00:23:29,480
try to pass face name objects see it has

318
00:23:25,950 --> 00:23:33,680
the pass has the fail

319
00:23:29,480 --> 00:23:37,890
suddenly OBPA look up object name

320
00:23:33,680 --> 00:23:42,900
realized the sea is not see is all

321
00:23:37,890 --> 00:23:49,820
symbolic object then redirected sure you

322
00:23:42,900 --> 00:23:52,950
ask hard disk volume for and test pass

323
00:23:49,820 --> 00:23:58,710
test fell is the remaining passer

324
00:23:52,950 --> 00:24:05,250
so the for pass is device hard disk all

325
00:23:58,710 --> 00:24:09,630
in for tests pass test fell no-till OPP

326
00:24:05,250 --> 00:24:14,130
look up object name awoke LP passed us

327
00:24:09,630 --> 00:24:19,470
and passed test has peso fell as an

328
00:24:14,130 --> 00:24:24,300
argument with hard disk volume for us

329
00:24:19,470 --> 00:24:28,679
now we have redirected C can surpass

330
00:24:24,300 --> 00:24:36,809
tensor fell to T test the pest tester

331
00:24:28,679 --> 00:24:39,630
film successfully yes okay that's my

332
00:24:36,809 --> 00:24:47,160
partner to share him as so many skills

333
00:24:39,630 --> 00:24:51,030
to bypass the pass eliminations so let's

334
00:24:47,160 --> 00:24:56,010
just say the solutions for the example

335
00:24:51,030 --> 00:24:59,910
one who can say that our target you to

336
00:24:56,010 --> 00:25:03,540
grant a DSL to Atari fell so hard ink

337
00:24:59,910 --> 00:25:08,160
could be used to do this if we quit our

338
00:25:03,540 --> 00:25:12,720
herding or DSL set to this Harding also

339
00:25:08,160 --> 00:25:17,250
reflect to a telephone so it is very

340
00:25:12,720 --> 00:25:19,770
simple we just put herding to the target

341
00:25:17,250 --> 00:25:24,150
file we want to care for control and

342
00:25:19,770 --> 00:25:30,270
then we figure s LPC interfaces so our

343
00:25:24,150 --> 00:25:33,929
sins is done let's see the second man

344
00:25:30,270 --> 00:25:37,679
abilities it is located in Windows

345
00:25:33,929 --> 00:25:42,010
installer service but the most

346
00:25:37,679 --> 00:25:46,929
importantly is it is not a OPC in the

347
00:25:42,010 --> 00:25:50,559
it is a function called MSI advised

348
00:25:46,929 --> 00:25:54,220
product functions which is used to

349
00:25:50,559 --> 00:25:57,170
communicate with the Installer service

350
00:25:54,220 --> 00:26:00,080
the function YouTube validates the

351
00:25:57,170 --> 00:26:03,110
Tigers FL and it with a copy of the

352
00:26:00,080 --> 00:26:07,360
tiger FL so there is a certain time

353
00:26:03,110 --> 00:26:11,330
between the copy happens and the check

354
00:26:07,360 --> 00:26:14,510
you can sync if the copy the file is

355
00:26:11,330 --> 00:26:17,570
read by the normal user he could break

356
00:26:14,510 --> 00:26:23,450
the rule and end up with privileges

357
00:26:17,570 --> 00:26:28,010
collision so let's see how to win this

358
00:26:23,450 --> 00:26:33,230
risk condition problems let's talk about

359
00:26:28,010 --> 00:26:36,830
relax for Microsoft it says Obelix is

360
00:26:33,230 --> 00:26:39,110
used to design to reducing network

361
00:26:36,830 --> 00:26:44,000
traffic times and the improve the

362
00:26:39,110 --> 00:26:48,428
response time actually it could use to

363
00:26:44,000 --> 00:26:51,830
win the risk conditions by only one time

364
00:26:48,429 --> 00:26:55,010
Hyuk is based on a function device I'll

365
00:26:51,830 --> 00:26:57,159
control and you could lock the fell just

366
00:26:55,010 --> 00:27:00,740
certifying a callback functions to it

367
00:26:57,160 --> 00:27:02,630
will the file options actually happens

368
00:27:00,740 --> 00:27:06,350
you're getting notified

369
00:27:02,630 --> 00:27:08,690
I just execute your Cobra functions that

370
00:27:06,350 --> 00:27:11,540
is to say we could just rewrite the file

371
00:27:08,690 --> 00:27:19,570
two junctions to the attack level so

372
00:27:11,540 --> 00:27:23,270
that we could read it and another way is

373
00:27:19,570 --> 00:27:28,178
a function named read directory change

374
00:27:23,270 --> 00:27:32,960
establish this where this functions is

375
00:27:28,179 --> 00:27:35,299
no luck so that is to say when we do

376
00:27:32,960 --> 00:27:38,120
file operations we will not concern

377
00:27:35,299 --> 00:27:41,660
about the locks

378
00:27:38,120 --> 00:27:44,709
just like if I like to file with Alex I

379
00:27:41,660 --> 00:27:49,040
could not do any operations before

380
00:27:44,710 --> 00:27:51,770
actually if our operations come so it is

381
00:27:49,040 --> 00:27:55,389
just to you to detect if there is any

382
00:27:51,770 --> 00:27:57,729
changes on the taxi directories

383
00:27:55,389 --> 00:28:05,349
and when the directors actually happens

384
00:27:57,729 --> 00:28:10,659
we could do the operation and we see the

385
00:28:05,349 --> 00:28:13,059
solutions for the example to which a

386
00:28:10,659 --> 00:28:17,349
Soyuz read directory changes functions

387
00:28:13,059 --> 00:28:20,739
to do it but as you can see we could not

388
00:28:17,349 --> 00:28:24,070
use relaxed so beautiful is also needed

389
00:28:20,739 --> 00:28:28,089
it takes many times you just to try it

390
00:28:24,070 --> 00:28:32,820
and we got notified and the rewrites

391
00:28:28,089 --> 00:28:37,869
this Junction you could see the piace

392
00:28:32,820 --> 00:28:43,958
we just set read read affair functions

393
00:28:37,869 --> 00:28:46,329
and the trying to catch the content but

394
00:28:43,959 --> 00:28:49,079
this when the bt is not so beautiful

395
00:28:46,329 --> 00:28:56,589
because the CPU rate will reach about

396
00:28:49,079 --> 00:29:01,029
100 percents so after do the case study

397
00:28:56,589 --> 00:29:03,700
and find so much so many ways to bypass

398
00:29:01,029 --> 00:29:08,829
those 50 chairs we need to think about a

399
00:29:03,700 --> 00:29:11,919
problem how to do back discovery many of

400
00:29:08,829 --> 00:29:16,440
us knows that technology details but few

401
00:29:11,919 --> 00:29:20,739
of them could refine new bugs I think

402
00:29:16,440 --> 00:29:27,009
there is a certain way that we could do

403
00:29:20,739 --> 00:29:31,209
it so I developed Ida Pro plugins to

404
00:29:27,009 --> 00:29:34,179
assist us find the new bars the main

405
00:29:31,209 --> 00:29:39,159
problems for us is actually find the

406
00:29:34,179 --> 00:29:44,619
most vulnerable functions and detect if

407
00:29:39,159 --> 00:29:47,070
there is any bars so let's see the

408
00:29:44,619 --> 00:29:47,070
plugins

409
00:29:49,500 --> 00:29:57,820
and actually provides a lot of

410
00:29:53,070 --> 00:30:00,909
interfaces to help us writers plugins we

411
00:29:57,820 --> 00:30:03,280
could get function attributes together a

412
00:30:00,910 --> 00:30:06,040
function start address and then their

413
00:30:03,280 --> 00:30:08,620
dress and then we will use their

414
00:30:06,040 --> 00:30:11,409
memories in compare our constructions a

415
00:30:08,620 --> 00:30:15,239
based block you could say they in these

416
00:30:11,410 --> 00:30:23,110
pictures is the straight line code

417
00:30:15,240 --> 00:30:27,250
sequences with no branch so for in the

418
00:30:23,110 --> 00:30:32,500
rules and right sides we could find all

419
00:30:27,250 --> 00:30:36,930
of the above operations and just find

420
00:30:32,500 --> 00:30:36,930
the targets functions with this progress

421
00:30:37,800 --> 00:30:44,530
if at either address is in the test

422
00:30:41,160 --> 00:30:51,900
segment then we go back to the Steve

423
00:30:44,530 --> 00:30:54,730
Irwin to retry this so talk is cheap

424
00:30:51,900 --> 00:30:58,750
show me the code so let's see the code

425
00:30:54,730 --> 00:31:02,880
is very very present to find those

426
00:30:58,750 --> 00:31:07,210
vulnerable functions we just to try to

427
00:31:02,880 --> 00:31:14,440
find all broad color blocks and detect

428
00:31:07,210 --> 00:31:18,070
if there is some operations by this way

429
00:31:14,440 --> 00:31:22,380
actually we found one new back reported

430
00:31:18,070 --> 00:31:25,629
to Microsoft it is located in program

431
00:31:22,380 --> 00:31:29,430
completed his assists in the service it

432
00:31:25,630 --> 00:31:33,300
is arbitrary file metadata read back

433
00:31:29,430 --> 00:31:39,400
also the main problem for this back is

434
00:31:33,300 --> 00:31:44,490
in correct impersonation and the time of

435
00:31:39,400 --> 00:31:49,210
check time of use let's see the

436
00:31:44,490 --> 00:31:51,480
disassembly code we'll see this a LPC

437
00:31:49,210 --> 00:31:57,030
the face is located in peace

438
00:31:51,480 --> 00:31:59,940
a sec top deal so the functions name get

439
00:31:57,030 --> 00:32:02,610
fire information from past use a safety

440
00:31:59,940 --> 00:32:06,660
check to make sure that the creditor

441
00:32:02,610 --> 00:32:10,020
user have the accessibility to gain to

442
00:32:06,660 --> 00:32:12,840
get the tag no files metadata if it

443
00:32:10,020 --> 00:32:15,360
first using impersonation to bear

444
00:32:12,840 --> 00:32:19,760
country users token and then use

445
00:32:15,360 --> 00:32:23,520
critical functions to try to open a file

446
00:32:19,760 --> 00:32:26,220
the developers things if the current

447
00:32:23,520 --> 00:32:29,910
user is successful to open a file so he

448
00:32:26,220 --> 00:32:34,020
must have the privileges then he just

449
00:32:29,910 --> 00:32:38,670
reverted to system privileges so let's

450
00:32:34,020 --> 00:32:42,270
see how to break this draw which has a

451
00:32:38,670 --> 00:32:46,500
create a file name which is similar

452
00:32:42,270 --> 00:32:50,250
which is seen with a toggle fail and we

453
00:32:46,500 --> 00:32:54,720
lock it with the objects then we call

454
00:32:50,250 --> 00:32:59,300
the interfaces in a RPC after we can

455
00:32:54,720 --> 00:33:02,220
notify by the rocks I need to say the

456
00:32:59,300 --> 00:33:05,190
system service try to open the tangle

457
00:33:02,220 --> 00:33:07,800
affair with contributors token and we

458
00:33:05,190 --> 00:33:11,160
rewrite her Junction to the tiny folders

459
00:33:07,800 --> 00:33:15,720
we want to read and then we bypass a

460
00:33:11,160 --> 00:33:18,900
check and the system service rewards to

461
00:33:15,720 --> 00:33:20,520
system privileges and get to the method

462
00:33:18,900 --> 00:33:23,760
back to our yours

463
00:33:20,520 --> 00:33:25,600
so that is Tuesday week in the targeted

464
00:33:23,760 --> 00:33:27,529
how is a normal user privilege

465
00:33:25,600 --> 00:33:30,269
[Applause]

466
00:33:27,529 --> 00:33:34,289
it's very simple to write a saturated

467
00:33:30,269 --> 00:33:38,990
support which asked the need to set our

468
00:33:34,289 --> 00:33:38,990
barracks and can the callback functions

469
00:33:41,149 --> 00:33:49,789
after is that was found we have seen

470
00:33:46,200 --> 00:33:53,279
many times on reverse engineering just

471
00:33:49,789 --> 00:33:55,890
about all the interfaces in the system

472
00:33:53,279 --> 00:33:58,529
services we have ruined more than

473
00:33:55,890 --> 00:34:01,710
hundreds of interfaces back and nothing

474
00:33:58,529 --> 00:34:05,909
you have so many people are trying to

475
00:34:01,710 --> 00:34:10,139
catch backs and test is not easy to

476
00:34:05,909 --> 00:34:13,050
reverse all interfaces so we started to

477
00:34:10,139 --> 00:34:18,290
think how to automate you this process

478
00:34:13,050 --> 00:34:21,839
and get new van abilities we may knows

479
00:34:18,290 --> 00:34:25,080
now we are very easy to beautiful errs

480
00:34:21,839 --> 00:34:28,500
and use it to detect memory proficient

481
00:34:25,080 --> 00:34:30,839
by automatically let's see the red side

482
00:34:28,500 --> 00:34:34,199
of this picture is so very traditional

483
00:34:30,839 --> 00:34:37,799
fathers it's just cleaner examples and

484
00:34:34,199 --> 00:34:40,739
the right with targets exclude hero just

485
00:34:37,800 --> 00:34:44,399
detecting if there is a crash so I start

486
00:34:40,739 --> 00:34:49,009
to think is there something similar with

487
00:34:44,399 --> 00:34:49,009
a crash in logical vulnerabilities

488
00:34:50,418 --> 00:34:57,750
the answer is yes by a first we need to

489
00:34:55,230 --> 00:35:01,860
know how to catch those sensitive

490
00:34:57,750 --> 00:35:03,930
operations we start using about the

491
00:35:01,860 --> 00:35:06,720
process monitor sort of the system

492
00:35:03,930 --> 00:35:09,270
internal toasts but unfortunately is

493
00:35:06,720 --> 00:35:12,600
there is that not an e command-line tool

494
00:35:09,270 --> 00:35:20,910
so we make it and left her interfaces

495
00:35:12,600 --> 00:35:24,089
for our framework to catch it system

496
00:35:20,910 --> 00:35:26,940
operations just like testing on file

497
00:35:24,090 --> 00:35:30,869
operations is very similar to a crash in

498
00:35:26,940 --> 00:35:33,810
catching memory proficient bugs and it's

499
00:35:30,869 --> 00:35:37,680
very easy to validate those operations

500
00:35:33,810 --> 00:35:40,350
satellite hello we validate crashing

501
00:35:37,680 --> 00:35:45,029
memory provisions if there is any use

502
00:35:40,350 --> 00:35:48,420
after free or Auto bounce rate and I

503
00:35:45,030 --> 00:35:49,200
found two operations is very easy to

504
00:35:48,420 --> 00:35:52,590
abide it

505
00:35:49,200 --> 00:35:54,149
the first one is said security file the

506
00:35:52,590 --> 00:35:57,660
second one is setted this composition

507
00:35:54,150 --> 00:36:06,060
fell and I will build the framework

508
00:35:57,660 --> 00:36:09,660
based on them and there is a problem can

509
00:36:06,060 --> 00:36:14,130
we just use this frameworks to automate

510
00:36:09,660 --> 00:36:17,640
hit analyze the IOPS interfaces but

511
00:36:14,130 --> 00:36:20,940
unfortunately the answer is no it cost

512
00:36:17,640 --> 00:36:23,868
for too much times and hard to do

513
00:36:20,940 --> 00:36:23,869
reverse engineering

514
00:36:24,720 --> 00:36:32,189
so I gotta another way how to trigger

515
00:36:28,339 --> 00:36:37,589
system service or let me to say to

516
00:36:32,190 --> 00:36:40,470
interact with him i justa gets a sort

517
00:36:37,589 --> 00:36:44,759
from the example to that have talked

518
00:36:40,470 --> 00:36:46,859
about you need nobody you see interfaces

519
00:36:44,760 --> 00:36:50,130
as a function relate here true system

520
00:36:46,859 --> 00:36:53,069
service so i say i just to read her

521
00:36:50,130 --> 00:36:57,869
spoiler and a click of ammunition list

522
00:36:53,069 --> 00:37:01,109
related to system service and also the

523
00:36:57,869 --> 00:37:06,540
details in MSDN should be correct for

524
00:37:01,109 --> 00:37:10,640
further usage a spider Kali is very

525
00:37:06,540 --> 00:37:15,750
simple we just collect by keywords

526
00:37:10,640 --> 00:37:18,089
related o to system services and give

527
00:37:15,750 --> 00:37:21,089
her a list for list we could

528
00:37:18,089 --> 00:37:27,660
automatically try all ism and catches

529
00:37:21,089 --> 00:37:30,720
our operations we do find some useful

530
00:37:27,660 --> 00:37:32,490
things in her or interested in the inter

531
00:37:30,720 --> 00:37:36,779
but now about unfortunately real

532
00:37:32,490 --> 00:37:39,990
non-muslim is vulnerable so I started to

533
00:37:36,780 --> 00:37:43,470
think about the system system of

534
00:37:39,990 --> 00:37:47,640
afflictions everyone everyone of us use

535
00:37:43,470 --> 00:37:51,779
system operations in Microsoft developed

536
00:37:47,640 --> 00:37:55,828
by Microsoft in Windows 10 in our daily

537
00:37:51,780 --> 00:37:59,520
usage so I started to thing about if

538
00:37:55,829 --> 00:38:02,849
they should communicate with system

539
00:37:59,520 --> 00:38:07,020
service for there is so many functions

540
00:38:02,849 --> 00:38:10,960
to be developed so this problem is

541
00:38:07,020 --> 00:38:14,319
sought by and Mac Siddhant

542
00:38:10,960 --> 00:38:18,430
mr. Fisher every one of us knows it's

543
00:38:14,319 --> 00:38:21,670
his car the windows car the stores one

544
00:38:18,430 --> 00:38:25,359
day I just click the install button song

545
00:38:21,670 --> 00:38:27,460
this is applications and I find that

546
00:38:25,359 --> 00:38:35,109
there is so many sensitive operations

547
00:38:27,460 --> 00:38:38,460
just to come and I find if I need to

548
00:38:35,109 --> 00:38:42,490
trigger all of the modules of those

549
00:38:38,460 --> 00:38:45,789
evictions the best way is just to do UI

550
00:38:42,490 --> 00:38:54,279
interactions instead of just do so many

551
00:38:45,789 --> 00:38:57,930
reverse engineering works so let's draw

552
00:38:54,279 --> 00:39:01,990
our conclusions I first I clicked

553
00:38:57,930 --> 00:39:07,029
execute finalists from the system photos

554
00:39:01,990 --> 00:39:10,629
and do some random stuffs so what is the

555
00:39:07,029 --> 00:39:14,640
random stuffs I made up a list just like

556
00:39:10,630 --> 00:39:18,849
Napoleon's start and exits the targets

557
00:39:14,640 --> 00:39:21,038
applicants and the simulates the UI the

558
00:39:18,849 --> 00:39:26,490
interactions with the UI patterns or

559
00:39:21,039 --> 00:39:29,049
press some keys the the applications may

560
00:39:26,490 --> 00:39:37,779
interact with a system service and

561
00:39:29,049 --> 00:39:40,589
trigger some functions by accident so in

562
00:39:37,779 --> 00:39:44,920
one word there is a vulnerability

563
00:39:40,589 --> 00:39:48,759
template in our framework first I just

564
00:39:44,920 --> 00:39:52,799
hope the sensitive operations and to

565
00:39:48,760 --> 00:39:55,150
interactions cylinder at every repair

566
00:39:52,799 --> 00:39:56,380
replace that affair with the hiring

567
00:39:55,150 --> 00:39:59,740
course amar Singh's

568
00:39:56,380 --> 00:40:02,589
and validates the SAO of that file if I

569
00:39:59,740 --> 00:40:06,129
try to write something into it when I

570
00:40:02,589 --> 00:40:09,099
success that you to see it was

571
00:40:06,130 --> 00:40:13,450
successful so I just a generator by the

572
00:40:09,099 --> 00:40:19,059
reporter which is similar to a trashy

573
00:40:13,450 --> 00:40:21,310
report in memory provisions let's see

574
00:40:19,059 --> 00:40:25,300
the architectural diagrams

575
00:40:21,310 --> 00:40:27,520
if it is very simple right you guys may

576
00:40:25,300 --> 00:40:28,680
ask me or it is so simple it really

577
00:40:27,520 --> 00:40:32,860
works

578
00:40:28,680 --> 00:40:35,680
you are just kidding me but actually we

579
00:40:32,860 --> 00:40:39,220
use this framework to catch four batters

580
00:40:35,680 --> 00:40:42,549
in just two weeks but you are still

581
00:40:39,220 --> 00:40:48,069
under fixing by Microsoft so today which

582
00:40:42,550 --> 00:40:52,330
has a total two of them two new bugs fun

583
00:40:48,070 --> 00:40:54,370
by this framework and all of them use

584
00:40:52,330 --> 00:40:56,860
about DSL rewrite bagger

585
00:40:54,370 --> 00:40:58,779
it's a very useful because you can get a

586
00:40:56,860 --> 00:41:04,090
full control of NFL and the Reta

587
00:40:58,780 --> 00:41:05,830
anything into it and the problems is

588
00:41:04,090 --> 00:41:13,300
just as same our old friends

589
00:41:05,830 --> 00:41:16,500
impersonation and time object mo use the

590
00:41:13,300 --> 00:41:22,120
first one is located in epics

591
00:41:16,500 --> 00:41:26,590
development service when we start the

592
00:41:22,120 --> 00:41:28,870
system camera it is a Windows app it

593
00:41:26,590 --> 00:41:32,710
will try to call service cooking owner

594
00:41:28,870 --> 00:41:35,290
of the settings file so the citizens

595
00:41:32,710 --> 00:41:39,190
file is just allocating users folders

596
00:41:35,290 --> 00:41:42,759
which any users have abilities to write

597
00:41:39,190 --> 00:41:45,430
anything into it and the target the

598
00:41:42,760 --> 00:41:52,200
system service will try to set the SA of

599
00:41:45,430 --> 00:41:55,839
weight so we just said a harding and

600
00:41:52,200 --> 00:41:59,529
pointed to the tiger fire we want to get

601
00:41:55,840 --> 00:42:02,080
full control of the result is the

602
00:41:59,530 --> 00:42:04,840
country user is said to the owner of

603
00:42:02,080 --> 00:42:07,540
this tagging affair so that we can could

604
00:42:04,840 --> 00:42:09,810
read rather anything read it or modify

605
00:42:07,540 --> 00:42:09,810
it

606
00:42:10,530 --> 00:42:18,070
let's see the video for this one ability

607
00:42:14,700 --> 00:42:21,040
first either a channel dsl for the

608
00:42:18,070 --> 00:42:25,240
attacker file you could say there is no

609
00:42:21,040 --> 00:42:29,830
access privilege for him I try to read

610
00:42:25,240 --> 00:42:32,229
something into it by field then

611
00:42:29,830 --> 00:42:35,650
I just deleted the settings file and

612
00:42:32,230 --> 00:42:41,440
instead of her linked to the tagging if

613
00:42:35,650 --> 00:42:47,560
I were one to King owner of now I just

614
00:42:41,440 --> 00:42:50,380
start to the system camera and do some

615
00:42:47,560 --> 00:42:53,700
random interactions we should we could

616
00:42:50,380 --> 00:43:03,780
click the button just do some keyboard

617
00:42:53,700 --> 00:43:09,460
events and then we could find this

618
00:43:03,780 --> 00:43:18,700
operation use triggers so let's check if

619
00:43:09,460 --> 00:43:23,830
it is successful we just try to run

620
00:43:18,700 --> 00:43:30,399
something to eat here again you'll find

621
00:43:23,830 --> 00:43:34,170
successful so let's check if the content

622
00:43:30,400 --> 00:43:34,170
is really right yeah

623
00:43:39,960 --> 00:43:46,570
you'll find out the DSL is actually

624
00:43:42,730 --> 00:43:49,630
revised in before trigger this one a bit

625
00:43:46,570 --> 00:43:58,960
here and after we get a full control of

626
00:43:49,630 --> 00:44:02,250
the toggle film it is a signer with our

627
00:43:58,960 --> 00:44:05,590
CV numbering Microsoft has April

628
00:44:02,250 --> 00:44:08,770
security advisory and the fixed for this

629
00:44:05,590 --> 00:44:11,710
problem is very easy just impersonate

630
00:44:08,770 --> 00:44:15,790
with the card users token so that you

631
00:44:11,710 --> 00:44:23,440
could only set with say himself's

632
00:44:15,790 --> 00:44:28,320
privilege and the next one is a standard

633
00:44:23,440 --> 00:44:31,930
is located in standard collector service

634
00:44:28,320 --> 00:44:37,000
there is no impersonation again seems

635
00:44:31,930 --> 00:44:41,169
Microsoft always forget to edit when you

636
00:44:37,000 --> 00:44:42,910
try to click that debug buttons on with

637
00:44:41,170 --> 00:44:45,819
your studio

638
00:44:42,910 --> 00:44:50,348
will do the following operations first

639
00:44:45,819 --> 00:44:54,520
you to create s as the a tch foul and

640
00:44:50,349 --> 00:44:55,359
again it critter with with the same file

641
00:44:54,520 --> 00:44:58,210
name by the way

642
00:44:55,359 --> 00:45:00,640
extension is different and they'll try

643
00:44:58,210 --> 00:45:08,559
to set DSL and they'll get flow control

644
00:45:00,640 --> 00:45:10,808
of him who se is adjust to this

645
00:45:08,559 --> 00:45:13,480
operation without any impersonation so

646
00:45:10,809 --> 00:45:21,099
if the chapter you system privilege to

647
00:45:13,480 --> 00:45:24,789
do those things so how could we trigger

648
00:45:21,099 --> 00:45:28,450
when abilities will create such files

649
00:45:24,789 --> 00:45:31,750
will use read directory changes to

650
00:45:28,450 --> 00:45:36,430
detect if the value is all that sings

651
00:45:31,750 --> 00:45:39,880
and create a high link before the second

652
00:45:36,430 --> 00:45:49,359
of our was crates then we look at the

653
00:45:39,880 --> 00:45:53,049
owner of the title affair so if you are

654
00:45:49,359 --> 00:45:56,109
from a Red Team you may ask me or all of

655
00:45:53,049 --> 00:45:59,380
your parents is about final operations

656
00:45:56,109 --> 00:46:03,038
residency injuries but what I need is a

657
00:45:59,380 --> 00:46:06,099
common command executions so how could

658
00:46:03,039 --> 00:46:08,589
we tour the file operations into a

659
00:46:06,099 --> 00:46:10,990
command executions with system privilege

660
00:46:08,589 --> 00:46:20,920
instead of just writing something into

661
00:46:10,990 --> 00:46:23,979
it with system privilege so you may

662
00:46:20,920 --> 00:46:28,029
think some service the DPO files

663
00:46:23,980 --> 00:46:31,180
libraries could be writin but actually

664
00:46:28,029 --> 00:46:35,980
there is a trustee the installer protect

665
00:46:31,180 --> 00:46:39,038
for those services you can certainly use

666
00:46:35,980 --> 00:46:43,599
a third party come third party software

667
00:46:39,039 --> 00:46:46,660
like Google Chrome or antivirus services

668
00:46:43,599 --> 00:46:53,170
to do those things but what we want is

669
00:46:46,660 --> 00:46:54,759
everything is installed by default you

670
00:46:53,170 --> 00:46:58,240
could say all

671
00:46:54,760 --> 00:47:00,820
most of the windows service deal or

672
00:46:58,240 --> 00:47:04,660
library is protected by trusted

673
00:47:00,820 --> 00:47:07,870
installers some of them is not protected

674
00:47:04,660 --> 00:47:10,690
but exclusive because of a service is

675
00:47:07,870 --> 00:47:13,810
around default run by default and it's

676
00:47:10,690 --> 00:47:18,100
just a loaded deal houses so when you

677
00:47:13,810 --> 00:47:22,420
try to rewrite it he says I mean usage

678
00:47:18,100 --> 00:47:26,140
usage so we need to find something wrong

679
00:47:22,420 --> 00:47:32,850
only were used and not protected by the

680
00:47:26,140 --> 00:47:37,000
trustee the installer so we can one

681
00:47:32,850 --> 00:47:40,750
cartridge the chap here spring the XPS

682
00:47:37,000 --> 00:47:45,670
printers it is called the printers for

683
00:47:40,750 --> 00:47:49,570
service it would get loaded when printer

684
00:47:45,670 --> 00:47:54,480
Java XPS document the DFL would be

685
00:47:49,570 --> 00:47:59,530
modified by the system newer users and

686
00:47:54,480 --> 00:48:02,830
it was found in a wide exploit of that

687
00:47:59,530 --> 00:48:05,590
vulnerabilities and the attack it's deal

688
00:48:02,830 --> 00:48:10,810
fairway we want to rewrite is the

689
00:48:05,590 --> 00:48:13,300
located in such photos when you try to

690
00:48:10,810 --> 00:48:19,560
create according to this fell and a

691
00:48:13,300 --> 00:48:21,520
trigger of an abilities your finery font

692
00:48:19,560 --> 00:48:24,430
Windows services

693
00:48:21,520 --> 00:48:28,030
sorry running your tears will be loaded

694
00:48:24,430 --> 00:48:30,669
and you will get a code execution with

695
00:48:28,030 --> 00:48:33,400
system privileges you just need to

696
00:48:30,670 --> 00:48:40,480
hijack the deal main functions and all

697
00:48:33,400 --> 00:48:48,730
things will be done and here is some

698
00:48:40,480 --> 00:48:53,170
reference in our projects we'd like to

699
00:48:48,730 --> 00:48:57,280
thanks James photo for his works

700
00:48:53,170 --> 00:49:00,700
logical bag researchers without his help

701
00:48:57,280 --> 00:49:04,300
we could not do this project and Mary

702
00:49:00,700 --> 00:49:08,490
der junge give us many advices about how

703
00:49:04,300 --> 00:49:14,580
to find new bus and trend adding his

704
00:49:08,490 --> 00:49:22,419
expert in Statuary o and K in the in the

705
00:49:14,580 --> 00:49:33,790
pom-poms edge competitions do you have

706
00:49:22,420 --> 00:49:34,620
any questions no questions from the

707
00:49:33,790 --> 00:49:39,220
audience

708
00:49:34,620 --> 00:49:41,490
no hands but I'd like to ask you to give

709
00:49:39,220 --> 00:49:45,540
one big hand to the speakers once more

710
00:49:41,490 --> 00:49:45,540
[Applause]

711
00:49:50,250 --> 00:49:52,310
you

