1
00:00:19,240 --> 00:00:25,959
hi everyone thanks for attending good

2
00:00:21,880 --> 00:00:27,970
afternoon I'll be presenting this talk

3
00:00:25,960 --> 00:00:32,529
about I own your building manager system

4
00:00:27,970 --> 00:00:33,879
it's about hacking access control

5
00:00:32,529 --> 00:00:37,360
security platforms and building

6
00:00:33,880 --> 00:00:38,890
management systems altogether so let's

7
00:00:37,360 --> 00:00:41,650
start with just short introduction I

8
00:00:38,890 --> 00:00:43,300
work for applied risk which is based in

9
00:00:41,650 --> 00:00:45,460
Netherlands in Amsterdam which is a

10
00:00:43,300 --> 00:00:47,220
company that deals with industrial

11
00:00:45,460 --> 00:00:49,660
security control penetration testing

12
00:00:47,220 --> 00:00:52,030
covering a variety of sectors and

13
00:00:49,660 --> 00:00:55,269
industries like maritime pharmaceuticals

14
00:00:52,030 --> 00:00:57,390
water chemical manufacturing oil and gas

15
00:00:55,270 --> 00:01:00,309
transportation and including of course

16
00:00:57,390 --> 00:01:03,160
control systems one of them is building

17
00:01:00,309 --> 00:01:06,070
management system which is parent let's

18
00:01:03,160 --> 00:01:09,429
say about of access control systems

19
00:01:06,070 --> 00:01:11,199
altogether so a little bit about myself

20
00:01:09,430 --> 00:01:15,670
my name is Joe Cocker stitch I'm coming

21
00:01:11,200 --> 00:01:17,310
from Macedonia I'm also have 15 years of

22
00:01:15,670 --> 00:01:19,750
experience in the security industry

23
00:01:17,310 --> 00:01:21,610
member of the International saboteur

24
00:01:19,750 --> 00:01:25,270
Task Force founder of zero science lab

25
00:01:21,610 --> 00:01:26,619
ethical hacking instructor I love doing

26
00:01:25,270 --> 00:01:28,600
vulnerability discovery exploitation

27
00:01:26,619 --> 00:01:31,440
finding zero days on a daily basis and

28
00:01:28,600 --> 00:01:36,460
of course I'm a ping pong amateur

29
00:01:31,440 --> 00:01:37,509
somebody's interested in that so let's

30
00:01:36,460 --> 00:01:40,029
get right to it

31
00:01:37,510 --> 00:01:42,850
agenda for today I'm gonna introduce

32
00:01:40,030 --> 00:01:46,240
what is a BMS or building automation

33
00:01:42,850 --> 00:01:48,490
system we don't discuss about different

34
00:01:46,240 --> 00:01:50,470
jargon or terminology used in the

35
00:01:48,490 --> 00:01:52,560
industry the architecture of the

36
00:01:50,470 --> 00:01:55,810
implementation of the system itself

37
00:01:52,560 --> 00:02:01,420
security research key takeaways and next

38
00:01:55,810 --> 00:02:03,729
steps so in Susa jargons we've seen all

39
00:02:01,420 --> 00:02:05,770
around different types of jargon or

40
00:02:03,729 --> 00:02:08,019
terminology used for these types of

41
00:02:05,770 --> 00:02:10,179
systems which is building management

42
00:02:08,019 --> 00:02:12,280
systems or can be building automation

43
00:02:10,179 --> 00:02:16,420
systems or building energy management

44
00:02:12,280 --> 00:02:17,920
systems including PLC's SCADA and of

45
00:02:16,420 --> 00:02:19,630
course energy monitoring system I've

46
00:02:17,920 --> 00:02:21,660
told you about electronic door access

47
00:02:19,630 --> 00:02:24,280
control which is a soft category of

48
00:02:21,660 --> 00:02:27,090
entire building mattresses and solutions

49
00:02:24,280 --> 00:02:29,739
so in this research that we've done

50
00:02:27,090 --> 00:02:31,050
together with my colleague and main

51
00:02:29,739 --> 00:02:34,620
contributor to the

52
00:02:31,050 --> 00:02:37,140
mallamma we've done research against

53
00:02:34,620 --> 00:02:39,690
five different products for from four

54
00:02:37,140 --> 00:02:41,910
different vendors but not in total in

55
00:02:39,690 --> 00:02:43,530
total there were various or large number

56
00:02:41,910 --> 00:02:47,310
of products and vendors that we've

57
00:02:43,530 --> 00:02:48,810
analyzed but due to the nature of the

58
00:02:47,310 --> 00:02:51,110
exploitation and the discovered

59
00:02:48,810 --> 00:02:54,510
vulnerabilities we chose to just had

60
00:02:51,110 --> 00:02:58,370
five of them and this is going on from

61
00:02:54,510 --> 00:03:00,870
last year in May so it's one year almost

62
00:02:58,370 --> 00:03:02,460
of course most common currently

63
00:03:00,870 --> 00:03:04,500
interested terms are building management

64
00:03:02,460 --> 00:03:06,180
system and building management and

65
00:03:04,500 --> 00:03:07,680
control systems basically it's like a

66
00:03:06,180 --> 00:03:11,160
you know centralized solutions from

67
00:03:07,680 --> 00:03:15,120
controlling an entire building so what

68
00:03:11,160 --> 00:03:16,829
is a BMS or bas is a intelligent

69
00:03:15,120 --> 00:03:19,650
microprocessor based controller systems

70
00:03:16,830 --> 00:03:22,170
that is installed in an operator were

71
00:03:19,650 --> 00:03:24,320
station for example in the local area

72
00:03:22,170 --> 00:03:26,609
network controlling a building

73
00:03:24,320 --> 00:03:28,820
controlling buildings technical systems

74
00:03:26,610 --> 00:03:32,820
and field controllers various devices

75
00:03:28,820 --> 00:03:34,739
we're talking about sensors access

76
00:03:32,820 --> 00:03:37,230
control physical access controls and or

77
00:03:34,740 --> 00:03:39,230
gates doors and gates and elevator

78
00:03:37,230 --> 00:03:42,390
access also we're talking about

79
00:03:39,230 --> 00:03:45,750
accessing live streams from a camera or

80
00:03:42,390 --> 00:03:47,820
modifying the streams it's installed in

81
00:03:45,750 --> 00:03:49,380
every major building so far in 2019

82
00:03:47,820 --> 00:03:51,720
we're gonna see a lot of different

83
00:03:49,380 --> 00:03:54,570
variety of that advertisement and we

84
00:03:51,720 --> 00:03:57,840
were focusing on the exposed ones on the

85
00:03:54,570 --> 00:04:01,260
Internet itself so BMS for end-users

86
00:03:57,840 --> 00:04:02,970
this is a typical let's say structure or

87
00:04:01,260 --> 00:04:05,489
architecture of a building mannerism and

88
00:04:02,970 --> 00:04:08,970
the components that it holds around it

89
00:04:05,489 --> 00:04:11,340
so you have radiators of course you can

90
00:04:08,970 --> 00:04:13,290
control windows blinds you can control

91
00:04:11,340 --> 00:04:15,870
lightening system the the hydraulics

92
00:04:13,290 --> 00:04:18,659
ventilation and air conditioning system

93
00:04:15,870 --> 00:04:20,070
altogether including as I mentioned the

94
00:04:18,660 --> 00:04:22,440
elevator access and the physical access

95
00:04:20,070 --> 00:04:24,510
controls you have temperature controls

96
00:04:22,440 --> 00:04:28,530
you can change the temperature up and

97
00:04:24,510 --> 00:04:31,469
down you can you know the Vav or the

98
00:04:28,530 --> 00:04:33,359
valuable air volume level you can

99
00:04:31,470 --> 00:04:35,580
control temperature of the water the

100
00:04:33,360 --> 00:04:37,980
boilers the sensor of a gas in the

101
00:04:35,580 --> 00:04:40,919
garage the gates for the garage the

102
00:04:37,980 --> 00:04:42,330
access to the house as well entirely and

103
00:04:40,919 --> 00:04:44,940
the weather monitoring system as well so

104
00:04:42,330 --> 00:04:47,190
there are a lot of different components

105
00:04:44,940 --> 00:04:48,630
compiling a single building management

106
00:04:47,190 --> 00:04:52,580
system we're gonna discuss several of

107
00:04:48,630 --> 00:04:55,050
them so what does BMS do as I you know

108
00:04:52,580 --> 00:04:57,450
informed of course this is a Google

109
00:04:55,050 --> 00:04:59,190
picture of Sydney offices in Australia

110
00:04:57,450 --> 00:05:02,550
there was an incident a couple of years

111
00:04:59,190 --> 00:05:06,050
ago where a researcher found a zero-day

112
00:05:02,550 --> 00:05:08,850
in 3d omni agarra framework affecting

113
00:05:06,050 --> 00:05:12,720
more than two hundred and fifty thousand

114
00:05:08,850 --> 00:05:14,910
two hundred four five yeah two hundred

115
00:05:12,720 --> 00:05:20,330
thousand around devices around the world

116
00:05:14,910 --> 00:05:23,280
controllers which had direct impact and

117
00:05:20,330 --> 00:05:25,950
was used as an authenticated remote

118
00:05:23,280 --> 00:05:28,739
route code execution malleability so

119
00:05:25,950 --> 00:05:31,289
that was i'm not sure which he here but

120
00:05:28,740 --> 00:05:33,330
yeah we're using easy i/o controllers or

121
00:05:31,290 --> 00:05:36,480
tedium near got a framework that

122
00:05:33,330 --> 00:05:38,460
attackers managed to find zero days and

123
00:05:36,480 --> 00:05:40,800
exploit that remotely because the

124
00:05:38,460 --> 00:05:45,150
systems and the building itself was

125
00:05:40,800 --> 00:05:48,030
exposed to the internet directly so what

126
00:05:45,150 --> 00:05:50,190
does BMS do the role of BMS today today

127
00:05:48,030 --> 00:05:53,130
building operation to control to measure

128
00:05:50,190 --> 00:05:54,660
the monitor control applications of

129
00:05:53,130 --> 00:05:57,600
course some of the building control

130
00:05:54,660 --> 00:06:00,000
applications can involve zone

131
00:05:57,600 --> 00:06:03,510
temperatures monitoring and control zone

132
00:06:00,000 --> 00:06:09,240
co2 monitoring main plant chiller toilet

133
00:06:03,510 --> 00:06:12,060
carpark kitchen gym lightning fire

134
00:06:09,240 --> 00:06:14,460
system and a lot of system as well after

135
00:06:12,060 --> 00:06:17,490
hours between control and as i mentioned

136
00:06:14,460 --> 00:06:20,370
as well Vav temperatures well not to

137
00:06:17,490 --> 00:06:21,690
repeat myself is like this is a typical

138
00:06:20,370 --> 00:06:24,090
system components for field devices

139
00:06:21,690 --> 00:06:26,760
within a single building management

140
00:06:24,090 --> 00:06:29,070
control system is a controller at the

141
00:06:26,760 --> 00:06:31,469
bottom you can see what it can control

142
00:06:29,070 --> 00:06:34,170
it can use different variety of

143
00:06:31,470 --> 00:06:35,420
protocols but most of them is using the

144
00:06:34,170 --> 00:06:40,980
buck net for the whole business open

145
00:06:35,420 --> 00:06:42,560
protocol or long works or pure tcp/ip so

146
00:06:40,980 --> 00:06:45,510
you can connect the chillers and boilers

147
00:06:42,560 --> 00:06:48,140
damper actuators variable speed drivers

148
00:06:45,510 --> 00:06:50,820
because these airflow pressures as well

149
00:06:48,140 --> 00:06:52,830
temperature relativity humidity voltage

150
00:06:50,820 --> 00:06:54,909
currents as well you can also monitor

151
00:06:52,830 --> 00:06:58,630
and modify

152
00:06:54,910 --> 00:07:02,290
and power overview and billing

153
00:06:58,630 --> 00:07:04,840
information for a building I'm gonna

154
00:07:02,290 --> 00:07:08,140
discuss also where the coverage games

155
00:07:04,840 --> 00:07:09,369
comes into play so typical components

156
00:07:08,140 --> 00:07:11,409
this is the network you have the

157
00:07:09,370 --> 00:07:14,340
management network and then your

158
00:07:11,410 --> 00:07:16,930
separates are segregated by internet and

159
00:07:14,340 --> 00:07:19,479
network segregation of course two

160
00:07:16,930 --> 00:07:21,820
additional field controllers and then at

161
00:07:19,480 --> 00:07:25,630
the bottom you have the PLC's using

162
00:07:21,820 --> 00:07:26,740
Modbus protocol support these are the

163
00:07:25,630 --> 00:07:28,570
interaction with other building

164
00:07:26,740 --> 00:07:30,100
management system you can use like for

165
00:07:28,570 --> 00:07:34,690
surveillance and access controls which

166
00:07:30,100 --> 00:07:36,580
we'll discuss here live fire safety

167
00:07:34,690 --> 00:07:39,550
systems as well lightening systems

168
00:07:36,580 --> 00:07:43,570
temperature monitoring digital video as

169
00:07:39,550 --> 00:07:47,140
well all packages like that is using the

170
00:07:43,570 --> 00:07:48,580
user interfaces so there are plenty of

171
00:07:47,140 --> 00:07:50,560
different user interfaces for a building

172
00:07:48,580 --> 00:07:54,340
management system typical user

173
00:07:50,560 --> 00:07:56,560
interfaces are maybe as a thick client

174
00:07:54,340 --> 00:07:57,940
on Windows machine or Linux machine that

175
00:07:56,560 --> 00:08:00,670
connects directly to the controller

176
00:07:57,940 --> 00:08:02,730
within a local area network some of them

177
00:08:00,670 --> 00:08:04,990
also can be built in this place

178
00:08:02,730 --> 00:08:08,290
separately or specifically for that

179
00:08:04,990 --> 00:08:11,169
purpose and also of course web interface

180
00:08:08,290 --> 00:08:13,510
exposure so we will be focusing more on

181
00:08:11,169 --> 00:08:16,690
the web interface disclosure or exposure

182
00:08:13,510 --> 00:08:19,180
sorry and to see how much devices are

183
00:08:16,690 --> 00:08:23,730
really exposed from the ones that we've

184
00:08:19,180 --> 00:08:27,280
done research on so security research

185
00:08:23,730 --> 00:08:29,860
we've done some testing against these

186
00:08:27,280 --> 00:08:31,539
type of these vendors let's say and

187
00:08:29,860 --> 00:08:33,820
products this is the building manager

188
00:08:31,540 --> 00:08:36,460
system and electronic door access

189
00:08:33,820 --> 00:08:38,500
control systems which you can see as

190
00:08:36,460 --> 00:08:40,990
it's like a variety of different types

191
00:08:38,500 --> 00:08:42,870
of vendors we all know some of them of

192
00:08:40,990 --> 00:08:45,040
course we'll be talking about

193
00:08:42,870 --> 00:08:47,800
specifically for Nortec security and

194
00:08:45,040 --> 00:08:49,449
control access control platform the

195
00:08:47,800 --> 00:08:52,599
operative building management system

196
00:08:49,450 --> 00:08:57,760
dreama systems of course about access

197
00:08:52,600 --> 00:09:00,130
control as well this includes including

198
00:08:57,760 --> 00:09:02,080
computrols which is a yeah us-based

199
00:09:00,130 --> 00:09:04,480
company as well so we can you know we

200
00:09:02,080 --> 00:09:05,790
can discuss the exposure of this systems

201
00:09:04,480 --> 00:09:09,779
in a bit

202
00:09:05,790 --> 00:09:11,189
so this advertisement for 2019 provide

203
00:09:09,779 --> 00:09:13,110
access to all functionality via a

204
00:09:11,190 --> 00:09:15,300
standard browser over the Internet as

205
00:09:13,110 --> 00:09:18,149
dangerous software shall have a

206
00:09:15,300 --> 00:09:19,769
companion mobile apps you can is 100 can

207
00:09:18,149 --> 00:09:21,630
just try to analyze that as well

208
00:09:19,769 --> 00:09:24,060
designed to control monitor HVAC

209
00:09:21,630 --> 00:09:26,579
lightning access and fire alarm systems

210
00:09:24,060 --> 00:09:29,339
all in one location in one centralized

211
00:09:26,579 --> 00:09:33,138
place perfect for commercial industrial

212
00:09:29,339 --> 00:09:35,220
banking medical retail hospitality and

213
00:09:33,139 --> 00:09:38,010
other businesses where users need to

214
00:09:35,220 --> 00:09:41,310
secure the facilities manage access of

215
00:09:38,010 --> 00:09:42,930
personnel create and analyze reports and

216
00:09:41,310 --> 00:09:45,268
monitor the system from any web browser

217
00:09:42,930 --> 00:09:47,160
so this is an indication if you hear

218
00:09:45,269 --> 00:09:49,260
like you know the systems are accessed

219
00:09:47,160 --> 00:09:52,350
from a web browser over the internet so

220
00:09:49,260 --> 00:09:55,439
this is a attack surface is just plain

221
00:09:52,350 --> 00:09:56,760
old directly trying to attack the

222
00:09:55,440 --> 00:09:59,100
building itself there are a lot of

223
00:09:56,760 --> 00:10:02,250
famous buildings we've seen in our

224
00:09:59,100 --> 00:10:04,470
research so these are the targets that

225
00:10:02,250 --> 00:10:06,480
we've analyzed so far within this year

226
00:10:04,470 --> 00:10:08,970
so this is not a cleaner energy tree

227
00:10:06,480 --> 00:10:11,190
which was also there are some research

228
00:10:08,970 --> 00:10:12,870
done two years ago all about it from a

229
00:10:11,190 --> 00:10:13,350
Google security researcher Andrew

230
00:10:12,870 --> 00:10:18,000
Griffiths

231
00:10:13,350 --> 00:10:19,829
published also not to be very much 50 P

232
00:10:18,000 --> 00:10:22,860
or 5,000 P is a different product

233
00:10:19,829 --> 00:10:24,660
different code base so it's also an

234
00:10:22,860 --> 00:10:27,889
access control platform which allows us

235
00:10:24,660 --> 00:10:31,319
to just remotely without authentication

236
00:10:27,889 --> 00:10:34,560
open doors unlock lock access the

237
00:10:31,319 --> 00:10:37,589
elevators a stream of cameras and yeah

238
00:10:34,560 --> 00:10:39,388
after G proton or Enterprise building

239
00:10:37,589 --> 00:10:41,639
management system prima systems access

240
00:10:39,389 --> 00:10:43,230
control platform and compute all CBS web

241
00:10:41,639 --> 00:10:46,470
building masses and these are all the

242
00:10:43,230 --> 00:10:47,819
targets that we've chosen to present in

243
00:10:46,470 --> 00:10:49,980
the research paper the research paper

244
00:10:47,819 --> 00:10:52,170
will be available in June it's gonna be

245
00:10:49,980 --> 00:10:54,389
a technical white paper around 138 pages

246
00:10:52,170 --> 00:10:58,319
so you can check it out on applied risk

247
00:10:54,389 --> 00:11:01,589
website so first things first

248
00:10:58,319 --> 00:11:04,979
of course we've you know try to have a

249
00:11:01,589 --> 00:11:08,310
black box approach for every target

250
00:11:04,980 --> 00:11:09,720
possible because you know it's not it's

251
00:11:08,310 --> 00:11:12,479
a bit of cheating if you have everything

252
00:11:09,720 --> 00:11:15,540
you know in place in front of you so

253
00:11:12,480 --> 00:11:17,770
we've tried to do what a real attacker

254
00:11:15,540 --> 00:11:21,300
would do to just try to

255
00:11:17,770 --> 00:11:25,960
imagine that we have only access to web

256
00:11:21,300 --> 00:11:30,339
interfaces so this is an example of leer

257
00:11:25,960 --> 00:11:32,350
emerge and Nortec of course this is how

258
00:11:30,340 --> 00:11:33,910
it looks like for optela Jeep wrote on

259
00:11:32,350 --> 00:11:35,560
enterprise and prima assistance is also

260
00:11:33,910 --> 00:11:37,600
as access control protocol access

261
00:11:35,560 --> 00:11:42,099
control platform and of course the

262
00:11:37,600 --> 00:11:46,840
seabass building management system of

263
00:11:42,100 --> 00:11:48,730
course so a little bit of data over 2500

264
00:11:46,840 --> 00:11:51,420
standalone control system accessible

265
00:11:48,730 --> 00:11:55,060
from the internet as of now maybe more

266
00:11:51,420 --> 00:11:57,099
the number of the exposed services or

267
00:11:55,060 --> 00:11:59,619
the exposed systems were increasing on

268
00:11:57,100 --> 00:12:02,650
bi-weekly basis especially for Nortec

269
00:11:59,620 --> 00:12:04,930
leaner more than 10 million people can

270
00:12:02,650 --> 00:12:08,199
be affected potentially because this is

271
00:12:04,930 --> 00:12:11,560
based on you know specification of the

272
00:12:08,200 --> 00:12:14,590
product any product as allowing for a

273
00:12:11,560 --> 00:12:16,750
person to of people to be in the

274
00:12:14,590 --> 00:12:19,690
database more than 500 more than ten

275
00:12:16,750 --> 00:12:22,450
thousand or it depends on the system so

276
00:12:19,690 --> 00:12:24,490
we calculated this and based on the

277
00:12:22,450 --> 00:12:28,060
exposed services and that specification

278
00:12:24,490 --> 00:12:29,370
of products physically can be you know

279
00:12:28,060 --> 00:12:31,719
10 million people can be affected

280
00:12:29,370 --> 00:12:34,390
physically not just like stealing data

281
00:12:31,720 --> 00:12:37,570
or private information 30 thousand doors

282
00:12:34,390 --> 00:12:41,110
can be opened within 20 seconds or all

283
00:12:37,570 --> 00:12:42,970
around the globe in 200 facilities this

284
00:12:41,110 --> 00:12:44,980
means that this is separate from access

285
00:12:42,970 --> 00:12:47,940
control systems building manner of

286
00:12:44,980 --> 00:12:50,560
systems and access control systems so

287
00:12:47,940 --> 00:12:52,470
let's see what software is used or

288
00:12:50,560 --> 00:12:54,969
software technologies in controllers

289
00:12:52,470 --> 00:12:56,620
this includes the access control and the

290
00:12:54,970 --> 00:12:58,600
building manager system as well so we

291
00:12:56,620 --> 00:13:01,300
have unit Unix Linux file system as a

292
00:12:58,600 --> 00:13:03,550
firmware for the web server of course

293
00:13:01,300 --> 00:13:06,300
for the web interface we've seen Apache

294
00:13:03,550 --> 00:13:08,709
nginx and you know light httpd go ahead

295
00:13:06,300 --> 00:13:11,740
PHP is used as a web technology

296
00:13:08,710 --> 00:13:16,630
front-end Java JavaScript as well Python

297
00:13:11,740 --> 00:13:18,760
bash CGI ASP protocols back net stack

298
00:13:16,630 --> 00:13:20,980
with does some research as well on the

299
00:13:18,760 --> 00:13:23,110
back net stack back net protocol itself

300
00:13:20,980 --> 00:13:26,020
but yeah this is out of scope for this

301
00:13:23,110 --> 00:13:28,390
paper Modbus protocol support as well

302
00:13:26,020 --> 00:13:30,499
database management systems my sequel

303
00:13:28,390 --> 00:13:33,079
Postgres sequel and database management

304
00:13:30,499 --> 00:13:39,229
of course Firebird interbase there was

305
00:13:33,079 --> 00:13:41,569
an interesting disclosure of firmware

306
00:13:39,229 --> 00:13:45,289
but we cannot discuss this a bit later

307
00:13:41,569 --> 00:13:48,589
so what we've did in the usual approach

308
00:13:45,289 --> 00:13:54,039
in the applied race laughs we managed to

309
00:13:48,589 --> 00:13:57,529
do a variety of services let's say and

310
00:13:54,039 --> 00:14:00,559
sorry yeah

311
00:13:57,529 --> 00:14:02,239
so of course once we get the firmware

312
00:14:00,559 --> 00:14:05,478
and I'll explain how we got the firma

313
00:14:02,239 --> 00:14:06,919
from all of the vendors we've done some

314
00:14:05,479 --> 00:14:09,439
further analysis of course static and

315
00:14:06,919 --> 00:14:12,319
dynamic program analysis as well so we

316
00:14:09,439 --> 00:14:14,029
done protocol fuzzing and reverse

317
00:14:12,319 --> 00:14:16,998
engineer and the binaries and we've

318
00:14:14,029 --> 00:14:19,759
found a lot of issues basically we found

319
00:14:16,999 --> 00:14:21,649
every possible vulnerability existing in

320
00:14:19,759 --> 00:14:23,859
the security industry so you can just

321
00:14:21,649 --> 00:14:28,429
think of title we can say yes that

322
00:14:23,859 --> 00:14:30,379
product has it of course at the end

323
00:14:28,429 --> 00:14:31,968
exploit research and development so we

324
00:14:30,379 --> 00:14:35,959
develop exploits as well for all of them

325
00:14:31,969 --> 00:14:38,419
and it's interesting how we got the

326
00:14:35,959 --> 00:14:41,419
firmers of you know different vendors so

327
00:14:38,419 --> 00:14:44,329
we're gonna discuss this now for example

328
00:14:41,419 --> 00:14:46,789
this is an opto g obtaining a video

329
00:14:44,329 --> 00:14:49,159
example this is an operative video from

330
00:14:46,789 --> 00:14:50,979
the marketing team they did so once we

331
00:14:49,159 --> 00:14:54,439
do we wanted to do an awesome

332
00:14:50,979 --> 00:14:57,259
intelligence gathering so we've go on to

333
00:14:54,439 --> 00:14:58,998
youtube search for author g found the

334
00:14:57,259 --> 00:15:01,129
marketing videos that they show how to

335
00:14:58,999 --> 00:15:03,889
upgrade a firmware for end user of

336
00:15:01,129 --> 00:15:06,429
course so in that case this is an actual

337
00:15:03,889 --> 00:15:08,779
screenshot from a video on v-mail

338
00:15:06,429 --> 00:15:12,439
where they download the firmware and

339
00:15:08,779 --> 00:15:15,019
just you know uploading afterwards so we

340
00:15:12,439 --> 00:15:19,549
just pause the video retype the URL got

341
00:15:15,019 --> 00:15:20,869
the firmware and yeah everything was

342
00:15:19,549 --> 00:15:22,639
there once you have the firmware you

343
00:15:20,869 --> 00:15:25,179
have the basically the source code once

344
00:15:22,639 --> 00:15:28,430
you have the source code and it's like

345
00:15:25,179 --> 00:15:31,890
Merry Christmas you know

346
00:15:28,430 --> 00:15:34,349
so now of course the URL is removed now

347
00:15:31,890 --> 00:15:37,110
any vendor every vendor was inform about

348
00:15:34,350 --> 00:15:39,780
the issues not all of them created

349
00:15:37,110 --> 00:15:41,670
patches for it but most of the vendors

350
00:15:39,780 --> 00:15:43,579
created patches and yeah I think

351
00:15:41,670 --> 00:15:45,479
recently like yesterday they just

352
00:15:43,580 --> 00:15:48,600
released an advisory I'm going to show

353
00:15:45,480 --> 00:15:50,310
you this later so we got the firmware

354
00:15:48,600 --> 00:15:52,980
form of the jury like this this is a

355
00:15:50,310 --> 00:15:54,780
simple approach of course we've tried to

356
00:15:52,980 --> 00:15:57,060
read manuals as well we've discovered

357
00:15:54,780 --> 00:15:59,459
default credentials hardcore initials

358
00:15:57,060 --> 00:16:01,050
and that's everything around on the

359
00:15:59,460 --> 00:16:05,190
Internet this is a second example for

360
00:16:01,050 --> 00:16:07,979
Nortec linear where we managed to you

361
00:16:05,190 --> 00:16:10,470
know we got the firmware from a

362
00:16:07,980 --> 00:16:13,830
different research done previously so

363
00:16:10,470 --> 00:16:15,690
we've done just code execution done the

364
00:16:13,830 --> 00:16:17,640
database and we saw that in the database

365
00:16:15,690 --> 00:16:19,650
there are clear text credentials for

366
00:16:17,640 --> 00:16:23,880
connecting to the FTP which is the main

367
00:16:19,650 --> 00:16:25,709
repository for the former's and we were

368
00:16:23,880 --> 00:16:28,020
informing the vendor of course they were

369
00:16:25,710 --> 00:16:30,590
communicating in the beginning but

370
00:16:28,020 --> 00:16:33,900
suddenly they just decided to drop the

371
00:16:30,590 --> 00:16:36,270
communication and it's still unpatched

372
00:16:33,900 --> 00:16:39,360
of course so they were trying to and I

373
00:16:36,270 --> 00:16:40,920
think as I've speak now they're trying

374
00:16:39,360 --> 00:16:43,350
to update a firm as well but we can see

375
00:16:40,920 --> 00:16:45,449
if they try to update the firmware so we

376
00:16:43,350 --> 00:16:48,330
always test the latest firm as well

377
00:16:45,450 --> 00:16:49,830
there inform about it but yeah they're

378
00:16:48,330 --> 00:16:51,840
using the FTP so this is how it looks

379
00:16:49,830 --> 00:16:53,310
like when you just navigate to it with

380
00:16:51,840 --> 00:16:55,290
the credentials provided in the database

381
00:16:53,310 --> 00:16:57,780
as clear text passwords look at a lot of

382
00:16:55,290 --> 00:17:01,050
issues guys I mean there are products

383
00:16:57,780 --> 00:17:03,470
like totally broken we'll see some

384
00:17:01,050 --> 00:17:05,609
examples more for example this is a sea

385
00:17:03,470 --> 00:17:08,250
computrols for building management

386
00:17:05,609 --> 00:17:10,429
systems a simple cvn subversion

387
00:17:08,250 --> 00:17:13,680
repository of the entire firm was

388
00:17:10,430 --> 00:17:16,020
present in the target that we've tested

389
00:17:13,680 --> 00:17:17,730
in the lab so you can just download the

390
00:17:16,020 --> 00:17:20,780
firmware itself directly because it

391
00:17:17,730 --> 00:17:24,900
allowed in the directory indexing and

392
00:17:20,780 --> 00:17:26,609
yeah read the code find backdoors as

393
00:17:24,900 --> 00:17:27,810
well and I'm gonna discuss about

394
00:17:26,609 --> 00:17:30,540
backdoors as well because we've

395
00:17:27,810 --> 00:17:32,240
discovered a couple of backdoors inside

396
00:17:30,540 --> 00:17:35,129
products

397
00:17:32,240 --> 00:17:37,140
IOT and IOT vulnerabilities basically we

398
00:17:35,130 --> 00:17:39,480
found every possible vulnerability in

399
00:17:37,140 --> 00:17:41,010
all of these products or you know

400
00:17:39,480 --> 00:17:44,340
building mannerism and access control

401
00:17:41,010 --> 00:17:46,980
systems that allowed us to just do an

402
00:17:44,340 --> 00:17:49,980
authenticated remote code execution and

403
00:17:46,980 --> 00:17:52,020
just try to open doors or just turn off

404
00:17:49,980 --> 00:17:54,360
the lights I tried to do this before the

405
00:17:52,020 --> 00:17:55,918
you know joining this conference to

406
00:17:54,360 --> 00:17:58,678
start to try this building if it's using

407
00:17:55,919 --> 00:18:00,510
some known building management system if

408
00:17:58,679 --> 00:18:02,669
it's also exposed on the internet so I

409
00:18:00,510 --> 00:18:05,700
could just you know maybe try to shut

410
00:18:02,669 --> 00:18:08,160
down the lights that didn't work

411
00:18:05,700 --> 00:18:10,530
it's not exposed so the main problem was

412
00:18:08,160 --> 00:18:11,910
that a lot of you know interfaces were

413
00:18:10,530 --> 00:18:14,820
exposed to the internet which is a

414
00:18:11,910 --> 00:18:16,110
problem of course and yeah we've

415
00:18:14,820 --> 00:18:17,970
discovered a cross-site scripting so

416
00:18:16,110 --> 00:18:20,040
deviation bypasses signal injections

417
00:18:17,970 --> 00:18:21,780
file directory server source I mean I

418
00:18:20,040 --> 00:18:24,090
can just go on on the list every

419
00:18:21,780 --> 00:18:25,740
possible bit is there and of course

420
00:18:24,090 --> 00:18:28,799
memory corruptions is a buffer overflow

421
00:18:25,740 --> 00:18:32,460
issue in one of the products as an

422
00:18:28,799 --> 00:18:36,410
example this is what we did some

423
00:18:32,460 --> 00:18:39,660
reversing of the binaries that holds

424
00:18:36,410 --> 00:18:43,250
that was the main CGI or gateway

425
00:18:39,660 --> 00:18:46,049
interface for the linear III from Nortec

426
00:18:43,250 --> 00:18:49,020
this is just a simple one one example of

427
00:18:46,049 --> 00:18:51,240
cookie traversal because once you see

428
00:18:49,020 --> 00:18:53,309
the code pseudocode we can see that

429
00:18:51,240 --> 00:18:54,990
there is a path reversal issue with the

430
00:18:53,309 --> 00:18:57,660
open function and before there's a cyst

431
00:18:54,990 --> 00:18:59,660
path issue here and before that we've

432
00:18:57,660 --> 00:19:02,220
discovered that you can upload

433
00:18:59,660 --> 00:19:04,290
unauthenticated you can upload any

434
00:19:02,220 --> 00:19:05,910
firmware not any firm about the firmware

435
00:19:04,290 --> 00:19:10,350
you can upload it without authentication

436
00:19:05,910 --> 00:19:12,360
so we've chained that and use the

437
00:19:10,350 --> 00:19:14,850
directory traversal from the cookie to

438
00:19:12,360 --> 00:19:17,729
authenticate it to be you know to bypass

439
00:19:14,850 --> 00:19:19,559
certification itself so once the bypass

440
00:19:17,730 --> 00:19:22,080
of that occasion occurs because we

441
00:19:19,559 --> 00:19:23,580
uploaded a valid session cookie which we

442
00:19:22,080 --> 00:19:26,549
also reverse and know how the cookie

443
00:19:23,580 --> 00:19:28,409
looks like as a file we just uploaded

444
00:19:26,549 --> 00:19:30,570
that file to any arbitrary location and

445
00:19:28,410 --> 00:19:33,240
from the cookie the cookie just you know

446
00:19:30,570 --> 00:19:34,918
searches for a valid file name and it

447
00:19:33,240 --> 00:19:36,870
just reads it successfully and then we

448
00:19:34,919 --> 00:19:38,940
have a authentication bypass like this

449
00:19:36,870 --> 00:19:42,350
so it's really like a twisted and a

450
00:19:38,940 --> 00:19:42,350
chain of all aridity reactions

451
00:19:42,470 --> 00:19:51,019
also another example so this is a sport

452
00:19:46,629 --> 00:19:53,269
root password in a binary not just one

453
00:19:51,019 --> 00:19:55,159
like several binaries and the root

454
00:19:53,269 --> 00:19:58,129
possible is all over the place so you

455
00:19:55,159 --> 00:20:00,110
just easily I don't know go online and

456
00:19:58,129 --> 00:20:04,158
start opening doors I don't know man

457
00:20:00,110 --> 00:20:06,229
it's a dangerous thing and you can see

458
00:20:04,159 --> 00:20:09,379
it clearly in the firmware the vendor

459
00:20:06,230 --> 00:20:12,019
didn't want to you know understand what

460
00:20:09,379 --> 00:20:13,490
is happening and yeah this is just one

461
00:20:12,019 --> 00:20:15,350
example of all the issues that we've

462
00:20:13,490 --> 00:20:17,179
discovered there are a lot of issues for

463
00:20:15,350 --> 00:20:19,219
example backdoors this is Samuel the

464
00:20:17,179 --> 00:20:20,899
binary or source code revealed to us

465
00:20:19,220 --> 00:20:22,909
that there are backdoors present and not

466
00:20:20,899 --> 00:20:24,649
just real or there's a regular backers

467
00:20:22,909 --> 00:20:27,860
there are smart backdoors with some

468
00:20:24,649 --> 00:20:30,830
logic to you have to overcome to just

469
00:20:27,860 --> 00:20:32,059
you know execute the code itself because

470
00:20:30,830 --> 00:20:33,860
backdoor these burglars allow an

471
00:20:32,059 --> 00:20:35,928
authenticated remote root code execution

472
00:20:33,860 --> 00:20:39,769
and full system access so you just shut

473
00:20:35,929 --> 00:20:41,480
down the building one click this is an

474
00:20:39,769 --> 00:20:43,940
example from the Java backdoor

475
00:20:41,480 --> 00:20:45,500
discovered in one building management

476
00:20:43,940 --> 00:20:46,970
system as you can see that there is a

477
00:20:45,500 --> 00:20:49,070
challenge sorry

478
00:20:46,970 --> 00:20:52,789
so once you click the challenge you get

479
00:20:49,070 --> 00:20:57,200
a response as a timestamp value and that

480
00:20:52,789 --> 00:21:01,490
value has to be sha-1 encoded or you

481
00:20:57,200 --> 00:21:05,139
know hashed and that and then that md5

482
00:21:01,490 --> 00:21:08,539
has to be you know calculated as a sha-1

483
00:21:05,139 --> 00:21:10,370
sorry md5 and after that you can you

484
00:21:08,539 --> 00:21:14,240
have to concatenate those values and

485
00:21:10,370 --> 00:21:16,489
provide it as an answer here and then

486
00:21:14,240 --> 00:21:17,929
you can provide an ID or not Aidid of

487
00:21:16,490 --> 00:21:20,570
command that you want to execute and

488
00:21:17,929 --> 00:21:23,179
basically they had this wide open like

489
00:21:20,570 --> 00:21:25,070
this unauthenticated so you have a web

490
00:21:23,179 --> 00:21:27,590
interface for the backer itself so you

491
00:21:25,070 --> 00:21:30,139
can just type you know if you click the

492
00:21:27,590 --> 00:21:32,269
get here you can get the challenge you

493
00:21:30,139 --> 00:21:33,889
have to calculate it manually aside

494
00:21:32,269 --> 00:21:36,409
because I'm thinking that you use it on

495
00:21:33,889 --> 00:21:37,549
special program for this and once you

496
00:21:36,409 --> 00:21:39,049
calculate it everything together

497
00:21:37,549 --> 00:21:41,330
concatenate it and provide it as an

498
00:21:39,049 --> 00:21:42,830
answer you type in the past the command

499
00:21:41,330 --> 00:21:45,019
that you want to execute and click exec

500
00:21:42,830 --> 00:21:48,490
it's gonna execute as the current

501
00:21:45,019 --> 00:21:48,490
running web user

502
00:21:48,880 --> 00:21:53,570
religious of course they removed it now

503
00:21:52,340 --> 00:21:58,250
they said that's like a you know

504
00:21:53,570 --> 00:21:59,990
forgotten development console but yeah

505
00:21:58,250 --> 00:22:04,789
the back door was really sophisticated

506
00:21:59,990 --> 00:22:06,530
so I don't know if it's a you know so

507
00:22:04,789 --> 00:22:09,710
this is this this is how it looks like

508
00:22:06,530 --> 00:22:12,678
when you try to access using this

509
00:22:09,710 --> 00:22:14,870
backdoor account so just one simple

510
00:22:12,679 --> 00:22:16,760
script it just automates all the things

511
00:22:14,870 --> 00:22:18,770
and just you have route how do I get rid

512
00:22:16,760 --> 00:22:25,669
because I told you previously that

513
00:22:18,770 --> 00:22:27,710
oxygen to Solaris file because they

514
00:22:25,669 --> 00:22:29,960
allowed everything to be executed as

515
00:22:27,710 --> 00:22:33,620
route as that user so I can just sue the

516
00:22:29,960 --> 00:22:35,720
ID this is the outcome system access

517
00:22:33,620 --> 00:22:38,209
also provided for linear III emerge

518
00:22:35,720 --> 00:22:41,600
series just with one click you have the

519
00:22:38,210 --> 00:22:44,120
ID command here as light httpd but when

520
00:22:41,600 --> 00:22:46,000
you echo they style as the user password

521
00:22:44,120 --> 00:22:49,969
the route possible you can execute

522
00:22:46,000 --> 00:22:51,740
commands as route directly some other

523
00:22:49,970 --> 00:22:54,110
examples also there's a file upload

524
00:22:51,740 --> 00:22:56,330
issue as well in just unauthenticated

525
00:22:54,110 --> 00:22:59,030
you can upload any file because it's

526
00:22:56,330 --> 00:23:01,699
using the PHP input wrapper so you just

527
00:22:59,030 --> 00:23:03,559
write anywhere anything just create

528
00:23:01,700 --> 00:23:07,100
yourself a web shell and get the root

529
00:23:03,559 --> 00:23:10,399
access as well also we created a

530
00:23:07,100 --> 00:23:11,780
Metasploit session to be more convenient

531
00:23:10,400 --> 00:23:14,780
of course I'm going to show you a demo

532
00:23:11,780 --> 00:23:16,158
at the end of this presentation to show

533
00:23:14,780 --> 00:23:19,760
you how it's possible to remotely unlock

534
00:23:16,159 --> 00:23:23,380
a door understand that we had at applied

535
00:23:19,760 --> 00:23:27,559
risk the dollhouse if anybody seen that

536
00:23:23,380 --> 00:23:29,000
this is for Lena emerge 50 P and 5,000 P

537
00:23:27,559 --> 00:23:32,210
is a different product different

538
00:23:29,000 --> 00:23:34,850
codebase we've seen a lot of you know

539
00:23:32,210 --> 00:23:36,409
critical critical buildings critical of

540
00:23:34,850 --> 00:23:38,990
famous buildings let's say or access

541
00:23:36,409 --> 00:23:41,120
control of the buildings that we've seen

542
00:23:38,990 --> 00:23:42,500
because you can easily see that without

543
00:23:41,120 --> 00:23:45,739
even you know interacting with the

544
00:23:42,500 --> 00:23:48,799
system just shouldn't and remote route

545
00:23:45,740 --> 00:23:51,140
of course optic proton also had an issue

546
00:23:48,799 --> 00:23:52,970
besides the other issues are not you

547
00:23:51,140 --> 00:23:56,210
know this is just a you know I'm saying

548
00:23:52,970 --> 00:23:58,380
the final issues mentioned but

549
00:23:56,210 --> 00:24:01,380
low-hanging fruits vulnerabilities as

550
00:23:58,380 --> 00:24:03,210
well memory corruptions privilege

551
00:24:01,380 --> 00:24:04,679
escalations directories reversals all

552
00:24:03,210 --> 00:24:06,600
over the place so everything will be

553
00:24:04,679 --> 00:24:08,730
detailed of course in the paper that

554
00:24:06,600 --> 00:24:11,580
we're gonna release but this is just so

555
00:24:08,730 --> 00:24:13,710
you know endgame presenting you to see

556
00:24:11,580 --> 00:24:16,770
how it's possible to execute code on a

557
00:24:13,710 --> 00:24:18,600
building manager system because once you

558
00:24:16,770 --> 00:24:21,330
have access you can just modify

559
00:24:18,600 --> 00:24:24,840
everything you know this is a prima

560
00:24:21,330 --> 00:24:26,789
facie this is a issue with access

561
00:24:24,840 --> 00:24:29,129
control system which they allowed to

562
00:24:26,789 --> 00:24:31,470
download you know predictable name of a

563
00:24:29,130 --> 00:24:32,940
database and they because if you change

564
00:24:31,470 --> 00:24:34,830
this vulnerability with another one that

565
00:24:32,940 --> 00:24:36,840
we discovered that they allow logging

566
00:24:34,830 --> 00:24:38,610
with md5 hashes once you download the

567
00:24:36,840 --> 00:24:40,168
database you can dump the hashes once

568
00:24:38,610 --> 00:24:43,320
you've done the hashes you can log in as

569
00:24:40,169 --> 00:24:46,440
that hash as a system admin for example

570
00:24:43,320 --> 00:24:49,980
and just you know break the control

571
00:24:46,440 --> 00:24:53,190
itself in the place a second ID

572
00:24:49,980 --> 00:24:57,900
volubility also allowed remote code

573
00:24:53,190 --> 00:25:00,830
execution using this google token Google

574
00:24:57,900 --> 00:25:04,020
Facebook social token so social login

575
00:25:00,830 --> 00:25:05,639
feature and yeah you can do this only

576
00:25:04,020 --> 00:25:07,650
three times and then your IP will be

577
00:25:05,640 --> 00:25:09,929
blocked because yeah it's using this as

578
00:25:07,650 --> 00:25:12,539
a you know wrong password but we managed

579
00:25:09,929 --> 00:25:16,110
to get ID this is discovered by a civic

580
00:25:12,539 --> 00:25:18,210
a malama also there's a authenticated

581
00:25:16,110 --> 00:25:21,030
code execution as well so for dedicated

582
00:25:18,210 --> 00:25:23,490
issues a lot of technical issues there's

583
00:25:21,030 --> 00:25:27,149
I'm just mentioning some of them Python

584
00:25:23,490 --> 00:25:29,490
scripts are already developed in execute

585
00:25:27,150 --> 00:25:31,740
code as well in prima systems you can

586
00:25:29,490 --> 00:25:33,450
also upload direct Python scripts on the

587
00:25:31,740 --> 00:25:37,830
controller itself authenticating it and

588
00:25:33,450 --> 00:25:41,610
just execute as route also for sea baths

589
00:25:37,830 --> 00:25:44,070
computrols we did not get remote route

590
00:25:41,610 --> 00:25:47,789
connect you know code execution this one

591
00:25:44,070 --> 00:25:50,820
we just had a remote code execution with

592
00:25:47,789 --> 00:25:54,240
the web user account but yeah we're here

593
00:25:50,820 --> 00:25:55,980
dumping the database credential super

594
00:25:54,240 --> 00:26:00,799
secret and you know the users of the

595
00:25:55,980 --> 00:26:03,179
database string so what are the impacts

596
00:26:00,799 --> 00:26:04,980
remotely lock up lock and unlock doors

597
00:26:03,179 --> 00:26:07,230
gates of course physical access to

598
00:26:04,980 --> 00:26:08,710
restricted areas control a delay access

599
00:26:07,230 --> 00:26:11,529
monitor the human

600
00:26:08,710 --> 00:26:13,269
behavior and movement by reading locks

601
00:26:11,529 --> 00:26:14,679
once you enter an Access Controller or

602
00:26:13,269 --> 00:26:16,360
building mattresses and you can see who

603
00:26:14,679 --> 00:26:18,779
is going to the gym at 2:00 p.m. for

604
00:26:16,360 --> 00:26:21,399
example you can do something about that

605
00:26:18,779 --> 00:26:22,929
intercepting video control video stream

606
00:26:21,399 --> 00:26:24,639
Sylvain you can freeze you can modify

607
00:26:22,929 --> 00:26:25,960
modify electrical overview and billing

608
00:26:24,639 --> 00:26:27,459
information I can change my billing

609
00:26:25,960 --> 00:26:29,830
information to be zero not to pay

610
00:26:27,460 --> 00:26:32,519
electricity in that residential building

611
00:26:29,830 --> 00:26:35,289
or company building or industrial or

612
00:26:32,519 --> 00:26:38,049
monuments and you know so on it's like

613
00:26:35,289 --> 00:26:41,200
never-ending manipulate HVAC of course

614
00:26:38,049 --> 00:26:42,668
disrupt critical operations impact this

615
00:26:41,200 --> 00:26:44,710
is what you get once you log into the

616
00:26:42,669 --> 00:26:46,509
web interface I'm gonna show you a demo

617
00:26:44,710 --> 00:26:47,830
with you know controlling the door from

618
00:26:46,509 --> 00:26:49,749
the command line directly from the

619
00:26:47,830 --> 00:26:52,350
binder itself with the given commands

620
00:26:49,749 --> 00:26:55,690
which we reversed know the logic of it

621
00:26:52,350 --> 00:26:57,580
this is a screenshot also from the optic

622
00:26:55,690 --> 00:26:59,110
ANSI I don't know if you can see clearly

623
00:26:57,580 --> 00:27:03,189
but you can you know disclose some

624
00:26:59,110 --> 00:27:05,110
information because it says here 334

625
00:27:03,190 --> 00:27:06,610
devices connected which means that using

626
00:27:05,110 --> 00:27:08,649
botnet protocol which is the building

627
00:27:06,610 --> 00:27:11,529
automation control network protocol

628
00:27:08,649 --> 00:27:14,018
which you can just use maybe there are

629
00:27:11,529 --> 00:27:18,220
sensors or field devices or any any you

630
00:27:14,019 --> 00:27:20,889
know small things boiler controls this

631
00:27:18,220 --> 00:27:23,230
is just I don't know one of many

632
00:27:20,889 --> 00:27:25,389
screenshots or interfaces that we've

633
00:27:23,230 --> 00:27:27,909
seen that you know that we needed to

634
00:27:25,389 --> 00:27:29,860
know what you can control once you get

635
00:27:27,909 --> 00:27:32,039
access or the you know description of

636
00:27:29,860 --> 00:27:34,918
the given product

637
00:27:32,039 --> 00:27:37,179
Prima's system access control platform

638
00:27:34,919 --> 00:27:38,889
you can see how you can just with one

639
00:27:37,179 --> 00:27:41,289
click you can open unlock or lock

640
00:27:38,889 --> 00:27:44,379
forever a door or unlock it forever or

641
00:27:41,289 --> 00:27:47,049
just have a man and man trap feature you

642
00:27:44,379 --> 00:27:48,730
can lock someone inside camera stream

643
00:27:47,049 --> 00:27:51,730
disclosure as well in an elevator

644
00:27:48,730 --> 00:27:56,679
so you can you know control the stream

645
00:27:51,730 --> 00:27:58,360
disable it you know and this is also an

646
00:27:56,679 --> 00:28:00,070
example from sea bass where you can

647
00:27:58,360 --> 00:28:02,379
control the temperature and the lower

648
00:28:00,070 --> 00:28:05,950
part you just change the value make

649
00:28:02,379 --> 00:28:10,869
everyone you know be cold or extremely

650
00:28:05,950 --> 00:28:13,749
hot and yeah this is also from the

651
00:28:10,869 --> 00:28:16,299
vendors itself as a case study potential

652
00:28:13,749 --> 00:28:18,100
targets it's not like that we've seen

653
00:28:16,299 --> 00:28:19,480
this but potentially because they're

654
00:28:18,100 --> 00:28:21,219
using this software and everything is

655
00:28:19,480 --> 00:28:22,480
patched everything is you know released

656
00:28:21,220 --> 00:28:25,450
everything is in

657
00:28:22,480 --> 00:28:27,910
people know about it they pass it but

658
00:28:25,450 --> 00:28:30,490
you can just you know some universities

659
00:28:27,910 --> 00:28:30,960
or Statue of Liberty I know anything can

660
00:28:30,490 --> 00:28:35,320
happen

661
00:28:30,960 --> 00:28:37,210
so operate octave G new enterprise two

662
00:28:35,320 --> 00:28:38,800
four five has been released crediting

663
00:28:37,210 --> 00:28:41,110
applied risk of course for our research

664
00:28:38,800 --> 00:28:43,720
we've been in collaboration with all the

665
00:28:41,110 --> 00:28:46,439
vendors in step one a school as well of

666
00:28:43,720 --> 00:28:48,880
course and everybody was you know

667
00:28:46,440 --> 00:28:50,550
extremely nice collaborative and they

668
00:28:48,880 --> 00:28:53,260
created patches in timely fashion

669
00:28:50,550 --> 00:28:55,690
discovered released new firmware

670
00:28:53,260 --> 00:28:58,120
versions and inform their customers to

671
00:28:55,690 --> 00:28:59,890
protect their exposed instances of

672
00:28:58,120 --> 00:29:02,560
building management and control systems

673
00:28:59,890 --> 00:29:03,850
this is our upgrade for sea bass where

674
00:29:02,560 --> 00:29:07,870
they just released it yesterday

675
00:29:03,850 --> 00:29:10,500
as a you know public announcement but

676
00:29:07,870 --> 00:29:14,860
this is fixed before that of course

677
00:29:10,500 --> 00:29:17,350
during this research we've discovered

678
00:29:14,860 --> 00:29:18,879
more than one hundred zero days and that

679
00:29:17,350 --> 00:29:21,010
doesn't mean that we have to have as a

680
00:29:18,880 --> 00:29:22,930
CV for all of them because none of the

681
00:29:21,010 --> 00:29:25,000
not all of the products we've tested are

682
00:29:22,930 --> 00:29:27,760
in this presentation or in the paper

683
00:29:25,000 --> 00:29:33,090
itself so it's still let's say ongoing

684
00:29:27,760 --> 00:29:33,090
but so far we have 48 CVS assigned and

685
00:29:33,660 --> 00:29:40,290
yeah a lot of them are not even patched

686
00:29:38,980 --> 00:29:42,580
yet

687
00:29:40,290 --> 00:29:44,409
some of them are not even presented here

688
00:29:42,580 --> 00:29:46,240
so we're moving on forward for to you

689
00:29:44,410 --> 00:29:48,280
know do some other research on building

690
00:29:46,240 --> 00:29:51,430
management systems but yeah in 2019

691
00:29:48,280 --> 00:29:52,810
exposure of when building manager system

692
00:29:51,430 --> 00:29:54,730
on the internet is the dangerous thing

693
00:29:52,810 --> 00:29:57,010
so a lot of people can say yeah we're

694
00:29:54,730 --> 00:29:59,080
using a cloud-based solution centralized

695
00:29:57,010 --> 00:30:02,410
solution password-protected but a lot of

696
00:29:59,080 --> 00:30:05,730
vendors here has default credentials you

697
00:30:02,410 --> 00:30:09,400
can just enter in like with admin admin

698
00:30:05,730 --> 00:30:11,650
similarly that so changing some of the

699
00:30:09,400 --> 00:30:13,750
viruses we discovered allows allowed us

700
00:30:11,650 --> 00:30:15,520
to have an unauthenticated code

701
00:30:13,750 --> 00:30:17,920
execution directly and take full control

702
00:30:15,520 --> 00:30:23,340
of the building or the access control

703
00:30:17,920 --> 00:30:25,330
itself jails as well can open doors guys

704
00:30:23,340 --> 00:30:27,730
recommendation of course secure building

705
00:30:25,330 --> 00:30:29,800
management system so in security be

706
00:30:27,730 --> 00:30:33,430
aware of insecurity of protocols by

707
00:30:29,800 --> 00:30:35,080
design back net is really unstable we've

708
00:30:33,430 --> 00:30:36,720
managed to crash it in some simulation

709
00:30:35,080 --> 00:30:38,460
follow industry

710
00:30:36,720 --> 00:30:40,200
practices guidelines along with vendor

711
00:30:38,460 --> 00:30:43,559
supply chain security testing and secure

712
00:30:40,200 --> 00:30:47,130
software development lifecycle do firmer

713
00:30:43,559 --> 00:30:49,110
analysis on your products do version

714
00:30:47,130 --> 00:30:51,510
control and patch management because one

715
00:30:49,110 --> 00:30:53,219
of the vendors there was a failure in

716
00:30:51,510 --> 00:30:55,950
version control there was a new version

717
00:30:53,220 --> 00:30:59,190
that patched something by coincidence

718
00:30:55,950 --> 00:31:02,610
then in a newer version on the old

719
00:30:59,190 --> 00:31:05,330
vulnerability pops up so there's a this

720
00:31:02,610 --> 00:31:08,100
summer it's a it's a mess I don't know

721
00:31:05,330 --> 00:31:09,750
this is the dollhouse we made for the

722
00:31:08,100 --> 00:31:12,780
challenges we had yesterday and today

723
00:31:09,750 --> 00:31:14,640
for from the batteries to you know try

724
00:31:12,780 --> 00:31:16,530
to hack and open the door or attractive

725
00:31:14,640 --> 00:31:20,610
hang to PLC's and modify the lights of

726
00:31:16,530 --> 00:31:24,178
the house or HMI which is the small

727
00:31:20,610 --> 00:31:29,520
screen top of the right there you can

728
00:31:24,179 --> 00:31:34,020
play with it and yeah let me try now the

729
00:31:29,520 --> 00:31:52,020
demo hopefully it's gonna work let me

730
00:31:34,020 --> 00:31:53,668
see let me see if I think this is the IP

731
00:31:52,020 --> 00:31:55,770
address of the controller downstairs

732
00:31:53,669 --> 00:31:58,049
let me see the stream because I need you

733
00:31:55,770 --> 00:32:02,940
to see the cameras livestream here

734
00:31:58,049 --> 00:32:05,010
yeah so yeah this is live downstairs

735
00:32:02,940 --> 00:32:07,049
imagine that I'm from home here opening

736
00:32:05,010 --> 00:32:09,150
doors in some laughs chemical spills

737
00:32:07,049 --> 00:32:12,570
stuff happening you know you didn't

738
00:32:09,150 --> 00:32:15,179
happen so let me just try to run this

739
00:32:12,570 --> 00:32:16,678
exploit on this thing it's gonna ask me

740
00:32:15,179 --> 00:32:18,929
do I want to jump the credentials like

741
00:32:16,679 --> 00:32:20,850
that yeah you know dunk the credentials

742
00:32:18,929 --> 00:32:26,900
in clear-text are you seeing this

743
00:32:20,850 --> 00:32:31,709
clearly ok so there's a spider sequel

744
00:32:26,900 --> 00:32:34,080
spider cgi door 1m unlocked which is

745
00:32:31,710 --> 00:32:37,110
manual unlock you have three versions or

746
00:32:34,080 --> 00:32:38,939
three modes of unlocking no control of

747
00:32:37,110 --> 00:32:41,580
the door em unlock which is manual

748
00:32:38,940 --> 00:32:44,400
unlocked which is forever unlocked and

749
00:32:41,580 --> 00:32:48,330
locked which is gonna close the door em

750
00:32:44,400 --> 00:32:49,920
unlock was gonna unlock it and lock it

751
00:32:48,330 --> 00:32:51,919
again in three seconds the

752
00:32:49,920 --> 00:32:57,240
all times time so let's see let's see

753
00:32:51,920 --> 00:33:00,560
yeah he's gonna go back so I'm gonna try

754
00:32:57,240 --> 00:33:03,690
to open it forever fighter stick cool

755
00:33:00,560 --> 00:33:05,669
let's see GI door one you can just

756
00:33:03,690 --> 00:33:09,480
select any door and just brute force all

757
00:33:05,670 --> 00:33:12,630
doors and open everything unlocked it

758
00:33:09,480 --> 00:33:16,680
should stay unlocked forever now until

759
00:33:12,630 --> 00:33:19,640
somebody manually close this or I close

760
00:33:16,680 --> 00:33:19,640
it why not

761
00:33:20,900 --> 00:33:41,280
lock lock it yeah and that's it and of

762
00:33:39,690 --> 00:33:45,540
course I'm gonna mention as well again

763
00:33:41,280 --> 00:33:47,250
that yeah this is a video just keep this

764
00:33:45,540 --> 00:33:49,740
this was just in case the demo gods were

765
00:33:47,250 --> 00:33:54,170
not with me you know it's the usual

766
00:33:49,740 --> 00:33:57,690
approach any questions guys thank you

767
00:33:54,170 --> 00:33:59,460
for this amazing talk and yeah so we're

768
00:33:57,690 --> 00:34:02,580
still in the coffee break but so feel

769
00:33:59,460 --> 00:34:05,160
free to make any questions now and I

770
00:34:02,580 --> 00:34:09,870
guess it will be glad to answer to all

771
00:34:05,160 --> 00:34:18,230
of them yes please ask away so any

772
00:34:09,870 --> 00:34:18,230
questions so yeah okay

773
00:34:20,480 --> 00:34:29,040
it's a tough question man

774
00:34:22,850 --> 00:34:31,679
sorry we have official public disclosure

775
00:34:29,040 --> 00:34:34,980
policy on no website we give them like

776
00:34:31,679 --> 00:34:38,460
two months - you know react but this was

777
00:34:34,980 --> 00:34:40,560
going on from since May 2018 so we tried

778
00:34:38,460 --> 00:34:43,918
several times to just explain what's

779
00:34:40,560 --> 00:34:46,620
really happening but this current you

780
00:34:43,918 --> 00:34:47,759
know this specific vendor I think I

781
00:34:46,620 --> 00:34:49,139
don't know what I don't know what

782
00:34:47,760 --> 00:34:51,720
happened really just dropped

783
00:34:49,139 --> 00:34:54,379
communication we had a phone

784
00:34:51,719 --> 00:34:57,569
conversation emails web chat also

785
00:34:54,380 --> 00:34:59,700
contact forms everything every time was

786
00:34:57,570 --> 00:35:01,230
the yeah did you try to contact your

787
00:34:59,700 --> 00:35:03,240
reseller no I'm trying to report

788
00:35:01,230 --> 00:35:06,960
availability please

789
00:35:03,240 --> 00:35:08,879
and some management contacted us we say

790
00:35:06,960 --> 00:35:11,820
yeah we want to report serious critical

791
00:35:08,880 --> 00:35:14,070
vulnerabilities yes we already fixed

792
00:35:11,820 --> 00:35:16,530
them and we've scanned a new firmware

793
00:35:14,070 --> 00:35:19,170
and nothing is discovered anymore so we

794
00:35:16,530 --> 00:35:20,550
are clear said which villages I didn't

795
00:35:19,170 --> 00:35:23,220
support anything I mean didn't submit

796
00:35:20,550 --> 00:35:24,090
anything to you so they just drop

797
00:35:23,220 --> 00:35:26,399
communications I don't know what

798
00:35:24,090 --> 00:35:28,020
happened but the other ones perfect I

799
00:35:26,400 --> 00:35:32,060
mean everything is fixed everything is

800
00:35:28,020 --> 00:35:35,100
good so yeah one weather remains exposed

801
00:35:32,060 --> 00:35:36,720
unfortunately but yeah they were aware

802
00:35:35,100 --> 00:35:38,549
of the disclosure policy they were aware

803
00:35:36,720 --> 00:35:40,709
that we are going to do a research paper

804
00:35:38,550 --> 00:35:44,400
and presentation energy it will be known

805
00:35:40,710 --> 00:35:46,650
and basically two years ago or three

806
00:35:44,400 --> 00:35:48,810
years ago there was a you know research

807
00:35:46,650 --> 00:35:51,119
done on this specific vendor and since

808
00:35:48,810 --> 00:35:54,270
then also those those releases were not

809
00:35:51,119 --> 00:35:57,119
patched okay thanks we have another

810
00:35:54,270 --> 00:35:59,340
question here yes thank you for your

811
00:35:57,119 --> 00:36:01,800
talk did you find a lot of product

812
00:35:59,340 --> 00:36:04,200
sharing the same codebase in this

813
00:36:01,800 --> 00:36:08,100
industry is there one wonder selling

814
00:36:04,200 --> 00:36:10,649
everything to everyone no we've not we

815
00:36:08,100 --> 00:36:12,750
haven't seen any similar or same

816
00:36:10,650 --> 00:36:14,310
codebase of different products no

817
00:36:12,750 --> 00:36:18,030
everything was like different different

818
00:36:14,310 --> 00:36:29,250
OEMs so you know maybe they are but I

819
00:36:18,030 --> 00:36:31,300
don't know yeah any more questions no

820
00:36:29,250 --> 00:36:33,870
more questions thank you that

821
00:36:31,300 --> 00:36:33,870
q Ithaca

822
00:36:40,740 --> 00:36:42,799
you

