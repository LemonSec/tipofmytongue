1
00:00:19,450 --> 00:00:24,560
okay hello everyone thank you for

2
00:00:22,280 --> 00:00:29,869
gathering here to listen about the ss7

3
00:00:24,560 --> 00:00:33,460
the subject that is very often on

4
00:00:29,869 --> 00:00:35,809
conferences in the news latest time and

5
00:00:33,460 --> 00:00:38,960
today we're going to talk about the

6
00:00:35,809 --> 00:00:41,930
hidden feature in the ssl networks that

7
00:00:38,960 --> 00:00:45,739
actually allows to bypass any security

8
00:00:41,930 --> 00:00:50,059
means that are currently protecting the

9
00:00:45,739 --> 00:00:53,120
ss7 networks so just a couple of words

10
00:00:50,059 --> 00:00:55,879
about us to point that we are not only

11
00:00:53,120 --> 00:00:58,849
security to vendor but we are security

12
00:00:55,880 --> 00:01:01,550
researchers and we have like around 400

13
00:00:58,850 --> 00:01:06,229
people that are in the R&D department

14
00:01:01,550 --> 00:01:09,200
and nearly every year we issue security

15
00:01:06,229 --> 00:01:16,360
reports related to telco so inside the

16
00:01:09,200 --> 00:01:20,810
ss7 diameter GDP and other stuff so and

17
00:01:16,360 --> 00:01:24,890
some history effects figures about the

18
00:01:20,810 --> 00:01:28,250
ss7 so how it all started so the state

19
00:01:24,890 --> 00:01:31,070
of signalling security it really hasn't

20
00:01:28,250 --> 00:01:37,700
changed for almost 40 years

21
00:01:31,070 --> 00:01:40,609
it all started in the late 70s and then

22
00:01:37,700 --> 00:01:45,320
in 80's it actually grew up to a fixed

23
00:01:40,610 --> 00:01:47,360
line providers connected together and it

24
00:01:45,320 --> 00:01:49,460
was a trusted environment because to

25
00:01:47,360 --> 00:01:52,520
connect to the network you you had to

26
00:01:49,460 --> 00:01:54,020
require a physical presence and no one

27
00:01:52,520 --> 00:01:58,929
thought that the networks are gonna

28
00:01:54,020 --> 00:02:02,240
become come mobile during the days and

29
00:01:58,930 --> 00:02:06,079
then what would we have what we had in

30
00:02:02,240 --> 00:02:09,169
2000 so the specification of the ss7

31
00:02:06,079 --> 00:02:13,940
called six-run so the ss7 was put on the

32
00:02:09,169 --> 00:02:16,100
IP layer was introduced and the number

33
00:02:13,940 --> 00:02:19,070
of operators started to grow and

34
00:02:16,100 --> 00:02:22,040
increase and grow and security was still

35
00:02:19,070 --> 00:02:25,519
missing so actually the telecom networks

36
00:02:22,040 --> 00:02:29,480
went mobile but the architecture that

37
00:02:25,519 --> 00:02:31,410
was fundamental for the SSL and it

38
00:02:29,480 --> 00:02:35,549
stayed the same because there were

39
00:02:31,410 --> 00:02:39,870
no opportunity to change it and what we

40
00:02:35,550 --> 00:02:43,980
have now in 2019 so it's not trusted

41
00:02:39,870 --> 00:02:46,800
anymore because it's not only the aminos

42
00:02:43,980 --> 00:02:49,890
which is mobile network operators it's

43
00:02:46,800 --> 00:02:52,200
only a virtual network operators and the

44
00:02:49,890 --> 00:02:57,079
value-added service providers who are

45
00:02:52,200 --> 00:03:01,530
for example sending forecasts as a

46
00:02:57,080 --> 00:03:06,330
value-added service and so number of

47
00:03:01,530 --> 00:03:13,910
connections to this ss7 network is just

48
00:03:06,330 --> 00:03:17,250
really huge and we all know that the 4G

49
00:03:13,910 --> 00:03:20,820
protocol was introduced and it actually

50
00:03:17,250 --> 00:03:23,370
used another protocol stack which is

51
00:03:20,820 --> 00:03:26,280
diameter although it was developed for

52
00:03:23,370 --> 00:03:32,930
another means but the telco industry

53
00:03:26,280 --> 00:03:37,590
thought it as applicable for the 4G and

54
00:03:32,930 --> 00:03:41,720
what we have the 4G networks using

55
00:03:37,590 --> 00:03:45,810
another protocol they still interface

56
00:03:41,720 --> 00:03:48,990
with the ss7 for the roaming purposes so

57
00:03:45,810 --> 00:03:51,959
the message coming on the ss7 layer to

58
00:03:48,990 --> 00:03:57,120
reach for example only diameter network

59
00:03:51,959 --> 00:04:01,650
it has to be converted so and we

60
00:03:57,120 --> 00:04:04,410
actually put into the position that even

61
00:04:01,650 --> 00:04:06,989
if the diameter would have been secure

62
00:04:04,410 --> 00:04:10,140
and we need to get rid of the all the

63
00:04:06,989 --> 00:04:15,060
ss7 to get the the network secure but

64
00:04:10,140 --> 00:04:19,680
the problem is that the diameter is the

65
00:04:15,060 --> 00:04:21,480
same vulnerable as the SSL so basically

66
00:04:19,680 --> 00:04:24,060
the same threats on three different

67
00:04:21,480 --> 00:04:27,990
protocols the SSL and the diameter and

68
00:04:24,060 --> 00:04:31,980
the gtp GPS tunnel protocol so that is

69
00:04:27,990 --> 00:04:35,909
used for mobile data they have the same

70
00:04:31,980 --> 00:04:39,659
threats so what can i hack you do

71
00:04:35,909 --> 00:04:44,020
you can track the location pretty easily

72
00:04:39,659 --> 00:04:46,990
intercept data calls SMS from anywhere

73
00:04:44,020 --> 00:04:48,698
because you don't require any physical

74
00:04:46,990 --> 00:04:54,279
presence to get connected to the ss7

75
00:04:48,699 --> 00:04:56,680
network because you can use it from your

76
00:04:54,279 --> 00:04:59,770
virtual machine just setting up an IPSec

77
00:04:56,680 --> 00:05:02,139
tunnel to the operator that will allow

78
00:04:59,770 --> 00:05:03,909
you this connection and will share their

79
00:05:02,139 --> 00:05:06,399
identifier that you're going to use for

80
00:05:03,909 --> 00:05:09,279
sending the messages so it's pretty

81
00:05:06,399 --> 00:05:11,740
simple and even on the internet there

82
00:05:09,279 --> 00:05:13,509
are open source tools that allow you to

83
00:05:11,740 --> 00:05:16,779
do that you just have to find the

84
00:05:13,509 --> 00:05:21,069
operator that will agree to sell you

85
00:05:16,779 --> 00:05:24,279
that access steal your money for sure if

86
00:05:21,069 --> 00:05:27,309
if for example even without any

87
00:05:24,279 --> 00:05:30,639
additional like malware stuff for the

88
00:05:27,309 --> 00:05:33,159
mobile if the money transfer over you

89
00:05:30,639 --> 00:05:36,069
SSD supported you can steal money right

90
00:05:33,159 --> 00:05:38,409
right just explore exploiting the ss7 of

91
00:05:36,069 --> 00:05:40,959
vulnerabilities getting access to the

92
00:05:38,409 --> 00:05:42,909
email in social media so it's pretty

93
00:05:40,959 --> 00:05:47,199
simple for one-time password recovery

94
00:05:42,909 --> 00:05:50,110
and for sure the the most hazardous

95
00:05:47,199 --> 00:05:52,539
threats is performing multiple denial of

96
00:05:50,110 --> 00:05:58,740
service attacks so I don't bid groups of

97
00:05:52,539 --> 00:06:01,808
subscribers or the network equipment so

98
00:05:58,740 --> 00:06:06,219
we're talking about that but other

99
00:06:01,809 --> 00:06:13,959
threats are real and we can answer yes

100
00:06:06,219 --> 00:06:20,009
for sure because during some time when

101
00:06:13,959 --> 00:06:25,629
the ss7 theme was started being popular

102
00:06:20,009 --> 00:06:27,580
the operators were kind of not believing

103
00:06:25,629 --> 00:06:29,409
in the existence of the sweat because

104
00:06:27,580 --> 00:06:31,688
they've never heard about the public

105
00:06:29,409 --> 00:06:38,369
cases and now for the for the last years

106
00:06:31,689 --> 00:06:42,089
we just received several several big

107
00:06:38,369 --> 00:06:43,269
public cases which actually were

108
00:06:42,089 --> 00:06:48,139
revealed

109
00:06:43,269 --> 00:06:52,129
so in 2017 it was the

110
00:06:48,139 --> 00:06:54,080
the operator that was attacked to

111
00:06:52,129 --> 00:06:57,169
intercept the security codes of the bank

112
00:06:54,080 --> 00:07:00,050
and now in February this year we had the

113
00:06:57,169 --> 00:07:02,229
Metro Bank so that that had to admit

114
00:07:00,050 --> 00:07:04,789
that it got it

115
00:07:02,229 --> 00:07:07,430
clients fans attacks or why the

116
00:07:04,789 --> 00:07:10,580
vulnerability of the ss7 so these

117
00:07:07,430 --> 00:07:13,189
banking staff it's usually used with the

118
00:07:10,580 --> 00:07:16,159
combination of the social engineer or

119
00:07:13,189 --> 00:07:20,840
malware so in both of these cases there

120
00:07:16,159 --> 00:07:24,229
was a malware put on the customers

121
00:07:20,840 --> 00:07:26,419
mobiles and to get their logins and

122
00:07:24,229 --> 00:07:28,008
passwords and then one-time password was

123
00:07:26,419 --> 00:07:35,150
intercepted for the transaction

124
00:07:28,009 --> 00:07:38,090
confirmation sir our World War II search

125
00:07:35,150 --> 00:07:40,878
statistic that is based on modern 70

126
00:07:38,090 --> 00:07:44,359
telecom security assessments tells that

127
00:07:40,879 --> 00:07:47,509
actually all the LTE networks that uses

128
00:07:44,360 --> 00:07:52,279
4G are vulnerable to denial of service

129
00:07:47,509 --> 00:07:54,620
attacks and 75% of networks they

130
00:07:52,279 --> 00:07:59,960
actually put subscribers at risk of get

131
00:07:54,620 --> 00:08:02,719
tracking and in 53 percent of network

132
00:07:59,960 --> 00:08:05,779
which is still a pretty pretty high

133
00:08:02,719 --> 00:08:10,669
amount the culture pin attempts are

134
00:08:05,779 --> 00:08:13,940
successful and from security monitoring

135
00:08:10,669 --> 00:08:18,729
projects we can tell that the operator

136
00:08:13,940 --> 00:08:24,710
can be hit thousands of attacks per day

137
00:08:18,729 --> 00:08:29,150
which is a really huge number so and in

138
00:08:24,710 --> 00:08:31,359
9 of 10 % the short message was

139
00:08:29,150 --> 00:08:40,490
intercepted

140
00:08:31,360 --> 00:08:43,490
so they before the the GSM a fraud and

141
00:08:40,490 --> 00:08:46,040
security group has issued a set of

142
00:08:43,490 --> 00:08:48,550
documents and I think they starting from

143
00:08:46,040 --> 00:08:51,560
2015 and they're continuously

144
00:08:48,550 --> 00:08:55,010
contributed and changed because the new

145
00:08:51,560 --> 00:08:58,310
vulnerabilities are found and the

146
00:08:55,010 --> 00:09:00,470
vendors and rely that supply the

147
00:08:58,310 --> 00:09:01,939
signaling protection rely on these

148
00:09:00,470 --> 00:09:06,200
recommendations and

149
00:09:01,940 --> 00:09:11,120
when they develop their solutions so but

150
00:09:06,200 --> 00:09:14,450
the problem is not all of them can cover

151
00:09:11,120 --> 00:09:19,060
all the features that the ss7 contains

152
00:09:14,450 --> 00:09:23,180
and that were yet to be exploited and

153
00:09:19,060 --> 00:09:27,469
today I'm gonna explain the feature that

154
00:09:23,180 --> 00:09:29,780
actually allows to encapsulate multiple

155
00:09:27,470 --> 00:09:33,650
components inside one of the singling

156
00:09:29,780 --> 00:09:37,040
message and how the security measures

157
00:09:33,650 --> 00:09:41,900
actually by now blind to this type of

158
00:09:37,040 --> 00:09:44,240
tech so firstly I would like to tell the

159
00:09:41,900 --> 00:09:49,610
about the most dangerous layers in the

160
00:09:44,240 --> 00:09:51,920
ss7 structure so basis seven set of

161
00:09:49,610 --> 00:09:56,980
protocol that uses mobile application

162
00:09:51,920 --> 00:09:59,810
part mostly for mobility management and

163
00:09:56,980 --> 00:10:01,910
the protocols that are required to use

164
00:09:59,810 --> 00:10:04,489
that mobility management procedures are

165
00:10:01,910 --> 00:10:06,890
starting from the sccp

166
00:10:04,490 --> 00:10:10,490
which is a signaling connection control

167
00:10:06,890 --> 00:10:13,580
part tea cup transaction capability

168
00:10:10,490 --> 00:10:17,540
application part and mobile application

169
00:10:13,580 --> 00:10:21,980
part so the SSP layer contains the

170
00:10:17,540 --> 00:10:23,900
information about the addressing so it

171
00:10:21,980 --> 00:10:26,450
contains the information about calling

172
00:10:23,900 --> 00:10:29,990
and called parties so in terms of telco

173
00:10:26,450 --> 00:10:33,190
it's the identifiers that are generating

174
00:10:29,990 --> 00:10:38,840
the message and the addressed node

175
00:10:33,190 --> 00:10:44,200
identifier and in the payload SSP has a

176
00:10:38,840 --> 00:10:48,560
tea cup primitive that uses the asn.1

177
00:10:44,200 --> 00:10:51,800
notation as a coding standard and teacup

178
00:10:48,560 --> 00:10:56,890
layer is intended to correlate single

179
00:10:51,800 --> 00:11:01,099
SSP messages to the whole transaction so

180
00:10:56,890 --> 00:11:04,310
the tea cup primitive consists of

181
00:11:01,100 --> 00:11:12,300
several mandatory and optional blocks

182
00:11:04,310 --> 00:11:15,149
and the the mat pack by load itself is

183
00:11:12,300 --> 00:11:19,260
considered in our accompanying portion

184
00:11:15,149 --> 00:11:21,620
so I'm just gonna switch further and to

185
00:11:19,260 --> 00:11:26,520
explain it in more detail

186
00:11:21,620 --> 00:11:28,440
so this vulnerability which was firstly

187
00:11:26,520 --> 00:11:30,439
called double map and then I guess it

188
00:11:28,440 --> 00:11:37,290
was changed to multiple map components

189
00:11:30,440 --> 00:11:39,390
we found it in the meet 2018 and first

190
00:11:37,290 --> 00:11:43,079
of all we thought that it actually might

191
00:11:39,390 --> 00:11:47,000
be a render specific issue so we were

192
00:11:43,080 --> 00:11:50,000
not actually hiring to disclose that and

193
00:11:47,000 --> 00:11:53,880
but once during the year which assitant

194
00:11:50,000 --> 00:11:56,190
different telco equipment and security

195
00:11:53,880 --> 00:11:58,740
tools during our security assessments

196
00:11:56,190 --> 00:12:01,399
and we find out that that is actually a

197
00:11:58,740 --> 00:12:10,740
common problem and this is the ss7

198
00:12:01,399 --> 00:12:13,470
architectural flaw so it was given way

199
00:12:10,740 --> 00:12:18,120
to gsm a y-coordinate of vulnerability

200
00:12:13,470 --> 00:12:20,459
disclosure and it has the CVD 2000 1815

201
00:12:18,120 --> 00:12:24,390
number but it's not yet it's not yet

202
00:12:20,459 --> 00:12:26,910
published so although they the changes

203
00:12:24,390 --> 00:12:29,130
to the gsm a standard are already in

204
00:12:26,910 --> 00:12:31,290
progress and they're going to be with

205
00:12:29,130 --> 00:12:34,230
the carbon change request document is

206
00:12:31,290 --> 00:12:36,420
not yet published but even once it is

207
00:12:34,230 --> 00:12:40,290
going to be published only the operators

208
00:12:36,420 --> 00:12:42,510
and the GSMA members associate members

209
00:12:40,290 --> 00:12:45,329
like positive technologies we are are

210
00:12:42,510 --> 00:12:50,550
gonna have access so it's not it's a

211
00:12:45,329 --> 00:12:53,609
confidential document and so what is the

212
00:12:50,550 --> 00:12:57,439
idea so the idea of this vulnerability

213
00:12:53,610 --> 00:13:00,870
is to hide an illegitimate map component

214
00:12:57,440 --> 00:13:04,260
after another one that is that is

215
00:13:00,870 --> 00:13:06,570
looking legal and encapsulated under 1/2

216
00:13:04,260 --> 00:13:09,300
cup components so basically in the tea

217
00:13:06,570 --> 00:13:12,180
cup begin we can see two operation which

218
00:13:09,300 --> 00:13:17,279
is the first one the green is legal and

219
00:13:12,180 --> 00:13:20,089
the second one is illegal so they are

220
00:13:17,279 --> 00:13:20,089
actually

221
00:13:21,490 --> 00:13:31,820
merged by the application context name

222
00:13:25,130 --> 00:13:35,420
and it it is the same for both operation

223
00:13:31,820 --> 00:13:41,030
and it really creates a big problem so

224
00:13:35,420 --> 00:13:44,719
as it is defined only once and its value

225
00:13:41,030 --> 00:13:47,030
should a court with one particular up

226
00:13:44,720 --> 00:13:51,800
code so that means that operation code

227
00:13:47,030 --> 00:13:57,140
and while we are to put two operations

228
00:13:51,800 --> 00:14:02,209
in one tick up message so and what

229
00:13:57,140 --> 00:14:05,210
happens with the equipment so the first

230
00:14:02,210 --> 00:14:07,430
component is implemented and the second

231
00:14:05,210 --> 00:14:10,160
one is ignored and the terminating

232
00:14:07,430 --> 00:14:11,930
equipment rejects the d-cup message so

233
00:14:10,160 --> 00:14:14,300
basically what we can see that

234
00:14:11,930 --> 00:14:16,880
everything works fine so as it is

235
00:14:14,300 --> 00:14:19,609
supposed to because we are trying to

236
00:14:16,880 --> 00:14:21,320
make a procedure that contains two

237
00:14:19,610 --> 00:14:24,470
components and one one of which is

238
00:14:21,320 --> 00:14:26,300
illegal so reject is normal but there

239
00:14:24,470 --> 00:14:31,460
were some nuances that we're going to

240
00:14:26,300 --> 00:14:33,859
explore today so before I describe the

241
00:14:31,460 --> 00:14:39,550
attack principle in detail I need to

242
00:14:33,860 --> 00:14:41,600
explain the tea cup protocol details so

243
00:14:39,550 --> 00:14:45,439
transactional capabilities application

244
00:14:41,600 --> 00:14:47,540
part consists of the first component to

245
00:14:45,440 --> 00:14:51,710
cup message type which is mandatory one

246
00:14:47,540 --> 00:14:56,980
so it can be one of the following so it

247
00:14:51,710 --> 00:14:59,620
can be begin for the starting of that in

248
00:14:56,980 --> 00:15:02,510
initialization of transaction it can be

249
00:14:59,620 --> 00:15:06,740
continue for a continuation of the

250
00:15:02,510 --> 00:15:15,110
transaction and end on a board so to end

251
00:15:06,740 --> 00:15:19,100
the transaction and the pretty important

252
00:15:15,110 --> 00:15:21,730
component is continue which actually

253
00:15:19,100 --> 00:15:25,900
allows to continue the transaction and

254
00:15:21,730 --> 00:15:25,900
we're going to focus on it later

255
00:15:26,360 --> 00:15:32,569
so the next is transaction ID which is

256
00:15:29,449 --> 00:15:38,420
also mandatory so this is an identified

257
00:15:32,569 --> 00:15:42,139
I dent afire of the transaction and the

258
00:15:38,420 --> 00:15:46,279
next one is dialog portion which is

259
00:15:42,139 --> 00:15:48,549
which is actually optional so we can see

260
00:15:46,279 --> 00:15:51,799
here the application context name and

261
00:15:48,549 --> 00:15:54,949
this part can be optional for an older

262
00:15:51,799 --> 00:16:02,809
version of the mat protocol and which

263
00:15:54,949 --> 00:16:09,589
actually can be left blank and component

264
00:16:02,809 --> 00:16:11,899
portion so component parameter can also

265
00:16:09,589 --> 00:16:15,049
have several what others so here we can

266
00:16:11,899 --> 00:16:17,540
see invoke so invoke is used to send

267
00:16:15,049 --> 00:16:20,689
data so these components is usually used

268
00:16:17,540 --> 00:16:23,149
for initiating the request and it can be

269
00:16:20,689 --> 00:16:26,089
also returned result original result not

270
00:16:23,149 --> 00:16:29,629
last that used to send data in responses

271
00:16:26,089 --> 00:16:32,509
and reach on a roll and reject on my

272
00:16:29,629 --> 00:16:35,059
player already they are used to indicate

273
00:16:32,509 --> 00:16:37,429
that something got wrong and the

274
00:16:35,059 --> 00:16:43,249
destination node cannot proceed a

275
00:16:37,429 --> 00:16:46,279
request normally so it should be noted

276
00:16:43,249 --> 00:16:48,980
that reject and return Aurore components

277
00:16:46,279 --> 00:16:51,439
may be delivered within the cap end to

278
00:16:48,980 --> 00:17:00,079
end the transaction and within teacup

279
00:16:51,439 --> 00:17:03,789
continue so as we can see the dialogue

280
00:17:00,079 --> 00:17:06,829
portion can be left blank

281
00:17:03,789 --> 00:17:08,359
so before to proceed just a quick

282
00:17:06,829 --> 00:17:11,928
introduction on basic notes and

283
00:17:08,359 --> 00:17:14,208
identifiers so the MSISDN it's mobile

284
00:17:11,929 --> 00:17:16,220
subscriber integrated service digital

285
00:17:14,209 --> 00:17:18,260
number so that's the telephone number

286
00:17:16,220 --> 00:17:20,029
that we all are used to that what we

287
00:17:18,260 --> 00:17:23,119
dial when we call a friend or stuff like

288
00:17:20,029 --> 00:17:26,240
that so the global title this is the

289
00:17:23,119 --> 00:17:28,398
address of a core node element but it

290
00:17:26,240 --> 00:17:31,250
has the same format as Emma sized a and

291
00:17:28,398 --> 00:17:35,389
so basically the notes in the ss7 core

292
00:17:31,250 --> 00:17:37,429
networks they are the same telephone

293
00:17:35,389 --> 00:17:39,908
numbers but just from a certain pool

294
00:17:37,429 --> 00:17:42,640
that is delivered to network

295
00:17:39,909 --> 00:17:45,250
that I'm a scientist our international

296
00:17:42,640 --> 00:17:47,950
mobile subscriber identity so this is

297
00:17:45,250 --> 00:17:51,220
the identifier that is used in the most

298
00:17:47,950 --> 00:17:55,330
of the operations inside the the ss7

299
00:17:51,220 --> 00:17:58,770
core network and every MSISDN is has a

300
00:17:55,330 --> 00:18:02,710
correlation with the MZ identifier so

301
00:17:58,770 --> 00:18:05,110
you as subscribers may not know your own

302
00:18:02,710 --> 00:18:08,940
IMSI identifier because you don't need

303
00:18:05,110 --> 00:18:13,539
it but the telco equipment of the

304
00:18:08,940 --> 00:18:15,580
operator you are using knows that the

305
00:18:13,539 --> 00:18:17,710
STP so this is the border device

306
00:18:15,580 --> 00:18:19,720
signaling transfer point so basically a

307
00:18:17,710 --> 00:18:22,299
border router that processes the

308
00:18:19,720 --> 00:18:24,250
incoming messages and outgoing messages

309
00:18:22,299 --> 00:18:28,090
to four for all mean to another operator

310
00:18:24,250 --> 00:18:30,279
they HL are home location register so

311
00:18:28,090 --> 00:18:32,590
this is a database that contains the

312
00:18:30,279 --> 00:18:37,230
subscriber profile the information about

313
00:18:32,590 --> 00:18:39,760
the accessible functions about the

314
00:18:37,230 --> 00:18:43,240
purification platform and stuff like

315
00:18:39,760 --> 00:18:46,570
that and it contains information only

316
00:18:43,240 --> 00:18:49,330
about the home subscribers and the MSC

317
00:18:46,570 --> 00:18:54,820
VAR the mobile switching center is used

318
00:18:49,330 --> 00:18:59,158
to process the messages and the the

319
00:18:54,820 --> 00:19:03,520
wheel R is visited location registers so

320
00:18:59,159 --> 00:19:06,190
it contains information like a database

321
00:19:03,520 --> 00:19:08,340
of the profiles that are of the

322
00:19:06,190 --> 00:19:12,130
subscribers that are currently served by

323
00:19:08,340 --> 00:19:14,080
the exact certain node so the MSC VL r

324
00:19:12,130 --> 00:19:17,169
and the SMSC

325
00:19:14,080 --> 00:19:22,360
is the SMS center that is actually deals

326
00:19:17,169 --> 00:19:26,860
with short messages so couple of words

327
00:19:22,360 --> 00:19:29,350
about the MC so it's identified by

328
00:19:26,860 --> 00:19:31,689
itself is not vulnerable to an intruder

329
00:19:29,350 --> 00:19:34,629
so but they they can carry a lot of

330
00:19:31,690 --> 00:19:37,450
malicious actions against a subscriber

331
00:19:34,630 --> 00:19:39,730
one they know that so they are not

332
00:19:37,450 --> 00:19:42,190
limited to location tracking service

333
00:19:39,730 --> 00:19:44,590
disturbance SMS interception voice

334
00:19:42,190 --> 00:19:47,889
columns dropping hands and many others

335
00:19:44,590 --> 00:19:51,699
so the MC is actually considered

336
00:19:47,889 --> 00:19:55,510
personal data as per GDP our

337
00:19:51,700 --> 00:19:59,570
so now firstly I'm gonna show the

338
00:19:55,510 --> 00:20:03,470
process of the SMS delivery when there

339
00:19:59,570 --> 00:20:04,340
are no special means in place so how

340
00:20:03,470 --> 00:20:08,720
does it work

341
00:20:04,340 --> 00:20:11,780
the SMSC sense the s arrive for sam

342
00:20:08,720 --> 00:20:15,290
sandro tuned for SM request to the

343
00:20:11,780 --> 00:20:17,450
operator premises so just using just the

344
00:20:15,290 --> 00:20:19,879
telephone number of the subscriber so

345
00:20:17,450 --> 00:20:23,300
the SMS center of the operator from

346
00:20:19,880 --> 00:20:26,600
where the short message is coming is

347
00:20:23,300 --> 00:20:29,300
asking the home network of the

348
00:20:26,600 --> 00:20:31,969
destination subscriber like I need

349
00:20:29,300 --> 00:20:33,680
routing information like where your

350
00:20:31,970 --> 00:20:37,910
subscriber is register to have a message

351
00:20:33,680 --> 00:20:40,730
for him and receives a response and

352
00:20:37,910 --> 00:20:43,130
responds contains the imus identifier

353
00:20:40,730 --> 00:20:46,760
and the MSC address where subscriber is

354
00:20:43,130 --> 00:20:51,320
currently served and then using this

355
00:20:46,760 --> 00:20:56,060
information the SMSC sends terminating

356
00:20:51,320 --> 00:20:58,280
SMS using that MC with the SMS text to

357
00:20:56,060 --> 00:21:00,980
the MSC where subscriber is served and

358
00:20:58,280 --> 00:21:02,810
the message delivered now goes to the

359
00:21:00,980 --> 00:21:07,910
radio flow and subscriber receive the

360
00:21:02,810 --> 00:21:11,090
message so how can the hackers abuse

361
00:21:07,910 --> 00:21:13,040
that procedure so they can use that SSRI

362
00:21:11,090 --> 00:21:17,540
for some message not with the goal of

363
00:21:13,040 --> 00:21:21,139
sending further sm so they ask him about

364
00:21:17,540 --> 00:21:23,540
what subscribers of the exact

365
00:21:21,140 --> 00:21:27,740
subscribers with that in massage day and

366
00:21:23,540 --> 00:21:31,040
was his MZ and where he currently serves

367
00:21:27,740 --> 00:21:36,320
on what MSC and then not sent the sm

368
00:21:31,040 --> 00:21:39,320
afterwards so for the reason of hiding

369
00:21:36,320 --> 00:21:42,320
the MC because we just observed that MC

370
00:21:39,320 --> 00:21:47,060
is really valuable identifier for the

371
00:21:42,320 --> 00:21:49,909
for further and malicious attacks the

372
00:21:47,060 --> 00:21:53,450
SMS home routing system has been

373
00:21:49,910 --> 00:21:56,500
developed and is already in place for

374
00:21:53,450 --> 00:22:01,490
many years and many operators use it and

375
00:21:56,500 --> 00:22:04,300
what actually does so they s arrived for

376
00:22:01,490 --> 00:22:06,940
some requests they are transferred not

377
00:22:04,300 --> 00:22:10,590
to the home location register directly

378
00:22:06,940 --> 00:22:14,440
but they go first to the SMS router and

379
00:22:10,590 --> 00:22:19,860
the SMS rotor responds with the fake MZ

380
00:22:14,440 --> 00:22:24,880
and with its own SMS our address and now

381
00:22:19,860 --> 00:22:29,850
the SMSC uses that procedure to send the

382
00:22:24,880 --> 00:22:35,380
SMS using that fake identifiers and this

383
00:22:29,850 --> 00:22:37,750
SMS is actually being transmitted to the

384
00:22:35,380 --> 00:22:41,770
SMS router so on the SMS router nose

385
00:22:37,750 --> 00:22:45,400
real MZ and only it is this internal

386
00:22:41,770 --> 00:22:47,320
node knows the real MSC that is

387
00:22:45,400 --> 00:22:50,530
currently serving the subscriber and

388
00:22:47,320 --> 00:22:54,610
then SMS router with that correlation in

389
00:22:50,530 --> 00:22:57,070
memory just proceeds with the request as

390
00:22:54,610 --> 00:23:02,379
a write for Sam and then delivers that

391
00:22:57,070 --> 00:23:04,570
message so there are basically two parts

392
00:23:02,380 --> 00:23:08,560
of the procedure now with the SMS router

393
00:23:04,570 --> 00:23:12,370
and how it helps to protect against

394
00:23:08,560 --> 00:23:15,429
malefactor so the SSRI for Sam goes to

395
00:23:12,370 --> 00:23:20,409
the SMS router and SMS router delivers

396
00:23:15,430 --> 00:23:21,490
fake MZ and SMS well to address which is

397
00:23:20,410 --> 00:23:26,140
fake MSC

398
00:23:21,490 --> 00:23:29,830
so if the malefactor now tries to attack

399
00:23:26,140 --> 00:23:32,020
based on the fake MC he won't succeed if

400
00:23:29,830 --> 00:23:34,629
it tries to address the SMS l address

401
00:23:32,020 --> 00:23:36,520
for procedures that i actually related

402
00:23:34,630 --> 00:23:42,680
to MSE he won't succeed because they got

403
00:23:36,520 --> 00:23:48,050
they're gonna be abort and projects so

404
00:23:42,680 --> 00:23:49,760
let's observe the first case so we're

405
00:23:48,050 --> 00:23:53,440
going to use the application context

406
00:23:49,760 --> 00:23:58,040
name for the illegitimate component so

407
00:23:53,440 --> 00:24:03,220
we can compare it like to two soldiers

408
00:23:58,040 --> 00:24:06,080
when they trying to contact by radio and

409
00:24:03,220 --> 00:24:11,059
it actually looks like to send me some

410
00:24:06,080 --> 00:24:13,189
info and the the second soldier cannot

411
00:24:11,059 --> 00:24:15,610
understand what's going on and he's

412
00:24:13,190 --> 00:24:23,840
asking to repeat

413
00:24:15,610 --> 00:24:26,090
now let's observe so we are dealing

414
00:24:23,840 --> 00:24:28,370
again with the SSRI fluorescent message

415
00:24:26,090 --> 00:24:30,740
that we just observe and how it works we

416
00:24:28,370 --> 00:24:33,229
have the SMS router here we have the ss7

417
00:24:30,740 --> 00:24:37,610
fire role which actually process all the

418
00:24:33,230 --> 00:24:42,910
incoming messages from the operator from

419
00:24:37,610 --> 00:24:49,010
the Roman premises and the SSRI for sm

420
00:24:42,910 --> 00:24:52,490
so we send a message which we actually

421
00:24:49,010 --> 00:24:54,650
put so we can see we're using the

422
00:24:52,490 --> 00:24:56,570
application context name that is related

423
00:24:54,650 --> 00:24:59,660
to short message gateway context and

424
00:24:56,570 --> 00:25:02,840
what we're using now in the TCAP we're

425
00:24:59,660 --> 00:25:07,970
using two operations so the first one is

426
00:25:02,840 --> 00:25:12,860
status report which for for example I

427
00:25:07,970 --> 00:25:18,559
are 82 GSM a document is an OK procedure

428
00:25:12,860 --> 00:25:24,520
and in second component we put the S

429
00:25:18,559 --> 00:25:29,928
write for a same message and actually

430
00:25:24,520 --> 00:25:33,350
the situation is that so this message is

431
00:25:29,929 --> 00:25:38,450
sent to the ss7 firewall for inspection

432
00:25:33,350 --> 00:25:40,639
but unfortunately the ss7 firewalls for

433
00:25:38,450 --> 00:25:42,800
now they are only exploring the first

434
00:25:40,640 --> 00:25:45,140
component so when they when they reach

435
00:25:42,800 --> 00:25:47,990
the ticker player they go to the first

436
00:25:45,140 --> 00:25:49,700
map components they inspect it and no

437
00:25:47,990 --> 00:25:52,520
matter what what what is shown later

438
00:25:49,700 --> 00:25:53,950
they might make a decision based only on

439
00:25:52,520 --> 00:25:58,600
the first component

440
00:25:53,950 --> 00:26:00,670
and what happens here so they inspected

441
00:25:58,600 --> 00:26:02,709
the first component and it seemed okay

442
00:26:00,670 --> 00:26:06,160
and they passing the message into the

443
00:26:02,710 --> 00:26:09,070
network but it's not yet the deal

444
00:26:06,160 --> 00:26:13,390
because we still have a kind of

445
00:26:09,070 --> 00:26:16,419
malformed packet so the HLR the home

446
00:26:13,390 --> 00:26:18,820
location register received this message

447
00:26:16,420 --> 00:26:23,650
so it's not rooted to the SMS router

448
00:26:18,820 --> 00:26:27,370
because the the border device the STP it

449
00:26:23,650 --> 00:26:30,010
also only explored the status report

450
00:26:27,370 --> 00:26:34,169
message and based on that operation

451
00:26:30,010 --> 00:26:39,760
decided to move its sway to the HLR and

452
00:26:34,170 --> 00:26:47,800
the HLR sends a reject message so

453
00:26:39,760 --> 00:26:53,230
because the HLR responds with reject on

454
00:26:47,800 --> 00:26:56,290
mat layer but this reject actually is

455
00:26:53,230 --> 00:26:59,140
encapsulated in a tea cup continue so

456
00:26:56,290 --> 00:27:00,550
this is basically the continuation there

457
00:26:59,140 --> 00:27:02,380
is a possibility to continue the

458
00:27:00,550 --> 00:27:05,680
conversation so it's basically like I

459
00:27:02,380 --> 00:27:10,630
didn't understand your two operations

460
00:27:05,680 --> 00:27:13,780
please repeat and so we can see that

461
00:27:10,630 --> 00:27:17,220
there is an invoked problem that the HLR

462
00:27:13,780 --> 00:27:23,440
finds and what we're going to do next

463
00:27:17,220 --> 00:27:25,720
so we receive the reject and now we want

464
00:27:23,440 --> 00:27:30,280
to proceed with these transactions so

465
00:27:25,720 --> 00:27:36,280
even if it's again if even if it comes

466
00:27:30,280 --> 00:27:38,110
through the ss7 firewall the transaction

467
00:27:36,280 --> 00:27:41,980
was already initiated and most of the

468
00:27:38,110 --> 00:27:44,409
ss7 firewalls they only observe the tea

469
00:27:41,980 --> 00:27:47,380
cup begins and here we have the tea cup

470
00:27:44,410 --> 00:27:50,380
continued component with the the central

471
00:27:47,380 --> 00:27:55,210
thing for for same message which is

472
00:27:50,380 --> 00:27:59,560
actually malicious and we request the

473
00:27:55,210 --> 00:28:02,110
data we require the MC and the NSE and

474
00:27:59,560 --> 00:28:04,090
we receive it in the response so

475
00:28:02,110 --> 00:28:05,649
basically we received then reject for

476
00:28:04,090 --> 00:28:06,908
the first component which is status

477
00:28:05,650 --> 00:28:08,859
report

478
00:28:06,909 --> 00:28:15,669
we receive send routine for for a same

479
00:28:08,859 --> 00:28:18,039
response and in the second component so

480
00:28:15,669 --> 00:28:21,239
and this way we can see that the SMS

481
00:28:18,039 --> 00:28:26,590
rotor and the ss7 firewall

482
00:28:21,239 --> 00:28:30,279
basically were bypassed so number two

483
00:28:26,590 --> 00:28:32,379
case so as we already explored in the

484
00:28:30,279 --> 00:28:34,479
tea cup protocol we can remove the

485
00:28:32,379 --> 00:28:38,168
dialog portions that contains the

486
00:28:34,479 --> 00:28:41,559
application context so now we're using

487
00:28:38,169 --> 00:28:45,849
the send wrote an info procedure so this

488
00:28:41,559 --> 00:28:50,470
is basically the same procedure but not

489
00:28:45,849 --> 00:28:55,689
for the SM messages but this is for the

490
00:28:50,470 --> 00:28:58,479
calls so and the Esper gmf ask this is

491
00:28:55,690 --> 00:29:00,729
the category one message that can only

492
00:28:58,479 --> 00:29:02,559
be used internally unless there is a

493
00:29:00,729 --> 00:29:08,080
roaming agreement between the operators

494
00:29:02,559 --> 00:29:12,720
and so what we do we put the update

495
00:29:08,080 --> 00:29:15,999
location so no dialogue portion so and

496
00:29:12,720 --> 00:29:19,409
we put the update location so this is a

497
00:29:15,999 --> 00:29:22,359
message procedure to register subscriber

498
00:29:19,409 --> 00:29:24,220
in a new network so for example when you

499
00:29:22,359 --> 00:29:26,678
arrive here the update location

500
00:29:24,220 --> 00:29:29,499
procedures were performed and you

501
00:29:26,679 --> 00:29:33,340
registered in the Netherlands network

502
00:29:29,499 --> 00:29:37,210
and which basically looks normal and

503
00:29:33,340 --> 00:29:39,519
then we have the component send routine

504
00:29:37,210 --> 00:29:41,409
info so we're basically using the older

505
00:29:39,519 --> 00:29:43,840
format without application context

506
00:29:41,409 --> 00:29:45,940
because the update location and Sandro

507
00:29:43,840 --> 00:29:48,459
tuning for these are two operations that

508
00:29:45,940 --> 00:29:51,070
have totally different application

509
00:29:48,460 --> 00:29:53,200
context and now we basically just

510
00:29:51,070 --> 00:29:55,570
getting rid of the application context

511
00:29:53,200 --> 00:29:58,479
and trying to push two messages you want

512
00:29:55,570 --> 00:30:00,428
a cup component and what happens so our

513
00:29:58,479 --> 00:30:02,950
goal is not update location so which

514
00:30:00,429 --> 00:30:05,099
will be making it legal so we can even

515
00:30:02,950 --> 00:30:09,090
use our own SIM card because if for

516
00:30:05,099 --> 00:30:12,460
example if there are some special fast

517
00:30:09,090 --> 00:30:14,559
fast movement checks for the operator

518
00:30:12,460 --> 00:30:16,960
subscriber we can use our own SIM card

519
00:30:14,559 --> 00:30:17,899
so for example so it doesn't trigger any

520
00:30:16,960 --> 00:30:20,690
rules

521
00:30:17,900 --> 00:30:22,550
and our goal is just to receive the

522
00:30:20,690 --> 00:30:27,110
routing information by the central team

523
00:30:22,550 --> 00:30:31,370
info procedure so the message is sent to

524
00:30:27,110 --> 00:30:34,250
the ss7 firewall again it's only inspect

525
00:30:31,370 --> 00:30:37,370
the first component so it's it looks

526
00:30:34,250 --> 00:30:38,960
that the update location is fine and

527
00:30:37,370 --> 00:30:45,290
then transfer the message back to the

528
00:30:38,960 --> 00:30:49,340
STP and the SDP transfers it to HL r and

529
00:30:45,290 --> 00:30:53,780
then HL r is going to respond so they as

530
00:30:49,340 --> 00:30:56,530
the s RI message reached the HLR so it's

531
00:30:53,780 --> 00:30:59,510
going to respond with reject and

532
00:30:56,530 --> 00:31:03,790
transfer the data on the routing

533
00:30:59,510 --> 00:31:08,510
information and the EC so now let's

534
00:31:03,790 --> 00:31:10,730
switch to the case number three so what

535
00:31:08,510 --> 00:31:13,940
if we tried to use the application

536
00:31:10,730 --> 00:31:18,740
context that is actually appropriate for

537
00:31:13,940 --> 00:31:21,410
both component so for example network

538
00:31:18,740 --> 00:31:24,110
location update context is used for

539
00:31:21,410 --> 00:31:27,290
update location restore data subscriber

540
00:31:24,110 --> 00:31:29,120
data management context is used for in

541
00:31:27,290 --> 00:31:32,330
source subscriber data delete subscriber

542
00:31:29,120 --> 00:31:33,709
data and short short message gateway

543
00:31:32,330 --> 00:31:35,720
context can be used to be the

544
00:31:33,710 --> 00:31:38,000
combination of Sam routine for SM and

545
00:31:35,720 --> 00:31:42,680
report the same delivery status so as we

546
00:31:38,000 --> 00:31:45,470
already observed the SMS from rotor and

547
00:31:42,680 --> 00:31:50,540
the firewall bypass for the survive for

548
00:31:45,470 --> 00:31:53,330
a same procedure now we going to combine

549
00:31:50,540 --> 00:31:55,250
the insert subscriber data and delete

550
00:31:53,330 --> 00:31:59,320
subscriber data for the profile

551
00:31:55,250 --> 00:32:02,120
manipulation in order to let's say

552
00:31:59,320 --> 00:32:03,919
reroute the subscriber calls to a

553
00:32:02,120 --> 00:32:05,239
premium rate number that for example for

554
00:32:03,920 --> 00:32:09,230
example a hacker alms

555
00:32:05,240 --> 00:32:12,010
so how it's gonna be done so the

556
00:32:09,230 --> 00:32:15,620
principles are the same

557
00:32:12,010 --> 00:32:21,440
so first of all a profile change

558
00:32:15,620 --> 00:32:23,899
scenario how does it work so the left

559
00:32:21,440 --> 00:32:26,930
side is just the home subscriber network

560
00:32:23,900 --> 00:32:28,790
and the right side is the business to

561
00:32:26,930 --> 00:32:29,830
subscribe network so let's read it is in

562
00:32:28,790 --> 00:32:33,070
Netherland and

563
00:32:29,830 --> 00:32:36,340
and once subscriber arrives and have the

564
00:32:33,070 --> 00:32:40,750
radio coverage what is going on on the

565
00:32:36,340 --> 00:32:44,020
signaling layer so the MSC vlr that is

566
00:32:40,750 --> 00:32:48,400
located in netherlands is sending update

567
00:32:44,020 --> 00:32:51,490
location request so to the HLR to the

568
00:32:48,400 --> 00:32:53,710
home subscriber location register so

569
00:32:51,490 --> 00:32:55,780
subscriber is telling I want to register

570
00:32:53,710 --> 00:32:57,880
here on that network to receive calls

571
00:32:55,780 --> 00:33:03,520
and messages and stuff like that

572
00:32:57,880 --> 00:33:07,960
and with in terms of that AB that

573
00:33:03,520 --> 00:33:10,840
location procedure the profile is being

574
00:33:07,960 --> 00:33:14,710
put on the visited location register so

575
00:33:10,840 --> 00:33:18,899
the Netherland am a civil are and it is

576
00:33:14,710 --> 00:33:21,910
act basically by return result last and

577
00:33:18,900 --> 00:33:24,820
then we get the update location response

578
00:33:21,910 --> 00:33:30,040
so the procedure was performed correctly

579
00:33:24,820 --> 00:33:32,580
and one subscriber is registered and his

580
00:33:30,040 --> 00:33:36,190
profile was delivered to the MSC Villar

581
00:33:32,580 --> 00:33:38,649
there there are possibilities for

582
00:33:36,190 --> 00:33:42,010
changing the profile from the home

583
00:33:38,650 --> 00:33:45,010
network so for example I've received

584
00:33:42,010 --> 00:33:46,870
some notification about that they're on

585
00:33:45,010 --> 00:33:49,570
us settings of the operator to be

586
00:33:46,870 --> 00:33:52,300
applied so for example access port name

587
00:33:49,570 --> 00:33:55,000
to be changed and I agreed so basically

588
00:33:52,300 --> 00:33:57,550
what was on the signaling layer there

589
00:33:55,000 --> 00:33:59,590
was an insert in this situation there

590
00:33:57,550 --> 00:34:04,060
was an insert subscriber data request

591
00:33:59,590 --> 00:34:08,259
using our MC and the profile parameters

592
00:34:04,060 --> 00:34:11,380
was for example access port name and the

593
00:34:08,260 --> 00:34:15,100
wheel are after that it updates the

594
00:34:11,380 --> 00:34:17,770
profile in the database and sends a

595
00:34:15,100 --> 00:34:20,830
response so the procedure performed

596
00:34:17,770 --> 00:34:25,060
successfully so how can can it actually

597
00:34:20,830 --> 00:34:29,889
be and it's act via tick up and so how

598
00:34:25,060 --> 00:34:35,380
can it be abused so let's just imagine

599
00:34:29,889 --> 00:34:39,850
that the hacker using that I survive for

600
00:34:35,380 --> 00:34:43,010
some hum bolting bypass received the MC

601
00:34:39,850 --> 00:34:45,739
and the the MSC Villar identifier where

602
00:34:43,010 --> 00:34:50,360
we are currently located is sending the

603
00:34:45,739 --> 00:34:53,689
ISDN message using their that MC and is

604
00:34:50,360 --> 00:34:56,030
trying to do any type of changes in the

605
00:34:53,690 --> 00:34:58,820
real are so where we currently register

606
00:34:56,030 --> 00:35:01,190
so this changes my influence on our

607
00:34:58,820 --> 00:35:03,440
service availability or call processing

608
00:35:01,190 --> 00:35:09,380
so now let's observe what can what the

609
00:35:03,440 --> 00:35:12,080
hacker can do so first of all how the

610
00:35:09,380 --> 00:35:16,880
network protects against that methods so

611
00:35:12,080 --> 00:35:20,600
when the ISDN requests come there is a

612
00:35:16,880 --> 00:35:23,000
comparison for the MC and subscribe a

613
00:35:20,600 --> 00:35:25,940
whole network so this type of procedure

614
00:35:23,000 --> 00:35:28,070
like is d in sorts of tribal data and

615
00:35:25,940 --> 00:35:29,570
these the delete subscriber data they

616
00:35:28,070 --> 00:35:33,460
are only allowed from the home

617
00:35:29,570 --> 00:35:37,550
subscriber network so for the there is

618
00:35:33,460 --> 00:35:40,160
the firewalls and or the STP they do a

619
00:35:37,550 --> 00:35:43,160
comparison of the operator based on the

620
00:35:40,160 --> 00:35:45,529
MC identifier and subscriber a home

621
00:35:43,160 --> 00:35:51,470
network so they that based on the

622
00:35:45,530 --> 00:35:55,910
calling GT and so once a hacker

623
00:35:51,470 --> 00:35:59,209
since the ISDN that is related not for

624
00:35:55,910 --> 00:36:04,700
the MC where he is connected what

625
00:35:59,210 --> 00:36:06,620
happens so there is a check and then we

626
00:36:04,700 --> 00:36:09,080
can see that the hacker provider is

627
00:36:06,620 --> 00:36:11,450
actually is not correlating with the MC

628
00:36:09,080 --> 00:36:16,880
that's why the network blocks this type

629
00:36:11,450 --> 00:36:21,470
of ISDN messages and as this is a

630
00:36:16,880 --> 00:36:25,060
category two J's may ask message and it

631
00:36:21,470 --> 00:36:28,160
requires this type of correlation and

632
00:36:25,060 --> 00:36:31,600
once this type of address for example

633
00:36:28,160 --> 00:36:35,060
that is trying to do this is do request

634
00:36:31,600 --> 00:36:37,100
is identified it might be full block for

635
00:36:35,060 --> 00:36:45,380
example because it was identified as a

636
00:36:37,100 --> 00:36:47,600
hacker node so now we're using the

637
00:36:45,380 --> 00:36:49,190
application context name appropriate for

638
00:36:47,600 --> 00:36:53,790
both components and we're going to deal

639
00:36:49,190 --> 00:36:57,480
with the profile change so we

640
00:36:53,790 --> 00:37:02,880
two components in one teacup that one is

641
00:36:57,480 --> 00:37:05,040
ISD and another one is DS d delete

642
00:37:02,880 --> 00:37:08,250
subscriber data and what we do in the

643
00:37:05,040 --> 00:37:10,140
first component we do illegal ISD

644
00:37:08,250 --> 00:37:12,090
procedure so for example if we are

645
00:37:10,140 --> 00:37:15,000
connected in netherland Network and

646
00:37:12,090 --> 00:37:17,690
attacking from nesland network then we

647
00:37:15,000 --> 00:37:20,640
are using the IC for a random

648
00:37:17,690 --> 00:37:26,220
Netherlands subscriber random MC

649
00:37:20,640 --> 00:37:29,460
identifier and we do a DSD with the MC

650
00:37:26,220 --> 00:37:34,410
that we require actually to change the

651
00:37:29,460 --> 00:37:36,510
profile for and what happens next so the

652
00:37:34,410 --> 00:37:39,569
message is sent to the ss7 firewall for

653
00:37:36,510 --> 00:37:42,450
inspection and the ss7 fire will inspect

654
00:37:39,570 --> 00:37:45,570
the first component only and then passes

655
00:37:42,450 --> 00:37:50,210
this message to the H log I'm a civil

656
00:37:45,570 --> 00:37:55,070
our sorry and what happens next

657
00:37:50,210 --> 00:38:00,420
so the AMS c VAR sends free to on Aurore

658
00:37:55,070 --> 00:38:02,730
message but it is still in teacup

659
00:38:00,420 --> 00:38:05,390
continue so it's basically saying I do

660
00:38:02,730 --> 00:38:09,150
not understand you please repeat what

661
00:38:05,390 --> 00:38:13,170
we're going to do next so we want to

662
00:38:09,150 --> 00:38:18,180
continue the dialogue and so the hacker

663
00:38:13,170 --> 00:38:22,140
sends now the insert subscriber data

664
00:38:18,180 --> 00:38:24,419
requests again the same like it was in

665
00:38:22,140 --> 00:38:27,660
the first request and then it changes

666
00:38:24,420 --> 00:38:29,880
they delete subscriber data to insert

667
00:38:27,660 --> 00:38:34,069
subscriber data because he wants to

668
00:38:29,880 --> 00:38:37,050
modify the profile with the same data

669
00:38:34,070 --> 00:38:40,170
for the same subscriber MC that was

670
00:38:37,050 --> 00:38:43,470
found on the previous steps and what

671
00:38:40,170 --> 00:38:48,840
happens actually so the ss7 firewall

672
00:38:43,470 --> 00:38:52,379
even if the ss7 firewall in rare cases

673
00:38:48,840 --> 00:38:54,900
may be set to inspect the teacup

674
00:38:52,380 --> 00:38:57,030
continue message so even if again it

675
00:38:54,900 --> 00:38:58,980
goes to the s7 feral however in most

676
00:38:57,030 --> 00:39:00,510
case it will go straight to the MSC

677
00:38:58,980 --> 00:39:03,240
Villar because the communication was

678
00:39:00,510 --> 00:39:05,820
already started it again will inspect

679
00:39:03,240 --> 00:39:06,740
only the first component and pass the

680
00:39:05,820 --> 00:39:11,300
net the mess

681
00:39:06,740 --> 00:39:15,890
to the network and what happens next the

682
00:39:11,300 --> 00:39:20,869
MSC VLR actually responds okay to that

683
00:39:15,890 --> 00:39:23,839
profile in searcher and probably didn't

684
00:39:20,869 --> 00:39:27,110
show but yeah you can see that on the

685
00:39:23,840 --> 00:39:29,060
last line the hacker was trying to do

686
00:39:27,110 --> 00:39:33,080
the wheel our kennel subscription so

687
00:39:29,060 --> 00:39:37,070
basically he's the platform that is

688
00:39:33,080 --> 00:39:40,850
responsible for the clarification he

689
00:39:37,070 --> 00:39:46,100
said to his own not here and it was

690
00:39:40,850 --> 00:39:49,270
okayed and then we received return

691
00:39:46,100 --> 00:39:52,279
result last and the transaction ended so

692
00:39:49,270 --> 00:39:55,910
the hacker succeeded to modify the

693
00:39:52,280 --> 00:39:59,390
subscriber profile and now here is a

694
00:39:55,910 --> 00:40:02,690
subscriber once he decides to check or

695
00:39:59,390 --> 00:40:06,020
for example this is the the SIM card

696
00:40:02,690 --> 00:40:09,920
that the hackers achieved for some fraud

697
00:40:06,020 --> 00:40:12,680
goals when the subscriber performs a

698
00:40:09,920 --> 00:40:17,690
call the MSE Villard that is currently

699
00:40:12,680 --> 00:40:21,618
serving that that subscriber is sending

700
00:40:17,690 --> 00:40:24,470
initial DP so we the operation which

701
00:40:21,619 --> 00:40:26,510
actually contains the info about where a

702
00:40:24,470 --> 00:40:30,470
subscriber is calling where what's his

703
00:40:26,510 --> 00:40:32,810
location and what MZ and it sends this

704
00:40:30,470 --> 00:40:35,060
message to the hacker note that the

705
00:40:32,810 --> 00:40:38,540
hacker puts in the profile change

706
00:40:35,060 --> 00:40:40,759
procedure and now what what hacker can

707
00:40:38,540 --> 00:40:42,440
do he can just for example a release d

708
00:40:40,760 --> 00:40:44,450
call and the cold want to be processed

709
00:40:42,440 --> 00:40:46,310
but he will gather all the information

710
00:40:44,450 --> 00:40:48,680
about the calls about the location of

711
00:40:46,310 --> 00:40:52,430
the subscriber but it's pretty simple

712
00:40:48,680 --> 00:40:55,940
but what he can do else he can send for

713
00:40:52,430 --> 00:40:58,640
example connect message but change the

714
00:40:55,940 --> 00:41:02,570
destination wrote in address to the one

715
00:40:58,640 --> 00:41:07,009
he wants so for example he puts that

716
00:41:02,570 --> 00:41:09,050
number to some Huaraz cuba and the call

717
00:41:07,010 --> 00:41:10,580
will be redirected for example to

718
00:41:09,050 --> 00:41:11,869
premium number that the hacker

719
00:41:10,580 --> 00:41:13,700
registered on Helana

720
00:41:11,869 --> 00:41:20,000
and subscribers going to be charged for

721
00:41:13,700 --> 00:41:24,990
example several several tens of dollars

722
00:41:20,000 --> 00:41:26,910
so and exactly the same way the hacker

723
00:41:24,990 --> 00:41:32,118
can put in the destination routing

724
00:41:26,910 --> 00:41:36,200
address the the address of his own

725
00:41:32,119 --> 00:41:41,070
public's and intercept the calls so the

726
00:41:36,200 --> 00:41:43,980
principles are similar and this way the

727
00:41:41,070 --> 00:41:45,750
ss7 firewall bypassed and the SMS from

728
00:41:43,980 --> 00:41:48,330
rotor is not doing anything in this

729
00:41:45,750 --> 00:41:51,540
scenario so there is one one one case

730
00:41:48,330 --> 00:41:59,790
which actually represents an infinite

731
00:41:51,540 --> 00:42:03,150
loop so it really looks like the cycled

732
00:41:59,790 --> 00:42:07,410
communication with two soldiers so and

733
00:42:03,150 --> 00:42:13,580
the transaction can really freeze for

734
00:42:07,410 --> 00:42:13,580
long and how it's being performed so

735
00:42:13,730 --> 00:42:21,869
again we put two operations in one

736
00:42:17,700 --> 00:42:28,410
component so it's insert subscriber data

737
00:42:21,869 --> 00:42:31,770
and provide subscriber info and this

738
00:42:28,410 --> 00:42:34,680
both two components are legal so even

739
00:42:31,770 --> 00:42:38,460
they were observed by the firewall even

740
00:42:34,680 --> 00:42:42,419
the the firewall existed that by this

741
00:42:38,460 --> 00:42:46,500
time that compared both components so

742
00:42:42,420 --> 00:42:49,859
they wouldn't find anything evil and if

743
00:42:46,500 --> 00:42:52,200
the ss7 firewall would expect inspect

744
00:42:49,859 --> 00:42:55,020
all this didn't find any legitimate

745
00:42:52,200 --> 00:42:58,020
illegitimate data and it would have been

746
00:42:55,020 --> 00:43:01,470
transferred to the MSC Villar and now

747
00:42:58,020 --> 00:43:05,250
the MSC vlr would have answered with the

748
00:43:01,470 --> 00:43:09,319
return a roar and reject message in a

749
00:43:05,250 --> 00:43:12,300
teacup continue so in the communication

750
00:43:09,320 --> 00:43:15,540
continuation and what a hacker would do

751
00:43:12,300 --> 00:43:17,820
he would send just one provide

752
00:43:15,540 --> 00:43:21,060
subscriber in for and would receive

753
00:43:17,820 --> 00:43:23,130
reject in continue and so if we were to

754
00:43:21,060 --> 00:43:26,759
put a script that would have been

755
00:43:23,130 --> 00:43:29,760
answering the same so in the testbed

756
00:43:26,760 --> 00:43:30,300
this transaction kept working for six

757
00:43:29,760 --> 00:43:32,740
hours

758
00:43:30,300 --> 00:43:37,540
so from fried Friday evening to

759
00:43:32,740 --> 00:43:39,549
morning so it may just sound fun but it

760
00:43:37,540 --> 00:43:41,140
really has some threads because it

761
00:43:39,550 --> 00:43:43,780
overloads signal in channel and

762
00:43:41,140 --> 00:43:47,319
processes and it really may affect the

763
00:43:43,780 --> 00:43:49,720
signal in monitoring system so that the

764
00:43:47,320 --> 00:43:52,330
operator will not be able to correlate

765
00:43:49,720 --> 00:43:55,270
any call flows because of that overload

766
00:43:52,330 --> 00:44:00,400
and we actually made this situation at

767
00:43:55,270 --> 00:44:02,619
one Operator and I also have one bonus

768
00:44:00,400 --> 00:44:07,740
vulnerability about the operation code

769
00:44:02,619 --> 00:44:11,560
tech abuse so following the itu-t

770
00:44:07,740 --> 00:44:13,990
recommendations there are two ways to

771
00:44:11,560 --> 00:44:16,840
perform the operations there are local

772
00:44:13,990 --> 00:44:19,810
codes and global operation codes but

773
00:44:16,840 --> 00:44:23,200
I've never seen global operation codes

774
00:44:19,810 --> 00:44:25,930
being used in the inside of the SSL

775
00:44:23,200 --> 00:44:29,470
networks but the specifications actually

776
00:44:25,930 --> 00:44:35,230
allows to use global codes so if we

777
00:44:29,470 --> 00:44:38,140
actually it is being done by being coded

778
00:44:35,230 --> 00:44:42,220
by 8-bit so if we changed for change

779
00:44:38,140 --> 00:44:45,540
local operation code that is to 2 global

780
00:44:42,220 --> 00:44:48,100
operation codes and try to send the

781
00:44:45,540 --> 00:44:51,550
legitimate message so the message that

782
00:44:48,100 --> 00:44:54,700
is written being set to block I don't a

783
00:44:51,550 --> 00:45:01,210
border device or on the firewall what

784
00:44:54,700 --> 00:45:04,390
will happen so we are sending here

785
00:45:01,210 --> 00:45:06,790
there's an wrote in uniform message so

786
00:45:04,390 --> 00:45:10,480
this is a normal procedure this is local

787
00:45:06,790 --> 00:45:12,400
value and we have response so now we

788
00:45:10,480 --> 00:45:14,910
change it to global value

789
00:45:12,400 --> 00:45:17,350
first of all as you can see the

790
00:45:14,910 --> 00:45:21,850
Wireshark just read this as malicious

791
00:45:17,350 --> 00:45:24,279
and it doesn't even set the operation

792
00:45:21,850 --> 00:45:27,460
code it's only shows invoke because it

793
00:45:24,280 --> 00:45:32,010
cannot properly parse the map component

794
00:45:27,460 --> 00:45:32,010
it only parses the teacup and

795
00:45:32,470 --> 00:45:40,850
the STP is looking for a local opcode

796
00:45:37,460 --> 00:45:42,620
based on his rules and here is a global

797
00:45:40,850 --> 00:45:46,040
and they are ignored

798
00:45:42,620 --> 00:45:48,339
so the STP firewall transferred the

799
00:45:46,040 --> 00:45:52,640
message to the home location register

800
00:45:48,340 --> 00:45:54,560
and what is pretty funny here that the

801
00:45:52,640 --> 00:45:57,109
destination networks actually understand

802
00:45:54,560 --> 00:45:59,210
the global opcode and replies with the

803
00:45:57,110 --> 00:46:02,390
local opcode and not with the global one

804
00:45:59,210 --> 00:46:04,910
and requested data so and we can see the

805
00:46:02,390 --> 00:46:09,980
original result lasts and working for SM

806
00:46:04,910 --> 00:46:14,720
for with the MC with the requested MC

807
00:46:09,980 --> 00:46:18,080
and the requested MSC is being sent back

808
00:46:14,720 --> 00:46:22,520
to the hacker node and what we can see

809
00:46:18,080 --> 00:46:25,640
here that the SMS rotor is aside and the

810
00:46:22,520 --> 00:46:28,759
STP firewall is bypassed and we tested

811
00:46:25,640 --> 00:46:31,339
it on four different vendors and they

812
00:46:28,760 --> 00:46:33,520
have replied to messages with the global

813
00:46:31,340 --> 00:46:37,700
opcode

814
00:46:33,520 --> 00:46:41,780
so now for the conclusion what should be

815
00:46:37,700 --> 00:46:44,660
done by the operators so first of all it

816
00:46:41,780 --> 00:46:48,020
is required that security tools should

817
00:46:44,660 --> 00:46:51,290
be effective against new and currently

818
00:46:48,020 --> 00:46:55,190
known vulnerabilities and actually the

819
00:46:51,290 --> 00:46:58,160
only way here seems is just to be on the

820
00:46:55,190 --> 00:47:04,040
way for of recent research because the

821
00:46:58,160 --> 00:47:08,089
ss7 field it really seems to be so not

822
00:47:04,040 --> 00:47:11,480
yet well explored because during years

823
00:47:08,090 --> 00:47:15,110
the new zero days are being found and if

824
00:47:11,480 --> 00:47:17,480
you're not following the GSMA documents

825
00:47:15,110 --> 00:47:20,330
and not exploring the recent research

826
00:47:17,480 --> 00:47:22,640
you may have a trouble because it's not

827
00:47:20,330 --> 00:47:25,490
it's not only the white hackers the

828
00:47:22,640 --> 00:47:29,900
research is who doing tricks with the

829
00:47:25,490 --> 00:47:34,629
ss7 it's also malicious people and

830
00:47:29,900 --> 00:47:37,160
hackers so using an intrusion detection

831
00:47:34,630 --> 00:47:41,300
solution so along with the assistant

832
00:47:37,160 --> 00:47:42,940
firewall in order to detect threats at

833
00:47:41,300 --> 00:47:46,089
the occurs

834
00:47:42,940 --> 00:47:50,200
and locking a hostile source if there

835
00:47:46,089 --> 00:47:52,619
are no current means to contract for the

836
00:47:50,200 --> 00:47:57,730
operations that that were met by the

837
00:47:52,619 --> 00:48:01,420
intrusion detection system so and one of

838
00:47:57,730 --> 00:48:05,440
the most important so teacup component

839
00:48:01,420 --> 00:48:09,970
in the beacon in the begin with multiple

840
00:48:05,440 --> 00:48:13,300
map component so we only observed only

841
00:48:09,970 --> 00:48:15,399
one legal part and its begin subscriber

842
00:48:13,300 --> 00:48:19,270
activity plus process unstructured

843
00:48:15,400 --> 00:48:23,560
assess data so actually this combination

844
00:48:19,270 --> 00:48:27,190
is used for an old phones on old

845
00:48:23,560 --> 00:48:31,240
equipment to be able to process some

846
00:48:27,190 --> 00:48:34,720
uses the function for old Mobile's so

847
00:48:31,240 --> 00:48:38,950
although it's not that often are being

848
00:48:34,720 --> 00:48:41,950
met but we only see this combination

849
00:48:38,950 --> 00:48:44,618
being legal so although the tea cup has

850
00:48:41,950 --> 00:48:49,089
a feature of several components it's

851
00:48:44,619 --> 00:48:53,589
only used once and for just some

852
00:48:49,089 --> 00:48:57,310
outdated equipment the SDP and the

853
00:48:53,589 --> 00:49:00,040
firewall should be configured carefully

854
00:48:57,310 --> 00:49:04,180
and the global opcode should also be

855
00:49:00,040 --> 00:49:08,740
observed and as I already told so all

856
00:49:04,180 --> 00:49:10,839
this information goes in GSM a FAS g FS

857
00:49:08,740 --> 00:49:14,200
11 document with the current change

858
00:49:10,839 --> 00:49:16,930
request but by the date it's not yet

859
00:49:14,200 --> 00:49:21,899
published as far as I know but I hope

860
00:49:16,930 --> 00:49:24,578
it's going to be in May so I think

861
00:49:21,900 --> 00:49:34,260
that's it for today and I'm open to your

862
00:49:24,579 --> 00:49:34,260
questions any hands

863
00:49:37,910 --> 00:49:51,450
does anybody have a question yeah I can

864
00:49:41,700 --> 00:49:54,149
see a hand hi hello a stock question

865
00:49:51,450 --> 00:49:57,029
have you found these type of stacks

866
00:49:54,150 --> 00:50:01,050
exploited in the wild by black hats or

867
00:49:57,030 --> 00:50:03,060
unknown attackers you mean yeah or is it

868
00:50:01,050 --> 00:50:06,810
possible to detect these types of

869
00:50:03,060 --> 00:50:08,549
attacks yes it is possible to detect

870
00:50:06,810 --> 00:50:13,200
this type of attacks because once we

871
00:50:08,550 --> 00:50:15,810
identified it was possible so like

872
00:50:13,200 --> 00:50:18,330
immediately we made the signatures to

873
00:50:15,810 --> 00:50:20,370
detect this type of attacks and to be

874
00:50:18,330 --> 00:50:24,270
able to block this type of attacks so I

875
00:50:20,370 --> 00:50:30,029
mean these changes change request that

876
00:50:24,270 --> 00:50:32,730
goes to JCM F ask documents it's it may

877
00:50:30,030 --> 00:50:34,710
take really ages for the vendors of

878
00:50:32,730 --> 00:50:36,390
telco equipment for the security vendors

879
00:50:34,710 --> 00:50:38,730
to implement such type of checks and

880
00:50:36,390 --> 00:50:41,490
that's why it's really important to be

881
00:50:38,730 --> 00:50:44,820
on the wave of that research and because

882
00:50:41,490 --> 00:50:48,810
once we find something we just put it in

883
00:50:44,820 --> 00:50:52,110
the our knowledge base and to be able to

884
00:50:48,810 --> 00:50:54,540
detect with the security products that

885
00:50:52,110 --> 00:50:56,960
we suggest so with detection I was

886
00:50:54,540 --> 00:50:59,759
referring more to end-user not telcos

887
00:50:56,960 --> 00:51:01,590
sorry for detection you for detecting

888
00:50:59,760 --> 00:51:03,810
attacks are referring more can the

889
00:51:01,590 --> 00:51:06,750
end-user detect these types of attacks

890
00:51:03,810 --> 00:51:09,900
no and user is not able to detect this

891
00:51:06,750 --> 00:51:13,250
type of text because all this operation

892
00:51:09,900 --> 00:51:16,890
that we actually observed today they are

893
00:51:13,250 --> 00:51:19,080
being processed in the core network so

894
00:51:16,890 --> 00:51:21,270
and from the mobile device you do not

895
00:51:19,080 --> 00:51:26,580
have the axis so you're only contacting

896
00:51:21,270 --> 00:51:29,070
with the radio and actually just the

897
00:51:26,580 --> 00:51:30,870
radio contact is pretty secure because

898
00:51:29,070 --> 00:51:36,810
it is a cipher and it's not like the

899
00:51:30,870 --> 00:51:41,880
core of SSM system so I mean for most of

900
00:51:36,810 --> 00:51:43,779
the of the severe ss7 vulnerabilities

901
00:51:41,880 --> 00:51:47,020
how you can

902
00:51:43,780 --> 00:51:49,450
help yourself to protect from you can

903
00:51:47,020 --> 00:51:52,030
try to disable roaming when you are not

904
00:51:49,450 --> 00:51:56,830
actually roaming but still there are

905
00:51:52,030 --> 00:52:00,040
ways to bypass that so but from the some

906
00:51:56,830 --> 00:52:02,049
novice hackers or just the hackers that

907
00:52:00,040 --> 00:52:04,710
are using some open-source tools it will

908
00:52:02,050 --> 00:52:04,710
definitely help

909
00:52:07,260 --> 00:52:17,380
how easy is for attackers to gain access

910
00:52:10,360 --> 00:52:27,340
to ss7 ok so basically there were

911
00:52:17,380 --> 00:52:34,570
several how would you say so we tried to

912
00:52:27,340 --> 00:52:37,720
find out how easy it was in 2014 and we

913
00:52:34,570 --> 00:52:39,760
just send like basically a document that

914
00:52:37,720 --> 00:52:41,740
is telling that we got we want to be a

915
00:52:39,760 --> 00:52:45,100
value-added service provider to send the

916
00:52:41,740 --> 00:52:47,830
weather forecast so and we would like it

917
00:52:45,100 --> 00:52:50,200
to a connection to your operator and we

918
00:52:47,830 --> 00:52:55,720
send it to several operators in Asia and

919
00:52:50,200 --> 00:52:57,910
Africa and in the time of 2 or 3 days we

920
00:52:55,720 --> 00:53:01,359
actually agreed on the price like 3k so

921
00:52:57,910 --> 00:53:03,730
it was 2014 basically to get the exes is

922
00:53:01,360 --> 00:53:06,220
just a matter of money and the

923
00:53:03,730 --> 00:53:09,160
journalists of Daily Beast last year I

924
00:53:06,220 --> 00:53:14,230
think it was September October

925
00:53:09,160 --> 00:53:16,839
they also made that similar type of

926
00:53:14,230 --> 00:53:22,030
research and they were contacting the

927
00:53:16,840 --> 00:53:24,430
operator in the Europe and so as far as

928
00:53:22,030 --> 00:53:26,200
I remember it coasted like already 10k

929
00:53:24,430 --> 00:53:28,779
for them to get a connection and

930
00:53:26,200 --> 00:53:32,350
probably the fifth further month would

931
00:53:28,780 --> 00:53:34,960
be just less expensive so I mean it's

932
00:53:32,350 --> 00:53:36,759
just a matter of money and we have a

933
00:53:34,960 --> 00:53:37,690
four hour security assessment we have a

934
00:53:36,760 --> 00:53:39,910
legal

935
00:53:37,690 --> 00:53:42,610
I mean connection so we are not doing

936
00:53:39,910 --> 00:53:46,000
something bad on purpose so it's only

937
00:53:42,610 --> 00:53:47,410
agreed with the operator but I mean what

938
00:53:46,000 --> 00:53:49,390
prevents some hacker

939
00:53:47,410 --> 00:53:52,870
from getting the connection and doing

940
00:53:49,390 --> 00:53:57,970
the bad things because like it's not yet

941
00:53:52,870 --> 00:54:00,430
well I mean documented the

942
00:53:57,970 --> 00:54:02,919
a responsibility for that type of vortex

943
00:54:00,430 --> 00:54:04,960
so even if that that loud case that

944
00:54:02,920 --> 00:54:08,440
happened with banks when the money got

945
00:54:04,960 --> 00:54:11,619
transferred to hackers so it's really

946
00:54:08,440 --> 00:54:13,119
easy to share the fault like this is the

947
00:54:11,619 --> 00:54:18,819
bank's responsibility this is the

948
00:54:13,119 --> 00:54:20,440
operator so I mean for now there are a

949
00:54:18,819 --> 00:54:23,730
lot of discussions going on the

950
00:54:20,440 --> 00:54:32,859
interconnection roaming fraud and how to

951
00:54:23,730 --> 00:54:41,920
prevent and share responsibility so any

952
00:54:32,859 --> 00:54:43,960
more any more okay then please give a

953
00:54:41,920 --> 00:54:44,040
big hand for illegal booze ankle

954
00:54:43,960 --> 00:54:49,460
[Music]

955
00:54:44,040 --> 00:54:49,460
[Applause]

956
00:54:54,340 --> 00:54:56,400
you

