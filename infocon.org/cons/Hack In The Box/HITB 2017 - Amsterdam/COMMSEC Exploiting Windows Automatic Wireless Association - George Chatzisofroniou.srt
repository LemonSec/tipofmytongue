1
00:00:09,260 --> 00:00:14,270
hello everyone<font color="#E5E5E5"> thank you for coming my</font>

2
00:00:12,320 --> 00:00:17,900
name is George had this offer new it's a

3
00:00:14,270 --> 00:00:19,939
little hard spell I work as security

4
00:00:17,900 --> 00:00:21,860
engineer at<font color="#CCCCCC"> census a great company that</font>

5
00:00:19,939 --> 00:00:26,840
provides specialized IT security service

6
00:00:21,860 --> 00:00:29,210
to its customers I'm very exciting to be

7
00:00:26,840 --> 00:00:31,720
here today because we're going to I'm

8
00:00:29,210 --> 00:00:34,190
going to present to you something that

9
00:00:31,720 --> 00:00:37,370
is novel and I've never presented to<font color="#E5E5E5"> in</font>

10
00:00:34,190 --> 00:00:38,629
conference before it's called low 10 the

11
00:00:37,370 --> 00:00:42,250
title is exploiting windows

12
00:00:38,629 --> 00:00:45,199
automatically lose<font color="#E5E5E5"> Association algorithm</font>

13
00:00:42,250 --> 00:00:46,460
what is really special<font color="#E5E5E5"> about this kind</font>

14
00:00:45,199 --> 00:00:49,849
of attack what I'm going<font color="#E5E5E5"> to present to</font>

15
00:00:46,460 --> 00:00:51,379
<font color="#CCCCCC">you is that</font><font color="#E5E5E5"> it's part of a category of</font>

16
00:00:49,850 --> 00:00:56,180
attacks called Wi-Fi automatic

17
00:00:51,379 --> 00:00:58,280
<font color="#CCCCCC">Association attacks these are very cool</font>

18
00:00:56,180 --> 00:01:00,140
attacks in my opinion because they

19
00:00:58,280 --> 00:01:01,760
<font color="#CCCCCC">actually allow you to gain a man in the</font>

20
00:01:00,140 --> 00:01:06,820
middle position without requiring any

21
00:01:01,760 --> 00:01:10,520
user interaction<font color="#CCCCCC"> okay so that means that</font>

22
00:01:06,820 --> 00:01:12,500
<font color="#CCCCCC">any Wi-Fi enabled device that could be</font>

23
00:01:10,520 --> 00:01:16,520
your laptop<font color="#E5E5E5"> that could be your tablet or</font>

24
00:01:12,500 --> 00:01:20,240
your desktop if you have<font color="#E5E5E5"> a wireless card</font>

25
00:01:16,520 --> 00:01:23,110
a test is vulnerable<font color="#CCCCCC"> to these kind of</font>

26
00:01:20,240 --> 00:01:26,330
attacks without requiring any

27
00:01:23,110 --> 00:01:28,190
interaction from the user the only

28
00:01:26,330 --> 00:01:31,429
requirement<font color="#CCCCCC"> is that the victim needs to</font>

29
00:01:28,190 --> 00:01:37,250
be within the<font color="#E5E5E5"> vicinity close to the</font>

30
00:01:31,430 --> 00:01:39,050
attackers rogue access point<font color="#CCCCCC"> okay and as</font>

31
00:01:37,250 --> 00:01:42,560
you can probably guess there is a

32
00:01:39,050 --> 00:01:44,120
significant impact to<font color="#E5E5E5"> this since there</font>

33
00:01:42,560 --> 00:01:47,180
are a lot of software most of them

34
00:01:44,120 --> 00:01:50,360
actually do not carry any proactive

35
00:01:47,180 --> 00:01:51,980
protections against money the middle so

36
00:01:50,360 --> 00:01:57,760
these kinds of attack you<font color="#E5E5E5"> gamin the</font>

37
00:01:51,980 --> 00:01:57,760
middle just like that very simple<font color="#E5E5E5"> okay</font>

38
00:01:59,440 --> 00:02:05,149
does anybody know the car<font color="#CCCCCC"> Mata please</font>

39
00:02:01,880 --> 00:02:08,329
raise your hands nice I see a few hands

40
00:02:05,150 --> 00:02:11,030
their show in the calm attack what is

41
00:02:08,330 --> 00:02:14,780
<font color="#E5E5E5">happening is that let's say that some of</font>

42
00:02:11,030 --> 00:02:19,700
you here are visited hacking the box

43
00:02:14,780 --> 00:02:22,249
free Wi-Fi that is in the air so<font color="#CCCCCC"> as soon</font>

44
00:02:19,700 --> 00:02:23,109
<font color="#E5E5E5">as you go back back home your device</font><font color="#CCCCCC"> is</font>

45
00:02:22,249 --> 00:02:25,269
going to ask for

46
00:02:23,110 --> 00:02:27,760
this<font color="#E5E5E5"> network again and again most likely</font>

47
00:02:25,270 --> 00:02:29,110
it is going to happen okay your<font color="#E5E5E5"> device</font>

48
00:02:27,760 --> 00:02:31,209
<font color="#CCCCCC">is going to your mobile phone is going</font>

49
00:02:29,110 --> 00:02:33,160
<font color="#E5E5E5">to ask for this specific</font><font color="#CCCCCC"> network it's</font>

50
00:02:31,210 --> 00:02:36,040
going to<font color="#CCCCCC"> solve</font><font color="#E5E5E5"> the error Hayes cutting</font>

51
00:02:33,160 --> 00:02:38,140
the books free Wi-Fi here this is<font color="#E5E5E5"> called</font>

52
00:02:36,040 --> 00:02:41,320
<font color="#E5E5E5">the probe request frame that this</font>

53
00:02:38,140 --> 00:02:45,190
methods right the thing is that an

54
00:02:41,320 --> 00:02:46,600
attacker can say hey yeah Here I am I am

55
00:02:45,190 --> 00:02:52,359
the free Wi-Fi that you are looking for

56
00:02:46,600 --> 00:02:56,290
and that the probably the standard way

57
00:02:52,360 --> 00:03:01,380
for the past<font color="#CCCCCC"> ten years to get a man in</font>

58
00:02:56,290 --> 00:03:07,600
the middle position so as you see there

59
00:03:01,380 --> 00:03:10,299
on<font color="#E5E5E5"> this diagram the laptop that is top</font>

60
00:03:07,600 --> 00:03:12,519
right is sending the probe request frame

61
00:03:10,300 --> 00:03:15,850
and the access point is responding yet

62
00:03:12,520 --> 00:03:18,370
<font color="#CCCCCC">here I am here are my encryption type</font>

63
00:03:15,850 --> 00:03:20,290
our transmission rates and other

64
00:03:18,370 --> 00:03:22,540
information the problem with that is

65
00:03:20,290 --> 00:03:23,920
that as soon as the laptop<font color="#CCCCCC"> sent the</font>

66
00:03:22,540 --> 00:03:26,260
<font color="#E5E5E5">probe</font><font color="#CCCCCC"> lillestrøm</font><font color="#E5E5E5"> an attacker can say</font>

67
00:03:23,920 --> 00:03:29,470
yes no I am the network but you are

68
00:03:26,260 --> 00:03:31,390
looking for this is the<font color="#CCCCCC"> term</font><font color="#E5E5E5"> attack it</font>

69
00:03:29,470 --> 00:03:33,100
<font color="#CCCCCC">was presented more than</font><font color="#E5E5E5"> 10 years ago and</font>

70
00:03:31,390 --> 00:03:34,649
there are still devices that are

71
00:03:33,100 --> 00:03:38,859
vulnerable to this<font color="#E5E5E5"> kind of attack</font>

72
00:03:34,650 --> 00:03:41,290
however<font color="#E5E5E5"> modern operating systems and</font>

73
00:03:38,860 --> 00:03:45,130
network manager specifically have

74
00:03:41,290 --> 00:03:49,510
countermeasures against this so for

75
00:03:45,130 --> 00:03:52,510
example Windows Windows 10 and Windows

76
00:03:49,510 --> 00:03:56,829
Phone 8.1<font color="#E5E5E5"> our and vulnerable to this</font>

77
00:03:52,510 --> 00:04:00,760
attack because first of all when you

78
00:03:56,830 --> 00:04:03,970
join an open network with your<font color="#E5E5E5"> Windows</font>

79
00:04:00,760 --> 00:04:06,820
device it's not going to add this

80
00:04:03,970 --> 00:04:09,250
network to its pnl what is the<font color="#CCCCCC"> PNL the</font>

81
00:04:06,820 --> 00:04:10,780
preferred network list this is the least

82
00:04:09,250 --> 00:04:13,780
of the networks that is going to keep

83
00:04:10,780 --> 00:04:15,519
<font color="#CCCCCC">asking everywhere your devices wherever</font>

84
00:04:13,780 --> 00:04:20,829
it is is going to ask for the<font color="#E5E5E5"> networks</font>

85
00:04:15,519 --> 00:04:25,510
that exist in the<font color="#CCCCCC"> PNL</font><font color="#E5E5E5"> okay so windows</font>

86
00:04:20,829 --> 00:04:28,180
won't really add any open network that

87
00:04:25,510 --> 00:04:30,729
<font color="#CCCCCC">we joined by default you can manually go</font>

88
00:04:28,180 --> 00:04:32,740
there and said yes please connect

89
00:04:30,729 --> 00:04:34,659
automatically to this network but by

90
00:04:32,740 --> 00:04:37,000
default is not going to happen that's

91
00:04:34,660 --> 00:04:39,520
number<font color="#E5E5E5"> one hundred measure are</font>

92
00:04:37,000 --> 00:04:44,830
<font color="#CCCCCC">microsoft did the second one has to do</font>

93
00:04:39,520 --> 00:04:46,120
that you saw earlier how the mobile

94
00:04:44,830 --> 00:04:47,830
device<font color="#E5E5E5"> is going to send a probe request</font>

95
00:04:46,120 --> 00:04:51,280
frame and the access point is<font color="#E5E5E5"> going to</font>

96
00:04:47,830 --> 00:04:53,770
respond<font color="#CCCCCC"> with a probe response brain this</font>

97
00:04:51,280 --> 00:04:56,260
shouldn't be the way that<font color="#E5E5E5"> things would</font>

98
00:04:53,770 --> 00:04:58,180
work so the proper way to do it is<font color="#E5E5E5"> that</font>

99
00:04:56,260 --> 00:05:01,150
the access point should send that the

100
00:04:58,180 --> 00:05:02,890
<font color="#E5E5E5">so-called beacon frame so the big old</font>

101
00:05:01,150 --> 00:05:06,070
frame is what the access point sends to

102
00:05:02,890 --> 00:05:07,419
everyone broadcasts<font color="#CCCCCC"> to the air and</font><font color="#E5E5E5"> it's</font>

103
00:05:06,070 --> 00:05:09,820
a way of the access point to say hey<font color="#E5E5E5"> I</font>

104
00:05:07,420 --> 00:05:11,890
am access point with essid yet aside is

105
00:05:09,820 --> 00:05:15,190
the name of the network with essid

106
00:05:11,890 --> 00:05:17,110
marble or whatever<font color="#CCCCCC"> Siri</font><font color="#E5E5E5"> some information</font>

107
00:05:15,190 --> 00:05:19,060
about<font color="#E5E5E5"> me if there are any client that</font>

108
00:05:17,110 --> 00:05:20,950
wants to<font color="#E5E5E5"> connect to me please send the</font>

109
00:05:19,060 --> 00:05:23,590
program<font color="#E5E5E5"> where same this</font><font color="#CCCCCC"> is a proper way</font>

110
00:05:20,950 --> 00:05:25,150
what you see there so the access point

111
00:05:23,590 --> 00:05:29,679
is actually sending the Beacon frame

112
00:05:25,150 --> 00:05:32,049
<font color="#E5E5E5">first and then the</font><font color="#CCCCCC"> client will actually</font>

113
00:05:29,680 --> 00:05:35,050
connect ask send the probe request frame

114
00:05:32,050 --> 00:05:41,370
and continue with the<font color="#CCCCCC"> Association</font>

115
00:05:35,050 --> 00:05:41,370
process<font color="#CCCCCC"> ok so these two countermeasures</font>

116
00:05:41,910 --> 00:05:50,830
actually made windows are not vulnerable

117
00:05:45,669 --> 00:05:54,359
to karma attacks so before I go to<font color="#E5E5E5"> the</font>

118
00:05:50,830 --> 00:05:56,620
next slide that means are we protected

119
00:05:54,360 --> 00:05:58,600
does that mean that there is no way to

120
00:05:56,620 --> 00:06:01,000
get automatic Association and automatic

121
00:05:58,600 --> 00:06:03,370
money the middle of windows and<font color="#E5E5E5"> for</font>

122
00:06:01,000 --> 00:06:07,360
samples no because<font color="#E5E5E5"> Microsoft came with</font>

123
00:06:03,370 --> 00:06:08,530
<font color="#E5E5E5">this picture called Wi-Fi sense ok so</font>

124
00:06:07,360 --> 00:06:10,330
I'm going<font color="#E5E5E5"> to read that to you to get you</font>

125
00:06:08,530 --> 00:06:12,309
on<font color="#CCCCCC"> the internet more quickly in more</font>

126
00:06:10,330 --> 00:06:14,320
places Wi-Fi sense automatically

127
00:06:12,310 --> 00:06:17,710
connects you to open Wi-Fi hotspots it

128
00:06:14,320 --> 00:06:19,960
knows about through crowd sourcing of

129
00:06:17,710 --> 00:06:22,810
course this is a usability over security

130
00:06:19,960 --> 00:06:24,909
feature maybe some of you remember this

131
00:06:22,810 --> 00:06:27,790
feature because it was heavily

132
00:06:24,910 --> 00:06:29,500
<font color="#E5E5E5">criticized by the community for allowing</font>

133
00:06:27,790 --> 00:06:31,390
anyone that gets access to your network

134
00:06:29,500 --> 00:06:36,400
to share it with<font color="#CCCCCC"> their friends on</font>

135
00:06:31,390 --> 00:06:37,930
<font color="#CCCCCC">facebook or outlook contacts so</font><font color="#E5E5E5"> I</font>

136
00:06:36,400 --> 00:06:39,310
remember when this<font color="#E5E5E5"> picture came out a</font>

137
00:06:37,930 --> 00:06:42,790
lot of people<font color="#E5E5E5"> came and say no we don't</font>

138
00:06:39,310 --> 00:06:44,650
want to share our network the thing is

139
00:06:42,790 --> 00:06:46,990
that<font color="#E5E5E5"> this picture the one that</font><font color="#CCCCCC"> serves</font>

140
00:06:44,650 --> 00:06:50,888
your network with<font color="#E5E5E5"> your friends has been</font>

141
00:06:46,990 --> 00:06:52,449
removed after an update how

142
00:06:50,889 --> 00:06:56,680
Wi-Fi sense hasn't<font color="#E5E5E5"> been completely</font>

143
00:06:52,449 --> 00:06:58,659
removed so still Wi-Fi sense is going<font color="#CCCCCC"> to</font>

144
00:06:56,680 --> 00:07:03,340
connect you to some public hot<font color="#CCCCCC"> spots</font>

145
00:06:58,659 --> 00:07:05,199
that Microsoft considers secure and this

146
00:07:03,340 --> 00:07:08,318
feature is enabled by default on Windows

147
00:07:05,199 --> 00:07:11,080
10 and Windows Phone 8.1 so as<font color="#E5E5E5"> you see</font>

148
00:07:08,319 --> 00:07:12,430
on<font color="#CCCCCC"> the screen so</font><font color="#E5E5E5"> there there are some</font>

149
00:07:11,080 --> 00:07:15,219
networks when you're using windows

150
00:07:12,430 --> 00:07:18,430
network manager that are tagged as Wi-Fi

151
00:07:15,219 --> 00:07:22,389
sense these networks are considered safe

152
00:07:18,430 --> 00:07:25,810
or<font color="#E5E5E5"> actually high quality by Microsoft</font>

153
00:07:22,389 --> 00:07:28,449
and your device is going to connect

154
00:07:25,810 --> 00:07:29,889
automatically read so this opens the

155
00:07:28,449 --> 00:07:33,219
vector this is this is something<font color="#CCCCCC"> that</font>

156
00:07:29,889 --> 00:07:34,419
maybe we can exploit somehow let's see

157
00:07:33,219 --> 00:07:38,490
what<font color="#E5E5E5"> can we do first of all let's see</font>

158
00:07:34,419 --> 00:07:42,659
how Wi-Fi sense works behind the same

159
00:07:38,490 --> 00:07:45,699
what is happening is that every time and

160
00:07:42,659 --> 00:07:47,860
<font color="#CCCCCC">windows device is connecting to an open</font>

161
00:07:45,699 --> 00:07:50,800
network it's going to<font color="#E5E5E5"> send</font><font color="#CCCCCC"> some</font>

162
00:07:47,860 --> 00:07:52,389
information to Microsoft about its

163
00:07:50,800 --> 00:07:54,129
quality it's going<font color="#E5E5E5"> to say</font><font color="#CCCCCC"> yes this is a</font>

164
00:07:52,389 --> 00:07:56,620
good<font color="#CCCCCC"> Network I'm having a good value</font>

165
00:07:54,129 --> 00:07:58,659
here I'm<font color="#CCCCCC"> having fun this is</font><font color="#E5E5E5"> please touch</font>

166
00:07:56,620 --> 00:08:00,310
this network as a high quality network

167
00:07:58,659 --> 00:08:02,289
so Microsoft is going to collect this

168
00:08:00,310 --> 00:08:05,229
data and it's going<font color="#E5E5E5"> to build a database</font>

169
00:08:02,289 --> 00:08:10,568
of high quality networks this is called

170
00:08:05,229 --> 00:08:13,029
the Wi-Fi sense networks right it looks

171
00:08:10,569 --> 00:08:15,430
like that Microsoft doesn't store only

172
00:08:13,029 --> 00:08:19,169
<font color="#CCCCCC">the name of the network Alton also known</font>

173
00:08:15,430 --> 00:08:22,360
as essid but it also stores the users ID

174
00:08:19,169 --> 00:08:26,049
associated with a location<font color="#CCCCCC"> that means</font>

175
00:08:22,360 --> 00:08:28,719
that if<font color="#E5E5E5"> you find a free Wi-Fi here that</font>

176
00:08:26,050 --> 00:08:30,669
is marked as Wi-Fi sense that doesn't

177
00:08:28,719 --> 00:08:36,519
mean that every free Wi-Fi in<font color="#E5E5E5"> the world</font>

178
00:08:30,669 --> 00:08:38,529
is Marcus tagged as Wi-Fi sense right so

179
00:08:36,519 --> 00:08:40,539
<font color="#E5E5E5">Microsoft makes an association that is</font>

180
00:08:38,529 --> 00:08:42,640
no in Amsterdam there is a free Wi-Fi

181
00:08:40,539 --> 00:08:46,360
that is close<font color="#CCCCCC"> to the airport for example</font>

182
00:08:42,640 --> 00:08:49,660
<font color="#E5E5E5">and the other free Wi-Fi are not Wi-Fi</font>

183
00:08:46,360 --> 00:08:54,060
sense and what happens is that Microsoft

184
00:08:49,660 --> 00:08:56,800
pushes back<font color="#CCCCCC"> to the windows devices only</font>

185
00:08:54,060 --> 00:09:00,880
Wi-Fi sense<font color="#CCCCCC"> target networks that are</font>

186
00:08:56,800 --> 00:09:02,019
within<font color="#E5E5E5"> the area of the user so that</font>

187
00:09:00,880 --> 00:09:04,689
means that not

188
00:09:02,019 --> 00:09:07,269
all windows devices share the same Wi-Fi

189
00:09:04,689 --> 00:09:10,660
sense networks for example i am<font color="#CCCCCC"> from</font>

190
00:09:07,269 --> 00:09:12,220
greece<font color="#CCCCCC"> i live in</font><font color="#E5E5E5"> Athens I can see Wi-Fi</font>

191
00:09:10,660 --> 00:09:14,618
sense tag networks when i open my

192
00:09:12,220 --> 00:09:17,079
network manager but when<font color="#CCCCCC"> I went</font><font color="#E5E5E5"> to San</font>

193
00:09:14,619 --> 00:09:19,689
<font color="#CCCCCC">Francisco or Dubai for example I wasn't</font>

194
00:09:17,079 --> 00:09:21,670
able to see any while people in Dubai

195
00:09:19,689 --> 00:09:24,279
with their windows laptop they were able

196
00:09:21,670 --> 00:09:26,079
to their<font color="#E5E5E5"> able to see so Microsoft is</font>

197
00:09:24,279 --> 00:09:28,959
going to push your only networks that

198
00:09:26,079 --> 00:09:34,329
are where you live<font color="#CCCCCC"> we</font><font color="#E5E5E5"> are usually</font>

199
00:09:28,959 --> 00:09:38,109
connected from how can we exploit this

200
00:09:34,329 --> 00:09:43,089
picture right what we do in<font color="#E5E5E5"> luton attack</font>

201
00:09:38,110 --> 00:09:46,749
is first tricking the victim to believe

202
00:09:43,089 --> 00:09:49,420
that is within the<font color="#CCCCCC"> area of a Wi-Fi sense</font>

203
00:09:46,749 --> 00:09:51,100
network and we can do that by fooling

204
00:09:49,420 --> 00:09:53,979
the windows location service by spoofing

205
00:09:51,100 --> 00:09:56,379
our location we want to<font color="#E5E5E5"> make the device</font>

206
00:09:53,980 --> 00:09:57,939
<font color="#E5E5E5">to believe that is somewhere else for</font>

207
00:09:56,379 --> 00:10:01,829
example if I know that there is a Wi-Fi

208
00:09:57,939 --> 00:10:04,179
sense network in the amsterdam airport

209
00:10:01,829 --> 00:10:06,699
if<font color="#E5E5E5"> i want to do the attack to you i'm</font>

210
00:10:04,179 --> 00:10:07,869
going<font color="#E5E5E5"> to fool your windows location</font>

211
00:10:06,699 --> 00:10:09,969
service to believe that you are

212
00:10:07,869 --> 00:10:14,350
currently in the airport as soon as<font color="#CCCCCC"> i do</font>

213
00:10:09,970 --> 00:10:16,439
that<font color="#CCCCCC"> i can pretend i am this Wi-Fi sense</font>

214
00:10:14,350 --> 00:10:20,319
network I can mimic this network and

215
00:10:16,439 --> 00:10:24,069
then you will automatically<font color="#E5E5E5"> connect to</font>

216
00:10:20,319 --> 00:10:27,969
my to my access point and i will<font color="#E5E5E5"> get one</font>

217
00:10:24,069 --> 00:10:31,029
in<font color="#E5E5E5"> the middle that way we notice that we</font>

218
00:10:27,970 --> 00:10:35,259
can simply broadcast the same name<font color="#CCCCCC"> the</font>

219
00:10:31,029 --> 00:10:41,589
same SSID and that's enough we will get

220
00:10:35,259 --> 00:10:43,480
man the middle so symbol so how can we

221
00:10:41,589 --> 00:10:46,209
<font color="#E5E5E5">fool the windows location service let's</font>

222
00:10:43,480 --> 00:10:49,029
see<font color="#E5E5E5"> that's that first how it works how</font>

223
00:10:46,209 --> 00:10:53,199
Windows location service works windows

224
00:10:49,029 --> 00:10:54,879
devices are sending the bssid the

225
00:10:53,199 --> 00:10:58,238
business<font color="#CCCCCC"> ideas are the MAC addresses of</font>

226
00:10:54,879 --> 00:11:01,449
the access points<font color="#CCCCCC"> okay so it's going to</font>

227
00:10:58,239 --> 00:11:04,600
send the best idea of the nearby access

228
00:11:01,449 --> 00:11:07,540
points to<font color="#CCCCCC"> a server that is the Microsoft</font>

229
00:11:04,600 --> 00:11:09,730
Wi-Fi positioning system and this server

230
00:11:07,540 --> 00:11:12,490
is going to take all these mac<font color="#CCCCCC"> addresses</font>

231
00:11:09,730 --> 00:11:14,499
and it's going<font color="#E5E5E5"> to say</font><font color="#CCCCCC"> okay oh</font><font color="#E5E5E5"> I see</font><font color="#CCCCCC"> you</font>

232
00:11:12,490 --> 00:11:15,459
have this list of mac addresses where

233
00:11:14,499 --> 00:11:20,189
you are

234
00:11:15,459 --> 00:11:24,699
you probably are in<font color="#E5E5E5"> Amsterdam surberg</font>

235
00:11:20,189 --> 00:11:27,179
<font color="#E5E5E5">okay the thing is</font><font color="#CCCCCC"> that these beacon</font>

236
00:11:24,699 --> 00:11:31,660
frames that contain the beer society our

237
00:11:27,179 --> 00:11:33,850
management frames in 802 11 and the

238
00:11:31,660 --> 00:11:35,769
management frames are unprotected so<font color="#CCCCCC"> I</font>

239
00:11:33,850 --> 00:11:37,800
can<font color="#CCCCCC"> easily make my own management frames</font>

240
00:11:35,769 --> 00:11:40,720
it's very trivial I can't put my card in

241
00:11:37,800 --> 00:11:42,998
monitor mode and make my own bigger

242
00:11:40,720 --> 00:11:45,459
<font color="#CCCCCC">brains so I can start sending become</font>

243
00:11:42,999 --> 00:11:48,819
flames to the air here<font color="#E5E5E5"> and I can fool</font>

244
00:11:45,459 --> 00:11:54,239
the windows location<font color="#CCCCCC"> Sherry's to believe</font>

245
00:11:48,819 --> 00:11:56,699
that the user is in<font color="#CCCCCC"> Amsterdam's airport</font>

246
00:11:54,240 --> 00:12:03,939
the only thing that I need<font color="#CCCCCC"> to do so is a</font>

247
00:11:56,699 --> 00:12:05,889
send a lot<font color="#CCCCCC"> of these frames and that</font>

248
00:12:03,939 --> 00:12:07,899
means<font color="#E5E5E5"> that all the applications and</font>

249
00:12:05,889 --> 00:12:09,550
services<font color="#E5E5E5"> that rely</font><font color="#CCCCCC"> on these for</font>

250
00:12:07,899 --> 00:12:13,649
sensitive data all of these are

251
00:12:09,550 --> 00:12:16,059
vulnerable to this thread and

252
00:12:13,649 --> 00:12:19,540
specifically Wi-Fi sense the feature

253
00:12:16,059 --> 00:12:21,309
that we want<font color="#E5E5E5"> we try to explore today so</font>

254
00:12:19,540 --> 00:12:24,849
the first<font color="#E5E5E5"> thing that</font><font color="#CCCCCC"> we need to do to do</font>

255
00:12:21,309 --> 00:12:28,629
this attack to do load n is to find<font color="#E5E5E5"> the</font>

256
00:12:24,850 --> 00:12:30,970
right networks to find some<font color="#CCCCCC"> are networks</font>

257
00:12:28,629 --> 00:12:33,309
that we want<font color="#E5E5E5"> to move the victim to this</font>

258
00:12:30,970 --> 00:12:35,139
area<font color="#E5E5E5"> and then present this network so</font>

259
00:12:33,309 --> 00:12:37,029
this network needs to be of course Wi-Fi

260
00:12:35,139 --> 00:12:39,699
sense network right in order<font color="#CCCCCC"> to do the</font>

261
00:12:37,029 --> 00:12:41,529
automatic<font color="#CCCCCC"> association it needs to be in</font>

262
00:12:39,699 --> 00:12:42,849
an area that is relatively close to the

263
00:12:41,529 --> 00:12:46,929
<font color="#E5E5E5">victim because as I said to</font><font color="#CCCCCC"> you earlier</font>

264
00:12:42,850 --> 00:12:50,049
not all Wi-Fi sense networks existing

265
00:12:46,929 --> 00:12:51,600
the same windows devices so if someone

266
00:12:50,049 --> 00:12:53,920
lives in<font color="#E5E5E5"> Amsterdam I'm going to look for</font>

267
00:12:51,600 --> 00:12:59,049
Wi-Fi sense networks that exist in

268
00:12:53,920 --> 00:13:03,579
Amsterdam not in Athens and the third is

269
00:12:59,049 --> 00:13:05,589
that I want<font color="#CCCCCC"> to find a network that</font>

270
00:13:03,579 --> 00:13:07,628
exists in an area with multiple other

271
00:13:05,589 --> 00:13:09,879
networks around this<font color="#E5E5E5"> is the coaster</font>

272
00:13:07,629 --> 00:13:11,549
spoofing is going to play much better

273
00:13:09,879 --> 00:13:14,049
that way it's going to work much better

274
00:13:11,549 --> 00:13:15,610
because I will take a lot of I will take

275
00:13:14,049 --> 00:13:18,670
all these networks<font color="#E5E5E5"> BSI these mac</font>

276
00:13:15,610 --> 00:13:24,009
<font color="#E5E5E5">addresses and</font><font color="#CCCCCC"> i will broadcast them to</font>

277
00:13:18,670 --> 00:13:28,349
the air there is no public API from

278
00:13:24,009 --> 00:13:28,350
<font color="#CCCCCC">microsoft but</font>

279
00:13:28,950 --> 00:13:36,150
turns all the Wi-Fi sense networks that

280
00:13:32,370 --> 00:13:38,520
exist the geo location of the of the of

281
00:13:36,150 --> 00:13:41,640
the Wi-Fi sense networks so we're going

282
00:13:38,520 --> 00:13:44,220
<font color="#E5E5E5">back to</font><font color="#CCCCCC"> work driving what we're</font><font color="#E5E5E5"> looking</font>

283
00:13:41,640 --> 00:13:45,840
for is mostly public hot spots the

284
00:13:44,220 --> 00:13:47,940
networks that are tagged as Wi-Fi<font color="#E5E5E5"> sense</font>

285
00:13:45,840 --> 00:13:50,720
<font color="#E5E5E5">are mostly public hot spots that you can</font>

286
00:13:47,940 --> 00:13:53,070
find in the airports or coffee shops

287
00:13:50,720 --> 00:13:54,180
commonly in societies for example I'm

288
00:13:53,070 --> 00:13:56,220
not<font color="#CCCCCC"> sure if you're aware of the phone</font>

289
00:13:54,180 --> 00:13:58,800
networks these are<font color="#CCCCCC"> some networks where</font>

290
00:13:56,220 --> 00:14:00,870
you actually share some of your networks

291
00:13:58,800 --> 00:14:03,870
bandwidth and allows you to connect to

292
00:14:00,870 --> 00:14:07,590
this everywhere<font color="#CCCCCC"> you encounter them these</font>

293
00:14:03,870 --> 00:14:12,630
are<font color="#E5E5E5"> Tom O'Neill societies these are very</font>

294
00:14:07,590 --> 00:14:13,950
common to be tagged as Wi-Fi sense and

295
00:14:12,630 --> 00:14:15,120
there is this feature<font color="#CCCCCC"> in Windows Phone</font>

296
00:14:13,950 --> 00:14:18,660
as you see<font color="#CCCCCC"> on the screen so</font><font color="#E5E5E5"> they are</font>

297
00:14:15,120 --> 00:14:21,000
that has a button called mouth nearby

298
00:14:18,660 --> 00:14:23,490
Wi-Fi if you click on this you will see

299
00:14:21,000 --> 00:14:27,090
all the free hot spots that are in an

300
00:14:23,490 --> 00:14:30,960
area that are supposedly popular hot

301
00:14:27,090 --> 00:14:33,720
spots<font color="#CCCCCC"> okay we notice that a subset of</font>

302
00:14:30,960 --> 00:14:38,580
these networks are Wi-Fi sense not all

303
00:14:33,720 --> 00:14:40,290
of them though so as soon<font color="#E5E5E5"> as we file as</font>

304
00:14:38,580 --> 00:14:43,230
soon as we find a network that is tagged

305
00:14:40,290 --> 00:14:47,150
as Wi-Fi<font color="#CCCCCC"> sense what we need to do is to</font>

306
00:14:43,230 --> 00:14:51,270
collect the right data to do the attack

307
00:14:47,150 --> 00:14:54,390
what we need to<font color="#E5E5E5"> collect these first the</font>

308
00:14:51,270 --> 00:14:57,689
MAC addresses the bay societies of the

309
00:14:54,390 --> 00:15:02,850
of the networks that are within the<font color="#E5E5E5"> area</font>

310
00:14:57,690 --> 00:15:06,150
and second the<font color="#CCCCCC"> essid the name of the</font>

311
00:15:02,850 --> 00:15:07,590
network that<font color="#E5E5E5"> is tagged as Wi-Fi sense we</font>

312
00:15:06,150 --> 00:15:11,040
can do that either by going there

313
00:15:07,590 --> 00:15:15,750
physically or using an API that returns

314
00:15:11,040 --> 00:15:17,490
the data or Wi-Fi hotspots for example

315
00:15:15,750 --> 00:15:23,340
if you go to wiggle<font color="#E5E5E5"> calm you will find</font>

316
00:15:17,490 --> 00:15:26,190
an API like that so we have everything

317
00:15:23,340 --> 00:15:28,080
we need we<font color="#CCCCCC"> have</font><font color="#E5E5E5"> the data we have the</font>

318
00:15:26,190 --> 00:15:30,330
bssid disprove the victims location and

319
00:15:28,080 --> 00:15:33,300
we have the SSID so what we need<font color="#E5E5E5"> to do</font>

320
00:15:30,330 --> 00:15:37,230
now is to mount our attack is to go

321
00:15:33,300 --> 00:15:41,069
close to<font color="#CCCCCC"> the</font><font color="#E5E5E5"> victim and we're going to</font>

322
00:15:37,230 --> 00:15:42,540
send three kind of frames<font color="#CCCCCC"> okay first</font>

323
00:15:41,070 --> 00:15:44,640
we're going to send

324
00:15:42,540 --> 00:15:47,880
<font color="#E5E5E5">Khan frames with the mark addresses that</font>

325
00:15:44,640 --> 00:15:51,780
we got to fool the location service this

326
00:15:47,880 --> 00:15:54,720
<font color="#E5E5E5">is going to prove the location and what</font>

327
00:15:51,780 --> 00:15:57,630
is interesting<font color="#CCCCCC"> is that we can put when</font>

328
00:15:54,720 --> 00:16:00,990
we when we craft this big inflames we

329
00:15:57,630 --> 00:16:04,020
can put the<font color="#CCCCCC"> essid equal to now this</font><font color="#E5E5E5"> is</font>

330
00:16:00,990 --> 00:16:07,020
<font color="#CCCCCC">going</font><font color="#E5E5E5"> to make because equations become</font>

331
00:16:04,020 --> 00:16:08,670
friends with random names that victim

332
00:16:07,020 --> 00:16:10,050
for example may have a look to his

333
00:16:08,670 --> 00:16:12,420
network manager and going to see a lot

334
00:16:10,050 --> 00:16:15,630
of networks that say oh these networks

335
00:16:12,420 --> 00:16:18,180
didn't exist here before but if<font color="#E5E5E5"> I put</font>

336
00:16:15,630 --> 00:16:21,660
<font color="#E5E5E5">into now then i will hover my networks</font>

337
00:16:18,180 --> 00:16:24,989
hidden and still<font color="#CCCCCC"> i will be able</font><font color="#E5E5E5"> to spoof</font>

338
00:16:21,660 --> 00:16:27,510
to<font color="#E5E5E5"> full the location service that's</font>

339
00:16:24,990 --> 00:16:29,640
<font color="#E5E5E5">number one number two is i will send the</font>

340
00:16:27,510 --> 00:16:31,650
authentication frames these are also

341
00:16:29,640 --> 00:16:33,270
management frames there is also no

342
00:16:31,650 --> 00:16:35,100
encryption no signature is no

343
00:16:33,270 --> 00:16:38,939
authentication<font color="#E5E5E5"> their joke and that craft</font>

344
00:16:35,100 --> 00:16:40,770
the<font color="#E5E5E5"> old frames the do sprints will help</font>

345
00:16:38,940 --> 00:16:42,870
me in the case<font color="#CCCCCC"> that the victim is</font>

346
00:16:40,770 --> 00:16:44,370
already associated with the<font color="#CCCCCC"> network for</font>

347
00:16:42,870 --> 00:16:46,770
example the victim is already connected

348
00:16:44,370 --> 00:16:49,050
to his home network and I want him<font color="#CCCCCC"> to</font>

349
00:16:46,770 --> 00:16:50,939
kick him out of<font color="#CCCCCC"> this network so you can</font>

350
00:16:49,050 --> 00:16:54,020
connect to my network so i'm going<font color="#E5E5E5"> to</font>

351
00:16:50,940 --> 00:16:56,550
send the<font color="#E5E5E5"> old friends for that and</font>

352
00:16:54,020 --> 00:16:59,370
finally I'm going to send beacon frames

353
00:16:56,550 --> 00:17:05,970
again<font color="#E5E5E5"> these times with the essid of the</font>

354
00:16:59,370 --> 00:17:08,700
Wi-Fi sense tagged network and the the

355
00:17:05,970 --> 00:17:10,620
victim is<font color="#CCCCCC"> going to</font><font color="#E5E5E5"> believe that this</font>

356
00:17:08,700 --> 00:17:12,540
Wi-Fi sense<font color="#E5E5E5"> network since it's on</font><font color="#CCCCCC"> the</font>

357
00:17:10,619 --> 00:17:14,280
right position in the right location and

358
00:17:12,540 --> 00:17:20,940
it's going<font color="#E5E5E5"> to connect to it</font>

359
00:17:14,280 --> 00:17:22,290
automatically this is how the automatic

360
00:17:20,940 --> 00:17:25,860
<font color="#CCCCCC">wireless association</font><font color="#E5E5E5"> algorithm on</font>

361
00:17:22,290 --> 00:17:28,040
Windows<font color="#E5E5E5"> 10 looks like at first the</font>

362
00:17:25,859 --> 00:17:32,429
client is not connected to any network

363
00:17:28,040 --> 00:17:35,310
it<font color="#E5E5E5"> builds the list of all the networks</font>

364
00:17:32,430 --> 00:17:37,920
that exist in the area it scans for all

365
00:17:35,310 --> 00:17:41,760
the networks by taking<font color="#CCCCCC"> the big on frames</font>

366
00:17:37,920 --> 00:17:44,250
in the air and then<font color="#E5E5E5"> it will</font><font color="#CCCCCC"> go through</font>

367
00:17:41,760 --> 00:17:46,140
the<font color="#CCCCCC"> PNL that preferred networks the</font>

368
00:17:44,250 --> 00:17:48,690
networks that has associated you in the

369
00:17:46,140 --> 00:17:50,610
past if it encounters a network that has

370
00:17:48,690 --> 00:17:53,100
connected you in the<font color="#E5E5E5"> past it will</font>

371
00:17:50,610 --> 00:17:56,070
connect to<font color="#E5E5E5"> this network if not it will</font>

372
00:17:53,100 --> 00:17:58,679
go to the second loop where is

373
00:17:56,070 --> 00:18:00,210
<font color="#CCCCCC">send for Wi-Fi sense networks if the</font>

374
00:17:58,680 --> 00:18:03,150
reason Wi-Fi since network in the<font color="#E5E5E5"> area</font>

375
00:18:00,210 --> 00:18:05,760
it will connect to<font color="#E5E5E5"> this network that</font>

376
00:18:03,150 --> 00:18:09,420
means let's see an example let's say

377
00:18:05,760 --> 00:18:12,330
that the networks that exist in the air

378
00:18:09,420 --> 00:18:14,220
are the list that<font color="#E5E5E5"> you see the A&L</font>

379
00:18:12,330 --> 00:18:17,580
there's a<font color="#E5E5E5"> union lab than the report</font>

380
00:18:14,220 --> 00:18:20,570
<font color="#E5E5E5">three and three more networks let's say</font>

381
00:18:17,580 --> 00:18:23,250
that<font color="#E5E5E5"> this device that we're targeting</font>

382
00:18:20,570 --> 00:18:28,290
also has some stored Wi-Fi<font color="#E5E5E5"> sense</font>

383
00:18:23,250 --> 00:18:30,900
networks three specifically<font color="#E5E5E5"> and this</font>

384
00:18:28,290 --> 00:18:33,240
device also has the<font color="#CCCCCC"> PNL this device has</font>

385
00:18:30,900 --> 00:18:38,580
also connected in the past two to Wi-Fi

386
00:18:33,240 --> 00:18:42,000
networks so as you<font color="#CCCCCC"> see there the</font>

387
00:18:38,580 --> 00:18:43,980
networks that are round there is the

388
00:18:42,000 --> 00:18:48,270
airport free and the airport free is

389
00:18:43,980 --> 00:18:52,680
also a Wi-Fi sense network and there is

390
00:18:48,270 --> 00:18:54,750
no network that is close to<font color="#E5E5E5"> the victim</font>

391
00:18:52,680 --> 00:18:56,130
that is<font color="#CCCCCC"> also in the</font><font color="#E5E5E5"> preferred network</font>

392
00:18:54,750 --> 00:18:58,590
list that has connected to<font color="#E5E5E5"> in the past</font>

393
00:18:56,130 --> 00:19:01,500
so<font color="#CCCCCC"> that means</font><font color="#E5E5E5"> that the victim device is</font>

394
00:18:58,590 --> 00:19:05,030
going to connect automatically to the

395
00:19:01,500 --> 00:19:10,200
airport free network however in case to

396
00:19:05,030 --> 00:19:12,450
this time we<font color="#CCCCCC"> have the my home Wi-Fi that</font>

397
00:19:10,200 --> 00:19:16,290
is<font color="#E5E5E5"> also in</font><font color="#CCCCCC"> the preferred network</font><font color="#E5E5E5"> list so</font>

398
00:19:12,450 --> 00:19:19,320
in that case<font color="#E5E5E5"> the device will prefer it</font>

399
00:19:16,290 --> 00:19:22,050
will go to<font color="#E5E5E5"> the first loop there and it's</font>

400
00:19:19,320 --> 00:19:25,590
going to prefer the my home Wi-Fi

401
00:19:22,050 --> 00:19:29,700
network instead what can<font color="#E5E5E5"> we do in caves</font>

402
00:19:25,590 --> 00:19:32,100
<font color="#CCCCCC">too we have a number of options so that</font>

403
00:19:29,700 --> 00:19:33,870
what we need to do is<font color="#CCCCCC"> remove this</font>

404
00:19:32,100 --> 00:19:37,620
network from<font color="#CCCCCC"> the</font><font color="#E5E5E5"> from the available</font>

405
00:19:33,870 --> 00:19:40,949
network list from the<font color="#CCCCCC"> ANL we can do that</font>

406
00:19:37,620 --> 00:19:43,520
either by performing mounting a denial

407
00:19:40,950 --> 00:19:46,230
of service attack on the<font color="#CCCCCC"> wireless router</font>

408
00:19:43,520 --> 00:19:49,080
for example a way to do that is to send

409
00:19:46,230 --> 00:19:51,840
multiple authentication requests there

410
00:19:49,080 --> 00:19:53,250
are some because the router needs to

411
00:19:51,840 --> 00:19:56,850
hold the all these authentication

412
00:19:53,250 --> 00:19:59,250
requesting memory there are some some

413
00:19:56,850 --> 00:20:03,330
rooters that freeze for for some seconds

414
00:19:59,250 --> 00:20:05,190
this is enough for us for making the

415
00:20:03,330 --> 00:20:07,949
device<font color="#CCCCCC"> to connect automatically to the</font>

416
00:20:05,190 --> 00:20:09,810
Wi-Fi sent network or the<font color="#CCCCCC"> option to that</font>

417
00:20:07,950 --> 00:20:12,660
is also working is to learn

418
00:20:09,810 --> 00:20:16,770
a physical<font color="#CCCCCC"> layer jamming and actually</font>

419
00:20:12,660 --> 00:20:19,980
destroy<font color="#E5E5E5"> disable the reception of all the</font>

420
00:20:16,770 --> 00:20:22,830
beacon frames and all the probe respawns

421
00:20:19,980 --> 00:20:24,360
frames so what we are what we are what

422
00:20:22,830 --> 00:20:26,220
<font color="#E5E5E5">we want to try and</font><font color="#CCCCCC"> what we receiving</font>

423
00:20:24,360 --> 00:20:32,219
with these two methods is to disappear

424
00:20:26,220 --> 00:20:35,460
these networks from the ANL<font color="#CCCCCC"> I want you</font>

425
00:20:32,220 --> 00:20:43,680
to show the attack so I have a video

426
00:20:35,460 --> 00:20:48,960
let's see let's go<font color="#CCCCCC"> okay let's see how it</font>

427
00:20:43,680 --> 00:20:54,030
<font color="#E5E5E5">works so what you see there is this is a</font>

428
00:20:48,960 --> 00:20:56,610
victim<font color="#E5E5E5"> okay and we made the</font><font color="#CCCCCC"> victim open</font>

429
00:20:54,030 --> 00:20:58,950
the maps so we can see that spoofing the

430
00:20:56,610 --> 00:21:02,159
location service pooping so right there

431
00:20:58,950 --> 00:21:07,950
the victim is somewhere in the center of

432
00:21:02,160 --> 00:21:11,010
<font color="#E5E5E5">Athens and as soon as we mount our</font>

433
00:21:07,950 --> 00:21:19,110
attack it goes somewhere else<font color="#E5E5E5"> okay the</font>

434
00:21:11,010 --> 00:21:22,310
<font color="#E5E5E5">location service was both so we will</font>

435
00:21:19,110 --> 00:21:22,310
open the network manager now

436
00:21:28,700 --> 00:21:34,230
<font color="#E5E5E5">okay as you see there there are some</font>

437
00:21:30,960 --> 00:21:35,970
networks<font color="#E5E5E5"> a as we have something these</font>

438
00:21:34,230 --> 00:21:37,350
are all<font color="#E5E5E5"> these are not real networks no</font>

439
00:21:35,970 --> 00:21:40,920
one can connect to these networks these

440
00:21:37,350 --> 00:21:42,870
are our<font color="#E5E5E5"> custom beacon frames okay that</font>

441
00:21:40,920 --> 00:21:45,300
we have set and we have put the bssid

442
00:21:42,870 --> 00:21:47,399
the mac address to spoof the windows

443
00:21:45,300 --> 00:21:50,190
location service these are not<font color="#E5E5E5"> real</font>

444
00:21:47,400 --> 00:21:53,040
networks with that made them to spoof

445
00:21:50,190 --> 00:21:56,970
validation service we could put<font color="#E5E5E5"> the ESS</font>

446
00:21:53,040 --> 00:21:59,610
ideas now and this wouldn't appear there

447
00:21:56,970 --> 00:22:02,670
and the location service would be fooled

448
00:21:59,610 --> 00:22:04,560
either way and there is<font color="#CCCCCC"> also you seal</font>

449
00:22:02,670 --> 00:22:06,360
the top there is<font color="#E5E5E5"> a Wi-Fi sense network</font>

450
00:22:04,560 --> 00:22:08,990
that we also broadcasting that exists

451
00:22:06,360 --> 00:22:14,219
that exists in<font color="#E5E5E5"> this new area that we</font>

452
00:22:08,990 --> 00:22:21,120
teleported the victims you so let's see

453
00:22:14,220 --> 00:22:23,820
what's going<font color="#E5E5E5"> to happen so you see you</font>

454
00:22:21,120 --> 00:22:25,649
<font color="#E5E5E5">see there is a little the</font><font color="#CCCCCC"> windows</font><font color="#E5E5E5"> lucky</font>

455
00:22:23,820 --> 00:22:27,000
the windows location service fooling is

456
00:22:25,650 --> 00:22:28,770
not maybe it's not<font color="#E5E5E5"> going to work that</font>

457
00:22:27,000 --> 00:22:30,420
<font color="#CCCCCC">well maybe the victim is going</font><font color="#E5E5E5"> to go</font>

458
00:22:28,770 --> 00:22:33,270
back but that<font color="#E5E5E5"> doesn't affect our attack</font>

459
00:22:30,420 --> 00:22:39,630
the<font color="#E5E5E5"> network is still marked as Wi-Fi</font>

460
00:22:33,270 --> 00:22:42,270
sense there you go connected that's a

461
00:22:39,630 --> 00:22:58,620
<font color="#CCCCCC">very real way for getting man the middle</font>

462
00:22:42,270 --> 00:23:01,860
on windows I'm glad<font color="#E5E5E5"> you liked it so this</font>

463
00:22:58,620 --> 00:23:11,870
covers have the whole<font color="#CCCCCC"> iraq so you see</font>

464
00:23:01,860 --> 00:23:17,340
<font color="#E5E5E5">there let me make this full screen ok so</font>

465
00:23:11,870 --> 00:23:20,370
the attacker is top right the evil guy

466
00:23:17,340 --> 00:23:22,560
and is sending these three kind of

467
00:23:20,370 --> 00:23:25,139
frames that we talked about first of all

468
00:23:22,560 --> 00:23:27,960
with the<font color="#CCCCCC"> earth brains to disassociate</font>

469
00:23:25,140 --> 00:23:30,090
the victim with<font color="#CCCCCC"> the current network that</font>

470
00:23:27,960 --> 00:23:34,140
is associated to with access point as

471
00:23:30,090 --> 00:23:37,139
you see that<font color="#CCCCCC"> one in blue secondly the</font>

472
00:23:34,140 --> 00:23:40,080
beacon frames to spoof the location of

473
00:23:37,140 --> 00:23:41,100
<font color="#E5E5E5">the victim so you see the</font><font color="#CCCCCC"> ap1 a be to a</font>

474
00:23:40,080 --> 00:23:43,889
be three

475
00:23:41,100 --> 00:23:45,360
these are<font color="#CCCCCC"> not real led words so</font><font color="#E5E5E5"> we</font><font color="#CCCCCC"> fool</font>

476
00:23:43,890 --> 00:23:48,240
the victim<font color="#CCCCCC"> the victim is going</font><font color="#E5E5E5"> to send</font>

477
00:23:45,360 --> 00:23:50,340
this via societies to the WPS to the

478
00:23:48,240 --> 00:23:51,600
Wi-Fi positioning system and the Wi-Fi

479
00:23:50,340 --> 00:23:54,209
positioning system is<font color="#E5E5E5"> going to return</font>

480
00:23:51,600 --> 00:23:58,469
<font color="#E5E5E5">back a location but this location is not</font>

481
00:23:54,210 --> 00:24:00,929
going to be the reallocation and finally

482
00:23:58,470 --> 00:24:03,720
we're sending beacon frames with SSID

483
00:24:00,929 --> 00:24:05,910
equal to the Wi-Fi sense network that

484
00:24:03,720 --> 00:24:10,230
exists in the area that<font color="#CCCCCC"> we move the</font>

485
00:24:05,910 --> 00:24:13,770
victim and we're going to<font color="#E5E5E5"> get the</font><font color="#CCCCCC"> the</font>

486
00:24:10,230 --> 00:24:16,590
man the middle position that way so we

487
00:24:13,770 --> 00:24:18,330
we disclose this<font color="#E5E5E5"> to Microsoft we emails</font>

488
00:24:16,590 --> 00:24:20,879
<font color="#CCCCCC">Microsoft about this issue and</font><font color="#E5E5E5"> this was</font>

489
00:24:18,330 --> 00:24:25,230
the response basically<font color="#E5E5E5"> they're saying</font>

490
00:24:20,880 --> 00:24:27,720
that they didn't know<font color="#CCCCCC"> that about the</font>

491
00:24:25,230 --> 00:24:31,710
ability<font color="#CCCCCC"> to fake the location that</font><font color="#E5E5E5"> was</font>

492
00:24:27,720 --> 00:24:38,700
new for them however they considered

493
00:24:31,710 --> 00:24:40,320
this an accepted risk they are not

494
00:24:38,700 --> 00:24:46,320
planning to release the<font color="#E5E5E5"> parts anytime</font>

495
00:24:40,320 --> 00:24:48,720
soon am<font color="#CCCCCC"> i affected yes you are if you're</font>

496
00:24:46,320 --> 00:24:51,658
using a Windows 10 or Windows Phone 8.1

497
00:24:48,720 --> 00:24:53,190
with the default settings if you set up

498
00:24:51,659 --> 00:24:56,280
your system using the<font color="#CCCCCC"> Xperia settings</font>

499
00:24:53,190 --> 00:25:01,400
and<font color="#E5E5E5"> you click next next next</font><font color="#CCCCCC"> you are</font>

500
00:24:56,280 --> 00:25:05,760
<font color="#CCCCCC">vulnerable how can you</font><font color="#E5E5E5"> protect yourself</font>

501
00:25:01,400 --> 00:25:08,520
symbols disable this feature you go to

502
00:25:05,760 --> 00:25:11,010
settings Wi-Fi settings Wi-Fi sense you

503
00:25:08,520 --> 00:25:18,350
need to<font color="#E5E5E5"> make sure that the connector</font>

504
00:25:11,010 --> 00:25:21,299
suggested open hotspot is turned off I

505
00:25:18,350 --> 00:25:24,090
am the author of Wi-Fi feature Wi-Fi

506
00:25:21,299 --> 00:25:29,580
feature is an<font color="#CCCCCC"> open-source rogue access</font>

507
00:25:24,090 --> 00:25:31,049
point to if you go to Wi-Fi phys.org you

508
00:25:29,580 --> 00:25:33,480
will find more information about it if

509
00:25:31,049 --> 00:25:35,879
you<font color="#E5E5E5"> don't know about the tool so version</font>

510
00:25:33,480 --> 00:25:38,370
1.3 of the tool is going to be released

511
00:25:35,880 --> 00:25:42,419
today<font color="#CCCCCC"> okay and it's going to feature</font>

512
00:25:38,370 --> 00:25:44,840
this technique there are options in the

513
00:25:42,419 --> 00:25:47,880
new<font color="#CCCCCC"> version that you can capture an area</font>

514
00:25:44,840 --> 00:25:50,370
you can capture the MAC addresses of an

515
00:25:47,880 --> 00:25:51,809
area and then if you go to<font color="#E5E5E5"> the victim</font>

516
00:25:50,370 --> 00:25:54,540
there is another option that you can do

517
00:25:51,809 --> 00:25:55,158
to mount the attack to fool the location

518
00:25:54,540 --> 00:26:00,029
savory

519
00:25:55,159 --> 00:26:03,750
to spoon a Wi-Fi sense network and get a

520
00:26:00,029 --> 00:26:10,169
man the middle position that way that

521
00:26:03,750 --> 00:26:12,029
was all by<font color="#CCCCCC"> V thank you very much well</font>

522
00:26:10,169 --> 00:26:16,890
thank<font color="#E5E5E5"> you very much do or some time for</font>

523
00:26:12,029 --> 00:26:19,350
questions I think a lot<font color="#CCCCCC"> of</font><font color="#E5E5E5"> things I</font>

524
00:26:16,890 --> 00:26:21,450
heard for the first time today I'm not

525
00:26:19,350 --> 00:26:23,459
very familiar<font color="#E5E5E5"> with</font><font color="#CCCCCC"> these</font><font color="#E5E5E5"> technology but</font>

526
00:26:21,450 --> 00:26:25,980
could you explain again how the D

527
00:26:23,460 --> 00:26:27,809
authentification works that that

528
00:26:25,980 --> 00:26:31,890
apparently so that they are syndication

529
00:26:27,809 --> 00:26:35,010
yeah so yes in a<font color="#CCCCCC"> 2-2 dot11 let's see</font>

530
00:26:31,890 --> 00:26:37,020
let's make in a to 2011 which is

531
00:26:35,010 --> 00:26:40,529
actually the protocol that defines all

532
00:26:37,020 --> 00:26:42,510
the Wi-Fi magic there are the<font color="#CCCCCC"> so called</font>

533
00:26:40,529 --> 00:26:45,299
<font color="#E5E5E5">the old frames these are messages</font>

534
00:26:42,510 --> 00:26:47,850
whenever your client wants<font color="#E5E5E5"> to disconnect</font>

535
00:26:45,299 --> 00:26:51,090
<font color="#E5E5E5">from a Wi-Fi it's going to send this and</font>

536
00:26:47,850 --> 00:26:52,740
say hey at this point<font color="#E5E5E5"> I</font><font color="#CCCCCC"> need to go</font>

537
00:26:51,090 --> 00:26:54,899
somewhere else now so I when I need to

538
00:26:52,740 --> 00:26:56,700
disconnect also there are some deal

539
00:26:54,899 --> 00:26:58,678
frames from the access point to the

540
00:26:56,700 --> 00:27:00,480
client when the access point wants to

541
00:26:58,679 --> 00:27:03,929
reboot for example or needs to do a

542
00:27:00,480 --> 00:27:05,130
<font color="#E5E5E5">firmware upgrade and again the lattice</font>

543
00:27:03,929 --> 00:27:07,649
point is<font color="#E5E5E5"> going to send to the clients</font>

544
00:27:05,130 --> 00:27:10,289
clients please the authenticate<font color="#E5E5E5"> I need</font>

545
00:27:07,649 --> 00:27:13,049
to do a<font color="#E5E5E5"> few more upgrade the thing is</font>

546
00:27:10,289 --> 00:27:15,570
<font color="#CCCCCC">that</font><font color="#E5E5E5"> these messages</font><font color="#CCCCCC"> are not</font><font color="#E5E5E5"> protected by</font>

547
00:27:13,049 --> 00:27:19,830
cryptography so anybody can take these

548
00:27:15,570 --> 00:27:21,360
messages and spook them pretend that if

549
00:27:19,830 --> 00:27:24,539
the client<font color="#CCCCCC"> represented the access point</font>

550
00:27:21,360 --> 00:27:26,459
sends them to the air and do<font color="#E5E5E5"> this kind</font>

551
00:27:24,539 --> 00:27:28,590
of attack a denial of service attack ad

552
00:27:26,460 --> 00:27:30,299
authentication these are pretty trivial

553
00:27:28,590 --> 00:27:32,908
tags are many tools that do this kind of

554
00:27:30,299 --> 00:27:36,418
attack Wi-Fi feature does this attack

555
00:27:32,909 --> 00:27:39,289
since version<font color="#CCCCCC"> one also indicate three</font>

556
00:27:36,419 --> 00:27:49,580
and it's<font color="#E5E5E5"> very trivial it works in most</font>

557
00:27:39,289 --> 00:27:49,580
setups no problem more questions

558
00:27:57,280 --> 00:28:03,830
this is actually<font color="#CCCCCC"> on how does Microsoft</font>

559
00:28:00,620 --> 00:28:06,409
determine which users get the Wi-Fi

560
00:28:03,830 --> 00:28:08,360
enabled go to trust the trusted<font color="#CCCCCC"> Network</font>

561
00:28:06,410 --> 00:28:10,460
segments how does it differentiate that

562
00:28:08,360 --> 00:28:13,370
you will only see a subset of that

563
00:28:10,460 --> 00:28:15,620
overall list and secondly is the entire

564
00:28:13,370 --> 00:28:20,590
list available for anybody to to get

565
00:28:15,620 --> 00:28:23,889
hold of as in all identified trusted

566
00:28:20,590 --> 00:28:26,840
understand the first question is the how

567
00:28:23,890 --> 00:28:29,330
how Microsoft determines which networks

568
00:28:26,840 --> 00:28:34,550
to send to with device with Wi-Fi sent

569
00:28:29,330 --> 00:28:37,970
<font color="#CCCCCC">okay every Windows 10 device or Windows</font>

570
00:28:34,550 --> 00:28:39,440
Phone 8.1 device has a list of wife Isis

571
00:28:37,970 --> 00:28:41,660
networks all of these<font color="#E5E5E5"> devices think the</font>

572
00:28:39,440 --> 00:28:44,690
Wi-Fi instead feature is enabled they

573
00:28:41,660 --> 00:28:47,390
have some Wi-Fi sense network stored it

574
00:28:44,690 --> 00:28:49,970
has to do with the area<font color="#E5E5E5"> that you are so</font>

575
00:28:47,390 --> 00:28:51,680
as I said if I am in Athens I<font color="#E5E5E5"> definitely</font>

576
00:28:49,970 --> 00:28:53,660
I'm definitely going to see a lot of

577
00:28:51,680 --> 00:28:56,480
Wi-Fi<font color="#CCCCCC"> sense networks in Athens however</font>

578
00:28:53,660 --> 00:28:58,550
if I moved<font color="#E5E5E5"> to San</font><font color="#CCCCCC"> Francisco we notice</font>

579
00:28:56,480 --> 00:29:00,230
that we weren't able to<font color="#E5E5E5"> see any maybe</font>

580
00:28:58,550 --> 00:29:05,899
<font color="#E5E5E5">after a while Microsoft is going to send</font>

581
00:29:00,230 --> 00:29:07,970
some<font color="#E5E5E5"> to us but I don't know why</font><font color="#CCCCCC"> i was</font><font color="#E5E5E5"> in</font>

582
00:29:05,900 --> 00:29:09,380
dubai I was in<font color="#E5E5E5"> the San Francisco</font><font color="#CCCCCC"> for a</font>

583
00:29:07,970 --> 00:29:11,330
week and still I wasn't able to see any

584
00:29:09,380 --> 00:29:13,310
Wi-Fi<font color="#E5E5E5"> sans networks however people that</font>

585
00:29:11,330 --> 00:29:15,139
are in San Francisco were able to see

586
00:29:13,310 --> 00:29:16,730
why five sons networks so it<font color="#E5E5E5"> has</font><font color="#CCCCCC"> to do</font>

587
00:29:15,140 --> 00:29:19,520
with the location<font color="#E5E5E5"> and apparently</font>

588
00:29:16,730 --> 00:29:21,530
<font color="#E5E5E5">Microsoft sends the networks of your</font>

589
00:29:19,520 --> 00:29:24,290
country<font color="#CCCCCC"> or something</font><font color="#E5E5E5"> like that or your</font>

590
00:29:21,530 --> 00:29:25,490
CP something like that and can<font color="#E5E5E5"> you can</font>

591
00:29:24,290 --> 00:29:28,010
<font color="#E5E5E5">you tell again question number two</font>

592
00:29:25,490 --> 00:29:30,260
please I basically wanted that entire

593
00:29:28,010 --> 00:29:31,910
less better thing is kind of yesterday I

594
00:29:30,260 --> 00:29:34,220
guess if you just move people around

595
00:29:31,910 --> 00:29:36,320
locations exactly then eventually you'll

596
00:29:34,220 --> 00:29:38,360
hit a hot spots I'd be interested<font color="#E5E5E5"> in how</font>

597
00:29:36,320 --> 00:29:42,800
they're differentiating the fact that

598
00:29:38,360 --> 00:29:45,080
you don't see any sense networks when

599
00:29:42,800 --> 00:29:47,830
you move San<font color="#CCCCCC"> Francisco what is it that</font>

600
00:29:45,080 --> 00:29:51,129
<font color="#E5E5E5">separates your client from my clients I</font>

601
00:29:47,830 --> 00:29:53,449
believe Microsoft probably holds

602
00:29:51,130 --> 00:29:56,390
probably Microsoft knows where you leave

603
00:29:53,450 --> 00:29:58,010
right migratory knows where you live so

604
00:29:56,390 --> 00:30:00,230
we know that you're somewhere in<font color="#CCCCCC"> Athens</font>

605
00:29:58,010 --> 00:30:02,870
for example because you have a lot<font color="#CCCCCC"> of</font>

606
00:30:00,230 --> 00:30:04,520
connections from Athens so that's

607
00:30:02,870 --> 00:30:05,750
probably how it is maybe maybe after a

608
00:30:04,520 --> 00:30:07,570
while when you<font color="#E5E5E5"> go to San Francisco after</font>

609
00:30:05,750 --> 00:30:08,590
a while then I realize<font color="#CCCCCC"> that you moved</font>

610
00:30:07,570 --> 00:30:10,300
and we're<font color="#CCCCCC"> going to send</font><font color="#E5E5E5"> you these</font>

611
00:30:08,590 --> 00:30:13,149
networks as well it makes sense to

612
00:30:10,300 --> 00:30:14,620
there's no IP I I guess yeah<font color="#E5E5E5"> thank you</font>

613
00:30:13,150 --> 00:30:19,630
<font color="#E5E5E5">question here before we go into the</font>

614
00:30:14,620 --> 00:30:23,199
coffee break so you said it's using

615
00:30:19,630 --> 00:30:25,960
you're using<font color="#E5E5E5"> the SSID s2 to fake the</font>

616
00:30:23,200 --> 00:30:29,290
location do they not make any use of GPS

617
00:30:25,960 --> 00:30:31,450
at the same time like 20<font color="#CCCCCC"> lots of</font>

618
00:30:29,290 --> 00:30:34,090
allocation so if you are using<font color="#CCCCCC"> the</font><font color="#E5E5E5"> GPS</font>

619
00:30:31,450 --> 00:30:35,530
oh this<font color="#CCCCCC"> is not</font><font color="#E5E5E5"> the windows location</font>

620
00:30:34,090 --> 00:30:37,600
service the windows location service

621
00:30:35,530 --> 00:30:40,210
realized specifically specifically on

622
00:30:37,600 --> 00:30:41,740
the beach side is that around the tip is

623
00:30:40,210 --> 00:30:44,860
another thing<font color="#E5E5E5"> the DP is going to use the</font>

624
00:30:41,740 --> 00:30:45,910
GPS as usual I'm saying you<font color="#E5E5E5"> know why</font>

625
00:30:44,860 --> 00:30:48,340
don't they just convert the data

626
00:30:45,910 --> 00:30:50,830
together and go oh well you can<font color="#E5E5E5"> possibly</font>

627
00:30:48,340 --> 00:30:52,959
be at the airport here five miles away

628
00:30:50,830 --> 00:30:54,159
<font color="#E5E5E5">now the thing</font><font color="#CCCCCC"> is that</font><font color="#E5E5E5"> the GPS is going</font>

629
00:30:52,960 --> 00:30:58,090
to consume a lot of battery to the

630
00:30:54,160 --> 00:31:00,190
device so all windows phones and windows

631
00:30:58,090 --> 00:31:01,870
devices don't have GPS enabled by

632
00:31:00,190 --> 00:31:03,760
default you need to manually set it on

633
00:31:01,870 --> 00:31:06,399
however the windows location service

634
00:31:03,760 --> 00:31:08,800
doesn't require any heavy battery

635
00:31:06,400 --> 00:31:12,130
consumption consumption so it's enabled

636
00:31:08,800 --> 00:31:14,379
by default all<font color="#E5E5E5"> the time and it's working</font>

637
00:31:12,130 --> 00:31:15,700
in this in this way<font color="#E5E5E5"> you get the networks</font>

638
00:31:14,380 --> 00:31:17,490
around you send them<font color="#E5E5E5"> to the position</font>

639
00:31:15,700 --> 00:31:24,940
server you're getting back the

640
00:31:17,490 --> 00:31:27,040
opposition<font color="#CCCCCC"> Thanks sure if you've got any</font>

641
00:31:24,940 --> 00:31:30,520
more questions you can maybe now use the

642
00:31:27,040 --> 00:31:32,950
coffee break tools<font color="#CCCCCC"> awesome we'll</font><font color="#E5E5E5"> be back</font>

643
00:31:30,520 --> 00:31:34,900
<font color="#CCCCCC">here in half an hour and</font><font color="#E5E5E5"> there's two</font>

644
00:31:32,950 --> 00:31:36,610
more talk so if you<font color="#E5E5E5"> really want to be an</font>

645
00:31:34,900 --> 00:31:38,980
expert after<font color="#CCCCCC"> this day and how</font>

646
00:31:36,610 --> 00:31:41,110
communication can be intercepted<font color="#E5E5E5"> em is</font>

647
00:31:38,980 --> 00:31:44,520
used then please come back in half an

648
00:31:41,110 --> 00:31:44,520
hour when we've<font color="#CCCCCC"> got two more talks</font>

