1
00:00:09,280 --> 00:00:14,590
so like was<font color="#E5E5E5"> it just mentioned I'm</font><font color="#CCCCCC"> Ben</font>

2
00:00:12,400 --> 00:00:18,130
Hayek I'm the security<font color="#CCCCCC"> industry</font><font color="#E5E5E5"> almost</font>

3
00:00:14,590 --> 00:00:20,740
<font color="#E5E5E5">for like ten years now doing I was doing</font>

4
00:00:18,130 --> 00:00:24,400
<font color="#CCCCCC">consulting and some reverse engineering</font>

5
00:00:20,740 --> 00:00:26,259
then a lot of web<font color="#E5E5E5"> and I'm going to</font>

6
00:00:24,400 --> 00:00:28,810
<font color="#CCCCCC">present the</font><font color="#E5E5E5"> same origin method execution</font>

7
00:00:26,260 --> 00:00:32,410
attack<font color="#E5E5E5"> which is</font><font color="#CCCCCC"> something that I</font>

8
00:00:28,810 --> 00:00:34,860
presented<font color="#E5E5E5"> about in black hat and two</font>

9
00:00:32,409 --> 00:00:37,750
years ago but there was a lot of

10
00:00:34,860 --> 00:00:40,030
<font color="#E5E5E5">confusion about the attack and I really</font>

11
00:00:37,750 --> 00:00:43,620
wanted to<font color="#CCCCCC"> clarify things</font><font color="#E5E5E5"> and to be</font>

12
00:00:40,030 --> 00:00:46,210
<font color="#E5E5E5">honest I didn't have the chance to</font>

13
00:00:43,620 --> 00:00:48,040
<font color="#CCCCCC">actually talk about the technical</font>

14
00:00:46,210 --> 00:00:51,940
<font color="#CCCCCC">details in the conference before</font><font color="#E5E5E5"> because</font>

15
00:00:48,040 --> 00:00:54,339
I really wanted<font color="#CCCCCC"> to tell the people</font><font color="#E5E5E5"> about</font>

16
00:00:51,940 --> 00:00:58,989
the implications of the attack and

17
00:00:54,340 --> 00:01:01,390
because it was fairly new<font color="#E5E5E5"> so the title</font>

18
00:00:58,989 --> 00:01:02,890
says<font color="#CCCCCC"> advance at</font><font color="#E5E5E5"> six however</font><font color="#CCCCCC"> I'm not</font>

19
00:01:01,390 --> 00:01:05,170
<font color="#CCCCCC">going to cover all</font><font color="#E5E5E5"> the advanced aspects</font>

20
00:01:02,890 --> 00:01:08,020
of the of the attack<font color="#E5E5E5"> because of</font><font color="#CCCCCC"> the time</font>

21
00:01:05,170 --> 00:01:10,030
frame<font color="#E5E5E5"> but it's going to be enough and if</font>

22
00:01:08,020 --> 00:01:12,390
you need more<font color="#E5E5E5"> than</font><font color="#CCCCCC"> that I make</font><font color="#E5E5E5"> sure to</font>

23
00:01:10,030 --> 00:01:16,600
read the white paper<font color="#E5E5E5"> and</font><font color="#CCCCCC"> will be more</font>

24
00:01:12,390 --> 00:01:19,689
more detailed than this so<font color="#CCCCCC"> same-origin</font>

25
00:01:16,600 --> 00:01:22,929
<font color="#E5E5E5">method execution is something between</font><font color="#CCCCCC"> CS</font>

26
00:01:19,689 --> 00:01:25,449
<font color="#E5E5E5">arrests attacks and XSS it's worse than</font>

27
00:01:22,930 --> 00:01:28,780
<font color="#E5E5E5">CSRF but it's a little bit less than</font><font color="#CCCCCC"> the</font>

28
00:01:25,450 --> 00:01:30,850
<font color="#CCCCCC">Nexus S but</font><font color="#E5E5E5"> if it can get as worse</font><font color="#CCCCCC"> as it</font>

29
00:01:28,780 --> 00:01:33,070
<font color="#E5E5E5">is so it's a client-side world fication</font>

30
00:01:30,850 --> 00:01:35,798
attack<font color="#E5E5E5"> you attack a browser you hijack</font>

31
00:01:33,070 --> 00:01:38,829
operations on behalf of users<font color="#CCCCCC"> what are</font>

32
00:01:35,799 --> 00:01:41,320
the problems that disturbed<font color="#CCCCCC"> the attack</font>

33
00:01:38,829 --> 00:01:44,189
to<font color="#E5E5E5"> be like very popular is because it's</font>

34
00:01:41,320 --> 00:01:46,179
it's less it's less prevalent than

35
00:01:44,189 --> 00:01:48,908
cross-site scripting wherein cross-site

36
00:01:46,180 --> 00:01:50,829
scripting just like<font color="#E5E5E5"> Miss filtering or</font>

37
00:01:48,909 --> 00:01:53,170
you don't sanitize input you<font color="#E5E5E5"> have the</font>

38
00:01:50,829 --> 00:01:55,570
attack here you have to find a dedicated

39
00:01:53,170 --> 00:01:57,549
<font color="#E5E5E5">endpoint so the popularity let's talk</font>

40
00:01:55,570 --> 00:02:00,699
about<font color="#E5E5E5"> how prevalent it is so the first</font>

41
00:01:57,549 --> 00:02:03,939
<font color="#E5E5E5">the first time</font><font color="#CCCCCC"> I saw this the</font><font color="#E5E5E5"> attack</font>

42
00:02:00,700 --> 00:02:05,409
<font color="#E5E5E5">aside on Google+ I just want to mention</font>

43
00:02:03,939 --> 00:02:07,979
<font color="#E5E5E5">that everything</font><font color="#CCCCCC"> that you see here is</font>

44
00:02:05,409 --> 00:02:11,530
patched already looks like<font color="#E5E5E5"> PR things but</font>

45
00:02:07,979 --> 00:02:13,900
the the<font color="#E5E5E5"> Google+ had a dedicated endpoint</font>

46
00:02:11,530 --> 00:02:15,640
<font color="#CCCCCC">that executed a callback function and</font>

47
00:02:13,900 --> 00:02:17,620
callback<font color="#E5E5E5"> functions simply a JavaScript</font>

48
00:02:15,640 --> 00:02:20,829
function<font color="#E5E5E5"> that executes</font><font color="#CCCCCC"> in that endpoint</font>

49
00:02:17,620 --> 00:02:22,959
<font color="#CCCCCC">so they were vulnerable Yammer which is</font>

50
00:02:20,830 --> 00:02:26,159
which was found by researcher

51
00:02:22,959 --> 00:02:29,260
not every searcher<font color="#E5E5E5"> flesh</font><font color="#CCCCCC"> end point</font>

52
00:02:26,159 --> 00:02:31,269
<font color="#CCCCCC">wordpress</font><font color="#E5E5E5"> every word first before</font><font color="#CCCCCC"> these</font>

53
00:02:29,260 --> 00:02:33,399
<font color="#CCCCCC">versions you see on the screen</font><font color="#E5E5E5"> was</font>

54
00:02:31,269 --> 00:02:34,719
vulnerable by default<font color="#E5E5E5"> to some and</font>

55
00:02:33,400 --> 00:02:36,700
there's a lot<font color="#E5E5E5"> you can do with that</font>

56
00:02:34,719 --> 00:02:38,349
including<font color="#CCCCCC"> adding yourself as an admin on</font>

57
00:02:36,700 --> 00:02:42,730
behalf of user if<font color="#E5E5E5"> you're attacking</font>

58
00:02:38,349 --> 00:02:45,310
another admin<font color="#CCCCCC"> paypal i reported a paypal</font>

59
00:02:42,730 --> 00:02:47,170
<font color="#E5E5E5">a flash endpoint to paypal cell source</font>

60
00:02:45,310 --> 00:02:49,469
which<font color="#E5E5E5"> i work for right now so this is</font>

61
00:02:47,170 --> 00:02:52,149
<font color="#E5E5E5">everything is patched</font><font color="#CCCCCC"> in some</font><font color="#E5E5E5"> work but</font>

62
00:02:49,469 --> 00:02:55,079
there we had documents and other private

63
00:02:52,150 --> 00:02:57,669
bug bounties it's now it's it's

64
00:02:55,079 --> 00:02:59,919
categorized<font color="#E5E5E5"> as</font><font color="#CCCCCC"> sam everybody knows about</font>

65
00:02:57,669 --> 00:03:02,109
not everybody but bug<font color="#CCCCCC"> monkeys know how</font>

66
00:02:59,919 --> 00:03:06,010
to respect<font color="#E5E5E5"> that and pay</font><font color="#CCCCCC"> for it</font>

67
00:03:02,109 --> 00:03:08,219
accordingly<font color="#E5E5E5"> if you find it so what is</font>

68
00:03:06,010 --> 00:03:10,540
<font color="#CCCCCC">same origin method execution</font><font color="#E5E5E5"> i want to</font>

69
00:03:08,219 --> 00:03:13,030
clarify<font color="#E5E5E5"> this because</font><font color="#CCCCCC"> there's a</font><font color="#E5E5E5"> lot of</font>

70
00:03:10,540 --> 00:03:15,700
confusion<font color="#E5E5E5"> about</font><font color="#CCCCCC"> just empty and the</font>

71
00:03:13,030 --> 00:03:17,459
relationship with<font color="#E5E5E5"> that</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> same</font><font color="#CCCCCC"> origin</font>

72
00:03:15,700 --> 00:03:19,780
method execution is<font color="#E5E5E5"> the</font><font color="#CCCCCC"> ability</font><font color="#E5E5E5"> of</font>

73
00:03:17,459 --> 00:03:22,379
arbitrary method execution<font color="#E5E5E5"> they were in</font>

74
00:03:19,780 --> 00:03:26,439
the work location context<font color="#E5E5E5"> whether the</font>

75
00:03:22,379 --> 00:03:28,149
<font color="#CCCCCC">endpoints maybe</font><font color="#E5E5E5"> plugin systems or</font>

76
00:03:26,439 --> 00:03:30,940
documents like that accredits pop-ups or

77
00:03:28,150 --> 00:03:33,849
stuff<font color="#CCCCCC"> like that</font><font color="#E5E5E5"> the text starts by</font>

78
00:03:30,940 --> 00:03:37,000
having<font color="#CCCCCC"> the ability to</font><font color="#E5E5E5"> execute a message</font>

79
00:03:33,849 --> 00:03:39,548
on a web application context and you'll

80
00:03:37,000 --> 00:03:41,739
see later why it's important<font color="#E5E5E5"> so what</font><font color="#CCCCCC"> i</font>

81
00:03:39,549 --> 00:03:44,829
like<font color="#CCCCCC"> to explain</font><font color="#E5E5E5"> what</font><font color="#CCCCCC"> i talk about land</font>

82
00:03:41,739 --> 00:03:46,569
let's see<font color="#CCCCCC"> i started i'm</font><font color="#E5E5E5"> going to show</font>

83
00:03:44,829 --> 00:03:48,430
you<font color="#E5E5E5"> a demo</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> what I mean by arbitrary</font>

84
00:03:46,569 --> 00:03:53,470
method execution and arbitrary is

85
00:03:48,430 --> 00:03:56,079
basically<font color="#E5E5E5"> having the having the</font><font color="#CCCCCC"> ability</font>

86
00:03:53,470 --> 00:03:58,180
of controlling<font color="#E5E5E5"> which function is being</font>

87
00:03:56,079 --> 00:04:00,729
executed so I<font color="#E5E5E5"> built</font><font color="#CCCCCC"> it playground for</font>

88
00:03:58,180 --> 00:04:04,930
<font color="#E5E5E5">you to realize</font><font color="#CCCCCC"> what it is</font><font color="#E5E5E5"> and this is</font>

89
00:04:00,729 --> 00:04:06,340
<font color="#CCCCCC">just like a</font><font color="#E5E5E5"> ordinary behavior</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> web</font>

90
00:04:04,930 --> 00:04:07,629
application<font color="#CCCCCC"> contact</font><font color="#E5E5E5"> list is the pop-up</font>

91
00:04:06,340 --> 00:04:10,689
<font color="#CCCCCC">window that</font><font color="#E5E5E5"> opens once you click here</font>

92
00:04:07,629 --> 00:04:13,810
<font color="#E5E5E5">and whenever you click this color wheel</font>

93
00:04:10,689 --> 00:04:16,418
<font color="#E5E5E5">do you see the color changes on</font><font color="#CCCCCC"> a</font>

94
00:04:13,810 --> 00:04:19,418
<font color="#E5E5E5">different context so the</font><font color="#CCCCCC"> pop up</font><font color="#E5E5E5"> do this</font>

95
00:04:16,418 --> 00:04:23,020
by let's see if I<font color="#CCCCCC"> could zoom in</font><font color="#E5E5E5"> by this</font>

96
00:04:19,418 --> 00:04:24,430
<font color="#E5E5E5">callback parameter is being equal to</font>

97
00:04:23,020 --> 00:04:27,210
change color which is a JavaScript

98
00:04:24,430 --> 00:04:31,139
function<font color="#E5E5E5"> on the main window over</font><font color="#CCCCCC"> here so</font>

99
00:04:27,210 --> 00:04:31,138
basically<font color="#CCCCCC"> if we take this</font>

100
00:04:33,320 --> 00:04:39,790
and open it<font color="#E5E5E5"> in a new window so you can</font>

101
00:04:37,280 --> 00:04:42,950
<font color="#E5E5E5">see</font><font color="#CCCCCC"> what I mean</font>

102
00:04:39,790 --> 00:04:45,020
zoom in a little<font color="#E5E5E5"> bit and you can</font><font color="#CCCCCC"> see</font>

103
00:04:42,950 --> 00:04:46,670
this error<font color="#CCCCCC"> to change color the this</font>

104
00:04:45,020 --> 00:04:49,159
<font color="#CCCCCC">endpoint is trying to execute</font><font color="#E5E5E5"> an</font>

105
00:04:46,670 --> 00:04:51,200
arbitrary<font color="#CCCCCC"> method if I say</font><font color="#E5E5E5"> execute this</font>

106
00:04:49,160 --> 00:04:52,970
method<font color="#E5E5E5"> for example</font><font color="#CCCCCC"> you will see</font><font color="#E5E5E5"> another</font>

107
00:04:51,200 --> 00:04:55,789
<font color="#E5E5E5">error and this error is good for you I</font>

108
00:04:52,970 --> 00:04:57,800
<font color="#E5E5E5">mean this means that there is an</font>

109
00:04:55,790 --> 00:04:59,720
execution<font color="#E5E5E5"> that you control in a world</font>

110
00:04:57,800 --> 00:05:01,340
<font color="#E5E5E5">like Asian context this</font><font color="#CCCCCC"> is that an empty</font>

111
00:04:59,720 --> 00:05:03,200
context<font color="#E5E5E5"> there</font><font color="#CCCCCC"> is nothing you</font><font color="#E5E5E5"> can do with</font>

112
00:05:01,340 --> 00:05:04,849
this<font color="#E5E5E5"> but at least you have this is the</font>

113
00:05:03,200 --> 00:05:06,860
starting point<font color="#E5E5E5"> for some you find this</font>

114
00:05:04,850 --> 00:05:11,060
<font color="#E5E5E5">and learn the attack you can do a lot of</font>

115
00:05:06,860 --> 00:05:15,260
stuff<font color="#CCCCCC"> of on behalf</font><font color="#E5E5E5"> of users so call back</font>

116
00:05:11,060 --> 00:05:17,120
the<font color="#E5E5E5"> the concept of call back is not</font>

117
00:05:15,260 --> 00:05:19,370
<font color="#E5E5E5">cross-site scripting so it's limited so</font>

118
00:05:17,120 --> 00:05:22,970
if you<font color="#E5E5E5"> insert some special characters in</font>

119
00:05:19,370 --> 00:05:24,710
<font color="#E5E5E5">here then let me clear the console so</font>

120
00:05:22,970 --> 00:05:26,350
you can see it more<font color="#E5E5E5"> clearly</font><font color="#CCCCCC"> but if you</font>

121
00:05:24,710 --> 00:05:29,690
if you insert anything<font color="#E5E5E5"> that is</font>

122
00:05:26,350 --> 00:05:31,790
considered<font color="#CCCCCC"> on not callback friendly</font>

123
00:05:29,690 --> 00:05:34,010
which is not alphanumeric<font color="#E5E5E5"> dotted</font><font color="#CCCCCC"> and</font>

124
00:05:31,790 --> 00:05:36,550
underscore<font color="#E5E5E5"> you see there is no execution</font>

125
00:05:34,010 --> 00:05:39,500
hence there is<font color="#CCCCCC"> no</font><font color="#E5E5E5"> error so that</font><font color="#CCCCCC"> is what</font>

126
00:05:36,550 --> 00:05:43,160
<font color="#CCCCCC">that is</font><font color="#E5E5E5"> what I mean</font><font color="#CCCCCC"> by arbitrary method</font>

127
00:05:39,500 --> 00:05:46,130
execution where you control<font color="#E5E5E5"> this value</font>

128
00:05:43,160 --> 00:05:47,750
<font color="#E5E5E5">over</font><font color="#CCCCCC"> here</font><font color="#E5E5E5"> and and then point try to</font>

129
00:05:46,130 --> 00:05:55,010
execute<font color="#CCCCCC"> method</font><font color="#E5E5E5"> but with a limited</font>

130
00:05:47,750 --> 00:05:59,750
character set let me bring the clicker

131
00:05:55,010 --> 00:06:02,480
again<font color="#E5E5E5"> okay so yeah so like</font><font color="#CCCCCC"> I just showed</font>

132
00:05:59,750 --> 00:06:03,860
<font color="#CCCCCC">you callbacks limited to alphanumeric</font>

133
00:06:02,480 --> 00:06:06,650
characters<font color="#CCCCCC"> the dot and</font><font color="#E5E5E5"> an underscore</font>

134
00:06:03,860 --> 00:06:09,260
because developers<font color="#E5E5E5"> believe that this is</font>

135
00:06:06,650 --> 00:06:11,510
going<font color="#CCCCCC"> to</font><font color="#E5E5E5"> protect them from world</font>

136
00:06:09,260 --> 00:06:12,920
<font color="#CCCCCC">Legation attacks</font><font color="#E5E5E5"> and otherwise it will</font>

137
00:06:11,510 --> 00:06:15,560
be<font color="#E5E5E5"> across</font><font color="#CCCCCC"> the scripting because you can</font>

138
00:06:12,920 --> 00:06:18,890
<font color="#E5E5E5">just break the context and do inject</font>

139
00:06:15,560 --> 00:06:22,640
JavaScript<font color="#CCCCCC"> but even though there's a</font>

140
00:06:18,890 --> 00:06:24,229
limited character set we always do very

141
00:06:22,640 --> 00:06:27,110
cool<font color="#E5E5E5"> stuff and we can do a lot</font><font color="#CCCCCC"> of stuff</font>

142
00:06:24,230 --> 00:06:29,960
with even even with<font color="#E5E5E5"> the limited limited</font>

143
00:06:27,110 --> 00:06:33,530
<font color="#CCCCCC">character set so that's that</font><font color="#E5E5E5"> is</font>

144
00:06:29,960 --> 00:06:35,270
important to understand so<font color="#CCCCCC"> you may</font>

145
00:06:33,530 --> 00:06:37,070
believe like<font color="#CCCCCC"> that okay you saw that</font>

146
00:06:35,270 --> 00:06:39,590
<font color="#E5E5E5">there is an arbitrary method execution</font>

147
00:06:37,070 --> 00:06:41,510
you can already<font color="#E5E5E5"> execute JavaScript or</font>

148
00:06:39,590 --> 00:06:43,489
even though it's limited<font color="#E5E5E5"> JavaScript so</font>

149
00:06:41,510 --> 00:06:45,950
why do<font color="#E5E5E5"> we need</font><font color="#CCCCCC"> this some attack</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> same</font>

150
00:06:43,490 --> 00:06:47,060
<font color="#CCCCCC">origin method execution attack and the</font>

151
00:06:45,950 --> 00:06:49,670
answer is because

152
00:06:47,060 --> 00:06:53,210
some is allows<font color="#CCCCCC"> you to bypass three</font>

153
00:06:49,670 --> 00:06:56,150
obstacles<font color="#CCCCCC"> first of</font><font color="#E5E5E5"> all like you've seen</font>

154
00:06:53,210 --> 00:07:00,349
there<font color="#CCCCCC"> was like a color wheel in</font><font color="#E5E5E5"> that let</font>

155
00:06:56,150 --> 00:07:04,159
<font color="#CCCCCC">me</font><font color="#E5E5E5"> show you that again</font><font color="#CCCCCC"> I never -</font><font color="#E5E5E5"> see so</font>

156
00:07:00,350 --> 00:07:06,710
you had<font color="#CCCCCC"> like a page which only had like</font>

157
00:07:04,160 --> 00:07:08,300
an empty Dom it had like and a color

158
00:07:06,710 --> 00:07:10,789
picker and<font color="#E5E5E5"> nothing</font><font color="#CCCCCC"> meaningful you can</font>

159
00:07:08,300 --> 00:07:12,590
have like add<font color="#CCCCCC"> yourself</font><font color="#E5E5E5"> as an admin or</font>

160
00:07:10,790 --> 00:07:16,520
<font color="#E5E5E5">anything useful that you can do on</font>

161
00:07:12,590 --> 00:07:18,679
behalf<font color="#E5E5E5"> of users so the the execution</font>

162
00:07:16,520 --> 00:07:20,990
context<font color="#E5E5E5"> of which the JavaScript executes</font>

163
00:07:18,680 --> 00:07:23,060
that<font color="#E5E5E5"> is useless you can do anything when</font>

164
00:07:20,990 --> 00:07:25,910
with the<font color="#CCCCCC"> some attack we</font><font color="#E5E5E5"> select a target</font>

165
00:07:23,060 --> 00:07:28,760
we select<font color="#E5E5E5"> another URL and I'll show you</font>

166
00:07:25,910 --> 00:07:30,230
how<font color="#E5E5E5"> to do that and we</font><font color="#CCCCCC"> actually designate</font>

167
00:07:28,760 --> 00:07:33,920
the execution so we move<font color="#E5E5E5"> the execution</font>

168
00:07:30,230 --> 00:07:36,470
<font color="#E5E5E5">to that endpoint so now from the instead</font>

169
00:07:33,920 --> 00:07:38,420
<font color="#E5E5E5">of executing in</font><font color="#CCCCCC"> the empty Dom it will</font>

170
00:07:36,470 --> 00:07:39,530
execute on something that we want<font color="#E5E5E5"> and</font>

171
00:07:38,420 --> 00:07:41,900
something<font color="#E5E5E5"> that have meaningful</font>

172
00:07:39,530 --> 00:07:44,150
operations<font color="#E5E5E5"> are so this is one obstacle</font>

173
00:07:41,900 --> 00:07:46,460
disease second one is wrong timing<font color="#CCCCCC"> I</font>

174
00:07:44,150 --> 00:07:49,400
mean the executing<font color="#CCCCCC"> callback end points</font>

175
00:07:46,460 --> 00:07:51,200
usually<font color="#E5E5E5"> execute right away as</font><font color="#CCCCCC"> soon</font><font color="#E5E5E5"> as</font>

176
00:07:49,400 --> 00:07:54,590
the page loads it executes and we need

177
00:07:51,200 --> 00:07:56,180
to make<font color="#CCCCCC"> sure the execution takes</font><font color="#E5E5E5"> place</font>

178
00:07:54,590 --> 00:07:57,619
at the right place at the right time<font color="#E5E5E5"> so</font>

179
00:07:56,180 --> 00:08:00,800
timing<font color="#E5E5E5"> is a problem you understand that</font>

180
00:07:57,620 --> 00:08:02,510
a little bit<font color="#E5E5E5"> later on more</font><font color="#CCCCCC"> in depth and</font>

181
00:08:00,800 --> 00:08:03,770
a limited character set like we

182
00:08:02,510 --> 00:08:05,719
<font color="#E5E5E5">mentioned</font><font color="#CCCCCC"> there is only alphanumeric</font>

183
00:08:03,770 --> 00:08:07,130
<font color="#CCCCCC">characters the</font><font color="#E5E5E5"> dot so we'll call this</font>

184
00:08:05,720 --> 00:08:11,060
from now<font color="#E5E5E5"> on we'll call the coal-black</font>

185
00:08:07,130 --> 00:08:13,370
<font color="#E5E5E5">friendly character set so</font><font color="#CCCCCC"> you understand</font>

186
00:08:11,060 --> 00:08:16,640
<font color="#E5E5E5">that I mean often America a dot</font><font color="#CCCCCC"> in an</font>

187
00:08:13,370 --> 00:08:19,370
underscore<font color="#E5E5E5"> so with some we only use that</font>

188
00:08:16,640 --> 00:08:24,110
<font color="#E5E5E5">at the payload and we can still do a lot</font>

189
00:08:19,370 --> 00:08:25,669
<font color="#E5E5E5">of stuff on behalf of users so if you</font>

190
00:08:24,110 --> 00:08:27,760
are well if you know about<font color="#CCCCCC"> the</font>

191
00:08:25,669 --> 00:08:30,979
<font color="#E5E5E5">cross-site scripting</font><font color="#CCCCCC"> you would know that</font>

192
00:08:27,760 --> 00:08:33,140
<font color="#CCCCCC">cross-site scripting</font><font color="#E5E5E5"> for many people</font>

193
00:08:30,980 --> 00:08:35,150
<font color="#E5E5E5">it's</font><font color="#CCCCCC"> just an alert box</font><font color="#E5E5E5"> but for people</font>

194
00:08:33,140 --> 00:08:36,919
<font color="#CCCCCC">that just want</font><font color="#E5E5E5"> to do something</font><font color="#CCCCCC"> real on</font>

195
00:08:35,150 --> 00:08:39,530
<font color="#E5E5E5">behalf of the user they deal the payload</font>

196
00:08:36,919 --> 00:08:42,079
<font color="#E5E5E5">they do something they first select the</font>

197
00:08:39,530 --> 00:08:43,728
target<font color="#E5E5E5"> or they first like triggered is</font>

198
00:08:42,080 --> 00:08:45,830
something that they want to<font color="#E5E5E5"> do on behalf</font>

199
00:08:43,729 --> 00:08:49,490
<font color="#E5E5E5">of users they build a payload which is</font>

200
00:08:45,830 --> 00:08:51,740
planning and then they execute so in<font color="#E5E5E5"> the</font>

201
00:08:49,490 --> 00:08:54,320
<font color="#CCCCCC">semetic</font><font color="#E5E5E5"> is the same so</font><font color="#CCCCCC"> same process you</font>

202
00:08:51,740 --> 00:08:58,130
have<font color="#CCCCCC"> to work through targeting planning</font>

203
00:08:54,320 --> 00:09:00,960
and then executing and what is targeting

204
00:08:58,130 --> 00:09:04,350
once again<font color="#CCCCCC"> I</font><font color="#E5E5E5"> want</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> show what I mean by</font>

205
00:09:00,960 --> 00:09:06,480
getting you simply select anything<font color="#E5E5E5"> that</font>

206
00:09:04,350 --> 00:09:09,960
you want<font color="#E5E5E5"> to target</font><font color="#CCCCCC"> if you have</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> some</font>

207
00:09:06,480 --> 00:09:22,830
attack and see where the<font color="#E5E5E5"> video plays</font>

208
00:09:09,960 --> 00:09:24,180
that lets me enjoy<font color="#CCCCCC"> it</font><font color="#E5E5E5"> okay so targeting</font>

209
00:09:22,830 --> 00:09:27,270
in order to understand targeting it's

210
00:09:24,180 --> 00:09:29,310
very kind<font color="#E5E5E5"> of</font><font color="#CCCCCC"> simple let's say you have</font>

211
00:09:27,270 --> 00:09:31,140
this ecommerce website and you know

212
00:09:29,310 --> 00:09:32,670
<font color="#E5E5E5">there is an admin or some platform that</font>

213
00:09:31,140 --> 00:09:35,130
you want to attack and you know that the

214
00:09:32,670 --> 00:09:36,660
admin<font color="#E5E5E5"> is running this platform</font><font color="#CCCCCC"> so you</font>

215
00:09:35,130 --> 00:09:38,520
install the platform you are<font color="#CCCCCC"> in your</font>

216
00:09:36,660 --> 00:09:40,829
computer<font color="#CCCCCC"> on your</font><font color="#E5E5E5"> localhost or on</font>

217
00:09:38,520 --> 00:09:43,260
whatever you want<font color="#E5E5E5"> and you</font><font color="#CCCCCC"> start</font>

218
00:09:40,830 --> 00:09:45,120
exploring the<font color="#E5E5E5"> target let's see like if</font>

219
00:09:43,260 --> 00:09:48,300
you want<font color="#E5E5E5"> to go to for</font><font color="#CCCCCC"> example sales</font>

220
00:09:45,120 --> 00:09:51,420
you're going to go<font color="#E5E5E5"> to orders and select</font>

221
00:09:48,300 --> 00:09:54,000
some order that<font color="#E5E5E5"> of</font><font color="#CCCCCC"> $2000 for example</font>

222
00:09:51,420 --> 00:09:55,319
view it<font color="#CCCCCC"> you just like</font><font color="#E5E5E5"> explore the</font>

223
00:09:54,000 --> 00:09:56,610
website<font color="#E5E5E5"> and decide liking to see if the</font>

224
00:09:55,320 --> 00:09:59,400
rep<font color="#CCCCCC"> attack you decide what you</font><font color="#E5E5E5"> want to</font>

225
00:09:56,610 --> 00:10:00,960
<font color="#E5E5E5">do on</font><font color="#CCCCCC"> behalf of the user so at this</font>

226
00:09:59,400 --> 00:10:02,610
<font color="#E5E5E5">point we decided</font><font color="#CCCCCC"> that we want</font><font color="#E5E5E5"> to cancel</font>

227
00:10:00,960 --> 00:10:05,070
<font color="#E5E5E5">this order on behalf of a user</font>

228
00:10:02,610 --> 00:10:07,320
we don't have<font color="#E5E5E5"> XSS we have a same origin</font>

229
00:10:05,070 --> 00:10:09,630
method execution arbitrary method<font color="#CCCCCC"> of</font>

230
00:10:07,320 --> 00:10:11,460
execution<font color="#E5E5E5"> that</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> seen and we want to</font>

231
00:10:09,630 --> 00:10:15,570
do we<font color="#CCCCCC"> want to</font><font color="#E5E5E5"> cancel the</font><font color="#CCCCCC"> order</font><font color="#E5E5E5"> on behalf</font>

232
00:10:11,460 --> 00:10:17,760
<font color="#E5E5E5">of the user</font><font color="#CCCCCC"> so what we do is we save the</font>

233
00:10:15,570 --> 00:10:21,750
<font color="#CCCCCC">URL because</font><font color="#E5E5E5"> we want</font><font color="#CCCCCC"> to target</font><font color="#E5E5E5"> this URL</font>

234
00:10:17,760 --> 00:10:24,030
<font color="#E5E5E5">and we want to save that so later on so</font>

235
00:10:21,750 --> 00:10:26,220
we<font color="#E5E5E5"> copied that and we select the target</font>

236
00:10:24,030 --> 00:10:28,170
<font color="#E5E5E5">which is</font><font color="#CCCCCC"> the yes button over here of</font>

237
00:10:26,220 --> 00:10:32,190
<font color="#E5E5E5">canceling in order this is just an</font>

238
00:10:28,170 --> 00:10:33,860
<font color="#CCCCCC">example you can</font><font color="#E5E5E5"> go more severe</font><font color="#CCCCCC"> or less</font>

239
00:10:32,190 --> 00:10:36,300
severe depending<font color="#CCCCCC"> on the website and</font>

240
00:10:33,860 --> 00:10:39,210
luckily<font color="#CCCCCC"> for us if we inspect</font><font color="#E5E5E5"> this button</font>

241
00:10:36,300 --> 00:10:40,740
we see<font color="#CCCCCC"> that there's an ID that we can</font>

242
00:10:39,210 --> 00:10:41,370
use<font color="#CCCCCC"> to</font><font color="#E5E5E5"> reference this button using</font>

243
00:10:40,740 --> 00:10:44,340
javascript

244
00:10:41,370 --> 00:10:49,440
<font color="#E5E5E5">however this ID contains hyphens and</font>

245
00:10:44,340 --> 00:10:51,420
hyphens in<font color="#CCCCCC"> JavaScript</font><font color="#E5E5E5"> is right here so</font>

246
00:10:49,440 --> 00:10:52,920
hyphens will be considered<font color="#E5E5E5"> arithmetic</font>

247
00:10:51,420 --> 00:10:55,979
<font color="#CCCCCC">operations so we can't really use this</font>

248
00:10:52,920 --> 00:10:58,709
ID<font color="#CCCCCC"> we'll need to use something else to</font>

249
00:10:55,980 --> 00:10:59,970
<font color="#E5E5E5">trigger this yes button but the most</font>

250
00:10:58,710 --> 00:11:02,340
important thing to understand here<font color="#CCCCCC"> is</font>

251
00:10:59,970 --> 00:11:04,140
that<font color="#E5E5E5"> this is targeting we select what</font>

252
00:11:02,340 --> 00:11:06,920
you do<font color="#E5E5E5"> very similar to what we do in a</font>

253
00:11:04,140 --> 00:11:06,920
theater<font color="#CCCCCC"> is attack</font>

254
00:11:16,610 --> 00:11:23,610
<font color="#E5E5E5">okay so the next</font><font color="#CCCCCC"> thing is after</font><font color="#E5E5E5"> we</font>

255
00:11:19,440 --> 00:11:27,180
selected our target<font color="#E5E5E5"> we we go to this</font>

256
00:11:23,610 --> 00:11:29,250
plan<font color="#CCCCCC"> step so planning</font><font color="#E5E5E5"> is really really</font>

257
00:11:27,180 --> 00:11:31,050
simple<font color="#E5E5E5"> shuffling the cards right or</font>

258
00:11:29,250 --> 00:11:33,779
<font color="#E5E5E5">whatever you just simply open</font><font color="#CCCCCC"> another</font>

259
00:11:31,050 --> 00:11:36,599
window<font color="#E5E5E5"> in your website this</font><font color="#CCCCCC"> is all there</font>

260
00:11:33,779 --> 00:11:39,060
is<font color="#CCCCCC"> to understand in planning website</font><font color="#E5E5E5"> so</font>

261
00:11:36,600 --> 00:11:40,709
we just use the simple<font color="#CCCCCC"> window open</font>

262
00:11:39,060 --> 00:11:43,050
operation<font color="#E5E5E5"> in JavaScript and then you</font>

263
00:11:40,709 --> 00:11:45,359
have another<font color="#E5E5E5"> window it does some magic</font>

264
00:11:43,050 --> 00:11:47,579
<font color="#CCCCCC">you will see later on</font><font color="#E5E5E5"> why it's important</font>

265
00:11:45,360 --> 00:11:50,070
but<font color="#E5E5E5"> the basic thing is</font><font color="#CCCCCC"> that now instead</font>

266
00:11:47,580 --> 00:11:51,240
<font color="#CCCCCC">of</font><font color="#E5E5E5"> one window object we</font><font color="#CCCCCC"> have two window</font>

267
00:11:50,070 --> 00:11:54,930
objects and we can play<font color="#E5E5E5"> with the</font>

268
00:11:51,240 --> 00:11:59,850
execution context<font color="#E5E5E5"> and that would be</font>

269
00:11:54,930 --> 00:12:03,479
really<font color="#CCCCCC"> helpful</font><font color="#E5E5E5"> later on so the next step</font>

270
00:11:59,850 --> 00:12:05,640
the last step is execute and like you've

271
00:12:03,480 --> 00:12:08,130
seen we we had in a color picker<font color="#CCCCCC"> or any</font>

272
00:12:05,640 --> 00:12:09,870
other website<font color="#E5E5E5"> we have the ability to</font>

273
00:12:08,130 --> 00:12:13,800
execute arbitrary method<font color="#E5E5E5"> which is the</font>

274
00:12:09,870 --> 00:12:15,510
starting point<font color="#CCCCCC"> so after we target and</font>

275
00:12:13,800 --> 00:12:19,079
plan you use a<font color="#E5E5E5"> set</font><font color="#CCCCCC"> of redirections</font>

276
00:12:15,510 --> 00:12:21,360
<font color="#E5E5E5">I will show</font><font color="#CCCCCC"> exactly what and how</font><font color="#E5E5E5"> to do</font>

277
00:12:19,080 --> 00:12:22,650
that but<font color="#E5E5E5"> you</font><font color="#CCCCCC"> we redirect up the pages in</font>

278
00:12:21,360 --> 00:12:25,140
the<font color="#E5E5E5"> right place at the right</font><font color="#CCCCCC"> time in the</font>

279
00:12:22,650 --> 00:12:27,240
right order<font color="#CCCCCC"> and we cause the website on</font>

280
00:12:25,140 --> 00:12:31,140
<font color="#E5E5E5">the same origin to execute the</font>

281
00:12:27,240 --> 00:12:35,190
JavaScript function and on the victims

282
00:12:31,140 --> 00:12:38,610
we have and make him<font color="#CCCCCC"> add your status as</font>

283
00:12:35,190 --> 00:12:40,560
an admin<font color="#E5E5E5"> or if</font><font color="#CCCCCC"> this is</font><font color="#E5E5E5"> ecommerce website</font>

284
00:12:38,610 --> 00:12:42,000
example<font color="#E5E5E5"> cancel the</font><font color="#CCCCCC"> order on behalf of</font>

285
00:12:40,560 --> 00:12:44,880
him because he has the permission<font color="#CCCCCC"> to do</font>

286
00:12:42,000 --> 00:12:48,080
it<font color="#E5E5E5"> and we don't so we</font><font color="#CCCCCC"> use redirection</font>

287
00:12:44,880 --> 00:12:50,370
for that<font color="#CCCCCC"> the steps would</font><font color="#E5E5E5"> be like this</font>

288
00:12:48,080 --> 00:12:53,220
you will redirect the main page like

289
00:12:50,370 --> 00:12:54,930
like I mentioned we used to<font color="#E5E5E5"> work two</font>

290
00:12:53,220 --> 00:12:58,620
windows so<font color="#CCCCCC"> we redirect the main window</font>

291
00:12:54,930 --> 00:13:01,609
to the target URL<font color="#E5E5E5"> that we chose the</font>

292
00:12:58,620 --> 00:13:04,339
<font color="#CCCCCC">e-commerce</font><font color="#E5E5E5"> websites or whatever else and</font>

293
00:13:01,610 --> 00:13:07,200
for<font color="#E5E5E5"> that would break same origin policy</font>

294
00:13:04,339 --> 00:13:09,300
<font color="#E5E5E5">so then after a time I want to redirect</font>

295
00:13:07,200 --> 00:13:11,490
the second<font color="#E5E5E5"> window the pop-up window</font><font color="#CCCCCC"> that</font>

296
00:13:09,300 --> 00:13:13,079
we<font color="#CCCCCC"> opened and at that</font><font color="#E5E5E5"> point both of</font><font color="#CCCCCC"> the</font>

297
00:13:11,490 --> 00:13:14,820
windows will be at the same origin<font color="#CCCCCC"> we</font>

298
00:13:13,079 --> 00:13:16,560
set the callback parameter to a method

299
00:13:14,820 --> 00:13:18,930
<font color="#E5E5E5">that we want to execute on behalf of a</font>

300
00:13:16,560 --> 00:13:22,560
user<font color="#E5E5E5"> and then the method</font><font color="#CCCCCC"> executes on</font>

301
00:13:18,930 --> 00:13:25,378
this context<font color="#CCCCCC"> so</font><font color="#E5E5E5"> that</font>

302
00:13:22,560 --> 00:13:28,229
that is the brief<font color="#CCCCCC"> overview of the attack</font>

303
00:13:25,379 --> 00:13:31,139
now we'll go a<font color="#E5E5E5"> little bit more deeper to</font>

304
00:13:28,230 --> 00:13:34,079
the<font color="#E5E5E5"> details and why</font><font color="#CCCCCC"> so back to the first</font>

305
00:13:31,139 --> 00:13:35,519
slide<font color="#CCCCCC"> the ability of Robert Horry method</font>

306
00:13:34,079 --> 00:13:36,899
execution this<font color="#E5E5E5"> is really important to</font>

307
00:13:35,519 --> 00:13:39,269
understand there was<font color="#E5E5E5"> a lot of confusion</font>

308
00:13:36,899 --> 00:13:42,629
<font color="#CCCCCC">because everybody every time people</font><font color="#E5E5E5"> see</font>

309
00:13:39,269 --> 00:13:44,699
a callback<font color="#E5E5E5"> parameter they think maybe</font>

310
00:13:42,629 --> 00:13:46,790
<font color="#E5E5E5">you have a some attack and maybe I can</font>

311
00:13:44,699 --> 00:13:51,079
get<font color="#E5E5E5"> pays for this</font><font color="#CCCCCC"> and bug bounties or</font>

312
00:13:46,790 --> 00:13:53,069
report the vulnerability<font color="#E5E5E5"> to my client</font>

313
00:13:51,079 --> 00:13:55,498
<font color="#CCCCCC">but it's important to understand that</font>

314
00:13:53,069 --> 00:13:58,729
what arbitrary method execution means

315
00:13:55,499 --> 00:14:01,290
like I showed<font color="#CCCCCC"> you</font><font color="#E5E5E5"> the color</font><font color="#CCCCCC"> picker and</font>

316
00:13:58,730 --> 00:14:02,819
<font color="#E5E5E5">it can be found in two different ways</font>

317
00:14:01,290 --> 00:14:04,498
you<font color="#CCCCCC"> can define a dedicated</font><font color="#E5E5E5"> popup</font>

318
00:14:02,819 --> 00:14:07,319
endpoint<font color="#E5E5E5"> or you can be found in flash</font>

319
00:14:04,499 --> 00:14:09,860
plugins which is a lot more<font color="#E5E5E5"> there's a</font>

320
00:14:07,319 --> 00:14:13,579
<font color="#E5E5E5">lot more instances in flash</font><font color="#CCCCCC"> and other</font>

321
00:14:09,860 --> 00:14:17,370
plugins that run<font color="#CCCCCC"> JavaScript</font><font color="#E5E5E5"> to interact</font>

322
00:14:13,579 --> 00:14:19,229
so we need to understand which

323
00:14:17,370 --> 00:14:23,759
vulnerable I mean which endpoints are

324
00:14:19,230 --> 00:14:25,410
vulnerable<font color="#E5E5E5"> and why</font><font color="#CCCCCC"> the number one thing</font>

325
00:14:23,759 --> 00:14:27,779
that<font color="#CCCCCC"> you</font><font color="#E5E5E5"> need</font><font color="#CCCCCC"> to make sure is that you</font>

326
00:14:25,410 --> 00:14:30,959
have<font color="#CCCCCC"> an</font><font color="#E5E5E5"> active context the callback</font>

327
00:14:27,779 --> 00:14:34,170
<font color="#CCCCCC">executes in text HTML text</font><font color="#E5E5E5"> XML whatever</font>

328
00:14:30,959 --> 00:14:36,779
or<font color="#CCCCCC"> plug-in</font><font color="#E5E5E5"> whatever that the execution</font>

329
00:14:34,170 --> 00:14:40,069
<font color="#E5E5E5">the execution context maybe needs to be</font>

330
00:14:36,779 --> 00:14:42,360
active<font color="#E5E5E5"> needs to be active and it's not</font>

331
00:14:40,069 --> 00:14:43,709
for<font color="#CCCCCC"> example if you see</font><font color="#E5E5E5"> like I mentioned</font>

332
00:14:42,360 --> 00:14:45,959
<font color="#CCCCCC">JSONP endpoints are not</font><font color="#E5E5E5"> vulnerable</font>

333
00:14:43,709 --> 00:14:48,329
<font color="#E5E5E5">unless they you can change them if you</font>

334
00:14:45,959 --> 00:14:50,369
can make a<font color="#CCCCCC"> JSONP endpoint callback</font>

335
00:14:48,329 --> 00:14:52,439
execute on the page and not just render

336
00:14:50,370 --> 00:14:58,379
then you have a<font color="#E5E5E5"> some attack but if not</font>

337
00:14:52,439 --> 00:14:59,939
then<font color="#E5E5E5"> that's not it so sorry for the</font>

338
00:14:58,379 --> 00:15:02,600
split screen I hope you can see it but

339
00:14:59,939 --> 00:15:05,790
but<font color="#E5E5E5"> I want I</font><font color="#CCCCCC"> really wanted to</font><font color="#E5E5E5"> emphasize</font>

340
00:15:02,600 --> 00:15:09,029
what it means<font color="#E5E5E5"> and this is how to find</font><font color="#CCCCCC"> it</font>

341
00:15:05,790 --> 00:15:11,969
like if you if you<font color="#E5E5E5"> are typing in a URL</font>

342
00:15:09,029 --> 00:15:13,259
for<font color="#CCCCCC"> example and you have a</font><font color="#E5E5E5"> callback</font>

343
00:15:11,970 --> 00:15:14,490
parameter and<font color="#E5E5E5"> you type something in the</font>

344
00:15:13,259 --> 00:15:17,309
callback<font color="#CCCCCC"> parameter you see one of these</font>

345
00:15:14,490 --> 00:15:20,100
errors in the dev of developer console

346
00:15:17,309 --> 00:15:21,839
of course you see that the<font color="#E5E5E5"> the developer</font>

347
00:15:20,100 --> 00:15:24,779
console cannot read property vulnerable

348
00:15:21,839 --> 00:15:26,790
which we just<font color="#E5E5E5"> typed or vulnerable is not</font>

349
00:15:24,779 --> 00:15:29,189
defined<font color="#CCCCCC"> that means is there's an empty</font>

350
00:15:26,790 --> 00:15:31,649
context<font color="#E5E5E5"> or that means an execution in</font>

351
00:15:29,189 --> 00:15:34,290
general so if the<font color="#E5E5E5"> the web application</font>

352
00:15:31,649 --> 00:15:36,570
tries to execute<font color="#E5E5E5"> whatever you put in the</font>

353
00:15:34,290 --> 00:15:38,040
<font color="#E5E5E5">URL parameter over here so this</font>

354
00:15:36,570 --> 00:15:40,500
good for you even though it's an error

355
00:15:38,040 --> 00:15:44,040
this is<font color="#E5E5E5"> a starting point</font><font color="#CCCCCC"> for same-origin</font>

356
00:15:40,500 --> 00:15:47,060
<font color="#E5E5E5">method execution attack and this this</font>

357
00:15:44,040 --> 00:15:50,610
one<font color="#CCCCCC"> is a good</font><font color="#E5E5E5"> example</font><font color="#CCCCCC"> of finding</font><font color="#E5E5E5"> the</font>

358
00:15:47,060 --> 00:15:52,619
<font color="#CCCCCC">vulnerability instances in opposed to</font>

359
00:15:50,610 --> 00:15:53,790
that if you<font color="#E5E5E5"> have a URL and you have a</font>

360
00:15:52,620 --> 00:15:55,290
callback<font color="#E5E5E5"> parameter and by the way the</font>

361
00:15:53,790 --> 00:15:57,689
callbacks are does not<font color="#E5E5E5"> necessarily</font>

362
00:15:55,290 --> 00:15:59,819
<font color="#E5E5E5">suppose I mean have to be named callback</font>

363
00:15:57,690 --> 00:16:01,620
it can be<font color="#CCCCCC"> CB ready</font><font color="#E5E5E5"> function onload</font>

364
00:15:59,820 --> 00:16:04,620
whatever<font color="#E5E5E5"> as long</font><font color="#CCCCCC"> as you see</font><font color="#E5E5E5"> the</font>

365
00:16:01,620 --> 00:16:06,690
<font color="#CCCCCC">execution takes</font><font color="#E5E5E5"> place in the</font><font color="#CCCCCC"> website so</font>

366
00:16:04,620 --> 00:16:09,810
you type in same<font color="#E5E5E5"> thing same process you</font>

367
00:16:06,690 --> 00:16:11,940
type in<font color="#CCCCCC"> something in</font><font color="#E5E5E5"> the callback</font>

368
00:16:09,810 --> 00:16:14,550
parameter<font color="#E5E5E5"> and you</font><font color="#CCCCCC"> see</font><font color="#E5E5E5"> it when renders</font>

369
00:16:11,940 --> 00:16:16,140
the whatever<font color="#E5E5E5"> you write it renders it to</font>

370
00:16:14,550 --> 00:16:17,370
the page<font color="#CCCCCC"> that</font><font color="#E5E5E5"> means that's not good</font><font color="#CCCCCC"> for</font>

371
00:16:16,140 --> 00:16:19,199
you<font color="#E5E5E5"> so it's</font><font color="#CCCCCC"> just that I get direct</font>

372
00:16:17,370 --> 00:16:21,990
access<font color="#CCCCCC"> to adjacent the endpoint the</font>

373
00:16:19,200 --> 00:16:24,060
content type<font color="#CCCCCC"> is passive its application</font>

374
00:16:21,990 --> 00:16:26,640
<font color="#E5E5E5">JavaScript or application Jason this is</font>

375
00:16:24,060 --> 00:16:28,170
<font color="#CCCCCC">not execution</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> I'll let</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> borrow it</font>

376
00:16:26,640 --> 00:16:30,630
<font color="#E5E5E5">change this with something</font><font color="#CCCCCC"> this is not</font>

377
00:16:28,170 --> 00:16:34,579
vulnerable<font color="#E5E5E5"> and I really wanted to make</font>

378
00:16:30,630 --> 00:16:34,580
<font color="#CCCCCC">sure</font><font color="#E5E5E5"> people understand their</font><font color="#CCCCCC"> differences</font>

379
00:16:35,990 --> 00:16:43,950
so yeah<font color="#CCCCCC"> okay so where to look for same</font>

380
00:16:41,640 --> 00:16:45,390
origin method execution attack if<font color="#E5E5E5"> you</font>

381
00:16:43,950 --> 00:16:47,190
want to find it if<font color="#E5E5E5"> you</font><font color="#CCCCCC"> are hunting for</font>

382
00:16:45,390 --> 00:16:48,630
bugs if you have a customer or if you're

383
00:16:47,190 --> 00:16:51,750
a developer and<font color="#E5E5E5"> you</font><font color="#CCCCCC"> want to understand</font>

384
00:16:48,630 --> 00:16:53,880
that the potential<font color="#E5E5E5"> is the great</font>

385
00:16:51,750 --> 00:16:56,910
<font color="#E5E5E5">potential is in two different endpoints</font>

386
00:16:53,880 --> 00:16:59,400
<font color="#E5E5E5">there's like dedicated pop-up windows</font>

387
00:16:56,910 --> 00:17:01,319
mostly if you<font color="#E5E5E5"> have a</font><font color="#CCCCCC"> website</font><font color="#E5E5E5"> and this</font>

388
00:16:59,400 --> 00:17:02,699
website have a color picker for<font color="#E5E5E5"> example</font>

389
00:17:01,320 --> 00:17:06,089
like I've shown<font color="#CCCCCC"> you or</font><font color="#E5E5E5"> whatever else</font>

390
00:17:02,700 --> 00:17:09,480
that<font color="#E5E5E5"> opens the pop-up this pop-up</font><font color="#CCCCCC"> needs</font>

391
00:17:06,089 --> 00:17:12,448
to interact<font color="#CCCCCC"> with the with the page</font><font color="#E5E5E5"> over</font>

392
00:17:09,480 --> 00:17:14,430
here<font color="#E5E5E5"> so it needs to another</font><font color="#CCCCCC"> fie some a</font>

393
00:17:12,449 --> 00:17:16,770
complete event or some any other event

394
00:17:14,430 --> 00:17:18,990
and it needs<font color="#CCCCCC"> to do this and it they may</font>

395
00:17:16,770 --> 00:17:20,609
<font color="#E5E5E5">use developers may use JavaScript</font><font color="#CCCCCC"> to do</font>

396
00:17:18,990 --> 00:17:22,970
this because it's<font color="#E5E5E5"> fairly simple you see</font>

397
00:17:20,609 --> 00:17:25,889
<font color="#E5E5E5">reasons for this in the next slide</font><font color="#CCCCCC"> but</font>

398
00:17:22,970 --> 00:17:29,310
<font color="#CCCCCC">they can do this with the using</font><font color="#E5E5E5"> the</font>

399
00:17:25,890 --> 00:17:30,720
callback<font color="#CCCCCC"> parameter and type in some</font>

400
00:17:29,310 --> 00:17:32,639
JavaScript<font color="#CCCCCC"> function so</font><font color="#E5E5E5"> this is a good</font>

401
00:17:30,720 --> 00:17:34,110
place to<font color="#E5E5E5"> start looking</font><font color="#CCCCCC"> for same origin</font>

402
00:17:32,640 --> 00:17:35,910
method execution vulnerabilities because

403
00:17:34,110 --> 00:17:37,409
this is needs<font color="#E5E5E5"> to interact</font><font color="#CCCCCC"> with this</font>

404
00:17:35,910 --> 00:17:39,660
somehow<font color="#CCCCCC"> I will do it with</font><font color="#E5E5E5"> the</font>

405
00:17:37,410 --> 00:17:42,860
redirection<font color="#E5E5E5"> and stuff but this is</font><font color="#CCCCCC"> a good</font>

406
00:17:39,660 --> 00:17:46,920
place<font color="#CCCCCC"> to start</font><font color="#E5E5E5"> in opposed once again to</font>

407
00:17:42,860 --> 00:17:49,439
this which many people<font color="#E5E5E5"> confuse about</font>

408
00:17:46,920 --> 00:17:50,010
<font color="#E5E5E5">this this is direct access to</font><font color="#CCCCCC"> Jason T</font>

409
00:17:49,440 --> 00:17:58,170
<font color="#E5E5E5">endpoints</font>

410
00:17:50,010 --> 00:18:03,390
not vulnerable<font color="#CCCCCC"> and yeah so one more</font>

411
00:17:58,170 --> 00:18:05,880
thing<font color="#E5E5E5"> is flesh okay so flesh is very</font>

412
00:18:03,390 --> 00:18:08,250
<font color="#CCCCCC">round popular endpoint that</font><font color="#E5E5E5"> you can find</font>

413
00:18:05,880 --> 00:18:10,110
some at actually there are<font color="#E5E5E5"> plugins that</font>

414
00:18:08,250 --> 00:18:14,040
enable<font color="#CCCCCC"> same origin method execution</font>

415
00:18:10,110 --> 00:18:17,129
<font color="#E5E5E5">vulnerabilities by default so the</font><font color="#CCCCCC"> reason</font>

416
00:18:14,040 --> 00:18:18,690
for<font color="#CCCCCC"> this is you know what the reason</font>

417
00:18:17,130 --> 00:18:20,730
<font color="#CCCCCC">will</font><font color="#E5E5E5"> be in the next slide anyway so</font>

418
00:18:18,690 --> 00:18:22,380
there's no<font color="#E5E5E5"> point of telling you right</font>

419
00:18:20,730 --> 00:18:24,840
now<font color="#E5E5E5"> but the basic thing</font><font color="#CCCCCC"> that happens</font>

420
00:18:22,380 --> 00:18:26,460
<font color="#E5E5E5">here if you want to find some once again</font>

421
00:18:24,840 --> 00:18:27,959
that was<font color="#E5E5E5"> the pop-up windows if you want</font>

422
00:18:26,460 --> 00:18:30,420
you want to<font color="#E5E5E5"> check and there is this a</font>

423
00:18:27,960 --> 00:18:34,740
flash<font color="#E5E5E5"> file so if you if you d compile a</font>

424
00:18:30,420 --> 00:18:36,840
flash file and you see this this<font color="#CCCCCC"> is</font>

425
00:18:34,740 --> 00:18:39,510
actually<font color="#E5E5E5"> active</font><font color="#CCCCCC"> JavaScript execution</font>

426
00:18:36,840 --> 00:18:41,189
however the parameter<font color="#E5E5E5"> you see</font><font color="#CCCCCC"> loading</font>

427
00:18:39,510 --> 00:18:43,590
for that<font color="#CCCCCC"> parameters</font><font color="#E5E5E5"> that ready function</font>

428
00:18:41,190 --> 00:18:45,750
<font color="#CCCCCC">which is this is</font><font color="#E5E5E5"> the parameter name the</font>

429
00:18:43,590 --> 00:18:47,939
<font color="#CCCCCC">guess parameter name and this</font><font color="#E5E5E5"> is</font>

430
00:18:45,750 --> 00:18:51,270
<font color="#E5E5E5">execution but however they try to clean</font>

431
00:18:47,940 --> 00:18:52,680
the screen<font color="#E5E5E5"> the strings and they allow</font>

432
00:18:51,270 --> 00:18:56,340
<font color="#E5E5E5">only alphanumeric characters and</font>

433
00:18:52,680 --> 00:18:57,990
underscore<font color="#E5E5E5"> in a dot which</font><font color="#CCCCCC"> is safe for</font>

434
00:18:56,340 --> 00:19:01,530
<font color="#E5E5E5">cross-site scripting but not safe for</font>

435
00:18:57,990 --> 00:19:04,290
<font color="#E5E5E5">this attack so if you see this in a</font>

436
00:19:01,530 --> 00:19:07,950
flash file this<font color="#E5E5E5"> is a vulnerability and</font>

437
00:19:04,290 --> 00:19:09,540
this is you no<font color="#CCCCCC"> longer have to like pitch</font>

438
00:19:07,950 --> 00:19:11,450
the file and leave it you<font color="#E5E5E5"> can do</font>

439
00:19:09,540 --> 00:19:13,830
something<font color="#E5E5E5"> with it</font><font color="#CCCCCC"> with the same</font><font color="#E5E5E5"> attack</font>

440
00:19:11,450 --> 00:19:16,830
<font color="#E5E5E5">so this is another good</font><font color="#CCCCCC"> place to find</font>

441
00:19:13,830 --> 00:19:19,290
some<font color="#E5E5E5"> now I want to be fair with</font><font color="#CCCCCC"> you and</font>

442
00:19:16,830 --> 00:19:20,939
tell<font color="#CCCCCC"> you why people do it I</font><font color="#E5E5E5"> mean why</font>

443
00:19:19,290 --> 00:19:22,830
would people let you<font color="#CCCCCC"> execute the</font>

444
00:19:20,940 --> 00:19:24,660
callback function<font color="#CCCCCC"> why would they like</font>

445
00:19:22,830 --> 00:19:29,310
give you a parameter<font color="#CCCCCC"> to do this I mean</font>

446
00:19:24,660 --> 00:19:32,760
it doesn't<font color="#E5E5E5"> make</font><font color="#CCCCCC"> sense</font><font color="#E5E5E5"> right</font><font color="#CCCCCC"> so there</font><font color="#E5E5E5"> are</font>

447
00:19:29,310 --> 00:19:34,230
reasons<font color="#E5E5E5"> there are</font><font color="#CCCCCC"> the reasons in order</font>

448
00:19:32,760 --> 00:19:35,940
<font color="#CCCCCC">to</font><font color="#E5E5E5"> understand the reasons first we have</font>

449
00:19:34,230 --> 00:19:39,540
to understand where and I actually

450
00:19:35,940 --> 00:19:41,720
<font color="#E5E5E5">mentioned that already but the basic two</font>

451
00:19:39,540 --> 00:19:44,850
main positions for the attack<font color="#E5E5E5"> are</font>

452
00:19:41,720 --> 00:19:47,850
<font color="#CCCCCC">plug-in systems</font><font color="#E5E5E5"> and document like</font>

453
00:19:44,850 --> 00:19:50,280
dedicated<font color="#CCCCCC"> popups like you've seen</font><font color="#E5E5E5"> in the</font>

454
00:19:47,850 --> 00:19:52,199
previous<font color="#E5E5E5"> slide so once we understand</font>

455
00:19:50,280 --> 00:19:56,070
that<font color="#CCCCCC"> we have two</font><font color="#E5E5E5"> different locations or</font>

456
00:19:52,200 --> 00:19:58,020
two<font color="#CCCCCC"> different</font><font color="#E5E5E5"> types</font><font color="#CCCCCC"> we want to answer</font>

457
00:19:56,070 --> 00:20:01,580
<font color="#E5E5E5">the</font><font color="#CCCCCC"> question why developers make such</font>

458
00:19:58,020 --> 00:20:02,940
like vulnerable<font color="#E5E5E5"> endpoint</font>

459
00:20:01,580 --> 00:20:05,580
<font color="#CCCCCC">documents</font>

460
00:20:02,940 --> 00:20:09,570
like the dedicated<font color="#E5E5E5"> pop-ups one main</font>

461
00:20:05,580 --> 00:20:11,489
reason<font color="#CCCCCC"> is interaction because like I</font>

462
00:20:09,570 --> 00:20:13,439
said<font color="#CCCCCC"> whenever you open a pop-up</font><font color="#E5E5E5"> you have</font>

463
00:20:11,489 --> 00:20:14,849
to interact<font color="#E5E5E5"> or any other like a frame</font>

464
00:20:13,440 --> 00:20:16,970
bubble<font color="#E5E5E5"> doesn't matter another window</font>

465
00:20:14,849 --> 00:20:20,908
object you have<font color="#CCCCCC"> to interact</font><font color="#E5E5E5"> with your</font>

466
00:20:16,970 --> 00:20:24,349
main window using<font color="#E5E5E5"> some callback or some</font>

467
00:20:20,909 --> 00:20:26,460
other type of interaction<font color="#E5E5E5"> method so</font>

468
00:20:24,349 --> 00:20:30,269
developers may use the callback<font color="#E5E5E5"> because</font>

469
00:20:26,460 --> 00:20:31,289
<font color="#CCCCCC">it's very</font><font color="#E5E5E5"> simple</font><font color="#CCCCCC"> let's say a web</font>

470
00:20:30,269 --> 00:20:34,229
application<font color="#E5E5E5"> context</font>

471
00:20:31,289 --> 00:20:35,820
<font color="#CCCCCC">gives you a chat option</font><font color="#E5E5E5"> like</font><font color="#CCCCCC"> Facebook so</font>

472
00:20:34,229 --> 00:20:38,099
you're chatting<font color="#E5E5E5"> in</font><font color="#CCCCCC"> Facebook or you're</font>

473
00:20:35,820 --> 00:20:40,859
<font color="#E5E5E5">chatting in any other website or you're</font>

474
00:20:38,099 --> 00:20:43,889
<font color="#E5E5E5">writing a blog post so the you're typing</font>

475
00:20:40,859 --> 00:20:46,590
something<font color="#E5E5E5"> and the same website gives you</font>

476
00:20:43,889 --> 00:20:49,619
the ability<font color="#E5E5E5"> to do something in parallel</font>

477
00:20:46,590 --> 00:20:51,779
like<font color="#E5E5E5"> choosing a color or anything like</font>

478
00:20:49,619 --> 00:20:54,840
<font color="#E5E5E5">that so</font><font color="#CCCCCC"> they don't</font><font color="#E5E5E5"> want to redirect you</font>

479
00:20:51,779 --> 00:20:58,979
<font color="#E5E5E5">to the</font><font color="#CCCCCC"> the other</font><font color="#E5E5E5"> page to choose the</font>

480
00:20:54,840 --> 00:21:00,539
color to do that stuff they want<font color="#E5E5E5"> to they</font>

481
00:20:58,979 --> 00:21:02,489
want<font color="#E5E5E5"> to do it in parallel so without</font>

482
00:21:00,539 --> 00:21:05,099
like deleting<font color="#E5E5E5"> everything that you did in</font>

483
00:21:02,489 --> 00:21:07,499
the<font color="#E5E5E5"> chat box or the blog post even</font>

484
00:21:05,099 --> 00:21:09,809
<font color="#E5E5E5">though there is caching but they just</font>

485
00:21:07,499 --> 00:21:12,809
don't<font color="#E5E5E5"> want to break the operation that</font>

486
00:21:09,809 --> 00:21:14,879
<font color="#E5E5E5">you are just doing same for</font><font color="#CCCCCC"> if</font><font color="#E5E5E5"> you are</font>

487
00:21:12,809 --> 00:21:18,960
<font color="#E5E5E5">like if</font><font color="#CCCCCC"> you are done using a website and</font>

488
00:21:14,879 --> 00:21:23,969
you want to like<font color="#E5E5E5"> get them a resource</font>

489
00:21:18,960 --> 00:21:26,429
<font color="#E5E5E5">from another service like reporting</font>

490
00:21:23,970 --> 00:21:29,639
context or whatever so they would rather

491
00:21:26,429 --> 00:21:31,950
use a<font color="#CCCCCC"> pop-up for</font><font color="#E5E5E5"> login with rather than</font>

492
00:21:29,639 --> 00:21:34,709
other stuff because<font color="#CCCCCC"> that</font><font color="#E5E5E5"> would not ruin</font>

493
00:21:31,950 --> 00:21:36,090
<font color="#E5E5E5">the the website that the things of</font><font color="#CCCCCC"> your</font>

494
00:21:34,710 --> 00:21:39,899
work the content<font color="#E5E5E5"> that you are working on</font>

495
00:21:36,090 --> 00:21:42,119
in<font color="#E5E5E5"> the website itself one of the most</font>

496
00:21:39,899 --> 00:21:43,590
important reasons<font color="#CCCCCC"> it's very very simple</font>

497
00:21:42,119 --> 00:21:46,199
like it's<font color="#CCCCCC"> very simple comparing to the</font>

498
00:21:43,590 --> 00:21:48,238
alternatives like<font color="#CCCCCC"> course or post message</font>

499
00:21:46,200 --> 00:21:49,889
in<font color="#CCCCCC"> html5 that</font><font color="#E5E5E5"> you have to secure the</font>

500
00:21:48,239 --> 00:21:53,009
channel and all that so you just<font color="#CCCCCC"> like</font>

501
00:21:49,889 --> 00:21:55,168
simply execute a<font color="#E5E5E5"> callback then the pop</font>

502
00:21:53,009 --> 00:21:59,849
<font color="#E5E5E5">up nose or the Flash plugin knows how to</font>

503
00:21:55,169 --> 00:22:02,429
interact<font color="#E5E5E5"> with the other window so the</font>

504
00:21:59,849 --> 00:22:06,509
same question goes for vulnerable

505
00:22:02,429 --> 00:22:07,950
<font color="#E5E5E5">plugins like flash once again it's the</font>

506
00:22:06,509 --> 00:22:11,429
conventional<font color="#CCCCCC"> across context</font>

507
00:22:07,950 --> 00:22:13,019
communication way<font color="#CCCCCC"> a flash of</font><font color="#E5E5E5"> I assume</font>

508
00:22:11,429 --> 00:22:15,839
most of you<font color="#E5E5E5"> know</font><font color="#CCCCCC"> already that</font><font color="#E5E5E5"> the flash</font>

509
00:22:13,019 --> 00:22:16,860
file is another context it's another

510
00:22:15,839 --> 00:22:18,360
context like

511
00:22:16,860 --> 00:22:20,010
<font color="#E5E5E5">you're embedding a slash file in a web</font>

512
00:22:18,360 --> 00:22:22,379
<font color="#CCCCCC">application it's another context so that</font>

513
00:22:20,010 --> 00:22:24,390
the whenever<font color="#CCCCCC"> the flesh wants me to</font><font color="#E5E5E5"> rock</font>

514
00:22:22,380 --> 00:22:27,809
with the<font color="#E5E5E5"> page itself it needs to execute</font>

515
00:22:24,390 --> 00:22:31,650
<font color="#E5E5E5">some JavaScript and tell it like notify</font>

516
00:22:27,809 --> 00:22:36,270
events and stuff like that<font color="#CCCCCC"> so the Dom</font>

517
00:22:31,650 --> 00:22:38,280
knows how to react<font color="#CCCCCC"> so the question is</font>

518
00:22:36,270 --> 00:22:40,500
why<font color="#E5E5E5"> did they give us the</font><font color="#CCCCCC"> ability to</font>

519
00:22:38,280 --> 00:22:42,090
<font color="#E5E5E5">control the callback I mean I explained</font>

520
00:22:40,500 --> 00:22:44,250
the interaction but why not setting a

521
00:22:42,090 --> 00:22:45,449
<font color="#CCCCCC">static value</font><font color="#E5E5E5"> that says every</font><font color="#CCCCCC"> time I'm</font>

522
00:22:44,250 --> 00:22:48,480
<font color="#E5E5E5">ready</font>

523
00:22:45,450 --> 00:22:50,490
execute<font color="#CCCCCC"> a status name function</font><font color="#E5E5E5"> and that</font>

524
00:22:48,480 --> 00:22:53,520
<font color="#CCCCCC">will</font><font color="#E5E5E5"> solve everything but why would they</font>

525
00:22:50,490 --> 00:22:57,330
give us the ability<font color="#E5E5E5"> to control using a</font>

526
00:22:53,520 --> 00:22:59,370
<font color="#CCCCCC">parameter or whatever and one answer is</font>

527
00:22:57,330 --> 00:23:02,010
<font color="#E5E5E5">that they serve a large scale of users</font>

528
00:22:59,370 --> 00:23:04,500
let's say that I'm a developer and<font color="#E5E5E5"> I'm</font>

529
00:23:02,010 --> 00:23:06,390
making<font color="#CCCCCC"> a video</font><font color="#E5E5E5"> player for</font><font color="#CCCCCC"> example and I</font>

530
00:23:04,500 --> 00:23:10,950
want<font color="#E5E5E5"> many many websites</font><font color="#CCCCCC"> to use my</font><font color="#E5E5E5"> video</font>

531
00:23:06,390 --> 00:23:15,000
player<font color="#E5E5E5"> so I don't want to UM force like</font>

532
00:23:10,950 --> 00:23:16,470
I don't know like<font color="#E5E5E5"> example.com to execute</font>

533
00:23:15,000 --> 00:23:20,070
a static name because maybe they use

534
00:23:16,470 --> 00:23:21,900
event-driven<font color="#E5E5E5"> Java scripts or any other</font>

535
00:23:20,070 --> 00:23:23,549
techniques<font color="#E5E5E5"> so</font><font color="#CCCCCC"> they need</font><font color="#E5E5E5"> to execute</font>

536
00:23:21,900 --> 00:23:25,890
functions using<font color="#E5E5E5"> like objects at</font>

537
00:23:23,549 --> 00:23:27,330
something<font color="#E5E5E5"> etc</font><font color="#CCCCCC"> except I don't</font><font color="#E5E5E5"> want to</font>

538
00:23:25,890 --> 00:23:29,160
oblah gate them so I give<font color="#E5E5E5"> them the</font>

539
00:23:27,330 --> 00:23:31,970
opportunity<font color="#CCCCCC"> to choose their own way to</font>

540
00:23:29,160 --> 00:23:35,250
come<font color="#CCCCCC"> execute callbacks</font>

541
00:23:31,970 --> 00:23:38,820
one example is once a flash file is

542
00:23:35,250 --> 00:23:41,630
embedded in a<font color="#CCCCCC"> website it it needs like</font>

543
00:23:38,820 --> 00:23:44,970
if it's a very<font color="#E5E5E5"> large flash and it</font>

544
00:23:41,630 --> 00:23:46,620
supports interaction with the HTML page

545
00:23:44,970 --> 00:23:49,590
let's say<font color="#E5E5E5"> like a play button</font><font color="#CCCCCC"> or</font><font color="#E5E5E5"> whatever</font>

546
00:23:46,620 --> 00:23:51,149
<font color="#E5E5E5">it needs to tell it embedding documents</font>

547
00:23:49,590 --> 00:23:53,668
<font color="#CCCCCC">okay I'm ready you can start interacting</font>

548
00:23:51,150 --> 00:23:58,470
<font color="#E5E5E5">with me so that that will be an</font><font color="#CCCCCC"> example</font>

549
00:23:53,669 --> 00:23:59,309
in<font color="#CCCCCC"> a flash</font><font color="#E5E5E5"> plugin and above all others</font>

550
00:23:58,470 --> 00:24:02,040
right

551
00:23:59,309 --> 00:24:03,510
the callback<font color="#CCCCCC"> the developers know that in</font>

552
00:24:02,040 --> 00:24:05,730
<font color="#E5E5E5">order to prevent cross-site scripting</font>

553
00:24:03,510 --> 00:24:07,980
attack they need to<font color="#E5E5E5"> sanitize characters</font>

554
00:24:05,730 --> 00:24:09,929
that was what were all<font color="#CCCCCC"> really boost by</font>

555
00:24:07,980 --> 00:24:12,030
security guys like me<font color="#E5E5E5"> let's say</font><font color="#CCCCCC"> okay</font>

556
00:24:09,929 --> 00:24:14,760
sanitize and input and then you were

557
00:24:12,030 --> 00:24:16,799
safe from cross-site scripting so they

558
00:24:14,760 --> 00:24:19,230
say they rely on this rule this is<font color="#E5E5E5"> the</font>

559
00:24:16,799 --> 00:24:22,950
<font color="#CCCCCC">Reg X that limits</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> whitelist</font><font color="#E5E5E5"> only</font>

560
00:24:19,230 --> 00:24:24,150
characters<font color="#E5E5E5"> in a dot and another score</font>

561
00:24:22,950 --> 00:24:26,280
<font color="#E5E5E5">which is callback friendly and</font>

562
00:24:24,150 --> 00:24:27,750
characters and they say what<font color="#E5E5E5"> can go</font>

563
00:24:26,280 --> 00:24:31,550
wrong I'm safe from cross-site scripting

564
00:24:27,750 --> 00:24:31,550
so this is good enough

565
00:24:33,080 --> 00:24:41,129
so these were<font color="#CCCCCC"> the reasons</font><font color="#E5E5E5"> and and how to</font>

566
00:24:36,510 --> 00:24:43,379
find<font color="#CCCCCC"> same-origin</font><font color="#E5E5E5"> method execution I want</font>

567
00:24:41,130 --> 00:24:45,330
to break it<font color="#CCCCCC"> down more and talk about</font><font color="#E5E5E5"> the</font>

568
00:24:43,380 --> 00:24:48,570
<font color="#E5E5E5">interesting stuff of how to assemble an</font>

569
00:24:45,330 --> 00:24:50,340
attack and talk<font color="#E5E5E5"> about arbitrary callback</font>

570
00:24:48,570 --> 00:24:52,169
execution<font color="#E5E5E5"> again an arbitrary is a</font>

571
00:24:50,340 --> 00:24:58,310
basically dynamic don't like panic<font color="#E5E5E5"> from</font>

572
00:24:52,170 --> 00:25:01,320
this<font color="#E5E5E5"> work but the thing</font><font color="#CCCCCC"> is let's see the</font>

573
00:24:58,310 --> 00:25:02,879
<font color="#E5E5E5">certain URL that you are like the born</font>

574
00:25:01,320 --> 00:25:04,679
<font color="#E5E5E5">herbal instance may look like this</font><font color="#CCCCCC"> like</font>

575
00:25:02,880 --> 00:25:06,990
<font color="#E5E5E5">you've seen</font><font color="#CCCCCC"> in the demo like a function</font>

576
00:25:04,680 --> 00:25:09,960
<font color="#CCCCCC">that says</font><font color="#E5E5E5"> some callback parameter that</font>

577
00:25:06,990 --> 00:25:12,390
say an equals change<font color="#E5E5E5"> color and the</font>

578
00:25:09,960 --> 00:25:15,090
attack the<font color="#CCCCCC"> expose would look</font><font color="#E5E5E5"> like well</font>

579
00:25:12,390 --> 00:25:18,120
<font color="#E5E5E5">like this like it would say context like</font>

580
00:25:15,090 --> 00:25:21,120
opener<font color="#E5E5E5"> or any other name of another</font>

581
00:25:18,120 --> 00:25:22,830
window a reference to what you want<font color="#E5E5E5"> to</font>

582
00:25:21,120 --> 00:25:25,199
do like remember your target like the

583
00:25:22,830 --> 00:25:27,510
cancel order button so<font color="#E5E5E5"> you can reference</font>

584
00:25:25,200 --> 00:25:29,460
this button using javascript<font color="#CCCCCC"> we'll see</font>

585
00:25:27,510 --> 00:25:31,170
in a minute<font color="#E5E5E5"> how and the method that we</font>

586
00:25:29,460 --> 00:25:33,210
want<font color="#E5E5E5"> to hijack on behalf of user whether</font>

587
00:25:31,170 --> 00:25:45,750
it's a click<font color="#E5E5E5"> Submit setting that</font><font color="#CCCCCC"> I use</font>

588
00:25:33,210 --> 00:25:47,340
and an<font color="#CCCCCC"> X cetera so okay so this is what</font>

589
00:25:45,750 --> 00:25:49,140
I just<font color="#CCCCCC"> talked about</font><font color="#E5E5E5"> like</font><font color="#CCCCCC"> if you see this</font>

590
00:25:47,340 --> 00:25:54,480
in an<font color="#E5E5E5"> endpoint you see can you see the</font>

591
00:25:49,140 --> 00:25:57,090
callback<font color="#CCCCCC"> let me</font><font color="#E5E5E5"> zoom in so there is a</font>

592
00:25:54,480 --> 00:26:00,000
<font color="#E5E5E5">callback parameter over here in the</font>

593
00:25:57,090 --> 00:26:01,409
endpoint<font color="#E5E5E5"> and you see if you look at the</font>

594
00:26:00,000 --> 00:26:04,490
source code<font color="#E5E5E5"> you see that there is an</font>

595
00:26:01,410 --> 00:26:09,030
<font color="#E5E5E5">execution trying to takes place with the</font>

596
00:26:04,490 --> 00:26:10,950
color<font color="#E5E5E5"> hash value and we don't control</font>

597
00:26:09,030 --> 00:26:13,980
this we can only control<font color="#CCCCCC"> the</font><font color="#E5E5E5"> part here</font>

598
00:26:10,950 --> 00:26:15,870
<font color="#E5E5E5">and we still can do can execute the</font>

599
00:26:13,980 --> 00:26:18,960
attack and you also see that<font color="#E5E5E5"> this</font>

600
00:26:15,870 --> 00:26:20,879
<font color="#CCCCCC">execute</font><font color="#E5E5E5"> me name that we put in here try</font>

601
00:26:18,960 --> 00:26:22,650
tries<font color="#E5E5E5"> to be executed in hence we see</font>

602
00:26:20,880 --> 00:26:25,080
this<font color="#E5E5E5"> error because the</font><font color="#CCCCCC"> opener is now and</font>

603
00:26:22,650 --> 00:26:29,130
therefore<font color="#E5E5E5"> there's an error but this is</font>

604
00:26:25,080 --> 00:26:32,399
<font color="#CCCCCC">arbitrating</font><font color="#E5E5E5"> not</font><font color="#CCCCCC"> the zoom out</font><font color="#E5E5E5"> okay so</font>

605
00:26:29,130 --> 00:26:40,820
this is arbitrary<font color="#CCCCCC"> missed opportunity</font>

606
00:26:32,400 --> 00:26:43,620
callback execution<font color="#E5E5E5"> okay you see this</font>

607
00:26:40,820 --> 00:26:44,970
endpoint<font color="#CCCCCC"> you see this</font><font color="#E5E5E5"> pop-up window it's</font>

608
00:26:43,620 --> 00:26:46,590
not a pop-up right<font color="#E5E5E5"> now because we</font><font color="#CCCCCC"> opened</font>

609
00:26:44,970 --> 00:26:48,510
<font color="#CCCCCC">it directly but it doesn't have anything</font>

610
00:26:46,590 --> 00:26:51,270
<font color="#E5E5E5">it doesn't have anything meaningful</font>

611
00:26:48,510 --> 00:26:52,800
<font color="#E5E5E5">doesn't have like</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> delete all the</font>

612
00:26:51,270 --> 00:26:56,610
orders in<font color="#CCCCCC"> the page or do something</font>

613
00:26:52,800 --> 00:26:59,790
special<font color="#CCCCCC"> that you actually</font><font color="#E5E5E5"> show impact to</font>

614
00:26:56,610 --> 00:27:02,879
a customer it's running on on the domain

615
00:26:59,790 --> 00:27:04,950
<font color="#E5E5E5">this is my domain but this can be</font><font color="#CCCCCC"> any</font>

616
00:27:02,880 --> 00:27:06,600
<font color="#E5E5E5">website but the thing</font><font color="#CCCCCC"> is the</font><font color="#E5E5E5"> Dom is</font>

617
00:27:04,950 --> 00:27:08,310
empty<font color="#E5E5E5"> I mean it's not like</font><font color="#CCCCCC"> Phi there is</font>

618
00:27:06,600 --> 00:27:12,719
nothing meaningful<font color="#CCCCCC"> only a color picker</font>

619
00:27:08,310 --> 00:27:17,010
color wheel nothing<font color="#CCCCCC"> we can do to exploit</font>

620
00:27:12,720 --> 00:27:19,010
this<font color="#E5E5E5"> so I call this a useless</font><font color="#CCCCCC"> dump</font>

621
00:27:17,010 --> 00:27:21,480
because<font color="#E5E5E5"> we cannot do anything meaningful</font>

622
00:27:19,010 --> 00:27:24,690
however I mean even though we<font color="#E5E5E5"> can</font>

623
00:27:21,480 --> 00:27:25,950
execute<font color="#E5E5E5"> callback limited JavaScript</font>

624
00:27:24,690 --> 00:27:28,230
callback functions we don't have

625
00:27:25,950 --> 00:27:32,280
anything meaningful<font color="#E5E5E5"> there so we need to</font>

626
00:27:28,230 --> 00:27:34,400
solve it by moving the execution context

627
00:27:32,280 --> 00:27:39,120
to the target that<font color="#CCCCCC"> we</font><font color="#E5E5E5"> want</font>

628
00:27:34,400 --> 00:27:41,910
okay so targeting is the most meaningful

629
00:27:39,120 --> 00:27:45,330
and<font color="#E5E5E5"> I think it's the</font><font color="#CCCCCC"> hardest part to</font>

630
00:27:41,910 --> 00:27:46,920
understand in<font color="#CCCCCC"> some attack</font><font color="#E5E5E5"> but just bear</font>

631
00:27:45,330 --> 00:27:49,560
with me<font color="#E5E5E5"> I'm going</font><font color="#CCCCCC"> to explain it really</font>

632
00:27:46,920 --> 00:27:52,320
<font color="#E5E5E5">deeply and show you how to target</font>

633
00:27:49,560 --> 00:27:54,060
<font color="#E5E5E5">websites</font><font color="#CCCCCC"> so we're</font><font color="#E5E5E5"> going</font><font color="#CCCCCC"> to talk about</font>

634
00:27:52,320 --> 00:27:55,409
<font color="#E5E5E5">choosing the URL that you</font><font color="#CCCCCC"> want to target</font>

635
00:27:54,060 --> 00:27:57,899
<font color="#CCCCCC">like you've seen in the e-commerce</font>

636
00:27:55,410 --> 00:27:59,400
<font color="#E5E5E5">website for deleting orders for example</font>

637
00:27:57,900 --> 00:28:02,400
we're going to talk<font color="#CCCCCC"> about</font>

638
00:27:59,400 --> 00:28:03,690
<font color="#E5E5E5">pinpointing a target reference which you</font>

639
00:28:02,400 --> 00:28:07,620
<font color="#E5E5E5">will see in a minute</font><font color="#CCCCCC"> it's creating a</font>

640
00:28:03,690 --> 00:28:10,320
<font color="#E5E5E5">string that unfurl America string that</font>

641
00:28:07,620 --> 00:28:13,889
<font color="#E5E5E5">represents buttons or</font><font color="#CCCCCC"> octave elemental</font>

642
00:28:10,320 --> 00:28:16,020
forms in the web page<font color="#CCCCCC"> we'll</font><font color="#E5E5E5"> see a demo</font>

643
00:28:13,890 --> 00:28:19,650
and<font color="#E5E5E5"> it's a tool that</font><font color="#CCCCCC"> I made for making</font>

644
00:28:16,020 --> 00:28:21,810
it easier<font color="#CCCCCC"> for everybody okay so back to</font>

645
00:28:19,650 --> 00:28:23,310
the<font color="#E5E5E5"> e-commerce website we instead we</font>

646
00:28:21,810 --> 00:28:27,510
want to<font color="#E5E5E5"> target this PS button on</font>

647
00:28:23,310 --> 00:28:31,169
<font color="#CCCCCC">cancelled in order so I think</font><font color="#E5E5E5"> it's a big</font>

648
00:28:27,510 --> 00:28:33,720
enough so we<font color="#E5E5E5"> can see this this</font><font color="#CCCCCC"> is how</font>

649
00:28:31,170 --> 00:28:37,050
reference may look like this is this<font color="#E5E5E5"> is</font>

650
00:28:33,720 --> 00:28:39,030
a way using javascript<font color="#E5E5E5"> to reference this</font>

651
00:28:37,050 --> 00:28:41,159
button like<font color="#CCCCCC"> you see the console says</font>

652
00:28:39,030 --> 00:28:42,690
<font color="#E5E5E5">okay this is the button and we use</font>

653
00:28:41,160 --> 00:28:45,900
documented<font color="#CCCCCC"> value</font><font color="#E5E5E5"> that first element</font>

654
00:28:42,690 --> 00:28:47,580
child etc etc etc etc we navigate we go

655
00:28:45,900 --> 00:28:50,460
through that<font color="#CCCCCC"> throughout the Dom</font><font color="#E5E5E5"> tree all</font>

656
00:28:47,580 --> 00:28:52,470
<font color="#CCCCCC">the way down to the button so if we if</font>

657
00:28:50,460 --> 00:28:52,860
we<font color="#E5E5E5"> know how to do this we can</font><font color="#CCCCCC"> use the</font>

658
00:28:52,470 --> 00:28:54,630
<font color="#E5E5E5">code</font>

659
00:28:52,860 --> 00:28:57,270
<font color="#CCCCCC">10 points to click on this</font><font color="#E5E5E5"> button on</font>

660
00:28:54,630 --> 00:28:58,770
users behalf but don't<font color="#CCCCCC"> worry don't</font><font color="#E5E5E5"> panic</font>

661
00:28:57,270 --> 00:29:02,970
because<font color="#E5E5E5"> of this long string there's a</font>

662
00:28:58,770 --> 00:29:04,320
lot easier way to do this<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> so at</font>

663
00:29:02,970 --> 00:29:08,220
this<font color="#E5E5E5"> point like</font><font color="#CCCCCC"> I said that the</font>

664
00:29:04,320 --> 00:29:10,110
targeting is is not<font color="#E5E5E5"> very simple</font><font color="#CCCCCC"> so about</font>

665
00:29:08,220 --> 00:29:12,150
thankfully the white paper<font color="#E5E5E5"> is on and</font>

666
00:29:10,110 --> 00:29:14,399
blood bank is brown and<font color="#E5E5E5"> also other</font>

667
00:29:12,150 --> 00:29:17,160
customers already<font color="#E5E5E5"> appreciate</font><font color="#CCCCCC"> alerts so</font>

668
00:29:14,400 --> 00:29:18,630
if you can just do an empty alert or

669
00:29:17,160 --> 00:29:22,309
alert that gives you the color or

670
00:29:18,630 --> 00:29:25,710
whatever<font color="#CCCCCC"> if if you can do this this</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> a</font>

671
00:29:22,309 --> 00:29:29,010
well enough POC<font color="#CCCCCC"> that you can post and</font>

672
00:29:25,710 --> 00:29:31,830
<font color="#CCCCCC">they'll be accepted by</font><font color="#E5E5E5"> your customers or</font>

673
00:29:29,010 --> 00:29:33,750
other bounty<font color="#E5E5E5"> if you're a bounty</font><font color="#CCCCCC"> hunter</font>

674
00:29:31,830 --> 00:29:36,059
but<font color="#E5E5E5"> if you are looking for bugs if you</font>

675
00:29:33,750 --> 00:29:38,250
want if you<font color="#E5E5E5"> want to</font><font color="#CCCCCC"> actually exploit</font>

676
00:29:36,059 --> 00:29:42,510
bugs if you are hunting<font color="#E5E5E5"> for bugs and not</font>

677
00:29:38,250 --> 00:29:46,919
bounties<font color="#CCCCCC"> or</font><font color="#E5E5E5"> just do both you can use</font><font color="#CCCCCC"> Dom</font>

678
00:29:42,510 --> 00:29:48,750
navigation<font color="#CCCCCC"> property so the develop</font>

679
00:29:46,919 --> 00:29:50,669
application properties<font color="#CCCCCC"> that I found to</font>

680
00:29:48,750 --> 00:29:52,350
be<font color="#CCCCCC"> really useful are these</font><font color="#E5E5E5"> like first</font>

681
00:29:50,669 --> 00:29:53,700
<font color="#CCCCCC">element chat</font><font color="#E5E5E5"> last element child next</font>

682
00:29:52,350 --> 00:29:56,250
<font color="#CCCCCC">time and sibling previous</font><font color="#E5E5E5"> element</font>

683
00:29:53,700 --> 00:29:58,950
<font color="#E5E5E5">sibling</font><font color="#CCCCCC"> in parn element the names are</font>

684
00:29:56,250 --> 00:30:01,679
pretty intuitive<font color="#CCCCCC"> you can understand what</font>

685
00:29:58,950 --> 00:30:05,669
it do<font color="#E5E5E5"> like if you have the jump tree you</font>

686
00:30:01,679 --> 00:30:07,290
can get inside<font color="#E5E5E5"> the the children of of an</font>

687
00:30:05,669 --> 00:30:10,350
element or you can go to<font color="#E5E5E5"> the next child</font>

688
00:30:07,290 --> 00:30:13,678
and etc<font color="#CCCCCC"> and also</font><font color="#E5E5E5"> don't forget you</font><font color="#CCCCCC"> can</font>

689
00:30:10,350 --> 00:30:15,178
also trigger JavaScript functions on

690
00:30:13,679 --> 00:30:16,440
behalf<font color="#CCCCCC"> of users directly</font><font color="#E5E5E5"> if you</font><font color="#CCCCCC"> have a</font>

691
00:30:15,179 --> 00:30:18,419
JavaScript<font color="#E5E5E5"> function it's the object</font>

692
00:30:16,440 --> 00:30:20,280
<font color="#CCCCCC">ourselves of the order</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> you want to</font>

693
00:30:18,419 --> 00:30:22,740
hijack<font color="#E5E5E5"> this you can do this with the</font>

694
00:30:20,280 --> 00:30:24,360
<font color="#CCCCCC">same attack directly you</font><font color="#E5E5E5"> don't have to</font>

695
00:30:22,740 --> 00:30:27,330
<font color="#CCCCCC">navigate</font><font color="#E5E5E5"> but</font><font color="#CCCCCC"> if you want buttons or</font>

696
00:30:24,360 --> 00:30:29,969
elements or forms you<font color="#E5E5E5"> can do you can use</font>

697
00:30:27,330 --> 00:30:31,860
the navigation properties so a reference

698
00:30:29,970 --> 00:30:34,530
<font color="#CCCCCC">may look like this so there is the count</font>

699
00:30:31,860 --> 00:30:37,379
the context of where we want<font color="#E5E5E5"> to execute</font>

700
00:30:34,530 --> 00:30:38,790
<font color="#E5E5E5">and then it will be</font><font color="#CCCCCC"> document.body it</font>

701
00:30:37,380 --> 00:30:41,309
<font color="#E5E5E5">doesn't really matter and then doesn't</font>

702
00:30:38,790 --> 00:30:43,500
<font color="#E5E5E5">it would be the submit in this</font><font color="#CCCCCC"> case a</font>

703
00:30:41,309 --> 00:30:46,470
form<font color="#CCCCCC"> submission would look like this so</font>

704
00:30:43,500 --> 00:30:49,530
this part would represent a form on the

705
00:30:46,470 --> 00:30:52,590
<font color="#CCCCCC">opening window and submit we want to the</font>

706
00:30:49,530 --> 00:30:54,750
method<font color="#CCCCCC"> if want to</font><font color="#E5E5E5"> hijack or once again a</font>

707
00:30:52,590 --> 00:30:57,240
<font color="#E5E5E5">JavaScript function once again context</font>

708
00:30:54,750 --> 00:30:58,919
<font color="#E5E5E5">and the JavaScript function on the open</font>

709
00:30:57,240 --> 00:31:00,660
<font color="#CCCCCC">window so it can be anything like</font><font color="#E5E5E5"> a</font>

710
00:30:58,919 --> 00:31:03,350
sister<font color="#E5E5E5"> up depends on the on the window</font>

711
00:31:00,660 --> 00:31:06,350
<font color="#CCCCCC">that we you are targeting this would</font>

712
00:31:03,350 --> 00:31:06,350
vary

713
00:31:06,720 --> 00:31:12,190
so like we<font color="#E5E5E5"> mentioned we can travel</font>

714
00:31:10,059 --> 00:31:16,029
throughout the<font color="#CCCCCC"> Dom</font><font color="#E5E5E5"> tree using navigation</font>

715
00:31:12,190 --> 00:31:17,649
properties<font color="#E5E5E5"> there's there are two main</font>

716
00:31:16,029 --> 00:31:19,239
ways<font color="#CCCCCC"> to</font><font color="#E5E5E5"> do this so we can start from the</font>

717
00:31:17,649 --> 00:31:20,918
document body like you saw but<font color="#E5E5E5"> there was</font>

718
00:31:19,239 --> 00:31:24,730
like a very<font color="#E5E5E5"> long string right</font><font color="#CCCCCC"> there was</font>

719
00:31:20,919 --> 00:31:25,570
like a very<font color="#E5E5E5"> long</font><font color="#CCCCCC"> reference and</font><font color="#E5E5E5"> it's it's</font>

720
00:31:24,730 --> 00:31:28,330
just<font color="#E5E5E5"> nasty</font>

721
00:31:25,570 --> 00:31:31,629
so we can either<font color="#CCCCCC"> use document body or we</font>

722
00:31:28,330 --> 00:31:33,279
can<font color="#CCCCCC"> use a</font><font color="#E5E5E5"> dig box</font><font color="#CCCCCC"> I mean not a deluxe an</font>

723
00:31:31,629 --> 00:31:36,519
ID like any any element<font color="#E5E5E5"> that is</font>

724
00:31:33,279 --> 00:31:38,200
identified by<font color="#E5E5E5"> an ID or</font><font color="#CCCCCC"> name it can be</font>

725
00:31:36,519 --> 00:31:39,909
referenced<font color="#E5E5E5"> using directly in the dev</font>

726
00:31:38,200 --> 00:31:42,460
console or in using javascript you can

727
00:31:39,909 --> 00:31:45,039
<font color="#E5E5E5">just type in</font><font color="#CCCCCC"> d</font><font color="#E5E5E5"> blocks one and we're it</font>

728
00:31:42,460 --> 00:31:48,279
were right away<font color="#E5E5E5"> reference this day</font><font color="#CCCCCC"> block</font>

729
00:31:45,039 --> 00:31:50,769
so if<font color="#CCCCCC"> there</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> element</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> is closer</font>

730
00:31:48,279 --> 00:31:53,289
to your target<font color="#E5E5E5"> then it will be easier</font>

731
00:31:50,769 --> 00:31:55,389
for<font color="#E5E5E5"> you</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> use that and navigate from</font>

732
00:31:53,289 --> 00:31:57,460
there on and not start from<font color="#E5E5E5"> the entire</font>

733
00:31:55,389 --> 00:32:00,609
like from the starting<font color="#E5E5E5"> of the page from</font>

734
00:31:57,460 --> 00:32:02,200
<font color="#E5E5E5">the body and go down there so then like</font>

735
00:32:00,609 --> 00:32:05,399
<font color="#E5E5E5">I said use navigation properties first</font>

736
00:32:02,200 --> 00:32:07,809
element child<font color="#E5E5E5"> next element child and etc</font>

737
00:32:05,399 --> 00:32:09,279
<font color="#CCCCCC">to reach the target element</font><font color="#E5E5E5"> and then</font>

738
00:32:07,809 --> 00:32:11,799
select the<font color="#CCCCCC"> method that you want to</font>

739
00:32:09,279 --> 00:32:13,359
execute<font color="#E5E5E5"> once again if you don't want</font><font color="#CCCCCC"> to</font>

740
00:32:11,799 --> 00:32:16,210
do this steps you<font color="#E5E5E5"> can just use an alert</font>

741
00:32:13,359 --> 00:32:21,600
to prove your<font color="#CCCCCC"> QC but this is way more</font>

742
00:32:16,210 --> 00:32:24,489
fun and meaningful so I be<font color="#CCCCCC"> able</font><font color="#E5E5E5"> to demo</font>

743
00:32:21,600 --> 00:32:26,918
a playground<font color="#E5E5E5"> that you can practice</font><font color="#CCCCCC"> on</font><font color="#E5E5E5"> I</font>

744
00:32:24,489 --> 00:32:28,029
didn't do like I didn't do it in a demo

745
00:32:26,919 --> 00:32:29,499
version so<font color="#CCCCCC"> you</font><font color="#E5E5E5"> can just click on</font>

746
00:32:28,029 --> 00:32:31,720
<font color="#E5E5E5">everything worse you have to actually</font>

747
00:32:29,499 --> 00:32:33,580
learn<font color="#CCCCCC"> what you're doing here but I'm</font>

748
00:32:31,720 --> 00:32:36,820
going<font color="#CCCCCC"> to show a vehicle</font><font color="#E5E5E5"> in this</font>

749
00:32:33,580 --> 00:32:41,710
<font color="#E5E5E5">conference how and what you do so</font><font color="#CCCCCC"> the</font>

750
00:32:36,820 --> 00:32:44,049
target in<font color="#E5E5E5"> the playground is to trigger</font>

751
00:32:41,710 --> 00:32:46,419
this a trigger click on this red button

752
00:32:44,049 --> 00:32:49,720
<font color="#E5E5E5">without clicking in it on behalf of user</font>

753
00:32:46,419 --> 00:32:51,789
of users so<font color="#E5E5E5"> targeting would work like</font>

754
00:32:49,720 --> 00:32:53,889
this<font color="#CCCCCC"> like I said the steps parts from</font>

755
00:32:51,789 --> 00:32:56,460
targeting<font color="#CCCCCC"> then planning</font><font color="#E5E5E5"> and then execute</font>

756
00:32:53,889 --> 00:32:58,928
so this is the<font color="#E5E5E5"> first step</font><font color="#CCCCCC"> so we can use</font>

757
00:32:56,460 --> 00:33:01,929
<font color="#E5E5E5">like I said</font><font color="#CCCCCC"> document dot body does first</font>

758
00:32:58,929 --> 00:33:03,909
child<font color="#E5E5E5"> to get to the layout but if you if</font>

759
00:33:01,929 --> 00:33:05,919
you<font color="#CCCCCC"> right-click this and</font><font color="#E5E5E5"> chrome and you</font>

760
00:33:03,909 --> 00:33:07,929
inspect<font color="#E5E5E5"> the element you see that there</font>

761
00:33:05,919 --> 00:33:10,119
is hints over here that tells<font color="#CCCCCC"> you every</font>

762
00:33:07,929 --> 00:33:12,159
time you see a hash<font color="#E5E5E5"> string and I mean a</font>

763
00:33:10,119 --> 00:33:14,109
hash character<font color="#E5E5E5"> in a string that means</font>

764
00:33:12,159 --> 00:33:15,460
<font color="#E5E5E5">the valid ID that you can use as long as</font>

765
00:33:14,109 --> 00:33:18,639
it doesn't have like<font color="#E5E5E5"> hyphens or</font>

766
00:33:15,460 --> 00:33:18,909
characters that are<font color="#E5E5E5"> not allowed so you</font>

767
00:33:18,639 --> 00:33:22,689
can

768
00:33:18,909 --> 00:33:25,149
just click on just<font color="#CCCCCC"> create</font><font color="#E5E5E5"> the reference</font>

769
00:33:22,690 --> 00:33:27,639
<font color="#CCCCCC">buy this or you can do just just use the</font>

770
00:33:25,149 --> 00:33:30,369
ID directly without<font color="#E5E5E5"> starting</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> the</font>

771
00:33:27,639 --> 00:33:33,070
body like a<font color="#CCCCCC"> SCP like I showed</font><font color="#E5E5E5"> before</font><font color="#CCCCCC"> so</font>

772
00:33:30,369 --> 00:33:35,199
right here<font color="#E5E5E5"> a main then with reference</font>

773
00:33:33,070 --> 00:33:38,349
that<font color="#E5E5E5"> the main that first element</font><font color="#CCCCCC"> child</font>

774
00:33:35,200 --> 00:33:39,820
would reference<font color="#E5E5E5"> the header and you go</font>

775
00:33:38,349 --> 00:33:41,349
forth and forth and forth until<font color="#E5E5E5"> you</font>

776
00:33:39,820 --> 00:33:43,450
<font color="#E5E5E5">reach out to</font><font color="#CCCCCC"> the button that you</font><font color="#E5E5E5"> want</font>

777
00:33:41,349 --> 00:33:44,799
<font color="#E5E5E5">and these are just alphanumeric</font>

778
00:33:43,450 --> 00:33:46,749
characters<font color="#E5E5E5"> and a dot that's nothing</font>

779
00:33:44,799 --> 00:33:49,090
<font color="#E5E5E5">special right so nothing suspicious no</font>

780
00:33:46,749 --> 00:33:54,849
filters would detect the attack<font color="#E5E5E5"> and one</font>

781
00:33:49,090 --> 00:34:03,009
so ever so see ya so I'm going to<font color="#E5E5E5"> show</font>

782
00:33:54,849 --> 00:34:04,989
<font color="#CCCCCC">you quickly how to do this live okay so</font>

783
00:34:03,009 --> 00:34:10,839
we inspect the<font color="#E5E5E5"> elements that we want</font><font color="#CCCCCC"> to</font>

784
00:34:04,989 --> 00:34:12,609
<font color="#E5E5E5">target to zoom out a little bit</font><font color="#CCCCCC"> so we</font>

785
00:34:10,839 --> 00:34:14,500
inspect the element and we see<font color="#E5E5E5"> okay we</font>

786
00:34:12,609 --> 00:34:18,429
inspected this element and<font color="#E5E5E5"> chrome would</font>

787
00:34:14,500 --> 00:34:23,969
be kind<font color="#E5E5E5"> enough to show</font><font color="#CCCCCC"> us</font><font color="#E5E5E5"> this is the</font>

788
00:34:18,429 --> 00:34:27,159
<font color="#E5E5E5">button and this is the closest</font><font color="#CCCCCC"> name door</font>

789
00:34:23,969 --> 00:34:30,158
yeah identify the<font color="#CCCCCC"> element that is close</font>

790
00:34:27,159 --> 00:34:33,760
by<font color="#E5E5E5"> so if we type in main we will reach</font>

791
00:34:30,159 --> 00:34:34,349
out<font color="#CCCCCC"> to</font><font color="#E5E5E5"> the main element let's see this</font>

792
00:34:33,760 --> 00:34:37,000
here

793
00:34:34,349 --> 00:34:38,529
okay so main element and there's a

794
00:34:37,000 --> 00:34:40,089
there's<font color="#CCCCCC"> a simple</font><font color="#E5E5E5"> trick here every time</font>

795
00:34:38,529 --> 00:34:43,059
<font color="#E5E5E5">you see an open arrow that means</font><font color="#CCCCCC"> this</font>

796
00:34:40,089 --> 00:34:46,659
the the branch for reaching<font color="#E5E5E5"> the button</font>

797
00:34:43,059 --> 00:34:48,549
is<font color="#E5E5E5"> a child of the main div here or any</font>

798
00:34:46,659 --> 00:34:50,829
other<font color="#E5E5E5"> element so what you do is</font><font color="#CCCCCC"> name</font>

799
00:34:48,549 --> 00:34:53,109
that first element child you use the

800
00:34:50,829 --> 00:34:56,319
<font color="#E5E5E5">first woman child property to reach out</font>

801
00:34:53,109 --> 00:34:58,359
<font color="#CCCCCC">to the first child of main</font><font color="#E5E5E5"> and then</font>

802
00:34:56,319 --> 00:35:00,220
<font color="#E5E5E5">close error means that you need to go to</font>

803
00:34:58,359 --> 00:35:02,799
the next and<font color="#CCCCCC"> not go inside</font><font color="#E5E5E5"> the children</font>

804
00:35:00,220 --> 00:35:05,890
of the next element so we<font color="#E5E5E5"> can use next</font>

805
00:35:02,799 --> 00:35:09,460
<font color="#CCCCCC">element</font><font color="#E5E5E5"> sibling to do this so we reach</font>

806
00:35:05,890 --> 00:35:17,009
out<font color="#E5E5E5"> to the content and etc etc etc until</font>

807
00:35:09,460 --> 00:35:19,900
<font color="#E5E5E5">we until we reach like I made it like a</font>

808
00:35:17,010 --> 00:35:23,079
reference here<font color="#CCCCCC"> so basically they're</font>

809
00:35:19,900 --> 00:35:25,539
worth like<font color="#E5E5E5"> children and then and like</font>

810
00:35:23,079 --> 00:35:28,420
siblings<font color="#E5E5E5"> so we go five five siblings</font>

811
00:35:25,539 --> 00:35:30,690
down then another children here with the

812
00:35:28,420 --> 00:35:33,030
open error so we<font color="#CCCCCC"> use next next next</font>

813
00:35:30,690 --> 00:35:34,859
<font color="#E5E5E5">blah blah doesn't really matter if we</font>

814
00:35:33,030 --> 00:35:37,650
type<font color="#E5E5E5"> in enter here we created</font>

815
00:35:34,859 --> 00:35:41,430
<font color="#E5E5E5">alphanumeric reference to this button so</font>

816
00:35:37,650 --> 00:35:42,960
if we add in the<font color="#E5E5E5"> click method I'll add</font>

817
00:35:41,430 --> 00:35:44,399
parentheses<font color="#E5E5E5"> here but in the attack we</font>

818
00:35:42,960 --> 00:35:47,550
wouldn't see parameter parentheses

819
00:35:44,400 --> 00:35:48,180
because there is always they'll add them

820
00:35:47,550 --> 00:35:51,180
for you

821
00:35:48,180 --> 00:35:54,210
but if I do this then you<font color="#E5E5E5"> will see the</font>

822
00:35:51,180 --> 00:35:56,940
same simulation<font color="#CCCCCC"> as if the user</font><font color="#E5E5E5"> if I you</font>

823
00:35:54,210 --> 00:35:59,250
<font color="#CCCCCC">already clicked this button with my</font>

824
00:35:56,940 --> 00:36:04,500
mouse<font color="#E5E5E5"> I can</font><font color="#CCCCCC"> just do it</font><font color="#E5E5E5"> with</font><font color="#CCCCCC"> reference</font>

825
00:35:59,250 --> 00:36:08,119
and and that's it<font color="#E5E5E5"> so this would be</font><font color="#CCCCCC"> our</font>

826
00:36:04,500 --> 00:36:13,140
reference<font color="#E5E5E5"> and this is how to create it</font>

827
00:36:08,119 --> 00:36:14,520
but<font color="#E5E5E5"> I don't</font><font color="#CCCCCC"> want people to work hard</font><font color="#E5E5E5"> so</font>

828
00:36:13,140 --> 00:36:17,759
what I did<font color="#CCCCCC"> is I</font><font color="#E5E5E5"> wrote a Chrome extension</font>

829
00:36:14,520 --> 00:36:22,310
you can<font color="#E5E5E5"> install and that</font><font color="#CCCCCC"> chrome</font>

830
00:36:17,760 --> 00:36:22,310
extension will allow you to<font color="#CCCCCC"> basically</font>

831
00:36:22,400 --> 00:36:27,270
the<font color="#E5E5E5"> Chrome extension will allow you to</font>

832
00:36:24,510 --> 00:36:29,369
<font color="#CCCCCC">basically do whatever I</font><font color="#E5E5E5"> did and more</font>

833
00:36:27,270 --> 00:36:32,609
efficiently<font color="#E5E5E5"> using simply you right-click</font>

834
00:36:29,369 --> 00:36:35,849
<font color="#E5E5E5">anything and you in any website</font><font color="#CCCCCC"> that you</font>

835
00:36:32,609 --> 00:36:37,920
want<font color="#E5E5E5"> once you install it</font><font color="#CCCCCC"> and what it</font>

836
00:36:35,849 --> 00:36:43,260
<font color="#E5E5E5">will do it will</font><font color="#CCCCCC"> allow you to target this</font>

837
00:36:37,920 --> 00:36:47,210
element<font color="#E5E5E5"> and</font><font color="#CCCCCC"> too much</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> a zoom</font><font color="#E5E5E5"> but it</font>

838
00:36:43,260 --> 00:36:50,730
<font color="#CCCCCC">would open a box that lets you copy</font><font color="#E5E5E5"> an</font>

839
00:36:47,210 --> 00:36:52,290
alphanumeric reference to whatever you

840
00:36:50,730 --> 00:36:53,880
want I can<font color="#E5E5E5"> I can trigger whatever is</font>

841
00:36:52,290 --> 00:36:56,190
let's say<font color="#E5E5E5"> if I want to trigger this and</font>

842
00:36:53,880 --> 00:37:00,150
any other<font color="#E5E5E5"> website actually and we'll do</font>

843
00:36:56,190 --> 00:37:03,380
this and we'll give you<font color="#CCCCCC"> the</font><font color="#E5E5E5"> reference so</font>

844
00:37:00,150 --> 00:37:03,380
let's stick with<font color="#CCCCCC"> this one</font>

845
00:37:07,410 --> 00:37:18,149
and also<font color="#CCCCCC"> I'm console.log stuff so we can</font>

846
00:37:14,309 --> 00:37:20,059
<font color="#E5E5E5">use it easier so once again if I add</font><font color="#CCCCCC"> two</font>

847
00:37:18,150 --> 00:37:23,819
click

848
00:37:20,059 --> 00:37:26,819
it will trigger the alert<font color="#E5E5E5"> and hence</font>

849
00:37:23,819 --> 00:37:28,500
<font color="#CCCCCC">we'll click on this button it also tells</font>

850
00:37:26,819 --> 00:37:31,200
you which target URL you're targeting

851
00:37:28,500 --> 00:37:32,579
<font color="#E5E5E5">but it's easier to just copy the</font><font color="#CCCCCC"> URL</font>

852
00:37:31,200 --> 00:37:36,629
from<font color="#E5E5E5"> here but let's say we target this</font>

853
00:37:32,579 --> 00:37:38,460
URL<font color="#E5E5E5"> and</font><font color="#CCCCCC"> that is it so we can use the</font>

854
00:37:36,630 --> 00:37:40,319
tool feel free to use this tool it's

855
00:37:38,460 --> 00:37:44,490
available in<font color="#E5E5E5"> the chrome</font><font color="#CCCCCC"> store it's easy</font>

856
00:37:40,319 --> 00:37:47,130
to<font color="#CCCCCC"> download and and use it as</font><font color="#E5E5E5"> your</font>

857
00:37:44,490 --> 00:37:51,089
you're making same-origin method

858
00:37:47,130 --> 00:37:52,559
execution exploits planning planning<font color="#E5E5E5"> is</font>

859
00:37:51,089 --> 00:37:54,808
really really simple<font color="#E5E5E5"> it's just like I</font>

860
00:37:52,559 --> 00:37:58,289
told<font color="#CCCCCC"> you it's opening</font><font color="#E5E5E5"> another window</font><font color="#CCCCCC"> so</font>

861
00:37:54,809 --> 00:38:00,089
<font color="#E5E5E5">you can get rid of the execution</font><font color="#CCCCCC"> that</font>

862
00:37:58,289 --> 00:38:02,099
happens in the<font color="#E5E5E5"> color picker window or</font>

863
00:38:00,089 --> 00:38:05,069
any other empty document because that's

864
00:38:02,099 --> 00:38:08,700
the nature of<font color="#E5E5E5"> callbacks</font><font color="#CCCCCC"> and we need to</font>

865
00:38:05,069 --> 00:38:10,619
understand what we have<font color="#E5E5E5"> so far so we</font>

866
00:38:08,700 --> 00:38:13,740
have an empty<font color="#E5E5E5"> X if you have our we have</font>

867
00:38:10,619 --> 00:38:15,509
a<font color="#E5E5E5"> arbitrary method execution on an empty</font>

868
00:38:13,740 --> 00:38:17,008
<font color="#CCCCCC">knowledge side</font><font color="#E5E5E5"> um that doesn't</font><font color="#CCCCCC"> do</font>

869
00:38:15,509 --> 00:38:19,319
anything<font color="#E5E5E5"> meaningful like I said doesn't</font>

870
00:38:17,009 --> 00:38:21,660
have any<font color="#CCCCCC"> special buttons that we want we</font>

871
00:38:19,319 --> 00:38:24,420
have<font color="#E5E5E5"> our target URL which is</font><font color="#CCCCCC"> the page</font>

872
00:38:21,660 --> 00:38:27,750
with<font color="#CCCCCC"> a</font><font color="#E5E5E5"> red button</font><font color="#CCCCCC"> and we</font><font color="#E5E5E5"> have a target</font>

873
00:38:24,420 --> 00:38:30,029
<font color="#CCCCCC">reference that concet includes only</font>

874
00:38:27,750 --> 00:38:32,250
<font color="#E5E5E5">alphanumeric characters a dot and it</font>

875
00:38:30,029 --> 00:38:34,380
does this could be<font color="#CCCCCC"> poke could</font><font color="#E5E5E5"> be</font><font color="#CCCCCC"> also</font>

876
00:38:32,250 --> 00:38:36,990
<font color="#CCCCCC">use underscores but at this case we</font>

877
00:38:34,380 --> 00:38:39,650
<font color="#E5E5E5">don't need them even so we have all</font>

878
00:38:36,990 --> 00:38:44,450
these now for<font color="#E5E5E5"> planning we need to</font>

879
00:38:39,650 --> 00:38:47,099
<font color="#E5E5E5">somehow make the context make the</font>

880
00:38:44,450 --> 00:38:49,109
context<font color="#E5E5E5"> the</font><font color="#CCCCCC"> executions to happen on the</font>

881
00:38:47,099 --> 00:38:53,460
context that<font color="#E5E5E5"> is useful for</font><font color="#CCCCCC"> us</font><font color="#E5E5E5"> hence our</font>

882
00:38:49,109 --> 00:38:56,339
target URL which is<font color="#E5E5E5"> here</font><font color="#CCCCCC"> so what we do</font>

883
00:38:53,460 --> 00:38:58,440
is we craft<font color="#E5E5E5"> the page evil.com</font><font color="#CCCCCC"> and open</font>

884
00:38:56,339 --> 00:39:00,390
<font color="#E5E5E5">another pop-up to evil</font><font color="#CCCCCC"> comm that's it</font>

885
00:38:58,440 --> 00:39:02,730
that's<font color="#CCCCCC"> that's</font><font color="#E5E5E5"> the whole point of</font>

886
00:39:00,390 --> 00:39:08,609
planning using<font color="#E5E5E5"> windows are open simply</font>

887
00:39:02,730 --> 00:39:12,599
and what<font color="#E5E5E5"> just happened</font><font color="#CCCCCC"> because we did</font>

888
00:39:08,609 --> 00:39:14,700
<font color="#E5E5E5">that the magic here is that once we open</font>

889
00:39:12,599 --> 00:39:17,759
another<font color="#E5E5E5"> window</font><font color="#CCCCCC"> we have another context</font>

890
00:39:14,700 --> 00:39:19,890
<font color="#E5E5E5">so now we have we have the</font><font color="#CCCCCC"> main window</font>

891
00:39:17,759 --> 00:39:21,720
that we had like evil.com and now

892
00:39:19,890 --> 00:39:25,230
have another<font color="#CCCCCC"> pop</font><font color="#E5E5E5"> up and we can play with</font>

893
00:39:21,720 --> 00:39:28,649
<font color="#CCCCCC">the context so</font><font color="#E5E5E5"> yeah windows can</font>

894
00:39:25,230 --> 00:39:30,059
communicate using<font color="#CCCCCC"> JavaScript even though</font>

895
00:39:28,650 --> 00:39:31,859
the windows are different<font color="#E5E5E5"> so we can</font>

896
00:39:30,059 --> 00:39:33,599
<font color="#E5E5E5">communicate as long as same origin</font>

897
00:39:31,859 --> 00:39:37,288
<font color="#E5E5E5">policy exists what we did is we</font>

898
00:39:33,599 --> 00:39:41,279
unbounded<font color="#E5E5E5"> the we unbounded the execution</font>

899
00:39:37,289 --> 00:39:43,440
from the<font color="#E5E5E5"> empty document and nullified</font>

900
00:39:41,279 --> 00:39:46,589
them and we created the ability<font color="#E5E5E5"> to</font>

901
00:39:43,440 --> 00:39:50,339
execute<font color="#E5E5E5"> on a different window</font><font color="#CCCCCC"> and now we</font>

902
00:39:46,589 --> 00:39:51,900
can use<font color="#E5E5E5"> the opener just</font><font color="#CCCCCC"> at this string</font>

903
00:39:50,339 --> 00:39:53,038
and<font color="#CCCCCC"> although all of</font><font color="#E5E5E5"> a sudden the</font>

904
00:39:51,900 --> 00:39:56,519
execution<font color="#E5E5E5"> will take place</font><font color="#CCCCCC"> on another</font>

905
00:39:53,039 --> 00:40:00,029
<font color="#E5E5E5">window so</font><font color="#CCCCCC"> there is</font><font color="#E5E5E5"> really useful</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> us</font>

906
00:39:56,519 --> 00:40:03,410
<font color="#E5E5E5">and I'll once again show you quickly</font>

907
00:40:00,029 --> 00:40:03,410
<font color="#E5E5E5">what I mean by</font><font color="#CCCCCC"> that</font>

908
00:40:03,859 --> 00:40:08,910
so I built a quick demo this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> a box</font>

909
00:40:06,569 --> 00:40:10,950
that<font color="#E5E5E5"> whatever I</font><font color="#CCCCCC"> type here</font><font color="#E5E5E5"> it just it's</font>

910
00:40:08,910 --> 00:40:14,509
just<font color="#CCCCCC"> evolved</font><font color="#E5E5E5"> okay it's just execute</font><font color="#CCCCCC"> him</font>

911
00:40:10,950 --> 00:40:17,700
here so this<font color="#E5E5E5"> JavaScript tells you that</font>

912
00:40:14,510 --> 00:40:20,160
<font color="#E5E5E5">hello</font><font color="#CCCCCC"> for main was executed main is this</font>

913
00:40:17,700 --> 00:40:24,808
window and once I open<font color="#E5E5E5"> another pop-up</font>

914
00:40:20,160 --> 00:40:27,180
window sorry<font color="#CCCCCC"> okay once I open a pop-up</font>

915
00:40:24,809 --> 00:40:29,160
window actually<font color="#CCCCCC"> executes</font><font color="#E5E5E5"> it says hello</font>

916
00:40:27,180 --> 00:40:31,319
<font color="#CCCCCC">from win one but both of them executed</font>

917
00:40:29,160 --> 00:40:33,118
<font color="#E5E5E5">on</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> same page</font><font color="#CCCCCC"> right</font><font color="#E5E5E5"> this executed on</font>

918
00:40:31,319 --> 00:40:36,180
this on the pop-up<font color="#E5E5E5"> page and that</font>

919
00:40:33,119 --> 00:40:39,390
executed on<font color="#CCCCCC"> the main page</font><font color="#E5E5E5"> however if I</font>

920
00:40:36,180 --> 00:40:41,700
add simply add once again alphanumeric

921
00:40:39,390 --> 00:40:45,029
nothing special no special<font color="#E5E5E5"> characters</font><font color="#CCCCCC"> I</font>

922
00:40:41,700 --> 00:40:47,700
add the opener<font color="#CCCCCC"> context</font><font color="#E5E5E5"> all of a sudden</font>

923
00:40:45,029 --> 00:40:52,619
I'm executing<font color="#CCCCCC"> JavaScript</font><font color="#E5E5E5"> from this</font>

924
00:40:47,700 --> 00:40:54,269
window<font color="#E5E5E5"> but it triggers on this window so</font>

925
00:40:52,619 --> 00:40:57,619
<font color="#E5E5E5">this is really really</font><font color="#CCCCCC"> useful and very</font>

926
00:40:54,269 --> 00:40:59,029
very helpful<font color="#CCCCCC"> for</font><font color="#E5E5E5"> us so this is execution</font>

927
00:40:57,619 --> 00:41:04,680
<font color="#E5E5E5">oops</font>

928
00:40:59,029 --> 00:41:06,809
from<font color="#E5E5E5"> when one to the main window for</font>

929
00:41:04,680 --> 00:41:09,868
example<font color="#CCCCCC"> again once I click execute</font><font color="#E5E5E5"> the</font>

930
00:41:06,809 --> 00:41:12,839
execution will<font color="#CCCCCC"> take</font><font color="#E5E5E5"> place</font><font color="#CCCCCC"> here and guess</font>

931
00:41:09,869 --> 00:41:18,869
what will happen<font color="#CCCCCC"> if I'll do opener dot</font>

932
00:41:12,839 --> 00:41:22,440
alert or any<font color="#E5E5E5"> other method it would</font>

933
00:41:18,869 --> 00:41:24,809
execute<font color="#E5E5E5"> on the main window right even</font>

934
00:41:22,440 --> 00:41:26,849
though it was triggered<font color="#E5E5E5"> from this window</font>

935
00:41:24,809 --> 00:41:33,080
<font color="#E5E5E5">so</font><font color="#CCCCCC"> that is</font><font color="#E5E5E5"> that is a concept</font><font color="#CCCCCC"> work</font><font color="#E5E5E5"> that</font>

936
00:41:26,849 --> 00:41:35,700
we based on<font color="#CCCCCC"> to trigger the attack</font><font color="#E5E5E5"> so</font>

937
00:41:33,080 --> 00:41:37,380
it would look like I said<font color="#CCCCCC"> it would look</font>

938
00:41:35,700 --> 00:41:39,299
<font color="#CCCCCC">like this</font><font color="#E5E5E5"> open-air</font><font color="#CCCCCC"> dock target reference</font>

939
00:41:37,380 --> 00:41:41,010
<font color="#E5E5E5">and</font><font color="#CCCCCC"> we have the target reference</font><font color="#E5E5E5"> of a</font>

940
00:41:39,300 --> 00:41:42,750
button<font color="#CCCCCC"> that we want to</font><font color="#E5E5E5"> click on and</font><font color="#CCCCCC"> it</font>

941
00:41:41,010 --> 00:41:44,760
<font color="#E5E5E5">could be a</font><font color="#CCCCCC"> forum or anything</font><font color="#E5E5E5"> and we</font><font color="#CCCCCC"> have</font>

942
00:41:42,750 --> 00:41:50,970
a target method and which is in our<font color="#E5E5E5"> case</font>

943
00:41:44,760 --> 00:41:54,390
it's a<font color="#CCCCCC"> click well the final</font><font color="#E5E5E5"> step is</font>

944
00:41:50,970 --> 00:41:56,160
<font color="#E5E5E5">putting it all together like</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> I'm</font>

945
00:41:54,390 --> 00:41:58,710
going to show<font color="#E5E5E5"> you how to</font><font color="#CCCCCC"> to play</font><font color="#E5E5E5"> with</font>

946
00:41:56,160 --> 00:42:00,720
the new window and redirections<font color="#CCCCCC"> to make</font>

947
00:41:58,710 --> 00:42:01,920
the execution take place and do actually

948
00:42:00,720 --> 00:42:03,990
something<font color="#E5E5E5"> maybe</font><font color="#CCCCCC"> four on</font><font color="#E5E5E5"> behalf of</font>

949
00:42:01,920 --> 00:42:07,920
<font color="#E5E5E5">victims and how to do it I'm going</font><font color="#CCCCCC"> to</font>

950
00:42:03,990 --> 00:42:10,740
<font color="#E5E5E5">show</font><font color="#CCCCCC"> a demo and I'm going</font><font color="#E5E5E5"> to expose a</font>

951
00:42:07,920 --> 00:42:12,960
<font color="#CCCCCC">POC generator that don't that you don't</font>

952
00:42:10,740 --> 00:42:14,459
<font color="#E5E5E5">have to learn the entire attack and how</font>

953
00:42:12,960 --> 00:42:18,450
to do it<font color="#CCCCCC"> it just</font><font color="#E5E5E5"> like use the generator</font>

954
00:42:14,460 --> 00:42:19,860
and<font color="#E5E5E5"> that's it so once again let's go</font>

955
00:42:18,450 --> 00:42:23,310
over what<font color="#CCCCCC"> we have</font><font color="#E5E5E5"> we</font><font color="#CCCCCC"> have and now we</font>

956
00:42:19,860 --> 00:42:24,960
<font color="#E5E5E5">have a useful</font><font color="#CCCCCC"> method execution because</font>

957
00:42:23,310 --> 00:42:26,640
we can play with<font color="#E5E5E5"> the context of these</font>

958
00:42:24,960 --> 00:42:28,440
windows we can choose where we want<font color="#CCCCCC"> to</font>

959
00:42:26,640 --> 00:42:29,970
<font color="#E5E5E5">execute that and that means we can</font>

960
00:42:28,440 --> 00:42:32,250
execute it<font color="#E5E5E5"> on something that has</font>

961
00:42:29,970 --> 00:42:35,339
meaningful stuff like add me as an admin

962
00:42:32,250 --> 00:42:36,630
or delete orders or whatever like in the

963
00:42:35,340 --> 00:42:38,760
face<font color="#E5E5E5"> or effort depends on the website</font>

964
00:42:36,630 --> 00:42:42,000
<font color="#CCCCCC">but now it's useful because</font><font color="#E5E5E5"> of the</font>

965
00:42:38,760 --> 00:42:43,950
simply open in another window we have a

966
00:42:42,000 --> 00:42:45,840
<font color="#E5E5E5">target URL and</font><font color="#CCCCCC"> Atari reference right we</font>

967
00:42:43,950 --> 00:42:48,000
have box next<font color="#CCCCCC"> home and sibling next so</font>

968
00:42:45,840 --> 00:42:50,430
<font color="#E5E5E5">and sibling notice how that the tool</font>

969
00:42:48,000 --> 00:42:53,670
made a lot shorter because<font color="#CCCCCC"> it's more</font>

970
00:42:50,430 --> 00:42:55,799
efficient<font color="#E5E5E5"> than manually doing it unless</font>

971
00:42:53,670 --> 00:42:58,410
you<font color="#E5E5E5"> are like I want to spend more time</font>

972
00:42:55,800 --> 00:43:00,780
<font color="#E5E5E5">on shortening but we have the target</font>

973
00:42:58,410 --> 00:43:05,850
<font color="#CCCCCC">reference we have</font><font color="#E5E5E5"> the target URL we have</font>

974
00:43:00,780 --> 00:43:09,420
a new window we have one more<font color="#E5E5E5"> challenge</font>

975
00:43:05,850 --> 00:43:11,670
to solve right because since we have a

976
00:43:09,420 --> 00:43:14,160
in browsers we have same origin policy

977
00:43:11,670 --> 00:43:17,070
<font color="#CCCCCC">we make we want</font><font color="#E5E5E5"> to make sure that the</font>

978
00:43:14,160 --> 00:43:19,319
<font color="#E5E5E5">target URL must be rendered</font><font color="#CCCCCC"> in the</font>

979
00:43:17,070 --> 00:43:22,190
<font color="#CCCCCC">open-air</font><font color="#E5E5E5"> context before the execution</font>

980
00:43:19,320 --> 00:43:24,360
<font color="#E5E5E5">takes place so I told</font><font color="#CCCCCC"> you like once you</font>

981
00:43:22,190 --> 00:43:26,850
redirect<font color="#E5E5E5"> to the</font><font color="#CCCCCC"> callback endpoint it</font>

982
00:43:24,360 --> 00:43:28,410
executes<font color="#CCCCCC"> the callback</font><font color="#E5E5E5"> so that's not good</font>

983
00:43:26,850 --> 00:43:30,930
<font color="#CCCCCC">for us</font><font color="#E5E5E5"> we want to make</font><font color="#CCCCCC"> sure that it</font>

984
00:43:28,410 --> 00:43:32,850
executes a callback<font color="#E5E5E5"> on the open air</font>

985
00:43:30,930 --> 00:43:36,750
window<font color="#E5E5E5"> on the target</font><font color="#CCCCCC"> URL but we want to</font>

986
00:43:32,850 --> 00:43:39,630
<font color="#E5E5E5">make</font><font color="#CCCCCC"> sure the target</font><font color="#E5E5E5"> URL is like the</font>

987
00:43:36,750 --> 00:43:43,620
rendering<font color="#E5E5E5"> of it completed and the</font><font color="#CCCCCC"> DOM is</font>

988
00:43:39,630 --> 00:43:45,809
<font color="#E5E5E5">ready for execution so we do that by</font>

989
00:43:43,620 --> 00:43:47,098
redirecting<font color="#CCCCCC"> like like a</font>

990
00:43:45,809 --> 00:43:48,959
that we have the main<font color="#CCCCCC"> window we have the</font>

991
00:43:47,099 --> 00:43:50,969
pop-up window<font color="#CCCCCC"> what we do first</font><font color="#E5E5E5"> is</font>

992
00:43:48,959 --> 00:43:54,259
redirect the main window to the target

993
00:43:50,969 --> 00:43:56,910
<font color="#CCCCCC">URL the page with the</font><font color="#E5E5E5"> red button and and</font>

994
00:43:54,259 --> 00:43:58,619
then<font color="#E5E5E5"> after only after</font><font color="#CCCCCC"> timeouts we</font>

995
00:43:56,910 --> 00:44:00,328
<font color="#CCCCCC">redirect this pop-up</font><font color="#E5E5E5"> because both</font><font color="#CCCCCC"> of the</font>

996
00:43:58,619 --> 00:44:02,369
<font color="#E5E5E5">pages at the starting point both of</font><font color="#CCCCCC"> the</font>

997
00:44:00,329 --> 00:44:04,109
pages in our control<font color="#CCCCCC"> like evil calm</font><font color="#E5E5E5"> and</font>

998
00:44:02,369 --> 00:44:06,479
evil calm<font color="#E5E5E5"> so we can control</font><font color="#CCCCCC"> the</font>

999
00:44:04,109 --> 00:44:08,489
JavaScript so what we do is we use

1000
00:44:06,479 --> 00:44:11,339
location or<font color="#CCCCCC"> whatever method that we</font><font color="#E5E5E5"> want</font>

1001
00:44:08,489 --> 00:44:15,660
we redirect the page the main page<font color="#CCCCCC"> to</font>

1002
00:44:11,339 --> 00:44:17,609
the the target<font color="#CCCCCC"> URL the the page with the</font>

1003
00:44:15,660 --> 00:44:19,140
<font color="#E5E5E5">red button in our example we redirect</font>

1004
00:44:17,609 --> 00:44:21,989
the pop-up<font color="#CCCCCC"> to the callback</font><font color="#E5E5E5"> to the</font>

1005
00:44:19,140 --> 00:44:25,499
<font color="#E5E5E5">vulnerable instance with the callback</font>

1006
00:44:21,989 --> 00:44:29,670
parameter set to this string<font color="#E5E5E5"> over there</font>

1007
00:44:25,499 --> 00:44:33,930
and<font color="#E5E5E5"> therefore the pop-up</font><font color="#CCCCCC"> will execute a</font>

1008
00:44:29,670 --> 00:44:36,359
click over the main window without<font color="#E5E5E5"> the</font>

1009
00:44:33,930 --> 00:44:39,328
users knowledge and therefore<font color="#CCCCCC"> we hijack</font>

1010
00:44:36,359 --> 00:44:40,650
the operation so we make them do stop<font color="#CCCCCC"> it</font>

1011
00:44:39,329 --> 00:44:47,400
with<font color="#CCCCCC"> that they</font><font color="#E5E5E5"> don't want to necessarily</font>

1012
00:44:40,650 --> 00:44:50,009
do<font color="#E5E5E5"> so</font><font color="#CCCCCC"> this relies on the the fact that</font>

1013
00:44:47,400 --> 00:44:53,819
<font color="#E5E5E5">in browsers once you redirect a lot of a</font>

1014
00:44:50,009 --> 00:44:56,130
lot<font color="#E5E5E5"> of them properties are</font><font color="#CCCCCC"> being deleted</font>

1015
00:44:53,819 --> 00:44:58,410
or overwritten<font color="#CCCCCC"> in the document like</font>

1016
00:44:56,130 --> 00:45:00,179
document location and all that stuff

1017
00:44:58,410 --> 00:45:01,890
cookie<font color="#E5E5E5"> and all that but</font><font color="#CCCCCC"> the open</font><font color="#E5E5E5"> a</font>

1018
00:45:00,179 --> 00:45:04,650
reference stays in memory<font color="#CCCCCC"> even though</font>

1019
00:45:01,890 --> 00:45:07,529
<font color="#CCCCCC">you redirect pages to whatever domain</font>

1020
00:45:04,650 --> 00:45:09,599
<font color="#E5E5E5">like</font><font color="#CCCCCC"> Google</font><font color="#E5E5E5"> says whatever you want the</font>

1021
00:45:07,529 --> 00:45:11,849
opener stays<font color="#E5E5E5"> so this window a let's</font>

1022
00:45:09,599 --> 00:45:15,809
click they explicitly<font color="#CCCCCC"> delete</font><font color="#E5E5E5"> it the the</font>

1023
00:45:11,849 --> 00:45:17,309
<font color="#CCCCCC">openers</font><font color="#E5E5E5"> space and therefore you can you</font>

1024
00:45:15,809 --> 00:45:19,380
can reference the main window or or

1025
00:45:17,309 --> 00:45:20,969
whatever<font color="#E5E5E5"> you want using</font><font color="#CCCCCC"> the open</font>

1026
00:45:19,380 --> 00:45:24,859
reference<font color="#E5E5E5"> even though you were directed</font>

1027
00:45:20,969 --> 00:45:28,289
so let's see<font color="#CCCCCC"> a simulation</font><font color="#E5E5E5"> or actually</font>

1028
00:45:24,859 --> 00:45:30,269
<font color="#CCCCCC">where's</font><font color="#E5E5E5"> my mouse</font><font color="#CCCCCC"> ok so let's see what</font>

1029
00:45:28,289 --> 00:45:32,670
I'm talking about<font color="#CCCCCC"> I</font><font color="#E5E5E5"> mean this is an</font>

1030
00:45:30,269 --> 00:45:36,019
exploit<font color="#E5E5E5"> of putting it all together with</font>

1031
00:45:32,670 --> 00:45:40,079
<font color="#E5E5E5">the red button let's say I am</font><font color="#CCCCCC"> tracking</font>

1032
00:45:36,019 --> 00:45:42,629
my victim<font color="#E5E5E5"> and I'm sending this link</font><font color="#CCCCCC"> ok</font>

1033
00:45:40,079 --> 00:45:44,489
this would be served in any<font color="#CCCCCC"> website but</font>

1034
00:45:42,630 --> 00:45:47,189
<font color="#CCCCCC">for the demo it's</font><font color="#E5E5E5"> in my computer</font><font color="#CCCCCC"> right</font>

1035
00:45:44,489 --> 00:45:48,689
<font color="#CCCCCC">now it's simply as an HTML page</font><font color="#E5E5E5"> and once</font>

1036
00:45:47,189 --> 00:45:52,428
we convince the user to<font color="#E5E5E5"> click on this</font>

1037
00:45:48,689 --> 00:45:55,078
link it<font color="#CCCCCC"> would open another window and</font>

1038
00:45:52,429 --> 00:45:57,630
that's it it will click on behalf of him

1039
00:45:55,079 --> 00:45:59,069
<font color="#E5E5E5">over this button using redirections</font>

1040
00:45:57,630 --> 00:46:00,869
<font color="#E5E5E5">pop-ups</font><font color="#CCCCCC"> and whatnot</font>

1041
00:45:59,069 --> 00:46:03,390
so as you notice that the page<font color="#CCCCCC"> was</font>

1042
00:46:00,869 --> 00:46:05,279
redirected<font color="#CCCCCC"> if you could see it it</font>

1043
00:46:03,390 --> 00:46:07,618
started<font color="#E5E5E5"> with a link and redirected to</font>

1044
00:46:05,279 --> 00:46:10,079
this page which we have the target

1045
00:46:07,619 --> 00:46:13,799
<font color="#E5E5E5">button and this window over</font><font color="#CCCCCC"> here we</font>

1046
00:46:10,079 --> 00:46:17,069
directed to<font color="#E5E5E5"> I took the vulnerable</font>

1047
00:46:13,799 --> 00:46:19,829
instance with a callback set<font color="#E5E5E5"> to</font><font color="#CCCCCC"> so if I</font>

1048
00:46:17,069 --> 00:46:21,930
can zoom<font color="#CCCCCC"> in box at</font><font color="#E5E5E5"> the elements the</font>

1049
00:46:19,829 --> 00:46:25,019
reference to the button on the main on

1050
00:46:21,930 --> 00:46:26,279
the<font color="#E5E5E5"> open-air window and click and the</font>

1051
00:46:25,019 --> 00:46:28,529
reason you don't<font color="#E5E5E5"> see an opener here</font>

1052
00:46:26,279 --> 00:46:32,069
because<font color="#E5E5E5"> the this end</font><font color="#CCCCCC"> point specifically</font>

1053
00:46:28,529 --> 00:46:35,599
already<font color="#CCCCCC"> add and open a reference but</font>

1054
00:46:32,069 --> 00:46:42,089
this can vary<font color="#CCCCCC"> between vulnerable</font>

1055
00:46:35,599 --> 00:46:44,699
endpoints<font color="#CCCCCC"> that you find let's see this</font>

1056
00:46:42,089 --> 00:46:48,569
again<font color="#CCCCCC"> ok so we click here on like the</font>

1057
00:46:44,699 --> 00:46:50,279
<font color="#CCCCCC">victim clicks on that and then execution</font>

1058
00:46:48,569 --> 00:46:53,009
takes place on behalf of him so<font color="#E5E5E5"> we could</font>

1059
00:46:50,279 --> 00:46:59,969
do<font color="#CCCCCC"> anything on behalf of</font><font color="#E5E5E5"> a user</font><font color="#CCCCCC"> once you</font>

1060
00:46:53,009 --> 00:47:03,449
have this<font color="#E5E5E5"> I mean almost everything</font><font color="#CCCCCC"> ok so</font>

1061
00:46:59,969 --> 00:47:07,759
I wanted to once again simplify stuff

1062
00:47:03,449 --> 00:47:07,759
and I wanted for<font color="#E5E5E5"> this talk I wanted to</font>

1063
00:47:07,789 --> 00:47:14,729
give<font color="#E5E5E5"> you the ability of not working so</font>

1064
00:47:11,099 --> 00:47:16,619
hard<font color="#E5E5E5"> not</font><font color="#CCCCCC"> worried</font><font color="#E5E5E5"> about opening another</font>

1065
00:47:14,729 --> 00:47:18,718
window redirecting making sure the

1066
00:47:16,619 --> 00:47:21,269
timing<font color="#E5E5E5"> is right and everything</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> what I</font>

1067
00:47:18,719 --> 00:47:23,609
did<font color="#E5E5E5"> is I built a generator that</font>

1068
00:47:21,269 --> 00:47:24,839
basically if you<font color="#E5E5E5"> want</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> if you</font><font color="#CCCCCC"> want</font><font color="#E5E5E5"> to</font>

1069
00:47:23,609 --> 00:47:27,390
create the attack if you<font color="#E5E5E5"> want to create</font>

1070
00:47:24,839 --> 00:47:30,119
<font color="#E5E5E5">a PLC you can use the generator to</font>

1071
00:47:27,390 --> 00:47:33,449
exploit this this is a basic generator

1072
00:47:30,119 --> 00:47:36,119
so<font color="#E5E5E5"> people</font><font color="#CCCCCC"> already</font><font color="#E5E5E5"> exploit it's a</font><font color="#CCCCCC"> bit a</font>

1073
00:47:33,449 --> 00:47:38,940
lot more advanced stuff<font color="#E5E5E5"> like using like</font>

1074
00:47:36,119 --> 00:47:41,009
<font color="#CCCCCC">a hijacking multiple clicks or multiple</font>

1075
00:47:38,940 --> 00:47:44,400
actions<font color="#E5E5E5"> multiple JavaScript</font><font color="#CCCCCC"> function</font>

1076
00:47:41,009 --> 00:47:48,660
<font color="#E5E5E5">options well my first</font><font color="#CCCCCC"> DLC had</font><font color="#E5E5E5"> two or two</font>

1077
00:47:44,400 --> 00:47:51,269
actions that made me<font color="#CCCCCC"> steal private</font>

1078
00:47:48,660 --> 00:47:53,399
photos from<font color="#CCCCCC"> Google+ instances but the</font>

1079
00:47:51,269 --> 00:47:55,589
<font color="#E5E5E5">Google fixed it very well and now it's</font>

1080
00:47:53,400 --> 00:47:57,029
<font color="#CCCCCC">six so don't try</font><font color="#E5E5E5"> to attack anyone I'm</font>

1081
00:47:55,589 --> 00:48:00,089
not<font color="#E5E5E5"> this is</font><font color="#CCCCCC"> not</font><font color="#E5E5E5"> a purpose of the</font>

1082
00:47:57,029 --> 00:48:01,829
presentation<font color="#CCCCCC"> but the basic thing</font><font color="#E5E5E5"> is the</font>

1083
00:48:00,089 --> 00:48:05,239
basic exploit generator works like this

1084
00:48:01,829 --> 00:48:11,950
<font color="#CCCCCC">let's see it live I hope you</font><font color="#E5E5E5"> can see it</font>

1085
00:48:05,239 --> 00:48:14,829
what I'm doing so we want to work on a

1086
00:48:11,950 --> 00:48:19,558
on my playground so we don't have

1087
00:48:14,829 --> 00:48:21,910
anything problematic<font color="#CCCCCC"> here</font><font color="#E5E5E5"> so once I</font>

1088
00:48:19,559 --> 00:48:24,609
detected the arbitrary method execution

1089
00:48:21,910 --> 00:48:28,118
right here<font color="#CCCCCC"> I know there is a</font><font color="#E5E5E5"> sum here</font>

1090
00:48:24,609 --> 00:48:30,730
<font color="#E5E5E5">okay and you have</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> ability to check</font>

1091
00:48:28,119 --> 00:48:33,520
for some<font color="#CCCCCC"> yourself but once you once</font><font color="#E5E5E5"> you</font>

1092
00:48:30,730 --> 00:48:35,559
know<font color="#E5E5E5"> this you</font><font color="#CCCCCC"> can this is the vulnerable</font>

1093
00:48:33,520 --> 00:48:39,400
instance<font color="#CCCCCC"> you can copy this to the</font>

1094
00:48:35,559 --> 00:48:41,319
generator we don't need<font color="#E5E5E5"> a callback</font>

1095
00:48:39,400 --> 00:48:43,440
<font color="#CCCCCC">parameter you can</font><font color="#E5E5E5"> put whatever you</font><font color="#CCCCCC"> want</font>

1096
00:48:41,319 --> 00:48:45,819
<font color="#E5E5E5">here so this is the vulnerable instance</font>

1097
00:48:43,440 --> 00:48:49,930
callback parameter is called<font color="#E5E5E5"> callback in</font>

1098
00:48:45,819 --> 00:48:52,779
our case<font color="#E5E5E5"> right</font><font color="#CCCCCC"> now the target endpoint</font>

1099
00:48:49,930 --> 00:48:54,279
<font color="#E5E5E5">what we want to target this case we want</font>

1100
00:48:52,780 --> 00:48:56,950
<font color="#E5E5E5">to target this red button</font><font color="#CCCCCC"> but this could</font>

1101
00:48:54,280 --> 00:49:03,309
be anything<font color="#CCCCCC"> so the target endpoint is</font>

1102
00:48:56,950 --> 00:49:04,720
playground index.php<font color="#CCCCCC"> and here is the</font>

1103
00:49:03,309 --> 00:49:06,549
target<font color="#E5E5E5"> reference that I talked about the</font>

1104
00:49:04,720 --> 00:49:08,770
<font color="#CCCCCC">alphanumeric target</font><font color="#E5E5E5"> reference with first</font>

1105
00:49:06,549 --> 00:49:11,140
<font color="#CCCCCC">demand</font><font color="#E5E5E5"> child and all that</font><font color="#CCCCCC"> if once again</font>

1106
00:49:08,770 --> 00:49:12,730
<font color="#E5E5E5">we you don't care about creating a</font>

1107
00:49:11,140 --> 00:49:15,069
reference<font color="#CCCCCC"> you just want to</font><font color="#E5E5E5"> send a</font><font color="#CCCCCC"> PLC</font>

1108
00:49:12,730 --> 00:49:17,650
<font color="#E5E5E5">there's</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> possible</font><font color="#CCCCCC"> checkbox over here</font>

1109
00:49:15,069 --> 00:49:23,160
that<font color="#E5E5E5"> you click</font><font color="#CCCCCC"> here and it just set</font>

1110
00:49:17,650 --> 00:49:25,540
<font color="#CCCCCC">similar</font><font color="#E5E5E5"> TOC but let's do the fun way and</font>

1111
00:49:23,160 --> 00:49:27,910
<font color="#E5E5E5">trigger click on this button let's do</font>

1112
00:49:25,540 --> 00:49:35,230
this using<font color="#E5E5E5"> the tool let's target this</font>

1113
00:49:27,910 --> 00:49:37,839
element<font color="#E5E5E5"> copy</font><font color="#CCCCCC"> and it created</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> reference</font>

1114
00:49:35,230 --> 00:49:40,049
to the button<font color="#E5E5E5"> that we wanted at the</font>

1115
00:49:37,839 --> 00:49:43,480
method that<font color="#E5E5E5"> we want this case</font><font color="#CCCCCC"> a click</font>

1116
00:49:40,049 --> 00:49:46,390
this is tell you<font color="#E5E5E5"> this tells you it gives</font>

1117
00:49:43,480 --> 00:49:48,220
you<font color="#E5E5E5"> the ability to set how many seconds</font>

1118
00:49:46,390 --> 00:49:50,770
you<font color="#CCCCCC"> want to wait before the rendering</font><font color="#E5E5E5"> of</font>

1119
00:49:48,220 --> 00:49:53,259
<font color="#CCCCCC">the target URL happens and this can</font><font color="#E5E5E5"> take</font>

1120
00:49:50,770 --> 00:49:54,910
longer<font color="#E5E5E5"> but three seconds is ideal if you</font>

1121
00:49:53,260 --> 00:49:57,819
<font color="#E5E5E5">have</font><font color="#CCCCCC"> a distance if the victim has a</font>

1122
00:49:54,910 --> 00:50:00,009
different connection then<font color="#E5E5E5"> three seconds</font>

1123
00:49:57,819 --> 00:50:02,799
seconds<font color="#E5E5E5"> is enough and then you could</font>

1124
00:50:00,010 --> 00:50:06,280
generate<font color="#E5E5E5"> so once you click generate I</font>

1125
00:50:02,799 --> 00:50:07,930
made up I mean<font color="#E5E5E5"> that the HTML page</font><font color="#CCCCCC"> that</font>

1126
00:50:06,280 --> 00:50:11,290
does everything<font color="#E5E5E5"> for you it does the</font>

1127
00:50:07,930 --> 00:50:14,230
redirection<font color="#CCCCCC"> waits it creates all the the</font>

1128
00:50:11,290 --> 00:50:15,940
<font color="#E5E5E5">things that you want the things</font><font color="#CCCCCC"> you want</font>

1129
00:50:14,230 --> 00:50:18,010
to<font color="#E5E5E5"> happen the pop-up window everything</font>

1130
00:50:15,940 --> 00:50:20,410
<font color="#E5E5E5">and now we have the</font><font color="#CCCCCC"> option either to</font>

1131
00:50:18,010 --> 00:50:23,589
launch a<font color="#E5E5E5"> test so you</font><font color="#CCCCCC"> can make sure you</font>

1132
00:50:20,410 --> 00:50:24,890
did<font color="#E5E5E5"> it</font><font color="#CCCCCC"> right</font><font color="#E5E5E5"> or to download</font><font color="#CCCCCC"> it and send</font>

1133
00:50:23,589 --> 00:50:29,570
it<font color="#CCCCCC"> to your customer</font>

1134
00:50:24,890 --> 00:50:34,430
or<font color="#E5E5E5"> your bug bounty program that you are</font>

1135
00:50:29,570 --> 00:50:36,050
triggering<font color="#E5E5E5"> if that's the point so let's</font>

1136
00:50:34,430 --> 00:50:38,000
see if it works<font color="#CCCCCC"> I mean the</font><font color="#E5E5E5"> generator</font>

1137
00:50:36,050 --> 00:50:41,150
like I just<font color="#E5E5E5"> what I</font><font color="#CCCCCC"> did is I just paste</font>

1138
00:50:38,000 --> 00:50:43,850
<font color="#CCCCCC">it in stuff in for input boxes I didn't</font>

1139
00:50:41,150 --> 00:50:46,640
even touch this and click generate<font color="#CCCCCC"> now</font><font color="#E5E5E5"> I</font>

1140
00:50:43,850 --> 00:50:48,890
have an exploit to send to the victim or

1141
00:50:46,640 --> 00:50:52,299
hopefully<font color="#CCCCCC"> your responsibly disclosing</font>

1142
00:50:48,890 --> 00:50:54,799
stuff so you send it to the<font color="#E5E5E5"> company so</font>

1143
00:50:52,300 --> 00:50:57,380
what would happen<font color="#E5E5E5"> here is automatically</font>

1144
00:50:54,800 --> 00:51:01,340
when I click the as the victim when I

1145
00:50:57,380 --> 00:51:04,640
click the the click to exploit link<font color="#E5E5E5"> then</font>

1146
00:51:01,340 --> 00:51:07,220
the the entire exploit took place we

1147
00:51:04,640 --> 00:51:09,170
hijack the click on<font color="#E5E5E5"> the red button once</font>

1148
00:51:07,220 --> 00:51:12,560
<font color="#E5E5E5">again the red button could be at myself</font>

1149
00:51:09,170 --> 00:51:16,850
as an admin or anything<font color="#E5E5E5"> other than other</font>

1150
00:51:12,560 --> 00:51:25,070
than<font color="#E5E5E5"> that is dangerous</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> could do</font><font color="#CCCCCC"> ok</font>

1151
00:51:16,850 --> 00:51:27,529
so so that was the generator you<font color="#CCCCCC"> can you</font>

1152
00:51:25,070 --> 00:51:29,480
can feel free to<font color="#CCCCCC"> use it</font><font color="#E5E5E5"> domain</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> Sam</font>

1153
00:51:27,530 --> 00:51:32,240
<font color="#E5E5E5">attack</font><font color="#CCCCCC"> calm you can use it and you can</font>

1154
00:51:29,480 --> 00:51:35,540
<font color="#CCCCCC">practice on the attack and</font><font color="#E5E5E5"> try it in</font>

1155
00:51:32,240 --> 00:51:38,029
practice and see if you've mastered the

1156
00:51:35,540 --> 00:51:43,190
skills of doing this and you can hijack

1157
00:51:38,030 --> 00:51:47,480
more than one<font color="#E5E5E5"> operation like I said</font><font color="#CCCCCC"> ok</font>

1158
00:51:43,190 --> 00:51:49,700
<font color="#E5E5E5">so time ticks so</font><font color="#CCCCCC"> I'm going</font><font color="#E5E5E5"> to be able to</font>

1159
00:51:47,480 --> 00:51:51,740
show you the<font color="#E5E5E5"> advanced the more advanced</font>

1160
00:51:49,700 --> 00:51:53,839
aspects but I'll make sure<font color="#E5E5E5"> to post them</font>

1161
00:51:51,740 --> 00:51:57,169
on<font color="#E5E5E5"> the website</font>

1162
00:51:53,840 --> 00:52:01,300
<font color="#CCCCCC">there was</font><font color="#E5E5E5"> a related work that Matthias</font>

1163
00:51:57,170 --> 00:52:07,010
<font color="#E5E5E5">Carlson did and he did an amazing POC in</font>

1164
00:52:01,300 --> 00:52:09,560
WordPress he made he made<font color="#E5E5E5"> a POC</font><font color="#CCCCCC"> that</font>

1165
00:52:07,010 --> 00:52:12,110
<font color="#E5E5E5">adds yourself as an admin by sending a</font>

1166
00:52:09,560 --> 00:52:14,990
cease arrest<font color="#E5E5E5"> to a sister protected form</font>

1167
00:52:12,110 --> 00:52:17,650
of adding an admin<font color="#E5E5E5"> and the CSR</font><font color="#CCCCCC"> fails</font>

1168
00:52:14,990 --> 00:52:21,859
however it sets data in the<font color="#CCCCCC"> fields and</font>

1169
00:52:17,650 --> 00:52:24,140
and this data<font color="#E5E5E5"> can be later on combined</font>

1170
00:52:21,860 --> 00:52:26,180
<font color="#E5E5E5">with some</font><font color="#CCCCCC"> - click on the submit form so</font>

1171
00:52:24,140 --> 00:52:28,879
you<font color="#E5E5E5"> can set</font><font color="#CCCCCC"> that I using a CSS</font><font color="#E5E5E5"> or F and</font>

1172
00:52:26,180 --> 00:52:30,980
then and then use some<font color="#CCCCCC"> to actually</font>

1173
00:52:28,880 --> 00:52:32,750
bypass it because<font color="#CCCCCC"> sea-surface now</font><font color="#E5E5E5"> like</font>

1174
00:52:30,980 --> 00:52:34,730
<font color="#CCCCCC">sister</font><font color="#E5E5E5"> of tokens does not protect</font>

1175
00:52:32,750 --> 00:52:36,730
against Sam so I don't know any

1176
00:52:34,730 --> 00:52:38,710
protection to get some and

1177
00:52:36,730 --> 00:52:42,220
but the ones<font color="#E5E5E5"> that I'm going</font><font color="#CCCCCC"> to show in a</font>

1178
00:52:38,710 --> 00:52:44,109
bit<font color="#CCCCCC"> exercise using</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> some technique is</font>

1179
00:52:42,220 --> 00:52:45,669
something<font color="#CCCCCC"> I'll post in the</font><font color="#E5E5E5"> website it</font>

1180
00:52:44,109 --> 00:52:47,380
basically when you have<font color="#CCCCCC"> to control</font><font color="#E5E5E5"> over</font>

1181
00:52:45,670 --> 00:52:49,839
a<font color="#CCCCCC"> limited control of the argument rather</font>

1182
00:52:47,380 --> 00:52:51,880
<font color="#E5E5E5">than the callback parameter you can use</font>

1183
00:52:49,839 --> 00:52:55,150
the<font color="#CCCCCC"> SEMATECH</font><font color="#E5E5E5"> to set</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> to keep the</font>

1184
00:52:51,880 --> 00:52:57,599
<font color="#CCCCCC">open air reference or</font><font color="#E5E5E5"> won't be now</font><font color="#CCCCCC"> and a</font>

1185
00:52:55,150 --> 00:52:57,599
lot<font color="#CCCCCC"> of cool stuff</font>

1186
00:52:58,769 --> 00:53:07,029
let's okay so let's talk<font color="#CCCCCC"> about how</font><font color="#E5E5E5"> to</font>

1187
00:53:03,760 --> 00:53:10,000
protect the one the number one

1188
00:53:07,029 --> 00:53:12,819
protection<font color="#E5E5E5"> here is basically using</font>

1189
00:53:10,000 --> 00:53:14,619
static callbacks<font color="#E5E5E5"> like don't let people</font>

1190
00:53:12,819 --> 00:53:16,269
<font color="#E5E5E5">control the callback parameter</font>

1191
00:53:14,619 --> 00:53:18,549
don't let them don't don't give<font color="#CCCCCC"> away a</font>

1192
00:53:16,269 --> 00:53:20,200
parameter<font color="#CCCCCC"> for this many times people</font>

1193
00:53:18,549 --> 00:53:23,319
<font color="#E5E5E5">implement the dedicated callback</font>

1194
00:53:20,200 --> 00:53:25,629
endpoints and they don't they don't make

1195
00:53:23,319 --> 00:53:27,220
a static<font color="#CCCCCC"> um callback so they let you</font>

1196
00:53:25,630 --> 00:53:29,410
<font color="#E5E5E5">control</font><font color="#CCCCCC"> a but they don't</font><font color="#E5E5E5"> need to let you</font>

1197
00:53:27,220 --> 00:53:32,019
<font color="#E5E5E5">dis control they</font><font color="#CCCCCC"> just follow some tor</font>

1198
00:53:29,410 --> 00:53:33,970
<font color="#CCCCCC">toriel and that's it so that will be the</font>

1199
00:53:32,019 --> 00:53:37,569
<font color="#E5E5E5">best protection another protection</font><font color="#CCCCCC"> will</font>

1200
00:53:33,970 --> 00:53:38,649
be<font color="#E5E5E5"> if you can do the first one you you</font>

1201
00:53:37,569 --> 00:53:40,839
may create a whitelist

1202
00:53:38,650 --> 00:53:42,880
<font color="#E5E5E5">so you can either accept two or three</font>

1203
00:53:40,839 --> 00:53:45,339
callbacks<font color="#E5E5E5"> static values and if the</font>

1204
00:53:42,880 --> 00:53:47,619
server sees the callback is something

1205
00:53:45,339 --> 00:53:49,990
like<font color="#E5E5E5"> first</font><font color="#CCCCCC"> column and</font><font color="#E5E5E5"> child and I mean</font>

1206
00:53:47,619 --> 00:53:54,339
whatever<font color="#E5E5E5"> that does not match the white</font>

1207
00:53:49,990 --> 00:53:56,470
place then block<font color="#CCCCCC"> it or you can set up an</font>

1208
00:53:54,339 --> 00:53:59,619
<font color="#E5E5E5">html5 messaging challenge to interact</font>

1209
00:53:56,470 --> 00:54:01,240
with<font color="#CCCCCC"> Windows</font><font color="#E5E5E5"> but if you choose this the</font>

1210
00:53:59,619 --> 00:54:03,329
third option<font color="#CCCCCC"> you've got to make sure</font>

1211
00:54:01,240 --> 00:54:07,180
<font color="#CCCCCC">because there's a lot</font><font color="#E5E5E5"> of vulnerabilities</font>

1212
00:54:03,329 --> 00:54:08,950
<font color="#E5E5E5">that you if the channel that you set up</font>

1213
00:54:07,180 --> 00:54:11,259
<font color="#E5E5E5">is not secure then you</font><font color="#CCCCCC"> can abuse</font><font color="#E5E5E5"> this</font>

1214
00:54:08,950 --> 00:54:16,058
attack which<font color="#CCCCCC"> courts are scripting in</font>

1215
00:54:11,259 --> 00:54:18,819
some cases and<font color="#E5E5E5"> in</font><font color="#CCCCCC"> etc so these would be</font>

1216
00:54:16,059 --> 00:54:21,069
<font color="#E5E5E5">the way to deal</font><font color="#CCCCCC"> with this I really are</font>

1217
00:54:18,819 --> 00:54:22,900
really<font color="#E5E5E5"> advise using the first one</font><font color="#CCCCCC"> just</font>

1218
00:54:21,069 --> 00:54:25,630
<font color="#CCCCCC">remove the callback parameter set it in</font>

1219
00:54:22,900 --> 00:54:29,769
the server side<font color="#E5E5E5"> and that's pretty</font><font color="#CCCCCC"> much</font>

1220
00:54:25,630 --> 00:54:34,269
<font color="#E5E5E5">it and or the white listing is quite</font>

1221
00:54:29,769 --> 00:54:36,279
good as<font color="#CCCCCC"> well</font><font color="#E5E5E5"> okay</font><font color="#CCCCCC"> so thank</font><font color="#E5E5E5"> you very much</font>

1222
00:54:34,269 --> 00:54:39,399
for<font color="#E5E5E5"> being here and</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> listening to this</font>

1223
00:54:36,279 --> 00:54:41,289
talk<font color="#E5E5E5"> and this is</font><font color="#CCCCCC"> the time like if you</font>

1224
00:54:39,400 --> 00:54:42,670
have any questions feel free to<font color="#E5E5E5"> ask me</font>

1225
00:54:41,289 --> 00:54:44,049
if you<font color="#E5E5E5"> have like if you want to use the</font>

1226
00:54:42,670 --> 00:54:45,549
generators and<font color="#E5E5E5"> that and know</font><font color="#CCCCCC"> that</font>

1227
00:54:44,049 --> 00:54:48,279
everything is online<font color="#CCCCCC"> so you</font><font color="#E5E5E5"> can use it</font>

1228
00:54:45,549 --> 00:54:50,400
<font color="#CCCCCC">feel</font><font color="#E5E5E5"> free and go ahead if you</font><font color="#CCCCCC"> have</font>

1229
00:54:48,279 --> 00:54:54,340
<font color="#E5E5E5">questions</font>

1230
00:54:50,400 --> 00:54:57,130
any questions from before or<font color="#E5E5E5"> maybe off</font>

1231
00:54:54,340 --> 00:54:59,050
<font color="#E5E5E5">the floor you'll be around for the whole</font>

1232
00:54:57,130 --> 00:55:01,540
day today and you'll be<font color="#E5E5E5"> joining the</font>

1233
00:54:59,050 --> 00:55:03,850
<font color="#CCCCCC">party as</font><font color="#E5E5E5"> well afterwards yes</font><font color="#CCCCCC"> excellent</font>

1234
00:55:01,540 --> 00:55:07,020
so well<font color="#E5E5E5"> you know how to how to reach him</font>

1235
00:55:03,850 --> 00:55:10,159
then thank you<font color="#CCCCCC"> very much thank you</font>

1236
00:55:07,020 --> 00:55:10,159
[Applause]

