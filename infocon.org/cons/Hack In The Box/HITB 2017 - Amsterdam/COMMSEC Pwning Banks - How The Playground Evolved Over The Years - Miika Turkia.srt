1
00:00:10,260 --> 00:00:20,070
hello everybody so as the Patrick told

2
00:00:16,860 --> 00:00:22,470
other title is pawning the bank and what

3
00:00:20,070 --> 00:00:28,500
has happened on the playground after

4
00:00:22,470 --> 00:00:30,900
that briefly about myself<font color="#E5E5E5"> I work as a</font>

5
00:00:28,500 --> 00:00:33,840
lead security specialist in nixa and

6
00:00:30,900 --> 00:00:38,910
I've been trying<font color="#CCCCCC"> to learn penetration</font>

7
00:00:33,840 --> 00:00:43,260
testing since 99 the trade is actually

8
00:00:38,910 --> 00:00:48,319
about poor luck and the more I learn the

9
00:00:43,260 --> 00:00:53,010
luckier I get and that's well saved my

10
00:00:48,320 --> 00:00:56,190
projects<font color="#E5E5E5"> a couple of times anyway I was</font>

11
00:00:53,010 --> 00:00:58,260
listening<font color="#E5E5E5"> to the keynote and actually</font>

12
00:00:56,190 --> 00:01:00,089
the opening talk as well and they were

13
00:00:58,260 --> 00:01:03,269
talking<font color="#E5E5E5"> about pretty</font><font color="#CCCCCC"> much the same thing</font>

14
00:01:00,089 --> 00:01:08,880
as I am part present and maybe future

15
00:01:03,269 --> 00:01:15,030
and I'd like<font color="#E5E5E5"> to start with the</font>

16
00:01:08,880 --> 00:01:20,190
disclaimer first of all I do this with a

17
00:01:15,030 --> 00:01:22,560
contract so totally legit stuff and in

18
00:01:20,190 --> 00:01:26,280
general we are not allowed<font color="#E5E5E5"> to talk</font>

19
00:01:22,560 --> 00:01:28,470
anything about our assignments so no

20
00:01:26,280 --> 00:01:30,720
need to come asking her about any

21
00:01:28,470 --> 00:01:35,160
specific on any other project that I've

22
00:01:30,720 --> 00:01:37,110
done even in the customers there's only

23
00:01:35,160 --> 00:01:40,320
<font color="#E5E5E5">a few people who are actually hearing</font>

24
00:01:37,110 --> 00:01:45,900
about the tests yet alone seeing<font color="#E5E5E5"> the</font>

25
00:01:40,320 --> 00:01:48,740
report so basically in some cases they

26
00:01:45,900 --> 00:01:51,540
are thinking that they can publish the

27
00:01:48,740 --> 00:01:53,850
report afterwards but when they see the

28
00:01:51,540 --> 00:01:58,740
<font color="#CCCCCC">Excel</font><font color="#E5E5E5"> findings it's usually classified</font>

29
00:01:53,850 --> 00:02:01,408
after that however<font color="#E5E5E5"> I do have one case</font>

30
00:01:58,740 --> 00:02:05,089
<font color="#CCCCCC">that I can talk</font><font color="#E5E5E5"> about as Patrick told</font>

31
00:02:01,409 --> 00:02:09,800
happens quite a few<font color="#CCCCCC"> years ago and I was</font>

32
00:02:05,090 --> 00:02:12,989
doing<font color="#CCCCCC"> a penetration testing for bank and</font>

33
00:02:09,800 --> 00:02:16,379
they wanted the whole network to be

34
00:02:12,989 --> 00:02:21,180
tested time allocation for the

35
00:02:16,379 --> 00:02:23,670
assignment was two weeks and from

36
00:02:21,180 --> 00:02:24,310
<font color="#E5E5E5">everything I can tell it appears that</font>

37
00:02:23,670 --> 00:02:28,089
the cost

38
00:02:24,310 --> 00:02:36,010
actually wants<font color="#CCCCCC"> to assure others that</font>

39
00:02:28,090 --> 00:02:39,010
they are secure and well after working

40
00:02:36,010 --> 00:02:41,380
for one week and giving a intermediate

41
00:02:39,010 --> 00:02:44,260
report the<font color="#E5E5E5"> assignment was actually</font>

42
00:02:41,380 --> 00:02:47,819
deemed complete and they did<font color="#E5E5E5"> not</font><font color="#CCCCCC"> even</font>

43
00:02:44,260 --> 00:02:52,390
want to return report at that point

44
00:02:47,819 --> 00:02:56,738
<font color="#E5E5E5">anyway here we go her about the</font>

45
00:02:52,390 --> 00:03:00,819
engagement it was total black box I was

46
00:02:56,739 --> 00:03:04,480
given only c-class network as target I

47
00:03:00,819 --> 00:03:06,880
was working over the<font color="#E5E5E5"> Internet to</font><font color="#CCCCCC"> the</font>

48
00:03:04,480 --> 00:03:10,829
<font color="#E5E5E5">other side of the world</font><font color="#CCCCCC"> actually and I</font>

49
00:03:06,880 --> 00:03:13,510
had no user accounts no documentation no

50
00:03:10,830 --> 00:03:16,630
real limitations on<font color="#CCCCCC"> the audit which was</font>

51
00:03:13,510 --> 00:03:19,060
very good but they didn't want any

52
00:03:16,630 --> 00:03:21,040
disruption on the on the services so in

53
00:03:19,060 --> 00:03:25,209
that sense I had to work somewhat

54
00:03:21,040 --> 00:03:26,530
carefully and sadly<font color="#E5E5E5"> had no monetary</font>

55
00:03:25,209 --> 00:03:33,070
transactions were allowed on this

56
00:03:26,530 --> 00:03:35,530
assignment here's my assumption of<font color="#CCCCCC"> the</font>

57
00:03:33,070 --> 00:03:38,858
target I was thinking<font color="#CCCCCC"> that there would</font>

58
00:03:35,530 --> 00:03:41,859
be<font color="#E5E5E5"> DMZ with some public services and</font>

59
00:03:38,859 --> 00:03:46,480
then internal network with private IP

60
00:03:41,859 --> 00:03:51,430
addressing and this is<font color="#E5E5E5"> pretty much where</font>

61
00:03:46,480 --> 00:03:53,500
I started from and because in this case

62
00:03:51,430 --> 00:03:56,980
<font color="#E5E5E5">there was no need to stay under the</font>

63
00:03:53,500 --> 00:04:03,150
radar I just started with full-blown

64
00:03:56,980 --> 00:04:06,518
scan which in some cases is just<font color="#E5E5E5"> okay in</font>

65
00:04:03,150 --> 00:04:11,739
one case when I was actually<font color="#E5E5E5"> working at</font>

66
00:04:06,519 --> 00:04:14,650
one bank premises when I put<font color="#E5E5E5"> it up</font><font color="#CCCCCC"> my</font>

67
00:04:11,739 --> 00:04:17,530
machine it took them five minutes to

68
00:04:14,650 --> 00:04:20,289
turn off<font color="#CCCCCC"> my ethernet port from the</font>

69
00:04:17,529 --> 00:04:23,020
switch and then a few<font color="#CCCCCC"> minutes more than</font>

70
00:04:20,289 --> 00:04:27,610
was a guy checking on me on my door so

71
00:04:23,020 --> 00:04:30,729
some cases you need to play low in this

72
00:04:27,610 --> 00:04:38,220
<font color="#E5E5E5">case I just started with full-blown scan</font>

73
00:04:30,729 --> 00:04:38,219
with no delays or anything in there

74
00:04:38,940 --> 00:04:46,870
basically<font color="#E5E5E5"> I started with a quick scan</font>

75
00:04:42,010 --> 00:04:49,770
with start to map out some easy or fast

76
00:04:46,870 --> 00:04:52,120
services to be found<font color="#E5E5E5"> and let a</font>

77
00:04:49,770 --> 00:04:55,469
full-blown reports can run in<font color="#E5E5E5"> the</font>

78
00:04:52,120 --> 00:04:59,800
background and then I did a

79
00:04:55,470 --> 00:05:03,760
vulnerability scan based on the initial

80
00:04:59,800 --> 00:05:06,070
port scan results and the initial

81
00:05:03,760 --> 00:05:09,060
<font color="#E5E5E5">results were actually quite</font>

82
00:05:06,070 --> 00:05:12,909
disappointing from my point of view

83
00:05:09,060 --> 00:05:17,620
there was only one tcp port open which

84
00:05:12,910 --> 00:05:23,470
was HTTPS and everything that<font color="#E5E5E5"> I</font><font color="#CCCCCC"> could</font>

85
00:05:17,620 --> 00:05:26,650
see was up to date so required quite a

86
00:05:23,470 --> 00:05:29,020
bit of effort to even think about when

87
00:05:26,650 --> 00:05:31,750
you<font color="#CCCCCC"> how you could</font><font color="#E5E5E5"> actually get inside</font>

88
00:05:29,020 --> 00:05:33,370
and more work Nestor's that was the

89
00:05:31,750 --> 00:05:36,250
vulnerability scanner that are used at

90
00:05:33,370 --> 00:05:39,010
the time reported only<font color="#E5E5E5"> low-level</font>

91
00:05:36,250 --> 00:05:42,700
findings nothing critical nothing

92
00:05:39,010 --> 00:05:44,140
<font color="#E5E5E5">high-level just something that you</font>

93
00:05:42,700 --> 00:05:49,510
wouldn't think that<font color="#E5E5E5"> would help you at</font>

94
00:05:44,140 --> 00:05:54,250
all the web application that<font color="#E5E5E5"> was within</font>

95
00:05:49,510 --> 00:05:58,840
the HD based port was basically a login

96
00:05:54,250 --> 00:06:01,060
page to<font color="#CCCCCC"> the back bank and well no user</font>

97
00:05:58,840 --> 00:06:04,960
accounts so I couldn't<font color="#E5E5E5"> see anything</font>

98
00:06:01,060 --> 00:06:07,030
further I ran full wetback scanning

99
00:06:04,960 --> 00:06:09,669
against it and tested some other stuff

100
00:06:07,030 --> 00:06:18,000
and basically that turned out<font color="#CCCCCC"> to be</font>

101
00:06:09,670 --> 00:06:18,000
nothing so initial recognizance was

102
00:06:18,660 --> 00:06:28,960
quite interesting here it's<font color="#E5E5E5"> showing very</font>

103
00:06:24,130 --> 00:06:31,270
poorly but this is the most<font color="#E5E5E5"> interesting</font>

104
00:06:28,960 --> 00:06:37,169
finding on the vulnerability scanning

105
00:06:31,270 --> 00:06:40,510
which is reported as risk factor none so

106
00:06:37,170 --> 00:06:43,960
well anyway this was what I used or

107
00:06:40,510 --> 00:06:50,180
started to using to gain some access<font color="#CCCCCC"> to</font>

108
00:06:43,960 --> 00:06:52,460
the<font color="#CCCCCC"> target so the finding was about</font>

109
00:06:50,180 --> 00:06:55,130
both they had enabled microsoft

110
00:06:52,460 --> 00:06:57,039
frontpage extensions which is<font color="#E5E5E5"> something</font>

111
00:06:55,130 --> 00:07:04,219
<font color="#CCCCCC">that some of you might remember from</font>

112
00:06:57,039 --> 00:07:08,150
volvo<font color="#CCCCCC"> 10 years ago</font><font color="#E5E5E5"> and basically it's a</font>

113
00:07:04,220 --> 00:07:11,600
bad idea to allow somebody from the

114
00:07:08,150 --> 00:07:13,130
internet to update your web server false

115
00:07:11,600 --> 00:07:19,610
happens<font color="#CCCCCC"> every day know there's still but</font>

116
00:07:13,130 --> 00:07:22,610
with different methods anyway at this

117
00:07:19,610 --> 00:07:26,539
point<font color="#CCCCCC"> I</font><font color="#E5E5E5"> had to start learning completely</font>

118
00:07:22,610 --> 00:07:30,410
new tools for myself which was microsoft

119
00:07:26,539 --> 00:07:33,349
frontpage and then<font color="#CCCCCC"> i had to</font><font color="#E5E5E5"> start</font>

120
00:07:30,410 --> 00:07:37,870
<font color="#E5E5E5">learning visual basic always your basic</font>

121
00:07:33,349 --> 00:07:41,479
script to be exact which actually was

122
00:07:37,870 --> 00:07:47,080
something that I had had done something

123
00:07:41,479 --> 00:07:50,090
with all over because in the early 2000

124
00:07:47,080 --> 00:07:54,979
whenever you had script language

125
00:07:50,090 --> 00:07:57,919
vbscript<font color="#CCCCCC"> ie executed it no matter where</font>

126
00:07:54,979 --> 00:08:01,310
it was so at that time it was very easy

127
00:07:57,919 --> 00:08:05,060
to do cross-site scripting type of

128
00:08:01,310 --> 00:08:13,099
attacks with having vbscript anywhere no

129
00:08:05,060 --> 00:08:15,470
matter where<font color="#CCCCCC"> I made sense or not so one</font>

130
00:08:13,099 --> 00:08:18,199
more trick that had to be done was on

131
00:08:15,470 --> 00:08:21,909
the script that I wrote to<font color="#E5E5E5"> make sure</font>

132
00:08:18,199 --> 00:08:26,120
that is run on the server side and

133
00:08:21,909 --> 00:08:29,419
that's<font color="#E5E5E5"> the fernet server and then that</font>

134
00:08:26,120 --> 00:08:34,479
simply create a West<font color="#E5E5E5"> crypt cell and run</font>

135
00:08:29,419 --> 00:08:37,159
command in there and well this<font color="#E5E5E5"> is the</font>

136
00:08:34,479 --> 00:08:40,729
beauty<font color="#E5E5E5"> I was able</font><font color="#CCCCCC"> to write and then</font>

137
00:08:37,159 --> 00:08:43,159
uploads to the iis server and then when

138
00:08:40,729 --> 00:08:50,060
<font color="#CCCCCC">i was</font><font color="#E5E5E5"> accessing the page my command got</font>

139
00:08:43,159 --> 00:08:52,899
executed which was kind of nice<font color="#E5E5E5"> i did</font>

140
00:08:50,060 --> 00:08:55,939
have some challenges i uploaded tomorrow

141
00:08:52,899 --> 00:08:59,110
binaries because at the time<font color="#E5E5E5"> i had</font>

142
00:08:55,940 --> 00:09:01,940
<font color="#CCCCCC">actually never</font><font color="#E5E5E5"> heard about web cells and</font>

143
00:08:59,110 --> 00:09:03,120
basically<font color="#E5E5E5"> i wanted to have proper access</font>

144
00:09:01,940 --> 00:09:08,400
to the server

145
00:09:03,120 --> 00:09:11,339
and trying<font color="#E5E5E5"> to write this stuff in</font>

146
00:09:08,400 --> 00:09:16,829
vbscript wasn't really what I wanted to

147
00:09:11,339 --> 00:09:20,300
do so I try to<font color="#CCCCCC"> use netcat XA which</font><font color="#E5E5E5"> is a</font>

148
00:09:16,830 --> 00:09:24,510
telnet like tool that you can use

149
00:09:20,300 --> 00:09:26,880
creatively and I had<font color="#E5E5E5"> some trouble</font>

150
00:09:24,510 --> 00:09:30,410
uploading the binary because it always

151
00:09:26,880 --> 00:09:33,870
turned out to be zero size at the server

152
00:09:30,410 --> 00:09:36,779
so i tried some other binaries and some

153
00:09:33,870 --> 00:09:39,750
of them were uploaded properly some of

154
00:09:36,779 --> 00:09:42,420
them had the size<font color="#CCCCCC"> 0 so basically</font><font color="#E5E5E5"> there</font>

155
00:09:39,750 --> 00:09:46,410
was antivirus software blocking some of

156
00:09:42,420 --> 00:09:54,000
the binaries but all of<font color="#CCCCCC"> the interesting</font>

157
00:09:46,410 --> 00:09:57,810
ones<font color="#E5E5E5"> and so to say then of</font><font color="#CCCCCC"> course I had</font>

158
00:09:54,000 --> 00:10:00,990
<font color="#CCCCCC">to get the cell and for that i did some</font>

159
00:09:57,810 --> 00:10:03,750
trivial changes the net get binary so

160
00:10:00,990 --> 00:10:06,120
that at the<font color="#E5E5E5"> time antivirus was pretty</font>

161
00:10:03,750 --> 00:10:10,080
much<font color="#E5E5E5"> working with signature-based</font>

162
00:10:06,120 --> 00:10:14,910
detection and changing some critical

163
00:10:10,080 --> 00:10:19,820
part of the exe was was enough to pull

164
00:10:14,910 --> 00:10:24,240
the antivirus then on my own computer I

165
00:10:19,820 --> 00:10:27,740
opened up<font color="#CCCCCC"> the</font><font color="#E5E5E5"> IP tables and put another</font>

166
00:10:24,240 --> 00:10:31,800
<font color="#CCCCCC">net cut to listen on port 443 which is</font>

167
00:10:27,740 --> 00:10:36,600
quite safe usually when you are getting

168
00:10:31,800 --> 00:10:41,060
<font color="#CCCCCC">a reversal from somewhere next step was</font>

169
00:10:36,600 --> 00:10:44,550
to<font color="#CCCCCC"> use the described vbscript and just</font>

170
00:10:41,060 --> 00:10:46,709
run the net get exited modified<font color="#E5E5E5"> netcat</font>

171
00:10:44,550 --> 00:10:50,910
<font color="#CCCCCC">Exadata</font><font color="#E5E5E5"> i was able to upload there and</font>

172
00:10:46,709 --> 00:10:55,949
just start a command cell with it and

173
00:10:50,910 --> 00:10:59,010
give the input output to my network host

174
00:10:55,950 --> 00:11:04,020
and this gave me<font color="#CCCCCC"> nice interactive cell</font>

175
00:10:59,010 --> 00:11:07,279
which was a good step forward now<font color="#E5E5E5"> I was</font>

176
00:11:04,020 --> 00:11:10,650
able to<font color="#E5E5E5"> do pretty much anything on that</font>

177
00:11:07,279 --> 00:11:14,930
single machine with regular user

178
00:11:10,650 --> 00:11:14,930
privileges or limited user privileges

179
00:11:16,150 --> 00:11:26,150
then trying<font color="#E5E5E5"> to think of ways to go</font>

180
00:11:21,650 --> 00:11:29,680
forward one common thing is to<font color="#CCCCCC"> try to</font>

181
00:11:26,150 --> 00:11:33,380
get some grab some passwords because

182
00:11:29,680 --> 00:11:35,510
they tend to be used all over and you

183
00:11:33,380 --> 00:11:39,860
<font color="#CCCCCC">can usually if you can crack passwords</font>

184
00:11:35,510 --> 00:11:41,960
won't work from one system it's way<font color="#E5E5E5"> too</font>

185
00:11:39,860 --> 00:11:50,680
often<font color="#E5E5E5"> possible to use those credentials</font>

186
00:11:41,960 --> 00:11:53,800
elsewhere so for this<font color="#E5E5E5"> I used peavey dump</font>

187
00:11:50,680 --> 00:11:56,239
don't remember the exact version of it

188
00:11:53,800 --> 00:11:59,689
there's a whole<font color="#E5E5E5"> bunch of different</font>

189
00:11:56,240 --> 00:12:02,450
version of this tool and they have

190
00:11:59,690 --> 00:12:07,910
evolved between<font color="#E5E5E5"> Windows changes and so</font>

191
00:12:02,450 --> 00:12:11,980
forth but basically you can grab the

192
00:12:07,910 --> 00:12:19,370
password has is from some database and

193
00:12:11,980 --> 00:12:21,800
decrypt them with you ski or<font color="#E5E5E5"> windows</font>

194
00:12:19,370 --> 00:12:31,730
memory directly if you have insufficient

195
00:12:21,800 --> 00:12:35,000
privileges so basically I would have

196
00:12:31,730 --> 00:12:36,980
needed administrator power on the

197
00:12:35,000 --> 00:12:39,680
machine to be able<font color="#E5E5E5"> to grab the password</font>

198
00:12:36,980 --> 00:12:45,440
has is directly from there and that was

199
00:12:39,680 --> 00:12:48,280
not available for me but in windows at

200
00:12:45,440 --> 00:12:52,370
<font color="#CCCCCC">the time there's the some database that</font>

201
00:12:48,280 --> 00:12:54,970
contains all the secrets and it's locked

202
00:12:52,370 --> 00:12:58,880
while the operating system is running so

203
00:12:54,970 --> 00:13:02,630
one can't access it but there<font color="#E5E5E5"> was a</font>

204
00:12:58,880 --> 00:13:04,970
backup<font color="#E5E5E5"> of it done automatically and with</font>

205
00:13:02,630 --> 00:13:08,810
the backup you can<font color="#E5E5E5"> just use the</font><font color="#CCCCCC"> PV dump</font>

206
00:13:04,970 --> 00:13:15,140
and grab the encrypted<font color="#CCCCCC"> hussey's from</font>

207
00:13:08,810 --> 00:13:17,810
there so<font color="#CCCCCC"> that was a successful way to</font>

208
00:13:15,140 --> 00:13:24,080
get some more<font color="#E5E5E5"> information about the</font>

209
00:13:17,810 --> 00:13:25,459
target windows is or was quite

210
00:13:24,080 --> 00:13:29,720
interesting in the sense that<font color="#CCCCCC"> they had</font>

211
00:13:25,460 --> 00:13:33,709
<font color="#E5E5E5">improved the hashing algorithm so</font>

212
00:13:29,720 --> 00:13:36,110
that they supported ntlm v2 and that was

213
00:13:33,709 --> 00:13:39,680
<font color="#CCCCCC">actually something that they basically</font>

214
00:13:36,110 --> 00:13:44,870
used but on top of that they<font color="#E5E5E5"> sought the</font>

215
00:13:39,680 --> 00:13:47,750
old<font color="#CCCCCC"> Lonmin hash as well which is very</font>

216
00:13:44,870 --> 00:13:53,629
quick<font color="#E5E5E5"> to crack even at the time so one</font>

217
00:13:47,750 --> 00:13:58,910
man has supports 14 correct passwords

218
00:13:53,629 --> 00:14:00,470
but it treats them in two parts so it's

219
00:13:58,910 --> 00:14:02,689
actually<font color="#E5E5E5"> seven characters and seven</font>

220
00:14:00,470 --> 00:14:04,790
characters so many people actually<font color="#E5E5E5"> at</font>

221
00:14:02,689 --> 00:14:06,620
the time because the password policy

222
00:14:04,790 --> 00:14:10,009
said that password has to be eight

223
00:14:06,620 --> 00:14:12,050
characters they put eight characters in

224
00:14:10,009 --> 00:14:14,959
it and it was actually<font color="#E5E5E5"> seven characters</font>

225
00:14:12,050 --> 00:14:19,160
and one incorrect password so quite a

226
00:14:14,959 --> 00:14:20,689
few passwords were whatever<font color="#E5E5E5"> seven</font>

227
00:14:19,160 --> 00:14:22,610
characters and then some special

228
00:14:20,689 --> 00:14:26,930
character at<font color="#CCCCCC"> the end so</font><font color="#E5E5E5"> usually it was</font>

229
00:14:22,610 --> 00:14:29,949
enough<font color="#E5E5E5"> to crack the uppercase letters</font>

230
00:14:26,930 --> 00:14:32,899
and numbers and then for the<font color="#E5E5E5"> last part</font>

231
00:14:29,949 --> 00:14:37,040
special characters included but anyway

232
00:14:32,899 --> 00:14:43,100
<font color="#E5E5E5">even full cracking was quite fact some</font>

233
00:14:37,040 --> 00:14:45,649
millions of price per second and lacking

234
00:14:43,100 --> 00:14:47,959
all the lower case numbers and having

235
00:14:45,649 --> 00:14:50,920
this sort password was actually we're

236
00:14:47,959 --> 00:14:55,489
very very easy to obtain the

237
00:14:50,920 --> 00:15:01,490
administrator password from there at

238
00:14:55,490 --> 00:15:05,420
this point<font color="#CCCCCC"> I was able to check out the</font>

239
00:15:01,490 --> 00:15:09,079
environment<font color="#E5E5E5"> and I was trying to learn</font>

240
00:15:05,420 --> 00:15:14,660
<font color="#E5E5E5">how the DM set was laid out and what was</font>

241
00:15:09,079 --> 00:15:18,620
available there and I started<font color="#CCCCCC"> to looking</font>

242
00:15:14,660 --> 00:15:20,809
around scanning from the<font color="#CCCCCC"> DMC to the DMC</font>

243
00:15:18,620 --> 00:15:29,410
and then trying<font color="#E5E5E5"> to figure out where the</font>

244
00:15:20,809 --> 00:15:33,439
internal network was so<font color="#CCCCCC"> it is kind of</font>

245
00:15:29,410 --> 00:15:36,829
revolting using the net cat command to

246
00:15:33,439 --> 00:15:40,939
us can t see reports on the local

247
00:15:36,829 --> 00:15:43,239
network I use this kind<font color="#E5E5E5"> of short script</font>

248
00:15:40,939 --> 00:15:44,839
to look through the

249
00:15:43,240 --> 00:15:51,750
[Music]

250
00:15:44,840 --> 00:15:55,590
hosts within the<font color="#E5E5E5"> c-class and then some</font>

251
00:15:51,750 --> 00:15:58,830
specific ports obviously a few more than

252
00:15:55,590 --> 00:16:01,140
initially speak here and using<font color="#CCCCCC"> the real</font>

253
00:15:58,830 --> 00:16:07,740
IP addresses in this instead of local

254
00:16:01,140 --> 00:16:10,290
host so with<font color="#E5E5E5"> this method I saw a couple</font>

255
00:16:07,740 --> 00:16:12,990
of<font color="#E5E5E5"> Windows boxes and then I saw one</font>

256
00:16:10,290 --> 00:16:19,500
telnet that turned out to<font color="#CCCCCC"> be a cisco</font>

257
00:16:12,990 --> 00:16:23,310
router however nothing generally easy

258
00:16:19,500 --> 00:16:25,560
and trivial didn't work there so in

259
00:16:23,310 --> 00:16:28,920
<font color="#CCCCCC">Cisco it was actually quite common that</font>

260
00:16:25,560 --> 00:16:32,520
you could grab some<font color="#E5E5E5"> configurations all</font>

261
00:16:28,920 --> 00:16:35,250
of it using SNMP or default credentials

262
00:16:32,520 --> 00:16:41,370
were also surprisingly common at the

263
00:16:35,250 --> 00:16:45,210
time but these didn't fly so this<font color="#CCCCCC"> is</font><font color="#E5E5E5"> my</font>

264
00:16:41,370 --> 00:16:48,839
current understanding<font color="#E5E5E5"> of the network so</font>

265
00:16:45,210 --> 00:16:52,440
I saw some back-end systems and the web

266
00:16:48,839 --> 00:16:55,530
front on the DMZ and then there was this

267
00:16:52,440 --> 00:16:59,670
rogue proud that I had no clue<font color="#E5E5E5"> right</font>

268
00:16:55,530 --> 00:17:07,349
there or what it's doing but when

269
00:16:59,670 --> 00:17:10,139
looking forward I used PS xxxx that is a

270
00:17:07,349 --> 00:17:13,290
tool from sysinternals and was able<font color="#E5E5E5"> to</font>

271
00:17:10,140 --> 00:17:17,280
run commands on other<font color="#E5E5E5"> Windows machines</font>

272
00:17:13,290 --> 00:17:20,430
on the same network this required me to

273
00:17:17,280 --> 00:17:23,839
have the credentials from the previous

274
00:17:20,430 --> 00:17:30,060
password cracking or it could<font color="#E5E5E5"> support</font>

275
00:17:23,839 --> 00:17:36,480
pastor has which<font color="#CCCCCC"> is basically in Windows</font>

276
00:17:30,060 --> 00:17:38,970
environment they use past form of the

277
00:17:36,480 --> 00:17:43,190
password so to say to order to get our

278
00:17:38,970 --> 00:17:48,000
network and do things but it's kind of

279
00:17:43,190 --> 00:17:51,720
the stupid because you can just<font color="#CCCCCC"> use the</font>

280
00:17:48,000 --> 00:17:55,700
same hash and you step as a password

281
00:17:51,720 --> 00:17:57,779
basically to log into remote servers and

282
00:17:55,700 --> 00:18:01,879
so there's no<font color="#CCCCCC"> geeks</font>

283
00:17:57,779 --> 00:18:06,989
or<font color="#E5E5E5"> anything going on then I was able to</font>

284
00:18:01,879 --> 00:18:11,330
check out the files on different

285
00:18:06,989 --> 00:18:14,519
machines with samba just natively and

286
00:18:11,330 --> 00:18:23,210
then of course using the net get to

287
00:18:14,519 --> 00:18:25,859
access other<font color="#E5E5E5"> TCP based services however</font>

288
00:18:23,210 --> 00:18:30,179
<font color="#E5E5E5">there was no way to get into the</font>

289
00:18:25,859 --> 00:18:34,830
internal network at all I<font color="#E5E5E5"> tried</font><font color="#CCCCCC"> to look</font>

290
00:18:30,179 --> 00:18:38,190
for it from<font color="#E5E5E5"> every machine I could treat</font>

291
00:18:34,830 --> 00:18:44,728
within the DMZ but none of them were

292
00:18:38,190 --> 00:18:46,950
able to talk to the internal network so

293
00:18:44,729 --> 00:18:51,869
I really needed some kind of<font color="#E5E5E5"> break</font>

294
00:18:46,950 --> 00:18:59,009
through to get any access<font color="#CCCCCC"> to the final</font>

295
00:18:51,869 --> 00:19:00,959
target I looked<font color="#E5E5E5"> into the cisco router</font>

296
00:18:59,009 --> 00:19:07,159
that was there so it was<font color="#CCCCCC"> actually a</font>

297
00:19:00,960 --> 00:19:14,039
catalyst which is a rack based<font color="#E5E5E5"> modular</font>

298
00:19:07,159 --> 00:19:16,950
router and it you can put sweet<font color="#E5E5E5"> C's</font>

299
00:19:14,039 --> 00:19:23,099
routers firewalls in the same rack and

300
00:19:16,950 --> 00:19:24,779
they are kind of single entity but each

301
00:19:23,099 --> 00:19:31,759
of the module is doing their<font color="#E5E5E5"> own thing</font>

302
00:19:24,779 --> 00:19:34,799
and it's actually<font color="#E5E5E5"> quite common with</font>

303
00:19:31,759 --> 00:19:39,629
telco routers and some blade servers to

304
00:19:34,799 --> 00:19:42,059
have a similar functionality what I did

305
00:19:39,629 --> 00:19:47,789
next I looked into<font color="#E5E5E5"> the router module</font>

306
00:19:42,059 --> 00:19:53,009
with telnet and actually I forgot to

307
00:19:47,789 --> 00:19:55,529
mention something in here so when I was

308
00:19:53,009 --> 00:19:57,570
looking into the DMZ host and going

309
00:19:55,529 --> 00:20:02,330
through whatever they contained there

310
00:19:57,570 --> 00:20:07,080
happens to be a log file from a terminal

311
00:20:02,330 --> 00:20:09,570
software and some administrator had used

312
00:20:07,080 --> 00:20:10,629
that terminal to<font color="#CCCCCC"> log into</font><font color="#E5E5E5"> the cisco</font>

313
00:20:09,570 --> 00:20:14,409
router

314
00:20:10,630 --> 00:20:16,720
and had enabled full logging so it

315
00:20:14,410 --> 00:20:19,630
actually contains the credentials for

316
00:20:16,720 --> 00:20:26,470
<font color="#CCCCCC">the cisco</font><font color="#E5E5E5"> router as well which was very</font>

317
00:20:19,630 --> 00:20:29,260
lucky<font color="#E5E5E5"> for me and when i was able</font><font color="#CCCCCC"> to log</font>

318
00:20:26,470 --> 00:20:35,710
<font color="#CCCCCC">into</font><font color="#E5E5E5"> the router then I just enabled more</font>

319
00:20:29,260 --> 00:20:40,770
power with a password League and jumped

320
00:20:35,710 --> 00:20:44,530
into the cut always which is an

321
00:20:40,770 --> 00:20:48,070
operating systems on the actual rack so

322
00:20:44,530 --> 00:20:50,590
the rack is<font color="#E5E5E5"> running cutaways and the</font>

323
00:20:48,070 --> 00:20:57,909
modules individual modules they they run

324
00:20:50,590 --> 00:20:59,860
iOS and from the cut OS x design you are

325
00:20:57,910 --> 00:21:04,840
able<font color="#E5E5E5"> to</font><font color="#CCCCCC"> access the console of every</font>

326
00:20:59,860 --> 00:21:06,790
module within the catalyst so from there

327
00:21:04,840 --> 00:21:10,870
i just<font color="#CCCCCC"> opened up the console for the</font>

328
00:21:06,790 --> 00:21:13,149
firewall module and they had used<font color="#E5E5E5"> the</font>

329
00:21:10,870 --> 00:21:19,750
same<font color="#CCCCCC"> password on the firewall as with</font>

330
00:21:13,150 --> 00:21:23,380
the router so that means that<font color="#CCCCCC"> i now had</font>

331
00:21:19,750 --> 00:21:30,070
power within the firewall to do how r

332
00:21:23,380 --> 00:21:34,480
please well i kind of had to change the

333
00:21:30,070 --> 00:21:38,409
<font color="#E5E5E5">game because everything from external to</font>

334
00:21:34,480 --> 00:21:41,500
the internal network was blocked so I

335
00:21:38,410 --> 00:21:46,000
did added a new firewall rule that

336
00:21:41,500 --> 00:21:48,220
allowed my IP address to connect to the

337
00:21:46,000 --> 00:21:50,560
internal network which was<font color="#E5E5E5"> actually part</font>

338
00:21:48,220 --> 00:21:53,230
of the c-class network so they had split

339
00:21:50,560 --> 00:21:55,570
the CC<font color="#CCCCCC"> class so that the DMZ had some</font>

340
00:21:53,230 --> 00:21:59,500
some of the IPS and the internal network

341
00:21:55,570 --> 00:22:03,040
had the rest and writing carefully a new

342
00:21:59,500 --> 00:22:05,890
rule there<font color="#E5E5E5"> I allowed some ports for</font>

343
00:22:03,040 --> 00:22:09,639
myself to gain direct access to the

344
00:22:05,890 --> 00:22:11,680
<font color="#E5E5E5">internal network last thing was to</font>

345
00:22:09,640 --> 00:22:18,460
commit the changes so they would

346
00:22:11,680 --> 00:22:21,010
<font color="#CCCCCC">actually go into use I did a quick sweep</font>

347
00:22:18,460 --> 00:22:22,860
or enumeration of the internal network

348
00:22:21,010 --> 00:22:25,260
and you

349
00:22:22,860 --> 00:22:26,879
for example SMB<font color="#CCCCCC"> new assistant to grab</font>

350
00:22:25,260 --> 00:22:30,090
more information about the Windows

351
00:22:26,880 --> 00:22:36,590
domain and for this<font color="#E5E5E5"> there was some tools</font>

352
00:22:30,090 --> 00:22:40,470
like animal w info and this is somewhat

353
00:22:36,590 --> 00:22:42,840
common that is available<font color="#CCCCCC"> or used to</font><font color="#E5E5E5"> be</font>

354
00:22:40,470 --> 00:22:47,640
available<font color="#CCCCCC"> in the window so basically the</font>

355
00:22:42,840 --> 00:22:50,580
service accounts are allowed to cure a

356
00:22:47,640 --> 00:22:53,090
different windows systems for

357
00:22:50,580 --> 00:22:59,909
information<font color="#E5E5E5"> and that the network works</font>

358
00:22:53,090 --> 00:23:05,970
with no session the internal servers

359
00:22:59,910 --> 00:23:12,510
they were using rdp for logins quite

360
00:23:05,970 --> 00:23:15,660
heavily so<font color="#CCCCCC"> I was</font><font color="#E5E5E5"> able to connect to the</font>

361
00:23:12,510 --> 00:23:19,460
domain controller with the same

362
00:23:15,660 --> 00:23:23,400
credentials that that were used on the

363
00:23:19,460 --> 00:23:26,070
<font color="#E5E5E5">isolated servers on the DMZ so quite a</font>

364
00:23:23,400 --> 00:23:30,540
few mistakes in the system

365
00:23:26,070 --> 00:23:33,299
administration practices there so up to

366
00:23:30,540 --> 00:23:35,549
this point<font color="#E5E5E5"> I had deducted that the</font>

367
00:23:33,299 --> 00:23:37,350
<font color="#CCCCCC">network was pretty much</font><font color="#E5E5E5"> like this so the</font>

368
00:23:35,549 --> 00:23:40,379
<font color="#CCCCCC">browser and firewall were on the same</font>

369
00:23:37,350 --> 00:23:41,909
party always different modules then

370
00:23:40,380 --> 00:23:44,760
there<font color="#E5E5E5"> was the DMZ with some back-end</font>

371
00:23:41,910 --> 00:23:49,130
services and then the internal network

372
00:23:44,760 --> 00:23:55,200
was windows network with some VMS

373
00:23:49,130 --> 00:23:59,370
machines there as well this was the<font color="#E5E5E5"> end</font>

374
00:23:55,200 --> 00:24:03,630
of the first<font color="#E5E5E5"> week I reported findings so</font>

375
00:23:59,370 --> 00:24:07,049
far obviously<font color="#E5E5E5"> I had reported</font><font color="#CCCCCC"> the initial</font>

376
00:24:03,630 --> 00:24:10,049
compromised toll immediately when I

377
00:24:07,049 --> 00:24:14,760
discovered it but customer at that point

378
00:24:10,049 --> 00:24:17,100
wasn't really interested however but at

379
00:24:14,760 --> 00:24:22,110
this point I started planning on what<font color="#E5E5E5"> to</font>

380
00:24:17,100 --> 00:24:24,418
do next week so I was intending to<font color="#CCCCCC"> go</font>

381
00:24:22,110 --> 00:24:26,879
for the<font color="#CCCCCC"> internal banking applications</font>

382
00:24:24,419 --> 00:24:29,280
and then take a look<font color="#E5E5E5"> at the VMS that are</font>

383
00:24:26,880 --> 00:24:34,950
<font color="#CCCCCC">actually running the back end of the</font>

384
00:24:29,280 --> 00:24:36,330
<font color="#E5E5E5">banking software and unfortunately at</font>

385
00:24:34,950 --> 00:24:39,659
this point

386
00:24:36,330 --> 00:24:43,860
the customer said that this is this is

387
00:24:39,659 --> 00:24:46,909
enough we do not need need any more

388
00:24:43,860 --> 00:24:49,889
information so basically they were

389
00:24:46,909 --> 00:24:52,200
hoping to<font color="#E5E5E5"> get a</font><font color="#CCCCCC"> green</font><font color="#E5E5E5"> report</font><font color="#CCCCCC"> saying</font><font color="#E5E5E5"> that</font>

390
00:24:49,890 --> 00:25:00,600
they are all secure but I fail to

391
00:24:52,200 --> 00:25:05,070
deliver<font color="#E5E5E5"> that now when thinking about how</font>

392
00:25:00,600 --> 00:25:07,320
things have changed since then in

393
00:25:05,070 --> 00:25:12,210
general more banks are actually

394
00:25:07,320 --> 00:25:15,178
interested in security and this pretty

395
00:25:12,210 --> 00:25:23,100
much sauce everywhere and is<font color="#E5E5E5"> obviously</font><font color="#CCCCCC"> a</font>

396
00:25:15,179 --> 00:25:25,429
<font color="#E5E5E5">good thing however many or most of the</font>

397
00:25:23,100 --> 00:25:28,860
old it's actually concentrate on

398
00:25:25,429 --> 00:25:32,639
specific targets so it might be<font color="#CCCCCC"> a single</font>

399
00:25:28,860 --> 00:25:37,260
<font color="#E5E5E5">web application or single API that that</font>

400
00:25:32,639 --> 00:25:42,240
they want to be tested and<font color="#E5E5E5"> this limits</font>

401
00:25:37,260 --> 00:25:46,408
the scope way to mods that you it's

402
00:25:42,240 --> 00:25:48,299
quite common that the neighboring

403
00:25:46,409 --> 00:25:51,750
systems are giving you quite a<font color="#E5E5E5"> bit of</font>

404
00:25:48,299 --> 00:25:57,149
information always in and limiting<font color="#CCCCCC"> out</font>

405
00:25:51,750 --> 00:25:59,580
<font color="#CCCCCC">its hope is</font><font color="#E5E5E5"> it's not that wise anyway in</font>

406
00:25:57,149 --> 00:26:02,129
in some cases the red team term is used

407
00:25:59,580 --> 00:26:04,830
and then this usually<font color="#CCCCCC"> me means what</font>

408
00:26:02,130 --> 00:26:07,559
pentesting used to mean that you<font color="#E5E5E5"> get a</font>

409
00:26:04,830 --> 00:26:10,549
wider scope and more means and you might

410
00:26:07,559 --> 00:26:14,010
be<font color="#CCCCCC"> able</font><font color="#E5E5E5"> to do social engineering and</font>

411
00:26:10,549 --> 00:26:19,889
facing or different attacks to gain

412
00:26:14,010 --> 00:26:23,190
initial compromise also one thing to

413
00:26:19,889 --> 00:26:27,769
<font color="#E5E5E5">consider is that legislation and privacy</font>

414
00:26:23,190 --> 00:26:31,110
issues might actually pause be a big

415
00:26:27,769 --> 00:26:35,610
hindering factor so for example in

416
00:26:31,110 --> 00:26:40,799
Finland it takes quite a bit of effort

417
00:26:35,610 --> 00:26:43,049
to get to<font color="#CCCCCC"> be allowed to do social</font>

418
00:26:40,799 --> 00:26:48,029
engineering<font color="#CCCCCC"> attacks or against employees</font>

419
00:26:43,049 --> 00:26:50,070
so there's quite a bit of negotiations

420
00:26:48,029 --> 00:26:53,730
between all the employees and

421
00:26:50,070 --> 00:26:56,100
companies and all that so this<font color="#E5E5E5"> depends</font>

422
00:26:53,730 --> 00:27:04,670
on different countries whether you can

423
00:26:56,100 --> 00:27:07,800
<font color="#CCCCCC">easily do it or not</font><font color="#E5E5E5"> and i think</font><font color="#CCCCCC"> was it</font>

424
00:27:04,670 --> 00:27:10,950
seventy to ninety percent of successful

425
00:27:07,800 --> 00:27:15,409
attacks nowadays is done actually over

426
00:27:10,950 --> 00:27:18,660
email so this<font color="#CCCCCC"> is a more</font><font color="#E5E5E5"> or less</font>

427
00:27:15,410 --> 00:27:22,610
guaranteed way in if the attack is done

428
00:27:18,660 --> 00:27:27,440
properly and one should obviously not

429
00:27:22,610 --> 00:27:30,330
scope that out of the assignments are

430
00:27:27,440 --> 00:27:35,640
technical measures have changed somewhat

431
00:27:30,330 --> 00:27:40,790
at the<font color="#E5E5E5"> time some banks didn't use OTP at</font>

432
00:27:35,640 --> 00:27:45,090
all some others used one-time passwords

433
00:27:40,790 --> 00:27:51,000
but nowadays it's very common<font color="#E5E5E5"> to do some</font>

434
00:27:45,090 --> 00:27:53,209
<font color="#CCCCCC">risk based valuation and if the money</font>

435
00:27:51,000 --> 00:27:56,490
<font color="#CCCCCC">transactions that you are performing is</font>

436
00:27:53,210 --> 00:27:58,680
uncommon or big then the bank might

437
00:27:56,490 --> 00:28:01,740
actually do SMS verification or use

438
00:27:58,680 --> 00:28:10,320
mobile app to actually approve it so

439
00:28:01,740 --> 00:28:14,270
it's it's not only the<font color="#CCCCCC"> 11 point password</font>

440
00:28:10,320 --> 00:28:14,270
list that is required for<font color="#E5E5E5"> the action</font>

441
00:28:15,500 --> 00:28:23,720
actually<font color="#E5E5E5"> I did some witbank testing</font>

442
00:28:24,020 --> 00:28:33,090
before the SMS verifications where

443
00:28:27,960 --> 00:28:35,730
common and<font color="#E5E5E5"> I was able to fool the server</font>

444
00:28:33,090 --> 00:28:39,439
side to believe that my one-time

445
00:28:35,730 --> 00:28:44,880
password was the victims password and

446
00:28:39,440 --> 00:28:46,580
well somehow<font color="#E5E5E5"> the big things account was</font>

447
00:28:44,880 --> 00:28:49,500
terminated then and the money<font color="#E5E5E5"> was</font>

448
00:28:46,580 --> 00:28:51,240
transferred<font color="#E5E5E5"> to my account so this</font><font color="#CCCCCC"> is</font>

449
00:28:49,500 --> 00:28:54,570
actually the only example that I've

450
00:28:51,240 --> 00:28:55,950
actually gotten some money out of out<font color="#E5E5E5"> of</font>

451
00:28:54,570 --> 00:28:58,260
these assignments

452
00:28:55,950 --> 00:28:59,580
too bad it was a colleague<font color="#E5E5E5"> and I had</font>

453
00:28:58,260 --> 00:29:05,789
transferred the money to his account

454
00:28:59,580 --> 00:29:08,220
first but fun anyway then of<font color="#E5E5E5"> course</font>

455
00:29:05,789 --> 00:29:11,429
there's some fraud detection mechanism

456
00:29:08,220 --> 00:29:15,230
others in the back bug and systems<font color="#CCCCCC"> that</font>

457
00:29:11,429 --> 00:29:18,330
might stop some of the attacks and

458
00:29:15,230 --> 00:29:28,889
services are<font color="#CCCCCC"> try to</font><font color="#E5E5E5"> be isolated more and</font>

459
00:29:18,330 --> 00:29:32,010
<font color="#E5E5E5">more in general I could say that the</font>

460
00:29:28,889 --> 00:29:34,769
security has improved quite massively in

461
00:29:32,010 --> 00:29:37,740
different product and environments for

462
00:29:34,769 --> 00:29:40,019
example windows system has changed quite

463
00:29:37,740 --> 00:29:42,720
a lot for example they do not allow the

464
00:29:40,019 --> 00:29:45,419
amount of information with null session

465
00:29:42,720 --> 00:29:48,110
and as far<font color="#E5E5E5"> as I know</font><font color="#CCCCCC"> latest Windows</font>

466
00:29:45,419 --> 00:29:51,029
versions don't even a low that at all

467
00:29:48,110 --> 00:29:55,408
however many<font color="#E5E5E5"> of the tools used back then</font>

468
00:29:51,029 --> 00:29:58,730
are still the tools of the trade in

469
00:29:55,409 --> 00:30:03,769
nowadays<font color="#E5E5E5"> for example in manassas are</font>

470
00:29:58,730 --> 00:30:06,929
good tools for the task wellness is

471
00:30:03,769 --> 00:30:08,730
commercialized instead of<font color="#E5E5E5"> being open</font>

472
00:30:06,929 --> 00:30:14,789
source as I think it was at that time

473
00:30:08,730 --> 00:30:18,029
<font color="#CCCCCC">and well many of</font><font color="#E5E5E5"> the attack techniques</font>

474
00:30:14,789 --> 00:30:20,639
rely on design functionality nowadays

475
00:30:18,029 --> 00:30:24,210
even more than back then for example the

476
00:30:20,639 --> 00:30:27,090
PS xxxx is still the<font color="#CCCCCC"> same you can you</font>

477
00:30:24,210 --> 00:30:33,179
<font color="#E5E5E5">can use it to run commands on Windows</font>

478
00:30:27,090 --> 00:30:37,740
environment then one consideration about

479
00:30:33,179 --> 00:30:41,130
the passwords basically cracking the

480
00:30:37,740 --> 00:30:45,480
password is no longer as necessary as it

481
00:30:41,130 --> 00:30:48,659
was back then and this<font color="#E5E5E5"> is due to the new</font>

482
00:30:45,480 --> 00:30:51,179
tech techniques of<font color="#E5E5E5"> past the token and</font>

483
00:30:48,659 --> 00:30:57,500
wealth pastor has as well where<font color="#CCCCCC"> you</font>

484
00:30:51,179 --> 00:31:02,340
either<font color="#E5E5E5"> pass the hashed password or</font>

485
00:30:57,500 --> 00:31:05,690
service token Oh Kerberos token and that

486
00:31:02,340 --> 00:31:08,580
gets you access<font color="#E5E5E5"> to different machines</font>

487
00:31:05,690 --> 00:31:09,700
however password cracking is still very

488
00:31:08,580 --> 00:31:16,059
very<font color="#CCCCCC"> useful</font>

489
00:31:09,700 --> 00:31:18,760
we are multiple times faster nowadays

490
00:31:16,059 --> 00:31:20,740
than back then there's new techniques to

491
00:31:18,760 --> 00:31:25,120
crack passwords for<font color="#CCCCCC"> example rainbow</font>

492
00:31:20,740 --> 00:31:29,080
tables and then we can use utilize GPUs

493
00:31:25,120 --> 00:31:31,239
or multi-core machines or even cloud to

494
00:31:29,080 --> 00:31:36,370
crack the password which has<font color="#E5E5E5"> got off</font>

495
00:31:31,240 --> 00:31:37,990
gender reversal process as well the

496
00:31:36,370 --> 00:31:41,350
reason<font color="#CCCCCC"> to actually crack passwords</font>

497
00:31:37,990 --> 00:31:48,130
nowadays is to detect or exploit

498
00:31:41,350 --> 00:31:52,000
password reuse so as lame as it is this

499
00:31:48,130 --> 00:31:55,830
<font color="#E5E5E5">is a very common way too many many</font>

500
00:31:52,000 --> 00:32:00,130
systems with internet work and<font color="#E5E5E5"> also the</font>

501
00:31:55,830 --> 00:32:02,590
hosting providers they<font color="#E5E5E5"> often use the</font>

502
00:32:00,130 --> 00:32:05,500
<font color="#CCCCCC">same credentials between different</font>

503
00:32:02,590 --> 00:32:09,580
customers so you might<font color="#E5E5E5"> actually get way</font>

504
00:32:05,500 --> 00:32:16,529
too good access all over the virtual

505
00:32:09,580 --> 00:32:19,210
environment with those then if you

506
00:32:16,529 --> 00:32:21,820
switch protocols then you might actually

507
00:32:19,210 --> 00:32:24,309
need the<font color="#E5E5E5"> boss work so if only a remote</font>

508
00:32:21,820 --> 00:32:31,840
desktop is a lot from<font color="#E5E5E5"> you then obviously</font>

509
00:32:24,309 --> 00:32:36,730
you can't pasta<font color="#E5E5E5"> tokens</font><font color="#CCCCCC"> banner windows</font>

510
00:32:31,840 --> 00:32:41,320
API basically it's pretty much<font color="#CCCCCC"> the same</font>

511
00:32:36,730 --> 00:32:43,990
so<font color="#CCCCCC"> the windows environment is designed</font>

512
00:32:41,320 --> 00:32:46,539
for the enterprise administration and

513
00:32:43,990 --> 00:32:49,659
it's very efficient for that but that

514
00:32:46,539 --> 00:32:52,600
<font color="#E5E5E5">also gives good access for</font><font color="#CCCCCC"> the</font>

515
00:32:49,659 --> 00:32:58,510
adversaries there are some new

516
00:32:52,600 --> 00:33:01,658
restrictions in place but well within

517
00:32:58,510 --> 00:33:05,429
<font color="#CCCCCC">Windows domain with proper</font><font color="#E5E5E5"> credentials</font>

518
00:33:01,659 --> 00:33:12,010
you can do a lot<font color="#E5E5E5"> more than the</font>

519
00:33:05,429 --> 00:33:16,990
administrators sobieszczyk<font color="#CCCCCC"> research is</font>

520
00:33:12,010 --> 00:33:20,470
still going strong<font color="#CCCCCC"> peavey</font><font color="#E5E5E5"> doom is no</font>

521
00:33:16,990 --> 00:33:22,820
longer practical used because it's been

522
00:33:20,470 --> 00:33:24,710
replaced<font color="#E5E5E5"> by mimic apps</font>

523
00:33:22,820 --> 00:33:29,330
and I<font color="#CCCCCC"> should have a slide about that</font>

524
00:33:24,710 --> 00:33:31,669
later and then vbscript is not really

525
00:33:29,330 --> 00:33:34,279
there on the server side not much

526
00:33:31,669 --> 00:33:36,889
anymore and well on that<font color="#CCCCCC"> attacks</font><font color="#E5E5E5"> power</font>

527
00:33:34,279 --> 00:33:42,440
<font color="#E5E5E5">cell is really the planets of choice</font>

528
00:33:36,889 --> 00:33:46,570
within<font color="#CCCCCC"> Windows environment the question</font>

529
00:33:42,440 --> 00:33:49,880
whether hacking is nowadays easy or hard

530
00:33:46,570 --> 00:33:53,418
this is full of controversies so

531
00:33:49,880 --> 00:33:56,509
basically pen testing or hacking or

532
00:33:53,419 --> 00:33:59,299
compromising systems is easier than<font color="#E5E5E5"> ever</font>

533
00:33:56,509 --> 00:34:03,049
because there's plenty of<font color="#E5E5E5"> good tools</font>

534
00:33:59,299 --> 00:34:06,168
that help help in the<font color="#CCCCCC"> process ultimate</font>

535
00:34:03,049 --> 00:34:09,050
things and product<font color="#CCCCCC"> eyes exploits</font>

536
00:34:06,169 --> 00:34:11,690
<font color="#CCCCCC">although allow easy compromises quite</font>

537
00:34:09,050 --> 00:34:15,950
often however the differences and

538
00:34:11,690 --> 00:34:19,849
production mechanism they<font color="#CCCCCC"> praise the bar</font>

539
00:34:15,949 --> 00:34:25,178
a lot so for<font color="#CCCCCC"> example writing memory</font>

540
00:34:19,849 --> 00:34:28,879
corruption exploit is now that it i

541
00:34:25,179 --> 00:34:40,668
would say takes weeks instead of the few

542
00:34:28,879 --> 00:34:43,879
hours that win XP time also I've done

543
00:34:40,668 --> 00:34:47,000
<font color="#CCCCCC">some internet response and forensics and</font>

544
00:34:43,879 --> 00:34:50,179
in there well<font color="#E5E5E5"> I can clearly say that</font>

545
00:34:47,000 --> 00:34:54,918
pretty much<font color="#E5E5E5"> same techniques are still</font>

546
00:34:50,179 --> 00:34:57,349
used on the apts and other attacks quite

547
00:34:54,918 --> 00:35:00,279
often it's the<font color="#E5E5E5"> most stupid mistakes that</font>

548
00:34:57,349 --> 00:35:03,020
I exploited for example vulnerable

549
00:35:00,280 --> 00:35:08,390
wordpress site they might get exploited

550
00:35:03,020 --> 00:35:11,869
and in some cases we've seen that after

551
00:35:08,390 --> 00:35:15,859
the compromise the attacker has waited

552
00:35:11,869 --> 00:35:18,770
maybe a few months<font color="#CCCCCC"> even on the domain</font>

553
00:35:15,859 --> 00:35:21,619
<font color="#E5E5E5">yet admin log in and once they crack the</font>

554
00:35:18,770 --> 00:35:27,280
<font color="#E5E5E5">credentials from there I takes them a</font>

555
00:35:21,619 --> 00:35:27,280
few<font color="#E5E5E5"> minutes to own the whole environment</font>

556
00:35:28,829 --> 00:35:37,769
so also<font color="#E5E5E5"> even</font><font color="#CCCCCC"> though it's very very</font>

557
00:35:34,380 --> 00:35:41,160
common<font color="#E5E5E5"> to use exploit the stupid</font>

558
00:35:37,769 --> 00:35:43,738
mistakes<font color="#E5E5E5"> I would say there's plenty of</font>

559
00:35:41,160 --> 00:35:49,348
<font color="#CCCCCC">highly advanced attacks going on as well</font>

560
00:35:43,739 --> 00:35:52,229
and actually the recent the CIA leaks

561
00:35:49,349 --> 00:36:00,499
have been quite interesting freed in

562
00:35:52,229 --> 00:36:05,689
this regard so<font color="#CCCCCC"> mimikatz basically it's</font>

563
00:36:00,499 --> 00:36:07,769
usually grabbing clear text passwords

564
00:36:05,690 --> 00:36:11,930
passwords if they're available in<font color="#E5E5E5"> the</font>

565
00:36:07,769 --> 00:36:16,019
memory or the hashes and covers tickets

566
00:36:11,930 --> 00:36:17,969
also<font color="#CCCCCC"> from memory and it can do</font><font color="#E5E5E5"> pastor</font>

567
00:36:16,019 --> 00:36:20,368
has passed a ticket and it can create<font color="#E5E5E5"> a</font>

568
00:36:17,969 --> 00:36:24,239
gold golden ticket that basically<font color="#CCCCCC"> gives</font>

569
00:36:20,369 --> 00:36:28,109
you power over the environment in

570
00:36:24,239 --> 00:36:31,799
general nowadays these attacks or tools

571
00:36:28,109 --> 00:36:36,420
they tend to be run in the memory so

572
00:36:31,799 --> 00:36:39,779
this<font color="#E5E5E5"> pretty well a very avoids anti</font>

573
00:36:36,420 --> 00:36:41,579
virus detection if we have our core

574
00:36:39,779 --> 00:36:45,509
components running in memory and then we

575
00:36:41,579 --> 00:36:48,180
load some more content from the network

576
00:36:45,509 --> 00:36:54,180
without ever touching<font color="#CCCCCC"> the</font><font color="#E5E5E5"> a disk and do</font>

577
00:36:48,180 --> 00:36:57,769
this ossl then it seems that antivirus

578
00:36:54,180 --> 00:37:01,589
is usually not able to detect anything

579
00:36:57,769 --> 00:37:05,339
also<font color="#E5E5E5"> penetration testing frameworks</font><font color="#CCCCCC"> say</font>

580
00:37:01,589 --> 00:37:07,349
there<font color="#CCCCCC"> are some good ones</font><font color="#E5E5E5"> even free some</font>

581
00:37:05,339 --> 00:37:10,140
<font color="#E5E5E5">of the mark commercial and they</font>

582
00:37:07,349 --> 00:37:13,309
integrate a lot of reliable exploits and

583
00:37:10,140 --> 00:37:17,160
other functionality so so basic may make

584
00:37:13,309 --> 00:37:19,440
these assignments quite a bit<font color="#CCCCCC"> easier</font>

585
00:37:17,160 --> 00:37:25,739
than what it was was at the time when I

586
00:37:19,440 --> 00:37:27,989
described<font color="#E5E5E5"> the banking</font><font color="#CCCCCC"> compromise also</font>

587
00:37:25,739 --> 00:37:30,269
these tools they do have functionality

588
00:37:27,989 --> 00:37:33,239
like grabbing the password and using

589
00:37:30,269 --> 00:37:37,019
those directly from<font color="#E5E5E5"> their tunneling</font>

590
00:37:33,239 --> 00:37:39,900
traffic through 11 connection or even

591
00:37:37,019 --> 00:37:41,640
doing so that<font color="#E5E5E5"> we</font><font color="#CCCCCC"> have a pecan running on</font>

592
00:37:39,900 --> 00:37:46,130
<font color="#E5E5E5">the target</font><font color="#CCCCCC"> system</font>

593
00:37:41,640 --> 00:37:49,410
and that is communicating our DNS or

594
00:37:46,130 --> 00:37:51,559
email or<font color="#E5E5E5"> whatever to the attacker and</font>

595
00:37:49,410 --> 00:38:00,328
the attacker can command whenever the

596
00:37:51,559 --> 00:38:02,970
callback happens and the frameworks also

597
00:38:00,329 --> 00:38:06,150
make<font color="#CCCCCC"> it very easy for the other lateral</font>

598
00:38:02,970 --> 00:38:08,549
movement especially due<font color="#CCCCCC"> to the tunneling</font>

599
00:38:06,150 --> 00:38:11,640
<font color="#E5E5E5">properties so you don't have to rely on</font>

600
00:38:08,549 --> 00:38:19,309
the single framework one but can use

601
00:38:11,640 --> 00:38:19,308
other<font color="#E5E5E5"> tools as well in Windows</font><font color="#CCCCCC"> domain</font>

602
00:38:20,450 --> 00:38:27,779
password hashing or crack grabbing part

603
00:38:24,569 --> 00:38:30,299
where he is actually reasonably easy if

604
00:38:27,779 --> 00:38:34,640
you have enough power basically domain

605
00:38:30,299 --> 00:38:38,099
or enterprise administrator or domain

606
00:38:34,640 --> 00:38:41,359
controller computer account in this case

607
00:38:38,099 --> 00:38:45,799
<font color="#CCCCCC">you can use pc sync which basically</font>

608
00:38:41,359 --> 00:38:48,509
<font color="#CCCCCC">impersonates a domain controller and</font>

609
00:38:45,799 --> 00:38:51,410
<font color="#E5E5E5">asks</font><font color="#CCCCCC"> for the other domain controllers to</font>

610
00:38:48,509 --> 00:38:57,119
give me all the user credentials and

611
00:38:51,410 --> 00:38:59,490
this is something<font color="#CCCCCC"> that clone fighter</font>

612
00:38:57,119 --> 00:39:03,660
can't really understand what how come

613
00:38:59,490 --> 00:39:06,959
there can be broke domain controllers on

614
00:39:03,660 --> 00:39:09,868
<font color="#CCCCCC">the environment</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> asked for all the</font>

615
00:39:06,960 --> 00:39:15,599
secrets but that's how it's currently

616
00:39:09,869 --> 00:39:18,839
working golden ticket was mentioned

617
00:39:15,599 --> 00:39:26,220
previously this is<font color="#E5E5E5"> basically Kurvers to</font>

618
00:39:18,839 --> 00:39:33,210
get<font color="#CCCCCC"> renting ticket and it is something</font>

619
00:39:26,220 --> 00:39:37,069
<font color="#CCCCCC">that is used to create access to all</font>

620
00:39:33,210 --> 00:39:42,269
over the domain so once we have the

621
00:39:37,069 --> 00:39:46,079
password hash of the car<font color="#E5E5E5"> burst</font><font color="#CCCCCC"> EDD of</font>

622
00:39:42,269 --> 00:39:48,118
the domain we cannot in offline create a

623
00:39:46,079 --> 00:39:54,430
new one<font color="#CCCCCC"> group golden ticket for</font>

624
00:39:48,119 --> 00:39:58,599
ourselves<font color="#E5E5E5"> so that we use the hash too</font>

625
00:39:54,430 --> 00:40:00,520
encrypt our ticket and whenever need we

626
00:39:58,599 --> 00:40:04,119
need access around the windows domain we

627
00:40:00,520 --> 00:40:06,910
can send the<font color="#CCCCCC"> Dec information that the</font>

628
00:40:04,119 --> 00:40:14,849
tickets<font color="#CCCCCC"> that</font><font color="#E5E5E5"> we have asked for access to</font>

629
00:40:06,910 --> 00:40:18,308
another server and will be<font color="#CCCCCC"> translated so</font>

630
00:40:14,849 --> 00:40:22,210
antivirus back in the day it<font color="#CCCCCC"> was</font>

631
00:40:18,309 --> 00:40:24,450
obviously not off to absolute<font color="#CCCCCC"> task after</font>

632
00:40:22,210 --> 00:40:28,540
<font color="#CCCCCC">that there has been quite a bit of</font>

633
00:40:24,450 --> 00:40:31,419
changes<font color="#CCCCCC"> in the antivirus industry so</font>

634
00:40:28,540 --> 00:40:35,079
there's machine learning and other

635
00:40:31,420 --> 00:40:38,190
heuristic used so<font color="#CCCCCC"> that they could detect</font>

636
00:40:35,079 --> 00:40:41,170
attacks and malware it more easily and

637
00:40:38,190 --> 00:40:45,490
some of the antivirus systems<font color="#E5E5E5"> use</font>

638
00:40:41,170 --> 00:40:48,369
<font color="#E5E5E5">sandboxing to isolate the untrusted</font>

639
00:40:45,490 --> 00:40:53,470
binaries into a playground where they

640
00:40:48,369 --> 00:40:57,430
can't escape however<font color="#CCCCCC"> AV can still be</font>

641
00:40:53,470 --> 00:41:01,868
paused well the signature based part is

642
00:40:57,430 --> 00:41:05,828
pretty much dead but for example

643
00:41:01,869 --> 00:41:10,119
escaping the sandbox there are some

644
00:41:05,829 --> 00:41:13,540
methods for that and the CIA WikiLeaks

645
00:41:10,119 --> 00:41:17,920
actually describes one method how to

646
00:41:13,540 --> 00:41:20,109
escape<font color="#E5E5E5"> from a DG sandbox and on top of</font>

647
00:41:17,920 --> 00:41:28,000
that there are a couple of other metals

648
00:41:20,109 --> 00:41:31,410
that are not really public then if as I

649
00:41:28,000 --> 00:41:35,400
said before we have our code running on

650
00:41:31,410 --> 00:41:38,170
some process and we allowed<font color="#CCCCCC"> powershell</font>

651
00:41:35,400 --> 00:41:41,410
scripts dynamically and exits from

652
00:41:38,170 --> 00:41:47,380
memory then the antivirus is usually

653
00:41:41,410 --> 00:41:51,430
ignoring this there's a<font color="#E5E5E5"> good website</font>

654
00:41:47,380 --> 00:41:56,680
that describes a<font color="#CCCCCC"> lot of the post</font>

655
00:41:51,430 --> 00:41:58,618
exploitation steps attack there's plenty

656
00:41:56,680 --> 00:42:02,770
<font color="#CCCCCC">of information about persistence</font>

657
00:41:58,619 --> 00:42:08,280
privilege escalation and other other

658
00:42:02,770 --> 00:42:10,750
related topics so they also list

659
00:42:08,280 --> 00:42:13,030
when they describe some of these<font color="#CCCCCC"> topics</font>

660
00:42:10,750 --> 00:42:19,290
they released what APD group for example

661
00:42:13,030 --> 00:42:28,450
has been using<font color="#E5E5E5"> this this technique so</font>

662
00:42:19,290 --> 00:42:31,470
the detection pot windows logging is not

663
00:42:28,450 --> 00:42:34,839
very good<font color="#CCCCCC"> by default so basically</font>

664
00:42:31,470 --> 00:42:39,089
there's no<font color="#E5E5E5"> proper visibility what is</font>

665
00:42:34,840 --> 00:42:42,310
happening on servers or workstations and

666
00:42:39,090 --> 00:42:44,710
the default settings all over are quite

667
00:42:42,310 --> 00:42:48,070
poor so for<font color="#E5E5E5"> example lock retention</font>

668
00:42:44,710 --> 00:42:50,320
period is too small in forensics for

669
00:42:48,070 --> 00:42:52,510
example it's very hard to detect our

670
00:42:50,320 --> 00:42:55,480
analyze what happened two weeks ago if

671
00:42:52,510 --> 00:42:58,150
this<font color="#E5E5E5"> looks only</font><font color="#CCCCCC"> for seven hours so this</font>

672
00:42:55,480 --> 00:43:00,100
depends on the on the customer or

673
00:42:58,150 --> 00:43:06,880
whether they have actually<font color="#E5E5E5"> configured</font>

674
00:43:00,100 --> 00:43:09,730
logging properly also even<font color="#CCCCCC"> though CMS</font>

675
00:43:06,880 --> 00:43:13,150
and all these type operation centers are

676
00:43:09,730 --> 00:43:18,460
very hot nowadays the centralized login

677
00:43:13,150 --> 00:43:22,570
is still somewhat lacking especially the

678
00:43:18,460 --> 00:43:29,320
<font color="#E5E5E5">lock analysis and look correlation is is</font>

679
00:43:22,570 --> 00:43:30,670
not that well done in general also for

680
00:43:29,320 --> 00:43:34,390
example when<font color="#CCCCCC"> we're talking about the</font>

681
00:43:30,670 --> 00:43:37,270
golden ticket if one is using that<font color="#E5E5E5"> in</font>

682
00:43:34,390 --> 00:43:39,670
the windows Des Moines<font color="#E5E5E5"> that practically</font>

683
00:43:37,270 --> 00:43:46,810
can't be seen from<font color="#CCCCCC"> the domain controller</font>

684
00:43:39,670 --> 00:43:49,690
logs it's pretty daz a standard to get

685
00:43:46,810 --> 00:43:51,730
current in ticket and there's no way to

686
00:43:49,690 --> 00:43:56,170
tell the difference between malicious

687
00:43:51,730 --> 00:43:59,980
users or legitimate use and<font color="#E5E5E5"> also the</font>

688
00:43:56,170 --> 00:44:01,990
logs contain plenty of events that are

689
00:43:59,980 --> 00:44:05,859
actually<font color="#E5E5E5"> not interesting to us all us</font><font color="#CCCCCC"> at</font>

690
00:44:01,990 --> 00:44:10,060
all but prevent us from actually seeing

691
00:44:05,859 --> 00:44:13,960
the attacks<font color="#E5E5E5"> in the logs and for</font><font color="#CCCCCC"> example</font>

692
00:44:10,060 --> 00:44:18,070
the latest Windows servers they they

693
00:44:13,960 --> 00:44:20,950
have a was it 60 different logs that

694
00:44:18,070 --> 00:44:24,220
collect different data so it's actually

695
00:44:20,950 --> 00:44:28,589
very hard to know them all and search

696
00:44:24,220 --> 00:44:34,629
<font color="#CCCCCC">for the required information from there</font>

697
00:44:28,589 --> 00:44:38,170
what<font color="#CCCCCC"> about the future well that's a good</font>

698
00:44:34,630 --> 00:44:42,579
<font color="#CCCCCC">question basically it seems that new</font>

699
00:44:38,170 --> 00:44:48,369
developers into the area and implement

700
00:44:42,579 --> 00:44:54,609
the same vulnerabilities again in some

701
00:44:48,369 --> 00:44:57,520
places the gay bar has been raised quite

702
00:44:54,609 --> 00:45:00,900
a lot so for<font color="#E5E5E5"> example the Microsoft is</font>

703
00:44:57,520 --> 00:45:04,030
doing actually quite good job in

704
00:45:00,900 --> 00:45:06,520
preventing memory corruption exploits

705
00:45:04,030 --> 00:45:10,540
for example but there<font color="#CCCCCC"> are still ways to</font>

706
00:45:06,520 --> 00:45:14,220
bypass the prevalence and well if I<font color="#CCCCCC"> had</font>

707
00:45:10,540 --> 00:45:14,220
to guess I would say<font color="#E5E5E5"> that the</font>

708
00:45:16,589 --> 00:45:24,880
vulnerabilities and features they do

709
00:45:21,040 --> 00:45:32,190
evolve and the cat and mouse play is

710
00:45:24,880 --> 00:45:41,500
still going<font color="#E5E5E5"> on strong in the future</font><font color="#CCCCCC"> okay</font>

711
00:45:32,190 --> 00:45:43,599
thanks for<font color="#E5E5E5"> your</font><font color="#CCCCCC"> time thank</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> mikha</font>

712
00:45:41,500 --> 00:45:45,670
turquia for your presentation there's no

713
00:45:43,599 --> 00:45:47,470
room for questions so<font color="#CCCCCC"> if you have one</font>

714
00:45:45,670 --> 00:45:51,520
please raise your arms so<font color="#E5E5E5"> I can give you</font>

715
00:45:47,470 --> 00:45:53,669
the Mike and you can get your question

716
00:45:51,520 --> 00:45:53,670
out

717
00:45:56,359 --> 00:46:03,180
yeah you mentioned you uploaded<font color="#E5E5E5"> a script</font>

718
00:46:00,720 --> 00:46:06,299
or something in the web portal but you

719
00:46:03,180 --> 00:46:09,480
said it was solely a login<font color="#CCCCCC"> that I missed</font>

720
00:46:06,300 --> 00:46:12,750
<font color="#CCCCCC">something there can you</font><font color="#E5E5E5"> repeat I in the</font>

721
00:46:09,480 --> 00:46:17,550
<font color="#CCCCCC">beginning you're saying only 443 was</font>

722
00:46:12,750 --> 00:46:21,660
open and then you upload you attempted

723
00:46:17,550 --> 00:46:24,569
to upload several executables yeah there

724
00:46:21,660 --> 00:46:27,890
was a upload function on the<font color="#CCCCCC"> login page</font>

725
00:46:24,569 --> 00:46:30,630
or no there was no upload function but

726
00:46:27,890 --> 00:46:34,140
microsoft frontpage extension was

727
00:46:30,630 --> 00:46:36,480
enabled and this is actually it's a

728
00:46:34,140 --> 00:46:38,730
method<font color="#E5E5E5"> that all tool that you can use to</font>

729
00:46:36,480 --> 00:46:40,290
update the website and<font color="#E5E5E5"> that allowed</font>

730
00:46:38,730 --> 00:46:44,280
actually under the most access to the

731
00:46:40,290 --> 00:46:49,470
administration<font color="#CCCCCC"> of the website okay thank</font>

732
00:46:44,280 --> 00:46:56,910
you that wasn't clear to me more

733
00:46:49,470 --> 00:46:59,368
questions no then thank<font color="#CCCCCC"> you all for</font>

734
00:46:56,910 --> 00:47:00,629
listening to mika mika thank you and in

735
00:46:59,369 --> 00:47:03,020
a couple<font color="#CCCCCC"> of minutes</font><font color="#E5E5E5"> we'll get them next</font>

736
00:47:00,630 --> 00:47:03,020
speaker

