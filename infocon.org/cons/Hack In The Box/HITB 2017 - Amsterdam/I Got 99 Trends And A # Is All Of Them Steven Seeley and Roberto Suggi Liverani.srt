1
00:00:11,460 --> 00:00:16,410
<font color="#E5E5E5">okay welcome and thanks for attending</font>

2
00:00:14,460 --> 00:00:18,900
this talk I know it's<font color="#CCCCCC"> five-thirty so</font>

3
00:00:16,410 --> 00:00:21,060
some of you might<font color="#E5E5E5"> be tired so</font><font color="#CCCCCC"> we try to</font>

4
00:00:18,900 --> 00:00:24,090
keep it more interesting and

5
00:00:21,060 --> 00:00:27,210
<font color="#E5E5E5">entertaining as much as possible as</font>

6
00:00:24,090 --> 00:00:30,180
mentioned<font color="#CCCCCC"> at the presentation and the</font>

7
00:00:27,210 --> 00:00:33,870
title<font color="#E5E5E5"> it's should be entertaining and</font>

8
00:00:30,180 --> 00:00:37,130
we're going<font color="#E5E5E5"> to show you how we found all</font>

9
00:00:33,870 --> 00:00:40,050
these bags in antrim<font color="#CCCCCC"> micro software and</font>

10
00:00:37,130 --> 00:00:43,020
as you can see the title if I got 99

11
00:00:40,050 --> 00:00:45,510
<font color="#CCCCCC">trends so we try to</font><font color="#E5E5E5"> do a game of words</font>

12
00:00:43,020 --> 00:00:47,850
there and the root shell not a stag is

13
00:00:45,510 --> 00:00:49,829
all of them or better how we found more

14
00:00:47,850 --> 00:00:53,100
<font color="#E5E5E5">than 200 remote code execution will</font><font color="#CCCCCC"> be</font>

15
00:00:49,829 --> 00:00:55,050
this interim Microsoft where so the

16
00:00:53,100 --> 00:00:56,629
agenda<font color="#E5E5E5"> for today and the presentation</font>

17
00:00:55,050 --> 00:00:59,519
<font color="#E5E5E5">and format is pretty straightforward</font>

18
00:00:56,629 --> 00:01:02,039
nothing complex we're going<font color="#E5E5E5"> to show you</font>

19
00:00:59,519 --> 00:01:05,940
a little bit what's going to be our

20
00:01:02,039 --> 00:01:08,340
<font color="#E5E5E5">introduction a bit of disclaimer and the</font>

21
00:01:05,940 --> 00:01:11,759
motivations that drove us to do this

22
00:01:08,340 --> 00:01:14,310
kind<font color="#E5E5E5"> of research why trend micro and not</font>

23
00:01:11,760 --> 00:01:16,350
others and then of course we're going to

24
00:01:14,310 --> 00:01:18,540
focus on the targets we selected for

25
00:01:16,350 --> 00:01:20,280
this research we're<font color="#E5E5E5"> going to show you</font>

26
00:01:18,540 --> 00:01:21,990
the vulnerabilities some of them of

27
00:01:20,280 --> 00:01:25,229
<font color="#CCCCCC">course we cannot show you all the run</font>

28
00:01:21,990 --> 00:01:26,399
abilities because the time and so on but

29
00:01:25,229 --> 00:01:28,500
we<font color="#CCCCCC"> pick the most critical</font>

30
00:01:26,399 --> 00:01:30,240
vulnerabilities and from the

31
00:01:28,500 --> 00:01:32,759
exploitation point of use protection

32
00:01:30,240 --> 00:01:34,500
angle the most<font color="#E5E5E5"> interesting exploitation</font>

33
00:01:32,759 --> 00:01:37,070
angles we had to face during the

34
00:01:34,500 --> 00:01:40,049
research so this<font color="#E5E5E5"> should give you some</font>

35
00:01:37,070 --> 00:01:42,719
good examples of what<font color="#CCCCCC"> we'd found across</font>

36
00:01:40,049 --> 00:01:44,430
different trend micro products of course

37
00:01:42,719 --> 00:01:47,100
we want to show you the house not<font color="#CCCCCC"> just</font>

38
00:01:44,430 --> 00:01:49,560
<font color="#E5E5E5">the what how we found it our which</font>

39
00:01:47,100 --> 00:01:51,419
approach we took and also show you some

40
00:01:49,560 --> 00:01:53,430
of the mistakes with it along<font color="#E5E5E5"> the way of</font>

41
00:01:51,420 --> 00:01:56,909
course the lesson<font color="#CCCCCC"> learned and so on</font><font color="#E5E5E5"> and</font>

42
00:01:53,430 --> 00:01:58,469
then we will also think this<font color="#CCCCCC"> is the</font>

43
00:01:56,909 --> 00:02:00,719
first<font color="#E5E5E5"> time we</font><font color="#CCCCCC"> are presenting this</font>

44
00:01:58,469 --> 00:02:03,630
material and we wanted to give a full

45
00:02:00,719 --> 00:02:05,339
exclusivity to actually works<font color="#E5E5E5"> Amsterdam</font>

46
00:02:03,630 --> 00:02:07,350
because we really like this this

47
00:02:05,340 --> 00:02:09,780
conference<font color="#E5E5E5"> we're going on today we can</font>

48
00:02:07,350 --> 00:02:11,640
also release some unpublished exploits

49
00:02:09,780 --> 00:02:13,830
in one of the trend micro products that

50
00:02:11,640 --> 00:02:16,559
we're<font color="#E5E5E5"> going to cover later on so be with</font>

51
00:02:13,830 --> 00:02:19,980
us and I hope you guys going<font color="#E5E5E5"> to benefit</font>

52
00:02:16,560 --> 00:02:22,020
from this presentation a little bit by

53
00:02:19,980 --> 00:02:24,730
myself from<font color="#CCCCCC"> Roberto sudha rani i have a</font>

54
00:02:22,020 --> 00:02:28,390
<font color="#E5E5E5">twitter accounts from</font><font color="#CCCCCC"> irish I do</font>

55
00:02:24,730 --> 00:02:30,548
this as a passion of mine and I didn't

56
00:02:28,390 --> 00:02:34,149
publish my secret research on my blog

57
00:02:30,549 --> 00:02:36,250
blog Manish dotnet I have been speaking

58
00:02:34,150 --> 00:02:39,909
other conferences and I like to find

59
00:02:36,250 --> 00:02:42,790
bugs he said mean Stephen silly<font color="#E5E5E5"> okay</font>

60
00:02:39,909 --> 00:02:45,220
just<font color="#E5E5E5"> a little bit of obligatory slide a</font>

61
00:02:42,790 --> 00:02:48,220
little bit about me I'm a security

62
00:02:45,220 --> 00:02:49,900
<font color="#E5E5E5">researcher and content developer I do a</font>

63
00:02:48,220 --> 00:02:52,510
live independent security research and

64
00:02:49,900 --> 00:02:54,760
on<font color="#CCCCCC"> client-side vulnerabilities as well</font>

65
00:02:52,510 --> 00:02:55,989
as<font color="#E5E5E5"> server-side vulnerabilities I like to</font>

66
00:02:54,760 --> 00:02:58,810
do other things too like not just

67
00:02:55,989 --> 00:03:02,440
computers like that study Wing Chun and

68
00:02:58,810 --> 00:03:06,489
if I'm a driver as well<font color="#E5E5E5"> and yeah so back</font>

69
00:03:02,440 --> 00:03:09,040
to thank you<font color="#CCCCCC"> okay a bit of disclaimer</font>

70
00:03:06,489 --> 00:03:11,260
before we go into the content of the

71
00:03:09,040 --> 00:03:15,608
research the first thing we<font color="#E5E5E5"> would like</font>

72
00:03:11,260 --> 00:03:17,200
to<font color="#E5E5E5"> point out we can do these against try</font>

73
00:03:15,609 --> 00:03:20,310
micro we have nothing against trend

74
00:03:17,200 --> 00:03:23,170
micro we don't want to put down 3 micro

75
00:03:20,310 --> 00:03:27,129
we strongly believe that given enough

76
00:03:23,170 --> 00:03:28,569
resources<font color="#E5E5E5"> asset time people you can find</font>

77
00:03:27,129 --> 00:03:30,569
a similar number of vulnerabilities if

78
00:03:28,569 --> 00:03:32,679
not more affecting other products<font color="#E5E5E5"> and</font>

79
00:03:30,569 --> 00:03:34,510
actually as a matter of fact after this

80
00:03:32,680 --> 00:03:36,459
presentation I've I mean we test

81
00:03:34,510 --> 00:03:38,290
different products so it's not<font color="#CCCCCC"> just from</font>

82
00:03:36,459 --> 00:03:40,660
micro as a matter of fact I will be

83
00:03:38,290 --> 00:03:43,750
publishing a bad guy<font color="#CCCCCC"> found</font><font color="#E5E5E5"> some time ago</font>

84
00:03:40,660 --> 00:03:45,668
in mccaffrey so it's not just exclaiming

85
00:03:43,750 --> 00:03:47,739
just to make things clear because we

86
00:03:45,669 --> 00:03:51,880
<font color="#CCCCCC">have</font><font color="#E5E5E5"> got</font><font color="#CCCCCC"> some questions</font><font color="#E5E5E5"> why do you pick</font>

87
00:03:47,739 --> 00:03:53,380
up<font color="#CCCCCC"> try migrana others and so on but the</font>

88
00:03:51,880 --> 00:03:55,209
opposite what we want to do is to

89
00:03:53,380 --> 00:03:58,269
actually share what we found how we

90
00:03:55,209 --> 00:04:04,389
found<font color="#E5E5E5"> and so on so that's the takeaway</font>

91
00:03:58,269 --> 00:04:06,480
from this presentation motivation we

92
00:04:04,389 --> 00:04:10,389
noticed<font color="#CCCCCC"> some tweeters they've been</font>

93
00:04:06,480 --> 00:04:11,590
reports published about code execution

94
00:04:10,389 --> 00:04:14,950
<font color="#E5E5E5">were ability affecting certain</font>

95
00:04:11,590 --> 00:04:18,099
trendmicro products so that figured our

96
00:04:14,950 --> 00:04:20,108
curiosity we<font color="#CCCCCC"> noticed</font><font color="#E5E5E5"> these two tweets</font>

97
00:04:18,099 --> 00:04:22,630
you see there and fly to say wow this is

98
00:04:20,108 --> 00:04:24,760
interesting this code execution so it's

99
00:04:22,630 --> 00:04:28,090
very critical vulnerability affecting a

100
00:04:24,760 --> 00:04:30,760
street vendor so that piqued our

101
00:04:28,090 --> 00:04:32,919
interest we say in the<font color="#E5E5E5"> moment you have a</font>

102
00:04:30,760 --> 00:04:34,630
remote code execution below beating on

103
00:04:32,919 --> 00:04:36,370
products most likely there<font color="#E5E5E5"> are others</font>

104
00:04:34,630 --> 00:04:38,370
and that<font color="#CCCCCC"> that's was one</font><font color="#E5E5E5"> of the main</font>

105
00:04:36,370 --> 00:04:40,080
driver to start this

106
00:04:38,370 --> 00:04:41,490
research but it was<font color="#E5E5E5"> not the only driver</font>

107
00:04:40,080 --> 00:04:45,419
of course that there were different

108
00:04:41,490 --> 00:04:47,100
let's say motivations or reasons one

109
00:04:45,419 --> 00:04:49,260
other<font color="#E5E5E5"> thing</font><font color="#CCCCCC"> is that trend micro also</font>

110
00:04:47,100 --> 00:04:51,840
have a DVI so that the acquisition

111
00:04:49,260 --> 00:04:54,389
program for own abilities<font color="#CCCCCC"> that</font><font color="#E5E5E5"> also some</font>

112
00:04:51,840 --> 00:04:56,070
other reasons but the other thing which

113
00:04:54,389 --> 00:04:58,710
is<font color="#E5E5E5"> interesting from the security point</font>

114
00:04:56,070 --> 00:05:02,490
of view is that when you try to find

115
00:04:58,710 --> 00:05:05,130
vulnerabilities in security software

116
00:05:02,490 --> 00:05:07,139
software which provide security well

117
00:05:05,130 --> 00:05:09,690
it's a first of<font color="#E5E5E5"> all it's a huge attack</font>

118
00:05:07,139 --> 00:05:11,940
surface but second point which we<font color="#E5E5E5"> will</font>

119
00:05:09,690 --> 00:05:14,070
see in the<font color="#E5E5E5"> slide is that the code which</font>

120
00:05:11,940 --> 00:05:16,289
is running most of the time is running

121
00:05:14,070 --> 00:05:18,300
in with a<font color="#CCCCCC"> privileged user like</font><font color="#E5E5E5"> root or</font>

122
00:05:16,289 --> 00:05:20,219
system so if you're looking<font color="#CCCCCC"> for</font>

123
00:05:18,300 --> 00:05:22,800
vulnerabilities in these components most

124
00:05:20,220 --> 00:05:25,530
<font color="#E5E5E5">likely you can tell them to to to have</font>

125
00:05:22,800 --> 00:05:28,320
access like root shell or you can have a

126
00:05:25,530 --> 00:05:30,690
system privilege on<font color="#E5E5E5"> a Windows</font>

127
00:05:28,320 --> 00:05:33,719
environment so that was also are<font color="#CCCCCC"> not</font>

128
00:05:30,690 --> 00:05:36,090
<font color="#E5E5E5">very interesting part of it and another</font>

129
00:05:33,720 --> 00:05:38,940
reason is that has been<font color="#CCCCCC"> a quite</font><font color="#E5E5E5"> some</font>

130
00:05:36,090 --> 00:05:41,159
research in the past about antivirus and

131
00:05:38,940 --> 00:05:43,320
endpoint security we<font color="#E5E5E5"> wanted</font><font color="#CCCCCC"> to focus</font>

132
00:05:41,160 --> 00:05:45,780
still on security vendors but not

133
00:05:43,320 --> 00:05:48,419
antivirus per se but all the other

134
00:05:45,780 --> 00:05:51,030
appliances and application and products

135
00:05:48,419 --> 00:05:53,070
which typically are found in enterprise

136
00:05:51,030 --> 00:05:57,900
networks and<font color="#CCCCCC"> you will see some of</font><font color="#E5E5E5"> them</font>

137
00:05:53,070 --> 00:06:01,560
in in a few slides last but<font color="#CCCCCC"> not least I</font>

138
00:05:57,900 --> 00:06:02,820
mean if<font color="#E5E5E5"> I'm gonna I'm gonna call this if</font>

139
00:06:01,560 --> 00:06:05,250
the<font color="#CCCCCC"> security industry is going</font><font color="#E5E5E5"> to</font>

140
00:06:02,820 --> 00:06:07,860
promote defense then they themselves

141
00:06:05,250 --> 00:06:09,810
should not be defenseless I mean we've

142
00:06:07,860 --> 00:06:12,449
been<font color="#E5E5E5"> involved with me we did a lot of</font>

143
00:06:09,810 --> 00:06:15,900
disclosures and sometimes with the

144
00:06:12,449 --> 00:06:18,289
disclosure to products in other industry

145
00:06:15,900 --> 00:06:20,729
not security<font color="#E5E5E5"> industry and sometimes</font>

146
00:06:18,289 --> 00:06:22,770
these companies they don't understand

147
00:06:20,729 --> 00:06:25,560
the hug reports and it's very difficult

148
00:06:22,770 --> 00:06:28,889
to ever dialogue with them in this case

149
00:06:25,560 --> 00:06:30,120
it's it's a fast communication channel

150
00:06:28,889 --> 00:06:31,500
because they understand the business

151
00:06:30,120 --> 00:06:33,330
they understand their own abilities

152
00:06:31,500 --> 00:06:35,430
critical vulnerabilities offending

153
00:06:33,330 --> 00:06:37,680
security software so also in terms of

154
00:06:35,430 --> 00:06:39,750
reputation image their best interests to

155
00:06:37,680 --> 00:06:46,530
resolve this issue and for us it's<font color="#CCCCCC"> not a</font>

156
00:06:39,750 --> 00:06:48,659
big hole to go through the targets these

157
00:06:46,530 --> 00:06:50,549
are<font color="#CCCCCC"> not all the targets these are the</font>

158
00:06:48,659 --> 00:06:52,139
times we're going to cover today the

159
00:06:50,550 --> 00:06:56,430
research<font color="#CCCCCC"> is still</font><font color="#E5E5E5"> ongoing</font>

160
00:06:52,139 --> 00:06:58,860
and this is the order we're going to

161
00:06:56,430 --> 00:07:01,259
follow you see them about security for

162
00:06:58,860 --> 00:07:04,169
enterprises taking off the only reason

163
00:07:01,259 --> 00:07:05,999
<font color="#CCCCCC">why because we have your days and</font>

164
00:07:04,169 --> 00:07:08,810
<font color="#CCCCCC">they're currently</font><font color="#E5E5E5"> working on resolving</font>

165
00:07:05,999 --> 00:07:10,319
these issues<font color="#E5E5E5"> so we are not disclosing</font>

166
00:07:08,810 --> 00:07:12,120
vulnerabilities in that part

167
00:07:10,319 --> 00:07:14,819
nevertheless we're gonna show you a demo

168
00:07:12,120 --> 00:07:16,919
we have a demo for this later on so<font color="#E5E5E5"> that</font>

169
00:07:14,819 --> 00:07:21,360
you can see some of the<font color="#CCCCCC"> bon appetit we</font>

170
00:07:16,919 --> 00:07:24,389
found that brothers as<font color="#E5E5E5"> well testing</font>

171
00:07:21,360 --> 00:07:27,509
approach the testing approach we take we

172
00:07:24,389 --> 00:07:29,909
took in this this research started from

173
00:07:27,509 --> 00:07:32,340
responding or attempting to respond to

174
00:07:29,909 --> 00:07:35,909
this to this question how can we fully

175
00:07:32,340 --> 00:07:38,818
<font color="#E5E5E5">compromise a products without user</font>

176
00:07:35,909 --> 00:07:42,330
interaction that was the aim it all

177
00:07:38,819 --> 00:07:44,339
started from that question and all the

178
00:07:42,330 --> 00:07:46,409
testing approach we followed was always

179
00:07:44,339 --> 00:07:50,310
trying to<font color="#E5E5E5"> come back to this point and</font>

180
00:07:46,409 --> 00:07:53,759
when you try<font color="#CCCCCC"> to put yourself as a</font>

181
00:07:50,310 --> 00:07:57,750
researcher into this position you<font color="#E5E5E5"> will</font>

182
00:07:53,759 --> 00:08:00,419
only<font color="#E5E5E5"> go for the type of bugs which are</font>

183
00:07:57,750 --> 00:08:03,210
either command injection or that leads

184
00:08:00,419 --> 00:08:05,878
to remote code execution for<font color="#E5E5E5"> instance</font>

185
00:08:03,210 --> 00:08:08,250
sequel injection and so on but we also

186
00:08:05,879 --> 00:08:10,919
look into weaknesses in frameworks used

187
00:08:08,250 --> 00:08:12,659
by<font color="#CCCCCC"> a trend micro products or also for</font>

188
00:08:10,919 --> 00:08:15,568
instance in<font color="#E5E5E5"> authentication bypass and</font>

189
00:08:12,659 --> 00:08:17,250
chaining these bags together having a

190
00:08:15,569 --> 00:08:20,009
remote code execution that<font color="#E5E5E5"> you can only</font>

191
00:08:17,250 --> 00:08:22,020
treat after authentication is not as

192
00:08:20,009 --> 00:08:25,050
<font color="#CCCCCC">much as critical having with a bypass</font>

193
00:08:22,020 --> 00:08:26,339
certification so the the<font color="#E5E5E5"> title that's</font>

194
00:08:25,050 --> 00:08:27,870
gonna be the class that you're<font color="#E5E5E5"> going to</font>

195
00:08:26,339 --> 00:08:30,629
see during the<font color="#E5E5E5"> rest of the presentation</font>

196
00:08:27,870 --> 00:08:32,519
is mostly<font color="#E5E5E5"> command injection or an</font>

197
00:08:30,629 --> 00:08:34,829
ability to<font color="#E5E5E5"> resolve to code execution a</font>

198
00:08:32,519 --> 00:08:36,659
notification bypasses<font color="#E5E5E5"> thesis this is</font>

199
00:08:34,828 --> 00:08:39,539
what we took we didn't go for a full

200
00:08:36,659 --> 00:08:41,338
metical approach testing software we

201
00:08:39,539 --> 00:08:44,399
went for low hanging fruit and just

202
00:08:41,339 --> 00:08:47,570
concentrating our efforts into this kind

203
00:08:44,399 --> 00:08:47,570
of<font color="#E5E5E5"> a luna BTW</font><font color="#CCCCCC"> classes</font>

204
00:08:49,830 --> 00:08:54,600
one of the things<font color="#E5E5E5"> we also did of course</font>

205
00:08:52,320 --> 00:08:56,340
as<font color="#CCCCCC"> part of this approach and one of the</font>

206
00:08:54,600 --> 00:08:57,870
advantage of testing Trend Micro for

207
00:08:56,340 --> 00:08:59,550
instance is that you can download their

208
00:08:57,870 --> 00:09:02,610
products they are all available from

209
00:08:59,550 --> 00:09:05,819
their website once you download the

210
00:09:02,610 --> 00:09:06,750
products you can then install it locally

211
00:09:05,820 --> 00:09:08,850
on your machine you<font color="#E5E5E5"> can install</font>

212
00:09:06,750 --> 00:09:11,670
<font color="#E5E5E5">individual machines so you have full</font>

213
00:09:08,850 --> 00:09:14,670
control<font color="#CCCCCC"> and you can actually</font><font color="#E5E5E5"> then try to</font>

214
00:09:11,670 --> 00:09:17,910
get the source code try to get the

215
00:09:14,670 --> 00:09:20,550
binaries do some reverse engineering try

216
00:09:17,910 --> 00:09:23,010
to basically switch from a position

217
00:09:20,550 --> 00:09:26,670
<font color="#CCCCCC">where you're in a black box position to</font>

218
00:09:23,010 --> 00:09:28,860
a white box up testing approach why this

219
00:09:26,670 --> 00:09:32,339
shift because once you get into the

220
00:09:28,860 --> 00:09:35,550
<font color="#E5E5E5">white box you have more vision more view</font>

221
00:09:32,340 --> 00:09:37,080
of what the<font color="#CCCCCC"> software is and you in</font><font color="#E5E5E5"> the</font>

222
00:09:35,550 --> 00:09:39,000
best<font color="#E5E5E5"> case you have the source code and</font>

223
00:09:37,080 --> 00:09:41,580
<font color="#E5E5E5">you can</font><font color="#CCCCCC"> go to the source code and</font><font color="#E5E5E5"> be</font>

224
00:09:39,000 --> 00:09:46,110
really methodical in finding bugs off of

225
00:09:41,580 --> 00:09:48,530
likewise commodity injections another

226
00:09:46,110 --> 00:09:50,970
thing we took a specific approach

227
00:09:48,530 --> 00:09:53,310
there's a lot<font color="#CCCCCC"> of things</font><font color="#E5E5E5"> in terms of a</font>

228
00:09:50,970 --> 00:09:55,950
malware analysis and so on a lot of<font color="#CCCCCC"> the</font>

229
00:09:53,310 --> 00:09:57,989
research<font color="#E5E5E5"> as</font><font color="#CCCCCC"> well in that field but these</font>

230
00:09:55,950 --> 00:10:00,390
all the techniques which are valid for

231
00:09:57,990 --> 00:10:03,450
malware analysis can be applicable also

232
00:10:00,390 --> 00:10:06,449
for began being a frivolity research why

233
00:10:03,450 --> 00:10:08,400
because we we want<font color="#E5E5E5"> to analyze how</font>

234
00:10:06,450 --> 00:10:10,830
different components interact each other

235
00:10:08,400 --> 00:10:12,959
we want to analyze for instance<font color="#E5E5E5"> the</font>

236
00:10:10,830 --> 00:10:15,750
traffic generated by one component how

237
00:10:12,960 --> 00:10:17,580
is talking<font color="#CCCCCC"> to a server we</font><font color="#E5E5E5"> stop him first</font>

238
00:10:15,750 --> 00:10:19,110
and from and you will see some examples

239
00:10:17,580 --> 00:10:21,450
later on when<font color="#CCCCCC"> we talk about some of the</font>

240
00:10:19,110 --> 00:10:24,300
products especially data loss prevention

241
00:10:21,450 --> 00:10:30,870
is 11 good example of these techniques

242
00:10:24,300 --> 00:10:32,219
put put in an application the other

243
00:10:30,870 --> 00:10:35,070
thing we're looking<font color="#E5E5E5"> we're looking for</font>

244
00:10:32,220 --> 00:10:39,030
patterns<font color="#CCCCCC"> okay when we say pattern we are</font>

245
00:10:35,070 --> 00:10:42,180
looking for a way to identify if there

246
00:10:39,030 --> 00:10:44,520
is some single or common mechanism

247
00:10:42,180 --> 00:10:46,979
across the different targets what we

248
00:10:44,520 --> 00:10:49,050
notice<font color="#CCCCCC"> that when we picked more than one</font>

249
00:10:46,980 --> 00:10:51,420
product to enjoy micro we notice that

250
00:10:49,050 --> 00:10:53,849
certain functions or certain libraries

251
00:10:51,420 --> 00:10:57,270
where we used or we use across the

252
00:10:53,850 --> 00:10:59,250
targets and I mean we can imagine why

253
00:10:57,270 --> 00:11:01,980
I'm sometimes<font color="#CCCCCC"> they are rushed to go to</font>

254
00:10:59,250 --> 00:11:03,110
<font color="#E5E5E5">market their rush to to deploy the</font>

255
00:11:01,980 --> 00:11:04,880
products it'll become

256
00:11:03,110 --> 00:11:07,760
<font color="#E5E5E5">edition of zero endpoint security is a</font>

257
00:11:04,880 --> 00:11:09,950
huge industry so and I guess the same

258
00:11:07,760 --> 00:11:12,769
probably the same developers<font color="#E5E5E5"> teams they</font>

259
00:11:09,950 --> 00:11:14,480
worked across products so we found

260
00:11:12,769 --> 00:11:17,450
instances where there were similarities

261
00:11:14,480 --> 00:11:19,550
so we're looking<font color="#E5E5E5"> for patterns and one of</font>

262
00:11:17,450 --> 00:11:21,820
the partners we found as what you see in

263
00:11:19,550 --> 00:11:25,459
this slide we saw for instance

264
00:11:21,820 --> 00:11:28,160
<font color="#E5E5E5">trendmicro pods with web interface using</font>

265
00:11:25,459 --> 00:11:31,099
a single point like a gateway for

266
00:11:28,160 --> 00:11:33,949
instance taking requests with methods

267
00:11:31,100 --> 00:11:37,100
and parameters now one of the approach

268
00:11:33,950 --> 00:11:38,990
here is to basically Mac as much as

269
00:11:37,100 --> 00:11:40,970
possible try<font color="#E5E5E5"> to get all the different</font>

270
00:11:38,990 --> 00:11:44,120
methods<font color="#E5E5E5"> and parameters and so on and</font>

271
00:11:40,970 --> 00:11:46,399
then if you do find our abilities in a

272
00:11:44,120 --> 00:11:49,760
in a common point like this<font color="#E5E5E5"> run a</font>

273
00:11:46,399 --> 00:11:51,110
pattern like this one then<font color="#E5E5E5"> you are in a</font>

274
00:11:49,760 --> 00:11:54,050
good<font color="#E5E5E5"> position to find a lot</font><font color="#CCCCCC"> of other</font>

275
00:11:51,110 --> 00:11:59,450
vulnerabilities using the same pattern

276
00:11:54,050 --> 00:12:01,760
of course we did a lot<font color="#E5E5E5"> of we did some</font>

277
00:11:59,450 --> 00:12:03,769
part of automation in this considering

278
00:12:01,760 --> 00:12:06,019
the number of own abilities we found the

279
00:12:03,769 --> 00:12:08,630
automation part in this case for

280
00:12:06,019 --> 00:12:11,930
instance consists in understanding which

281
00:12:08,630 --> 00:12:13,880
requests which methods are valid<font color="#CCCCCC"> ok so</font>

282
00:12:11,930 --> 00:12:15,949
that part can be automated for instance

283
00:12:13,880 --> 00:12:18,769
with<font color="#CCCCCC"> the script which then feeds the</font>

284
00:12:15,949 --> 00:12:20,269
results into web proxy first but the

285
00:12:18,769 --> 00:12:23,029
point here<font color="#E5E5E5"> is to create baseline</font>

286
00:12:20,269 --> 00:12:27,640
requests so a bad mental name for

287
00:12:23,029 --> 00:12:29,990
instance<font color="#E5E5E5"> coming back to to the year and</font>

288
00:12:27,640 --> 00:12:32,720
this is<font color="#E5E5E5"> the</font><font color="#CCCCCC"> metal name here and any of</font>

289
00:12:29,990 --> 00:12:36,589
the parameters of this method ok so

290
00:12:32,720 --> 00:12:39,920
these kind<font color="#E5E5E5"> of information they that can</font>

291
00:12:36,589 --> 00:12:42,320
be for instance spiders crawled from<font color="#CCCCCC"> the</font>

292
00:12:39,920 --> 00:12:44,180
web interface<font color="#E5E5E5"> if that is the case and it</font>

293
00:12:42,320 --> 00:12:47,980
was the case for one product in

294
00:12:44,180 --> 00:12:51,019
particular but dancing which presently

295
00:12:47,980 --> 00:12:53,269
but the<font color="#E5E5E5"> other thing is is now always</font>

296
00:12:51,019 --> 00:12:55,130
<font color="#E5E5E5">relying on the web parts on the front</font>

297
00:12:53,269 --> 00:12:59,660
end we have to go behind<font color="#CCCCCC"> the scenes and</font>

298
00:12:55,130 --> 00:13:03,500
what we did was to basically try to find

299
00:12:59,660 --> 00:13:06,980
other methods following or using that

300
00:13:03,500 --> 00:13:09,560
single point<font color="#E5E5E5"> ap I'd</font><font color="#CCCCCC"> ll and then that</font>

301
00:13:06,980 --> 00:13:11,089
we're not exposed<font color="#E5E5E5"> to the web and that</font>

302
00:13:09,560 --> 00:13:13,069
leads also to discover other

303
00:13:11,089 --> 00:13:15,079
<font color="#E5E5E5">vulnerabilities that typically are not</font>

304
00:13:13,069 --> 00:13:17,089
<font color="#E5E5E5">found if someone is just looking at the</font>

305
00:13:15,079 --> 00:13:19,339
web<font color="#E5E5E5"> interface so we have to go</font>

306
00:13:17,089 --> 00:13:21,889
back to the code again testing approach

307
00:13:19,339 --> 00:13:24,949
going<font color="#E5E5E5"> through the binaries the</font><font color="#CCCCCC"> libraries</font>

308
00:13:21,889 --> 00:13:29,300
the source code and fully get a mapping

309
00:13:24,949 --> 00:13:30,920
out these are<font color="#CCCCCC"> some example of what we</font>

310
00:13:29,300 --> 00:13:34,699
did<font color="#CCCCCC"> very simple is nothing complicated</font>

311
00:13:30,920 --> 00:13:37,550
who went 0 yes strings into different

312
00:13:34,699 --> 00:13:40,339
xeo ll and then we try<font color="#CCCCCC"> to build the list</font>

313
00:13:37,550 --> 00:13:48,079
of<font color="#E5E5E5"> value methods</font><font color="#CCCCCC"> valley parameters and</font>

314
00:13:40,339 --> 00:13:50,449
then basically eat well that was a trait

315
00:13:48,079 --> 00:13:52,670
that basically true through a web proxy

316
00:13:50,449 --> 00:13:54,199
for instance and that's that's part of

317
00:13:52,670 --> 00:13:57,259
the automation but of course the

318
00:13:54,199 --> 00:14:00,019
automation part is one part of it then

319
00:13:57,259 --> 00:14:03,230
you need to basically manually it's a

320
00:14:00,019 --> 00:14:06,439
very fine if the request is valid or not

321
00:14:03,230 --> 00:14:08,959
and then if it is valid then you can try

322
00:14:06,439 --> 00:14:11,660
to attack it and that's what<font color="#E5E5E5"> we did but</font>

323
00:14:08,959 --> 00:14:17,119
<font color="#E5E5E5">that part it's only mammal and that they</font>

324
00:14:11,660 --> 00:14:23,139
require some sometime of course we lost

325
00:14:17,120 --> 00:14:29,240
it again yeah<font color="#E5E5E5"> okay we're batting center</font>

326
00:14:23,139 --> 00:14:31,189
nothing so yeah we don't know regular

327
00:14:29,240 --> 00:14:33,550
expression so that's in text in the

328
00:14:31,189 --> 00:14:36,290
previous slide like just ignore<font color="#CCCCCC"> that</font>

329
00:14:33,550 --> 00:14:39,050
well nevertheless that syntax helps to

330
00:14:36,290 --> 00:14:40,610
find proximately or many 80s yeah we

331
00:14:39,050 --> 00:14:42,290
found like 80 and then we<font color="#E5E5E5"> found like a</font>

332
00:14:40,610 --> 00:14:45,199
whole bunch that was like<font color="#CCCCCC"> not in</font><font color="#E5E5E5"> the</font>

333
00:14:42,290 --> 00:14:47,509
client side code and we were like well I

334
00:14:45,199 --> 00:14:48,859
bet that wasn't tested for for security

335
00:14:47,509 --> 00:14:50,689
issues because you know that it's not

336
00:14:48,860 --> 00:14:52,699
<font color="#E5E5E5">even reachable from like you know the</font>

337
00:14:50,689 --> 00:14:54,439
callbacks in the Jason right like in<font color="#E5E5E5"> the</font>

338
00:14:52,699 --> 00:14:56,779
<font color="#E5E5E5">web use of it the client side so it's</font>

339
00:14:54,439 --> 00:14:58,790
like probably<font color="#E5E5E5"> not test for security so</font>

340
00:14:56,779 --> 00:15:00,889
<font color="#CCCCCC">we run it through the</font><font color="#E5E5E5"> through our test</font>

341
00:14:58,790 --> 00:15:04,040
case and chest harness and bang bang

342
00:15:00,889 --> 00:15:06,709
bang is spits out vulnerabilities<font color="#E5E5E5"> okay</font>

343
00:15:04,040 --> 00:15:09,259
you came out<font color="#CCCCCC"> of some nice so testing</font>

344
00:15:06,709 --> 00:15:11,540
approach we you know a lot of these were

345
00:15:09,259 --> 00:15:13,610
also pre authenticated<font color="#CCCCCC"> too so a lot of</font>

346
00:15:11,540 --> 00:15:14,929
the times we get you<font color="#E5E5E5"> know we find a</font>

347
00:15:13,610 --> 00:15:16,309
vulnerability and we can reach it and

348
00:15:14,929 --> 00:15:18,589
then you know it's running<font color="#CCCCCC"> at a high</font>

349
00:15:16,309 --> 00:15:19,790
privilege so we get rural system and you

350
00:15:18,589 --> 00:15:21,230
know it's pretty<font color="#E5E5E5"> much like what we don't</font>

351
00:15:19,790 --> 00:15:23,269
<font color="#E5E5E5">even have to bypass authentication this</font>

352
00:15:21,230 --> 00:15:24,889
particular case and sometimes we do<font color="#E5E5E5"> and</font>

353
00:15:23,269 --> 00:15:26,540
<font color="#E5E5E5">it really just depends yeah in this</font>

354
00:15:24,889 --> 00:15:28,819
particular case I mean if you<font color="#E5E5E5"> go behind</font>

355
00:15:26,540 --> 00:15:30,310
<font color="#E5E5E5">the scenes again testing approach you</font>

356
00:15:28,819 --> 00:15:32,770
might find out in the pussy

357
00:15:30,310 --> 00:15:34,680
where the developer really didn't think

358
00:15:32,770 --> 00:15:36,939
that<font color="#E5E5E5"> you will ever reach that particular</font>

359
00:15:34,680 --> 00:15:39,099
component of that<font color="#E5E5E5"> particular method so</font>

360
00:15:36,940 --> 00:15:41,950
they think<font color="#E5E5E5"> they assume unfortunately</font>

361
00:15:39,100 --> 00:15:44,020
wrongly that education is not needed for

362
00:15:41,950 --> 00:15:45,460
that<font color="#E5E5E5"> because it's not exposed although</font>

363
00:15:44,020 --> 00:15:46,750
they develop it and then they<font color="#CCCCCC"> just</font>

364
00:15:45,460 --> 00:15:47,890
forget about it they're like well come

365
00:15:46,750 --> 00:15:49,029
back<font color="#CCCCCC"> to that later and we'll add that</font>

366
00:15:47,890 --> 00:15:51,130
functionality into the front end like

367
00:15:49,029 --> 00:15:52,870
you know six months<font color="#CCCCCC"> later when</font><font color="#E5E5E5"> I haven't</font>

368
00:15:51,130 --> 00:15:54,070
fully finished it and then what's too

369
00:15:52,870 --> 00:15:57,160
late you know this vulnerability<font color="#E5E5E5"> is</font>

370
00:15:54,070 --> 00:15:58,690
exactly so these screen shoes here this

371
00:15:57,160 --> 00:16:02,140
is the dev one on the demo live we're

372
00:15:58,690 --> 00:16:04,420
going to do<font color="#E5E5E5"> later on so pitiful than</font>

373
00:16:02,140 --> 00:16:06,610
difficulties I'm of<font color="#E5E5E5"> course with issues</font>

374
00:16:04,420 --> 00:16:09,130
it's<font color="#E5E5E5"> not that we found one ability so</font>

375
00:16:06,610 --> 00:16:10,810
easily is what this kind of things<font color="#E5E5E5"> you</font>

376
00:16:09,130 --> 00:16:14,140
find in five minutes and so on it it

377
00:16:10,810 --> 00:16:16,119
takes time of course<font color="#E5E5E5"> also we had issues</font>

378
00:16:14,140 --> 00:16:17,589
with the software so trendmicro yes it's

379
00:16:16,120 --> 00:16:20,320
good you can download all<font color="#E5E5E5"> the products</font>

380
00:16:17,589 --> 00:16:22,330
as i said before but the products you

381
00:16:20,320 --> 00:16:24,730
need a license so they give you some

382
00:16:22,330 --> 00:16:27,070
trial license but it's limited yep 30

383
00:16:24,730 --> 00:16:27,970
days and then it's not<font color="#E5E5E5"> full and you have</font>

384
00:16:27,070 --> 00:16:31,420
problem with<font color="#E5E5E5"> the Active Directory</font>

385
00:16:27,970 --> 00:16:34,089
Integration so we had<font color="#E5E5E5"> to go</font><font color="#CCCCCC"> around take</font>

386
00:16:31,420 --> 00:16:37,180
some interesting approaches and you will

387
00:16:34,089 --> 00:16:38,800
splain after and yes so these are some

388
00:16:37,180 --> 00:16:41,229
<font color="#E5E5E5">of the problems we face along the way</font>

389
00:16:38,800 --> 00:16:44,079
and of course<font color="#E5E5E5"> mistakes and laziness from</font>

390
00:16:41,230 --> 00:16:46,030
our side one<font color="#E5E5E5"> of the mistakes was that</font>

391
00:16:44,080 --> 00:16:47,800
once we found like<font color="#E5E5E5"> I don't know sequel</font>

392
00:16:46,030 --> 00:16:49,449
injection was just jumping on the sequel

393
00:16:47,800 --> 00:16:52,449
<font color="#E5E5E5">injection and we forgot about</font><font color="#CCCCCC"> all the</font>

394
00:16:49,450 --> 00:16:54,610
rest like and then we found to another

395
00:16:52,450 --> 00:16:57,430
page which was close to that likewise

396
00:16:54,610 --> 00:16:59,680
from an injection so so sometimes<font color="#CCCCCC"> we're</font>

397
00:16:57,430 --> 00:17:01,209
so greedy to find only a class of

398
00:16:59,680 --> 00:17:03,790
vulnerability that we forgot about the

399
00:17:01,210 --> 00:17:06,550
context of the application dancing which

400
00:17:03,790 --> 00:17:08,260
we didn't really<font color="#E5E5E5"> do well is that you</font>

401
00:17:06,550 --> 00:17:10,000
need to take<font color="#E5E5E5"> a little bit of patience</font>

402
00:17:08,260 --> 00:17:11,379
because all these products as<font color="#E5E5E5"> I</font>

403
00:17:10,000 --> 00:17:13,390
mentioned before are typically for

404
00:17:11,380 --> 00:17:14,770
enterprise network so normally in your

405
00:17:13,390 --> 00:17:16,870
<font color="#E5E5E5">laptop we should have an enterprise</font>

406
00:17:14,770 --> 00:17:19,179
network alike and then deploy the

407
00:17:16,869 --> 00:17:21,790
product use Active Directory use

408
00:17:19,179 --> 00:17:23,740
exchange for instance and so on so<font color="#CCCCCC"> you</font>

409
00:17:21,790 --> 00:17:25,959
need<font color="#E5E5E5"> to have</font><font color="#CCCCCC"> the full thing to to make</font>

410
00:17:23,740 --> 00:17:27,790
sure you cover as much as attack surface

411
00:17:25,959 --> 00:17:29,590
because otherwise you just have a box

412
00:17:27,790 --> 00:17:30,790
with a web interface and that's it it

413
00:17:29,590 --> 00:17:34,120
doesn't work<font color="#E5E5E5"> or you can</font><font color="#CCCCCC"> only do a few</font>

414
00:17:30,790 --> 00:17:35,889
things so like testing like reader or

415
00:17:34,120 --> 00:17:36,600
something with like 50 meg files and

416
00:17:35,890 --> 00:17:38,700
then<font color="#E5E5E5"> that's it</font>

417
00:17:36,600 --> 00:17:40,740
no you need like a<font color="#E5E5E5"> hundred gig or</font>

418
00:17:38,700 --> 00:17:42,960
whatever and then you<font color="#E5E5E5"> need a whole bunch</font>

419
00:17:40,740 --> 00:17:44,820
<font color="#E5E5E5">of</font><font color="#CCCCCC"> RAM for like</font><font color="#E5E5E5"> enterprise type software</font>

420
00:17:42,960 --> 00:17:46,200
not because<font color="#E5E5E5"> you really need it but just</font>

421
00:17:44,820 --> 00:17:48,090
because the software says hey we need it

422
00:17:46,200 --> 00:17:51,179
and you're<font color="#CCCCCC"> like you know you don't yeah</font>

423
00:17:48,090 --> 00:17:53,399
there's a quite huge additional attack

424
00:17:51,179 --> 00:17:55,440
surface that you can enable only<font color="#E5E5E5"> if you</font>

425
00:17:53,400 --> 00:17:57,750
for instance<font color="#E5E5E5"> you synchronize one</font>

426
00:17:55,440 --> 00:18:00,330
appliance with the active<font color="#E5E5E5"> directory then</font>

427
00:17:57,750 --> 00:18:02,760
suddenly you see like you have<font color="#CCCCCC"> 10 50 new</font>

428
00:18:00,330 --> 00:18:04,379
pages available to you and you and you

429
00:18:02,760 --> 00:18:06,960
can attack them you can try to find

430
00:18:04,380 --> 00:18:09,000
vulnerabilities in those the other<font color="#E5E5E5"> thing</font>

431
00:18:06,960 --> 00:18:11,429
with other difficulties that some of the

432
00:18:09,000 --> 00:18:13,590
bugs we found of course they require

433
00:18:11,429 --> 00:18:15,990
authentication so one of the most

434
00:18:13,590 --> 00:18:18,809
challenged<font color="#E5E5E5"> I would say was to find hasta</font>

435
00:18:15,990 --> 00:18:20,190
que<font color="#CCCCCC"> shun bypass the areas we can say it</font>

436
00:18:18,809 --> 00:18:22,440
was<font color="#CCCCCC"> the most difficult part sometimes</font>

437
00:18:20,190 --> 00:18:24,270
right so like what is<font color="#E5E5E5"> that thing is</font>

438
00:18:22,440 --> 00:18:26,130
right like we all know that<font color="#CCCCCC"> you know</font>

439
00:18:24,270 --> 00:18:27,750
<font color="#E5E5E5">security is only as good as your weakest</font>

440
00:18:26,130 --> 00:18:29,610
defense or strong<font color="#E5E5E5"> as defense or whatever</font>

441
00:18:27,750 --> 00:18:31,110
but like you know one authentication

442
00:18:29,610 --> 00:18:33,570
bypass means you can reach<font color="#E5E5E5"> all the other</font>

443
00:18:31,110 --> 00:18:35,189
like vulnerabilities<font color="#E5E5E5"> postal so I mean</font>

444
00:18:33,570 --> 00:18:36,480
<font color="#CCCCCC">that's</font><font color="#E5E5E5"> you know you just</font><font color="#CCCCCC"> have to have</font>

445
00:18:35,190 --> 00:18:40,049
<font color="#E5E5E5">one or two and then it's just pretty</font>

446
00:18:36,480 --> 00:18:41,460
much game over at<font color="#E5E5E5"> that</font><font color="#CCCCCC"> point so like you</font>

447
00:18:40,049 --> 00:18:44,010
know<font color="#CCCCCC"> it's a lot of</font><font color="#E5E5E5"> the stuff</font><font color="#CCCCCC"> is pre or</font>

448
00:18:41,460 --> 00:18:46,140
post authenticated and whatever then we

449
00:18:44,010 --> 00:18:48,030
just focus solely on like the authentic

450
00:18:46,140 --> 00:18:49,919
I off bypass and then you know continue

451
00:18:48,030 --> 00:18:52,139
on but we're<font color="#E5E5E5"> not looking for things like</font>

452
00:18:49,919 --> 00:18:53,340
you<font color="#CCCCCC"> know interacting with the client or</font>

453
00:18:52,140 --> 00:18:54,990
things like that this is server-side

454
00:18:53,340 --> 00:18:57,090
software we want to keep<font color="#E5E5E5"> it server-side</font>

455
00:18:54,990 --> 00:18:59,640
exploit we don't<font color="#E5E5E5"> want to have send you a</font>

456
00:18:57,090 --> 00:19:03,299
link you click on a blah blah<font color="#CCCCCC"> blah no</font>

457
00:18:59,640 --> 00:19:05,340
it's just pop shell game over walk away

458
00:19:03,299 --> 00:19:07,980
you<font color="#CCCCCC"> know this is</font><font color="#E5E5E5"> like so what we're</font>

459
00:19:05,340 --> 00:19:10,908
focusing on so you know cool thats knows

460
00:19:07,980 --> 00:19:14,010
which the targets alone and you<font color="#CCCCCC"> don't oh</font>

461
00:19:10,909 --> 00:19:14,880
yes you<font color="#E5E5E5"> want so the first target we're</font>

462
00:19:14,010 --> 00:19:16,260
going<font color="#E5E5E5"> to talk about it's not the first</font>

463
00:19:14,880 --> 00:19:17,789
time we tested but this is the first

464
00:19:16,260 --> 00:19:20,010
target we're sort of looking at today I

465
00:19:17,789 --> 00:19:21,450
honestly<font color="#CCCCCC"> I think we spent like maybe</font>

466
00:19:20,010 --> 00:19:24,000
less<font color="#CCCCCC"> than a week on this one so we</font>

467
00:19:21,450 --> 00:19:25,500
didn't have like a too many too many

468
00:19:24,000 --> 00:19:29,549
findings but nonetheless still

469
00:19:25,500 --> 00:19:31,590
interesting so you know it's basically

470
00:19:29,549 --> 00:19:33,030
what is it is<font color="#CCCCCC"> it has like it's like a</font>

471
00:19:31,590 --> 00:19:36,840
filter right it's always like a whole

472
00:19:33,030 --> 00:19:39,360
bunch of<font color="#E5E5E5"> URLs and like known URLs that</font>

473
00:19:36,840 --> 00:19:41,309
are hosting like malware and<font color="#E5E5E5"> you know if</font>

474
00:19:39,360 --> 00:19:43,350
a user get to get an email with a link

475
00:19:41,309 --> 00:19:45,030
that it's known to be hosted with

476
00:19:43,350 --> 00:19:46,469
malware if you click it this<font color="#CCCCCC"> Smart</font>

477
00:19:45,030 --> 00:19:48,270
<font color="#CCCCCC">Protection</font><font color="#E5E5E5"> so will be smart and</font>

478
00:19:46,470 --> 00:19:49,860
intercept it and be<font color="#CCCCCC"> like hey it's Mel</font>

479
00:19:48,270 --> 00:19:52,770
we're so

480
00:19:49,860 --> 00:19:54,449
basically the function of the software<font color="#E5E5E5"> I</font>

481
00:19:52,770 --> 00:19:56,970
actually only learned that like half an

482
00:19:54,450 --> 00:19:58,470
hour<font color="#CCCCCC"> ago by the way like so I just</font>

483
00:19:56,970 --> 00:20:00,929
<font color="#E5E5E5">looked at the code and like talking</font>

484
00:19:58,470 --> 00:20:03,510
about<font color="#CCCCCC"> the new students yeah and</font><font color="#E5E5E5"> so it's</font>

485
00:20:00,929 --> 00:20:06,299
you know good old classic PHP and apache

486
00:20:03,510 --> 00:20:09,540
so<font color="#E5E5E5"> it's sometimes my favorite type of</font>

487
00:20:06,299 --> 00:20:11,549
<font color="#CCCCCC">God to look for there's</font><font color="#E5E5E5"> like lots of a</font>

488
00:20:09,540 --> 00:20:12,990
tax service but they sort<font color="#E5E5E5"> of I guess by</font>

489
00:20:11,549 --> 00:20:15,030
the time they developed this software

490
00:20:12,990 --> 00:20:16,830
they they sort<font color="#E5E5E5"> of cleaned up a lot of</font>

491
00:20:15,030 --> 00:20:18,840
<font color="#E5E5E5">the the vulnerabilities a lot of by the</font>

492
00:20:16,830 --> 00:20:21,360
time I got to<font color="#E5E5E5"> this so I've only found</font>

493
00:20:18,840 --> 00:20:24,449
like three command addictions and<font color="#CCCCCC"> and</font>

494
00:20:21,360 --> 00:20:26,100
stuff and a couple of really simple

495
00:20:24,450 --> 00:20:27,840
frillies escalations which it's just

496
00:20:26,100 --> 00:20:30,780
like kind<font color="#E5E5E5"> of embarrassing i guess but</font>

497
00:20:27,840 --> 00:20:31,889
you know nonetheless and the<font color="#E5E5E5"> java code</font>

498
00:20:30,780 --> 00:20:33,899
base was actually<font color="#CCCCCC"> quite good because</font>

499
00:20:31,890 --> 00:20:37,110
they did it like a lot of parameterised

500
00:20:33,900 --> 00:20:38,880
SQL and they were checking<font color="#E5E5E5"> for like if</font>

501
00:20:37,110 --> 00:20:40,979
they did do a command in the<font color="#E5E5E5"> code</font><font color="#CCCCCC"> that</font>

502
00:20:38,880 --> 00:20:43,350
was really like checking for that like

503
00:20:40,980 --> 00:20:44,940
for malicious strings and things it was

504
00:20:43,350 --> 00:20:48,418
all white listed and stuff so it was

505
00:20:44,940 --> 00:20:50,370
like yeah I'm<font color="#E5E5E5"> not getting past that so</font>

506
00:20:48,419 --> 00:20:53,910
the approach though installing it was a

507
00:20:50,370 --> 00:20:55,229
bit ghetto so basically like we couldn't

508
00:20:53,910 --> 00:20:57,630
<font color="#E5E5E5">get a license ride and I don't like</font><font color="#CCCCCC"> to</font>

509
00:20:55,230 --> 00:21:01,440
pay for software I'm testing it just

510
00:20:57,630 --> 00:21:03,270
because so you know we we download patch

511
00:21:01,440 --> 00:21:04,740
files and can't install the patch and

512
00:21:03,270 --> 00:21:07,200
blah blah blah so we could<font color="#CCCCCC"> really</font><font color="#E5E5E5"> just</font>

513
00:21:04,740 --> 00:21:08,760
<font color="#CCCCCC">like modify the patch file or like</font>

514
00:21:07,200 --> 00:21:10,620
whatever<font color="#E5E5E5"> and then run the installer and</font>

515
00:21:08,760 --> 00:21:11,850
then remove<font color="#E5E5E5"> all the version detection</font>

516
00:21:10,620 --> 00:21:13,709
and things like that and<font color="#CCCCCC"> the license</font>

517
00:21:11,850 --> 00:21:15,750
check and then<font color="#E5E5E5"> it will just override all</font>

518
00:21:13,710 --> 00:21:18,540
<font color="#CCCCCC">the other files and dump all the PHP or</font>

519
00:21:15,750 --> 00:21:19,740
or Java or whatever it is because<font color="#E5E5E5"> we</font>

520
00:21:18,540 --> 00:21:21,149
really<font color="#CCCCCC"> we're like in this particular</font>

521
00:21:19,740 --> 00:21:23,280
case<font color="#CCCCCC"> which is like focusing on the code</font>

522
00:21:21,150 --> 00:21:25,890
so much not so much like the environment

523
00:21:23,280 --> 00:21:27,389
what have you and yeah we use an old

524
00:21:25,890 --> 00:21:29,429
vulnerability to pop a shell to be able

525
00:21:27,390 --> 00:21:32,160
<font color="#E5E5E5">to patch it</font><font color="#CCCCCC"> and then you know we're all</font>

526
00:21:29,429 --> 00:21:34,309
<font color="#E5E5E5">good again so so this is just a simple</font>

527
00:21:32,160 --> 00:21:37,169
one like this was actually introduced in

528
00:21:34,309 --> 00:21:39,200
one of their patches so I find that

529
00:21:37,169 --> 00:21:41,160
quite ironic actually but nonetheless

530
00:21:39,200 --> 00:21:43,140
I'm not<font color="#E5E5E5"> sure if you guys can see that</font>

531
00:21:41,160 --> 00:21:44,850
but yeah it was basically<font color="#CCCCCC"> just a simple</font>

532
00:21:43,140 --> 00:21:46,980
get request with<font color="#E5E5E5"> a command injection</font>

533
00:21:44,850 --> 00:21:50,790
there's<font color="#CCCCCC"> nothing like amazing but it was</font>

534
00:21:46,980 --> 00:21:52,049
postal so you know like<font color="#CCCCCC"> uh we didn't</font>

535
00:21:50,790 --> 00:21:53,879
actually find an old bypass for this

536
00:21:52,049 --> 00:21:56,129
product but I think we will come back to

537
00:21:53,880 --> 00:21:59,130
this and like look for go hard and<font color="#E5E5E5"> look</font>

538
00:21:56,130 --> 00:22:00,929
for like a decent off bypass and yeah

539
00:21:59,130 --> 00:22:02,730
pops a simple shell and then there's a

540
00:22:00,929 --> 00:22:03,330
couple<font color="#E5E5E5"> of like privilege escalation</font>

541
00:22:02,730 --> 00:22:06,390
vulnerabilities

542
00:22:03,330 --> 00:22:09,689
right there were simple ones it was like

543
00:22:06,390 --> 00:22:12,630
you know in<font color="#E5E5E5"> the icy local file there was</font>

544
00:22:09,690 --> 00:22:14,400
a<font color="#CCCCCC"> couple of web service user writable</font>

545
00:22:12,630 --> 00:22:16,470
files that we can<font color="#E5E5E5"> just write commands in</font>

546
00:22:14,400 --> 00:22:18,330
and wait for the box to reboot or

547
00:22:16,470 --> 00:22:21,660
whatever and then execute code as root

548
00:22:18,330 --> 00:22:25,169
or commanders route you know simple

549
00:22:21,660 --> 00:22:26,880
stuff you know and<font color="#E5E5E5"> also this was the</font><font color="#CCCCCC"> icy</font>

550
00:22:25,170 --> 00:22:28,800
local there was two different files in

551
00:22:26,880 --> 00:22:31,080
there that was you<font color="#CCCCCC"> know web server owned</font>

552
00:22:28,800 --> 00:22:33,629
and writable so we just like leverage

553
00:22:31,080 --> 00:22:34,919
those and also<font color="#CCCCCC"> in the crontab they kind</font>

554
00:22:33,630 --> 00:22:37,680
of screwed out that that was like<font color="#CCCCCC"> really</font>

555
00:22:34,920 --> 00:22:40,080
simple stuff and we were just like<font color="#CCCCCC"> okay</font>

556
00:22:37,680 --> 00:22:42,540
guys oh and<font color="#E5E5E5"> your kernel is like miles</font>

557
00:22:40,080 --> 00:22:46,110
behind by the way so we<font color="#E5E5E5"> were like I</font>

558
00:22:42,540 --> 00:22:48,240
don't know and yeah like pop some like

559
00:22:46,110 --> 00:22:51,209
root cells very simply so you know it

560
00:22:48,240 --> 00:22:52,770
<font color="#E5E5E5">was if we when we come back to this</font>

561
00:22:51,210 --> 00:22:54,570
product it<font color="#E5E5E5"> will be like focusing on off</font>

562
00:22:52,770 --> 00:22:55,889
bypass and then we go past all the old

563
00:22:54,570 --> 00:22:59,189
stuff and look for all the critical

564
00:22:55,890 --> 00:23:01,500
<font color="#E5E5E5">postal thugs like command injection code</font>

565
00:22:59,190 --> 00:23:04,110
execution you wouldn't<font color="#CCCCCC"> call that</font><font color="#E5E5E5"> fun</font>

566
00:23:01,500 --> 00:23:06,200
<font color="#CCCCCC">stuff oh yeah you can see like the</font>

567
00:23:04,110 --> 00:23:11,340
kernel version there like I was like

568
00:23:06,200 --> 00:23:14,250
yeah they give up on that<font color="#CCCCCC"> stuff um so</font>

569
00:23:11,340 --> 00:23:15,780
you know like<font color="#E5E5E5"> I said we'll come back to</font>

570
00:23:14,250 --> 00:23:17,190
this but<font color="#E5E5E5"> we you know is riddled with</font>

571
00:23:15,780 --> 00:23:18,420
like exercise and stuff but like you

572
00:23:17,190 --> 00:23:21,330
know I'm<font color="#E5E5E5"> not gonna really report that</font>

573
00:23:18,420 --> 00:23:23,040
you know they<font color="#CCCCCC"> can figure that one out</font>

574
00:23:21,330 --> 00:23:26,689
like we're looking for more critical

575
00:23:23,040 --> 00:23:28,889
issues so that type of things so and

576
00:23:26,690 --> 00:23:30,780
this was actually<font color="#E5E5E5"> like I said it was</font>

577
00:23:28,890 --> 00:23:34,020
introduced in a patch so he kind of its

578
00:23:30,780 --> 00:23:35,160
kind of gave us a gauge or like how

579
00:23:34,020 --> 00:23:36,990
other future products will<font color="#CCCCCC"> be</font>

580
00:23:35,160 --> 00:23:38,400
introducing skewed issues and patches

581
00:23:36,990 --> 00:23:39,630
were like okay this could be good for us

582
00:23:38,400 --> 00:23:41,760
we could keep ordering the other

583
00:23:39,630 --> 00:23:44,130
software and hopefully we get<font color="#E5E5E5"> something</font>

584
00:23:41,760 --> 00:23:45,480
out of it so like I said the result had

585
00:23:44,130 --> 00:23:48,330
to conclude was too i'm going to this

586
00:23:45,480 --> 00:23:50,700
particular target but nonetheless they

587
00:23:48,330 --> 00:23:53,850
patched it and we got we got we're an

588
00:23:50,700 --> 00:23:58,140
iceberg so it's cool i'm partial to

589
00:23:53,850 --> 00:23:59,909
<font color="#E5E5E5">roberto now for the next one</font><font color="#CCCCCC"> thanks</font><font color="#E5E5E5"> the</font>

590
00:23:58,140 --> 00:24:02,160
<font color="#E5E5E5">loss prevention is and other products we</font>

591
00:23:59,910 --> 00:24:05,880
targeted and when we started the

592
00:24:02,160 --> 00:24:08,070
research was not end of lives now its

593
00:24:05,880 --> 00:24:10,110
end of life maybe we contributed to kill

594
00:24:08,070 --> 00:24:11,610
it perhaps I wouldn't know I think we

595
00:24:10,110 --> 00:24:13,560
sent like a hundred vulnerabilities in

596
00:24:11,610 --> 00:24:15,360
this target and I think they they

597
00:24:13,560 --> 00:24:16,840
started trying<font color="#E5E5E5"> to patch them and then</font>

598
00:24:15,360 --> 00:24:19,750
they're like actually guys I think we

599
00:24:16,840 --> 00:24:22,959
end of life like this one and<font color="#E5E5E5"> that was</font>

600
00:24:19,750 --> 00:24:25,900
it now I was like ah ah guys like a wave

601
00:24:22,960 --> 00:24:28,960
this is to be fair with the end of life

602
00:24:25,900 --> 00:24:31,029
there<font color="#CCCCCC"> ok so what is it data loss</font>

603
00:24:28,960 --> 00:24:33,669
prevention I'm sure you heard about it's

604
00:24:31,029 --> 00:24:34,900
typical the product that you put your

605
00:24:33,669 --> 00:24:37,990
enterprise network to avoid any

606
00:24:34,900 --> 00:24:39,520
intellectual property theft or any data

607
00:24:37,990 --> 00:24:41,650
loss so you want to control your

608
00:24:39,520 --> 00:24:44,408
employees<font color="#CCCCCC"> and the documents whatever</font>

609
00:24:41,650 --> 00:24:47,620
<font color="#E5E5E5">they use and avoid that this documents</font>

610
00:24:44,409 --> 00:24:50,080
leaked out of the organization and so on

611
00:24:47,620 --> 00:24:52,120
<font color="#CCCCCC">so it's an appliance and it works with</font>

612
00:24:50,080 --> 00:24:55,120
them it's a server and there is also

613
00:24:52,120 --> 00:24:56,709
some client agent components which is

614
00:24:55,120 --> 00:24:58,989
the interesting<font color="#E5E5E5"> part and when we did</font>

615
00:24:56,710 --> 00:25:01,510
this research<font color="#E5E5E5"> and of course the agent</font>

616
00:24:58,990 --> 00:25:04,179
server works on the workstation so the

617
00:25:01,510 --> 00:25:05,950
agent is responsible for analyzing

618
00:25:04,179 --> 00:25:08,350
parsing all the files in the documents

619
00:25:05,950 --> 00:25:10,779
and<font color="#E5E5E5"> then sending that information back</font>

620
00:25:08,350 --> 00:25:12,580
to<font color="#E5E5E5"> the server the server on the other</font>

621
00:25:10,779 --> 00:25:15,370
side as the policy contains all the

622
00:25:12,580 --> 00:25:17,110
policies so you can say<font color="#CCCCCC"> ok only once I</font>

623
00:25:15,370 --> 00:25:19,959
don't want any credit<font color="#E5E5E5"> cards to leak out</font>

624
00:25:17,110 --> 00:25:22,240
on my network so basically that policies

625
00:25:19,960 --> 00:25:24,250
then pushed through the agents and the

626
00:25:22,240 --> 00:25:26,950
agents then check if there's any credit

627
00:25:24,250 --> 00:25:29,529
<font color="#CCCCCC">card data inside and if there is and is</font>

628
00:25:26,950 --> 00:25:31,899
<font color="#E5E5E5">going out</font><font color="#CCCCCC"> it will be blocked and then</font>

629
00:25:29,529 --> 00:25:34,990
report will be generated inside the deal

630
00:25:31,899 --> 00:25:37,080
p web interface with a nice graph and so

631
00:25:34,990 --> 00:25:40,840
on<font color="#E5E5E5"> so this is</font><font color="#CCCCCC"> the typical enterprise</font>

632
00:25:37,080 --> 00:25:42,908
security product and there was previous

633
00:25:40,840 --> 00:25:44,980
recruited research on these projects i

634
00:25:42,909 --> 00:25:47,399
think it was wearing a<font color="#E5E5E5"> Def Con idea no</font>

635
00:25:44,980 --> 00:25:50,320
black hat last year and the<font color="#CCCCCC"> year before</font>

636
00:25:47,399 --> 00:25:52,299
they like identified some scripting

637
00:25:50,320 --> 00:25:53,889
stuff yeah they found other type of

638
00:25:52,299 --> 00:25:55,840
phone abilities so it was<font color="#CCCCCC"> very</font>

639
00:25:53,890 --> 00:25:59,289
interesting to resume mostly previous

640
00:25:55,840 --> 00:26:02,649
research and see how far we could go<font color="#CCCCCC"> the</font>

641
00:25:59,289 --> 00:26:04,450
thing is<font color="#CCCCCC"> i mentioned about agent the</font>

642
00:26:02,649 --> 00:26:06,189
agent software is also including at the

643
00:26:04,450 --> 00:26:10,419
third party software which is give you

644
00:26:06,190 --> 00:26:13,450
and we will see in a moment so how does

645
00:26:10,419 --> 00:26:15,490
the hood we<font color="#E5E5E5"> have tomcat web intuitive</font>

646
00:26:13,450 --> 00:26:17,980
interface which is listing a certain

647
00:26:15,490 --> 00:26:20,020
part we<font color="#CCCCCC"> have a demon which is listening</font>

648
00:26:17,980 --> 00:26:23,260
for the agents to connect and<font color="#CCCCCC"> then send</font>

649
00:26:20,020 --> 00:26:26,350
the information and and then we also

650
00:26:23,260 --> 00:26:29,080
have another another service which is

651
00:26:26,350 --> 00:26:30,080
listening and this is also<font color="#E5E5E5"> used by</font>

652
00:26:29,080 --> 00:26:31,668
another compound

653
00:26:30,080 --> 00:26:34,850
which is called remote curler and I'm

654
00:26:31,669 --> 00:26:38,090
going to<font color="#E5E5E5"> go in this in a moment the</font>

655
00:26:34,850 --> 00:26:40,490
clients software is key view as I said

656
00:26:38,090 --> 00:26:42,649
it's a it's a component that he will

657
00:26:40,490 --> 00:26:44,720
introduce later on but it's responsible

658
00:26:42,649 --> 00:26:48,699
for parsing and extracting information

659
00:26:44,720 --> 00:26:52,010
from the files on the operating<font color="#E5E5E5"> system</font>

660
00:26:48,700 --> 00:26:55,190
so terms of statistical manual abilities

661
00:26:52,010 --> 00:26:59,690
they were at<font color="#E5E5E5"> least I think 42 that lead</font>

662
00:26:55,190 --> 00:27:03,110
to remote code execution and 26 of which

663
00:26:59,690 --> 00:27:05,120
<font color="#E5E5E5">without justification and so on we're</font>

664
00:27:03,110 --> 00:27:07,340
going<font color="#E5E5E5"> to cover three of them of</font><font color="#CCCCCC"> course</font>

665
00:27:05,120 --> 00:27:09,260
<font color="#E5E5E5">we cannot cover all of them but what are</font>

666
00:27:07,340 --> 00:27:11,870
we are selecting the most<font color="#E5E5E5"> critical and</font>

667
00:27:09,260 --> 00:27:15,500
most<font color="#E5E5E5"> interesting ones we found that</font>

668
00:27:11,870 --> 00:27:17,840
along the<font color="#CCCCCC"> way and one of the approach as</font>

669
00:27:15,500 --> 00:27:20,450
coming back to the testing approach part

670
00:27:17,840 --> 00:27:22,908
for this product<font color="#E5E5E5"> in particular was to</font>

671
00:27:20,450 --> 00:27:25,610
basically run into locally go inside

672
00:27:22,909 --> 00:27:27,769
<font color="#CCCCCC">check the services check</font><font color="#E5E5E5"> the service</font>

673
00:27:25,610 --> 00:27:30,559
location when they run extract all the

674
00:27:27,769 --> 00:27:33,320
source code import the source code into

675
00:27:30,559 --> 00:27:35,980
an ID like net wins or eclipse<font color="#E5E5E5"> study the</font>

676
00:27:33,320 --> 00:27:38,720
code and so on the other thing which we

677
00:27:35,980 --> 00:27:41,389
basically did was to go through the web

678
00:27:38,720 --> 00:27:43,159
interface and one of the points as a

679
00:27:41,389 --> 00:27:46,010
tester when you I<font color="#CCCCCC"> mean</font><font color="#E5E5E5"> for people here</font>

680
00:27:43,159 --> 00:27:47,870
testing is that you<font color="#E5E5E5"> really need</font><font color="#CCCCCC"> to use</font>

681
00:27:46,010 --> 00:27:50,179
<font color="#CCCCCC">the application I</font><font color="#E5E5E5"> suppose to use at the</font>

682
00:27:47,870 --> 00:27:53,090
beginning just to get as much effects<font color="#E5E5E5"> of</font>

683
00:27:50,179 --> 00:27:54,919
surface out and one other<font color="#E5E5E5"> thing</font><font color="#CCCCCC"> we</font>

684
00:27:53,090 --> 00:27:57,260
notice is that you can download<font color="#E5E5E5"> a remote</font>

685
00:27:54,919 --> 00:27:59,149
crawler component which is<font color="#E5E5E5"> an additional</font>

686
00:27:57,260 --> 00:28:01,070
<font color="#E5E5E5">component that optionally you can run</font>

687
00:27:59,149 --> 00:28:03,018
against the<font color="#E5E5E5"> agent and actually in that</font>

688
00:28:01,070 --> 00:28:05,149
component if we found on interesting

689
00:28:03,019 --> 00:28:07,220
monolithic which we introduced in a

690
00:28:05,149 --> 00:28:11,928
moment but this is just to show<font color="#E5E5E5"> you guys</font>

691
00:28:07,220 --> 00:28:13,970
and that basically you sometimes<font color="#E5E5E5"> you</font>

692
00:28:11,929 --> 00:28:15,889
<font color="#E5E5E5">have that icon there you don't want</font><font color="#CCCCCC"> to</font>

693
00:28:13,970 --> 00:28:18,139
click and because you're lazy or you're

694
00:28:15,889 --> 00:28:20,870
<font color="#E5E5E5">going too fast but sometimes being</font>

695
00:28:18,139 --> 00:28:26,059
curious helps and you want to try out as

696
00:28:20,870 --> 00:28:27,830
much<font color="#E5E5E5"> as functionality as possible the</font>

697
00:28:26,059 --> 00:28:30,200
first one ability we're gonna introduce

698
00:28:27,830 --> 00:28:33,230
is actually related to this component

699
00:28:30,200 --> 00:28:37,340
here the<font color="#CCCCCC"> your</font><font color="#E5E5E5"> remote rural agent it's</font>

700
00:28:33,230 --> 00:28:39,980
about<font color="#E5E5E5"> java and civilization and this is</font>

701
00:28:37,340 --> 00:28:42,720
interesting because when we<font color="#E5E5E5"> run the</font>

702
00:28:39,980 --> 00:28:44,700
remote crawler we

703
00:28:42,720 --> 00:28:46,500
before we took a molar approach so we

704
00:28:44,700 --> 00:28:48,000
analyze everything with the moment we

705
00:28:46,500 --> 00:28:49,860
<font color="#E5E5E5">click something with running Wireshark</font>

706
00:28:48,000 --> 00:28:51,809
with nixing with trying<font color="#E5E5E5"> to see what we</font>

707
00:28:49,860 --> 00:28:54,178
was doing we're using these internal

708
00:28:51,809 --> 00:28:56,850
tools to map and some so one<font color="#E5E5E5"> of the</font>

709
00:28:54,179 --> 00:28:59,940
thing we notice is that I don't<font color="#CCCCCC"> know how</font>

710
00:28:56,850 --> 00:29:02,219
much you<font color="#E5E5E5"> can see but basically we notice</font>

711
00:28:59,940 --> 00:29:05,429
that he goes here the<font color="#E5E5E5"> DL pick rollers</font>

712
00:29:02,220 --> 00:29:07,559
are in walker on 8080 this is clear text

713
00:29:05,429 --> 00:29:09,690
okay and then what we notice here there

714
00:29:07,559 --> 00:29:12,539
is<font color="#CCCCCC"> nothing</font><font color="#E5E5E5"> about authentication either</font>

715
00:29:09,690 --> 00:29:14,490
nothing<font color="#E5E5E5"> about session cooking but what</font>

716
00:29:12,539 --> 00:29:17,400
is interesting is all the java objects

717
00:29:14,490 --> 00:29:21,539
<font color="#E5E5E5">here so the first thing that strikes to</font>

718
00:29:17,400 --> 00:29:23,309
mine is maybe this<font color="#E5E5E5"> data is will be</font>

719
00:29:21,539 --> 00:29:26,039
answer you alized and if<font color="#CCCCCC"> that is the</font>

720
00:29:23,309 --> 00:29:29,010
case then<font color="#E5E5E5"> we can basically leverage that</font>

721
00:29:26,039 --> 00:29:32,190
and of course has been previous research

722
00:29:29,010 --> 00:29:34,650
on<font color="#CCCCCC"> German theorization attacks and tools</font>

723
00:29:32,190 --> 00:29:37,230
like why so serious or make way very

724
00:29:34,650 --> 00:29:41,600
easy to create payloads which will then

725
00:29:37,230 --> 00:29:41,600
trigger the code execution<font color="#CCCCCC"> degrees to</font>

726
00:29:42,049 --> 00:29:45,500
serve a signal

727
00:29:47,510 --> 00:29:50,510
karamba

728
00:29:54,859 --> 00:30:04,789
<font color="#E5E5E5">to the bottom dink sorry sorry guys hang</font>

729
00:30:00,959 --> 00:30:04,789
on he's running he's running a team

730
00:30:14,160 --> 00:30:20,429
which this is kind of

731
00:30:39,770 --> 00:30:41,830
you

732
00:30:44,980 --> 00:30:55,330
oh nothing is coming back its back<font color="#E5E5E5"> okay</font>

733
00:30:52,450 --> 00:30:56,559
yeah<font color="#E5E5E5"> let's continue yeah we got a kind</font>

734
00:30:55,330 --> 00:30:59,168
of speed<font color="#E5E5E5"> reading because we got still</font>

735
00:30:56,559 --> 00:31:00,490
<font color="#CCCCCC">our</font><font color="#E5E5E5"> slides and less time so</font><font color="#CCCCCC"> core so I</font>

736
00:30:59,169 --> 00:31:02,590
want to thank me notice there is no

737
00:31:00,490 --> 00:31:04,210
education so on you can use<font color="#E5E5E5"> why so</font>

738
00:31:02,590 --> 00:31:06,668
cereal so we embedded everything

739
00:31:04,210 --> 00:31:09,940
together with right so CL to create<font color="#E5E5E5"> the</font>

740
00:31:06,669 --> 00:31:13,720
exploit any works the<font color="#CCCCCC"> thing which we</font>

741
00:31:09,940 --> 00:31:15,880
notice also that piece<font color="#CCCCCC"> is gonna be</font><font color="#E5E5E5"> t</font>

742
00:31:13,720 --> 00:31:18,610
actually whatever the remote crawler was

743
00:31:15,880 --> 00:31:22,090
connecting back to the server that code

744
00:31:18,610 --> 00:31:24,879
is<font color="#E5E5E5"> running as a system on windows so</font>

745
00:31:22,090 --> 00:31:30,399
there was a way to get unauthenticated

746
00:31:24,880 --> 00:31:34,690
<font color="#CCCCCC">code execution</font><font color="#E5E5E5"> as a system level still</font>

747
00:31:30,400 --> 00:31:38,410
of its own<font color="#E5E5E5"> okay I need to add me to look</font>

748
00:31:34,690 --> 00:31:39,910
here now so this is<font color="#E5E5E5"> where the bag was</font>

749
00:31:38,410 --> 00:31:43,299
found and you see the get object

750
00:31:39,910 --> 00:31:46,090
involved and this is basically<font color="#E5E5E5"> the get</font>

751
00:31:43,299 --> 00:31:50,820
object which will do though will be cold

752
00:31:46,090 --> 00:31:53,409
once the done serialization happens and

753
00:31:50,820 --> 00:31:55,080
this is where the fun of it is you can

754
00:31:53,410 --> 00:31:58,780
see<font color="#CCCCCC"> the eight-year here and the same</font>

755
00:31:55,080 --> 00:32:04,530
same coloring book right there<font color="#E5E5E5"> that we</font>

756
00:31:58,780 --> 00:32:04,530
saw in<font color="#E5E5E5"> the previous can we go back</font>

757
00:32:05,700 --> 00:32:17,830
nothing is working<font color="#E5E5E5"> okay yeah yeah</font>

758
00:32:13,929 --> 00:32:19,660
natural<font color="#E5E5E5"> okay yeah yeah so you know like</font>

759
00:32:17,830 --> 00:32:21,790
<font color="#CCCCCC">angry shell is like pretty</font><font color="#E5E5E5"> much like</font>

760
00:32:19,660 --> 00:32:24,100
that's the example that<font color="#CCCCCC"> we</font><font color="#E5E5E5"> just</font>

761
00:32:21,790 --> 00:32:26,470
explained let's go from this video's

762
00:32:24,100 --> 00:32:28,090
yeah yeah a little bit of<font color="#E5E5E5"> time so the</font>

763
00:32:26,470 --> 00:32:30,910
analyticals cross-site scripting this is

764
00:32:28,090 --> 00:32:32,678
another one ability we found as we said

765
00:32:30,910 --> 00:32:34,000
before without user interaction it's

766
00:32:32,679 --> 00:32:36,040
actually without user interaction

767
00:32:34,000 --> 00:32:38,110
normally crisis continues and the link

768
00:32:36,040 --> 00:32:40,960
so you require user interaction that the

769
00:32:38,110 --> 00:32:43,540
user has to click and so on in this case

770
00:32:40,960 --> 00:32:46,360
basically it's it's different and this

771
00:32:43,540 --> 00:32:50,049
moon ability was quite was quite

772
00:32:46,360 --> 00:32:51,699
interesting I want to thing which we

773
00:32:50,049 --> 00:32:54,129
<font color="#CCCCCC">notice</font><font color="#E5E5E5"> when we look into this is that</font>

774
00:32:51,700 --> 00:32:55,900
the agent whatever the<font color="#E5E5E5"> agents running on</font>

775
00:32:54,130 --> 00:32:58,210
the workstation connects the server and

776
00:32:55,900 --> 00:32:58,720
of course when he connects he sent some

777
00:32:58,210 --> 00:33:01,720
data

778
00:32:58,720 --> 00:33:05,980
like for instance computer name and so

779
00:33:01,720 --> 00:33:07,870
on the connection<font color="#CCCCCC"> between the agents and</font>

780
00:33:05,980 --> 00:33:10,000
the server is encrypted so one part of

781
00:33:07,870 --> 00:33:11,530
<font color="#E5E5E5">our search was to basically decrypt that</font>

782
00:33:10,000 --> 00:33:14,260
connection there was also some

783
00:33:11,530 --> 00:33:18,428
certificate pinning embedded in the<font color="#E5E5E5"> Indy</font>

784
00:33:14,260 --> 00:33:23,260
agent so we didn't<font color="#E5E5E5"> have the private key</font>

785
00:33:18,429 --> 00:33:24,909
to open the certificate and then<font color="#CCCCCC"> use the</font>

786
00:33:23,260 --> 00:33:27,370
white shark with the certificate and<font color="#E5E5E5"> so</font>

787
00:33:24,909 --> 00:33:29,799
on<font color="#E5E5E5"> so one of the approach we took it was</font>

788
00:33:27,370 --> 00:33:32,709
to use API monitor and I'm<font color="#CCCCCC"> basically</font>

789
00:33:29,799 --> 00:33:34,750
identify which libraries were using to

790
00:33:32,710 --> 00:33:38,409
do<font color="#CCCCCC"> the ssl encryption and decryption and</font>

791
00:33:34,750 --> 00:33:42,150
then we<font color="#E5E5E5"> just said hooks on this AP is in</font>

792
00:33:38,409 --> 00:33:45,909
this particular case we saw that<font color="#E5E5E5"> the</font>

793
00:33:42,150 --> 00:33:49,330
this the acetylene cricket<font color="#E5E5E5"> dysfunction</font>

794
00:33:45,909 --> 00:33:53,110
was inside the encrypt dll and actually

795
00:33:49,330 --> 00:33:55,270
by<font color="#CCCCCC"> hooking all these calls before the</font>

796
00:33:53,110 --> 00:33:59,260
packets will be encrypted so in memory

797
00:33:55,270 --> 00:34:02,379
<font color="#CCCCCC">we could see the clear pockets before</font>

798
00:33:59,260 --> 00:34:04,510
passed to the function<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> this gave us</font>

799
00:34:02,380 --> 00:34:09,129
a lot<font color="#CCCCCC"> of information we see that this is</font>

800
00:34:04,510 --> 00:34:12,730
most likely proprietary protocol by

801
00:34:09,129 --> 00:34:15,399
trends and then we hear some clear text

802
00:34:12,730 --> 00:34:17,619
information basically<font color="#CCCCCC"> we studied this</font>

803
00:34:15,399 --> 00:34:20,199
protocol we study all the different

804
00:34:17,619 --> 00:34:22,780
communication and that that basically

805
00:34:20,199 --> 00:34:24,339
led to find this vulnerability one of

806
00:34:22,780 --> 00:34:26,649
the things<font color="#CCCCCC"> you</font><font color="#E5E5E5"> notice here is computer</font>

807
00:34:24,339 --> 00:34:28,290
name and you see it's<font color="#CCCCCC"> just after year so</font>

808
00:34:26,649 --> 00:34:31,388
if you respect to all these think that's

809
00:34:28,290 --> 00:34:33,759
basically our exploit<font color="#E5E5E5"> was to basically</font>

810
00:34:31,389 --> 00:34:35,740
put something process getting payload

811
00:34:33,760 --> 00:34:37,540
right there and basically we notice that

812
00:34:35,739 --> 00:34:39,879
whatever<font color="#E5E5E5"> computer name will be rendered</font>

813
00:34:37,540 --> 00:34:42,730
<font color="#E5E5E5">in different pages of the administrative</font>

814
00:34:39,879 --> 00:34:44,739
interface now of course<font color="#CCCCCC"> if you want to</font>

815
00:34:42,730 --> 00:34:47,830
use if you want<font color="#CCCCCC"> to use the product you</font>

816
00:34:44,739 --> 00:34:49,689
<font color="#E5E5E5">will log in certain point in time and</font>

817
00:34:47,830 --> 00:34:51,750
when you do you<font color="#CCCCCC"> will you will get the</font>

818
00:34:49,690 --> 00:34:54,310
<font color="#E5E5E5">process skating so it's stored</font>

819
00:34:51,750 --> 00:34:57,250
unauthenticated because the agent is

820
00:34:54,310 --> 00:34:59,440
only sending this information but here

821
00:34:57,250 --> 00:35:00,670
again there is<font color="#E5E5E5"> nothing which is using</font>

822
00:34:59,440 --> 00:35:03,250
there is no<font color="#CCCCCC"> username</font><font color="#E5E5E5"> there is no</font>

823
00:35:00,670 --> 00:35:05,619
password no credentials<font color="#E5E5E5"> non owns nothing</font>

824
00:35:03,250 --> 00:35:09,520
this can be replayed as we speak<font color="#CCCCCC"> the</font>

825
00:35:05,619 --> 00:35:11,650
<font color="#E5E5E5">only thing is to go through an SSL</font>

826
00:35:09,520 --> 00:35:12,109
tunnel and he has to go through directly

827
00:35:11,650 --> 00:35:15,099
to the

828
00:35:12,109 --> 00:35:19,848
<font color="#E5E5E5">okay because of the</font><font color="#CCCCCC"> certificate pinning</font>

829
00:35:15,099 --> 00:35:21,589
and you see 11 screeched up appearing

830
00:35:19,849 --> 00:35:23,269
the agent management so if the

831
00:35:21,589 --> 00:35:27,940
administrator goes to check the agent

832
00:35:23,269 --> 00:35:27,939
status it will be it will be affected

833
00:35:29,109 --> 00:35:34,848
this is where some of the there were

834
00:35:33,079 --> 00:35:40,369
actually two<font color="#CCCCCC"> process getting</font><font color="#E5E5E5"> this is one</font>

835
00:35:34,849 --> 00:35:44,299
and basically was when this Jason rapert

836
00:35:40,369 --> 00:35:46,670
function was called basically the UCR

837
00:35:44,299 --> 00:35:48,950
the variant here when the Gatling<font color="#CCCCCC"> UL</font>

838
00:35:46,670 --> 00:35:52,009
also is called you see her that<font color="#E5E5E5"> is</font>

839
00:35:48,950 --> 00:35:54,288
creating the the HTML content basically

840
00:35:52,009 --> 00:35:58,369
some of the parameters that are passed

841
00:35:54,289 --> 00:36:02,359
to this that are here basically<font color="#E5E5E5"> appended</font>

842
00:35:58,369 --> 00:36:04,099
to this URL link basically contained the

843
00:36:02,359 --> 00:36:07,848
crosses<font color="#CCCCCC"> keating and then you could</font>

844
00:36:04,099 --> 00:36:10,160
escape<font color="#E5E5E5"> from the load href function here</font>

845
00:36:07,849 --> 00:36:12,079
so that's why<font color="#CCCCCC"> i was able</font><font color="#E5E5E5"> to get</font><font color="#CCCCCC"> the</font>

846
00:36:10,160 --> 00:36:13,368
process getting in there so<font color="#CCCCCC"> i</font><font color="#E5E5E5"> was quite</font>

847
00:36:12,079 --> 00:36:15,049
interesting it's not<font color="#CCCCCC"> that</font><font color="#E5E5E5"> standard</font>

848
00:36:13,369 --> 00:36:17,180
process<font color="#E5E5E5"> kinky that you find we had to</font>

849
00:36:15,049 --> 00:36:20,210
understand how the<font color="#E5E5E5"> agent works</font><font color="#CCCCCC"> injecting</font>

850
00:36:17,180 --> 00:36:23,210
<font color="#CCCCCC">to a traffic and then the thing is the</font>

851
00:36:20,210 --> 00:36:25,309
agent it doesn't register there is no

852
00:36:23,210 --> 00:36:27,440
registration process between the agent

853
00:36:25,309 --> 00:36:28,430
<font color="#E5E5E5">and the server so they are the</font>

854
00:36:27,440 --> 00:36:30,710
vulnerabilities we are not discussing

855
00:36:28,430 --> 00:36:33,710
but basically anyone from an IP address

856
00:36:30,710 --> 00:36:36,529
which has connectivity to the server can

857
00:36:33,710 --> 00:36:38,239
register itself as a as an agent the<font color="#CCCCCC"> the</font>

858
00:36:36,529 --> 00:36:40,880
most important point that it tolls the

859
00:36:38,239 --> 00:36:42,529
right protocol and once it provides the

860
00:36:40,880 --> 00:36:48,200
right protocol then<font color="#E5E5E5"> the server will just</font>

861
00:36:42,529 --> 00:36:50,779
blindly trust that it's an agent I was a

862
00:36:48,200 --> 00:36:54,019
scholar we just covered that give you

863
00:36:50,779 --> 00:36:56,299
you get combat disk ok so another

864
00:36:54,019 --> 00:36:57,709
component that the software had actually

865
00:36:56,299 --> 00:37:00,799
was like<font color="#E5E5E5"> this component called cave you</font>

866
00:36:57,710 --> 00:37:02,420
and you know<font color="#CCCCCC"> it said after a little</font><font color="#E5E5E5"> bit</font>

867
00:37:00,799 --> 00:37:03,559
of googling with fans we saw that

868
00:37:02,420 --> 00:37:05,599
there's some vulnerabilities and it kind

869
00:37:03,559 --> 00:37:07,910
of got interesting and we realized it

870
00:37:05,599 --> 00:37:10,400
like past like 205<font color="#CCCCCC"> fullmetal more</font><font color="#E5E5E5"> I was</font>

871
00:37:07,910 --> 00:37:14,210
like oh my<font color="#E5E5E5"> goodness this is going to be</font>

872
00:37:10,400 --> 00:37:16,309
bad so you know and then the remote

873
00:37:14,210 --> 00:37:18,349
crawler actually does that<font color="#E5E5E5"> does the</font>

874
00:37:16,309 --> 00:37:20,989
passing itself and runs a system so we

875
00:37:18,349 --> 00:37:24,920
were like okay so file passing 200-plus

876
00:37:20,989 --> 00:37:26,690
formats running a system sounds bad

877
00:37:24,920 --> 00:37:27,980
so the<font color="#E5E5E5"> first thing we wanted to do</font><font color="#CCCCCC"> is</font>

878
00:37:26,690 --> 00:37:30,230
work out how we're going to actually

879
00:37:27,980 --> 00:37:31,940
test it because the remote crawler would

880
00:37:30,230 --> 00:37:34,520
just pick up<font color="#E5E5E5"> a file in a directory on</font>

881
00:37:31,940 --> 00:37:36,650
basic based on a rule as part of the DLP

882
00:37:34,520 --> 00:37:38,120
solution and there will run a scan over

883
00:37:36,650 --> 00:37:41,150
it look for whatever string that's

884
00:37:38,120 --> 00:37:42,290
looking for so we're looking<font color="#E5E5E5"> for we're</font>

885
00:37:41,150 --> 00:37:44,060
looking for binaries that we could just

886
00:37:42,290 --> 00:37:46,130
<font color="#E5E5E5">pass the file format directly and to be</font>

887
00:37:44,060 --> 00:37:48,170
able to automatically test it preferably

888
00:37:46,130 --> 00:37:50,540
<font color="#CCCCCC">something on the command line right and</font>

889
00:37:48,170 --> 00:37:53,660
we<font color="#E5E5E5"> eventually found something that like</font>

890
00:37:50,540 --> 00:37:55,670
like filter exe and<font color="#E5E5E5"> it calls this</font>

891
00:37:53,660 --> 00:37:57,980
function down here and then<font color="#CCCCCC"> it's like</font>

892
00:37:55,670 --> 00:38:03,200
<font color="#E5E5E5">it's listed here and basically</font><font color="#CCCCCC"> its</font>

893
00:37:57,980 --> 00:38:06,110
passing key key view filter dll which

894
00:38:03,200 --> 00:38:09,230
which then does all the loading for each

895
00:38:06,110 --> 00:38:11,510
particular file format dll so that was a

896
00:38:09,230 --> 00:38:13,400
nice way entry into testing the

897
00:38:11,510 --> 00:38:15,860
application we didn't even have to write

898
00:38:13,400 --> 00:38:18,350
up a stand-alone exe to be<font color="#CCCCCC"> able to test</font>

899
00:38:15,860 --> 00:38:22,490
the dll the passing we just used one of

900
00:38:18,350 --> 00:38:24,080
<font color="#E5E5E5">their own d levels nice so it was very</font>

901
00:38:22,490 --> 00:38:26,240
simple with like you know command line

902
00:38:24,080 --> 00:38:27,380
here buzz file and then there's an

903
00:38:26,240 --> 00:38:30,080
output file right because it does a

904
00:38:27,380 --> 00:38:32,660
conversion and it converts to something

905
00:38:30,080 --> 00:38:34,460
so<font color="#CCCCCC"> I</font><font color="#E5E5E5"> just put junk and you know</font>

906
00:38:32,660 --> 00:38:37,430
literally like wild one bars forever

907
00:38:34,460 --> 00:38:39,080
type seeing and I do a lot<font color="#E5E5E5"> of like file</font>

908
00:38:37,430 --> 00:38:41,210
format fuzzing anyway so like I have a

909
00:38:39,080 --> 00:38:43,970
lot of corpses that I've developed<font color="#E5E5E5"> or</font>

910
00:38:41,210 --> 00:38:47,360
built using my own tool sets and stuff

911
00:38:43,970 --> 00:38:49,730
so we had it like a lot of very mind you

912
00:38:47,360 --> 00:38:51,940
like covers a lot of code base very

913
00:38:49,730 --> 00:38:56,570
targeted file sets already ready<font color="#E5E5E5"> to go</font>

914
00:38:51,940 --> 00:38:58,160
so it was pretty free / had so one of

915
00:38:56,570 --> 00:38:59,960
the<font color="#E5E5E5"> the only one will talk</font><font color="#CCCCCC"> about today</font>

916
00:38:58,160 --> 00:39:01,520
<font color="#CCCCCC">is this one</font><font color="#E5E5E5"> is because</font><font color="#CCCCCC"> it's still I</font>

917
00:38:59,960 --> 00:39:03,290
think<font color="#E5E5E5"> it still zero day in the key view</font>

918
00:39:01,520 --> 00:39:06,170
so any other component you<font color="#CCCCCC"> can</font><font color="#E5E5E5"> keep you</font>

919
00:39:03,290 --> 00:39:08,210
this baggage to live yeah we tested<font color="#CCCCCC"> it</font>

920
00:39:06,170 --> 00:39:10,900
on some other products which put up with

921
00:39:08,210 --> 00:39:14,090
it Mike I think you can she be fair<font color="#E5E5E5"> okay</font>

922
00:39:10,900 --> 00:39:16,130
<font color="#E5E5E5">happy so if</font><font color="#CCCCCC"> your view there yeah this</font>

923
00:39:14,090 --> 00:39:17,750
<font color="#E5E5E5">year also vulnerable to this yeah so</font>

924
00:39:16,130 --> 00:39:19,880
it's<font color="#E5E5E5"> like a stack overflow we went</font>

925
00:39:17,750 --> 00:39:22,280
passing RTF files i think it was<font color="#CCCCCC"> in the</font>

926
00:39:19,880 --> 00:39:24,110
the font table tag so<font color="#E5E5E5"> if</font><font color="#CCCCCC"> we broke out of</font>

927
00:39:22,280 --> 00:39:28,190
<font color="#E5E5E5">the font table tag you get a</font><font color="#CCCCCC"> sec</font>

928
00:39:24,110 --> 00:39:31,130
<font color="#CCCCCC">overflow and yeah it was pretty simple I</font>

929
00:39:28,190 --> 00:39:34,880
think I we smashed the stack<font color="#CCCCCC"> and</font>

930
00:39:31,130 --> 00:39:36,440
everything like that and yeah it was it

931
00:39:34,880 --> 00:39:38,720
what was interesting about it was the

932
00:39:36,440 --> 00:39:40,250
fact<font color="#E5E5E5"> that the actual overflow</font>

933
00:39:38,720 --> 00:39:41,419
use the data<font color="#CCCCCC"> from the actual</font><font color="#E5E5E5"> phone</font>

934
00:39:40,250 --> 00:39:43,490
itself obviously because<font color="#CCCCCC"> it was in the</font>

935
00:39:41,420 --> 00:39:45,349
tag at<font color="#CCCCCC"> the start tags or when you close</font>

936
00:39:43,490 --> 00:39:47,779
it off it'll<font color="#E5E5E5"> use the rest of the data</font>

937
00:39:45,349 --> 00:39:50,240
from the actual embedded font which is

938
00:39:47,780 --> 00:39:52,609
<font color="#E5E5E5">just like hex values all ready for you</font>

939
00:39:50,240 --> 00:39:55,160
in it so I could just like modify that

940
00:39:52,609 --> 00:39:59,840
and like gain control of things and that

941
00:39:55,160 --> 00:40:02,060
sounds bad but yeah and like it was more

942
00:39:59,840 --> 00:40:05,330
<font color="#CCCCCC">or less a situation where it was very</font>

943
00:40:02,060 --> 00:40:09,109
simple<font color="#CCCCCC"> to exploit you know we didn't</font>

944
00:40:05,330 --> 00:40:12,799
have like a SLR<font color="#CCCCCC"> seh or stack cookies or</font>

945
00:40:09,109 --> 00:40:15,140
anything so I was like I don't<font color="#CCCCCC"> know</font><font color="#E5E5E5"> okay</font>

946
00:40:12,800 --> 00:40:16,730
and you know it<font color="#E5E5E5"> can be used by a</font><font color="#CCCCCC"> kid</font>

947
00:40:15,140 --> 00:40:18,379
drive-by download right like Google

948
00:40:16,730 --> 00:40:20,119
Chrome or something like you download

949
00:40:18,380 --> 00:40:21,800
automatically you got a<font color="#E5E5E5"> dlp a solution</font>

950
00:40:20,119 --> 00:40:25,400
rule that picks up a downloads file

951
00:40:21,800 --> 00:40:28,520
scans the file triggers stack overflow

952
00:40:25,400 --> 00:40:30,800
in a system process yeah like it was

953
00:40:28,520 --> 00:40:32,150
kind of bad<font color="#E5E5E5"> I honestly like think I</font>

954
00:40:30,800 --> 00:40:33,710
think I whipped up this in like 10

955
00:40:32,150 --> 00:40:37,040
minutes or something I<font color="#E5E5E5"> don't know and</font>

956
00:40:33,710 --> 00:40:40,070
pops calcs and stuff and yeah so you

957
00:40:37,040 --> 00:40:42,020
know and with 200<font color="#E5E5E5"> plus file formats I</font>

958
00:40:40,070 --> 00:40:44,480
honestly<font color="#CCCCCC"> I lost track of how many</font>

959
00:40:42,020 --> 00:40:46,580
vulnerabilities we found in this after

960
00:40:44,480 --> 00:40:48,050
<font color="#E5E5E5">after they we just told</font><font color="#CCCCCC"> the send us an</font>

961
00:40:46,580 --> 00:40:49,580
email saying okay we're going<font color="#E5E5E5"> to end up</font>

962
00:40:48,050 --> 00:40:52,339
like this product we were like okay

963
00:40:49,580 --> 00:40:56,029
<font color="#E5E5E5">whatever just like just pretend like we</font>

964
00:40:52,339 --> 00:40:57,140
didn't find these or something yeah and

965
00:40:56,030 --> 00:40:59,450
<font color="#E5E5E5">then we'll move on to the control</font>

966
00:40:57,140 --> 00:41:01,160
manager this one was an interesting

967
00:40:59,450 --> 00:41:02,359
target sorry if<font color="#E5E5E5"> I'm going a little bit</font>

968
00:41:01,160 --> 00:41:04,069
fast because we were running at a time

969
00:41:02,359 --> 00:41:06,830
so<font color="#E5E5E5"> I just wanna make sure we covered</font>

970
00:41:04,070 --> 00:41:08,089
some content this was kind<font color="#E5E5E5"> of like the</font>

971
00:41:06,830 --> 00:41:09,619
heart of<font color="#CCCCCC"> chain market products right</font>

972
00:41:08,089 --> 00:41:12,440
like a lot of their other products would

973
00:41:09,619 --> 00:41:14,300
connect to<font color="#E5E5E5"> this and it would like offer</font>

974
00:41:12,440 --> 00:41:17,390
controls off to the other products<font color="#E5E5E5"> and</font>

975
00:41:14,300 --> 00:41:19,430
<font color="#E5E5E5">things like that and sort of and in that</font>

976
00:41:17,390 --> 00:41:21,859
<font color="#E5E5E5">case it was really just like</font><font color="#CCCCCC"> a huge</font>

977
00:41:19,430 --> 00:41:23,660
attack surface as well and it had<font color="#CCCCCC"> like a</font>

978
00:41:21,859 --> 00:41:28,580
lot<font color="#E5E5E5"> of different</font><font color="#CCCCCC"> components</font><font color="#E5E5E5"> integrated</font>

979
00:41:23,660 --> 00:41:30,049
you had<font color="#E5E5E5"> is PHP ASP compiled code I mean</font>

980
00:41:28,580 --> 00:41:31,848
you name it really much had it i think

981
00:41:30,050 --> 00:41:34,730
<font color="#E5E5E5">it even had</font><font color="#CCCCCC"> java somewhere I was just</font>

982
00:41:31,849 --> 00:41:38,420
<font color="#E5E5E5">like guys this is a security nightmare</font>

983
00:41:34,730 --> 00:41:41,210
um you know like lots of lots of

984
00:41:38,420 --> 00:41:43,880
vulnerabilities in it but more so again

985
00:41:41,210 --> 00:41:46,490
<font color="#E5E5E5">running like one good thing i will say</font>

986
00:41:43,880 --> 00:41:48,440
about this<font color="#E5E5E5"> actually is the</font><font color="#CCCCCC"> a lot of</font>

987
00:41:46,490 --> 00:41:50,149
privileges like the database was running

988
00:41:48,440 --> 00:41:52,549
<font color="#E5E5E5">as like a low privilege and things like</font>

989
00:41:50,150 --> 00:41:54,349
that<font color="#CCCCCC"> so getting if you did get shell</font>

990
00:41:52,549 --> 00:41:57,019
are you running as low privilege I is

991
00:41:54,349 --> 00:42:00,319
<font color="#CCCCCC">use our or the database network service</font>

992
00:41:57,019 --> 00:42:02,359
thingy and so it's okay so it's<font color="#CCCCCC"> not as</font>

993
00:42:00,319 --> 00:42:06,499
bad you know you can<font color="#E5E5E5"> still do things</font>

994
00:42:02,359 --> 00:42:09,140
obviously so and one<font color="#E5E5E5"> of the motivations</font>

995
00:42:06,499 --> 00:42:13,578
was actually our God he's<font color="#E5E5E5"> probably</font>

996
00:42:09,140 --> 00:42:16,900
watching this<font color="#E5E5E5"> so anyway um this is like</font>

997
00:42:13,579 --> 00:42:19,670
a body found in like 2016 like last year

998
00:42:16,900 --> 00:42:22,459
in it some PHP component I was like okay

999
00:42:19,670 --> 00:42:25,039
cool I like PHP and this software has

1000
00:42:22,459 --> 00:42:26,538
PHP<font color="#E5E5E5"> okay let's do that</font><font color="#CCCCCC"> and so</font><font color="#E5E5E5"> I decided</font>

1001
00:42:25,039 --> 00:42:30,829
<font color="#E5E5E5">to start looking that's kind of like the</font>

1002
00:42:26,539 --> 00:42:33,019
motivation behind it so we'll<font color="#E5E5E5"> talk about</font>

1003
00:42:30,829 --> 00:42:35,089
a<font color="#E5E5E5"> couple of the bugs but this one was</font>

1004
00:42:33,019 --> 00:42:36,769
probably the one of the most interesting

1005
00:42:35,089 --> 00:42:38,479
<font color="#CCCCCC">ones because it was pre authenticated</font>

1006
00:42:36,769 --> 00:42:41,328
and it gave us the ability to bypass the

1007
00:42:38,479 --> 00:42:44,689
authentication so it was a blind SQL

1008
00:42:41,329 --> 00:42:48,589
injection like pretty<font color="#CCCCCC"> much standard SQL</font>

1009
00:42:44,689 --> 00:42:49,999
injection and it was cut it<font color="#CCCCCC"> was it was</font>

1010
00:42:48,589 --> 00:42:51,920
time based so it was kind of hard to

1011
00:42:49,999 --> 00:42:53,569
detect I guess it was only you could

1012
00:42:51,920 --> 00:42:54,890
only do time based and allows for

1013
00:42:53,569 --> 00:42:56,689
attackers of<font color="#CCCCCC"> Steel hashes and things</font>

1014
00:42:54,890 --> 00:43:00,379
like that no sessions were stored in the

1015
00:42:56,689 --> 00:43:02,029
database as far as I remember but<font color="#E5E5E5"> at</font>

1016
00:43:00,380 --> 00:43:03,709
first I thought<font color="#E5E5E5"> okay go to crack the</font>

1017
00:43:02,029 --> 00:43:05,059
password that's kind<font color="#E5E5E5"> of crappy you have</font>

1018
00:43:03,709 --> 00:43:07,609
to crack the hash and all these kind of

1019
00:43:05,059 --> 00:43:08,929
fun stuff not so fun actually but then I

1020
00:43:07,609 --> 00:43:10,219
and then I realized that<font color="#E5E5E5"> it's</font><font color="#CCCCCC"> got like a</font>

1021
00:43:08,929 --> 00:43:11,900
pass the hash vulnerability and i love

1022
00:43:10,219 --> 00:43:13,579
these types of bugs because it's like

1023
00:43:11,900 --> 00:43:15,049
something that developers like overlooks

1024
00:43:13,579 --> 00:43:16,519
and they're like you can log in with a

1025
00:43:15,049 --> 00:43:18,140
hash and it's like well what's the point

1026
00:43:16,519 --> 00:43:20,479
<font color="#CCCCCC">of hashing things if you can log in with</font>

1027
00:43:18,140 --> 00:43:22,879
a hash so it<font color="#E5E5E5"> turns out that that worked</font>

1028
00:43:20,479 --> 00:43:25,519
and so<font color="#E5E5E5"> if basically you can steal that</font>

1029
00:43:22,880 --> 00:43:27,650
hash login and get us get<font color="#E5E5E5"> it</font>

1030
00:43:25,519 --> 00:43:29,839
authenticated session cookie eating and

1031
00:43:27,650 --> 00:43:31,459
then<font color="#CCCCCC"> we can use that to reach all the</font>

1032
00:43:29,839 --> 00:43:34,339
other vulnerabilities like we we talked

1033
00:43:31,459 --> 00:43:37,879
about this was disclosed as ed is 17 Oh

1034
00:43:34,339 --> 00:43:40,189
74 and we could have chained that with

1035
00:43:37,880 --> 00:43:41,869
all<font color="#CCCCCC"> the other bugs so basically this was</font>

1036
00:43:40,189 --> 00:43:44,629
like my little simple proof of concept

1037
00:43:41,869 --> 00:43:47,390
it would just detect the target it was

1038
00:43:44,630 --> 00:43:49,160
vulnerable still the admin hash<font color="#CCCCCC"> log in</font>

1039
00:43:47,390 --> 00:43:51,348
with<font color="#CCCCCC"> the no cracking and then just</font><font color="#E5E5E5"> get</font>

1040
00:43:49,160 --> 00:43:53,058
an akita cookie and then we<font color="#E5E5E5"> could take</font>

1041
00:43:51,349 --> 00:43:55,339
<font color="#CCCCCC">that cookie and go ahead and use it</font>

1042
00:43:53,059 --> 00:43:56,689
against<font color="#E5E5E5"> other other vulnerabilities and</font>

1043
00:43:55,339 --> 00:43:58,999
for<font color="#CCCCCC"> example this was another</font>

1044
00:43:56,689 --> 00:44:00,709
vulnerability<font color="#E5E5E5"> and then you could just</font>

1045
00:43:58,999 --> 00:44:02,060
<font color="#E5E5E5">like do another SQL injection and this</font>

1046
00:44:00,709 --> 00:44:03,680
one would execute commands

1047
00:44:02,060 --> 00:44:06,080
and then we could just do that and then

1048
00:44:03,680 --> 00:44:08,390
yeah the<font color="#E5E5E5"> actual actually the first one</font>

1049
00:44:06,080 --> 00:44:09,710
it was kind of weird actually I still

1050
00:44:08,390 --> 00:44:12,290
don't quite know why I haven't<font color="#E5E5E5"> really</font>

1051
00:44:09,710 --> 00:44:14,540
looked into it but this<font color="#CCCCCC"> one you couldn't</font>

1052
00:44:12,290 --> 00:44:16,730
actually execute commands from it for

1053
00:44:14,540 --> 00:44:18,920
some reason I think<font color="#E5E5E5"> I think I stuffed up</font>

1054
00:44:16,730 --> 00:44:20,840
my query but you're probably could but I

1055
00:44:18,920 --> 00:44:22,970
couldn't get command execution from it

1056
00:44:20,840 --> 00:44:24,380
initially so but then there was lots<font color="#E5E5E5"> of</font>

1057
00:44:22,970 --> 00:44:26,330
other bugs to get command execution from

1058
00:44:24,380 --> 00:44:30,130
so it was all good and then you know

1059
00:44:26,330 --> 00:44:33,830
<font color="#CCCCCC">that executors network service so yeah</font>

1060
00:44:30,130 --> 00:44:35,510
so we could combine the bugs you know

1061
00:44:33,830 --> 00:44:37,250
and<font color="#E5E5E5"> get some sort of like an</font>

1062
00:44:35,510 --> 00:44:38,720
authenticator code execution initially

1063
00:44:37,250 --> 00:44:40,610
and then probably we can find like a

1064
00:44:38,720 --> 00:44:42,680
posted a privilege escalation or

1065
00:44:40,610 --> 00:44:44,030
something even like another trend micro

1066
00:44:42,680 --> 00:44:46,970
kernel driver or something and just<font color="#E5E5E5"> like</font>

1067
00:44:44,030 --> 00:44:48,650
<font color="#E5E5E5">you know get like system or something we</font>

1068
00:44:46,970 --> 00:44:50,299
didn't go that far because we were just

1069
00:44:48,650 --> 00:44:53,060
<font color="#CCCCCC">looking</font><font color="#E5E5E5"> for the initial point in and</font>

1070
00:44:50,300 --> 00:44:54,620
then that was that was it<font color="#E5E5E5"> okay if we got</font>

1071
00:44:53,060 --> 00:44:56,720
system we got system if we got<font color="#E5E5E5"> root we</font>

1072
00:44:54,620 --> 00:45:02,420
got really if<font color="#E5E5E5"> we got network service its</font>

1073
00:44:56,720 --> 00:45:04,069
network service so yeah also another

1074
00:45:02,420 --> 00:45:09,230
another<font color="#E5E5E5"> thing another bug we found was</font>

1075
00:45:04,070 --> 00:45:11,900
this this PHP file actually this mod

1076
00:45:09,230 --> 00:45:15,470
deal p template match<font color="#E5E5E5"> drill down thingy</font>

1077
00:45:11,900 --> 00:45:17,390
it they had a lot of this PHP code was

1078
00:45:15,470 --> 00:45:19,819
replicated in multiple file on multiple

1079
00:45:17,390 --> 00:45:21,920
folders so they would have<font color="#CCCCCC"> like a mean</font>

1080
00:45:19,820 --> 00:45:24,230
mini PHP application in one folder and

1081
00:45:21,920 --> 00:45:25,940
the same application in another folder

1082
00:45:24,230 --> 00:45:27,200
so if there was a vulnerability in this

1083
00:45:25,940 --> 00:45:29,120
particular application is going<font color="#CCCCCC"> to be in</font>

1084
00:45:27,200 --> 00:45:30,290
this one and then this one so then they

1085
00:45:29,120 --> 00:45:32,720
would just<font color="#CCCCCC"> like replicate their own</font>

1086
00:45:30,290 --> 00:45:34,460
vulnerabilities in their own product so

1087
00:45:32,720 --> 00:45:37,459
there will be like three cases<font color="#CCCCCC"> of this</font>

1088
00:45:34,460 --> 00:45:41,600
one bug because<font color="#E5E5E5"> you know they replicate</font>

1089
00:45:37,460 --> 00:45:43,430
vulnerabilities and this was<font color="#E5E5E5"> i forget i</font>

1090
00:45:41,600 --> 00:45:45,049
think this<font color="#E5E5E5"> was a file inclusion there's</font>

1091
00:45:43,430 --> 00:45:47,210
like a local file inclusion but I could

1092
00:45:45,050 --> 00:45:49,190
you know<font color="#E5E5E5"> even with modern PHP you can</font>

1093
00:45:47,210 --> 00:45:51,560
obviously still get code execution from

1094
00:45:49,190 --> 00:45:55,370
that so we wrote exploit for that and

1095
00:45:51,560 --> 00:45:59,299
yeah yeah and there's a show and thing

1096
00:45:55,370 --> 00:46:00,650
so we're only III user from<font color="#E5E5E5"> I is so we'd</font>

1097
00:45:59,300 --> 00:46:02,780
<font color="#E5E5E5">have to find</font><font color="#CCCCCC"> another bug to get root</font>

1098
00:46:00,650 --> 00:46:06,080
because that's crappy user account sir

1099
00:46:02,780 --> 00:46:07,700
you know all good and then we we had

1100
00:46:06,080 --> 00:46:09,950
some success with that<font color="#E5E5E5"> one and yeah we</font>

1101
00:46:07,700 --> 00:46:11,750
found like lots of lots of bugs with

1102
00:46:09,950 --> 00:46:13,520
that so is it<font color="#CCCCCC"> CD</font><font color="#E5E5E5"> I did a really good job</font>

1103
00:46:11,750 --> 00:46:15,170
in<font color="#CCCCCC"> like sending</font><font color="#E5E5E5"> the reports off the</font>

1104
00:46:13,520 --> 00:46:16,970
trend micro and getting them patched

1105
00:46:15,170 --> 00:46:18,859
that actually<font color="#E5E5E5"> helped us a lot in terms</font>

1106
00:46:16,970 --> 00:46:19,848
of dealing with<font color="#E5E5E5"> the vendor and things</font>

1107
00:46:18,859 --> 00:46:21,290
like that we probably wouldn't have gone

1108
00:46:19,849 --> 00:46:23,720
as<font color="#CCCCCC"> far with the research had we not had</font>

1109
00:46:21,290 --> 00:46:26,180
that simply<font color="#CCCCCC"> because of the motivator</font>

1110
00:46:23,720 --> 00:46:28,759
obviously behind it and also we don't

1111
00:46:26,180 --> 00:46:30,230
<font color="#E5E5E5">have to deal with the vendor directly we</font>

1112
00:46:28,760 --> 00:46:34,970
don't have to you know try to clarify

1113
00:46:30,230 --> 00:46:37,730
things etc etc<font color="#CCCCCC"> so we'll move on quickly</font>

1114
00:46:34,970 --> 00:46:42,049
to interests can this<font color="#E5E5E5"> one was another</font>

1115
00:46:37,730 --> 00:46:43,549
another interesting target this one<font color="#CCCCCC"> in</font>

1116
00:46:42,049 --> 00:46:47,829
<font color="#CCCCCC">specs</font><font color="#E5E5E5"> web traffic</font><font color="#CCCCCC"> ants</font><font color="#E5E5E5"> like known</font>

1117
00:46:43,549 --> 00:46:49,970
patterns you know<font color="#CCCCCC"> Antonella</font><font color="#E5E5E5"> where URL</font>

1118
00:46:47,829 --> 00:46:52,760
reputation and things like that so<font color="#E5E5E5"> it</font>

1119
00:46:49,970 --> 00:46:56,328
was it was had somewhat similar to smart

1120
00:46:52,760 --> 00:46:58,640
smart<font color="#CCCCCC"> section</font><font color="#E5E5E5"> server it implements</font><font color="#CCCCCC"> trust</font>

1121
00:46:56,329 --> 00:47:01,819
two frameworks so lots of straps code in

1122
00:46:58,640 --> 00:47:03,980
Java which was kind of a right and we

1123
00:47:01,819 --> 00:47:06,558
found<font color="#E5E5E5"> it like a lot of bugs in that to a</font>

1124
00:47:03,980 --> 00:47:08,450
lot of previous bugs to in<font color="#E5E5E5"> in the</font>

1125
00:47:06,559 --> 00:47:09,619
previous year were found in<font color="#E5E5E5"> this or at</font>

1126
00:47:08,450 --> 00:47:11,779
least some of them<font color="#E5E5E5"> were found in the</font>

1127
00:47:09,619 --> 00:47:13,250
previous year so I<font color="#E5E5E5"> was interested to</font>

1128
00:47:11,780 --> 00:47:15,650
look at the patch for that and see<font color="#E5E5E5"> like</font>

1129
00:47:13,250 --> 00:47:20,690
how we could like maybe bypass the patch

1130
00:47:15,650 --> 00:47:23,650
for that and yeah so this was like the

1131
00:47:20,690 --> 00:47:27,109
patch initially initially for those

1132
00:47:23,650 --> 00:47:28,910
previous RC vulnerabilities and it was

1133
00:47:27,109 --> 00:47:35,270
like you know an escape parameter seeing

1134
00:47:28,910 --> 00:47:37,940
and it took some some characters and

1135
00:47:35,270 --> 00:47:39,950
then he tried to<font color="#CCCCCC"> escape them it was kind</font>

1136
00:47:37,940 --> 00:47:42,859
<font color="#CCCCCC">of like a witch the blacklist it's</font>

1137
00:47:39,950 --> 00:47:45,740
<font color="#E5E5E5">pretty simple so who's you know I like</font>

1138
00:47:42,859 --> 00:47:47,960
escape the escape right you know just

1139
00:47:45,740 --> 00:47:49,689
like it<font color="#E5E5E5"> was kind of embarrassing against</font>

1140
00:47:47,960 --> 00:47:52,460
the trend micro but I could<font color="#E5E5E5"> just like</font>

1141
00:47:49,690 --> 00:47:55,010
escape what they are escape and<font color="#CCCCCC"> then</font>

1142
00:47:52,460 --> 00:47:59,349
like still do my back teeth fun and<font color="#E5E5E5"> then</font>

1143
00:47:55,010 --> 00:48:01,730
like<font color="#E5E5E5"> execute commands yeah as root so</font>

1144
00:47:59,349 --> 00:48:04,010
you know and we miss some bugs you know

1145
00:48:01,730 --> 00:48:07,220
that's<font color="#E5E5E5"> how it goes sometimes and Cora</font>

1146
00:48:04,010 --> 00:48:09,020
logics found a couple of<font color="#E5E5E5"> our CS but you</font>

1147
00:48:07,220 --> 00:48:10,819
know which we try to be really sharp and

1148
00:48:09,020 --> 00:48:15,349
look at every every single entry point

1149
00:48:10,819 --> 00:48:17,029
right so we're going to cover the the

1150
00:48:15,349 --> 00:48:20,510
most critical one of this one which was

1151
00:48:17,030 --> 00:48:22,520
the do mount<font color="#CCCCCC"> post</font><font color="#E5E5E5"> do post mount device</font>

1152
00:48:20,510 --> 00:48:24,440
but this was kind<font color="#E5E5E5"> of interesting this is</font>

1153
00:48:22,520 --> 00:48:28,369
in<font color="#E5E5E5"> their rest api interface and part of</font>

1154
00:48:24,440 --> 00:48:29,119
<font color="#E5E5E5">the struts that's good you could reach</font>

1155
00:48:28,369 --> 00:48:32,210
it via the

1156
00:48:29,119 --> 00:48:36,470
mount device<font color="#CCCCCC"> in point it would it look</font>

1157
00:48:32,210 --> 00:48:38,869
some Jason and via the post body request

1158
00:48:36,470 --> 00:48:41,660
and you can see there it's pulling a

1159
00:48:38,869 --> 00:48:45,980
string mount device and then it's

1160
00:48:41,660 --> 00:48:47,509
passing to this UI x exe you I helper

1161
00:48:45,980 --> 00:48:49,339
command and that kind of lowers like oh

1162
00:48:47,509 --> 00:48:53,029
that looks interesting you<font color="#E5E5E5"> know</font>

1163
00:48:49,339 --> 00:48:56,509
naturally what does that do and then it

1164
00:48:53,029 --> 00:48:58,880
passes it posit to another creates like

1165
00:48:56,509 --> 00:49:01,160
a<font color="#CCCCCC"> string with this interesting string</font>

1166
00:48:58,880 --> 00:49:02,690
here and pass it to exe commander I was

1167
00:49:01,160 --> 00:49:05,569
like oh what does the ex-king man

1168
00:49:02,690 --> 00:49:08,779
command do and then obviously that turns

1169
00:49:05,569 --> 00:49:11,058
out to be well not<font color="#CCCCCC"> quite good thing an</font>

1170
00:49:08,779 --> 00:49:13,549
extra commands and you know if<font color="#E5E5E5"> you</font>

1171
00:49:11,059 --> 00:49:14,990
remember this this kind of string looked

1172
00:49:13,549 --> 00:49:17,690
interesting as well so<font color="#CCCCCC"> we'll talk about</font>

1173
00:49:14,990 --> 00:49:20,689
<font color="#E5E5E5">that</font><font color="#CCCCCC"> in a sec but yeah and</font><font color="#E5E5E5"> it was pretty</font>

1174
00:49:17,690 --> 00:49:24,319
much game over at<font color="#E5E5E5"> that</font><font color="#CCCCCC"> point for code</font>

1175
00:49:20,690 --> 00:49:27,470
execution so you know and yeah like

1176
00:49:24,319 --> 00:49:29,900
super concept was like this right so we

1177
00:49:27,470 --> 00:49:33,230
have<font color="#CCCCCC"> the bat kicks in we set the command</font>

1178
00:49:29,900 --> 00:49:34,999
<font color="#E5E5E5">mount and we try to mount this and using</font>

1179
00:49:33,230 --> 00:49:37,309
this command and then it would get code

1180
00:49:34,999 --> 00:49:40,788
execution and authenticated so but as

1181
00:49:37,309 --> 00:49:44,059
root user so it was basically as bad as

1182
00:49:40,789 --> 00:49:46,279
a get but the patch was quite<font color="#CCCCCC"> good if we</font>

1183
00:49:44,059 --> 00:49:48,019
look at<font color="#E5E5E5"> the patch here the first thing</font>

1184
00:49:46,279 --> 00:49:52,489
it did was check to see if the<font color="#E5E5E5"> request</font>

1185
00:49:48,019 --> 00:49:55,609
was coming<font color="#E5E5E5"> from like</font><font color="#CCCCCC"> localhost so it's</font>

1186
00:49:52,489 --> 00:49:58,099
not that's not<font color="#E5E5E5"> the ideal approach SSI RF</font>

1187
00:49:55,609 --> 00:50:00,109
can defeat this but you know it's it's

1188
00:49:58,099 --> 00:50:03,289
<font color="#CCCCCC">okay and then it does a validate user if</font>

1189
00:50:00,109 --> 00:50:05,239
it's not coming from localhost so the

1190
00:50:03,289 --> 00:50:09,920
second thing to notice was they call

1191
00:50:05,239 --> 00:50:11,900
this function is valid NAT device and

1192
00:50:09,920 --> 00:50:13,099
<font color="#CCCCCC">that was so that was kind of interesting</font>

1193
00:50:11,900 --> 00:50:15,049
<font color="#CCCCCC">and then we were like</font><font color="#E5E5E5"> okay what does</font>

1194
00:50:13,099 --> 00:50:17,690
that do and then<font color="#E5E5E5"> that just does like a</font>

1195
00:50:15,049 --> 00:50:20,779
string match check on<font color="#CCCCCC"> mount on this file</font>

1196
00:50:17,690 --> 00:50:22,489
and if it's<font color="#CCCCCC"> not it's not valid doesn't</font>

1197
00:50:20,779 --> 00:50:25,489
exist<font color="#E5E5E5"> and so like okay that's good</font>

1198
00:50:22,489 --> 00:50:29,150
that's a good patch you know good good

1199
00:50:25,489 --> 00:50:31,009
job guys so that was for that bug and

1200
00:50:29,150 --> 00:50:33,440
the UI help her if you remember<font color="#E5E5E5"> before</font>

1201
00:50:31,009 --> 00:50:35,029
in this<font color="#E5E5E5"> particular function it was like</font>

1202
00:50:33,440 --> 00:50:36,950
building up a string with his you I

1203
00:50:35,029 --> 00:50:39,589
helper it turns out that this<font color="#CCCCCC"> is</font><font color="#E5E5E5"> just a</font>

1204
00:50:36,950 --> 00:50:41,808
<font color="#CCCCCC">very simple</font><font color="#E5E5E5"> shebang wrapper that would</font>

1205
00:50:39,589 --> 00:50:45,109
like execute commands<font color="#E5E5E5"> as root</font>

1206
00:50:41,809 --> 00:50:48,049
it was su ID enabled and and seems like

1207
00:50:45,109 --> 00:50:49,910
dad's you<font color="#CCCCCC"> know we could just</font><font color="#E5E5E5"> call</font>

1208
00:50:48,049 --> 00:50:52,788
shebang and get a<font color="#CCCCCC"> rich shell out of that</font>

1209
00:50:49,910 --> 00:50:54,680
too so you know that was<font color="#E5E5E5"> bad a simple</font>

1210
00:50:52,789 --> 00:50:56,539
<font color="#CCCCCC">prive esque and then we had a whole</font>

1211
00:50:54,680 --> 00:50:58,009
bunch of stuff patched by that too so

1212
00:50:56,539 --> 00:50:59,509
they did a<font color="#CCCCCC"> really good job I mean I was</font>

1213
00:50:58,009 --> 00:51:00,650
<font color="#E5E5E5">really happy with that they checked the</font>

1214
00:50:59,509 --> 00:51:02,239
patch and you know they did a good job

1215
00:51:00,650 --> 00:51:05,569
this time it wasn't like the first time

1216
00:51:02,239 --> 00:51:06,949
so it was it was nice<font color="#CCCCCC"> and cool and we</font>

1217
00:51:05,569 --> 00:51:09,349
had an authentication bypass for<font color="#E5E5E5"> this</font>

1218
00:51:06,949 --> 00:51:12,079
product<font color="#CCCCCC"> as well</font><font color="#E5E5E5"> so all the all the all</font>

1219
00:51:09,349 --> 00:51:15,579
the rca's as root as post authenticated

1220
00:51:12,079 --> 00:51:19,910
could be reached<font color="#E5E5E5"> by this by this one off</font>

1221
00:51:15,579 --> 00:51:21,920
<font color="#E5E5E5">or bypass bugs so it was cool and we've</font>

1222
00:51:19,910 --> 00:51:23,058
got a demo going as well this<font color="#E5E5E5"> is this is</font>

1223
00:51:21,920 --> 00:51:24,559
<font color="#E5E5E5">not a live demo because we're running</font>

1224
00:51:23,059 --> 00:51:26,150
<font color="#CCCCCC">out of</font><font color="#E5E5E5"> time and so we thought we might</font>

1225
00:51:24,559 --> 00:51:28,880
but this basically it's just a little

1226
00:51:26,150 --> 00:51:31,039
<font color="#E5E5E5">proof concept that we've got and yeah we</font>

1227
00:51:28,880 --> 00:51:33,709
write the exploit for it and we set the

1228
00:51:31,039 --> 00:51:38,089
target and we pop a shell and its root

1229
00:51:33,709 --> 00:51:39,649
user right there so yeah it was very

1230
00:51:38,089 --> 00:51:43,910
<font color="#CCCCCC">simple the good thing about web bugs is</font>

1231
00:51:39,650 --> 00:51:48,859
it's like fast reliable and that kind of

1232
00:51:43,910 --> 00:51:55,279
thing so yeah pursuant<font color="#CCCCCC"> to Roberto first</font>

1233
00:51:48,859 --> 00:51:57,558
<font color="#E5E5E5">discovery</font><font color="#CCCCCC"> appliance</font><font color="#E5E5E5"> thanks</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> this one</font>

1234
00:51:55,279 --> 00:51:59,869
<font color="#E5E5E5">is another product and end-of-life</font>

1235
00:51:57,559 --> 00:52:01,789
actually i was still downloadable when

1236
00:51:59,869 --> 00:52:04,069
we start the research so probably they

1237
00:52:01,789 --> 00:52:06,679
decided for this time for real did to

1238
00:52:04,069 --> 00:52:11,660
kill it before we will investigate it

1239
00:52:06,679 --> 00:52:13,910
anyway<font color="#E5E5E5"> so it's another clients which was</font>

1240
00:52:11,660 --> 00:52:17,259
the purpose of<font color="#CCCCCC"> this was to basically</font>

1241
00:52:13,910 --> 00:52:20,390
<font color="#E5E5E5">monitor natural traffic and then match</font>

1242
00:52:17,259 --> 00:52:22,519
signature against trendmicro threat

1243
00:52:20,390 --> 00:52:24,679
intelligence and so on so<font color="#CCCCCC"> i was the</font>

1244
00:52:22,519 --> 00:52:27,999
typical morning network monitoring<font color="#E5E5E5"> tube</font>

1245
00:52:24,679 --> 00:52:30,709
that<font color="#E5E5E5"> you will deploy it now from the</font>

1246
00:52:27,999 --> 00:52:33,859
let's say testing perspective we had our

1247
00:52:30,709 --> 00:52:35,660
<font color="#CCCCCC">web interface and ssh not much so we</font>

1248
00:52:33,859 --> 00:52:37,969
concentrated all our focus against the

1249
00:52:35,660 --> 00:52:40,459
web<font color="#E5E5E5"> interface ed ssh there was nothing</font>

1250
00:52:37,969 --> 00:52:41,599
interesting and we<font color="#CCCCCC"> found 90 s command</font>

1251
00:52:40,459 --> 00:52:43,459
injection we're going to show you some

1252
00:52:41,599 --> 00:52:46,279
of the most<font color="#E5E5E5"> interesting on a bit you</font>

1253
00:52:43,459 --> 00:52:47,779
found which is the one I'm going<font color="#E5E5E5"> to</font>

1254
00:52:46,279 --> 00:52:50,900
<font color="#CCCCCC">introduce now directory traversal</font>

1255
00:52:47,779 --> 00:52:54,589
education bypass it was very interesting

1256
00:52:50,900 --> 00:52:58,160
<font color="#E5E5E5">and basically what we notice is that</font>

1257
00:52:54,589 --> 00:53:00,450
when you log on and then you log off

1258
00:52:58,160 --> 00:53:02,549
there was some changes at<font color="#CCCCCC"> the operating</font>

1259
00:53:00,450 --> 00:53:04,169
system level on the file system and

1260
00:53:02,549 --> 00:53:06,119
basically notice that under the VAR log

1261
00:53:04,170 --> 00:53:08,329
folder and you<font color="#E5E5E5"> had a folder with the</font>

1262
00:53:06,119 --> 00:53:11,280
same name<font color="#E5E5E5"> of the session ID and this</font>

1263
00:53:08,329 --> 00:53:14,069
folder gets deleted every time the log

1264
00:53:11,280 --> 00:53:16,140
of function was triggered so that was

1265
00:53:14,069 --> 00:53:19,740
quite interesting and of<font color="#CCCCCC"> course this</font>

1266
00:53:16,140 --> 00:53:22,109
conclusion came after analyzing<font color="#E5E5E5"> starting</font>

1267
00:53:19,740 --> 00:53:23,279
again come<font color="#E5E5E5"> back testing approach you do</font>

1268
00:53:22,109 --> 00:53:24,359
an action and when you want to

1269
00:53:23,280 --> 00:53:25,710
understand what's happening on the

1270
00:53:24,359 --> 00:53:28,970
operating<font color="#E5E5E5"> system at the side system</font>

1271
00:53:25,710 --> 00:53:31,799
level and so on<font color="#CCCCCC"> so we did a bit of</font>

1272
00:53:28,970 --> 00:53:34,859
adding some of the libraries so the

1273
00:53:31,799 --> 00:53:37,079
<font color="#E5E5E5">logoff function cooking is here called</font>

1274
00:53:34,859 --> 00:53:38,790
<font color="#CCCCCC">disbelief session which call system and</font>

1275
00:53:37,079 --> 00:53:41,160
this is very<font color="#E5E5E5"> interesting to investigate</font>

1276
00:53:38,790 --> 00:53:44,700
<font color="#CCCCCC">and see what what's</font><font color="#E5E5E5"> happening which kind</font>

1277
00:53:41,160 --> 00:53:48,328
of commands and basically just to put

1278
00:53:44,700 --> 00:53:51,118
all together you see that the session<font color="#E5E5E5"> ID</font>

1279
00:53:48,329 --> 00:53:54,119
is<font color="#E5E5E5"> the argument here is passed basically</font>

1280
00:53:51,119 --> 00:53:57,270
in this commandeer so it's removing that

1281
00:53:54,119 --> 00:53:58,349
folder<font color="#E5E5E5"> I just mentioned before so this</font>

1282
00:53:57,270 --> 00:53:59,790
is<font color="#E5E5E5"> quite</font><font color="#CCCCCC"> interesting we say ok let's</font>

1283
00:53:58,349 --> 00:54:01,440
let's try to<font color="#CCCCCC"> avoid the command</font>

1284
00:53:59,790 --> 00:54:04,259
injections right away there because we

1285
00:54:01,440 --> 00:54:08,640
have a<font color="#CCCCCC"> system so why not the problems</font>

1286
00:54:04,260 --> 00:54:12,410
<font color="#CCCCCC">that we realized is that just before</font><font color="#E5E5E5"> the</font>

1287
00:54:08,640 --> 00:54:15,598
beaner MMF it's called we have a next at

1288
00:54:12,410 --> 00:54:18,210
operation against so basically we can i

1289
00:54:15,599 --> 00:54:19,799
use you know illegal characters and so

1290
00:54:18,210 --> 00:54:22,619
on so<font color="#E5E5E5"> we couldn't</font><font color="#CCCCCC"> really find a way</font>

1291
00:54:19,799 --> 00:54:24,270
maybe someone is possible to<font color="#E5E5E5"> to find a</font>

1292
00:54:22,619 --> 00:54:26,670
way to escape but we couldn't find<font color="#E5E5E5"> this</font>

1293
00:54:24,270 --> 00:54:28,710
case so what we said<font color="#E5E5E5"> ok what can we do</font>

1294
00:54:26,670 --> 00:54:32,010
we can only delete we can't reverse

1295
00:54:28,710 --> 00:54:36,030
<font color="#E5E5E5">because we can use dot catalyst what can</font>

1296
00:54:32,010 --> 00:54:38,579
we do so that was a little bit of<font color="#CCCCCC"> poly</font>

1297
00:54:36,030 --> 00:54:40,829
resist on<font color="#E5E5E5"> the phone I was kind of</font>

1298
00:54:38,579 --> 00:54:42,270
strange so what after some other

1299
00:54:40,829 --> 00:54:43,799
inspection we found that this file is

1300
00:54:42,270 --> 00:54:47,339
very interesting because it contains the

1301
00:54:43,799 --> 00:54:49,170
credentials of the admin user and what

1302
00:54:47,339 --> 00:54:52,170
we notice<font color="#CCCCCC"> that if you delete this file</font>

1303
00:54:49,170 --> 00:54:53,579
so we traverse<font color="#E5E5E5"> and we delete it as a</font>

1304
00:54:52,170 --> 00:54:55,049
note indicating because it's a lot of

1305
00:54:53,579 --> 00:54:58,380
function so you're automatically

1306
00:54:55,049 --> 00:55:02,670
uneducated when you do that basically

1307
00:54:58,380 --> 00:55:05,700
the appliance becomes like unstable<font color="#CCCCCC"> ok</font>

1308
00:55:02,670 --> 00:55:07,350
and whoever is<font color="#E5E5E5"> on me</font>

1309
00:55:05,700 --> 00:55:09,720
using the appliance of administrator as

1310
00:55:07,350 --> 00:55:12,240
to restart<font color="#E5E5E5"> the machine in the nominative</font>

1311
00:55:09,720 --> 00:55:14,430
restarts what happens is that he

1312
00:55:12,240 --> 00:55:16,080
realized that that side doesn't exist

1313
00:55:14,430 --> 00:55:18,419
anymore it will create a<font color="#CCCCCC"> new one using</font>

1314
00:55:16,080 --> 00:55:20,610
default credentials so in our exploit

1315
00:55:18,420 --> 00:55:23,010
chain basically we delete this file we

1316
00:55:20,610 --> 00:55:24,780
know other<font color="#E5E5E5"> German default credentials we</font>

1317
00:55:23,010 --> 00:55:26,820
just wait for<font color="#CCCCCC"> the reboot which is forced</font>

1318
00:55:24,780 --> 00:55:28,710
otherwise you can you don't use anymore

1319
00:55:26,820 --> 00:55:31,830
the appliance because you<font color="#E5E5E5"> can and then</font>

1320
00:55:28,710 --> 00:55:33,330
<font color="#CCCCCC">in momentary boots then we basically log</font>

1321
00:55:31,830 --> 00:55:39,000
with the<font color="#E5E5E5"> full credentials and then a</font>

1322
00:55:33,330 --> 00:55:42,000
further action is taken just keep this

1323
00:55:39,000 --> 00:55:45,120
one thing that are we found<font color="#E5E5E5"> this</font>

1324
00:55:42,000 --> 00:55:47,460
basically we were running a fine search

1325
00:55:45,120 --> 00:55:49,200
on the<font color="#E5E5E5"> fight systems to search any file</font>

1326
00:55:47,460 --> 00:55:51,330
which smote was modified in the last

1327
00:55:49,200 --> 00:55:53,580
minutes<font color="#CCCCCC"> ok then we were doing the log</font>

1328
00:55:51,330 --> 00:55:55,680
<font color="#E5E5E5">off and</font><font color="#CCCCCC"> then run again and see the Delta</font>

1329
00:55:53,580 --> 00:55:57,630
and in the Delta we saw that the the

1330
00:55:55,680 --> 00:56:00,180
folder containing the session and he

1331
00:55:57,630 --> 00:56:03,000
disappeared so that log of function must

1332
00:56:00,180 --> 00:56:05,609
be most likely related to that and I was

1333
00:56:03,000 --> 00:56:08,190
<font color="#E5E5E5">one of the key to find this</font>

1334
00:56:05,610 --> 00:56:10,560
vulnerability second one which we<font color="#E5E5E5"> found</font>

1335
00:56:08,190 --> 00:56:12,300
with an upload this is the<font color="#E5E5E5"> thing this</font>

1336
00:56:10,560 --> 00:56:13,710
post certification right<font color="#CCCCCC"> yeah</font><font color="#E5E5E5"> you know</font>

1337
00:56:12,300 --> 00:56:15,860
this was quite interest because it's a

1338
00:56:13,710 --> 00:56:18,960
file upload but the results are<font color="#CCCCCC"> zip</font>

1339
00:56:15,860 --> 00:56:21,030
operation happening in a unzipping so

1340
00:56:18,960 --> 00:56:24,630
you upload the<font color="#CCCCCC"> zip file and then it will</font>

1341
00:56:21,030 --> 00:56:26,820
<font color="#E5E5E5">be unzipped the cool thing we have a</font>

1342
00:56:24,630 --> 00:56:30,210
<font color="#E5E5E5">very good suggestion from Andre our</font>

1343
00:56:26,820 --> 00:56:32,460
Palazzo and<font color="#E5E5E5"> basically what is was</font>

1344
00:56:30,210 --> 00:56:34,620
suggesting is this<font color="#CCCCCC"> ok let's let's first</font>

1345
00:56:32,460 --> 00:56:37,620
upload<font color="#CCCCCC"> a zip file which contains a</font>

1346
00:56:34,620 --> 00:56:39,720
symlink<font color="#CCCCCC"> ok let's say a point into a</font>

1347
00:56:37,620 --> 00:56:42,450
certain<font color="#E5E5E5"> directory ok and then you upload</font>

1348
00:56:39,720 --> 00:56:45,180
a second time same another zip file

1349
00:56:42,450 --> 00:56:47,419
which use the symlink which has been

1350
00:56:45,180 --> 00:56:50,250
previously<font color="#E5E5E5"> created but then try to</font>

1351
00:56:47,420 --> 00:56:52,830
possibly all the rights or crush an

1352
00:56:50,250 --> 00:56:54,360
existing file on the system so i'll tell

1353
00:56:52,830 --> 00:56:56,220
you why quickly when that approach

1354
00:56:54,360 --> 00:56:57,990
instead of like a traversal<font color="#CCCCCC"> we just</font>

1355
00:56:56,220 --> 00:56:59,850
simply couldn't do a traversal right and

1356
00:56:57,990 --> 00:57:01,799
any fault we got uploaded that wasn't a

1357
00:56:59,850 --> 00:57:03,120
zip file it would do<font color="#E5E5E5"> like a checksum or</font>

1358
00:57:01,800 --> 00:57:04,860
check of the headers and things like

1359
00:57:03,120 --> 00:57:06,150
<font color="#CCCCCC">this</font><font color="#E5E5E5"> I would just delete and not do</font>

1360
00:57:04,860 --> 00:57:08,400
anything with so we couldn't<font color="#E5E5E5"> just upload</font>

1361
00:57:06,150 --> 00:57:10,890
like PHP and we're<font color="#E5E5E5"> done we had to like</font>

1362
00:57:08,400 --> 00:57:12,420
upload actually a compressed file and we

1363
00:57:10,890 --> 00:57:13,740
try to decompress it and then when we

1364
00:57:12,420 --> 00:57:15,360
like I said when we have a traversal

1365
00:57:13,740 --> 00:57:17,430
then it was<font color="#CCCCCC"> like a bad file and just</font>

1366
00:57:15,360 --> 00:57:18,190
delete it so we had<font color="#E5E5E5"> to go for a little</font>

1367
00:57:17,430 --> 00:57:21,250
bit more

1368
00:57:18,190 --> 00:57:23,230
interesting<font color="#E5E5E5"> part okay so you see here</font>

1369
00:57:21,250 --> 00:57:25,930
the first part<font color="#E5E5E5"> of the it's the sea</font>

1370
00:57:23,230 --> 00:57:28,060
sibling created okay<font color="#E5E5E5"> which points to</font>

1371
00:57:25,930 --> 00:57:30,759
this we<font color="#E5E5E5"> need to we need to have the base</font>

1372
00:57:28,060 --> 00:57:33,040
folder right here then the second zip

1373
00:57:30,760 --> 00:57:37,030
will actually use the<font color="#CCCCCC"> sea and then crush</font>

1374
00:57:33,040 --> 00:57:39,009
this shell script<font color="#E5E5E5"> threader yeah the dlp</font>

1375
00:57:37,030 --> 00:57:40,900
and<font color="#E5E5E5"> it's go kill with with ironic</font>

1376
00:57:39,010 --> 00:57:43,390
<font color="#E5E5E5">otherwise funny so we just use this file</font>

1377
00:57:40,900 --> 00:57:45,520
and it was executed we<font color="#E5E5E5"> use this fight</font>

1378
00:57:43,390 --> 00:57:48,640
because then we could call a request

1379
00:57:45,520 --> 00:57:50,770
which would call that that<font color="#E5E5E5"> she'll scream</font>

1380
00:57:48,640 --> 00:57:54,609
though I was chaining different things

1381
00:57:50,770 --> 00:57:56,680
together yeah so this is<font color="#E5E5E5"> the</font><font color="#CCCCCC"> the</font>

1382
00:57:54,610 --> 00:57:59,380
screenshot and I think we have a demo

1383
00:57:56,680 --> 00:58:01,330
same<font color="#E5E5E5"> style as not before yeah once they</font>

1384
00:57:59,380 --> 00:58:03,250
go just go back to<font color="#CCCCCC"> the just hear this</font>

1385
00:58:01,330 --> 00:58:04,540
one so<font color="#CCCCCC"> it's might be hard to see but you</font>

1386
00:58:03,250 --> 00:58:06,430
<font color="#E5E5E5">can see that like you know for example</font>

1387
00:58:04,540 --> 00:58:09,850
do the initial<font color="#CCCCCC"> preflight upload the zip</font>

1388
00:58:06,430 --> 00:58:11,470
zip symlink and then because we we

1389
00:58:09,850 --> 00:58:13,839
couldn't actually upload a single zip

1390
00:58:11,470 --> 00:58:15,959
and have to the symlink and the target

1391
00:58:13,840 --> 00:58:18,100
file to overwrite within the same zip

1392
00:58:15,960 --> 00:58:20,830
but what happened was we were able to

1393
00:58:18,100 --> 00:58:22,420
upload one zip it decompressed creates

1394
00:58:20,830 --> 00:58:25,120
the symlink upload another one

1395
00:58:22,420 --> 00:58:28,510
decompress it and right into the symlink

1396
00:58:25,120 --> 00:58:29,980
directory and this worked because it was

1397
00:58:28,510 --> 00:58:31,420
actually unzipped in the exact same

1398
00:58:29,980 --> 00:58:32,710
folder it wasn't creating like a

1399
00:58:31,420 --> 00:58:34,150
temporary directory or anything like

1400
00:58:32,710 --> 00:58:35,500
that if it was creating a temporary

1401
00:58:34,150 --> 00:58:37,030
directory this vector wouldn't have been

1402
00:58:35,500 --> 00:58:38,530
able to<font color="#CCCCCC"> be used and we were going to be</font>

1403
00:58:37,030 --> 00:58:40,030
able<font color="#E5E5E5"> to get code execution from it so</font>

1404
00:58:38,530 --> 00:58:41,440
it's kind of interesting and then you

1405
00:58:40,030 --> 00:58:44,020
weak like<font color="#CCCCCC"> Roberta was saying we</font><font color="#E5E5E5"> could</font>

1406
00:58:41,440 --> 00:58:46,060
call like an API in the CGI interface

1407
00:58:44,020 --> 00:58:47,920
that would automatically execute the<font color="#E5E5E5"> dlp</font>

1408
00:58:46,060 --> 00:58:49,420
underscore killed SH file which we

1409
00:58:47,920 --> 00:58:50,980
thought was ironic and would kill the

1410
00:58:49,420 --> 00:58:54,580
actual application but really execute

1411
00:58:50,980 --> 00:58:57,610
our code and where we go so sorry that

1412
00:58:54,580 --> 00:58:59,799
<font color="#E5E5E5">was passed it I've ever</font><font color="#CCCCCC"> dat thang and is</font>

1413
00:58:57,610 --> 00:59:03,700
the the demo just showing<font color="#CCCCCC"> those all</font>

1414
00:58:59,800 --> 00:59:04,660
together is this woman ability as<font color="#CCCCCC"> I</font>

1415
00:59:03,700 --> 00:59:06,939
mentioned at<font color="#E5E5E5"> the beginning of the</font>

1416
00:59:04,660 --> 00:59:09,850
presentation because it's the first<font color="#CCCCCC"> time</font>

1417
00:59:06,940 --> 00:59:12,460
we<font color="#E5E5E5"> really solve this research we are</font>

1418
00:59:09,850 --> 00:59:16,120
actually dropping all the unpublished

1419
00:59:12,460 --> 00:59:19,390
exploits we found on<font color="#E5E5E5"> these thread thread</font>

1420
00:59:16,120 --> 00:59:21,160
discovery appliance the moments we

1421
00:59:19,390 --> 00:59:22,690
finish this presentation I understand

1422
00:59:21,160 --> 00:59:25,359
the presentation will<font color="#E5E5E5"> be already</font><font color="#CCCCCC"> shared</font>

1423
00:59:22,690 --> 00:59:26,920
on Twitter with the online and in the

1424
00:59:25,360 --> 00:59:30,580
presentation you will find the links if

1425
00:59:26,920 --> 00:59:32,170
you're interested so what's this<font color="#E5E5E5"> exploit</font>

1426
00:59:30,580 --> 00:59:34,150
doing is actually<font color="#CCCCCC"> just</font>

1427
00:59:32,170 --> 00:59:36,190
writing like just deleting the file and

1428
00:59:34,150 --> 00:59:37,690
it's basically<font color="#E5E5E5"> waiting for the admin to</font>

1429
00:59:36,190 --> 00:59:39,339
reboot right<font color="#E5E5E5"> because once you delete the</font>

1430
00:59:37,690 --> 00:59:41,049
configuration file the<font color="#E5E5E5"> admin can no</font>

1431
00:59:39,339 --> 00:59:42,549
longer log into the admin interface and

1432
00:59:41,049 --> 00:59:43,839
the<font color="#CCCCCC"> natural thing</font><font color="#E5E5E5"> for an admin would be</font>

1433
00:59:42,549 --> 00:59:45,790
like<font color="#E5E5E5"> okay this is applications not</font>

1434
00:59:43,839 --> 00:59:47,200
working I can't login all right let's

1435
00:59:45,790 --> 00:59:48,700
just bounce the box and see<font color="#E5E5E5"> what happens</font>

1436
00:59:47,200 --> 00:59:50,109
or isn't that thing that<font color="#E5E5E5"> kind of like a</font>

1437
00:59:48,700 --> 00:59:52,569
natural months that I would imagine and

1438
00:59:50,109 --> 00:59:55,299
so<font color="#CCCCCC"> that would bounce the box and then</font>

1439
00:59:52,569 --> 00:59:57,160
this is our exploit would do a polling

1440
00:59:55,299 --> 00:59:58,960
request right and it would pull the

1441
00:59:57,160 --> 01:00:00,520
server until and it would detected us

1442
00:59:58,960 --> 01:00:01,780
down okay and then it would detect it

1443
01:00:00,520 --> 01:00:03,970
and then as<font color="#E5E5E5"> soon as it comes back up</font>

1444
01:00:01,780 --> 01:00:07,119
it'll<font color="#E5E5E5"> try to</font><font color="#CCCCCC"> log in</font><font color="#E5E5E5"> with the default of</font>

1445
01:00:03,970 --> 01:00:09,640
user account default password login

1446
01:00:07,119 --> 01:00:12,010
start sending the payloads upload a

1447
01:00:09,640 --> 01:00:14,859
shell using one of our post

1448
01:00:12,010 --> 01:00:16,450
authenticated bugs and then yeah delete

1449
01:00:14,859 --> 01:00:18,970
<font color="#E5E5E5">the temporary file if it's creative one</font>

1450
01:00:16,450 --> 01:00:22,089
and execute code as<font color="#CCCCCC"> root user i believe</font>

1451
01:00:18,970 --> 01:00:23,259
so you know it's it's<font color="#CCCCCC"> a it's all about</font>

1452
01:00:22,089 --> 01:00:25,390
for us it's all about changing these

1453
01:00:23,260 --> 01:00:29,020
types of vulnerabilities to give us like

1454
01:00:25,390 --> 01:00:33,150
a basically a direct way path into into

1455
01:00:29,020 --> 01:00:35,470
the<font color="#E5E5E5"> target</font><font color="#CCCCCC"> so these</font><font color="#E5E5E5"> are the links here</font>

1456
01:00:33,150 --> 01:00:37,930
<font color="#CCCCCC">you will find the links when you doubled</font>

1457
01:00:35,470 --> 01:00:39,490
the slides these are the links which

1458
01:00:37,930 --> 01:00:41,618
contains every sport we're releasing

1459
01:00:39,490 --> 01:00:44,680
today for as a bonus for i canna box

1460
01:00:41,619 --> 01:00:46,480
conference and we have more as well and

1461
01:00:44,680 --> 01:00:47,379
<font color="#CCCCCC">we also have</font><font color="#E5E5E5"> a pull request I think</font>

1462
01:00:46,480 --> 01:00:49,390
probably I don't know if it still

1463
01:00:47,380 --> 01:00:51,069
appears intermetallic will not go

1464
01:00:49,390 --> 01:00:53,170
request article waiting and the

1465
01:00:51,069 --> 01:00:54,880
acceptance of that and then yeah cool

1466
01:00:53,170 --> 01:00:56,170
i'll leave it to you yeah<font color="#E5E5E5"> I think we I</font>

1467
01:00:54,880 --> 01:00:59,710
<font color="#E5E5E5">don't think we have time for mobile</font>

1468
01:00:56,170 --> 01:01:02,079
screen I don't know<font color="#CCCCCC"> thankful basically</font>

1469
01:00:59,710 --> 01:01:04,030
yeah it's you know essential solution

1470
01:01:02,079 --> 01:01:07,359
for mobile devices no we're out<font color="#E5E5E5"> okay</font>

1471
01:01:04,030 --> 01:01:11,799
well we<font color="#CCCCCC"> have to</font><font color="#E5E5E5"> end but yeah we'll play</font>

1472
01:01:07,359 --> 01:01:14,170
the demo nonetheless there we go so but

1473
01:01:11,799 --> 01:01:20,290
yeah this one's still 0 days so<font color="#CCCCCC"> we can't</font>

1474
01:01:14,170 --> 01:01:22,830
really disclose this one all right I

1475
01:01:20,290 --> 01:01:25,410
think<font color="#CCCCCC"> that's it for this session no</font>

1476
01:01:22,830 --> 01:01:27,270
oh okay yes sorry Christian answers if

1477
01:01:25,410 --> 01:01:28,410
anyone will do a couple of questions if

1478
01:01:27,270 --> 01:01:30,060
they have questions from the floor I

1479
01:01:28,410 --> 01:01:38,790
believe there was a raised hand let's

1480
01:01:30,060 --> 01:01:41,549
start<font color="#CCCCCC"> with you personally you said that</font>

1481
01:01:38,790 --> 01:01:44,940
<font color="#E5E5E5">you wanted exploit without user</font>

1482
01:01:41,550 --> 01:01:47,460
interaction but it if the admin has to

1483
01:01:44,940 --> 01:01:50,580
reboot the system that's your

1484
01:01:47,460 --> 01:01:53,130
interaction right it's true that that is

1485
01:01:50,580 --> 01:01:54,660
part interaction but we when we looking

1486
01:01:53,130 --> 01:01:55,920
at things like this we look at what like

1487
01:01:54,660 --> 01:01:57,569
we think from a logical point of view

1488
01:01:55,920 --> 01:01:59,460
from<font color="#E5E5E5"> the admin we didn't we didn't have</font>

1489
01:01:57,570 --> 01:02:01,080
<font color="#E5E5E5">to tell them to reboot it naturally that</font>

1490
01:01:59,460 --> 01:02:03,150
<font color="#E5E5E5">they try to</font><font color="#CCCCCC"> log in and it would be</font><font color="#E5E5E5"> like</font>

1491
01:02:01,080 --> 01:02:05,370
well we can't log in the most natural

1492
01:02:03,150 --> 01:02:07,440
thing that first do is rebooted and then

1493
01:02:05,370 --> 01:02:08,640
try to like figure<font color="#E5E5E5"> out what's going on</font>

1494
01:02:07,440 --> 01:02:10,140
maybe they reset<font color="#CCCCCC"> the password or</font>

1495
01:02:08,640 --> 01:02:11,520
<font color="#E5E5E5">something you know</font><font color="#CCCCCC"> and by that time</font>

1496
01:02:10,140 --> 01:02:13,230
we've already got a show with very

1497
01:02:11,520 --> 01:02:15,660
migrated process and taken<font color="#E5E5E5"> over the box</font>

1498
01:02:13,230 --> 01:02:18,090
and whatever and lamented out Colonel

1499
01:02:15,660 --> 01:02:20,700
Ricketts it's a good question we call

1500
01:02:18,090 --> 01:02:23,730
user a good question anything like any

1501
01:02:20,700 --> 01:02:26,669
other questions sorry just<font color="#E5E5E5"> out</font><font color="#CCCCCC"> of</font>

1502
01:02:23,730 --> 01:02:28,980
<font color="#E5E5E5">curiosity view also set the trend micro</font>

1503
01:02:26,670 --> 01:02:32,130
brew supply chain which one sorry it's

1504
01:02:28,980 --> 01:02:34,410
called a trend micro<font color="#CCCCCC"> butyl patching now</font>

1505
01:02:32,130 --> 01:02:36,480
I don't<font color="#E5E5E5"> believe it yet you know fri that</font>

1506
01:02:34,410 --> 01:02:39,270
yet now but we'll put it<font color="#E5E5E5"> on at least</font>

1507
01:02:36,480 --> 01:02:45,690
that's what it<font color="#E5E5E5"> is</font><font color="#CCCCCC"> thanks</font><font color="#E5E5E5"> tonight with</font>

1508
01:02:39,270 --> 01:02:48,330
now any other questions yeah just one

1509
01:02:45,690 --> 01:02:49,590
just<font color="#E5E5E5"> to say I mean was a great talk it</font>

1510
01:02:48,330 --> 01:02:51,960
is very<font color="#E5E5E5"> interesting</font><font color="#CCCCCC"> for me and also</font>

1511
01:02:49,590 --> 01:02:54,690
against one of our audience<font color="#E5E5E5"> here because</font>

1512
01:02:51,960 --> 01:02:56,520
they<font color="#CCCCCC"> relatability</font><font color="#E5E5E5"> presented</font><font color="#CCCCCC"> they are</font>

1513
01:02:54,690 --> 01:02:58,560
<font color="#E5E5E5">very different among each other right I</font>

1514
01:02:56,520 --> 01:03:00,840
<font color="#E5E5E5">mean I mean at least we learn something</font>

1515
01:02:58,560 --> 01:03:03,870
from your<font color="#E5E5E5"> research very useful</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> us</font>

1516
01:03:00,840 --> 01:03:06,020
also for you guys and I always<font color="#E5E5E5"> think is</font>

1517
01:03:03,870 --> 01:03:07,710
a good like example of collaboration

1518
01:03:06,020 --> 01:03:11,009
successful collaboration between

1519
01:03:07,710 --> 01:03:12,600
researchers and no end or at least

1520
01:03:11,010 --> 01:03:14,820
<font color="#E5E5E5">because you I'd like to put a response</font>

1521
01:03:12,600 --> 01:03:17,310
from a vendor so we're going<font color="#E5E5E5"> to</font>

1522
01:03:14,820 --> 01:03:19,230
understand sorry I think it was a good

1523
01:03:17,310 --> 01:03:22,380
example of collaboration because like

1524
01:03:19,230 --> 01:03:23,910
yeah<font color="#CCCCCC"> totally I</font><font color="#E5E5E5"> mean we had</font><font color="#CCCCCC"> oh there's a</font>

1525
01:03:22,380 --> 01:03:25,590
reason why we went this far with these

1526
01:03:23,910 --> 01:03:27,299
products<font color="#E5E5E5"> in the trend micro is because</font>

1527
01:03:25,590 --> 01:03:28,770
there was so cooperative and it was

1528
01:03:27,300 --> 01:03:30,600
fantastic to see you know we were like

1529
01:03:28,770 --> 01:03:32,850
really impressed with<font color="#E5E5E5"> it the head like a</font>

1530
01:03:30,600 --> 01:03:34,180
proper advisory they patch it quite

1531
01:03:32,850 --> 01:03:35,410
quickly

1532
01:03:34,180 --> 01:03:37,870
the turnaround time and they always

1533
01:03:35,410 --> 01:03:39,790
update you with statuses and stuff so it

1534
01:03:37,870 --> 01:03:42,069
was really good really smooth outside<font color="#E5E5E5"> of</font>

1535
01:03:39,790 --> 01:03:43,300
the whole they have their own bug bounty

1536
01:03:42,070 --> 01:03:46,030
program and things they were really

1537
01:03:43,300 --> 01:03:51,990
really good to deal with so that's any

1538
01:03:46,030 --> 01:03:54,730
other questions no other question<font color="#E5E5E5"> no</font>

1539
01:03:51,990 --> 01:03:57,750
<font color="#CCCCCC">okay well</font><font color="#E5E5E5"> thank you very much</font><font color="#CCCCCC"> all right</font>

1540
01:03:54,730 --> 01:03:57,750
thanks thank you

