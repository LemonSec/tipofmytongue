1
00:00:09,250 --> 00:00:14,530
so thank you for<font color="#CCCCCC"> coming so yeah today</font>

2
00:00:13,690 --> 00:00:17,020
we're going<font color="#E5E5E5"> to talk about</font>

3
00:00:14,530 --> 00:00:19,000
<font color="#CCCCCC">mainframe</font><font color="#E5E5E5"> and before</font><font color="#CCCCCC"> we start just just</font>

4
00:00:17,020 --> 00:00:21,849
a quick question did anybody see<font color="#CCCCCC"> the</font>

5
00:00:19,000 --> 00:00:23,590
movie hidden figures it was released a

6
00:00:21,849 --> 00:00:25,540
couple of<font color="#E5E5E5"> weeks ago yeah yeah brilliant</font>

7
00:00:23,590 --> 00:00:28,990
awesome movies about space explorer

8
00:00:25,540 --> 00:00:31,000
exploration in the 60s and black<font color="#E5E5E5"> womens</font>

9
00:00:28,990 --> 00:00:34,500
rolling in etc<font color="#CCCCCC"> it's a very awesome movie</font>

10
00:00:31,000 --> 00:00:36,969
and one<font color="#E5E5E5"> of the reason</font><font color="#CCCCCC"> I bring it</font><font color="#E5E5E5"> is that</font>

11
00:00:34,500 --> 00:00:39,610
it featured the mainframe there was a

12
00:00:36,969 --> 00:00:42,340
mainframe that<font color="#CCCCCC"> was actually</font><font color="#E5E5E5"> used in the</font>

13
00:00:39,610 --> 00:00:44,410
60s to calculate trajectory space

14
00:00:42,340 --> 00:00:47,440
<font color="#CCCCCC">exploration etc and they use this</font>

15
00:00:44,410 --> 00:00:51,248
mainframe this the IBM 7090 so remember

16
00:00:47,440 --> 00:00:53,589
this<font color="#E5E5E5"> is in 60 62 63 right and the reason</font>

17
00:00:51,249 --> 00:00:56,230
<font color="#E5E5E5">I bring it up is</font><font color="#CCCCCC"> because well here we</font>

18
00:00:53,589 --> 00:00:58,420
are in 2017 and when I talk<font color="#CCCCCC"> to people</font>

19
00:00:56,230 --> 00:01:00,279
about mainframes this is what they

20
00:00:58,420 --> 00:01:03,309
picture this is what they<font color="#CCCCCC"> have in mind</font>

21
00:01:00,280 --> 00:01:04,599
an old legacy platform that is only kept

22
00:01:03,309 --> 00:01:06,520
for historical reasons and because

23
00:01:04,599 --> 00:01:12,130
<font color="#CCCCCC">people cannot find the budget to replace</font>

24
00:01:06,520 --> 00:01:13,750
<font color="#E5E5E5">it and the idea the whole idea of this</font>

25
00:01:12,130 --> 00:01:17,020
talk is just<font color="#E5E5E5"> to say that this statement</font>

26
00:01:13,750 --> 00:01:18,820
<font color="#CCCCCC">is false for so many reasons simply</font>

27
00:01:17,020 --> 00:01:20,710
going<font color="#E5E5E5"> to go into that</font><font color="#CCCCCC"> later on</font><font color="#E5E5E5"> this is</font>

28
00:01:18,820 --> 00:01:23,919
<font color="#CCCCCC">what an actual mainframe modern</font>

29
00:01:20,710 --> 00:01:25,899
mainframe looks like so without going to

30
00:01:23,920 --> 00:01:28,060
you know detail specifications about

31
00:01:25,899 --> 00:01:30,340
failure prediction the possibility to

32
00:01:28,060 --> 00:01:31,869
replace hardware you know live while the

33
00:01:30,340 --> 00:01:33,280
<font color="#E5E5E5">system is running let's just look at the</font>

34
00:01:31,869 --> 00:01:37,119
basic steps right we're talking about

35
00:01:33,280 --> 00:01:38,380
141 processors each<font color="#CCCCCC"> 5 gigahertz and</font>

36
00:01:37,119 --> 00:01:40,719
we're talking<font color="#E5E5E5"> about you know dedicated</font>

37
00:01:38,380 --> 00:01:44,699
processors for each special tasks like

38
00:01:40,719 --> 00:01:46,719
<font color="#E5E5E5">XML processing like</font><font color="#CCCCCC"> UNIX partition etc</font>

39
00:01:44,700 --> 00:01:49,630
cryptographic chips and hardware

40
00:01:46,719 --> 00:01:53,408
encryption to the least we can say that

41
00:01:49,630 --> 00:01:55,270
<font color="#CCCCCC">it's a really badass machine right so</font>

42
00:01:53,409 --> 00:01:58,299
it's<font color="#CCCCCC"> like far away from what people</font>

43
00:01:55,270 --> 00:02:01,630
imagine it's not legacy if it's you know

44
00:01:58,299 --> 00:02:03,579
biannually updated same for the OS

45
00:02:01,630 --> 00:02:06,039
actually it's<font color="#E5E5E5"> like usually we find z/os</font>

46
00:02:03,579 --> 00:02:08,320
IBM products on this kind<font color="#CCCCCC"> of machine</font>

47
00:02:06,039 --> 00:02:10,720
it's biannually product there's a new

48
00:02:08,320 --> 00:02:12,700
release there's patching going on so

49
00:02:10,720 --> 00:02:15,640
it's<font color="#E5E5E5"> not really legacy this is a</font>

50
00:02:12,700 --> 00:02:17,500
currently used platform obviously if you

51
00:02:15,640 --> 00:02:18,970
have the money<font color="#E5E5E5"> to spend on this on this</font>

52
00:02:17,500 --> 00:02:21,130
kind<font color="#E5E5E5"> of machine you're not going to use</font>

53
00:02:18,970 --> 00:02:23,409
<font color="#CCCCCC">it to host your you know mail server or</font>

54
00:02:21,130 --> 00:02:25,599
your files that you don't care<font color="#E5E5E5"> about</font>

55
00:02:23,409 --> 00:02:26,859
know if you have this much<font color="#E5E5E5"> money to</font>

56
00:02:25,599 --> 00:02:27,959
spend on<font color="#E5E5E5"> this machine you're going to</font>

57
00:02:26,860 --> 00:02:30,060
<font color="#E5E5E5">spend it you can</font>

58
00:02:27,960 --> 00:02:31,740
use it to host your most critical

59
00:02:30,060 --> 00:02:34,230
applications the one that you do not

60
00:02:31,740 --> 00:02:35,850
want to<font color="#CCCCCC"> go down</font><font color="#E5E5E5"> actually the the optimal</font>

61
00:02:34,230 --> 00:02:37,260
these machines is<font color="#E5E5E5"> not counted in weeks</font>

62
00:02:35,850 --> 00:02:40,920
or months<font color="#E5E5E5"> it's counted in years</font>

63
00:02:37,260 --> 00:02:42,840
sometimes in decades and so let's like

64
00:02:40,920 --> 00:02:45,839
this is a slide that I took from my

65
00:02:42,840 --> 00:02:48,300
friends feeling Chad talk that they gave

66
00:02:45,840 --> 00:02:50,640
<font color="#E5E5E5">a few months ago it's like I liked it so</font>

67
00:02:48,300 --> 00:02:52,740
much<font color="#CCCCCC"> so I kind of stole it it lists all</font>

68
00:02:50,640 --> 00:02:54,239
the companies<font color="#E5E5E5"> that you know use</font>

69
00:02:52,740 --> 00:02:55,650
mainframe and it goes<font color="#E5E5E5"> something like</font>

70
00:02:54,240 --> 00:02:58,380
this the statement goes something like

71
00:02:55,650 --> 00:03:00,750
this somewhere in there there's a

72
00:02:58,380 --> 00:03:03,180
company that you care about as an

73
00:03:00,750 --> 00:03:05,880
individual as a member of society be it

74
00:03:03,180 --> 00:03:09,660
a government be it a bank health

75
00:03:05,880 --> 00:03:11,700
<font color="#CCCCCC">insurance company Airlines whatever</font>

76
00:03:09,660 --> 00:03:13,710
there is<font color="#E5E5E5"> somewhere in their company that</font>

77
00:03:11,700 --> 00:03:15,810
you care about that hosts your data on a

78
00:03:13,710 --> 00:03:18,180
mainframe if it's<font color="#E5E5E5"> not on this slide it's</font>

79
00:03:15,810 --> 00:03:20,790
on this slide right and we could have

80
00:03:18,180 --> 00:03:22,500
<font color="#E5E5E5">kept going this is just the list of the</font>

81
00:03:20,790 --> 00:03:24,120
you<font color="#CCCCCC"> know one of small list of</font><font color="#E5E5E5"> the</font>

82
00:03:22,500 --> 00:03:25,740
companies that<font color="#E5E5E5"> rely on mainframes there</font>

83
00:03:24,120 --> 00:03:28,560
are different<font color="#E5E5E5"> statistics some say it's</font>

84
00:03:25,740 --> 00:03:31,410
ninety percent of<font color="#CCCCCC"> 1,400 some say it's</font><font color="#E5E5E5"> 75</font>

85
00:03:28,560 --> 00:03:34,020
percent of Fortune 500 but the idea is

86
00:03:31,410 --> 00:03:37,680
this platform is not going<font color="#E5E5E5"> anywhere it's</font>

87
00:03:34,020 --> 00:03:39,780
heavily used because<font color="#E5E5E5"> it has uncompelled</font>

88
00:03:37,680 --> 00:03:42,360
<font color="#E5E5E5">Bowl performance level availability</font>

89
00:03:39,780 --> 00:03:44,340
level etc so it<font color="#CCCCCC"> is used currently use</font>

90
00:03:42,360 --> 00:03:48,060
and will be used for many years<font color="#CCCCCC"> to come</font>

91
00:03:44,340 --> 00:03:50,640
and we the hacking community you know<font color="#E5E5E5"> do</font>

92
00:03:48,060 --> 00:03:52,290
<font color="#CCCCCC">not spend nearly as much time as we do</font>

93
00:03:50,640 --> 00:03:53,850
on windows and unix we do not send that

94
00:03:52,290 --> 00:03:57,150
much time on mainframe hacking and

95
00:03:53,850 --> 00:03:59,579
that's just well sad given how important

96
00:03:57,150 --> 00:04:01,560
this technology is so this is basically

97
00:03:59,580 --> 00:04:04,290
the the first myth that I wanted<font color="#CCCCCC"> to</font>

98
00:04:01,560 --> 00:04:06,270
debunk about this whole you know legacy

99
00:04:04,290 --> 00:04:07,530
stuff the second way that<font color="#E5E5E5"> look when I</font>

100
00:04:06,270 --> 00:04:09,300
talk<font color="#CCCCCC"> to people by mainframe they're like</font>

101
00:04:07,530 --> 00:04:11,160
well there's so you know they're so

102
00:04:09,300 --> 00:04:12,720
behind so many<font color="#E5E5E5"> layers of firewalls like</font>

103
00:04:11,160 --> 00:04:14,700
<font color="#CCCCCC">Network which actually we're not going</font>

104
00:04:12,720 --> 00:04:16,589
to bother putting them in our audit plan

105
00:04:14,700 --> 00:04:20,700
we're not going to scan them anyway etc

106
00:04:16,589 --> 00:04:22,919
that's just not true like Phil Phil

107
00:04:20,700 --> 00:04:24,450
<font color="#CCCCCC">Young has a website that called</font>

108
00:04:22,920 --> 00:04:25,770
mainframe<font color="#CCCCCC"> projects a tumblr com I</font>

109
00:04:24,450 --> 00:04:27,479
encourage you to<font color="#E5E5E5"> see it</font><font color="#CCCCCC"> she has a</font>

110
00:04:25,770 --> 00:04:30,479
crawler that<font color="#E5E5E5"> goes through the</font><font color="#CCCCCC"> internet</font>

111
00:04:27,480 --> 00:04:31,710
<font color="#E5E5E5">looking for mainframes only exposed on</font>

112
00:04:30,480 --> 00:04:33,690
<font color="#E5E5E5">the internet right so these are critical</font>

113
00:04:31,710 --> 00:04:36,659
machines that<font color="#E5E5E5"> host critical data and yet</font>

114
00:04:33,690 --> 00:04:38,100
we can find<font color="#E5E5E5"> them on the internet so this</font>

115
00:04:36,660 --> 00:04:39,510
one I<font color="#CCCCCC"> just like picked</font><font color="#E5E5E5"> up on</font><font color="#CCCCCC"> its website</font>

116
00:04:38,100 --> 00:04:40,830
you can pick up much more<font color="#E5E5E5"> this one I</font>

117
00:04:39,510 --> 00:04:41,820
find interesting I don't know if you can

118
00:04:40,830 --> 00:04:44,430
read it<font color="#E5E5E5"> right</font>

119
00:04:41,820 --> 00:04:47,730
year but it says you know Pentagon so

120
00:04:44,430 --> 00:04:50,640
you know US<font color="#E5E5E5"> military apparently there's</font>

121
00:04:47,730 --> 00:04:52,440
also this one car manufacturer actually

122
00:04:50,640 --> 00:04:54,419
for<font color="#CCCCCC"> the anecdote I like I was I was</font>

123
00:04:52,440 --> 00:04:55,800
trying<font color="#CCCCCC"> to stalk stuff you know final</font>

124
00:04:54,420 --> 00:04:58,380
stuff I was getting myself into stocks

125
00:04:55,800 --> 00:05:01,200
and I<font color="#E5E5E5"> found insurance company that i</font>

126
00:04:58,380 --> 00:05:02,610
bought some stock I found their

127
00:05:01,200 --> 00:05:04,500
mainframe on the internet and I can<font color="#E5E5E5"> tell</font>

128
00:05:02,610 --> 00:05:06,120
<font color="#E5E5E5">you that I stole my stocks right away so</font>

129
00:05:04,500 --> 00:05:09,660
yeah you can find some pretty critical

130
00:05:06,120 --> 00:05:12,600
mainframes on the<font color="#CCCCCC"> Internet so a little</font>

131
00:05:09,660 --> 00:05:14,880
bit about me I'm I you work as a pen

132
00:05:12,600 --> 00:05:17,850
<font color="#E5E5E5">tester for wait wait stone like mainly</font>

133
00:05:14,880 --> 00:05:20,250
windows and unix hacking and i remember

134
00:05:17,850 --> 00:05:21,690
in 2014 we were doing an<font color="#E5E5E5"> audit like you</font>

135
00:05:20,250 --> 00:05:23,580
know infrastructure audit the client

136
00:05:21,690 --> 00:05:24,990
gave us IP addresses with doing our

137
00:05:23,580 --> 00:05:27,030
stuff going through windows<font color="#CCCCCC"> and unix</font>

138
00:05:24,990 --> 00:05:30,030
stuff and<font color="#E5E5E5"> i remember they're like we</font>

139
00:05:27,030 --> 00:05:32,280
like we discovered some some veal and

140
00:05:30,030 --> 00:05:34,830
that was not listed that were not given

141
00:05:32,280 --> 00:05:36,150
<font color="#CCCCCC">to us and we like hi can we scan is a</font>

142
00:05:34,830 --> 00:05:38,520
little bit me said oh you'll know<font color="#CCCCCC"> that's</font>

143
00:05:36,150 --> 00:05:40,890
mainframe that's legacy do not do not do

144
00:05:38,520 --> 00:05:42,150
anything on it or not i'm janet attempt

145
00:05:40,890 --> 00:05:43,409
anything on it and we were like well

146
00:05:42,150 --> 00:05:44,580
that's the mainframe it's like finding

147
00:05:43,410 --> 00:05:47,010
gold you<font color="#E5E5E5"> know it's like finding a</font>

148
00:05:44,580 --> 00:05:48,419
<font color="#CCCCCC">Windows 2000 or Windows well three dot</font>

149
00:05:47,010 --> 00:05:50,580
one and the network you just want<font color="#E5E5E5"> to</font>

150
00:05:48,420 --> 00:05:51,450
exploit that shit and we were so happy

151
00:05:50,580 --> 00:05:55,080
because we thought we were going to

152
00:05:51,450 --> 00:05:56,460
explore<font color="#CCCCCC"> in so many ways but when we went</font>

153
00:05:55,080 --> 00:05:58,620
through the internet you know and we

154
00:05:56,460 --> 00:06:01,140
tried to find research on<font color="#E5E5E5"> this stuff</font>

155
00:05:58,620 --> 00:06:03,510
like it was dry as hell we<font color="#E5E5E5"> had no</font>

156
00:06:01,140 --> 00:06:05,729
resources we had no tools available well

157
00:06:03,510 --> 00:06:07,110
one or two tools may be like no

158
00:06:05,730 --> 00:06:08,700
techniques there<font color="#E5E5E5"> were nobody talking</font>

159
00:06:07,110 --> 00:06:12,360
about this stuff well there was only one

160
00:06:08,700 --> 00:06:14,280
person so like<font color="#E5E5E5"> I was</font><font color="#CCCCCC"> so frustrated that</font>

161
00:06:12,360 --> 00:06:16,470
I decided to get into<font color="#E5E5E5"> my myself in</font>

162
00:06:14,280 --> 00:06:17,909
today's and just try to talk to<font color="#CCCCCC"> people</font>

163
00:06:16,470 --> 00:06:20,520
about this stuff<font color="#E5E5E5"> and make them realize</font>

164
00:06:17,910 --> 00:06:24,630
and make it easy for pen testers to a

165
00:06:20,520 --> 00:06:26,669
hack this kind of stuff so<font color="#CCCCCC"> this talk is</font>

166
00:06:24,630 --> 00:06:28,950
going<font color="#E5E5E5"> to be about must define mainframes</font>

167
00:06:26,670 --> 00:06:30,780
a little bit so you know half check and

168
00:06:28,950 --> 00:06:32,310
we're<font color="#E5E5E5"> going to talk about customer</font>

169
00:06:30,780 --> 00:06:34,349
information control system which is

170
00:06:32,310 --> 00:06:36,690
which is<font color="#CCCCCC"> a critical product that we find</font>

171
00:06:34,350 --> 00:06:38,940
on most mainframes and we're going to

172
00:06:36,690 --> 00:06:40,680
<font color="#E5E5E5">have the shit out of it and then as a</font>

173
00:06:38,940 --> 00:06:42,030
bonus with like it's<font color="#E5E5E5"> not really the</font>

174
00:06:40,680 --> 00:06:43,500
purpose of<font color="#E5E5E5"> this talk I have a separate</font>

175
00:06:42,030 --> 00:06:45,059
talk about this but we're going<font color="#E5E5E5"> to talk</font>

176
00:06:43,500 --> 00:06:46,380
about<font color="#CCCCCC"> some post exploit stuff like once</font>

177
00:06:45,060 --> 00:06:47,850
you get a shell on a mainframe and we

178
00:06:46,380 --> 00:06:50,219
will get<font color="#E5E5E5"> a shell</font><font color="#CCCCCC"> 10 mainframe what can</font>

179
00:06:47,850 --> 00:06:52,590
<font color="#E5E5E5">we do like how do we owe it privileges</font>

180
00:06:50,220 --> 00:06:54,990
how address space is handled etc so this

181
00:06:52,590 --> 00:06:59,429
<font color="#E5E5E5">is basically going to be the layout</font>

182
00:06:54,990 --> 00:07:02,550
<font color="#CCCCCC">of the top so we're on engagement you</font>

183
00:06:59,430 --> 00:07:05,250
have to pen test this app this<font color="#CCCCCC"> is what I</font>

184
00:07:02,550 --> 00:07:07,290
mainframe app looks like and the only

185
00:07:05,250 --> 00:07:09,720
<font color="#E5E5E5">info that we have like that I had when I</font>

186
00:07:07,290 --> 00:07:11,070
started this pen test and I had this in

187
00:07:09,720 --> 00:07:13,470
front of me with that oh you can edit

188
00:07:11,070 --> 00:07:15,000
the<font color="#CCCCCC"> green field so you can input data in</font>

189
00:07:13,470 --> 00:07:18,390
the green field that that's all I had

190
00:07:15,000 --> 00:07:21,690
going for me so<font color="#CCCCCC"> let's try</font><font color="#E5E5E5"> to you know</font>

191
00:07:18,390 --> 00:07:24,510
think rationally about this obviously

192
00:07:21,690 --> 00:07:28,380
this is no web right so<font color="#E5E5E5"> you can throw</font>

193
00:07:24,510 --> 00:07:30,710
away all the XS s SQL etc not

194
00:07:28,380 --> 00:07:34,340
technically true but<font color="#E5E5E5"> you</font><font color="#CCCCCC"> know we can</font>

195
00:07:30,710 --> 00:07:36,539
discard it if you lunch a<font color="#CCCCCC"> wireshark</font>

196
00:07:34,340 --> 00:07:38,580
basically you see that the sick client

197
00:07:36,540 --> 00:07:41,520
that you<font color="#E5E5E5"> use in is communicating with</font>

198
00:07:38,580 --> 00:07:43,109
the protocol called TN 3270 which is

199
00:07:41,520 --> 00:07:45,719
basically just a modified telnet right

200
00:07:43,110 --> 00:07:47,640
IBM modify telnet called 80 and 30 to 70

201
00:07:45,720 --> 00:07:50,190
it has all the basic properties of

202
00:07:47,640 --> 00:07:51,750
telnet plus somatic stuff and to

203
00:07:50,190 --> 00:07:54,750
communicate with with the mainframe so

204
00:07:51,750 --> 00:07:57,060
we're going to<font color="#E5E5E5"> use a nap how is</font><font color="#CCCCCC"> it</font>

205
00:07:54,750 --> 00:07:59,850
called<font color="#E5E5E5"> an X 30 to 70 element emulator on</font>

206
00:07:57,060 --> 00:08:04,080
linux so it basically emulates this you

207
00:07:59,850 --> 00:08:05,670
know this small hardware there and like

208
00:08:04,080 --> 00:08:07,919
<font color="#CCCCCC">i said we have no idea how it worked and</font>

209
00:08:05,670 --> 00:08:08,910
i remember back in 2014 i was doing

210
00:08:07,920 --> 00:08:12,510
research on this stuff<font color="#E5E5E5"> and there was one</font>

211
00:08:08,910 --> 00:08:14,670
<font color="#E5E5E5">talk by dominic white and he said like</font>

212
00:08:12,510 --> 00:08:16,140
he showed the two<font color="#E5E5E5"> cool very cool tool</font>

213
00:08:14,670 --> 00:08:18,360
that will actually play with the field

214
00:08:16,140 --> 00:08:20,250
in the same way as we<font color="#E5E5E5"> disabled for</font>

215
00:08:18,360 --> 00:08:21,870
instance javascript and HTML<font color="#CCCCCC"> well you</font>

216
00:08:20,250 --> 00:08:23,700
can do the<font color="#E5E5E5"> same thing on the distict</font>

217
00:08:21,870 --> 00:08:26,280
clients you can like change the fields

218
00:08:23,700 --> 00:08:28,560
and make them unhidden etc and<font color="#E5E5E5"> you can</font>

219
00:08:26,280 --> 00:08:30,239
alter some fields that are protected etc

220
00:08:28,560 --> 00:08:31,740
but<font color="#E5E5E5"> I wanted to go deeper like</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> wants</font>

221
00:08:30,240 --> 00:08:34,710
to<font color="#E5E5E5"> really understand how this shit works</font>

222
00:08:31,740 --> 00:08:35,700
and what can you play<font color="#CCCCCC"> with it how can</font>

223
00:08:34,710 --> 00:08:38,010
you play<font color="#CCCCCC"> with it</font><font color="#E5E5E5"> in the same</font><font color="#CCCCCC"> way you</font>

224
00:08:35,700 --> 00:08:39,960
would play with<font color="#CCCCCC"> a web app right and</font><font color="#E5E5E5"> this</font>

225
00:08:38,010 --> 00:08:42,090
is what<font color="#E5E5E5"> I discovered it kicks customer</font>

226
00:08:39,960 --> 00:08:44,190
information control system now there<font color="#E5E5E5"> are</font>

227
00:08:42,090 --> 00:08:46,140
like I think hundred books about kicks

228
00:08:44,190 --> 00:08:48,780
from design implementation to definition

229
00:08:46,140 --> 00:08:51,689
I'm just<font color="#E5E5E5"> going to try</font><font color="#CCCCCC"> to summarize all</font>

230
00:08:48,780 --> 00:08:53,610
of it in one sentence but I think that

231
00:08:51,690 --> 00:08:55,740
that makes sense and will be much easier

232
00:08:53,610 --> 00:08:57,450
later on so for me this to me this is a

233
00:08:55,740 --> 00:08:59,370
personal opinion and it will shock most

234
00:08:57,450 --> 00:09:02,850
mainframe<font color="#CCCCCC"> pours but</font><font color="#E5E5E5"> I don't care</font><font color="#CCCCCC"> that</font>

235
00:08:59,370 --> 00:09:06,450
jackasses to me kick is a combination of

236
00:09:02,850 --> 00:09:07,400
the web CMS and tomcat apache tomcat

237
00:09:06,450 --> 00:09:11,340
friends

238
00:09:07,400 --> 00:09:13,170
back in 60s so think of these two cool

239
00:09:11,340 --> 00:09:16,140
tools that you know were like designed

240
00:09:13,170 --> 00:09:18,180
in the 60s and it was like so if we if

241
00:09:16,140 --> 00:09:21,030
we go to the mindset of<font color="#E5E5E5"> the 60s there</font>

242
00:09:18,180 --> 00:09:22,949
was barely internet then you know there

243
00:09:21,030 --> 00:09:24,660
was hardly know there was no tcp/ip

244
00:09:22,950 --> 00:09:26,340
there was barely know that it's surely

245
00:09:24,660 --> 00:09:28,680
not in the same way as we mean internet

246
00:09:26,340 --> 00:09:31,500
night right now<font color="#E5E5E5"> and so if you wanted to</font>

247
00:09:28,680 --> 00:09:34,530
connect computers or to make an app

248
00:09:31,500 --> 00:09:35,790
available you know on different to

249
00:09:34,530 --> 00:09:38,069
different clients in two different

250
00:09:35,790 --> 00:09:40,230
mainframes you had to do it like<font color="#CCCCCC"> you</font>

251
00:09:38,070 --> 00:09:42,240
know the hard way going<font color="#CCCCCC"> to</font><font color="#E5E5E5"> assembly code</font>

252
00:09:40,230 --> 00:09:44,790
your socket handle concurrent access

253
00:09:42,240 --> 00:09:46,790
handle memory priority etc so you would

254
00:09:44,790 --> 00:09:50,250
have<font color="#CCCCCC"> to do all</font><font color="#E5E5E5"> the hard the hard part</font>

255
00:09:46,790 --> 00:09:51,810
and<font color="#E5E5E5"> an assembly to handle all this stuff</font>

256
00:09:50,250 --> 00:09:54,900
<font color="#CCCCCC">just to make</font><font color="#E5E5E5"> your business app available</font>

257
00:09:51,810 --> 00:09:56,939
and so kicks acted came that<font color="#E5E5E5"> you act</font>

258
00:09:54,900 --> 00:09:59,880
like a middleware you will code your app

259
00:09:56,940 --> 00:10:01,590
in<font color="#E5E5E5"> COBOL Java Sea or whatever and you</font>

260
00:09:59,880 --> 00:10:03,660
will host it you would host it on kicks

261
00:10:01,590 --> 00:10:06,960
in the same way you would host a<font color="#E5E5E5"> Java</font>

262
00:10:03,660 --> 00:10:08,339
app on tomcat and make it available<font color="#E5E5E5"> to</font>

263
00:10:06,960 --> 00:10:10,830
everyone so people will just connect to

264
00:10:08,340 --> 00:10:12,540
the kicks using some standard stuff and

265
00:10:10,830 --> 00:10:14,640
<font color="#CCCCCC">will access different applications and</font>

266
00:10:12,540 --> 00:10:16,829
kicks will handle resource access

267
00:10:14,640 --> 00:10:19,920
concurrent access lock in on files etc

268
00:10:16,830 --> 00:10:23,100
it will do that transparently it's

269
00:10:19,920 --> 00:10:25,500
literally a small OS basically it's much

270
00:10:23,100 --> 00:10:27,300
more advanced than at some car and I say

271
00:10:25,500 --> 00:10:29,490
like I mentioned in<font color="#E5E5E5"> Drupal here like a</font>

272
00:10:27,300 --> 00:10:31,589
web CMS example because it actually

273
00:10:29,490 --> 00:10:34,080
kicks provide some functions that<font color="#E5E5E5"> you</font>

274
00:10:31,590 --> 00:10:35,430
can use in your<font color="#CCCCCC"> in your code so for</font>

275
00:10:34,080 --> 00:10:37,830
instance if we take a<font color="#CCCCCC"> COBOL I</font><font color="#E5E5E5"> know</font>

276
00:10:35,430 --> 00:10:39,750
everybody's familiar with<font color="#CCCCCC"> Kobo but it</font>

277
00:10:37,830 --> 00:10:41,190
works the same way for<font color="#E5E5E5"> java and seem so</font>

278
00:10:39,750 --> 00:10:43,680
you can see here that instead of<font color="#E5E5E5"> writing</font>

279
00:10:41,190 --> 00:10:46,680
<font color="#E5E5E5">right instead of regional reading a file</font>

280
00:10:43,680 --> 00:10:48,660
using you<font color="#CCCCCC"> know custom</font><font color="#E5E5E5"> cobol code well</font>

281
00:10:46,680 --> 00:10:50,579
we're just going to use this exact kicks

282
00:10:48,660 --> 00:10:52,140
read file and we're going<font color="#E5E5E5"> to read file</font>

283
00:10:50,580 --> 00:10:54,210
that's called you reply and it will

284
00:10:52,140 --> 00:10:56,330
handle cash in it will handle concurrent

285
00:10:54,210 --> 00:10:58,590
access it will walk the file etc

286
00:10:56,330 --> 00:11:00,450
integrity a chat it will do all that

287
00:10:58,590 --> 00:11:03,360
stuff for us so we only focus on<font color="#E5E5E5"> the</font>

288
00:11:00,450 --> 00:11:05,670
business aspects of the<font color="#CCCCCC"> act this is</font>

289
00:11:03,360 --> 00:11:08,070
basically kicks but the main advantage

290
00:11:05,670 --> 00:11:09,620
of kicks is that it<font color="#E5E5E5"> can handle thousands</font>

291
00:11:08,070 --> 00:11:13,500
and thousands<font color="#E5E5E5"> of requests per second</font>

292
00:11:09,620 --> 00:11:15,450
like a lot let's<font color="#E5E5E5"> just you know this is</font><font color="#CCCCCC"> a</font>

293
00:11:13,500 --> 00:11:18,570
quick game how many how many do you

294
00:11:15,450 --> 00:11:20,250
reckon how many there<font color="#CCCCCC"> are of Google</font>

295
00:11:18,570 --> 00:11:20,880
searches per second in the<font color="#E5E5E5"> world right</font>

296
00:11:20,250 --> 00:11:24,750
now

297
00:11:20,880 --> 00:11:27,630
someone<font color="#CCCCCC"> shout out a number oh that's</font>

298
00:11:24,750 --> 00:11:29,280
very generous of you well<font color="#E5E5E5"> actually there</font>

299
00:11:27,630 --> 00:11:31,770
are sixty eight thousand<font color="#E5E5E5"> requests per</font>

300
00:11:29,280 --> 00:11:33,270
second in the world you know Google

301
00:11:31,770 --> 00:11:35,490
search<font color="#CCCCCC"> for the world a little bit under</font>

302
00:11:33,270 --> 00:11:37,260
200,000 youtube views per second in the

303
00:11:35,490 --> 00:11:40,050
world but there<font color="#E5E5E5"> are 1 million two</font>

304
00:11:37,260 --> 00:11:42,390
hundred thousand requests going through

305
00:11:40,050 --> 00:11:44,459
kicks per second in the world<font color="#CCCCCC"> that would</font>

306
00:11:42,390 --> 00:11:46,710
<font color="#CCCCCC">be all your ATM withdrawals all your</font>

307
00:11:44,460 --> 00:11:49,710
wire transfer all your<font color="#E5E5E5"> tax refunds all</font>

308
00:11:46,710 --> 00:11:52,320
your health payments whatever it's going

309
00:11:49,710 --> 00:11:54,600
through kicks bookings airliners use it

310
00:11:52,320 --> 00:11:55,860
heavily so everything that's critical

311
00:11:54,600 --> 00:11:58,650
everything that we care about as a

312
00:11:55,860 --> 00:12:00,660
functioning Society house function in

313
00:11:58,650 --> 00:12:03,600
society I would say is running<font color="#CCCCCC"> through</font>

314
00:12:00,660 --> 00:12:06,480
kicks so how does it<font color="#CCCCCC"> work what does it</font>

315
00:12:03,600 --> 00:12:08,490
<font color="#CCCCCC">look like let's go through that this is</font>

316
00:12:06,480 --> 00:12:10,530
like when you when you download the 3270

317
00:12:08,490 --> 00:12:12,810
emulators to connect your mainframe on

318
00:12:10,530 --> 00:12:16,620
for 23 for instance using telnet it's

319
00:12:12,810 --> 00:12:18,900
like you will go to to the main

320
00:12:16,620 --> 00:12:20,940
interface on the<font color="#E5E5E5"> mainframe and this is</font>

321
00:12:18,900 --> 00:12:22,829
this main welcoming scream it's called

322
00:12:20,940 --> 00:12:24,840
<font color="#CCCCCC">Vita for virtual civil communication</font>

323
00:12:22,830 --> 00:12:26,370
access method it's just a fancy word<font color="#CCCCCC"> to</font>

324
00:12:24,840 --> 00:12:29,310
say that is software driver that<font color="#E5E5E5"> will</font>

325
00:12:26,370 --> 00:12:30,420
handle tcp/ip connection and SN a

326
00:12:29,310 --> 00:12:32,130
connection with system network

327
00:12:30,420 --> 00:12:33,900
architecture connection etc answers

328
00:12:32,130 --> 00:12:35,400
handles communication will let you

329
00:12:33,900 --> 00:12:38,010
access apps that you will not otherwise

330
00:12:35,400 --> 00:12:39,930
see during your normal port scan and

331
00:12:38,010 --> 00:12:43,530
here you can<font color="#CCCCCC"> see that</font><font color="#E5E5E5"> we access we have</font>

332
00:12:39,930 --> 00:12:45,930
access to two apps right euro and<font color="#E5E5E5"> CSO</font>

333
00:12:43,530 --> 00:12:48,900
now euro is<font color="#E5E5E5"> do business apps will focus</font>

334
00:12:45,930 --> 00:12:51,449
on<font color="#E5E5E5"> that one here so is just a bin bash</font>

335
00:12:48,900 --> 00:12:52,920
on a z/os the operating system on a

336
00:12:51,450 --> 00:12:56,400
mainframe it's just you know<font color="#CCCCCC"> it lets you</font>

337
00:12:52,920 --> 00:12:58,560
enter<font color="#E5E5E5"> command like next at like list</font>

338
00:12:56,400 --> 00:12:59,970
user etc so we're<font color="#E5E5E5"> not going to really</font>

339
00:12:58,560 --> 00:13:02,550
<font color="#E5E5E5">talk a lot about it because it was</font>

340
00:12:59,970 --> 00:13:05,100
covered in other talks by still young

341
00:13:02,550 --> 00:13:08,339
and Chad so I'm just going to<font color="#E5E5E5"> focus on</font>

342
00:13:05,100 --> 00:13:11,550
the business app so we enter it the

343
00:13:08,340 --> 00:13:13,800
green<font color="#E5E5E5"> area you can always modify so I</font>

344
00:13:11,550 --> 00:13:16,410
under it euro and then we<font color="#E5E5E5"> get a you know</font>

345
00:13:13,800 --> 00:13:19,170
classic logon<font color="#E5E5E5"> form where we have a user</font>

346
00:13:16,410 --> 00:13:21,390
ID and password classic authentication

347
00:13:19,170 --> 00:13:23,430
if everything<font color="#E5E5E5"> checks out we go to the</font>

348
00:13:21,390 --> 00:13:25,949
<font color="#E5E5E5">core business app where you can enter</font>

349
00:13:23,430 --> 00:13:27,900
your customer number and you get details

350
00:13:25,950 --> 00:13:29,940
right<font color="#CCCCCC"> now I want you to remember</font><font color="#E5E5E5"> this</font>

351
00:13:27,900 --> 00:13:31,439
ink wanders around here we're going<font color="#E5E5E5"> to</font>

352
00:13:29,940 --> 00:13:33,990
see it later<font color="#E5E5E5"> so what</font><font color="#CCCCCC"> happened under the</font>

353
00:13:31,440 --> 00:13:34,740
hood was we were on<font color="#CCCCCC"> Vjun right the main</font>

354
00:13:33,990 --> 00:13:37,200
into

355
00:13:34,740 --> 00:13:40,980
<font color="#CCCCCC">face gateway on a mainframe we entered</font>

356
00:13:37,200 --> 00:13:43,170
euro and it took us to the kicks what is

357
00:13:40,980 --> 00:13:45,300
gold kicks region was just a fancy name

358
00:13:43,170 --> 00:13:47,339
to say it took us to the kicks instance

359
00:13:45,300 --> 00:13:49,439
that is<font color="#E5E5E5"> running and hosting that app</font>

360
00:13:47,339 --> 00:13:51,120
that's it basically it's like you know

361
00:13:49,440 --> 00:13:53,070
about you<font color="#E5E5E5"> you have multiple forking</font>

362
00:13:51,120 --> 00:13:54,420
processes that can be running<font color="#E5E5E5"> on</font><font color="#CCCCCC"> same</font>

363
00:13:53,070 --> 00:13:56,100
house all the<font color="#E5E5E5"> same thing for kicks you</font>

364
00:13:54,420 --> 00:13:59,969
can have multiple processes<font color="#CCCCCC"> english1</font>

365
00:13:56,100 --> 00:14:02,910
<font color="#E5E5E5">hosting one specific app so when</font><font color="#CCCCCC"> it took</font>

366
00:13:59,970 --> 00:14:05,670
us to the kicks instance or the kicks

367
00:14:02,910 --> 00:14:07,589
region it fired the program the<font color="#E5E5E5"> default</font>

368
00:14:05,670 --> 00:14:09,479
program that you know fires up in the

369
00:14:07,589 --> 00:14:12,149
beginning when<font color="#E5E5E5"> you enter the to the to</font>

370
00:14:09,480 --> 00:14:14,310
this kicks instance and in this case it

371
00:14:12,149 --> 00:14:17,040
was the authentication program now every

372
00:14:14,310 --> 00:14:20,189
program one kicks has a fourth digit ID

373
00:14:17,040 --> 00:14:23,550
that uniquely identifies it it's called

374
00:14:20,190 --> 00:14:26,670
a transaction ID and so in this case it

375
00:14:23,550 --> 00:14:28,770
was<font color="#CCCCCC"> csn and csn basically just a</font>

376
00:14:26,670 --> 00:14:31,500
transaction ID and you know clicks needs

377
00:14:28,770 --> 00:14:33,870
to resolve that transaction ID to a real

378
00:14:31,500 --> 00:14:36,480
program in<font color="#E5E5E5"> this case is DSHS NP which is</font>

379
00:14:33,870 --> 00:14:38,640
a default program that is shipped by IBM

380
00:14:36,480 --> 00:14:41,730
in<font color="#E5E5E5"> kicks</font><font color="#CCCCCC"> and that lets you know its</font>

381
00:14:38,640 --> 00:14:43,170
handles authentication and then like you

382
00:14:41,730 --> 00:14:44,490
know we get<font color="#E5E5E5"> the name of the program and</font>

383
00:14:43,170 --> 00:14:46,170
<font color="#E5E5E5">then something called the program</font>

384
00:14:44,490 --> 00:14:48,060
control table and then kicks resolve

385
00:14:46,170 --> 00:14:49,800
this program into you know it's real

386
00:14:48,060 --> 00:14:51,540
location in the program property stable

387
00:14:49,800 --> 00:14:53,310
and then it loads up the program<font color="#E5E5E5"> now</font>

388
00:14:51,540 --> 00:14:55,980
obviously<font color="#CCCCCC"> the program since</font><font color="#E5E5E5"> it's an</font>

389
00:14:53,310 --> 00:14:59,849
authentication program it will talk with

390
00:14:55,980 --> 00:15:03,570
a security product on mainframe and most

391
00:14:59,850 --> 00:15:05,130
of the time<font color="#E5E5E5"> on VOS it's like f so rocket</font>

392
00:15:03,570 --> 00:15:07,500
does so much more than<font color="#E5E5E5"> it's like you can</font>

393
00:15:05,130 --> 00:15:10,010
think<font color="#E5E5E5"> of it as</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> Pam on Linux but it</font>

394
00:15:07,500 --> 00:15:13,170
does so much more like it handles every

395
00:15:10,010 --> 00:15:15,180
access on the<font color="#CCCCCC"> mainframe it like</font><font color="#E5E5E5"> you want</font>

396
00:15:13,170 --> 00:15:16,860
<font color="#CCCCCC">to access a command it's like ass</font><font color="#E5E5E5"> if you</font>

397
00:15:15,180 --> 00:15:20,130
want to conjugate its record it stores

398
00:15:16,860 --> 00:15:22,589
the hash the<font color="#E5E5E5"> password hash it's des by</font>

399
00:15:20,130 --> 00:15:25,189
the way although<font color="#CCCCCC"> they are trying</font><font color="#E5E5E5"> to</font>

400
00:15:22,589 --> 00:15:28,410
change it right now<font color="#CCCCCC"> and put a es anyway</font>

401
00:15:25,190 --> 00:15:31,170
so yeah if everything checks out we get

402
00:15:28,410 --> 00:15:33,930
to the second program which has<font color="#E5E5E5"> a second</font>

403
00:15:31,170 --> 00:15:36,360
transaction ID dedicated and it's the

404
00:15:33,930 --> 00:15:39,439
<font color="#E5E5E5">same</font><font color="#CCCCCC"> as</font><font color="#E5E5E5"> ink one right so this is really</font>

405
00:15:36,360 --> 00:15:41,640
<font color="#E5E5E5">the business part of the program and</font>

406
00:15:39,440 --> 00:15:43,800
when we access it so we enter the

407
00:15:41,640 --> 00:15:46,050
customer number it loaded the file and

408
00:15:43,800 --> 00:15:48,029
what happened was we executed for

409
00:15:46,050 --> 00:15:48,949
instance this macro that will<font color="#E5E5E5"> this kicks</font>

410
00:15:48,029 --> 00:15:50,990
<font color="#E5E5E5">API that will</font>

411
00:15:48,950 --> 00:15:53,840
the file and what happened was you reply

412
00:15:50,990 --> 00:15:55,640
is only a handle of variable that points

413
00:15:53,840 --> 00:15:56,960
actually to a real location in the file

414
00:15:55,640 --> 00:15:59,180
control table which is an internal

415
00:15:56,960 --> 00:16:01,400
<font color="#E5E5E5">structure and kicks as well since it has</font>

416
00:15:59,180 --> 00:16:03,680
never been loaded well kicks gets it

417
00:16:01,400 --> 00:16:06,020
from<font color="#E5E5E5"> disk the Sun puts on the proper</font>

418
00:16:03,680 --> 00:16:08,569
locks if needed and then does the search

419
00:16:06,020 --> 00:16:11,090
in that file basically<font color="#CCCCCC"> this is how kicks</font>

420
00:16:08,570 --> 00:16:15,050
work it's nothing nothing fancy nothing

421
00:16:11,090 --> 00:16:16,970
just normal middle where actions so the

422
00:16:15,050 --> 00:16:19,609
<font color="#E5E5E5">idea is now that we pretty much you know</font>

423
00:16:16,970 --> 00:16:23,600
<font color="#E5E5E5">how it works let's try to and see what</font>

424
00:16:19,610 --> 00:16:25,520
we can do with this<font color="#E5E5E5"> stuff well the</font><font color="#CCCCCC"> first</font>

425
00:16:23,600 --> 00:16:27,770
thing we want to do the<font color="#E5E5E5"> first reflex to</font>

426
00:16:25,520 --> 00:16:29,750
have when you're on the pen testing when

427
00:16:27,770 --> 00:16:31,970
your pen testing kicks or an appt

428
00:16:29,750 --> 00:16:33,560
interactive<font color="#CCCCCC"> app on on a mainframe it</font>

429
00:16:31,970 --> 00:16:36,020
will most likely run on kicks by the way

430
00:16:33,560 --> 00:16:38,150
every interactive app the first<font color="#E5E5E5"> thing</font>

431
00:16:36,020 --> 00:16:42,020
<font color="#CCCCCC">that you want to do is</font><font color="#E5E5E5"> try to jailbreak</font>

432
00:16:38,150 --> 00:16:43,400
or get<font color="#E5E5E5"> away from the</font><font color="#CCCCCC"> apps context I like</font>

433
00:16:42,020 --> 00:16:44,990
if we're going to draw an analogy with

434
00:16:43,400 --> 00:16:47,329
the web interesting it's like finding

435
00:16:44,990 --> 00:16:50,630
the URL admin finding trying to get away

436
00:16:47,330 --> 00:16:53,540
from the app and go to the admin panel

437
00:16:50,630 --> 00:16:55,520
on kicks now on a web app you would

438
00:16:53,540 --> 00:16:57,469
obviously search for the proper URL on

439
00:16:55,520 --> 00:17:01,460
Kix it's kind of different you<font color="#CCCCCC"> have to</font>

440
00:16:57,470 --> 00:17:03,530
find<font color="#E5E5E5"> the right keys to press in order to</font>

441
00:17:01,460 --> 00:17:04,790
go back to what it's called the kicks

442
00:17:03,530 --> 00:17:07,310
terminal i'm going to show you then

443
00:17:04,790 --> 00:17:08,810
sometimes<font color="#CCCCCC"> it's pf3 sometimes p f12</font>

444
00:17:07,310 --> 00:17:11,810
sometimes it's reset and then<font color="#CCCCCC"> tf3</font>

445
00:17:08,810 --> 00:17:13,250
sometimes it's reset and etc but you

446
00:17:11,810 --> 00:17:14,750
have to find that correct combination of

447
00:17:13,250 --> 00:17:17,000
tools i'm going to show you later on by

448
00:17:14,750 --> 00:17:18,859
the way everything that<font color="#E5E5E5"> i speak about in</font>

449
00:17:17,000 --> 00:17:20,660
this talk like actually<font color="#E5E5E5"> i've included in</font>

450
00:17:18,859 --> 00:17:23,208
a tool that will automatically do all of

451
00:17:20,660 --> 00:17:24,650
this it's called Kicks down so you<font color="#CCCCCC"> don't</font>

452
00:17:23,209 --> 00:17:25,910
have to actually do pretty much

453
00:17:24,650 --> 00:17:28,130
everything here it will do it

454
00:17:25,910 --> 00:17:30,020
automatically the idea is of this<font color="#E5E5E5"> talk</font>

455
00:17:28,130 --> 00:17:31,700
is just<font color="#E5E5E5"> to be as educational as possible</font>

456
00:17:30,020 --> 00:17:33,110
so i won't take the time<font color="#E5E5E5"> to really do</font>

457
00:17:31,700 --> 00:17:34,760
this manually in front of you not just

458
00:17:33,110 --> 00:17:36,500
you know<font color="#CCCCCC"> show your man of the tool and</font>

459
00:17:34,760 --> 00:17:39,230
say hey you know this is<font color="#E5E5E5"> how to use it I</font>

460
00:17:36,500 --> 00:17:40,760
want<font color="#E5E5E5"> to really share what how so you can</font>

461
00:17:39,230 --> 00:17:43,310
debug<font color="#E5E5E5"> it and you</font><font color="#CCCCCC"> know adapted to your</font>

462
00:17:40,760 --> 00:17:44,810
needs so basically just to give you a

463
00:17:43,310 --> 00:17:47,629
<font color="#E5E5E5">quick example so for instance here we</font>

464
00:17:44,810 --> 00:17:49,159
enter euro right we go to<font color="#E5E5E5"> the education</font>

465
00:17:47,630 --> 00:17:51,620
and instead of<font color="#E5E5E5"> authentication we click</font>

466
00:17:49,160 --> 00:17:54,200
on PF 3 and then here we have<font color="#CCCCCC"> a blank</font>

467
00:17:51,620 --> 00:17:57,320
screen now<font color="#E5E5E5"> I promise you I was stuck on</font>

468
00:17:54,200 --> 00:17:59,570
this block blank screen for like a few

469
00:17:57,320 --> 00:18:01,220
<font color="#CCCCCC">hours even I think a whole day I did not</font>

470
00:17:59,570 --> 00:18:02,759
know what I was<font color="#E5E5E5"> I did not because there</font>

471
00:18:01,220 --> 00:18:05,249
was you know there's 100 book

472
00:18:02,759 --> 00:18:06,570
there's not<font color="#CCCCCC"> a single page that said what</font>

473
00:18:05,249 --> 00:18:08,459
the hell this is and<font color="#E5E5E5"> even if there is</font>

474
00:18:06,570 --> 00:18:09,629
you know good luck finding<font color="#CCCCCC"> it and</font><font color="#E5E5E5"> I</font>

475
00:18:08,459 --> 00:18:11,639
<font color="#E5E5E5">would just you know I would just click</font>

476
00:18:09,629 --> 00:18:14,009
<font color="#CCCCCC">pf3 you know which is like exit command</font>

477
00:18:11,639 --> 00:18:15,570
and I like clothes I'm like shit I got

478
00:18:14,009 --> 00:18:17,549
disconnected so I just closed it in

479
00:18:15,570 --> 00:18:20,339
stark and not know when what this was

480
00:18:17,549 --> 00:18:21,539
this was a<font color="#E5E5E5"> treasure map this was like it</font>

481
00:18:20,339 --> 00:18:23,339
happened when I realized<font color="#CCCCCC"> that when</font><font color="#E5E5E5"> I</font>

482
00:18:21,539 --> 00:18:26,879
pressed enter<font color="#E5E5E5"> just bein all a mistake</font>

483
00:18:23,339 --> 00:18:29,369
and<font color="#E5E5E5"> it said kicks TS transaction empty</font>

484
00:18:26,879 --> 00:18:32,119
is not recognized I'm like holy shit he

485
00:18:29,369 --> 00:18:34,228
is he asking<font color="#CCCCCC"> me which program to run</font>

486
00:18:32,119 --> 00:18:36,569
turns out that that's what that's what

487
00:18:34,229 --> 00:18:38,549
it was he<font color="#CCCCCC"> was asking me to enter a</font>

488
00:18:36,569 --> 00:18:42,089
transaction ID an ID that will you know

489
00:18:38,549 --> 00:18:43,679
corresponds to a program so and you know

490
00:18:42,089 --> 00:18:45,359
when<font color="#E5E5E5"> you have this new concept like it's</font>

491
00:18:43,679 --> 00:18:47,459
a whole new<font color="#E5E5E5"> world opened up to me I</font><font color="#CCCCCC"> was</font>

492
00:18:45,359 --> 00:18:50,069
<font color="#CCCCCC">like well if I can tell him when</font><font color="#E5E5E5"> where</font>

493
00:18:47,459 --> 00:18:51,779
to go like I can maybe just enter the

494
00:18:50,069 --> 00:18:53,668
name in<font color="#E5E5E5"> Quan and just bypass</font>

495
00:18:51,779 --> 00:18:55,139
authentication like are we obliged to go

496
00:18:53,669 --> 00:18:57,269
through the authentication program to

497
00:18:55,139 --> 00:19:00,379
access the business app like that's a

498
00:18:57,269 --> 00:19:02,699
valid concern and so I looked around and

499
00:19:00,379 --> 00:19:05,389
when I when I set up like I talked about

500
00:19:02,699 --> 00:19:09,809
<font color="#CCCCCC">I heard about earlier that's called um</font>

501
00:19:05,389 --> 00:19:11,819
by Dominic<font color="#CCCCCC"> white sorry he actually</font>

502
00:19:09,809 --> 00:19:13,229
developed a tool to brute force all<font color="#CCCCCC"> the</font>

503
00:19:11,819 --> 00:19:14,609
possible transactions idea because

504
00:19:13,229 --> 00:19:16,139
that's basic things that<font color="#E5E5E5"> you want to do</font>

505
00:19:14,609 --> 00:19:17,639
right four digit we can easily<font color="#E5E5E5"> brute</font>

506
00:19:16,139 --> 00:19:19,948
force it and he developed a tool that's

507
00:19:17,639 --> 00:19:22,619
called mainframe brute there's actually

508
00:19:19,949 --> 00:19:25,379
a by the like right now there's a kicks

509
00:19:22,619 --> 00:19:27,899
enumeration scrape that does much more

510
00:19:25,379 --> 00:19:30,539
than that by<font color="#CCCCCC"> Phil check it out</font><font color="#E5E5E5"> it's</font>

511
00:19:27,899 --> 00:19:32,008
shipped by default with the new nmap

512
00:19:30,539 --> 00:19:33,179
relief and<font color="#E5E5E5"> I developed</font><font color="#CCCCCC"> a tool that's</font>

513
00:19:32,009 --> 00:19:35,969
called kicks shot that will actually

514
00:19:33,179 --> 00:19:37,440
lists all the transaction<font color="#E5E5E5"> IDs and will</font>

515
00:19:35,969 --> 00:19:39,629
connect to<font color="#E5E5E5"> each one of them and take a</font>

516
00:19:37,440 --> 00:19:41,309
screenshot but<font color="#E5E5E5"> basically it but we can</font>

517
00:19:39,629 --> 00:19:44,369
go we can do much better than<font color="#E5E5E5"> this we</font>

518
00:19:41,309 --> 00:19:46,259
can go much further they're actually

519
00:19:44,369 --> 00:19:50,249
there are default programs that are

520
00:19:46,259 --> 00:19:52,799
shipped with every kicks installation by

521
00:19:50,249 --> 00:19:55,049
IBM and we saw one earlier that's called

522
00:19:52,799 --> 00:19:57,418
<font color="#CCCCCC">csn which is the login program but there</font>

523
00:19:55,049 --> 00:19:59,489
are much you know others that are much

524
00:19:57,419 --> 00:20:02,549
more interesting and so this<font color="#E5E5E5"> one for</font>

525
00:19:59,489 --> 00:20:04,079
instance<font color="#CCCCCC"> CMG does the name you know like</font>

526
00:20:02,549 --> 00:20:05,969
master<font color="#CCCCCC"> German will console of course you</font>

527
00:20:04,079 --> 00:20:07,759
want<font color="#E5E5E5"> to check</font><font color="#CCCCCC"> it so there's CMT and</font>

528
00:20:05,969 --> 00:20:09,959
we're going to<font color="#E5E5E5"> check it what it does is</font>

529
00:20:07,759 --> 00:20:11,909
<font color="#E5E5E5">from that kicks terminal you can enter</font>

530
00:20:09,959 --> 00:20:13,829
CMT and this is the master terminal

531
00:20:11,909 --> 00:20:16,980
consonant consulate when<font color="#E5E5E5"> they handle</font>

532
00:20:13,829 --> 00:20:18,690
every resource on kicks right this

533
00:20:16,980 --> 00:20:20,250
is really<font color="#CCCCCC"> the admin panel like if you</font>

534
00:20:18,690 --> 00:20:23,160
can access this it's<font color="#E5E5E5"> like gold and you</font>

535
00:20:20,250 --> 00:20:26,480
can change priorities of tasks<font color="#E5E5E5"> list the</font>

536
00:20:23,160 --> 00:20:30,179
list of files that<font color="#E5E5E5"> are used by the app</font>

537
00:20:26,480 --> 00:20:32,730
shut down the whole system you can like

538
00:20:30,179 --> 00:20:34,140
you can basically remove files that were

539
00:20:32,730 --> 00:20:37,260
defined or programs that<font color="#E5E5E5"> were defined</font>

540
00:20:34,140 --> 00:20:39,510
you<font color="#CCCCCC"> can like</font><font color="#E5E5E5"> list resources etc so we're</font>

541
00:20:37,260 --> 00:20:41,040
just going to see a quick demo here for

542
00:20:39,510 --> 00:20:42,510
instance instead of brute force in the

543
00:20:41,040 --> 00:20:45,780
transactions we can just<font color="#E5E5E5"> you know in</font>

544
00:20:42,510 --> 00:20:47,520
type inquire or I and then we type

545
00:20:45,780 --> 00:20:49,020
transaction and we get a list of all<font color="#E5E5E5"> the</font>

546
00:20:47,520 --> 00:20:53,100
transactions so here we are on the kicks

547
00:20:49,020 --> 00:20:54,510
terminal which<font color="#CCCCCC"> I PMG and inquire</font>

548
00:20:53,100 --> 00:20:56,070
transaction I'm<font color="#E5E5E5"> going to access all the</font>

549
00:20:54,510 --> 00:20:58,440
list of transactions and we can<font color="#CCCCCC"> zoom in</font>

550
00:20:56,070 --> 00:21:01,260
on the ones that interest us and so here

551
00:20:58,440 --> 00:21:03,030
for instance we see that well the

552
00:21:01,260 --> 00:21:04,410
program is called euro euro in one and

553
00:21:03,030 --> 00:21:06,690
<font color="#E5E5E5">like I said in the beginning everything</font>

554
00:21:04,410 --> 00:21:10,650
in green you<font color="#E5E5E5"> can edit so if you want to</font>

555
00:21:06,690 --> 00:21:13,710
disable it you just change<font color="#E5E5E5"> ene to this</font>

556
00:21:10,650 --> 00:21:15,750
basically<font color="#E5E5E5"> the</font><font color="#CCCCCC"> is and that's it and</font>

557
00:21:13,710 --> 00:21:17,880
that's how we bring down an application

558
00:21:15,750 --> 00:21:22,620
that you know processes 300,000 run

559
00:21:17,880 --> 00:21:25,799
euros per<font color="#CCCCCC"> 0 per</font><font color="#E5E5E5"> day and your client gets</font>

560
00:21:22,620 --> 00:21:27,418
pissed off and if<font color="#E5E5E5"> you want to get</font>

561
00:21:25,799 --> 00:21:28,918
<font color="#CCCCCC">information about</font><font color="#E5E5E5"> the system it like you</font>

562
00:21:27,419 --> 00:21:30,660
can go much more you can get<font color="#E5E5E5"> information</font>

563
00:21:28,919 --> 00:21:32,250
about<font color="#E5E5E5"> the system so you can type just</font>

564
00:21:30,660 --> 00:21:35,700
<font color="#E5E5E5">inquire system and you can see</font><font color="#CCCCCC"> that we</font>

565
00:21:32,250 --> 00:21:37,860
are not kick 3 20 s 1 dot Chad we have a

566
00:21:35,700 --> 00:21:39,960
default user which is the equivalent to

567
00:21:37,860 --> 00:21:42,449
the anonymous user on ftp right so here

568
00:21:39,960 --> 00:21:44,370
we are we have kicks user an ftp it's

569
00:21:42,450 --> 00:21:45,900
anonymous because<font color="#E5E5E5"> remember we skipped</font>

570
00:21:44,370 --> 00:21:48,899
authentication so<font color="#E5E5E5"> it's assigned as a</font>

571
00:21:45,900 --> 00:21:50,549
default user ID so every thing that

572
00:21:48,900 --> 00:21:52,860
we're doing right now<font color="#CCCCCC"> we are doing it as</font>

573
00:21:50,549 --> 00:21:56,070
an anonymous user that's not<font color="#E5E5E5"> the</font>

574
00:21:52,860 --> 00:21:57,959
interesting part about it<font color="#E5E5E5"> and you can</font>

575
00:21:56,070 --> 00:21:59,639
like you know do some users crap and you

576
00:21:57,960 --> 00:22:01,650
can<font color="#E5E5E5"> check for you other user IDs that</font>

577
00:21:59,640 --> 00:22:03,690
<font color="#CCCCCC">aren't currently connected to the kicks</font>

578
00:22:01,650 --> 00:22:06,150
and get user IDs to later brute force

579
00:22:03,690 --> 00:22:09,390
and do some<font color="#E5E5E5"> very interesting stuff on TS</font>

580
00:22:06,150 --> 00:22:10,500
o<font color="#E5E5E5"> them so if you want to list the file</font>

581
00:22:09,390 --> 00:22:12,540
because that will we're after right

582
00:22:10,500 --> 00:22:14,520
we're<font color="#E5E5E5"> after data but after financial</font>

583
00:22:12,540 --> 00:22:16,080
<font color="#E5E5E5">records we</font><font color="#CCCCCC"> wrap</font><font color="#E5E5E5"> your credit card data so</font>

584
00:22:14,520 --> 00:22:17,790
it's going<font color="#E5E5E5"> to live the files are used by</font>

585
00:22:16,080 --> 00:22:19,439
the current business apps there are

586
00:22:17,790 --> 00:22:22,020
installed on cakes you can just see

587
00:22:19,440 --> 00:22:23,429
empty inquired about file and you can

588
00:22:22,020 --> 00:22:26,450
<font color="#E5E5E5">see here that files have a bunch of</font>

589
00:22:23,429 --> 00:22:29,220
properties<font color="#CCCCCC"> closed disabled readable and</font>

590
00:22:26,450 --> 00:22:30,850
you know there unidentified that

591
00:22:29,220 --> 00:22:33,280
identifies their location

592
00:22:30,850 --> 00:22:35,620
some to read the file it has to be

593
00:22:33,280 --> 00:22:37,690
<font color="#CCCCCC">opened not close it has to be enabled</font>

594
00:22:35,620 --> 00:22:40,149
<font color="#CCCCCC">and it has to</font><font color="#E5E5E5"> be readable and you</font>

595
00:22:37,690 --> 00:22:43,660
updated obviously you need to update or

596
00:22:40,150 --> 00:22:45,580
add attributes so I again everything in

597
00:22:43,660 --> 00:22:47,140
green you can edit so if this file is

598
00:22:45,580 --> 00:22:50,139
closed you can just open it and make it

599
00:22:47,140 --> 00:22:53,860
enable then just read it and files on

600
00:22:50,140 --> 00:22:56,110
z/os are different basically they<font color="#CCCCCC"> have a</font>

601
00:22:53,860 --> 00:22:57,280
high-level qualifier qualifier like some

602
00:22:56,110 --> 00:22:58,990
people<font color="#CCCCCC"> are going to kill</font><font color="#E5E5E5"> me for saying</font>

603
00:22:57,280 --> 00:23:00,639
this but it's like DNS right you have

604
00:22:58,990 --> 00:23:03,480
multiple qualifiers that are separated

605
00:23:00,640 --> 00:23:06,250
by<font color="#CCCCCC"> point that's it by</font><font color="#E5E5E5"> that that's it and</font>

606
00:23:03,480 --> 00:23:08,860
the files on kicks are different they're

607
00:23:06,250 --> 00:23:11,260
special they're called v sm ke ases file

608
00:23:08,860 --> 00:23:14,590
this<font color="#E5E5E5"> is a fancy name for saying it's a</font>

609
00:23:11,260 --> 00:23:18,070
file that has<font color="#E5E5E5"> collins one colin is an</font>

610
00:23:14,590 --> 00:23:20,669
index so a number and the other<font color="#E5E5E5"> colin is</font>

611
00:23:18,070 --> 00:23:25,510
a value so for instance you would have

612
00:23:20,670 --> 00:23:28,020
you know<font color="#CCCCCC"> key 0001</font><font color="#E5E5E5"> and you know the data</font>

613
00:23:25,510 --> 00:23:30,760
about customer number 0 0 0 1 that's it

614
00:23:28,020 --> 00:23:32,950
it's just like<font color="#E5E5E5"> an index file if you will</font>

615
00:23:30,760 --> 00:23:35,890
and you can get<font color="#E5E5E5"> information more</font>

616
00:23:32,950 --> 00:23:37,990
information about the about the the file

617
00:23:35,890 --> 00:23:39,490
<font color="#CCCCCC">actually by typing you know by typing</font>

618
00:23:37,990 --> 00:23:41,200
enter on the<font color="#E5E5E5"> file</font><font color="#CCCCCC"> and you can get its</font>

619
00:23:39,490 --> 00:23:44,410
relocation the<font color="#E5E5E5"> key length which is the</font>

620
00:23:41,200 --> 00:23:46,990
index Olympics extra so let's and like I

621
00:23:44,410 --> 00:23:49,540
said oh yeah PF perform shut down you

622
00:23:46,990 --> 00:23:51,910
<font color="#E5E5E5">can just shut down</font><font color="#CCCCCC"> the whole kicks a</font>

623
00:23:49,540 --> 00:23:53,409
funny story when<font color="#E5E5E5"> you when you type when</font>

624
00:23:51,910 --> 00:23:55,780
I said this<font color="#E5E5E5"> to take a screen basically</font>

625
00:23:53,410 --> 00:23:57,520
<font color="#CCCCCC">you know I took my screen I was happy</font>

626
00:23:55,780 --> 00:23:59,710
<font color="#CCCCCC">okay i have my screen for the conference</font>

627
00:23:57,520 --> 00:24:02,320
but you know when i clicked on PF 3 to

628
00:23:59,710 --> 00:24:03,940
go back the nasty thing about geo ice is

629
00:24:02,320 --> 00:24:07,060
that when you click on ps3 to go back it

630
00:24:03,940 --> 00:24:08,350
sends the command then it exit<font color="#E5E5E5"> and so</font>

631
00:24:07,060 --> 00:24:11,110
actually it's send the command and it

632
00:24:08,350 --> 00:24:13,360
<font color="#E5E5E5">perform the shutdown and i was going to</font>

633
00:24:11,110 --> 00:24:17,229
screw it so that's a second way to screw

634
00:24:13,360 --> 00:24:20,110
up your client if<font color="#CCCCCC"> you want so like I</font>

635
00:24:17,230 --> 00:24:22,360
said CMT can give you much a lot<font color="#E5E5E5"> of</font>

636
00:24:20,110 --> 00:24:24,879
information<font color="#CCCCCC"> about the system about the</font>

637
00:24:22,360 --> 00:24:27,520
kicks but it will not let you read the

638
00:24:24,880 --> 00:24:30,580
<font color="#CCCCCC">content</font><font color="#E5E5E5"> of the file we execute code etc</font>

639
00:24:27,520 --> 00:24:34,320
that you cannot do with CMT we need

640
00:24:30,580 --> 00:24:38,290
another tool that's called seaside

641
00:24:34,320 --> 00:24:40,689
that's the second third default program

642
00:24:38,290 --> 00:24:42,850
looking at today and it basically what

643
00:24:40,690 --> 00:24:44,730
it does it lets you execute kicks API so

644
00:24:42,850 --> 00:24:47,889
remember when<font color="#E5E5E5"> I talked about</font>

645
00:24:44,730 --> 00:24:50,260
exact kicks read file these kind of API

646
00:24:47,890 --> 00:24:52,000
what it<font color="#E5E5E5"> just lets you execute them and</font>

647
00:24:50,260 --> 00:24:54,370
so if<font color="#E5E5E5"> you have access to this one again</font>

648
00:24:52,000 --> 00:24:57,430
it like we're going<font color="#E5E5E5"> to do</font><font color="#CCCCCC"> some pretty</font>

649
00:24:54,370 --> 00:24:59,429
nasty stuff using this before program so

650
00:24:57,430 --> 00:25:01,660
here<font color="#E5E5E5"> we can see that we can read files</font>

651
00:24:59,430 --> 00:25:02,980
we're<font color="#E5E5E5"> going to look at school open</font>

652
00:25:01,660 --> 00:25:05,650
<font color="#E5E5E5">closed later but</font><font color="#CCCCCC"> you can see that</font><font color="#E5E5E5"> we've</font>

653
00:25:02,980 --> 00:25:08,320
<font color="#E5E5E5">been pretty much like execute a lot of</font>

654
00:25:05,650 --> 00:25:09,400
stuff on them on the program so for

655
00:25:08,320 --> 00:25:11,439
<font color="#CCCCCC">instance if you want to read the file</font>

656
00:25:09,400 --> 00:25:14,110
<font color="#CCCCCC">you just read file you type its name</font>

657
00:25:11,440 --> 00:25:15,730
that you got some CMT or id0 for the key

658
00:25:14,110 --> 00:25:17,649
index that you want<font color="#E5E5E5"> to read obviously we</font>

659
00:25:15,730 --> 00:25:19,390
don't know its key index zero exists so

660
00:25:17,650 --> 00:25:22,210
we just add the keyword greater than

661
00:25:19,390 --> 00:25:24,400
equal and you and<font color="#E5E5E5"> we get well not all</font>

662
00:25:22,210 --> 00:25:27,190
<font color="#CCCCCC">the data but some data right and this</font><font color="#E5E5E5"> is</font>

663
00:25:24,400 --> 00:25:29,320
the index 400001 so to get all the data

664
00:25:27,190 --> 00:25:31,930
we need to store it in a variable so we

665
00:25:29,320 --> 00:25:34,870
add the keyword into ampersand data and

666
00:25:31,930 --> 00:25:37,180
it swords the value that is returned

667
00:25:34,870 --> 00:25:38,949
into a variable and when you click on PS

668
00:25:37,180 --> 00:25:40,630
<font color="#E5E5E5">5 which is the variable panel you can</font>

669
00:25:38,950 --> 00:25:42,970
access<font color="#E5E5E5"> the whole there so to summarize</font>

670
00:25:40,630 --> 00:25:47,140
to read the file we<font color="#E5E5E5"> have to find the</font>

671
00:25:42,970 --> 00:25:49,420
right<font color="#E5E5E5"> key combination go to CMT inquire</font>

672
00:25:47,140 --> 00:25:52,360
about the files list them get the

673
00:25:49,420 --> 00:25:54,640
properties like key index etc make them

674
00:25:52,360 --> 00:25:57,879
make the file readable enabled and open

675
00:25:54,640 --> 00:26:02,320
and then go to seaside and then I'd rate

676
00:25:57,880 --> 00:26:04,420
overall the indexes that's free that's

677
00:26:02,320 --> 00:26:06,790
<font color="#E5E5E5">pretty hard to do so basically that's</font>

678
00:26:04,420 --> 00:26:08,530
what I have the tool comes in handy it

679
00:26:06,790 --> 00:26:10,210
will perform all this stuff<font color="#E5E5E5"> for you so</font>

680
00:26:08,530 --> 00:26:11,770
here we say that we can access<font color="#CCCCCC"> euro that</font>

681
00:26:10,210 --> 00:26:13,090
we're<font color="#E5E5E5"> going to</font><font color="#CCCCCC"> Europe lie so we'll find</font>

682
00:26:11,770 --> 00:26:15,129
the<font color="#CCCCCC"> right combination of tools and</font><font color="#E5E5E5"> then</font>

683
00:26:13,090 --> 00:26:16,600
it will list it will change the

684
00:26:15,130 --> 00:26:18,940
attributes and it will list all the

685
00:26:16,600 --> 00:26:22,629
contents of the file automatically for

686
00:26:18,940 --> 00:26:25,780
you so that's<font color="#E5E5E5"> the first look but</font>

687
00:26:22,630 --> 00:26:27,880
basically<font color="#E5E5E5"> like right here we just read</font>

688
00:26:25,780 --> 00:26:30,810
files you know<font color="#E5E5E5"> like customer details</font>

689
00:26:27,880 --> 00:26:32,950
file on the mainframes remember when we

690
00:26:30,810 --> 00:26:34,480
<font color="#E5E5E5">actually could have stopped here someone</font>

691
00:26:32,950 --> 00:26:37,300
<font color="#E5E5E5">I submitted to the conference because I</font>

692
00:26:34,480 --> 00:26:38,860
was so happy because basically remember

693
00:26:37,300 --> 00:26:41,230
when you're in a woman what pen chest

694
00:26:38,860 --> 00:26:42,610
you're like oh yeah I discovered you

695
00:26:41,230 --> 00:26:44,380
<font color="#CCCCCC">know this function that will let me read</font>

696
00:26:42,610 --> 00:26:46,840
files or this path traversal that reads

697
00:26:44,380 --> 00:26:47,650
files and your customer goes so and

698
00:26:46,840 --> 00:26:49,419
you're like well I<font color="#E5E5E5"> can read</font>

699
00:26:47,650 --> 00:26:51,430
configuration files i can get password

700
00:26:49,420 --> 00:26:53,980
data password of<font color="#CCCCCC"> the database look I</font>

701
00:26:51,430 --> 00:26:55,900
have it and he says<font color="#CCCCCC"> well so it's bound</font>

702
00:26:53,980 --> 00:26:58,150
of firewall you can access it like you

703
00:26:55,900 --> 00:26:59,380
<font color="#E5E5E5">know fuck off well you</font>

704
00:26:58,150 --> 00:27:02,290
have this argument on a mainframe

705
00:26:59,380 --> 00:27:04,330
because on the mainframe every file that

706
00:27:02,290 --> 00:27:06,310
you read at<font color="#CCCCCC"> least in the US partition</font>

707
00:27:04,330 --> 00:27:08,560
it's a customer file like if you can

708
00:27:06,310 --> 00:27:10,360
<font color="#E5E5E5">read</font><font color="#CCCCCC"> files you know the company is</font>

709
00:27:08,560 --> 00:27:12,520
screwed you have their most critical

710
00:27:10,360 --> 00:27:14,889
data there's no other<font color="#E5E5E5"> nod there's no</font>

711
00:27:12,520 --> 00:27:16,360
<font color="#E5E5E5">other hoop to jump over that's it that's</font>

712
00:27:14,890 --> 00:27:18,430
the<font color="#E5E5E5"> end of the tunnel if you get access</font>

713
00:27:16,360 --> 00:27:20,290
to this<font color="#E5E5E5"> machine it's done the company</font>

714
00:27:18,430 --> 00:27:21,850
can just like you know close the door

715
00:27:20,290 --> 00:27:24,159
because you access all the list of<font color="#E5E5E5"> its</font>

716
00:27:21,850 --> 00:27:26,290
file of its customers<font color="#CCCCCC"> and all the most</font>

717
00:27:24,160 --> 00:27:28,330
important data so it is a pretty big

718
00:27:26,290 --> 00:27:30,220
<font color="#CCCCCC">deal to be able to read files and in the</font>

719
00:27:28,330 --> 00:27:32,439
end<font color="#E5E5E5"> that's what we want right we want to</font>

720
00:27:30,220 --> 00:27:33,880
read<font color="#E5E5E5"> why we don't care about executing a</font>

721
00:27:32,440 --> 00:27:37,390
shell or<font color="#E5E5E5"> getting domain admin privileges</font>

722
00:27:33,880 --> 00:27:39,490
if customer data is not in<font color="#E5E5E5"> Windows right</font>

723
00:27:37,390 --> 00:27:42,160
we want customer data that's it we got

724
00:27:39,490 --> 00:27:44,260
them we can you know<font color="#CCCCCC"> continue our duties</font>

725
00:27:42,160 --> 00:27:46,450
but since we're in<font color="#E5E5E5"> a hacking con I</font>

726
00:27:44,260 --> 00:27:48,010
figured well we kind of need to<font color="#E5E5E5"> execute</font>

727
00:27:46,450 --> 00:27:52,390
go like people want to see some shell

728
00:27:48,010 --> 00:27:54,220
code so let's dig deeper now kicks has

729
00:27:52,390 --> 00:27:57,400
no CSI has a nice feature that's called

730
00:27:54,220 --> 00:28:00,580
spool spool functions now a spool on a

731
00:27:57,400 --> 00:28:02,680
mainframe is just the output of a

732
00:28:00,580 --> 00:28:04,960
program that's it it's just a temporary

733
00:28:02,680 --> 00:28:08,440
<font color="#E5E5E5">file or just a file that has the output</font>

734
00:28:04,960 --> 00:28:12,820
of a program and kicks lets you create

735
00:28:08,440 --> 00:28:15,310
such<font color="#E5E5E5"> files and push them to some</font>

736
00:28:12,820 --> 00:28:17,290
components or more likely actually to

737
00:28:15,310 --> 00:28:21,310
some users well let's say components on

738
00:28:17,290 --> 00:28:23,379
<font color="#E5E5E5">gos and so the</font><font color="#CCCCCC"> idea is basically</font><font color="#E5E5E5"> to</font>

739
00:28:21,310 --> 00:28:25,629
create a spool file this kind<font color="#E5E5E5"> of file</font>

740
00:28:23,380 --> 00:28:27,610
<font color="#E5E5E5">write code into it and then push it</font>

741
00:28:25,630 --> 00:28:28,750
<font color="#E5E5E5">somewhere and what we're</font><font color="#CCCCCC"> going to push</font>

742
00:28:27,610 --> 00:28:31,330
it we're going<font color="#E5E5E5"> to push it to some work</font>

743
00:28:28,750 --> 00:28:33,490
some place called the internal reader or

744
00:28:31,330 --> 00:28:35,889
the job entry scheduler now the internal

745
00:28:33,490 --> 00:28:37,990
reader it used<font color="#E5E5E5"> to be a physical slots on</font>

746
00:28:35,890 --> 00:28:40,390
a mainframe where<font color="#E5E5E5"> people would put punch</font>

747
00:28:37,990 --> 00:28:43,480
cards that contain code push it and the

748
00:28:40,390 --> 00:28:44,800
punch cards get executed now<font color="#CCCCCC"> obviously</font>

749
00:28:43,480 --> 00:28:47,170
there's<font color="#CCCCCC"> no such thing as</font><font color="#E5E5E5"> a physical</font>

750
00:28:44,800 --> 00:28:49,180
enjoy internal reader now job entry

751
00:28:47,170 --> 00:28:50,590
scheduler on a modern mainframe they

752
00:28:49,180 --> 00:28:52,600
virtualized it but it's still an

753
00:28:50,590 --> 00:28:54,730
internal component and if you write a

754
00:28:52,600 --> 00:28:57,370
file you push it to this internal reader

755
00:28:54,730 --> 00:29:00,220
it will execute it so the idea<font color="#E5E5E5"> is the</font>

756
00:28:57,370 --> 00:29:02,979
theory behind this is the soup use kicks

757
00:29:00,220 --> 00:29:06,490
to write a spool file that will contain

758
00:29:02,980 --> 00:29:08,140
code first we open yeah we open a spool

759
00:29:06,490 --> 00:29:10,780
we get the file descriptor that's called

760
00:29:08,140 --> 00:29:11,890
the chokin classic stuff we write line

761
00:29:10,780 --> 00:29:13,480
by line<font color="#E5E5E5"> and then we</font>

762
00:29:11,890 --> 00:29:17,050
shit to the internal reader and

763
00:29:13,480 --> 00:29:18,910
hopefully we get our<font color="#E5E5E5"> shell so it goes</font>

764
00:29:17,050 --> 00:29:21,040
something like this you use the spool

765
00:29:18,910 --> 00:29:24,280
use the seaside menu you go to spool

766
00:29:21,040 --> 00:29:26,110
open user ID this is critical you put

767
00:29:24,280 --> 00:29:28,180
into your dr which is the handle for

768
00:29:26,110 --> 00:29:30,070
internal reader not local we wanna

769
00:29:28,180 --> 00:29:33,100
execute code on this mainframe we<font color="#E5E5E5"> got a</font>

770
00:29:30,070 --> 00:29:35,800
<font color="#CCCCCC">token the scripture and then we use and</font>

771
00:29:33,100 --> 00:29:37,840
<font color="#E5E5E5">then we prepare our code now</font><font color="#CCCCCC"> i know most</font>

772
00:29:35,800 --> 00:29:39,580
of you are not familiar with<font color="#E5E5E5"> GCL which</font>

773
00:29:37,840 --> 00:29:41,560
is the job control language which is the

774
00:29:39,580 --> 00:29:45,850
you know the scripting language that is

775
00:29:41,560 --> 00:29:47,470
used to run a program on a mainframe but

776
00:29:45,850 --> 00:29:51,520
<font color="#E5E5E5">basically</font><font color="#CCCCCC"> i just want</font><font color="#E5E5E5"> you to focus on</font>

777
00:29:47,470 --> 00:29:53,110
this like ftp 192 168 1 18 this is like

778
00:29:51,520 --> 00:29:55,360
we just launched in a basic HTTP

779
00:29:53,110 --> 00:29:58,479
connection to a server just to be sure

780
00:29:55,360 --> 00:29:59,649
that it's<font color="#CCCCCC"> possible and here we can see</font>

781
00:29:58,480 --> 00:30:00,940
<font color="#E5E5E5">that we have an to gate to the ftp n</font>

782
00:29:59,650 --> 00:30:03,220
which has executed their command that's

783
00:30:00,940 --> 00:30:05,350
it that's it's as simple as that and

784
00:30:03,220 --> 00:30:10,030
<font color="#CCCCCC">actually it's not that difficulty</font><font color="#E5E5E5"> just</font>

785
00:30:05,350 --> 00:30:11,889
you know to to learn and honestly so we

786
00:30:10,030 --> 00:30:13,780
all right out we write our code you know

787
00:30:11,890 --> 00:30:17,290
line by line using<font color="#CCCCCC"> the variable panel</font>

788
00:30:13,780 --> 00:30:20,379
and pull right and we<font color="#E5E5E5"> just</font><font color="#CCCCCC"> one once</font>

789
00:30:17,290 --> 00:30:22,240
we're done spool close we just closed

790
00:30:20,380 --> 00:30:24,670
the file and will you know push it to

791
00:30:22,240 --> 00:30:27,010
the internal reader and I was<font color="#E5E5E5"> trying</font>

792
00:30:24,670 --> 00:30:30,040
this for weeks just to understand how it

793
00:30:27,010 --> 00:30:32,379
<font color="#CCCCCC">works and</font><font color="#E5E5E5"> get it done and finally</font>

794
00:30:30,040 --> 00:30:34,450
finally I noticed that<font color="#E5E5E5"> hey I got the</font>

795
00:30:32,380 --> 00:30:37,900
connection back you be it works we<font color="#E5E5E5"> can</font>

796
00:30:34,450 --> 00:30:40,810
execute code now<font color="#CCCCCC"> obviously this sucks</font>

797
00:30:37,900 --> 00:30:42,820
for so many<font color="#E5E5E5"> reasons we're not going to</font>

798
00:30:40,810 --> 00:30:46,270
write a complete you know rebirth she'll

799
00:30:42,820 --> 00:30:48,520
just on the<font color="#E5E5E5"> PF I've menu it's horrible</font>

800
00:30:46,270 --> 00:30:51,300
and what if we<font color="#E5E5E5"> want</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> know some real</font>

801
00:30:48,520 --> 00:30:54,639
reverse<font color="#E5E5E5"> shell how to do it etc so</font>

802
00:30:51,300 --> 00:30:57,040
basically this is where<font color="#E5E5E5"> I decided to</font>

803
00:30:54,640 --> 00:30:58,870
write<font color="#CCCCCC"> a tool that will do it so</font>

804
00:30:57,040 --> 00:31:00,670
basically<font color="#CCCCCC"> we will go with this reverse</font>

805
00:30:58,870 --> 00:31:02,679
shell so it's a<font color="#E5E5E5"> little bit more</font>

806
00:31:00,670 --> 00:31:05,500
complicated than the previous one who

807
00:31:02,680 --> 00:31:07,840
this is still GCL this part is<font color="#E5E5E5"> GCL this</font>

808
00:31:05,500 --> 00:31:10,240
part is GTL right so we<font color="#E5E5E5"> just create a</font>

809
00:31:07,840 --> 00:31:13,270
file this is just some carbs to say<font color="#CCCCCC"> I</font>

810
00:31:10,240 --> 00:31:14,950
want<font color="#CCCCCC"> to create a file on disk and I'm</font>

811
00:31:13,270 --> 00:31:16,720
gonna write this content into it now

812
00:31:14,950 --> 00:31:18,400
this contact it's just it's in breck

813
00:31:16,720 --> 00:31:20,380
scripting language<font color="#E5E5E5"> it's kind of the</font>

814
00:31:18,400 --> 00:31:21,940
equivalent<font color="#CCCCCC"> of</font><font color="#E5E5E5"> Python and vos right just</font>

815
00:31:20,380 --> 00:31:25,060
a scripting language it's easy to

816
00:31:21,940 --> 00:31:25,580
perform some sockets start etc so it's

817
00:31:25,060 --> 00:31:28,280
very

818
00:31:25,580 --> 00:31:29,800
very handy<font color="#E5E5E5"> and so we</font><font color="#CCCCCC"> just you know open</font>

819
00:31:28,280 --> 00:31:32,889
the connection reverse connection and

820
00:31:29,800 --> 00:31:36,020
interact and execute whatever stuff we

821
00:31:32,890 --> 00:31:37,820
push to it and in the<font color="#CCCCCC"> end like we write</font>

822
00:31:36,020 --> 00:31:40,550
this into a file that's called<font color="#CCCCCC"> confuser</font>

823
00:31:37,820 --> 00:31:44,270
<font color="#E5E5E5">IV and then we execute that file that's</font>

824
00:31:40,550 --> 00:31:46,159
it and like<font color="#CCCCCC"> the it goes something like</font>

825
00:31:44,270 --> 00:31:48,580
this so we open a connection with nat

826
00:31:46,160 --> 00:31:51,860
gas and then we use<font color="#E5E5E5"> Kicks down and</font>

827
00:31:48,580 --> 00:31:53,330
specify the payload minus s reversed

828
00:31:51,860 --> 00:31:57,110
year so<font color="#CCCCCC"> unlike I said it will find the</font>

829
00:31:53,330 --> 00:31:59,629
proper way to bypass terminal and then

830
00:31:57,110 --> 00:32:03,169
write GCL and then you can see<font color="#E5E5E5"> that we</font>

831
00:31:59,630 --> 00:32:10,610
have execution on the mainframe and so

832
00:32:03,170 --> 00:32:12,470
here we have a<font color="#CCCCCC"> gho shell now</font><font color="#E5E5E5"> I know most</font>

833
00:32:10,610 --> 00:32:14,300
of you are not familiar with GTL so I do

834
00:32:12,470 --> 00:32:16,400
not<font color="#E5E5E5"> expect everyone to write this kind</font>

835
00:32:14,300 --> 00:32:18,430
of code so I just included some you know

836
00:32:16,400 --> 00:32:21,230
classic payloads like for<font color="#CCCCCC"> instance</font>

837
00:32:18,430 --> 00:32:22,940
<font color="#E5E5E5">reversed ESL will open you at ESO shell</font>

838
00:32:21,230 --> 00:32:24,560
you can<font color="#E5E5E5"> write commands the simple access</font>

839
00:32:22,940 --> 00:32:26,270
to your so is quite basic you<font color="#CCCCCC"> know what</font>

840
00:32:24,560 --> 00:32:28,310
you<font color="#E5E5E5"> have netstat command you have think</font>

841
00:32:26,270 --> 00:32:31,460
command you have placed user with free

842
00:32:28,310 --> 00:32:32,960
documented if you you know<font color="#CCCCCC"> reversed ESL</font>

843
00:32:31,460 --> 00:32:35,150
binds here so if you're not familiar

844
00:32:32,960 --> 00:32:36,860
with<font color="#E5E5E5"> gso</font><font color="#CCCCCC"> they're like there are Unix</font>

845
00:32:35,150 --> 00:32:39,710
commands that you can execute because on

846
00:32:36,860 --> 00:32:41,510
every cos since<font color="#CCCCCC"> 2000</font><font color="#E5E5E5"> and something</font>

847
00:32:39,710 --> 00:32:44,930
there's a unique spot POSIX compliant

848
00:32:41,510 --> 00:32:46,610
unix with regular ID find command like

849
00:32:44,930 --> 00:32:48,800
well you know you you can find your way

850
00:32:46,610 --> 00:32:50,719
around it and so you can<font color="#E5E5E5"> have you can</font>

851
00:32:48,800 --> 00:32:53,030
<font color="#E5E5E5">ask for a reverse unix shell or a bind</font>

852
00:32:50,720 --> 00:32:54,620
shell if you want to exfiltrate file

853
00:32:53,030 --> 00:32:57,110
using this kind of technique you can

854
00:32:54,620 --> 00:32:59,179
like execute ftp commands using the

855
00:32:57,110 --> 00:33:00,949
kicks pounds so it's automated if you

856
00:32:59,180 --> 00:33:03,170
don't want to leave<font color="#E5E5E5"> your payload on this</font>

857
00:33:00,950 --> 00:33:05,060
you can just write a stager and the

858
00:33:03,170 --> 00:33:07,400
reverse show will be executed in memory

859
00:33:05,060 --> 00:33:09,379
if you use<font color="#CCCCCC"> these two payloads reverse</font>

860
00:33:07,400 --> 00:33:11,030
writes and directs and if<font color="#E5E5E5"> your feels</font>

861
00:33:09,380 --> 00:33:12,680
oddly enough in<font color="#CCCCCC"> GCL you can just write</font>

862
00:33:11,030 --> 00:33:15,620
your own teacher so these payloads are

863
00:33:12,680 --> 00:33:17,090
all included in the tool so you know<font color="#E5E5E5"> the</font>

864
00:33:15,620 --> 00:33:21,350
<font color="#CCCCCC">idea is just to make it easy for</font>

865
00:33:17,090 --> 00:33:23,600
everybody to have mainframes the second

866
00:33:21,350 --> 00:33:25,939
awesome stuff<font color="#CCCCCC"> are not going</font><font color="#E5E5E5"> to notice</font>

867
00:33:23,600 --> 00:33:29,780
<font color="#E5E5E5">but we did this user we had this user</font>

868
00:33:25,940 --> 00:33:31,790
start to and remember<font color="#E5E5E5"> we were running as</font>

869
00:33:29,780 --> 00:33:35,180
anonymous user but the code got executed

870
00:33:31,790 --> 00:33:37,420
using the actually<font color="#CCCCCC"> the user that was</font>

871
00:33:35,180 --> 00:33:38,620
powering the kicks process

872
00:33:37,420 --> 00:33:41,110
and you can see here that we have the

873
00:33:38,620 --> 00:33:43,600
attribute protected which means this

874
00:33:41,110 --> 00:33:45,370
user can is not supposed<font color="#E5E5E5"> to have an</font>

875
00:33:43,600 --> 00:33:47,020
interactive shell like if we go through

876
00:33:45,370 --> 00:33:48,699
the normal gateway and access you know

877
00:33:47,020 --> 00:33:51,490
with telematic cetera we will not be

878
00:33:48,700 --> 00:33:53,080
<font color="#CCCCCC">able to connect you than this user</font>

879
00:33:51,490 --> 00:33:55,180
because it has the attribute protected

880
00:33:53,080 --> 00:33:57,370
and yet we have an interactive shell

881
00:33:55,180 --> 00:33:59,770
this is very important because when

882
00:33:57,370 --> 00:34:01,179
<font color="#E5E5E5">people set up this attribute they didn't</font>

883
00:33:59,770 --> 00:34:03,220
want<font color="#CCCCCC"> to people they didn't want other</font>

884
00:34:01,180 --> 00:34:05,230
people<font color="#CCCCCC"> used to use</font><font color="#E5E5E5"> this users</font>

885
00:34:03,220 --> 00:34:07,060
credentials because it just has so much

886
00:34:05,230 --> 00:34:09,370
power and if you can see the running

887
00:34:07,060 --> 00:34:11,830
<font color="#CCCCCC">task on a mainframe you can see that</font>

888
00:34:09,370 --> 00:34:14,799
this same user is powering well<font color="#E5E5E5"> rock</font>

889
00:34:11,830 --> 00:34:17,020
have the security product it's also

890
00:34:14,800 --> 00:34:18,760
power in<font color="#CCCCCC"> vtown the interface that lets</font>

891
00:34:17,020 --> 00:34:20,530
us interact with the mainframe so this

892
00:34:18,760 --> 00:34:22,300
is a pretty<font color="#E5E5E5"> big</font><font color="#CCCCCC"> deal this is a very</font>

893
00:34:20,530 --> 00:34:25,090
<font color="#E5E5E5">interesting</font><font color="#CCCCCC"> user even though the</font>

894
00:34:22,300 --> 00:34:28,060
attributes said otherwise it didn't have

895
00:34:25,090 --> 00:34:29,800
attributes well actually it didn't have

896
00:34:28,060 --> 00:34:31,480
classic attributes but most of the time

897
00:34:29,800 --> 00:34:33,190
it had these kind of users that<font color="#CCCCCC"> are</font>

898
00:34:31,480 --> 00:34:36,870
protected or that I used<font color="#E5E5E5"> to power kicks</font>

899
00:34:33,190 --> 00:34:36,870
have some extended attributes that

900
00:34:37,050 --> 00:34:42,340
specifically one that's called no pass

901
00:34:39,389 --> 00:34:43,810
trusted attribute<font color="#E5E5E5"> and if you have this</font>

902
00:34:42,340 --> 00:34:45,580
attribute like you cannot check it with

903
00:34:43,810 --> 00:34:47,770
a list user<font color="#CCCCCC"> commander it's more advanced</font>

904
00:34:45,580 --> 00:34:49,900
stuff but if you have this attribute you

905
00:34:47,770 --> 00:34:51,190
can bypass every security rule like<font color="#E5E5E5"> even</font>

906
00:34:49,900 --> 00:34:53,139
if there is a<font color="#CCCCCC"> security rule that says</font>

907
00:34:51,190 --> 00:34:54,790
hey your user cannot access this file

908
00:34:53,139 --> 00:34:56,739
well if you have the no<font color="#E5E5E5"> pass trusted</font>

909
00:34:54,790 --> 00:35:00,340
attribute you can bypass that security

910
00:34:56,739 --> 00:35:02,919
rules but it's not most of the time but

911
00:35:00,340 --> 00:35:05,080
<font color="#CCCCCC">sometimes we found it on installations</font>

912
00:35:02,920 --> 00:35:07,150
because basically kicks needs to access

913
00:35:05,080 --> 00:35:09,700
so many files so instead of giving it

914
00:35:07,150 --> 00:35:11,620
you know every<font color="#E5E5E5"> time the proper security</font>

915
00:35:09,700 --> 00:35:14,080
rules Isis goes well they just<font color="#E5E5E5"> say well</font>

916
00:35:11,620 --> 00:35:15,850
you know let it<font color="#E5E5E5"> be trusted and nope</font>

917
00:35:14,080 --> 00:35:17,500
doesn't require password sources you

918
00:35:15,850 --> 00:35:19,299
know let it bypass every security rule

919
00:35:17,500 --> 00:35:20,920
and obviously using this shell now you

920
00:35:19,300 --> 00:35:22,090
have those privileges you inherited

921
00:35:20,920 --> 00:35:24,910
those privileges so you can pretty much

922
00:35:22,090 --> 00:35:26,740
do whatever you want on a mainframe so

923
00:35:24,910 --> 00:35:29,049
that's<font color="#E5E5E5"> the that's the interesting part</font>

924
00:35:26,740 --> 00:35:31,180
and now remember when we<font color="#E5E5E5"> open this pool</font>

925
00:35:29,050 --> 00:35:33,460
file that file that we wrote code in and

926
00:35:31,180 --> 00:35:36,700
we push to<font color="#CCCCCC"> the internal whether we when</font>

927
00:35:33,460 --> 00:35:39,670
we define the file we used<font color="#E5E5E5"> the terminal</font>

928
00:35:36,700 --> 00:35:43,240
node local so we open the file on the

929
00:35:39,670 --> 00:35:45,250
local system what if<font color="#E5E5E5"> we use not</font>

930
00:35:43,240 --> 00:35:47,439
<font color="#E5E5E5">Washington DC for instance or remote</font>

931
00:35:45,250 --> 00:35:51,200
system we could have executed code on

932
00:35:47,440 --> 00:35:53,960
another mainframe now this is this<font color="#E5E5E5"> is</font>

933
00:35:51,200 --> 00:35:55,700
to Windows domains that you know that

934
00:35:53,960 --> 00:35:57,650
trust in each other you can if you have

935
00:35:55,700 --> 00:35:59,149
code execution on one domain one user on

936
00:35:57,650 --> 00:36:01,190
one domain you can you know a buncha

937
00:35:59,150 --> 00:36:02,839
gate to another domain and do stuff it's

938
00:36:01,190 --> 00:36:04,400
basically the<font color="#E5E5E5"> same thing mainframes have</font>

939
00:36:02,839 --> 00:36:07,640
the same it's not<font color="#E5E5E5"> called domain but it's</font>

940
00:36:04,400 --> 00:36:09,920
gonna it's called network job entry so

941
00:36:07,640 --> 00:36:11,629
if you can push code from one mainframe

942
00:36:09,920 --> 00:36:13,880
to another if there's a trust between

943
00:36:11,630 --> 00:36:16,099
them there was a<font color="#E5E5E5"> great talk</font><font color="#CCCCCC"> about on Def</font>

944
00:36:13,880 --> 00:36:18,500
Con last<font color="#CCCCCC"> year about</font><font color="#E5E5E5"> it but Phil and Chad</font>

945
00:36:16,099 --> 00:36:20,030
and they talked about<font color="#CCCCCC"> ng network</font><font color="#E5E5E5"> job</font>

946
00:36:18,500 --> 00:36:23,240
<font color="#E5E5E5">entry and they implemented the proper</font>

947
00:36:20,030 --> 00:36:24,859
tools and map etc to do it<font color="#E5E5E5"> but using</font>

948
00:36:23,240 --> 00:36:27,740
this interface you could<font color="#E5E5E5"> just do it you</font>

949
00:36:24,859 --> 00:36:29,509
know seamlessly you don't have to care

950
00:36:27,740 --> 00:36:32,868
to get the right passwords accessory

951
00:36:29,510 --> 00:36:36,109
just specify the proper<font color="#CCCCCC"> now then boom</font>

952
00:36:32,869 --> 00:36:37,940
goes the dynamite now we have a lot of

953
00:36:36,109 --> 00:36:39,400
problems with<font color="#E5E5E5"> this technique with this</font>

954
00:36:37,940 --> 00:36:42,470
technique although it works pretty well

955
00:36:39,400 --> 00:36:45,170
first of all<font color="#E5E5E5"> what what we see in the</font>

956
00:36:42,470 --> 00:36:47,899
<font color="#E5E5E5">field is that sometimes not all the time</font>

957
00:36:45,170 --> 00:36:50,180
but like on<font color="#CCCCCC"> 9 mainframes rice</font><font color="#E5E5E5"> on there</font>

958
00:36:47,900 --> 00:36:53,630
was like spool open the spool functions

959
00:36:50,180 --> 00:36:56,299
that were turned<font color="#E5E5E5"> off so basically we had</font>

960
00:36:53,630 --> 00:36:59,650
<font color="#E5E5E5">when in the like on four of them like</font>

961
00:36:56,300 --> 00:37:02,690
online like yeah about half if you will

962
00:36:59,650 --> 00:37:04,880
more less than half you had like on the

963
00:37:02,690 --> 00:37:07,970
kicks definition file we have<font color="#CCCCCC"> this pool</font>

964
00:37:04,880 --> 00:37:10,310
set to know which means we cannot write

965
00:37:07,970 --> 00:37:13,848
these pool files that we can push to the

966
00:37:10,310 --> 00:37:16,369
<font color="#CCCCCC">internal</font><font color="#E5E5E5"> wither to execute code that's a</font>

967
00:37:13,849 --> 00:37:18,380
bit that's a<font color="#CCCCCC"> big hole but</font><font color="#E5E5E5"> no worry there</font>

968
00:37:16,369 --> 00:37:19,940
is another way to execute code and

969
00:37:18,380 --> 00:37:22,130
that's to something<font color="#E5E5E5"> that's called</font>

970
00:37:19,940 --> 00:37:25,460
transient data queue that's just<font color="#E5E5E5"> another</font>

971
00:37:22,130 --> 00:37:27,500
fancy IBM were to say that we will

972
00:37:25,460 --> 00:37:30,290
define a file and we will<font color="#E5E5E5"> make it</font>

973
00:37:27,500 --> 00:37:33,770
<font color="#E5E5E5">available to people to write temporary</font>

974
00:37:30,290 --> 00:37:35,720
data in it<font color="#E5E5E5"> it's like caching for apps on</font>

975
00:37:33,770 --> 00:37:36,980
cakes like you know you you need<font color="#CCCCCC"> to</font>

976
00:37:35,720 --> 00:37:39,740
store data somewhere for a user

977
00:37:36,980 --> 00:37:40,970
temporary cookie or whatever you<font color="#E5E5E5"> just</font>

978
00:37:39,740 --> 00:37:42,950
write it in something<font color="#CCCCCC"> that's called</font>

979
00:37:40,970 --> 00:37:45,470
static you and you have a dedicated file

980
00:37:42,950 --> 00:37:49,339
on the mainframe to do so and sometimes

981
00:37:45,470 --> 00:37:51,740
sometimes sometimes admins define a file

982
00:37:49,339 --> 00:37:53,450
right to store this temporary data but

983
00:37:51,740 --> 00:37:57,109
they make it point toward the internal

984
00:37:53,450 --> 00:37:58,759
reader for an<font color="#E5E5E5"> awesome admin tasks or</font>

985
00:37:57,109 --> 00:38:00,770
because they need to execute code or

986
00:37:58,760 --> 00:38:03,770
whatever so<font color="#CCCCCC"> it's always</font><font color="#E5E5E5"> a good idea to</font>

987
00:38:00,770 --> 00:38:05,060
look for<font color="#E5E5E5"> this kind of stuff</font><font color="#CCCCCC"> and the way</font>

988
00:38:03,770 --> 00:38:08,030
<font color="#CCCCCC">to do it is obviously to see</font>

989
00:38:05,060 --> 00:38:09,500
etc but like<font color="#E5E5E5"> the idea is that kicks</font>

990
00:38:08,030 --> 00:38:11,060
<font color="#CCCCCC">bound will do it automatically so if</font>

991
00:38:09,500 --> 00:38:12,680
your<font color="#E5E5E5"> lunch Kicks down with the dash I</font>

992
00:38:11,060 --> 00:38:15,350
option which<font color="#CCCCCC"> will list information about</font>

993
00:38:12,680 --> 00:38:16,609
the system you can see that<font color="#E5E5E5"> here we have</font>

994
00:38:15,350 --> 00:38:18,380
the transaction that we have access<font color="#E5E5E5"> to</font>

995
00:38:16,610 --> 00:38:20,330
information and<font color="#E5E5E5"> we hear GCL submission</font>

996
00:38:18,380 --> 00:38:23,420
we see<font color="#CCCCCC"> that we can ask the internal</font>

997
00:38:20,330 --> 00:38:25,940
school but<font color="#CCCCCC"> also tdq was you know you</font>

998
00:38:23,420 --> 00:38:27,380
just<font color="#E5E5E5"> need to specify minus Qi I RDR and</font>

999
00:38:25,940 --> 00:38:29,270
it will you know find its way and

1000
00:38:27,380 --> 00:38:32,300
execute code so it's very automatic you

1001
00:38:29,270 --> 00:38:33,800
don't have to worry about it actually<font color="#CCCCCC"> on</font>

1002
00:38:32,300 --> 00:38:36,680
the nine mainframes I told you about

1003
00:38:33,800 --> 00:38:39,680
<font color="#E5E5E5">like for displayed spool open that was</font>

1004
00:38:36,680 --> 00:38:41,660
<font color="#E5E5E5">open and one had the gdq so you know</font>

1005
00:38:39,680 --> 00:38:44,240
like overall more than half you can

1006
00:38:41,660 --> 00:38:46,069
execute code on it without

1007
00:38:44,240 --> 00:38:47,990
authentication because remember hey we

1008
00:38:46,070 --> 00:38:51,200
skip the conjugation so that's that's a

1009
00:38:47,990 --> 00:38:53,509
pretty huge number so that's one down

1010
00:38:51,200 --> 00:38:55,730
the one that I<font color="#CCCCCC"> really saw a lot though</font>

1011
00:38:53,510 --> 00:38:57,290
is<font color="#E5E5E5"> see</font><font color="#CCCCCC"> size not available like people</font>

1012
00:38:55,730 --> 00:38:59,450
like on a mainframe when we connect to

1013
00:38:57,290 --> 00:39:02,270
it like we have access to CMT that's

1014
00:38:59,450 --> 00:39:05,060
almost always the case but seaside one

1015
00:39:02,270 --> 00:39:07,550
that executes kicks api's that one is

1016
00:39:05,060 --> 00:39:11,450
most of the time forbidden like oh<font color="#E5E5E5"> well</font>

1017
00:39:07,550 --> 00:39:13,730
they've done their job so we get<font color="#E5E5E5"> this</font>

1018
00:39:11,450 --> 00:39:17,770
you know a small error that was a little

1019
00:39:13,730 --> 00:39:21,440
bit annoying but the great thing is oh

1020
00:39:17,770 --> 00:39:22,850
yes<font color="#CCCCCC"> sorry yeah 224</font><font color="#E5E5E5"> bit seaside for</font>

1021
00:39:21,440 --> 00:39:24,470
instance there's a rule that resembles

1022
00:39:22,850 --> 00:39:26,120
that goes something like this<font color="#E5E5E5"> in</font><font color="#CCCCCC"> Rakas</font>

1023
00:39:24,470 --> 00:39:27,379
you know are<font color="#CCCCCC"> the client eagle whatever</font>

1024
00:39:26,120 --> 00:39:29,660
we don't need to<font color="#CCCCCC"> talk about this</font><font color="#E5E5E5"> stuff</font>

1025
00:39:27,380 --> 00:39:32,660
we<font color="#CCCCCC"> just need to see that</font><font color="#E5E5E5"> the projection</font>

1026
00:39:29,660 --> 00:39:35,089
is placed on the name of<font color="#E5E5E5"> the</font><font color="#CCCCCC"> transaction</font>

1027
00:39:32,660 --> 00:39:36,830
ID on the name<font color="#E5E5E5"> of the</font><font color="#CCCCCC"> the ID that lets</font>

1028
00:39:35,090 --> 00:39:38,420
you access the program so seaside and

1029
00:39:36,830 --> 00:39:40,100
<font color="#E5E5E5">you can hear universal access non so</font>

1030
00:39:38,420 --> 00:39:43,550
unless you have<font color="#E5E5E5"> permission you're not</font>

1031
00:39:40,100 --> 00:39:46,420
allowed to access it well there's a here

1032
00:39:43,550 --> 00:39:49,070
will you know draw another tool from the

1033
00:39:46,420 --> 00:39:51,950
toolbox of the default programs shipped

1034
00:39:49,070 --> 00:39:54,020
by IBM this one is<font color="#E5E5E5"> called see doc now</font>

1035
00:39:51,950 --> 00:39:57,020
this one lets you also resources that

1036
00:39:54,020 --> 00:39:58,640
are defined<font color="#E5E5E5"> in kicks so remember the</font>

1037
00:39:57,020 --> 00:40:00,350
file name variable the name of the

1038
00:39:58,640 --> 00:40:02,990
program the<font color="#CCCCCC"> name of transactions you can</font>

1039
00:40:00,350 --> 00:40:05,029
change all<font color="#E5E5E5"> of that and this one is like</font>

1040
00:40:02,990 --> 00:40:07,069
if you have access<font color="#CCCCCC"> to this one that's it</font>

1041
00:40:05,030 --> 00:40:08,780
that's<font color="#CCCCCC"> crude like you can do pretty much</font>

1042
00:40:07,070 --> 00:40:11,960
whatever you want with the system and

1043
00:40:08,780 --> 00:40:14,510
the weird<font color="#CCCCCC"> thing is see sighs most of the</font>

1044
00:40:11,960 --> 00:40:17,600
time you know like not available but<font color="#CCCCCC"> see</font>

1045
00:40:14,510 --> 00:40:18,800
<font color="#CCCCCC">Don always is and it's insane there's</font>

1046
00:40:17,600 --> 00:40:20,660
<font color="#CCCCCC">see doc</font><font color="#E5E5E5"> what</font>

1047
00:40:18,800 --> 00:40:22,910
let you out the resources<font color="#E5E5E5"> in real time</font>

1048
00:40:20,660 --> 00:40:24,319
and there's CBB which will let<font color="#E5E5E5"> you out</font>

1049
00:40:22,910 --> 00:40:27,470
<font color="#E5E5E5">to resources but you have to reboot</font>

1050
00:40:24,320 --> 00:40:30,170
kicks so that's a bit more troublesome

1051
00:40:27,470 --> 00:40:32,660
but see<font color="#E5E5E5"> that works</font><font color="#CCCCCC"> great and the</font><font color="#E5E5E5"> idea I</font>

1052
00:40:30,170 --> 00:40:35,780
sense the production was put on the

1053
00:40:32,660 --> 00:40:38,120
transaction ID well and the transaction

1054
00:40:35,780 --> 00:40:41,030
ID points to a program what if we<font color="#E5E5E5"> can</font>

1055
00:40:38,120 --> 00:40:42,680
<font color="#E5E5E5">change a transaction to point another</font>

1056
00:40:41,030 --> 00:40:44,930
transaction that we have<font color="#CCCCCC"> access to and</font>

1057
00:40:42,680 --> 00:40:47,779
make it point toward that CSI program

1058
00:40:44,930 --> 00:40:49,339
you know and we have a list of

1059
00:40:47,780 --> 00:40:51,200
transaction that we can access like the

1060
00:40:49,340 --> 00:40:52,640
<font color="#E5E5E5">logon authentication for instance that</font>

1061
00:40:51,200 --> 00:40:54,500
that's a transaction everybody has to

1062
00:40:52,640 --> 00:40:58,129
access right what if we<font color="#E5E5E5"> make</font><font color="#CCCCCC"> it point</font>

1063
00:40:54,500 --> 00:40:59,840
towards the seaside program<font color="#E5E5E5"> obviously</font>

1064
00:40:58,130 --> 00:41:02,210
that was<font color="#CCCCCC"> clogged the mainframe but you</font>

1065
00:40:59,840 --> 00:41:03,530
get that you get the idea so but so

1066
00:41:02,210 --> 00:41:04,160
instead of<font color="#CCCCCC"> using the login transaction</font>

1067
00:41:03,530 --> 00:41:06,770
we're going to use<font color="#CCCCCC"> some other</font>

1068
00:41:04,160 --> 00:41:08,930
transactions that people don't use other

1069
00:41:06,770 --> 00:41:12,560
IDs like the printing transaction<font color="#E5E5E5"> fee</font>

1070
00:41:08,930 --> 00:41:14,419
SDK and the<font color="#E5E5E5"> page in one</font><font color="#CCCCCC"> csps so you will</font>

1071
00:41:12,560 --> 00:41:16,279
not<font color="#CCCCCC"> have to</font><font color="#E5E5E5"> do this manually again like</font>

1072
00:41:14,420 --> 00:41:18,440
expand will do it automatically you just

1073
00:41:16,280 --> 00:41:21,020
used to you<font color="#CCCCCC"> just use the dash dash</font>

1074
00:41:18,440 --> 00:41:23,630
bypass and<font color="#CCCCCC"> will do all</font><font color="#E5E5E5"> this stuff to</font>

1075
00:41:21,020 --> 00:41:24,950
automatically so for instance<font color="#E5E5E5"> here we we</font>

1076
00:41:23,630 --> 00:41:27,230
want<font color="#E5E5E5"> a reverse unix and you can see that</font>

1077
00:41:24,950 --> 00:41:30,049
<font color="#E5E5E5">we cannot access key sign we try to the</font>

1078
00:41:27,230 --> 00:41:32,030
dash dash bypass switch and you can see

1079
00:41:30,050 --> 00:41:34,190
that<font color="#E5E5E5"> here it will copy</font><font color="#CCCCCC"> cscs and</font><font color="#E5E5E5"> we'll</font>

1080
00:41:32,030 --> 00:41:35,870
make a point to see<font color="#CCCCCC"> NPCs PK points to</font>

1081
00:41:34,190 --> 00:41:38,420
see so I now and you<font color="#E5E5E5"> can see that it's</font>

1082
00:41:35,870 --> 00:41:40,069
correctly submitted the code and you<font color="#CCCCCC"> can</font>

1083
00:41:38,420 --> 00:41:45,560
see here that we<font color="#CCCCCC"> actually have code</font>

1084
00:41:40,070 --> 00:41:47,240
execution again so I have<font color="#E5E5E5"> 18 minutes</font>

1085
00:41:45,560 --> 00:41:50,480
left brilliant we're going<font color="#E5E5E5"> to talk about</font>

1086
00:41:47,240 --> 00:41:51,890
code is privilege escalation so we have

1087
00:41:50,480 --> 00:41:55,520
code execution on the mainframe right

1088
00:41:51,890 --> 00:41:58,730
either through kicks or from any other

1089
00:41:55,520 --> 00:42:00,170
means ftp code execution sniffing

1090
00:41:58,730 --> 00:42:02,170
credentials getting access to tears or

1091
00:42:00,170 --> 00:42:04,790
whatever we have access to mainframe

1092
00:42:02,170 --> 00:42:06,110
either our user has lots of privileges

1093
00:42:04,790 --> 00:42:08,330
and then we can<font color="#CCCCCC"> just you know</font><font color="#E5E5E5"> download</font>

1094
00:42:06,110 --> 00:42:09,620
the database of passwords<font color="#CCCCCC"> crack it most</font>

1095
00:42:08,330 --> 00:42:12,080
of<font color="#CCCCCC"> the</font><font color="#E5E5E5"> time is dead so you can get away</font>

1096
00:42:09,620 --> 00:42:15,350
with it but what<font color="#E5E5E5"> if we</font><font color="#CCCCCC"> don't have</font>

1097
00:42:12,080 --> 00:42:17,150
privileged access how does<font color="#E5E5E5"> privilege</font>

1098
00:42:15,350 --> 00:42:19,220
escalation on a main framework is it

1099
00:42:17,150 --> 00:42:21,110
even possible what are the tools this is

1100
00:42:19,220 --> 00:42:25,899
basically we're going to talk about a

1101
00:42:21,110 --> 00:42:28,850
little bit so basically on on rock ass

1102
00:42:25,900 --> 00:42:31,190
on the security<font color="#CCCCCC"> products on the US you</font>

1103
00:42:28,850 --> 00:42:32,580
<font color="#E5E5E5">have three privileges remain privileges</font>

1104
00:42:31,190 --> 00:42:34,680
that you should<font color="#E5E5E5"> always have in mind</font>

1105
00:42:32,580 --> 00:42:36,180
so there's special which is<font color="#E5E5E5"> the</font>

1106
00:42:34,680 --> 00:42:38,190
equivalent of<font color="#E5E5E5"> root right if you have</font>

1107
00:42:36,180 --> 00:42:39,660
access to<font color="#E5E5E5"> this one you can do pretty</font>

1108
00:42:38,190 --> 00:42:41,880
much whatever you want on the system

1109
00:42:39,660 --> 00:42:44,430
your kingdom the world o king of the

1110
00:42:41,880 --> 00:42:46,650
world you have the operations attribute

1111
00:42:44,430 --> 00:42:49,589
and this one lets<font color="#E5E5E5"> you bypass any</font>

1112
00:42:46,650 --> 00:42:51,690
security rule there is so if you have

1113
00:42:49,590 --> 00:42:52,920
this attribute and you know there's a

1114
00:42:51,690 --> 00:42:54,660
rule that<font color="#CCCCCC"> says hey you don't have access</font>

1115
00:42:52,920 --> 00:42:57,210
to this file you can just bypass it and

1116
00:42:54,660 --> 00:42:59,129
ignore it totally and there's the

1117
00:42:57,210 --> 00:43:01,500
<font color="#E5E5E5">auditor privilege attribute that will</font>

1118
00:42:59,130 --> 00:43:03,750
you<font color="#CCCCCC"> know let you access some class login</font>

1119
00:43:01,500 --> 00:43:08,190
classes etc it's not<font color="#E5E5E5"> that</font><font color="#CCCCCC"> much useful to</font>

1120
00:43:03,750 --> 00:43:10,080
us now when<font color="#E5E5E5"> you connect your mainframe</font>

1121
00:43:08,190 --> 00:43:11,790
<font color="#CCCCCC">alright when you connect your main time</font>

1122
00:43:10,080 --> 00:43:14,610
ever basically every job on a mainframe

1123
00:43:11,790 --> 00:43:17,400
every program every user task has its

1124
00:43:14,610 --> 00:43:19,350
own address space and in the address

1125
00:43:17,400 --> 00:43:21,210
space basically you have two main parts

1126
00:43:19,350 --> 00:43:22,799
you<font color="#CCCCCC"> have the common parts which</font><font color="#E5E5E5"> is</font>

1127
00:43:21,210 --> 00:43:26,210
called the common storage area si si

1128
00:43:22,800 --> 00:43:29,270
this one is shared between all users it

1129
00:43:26,210 --> 00:43:33,300
contains some critical functions some

1130
00:43:29,270 --> 00:43:34,920
you know<font color="#E5E5E5"> Cisco table some important</font>

1131
00:43:33,300 --> 00:43:36,750
common definitions that has to be

1132
00:43:34,920 --> 00:43:39,420
accessible<font color="#CCCCCC"> to</font><font color="#E5E5E5"> everyone and then you have</font>

1133
00:43:36,750 --> 00:43:41,370
the private<font color="#E5E5E5"> parts private parts only you</font>

1134
00:43:39,420 --> 00:43:43,430
only your address space<font color="#E5E5E5"> only you and the</font>

1135
00:43:41,370 --> 00:43:45,270
<font color="#E5E5E5">address space can access it the same way</font>

1136
00:43:43,430 --> 00:43:48,540
basically as every other modern

1137
00:43:45,270 --> 00:43:50,580
operating systems and now in<font color="#E5E5E5"> that small</font>

1138
00:43:48,540 --> 00:43:52,980
private place<font color="#E5E5E5"> or a small private address</font>

1139
00:43:50,580 --> 00:43:55,080
space there's more<font color="#CCCCCC"> other small</font><font color="#E5E5E5"> private</font>

1140
00:43:52,980 --> 00:43:58,040
address region sorry you have a special

1141
00:43:55,080 --> 00:44:00,060
<font color="#E5E5E5">structure that summarizes your</font>

1142
00:43:58,040 --> 00:44:01,770
privileges that can change<font color="#E5E5E5"> your</font>

1143
00:44:00,060 --> 00:44:04,620
privileges and this structure is called

1144
00:44:01,770 --> 00:44:08,580
the acee for accessor environment

1145
00:44:04,620 --> 00:44:11,009
element and on offset 26 packs you have

1146
00:44:08,580 --> 00:44:13,860
one bit that says hey<font color="#E5E5E5"> this user has</font>

1147
00:44:11,010 --> 00:44:17,160
<font color="#E5E5E5">special or not and then you have other</font>

1148
00:44:13,860 --> 00:44:20,880
attributes like operations auditor etc

1149
00:44:17,160 --> 00:44:24,270
so what if you know we<font color="#E5E5E5"> can change this</font>

1150
00:44:20,880 --> 00:44:27,120
stuff what if<font color="#E5E5E5"> we can change this this</font>

1151
00:44:24,270 --> 00:44:30,030
part of memory<font color="#CCCCCC"> that you</font><font color="#E5E5E5"> know summarizes</font>

1152
00:44:27,120 --> 00:44:33,450
our attributes obviously this part of

1153
00:44:30,030 --> 00:44:37,200
memory is not writable by everybody you

1154
00:44:33,450 --> 00:44:41,020
have to be in kernel mode to write it so

1155
00:44:37,200 --> 00:44:43,939
kernel mode mainframe how does it work

1156
00:44:41,020 --> 00:44:45,830
let's dive into into it a little bit<font color="#E5E5E5"> so</font>

1157
00:44:43,940 --> 00:44:48,530
basically on you know in<font color="#CCCCCC"> UNIX if you</font>

1158
00:44:45,830 --> 00:44:51,109
want to load if you not load the kernel

1159
00:44:48,530 --> 00:44:53,000
into<font color="#E5E5E5"> your memory if you know load the</font>

1160
00:44:51,109 --> 00:44:55,520
kernel you basically<font color="#CCCCCC"> just use the M</font>

1161
00:44:53,000 --> 00:44:57,470
small command or<font color="#E5E5E5"> mod</font><font color="#CCCCCC"> prob</font><font color="#E5E5E5"> or whatever</font>

1162
00:44:55,520 --> 00:45:00,530
and you just you<font color="#E5E5E5"> know</font><font color="#CCCCCC"> compile a program</font>

1163
00:44:57,470 --> 00:45:04,040
<font color="#E5E5E5">and load it into</font><font color="#CCCCCC"> Colonel the privilege</font>

1164
00:45:00,530 --> 00:45:08,150
is set on the command to load it not on

1165
00:45:04,040 --> 00:45:09,800
the program<font color="#CCCCCC"> that is loaded you</font><font color="#E5E5E5"> we agree</font>

1166
00:45:08,150 --> 00:45:12,380
on<font color="#CCCCCC"> that on the mainframe is different on</font>

1167
00:45:09,800 --> 00:45:15,050
vos<font color="#CCCCCC"> is different you have some special</font>

1168
00:45:12,380 --> 00:45:18,050
folders and everything you put on it in

1169
00:45:15,050 --> 00:45:21,680
it will run Colonel with Colonel

1170
00:45:18,050 --> 00:45:23,869
privileges which means the protection

1171
00:45:21,680 --> 00:45:25,700
must be put on the folders not on the

1172
00:45:23,869 --> 00:45:30,470
<font color="#E5E5E5">command load in them which makes it so</font>

1173
00:45:25,700 --> 00:45:32,629
much harder to to actually<font color="#CCCCCC"> to to tighten</font>

1174
00:45:30,470 --> 00:45:34,700
to to secure because you know you have

1175
00:45:32,630 --> 00:45:37,480
so many directories sometimes 30 40

1176
00:45:34,700 --> 00:45:40,339
directories that you have to<font color="#E5E5E5"> protect and</font>

1177
00:45:37,480 --> 00:45:42,410
so<font color="#E5E5E5"> this is what's called a PF libraries</font>

1178
00:45:40,340 --> 00:45:44,540
so authorized program facility so these

1179
00:45:42,410 --> 00:45:45,950
directories or libraries everything you

1180
00:45:44,540 --> 00:45:47,839
put in them they're critical to the

1181
00:45:45,950 --> 00:45:49,220
system everybody can list them if you

1182
00:45:47,839 --> 00:45:51,740
put a program<font color="#E5E5E5"> in it if you have write</font>

1183
00:45:49,220 --> 00:45:53,839
access to him the program when it will

1184
00:45:51,740 --> 00:45:57,500
launch it can request Colonel privileges

1185
00:45:53,839 --> 00:45:59,570
and it will get<font color="#E5E5E5"> it and so obviously</font>

1186
00:45:57,500 --> 00:46:00,980
<font color="#CCCCCC">these libraries are well protected not</font>

1187
00:45:59,570 --> 00:46:03,980
so much I remember when<font color="#E5E5E5"> we were doing an</font>

1188
00:46:00,980 --> 00:46:05,420
audit<font color="#CCCCCC"> we're like way back then I'm like</font>

1189
00:46:03,980 --> 00:46:06,980
I basically didn't have these tools that

1190
00:46:05,420 --> 00:46:09,080
I'm sure continue showing you right now

1191
00:46:06,980 --> 00:46:10,730
<font color="#E5E5E5">and</font><font color="#CCCCCC"> you know we we saw some APF</font>

1192
00:46:09,080 --> 00:46:13,310
libraries that were like altar to

1193
00:46:10,730 --> 00:46:15,080
everybody and we're like hey this<font color="#E5E5E5"> is bad</font>

1194
00:46:13,310 --> 00:46:16,880
like I've read about this stuff it's bad

1195
00:46:15,080 --> 00:46:19,069
you should not<font color="#E5E5E5"> be should not be doing it</font>

1196
00:46:16,880 --> 00:46:21,020
and I remember my client said oh yeah

1197
00:46:19,070 --> 00:46:22,400
you're right yeah did you can you show

1198
00:46:21,020 --> 00:46:27,140
me<font color="#E5E5E5"> what people can do it it and I'm like</font>

1199
00:46:22,400 --> 00:46:28,609
ah<font color="#E5E5E5"> no I don't know like an assembly in</font>

1200
00:46:27,140 --> 00:46:29,900
the US no I don't know how to do<font color="#CCCCCC"> that</font>

1201
00:46:28,609 --> 00:46:32,180
fuck there's no<font color="#E5E5E5"> other tool to the way</font>

1202
00:46:29,900 --> 00:46:34,369
and so the<font color="#CCCCCC"> idea is</font><font color="#E5E5E5"> just like a one went</font>

1203
00:46:32,180 --> 00:46:36,379
home straight home and try to you know

1204
00:46:34,369 --> 00:46:38,420
really learn how to code this stuff and

1205
00:46:36,380 --> 00:46:41,150
how to do it<font color="#CCCCCC"> because you</font><font color="#E5E5E5"> know cos</font>

1206
00:46:38,420 --> 00:46:43,220
assembly is different from x 20 x 86 so

1207
00:46:41,150 --> 00:46:45,200
it's a whole other language basically no

1208
00:46:43,220 --> 00:46:46,819
other architecture and so the idea<font color="#E5E5E5"> is</font>

1209
00:46:45,200 --> 00:46:48,799
just to make it easy super easy for

1210
00:46:46,820 --> 00:46:50,690
<font color="#E5E5E5">people just you know intestine oh yeah</font>

1211
00:46:48,800 --> 00:46:51,980
you have all<font color="#CCCCCC"> sorts who have also access</font>

1212
00:46:50,690 --> 00:46:53,290
to an ApS library you could just lunch

1213
00:46:51,980 --> 00:46:55,570
go then hey I'm

1214
00:46:53,290 --> 00:46:57,820
roots of your<font color="#E5E5E5"> system just like you would</font>

1215
00:46:55,570 --> 00:47:00,460
on one<font color="#CCCCCC"> luncheon mimic ass or whatever on</font>

1216
00:46:57,820 --> 00:47:03,100
like the theory is fine but let's do

1217
00:47:00,460 --> 00:47:05,140
some practice let's let's transform this

1218
00:47:03,100 --> 00:47:07,410
one slide knowledge lost somewhere into

1219
00:47:05,140 --> 00:47:11,799
a real tool that we<font color="#E5E5E5"> can actually</font><font color="#CCCCCC"> use and</font>

1220
00:47:07,410 --> 00:47:15,100
demonstrate an engagement and so the

1221
00:47:11,800 --> 00:47:18,910
idea is<font color="#E5E5E5"> to write an assembly a code that</font>

1222
00:47:15,100 --> 00:47:21,839
will list all the APF libraries that

1223
00:47:18,910 --> 00:47:24,430
will check privileges of each one<font color="#E5E5E5"> and</font>

1224
00:47:21,840 --> 00:47:27,220
that will basically compile a file

1225
00:47:24,430 --> 00:47:29,080
compile a program into those with proper

1226
00:47:27,220 --> 00:47:31,509
<font color="#E5E5E5">linking attributes that will make</font><font color="#CCCCCC"> it go</font>

1227
00:47:29,080 --> 00:47:33,040
<font color="#E5E5E5">into kernel mode and then lunch it that</font>

1228
00:47:31,510 --> 00:47:35,860
the program will just locate that bit of

1229
00:47:33,040 --> 00:47:38,170
memory does hold your attributes and

1230
00:47:35,860 --> 00:47:41,080
then slip it and then there you<font color="#CCCCCC"> go</font>

1231
00:47:38,170 --> 00:47:43,930
you're special so<font color="#E5E5E5"> basically it looks a</font>

1232
00:47:41,080 --> 00:47:45,640
little bit like this this is the program

1233
00:47:43,930 --> 00:47:47,319
<font color="#E5E5E5">that</font><font color="#CCCCCC"> we will compile so these these</font>

1234
00:47:45,640 --> 00:47:50,020
parts is just you know like saving

1235
00:47:47,320 --> 00:47:52,090
registers etc just saving classic saving

1236
00:47:50,020 --> 00:47:55,480
routine and<font color="#CCCCCC"> assembly and here this is</font>

1237
00:47:52,090 --> 00:47:58,090
the mod set macro and it will let you go

1238
00:47:55,480 --> 00:48:01,090
to request<font color="#CCCCCC"> Colonel privileges so we go</font>

1239
00:47:58,090 --> 00:48:03,280
into superior mode we change the keyring

1240
00:48:01,090 --> 00:48:05,530
<font color="#E5E5E5">0 checking 0 and then we find the</font>

1241
00:48:03,280 --> 00:48:08,290
address space pointer in a common place

1242
00:48:05,530 --> 00:48:10,420
area so ascb we go into the extended

1243
00:48:08,290 --> 00:48:13,029
part<font color="#CCCCCC"> of the address space and there we</font>

1244
00:48:10,420 --> 00:48:14,560
find a pointer to<font color="#CCCCCC"> a seed which is the</font>

1245
00:48:13,030 --> 00:48:17,680
place<font color="#CCCCCC"> that holds your</font><font color="#E5E5E5"> our data and</font>

1246
00:48:14,560 --> 00:48:21,220
basically we just flip the bit number<font color="#CCCCCC"> of</font>

1247
00:48:17,680 --> 00:48:22,930
26 25 and 26 and we flip another<font color="#CCCCCC"> bitch</font>

1248
00:48:21,220 --> 00:48:25,330
<font color="#CCCCCC">in have also access to everything we</font>

1249
00:48:22,930 --> 00:48:28,359
<font color="#E5E5E5">resave everything and then we exit and</font>

1250
00:48:25,330 --> 00:48:30,520
then that's<font color="#E5E5E5"> it and the idea</font><font color="#CCCCCC"> is basically</font>

1251
00:48:28,360 --> 00:48:33,010
what this program does this will launch

1252
00:48:30,520 --> 00:48:36,490
a program so it will make the program

1253
00:48:33,010 --> 00:48:38,500
special in its own address space but it

1254
00:48:36,490 --> 00:48:40,270
will<font color="#E5E5E5"> not make your user special because</font>

1255
00:48:38,500 --> 00:48:43,570
it has a different address space so what

1256
00:48:40,270 --> 00:48:45,850
we<font color="#E5E5E5"> did here we made the program you know</font>

1257
00:48:43,570 --> 00:48:47,350
we elevated the program's privileges so

1258
00:48:45,850 --> 00:48:50,529
now we need to<font color="#E5E5E5"> elevate our users</font>

1259
00:48:47,350 --> 00:48:52,960
privileges hence<font color="#E5E5E5"> the small ulcer user ID</font>

1260
00:48:50,530 --> 00:48:55,270
special operations at the<font color="#E5E5E5"> end of the at</font>

1261
00:48:52,960 --> 00:48:58,090
the<font color="#E5E5E5"> end of the</font><font color="#CCCCCC"> program and it basically</font>

1262
00:48:55,270 --> 00:49:00,250
looks<font color="#CCCCCC"> like this so we are on interactive</font>

1263
00:48:58,090 --> 00:49:02,020
shell on<font color="#CCCCCC"> a mainframe and which user we</font>

1264
00:49:00,250 --> 00:49:04,990
can see attributes 0 we don't have

1265
00:49:02,020 --> 00:49:07,000
anything we execute<font color="#CCCCCC"> elv aps list we can</font>

1266
00:49:04,990 --> 00:49:09,580
see a list<font color="#E5E5E5"> of all a PF libraries</font>

1267
00:49:07,000 --> 00:49:11,140
see that none of them are protected and

1268
00:49:09,580 --> 00:49:14,500
you can see<font color="#E5E5E5"> the you know it's a pretty</font>

1269
00:49:11,140 --> 00:49:16,660
big list<font color="#CCCCCC"> it</font><font color="#E5E5E5"> obviously just you know test</font>

1270
00:49:14,500 --> 00:49:18,760
system so you can execute user we choose

1271
00:49:16,660 --> 00:49:21,190
one link lib and it will compile the

1272
00:49:18,760 --> 00:49:22,990
program lunch it everything went well

1273
00:49:21,190 --> 00:49:24,730
and you<font color="#CCCCCC"> can see that</font><font color="#E5E5E5"> here we are special</font>

1274
00:49:22,990 --> 00:49:26,290
and we have the operations and that's

1275
00:49:24,730 --> 00:49:30,900
how you do an escalation privilege

1276
00:49:26,290 --> 00:49:33,430
escalation on<font color="#E5E5E5"> a mainframe and thank you</font>

1277
00:49:30,900 --> 00:49:34,900
so you know a lot<font color="#CCCCCC"> of thanks to a lot of</font>

1278
00:49:33,430 --> 00:49:36,669
<font color="#CCCCCC">people that</font><font color="#E5E5E5"> I work with you know</font>

1279
00:49:34,900 --> 00:49:39,760
mainframe big<font color="#CCCCCC"> endian small mark.wilson</font>

1280
00:49:36,670 --> 00:49:42,370
like a lot of<font color="#CCCCCC"> people IBM thank you very</font>

1281
00:49:39,760 --> 00:49:44,470
<font color="#CCCCCC">much and yeah so if you have any</font>

1282
00:49:42,370 --> 00:49:48,299
questions<font color="#E5E5E5"> sickness still 10</font><font color="#CCCCCC"> minutes if</font>

1283
00:49:44,470 --> 00:49:54,549
you have any questions please go ahead

1284
00:49:48,300 --> 00:49:56,560
any questions no well more a case of

1285
00:49:54,550 --> 00:49:58,480
maybe the questions will come off stage

1286
00:49:56,560 --> 00:50:00,580
thank you thank<font color="#CCCCCC"> you very</font><font color="#E5E5E5"> much thank you</font>

1287
00:49:58,480 --> 00:50:01,450
thank you very<font color="#E5E5E5"> much thank you very busy</font>

1288
00:50:00,580 --> 00:50:05,259
today

1289
00:50:01,450 --> 00:50:05,259
[Applause]

