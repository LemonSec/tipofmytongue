1
00:00:09,510 --> 00:00:15,280
hello everybody so I'm Victor thank you

2
00:00:13,240 --> 00:00:15,630
for<font color="#CCCCCC"> interaction today</font><font color="#E5E5E5"> I'm going to talk</font>

3
00:00:15,280 --> 00:00:18,689
about

4
00:00:15,630 --> 00:00:20,190
<font color="#CCCCCC">Remer about the attack on Android and in</font>

5
00:00:18,690 --> 00:00:22,200
particular going to talk about<font color="#E5E5E5"> the</font>

6
00:00:20,190 --> 00:00:24,810
making<font color="#E5E5E5"> off so i'm going to explain you</font>

7
00:00:22,200 --> 00:00:29,790
how we actually<font color="#E5E5E5"> pull off this drummer</font>

8
00:00:24,810 --> 00:00:32,488
attack so drummer rooting android phones

9
00:00:29,790 --> 00:00:35,730
with drummer but the<font color="#CCCCCC"> question of course</font>

10
00:00:32,488 --> 00:00:38,970
would<font color="#CCCCCC"> be why do we care about making up</font>

11
00:00:35,730 --> 00:00:41,010
<font color="#E5E5E5">right so i think it's going to be fun to</font>

12
00:00:38,970 --> 00:00:43,980
<font color="#E5E5E5">talk about this it will show you some</font>

13
00:00:41,010 --> 00:00:46,589
insight in the academic thought process

14
00:00:43,980 --> 00:00:49,040
that<font color="#CCCCCC"> we had I going to show you some new</font>

15
00:00:46,590 --> 00:00:51,840
interesting rorimer techniques and

16
00:00:49,040 --> 00:00:55,080
although we couldn't use this these

17
00:00:51,840 --> 00:00:56,640
techniques in the final paper their

18
00:00:55,080 --> 00:00:58,050
<font color="#CCCCCC">so-called negative results and active</font>

19
00:00:56,640 --> 00:01:00,840
results are still result so it might be

20
00:00:58,050 --> 00:01:02,879
<font color="#E5E5E5">interesting</font><font color="#CCCCCC"> to look at this a disclaimer</font>

21
00:01:00,840 --> 00:01:06,000
before we start this presentation will

22
00:01:02,880 --> 00:01:07,380
be technical it will be about me so they

23
00:01:06,000 --> 00:01:09,780
<font color="#E5E5E5">don't like me</font><font color="#CCCCCC"> you can</font><font color="#E5E5E5"> still move to the</font>

24
00:01:07,380 --> 00:01:12,990
other track and there might be some

25
00:01:09,780 --> 00:01:15,180
strong language in the slides I will try

26
00:01:12,990 --> 00:01:17,820
to keep it<font color="#E5E5E5"> to a minimum but if you're</font>

27
00:01:15,180 --> 00:01:21,119
easily offended maybe track<font color="#E5E5E5"> 2 is</font><font color="#CCCCCC"> also</font>

28
00:01:17,820 --> 00:01:24,178
interesting<font color="#CCCCCC"> okay add a little background</font>

29
00:01:21,119 --> 00:01:27,450
before we start Who am I I'm a PhD

30
00:01:24,179 --> 00:01:29,249
candidate<font color="#CCCCCC"> SAT before</font><font color="#E5E5E5"> at few sec 3</font>

31
00:01:27,450 --> 00:01:32,219
circuses system security group in

32
00:01:29,249 --> 00:01:33,658
<font color="#E5E5E5">Amsterdam let the dragon</font><font color="#CCCCCC"> aversa died we</font>

33
00:01:32,219 --> 00:01:36,270
haven't very cool web page that you

34
00:01:33,659 --> 00:01:39,289
really should check out but let's look

35
00:01:36,270 --> 00:01:41,759
at who actually is in the group because

36
00:01:39,289 --> 00:01:44,459
there are important people here for the

37
00:01:41,759 --> 00:01:48,780
tremor clock so of course does it work

38
00:01:44,459 --> 00:01:51,959
that's me then this here is<font color="#CCCCCC"> her</font><font color="#E5E5E5"> bus he's</font>

39
00:01:48,780 --> 00:01:54,630
the professor of<font color="#E5E5E5"> our group he's really</font>

40
00:01:51,959 --> 00:01:57,899
<font color="#E5E5E5">the bus and then next to him is the</font>

41
00:01:54,630 --> 00:02:00,270
mastermind is a<font color="#CCCCCC"> Christian Algeria it was</font>

42
00:01:57,899 --> 00:02:03,749
very no fault<font color="#E5E5E5"> to this project but also</font>

43
00:02:00,270 --> 00:02:06,179
this guy over here<font color="#CCCCCC"> gathered at razavi</font>

44
00:02:03,749 --> 00:02:08,758
was very much involved<font color="#CCCCCC"> and then there's</font>

45
00:02:06,179 --> 00:02:12,599
<font color="#E5E5E5">also been who's also going to be on the</font>

46
00:02:08,758 --> 00:02:15,329
slides next so a little bit more about

47
00:02:12,599 --> 00:02:17,429
<font color="#E5E5E5">me I'm pc candidate and my project is</font>

48
00:02:15,330 --> 00:02:20,160
funded by a<font color="#CCCCCC"> collaboration between the</font>

49
00:02:17,430 --> 00:02:22,620
<font color="#CCCCCC">u.s. and the netherlands and this means</font>

50
00:02:20,160 --> 00:02:26,760
that<font color="#E5E5E5"> i'm collaborating with universal</font>

51
00:02:22,620 --> 00:02:28,160
santa barbara about android malware is

52
00:02:26,760 --> 00:02:30,500
very generic

53
00:02:28,160 --> 00:02:32,810
but we try to do some research from

54
00:02:30,500 --> 00:02:34,520
<font color="#CCCCCC">android malware and i started</font><font color="#E5E5E5"> in june</font>

55
00:02:32,810 --> 00:02:39,040
two thousand fourteen so it should<font color="#CCCCCC"> be</font>

56
00:02:34,520 --> 00:02:41,720
ready next summer and then for this talk

57
00:02:39,040 --> 00:02:45,560
food<font color="#CCCCCC"> remer the important dates are</font>

58
00:02:41,720 --> 00:02:48,470
somewhere last year between<font color="#CCCCCC"> tiberium and</font>

59
00:02:45,560 --> 00:02:51,170
the end of may so let's look at them

60
00:02:48,470 --> 00:02:53,900
<font color="#E5E5E5">they're really 18 towards a deadline for</font>

61
00:02:51,170 --> 00:02:55,940
using security one of the scientific

62
00:02:53,900 --> 00:02:59,890
security venues that we were submitting

63
00:02:55,940 --> 00:03:02,720
to then six days<font color="#E5E5E5"> later</font><font color="#CCCCCC"> i would present</font>

64
00:02:59,890 --> 00:03:06,649
another paper and android the issue at

65
00:03:02,720 --> 00:03:09,260
NASA crypto in<font color="#CCCCCC"> Barbados a couple months</font>

66
00:03:06,650 --> 00:03:11,360
<font color="#CCCCCC">later the end of May we had a paper</font>

67
00:03:09,260 --> 00:03:13,459
accepted<font color="#CCCCCC"> that security privacy and so</font>

68
00:03:11,360 --> 00:03:15,290
not<font color="#E5E5E5"> a scientific</font><font color="#CCCCCC"> renew and then two days</font>

69
00:03:13,460 --> 00:03:18,470
later would be the deadline for ccs and

70
00:03:15,290 --> 00:03:22,609
ccs was what we're targeting with our

71
00:03:18,470 --> 00:03:25,220
work and then the idea<font color="#CCCCCC"> was that between</font>

72
00:03:22,610 --> 00:03:27,350
<font color="#E5E5E5">martes and may I would go to Santa</font>

73
00:03:25,220 --> 00:03:29,840
Barbara visit the<font color="#E5E5E5"> University lab to lab</font>

74
00:03:27,350 --> 00:03:33,530
there and do a project on Android

75
00:03:29,840 --> 00:03:37,190
malware<font color="#CCCCCC"> okay so let's start with the</font>

76
00:03:33,530 --> 00:03:39,620
introduction before februari 80 the West

77
00:03:37,190 --> 00:03:41,959
misuse next security paper deadline I

78
00:03:39,620 --> 00:03:45,320
was working on a<font color="#E5E5E5"> lot</font><font color="#CCCCCC"> of paper in-depth</font>

79
00:03:41,959 --> 00:03:47,660
analysis of this assembly<font color="#CCCCCC"> of x86 64 bit</font>

80
00:03:45,320 --> 00:03:50,120
binaries I was taking<font color="#CCCCCC"> care of all the</font>

81
00:03:47,660 --> 00:03:53,510
hotel reservations flight reservations

82
00:03:50,120 --> 00:03:56,360
and housing football<font color="#E5E5E5"> Barbados and santa</font>

83
00:03:53,510 --> 00:03:59,209
<font color="#E5E5E5">barbara and i was watching then and</font>

84
00:03:56,360 --> 00:04:01,580
gathered and actually i was watching Ben

85
00:03:59,209 --> 00:04:06,230
how been in<font color="#CCCCCC"> cavae were breaking the</font>

86
00:04:01,580 --> 00:04:07,700
<font color="#E5E5E5">internet with the thing</font><font color="#CCCCCC"> she and</font><font color="#E5E5E5"> I hope</font>

87
00:04:06,230 --> 00:04:09,769
that you are<font color="#CCCCCC"> super</font><font color="#E5E5E5"> familiar with the</font>

88
00:04:07,700 --> 00:04:13,399
country i will brief even talk about it

89
00:04:09,770 --> 00:04:17,739
<font color="#E5E5E5">it's cross vm exploitation withdraw a</font>

90
00:04:13,400 --> 00:04:20,660
mirror and memory<font color="#CCCCCC"> dude application is</font>

91
00:04:17,738 --> 00:04:26,179
anyone here not familiar with raw hammer

92
00:04:20,660 --> 00:04:27,380
because she<font color="#E5E5E5"> hands are one</font><font color="#CCCCCC"> okay so you</font>

93
00:04:26,180 --> 00:04:30,169
all know about drama so that means

94
00:04:27,380 --> 00:04:32,630
briefly go of this then<font color="#CCCCCC"> yet these memory</font>

95
00:04:30,169 --> 00:04:36,380
cells capacitors that store<font color="#CCCCCC"> a one or a</font>

96
00:04:32,630 --> 00:04:39,380
zero by storing it charts and is the

97
00:04:36,380 --> 00:04:41,770
cells of just discharge rate so that's

98
00:04:39,380 --> 00:04:43,719
why we<font color="#E5E5E5"> refresh our drm every</font>

99
00:04:41,770 --> 00:04:45,430
four milliseconds and our people found

100
00:04:43,720 --> 00:04:47,410
that you activate neighboring cells very

101
00:04:45,430 --> 00:04:51,460
frequently you can<font color="#E5E5E5"> increase the</font>

102
00:04:47,410 --> 00:04:53,470
discharge rate and you end<font color="#E5E5E5"> up with draw</font>

103
00:04:51,460 --> 00:04:56,888
hammer so we have a victim cell that

104
00:04:53,470 --> 00:04:59,830
represents the 01 and then the XNA

105
00:04:56,889 --> 00:05:01,330
themselves very very frequently and then

106
00:04:59,830 --> 00:05:03,520
at some point the victims are all the

107
00:05:01,330 --> 00:05:06,120
charts is leaking<font color="#E5E5E5"> this below the</font>

108
00:05:03,520 --> 00:05:10,628
threshold and the one becomes a<font color="#CCCCCC"> zero</font>

109
00:05:06,120 --> 00:05:13,330
John image DRM is a matrix<font color="#CCCCCC"> of cells so</font>

110
00:05:10,629 --> 00:05:17,680
the excess one row and many many times

111
00:05:13,330 --> 00:05:20,948
we see that a neighboring cell this two

112
00:05:17,680 --> 00:05:23,770
artists leaking and the one flips into a

113
00:05:20,949 --> 00:05:25,030
zero to<font color="#CCCCCC"> the bits it now these roles that</font>

114
00:05:23,770 --> 00:05:27,698
we're reading from are called the

115
00:05:25,030 --> 00:05:30,818
aggressor row and the road in which

116
00:05:27,699 --> 00:05:32,319
referred a bit is a victim role now

117
00:05:30,819 --> 00:05:36,780
Korra it's important to understand<font color="#CCCCCC"> that</font>

118
00:05:32,319 --> 00:05:41,199
<font color="#E5E5E5">it's not every bit method you sometimes</font>

119
00:05:36,780 --> 00:05:45,818
<font color="#CCCCCC">0 bits fit but once you have a bit dip</font>

120
00:05:41,199 --> 00:05:47,440
very<font color="#E5E5E5"> often you can refuse it now people</font>

121
00:05:45,819 --> 00:05:49,599
did some more research on this and they

122
00:05:47,440 --> 00:05:51,940
<font color="#E5E5E5">found that you can also do double size</font>

123
00:05:49,599 --> 00:05:54,669
remember where you sent with a victim

124
00:05:51,940 --> 00:05:56,500
cell with too aggressive rose and this

125
00:05:54,669 --> 00:05:59,049
will increase the chance of putting a

126
00:05:56,500 --> 00:06:03,099
bit but doing this so called

127
00:05:59,050 --> 00:06:04,569
<font color="#CCCCCC">double-sided</font><font color="#E5E5E5"> rumor is a bit harder so</font>

128
00:06:03,099 --> 00:06:05,590
the<font color="#CCCCCC"> challenge is</font><font color="#E5E5E5"> for an attacker if</font>

129
00:06:04,569 --> 00:06:07,440
you're on a decorator if you want to do

130
00:06:05,590 --> 00:06:10,060
this basically two things you<font color="#E5E5E5"> need to do</font>

131
00:06:07,440 --> 00:06:12,669
first is you need<font color="#CCCCCC"> to bypass the cpu and</font>

132
00:06:10,060 --> 00:06:15,250
second is<font color="#CCCCCC"> in a way to select the right</font>

133
00:06:12,669 --> 00:06:17,979
<font color="#E5E5E5">addresses so let's briefly look at that</font>

134
00:06:15,250 --> 00:06:22,509
<font color="#CCCCCC">by passing we</font><font color="#E5E5E5"> cpu we all know</font><font color="#CCCCCC"> that the</font>

135
00:06:17,979 --> 00:06:24,669
drm is quite slow which<font color="#CCCCCC"> is why whenever</font>

136
00:06:22,509 --> 00:06:28,599
the CPU is reading some data from drm it

137
00:06:24,669 --> 00:06:30,580
will store it into a<font color="#E5E5E5"> guess but if we are</font>

138
00:06:28,599 --> 00:06:32,440
<font color="#CCCCCC">going to run where we must reach the</font>

139
00:06:30,580 --> 00:06:36,090
same value come dear M many many many

140
00:06:32,440 --> 00:06:39,310
times so we<font color="#E5E5E5"> need to bypass the CPU cache</font>

141
00:06:36,090 --> 00:06:40,779
one solution that many people using is a

142
00:06:39,310 --> 00:06:43,180
guest pass it's basically one

143
00:06:40,779 --> 00:06:45,219
instruction so you<font color="#CCCCCC"> cross on the x86</font>

144
00:06:43,180 --> 00:06:48,009
platform where you tell the<font color="#E5E5E5"> CPU</font>

145
00:06:45,219 --> 00:06:50,110
explicitly please remove this data from

146
00:06:48,009 --> 00:06:53,590
the cast so<font color="#E5E5E5"> that next time i read it the</font>

147
00:06:50,110 --> 00:06:56,050
ridge will go through 23 to derail

148
00:06:53,590 --> 00:06:59,799
another solution is Cassie fiction where

149
00:06:56,050 --> 00:07:02,020
you basically read more and<font color="#CCCCCC"> more values</font>

150
00:06:59,800 --> 00:07:04,810
from drm into your class until at some

151
00:07:02,020 --> 00:07:06,729
point you evict the aggressive rose from

152
00:07:04,810 --> 00:07:10,030
the<font color="#CCCCCC"> cast so when you read those again</font>

153
00:07:06,730 --> 00:07:11,320
you<font color="#E5E5E5"> will go to</font><font color="#CCCCCC"> dear em again second</font>

154
00:07:10,030 --> 00:07:14,080
chance selecting the aggressor<font color="#E5E5E5"> rose</font>

155
00:07:11,320 --> 00:07:16,650
foolish you should know that<font color="#CCCCCC"> vm is</font>

156
00:07:14,080 --> 00:07:19,810
working with physical memory addresses

157
00:07:16,650 --> 00:07:24,429
but of course software is<font color="#CCCCCC"> working with</font>

158
00:07:19,810 --> 00:07:26,650
virtual<font color="#E5E5E5"> addresses and this mapping from</font>

159
00:07:24,430 --> 00:07:31,960
Vic to addresses to physical addresses

160
00:07:26,650 --> 00:07:35,620
is unpredictable and the question<font color="#E5E5E5"> is how</font>

161
00:07:31,960 --> 00:07:37,960
how do we<font color="#E5E5E5"> figure out from with spiritual</font>

162
00:07:35,620 --> 00:07:40,770
addresses in a program we should read

163
00:07:37,960 --> 00:07:44,890
from to make sure we're reading from the

164
00:07:40,770 --> 00:07:47,380
from the correct<font color="#E5E5E5"> aggressive rose so one</font>

165
00:07:44,890 --> 00:07:50,440
solution is just don't and then you end

166
00:07:47,380 --> 00:07:52,090
up<font color="#E5E5E5"> doing single cells remember if your</font>

167
00:07:50,440 --> 00:07:56,830
dear M is buggy enough this will still

168
00:07:52,090 --> 00:07:59,130
work but we found that<font color="#E5E5E5"> on Android this</font>

169
00:07:56,830 --> 00:08:01,599
Quran on arm this<font color="#E5E5E5"> is not really</font><font color="#CCCCCC"> the case</font>

170
00:07:59,130 --> 00:08:04,900
so the real solutions are using either

171
00:08:01,600 --> 00:08:07,480
page map which is a<font color="#E5E5E5"> special file that</font>

172
00:08:04,900 --> 00:08:09,159
just holds this mapping so you open the

173
00:08:07,480 --> 00:08:12,100
file and<font color="#CCCCCC"> you look up the visual areas</font>

174
00:08:09,160 --> 00:08:15,430
and you get a physical<font color="#E5E5E5"> address or you</font>

175
00:08:12,100 --> 00:08:19,060
can use so-called huge pages and these

176
00:08:15,430 --> 00:08:20,830
are<font color="#CCCCCC"> free throw allocations there are</font>

177
00:08:19,060 --> 00:08:24,820
mapped to physically contiguous memory

178
00:08:20,830 --> 00:08:27,940
and if you have used pages<font color="#E5E5E5"> then you can</font>

179
00:08:24,820 --> 00:08:32,590
simply<font color="#E5E5E5"> use relative offsetting to you to</font>

180
00:08:27,940 --> 00:08:34,840
select aggressor rose so with this<font color="#E5E5E5"> you</font>

181
00:08:32,590 --> 00:08:38,890
can<font color="#E5E5E5"> do</font><font color="#CCCCCC"> lorimer expectation</font><font color="#E5E5E5"> the three</font>

182
00:08:34,840 --> 00:08:41,350
steps involved usually first as<font color="#CCCCCC"> you do</font>

183
00:08:38,890 --> 00:08:44,890
memory templating which means scanning

184
00:08:41,350 --> 00:08:48,430
drm footed tips that you can use then

185
00:08:44,890 --> 00:08:51,400
you have to land some sensitive data in

186
00:08:48,430 --> 00:08:54,489
UT REM some some data<font color="#E5E5E5"> that you want</font><font color="#CCCCCC"> to</font>

187
00:08:51,400 --> 00:08:57,160
<font color="#E5E5E5">flip a bit in and the data must be</font>

188
00:08:54,490 --> 00:08:59,200
stored<font color="#E5E5E5"> at this address um that is</font>

189
00:08:57,160 --> 00:09:01,660
vulnerable to remember and then you

190
00:08:59,200 --> 00:09:03,940
reproduce the tip you modify the sense

191
00:09:01,660 --> 00:09:06,230
the data in the compromised system this

192
00:09:03,940 --> 00:09:10,490
<font color="#E5E5E5">is what we call a good thing</font>

193
00:09:06,230 --> 00:09:13,810
good thank you<font color="#E5E5E5"> the deck okay so you're</font>

194
00:09:10,490 --> 00:09:18,470
<font color="#E5E5E5">back to me watching Gavin and then</font>

195
00:09:13,810 --> 00:09:20,209
breaking the<font color="#E5E5E5"> internet so this is</font><font color="#CCCCCC"> a cafe</font>

196
00:09:18,470 --> 00:09:23,630
on<font color="#CCCCCC"> the left and then in the right</font>

197
00:09:20,210 --> 00:09:27,370
presenting their work at the<font color="#CCCCCC"> Black Cats</font>

198
00:09:23,630 --> 00:09:29,770
<font color="#CCCCCC">Europe last</font><font color="#E5E5E5"> October or think and</font>

199
00:09:27,370 --> 00:09:32,710
basically<font color="#E5E5E5"> what they're doing is they're</font>

200
00:09:29,770 --> 00:09:35,689
breaking<font color="#CCCCCC"> the cloud</font><font color="#E5E5E5"> to draw a map showing</font>

201
00:09:32,710 --> 00:09:37,940
the<font color="#E5E5E5"> cloud you</font><font color="#CCCCCC"> have a victim</font><font color="#E5E5E5"> and you have</font>

202
00:09:35,690 --> 00:09:39,830
an attacker<font color="#CCCCCC"> that their attack model that</font>

203
00:09:37,940 --> 00:09:44,690
share the same hardware so they're both

204
00:09:39,830 --> 00:09:49,190
on the physical hardware with two

205
00:09:44,690 --> 00:09:51,200
separate<font color="#E5E5E5"> VMs the attackers root of</font>

206
00:09:49,190 --> 00:09:54,440
course in<font color="#E5E5E5"> his own vm so we can use other</font>

207
00:09:51,200 --> 00:09:56,990
nice tricks to guess washing and to use

208
00:09:54,440 --> 00:10:00,290
huge pages to figure out where memory

209
00:09:56,990 --> 00:10:04,520
<font color="#CCCCCC">you</font><font color="#E5E5E5"> tweet from so then what</font><font color="#CCCCCC"> I did in</font>

210
00:10:00,290 --> 00:10:08,089
<font color="#E5E5E5">this paper they do to text which i think</font>

211
00:10:04,520 --> 00:10:12,890
are both really cool one is they flipped

212
00:10:08,090 --> 00:10:14,900
a bit in a RSA key that is used for ssa

213
00:10:12,890 --> 00:10:17,780
it's in your ultra squeeze box because

214
00:10:14,900 --> 00:10:19,280
<font color="#CCCCCC">if you flip a bit in such key then</font>

215
00:10:17,780 --> 00:10:22,100
you're changing the public-private

216
00:10:19,280 --> 00:10:23,510
keeper so if you know a little bit about

217
00:10:22,100 --> 00:10:25,850
our say you know just<font color="#E5E5E5"> know if it's</font>

218
00:10:23,510 --> 00:10:27,980
working because you have this very<font color="#CCCCCC"> too</font>

219
00:10:25,850 --> 00:10:30,670
big prime numbers that you multiply with

220
00:10:27,980 --> 00:10:32,990
each other and it's very hard to go back

221
00:10:30,670 --> 00:10:35,240
from this very big number back<font color="#CCCCCC"> to the</font>

222
00:10:32,990 --> 00:10:37,040
prime numbers again but if you fit a bit

223
00:10:35,240 --> 00:10:39,980
in this big number it suddenly becomes

224
00:10:37,040 --> 00:10:43,339
very easy to do so sorry attacker can

225
00:10:39,980 --> 00:10:45,650
then factorize this new public key in

226
00:10:43,340 --> 00:10:47,630
which he<font color="#E5E5E5"> fits a bit i compute the</font>

227
00:10:45,650 --> 00:10:50,500
private key the bronx list and then use

228
00:10:47,630 --> 00:10:54,530
this to get ssh access to the victim<font color="#E5E5E5"> via</font>

229
00:10:50,500 --> 00:10:57,680
a second attack that it was not only

230
00:10:54,530 --> 00:11:01,069
flipping a bit in<font color="#CCCCCC"> crypto cavity but also</font>

231
00:10:57,680 --> 00:11:03,709
sleeping event in a domain name so what

232
00:11:01,070 --> 00:11:06,410
I did<font color="#E5E5E5"> for example is flipping a bit in</font>

233
00:11:03,710 --> 00:11:08,150
your<font color="#E5E5E5"> boom to calm so that becomes you</font>

234
00:11:06,410 --> 00:11:10,400
Boone who come and then the attacker

235
00:11:08,150 --> 00:11:12,170
would register your boom-boom calm so

236
00:11:10,400 --> 00:11:14,449
that whenever the victim will do an

237
00:11:12,170 --> 00:11:15,990
object upgrade on<font color="#E5E5E5"> its machine you don't</font>

238
00:11:14,450 --> 00:11:20,160
<font color="#CCCCCC">regret connect to you will too</font>

239
00:11:15,990 --> 00:11:22,380
but you<font color="#CCCCCC"> booboo</font><font color="#E5E5E5"> and pull the the ls were</font>

240
00:11:20,160 --> 00:11:28,319
quality also wherever packages the

241
00:11:22,380 --> 00:11:32,700
attacker<font color="#E5E5E5"> 12 back door from there so main</font>

242
00:11:28,320 --> 00:11:36,390
part grammar so I was watching I was

243
00:11:32,700 --> 00:11:37,680
<font color="#E5E5E5">looking at these guys at vu working on</font>

244
00:11:36,390 --> 00:11:40,680
this 5th tanks we attack and I thought

245
00:11:37,680 --> 00:11:42,390
goddesses this is<font color="#E5E5E5"> really cool right so a</font>

246
00:11:40,680 --> 00:11:45,209
couple days before this deadline what

247
00:11:42,390 --> 00:11:48,089
they were working on i opened my chap I

248
00:11:45,209 --> 00:11:49,410
was asking together can you<font color="#E5E5E5"> not do wrong</font>

249
00:11:48,089 --> 00:11:51,209
I'm wrong android because that would<font color="#CCCCCC"> be</font>

250
00:11:49,410 --> 00:11:52,949
really<font color="#CCCCCC"> cool so you get</font><font color="#E5E5E5"> all these nice</font>

251
00:11:51,209 --> 00:11:56,010
nice trick started using with memory

252
00:11:52,950 --> 00:11:59,190
dude application why is nobody looking

253
00:11:56,010 --> 00:12:02,189
at at<font color="#CCCCCC"> Android so Kara's response was</font>

254
00:11:59,190 --> 00:12:04,800
yeah depends a bit on the speed of the<font color="#E5E5E5"> N</font>

255
00:12:02,190 --> 00:12:06,420
word or the armed device that were using

256
00:12:04,800 --> 00:12:08,910
and what we should do some testing if

257
00:12:06,420 --> 00:12:12,959
I'd be interesting so that some<font color="#E5E5E5"> Google</font>

258
00:12:08,910 --> 00:12:15,660
research of course as academic so I

259
00:12:12,959 --> 00:12:18,689
found<font color="#E5E5E5"> out a tweet from 2015 little busy</font>

260
00:12:15,660 --> 00:12:20,610
<font color="#CCCCCC">year before</font><font color="#E5E5E5"> from den</font><font color="#CCCCCC"> kaminski and he was</font>

261
00:12:18,690 --> 00:12:23,910
asking<font color="#CCCCCC"> the public does arm have</font>

262
00:12:20,610 --> 00:12:26,220
something like<font color="#CCCCCC"> Siri flush and then two</font>

263
00:12:23,910 --> 00:12:28,829
interesting replies were there one was

264
00:12:26,220 --> 00:12:32,310
from<font color="#CCCCCC"> Alex saying yes but it's privileged</font>

265
00:12:28,829 --> 00:12:34,140
because arm are not idiots<font color="#CCCCCC"> ok fair</font>

266
00:12:32,310 --> 00:12:36,630
enough and then however flake also said

267
00:12:34,140 --> 00:12:39,449
there's also the question of the<font color="#E5E5E5"> memory</font>

268
00:12:36,630 --> 00:12:42,000
controller speed so maybe the memory

269
00:12:39,450 --> 00:12:43,680
controller<font color="#E5E5E5"> arm devices it looked fast</font>

270
00:12:42,000 --> 00:12:48,630
enough to actually trigger the<font color="#CCCCCC"> roller</font>

271
00:12:43,680 --> 00:12:53,760
back if you search further back you<font color="#CCCCCC"> also</font>

272
00:12:48,630 --> 00:12:56,160
find in October 2014 a blog post on or

273
00:12:53,760 --> 00:12:58,290
<font color="#CCCCCC">oppose them that on the box of chromium</font>

274
00:12:56,160 --> 00:13:01,469
<font color="#E5E5E5">the fork webpage where people were</font>

275
00:12:58,290 --> 00:13:08,160
asking for other instructions then seal

276
00:13:01,470 --> 00:13:10,260
us to flush data from the cpu cos and

277
00:13:08,160 --> 00:13:14,399
this was because of the you guys from

278
00:13:10,260 --> 00:13:20,010
<font color="#E5E5E5">project zero releasing their</font><font color="#CCCCCC"> raw met the</font>

279
00:13:14,399 --> 00:13:22,800
first former exploit nevertheless<font color="#CCCCCC"> i</font>

280
00:13:20,010 --> 00:13:26,670
didn't find any one<font color="#CCCCCC"> in saying</font><font color="#E5E5E5"> that they</font>

281
00:13:22,800 --> 00:13:28,740
<font color="#E5E5E5">fit bit successfully on arm so i sent an</font>

282
00:13:26,670 --> 00:13:29,370
email to<font color="#CCCCCC"> unique</font><font color="#E5E5E5"> and Martina these are</font>

283
00:13:28,740 --> 00:13:31,680
the

284
00:13:29,370 --> 00:13:33,779
<font color="#E5E5E5">Santa</font><font color="#CCCCCC"> Barbara that work me saying yeah</font>

285
00:13:31,680 --> 00:13:37,199
he's been<font color="#E5E5E5"> and cabaret they're really</font>

286
00:13:33,779 --> 00:13:39,240
running school paper and I know that the

287
00:13:37,200 --> 00:13:41,850
original<font color="#E5E5E5"> plan was for me to go to Santa</font>

288
00:13:39,240 --> 00:13:44,580
Barbara and work on this thing<font color="#E5E5E5"> but maybe</font>

289
00:13:41,850 --> 00:13:47,400
maybe<font color="#CCCCCC"> vollmer is it's also interesting</font>

290
00:13:44,580 --> 00:13:51,060
to look at so could it be PI from unique

291
00:13:47,400 --> 00:13:53,459
yes I like<font color="#CCCCCC"> it no idea why people not go</font>

292
00:13:51,060 --> 00:13:56,760
<font color="#CCCCCC">through to this so we should let me try</font>

293
00:13:53,460 --> 00:13:58,860
<font color="#CCCCCC">that</font><font color="#E5E5E5"> okay first of course there was the</font>

294
00:13:56,760 --> 00:14:01,830
Barbados so it was me going through

295
00:13:58,860 --> 00:14:05,730
<font color="#E5E5E5">bills and then march one</font><font color="#CCCCCC"> i arrived to</font>

296
00:14:01,830 --> 00:14:08,910
Santa Barbara and then I started<font color="#E5E5E5"> to</font>

297
00:14:05,730 --> 00:14:10,920
bootstrap the process so first of course

298
00:14:08,910 --> 00:14:13,290
there was still a deadline coming up

299
00:14:10,920 --> 00:14:16,920
because we had a paper accepted for this

300
00:14:13,290 --> 00:14:19,140
SNP conference which was called type

301
00:14:16,920 --> 00:14:21,110
armor and there we doin<font color="#CCCCCC"> confirm for</font>

302
00:14:19,140 --> 00:14:23,370
integrity so something pretty different

303
00:14:21,110 --> 00:14:24,870
but had to work on this and to make<font color="#CCCCCC"> sure</font>

304
00:14:23,370 --> 00:14:29,460
<font color="#CCCCCC">that</font><font color="#E5E5E5"> the papers very nice and people</font>

305
00:14:24,870 --> 00:14:32,370
like like with a cedar that<font color="#E5E5E5"> I was</font><font color="#CCCCCC"> March</font>

306
00:14:29,460 --> 00:14:35,100
18<font color="#E5E5E5"> I submit that 15 minutes late from</font>

307
00:14:32,370 --> 00:14:37,529
marc citing nevertheless was still

308
00:14:35,100 --> 00:14:39,720
pretty good and meanwhile did some work

309
00:14:37,529 --> 00:14:43,770
but not a lot so what I did was on marks

310
00:14:39,720 --> 00:14:46,290
10 I<font color="#CCCCCC"> propelled the North kuna myself for</font>

311
00:14:43,770 --> 00:14:48,510
a nexus 5 and I added<font color="#CCCCCC"> this sport for</font>

312
00:14:46,290 --> 00:14:52,050
loadable kernel modules because the ID

313
00:14:48,510 --> 00:14:54,209
was that since this<font color="#CCCCCC"> CEO flush the flash</font>

314
00:14:52,050 --> 00:14:56,880
<font color="#E5E5E5">instruction is privileged from arm the</font>

315
00:14:54,209 --> 00:15:00,239
idea was<font color="#CCCCCC"> to do lorimer first from the</font>

316
00:14:56,880 --> 00:15:03,020
<font color="#E5E5E5">kernel module because if you're running</font>

317
00:15:00,240 --> 00:15:06,000
in the kernel you can do anything one

318
00:15:03,020 --> 00:15:08,339
just to see whether you could flip<font color="#CCCCCC"> its</font>

319
00:15:06,000 --> 00:15:11,550
at all so here's my<font color="#CCCCCC"> next</font><font color="#E5E5E5"> five took a</font>

320
00:15:08,339 --> 00:15:15,060
picture Martin I was running a crystal

321
00:15:11,550 --> 00:15:17,760
girl quick march then we started

322
00:15:15,060 --> 00:15:22,380
deadline for the paper if we wanted to

323
00:15:17,760 --> 00:15:25,200
<font color="#E5E5E5">split may 23 then the next day god I was</font>

324
00:15:22,380 --> 00:15:29,010
asking<font color="#CCCCCC"> you may be one stream first I'm</font>

325
00:15:25,200 --> 00:15:31,260
curious so I never heard of stream so he

326
00:15:29,010 --> 00:15:34,439
gave me this website and basically this

327
00:15:31,260 --> 00:15:37,560
is the benchmarking tool for given

328
00:15:34,440 --> 00:15:39,720
benefit<font color="#CCCCCC"> okay good is there are minor in</font>

329
00:15:37,560 --> 00:15:42,060
of course not<font color="#CCCCCC"> trying to compile it and I</font>

330
00:15:39,720 --> 00:15:45,450
run it I had no idea<font color="#CCCCCC"> with this</font><font color="#E5E5E5"> meant</font>

331
00:15:42,060 --> 00:15:49,010
so just copy pasted and then whether

332
00:15:45,450 --> 00:15:52,950
it's for cargo to reply no it's not good

333
00:15:49,010 --> 00:15:54,390
maybe it's good enough but ideally we

334
00:15:52,950 --> 00:15:56,910
would get<font color="#CCCCCC"> two million operations per</font>

335
00:15:54,390 --> 00:15:59,640
second and right now it says<font color="#CCCCCC"> oh point</font>

336
00:15:56,910 --> 00:16:01,350
five so we were already a little<font color="#E5E5E5"> bit as</font>

337
00:15:59,640 --> 00:16:05,910
a mistake about whether this would work

338
00:16:01,350 --> 00:16:11,180
at all<font color="#E5E5E5"> ok so two teams working on the</font>

339
00:16:05,910 --> 00:16:14,880
other paper i'm still at<font color="#CCCCCC"> marks 23</font><font color="#E5E5E5"> i</font>

340
00:16:11,180 --> 00:16:19,109
finally got my first actual work done on

341
00:16:14,880 --> 00:16:21,780
this project because this here is the is

342
00:16:19,110 --> 00:16:26,610
the main loop in arm assembly that i was

343
00:16:21,780 --> 00:16:30,449
using to flip bits or try to flip it in

344
00:16:26,610 --> 00:16:33,900
the colonel so thought Gary this seems

345
00:16:30,450 --> 00:16:36,660
to work right tomorrow i will look at 14

346
00:16:33,900 --> 00:16:40,170
this file<font color="#E5E5E5"> of math that CC so what is</font>

347
00:16:36,660 --> 00:16:41,400
<font color="#E5E5E5">this mac that's easy it's really it's a</font>

348
00:16:40,170 --> 00:16:44,250
piece of art but we needs a piece of

349
00:16:41,400 --> 00:16:47,459
crap from<font color="#E5E5E5"> the remainders of flip thank</font>

350
00:16:44,250 --> 00:16:49,350
<font color="#E5E5E5">you e and actually that was then based</font>

351
00:16:47,460 --> 00:16:52,080
on the code from Roman<font color="#CCCCCC"> GS which was</font>

352
00:16:49,350 --> 00:16:53,640
based on project zero goat so many

353
00:16:52,080 --> 00:16:56,310
people worked on this and was<font color="#E5E5E5"> really</font>

354
00:16:53,640 --> 00:16:57,600
unstructured but it worked so complete

355
00:16:56,310 --> 00:16:59,939
Frank<font color="#CCCCCC"> Cherie they use this and they got</font>

356
00:16:57,600 --> 00:17:03,240
<font color="#E5E5E5">this stituted so the idea was just 40 s</font>

357
00:16:59,940 --> 00:17:07,620
to arm and run it see where we could

358
00:17:03,240 --> 00:17:10,230
flip a bit gary was saying<font color="#CCCCCC"> they have a</font>

359
00:17:07,619 --> 00:17:12,359
meeting in six hours so for me I<font color="#E5E5E5"> was</font>

360
00:17:10,230 --> 00:17:13,560
<font color="#E5E5E5">going to bed different time zone I told</font>

361
00:17:12,359 --> 00:17:15,869
<font color="#E5E5E5">them you have a meeting at six hours</font>

362
00:17:13,560 --> 00:17:20,429
<font color="#E5E5E5">then you have six hours to port or co2</font>

363
00:17:15,869 --> 00:17:22,530
arm so<font color="#CCCCCC"> okay sure can tell me how</font>

364
00:17:20,430 --> 00:17:25,020
<font color="#E5E5E5">actually I'm supposed to talk to your</font>

365
00:17:22,530 --> 00:17:27,990
kernel module to do the hammering so I

366
00:17:25,020 --> 00:17:29,490
<font color="#E5E5E5">explained him how the dogs</font><font color="#CCCCCC"> to work and</font>

367
00:17:27,990 --> 00:17:32,820
then<font color="#E5E5E5"> I told them yet so when I wake up</font>

368
00:17:29,490 --> 00:17:35,490
tomorrow<font color="#E5E5E5"> go to be bit tips and then the</font>

369
00:17:32,820 --> 00:17:39,000
answer was I doubt it please you can try

370
00:17:35,490 --> 00:17:41,820
it for more work and then set<font color="#CCCCCC"> now this</font>

371
00:17:39,000 --> 00:17:47,700
is wrong it's a bit more work than<font color="#E5E5E5"> a</font>

372
00:17:41,820 --> 00:17:50,189
<font color="#CCCCCC">fuck okay a bit more about this somebody</font>

373
00:17:47,700 --> 00:17:51,960
was asking yeah I get this wait output

374
00:17:50,190 --> 00:17:54,570
from your from the<font color="#E5E5E5"> kernel module it says</font>

375
00:17:51,960 --> 00:17:55,350
I've got a<font color="#CCCCCC"> return value zero what does</font>

376
00:17:54,570 --> 00:17:57,570
it room

377
00:17:55,350 --> 00:17:59,520
so I'm a very good programmer of course

378
00:17:57,570 --> 00:18:02,120
and i was saying yeah it returns the

379
00:17:59,520 --> 00:18:05,910
<font color="#E5E5E5">number of cycles that we never used</font>

380
00:18:02,120 --> 00:18:08,418
there to do the hammering so if you get

381
00:18:05,910 --> 00:18:11,490
the serial cycles the look good right

382
00:18:08,419 --> 00:18:13,740
and that's<font color="#E5E5E5"> okay sometimes it returns 0 I</font>

383
00:18:11,490 --> 00:18:17,370
don't know why but<font color="#E5E5E5"> sometimes also</font>

384
00:18:13,740 --> 00:18:18,720
returns a larger value<font color="#CCCCCC"> okay anyway I</font>

385
00:18:17,370 --> 00:18:20,699
<font color="#E5E5E5">already came to the conclusion that</font>

386
00:18:18,720 --> 00:18:23,280
doing this kind of research was really

387
00:18:20,700 --> 00:18:27,120
tricky because we could do something

388
00:18:23,280 --> 00:18:28,740
wrong maybe<font color="#E5E5E5"> we were unlucky with the</font>

389
00:18:27,120 --> 00:18:31,379
phones that we were<font color="#E5E5E5"> looking at devices</font>

390
00:18:28,740 --> 00:18:33,090
<font color="#CCCCCC">that did not have it zips or maybe</font><font color="#E5E5E5"> that</font>

391
00:18:31,380 --> 00:18:34,650
memory controller was really too slow so

392
00:18:33,090 --> 00:18:40,309
there was a lot of things<font color="#E5E5E5"> that could go</font>

393
00:18:34,650 --> 00:18:43,070
wrong doing this<font color="#E5E5E5"> research anyway I</font>

394
00:18:40,309 --> 00:18:46,230
<font color="#CCCCCC">continued look it into this problem</font><font color="#E5E5E5"> of</font>

395
00:18:43,070 --> 00:18:48,928
the zero return value I was looking<font color="#CCCCCC"> at</font>

396
00:18:46,230 --> 00:18:53,130
<font color="#E5E5E5">this piece of code and I was saying yeah</font>

397
00:18:48,929 --> 00:18:56,940
israel israeli 98 but this instruction i

398
00:18:53,130 --> 00:19:04,280
was using MCR should get the cycle count

399
00:18:56,940 --> 00:19:07,679
<font color="#E5E5E5">into register r3 what what is this right</font>

400
00:19:04,280 --> 00:19:10,070
now why don't we like arm because<font color="#E5E5E5"> I</font>

401
00:19:07,679 --> 00:19:14,880
<font color="#CCCCCC">figured out</font><font color="#E5E5E5"> what we're going on here</font>

402
00:19:10,070 --> 00:19:19,260
telling cavities so we have this

403
00:19:14,880 --> 00:19:20,730
instruction on arm it's called MCR there

404
00:19:19,260 --> 00:19:23,520
are something with a call professor

405
00:19:20,730 --> 00:19:26,220
coprocessor coprocessor is a generic

406
00:19:23,520 --> 00:19:28,500
word here but then you have another

407
00:19:26,220 --> 00:19:29,909
instruction that also does something

408
00:19:28,500 --> 00:19:34,740
<font color="#CCCCCC">with</font><font color="#E5E5E5"> the coprocessor and this</font>

409
00:19:29,909 --> 00:19:39,090
instruction is anybody knows so it's mr

410
00:19:34,740 --> 00:19:40,770
c and then the difference is that one is

411
00:19:39,090 --> 00:19:44,129
reading<font color="#CCCCCC"> the</font><font color="#E5E5E5"> other ones writing so if you</font>

412
00:19:40,770 --> 00:19:47,480
have a typo in your assembly code it was

413
00:19:44,130 --> 00:19:49,590
very<font color="#CCCCCC"> hard to to to spot the issue there</font>

414
00:19:47,480 --> 00:19:51,900
anyway coverage response was yeah<font color="#E5E5E5"> I</font>

415
00:19:49,590 --> 00:19:53,580
<font color="#E5E5E5">always thought that are we never look at</font>

416
00:19:51,900 --> 00:19:56,669
this before a father was supposed to be

417
00:19:53,580 --> 00:20:01,799
nicer than x86 but<font color="#CCCCCC"> uh turnout wasn't</font>

418
00:19:56,669 --> 00:20:05,929
really any way we continued trying to

419
00:20:01,799 --> 00:20:08,059
hammer so it was running at some point

420
00:20:05,929 --> 00:20:09,919
then all<font color="#CCCCCC"> you have to do with long as you</font>

421
00:20:08,059 --> 00:20:13,070
wait until you hope that you get a bit

422
00:20:09,919 --> 00:20:15,049
<font color="#CCCCCC">sip I was only pessimistic probably</font>

423
00:20:13,070 --> 00:20:16,850
won't see anything<font color="#E5E5E5"> Cara was very</font>

424
00:20:15,049 --> 00:20:20,119
optimistic and yet tomorrow tomorrow

425
00:20:16,850 --> 00:20:23,049
we'll get the tips so the<font color="#CCCCCC"> next day</font>

426
00:20:20,119 --> 00:20:26,809
debugging hammering debugging hammering

427
00:20:23,049 --> 00:20:29,299
for<font color="#E5E5E5"> 410 in the afternoon notice it's a</font>

428
00:20:26,809 --> 00:20:32,990
couple hours<font color="#CCCCCC"> later still of the tips and</font>

429
00:20:29,299 --> 00:20:36,309
then press this later in<font color="#E5E5E5"> evening still</font>

430
00:20:32,990 --> 00:20:39,559
no pit zips<font color="#E5E5E5"> gamma at a very good point</font>

431
00:20:36,309 --> 00:20:40,759
if it would<font color="#E5E5E5"> have been easy then people</font>

432
00:20:39,559 --> 00:20:42,379
would have done<font color="#E5E5E5"> this before and</font><font color="#CCCCCC"> they</font>

433
00:20:40,759 --> 00:20:44,869
would have reported it already right so

434
00:20:42,379 --> 00:20:49,309
not supposed to be easy it not supposed

435
00:20:44,869 --> 00:20:51,559
to work to start<font color="#E5E5E5"> that anyway I received</font>

436
00:20:49,309 --> 00:20:55,249
an email from the bus<font color="#E5E5E5"> every boss my</font>

437
00:20:51,559 --> 00:20:57,970
<font color="#E5E5E5">professor and he was saying victorious</font>

438
00:20:55,249 --> 00:21:01,119
at santa barbara is looking for big tips

439
00:20:57,970 --> 00:21:04,700
he is not allowed<font color="#E5E5E5"> to go</font><font color="#CCCCCC"> serve ring or</font>

440
00:21:01,119 --> 00:21:09,199
anything<font color="#E5E5E5"> else kind of fun until he gets</font>

441
00:21:04,700 --> 00:21:14,119
a flip mar 25<font color="#CCCCCC"> okay so we have</font><font color="#E5E5E5"> to flip</font>

442
00:21:09,200 --> 00:21:17,539
some pits within the morning please wake

443
00:21:14,119 --> 00:21:20,269
up must be wrong right so I found

444
00:21:17,539 --> 00:21:24,289
<font color="#E5E5E5">something but uh didn't really look</font>

445
00:21:20,269 --> 00:21:26,389
quite I said yeah must be wrong<font color="#CCCCCC"> of</font>

446
00:21:24,289 --> 00:21:28,369
<font color="#E5E5E5">course yeah</font><font color="#CCCCCC"> zero</font><font color="#E5E5E5"> doesn't really look</font>

447
00:21:26,389 --> 00:21:30,199
like a big tip but could be that the

448
00:21:28,369 --> 00:21:33,019
porting something went wrong there so

449
00:21:30,200 --> 00:21:36,139
maybe there's a bug in the code and so

450
00:21:33,019 --> 00:21:38,029
copy paste is a bit more<font color="#E5E5E5"> data and it's</font>

451
00:21:36,139 --> 00:21:42,350
weird right because so if you look<font color="#E5E5E5"> at</font>

452
00:21:38,029 --> 00:21:47,119
<font color="#CCCCCC">the output here it's saying so bit flip</font>

453
00:21:42,350 --> 00:21:50,059
in row 254 but here it's saying it's

454
00:21:47,119 --> 00:21:51,980
remembering the rows 2 1 for 7 to 14 8

455
00:21:50,059 --> 00:21:54,830
12 full nights out so having this room

456
00:21:51,980 --> 00:21:58,309
so it's really weird<font color="#E5E5E5"> stuffing out</font><font color="#CCCCCC"> before</font>

457
00:21:54,830 --> 00:22:02,720
do<font color="#E5E5E5"> you think ghahve was taking a dump</font>

458
00:21:58,309 --> 00:22:06,259
<font color="#CCCCCC">okay but</font><font color="#E5E5E5"> as weird so</font><font color="#CCCCCC"> i probably a issue</font>

459
00:22:02,720 --> 00:22:10,279
with big<font color="#CCCCCC"> endian middle and</font><font color="#E5E5E5"> lower 64 bit</font>

460
00:22:06,259 --> 00:22:13,759
from 32-bit code I don't care right it's

461
00:22:10,279 --> 00:22:16,490
a bit type or not or likely likely<font color="#CCCCCC"> okay</font>

462
00:22:13,759 --> 00:22:19,130
<font color="#E5E5E5">interesting we have to test again fix me</font>

463
00:22:16,490 --> 00:22:21,950
code so retrying

464
00:22:19,130 --> 00:22:26,090
and then the next<font color="#E5E5E5"> day after I got the</font>

465
00:22:21,950 --> 00:22:29,960
email<font color="#E5E5E5"> from</font><font color="#CCCCCC"> her boss all I replied was</font>

466
00:22:26,090 --> 00:22:33,649
literally this so found a bit flip and

467
00:22:29,960 --> 00:22:40,460
then<font color="#E5E5E5"> I said I go to the beach now so I</font>

468
00:22:33,650 --> 00:22:42,830
went to beat and basically<font color="#CCCCCC"> from</font><font color="#E5E5E5"> there on</font>

469
00:22:40,460 --> 00:22:44,900
we knew that<font color="#E5E5E5"> okay we can flip bits from</font>

470
00:22:42,830 --> 00:22:47,210
arm so it's an interesting<font color="#E5E5E5"> result</font>

471
00:22:44,900 --> 00:22:49,850
already of<font color="#CCCCCC"> course not really enough to</font>

472
00:22:47,210 --> 00:22:53,480
do scientific work on but we know that

473
00:22:49,850 --> 00:22:56,600
something was possible over the next

474
00:22:53,480 --> 00:22:59,510
period so now we had marched 27 to April

475
00:22:56,600 --> 00:23:01,179
when certain the next month or so we

476
00:22:59,510 --> 00:23:04,850
<font color="#CCCCCC">were going into a downward spiral</font>

477
00:23:01,180 --> 00:23:07,100
because flipping a bit from kernel

478
00:23:04,850 --> 00:23:09,169
module so it's<font color="#E5E5E5"> cool but it's pretty</font>

479
00:23:07,100 --> 00:23:13,250
useless because you have to be in the

480
00:23:09,170 --> 00:23:15,920
kernel already and it's pretty<font color="#CCCCCC"> hard for</font>

481
00:23:13,250 --> 00:23:20,390
an attacker to do so so the<font color="#CCCCCC"> next goal</font>

482
00:23:15,920 --> 00:23:23,210
was for work to flick a bit as rude but

483
00:23:20,390 --> 00:23:25,550
without the kernel module so here's a

484
00:23:23,210 --> 00:23:29,150
process report all the things I<font color="#CCCCCC"> did</font>

485
00:23:25,550 --> 00:23:32,169
during this disconnect for weeks first I

486
00:23:29,150 --> 00:23:35,180
did figuring out the<font color="#CCCCCC"> row sighs so</font>

487
00:23:32,170 --> 00:23:37,100
figuring out exactly what are we doing

488
00:23:35,180 --> 00:23:40,550
joe becerra<font color="#CCCCCC"> double sized remember or not</font>

489
00:23:37,100 --> 00:23:43,879
<font color="#CCCCCC">I made changes and fixes to this mad at</font>

490
00:23:40,550 --> 00:23:46,940
CC piece of crap I found it for my own

491
00:23:43,880 --> 00:23:50,500
phone very cool but also<font color="#E5E5E5"> so useless I</font>

492
00:23:46,940 --> 00:23:54,170
was hammering a 64-bit device Nexus 5x

493
00:23:50,500 --> 00:23:56,600
which has a user space guest pass

494
00:23:54,170 --> 00:23:59,600
instructions or figured that maybe we

495
00:23:56,600 --> 00:24:01,969
could use that I was hammering using

496
00:23:59,600 --> 00:24:03,350
multiple cores because yeah dude faster

497
00:24:01,970 --> 00:24:05,750
and maybe you get hired sense of

498
00:24:03,350 --> 00:24:08,750
flipping a bit<font color="#E5E5E5"> I was playing with memory</font>

499
00:24:05,750 --> 00:24:10,610
fences I was<font color="#E5E5E5"> looking at</font><font color="#CCCCCC"> all performance</font>

500
00:24:08,750 --> 00:24:12,970
counters at what should be a Magus ms

501
00:24:10,610 --> 00:24:16,939
and then<font color="#E5E5E5"> I</font><font color="#CCCCCC"> also got a parking ticket</font>

502
00:24:12,970 --> 00:24:19,400
here's<font color="#E5E5E5"> my parking ticket so it says part</font>

503
00:24:16,940 --> 00:24:23,780
<font color="#CCCCCC">one way on</font><font color="#E5E5E5"> street apparently if you're</font>

504
00:24:19,400 --> 00:24:26,150
in the US and if you were new street and

505
00:24:23,780 --> 00:24:28,879
you want to park then your car must also

506
00:24:26,150 --> 00:24:30,860
be facing the way that you drive in so

507
00:24:28,880 --> 00:24:32,360
you're<font color="#E5E5E5"> not allowed if there's space over</font>

508
00:24:30,860 --> 00:24:33,049
there you're<font color="#CCCCCC"> not allowed to just slide</font>

509
00:24:32,360 --> 00:24:36,379
in a<font color="#CCCCCC"> park</font>

510
00:24:33,049 --> 00:24:39,259
I don't really<font color="#E5E5E5"> get why but I got a</font>

511
00:24:36,379 --> 00:24:43,340
parking ticket anyway the downward

512
00:24:39,259 --> 00:24:45,169
spiral started so I figured maybe<font color="#CCCCCC"> I</font>

513
00:24:43,340 --> 00:24:47,799
should look<font color="#E5E5E5"> at some side channels figure</font>

514
00:24:45,169 --> 00:24:51,759
out what the hardware is actually doing

515
00:24:47,799 --> 00:24:55,399
so that next first thing I did is

516
00:24:51,759 --> 00:24:57,549
reading from two different heiresses and

517
00:24:55,399 --> 00:25:02,080
then measuring how long it took me to

518
00:24:57,549 --> 00:25:04,279
read these dollars from from the system

519
00:25:02,080 --> 00:25:08,210
and what you see here<font color="#CCCCCC"> is</font><font color="#E5E5E5"> that there's a</font>

520
00:25:04,279 --> 00:25:11,480
spike close to 64 bytes which means<font color="#E5E5E5"> that</font>

521
00:25:08,210 --> 00:25:14,149
the level one cache was 64 bytes there's

522
00:25:11,480 --> 00:25:18,049
another spike over here there to tell me

523
00:25:14,149 --> 00:25:20,508
that level 2 cos was 128 bytes so sorry

524
00:25:18,049 --> 00:25:24,230
i'm<font color="#CCCCCC"> not saying is right so the gas lines</font>

525
00:25:20,509 --> 00:25:28,489
are 64 bytes for level 1 f1 f2 it was

526
00:25:24,230 --> 00:25:33,350
128 bytes I did more side channels more

527
00:25:28,489 --> 00:25:37,489
reading and here i found that level 1

528
00:25:33,350 --> 00:25:40,600
gasps actually is exactly 16 kilobyte<font color="#CCCCCC"> I</font>

529
00:25:37,489 --> 00:25:44,149
found the level<font color="#E5E5E5"> 2 cache is to megabyte</font>

530
00:25:40,600 --> 00:25:47,509
using another cool side channel but all

531
00:25:44,149 --> 00:25:49,668
<font color="#CCCCCC">of this you can just</font><font color="#E5E5E5"> find a Wikipedia so</font>

532
00:25:47,509 --> 00:25:52,129
it was a bit useless but at least I knew

533
00:25:49,669 --> 00:25:54,019
that I was using the correct data as a

534
00:25:52,129 --> 00:25:59,059
vesicle we have here is side channels

535
00:25:54,019 --> 00:26:02,480
and more sectionals<font color="#CCCCCC"> okay I got a message</font>

536
00:25:59,059 --> 00:26:04,519
from from Quebec been the other guy with

537
00:26:02,480 --> 00:26:06,679
fitting shoe is also looking at flushing

538
00:26:04,519 --> 00:26:08,989
the gas<font color="#CCCCCC"> maybe you should</font><font color="#E5E5E5"> work together</font>

539
00:26:06,679 --> 00:26:12,109
<font color="#E5E5E5">although he's only doing it for purpose</font>

540
00:26:08,989 --> 00:26:14,059
of money so i was looking at iphone<font color="#E5E5E5"> but</font>

541
00:26:12,109 --> 00:26:16,939
<font color="#E5E5E5">he had an</font><font color="#CCCCCC"> idea to do gasps for system</font>

542
00:26:14,059 --> 00:26:19,100
call it might actually work yeah sure<font color="#CCCCCC"> i</font>

543
00:26:16,940 --> 00:26:23,509
also want to<font color="#E5E5E5"> make some cash so let's</font>

544
00:26:19,100 --> 00:26:25,459
<font color="#E5E5E5">look at this the gas was system call so</font>

545
00:26:23,509 --> 00:26:28,129
we open the main page and apparently

546
00:26:25,460 --> 00:26:31,639
every<font color="#CCCCCC"> linux system has the system call</font>

547
00:26:28,129 --> 00:26:33,949
and if you<font color="#E5E5E5"> look at</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> description it</font>

548
00:26:31,639 --> 00:26:38,869
says flush the contents or an

549
00:26:33,950 --> 00:26:41,809
instruction or the data cache ok so the

550
00:26:38,869 --> 00:26:44,149
<font color="#E5E5E5">ID now would be since you can call this</font>

551
00:26:41,809 --> 00:26:48,170
system call from user space would be

552
00:26:44,150 --> 00:26:50,090
<font color="#CCCCCC">emer unusual and and then</font><font color="#E5E5E5"> call this</font>

553
00:26:48,170 --> 00:26:54,710
system call the casbah system called the

554
00:26:50,090 --> 00:26:57,740
first occasion however if you're jumping

555
00:26:54,710 --> 00:26:59,930
into into the<font color="#CCCCCC"> kernel</font><font color="#E5E5E5"> after every read it</font>

556
00:26:57,740 --> 00:27:01,670
is going to<font color="#CCCCCC"> be very expensive and you're</font>

557
00:26:59,930 --> 00:27:07,940
going to<font color="#E5E5E5"> be too slow to actually trigger</font>

558
00:27:01,670 --> 00:27:10,010
this aroma bug but what<font color="#CCCCCC"> if we can what</font>

559
00:27:07,940 --> 00:27:11,870
if<font color="#CCCCCC"> we</font><font color="#E5E5E5"> don't have to floss after every</font>

560
00:27:10,010 --> 00:27:16,220
single read but what if you floss after

561
00:27:11,870 --> 00:27:18,199
a number of weeds so this<font color="#E5E5E5"> is what we</font>

562
00:27:16,220 --> 00:27:21,020
call pointed chasing or something

563
00:27:18,200 --> 00:27:23,990
similar technique we have here the drm

564
00:27:21,020 --> 00:27:26,500
on top with three rows and we have the

565
00:27:23,990 --> 00:27:29,210
cpu class so what we're doing<font color="#E5E5E5"> here was</font>

566
00:27:26,500 --> 00:27:32,030
reading from the first row this<font color="#E5E5E5"> verse</font>

567
00:27:29,210 --> 00:27:34,970
upset one cache line exactly i would get

568
00:27:32,030 --> 00:27:39,020
stored in the cpu<font color="#E5E5E5"> cos we would read from</font>

569
00:27:34,970 --> 00:27:42,650
the third row offset 0 would be stored

570
00:27:39,020 --> 00:27:44,750
in<font color="#E5E5E5"> the cpu cast different gas line will</font>

571
00:27:42,650 --> 00:27:47,960
go back<font color="#CCCCCC"> to the first row read again</font>

572
00:27:44,750 --> 00:27:54,350
<font color="#E5E5E5">stores in the gas go to the third row</font>

573
00:27:47,960 --> 00:27:57,760
again etc etc until we read all the gas

574
00:27:54,350 --> 00:28:01,490
lines that are available and then we do

575
00:27:57,760 --> 00:28:03,650
guess plus so now we only have to do a

576
00:28:01,490 --> 00:28:05,990
guest pass for every six weeks set of

577
00:28:03,650 --> 00:28:09,110
after<font color="#E5E5E5"> every single read what it was the</font>

578
00:28:05,990 --> 00:28:13,040
cash and then we look back and really

579
00:28:09,110 --> 00:28:15,199
can so here you only have to pay for

580
00:28:13,040 --> 00:28:17,360
every n accesses where and it's

581
00:28:15,200 --> 00:28:20,840
arbitrary or not very arbitrary so the

582
00:28:17,360 --> 00:28:23,030
upper bound to is but you you're paying

583
00:28:20,840 --> 00:28:26,899
less for the colonel had introduced by

584
00:28:23,030 --> 00:28:28,970
<font color="#E5E5E5">cass pass so but does it work right can</font>

585
00:28:26,900 --> 00:28:32,900
we flip<font color="#CCCCCC"> its with</font><font color="#E5E5E5"> this well turns out we</font>

586
00:28:28,970 --> 00:28:34,850
can we wrote our own gas wash system

587
00:28:32,900 --> 00:28:36,680
call implementation just to make<font color="#CCCCCC"> sure it</font>

588
00:28:34,850 --> 00:28:39,469
was really doing what we wanted to do

589
00:28:36,680 --> 00:28:41,270
and<font color="#CCCCCC"> i implemented</font><font color="#E5E5E5"> this and this was</font>

590
00:28:39,470 --> 00:28:45,260
<font color="#E5E5E5">really working i was looking</font><font color="#CCCCCC"> it's so</font>

591
00:28:41,270 --> 00:28:47,150
<font color="#E5E5E5">school stuff but when i was using the</font>

592
00:28:45,260 --> 00:28:51,440
test for system call that was provided

593
00:28:47,150 --> 00:28:55,730
by link system it didn't work we have<font color="#E5E5E5"> to</font>

594
00:28:51,440 --> 00:28:56,800
read the menu<font color="#CCCCCC"> okay so I i recommend and</font>

595
00:28:55,730 --> 00:28:59,080
then

596
00:28:56,800 --> 00:29:02,860
it was a bit<font color="#E5E5E5"> more than the bottom of the</font>

597
00:28:59,080 --> 00:29:04,929
main page where it says so can the gas

598
00:29:02,860 --> 00:29:08,260
maybe did your flashing<font color="#E5E5E5"> maybe one of I</font>

599
00:29:04,930 --> 00:29:10,060
guess or geek ass and then the<font color="#CCCCCC"> TCAs was</font>

600
00:29:08,260 --> 00:29:14,350
saying right back to memory and

601
00:29:10,060 --> 00:29:16,450
invalidate the affected gas lines but

602
00:29:14,350 --> 00:29:18,490
what what is invalid what does<font color="#CCCCCC"> it mean</font>

603
00:29:16,450 --> 00:29:21,220
and why is it<font color="#CCCCCC"> that why does not safe for</font>

604
00:29:18,490 --> 00:29:23,740
us so<font color="#CCCCCC"> if we then look at ICAST for</font>

605
00:29:21,220 --> 00:29:27,310
example it says<font color="#CCCCCC"> flush the instruction</font>

606
00:29:23,740 --> 00:29:29,850
cache rusticus so can we use this in

607
00:29:27,310 --> 00:29:34,960
other words can we use a different gas

608
00:29:29,850 --> 00:29:37,719
so previously we were reading on me<font color="#CCCCCC"> come</font>

609
00:29:34,960 --> 00:29:39,790
<font color="#E5E5E5">here</font><font color="#CCCCCC"> m and the data was stored in</font><font color="#E5E5E5"> the</font>

610
00:29:37,720 --> 00:29:42,940
gas but more particularly<font color="#E5E5E5"> restored in</font>

611
00:29:39,790 --> 00:29:45,070
the<font color="#CCCCCC"> D cast the data cache the specific</font>

612
00:29:42,940 --> 00:29:49,920
cpu<font color="#E5E5E5"> case where</font><font color="#CCCCCC"> you store data from</font>

613
00:29:45,070 --> 00:29:54,010
memory now we go to try the new centric

614
00:29:49,920 --> 00:29:55,930
but get these gas lines this memory

615
00:29:54,010 --> 00:29:59,379
stored in the IKS so the instruction

616
00:29:55,930 --> 00:30:01,510
class so what we're going to do is a

617
00:29:59,380 --> 00:30:05,470
really nice trick you have to flip<font color="#E5E5E5"> bits</font>

618
00:30:01,510 --> 00:30:09,340
by executing code so in veeram we have

619
00:30:05,470 --> 00:30:11,770
this region that's executable and in the

620
00:30:09,340 --> 00:30:15,490
first gas line of the drm we'd have an

621
00:30:11,770 --> 00:30:18,550
instruction jump jump + 66 offsets away

622
00:30:15,490 --> 00:30:22,480
and what is their six upsets away so

623
00:30:18,550 --> 00:30:24,820
first of all<font color="#CCCCCC"> it's of course two rows</font>

624
00:30:22,480 --> 00:30:27,900
away and then there we find another jump

625
00:30:24,820 --> 00:30:30,460
instruction that just go back five exits

626
00:30:27,900 --> 00:30:33,460
so we're going back to the first row

627
00:30:30,460 --> 00:30:36,520
again there's another job come to the

628
00:30:33,460 --> 00:30:41,560
third row back to<font color="#CCCCCC"> the first row and then</font>

629
00:30:36,520 --> 00:30:44,050
maybe end in the last<font color="#CCCCCC"> this last sort of</font>

630
00:30:41,560 --> 00:30:47,050
the sections that will be a combination

631
00:30:44,050 --> 00:30:49,840
of gas<font color="#E5E5E5"> splash so flash now the</font>

632
00:30:47,050 --> 00:30:52,389
extraction<font color="#E5E5E5"> gas and then jump back to the</font>

633
00:30:49,840 --> 00:30:57,370
beginning sorry Fashion Week ass and we

634
00:30:52,390 --> 00:31:00,940
jumping back so we're executing code and

635
00:30:57,370 --> 00:31:04,989
trying to flip<font color="#E5E5E5"> its using this and it</font>

636
00:31:00,940 --> 00:31:07,120
work it's pretty cool so we're<font color="#E5E5E5"> using our</font>

637
00:31:04,990 --> 00:31:10,120
own gas processing going from data again

638
00:31:07,120 --> 00:31:11,250
as we will flipping bits by executing

639
00:31:10,120 --> 00:31:14,500
code

640
00:31:11,250 --> 00:31:17,890
and if you know that this works<font color="#E5E5E5"> are</font><font color="#CCCCCC"> you</font>

641
00:31:14,500 --> 00:31:19,420
can who thinks like rope brohamer<font color="#E5E5E5"> or in</font>

642
00:31:17,890 --> 00:31:22,480
<font color="#E5E5E5">the programming where if you gets it so</font>

643
00:31:19,420 --> 00:31:24,700
right<font color="#E5E5E5"> aloft then maybe you can stick</font>

644
00:31:22,480 --> 00:31:28,720
gets<font color="#E5E5E5"> it in such a way that you're doing</font>

645
00:31:24,700 --> 00:31:30,730
<font color="#E5E5E5">a romantic Gustav but of course it</font>

646
00:31:28,720 --> 00:31:33,190
didn't work when we<font color="#E5E5E5"> use it when we were</font>

647
00:31:30,730 --> 00:31:39,190
using the gas plus<font color="#E5E5E5"> system call it was</font>

648
00:31:33,190 --> 00:31:41,440
provided<font color="#CCCCCC"> by the system so why maybe the</font>

649
00:31:39,190 --> 00:31:42,460
gas was system call is bloated maybe

650
00:31:41,440 --> 00:31:44,770
there may be there<font color="#CCCCCC"> are too many</font>

651
00:31:42,460 --> 00:31:47,559
instructions in there adding too much

652
00:31:44,770 --> 00:31:50,470
overhead so yeah let's read the menu and

653
00:31:47,559 --> 00:31:55,470
also let's look at the code so I did

654
00:31:50,470 --> 00:31:59,110
that and then<font color="#E5E5E5"> I was running into page</font>

655
00:31:55,470 --> 00:32:01,720
1496 of the Arkham fees earned as a

656
00:31:59,110 --> 00:32:04,959
manual and I<font color="#E5E5E5"> found this nice table with</font>

657
00:32:01,720 --> 00:32:07,360
gas maintenance operations and this

658
00:32:04,960 --> 00:32:08,980
instruction<font color="#E5E5E5"> below is the instruction</font>

659
00:32:07,360 --> 00:32:13,030
that I was using in my own

660
00:32:08,980 --> 00:32:16,330
implementation so this one must work MGR

661
00:32:13,030 --> 00:32:20,889
315 says sent this command to compressor

662
00:32:16,330 --> 00:32:22,629
15 air for would be holding the virtual

663
00:32:20,890 --> 00:32:24,850
address or the address<font color="#CCCCCC"> that I wanted</font><font color="#E5E5E5"> to</font>

664
00:32:22,630 --> 00:32:27,070
<font color="#E5E5E5">flush and if you look</font><font color="#CCCCCC"> up the</font><font color="#E5E5E5"> other</font>

665
00:32:24,850 --> 00:32:30,730
values in a stable you will see that i

666
00:32:27,070 --> 00:32:35,049
was<font color="#CCCCCC"> using this this instruction bc</font><font color="#E5E5E5"> i am</font>

667
00:32:30,730 --> 00:32:39,250
VHC data gas invalidate by NBA this is

668
00:32:35,049 --> 00:32:43,629
not<font color="#E5E5E5"> working ok so let's look at how</font>

669
00:32:39,250 --> 00:32:45,340
linux implements is discussed<font color="#E5E5E5"> but it's</font>

670
00:32:43,630 --> 00:32:48,309
actually<font color="#E5E5E5"> the system calls implemented in</font>

671
00:32:45,340 --> 00:32:50,709
the<font color="#CCCCCC"> trap subsea file it calls the two</font>

672
00:32:48,309 --> 00:32:53,168
<font color="#E5E5E5">casts operation function which is</font>

673
00:32:50,710 --> 00:32:56,410
calling flash flash guest user drains

674
00:32:53,169 --> 00:32:59,140
and this is actually implemented with

675
00:32:56,410 --> 00:33:02,260
this function which is<font color="#E5E5E5"> another file and</font>

676
00:32:59,140 --> 00:33:04,059
then you end up with an entry here which

677
00:33:02,260 --> 00:33:06,190
is truly assembly code and the

678
00:33:04,059 --> 00:33:09,190
interesting bits here are 2 MCR

679
00:33:06,190 --> 00:33:12,669
instructions so let's<font color="#CCCCCC"> copy-paste</font><font color="#E5E5E5"> them</font>

680
00:33:09,190 --> 00:33:15,370
and look here where they<font color="#CCCCCC"> map too so they</font>

681
00:33:12,669 --> 00:33:17,380
were mapping to the data cos theta cos

682
00:33:15,370 --> 00:33:22,239
clean by MV and extracting gas

683
00:33:17,380 --> 00:33:24,130
invalidate the NBA and<font color="#E5E5E5"> when we i copy</font>

684
00:33:22,240 --> 00:33:27,130
pasted is this code

685
00:33:24,130 --> 00:33:28,750
implemented in myself and this didn't

686
00:33:27,130 --> 00:33:32,170
work but as soon as<font color="#E5E5E5"> I would change these</font>

687
00:33:28,750 --> 00:33:36,850
operations to use the green one then I

688
00:33:32,170 --> 00:33:39,400
did find a bit Phipps so why is<font color="#E5E5E5"> this the</font>

689
00:33:36,850 --> 00:33:44,439
difference here<font color="#E5E5E5"> between the red bars and</font>

690
00:33:39,400 --> 00:33:48,550
green bar is this fuel pou point of

691
00:33:44,440 --> 00:33:51,220
unification and point of coherence so

692
00:33:48,550 --> 00:33:54,120
anyone here who ever heard of form of

693
00:33:51,220 --> 00:33:56,530
unification versus point of coherence

694
00:33:54,120 --> 00:34:01,800
which is very<font color="#CCCCCC"> good because then I'm</font><font color="#E5E5E5"> not</font>

695
00:33:56,530 --> 00:34:06,040
the only one<font color="#CCCCCC"> riddim soon so did that</font><font color="#E5E5E5"> and</font>

696
00:34:01,800 --> 00:34:08,889
then turns out the come armed this point

697
00:34:06,040 --> 00:34:10,929
of<font color="#E5E5E5"> Karen so we stood up and it is the</font>

698
00:34:08,889 --> 00:34:12,669
point at which all observers are

699
00:34:10,929 --> 00:34:16,240
guaranteed to see the same copy of

700
00:34:12,668 --> 00:34:19,060
indemnification and typically this is

701
00:34:16,239 --> 00:34:23,888
<font color="#CCCCCC">the main external system memory so dear</font>

702
00:34:19,060 --> 00:34:25,600
<font color="#E5E5E5">I'm so fond of unification is one in</font>

703
00:34:23,889 --> 00:34:28,240
<font color="#E5E5E5">your case for course blah blah for</font>

704
00:34:25,600 --> 00:34:33,040
example or unified level<font color="#CCCCCC"> two gas would</font>

705
00:34:28,239 --> 00:34:35,589
be<font color="#E5E5E5"> the point of unification</font><font color="#CCCCCC"> okay so i</font>

706
00:34:33,040 --> 00:34:36,909
was using POC which was working<font color="#CCCCCC"> but as</font>

707
00:34:35,590 --> 00:34:38,290
soon as<font color="#E5E5E5"> you switch to peer you would</font>

708
00:34:36,909 --> 00:34:41,679
stop working so basically what we're

709
00:34:38,290 --> 00:34:45,850
doing<font color="#E5E5E5"> here is if we're going to</font>

710
00:34:41,679 --> 00:34:50,850
invalidate<font color="#E5E5E5"> pou to the pou point of</font>

711
00:34:45,850 --> 00:34:53,949
unification we<font color="#E5E5E5"> fasten the</font><font color="#CCCCCC"> cpu gas and</font>

712
00:34:50,850 --> 00:34:56,500
then we wheeling back from the shared

713
00:34:53,949 --> 00:34:59,200
level 2 cos so we almost flat level one

714
00:34:56,500 --> 00:35:01,030
level two stays the same so the<font color="#E5E5E5"> reads</font>

715
00:34:59,200 --> 00:35:02,740
that we were doing using this technique

716
00:35:01,030 --> 00:35:05,860
they will<font color="#E5E5E5"> not come to the ramp so we all</font>

717
00:35:02,740 --> 00:35:08,950
really indeed not<font color="#E5E5E5"> fitting the bits this</font>

718
00:35:05,860 --> 00:35:12,190
gets loaded back into the<font color="#CCCCCC"> CPU well if</font>

719
00:35:08,950 --> 00:35:14,439
you are available to boc some point of

720
00:35:12,190 --> 00:35:16,990
currencies of course clear now you've<font color="#E5E5E5"> a</font>

721
00:35:14,440 --> 00:35:19,780
<font color="#E5E5E5">cpu cos and then also the l level to</font>

722
00:35:16,990 --> 00:35:23,229
cast is fast and then you read back from

723
00:35:19,780 --> 00:35:28,510
memory back<font color="#CCCCCC"> to the core 0 so back into</font>

724
00:35:23,230 --> 00:35:31,360
l2 and then back to Ella<font color="#CCCCCC"> okay so I've</font>

725
00:35:28,510 --> 00:35:34,810
tried all of this<font color="#E5E5E5"> Gustav their work so</font>

726
00:35:31,360 --> 00:35:36,670
April 26 it was a little bit less than<font color="#CCCCCC"> a</font>

727
00:35:34,810 --> 00:35:39,029
month<font color="#E5E5E5"> before this deadline that we set</font>

728
00:35:36,670 --> 00:35:41,620
to yourself

729
00:35:39,030 --> 00:35:45,520
some bad news right so trying everything

730
00:35:41,620 --> 00:35:48,160
it didn't work what's left is<font color="#E5E5E5"> I so look</font>

731
00:35:45,520 --> 00:35:52,590
at this gadget vixen sets turns out<font color="#E5E5E5"> also</font>

732
00:35:48,160 --> 00:35:55,980
didn't work or DM a direct memory access

733
00:35:52,590 --> 00:35:58,930
the first one doesn't look good either

734
00:35:55,980 --> 00:36:00,580
and actually i was saying we're almost

735
00:35:58,930 --> 00:36:02,230
at<font color="#E5E5E5"> the point because the data</font><font color="#CCCCCC"> of some</font>

736
00:36:00,580 --> 00:36:04,240
coming so close and we really wanted to

737
00:36:02,230 --> 00:36:07,090
<font color="#E5E5E5">write something to submit a paper to</font>

738
00:36:04,240 --> 00:36:09,459
this company we were considering to

739
00:36:07,090 --> 00:36:12,220
write a<font color="#E5E5E5"> paper about why johnny cannot</font>

740
00:36:09,460 --> 00:36:14,230
flip bits on arm because it was really

741
00:36:12,220 --> 00:36:18,970
<font color="#CCCCCC">turn out</font><font color="#E5E5E5"> to be almost impossible to do</font>

742
00:36:14,230 --> 00:36:22,870
this auto martina replied yeah this iron

743
00:36:18,970 --> 00:36:25,330
and the iron might be interesting so it

744
00:36:22,870 --> 00:36:27,370
provides larks physically completes his

745
00:36:25,330 --> 00:36:29,290
buffers<font color="#CCCCCC"> or physical business</font><font color="#E5E5E5"> is good so</font>

746
00:36:27,370 --> 00:36:31,720
we can do<font color="#CCCCCC"> tops for armor you get</font>

747
00:36:29,290 --> 00:36:33,550
allocated for loop space and they have

748
00:36:31,720 --> 00:36:36,339
their own castle policies so it<font color="#E5E5E5"> looks</font>

749
00:36:33,550 --> 00:36:37,810
like everything is there can<font color="#E5E5E5"> you see if</font>

750
00:36:36,340 --> 00:36:42,010
you're one<font color="#CCCCCC"> of the test phones i was</font>

751
00:36:37,810 --> 00:36:45,640
using has is def ion interface yeah<font color="#E5E5E5"> it</font>

752
00:36:42,010 --> 00:36:48,390
was there sounds interesting indeed so

753
00:36:45,640 --> 00:36:55,299
look this so let's<font color="#E5E5E5"> look a</font><font color="#CCCCCC"> little bit at</font>

754
00:36:48,390 --> 00:36:56,980
<font color="#E5E5E5">VMA bypassing the cpu guess so because</font>

755
00:36:55,300 --> 00:37:00,460
<font color="#CCCCCC">this is a really big</font><font color="#E5E5E5"> issue that we're</font>

756
00:36:56,980 --> 00:37:04,960
fighting right sometimes the<font color="#E5E5E5"> cpu caches</font>

757
00:37:00,460 --> 00:37:06,640
are undesired so sometimes you don't

758
00:37:04,960 --> 00:37:09,700
want data to get stored in the soup you

759
00:37:06,640 --> 00:37:13,270
<font color="#E5E5E5">guess for example if we</font><font color="#CCCCCC"> have another</font>

760
00:37:09,700 --> 00:37:14,859
device on your phone for example GPU

761
00:37:13,270 --> 00:37:18,400
could be the audio device would be

762
00:37:14,860 --> 00:37:20,440
anything that's doing operations on<font color="#CCCCCC"> the</font>

763
00:37:18,400 --> 00:37:23,350
memory that the<font color="#E5E5E5"> cpu is also working on</font>

764
00:37:20,440 --> 00:37:25,900
and escenario you don't want data to get

765
00:37:23,350 --> 00:37:28,080
stored in the<font color="#E5E5E5"> cpu gas because then the</font>

766
00:37:25,900 --> 00:37:32,320
<font color="#E5E5E5">cpu we working on something different</font>

767
00:37:28,080 --> 00:37:34,180
older<font color="#CCCCCC"> or newer than the GPU seen so</font>

768
00:37:32,320 --> 00:37:39,970
every operating system must provide a

769
00:37:34,180 --> 00:37:42,970
form of<font color="#CCCCCC"> PM</font><font color="#E5E5E5"> a direct memory access and as</font>

770
00:37:39,970 --> 00:37:46,990
it turns out that these devices for

771
00:37:42,970 --> 00:37:48,759
example GPU might be stupid<font color="#CCCCCC"> and if they</font>

772
00:37:46,990 --> 00:37:50,109
are simple enough they cannot translate

773
00:37:48,760 --> 00:37:53,319
<font color="#E5E5E5">spiritual to fish</font>

774
00:37:50,109 --> 00:37:55,509
<font color="#CCCCCC">for addresses mappings and then</font><font color="#E5E5E5"> this</font>

775
00:37:53,319 --> 00:37:57,819
memory that you're sharing with the

776
00:37:55,509 --> 00:37:59,799
device the main memory has to be

777
00:37:57,819 --> 00:38:02,920
continuous in order for device to work

778
00:37:59,799 --> 00:38:05,920
with it so if you have<font color="#E5E5E5"> this the DA is</font>

779
00:38:02,920 --> 00:38:09,640
very are very much acting like a huge

780
00:38:05,920 --> 00:38:12,880
space that we saw before so I looked at

781
00:38:09,640 --> 00:38:16,210
a tie on did some research<font color="#E5E5E5"> a cop car a</font>

782
00:38:12,880 --> 00:38:17,829
yeah this<font color="#E5E5E5"> I on this might be the place</font>

783
00:38:16,210 --> 00:38:20,559
where we<font color="#E5E5E5"> were we can find flips I</font>

784
00:38:17,829 --> 00:38:23,470
haven't this cannon ion cannon I don't

785
00:38:20,559 --> 00:38:27,489
know but<font color="#CCCCCC"> seriously so the problem now</font>

786
00:38:23,470 --> 00:38:29,109
was<font color="#CCCCCC"> that if we find it slips an iron</font>

787
00:38:27,489 --> 00:38:30,789
then we still<font color="#CCCCCC"> have a lot of work to do</font>

788
00:38:29,109 --> 00:38:33,670
because we also wanted to<font color="#E5E5E5"> do an exploit</font>

789
00:38:30,789 --> 00:38:36,460
and everything before the deadline this

790
00:38:33,670 --> 00:38:38,170
paper so<font color="#E5E5E5"> really we're going to have</font>

791
00:38:36,460 --> 00:38:40,450
issues because also I was there with

792
00:38:38,170 --> 00:38:43,660
family and I had to travel right so

793
00:38:40,450 --> 00:38:46,299
California should see the main

794
00:38:43,660 --> 00:38:48,640
<font color="#E5E5E5">viewpoints are</font><font color="#CCCCCC"> we going to LA for the</font>

795
00:38:46,299 --> 00:38:51,579
some days I had to call San Diego to<font color="#E5E5E5"> San</font>

796
00:38:48,640 --> 00:38:53,319
Francisco foolish on funds I had to make

797
00:38:51,579 --> 00:38:57,999
prostration for that I'd who will

798
00:38:53,319 --> 00:39:00,069
watching it was pretty crazy anyway i

799
00:38:57,999 --> 00:39:03,700
briefly looked at<font color="#E5E5E5"> iron and then one hour</font>

800
00:39:00,069 --> 00:39:08,230
later I said yes here is we can now flip

801
00:39:03,700 --> 00:39:11,710
bit in<font color="#CCCCCC"> Russa space using this I on</font>

802
00:39:08,230 --> 00:39:13,390
memory allocator from<font color="#E5E5E5"> Android</font><font color="#CCCCCC"> okay he</font>

803
00:39:11,710 --> 00:39:15,430
was happy well it is if it's a strategy

804
00:39:13,390 --> 00:39:20,859
no<font color="#E5E5E5"> I was up looking at this Callie it's</font>

805
00:39:15,430 --> 00:39:22,868
DM a couple days<font color="#E5E5E5"> later we had a flash</font>

806
00:39:20,859 --> 00:39:25,450
meeting at the University Santa Barbara

807
00:39:22,869 --> 00:39:30,009
<font color="#CCCCCC">and I was a certain professor who was</font>

808
00:39:25,450 --> 00:39:32,160
saying very enthusiastic<font color="#CCCCCC"> okay so you</font>

809
00:39:30,009 --> 00:39:36,160
found the<font color="#E5E5E5"> right library congratulations</font>

810
00:39:32,160 --> 00:39:38,288
yeah but really it was it was right

811
00:39:36,160 --> 00:39:41,618
because what do we have so far so we we

812
00:39:38,289 --> 00:39:43,150
saw it we can flip bits on arm what we

813
00:39:41,619 --> 00:39:45,190
can do we can analyze a bunch of phones

814
00:39:43,150 --> 00:39:47,650
and I say how vulnerable they are and

815
00:39:45,190 --> 00:39:51,730
then at best we<font color="#CCCCCC"> can poured the google</font>

816
00:39:47,650 --> 00:39:53,289
google protect<font color="#CCCCCC"> zero exploit which yeah</font>

817
00:39:51,730 --> 00:39:55,539
it's fun what is that really

818
00:39:53,289 --> 00:39:57,759
groundbreaking scientific research so

819
00:39:55,539 --> 00:39:59,890
it's only<font color="#E5E5E5"> a port so we need something</font>

820
00:39:57,759 --> 00:40:02,170
<font color="#E5E5E5">better right we don't have memory</font>

821
00:39:59,890 --> 00:40:03,640
dutiful we found that because we<font color="#CCCCCC"> turned</font>

822
00:40:02,170 --> 00:40:06,550
out many devices

823
00:40:03,640 --> 00:40:08,830
memory duplication disabled and n don't

824
00:40:06,550 --> 00:40:13,180
actually disables is the default because

825
00:40:08,830 --> 00:40:16,120
it's too expensive so crystianna from vu

826
00:40:13,180 --> 00:40:18,810
you had a plan to do some kind of

827
00:40:16,120 --> 00:40:22,270
expectation that will be deterministic

828
00:40:18,810 --> 00:40:27,730
and then meeting video meeting<font color="#CCCCCC"> I was</font>

829
00:40:22,270 --> 00:40:29,650
sleeping and<font color="#CCCCCC"> then I got</font><font color="#E5E5E5"> this dude</font><font color="#CCCCCC"> you</font>

830
00:40:27,730 --> 00:40:32,680
screwed we came up with a possible

831
00:40:29,650 --> 00:40:34,120
attack with iron but<font color="#CCCCCC"> Erica so forth so</font>

832
00:40:32,680 --> 00:40:39,040
you can imagine how complicated to God

833
00:40:34,120 --> 00:40:42,190
and this is eric<font color="#CCCCCC"> bossman some reaction</font>

834
00:40:39,040 --> 00:40:44,259
was<font color="#E5E5E5"> no if eric is in then i'm out i'm</font>

835
00:40:42,190 --> 00:40:46,900
over it's over for me<font color="#E5E5E5"> i cannot really</font>

836
00:40:44,260 --> 00:40:48,640
took me<font color="#E5E5E5"> to this guy kept i was saying if</font>

837
00:40:46,900 --> 00:40:51,490
finally you do cool enough stuff for

838
00:40:48,640 --> 00:40:54,069
Eric to come in now when i'm out i'm

839
00:40:51,490 --> 00:40:58,240
going to drink a corona so<font color="#E5E5E5"> i had a</font>

840
00:40:54,070 --> 00:41:02,650
chronic but so this<font color="#E5E5E5"> eric bossman guy is</font>

841
00:40:58,240 --> 00:41:05,020
super smart you get the sick return

842
00:41:02,650 --> 00:41:06,880
oriented programming with one award at

843
00:41:05,020 --> 00:41:10,150
<font color="#E5E5E5">the security and privacy and then later</font>

844
00:41:06,880 --> 00:41:14,800
last year he did memory duplication with

845
00:41:10,150 --> 00:41:20,970
<font color="#E5E5E5">drama to break at which reward him a</font>

846
00:41:14,800 --> 00:41:24,580
pony so really good guy anyway i

847
00:41:20,970 --> 00:41:27,569
received the photo<font color="#E5E5E5"> of what they what</font>

848
00:41:24,580 --> 00:41:30,160
they talked about your next three weeks

849
00:41:27,570 --> 00:41:34,210
next few weeks<font color="#CCCCCC"> so that</font><font color="#E5E5E5"> was looking</font><font color="#CCCCCC"> very</font>

850
00:41:30,160 --> 00:41:37,540
good then we<font color="#E5E5E5"> had a Skype call and it</font>

851
00:41:34,210 --> 00:41:41,110
looked much better anyway this<font color="#E5E5E5"> was the</font>

852
00:41:37,540 --> 00:41:43,230
<font color="#E5E5E5">the attack because i had to implement so</font>

853
00:41:41,110 --> 00:41:46,180
<font color="#E5E5E5">what we have to do with land census data</font>

854
00:41:43,230 --> 00:41:48,310
so let's briefly mention talk about the

855
00:41:46,180 --> 00:41:50,980
threat model so we<font color="#E5E5E5"> have a recent android</font>

856
00:41:48,310 --> 00:41:52,840
operating system no<font color="#E5E5E5"> memory duplication</font>

857
00:41:50,980 --> 00:41:57,340
and we're going<font color="#E5E5E5"> to assume a nonprofit</font>

858
00:41:52,840 --> 00:41:59,410
app they want to get root access the

859
00:41:57,340 --> 00:42:01,270
goal here ultimately<font color="#CCCCCC"> is of course to</font>

860
00:41:59,410 --> 00:42:04,440
read<font color="#E5E5E5"> right to</font><font color="#CCCCCC"> anywhere memory because if</font>

861
00:42:01,270 --> 00:42:07,060
you have that then you can find your own

862
00:42:04,440 --> 00:42:09,700
administrative colonel data structure

863
00:42:07,060 --> 00:42:13,420
and then<font color="#CCCCCC"> overwrite your</font><font color="#E5E5E5"> user ID to get</font>

864
00:42:09,700 --> 00:42:15,850
food the approach so the core of<font color="#E5E5E5"> the</font>

865
00:42:13,420 --> 00:42:16,710
idea was that we're going<font color="#E5E5E5"> to land a page</font>

866
00:42:15,850 --> 00:42:18,060
table

867
00:42:16,710 --> 00:42:21,770
somewhere in memory where we can split a

868
00:42:18,060 --> 00:42:25,250
bit and then<font color="#CCCCCC"> we flip</font><font color="#E5E5E5"> a bit in this entry</font>

869
00:42:21,770 --> 00:42:28,140
<font color="#CCCCCC">okay so a little bit about page tables</font>

870
00:42:25,250 --> 00:42:31,170
based also used<font color="#E5E5E5"> to map beautiful</font>

871
00:42:28,140 --> 00:42:35,029
heiresses to physical<font color="#E5E5E5"> addresses for</font>

872
00:42:31,170 --> 00:42:37,770
example your user space program<font color="#E5E5E5"> has this</font>

873
00:42:35,030 --> 00:42:40,589
buffer allocated and<font color="#E5E5E5"> it's storing hello</font>

874
00:42:37,770 --> 00:42:44,099
world in there and it might<font color="#CCCCCC"> be for some</font>

875
00:42:40,589 --> 00:42:47,970
reason in physical memory hello on world

876
00:42:44,099 --> 00:42:50,180
are stored at this these particular

877
00:42:47,970 --> 00:42:53,490
locations and then you have this mapping

878
00:42:50,180 --> 00:42:56,759
so page table now is nothing else than

879
00:42:53,490 --> 00:42:58,890
just a table with depietro address and

880
00:42:56,760 --> 00:43:02,430
then what physical address belongs to it

881
00:42:58,890 --> 00:43:04,940
<font color="#E5E5E5">I made it easy for you to because I also</font>

882
00:43:02,430 --> 00:43:09,598
edit the binary representation here of

883
00:43:04,940 --> 00:43:14,359
the physical<font color="#E5E5E5"> address now where are these</font>

884
00:43:09,599 --> 00:43:18,570
vegetables port of course also a memory

885
00:43:14,359 --> 00:43:22,020
<font color="#CCCCCC">now what if for example this page table</font>

886
00:43:18,570 --> 00:43:24,410
is stored just<font color="#E5E5E5"> between the buffer that</font>

887
00:43:22,020 --> 00:43:27,180
we have allocated in a new space program

888
00:43:24,410 --> 00:43:29,970
now we can read from these two buffers

889
00:43:27,180 --> 00:43:33,450
and potentially flip a bit in this<font color="#E5E5E5"> page</font>

890
00:43:29,970 --> 00:43:35,759
table entry what happens if you<font color="#E5E5E5"> sleep a</font>

891
00:43:33,450 --> 00:43:39,810
bit in the bezel entry we can modify the

892
00:43:35,760 --> 00:43:42,660
mappings let's look at this example or

893
00:43:39,810 --> 00:43:46,200
you flip this<font color="#CCCCCC"> one bit in the physical</font>

894
00:43:42,660 --> 00:43:48,240
address of a page table this is this

895
00:43:46,200 --> 00:43:52,410
error it was<font color="#CCCCCC"> it</font><font color="#E5E5E5"> was it's pointing to</font>

896
00:43:48,240 --> 00:43:54,390
hello for now by flipping this bit we're

897
00:43:52,410 --> 00:44:01,049
changing the physical address to no

898
00:43:54,390 --> 00:44:04,290
longer be 1400 but to<font color="#E5E5E5"> be 100 and if we</font>

899
00:44:01,050 --> 00:44:06,900
<font color="#CCCCCC">are also updated pointer it will now</font>

900
00:44:04,290 --> 00:44:10,290
point to<font color="#E5E5E5"> the page table so right now we</font>

901
00:44:06,900 --> 00:44:12,300
have a user space program with<font color="#E5E5E5"> a buffer</font>

902
00:44:10,290 --> 00:44:15,779
there was a little<font color="#E5E5E5"> point to hello but</font>

903
00:44:12,300 --> 00:44:18,390
now it's going<font color="#E5E5E5"> to bed level and paid</font>

904
00:44:15,780 --> 00:44:21,240
tables give us readwrite access to

905
00:44:18,390 --> 00:44:23,520
<font color="#E5E5E5">anywhere memory because we can modify</font>

906
00:44:21,240 --> 00:44:27,270
increase so we can<font color="#CCCCCC"> overwrite existing</font>

907
00:44:23,520 --> 00:44:28,970
<font color="#E5E5E5">ones or we can</font><font color="#CCCCCC"> add new ones and then use</font>

908
00:44:27,270 --> 00:44:32,930
that to

909
00:44:28,970 --> 00:44:36,549
access memory so<font color="#E5E5E5"> really the goal is to</font>

910
00:44:32,930 --> 00:44:40,490
<font color="#E5E5E5">get access to your own pizza b-but</font>

911
00:44:36,550 --> 00:44:44,090
question is how do<font color="#E5E5E5"> you get this</font><font color="#CCCCCC"> beta</font>

912
00:44:40,490 --> 00:44:47,689
table stored here and not something here

913
00:44:44,090 --> 00:44:50,210
or<font color="#CCCCCC"> somewhere else</font><font color="#E5E5E5"> in Hamburg and this is</font>

914
00:44:47,690 --> 00:44:53,090
where basically you it was mostly

915
00:44:50,210 --> 00:44:55,520
<font color="#E5E5E5">Cristiano Eric helped a little bit but</font>

916
00:44:53,090 --> 00:45:00,770
it was<font color="#CCCCCC"> mostly personnel who worked out</font>

917
00:44:55,520 --> 00:45:04,640
this this technique that we call fists

918
00:45:00,770 --> 00:45:07,220
as in physical thank you so let's look

919
00:45:04,640 --> 00:45:09,379
<font color="#E5E5E5">at memory in the</font><font color="#CCCCCC"> initial state of the</font>

920
00:45:07,220 --> 00:45:12,589
attack so<font color="#E5E5E5"> with what we will go and</font>

921
00:45:09,380 --> 00:45:13,940
launch the general tech now we have some

922
00:45:12,590 --> 00:45:16,400
allocations some programs<font color="#CCCCCC"> that are</font>

923
00:45:13,940 --> 00:45:19,700
running then the first step is

924
00:45:16,400 --> 00:45:23,599
exhausting large chunks of memory do

925
00:45:19,700 --> 00:45:25,910
that get to those are going to find big

926
00:45:23,599 --> 00:45:29,240
tips we're going<font color="#E5E5E5"> to hammer so a</font>

927
00:45:25,910 --> 00:45:33,230
hammering memory after<font color="#E5E5E5"> all we find</font>

928
00:45:29,240 --> 00:45:36,560
addicted then the second part<font color="#E5E5E5"> of the</font>

929
00:45:33,230 --> 00:45:39,980
exploit is exhausting<font color="#E5E5E5"> Rose so smaller</font>

930
00:45:36,560 --> 00:45:41,810
medium sized chunks of memory and in

931
00:45:39,980 --> 00:45:46,880
this case we have three that we are

932
00:45:41,810 --> 00:45:49,820
going<font color="#E5E5E5"> to allocate step</font><font color="#CCCCCC"> three of the</font>

933
00:45:46,880 --> 00:45:52,780
attack is release the large joke there's

934
00:45:49,820 --> 00:45:55,420
the vulnerable page seen it with visited

935
00:45:52,780 --> 00:45:58,010
so we give it back to the system<font color="#E5E5E5"> and</font>

936
00:45:55,420 --> 00:46:01,760
immediately after that we're going to<font color="#E5E5E5"> a</font>

937
00:45:58,010 --> 00:46:05,720
legate smaller chunks of the size<font color="#CCCCCC"> of</font><font color="#E5E5E5"> the</font>

938
00:46:01,760 --> 00:46:09,619
Roses again and since we just<font color="#E5E5E5"> exhausted</font>

939
00:46:05,720 --> 00:46:13,040
them in the previous step we will now be

940
00:46:09,619 --> 00:46:16,160
sure<font color="#E5E5E5"> that we will get the same chunks</font>

941
00:46:13,040 --> 00:46:19,190
that we just released also<font color="#E5E5E5"> including the</font>

942
00:46:16,160 --> 00:46:23,529
channel that has the bit dip in it so we

943
00:46:19,190 --> 00:46:26,960
exhaust them we get these allocations

944
00:46:23,530 --> 00:46:28,550
next is releasing the vulnerable road so

945
00:46:26,960 --> 00:46:31,670
now we<font color="#CCCCCC"> have more control we can release</font>

946
00:46:28,550 --> 00:46:35,089
one room completely and we're also going

947
00:46:31,670 --> 00:46:38,030
to release large chunks and we do this

948
00:46:35,089 --> 00:46:40,820
because in the<font color="#CCCCCC"> next step we are going to</font>

949
00:46:38,030 --> 00:46:45,470
allocate small terms and we do not<font color="#CCCCCC"> want</font>

950
00:46:40,820 --> 00:46:48,710
the system to get out of memory so the

951
00:46:45,470 --> 00:46:53,660
next<font color="#CCCCCC"> step alligator pages we're going</font><font color="#E5E5E5"> to</font>

952
00:46:48,710 --> 00:46:57,109
allocate pages small pages until we<font color="#E5E5E5"> are</font>

953
00:46:53,660 --> 00:47:02,118
breaking the vulnerable row with a bit

954
00:46:57,109 --> 00:47:04,310
sleep in it into smaller chunks and this

955
00:47:02,119 --> 00:47:07,190
works because the online memory

956
00:47:04,310 --> 00:47:10,339
allocator of<font color="#CCCCCC"> Linux will make sure that</font>

957
00:47:07,190 --> 00:47:13,910
<font color="#CCCCCC">the large chunk in the middle is used</font>

958
00:47:10,339 --> 00:47:15,440
last to make<font color="#E5E5E5"> sure that anybody else</font>

959
00:47:13,910 --> 00:47:19,220
comes<font color="#CCCCCC"> soon I want to go teach this junk</font>

960
00:47:15,440 --> 00:47:22,160
you will get this this one so we just

961
00:47:19,220 --> 00:47:24,319
allocate alkyd until we hit this from

962
00:47:22,160 --> 00:47:27,230
the borough there will<font color="#E5E5E5"> be some bedding</font>

963
00:47:24,320 --> 00:47:30,200
so the more<font color="#E5E5E5"> some more small page table</font>

964
00:47:27,230 --> 00:47:32,630
<font color="#CCCCCC">top page allocations and then in the</font>

965
00:47:30,200 --> 00:47:35,060
last step we go to map a page table so

966
00:47:32,630 --> 00:47:39,410
you can do this with<font color="#E5E5E5"> bad fix and get a</font>

967
00:47:35,060 --> 00:47:42,500
page table on exactly this location for

968
00:47:39,410 --> 00:47:46,220
their arm we used the<font color="#CCCCCC"> trick I described</font>

969
00:47:42,500 --> 00:47:51,280
for two robbers little bit and get root

970
00:47:46,220 --> 00:47:53,930
access so I was working on this<font color="#CCCCCC"> mid-may</font>

971
00:47:51,280 --> 00:47:56,450
dumb question<font color="#CCCCCC"> yeah I</font><font color="#E5E5E5"> don't mean no as</font>

972
00:47:53,930 --> 00:47:59,330
how we're going to take this all of this

973
00:47:56,450 --> 00:48:02,779
might<font color="#E5E5E5"> be the last missing piece so what</font>

974
00:47:59,330 --> 00:48:04,580
do you mean to explain in my issues for

975
00:48:02,780 --> 00:48:06,890
few minutes late reply<font color="#E5E5E5"> us yeah super</font>

976
00:48:04,580 --> 00:48:09,859
cool by<font color="#E5E5E5"> the way are you around tomorrow</font>

977
00:48:06,890 --> 00:48:11,560
I can drive<font color="#E5E5E5"> to Santa Barbara so turns</font>

978
00:48:09,859 --> 00:48:14,960
out he was actually<font color="#CCCCCC"> in California's row</font>

979
00:48:11,560 --> 00:48:17,900
so<font color="#CCCCCC"> it took a car and drove to the bar</font>

980
00:48:14,960 --> 00:48:21,500
<font color="#E5E5E5">rack and we had a very long depth was a</font>

981
00:48:17,900 --> 00:48:24,109
very very productive day actually and

982
00:48:21,500 --> 00:48:25,490
this was the entrance hope and after

983
00:48:24,109 --> 00:48:27,529
this we knew<font color="#CCCCCC"> that it was going</font><font color="#E5E5E5"> to work</font>

984
00:48:25,490 --> 00:48:29,569
we had all the building blocks so we

985
00:48:27,530 --> 00:48:31,490
could continue writing the paper one

986
00:48:29,570 --> 00:48:34,250
thing<font color="#E5E5E5"> that was remaining in the last six</font>

987
00:48:31,490 --> 00:48:37,640
days was doing evaluation so I've got a

988
00:48:34,250 --> 00:48:41,180
bunch of phones from the<font color="#CCCCCC"> lab I had a</font>

989
00:48:37,640 --> 00:48:44,150
very professional setup when I was

990
00:48:41,180 --> 00:48:48,230
hammering all the phones and we

991
00:48:44,150 --> 00:48:49,819
evaluated this so interesting enough we

992
00:48:48,230 --> 00:48:52,069
<font color="#CCCCCC">found that</font><font color="#E5E5E5"> sometimes one of</font>

993
00:48:49,819 --> 00:48:54,589
next five phones would have zero bit

994
00:48:52,069 --> 00:48:58,009
lips while if you look at another nexus

995
00:48:54,589 --> 00:48:59,930
5 we would actually<font color="#E5E5E5"> see close to a</font>

996
00:48:58,009 --> 00:49:02,449
million<font color="#CCCCCC"> visits so it's the same hardware</font>

997
00:48:59,930 --> 00:49:04,339
but still one device is no bit such a

998
00:49:02,449 --> 00:49:07,609
tall in<font color="#CCCCCC"> the other one and it's</font><font color="#E5E5E5"> really a</font>

999
00:49:04,339 --> 00:49:09,890
lot sometimes because that every not

1000
00:49:07,609 --> 00:49:11,449
every bit step is exploitable sometimes

1001
00:49:09,890 --> 00:49:14,170
you find the first bits lip after one

1002
00:49:11,449 --> 00:49:16,630
second sometimes it takes us 15 minutes

1003
00:49:14,170 --> 00:49:19,039
<font color="#E5E5E5">before we get the first exportable busy</font>

1004
00:49:16,630 --> 00:49:20,839
with some more measurements and you

1005
00:49:19,039 --> 00:49:23,989
found<font color="#E5E5E5"> that once we have this first bits</font>

1006
00:49:20,839 --> 00:49:28,880
lip we can do the entire the rest of the

1007
00:49:23,989 --> 00:49:30,709
expectation<font color="#E5E5E5"> in 22 seconds at most so</font>

1008
00:49:28,880 --> 00:49:33,949
<font color="#E5E5E5">last few days I was wrapping up riding</font>

1009
00:49:30,709 --> 00:49:37,879
with violation spent the time spent some

1010
00:49:33,949 --> 00:49:39,589
time with the family searching for

1011
00:49:37,880 --> 00:49:43,430
another side channel to get all of his

1012
00:49:39,589 --> 00:49:45,920
work then I was the<font color="#E5E5E5"> scooted privacy</font>

1013
00:49:43,430 --> 00:49:49,839
conference let's do paper writing and we

1014
00:49:45,920 --> 00:49:53,449
submitted in time and<font color="#CCCCCC"> we've</font><font color="#E5E5E5"> got accepted</font>

1015
00:49:49,839 --> 00:49:56,660
after<font color="#E5E5E5"> this when I got back in Amsterdam</font>

1016
00:49:53,449 --> 00:49:59,390
I still to finish<font color="#E5E5E5"> the exploit right so I</font>

1017
00:49:56,660 --> 00:50:02,328
I knew<font color="#E5E5E5"> it was going to work with all the</font>

1018
00:49:59,390 --> 00:50:04,759
building works but we<font color="#E5E5E5"> didn't have a</font>

1019
00:50:02,329 --> 00:50:08,569
proof of<font color="#E5E5E5"> concept so I worked on that and</font>

1020
00:50:04,759 --> 00:50:12,769
also after we had exploit finished we

1021
00:50:08,569 --> 00:50:15,229
had to disclose this<font color="#E5E5E5"> to google so when I</font>

1022
00:50:12,769 --> 00:50:18,529
was lying the exploit I was mean looking

1023
00:50:15,229 --> 00:50:21,529
at screens like this and i'm very<font color="#E5E5E5"> lazy</font>

1024
00:50:18,529 --> 00:50:24,709
so would spot the pit slip by just

1025
00:50:21,529 --> 00:50:31,969
looking at the screen and then there<font color="#CCCCCC"> is</font>

1026
00:50:24,709 --> 00:50:35,359
<font color="#E5E5E5">a</font><font color="#CCCCCC"> tea yeah</font><font color="#E5E5E5"> really anyway after the book</font>

1027
00:50:31,969 --> 00:50:37,609
was finished we<font color="#E5E5E5"> contacted google and we</font>

1028
00:50:35,359 --> 00:50:40,699
<font color="#E5E5E5">send them a list of medications that we</font>

1029
00:50:37,609 --> 00:50:45,049
think would be appropriate to stop this

1030
00:50:40,699 --> 00:50:47,150
kind of attack we<font color="#CCCCCC"> contacted them on july</font>

1031
00:50:45,049 --> 00:50:50,239
25<font color="#CCCCCC"> flower is dating</font><font color="#E5E5E5"> portland is</font>

1032
00:50:47,150 --> 00:50:52,759
supporting because it was 91 days before

1033
00:50:50,239 --> 00:50:57,469
ccs before you would actually present

1034
00:50:52,759 --> 00:51:00,049
our work and google project zero if they

1035
00:50:57,469 --> 00:51:02,479
find a bug in a Google product that will

1036
00:51:00,049 --> 00:51:05,859
get google mining days to fix it so we

1037
00:51:02,479 --> 00:51:08,598
were very<font color="#E5E5E5"> much on time without report</font>

1038
00:51:05,859 --> 00:51:10,400
nevertheless at some point we had a

1039
00:51:08,599 --> 00:51:12,890
<font color="#E5E5E5">video call with them and then they asked</font>

1040
00:51:10,400 --> 00:51:15,680
us yeah can you may be<font color="#E5E5E5"> published at</font>

1041
00:51:12,890 --> 00:51:18,589
another venue later this year now we're

1042
00:51:15,680 --> 00:51:21,440
going<font color="#E5E5E5"> to do this because we need papers</font>

1043
00:51:18,589 --> 00:51:23,930
right and then yeah<font color="#CCCCCC"> what if we give you</font>

1044
00:51:21,440 --> 00:51:26,749
<font color="#E5E5E5">some money in return what do we support</font>

1045
00:51:23,930 --> 00:51:31,069
you financially can we then maybe delay

1046
00:51:26,749 --> 00:51:33,558
publication still no okay<font color="#E5E5E5"> then maybe can</font>

1047
00:51:31,069 --> 00:51:35,839
you obfuscate some parsley paper so that

1048
00:51:33,559 --> 00:51:38,930
becomes harder for the expert to

1049
00:51:35,839 --> 00:51:41,089
implement your attack again we didn't do

1050
00:51:38,930 --> 00:51:42,769
it so ultimately<font color="#E5E5E5"> we will reward that the</font>

1051
00:51:41,089 --> 00:51:47,150
massive<font color="#CCCCCC"> amount of four thousand dollars</font>

1052
00:51:42,769 --> 00:51:50,149
for this attack<font color="#E5E5E5"> november they already</font>

1053
00:51:47,150 --> 00:51:52,309
published some updates that would stop

1054
00:51:50,150 --> 00:51:53,599
the deck and then they said we will

1055
00:51:52,309 --> 00:51:55,699
continue<font color="#E5E5E5"> working on a</font><font color="#CCCCCC"> longer-term</font>

1056
00:51:53,599 --> 00:51:58,900
<font color="#CCCCCC">solution</font><font color="#E5E5E5"> i think this</font><font color="#CCCCCC"> is current put in</font>

1057
00:51:55,699 --> 00:52:02,479
place already so you should all be<font color="#CCCCCC"> safe</font>

1058
00:51:58,900 --> 00:52:06,469
assuming your vendor<font color="#CCCCCC"> that pushes these</font>

1059
00:52:02,479 --> 00:52:10,129
updates as well anyway its contribution

1060
00:52:06,469 --> 00:52:13,459
so now what right so with<font color="#CCCCCC"> remer we sort</font>

1061
00:52:10,130 --> 00:52:17,509
of completed the three steps of

1062
00:52:13,459 --> 00:52:20,390
exploitation vectors so we can exploit

1063
00:52:17,509 --> 00:52:22,279
the cloud withdraw<font color="#E5E5E5"> hammer we can exploit</font>

1064
00:52:20,390 --> 00:52:24,739
the browser or the desktop environment

1065
00:52:22,279 --> 00:52:28,759
and now we're also exploring the mobile

1066
00:52:24,739 --> 00:52:31,579
phone so far we have<font color="#E5E5E5"> seen bits lips on</font>

1067
00:52:28,759 --> 00:52:34,249
<font color="#CCCCCC">Peter</font><font color="#E5E5E5"> two three four modules but also</font>

1068
00:52:31,579 --> 00:52:36,380
<font color="#E5E5E5">low power ddr two three or</font><font color="#CCCCCC"> four modules</font>

1069
00:52:34,249 --> 00:52:39,769
the the chips that are used in your

1070
00:52:36,380 --> 00:52:41,900
<font color="#E5E5E5">mobile device and with thermal we show</font>

1071
00:52:39,769 --> 00:52:43,968
that you don't need memory deal

1072
00:52:41,900 --> 00:52:46,039
application to do these<font color="#E5E5E5"> kinds of normal</font>

1073
00:52:43,969 --> 00:52:48,709
attacks you can do it with God without

1074
00:52:46,039 --> 00:52:51,979
custom<font color="#E5E5E5"> opening speeches to just reliant</font>

1075
00:52:48,709 --> 00:52:55,669
on the on how the<font color="#CCCCCC"> the operating system</font>

1076
00:52:51,979 --> 00:52:57,379
<font color="#CCCCCC">itself is supposed to work what is</font>

1077
00:52:55,670 --> 00:53:00,049
important to understand is<font color="#E5E5E5"> that software</font>

1078
00:52:57,380 --> 00:53:03,440
really was never<font color="#E5E5E5"> designed to deal with</font>

1079
00:53:00,049 --> 00:53:06,949
raw halibut<font color="#E5E5E5"> sips proposed defenses so</font>

1080
00:53:03,440 --> 00:53:08,069
far they are<font color="#E5E5E5"> still in early stages or is</font>

1081
00:53:06,949 --> 00:53:11,969
<font color="#E5E5E5">the bypass</font>

1082
00:53:08,069 --> 00:53:15,029
and never even even hard ramifications

1083
00:53:11,969 --> 00:53:18,959
that have been out so far are currently

1084
00:53:15,029 --> 00:53:21,719
still optional so it sees upload the trr

1085
00:53:18,959 --> 00:53:23,489
target progress is optional and we see

1086
00:53:21,719 --> 00:53:27,569
that model then there's are not<font color="#E5E5E5"> very</font>

1087
00:53:23,489 --> 00:53:29,729
<font color="#CCCCCC">keen of adding these medications to the</font>

1088
00:53:27,569 --> 00:53:32,400
hardware because<font color="#E5E5E5"> it will drain the</font>

1089
00:53:29,729 --> 00:53:34,468
<font color="#E5E5E5">battery faster so it's really a tough</font>

1090
00:53:32,400 --> 00:53:37,349
problem and then<font color="#E5E5E5"> finally you cannot fix</font>

1091
00:53:34,469 --> 00:53:39,539
<font color="#CCCCCC">vollmer so if you have a if you have a</font>

1092
00:53:37,349 --> 00:53:42,479
<font color="#CCCCCC">diva module that is vulnerable you</font>

1093
00:53:39,539 --> 00:53:45,239
cannot open your phone and get out the

1094
00:53:42,479 --> 00:53:47,578
<font color="#CCCCCC">DRAM chip solve it a little bit</font><font color="#E5E5E5"> and then</font>

1095
00:53:45,239 --> 00:53:50,069
somehow fix it and then<font color="#CCCCCC"> put it all back</font>

1096
00:53:47,579 --> 00:53:53,819
together so there's really no fix for

1097
00:53:50,069 --> 00:53:56,489
this and this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> why I</font><font color="#E5E5E5"> think we do more</font>

1098
00:53:53,819 --> 00:53:58,680
research on this and try to come up with

1099
00:53:56,489 --> 00:54:02,400
very good ways<font color="#CCCCCC"> to actually stop these</font>

1100
00:53:58,680 --> 00:54:04,308
kind of attacks so that's all you can

1101
00:54:02,400 --> 00:54:07,559
<font color="#E5E5E5">find more details about the project on</font>

1102
00:54:04,309 --> 00:54:10,440
<font color="#CCCCCC">our webpage you can</font><font color="#E5E5E5"> also find a test app</font>

1103
00:54:07,559 --> 00:54:12,180
that you can install if you trust<font color="#E5E5E5"> fool</font>

1104
00:54:10,440 --> 00:54:14,279
enough<font color="#E5E5E5"> you can run this on your phone</font>

1105
00:54:12,180 --> 00:54:16,919
and then<font color="#CCCCCC"> figure</font><font color="#E5E5E5"> out if your device is</font>

1106
00:54:14,279 --> 00:54:20,880
vulnerable<font color="#E5E5E5"> I also open source some</font>

1107
00:54:16,920 --> 00:54:23,130
policy code on get up to go that allows

1108
00:54:20,880 --> 00:54:24,859
you<font color="#E5E5E5"> to search for</font><font color="#CCCCCC"> bits lips and of</font>

1109
00:54:23,130 --> 00:54:28,459
course you can follow me on<font color="#E5E5E5"> Twitter so</font>

1110
00:54:24,859 --> 00:54:28,459
that's it thank

1111
00:54:29,060 --> 00:54:32,659
[Applause]

1112
00:54:32,790 --> 00:54:40,680
thank you very much Victor we have time

1113
00:54:35,290 --> 00:54:40,680
<font color="#CCCCCC">for a few questions if you</font><font color="#E5E5E5"> like anyone</font>

1114
00:54:41,010 --> 00:54:54,100
<font color="#CCCCCC">yep thank you</font><font color="#E5E5E5"> for your talk I've got one</font>

1115
00:54:51,910 --> 00:54:58,210
question you say<font color="#E5E5E5"> row</font><font color="#CCCCCC"> i'm i can not be</font>

1116
00:54:54,100 --> 00:55:03,240
<font color="#E5E5E5">stopped it's not my problem what did</font>

1117
00:54:58,210 --> 00:55:06,910
people do to prevent it ah good<font color="#E5E5E5"> question</font>

1118
00:55:03,240 --> 00:55:09,209
<font color="#E5E5E5">google stop this by so if you know a</font>

1119
00:55:06,910 --> 00:55:11,560
little bit<font color="#E5E5E5"> about how I unallocated works</font>

1120
00:55:09,210 --> 00:55:13,360
basically there are difference heaps

1121
00:55:11,560 --> 00:55:15,610
that<font color="#CCCCCC"> you can allocate</font><font color="#E5E5E5"> memory foam and</font>

1122
00:55:13,360 --> 00:55:17,530
there's one special heat that's called

1123
00:55:15,610 --> 00:55:20,320
the contagious heap and this gives you

1124
00:55:17,530 --> 00:55:22,930
competed memory so it's there to support

1125
00:55:20,320 --> 00:55:25,420
these devices that are really simple<font color="#E5E5E5"> and</font>

1126
00:55:22,930 --> 00:55:29,470
do not know how to<font color="#E5E5E5"> work with these</font>

1127
00:55:25,420 --> 00:55:32,050
mappings turned out that<font color="#E5E5E5"> as i'm correct</font>

1128
00:55:29,470 --> 00:55:34,390
<font color="#E5E5E5">qualcomm so the main supplier of the</font>

1129
00:55:32,050 --> 00:55:35,770
<font color="#E5E5E5">android phones these days is not using</font>

1130
00:55:34,390 --> 00:55:39,850
this computer sheep so it was very easy

1131
00:55:35,770 --> 00:55:43,120
for them to just disable this so now you

1132
00:55:39,850 --> 00:55:45,700
no longer can get contagious memory it's

1133
00:55:43,120 --> 00:55:54,310
complicated<font color="#CCCCCC"> the attack yeah should still</font>

1134
00:55:45,700 --> 00:55:55,750
be<font color="#CCCCCC"> possible to pull it up</font><font color="#E5E5E5"> but yeah thank</font>

1135
00:55:54,310 --> 00:55:58,930
<font color="#E5E5E5">you for the talk really interesting are</font>

1136
00:55:55,750 --> 00:56:03,250
you had one flight where the one nexus 5

1137
00:55:58,930 --> 00:56:04,779
had no it flips do you know why this is

1138
00:56:03,250 --> 00:56:07,990
<font color="#CCCCCC">the case is like different hardware</font>

1139
00:56:04,780 --> 00:56:09,520
manufacturer or this one yeah this one

1140
00:56:07,990 --> 00:56:14,350
exactly<font color="#CCCCCC"> yeah yeah good question i don't</font>

1141
00:56:09,520 --> 00:56:16,900
<font color="#CCCCCC">know it could be that this very issue is</font>

1142
00:56:14,350 --> 00:56:18,910
<font color="#CCCCCC">their bets right</font><font color="#E5E5E5"> so it could be</font><font color="#CCCCCC"> a bet so</font>

1143
00:56:16,900 --> 00:56:22,270
few graham tips that might be might<font color="#CCCCCC"> be</font>

1144
00:56:18,910 --> 00:56:24,100
not so good the<font color="#E5E5E5"> other ones could also be</font>

1145
00:56:22,270 --> 00:56:26,440
that there are some kind of wearing

1146
00:56:24,100 --> 00:56:28,420
effect so maybe if<font color="#E5E5E5"> you use default more</font>

1147
00:56:26,440 --> 00:56:30,430
and more<font color="#CCCCCC"> of client</font><font color="#E5E5E5"> okay it gets more</font>

1148
00:56:28,420 --> 00:56:32,650
likely to flip<font color="#CCCCCC"> it but we</font><font color="#E5E5E5"> don't really</font>

1149
00:56:30,430 --> 00:56:34,720
know so<font color="#CCCCCC"> actually we should</font><font color="#E5E5E5"> actually open</font>

1150
00:56:32,650 --> 00:56:36,280
these phones at some point and<font color="#E5E5E5"> i'll look</font>

1151
00:56:34,720 --> 00:56:37,959
at the sea level<font color="#E5E5E5"> be really interesting</font>

1152
00:56:36,280 --> 00:56:39,730
because i could mean if just some

1153
00:56:37,960 --> 00:56:41,800
manufacturers that can produce better

1154
00:56:39,730 --> 00:56:43,910
arm or whatever yep and why not use

1155
00:56:41,800 --> 00:56:50,690
these right yeah yes

1156
00:56:43,910 --> 00:56:53,560
I need any more questions no but thank

1157
00:56:50,690 --> 00:56:57,360
you very much Victor

1158
00:56:53,560 --> 00:56:57,360
[Applause]

