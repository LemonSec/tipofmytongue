1
00:00:12,010 --> 00:00:20,170
so we're going<font color="#E5E5E5"> to try</font><font color="#CCCCCC"> and present some</font>

2
00:00:14,770 --> 00:00:24,790
research done at the tue with the spice

3
00:00:20,170 --> 00:00:27,580
well research which is basically a thing

4
00:00:24,790 --> 00:00:32,019
<font color="#CCCCCC">that the tea we</font><font color="#E5E5E5"> organize and we're</font>

5
00:00:27,580 --> 00:00:38,470
students from the<font color="#E5E5E5"> true masters in</font>

6
00:00:32,020 --> 00:00:40,809
<font color="#CCCCCC">cybersecurity and next slide</font><font color="#E5E5E5"> please so</font>

7
00:00:38,470 --> 00:00:43,690
hopefully<font color="#E5E5E5"> you guys are a little bit</font>

8
00:00:40,809 --> 00:00:46,300
aware of what<font color="#E5E5E5"> run somewhere is but if</font>

9
00:00:43,690 --> 00:00:49,000
<font color="#E5E5E5">not here's a quick little grievance</font>

10
00:00:46,300 --> 00:00:52,780
reduction so ransomware is basically

11
00:00:49,000 --> 00:00:56,470
some malicious software that is trying

12
00:00:52,780 --> 00:01:00,280
to take the files of<font color="#E5E5E5"> a user as a hostage</font>

13
00:00:56,470 --> 00:01:03,930
and then a user can try and<font color="#E5E5E5"> get back</font>

14
00:01:00,280 --> 00:01:06,070
their files by paying some ransom

15
00:01:03,930 --> 00:01:08,049
oftentimes<font color="#E5E5E5"> this is done through</font>

16
00:01:06,070 --> 00:01:10,539
something anonymous such as with going

17
00:01:08,049 --> 00:01:15,960
on stuff like that and the most common

18
00:01:10,540 --> 00:01:20,020
one uses encryption to basically do this

19
00:01:15,960 --> 00:01:24,009
and<font color="#E5E5E5"> also it tries</font><font color="#CCCCCC"> to do</font><font color="#E5E5E5"> this as fast as</font>

20
00:01:20,020 --> 00:01:26,619
<font color="#CCCCCC">possible it's just kind of a major thing</font>

21
00:01:24,010 --> 00:01:28,450
of our solution as well as that<font color="#E5E5E5"> it tries</font>

22
00:01:26,620 --> 00:01:30,460
to<font color="#E5E5E5"> do it so fast as possible and it's</font>

23
00:01:28,450 --> 00:01:36,840
also kind of the modus operandi of

24
00:01:30,460 --> 00:01:40,509
ransomware can I get the next slide so

25
00:01:36,840 --> 00:01:44,590
this is<font color="#E5E5E5"> basically something that a</font><font color="#CCCCCC"> lot</font>

26
00:01:40,510 --> 00:01:46,810
of companies know what this is<font color="#E5E5E5"> a basic</font>

27
00:01:44,590 --> 00:01:50,620
computer interface with some samba

28
00:01:46,810 --> 00:01:54,360
shares and the<font color="#CCCCCC"> Samba shares usually hold</font>

29
00:01:50,620 --> 00:01:54,360
some sort of information

30
00:01:59,409 --> 00:02:08,060
that's<font color="#E5E5E5"> all right so yeah so much here so</font>

31
00:02:05,659 --> 00:02:09,860
a lot of<font color="#E5E5E5"> people should know and probably</font>

32
00:02:08,060 --> 00:02:11,690
know what these<font color="#CCCCCC"> are and a lot of</font>

33
00:02:09,860 --> 00:02:17,480
important information is stored on<font color="#E5E5E5"> these</font>

34
00:02:11,690 --> 00:02:20,180
and<font color="#CCCCCC"> you expect</font><font color="#E5E5E5"> them to be backed up but</font>

35
00:02:17,480 --> 00:02:22,399
<font color="#E5E5E5">what if that's not the case or for</font>

36
00:02:20,180 --> 00:02:24,019
instance your backup failed or whatever

37
00:02:22,400 --> 00:02:27,459
something went wrong like technical

38
00:02:24,019 --> 00:02:30,709
issues happen like you've seen today and

39
00:02:27,459 --> 00:02:32,540
so we thought well maybe we can<font color="#E5E5E5"> make</font>

40
00:02:30,709 --> 00:02:35,000
something that is like a passive

41
00:02:32,540 --> 00:02:36,798
listener and could perhaps step in once

42
00:02:35,000 --> 00:02:41,450
ransomware attacks these targets because

43
00:02:36,799 --> 00:02:44,900
they are really crucial resources that

44
00:02:41,450 --> 00:02:47,359
ransomware good attack and it's<font color="#CCCCCC"> possible</font>

45
00:02:44,900 --> 00:02:51,430
<font color="#CCCCCC">that they actually already</font><font color="#E5E5E5"> attack these</font>

46
00:02:47,360 --> 00:02:56,390
because we've seen these cases happening

47
00:02:51,430 --> 00:02:58,280
can I get<font color="#E5E5E5"> the next slide so this</font><font color="#CCCCCC"> is just</font>

48
00:02:56,390 --> 00:03:00,619
a simple example where one hosts and

49
00:02:58,280 --> 00:03:03,290
some stuff<font color="#CCCCCC"> to another hose through</font><font color="#E5E5E5"> SMB</font>

50
00:03:00,620 --> 00:03:08,660
packages nothing<font color="#CCCCCC"> really going</font><font color="#E5E5E5"> on here</font>

51
00:03:03,290 --> 00:03:10,608
and now something<font color="#E5E5E5"> else is going</font><font color="#CCCCCC"> on and</font>

52
00:03:08,660 --> 00:03:13,130
I've marked some packages in red and

53
00:03:10,609 --> 00:03:16,670
these indicate some encryption going on

54
00:03:13,130 --> 00:03:18,680
and still this<font color="#CCCCCC"> is not a big issue</font>

55
00:03:16,670 --> 00:03:20,328
because<font color="#E5E5E5"> encryption happens because it's</font>

56
00:03:18,680 --> 00:03:24,079
a useful tool to secure some of your

57
00:03:20,329 --> 00:03:26,120
files but what<font color="#E5E5E5"> if something like a</font>

58
00:03:24,079 --> 00:03:28,069
network where you have a samba share and

59
00:03:26,120 --> 00:03:29,900
a lot of hosts and some people<font color="#E5E5E5"> are</font>

60
00:03:28,069 --> 00:03:31,790
sending some encrypted information and

61
00:03:29,900 --> 00:03:33,650
it's all fine and dandy but what if

62
00:03:31,790 --> 00:03:37,069
there is one actor that<font color="#E5E5E5"> actually sends a</font>

63
00:03:33,650 --> 00:03:44,510
lot of encrypted data and this<font color="#E5E5E5"> could</font>

64
00:03:37,069 --> 00:03:46,339
<font color="#E5E5E5">still be fine but in theory it could be</font>

65
00:03:44,510 --> 00:03:50,019
fine but in the most cases this is

66
00:03:46,340 --> 00:03:54,739
<font color="#E5E5E5">actually a problem for us mostly</font><font color="#CCCCCC"> because</font>

67
00:03:50,019 --> 00:03:57,680
<font color="#E5E5E5">we expect this ransomware to display</font><font color="#CCCCCC"> the</font>

68
00:03:54,739 --> 00:04:01,099
sort<font color="#E5E5E5"> of behavior of mass encrypting</font>

69
00:03:57,680 --> 00:04:03,010
stuff and so we figured while we can

70
00:04:01,099 --> 00:04:07,728
make some sort<font color="#E5E5E5"> of system that can detect</font>

71
00:04:03,010 --> 00:04:10,630
mass encryption and to do this we<font color="#CCCCCC"> built</font>

72
00:04:07,729 --> 00:04:10,630
<font color="#E5E5E5">some exchanges</font>

73
00:04:10,660 --> 00:04:16,390
<font color="#CCCCCC">based on the message features that we</font>

74
00:04:12,370 --> 00:04:18,850
extract from the SMB data and then we

75
00:04:16,390 --> 00:04:22,150
try<font color="#CCCCCC"> and</font><font color="#E5E5E5"> figure out whether these</font><font color="#CCCCCC"> in</font>

76
00:04:18,850 --> 00:04:26,160
exchanges are encrypted and if they are

77
00:04:22,150 --> 00:04:29,830
then well we can<font color="#CCCCCC"> actually say well okay</font>

78
00:04:26,160 --> 00:04:31,330
encryption<font color="#CCCCCC"> is all fine but is this is</font>

79
00:04:29,830 --> 00:04:32,950
the<font color="#CCCCCC"> behavior that</font><font color="#E5E5E5"> the traffic is</font>

80
00:04:31,330 --> 00:04:35,680
displaying is it<font color="#CCCCCC"> actually a user</font>

81
00:04:32,950 --> 00:04:41,979
encrypting some stuff or<font color="#CCCCCC"> is</font><font color="#E5E5E5"> it for</font>

82
00:04:35,680 --> 00:04:44,950
instance ransomware so here is<font color="#CCCCCC"> our first</font>

83
00:04:41,980 --> 00:04:49,830
first step we get some network traffic

84
00:04:44,950 --> 00:04:52,599
we<font color="#E5E5E5"> parse it</font><font color="#CCCCCC"> through we as in be parted</font>

85
00:04:49,830 --> 00:04:56,950
and we extract some message features and

86
00:04:52,600 --> 00:05:02,070
these features are used to build

87
00:04:56,950 --> 00:05:07,270
exchanges and also to detect encryption

88
00:05:02,070 --> 00:05:10,900
and these exchanges are basically

89
00:05:07,270 --> 00:05:15,330
multiple as<font color="#CCCCCC"> and</font><font color="#E5E5E5"> B messages that we link</font>

90
00:05:10,900 --> 00:05:17,890
up through message identifiers and

91
00:05:15,330 --> 00:05:20,979
here's this really simple<font color="#E5E5E5"> and why we</font>

92
00:05:17,890 --> 00:05:22,479
create or open a file and then someone

93
00:05:20,980 --> 00:05:25,510
tries to<font color="#E5E5E5"> read some stuff and then it</font>

94
00:05:22,480 --> 00:05:28,360
also writes back this is a kind<font color="#E5E5E5"> of</font>

95
00:05:25,510 --> 00:05:30,490
normal when you are working<font color="#E5E5E5"> on some</font>

96
00:05:28,360 --> 00:05:34,450
files but we often notice that

97
00:05:30,490 --> 00:05:36,730
ransomware often read a file and<font color="#E5E5E5"> then</font>

98
00:05:34,450 --> 00:05:38,740
actually<font color="#E5E5E5"> use another process to write to</font>

99
00:05:36,730 --> 00:05:40,750
the file and this is hard<font color="#E5E5E5"> to link up</font>

100
00:05:38,740 --> 00:05:44,010
because it's different processes doing

101
00:05:40,750 --> 00:05:47,800
this and so we had to build some file

102
00:05:44,010 --> 00:05:49,690
pattern detection system that actually

103
00:05:47,800 --> 00:05:51,010
looked at the file identifiers and

104
00:05:49,690 --> 00:05:53,530
looked at the actors that are actually

105
00:05:51,010 --> 00:05:55,539
<font color="#E5E5E5">working on the files and this way</font><font color="#CCCCCC"> we</font>

106
00:05:53,530 --> 00:05:59,200
could<font color="#E5E5E5"> build some exchanges that actually</font>

107
00:05:55,540 --> 00:06:01,180
just are sort of<font color="#CCCCCC"> like a history of all</font>

108
00:05:59,200 --> 00:06:06,520
the file manipulations on a single file

109
00:06:01,180 --> 00:06:08,590
by a single actor so now that<font color="#CCCCCC"> we have</font>

110
00:06:06,520 --> 00:06:11,979
these exchanges we actually have to try

111
00:06:08,590 --> 00:06:15,219
<font color="#E5E5E5">and detect encryption and we do this</font>

112
00:06:11,980 --> 00:06:18,940
using entropy which can be done on<font color="#CCCCCC"> the</font>

113
00:06:15,220 --> 00:06:20,860
file data and what actually<font color="#CCCCCC"> entropy</font>

114
00:06:18,940 --> 00:06:23,000
means is something that far as well

115
00:06:20,860 --> 00:06:28,880
explain yeah

116
00:06:23,000 --> 00:06:30,620
they sound yes<font color="#E5E5E5"> thanks yeah so on the</font>

117
00:06:28,880 --> 00:06:34,010
file system don't<font color="#E5E5E5"> build the exchanges</font>

118
00:06:30,620 --> 00:06:36,200
for us which means that we can consume

119
00:06:34,010 --> 00:06:39,110
manipulation of<font color="#CCCCCC"> the files and we're</font>

120
00:06:36,200 --> 00:06:41,780
<font color="#CCCCCC">looking for encryption now if</font><font color="#E5E5E5"> I have two</font>

121
00:06:39,110 --> 00:06:45,110
example files here the one<font color="#CCCCCC"> on</font><font color="#E5E5E5"> the right</font>

122
00:06:41,780 --> 00:06:47,119
or your last story has a regular<font color="#CCCCCC"> pattern</font>

123
00:06:45,110 --> 00:06:49,400
has words as some structure and will

124
00:06:47,120 --> 00:06:51,650
recognize that as a normal file the one

125
00:06:49,400 --> 00:06:54,590
<font color="#CCCCCC">on the right has no such structure and</font>

126
00:06:51,650 --> 00:06:56,179
most likely<font color="#E5E5E5"> is an encrypted file we can</font>

127
00:06:54,590 --> 00:06:59,979
see this but in order<font color="#E5E5E5"> to build a</font>

128
00:06:56,180 --> 00:07:04,490
ransomware detector we actually<font color="#CCCCCC"> have two</font>

129
00:06:59,980 --> 00:07:09,650
pc computer how to see this and what we

130
00:07:04,490 --> 00:07:11,870
use for this is a first step is n-grams

131
00:07:09,650 --> 00:07:14,299
which you all in all<font color="#E5E5E5"> language processing</font>

132
00:07:11,870 --> 00:07:16,430
is making histograms of all sub strings

133
00:07:14,300 --> 00:07:19,280
of text well in our case we're just

134
00:07:16,430 --> 00:07:21,770
going to<font color="#E5E5E5"> look at one grams which are the</font>

135
00:07:19,280 --> 00:07:23,539
bytes represented in a certain<font color="#CCCCCC"> piece of</font>

136
00:07:21,770 --> 00:07:25,630
text and then we'll make a histogram for

137
00:07:23,540 --> 00:07:29,690
that so we count the occurrence of each

138
00:07:25,630 --> 00:07:32,270
ascii character which we have done<font color="#CCCCCC"> for</font>

139
00:07:29,690 --> 00:07:35,450
both files presented the one on the left

140
00:07:32,270 --> 00:07:37,789
the structured file shows<font color="#CCCCCC"> Peaks shows</font>

141
00:07:35,450 --> 00:07:42,050
some regular occurrence of characters

142
00:07:37,790 --> 00:07:44,060
and some<font color="#E5E5E5"> that are less regular the file</font>

143
00:07:42,050 --> 00:07:48,790
on the right has very flat profile which

144
00:07:44,060 --> 00:07:51,110
means<font color="#CCCCCC"> that it's it's very hard to say</font>

145
00:07:48,790 --> 00:07:55,010
which characters are using this file

146
00:07:51,110 --> 00:07:57,320
because they all occur about as frequent

147
00:07:55,010 --> 00:07:58,640
what we can do with this<font color="#E5E5E5"> if you go to</font>

148
00:07:57,320 --> 00:08:00,560
the<font color="#E5E5E5"> next slide if we turn it into</font>

149
00:07:58,640 --> 00:08:06,590
<font color="#E5E5E5">distribution and actually express the</font>

150
00:08:00,560 --> 00:08:08,290
probability sorry of of the the

151
00:08:06,590 --> 00:08:11,599
<font color="#E5E5E5">occurrence of a certain character and</font>

152
00:08:08,290 --> 00:08:14,270
for encryption it is important that a

153
00:08:11,600 --> 00:08:16,490
cipher texts text is hard to predict

154
00:08:14,270 --> 00:08:20,060
even if you have a plain text or if you

155
00:08:16,490 --> 00:08:25,790
<font color="#E5E5E5">have a key and no plain text sorry can't</font>

156
00:08:20,060 --> 00:08:28,669
go to predict this and in<font color="#E5E5E5"> order to build</font>

157
00:08:25,790 --> 00:08:31,849
our encryption detector we have to turn

158
00:08:28,669 --> 00:08:34,429
these distributions into a number that

159
00:08:31,849 --> 00:08:36,409
represents something about how easy or

160
00:08:34,429 --> 00:08:38,899
hard it is to protect the

161
00:08:36,409 --> 00:08:40,639
<font color="#E5E5E5">it bites in a file and what we use for</font>

162
00:08:38,899 --> 00:08:43,250
this and don't spoil a little bit on

163
00:08:40,639 --> 00:08:46,879
purpose is called Shannon entropy and in

164
00:08:43,250 --> 00:08:48,620
the<font color="#E5E5E5"> next five slides which will contain</font>

165
00:08:46,879 --> 00:08:51,949
a bit of mass I'm going<font color="#E5E5E5"> to try to</font>

166
00:08:48,620 --> 00:08:55,040
explain<font color="#E5E5E5"> how this is computed for some of</font>

167
00:08:51,949 --> 00:08:57,099
you this might be old hat for some of

168
00:08:55,040 --> 00:09:02,029
you this might go a little<font color="#E5E5E5"> bit fast but</font>

169
00:08:57,100 --> 00:09:04,430
bear with me well we already have seen

170
00:09:02,029 --> 00:09:05,750
<font color="#E5E5E5">probably how to turn a statistical</font>

171
00:09:04,430 --> 00:09:07,550
distribution<font color="#E5E5E5"> into</font><font color="#CCCCCC"> a single number</font>

172
00:09:05,750 --> 00:09:09,379
because in the second grade of high

173
00:09:07,550 --> 00:09:11,930
school we all<font color="#CCCCCC"> got the assignment of hey</font>

174
00:09:09,379 --> 00:09:13,579
if you play the lottery what is the

175
00:09:11,930 --> 00:09:15,949
average result of playing the lottery so

176
00:09:13,579 --> 00:09:18,109
what is your expected value and in our

177
00:09:15,949 --> 00:09:20,779
little example say if you<font color="#E5E5E5"> have a lottery</font>

178
00:09:18,110 --> 00:09:24,529
with also one in a million of winning

179
00:09:20,779 --> 00:09:27,110
grand prize $100,000 and<font color="#E5E5E5"> a smaller price</font>

180
00:09:24,529 --> 00:09:29,750
that of course one in thousands of one

181
00:09:27,110 --> 00:09:33,319
hundred dollars then computing the

182
00:09:29,750 --> 00:09:35,569
average of of playing the lottery<font color="#E5E5E5"> is a</font>

183
00:09:33,319 --> 00:09:38,060
one in thousand occurrence of the grand

184
00:09:35,569 --> 00:09:40,849
prize plus a 1 in thousands occurrence

185
00:09:38,060 --> 00:09:42,550
of the smaller<font color="#CCCCCC"> plot price meaning</font><font color="#E5E5E5"> that</font>

186
00:09:40,850 --> 00:09:46,130
if you play in this lottery you'll<font color="#E5E5E5"> get</font>

187
00:09:42,550 --> 00:09:48,349
20<font color="#E5E5E5"> cents for every time you play which</font>

188
00:09:46,130 --> 00:09:49,910
of course<font color="#E5E5E5"> usually is not nice if you pay</font>

189
00:09:48,350 --> 00:09:51,560
more for the tickets so the numbers are

190
00:09:49,910 --> 00:09:54,079
meaningful<font color="#E5E5E5"> and every one of you of</font>

191
00:09:51,560 --> 00:09:56,599
course<font color="#E5E5E5"> already has tried once to convert</font>

192
00:09:54,079 --> 00:09:59,029
a<font color="#CCCCCC"> distribution</font><font color="#E5E5E5"> into such a number now if</font>

193
00:09:56,600 --> 00:10:01,310
<font color="#E5E5E5">we generalize this then the formula</font>

194
00:09:59,029 --> 00:10:04,160
mathematical formula for expected value

195
00:10:01,310 --> 00:10:06,920
is the sum<font color="#CCCCCC"> over all the probabilities of</font>

196
00:10:04,160 --> 00:10:09,649
a certain events times a certain value a

197
00:10:06,920 --> 00:10:12,370
pair of attached<font color="#E5E5E5"> to these</font><font color="#CCCCCC"> events now</font>

198
00:10:09,649 --> 00:10:14,870
<font color="#CCCCCC">indicate the distributions we created</font>

199
00:10:12,370 --> 00:10:18,079
the next<font color="#E5E5E5"> slide we cannot say anything</font>

200
00:10:14,870 --> 00:10:20,509
about the certain value of design but we

201
00:10:18,079 --> 00:10:22,399
can evaluate this in terms of

202
00:10:20,509 --> 00:10:24,860
probability<font color="#CCCCCC"> of this event occurring and</font>

203
00:10:22,399 --> 00:10:27,110
as we've seen<font color="#CCCCCC"> in the slide earlier that</font>

204
00:10:24,860 --> 00:10:29,240
we're looking<font color="#CCCCCC"> for the</font><font color="#E5E5E5"> difference between</font>

205
00:10:27,110 --> 00:10:32,870
distributions that have<font color="#E5E5E5"> very high peaks</font>

206
00:10:29,240 --> 00:10:35,959
and very low peaks and are also very

207
00:10:32,870 --> 00:10:37,730
flat so what we're going to do for this

208
00:10:35,959 --> 00:10:40,579
payoff function we actually want<font color="#CCCCCC"> to do</font>

209
00:10:37,730 --> 00:10:42,740
something where<font color="#E5E5E5"> we calculate</font><font color="#CCCCCC"> 1 over the</font>

210
00:10:40,579 --> 00:10:45,079
probability of an event occurring so if

211
00:10:42,740 --> 00:10:46,699
<font color="#E5E5E5">we have a very rare event a very flat</font>

212
00:10:45,079 --> 00:10:48,469
peak then we're going<font color="#E5E5E5"> to attach</font><font color="#CCCCCC"> a high</font>

213
00:10:46,699 --> 00:10:49,939
value which means it's hard to predict

214
00:10:48,470 --> 00:10:51,529
and we

215
00:10:49,939 --> 00:10:54,618
a very high peaks we're going to<font color="#CCCCCC"> attach</font>

216
00:10:51,529 --> 00:10:56,629
a low value and freshen LNP we also take

217
00:10:54,619 --> 00:10:59,149
the two log of this if you click to<font color="#E5E5E5"> the</font>

218
00:10:56,629 --> 00:11:02,419
next slide visit this has nice

219
00:10:59,149 --> 00:11:04,909
properties such as that the the entropy

220
00:11:02,419 --> 00:11:09,499
of a binary experiment say a coin flip

221
00:11:04,909 --> 00:11:12,289
is exactly one bit so the level the

222
00:11:09,499 --> 00:11:16,999
entropy of predicting whether a bit is a

223
00:11:12,289 --> 00:11:19,009
<font color="#E5E5E5">1 or</font><font color="#CCCCCC"> 0 is 1 and if we</font><font color="#E5E5E5"> fill this in to</font>

224
00:11:16,999 --> 00:11:21,470
the expected<font color="#E5E5E5"> value formula then we get</font>

225
00:11:19,009 --> 00:11:23,149
what is called Shannon entropy and

226
00:11:21,470 --> 00:11:26,059
that's what we're going to<font color="#CCCCCC"> use to</font>

227
00:11:23,149 --> 00:11:27,679
convert<font color="#E5E5E5"> the distribution into a number</font>

228
00:11:26,059 --> 00:11:31,999
that is meaningful in terms of

229
00:11:27,679 --> 00:11:34,488
encryption now if you got<font color="#E5E5E5"> distracted by</font>

230
00:11:31,999 --> 00:11:36,739
<font color="#CCCCCC">the math you can also consider the</font>

231
00:11:34,489 --> 00:11:38,659
entropy as the lower bound and the

232
00:11:36,739 --> 00:11:40,970
number of<font color="#E5E5E5"> years and no questions you</font>

233
00:11:38,659 --> 00:11:42,799
have to ask<font color="#E5E5E5"> about a certain experiment</font>

234
00:11:40,970 --> 00:11:45,289
in order to guess a result that<font color="#E5E5E5"> came</font>

235
00:11:42,799 --> 00:11:47,869
from the experiment in which case if<font color="#E5E5E5"> you</font>

236
00:11:45,289 --> 00:11:49,999
have the bit flip the coin flip again

237
00:11:47,869 --> 00:11:52,159
and it's one question you<font color="#E5E5E5"> have to ask</font>

238
00:11:49,999 --> 00:11:53,899
whether it's a one or a zero and then

239
00:11:52,159 --> 00:11:55,819
you'll know which is the lower bound for

240
00:11:53,899 --> 00:11:58,039
guessing so we had these distributions

241
00:11:55,819 --> 00:12:00,978
from the histograms that we converted

242
00:11:58,039 --> 00:12:03,379
and then on the next slide the strategy

243
00:12:00,979 --> 00:12:05,599
again is we have text we turn that in a

244
00:12:03,379 --> 00:12:08,089
histogram the different ASCII characters

245
00:12:05,599 --> 00:12:09,409
have distribution user entropy

246
00:12:08,089 --> 00:12:11,479
calculation and then we have a number

247
00:12:09,409 --> 00:12:15,429
that's meaningful which of course now

248
00:12:11,479 --> 00:12:20,179
becomes filling in exercise to have

249
00:12:15,429 --> 00:12:22,220
three peaks here of of rare occurrence

250
00:12:20,179 --> 00:12:24,919
which we calculate here then add two

251
00:12:22,220 --> 00:12:26,959
peaks of more common occurrence maybe

252
00:12:24,919 --> 00:12:29,299
get a number two points to something on

253
00:12:26,959 --> 00:12:31,279
the right side we<font color="#CCCCCC"> have seven very small</font>

254
00:12:29,299 --> 00:12:33,679
Peaks which will<font color="#E5E5E5"> also add together</font>

255
00:12:31,279 --> 00:12:35,419
according<font color="#CCCCCC"> to the formula</font><font color="#E5E5E5"> and then we get</font>

256
00:12:33,679 --> 00:12:39,789
two numbers<font color="#CCCCCC"> that</font><font color="#E5E5E5"> express what we</font>

257
00:12:35,419 --> 00:12:42,470
originally saw that in the<font color="#E5E5E5"> next slide 23</font>

258
00:12:39,789 --> 00:12:44,989
the one<font color="#CCCCCC"> on</font><font color="#E5E5E5"> the right is a lower number</font>

259
00:12:42,470 --> 00:12:46,729
or<font color="#CCCCCC"> the one on your left is a lower</font>

260
00:12:44,989 --> 00:12:48,709
number and on one on the right is a

261
00:12:46,729 --> 00:12:53,779
higher number and with some probability

262
00:12:48,709 --> 00:12:56,839
and<font color="#CCCCCC"> encrypt</font><font color="#E5E5E5"> text so we now have</font><font color="#CCCCCC"> a tool</font>

263
00:12:53,779 --> 00:12:58,809
to say if a certain text is encrypted

264
00:12:56,839 --> 00:13:01,159
and then we need<font color="#CCCCCC"> to</font><font color="#E5E5E5"> move on to a</font>

265
00:12:58,809 --> 00:13:02,959
behavior analysis of<font color="#CCCCCC"> that in order to</font>

266
00:13:01,159 --> 00:13:03,439
convert that into an actual detector

267
00:13:02,959 --> 00:13:06,290
that helps

268
00:13:03,440 --> 00:13:08,570
to find ransomware so we need to make a

269
00:13:06,290 --> 00:13:10,459
<font color="#E5E5E5">prediction about what kind of entropy</font>

270
00:13:08,570 --> 00:13:14,870
values are associated<font color="#E5E5E5"> with encryption</font>

271
00:13:10,460 --> 00:13:17,240
well we're looking at one grams so we're

272
00:13:14,870 --> 00:13:19,580
looking at the<font color="#CCCCCC"> Husky occurrence of ASCII</font>

273
00:13:17,240 --> 00:13:22,310
characters in our<font color="#E5E5E5"> database those are</font>

274
00:13:19,580 --> 00:13:26,570
made up of<font color="#CCCCCC"> eight</font><font color="#E5E5E5"> bits to a bite of an</font>

275
00:13:22,310 --> 00:13:31,550
ascii character so if it is<font color="#E5E5E5"> necessary</font>

276
00:13:26,570 --> 00:13:33,890
can go back yes so we<font color="#E5E5E5"> expect to find in</font>

277
00:13:31,550 --> 00:13:36,560
the theoretical ideal case of proper

278
00:13:33,890 --> 00:13:39,020
encryption eight bits of entropy for

279
00:13:36,560 --> 00:13:40,189
this distribution and of course<font color="#E5E5E5"> that the</font>

280
00:13:39,020 --> 00:13:42,740
files will use<font color="#CCCCCC"> all the available</font>

281
00:13:40,190 --> 00:13:44,240
characters about equal is often so if

282
00:13:42,740 --> 00:13:46,790
we're going<font color="#CCCCCC"> to the</font><font color="#E5E5E5"> next slide and we're</font>

283
00:13:44,240 --> 00:13:48,860
going to build a detector we're

284
00:13:46,790 --> 00:13:50,780
measuring the one grams of these files

285
00:13:48,860 --> 00:13:54,170
exchanges and this<font color="#E5E5E5"> is going to be a</font>

286
00:13:50,780 --> 00:13:56,990
<font color="#E5E5E5">number between 0 and 8 bits of entropy</font>

287
00:13:54,170 --> 00:14:01,849
then if your radical model will say that

288
00:13:56,990 --> 00:14:04,160
on top thank you perfect will I have all

289
00:14:01,850 --> 00:14:06,290
the encrypted files well real world is

290
00:14:04,160 --> 00:14:08,780
slightly more noisy so we're<font color="#E5E5E5"> going to</font>

291
00:14:06,290 --> 00:14:11,410
add some bounce to this and then this<font color="#CCCCCC"> is</font>

292
00:14:08,780 --> 00:14:14,209
<font color="#CCCCCC">the</font><font color="#E5E5E5"> area where we'll find the encryption</font>

293
00:14:11,410 --> 00:14:17,240
yeah so we<font color="#CCCCCC"> ask</font><font color="#E5E5E5"> Gretchen is this actually</font>

294
00:14:14,210 --> 00:14:18,620
a good way<font color="#E5E5E5"> to predict encryption so we</font>

295
00:14:17,240 --> 00:14:20,090
measure<font color="#E5E5E5"> the entropy of a lot of</font>

296
00:14:18,620 --> 00:14:22,730
<font color="#CCCCCC">different files including encrypted</font>

297
00:14:20,090 --> 00:14:24,890
files which is<font color="#E5E5E5"> bit noisy bits column on</font>

298
00:14:22,730 --> 00:14:28,550
the Left which indeed adheres to the top

299
00:14:24,890 --> 00:14:31,520
of<font color="#E5E5E5"> the file you</font><font color="#CCCCCC"> have HTML files text</font>

300
00:14:28,550 --> 00:14:33,680
<font color="#E5E5E5">files programming files like biting code</font>

301
00:14:31,520 --> 00:14:36,020
or<font color="#E5E5E5"> C++ code which is very regular as</font>

302
00:14:33,680 --> 00:14:37,729
words is better<font color="#CCCCCC"> in two spaces use the</font>

303
00:14:36,020 --> 00:14:40,970
readable character so it's neatly in the

304
00:14:37,730 --> 00:14:44,090
bound of sixty percent entropy about 5.5

305
00:14:40,970 --> 00:14:45,980
bits but then there is this one file tab

306
00:14:44,090 --> 00:14:47,960
which we found in our experiment that

307
00:14:45,980 --> 00:14:51,620
really adheres to the top even<font color="#CCCCCC"> better</font>

308
00:14:47,960 --> 00:14:54,470
than our encryption sample which are PNG

309
00:14:51,620 --> 00:14:56,360
files which are media files and those

310
00:14:54,470 --> 00:14:58,040
files<font color="#E5E5E5"> are compressed files and</font>

311
00:14:56,360 --> 00:15:01,730
compressed files of course<font color="#E5E5E5"> will also</font>

312
00:14:58,040 --> 00:15:04,819
<font color="#CCCCCC">have very high entropy because if it if</font>

313
00:15:01,730 --> 00:15:06,890
<font color="#E5E5E5">there's an easy way to predict what an</font>

314
00:15:04,820 --> 00:15:09,080
compressed file looked like then there's

315
00:15:06,890 --> 00:15:11,210
probably a better way to compress it so

316
00:15:09,080 --> 00:15:14,630
we need to<font color="#E5E5E5"> find a behavioral methods</font>

317
00:15:11,210 --> 00:15:16,710
that takes an account entropy that will

318
00:15:14,630 --> 00:15:20,910
indicate whether something is

319
00:15:16,710 --> 00:15:24,590
but leaves out the false positives your

320
00:15:20,910 --> 00:15:27,750
next<font color="#E5E5E5"> slide of these compressed files and</font>

321
00:15:24,590 --> 00:15:30,480
that is where we<font color="#E5E5E5"> started implementing a</font>

322
00:15:27,750 --> 00:15:34,920
real detector and<font color="#CCCCCC"> dot's got to tell more</font>

323
00:15:30,480 --> 00:15:37,170
<font color="#E5E5E5">about this so the detection of</font>

324
00:15:34,920 --> 00:15:42,150
encryption is so something that we can

325
00:15:37,170 --> 00:15:44,010
do but like we saw some basic high

326
00:15:42,150 --> 00:15:49,459
entropy values aren't going to<font color="#CCCCCC"> actually</font>

327
00:15:44,010 --> 00:15:53,250
help us so we know<font color="#CCCCCC"> that we need to</font>

328
00:15:49,460 --> 00:15:56,160
actually find some sort of increase in

329
00:15:53,250 --> 00:15:59,270
entropy in these exchanges that we've

330
00:15:56,160 --> 00:16:01,650
already built and we also know<font color="#E5E5E5"> that</font>

331
00:15:59,270 --> 00:16:04,620
encryption doesn't really change the

332
00:16:01,650 --> 00:16:06,600
size of a file unlike compression which

333
00:16:04,620 --> 00:16:10,170
is<font color="#E5E5E5"> trying to compress a file and so</font>

334
00:16:06,600 --> 00:16:11,970
using these two characteristics we can

335
00:16:10,170 --> 00:16:16,740
actually<font color="#E5E5E5"> try</font><font color="#CCCCCC"> and build some</font><font color="#E5E5E5"> sort of</font>

336
00:16:11,970 --> 00:16:19,110
detection rule for just a encryption so

337
00:16:16,740 --> 00:16:22,310
we did that and<font color="#E5E5E5"> we found some</font>

338
00:16:19,110 --> 00:16:26,610
<font color="#E5E5E5">interesting numbers so here we have some</font>

339
00:16:22,310 --> 00:16:29,239
ransomware samples and some true

340
00:16:26,610 --> 00:16:32,280
positive rates which basically mean only

341
00:16:29,240 --> 00:16:33,990
encryption and these numbers aren't too

342
00:16:32,280 --> 00:16:39,420
high<font color="#E5E5E5"> only for jigsaw we had a really</font>

343
00:16:33,990 --> 00:16:42,240
nice true positive rate the reason<font color="#CCCCCC"> that</font>

344
00:16:39,420 --> 00:16:44,520
the other ones aren't as high as mostly

345
00:16:42,240 --> 00:16:48,530
because there were some files that were

346
00:16:44,520 --> 00:16:52,290
too<font color="#CCCCCC"> small and the</font><font color="#E5E5E5"> increase in size was</font>

347
00:16:48,530 --> 00:16:54,689
marginally enough so that<font color="#E5E5E5"> you would jump</font>

348
00:16:52,290 --> 00:16:57,870
<font color="#E5E5E5">over the detection rule threshold that</font>

349
00:16:54,690 --> 00:16:59,580
<font color="#E5E5E5">we had and for instance</font><font color="#CCCCCC"> this users</font>

350
00:16:57,870 --> 00:17:03,120
actually really aggressive user that

351
00:16:59,580 --> 00:17:06,360
does compression encryption some random

352
00:17:03,120 --> 00:17:08,130
<font color="#CCCCCC">high entropy stuff because we scripted</font>

353
00:17:06,359 --> 00:17:11,429
him to be really aggressive because we

354
00:17:08,130 --> 00:17:14,190
really wanted to<font color="#E5E5E5"> test our our detection</font>

355
00:17:11,430 --> 00:17:17,850
rule but the important part<font color="#E5E5E5"> here is that</font>

356
00:17:14,190 --> 00:17:20,370
we have no false positive rate and this

357
00:17:17,849 --> 00:17:24,990
is<font color="#E5E5E5"> because we pretty much excluded</font>

358
00:17:20,369 --> 00:17:27,599
anything but encryption or really random

359
00:17:24,990 --> 00:17:29,520
stuff<font color="#E5E5E5"> and that's only when you</font><font color="#CCCCCC"> have a</font>

360
00:17:27,599 --> 00:17:31,530
file for instance that's<font color="#E5E5E5"> has</font>

361
00:17:29,520 --> 00:17:35,129
really low entropy and then<font color="#E5E5E5"> actually</font>

362
00:17:31,530 --> 00:17:40,050
increases like thirty percent and this

363
00:17:35,130 --> 00:17:41,700
didn't occur so that's really<font color="#E5E5E5"> nice so</font>

364
00:17:40,050 --> 00:17:44,240
<font color="#E5E5E5">I'm</font><font color="#CCCCCC"> going to get the next slide yeah</font>

365
00:17:41,700 --> 00:17:47,550
thank<font color="#E5E5E5"> you so now</font><font color="#CCCCCC"> that we can</font><font color="#E5E5E5"> detect</font>

366
00:17:44,240 --> 00:17:50,640
encryption on exchanges we can actually

367
00:17:47,550 --> 00:17:52,379
<font color="#E5E5E5">try and see well okay is this traffic</font>

368
00:17:50,640 --> 00:17:54,150
that contains encryption is it actually

369
00:17:52,380 --> 00:17:56,370
<font color="#CCCCCC">run somewhere or is it actually just the</font>

370
00:17:54,150 --> 00:17:58,890
user that's performing some encryption

371
00:17:56,370 --> 00:18:01,709
<font color="#CCCCCC">and we can do this based on the rate of</font>

372
00:17:58,890 --> 00:18:03,990
encryption which is a fancy way of

373
00:18:01,710 --> 00:18:07,710
saying the number<font color="#CCCCCC"> of encryptions per</font>

374
00:18:03,990 --> 00:18:09,420
second and then using<font color="#CCCCCC"> this we can</font>

375
00:18:07,710 --> 00:18:13,740
actually<font color="#E5E5E5"> distinguish between run</font>

376
00:18:09,420 --> 00:18:15,630
somewhere<font color="#CCCCCC"> and just a regular user so by</font>

377
00:18:13,740 --> 00:18:18,060
analyzing<font color="#CCCCCC"> the rate of encryption of each</font>

378
00:18:15,630 --> 00:18:20,450
of these samples and using some

379
00:18:18,060 --> 00:18:22,530
different time frames<font color="#CCCCCC"> wherein which</font><font color="#E5E5E5"> we</font>

380
00:18:20,450 --> 00:18:24,720
which we started<font color="#CCCCCC"> with the first</font>

381
00:18:22,530 --> 00:18:29,730
encryption that<font color="#E5E5E5"> we detect and then kind</font>

382
00:18:24,720 --> 00:18:34,230
<font color="#E5E5E5">of measuring until the time frame well</font>

383
00:18:29,730 --> 00:18:37,260
the time frame stops we can<font color="#E5E5E5"> actually see</font>

384
00:18:34,230 --> 00:18:40,740
well<font color="#CCCCCC"> okay is this transfer is a user</font>

385
00:18:37,260 --> 00:18:42,900
based on the number of alarms that went

386
00:18:40,740 --> 00:18:45,990
off because they exceeded the required

387
00:18:42,900 --> 00:18:48,930
number of encryptions so we have another

388
00:18:45,990 --> 00:18:51,840
table what's<font color="#E5E5E5"> interesting here is that</font>

389
00:18:48,930 --> 00:18:54,780
the user had mostly<font color="#E5E5E5"> zeros this is</font>

390
00:18:51,840 --> 00:18:59,669
because<font color="#E5E5E5"> the encryptions that the</font><font color="#CCCCCC"> user</font>

391
00:18:54,780 --> 00:19:01,740
<font color="#CCCCCC">did were either far apart or just not</font>

392
00:18:59,670 --> 00:19:04,800
enough encryptions were performed within

393
00:19:01,740 --> 00:19:07,080
the time span there's only one that

394
00:19:04,800 --> 00:19:10,200
<font color="#CCCCCC">actually instance where we can actually</font>

395
00:19:07,080 --> 00:19:12,600
<font color="#E5E5E5">say okay the user is detected but</font><font color="#CCCCCC"> if</font><font color="#E5E5E5"> we</font>

396
00:19:10,200 --> 00:19:16,920
go to the next<font color="#E5E5E5"> slide we can see well the</font>

397
00:19:12,600 --> 00:19:19,649
difference is so much that<font color="#CCCCCC"> we</font><font color="#E5E5E5"> could do a</font>

398
00:19:16,920 --> 00:19:21,420
second filter pass and then we would

399
00:19:19,650 --> 00:19:23,880
<font color="#E5E5E5">still only have run somewhere that is</font>

400
00:19:21,420 --> 00:19:28,470
being detected by this detection rule

401
00:19:23,880 --> 00:19:30,660
and so we can<font color="#CCCCCC"> actually distinguish as we</font>

402
00:19:28,470 --> 00:19:33,360
can show here between a user a really

403
00:19:30,660 --> 00:19:36,870
aggressive user and rent somewhere based

404
00:19:33,360 --> 00:19:39,540
on this rate of encryption so what<font color="#E5E5E5"> can</font>

405
00:19:36,870 --> 00:19:42,030
you<font color="#E5E5E5"> actually use this for well first off</font>

406
00:19:39,540 --> 00:19:43,139
<font color="#E5E5E5">and somewhere and intrusion detection</font>

407
00:19:42,030 --> 00:19:45,660
system is

408
00:19:43,140 --> 00:19:47,520
is a really obvious one but you could

409
00:19:45,660 --> 00:19:51,390
also for instance block traffic from an

410
00:19:47,520 --> 00:19:55,310
infected<font color="#CCCCCC"> klein because SMB actually</font>

411
00:19:51,390 --> 00:19:57,660
contains the data from where the

412
00:19:55,310 --> 00:20:00,060
messages are<font color="#E5E5E5"> sent so you have an IP</font>

413
00:19:57,660 --> 00:20:02,310
<font color="#CCCCCC">address that</font><font color="#E5E5E5"> you could block for</font>

414
00:20:00,060 --> 00:20:05,100
instance if you deem it as run somewhere

415
00:20:02,310 --> 00:20:07,230
<font color="#CCCCCC">and another</font><font color="#E5E5E5"> interesting feature that</font>

416
00:20:05,100 --> 00:20:09,419
could be implemented<font color="#CCCCCC"> its backing up the</font>

417
00:20:07,230 --> 00:20:12,630
data that has been recently<font color="#E5E5E5"> attacked</font>

418
00:20:09,420 --> 00:20:15,150
because you can store a buffer on our

419
00:20:12,630 --> 00:20:19,020
passive listener with the files because

420
00:20:15,150 --> 00:20:21,810
of the SMB data actually going through

421
00:20:19,020 --> 00:20:23,730
<font color="#E5E5E5">our passive listener which also includes</font>

422
00:20:21,810 --> 00:20:28,790
<font color="#E5E5E5">the unencrypted data and then afterwards</font>

423
00:20:23,730 --> 00:20:32,240
you get the encrypted data you go back

424
00:20:28,790 --> 00:20:34,500
you can actually<font color="#CCCCCC"> back up</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> data and</font>

425
00:20:32,240 --> 00:20:36,120
then as soon<font color="#E5E5E5"> as you block off the</font>

426
00:20:34,500 --> 00:20:37,740
infected traffic you<font color="#CCCCCC"> can actually</font><font color="#E5E5E5"> get</font>

427
00:20:36,120 --> 00:20:39,449
<font color="#CCCCCC">your files back without</font><font color="#E5E5E5"> any hassle</font>

428
00:20:37,740 --> 00:20:45,450
because you already have<font color="#CCCCCC"> the unencrypted</font>

429
00:20:39,450 --> 00:20:49,170
files so yeah next slide please any

430
00:20:45,450 --> 00:20:52,350
questions also make sure to visit no

431
00:20:49,170 --> 00:20:57,810
more ransom org and the spice<font color="#E5E5E5"> web page</font>

432
00:20:52,350 --> 00:21:00,679
of the tue<font color="#CCCCCC"> yes think we</font><font color="#E5E5E5"> manage time</font>

433
00:20:57,810 --> 00:21:04,850
pretty well despite<font color="#CCCCCC"> the technical issues</font>

434
00:21:00,680 --> 00:21:04,850
we're regressing<font color="#E5E5E5"> on first row of things</font>

435
00:21:07,280 --> 00:21:16,560
let's see if listener did you use<font color="#E5E5E5"> bro</font>

436
00:21:10,050 --> 00:21:21,149
yes or a battle we use silent defense

437
00:21:16,560 --> 00:21:23,490
which is a it's being developed<font color="#E5E5E5"> by a</font>

438
00:21:21,150 --> 00:21:26,730
company<font color="#E5E5E5"> that's related to the TV</font><font color="#CCCCCC"> I think</font>

439
00:21:23,490 --> 00:21:28,620
it's<font color="#E5E5E5"> called security matters but</font><font color="#CCCCCC"> it</font>

440
00:21:26,730 --> 00:21:30,480
could also be implemented<font color="#CCCCCC"> in bro</font><font color="#E5E5E5"> because</font>

441
00:21:28,620 --> 00:21:34,500
I actually also<font color="#E5E5E5"> looked at bro but it was</font>

442
00:21:30,480 --> 00:21:37,700
kind of handed to us by the by<font color="#E5E5E5"> the guys</font>

443
00:21:34,500 --> 00:21:37,700
that also work in the<font color="#CCCCCC"> Department</font>

444
00:21:42,010 --> 00:21:52,610
this question over there I see that<font color="#CCCCCC"> you</font>

445
00:21:50,480 --> 00:21:56,960
you guys<font color="#E5E5E5"> are having done this in the</font>

446
00:21:52,610 --> 00:22:00,709
<font color="#E5E5E5">network level of detection have you</font>

447
00:21:56,960 --> 00:22:03,800
tried and the host<font color="#E5E5E5"> based level since the</font>

448
00:22:00,710 --> 00:22:05,900
ransomware will basically hit the either

449
00:22:03,800 --> 00:22:08,750
maybe and use the rocket station or

450
00:22:05,900 --> 00:22:13,870
server do<font color="#E5E5E5"> you think this can be done and</font>

451
00:22:08,750 --> 00:22:17,210
like in part of the antivirus or any

452
00:22:13,870 --> 00:22:20,510
there's already some solutions that do

453
00:22:17,210 --> 00:22:22,520
it on the host based level the reason

454
00:22:20,510 --> 00:22:24,650
why we do it<font color="#E5E5E5"> like this is because</font>

455
00:22:22,520 --> 00:22:32,510
network drives obviously don't<font color="#CCCCCC"> have</font>

456
00:22:24,650 --> 00:22:34,850
their own host software so and also

457
00:22:32,510 --> 00:22:37,340
ransom<font color="#E5E5E5"> rack with for instance interfere</font>

458
00:22:34,850 --> 00:22:39,500
with the end of antivirus solution and

459
00:22:37,340 --> 00:22:40,730
so by doing this having a passive

460
00:22:39,500 --> 00:22:43,160
listener which can't really be

461
00:22:40,730 --> 00:22:46,850
interfered with because you setup your

462
00:22:43,160 --> 00:22:48,410
network as such you actually<font color="#E5E5E5"> kind of</font>

463
00:22:46,850 --> 00:22:50,719
avoid having to deal with<font color="#E5E5E5"> the rents from</font>

464
00:22:48,410 --> 00:22:53,360
<font color="#E5E5E5">are attacking your listener and</font>

465
00:22:50,720 --> 00:22:56,000
furthermore you can actually easily sort

466
00:22:53,360 --> 00:22:57,560
of the we have a professor at<font color="#CCCCCC"> the TV we</font>

467
00:22:56,000 --> 00:22:59,420
are always actually like an advocate for

468
00:22:57,560 --> 00:23:01,040
just plugging something in and then not

469
00:22:59,420 --> 00:23:05,480
looking at it again in a whole space

470
00:23:01,040 --> 00:23:07,639
solution usually need some maintenance

471
00:23:05,480 --> 00:23:11,150
and you would also<font color="#E5E5E5"> have to implement</font>

472
00:23:07,640 --> 00:23:12,740
furnace for a company with 300 posts you

473
00:23:11,150 --> 00:23:15,520
would have to deploy it on free honored

474
00:23:12,740 --> 00:23:18,860
host while this could serve like a

475
00:23:15,520 --> 00:23:20,629
<font color="#E5E5E5">single</font><font color="#CCCCCC"> entity however your point that</font>

476
00:23:18,860 --> 00:23:23,120
the mechanics will work on a house based

477
00:23:20,630 --> 00:23:25,790
system are completely correct that if

478
00:23:23,120 --> 00:23:28,310
you find a<font color="#E5E5E5"> way to find the exchanges</font>

479
00:23:25,790 --> 00:23:30,740
with in your house then our detection

480
00:23:28,310 --> 00:23:32,929
rules would also apply to doing it on a

481
00:23:30,740 --> 00:23:37,580
single machine to fight the infection

482
00:23:32,930 --> 00:23:43,250
there another question when<font color="#E5E5E5"> you compare</font>

483
00:23:37,580 --> 00:23:48,500
the like in like between<font color="#E5E5E5"> the normal text</font>

484
00:23:43,250 --> 00:23:50,270
or statement and the encrypted one is it

485
00:23:48,500 --> 00:23:53,630
going to be any difference if you<font color="#E5E5E5"> guys</font>

486
00:23:50,270 --> 00:23:57,230
are if there<font color="#E5E5E5"> is any other languages</font>

487
00:23:53,630 --> 00:23:59,960
any other like let's say I don't<font color="#CCCCCC"> know</font>

488
00:23:57,230 --> 00:24:02,960
Chinese or<font color="#CCCCCC"> something well you know they</font>

489
00:23:59,960 --> 00:24:05,120
have Ural probably not assuming that the

490
00:24:02,960 --> 00:24:09,050
Chinese language<font color="#CCCCCC"> and character set has</font>

491
00:24:05,120 --> 00:24:11,419
structure what what distinguish regular

492
00:24:09,050 --> 00:24:12,830
files from the encrypted files is<font color="#E5E5E5"> that</font>

493
00:24:11,420 --> 00:24:15,110
the encrypted files have bites

494
00:24:12,830 --> 00:24:17,360
distribute distributed uniformly or at

495
00:24:15,110 --> 00:24:19,610
least very close to uniformly which is

496
00:24:17,360 --> 00:24:22,760
something<font color="#CCCCCC"> that you're going</font><font color="#E5E5E5"> to see very</font>

497
00:24:19,610 --> 00:24:26,169
rarely in normal files even<font color="#CCCCCC"> in different</font>

498
00:24:22,760 --> 00:24:28,940
character sets it might happen

499
00:24:26,170 --> 00:24:32,750
particularly for Chinese where for short

500
00:24:28,940 --> 00:24:34,460
messages you will use only a limited set

501
00:24:32,750 --> 00:24:36,710
of<font color="#E5E5E5"> these characters</font><font color="#CCCCCC"> and probably will</font>

502
00:24:34,460 --> 00:24:42,770
have messages with<font color="#CCCCCC"> a lot of</font><font color="#E5E5E5"> unique</font>

503
00:24:36,710 --> 00:24:46,490
characters that you<font color="#E5E5E5"> might come across</font>

504
00:24:42,770 --> 00:24:48,590
some higher entropy files over there but

505
00:24:46,490 --> 00:24:53,050
then it will still hold for a smaller

506
00:24:48,590 --> 00:24:55,730
alphabet so it probably won't go to the

507
00:24:53,050 --> 00:24:57,260
<font color="#E5E5E5">full eight bits of entropy but if your</font>

508
00:24:55,730 --> 00:24:59,390
messages hundred and twenty different

509
00:24:57,260 --> 00:25:02,030
characters and only 120 different

510
00:24:59,390 --> 00:25:05,450
characters long then you will probably

511
00:25:02,030 --> 00:25:10,310
have seven bits of entropy and of course

512
00:25:05,450 --> 00:25:16,730
<font color="#E5E5E5">across</font><font color="#CCCCCC"> the threshold in our system move</font>

513
00:25:10,310 --> 00:25:20,149
there yeah thank<font color="#CCCCCC"> you and suppose that</font>

514
00:25:16,730 --> 00:25:22,850
the developers of<font color="#E5E5E5"> ransomware know about</font>

515
00:25:20,150 --> 00:25:26,210
your research would it be easy for them

516
00:25:22,850 --> 00:25:29,719
to<font color="#E5E5E5"> work around this method yeah actually</font>

517
00:25:26,210 --> 00:25:31,190
it's quite easy I've actually tested

518
00:25:29,720 --> 00:25:35,080
this myself because this was for my

519
00:25:31,190 --> 00:25:39,740
<font color="#CCCCCC">thesis and if you actually compress</font>

520
00:25:35,080 --> 00:25:42,439
before you encrypt you totally avoid any

521
00:25:39,740 --> 00:25:45,290
detection at all because the entropy

522
00:25:42,440 --> 00:25:48,890
will go up but<font color="#E5E5E5"> the data size difference</font>

523
00:25:45,290 --> 00:25:50,330
will then avoid any detection because

524
00:25:48,890 --> 00:25:52,640
we're trying to<font color="#E5E5E5"> avoid detecting</font>

525
00:25:50,330 --> 00:25:55,429
compression and then if you encrypt

526
00:25:52,640 --> 00:25:57,620
afterwards the entropy will not change

527
00:25:55,430 --> 00:26:01,460
that much and the size won't<font color="#E5E5E5"> change much</font>

528
00:25:57,620 --> 00:26:03,500
either but you<font color="#E5E5E5"> just kind of avoided any</font>

529
00:26:01,460 --> 00:26:05,450
detection however if you're going to

530
00:26:03,500 --> 00:26:05,770
defend against this thing usually you're

531
00:26:05,450 --> 00:26:07,780
going to

532
00:26:05,770 --> 00:26:09,850
do things that slow the rate of the

533
00:26:07,780 --> 00:26:14,379
ransomware down which is advantageous in

534
00:26:09,850 --> 00:26:18,639
combating it and our system in generic

535
00:26:14,380 --> 00:26:21,250
sense is able to adapt to these things

536
00:26:18,640 --> 00:26:24,130
<font color="#E5E5E5">so doing basics you for compression</font>

537
00:26:21,250 --> 00:26:25,690
which will make file longer and lower

538
00:26:24,130 --> 00:26:28,090
the entropy is something that's very

539
00:26:25,690 --> 00:26:30,130
well we find if you study the<font color="#E5E5E5"> entropy</font>

540
00:26:28,090 --> 00:26:31,899
thing so it<font color="#E5E5E5"> is adaptable to this</font>

541
00:26:30,130 --> 00:26:34,210
situation but of course your request

542
00:26:31,900 --> 00:26:37,900
your question applies to any sort of

543
00:26:34,210 --> 00:26:39,820
malware vs mt malware<font color="#E5E5E5"> battle of which we</font>

544
00:26:37,900 --> 00:26:42,640
know it is incredibly hard<font color="#E5E5E5"> to defend</font>

545
00:26:39,820 --> 00:26:45,460
against and some clever<font color="#E5E5E5"> guys to come</font>

546
00:26:42,640 --> 00:26:48,730
<font color="#CCCCCC">around and do one change and</font><font color="#E5E5E5"> he'll</font>

547
00:26:45,460 --> 00:26:51,340
<font color="#E5E5E5">change the system our advantage probably</font>

548
00:26:48,730 --> 00:26:53,260
over some of<font color="#E5E5E5"> the things that exist out</font>

549
00:26:51,340 --> 00:26:56,290
there is that<font color="#CCCCCC"> it is more behavioral</font>

550
00:26:53,260 --> 00:26:59,590
based and not based on some blacklist

551
00:26:56,290 --> 00:27:02,950
where you just skip out of it so<font color="#E5E5E5"> you</font>

552
00:26:59,590 --> 00:27:06,040
really have to find something to either

553
00:27:02,950 --> 00:27:08,980
lower the entropy of your encryption

554
00:27:06,040 --> 00:27:10,720
with this which either means using weak

555
00:27:08,980 --> 00:27:14,230
encryption which is to our advantage or

556
00:27:10,720 --> 00:27:16,420
doing something that is<font color="#E5E5E5"> going to make</font><font color="#CCCCCC"> it</font>

557
00:27:14,230 --> 00:27:19,510
more noisy or more slow to deploy your

558
00:27:16,420 --> 00:27:23,710
end somewhere which probably is going to

559
00:27:19,510 --> 00:27:25,900
be a better situation for defending

560
00:27:23,710 --> 00:27:30,570
against but your point stands and

561
00:27:25,900 --> 00:27:30,570
applies to most malware research I think

562
00:27:31,140 --> 00:27:37,630
so any last question<font color="#E5E5E5"> then we can go</font><font color="#CCCCCC"> to</font>

563
00:27:35,200 --> 00:27:42,180
<font color="#CCCCCC">the</font><font color="#E5E5E5"> next speaker no questions anymore</font>

564
00:27:37,630 --> 00:27:42,180
<font color="#CCCCCC">okay thanks very much cloudless and</font><font color="#E5E5E5"> dawn</font>

