1
00:00:00,640 --> 00:00:02,700
you

2
00:00:13,350 --> 00:00:20,670
hello everyone<font color="#E5E5E5"> my talk today is</font><font color="#CCCCCC"> early</font>

3
00:00:16,950 --> 00:00:24,720
age<font color="#CCCCCC"> found</font><font color="#E5E5E5"> in</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> Windows kernel as you</font>

4
00:00:20,670 --> 00:00:29,210
know the Microsoft layer improving

5
00:00:24,720 --> 00:00:33,180
exploit mitigations day and day so it's

6
00:00:29,210 --> 00:00:38,550
more and more difficult<font color="#E5E5E5"> to break</font><font color="#CCCCCC"> out age</font>

7
00:00:33,180 --> 00:00:42,360
sandbox in last year my team<font color="#E5E5E5"> had</font>

8
00:00:38,550 --> 00:00:47,519
<font color="#E5E5E5">achieved three different ways from</font><font color="#CCCCCC"> 80</font><font color="#E5E5E5"> to</font>

9
00:00:42,360 --> 00:00:50,640
<font color="#E5E5E5">system and and we're glad to share my</font>

10
00:00:47,519 --> 00:01:00,059
research with you at the he'll be

11
00:00:50,640 --> 00:01:03,210
conference my name is Rancher<font color="#CCCCCC"> immerse</font>

12
00:01:00,059 --> 00:01:10,399
security researcher<font color="#E5E5E5"> of Winston's channel</font>

13
00:01:03,210 --> 00:01:13,740
I'm<font color="#CCCCCC"> Vincent Shirley is a convenient</font>

14
00:01:10,400 --> 00:01:17,909
<font color="#CCCCCC">giant lab</font><font color="#E5E5E5"> maybe you have not</font><font color="#CCCCCC"> heard</font>

15
00:01:13,740 --> 00:01:22,399
before<font color="#CCCCCC"> but I think some</font><font color="#E5E5E5"> are you know</font>

16
00:01:17,909 --> 00:01:26,149
<font color="#E5E5E5">about Luke in lab but</font><font color="#CCCCCC"> Jason's</font><font color="#E5E5E5"> keen that</font>

17
00:01:22,399 --> 00:01:29,909
<font color="#CCCCCC">we belong</font><font color="#E5E5E5"> to Earth's in department</font>

18
00:01:26,149 --> 00:01:33,960
currently<font color="#E5E5E5"> and focus about kernel</font>

19
00:01:29,909 --> 00:01:38,130
security and patenting you can find me

20
00:01:33,960 --> 00:01:48,178
on Twitter<font color="#E5E5E5"> and then listen this is my</font>

21
00:01:38,130 --> 00:01:52,439
Twitter account<font color="#E5E5E5"> about my team the</font>

22
00:01:48,179 --> 00:01:54,530
director of my team is a<font color="#E5E5E5"> younger one of</font>

23
00:01:52,439 --> 00:02:03,210
the most famous tracker in China

24
00:01:54,530 --> 00:02:09,330
<font color="#E5E5E5">yes</font><font color="#CCCCCC"> he's</font><font color="#E5E5E5"> he had achieved away bypass SAR</font>

25
00:02:03,210 --> 00:02:16,200
under DP without ROP<font color="#E5E5E5"> nine years</font><font color="#CCCCCC"> ago he</font>

26
00:02:09,330 --> 00:02:19,440
did so he is world famous in<font color="#CCCCCC"> China that</font>

27
00:02:16,200 --> 00:02:22,440
unreliable<font color="#E5E5E5"> and transient in lab and the</font>

28
00:02:19,440 --> 00:02:26,500
<font color="#CCCCCC">sham lab we all belong to transcend</font>

29
00:02:22,440 --> 00:02:32,079
security joint<font color="#CCCCCC"> lab and</font>

30
00:02:26,500 --> 00:02:37,940
we are<font color="#CCCCCC"> plantain winner 480</font><font color="#E5E5E5"> last year and</font>

31
00:02:32,080 --> 00:02:40,760
we are<font color="#E5E5E5"> hiring anyone wants a job for</font>

32
00:02:37,940 --> 00:02:47,840
security research or just<font color="#CCCCCC"> patenting</font>

33
00:02:40,760 --> 00:02:57,380
<font color="#E5E5E5">please contact me this is a Twitter</font>

34
00:02:47,840 --> 00:03:01,130
account<font color="#E5E5E5"> all making the presentation</font><font color="#CCCCCC"> will</font>

35
00:02:57,380 --> 00:03:05,740
be<font color="#E5E5E5"> divided in two parts first part I</font>

36
00:03:01,130 --> 00:03:11,480
will talk about<font color="#E5E5E5"> the ring z2k subsystem</font>

37
00:03:05,740 --> 00:03:13,940
how to analyze and<font color="#E5E5E5"> how to fuss</font><font color="#CCCCCC"> I think</font>

38
00:03:11,480 --> 00:03:18,619
<font color="#E5E5E5">some</font><font color="#CCCCCC"> or</font><font color="#E5E5E5"> you already know</font><font color="#CCCCCC"> about the Rings</font>

39
00:03:13,940 --> 00:03:21,170
<font color="#CCCCCC">educational system</font><font color="#E5E5E5"> right but I will</font>

40
00:03:18,620 --> 00:03:25,910
introduce server on my<font color="#E5E5E5"> unique</font>

41
00:03:21,170 --> 00:03:28,940
discoveries the second part I will

42
00:03:25,910 --> 00:03:35,720
<font color="#E5E5E5">discuss for vulnerabilities our</font><font color="#CCCCCC"> three</font>

43
00:03:28,940 --> 00:03:41,290
exploits<font color="#CCCCCC"> I have used at last I will</font><font color="#E5E5E5"> show</font>

44
00:03:35,720 --> 00:03:41,290
you a<font color="#E5E5E5"> demo from</font><font color="#CCCCCC"> age</font><font color="#E5E5E5"> get removed system</font>

45
00:03:44,980 --> 00:03:53,540
Vinci 2k<font color="#CCCCCC"> is a huge and complex subsystem</font>

46
00:03:50,050 --> 00:03:58,130
basically it contains two types of

47
00:03:53,540 --> 00:04:03,380
objects<font color="#CCCCCC"> the user object and the GDI</font>

48
00:03:58,130 --> 00:04:05,480
object<font color="#E5E5E5"> if you are familiar with Vinci to</font>

49
00:04:03,380 --> 00:04:11,930
program you will learn<font color="#E5E5E5"> about some</font>

50
00:04:05,480 --> 00:04:15,470
<font color="#CCCCCC">objects such as the window menu it map</font>

51
00:04:11,930 --> 00:04:23,060
the<font color="#E5E5E5"> rest context from the Microsoft</font>

52
00:04:15,470 --> 00:04:25,400
document right but as a<font color="#E5E5E5"> bug hunter we</font>

53
00:04:23,060 --> 00:04:31,340
need to understand<font color="#E5E5E5"> more</font><font color="#CCCCCC"> than the</font>

54
00:04:25,400 --> 00:04:37,400
document a global verbal in<font color="#CCCCCC"> Koerner</font><font color="#E5E5E5"> it</font>

55
00:04:31,340 --> 00:04:43,940
<font color="#CCCCCC">an energy share the info it contains all</font>

56
00:04:37,400 --> 00:04:47,780
the user objects and the infirm and<font color="#CCCCCC"> for</font>

57
00:04:43,940 --> 00:04:57,469
<font color="#E5E5E5">use object the allocation function is hm</font>

58
00:04:47,780 --> 00:05:03,320
a lot object so we look up<font color="#E5E5E5"> the cross</font>

59
00:04:57,470 --> 00:05:06,860
reference of hmm<font color="#E5E5E5"> lock object function we</font>

60
00:05:03,320 --> 00:05:16,250
can<font color="#E5E5E5"> find out almost all</font><font color="#CCCCCC"> the types</font><font color="#E5E5E5"> of</font>

61
00:05:06,860 --> 00:05:21,260
user object similarly as the<font color="#E5E5E5"> user object</font>

62
00:05:16,250 --> 00:05:23,750
<font color="#E5E5E5">a global verbal and cheap and each</font>

63
00:05:21,260 --> 00:05:26,870
<font color="#E5E5E5">manager is in</font><font color="#CCCCCC"> Koerner</font>

64
00:05:23,750 --> 00:05:35,710
it maintains<font color="#CCCCCC"> Lahani</font><font color="#E5E5E5"> infer of all GDI</font>

65
00:05:26,870 --> 00:05:41,710
object and the same has<font color="#E5E5E5"> the user object</font>

66
00:05:35,710 --> 00:05:47,000
we can look up<font color="#E5E5E5"> the reference of locate</font>

67
00:05:41,710 --> 00:05:50,359
object function and the we can get most

68
00:05:47,000 --> 00:06:01,250
<font color="#CCCCCC">all</font><font color="#E5E5E5"> type types of object a vertical</font>

69
00:05:50,360 --> 00:06:09,410
objects<font color="#CCCCCC"> list table</font><font color="#E5E5E5"> show almost all types</font>

70
00:06:01,250 --> 00:06:12,200
of<font color="#E5E5E5"> user object and</font><font color="#CCCCCC"> CDI</font><font color="#E5E5E5"> objects for</font>

71
00:06:09,410 --> 00:06:24,410
window the<font color="#E5E5E5"> P type is one for men with</font>

72
00:06:12,200 --> 00:06:30,340
happiness<font color="#CCCCCC"> - and so now how to fast the</font>

73
00:06:24,410 --> 00:06:36,890
widget<font color="#E5E5E5"> okay subsystem</font><font color="#CCCCCC"> the state only our</font>

74
00:06:30,340 --> 00:06:44,450
shirts right the basic<font color="#E5E5E5"> sort of my father</font>

75
00:06:36,890 --> 00:06:46,550
<font color="#E5E5E5">is fast the relationship first we study</font>

76
00:06:44,450 --> 00:06:53,120
the relationship between<font color="#E5E5E5"> different</font>

77
00:06:46,550 --> 00:07:00,020
objects<font color="#CCCCCC"> and</font><font color="#E5E5E5"> then we find out other</font>

78
00:06:53,120 --> 00:07:04,930
<font color="#E5E5E5">with the relationship and we can do the</font>

79
00:07:00,020 --> 00:07:14,389
operations<font color="#E5E5E5"> retina and at the same time</font>

80
00:07:04,930 --> 00:07:16,610
we modify the state of the<font color="#E5E5E5"> objects if</font>

81
00:07:14,389 --> 00:07:22,939
you have good luck<font color="#E5E5E5"> you can already get</font>

82
00:07:16,610 --> 00:07:29,210
<font color="#CCCCCC">pucks the table shows a</font><font color="#E5E5E5"> server</font>

83
00:07:22,939 --> 00:07:34,639
<font color="#CCCCCC">relationship between server object for</font>

84
00:07:29,210 --> 00:07:39,948
window you can set current window<font color="#CCCCCC"> yes</font>

85
00:07:34,639 --> 00:07:42,879
and for<font color="#E5E5E5"> the competition you can serve</font>

86
00:07:39,949 --> 00:07:54,229
you<font color="#E5E5E5"> can you can remove or replace</font>

87
00:07:42,879 --> 00:07:58,370
children however if you do this job<font color="#CCCCCC"> a</font>

88
00:07:54,229 --> 00:08:01,610
little<font color="#CCCCCC"> longer you may see that</font><font color="#E5E5E5"> it's</font>

89
00:07:58,370 --> 00:08:07,039
getting harder to<font color="#CCCCCC"> find</font><font color="#E5E5E5"> available</font>

90
00:08:01,610 --> 00:08:13,120
<font color="#E5E5E5">whenever it is obviously so many people</font>

91
00:08:07,039 --> 00:08:22,759
had faster wins it<font color="#CCCCCC"> ok</font><font color="#E5E5E5"> already yeah and</font>

92
00:08:13,120 --> 00:08:26,779
some<font color="#E5E5E5"> of them still</font><font color="#CCCCCC"> fighting so we need</font>

93
00:08:22,759 --> 00:08:32,419
some different<font color="#E5E5E5"> point of views</font><font color="#CCCCCC"> well we</font>

94
00:08:26,779 --> 00:08:36,880
must<font color="#E5E5E5"> find some unique attack vectors so</font>

95
00:08:32,419 --> 00:08:36,880
deep digging<font color="#CCCCCC"> a little deeper</font>

96
00:08:42,309 --> 00:08:53,719
if you have deep the<font color="#E5E5E5"> Cisco table between</font>

97
00:08:46,970 --> 00:08:54,940
<font color="#CCCCCC">ante</font><font color="#E5E5E5"> for version and</font><font color="#CCCCCC"> until</font><font color="#E5E5E5"> 2000 you were</font>

98
00:08:53,720 --> 00:09:00,760
fine

99
00:08:54,940 --> 00:09:00,760
some Cisco's disappeared from the<font color="#CCCCCC"> table</font>

100
00:09:01,660 --> 00:09:14,980
where our lease functions now Microsoft

101
00:09:10,240 --> 00:09:14,980
<font color="#CCCCCC">hadn't moved them to a function table</font>

102
00:09:15,310 --> 00:09:26,780
<font color="#E5E5E5">it's</font><font color="#CCCCCC"> named the g AP f n message car in</font>

103
00:09:23,510 --> 00:09:31,430
fact we can call these<font color="#CCCCCC"> functions</font>

104
00:09:26,780 --> 00:09:43,400
directly bypassing<font color="#E5E5E5"> different</font><font color="#CCCCCC"> XP FN proc</font>

105
00:09:31,430 --> 00:09:49,729
parameters the<font color="#E5E5E5"> same you can find another</font>

106
00:09:43,400 --> 00:09:53,510
function table<font color="#CCCCCC"> API FN</font><font color="#E5E5E5"> simple</font><font color="#CCCCCC"> car we can</font>

107
00:09:49,730 --> 00:09:59,230
also occur these functions directly by

108
00:09:53,510 --> 00:09:59,230
passing different XP<font color="#E5E5E5"> FN proc parameters</font>

109
00:09:59,590 --> 00:10:12,320
so my father we're done fighting<font color="#E5E5E5"> deeper</font>

110
00:10:05,780 --> 00:10:16,819
right banana

111
00:10:12,320 --> 00:10:21,800
attack attack of surface yeah you know

112
00:10:16,820 --> 00:10:28,400
about<font color="#CCCCCC"> he</font><font color="#E5E5E5"> if it first discussed roughly</font>

113
00:10:21,800 --> 00:10:32,390
at 2011<font color="#E5E5E5"> year seven years ago the Windows</font>

114
00:10:28,400 --> 00:10:36,920
kernel enabled a mechanism from kernel

115
00:10:32,390 --> 00:10:41,780
mode<font color="#CCCCCC"> Quebec user functions</font><font color="#E5E5E5"> obviously</font>

116
00:10:36,920 --> 00:10:47,569
this mechanism is easy to lead synchrony

117
00:10:41,780 --> 00:10:50,329
issues but so many years<font color="#CCCCCC"> past</font><font color="#E5E5E5"> Microsoft</font>

118
00:10:47,570 --> 00:10:54,760
have passed it<font color="#E5E5E5"> many times can</font><font color="#CCCCCC"> we steer</font>

119
00:10:50,330 --> 00:10:54,760
clear something<font color="#E5E5E5"> for this</font><font color="#CCCCCC"> attack</font><font color="#E5E5E5"> vector</font><font color="#CCCCCC"> I</font>

120
00:10:56,860 --> 00:11:00,220
think we can

121
00:11:06,190 --> 00:11:15,650
let's review<font color="#CCCCCC"> Larry</font><font color="#E5E5E5"> said</font><font color="#CCCCCC"> ok let's</font><font color="#E5E5E5"> steer</font>

122
00:11:12,230 --> 00:11:21,740
many reference of<font color="#E5E5E5"> K use a</font><font color="#CCCCCC"> mold</font><font color="#E5E5E5"> call back</font>

123
00:11:15,650 --> 00:11:29,090
function in which<font color="#E5E5E5"> it</font><font color="#CCCCCC"> okay now how to</font>

124
00:11:21,740 --> 00:11:31,250
find back by code oddity<font color="#CCCCCC"> I think it's</font>

125
00:11:29,090 --> 00:11:35,870
<font color="#CCCCCC">difficult to get</font><font color="#E5E5E5"> backs by called</font>

126
00:11:31,250 --> 00:11:43,160
<font color="#E5E5E5">auditing because</font><font color="#CCCCCC"> 7 years passed many</font>

127
00:11:35,870 --> 00:11:47,570
people already<font color="#E5E5E5"> oddly this code right so</font>

128
00:11:43,160 --> 00:11:53,120
I<font color="#CCCCCC"> choose fatty in their peepees</font>

129
00:11:47,570 --> 00:11:58,240
structure<font color="#CCCCCC"> a feared meant</font><font color="#E5E5E5"> kernel call</font>

130
00:11:53,120 --> 00:12:02,780
back table<font color="#E5E5E5"> it points to a function array</font>

131
00:11:58,240 --> 00:12:09,020
the user mode callback functions we can

132
00:12:02,780 --> 00:12:16,480
hook<font color="#E5E5E5"> some of these functions and the</font>

133
00:12:09,020 --> 00:12:16,480
pure more complex<font color="#E5E5E5"> father let me show you</font>

134
00:12:16,660 --> 00:12:26,900
this is a sample code on my<font color="#E5E5E5"> father when</font>

135
00:12:22,310 --> 00:12:30,619
my<font color="#CCCCCC"> father initialized i hook server</font>

136
00:12:26,900 --> 00:12:35,319
functions of the user from<font color="#CCCCCC"> quebec table</font>

137
00:12:30,620 --> 00:12:43,760
and set then jump into<font color="#E5E5E5"> a common entry</font>

138
00:12:35,320 --> 00:12:47,840
the client callback function and wish

139
00:12:43,760 --> 00:12:52,130
and we need to pay attention<font color="#E5E5E5"> to avoid</font>

140
00:12:47,840 --> 00:12:58,460
repent<font color="#E5E5E5"> release</font><font color="#CCCCCC"> function</font><font color="#E5E5E5"> i too</font><font color="#CCCCCC"> fast link</font>

141
00:12:52,130 --> 00:13:00,200
this<font color="#E5E5E5"> country once again this method</font>

142
00:12:58,460 --> 00:13:05,660
earlier<font color="#E5E5E5"> makes</font>

143
00:13:00,200 --> 00:13:11,260
our<font color="#CCCCCC"> father</font><font color="#E5E5E5"> the it's the execution path</font>

144
00:13:05,660 --> 00:13:11,260
our<font color="#E5E5E5"> father could be very complicated</font>

145
00:13:11,290 --> 00:13:26,540
yeah<font color="#E5E5E5"> so this method can really find</font>

146
00:13:18,580 --> 00:13:32,840
<font color="#E5E5E5">paths but it's a big problem because of</font>

147
00:13:26,540 --> 00:13:37,939
the hooks the<font color="#E5E5E5"> crest step will be</font>

148
00:13:32,840 --> 00:13:41,470
unchecked well<font color="#CCCCCC"> I have to spend a lot of</font>

149
00:13:37,940 --> 00:13:46,130
time for guessing and analysis to

150
00:13:41,470 --> 00:13:50,420
reproduce<font color="#CCCCCC"> these</font><font color="#E5E5E5"> issues and I don't have</font>

151
00:13:46,130 --> 00:13:57,920
<font color="#E5E5E5">a perfect idea for reproduce matter but</font>

152
00:13:50,420 --> 00:14:02,150
it works<font color="#E5E5E5"> but it can find us another</font>

153
00:13:57,920 --> 00:14:07,849
attack vector<font color="#E5E5E5"> maybe no one had mentioned</font>

154
00:14:02,150 --> 00:14:14,329
<font color="#CCCCCC">before my talk the public the public</font>

155
00:14:07,850 --> 00:14:19,250
object then I<font color="#CCCCCC"> observe the chilla</font>

156
00:14:14,330 --> 00:14:26,180
object<font color="#CCCCCC"> honey infer in Connor I</font><font color="#E5E5E5"> noticed</font>

157
00:14:19,250 --> 00:14:33,500
that<font color="#E5E5E5"> some objects have read zero owner</font>

158
00:14:26,180 --> 00:14:39,829
PID it means the object is a public

159
00:14:33,500 --> 00:14:44,810
owned object in fact the object with

160
00:14:39,830 --> 00:14:49,030
<font color="#E5E5E5">zero on a PID usually is created by</font>

161
00:14:44,810 --> 00:14:49,030
<font color="#CCCCCC">Vincey 2k fiber itself</font>

162
00:14:55,680 --> 00:15:03,979
the<font color="#E5E5E5"> Kerner met the cheetah</font><font color="#CCCCCC"> Hannigan</font><font color="#E5E5E5"> for</font>

163
00:14:58,920 --> 00:15:10,670
<font color="#E5E5E5">table to use a space in the</font><font color="#CCCCCC"> PP structure</font>

164
00:15:03,980 --> 00:15:10,670
the GDI shared hand the table<font color="#CCCCCC"> with fear</font>

165
00:15:14,690 --> 00:15:19,980
when Vince we<font color="#CCCCCC"> talked a lot longer</font>

166
00:15:17,520 --> 00:15:23,160
<font color="#CCCCCC">disclosed the corner of J's I</font><font color="#E5E5E5"> would see</font>

167
00:15:19,980 --> 00:15:27,390
the<font color="#CCCCCC"> object but</font><font color="#E5E5E5"> we can still get validly</font>

168
00:15:23,160 --> 00:15:35,610
infer from this table such as the<font color="#E5E5E5"> hand</font>

169
00:15:27,390 --> 00:15:41,310
<font color="#E5E5E5">value and the owner</font><font color="#CCCCCC"> jelly and the track</font>

170
00:15:35,610 --> 00:15:51,990
of the object<font color="#E5E5E5"> so</font><font color="#CCCCCC"> we can search public</font>

171
00:15:41,310 --> 00:15:57,079
owned object from user space this<font color="#E5E5E5"> is a</font>

172
00:15:51,990 --> 00:16:02,339
summary for search public owned palette

173
00:15:57,080 --> 00:16:08,070
for palette<font color="#CCCCCC"> its</font><font color="#E5E5E5"> object type equals to 8</font>

174
00:16:02,339 --> 00:16:11,970
and as such<font color="#E5E5E5"> a--such the GDL table I</font>

175
00:16:08,070 --> 00:16:17,480
<font color="#CCCCCC">searched the TTA info table and the one</font>

176
00:16:11,970 --> 00:16:27,620
I found<font color="#E5E5E5"> our object</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> on a PID still I</font>

177
00:16:17,480 --> 00:16:32,580
add this object<font color="#E5E5E5"> to my 14 list by</font>

178
00:16:27,620 --> 00:16:35,270
<font color="#E5E5E5">fastener public owned object I got some</font>

179
00:16:32,580 --> 00:16:35,270
unique<font color="#CCCCCC"> box</font>

180
00:16:39,980 --> 00:16:56,310
the second part how to<font color="#E5E5E5"> escape from the</font>

181
00:16:45,330 --> 00:16:59,070
late sandbox first I give you a short

182
00:16:56,310 --> 00:17:05,899
briefing about the<font color="#CCCCCC"> eighties cisco field</font>

183
00:16:59,070 --> 00:17:11,100
as the picture shows the<font color="#CCCCCC"> vinci - ok</font>

184
00:17:05,900 --> 00:17:14,579
theater blocked most of<font color="#CCCCCC"> which due to</font>

185
00:17:11,099 --> 00:17:30,149
<font color="#CCCCCC">case</font><font color="#E5E5E5"> ofcourse</font><font color="#CCCCCC"> foreigner 8 content</font>

186
00:17:14,579 --> 00:17:34,169
process<font color="#CCCCCC"> a sleaze picture</font><font color="#E5E5E5"> Microsoft had</font>

187
00:17:30,150 --> 00:17:41,070
implemented<font color="#CCCCCC"> six different tables as the</font>

188
00:17:34,170 --> 00:17:45,300
<font color="#E5E5E5">Vice table filter Cisco should be</font>

189
00:17:41,070 --> 00:17:47,780
blocked or not<font color="#E5E5E5"> according to to the</font>

190
00:17:45,300 --> 00:17:47,780
filter table

191
00:17:53,440 --> 00:18:04,050
now the receipt okay<font color="#E5E5E5"> theater greatly</font>

192
00:17:58,810 --> 00:18:07,480
reduced<font color="#CCCCCC"> the Patek surface from</font><font color="#E5E5E5"> corner so</font>

193
00:18:04,050 --> 00:18:11,580
it's a huge<font color="#E5E5E5"> challenge for breaking this</font>

194
00:18:07,480 --> 00:18:19,380
<font color="#CCCCCC">age</font><font color="#E5E5E5"> sandbox</font><font color="#CCCCCC"> I will introduce three ways</font>

195
00:18:11,580 --> 00:18:22,449
overlays first analyze<font color="#CCCCCC"> the object</font>

196
00:18:19,380 --> 00:18:26,470
<font color="#E5E5E5">operation functions from the unfiltered</font>

197
00:18:22,450 --> 00:18:35,710
<font color="#E5E5E5">the</font><font color="#CCCCCC"> Sisko list and the we</font><font color="#E5E5E5"> can fast</font><font color="#CCCCCC"> list</font>

198
00:18:26,470 --> 00:18:39,490
few objects second abuse<font color="#CCCCCC"> bookmark in</font>

199
00:18:35,710 --> 00:18:49,630
chakra engine to bypass win seat<font color="#CCCCCC"> okay</font>

200
00:18:39,490 --> 00:18:52,780
third it's an interesting bar so fast

201
00:18:49,630 --> 00:19:00,670
dirty brat max graphic kernel driver and

202
00:18:52,780 --> 00:19:06,899
the<font color="#CCCCCC"> CAF</font><font color="#E5E5E5"> available in our abilities the</font>

203
00:19:00,670 --> 00:19:06,900
CVG<font color="#CCCCCC"> twenty-something</font><font color="#E5E5E5"> eight four six file</font>

204
00:19:08,910 --> 00:19:14,850
it's a cruiser<font color="#CCCCCC"> you are free it's a very</font>

205
00:19:11,980 --> 00:19:18,250
good it's a very good<font color="#CCCCCC"> abnormally</font>

206
00:19:14,850 --> 00:19:22,360
discovered by in our<font color="#E5E5E5"> tension security</font>

207
00:19:18,250 --> 00:19:26,530
<font color="#CCCCCC">overton</font><font color="#E5E5E5"> sensitivity manager in</font><font color="#CCCCCC"> line sir</font>

208
00:19:22,360 --> 00:19:31,870
good partner or<font color="#CCCCCC"> making we can review her</font>

209
00:19:26,530 --> 00:19:37,750
<font color="#CCCCCC">proof out from</font><font color="#E5E5E5"> Tesco confess first and</font>

210
00:19:31,870 --> 00:19:43,949
you see all the functions we need for

211
00:19:37,750 --> 00:19:43,950
tricking the park<font color="#CCCCCC"> it's not locked</font>

212
00:19:44,130 --> 00:19:54,870
<font color="#E5E5E5">for default</font><font color="#CCCCCC"> to last year</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> we've had</font>

213
00:19:51,940 --> 00:19:58,350
the useless<font color="#E5E5E5"> park bypassed eight samples</font>

214
00:19:54,870 --> 00:19:58,350
in<font color="#E5E5E5"> control</font>

215
00:20:02,620 --> 00:20:12,739
the suitcase<font color="#CCCCCC"> the root case</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> a spa</font><font color="#E5E5E5"> the</font>

216
00:20:08,870 --> 00:20:18,530
specific flow exists<font color="#E5E5E5"> reading their link</font>

217
00:20:12,740 --> 00:20:21,830
cursor function when a user unlink<font color="#E5E5E5"> a</font>

218
00:20:18,530 --> 00:20:35,350
cursor from<font color="#CCCCCC"> the</font><font color="#E5E5E5"> deep hiding list</font><font color="#CCCCCC"> a user</font>

219
00:20:21,830 --> 00:20:39,260
of free<font color="#CCCCCC"> exists now let's study this case</font>

220
00:20:35,350 --> 00:20:46,159
for a user for<font color="#CCCCCC"> a user for a cursor</font>

221
00:20:39,260 --> 00:20:52,100
object it has<font color="#E5E5E5"> two pointers the head</font>

222
00:20:46,160 --> 00:20:57,350
point and the next point if you linked

223
00:20:52,100 --> 00:21:09,320
<font color="#CCCCCC">to cursors together they will phone or</font>

224
00:20:57,350 --> 00:21:15,909
double link<font color="#E5E5E5"> this value C so the first</font>

225
00:21:09,320 --> 00:21:20,600
step we created two<font color="#E5E5E5"> classes and lik</font><font color="#CCCCCC"> then</font>

226
00:21:15,910 --> 00:21:24,940
the second stop the second step we can

227
00:21:20,600 --> 00:21:29,980
reset the closer to true so true

228
00:21:24,940 --> 00:21:29,980
<font color="#CCCCCC">its head pointer</font><font color="#E5E5E5"> to itself</font>

229
00:21:35,450 --> 00:21:46,650
step<font color="#CCCCCC"> three we destroy because</font><font color="#E5E5E5"> the true</font>

230
00:21:39,570 --> 00:21:51,740
<font color="#CCCCCC">in the next pointer of a</font><font color="#E5E5E5"> course of 18.8</font>

231
00:21:46,650 --> 00:21:56,930
points were freed<font color="#CCCCCC"> cursor</font><font color="#E5E5E5"> yeah</font>

232
00:21:51,740 --> 00:22:06,510
so now the next<font color="#E5E5E5"> point of</font><font color="#CCCCCC"> course</font><font color="#E5E5E5"> of wine</font>

233
00:21:56,930 --> 00:22:12,080
is a<font color="#CCCCCC"> tanking point next when we destroy</font>

234
00:22:06,510 --> 00:22:17,690
because a wine the<font color="#E5E5E5"> corner there</font>

235
00:22:12,080 --> 00:22:28,919
go on to free<font color="#E5E5E5"> the</font><font color="#CCCCCC"> cursor</font><font color="#E5E5E5"> to once again</font>

236
00:22:17,690 --> 00:22:32,580
right<font color="#E5E5E5"> so it's a fog free for use</font><font color="#CCCCCC"> are</font>

237
00:22:28,920 --> 00:22:39,990
free we must know<font color="#E5E5E5"> which part of the</font><font color="#CCCCCC"> free</font>

238
00:22:32,580 --> 00:22:50,639
object to be used<font color="#E5E5E5"> to be reused for</font><font color="#CCCCCC"> this</font>

239
00:22:39,990 --> 00:22:56,720
case we used next point of Kosovo we

240
00:22:50,640 --> 00:23:05,130
reclaim the freed<font color="#E5E5E5"> closet room with the</font>

241
00:22:56,720 --> 00:23:08,430
accelerator table<font color="#E5E5E5"> object and then when</font>

242
00:23:05,130 --> 00:23:15,890
we construct<font color="#E5E5E5"> the fake cursor</font><font color="#CCCCCC"> through</font>

243
00:23:08,430 --> 00:23:20,910
data make its next point point to a

244
00:23:15,890 --> 00:23:25,080
controllable memory when we disk or when

245
00:23:20,910 --> 00:23:30,710
we destroy cursor one<font color="#CCCCCC"> a function H M</font>

246
00:23:25,080 --> 00:23:37,070
<font color="#E5E5E5">mark object destroy the unmodified bit</font>

247
00:23:30,710 --> 00:23:37,070
of a arbitrary<font color="#E5E5E5"> address we specified</font>

248
00:23:41,840 --> 00:23:54,780
now let's put<font color="#E5E5E5"> it together the</font>

249
00:23:48,450 --> 00:23:58,560
<font color="#E5E5E5">exploitation steps is as force first we</font>

250
00:23:54,780 --> 00:24:06,990
<font color="#CCCCCC">link</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> closes</font><font color="#E5E5E5"> and then destroy cursor</font>

251
00:23:58,560 --> 00:24:09,810
<font color="#E5E5E5">to second the spray exert accelerator</font>

252
00:24:06,990 --> 00:24:17,370
<font color="#CCCCCC">paper objects to reclaim their freed</font>

253
00:24:09,810 --> 00:24:23,070
<font color="#CCCCCC">pressure object self step we trigger</font><font color="#E5E5E5"> the</font>

254
00:24:17,370 --> 00:24:29,699
<font color="#CCCCCC">trigger list vulnerability and we can</font>

255
00:24:23,070 --> 00:24:33,629
modify the planet object and we abuse

256
00:24:29,700 --> 00:24:36,740
planet<font color="#CCCCCC"> primitives to gain full access of</font>

257
00:24:33,630 --> 00:24:36,740
<font color="#CCCCCC">Konnor objects</font>

258
00:24:43,660 --> 00:24:54,790
this<font color="#E5E5E5"> button is</font><font color="#CCCCCC"> pressed</font><font color="#E5E5E5"> on June last year</font>

259
00:24:48,900 --> 00:24:59,710
the Microsoft the<font color="#E5E5E5"> leads crates and</font>

260
00:24:54,790 --> 00:25:04,440
precursor functions from AV events in

261
00:24:59,710 --> 00:25:11,980
the<font color="#CCCCCC"> crock table so</font><font color="#E5E5E5"> you cannot create</font>

262
00:25:04,440 --> 00:25:16,710
empty cursor and<font color="#E5E5E5"> a user no longer can</font>

263
00:25:11,980 --> 00:25:16,710
turn a longer link to process at all<font color="#CCCCCC"> a</font>

264
00:25:24,510 --> 00:25:34,450
checkered<font color="#CCCCCC"> bag for bypass means</font><font color="#E5E5E5"> he took a</font>

265
00:25:28,030 --> 00:25:36,760
field<font color="#E5E5E5"> it's a very good</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> Parnassus</font>

266
00:25:34,450 --> 00:25:45,640
is based on rest on<font color="#CCCCCC"> three versions</font>

267
00:25:36,760 --> 00:25:50,379
<font color="#E5E5E5">before</font><font color="#CCCCCC"> september 22nd year</font><font color="#E5E5E5"> review</font><font color="#CCCCCC"> the</font>

268
00:25:45,640 --> 00:25:53,620
code of PS is<font color="#E5E5E5"> when she took a filter in</font>

269
00:25:50,380 --> 00:25:57,340
<font color="#E5E5E5">neighbor the function you were fine the</font>

270
00:25:53,620 --> 00:26:01,840
medications<font color="#CCCCCC"> lag nand in neighbor</font>

271
00:25:57,340 --> 00:26:08,530
<font color="#CCCCCC">filtered means she took</font><font color="#E5E5E5"> a api's what's a</font>

272
00:26:01,840 --> 00:26:15,429
<font color="#E5E5E5">broadly Frommer</font><font color="#CCCCCC"> window</font><font color="#E5E5E5"> stay inside view</font>

273
00:26:08,530 --> 00:26:20,879
inside provisions<font color="#CCCCCC"> 1 5 0 4 8 as</font><font color="#E5E5E5"> well as I</font>

274
00:26:15,430 --> 00:26:30,660
<font color="#CCCCCC">remember each browser enabled out</font><font color="#E5E5E5"> of</font>

275
00:26:20,880 --> 00:26:34,570
process<font color="#CCCCCC"> JIT</font><font color="#E5E5E5"> server the</font><font color="#CCCCCC"> jg server is</font>

276
00:26:30,660 --> 00:26:36,100
introduced as a mitigation against abuse

277
00:26:34,570 --> 00:26:41,610
in JavaScript

278
00:26:36,100 --> 00:26:47,860
<font color="#E5E5E5">JD code</font><font color="#CCCCCC"> bypassed safety but it also</font>

279
00:26:41,610 --> 00:26:51,790
introduced a goodbye<font color="#E5E5E5"> solitaire server</font>

280
00:26:47,860 --> 00:26:56,070
process we found<font color="#E5E5E5"> that the</font><font color="#CCCCCC"> win32 ok field</font>

281
00:26:51,790 --> 00:26:56,070
is not enabled

282
00:26:56,780 --> 00:27:11,810
see<font color="#CCCCCC"> easier so if we can let's go execute</font>

283
00:27:06,680 --> 00:27:21,830
arbitrary code<font color="#E5E5E5"> in no deity process we</font>

284
00:27:11,810 --> 00:27:24,919
can bypass the receipt okay field when I

285
00:27:21,830 --> 00:27:29,679
observe the<font color="#CCCCCC"> hand the user of</font><font color="#E5E5E5"> our</font><font color="#CCCCCC"> age</font>

286
00:27:24,920 --> 00:27:34,510
<font color="#E5E5E5">content process as the as we</font><font color="#CCCCCC"> met shows</font>

287
00:27:29,680 --> 00:27:34,510
the JIT process<font color="#E5E5E5"> ready</font>

288
00:27:34,540 --> 00:27:50,030
<font color="#CCCCCC">6-4 6-4</font><font color="#E5E5E5"> and notice that</font><font color="#CCCCCC"> an</font><font color="#E5E5E5"> age content</font>

289
00:27:43,940 --> 00:27:59,720
process owns<font color="#CCCCCC"> but</font><font color="#E5E5E5"> press first hander but</font>

290
00:27:50,030 --> 00:28:02,960
<font color="#E5E5E5">you see DUP</font><font color="#CCCCCC"> under the process explorer</font>

291
00:27:59,720 --> 00:28:08,480
referred to decode<font color="#CCCCCC"> what a funny info but</font>

292
00:28:02,960 --> 00:28:12,740
what's this why this<font color="#E5E5E5"> handles had</font><font color="#CCCCCC"> the</font>

293
00:28:08,480 --> 00:28:15,340
<font color="#CCCCCC">Yuki vendor permission let's reveal it</font>

294
00:28:12,740 --> 00:28:15,340
chakra code

295
00:28:21,809 --> 00:28:31,178
we read the code out<font color="#E5E5E5"> Jackie client the</font>

296
00:28:27,669 --> 00:28:33,399
refund that<font color="#E5E5E5"> this</font><font color="#CCCCCC"> handle is used for</font>

297
00:28:31,179 --> 00:28:42,340
<font color="#CCCCCC">communication with the jetty server</font>

298
00:28:33,399 --> 00:28:47,020
process and it can be used to<font color="#CCCCCC"> duplicate</font>

299
00:28:42,340 --> 00:29:01,240
a full access process<font color="#CCCCCC"> under</font><font color="#E5E5E5"> from the</font><font color="#CCCCCC"> JIT</font>

300
00:28:47,020 --> 00:29:05,649
<font color="#CCCCCC">server so it's a work of BA the proof of</font>

301
00:29:01,240 --> 00:29:10,049
contest code<font color="#CCCCCC"> is false we just duplicate</font>

302
00:29:05,649 --> 00:29:14,678
a handle<font color="#E5E5E5"> of</font><font color="#CCCCCC"> jetty process and we have</font>

303
00:29:10,049 --> 00:29:20,039
<font color="#CCCCCC">for access permission to jetty server we</font>

304
00:29:14,679 --> 00:29:20,039
just inject shortcode to jetty process

305
00:29:21,600 --> 00:29:28,740
abusing this bug we can bypass which we

306
00:29:25,659 --> 00:29:32,649
took a filter from<font color="#CCCCCC"> each content process</font>

307
00:29:28,740 --> 00:29:42,309
and we<font color="#E5E5E5"> can exploit a</font><font color="#CCCCCC"> widget okay Bob</font>

308
00:29:32,649 --> 00:29:48,360
without restriction now<font color="#CCCCCC"> we should</font><font color="#E5E5E5"> talk</font>

309
00:29:42,309 --> 00:29:51,480
<font color="#CCCCCC">about</font><font color="#E5E5E5"> CVE 2017 eight five eight zero</font>

310
00:29:48,360 --> 00:29:58,899
<font color="#E5E5E5">it's a palatal use</font><font color="#CCCCCC"> are free</font>

311
00:29:51,480 --> 00:30:05,049
it's a good case<font color="#E5E5E5"> I found and</font><font color="#CCCCCC"> it's about</font>

312
00:29:58,899 --> 00:30:11,320
public<font color="#CCCCCC"> GDR object let's reveal the</font><font color="#E5E5E5"> root</font>

313
00:30:05,049 --> 00:30:15,870
cause<font color="#CCCCCC"> all this vulnerability this</font>

314
00:30:11,320 --> 00:30:19,990
function e ng delete<font color="#E5E5E5"> palette it's</font>

315
00:30:15,870 --> 00:30:25,389
<font color="#CCCCCC">defined for print for</font><font color="#E5E5E5"> printer driver and</font>

316
00:30:19,990 --> 00:30:32,820
the display driver you notice that<font color="#E5E5E5"> it</font>

317
00:30:25,390 --> 00:30:32,820
<font color="#E5E5E5">passed a shared lock equal to two</font>

318
00:30:32,940 --> 00:30:38,460
through the arm<font color="#CCCCCC"> with</font><font color="#E5E5E5"> padded function</font>

319
00:30:40,350 --> 00:30:55,449
when<font color="#E5E5E5"> you</font><font color="#CCCCCC"> won the colonel</font><font color="#E5E5E5"> invoking</font><font color="#CCCCCC"> EPA</font>

320
00:30:46,470 --> 00:30:58,390
obj constructor it<font color="#E5E5E5"> auto-lock once so G&G</font>

321
00:30:55,450 --> 00:31:03,610
delete pallet function could be<font color="#E5E5E5"> used to</font>

322
00:30:58,390 --> 00:31:14,910
<font color="#E5E5E5">free a pallet with no with nonzero share</font>

323
00:31:03,610 --> 00:31:21,760
<font color="#CCCCCC">account first</font><font color="#E5E5E5"> we created a pallet</font><font color="#CCCCCC"> surely</font>

324
00:31:14,910 --> 00:31:27,000
the second is<font color="#CCCCCC"> zero</font><font color="#E5E5E5"> right and we select</font>

325
00:31:21,760 --> 00:31:27,000
it<font color="#CCCCCC"> toward east toward the</font><font color="#E5E5E5"> west contest</font>

326
00:31:28,110 --> 00:31:40,469
but my phone<font color="#CCCCCC"> its second is still</font><font color="#E5E5E5"> zero</font>

327
00:31:33,960 --> 00:31:47,610
what's wrong actually the device contest

328
00:31:40,470 --> 00:31:50,760
did not reference pallet directly<font color="#CCCCCC"> 8</font>

329
00:31:47,610 --> 00:31:57,899
referenced with a surface in<font color="#E5E5E5"> kernel and</font>

330
00:31:50,760 --> 00:31:57,900
the surface to the reference<font color="#E5E5E5"> our pallet</font>

331
00:31:59,190 --> 00:32:12,250
so if we<font color="#E5E5E5"> created a device independent</font>

332
00:32:07,210 --> 00:32:17,620
<font color="#E5E5E5">bitmap which lists the</font><font color="#CCCCCC"> rest context the</font>

333
00:32:12,250 --> 00:32:22,000
<font color="#E5E5E5">Kerner will create a public pallet copy</font>

334
00:32:17,620 --> 00:32:27,389
color data from the<font color="#E5E5E5"> pallet we previously</font>

335
00:32:22,000 --> 00:32:34,660
created<font color="#E5E5E5"> list published on the pallet</font>

336
00:32:27,390 --> 00:32:38,260
<font color="#E5E5E5">it's Joe</font><font color="#CCCCCC"> count is 1 now we can search</font>

337
00:32:34,660 --> 00:32:40,480
the<font color="#E5E5E5"> share hundred we can search</font><font color="#CCCCCC"> the GDI</font>

338
00:32:38,260 --> 00:32:45,990
<font color="#E5E5E5">and the table in</font><font color="#CCCCCC"> userspace</font>

339
00:32:40,480 --> 00:32:55,190
and find out the<font color="#E5E5E5"> handiwork of this</font>

340
00:32:45,990 --> 00:33:05,960
public<font color="#E5E5E5"> party pal funny we can delete</font>

341
00:32:55,190 --> 00:33:13,679
this palette and it's what<font color="#E5E5E5"> we get now</font><font color="#CCCCCC"> a</font>

342
00:33:05,960 --> 00:33:20,419
device contest has a point referenced to

343
00:33:13,679 --> 00:33:28,070
a bitmap in Ghana and the<font color="#CCCCCC"> surface a</font>

344
00:33:20,419 --> 00:33:28,070
surface point<font color="#E5E5E5"> reference to freed</font><font color="#CCCCCC"> palek</font>

345
00:33:31,940 --> 00:33:45,120
so let's reuse were freed<font color="#CCCCCC"> pan when you</font>

346
00:33:41,399 --> 00:33:53,580
review the code of GRE<font color="#CCCCCC"> set</font><font color="#E5E5E5"> div color</font>

347
00:33:45,120 --> 00:33:58,020
table<font color="#E5E5E5"> function you can find that the</font>

348
00:33:53,580 --> 00:34:01,559
copy RGB<font color="#CCCCCC"> court function via copy data</font>

349
00:33:58,020 --> 00:34:05,029
from<font color="#CCCCCC"> user memory</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> local table how</font>

350
00:34:01,559 --> 00:34:05,029
palettes object

351
00:34:10,489 --> 00:34:15,729
the<font color="#E5E5E5"> exploit tension steps as follows</font>

352
00:34:16,480 --> 00:34:22,089
first we trigger the vulnerability and

353
00:34:22,510 --> 00:34:32,540
allocate server<font color="#CCCCCC"> mattifier</font><font color="#E5E5E5"> objects to</font>

354
00:34:26,000 --> 00:34:38,560
reclaim memory and then we call the set

355
00:34:32,540 --> 00:34:46,940
<font color="#E5E5E5">Diaby color table and we can get a</font>

356
00:34:38,560 --> 00:34:50,719
actually address<font color="#CCCCCC"> flight abuse in the</font>

357
00:34:46,940 --> 00:34:51,250
<font color="#CCCCCC">back this</font><font color="#E5E5E5"> the chakra duplicate handle</font>

358
00:34:50,719 --> 00:35:02,240
issue

359
00:34:51,250 --> 00:35:05,810
<font color="#E5E5E5">now we can escape</font><font color="#CCCCCC"> from sandbox the</font>

360
00:35:02,240 --> 00:35:10,580
<font color="#E5E5E5">palette used are free first from July</font>

361
00:35:05,810 --> 00:35:16,790
<font color="#CCCCCC">not a</font><font color="#E5E5E5"> year Microsoft</font><font color="#CCCCCC"> just fix the second</font>

362
00:35:10,580 --> 00:35:20,859
past from<font color="#CCCCCC"> ing delayed palette and the</font>

363
00:35:16,790 --> 00:35:26,920
<font color="#E5E5E5">duplicate under either of chakra engine</font>

364
00:35:20,859 --> 00:35:26,920
cladded by<font color="#E5E5E5"> Ivan</font><font color="#CCCCCC"> Fredrik of project error</font>

365
00:35:27,280 --> 00:35:31,410
the president of

366
00:35:29,130 --> 00:35:34,410
<font color="#CCCCCC">Kember another year</font><font color="#E5E5E5"> I was very</font><font color="#CCCCCC"> upset</font>

367
00:35:31,410 --> 00:35:42,420
because I have three good structure

368
00:35:34,410 --> 00:35:45,750
<font color="#CCCCCC">parks in Fez in one day and now the</font>

369
00:35:42,420 --> 00:35:51,000
<font color="#E5E5E5">cha-cha-cha</font><font color="#CCCCCC"> hit process in neighborhood</font>

370
00:35:45,750 --> 00:35:58,440
of Saturday so maybe there's no theater

371
00:35:51,000 --> 00:36:02,160
<font color="#CCCCCC">bypassed any more yesterday</font><font color="#E5E5E5"> at least</font>

372
00:35:58,440 --> 00:36:06,089
conference<font color="#E5E5E5"> check for two researchers</font>

373
00:36:02,160 --> 00:36:07,618
from Microsoft the<font color="#E5E5E5"> Hobart walk the life</font>

374
00:36:06,089 --> 00:36:12,078
and<font color="#E5E5E5"> a</font><font color="#CCCCCC"> death</font>

375
00:36:07,619 --> 00:36:20,519
<font color="#CCCCCC">how can an object abuse yes</font>

376
00:36:12,079 --> 00:36:26,430
they used a terrible<font color="#CCCCCC"> work touch probably</font>

377
00:36:20,519 --> 00:36:30,689
it's true for<font color="#CCCCCC"> wizard for in situ K from</font>

378
00:36:26,430 --> 00:36:33,930
the Windows 10<font color="#CCCCCC"> rest on for Microsoft</font>

379
00:36:30,690 --> 00:36:39,750
introduced<font color="#E5E5E5"> type isolation for which</font><font color="#CCCCCC"> it</font>

380
00:36:33,930 --> 00:36:44,940
<font color="#CCCCCC">ok lease magnatum separate the metadata</font>

381
00:36:39,750 --> 00:36:48,019
from the head of a GDL object and it

382
00:36:44,940 --> 00:36:51,660
surely killed<font color="#E5E5E5"> the public explanation</font>

383
00:36:48,019 --> 00:36:56,848
<font color="#E5E5E5">techniques such as bitmap primitives and</font>

384
00:36:51,660 --> 00:36:59,788
the<font color="#CCCCCC"> palette primitives so for breaking</font>

385
00:36:56,849 --> 00:37:06,990
some<font color="#E5E5E5"> boss the waste from means you to</font>

386
00:36:59,789 --> 00:37:09,509
case very hard what shall<font color="#E5E5E5"> we do now it's</font>

387
00:37:06,990 --> 00:37:17,578
time<font color="#CCCCCC"> to turn out attention to another</font>

388
00:37:09,509 --> 00:37:22,130
<font color="#E5E5E5">subsystem direct X sub system it can</font><font color="#CCCCCC"> be</font>

389
00:37:17,579 --> 00:37:25,619
<font color="#E5E5E5">considered as an extension of</font><font color="#CCCCCC"> midget ok</font>

390
00:37:22,130 --> 00:37:35,369
many<font color="#E5E5E5"> I will</font><font color="#CCCCCC"> direct</font><font color="#E5E5E5"> X kind of functions</font>

391
00:37:25,619 --> 00:37:38,720
are still not<font color="#CCCCCC"> 30 maybe now it's no much</font>

392
00:37:35,369 --> 00:37:42,900
time to talk about<font color="#E5E5E5"> how to faster DirectX</font>

393
00:37:38,720 --> 00:37:52,430
<font color="#CCCCCC">corner so let's</font><font color="#E5E5E5"> review or</font><font color="#CCCCCC"> its</font>

394
00:37:42,900 --> 00:37:59,390
first the CVE<font color="#E5E5E5"> 2018 zero nine seven seven</font>

395
00:37:52,430 --> 00:38:04,109
discovered<font color="#E5E5E5"> by my father when</font><font color="#CCCCCC"> a user</font>

396
00:37:59,390 --> 00:38:07,830
submit a command<font color="#CCCCCC"> to direct external</font>

397
00:38:04,110 --> 00:38:12,260
driver the driver the<font color="#CCCCCC"> notified system</font>

398
00:38:07,830 --> 00:38:19,860
process start a<font color="#CCCCCC"> walker said to execute</font>

399
00:38:12,260 --> 00:38:25,800
the command an untrusted<font color="#E5E5E5"> reference acted</font>

400
00:38:19,860 --> 00:38:30,000
in basic<font color="#E5E5E5"> render if we construct a</font>

401
00:38:25,800 --> 00:38:33,650
special command and submit<font color="#CCCCCC"> via a trick</font>

402
00:38:30,000 --> 00:38:33,650
we will trigger oppressed

403
00:38:41,910 --> 00:38:52,279
and we can control the<font color="#E5E5E5"> RDI with register</font>

404
00:38:46,170 --> 00:38:55,790
and the<font color="#CCCCCC"> i-x register and for God</font>

405
00:38:52,280 --> 00:39:02,610
dispatch I cannot function in<font color="#CCCCCC"> fact</font>

406
00:38:55,790 --> 00:39:10,830
<font color="#CCCCCC">there's no check for register so no</font>

407
00:39:02,610 --> 00:39:20,000
<font color="#CCCCCC">Connor safety for this case so we are</font>

408
00:39:10,830 --> 00:39:24,750
going<font color="#E5E5E5"> to</font><font color="#CCCCCC"> look but it's not easy for know</font>

409
00:39:20,000 --> 00:39:29,060
because the crash is occurred in system

410
00:39:24,750 --> 00:39:35,660
process for system process there's no

411
00:39:29,060 --> 00:39:43,290
user memory<font color="#E5E5E5"> right and we must</font><font color="#CCCCCC"> lay out</font>

412
00:39:35,660 --> 00:39:47,190
data in Connor<font color="#E5E5E5"> what should we do and for</font>

413
00:39:43,290 --> 00:39:52,500
<font color="#CCCCCC">the</font><font color="#E5E5E5"> system process let us know with</font><font color="#CCCCCC"> z2k</font>

414
00:39:47,190 --> 00:39:57,300
<font color="#E5E5E5">objects neither because the wind she</font>

415
00:39:52,500 --> 00:40:07,280
took<font color="#CCCCCC"> an object</font><font color="#E5E5E5"> learn in searching for is</font>

416
00:39:57,300 --> 00:40:10,770
not mapped to system purpose<font color="#E5E5E5"> so I used</font>

417
00:40:07,280 --> 00:40:18,050
<font color="#E5E5E5">her anti objects and he current</font><font color="#CCCCCC"> objects</font>

418
00:40:10,770 --> 00:40:18,050
named pipe to<font color="#E5E5E5"> lay out data in colonel</font>

419
00:40:20,750 --> 00:40:29,970
when I began to rope I set our SP

420
00:40:25,020 --> 00:40:33,840
register point to the partner yeah<font color="#CCCCCC"> when</font>

421
00:40:29,970 --> 00:40:42,899
and pipe<font color="#CCCCCC"> it contains a point point to a</font>

422
00:40:33,840 --> 00:40:47,430
wide stream obviously we need our info

423
00:40:42,900 --> 00:40:51,990
<font color="#CCCCCC">league because we need NT kernel</font><font color="#E5E5E5"> base to</font>

424
00:40:47,430 --> 00:40:54,460
calculate<font color="#CCCCCC"> Katie's address</font><font color="#E5E5E5"> and they need</font>

425
00:40:51,990 --> 00:41:00,970
the provenance<font color="#E5E5E5"> address</font>

426
00:40:54,460 --> 00:41:04,960
I found a very<font color="#CCCCCC"> good</font><font color="#E5E5E5"> color in</font><font color="#CCCCCC"> Phillipe</font>

427
00:41:00,970 --> 00:41:08,129
but it's their own past<font color="#E5E5E5"> so I will not</font>

428
00:41:04,960 --> 00:41:12,490
discuss<font color="#E5E5E5"> the seizure in this speech</font>

429
00:41:08,130 --> 00:41:21,099
anyway<font color="#E5E5E5"> we've had her if</font><font color="#CCCCCC"> Alec already and</font>

430
00:41:12,490 --> 00:41:25,359
let's go<font color="#E5E5E5"> on the exploitation</font><font color="#CCCCCC"> I have</font>

431
00:41:21,099 --> 00:41:31,390
found some gadgets and you see we can

432
00:41:25,359 --> 00:41:37,200
control the<font color="#CCCCCC"> RX</font><font color="#E5E5E5"> latest by our instruction</font>

433
00:41:31,390 --> 00:41:43,799
of classic at<font color="#CCCCCC"> i/o</font><font color="#E5E5E5"> Kovacs function and</font>

434
00:41:37,200 --> 00:41:51,038
then we can set the value<font color="#CCCCCC"> of CX register</font>

435
00:41:43,799 --> 00:41:58,680
and<font color="#E5E5E5"> finally</font><font color="#CCCCCC"> we got a patrol</font><font color="#E5E5E5"> request</font>

436
00:41:51,039 --> 00:42:11,279
<font color="#E5E5E5">right actually</font><font color="#CCCCCC"> ran for kernel exploit</font>

437
00:41:58,680 --> 00:42:17,799
it's<font color="#CCCCCC"> okay so our demo first</font>

438
00:42:11,279 --> 00:42:22,319
we got code execution by<font color="#E5E5E5"> a JD bug inside</font>

439
00:42:17,799 --> 00:42:22,319
<font color="#CCCCCC">soccer engine hot start</font>

440
00:42:33,420 --> 00:42:36,630
very fast

441
00:42:39,200 --> 00:42:42,279
[Applause]

442
00:42:52,360 --> 00:43:03,790
this issue is passed in<font color="#CCCCCC"> must month once</font>

443
00:42:58,360 --> 00:43:08,230
again<font color="#CCCCCC"> cladded</font><font color="#E5E5E5"> by somebody on</font><font color="#CCCCCC"> the</font>

444
00:43:03,790 --> 00:43:12,910
announcement page<font color="#CCCCCC"> of</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> bar</font><font color="#E5E5E5"> Microsoft</font>

445
00:43:08,230 --> 00:43:13,570
made a mistake it's<font color="#E5E5E5"> not</font><font color="#CCCCCC"> a receipt for</font>

446
00:43:12,910 --> 00:43:18,040
<font color="#E5E5E5">Kaiba</font>

447
00:43:13,570 --> 00:43:22,020
I think either<font color="#CCCCCC"> Direct X innovation of</font>

448
00:43:18,040 --> 00:43:22,020
<font color="#E5E5E5">privilege vulnerability</font>

449
00:43:27,000 --> 00:43:34,360
thanks to my<font color="#E5E5E5"> ecologies younger and the</font>

450
00:43:30,520 --> 00:43:40,420
<font color="#CCCCCC">china most</font><font color="#E5E5E5"> of my research is owned</font><font color="#CCCCCC"> italy</font>

451
00:43:34,360 --> 00:43:44,740
<font color="#E5E5E5">and sanction leon pc manager</font><font color="#CCCCCC"> he's a kind</font>

452
00:43:40,420 --> 00:43:48,790
man<font color="#E5E5E5"> and he's a good</font><font color="#CCCCCC"> partner</font><font color="#E5E5E5"> when the</font>

453
00:43:44,740 --> 00:43:51,580
thanks to Henry Lee<font color="#E5E5E5"> on my lap he</font>

454
00:43:48,790 --> 00:43:57,610
provided the chakra exploit which you

455
00:43:51,580 --> 00:44:02,490
just saw a last thanks to Peter of

456
00:43:57,610 --> 00:44:10,900
<font color="#CCCCCC">Kimmel he had did</font><font color="#E5E5E5"> nice job</font><font color="#CCCCCC"> a bodkin</font>

457
00:44:02,490 --> 00:44:19,359
<font color="#CCCCCC">explained</font><font color="#E5E5E5"> before me this is a</font><font color="#CCCCCC"> lute</font>

458
00:44:10,900 --> 00:44:20,920
<font color="#E5E5E5">reference anyone has questions so we are</font>

459
00:44:19,360 --> 00:44:23,850
<font color="#E5E5E5">going to open the questions or the floor</font>

460
00:44:20,920 --> 00:44:33,940
<font color="#E5E5E5">and you won't have any questions for us</font>

461
00:44:23,850 --> 00:44:35,799
<font color="#E5E5E5">yes no</font><font color="#CCCCCC"> I mean he stopped so did I read</font><font color="#E5E5E5"> X</font>

462
00:44:33,940 --> 00:44:38,440
back you showed here is that the one

463
00:44:35,800 --> 00:44:40,990
used in<font color="#CCCCCC"> Pantone 2018</font>

464
00:44:38,440 --> 00:44:42,970
the cursor use<font color="#CCCCCC"> our free</font><font color="#E5E5E5"> yeah look uh sir</font>

465
00:44:40,990 --> 00:44:46,979
you shall<font color="#CCCCCC"> fear we used to</font><font color="#E5E5E5"> yeah and</font><font color="#CCCCCC"> last</font>

466
00:44:42,970 --> 00:44:49,629
year so because in 2018 there<font color="#E5E5E5"> was a</font>

467
00:44:46,980 --> 00:44:54,640
<font color="#E5E5E5">Firefox what Firefox</font><font color="#CCCCCC"> head box was</font>

468
00:44:49,630 --> 00:44:56,370
bypassed using a claimed<font color="#CCCCCC"> win 32k</font><font color="#E5E5E5"> kernel</font>

469
00:44:54,640 --> 00:44:59,049
exploit and I heard it was<font color="#E5E5E5"> the same</font>

470
00:44:56,370 --> 00:45:02,049
vulnerability that you showed here the

471
00:44:59,050 --> 00:45:04,420
DirectX vulnerability<font color="#E5E5E5"> so do I understand</font>

472
00:45:02,050 --> 00:45:07,720
<font color="#CCCCCC">correctly that win32 K lockdown would</font>

473
00:45:04,420 --> 00:45:09,500
not have prevented this

474
00:45:07,720 --> 00:45:13,189
sorry

475
00:45:09,500 --> 00:45:16,040
so the<font color="#E5E5E5"> win32</font><font color="#CCCCCC"> k locked on would not</font><font color="#E5E5E5"> have</font>

476
00:45:13,190 --> 00:45:17,410
prevented the<font color="#E5E5E5"> direct X vulnerability is</font>

477
00:45:16,040 --> 00:45:40,520
that correct

478
00:45:17,410 --> 00:45:44,509
I'm sorry fine<font color="#CCCCCC"> Gia for</font><font color="#E5E5E5"> for Fox</font><font color="#CCCCCC"> it's not</font>

479
00:45:40,520 --> 00:45:47,390
it's<font color="#E5E5E5"> not blocked from</font><font color="#CCCCCC"> Rishi</font><font color="#E5E5E5"> - okay yes</font>

480
00:45:44,510 --> 00:45:49,340
yes<font color="#E5E5E5"> we know the question was</font><font color="#CCCCCC"> for our</font>

481
00:45:47,390 --> 00:45:52,549
question basically<font color="#E5E5E5"> was if we would have</font>

482
00:45:49,340 --> 00:45:54,620
<font color="#E5E5E5">blocked it would it have helped because</font>

483
00:45:52,550 --> 00:45:57,230
<font color="#E5E5E5">we are not blocking it right now we're</font>

484
00:45:54,620 --> 00:45:59,770
<font color="#CCCCCC">having a lot of trouble you feel flawed</font>

485
00:45:57,230 --> 00:46:05,770
for the<font color="#CCCCCC"> race</font><font color="#E5E5E5"> you do kiss</font><font color="#CCCCCC"> ofcourse right</font>

486
00:45:59,770 --> 00:46:10,150
yes you<font color="#E5E5E5"> feel probably I can I think it</font>

487
00:46:05,770 --> 00:46:13,940
<font color="#CCCCCC">cannot reach it took about we appear</font>

488
00:46:10,150 --> 00:46:20,060
<font color="#CCCCCC">relevant from for Center</font><font color="#E5E5E5"> box yeah okay</font>

489
00:46:13,940 --> 00:46:21,980
<font color="#E5E5E5">thanks no questions you guys can be</font>

490
00:46:20,060 --> 00:46:23,960
<font color="#CCCCCC">impersonated ask more questions I</font><font color="#E5E5E5"> will</font>

491
00:46:21,980 --> 00:46:25,620
be<font color="#E5E5E5"> translator for you guys</font><font color="#CCCCCC"> right</font><font color="#E5E5E5"> thank</font>

492
00:46:23,960 --> 00:46:29,540
you

493
00:46:25,620 --> 00:46:29,540
[Applause]

