1
00:00:22,680 --> 00:00:29,250
hi it's good to be back yeah

2
00:00:26,090 --> 00:00:31,740
now that virtual private network becomes

3
00:00:29,250 --> 00:00:34,860
more and more prevalent for enterprise

4
00:00:31,740 --> 00:00:37,290
sslvpn is the most community convenient

5
00:00:34,860 --> 00:00:40,890
way for their employee to access that

6
00:00:37,290 --> 00:00:43,230
cooperation network for hackers is also

7
00:00:40,890 --> 00:00:47,309
the shirt his path to compromise your

8
00:00:43,230 --> 00:00:52,828
intranet so today let's take a look at

9
00:00:47,309 --> 00:00:55,799
how your SSL VPN could be wrong hi an

10
00:00:52,829 --> 00:00:58,949
orange we are from DEFCON is such tea in

11
00:00:55,799 --> 00:01:02,180
Taiwan and our DoD researcher and

12
00:00:58,949 --> 00:01:05,970
focusing on web application security

13
00:01:02,180 --> 00:01:10,500
apart from that and also speaker CTF

14
00:01:05,970 --> 00:01:13,048
prayer and bug bounty hunter hello

15
00:01:10,500 --> 00:01:15,299
everyone Meechum I'm a security

16
00:01:13,049 --> 00:01:18,810
researcher from Def core in our

17
00:01:15,299 --> 00:01:24,090
proceeding he come in 207 CTF team I

18
00:01:18,810 --> 00:01:26,340
mainly focus on binary exploitation here

19
00:01:24,090 --> 00:01:28,650
is the highlights today we wrote is

20
00:01:26,340 --> 00:01:32,060
cross preauth remote code execution and

21
00:01:28,650 --> 00:01:35,010
both fraud in net and pro secure SSL VPN

22
00:01:32,060 --> 00:01:37,520
in the body neck has we will show you

23
00:01:35,010 --> 00:01:40,770
the hot core but reliable binary

24
00:01:37,520 --> 00:01:43,440
exploitation with a magic string to open

25
00:01:40,770 --> 00:01:45,899
the door in a prosecutor

26
00:01:43,440 --> 00:01:48,780
we will presented our parks with hacking

27
00:01:45,900 --> 00:01:51,450
and how we bypass the two-factor

28
00:01:48,780 --> 00:01:54,150
authentication on Twitter and hack into

29
00:01:51,450 --> 00:01:55,940
their mode and hack into their most

30
00:01:54,150 --> 00:01:59,640
important server

31
00:01:55,940 --> 00:02:02,340
last but not least we will introduce how

32
00:01:59,640 --> 00:02:06,090
we leverage a hidden feature to tech

33
00:02:02,340 --> 00:02:10,408
over not only your SSL VPN but also all

34
00:02:06,090 --> 00:02:13,560
of your clients and this is the agenda

35
00:02:10,408 --> 00:02:17,579
we first introduced and sister Vivian

36
00:02:13,560 --> 00:02:20,159
and why we focus on that most of the SSL

37
00:02:17,580 --> 00:02:22,709
VPN don't provide a shell we will

38
00:02:20,159 --> 00:02:25,409
elaborate how we direct the appliance

39
00:02:22,709 --> 00:02:29,370
and introduce the attack vectors to

40
00:02:25,409 --> 00:02:33,540
discover box of course we will have case

41
00:02:29,370 --> 00:02:36,330
studies and demonstration and the last

42
00:02:33,540 --> 00:02:42,500
is the SSL VPN weaponization

43
00:02:36,330 --> 00:02:45,270
recommendations so what is SSL VPN

44
00:02:42,500 --> 00:02:49,500
compared to the site of savvy pians such

45
00:02:45,270 --> 00:02:52,800
as the IPSec and PPTP SSL VPN s'more is

46
00:02:49,500 --> 00:02:56,070
of use and compatible with any Network

47
00:02:52,800 --> 00:03:00,450
environments all you need is just a

48
00:02:56,070 --> 00:03:03,030
browser because of the convenience SSL

49
00:03:00,450 --> 00:03:08,040
VPN becomes the most popular remote

50
00:03:03,030 --> 00:03:10,530
access way for enterprise SSL VPN are

51
00:03:08,040 --> 00:03:13,890
everywhere and protect the corporation

52
00:03:10,530 --> 00:03:17,040
answers from internet exposure there are

53
00:03:13,890 --> 00:03:20,369
trust to be secured and consider as the

54
00:03:17,040 --> 00:03:24,510
only way to your private network but

55
00:03:20,370 --> 00:03:28,380
what if your trusted SSL VPN are

56
00:03:24,510 --> 00:03:35,160
insecure they will become your virtual

57
00:03:28,380 --> 00:03:38,640
public network so sorry so that's why we

58
00:03:35,160 --> 00:03:40,350
focused on SSL VPN they are important

59
00:03:38,640 --> 00:03:43,230
but a blind spot

60
00:03:40,350 --> 00:03:47,370
they are widely used by corporations of

61
00:03:43,230 --> 00:03:50,399
all size but only few lenders dominate

62
00:03:47,370 --> 00:03:53,550
market according to our survey on

63
00:03:50,400 --> 00:03:59,670
fortune 500 the top three SSL VPN

64
00:03:53,550 --> 00:04:02,820
vendors dominate about 75% matured so if

65
00:03:59,670 --> 00:04:06,179
you find a high impact vulnerability and

66
00:04:02,820 --> 00:04:11,430
one of the leading SSL VPN you can hack

67
00:04:06,180 --> 00:04:15,300
the planet the most important is SSL VPN

68
00:04:11,430 --> 00:04:20,340
must be exposed to outside so it must

69
00:04:15,300 --> 00:04:23,400
have direct Internet users to do is

70
00:04:20,339 --> 00:04:28,469
importance even an essay is hunting for

71
00:04:23,400 --> 00:04:31,620
SSL VPN box SSL VPN is trusted by large

72
00:04:28,470 --> 00:04:37,940
corporations industry leaders and tech

73
00:04:31,620 --> 00:04:45,990
giants such as the Facebook Twitter

74
00:04:37,940 --> 00:04:49,350
Marvel even an essay use the sslvpn they

75
00:04:45,990 --> 00:04:52,350
are everywhere but you Gerry forgotten

76
00:04:49,350 --> 00:04:57,300
sometimes even hacker knows your

77
00:04:52,350 --> 00:04:59,220
assistive EPN mole for example we

78
00:04:57,300 --> 00:05:02,070
discuss a pre-owned remote code

79
00:04:59,220 --> 00:05:02,820
execution and power or SSL VPN one month

80
00:05:02,070 --> 00:05:06,380
ago

81
00:05:02,820 --> 00:05:09,780
we find we find a burg acidentally

82
00:05:06,380 --> 00:05:13,860
however highly producing and the latest

83
00:05:09,780 --> 00:05:17,729
version we failed so we started thought

84
00:05:13,860 --> 00:05:19,800
if this is a known vulnerability we

85
00:05:17,730 --> 00:05:23,010
searched all over the internet but

86
00:05:19,800 --> 00:05:26,250
cannot cite anything related there is no

87
00:05:23,010 --> 00:05:29,490
CVE adversary or any official

88
00:05:26,250 --> 00:05:33,810
announcement therefore we believe this

89
00:05:29,490 --> 00:05:36,060
is a silent fixed one day we surveyed

90
00:05:33,810 --> 00:05:39,540
all over the world and fight over

91
00:05:36,060 --> 00:05:43,230
suffered from this so we pro to their

92
00:05:39,540 --> 00:05:47,670
bug bounty program this is that photon

93
00:05:43,230 --> 00:05:50,370
uber they are also the victim we also

94
00:05:47,670 --> 00:05:54,420
report this to the Palo Alto piece third

95
00:05:50,370 --> 00:05:59,490
but we got a following reply they do not

96
00:05:54,420 --> 00:06:01,710
CV items fight internally so that's the

97
00:05:59,490 --> 00:06:07,770
reason why there is no official advice

98
00:06:01,710 --> 00:06:08,430
the read okay this is fine there is no

99
00:06:07,770 --> 00:06:13,620
CVE

100
00:06:08,430 --> 00:06:17,580
so there is no variability anyway hirato

101
00:06:13,620 --> 00:06:22,620
still is sciencv for death just by after

102
00:06:17,580 --> 00:06:25,500
we publish all the story once we decide

103
00:06:22,620 --> 00:06:29,430
to research into sslvpn the next

104
00:06:25,500 --> 00:06:32,450
question is how to choose the target we

105
00:06:29,430 --> 00:06:36,030
did a little survey and leading sslvpn

106
00:06:32,450 --> 00:06:40,170
as you can see even in the high severity

107
00:06:36,030 --> 00:06:44,669
labels dve the pearls cure and 14a are

108
00:06:40,170 --> 00:06:47,450
the most secure one we want to change

109
00:06:44,670 --> 00:06:52,860
the mission impossible so it put our

110
00:06:47,450 --> 00:06:54,930
priority and procedure and 49 model pro

111
00:06:52,860 --> 00:06:57,600
square is the most famous vivianne

112
00:06:54,930 --> 00:07:01,320
solution in the world and has the least

113
00:06:57,600 --> 00:07:02,590
high level CVE trusted by large

114
00:07:01,320 --> 00:07:04,150
corporations

115
00:07:02,590 --> 00:07:06,450
service providers and government

116
00:07:04,150 --> 00:07:10,060
departments

117
00:07:06,450 --> 00:07:13,659
13a is more used by end users a median

118
00:07:10,060 --> 00:07:17,530
size and price is common in Asia and

119
00:07:13,660 --> 00:07:21,010
Europe both vendors have little hi

120
00:07:17,530 --> 00:07:25,690
labels DVDs so our mission is to find a

121
00:07:21,010 --> 00:07:30,219
pre Ostrom oka execution on them so

122
00:07:25,690 --> 00:07:32,550
let's take him to kick-start new

123
00:07:30,220 --> 00:07:35,200
research is always not easy

124
00:07:32,550 --> 00:07:38,350
excessive EPA is the bread box and

125
00:07:35,200 --> 00:07:41,050
crossing source of violence the you jury

126
00:07:38,350 --> 00:07:44,440
build their own application stack from

127
00:07:41,050 --> 00:07:47,860
scratch and don't provide a sure to type

128
00:07:44,440 --> 00:07:50,200
into so the job rack is the essential

129
00:07:47,860 --> 00:07:54,940
step for the researchers to turn the

130
00:07:50,200 --> 00:07:58,030
bread box into the great box as you can

131
00:07:54,940 --> 00:08:02,320
see most of the sslvpn only provide a

132
00:07:58,030 --> 00:08:07,570
restricted show so let's talk about how

133
00:08:02,320 --> 00:08:10,630
to direct them we are not hot well guys

134
00:08:07,570 --> 00:08:11,760
so in star researching from the virtual

135
00:08:10,630 --> 00:08:14,350
priors

136
00:08:11,760 --> 00:08:17,500
all the virtual friends can be

137
00:08:14,350 --> 00:08:21,880
classified into the typical one and the

138
00:08:17,500 --> 00:08:24,640
encrypted one it's trivial for typical

139
00:08:21,880 --> 00:08:27,400
ones so we don't have a lot of time here

140
00:08:24,640 --> 00:08:30,820
you can just enter the single user mode

141
00:08:27,400 --> 00:08:34,350
or a mounted virtual disc on your box to

142
00:08:30,820 --> 00:08:38,760
modify the first instant to get a show

143
00:08:34,350 --> 00:08:42,220
but what if the disk has been encrypted

144
00:08:38,760 --> 00:08:45,790
we saw the booting process we cannot see

145
00:08:42,220 --> 00:08:50,830
anything so today we will show you a

146
00:08:45,790 --> 00:08:53,439
trick to bypass the encryption here is

147
00:08:50,830 --> 00:08:56,560
the leanest booting process the common

148
00:08:53,440 --> 00:08:59,050
way in past to breath encryption is to

149
00:08:56,560 --> 00:09:01,890
analyze and reverse the VN leanness

150
00:08:59,050 --> 00:09:05,740
kernel together encryption key

151
00:09:01,890 --> 00:09:09,640
however with fox will focus on another

152
00:09:05,740 --> 00:09:11,680
stage here we will keep example to show

153
00:09:09,640 --> 00:09:16,189
how memory forensics

154
00:09:11,680 --> 00:09:18,650
tackles to the wing the spin

155
00:09:16,190 --> 00:09:22,250
the booting process is stuff around the

156
00:09:18,650 --> 00:09:24,800
dials boo loader and the kernel to drop

157
00:09:22,250 --> 00:09:28,280
the first process to initialize the

158
00:09:24,800 --> 00:09:31,459
operating system in post cure the

159
00:09:28,280 --> 00:09:34,640
initial process show your prompt press

160
00:09:31,460 --> 00:09:38,740
enter to view or update your apprised

161
00:09:34,640 --> 00:09:41,960
settings and once you press the enter

162
00:09:38,740 --> 00:09:45,170
the initial process sprout another

163
00:09:41,960 --> 00:09:48,980
process to allow you modify and view the

164
00:09:45,170 --> 00:09:53,180
settings okay will you suspend the

165
00:09:48,980 --> 00:09:55,520
virtual machine at this time and scan

166
00:09:53,180 --> 00:09:59,810
the entire memory to do the memory

167
00:09:55,520 --> 00:10:03,050
forensics on the host OS from the memory

168
00:09:59,810 --> 00:10:06,859
forensics we observed that the spouts

169
00:10:03,050 --> 00:10:10,520
process is a Perl script the nen is PS

170
00:10:06,860 --> 00:10:12,920
config the pierrot and since it can be

171
00:10:10,520 --> 00:10:17,110
the weak point of holder booting

172
00:10:12,920 --> 00:10:20,990
processes so it's time to show the magic

173
00:10:17,110 --> 00:10:25,070
we will just patch of few bytes to pop

174
00:10:20,990 --> 00:10:28,490
out of shell we patch the memory and

175
00:10:25,070 --> 00:10:32,450
repress the PS convict to Piero to ping

176
00:10:28,490 --> 00:10:35,540
SH once that once the modification is

177
00:10:32,450 --> 00:10:40,880
done the only thing we need is just for

178
00:10:35,540 --> 00:10:43,189
us to enter and we gotta show now we

179
00:10:40,880 --> 00:10:45,939
have the flow control of those things

180
00:10:43,190 --> 00:10:50,960
turn and can do further debugging and

181
00:10:45,940 --> 00:10:52,520
analyzing okay so now we can start

182
00:10:50,960 --> 00:10:55,790
having SSL Vivian's

183
00:10:52,520 --> 00:10:57,560
but where is the puck there are many

184
00:10:55,790 --> 00:10:59,660
demons from the other server

185
00:10:57,560 --> 00:11:02,719
they are usually complicated and hard to

186
00:10:59,660 --> 00:11:07,130
analyze being at the correct place is

187
00:11:02,720 --> 00:11:11,089
important for us so we propose an attack

188
00:11:07,130 --> 00:11:13,820
vectors specific for SSL VPN but talk

189
00:11:11,089 --> 00:11:16,460
about a special feature called web VPN

190
00:11:13,820 --> 00:11:19,460
it's powerful but also vulnerable

191
00:11:16,460 --> 00:11:24,410
sometimes we got lots of bounty from

192
00:11:19,460 --> 00:11:26,600
this feature is just like our ATM the

193
00:11:24,410 --> 00:11:29,900
next one is the native script language

194
00:11:26,600 --> 00:11:30,860
extensions SSL Vivian's and how they can

195
00:11:29,900 --> 00:11:33,050
be

196
00:11:30,860 --> 00:11:37,610
and we also introduced some modular

197
00:11:33,050 --> 00:11:40,459
architecture problems well VPN is a

198
00:11:37,610 --> 00:11:43,520
convenient proxy feature it's possible

199
00:11:40,460 --> 00:11:45,830
in Kyler's it practice all kinds of

200
00:11:43,520 --> 00:11:48,319
traffic's to the web browser

201
00:11:45,830 --> 00:11:53,000
it's approached various protocols like

202
00:11:48,320 --> 00:11:55,580
HTTP FTP and RDP it also handles many

203
00:11:53,000 --> 00:11:59,390
web resources such as WebSocket

204
00:11:55,580 --> 00:12:01,940
JavaScript and flash we don't need to

205
00:11:59,390 --> 00:12:04,189
install any software only click on the

206
00:12:01,940 --> 00:12:07,930
browser and we can connect you other

207
00:12:04,190 --> 00:12:10,820
services sounds powerful right

208
00:12:07,930 --> 00:12:14,359
apparently it's not easy to implement

209
00:12:10,820 --> 00:12:16,850
this feature some vendors choose to

210
00:12:14,360 --> 00:12:19,730
implement by themselves however

211
00:12:16,850 --> 00:12:22,880
protocols and web resources handling are

212
00:12:19,730 --> 00:12:26,510
prone to memory parks think about SSL

213
00:12:22,880 --> 00:12:30,140
VPN processing SMP or flash you know how

214
00:12:26,510 --> 00:12:33,530
hard it could be also list requests high

215
00:12:30,140 --> 00:12:36,260
security awareness for example with file

216
00:12:33,530 --> 00:12:39,050
some debug functions sensitive data

217
00:12:36,260 --> 00:12:43,970
without encryption and information

218
00:12:39,050 --> 00:12:46,670
exposed carelessly some vendors decided

219
00:12:43,970 --> 00:12:50,210
not to reinvent the wheel they modify

220
00:12:46,670 --> 00:12:54,040
from an open source project directly but

221
00:12:50,210 --> 00:12:56,570
they copy the code and also caveat bugs

222
00:12:54,040 --> 00:13:01,400
this kind of software are hard to

223
00:12:56,570 --> 00:13:04,460
maintain update or patch or some vendors

224
00:13:01,400 --> 00:13:07,340
choose to call existing libraries but

225
00:13:04,460 --> 00:13:10,490
the vendors are often neglect to update

226
00:13:07,340 --> 00:13:15,130
these libraries we found Live Crew and

227
00:13:10,490 --> 00:13:17,750
David CL from over 10 years ago

228
00:13:15,130 --> 00:13:20,810
implementing web VPN is really not easy

229
00:13:17,750 --> 00:13:24,670
this is the most serious attack vectors

230
00:13:20,810 --> 00:13:24,670
we found on the SSL VPN

231
00:13:24,880 --> 00:13:29,990
during our research we found that most

232
00:13:27,740 --> 00:13:32,960
asoto Vivien's have their own native

233
00:13:29,990 --> 00:13:36,440
script language extensions like PHP

234
00:13:32,960 --> 00:13:40,520
extensions returning c or pretension

235
00:13:36,440 --> 00:13:43,190
reasoning C++ vendors like to use these

236
00:13:40,520 --> 00:13:45,850
extensions to do encoding decoding in

237
00:13:43,190 --> 00:13:49,580
other operations to improve efficiency

238
00:13:45,850 --> 00:13:51,290
which may be vulnerable in its really

239
00:13:49,580 --> 00:13:55,220
prone to type confusion between

240
00:13:51,290 --> 00:13:59,060
different languages as we know string

241
00:13:55,220 --> 00:14:02,300
operation is always difficult for C like

242
00:13:59,060 --> 00:14:05,329
parasites calculation tendrils functions

243
00:14:02,300 --> 00:14:09,770
such as drink coffee or misunderstood

244
00:14:05,330 --> 00:14:12,200
functions for example do you really know

245
00:14:09,770 --> 00:14:17,740
how the return value of s entering F

246
00:14:12,200 --> 00:14:17,740
should be can it exceed the parasite

247
00:14:17,860 --> 00:14:25,510
actually it's possible so calculations

248
00:14:21,170 --> 00:14:28,370
like this will cause an integer overflow

249
00:14:25,510 --> 00:14:29,290
the type of these extensions are also

250
00:14:28,370 --> 00:14:32,270
confusing

251
00:14:29,290 --> 00:14:34,160
although they seems to sin but do you

252
00:14:32,270 --> 00:14:38,470
really know what time it is

253
00:14:34,160 --> 00:14:40,040
or do you know if you are using safely

254
00:14:38,470 --> 00:14:44,690
who knows

255
00:14:40,040 --> 00:14:46,550
and this may cause serious problems the

256
00:14:44,690 --> 00:14:49,400
last one is the modular architecture

257
00:14:46,550 --> 00:14:51,800
problems when there are different

258
00:14:49,400 --> 00:14:55,100
standards for processing the same thing

259
00:14:51,800 --> 00:14:58,939
the inconsistency between them will lead

260
00:14:55,100 --> 00:15:01,820
to problems such as the attack surface

261
00:14:58,940 --> 00:15:04,970
surface our reverse proxy and Java web

262
00:15:01,820 --> 00:15:09,370
back end the talk from orange in back

263
00:15:04,970 --> 00:15:13,250
last year and here we give another case

264
00:15:09,370 --> 00:15:16,370
this is also an SS control bypass it's

265
00:15:13,250 --> 00:15:19,910
an SI webserver and risk forward back

266
00:15:16,370 --> 00:15:23,870
end the river it's version that plus

267
00:15:19,910 --> 00:15:27,319
matches too much so we can little is too

268
00:15:23,870 --> 00:15:32,240
much the data / - SS the privileged

269
00:15:27,320 --> 00:15:34,870
pages okay so here's the special attack

270
00:15:32,240 --> 00:15:38,000
vectors we found only SS or VPNs

271
00:15:34,870 --> 00:15:41,000
following we're going to talk about two

272
00:15:38,000 --> 00:15:44,330
case studies we will show how we get

273
00:15:41,000 --> 00:15:49,400
prios remote code execution frozen 8 and

274
00:15:44,330 --> 00:15:51,470
po secure and here is the disclaimer all

275
00:15:49,400 --> 00:15:54,260
the CVS mentioned below have been

276
00:15:51,470 --> 00:15:56,210
reported and touched by a fruity net for

277
00:15:54,260 --> 00:15:59,840
secure and Twitter

278
00:15:56,210 --> 00:16:02,930
and some hackers have published exploits

279
00:15:59,840 --> 00:16:05,450
and it's being used in the world so

280
00:16:02,930 --> 00:16:10,699
please go update your SSO Vivien's as

281
00:16:05,450 --> 00:16:13,610
soon as possible look this one is for

282
00:16:10,700 --> 00:16:16,820
the gate with virtual break law for

283
00:16:13,610 --> 00:16:20,060
decades in looking to luminaries we try

284
00:16:16,820 --> 00:16:22,310
to list the binary sinks - Bing and FAL

285
00:16:20,060 --> 00:16:25,400
they're all symbolic links point to

286
00:16:22,310 --> 00:16:29,989
stemming stashing needs just like this

287
00:16:25,400 --> 00:16:32,780
disk snapshot first guy compels all the

288
00:16:29,990 --> 00:16:33,710
programs and configurations into one

289
00:16:32,780 --> 00:16:36,410
single binary

290
00:16:33,710 --> 00:16:40,130
this makes the any program really huge

291
00:16:36,410 --> 00:16:43,699
and annoying the IDB file of in need is

292
00:16:40,130 --> 00:16:46,790
up to 500 megabytes with 85,000

293
00:16:43,700 --> 00:16:47,740
functions and they are all stripped no

294
00:16:46,790 --> 00:16:51,589
symbol

295
00:16:47,740 --> 00:16:54,080
it contains plenty of function tables to

296
00:16:51,590 --> 00:16:57,680
manage each program including a web

297
00:16:54,080 --> 00:17:00,170
daemon through our investigation we

298
00:16:57,680 --> 00:17:04,429
found the web surf the web service is

299
00:17:00,170 --> 00:17:08,270
modified from a patch but it's the part

300
00:17:04,430 --> 00:17:11,900
from 2002 so the web server running

301
00:17:08,270 --> 00:17:16,819
under SSL VPN is actually as old as your

302
00:17:11,900 --> 00:17:19,400
grandmother compared to the admin page

303
00:17:16,819 --> 00:17:22,010
the user logging interface is the only

304
00:17:19,400 --> 00:17:25,970
one that definitely exposed to the

305
00:17:22,010 --> 00:17:29,150
Internet it looks like this it's a

306
00:17:25,970 --> 00:17:32,330
simple looking page no other patterns or

307
00:17:29,150 --> 00:17:35,710
functions so we're gonna expose through

308
00:17:32,330 --> 00:17:38,270
this interface with our authentication

309
00:17:35,710 --> 00:17:40,990
we will talk about three packs today

310
00:17:38,270 --> 00:17:44,590
first is the Rios remote code execution

311
00:17:40,990 --> 00:17:47,660
chin we combine two pucks

312
00:17:44,590 --> 00:17:51,280
oprius actually fell reading to logging

313
00:17:47,660 --> 00:17:54,110
and Apostleship overflow together still

314
00:17:51,280 --> 00:17:57,950
we also introduced an interesting bug

315
00:17:54,110 --> 00:18:03,229
it's a magic factor which can modify any

316
00:17:57,950 --> 00:18:05,890
user's password with a magic key now

317
00:18:03,230 --> 00:18:07,750
star with the ferreting part

318
00:18:05,890 --> 00:18:10,960
it's a function used to show

319
00:18:07,750 --> 00:18:12,850
corresponding language for users in

320
00:18:10,960 --> 00:18:16,990
concatenate strings directly

321
00:18:12,850 --> 00:18:20,469
we followed a Tartar slash filter but is

322
00:18:16,990 --> 00:18:22,690
an extension appended automatically so

323
00:18:20,470 --> 00:18:26,679
it's things like we can only read you

324
00:18:22,690 --> 00:18:31,230
some files think about it can we remove

325
00:18:26,679 --> 00:18:31,230
the Jason and read any file we want

326
00:18:32,280 --> 00:18:39,370
there is list yes we can utilize the

327
00:18:35,679 --> 00:18:42,429
feature of SM printf a current to the

328
00:18:39,370 --> 00:18:46,570
main page it writes at most times minus

329
00:18:42,429 --> 00:18:48,790
one the parasite is fixed here so we

330
00:18:46,570 --> 00:18:53,350
only need to make it exceeds the barber

331
00:18:48,790 --> 00:18:57,100
size like this with very obvious lashes

332
00:18:53,350 --> 00:19:01,750
so the past after a centering F becomes

333
00:18:57,100 --> 00:19:04,389
like this low panda Jason exceeds the

334
00:19:01,750 --> 00:19:07,390
bar size and it's tripped by the

335
00:19:04,390 --> 00:19:12,130
assembling F then we can read any file

336
00:19:07,390 --> 00:19:14,919
we want after getting approval reading

337
00:19:12,130 --> 00:19:17,770
we found something interesting we call

338
00:19:14,919 --> 00:19:20,049
it in a Cell Vivien mystery it appears

339
00:19:17,770 --> 00:19:23,679
in many products not only for the gate

340
00:19:20,049 --> 00:19:26,918
but also for secure or other vendors the

341
00:19:23,679 --> 00:19:29,970
mystery is left hold and excessively

342
00:19:26,919 --> 00:19:33,040
details certain file on the sslvpn

343
00:19:29,970 --> 00:19:36,669
the file is called SSL VPN web session

344
00:19:33,040 --> 00:19:43,290
what's the content station token of

345
00:19:36,669 --> 00:19:47,049
course I feel just sure username indeed

346
00:19:43,290 --> 00:19:49,480
20x password are you kidding

347
00:19:47,049 --> 00:19:52,150
you should never store anything hex

348
00:19:49,480 --> 00:19:55,450
password we really wonder how this

349
00:19:52,150 --> 00:20:02,350
become popular let me guess maybe the

350
00:19:55,450 --> 00:20:04,720
third it from Google sorry sorry okay

351
00:20:02,350 --> 00:20:07,409
maybe learning from Google or Facebook

352
00:20:04,720 --> 00:20:10,270
or Twitter

353
00:20:07,410 --> 00:20:12,340
anyway this pin has password are really

354
00:20:10,270 --> 00:20:15,270
convenient we don't need to crack

355
00:20:12,340 --> 00:20:18,370
password anymore and we can login easy

356
00:20:15,270 --> 00:20:19,600
today we're going to utilize the web if

357
00:20:18,370 --> 00:20:21,979
you have a future

358
00:20:19,600 --> 00:20:26,060
as you can see it supports many

359
00:20:21,980 --> 00:20:28,460
protocols that try the HEV we only need

360
00:20:26,060 --> 00:20:33,169
to type the URL and we can connect to

361
00:20:28,460 --> 00:20:35,420
the websites through where BBN and look

362
00:20:33,170 --> 00:20:38,630
at that URL we can see that we're still

363
00:20:35,420 --> 00:20:43,340
connecting to SSL VPN so it proxies the

364
00:20:38,630 --> 00:20:46,250
whole website for us and if we look into

365
00:20:43,340 --> 00:20:49,550
other elements we can find the URL of

366
00:20:46,250 --> 00:20:52,970
resources are also from SSL VPN it

367
00:20:49,550 --> 00:20:55,280
rewrites all URLs for us as you can

368
00:20:52,970 --> 00:20:59,260
imagine this involving heavy string

369
00:20:55,280 --> 00:21:02,360
operation so here is the Ebola flow

370
00:20:59,260 --> 00:21:04,760
it occurs in JavaScript parsing and

371
00:21:02,360 --> 00:21:10,040
extremely because they can check while

372
00:21:04,760 --> 00:21:13,370
memory copy the buffer is only 0x 2004

373
00:21:10,040 --> 00:21:16,430
the input string is unlimited generally

374
00:21:13,370 --> 00:21:18,889
we do some hip phone straight to or for

375
00:21:16,430 --> 00:21:22,460
a nice target and controller program

376
00:21:18,890 --> 00:21:25,060
counter difficult execution but the

377
00:21:22,460 --> 00:21:29,360
situation is difficult in for the gate

378
00:21:25,060 --> 00:21:31,790
we face something destabilizing first of

379
00:21:29,360 --> 00:21:35,600
all the web daemon handles connection

380
00:21:31,790 --> 00:21:38,720
with Ipoh so it's a single fear process

381
00:21:35,600 --> 00:21:41,360
and the main process and libraries use

382
00:21:38,720 --> 00:21:44,180
the same heave it means the all-america

383
00:21:41,360 --> 00:21:47,479
location of all the operations in all

384
00:21:44,180 --> 00:21:52,280
the connections are 17th so he is really

385
00:21:47,480 --> 00:21:56,060
unstable moreover there are some

386
00:21:52,280 --> 00:21:58,250
operations really triggers link a feel

387
00:21:56,060 --> 00:21:59,889
and heap arrangement and it's

388
00:21:58,250 --> 00:22:02,360
uncontrollable

389
00:21:59,890 --> 00:22:03,020
therefore we cannot arrange the heap

390
00:22:02,360 --> 00:22:06,189
allocation

391
00:22:03,020 --> 00:22:08,860
carefully that will just make a mess and

392
00:22:06,190 --> 00:22:11,510
there's nothing even more ironic

393
00:22:08,860 --> 00:22:14,360
approach implements and additional

394
00:22:11,510 --> 00:22:18,500
memory management so there is no free

395
00:22:14,360 --> 00:22:22,000
until the connection end we cannot

396
00:22:18,500 --> 00:22:25,070
arrange a heap in a single connection

397
00:22:22,000 --> 00:22:28,580
the locator also limits our export is

398
00:22:25,070 --> 00:22:31,340
called je malloc is centralized small

399
00:22:28,580 --> 00:22:32,639
objects and maintains these objects with

400
00:22:31,340 --> 00:22:34,379
a bitmap

401
00:22:32,640 --> 00:22:36,510
this effectively reduces the

402
00:22:34,380 --> 00:22:40,220
interference between small and large

403
00:22:36,510 --> 00:22:43,320
objects it also limits our sake options

404
00:22:40,220 --> 00:22:47,490
it's hard to put small objects nearby

405
00:22:43,320 --> 00:22:50,809
our buffer so we're stuck at a time and

406
00:22:47,490 --> 00:22:55,200
therefore it started too fast the server

407
00:22:50,809 --> 00:23:00,090
and it crushed and we almost control a

408
00:22:55,200 --> 00:23:05,280
program counter and yeah this is why we

409
00:23:00,090 --> 00:23:08,100
love passing we crush a function table

410
00:23:05,280 --> 00:23:10,799
for entering an SSL structure the

411
00:23:08,100 --> 00:23:13,230
structure stores information of each SSL

412
00:23:10,799 --> 00:23:15,870
connection it's used for connection

413
00:23:13,230 --> 00:23:19,559
handling and it's an ideal target for

414
00:23:15,870 --> 00:23:21,959
all he'll exploit first every new

415
00:23:19,559 --> 00:23:25,340
connection locates in a sense of

416
00:23:21,960 --> 00:23:28,260
structure so we can trigger it easy and

417
00:23:25,340 --> 00:23:30,659
it's slice is close to all JavaScript

418
00:23:28,260 --> 00:23:33,860
buffer and therefore it can be placed

419
00:23:30,660 --> 00:23:37,049
nearby our buffer with a regular offset

420
00:23:33,860 --> 00:23:40,620
the most important is it has some useful

421
00:23:37,049 --> 00:23:43,290
structure members it contains of

422
00:23:40,620 --> 00:23:46,229
function table pointer code method and

423
00:23:43,290 --> 00:23:48,720
this is how we trigger the crush but

424
00:23:46,230 --> 00:23:50,160
with pal one even better it's a function

425
00:23:48,720 --> 00:23:53,400
pointer called

426
00:23:50,160 --> 00:23:56,070
handshake function with this the exploit

427
00:23:53,400 --> 00:23:57,240
can be much easier we don't need a whole

428
00:23:56,070 --> 00:24:01,168
function table anymore

429
00:23:57,240 --> 00:24:03,150
we only need a functional address we

430
00:24:01,169 --> 00:24:05,549
cannot arrange a heap in a single

431
00:24:03,150 --> 00:24:08,070
connection but we can miss up the

432
00:24:05,549 --> 00:24:11,580
connections and spray the excess of

433
00:24:08,070 --> 00:24:14,939
structures in this way we can over

434
00:24:11,580 --> 00:24:17,399
folder SS structures easily so we send

435
00:24:14,940 --> 00:24:19,650
lots of normal requests in attack the

436
00:24:17,400 --> 00:24:25,140
server with an overflow request in the

437
00:24:19,650 --> 00:24:29,040
meantime for example here we build 3G

438
00:24:25,140 --> 00:24:32,429
connections so the program locates three

439
00:24:29,040 --> 00:24:36,178
SS of structures on heap in the SS all

440
00:24:32,429 --> 00:24:38,850
structure is like this some basic

441
00:24:36,179 --> 00:24:41,040
information in the function table and

442
00:24:38,850 --> 00:24:44,790
the function pointer is now pointing to

443
00:24:41,040 --> 00:24:46,050
SSL stepped now if we trigger a

444
00:24:44,790 --> 00:24:49,420
JavaScript

445
00:24:46,050 --> 00:24:53,280
and the jobs we prefer is allocated

446
00:24:49,420 --> 00:24:56,650
ahead of these distances all structures

447
00:24:53,280 --> 00:24:58,960
then we can trigger overflow in over

448
00:24:56,650 --> 00:25:04,450
riser excessive structural members like

449
00:24:58,960 --> 00:25:07,120
this so now we fill up the essence of

450
00:25:04,450 --> 00:25:08,110
structures we have no ace and make the

451
00:25:07,120 --> 00:25:12,719
program crashes

452
00:25:08,110 --> 00:25:15,760
then how we need to do is neck is clear

453
00:25:12,720 --> 00:25:18,160
we only need to forge a correct answer

454
00:25:15,760 --> 00:25:22,360
cell structure with a fake function

455
00:25:18,160 --> 00:25:24,250
pointer like the urges of system so when

456
00:25:22,360 --> 00:25:26,709
the victim connection is trying to do

457
00:25:24,250 --> 00:25:28,710
handshake the program executes however

458
00:25:26,710 --> 00:25:32,170
we want

459
00:25:28,710 --> 00:25:34,480
anyway the hem is unstable so we need to

460
00:25:32,170 --> 00:25:36,940
stand fuzzy connections to miss the

461
00:25:34,480 --> 00:25:38,200
condition the server make has downtime

462
00:25:36,940 --> 00:25:41,470
but it's fine

463
00:25:38,200 --> 00:25:43,480
first gate has a reliable watchdog we

464
00:25:41,470 --> 00:25:48,370
just need several attempts thinking

465
00:25:43,480 --> 00:25:50,440
about 1 to 2 minutes and get a show so

466
00:25:48,370 --> 00:25:53,560
this is the whole details of how we

467
00:25:50,440 --> 00:25:55,360
achieve remote code execution maybe some

468
00:25:53,560 --> 00:25:58,300
of you are not binary guys and you may

469
00:25:55,360 --> 00:26:03,280
wonder if there is there any other way

470
00:25:58,300 --> 00:26:07,570
to get into the server so when I find

471
00:26:03,280 --> 00:26:10,230
another tour to make your life easier we

472
00:26:07,570 --> 00:26:13,210
found a magic factor in the donking page

473
00:26:10,230 --> 00:26:16,180
this function was originally used to

474
00:26:13,210 --> 00:26:18,880
update updated password however they

475
00:26:16,180 --> 00:26:21,010
fail to authenticate so we can simply

476
00:26:18,880 --> 00:26:26,350
use this secret key which is called

477
00:26:21,010 --> 00:26:28,510
magic to reset any user's password and

478
00:26:26,350 --> 00:26:33,899
now we're going to demonstrate how a pop

479
00:26:28,510 --> 00:26:33,900
Arusha from the only expose and CVS port

480
00:26:35,610 --> 00:26:43,899
ok we put our PHP exploit on HDTV server

481
00:26:40,210 --> 00:26:46,660
and this is our exploit in order to

482
00:26:43,900 --> 00:26:49,840
control a parameter of season refers to

483
00:26:46,660 --> 00:26:53,290
a stack pivot and make our buffer become

484
00:26:49,840 --> 00:26:56,010
the stack after that we do an origin to

485
00:26:53,290 --> 00:26:56,010
call system

486
00:26:57,000 --> 00:27:08,190
and here is the reverse yokomen we use

487
00:26:59,610 --> 00:27:11,189
poison to build a reverse show and we

488
00:27:08,190 --> 00:27:18,539
connect concatenates these drinks to

489
00:27:11,190 --> 00:27:22,020
overflow excessive structure okay now we

490
00:27:18,539 --> 00:27:29,039
can start hacking in the first panel we

491
00:27:22,020 --> 00:27:31,260
open up port to receive the reversal and

492
00:27:29,039 --> 00:27:33,870
we start of fighting threat to build

493
00:27:31,260 --> 00:27:39,720
multiple normal connections and spray

494
00:27:33,870 --> 00:27:43,139
the instance of structures then we

495
00:27:39,720 --> 00:27:46,289
attack the server we first try to lick

496
00:27:43,140 --> 00:27:55,440
username and ten hex password from the

497
00:27:46,289 --> 00:28:03,960
web session as you can see we found a

498
00:27:55,440 --> 00:28:07,130
username and password is password for me

499
00:28:03,960 --> 00:28:10,049
we can use this account to looking in

500
00:28:07,130 --> 00:28:13,530
mixer instead of even proxy our PHP

501
00:28:10,049 --> 00:28:16,129
exploit we only need to wait for of few

502
00:28:13,530 --> 00:28:16,129
seconds

503
00:28:18,559 --> 00:28:33,899
okay here we call the root shell thank

504
00:28:21,390 --> 00:28:36,630
you very much the next case we talk

505
00:28:33,900 --> 00:28:39,600
about is purse cure first queue is the

506
00:28:36,630 --> 00:28:43,110
market leader of SSO Vivian and was for

507
00:28:39,600 --> 00:28:46,139
a divestiture of Juniper Networks they

508
00:28:43,110 --> 00:28:49,408
are Pro lover and big old architecture

509
00:28:46,140 --> 00:28:53,880
stack from scratch ducky teacher is old

510
00:28:49,409 --> 00:28:56,850
but stable and secure and it's worth to

511
00:28:53,880 --> 00:28:59,669
mention first cure folks all the process

512
00:28:56,850 --> 00:29:02,850
by LD preload due to the monitor and

513
00:28:59,669 --> 00:29:04,789
security consideration we will discuss

514
00:29:02,850 --> 00:29:08,370
this later

515
00:29:04,789 --> 00:29:10,650
she is the variability is we find the

516
00:29:08,370 --> 00:29:13,229
null then we were introduced the pre

517
00:29:10,650 --> 00:29:16,110
arbitrary fire reading and the post else

518
00:29:13,230 --> 00:29:18,420
command injection we train these two

519
00:29:16,110 --> 00:29:22,679
backs into the pre odds remote code

520
00:29:18,420 --> 00:29:25,920
execution the first bug is the pre-alpha

521
00:29:22,680 --> 00:29:29,730
reading / secure introduced a new

522
00:29:25,920 --> 00:29:34,770
feature called html5 answers since

523
00:29:29,730 --> 00:29:39,180
version 8.2 it cancers the tail net SSH

524
00:29:34,770 --> 00:29:41,970
and remote desktop by browsers in order

525
00:29:39,180 --> 00:29:45,059
to adapt the new feature first cure

526
00:29:41,970 --> 00:29:49,260
click add a new if conviction to handle

527
00:29:45,059 --> 00:29:52,500
all static resources 6 - the new feature

528
00:29:49,260 --> 00:29:58,020
the original track validation has been

529
00:29:52,500 --> 00:30:00,540
bypassed so in effect by this all

530
00:29:58,020 --> 00:30:03,870
unpatched version except the end of

531
00:30:00,540 --> 00:30:07,649
light version are affected here is the

532
00:30:03,870 --> 00:30:10,260
pillow for you to check the sslvpn when

533
00:30:07,650 --> 00:30:13,500
there is a special pass in the end of

534
00:30:10,260 --> 00:30:20,100
the URL the past validation becomes

535
00:30:13,500 --> 00:30:23,100
loose and what can we get from this we

536
00:30:20,100 --> 00:30:25,919
can get numbers useful information such

537
00:30:23,100 --> 00:30:29,780
as the server private key to decrypt the

538
00:30:25,920 --> 00:30:32,370
SSL connection we can also get important

539
00:30:29,780 --> 00:30:36,990
configurations such as the radius and

540
00:30:32,370 --> 00:30:40,020
LDAP password and all users password

541
00:30:36,990 --> 00:30:44,190
hash and sensitive cookie which are

542
00:30:40,020 --> 00:30:48,059
cache in the web VPN like go Dropbox and

543
00:30:44,190 --> 00:30:52,740
I Club the last and the most important

544
00:30:48,059 --> 00:30:58,379
is the cache print text password yes

545
00:30:52,740 --> 00:31:01,140
print text again for now we get we get a

546
00:30:58,380 --> 00:31:04,800
credential so we are able to access the

547
00:31:01,140 --> 00:31:07,290
cooperation Network easily however our

548
00:31:04,800 --> 00:31:11,040
goal is to get Co execution for

549
00:31:07,290 --> 00:31:13,860
persistent and further actions so here

550
00:31:11,040 --> 00:31:16,980
we Chen a connection in management in

551
00:31:13,860 --> 00:31:19,490
the fest together from this cough

552
00:31:16,980 --> 00:31:21,140
recommend it's very obvious and

553
00:31:19,490 --> 00:31:23,990
straightforward

554
00:31:21,140 --> 00:31:26,750
if we can control the options we can

555
00:31:23,990 --> 00:31:31,429
inject actually comment to this pearl

556
00:31:26,750 --> 00:31:33,020
function and of course we can we can

557
00:31:31,429 --> 00:31:36,440
come showed up shares from the

558
00:31:33,020 --> 00:31:37,690
troubleshooting patch so it's that

559
00:31:36,440 --> 00:31:42,110
simple

560
00:31:37,690 --> 00:31:45,080
no I don't think so in order to avoid

561
00:31:42,110 --> 00:31:47,419
potential vulnerabilities prosecutor

562
00:31:45,080 --> 00:31:51,049
pride a lot of hardening on their

563
00:31:47,420 --> 00:31:54,830
products such as the sensor integrity

564
00:31:51,049 --> 00:31:57,740
check and the read-only files instant to

565
00:31:54,830 --> 00:32:02,480
protect from backdoors in chrome tab or

566
00:31:57,740 --> 00:32:06,169
web loot the most effective hardening is

567
00:32:02,480 --> 00:32:08,390
the DSL major it's like the safe guard

568
00:32:06,169 --> 00:32:13,490
to protect pearl from dangerous

569
00:32:08,390 --> 00:32:17,600
operations the PSF is a pearl manager

570
00:32:13,490 --> 00:32:20,179
which is written in C++ the module the

571
00:32:17,600 --> 00:32:23,090
module increment is on command parser

572
00:32:20,179 --> 00:32:27,490
and hope several dangerous functions

573
00:32:23,090 --> 00:32:30,649
such as the sinston open and back stick

574
00:32:27,490 --> 00:32:34,000
it also did the low numbers bad

575
00:32:30,650 --> 00:32:36,400
characters and increment the leanest IO

576
00:32:34,000 --> 00:32:40,190
reduction in Perl

577
00:32:36,400 --> 00:32:45,320
so due to the hardening we cannot

578
00:32:40,190 --> 00:32:47,620
perform any command injection we tried

579
00:32:45,320 --> 00:32:51,350
several ways to bypass the hardening of

580
00:32:47,620 --> 00:32:55,729
course the first cut of my mind is the

581
00:32:51,350 --> 00:32:59,209
argument injection however the TCP dump

582
00:32:55,730 --> 00:33:02,270
in pearls cure is too old so it failed

583
00:32:59,210 --> 00:33:05,210
because it didn't support several juicy

584
00:33:02,270 --> 00:33:10,220
features such as the post low Ted

585
00:33:05,210 --> 00:33:12,620
comment higher examine assistant we find

586
00:33:10,220 --> 00:33:16,910
pearl skewers though the temperate cache

587
00:33:12,620 --> 00:33:19,159
in a directory we try to write which we

588
00:33:16,910 --> 00:33:22,130
try to write into this directory

589
00:33:19,160 --> 00:33:25,190
though we can't use the standard out

590
00:33:22,130 --> 00:33:29,450
because it's already directed to the new

591
00:33:25,190 --> 00:33:32,380
device how we can what we can do is only

592
00:33:29,450 --> 00:33:36,140
abuse the set file argument

593
00:33:32,380 --> 00:33:39,980
but it says there's no way to generate a

594
00:33:36,140 --> 00:33:46,010
product quad file in both pearl and pcap

595
00:33:39,980 --> 00:33:49,340
format so it's time to dig deeper we tap

596
00:33:46,010 --> 00:33:53,000
into the tsf implementation to see is

597
00:33:49,340 --> 00:33:56,449
there anything we can leverage we find a

598
00:33:53,000 --> 00:33:59,990
flaw in the comment parcel when there's

599
00:33:56,450 --> 00:34:04,510
an incomplete il redirection the rest of

600
00:33:59,990 --> 00:34:07,669
the IO part will be truncated however

601
00:34:04,510 --> 00:34:10,940
also we can recount all the standard out

602
00:34:07,669 --> 00:34:16,460
which we still can't fight any way to

603
00:34:10,940 --> 00:34:18,280
generate a valid Perl script so let's

604
00:34:16,460 --> 00:34:22,850
think out of the box

605
00:34:18,280 --> 00:34:26,090
standard out is uncontrollable but could

606
00:34:22,850 --> 00:34:31,310
we write rewrite script by just in the

607
00:34:26,090 --> 00:34:34,460
arrow when you froze the TCP dump to

608
00:34:31,310 --> 00:34:39,230
open a non-existent file it will show

609
00:34:34,460 --> 00:34:41,600
the error no such file or directory from

610
00:34:39,230 --> 00:34:45,770
the error is since we can posture

611
00:34:41,600 --> 00:34:48,799
control the message we try to pipe this

612
00:34:45,770 --> 00:34:53,418
standard error - perl but we still get

613
00:34:48,800 --> 00:34:56,030
nothing however when we try to use

614
00:34:53,418 --> 00:35:00,049
another file names such as the print

615
00:34:56,030 --> 00:35:02,570
when you sleep with a hashtag we try to

616
00:35:00,050 --> 00:35:04,400
pipe a standard error - perl again and

617
00:35:02,570 --> 00:35:08,270
the magic happens

618
00:35:04,400 --> 00:35:11,150
the Perl print out at 1 2 3 with our

619
00:35:08,270 --> 00:35:14,600
arrows ok

620
00:35:11,150 --> 00:35:18,200
the per 101 pearls are pearls the go to

621
00:35:14,600 --> 00:35:21,710
label so that he Savita with a Colin

622
00:35:18,200 --> 00:35:24,669
becomes a label in Perl and we use the

623
00:35:21,710 --> 00:35:28,070
hash tag to comment the rest of the part

624
00:35:24,670 --> 00:35:33,560
so the standard error because the valid

625
00:35:28,070 --> 00:35:36,880
Perl know so this is our final exporting

626
00:35:33,560 --> 00:35:40,730
we will explain the pillow and they want

627
00:35:36,880 --> 00:35:43,850
the first is to map the TCB tab open a

628
00:35:40,730 --> 00:35:45,830
non-existent file the file name will be

629
00:35:43,850 --> 00:35:50,120
part of the error message

630
00:35:45,830 --> 00:35:52,640
instead the arrow and then we knew it

631
00:35:50,120 --> 00:35:55,880
will redirect a standard error into

632
00:35:52,640 --> 00:35:59,120
cache directory during then of fire

633
00:35:55,880 --> 00:36:04,010
earth setcookie that he HT an error that

634
00:35:59,120 --> 00:36:04,910
it is see the last is that the last is

635
00:36:04,010 --> 00:36:07,520
the incomplete

636
00:36:04,910 --> 00:36:10,250
i'll symbol this symbol repeals the

637
00:36:07,520 --> 00:36:11,830
common parser to ignore the rest of the

638
00:36:10,250 --> 00:36:14,990
i/o redirection

639
00:36:11,830 --> 00:36:19,040
so as ours then the error has been

640
00:36:14,990 --> 00:36:21,680
written into the cache directory we can

641
00:36:19,040 --> 00:36:25,190
just fish fetch the corresponding path

642
00:36:21,680 --> 00:36:27,799
to execute our comment but training

643
00:36:25,190 --> 00:36:33,320
these two variabilities we can get a

644
00:36:27,800 --> 00:36:35,690
reliable prios remote code execution we

645
00:36:33,320 --> 00:36:38,780
have to report all of our fighting to

646
00:36:35,690 --> 00:36:41,660
procure pieces third and this is the

647
00:36:38,780 --> 00:36:45,140
response from them and they effects all

648
00:36:41,660 --> 00:36:48,680
the box we sing amongst the reaction is

649
00:36:45,140 --> 00:36:51,259
very quick and professional it's a great

650
00:36:48,680 --> 00:36:57,080
hand to work with / secure there are

651
00:36:51,260 --> 00:37:00,410
such a really responsible render after

652
00:36:57,080 --> 00:37:03,319
procure relays all the patches we kept

653
00:37:00,410 --> 00:37:06,560
monitoring the internet to see the large

654
00:37:03,320 --> 00:37:09,200
corporations response time twitter is

655
00:37:06,560 --> 00:37:12,400
one of them they are known for their bug

656
00:37:09,200 --> 00:37:16,069
bounty program and nice to hackers

657
00:37:12,400 --> 00:37:19,550
however is not good to exploit a one day

658
00:37:16,070 --> 00:37:22,430
right after the patch released so you

659
00:37:19,550 --> 00:37:27,530
read 30 days for twitter to upgrade

660
00:37:22,430 --> 00:37:32,600
their ssl VPN this is the twitter ssl

661
00:37:27,530 --> 00:37:34,970
VPN is just a simple login patch from

662
00:37:32,600 --> 00:37:38,690
the reconnaissance we know the last

663
00:37:34,970 --> 00:37:43,250
titrated upgrade is in last December so

664
00:37:38,690 --> 00:37:46,760
Twitter is slightly vulnerable and yes

665
00:37:43,250 --> 00:37:50,900
we have verified a path and got a bunch

666
00:37:46,760 --> 00:37:53,900
of user credential imprint tax however

667
00:37:50,900 --> 00:37:57,740
we encountered some problems while

668
00:37:53,900 --> 00:38:00,900
trying to pop a surfer on Twitter

669
00:37:57,740 --> 00:38:05,069
yes the first part is the two factor

670
00:38:00,900 --> 00:38:07,589
authentication view the two factor

671
00:38:05,069 --> 00:38:11,058
authentication also we can get a print

672
00:38:07,589 --> 00:38:14,220
text password we still can do anything

673
00:38:11,059 --> 00:38:18,480
so the first thing we need is to find a

674
00:38:14,220 --> 00:38:21,750
way to bypass that we observe returning

675
00:38:18,480 --> 00:38:25,349
a bottle immunization lomi session is

676
00:38:21,750 --> 00:38:28,079
the feature to enhance the mobility it

677
00:38:25,349 --> 00:38:32,730
allows the station from multiple like

678
00:38:28,079 --> 00:38:35,819
multiple IP locations so once we know

679
00:38:32,730 --> 00:38:38,490
that we download the database and forge

680
00:38:35,819 --> 00:38:42,839
decision to bypass the two-factor

681
00:38:38,490 --> 00:38:46,950
authentication and finally we lock into

682
00:38:42,839 --> 00:38:50,519
tears things to the next robber is the

683
00:38:46,950 --> 00:38:53,160
SS conferring management in the fest as

684
00:38:50,519 --> 00:38:57,078
we mentioned before we have a command

685
00:38:53,160 --> 00:38:59,359
injection here however for security

686
00:38:57,079 --> 00:39:01,349
consideration most of the cooperation

687
00:38:59,359 --> 00:39:04,650
disabled is in the fest

688
00:39:01,349 --> 00:39:09,000
on public so we need to fight another

689
00:39:04,650 --> 00:39:11,670
way to answers the interface here we

690
00:39:09,000 --> 00:39:15,289
leverage the here we leverage the web

691
00:39:11,670 --> 00:39:20,130
BPM feature again to connect to itself

692
00:39:15,289 --> 00:39:23,819
it's just like the SS RF we use the zero

693
00:39:20,130 --> 00:39:27,380
to bypass the SSI protection and assess

694
00:39:23,819 --> 00:39:33,000
the management interface successfully

695
00:39:27,380 --> 00:39:36,119
yeah finally we got there however the

696
00:39:33,000 --> 00:39:40,009
last problem is that we don't fight any

697
00:39:36,119 --> 00:39:43,289
managers printheads password in cache

698
00:39:40,009 --> 00:39:46,650
practically most of the manager only log

699
00:39:43,289 --> 00:39:49,789
into their system at the first time the

700
00:39:46,650 --> 00:39:53,849
only thing we have is the password hash

701
00:39:49,789 --> 00:40:00,390
inserted and if I trip and shut to 56

702
00:39:53,849 --> 00:40:02,670
format so we launcher 70 Cora AWS to

703
00:40:00,390 --> 00:40:10,210
crack the hash

704
00:40:02,670 --> 00:40:12,820
and see hours later yes we cracked the

705
00:40:10,210 --> 00:40:16,120
hash and successfully log into their

706
00:40:12,820 --> 00:40:18,730
management in the fest we are lucky

707
00:40:16,120 --> 00:40:21,880
because the length of the password is

708
00:40:18,730 --> 00:40:25,360
only ten and the first character is

709
00:40:21,880 --> 00:40:29,740
capital P it's at a very early stage of

710
00:40:25,360 --> 00:40:31,990
our equation Q we explore our main

711
00:40:29,740 --> 00:40:38,680
Junction and try to run the comment

712
00:40:31,990 --> 00:40:40,930
ifconfig and yes we gotta show we repro

713
00:40:38,680 --> 00:40:44,649
off our fighting to their bug bounty

714
00:40:40,930 --> 00:40:48,549
program and got a highest bounty front

715
00:40:44,650 --> 00:40:51,220
reader also we cannot prove that it

716
00:40:48,550 --> 00:40:57,580
since this is the first remote code

717
00:40:51,220 --> 00:41:01,540
execution on Twitter okay the last is

718
00:40:57,580 --> 00:41:04,330
the bonus for you our company Def Con

719
00:41:01,540 --> 00:41:08,740
provides the most professional rating

720
00:41:04,330 --> 00:41:13,270
service in Asia so let's talk about how

721
00:41:08,740 --> 00:41:16,359
to make the rating more read in a

722
00:41:13,270 --> 00:41:20,140
reading operation the personal computer

723
00:41:16,360 --> 00:41:23,140
is more valuable so in order to take

724
00:41:20,140 --> 00:41:25,779
control in sewing order to take control

725
00:41:23,140 --> 00:41:29,410
of all of the clients we need to

726
00:41:25,780 --> 00:41:32,800
weaponize the sslvpn there are several

727
00:41:29,410 --> 00:41:35,379
Oscar measures before such as the

728
00:41:32,800 --> 00:41:40,030
waterhole attack or repress the Vivian

729
00:41:35,380 --> 00:41:43,930
installer but here we proposed a new

730
00:41:40,030 --> 00:41:46,810
Meister is the local scrip local scrip

731
00:41:43,930 --> 00:41:50,649
is the feature in almost every instance

732
00:41:46,810 --> 00:41:53,080
the Vivian it it can ask you to respond

733
00:41:50,650 --> 00:41:57,610
in script to mount of network files

734
00:41:53,080 --> 00:42:02,380
instant or change the loading table so

735
00:41:57,610 --> 00:42:06,570
here we will show you a demo to tune how

736
00:42:02,380 --> 00:42:06,570
we compromise all the Vivian clients

737
00:42:10,900 --> 00:42:17,360
okay this is our demonstration as you

738
00:42:14,600 --> 00:42:20,960
can see you know explain it one argument

739
00:42:17,360 --> 00:42:29,300
so we append our target right after the

740
00:42:20,960 --> 00:42:33,200
extra e okay here we got a username and

741
00:42:29,300 --> 00:42:36,290
the hash of admin also we could not find

742
00:42:33,200 --> 00:42:39,649
any printheads password we can still

743
00:42:36,290 --> 00:42:53,480
change our cookie to the session ID of a

744
00:42:39,650 --> 00:42:56,560
de mean yeah we change our cookie to the

745
00:42:53,480 --> 00:42:56,560
session of a de me

746
00:42:57,550 --> 00:43:08,060
once the our modifications done we can

747
00:43:00,620 --> 00:43:14,029
ask us the manager in the face and we

748
00:43:08,060 --> 00:43:18,279
have to become the enemy here we

749
00:43:14,030 --> 00:43:24,770
leverage the fisher on the user laws

750
00:43:18,280 --> 00:43:29,410
users and the VP internal ring if you in

751
00:43:24,770 --> 00:43:32,060
town we find a local scripts sections

752
00:43:29,410 --> 00:43:35,000
here you can see the local script

753
00:43:32,060 --> 00:43:38,960
supports suppose not only Windows but

754
00:43:35,000 --> 00:43:43,510
also leanness and Mac always we use that

755
00:43:38,960 --> 00:43:43,510
we use the calculator as our back door

756
00:43:44,830 --> 00:43:53,890
okay once our modification is done we

757
00:43:48,920 --> 00:43:53,890
change to the laptop of our victim

758
00:43:59,550 --> 00:44:07,740
the victim launched the persecute agent

759
00:44:02,850 --> 00:44:15,900
and try to connect to the sslvpn with

760
00:44:07,740 --> 00:44:18,450
his username and password so once the

761
00:44:15,900 --> 00:44:30,750
connection has been established the

762
00:44:18,450 --> 00:44:34,500
calculator will be pop automatically ok

763
00:44:30,750 --> 00:44:37,620
here we finish all of our slice but how

764
00:44:34,500 --> 00:44:40,800
we make it such attacks here it gives

765
00:44:37,620 --> 00:44:44,370
several recommendations the first is the

766
00:44:40,800 --> 00:44:46,830
client certificate we saw the thief cut

767
00:44:44,370 --> 00:44:50,609
the malicious connection will be chopped

768
00:44:46,830 --> 00:44:52,710
during SSO negotiation and the next is

769
00:44:50,610 --> 00:44:55,440
the and the next is to enable

770
00:44:52,710 --> 00:44:58,140
multi-factor authentication it can

771
00:44:55,440 --> 00:45:02,010
decrease numerous attacks surface and

772
00:44:58,140 --> 00:45:05,190
the last remember to enable flow log out

773
00:45:02,010 --> 00:45:09,510
it and subscribe the vendors advisory to

774
00:45:05,190 --> 00:45:11,970
keep your system updated this is the end

775
00:45:09,510 --> 00:45:14,990
of our presentations thank you for being

776
00:45:11,970 --> 00:45:14,990
here thanks

777
00:45:20,020 --> 00:45:27,099
and here's our contact information we'll

778
00:45:24,130 --> 00:45:31,869
press let let us know if you have any

779
00:45:27,099 --> 00:45:34,480
further questions okay I saying this is

780
00:45:31,869 --> 00:45:35,230
the Q&A time do you have any questions

781
00:45:34,480 --> 00:45:42,580
from the floor

782
00:45:35,230 --> 00:45:53,890
oh yeah please well very scared for the

783
00:45:42,580 --> 00:45:57,490
Q&A actually you have given everything

784
00:45:53,890 --> 00:46:02,910
in a detailed manner in your PPT in your

785
00:45:57,490 --> 00:46:07,839
blog itself yes I I have successfully

786
00:46:02,910 --> 00:46:14,348
tried for the 1 1 5 1 0 cv 1 1 Phi 1

787
00:46:07,839 --> 00:46:19,089
Prius family waiting on press Q in your

788
00:46:14,349 --> 00:46:22,330
demo video there is only one user ok

789
00:46:19,089 --> 00:46:26,259
admin on suppose say there are 10 users

790
00:46:22,330 --> 00:46:28,569
you can do for do I mean you can grab

791
00:46:26,260 --> 00:46:31,270
the sessions for all the 10 users and

792
00:46:28,570 --> 00:46:35,940
you can try out the things but when you

793
00:46:31,270 --> 00:46:39,759
are in an enterprise network when you

794
00:46:35,940 --> 00:46:42,130
grab the session database so how will

795
00:46:39,760 --> 00:46:47,040
you map that particular session is

796
00:46:42,130 --> 00:46:51,099
related to admin itself so in that case

797
00:46:47,040 --> 00:46:54,490
if you suppose you grab a session some

798
00:46:51,099 --> 00:46:58,839
user session ok and that user will not

799
00:46:54,490 --> 00:47:01,660
have access to what you call access the

800
00:46:58,839 --> 00:47:07,750
admin directory so you will not able to

801
00:47:01,660 --> 00:47:10,359
go for 105 3 9 so in that case like how

802
00:47:07,750 --> 00:47:14,650
can I map the session whatever the

803
00:47:10,359 --> 00:47:20,080
sessions I got that is the admin session

804
00:47:14,650 --> 00:47:22,869
ok if your cross trace about how to map

805
00:47:20,080 --> 00:47:25,098
the session ID and the session username

806
00:47:22,869 --> 00:47:27,949
yeah

807
00:47:25,099 --> 00:47:30,469
think about an enterprise network okay

808
00:47:27,949 --> 00:47:35,209
you will get so many sessions yes yes

809
00:47:30,469 --> 00:47:39,079
yes yes yes that particular session I ID

810
00:47:35,209 --> 00:47:41,839
- that is related to admin okay this is

811
00:47:39,079 --> 00:47:44,900
a good question because this is a this

812
00:47:41,839 --> 00:47:47,749
is the demonstration so we only have a

813
00:47:44,900 --> 00:47:51,049
one station our sinston yeah so we

814
00:47:47,749 --> 00:47:54,410
withhold vital we don't fight any way to

815
00:47:51,049 --> 00:47:58,239
map the station and use and so our

816
00:47:54,410 --> 00:48:02,959
solution is to enable in elaborate

817
00:47:58,239 --> 00:48:06,680
theory in our own station and to check

818
00:48:02,959 --> 00:48:10,189
is this session is the session for for

819
00:48:06,680 --> 00:48:13,069
for for manager or not and in the

820
00:48:10,189 --> 00:48:15,319
industry Dirk has because the we can

821
00:48:13,069 --> 00:48:17,509
because they are tell they are about

822
00:48:15,319 --> 00:48:21,499
thousand of sessions in the in the

823
00:48:17,509 --> 00:48:23,869
Twitter case so we only we only we don't

824
00:48:21,499 --> 00:48:29,089
know which station is is for a demeans

825
00:48:23,869 --> 00:48:32,949
so which we only use the they use the

826
00:48:29,089 --> 00:48:32,949
hash and creating the password yeah

827
00:48:38,769 --> 00:48:45,049
whatever we are getting is it position

828
00:48:41,929 --> 00:48:49,549
persistent session and we're really not

829
00:48:45,049 --> 00:48:54,920
changing after run before login and

830
00:48:49,549 --> 00:48:57,529
after logout yes is not if you press the

831
00:48:54,920 --> 00:48:59,660
look out the sensation will be clear but

832
00:48:57,529 --> 00:49:15,949
if you don't click click it'll look out

833
00:48:59,660 --> 00:49:18,140
the station will it depend on the

834
00:49:15,949 --> 00:49:20,989
setting of your SSL VPN there are

835
00:49:18,140 --> 00:49:24,640
several settings on the management of

836
00:49:20,989 --> 00:49:27,320
affairs in the face so it depend on on

837
00:49:24,640 --> 00:49:39,120
each case is yeah

838
00:49:27,320 --> 00:49:40,530
yes yes thank you thank you okay so are

839
00:49:39,120 --> 00:49:46,080
there any other questions from the floor

840
00:49:40,530 --> 00:49:51,780
before we go over to slide oh no oh my

841
00:49:46,080 --> 00:49:54,710
god all right yeah what common issues do

842
00:49:51,780 --> 00:49:58,940
you run into for attempting to

843
00:49:54,710 --> 00:50:03,090
virtualize the frame wait okay

844
00:49:58,940 --> 00:50:08,720
actually we got the most of the Vivian

845
00:50:03,090 --> 00:50:11,700
went SSL VPN vendors provider actually

846
00:50:08,720 --> 00:50:15,230
master VMware or kayvyun or or

847
00:50:11,700 --> 00:50:24,750
VirtualBox images so we don't need to

848
00:50:15,230 --> 00:50:27,150
visualize them well yeah so okay so what

849
00:50:24,750 --> 00:50:33,360
do you think about exposure by fraud

850
00:50:27,150 --> 00:50:39,090
Servier Indian okay yeah we have this

851
00:50:33,360 --> 00:50:41,370
this is a several days ago one okay well

852
00:50:39,090 --> 00:50:46,110
why organization called the produce they

853
00:50:41,370 --> 00:50:49,140
are India not for z400 Indian publish

854
00:50:46,110 --> 00:50:53,280
the X the pro skier is free on their

855
00:50:49,140 --> 00:50:59,270
github we have discussed this internally

856
00:50:53,280 --> 00:51:03,870
then we think we think it's too early to

857
00:50:59,270 --> 00:51:09,210
reveal the x-48 because this is a new

858
00:51:03,870 --> 00:51:13,080
nuclear labor weapon so so originally we

859
00:51:09,210 --> 00:51:18,360
we originally our company and and we

860
00:51:13,080 --> 00:51:22,020
want to disclosure that it's free more

861
00:51:18,360 --> 00:51:25,560
later because we need to push more glide

862
00:51:22,020 --> 00:51:30,120
to patch to patch their SSL VPN so we

863
00:51:25,560 --> 00:51:32,840
think this is this is not good yeah yeah

864
00:51:30,120 --> 00:51:35,009
the per this is our people this is our

865
00:51:32,840 --> 00:51:41,760
opinions

866
00:51:35,010 --> 00:51:44,580
and because yeah yeah yeah how did you

867
00:51:41,760 --> 00:51:55,619
know that oh because Ana

868
00:51:44,580 --> 00:52:01,770
whip guy any color under your skin red

869
00:51:55,619 --> 00:52:12,630
function which cruelty to this question

870
00:52:01,770 --> 00:52:15,840
related to our daughter you are you're a

871
00:52:12,630 --> 00:52:19,950
long time Finn okay okay

872
00:52:15,840 --> 00:52:22,710
is there a fee for sslvpn nice think

873
00:52:19,950 --> 00:52:26,419
there's no of rc4 sslvpn

874
00:52:22,710 --> 00:52:31,050
because there's many i've cyril and

875
00:52:26,420 --> 00:52:34,830
related to the protocol such as HTTP SMB

876
00:52:31,050 --> 00:52:38,990
or or or VNC or a PPP

877
00:52:34,830 --> 00:52:38,990
but every vendor implement their own

878
00:52:39,800 --> 00:52:48,000
implement this spec by the thin self so

879
00:52:43,920 --> 00:52:53,730
our our our attacker is to fight is to

880
00:52:48,000 --> 00:52:55,859
fight the implementation era yeah do you

881
00:52:53,730 --> 00:52:58,950
know what I mean okay

882
00:52:55,859 --> 00:53:01,590
sorry for my poor English before we move

883
00:52:58,950 --> 00:53:03,540
on to the next one just to see okay if

884
00:53:01,590 --> 00:53:05,460
there are any questions live from the

885
00:53:03,540 --> 00:53:09,720
floor as well I hope that user name is

886
00:53:05,460 --> 00:53:21,930
not in this eight yeah when it's fresh

887
00:53:09,720 --> 00:53:25,649
okay is there any question no I'm sorry

888
00:53:21,930 --> 00:53:26,790
pardon but the second program I know one

889
00:53:25,650 --> 00:53:32,490
yeah it's a good question

890
00:53:26,790 --> 00:53:34,980
oh oh my god now there's no number one

891
00:53:32,490 --> 00:53:37,979
question never have you tried also with

892
00:53:34,980 --> 00:53:41,100
VP inform or bro all from the same

893
00:53:37,980 --> 00:53:43,680
vendor if years did you run no we don't

894
00:53:41,100 --> 00:53:45,729
we don't try the the VPN for mobiles

895
00:53:43,680 --> 00:53:51,499
yeah

896
00:53:45,729 --> 00:53:55,848
okay yeah yeah but actually we are I am

897
00:53:51,499 --> 00:53:59,238
now trying to look into some have passed

898
00:53:55,849 --> 00:54:01,549
since turn like mobile I'll or the VM

899
00:53:59,239 --> 00:54:04,099
will watch because many many large

900
00:54:01,549 --> 00:54:07,038
corporation also use that but this is

901
00:54:04,099 --> 00:54:10,819
also a good device a device

902
00:54:07,039 --> 00:54:12,969
yeah a device thank you so many

903
00:54:10,819 --> 00:54:12,969
questions

904
00:54:13,150 --> 00:54:23,509
no well I think our times

905
00:54:15,799 --> 00:54:27,890
all six minutes well if you want you can

906
00:54:23,509 --> 00:54:31,279
just yeah and why this each winners

907
00:54:27,890 --> 00:54:32,479
Laurel their own version the feature

908
00:54:31,279 --> 00:54:43,069
very prettily

909
00:54:32,479 --> 00:54:45,950
I think this again many guys know

910
00:54:43,069 --> 00:54:53,538
Chinese I can I can understand the

911
00:54:45,950 --> 00:54:58,098
question her engage is motivated okay

912
00:54:53,539 --> 00:54:59,059
any backslash a backlash for any

913
00:54:58,099 --> 00:55:02,690
organized

914
00:54:59,059 --> 00:55:06,430
what is backlash I don't know any

915
00:55:02,690 --> 00:55:08,509
company any organization give you any

916
00:55:06,430 --> 00:55:11,359
problems do they complain are they're

917
00:55:08,509 --> 00:55:13,759
upset about Oh No

918
00:55:11,359 --> 00:55:16,729
but before our break Hedgehog we are

919
00:55:13,759 --> 00:55:33,069
very calm we are very is there any video

920
00:55:16,729 --> 00:55:33,069
recording because the us the engineer

921
00:55:33,190 --> 00:55:39,650
and you you and you sir

922
00:55:37,759 --> 00:55:45,770
a creepy license here we are

923
00:55:39,650 --> 00:55:49,180
scare about that and after the after the

924
00:55:45,770 --> 00:55:52,910
our talk many many company or

925
00:55:49,180 --> 00:55:54,859
organization contact us want to do you

926
00:55:52,910 --> 00:55:57,620
want to sell the other day or do we want

927
00:55:54,860 --> 00:56:00,200
to prepare a yeah we are the good guys

928
00:55:57,620 --> 00:56:05,750
yeah we don't spell and with those sale

929
00:56:00,200 --> 00:56:08,710
we do not sell any 0 days yeah okay yeah

930
00:56:05,750 --> 00:56:17,240
excellent well thank you for going to

931
00:56:08,710 --> 00:56:20,710
questions okay bye okay there's one more

932
00:56:17,240 --> 00:56:20,709
questions one more question

933
00:56:21,260 --> 00:56:25,100
these are all the question you could

934
00:56:23,090 --> 00:56:29,600
understand just now it's a video asking

935
00:56:25,100 --> 00:56:31,250
in Chinese right I wish more number to

936
00:56:29,600 --> 00:56:32,900
order comes to it through to the VPN

937
00:56:31,250 --> 00:56:36,650
apartment sitting with how many oceans

938
00:56:32,900 --> 00:56:40,400
heart I somewhat put on console 30 top

939
00:56:36,650 --> 00:56:42,170
and put in sorted see the sslvpn I

940
00:56:40,400 --> 00:56:44,150
thought you took another one you know

941
00:56:42,170 --> 00:56:47,000
one things easily with the one D'Amato

942
00:56:44,150 --> 00:56:50,300
put on computed cotton are you know not

943
00:56:47,000 --> 00:56:55,730
Tapia now is a window consider two 0s

944
00:56:50,300 --> 00:56:58,460
little son gangaiah consider Susie

945
00:56:55,730 --> 00:57:02,420
allowed her horses swishy owes to the

946
00:56:58,460 --> 00:57:04,930
tahm kench's okay okay thanks thank you

947
00:57:02,420 --> 00:57:04,930
oh yeah

