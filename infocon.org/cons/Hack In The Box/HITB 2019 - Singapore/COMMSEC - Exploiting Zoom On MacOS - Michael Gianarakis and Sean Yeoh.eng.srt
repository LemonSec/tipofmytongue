1
00:00:23,310 --> 00:00:29,279
all right so just by way of introduction

2
00:00:27,390 --> 00:00:31,830
just a little bit about myself so yeah I

3
00:00:29,280 --> 00:00:34,230
am the CEO and co-founder of asset note

4
00:00:31,830 --> 00:00:36,330
prior to that I was running spider labs

5
00:00:34,230 --> 00:00:38,370
in the APAC region done a bunch of

6
00:00:36,330 --> 00:00:40,470
research presented actually here in the

7
00:00:38,370 --> 00:00:42,870
past as well mostly on mobile security

8
00:00:40,470 --> 00:00:45,800
so if you interested check it out and I

9
00:00:42,870 --> 00:00:49,500
do some community stuff in Australia I

10
00:00:45,800 --> 00:00:51,720
am Sean I'm the lead engineer and DevOps

11
00:00:49,500 --> 00:00:53,460
it has it note I lecture extended web

12
00:00:51,720 --> 00:00:56,280
app security and software security

13
00:00:53,460 --> 00:00:59,100
assessment at UNSW Australia X Microsoft

14
00:00:56,280 --> 00:01:00,660
II and in turn and I'm a part-time bug

15
00:00:59,100 --> 00:01:04,710
Danny hunter and the rest of the time

16
00:01:00,660 --> 00:01:06,899
I'm spending wasting it cool so just a

17
00:01:04,709 --> 00:01:08,490
little bit of an overview you know with

18
00:01:06,900 --> 00:01:10,409
this talk we wanted to talk a little bit

19
00:01:08,490 --> 00:01:11,820
more about the journey and the thinking

20
00:01:10,409 --> 00:01:13,770
as well as some of the roadblocks right

21
00:01:11,820 --> 00:01:17,610
so a lot of these presentations they're

22
00:01:13,770 --> 00:01:19,199
really kind of you know here's the bug

23
00:01:17,610 --> 00:01:20,970
and it makes it seem like you just

24
00:01:19,200 --> 00:01:22,620
opened your laptop you know pointed at

25
00:01:20,970 --> 00:01:24,630
the target and then you know bugs fly

26
00:01:22,620 --> 00:01:27,000
out but that's not necessarily realistic

27
00:01:24,630 --> 00:01:29,189
so we want to take you a little bit more

28
00:01:27,000 --> 00:01:31,439
on the journey so you know hopefully you

29
00:01:29,189 --> 00:01:32,369
can get a little bit more out of that so

30
00:01:31,439 --> 00:01:34,169
we'll talk about how we approached

31
00:01:32,369 --> 00:01:36,659
attacking zoom the initial vector

32
00:01:34,170 --> 00:01:38,130
finding the floor and then the

33
00:01:36,659 --> 00:01:40,110
exploitation of the vulnerability will

34
00:01:38,130 --> 00:01:41,820
recap it at the end and then we've got

35
00:01:40,110 --> 00:01:45,000
some key takeaways and some some points

36
00:01:41,820 --> 00:01:48,298
we want to make so just to set the scene

37
00:01:45,000 --> 00:01:49,920
with this so this was actually

38
00:01:48,299 --> 00:01:51,990
discovered at a bug bounty live event

39
00:01:49,920 --> 00:01:53,700
for those who don't know the big sort of

40
00:01:51,990 --> 00:01:54,210
bug bounty companies hacker one bug

41
00:01:53,700 --> 00:01:56,430
crowd

42
00:01:54,210 --> 00:01:59,250
regularly put on these live hacking

43
00:01:56,430 --> 00:02:01,710
events they invite only there's usually

44
00:01:59,250 --> 00:02:03,539
for one of their big customers they

45
00:02:01,710 --> 00:02:05,669
bring in like the top sort of 50 or so

46
00:02:03,539 --> 00:02:07,460
hackers and they usually give you sort

47
00:02:05,670 --> 00:02:10,100
of like an unique scope or extra rewards

48
00:02:07,460 --> 00:02:13,200
and you it's sort of a one-day event

49
00:02:10,100 --> 00:02:15,510
it's typically pretty competitive and go

50
00:02:13,200 --> 00:02:17,070
team Australia but you know that's sort

51
00:02:15,510 --> 00:02:20,310
of the the sort of the background here

52
00:02:17,070 --> 00:02:22,380
so we were invited to an event actually

53
00:02:20,310 --> 00:02:24,600
here in Singapore earlier in the years

54
00:02:22,380 --> 00:02:27,150
for a big Silicon Valley unicorn and

55
00:02:24,600 --> 00:02:29,280
can't say who they were we've done

56
00:02:27,150 --> 00:02:30,540
events for them in the past in their

57
00:02:29,280 --> 00:02:31,920
bounty and we know that their core

58
00:02:30,540 --> 00:02:33,569
infrastructure and applications are

59
00:02:31,920 --> 00:02:34,410
actually pretty locked out and and well

60
00:02:33,569 --> 00:02:36,540
managed

61
00:02:34,410 --> 00:02:39,210
but for this event as is somewhat

62
00:02:36,540 --> 00:02:41,760
typical they had a new acquisition in in

63
00:02:39,210 --> 00:02:44,340
scope that wasn't as great for their

64
00:02:41,760 --> 00:02:48,000
public bounty but they also put in zoom

65
00:02:44,340 --> 00:02:49,530
which is not uncommon for for these of

66
00:02:48,000 --> 00:02:50,850
companies particularly these live events

67
00:02:49,530 --> 00:02:53,550
to put in things like zoom and other

68
00:02:50,850 --> 00:02:55,440
applications or systems that they rely

69
00:02:53,550 --> 00:02:58,350
on that they see is kind of critical to

70
00:02:55,440 --> 00:03:01,410
their business so you know that was in

71
00:02:58,350 --> 00:03:03,329
scope for this event spoiler alert we do

72
00:03:01,410 --> 00:03:05,280
the end up finding RC and zoom on Mac OS

73
00:03:03,330 --> 00:03:06,630
and we wanted to talk about it but the

74
00:03:05,280 --> 00:03:09,120
disclosure kind of stuff was a little

75
00:03:06,630 --> 00:03:12,660
bit grey we had an NDA with this with

76
00:03:09,120 --> 00:03:15,000
this big company but not with zoom and

77
00:03:12,660 --> 00:03:17,730
we did get invited to their bounty

78
00:03:15,000 --> 00:03:19,260
afterwards their private bounty and they

79
00:03:17,730 --> 00:03:20,310
said here sunless NDA and we're like no

80
00:03:19,260 --> 00:03:22,980
thanks

81
00:03:20,310 --> 00:03:23,970
but but then this happened right so we

82
00:03:22,980 --> 00:03:25,500
weren't going to talk about it we're

83
00:03:23,970 --> 00:03:26,670
planning on it but it left and this

84
00:03:25,500 --> 00:03:30,150
happen don't know if you guys saw this

85
00:03:26,670 --> 00:03:34,769
but Jonathan I'm not gonna even try

86
00:03:30,150 --> 00:03:36,510
butch his last name found a bug which

87
00:03:34,770 --> 00:03:39,180
would allow you to remotely turn on

88
00:03:36,510 --> 00:03:41,790
people's webcams via zoom and then he's

89
00:03:39,180 --> 00:03:44,100
like maybe an RC the answer to the maybe

90
00:03:41,790 --> 00:03:45,720
RC is like yes definitely RC e and it

91
00:03:44,100 --> 00:03:48,269
was kind of on the right path but he

92
00:03:45,720 --> 00:03:50,400
didn't quite get there so we had found

93
00:03:48,270 --> 00:03:55,500
it earlier um so this is this is that

94
00:03:50,400 --> 00:03:57,300
buck alright so the first thing I'm

95
00:03:55,500 --> 00:03:58,590
going to go through is our Mitchell

96
00:03:57,300 --> 00:04:00,540
approach when we come to these bounty

97
00:03:58,590 --> 00:04:02,010
events because obviously when you have

98
00:04:00,540 --> 00:04:04,470
50 of like the best hackers in the world

99
00:04:02,010 --> 00:04:05,970
looking at one specific target that man

100
00:04:04,470 --> 00:04:08,280
scopes going to be pretty saturated with

101
00:04:05,970 --> 00:04:09,930
really good talent meaning that I'll

102
00:04:08,280 --> 00:04:11,700
likelihood of finding really good bugs

103
00:04:09,930 --> 00:04:13,920
in the core application is relatively

104
00:04:11,700 --> 00:04:15,390
unlikely our general approach is team

105
00:04:13,920 --> 00:04:16,950
Australia is we usually go off to

106
00:04:15,390 --> 00:04:18,899
satellite targets or probably less

107
00:04:16,950 --> 00:04:20,640
common targets at these core guns and

108
00:04:18,899 --> 00:04:21,959
this probably means the best hackers

109
00:04:20,640 --> 00:04:24,630
aren't looking at it and there's

110
00:04:21,959 --> 00:04:26,790
probably more bugs that we can find so

111
00:04:24,630 --> 00:04:27,930
this time given the timing of the event

112
00:04:26,790 --> 00:04:29,640
and a whole bunch of other stuff we

113
00:04:27,930 --> 00:04:31,350
didn't have a lot of time beforehand to

114
00:04:29,640 --> 00:04:33,510
actually look at the core platform or a

115
00:04:31,350 --> 00:04:35,070
satellite tag it's realistically we only

116
00:04:33,510 --> 00:04:38,640
had about two or three days before the

117
00:04:35,070 --> 00:04:40,380
actual them to start hacking so chubbs

118
00:04:38,640 --> 00:04:42,450
I'll CTR and myself were in Sydney

119
00:04:40,380 --> 00:04:44,010
Airport on our way to Singapore and

120
00:04:42,450 --> 00:04:45,300
we're thinking to ourselves what can we

121
00:04:44,010 --> 00:04:46,340
do on this seven eight-hour flight

122
00:04:45,300 --> 00:04:48,590
maximum

123
00:04:46,340 --> 00:04:51,169
our time and realistically with the

124
00:04:48,590 --> 00:04:52,549
unlikely outcome of getting Internet on

125
00:04:51,169 --> 00:04:55,039
our flag we decided look at offline

126
00:04:52,550 --> 00:04:57,350
targets so shops downloaded zoom Mac OS

127
00:04:55,040 --> 00:05:00,110
and I downloaded zoom for Windows given

128
00:04:57,350 --> 00:05:01,370
the only window 0 in our company and we

129
00:05:00,110 --> 00:05:04,220
decided have a look while on the flying

130
00:05:01,370 --> 00:05:05,840
wing so the general approach that we

131
00:05:04,220 --> 00:05:07,550
take when we looking at thick client

132
00:05:05,840 --> 00:05:10,489
applications on the desktop is as

133
00:05:07,550 --> 00:05:11,570
opposed to web apps we're all look ok

134
00:05:10,490 --> 00:05:13,340
yeah we'll probably be looking at the

135
00:05:11,570 --> 00:05:14,930
files that are unpacked and installed oh

136
00:05:13,340 --> 00:05:16,698
I'm at first so this would typically be

137
00:05:14,930 --> 00:05:19,310
things like config files would be logs

138
00:05:16,699 --> 00:05:20,450
or these secrets and then of what we're

139
00:05:19,310 --> 00:05:22,100
looking for is we're looking for

140
00:05:20,450 --> 00:05:24,080
opportunities of remote user

141
00:05:22,100 --> 00:05:26,000
controllable input now what we mean by

142
00:05:24,080 --> 00:05:27,440
this is it's not things that like happen

143
00:05:26,000 --> 00:05:28,820
when you double-click on the application

144
00:05:27,440 --> 00:05:31,040
but it's things that you can interact

145
00:05:28,820 --> 00:05:32,870
with either from a browser or other from

146
00:05:31,040 --> 00:05:35,030
other places in the application so this

147
00:05:32,870 --> 00:05:38,060
is usually through like registered URL

148
00:05:35,030 --> 00:05:40,340
handlers which is disclosed in like the

149
00:05:38,060 --> 00:05:41,900
info.plist file in like a Mac OS package

150
00:05:40,340 --> 00:05:43,820
and like for those who aren't familiar

151
00:05:41,900 --> 00:05:45,919
with Mac OS that's like a metadata file

152
00:05:43,820 --> 00:05:47,210
that's in every single application that

153
00:05:45,919 --> 00:05:49,070
tells you about the application itself

154
00:05:47,210 --> 00:05:50,780
and then when you go a bit deeper into

155
00:05:49,070 --> 00:05:52,099
diving into like we're looking at these

156
00:05:50,780 --> 00:05:53,630
thick client applications we start

157
00:05:52,100 --> 00:05:55,250
reversing the binaries themselves and

158
00:05:53,630 --> 00:05:57,770
here what we're looking for is

159
00:05:55,250 --> 00:05:58,789
opportunities as web exploit depths the

160
00:05:57,770 --> 00:06:00,109
things that we're familiar and

161
00:05:58,789 --> 00:06:01,610
comfortable with so we're looking at web

162
00:06:00,110 --> 00:06:03,800
servers or open ports that these

163
00:06:01,610 --> 00:06:05,510
binaries open looking for interesting

164
00:06:03,800 --> 00:06:06,560
function names or simple names that

165
00:06:05,510 --> 00:06:08,300
might give us hints about what's

166
00:06:06,560 --> 00:06:10,070
happening and we look for like obvious

167
00:06:08,300 --> 00:06:11,690
hard-coded secrets and hard coded

168
00:06:10,070 --> 00:06:13,760
strings that disclose like some

169
00:06:11,690 --> 00:06:15,680
interesting stuff about him now a

170
00:06:13,760 --> 00:06:17,090
smaller side that's not the subject of

171
00:06:15,680 --> 00:06:18,710
this talk but it's also worthwhile

172
00:06:17,090 --> 00:06:20,510
thinking about the server side to these

173
00:06:18,710 --> 00:06:22,880
applications and usually there's

174
00:06:20,510 --> 00:06:24,919
enterprise deployment solutions so for

175
00:06:22,880 --> 00:06:26,630
example in my github enterprise or like

176
00:06:24,919 --> 00:06:28,400
confluence Enterprise and they're

177
00:06:26,630 --> 00:06:30,440
usually VMs that you can download and

178
00:06:28,400 --> 00:06:32,179
deploy here in infrastructure now it's

179
00:06:30,440 --> 00:06:33,410
pretty easy to route these VMs just like

180
00:06:32,180 --> 00:06:35,060
you ruin another VM and then you can

181
00:06:33,410 --> 00:06:36,380
just dump the source code so you feel

182
00:06:35,060 --> 00:06:38,240
like auditing source that's another

183
00:06:36,380 --> 00:06:40,430
opportunity it may or may not be viable

184
00:06:38,240 --> 00:06:41,870
with zoom we initially looked at this

185
00:06:40,430 --> 00:06:43,220
but didn't really explore it and we're

186
00:06:41,870 --> 00:06:44,150
not gonna look at it in this talk but if

187
00:06:43,220 --> 00:06:46,970
you want to do something that you're

188
00:06:44,150 --> 00:06:49,039
seeing you got that so looking into what

189
00:06:46,970 --> 00:06:51,530
we did for this event shards notice the

190
00:06:49,039 --> 00:06:53,810
zoom application package had a sub

191
00:06:51,530 --> 00:06:55,099
package called zoom open on and you can

192
00:06:53,810 --> 00:06:56,930
do this by like right clicking on the

193
00:06:55,099 --> 00:06:57,960
zoom tap going the package contents

194
00:06:56,930 --> 00:06:59,789
looking at the frameworks

195
00:06:57,960 --> 00:07:02,039
and digging through the info keyless

196
00:06:59,789 --> 00:07:05,280
file he found I registered a URL handler

197
00:07:02,039 --> 00:07:06,870
could zoom open on now as with jobs

198
00:07:05,280 --> 00:07:08,580
every time he comes across something the

199
00:07:06,870 --> 00:07:10,860
first reaction is there's got to be an

200
00:07:08,580 --> 00:07:13,050
RC e here so he immediately sends it to

201
00:07:10,860 --> 00:07:14,490
me in Austin they reverse it but before

202
00:07:13,050 --> 00:07:15,900
I dive in till reversing the actual

203
00:07:14,490 --> 00:07:18,419
binary I want height to smaller sites

204
00:07:15,900 --> 00:07:20,698
for those who aren't familiar Ural

205
00:07:18,419 --> 00:07:22,500
handlers are kind of like your HTTP or

206
00:07:20,699 --> 00:07:24,660
FTP handlers they sort of like define a

207
00:07:22,500 --> 00:07:26,310
protocol and you can open them but these

208
00:07:24,660 --> 00:07:28,229
are allow you to like open specific

209
00:07:26,310 --> 00:07:30,060
applications so you might have like a

210
00:07:28,229 --> 00:07:32,430
Microsoft Word handler or a steam

211
00:07:30,060 --> 00:07:34,110
handler or like a zoom opener Handler

212
00:07:32,430 --> 00:07:36,060
and effectively what this allows you to

213
00:07:34,110 --> 00:07:37,800
do is deep link into application

214
00:07:36,060 --> 00:07:39,419
functionality so this might open a

215
00:07:37,800 --> 00:07:42,330
specific page in your application or

216
00:07:39,419 --> 00:07:43,799
execute a specific function so for those

217
00:07:42,330 --> 00:07:46,169
who are more familiar with mobile stuff

218
00:07:43,800 --> 00:07:48,419
this is like iOS URL handlers or like

219
00:07:46,169 --> 00:07:50,219
Android exported activities so other

220
00:07:48,419 --> 00:07:53,130
applications can trigger functionality

221
00:07:50,220 --> 00:07:55,169
in your app the second aside I wanted to

222
00:07:53,130 --> 00:07:57,180
make was that the reason we found zoom

223
00:07:55,169 --> 00:07:58,380
open are particularly interesting was

224
00:07:57,180 --> 00:08:00,030
that there was a difference between the

225
00:07:58,380 --> 00:08:01,979
two operating systems when I was looking

226
00:08:00,030 --> 00:08:03,900
at zoom for Windows there was no mention

227
00:08:01,979 --> 00:08:05,820
of zoom open or the registered Farhana

228
00:08:03,900 --> 00:08:08,370
wasn't even there there's no registry

229
00:08:05,820 --> 00:08:09,690
entries and was only on Mac OS so this

230
00:08:08,370 --> 00:08:11,430
immediately started triggering alarm

231
00:08:09,690 --> 00:08:13,440
bells in my head because I'm thinking

232
00:08:11,430 --> 00:08:14,669
this is a specific handler that's not

233
00:08:13,440 --> 00:08:15,990
even on Windows it's probably like a

234
00:08:14,669 --> 00:08:18,270
custom code path they devote

235
00:08:15,990 --> 00:08:20,729
specifically of Mac OS so that makes

236
00:08:18,270 --> 00:08:22,469
this especially interesting now some of

237
00:08:20,729 --> 00:08:25,139
our colleagues did look into I think the

238
00:08:22,469 --> 00:08:26,310
Linux version of zoom but they didn't

239
00:08:25,139 --> 00:08:27,930
like we didn't dive too much since we

240
00:08:26,310 --> 00:08:29,070
spend most of our time on Mac OS so if

241
00:08:27,930 --> 00:08:31,259
you want some of your own research

242
00:08:29,070 --> 00:08:34,349
that's potentially interesting target to

243
00:08:31,259 --> 00:08:36,300
go after so now let's get to zoom open

244
00:08:34,349 --> 00:08:37,860
on when I started reversing the binary I

245
00:08:36,299 --> 00:08:41,490
discovered a web server while spinning

246
00:08:37,860 --> 00:08:43,140
up and port 19 421 and what this web

247
00:08:41,490 --> 00:08:44,730
server and what this new our handler was

248
00:08:43,140 --> 00:08:46,560
doing is that your handler is

249
00:08:44,730 --> 00:08:48,480
effectively act as like a kind of proxy

250
00:08:46,560 --> 00:08:50,160
it would wrap requests that you made to

251
00:08:48,480 --> 00:08:52,680
zoom open on and send them to the web

252
00:08:50,160 --> 00:08:53,939
server and what was happening on this

253
00:08:52,680 --> 00:08:56,099
web server was there's a launch

254
00:08:53,940 --> 00:08:57,870
endpoint which took like a whole bunch

255
00:08:56,100 --> 00:08:59,940
of different parameters one of which was

256
00:08:57,870 --> 00:09:01,770
the domain parameter so when we further

257
00:08:59,940 --> 00:09:03,360
dog through the binary itself we

258
00:09:01,770 --> 00:09:06,300
discovered a function called download

259
00:09:03,360 --> 00:09:08,070
zoom client for domain and given that

260
00:09:06,300 --> 00:09:09,949
this applications called zoom open or

261
00:09:08,070 --> 00:09:11,930
could probably open zoom

262
00:09:09,950 --> 00:09:13,760
if we can download a zoom client from a

263
00:09:11,930 --> 00:09:16,430
domain you specify it sounds like

264
00:09:13,760 --> 00:09:18,589
because open files that we specify want

265
00:09:16,430 --> 00:09:21,649
to download so we got really excited at

266
00:09:18,589 --> 00:09:22,850
the potential for an RC but then we

267
00:09:21,649 --> 00:09:24,500
started digging some wall and we

268
00:09:22,850 --> 00:09:26,029
realized that the reason why there are

269
00:09:24,500 --> 00:09:27,649
so many symbols and the names are so

270
00:09:26,029 --> 00:09:30,230
descriptive is because this is

271
00:09:27,649 --> 00:09:32,120
objective-c and shoves and I are not

272
00:09:30,230 --> 00:09:34,790
exactly the best objective-c reverses

273
00:09:32,120 --> 00:09:36,740
right well like web developer the

274
00:09:34,790 --> 00:09:38,360
engineers we like hack websites so

275
00:09:36,740 --> 00:09:39,889
instead of wasted the next three hours

276
00:09:38,360 --> 00:09:41,860
and the flood bashing your head against

277
00:09:39,889 --> 00:09:44,240
the wall we decide to wait till we got

278
00:09:41,860 --> 00:09:45,860
meddled with Michael in Singapore and

279
00:09:44,240 --> 00:09:47,329
he's got a whole bunch of experience

280
00:09:45,860 --> 00:09:50,029
reversing objective-c because he's done

281
00:09:47,329 --> 00:09:51,649
a whole bunch of research into iOS so he

282
00:09:50,029 --> 00:09:53,389
decides the way and then the next day

283
00:09:51,649 --> 00:09:54,800
we're all in Singapore we're in my hotel

284
00:09:53,389 --> 00:09:56,690
room just hacking on some different

285
00:09:54,800 --> 00:09:58,790
targets and shops hits a mic with the

286
00:09:56,690 --> 00:10:02,410
good ol hey man I wasn't really

287
00:09:58,790 --> 00:10:05,510
interesting for you okay this is where

288
00:10:02,410 --> 00:10:07,310
we dive into the logic for that's like

289
00:10:05,510 --> 00:10:09,139
the core of the button I was actually a

290
00:10:07,310 --> 00:10:11,060
few at the end of the day but you know

291
00:10:09,139 --> 00:10:13,610
myself having not spent that much time

292
00:10:11,060 --> 00:10:14,839
like preparing for this event and I was

293
00:10:13,610 --> 00:10:16,430
kind of really keen to sink my teeth

294
00:10:14,839 --> 00:10:19,579
into something that was in my wheelhouse

295
00:10:16,430 --> 00:10:21,560
I'm like shell jobs let's take a look so

296
00:10:19,579 --> 00:10:24,019
as fired up assume opener NIDA and and

297
00:10:21,560 --> 00:10:26,479
kind of got to work so I was able to

298
00:10:24,019 --> 00:10:28,310
confirm that when the software a

299
00:10:26,480 --> 00:10:30,350
software update is triggered with the

300
00:10:28,310 --> 00:10:33,170
correct end point that that download

301
00:10:30,350 --> 00:10:35,570
zoom client for domain which is in the Z

302
00:10:33,170 --> 00:10:37,760
M launch manager class is called and it

303
00:10:35,570 --> 00:10:39,740
is passing in as its argument that

304
00:10:37,760 --> 00:10:41,870
domains supplied to the launch endpoint

305
00:10:39,740 --> 00:10:44,839
so as basically as the guys had

306
00:10:41,870 --> 00:10:46,850
suspected so let's keep digging so just

307
00:10:44,839 --> 00:10:48,380
to go through this function at first

308
00:10:46,850 --> 00:10:50,720
checks if there is a downloaded

309
00:10:48,380 --> 00:10:52,819
installer package already on the user's

310
00:10:50,720 --> 00:10:54,230
machine and if that package is there it

311
00:10:52,819 --> 00:10:57,229
will just proceed to install it by

312
00:10:54,230 --> 00:10:59,029
calling this install package functional

313
00:10:57,230 --> 00:11:02,000
install PKG function which is also in

314
00:10:59,029 --> 00:11:03,350
the same class so that's that basically

315
00:11:02,000 --> 00:11:05,329
that code block right so it's just

316
00:11:03,350 --> 00:11:07,880
checking file exists at path and it's

317
00:11:05,329 --> 00:11:10,430
got this package file path variable if

318
00:11:07,880 --> 00:11:12,740
it does it calls install package all

319
00:11:10,430 --> 00:11:14,239
right pretty straightforward we thought

320
00:11:12,740 --> 00:11:16,880
initially this could potentially be our

321
00:11:14,240 --> 00:11:19,279
c in and of itself if we could set up a

322
00:11:16,880 --> 00:11:21,800
chain where you know triggers are

323
00:11:19,279 --> 00:11:23,420
malicious package to be in the place and

324
00:11:21,800 --> 00:11:25,370
like we trigger this install package

325
00:11:23,420 --> 00:11:26,780
um it's not really elegant and we wanted

326
00:11:25,370 --> 00:11:29,000
to see if there's a way that we could

327
00:11:26,780 --> 00:11:31,670
trigger it in a more seamless way so we

328
00:11:29,000 --> 00:11:33,970
kept digging so the next sort of chord

329
00:11:31,670 --> 00:11:38,930
path right if no package is downloaded

330
00:11:33,970 --> 00:11:40,220
already it exists at that that path it

331
00:11:38,930 --> 00:11:42,020
will trigger the download from the

332
00:11:40,220 --> 00:11:44,420
domain using the domain that we've

333
00:11:42,020 --> 00:11:46,280
specified as an argument to the launch

334
00:11:44,420 --> 00:11:48,380
endpoint but it does some checks first

335
00:11:46,280 --> 00:11:50,990
right so the it just checks on that

336
00:11:48,380 --> 00:11:52,640
supplied to mate so what it will do is

337
00:11:50,990 --> 00:11:54,260
we'll do this exact match you can see

338
00:11:52,640 --> 00:11:58,010
that is equals to a string function

339
00:11:54,260 --> 00:11:59,840
which is just a framework function a Mac

340
00:11:58,010 --> 00:12:02,990
framework function which is checking

341
00:11:59,840 --> 00:12:06,380
like you know is it equal and so

342
00:12:02,990 --> 00:12:09,470
checking zoom us zoom zip alikom zoomed

343
00:12:06,380 --> 00:12:11,870
of calm and zoom calm and if the domains

344
00:12:09,470 --> 00:12:13,550
an exact match so we're like oh man it

345
00:12:11,870 --> 00:12:16,100
seems like it's validating the domain we

346
00:12:13,550 --> 00:12:17,900
may have some issues here but like maybe

347
00:12:16,100 --> 00:12:20,300
if we have a domain take over you know

348
00:12:17,900 --> 00:12:23,000
we could get our C so possibly over to

349
00:12:20,300 --> 00:12:26,000
Ruby who's our R&D lead and I said note

350
00:12:23,000 --> 00:12:28,460
and he's like a guru with a subdomain

351
00:12:26,000 --> 00:12:29,960
take over so he started looking for that

352
00:12:28,460 --> 00:12:33,260
on other domains and Jonathan actually

353
00:12:29,960 --> 00:12:36,050
mentioned this in the in his blog post

354
00:12:33,260 --> 00:12:37,939
because he didn't quite get as far in

355
00:12:36,050 --> 00:12:41,750
terms of looking through through the web

356
00:12:37,940 --> 00:12:44,000
server in in detail but while he was

357
00:12:41,750 --> 00:12:45,470
doing that I kept looking so it's

358
00:12:44,000 --> 00:12:46,130
continuing through it and I noticed

359
00:12:45,470 --> 00:12:49,190
something strange

360
00:12:46,130 --> 00:12:51,680
so if if the code doesn't exactly match

361
00:12:49,190 --> 00:12:54,890
on those domains it actually calls the

362
00:12:51,680 --> 00:12:57,109
following code you can see here this has

363
00:12:54,890 --> 00:12:59,240
suffix which is again just a framework

364
00:12:57,110 --> 00:13:00,650
method and returns a boolean value

365
00:12:59,240 --> 00:13:02,990
whether the string ends with the

366
00:13:00,650 --> 00:13:06,800
specified suffix or not so what this is

367
00:13:02,990 --> 00:13:10,850
actually doing is it's checking if the

368
00:13:06,800 --> 00:13:13,339
domain pyramidal ends with one of those

369
00:13:10,850 --> 00:13:16,100
you know four domains right

370
00:13:13,340 --> 00:13:17,420
so zoom gov whatever right it's like on

371
00:13:16,100 --> 00:13:20,650
the end if it's on the end of this

372
00:13:17,420 --> 00:13:25,640
string then it's it's returning true

373
00:13:20,650 --> 00:13:30,590
right so that was that was pretty big

374
00:13:25,640 --> 00:13:32,000
right and so that that was the core sort

375
00:13:30,590 --> 00:13:34,550
of logic flaw and then once it's

376
00:13:32,000 --> 00:13:36,830
downloaded the package is then installed

377
00:13:34,550 --> 00:13:39,769
by that same install package from

378
00:13:36,830 --> 00:13:42,350
and all that function does is takes the

379
00:13:39,769 --> 00:13:44,420
package and passes it to installer which

380
00:13:42,350 --> 00:13:46,610
is just you know pkg files are just like

381
00:13:44,420 --> 00:13:48,260
the Mac OS like bsds or the package

382
00:13:46,610 --> 00:13:50,600
management sort of stuff and installers

383
00:13:48,260 --> 00:13:51,920
just a way to install it so putting it

384
00:13:50,600 --> 00:13:54,769
all together we knew we could probably

385
00:13:51,920 --> 00:13:57,199
get RCE here but we wanted to make sure

386
00:13:54,769 --> 00:13:59,240
so so that's shown to set up a server

387
00:13:57,200 --> 00:14:01,370
using a demeanor registered as a known

388
00:13:59,240 --> 00:14:03,680
hack zoom calm and hooking through the

389
00:14:01,370 --> 00:14:05,300
runtime using script I call this

390
00:14:03,680 --> 00:14:07,099
function direct I called that function

391
00:14:05,300 --> 00:14:10,370
directly and supply the domain as you

392
00:14:07,100 --> 00:14:12,170
can see here it ends with dot zoom us so

393
00:14:10,370 --> 00:14:13,970
it's it's triggering that suffix check

394
00:14:12,170 --> 00:14:15,709
and it's passing that suffix check and

395
00:14:13,970 --> 00:14:17,149
we got the hit and it worked right so

396
00:14:15,709 --> 00:14:18,439
just a little side note on script for

397
00:14:17,149 --> 00:14:20,870
those who don't know it's got a

398
00:14:18,440 --> 00:14:24,079
ridiculous name it's not Sai crypt it's

399
00:14:20,870 --> 00:14:26,959
called pronounced script and the premise

400
00:14:24,079 --> 00:14:28,760
is kind of even more ridiculous it's

401
00:14:26,959 --> 00:14:30,979
sort of blending objective-c in

402
00:14:28,760 --> 00:14:32,060
JavaScript that's from their website but

403
00:14:30,980 --> 00:14:34,070
it is a really great tool for

404
00:14:32,060 --> 00:14:37,729
interrogating and nipping manipulating

405
00:14:34,070 --> 00:14:40,160
the runtime of objective-c apps so you

406
00:14:37,730 --> 00:14:42,380
can you can actually hook it into the

407
00:14:40,160 --> 00:14:44,709
process is what I was doing here

408
00:14:42,380 --> 00:14:48,260
or you can run sort of scripts as well

409
00:14:44,709 --> 00:14:49,579
script scripts great name and so here's

410
00:14:48,260 --> 00:14:50,990
some some of those little little tips

411
00:14:49,579 --> 00:14:52,399
and tricks I've presented this before

412
00:14:50,990 --> 00:14:54,500
but I just want to go over it just for

413
00:14:52,399 --> 00:14:56,540
those who weren't familiar you can do

414
00:14:54,500 --> 00:14:59,000
some some cool stuff with the runtime

415
00:14:56,540 --> 00:15:01,339
I'm you can print methods all that kind

416
00:14:59,000 --> 00:15:04,339
of stuff so triggering the download

417
00:15:01,339 --> 00:15:06,350
we're back to show ya so at this point

418
00:15:04,339 --> 00:15:08,630
we're like pretty happy with ourselves

419
00:15:06,350 --> 00:15:10,760
we're thinking yeah we can trigger a

420
00:15:08,630 --> 00:15:12,260
darwin from wherever we want like at

421
00:15:10,760 --> 00:15:14,149
this point it should be trivial to

422
00:15:12,260 --> 00:15:15,620
trigger the aussie a and we're like you

423
00:15:14,149 --> 00:15:17,810
know let's just head off the drinks it's

424
00:15:15,620 --> 00:15:19,550
like 10:00 p.m. in singapore surely this

425
00:15:17,810 --> 00:15:20,989
someplace with beers they're really

426
00:15:19,550 --> 00:15:23,660
overpriced and we think like the next

427
00:15:20,990 --> 00:15:25,790
day's gonna be super easy right how

428
00:15:23,660 --> 00:15:27,079
wrong we were right when we started on

429
00:15:25,790 --> 00:15:28,969
the next morning of hack 2 trying to

430
00:15:27,079 --> 00:15:31,729
trigger this aussie those just huddle

431
00:15:28,970 --> 00:15:33,410
after huddle we had to hit and like web

432
00:15:31,730 --> 00:15:35,149
server that was running locally it

433
00:15:33,410 --> 00:15:36,560
wasn't doing what we expected looking

434
00:15:35,149 --> 00:15:38,930
through the requests it was making like

435
00:15:36,560 --> 00:15:40,670
we had requests the images to other pods

436
00:15:38,930 --> 00:15:42,649
that like weren't finishing or what

437
00:15:40,670 --> 00:15:44,870
resolving properly so we passed it over

438
00:15:42,649 --> 00:15:46,610
to QE who's our resident javascript guru

439
00:15:44,870 --> 00:15:48,079
and he starts digging through it right

440
00:15:46,610 --> 00:15:49,500
and he's like reversing the JavaScript

441
00:15:48,079 --> 00:15:51,270
and when he figures out

442
00:15:49,500 --> 00:15:53,070
that all these requests the images that

443
00:15:51,270 --> 00:15:55,319
they're doing is returning an image with

444
00:15:53,070 --> 00:15:56,940
like specific dimensions and the reason

445
00:15:55,320 --> 00:15:59,160
these dimensions existed was they mapped

446
00:15:56,940 --> 00:16:00,900
to specific status codes and I guess

447
00:15:59,160 --> 00:16:01,980
like our interpretation was this would

448
00:16:00,900 --> 00:16:04,260
how that this was how they got around

449
00:16:01,980 --> 00:16:07,230
cause as in like cross-origin resource

450
00:16:04,260 --> 00:16:09,090
sharing because you can always load

451
00:16:07,230 --> 00:16:11,580
images and what we found out was like

452
00:16:09,090 --> 00:16:13,620
these status codes represented what zoom

453
00:16:11,580 --> 00:16:15,750
was doing in the background so like some

454
00:16:13,620 --> 00:16:17,250
of the status codes were one one which

455
00:16:15,750 --> 00:16:19,440
is a success meant that zoom

456
00:16:17,250 --> 00:16:21,120
successfully opened well like one two

457
00:16:19,440 --> 00:16:23,210
where you start like was it indication

458
00:16:21,120 --> 00:16:25,440
that it started a download etc etc etc

459
00:16:23,210 --> 00:16:27,180
and like we had dig through the jobs

460
00:16:25,440 --> 00:16:28,860
with a lot to find the specific mapping

461
00:16:27,180 --> 00:16:30,420
and then we could slowly figure out what

462
00:16:28,860 --> 00:16:31,800
was happening but we're like hitting

463
00:16:30,420 --> 00:16:33,900
that localhost end point and seeing

464
00:16:31,800 --> 00:16:35,339
requests come in so what we wanted to do

465
00:16:33,900 --> 00:16:37,410
was we wanted to triggered one two

466
00:16:35,340 --> 00:16:39,900
specifically and like this might seem

467
00:16:37,410 --> 00:16:41,490
easy but was surprisingly difficult we

468
00:16:39,900 --> 00:16:43,319
had to play around with a lot of state

469
00:16:41,490 --> 00:16:44,910
on this like system because when you

470
00:16:43,320 --> 00:16:46,860
install zoom it drops a whole bunch of

471
00:16:44,910 --> 00:16:47,790
files everywhere and like we couldn't

472
00:16:46,860 --> 00:16:49,860
exactly figure out what was happening

473
00:16:47,790 --> 00:16:52,020
we're like three different Macs all

474
00:16:49,860 --> 00:16:53,250
installing and uninstalling zoom and

475
00:16:52,020 --> 00:16:55,050
then we figured out like what was

476
00:16:53,250 --> 00:16:56,700
actually going on when zoom was

477
00:16:55,050 --> 00:16:58,620
installed it would drop a folder called

478
00:16:56,700 --> 00:17:00,510
dot serve us in your home directory and

479
00:16:58,620 --> 00:17:02,670
own copy zoom open out into that

480
00:17:00,510 --> 00:17:05,220
directory so when you ultimately deleted

481
00:17:02,670 --> 00:17:08,609
zoom cap it wouldn't do it dot zoom us

482
00:17:05,220 --> 00:17:10,470
and the precondition effectively was you

483
00:17:08,609 --> 00:17:12,780
had to install zoom once and then

484
00:17:10,470 --> 00:17:14,579
uninstall it so zoom dot app wouldn't

485
00:17:12,780 --> 00:17:16,649
exist but in your home directory

486
00:17:14,579 --> 00:17:19,109
zoom urban or dot app would exist and

487
00:17:16,650 --> 00:17:21,240
the way Mac OS works with URL handlers

488
00:17:19,109 --> 00:17:23,669
is that as long as your dot app exists

489
00:17:21,240 --> 00:17:25,260
somewhere on your disk that your handler

490
00:17:23,670 --> 00:17:27,300
will be registered for that specific

491
00:17:25,260 --> 00:17:28,920
application so that means super open all

492
00:17:27,300 --> 00:17:31,470
will still be on your like operating

493
00:17:28,920 --> 00:17:34,950
system as long if you didn't understand

494
00:17:31,470 --> 00:17:37,260
explicitly alongside zoom dot app and

495
00:17:34,950 --> 00:17:38,250
we're like what the hell yeah and the

496
00:17:37,260 --> 00:17:40,410
interesting thing about this is like

497
00:17:38,250 --> 00:17:42,630
we're thinking ok like what what is the

498
00:17:40,410 --> 00:17:44,250
the sort of exploitation scenarios and

499
00:17:42,630 --> 00:17:45,750
how realistic is this you know

500
00:17:44,250 --> 00:17:47,760
precondition and I was thinking to like

501
00:17:45,750 --> 00:17:49,980
how I use this right so we do a lot of

502
00:17:47,760 --> 00:17:51,330
meetings day to day you know the zoom

503
00:17:49,980 --> 00:17:53,220
there's all these other different ones

504
00:17:51,330 --> 00:17:55,139
WebEx whatever you install it for the

505
00:17:53,220 --> 00:17:57,150
meeting and then they like often order

506
00:17:55,140 --> 00:18:00,060
open when you start it's like I just

507
00:17:57,150 --> 00:18:01,679
delete them right so you know that to me

508
00:18:00,060 --> 00:18:02,789
felt kind of common because I do that

509
00:18:01,679 --> 00:18:04,849
all the time

510
00:18:02,789 --> 00:18:06,869
then like I guess the other scenario is

511
00:18:04,849 --> 00:18:09,269
you know and I don't know how likely

512
00:18:06,869 --> 00:18:11,519
this is but like maybe somebody releases

513
00:18:09,269 --> 00:18:13,289
a blog post that tells you that it can

514
00:18:11,519 --> 00:18:15,419
turn on your webcam and it goes viral

515
00:18:13,289 --> 00:18:17,309
and it gets a bunch of mainstream

516
00:18:15,419 --> 00:18:19,979
attention and then everybody uninstalls

517
00:18:17,309 --> 00:18:21,418
zoom thus making them more vulnerable I

518
00:18:19,979 --> 00:18:22,709
don't know if that's like a lot yes like

519
00:18:21,419 --> 00:18:26,009
one of the others I haven't happened

520
00:18:22,709 --> 00:18:27,509
right yeah all right

521
00:18:26,009 --> 00:18:29,699
so now that we understood the

522
00:18:27,509 --> 00:18:31,589
preconditions we needed assuming that

523
00:18:29,699 --> 00:18:32,849
occurred the only thing we needed to do

524
00:18:31,589 --> 00:18:35,129
to trigger and download onto your

525
00:18:32,849 --> 00:18:36,539
computer was to hit this endpoint and

526
00:18:35,129 --> 00:18:39,748
know that this endpoint had no

527
00:18:36,539 --> 00:18:41,639
authentication it had no specific CSRF

528
00:18:39,749 --> 00:18:43,409
tokens it had no required headers and

529
00:18:41,639 --> 00:18:45,569
you could just hit this from any single

530
00:18:43,409 --> 00:18:47,519
Bratt like any page on the Internet and

531
00:18:45,569 --> 00:18:49,769
a simple get request would trigger a

532
00:18:47,519 --> 00:18:52,049
download onto your like local disk and

533
00:18:49,769 --> 00:18:53,849
all these other parameters as well we

534
00:18:52,049 --> 00:18:56,069
were just copying and pasting them from

535
00:18:53,849 --> 00:18:57,239
another request for an eval azumed

536
00:18:56,069 --> 00:18:58,949
meaning that we'd had with another

537
00:18:57,239 --> 00:19:01,440
company the day before so wasn't it like

538
00:18:58,949 --> 00:19:03,479
was these were like critical for us to

539
00:19:01,440 --> 00:19:06,329
understand but he was just like a time

540
00:19:03,479 --> 00:19:08,190
value and USV we couldn't even figure

541
00:19:06,329 --> 00:19:09,719
out what USV was I think it's maybe to

542
00:19:08,190 --> 00:19:11,249
do with the version yeah I know but we

543
00:19:09,719 --> 00:19:14,519
just we just copied and pasted it

544
00:19:11,249 --> 00:19:16,559
basically yeah so the next question is

545
00:19:14,519 --> 00:19:18,629
how do we set up our own download server

546
00:19:16,559 --> 00:19:20,849
so we saw the malicious payload and you

547
00:19:18,629 --> 00:19:21,779
might be thinking that super-easy yeah

548
00:19:20,849 --> 00:19:23,549
we wish

549
00:19:21,779 --> 00:19:25,559
right when we dug into the download zoom

550
00:19:23,549 --> 00:19:27,179
client for domain function Mike would

551
00:19:25,559 --> 00:19:29,069
notice that there's a class method

552
00:19:27,179 --> 00:19:30,869
forget download URL so this is how is

553
00:19:29,069 --> 00:19:31,918
constructing the specific yollie we

554
00:19:30,869 --> 00:19:34,738
would pull out umm it would start

555
00:19:31,919 --> 00:19:36,359
downloading files prom and it might be a

556
00:19:34,739 --> 00:19:38,669
bit hard to see but this pretty much was

557
00:19:36,359 --> 00:19:40,678
a format string not a bug just a normal

558
00:19:38,669 --> 00:19:44,159
format string or take our domain and put

559
00:19:40,679 --> 00:19:45,959
it into this URL so when you tested it

560
00:19:44,159 --> 00:19:47,339
manually with scripts it pretty much

561
00:19:45,959 --> 00:19:49,229
would mean that when we supply get

562
00:19:47,339 --> 00:19:50,999
download URL and give it our domain

563
00:19:49,229 --> 00:19:52,469
it would just reconstruct this URL for

564
00:19:50,999 --> 00:19:54,359
us and try to pull the content from

565
00:19:52,469 --> 00:19:56,279
there now obviously when you're

566
00:19:54,359 --> 00:19:58,049
reconstructing your own malicious server

567
00:19:56,279 --> 00:19:59,729
you want to try to emulate the actual

568
00:19:58,049 --> 00:20:01,679
server as close as possible well we

569
00:19:59,729 --> 00:20:02,879
looked at zoom us we found that they

570
00:20:01,679 --> 00:20:05,579
were giving us a whole bunch of this

571
00:20:02,879 --> 00:20:07,109
metadata in this response now like let's

572
00:20:05,579 --> 00:20:09,509
dig a little bit into what this metadata

573
00:20:07,109 --> 00:20:10,829
has first of all at the front is gonna

574
00:20:09,509 --> 00:20:12,629
check some and you may be thinking

575
00:20:10,829 --> 00:20:14,428
that's a bit problematic but the thing

576
00:20:12,629 --> 00:20:16,159
is we control the download server so we

577
00:20:14,429 --> 00:20:18,020
can supply whatever checksum we want

578
00:20:16,160 --> 00:20:19,700
that doesn't actually matter anymore the

579
00:20:18,020 --> 00:20:21,350
real kicker is they didn't care about

580
00:20:19,700 --> 00:20:22,610
the checksum either so we didn't even

581
00:20:21,350 --> 00:20:25,580
either change this in the first place

582
00:20:22,610 --> 00:20:27,260
they just ignore it anyway the second

583
00:20:25,580 --> 00:20:29,270
thing is there's a URL here that says

584
00:20:27,260 --> 00:20:30,890
zoom installer package so this is the

585
00:20:29,270 --> 00:20:32,299
final file that they're actually hitting

586
00:20:30,890 --> 00:20:33,890
to pull out our files so it's like a

587
00:20:32,299 --> 00:20:35,870
little bit of interaction but finally we

588
00:20:33,890 --> 00:20:37,400
get there so we realize our target we

589
00:20:35,870 --> 00:20:40,570
want to don't like pull out from is

590
00:20:37,400 --> 00:20:42,740
trading this URL on our server responds

591
00:20:40,570 --> 00:20:44,178
now we have to actually try to set up

592
00:20:42,740 --> 00:20:45,740
this down and so on and we like

593
00:20:44,179 --> 00:20:48,080
encountered a few hurdles and I were

594
00:20:45,740 --> 00:20:50,090
like hacking up a random flossed

595
00:20:48,080 --> 00:20:51,770
application like the debug mode all and

596
00:20:50,090 --> 00:20:53,449
exposed to the Internet and we're just

597
00:20:51,770 --> 00:20:55,460
wondering why it wouldn't work and we

598
00:20:53,450 --> 00:20:57,409
realized that even though there wasn't

599
00:20:55,460 --> 00:21:00,020
like start kidding explicitly we still

600
00:20:57,409 --> 00:21:02,090
needed a valid TLS cert so thank you

601
00:21:00,020 --> 00:21:04,460
let's encrypt for giving us the easiest

602
00:21:02,090 --> 00:21:06,289
Kayla starts in like 30 seconds but

603
00:21:04,460 --> 00:21:08,720
after we started monitoring a bit more a

604
00:21:06,289 --> 00:21:11,000
slight aside this isn't a bomb but this

605
00:21:08,720 --> 00:21:12,500
w j MF endpoint just starts sending a

606
00:21:11,000 --> 00:21:13,669
whole bunch of telemetry back to the

607
00:21:12,500 --> 00:21:15,770
mothership like it would send back

608
00:21:13,669 --> 00:21:17,809
installer logs it would send back device

609
00:21:15,770 --> 00:21:19,460
information would send back like other

610
00:21:17,809 --> 00:21:21,770
random bits and bobs from like your

611
00:21:19,460 --> 00:21:23,780
computer it's not super personally

612
00:21:21,770 --> 00:21:25,220
sensitive interesting that they have a

613
00:21:23,780 --> 00:21:29,330
whole bunch of telemetry alongside

614
00:21:25,220 --> 00:21:31,010
installing 0 so this server code might

615
00:21:29,330 --> 00:21:32,510
be a bit hard to read from there but

616
00:21:31,010 --> 00:21:34,940
pretty much we just added all the

617
00:21:32,510 --> 00:21:36,770
endpoints that we observed that would be

618
00:21:34,940 --> 00:21:38,690
sent to us and we try to copy it from

619
00:21:36,770 --> 00:21:40,240
the actual zoom USA it's cut off a

620
00:21:38,690 --> 00:21:43,070
little bit on the side in the screenshot

621
00:21:40,240 --> 00:21:44,780
but yeah we literally like to check sums

622
00:21:43,070 --> 00:21:46,939
even like they weren't even valid check

623
00:21:44,780 --> 00:21:48,260
sums for our package like we just copied

624
00:21:46,940 --> 00:21:51,080
and pasted it

625
00:21:48,260 --> 00:21:53,919
so yeah it's cut off a little bit then

626
00:21:51,080 --> 00:21:56,750
we'll talk about the exploit a bit more

627
00:21:53,919 --> 00:21:59,240
so yes so now we now we were at this

628
00:21:56,750 --> 00:22:02,840
stage where we'd figured out that we

629
00:21:59,240 --> 00:22:04,700
could you know supply a domain that we

630
00:22:02,840 --> 00:22:06,649
controlled it was actually downloading

631
00:22:04,700 --> 00:22:08,840
something we're able to respond with the

632
00:22:06,650 --> 00:22:10,460
right information to give it our

633
00:22:08,840 --> 00:22:12,649
malicious package so the next step is

634
00:22:10,460 --> 00:22:13,640
let's cut off this malicious package and

635
00:22:12,650 --> 00:22:17,330
go from there

636
00:22:13,640 --> 00:22:18,590
so so yeah we weren't done yet but one

637
00:22:17,330 --> 00:22:20,480
of the characteristics of these bug

638
00:22:18,590 --> 00:22:23,149
events is that their time that's right

639
00:22:20,480 --> 00:22:24,350
so it's one day you can do some prep

640
00:22:23,150 --> 00:22:26,690
that give you the scope a little bit

641
00:22:24,350 --> 00:22:29,030
ahead of time but the actual hacking is

642
00:22:26,690 --> 00:22:29,580
is one day and for us if we didn't get

643
00:22:29,030 --> 00:22:32,280
this bug

644
00:22:29,580 --> 00:22:34,409
done in that day that it wouldn't be in

645
00:22:32,280 --> 00:22:36,930
scope we wouldn't get any money for it

646
00:22:34,410 --> 00:22:40,290
and whatever so we were you know running

647
00:22:36,930 --> 00:22:41,910
down the clock at this point so QE and

648
00:22:40,290 --> 00:22:44,399
Sherman working on the server I started

649
00:22:41,910 --> 00:22:46,590
working on the payload so initially I

650
00:22:44,400 --> 00:22:49,080
set out to create a Mac OS installer

651
00:22:46,590 --> 00:22:51,090
package but that was out on a malicious

652
00:22:49,080 --> 00:22:53,730
package so with these packages you can

653
00:22:51,090 --> 00:22:56,250
actually set pre and post install

654
00:22:53,730 --> 00:22:57,870
scripts like just bash scripts that run

655
00:22:56,250 --> 00:23:00,570
the code so that's that was sort of my

656
00:22:57,870 --> 00:23:02,550
angle for rcee we'd have it run this

657
00:23:00,570 --> 00:23:05,340
like pre install script and go from

658
00:23:02,550 --> 00:23:07,440
there so the interesting thing with when

659
00:23:05,340 --> 00:23:08,399
you do this with zoom and so when you

660
00:23:07,440 --> 00:23:09,990
trigger the update

661
00:23:08,400 --> 00:23:11,640
it you'll see it when we have the video

662
00:23:09,990 --> 00:23:14,400
of the POC at the end but it shows up a

663
00:23:11,640 --> 00:23:17,550
little dialog box saying like you know

664
00:23:14,400 --> 00:23:20,340
zoom is downloading right and then it

665
00:23:17,550 --> 00:23:22,710
just sort of opens up once it's done and

666
00:23:20,340 --> 00:23:24,209
so like you know quite silent and you

667
00:23:22,710 --> 00:23:26,520
know we wanted to do that but when we

668
00:23:24,210 --> 00:23:28,110
were going through this method one of

669
00:23:26,520 --> 00:23:30,320
the things that we noticed was it was

670
00:23:28,110 --> 00:23:32,870
actually throwing up the default Mac OS

671
00:23:30,320 --> 00:23:35,040
installer GUI for the Installer

672
00:23:32,870 --> 00:23:36,959
process and the Installer packages where

673
00:23:35,040 --> 00:23:38,730
you click through like select your hard

674
00:23:36,960 --> 00:23:41,850
drive you know click Next click Next and

675
00:23:38,730 --> 00:23:43,080
whatever and you know we that wasn't

676
00:23:41,850 --> 00:23:46,709
great and I'm like well how come like

677
00:23:43,080 --> 00:23:48,510
bazoom is is you know not doing this and

678
00:23:46,710 --> 00:23:50,160
like you know we're triggering it we

679
00:23:48,510 --> 00:23:52,350
tried it even if we just you know took

680
00:23:50,160 --> 00:23:54,780
our package and like pass it straight to

681
00:23:52,350 --> 00:23:57,540
the Installer binary it was still doing

682
00:23:54,780 --> 00:23:59,250
it we couldn't really figure out why and

683
00:23:57,540 --> 00:24:00,659
and because of the time constraints we

684
00:23:59,250 --> 00:24:05,040
kind of moved on to other methods but we

685
00:24:00,660 --> 00:24:07,070
found out after that the reason it works

686
00:24:05,040 --> 00:24:09,720
in zoom the way that it does is

687
00:24:07,070 --> 00:24:12,030
basically they take the pre install

688
00:24:09,720 --> 00:24:13,740
script they get it to do everything that

689
00:24:12,030 --> 00:24:15,120
it needs to do like parse all the files

690
00:24:13,740 --> 00:24:17,100
and then they actually kill the

691
00:24:15,120 --> 00:24:20,100
Installer process so it doesn't show up

692
00:24:17,100 --> 00:24:21,360
the GUI so that's how this this thing

693
00:24:20,100 --> 00:24:22,919
works and that was sort of after we

694
00:24:21,360 --> 00:24:24,179
released it people like I yeah this is

695
00:24:22,920 --> 00:24:26,970
what it what it's about I'm like are

696
00:24:24,180 --> 00:24:28,170
cool so that technique would work but we

697
00:24:26,970 --> 00:24:30,120
didn't actually use that technique in

698
00:24:28,170 --> 00:24:33,390
the end because we're all flustered you

699
00:24:30,120 --> 00:24:34,770
know trying to get this done in time so

700
00:24:33,390 --> 00:24:36,780
you know time was running out

701
00:24:34,770 --> 00:24:38,370
frustrations and and I'll sort of drive

702
00:24:36,780 --> 00:24:40,020
and ambition to get this over the line

703
00:24:38,370 --> 00:24:42,199
we really started trying a number of

704
00:24:40,020 --> 00:24:44,360
different techniques we tinkered with

705
00:24:42,200 --> 00:24:46,190
Injection by the package name right so

706
00:24:44,360 --> 00:24:48,679
the package was being passed this

707
00:24:46,190 --> 00:24:50,360
installer function it's just like

708
00:24:48,680 --> 00:24:53,120
calling out to like user s bian

709
00:24:50,360 --> 00:24:54,199
installer and it says you know we tried

710
00:24:53,120 --> 00:24:56,000
all different kinds of command injection

711
00:24:54,200 --> 00:24:58,850
we think this would work but we couldn't

712
00:24:56,000 --> 00:25:00,950
get it quite to work in the time and

713
00:24:58,850 --> 00:25:02,870
then shops actually suggested a

714
00:25:00,950 --> 00:25:04,010
technique that he'd used on other bug

715
00:25:02,870 --> 00:25:07,520
bounties which is actually a cool little

716
00:25:04,010 --> 00:25:08,930
nifty technique it's the sort of the dot

717
00:25:07,520 --> 00:25:11,660
terminal trick the terminal profile

718
00:25:08,930 --> 00:25:13,250
trick so in terminal app on Mac OS you

719
00:25:11,660 --> 00:25:15,590
can create a terminal profile which is

720
00:25:13,250 --> 00:25:17,060
just a terminal file and allows you to

721
00:25:15,590 --> 00:25:20,500
specify a start up command so you can

722
00:25:17,060 --> 00:25:22,850
see here this is this run command value

723
00:25:20,500 --> 00:25:24,590
and using this technique you can run

724
00:25:22,850 --> 00:25:26,689
commands when you open this terminal

725
00:25:24,590 --> 00:25:28,429
profile and it bypasses like a whole

726
00:25:26,690 --> 00:25:30,110
bunch of like permission checks and like

727
00:25:28,430 --> 00:25:31,730
any code signing restrictions and that

728
00:25:30,110 --> 00:25:35,060
kind of stuff so it's a pretty neat

729
00:25:31,730 --> 00:25:36,650
trick data technique so herbs coded it

730
00:25:35,060 --> 00:25:38,629
up so the way you can create this rather

731
00:25:36,650 --> 00:25:41,390
than like creating this this sort of

732
00:25:38,630 --> 00:25:43,340
plist XML sort of format you can just go

733
00:25:41,390 --> 00:25:45,980
into on Mac OS you go into the terminal

734
00:25:43,340 --> 00:25:47,870
lab create a new profile and set it and

735
00:25:45,980 --> 00:25:50,030
then and then export it and download it

736
00:25:47,870 --> 00:25:51,709
so this is what it is again the

737
00:25:50,030 --> 00:25:54,260
screenshots kind of cut off our payload

738
00:25:51,710 --> 00:25:57,440
but essentially our payloads doing is

739
00:25:54,260 --> 00:25:59,540
opening our blog and opening calc

740
00:25:57,440 --> 00:26:03,320
because of course that's what you do and

741
00:25:59,540 --> 00:26:05,450
then just sending an alert box to the to

742
00:26:03,320 --> 00:26:06,889
display a message basically and also the

743
00:26:05,450 --> 00:26:08,270
stuff is just like standard stuff like

744
00:26:06,890 --> 00:26:10,100
what's the font and all that kind of

745
00:26:08,270 --> 00:26:12,620
stuff so you know nothing nothing really

746
00:26:10,100 --> 00:26:14,110
important in it was just the command

747
00:26:12,620 --> 00:26:16,610
string is the main one

748
00:26:14,110 --> 00:26:19,850
so we triggered the download and like

749
00:26:16,610 --> 00:26:21,530
success it all worked right and we were

750
00:26:19,850 --> 00:26:23,570
able to submit the port report we had a

751
00:26:21,530 --> 00:26:25,600
working Park everyone was ready to go

752
00:26:23,570 --> 00:26:28,760
get beers and just be done with this bug

753
00:26:25,600 --> 00:26:30,800
but I was running up the report and I

754
00:26:28,760 --> 00:26:32,990
wasn't really satisfied because if you

755
00:26:30,800 --> 00:26:34,399
if you remember how like the flow or at

756
00:26:32,990 --> 00:26:37,100
least what we'd understood at that point

757
00:26:34,400 --> 00:26:39,110
it was like passing it to this installer

758
00:26:37,100 --> 00:26:40,219
binary and shelbs was like ah don't

759
00:26:39,110 --> 00:26:41,929
worry about it man it's probably just

760
00:26:40,220 --> 00:26:43,490
opening the Installer binary opens up

761
00:26:41,930 --> 00:26:46,179
different files and whatever I'm like no

762
00:26:43,490 --> 00:26:48,429
it doesn't that's not how it works mate

763
00:26:46,179 --> 00:26:49,629
so like I wasn't satisfied these guys

764
00:26:48,429 --> 00:26:50,649
were ready to be done with this sunlight

765
00:26:49,629 --> 00:26:52,418
that's cool

766
00:26:50,649 --> 00:26:56,320
like I'm gonna dig into it a little bit

767
00:26:52,419 --> 00:26:58,240
more so this time long trick it kind of

768
00:26:56,320 --> 00:27:00,519
only typically works when you're passing

769
00:26:58,240 --> 00:27:02,139
that to an open URL or an open file call

770
00:27:00,519 --> 00:27:05,320
and there weren't any calls as you

771
00:27:02,139 --> 00:27:07,899
noticed to open file open URL in the

772
00:27:05,320 --> 00:27:09,908
flow that we've gone through so far so

773
00:27:07,899 --> 00:27:11,619
I'm like okay cool back to either let's

774
00:27:09,909 --> 00:27:13,210
see if we can find this so I started

775
00:27:11,619 --> 00:27:16,389
just doing like basic searches for open

776
00:27:13,210 --> 00:27:17,740
URL couldn't find any I'm sorry okay

777
00:27:16,389 --> 00:27:20,139
let's take a step back and see where we

778
00:27:17,740 --> 00:27:21,639
go I decided to revisit this install

779
00:27:20,139 --> 00:27:23,139
package function because I knew that it

780
00:27:21,639 --> 00:27:27,399
was going to that point and installing

781
00:27:23,139 --> 00:27:29,049
it so when I looked at in more depth I

782
00:27:27,399 --> 00:27:30,549
noticed that it called this install

783
00:27:29,049 --> 00:27:33,070
complete function which is also in this

784
00:27:30,549 --> 00:27:34,509
anymore launch manager class regardless

785
00:27:33,070 --> 00:27:37,418
of the outcome and the installer command

786
00:27:34,509 --> 00:27:38,559
I'm not sure why it doesn't matter as

787
00:27:37,419 --> 00:27:40,539
probably because like they're not

788
00:27:38,559 --> 00:27:43,418
actually using the installer command I

789
00:27:40,539 --> 00:27:45,309
guess and you know it's just running its

790
00:27:43,419 --> 00:27:47,320
pre installation script and killing it

791
00:27:45,309 --> 00:27:49,299
and then you know install complete right

792
00:27:47,320 --> 00:27:50,590
and then I think that's what and also in

793
00:27:49,299 --> 00:27:51,668
that function that kind of that's when

794
00:27:50,590 --> 00:27:53,049
it triggers setting off all that

795
00:27:51,669 --> 00:27:56,409
telemetry that Sean was talking about

796
00:27:53,049 --> 00:27:58,570
earlier but yeah so that's what I was

797
00:27:56,409 --> 00:28:00,369
doing and in in that install complete

798
00:27:58,570 --> 00:28:02,649
function I confirmed it was indeed

799
00:28:00,369 --> 00:28:03,249
passing the terminal file to this open

800
00:28:02,649 --> 00:28:04,449
file commit

801
00:28:03,249 --> 00:28:06,220
so the reason I didn't pick it up is

802
00:28:04,450 --> 00:28:07,450
because it's open file open file is

803
00:28:06,220 --> 00:28:08,860
actually deprecated but if you're

804
00:28:07,450 --> 00:28:11,259
looking for instances where to do this

805
00:28:08,860 --> 00:28:13,529
it's worth looking at this open file

806
00:28:11,259 --> 00:28:17,139
function as well so you can see here

807
00:28:13,529 --> 00:28:19,029
it's just taking package file path which

808
00:28:17,139 --> 00:28:25,029
is which is the file path for our

809
00:28:19,029 --> 00:28:27,700
download and passing it to open file so

810
00:28:25,029 --> 00:28:30,220
I confirmed that this was the case using

811
00:28:27,700 --> 00:28:32,710
frida so you can see here I've just set

812
00:28:30,220 --> 00:28:35,590
up free to trace which is like a tool

813
00:28:32,710 --> 00:28:38,100
that sort of bundled in with frida which

814
00:28:35,590 --> 00:28:40,629
traces functions as the name suggests

815
00:28:38,100 --> 00:28:42,340
and so I just did NS workspace which is

816
00:28:40,629 --> 00:28:45,369
the class that in the sort of framework

817
00:28:42,340 --> 00:28:48,519
class that open files in and you can see

818
00:28:45,369 --> 00:28:50,678
here that it is actually triggering this

819
00:28:48,519 --> 00:28:54,190
terminal file like a that is actually

820
00:28:50,679 --> 00:28:56,740
passing it so another side note about

821
00:28:54,190 --> 00:28:58,029
freedom freedom ooh hot nur's I can't

822
00:28:56,740 --> 00:28:59,620
say enough good things about free tour

823
00:28:58,029 --> 00:29:01,480
it's so much fun to use

824
00:28:59,620 --> 00:29:02,979
is basically a dynamic instrumentation

825
00:29:01,480 --> 00:29:04,240
toolkit this is from their website for

826
00:29:02,980 --> 00:29:06,250
reverse engineers and security

827
00:29:04,240 --> 00:29:07,990
researchers armatures injects Google's

828
00:29:06,250 --> 00:29:09,670
v8 engine into a process so you can

829
00:29:07,990 --> 00:29:11,080
execute JavaScript in the context of

830
00:29:09,670 --> 00:29:14,320
that process and it's got a bunch of

831
00:29:11,080 --> 00:29:16,179
framework functionality around it it's

832
00:29:14,320 --> 00:29:17,830
really great to write tools in

833
00:29:16,180 --> 00:29:19,450
and even just using some of the the

834
00:29:17,830 --> 00:29:20,530
packaged stuff so it does have a bunch

835
00:29:19,450 --> 00:29:22,720
of stuff that they've already written

836
00:29:20,530 --> 00:29:24,550
and you're free to CLI free to PS all

837
00:29:22,720 --> 00:29:26,530
that kind of stuff for the CLI and free

838
00:29:24,550 --> 00:29:28,270
to trace are probably the most immediate

839
00:29:26,530 --> 00:29:30,190
useful tools when it comes to like you

840
00:29:28,270 --> 00:29:31,960
know pen testing and bug hunting but

841
00:29:30,190 --> 00:29:34,210
like a little pro tip for free to trace

842
00:29:31,960 --> 00:29:37,210
so normally when you run for your trace

843
00:29:34,210 --> 00:29:39,309
you won't get this nice string output

844
00:29:37,210 --> 00:29:41,980
here you'll get you know memory

845
00:29:39,309 --> 00:29:43,870
addresses and like hex values and all

846
00:29:41,980 --> 00:29:46,570
that kind of stuff so it's not very

847
00:29:43,870 --> 00:29:49,030
human readable but you can see here it

848
00:29:46,570 --> 00:29:52,030
automatically sets up these handlers

849
00:29:49,030 --> 00:29:55,600
which are just free to JavaScript files

850
00:29:52,030 --> 00:29:58,960
right and you can modify those so a

851
00:29:55,600 --> 00:30:01,510
little neat little trick is you go into

852
00:29:58,960 --> 00:30:03,040
those handlers where it's taking that

853
00:30:01,510 --> 00:30:04,450
argument which would normally just give

854
00:30:03,040 --> 00:30:09,190
you like a memory address or whatever

855
00:30:04,450 --> 00:30:12,010
you can go over objc or Objective C dot

856
00:30:09,190 --> 00:30:14,170
object which is a frida function and

857
00:30:12,010 --> 00:30:15,520
basically creates a JavaScript binding

858
00:30:14,170 --> 00:30:17,200
for that object so then you can just use

859
00:30:15,520 --> 00:30:18,910
a regular JavaScript to interact with

860
00:30:17,200 --> 00:30:20,380
that so you can use something like two

861
00:30:18,910 --> 00:30:22,330
string which is what I did there just to

862
00:30:20,380 --> 00:30:24,179
show that that's actually also really

863
00:30:22,330 --> 00:30:27,460
useful for things like if you're tracing

864
00:30:24,179 --> 00:30:29,710
URL requests and stuff like that like NS

865
00:30:27,460 --> 00:30:33,250
URL connection and whatnot you can see

866
00:30:29,710 --> 00:30:37,240
the actual URLs that it's hitting in a

867
00:30:33,250 --> 00:30:40,900
more human readable output so the final

868
00:30:37,240 --> 00:30:43,920
POC as is putting it all together so you

869
00:30:40,900 --> 00:30:47,860
know you hit our malicious website

870
00:30:43,920 --> 00:30:51,640
that's the dialog box and bam you're it

871
00:30:47,860 --> 00:30:55,510
right and calc because of course and our

872
00:30:51,640 --> 00:30:57,160
blog we can read other great research so

873
00:30:55,510 --> 00:30:59,320
that's that's the that's the POC just

874
00:30:57,160 --> 00:31:01,390
pulling all together so basically what

875
00:30:59,320 --> 00:31:04,139
that's doing again just to recap the

876
00:31:01,390 --> 00:31:06,940
whole sort of chain we're hitting that

877
00:31:04,140 --> 00:31:09,310
that web server with the launch endpoint

878
00:31:06,940 --> 00:31:11,050
passing our own domain and on that

879
00:31:09,310 --> 00:31:12,210
domain we've got a web server that

880
00:31:11,050 --> 00:31:14,040
responds in the correct

881
00:31:12,210 --> 00:31:17,220
way that it needs to do to trigger a

882
00:31:14,040 --> 00:31:19,710
download we're sending it to a path for

883
00:31:17,220 --> 00:31:22,110
our malicious file that it's downloading

884
00:31:19,710 --> 00:31:24,120
downloading that and executing it as

885
00:31:22,110 --> 00:31:28,979
part of its install process and that's

886
00:31:24,120 --> 00:31:31,439
sort of the complete so antenna POC all

887
00:31:28,980 --> 00:31:33,480
right we're ahead of time was great some

888
00:31:31,440 --> 00:31:35,430
key takeaways yeah so you may be

889
00:31:33,480 --> 00:31:37,530
thinking how do we actually make this

890
00:31:35,430 --> 00:31:39,690
have a much bigger impact than just one

891
00:31:37,530 --> 00:31:41,730
or two people and you might be thinking

892
00:31:39,690 --> 00:31:43,350
like this might be a bit difficult to

893
00:31:41,730 --> 00:31:45,720
trigger but the realistic signal is

894
00:31:43,350 --> 00:31:48,090
given there's no earth there's no CSRF

895
00:31:45,720 --> 00:31:49,650
tokens all you need is a get request so

896
00:31:48,090 --> 00:31:52,500
if you send someone an email with the

897
00:31:49,650 --> 00:31:54,180
same like pixel image that MailChimp or

898
00:31:52,500 --> 00:31:56,430
like other mail providers use to give

899
00:31:54,180 --> 00:31:58,140
you open or read receipts if you use the

900
00:31:56,430 --> 00:31:59,910
same idea you can trigger web requests

901
00:31:58,140 --> 00:32:02,370
the same way and that is all you need to

902
00:31:59,910 --> 00:32:04,530
trigger an RCA alternatively if you have

903
00:32:02,370 --> 00:32:06,270
an exercice or you have like malicious

904
00:32:04,530 --> 00:32:08,580
JavaScript on any other sites your hosts

905
00:32:06,270 --> 00:32:10,200
people who visit your blog or visit your

906
00:32:08,580 --> 00:32:11,520
page instantly get popped

907
00:32:10,200 --> 00:32:12,900
now if you want to have a much bigger

908
00:32:11,520 --> 00:32:14,910
impact say you want to target a whole

909
00:32:12,900 --> 00:32:16,320
company what you could do is you can

910
00:32:14,910 --> 00:32:18,060
start sending targeted ads to this

911
00:32:16,320 --> 00:32:19,740
company and if you just have beds like

912
00:32:18,060 --> 00:32:21,750
some embedded JavaScript or an image

913
00:32:19,740 --> 00:32:23,550
into these targeted at by targeted ads

914
00:32:21,750 --> 00:32:25,290
you can start targeting like an entire

915
00:32:23,550 --> 00:32:27,360
company's worth of people and have some

916
00:32:25,290 --> 00:32:29,790
really lot like large impact mass

917
00:32:27,360 --> 00:32:31,199
exploitation star bugs assuming of

918
00:32:29,790 --> 00:32:34,980
course they had installed and

919
00:32:31,200 --> 00:32:37,850
uninstalled but yeah so with some of the

920
00:32:34,980 --> 00:32:42,060
responses and the fix fixes so Jonathan

921
00:32:37,850 --> 00:32:44,010
publicly disclosed the bug and you know

922
00:32:42,060 --> 00:32:46,220
people started looking into the the

923
00:32:44,010 --> 00:32:48,990
potential rcee that we had found earlier

924
00:32:46,220 --> 00:32:51,360
and then several fixes have now been

925
00:32:48,990 --> 00:32:52,890
pushed from both zoom and Apple the

926
00:32:51,360 --> 00:32:55,080
apples one is quite interesting it

927
00:32:52,890 --> 00:32:57,720
basically treated like the zoom opener

928
00:32:55,080 --> 00:33:00,240
in that sort of zoomed us as a zoom us

929
00:32:57,720 --> 00:33:01,920
folder as malware as part of their ex

930
00:33:00,240 --> 00:33:03,870
protect system so it just deletes it I

931
00:33:01,920 --> 00:33:06,540
just I just found that funny that the

932
00:33:03,870 --> 00:33:08,550
history has malware because the the

933
00:33:06,540 --> 00:33:10,170
reason we found it funny is early on we

934
00:33:08,550 --> 00:33:12,330
couldn't figure out like why they had

935
00:33:10,170 --> 00:33:15,420
this zoom opener right and it was kind

936
00:33:12,330 --> 00:33:16,949
of like you know for me it's like you

937
00:33:15,420 --> 00:33:18,750
don't have to zoom installed you just

938
00:33:16,950 --> 00:33:20,130
download it again and then you know

939
00:33:18,750 --> 00:33:21,960
trigger your meeting again or whatever

940
00:33:20,130 --> 00:33:23,040
we couldn't really figure out why it was

941
00:33:21,960 --> 00:33:24,990
and we had an intern

942
00:33:23,040 --> 00:33:27,270
nickname for zoom opener called zoom

943
00:33:24,990 --> 00:33:28,860
dropper so that's why I just found it

944
00:33:27,270 --> 00:33:31,379
neat that Apple sort of basically

945
00:33:28,860 --> 00:33:32,909
treated as malware none of these

946
00:33:31,380 --> 00:33:35,250
techniques should work in the latest

947
00:33:32,910 --> 00:33:37,110
versions but obviously we recommend you

948
00:33:35,250 --> 00:33:39,210
apply all the patches and reduce your

949
00:33:37,110 --> 00:33:41,870
exposure that's not to say there aren't

950
00:33:39,210 --> 00:33:45,570
other other bugs I mean this was pretty

951
00:33:41,870 --> 00:33:47,250
glaring and bad so like who knows what

952
00:33:45,570 --> 00:33:48,659
else is out there but you know

953
00:33:47,250 --> 00:33:49,830
definitely you know always patch your

954
00:33:48,660 --> 00:33:51,780
stuff right

955
00:33:49,830 --> 00:33:53,520
the other interesting thing that came

956
00:33:51,780 --> 00:33:56,430
out of all of this zoom app actually

957
00:33:53,520 --> 00:33:58,410
white label says zoom client to a number

958
00:33:56,430 --> 00:34:00,260
of different companies you know like

959
00:33:58,410 --> 00:34:02,640
mostly like telcos and stuff like that

960
00:34:00,260 --> 00:34:04,230
and they were all so vulnerable like it

961
00:34:02,640 --> 00:34:06,570
was all had the same code and it was all

962
00:34:04,230 --> 00:34:08,760
different you know different names but

963
00:34:06,570 --> 00:34:10,290
it was all the same stuff and Karen

964
00:34:08,760 --> 00:34:12,030
Lyons actually has a great guide on his

965
00:34:10,290 --> 00:34:14,550
github where he went through all of it

966
00:34:12,030 --> 00:34:16,410
and you know mapped it all out and you

967
00:34:14,550 --> 00:34:18,179
know collated all these ones so you can

968
00:34:16,409 --> 00:34:19,799
delete them Apple eventually went

969
00:34:18,179 --> 00:34:22,980
through and added those again to their

970
00:34:19,800 --> 00:34:24,169
system so there that's all good but that

971
00:34:22,980 --> 00:34:28,290
was just another interesting side note

972
00:34:24,168 --> 00:34:30,239
as well so the other point that I'll

973
00:34:28,290 --> 00:34:33,600
kind of want to make is collaboration is

974
00:34:30,239 --> 00:34:36,810
is key so you know this I guess still

975
00:34:33,600 --> 00:34:39,600
that you know stereotype or whatever of

976
00:34:36,810 --> 00:34:42,570
the lone hacker like hacking away for us

977
00:34:39,600 --> 00:34:44,668
this was like a team effort and you know

978
00:34:42,570 --> 00:34:48,360
it was a lot of fun and you know if any

979
00:34:44,668 --> 00:34:49,949
single one of us would just focus on

980
00:34:48,360 --> 00:34:51,000
this ourselves we probably would have

981
00:34:49,949 --> 00:34:53,668
given up and gone on to other things

982
00:34:51,000 --> 00:34:55,710
right you know giving up a traversing

983
00:34:53,668 --> 00:34:58,140
objective-c I definitely would have

984
00:34:55,710 --> 00:34:59,640
given up at JavaScript right I would

985
00:34:58,140 --> 00:35:03,600
have had an aneurysm trying to do that

986
00:34:59,640 --> 00:35:05,430
stuff and so so I definitely gave up

987
00:35:03,600 --> 00:35:06,960
there but you know all the pieces

988
00:35:05,430 --> 00:35:08,640
together and sort of you know came

989
00:35:06,960 --> 00:35:09,990
together it was a lot of fun it was the

990
00:35:08,640 --> 00:35:11,430
only bug that we ended up submitting for

991
00:35:09,990 --> 00:35:13,560
this event which is kind of unusual we

992
00:35:11,430 --> 00:35:15,540
tend to submit quite a few bugs but it

993
00:35:13,560 --> 00:35:17,220
was it was the most fun that I've had at

994
00:35:15,540 --> 00:35:18,390
least at any of these events so it was

995
00:35:17,220 --> 00:35:23,189
good so yeah I strongly recommend

996
00:35:18,390 --> 00:35:24,720
working together with the team the you

997
00:35:23,190 --> 00:35:28,170
know just you know whether it's pen

998
00:35:24,720 --> 00:35:30,959
testing bug hunting CTF whatever you'll

999
00:35:28,170 --> 00:35:32,430
learn a lot from each other and you know

1000
00:35:30,960 --> 00:35:34,950
you've got complementary skill sets

1001
00:35:32,430 --> 00:35:35,810
you'll be able to achieve more so

1002
00:35:34,950 --> 00:35:37,609
hacking

1003
00:35:35,810 --> 00:35:39,560
it's moments but you know the experience

1004
00:35:37,610 --> 00:35:42,260
that you get as a collaborative team is

1005
00:35:39,560 --> 00:35:43,850
a lot better I think the one thing we

1006
00:35:42,260 --> 00:35:45,380
found is especially with these events

1007
00:35:43,850 --> 00:35:46,790
what we all get together it's a lot

1008
00:35:45,380 --> 00:35:48,440
easier to keep morale up if you have

1009
00:35:46,790 --> 00:35:50,360
like four people in a room in a packet

1010
00:35:48,440 --> 00:35:51,530
rental yeah um it's a bit difficult if

1011
00:35:50,360 --> 00:35:53,240
everyone's aren't in their own homes

1012
00:35:51,530 --> 00:35:54,980
because like it's really easy to say

1013
00:35:53,240 --> 00:35:57,049
someone grabs lunch and it's really

1014
00:35:54,980 --> 00:35:59,330
quiet for two hours yeah and then morale

1015
00:35:57,050 --> 00:36:00,740
drops a little bit yeah so I mean I made

1016
00:35:59,330 --> 00:36:02,360
a note here about how like the

1017
00:36:00,740 --> 00:36:04,100
Australian InfoSec community is pretty

1018
00:36:02,360 --> 00:36:06,860
friendly and welcoming in my previous

1019
00:36:04,100 --> 00:36:08,690
role at Spider labs I had a lot of

1020
00:36:06,860 --> 00:36:09,890
involvement in Singapore as well and I

1021
00:36:08,690 --> 00:36:12,260
can say that that's also true for

1022
00:36:09,890 --> 00:36:14,060
Singapore got mad lads like Keith down

1023
00:36:12,260 --> 00:36:15,530
the front here like he's really solid

1024
00:36:14,060 --> 00:36:17,840
and should follow his stuff he's really

1025
00:36:15,530 --> 00:36:19,730
good and it's a really tight-knit kind

1026
00:36:17,840 --> 00:36:21,350
of community here as well so you know

1027
00:36:19,730 --> 00:36:23,140
definitely reach out to your peers and

1028
00:36:21,350 --> 00:36:25,279
you know have some fun hacking together

1029
00:36:23,140 --> 00:36:26,480
and then just the other thing we want to

1030
00:36:25,280 --> 00:36:29,720
recap with some of the tools and

1031
00:36:26,480 --> 00:36:31,970
techniques right we use to either but

1032
00:36:29,720 --> 00:36:34,759
you know hopper or Ghidorah thanks NSA

1033
00:36:31,970 --> 00:36:36,700
are really great alternatives and

1034
00:36:34,760 --> 00:36:39,110
they're cheaper and get dressed free

1035
00:36:36,700 --> 00:36:40,520
free dinner and scripts as I said I

1036
00:36:39,110 --> 00:36:42,230
can't say enough good things about

1037
00:36:40,520 --> 00:36:45,530
Frieda it's so much fun to use script is

1038
00:36:42,230 --> 00:36:47,120
great as well just you know it's it's

1039
00:36:45,530 --> 00:36:49,130
not as developed as much it's not really

1040
00:36:47,120 --> 00:36:50,900
designed for this sort of stuff it was

1041
00:36:49,130 --> 00:36:52,910
never designed to be a security kind of

1042
00:36:50,900 --> 00:36:55,100
tool even though you can use it for that

1043
00:36:52,910 --> 00:36:57,379
sort of stuff but yeah food is great

1044
00:36:55,100 --> 00:36:58,310
terminal profile trick is is is really

1045
00:36:57,380 --> 00:37:00,980
handy

1046
00:36:58,310 --> 00:37:02,750
you know shops did on on one of his

1047
00:37:00,980 --> 00:37:04,760
previous bounties but he found out about

1048
00:37:02,750 --> 00:37:07,760
it from other people finding these sorts

1049
00:37:04,760 --> 00:37:09,260
of bugs in other bounty programs so you

1050
00:37:07,760 --> 00:37:11,330
know probably a cool thing to look at if

1051
00:37:09,260 --> 00:37:13,400
you're interested in you know tweak you

1052
00:37:11,330 --> 00:37:15,259
know having a having a play around like

1053
00:37:13,400 --> 00:37:17,240
with these applications that were

1054
00:37:15,260 --> 00:37:19,250
testing server-side stuff being able to

1055
00:37:17,240 --> 00:37:21,500
just quickly hack up a script in - makes

1056
00:37:19,250 --> 00:37:23,930
it also super easy and like if you're

1057
00:37:21,500 --> 00:37:25,310
worried about SSL certs and domains like

1058
00:37:23,930 --> 00:37:27,410
let's encrypt makes your life so much

1059
00:37:25,310 --> 00:37:29,240
easier with that so if you have any

1060
00:37:27,410 --> 00:37:31,609
amount of coding skills Pisan super easy

1061
00:37:29,240 --> 00:37:34,759
to get set up with this stuff cool and

1062
00:37:31,610 --> 00:37:37,040
yeah the final point beer but the key to

1063
00:37:34,760 --> 00:37:40,940
this technique is not too much not too

1064
00:37:37,040 --> 00:37:44,000
little so just to be clear drink in

1065
00:37:40,940 --> 00:37:45,620
moderation guys cool and that's the end

1066
00:37:44,000 --> 00:37:47,800
of our talk so we can take take

1067
00:37:45,620 --> 00:37:47,799
questions

1068
00:37:50,750 --> 00:37:55,230
okay this is work okay that was really

1069
00:37:53,580 --> 00:37:57,799
fast so thank you so much for that

1070
00:37:55,230 --> 00:38:00,120
really interesting talk I just wanted to

1071
00:37:57,800 --> 00:38:01,500
throw it open to the floor first before

1072
00:38:00,120 --> 00:38:03,420
I go to the questions on slide Oh

1073
00:38:01,500 --> 00:38:06,180
anybody have any questions remember

1074
00:38:03,420 --> 00:38:09,060
their prizes available awesome

1075
00:38:06,180 --> 00:38:12,569
purple t-shirts right from acid ice why

1076
00:38:09,060 --> 00:38:16,799
get on it really nice swag so anybody

1077
00:38:12,570 --> 00:38:22,200
have any questions yes sir do you have

1078
00:38:16,800 --> 00:38:22,710
extra one actually I already posted in

1079
00:38:22,200 --> 00:38:25,500
dela

1080
00:38:22,710 --> 00:38:30,330
I want to ask is this the so called

1081
00:38:25,500 --> 00:38:31,530
drive-by download so no no so like so

1082
00:38:30,330 --> 00:38:33,900
you're referring to like the drive-by

1083
00:38:31,530 --> 00:38:36,270
download techniques that were somewhat

1084
00:38:33,900 --> 00:38:38,280
common in the past on Mac OS where would

1085
00:38:36,270 --> 00:38:40,740
automatically execute certain files that

1086
00:38:38,280 --> 00:38:43,500
were downloaded from Safari this isn't

1087
00:38:40,740 --> 00:38:43,830
that this is actually using zoom to do

1088
00:38:43,500 --> 00:38:45,810
that

1089
00:38:43,830 --> 00:38:47,549
I think for the most part anything

1090
00:38:45,810 --> 00:38:49,860
that's really sensitive to automatically

1091
00:38:47,550 --> 00:38:53,040
execute now in Mac OS it gives you a

1092
00:38:49,860 --> 00:38:54,360
little warning to say hey this is your

1093
00:38:53,040 --> 00:38:55,920
download from the internet you sure you

1094
00:38:54,360 --> 00:38:57,390
still want to open it and then if it's

1095
00:38:55,920 --> 00:38:58,500
from a developer that's not recognized

1096
00:38:57,390 --> 00:38:59,940
so it's not it's not one of them

1097
00:38:58,500 --> 00:39:01,680
notarized abs or it's not from through

1098
00:38:59,940 --> 00:39:03,750
the ABS you know through you know the

1099
00:39:01,680 --> 00:39:05,220
developer sign sort of thing it will

1100
00:39:03,750 --> 00:39:07,380
even say you even have to go into the

1101
00:39:05,220 --> 00:39:10,200
security settings to be like hey yes I'm

1102
00:39:07,380 --> 00:39:13,080
okay to open this so so those those

1103
00:39:10,200 --> 00:39:14,790
sorts of attacks are less common now and

1104
00:39:13,080 --> 00:39:16,770
this is this is kind of different this

1105
00:39:14,790 --> 00:39:18,570
is more just exploiting the inherent

1106
00:39:16,770 --> 00:39:19,170
functionality that was in the zoom open

1107
00:39:18,570 --> 00:39:21,030
our thing

1108
00:39:19,170 --> 00:39:23,430
sorry it's only thunk either on the zoom

1109
00:39:21,030 --> 00:39:24,870
yeah yeah room and zoom on Mac OS

1110
00:39:23,430 --> 00:39:27,210
specifically as John mentioned earlier

1111
00:39:24,870 --> 00:39:30,089
this functionality wasn't present on

1112
00:39:27,210 --> 00:39:32,790
Windows at the time we did have a few

1113
00:39:30,090 --> 00:39:35,490
folks one of the guys from Team Sweden

1114
00:39:32,790 --> 00:39:37,650
rig up to those guys was what they were

1115
00:39:35,490 --> 00:39:40,290
looking at the the Linux client after we

1116
00:39:37,650 --> 00:39:41,700
told them about this and there seemed to

1117
00:39:40,290 --> 00:39:43,680
be some sort of similar functionality

1118
00:39:41,700 --> 00:39:46,680
there but neither of us really explored

1119
00:39:43,680 --> 00:39:47,850
that so if you want to go you know hack

1120
00:39:46,680 --> 00:39:51,029
on something that might be a good thing

1121
00:39:47,850 --> 00:39:53,630
to look at but but yeah it was just on

1122
00:39:51,030 --> 00:39:56,160
Mac OS specifically yeah you see I have

1123
00:39:53,630 --> 00:39:58,410
been using the Chrome browser

1124
00:39:56,160 --> 00:40:01,600
we should remembers my sign or they dad

1125
00:39:58,410 --> 00:40:05,200
you know then after pop-pop

1126
00:40:01,600 --> 00:40:08,500
at popular so it will total minute

1127
00:40:05,200 --> 00:40:09,939
download zoom yes this this is this is

1128
00:40:08,500 --> 00:40:12,490
nothing to at the browser's this is

1129
00:40:09,940 --> 00:40:15,550
completely outside the browser so this

1130
00:40:12,490 --> 00:40:17,379
is that zoom open a web server sort of

1131
00:40:15,550 --> 00:40:18,910
what zoom open a binary which has the

1132
00:40:17,380 --> 00:40:20,950
web server that's interacting with it so

1133
00:40:18,910 --> 00:40:22,390
we hit that web server that this is a

1134
00:40:20,950 --> 00:40:26,109
web server that's running on localhost

1135
00:40:22,390 --> 00:40:27,640
at that port and you know it triggers

1136
00:40:26,110 --> 00:40:30,010
this code functionality which

1137
00:40:27,640 --> 00:40:31,390
automatically downloads it there's

1138
00:40:30,010 --> 00:40:34,360
nothing to do with the browser so if you

1139
00:40:31,390 --> 00:40:35,730
went to if you've got a zoom link so

1140
00:40:34,360 --> 00:40:39,000
like when we're exploiting this

1141
00:40:35,730 --> 00:40:43,800
basically that request that we had up

1142
00:40:39,000 --> 00:40:43,800
the get to it

1143
00:40:44,490 --> 00:40:49,600
this one I'm sorry

1144
00:40:47,050 --> 00:40:51,220
this one right that's what we're hitting

1145
00:40:49,600 --> 00:40:53,620
right but if you get a like a normal

1146
00:40:51,220 --> 00:40:55,810
link like that actually goes to zoom

1147
00:40:53,620 --> 00:40:57,339
like a normal meaning link right it's

1148
00:40:55,810 --> 00:40:58,750
not going to be viral it's not even

1149
00:40:57,340 --> 00:41:00,760
hitting that same thing it's completely

1150
00:40:58,750 --> 00:41:05,230
separate um they're using his signal

1151
00:41:00,760 --> 00:41:06,670
yeah other bugs can't speak to that but

1152
00:41:05,230 --> 00:41:09,010
this is all being fixed

1153
00:41:06,670 --> 00:41:10,480
this whole functionality the whole web

1154
00:41:09,010 --> 00:41:16,990
server everything doesn't exist anymore

1155
00:41:10,480 --> 00:41:19,480
in June yeah yeah no no I can I also had

1156
00:41:16,990 --> 00:41:20,740
a little bit of a sleepless night so

1157
00:41:19,480 --> 00:41:22,840
that was the first question I asked

1158
00:41:20,740 --> 00:41:27,009
Michael when I saw him this morning is

1159
00:41:22,840 --> 00:41:38,110
it all the zooms are put me to rest any

1160
00:41:27,010 --> 00:41:41,200
other questions yes ma'am do you know

1161
00:41:38,110 --> 00:41:43,290
why the zoom opener is not present in

1162
00:41:41,200 --> 00:41:46,600
the windows

1163
00:41:43,290 --> 00:41:48,009
yes so this was something that we

1164
00:41:46,600 --> 00:41:49,299
couldn't really figure out again as I

1165
00:41:48,010 --> 00:41:52,060
said we couldn't really figure out why

1166
00:41:49,300 --> 00:41:53,680
this whole thing was happening and there

1167
00:41:52,060 --> 00:41:55,180
were some there was some commentary once

1168
00:41:53,680 --> 00:41:58,680
this all came out and all the blog post

1169
00:41:55,180 --> 00:42:03,310
came out and whatever my gut feel is

1170
00:41:58,680 --> 00:42:05,919
this was in there to get around certain

1171
00:42:03,310 --> 00:42:09,430
things that were added in Mac OS so when

1172
00:42:05,920 --> 00:42:11,410
you trigger something through like a URL

1173
00:42:09,430 --> 00:42:14,770
handler now it'll actually come up with

1174
00:42:11,410 --> 00:42:15,490
a little alert box to say you know once

1175
00:42:14,770 --> 00:42:17,620
you know this

1176
00:42:15,490 --> 00:42:20,859
wants to open zoom open up do you want

1177
00:42:17,620 --> 00:42:23,290
to allow right and so it's a click so

1178
00:42:20,860 --> 00:42:25,000
I'm thinking that this was a way with

1179
00:42:23,290 --> 00:42:27,070
this whole like web server and all that

1180
00:42:25,000 --> 00:42:29,440
kind of stuff this was a way to get

1181
00:42:27,070 --> 00:42:31,780
around having to have users click allow

1182
00:42:29,440 --> 00:42:35,050
right that's that was the sort of

1183
00:42:31,780 --> 00:42:37,540
prevailing theory and I believe Windows

1184
00:42:35,050 --> 00:42:40,300
I'm gonna refer to our resident Windows

1185
00:42:37,540 --> 00:42:41,650
expert that's asset yeah I believe

1186
00:42:40,300 --> 00:42:44,080
Windows doesn't operate in the same yeah

1187
00:42:41,650 --> 00:42:47,380
I think that's our main theory that I

1188
00:42:44,080 --> 00:42:49,270
think now with the current behavior yes

1189
00:42:47,380 --> 00:42:52,360
they preserved the idea of security over

1190
00:42:49,270 --> 00:42:54,670
font like very easy user design and user

1191
00:42:52,360 --> 00:42:56,200
experience I don't know there's probably

1192
00:42:54,670 --> 00:43:01,000
other reasons but we didn't really

1193
00:42:56,200 --> 00:43:03,669
explore that period of time thank you

1194
00:43:01,000 --> 00:43:17,680
any more questions yes another young

1195
00:43:03,670 --> 00:43:23,230
lady at the back hello

1196
00:43:17,680 --> 00:43:26,080
so you will push their patch from their

1197
00:43:23,230 --> 00:43:30,240
side what if we download the download

1198
00:43:26,080 --> 00:43:35,020
version of zoom so is it we can still

1199
00:43:30,240 --> 00:43:40,479
trigger this exploit on down the

1200
00:43:35,020 --> 00:43:44,500
degraded version there might be some

1201
00:43:40,480 --> 00:43:46,870
scenarios I guess where you can but

1202
00:43:44,500 --> 00:43:49,210
generally speaking as I understand it I

1203
00:43:46,870 --> 00:43:51,100
don't know too much about X protect and

1204
00:43:49,210 --> 00:43:54,070
how that all works but it's basically

1205
00:43:51,100 --> 00:43:55,960
like a V where they add signatures and

1206
00:43:54,070 --> 00:43:57,940
like if something's there it deletes it

1207
00:43:55,960 --> 00:43:59,950
or quarantines it or whatever my

1208
00:43:57,940 --> 00:44:02,260
understanding is they added zoom

1209
00:43:59,950 --> 00:44:04,470
eye-opener in the is specifically the

1210
00:44:02,260 --> 00:44:07,900
one that's left in your home directory

1211
00:44:04,470 --> 00:44:11,319
as you know it added that to that system

1212
00:44:07,900 --> 00:44:13,000
so that if it is ever there like I can

1213
00:44:11,320 --> 00:44:14,470
you know left after you uninstalled an

1214
00:44:13,000 --> 00:44:16,510
old version or something like that it

1215
00:44:14,470 --> 00:44:18,790
actually automatically deletes it and

1216
00:44:16,510 --> 00:44:20,740
quarantines it so I think it's okay but

1217
00:44:18,790 --> 00:44:22,330
don't quote me on it cuz I'm not a

1218
00:44:20,740 --> 00:44:23,919
hundred percent sure how it works but

1219
00:44:22,330 --> 00:44:27,069
that's my understanding of that kind of

1220
00:44:23,920 --> 00:44:29,020
side of the fix but you know as well

1221
00:44:27,070 --> 00:44:31,720
going forward more

1222
00:44:29,020 --> 00:44:34,570
new versions of zoom they don't even use

1223
00:44:31,720 --> 00:44:35,770
this anymore it's it's gone so so even

1224
00:44:34,570 --> 00:44:37,090
if you have zoom installed your

1225
00:44:35,770 --> 00:44:38,980
uninstaller it's not leaving anything

1226
00:44:37,090 --> 00:44:40,300
like that behind so you should

1227
00:44:38,980 --> 00:44:41,440
definitely upgrade but my my

1228
00:44:40,300 --> 00:44:45,250
understanding is even on an older

1229
00:44:41,440 --> 00:44:47,020
version you know a it should be it

1230
00:44:45,250 --> 00:44:48,640
should be alright but I guess you know I

1231
00:44:47,020 --> 00:44:50,140
don't know enough to say that you know

1232
00:44:48,640 --> 00:44:51,549
there might not be scenarios where you

1233
00:44:50,140 --> 00:44:52,990
can downgrade it and do it but it's

1234
00:44:51,550 --> 00:44:54,790
probably at that point actually

1235
00:44:52,990 --> 00:44:59,290
exploiting that is probably like

1236
00:44:54,790 --> 00:45:01,300
unlikely I guess thanks Michael and yes

1237
00:44:59,290 --> 00:45:03,190
one question in the front and then after

1238
00:45:01,300 --> 00:45:05,440
that I'm just gonna hop over to the

1239
00:45:03,190 --> 00:45:11,920
question from salado in the front on the

1240
00:45:05,440 --> 00:45:13,570
red shirt yes about this not existed

1241
00:45:11,920 --> 00:45:17,290
anymore in the new version of zoom right

1242
00:45:13,570 --> 00:45:19,840
yeah what kind of modification they use

1243
00:45:17,290 --> 00:45:22,029
I said they just got as far as I know

1244
00:45:19,840 --> 00:45:23,320
they got rid of the zoom opener like

1245
00:45:22,030 --> 00:45:24,970
that whole functionality though the

1246
00:45:23,320 --> 00:45:26,530
webserver annoying I don't know about

1247
00:45:24,970 --> 00:45:28,149
the whole functionality but at least the

1248
00:45:26,530 --> 00:45:29,950
web server component with the vulnerable

1249
00:45:28,150 --> 00:45:31,300
stuff good - saying is that this zoom

1250
00:45:29,950 --> 00:45:37,600
opener doesn't exist anymore

1251
00:45:31,300 --> 00:45:40,030
basically yeah okay I'm gonna before I

1252
00:45:37,600 --> 00:45:41,890
get back to the audience again I'm just

1253
00:45:40,030 --> 00:45:43,720
gonna read off the top voted question

1254
00:45:41,890 --> 00:45:46,089
there are two top waters so I'll read

1255
00:45:43,720 --> 00:45:48,040
one first and then we can in your

1256
00:45:46,090 --> 00:45:50,200
opinion are there any prerequisite or

1257
00:45:48,040 --> 00:45:52,420
good to have certifications or courses

1258
00:45:50,200 --> 00:45:54,430
that can help me in a career of finding

1259
00:45:52,420 --> 00:45:57,970
remote control of remote code execution

1260
00:45:54,430 --> 00:45:59,290
or see he's yes so this is it's an

1261
00:45:57,970 --> 00:46:00,970
interesting question

1262
00:45:59,290 --> 00:46:03,160
look I don't think there's any

1263
00:46:00,970 --> 00:46:06,640
prerequisites other than like your

1264
00:46:03,160 --> 00:46:08,500
curiosity and like a will to do it right

1265
00:46:06,640 --> 00:46:09,730
because it can be you know like one of

1266
00:46:08,500 --> 00:46:11,680
the things we wanted to highlight again

1267
00:46:09,730 --> 00:46:13,090
with this talk was it wasn't just a walk

1268
00:46:11,680 --> 00:46:14,710
in the park right and we did this really

1269
00:46:13,090 --> 00:46:16,900
quickly and whatever but it wasn't

1270
00:46:14,710 --> 00:46:18,670
something that just happened right and

1271
00:46:16,900 --> 00:46:20,410
particularly when you're diving into

1272
00:46:18,670 --> 00:46:22,000
binary exploitation like this wasn't

1273
00:46:20,410 --> 00:46:24,490
even that low-level right and that

1274
00:46:22,000 --> 00:46:26,770
difficult when you're really diving into

1275
00:46:24,490 --> 00:46:28,479
it you need to just have that kind of

1276
00:46:26,770 --> 00:46:29,740
will and determination to keep going and

1277
00:46:28,480 --> 00:46:32,530
I think that's just general for hacking

1278
00:46:29,740 --> 00:46:33,609
like hacking in general so I don't know

1279
00:46:32,530 --> 00:46:35,290
I think that's probably the only

1280
00:46:33,609 --> 00:46:37,299
prerequisite is like the right mindset

1281
00:46:35,290 --> 00:46:39,369
in terms of like technical skills

1282
00:46:37,300 --> 00:46:41,109
qualifications you know as long as

1283
00:46:39,369 --> 00:46:42,320
you've got that that will you'll learn

1284
00:46:41,109 --> 00:46:44,200
it right so

1285
00:46:42,320 --> 00:46:47,180
I wouldn't say that there's any kind of

1286
00:46:44,200 --> 00:46:50,509
certifications or courses you know in

1287
00:46:47,180 --> 00:46:51,980
terms of a career right I'll definitely

1288
00:46:50,510 --> 00:46:53,630
say like put yourself out there right

1289
00:46:51,980 --> 00:46:55,460
when you're learning this stuff you know

1290
00:46:53,630 --> 00:46:57,680
write a blog or whatever and a lot of

1291
00:46:55,460 --> 00:46:59,390
people get caught up in the idea of it

1292
00:46:57,680 --> 00:47:01,520
has to be novel has to be unique it has

1293
00:46:59,390 --> 00:47:03,339
to be great research or whatever forget

1294
00:47:01,520 --> 00:47:05,570
about that right just write you know

1295
00:47:03,340 --> 00:47:07,520
document your learning journey share it

1296
00:47:05,570 --> 00:47:10,330
with others you know go to meetups here

1297
00:47:07,520 --> 00:47:13,070
and you know present it to others and

1298
00:47:10,330 --> 00:47:14,540
that shows potential employers that you

1299
00:47:13,070 --> 00:47:15,590
can actually do this stuff and that you

1300
00:47:14,540 --> 00:47:17,450
are learning and you've got the right

1301
00:47:15,590 --> 00:47:18,950
mindset and skills and I think that

1302
00:47:17,450 --> 00:47:20,660
helps in a lot a lot of ways more

1303
00:47:18,950 --> 00:47:22,399
certain certifications or courses I

1304
00:47:20,660 --> 00:47:24,230
think the one thing that helped me most

1305
00:47:22,400 --> 00:47:25,910
when I was starting out is instead of

1306
00:47:24,230 --> 00:47:28,520
looking for certifications I just did a

1307
00:47:25,910 --> 00:47:30,620
lot of CTFs because I know how can the

1308
00:47:28,520 --> 00:47:33,230
Box runs their own CTF that they have

1309
00:47:30,620 --> 00:47:34,430
like finalists for that come here and I

1310
00:47:33,230 --> 00:47:35,540
think those are really good entry point

1311
00:47:34,430 --> 00:47:37,879
because they give you a whole wide range

1312
00:47:35,540 --> 00:47:39,620
of challenges like from the absolute

1313
00:47:37,880 --> 00:47:41,150
beginner to things that are just

1314
00:47:39,620 --> 00:47:43,609
malicious it intentionally trolling the

1315
00:47:41,150 --> 00:47:45,320
participants so I strongly would

1316
00:47:43,610 --> 00:47:46,550
recommend participating CTFs there's

1317
00:47:45,320 --> 00:47:48,290
like usually one every week

1318
00:47:46,550 --> 00:47:49,610
internationally and like you have your

1319
00:47:48,290 --> 00:47:51,620
own leisure time or you can get some

1320
00:47:49,610 --> 00:47:55,310
friends together with some pizzas to do

1321
00:47:51,620 --> 00:47:56,990
it as well so I'm cool great thanks and

1322
00:47:55,310 --> 00:47:58,549
I know I said I'd go back to the floor

1323
00:47:56,990 --> 00:48:01,459
but I really like this question now

1324
00:47:58,550 --> 00:48:05,440
that's come up on the top one could this

1325
00:48:01,460 --> 00:48:10,010
be a backdoor foot zoom on purpose look

1326
00:48:05,440 --> 00:48:12,200
I'm not an overly paranoid person I'm

1327
00:48:10,010 --> 00:48:15,560
gonna say no right like you know one of

1328
00:48:12,200 --> 00:48:18,500
the things that you know we learn now

1329
00:48:15,560 --> 00:48:19,970
like so we we have a platform that we

1330
00:48:18,500 --> 00:48:22,640
develop so we've gone from being like

1331
00:48:19,970 --> 00:48:25,100
security guys to being developers and if

1332
00:48:22,640 --> 00:48:27,290
you're doing anything on on scale like

1333
00:48:25,100 --> 00:48:29,360
zoom has like 45 million users or

1334
00:48:27,290 --> 00:48:32,750
something ridiculous like that it's hard

1335
00:48:29,360 --> 00:48:33,980
right and you know people make mistakes

1336
00:48:32,750 --> 00:48:35,780
and that's where all of this stuff comes

1337
00:48:33,980 --> 00:48:37,850
from it's just like natural right I

1338
00:48:35,780 --> 00:48:39,530
joined I didn't get the sense that any

1339
00:48:37,850 --> 00:48:43,009
of this was malicious because it was

1340
00:48:39,530 --> 00:48:44,120
kind of so obvious um but that's my

1341
00:48:43,010 --> 00:48:45,320
opinion I don't know if you have a

1342
00:48:44,120 --> 00:48:47,509
different opinion I think the other

1343
00:48:45,320 --> 00:48:49,610
thing to consider is just like app

1344
00:48:47,510 --> 00:48:51,350
designers not so much developers they're

1345
00:48:49,610 --> 00:48:53,240
so focused on having like a seamless

1346
00:48:51,350 --> 00:48:55,130
user experience yeah and like the idea

1347
00:48:53,240 --> 00:48:55,549
of having I want to join a meeting so

1348
00:48:55,130 --> 00:48:56,810
you want me

1349
00:48:55,550 --> 00:48:59,480
click a link and then click another

1350
00:48:56,810 --> 00:49:01,220
button and some other buttons is like in

1351
00:48:59,480 --> 00:49:02,870
designer land that's like so many

1352
00:49:01,220 --> 00:49:04,669
barriers and funnels that it's too

1353
00:49:02,870 --> 00:49:06,350
difficult to convert someone so they

1354
00:49:04,670 --> 00:49:08,300
really wanted to make it as easy as

1355
00:49:06,350 --> 00:49:09,830
possible for someone who might have had

1356
00:49:08,300 --> 00:49:11,720
zoom before to just open up another

1357
00:49:09,830 --> 00:49:13,880
meeting yeah and like I can see how this

1358
00:49:11,720 --> 00:49:15,410
idea comes through that obviously has a

1359
00:49:13,880 --> 00:49:17,540
few other security vulnerabilities of

1360
00:49:15,410 --> 00:49:19,819
the way yeah I definitely felt that it

1361
00:49:17,540 --> 00:49:21,290
was more like driven by functional and

1362
00:49:19,820 --> 00:49:24,050
design requirements more so than

1363
00:49:21,290 --> 00:49:26,300
anything malicious yeah okay thanks Mike

1364
00:49:24,050 --> 00:49:28,340
and Sean any more questions from the

1365
00:49:26,300 --> 00:49:30,020
floor it's a pity this question the

1366
00:49:28,340 --> 00:49:32,000
person who posted that question earlier

1367
00:49:30,020 --> 00:49:34,580
didn't give his name or her name or does

1368
00:49:32,000 --> 00:49:35,900
you would want a nice t-shirt ok but any

1369
00:49:34,580 --> 00:49:54,740
more questions from the floor yes

1370
00:49:35,900 --> 00:49:57,560
gentleman at the back over there so no

1371
00:49:54,740 --> 00:50:00,649
user interaction is quite important

1372
00:49:57,560 --> 00:50:03,230
measures in terms of measuring the

1373
00:50:00,650 --> 00:50:06,800
security of the box so I in your case

1374
00:50:03,230 --> 00:50:09,920
but the so openers are I think it

1375
00:50:06,800 --> 00:50:13,010
doesn't require any user interactions

1376
00:50:09,920 --> 00:50:14,960
but in general for those UI hand dollars

1377
00:50:13,010 --> 00:50:18,290
when you open it in the browser's

1378
00:50:14,960 --> 00:50:21,080
usually you pop up the web browser

1379
00:50:18,290 --> 00:50:24,770
yes so we will try to use some ways to

1380
00:50:21,080 --> 00:50:28,580
bypass this boss to increase the impact

1381
00:50:24,770 --> 00:50:30,350
yeah so so yeah well the where we ended

1382
00:50:28,580 --> 00:50:32,810
up with your interaction in the end as

1383
00:50:30,350 --> 00:50:34,520
potential but when we started out we

1384
00:50:32,810 --> 00:50:36,020
were actually using the zoom eye-opener

1385
00:50:34,520 --> 00:50:39,320
handle rather than hitting localhost

1386
00:50:36,020 --> 00:50:40,820
directly and that triggered you know

1387
00:50:39,320 --> 00:50:43,280
sort of what I was saying to the lady

1388
00:50:40,820 --> 00:50:45,230
earlier that you know do you open it

1389
00:50:43,280 --> 00:50:48,200
once you don't open this website which

1390
00:50:45,230 --> 00:50:49,970
opens oome opener and you know yes it's

1391
00:50:48,200 --> 00:50:51,770
an extra click but when you think of the

1392
00:50:49,970 --> 00:50:53,299
scenario I think it's a very likely

1393
00:50:51,770 --> 00:50:55,610
exploitation scenario where it's like

1394
00:50:53,300 --> 00:50:57,020
hey join my zoom meeting and then this

1395
00:50:55,610 --> 00:50:58,550
wants to download something called zoom

1396
00:50:57,020 --> 00:51:01,280
open oh it's probably likely to get

1397
00:50:58,550 --> 00:51:03,110
clicked on um I think yes it does go to

1398
00:51:01,280 --> 00:51:05,390
the severity I think it just really

1399
00:51:03,110 --> 00:51:07,400
depends on what the user interaction is

1400
00:51:05,390 --> 00:51:08,450
and how you can craft the scenario

1401
00:51:07,400 --> 00:51:10,100
around that

1402
00:51:08,450 --> 00:51:11,720
and you know the likelihood that people

1403
00:51:10,100 --> 00:51:12,170
Aquila Khan it is probably generally

1404
00:51:11,720 --> 00:51:14,480
pretty high

1405
00:51:12,170 --> 00:51:16,190
look the real estate expectation is if

1406
00:51:14,480 --> 00:51:17,990
you get a meeting invite and you go to a

1407
00:51:16,190 --> 00:51:19,490
site that says do you want to open your

1408
00:51:17,990 --> 00:51:21,500
zoom meeting like your initial

1409
00:51:19,490 --> 00:51:23,149
expectation is yes I want to get it to

1410
00:51:21,500 --> 00:51:24,680
this meeting so even if there are

1411
00:51:23,150 --> 00:51:26,180
pop-ups regardless of the user

1412
00:51:24,680 --> 00:51:28,520
experience they're gonna click through

1413
00:51:26,180 --> 00:51:30,350
anyway so even if we have to go through

1414
00:51:28,520 --> 00:51:32,450
the zoom open all I think the likelihood

1415
00:51:30,350 --> 00:51:33,890
of being people actually use it like

1416
00:51:32,450 --> 00:51:36,859
getting hit by the exploits still pretty

1417
00:51:33,890 --> 00:51:39,799
high okay thank you

1418
00:51:36,860 --> 00:51:43,760
any more questions before I go to slide

1419
00:51:39,800 --> 00:51:45,440
oh again no okay the next one is how

1420
00:51:43,760 --> 00:51:47,750
much time did you spend in total and

1421
00:51:45,440 --> 00:51:49,550
researching and realizing this yeah so

1422
00:51:47,750 --> 00:51:51,080
it's like two maybe two and a half days

1423
00:51:49,550 --> 00:51:53,810
so if you count the the time on the

1424
00:51:51,080 --> 00:51:56,360
flight that Perot really brings it up to

1425
00:51:53,810 --> 00:51:58,730
two and a half days so it was just the

1426
00:51:56,360 --> 00:52:01,340
so the event was on the Friday and we're

1427
00:51:58,730 --> 00:52:03,110
flying up on the Wednesday and then we

1428
00:52:01,340 --> 00:52:04,400
spent you know Thursday not necessarily

1429
00:52:03,110 --> 00:52:06,440
all day Thursday because we got up

1430
00:52:04,400 --> 00:52:09,560
pretty late sweeping out the night

1431
00:52:06,440 --> 00:52:12,590
before and and then all day at the event

1432
00:52:09,560 --> 00:52:15,040
Friday but this is like across for

1433
00:52:12,590 --> 00:52:18,890
people yes so it is us working together

1434
00:52:15,040 --> 00:52:23,290
you know wasn't a solo effort yeah okay

1435
00:52:18,890 --> 00:52:25,430
thanks any more questions from the floor

1436
00:52:23,290 --> 00:52:26,750
it's not I'm just reading I'm training

1437
00:52:25,430 --> 00:52:28,279
the next one here do you always spend

1438
00:52:26,750 --> 00:52:29,780
your free hours in the airports a hack

1439
00:52:28,280 --> 00:52:33,380
and the answer is yes

1440
00:52:29,780 --> 00:52:35,960
especially shops like will will land in

1441
00:52:33,380 --> 00:52:37,580
in a country I like the very first thing

1442
00:52:35,960 --> 00:52:40,670
when we get into the taxis like openings

1443
00:52:37,580 --> 00:52:44,180
laptop and start hacking yeah so yeah

1444
00:52:40,670 --> 00:52:45,890
that's very common but the next one what

1445
00:52:44,180 --> 00:52:48,919
advice would you give people entering

1446
00:52:45,890 --> 00:52:50,629
this field yeah just like very you know

1447
00:52:48,920 --> 00:52:54,500
similar advice is what I was saying

1448
00:52:50,630 --> 00:52:55,880
before you know you know try it and get

1449
00:52:54,500 --> 00:52:57,410
out there and do it like one of the

1450
00:52:55,880 --> 00:52:59,060
great things now is like particularly

1451
00:52:57,410 --> 00:53:01,250
with bounties so you can hack on real

1452
00:52:59,060 --> 00:53:02,570
world targets like this and get away

1453
00:53:01,250 --> 00:53:04,040
with it it's fine and you could

1454
00:53:02,570 --> 00:53:06,950
potentially even get paid for it right

1455
00:53:04,040 --> 00:53:08,720
so you know that's a really great thing

1456
00:53:06,950 --> 00:53:10,879
that exists now there's a lot more

1457
00:53:08,720 --> 00:53:12,319
learning resources as well but yeah I

1458
00:53:10,880 --> 00:53:14,450
think really just having that mindset

1459
00:53:12,320 --> 00:53:16,010
and the will to do it it's not an it's

1460
00:53:14,450 --> 00:53:17,210
not necessarily hard but it's not

1461
00:53:16,010 --> 00:53:18,830
necessarily something where it's just

1462
00:53:17,210 --> 00:53:21,080
like you do a course and you're good

1463
00:53:18,830 --> 00:53:22,779
right or you you go do some training

1464
00:53:21,080 --> 00:53:24,699
somewhere or you get a certification

1465
00:53:22,779 --> 00:53:26,049
that's it like I really feel like if

1466
00:53:24,699 --> 00:53:27,549
you've got the mindset that's a real

1467
00:53:26,049 --> 00:53:29,199
differentiator for people and that sort

1468
00:53:27,549 --> 00:53:29,769
of will it's not necessarily you need to

1469
00:53:29,199 --> 00:53:31,719
be like this

1470
00:53:29,769 --> 00:53:33,308
gifted hacker innately this is kind of

1471
00:53:31,719 --> 00:53:34,869
like the will to keep trying things and

1472
00:53:33,309 --> 00:53:36,579
keep when you hit a roadblock try

1473
00:53:34,869 --> 00:53:38,319
something different and talk to other

1474
00:53:36,579 --> 00:53:40,989
people about it and keep keep moving

1475
00:53:38,319 --> 00:53:42,659
forward thank you

1476
00:53:40,989 --> 00:53:45,189
we still have about five more minutes

1477
00:53:42,659 --> 00:53:49,839
continue answering ourselves anyone from

1478
00:53:45,189 --> 00:53:52,209
that you know change over okay so maybe

1479
00:53:49,839 --> 00:53:56,439
one last question okay one last question

1480
00:53:52,209 --> 00:53:58,029
from the audience no all right then one

1481
00:53:56,439 --> 00:54:02,169
last question from something slide oh

1482
00:53:58,029 --> 00:54:05,349
and then you have to yeah I can do too I

1483
00:54:02,169 --> 00:54:07,538
can do these really quickly so the first

1484
00:54:05,349 --> 00:54:09,729
one do you feel safe code analysis tools

1485
00:54:07,539 --> 00:54:13,119
or would have helped probably not for

1486
00:54:09,729 --> 00:54:14,979
this one just because of how they work -

1487
00:54:13,119 --> 00:54:18,969
how long does this bug existed in Zune

1488
00:54:14,979 --> 00:54:20,439
before I was patched probably well at

1489
00:54:18,969 --> 00:54:21,789
least from when we found it when it

1490
00:54:20,439 --> 00:54:24,279
actually got patched it was a matter of

1491
00:54:21,789 --> 00:54:27,519
like four months five months there

1492
00:54:24,279 --> 00:54:29,679
abouts and how did Sumer all add the

1493
00:54:27,519 --> 00:54:31,689
patches generally in a pretty poor way

1494
00:54:29,679 --> 00:54:33,880
they responded but then they then they

1495
00:54:31,689 --> 00:54:35,379
came around and they they handle it okay

1496
00:54:33,880 --> 00:54:36,729
other beers and Singapore the most

1497
00:54:35,380 --> 00:54:38,409
expensive during your travels in the

1498
00:54:36,729 --> 00:54:43,509
world I've traveled a lot and the answer

1499
00:54:38,409 --> 00:54:45,699
is yes so okay so we want to give the

1500
00:54:43,509 --> 00:54:47,199
prizes out now we had the most the one

1501
00:54:45,699 --> 00:54:48,489
with the highest votes but unfortunately

1502
00:54:47,199 --> 00:54:50,709
we don't know who is the one who pulls

1503
00:54:48,489 --> 00:54:52,659
that question so sorry no no gift for

1504
00:54:50,709 --> 00:54:55,239
you but out of the other questions that

1505
00:54:52,659 --> 00:54:58,689
you got who do you think should get your

1506
00:54:55,239 --> 00:55:00,339
coveted purple t-shirt I'm gonna give it

1507
00:54:58,689 --> 00:55:02,859
to this lady down the front here so

1508
00:55:00,339 --> 00:55:05,099
second rang yeah well dad that's good

1509
00:55:02,859 --> 00:55:05,098
thank you

