1
00:00:08,610 --> 00:00:13,230
good morning or afternoon or even in the

2
00:00:11,400 --> 00:00:15,680
penguin actually watching this I think

3
00:00:13,230 --> 00:00:19,560
it's been actually streaming online

4
00:00:15,680 --> 00:00:21,680
first of all I would like to I would

5
00:00:19,560 --> 00:00:25,320
like to introduce today this the new

6
00:00:21,680 --> 00:00:27,808
topic in a way the way though I actually

7
00:00:25,320 --> 00:00:30,300
pronounce is called defects in a way he

8
00:00:27,809 --> 00:00:33,750
said just DNS filing filtration

9
00:00:30,300 --> 00:00:38,879
techniques so let me first of all

10
00:00:33,750 --> 00:00:41,400
clarify how the QA works now the you're

11
00:00:38,879 --> 00:00:44,190
aware of the slider up to both the best

12
00:00:41,400 --> 00:00:44,489
question put the questions you get free

13
00:00:44,190 --> 00:00:48,780
stuff

14
00:00:44,489 --> 00:00:50,640
let's pick plus actually please just put

15
00:00:48,780 --> 00:00:52,380
the question in you don't need to wait

16
00:00:50,640 --> 00:00:54,149
for the end of the talk so if you have a

17
00:00:52,380 --> 00:00:55,829
doubt just put the question then we can

18
00:00:54,149 --> 00:00:58,140
actually figure out the answers all no

19
00:00:55,829 --> 00:01:02,640
but let's try to make it more

20
00:00:58,140 --> 00:01:06,030
interactive and I do have some stuff as

21
00:01:02,640 --> 00:01:08,520
well to give I will not say what yet but

22
00:01:06,030 --> 00:01:09,630
if you get a good difficult question

23
00:01:08,520 --> 00:01:12,658
yeah

24
00:01:09,630 --> 00:01:18,869
prolly get something then right we have

25
00:01:12,659 --> 00:01:21,420
let me introduce myself I'm Emilio or

26
00:01:18,869 --> 00:01:25,350
Amedeo depends how you pronounce it in

27
00:01:21,420 --> 00:01:29,579
the language I will take it as I've been

28
00:01:25,350 --> 00:01:33,630
presenting tools and in various security

29
00:01:29,579 --> 00:01:39,208
conference around Asia and US Europe few

30
00:01:33,630 --> 00:01:42,810
places actually so just to make sure I'm

31
00:01:39,209 --> 00:01:45,079
not a native programmer so the code that

32
00:01:42,810 --> 00:01:48,619
you may see is probably the it just run

33
00:01:45,079 --> 00:01:51,568
so if it run is okay as long as you run

34
00:01:48,619 --> 00:01:53,939
that's what I've been to and then if for

35
00:01:51,569 --> 00:01:55,020
some reason the English doesn't sounds

36
00:01:53,939 --> 00:01:57,958
right

37
00:01:55,020 --> 00:02:01,169
just correct me when I'm wrong please go

38
00:01:57,959 --> 00:02:05,939
ahead right what is DNS fine

39
00:02:01,169 --> 00:02:09,508
exfiltration aka defects well we try to

40
00:02:05,939 --> 00:02:11,849
do here is to use DNS protocol very

41
00:02:09,508 --> 00:02:14,429
standard and common protocol to actually

42
00:02:11,849 --> 00:02:17,609
as a cover channel so the whole idea and

43
00:02:14,430 --> 00:02:21,810
pointers is to be able to transfer files

44
00:02:17,610 --> 00:02:22,460
without using a FTP secure copy or any

45
00:02:21,810 --> 00:02:24,140
transfer

46
00:02:22,460 --> 00:02:26,660
listen sambar whatever we want to use

47
00:02:24,140 --> 00:02:30,140
DNS does it transfer five mechanize so

48
00:02:26,660 --> 00:02:34,520
why because he simply commonly allow it

49
00:02:30,140 --> 00:02:36,920
and also is actually very useful for

50
00:02:34,520 --> 00:02:39,230
post exploit expectation so basically

51
00:02:36,920 --> 00:02:43,549
once you get access into the network you

52
00:02:39,230 --> 00:02:45,380
want to take files out so which approach

53
00:02:43,550 --> 00:02:48,380
do we take here it's very simple

54
00:02:45,380 --> 00:02:51,310
actually it's just highly inclined

55
00:02:48,380 --> 00:02:55,160
Society so what we do is we try to put

56
00:02:51,310 --> 00:02:57,800
the file into just DNS I said this that

57
00:02:55,160 --> 00:02:59,690
sounds very simple and I will walk you

58
00:02:57,800 --> 00:03:03,410
through which is actually not that

59
00:02:59,690 --> 00:03:06,140
simple but the whole idea of this is to

60
00:03:03,410 --> 00:03:08,990
avoid getting detected so the mindset

61
00:03:06,140 --> 00:03:10,359
was okay I need two extra files flowers

62
00:03:08,990 --> 00:03:14,000
are getting really smart these days

63
00:03:10,360 --> 00:03:16,220
potentially and we have IPS and on this

64
00:03:14,000 --> 00:03:20,230
kind of products you normally go out and

65
00:03:16,220 --> 00:03:23,990
bite to detect this stuff so on this

66
00:03:20,230 --> 00:03:26,390
let's look around how we can do about it

67
00:03:23,990 --> 00:03:28,250
so you know I'm not going to go into

68
00:03:26,390 --> 00:03:30,380
detail but I'm pretty sure everyone's

69
00:03:28,250 --> 00:03:31,160
aware how DNS work you make a query you

70
00:03:30,380 --> 00:03:33,130
get an answer

71
00:03:31,160 --> 00:03:35,600
I don't think misty simple on des

72
00:03:33,130 --> 00:03:37,660
theoretically right however within the

73
00:03:35,600 --> 00:03:40,870
protocol is a lot of stuff inside right

74
00:03:37,660 --> 00:03:43,760
this is an example have just basically

75
00:03:40,870 --> 00:03:47,810
DNS tunneling right which I will cover

76
00:03:43,760 --> 00:03:51,890
later on so what we have in the market

77
00:03:47,810 --> 00:03:54,740
right so today when you go and try to

78
00:03:51,890 --> 00:03:56,929
exfiltrate files so data through

79
00:03:54,740 --> 00:04:01,010
networks there's many tools available

80
00:03:56,930 --> 00:04:03,710
and actually if you see they said I will

81
00:04:01,010 --> 00:04:07,429
categorize into different size one is

82
00:04:03,710 --> 00:04:09,590
the exfiltration like data filtration

83
00:04:07,430 --> 00:04:12,800
and the other one is tunneling which is

84
00:04:09,590 --> 00:04:14,780
normally to bypass fouls so all of these

85
00:04:12,800 --> 00:04:17,780
are you know open source tools that you

86
00:04:14,780 --> 00:04:19,730
can go and take a look at it what I did

87
00:04:17,779 --> 00:04:22,340
not this is most of these tools are

88
00:04:19,730 --> 00:04:25,550
well-known tools and been catched by

89
00:04:22,340 --> 00:04:27,710
fouls that smart file was right like you

90
00:04:25,550 --> 00:04:31,880
know application detection inspection

91
00:04:27,710 --> 00:04:34,130
they actually it been well known you so

92
00:04:31,880 --> 00:04:34,860
this is called funny because it's just -

93
00:04:34,130 --> 00:04:37,409
different

94
00:04:34,860 --> 00:04:39,870
different tools though so what I come up

95
00:04:37,409 --> 00:04:40,949
with like okay these are good tools but

96
00:04:39,870 --> 00:04:42,840
I need to come up with something

97
00:04:40,949 --> 00:04:45,689
slightly different because I have

98
00:04:42,840 --> 00:04:49,049
different requirements so what I start

99
00:04:45,689 --> 00:04:52,110
to do was okay so let's write down what

100
00:04:49,050 --> 00:04:56,189
I want right I want something like this

101
00:04:52,110 --> 00:04:58,080
I want to have 256 CTR encryption I want

102
00:04:56,189 --> 00:04:59,460
to have capabilities of retransmission

103
00:04:58,080 --> 00:05:02,430
like an eel

104
00:04:59,460 --> 00:05:04,378
good protocol in a way I want to have

105
00:05:02,430 --> 00:05:07,169
error free yeah definitely I want to

106
00:05:04,379 --> 00:05:11,550
EXCI error check-ins threading you know

107
00:05:07,169 --> 00:05:13,830
speed multiple domains this is very

108
00:05:11,550 --> 00:05:16,529
important why I want multiple domains

109
00:05:13,830 --> 00:05:18,688
most of the tool works in users tell the

110
00:05:16,529 --> 00:05:20,490
tool which domain DNS are you using and

111
00:05:18,689 --> 00:05:22,680
the tool will actually use that one

112
00:05:20,490 --> 00:05:26,250
that's very easy to catch because it was

113
00:05:22,680 --> 00:05:28,469
a hell of a traffic to one domain so to

114
00:05:26,250 --> 00:05:32,189
avoid that I want to be able to multiply

115
00:05:28,469 --> 00:05:34,110
that for X amount of domains so that's

116
00:05:32,189 --> 00:05:38,400
the reason I want to have that to avoid

117
00:05:34,110 --> 00:05:40,319
any indicators of the real normally if

118
00:05:38,400 --> 00:05:42,989
you get the DNS and the DNS is brand-new

119
00:05:40,319 --> 00:05:44,190
register it probably are in the list of

120
00:05:42,990 --> 00:05:47,550
suspicious already

121
00:05:44,190 --> 00:05:51,150
so if insane or DNS registration domain

122
00:05:47,550 --> 00:05:53,699
he may be okay also I want to be

123
00:05:51,150 --> 00:05:57,330
stealthy so I don't want to be fine bhai

124
00:05:53,699 --> 00:06:00,240
IPS this was my fouls and last thing I

125
00:05:57,330 --> 00:06:03,930
want to do is I want to go atomic atomic

126
00:06:00,240 --> 00:06:06,930
means one way so most of the followers

127
00:06:03,930 --> 00:06:08,550
and IPSS work on his behavior stateful

128
00:06:06,930 --> 00:06:10,650
connections so as soon as you start to

129
00:06:08,550 --> 00:06:12,900
see pattern of traffic back amphora is

130
00:06:10,650 --> 00:06:16,318
going to start to classify things well

131
00:06:12,900 --> 00:06:18,810
atomic atomic packet means packet go out

132
00:06:16,319 --> 00:06:21,750
nothing can be so the whole concept of

133
00:06:18,810 --> 00:06:24,839
that is so IP fowl you will see stateful

134
00:06:21,750 --> 00:06:28,020
sessions time out h out in the logs

135
00:06:24,839 --> 00:06:29,490
depend if all in a high PSE system they

136
00:06:28,020 --> 00:06:32,099
don't see anything back so is they can

137
00:06:29,490 --> 00:06:35,159
really correlate the information they

138
00:06:32,099 --> 00:06:38,159
say catch here I want to be one way

139
00:06:35,159 --> 00:06:41,729
packets but I do want reg transmission

140
00:06:38,159 --> 00:06:44,060
so not contradict itself so are we going

141
00:06:41,729 --> 00:06:46,440
to detail how do I wore around the

142
00:06:44,060 --> 00:06:48,370
having a bit of both basically it's

143
00:06:46,440 --> 00:06:52,000
retransmission are one-way packets

144
00:06:48,370 --> 00:06:57,400
so something this is what I will like to

145
00:06:52,000 --> 00:06:59,110
have them yeah all right how do we avoid

146
00:06:57,400 --> 00:07:02,049
detection okay

147
00:06:59,110 --> 00:07:04,479
if you look for all current tools and

148
00:07:02,050 --> 00:07:07,470
around the market and what you see is

149
00:07:04,479 --> 00:07:10,780
they have something things in common so

150
00:07:07,470 --> 00:07:13,720
they use TTL very short details to be

151
00:07:10,780 --> 00:07:16,059
avoiding the cash in on DNS they use txt

152
00:07:13,720 --> 00:07:18,610
records because they can fit a lot chunk

153
00:07:16,060 --> 00:07:21,370
of data on it for tunneling and for edge

154
00:07:18,610 --> 00:07:26,760
filtration they have a very long dns

155
00:07:21,370 --> 00:07:30,100
suspicious names I see not 200 but the

156
00:07:26,760 --> 00:07:33,190
80s pron normally and they have a high

157
00:07:30,100 --> 00:07:35,020
volume of the client hammering the

158
00:07:33,190 --> 00:07:36,700
server basically right because that's

159
00:07:35,020 --> 00:07:39,219
very suspicion when you see one client

160
00:07:36,700 --> 00:07:43,000
doing connected 20 max of DNS throughput

161
00:07:39,220 --> 00:07:44,620
in 5 minutes and the other thing is one

162
00:07:43,000 --> 00:07:46,090
server destination one domain name

163
00:07:44,620 --> 00:07:49,780
they're going to evil.com

164
00:07:46,090 --> 00:07:52,388
ok that looks suspicious as well so this

165
00:07:49,780 --> 00:07:55,000
is what I don't want this is what I try

166
00:07:52,389 --> 00:07:57,639
to avoid so I'm going to go that way I'm

167
00:07:55,000 --> 00:08:00,280
gonna go and do first of all I want to

168
00:07:57,639 --> 00:08:02,800
split the control and data domain like

169
00:08:00,280 --> 00:08:04,659
any proper protocol we like switching

170
00:08:02,800 --> 00:08:06,160
routing you split the things one of the

171
00:08:04,660 --> 00:08:08,680
things for control one thing's for data

172
00:08:06,160 --> 00:08:11,650
flows so I want to split the flow into

173
00:08:08,680 --> 00:08:13,810
different different control data domains

174
00:08:11,650 --> 00:08:16,989
different names different one or more

175
00:08:13,810 --> 00:08:20,380
multiples I want to use NS query type

176
00:08:16,990 --> 00:08:22,150
not txt or a records why because any

177
00:08:20,380 --> 00:08:24,310
square type is interesting query type

178
00:08:22,150 --> 00:08:27,520
first of all is not in common use or

179
00:08:24,310 --> 00:08:31,090
abuse secondly is recursive so you will

180
00:08:27,520 --> 00:08:35,468
go further and further so I do not want

181
00:08:31,090 --> 00:08:37,208
any reply back from data domains so when

182
00:08:35,469 --> 00:08:42,550
I push data I don't want anything to

183
00:08:37,208 --> 00:08:44,319
come back kind of so also on multiple

184
00:08:42,549 --> 00:08:48,130
domains I want to be able to scale this

185
00:08:44,320 --> 00:08:50,320
and 250 hundred turbines $60 do you

186
00:08:48,130 --> 00:08:53,230
choose the number for data or control

187
00:08:50,320 --> 00:08:56,620
and I also want to limit the amount of a

188
00:08:53,230 --> 00:08:59,230
the fqdn the name query to 20 30 chars

189
00:08:56,620 --> 00:09:00,400
you can choose varies that will make an

190
00:08:59,230 --> 00:09:04,360
impact on the speed

191
00:09:00,400 --> 00:09:06,819
right how fast that transfer will go all

192
00:09:04,360 --> 00:09:09,430
right so I come up with an algorithm yes

193
00:09:06,820 --> 00:09:11,470
I want to do all that but I need to put

194
00:09:09,430 --> 00:09:13,750
a logic on it so what I'm going to do is

195
00:09:11,470 --> 00:09:16,540
okay I got a file I want to actually

196
00:09:13,750 --> 00:09:17,770
Trey etc' password no or any of the

197
00:09:16,540 --> 00:09:20,310
database or whatever you want

198
00:09:17,770 --> 00:09:23,079
so what file I want to do a CL seat32

199
00:09:20,310 --> 00:09:25,479
that is for error checking it's no

200
00:09:23,080 --> 00:09:27,940
encryption no security is just to make

201
00:09:25,480 --> 00:09:30,880
sure the other guy got it you just check

202
00:09:27,940 --> 00:09:33,790
some in a way so I'm using CLC 3 2 and

203
00:09:30,880 --> 00:09:36,189
also because I want to scale this so I'm

204
00:09:33,790 --> 00:09:39,430
using a file id generation that allow me

205
00:09:36,190 --> 00:09:42,070
to thready and actually process multiple

206
00:09:39,430 --> 00:09:45,939
files at the same time so I'm going to

207
00:09:42,070 --> 00:09:50,200
compress it because this is good idea so

208
00:09:45,940 --> 00:09:53,530
then I'm going to generate a 256 CTR key

209
00:09:50,200 --> 00:09:54,760
so basically I will be based on this you

210
00:09:53,530 --> 00:09:59,439
put the client on the server weigh the

211
00:09:54,760 --> 00:10:01,870
same key and encrypted right CTR just

212
00:09:59,440 --> 00:10:04,990
for the sake of it and I'm going to

213
00:10:01,870 --> 00:10:07,900
apply basically two with custom padding

214
00:10:04,990 --> 00:10:10,270
this is tricky because people will use

215
00:10:07,900 --> 00:10:12,699
it by 64 right for anything that go

216
00:10:10,270 --> 00:10:13,840
through the internet well it doesn't

217
00:10:12,700 --> 00:10:16,960
really work very well

218
00:10:13,840 --> 00:10:20,560
basic stuff all in DNS why because basic

219
00:10:16,960 --> 00:10:21,880
C 4 is lower case upper case and I

220
00:10:20,560 --> 00:10:24,849
stopped rolling with the NS because

221
00:10:21,880 --> 00:10:26,950
these NS don't care so I need to go down

222
00:10:24,850 --> 00:10:30,550
all the way to basically 2 however

223
00:10:26,950 --> 00:10:33,550
basically to padding up to 7 characters

224
00:10:30,550 --> 00:10:36,609
at the end of the whatever you are in

225
00:10:33,550 --> 00:10:38,319
encoding it will add equal signs so

226
00:10:36,610 --> 00:10:41,050
that's a very distinctive way to know

227
00:10:38,320 --> 00:10:44,470
that this is a base 62 or Bixby fella -

228
00:10:41,050 --> 00:10:46,449
so I'll add equals so how equals in the

229
00:10:44,470 --> 00:10:49,060
middle of a DNS name does make any sense

230
00:10:46,450 --> 00:10:51,610
so how do I go around it so the way to

231
00:10:49,060 --> 00:10:53,800
do that is I know that is 0 to 7 there's

232
00:10:51,610 --> 00:10:56,770
a maximum of padding that you can get so

233
00:10:53,800 --> 00:11:00,490
what I do is very simple so if I my file

234
00:10:56,770 --> 00:11:02,800
has a 4 equals at the end what I do is I

235
00:11:00,490 --> 00:11:06,100
put a for integer at the beginning of

236
00:11:02,800 --> 00:11:08,800
the file and strip the equals so that

237
00:11:06,100 --> 00:11:11,020
automatically will not be able to do the

238
00:11:08,800 --> 00:11:13,270
basically 2 because this we are already

239
00:11:11,020 --> 00:11:14,439
has a digit at the beginning but that

240
00:11:13,270 --> 00:11:17,650
allow me to me

241
00:11:14,440 --> 00:11:20,470
proper DNS query without a name and also

242
00:11:17,650 --> 00:11:21,100
in the server of the receiver run it

243
00:11:20,470 --> 00:11:23,800
back

244
00:11:21,100 --> 00:11:26,620
right I will split the file whatever

245
00:11:23,800 --> 00:11:30,400
that find us before include to 20 or 30

246
00:11:26,620 --> 00:11:34,150
characters for the DNS I will generate a

247
00:11:30,400 --> 00:11:37,449
source IP list for spoofing this is key

248
00:11:34,150 --> 00:11:39,130
element why because as you saw in the

249
00:11:37,450 --> 00:11:41,440
older techniques flowers what they do is

250
00:11:39,130 --> 00:11:43,720
this is source client doing 20 make of

251
00:11:41,440 --> 00:11:46,510
traffic tool from a one IP to it one

252
00:11:43,720 --> 00:11:51,280
server that's very easy to find however

253
00:11:46,510 --> 00:11:53,860
what I'm doing is you know spoofing it's

254
00:11:51,280 --> 00:11:56,589
a very old technique uses in the 80s 90s

255
00:11:53,860 --> 00:11:59,560
2000 and 2009 Tina's well so what I'm

256
00:11:56,590 --> 00:12:01,660
doing is basically grabbing is last 24

257
00:11:59,560 --> 00:12:04,810
when I'm sitting in the network or slash

258
00:12:01,660 --> 00:12:07,420
22 was trained 3 generate the list of

259
00:12:04,810 --> 00:12:10,089
all their possible IP address and source

260
00:12:07,420 --> 00:12:12,430
proofing my DNS query to the internal

261
00:12:10,090 --> 00:12:15,120
DNS server why I am doing that because

262
00:12:12,430 --> 00:12:17,979
that allowed me to multiply the traffic

263
00:12:15,120 --> 00:12:20,170
threading all at the same time so from

264
00:12:17,980 --> 00:12:22,740
multiple sources so that giving to

265
00:12:20,170 --> 00:12:26,560
advantage first push more packets out

266
00:12:22,740 --> 00:12:28,090
second which one is the real one there's

267
00:12:26,560 --> 00:12:30,400
no way to keep track which one actually

268
00:12:28,090 --> 00:12:33,730
is the real source generating those

269
00:12:30,400 --> 00:12:36,790
strange queries so that throw a with the

270
00:12:33,730 --> 00:12:38,650
guys from Jacques could be anyone

271
00:12:36,790 --> 00:12:41,380
because there's no really unless you

272
00:12:38,650 --> 00:12:44,110
have IPS in front them they the land was

273
00:12:41,380 --> 00:12:45,520
a server pcs are sitting it's very

274
00:12:44,110 --> 00:12:48,670
difficult to detect actually which is

275
00:12:45,520 --> 00:12:51,790
the real IP do in the real queries could

276
00:12:48,670 --> 00:12:54,400
be any of those I will send a controlled

277
00:12:51,790 --> 00:12:56,560
DNS packet the idea here is first of all

278
00:12:54,400 --> 00:12:58,060
I need to tell the my receiver to get

279
00:12:56,560 --> 00:13:00,760
there ok I'm going to send you this file

280
00:12:58,060 --> 00:13:02,260
this is a CLC and this is amount of

281
00:13:00,760 --> 00:13:05,020
packet I'm going to send you a thousand

282
00:13:02,260 --> 00:13:08,860
of them so once I once I send that

283
00:13:05,020 --> 00:13:13,000
control query I will check it with the

284
00:13:08,860 --> 00:13:15,880
data queries multiplied by 254 IP

285
00:13:13,000 --> 00:13:17,860
address the cold Class C is less 24 and

286
00:13:15,880 --> 00:13:20,230
I will send the ID of the packet

287
00:13:17,860 --> 00:13:22,810
their ideas define the sequence of the

288
00:13:20,230 --> 00:13:25,330
packet and the chunk why I'm doing all

289
00:13:22,810 --> 00:13:26,069
this because this allow me to send

290
00:13:25,330 --> 00:13:28,230
multiple part

291
00:13:26,070 --> 00:13:29,910
multiple files at the same time it

292
00:13:28,230 --> 00:13:33,330
doesn't matter which order they go they

293
00:13:29,910 --> 00:13:34,980
all scramble together sequence I do need

294
00:13:33,330 --> 00:13:36,900
to reverse the order and put in sequence

295
00:13:34,980 --> 00:13:39,330
my file that was encrypted and junkit

296
00:13:36,900 --> 00:13:41,040
and having so I do need to know which

297
00:13:39,330 --> 00:13:43,740
packet is like TCP you have a sequence

298
00:13:41,040 --> 00:13:46,530
number for reason and of course the data

299
00:13:43,740 --> 00:13:49,590
and I will do that until it's done once

300
00:13:46,530 --> 00:13:52,500
it's done I will actually back to my

301
00:13:49,590 --> 00:13:54,630
control retransmission packets so I

302
00:13:52,500 --> 00:13:56,130
would say once I finished and in all my

303
00:13:54,630 --> 00:13:57,870
data packets I was in a control

304
00:13:56,130 --> 00:13:59,910
retransmission packet and this is a

305
00:13:57,870 --> 00:14:02,760
trick because if I don't get any answer

306
00:13:59,910 --> 00:14:03,390
this is an a query if I don't get any

307
00:14:02,760 --> 00:14:05,670
answer

308
00:14:03,390 --> 00:14:08,460
that means the file was ok however if

309
00:14:05,670 --> 00:14:10,560
the server did not miss some of the

310
00:14:08,460 --> 00:14:13,320
packets that means that something is

311
00:14:10,560 --> 00:14:14,699
missing so he will reply back to me in a

312
00:14:13,320 --> 00:14:17,220
DNS a query

313
00:14:14,700 --> 00:14:20,640
telling me which packet was miss so I

314
00:14:17,220 --> 00:14:22,020
will resend it until I give timeout that

315
00:14:20,640 --> 00:14:26,699
process will keep repeating until

316
00:14:22,020 --> 00:14:30,810
there's no more missing packet all right

317
00:14:26,700 --> 00:14:33,930
so this is a question for the audience

318
00:14:30,810 --> 00:14:40,349
it does look suspicious to you any of

319
00:14:33,930 --> 00:14:42,780
those two names yes no both left your

320
00:14:40,350 --> 00:14:47,480
hand right your hand I don't know all

321
00:14:42,780 --> 00:14:51,300
pretty simple well yeah probably however

322
00:14:47,480 --> 00:14:54,120
that is an actual real DNS entry from

323
00:14:51,300 --> 00:14:56,430
cloud fair that is actually true that's

324
00:14:54,120 --> 00:14:58,860
what my PC goes sub website out of

325
00:14:56,430 --> 00:15:01,229
Raleigh banner so at or something so

326
00:14:58,860 --> 00:15:03,390
that's actually real web server that

327
00:15:01,230 --> 00:15:07,830
this sucks so if you take a look what

328
00:15:03,390 --> 00:15:10,230
kind of name they're using yes maybe XR

329
00:15:07,830 --> 00:15:14,070
no it's just random digits and numbers

330
00:15:10,230 --> 00:15:18,360
and letters in a way so that is a real

331
00:15:14,070 --> 00:15:20,910
one however this one dot that actually

332
00:15:18,360 --> 00:15:23,130
is the one that I'm using which is bit

333
00:15:20,910 --> 00:15:25,770
more longer in a way by still similar

334
00:15:23,130 --> 00:15:29,010
format so that's the whole point of it

335
00:15:25,770 --> 00:15:32,220
because I got a question about well this

336
00:15:29,010 --> 00:15:33,600
clearly is suspicious right when you see

337
00:15:32,220 --> 00:15:35,700
that this indicator something going on

338
00:15:33,600 --> 00:15:37,560
however it's actually real traffic this

339
00:15:35,700 --> 00:15:39,459
your PC if you do TCP damn you probably

340
00:15:37,560 --> 00:15:43,809
catch things like this going to

341
00:15:39,459 --> 00:15:46,689
cluvin which is a since Google 100 101

342
00:15:43,809 --> 00:15:48,189
of the CD ends actually so that is and

343
00:15:46,689 --> 00:15:50,110
you could go a slightly different

344
00:15:48,189 --> 00:15:55,329
version with dashes if you want to as

345
00:15:50,110 --> 00:15:58,240
well so let me move into the control

346
00:15:55,329 --> 00:16:00,849
flow right so this is an example how the

347
00:15:58,240 --> 00:16:04,059
flow will go I got my client I got the

348
00:16:00,850 --> 00:16:05,529
internal DNS that's my target so what I

349
00:16:04,059 --> 00:16:07,689
want to do is I want to send the file

350
00:16:05,529 --> 00:16:11,139
all the way to my server right the

351
00:16:07,689 --> 00:16:13,389
control domain what it does it need to

352
00:16:11,139 --> 00:16:16,600
be sent by the real actual IP I'm not

353
00:16:13,389 --> 00:16:19,959
spoofing here it's one single NS query

354
00:16:16,600 --> 00:16:21,579
with an offensive name on it so that

355
00:16:19,959 --> 00:16:24,069
will bounce again the route and the

356
00:16:21,579 --> 00:16:27,128
server and eventually you will get cash

357
00:16:24,069 --> 00:16:30,099
by the DNS server that this control dot

358
00:16:27,129 --> 00:16:31,660
domain is actually that server that will

359
00:16:30,100 --> 00:16:33,699
be cached which is a good thing right

360
00:16:31,660 --> 00:16:35,469
because you know if not equally all the

361
00:16:33,699 --> 00:16:38,229
time that's for the control it's only

362
00:16:35,470 --> 00:16:40,360
one packet and the funny part is nothing

363
00:16:38,230 --> 00:16:43,269
come back so from the DNS you will give

364
00:16:40,360 --> 00:16:46,629
you a timeout basically no records in Ex

365
00:16:43,269 --> 00:16:48,819
everlasting school so this is how the

366
00:16:46,629 --> 00:16:52,029
control flow we go the thing in the

367
00:16:48,819 --> 00:16:56,920
middle with the that's supposed to

368
00:16:52,029 --> 00:16:59,499
allegedly foul very smart fouls how the

369
00:16:56,920 --> 00:17:02,259
data flow goes so the data flows will go

370
00:16:59,499 --> 00:17:04,750
and did that dot domain which could be

371
00:17:02,259 --> 00:17:07,929
one who could be fifty different domains

372
00:17:04,750 --> 00:17:09,369
I don't really care so the thing is I

373
00:17:07,929 --> 00:17:12,279
will be sending the chunks from

374
00:17:09,369 --> 00:17:14,678
different source IPS is perfect right to

375
00:17:12,279 --> 00:17:17,199
internal DNS and internal DNS will

376
00:17:14,679 --> 00:17:19,720
require in outside for that domain is

377
00:17:17,199 --> 00:17:21,640
specifically nothing come back there's

378
00:17:19,720 --> 00:17:22,750
no answer right on any of those queries

379
00:17:21,640 --> 00:17:25,270
so there's no caching either

380
00:17:22,750 --> 00:17:27,549
so what tend to happen is once I finish

381
00:17:25,270 --> 00:17:30,639
I was in the retransmission packet and

382
00:17:27,549 --> 00:17:32,740
if I do get an answer that means that

383
00:17:30,640 --> 00:17:37,779
I'm missing something in this example

384
00:17:32,740 --> 00:17:40,270
I'm missing packet Co 7b8 we the packet

385
00:17:37,779 --> 00:17:42,850
has a limitation I will go into that

386
00:17:40,270 --> 00:17:46,430
into later details but I'm missing a

387
00:17:42,850 --> 00:17:49,159
packet so what I do is I do my

388
00:17:46,430 --> 00:17:53,360
I replied back with two hundred two

389
00:17:49,160 --> 00:17:55,640
three nine one two 3.8 to this query how

390
00:17:53,360 --> 00:17:59,570
I do that well basically that is the

391
00:17:55,640 --> 00:18:04,040
seed which I choose two hundred dot ID

392
00:17:59,570 --> 00:18:07,760
of the file which in this case was 239

393
00:18:04,040 --> 00:18:08,300
and actually the file is there too much

394
00:18:07,760 --> 00:18:11,030
daddy

395
00:18:08,300 --> 00:18:13,970
and one two three da place is actually

396
00:18:11,030 --> 00:18:18,170
the integral number four zero seven bb-8

397
00:18:13,970 --> 00:18:20,930
so in that simple and it squarely answer

398
00:18:18,170 --> 00:18:24,110
I'm actually asking please send me back

399
00:18:20,930 --> 00:18:26,720
that one and that that process will

400
00:18:24,110 --> 00:18:30,229
repeat until I don't hear any more so

401
00:18:26,720 --> 00:18:33,470
when when I make a query again and I

402
00:18:30,230 --> 00:18:36,380
don't get any answer that means okay you

403
00:18:33,470 --> 00:18:40,460
got recall all the packets so in that

404
00:18:36,380 --> 00:18:42,380
way is I'm trying to put at say minimum

405
00:18:40,460 --> 00:18:44,840
or retransmission because this

406
00:18:42,380 --> 00:18:47,960
effectively is that answer you see there

407
00:18:44,840 --> 00:18:50,750
is the retransmission and the only use

408
00:18:47,960 --> 00:18:53,180
it when you actually need the packet so

409
00:18:50,750 --> 00:18:55,820
I'm trying to as I said before same

410
00:18:53,180 --> 00:18:59,390
atomic but if I do lose a packet in the

411
00:18:55,820 --> 00:19:02,179
way I need them the answer so that is

412
00:18:59,390 --> 00:19:06,290
the mix of the tube two-way so within

413
00:19:02,180 --> 00:19:09,920
then 200 2 3 9 1 2 3 top 8 is actually

414
00:19:06,290 --> 00:19:13,460
encoded my packet missing please send it

415
00:19:09,920 --> 00:19:17,120
back so this gives you an overall of

416
00:19:13,460 --> 00:19:22,040
actually the itself of the flows goes on

417
00:19:17,120 --> 00:19:26,479
the on the packet so this is a real

418
00:19:22,040 --> 00:19:28,840
example so the control packet and we

419
00:19:26,480 --> 00:19:33,340
have that format which is a EF is the ID

420
00:19:28,840 --> 00:19:37,639
BBC CD is the CRC this is fixed to six

421
00:19:33,340 --> 00:19:40,250
digit characters right the ABCD is

422
00:19:37,640 --> 00:19:44,570
basically the amount of packets so I'm

423
00:19:40,250 --> 00:19:47,210
using up to 4 that means 65 535 amount

424
00:19:44,570 --> 00:19:50,179
of packet possible in a file will go

425
00:19:47,210 --> 00:19:51,860
into limitations later on so then once

426
00:19:50,180 --> 00:19:54,830
it's in my control packet I will start

427
00:19:51,860 --> 00:19:56,840
sending my data packets right and the

428
00:19:54,830 --> 00:19:59,779
data will have the ID the sequence

429
00:19:56,840 --> 00:20:03,109
number which again go from 1 to 6

430
00:19:59,779 --> 00:20:06,169
5:35 the data chunk under domain the

431
00:20:03,109 --> 00:20:08,629
data domain this can be multiplied by

432
00:20:06,169 --> 00:20:12,139
any amount of domains for retransmission

433
00:20:08,629 --> 00:20:14,090
I'm sending the file ID and the sequence

434
00:20:12,139 --> 00:20:16,580
here if I get an answer

435
00:20:14,090 --> 00:20:19,129
that means am I missing something if I

436
00:20:16,580 --> 00:20:23,449
don't we are good to go

437
00:20:19,129 --> 00:20:28,279
so in that way we try to combine a bit

438
00:20:23,450 --> 00:20:30,289
of everything here all right so this

439
00:20:28,279 --> 00:20:31,070
look very nice actually works that's a

440
00:20:30,289 --> 00:20:33,950
good question

441
00:20:31,070 --> 00:20:38,029
because the first time I say ok this is

442
00:20:33,950 --> 00:20:39,919
a good hypothesis put in practical right

443
00:20:38,029 --> 00:20:43,249
so I decide I'm going to build the

444
00:20:39,919 --> 00:20:46,309
environment to test it out so in case

445
00:20:43,249 --> 00:20:48,919
you're nowhere macaroni is actually this

446
00:20:46,309 --> 00:20:50,418
box here behind me or next to me

447
00:20:48,919 --> 00:20:52,759
actually which is basically

448
00:20:50,419 --> 00:20:56,509
infrastructure in the case because Cisco

449
00:20:52,759 --> 00:21:00,200
switches servers and firewalls etcetera

450
00:20:56,509 --> 00:21:01,820
etcetera which is easy to carry so what

451
00:21:00,200 --> 00:21:03,799
you see here is well actually you will

452
00:21:01,820 --> 00:21:06,289
see right has an internal DNS server a

453
00:21:03,799 --> 00:21:09,889
foul server and client basically all

454
00:21:06,289 --> 00:21:15,589
built with some Raspberry Pi Cisco stuff

455
00:21:09,889 --> 00:21:18,109
cabling so I'm going to try to see that

456
00:21:15,589 --> 00:21:20,899
this actually works a lot so what I did

457
00:21:18,109 --> 00:21:24,228
at the beginning was right to some

458
00:21:20,899 --> 00:21:26,508
testing in Python and then I found out I

459
00:21:24,229 --> 00:21:29,899
was really good I was testing a look

460
00:21:26,509 --> 00:21:33,169
back yeah realization is no look back so

461
00:21:29,899 --> 00:21:34,968
I went into the actual infrastructure to

462
00:21:33,169 --> 00:21:37,309
realize how it works and I found

463
00:21:34,969 --> 00:21:38,869
interesting things on it which is

464
00:21:37,309 --> 00:21:41,809
probably part of the behavior of the

465
00:21:38,869 --> 00:21:44,988
normal infrastructure so proof of

466
00:21:41,809 --> 00:21:47,239
concept so demo or go away it's a very

467
00:21:44,989 --> 00:21:50,029
nice theory but we actually need to show

468
00:21:47,239 --> 00:21:51,799
it right so let's see if it works

469
00:21:50,029 --> 00:21:55,210
because it's a live demo it's no video

470
00:21:51,799 --> 00:22:00,589
it may not work you know how this work

471
00:21:55,210 --> 00:22:04,239
first of all can you see yeah hopefully

472
00:22:00,589 --> 00:22:07,428
if not let me know and I will swim in so

473
00:22:04,239 --> 00:22:09,229
on the top is an internet server could

474
00:22:07,429 --> 00:22:13,850
EVPs or anything in the Internet

475
00:22:09,229 --> 00:22:16,100
right with a server software on the

476
00:22:13,850 --> 00:22:19,580
bottom is the actually client right

477
00:22:16,100 --> 00:22:21,590
which is your internal server or client

478
00:22:19,580 --> 00:22:23,299
that you took control of it just

479
00:22:21,590 --> 00:22:25,850
remember this is most of the stuff is

480
00:22:23,299 --> 00:22:27,110
designed to post exploitation so once

481
00:22:25,850 --> 00:22:28,309
you get control of this you wanna take

482
00:22:27,110 --> 00:22:31,219
files out

483
00:22:28,309 --> 00:22:33,639
so first of all let's see if we kind of

484
00:22:31,220 --> 00:22:37,780
start the server right the server itself

485
00:22:33,640 --> 00:22:40,070
has a just a few parameters completing

486
00:22:37,780 --> 00:22:43,668
their boss move maybe I can't remember

487
00:22:40,070 --> 00:22:47,210
what we're post us you specify the

488
00:22:43,669 --> 00:22:49,220
interface now you need to specify data

489
00:22:47,210 --> 00:22:51,530
domains and control domains so I have

490
00:22:49,220 --> 00:22:54,950
two switches basically you can specify

491
00:22:51,530 --> 00:22:58,580
just one control one data or you can

492
00:22:54,950 --> 00:23:01,370
give a file with a list of it so let me

493
00:22:58,580 --> 00:23:06,439
see if I haven't for example for control

494
00:23:01,370 --> 00:23:11,689
domain I can find with one domain for

495
00:23:06,440 --> 00:23:15,020
data domains I have a Phi with one two

496
00:23:11,690 --> 00:23:17,240
three four five right so let's use those

497
00:23:15,020 --> 00:23:20,539
those of course need server and client

498
00:23:17,240 --> 00:23:23,450
it too much if not make no sense so let

499
00:23:20,539 --> 00:23:27,700
me bring up the server the ROS interface

500
00:23:23,450 --> 00:23:34,340
and let's use control data domain data

501
00:23:27,700 --> 00:23:36,799
control domain is this one that's it so

502
00:23:34,340 --> 00:23:41,330
let me run the server first then we'll

503
00:23:36,799 --> 00:23:43,760
write debug so 200 200 200 is my

504
00:23:41,330 --> 00:23:45,678
actually interface IP public which is

505
00:23:43,760 --> 00:23:46,760
running the lab writings no actually I

506
00:23:45,679 --> 00:23:51,980
don't know who owned it to be honest

507
00:23:46,760 --> 00:23:55,370
Dean asked so in the client side so in

508
00:23:51,980 --> 00:23:58,520
the client this is a client it's very

509
00:23:55,370 --> 00:24:01,939
similar features you still need to

510
00:23:58,520 --> 00:24:04,220
specify control in a file of all domain

511
00:24:01,940 --> 00:24:07,039
specific and the data and the interface

512
00:24:04,220 --> 00:24:11,110
but of course you need to specify a file

513
00:24:07,039 --> 00:24:13,929
to to transfer you can specify directory

514
00:24:11,110 --> 00:24:16,610
so if you specify the directory you will

515
00:24:13,929 --> 00:24:21,620
grab all the files there and push them

516
00:24:16,610 --> 00:24:24,168
out so that's designed to basically push

517
00:24:21,620 --> 00:24:25,969
directories out with all the files then

518
00:24:24,169 --> 00:24:28,070
I have a few features here I can control

519
00:24:25,970 --> 00:24:30,200
which DNS I want to send it

520
00:24:28,070 --> 00:24:33,200
whoo I could use the one on the system

521
00:24:30,200 --> 00:24:34,730
or I can specify one manually so if I

522
00:24:33,200 --> 00:24:37,580
don't specify I will use the one in the

523
00:24:34,730 --> 00:24:40,280
system and also need to I could specify

524
00:24:37,580 --> 00:24:42,020
the network so for example if I don't

525
00:24:40,280 --> 00:24:45,379
specify the network it will grab the

526
00:24:42,020 --> 00:24:47,510
network I'm in and the net mask I mean

527
00:24:45,380 --> 00:24:49,340
however if I want to make it bigger I

528
00:24:47,510 --> 00:24:52,670
could have specified the network on this

529
00:24:49,340 --> 00:24:56,389
super net for example if I do I'm in a

530
00:24:52,670 --> 00:24:59,270
slash 24 I do s 3 that means I c-can't

531
00:24:56,390 --> 00:25:02,030
become its last 21 why this is important

532
00:24:59,270 --> 00:25:04,790
because that's for spoofing so that

533
00:25:02,030 --> 00:25:05,930
means that I could amplify the amount of

534
00:25:04,790 --> 00:25:08,629
packets and nuts

535
00:25:05,930 --> 00:25:11,390
this is threading so all at same time so

536
00:25:08,630 --> 00:25:13,970
I can multiply my source IP address fake

537
00:25:11,390 --> 00:25:16,760
source IP address on sending data so

538
00:25:13,970 --> 00:25:19,160
this is like a ADSL works the upload and

539
00:25:16,760 --> 00:25:21,620
the download remember you're pushing

540
00:25:19,160 --> 00:25:23,660
data out so you don't want anything to

541
00:25:21,620 --> 00:25:26,360
come in so it's a synchronous basically

542
00:25:23,660 --> 00:25:27,980
transfer so you want as much packet you

543
00:25:26,360 --> 00:25:29,750
can set at the same time from different

544
00:25:27,980 --> 00:25:33,500
source IPS that give you a different

545
00:25:29,750 --> 00:25:37,010
speed that's it that's all features that

546
00:25:33,500 --> 00:25:47,270
and file of course directly alright so

547
00:25:37,010 --> 00:25:49,370
let's give a try interface we say data

548
00:25:47,270 --> 00:25:52,100
domain is the file and control domain is

549
00:25:49,370 --> 00:25:56,629
this is paid for anything is five date

550
00:25:52,100 --> 00:25:59,330
remains one control DNS will specify

551
00:25:56,630 --> 00:26:04,880
this one and the file right so I'm going

552
00:25:59,330 --> 00:26:11,689
to send a the shallow right so once I

553
00:26:04,880 --> 00:26:13,400
hit enter right it will grab the 254 IP

554
00:26:11,690 --> 00:26:17,390
address of the glasses the net world I

555
00:26:13,400 --> 00:26:19,370
specify so the file at least 90 right so

556
00:26:17,390 --> 00:26:25,400
what that means is actually the

557
00:26:19,370 --> 00:26:29,449
generator from 0 to 255 so just an ID so

558
00:26:25,400 --> 00:26:30,950
underneath on kit and he sent the

559
00:26:29,450 --> 00:26:33,140
retransmission packet

560
00:26:30,950 --> 00:26:35,570
nothing come back so it believed that

561
00:26:33,140 --> 00:26:37,490
it's all good now if I go to the server

562
00:26:35,570 --> 00:26:40,639
the server dreaming that he's receiving

563
00:26:37,490 --> 00:26:41,840
a file called shadow and this is a CSE

564
00:26:40,640 --> 00:26:43,880
Rachel

565
00:26:41,840 --> 00:26:46,459
and if you check this here c-32 on the

566
00:26:43,880 --> 00:26:48,710
server is actually the same one so in

567
00:26:46,460 --> 00:26:51,679
this case there's no retransmission that

568
00:26:48,710 --> 00:26:53,870
means that file got same Apple took a

569
00:26:51,679 --> 00:26:54,289
few seconds I guess it's a small file

570
00:26:53,870 --> 00:26:59,658
right

571
00:26:54,289 --> 00:27:01,850
so what tend to happen is once you this

572
00:26:59,659 --> 00:27:05,080
work nice but will happen when you send

573
00:27:01,850 --> 00:27:08,539
bigger fights and that could be an issue

574
00:27:05,080 --> 00:27:11,029
because there's some limitations on the

575
00:27:08,539 --> 00:27:12,799
amount of big of the file based on the

576
00:27:11,029 --> 00:27:18,230
sequence number remember I mentioned I'm

577
00:27:12,799 --> 00:27:23,330
using for in within the sequence number

578
00:27:18,230 --> 00:27:26,149
and this is from 0 0 0 1 to 65535 why

579
00:27:23,330 --> 00:27:28,480
because that's my actually limitation so

580
00:27:26,149 --> 00:27:32,209
what happen if there's a fight with

581
00:27:28,480 --> 00:27:33,919
17,000 packet chunk it right well it

582
00:27:32,210 --> 00:27:37,130
doesn't fit so that's the limitation

583
00:27:33,919 --> 00:27:39,500
dies it's a run for max to be around

584
00:27:37,130 --> 00:27:41,419
specific you always could check the file

585
00:27:39,500 --> 00:27:43,610
as well into pieces if you want to with

586
00:27:41,419 --> 00:27:45,770
the split command in Linux but the

587
00:27:43,610 --> 00:27:47,779
limitation come in the four digits left

588
00:27:45,770 --> 00:27:49,250
for sequence number so it's a run for

589
00:27:47,779 --> 00:27:51,409
max limitation files

590
00:27:49,250 --> 00:27:53,630
so anyway bigger than 4 max you will

591
00:27:51,409 --> 00:27:57,860
need to chunk it to actually be able to

592
00:27:53,630 --> 00:28:00,950
send it so again the whole concept of

593
00:27:57,860 --> 00:28:06,559
this is to be able to send files so

594
00:28:00,950 --> 00:28:08,270
let's try to send something bigger so

595
00:28:06,559 --> 00:28:12,110
I'm going to send a different file yeah

596
00:28:08,270 --> 00:28:13,639
this one customer DV which what tend to

597
00:28:12,110 --> 00:28:18,080
happen when you send bigger files and

598
00:28:13,640 --> 00:28:22,220
this is DNS nature so again I just took

599
00:28:18,080 --> 00:28:25,309
file ID 25 and there's 1900 chunks right

600
00:28:22,220 --> 00:28:27,830
that means I'm going to do 1900 queries

601
00:28:25,309 --> 00:28:29,389
basically right what tend to happy with

602
00:28:27,830 --> 00:28:33,260
DNS because it's very uh efficient

603
00:28:29,390 --> 00:28:37,279
protocol things get lost so this is by

604
00:28:33,260 --> 00:28:39,860
nature so this is where even I did not

605
00:28:37,279 --> 00:28:42,289
impose lose packets to test the rest

606
00:28:39,860 --> 00:28:44,029
transmission this is start to happen so

607
00:28:42,289 --> 00:28:46,789
the this is where the retransmission

608
00:28:44,029 --> 00:28:48,830
actually help because in the nature of

609
00:28:46,789 --> 00:28:51,990
DNS you lose a package constantly

610
00:28:48,830 --> 00:28:53,428
transmitting it we asking again DNS in

611
00:28:51,990 --> 00:28:55,590
pocket make a hell of a difference

612
00:28:53,429 --> 00:28:57,840
because I will not be able to decrypt it

613
00:28:55,590 --> 00:29:00,659
decoded or anything actually if I miss

614
00:28:57,840 --> 00:29:02,459
one single packet so this is why the

615
00:29:00,660 --> 00:29:04,980
retransmission is a key element and

616
00:29:02,460 --> 00:29:08,520
feature that I needed and this is going

617
00:29:04,980 --> 00:29:12,270
to take approximately three minutes so I

618
00:29:08,520 --> 00:29:14,190
will take questions right now because

619
00:29:12,270 --> 00:29:16,200
know I want to be cremated waiting for

620
00:29:14,190 --> 00:29:19,559
something to finish so if you want in

621
00:29:16,200 --> 00:29:20,880
the meantime for we can all be inside as

622
00:29:19,559 --> 00:29:23,940
if you want to wait in three minutes

623
00:29:20,880 --> 00:29:25,830
but we can take some answers from some

624
00:29:23,940 --> 00:29:27,900
questions from yeah

625
00:29:25,830 --> 00:29:30,300
Emilio hang on a second what we'll do is

626
00:29:27,900 --> 00:29:32,340
perhaps throw it open to the floor and

627
00:29:30,300 --> 00:29:33,899
then give them priority and then if not

628
00:29:32,340 --> 00:29:35,909
we'll come back to Seidel is that okay

629
00:29:33,900 --> 00:29:37,100
yes but any questions for Emilio from

630
00:29:35,910 --> 00:29:42,150
the floor yes ma'am

631
00:29:37,100 --> 00:29:45,260
here she's gunning for her third best

632
00:29:42,150 --> 00:29:48,000
question price in two days in a row

633
00:29:45,260 --> 00:29:50,809
given the precautions that you have

634
00:29:48,000 --> 00:29:53,760
stated earlier like yeah

635
00:29:50,809 --> 00:29:58,559
dividing it from different subdomains

636
00:29:53,760 --> 00:30:02,850
and not sending more more requests like

637
00:29:58,559 --> 00:30:05,520
limiting it to 20 to 30 requests how

638
00:30:02,850 --> 00:30:07,919
what is the best way to actually detect

639
00:30:05,520 --> 00:30:12,600
this type of attack since you are aiming

640
00:30:07,920 --> 00:30:15,059
to be in stealth mode I will answer in a

641
00:30:12,600 --> 00:30:18,510
simple way I have that answer in the

642
00:30:15,059 --> 00:30:20,700
next line but if I do you guys like

643
00:30:18,510 --> 00:30:23,160
spoiler right but I do have that answer

644
00:30:20,700 --> 00:30:25,830
actually kind of I pass all the

645
00:30:23,160 --> 00:30:26,309
conclusions I do I do it's a good

646
00:30:25,830 --> 00:30:28,980
question though

647
00:30:26,309 --> 00:30:32,520
but yes I thought about it so I put it

648
00:30:28,980 --> 00:30:35,010
down the answer right so do you want to

649
00:30:32,520 --> 00:30:37,110
answer it now or no Rosie that is a

650
00:30:35,010 --> 00:30:38,820
conclusion closing okay okay so you want

651
00:30:37,110 --> 00:30:40,469
to leave that to last yes I do have an

652
00:30:38,820 --> 00:30:42,330
answer for you I will remember it all

653
00:30:40,470 --> 00:30:43,400
right or any other questions from the

654
00:30:42,330 --> 00:30:46,980
audience

655
00:30:43,400 --> 00:30:49,380
suddenly Mena have left no actually you

656
00:30:46,980 --> 00:30:52,050
you have 29 minutes left no no no for

657
00:30:49,380 --> 00:30:53,940
the testing to finish off or the testing

658
00:30:52,050 --> 00:30:57,540
to finish now we could all be insiders

659
00:30:53,940 --> 00:30:59,220
waiting for the screen okay so any more

660
00:30:57,540 --> 00:31:02,520
questions if not we'll take the first

661
00:30:59,220 --> 00:31:05,010
one from Salado the most uploaded one

662
00:31:02,520 --> 00:31:07,290
Wow seven votes in the

663
00:31:05,010 --> 00:31:09,720
to the tech planning on next-generation

664
00:31:07,290 --> 00:31:12,270
flowers it does any other way to detect

665
00:31:09,720 --> 00:31:15,420
or defend especially on the cloud yeah

666
00:31:12,270 --> 00:31:17,520
on AWS okay guys that's a very good

667
00:31:15,420 --> 00:31:20,730
question because yes next generation

668
00:31:17,520 --> 00:31:22,410
flowers do application intelligence so

669
00:31:20,730 --> 00:31:24,000
they actually look for protocols and

670
00:31:22,410 --> 00:31:26,340
they will see that is really an iodine

671
00:31:24,000 --> 00:31:30,510
for the understand little things like

672
00:31:26,340 --> 00:31:33,810
that however in the cloud is a bit

673
00:31:30,510 --> 00:31:36,810
tricky because for example sure cloud

674
00:31:33,810 --> 00:31:38,850
right he will you get the private cloud

675
00:31:36,810 --> 00:31:40,710
you get the access to your private cloud

676
00:31:38,850 --> 00:31:43,139
you build a service and then there's one

677
00:31:40,710 --> 00:31:46,050
small details those server has DNS

678
00:31:43,140 --> 00:31:47,340
access even that they're not actually an

679
00:31:46,050 --> 00:31:50,129
internet they have DNS resolution

680
00:31:47,340 --> 00:31:52,649
working because they say essence of the

681
00:31:50,130 --> 00:31:54,750
cloud all those VMs that the cloud

682
00:31:52,650 --> 00:31:57,480
provide to you they need to work

683
00:31:54,750 --> 00:31:59,820
actually to be built to start to work to

684
00:31:57,480 --> 00:32:01,560
provision they need DNS and they would

685
00:31:59,820 --> 00:32:04,169
tend to happen is Microsoft will give

686
00:32:01,560 --> 00:32:06,270
them then to the private cloud service

687
00:32:04,170 --> 00:32:08,670
they gave the Microsoft DNS which you

688
00:32:06,270 --> 00:32:12,030
can't resolve anything in the internet

689
00:32:08,670 --> 00:32:14,820
they may not have access to it so in the

690
00:32:12,030 --> 00:32:16,620
cloud is a bit tricky because you the

691
00:32:14,820 --> 00:32:19,350
best way you can do is to control where

692
00:32:16,620 --> 00:32:22,199
is your DNS flow goes so if you are

693
00:32:19,350 --> 00:32:24,270
using Microsoft DNS you don't have much

694
00:32:22,200 --> 00:32:27,060
visibility so the best way to do is to

695
00:32:24,270 --> 00:32:32,730
rely on your Odin DNS infrastructure and

696
00:32:27,060 --> 00:32:37,409
then forwarded to really basically ready

697
00:32:32,730 --> 00:32:41,490
now I think so cool all right all right

698
00:32:37,410 --> 00:32:44,310
something is happening here so as you

699
00:32:41,490 --> 00:32:46,860
can see this was a server right so the

700
00:32:44,310 --> 00:32:50,220
server detect that there are some chunks

701
00:32:46,860 --> 00:32:52,590
missing and those have the chunks ID so

702
00:32:50,220 --> 00:32:55,680
what I start to happen is he start to

703
00:32:52,590 --> 00:32:56,610
one by one request to the server click

704
00:32:55,680 --> 00:32:59,880
to the client

705
00:32:56,610 --> 00:33:02,370
listen I'm missing the four one six send

706
00:32:59,880 --> 00:33:05,070
it then I am missing the one one four

707
00:33:02,370 --> 00:33:06,659
five send it and then go on that's the

708
00:33:05,070 --> 00:33:09,120
reason you see the actual experiment

709
00:33:06,660 --> 00:33:11,670
going down right you start to shrink

710
00:33:09,120 --> 00:33:13,620
until there's no more missing files the

711
00:33:11,670 --> 00:33:17,730
mom machine is basically the client will

712
00:33:13,620 --> 00:33:18,810
ask no answer that means okay everything

713
00:33:17,730 --> 00:33:20,460
must be good

714
00:33:18,810 --> 00:33:23,940
remember that because this

715
00:33:20,460 --> 00:33:27,180
retransmission are and is a query know a

716
00:33:23,940 --> 00:33:29,880
DNS equally no ns so that means they get

717
00:33:27,180 --> 00:33:33,840
cash and that could be a problem in the

718
00:33:29,880 --> 00:33:36,300
future so this entry that I'm asking for

719
00:33:33,840 --> 00:33:39,030
and I get in a reply flow he's getting

720
00:33:36,300 --> 00:33:40,980
cash my internal DNS write with a random

721
00:33:39,030 --> 00:33:44,370
like well no random IP 1 IP address that

722
00:33:40,980 --> 00:33:47,760
may not need it in the future so they

723
00:33:44,370 --> 00:33:49,649
say catch with the TTL caching right

724
00:33:47,760 --> 00:33:53,730
normally it is an hour

725
00:33:49,650 --> 00:33:56,400
at least in most DNS so one issue could

726
00:33:53,730 --> 00:33:58,380
be that you send in the file and they've

727
00:33:56,400 --> 00:34:01,560
and then you retransmission for it

728
00:33:58,380 --> 00:34:03,930
this is file ID 25 then a while later

729
00:34:01,560 --> 00:34:07,260
half an hour later you some another file

730
00:34:03,930 --> 00:34:10,200
I'm for pure randomness you get file ID

731
00:34:07,260 --> 00:34:12,510
25 and if you ask for retransmission you

732
00:34:10,199 --> 00:34:14,100
get the wrong chunks because you will

733
00:34:12,510 --> 00:34:16,560
have the reply with the cache

734
00:34:14,100 --> 00:34:18,810
he doesn't get to the server so just be

735
00:34:16,560 --> 00:34:19,259
aware of the clashing files within an

736
00:34:18,810 --> 00:34:21,960
hour

737
00:34:19,260 --> 00:34:24,450
fie ID which this is randomly generated

738
00:34:21,960 --> 00:34:27,449
at the beginning every time you run the

739
00:34:24,449 --> 00:34:29,790
program will pick it up lottery from 0

740
00:34:27,449 --> 00:34:32,219
to 255 teammate well ship what one

741
00:34:29,790 --> 00:34:34,860
actually so you will pick up just file

742
00:34:32,219 --> 00:34:36,540
ID so in this case the last thing you

743
00:34:34,860 --> 00:34:41,270
can see if I scroll back

744
00:34:36,540 --> 00:34:44,429
the CRC of this database was 29 B and

745
00:34:41,270 --> 00:34:49,429
the actually server was here is the same

746
00:34:44,429 --> 00:34:54,060
CRC that means he works how long it took

747
00:34:49,429 --> 00:34:57,500
thing was around 280 seconds all right

748
00:34:54,060 --> 00:35:03,450
how big it was define good question

749
00:34:57,500 --> 00:35:06,450
120 K so this yes is no giggle speed

750
00:35:03,450 --> 00:35:08,490
because she said DNS is the channel

751
00:35:06,450 --> 00:35:11,160
protocol basic of corporate over being

752
00:35:08,490 --> 00:35:14,129
used so it's not the massive speed by

753
00:35:11,160 --> 00:35:17,220
again if you were if you are over 30 and

754
00:35:14,130 --> 00:35:19,440
you remember the the towns of a Mullins

755
00:35:17,220 --> 00:35:23,040
you will notice that you will appreciate

756
00:35:19,440 --> 00:35:26,760
that this is actually okay but a yeah so

757
00:35:23,040 --> 00:35:30,910
let me go back to the slice so it it

758
00:35:26,760 --> 00:35:34,599
work right it's a is not in Python is

759
00:35:30,910 --> 00:35:38,129
thing was Missy's what I'm using this is

760
00:35:34,599 --> 00:35:43,210
Cappy and DNS and of course I'm using

761
00:35:38,130 --> 00:35:46,140
the P PI is and this is actually Python

762
00:35:43,210 --> 00:35:49,089
3 by the way so this is already

763
00:35:46,140 --> 00:35:51,730
compliance with the Python going

764
00:35:49,089 --> 00:35:54,759
end-of-life this is slightly tricky but

765
00:35:51,730 --> 00:35:57,849
there is Python 3 so I will try to push

766
00:35:54,759 --> 00:36:01,180
it too soon as I get time online so you

767
00:35:57,849 --> 00:36:03,700
know this is a PLC right if you find

768
00:36:01,180 --> 00:36:06,129
bugs or modifications or performance I

769
00:36:03,700 --> 00:36:07,328
remember I wasn't a programmer before

770
00:36:06,130 --> 00:36:11,640
and still not one of them

771
00:36:07,329 --> 00:36:15,339
so how yeah it works though it does work

772
00:36:11,640 --> 00:36:19,049
so let me go back to the slice prove a

773
00:36:15,339 --> 00:36:23,319
concept check this when I went ahead now

774
00:36:19,049 --> 00:36:26,559
performance right so this was a hundred

775
00:36:23,319 --> 00:36:28,808
twenty K was a one almost two thousand

776
00:36:26,559 --> 00:36:31,329
packets and I was with using twenty

777
00:36:28,809 --> 00:36:33,759
characters right I could use thirty but

778
00:36:31,329 --> 00:36:36,369
it become a bit most efficient maybe too

779
00:36:33,759 --> 00:36:39,220
long so of course when you more culty

780
00:36:36,369 --> 00:36:41,140
use speed you get but also this is

781
00:36:39,220 --> 00:36:44,078
specious you get so you need to balance

782
00:36:41,140 --> 00:36:45,848
the question there I'm using a slash 24

783
00:36:44,079 --> 00:36:48,369
so I mean 254 ipiales

784
00:36:45,849 --> 00:36:51,400
at source apiece sending data I'm using

785
00:36:48,369 --> 00:36:53,740
fast data domains and one control

786
00:36:51,400 --> 00:36:55,299
control is actually either the initial

787
00:36:53,740 --> 00:36:58,299
packet under a transmission

788
00:36:55,299 --> 00:36:59,680
so basically probably five or six six

789
00:36:58,299 --> 00:37:01,450
queries maybe was I can't remember how

790
00:36:59,680 --> 00:37:03,848
many to a transmission packet maybe six

791
00:37:01,450 --> 00:37:05,980
or seven so what is the result

792
00:37:03,849 --> 00:37:08,980
270 seconds is what it took for that

793
00:37:05,980 --> 00:37:12,460
size files and I get this is important I

794
00:37:08,980 --> 00:37:15,160
get one to two queries so if you look

795
00:37:12,460 --> 00:37:19,210
the lock on the traffic each IP address

796
00:37:15,160 --> 00:37:22,149
did to quality now you want to go and do

797
00:37:19,210 --> 00:37:26,950
you know I PS is an NS so you will see

798
00:37:22,150 --> 00:37:29,920
that an IP address the two queries to

799
00:37:26,950 --> 00:37:31,509
two different domains that's it that

800
00:37:29,920 --> 00:37:34,000
doesn't look suspicious at all actually

801
00:37:31,509 --> 00:37:35,740
so it's not the same that the one IP

802
00:37:34,000 --> 00:37:38,619
address hammer in 20 mix of throughput

803
00:37:35,740 --> 00:37:40,689
to a DNS server in the Internet that's

804
00:37:38,619 --> 00:37:42,670
where the species get so the whole idea

805
00:37:40,690 --> 00:37:44,890
of using the source IP and multiple data

806
00:37:42,670 --> 00:37:48,160
domains first of all is to

807
00:37:44,890 --> 00:37:50,170
avoid getting a spike on the graphics of

808
00:37:48,160 --> 00:37:52,870
less suspicious stuff so this is what

809
00:37:50,170 --> 00:37:54,520
they took two queries yeah there's many

810
00:37:52,870 --> 00:37:56,200
a piece of in DNS query and if you look

811
00:37:54,520 --> 00:37:59,650
at the DNS locks of the network in any

812
00:37:56,200 --> 00:38:01,240
enterprise thousand of the queries plus

813
00:37:59,650 --> 00:38:05,830
everything is wrong configure actually

814
00:38:01,240 --> 00:38:09,100
so query for control domain is basically

815
00:38:05,830 --> 00:38:12,360
one and it took this is actually four

816
00:38:09,100 --> 00:38:16,660
point eight kilo bits per second speed

817
00:38:12,360 --> 00:38:20,230
sure it's not giggling speed by again if

818
00:38:16,660 --> 00:38:24,089
you like phone numbers and BBS that's

819
00:38:20,230 --> 00:38:27,820
what is three it still would now

820
00:38:24,090 --> 00:38:30,850
limitations right as I mentioned before

821
00:38:27,820 --> 00:38:34,960
I can only send 255 when I say

822
00:38:30,850 --> 00:38:37,060
directories I can only get 255 files at

823
00:38:34,960 --> 00:38:40,060
the same time why because I usually

824
00:38:37,060 --> 00:38:43,360
basically for identification I use in Co

825
00:38:40,060 --> 00:38:46,240
Co FF that's basically seen at 256

826
00:38:43,360 --> 00:38:48,310
so I'm now convinced 0 255 actually

827
00:38:46,240 --> 00:38:51,100
simultaneous files this is all done

828
00:38:48,310 --> 00:38:52,840
threading in Python so I don't need to

829
00:38:51,100 --> 00:38:55,120
specify the files there's no sequence

830
00:38:52,840 --> 00:38:58,210
they're all in parallel going at the

831
00:38:55,120 --> 00:39:00,850
same time and I'm randomly sending

832
00:38:58,210 --> 00:39:04,330
chunks by random sequence of random

833
00:39:00,850 --> 00:39:06,790
files why because that avoid any other

834
00:39:04,330 --> 00:39:09,970
pattern so if you see the Nisqually 0 1

835
00:39:06,790 --> 00:39:11,590
0 0 0 3 0 4 yeah you can get there's

836
00:39:09,970 --> 00:39:15,089
actually a pattern here right

837
00:39:11,590 --> 00:39:19,960
however this is random domains random

838
00:39:15,090 --> 00:39:22,090
sequence ID then at any time because the

839
00:39:19,960 --> 00:39:24,490
whole magic happened the server he get

840
00:39:22,090 --> 00:39:26,590
all the chunks then reassemble we

841
00:39:24,490 --> 00:39:29,279
sequence them like that's TCP basically

842
00:39:26,590 --> 00:39:32,230
and then decrypted an l-sit residency

843
00:39:29,280 --> 00:39:34,420
under a transmission that was a caching

844
00:39:32,230 --> 00:39:37,030
problem so if I same 550 as I said

845
00:39:34,420 --> 00:39:38,770
before you get actually kept if you ask

846
00:39:37,030 --> 00:39:40,810
for a transmission you get cash on the

847
00:39:38,770 --> 00:39:43,600
internal DNS so I just need to wait for

848
00:39:40,810 --> 00:39:48,340
the cash to expire but it will happen

849
00:39:43,600 --> 00:39:51,220
it's not bulletproof right so where are

850
00:39:48,340 --> 00:39:52,780
we going from here this is very nice by

851
00:39:51,220 --> 00:39:55,089
still I'm basically having 10 domains

852
00:39:52,780 --> 00:39:57,339
fight around 50 domains pointing to one

853
00:39:55,090 --> 00:40:00,219
server right the NS

854
00:39:57,339 --> 00:40:03,788
cause of that those domain of subdomains

855
00:40:00,219 --> 00:40:06,880
upon to my server which is one so if you

856
00:40:03,789 --> 00:40:08,469
do traffic analysis either there are

857
00:40:06,880 --> 00:40:10,630
many different queries to many different

858
00:40:08,469 --> 00:40:12,759
domains still the destination is still

859
00:40:10,630 --> 00:40:16,269
being one DNS server in the internet

860
00:40:12,759 --> 00:40:19,359
right so where we go from here the

861
00:40:16,269 --> 00:40:22,089
defects basically is the devolution of

862
00:40:19,359 --> 00:40:25,359
defects is the ideas and this is

863
00:40:22,089 --> 00:40:28,170
actually okay if I'm doing a reordering

864
00:40:25,359 --> 00:40:32,019
the whole packets anyway I could easily

865
00:40:28,170 --> 00:40:34,450
scale down like a 10 B no.20 VPS

866
00:40:32,019 --> 00:40:37,749
services as Krotz different Amazon

867
00:40:34,450 --> 00:40:39,460
servers across different regions even as

868
00:40:37,749 --> 00:40:41,529
long as they have a back channel

869
00:40:39,460 --> 00:40:44,140
communication between them and master

870
00:40:41,529 --> 00:40:45,999
control that can actually synchronize so

871
00:40:44,140 --> 00:40:48,308
each server will receive a piece of a

872
00:40:45,999 --> 00:40:50,589
packets so as long as they synchronize

873
00:40:48,309 --> 00:40:53,769
the communication and one can take care

874
00:40:50,589 --> 00:40:56,140
and assemble them this can easily scale

875
00:40:53,769 --> 00:40:58,479
in a distribute DNS file exfiltration

876
00:40:56,140 --> 00:41:00,069
now actually take me away the program

877
00:40:58,479 --> 00:41:01,689
like yeah there's only one destination

878
00:41:00,069 --> 00:41:05,288
IP so it's a bit suspicious even though

879
00:41:01,690 --> 00:41:08,829
it is 50 domains cloud automation I want

880
00:41:05,289 --> 00:41:11,319
to be able to push that to the cloud

881
00:41:08,829 --> 00:41:14,710
bring up the infrastructure of 50 VPS

882
00:41:11,319 --> 00:41:17,259
servers running the Mustang control run

883
00:41:14,710 --> 00:41:19,599
my infiltration three hours later

884
00:41:17,259 --> 00:41:20,890
take it down so I want to be able I

885
00:41:19,599 --> 00:41:22,779
don't want to be running this file is

886
00:41:20,890 --> 00:41:24,368
Philippe with the Chris amount of money

887
00:41:22,779 --> 00:41:25,749
but maybe I want to run into two or

888
00:41:24,369 --> 00:41:28,329
three hours when I expect rate things

889
00:41:25,749 --> 00:41:30,368
when I use it for only that specific so

890
00:41:28,329 --> 00:41:32,229
I want to clout to mention that's

891
00:41:30,369 --> 00:41:34,210
basically a way to actually you know

892
00:41:32,229 --> 00:41:36,368
scripting in a cloud to put on a deploy

893
00:41:34,210 --> 00:41:39,940
bring out the server's listening

894
00:41:36,369 --> 00:41:44,259
teardown and the last is the C&C manager

895
00:41:39,940 --> 00:41:46,210
so all this automation all these servers

896
00:41:44,259 --> 00:41:48,549
will be a slave but really wanna see a

897
00:41:46,210 --> 00:41:52,019
concert manager that will see which bit

898
00:41:48,549 --> 00:41:56,589
is killing each to synchronize it right

899
00:41:52,019 --> 00:41:59,649
so that will take me to my actually last

900
00:41:56,589 --> 00:42:02,710
bit which is your question conclusions

901
00:41:59,650 --> 00:42:06,900
right how do we prevent or detect this

902
00:42:02,710 --> 00:42:09,579
stuff well don't all DNS I simple

903
00:42:06,900 --> 00:42:11,050
unfortunately half of the world rely on

904
00:42:09,579 --> 00:42:13,450
DNA so

905
00:42:11,050 --> 00:42:17,350
is simple but very hard to sometimes

906
00:42:13,450 --> 00:42:19,810
implement so okay so we move into next

907
00:42:17,350 --> 00:42:22,089
things DNS sinkholes

908
00:42:19,810 --> 00:42:23,770
these are either appliance custom-made

909
00:42:22,090 --> 00:42:25,900
what you want to do is you're all your

910
00:42:23,770 --> 00:42:27,700
dinners DNS they don't have an answer

911
00:42:25,900 --> 00:42:31,420
come back to you so you want to analyze

912
00:42:27,700 --> 00:42:34,600
the locks why for this point DNS log

913
00:42:31,420 --> 00:42:38,440
analysis that will allow me to actually

914
00:42:34,600 --> 00:42:40,060
see patterns but it's difficult so one

915
00:42:38,440 --> 00:42:43,120
way to use this is called something

916
00:42:40,060 --> 00:42:45,549
called a entropy so entropy will give

917
00:42:43,120 --> 00:42:48,310
you from a query name we give you a

918
00:42:45,550 --> 00:42:50,470
category we'll give you a risk an

919
00:42:48,310 --> 00:42:53,470
indicator from 1 to 6 if you want to

920
00:42:50,470 --> 00:42:54,910
so google.com will give you a 5 the

921
00:42:53,470 --> 00:42:56,859
queries are used before I give you one

922
00:42:54,910 --> 00:43:00,460
point five so give you different numbers

923
00:42:56,860 --> 00:43:02,680
so doing enthalpy analytics in DNS locks

924
00:43:00,460 --> 00:43:04,840
is something that you can start to see

925
00:43:02,680 --> 00:43:07,509
behaviors and something strange going on

926
00:43:04,840 --> 00:43:08,860
so dice one and very smart people by the

927
00:43:07,510 --> 00:43:11,590
way you need the people don't forget

928
00:43:08,860 --> 00:43:14,140
about that one last thing you can use

929
00:43:11,590 --> 00:43:16,960
but Allison sometimes works is a less

930
00:43:14,140 --> 00:43:19,839
rely for the proxy or Internet side is

931
00:43:16,960 --> 00:43:22,450
DNS cloud providers like a umbrella or

932
00:43:19,840 --> 00:43:23,830
tough fair in the me like those they

933
00:43:22,450 --> 00:43:25,839
have the smart people on the stool

934
00:43:23,830 --> 00:43:28,299
building entropy analytics and locks to

935
00:43:25,840 --> 00:43:29,860
detect this kind of aware behavior so

936
00:43:28,300 --> 00:43:32,200
one thing I did mention I've even

937
00:43:29,860 --> 00:43:35,290
mentioned before where do I get 50

938
00:43:32,200 --> 00:43:39,220
domains or subdomains right well if you

939
00:43:35,290 --> 00:43:41,560
go to afraid or oh say free DNS provided

940
00:43:39,220 --> 00:43:44,919
you give you five you can choose from a

941
00:43:41,560 --> 00:43:47,740
list of domains that people put to share

942
00:43:44,920 --> 00:43:50,080
you can choose their five the subdomains

943
00:43:47,740 --> 00:43:53,109
and you have full control of a DNS

944
00:43:50,080 --> 00:43:55,920
server for those five domain however if

945
00:43:53,110 --> 00:43:58,720
you pay five dollars a month you get 100

946
00:43:55,920 --> 00:44:01,360
that you can choose so it's not really a

947
00:43:58,720 --> 00:44:03,490
big investment to have hundred already

948
00:44:01,360 --> 00:44:06,610
established domain that someone known

949
00:44:03,490 --> 00:44:08,109
that just delegate you a supplement as

950
00:44:06,610 --> 00:44:13,420
long as available the name right and

951
00:44:08,110 --> 00:44:14,980
neat we are 33 letters or longer so it's

952
00:44:13,420 --> 00:44:16,450
not that difficult because you go and

953
00:44:14,980 --> 00:44:18,310
register hundred domains first of all

954
00:44:16,450 --> 00:44:21,520
you need to pay them secondly they all

955
00:44:18,310 --> 00:44:24,610
specially very new so using this kind of

956
00:44:21,520 --> 00:44:26,770
existing domains allow you to

957
00:44:24,610 --> 00:44:28,510
well the main beam from 2008 you know

958
00:44:26,770 --> 00:44:31,720
someone else domains you just get a

959
00:44:28,510 --> 00:44:33,940
subdomain from it so it says I think

960
00:44:31,720 --> 00:44:39,850
it's a good method to use for five

961
00:44:33,940 --> 00:44:43,510
dollars so that will take me to the and

962
00:44:39,850 --> 00:44:45,460
I'm beginning of questionings open is it

963
00:44:43,510 --> 00:44:47,800
I think we are good in time yes we're

964
00:44:45,460 --> 00:44:49,630
doing great for time questions we have

965
00:44:47,800 --> 00:44:51,430
about twelve minutes before we have one

966
00:44:49,630 --> 00:44:55,120
second did I answer your question about

967
00:44:51,430 --> 00:44:58,180
prevention and okay yeah thank you okay

968
00:44:55,120 --> 00:45:21,000
so before I go to slide Oh any questions

969
00:44:58,180 --> 00:45:25,649
from yes ma'am oh this is not question

970
00:45:21,000 --> 00:45:29,790
wrong spelling CloudFlare prolly yeah

971
00:45:25,650 --> 00:45:33,790
because it can be taken as another DNS

972
00:45:29,790 --> 00:45:37,470
cloud fair yeah good point think okay so

973
00:45:33,790 --> 00:45:41,650
while I'm on this the real question is

974
00:45:37,470 --> 00:45:44,319
do you think CloudFlare will die if so

975
00:45:41,650 --> 00:45:47,560
how soon thank you

976
00:45:44,320 --> 00:45:53,470
I said philosophical question of

977
00:45:47,560 --> 00:45:56,080
political I don't know if you die is

978
00:45:53,470 --> 00:45:59,470
actually technical because I have been

979
00:45:56,080 --> 00:46:02,770
examining them for a period of time I

980
00:45:59,470 --> 00:46:04,419
will not voice my view okay I'm here to

981
00:46:02,770 --> 00:46:07,600
listen to you yes okay okay

982
00:46:04,420 --> 00:46:09,130
I'm not sure to be honest if they're

983
00:46:07,600 --> 00:46:11,980
going to die they probably will not tell

984
00:46:09,130 --> 00:46:15,190
us because there's action markets and

985
00:46:11,980 --> 00:46:18,010
you know cloudy and s is being used and

986
00:46:15,190 --> 00:46:19,450
that actually will probably match the

987
00:46:18,010 --> 00:46:21,100
first question someone is asking there

988
00:46:19,450 --> 00:46:24,310
as well I don't think they will die

989
00:46:21,100 --> 00:46:26,049
silently they may stock price start to

990
00:46:24,310 --> 00:46:27,910
go down the company close but somehow

991
00:46:26,050 --> 00:46:29,590
will take over less what is too much

992
00:46:27,910 --> 00:46:33,009
data they have already on too much

993
00:46:29,590 --> 00:46:36,640
services so unless they do really wrong

994
00:46:33,010 --> 00:46:37,960
things in business sides well anything

995
00:46:36,640 --> 00:46:41,348
that happened right internal

996
00:46:37,960 --> 00:46:43,390
but yeah it's more political question

997
00:46:41,349 --> 00:46:46,359
right I don't really have an answer for

998
00:46:43,390 --> 00:46:48,308
that side any more questions from the

999
00:46:46,359 --> 00:46:57,700
audience yes this gentleman on the third

1000
00:46:48,309 --> 00:46:59,710
row blue shirt so it looks like this

1001
00:46:57,700 --> 00:47:03,460
whole thing came up because you have a

1002
00:46:59,710 --> 00:47:05,200
need to evade the sock is that right do

1003
00:47:03,460 --> 00:47:05,920
you want to make your request look less

1004
00:47:05,200 --> 00:47:11,348
suspicious

1005
00:47:05,920 --> 00:47:13,930
exactly so recently TNS over HTTPS is

1006
00:47:11,349 --> 00:47:15,609
becoming a thing hopefully actually

1007
00:47:13,930 --> 00:47:18,490
supports it yeah

1008
00:47:15,609 --> 00:47:23,200
it allows you to make DNS requests over

1009
00:47:18,490 --> 00:47:24,879
a same is a post request yeah though

1010
00:47:23,200 --> 00:47:26,439
your tools support it because that would

1011
00:47:24,880 --> 00:47:27,880
definitely make things a lot easier and

1012
00:47:26,440 --> 00:47:31,180
the laws it would probably look like

1013
00:47:27,880 --> 00:47:33,339
it's just a request to cloud play yeah

1014
00:47:31,180 --> 00:47:35,640
this is a tricky part right because my

1015
00:47:33,339 --> 00:47:37,808
tool was designed to work from inside

1016
00:47:35,640 --> 00:47:40,808
infrastructure and enterprise network

1017
00:47:37,809 --> 00:47:43,809
right well I don't really have access to

1018
00:47:40,809 --> 00:47:46,990
the internet directly so for the DNS

1019
00:47:43,809 --> 00:47:48,819
over SSL or DNS over HTTP so whatever

1020
00:47:46,990 --> 00:47:52,029
you want a destitute that kind of size

1021
00:47:48,819 --> 00:47:54,250
so it's great great idea but enterprise

1022
00:47:52,030 --> 00:47:57,160
will not use it you will now allow

1023
00:47:54,250 --> 00:47:59,880
clients endpoints or pieces of servers

1024
00:47:57,160 --> 00:48:02,950
to directly talk to the internet

1025
00:47:59,880 --> 00:48:05,470
transfer DNS over because they actually

1026
00:48:02,950 --> 00:48:09,160
want to see what you're doing so that is

1027
00:48:05,470 --> 00:48:11,230
great for yourself privacy inside your

1028
00:48:09,160 --> 00:48:15,460
home your laptop your network before

1029
00:48:11,230 --> 00:48:18,400
enterprise no they what they may do is

1030
00:48:15,460 --> 00:48:20,140
they actually use that DNS the proxy or

1031
00:48:18,400 --> 00:48:22,329
the DNS server would need to query the

1032
00:48:20,140 --> 00:48:24,670
internet that communication that may use

1033
00:48:22,329 --> 00:48:26,680
SSL on it right which for my case

1034
00:48:24,670 --> 00:48:28,180
doesn't matter because that the

1035
00:48:26,680 --> 00:48:31,419
encrypted part will be between the

1036
00:48:28,180 --> 00:48:34,000
internal DNS and the cloudiness

1037
00:48:31,420 --> 00:48:36,549
however the cloudiness to me is that

1038
00:48:34,000 --> 00:48:38,890
there's not one to be SSL because my DNS

1039
00:48:36,549 --> 00:48:41,049
server is is the backward compatibility

1040
00:48:38,890 --> 00:48:42,970
problem right it's like you know your

1041
00:48:41,049 --> 00:48:45,520
DNS is like email

1042
00:48:42,970 --> 00:48:48,160
well you connect to port 25 then you ask

1043
00:48:45,520 --> 00:48:50,290
you wanna be a start as a cell but the

1044
00:48:48,160 --> 00:48:52,149
maybe the server doesn't support it so

1045
00:48:50,290 --> 00:48:54,670
you can choose not to cinemas

1046
00:48:52,150 --> 00:48:56,619
or just switched not encrypted so is

1047
00:48:54,670 --> 00:49:01,210
similar issue we have in DNS that we

1048
00:48:56,619 --> 00:49:03,069
have an SMTP so I did not test it with

1049
00:49:01,210 --> 00:49:04,660
actually directly because the problem

1050
00:49:03,069 --> 00:49:07,509
that I have there is actually the cloud

1051
00:49:04,660 --> 00:49:10,390
provider DNS which they probably will

1052
00:49:07,510 --> 00:49:11,950
realize what's going on with with or

1053
00:49:10,390 --> 00:49:15,220
without SSL side right there

1054
00:49:11,950 --> 00:49:17,649
but yeah it's mainly designed to be an

1055
00:49:15,220 --> 00:49:20,379
ensign enterprise network to push files

1056
00:49:17,650 --> 00:49:21,849
out in home networks but you have

1057
00:49:20,380 --> 00:49:25,059
already access to the Internet so you

1058
00:49:21,849 --> 00:49:27,430
can use any other simple SSL talents or

1059
00:49:25,059 --> 00:49:33,270
HTTPS is not really much filtering going

1060
00:49:27,430 --> 00:49:36,279
on in networks that don't close right

1061
00:49:33,270 --> 00:49:38,890
thanks okay thank you how about Amedeo

1062
00:49:36,279 --> 00:49:41,589
you take the top two uploaded questions

1063
00:49:38,890 --> 00:49:45,520
and then we can decide who will get it

1064
00:49:41,589 --> 00:49:48,038
one was sorry

1065
00:49:45,520 --> 00:49:52,210
yeah they're real anonymous so they

1066
00:49:48,039 --> 00:49:54,430
don't get prizes because they're upwards

1067
00:49:52,210 --> 00:49:58,270
worth answering most isn't a little

1068
00:49:54,430 --> 00:49:59,890
voice check sauce IP yes and refused me

1069
00:49:58,270 --> 00:50:02,740
that doesn't match of course this is

1070
00:49:59,890 --> 00:50:04,990
called part of a prefix in BGP to filter

1071
00:50:02,740 --> 00:50:06,669
that promote how the salsa yeah because

1072
00:50:04,990 --> 00:50:09,038
the source IP address is assigned to

1073
00:50:06,670 --> 00:50:11,380
work in a LAN in an enterprise network

1074
00:50:09,039 --> 00:50:13,569
inside your network is not assigned to

1075
00:50:11,380 --> 00:50:18,250
actually use poufiness to the internal

1076
00:50:13,569 --> 00:50:22,150
DNS remember in my slides some of them

1077
00:50:18,250 --> 00:50:24,670
show that it was de la on the lab you

1078
00:50:22,150 --> 00:50:26,920
will see writes an internal DNS going to

1079
00:50:24,670 --> 00:50:29,619
the Internet I'm not going directly

1080
00:50:26,920 --> 00:50:31,240
talking to the internet because of movie

1081
00:50:29,619 --> 00:50:32,650
will never work first of all probably I

1082
00:50:31,240 --> 00:50:34,089
don't have even nothin configured to

1083
00:50:32,650 --> 00:50:36,490
allow my PC to go to the Internet

1084
00:50:34,089 --> 00:50:38,650
however the internal DNS is a toilsome

1085
00:50:36,490 --> 00:50:40,270
maybe in a DM set as well it asked a

1086
00:50:38,650 --> 00:50:41,890
boxes to go to the Internet so I'm

1087
00:50:40,270 --> 00:50:44,440
taking this proofing technique from the

1088
00:50:41,890 --> 00:50:46,808
80s insulin because there's no

1089
00:50:44,440 --> 00:50:49,119
segmentation is online it's very we are

1090
00:50:46,809 --> 00:50:51,339
between DM cells sure between the red

1091
00:50:49,119 --> 00:50:54,339
and the green sure but within the green

1092
00:50:51,339 --> 00:50:56,500
area within your LAN is rather than

1093
00:50:54,339 --> 00:50:58,240
switching and spoofing it doesn't

1094
00:50:56,500 --> 00:51:00,369
prevent it can prevent it from routing

1095
00:50:58,240 --> 00:51:04,629
and switching spoofing because GDP

1096
00:51:00,369 --> 00:51:05,809
there's no TCP handshake so yes you will

1097
00:51:04,630 --> 00:51:08,749
not work directly spoofing

1098
00:51:05,809 --> 00:51:10,910
the internet is not designed for is to

1099
00:51:08,749 --> 00:51:11,390
spoof to the internal IP address of the

1100
00:51:10,910 --> 00:51:13,249
server

1101
00:51:11,390 --> 00:51:18,140
hopefully anonymous who say yeah thank

1102
00:51:13,249 --> 00:51:19,848
you okay and then the next one is this

1103
00:51:18,140 --> 00:51:24,288
method affected by DNS switching between

1104
00:51:19,849 --> 00:51:27,170
UDP and TCP mode no I'm only using UDP

1105
00:51:24,289 --> 00:51:29,359
mode the reason behind is basil because

1106
00:51:27,170 --> 00:51:32,329
you the piece you send a packet if you

1107
00:51:29,359 --> 00:51:33,920
go cause TCP is being blocked some time

1108
00:51:32,329 --> 00:51:37,069
some flowers will only allow you to DP

1109
00:51:33,920 --> 00:51:39,680
the TCP is normally tend to be used DNS

1110
00:51:37,069 --> 00:51:41,779
in TCP see that to syncing zones or when

1111
00:51:39,680 --> 00:51:44,479
they actually packet is too big so you

1112
00:51:41,779 --> 00:51:48,140
the protocol DNS will switch most of

1113
00:51:44,479 --> 00:51:50,930
fouls we probably block TCP 53 because

1114
00:51:48,140 --> 00:51:52,729
in reality DNS client should not be

1115
00:51:50,930 --> 00:51:54,948
using TCP unless you do in some

1116
00:51:52,729 --> 00:51:57,529
transferring so if you properly

1117
00:51:54,949 --> 00:51:58,789
configure follows TCP is no allow it you

1118
00:51:57,529 --> 00:52:02,150
should know allow it you should allow

1119
00:51:58,789 --> 00:52:03,469
only UDP for the reason of that I'm

1120
00:52:02,150 --> 00:52:04,759
gonna squeeze in the last question

1121
00:52:03,469 --> 00:52:06,140
because I'm very curious as well so

1122
00:52:04,759 --> 00:52:11,779
macaroni here is sir

1123
00:52:06,140 --> 00:52:13,939
I see powered unfortunately here I do

1124
00:52:11,779 --> 00:52:16,219
need this Singapore has a massive plugs

1125
00:52:13,939 --> 00:52:19,368
in Japan we have a very like a u.s. plug

1126
00:52:16,219 --> 00:52:20,509
so a power strip fit inside so the only

1127
00:52:19,369 --> 00:52:22,369
thing I needed a kiss from the power

1128
00:52:20,509 --> 00:52:25,160
strip one cable here I need to put a

1129
00:52:22,369 --> 00:52:29,349
massive power strip outside the box but

1130
00:52:25,160 --> 00:52:32,209
it's only 3 kilos and a half so it's

1131
00:52:29,349 --> 00:52:34,400
it's easy to port I will do it in whole

1132
00:52:32,209 --> 00:52:36,198
infrastructure in a case I use it for

1133
00:52:34,400 --> 00:52:37,939
different demo in a armory

1134
00:52:36,199 --> 00:52:39,709
this is same infrastructure I use it

1135
00:52:37,939 --> 00:52:40,449
just changed the servers they all

1136
00:52:39,709 --> 00:52:42,618
bankroll

1137
00:52:40,449 --> 00:52:45,229
it's just a bit difficult to go through

1138
00:52:42,619 --> 00:52:47,779
custom though yeah I can imagine

1139
00:52:45,229 --> 00:52:49,519
so ok so Amelia why don't you choose

1140
00:52:47,779 --> 00:52:52,900
your favorite question out of the three

1141
00:52:49,519 --> 00:52:52,899
questions that were asked from the floor

1142
00:52:53,109 --> 00:52:59,619
I have two favorite question yes once

1143
00:52:56,449 --> 00:53:04,400
was the first question yes I think she

1144
00:52:59,619 --> 00:53:06,890
third prize well done the other question

1145
00:53:04,400 --> 00:53:09,709
was say the gentleman in the shirt

1146
00:53:06,890 --> 00:53:13,089
I think you has a good point on the one

1147
00:53:09,709 --> 00:53:13,089
in the blue shirt all right wonderful

