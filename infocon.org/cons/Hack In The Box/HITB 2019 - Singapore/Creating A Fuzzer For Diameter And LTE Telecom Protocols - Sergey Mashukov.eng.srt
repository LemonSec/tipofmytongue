1
00:00:17,010 --> 00:00:25,710
so let's begin my name is Sergey mashkov

2
00:00:22,520 --> 00:00:33,989
this talk is called creating father for

3
00:00:25,710 --> 00:00:37,559
telecom Protocol 4G LTE case study so

4
00:00:33,989 --> 00:00:40,110
has been said work for positive

5
00:00:37,559 --> 00:00:44,430
technologies usually we do audits for

6
00:00:40,110 --> 00:00:46,860
mobile network operators all around the

7
00:00:44,430 --> 00:00:51,000
globe and we also create products to

8
00:00:46,860 --> 00:00:54,960
protect their networks so I perform the

9
00:00:51,000 --> 00:00:57,269
audit in my area of expertise and my

10
00:00:54,960 --> 00:01:00,719
area of expertise is the amateur

11
00:00:57,270 --> 00:01:04,949
protocol and to be more precise it's

12
00:01:00,719 --> 00:01:09,960
used as a signaling protocol in the 4G

13
00:01:04,949 --> 00:01:15,119
networks so what do I mean when I say

14
00:01:09,960 --> 00:01:17,190
signaling protocols you have when you're

15
00:01:15,119 --> 00:01:20,700
talking mobile networks you have two

16
00:01:17,190 --> 00:01:24,740
types of messages first user messages

17
00:01:20,700 --> 00:01:28,380
like your usual calls your data and

18
00:01:24,740 --> 00:01:33,208
messages that I needed to set this up to

19
00:01:28,380 --> 00:01:36,840
connect to users to set up data path and

20
00:01:33,209 --> 00:01:44,489
that signaling and that's interesting

21
00:01:36,840 --> 00:01:47,550
for many many reasons well here's a on

22
00:01:44,489 --> 00:01:52,500
this slide you can see results of work

23
00:01:47,550 --> 00:01:57,660
on SSL protocol signaling system number

24
00:01:52,500 --> 00:02:04,759
seven protocol suite it was created in

25
00:01:57,660 --> 00:02:11,550
70s and it shows it wasn't really looked

26
00:02:04,759 --> 00:02:14,930
deep into until like 2014 but in then we

27
00:02:11,550 --> 00:02:18,420
have a lot of wishes discovered like

28
00:02:14,930 --> 00:02:21,750
disclosure of identifiers and that

29
00:02:18,420 --> 00:02:27,089
allows manufacturer to get your location

30
00:02:21,750 --> 00:02:30,030
down to the cell to deny as a service

31
00:02:27,090 --> 00:02:33,360
for any subscriber

32
00:02:30,030 --> 00:02:38,400
so basically no phone coverage no calls

33
00:02:33,360 --> 00:02:45,030
no SMS no nothin and what's especially

34
00:02:38,400 --> 00:02:48,680
bad is SMS interception and spoofing you

35
00:02:45,030 --> 00:02:53,340
see nowadays everything is connected to

36
00:02:48,680 --> 00:02:58,260
SMS so if you want to register telegram

37
00:02:53,340 --> 00:03:01,980
or whatsapp if you have your Bitcoin

38
00:02:58,260 --> 00:03:06,720
ballot something like that it all goes

39
00:03:01,980 --> 00:03:10,290
to your mail and to do something with

40
00:03:06,720 --> 00:03:13,880
mail you can use SMS if you can

41
00:03:10,290 --> 00:03:16,890
intercept SMS you can do a lot actually

42
00:03:13,880 --> 00:03:22,350
there's been two different cases where

43
00:03:16,890 --> 00:03:28,250
banking fraud was used was done using it

44
00:03:22,350 --> 00:03:32,370
as a seven so manufactures first got

45
00:03:28,250 --> 00:03:35,269
like mobile banking passwords things

46
00:03:32,370 --> 00:03:40,200
like that and then they intercepted SMS

47
00:03:35,269 --> 00:03:44,100
and drained their accounts so two cases

48
00:03:40,200 --> 00:03:47,869
already of this in the wild and also

49
00:03:44,100 --> 00:03:51,209
call interception actually you can do it

50
00:03:47,870 --> 00:03:57,720
in ways that you intercept the call and

51
00:03:51,209 --> 00:04:02,370
wrote it back to the guy you had to talk

52
00:03:57,720 --> 00:04:05,340
with so you can listen what's happening

53
00:04:02,370 --> 00:04:08,910
and it would be discreet

54
00:04:05,340 --> 00:04:11,010
so okay that's a seven that's 2g 3G

55
00:04:08,910 --> 00:04:17,070
technology in 4G it should be better

56
00:04:11,010 --> 00:04:22,650
right well not necessarily the answer is

57
00:04:17,070 --> 00:04:29,700
used in 4G and 5g non send along until a

58
00:04:22,650 --> 00:04:33,000
new network core is created and it has

59
00:04:29,700 --> 00:04:35,190
the same groups of issues problems with

60
00:04:33,000 --> 00:04:37,710
interception of as a mass we strike

61
00:04:35,190 --> 00:04:40,590
enough subscribers denial of service in

62
00:04:37,710 --> 00:04:43,859
ourselves on network equipment and fraud

63
00:04:40,590 --> 00:04:47,489
but since we are talking about fashion

64
00:04:43,860 --> 00:04:49,440
and now most cases we will see some

65
00:04:47,490 --> 00:04:54,870
problems we used in our service on

66
00:04:49,440 --> 00:05:05,070
network equipment that's what we get by

67
00:04:54,870 --> 00:05:08,820
fashion anyway so what should I say

68
00:05:05,070 --> 00:05:13,920
about enter it's wasn't created

69
00:05:08,820 --> 00:05:18,930
specifically for mobile networks or any

70
00:05:13,920 --> 00:05:28,020
other telephone networks it is actually

71
00:05:18,930 --> 00:05:32,700
a work on a protocol called radius you

72
00:05:28,020 --> 00:05:35,900
see it has some flaws it wasn't really

73
00:05:32,700 --> 00:05:42,180
extensible and gas decided let's do

74
00:05:35,900 --> 00:05:45,060
radius plus radius Center and it's much

75
00:05:42,180 --> 00:05:48,570
better in this field but it wasn't

76
00:05:45,060 --> 00:05:52,950
created specifically for bond networks

77
00:05:48,570 --> 00:05:55,800
and it has its own quirks that are not

78
00:05:52,950 --> 00:05:58,349
really suitable for such networks for

79
00:05:55,800 --> 00:06:02,870
example it's it really is spoofing

80
00:05:58,350 --> 00:06:05,100
friendly so you can send a request and

81
00:06:02,870 --> 00:06:08,970
answer will go the same way

82
00:06:05,100 --> 00:06:11,070
request game so you can spoof anyone and

83
00:06:08,970 --> 00:06:14,280
still have the answer and that's what

84
00:06:11,070 --> 00:06:19,800
enables like location disclosure and

85
00:06:14,280 --> 00:06:23,760
main cases so as I said it's session

86
00:06:19,800 --> 00:06:26,940
layer authentication authorization and

87
00:06:23,760 --> 00:06:29,940
accounting protocol it's pretext it

88
00:06:26,940 --> 00:06:35,160
works of IP because that's what 3gpp

89
00:06:29,940 --> 00:06:38,460
needed for LTE which is all IP it

90
00:06:35,160 --> 00:06:43,100
supports a CTP Ortiz B but a CTP is used

91
00:06:38,460 --> 00:06:45,840
in telecom context almost always

92
00:06:43,100 --> 00:06:51,170
interesting interestingly enough it has

93
00:06:45,840 --> 00:06:53,260
IPSec or TLS DTLS for encryption as a

94
00:06:51,170 --> 00:06:57,160
mandatory part

95
00:06:53,260 --> 00:07:00,070
and to be honest I've never seen IPSec

96
00:06:57,160 --> 00:07:03,390
used inside of the operator networks so

97
00:07:00,070 --> 00:07:07,120
okay it is mandatory but it's not used

98
00:07:03,390 --> 00:07:10,510
it it may be used between operators or

99
00:07:07,120 --> 00:07:15,160
between intro cried our interpreter

100
00:07:10,510 --> 00:07:19,450
Network but that's what we get and again

101
00:07:15,160 --> 00:07:22,150
it's extensible it has like one RFC we

102
00:07:19,450 --> 00:07:25,150
used an through base handling connection

103
00:07:22,150 --> 00:07:27,340
between peers disconnection watchdog

104
00:07:25,150 --> 00:07:30,099
things like that and you have

105
00:07:27,340 --> 00:07:32,349
applications on top with all kind of

106
00:07:30,100 --> 00:07:38,820
application but we are most interested

107
00:07:32,350 --> 00:07:43,030
interested in ones created by 3gpp so

108
00:07:38,820 --> 00:07:47,800
again extensibility is kind of weak part

109
00:07:43,030 --> 00:07:52,919
of the eMeter just because any part of

110
00:07:47,800 --> 00:07:55,780
the message and any message has this

111
00:07:52,920 --> 00:07:59,740
part in definition where okay its

112
00:07:55,780 --> 00:08:03,640
message here information elements that

113
00:07:59,740 --> 00:08:05,650
you include there and here is any number

114
00:08:03,640 --> 00:08:09,159
of any information elements that you can

115
00:08:05,650 --> 00:08:11,349
add the same for the information

116
00:08:09,160 --> 00:08:13,870
elements themselves is they contain

117
00:08:11,350 --> 00:08:18,400
other information elements so basically

118
00:08:13,870 --> 00:08:21,010
you can add anything by the protocol you

119
00:08:18,400 --> 00:08:26,380
can combat these this is done

120
00:08:21,010 --> 00:08:28,930
specifically for extensibility yes

121
00:08:26,380 --> 00:08:32,349
aminals can do something with it can do

122
00:08:28,930 --> 00:08:37,150
checks but this done to have new version

123
00:08:32,349 --> 00:08:40,300
of protocols without doing changes on

124
00:08:37,150 --> 00:08:44,350
all the ones so it it's keep it's

125
00:08:40,299 --> 00:08:48,579
keeping it works there are no into

126
00:08:44,350 --> 00:08:52,360
working problems so here you can see the

127
00:08:48,580 --> 00:08:56,350
enter header you have your version which

128
00:08:52,360 --> 00:08:59,560
haven't changed since the beginning it

129
00:08:56,350 --> 00:09:03,670
have message laughs common flags like

130
00:08:59,560 --> 00:09:05,339
eases request to answer or eases assent

131
00:09:03,670 --> 00:09:07,529
due to an error

132
00:09:05,339 --> 00:09:09,990
and have common code basically which

133
00:09:07,529 --> 00:09:12,660
message cities you have application ID

134
00:09:09,990 --> 00:09:14,910
on which application you have some

135
00:09:12,660 --> 00:09:17,819
identifiers that I needed for routing

136
00:09:14,910 --> 00:09:20,569
and then after this header you have a

137
00:09:17,819 --> 00:09:25,769
number of a VDS attribute value pairs

138
00:09:20,569 --> 00:09:31,680
and those have their own called their

139
00:09:25,769 --> 00:09:35,100
Flags lands and not is this the single

140
00:09:31,680 --> 00:09:42,120
optional filtering headers vendor ID so

141
00:09:35,100 --> 00:09:44,670
if we beat is set this one is it should

142
00:09:42,120 --> 00:09:48,990
be there and if it's not it should not

143
00:09:44,670 --> 00:09:52,079
be let have the data many different

144
00:09:48,990 --> 00:09:59,009
kinds data possible usually it's like

145
00:09:52,079 --> 00:10:02,430
strings or for example integers or

146
00:09:59,009 --> 00:10:05,639
different kinds but also a bps can

147
00:10:02,430 --> 00:10:10,109
contain other VP's so you have nested

148
00:10:05,639 --> 00:10:13,529
structure and it may also be used in

149
00:10:10,110 --> 00:10:15,350
fasten so that's what we have a basic

150
00:10:13,529 --> 00:10:18,240
message structure for files and and

151
00:10:15,350 --> 00:10:23,730
that's what we need to know to start

152
00:10:18,240 --> 00:10:28,019
doing it let's see where it is used now

153
00:10:23,730 --> 00:10:33,689
in for gelt well basically everything in

154
00:10:28,019 --> 00:10:37,680
rats is banter so you have your user

155
00:10:33,689 --> 00:10:40,800
data path and you have signaling in the

156
00:10:37,680 --> 00:10:45,120
core and most important most interesting

157
00:10:40,800 --> 00:10:48,179
nodes for malefactor here are HSS home

158
00:10:45,120 --> 00:10:51,629
subscriber server containing all the

159
00:10:48,179 --> 00:10:55,579
information about subscriber and enemy

160
00:10:51,629 --> 00:10:59,129
mobility management and t/o which is

161
00:10:55,579 --> 00:11:02,248
which basically governs mobility of user

162
00:10:59,129 --> 00:11:06,240
you know these base stations are

163
00:11:02,249 --> 00:11:08,490
connected to mmm is usually like two or

164
00:11:06,240 --> 00:11:12,959
three mmm ease in a major cities things

165
00:11:08,490 --> 00:11:16,439
like that so why this is interesting

166
00:11:12,959 --> 00:11:18,498
because these interface s-six a

167
00:11:16,439 --> 00:11:23,738
interface that connects them

168
00:11:18,499 --> 00:11:26,799
should be accessible in the between

169
00:11:23,739 --> 00:11:30,529
operators in the interpreter network

170
00:11:26,799 --> 00:11:33,379
because if your own in Singapore for

171
00:11:30,529 --> 00:11:35,569
example in any other country you need to

172
00:11:33,379 --> 00:11:38,959
connect to the base station and then you

173
00:11:35,569 --> 00:11:41,660
need to connect to Mme in that country

174
00:11:38,959 --> 00:11:45,108
but all your data all your keys

175
00:11:41,660 --> 00:11:50,238
everything is stored in HSS in the in

176
00:11:45,109 --> 00:11:54,069
your home country so this part is over

177
00:11:50,239 --> 00:11:58,399
some inter operator Network right

178
00:11:54,069 --> 00:12:03,858
so with this away let's talk about

179
00:11:58,399 --> 00:12:07,579
Fallon so you can read definition in

180
00:12:03,859 --> 00:12:12,109
Wikipedia but you can also see what this

181
00:12:07,579 --> 00:12:15,410
means in Wireshark here you can see a VP

182
00:12:12,109 --> 00:12:20,709
code one known for some reason if the

183
00:12:15,410 --> 00:12:24,649
code one is username in 3gpp in mobile

184
00:12:20,709 --> 00:12:28,579
system it's usually in Z of subscriber

185
00:12:24,649 --> 00:12:32,239
but for some reason vendor ID is known

186
00:12:28,579 --> 00:12:34,849
and yeah it is a known because I've set

187
00:12:32,239 --> 00:12:39,919
it to some strange value and that's what

188
00:12:34,850 --> 00:12:46,100
you get in the face and you get some but

189
00:12:39,919 --> 00:12:48,649
altitude so if you read the description

190
00:12:46,100 --> 00:12:51,559
there are two things that you really

191
00:12:48,649 --> 00:12:54,589
need you need software to perform the

192
00:12:51,559 --> 00:12:56,499
testing and you also need a way to check

193
00:12:54,589 --> 00:13:00,049
and interpret the results you may have

194
00:12:56,499 --> 00:13:06,019
BES Affairs there is if you can't see

195
00:13:00,049 --> 00:13:07,519
the results it's meaningless and why am

196
00:13:06,019 --> 00:13:11,829
I talking about

197
00:13:07,519 --> 00:13:16,129
that because you see usually it's a

198
00:13:11,829 --> 00:13:19,488
menos that approached us to do the test

199
00:13:16,129 --> 00:13:22,369
in not vendors so okay we are doing this

200
00:13:19,489 --> 00:13:24,709
on and off site but my belief is that

201
00:13:22,369 --> 00:13:30,799
normally this should be done by the

202
00:13:24,709 --> 00:13:32,709
vendors and hmm and it's done by the

203
00:13:30,799 --> 00:13:36,500
windows actually

204
00:13:32,710 --> 00:13:39,260
if you check my buyer you've seen that I

205
00:13:36,500 --> 00:13:43,270
worked for one for quite some time and

206
00:13:39,260 --> 00:13:47,540
yeah we had father bought it was

207
00:13:43,270 --> 00:13:51,860
specifically created telecom father

208
00:13:47,540 --> 00:13:56,449
everything is OK but there is a slight

209
00:13:51,860 --> 00:13:59,060
problem with these problems that were

210
00:13:56,450 --> 00:13:59,960
found during fasten will not top

211
00:13:59,060 --> 00:14:03,890
priority

212
00:13:59,960 --> 00:14:08,600
like not top priority at all so yes they

213
00:14:03,890 --> 00:14:13,760
were fixed but it was a chore for the

214
00:14:08,600 --> 00:14:18,470
developers and it was usually like the

215
00:14:13,760 --> 00:14:21,740
last thing they did there's also this

216
00:14:18,470 --> 00:14:24,050
big problem of walled garden in the

217
00:14:21,740 --> 00:14:26,960
telecom industry where there is no

218
00:14:24,050 --> 00:14:30,650
access to hardware or code ok

219
00:14:26,960 --> 00:14:34,120
some researchers might have access there

220
00:14:30,650 --> 00:14:37,880
are partnerships between aminals and

221
00:14:34,120 --> 00:14:45,590
researchers but again eminence not

222
00:14:37,880 --> 00:14:50,990
vendors and a result is Dropbox in the

223
00:14:45,590 --> 00:14:53,150
cold and in practice we found that more

224
00:14:50,990 --> 00:14:56,840
than half of tested equipment has some

225
00:14:53,150 --> 00:15:02,300
vulnerabilities if we count each single

226
00:14:56,840 --> 00:15:05,210
node it's about like 2/3 of them has

227
00:15:02,300 --> 00:15:08,979
something but you need to understand

228
00:15:05,210 --> 00:15:16,190
this sink while bugs may lead to serious

229
00:15:08,980 --> 00:15:20,090
consequences it's and not every bug is a

230
00:15:16,190 --> 00:15:24,350
security issue so we are dealing with

231
00:15:20,090 --> 00:15:27,620
this big telecom clusters oK you've sent

232
00:15:24,350 --> 00:15:31,340
malicious output you see is a crash in

233
00:15:27,620 --> 00:15:34,310
the logs fine but what is the actual

234
00:15:31,340 --> 00:15:40,760
result for EM no what is actual result

235
00:15:34,310 --> 00:15:43,280
for the subscriber because usually this

236
00:15:40,760 --> 00:15:44,689
process we will be restarted on another

237
00:15:43,280 --> 00:15:49,180
processor not

238
00:15:44,690 --> 00:15:53,710
happens so we need to really check

239
00:15:49,180 --> 00:15:57,920
what's happening in the system but

240
00:15:53,710 --> 00:16:01,340
talking about box and fasten another

241
00:15:57,920 --> 00:16:06,530
thing everyone says okay fasten is

242
00:16:01,340 --> 00:16:09,140
malformed yes no sometimes even

243
00:16:06,530 --> 00:16:11,510
correctly formed messages may cause the

244
00:16:09,140 --> 00:16:15,710
same results which was the case for

245
00:16:11,510 --> 00:16:20,420
Telenor quite large operator they had

246
00:16:15,710 --> 00:16:23,630
old age for like three and a half hours

247
00:16:20,420 --> 00:16:27,199
and I guess they had a lot of fines

248
00:16:23,630 --> 00:16:31,310
after that wasn't 1 million subscribers

249
00:16:27,200 --> 00:16:33,860
was affected no service at all and the

250
00:16:31,310 --> 00:16:36,500
reason for that is testing in some other

251
00:16:33,860 --> 00:16:40,760
network the messages were sent by

252
00:16:36,500 --> 00:16:44,690
mistake to the network and the Achille

253
00:16:40,760 --> 00:16:47,960
are basically saying that base as HSS in

254
00:16:44,690 --> 00:16:55,600
2g 3g just went down and it was

255
00:16:47,960 --> 00:16:58,790
rebooting secretly in a cycle so ok

256
00:16:55,600 --> 00:17:04,390
could they find this by fastened

257
00:16:58,790 --> 00:17:08,899
possibly but they didn't vendor didn't

258
00:17:04,390 --> 00:17:12,709
vendors didn't did that job and also

259
00:17:08,900 --> 00:17:16,160
since we are talking about process

260
00:17:12,709 --> 00:17:20,089
crashes there's also an option of

261
00:17:16,160 --> 00:17:22,640
finding RC e on the host and it's quite

262
00:17:20,089 --> 00:17:28,909
scary some security researchers showed

263
00:17:22,640 --> 00:17:31,370
that it is possible but for real

264
00:17:28,910 --> 00:17:35,120
malefactor it's kind of hard to do

265
00:17:31,370 --> 00:17:37,909
because it's kinda hard to get the

266
00:17:35,120 --> 00:17:39,800
binary for example everything in the

267
00:17:37,910 --> 00:17:44,480
network all you do it through the

268
00:17:39,800 --> 00:17:47,590
network but again if this is successful

269
00:17:44,480 --> 00:17:50,960
you can take over one of the nodes and

270
00:17:47,590 --> 00:17:52,760
then use these to spy on other

271
00:17:50,960 --> 00:17:54,430
subscribers or bring down the whole

272
00:17:52,760 --> 00:17:59,580
network

273
00:17:54,430 --> 00:18:02,650
so better set there are three different

274
00:17:59,580 --> 00:18:05,169
ways to test you can do this in vendor

275
00:18:02,650 --> 00:18:08,530
slap you can do in operator slap or in

276
00:18:05,170 --> 00:18:12,520
the live Network and what we usually do

277
00:18:08,530 --> 00:18:15,240
is operator slab no to enter slab

278
00:18:12,520 --> 00:18:18,309
unfortunately

279
00:18:15,240 --> 00:18:21,850
okay there's option of live network but

280
00:18:18,309 --> 00:18:24,309
as we've seen we still in our case it

281
00:18:21,850 --> 00:18:28,120
might be not the brightest idea to do

282
00:18:24,309 --> 00:18:32,139
fasten them however you should always

283
00:18:28,120 --> 00:18:35,590
remember that test lab is usually so

284
00:18:32,140 --> 00:18:39,610
much different from as actual networks

285
00:18:35,590 --> 00:18:42,610
that you need to actively ask a menos to

286
00:18:39,610 --> 00:18:46,389
change something usually non-standard

287
00:18:42,610 --> 00:18:49,959
identifiers used routing is different

288
00:18:46,390 --> 00:18:53,260
because usually in the networks they

289
00:18:49,960 --> 00:18:55,690
have like a single note and it

290
00:18:53,260 --> 00:19:01,120
connection and they don't create the

291
00:18:55,690 --> 00:19:03,970
whole score in the test lab maybe they

292
00:19:01,120 --> 00:19:08,260
do this sometimes but usually they do

293
00:19:03,970 --> 00:19:15,390
test on a single note and this this

294
00:19:08,260 --> 00:19:18,309
works quite different so fasten and

295
00:19:15,390 --> 00:19:23,080
found problems there is a recent case

296
00:19:18,309 --> 00:19:26,290
where guys tried to do fastened from the

297
00:19:23,080 --> 00:19:29,350
base station side there's no damper here

298
00:19:26,290 --> 00:19:32,020
so that's not what interesting for me

299
00:19:29,350 --> 00:19:36,340
but this shows that the plenty of fish

300
00:19:32,020 --> 00:19:41,460
in the sea you can find a lot of

301
00:19:36,340 --> 00:19:44,409
Fisher's and again guys from Korean

302
00:19:41,460 --> 00:19:47,020
Korea advanced Institute of Science and

303
00:19:44,410 --> 00:19:51,420
Technology cast as AE created their own

304
00:19:47,020 --> 00:19:58,300
father for that it's not that hard to do

305
00:19:51,420 --> 00:20:03,340
so two things to note again problems may

306
00:19:58,300 --> 00:20:05,560
be overlooked and you also need to keep

307
00:20:03,340 --> 00:20:07,639
in mind that not all problems that you

308
00:20:05,560 --> 00:20:14,250
find during files and maybe

309
00:20:07,640 --> 00:20:18,090
exploitable in the wild so how we can

310
00:20:14,250 --> 00:20:20,520
use the ammeter realistically how

311
00:20:18,090 --> 00:20:27,350
manufacture rather can use them

312
00:20:20,520 --> 00:20:33,570
realistically most probably IPX

313
00:20:27,350 --> 00:20:38,459
Network should be used for that I Peaks

314
00:20:33,570 --> 00:20:40,860
is a network between all the operators

315
00:20:38,460 --> 00:20:43,140
in the world so if you have connection

316
00:20:40,860 --> 00:20:46,649
to it you have connection to any

317
00:20:43,140 --> 00:20:49,770
operator and the scary part is that you

318
00:20:46,650 --> 00:20:54,660
can buy access to IPS right now we have

319
00:20:49,770 --> 00:20:57,950
our own access for audit service and if

320
00:20:54,660 --> 00:21:01,500
we as a company have it I don't see why

321
00:20:57,950 --> 00:21:07,280
any other company or individual can buy

322
00:21:01,500 --> 00:21:10,950
it one more thing to note though with

323
00:21:07,280 --> 00:21:14,750
diameter and D it also means that your

324
00:21:10,950 --> 00:21:19,530
targets like HSS enemy I behind is the

325
00:21:14,750 --> 00:21:23,330
DEA so you need to send the message

326
00:21:19,530 --> 00:21:30,510
first de and then it will be routed and

327
00:21:23,330 --> 00:21:35,129
many malicious messages will not go

328
00:21:30,510 --> 00:21:37,860
through just because pass on D will say

329
00:21:35,130 --> 00:21:39,900
ok is that something strange is

330
00:21:37,860 --> 00:21:44,370
happening and drop the message so you

331
00:21:39,900 --> 00:21:51,090
need to check for that as well so as I

332
00:21:44,370 --> 00:21:53,639
said D tensor EIJ agent is router one

333
00:21:51,090 --> 00:21:58,409
interesting thing about it it can wrote

334
00:21:53,640 --> 00:22:01,400
internal traffic and due to these it may

335
00:21:58,410 --> 00:22:08,130
present a single point of failure where

336
00:22:01,400 --> 00:22:10,200
disabling D GA itself leads to the whole

337
00:22:08,130 --> 00:22:11,850
network being unresponsive because

338
00:22:10,200 --> 00:22:14,810
there's no connection between internal

339
00:22:11,850 --> 00:22:19,040
enemies and H says for example

340
00:22:14,810 --> 00:22:21,649
so yeah a practice shows that there are

341
00:22:19,040 --> 00:22:27,170
some problems with GE and one of them is

342
00:22:21,650 --> 00:22:30,710
at the ease of some vendor just plainly

343
00:22:27,170 --> 00:22:38,050
ignore configuration in this case the

344
00:22:30,710 --> 00:22:41,120
walls supporting only as 6e attitude

345
00:22:38,050 --> 00:22:45,200
when connected to this I Peaks Network

346
00:22:41,120 --> 00:22:48,139
but for some reason each sent it rotate

347
00:22:45,200 --> 00:22:51,830
any message that is supported inside the

348
00:22:48,140 --> 00:22:59,210
operators Network actually changed the

349
00:22:51,830 --> 00:23:01,639
messages just to do not show actual you

350
00:22:59,210 --> 00:23:07,520
should because I'm not quite sure that

351
00:23:01,640 --> 00:23:12,260
it's still fixed why this may be a

352
00:23:07,520 --> 00:23:17,330
problem well because you can attack HSS

353
00:23:12,260 --> 00:23:21,940
and yes we did find an attack that can

354
00:23:17,330 --> 00:23:24,260
drop them connection between de and HSS

355
00:23:21,940 --> 00:23:27,890
manufacturer needs to send a burst

356
00:23:24,260 --> 00:23:30,260
messages forces and we actually checked

357
00:23:27,890 --> 00:23:33,530
can we do this through da because that's

358
00:23:30,260 --> 00:23:37,040
not font right and yeah we can do this

359
00:23:33,530 --> 00:23:44,360
and this means that we can manufacture

360
00:23:37,040 --> 00:23:48,370
can use this through the IPS the problem

361
00:23:44,360 --> 00:23:50,719
for manufacture is that not all

362
00:23:48,370 --> 00:23:55,540
intermediaries in high peaks will wrote

363
00:23:50,720 --> 00:24:00,260
this six message so you need some luck

364
00:23:55,540 --> 00:24:08,110
to sent message to SD which is not Essex

365
00:24:00,260 --> 00:24:12,770
a so okay my mind said I want to create

366
00:24:08,110 --> 00:24:14,810
I want to pass my a man own network for

367
00:24:12,770 --> 00:24:17,090
example what do I need for that I need a

368
00:24:14,810 --> 00:24:22,220
father why do I need a separate father

369
00:24:17,090 --> 00:24:24,919
for that first why can't I use existing

370
00:24:22,220 --> 00:24:27,170
technology first of all you need to

371
00:24:24,920 --> 00:24:30,800
communicate through network

372
00:24:27,170 --> 00:24:35,170
and for this you need like working

373
00:24:30,800 --> 00:24:39,409
diameter stack usually you have specific

374
00:24:35,170 --> 00:24:43,640
structure and if you just fast message

375
00:24:39,410 --> 00:24:48,500
without regards to the stretch most of

376
00:24:43,640 --> 00:24:53,930
your files and will go to waste and of

377
00:24:48,500 --> 00:24:57,010
course one upside of creating your own

378
00:24:53,930 --> 00:25:03,650
father you can adapt it to whatever

379
00:24:57,010 --> 00:25:08,000
problems you have on side also I might

380
00:25:03,650 --> 00:25:10,970
say that if money is a concern for you

381
00:25:08,000 --> 00:25:13,610
and you don't want to buy like expensive

382
00:25:10,970 --> 00:25:17,990
father for something that you do not so

383
00:25:13,610 --> 00:25:24,699
often it quite easy to create one if you

384
00:25:17,990 --> 00:25:32,330
can program a little bit so that's why

385
00:25:24,700 --> 00:25:34,340
doing it father's now I can use existing

386
00:25:32,330 --> 00:25:38,020
protocol implementations right well

387
00:25:34,340 --> 00:25:40,600
usually not and the problems come with

388
00:25:38,020 --> 00:25:44,170
creating malformed messages because

389
00:25:40,600 --> 00:25:47,419
these implementations are programmed to

390
00:25:44,170 --> 00:25:51,500
create correctly formed messages in

391
00:25:47,420 --> 00:25:54,970
correct order and usually there are some

392
00:25:51,500 --> 00:25:57,620
problems with when you are dealing we on

393
00:25:54,970 --> 00:26:00,230
wisdoms base level like connection

394
00:25:57,620 --> 00:26:03,760
establishment answers if you need to

395
00:26:00,230 --> 00:26:05,930
test those you need to have your own

396
00:26:03,760 --> 00:26:10,160
implementation or at least the ones that

397
00:26:05,930 --> 00:26:13,280
supports like sending arbitrary messages

398
00:26:10,160 --> 00:26:19,000
on arbitrary method in response to

399
00:26:13,280 --> 00:26:22,490
arbitrary messages I also serve points

400
00:26:19,000 --> 00:26:25,220
about them through protocol there are

401
00:26:22,490 --> 00:26:30,470
two kinds of messages there ronk from

402
00:26:25,220 --> 00:26:36,800
encoding perspective like this wrong AVP

403
00:26:30,470 --> 00:26:39,200
this which has very long clamp for some

404
00:26:36,800 --> 00:26:41,530
reason all wrong from semantics

405
00:26:39,200 --> 00:26:44,240
perspective for example

406
00:26:41,530 --> 00:26:47,149
insert subscriber data message should

407
00:26:44,240 --> 00:26:49,010
have only one username identity

408
00:26:47,150 --> 00:26:55,820
there are three of those in this message

409
00:26:49,010 --> 00:26:58,610
and that's all for problem so to do the

410
00:26:55,820 --> 00:27:00,530
testing you need messages that are

411
00:26:58,610 --> 00:27:04,459
someone similar to real ones and for

412
00:27:00,530 --> 00:27:08,450
this you can ask operator to provide

413
00:27:04,460 --> 00:27:11,120
this messages and one thing to always

414
00:27:08,450 --> 00:27:13,520
remember it's not enough to say a

415
00:27:11,120 --> 00:27:18,520
gatecrash you need to isolate the

416
00:27:13,520 --> 00:27:27,920
problem a solution to this is good old

417
00:27:18,520 --> 00:27:31,100
mutational if I think so one thing to

418
00:27:27,920 --> 00:27:34,010
note is that you would need not only

419
00:27:31,100 --> 00:27:37,610
messages but messages filled with

420
00:27:34,010 --> 00:27:40,520
correct identities so usually you

421
00:27:37,610 --> 00:27:45,050
prepare your messages before sending

422
00:27:40,520 --> 00:27:48,379
them so what kind of limitations we used

423
00:27:45,050 --> 00:27:53,930
we used random bit flips in headers and

424
00:27:48,380 --> 00:27:57,050
we use pre preset values for random bit

425
00:27:53,930 --> 00:28:00,710
flips it may be like going through all

426
00:27:57,050 --> 00:28:06,770
the beats at once or and then flip in

427
00:28:00,710 --> 00:28:10,900
all beats at random several times when

428
00:28:06,770 --> 00:28:13,670
we are working we use a VP values since

429
00:28:10,900 --> 00:28:19,910
every piece may be of different lengths

430
00:28:13,670 --> 00:28:23,260
you can do random pants removals and you

431
00:28:19,910 --> 00:28:28,690
also may change structure of a VPS like

432
00:28:23,260 --> 00:28:31,940
with this or username a VPS there and

433
00:28:28,690 --> 00:28:36,110
yes surprisingly such simple fast works

434
00:28:31,940 --> 00:28:41,690
on real equipment here we tested enemy

435
00:28:36,110 --> 00:28:44,030
and it's really interesting problem

436
00:28:41,690 --> 00:28:47,150
because as i said when you send

437
00:28:44,030 --> 00:28:49,520
malformed message to the node it's a big

438
00:28:47,150 --> 00:28:52,580
cluster a lot of protesters brought us

439
00:28:49,520 --> 00:28:53,520
crash it goes up everything back to

440
00:28:52,580 --> 00:28:56,310
normal

441
00:28:53,520 --> 00:28:59,760
problem here that if you persist in

442
00:28:56,310 --> 00:29:02,070
sending these malformed messages and you

443
00:28:59,760 --> 00:29:05,430
don't need a lot of time it's like two

444
00:29:02,070 --> 00:29:11,040
or three seconds and bursts of like 100

445
00:29:05,430 --> 00:29:13,980
to 500 maybe messages the note will

446
00:29:11,040 --> 00:29:15,780
escalate the problem so it was created

447
00:29:13,980 --> 00:29:18,660
for upgrades and things like that

448
00:29:15,780 --> 00:29:22,560
probably so when something goes wrong

449
00:29:18,660 --> 00:29:25,920
during upgrades not will reboot first

450
00:29:22,560 --> 00:29:31,050
process than process or hire her her her

451
00:29:25,920 --> 00:29:34,860
until the whole notes reboots so in this

452
00:29:31,050 --> 00:29:39,870
case recovery mechanism works against

453
00:29:34,860 --> 00:29:41,189
the security and the reason for the

454
00:29:39,870 --> 00:29:45,419
issue is this

455
00:29:41,190 --> 00:29:51,710
we beat which have been said for some

456
00:29:45,420 --> 00:29:51,710
EVPs we shouldn't have it set so

457
00:29:52,940 --> 00:30:01,440
probably that led to a parser trying to

458
00:29:57,090 --> 00:30:11,310
read more beads than it should and here

459
00:30:01,440 --> 00:30:16,830
we go process crash so now I'm going to

460
00:30:11,310 --> 00:30:20,730
talk about several interesting parts

461
00:30:16,830 --> 00:30:24,780
that I've seen while creating as a

462
00:30:20,730 --> 00:30:29,490
father and one of them is actually

463
00:30:24,780 --> 00:30:32,550
dealing with a menos because you have to

464
00:30:29,490 --> 00:30:34,910
adapt the father for and know because

465
00:30:32,550 --> 00:30:38,399
test lab for some reason may be

466
00:30:34,910 --> 00:30:41,700
connected to international network and

467
00:30:38,400 --> 00:30:46,980
again you don't want to do something

468
00:30:41,700 --> 00:30:50,460
like what happened we Stellan or there's

469
00:30:46,980 --> 00:30:53,550
a problem is purely on administrative

470
00:30:50,460 --> 00:30:58,230
levels test lab is always booked it is

471
00:30:53,550 --> 00:31:01,470
always used for us tests and well you

472
00:30:58,230 --> 00:31:04,490
come from with the security guys they

473
00:31:01,470 --> 00:31:07,040
say ok we are gonna do fasten everything

474
00:31:04,490 --> 00:31:10,520
we'll be all right and gas handling labs

475
00:31:07,040 --> 00:31:13,450
just say no we can give you two no no

476
00:31:10,520 --> 00:31:16,610
you have to work tonight

477
00:31:13,450 --> 00:31:17,710
no we have tests please don't touch

478
00:31:16,610 --> 00:31:23,030
anything

479
00:31:17,710 --> 00:31:26,300
so solution for that is blacklisting

480
00:31:23,030 --> 00:31:30,530
some of the values this allows to

481
00:31:26,300 --> 00:31:39,590
perform tests at the same time as tests

482
00:31:30,530 --> 00:31:43,340
lab is used in usual tests and sometimes

483
00:31:39,590 --> 00:31:48,320
it helps sometimes it not but you have

484
00:31:43,340 --> 00:31:51,250
to do this so what are other problems

485
00:31:48,320 --> 00:31:54,470
implementing the fahza

486
00:31:51,250 --> 00:31:58,309
there is a problem with exhaustive

487
00:31:54,470 --> 00:32:01,760
testing because sometimes operator needs

488
00:31:58,309 --> 00:32:03,678
you to test everything they think for

489
00:32:01,760 --> 00:32:09,610
some reasons that it is possible to do

490
00:32:03,679 --> 00:32:13,970
and it's not so solution to this is to

491
00:32:09,610 --> 00:32:17,229
fast faster and to do this you really

492
00:32:13,970 --> 00:32:19,730
need to study protocol you are fuzzing

493
00:32:17,230 --> 00:32:22,910
in the answers are two kinds of

494
00:32:19,730 --> 00:32:27,070
mutations that affect length of the

495
00:32:22,910 --> 00:32:31,910
message and that don't do this and

496
00:32:27,070 --> 00:32:36,950
actually you can get away with changing

497
00:32:31,910 --> 00:32:40,640
the left only of once like for the

498
00:32:36,950 --> 00:32:43,790
strings with ones that are not aligned

499
00:32:40,640 --> 00:32:47,330
to four bytes that don't have a fixed

500
00:32:43,790 --> 00:32:49,879
length and this means that you can

501
00:32:47,330 --> 00:32:54,080
encode your message first and then for

502
00:32:49,880 --> 00:32:59,660
us eat which is quite faster than three

503
00:32:54,080 --> 00:33:02,780
encoding it all the time the other

504
00:32:59,660 --> 00:33:09,530
interesting topic is mutations in length

505
00:33:02,780 --> 00:33:13,280
I think this part best done after you do

506
00:33:09,530 --> 00:33:17,810
all your scope like you

507
00:33:13,280 --> 00:33:22,010
do the lands mutations during its own

508
00:33:17,810 --> 00:33:24,169
scope and again there are question what

509
00:33:22,010 --> 00:33:26,660
how to do this because you can update

510
00:33:24,170 --> 00:33:33,560
all headers in the message appropriately

511
00:33:26,660 --> 00:33:38,210
or you can also don't update them you

512
00:33:33,560 --> 00:33:42,580
just go and put some wrong number there

513
00:33:38,210 --> 00:33:47,690
and and I think you should do both

514
00:33:42,580 --> 00:33:52,010
so speaking of problems with laughs we

515
00:33:47,690 --> 00:33:54,650
we've seen these issue where there is a

516
00:33:52,010 --> 00:33:58,550
nested TVP invented specific application

517
00:33:54,650 --> 00:34:05,840
ID vendor ID enough of application ID

518
00:33:58,550 --> 00:34:11,350
and if you set a plant to zero in parent

519
00:34:05,840 --> 00:34:16,699
a VP da crash and it effects service on

520
00:34:11,350 --> 00:34:22,489
for the other users as well I think that

521
00:34:16,699 --> 00:34:25,489
everybody who self father's for like

522
00:34:22,489 --> 00:34:27,560
diameter for telecom protocols tells is

523
00:34:25,489 --> 00:34:31,069
that you need stateful checks stateful

524
00:34:27,560 --> 00:34:34,219
checks is a must but actually when do

525
00:34:31,070 --> 00:34:38,179
you need to go stateful when you are

526
00:34:34,219 --> 00:34:40,699
testing state machines and since in

527
00:34:38,179 --> 00:34:45,950
damped are most of the applications

528
00:34:40,699 --> 00:34:48,739
don't use or don't really use these deep

529
00:34:45,949 --> 00:34:53,870
state machines they just like request an

530
00:34:48,739 --> 00:34:57,950
answer you don't need that and again we

531
00:34:53,870 --> 00:35:03,910
haven't implemented these yet and found

532
00:34:57,950 --> 00:35:08,720
a lot of problems other issue is

533
00:35:03,910 --> 00:35:11,480
actually connected to your own tools you

534
00:35:08,720 --> 00:35:13,549
can send a formed message to the note

535
00:35:11,480 --> 00:35:17,600
the problem is not will answer an

536
00:35:13,550 --> 00:35:20,270
indenter it will answer with felt ABB

537
00:35:17,600 --> 00:35:22,910
and in this failed EVP you will receive

538
00:35:20,270 --> 00:35:26,060
your form to answer so you better be

539
00:35:22,910 --> 00:35:31,700
prepared to receive your

540
00:35:26,060 --> 00:35:33,710
your own informed messages and this is a

541
00:35:31,700 --> 00:35:35,960
problem because sometimes you need to

542
00:35:33,710 --> 00:35:38,570
pass the messages and sometimes not so

543
00:35:35,960 --> 00:35:41,450
you need is configurable again you need

544
00:35:38,570 --> 00:35:47,450
to create your tools so you're prepared

545
00:35:41,450 --> 00:35:50,899
for that then there's a problem with

546
00:35:47,450 --> 00:35:54,410
handling connections and sessions while

547
00:35:50,900 --> 00:35:57,140
most of protocols adjusts request an

548
00:35:54,410 --> 00:35:59,450
answer some of them would eat you to

549
00:35:57,140 --> 00:36:02,810
start connection on a or even session

550
00:35:59,450 --> 00:36:06,379
first and if you test certain notes or

551
00:36:02,810 --> 00:36:10,910
certain application IDs this means that

552
00:36:06,380 --> 00:36:16,910
you need note to send you a message

553
00:36:10,910 --> 00:36:19,430
and for this you need some emulator some

554
00:36:16,910 --> 00:36:22,100
changes on the note again you need to

555
00:36:19,430 --> 00:36:26,330
talk with them know beforehand about

556
00:36:22,100 --> 00:36:28,700
that you also don't want to break as a

557
00:36:26,330 --> 00:36:31,250
connection during fasten'd because of

558
00:36:28,700 --> 00:36:33,770
all the reestablishment and all the lost

559
00:36:31,250 --> 00:36:37,130
time and is true for any protocol not

560
00:36:33,770 --> 00:36:40,790
only for diameter in the diameter you

561
00:36:37,130 --> 00:36:42,740
bet a bar change in message tab where it

562
00:36:40,790 --> 00:36:47,750
can be changed to disconnect your

563
00:36:42,740 --> 00:36:52,359
request so but use you should as that of

564
00:36:47,750 --> 00:36:52,360
course just as I'm in a separate scope

565
00:36:54,580 --> 00:37:03,700
so as I said in some cases you would

566
00:36:59,150 --> 00:37:07,100
need emulators and a good rule of thumb

567
00:37:03,700 --> 00:37:10,390
to have your own because yes you can ask

568
00:37:07,100 --> 00:37:14,810
them no but in most cases that say no

569
00:37:10,390 --> 00:37:17,779
also quite a simple thing but well

570
00:37:14,810 --> 00:37:20,570
Captain Obvious to the rescue you need

571
00:37:17,780 --> 00:37:23,450
to update identities that should be

572
00:37:20,570 --> 00:37:24,650
changed between each message like you

573
00:37:23,450 --> 00:37:26,870
need to update hop-by-hop

574
00:37:24,650 --> 00:37:29,200
and end-to-end identities for the

575
00:37:26,870 --> 00:37:29,200
ammeter

576
00:37:29,960 --> 00:37:36,650
oK you've created your father nice

577
00:37:33,510 --> 00:37:39,359
then comes hot pots you need to

578
00:37:36,650 --> 00:37:42,440
understand what's happening and for this

579
00:37:39,359 --> 00:37:48,839
you really need login in your father

580
00:37:42,440 --> 00:37:53,490
lock everything you can and and this

581
00:37:48,839 --> 00:37:57,290
really helps messy so you are at mercy

582
00:37:53,490 --> 00:37:59,939
of network elements on return system

583
00:37:57,290 --> 00:38:04,500
usually it goes like this

584
00:37:59,940 --> 00:38:08,040
I mean Oh guys say ok please use these

585
00:38:04,500 --> 00:38:11,010
IP here's a system you are seen for the

586
00:38:08,040 --> 00:38:14,520
first time but sometimes it goes even

587
00:38:11,010 --> 00:38:19,940
faster than that in one case they just

588
00:38:14,520 --> 00:38:22,349
say it here's SSH to the node with

589
00:38:19,940 --> 00:38:28,849
binaries of a vendor I don't know why

590
00:38:22,349 --> 00:38:34,680
they did that so and to control commands

591
00:38:28,849 --> 00:38:39,270
enjoy and you are on your own from now

592
00:38:34,680 --> 00:38:42,299
on you can ask them for help but they

593
00:38:39,270 --> 00:38:48,060
don't really want to spend a lot of time

594
00:38:42,300 --> 00:38:51,930
with you so what I said the hard part

595
00:38:48,060 --> 00:38:54,029
every producing the issues you need to

596
00:38:51,930 --> 00:38:57,690
keep an eye on system time on different

597
00:38:54,030 --> 00:39:00,329
nodes because often that's a huge

598
00:38:57,690 --> 00:39:03,510
problem in the lab and I mean not like

599
00:39:00,329 --> 00:39:06,930
different time zones sometimes it goes a

600
00:39:03,510 --> 00:39:11,069
certain minutes and seconds one after

601
00:39:06,930 --> 00:39:13,230
another so that problem a bright idea

602
00:39:11,069 --> 00:39:19,170
would be to save as a random seed that

603
00:39:13,230 --> 00:39:22,020
you used and while it might be a bright

604
00:39:19,170 --> 00:39:25,980
D it for reproduction in some cases

605
00:39:22,020 --> 00:39:28,770
where you like spent hour or more

606
00:39:25,980 --> 00:39:31,470
doing the same tests and then it crashed

607
00:39:28,770 --> 00:39:34,109
it might be better to reproduce with

608
00:39:31,470 --> 00:39:41,040
different random seed just to get the

609
00:39:34,109 --> 00:39:42,348
same issue faster again in my case I

610
00:39:41,040 --> 00:39:44,390
always

611
00:39:42,349 --> 00:39:49,279
I work with aminals I always need to

612
00:39:44,390 --> 00:39:51,439
like file a report and it's not enough

613
00:39:49,279 --> 00:39:53,660
to say something trashed and that's what

614
00:39:51,439 --> 00:39:56,689
you want to say when you have fastened

615
00:39:53,660 --> 00:39:59,868
because it's really hard to understand

616
00:39:56,689 --> 00:40:03,739
what the problem is and to get working

617
00:39:59,869 --> 00:40:07,459
proof of concept you really need to

618
00:40:03,739 --> 00:40:11,239
think what about what message you should

619
00:40:07,459 --> 00:40:13,640
send to create a system for damage this

620
00:40:11,239 --> 00:40:16,489
usually boils down to change in AVP

621
00:40:13,640 --> 00:40:18,379
content and before change Navy be

622
00:40:16,489 --> 00:40:24,849
content understanding which mutations

623
00:40:18,380 --> 00:40:29,419
help which was the case with this

624
00:40:24,849 --> 00:40:33,499
problem actually we produced that when

625
00:40:29,419 --> 00:40:40,419
we did random change in message

626
00:40:33,499 --> 00:40:44,269
structure okay it ball down so these

627
00:40:40,419 --> 00:40:47,538
mutation helps okay it's time to slow

628
00:40:44,269 --> 00:40:52,538
the things down because usually you have

629
00:40:47,539 --> 00:40:55,099
like thousands hundreds dance of

630
00:40:52,539 --> 00:40:57,650
messages a second it's hard to

631
00:40:55,099 --> 00:40:59,900
understand which one of them really

632
00:40:57,650 --> 00:41:06,349
triggered the issue so the first thing

633
00:40:59,900 --> 00:41:10,549
you do let's have the same random seed

634
00:41:06,349 --> 00:41:15,499
right and try to slow no it's not

635
00:41:10,549 --> 00:41:18,589
reproducible in this case so what really

636
00:41:15,499 --> 00:41:22,669
helped is narrowing down types of

637
00:41:18,589 --> 00:41:26,239
mutations then AVP content and it allow

638
00:41:22,669 --> 00:41:30,078
us to have this really small message

639
00:41:26,239 --> 00:41:33,140
that triggers all the time surprisingly

640
00:41:30,079 --> 00:41:37,009
in this case we needed the burst of

641
00:41:33,140 --> 00:41:42,529
messages to for it to even crash but

642
00:41:37,009 --> 00:41:44,419
once it crashed it and I mean but once

643
00:41:42,529 --> 00:41:47,509
you understand that you see that it's

644
00:41:44,419 --> 00:41:49,089
reproducible always just the burst of

645
00:41:47,509 --> 00:41:53,050
messages

646
00:41:49,090 --> 00:41:56,470
so a few words about your typical

647
00:41:53,050 --> 00:41:59,830
project with a man oh you've got initial

648
00:41:56,470 --> 00:42:03,609
contact from them they say we need is

649
00:41:59,830 --> 00:42:05,110
fast like we are going to do this then

650
00:42:03,610 --> 00:42:07,900
you have several months of back and

651
00:42:05,110 --> 00:42:11,170
forth sometimes half a year sometimes a

652
00:42:07,900 --> 00:42:13,840
year and then it comes to the moment

653
00:42:11,170 --> 00:42:16,290
when they say get started next week you

654
00:42:13,840 --> 00:42:23,530
need to do this now

655
00:42:16,290 --> 00:42:27,880
okay you back you back back you go on

656
00:42:23,530 --> 00:42:30,910
site and on sides are always some issues

657
00:42:27,880 --> 00:42:34,630
always always something happens or as a

658
00:42:30,910 --> 00:42:38,379
typhoon public holiday is not being

659
00:42:34,630 --> 00:42:40,570
communicated well real story we had like

660
00:42:38,380 --> 00:42:45,970
the plan for the project and everything

661
00:42:40,570 --> 00:42:48,460
and our partners for some reason didn't

662
00:42:45,970 --> 00:42:52,169
bother to tell us okay we have public

663
00:42:48,460 --> 00:42:57,160
holidays so that we would be unavailable

664
00:42:52,170 --> 00:42:59,890
on one of the days and sometimes just

665
00:42:57,160 --> 00:43:01,720
just can be done in the lab for some

666
00:42:59,890 --> 00:43:05,170
reasons that is not communicated

667
00:43:01,720 --> 00:43:08,140
beforehand as a result almost always

668
00:43:05,170 --> 00:43:10,420
time for tests is shortened and it is

669
00:43:08,140 --> 00:43:13,690
not possible to do additional tests so

670
00:43:10,420 --> 00:43:16,600
again if you are on to something don't

671
00:43:13,690 --> 00:43:21,310
say okay I have my scope I will tear

672
00:43:16,600 --> 00:43:24,819
this later no you need to get working

673
00:43:21,310 --> 00:43:27,160
pork as fast as possible you may not you

674
00:43:24,820 --> 00:43:33,100
may have some problems you may don't

675
00:43:27,160 --> 00:43:35,529
have any other chance to do this again

676
00:43:33,100 --> 00:43:38,799
you need to ask for access to work

677
00:43:35,530 --> 00:43:41,260
systems beforehand and usually that's a

678
00:43:38,800 --> 00:43:44,050
tough part because you asked one time

679
00:43:41,260 --> 00:43:47,270
you asked several times you ask on site

680
00:43:44,050 --> 00:43:51,109
it takes them

681
00:43:47,270 --> 00:43:55,579
in one of the cases I spent like a week

682
00:43:51,109 --> 00:44:02,529
and a half just waiting to have my

683
00:43:55,579 --> 00:44:06,849
connection to the note be configured so

684
00:44:02,530 --> 00:44:09,410
if you can get access to vendors

685
00:44:06,849 --> 00:44:11,930
representatives they can shed some light

686
00:44:09,410 --> 00:44:16,250
on what is happening on the not really

687
00:44:11,930 --> 00:44:20,779
because okay you see the alarm it's like

688
00:44:16,250 --> 00:44:24,859
a module fault or capsule abortion it

689
00:44:20,780 --> 00:44:29,240
doesn't say much for you you need to

690
00:44:24,859 --> 00:44:33,348
understand what is the actual result how

691
00:44:29,240 --> 00:44:35,450
it affects the system of course have

692
00:44:33,349 --> 00:44:38,690
enough time planned for investigation

693
00:44:35,450 --> 00:44:40,759
but as I said most probably even if you

694
00:44:38,690 --> 00:44:45,020
have it planned you still have some

695
00:44:40,760 --> 00:44:50,119
issues and it's better to have larger

696
00:44:45,020 --> 00:44:55,280
scopes and go in-depth with one message

697
00:44:50,119 --> 00:44:58,700
in most cases don't forget to present

698
00:44:55,280 --> 00:45:01,569
your results comprehensibly usually the

699
00:44:58,700 --> 00:45:04,368
guys reading these are both executives

700
00:45:01,569 --> 00:45:06,380
that don't understand what's happening

701
00:45:04,369 --> 00:45:11,329
at all and you need to put it in a

702
00:45:06,380 --> 00:45:13,609
simple terms and of course security

703
00:45:11,329 --> 00:45:16,690
officers they do understand and for Sam

704
00:45:13,609 --> 00:45:23,000
you need like detailed descriptions

705
00:45:16,690 --> 00:45:27,049
working pork in our case again for

706
00:45:23,000 --> 00:45:31,520
evaluation go to vendor representatives

707
00:45:27,049 --> 00:45:34,430
so that's the end of the talk few key

708
00:45:31,520 --> 00:45:36,920
takeaways first fold aside if you need

709
00:45:34,430 --> 00:45:39,230
your own protocol implementation don't

710
00:45:36,920 --> 00:45:41,450
forget to adapt the your father to the

711
00:45:39,230 --> 00:45:43,040
operating conditions how we need it for

712
00:45:41,450 --> 00:45:46,399
EM I know it may be different for you

713
00:45:43,040 --> 00:45:50,569
study is a protocol to see when you can

714
00:45:46,400 --> 00:45:53,720
speed up the work shape first if you

715
00:45:50,569 --> 00:45:55,670
need stateful checks at all maybe you

716
00:45:53,720 --> 00:45:57,290
can do everything in your lab quite

717
00:45:55,670 --> 00:45:59,400
easily

718
00:45:57,290 --> 00:46:05,759
don't break the connection

719
00:45:59,400 --> 00:46:08,460
bus answers when it's appropriate create

720
00:46:05,760 --> 00:46:13,260
your own testing programs that will help

721
00:46:08,460 --> 00:46:15,900
you plan before hand include fudge

722
00:46:13,260 --> 00:46:19,710
factor lock everything and most

723
00:46:15,900 --> 00:46:22,050
importantly always try to report your

724
00:46:19,710 --> 00:46:25,290
findings in a comprehensive way because

725
00:46:22,050 --> 00:46:27,600
once you start writing the report

726
00:46:25,290 --> 00:46:29,910
you always have additional thoughts

727
00:46:27,600 --> 00:46:31,799
maybe I should have tested these maybe I

728
00:46:29,910 --> 00:46:35,250
should have tested that so it's better

729
00:46:31,800 --> 00:46:37,940
to start as early as possible so thanks

730
00:46:35,250 --> 00:46:37,940
for your attention

731
00:46:41,480 --> 00:46:45,870
Thank You Sergey we're now ready for

732
00:46:43,650 --> 00:46:48,180
questions I see all tockman's up all

733
00:46:45,870 --> 00:46:53,370
right we'll do do live questions first

734
00:46:48,180 --> 00:46:58,169
and over to you by the way there are

735
00:46:53,370 --> 00:47:00,480
some goodies for questions yep

736
00:46:58,170 --> 00:47:03,600
are you aware of like aminos using honey

737
00:47:00,480 --> 00:47:06,120
pots and on the IPX my first question

738
00:47:03,600 --> 00:47:09,120
and the second one is yes is the result

739
00:47:06,120 --> 00:47:11,490
of fuzzing always a crash or sometimes

740
00:47:09,120 --> 00:47:13,980
like when you use reserved values or

741
00:47:11,490 --> 00:47:17,879
like unused values does it invoke a

742
00:47:13,980 --> 00:47:19,590
different procedure like sending some

743
00:47:17,880 --> 00:47:22,260
some location update or something like

744
00:47:19,590 --> 00:47:28,170
this instead of a crash I got it

745
00:47:22,260 --> 00:47:30,180
regarding Emma knows actually what we

746
00:47:28,170 --> 00:47:32,750
see when we are implementing a products

747
00:47:30,180 --> 00:47:35,759
Emma knows don't have clear

748
00:47:32,750 --> 00:47:39,180
understanding what's happening on the

749
00:47:35,760 --> 00:47:41,970
IPX like they have misconfigurations

750
00:47:39,180 --> 00:47:42,990
that have traffic that comes for no

751
00:47:41,970 --> 00:47:45,839
apparent reason

752
00:47:42,990 --> 00:47:49,529
and they don't know this I really depth

753
00:47:45,840 --> 00:47:53,100
that they have honey pots maybe like the

754
00:47:49,530 --> 00:47:56,340
bad ones do the problem is that each

755
00:47:53,100 --> 00:47:59,160
amino is different you have some that

756
00:47:56,340 --> 00:48:02,160
are 4G only top-notch security and ones

757
00:47:59,160 --> 00:48:07,350
that don't do anything and thinking how

758
00:48:02,160 --> 00:48:11,040
to have a capex and OPEX as well as

759
00:48:07,350 --> 00:48:16,110
possible and the second question is

760
00:48:11,040 --> 00:48:18,360
it always a crash well it it doesn't

761
00:48:16,110 --> 00:48:21,870
necessarily always a crash the problem

762
00:48:18,360 --> 00:48:26,750
is how you understand that again as I

763
00:48:21,870 --> 00:48:29,910
said in ml case you don't have access to

764
00:48:26,750 --> 00:48:32,820
systems in a comprehensive way they give

765
00:48:29,910 --> 00:48:35,580
you like okay is this a fault management

766
00:48:32,820 --> 00:48:38,280
system you see it first time and it

767
00:48:35,580 --> 00:48:40,740
doesn't lock for memory leaks for

768
00:48:38,280 --> 00:48:43,200
example and that's why I'm saying you

769
00:48:40,740 --> 00:48:46,020
need to go to vendors to really fix

770
00:48:43,200 --> 00:48:50,129
everything but usually what you see

771
00:48:46,020 --> 00:48:52,470
during the test is crash so that's more

772
00:48:50,130 --> 00:48:53,340
about what you see not what's happening

773
00:48:52,470 --> 00:48:57,540
with the system

774
00:48:53,340 --> 00:49:00,360
you see thanks any more questions from

775
00:48:57,540 --> 00:49:02,759
the floor I have to say Sergey is gifts

776
00:49:00,360 --> 00:49:07,710
for questions is the best gifts that

777
00:49:02,760 --> 00:49:20,880
speakers have brought this questions

778
00:49:07,710 --> 00:49:22,890
anyone else how companies get it but for

779
00:49:20,880 --> 00:49:26,400
an individual like a researcher or or

780
00:49:22,890 --> 00:49:30,720
some enthusiasts usually you need to be

781
00:49:26,400 --> 00:49:35,730
a company the sink is nothing stops you

782
00:49:30,720 --> 00:49:39,330
of being a company that's the problem so

783
00:49:35,730 --> 00:49:46,100
you can say okay we have like weather

784
00:49:39,330 --> 00:49:50,029
forecast solution we need to send SMS

785
00:49:46,100 --> 00:49:55,020
can you do something for us and well

786
00:49:50,030 --> 00:49:58,740
yeah they can one more question

787
00:49:55,020 --> 00:50:00,810
one more life question well sure it's

788
00:49:58,740 --> 00:50:03,359
more of a light-hearted question but you

789
00:50:00,810 --> 00:50:05,490
know why they called it diameter two

790
00:50:03,360 --> 00:50:08,100
radiuses no because it's supposed to be

791
00:50:05,490 --> 00:50:12,149
twice as good as radius well it's

792
00:50:08,100 --> 00:50:15,060
supposed to be twice as good the thing

793
00:50:12,150 --> 00:50:18,270
is maybe it is twice as good or even a

794
00:50:15,060 --> 00:50:23,340
lot better than radius in its original

795
00:50:18,270 --> 00:50:24,360
field but fourth telecom for signaling I

796
00:50:23,340 --> 00:50:28,830
don't

797
00:50:24,360 --> 00:50:32,720
see all right well now to the slide oh

798
00:50:28,830 --> 00:50:32,720
the highest voted question at the top

799
00:50:33,000 --> 00:50:36,159
[Applause]

800
00:50:36,590 --> 00:50:45,210
you see that's oh I think I maybe forgot

801
00:50:42,060 --> 00:50:47,400
to mention we don't do this often and we

802
00:50:45,210 --> 00:50:50,550
don't really think that that the work

803
00:50:47,400 --> 00:50:54,930
that we need to do with seminoles okay

804
00:50:50,550 --> 00:50:56,420
sometimes they have like how should I

805
00:50:54,930 --> 00:51:01,049
put it

806
00:50:56,420 --> 00:51:02,790
someone come first and then and say okay

807
00:51:01,050 --> 00:51:05,940
we fast your network here are results

808
00:51:02,790 --> 00:51:10,020
and they need these read on Cyril use

809
00:51:05,940 --> 00:51:11,910
later or they have the own brand new

810
00:51:10,020 --> 00:51:16,250
vision on what fashion should look like

811
00:51:11,910 --> 00:51:19,290
sometimes they need files in the results

812
00:51:16,250 --> 00:51:22,440
it feels like just to bargain with

813
00:51:19,290 --> 00:51:29,520
vendors just to say that aha you have

814
00:51:22,440 --> 00:51:33,810
problems so what about price and since

815
00:51:29,520 --> 00:51:37,680
we are not doing these all the time we

816
00:51:33,810 --> 00:51:42,840
did the simplest one we could mutational

817
00:51:37,680 --> 00:51:47,359
one that's why we haven't considered

818
00:51:42,840 --> 00:51:50,160
generation father at all it was just

819
00:51:47,360 --> 00:51:52,350
clear for us that it's a way to go

820
00:51:50,160 --> 00:51:54,899
before we move on to that one may I know

821
00:51:52,350 --> 00:51:57,450
who asked that question all right we'll

822
00:51:54,900 --> 00:52:00,780
pass you your your gift it's over here

823
00:51:57,450 --> 00:52:03,980
I'll toss you yeah laughing mark for the

824
00:52:00,780 --> 00:52:06,930
life question in the next question okay

825
00:52:03,980 --> 00:52:09,390
instrumentation I'm I don't really

826
00:52:06,930 --> 00:52:13,980
understand what kind of instrumentation

827
00:52:09,390 --> 00:52:17,850
you are referring to again I'm talking

828
00:52:13,980 --> 00:52:21,390
about case where you have just IP access

829
00:52:17,850 --> 00:52:24,799
to the node and IP access to fault

830
00:52:21,390 --> 00:52:27,960
management system that's all we've got

831
00:52:24,800 --> 00:52:30,890
maybe you can do us without tools but

832
00:52:27,960 --> 00:52:36,540
that's it

833
00:52:30,890 --> 00:52:38,040
well you can go on for example for the

834
00:52:36,540 --> 00:52:45,800
answer it's really

835
00:52:38,040 --> 00:52:49,860
you can go and download like fightin

836
00:52:45,800 --> 00:52:54,870
package that's easy then go and download

837
00:52:49,860 --> 00:52:59,220
quite inviting so Linux kernel SCTP then

838
00:52:54,870 --> 00:53:02,270
go and find somewhere in the internet

839
00:52:59,220 --> 00:53:05,569
you may ask me I know Cyril

840
00:53:02,270 --> 00:53:10,080
implementation for Python for damn sure

841
00:53:05,570 --> 00:53:12,600
you may go through it actually that's

842
00:53:10,080 --> 00:53:15,509
how I started I had to rewrite it

843
00:53:12,600 --> 00:53:18,990
because it has a lot of problems

844
00:53:15,510 --> 00:53:24,720
internally we send in more messages but

845
00:53:18,990 --> 00:53:29,100
see you can start with it and just then

846
00:53:24,720 --> 00:53:32,069
open technical specification create a

847
00:53:29,100 --> 00:53:35,430
message and try to file it it's it

848
00:53:32,070 --> 00:53:38,010
really simple it doesn't take any money

849
00:53:35,430 --> 00:53:42,120
to start you all you need is skill and

850
00:53:38,010 --> 00:53:44,220
like a week work that's it and actually

851
00:53:42,120 --> 00:53:46,799
that's the message of it off the talk

852
00:53:44,220 --> 00:53:49,439
you don't need to buy these overpriced

853
00:53:46,800 --> 00:53:53,910
father's to find actual problems in

854
00:53:49,440 --> 00:53:56,070
telecom network you just need to if you

855
00:53:53,910 --> 00:54:05,850
are in terminal you just need to start

856
00:53:56,070 --> 00:54:08,220
doing it it's easy sometimes either

857
00:54:05,850 --> 00:54:10,200
anyway as a user to detect if I am a

858
00:54:08,220 --> 00:54:14,310
target of circum attack sometimes yes

859
00:54:10,200 --> 00:54:19,950
sometimes no in some cases you'll see

860
00:54:14,310 --> 00:54:23,290
believe me for 4G attacks that I'm doing

861
00:54:19,950 --> 00:54:25,339
you'll see like flesh and

862
00:54:23,290 --> 00:54:29,308
[Music]

863
00:54:25,339 --> 00:54:34,288
connection flashing Network symbol on

864
00:54:29,309 --> 00:54:38,039
your phone one of the attacks is about

865
00:54:34,289 --> 00:54:40,230
sending like update locations like doing

866
00:54:38,039 --> 00:54:42,569
those once a second and you will see

867
00:54:40,230 --> 00:54:43,140
that but if someone tracking your

868
00:54:42,569 --> 00:54:46,558
location

869
00:54:43,140 --> 00:54:52,160
I'm afraid no you can't be sure but that

870
00:54:46,559 --> 00:54:56,150
it's what Emma knows need to handle and

871
00:54:52,160 --> 00:55:02,788
they try actually there is this whole

872
00:54:56,150 --> 00:55:09,059
GSMA association that works on the ways

873
00:55:02,789 --> 00:55:12,000
how to deal with that have you looked

874
00:55:09,059 --> 00:55:15,119
into this attacks on 5g networks if they

875
00:55:12,000 --> 00:55:17,640
will be fixed when 5g comes out again

876
00:55:15,119 --> 00:55:21,930
this bolts down on what you understand

877
00:55:17,640 --> 00:55:25,520
as 5g in 5g standalone there won't be

878
00:55:21,930 --> 00:55:28,520
any diameter the problem is that they

879
00:55:25,520 --> 00:55:32,490
most likely will still use the same

880
00:55:28,520 --> 00:55:34,380
procedures and that's the problem you

881
00:55:32,490 --> 00:55:39,058
have the same procedures with the same

882
00:55:34,380 --> 00:55:41,940
test vendors won't do any security

883
00:55:39,059 --> 00:55:44,490
updates on them they just like okay I do

884
00:55:41,940 --> 00:55:48,690
the same thing but in other protocol no

885
00:55:44,490 --> 00:55:49,558
checks no nothin and there is risk in

886
00:55:48,690 --> 00:55:52,440
5ge

887
00:55:49,559 --> 00:55:56,130
standalone with new protocols that this

888
00:55:52,440 --> 00:55:58,589
still be the case but actually is there

889
00:55:56,130 --> 00:56:01,440
working on the security and we when we

890
00:55:58,589 --> 00:56:05,520
are talking about non standalone version

891
00:56:01,440 --> 00:56:08,039
it's the same core network there's no

892
00:56:05,520 --> 00:56:11,038
difference so if someone says to you

893
00:56:08,039 --> 00:56:13,260
right now that they have 5g networks

894
00:56:11,039 --> 00:56:20,609
they have non standalone and this means

895
00:56:13,260 --> 00:56:22,440
that all these attacks are possible how

896
00:56:20,609 --> 00:56:29,450
much fun is required for robustness

897
00:56:22,440 --> 00:56:29,450
level I can't don't get the question

898
00:56:31,040 --> 00:56:51,930
yes just want to ask the way to stop -

899
00:56:46,620 --> 00:56:55,440
why - stop in most cases it's not a

900
00:56:51,930 --> 00:57:02,940
question the question is how do I get

901
00:56:55,440 --> 00:57:06,690
more time with the note you see usually

902
00:57:02,940 --> 00:57:10,320
if you are a rig producing it's like you

903
00:57:06,690 --> 00:57:13,380
actively monitor lock system and you see

904
00:57:10,320 --> 00:57:16,050
ok it crashed I need to stop you have

905
00:57:13,380 --> 00:57:18,750
ever seen recorded but more often than

906
00:57:16,050 --> 00:57:21,060
not you need to alter the message to

907
00:57:18,750 --> 00:57:24,780
understand what's happening even if you

908
00:57:21,060 --> 00:57:27,480
have the locks it gives like this

909
00:57:24,780 --> 00:57:31,140
understanding what was I doing like I

910
00:57:27,480 --> 00:57:35,520
was fussing laughs I was changing Z say

911
00:57:31,140 --> 00:57:39,650
VP in this place so unique you may then

912
00:57:35,520 --> 00:57:39,650
work only on three say VP for example

913
00:57:41,030 --> 00:57:48,330
some Emma knows actually asked us if it

914
00:57:44,340 --> 00:57:51,660
is possible to like send a message to

915
00:57:48,330 --> 00:57:54,270
check if everything is working fine but

916
00:57:51,660 --> 00:57:55,799
I don't think that works like that

917
00:57:54,270 --> 00:57:58,980
if you send correct message you get

918
00:57:55,800 --> 00:58:00,600
correct result by maybe different

919
00:57:58,980 --> 00:58:03,330
process that's not how you do it

920
00:58:00,600 --> 00:58:15,990
so basically it's all down to many turn

921
00:58:03,330 --> 00:58:20,220
FM other providers 11,000 in the

922
00:58:15,990 --> 00:58:24,660
networks there is jeezum a document

923
00:58:20,220 --> 00:58:27,450
about passing by independent researches

924
00:58:24,660 --> 00:58:30,720
we usually have like agreement with

925
00:58:27,450 --> 00:58:33,870
provider we go on site for this and we

926
00:58:30,720 --> 00:58:38,580
do fasten in the test lab a fashion or

927
00:58:33,870 --> 00:58:42,029
in the real network to do this properly

928
00:58:38,580 --> 00:58:44,880
you need to connect to operator and I'm

929
00:58:42,030 --> 00:58:46,980
quite sure that that the evil say no

930
00:58:44,880 --> 00:58:50,819
I don't think you should really do that

931
00:58:46,980 --> 00:58:55,670
because okay you fast Mme OHSS now the

932
00:58:50,819 --> 00:58:58,940
whole city is without network in

933
00:58:55,670 --> 00:59:01,829
countries like Korea is without any

934
00:58:58,940 --> 00:59:05,759
mobile network for the separators that's

935
00:59:01,829 --> 00:59:11,099
a huge problem that can get you in jail

936
00:59:05,759 --> 00:59:14,279
I think in some countries and the last

937
00:59:11,099 --> 00:59:15,950
one yes findings all the fighting I

938
00:59:14,279 --> 00:59:18,660
usually vendor-specific

939
00:59:15,950 --> 00:59:22,799
all right that covers it any more

940
00:59:18,660 --> 00:59:25,890
questions from the floor I know our

941
00:59:22,799 --> 00:59:27,750
Sergey your vote on who is the best

942
00:59:25,890 --> 00:59:30,690
question from the floor that you would

943
00:59:27,750 --> 00:59:33,839
like to award your cool gifts to I got

944
00:59:30,690 --> 00:59:36,690
two goodies and they go to guys in the

945
00:59:33,839 --> 00:59:39,089
back alright i'll tough and the other

946
00:59:36,690 --> 00:59:41,390
gentleman yes all right come on out come

947
00:59:39,089 --> 00:59:45,650
on over yeah just get this goose

948
00:59:41,390 --> 00:59:48,720
[Applause]

949
00:59:45,650 --> 00:59:50,250
Thank You Sergei and thank you to do all

950
00:59:48,720 --> 00:59:58,379
the audience for participating in the

951
00:59:50,250 --> 01:00:00,690
question goes for this man yes thank you

952
00:59:58,380 --> 01:00:03,119
and thank you very much again Sergei for

953
01:00:00,690 --> 01:00:04,890
a really cool engaging talk and to all

954
01:00:03,119 --> 01:00:06,700
the audience for participating thank you

955
01:00:04,890 --> 01:00:11,170
very much thank you

956
01:00:06,700 --> 01:00:11,169
[Applause]

