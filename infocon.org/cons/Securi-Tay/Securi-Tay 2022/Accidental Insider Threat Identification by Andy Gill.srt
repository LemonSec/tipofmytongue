1
00:00:03,040 --> 00:00:03,919
um

2
00:00:03,919 --> 00:00:05,680
so for those of you who don't know me um

3
00:00:05,680 --> 00:00:07,440
i'm andy l in real life or is there

4
00:00:07,440 --> 00:00:09,840
professional internet i specialize in

5
00:00:09,840 --> 00:00:11,280
the offensive security and i work for

6
00:00:11,280 --> 00:00:13,440
larry's consulting now rebranding is the

7
00:00:13,440 --> 00:00:14,880
mobile security services i'm an

8
00:00:14,880 --> 00:00:16,640
insomniac so most of her work is done

9
00:00:16,640 --> 00:00:19,039
between 11 pm and

10
00:00:19,039 --> 00:00:21,039
6 in the morning ish

11
00:00:21,039 --> 00:00:22,800
um in my free time i enjoy taking a lot

12
00:00:22,800 --> 00:00:24,560
of photos so i've got a blog that i

13
00:00:24,560 --> 00:00:26,000
would photos too

14
00:00:26,000 --> 00:00:27,599
and i own an audi r8 i used to wear a

15
00:00:27,599 --> 00:00:29,279
focus rs i used to take pictures

16
00:00:29,279 --> 00:00:30,480
of it all the time

17
00:00:30,480 --> 00:00:33,279
 i just swore

18
00:00:34,239 --> 00:00:37,200
we're all good 60 seconds uh i i say i

19
00:00:37,200 --> 00:00:38,480
do karate i've not actually trained in

20
00:00:38,480 --> 00:00:39,920
two years but i do hold the black belt

21
00:00:39,920 --> 00:00:41,840
so not only am i keyboard warrior i'll

22
00:00:41,840 --> 00:00:44,879
break your legs as well so

23
00:00:44,879 --> 00:00:46,480
host co-host of the podcast i have my

24
00:00:46,480 --> 00:00:48,239
other co-host here dave we've got ouija

25
00:00:48,239 --> 00:00:50,480
cast we've had quite a lot of um people

26
00:00:50,480 --> 00:00:52,239
in the industry on it over the last two

27
00:00:52,239 --> 00:00:54,480
and a half years 24 episodes

28
00:00:54,480 --> 00:00:56,559
hoping to keep it going um

29
00:00:56,559 --> 00:00:59,920
yeah should be pretty fun so quick recap

30
00:00:59,920 --> 00:01:03,039
honey poc what actually is it so round

31
00:01:03,039 --> 00:01:05,680
about 2020 a vulnerability called

32
00:01:05,680 --> 00:01:07,520
cigarette came out now cigred was a

33
00:01:07,520 --> 00:01:10,000
vulnerability that affected windows dns

34
00:01:10,000 --> 00:01:11,200
and it was remote code execution

35
00:01:11,200 --> 00:01:13,439
vulnerability and it was being hyped up

36
00:01:13,439 --> 00:01:15,439
as oh this is the next like massive

37
00:01:15,439 --> 00:01:17,280
vulnerability as these things do had a

38
00:01:17,280 --> 00:01:20,000
logo it had all this stuff and around

39
00:01:20,000 --> 00:01:22,159
the back so then check point where the

40
00:01:22,159 --> 00:01:23,840
original company who were like we found

41
00:01:23,840 --> 00:01:24,720
this one about it you were going to

42
00:01:24,720 --> 00:01:27,439
release a blog post like 8pm uk time

43
00:01:27,439 --> 00:01:28,799
and everything was everything was

44
00:01:28,799 --> 00:01:31,119
hunky-dory but my colleagues and i got

45
00:01:31,119 --> 00:01:32,479
together i'm like how long will it be to

46
00:01:32,479 --> 00:01:34,000
an actual proof of concept comes out

47
00:01:34,000 --> 00:01:35,439
till someone actually exploits this i

48
00:01:35,439 --> 00:01:38,240
was like two minutes scott got on and

49
00:01:38,240 --> 00:01:40,560
wrote a quick bash script to make a call

50
00:01:40,560 --> 00:01:42,960
request to rick astley's uh video just a

51
00:01:42,960 --> 00:01:44,479
rick roll people because

52
00:01:44,479 --> 00:01:46,720
every lots of troll and i uploaded that

53
00:01:46,720 --> 00:01:48,720
to github and that started getting hits

54
00:01:48,720 --> 00:01:50,560
within seconds it was getting a couple

55
00:01:50,560 --> 00:01:52,560
hundred hits every every second and one

56
00:01:52,560 --> 00:01:54,640
of my good mates john carroll was like

57
00:01:54,640 --> 00:01:55,759
you're getting a lot of hits maybe you

58
00:01:55,759 --> 00:01:57,759
want to look at some analytics of this

59
00:01:57,759 --> 00:01:59,680
so um he suggested i looked at things

60
00:01:59,680 --> 00:02:02,079
canary so canarytokens.org is a service

61
00:02:02,079 --> 00:02:04,960
that allows you to create urls and

62
00:02:04,960 --> 00:02:06,719
binaries and pdfs and all sorts of file

63
00:02:06,719 --> 00:02:08,959
types that when they're opened or run or

64
00:02:08,959 --> 00:02:11,120
clicked on they send a call back so a

65
00:02:11,120 --> 00:02:12,879
bit like command control but it's more

66
00:02:12,879 --> 00:02:14,560
for analytics and

67
00:02:14,560 --> 00:02:16,879
early detect early signs of detection um

68
00:02:16,879 --> 00:02:17,760
for

69
00:02:17,760 --> 00:02:18,879
compromise

70
00:02:18,879 --> 00:02:19,840
so

71
00:02:19,840 --> 00:02:22,319
i create a binary that has a canary

72
00:02:22,319 --> 00:02:24,160
token embedded and when it was run and

73
00:02:24,160 --> 00:02:25,520
not only would it rick roll the person

74
00:02:25,520 --> 00:02:26,959
it would also send me a callback to say

75
00:02:26,959 --> 00:02:28,720
that it had been run in the callback it

76
00:02:28,720 --> 00:02:30,720
would give me the ip address of the so

77
00:02:30,720 --> 00:02:32,640
where did it come from the target ip

78
00:02:32,640 --> 00:02:33,599
because the way that i'd coded the

79
00:02:33,599 --> 00:02:35,680
binary is that the so you give it like a

80
00:02:35,680 --> 00:02:37,760
dash t flag and then put in the ip and

81
00:02:37,760 --> 00:02:39,519
that was loaded into the binary and sent

82
00:02:39,519 --> 00:02:41,920
back into the user agent so usually user

83
00:02:41,920 --> 00:02:45,120
agent had the ips pieces kind of malware

84
00:02:45,120 --> 00:02:46,800
not really but it was

85
00:02:46,800 --> 00:02:48,319
purely benign

86
00:02:48,319 --> 00:02:50,800
and it was yeah it was designed designed

87
00:02:50,800 --> 00:02:52,560
just to have a bit of fun

88
00:02:52,560 --> 00:02:54,560
in terms of timeline of events so this

89
00:02:54,560 --> 00:02:56,319
talk i i gave the first part of this

90
00:02:56,319 --> 00:02:58,239
talk as long as this this timeline is

91
00:02:58,239 --> 00:02:59,920
representative of research london with

92
00:02:59,920 --> 00:03:01,920
the addition of vlog 4g i'll talk about

93
00:03:01,920 --> 00:03:04,319
4g later on i didn't release a honey plc

94
00:03:04,319 --> 00:03:05,920
for that i've registered released a

95
00:03:05,920 --> 00:03:08,480
legitimate poc but people didn't listen

96
00:03:08,480 --> 00:03:09,680
um

97
00:03:09,680 --> 00:03:10,640
so

98
00:03:10,640 --> 00:03:12,879
first

99
00:03:12,879 --> 00:03:14,000
everyone okay

100
00:03:14,000 --> 00:03:16,879
something on machine gun

101
00:03:17,680 --> 00:03:18,800
okay cool

102
00:03:18,800 --> 00:03:21,040
um

103
00:03:28,000 --> 00:03:30,000
yeah so the first plc came out in july

104
00:03:30,000 --> 00:03:31,920
2020 and then around about april there

105
00:03:31,920 --> 00:03:33,599
was multiple vulnerabilities that came

106
00:03:33,599 --> 00:03:35,760
out in exchange and pulse secure and

107
00:03:35,760 --> 00:03:37,440
various other things and because i'm a

108
00:03:37,440 --> 00:03:40,319
shy bag i just decided to release um

109
00:03:40,319 --> 00:03:43,440
fake pocs and this the same as

110
00:03:43,440 --> 00:03:44,840
the first time around

111
00:03:44,840 --> 00:03:46,879
and once that got a little bit

112
00:03:46,879 --> 00:03:48,000
attraction i think i was getting around

113
00:03:48,000 --> 00:03:49,519
about a thousand to two thousand hits a

114
00:03:49,519 --> 00:03:51,840
day which is quite a lot no not nothing

115
00:03:51,840 --> 00:03:53,200
sorry an hour i was getting a lot every

116
00:03:53,200 --> 00:03:55,360
hour i got like loads of loads of hits

117
00:03:55,360 --> 00:03:59,040
um kevin beaumont suggested that in at

118
00:03:59,040 --> 00:04:00,080
about may time why don't you just

119
00:04:00,080 --> 00:04:02,319
automate this like every single cv that

120
00:04:02,319 --> 00:04:04,720
comes out release a poc automate it and

121
00:04:04,720 --> 00:04:06,560
it'll be great fun

122
00:04:06,560 --> 00:04:08,239
and that's what i did

123
00:04:08,239 --> 00:04:09,599
and i'll talk about it in a second

124
00:04:09,599 --> 00:04:10,879
release the project but i haven't

125
00:04:10,879 --> 00:04:11,920
actually released the framework it's

126
00:04:11,920 --> 00:04:13,439
actually pretty dangerous as to what it

127
00:04:13,439 --> 00:04:15,280
does but hooked up in a minute and that

128
00:04:15,280 --> 00:04:17,839
would automate it per year plc then in

129
00:04:17,839 --> 00:04:20,560
december last year log 4j the the

130
00:04:20,560 --> 00:04:22,479
greatest vulnerability of all time came

131
00:04:22,479 --> 00:04:23,919
out and

132
00:04:23,919 --> 00:04:26,160
i decided being the nice person that i'd

133
00:04:26,160 --> 00:04:28,800
released genuine pocs like here here's a

134
00:04:28,800 --> 00:04:30,479
url and here's the string that you can

135
00:04:30,479 --> 00:04:32,479
go and do but change the url to whatever

136
00:04:32,479 --> 00:04:35,680
url you want and about 5 000 people

137
00:04:35,680 --> 00:04:37,440
didn't change the url from the default

138
00:04:37,440 --> 00:04:40,479
url so me being me i'd set it as a

139
00:04:40,479 --> 00:04:42,720
canary token and i got a lot more

140
00:04:42,720 --> 00:04:44,720
information than i thought i was going

141
00:04:44,720 --> 00:04:46,479
to get and as a result

142
00:04:46,479 --> 00:04:48,400
kind of learned a lot about

143
00:04:48,400 --> 00:04:50,560
insider threats what the url had in it

144
00:04:50,560 --> 00:04:52,000
was um

145
00:04:52,000 --> 00:04:53,360
kind of an environmental variable

146
00:04:53,360 --> 00:04:54,960
strength so i had dollar open bracket

147
00:04:54,960 --> 00:04:56,440
hosting

148
00:04:56,440 --> 00:04:58,479
closedbracket.domain.com which is linux

149
00:04:58,479 --> 00:05:00,479
for command execution for hostname so if

150
00:05:00,479 --> 00:05:02,160
that ran they would send a dns request

151
00:05:02,160 --> 00:05:04,560
back to my endpoint with the hostname of

152
00:05:04,560 --> 00:05:07,120
the system runner now what i didn't

153
00:05:07,120 --> 00:05:08,720
account for is the fact that in a lot of

154
00:05:08,720 --> 00:05:10,160
corporate environments the host name is

155
00:05:10,160 --> 00:05:11,440
not just like

156
00:05:11,440 --> 00:05:15,240
john's pc or jane's pc it's john's

157
00:05:15,240 --> 00:05:17,680
pc.company.org.local or whatever so as a

158
00:05:17,680 --> 00:05:19,280
result i've got quite a lot of internal

159
00:05:19,280 --> 00:05:21,600
host names and i bet off a lot more than

160
00:05:21,600 --> 00:05:22,639
i can chew

161
00:05:22,639 --> 00:05:24,720
and to the point where i got some

162
00:05:24,720 --> 00:05:27,199
intelligent services um i say

163
00:05:27,199 --> 00:05:28,720
intelligence if you're intelligent

164
00:05:28,720 --> 00:05:30,080
you're running things on the internet

165
00:05:30,080 --> 00:05:32,160
with no repercussions you're not very

166
00:05:32,160 --> 00:05:33,440
intelligent but

167
00:05:33,440 --> 00:05:35,440
hey and i got a lot of like scada

168
00:05:35,440 --> 00:05:36,320
companies because there's a lot of

169
00:05:36,320 --> 00:05:37,520
vulnerabilities i'll talk about them

170
00:05:37,520 --> 00:05:39,039
later on the slide and i got a lot of

171
00:05:39,039 --> 00:05:40,960
just interesting companies that i would

172
00:05:40,960 --> 00:05:42,400
have thought would know better a lot of

173
00:05:42,400 --> 00:05:44,320
security consultancies in the uk running

174
00:05:44,320 --> 00:05:45,199
things

175
00:05:45,199 --> 00:05:46,639
not a good idea

176
00:05:46,639 --> 00:05:48,720
so in terms of the data so this is this

177
00:05:48,720 --> 00:05:50,560
is the data from the first poc which is

178
00:05:50,560 --> 00:05:52,800
the sig red one and for those of you who

179
00:05:52,800 --> 00:05:54,479
can't see the back and the numbers are

180
00:05:54,479 --> 00:05:56,240
tiny essentially quite a lot of the hits

181
00:05:56,240 --> 00:05:58,800
here are from like asms and from like

182
00:05:58,800 --> 00:06:00,080
cloud providers so like you've got

183
00:06:00,080 --> 00:06:01,360
google up here

184
00:06:01,360 --> 00:06:04,639
china everyone loves china china again

185
00:06:04,639 --> 00:06:06,880
aws cloudflare

186
00:06:06,880 --> 00:06:08,880
so most of it was like isps also

187
00:06:08,880 --> 00:06:10,880
businesses were like um corporate owned

188
00:06:10,880 --> 00:06:13,440
ip ranges and then like the geographic

189
00:06:13,440 --> 00:06:15,680
spread so the us was at the top mostly

190
00:06:15,680 --> 00:06:16,880
because the vulnerability came out of

191
00:06:16,880 --> 00:06:18,560
u.s time so a lot of people are going to

192
00:06:18,560 --> 00:06:20,960
execute things we're in that it was in

193
00:06:20,960 --> 00:06:22,560
working penguin

194
00:06:22,560 --> 00:06:26,160
china germany um foreign hong kong

195
00:06:26,160 --> 00:06:28,319
belgium in the top 10 russia and ukraine

196
00:06:28,319 --> 00:06:29,360
were in there but that's a bit of a

197
00:06:29,360 --> 00:06:30,639
touchy subject at the moment so i'm not

198
00:06:30,639 --> 00:06:32,000
going to talk about it

199
00:06:32,000 --> 00:06:33,919
um all i'm going to say is before at

200
00:06:33,919 --> 00:06:36,240
night i wouldn't

201
00:06:36,240 --> 00:06:39,600
so auto poc what is it

202
00:06:39,600 --> 00:06:41,600
essentially it's an automated creation

203
00:06:41,600 --> 00:06:43,680
of pocs proofs of concept it was

204
00:06:43,680 --> 00:06:45,680
designed initially to pull every couple

205
00:06:45,680 --> 00:06:47,360
of days because cvs get released all the

206
00:06:47,360 --> 00:06:49,440
time you hear about the cbs s10 so that

207
00:06:49,440 --> 00:06:51,440
the criticals like rare they're like one

208
00:06:51,440 --> 00:06:52,960
once in a while

209
00:06:52,960 --> 00:06:55,280
or they come about now and again but

210
00:06:55,280 --> 00:06:57,840
i kind of originally i designed it so

211
00:06:57,840 --> 00:07:00,160
that it would pull for a cv cvs test

212
00:07:00,160 --> 00:07:02,160
score of like seven and above so like

213
00:07:02,160 --> 00:07:04,240
high risk to critical risk but then

214
00:07:04,240 --> 00:07:05,840
because there were so many

215
00:07:05,840 --> 00:07:06,960
vulnerabilities coming out i was like

216
00:07:06,960 --> 00:07:08,560
you know what i'll just do it from zero

217
00:07:08,560 --> 00:07:10,000
to ten because what's the worst that

218
00:07:10,000 --> 00:07:12,720
could happen in a day it generated fifty

219
00:07:12,720 --> 00:07:15,199
thousand um pocs because that's like put

220
00:07:15,199 --> 00:07:17,039
a semicolon in the wrong place said to

221
00:07:17,039 --> 00:07:18,479
like fix that

222
00:07:18,479 --> 00:07:19,599
um

223
00:07:19,599 --> 00:07:21,599
and kind of because the first and second

224
00:07:21,599 --> 00:07:24,240
and third honey pocs were kind of trolls

225
00:07:24,240 --> 00:07:25,680
this was just taking trolling to the

226
00:07:25,680 --> 00:07:26,960
next level

227
00:07:26,960 --> 00:07:29,520
so how does it actually work the script

228
00:07:29,520 --> 00:07:31,919
itself calls for cves for a database url

229
00:07:31,919 --> 00:07:34,800
so micro release cvs um usually they are

230
00:07:34,800 --> 00:07:36,880
pre-reserved so you can if you find the

231
00:07:36,880 --> 00:07:38,639
fun ability you can remote report it to

232
00:07:38,639 --> 00:07:41,199
the vendor responsibly disposed contact

233
00:07:41,199 --> 00:07:43,280
mitre request the cve and then you get

234
00:07:43,280 --> 00:07:45,120
like your cv number so you get like cv

235
00:07:45,120 --> 00:07:48,240
202 137 and that would be reserved for

236
00:07:48,240 --> 00:07:50,560
until the vendor patches

237
00:07:50,560 --> 00:07:52,639
and what might do is they list these on

238
00:07:52,639 --> 00:07:54,560
so you can actually go into miner and

239
00:07:54,560 --> 00:07:56,160
there's actually they're all listed so

240
00:07:56,160 --> 00:07:59,280
you can just be like i'll select cbe 20

241
00:07:59,280 --> 00:08:01,440
15 20 or whatever and that will

242
00:08:01,440 --> 00:08:03,280
eventually be available in something so

243
00:08:03,280 --> 00:08:04,800
i was pulling these all down drop them

244
00:08:04,800 --> 00:08:07,199
into database and then creating a git

245
00:08:07,199 --> 00:08:08,479
repo for them because this is where it

246
00:08:08,479 --> 00:08:09,840
gets a little bit

247
00:08:09,840 --> 00:08:11,759
questionable and sketchy but fun and so

248
00:08:11,759 --> 00:08:13,199
i wasn't forcing people to run these

249
00:08:13,199 --> 00:08:15,199
things i was putting them on github and

250
00:08:15,199 --> 00:08:16,720
people were downloading themselves and

251
00:08:16,720 --> 00:08:18,800
running them and

252
00:08:18,800 --> 00:08:21,120
getting trolled um

253
00:08:21,120 --> 00:08:22,800
so yeah create a get repo push the

254
00:08:22,800 --> 00:08:24,560
updates the repo so in the report it had

255
00:08:24,560 --> 00:08:26,160
a template for the file so the template

256
00:08:26,160 --> 00:08:28,000
was a windows binary a linux binary and

257
00:08:28,000 --> 00:08:30,400
a readme and it had pre-populated text

258
00:08:30,400 --> 00:08:31,840
so what i would do is it pull from the

259
00:08:31,840 --> 00:08:34,640
buyer website the text so if the cve

260
00:08:34,640 --> 00:08:36,479
wasn't reserved so if it didn't have

261
00:08:36,479 --> 00:08:37,519
reserved and it just actually had

262
00:08:37,519 --> 00:08:38,880
details about the vulnerability it

263
00:08:38,880 --> 00:08:40,559
pulled that blur and put it in so if you

264
00:08:40,559 --> 00:08:41,919
were searching github for the

265
00:08:41,919 --> 00:08:43,120
vulnerability it would give you the

266
00:08:43,120 --> 00:08:44,959
description but oh this looks legitimate

267
00:08:44,959 --> 00:08:46,640
it's a random binary on github i'm sure

268
00:08:46,640 --> 00:08:48,160
it's fine

269
00:08:48,160 --> 00:08:49,360
what i would do then is it would

270
00:08:49,360 --> 00:08:50,560
actually build from templates so i'm

271
00:08:50,560 --> 00:08:52,000
going to actually talk about the source

272
00:08:52,000 --> 00:08:53,360
code a little bit more in depth which i

273
00:08:53,360 --> 00:08:55,200
didn't talk about in london because um i

274
00:08:55,200 --> 00:08:56,320
didn't really have enough time because

275
00:08:56,320 --> 00:08:58,480
blasting data people this is a bit more

276
00:08:58,480 --> 00:09:00,800
in depth and once it built it it would

277
00:09:00,800 --> 00:09:03,200
then drop the cve and the canary id so

278
00:09:03,200 --> 00:09:05,519
canary thanks canary um

279
00:09:05,519 --> 00:09:07,200
kindly gave me access to their premium

280
00:09:07,200 --> 00:09:10,160
api which enabled me to generate and i

281
00:09:10,160 --> 00:09:12,160
think it was like a hundred million um

282
00:09:12,160 --> 00:09:14,320
canary urls and use 100 million but i

283
00:09:14,320 --> 00:09:16,080
had the ability to generate 100 million

284
00:09:16,080 --> 00:09:17,279
and

285
00:09:17,279 --> 00:09:19,360
and each of them was unique and embedded

286
00:09:19,360 --> 00:09:20,480
so every time i got a notification of

287
00:09:20,480 --> 00:09:22,640
your unique url just just for fun and

288
00:09:22,640 --> 00:09:24,160
then kind of the the stage after that

289
00:09:24,160 --> 00:09:26,080
was like kind of disinformation side so

290
00:09:26,080 --> 00:09:27,360
by talking says london was

291
00:09:27,360 --> 00:09:29,040
disinformation as a service and the

292
00:09:29,040 --> 00:09:31,440
distant information was automated

293
00:09:31,440 --> 00:09:34,640
uploads to github pay spend go spin and

294
00:09:34,640 --> 00:09:36,160
tweeting out from random twitter

295
00:09:36,160 --> 00:09:39,440
accounts so i worked out um using uh

296
00:09:39,440 --> 00:09:41,279
what's called phantomj i suggest to

297
00:09:41,279 --> 00:09:43,760
create um twitter accounts and github

298
00:09:43,760 --> 00:09:46,320
accounts which is kind of a bypass of

299
00:09:46,320 --> 00:09:49,040
a break of the tlc misfit um

300
00:09:49,040 --> 00:09:51,120
once it done it all it would then email

301
00:09:51,120 --> 00:09:52,959
me to tell me that the plc be created

302
00:09:52,959 --> 00:09:54,000
and then it would

303
00:09:54,000 --> 00:09:56,160
kind of log each time it'd be created

304
00:09:56,160 --> 00:09:57,440
and so each time it'd been run

305
00:09:57,440 --> 00:09:58,880
everything was run and then send me a

306
00:09:58,880 --> 00:10:00,000
slight notification because i set up a

307
00:10:00,000 --> 00:10:01,760
slight channel several love slack with a

308
00:10:01,760 --> 00:10:03,360
web hook and i'll show you an

309
00:10:03,360 --> 00:10:05,519
example of that later on as to like what

310
00:10:05,519 --> 00:10:08,000
information will give me

311
00:10:08,000 --> 00:10:10,240
in terms of the templates so

312
00:10:10,240 --> 00:10:11,440
you had windows and linux because i

313
00:10:11,440 --> 00:10:13,360
wanted to cover the two main i mean you

314
00:10:13,360 --> 00:10:15,519
have mac os but like

315
00:10:15,519 --> 00:10:17,519
it's quite hard to exploit mac os and

316
00:10:17,519 --> 00:10:19,279
it's quite hard to like automate stuff

317
00:10:19,279 --> 00:10:21,040
because apple are actually all right at

318
00:10:21,040 --> 00:10:22,720
security they've got like you know wild

319
00:10:22,720 --> 00:10:23,760
garden reports so you need to have

320
00:10:23,760 --> 00:10:25,680
permissions to do stuff to do anything

321
00:10:25,680 --> 00:10:27,200
if you want access to terminal you put

322
00:10:27,200 --> 00:10:28,480
yes

323
00:10:28,480 --> 00:10:30,240
so windows is much easier give someone

324
00:10:30,240 --> 00:10:32,079
an exe and they'll just run it apart

325
00:10:32,079 --> 00:10:33,360
from like smart screen which is like are

326
00:10:33,360 --> 00:10:34,880
you sure you want to run this binary

327
00:10:34,880 --> 00:10:37,360
from the internet and people use it

328
00:10:37,360 --> 00:10:38,880
and then the example we may just pull

329
00:10:38,880 --> 00:10:40,399
the information in

330
00:10:40,399 --> 00:10:42,240
the actual source code so this is going

331
00:10:42,240 --> 00:10:43,279
to be quite difficult to reach from the

332
00:10:43,279 --> 00:10:44,399
back but i'm going to talk you through

333
00:10:44,399 --> 00:10:46,959
it essentially this is the the windows

334
00:10:46,959 --> 00:10:49,600
template so the first thing up here is

335
00:10:49,600 --> 00:10:50,480
the

336
00:10:50,480 --> 00:10:53,040
url so this is a templated url which you

337
00:10:53,040 --> 00:10:54,079
pull in

338
00:10:54,079 --> 00:10:56,399
then it looks on the postings when it

339
00:10:56,399 --> 00:10:58,640
runs on a windows machine it looks for

340
00:10:58,640 --> 00:11:01,800
the username

341
00:11:12,240 --> 00:11:13,760
then what it does is it goes together

342
00:11:13,760 --> 00:11:15,760
the idea of things and carries them into

343
00:11:15,760 --> 00:11:18,079
a nice list of blocks

344
00:11:18,079 --> 00:11:20,240
again and then it puts it into base 32

345
00:11:20,240 --> 00:11:22,079
and that's still good about this

346
00:11:22,079 --> 00:11:24,079
the first part of the talk base 32 is

347
00:11:24,079 --> 00:11:25,920
chosen because a lot of the time when

348
00:11:25,920 --> 00:11:27,519
people work in secure operation etc they

349
00:11:27,519 --> 00:11:28,880
looked at stuff they'll ask basically

350
00:11:28,880 --> 00:11:30,640
and then decode it but

351
00:11:30,640 --> 00:11:32,480
less often they see based out through

352
00:11:32,480 --> 00:11:34,640
and basically it's another important

353
00:11:34,640 --> 00:11:36,240
format but a lot of proxies and a lot of

354
00:11:36,240 --> 00:11:37,920
like corporate firewalls just you just

355
00:11:37,920 --> 00:11:40,160
allow it through that yeah let's go so i

356
00:11:40,160 --> 00:11:43,040
use that to get data so arguably

357
00:11:43,040 --> 00:11:46,800
malware but not really um

358
00:11:46,800 --> 00:11:47,680
you know

359
00:11:47,680 --> 00:11:50,880
the the kind of sample the data so

360
00:11:50,880 --> 00:11:52,959
i showed a lot of data at bayside london

361
00:11:52,959 --> 00:11:54,240
and for this talk i didn't want to like

362
00:11:54,240 --> 00:11:55,680
dive too much into it so those are

363
00:11:55,680 --> 00:11:57,279
you've seen the bases on the top there

364
00:11:57,279 --> 00:11:59,120
are rehashes of the data here but in

365
00:11:59,120 --> 00:12:01,600
terms of the breakdown of like execution

366
00:12:01,600 --> 00:12:02,800
um

367
00:12:02,800 --> 00:12:04,959
blackness ideally we'd ask the lights

368
00:12:04,959 --> 00:12:06,240
off because blue on black is better to

369
00:12:06,240 --> 00:12:08,959
read the dark but essentially the 42 up

370
00:12:08,959 --> 00:12:10,720
there was threat intelligence companies

371
00:12:10,720 --> 00:12:12,079
um or as i like to call them cyber

372
00:12:12,079 --> 00:12:13,839
espionage companies because they just

373
00:12:13,839 --> 00:12:16,240
just run and pass it to people and

374
00:12:16,240 --> 00:12:18,079
20 of them was kind of opportunistic

375
00:12:18,079 --> 00:12:20,480
hackers so like um bug bounty hunters

376
00:12:20,480 --> 00:12:22,480
people looking for like i want to go and

377
00:12:22,480 --> 00:12:23,680
pop like

378
00:12:23,680 --> 00:12:26,320
a java server i want a good pop um

379
00:12:26,320 --> 00:12:27,920
a water filtration plan or something i

380
00:12:27,920 --> 00:12:29,839
just want to go to hack stuff and kind

381
00:12:29,839 --> 00:12:31,680
of 10 down there was like insider

382
00:12:31,680 --> 00:12:32,959
threats they were kind of what i

383
00:12:32,959 --> 00:12:34,720
classified as a genuine insider threats

384
00:12:34,720 --> 00:12:36,160
people inside of companies that are

385
00:12:36,160 --> 00:12:37,839
targeting systems not from a testing

386
00:12:37,839 --> 00:12:39,440
perspective but looking to gain like

387
00:12:39,440 --> 00:12:41,440
either financial move or whatever else

388
00:12:41,440 --> 00:12:43,680
and then the kind of 28 there are kind

389
00:12:43,680 --> 00:12:45,600
of random threat originally when i think

390
00:12:45,600 --> 00:12:46,959
it gave the talk in november i said well

391
00:12:46,959 --> 00:12:48,399
that wasn't sandbox traffic but i went

392
00:12:48,399 --> 00:12:49,760
back through the date a couple weeks ago

393
00:12:49,760 --> 00:12:52,000
in actual fact probably that's split

394
00:12:52,000 --> 00:12:56,079
about um 20 of it is just random data

395
00:12:56,079 --> 00:12:57,440
from all over the place in eight percent

396
00:12:57,440 --> 00:12:59,120
split sandboxes so quite a lot of them

397
00:12:59,120 --> 00:13:00,720
got uploaded to fire's tall as you can

398
00:13:00,720 --> 00:13:02,399
imagine find random binary for advanced

399
00:13:02,399 --> 00:13:04,720
total joe sandbox

400
00:13:04,720 --> 00:13:06,560
all the other sandbox sites so i got

401
00:13:06,560 --> 00:13:08,240
quite a lot of traffic but interesting

402
00:13:08,240 --> 00:13:10,880
enough by having them uploaded to those

403
00:13:10,880 --> 00:13:13,120
sites i was able to profile when i was

404
00:13:13,120 --> 00:13:15,279
getting traffic from sandboxes so

405
00:13:15,279 --> 00:13:17,600
because i worked red team as my day job

406
00:13:17,600 --> 00:13:19,440
i took all of the ips and all of the

407
00:13:19,440 --> 00:13:21,440
indicators have compromised from a virus

408
00:13:21,440 --> 00:13:23,360
total machine and built a blacklist or a

409
00:13:23,360 --> 00:13:25,360
deny list um

410
00:13:25,360 --> 00:13:27,600
for my first command control so every

411
00:13:27,600 --> 00:13:29,600
time we go into red teams now we've got

412
00:13:29,600 --> 00:13:31,680
denialists for sandboxes and sandbox

413
00:13:31,680 --> 00:13:34,000
detection not the typical sandbox

414
00:13:34,000 --> 00:13:36,480
detection for malware but at a network

415
00:13:36,480 --> 00:13:37,680
level so we're not even getting

416
00:13:37,680 --> 00:13:39,600
pingbacks from malwa which is great it's

417
00:13:39,600 --> 00:13:41,040
kind of a

418
00:13:41,040 --> 00:13:43,120
bit of a win um

419
00:13:43,120 --> 00:13:44,880
yeah it was quite quite interesting you

420
00:13:44,880 --> 00:13:46,240
could probably say that this is a bit

421
00:13:46,240 --> 00:13:50,480
better but the intent wasn't to um

422
00:13:50,480 --> 00:13:52,079
the intent wasn't too

423
00:13:52,079 --> 00:13:53,760
to be malicious it was to with

424
00:13:53,760 --> 00:13:55,839
people in a good way

425
00:13:55,839 --> 00:13:57,040
um

426
00:13:57,040 --> 00:13:59,199
so

427
00:14:00,160 --> 00:14:02,880
yeah sort of but

428
00:14:02,880 --> 00:14:04,560
i mean you can with people in a bad

429
00:14:04,560 --> 00:14:05,680
way and you can people in a good

430
00:14:05,680 --> 00:14:06,880
way and i'm going to go with this isn't

431
00:14:06,880 --> 00:14:08,959
a good way

432
00:14:08,959 --> 00:14:11,440
your mileage may vary

433
00:14:11,440 --> 00:14:13,519
this is really bad data because you're

434
00:14:13,519 --> 00:14:15,199
going to see it but this is more of the

435
00:14:15,199 --> 00:14:17,760
data that i got from harry poc now

436
00:14:17,760 --> 00:14:18,959
you'll see here that there's only one

437
00:14:18,959 --> 00:14:20,959
things i pieced because when i was doing

438
00:14:20,959 --> 00:14:23,199
this and fill in all of the data

439
00:14:23,199 --> 00:14:24,880
primarily because the graph would have

440
00:14:24,880 --> 00:14:26,240
been like over here because there was so

441
00:14:26,240 --> 00:14:28,160
much of it but again the us was at the

442
00:14:28,160 --> 00:14:30,959
top china germany russia there we go

443
00:14:30,959 --> 00:14:32,800
over there

444
00:14:32,800 --> 00:14:34,720
and then i said he's broken down so this

445
00:14:34,720 --> 00:14:36,240
this chart here from a company called

446
00:14:36,240 --> 00:14:38,800
ibm dot io and

447
00:14:38,800 --> 00:14:40,720
they have free graphing available you

448
00:14:40,720 --> 00:14:43,040
can drop in i think it's about a million

449
00:14:43,040 --> 00:14:44,160
they'll allow you to like give you

450
00:14:44,160 --> 00:14:45,279
geography

451
00:14:45,279 --> 00:14:47,519
information asa information ranges all

452
00:14:47,519 --> 00:14:49,600
that sort of stuff and the kind of

453
00:14:49,600 --> 00:14:51,600
interesting stuff that i found was like

454
00:14:51,600 --> 00:14:53,920
up here in essence when i did the piece

455
00:14:53,920 --> 00:14:55,360
of london talk i was like well i don't

456
00:14:55,360 --> 00:14:56,560
really know whether obviously you're

457
00:14:56,560 --> 00:14:58,399
going with in china but i didn't know

458
00:14:58,399 --> 00:15:00,320
what this one was and someone came up to

459
00:15:00,320 --> 00:15:01,360
me afterwards and went well that's

460
00:15:01,360 --> 00:15:03,279
mulvane vpn i was like that makes a lot

461
00:15:03,279 --> 00:15:05,680
more sense i started looking up and a

462
00:15:05,680 --> 00:15:08,000
lot of the traffic that i was seeing in

463
00:15:08,000 --> 00:15:10,399
the data set was from vpn which kind of

464
00:15:10,399 --> 00:15:11,600
makes sense because when you're going to

465
00:15:11,600 --> 00:15:12,880
run valor of course you want to run it

466
00:15:12,880 --> 00:15:15,439
from dpn

467
00:15:15,680 --> 00:15:16,560
but

468
00:15:16,560 --> 00:15:17,600
that's then

469
00:15:17,600 --> 00:15:19,360
that was also quite interesting so like

470
00:15:19,360 --> 00:15:22,160
the post times when i was grabbing them

471
00:15:22,160 --> 00:15:24,720
um if it was coming from a link system

472
00:15:24,720 --> 00:15:27,199
that was not ubuntu or debian based the

473
00:15:27,199 --> 00:15:28,160
whole thing would come back with null

474
00:15:28,160 --> 00:15:30,320
absolutely red hat centos couldn't work

475
00:15:30,320 --> 00:15:32,399
out why some of them worked out today

476
00:15:32,399 --> 00:15:34,880
but i will do analysis at some point and

477
00:15:34,880 --> 00:15:35,920
work out

478
00:15:35,920 --> 00:15:38,079
and other interesting ips that aren't up

479
00:15:38,079 --> 00:15:40,720
here there was a lot of um i want to see

480
00:15:40,720 --> 00:15:43,279
front companies that i found so in my

481
00:15:43,279 --> 00:15:45,199
basis london talk i talked about

482
00:15:45,199 --> 00:15:47,199
identifying companies that were threat

483
00:15:47,199 --> 00:15:49,360
actor fronts and i looked into this a

484
00:15:49,360 --> 00:15:50,959
bit more and spoke to a lot of friends

485
00:15:50,959 --> 00:15:52,720
that are really good at excel also known

486
00:15:52,720 --> 00:15:54,959
as cti specialists

487
00:15:54,959 --> 00:15:57,120
have intelligence specialists or excel

488
00:15:57,120 --> 00:15:58,480
wizards

489
00:15:58,480 --> 00:16:00,720
and i spoke to those guys but i was like

490
00:16:00,720 --> 00:16:02,320
these are really interesting ips these

491
00:16:02,320 --> 00:16:03,600
are really interesting host names like

492
00:16:03,600 --> 00:16:04,880
what's going on they went oh well that's

493
00:16:04,880 --> 00:16:07,360
china that's um israel i was like

494
00:16:07,360 --> 00:16:09,120
alright that's pretty cool and then one

495
00:16:09,120 --> 00:16:10,560
of the guys like dialed down there he

496
00:16:10,560 --> 00:16:12,480
was like yeah that's a front for this

497
00:16:12,480 --> 00:16:14,720
specific threat group i was like

498
00:16:14,720 --> 00:16:16,240
okay i'm not going to touch that anymore

499
00:16:16,240 --> 00:16:17,279
i'll just leave it he's like yeah you've

500
00:16:17,279 --> 00:16:19,279
got like 100 hits from that

501
00:16:19,279 --> 00:16:20,480
probably don't want to touch that

502
00:16:20,480 --> 00:16:22,399
because that looks sketchy as i was

503
00:16:22,399 --> 00:16:23,920
like okay yep

504
00:16:23,920 --> 00:16:24,959
not gonna

505
00:16:24,959 --> 00:16:26,399
i'm not gonna do that

506
00:16:26,399 --> 00:16:28,880
so talking about insider threats um the

507
00:16:28,880 --> 00:16:30,560
king of insiders were quite interested

508
00:16:30,560 --> 00:16:32,880
so when i was talking about the software

509
00:16:32,880 --> 00:16:35,199
earlier on and the environmental

510
00:16:35,199 --> 00:16:36,560
variables that was graphic i've got

511
00:16:36,560 --> 00:16:38,320
quite a lot of information that i didn't

512
00:16:38,320 --> 00:16:40,800
think i wanted well

513
00:16:40,800 --> 00:16:42,639
yeah probably shouldn't want so i've got

514
00:16:42,639 --> 00:16:44,800
quite a lot of get tokens so people that

515
00:16:44,800 --> 00:16:46,160
store their

516
00:16:46,160 --> 00:16:48,320
um kind of private keys for github to

517
00:16:48,320 --> 00:16:49,920
upload stuff to repositories for

518
00:16:49,920 --> 00:16:52,720
internal corporate and like etc i got a

519
00:16:52,720 --> 00:16:54,639
lot of credential leads so

520
00:16:54,639 --> 00:16:56,399
surprisingly on windows a lot of people

521
00:16:56,399 --> 00:16:58,480
store um like the main credentials in

522
00:16:58,480 --> 00:17:00,240
the powershell environmental variables

523
00:17:00,240 --> 00:17:01,920
and my buyer would pull them in and send

524
00:17:01,920 --> 00:17:03,839
them to me which was

525
00:17:03,839 --> 00:17:05,599
interesting people have some interesting

526
00:17:05,599 --> 00:17:08,000
passive choices and also what i worked

527
00:17:08,000 --> 00:17:09,280
out from there was corporate password

528
00:17:09,280 --> 00:17:12,160
policies because um the the bigger the

529
00:17:12,160 --> 00:17:14,160
based on a few data obviously the more

530
00:17:14,160 --> 00:17:15,199
the other is going to be in there and

531
00:17:15,199 --> 00:17:18,880
there was one that came in the gigabyte

532
00:17:19,919 --> 00:17:21,359
somebody's environmental labels had

533
00:17:21,359 --> 00:17:23,439
their entire like corporate pipeline of

534
00:17:23,439 --> 00:17:26,240
like uploads so like uh don't know what

535
00:17:26,240 --> 00:17:27,520
the word for it but basically they're

536
00:17:27,520 --> 00:17:28,799
they're filled pipeline uploading stuff

537
00:17:28,799 --> 00:17:30,799
within their environmental videos i

538
00:17:30,799 --> 00:17:32,320
don't know why contact the company i was

539
00:17:32,320 --> 00:17:34,080
like large you might want to

540
00:17:34,080 --> 00:17:36,240
not do this or maybe check why this was

541
00:17:36,240 --> 00:17:37,760
running they never go back to it so like

542
00:17:37,760 --> 00:17:39,039
okay well that's your problem i'm not

543
00:17:39,039 --> 00:17:40,400
going to name you because i'm not dead

544
00:17:40,400 --> 00:17:41,760
but

545
00:17:41,760 --> 00:17:44,480
i'm a dick but i'm not going to need you

546
00:17:44,480 --> 00:17:47,120
a lot of intel domain names

547
00:17:47,120 --> 00:17:48,240
kind of standard that was in the

548
00:17:48,240 --> 00:17:50,480
hostname per hour um internal username

549
00:17:50,480 --> 00:17:51,919
product internal tooling now this was

550
00:17:51,919 --> 00:17:53,360
quite interesting because i was

551
00:17:53,360 --> 00:17:55,120
profiling sandboxes i was working out

552
00:17:55,120 --> 00:17:57,200
what things were landing into

553
00:17:57,200 --> 00:17:59,120
i was finding quite a lot of information

554
00:17:59,120 --> 00:18:00,960
regarding like how people are scanning

555
00:18:00,960 --> 00:18:03,919
things so like random user agents random

556
00:18:03,919 --> 00:18:06,480
ips random like host names random

557
00:18:06,480 --> 00:18:08,240
formats in the environment variables and

558
00:18:08,240 --> 00:18:10,240
everything in between and then kind of

559
00:18:10,240 --> 00:18:12,160
mentally interesting stuff so

560
00:18:12,160 --> 00:18:13,200
and

561
00:18:13,200 --> 00:18:14,480
we'll talk about later on about like

562
00:18:14,480 --> 00:18:16,160
scattered stuff but i still told my

563
00:18:16,160 --> 00:18:17,760
colleagues who it specializes in like

564
00:18:17,760 --> 00:18:19,200
industrial control systems and i was

565
00:18:19,200 --> 00:18:20,960
like what are these things i was getting

566
00:18:20,960 --> 00:18:22,960
like random like strings of binary

567
00:18:22,960 --> 00:18:24,960
values like oh they're from like plc's i

568
00:18:24,960 --> 00:18:25,760
was like

569
00:18:25,760 --> 00:18:27,600
what are people doing running binaries

570
00:18:27,600 --> 00:18:28,960
from github

571
00:18:28,960 --> 00:18:30,480
on plcs

572
00:18:30,480 --> 00:18:32,400
it's like i don't know go and look into

573
00:18:32,400 --> 00:18:33,679
it and i looked into it and it was

574
00:18:33,679 --> 00:18:35,520
people so there was a founder that came

575
00:18:35,520 --> 00:18:37,760
out in um siemens

576
00:18:37,760 --> 00:18:40,760
plc's

577
00:18:45,919 --> 00:18:48,160
and it affected windows so as a result

578
00:18:48,160 --> 00:18:50,080
that the windows buy it was on github

579
00:18:50,080 --> 00:18:50,960
and

580
00:18:50,960 --> 00:18:53,360
almost all of the filtration plants

581
00:18:53,360 --> 00:18:54,880
around about the middle east just down

582
00:18:54,880 --> 00:18:56,640
the spine and ran it they must have like

583
00:18:56,640 --> 00:18:57,919
a group they're like oh go and run this

584
00:18:57,919 --> 00:18:59,600
thing it's fine and i found out a lot

585
00:18:59,600 --> 00:19:01,360
about how the scene worked it was it was

586
00:19:01,360 --> 00:19:04,320
incredibly interesting and and

587
00:19:04,320 --> 00:19:06,320
questionable as to the realities of it

588
00:19:06,320 --> 00:19:07,200
but

589
00:19:07,200 --> 00:19:10,960
i wasn't out taking the information

590
00:19:13,440 --> 00:19:14,400
and

591
00:19:14,400 --> 00:19:15,600
i was not going to learn about like

592
00:19:15,600 --> 00:19:16,640
profiling

593
00:19:16,640 --> 00:19:17,760
so these are kind of collection

594
00:19:17,760 --> 00:19:19,840
environmental scenes that i found and

595
00:19:19,840 --> 00:19:22,000
generally speaking if you are in red or

596
00:19:22,000 --> 00:19:23,840
blue for that matter if you see these

597
00:19:23,840 --> 00:19:26,320
host names probably be versatile and

598
00:19:26,320 --> 00:19:27,760
almost always they're going to first

599
00:19:27,760 --> 00:19:30,480
head again would be like either um when

600
00:19:30,480 --> 00:19:32,400
and then like a random string or like

601
00:19:32,400 --> 00:19:33,360
john b

602
00:19:33,360 --> 00:19:35,840
dc walker pc um

603
00:19:35,840 --> 00:19:37,039
and that was a kind of indication that

604
00:19:37,039 --> 00:19:38,640
well it's been probably the parish total

605
00:19:38,640 --> 00:19:40,880
but even more interesting so when you

606
00:19:40,880 --> 00:19:42,480
upload something to virustotal it runs

607
00:19:42,480 --> 00:19:44,559
once and does like a bunch of checks

608
00:19:44,559 --> 00:19:45,919
they don't run a couple of days later

609
00:19:45,919 --> 00:19:47,200
they're run a month later they're

610
00:19:47,200 --> 00:19:48,720
running a couple of couple but it hasn't

611
00:19:48,720 --> 00:19:50,400
done a hosting hp but it's the same ip

612
00:19:50,400 --> 00:19:52,080
address it's the same user issues a

613
00:19:52,080 --> 00:19:53,919
bunch of other same things so i started

614
00:19:53,919 --> 00:19:55,280
to profile that a bit more and i've

615
00:19:55,280 --> 00:19:56,880
worked out how virus total do things so

616
00:19:56,880 --> 00:19:58,640
they basically spin up like a windows 7

617
00:19:58,640 --> 00:20:00,799
or windows 10 vm they run it they sleep

618
00:20:00,799 --> 00:20:02,320
it for like a month or something they

619
00:20:02,320 --> 00:20:03,520
wake it back up again and run the

620
00:20:03,520 --> 00:20:05,360
malware again if you upload it to

621
00:20:05,360 --> 00:20:07,200
virtual enterprise it does some other

622
00:20:07,200 --> 00:20:09,919
stuff so it runs on like a range of vms

623
00:20:09,919 --> 00:20:11,039
which i didn't know before which is

624
00:20:11,039 --> 00:20:12,559
pretty interesting i was chatting to

625
00:20:12,559 --> 00:20:14,000
someone who works in like the tech

626
00:20:14,000 --> 00:20:15,760
engineering yeah it does all this stuff

627
00:20:15,760 --> 00:20:17,360
but it also spins up like clusters of

628
00:20:17,360 --> 00:20:19,440
other ships so like if you've uploaded

629
00:20:19,440 --> 00:20:20,559
like a biome that could be running

630
00:20:20,559 --> 00:20:22,320
windows and like linux for example

631
00:20:22,320 --> 00:20:23,520
absolutely

632
00:20:23,520 --> 00:20:26,640
like a gold wire or whatever and

633
00:20:26,640 --> 00:20:28,640
you would get like when payments are

634
00:20:28,640 --> 00:20:29,919
trying it and it worked but i didn't

635
00:20:29,919 --> 00:20:31,280
like didn't do it for a while so you

636
00:20:31,280 --> 00:20:33,679
perspective just out of interest so yeah

637
00:20:33,679 --> 00:20:35,200
if it's looks pretty interesting it's

638
00:20:35,200 --> 00:20:36,400
probably going to be a project that i'm

639
00:20:36,400 --> 00:20:38,240
going to do later on at some point like

640
00:20:38,240 --> 00:20:40,559
i built a tool um off the back of this

641
00:20:40,559 --> 00:20:41,919
called sandbox style which i might

642
00:20:41,919 --> 00:20:43,760
release at some point which is for

643
00:20:43,760 --> 00:20:45,760
profiling sandbox and it uses the

644
00:20:45,760 --> 00:20:47,120
techniques that i've learned from honey

645
00:20:47,120 --> 00:20:49,919
poc to identify when it's in a sandbox

646
00:20:49,919 --> 00:20:52,320
and kind of tell you so

647
00:20:52,320 --> 00:20:53,760
going back to what's talking about learn

648
00:20:53,760 --> 00:20:55,520
being in red team and

649
00:20:55,520 --> 00:20:57,280
building detections for offensive

650
00:20:57,280 --> 00:20:59,200
tooling what sandbox buy does is you

651
00:20:59,200 --> 00:21:00,559
send it in first and it works out if

652
00:21:00,559 --> 00:21:02,080
it's going to land in sandbox which is

653
00:21:02,080 --> 00:21:04,799
most useful in like mail gateways so if

654
00:21:04,799 --> 00:21:06,880
you email like a like an iso in for

655
00:21:06,880 --> 00:21:09,120
example or an email link in which it's

656
00:21:09,120 --> 00:21:10,400
got html

657
00:21:10,400 --> 00:21:12,720
if that hits a mail gateway and sandbox

658
00:21:12,720 --> 00:21:14,240
file will go through the different steps

659
00:21:14,240 --> 00:21:16,080
and check what it's hidden and once it

660
00:21:16,080 --> 00:21:17,840
hits a sandbox it'll ping back

661
00:21:17,840 --> 00:21:19,360
immediately over dns and be like this is

662
00:21:19,360 --> 00:21:22,240
a sandbox like bit bit off or these are

663
00:21:22,240 --> 00:21:24,320
the steps that i've got to so if it's

664
00:21:24,320 --> 00:21:26,000
got far after the list it's like right

665
00:21:26,000 --> 00:21:27,600
okay you're allowed to get hd like

666
00:21:27,600 --> 00:21:30,000
basically it does like excel testing and

667
00:21:30,000 --> 00:21:31,280
if you can get dns out if you can get

668
00:21:31,280 --> 00:21:33,520
smtp out if you get http out if you can

669
00:21:33,520 --> 00:21:34,240
get

670
00:21:34,240 --> 00:21:36,080
s basically all the the kind of main

671
00:21:36,080 --> 00:21:37,919
profiles would try it tries them and if

672
00:21:37,919 --> 00:21:39,440
as soon as it gets ahead of them it

673
00:21:39,440 --> 00:21:40,640
stores it and then when it starts

674
00:21:40,640 --> 00:21:41,760
getting hits it goes right up here i've

675
00:21:41,760 --> 00:21:43,520
got them and sends it off to me

676
00:21:43,520 --> 00:21:46,080
which is quite an interesting project i

677
00:21:46,080 --> 00:21:47,760
might present at another conference i

678
00:21:47,760 --> 00:21:49,760
might release it i'm not sure but the

679
00:21:49,760 --> 00:21:52,159
auto poc framework i probably will never

680
00:21:52,159 --> 00:21:53,520
release because it's like really

681
00:21:53,520 --> 00:21:55,280
dangerous on its own and because

682
00:21:55,280 --> 00:21:57,360
basically anyone can plug their own

683
00:21:57,360 --> 00:21:59,600
stuff into it and just release plcs so

684
00:21:59,600 --> 00:22:01,600
i've got the framework about happy to

685
00:22:01,600 --> 00:22:02,880
show people but i don't want to release

686
00:22:02,880 --> 00:22:04,159
it because

687
00:22:04,159 --> 00:22:07,120
um yeah this information it's not a fun

688
00:22:07,120 --> 00:22:08,559
place to be

689
00:22:08,559 --> 00:22:11,440
um so log4j offer jay was accidental

690
00:22:11,440 --> 00:22:13,679
canaries what happened was when log4j

691
00:22:13,679 --> 00:22:15,360
came out um my colleagues and i were

692
00:22:15,360 --> 00:22:17,200
working on process concepts get things

693
00:22:17,200 --> 00:22:19,039
working like okay we want to prove that

694
00:22:19,039 --> 00:22:21,760
log4j is affected by command execution

695
00:22:21,760 --> 00:22:24,080
or um something else like blind blind

696
00:22:24,080 --> 00:22:26,400
command execution so i generated a bunch

697
00:22:26,400 --> 00:22:29,360
of proofs of concept urls of if you

698
00:22:29,360 --> 00:22:31,760
execute this jndi

699
00:22:31,760 --> 00:22:34,080
whatever and then the url it will send

700
00:22:34,080 --> 00:22:36,080
your ping back over to the ass for http

701
00:22:36,080 --> 00:22:38,400
or whatever else um

702
00:22:38,400 --> 00:22:40,159
and that was that was designed purely to

703
00:22:40,159 --> 00:22:42,320
work out if things were vulnerable and

704
00:22:42,320 --> 00:22:43,919
because i was doing blind command

705
00:22:43,919 --> 00:22:45,600
execution i was putting like i was

706
00:22:45,600 --> 00:22:47,679
basically chaining um commands together

707
00:22:47,679 --> 00:22:48,960
so it started off with hostname and i

708
00:22:48,960 --> 00:22:50,240
was like okay i'm getting some hits back

709
00:22:50,240 --> 00:22:52,480
to that then environmental variables i

710
00:22:52,480 --> 00:22:54,320
just got to put actual command execution

711
00:22:54,320 --> 00:22:56,000
into like dollar open bracket and like

712
00:22:56,000 --> 00:22:59,200
about one liner command obviously base64

713
00:22:59,200 --> 00:23:00,159
so when it was running it was gonna

714
00:23:00,159 --> 00:23:02,320
basically basically run it and this was

715
00:23:02,320 --> 00:23:04,360
purely for my own detection and kind of

716
00:23:04,360 --> 00:23:06,960
identification things and a lot of the

717
00:23:06,960 --> 00:23:09,600
kind of defensive guys on twitter have

718
00:23:09,600 --> 00:23:11,280
have me blocked because they're funny pc

719
00:23:11,280 --> 00:23:12,640
but one of them picked up a retreat they

720
00:23:12,640 --> 00:23:14,000
went this is a really good idea but in

721
00:23:14,000 --> 00:23:16,640
block capitals please change the url

722
00:23:16,640 --> 00:23:18,320
because it's malicious which is fair

723
00:23:18,320 --> 00:23:20,480
enough it is people didn't listen they

724
00:23:20,480 --> 00:23:23,360
still ran it and i got about maybe

725
00:23:23,360 --> 00:23:25,280
four or five thousand hits from log4j

726
00:23:25,280 --> 00:23:28,320
alone and of legitimate insider post

727
00:23:28,320 --> 00:23:30,799
names and things um that wasn't meant to

728
00:23:30,799 --> 00:23:32,799
be malicious like well not much sorry

729
00:23:32,799 --> 00:23:34,400
that wasn't meant to be a troll that was

730
00:23:34,400 --> 00:23:35,840
meant it was me trying to help the

731
00:23:35,840 --> 00:23:37,360
community but people don't trust me

732
00:23:37,360 --> 00:23:39,840
anymore for some reason

733
00:23:39,840 --> 00:23:40,960
um

734
00:23:40,960 --> 00:23:42,240
so

735
00:23:42,240 --> 00:23:43,039
yeah

736
00:23:43,039 --> 00:23:46,480
so talked about water filtration

737
00:23:46,480 --> 00:23:48,960
the kind of most common insider

738
00:23:48,960 --> 00:23:51,600
interesting things so scatter

739
00:23:51,600 --> 00:23:53,919
for industrial control systems i found a

740
00:23:53,919 --> 00:23:56,400
lot of water filtration plants and a lot

741
00:23:56,400 --> 00:23:58,240
of them were in israel which was a bit

742
00:23:58,240 --> 00:24:00,000
scary because

743
00:24:00,000 --> 00:24:01,520
some of the ping backs were from

744
00:24:01,520 --> 00:24:04,480
questionable sources and quite ip ranges

745
00:24:04,480 --> 00:24:07,360
um of certain intelligence services

746
00:24:07,360 --> 00:24:09,919
and like all of the vulnerabilities that

747
00:24:09,919 --> 00:24:12,080
affect the scada they happen to be

748
00:24:12,080 --> 00:24:14,960
either water filtration or some of them

749
00:24:14,960 --> 00:24:19,279
were like manufacturing lines so like on

750
00:24:19,279 --> 00:24:20,799
a imagine automatic fashion line they'll

751
00:24:20,799 --> 00:24:22,640
have like the they'll have the control

752
00:24:22,640 --> 00:24:23,840
system and they'll have like a windows

753
00:24:23,840 --> 00:24:25,679
pc like here for example and this will

754
00:24:25,679 --> 00:24:27,760
be used to interface with the

755
00:24:27,760 --> 00:24:30,000
production line and what i found was on

756
00:24:30,000 --> 00:24:31,200
the the

757
00:24:31,200 --> 00:24:33,360
connect machine the data that i was

758
00:24:33,360 --> 00:24:34,559
getting or the telemetry i was getting

759
00:24:34,559 --> 00:24:36,799
back was kind of

760
00:24:36,799 --> 00:24:39,679
very relevant to what it was in so if it

761
00:24:39,679 --> 00:24:41,440
was not connected to a corporate network

762
00:24:41,440 --> 00:24:42,720
it would have some sort of bridge

763
00:24:42,720 --> 00:24:43,760
somewhere that had an environmental

764
00:24:43,760 --> 00:24:45,960
variable to say i'm actually part of

765
00:24:45,960 --> 00:24:48,320
abertay.local whatever i get pinned back

766
00:24:48,320 --> 00:24:50,480
about them that's what's strange and

767
00:24:50,480 --> 00:24:51,919
windows i got

768
00:24:51,919 --> 00:24:54,000
like all almost all the endpoints

769
00:24:54,000 --> 00:24:55,919
running were windows the kind of more

770
00:24:55,919 --> 00:24:58,880
interesting ones where i got like 15 000

771
00:24:58,880 --> 00:25:00,720
windows two thousand boxes pinned back

772
00:25:00,720 --> 00:25:02,960
three and i'm like i can't be right like

773
00:25:02,960 --> 00:25:06,240
2021 2022 20 years later but then you go

774
00:25:06,240 --> 00:25:07,520
into cloud environments you'll actually

775
00:25:07,520 --> 00:25:09,279
know people sometimes this is rightly

776
00:25:09,279 --> 00:25:10,240
there's an environment a couple of

777
00:25:10,240 --> 00:25:12,960
months ago where the client had 58 000

778
00:25:12,960 --> 00:25:15,039
windows 2003 machines still on the

779
00:25:15,039 --> 00:25:17,360
network

780
00:25:18,640 --> 00:25:19,679
um

781
00:25:19,679 --> 00:25:22,000
it happens a lot of web face now so the

782
00:25:22,000 --> 00:25:24,799
later pocs that i generated um

783
00:25:24,799 --> 00:25:26,240
i started getting a bit more cheeky with

784
00:25:26,240 --> 00:25:27,360
the way in which i was developing things

785
00:25:27,360 --> 00:25:30,159
so getting a bit more away from trolling

786
00:25:30,159 --> 00:25:32,080
and more into kind of telemetry so i

787
00:25:32,080 --> 00:25:34,720
built a and go by that would then take

788
00:25:34,720 --> 00:25:36,400
screenshots when it was running so it

789
00:25:36,400 --> 00:25:38,000
would execute pull all the information

790
00:25:38,000 --> 00:25:39,200
for the whole thing the username

791
00:25:39,200 --> 00:25:40,880
environment available and then if it was

792
00:25:40,880 --> 00:25:42,880
in a kind of gui environment to take a

793
00:25:42,880 --> 00:25:44,880
screenshot and it would then basically

794
00:25:44,880 --> 00:25:46,159
before the screenshot and then basically

795
00:25:46,159 --> 00:25:47,600
through it and then hex it and then send

796
00:25:47,600 --> 00:25:48,960
out so as a result you're getting

797
00:25:48,960 --> 00:25:50,960
massive packets sent out network in a

798
00:25:50,960 --> 00:25:52,240
blueprint you'd be like oh that's a bit

799
00:25:52,240 --> 00:25:54,000
strange that's random buyers send out a

800
00:25:54,000 --> 00:25:56,640
gig of data but they still have and as a

801
00:25:56,640 --> 00:25:58,080
result i got a lot of interest in

802
00:25:58,080 --> 00:26:00,320
internal web applications that you would

803
00:26:00,320 --> 00:26:02,080
never really see so i found some kind of

804
00:26:02,080 --> 00:26:04,799
well a lot of plcs scatter stuff a lot

805
00:26:04,799 --> 00:26:07,039
of like really strange like intercom

806
00:26:07,039 --> 00:26:09,360
systems that people have and a lot of

807
00:26:09,360 --> 00:26:11,279
branded things as well so that's how i

808
00:26:11,279 --> 00:26:12,480
found a lot of instant requests

809
00:26:12,480 --> 00:26:14,320
initially because it was being run

810
00:26:14,320 --> 00:26:16,320
against applications about like my

811
00:26:16,320 --> 00:26:18,159
company logo and then like whatever the

812
00:26:18,159 --> 00:26:19,360
application is so i would contact the

813
00:26:19,360 --> 00:26:21,600
campaign i'd be like well i've found

814
00:26:21,600 --> 00:26:23,120
this this is this is the story it's like

815
00:26:23,120 --> 00:26:25,440
well i found this thing on your network

816
00:26:25,440 --> 00:26:26,880
and i can't really explain why i've got

817
00:26:26,880 --> 00:26:28,559
the details but someone's been running

818
00:26:28,559 --> 00:26:29,840
random in your network you probably

819
00:26:29,840 --> 00:26:31,679
should look into this when i got on a

820
00:26:31,679 --> 00:26:33,600
phone with an airline um with their blue

821
00:26:33,600 --> 00:26:34,640
team and i was like right this is the

822
00:26:34,640 --> 00:26:36,400
state of platelets someone's done with

823
00:26:36,400 --> 00:26:38,080
the binder and

824
00:26:38,080 --> 00:26:40,000
it's not malicious but sounds malicious

825
00:26:40,000 --> 00:26:41,039
and

826
00:26:41,039 --> 00:26:42,320
they've pointed at your internal

827
00:26:42,320 --> 00:26:43,840
infrastructure and it's not me but it's

828
00:26:43,840 --> 00:26:46,000
them um and i've got all the data but

829
00:26:46,000 --> 00:26:48,000
it's not my fault it's their fault and

830
00:26:48,000 --> 00:26:50,080
they were like right

831
00:26:50,080 --> 00:26:51,120
cool

832
00:26:51,120 --> 00:26:52,960
what's the problem i was like well

833
00:26:52,960 --> 00:26:56,240
if it'd been malicious you'd be

834
00:26:56,240 --> 00:26:57,440
and they're like

835
00:26:57,440 --> 00:26:59,120
yeah okay that's cool we've got a bug

836
00:26:59,120 --> 00:27:00,480
bernie program do you want to submit to

837
00:27:00,480 --> 00:27:01,919
and i was like i mean it's not a

838
00:27:01,919 --> 00:27:03,919
vulnerability human stupidity isn't

839
00:27:03,919 --> 00:27:08,159
really a like bug class and like packer1

840
00:27:08,159 --> 00:27:09,440
like i was like well it's technically

841
00:27:09,440 --> 00:27:11,120
remote code execution i was like well i

842
00:27:11,120 --> 00:27:13,600
mean it is but i didn't achieve it just

843
00:27:13,600 --> 00:27:15,520
somebody ran a binary that i gave them

844
00:27:15,520 --> 00:27:17,440
if that's classified as rce i'm fishing

845
00:27:17,440 --> 00:27:19,760
everyone with buyers i mean it's great

846
00:27:19,760 --> 00:27:21,679
vpn so like when pulse secure

847
00:27:21,679 --> 00:27:23,600
vulnerabilities came out um

848
00:27:23,600 --> 00:27:25,120
i released quite a lot of pcs but what i

849
00:27:25,120 --> 00:27:27,120
found as well so linked into the kind of

850
00:27:27,120 --> 00:27:28,960
screenshot i found a lot of internal vpn

851
00:27:28,960 --> 00:27:31,520
portals and so many companies instead of

852
00:27:31,520 --> 00:27:32,880
just rolling with like cisco any

853
00:27:32,880 --> 00:27:34,559
connection just put a log in they try

854
00:27:34,559 --> 00:27:35,760
and roll their own and they write it

855
00:27:35,760 --> 00:27:39,120
like php or panel like guys

856
00:27:39,120 --> 00:27:40,399
don't break something that's already

857
00:27:40,399 --> 00:27:42,640
fixed like it works

858
00:27:42,640 --> 00:27:45,120
and yeah random random host names as

859
00:27:45,120 --> 00:27:47,360
well so kind of

860
00:27:47,360 --> 00:27:49,840
mapping back to intel agencies so this

861
00:27:49,840 --> 00:27:53,039
is um there was maybe about 10 or 15

862
00:27:53,039 --> 00:27:54,880
government intel agencies a lot of

863
00:27:54,880 --> 00:27:57,200
private security companies um run these

864
00:27:57,200 --> 00:27:58,880
things i assume for like threat

865
00:27:58,880 --> 00:28:00,320
intelligence to test that it's

866
00:28:00,320 --> 00:28:02,399
legitimate or not but having sat in

867
00:28:02,399 --> 00:28:03,760
threat intelligence groups a lot of

868
00:28:03,760 --> 00:28:04,559
people

869
00:28:04,559 --> 00:28:06,159
sorry to everyone in the room before i

870
00:28:06,159 --> 00:28:08,240
say this but threat intelligence people

871
00:28:08,240 --> 00:28:10,320
mostly are not technical tall

872
00:28:10,320 --> 00:28:11,679
don't understand how computers work

873
00:28:11,679 --> 00:28:13,520
they're just like excel yep cool no

874
00:28:13,520 --> 00:28:16,159
problem otherwise not glue they're

875
00:28:16,159 --> 00:28:17,679
pretty good at like intel they'll get

876
00:28:17,679 --> 00:28:19,120
real but the kind of ones that are

877
00:28:19,120 --> 00:28:20,640
claimed to be cyber threat intelligence

878
00:28:20,640 --> 00:28:23,039
don't have a scooby

879
00:28:23,039 --> 00:28:25,760
um i said i wasn't gonna swear

880
00:28:25,760 --> 00:28:27,600
but hey so good

881
00:28:27,600 --> 00:28:30,320
so break down by execution and mostly

882
00:28:30,320 --> 00:28:33,279
windows um when i talk to on my london

883
00:28:33,279 --> 00:28:35,919
talk this has been as unknown actually

884
00:28:35,919 --> 00:28:37,919
what i managed to reclassify as was

885
00:28:37,919 --> 00:28:40,399
mostly sandbox traffic and mostly um

886
00:28:40,399 --> 00:28:42,720
running inside of like virtual machines

887
00:28:42,720 --> 00:28:44,720
that didn't have variables or anything

888
00:28:44,720 --> 00:28:46,399
set so like people would set up watch

889
00:28:46,399 --> 00:28:48,799
machines with like random users and

890
00:28:48,799 --> 00:28:51,120
various things but not like unset the

891
00:28:51,120 --> 00:28:52,399
environmental variable which isn't what

892
00:28:52,399 --> 00:28:54,960
you can do just do like unset and then

893
00:28:54,960 --> 00:28:56,640
percentage and then the variable and

894
00:28:56,640 --> 00:28:59,200
then again it unsets it so it was always

895
00:28:59,200 --> 00:29:01,360
just sending back a black string which

896
00:29:01,360 --> 00:29:02,880
is pretty cool

897
00:29:02,880 --> 00:29:04,559
um i was talking about the kind of

898
00:29:04,559 --> 00:29:06,000
example of what i was getting in terms

899
00:29:06,000 --> 00:29:09,399
of um

900
00:30:03,279 --> 00:30:04,720
and on the right here we've got the

901
00:30:04,720 --> 00:30:06,640
original honey poc and i forgot the

902
00:30:06,640 --> 00:30:09,200
sentiment

903
00:30:20,480 --> 00:30:23,039
and this is an http um feedback the main

904
00:30:23,039 --> 00:30:24,960
difference here is kind of limited in

905
00:30:24,960 --> 00:30:26,880
the data that you can put in a dns

906
00:30:26,880 --> 00:30:29,440
packet whereas youtube and you can send

907
00:30:29,440 --> 00:30:32,159
back with with um you can send back any

908
00:30:32,159 --> 00:30:34,159
amount of http headers so what i did in

909
00:30:34,159 --> 00:30:35,919
my personal concept is i created a lot

910
00:30:35,919 --> 00:30:37,760
of customizable headers with a lot of

911
00:30:37,760 --> 00:30:40,640
references so for example um

912
00:30:40,640 --> 00:30:42,159
like the acceptance of standard

913
00:30:42,159 --> 00:30:43,919
background context

914
00:30:43,919 --> 00:30:46,080
name thing back the user engine had

915
00:30:46,080 --> 00:30:48,320
changed the query

916
00:30:48,320 --> 00:30:50,000
this specific one was several three

917
00:30:50,000 --> 00:30:51,440
which is the host name of the machine it

918
00:30:51,440 --> 00:30:53,039
runs on and

919
00:30:53,039 --> 00:30:54,960
i couldn't get some of the screenshots

920
00:30:54,960 --> 00:30:56,399
of things because

921
00:30:56,399 --> 00:30:57,760
they were like two minutes of slide but

922
00:30:57,760 --> 00:31:02,440
there was one that came back for the um

923
00:31:04,480 --> 00:31:07,279
it was like 18 000 slack messages that

924
00:31:07,279 --> 00:31:08,720
came through one goal because they're

925
00:31:08,720 --> 00:31:10,320
like little little blocks of thing and i

926
00:31:10,320 --> 00:31:12,159
was like that's a lot of fun but phone

927
00:31:12,159 --> 00:31:13,360
started i was like oh maybe it's the

928
00:31:13,360 --> 00:31:14,960
group chat going off i was like no

929
00:31:14,960 --> 00:31:16,559
there's a lot more than the group chat

930
00:31:16,559 --> 00:31:18,399
and then it was just like all slack

931
00:31:18,399 --> 00:31:19,760
messages and i've never looked into

932
00:31:19,760 --> 00:31:21,360
slack and just you know 100 plus

933
00:31:21,360 --> 00:31:23,760
messages like unread like someone's

934
00:31:23,760 --> 00:31:26,480
a lot there

935
00:31:26,480 --> 00:31:28,399
it was pretty interesting

936
00:31:28,399 --> 00:31:31,120
um in terms of like data and stuff so

937
00:31:31,120 --> 00:31:33,039
the the kind of insiders identified

938
00:31:33,039 --> 00:31:34,640
these are unique companies and unique

939
00:31:34,640 --> 00:31:37,760
instances and i found about 100 i tried

940
00:31:37,760 --> 00:31:40,080
to contact all of them about

941
00:31:40,080 --> 00:31:41,919
10 of them got back to me two of them

942
00:31:41,919 --> 00:31:43,919
allowed me to report to the bug bernie

943
00:31:43,919 --> 00:31:45,760
three of them threatened legal action

944
00:31:45,760 --> 00:31:46,640
and

945
00:31:46,640 --> 00:31:48,080
although it wasn't my fault it was

946
00:31:48,080 --> 00:31:50,000
someone else doing it um there's about

947
00:31:50,000 --> 00:31:52,320
280 corporate ikea addresses identified

948
00:31:52,320 --> 00:31:54,640
so things that were like non-aws done as

949
00:31:54,640 --> 00:31:57,519
your non-gcp not quite right so like um

950
00:31:57,519 --> 00:32:01,120
abertay's ip range

951
00:32:05,279 --> 00:32:07,039
was six months long so i ran from april

952
00:32:07,039 --> 00:32:10,320
to october and yeah it was good fun and

953
00:32:10,320 --> 00:32:12,720
i've also rattled through this talk so

954
00:32:12,720 --> 00:32:15,120
there's a few people on thank um so

955
00:32:15,120 --> 00:32:16,559
they're not in the room today it's on

956
00:32:16,559 --> 00:32:18,480
the backbone but um i want to thank

957
00:32:18,480 --> 00:32:20,399
first of all six and six is a good power

958
00:32:20,399 --> 00:32:22,240
line uh that's his handle he doesn't

959
00:32:22,240 --> 00:32:24,799
like going by really um he kind of took

960
00:32:24,799 --> 00:32:27,039
my original really shorty python code

961
00:32:27,039 --> 00:32:28,799
and help me automate it and template it

962
00:32:28,799 --> 00:32:30,960
and make it a lot more um structurally

963
00:32:30,960 --> 00:32:32,880
sound so initially when i create all of

964
00:32:32,880 --> 00:32:35,760
you'll see it was like a 1000 line

965
00:32:35,760 --> 00:32:38,559
python script and then sticks went no no

966
00:32:38,559 --> 00:32:39,200
no

967
00:32:39,200 --> 00:32:40,880
 that you're making it modular we're

968
00:32:40,880 --> 00:32:41,760
going to take everything out we're going

969
00:32:41,760 --> 00:32:43,519
to put it into like four dozen things so

970
00:32:43,519 --> 00:32:45,360
as a result um it's like loads of

971
00:32:45,360 --> 00:32:46,880
different like modules that i could

972
00:32:46,880 --> 00:32:49,279
change and move about so the cbe polling

973
00:32:49,279 --> 00:32:51,279
was one the environmental variables was

974
00:32:51,279 --> 00:32:52,320
hello and

975
00:32:52,320 --> 00:32:54,799
lots of other

976
00:32:55,039 --> 00:32:57,279
not here he's a um scotsman and he

977
00:32:57,279 --> 00:32:58,960
taught me a lot about templating so up

978
00:32:58,960 --> 00:33:00,480
until when i started creating this i

979
00:33:00,480 --> 00:33:02,159
don't really know about how to create

980
00:33:02,159 --> 00:33:03,519
templates and go and how to print

981
00:33:03,519 --> 00:33:05,360
differences

982
00:33:05,360 --> 00:33:08,000
and you create your appropriate attempts

983
00:33:08,000 --> 00:33:10,320
of course that you put like a and

984
00:33:10,320 --> 00:33:11,840
strength and then you can all fill that

985
00:33:11,840 --> 00:33:13,120
with python which is really useful

986
00:33:13,120 --> 00:33:14,960
because like whatever

987
00:33:14,960 --> 00:33:16,960
film was like a unique canary url which

988
00:33:16,960 --> 00:33:20,399
time um a unique cd id sign

989
00:33:20,399 --> 00:33:21,840
and just like unique information which

990
00:33:21,840 --> 00:33:23,600
was a lot more interesting and

991
00:33:23,600 --> 00:33:25,519
thanksgiving so these guys are really

992
00:33:25,519 --> 00:33:27,120
helpful so they've got a free service

993
00:33:27,120 --> 00:33:28,640
which is fairy tokens.org i don't know

994
00:33:28,640 --> 00:33:30,159
if this is sponsored by anyone but like

995
00:33:30,159 --> 00:33:32,000
they gave me a lot of help and their

996
00:33:32,000 --> 00:33:34,320
free service was really useful to start

997
00:33:34,320 --> 00:33:35,919
but i found that because i wanted to

998
00:33:35,919 --> 00:33:37,519
automate it more their free service is

999
00:33:37,519 --> 00:33:39,519
only available via the web interface so

1000
00:33:39,519 --> 00:33:40,799
i don't automated it i was like actually

1001
00:33:40,799 --> 00:33:42,240
you guys got like an api like oh we've

1002
00:33:42,240 --> 00:33:44,480
got an open source one it's kind of old

1003
00:33:44,480 --> 00:33:45,840
because we've got a page of it i was

1004
00:33:45,840 --> 00:33:47,679
like how much does your picture they

1005
00:33:47,679 --> 00:33:49,440
went uh we don't really sell it to

1006
00:33:49,440 --> 00:33:51,440
individuals i was like okay can i maybe

1007
00:33:51,440 --> 00:33:52,960
get access for like three months or

1008
00:33:52,960 --> 00:33:54,799
whatever because i'm doing this project

1009
00:33:54,799 --> 00:33:57,600
oh you're the retro guy yeah cool

1010
00:33:57,600 --> 00:33:59,679
how'd that go right cool so they gave me

1011
00:33:59,679 --> 00:34:01,840
access to their api and as a result i

1012
00:34:01,840 --> 00:34:04,799
was able to generate like lots of urls

1013
00:34:04,799 --> 00:34:06,799
off honestly like just send a current

1014
00:34:06,799 --> 00:34:09,040
request with the token the bunch i think

1015
00:34:09,040 --> 00:34:12,079
i really recommend them and kevin bowman

1016
00:34:12,079 --> 00:34:13,918
he's the reason that model poc kind of

1017
00:34:13,918 --> 00:34:15,599
exists because he replied to a tweet

1018
00:34:15,599 --> 00:34:16,879
that i put out

1019
00:34:16,879 --> 00:34:18,079
about like

1020
00:34:18,079 --> 00:34:20,159
the exchange fund abilities he was like

1021
00:34:20,159 --> 00:34:22,960
oh why don't you automate it and um

1022
00:34:22,960 --> 00:34:24,480
i think it's

1023
00:34:24,480 --> 00:34:26,320
florian whatever his name is he's

1024
00:34:26,320 --> 00:34:28,159
blogging on twitter but he he replied

1025
00:34:28,159 --> 00:34:29,440
like don't do that people's jobs are

1026
00:34:29,440 --> 00:34:31,040
really hard enough and then i took the

1027
00:34:31,040 --> 00:34:34,239
 off when he blocked me

1028
00:34:34,239 --> 00:34:35,520
so yeah

1029
00:34:35,520 --> 00:34:38,879
and ipinfo they gave me access to their

1030
00:34:38,879 --> 00:34:40,239
dashboards and stuff before they

1031
00:34:40,239 --> 00:34:41,918
actually published them to public so i

1032
00:34:41,918 --> 00:34:44,079
was using their information to like look

1033
00:34:44,079 --> 00:34:45,280
up where these things were based

1034
00:34:45,280 --> 00:34:46,960
initially i contacted them i was like

1035
00:34:46,960 --> 00:34:48,399
you guys got anything that i can do like

1036
00:34:48,399 --> 00:34:49,760
on masks because i've written them a

1037
00:34:49,760 --> 00:34:51,918
friend like a geo mark

1038
00:34:51,918 --> 00:34:53,520
and then their their market was like oh

1039
00:34:53,520 --> 00:34:54,480
yeah we'll get back to you one of the

1040
00:34:54,480 --> 00:34:56,800
technical guys mentioned anyway actually

1041
00:34:56,800 --> 00:34:59,680
i know you from somewhere

1042
00:35:00,320 --> 00:35:02,079
we've got this product that's not out

1043
00:35:02,079 --> 00:35:03,599
yet it's out now but it wasn't out in

1044
00:35:03,599 --> 00:35:06,800
november and it's for mapping out uh ip

1045
00:35:06,800 --> 00:35:09,119
addresses from a geographical

1046
00:35:09,119 --> 00:35:12,240
perspective and also from like uh

1047
00:35:12,240 --> 00:35:14,800
like where the asms and where the ip

1048
00:35:14,800 --> 00:35:16,400
ranges and things are based

1049
00:35:16,400 --> 00:35:18,079
why don't you give it a go i was like

1050
00:35:18,079 --> 00:35:19,680
all right cool what's the limit on it

1051
00:35:19,680 --> 00:35:21,680
there were a million ip so right i've

1052
00:35:21,680 --> 00:35:23,680
got like 100 billion ips and we'll just

1053
00:35:23,680 --> 00:35:26,480
run it a hundred times

1054
00:35:26,480 --> 00:35:28,240
so yeah i got access to that that was

1055
00:35:28,240 --> 00:35:30,000
good and i finally want to thank the

1056
00:35:30,000 --> 00:35:33,040
gang so dave morgan alexander um they

1057
00:35:33,040 --> 00:35:34,960
kind of like prevented me from getting

1058
00:35:34,960 --> 00:35:37,280
like put me back for banned by foreign

1059
00:35:37,280 --> 00:35:39,280
services not because they were saving me

1060
00:35:39,280 --> 00:35:40,240
from the van but they were just like

1061
00:35:40,240 --> 00:35:41,839
maybe don't do this so maybe don't

1062
00:35:41,839 --> 00:35:44,560
mention that and as a result i'm still

1063
00:35:44,560 --> 00:35:46,480
here so

1064
00:35:46,480 --> 00:35:49,119
so it's all good for now

1065
00:35:49,119 --> 00:35:50,720
that somebody did try again to talk my

1066
00:35:50,720 --> 00:35:51,520
way through some might be in the

1067
00:35:51,520 --> 00:35:54,560
intelligence service i'm not sure

1068
00:35:54,560 --> 00:35:55,520
if you want to read more about the

1069
00:35:55,520 --> 00:35:58,000
information um this post here is looking

1070
00:35:58,000 --> 00:36:01,119
at all the data that i've played back in

1071
00:36:01,119 --> 00:36:03,200
november and i'll tweet it out as well

1072
00:36:03,200 --> 00:36:04,640
again and the

1073
00:36:04,640 --> 00:36:06,720
privates got the original post so when i

1074
00:36:06,720 --> 00:36:09,200
first put out the first poc um back in

1075
00:36:09,200 --> 00:36:11,599
july of 2020 i put a blog post next day

1076
00:36:11,599 --> 00:36:13,200
of how i trolled internet one day and

1077
00:36:13,200 --> 00:36:16,240
annoyed everyone um so it's quite

1078
00:36:16,240 --> 00:36:17,760
i've been told it's quite an interesting

1079
00:36:17,760 --> 00:36:19,760
post i've read it multiple times

1080
00:36:19,760 --> 00:36:21,839
things and people seem to be enjoying it

1081
00:36:21,839 --> 00:36:23,599
and if you want to follow me on twitter

1082
00:36:23,599 --> 00:36:27,359
if you don't already name fish

1083
00:36:27,359 --> 00:36:31,119
thanks for listening has anyone got any

1084
00:36:34,180 --> 00:36:37,919
[Applause]

1085
00:36:38,280 --> 00:36:41,920
questions yes um so like reversing this

1086
00:36:41,920 --> 00:36:42,960
like looking at it from a risk

1087
00:36:42,960 --> 00:36:45,119
perspective um what advice would you

1088
00:36:45,119 --> 00:36:47,920
have to like ctr teams um in like

1089
00:36:47,920 --> 00:36:50,640
investing spread intel

1090
00:36:50,640 --> 00:36:52,320
um so that they don't fall back into

1091
00:36:52,320 --> 00:36:53,440
something like this

1092
00:36:53,440 --> 00:36:55,040
in terms of that so the question is how

1093
00:36:55,040 --> 00:36:56,480
do you look for a risk perspective and

1094
00:36:56,480 --> 00:36:59,040
how to vet uh

1095
00:36:59,040 --> 00:37:00,560
what i would say is from a threat

1096
00:37:00,560 --> 00:37:02,320
intelligence perspective

1097
00:37:02,320 --> 00:37:03,440
kind of

1098
00:37:03,440 --> 00:37:05,680
verifying that things are legitimate so

1099
00:37:05,680 --> 00:37:07,760
if somebody releases a proof of concept

1100
00:37:07,760 --> 00:37:10,960
and it's a raw binary on like a website

1101
00:37:10,960 --> 00:37:12,640
probably don't trust it unless the

1102
00:37:12,640 --> 00:37:14,640
source is available obviously rapid the

1103
00:37:14,640 --> 00:37:16,240
threat and tell like things get released

1104
00:37:16,240 --> 00:37:18,079
all the time but being quite vigilant

1105
00:37:18,079 --> 00:37:19,280
about what's been released is kind of

1106
00:37:19,280 --> 00:37:21,040
important so

1107
00:37:21,040 --> 00:37:22,400
from a threat intelligence company

1108
00:37:22,400 --> 00:37:23,440
perspective

1109
00:37:23,440 --> 00:37:25,359
looking at how you're hiring so going

1110
00:37:25,359 --> 00:37:26,880
right back to hiring and let me look at

1111
00:37:26,880 --> 00:37:28,560
people that have got

1112
00:37:28,560 --> 00:37:30,160
actual hands-on technical experience

1113
00:37:30,160 --> 00:37:32,079
people say they're technical often they

1114
00:37:32,079 --> 00:37:33,920
might not have the correct like

1115
00:37:33,920 --> 00:37:35,839
technical understanding they need so

1116
00:37:35,839 --> 00:37:37,440
maybe looking at who you're hiring and

1117
00:37:37,440 --> 00:37:38,800
what you're hiring them for if you're

1118
00:37:38,800 --> 00:37:40,560
having to just like troll feeds if they

1119
00:37:40,560 --> 00:37:43,440
can't troll feeds if they can't verify

1120
00:37:43,440 --> 00:37:45,680
what they're taking in they've got no

1121
00:37:45,680 --> 00:37:47,119
chance of what's going on

1122
00:37:47,119 --> 00:37:48,079
so

1123
00:37:48,079 --> 00:37:49,520
yeah take it right back look at your

1124
00:37:49,520 --> 00:37:52,880
hiring and also kind of be a bit more um

1125
00:37:52,880 --> 00:37:54,000
a bit more vigilant with what's being

1126
00:37:54,000 --> 00:37:56,000
run and also don't run it on your host

1127
00:37:56,000 --> 00:37:57,119
machine run it instead of watching

1128
00:37:57,119 --> 00:37:59,200
machine don't get my network access that

1129
00:37:59,200 --> 00:38:01,119
can have usual operational security kind

1130
00:38:01,119 --> 00:38:03,599
of stuff so i mean like seen and guide

1131
00:38:03,599 --> 00:38:06,000
or anything like a brand that exists

1132
00:38:06,000 --> 00:38:08,000
with like advice on technically what's

1133
00:38:08,000 --> 00:38:09,680
expect when you're looking at a source

1134
00:38:09,680 --> 00:38:11,359
or a binary or is that something that

1135
00:38:11,359 --> 00:38:13,680
you believe

1136
00:38:13,680 --> 00:38:15,920
um there are like russian engineering

1137
00:38:15,920 --> 00:38:18,240
guys and stuff for binaries as to like

1138
00:38:18,240 --> 00:38:19,839
safe ways of doing it

1139
00:38:19,839 --> 00:38:20,960
but i don't know if there's like a

1140
00:38:20,960 --> 00:38:22,800
general guide for like threat

1141
00:38:22,800 --> 00:38:24,480
intelligence as a whole because it's

1142
00:38:24,480 --> 00:38:27,680
kind of it really varies

1143
00:38:28,000 --> 00:38:29,359
any other questions

1144
00:38:29,359 --> 00:38:32,090
yep

1145
00:38:32,090 --> 00:38:35,159
[Music]

1146
00:38:53,680 --> 00:38:55,520
the way that i automated is it it was

1147
00:38:55,520 --> 00:38:57,760
pulled in descriptions from my turn and

1148
00:38:57,760 --> 00:38:59,599
there's another like i think it's like a

1149
00:38:59,599 --> 00:39:02,560
dutch university they they they you

1150
00:39:02,560 --> 00:39:03,920
they pull it in from the the various

1151
00:39:03,920 --> 00:39:05,680
sites they put in one place in terms of

1152
00:39:05,680 --> 00:39:07,280
the ones that are very vegas like oh it

1153
00:39:07,280 --> 00:39:09,680
affects like like hp or something i

1154
00:39:09,680 --> 00:39:11,359
would still pull in and just drop it in

1155
00:39:11,359 --> 00:39:13,599
people still run it so um

1156
00:39:13,599 --> 00:39:16,720
people are idiots basically

1157
00:39:16,720 --> 00:39:19,680
yeah any other questions concerns

1158
00:39:19,680 --> 00:39:23,240
yep um

1159
00:39:41,200 --> 00:39:43,440
let me go back to the site

1160
00:39:43,440 --> 00:39:45,839
this one yes um so script release were

1161
00:39:45,839 --> 00:39:48,000
kind of worked out based on you know ids

1162
00:39:48,000 --> 00:39:50,480
and stuff and and

1163
00:39:50,480 --> 00:39:52,800
how they were being run um insider

1164
00:39:52,800 --> 00:39:54,640
threat was based upon the information

1165
00:39:54,640 --> 00:39:57,920
that i was identifying and so

1166
00:39:57,920 --> 00:40:00,240
those kind of versions were one at times

1167
00:40:00,240 --> 00:40:01,680
but like square periods would take the

1168
00:40:01,680 --> 00:40:03,760
cve and run it against an ip and then

1169
00:40:03,760 --> 00:40:06,319
another ip and another ip another ip rp

1170
00:40:06,319 --> 00:40:08,079
and loads of different ips and they'd be

1171
00:40:08,079 --> 00:40:09,920
like different companies and all sorts

1172
00:40:09,920 --> 00:40:11,680
of whereas inside a threat was targeting

1173
00:40:11,680 --> 00:40:14,160
mostly internal ips and some like

1174
00:40:14,160 --> 00:40:16,000
corporate ranges and not just like for

1175
00:40:16,000 --> 00:40:17,359
example

1176
00:40:17,359 --> 00:40:20,079
10 10 20 one two three four or like a

1177
00:40:20,079 --> 00:40:22,800
slash 24 or quite a bit suspicious

1178
00:40:22,800 --> 00:40:24,079
and also like the host names i was

1179
00:40:24,079 --> 00:40:25,760
getting back and most of the time the

1180
00:40:25,760 --> 00:40:27,280
people that run it instead of vm will be

1181
00:40:27,280 --> 00:40:29,359
like desktop dash and like a string and

1182
00:40:29,359 --> 00:40:30,720
the ones that were like internal

1183
00:40:30,720 --> 00:40:32,079
companies were actually like computer

1184
00:40:32,079 --> 00:40:33,920
names so like

1185
00:40:33,920 --> 00:40:36,480
one or workstation one so that's how i

1186
00:40:36,480 --> 00:40:38,880
differentiate between

1187
00:40:38,880 --> 00:40:40,160
anyone else

1188
00:40:40,160 --> 00:40:43,160
yeah

1189
00:40:53,660 --> 00:40:55,440
[Music]

1190
00:40:55,440 --> 00:40:56,960
no the computer mission act is about

1191
00:40:56,960 --> 00:40:58,720
intent but they are currently reforming

1192
00:40:58,720 --> 00:41:00,640
the computer mission site so uh it's

1193
00:41:00,640 --> 00:41:03,839
like section 1 2 and 3a are about the

1194
00:41:03,839 --> 00:41:05,200
intent the intent of creating this

1195
00:41:05,200 --> 00:41:07,680
wasn't to like get malicious execution

1196
00:41:07,680 --> 00:41:09,280
it was just to kind of get an

1197
00:41:09,280 --> 00:41:10,560
understanding of what was being built

1198
00:41:10,560 --> 00:41:11,760
what was being run

1199
00:41:11,760 --> 00:41:13,119
it would be a different story if i was

1200
00:41:13,119 --> 00:41:15,359
uploading like cobalt stripe beacons or

1201
00:41:15,359 --> 00:41:17,839
and like a wiper for example that just

1202
00:41:17,839 --> 00:41:19,760
like wipes your machine that would be

1203
00:41:19,760 --> 00:41:21,520
kind of veering into the kind of illegal

1204
00:41:21,520 --> 00:41:23,520
aspect and stuff um

1205
00:41:23,520 --> 00:41:24,960
when i was at bases london i actually

1206
00:41:24,960 --> 00:41:27,040
spoke to the director of ncsc and i was

1207
00:41:27,040 --> 00:41:28,079
like yo

1208
00:41:28,079 --> 00:41:30,560
is this illegal and he was like uh

1209
00:41:30,560 --> 00:41:32,240
a bit of a gray area but as long as

1210
00:41:32,240 --> 00:41:34,640
you're not like hurting anyone it should

1211
00:41:34,640 --> 00:41:36,160
be fine i was like so if i'm not running

1212
00:41:36,160 --> 00:41:37,440
and punching people with no balance like

1213
00:41:37,440 --> 00:41:40,160
yeah pretty much all right cool so

1214
00:41:40,160 --> 00:41:42,800
don't do crime kids it's bad

1215
00:41:42,800 --> 00:41:45,920
don't punch people it's awesome

1216
00:41:46,240 --> 00:41:49,640
anyone else

1217
00:41:50,319 --> 00:41:51,280
nope

1218
00:41:51,280 --> 00:41:55,400
well 15 minutes getting out of the lunch

1219
00:41:55,400 --> 00:42:00,539
[Applause]

