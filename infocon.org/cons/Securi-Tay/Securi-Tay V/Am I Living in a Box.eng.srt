1
00:00:05,370 --> 00:00:15,219
hello so my name<font color="#CCCCCC"> is Graham Sutherland I</font>

2
00:00:11,830 --> 00:00:16,779
work at cisco which is black<font color="#E5E5E5"> I used to</font>

3
00:00:15,219 --> 00:00:21,490
work at Port Cullis we got more so now

4
00:00:16,779 --> 00:00:23,410
<font color="#E5E5E5">sister this will be my fourth talk a</font>

5
00:00:21,490 --> 00:00:26,250
security so I've been<font color="#E5E5E5"> to most of them</font>

6
00:00:23,410 --> 00:00:30,460
enough and I'm going to talk about

7
00:00:26,250 --> 00:00:31,750
virtual machines I apologize if anything

8
00:00:30,460 --> 00:00:33,520
weird happens to the slides because I'm

9
00:00:31,750 --> 00:00:39,329
running in a vm and<font color="#CCCCCC"> I can't actually see</font>

10
00:00:33,520 --> 00:00:41,739
anything on my screen so yeah<font color="#CCCCCC"> it may</font>

11
00:00:39,329 --> 00:00:44,050
work<font color="#E5E5E5"> for colors for three years and now</font>

12
00:00:41,739 --> 00:00:47,519
we've got bought by Cisco so he worked

13
00:00:44,050 --> 00:00:51,519
there for a short line now it's the same

14
00:00:47,519 --> 00:00:54,670
yeah I my primary focuses mostly<font color="#CCCCCC"> around</font>

15
00:00:51,519 --> 00:00:56,469
windows stuff by an applications reverse

16
00:00:54,670 --> 00:00:58,929
engineering we<font color="#CCCCCC"> had protocol we still</font>

17
00:00:56,469 --> 00:01:01,870
need<font color="#CCCCCC"> to win those intervals and I like</font>

18
00:00:58,929 --> 00:01:07,950
drivers and stuff it's fun I was a lot

19
00:01:01,870 --> 00:01:11,170
crypto and I we're in kind of weird yeah

20
00:01:07,950 --> 00:01:13,120
that's pretty<font color="#E5E5E5"> much self-explanatory we</font>

21
00:01:11,170 --> 00:01:14,620
are planning the team so I<font color="#E5E5E5"> think we're</font>

22
00:01:13,120 --> 00:01:16,480
doing internships and stuff so you just

23
00:01:14,620 --> 00:01:19,450
come see as if you interested in getting

24
00:01:16,480 --> 00:01:29,590
the job I was sponsoring the bot so you

25
00:01:19,450 --> 00:01:33,070
can all get so who recognizes the term

26
00:01:29,590 --> 00:01:38,020
am i living in a box as a song that's

27
00:01:33,070 --> 00:01:41,109
all the old people yeah so<font color="#CCCCCC"> just like me</font>

28
00:01:38,020 --> 00:01:43,119
there are one hit wonder they were

29
00:01:41,110 --> 00:01:44,320
terrible and yes there's a band called

30
00:01:43,120 --> 00:01:46,780
living<font color="#E5E5E5"> in a box and I had a song called</font>

31
00:01:44,320 --> 00:01:49,210
living in<font color="#E5E5E5"> a box and but this this</font>

32
00:01:46,780 --> 00:01:55,090
presentation is not about them it's

33
00:01:49,210 --> 00:01:57,610
about asking<font color="#CCCCCC"> the question as a piece of</font>

34
00:01:55,090 --> 00:01:59,980
software and I being watched amyloid

35
00:01:57,610 --> 00:02:02,260
being calculated inside inside some sort

36
00:01:59,980 --> 00:02:04,780
<font color="#E5E5E5">of container so am i running in them at</font>

37
00:02:02,260 --> 00:02:08,500
<font color="#E5E5E5">the end am I being debugged am i inside</font>

38
00:02:04,780 --> 00:02:10,568
the sandbox am i real emulator oh my

39
00:02:08,500 --> 00:02:13,060
calls being hooked and mostly bought am

40
00:02:10,568 --> 00:02:16,469
I being watched so it's mostly<font color="#E5E5E5"> about</font>

41
00:02:13,060 --> 00:02:16,469
malware but not always

42
00:02:16,790 --> 00:02:21,260
so yeah Matt<font color="#CCCCCC"> from Allah wants to be</font>

43
00:02:19,310 --> 00:02:24,109
invisible it doesn't want to be analyzed

44
00:02:21,260 --> 00:02:26,149
and that's important because obviously

45
00:02:24,109 --> 00:02:28,849
the bad guys wanted it we want

46
00:02:26,150 --> 00:02:29,599
understand how the bad guys do it we

47
00:02:28,849 --> 00:02:31,488
kind of want to<font color="#E5E5E5"> do it ourselves</font>

48
00:02:29,599 --> 00:02:34,578
sometimes for red teaming stuff and

49
00:02:31,489 --> 00:02:38,120
certain<font color="#E5E5E5"> of the reasons if you're an</font>

50
00:02:34,579 --> 00:02:39,950
<font color="#CCCCCC">Asian stake and everyone understand how</font>

51
00:02:38,120 --> 00:02:41,629
virtualization and San boxing and stuff

52
00:02:39,950 --> 00:02:45,260
works because that's an interesting

53
00:02:41,629 --> 00:02:47,929
topic I think um so there's been prior

54
00:02:45,260 --> 00:02:51,078
work sorry you might not be able<font color="#E5E5E5"> to read</font>

55
00:02:47,930 --> 00:02:53,389
the bottom metal<font color="#CCCCCC"> duck but</font><font color="#E5E5E5"> basically</font>

56
00:02:51,079 --> 00:02:55,099
video is<font color="#E5E5E5"> probably work on this both in</font>

57
00:02:53,389 --> 00:02:58,790
terms of the attack<font color="#E5E5E5"> and defense side so</font>

58
00:02:55,099 --> 00:03:01,548
I'm identifying<font color="#CCCCCC"> ways that malware hides</font>

59
00:02:58,790 --> 00:03:03,650
from sandbox environments prize from<font color="#CCCCCC"> VMS</font>

60
00:03:01,549 --> 00:03:06,489
does weird things when it<font color="#E5E5E5"> runs on vm so</font>

61
00:03:03,650 --> 00:03:10,220
it<font color="#CCCCCC"> looks</font><font color="#E5E5E5"> like innocuous software so you</font>

62
00:03:06,489 --> 00:03:11,510
run the evils of software and instead on

63
00:03:10,220 --> 00:03:13,909
the analysis machine instead of it

64
00:03:11,510 --> 00:03:17,569
getting pwned and saying all sorts of

65
00:03:13,909 --> 00:03:20,450
stuff over to cycling Russia or China or

66
00:03:17,569 --> 00:03:23,720
wherever<font color="#E5E5E5"> and there instead what it will</font>

67
00:03:20,450 --> 00:03:26,298
do it will go oh um his Tetris play that

68
00:03:23,720 --> 00:03:29,889
and then the young list gets confused

69
00:03:26,299 --> 00:03:29,889
and<font color="#CCCCCC"> advice tetris</font><font color="#E5E5E5"> for four hours because</font>

70
00:03:31,329 --> 00:03:35,840
so yeah there's some papers on it

71
00:03:33,949 --> 00:03:39,849
there's been some talks on it a few

72
00:03:35,840 --> 00:03:42,409
times<font color="#CCCCCC"> i did a very brief talk on it i</font>

73
00:03:39,849 --> 00:03:44,179
think<font color="#CCCCCC"> it</font><font color="#E5E5E5"> was like three hours between</font>

74
00:03:42,409 --> 00:03:48,440
coming up at the<font color="#E5E5E5"> top idea and doing the</font>

75
00:03:44,180 --> 00:03:49,790
talk<font color="#E5E5E5"> DC 4420 in London lots of scattered</font>

76
00:03:48,440 --> 00:03:51,198
information around and<font color="#E5E5E5"> I kind of want to</font>

77
00:03:49,790 --> 00:03:53,569
just pile it into one place which is

78
00:03:51,199 --> 00:03:55,549
this talk and there's a guy at work<font color="#E5E5E5"> as</font>

79
00:03:53,569 --> 00:03:59,659
well he's done some analysis of this

80
00:03:55,549 --> 00:04:02,659
tour booked passage how you say which<font color="#CCCCCC"> is</font>

81
00:03:59,659 --> 00:04:04,370
a vm identifier something you'd run it

82
00:04:02,659 --> 00:04:07,189
and it says I'm really event which says

83
00:04:04,370 --> 00:04:11,419
unlock nuh nuh nuh there and working out

84
00:04:07,189 --> 00:04:14,540
how it does that is quite cool<font color="#E5E5E5"> ok so</font>

85
00:04:11,419 --> 00:04:15,650
we're looking<font color="#E5E5E5"> to vm</font><font color="#CCCCCC"> Daniel ASEAN</font>

86
00:04:14,540 --> 00:04:18,978
detection we're going to<font color="#CCCCCC"> look into San</font>

87
00:04:15,650 --> 00:04:20,810
boxers we're going to<font color="#E5E5E5"> look into some</font>

88
00:04:18,978 --> 00:04:22,039
anti debug stuff mostly not going to

89
00:04:20,810 --> 00:04:22,350
come<font color="#CCCCCC"> over and</font><font color="#E5E5E5"> read a</font><font color="#CCCCCC"> book because it's</font>

90
00:04:22,039 --> 00:04:26,159
been

91
00:04:22,350 --> 00:04:28,910
def some behavioral detection stuff and

92
00:04:26,160 --> 00:04:31,920
offensive measures so<font color="#CCCCCC"> ways that you</font><font color="#E5E5E5"> can</font>

93
00:04:28,910 --> 00:04:33,750
mess with<font color="#E5E5E5"> the analysts and some</font>

94
00:04:31,920 --> 00:04:35,730
potentially not so legal ways you can

95
00:04:33,750 --> 00:04:38,760
let your dinner and analyst which<font color="#E5E5E5"> I've</font>

96
00:04:35,730 --> 00:04:42,780
<font color="#E5E5E5">certainly no done so we'll talk about it</font>

97
00:04:38,760 --> 00:04:45,570
<font color="#E5E5E5">but we don't do it so virtual machines</font>

98
00:04:42,780 --> 00:04:47,190
are not real machines they are software

99
00:04:45,570 --> 00:04:48,330
abstraction<font color="#CCCCCC"> and a real machine which</font>

100
00:04:47,190 --> 00:04:49,710
means that<font color="#E5E5E5"> they're not the same is you</font>

101
00:04:48,330 --> 00:04:51,630
can't like a perfect kind of<font color="#E5E5E5"> a piece of</font>

102
00:04:49,710 --> 00:04:55,500
hardware it's always<font color="#E5E5E5"> gonna be slightly</font>

103
00:04:51,630 --> 00:04:57,240
so you can take taken something<font color="#E5E5E5"> you know</font>

104
00:04:55,500 --> 00:04:59,700
you can think it's a laptop and then you

105
00:04:57,240 --> 00:05:01,020
can win<font color="#E5E5E5"> a vm and the vm will always look</font>

106
00:04:59,700 --> 00:05:03,210
different to the laptop<font color="#CCCCCC"> it with anyone</font>

107
00:05:01,020 --> 00:05:05,280
because you can't physically make it

108
00:05:03,210 --> 00:05:06,359
identical<font color="#E5E5E5"> you can't expose everything</font>

109
00:05:05,280 --> 00:05:07,890
that's on the laptop but<font color="#E5E5E5"> but it's not</font>

110
00:05:06,360 --> 00:05:10,770
the virtual machine anymore that's just

111
00:05:07,890 --> 00:05:12,060
a laptop it's that way if you had two

112
00:05:10,770 --> 00:05:13,770
virtual machines when they both<font color="#E5E5E5"> of you</font>

113
00:05:12,060 --> 00:05:15,210
<font color="#E5E5E5">running exactly the same</font><font color="#CCCCCC"> hardware and</font>

114
00:05:13,770 --> 00:05:16,530
<font color="#E5E5E5">talking to exactly the same peripherals</font>

115
00:05:15,210 --> 00:05:18,060
at exactly the same time with no

116
00:05:16,530 --> 00:05:22,830
separation and everything go wrong<font color="#E5E5E5"> and</font>

117
00:05:18,060 --> 00:05:25,230
catch fire so there's<font color="#CCCCCC"> lots of ways to</font>

118
00:05:22,830 --> 00:05:26,430
detect them we can look at the hardware

119
00:05:25,230 --> 00:05:28,950
we look at the moment we've got the

120
00:05:26,430 --> 00:05:31,590
software so hardware obviously<font color="#E5E5E5"> things</font>

121
00:05:28,950 --> 00:05:35,250
like<font color="#E5E5E5"> disks network cards the physical</font>

122
00:05:31,590 --> 00:05:37,530
processor memory things like that bios

123
00:05:35,250 --> 00:05:40,020
the motherboard the chips there and

124
00:05:37,530 --> 00:05:42,630
things like that firmware<font color="#E5E5E5"> again things</font>

125
00:05:40,020 --> 00:05:45,630
like biopsy UEFI<font color="#CCCCCC"> inside</font><font color="#E5E5E5"> management</font>

126
00:05:42,630 --> 00:05:50,969
engine trusted platform module things

127
00:05:45,630 --> 00:05:54,960
like identified chips on memory called

128
00:05:50,970 --> 00:05:56,700
SPD so you can't talk to<font color="#E5E5E5"> them and ask</font>

129
00:05:54,960 --> 00:05:59,789
them questions and<font color="#CCCCCC"> interpret interrogate</font>

130
00:05:56,700 --> 00:06:01,289
their firm then media to the<font color="#E5E5E5"> M or maybe</font>

131
00:05:59,790 --> 00:06:02,790
<font color="#E5E5E5">you can talk to it and it's going to say</font>

132
00:06:01,290 --> 00:06:04,830
weird in fact because it's not<font color="#E5E5E5"> a real</font>

133
00:06:02,790 --> 00:06:07,110
person peaceful holla well maybe it just

134
00:06:04,830 --> 00:06:09,570
looks like a weird piece of of it and

135
00:06:07,110 --> 00:06:12,120
also software because a lot of the time

136
00:06:09,570 --> 00:06:13,710
when<font color="#E5E5E5"> you set up a vm you actually</font>

137
00:06:12,120 --> 00:06:17,660
install a lot of stuff that<font color="#E5E5E5"> you would</font>

138
00:06:13,710 --> 00:06:19,710
<font color="#CCCCCC">just never install on</font><font color="#E5E5E5"> an on vm piece of</font>

139
00:06:17,660 --> 00:06:23,640
machinery so like you're<font color="#E5E5E5"> not going to</font>

140
00:06:19,710 --> 00:06:25,950
put<font color="#E5E5E5"> VMware guest services on your laptop</font>

141
00:06:23,640 --> 00:06:27,370
and that's it<font color="#CCCCCC"> for in</font><font color="#E5E5E5"> vmware because it</font>

142
00:06:25,950 --> 00:06:30,880
wouldn't work and

143
00:06:27,370 --> 00:06:31,810
doing so also analysis tools because at

144
00:06:30,880 --> 00:06:32,889
the end of the day it doesn't matter

145
00:06:31,810 --> 00:06:35,290
what<font color="#E5E5E5"> you were going at the end if you've</font>

146
00:06:32,889 --> 00:06:36,220
got you know like all UD BG and<font color="#E5E5E5"> a bunch</font>

147
00:06:35,290 --> 00:06:37,630
of other things on though you know

148
00:06:36,220 --> 00:06:39,460
poking around with matlab because the

149
00:06:37,630 --> 00:06:41,080
malware is going to go well<font color="#CCCCCC"> i got a</font>

150
00:06:39,460 --> 00:06:43,599
minute this is definitely analyst

151
00:06:41,080 --> 00:06:48,219
machine those none of you stop and weird

152
00:06:43,600 --> 00:06:50,770
things again so it<font color="#E5E5E5"> just indicators a lot</font>

153
00:06:48,220 --> 00:06:53,710
of<font color="#CCCCCC"> these are quite common so is the</font><font color="#E5E5E5"> disk</font>

154
00:06:50,770 --> 00:06:55,419
less than 200 gig it is it's probably<font color="#E5E5E5"> a</font>

155
00:06:53,710 --> 00:06:57,250
vm because nobody has a<font color="#E5E5E5"> disk or</font><font color="#CCCCCC"> it until</font>

156
00:06:55,419 --> 00:07:01,419
you came these days if<font color="#E5E5E5"> you do then you</font>

157
00:06:57,250 --> 00:07:03,789
live in the nineties the display balls

158
00:07:01,419 --> 00:07:05,889
match known analysis machine so if you

159
00:07:03,789 --> 00:07:08,050
pop an analyst machine or you put those

160
00:07:05,889 --> 00:07:10,600
something to like virus type all you or

161
00:07:08,050 --> 00:07:12,580
where ever you know malware runs and

162
00:07:10,600 --> 00:07:14,560
then it goes Oh what's the disclaimer

163
00:07:12,580 --> 00:07:17,320
and then you've reported back to the bad

164
00:07:14,560 --> 00:07:18,550
guys and bad guys go<font color="#E5E5E5"> okay so when I see</font>

165
00:07:17,320 --> 00:07:21,750
there's disco ball I'm gonna pretend<font color="#CCCCCC"> to</font>

166
00:07:18,550 --> 00:07:24,190
be somebody else and not be malware

167
00:07:21,750 --> 00:07:26,050
again this car<font color="#E5E5E5"> they're like the</font>

168
00:07:24,190 --> 00:07:30,669
controllers and stuff so<font color="#CCCCCC"> virtualbox for</font>

169
00:07:26,050 --> 00:07:34,150
example as a virtual virtual by de and

170
00:07:30,669 --> 00:07:36,039
virtual skizzy and also purchase<font color="#CCCCCC"> a</font>

171
00:07:34,150 --> 00:07:37,840
traffic controllers which are not real

172
00:07:36,039 --> 00:07:39,849
controllers so you can send them<font color="#E5E5E5"> win</font>

173
00:07:37,840 --> 00:07:41,859
that you can ask what controller now on

174
00:07:39,849 --> 00:07:43,389
they'll<font color="#E5E5E5"> be like oh yeah</font><font color="#CCCCCC"> I'm searching</font>

175
00:07:41,860 --> 00:07:45,940
such controller you're like yeah<font color="#E5E5E5"> that's</font>

176
00:07:43,389 --> 00:07:48,940
because<font color="#E5E5E5"> you're</font><font color="#CCCCCC"> not a real controller and</font>

177
00:07:45,940 --> 00:07:51,250
I can identify that because you're the

178
00:07:48,940 --> 00:07:53,260
only person who's ever used this actual

179
00:07:51,250 --> 00:07:55,479
real controller because this this name

180
00:07:53,260 --> 00:07:57,699
of this controller doesn't exist in real

181
00:07:55,479 --> 00:07:59,440
life anywhere like okay there is a real

182
00:07:57,699 --> 00:08:02,080
one<font color="#E5E5E5"> so it will be called</font><font color="#CCCCCC"> Intel something</font>

183
00:07:59,440 --> 00:08:03,310
<font color="#CCCCCC">rather but there's no real hardware that</font>

184
00:08:02,080 --> 00:08:05,650
actually uses that control anymore

185
00:08:03,310 --> 00:08:09,430
because it's a legacy pizza parlor so I

186
00:08:05,650 --> 00:08:10,690
can see it you know<font color="#E5E5E5"> your interview you</font>

187
00:08:09,430 --> 00:08:12,220
can also do things like sending its

188
00:08:10,690 --> 00:08:13,900
specific a two-game commands because

189
00:08:12,220 --> 00:08:15,130
like you can go<font color="#E5E5E5"> okay well if it was the</font>

190
00:08:13,900 --> 00:08:17,109
real piece of hardware would support

191
00:08:15,130 --> 00:08:18,520
this ATM so you turn it in a<font color="#CCCCCC"> TA come and</font>

192
00:08:17,110 --> 00:08:20,680
then it<font color="#E5E5E5"> goes or don't answer do that and</font>

193
00:08:18,520 --> 00:08:22,810
you go okay so you're definitely virtual

194
00:08:20,680 --> 00:08:26,590
there because the real<font color="#CCCCCC"> Hardware would</font>

195
00:08:22,810 --> 00:08:27,970
not have to do that yeah just serial

196
00:08:26,590 --> 00:08:29,440
numbers as well so you can ask the desk

197
00:08:27,970 --> 00:08:30,550
for<font color="#E5E5E5"> its serial number and if it comes</font>

198
00:08:29,440 --> 00:08:32,559
back with one that you know is

199
00:08:30,550 --> 00:08:33,180
associated<font color="#CCCCCC"> with a virtual</font><font color="#E5E5E5"> machine or a</font>

200
00:08:32,559 --> 00:08:35,760
no kindly

201
00:08:33,179 --> 00:08:39,689
Spock's okay you're an hour stance on

202
00:08:35,760 --> 00:08:42,000
<font color="#CCCCCC">them and differently Windows 8 has this</font>

203
00:08:39,690 --> 00:08:45,240
really handy API that they stuck in

204
00:08:42,000 --> 00:08:46,320
kernel32 called<font color="#CCCCCC"> is negative vht good and</font>

205
00:08:45,240 --> 00:08:48,060
well that does is it tells you whether

206
00:08:46,320 --> 00:08:50,190
the operating system was booted from the

207
00:08:48,060 --> 00:08:53,010
<font color="#CCCCCC">vhd which is a virtual hard drive for</font>

208
00:08:50,190 --> 00:08:55,860
things like hyper-v and virtual pc so

209
00:08:53,010 --> 00:08:58,740
that's deadly new tricks brain-dead just

210
00:08:55,860 --> 00:09:02,250
returns of 10 resume<font color="#CCCCCC"> okay I'm running in</font>

211
00:08:58,740 --> 00:09:07,080
a<font color="#CCCCCC"> vhd so I know mother p.m. networking</font>

212
00:09:02,250 --> 00:09:09,570
for<font color="#E5E5E5"> pensions so there are some network</font>

213
00:09:07,080 --> 00:09:12,899
interface MAC addresses the<font color="#CCCCCC"> oh</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> eyes</font>

214
00:09:09,570 --> 00:09:15,089
for particular virtual appliances always

215
00:09:12,899 --> 00:09:16,800
the same so you<font color="#E5E5E5"> just look at it and go</font>

216
00:09:15,089 --> 00:09:20,339
all of the total marks because it's<font color="#E5E5E5"> not</font>

217
00:09:16,800 --> 00:09:24,240
a bit I tell 027 you can't change<font color="#E5E5E5"> it</font>

218
00:09:20,339 --> 00:09:28,350
most people don't we'll talk<font color="#E5E5E5"> a little</font>

219
00:09:24,240 --> 00:09:32,010
bit<font color="#E5E5E5"> more</font><font color="#CCCCCC"> about the state of sort</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> mt</font>

220
00:09:28,350 --> 00:09:34,680
analysis later there are some relatively

221
00:09:32,010 --> 00:09:37,920
comprehensive guides on how to make a

222
00:09:34,680 --> 00:09:42,829
fee-only not look like a bin it's still

223
00:09:37,920 --> 00:09:42,829
know<font color="#CCCCCC"> that it perfect look virtual map</font>

224
00:09:42,860 --> 00:09:49,890
chances are<font color="#CCCCCC"> if you're your nap IP ranges</font>

225
00:09:45,930 --> 00:09:52,439
192 168 53<font color="#CCCCCC"> one probably not</font><font color="#E5E5E5"> a real</font>

226
00:09:49,890 --> 00:09:56,040
<font color="#CCCCCC">writer it's probably in that set up by</font>

227
00:09:52,440 --> 00:09:57,180
damn that's not always the case but like

228
00:09:56,040 --> 00:10:00,480
<font color="#CCCCCC">a lot of the</font><font color="#E5E5E5"> time they just set up</font>

229
00:09:57,180 --> 00:10:02,310
stupid ranges on the nap also things

230
00:10:00,480 --> 00:10:03,990
like if you talk to<font color="#E5E5E5"> the dhcp server you</font>

231
00:10:02,310 --> 00:10:05,310
can send with weird malformed packets

232
00:10:03,990 --> 00:10:07,529
and it still responds to it because it's

233
00:10:05,310 --> 00:10:10,949
a virtual map not real one and things

234
00:10:07,529 --> 00:10:12,270
<font color="#E5E5E5">like how it handles particular sets of</font>

235
00:10:10,950 --> 00:10:13,980
communications like whether<font color="#CCCCCC"> it will</font>

236
00:10:12,270 --> 00:10:15,630
actually set up<font color="#E5E5E5"> an appt Rufus it for one</font>

237
00:10:13,980 --> 00:10:18,120
thing over<font color="#CCCCCC"> another you can use that</font><font color="#E5E5E5"> as a</font>

238
00:10:15,630 --> 00:10:19,800
fingering fingerprint tool so you can go

239
00:10:18,120 --> 00:10:21,180
okay<font color="#E5E5E5"> I'm gonna send like these three</font>

240
00:10:19,800 --> 00:10:22,050
packets and then the service<font color="#E5E5E5"> going to</font>

241
00:10:21,180 --> 00:10:24,150
send you<font color="#CCCCCC"> back in</font><font color="#E5E5E5"> this one right here</font>

242
00:10:22,050 --> 00:10:26,459
does that one packet come back through

243
00:10:24,150 --> 00:10:27,779
because did the nap implementation

244
00:10:26,459 --> 00:10:30,899
recognize this as a legitimate

245
00:10:27,779 --> 00:10:33,059
connection and that's<font color="#E5E5E5"> what two-finger</font>

246
00:10:30,899 --> 00:10:36,930
you can tell there's a van or not

247
00:10:33,059 --> 00:10:40,410
sometimes another brain dead one does

248
00:10:36,930 --> 00:10:43,559
VIP match unknown sandbox system so

249
00:10:40,410 --> 00:10:45,029
somewhere like malware I'll cook<font color="#E5E5E5"> Goku or</font>

250
00:10:43,559 --> 00:10:46,110
any list or something like that<font color="#CCCCCC"> so when</font>

251
00:10:45,029 --> 00:10:48,779
<font color="#E5E5E5">you book learning piece of malware and</font>

252
00:10:46,110 --> 00:10:50,670
it says this is everything with this

253
00:10:48,779 --> 00:10:52,319
<font color="#E5E5E5">process did and you go what's the IP</font>

254
00:10:50,670 --> 00:10:54,029
addresses what was my IP address<font color="#CCCCCC"> so I</font>

255
00:10:52,319 --> 00:10:55,920
just got to talk<font color="#CCCCCC"> to some IP address</font>

256
00:10:54,029 --> 00:10:58,019
<font color="#E5E5E5">hacker and it goes oh you're this I bed</font>

257
00:10:55,920 --> 00:10:59,579
rest yeah well I know that's the IP

258
00:10:58,019 --> 00:11:06,839
address of the newest so I'm not<font color="#CCCCCC"> gonna</font>

259
00:10:59,579 --> 00:11:11,939
run also shared folders shares always

260
00:11:06,839 --> 00:11:13,619
between the ends and the hosts are

261
00:11:11,939 --> 00:11:15,118
<font color="#E5E5E5">implemented in a variety of different</font>

262
00:11:13,619 --> 00:11:17,850
ways a lot of the time<font color="#E5E5E5"> that just</font>

263
00:11:15,119 --> 00:11:20,069
implemented as<font color="#CCCCCC"> network chairs and often</font>

264
00:11:17,850 --> 00:11:22,619
the network share providers a fake so

265
00:11:20,069 --> 00:11:24,360
they've<font color="#CCCCCC"> got the</font><font color="#E5E5E5"> Kern either you're</font>

266
00:11:22,619 --> 00:11:27,720
trying to a DNS requests until come back

267
00:11:24,360 --> 00:11:29,850
and say yeah this is its IP for this

268
00:11:27,720 --> 00:11:31,139
host and you can talk<font color="#E5E5E5"> to it that way but</font>

269
00:11:29,850 --> 00:11:33,809
most of the time what happens<font color="#E5E5E5"> is they</font>

270
00:11:31,139 --> 00:11:37,529
put<font color="#E5E5E5"> in a networking provider into the</font>

271
00:11:33,809 --> 00:11:40,019
guest OS and it uses<font color="#E5E5E5"> that to override</font>

272
00:11:37,529 --> 00:11:42,179
the<font color="#E5E5E5"> traffic so</font><font color="#CCCCCC"> that it can just</font><font color="#E5E5E5"> pass it</font>

273
00:11:40,019 --> 00:11:43,889
back through and help using alternative

274
00:11:42,179 --> 00:11:48,749
mechanism so for example the VirtualBox

275
00:11:43,889 --> 00:11:52,259
shareholders provider for for doing

276
00:11:48,749 --> 00:11:54,089
chase all this across<font color="#E5E5E5"> the 30 box is one</font>

277
00:11:52,259 --> 00:11:56,129
way to check and you can also try to

278
00:11:54,089 --> 00:11:59,040
enumerate shareholders in the<font color="#E5E5E5"> UNC path</font>

279
00:11:56,129 --> 00:12:00,420
<font color="#CCCCCC">slide feed boxes SF I'm mostly going to</font>

280
00:11:59,040 --> 00:12:02,519
talk about virtual box because it's dead

281
00:12:00,420 --> 00:12:05,309
easy to dig into because it's mostly

282
00:12:02,519 --> 00:12:07,170
<font color="#E5E5E5">open source and</font><font color="#CCCCCC"> it's relatively</font><font color="#E5E5E5"> easy to</font>

283
00:12:05,309 --> 00:12:08,279
<font color="#E5E5E5">analyze them their bug trackers quite</font>

284
00:12:07,170 --> 00:12:09,660
funny because you can go through<font color="#CCCCCC"> and</font>

285
00:12:08,279 --> 00:12:14,509
just find all the bugs in them and go go

286
00:12:09,660 --> 00:12:14,509
<font color="#E5E5E5">look and use that as an analyst</font><font color="#CCCCCC"> at all</font>

287
00:12:14,839 --> 00:12:21,990
<font color="#CCCCCC">yep I'm all the hardware indicators so</font>

288
00:12:18,379 --> 00:12:24,089
the<font color="#E5E5E5"> screen so who here is ran a vm and</font>

289
00:12:21,990 --> 00:12:25,679
then they recited the<font color="#CCCCCC"> damn</font><font color="#E5E5E5"> and then</font>

290
00:12:24,089 --> 00:12:27,540
they've<font color="#CCCCCC"> got into like the display</font>

291
00:12:25,679 --> 00:12:31,350
properties and had a bit<font color="#E5E5E5"> because their</font>

292
00:12:27,540 --> 00:12:33,240
display resolution is like 746 by 1911

293
00:12:31,350 --> 00:12:34,980
and yellow mmm don't think anybody make

294
00:12:33,240 --> 00:12:37,319
panels like that so that's<font color="#E5E5E5"> kind of</font>

295
00:12:34,980 --> 00:12:38,730
obvious like it means less than 1024 x

296
00:12:37,319 --> 00:12:38,979
768 while you're either running in the

297
00:12:38,730 --> 00:12:42,519
night

298
00:12:38,980 --> 00:12:44,949
again or you've got a weird vm<font color="#E5E5E5"> set up</font>

299
00:12:42,519 --> 00:12:48,040
and again nobody makes one thousand

300
00:12:44,949 --> 00:12:52,719
seven thirty pics all like 1143 pixel

301
00:12:48,040 --> 00:12:56,079
family's main board manufacturers so you

302
00:12:52,720 --> 00:12:59,139
can look<font color="#E5E5E5"> up the</font><font color="#CCCCCC"> wmi information look at</font>

303
00:12:56,079 --> 00:13:01,060
the enzyme called win32 of the school

304
00:12:59,139 --> 00:13:04,449
baseball or something like that and<font color="#E5E5E5"> tell</font>

305
00:13:01,060 --> 00:13:08,050
you the bios reported name of the

306
00:13:04,449 --> 00:13:10,389
motherboard and all bunch of other stuff

307
00:13:08,050 --> 00:13:12,099
and you can see if they look<font color="#E5E5E5"> in the jet</font>

308
00:13:10,389 --> 00:13:15,579
a lot of the time they're just called

309
00:13:12,100 --> 00:13:18,670
things look<font color="#CCCCCC"> VMware or little box bored</font>

310
00:13:15,579 --> 00:13:21,489
alone and another<font color="#E5E5E5"> thing that's really</font>

311
00:13:18,670 --> 00:13:24,099
hard for<font color="#E5E5E5"> them to fake is that almost</font>

312
00:13:21,490 --> 00:13:27,250
every virtualization solution thanks<font color="#CCCCCC"> to</font>

313
00:13:24,100 --> 00:13:30,610
<font color="#E5E5E5">chipset and face a motherboard and so</font>

314
00:13:27,250 --> 00:13:32,980
you can<font color="#E5E5E5"> say is it going the I for 40 FX</font>

315
00:13:30,610 --> 00:13:34,959
chip set when probably<font color="#CCCCCC"> VirtualBox</font>

316
00:13:32,980 --> 00:13:39,029
because nobody has an eye for 40 FX chip

317
00:13:34,959 --> 00:13:41,739
sense anymore because it's not 1994 and

318
00:13:39,029 --> 00:13:43,089
there you guys who use it so it's the

319
00:13:41,740 --> 00:13:47,860
only one that<font color="#CCCCCC"> they can anybody doesn't</font>

320
00:13:43,089 --> 00:13:50,740
it yeah like PR 0 x3 is that it's the

321
00:13:47,860 --> 00:13:52,240
savage so you'll often see that

322
00:13:50,740 --> 00:13:54,370
referenced when you're talking about

323
00:13:52,240 --> 00:13:56,680
Virgil box because again nobody uses<font color="#CCCCCC"> it</font>

324
00:13:54,370 --> 00:14:00,970
for real<font color="#CCCCCC"> Hardware anymore so the Intel</font>

325
00:13:56,680 --> 00:14:02,199
<font color="#E5E5E5">82</font><font color="#CCCCCC"> 371 SB also known as pillow x3 so</font>

326
00:14:00,970 --> 00:14:03,790
nice after work southbridge the

327
00:14:02,199 --> 00:14:05,199
VirtualBox can use so if you enumerate

328
00:14:03,790 --> 00:14:06,550
the hardware and<font color="#CCCCCC"> you find out that it's</font>

329
00:14:05,199 --> 00:14:10,029
running that<font color="#E5E5E5"> you're pretty sure that</font>

330
00:14:06,550 --> 00:14:12,599
it's bringing it in we wanted to<font color="#CCCCCC"> can</font>

331
00:14:10,029 --> 00:14:15,750
<font color="#CCCCCC">talk</font><font color="#E5E5E5"> to sm bus devices so sm boss is the</font>

332
00:14:12,600 --> 00:14:17,829
hardware bus that sits on<font color="#E5E5E5"> the board and</font>

333
00:14:15,750 --> 00:14:19,600
allows you to communicate with onboard

334
00:14:17,829 --> 00:14:25,349
peripherals so for<font color="#CCCCCC"> example temperature</font>

335
00:14:19,600 --> 00:14:28,540
sensors fan speed sensors dental exam

336
00:14:25,350 --> 00:14:29,980
but also SPD chips on the round so SPD

337
00:14:28,540 --> 00:14:31,180
tells you things like<font color="#E5E5E5"> what we could see</font>

338
00:14:29,980 --> 00:14:33,790
you around<font color="#E5E5E5"> during out what banks are</font><font color="#CCCCCC"> not</font>

339
00:14:31,180 --> 00:14:35,670
<font color="#CCCCCC">lately what the name of</font><font color="#E5E5E5"> what the</font>

340
00:14:33,790 --> 00:14:37,319
manufacturer and<font color="#E5E5E5"> model number is for</font>

341
00:14:35,670 --> 00:14:40,589
individual ram sticks you're probably

342
00:14:37,320 --> 00:14:42,060
seeing this through tools<font color="#E5E5E5"> like cpu-z so</font>

343
00:14:40,590 --> 00:14:44,070
if any of you do any overclocking some

344
00:14:42,060 --> 00:14:45,989
things<font color="#E5E5E5"> like that</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> might use tools</font>

345
00:14:44,070 --> 00:14:48,480
like that to see<font color="#E5E5E5"> that what's running in</font>

346
00:14:45,990 --> 00:14:51,750
there the important thing is<font color="#CCCCCC"> that you</font>

347
00:14:48,480 --> 00:14:54,420
have<font color="#CCCCCC"> to</font><font color="#E5E5E5"> query that through an sm bus</font>

348
00:14:51,750 --> 00:14:56,790
driver because often what happen<font color="#E5E5E5"> is</font>

349
00:14:54,420 --> 00:14:58,589
it'll the motherboard will pass that

350
00:14:56,790 --> 00:15:01,709
information to the bios of the bios will

351
00:14:58,590 --> 00:15:06,240
expose that on the system and that's

352
00:15:01,710 --> 00:15:08,730
easy<font color="#E5E5E5"> to fake what's hard to fake is real</font>

353
00:15:06,240 --> 00:15:11,940
SPD<font color="#E5E5E5"> that's like real sm bus interaction</font>

354
00:15:08,730 --> 00:15:14,220
so if you attend<font color="#E5E5E5"> to do that and you</font>

355
00:15:11,940 --> 00:15:16,950
don't see any sm bus devices and you

356
00:15:14,220 --> 00:15:18,720
can't<font color="#E5E5E5"> talk SPD then you almost certainly</font>

357
00:15:16,950 --> 00:15:20,220
know that<font color="#CCCCCC"> you running in a band or you</font>

358
00:15:18,720 --> 00:15:22,860
won't want<font color="#E5E5E5"> to read weird all that top</font>

359
00:15:20,220 --> 00:15:24,840
that just doesn't support communications

360
00:15:22,860 --> 00:15:30,720
but again most of<font color="#E5E5E5"> the time it's going to</font>

361
00:15:24,840 --> 00:15:33,420
be able<font color="#E5E5E5"> mall</font><font color="#CCCCCC"> harbor ah my favorite thing</font>

362
00:15:30,720 --> 00:15:38,090
in the world to do extensions so sse4

363
00:15:33,420 --> 00:15:42,329
it's relatively new there's also another

364
00:15:38,090 --> 00:15:45,360
there's another extension called AVX all

365
00:15:42,330 --> 00:15:46,740
of those and also<font color="#CCCCCC"> the x 512 is</font><font color="#E5E5E5"> a brand</font>

366
00:15:45,360 --> 00:15:49,260
brand new<font color="#E5E5E5"> one which I don't exactly</font>

367
00:15:46,740 --> 00:15:52,260
implemented any real posters as yet but

368
00:15:49,260 --> 00:15:53,730
the thing is most vm solutions don't

369
00:15:52,260 --> 00:15:55,830
actually pass these instructions through

370
00:15:53,730 --> 00:16:01,620
for various reasons mostly just because

371
00:15:55,830 --> 00:16:04,200
it's quite hard to deal with they can do

372
00:16:01,620 --> 00:16:05,640
<font color="#E5E5E5">it a lot of the time but it's a</font><font color="#CCCCCC"> clases</font>

373
00:16:04,200 --> 00:16:08,100
experimental because<font color="#E5E5E5"> they just can't</font>

374
00:16:05,640 --> 00:16:10,500
<font color="#E5E5E5">test everything so it's really hard for</font>

375
00:16:08,100 --> 00:16:12,420
them to go<font color="#E5E5E5"> is a new</font><font color="#CCCCCC"> extension we're sure</font>

376
00:16:10,500 --> 00:16:15,080
it works because<font color="#E5E5E5"> a lot of the time</font>

377
00:16:12,420 --> 00:16:17,579
they're doing buying your translation of

378
00:16:15,080 --> 00:16:19,800
instructions in real time so<font color="#E5E5E5"> if they get</font>

379
00:16:17,580 --> 00:16:21,900
the translation wrong you can run into

380
00:16:19,800 --> 00:16:25,969
bugs and we'll<font color="#E5E5E5"> talk about those later</font>

381
00:16:21,900 --> 00:16:29,010
but safe to say that and cami was

382
00:16:25,970 --> 00:16:32,700
somewhat vulnerable to dodgy

383
00:16:29,010 --> 00:16:34,800
instructions getting making money in it

384
00:16:32,700 --> 00:16:38,130
up and causing all sorts of problems

385
00:16:34,800 --> 00:16:40,740
like remote code execution but yeah so

386
00:16:38,130 --> 00:16:42,890
essentially like<font color="#CCCCCC"> virtual box has an</font>

387
00:16:40,740 --> 00:16:46,590
option where you can set the vm to

388
00:16:42,890 --> 00:16:49,530
enable experimental SC 4.14 point

389
00:16:46,590 --> 00:16:53,010
to pass through without that enabled

390
00:16:49,530 --> 00:16:56,280
what happens is the<font color="#E5E5E5"> CPP virtualized cpu</font>

391
00:16:53,010 --> 00:16:58,110
says yeah I totally support SC 41 1.2

392
00:16:56,280 --> 00:17:01,589
and then you try<font color="#CCCCCC"> and use it and it says</font>

393
00:16:58,110 --> 00:17:04,110
invalid instruction so you get quite

394
00:17:01,590 --> 00:17:07,380
easily<font color="#E5E5E5"> that that's at the end when that</font>

395
00:17:04,109 --> 00:17:10,050
happens some<font color="#CCCCCC"> CPUs do in putting own</font>

396
00:17:07,380 --> 00:17:11,880
subsets of 4.1 and 4.2 then you can just

397
00:17:10,050 --> 00:17:12,899
fingerprint which cpu it so that is if

398
00:17:11,880 --> 00:17:14,370
he doesn't match up with experimental

399
00:17:12,900 --> 00:17:16,260
results then you know it's at the<font color="#E5E5E5"> end</font>

400
00:17:14,369 --> 00:17:21,119
because again it doesn't match up with

401
00:17:16,260 --> 00:17:23,609
the real<font color="#E5E5E5"> hard way same with a DX modern</font>

402
00:17:21,119 --> 00:17:25,069
fit modern<font color="#CCCCCC"> feature is missing so things</font>

403
00:17:23,609 --> 00:17:28,679
like<font color="#CCCCCC"> that either in terms of like</font>

404
00:17:25,069 --> 00:17:31,740
hardware feature support and so things

405
00:17:28,680 --> 00:17:33,950
like UEFI most people support you verify

406
00:17:31,740 --> 00:17:36,060
these days on<font color="#CCCCCC"> from their boards and</font>

407
00:17:33,950 --> 00:17:38,130
again you can interrogate which

408
00:17:36,060 --> 00:17:39,690
motherboard it's running in and say well

409
00:17:38,130 --> 00:17:42,960
that supports UEFI why do you not happy

410
00:17:39,690 --> 00:17:45,300
<font color="#CCCCCC">where file if it's</font><font color="#E5E5E5"> not my support for it</font>

411
00:17:42,960 --> 00:17:47,940
and<font color="#E5E5E5"> it's not going to work in the</font><font color="#CCCCCC"> end</font>

412
00:17:45,300 --> 00:17:51,720
you're going<font color="#E5E5E5"> to know that it's probably</font>

413
00:17:47,940 --> 00:17:53,400
again epic which is advanced

414
00:17:51,720 --> 00:17:56,010
programmable interrupt controller and

415
00:17:53,400 --> 00:17:59,150
mostly<font color="#E5E5E5"> em support that now some of them</font>

416
00:17:56,010 --> 00:18:01,260
have it as an option<font color="#E5E5E5"> to switch on and I</font>

417
00:17:59,150 --> 00:18:04,200
don't<font color="#E5E5E5"> think I know of any hardware they</font>

418
00:18:01,260 --> 00:18:05,790
have it by default enabled so if you can

419
00:18:04,200 --> 00:18:09,300
tell<font color="#CCCCCC"> that there's no effect support that</font>

420
00:18:05,790 --> 00:18:11,639
you can usually go so do<font color="#E5E5E5"> I hope air hog</font>

421
00:18:09,300 --> 00:18:13,560
<font color="#CCCCCC">Hornets event timers there's some fun</font>

422
00:18:11,640 --> 00:18:17,670
stuff for that I was chatting to a few

423
00:18:13,560 --> 00:18:23,850
<font color="#E5E5E5">of you before that's about it yeah hpet</font>

424
00:18:17,670 --> 00:18:25,710
is<font color="#CCCCCC"> its so if any time</font><font color="#E5E5E5"> that there's been</font>

425
00:18:23,850 --> 00:18:29,310
a whole bunch of<font color="#E5E5E5"> in the hardware revenge</font>

426
00:18:25,710 --> 00:18:32,700
<font color="#CCCCCC">farmers in</font><font color="#E5E5E5"> the history of IBM compatible</font>

427
00:18:29,310 --> 00:18:34,560
<font color="#E5E5E5">pcs and kind of section of hardware and</font>

428
00:18:32,700 --> 00:18:36,450
the idea is that you can depending on

429
00:18:34,560 --> 00:18:38,310
how they actually set up<font color="#E5E5E5"> the ideas you</font>

430
00:18:36,450 --> 00:18:40,410
can say I'd<font color="#CCCCCC"> like to</font><font color="#E5E5E5"> start the timer and</font>

431
00:18:38,310 --> 00:18:42,899
then in X many milliseconds or

432
00:18:40,410 --> 00:18:44,040
seconds<font color="#E5E5E5"> or 0 seconds I'd like you to</font>

433
00:18:42,900 --> 00:18:46,200
stop that timer and then raise it

434
00:18:44,040 --> 00:18:47,760
interrupts or you can just say carry on

435
00:18:46,200 --> 00:18:52,440
<font color="#E5E5E5">going I'll</font><font color="#CCCCCC"> leave front of you every so</font>

436
00:18:47,760 --> 00:18:59,210
often and I want accurate time stamp so

437
00:18:52,440 --> 00:19:01,950
um yeah hpet is one of these like fire

438
00:18:59,210 --> 00:19:05,010
run read a time stamp out of there every

439
00:19:01,950 --> 00:19:07,680
so often kind of deals it's really

440
00:19:05,010 --> 00:19:09,510
really useful for animation stuff so

441
00:19:07,680 --> 00:19:12,390
like Windows 10 if you turn how you kept

442
00:19:09,510 --> 00:19:14,820
off the<font color="#E5E5E5"> display runs like ass like you</font>

443
00:19:12,390 --> 00:19:16,560
check<font color="#E5E5E5"> it when you like restore and</font>

444
00:19:14,820 --> 00:19:19,139
minimize<font color="#E5E5E5"> windows it like glitch out all</font>

445
00:19:16,560 --> 00:19:20,820
over both look awful<font color="#CCCCCC"> and the idea is</font>

446
00:19:19,140 --> 00:19:23,010
that<font color="#CCCCCC"> heck your pet</font><font color="#E5E5E5"> can be really useful</font>

447
00:19:20,820 --> 00:19:24,330
the timing that kind of stuff if you

448
00:19:23,010 --> 00:19:25,620
find<font color="#E5E5E5"> out</font><font color="#CCCCCC"> that you've got no hitch head</font>

449
00:19:24,330 --> 00:19:28,280
support you're either really really

450
00:19:25,620 --> 00:19:30,780
really old hardware or in severe

451
00:19:28,280 --> 00:19:33,030
alternatively there's a bug in

452
00:19:30,780 --> 00:19:34,500
virtualbox that goes back from four

453
00:19:33,030 --> 00:19:37,020
point three point eight<font color="#E5E5E5"> going all the</font>

454
00:19:34,500 --> 00:19:39,960
way<font color="#CCCCCC"> back to</font><font color="#E5E5E5"> the year nor which was when</font>

455
00:19:37,020 --> 00:19:43,110
they added hate<font color="#E5E5E5"> pet support which you</font>

456
00:19:39,960 --> 00:19:47,280
can manually turn on or off if you turn

457
00:19:43,110 --> 00:19:48,689
it on and the processor is an Intel

458
00:19:47,280 --> 00:19:51,540
processor of its speed step which is

459
00:19:48,690 --> 00:19:55,230
<font color="#E5E5E5">most of them speaks that what that does</font>

460
00:19:51,540 --> 00:19:57,210
is allows your your face clock

461
00:19:55,230 --> 00:19:58,260
multiplier to drop down so that you're

462
00:19:57,210 --> 00:20:00,420
not running it when<font color="#E5E5E5"> your full</font>

463
00:19:58,260 --> 00:20:01,680
frequencies you must have for<font color="#E5E5E5"> example</font>

464
00:20:00,420 --> 00:20:04,200
<font color="#E5E5E5">you might be</font><font color="#CCCCCC"> bringing three gigahertz</font>

465
00:20:01,680 --> 00:20:06,030
full blast<font color="#E5E5E5"> and then it drops down to one</font>

466
00:20:04,200 --> 00:20:08,760
gigahertz while your idea the idea is

467
00:20:06,030 --> 00:20:09,960
it's using less energy so obviously it's

468
00:20:08,760 --> 00:20:11,129
great for laptops and things like that

469
00:20:09,960 --> 00:20:14,780
but<font color="#E5E5E5"> it's also great for desktops because</font>

470
00:20:11,130 --> 00:20:19,950
you save your<font color="#E5E5E5"> energy the problem is when</font>

471
00:20:14,780 --> 00:20:24,510
<font color="#CCCCCC">speed step drops down and when</font><font color="#E5E5E5"> the vm is</font>

472
00:20:19,950 --> 00:20:26,730
idle hpet wasn't properly updated and

473
00:20:24,510 --> 00:20:29,010
the way that the emulation for it in the

474
00:20:26,730 --> 00:20:31,230
<font color="#CCCCCC">end for virtual box at least</font><font color="#E5E5E5"> was set up</font>

475
00:20:29,010 --> 00:20:33,120
it meant that<font color="#E5E5E5"> it went backwards so who</font>

476
00:20:31,230 --> 00:20:34,290
<font color="#E5E5E5">you would measure a time stamp and then</font>

477
00:20:33,120 --> 00:20:37,739
you would measure another<font color="#E5E5E5"> time stamp and</font>

478
00:20:34,290 --> 00:20:39,600
the time sample says oh it was this<font color="#CCCCCC"> time</font>

479
00:20:37,740 --> 00:20:41,010
and then it says<font color="#E5E5E5"> oh it's this time minus</font>

480
00:20:39,600 --> 00:20:42,449
10 seconds any like hang on<font color="#E5E5E5"> a minute</font>

481
00:20:41,010 --> 00:20:44,250
it's gone<font color="#CCCCCC"> 10 seconds back in time how</font>

482
00:20:42,450 --> 00:20:45,960
does that<font color="#E5E5E5"> work and there's a whole</font>

483
00:20:44,250 --> 00:20:47,820
thread omniscient in their bug tracker

484
00:20:45,960 --> 00:20:49,200
it's quite amusing because people will

485
00:20:47,820 --> 00:20:51,230
<font color="#E5E5E5">use features taken great importance</font>

486
00:20:49,200 --> 00:20:52,880
partners and<font color="#E5E5E5"> w the results</font>

487
00:20:51,230 --> 00:20:54,650
seeing them go backwards<font color="#E5E5E5"> some time was</font>

488
00:20:52,880 --> 00:20:56,690
literally flying backwards in a chair

489
00:20:54,650 --> 00:20:58,730
which is a great way to identify that

490
00:20:56,690 --> 00:21:02,360
univ en because it never runs backwards

491
00:20:58,730 --> 00:21:06,620
in real<font color="#E5E5E5"> hardware well not outside but</font>

492
00:21:02,360 --> 00:21:09,799
not<font color="#CCCCCC"> in like euclidean space</font><font color="#E5E5E5"> anyway</font><font color="#CCCCCC"> tem</font>

493
00:21:06,620 --> 00:21:11,360
again you know mostly where I say most

494
00:21:09,799 --> 00:21:15,290
things have a<font color="#E5E5E5"> TV</font><font color="#CCCCCC"> m</font><font color="#E5E5E5"> and most laptops do</font>

495
00:21:11,360 --> 00:21:17,178
some dough budget stuff doesn't but if

496
00:21:15,290 --> 00:21:18,980
<font color="#CCCCCC">you can see that</font><font color="#E5E5E5"> there's a TPM there so</font>

497
00:21:17,179 --> 00:21:21,559
for<font color="#E5E5E5"> example the</font><font color="#CCCCCC"> ACP our table 40 games</font>

498
00:21:18,980 --> 00:21:24,380
is available and<font color="#E5E5E5"> you can't talk to the</font>

499
00:21:21,559 --> 00:21:29,000
TPM we've got a good idea<font color="#CCCCCC"> that something</font>

500
00:21:24,380 --> 00:21:33,799
is she's going on<font color="#E5E5E5"> slic msdn so here's</font>

501
00:21:29,000 --> 00:21:37,520
what<font color="#CCCCCC"> slic is one guy one guy has dealt</font>

502
00:21:33,799 --> 00:21:39,980
with<font color="#CCCCCC"> windows licensing slic is the</font>

503
00:21:37,520 --> 00:21:42,070
hardware licensing lock that<font color="#E5E5E5"> microsoft</font>

504
00:21:39,980 --> 00:21:46,490
and football not myself at usually OEM

505
00:21:42,070 --> 00:21:49,129
put into the UEFI to say when<font color="#E5E5E5"> you</font>

506
00:21:46,490 --> 00:21:51,830
install windows on this machine look in

507
00:21:49,130 --> 00:21:55,220
the exit guard tables<font color="#E5E5E5"> see if you've got</font>

508
00:21:51,830 --> 00:21:56,840
an SL IC and afghanistan and section in

509
00:21:55,220 --> 00:21:58,730
there if<font color="#E5E5E5"> you have used that as a license</font>

510
00:21:56,840 --> 00:22:00,470
so it's a hard way lock license so you

511
00:21:58,730 --> 00:22:02,030
instead of<font color="#E5E5E5"> having to park in a key it</font>

512
00:22:00,470 --> 00:22:05,630
goes all over this laptop license and

513
00:22:02,030 --> 00:22:08,330
just installed so that's<font color="#E5E5E5"> quite common if</font>

514
00:22:05,630 --> 00:22:10,160
you're running on a an oam laptop got no

515
00:22:08,330 --> 00:22:11,780
<font color="#E5E5E5">vm edition of windows installed and you</font>

516
00:22:10,160 --> 00:22:13,640
don't have<font color="#E5E5E5"> an SL IC you can start</font>

517
00:22:11,780 --> 00:22:16,480
scratching your head and go<font color="#CCCCCC"> hmm it's</font>

518
00:22:13,640 --> 00:22:18,710
<font color="#E5E5E5">really real hard left probably</font><font color="#CCCCCC"> a damn</font>

519
00:22:16,480 --> 00:22:21,410
most of the time vm don't pass that

520
00:22:18,710 --> 00:22:25,340
through and you can set that up there is

521
00:22:21,410 --> 00:22:27,559
an option to pass a custom binary acpi

522
00:22:25,340 --> 00:22:30,049
table through virtual box<font color="#CCCCCC"> i think you</font>

523
00:22:27,559 --> 00:22:31,460
can<font color="#E5E5E5"> do</font><font color="#CCCCCC"> it in vmware as well but most</font>

524
00:22:30,049 --> 00:22:34,340
people don't<font color="#E5E5E5"> unless they're building</font>

525
00:22:31,460 --> 00:22:37,490
like hot a hardened and he did textures

526
00:22:34,340 --> 00:22:39,110
vm or whatever but as I say that's<font color="#E5E5E5"> not</font>

527
00:22:37,490 --> 00:22:42,530
something<font color="#CCCCCC"> that most people do also a</font>

528
00:22:39,110 --> 00:22:44,600
particular modern<font color="#E5E5E5"> port so you've got on</font>

529
00:22:42,530 --> 00:22:46,450
one laptop it's not what USB freezable

530
00:22:44,600 --> 00:22:52,040
<font color="#E5E5E5">not scratching your head because again</font>

531
00:22:46,450 --> 00:22:53,840
papi the vm so<font color="#CCCCCC"> i talked about a</font><font color="#E5E5E5"> cgi so</font>

532
00:22:52,040 --> 00:22:56,389
this<font color="#E5E5E5"> is why i talked about</font><font color="#CCCCCC"> a DC 4420</font><font color="#E5E5E5"> a</font>

533
00:22:53,840 --> 00:23:02,428
<font color="#E5E5E5">few in there probably none</font><font color="#CCCCCC"> of you work</font>

534
00:22:56,390 --> 00:23:04,440
and basically a CPI is a set of

535
00:23:02,429 --> 00:23:06,869
hey<font color="#E5E5E5"> Wars configuration data tables that</font>

536
00:23:04,440 --> 00:23:08,730
are passed from the are where or more

537
00:23:06,869 --> 00:23:10,549
<font color="#CCCCCC">precisely the firmware to the operating</font>

538
00:23:08,730 --> 00:23:14,700
system so you<font color="#E5E5E5"> can understand things</font><font color="#CCCCCC"> like</font>

539
00:23:10,549 --> 00:23:17,759
how the pci bus is laid out information

540
00:23:14,700 --> 00:23:21,570
about support for HP information about

541
00:23:17,759 --> 00:23:23,460
support for<font color="#CCCCCC"> sli see all sorts</font><font color="#E5E5E5"> of</font>

542
00:23:21,570 --> 00:23:26,939
<font color="#CCCCCC">different stuff in there we'll have a</font>

543
00:23:23,460 --> 00:23:29,669
look at<font color="#CCCCCC"> that in a minute so</font><font color="#E5E5E5"> windows</font>

544
00:23:26,940 --> 00:23:31,110
exposes it to you go like user level you

545
00:23:29,669 --> 00:23:32,610
can you don't<font color="#E5E5E5"> need to be privileged to</font>

546
00:23:31,110 --> 00:23:34,320
look at the data<font color="#E5E5E5"> that's in there and</font>

547
00:23:32,610 --> 00:23:40,649
there's two like the eyes that listed

548
00:23:34,320 --> 00:23:44,039
there<font color="#E5E5E5"> go wild and looks / sis has it in</font>

549
00:23:40,649 --> 00:23:46,529
there I<font color="#CCCCCC"> can't</font><font color="#E5E5E5"> exactly the path min-jeong</font>

550
00:23:44,039 --> 00:23:48,269
<font color="#E5E5E5">stroll wherever ears took a look into</font>

551
00:23:46,529 --> 00:23:50,369
<font color="#E5E5E5">that a while back and he was quite opal</font>

552
00:23:48,269 --> 00:23:53,220
with that and you<font color="#E5E5E5"> don't even</font><font color="#CCCCCC"> root any</font>

553
00:23:50,369 --> 00:23:55,350
lament success so you can do feature

554
00:23:53,220 --> 00:23:59,730
detection so you can look<font color="#E5E5E5"> for a pic even</font>

555
00:23:55,350 --> 00:24:01,709
for dma remapping dx/dt an ssdp common

556
00:23:59,730 --> 00:24:05,159
bridge<font color="#CCCCCC"> after what they'll page parasol</font>

557
00:24:01,710 --> 00:24:07,049
out slic msdn license instead of 2pm<font color="#E5E5E5"> and</font>

558
00:24:05,159 --> 00:24:08,519
you fi so<font color="#CCCCCC"> though all the support that</font>

559
00:24:07,049 --> 00:24:09,658
kind of thing is<font color="#E5E5E5"> in there you can also</font>

560
00:24:08,519 --> 00:24:11,700
<font color="#CCCCCC">stop</font><font color="#E5E5E5"> to look at the contents of those</font>

561
00:24:09,659 --> 00:24:13,980
tables and a lot of<font color="#CCCCCC"> time in the end</font>

562
00:24:11,700 --> 00:24:19,769
because<font color="#E5E5E5"> they're fake they just</font><font color="#CCCCCC"> have</font>

563
00:24:13,980 --> 00:24:20,820
words like virtual box so<font color="#CCCCCC"> I don't know</font>

564
00:24:19,769 --> 00:24:24,749
whether you can actually see that very

565
00:24:20,820 --> 00:24:27,799
well but this is output from a tool

566
00:24:24,749 --> 00:24:31,850
called firmware tables view by nirsoft

567
00:24:27,799 --> 00:24:33,929
that don't sound against the PR tables

568
00:24:31,850 --> 00:24:37,439
so you've got<font color="#E5E5E5"> the contents of the SMS</font>

569
00:24:33,929 --> 00:24:42,659
which is<font color="#E5E5E5"> just the bios image you've got</font>

570
00:24:37,440 --> 00:24:46,980
the<font color="#CCCCCC"> opentable SF dat be bored email</font>

571
00:24:42,659 --> 00:24:50,580
which<font color="#CCCCCC"> is the DMA remapping you've got ms</font>

572
00:24:46,980 --> 00:24:53,490
drm<font color="#E5E5E5"> and SSD t SL IC UEFI all of that</font>

573
00:24:50,580 --> 00:24:57,480
good stuff so yeah so you can<font color="#E5E5E5"> see that</font>

574
00:24:53,490 --> 00:24:59,399
<font color="#E5E5E5">the beef OEM the OEM ID is a lenovo</font>

575
00:24:57,480 --> 00:25:01,730
because he's<font color="#E5E5E5"> run off and run over</font><font color="#CCCCCC"> the</font>

576
00:24:59,399 --> 00:25:03,500
top so<font color="#E5E5E5"> we know</font><font color="#CCCCCC"> that the aliens</font>

577
00:25:01,730 --> 00:25:06,890
novo such probably a real piece of

578
00:25:03,500 --> 00:25:09,640
online then we can also take a look at

579
00:25:06,890 --> 00:25:13,630
the bottom and in the SML we can see

580
00:25:09,640 --> 00:25:20,570
intel core<font color="#CCCCCC"> i7 blah blah looks like legit</font>

581
00:25:13,630 --> 00:25:23,960
data ah that's why<font color="#E5E5E5"> I think</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> see</font>

582
00:25:20,570 --> 00:25:25,790
<font color="#CCCCCC">fiance ok so no no come to the back</font>

583
00:25:23,960 --> 00:25:35,120
where I don't know whether this is going

584
00:25:25,790 --> 00:25:37,190
to work but I'm gonna give it<font color="#CCCCCC"> go so Oh</font>

585
00:25:35,120 --> 00:25:43,429
something quite thick can you<font color="#E5E5E5"> guys see</font>

586
00:25:37,190 --> 00:25:46,280
you<font color="#CCCCCC"> ok right so this is virtual box so</font>

587
00:25:43,430 --> 00:25:49,370
as<font color="#E5E5E5"> you can see here OEM ID is V box and</font>

588
00:25:46,280 --> 00:25:53,690
the table ID is like vbox<font color="#CCCCCC"> APEC vbox bars</font>

589
00:25:49,370 --> 00:25:56,239
vbox ACP so these are kind of<font color="#E5E5E5"> obvious</font>

590
00:25:53,690 --> 00:26:01,280
and<font color="#E5E5E5"> also there's not</font><font color="#CCCCCC"> many of</font><font color="#E5E5E5"> them</font>

591
00:25:56,240 --> 00:26:05,570
<font color="#E5E5E5">because they're all bloodshot so this is</font>

592
00:26:01,280 --> 00:26:10,790
<font color="#E5E5E5">the</font><font color="#CCCCCC"> sm bios image for the my box it says</font>

593
00:26:05,570 --> 00:26:15,379
you know tech gmbh<font color="#E5E5E5"> VirtualBox a lot like</font>

594
00:26:10,790 --> 00:26:16,790
<font color="#E5E5E5">it mmm says it's a pentium free this is</font>

595
00:26:15,380 --> 00:26:18,050
relatively new laptop<font color="#CCCCCC"> I'm pretty sure</font>

596
00:26:16,790 --> 00:26:20,710
it's not<font color="#E5E5E5"> a time to improve</font><font color="#CCCCCC"> I had a</font>

597
00:26:18,050 --> 00:26:24,919
pentium three laps up in life in 1999

598
00:26:20,710 --> 00:26:27,500
it's a brick so yeah so this<font color="#CCCCCC"> is kind of</font>

599
00:26:24,920 --> 00:26:30,890
obvious because it says<font color="#CCCCCC"> VirtualBox in</font>

600
00:26:27,500 --> 00:26:34,700
the bloody data so they only give the

601
00:26:30,890 --> 00:26:38,360
game away you can't<font color="#CCCCCC"> fake this you can</font>

602
00:26:34,700 --> 00:26:41,090
supply a fake binary blob as an AC grade

603
00:26:38,360 --> 00:26:43,250
level<font color="#E5E5E5"> however through the support forums</font>

604
00:26:41,090 --> 00:26:44,780
it sounds like things crash a lot when

605
00:26:43,250 --> 00:26:46,010
you do that because it thinks all of its

606
00:26:44,780 --> 00:26:47,810
<font color="#E5E5E5">got hitch head support and then hedge</font>

607
00:26:46,010 --> 00:26:51,080
head support isn't enabled and then the

608
00:26:47,810 --> 00:26:52,370
systems are just horse<font color="#E5E5E5"> I got because</font>

609
00:26:51,080 --> 00:26:55,250
nobody's ever really went into the

610
00:26:52,370 --> 00:26:56,719
corner case of whether the bio says yeah

611
00:26:55,250 --> 00:27:04,570
sure it's got his pet and then hate

612
00:26:56,720 --> 00:27:04,570
peddlin actually really exist excuse me

613
00:27:06,010 --> 00:27:11,320
<font color="#CCCCCC">wow that was actually</font><font color="#E5E5E5"> remarkably</font>

614
00:27:09,010 --> 00:27:15,550
oh yeah<font color="#CCCCCC"> I bought this in here as we make</font>

615
00:27:11,320 --> 00:27:18,639
soup into it so yeah there's not much in

616
00:27:15,550 --> 00:27:20,970
there you can see the box is in like

617
00:27:18,640 --> 00:27:27,040
most of the names and<font color="#CCCCCC"> there you can see</font>

618
00:27:20,970 --> 00:27:28,720
virtual box in the day sir so yeah so

619
00:27:27,040 --> 00:27:31,960
the<font color="#CCCCCC"> Box manage has options to put the</font>

620
00:27:28,720 --> 00:27:34,210
fav tasting card tables in its primary

621
00:27:31,960 --> 00:27:37,600
<font color="#CCCCCC">used to do the SLI sleep pass through so</font>

622
00:27:34,210 --> 00:27:39,610
if you've<font color="#CCCCCC"> got a si si that's in the</font>

623
00:27:37,600 --> 00:27:41,709
physical hardware and you want a license

624
00:27:39,610 --> 00:27:44,800
or PM instead of the physical<font color="#E5E5E5"> hardware</font>

625
00:27:41,710 --> 00:27:48,630
you can pass through the slic data from

626
00:27:44,800 --> 00:27:53,020
their<font color="#E5E5E5"> table and the actual underlying</font>

627
00:27:48,630 --> 00:27:56,140
virtual machine will respect the the SLR

628
00:27:53,020 --> 00:27:58,120
<font color="#CCCCCC">t is in there so you can license one</font>

629
00:27:56,140 --> 00:27:59,920
others inside but you can also use<font color="#E5E5E5"> it to</font>

630
00:27:58,120 --> 00:28:03,459
trick fender installers so for example

631
00:27:59,920 --> 00:28:05,590
there's a lot of server software that

632
00:28:03,460 --> 00:28:08,830
won't run apart from on the very

633
00:28:05,590 --> 00:28:10,449
<font color="#E5E5E5">specific piece</font><font color="#CCCCCC"> of hardware that it is</font>

634
00:28:08,830 --> 00:28:12,159
designed for so like you get some HP

635
00:28:10,450 --> 00:28:14,920
server and then you'll<font color="#E5E5E5"> get some HP</font>

636
00:28:12,160 --> 00:28:16,600
software and only one HP server so<font color="#CCCCCC"> you</font>

637
00:28:14,920 --> 00:28:18,520
pass through stuff throughout the end

638
00:28:16,600 --> 00:28:21,490
because at the end we'll go oh<font color="#CCCCCC"> well I'm</font>

639
00:28:18,520 --> 00:28:22,870
not<font color="#E5E5E5"> HP server because on the vm so if i</font>

640
00:28:21,490 --> 00:28:25,810
can install so you can also use<font color="#E5E5E5"> that as</font>

641
00:28:22,870 --> 00:28:27,850
a trick to get around there and yeah it

642
00:28:25,810 --> 00:28:29,350
works until you actually try to use the

643
00:28:27,850 --> 00:28:30,580
advertised features you can talk to

644
00:28:29,350 --> 00:28:34,659
assembles and you can talk to the

645
00:28:30,580 --> 00:28:37,629
hardware that<font color="#E5E5E5"> you thought was there so</font>

646
00:28:34,660 --> 00:28:41,740
learning on to looking at the actual

647
00:28:37,630 --> 00:28:43,870
guest VM the registry on that guest VM

648
00:28:41,740 --> 00:28:46,780
will have certain artifacts that<font color="#E5E5E5"> would</font>

649
00:28:43,870 --> 00:28:49,270
give<font color="#E5E5E5"> away the game then the specific</font>

650
00:28:46,780 --> 00:28:53,110
keys so stuff<font color="#E5E5E5"> this setup for</font><font color="#CCCCCC"> VirtualBox</font>

651
00:28:49,270 --> 00:28:54,520
<font color="#E5E5E5">p.m. where I believe whatever they sell</font>

652
00:28:53,110 --> 00:28:59,590
it for stuff like the guest packages to

653
00:28:54,520 --> 00:29:01,930
get guest drivers it's like that install

654
00:28:59,590 --> 00:29:04,810
software Lodge analysis tools again they

655
00:29:01,930 --> 00:29:08,380
leave registry keys and the windows

656
00:29:04,810 --> 00:29:11,110
installed a some reason a lot of analyst

657
00:29:08,380 --> 00:29:12,380
machines settings in 1999 which is<font color="#E5E5E5"> just</font>

658
00:29:11,110 --> 00:29:16,520
really confusing because

659
00:29:12,380 --> 00:29:18,380
has 1999 it's obviously up there there

660
00:29:16,520 --> 00:29:19,460
is a better check did the version<font color="#E5E5E5"> of</font>

661
00:29:18,380 --> 00:29:22,220
<font color="#E5E5E5">Windows that's running on this system</font>

662
00:29:19,460 --> 00:29:23,840
<font color="#E5E5E5">come out after the install date because</font>

663
00:29:22,220 --> 00:29:27,770
if that's the<font color="#E5E5E5"> case something fishy's</font>

664
00:29:23,840 --> 00:29:30,919
going on also known install like these

665
00:29:27,770 --> 00:29:32,450
<font color="#CCCCCC">and serial numbers again really</font><font color="#E5E5E5"> common</font>

666
00:29:30,920 --> 00:29:36,140
check and most people caught sorta know

667
00:29:32,450 --> 00:29:40,220
about by now and actually do I really

668
00:29:36,140 --> 00:29:42,320
papers so bm's don't use normal drivers

669
00:29:40,220 --> 00:29:44,750
because the harder the guys virtualized

670
00:29:42,320 --> 00:29:46,550
so it doesn't act normally if you've

671
00:29:44,750 --> 00:29:50,900
ever tried to use the<font color="#CCCCCC"> VirtualBox</font>

672
00:29:46,550 --> 00:29:53,409
graphics drivers with<font color="#E5E5E5"> accelerated 3d</font>

673
00:29:50,900 --> 00:29:55,550
<font color="#CCCCCC">you'll know how much</font><font color="#E5E5E5"> of a pain they are</font>

674
00:29:53,410 --> 00:29:57,470
so yeah<font color="#E5E5E5"> you've got video by the sound</font>

675
00:29:55,550 --> 00:29:59,659
guy there's printer drivers all sorts of

676
00:29:57,470 --> 00:30:00,860
crazy stuff so even mouse and keyboard

677
00:29:59,660 --> 00:30:04,160
it have to be virtualized because

678
00:30:00,860 --> 00:30:05,990
obviously you don't always have focus on

679
00:30:04,160 --> 00:30:07,730
the vm which means that<font color="#E5E5E5"> sometimes it has</font>

680
00:30:05,990 --> 00:30:09,230
to happen<font color="#CCCCCC"> twittered cases that you</font><font color="#E5E5E5"> just</font>

681
00:30:07,730 --> 00:30:11,710
<font color="#E5E5E5">normally would never have to worry about</font>

682
00:30:09,230 --> 00:30:14,090
with real other so you can look<font color="#E5E5E5"> at the</font>

683
00:30:11,710 --> 00:30:17,390
running driver list you could file

684
00:30:14,090 --> 00:30:20,600
system for the<font color="#CCCCCC"> driver files or like the</font>

685
00:30:17,390 --> 00:30:23,060
running driver service you<font color="#CCCCCC"> looked at</font>

686
00:30:20,600 --> 00:30:24,679
utilities so for example<font color="#E5E5E5"> dr. box has a</font>

687
00:30:23,060 --> 00:30:26,870
bunch of utilities that are used for the

688
00:30:24,680 --> 00:30:28,850
networking stuff you can identify them

689
00:30:26,870 --> 00:30:30,919
on the desk you can just look look at

690
00:30:28,850 --> 00:30:33,980
the see if they're running you look at

691
00:30:30,920 --> 00:30:36,470
the DLLs on this blah blah and you can

692
00:30:33,980 --> 00:30:39,230
start the new era in the boss for

693
00:30:36,470 --> 00:30:41,330
<font color="#E5E5E5">crystal drivers and see if they respond</font>

694
00:30:39,230 --> 00:30:42,110
to any that real drivers wouldn't so

695
00:30:41,330 --> 00:30:43,730
that way that's another way to

696
00:30:42,110 --> 00:30:45,290
fingerprint so you can say even if they

697
00:30:43,730 --> 00:30:47,450
change the name of driver<font color="#E5E5E5"> I can work</font>

698
00:30:45,290 --> 00:30:50,870
after they respond to these<font color="#CCCCCC"> ten ioctl</font>

699
00:30:47,450 --> 00:30:55,730
that no other mass drive actually does

700
00:30:50,870 --> 00:30:58,820
and I'm going to<font color="#E5E5E5"> fight that way so it</font>

701
00:30:55,730 --> 00:31:00,970
does require more work anyway objects

702
00:30:58,820 --> 00:31:03,679
indicators so the windows object in

703
00:31:00,970 --> 00:31:07,610
<font color="#CCCCCC">Windows object namespace contains things</font>

704
00:31:03,680 --> 00:31:08,840
like new Texas semaphores events all

705
00:31:07,610 --> 00:31:10,879
sorts of stuff that<font color="#E5E5E5"> you wouldn't see on</font>

706
00:31:08,840 --> 00:31:14,620
the file system but are named objects

707
00:31:10,880 --> 00:31:18,520
that multiple processors want to access

708
00:31:14,620 --> 00:31:21,530
so things like drivers

709
00:31:18,520 --> 00:31:24,320
certain file system and points or just

710
00:31:21,530 --> 00:31:27,770
object any object in space you can<font color="#E5E5E5"> look</font>

711
00:31:24,320 --> 00:31:31,010
at what the process has open so handles

712
00:31:27,770 --> 00:31:32,900
to which objects and you<font color="#E5E5E5"> can look for</font>

713
00:31:31,010 --> 00:31:36,049
<font color="#E5E5E5">specific objects by name so you could</font>

714
00:31:32,900 --> 00:31:38,870
say well when the virtualbox<font color="#CCCCCC"> I've shared</font>

715
00:31:36,049 --> 00:31:42,110
folder driver is running it creates<font color="#CCCCCC"> this</font>

716
00:31:38,870 --> 00:31:43,850
event and if this event is there then

717
00:31:42,110 --> 00:31:46,449
obviously the virtualbox driver is when

718
00:31:43,850 --> 00:31:49,270
it which means i'm running in again and

719
00:31:46,450 --> 00:31:54,260
yeah so there I think that's a nice cool

720
00:31:49,270 --> 00:31:57,440
cheap trick so even if the the process

721
00:31:54,260 --> 00:32:00,350
or like the driver<font color="#CCCCCC"> that has a handle to</font>

722
00:31:57,440 --> 00:32:02,720
these objects is hidden by a rootkit so

723
00:32:00,350 --> 00:32:05,389
say for example you enumerate through

724
00:32:02,720 --> 00:32:06,890
the list of running processes and a

725
00:32:05,390 --> 00:32:09,590
rootkit in background takes the e

726
00:32:06,890 --> 00:32:11,000
process list from the colonel<font color="#E5E5E5"> and chops</font>

727
00:32:09,590 --> 00:32:12,709
off the process<font color="#CCCCCC"> that you actually want</font>

728
00:32:11,000 --> 00:32:14,450
to find you and your<font color="#E5E5E5"> way through you</font>

729
00:32:12,710 --> 00:32:16,880
don't seem to process you<font color="#CCCCCC"> go oh great</font>

730
00:32:14,450 --> 00:32:18,950
there's no good robot versus me that's

731
00:32:16,880 --> 00:32:21,110
<font color="#CCCCCC">awesome I'm not ringing a vm however if</font>

732
00:32:18,950 --> 00:32:23,210
you then go look for things like this

733
00:32:21,110 --> 00:32:25,159
object here well the object is still

734
00:32:23,210 --> 00:32:26,929
there still exists even<font color="#CCCCCC"> though the</font>

735
00:32:25,160 --> 00:32:28,130
process has<font color="#E5E5E5"> been hidden so even if</font>

736
00:32:26,929 --> 00:32:30,290
you've got a rootkit that hides the

737
00:32:28,130 --> 00:32:33,169
process you can still spot back sort of

738
00:32:30,290 --> 00:32:34,639
thing from windows objects you can also

739
00:32:33,169 --> 00:32:36,799
buy a rootkit that I suppose to<font color="#CCCCCC"> well of</font>

740
00:32:34,640 --> 00:32:41,090
course you know it's<font color="#E5E5E5"> just you</font><font color="#CCCCCC"> know it's</font>

741
00:32:36,799 --> 00:32:45,320
more<font color="#E5E5E5"> work the fence indicators nobody</font>

742
00:32:41,090 --> 00:32:48,490
<font color="#E5E5E5">does this they should if you want to see</font>

743
00:32:45,320 --> 00:32:51,770
if you're running in a vm or that if

744
00:32:48,490 --> 00:32:54,130
analyst tools were ever installed look

745
00:32:51,770 --> 00:32:57,710
through the windows event log because

746
00:32:54,130 --> 00:33:00,110
nobody ever<font color="#CCCCCC"> clears it so when i install</font>

747
00:32:57,710 --> 00:33:02,870
visual studio it creates an absolute

748
00:33:00,110 --> 00:33:04,850
 ton of events it says<font color="#CCCCCC"> i'm</font><font color="#E5E5E5"> going to</font>

749
00:33:02,870 --> 00:33:06,439
install now<font color="#E5E5E5"> i'm installing now i</font>

750
00:33:04,850 --> 00:33:08,480
finished installing now I finish

751
00:33:06,440 --> 00:33:10,160
creating a system restore point LOL

752
00:33:08,480 --> 00:33:12,830
<font color="#E5E5E5">alright here's all the service packs on</font>

753
00:33:10,160 --> 00:33:14,360
installing and you can go<font color="#E5E5E5"> ok so you've</font>

754
00:33:12,830 --> 00:33:15,590
hidden that<font color="#E5E5E5"> but now</font><font color="#CCCCCC"> i</font><font color="#E5E5E5"> can just look back</font>

755
00:33:14,360 --> 00:33:17,809
through the events and see that you did

756
00:33:15,590 --> 00:33:20,439
that<font color="#E5E5E5"> or when you first set up at the end</font>

757
00:33:17,809 --> 00:33:23,059
you put the tools on there so look the

758
00:33:20,440 --> 00:33:24,260
<font color="#E5E5E5">guest told on so you can resize it to a</font>

759
00:33:23,059 --> 00:33:24,750
nice resolution so that when you're

760
00:33:24,260 --> 00:33:26,250
installing

761
00:33:24,750 --> 00:33:27,900
tools it wasn't a massive pain in the

762
00:33:26,250 --> 00:33:30,660
<font color="#E5E5E5">ass and so that</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> can file copier in</font>

763
00:33:27,900 --> 00:33:32,430
and out and then you remove them but you

764
00:33:30,660 --> 00:33:34,890
left the event logs behind so<font color="#CCCCCC"> I can see</font>

765
00:33:32,430 --> 00:33:38,010
that you did that so nobody does that

766
00:33:34,890 --> 00:33:41,100
<font color="#E5E5E5">for some reason sure it's cool you can</font>

767
00:33:38,010 --> 00:33:43,080
also check to things like a real

768
00:33:41,100 --> 00:33:45,540
hardware when you turn<font color="#CCCCCC"> it</font><font color="#E5E5E5"> on and turn it</font>

769
00:33:43,080 --> 00:33:47,399
off and suspend it creates different

770
00:33:45,540 --> 00:33:49,649
vlogs so when you do the same<font color="#CCCCCC"> thing with</font>

771
00:33:47,400 --> 00:33:50,820
a vm just simply<font color="#CCCCCC"> because of</font><font color="#E5E5E5"> the way the</font>

772
00:33:49,650 --> 00:33:53,100
power management works on a virtual

773
00:33:50,820 --> 00:33:54,300
system so when you look<font color="#E5E5E5"> at the event IDs</font>

774
00:33:53,100 --> 00:33:58,350
<font color="#E5E5E5">and you look at the event</font><font color="#CCCCCC"> Baker and</font>

775
00:33:54,300 --> 00:34:00,629
stuff it's<font color="#E5E5E5"> just different and it's not</font>

776
00:33:58,350 --> 00:34:02,070
really obvious to show in a slide but it

777
00:34:00,630 --> 00:34:03,570
is just<font color="#E5E5E5"> different and</font><font color="#CCCCCC"> if you have a dig</font>

778
00:34:02,070 --> 00:34:05,669
around you can<font color="#CCCCCC"> see how different because</font>

779
00:34:03,570 --> 00:34:09,360
it's just<font color="#E5E5E5"> like the timing and stuff is a</font>

780
00:34:05,670 --> 00:34:11,550
bit weird mr.<font color="#E5E5E5"> two indicators so we</font>

781
00:34:09,360 --> 00:34:16,649
talked a little bit<font color="#CCCCCC"> before about SC 4.1</font>

782
00:34:11,550 --> 00:34:18,389
4.2 and<font color="#CCCCCC"> AVX as extensions and there are</font>

783
00:34:16,649 --> 00:34:20,310
other ways using instructions that you

784
00:34:18,389 --> 00:34:23,129
can sort of biggering and work out if

785
00:34:20,310 --> 00:34:26,190
you running in a vm or running an

786
00:34:23,129 --> 00:34:28,440
emulator so for<font color="#E5E5E5"> example can you so</font>

787
00:34:26,190 --> 00:34:30,000
virtualization solutions don't create a

788
00:34:28,440 --> 00:34:31,490
perfect representation of the

789
00:34:30,000 --> 00:34:35,219
instructions and someone in the system

790
00:34:31,489 --> 00:34:36,839
this is just<font color="#E5E5E5"> that</font><font color="#CCCCCC"> thing that the</font><font color="#E5E5E5"> MS</font>

791
00:34:35,219 --> 00:34:38,969
don't do they can't because<font color="#E5E5E5"> it's not</font>

792
00:34:36,840 --> 00:34:42,570
real<font color="#CCCCCC"> holla and you need it so for</font>

793
00:34:38,969 --> 00:34:45,000
example<font color="#CCCCCC"> let's say</font><font color="#E5E5E5"> I want to write to a</font>

794
00:34:42,570 --> 00:34:47,610
particular block of hardware memory

795
00:34:45,000 --> 00:34:49,980
thats related<font color="#E5E5E5"> to the shed system memory</font>

796
00:34:47,610 --> 00:34:51,720
between my<font color="#E5E5E5"> bank card and my processor</font>

797
00:34:49,980 --> 00:34:53,219
because the main system memory has to

798
00:34:51,719 --> 00:34:55,439
obviously store some sort of frame

799
00:34:53,219 --> 00:34:57,120
buffer so that processor can go to pull

800
00:34:55,440 --> 00:34:58,980
let's draw something in this ring buffer

801
00:34:57,120 --> 00:35:00,810
and then that can be copied out to the

802
00:34:58,980 --> 00:35:02,430
grass or you can use a memory how

803
00:35:00,810 --> 00:35:04,020
to do the same sort of thing but you

804
00:35:02,430 --> 00:35:05,819
can't do that<font color="#CCCCCC"> in a vm directly because</font>

805
00:35:04,020 --> 00:35:07,560
if you could then you would just<font color="#E5E5E5"> be able</font>

806
00:35:05,820 --> 00:35:09,300
<font color="#E5E5E5">to override the screen regardless of</font>

807
00:35:07,560 --> 00:35:11,670
whether you were work like regardless of

808
00:35:09,300 --> 00:35:13,980
value in the vm will not the end it can

809
00:35:11,670 --> 00:35:15,600
just<font color="#E5E5E5"> go and read the display buffer from</font>

810
00:35:13,980 --> 00:35:16,800
outside of the vm and<font color="#E5E5E5"> that'd be awful</font>

811
00:35:15,600 --> 00:35:20,160
because then it would be<font color="#CCCCCC"> able</font><font color="#E5E5E5"> to read</font>

812
00:35:16,800 --> 00:35:22,260
your screen not the screen of the vm but

813
00:35:20,160 --> 00:35:23,759
if the<font color="#E5E5E5"> screen the rest of the screen of</font>

814
00:35:22,260 --> 00:35:26,540
the real system that would be really

815
00:35:23,760 --> 00:35:28,890
obvious that you're running her there<font color="#CCCCCC"> so</font>

816
00:35:26,540 --> 00:35:31,079
it's the<font color="#E5E5E5"> city you could do</font><font color="#CCCCCC"> that if the</font>

817
00:35:28,890 --> 00:35:33,058
virtual CPU could do that or like

818
00:35:31,079 --> 00:35:35,069
absolutely screwed with everything<font color="#E5E5E5"> if</font>

819
00:35:33,059 --> 00:35:36,839
<font color="#CCCCCC">you've got a</font><font color="#E5E5E5"> host system one in ten dm's</font>

820
00:35:35,069 --> 00:35:39,119
they could<font color="#CCCCCC"> just take a reading right</font>

821
00:35:36,839 --> 00:35:41,009
over each other and if you just don't so

822
00:35:39,119 --> 00:35:45,029
instead they have to be virtualizing

823
00:35:41,009 --> 00:35:47,700
like separate snail so many extensions

824
00:35:45,029 --> 00:35:50,729
odds available or<font color="#E5E5E5"> faked</font><font color="#CCCCCC"> that are deer</font>

825
00:35:47,700 --> 00:35:52,468
<font color="#E5E5E5">and an Aes supporter again</font><font color="#CCCCCC"> too commonly</font>

826
00:35:50,729 --> 00:35:54,359
just don't get too close to<font color="#CCCCCC"> the end all</font>

827
00:35:52,469 --> 00:35:56,489
in mind<font color="#E5E5E5"> particularly because there are</font>

828
00:35:54,359 --> 00:35:58,319
concerns about all what happens if the

829
00:35:56,489 --> 00:35:59,940
end users are<font color="#E5E5E5"> defined in a weird way and</font>

830
00:35:58,319 --> 00:36:02,249
messes with the entropy and blah blah

831
00:35:59,940 --> 00:36:03,859
blah this is this is security decisions

832
00:36:02,249 --> 00:36:09,029
what people who don't understand

833
00:36:03,859 --> 00:36:11,009
hardware and<font color="#CCCCCC"> another generators yeah so</font>

834
00:36:09,029 --> 00:36:13,349
you can check in to see if you as the

835
00:36:11,009 --> 00:36:17,729
beaches and then check if the teachers

836
00:36:13,349 --> 00:36:21,089
<font color="#CCCCCC">are really there their</font><font color="#E5E5E5"> specific codes so</font>

837
00:36:17,729 --> 00:36:23,368
these<font color="#E5E5E5"> are great so the way the way that</font>

838
00:36:21,089 --> 00:36:28,069
<font color="#E5E5E5">VirtualBox actually borrow it still does</font>

839
00:36:23,369 --> 00:36:30,539
<font color="#E5E5E5">whoever</font><font color="#CCCCCC"> to what used to do copy paste</font>

840
00:36:28,069 --> 00:36:31,739
sharing you could<font color="#E5E5E5"> basically copy</font>

841
00:36:30,539 --> 00:36:33,709
something into the clipboard and what

842
00:36:31,739 --> 00:36:36,779
would happen was it would actually admit

843
00:36:33,709 --> 00:36:39,779
an opcode that didn't exist it's not a

844
00:36:36,779 --> 00:36:43,099
real instruction on<font color="#CCCCCC"> the hardware and it</font>

845
00:36:39,779 --> 00:36:45,690
would generate a invalid opcode

846
00:36:43,099 --> 00:36:47,729
exception on CPU and the virtual<font color="#CCCCCC"> machine</font>

847
00:36:45,690 --> 00:36:50,519
would catch that exception and go<font color="#E5E5E5"> all</font>

848
00:36:47,729 --> 00:36:53,069
all recognize that opcode that means he

849
00:36:50,519 --> 00:36:55,140
wants to copy from the<font color="#E5E5E5"> clipboard inside</font>

850
00:36:53,069 --> 00:36:57,449
the machine to the clipboard outside the

851
00:36:55,140 --> 00:36:58,920
machine so it can<font color="#E5E5E5"> bring that and it</font>

852
00:36:57,449 --> 00:37:00,719
would carry out<font color="#E5E5E5"> and it would swallow</font>

853
00:36:58,920 --> 00:37:02,729
that exception it would swallow the

854
00:37:00,719 --> 00:37:05,369
invalid off code etc so what you<font color="#CCCCCC"> and</font>

855
00:37:02,729 --> 00:37:07,558
knew<font color="#E5E5E5"> she would run piece of malware that</font>

856
00:37:05,369 --> 00:37:10,380
tries to<font color="#E5E5E5"> run that instruction and then</font>

857
00:37:07,559 --> 00:37:13,170
<font color="#E5E5E5">suddenly you don't get an exception so</font>

858
00:37:10,380 --> 00:37:14,910
you know your interview there's<font color="#E5E5E5"> lots of</font>

859
00:37:13,170 --> 00:37:17,279
<font color="#CCCCCC">different little ones there's basically</font>

860
00:37:14,910 --> 00:37:19,670
anything where there's some sort of

861
00:37:17,279 --> 00:37:22,199
interaction between the host and guest

862
00:37:19,670 --> 00:37:24,829
most of the time you can that you<font color="#E5E5E5"> can</font>

863
00:37:22,199 --> 00:37:27,269
guess that it's either going to use

864
00:37:24,829 --> 00:37:29,309
photo op codes or it's going<font color="#E5E5E5"> to use the</font>

865
00:37:27,269 --> 00:37:30,538
in and out instructions and<font color="#E5E5E5"> due to some</font>

866
00:37:29,309 --> 00:37:34,920
weird stuff for that which again you can

867
00:37:30,539 --> 00:37:39,890
use as a all are you joking your device

868
00:37:34,920 --> 00:37:39,890
will restart at<font color="#CCCCCC"> 18 55 Thank You</font><font color="#E5E5E5"> windows</font>

869
00:37:40,850 --> 00:37:52,529
so I've 1655 or 15 minutes<font color="#CCCCCC"> thanks</font>

870
00:37:47,160 --> 00:37:54,720
windows thanks Microsoft I love<font color="#E5E5E5"> you yeah</font>

871
00:37:52,530 --> 00:37:56,340
poor implementation very much leads out

872
00:37:54,720 --> 00:37:58,919
on yourself so for example the<font color="#CCCCCC"> DMI</font>

873
00:37:56,340 --> 00:38:01,080
compound stuff and mount instructions

874
00:37:58,920 --> 00:38:03,210
you can<font color="#E5E5E5"> just basically call those and</font>

875
00:38:01,080 --> 00:38:05,100
see what happens normally you would get

876
00:38:03,210 --> 00:38:06,710
some dog and back in<font color="#E5E5E5"> this case it just</font>

877
00:38:05,100 --> 00:38:09,930
<font color="#E5E5E5">would do something completely different</font>

878
00:38:06,710 --> 00:38:12,690
the modern RM emulation book from

879
00:38:09,930 --> 00:38:17,279
fistful of red pills which is a talk /

880
00:38:12,690 --> 00:38:19,290
paper from some guys come<font color="#E5E5E5"> from who that</font>

881
00:38:17,280 --> 00:38:21,780
one was fun because basically what

882
00:38:19,290 --> 00:38:24,240
happened was the modern instruction

883
00:38:21,780 --> 00:38:26,280
wasn't red one understood properly so

884
00:38:24,240 --> 00:38:28,200
you could actually encode a set of

885
00:38:26,280 --> 00:38:31,110
parameters for mod and it would say oh

886
00:38:28,200 --> 00:38:32,700
yeah that's why I know it would<font color="#E5E5E5"> crash it</font>

887
00:38:31,110 --> 00:38:36,450
would actually crash can<font color="#E5E5E5"> you even just</font>

888
00:38:32,700 --> 00:38:38,990
modern kvm common the ice cream bikini

889
00:38:36,450 --> 00:38:41,759
instruction that used to crash<font color="#CCCCCC"> Kelly</font>

890
00:38:38,990 --> 00:38:44,310
<font color="#CCCCCC">Thomas aundi found that one and air</font>

891
00:38:41,760 --> 00:38:45,750
sorry particular in coatings of the air

892
00:38:44,310 --> 00:38:49,320
<font color="#CCCCCC">and destruction as well</font><font color="#E5E5E5"> used to crash</font>

893
00:38:45,750 --> 00:38:50,700
chemie so emulators are often a little

894
00:38:49,320 --> 00:38:53,400
bit more fragile because you can

895
00:38:50,700 --> 00:38:57,299
generally<font color="#E5E5E5"> just like crash them if they</font>

896
00:38:53,400 --> 00:39:00,060
get it wrong looks digging through the

897
00:38:57,300 --> 00:39:01,680
<font color="#E5E5E5">VirtualBox book tracker so yeah 443 home</font>

898
00:39:00,060 --> 00:39:03,299
team results<font color="#E5E5E5"> from Craig performance</font>

899
00:39:01,680 --> 00:39:05,279
council would go backwards towards about

900
00:39:03,300 --> 00:39:06,570
this before so you can go<font color="#E5E5E5"> back in time</font>

901
00:39:05,280 --> 00:39:09,000
and then work out we'll look it's back

902
00:39:06,570 --> 00:39:10,650
in time there's no going bug in the full

903
00:39:09,000 --> 00:39:12,330
point<font color="#CCCCCC"> next branch which causes the</font>

904
00:39:10,650 --> 00:39:13,980
highway<font color="#E5E5E5"> 18 timer</font><font color="#CCCCCC"> would not page packet</font>

905
00:39:12,330 --> 00:39:18,420
similar to<font color="#E5E5E5"> HP but it works in different</font>

906
00:39:13,980 --> 00:39:19,830
way to<font color="#CCCCCC"> lag and</font><font color="#E5E5E5"> skip by the vm is idle</font>

907
00:39:18,420 --> 00:39:22,680
speed steps and ableism of the steep

908
00:39:19,830 --> 00:39:26,310
speedstep problem easy detection because

909
00:39:22,680 --> 00:39:28,290
you monitor<font color="#CCCCCC"> the PPC output and what</font>

910
00:39:26,310 --> 00:39:31,320
happens is it will<font color="#E5E5E5"> go one second to</font>

911
00:39:28,290 --> 00:39:33,810
second three second 12 seconds 13 second

912
00:39:31,320 --> 00:39:35,280
<font color="#CCCCCC">Sports Institute</font><font color="#E5E5E5"> 19 seconds so</font><font color="#CCCCCC"> they'll</font>

913
00:39:33,810 --> 00:39:38,310
just be a big gap between the

914
00:39:35,280 --> 00:39:39,720
measurements um different registers five

915
00:39:38,310 --> 00:39:42,150
and six get zero in on every context

916
00:39:39,720 --> 00:39:44,549
switch from host of vm again that's an

917
00:39:42,150 --> 00:39:46,440
ongoing one so basically<font color="#E5E5E5"> you look for</font>

918
00:39:44,550 --> 00:39:48,570
<font color="#E5E5E5">some values</font><font color="#CCCCCC"> in the debug registers wait</font>

919
00:39:46,440 --> 00:39:50,599
for a<font color="#E5E5E5"> context switch see if the debug</font>

920
00:39:48,570 --> 00:39:55,729
browsers to wear when<font color="#E5E5E5"> it comes</font><font color="#CCCCCC"> back</font>

921
00:39:50,599 --> 00:39:58,009
then you know I am sending packets<font color="#E5E5E5"> with</font>

922
00:39:55,729 --> 00:40:02,269
<font color="#CCCCCC">an NT</font><font color="#E5E5E5"> user</font><font color="#CCCCCC"> lodgement in kilobytes and</font>

923
00:39:58,009 --> 00:40:04,309
setting a dope flagman fly if you've<font color="#E5E5E5"> got</font>

924
00:40:02,269 --> 00:40:06,558
a bridge adapter that breaks the<font color="#CCCCCC"> bridged</font>

925
00:40:04,309 --> 00:40:08,869
<font color="#CCCCCC">adapter in virtualbox</font><font color="#E5E5E5"> and it doesn't</font>

926
00:40:06,559 --> 00:40:11,180
understand how to do that so then the

927
00:40:08,869 --> 00:40:13,779
app the packet goes out and hits the

928
00:40:11,180 --> 00:40:16,819
remote server let's say<font color="#E5E5E5"> for example you</font>

929
00:40:13,779 --> 00:40:21,079
put an ICMP echo request in<font color="#E5E5E5"> there big</font>

930
00:40:16,819 --> 00:40:22,999
one with a large MTU you say that packet

931
00:40:21,079 --> 00:40:25,099
out it<font color="#E5E5E5"> will hit the remote server it</font>

932
00:40:22,999 --> 00:40:26,988
won't come back it won't be able to

933
00:40:25,099 --> 00:40:29,359
actually receive that packet back it

934
00:40:26,989 --> 00:40:33,799
just doesn't end somehow and many many

935
00:40:29,359 --> 00:40:39,140
more so that's fun that happens

936
00:40:33,799 --> 00:40:42,049
sometimes<font color="#E5E5E5"> so sometimes you do something</font>

937
00:40:39,140 --> 00:40:44,479
<font color="#CCCCCC">like for example sending a packet that</font>

938
00:40:42,049 --> 00:40:46,549
the network stack doesn't like and it

939
00:40:44,479 --> 00:40:48,229
will just crash the driver and that's

940
00:40:46,549 --> 00:40:49,729
pretty<font color="#E5E5E5"> obvious that you're running</font><font color="#CCCCCC"> in a</font>

941
00:40:48,229 --> 00:40:53,749
vm if it crashes with the VirtualBox

942
00:40:49,729 --> 00:40:56,390
driver because you know it's slightly

943
00:40:53,749 --> 00:41:01,660
disrupted but think an analyst might

944
00:40:56,390 --> 00:41:01,660
notice unless they're particularly done

945
00:41:02,140 --> 00:41:06,430
yeah so again is pretty easy to notice

946
00:41:04,579 --> 00:41:11,089
that your enter vm it's pretty hard to

947
00:41:06,430 --> 00:41:14,149
fake that you're not nvm it's<font color="#E5E5E5"> really</font>

948
00:41:11,089 --> 00:41:16,670
<font color="#E5E5E5">hard to do it only for some coffee</font><font color="#CCCCCC"> so</font>

949
00:41:14,150 --> 00:41:21,710
<font color="#CCCCCC">I'm doctors I mean stuff like San bhakti</font>

950
00:41:16,670 --> 00:41:27,579
not like the chrome sandbox and again

951
00:41:21,710 --> 00:41:29,779
this is more of a on system method of

952
00:41:27,579 --> 00:41:30,950
encapsulating things so you've got<font color="#E5E5E5"> to</font>

953
00:41:29,779 --> 00:41:32,630
<font color="#E5E5E5">get down and dirty with the real process</font>

954
00:41:30,950 --> 00:41:34,489
you want to dig<font color="#CCCCCC"> into if you've</font><font color="#E5E5E5"> got a</font>

955
00:41:32,630 --> 00:41:36,140
hook it you're<font color="#E5E5E5"> going to do things that</font>

956
00:41:34,489 --> 00:41:37,190
where it might be able<font color="#E5E5E5"> to know just if</font>

957
00:41:36,140 --> 00:41:40,308
you're there<font color="#E5E5E5"> it's a little bit</font><font color="#CCCCCC"> easier to</font>

958
00:41:37,190 --> 00:41:42,440
<font color="#E5E5E5">spot these devices</font><font color="#CCCCCC"> saudi ballgame</font>

959
00:41:40,309 --> 00:41:44,779
volcanes there's some specific<font color="#E5E5E5"> solutions</font>

960
00:41:42,440 --> 00:41:46,400
<font color="#E5E5E5">like some moxie and whatever and</font><font color="#CCCCCC"> then</font>

961
00:41:44,779 --> 00:41:51,170
there are generic indicators that you

962
00:41:46,400 --> 00:41:52,819
can use<font color="#E5E5E5"> just a seizure in a sandbox dew</font>

963
00:41:51,170 --> 00:41:54,710
point<font color="#CCCCCC"> X so these are all under stuff in</font>

964
00:41:52,819 --> 00:41:56,290
common each source because they don't

965
00:41:54,710 --> 00:41:58,400
detect the<font color="#CCCCCC"> sandbox as they detect</font>

966
00:41:56,290 --> 00:42:02,029
debugging not really gonna talk about

967
00:41:58,400 --> 00:42:03,710
<font color="#CCCCCC">this</font><font color="#E5E5E5"> has been done to death</font><font color="#CCCCCC"> booking</font>

968
00:42:02,030 --> 00:42:06,050
detection so honks redirect to the code

969
00:42:03,710 --> 00:42:07,910
the code alternatively routines so the

970
00:42:06,050 --> 00:42:09,950
idea is that I go to<font color="#E5E5E5"> call this API</font>

971
00:42:07,910 --> 00:42:11,359
instead of<font color="#E5E5E5"> calling that API I call some</font>

972
00:42:09,950 --> 00:42:12,680
other function which messes with the

973
00:42:11,359 --> 00:42:16,130
results of the river guys and then gets

974
00:42:12,680 --> 00:42:18,770
we've garbage out the back you<font color="#CCCCCC"> can also</font>

975
00:42:16,130 --> 00:42:22,480
do it system-wide with s<font color="#CCCCCC"> Aditi hooks IDT</font>

976
00:42:18,770 --> 00:42:25,089
hooks redirecting the NT functions again

977
00:42:22,480 --> 00:42:28,040
not really going<font color="#E5E5E5"> to talk about that</font>

978
00:42:25,089 --> 00:42:29,390
there's also supported stuff like<font color="#CCCCCC"> shorts</font>

979
00:42:28,040 --> 00:42:31,940
drivers and callbacks which game can be

980
00:42:29,390 --> 00:42:34,879
used and delicious ways but<font color="#E5E5E5"> normally</font>

981
00:42:31,940 --> 00:42:36,859
they talk about detecting these laws so

982
00:42:34,880 --> 00:42:39,400
normal functions start with more VBIED<font color="#CCCCCC"> I</font>

983
00:42:36,859 --> 00:42:42,710
used to like not means it does nothing

984
00:42:39,400 --> 00:42:46,700
it<font color="#E5E5E5"> moves the value of e di register into</font>

985
00:42:42,710 --> 00:42:49,520
the EDI register the normal function has

986
00:42:46,700 --> 00:42:51,680
five no<font color="#CCCCCC"> whites before this this is when</font>

987
00:42:49,520 --> 00:42:53,720
<font color="#CCCCCC">piled with a MARSOC</font><font color="#E5E5E5"> compiler because</font>

988
00:42:51,680 --> 00:42:55,899
this actually supports details and the

989
00:42:53,720 --> 00:42:58,819
idea<font color="#CCCCCC"> is you can put a jump minus five in</font>

990
00:42:55,900 --> 00:43:00,650
the mob EDI EDI<font color="#CCCCCC"> X is 2 by</font><font color="#E5E5E5"> its ripped</font>

991
00:42:58,820 --> 00:43:03,710
<font color="#E5E5E5">ring and then put another jump somewhere</font>

992
00:43:00,650 --> 00:43:05,359
in that there's<font color="#CCCCCC"> five lights before</font><font color="#E5E5E5"> so</font>

993
00:43:03,710 --> 00:43:08,410
when you call<font color="#E5E5E5"> the function instead of</font>

994
00:43:05,359 --> 00:43:11,540
doing multi EDI EDI and going into

995
00:43:08,410 --> 00:43:13,368
creating a stack frame instead what

996
00:43:11,540 --> 00:43:15,890
happens is it backwards<font color="#CCCCCC"> 5 bytes and then</font>

997
00:43:13,369 --> 00:43:18,980
somewhere completely different and that

998
00:43:15,890 --> 00:43:21,589
way you d toward the call you can also

999
00:43:18,980 --> 00:43:24,890
<font color="#E5E5E5">use load library and get bak address to</font>

1000
00:43:21,589 --> 00:43:26,990
find the pointer to the API and find a

1001
00:43:24,890 --> 00:43:29,240
bunch<font color="#E5E5E5"> of other</font><font color="#CCCCCC"> egg guys that are inside</font>

1002
00:43:26,990 --> 00:43:31,669
the same module and work out whether the

1003
00:43:29,240 --> 00:43:37,129
one that you were<font color="#E5E5E5"> trying to call the</font>

1004
00:43:31,670 --> 00:43:40,310
target was in sorry<font color="#E5E5E5"> I'm reading in time</font>

1005
00:43:37,130 --> 00:43:42,410
Dante we read the<font color="#CCCCCC"> data at that function</font>

1006
00:43:40,310 --> 00:43:44,450
and work out whether the data matches so

1007
00:43:42,410 --> 00:43:46,970
whenever there is that fried bite of

1008
00:43:44,450 --> 00:43:49,368
northern<font color="#E5E5E5"> mali dia dia so I all talk</font>

1009
00:43:46,970 --> 00:43:53,089
about<font color="#E5E5E5"> something else um what is not a</font>

1010
00:43:49,369 --> 00:43:54,710
penny<font color="#CCCCCC"> okay um basically a lot of time</font>

1011
00:43:53,089 --> 00:43:55,849
when people changed like a point is

1012
00:43:54,710 --> 00:43:57,859
almost 0 for example<font color="#CCCCCC"> the hook</font>

1013
00:43:55,849 --> 00:43:59,610
getprocaddress so you go get proper

1014
00:43:57,859 --> 00:44:02,730
dress on this particular function

1015
00:43:59,610 --> 00:44:04,650
maybe what the address<font color="#E5E5E5"> of this function</font>

1016
00:44:02,730 --> 00:44:05,580
is and they'll return a completely

1017
00:44:04,650 --> 00:44:06,980
different address somewhere completely

1018
00:44:05,580 --> 00:44:09,210
different so that when you try<font color="#E5E5E5"> and</font>

1019
00:44:06,980 --> 00:44:11,190
execute that you're executing<font color="#CCCCCC"> a</font>

1020
00:44:09,210 --> 00:44:13,440
completely different section of code so

1021
00:44:11,190 --> 00:44:16,380
what you can do is you can<font color="#E5E5E5"> go okay how</font>

1022
00:44:13,440 --> 00:44:18,060
big is the code section this<font color="#E5E5E5"> library so</font>

1023
00:44:16,380 --> 00:44:21,380
was the point in you gave me inside that

1024
00:44:18,060 --> 00:44:24,120
<font color="#E5E5E5">code section if not probably sketchy</font>

1025
00:44:21,380 --> 00:44:26,760
<font color="#E5E5E5">okay this is my geography book stuff I'm</font>

1026
00:44:24,120 --> 00:44:31,020
<font color="#E5E5E5">just in a very few skip over this um so</font>

1027
00:44:26,760 --> 00:44:34,770
<font color="#E5E5E5">boxy I'll see you you just say is this</font>

1028
00:44:31,020 --> 00:44:38,970
module loaded it is look son boxing so

1029
00:44:34,770 --> 00:44:42,960
that's easy why does kernel32 have that

1030
00:44:38,970 --> 00:44:47,430
function in it if it does<font color="#E5E5E5"> I'm in one see</font>

1031
00:44:42,960 --> 00:44:49,320
these<font color="#E5E5E5"> guys make it easy so is my stdio</font>

1032
00:44:47,430 --> 00:44:50,759
new director<font color="#CCCCCC"> knows my standard importer</font>

1033
00:44:49,320 --> 00:44:54,900
apple tree director a lot of the time

1034
00:44:50,760 --> 00:44:56,610
when things are doing like monitoring of

1035
00:44:54,900 --> 00:44:58,500
your process and dumping it for a report

1036
00:44:56,610 --> 00:45:00,720
they're going<font color="#E5E5E5"> wanna know what comes out</font>

1037
00:44:58,500 --> 00:45:02,880
of step send it out so they'll be

1038
00:45:00,720 --> 00:45:05,370
<font color="#E5E5E5">directed it's my parent process</font>

1039
00:45:02,880 --> 00:45:07,350
explorer.exe am i running a different

1040
00:45:05,370 --> 00:45:11,750
<font color="#CCCCCC">user to my parents and we're really</font>

1041
00:45:07,350 --> 00:45:14,220
positive over the job so our job is a

1042
00:45:11,750 --> 00:45:15,840
window is sort of structure where<font color="#CCCCCC"> you</font>

1043
00:45:14,220 --> 00:45:18,660
can group vocal processes together

1044
00:45:15,840 --> 00:45:20,340
nigeria's that if the owner of the job

1045
00:45:18,660 --> 00:45:23,490
gets killed it kills<font color="#E5E5E5"> all the</font><font color="#CCCCCC"> pepper</font>

1046
00:45:20,340 --> 00:45:25,590
child processes it's<font color="#E5E5E5"> useful for</font>

1047
00:45:23,490 --> 00:45:27,810
<font color="#E5E5E5">debugging because you can have</font><font color="#CCCCCC"> ten</font>

1048
00:45:25,590 --> 00:45:29,880
processors running all the sack under

1049
00:45:27,810 --> 00:45:35,460
the same debug session you kill the

1050
00:45:29,880 --> 00:45:36,960
debugger or their purses end so<font color="#CCCCCC"> be</font>

1051
00:45:35,460 --> 00:45:38,850
booking a process it's<font color="#E5E5E5"> probably in the</font>

1052
00:45:36,960 --> 00:45:43,020
<font color="#E5E5E5">job so you can know identify that way</font>

1053
00:45:38,850 --> 00:45:44,430
all<font color="#E5E5E5"> in dbg is identifiable battling so</font>

1054
00:45:43,020 --> 00:45:45,750
sandbox is a relatively easy once you

1055
00:45:44,430 --> 00:45:47,839
actually get in the woods of<font color="#CCCCCC"> the malware</font>

1056
00:45:45,750 --> 00:45:52,770
it's both<font color="#CCCCCC"> of easy just to for it to go</font>

1057
00:45:47,840 --> 00:45:54,330
you're right<font color="#CCCCCC"> there I'm not nearly yeah</font>

1058
00:45:52,770 --> 00:45:56,040
brute kids are generally necessary to

1059
00:45:54,330 --> 00:45:57,880
stop you<font color="#CCCCCC"> from being like that</font><font color="#E5E5E5"> again</font>

1060
00:45:56,040 --> 00:46:00,029
you're working against<font color="#E5E5E5"> your crazy</font>

1061
00:45:57,880 --> 00:46:05,740
at this point it becomes quite<font color="#E5E5E5"> difficult</font>

1062
00:46:00,030 --> 00:46:09,370
behavior detection so a vm for an animal

1063
00:46:05,740 --> 00:46:13,000
excuse users isn't the same as the<font color="#CCCCCC"> PCE</font>

1064
00:46:09,370 --> 00:46:14,950
<font color="#CCCCCC">mom uses or you know whether like you're</font>

1065
00:46:13,000 --> 00:46:19,030
<font color="#E5E5E5">not physically interacting with</font><font color="#CCCCCC"> it in</font>

1066
00:46:14,950 --> 00:46:21,009
the same<font color="#CCCCCC"> way or</font><font color="#E5E5E5"> not using it to do the</font>

1067
00:46:19,030 --> 00:46:24,370
sort of thing that normal people use a

1068
00:46:21,010 --> 00:46:25,900
computer to do or not you possibly don't

1069
00:46:24,370 --> 00:46:28,020
have access to mobile sensors if<font color="#CCCCCC"> you're</font>

1070
00:46:25,900 --> 00:46:31,210
verte alized and it's a mobile device

1071
00:46:28,020 --> 00:46:34,420
for example Microsoft Surface if you're

1072
00:46:31,210 --> 00:46:38,410
<font color="#CCCCCC">running windows on it well that's an</font>

1073
00:46:34,420 --> 00:46:39,340
option what if his Android malware it

1074
00:46:38,410 --> 00:46:40,899
should be<font color="#CCCCCC"> able</font><font color="#E5E5E5"> to talk to the mobile</font>

1075
00:46:39,340 --> 00:46:42,520
sensors if you can't see that the mobile

1076
00:46:40,900 --> 00:46:44,620
sensors are doing something normal like

1077
00:46:42,520 --> 00:46:48,000
for example the accelerometer in it is

1078
00:46:44,620 --> 00:46:50,650
showing<font color="#E5E5E5"> that you're</font><font color="#CCCCCC"> walking or the</font>

1079
00:46:48,000 --> 00:46:52,240
gyroscope or the magnetometer aren't

1080
00:46:50,650 --> 00:46:55,030
giving you normal values you know it's

1081
00:46:52,240 --> 00:46:56,740
<font color="#E5E5E5">probably fake looking for a pattern of</font>

1082
00:46:55,030 --> 00:47:00,400
use so for<font color="#CCCCCC"> example</font><font color="#E5E5E5"> you want to look for</font>

1083
00:46:56,740 --> 00:47:02,020
hot spots so<font color="#CCCCCC"> screen like Windows desktop</font>

1084
00:47:00,400 --> 00:47:03,660
you got to start button bottom<font color="#E5E5E5"> left you</font>

1085
00:47:02,020 --> 00:47:05,740
got the current close button top right

1086
00:47:03,660 --> 00:47:07,600
you've<font color="#E5E5E5"> got these points that you're</font>

1087
00:47:05,740 --> 00:47:10,330
always<font color="#E5E5E5"> taking on and your back and</font>

1088
00:47:07,600 --> 00:47:13,569
<font color="#E5E5E5">forward buttons on a browser you sort of</font>

1089
00:47:10,330 --> 00:47:14,890
always hitting these hot spots if<font color="#CCCCCC"> you</font>

1090
00:47:13,570 --> 00:47:18,700
<font color="#E5E5E5">just randomly setting where the mouse</font>

1091
00:47:14,890 --> 00:47:20,410
goes then it's nothing like that so yeah

1092
00:47:18,700 --> 00:47:23,460
so<font color="#CCCCCC"> Mouse indicators is the matter</font><font color="#E5E5E5"> leave</font>

1093
00:47:20,410 --> 00:47:26,830
a comment Rick look for hot spots back

1094
00:47:23,460 --> 00:47:28,510
taking drag almost no paper mask<font color="#E5E5E5"> many</font>

1095
00:47:26,830 --> 00:47:30,310
things actually picked in route anything

1096
00:47:28,510 --> 00:47:32,160
you take<font color="#E5E5E5"> them drop all the time you be</font>

1097
00:47:30,310 --> 00:47:36,190
sergeant owes you move them around

1098
00:47:32,160 --> 00:47:38,980
people never do it<font color="#CCCCCC"> sir</font><font color="#E5E5E5"> those are</font>

1099
00:47:36,190 --> 00:47:40,630
indications<font color="#E5E5E5"> an analyst is not browsing</font>

1100
00:47:38,980 --> 00:47:43,030
the internet and unless it's not a

1101
00:47:40,630 --> 00:47:44,650
normal person they're not their vm is

1102
00:47:43,030 --> 00:47:46,120
not for their general use they're not

1103
00:47:44,650 --> 00:47:47,890
going on reddit they're not going on

1104
00:47:46,120 --> 00:47:50,560
<font color="#CCCCCC">twitter they're not going on hotmail</font>

1105
00:47:47,890 --> 00:47:54,509
office 365 they're not you know looking

1106
00:47:50,560 --> 00:47:54,509
around on the<font color="#E5E5E5"> Daily Mail what it is</font>

1107
00:47:54,650 --> 00:47:58,530
they don't have bookmarks don't have

1108
00:47:56,640 --> 00:48:02,160
plugins<font color="#E5E5E5"> you know it doesn't look</font><font color="#CCCCCC"> like a</font>

1109
00:47:58,530 --> 00:48:04,770
normal user these browsers are fake or

1110
00:48:02,160 --> 00:48:07,379
not being<font color="#E5E5E5"> used like a normal person with</font>

1111
00:48:04,770 --> 00:48:09,420
using mobile sensors as I mentioned

1112
00:48:07,380 --> 00:48:12,900
before<font color="#CCCCCC"> he's</font><font color="#E5E5E5"> not</font><font color="#CCCCCC"> there is that for mobile</font>

1113
00:48:09,420 --> 00:48:15,120
things move mobile things are interacted

1114
00:48:12,900 --> 00:48:17,040
with in a different way you make a call

1115
00:48:15,120 --> 00:48:21,029
on your phone<font color="#E5E5E5"> you put your phone next to</font>

1116
00:48:17,040 --> 00:48:23,100
your face and hopefully you<font color="#CCCCCC"> don't face</font>

1117
00:48:21,030 --> 00:48:25,020
style people because there's a proximity

1118
00:48:23,100 --> 00:48:27,839
sensor in there that says it's next to

1119
00:48:25,020 --> 00:48:29,400
my face so if<font color="#E5E5E5"> that proximity sensor</font>

1120
00:48:27,840 --> 00:48:31,710
never says anything is next to it then

1121
00:48:29,400 --> 00:48:33,360
it's probably not<font color="#CCCCCC"> a</font><font color="#E5E5E5"> real time if your</font>

1122
00:48:31,710 --> 00:48:35,160
<font color="#E5E5E5">home is not</font><font color="#CCCCCC"> moving I'm moving my phone</font>

1123
00:48:33,360 --> 00:48:36,780
it should<font color="#CCCCCC"> be pretty obvious that i'm</font>

1124
00:48:35,160 --> 00:48:38,129
<font color="#CCCCCC">doing my phone</font><font color="#E5E5E5"> even</font><font color="#CCCCCC"> when i got it in</font><font color="#E5E5E5"> my</font>

1125
00:48:36,780 --> 00:48:40,620
pocket<font color="#CCCCCC"> accelerometer is going to be</font>

1126
00:48:38,130 --> 00:48:42,510
showing that as<font color="#E5E5E5"> i walk</font><font color="#CCCCCC"> my leg is moving</font>

1127
00:48:40,620 --> 00:48:43,740
the magnetometer is going to be<font color="#E5E5E5"> picking</font>

1128
00:48:42,510 --> 00:48:45,600
up weird things because I'm stood next

1129
00:48:43,740 --> 00:48:48,089
to a speaker or something you know<font color="#E5E5E5"> all</font>

1130
00:48:45,600 --> 00:48:49,770
of<font color="#E5E5E5"> these things are going to be real</font>

1131
00:48:48,090 --> 00:48:51,480
values that you should be able to read

1132
00:48:49,770 --> 00:48:54,480
if<font color="#E5E5E5"> you can't read them it's probably not</font>

1133
00:48:51,480 --> 00:48:56,730
some obel device call history text

1134
00:48:54,480 --> 00:49:00,900
history and contacts<font color="#E5E5E5"> list as well that's</font>

1135
00:48:56,730 --> 00:49:02,340
all important another so this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> a</font>

1136
00:49:00,900 --> 00:49:03,600
really sketchy bit and I really hope<font color="#E5E5E5"> my</font>

1137
00:49:02,340 --> 00:49:06,600
laptop doesn't run down in<font color="#CCCCCC"> the</font><font color="#E5E5E5"> middle of</font>

1138
00:49:03,600 --> 00:49:09,750
this on the one hand online scammers<font color="#CCCCCC"> in</font>

1139
00:49:06,600 --> 00:49:11,700
sandboxes invite you to upload malicious

1140
00:49:09,750 --> 00:49:13,230
stuff to them on<font color="#E5E5E5"> the other hand they</font>

1141
00:49:11,700 --> 00:49:14,939
probably don't want that malicious stuff

1142
00:49:13,230 --> 00:49:16,590
<font color="#E5E5E5">to be targeting them and reading their</font>

1143
00:49:14,940 --> 00:49:19,590
data and<font color="#E5E5E5"> stealing water analysis</font>

1144
00:49:16,590 --> 00:49:21,540
software consult your<font color="#E5E5E5"> lawyer if I</font>

1145
00:49:19,590 --> 00:49:26,280
incarceration assists for more than four

1146
00:49:21,540 --> 00:49:28,640
hours waiting position so I focally

1147
00:49:26,280 --> 00:49:33,810
<font color="#E5E5E5">mashup measures so sites like cuckoo</font>

1148
00:49:28,640 --> 00:49:35,549
malware and new best bets unbox services

1149
00:49:33,810 --> 00:49:37,950
that you<font color="#CCCCCC"> upload open somehow I to do</font><font color="#E5E5E5"> and</font>

1150
00:49:35,550 --> 00:49:42,420
it says it read these files it read

1151
00:49:37,950 --> 00:49:44,009
these registry keys it did this

1152
00:49:42,420 --> 00:49:47,310
communication with this server this time

1153
00:49:44,010 --> 00:49:50,900
bolo here's all get<font color="#CCCCCC"> a</font><font color="#E5E5E5"> ticket it's born</font>

1154
00:49:47,310 --> 00:49:54,000
these processes it drop these fall so

1155
00:49:50,900 --> 00:49:55,320
you could upload something to it but

1156
00:49:54,000 --> 00:50:00,300
starts looking into<font color="#E5E5E5"> that kind of thing</font>

1157
00:49:55,320 --> 00:50:04,860
so you got y dr hon it when you can do

1158
00:50:00,300 --> 00:50:06,050
<font color="#E5E5E5">it live because</font><font color="#CCCCCC"> it's a limb so most</font>

1159
00:50:04,860 --> 00:50:11,990
<font color="#CCCCCC">motive may be illegal</font>

1160
00:50:06,050 --> 00:50:13,910
um what so yeah you don't want to really

1161
00:50:11,990 --> 00:50:15,529
<font color="#E5E5E5">have it they are actual</font><font color="#CCCCCC"> trated to a live</font>

1162
00:50:13,910 --> 00:50:18,140
host because then that live host becomes

1163
00:50:15,530 --> 00:50:20,060
known as a dodging our website and you

1164
00:50:18,140 --> 00:50:22,279
know I don't<font color="#E5E5E5"> really like my domain with</font>

1165
00:50:20,060 --> 00:50:25,549
my<font color="#CCCCCC"> heroes</font><font color="#E5E5E5"> in for making the same</font><font color="#CCCCCC"> my way</font>

1166
00:50:22,280 --> 00:50:27,650
um so standard out is often printed but

1167
00:50:25,550 --> 00:50:29,600
it ends in length because that way you

1168
00:50:27,650 --> 00:50:31,940
could just<font color="#E5E5E5"> go quite here this is all of</font>

1169
00:50:29,600 --> 00:50:36,080
processes that are ringing and here's

1170
00:50:31,940 --> 00:50:37,430
the contents of this file and<font color="#CCCCCC"> it</font><font color="#E5E5E5"> would</font>

1171
00:50:36,080 --> 00:50:39,350
just<font color="#E5E5E5"> tell me the report would</font><font color="#CCCCCC"> remove man</font>

1172
00:50:37,430 --> 00:50:41,390
so what else is<font color="#E5E5E5"> in the report for</font>

1173
00:50:39,350 --> 00:50:42,740
operations registry access dns lookups

1174
00:50:41,390 --> 00:50:45,020
lots of static analysis stuff but we

1175
00:50:42,740 --> 00:50:46,790
don't you care about that idea is you

1176
00:50:45,020 --> 00:50:48,380
want<font color="#E5E5E5"> to cram as much data into that as</font>

1177
00:50:46,790 --> 00:50:51,080
possible and the way you do that is by

1178
00:50:48,380 --> 00:50:53,690
faking activity dynamically based on the

1179
00:50:51,080 --> 00:50:55,100
contents of files or the contact of<font color="#CCCCCC"> the</font>

1180
00:50:53,690 --> 00:50:59,540
piece of information you<font color="#E5E5E5"> want to dump</font>

1181
00:50:55,100 --> 00:51:01,250
out of the system so you can read lots

1182
00:50:59,540 --> 00:51:03,680
of files prefix the names of the

1183
00:51:01,250 --> 00:51:06,200
negative integer indices and then have

1184
00:51:03,680 --> 00:51:08,450
the<font color="#CCCCCC"> filenames be like base64 encoded</font>

1185
00:51:06,200 --> 00:51:13,100
blocks of the file so you can say okay<font color="#CCCCCC"> I</font>

1186
00:51:08,450 --> 00:51:15,560
try to read blah 00<font color="#CCCCCC"> 01 underscore big</font>

1187
00:51:13,100 --> 00:51:19,759
load the file data.txt then<font color="#E5E5E5"> I try to</font>

1188
00:51:15,560 --> 00:51:21,920
really blah on score 0-0<font color="#CCCCCC"> to next big</font>

1189
00:51:19,760 --> 00:51:25,700
block of text and that way once you take

1190
00:51:21,920 --> 00:51:27,800
off whose final access results out of

1191
00:51:25,700 --> 00:51:31,669
the<font color="#E5E5E5"> report you stick them back together</font>

1192
00:51:27,800 --> 00:51:33,920
in the order<font color="#CCCCCC"> 100 129 99 the contents of</font>

1193
00:51:31,670 --> 00:51:35,360
those<font color="#E5E5E5"> file names becomes the data that</font>

1194
00:51:33,920 --> 00:51:36,710
you actually just<font color="#CCCCCC"> a conf rated so you</font>

1195
00:51:35,360 --> 00:51:38,690
meant will try to in the file menu next

1196
00:51:36,710 --> 00:51:41,810
property in the registry key names that

1197
00:51:38,690 --> 00:51:43,340
you try<font color="#E5E5E5"> to access blah blah the idea is</font>

1198
00:51:41,810 --> 00:51:45,290
you can then stop dumping out things

1199
00:51:43,340 --> 00:51:46,610
like their analysis software and then

1200
00:51:45,290 --> 00:51:49,060
you start digging<font color="#CCCCCC"> around it there's no</font>

1201
00:51:46,610 --> 00:51:52,970
para season it because I didn't do it

1202
00:51:49,060 --> 00:51:56,090
<font color="#E5E5E5">and you shouldn't either without sex</font>

1203
00:51:52,970 --> 00:51:57,580
<font color="#E5E5E5">pressed for me so what I want to dump</font>

1204
00:51:56,090 --> 00:52:00,320
all of them to<font color="#CCCCCC"> process the module list</font>

1205
00:51:57,580 --> 00:52:02,390
contents of interesting foil registry

1206
00:52:00,320 --> 00:52:02,960
keys were interested then again back for

1207
00:52:02,390 --> 00:52:06,700
those juicy

1208
00:52:02,960 --> 00:52:08,900
indicators like what stirred unload the

1209
00:52:06,700 --> 00:52:12,618
serial number of<font color="#E5E5E5"> the OS install or</font>

1210
00:52:08,900 --> 00:52:14,270
whatever you like an afternoon<font color="#E5E5E5"> of</font>

1211
00:52:12,619 --> 00:52:15,740
messing around with simple code can get

1212
00:52:14,270 --> 00:52:17,420
you the results that you actually want

1213
00:52:15,740 --> 00:52:19,609
you can basically look at all of the

1214
00:52:17,420 --> 00:52:22,520
<font color="#CCCCCC">different</font><font color="#E5E5E5"> commons unboxing and analysis</font>

1215
00:52:19,609 --> 00:52:26,359
systems online get over there and get

1216
00:52:22,520 --> 00:52:28,550
all of their on system analysis data off

1217
00:52:26,359 --> 00:52:38,380
and then start digging through it

1218
00:52:28,550 --> 00:52:38,380
reverse engineering I hate you windows

1219
00:52:39,099 --> 00:52:45,890
what's in the<font color="#CCCCCC"> rest</font><font color="#E5E5E5"> of my presentation</font>

1220
00:52:41,089 --> 00:52:46,970
now so yeah it's always thinking you can

1221
00:52:45,890 --> 00:52:47,980
start to<font color="#E5E5E5"> get around in that kind of</font>

1222
00:52:46,970 --> 00:52:51,980
thing and<font color="#E5E5E5"> you can start identifying</font>

1223
00:52:47,980 --> 00:52:54,710
<font color="#CCCCCC">what's what's broken what's not broken</font>

1224
00:52:51,980 --> 00:52:56,359
where it looks great<font color="#E5E5E5"> doesn't look you</font>

1225
00:52:54,710 --> 00:52:59,150
can<font color="#CCCCCC"> start identifying how it gets that</font>

1226
00:52:56,359 --> 00:53:01,069
report data off the<font color="#CCCCCC"> hose off the</font><font color="#E5E5E5"> guest</font>

1227
00:52:59,150 --> 00:53:03,140
system<font color="#E5E5E5"> onto the hosts of them reported</font>

1228
00:53:01,070 --> 00:53:05,089
<font color="#CCCCCC">by DT that's pretty important because if</font>

1229
00:53:03,140 --> 00:53:07,490
you can<font color="#E5E5E5"> start subverting that you can</font>

1230
00:53:05,089 --> 00:53:11,390
lie in<font color="#E5E5E5"> the report which means that if</font>

1231
00:53:07,490 --> 00:53:13,430
<font color="#E5E5E5">you infect the virtual machine that was</font>

1232
00:53:11,390 --> 00:53:15,799
meant to be analyzing you and then get

1233
00:53:13,430 --> 00:53:17,118
the results to say something completely

1234
00:53:15,800 --> 00:53:18,830
different you can<font color="#E5E5E5"> pretend that you</font>

1235
00:53:17,119 --> 00:53:21,380
weren't aware in the first place right

1236
00:53:18,830 --> 00:53:23,450
is pretty much the automat goal of why

1237
00:53:21,380 --> 00:53:26,780
it needs to do what was it what my way

1238
00:53:23,450 --> 00:53:36,049
would want to do ah well as my today

1239
00:53:26,780 --> 00:53:40,940
coming windows so yeah you can still

1240
00:53:36,050 --> 00:53:45,410
that state it's<font color="#E5E5E5"> fine um you can tell</font>

1241
00:53:40,940 --> 00:53:47,230
didn't practice this actually it's not

1242
00:53:45,410 --> 00:53:51,080
asking for a password on boodle ya know

1243
00:53:47,230 --> 00:53:52,790
so I'm<font color="#E5E5E5"> pretty almost don't think don't</font>

1244
00:53:51,080 --> 00:53:58,040
<font color="#CCCCCC">think I've missed anything off the end</font>

1245
00:53:52,790 --> 00:54:00,619
of<font color="#E5E5E5"> this</font><font color="#CCCCCC"> okay but yeah so yeah but the</font>

1246
00:53:58,040 --> 00:54:02,630
general idea is that the more

1247
00:54:00,619 --> 00:54:04,400
information you can still offer those

1248
00:54:02,630 --> 00:54:07,339
systems the more<font color="#E5E5E5"> likely it is that your</font>

1249
00:54:04,400 --> 00:54:08,810
your piece of dodgy software is<font color="#CCCCCC"> not</font>

1250
00:54:07,339 --> 00:54:10,250
going to be identified<font color="#CCCCCC"> as mallet and</font>

1251
00:54:08,810 --> 00:54:12,000
that's essentially the gold or rather

1252
00:54:10,250 --> 00:54:20,340
the goal of the bad guys and we want

1253
00:54:12,000 --> 00:54:21,630
how they do that<font color="#CCCCCC"> I think</font><font color="#E5E5E5"> I might just</font>

1254
00:54:20,340 --> 00:54:22,860
leave it there<font color="#CCCCCC"> and say any questions</font>

1255
00:54:21,630 --> 00:54:25,590
<font color="#E5E5E5">because</font><font color="#CCCCCC"> I don't think</font><font color="#E5E5E5"> i think</font><font color="#CCCCCC"> i had like</font>

1256
00:54:22,860 --> 00:54:28,340
two more slides so my apologies for

1257
00:54:25,590 --> 00:54:30,900
windows being terrible and rebooting I

1258
00:54:28,340 --> 00:54:32,250
will freely admit that<font color="#E5E5E5"> I'm sure I'm</font>

1259
00:54:30,900 --> 00:54:38,240
going to get ribbed about that at work

1260
00:54:32,250 --> 00:54:38,240
should a parent any questions

