1
00:00:00,640 --> 00:00:02,320
hi everyone welcome to my talk from the

2
00:00:02,320 --> 00:00:04,960
home con finding xss on apple.com and

3
00:00:04,960 --> 00:00:06,560
building a proof of concept to leak your

4
00:00:06,560 --> 00:00:09,280
personal information with me z shawnow

5
00:00:09,280 --> 00:00:11,120
now this finding was a collaboration

6
00:00:11,120 --> 00:00:13,840
with bubba hunter members as part of a

7
00:00:13,840 --> 00:00:15,839
perk for finding certain amount on

8
00:00:15,839 --> 00:00:19,199
barker um so just to mention some um ox

9
00:00:19,199 --> 00:00:23,359
blackbird eugene i brute force jtc sec g

10
00:00:23,359 --> 00:00:25,119
prime holy bug

11
00:00:25,119 --> 00:00:27,680
xml hacker flag co

12
00:00:27,680 --> 00:00:29,599
and more so

13
00:00:29,599 --> 00:00:32,079
we all got together and chose a bug

14
00:00:32,079 --> 00:00:34,640
bounty program to hack on and our target

15
00:00:34,640 --> 00:00:38,399
was apple.com now our goal was to

16
00:00:38,399 --> 00:00:39,920
literally just try and find a valid

17
00:00:39,920 --> 00:00:42,160
vulnerability we didn't set a certain

18
00:00:42,160 --> 00:00:43,680
bug type that we were would go look for

19
00:00:43,680 --> 00:00:45,200
the idea was

20
00:00:45,200 --> 00:00:46,559
let's just see what apple's got out

21
00:00:46,559 --> 00:00:49,200
there and go with the flow because we're

22
00:00:49,200 --> 00:00:52,320
learning our target as we hack it

23
00:00:52,320 --> 00:00:55,360
so the first thing was initial recon now

24
00:00:55,360 --> 00:00:57,520
actually a hat tip to sam curry for this

25
00:00:57,520 --> 00:00:58,480
because

26
00:00:58,480 --> 00:01:00,640
i read his hacking on apple post where

27
00:01:00,640 --> 00:01:02,320
they earn up to what was it half a

28
00:01:02,320 --> 00:01:04,640
million or something and he mentioned

29
00:01:04,640 --> 00:01:06,560
that he was actually just opening apps

30
00:01:06,560 --> 00:01:08,960
on his iphone such as find a friend and

31
00:01:08,960 --> 00:01:11,040
was just literally testing them now i've

32
00:01:11,040 --> 00:01:12,400
owned an iphone for a good couple of

33
00:01:12,400 --> 00:01:14,159
years and it's just something i've never

34
00:01:14,159 --> 00:01:16,640
done really so i instantly turned on

35
00:01:16,640 --> 00:01:18,479
burp set it all up and started

36
00:01:18,479 --> 00:01:20,159
monitoring the request and actually went

37
00:01:20,159 --> 00:01:23,920
and retested his vulnerability there um

38
00:01:23,920 --> 00:01:26,880
so after we we've got some initial recon

39
00:01:26,880 --> 00:01:28,479
we actually found some interesting

40
00:01:28,479 --> 00:01:31,040
endpoints so we started fuzzing for xss

41
00:01:31,040 --> 00:01:33,119
and trying to get xss

42
00:01:33,119 --> 00:01:35,680
um and from there it's a case of leaking

43
00:01:35,680 --> 00:01:38,320
your personal information now

44
00:01:38,320 --> 00:01:41,360
apple won't pay on just alert zero um so

45
00:01:41,360 --> 00:01:42,720
we wanted to find a way to basically

46
00:01:42,720 --> 00:01:45,360
leak your information

47
00:01:45,360 --> 00:01:47,600
now

48
00:01:48,640 --> 00:01:50,880
so initial recon

49
00:01:50,880 --> 00:01:52,880
so as i say sam curry mentioned that he

50
00:01:52,880 --> 00:01:54,960
was testing apps on his iphone and it's

51
00:01:54,960 --> 00:01:56,880
something i've never done before

52
00:01:56,880 --> 00:01:58,719
so i retested literally went and

53
00:01:58,719 --> 00:02:00,880
retested his idle vulnerability and

54
00:02:00,880 --> 00:02:02,960
started to get a feel for things

55
00:02:02,960 --> 00:02:05,759
now on every app that i opened i always

56
00:02:05,759 --> 00:02:09,360
saw a request to bag.xml and at first i

57
00:02:09,360 --> 00:02:10,878
ignored it because it's an xml file i

58
00:02:10,878 --> 00:02:12,000
didn't think there'd be too much in

59
00:02:12,000 --> 00:02:13,280
there and i just ignored it if i'm

60
00:02:13,280 --> 00:02:15,360
honest i was just messing around looking

61
00:02:15,360 --> 00:02:16,879
at things and then eventually i looked

62
00:02:16,879 --> 00:02:20,720
in it and all literally what i saw was

63
00:02:20,720 --> 00:02:21,680
all

64
00:02:21,680 --> 00:02:23,440
hundreds of endpoints i'm not sure how

65
00:02:23,440 --> 00:02:24,959
many in total but there was hundreds of

66
00:02:24,959 --> 00:02:27,120
endpoints um

67
00:02:27,120 --> 00:02:29,440
for how that apple interacted with on

68
00:02:29,440 --> 00:02:31,760
these apps so as you can see there

69
00:02:31,760 --> 00:02:35,200
uh there's an example where you've got

70
00:02:35,200 --> 00:02:37,280
for the search.itunes.apple.com api

71
00:02:37,280 --> 00:02:40,000
now this endpoint will react differently

72
00:02:40,000 --> 00:02:41,360
based on certain parameters that you

73
00:02:41,360 --> 00:02:43,280
provided and it will show more

74
00:02:43,280 --> 00:02:46,400
information so in the screenshot above

75
00:02:46,400 --> 00:02:47,920
it will only show i'm only showing you

76
00:02:47,920 --> 00:02:50,480
the url but it will also show you the

77
00:02:50,480 --> 00:02:52,480
headers and parameters that these will

78
00:02:52,480 --> 00:02:55,120
take now that's for you to go do some

79
00:02:55,120 --> 00:02:58,400
hunting on and find out

80
00:02:58,400 --> 00:03:00,800
so this for us was the initial recon and

81
00:03:00,800 --> 00:03:02,879
for those of you who know me as i mean

82
00:03:02,879 --> 00:03:05,760
i'm twitter.com

83
00:03:05,760 --> 00:03:08,400
i'm not really somebody to run lots of

84
00:03:08,400 --> 00:03:11,519
scanning tools and fuzzing i much more

85
00:03:11,519 --> 00:03:13,519
dive into their main web application

86
00:03:13,519 --> 00:03:15,360
test their apps and things like that and

87
00:03:15,360 --> 00:03:17,519
see how things work

88
00:03:17,519 --> 00:03:20,319
and when it comes to recon um so those

89
00:03:20,319 --> 00:03:21,920
who have followed me for a good couple

90
00:03:21,920 --> 00:03:23,840
of years you'll know that on tripadvisor

91
00:03:23,840 --> 00:03:25,480
i did kind of the same so

92
00:03:25,480 --> 00:03:28,159
tripadvisor.com forward robots.txt will

93
00:03:28,159 --> 00:03:30,480
contain all of the endpoints or majority

94
00:03:30,480 --> 00:03:32,879
of the endpoints that are on tripadvisor

95
00:03:32,879 --> 00:03:34,720
the same i've got the same thing in here

96
00:03:34,720 --> 00:03:36,959
with this bag file there's hundreds of

97
00:03:36,959 --> 00:03:38,959
endpoints new sub domains that i've

98
00:03:38,959 --> 00:03:40,959
never seen this this for me this is

99
00:03:40,959 --> 00:03:42,799
enough to go by there's enough to check

100
00:03:42,799 --> 00:03:45,200
out here let's there's no blindly

101
00:03:45,200 --> 00:03:46,480
scanning and checking things the

102
00:03:46,480 --> 00:03:49,840
information i need is right here

103
00:03:49,840 --> 00:03:51,840
so let's do the initial recon and

104
00:03:51,840 --> 00:03:54,799
started to fuzz for xss now we didn't

105
00:03:54,799 --> 00:03:57,519
set out to look for xss but upon fuzzing

106
00:03:57,519 --> 00:03:59,040
these endpoints that we found we

107
00:03:59,040 --> 00:04:00,799
discovered that okay we can control a

108
00:04:00,799 --> 00:04:02,480
lot of inputs some of them are replying

109
00:04:02,480 --> 00:04:06,319
with text html let's try for xss here

110
00:04:06,319 --> 00:04:09,280
so i used a simple php curl script to

111
00:04:09,280 --> 00:04:10,959
literally query each of them because

112
00:04:10,959 --> 00:04:13,120
they're on different hosts so if you're

113
00:04:13,120 --> 00:04:15,519
using burp intruder for example to query

114
00:04:15,519 --> 00:04:18,000
lots of different domains um if it's on

115
00:04:18,000 --> 00:04:19,600
the different host then it you can it

116
00:04:19,600 --> 00:04:21,358
can't do it not as far as i'm aware

117
00:04:21,358 --> 00:04:22,880
anyway

118
00:04:22,880 --> 00:04:23,759
so

119
00:04:23,759 --> 00:04:27,199
what i do is i host a php

120
00:04:27,199 --> 00:04:29,360
scripts locally and just run exams so

121
00:04:29,360 --> 00:04:31,520
you can access it on localhost and then

122
00:04:31,520 --> 00:04:34,720
i will run that through burp intruder

123
00:04:34,720 --> 00:04:38,080
and enumerate um different hosts so i do

124
00:04:38,080 --> 00:04:39,840
actually have a blog post on this on my

125
00:04:39,840 --> 00:04:42,400
medium so z shawnee.medium.com

126
00:04:42,400 --> 00:04:44,400
where you can check it out

127
00:04:44,400 --> 00:04:45,280
now

128
00:04:45,280 --> 00:04:47,680
one thing to mention with this and why i

129
00:04:47,680 --> 00:04:50,400
like using certain scripts like this is

130
00:04:50,400 --> 00:04:52,800
some apple domains and endpoints will

131
00:04:52,800 --> 00:04:55,280
only respond with certain user agents so

132
00:04:55,280 --> 00:04:57,280
i've given an example of a user agent

133
00:04:57,280 --> 00:04:58,880
there um

134
00:04:58,880 --> 00:05:00,720
if you i mean think about apple i mean

135
00:05:00,720 --> 00:05:02,080
this does apply to a lot of other

136
00:05:02,080 --> 00:05:04,240
different um web applications of that

137
00:05:04,240 --> 00:05:07,039
but our target was apple apple makes

138
00:05:07,039 --> 00:05:09,120
iphones and a lot of their endpoints and

139
00:05:09,120 --> 00:05:11,199
domains will only respond to

140
00:05:11,199 --> 00:05:13,360
mobile-based user agents if you try to

141
00:05:13,360 --> 00:05:15,919
access it with a desktop user agent just

142
00:05:15,919 --> 00:05:17,759
a blank screen nothing happens but if

143
00:05:17,759 --> 00:05:19,280
you give it the right user agent that it

144
00:05:19,280 --> 00:05:21,680
wants it will respond and you can start

145
00:05:21,680 --> 00:05:23,440
doing things now i found that on a lot

146
00:05:23,440 --> 00:05:25,360
of their api calls that you needed

147
00:05:25,360 --> 00:05:27,440
specific user agents for them to be able

148
00:05:27,440 --> 00:05:30,240
to say yeah okay i'll react to this

149
00:05:30,240 --> 00:05:32,160
so don't just blindly scan with your

150
00:05:32,160 --> 00:05:34,000
user agents know your target and know

151
00:05:34,000 --> 00:05:36,080
what you're looking for

152
00:05:36,080 --> 00:05:37,910
so with intruder going

153
00:05:37,910 --> 00:05:40,000
[Music]

154
00:05:40,000 --> 00:05:40,880
um

155
00:05:40,880 --> 00:05:42,720
one endpoint responded with an error

156
00:05:42,720 --> 00:05:45,919
expecting a post request um

157
00:05:45,919 --> 00:05:48,160
it literally said error expecting post

158
00:05:48,160 --> 00:05:50,320
requests that's interesting to me let's

159
00:05:50,320 --> 00:05:53,120
check it out

160
00:05:53,120 --> 00:05:55,360
so on further scanning we actually found

161
00:05:55,360 --> 00:05:57,120
four of these endpoints we're responding

162
00:05:57,120 --> 00:05:59,919
to a post request and it would literally

163
00:05:59,919 --> 00:06:01,280
we test it a little bit more and

164
00:06:01,280 --> 00:06:03,199
whatever post data we give it it would

165
00:06:03,199 --> 00:06:05,199
literally spit out in the response

166
00:06:05,199 --> 00:06:07,919
except it was always encoded url encoded

167
00:06:07,919 --> 00:06:10,639
it it wasn't given as just straight html

168
00:06:10,639 --> 00:06:12,880
tags we couldn't just get xss

169
00:06:12,880 --> 00:06:15,039
now for potentially this is a dead end

170
00:06:15,039 --> 00:06:16,639
okay it doesn't work maybe somebody's

171
00:06:16,639 --> 00:06:19,120
been here before us however

172
00:06:19,120 --> 00:06:20,319
now because again this was a

173
00:06:20,319 --> 00:06:22,240
collaboration event with members of

174
00:06:22,240 --> 00:06:23,759
buckbitehunter.com

175
00:06:23,759 --> 00:06:24,880
and we have a

176
00:06:24,880 --> 00:06:26,639
diverse group of members different

177
00:06:26,639 --> 00:06:28,479
talents different expertise and things

178
00:06:28,479 --> 00:06:31,520
like that eugenia mentioned

179
00:06:31,520 --> 00:06:35,120
set the form encoding type so enc type

180
00:06:35,120 --> 00:06:37,840
to text slash plain and see if that

181
00:06:37,840 --> 00:06:40,160
works so we tried it and yeah it

182
00:06:40,160 --> 00:06:43,759
reflected our payload as html

183
00:06:43,759 --> 00:06:46,080
valid html tag and we got xss now the

184
00:06:46,080 --> 00:06:48,880
reason for that is well

185
00:06:48,880 --> 00:06:50,479
you know honestly i'm not quite sure

186
00:06:50,479 --> 00:06:51,919
what was happening behind the scenes

187
00:06:51,919 --> 00:06:53,599
it's just the fact that i guess because

188
00:06:53,599 --> 00:06:55,199
we've set the encoding type to text

189
00:06:55,199 --> 00:06:57,360
plane so if we don't set that by default

190
00:06:57,360 --> 00:07:00,160
it will send it as like url encoded

191
00:07:00,160 --> 00:07:01,039
stuff

192
00:07:01,039 --> 00:07:02,960
but if you set it to text plain it sends

193
00:07:02,960 --> 00:07:05,120
the payload just as that literally just

194
00:07:05,120 --> 00:07:07,919
text it's just text being sent over um

195
00:07:07,919 --> 00:07:09,440
so then when it gets reflected because

196
00:07:09,440 --> 00:07:11,919
the content type was text html it

197
00:07:11,919 --> 00:07:14,639
reflects our html tags and we managed to

198
00:07:14,639 --> 00:07:17,919
get xss so as you can see here

199
00:07:17,919 --> 00:07:20,000
we have form action along with the

200
00:07:20,000 --> 00:07:23,680
domain a method post and then enc type

201
00:07:23,680 --> 00:07:25,599
text plane

202
00:07:25,599 --> 00:07:28,880
now this specific endpoint would take

203
00:07:28,880 --> 00:07:29,759
any

204
00:07:29,759 --> 00:07:31,120
any post data you give it so we

205
00:07:31,120 --> 00:07:33,199
literally just give it test and then the

206
00:07:33,199 --> 00:07:35,840
payload image source x

207
00:07:35,840 --> 00:07:37,360
on error alert

208
00:07:37,360 --> 00:07:40,720
and there we have our xss

209
00:07:40,720 --> 00:07:42,960
but work in xss

210
00:07:42,960 --> 00:07:46,960
now what what do we do now

211
00:07:46,960 --> 00:07:49,680
so we've got four working exercises that

212
00:07:49,680 --> 00:07:53,039
actually affect 25 plus apple domains

213
00:07:53,039 --> 00:07:55,280
now because again we was collaborating

214
00:07:55,280 --> 00:07:57,120
and we were sharing lots of information

215
00:07:57,120 --> 00:07:59,919
a few researchers who specialize in

216
00:07:59,919 --> 00:08:02,000
subdomain scanning running certain tools

217
00:08:02,000 --> 00:08:03,039
they've even got their own custom

218
00:08:03,039 --> 00:08:05,440
frameworks they went and mass scanned to

219
00:08:05,440 --> 00:08:07,440
see if this endpoint existed anywhere

220
00:08:07,440 --> 00:08:09,840
else and they actually found lots more

221
00:08:09,840 --> 00:08:12,000
like i say 25 plus endpoints where we

222
00:08:12,000 --> 00:08:14,639
now have xss and not only that but it's

223
00:08:14,639 --> 00:08:17,199
four separate end points across there so

224
00:08:17,199 --> 00:08:18,479
it's not just one endpoint these are

225
00:08:18,479 --> 00:08:20,000
four separate different endpoints they

226
00:08:20,000 --> 00:08:22,000
all work the same but they're different

227
00:08:22,000 --> 00:08:23,759
differently named and they they're

228
00:08:23,759 --> 00:08:26,080
different

229
00:08:26,080 --> 00:08:27,599
the problem is apple that's not the

230
00:08:27,599 --> 00:08:28,960
problem i guess apple want to see an

231
00:08:28,960 --> 00:08:32,000
impact but apple won't pan alert zero so

232
00:08:32,000 --> 00:08:34,320
our options were leak the session

233
00:08:34,320 --> 00:08:35,599
cookies

234
00:08:35,599 --> 00:08:37,440
now from our testing

235
00:08:37,440 --> 00:08:39,679
most of apple's actually seemed locked

236
00:08:39,679 --> 00:08:42,559
down um we didn't have access to many

237
00:08:42,559 --> 00:08:44,240
interesting things to be able to achieve

238
00:08:44,240 --> 00:08:47,279
account takeover and things like that

239
00:08:47,279 --> 00:08:48,640
now we thought about performance

240
00:08:48,640 --> 00:08:50,800
sensitive action on behalf of the user

241
00:08:50,800 --> 00:08:54,240
so could we change their email could we

242
00:08:54,240 --> 00:08:56,959
leak some messages emails or something

243
00:08:56,959 --> 00:08:59,279
like that because sam curry created a

244
00:08:59,279 --> 00:09:01,200
wormable

245
00:09:01,200 --> 00:09:03,680
proof of concept for his exercise

246
00:09:03,680 --> 00:09:06,080
or our third option which was leak

247
00:09:06,080 --> 00:09:08,560
person information now

248
00:09:08,560 --> 00:09:10,320
either then could have worked i guess

249
00:09:10,320 --> 00:09:13,279
but personally we chose the leak pii

250
00:09:13,279 --> 00:09:15,120
information

251
00:09:15,120 --> 00:09:17,120
because for me when i'm recommending

252
00:09:17,120 --> 00:09:19,120
people hack on bug money programs

253
00:09:19,120 --> 00:09:20,800
because again this was a collaboration

254
00:09:20,800 --> 00:09:23,200
event and i'm hacking with members of

255
00:09:23,200 --> 00:09:25,279
bug by hunter because i want to train i

256
00:09:25,279 --> 00:09:27,040
don't want to just train you how to find

257
00:09:27,040 --> 00:09:28,399
these vulnerabilities but i want to

258
00:09:28,399 --> 00:09:29,760
actually hack with you on bug money

259
00:09:29,760 --> 00:09:32,000
programs and help you find a bounty find

260
00:09:32,000 --> 00:09:34,080
a real bug out there

261
00:09:34,080 --> 00:09:36,560
so when it comes to actually training

262
00:09:36,560 --> 00:09:38,560
people i always set them say to them set

263
00:09:38,560 --> 00:09:41,360
a goal set a task that you want to try

264
00:09:41,360 --> 00:09:43,760
and achieve now we've got our xss and we

265
00:09:43,760 --> 00:09:45,279
know we can run some javascript on

266
00:09:45,279 --> 00:09:48,080
apple.com now the next task is finding

267
00:09:48,080 --> 00:09:50,160
somewhere where our personal information

268
00:09:50,160 --> 00:09:52,640
is stored now we've all seen it from

269
00:09:52,640 --> 00:09:54,160
testing if you've been testing for a

270
00:09:54,160 --> 00:09:55,600
good couple of years there'll be some

271
00:09:55,600 --> 00:09:56,640
sort of

272
00:09:56,640 --> 00:09:58,640
end point that is content type

273
00:09:58,640 --> 00:10:01,279
application json and it has your

274
00:10:01,279 --> 00:10:02,959
personal information on it

275
00:10:02,959 --> 00:10:05,279
name emails certain things like that a

276
00:10:05,279 --> 00:10:07,040
lot of websites have it usually if you

277
00:10:07,040 --> 00:10:08,959
open some sort of mobile app

278
00:10:08,959 --> 00:10:12,000
they'll make a query to api

279
00:10:12,000 --> 00:10:14,160
me or something like that

280
00:10:14,160 --> 00:10:15,760
now second of all

281
00:10:15,760 --> 00:10:17,839
we're looking for access control allow

282
00:10:17,839 --> 00:10:19,680
origin because what this says to the

283
00:10:19,680 --> 00:10:22,320
browser is whatever domain is in the

284
00:10:22,320 --> 00:10:25,760
response after that can have access to

285
00:10:25,760 --> 00:10:28,399
this information you can read this

286
00:10:28,399 --> 00:10:31,680
now obviously if they allowed any domain

287
00:10:31,680 --> 00:10:33,360
in there then it would be an issue in

288
00:10:33,360 --> 00:10:36,399
itself but with our xss we want our

289
00:10:36,399 --> 00:10:39,040
domains to be there um after the access

290
00:10:39,040 --> 00:10:41,440
control our origin so our xss can read

291
00:10:41,440 --> 00:10:43,440
the response of this so we've got two

292
00:10:43,440 --> 00:10:45,440
tasks here

293
00:10:45,440 --> 00:10:47,200
now

294
00:10:47,200 --> 00:10:50,720
it's literally it's back to recon

295
00:10:50,720 --> 00:10:51,600
so

296
00:10:51,600 --> 00:10:53,519
again as this was a collaboration event

297
00:10:53,519 --> 00:10:55,680
we have a lot of members with lots of

298
00:10:55,680 --> 00:10:57,760
different expertise so a lot of us were

299
00:10:57,760 --> 00:11:00,959
going to hunt on every single app that

300
00:11:00,959 --> 00:11:03,519
apple owned so find a friend facetime

301
00:11:03,519 --> 00:11:05,360
imessages things like that and we were

302
00:11:05,360 --> 00:11:07,600
checking for as many different places

303
00:11:07,600 --> 00:11:08,880
where we could find our personal

304
00:11:08,880 --> 00:11:11,360
information so we would sign up to the

305
00:11:11,360 --> 00:11:13,760
app store go into manage your account

306
00:11:13,760 --> 00:11:16,000
see your request was made was it a

307
00:11:16,000 --> 00:11:18,040
certain request to like jump in app

308
00:11:18,040 --> 00:11:21,120
store.apple.com for api for self

309
00:11:21,120 --> 00:11:23,279
potentially with off cookies that would

310
00:11:23,279 --> 00:11:25,279
show you your information

311
00:11:25,279 --> 00:11:26,959
we also had lots of different members

312
00:11:26,959 --> 00:11:28,959
continuing to fuzz and scan across sub

313
00:11:28,959 --> 00:11:30,640
domains looking for some common things

314
00:11:30,640 --> 00:11:31,920
looking for more sub domains that we

315
00:11:31,920 --> 00:11:33,120
could log in because that was the main

316
00:11:33,120 --> 00:11:35,440
thing we wanted to log into an account

317
00:11:35,440 --> 00:11:37,040
and access our personal information and

318
00:11:37,040 --> 00:11:40,079
view the request of that

319
00:11:40,079 --> 00:11:42,320
now throughout they'll we found this

320
00:11:42,320 --> 00:11:44,079
exercise probably within a day of

321
00:11:44,079 --> 00:11:46,079
starting this event and it took about

322
00:11:46,079 --> 00:11:48,399
three days to go through a lot of apple

323
00:11:48,399 --> 00:11:51,440
stuff and test and see what was what now

324
00:11:51,440 --> 00:11:54,959
a lot of apple endpoints will respond to

325
00:11:54,959 --> 00:11:56,399
the origin header

326
00:11:56,399 --> 00:11:57,360
so

327
00:11:57,360 --> 00:11:59,519
when you're testing for cause bugs which

328
00:11:59,519 --> 00:12:02,880
is uh cross origin resource sharing

329
00:12:02,880 --> 00:12:05,200
your if you see access control allow

330
00:12:05,200 --> 00:12:07,680
origin on the response

331
00:12:07,680 --> 00:12:08,560
then

332
00:12:08,560 --> 00:12:10,800
if you can control the origin header so

333
00:12:10,800 --> 00:12:12,480
if you could put evil dot com and it

334
00:12:12,480 --> 00:12:14,320
responds saying access control allow

335
00:12:14,320 --> 00:12:17,519
origin evil.com that says evil.com can

336
00:12:17,519 --> 00:12:20,880
read this response um

337
00:12:20,880 --> 00:12:23,200
now in our case a lot of them were

338
00:12:23,200 --> 00:12:25,519
locked down so imagine you're on

339
00:12:25,519 --> 00:12:27,600
appstore.apple.com

340
00:12:27,600 --> 00:12:29,120
all the api endpoints and things on

341
00:12:29,120 --> 00:12:30,839
there would only allow

342
00:12:30,839 --> 00:12:34,000
appstore.apple.com to access them um and

343
00:12:34,000 --> 00:12:36,000
the same with a lot of others

344
00:12:36,000 --> 00:12:38,880
but some were a lot more relaxed than

345
00:12:38,880 --> 00:12:40,800
others so

346
00:12:40,800 --> 00:12:43,279
imagine you're on music.apple.com and it

347
00:12:43,279 --> 00:12:45,360
would allow for music to apple.com as

348
00:12:45,360 --> 00:12:46,200
well as

349
00:12:46,200 --> 00:12:47,839
appstore.apple.com so it wasn't just

350
00:12:47,839 --> 00:12:50,560
locked down to one domain

351
00:12:50,560 --> 00:12:52,880
so for me i said this to members this is

352
00:12:52,880 --> 00:12:54,720
interesting some endpoints are working

353
00:12:54,720 --> 00:12:56,480
differently there's different code work

354
00:12:56,480 --> 00:12:57,760
in here things have been built

355
00:12:57,760 --> 00:12:59,519
differently potentially is going to be

356
00:12:59,519 --> 00:13:01,760
some old legacy code something really

357
00:13:01,760 --> 00:13:03,200
old that's been forgotten about that

358
00:13:03,200 --> 00:13:06,240
works bit differently um and that's

359
00:13:06,240 --> 00:13:08,079
something i mentioned in my methodology

360
00:13:08,079 --> 00:13:10,279
which is completely free by the way um

361
00:13:10,279 --> 00:13:12,959
bugbitehunter.com for sasha's eat shawno

362
00:13:12,959 --> 00:13:14,720
but it's to learn your target as you're

363
00:13:14,720 --> 00:13:17,360
hunting through so the fact that things

364
00:13:17,360 --> 00:13:18,800
are working differently here would say

365
00:13:18,800 --> 00:13:20,240
to me different teams different code

366
00:13:20,240 --> 00:13:22,639
bases um different age of the code

367
00:13:22,639 --> 00:13:24,000
things like that and you learn your

368
00:13:24,000 --> 00:13:25,440
target okay

369
00:13:25,440 --> 00:13:26,399
this worked differently and you're

370
00:13:26,399 --> 00:13:28,240
writing all your notes down so the fact

371
00:13:28,240 --> 00:13:29,839
that some endpoints were more relaxed

372
00:13:29,839 --> 00:13:32,480
than others it just gave me that hackery

373
00:13:32,480 --> 00:13:35,399
gut feeling that somewhere

374
00:13:35,399 --> 00:13:36,959
somewhere

375
00:13:36,959 --> 00:13:38,959
on apple there will be what i've called

376
00:13:38,959 --> 00:13:41,920
a golden endpoint that will allow me to

377
00:13:41,920 --> 00:13:44,480
not only read not only have the personal

378
00:13:44,480 --> 00:13:46,720
information of the user but allow me to

379
00:13:46,720 --> 00:13:50,000
read the contents of that from my xss um

380
00:13:50,000 --> 00:13:51,519
domain

381
00:13:51,519 --> 00:13:53,360
somewhere there will be um and this is

382
00:13:53,360 --> 00:13:55,600
again why when i'm doing my recon i'm

383
00:13:55,600 --> 00:13:58,320
doing my testing um i'm not blindly

384
00:13:58,320 --> 00:14:00,560
running tools i'm straight in their web

385
00:14:00,560 --> 00:14:02,320
application seeing what's used certain

386
00:14:02,320 --> 00:14:03,279
headers

387
00:14:03,279 --> 00:14:06,639
um parameters how things work and i'm

388
00:14:06,639 --> 00:14:09,279
learning my target as i go through um

389
00:14:09,279 --> 00:14:10,639
because i actually found quite a few

390
00:14:10,639 --> 00:14:12,079
other interesting things as i was

391
00:14:12,079 --> 00:14:14,720
signing up to each of these apple apps

392
00:14:14,720 --> 00:14:17,040
and websites um i wasn't

393
00:14:17,040 --> 00:14:18,560
diving into that part straight away

394
00:14:18,560 --> 00:14:20,160
because i was just focused on finding

395
00:14:20,160 --> 00:14:21,360
personal information and where i could

396
00:14:21,360 --> 00:14:23,360
leak it but it helps you learn the

397
00:14:23,360 --> 00:14:24,720
target

398
00:14:24,720 --> 00:14:25,839
so yeah definitely check that out at

399
00:14:25,839 --> 00:14:27,279
bugbrighthunter.com for us actually

400
00:14:27,279 --> 00:14:29,360
shawn it's completely free to download

401
00:14:29,360 --> 00:14:32,880
and um apply really

402
00:14:32,880 --> 00:14:34,480
so

403
00:14:34,480 --> 00:14:37,120
persistence actually pays off um it did

404
00:14:37,120 --> 00:14:38,639
take some time like i say about three or

405
00:14:38,639 --> 00:14:41,360
four days but eventually eventually we

406
00:14:41,360 --> 00:14:43,199
found an apple endpoint where it

407
00:14:43,199 --> 00:14:45,360
responded with not only your full pii

408
00:14:45,360 --> 00:14:47,680
information but it would also allow for

409
00:14:47,680 --> 00:14:49,839
any apple.com domain in the origin

410
00:14:49,839 --> 00:14:51,839
header so we could put

411
00:14:51,839 --> 00:14:53,760
any of all of our xss works and it would

412
00:14:53,760 --> 00:14:56,800
respond with access control allow origin

413
00:14:56,800 --> 00:14:58,959
with our apple domain there we have

414
00:14:58,959 --> 00:15:01,760
access to this

415
00:15:02,000 --> 00:15:04,000
and that's another tip don't give up too

416
00:15:04,000 --> 00:15:06,160
early so obviously i mean there's a lot

417
00:15:06,160 --> 00:15:08,480
of people hands-on looking at this but i

418
00:15:08,480 --> 00:15:10,480
get a lot of people of dms was saying

419
00:15:10,480 --> 00:15:11,839
they can't find anything they've been

420
00:15:11,839 --> 00:15:13,279
hacking for a while and i'm like how

421
00:15:13,279 --> 00:15:14,560
long have you been hacking for and there

422
00:15:14,560 --> 00:15:17,760
are only two days couple of days

423
00:15:17,760 --> 00:15:19,600
if you're new to hacking and you're

424
00:15:19,600 --> 00:15:21,519
getting into it

425
00:15:21,519 --> 00:15:23,360
one you need to be able to enjoy the

426
00:15:23,360 --> 00:15:25,120
program so i get a lot of people message

427
00:15:25,120 --> 00:15:26,800
me saying that they're like addicted to

428
00:15:26,800 --> 00:15:28,240
the bug bite hunter member section

429
00:15:28,240 --> 00:15:30,000
barker and they just want to hack on

430
00:15:30,000 --> 00:15:32,399
barker find more bugs on barker you need

431
00:15:32,399 --> 00:15:33,920
to get that same feeling when you're

432
00:15:33,920 --> 00:15:36,000
hacking on bug bunny programs get that

433
00:15:36,000 --> 00:15:37,839
same i want to actually continue hacking

434
00:15:37,839 --> 00:15:39,920
on here that's how i was with

435
00:15:39,920 --> 00:15:42,320
tripadvisor when i went from having no

436
00:15:42,320 --> 00:15:44,560
rank all the way to number two overall

437
00:15:44,560 --> 00:15:46,160
from just supervisor because i was

438
00:15:46,160 --> 00:15:48,320
excited to hack on tripadvisor i enjoyed

439
00:15:48,320 --> 00:15:50,639
their scope i enjoyed the program and

440
00:15:50,639 --> 00:15:51,360
i

441
00:15:51,360 --> 00:15:53,600
wanted to and the same with amazon

442
00:15:53,600 --> 00:15:55,440
whereas i've had other programs um

443
00:15:55,440 --> 00:15:58,079
admittedly such as yahoo where i felt

444
00:15:58,079 --> 00:16:00,880
like i've had to force myself to hack a

445
00:16:00,880 --> 00:16:02,800
little bit i just didn't enjoy it as

446
00:16:02,800 --> 00:16:05,360
much it's just personal choice i guess

447
00:16:05,360 --> 00:16:07,040
but set a goal

448
00:16:07,040 --> 00:16:10,160
and go for that target so your goal

449
00:16:10,160 --> 00:16:11,839
first of all should be test all the

450
00:16:11,839 --> 00:16:14,079
features and note down where you can

451
00:16:14,079 --> 00:16:16,480
control inputs where it's reflected and

452
00:16:16,480 --> 00:16:18,240
how things work and you eventually go

453
00:16:18,240 --> 00:16:20,320
through it and after a couple of months

454
00:16:20,320 --> 00:16:22,079
if you haven't found anything then yeah

455
00:16:22,079 --> 00:16:23,920
by all means dm me and i can help you

456
00:16:23,920 --> 00:16:25,600
out but hopefully after six months you

457
00:16:25,600 --> 00:16:27,360
should have found a bug at least one bug

458
00:16:27,360 --> 00:16:30,079
on this target

459
00:16:30,320 --> 00:16:33,519
so back to the xss um once we actually

460
00:16:33,519 --> 00:16:35,440
we've done we've got our xss and now we

461
00:16:35,440 --> 00:16:36,720
have somewhere to leak the information

462
00:16:36,720 --> 00:16:39,279
it's literally a simple case of building

463
00:16:39,279 --> 00:16:41,040
a proof of concept to send an ajax

464
00:16:41,040 --> 00:16:43,199
request to this endpoint and then read

465
00:16:43,199 --> 00:16:44,959
the response so there's some basic

466
00:16:44,959 --> 00:16:46,959
javascripts which actually sends a get

467
00:16:46,959 --> 00:16:49,199
request to the endpoint apple.com

468
00:16:49,199 --> 00:16:51,440
forward slash example not real

469
00:16:51,440 --> 00:16:54,079
now the with credentials true this says

470
00:16:54,079 --> 00:16:56,800
to the browser send this users session

471
00:16:56,800 --> 00:16:59,360
cookies with the request if this wasn't

472
00:16:59,360 --> 00:17:00,959
on here then it wouldn't send the users

473
00:17:00,959 --> 00:17:02,800
session details and they wouldn't be

474
00:17:02,800 --> 00:17:04,240
authenticated and you wouldn't get

475
00:17:04,240 --> 00:17:06,079
anything so you need to have that on

476
00:17:06,079 --> 00:17:09,199
there and on the response um you need to

477
00:17:09,199 --> 00:17:12,079
see access control allow credentials

478
00:17:12,079 --> 00:17:15,199
true because this will allow again the

479
00:17:15,199 --> 00:17:16,720
sessions to come through but typically

480
00:17:16,720 --> 00:17:18,640
you always see that on there based on

481
00:17:18,640 --> 00:17:20,400
how the application works

482
00:17:20,400 --> 00:17:22,000
but yeah

483
00:17:22,000 --> 00:17:23,839
so there we go

484
00:17:23,839 --> 00:17:26,079
user visit our website

485
00:17:26,079 --> 00:17:28,559
the form post will automatically be

486
00:17:28,559 --> 00:17:30,480
submitted and

487
00:17:30,480 --> 00:17:32,240
retrieve their information and there you

488
00:17:32,240 --> 00:17:34,799
can see the alert that we have their

489
00:17:34,799 --> 00:17:36,240
telephone number

490
00:17:36,240 --> 00:17:39,039
billing address full name um and what

491
00:17:39,039 --> 00:17:40,960
they paid with along with their email so

492
00:17:40,960 --> 00:17:42,559
in this case pay the paypal so it's not

493
00:17:42,559 --> 00:17:44,559
only got my apple email but my paypal

494
00:17:44,559 --> 00:17:47,280
email so i've got both information

495
00:17:47,280 --> 00:17:48,799
and there we have

496
00:17:48,799 --> 00:17:51,919
literally opening a few apps on apple's

497
00:17:51,919 --> 00:17:56,320
um on our iphone seeing a bag.xml file

498
00:17:56,320 --> 00:17:59,280
scanning the end points to

499
00:17:59,280 --> 00:18:00,720
see how they work

500
00:18:00,720 --> 00:18:04,000
finding one will take any post data

501
00:18:04,000 --> 00:18:06,480
getting xss and then finding somewhere

502
00:18:06,480 --> 00:18:09,440
to leak this information um

503
00:18:09,440 --> 00:18:11,120
because

504
00:18:11,120 --> 00:18:13,280
i will mention before the bounty so this

505
00:18:13,280 --> 00:18:15,760
bug was fixed now they not only fixed

506
00:18:15,760 --> 00:18:17,760
all of the excesses but they actually

507
00:18:17,760 --> 00:18:20,960
fixed the wonky cause bugs so all of

508
00:18:20,960 --> 00:18:23,200
these end points which we used for

509
00:18:23,200 --> 00:18:24,160
leaking

510
00:18:24,160 --> 00:18:25,840
personal information

511
00:18:25,840 --> 00:18:28,160
they fixed them so they no longer allow

512
00:18:28,160 --> 00:18:30,480
for any apple.com sub domain they only

513
00:18:30,480 --> 00:18:32,080
allow for the ones that they're meant to

514
00:18:32,080 --> 00:18:34,880
allow for which is the case for majority

515
00:18:34,880 --> 00:18:36,480
of apple so like i say there was a few

516
00:18:36,480 --> 00:18:38,240
there's a few of these hanging around

517
00:18:38,240 --> 00:18:39,919
but they fixed all of that now did they

518
00:18:39,919 --> 00:18:41,760
pay a

519
00:18:41,760 --> 00:18:44,400
at first sadly apple said that our

520
00:18:44,400 --> 00:18:46,799
finding wasn't novel enough um i've

521
00:18:46,799 --> 00:18:48,559
actually put there that our finding was

522
00:18:48,559 --> 00:18:50,880
not novel enough for a finding

523
00:18:50,880 --> 00:18:52,880
it's meant to say our finding was not

524
00:18:52,880 --> 00:18:54,799
novel enough for a bounty

525
00:18:54,799 --> 00:18:55,760
um

526
00:18:55,760 --> 00:18:58,640
but then once we asked them i kindly

527
00:18:58,640 --> 00:19:00,320
asked them said look can i please write

528
00:19:00,320 --> 00:19:03,120
up this because it wasn't just an xss

529
00:19:03,120 --> 00:19:05,919
finding it was a massive bit of teamwork

530
00:19:05,919 --> 00:19:07,760
between all of buckmint hunter members

531
00:19:07,760 --> 00:19:09,840
who attended and we all chipped in

532
00:19:09,840 --> 00:19:11,440
everything and worked together on this

533
00:19:11,440 --> 00:19:13,200
so can we please write this up and share

534
00:19:13,200 --> 00:19:16,480
this now us after we asked to disclose

535
00:19:16,480 --> 00:19:18,080
this they actually said okay this is

536
00:19:18,080 --> 00:19:19,600
nice finding didn't realize so much

537
00:19:19,600 --> 00:19:20,720
teamwork went into it we're going to

538
00:19:20,720 --> 00:19:22,720
change our mind and in the end they

539
00:19:22,720 --> 00:19:26,240
rewarded us a 2500 bounty which we

540
00:19:26,240 --> 00:19:28,400
actually opted to donate the full amount

541
00:19:28,400 --> 00:19:31,520
to charity um and apple kindly matched

542
00:19:31,520 --> 00:19:33,520
the amount so we actually donated five

543
00:19:33,520 --> 00:19:36,080
thousand dollars um to charity in total

544
00:19:36,080 --> 00:19:37,919
um thanks to apple's bug money program

545
00:19:37,919 --> 00:19:40,240
and their kindness

546
00:19:40,240 --> 00:19:41,200
so

547
00:19:41,200 --> 00:19:42,720
that's actually not the only time i've

548
00:19:42,720 --> 00:19:44,559
hacked with members so like i say this

549
00:19:44,559 --> 00:19:46,640
was one perk of being a member of bug

550
00:19:46,640 --> 00:19:48,640
bank hunter is when you hit a certain

551
00:19:48,640 --> 00:19:50,480
level and you've proven i mean you know

552
00:19:50,480 --> 00:19:52,080
what you're doing you're hacking um we

553
00:19:52,080 --> 00:19:53,840
can all hack we hack together on bug

554
00:19:53,840 --> 00:19:55,600
money programs because i want to help

555
00:19:55,600 --> 00:19:57,679
you become a bug by hunter

556
00:19:57,679 --> 00:20:00,160
so this was back in february last year

557
00:20:00,160 --> 00:20:01,520
and we've hacked a few other times on

558
00:20:01,520 --> 00:20:04,000
other bug money programs

559
00:20:04,000 --> 00:20:06,080
and below is some stats basically of

560
00:20:06,080 --> 00:20:07,919
some programs we've hacked on as well as

561
00:20:07,919 --> 00:20:09,760
the amounts that we've earned

562
00:20:09,760 --> 00:20:12,080
so we hacked on apple um we only got

563
00:20:12,080 --> 00:20:14,480
that one finding we weren't too keen on

564
00:20:14,480 --> 00:20:16,000
how long it took for them to kind of

565
00:20:16,000 --> 00:20:17,679
respond and pay out and things like that

566
00:20:17,679 --> 00:20:19,840
so we didn't continue hacking on them

567
00:20:19,840 --> 00:20:21,919
kindred group on haka one which is

568
00:20:21,919 --> 00:20:24,000
public we enjoyed this program a lot and

569
00:20:24,000 --> 00:20:26,320
we actually earned five figures um all

570
00:20:26,320 --> 00:20:28,320
together so it wasn't just me or just

571
00:20:28,320 --> 00:20:30,320
one person this is collaboration we

572
00:20:30,320 --> 00:20:32,080
split bounties help each other out share

573
00:20:32,080 --> 00:20:33,360
information

574
00:20:33,360 --> 00:20:34,880
and we are currently hacking on

575
00:20:34,880 --> 00:20:37,440
tripadvisor and amazon right now and one

576
00:20:37,440 --> 00:20:39,679
of our members is has actually risen to

577
00:20:39,679 --> 00:20:41,679
the top five i believe he's in top three

578
00:20:41,679 --> 00:20:44,480
now on amazon's public program so hats

579
00:20:44,480 --> 00:20:46,480
off to him and well done because you're

580
00:20:46,480 --> 00:20:48,480
he's taken what he's learned on barker

581
00:20:48,480 --> 00:20:50,880
and applied it on a bug money program

582
00:20:50,880 --> 00:20:52,320
and you can actually browse a list of

583
00:20:52,320 --> 00:20:53,919
all of our recognized bug by hunters as

584
00:20:53,919 --> 00:20:56,400
well who have all hit level um five on

585
00:20:56,400 --> 00:20:59,120
blogbitehunter.com forward view hunters

586
00:20:59,120 --> 00:21:01,039
and i just wanted to give again a shout

587
00:21:01,039 --> 00:21:02,799
out to the members that actually helped

588
00:21:02,799 --> 00:21:04,720
with the collaboration on this apple um

589
00:21:04,720 --> 00:21:07,440
bug because it was a great time and

590
00:21:07,440 --> 00:21:09,120
there's a great finding and great

591
00:21:09,120 --> 00:21:10,640
teamwork because like i said we managed

592
00:21:10,640 --> 00:21:12,400
to find some xss and turn it into

593
00:21:12,400 --> 00:21:14,640
something with impact and this is

594
00:21:14,640 --> 00:21:16,080
exactly somebody could have found this

595
00:21:16,080 --> 00:21:18,240
by themselves if you put the time in and

596
00:21:18,240 --> 00:21:20,240
it could have been a 2500 bounty

597
00:21:20,240 --> 00:21:22,080
straight in your pocket which is a nice

598
00:21:22,080 --> 00:21:25,039
amount for doing some hacking at home in

599
00:21:25,039 --> 00:21:27,280
the comfort of your own time and space

600
00:21:27,280 --> 00:21:29,200
and company really

601
00:21:29,200 --> 00:21:31,360
so yeah that's how that's our

602
00:21:31,360 --> 00:21:33,280
collaboration event and find an exercise

603
00:21:33,280 --> 00:21:36,799
on apple i hope you enjoyed our talk um

604
00:21:36,799 --> 00:21:38,400
and if you again want to check us out on

605
00:21:38,400 --> 00:21:40,480
bugbitehunter.com you can there's lots

606
00:21:40,480 --> 00:21:41,760
of free challenges and guides and

607
00:21:41,760 --> 00:21:43,120
information on there to help you of your

608
00:21:43,120 --> 00:21:45,600
hunts but if you have any questions or

609
00:21:45,600 --> 00:21:47,440
queries feel free to ask me and i'm

610
00:21:47,440 --> 00:21:49,520
happy to answer them but again thank you

611
00:21:49,520 --> 00:21:54,120
for your time take care bye

