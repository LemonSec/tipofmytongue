1
00:00:00,399 --> 00:00:02,399
hey this is sam curry and welcome to

2
00:00:02,399 --> 00:00:03,919
breaking into cloud wallets findings

3
00:00:03,919 --> 00:00:05,359
from three years spent hacking crypto

4
00:00:05,359 --> 00:00:07,520
powered web apps this talk is about an

5
00:00:07,520 --> 00:00:08,720
hour so

6
00:00:08,720 --> 00:00:10,800
the slide deck by itself is like kind of

7
00:00:10,800 --> 00:00:12,719
it's a little bear um because i think it

8
00:00:12,719 --> 00:00:14,160
requires like a lot of context from the

9
00:00:14,160 --> 00:00:15,040
talk

10
00:00:15,040 --> 00:00:16,320
so i'll probably release it with like

11
00:00:16,320 --> 00:00:17,840
some extra details during like a week or

12
00:00:17,840 --> 00:00:20,160
so but uh thank you for watching

13
00:00:20,160 --> 00:00:22,400
this talk is mostly for people

14
00:00:22,400 --> 00:00:24,160
i think with traditional bug money back

15
00:00:24,160 --> 00:00:25,519
or backgrounds or web application

16
00:00:25,519 --> 00:00:27,119
security backgrounds the talk isn't

17
00:00:27,119 --> 00:00:28,480
really going to cover much like smart

18
00:00:28,480 --> 00:00:30,480
contract hacking it's mostly like web

19
00:00:30,480 --> 00:00:32,320
app security right so to kind of

20
00:00:32,320 --> 00:00:34,160
introduce myself um

21
00:00:34,160 --> 00:00:36,000
name sam curry i didn't hold time bug

22
00:00:36,000 --> 00:00:37,520
money for around like five years and i

23
00:00:37,520 --> 00:00:38,879
kind of tapered down a little bit near

24
00:00:38,879 --> 00:00:40,960
the end of that um i worked as a

25
00:00:40,960 --> 00:00:42,399
security consultant like on and off for

26
00:00:42,399 --> 00:00:43,920
like a year or two for like kind of

27
00:00:43,920 --> 00:00:45,680
traditional pen testing

28
00:00:45,680 --> 00:00:47,520
um but about a year ago we started a

29
00:00:47,520 --> 00:00:49,200
security consultant called palisade and

30
00:00:49,200 --> 00:00:51,360
the goal with palisade was basically

31
00:00:51,360 --> 00:00:53,280
providing like appsec security for kind

32
00:00:53,280 --> 00:00:54,800
of like these these crypto companies

33
00:00:54,800 --> 00:00:56,399
that are new and maybe they have like a

34
00:00:56,399 --> 00:00:57,600
lot of crypto security but they didn't

35
00:00:57,600 --> 00:00:59,440
have a lot of like web security um we

36
00:00:59,440 --> 00:01:00,399
noticed that there were like tons and

37
00:01:00,399 --> 00:01:02,000
tons of companies that really weren't

38
00:01:02,000 --> 00:01:04,159
like investing in the web security but

39
00:01:04,159 --> 00:01:05,680
you know ran these big crypto programs

40
00:01:05,680 --> 00:01:07,360
that were hosted on a website

41
00:01:07,360 --> 00:01:08,479
um i'm super passionate about like

42
00:01:08,479 --> 00:01:10,159
appsec research i really really love

43
00:01:10,159 --> 00:01:11,760
like you know any sort of apps like

44
00:01:11,760 --> 00:01:13,119
hacking so

45
00:01:13,119 --> 00:01:15,680
kind of just my general background

46
00:01:15,680 --> 00:01:16,560
um

47
00:01:16,560 --> 00:01:18,720
but can i just break right into the talk

48
00:01:18,720 --> 00:01:19,600
um

49
00:01:19,600 --> 00:01:21,439
my introduction to cryptocurrency was

50
00:01:21,439 --> 00:01:22,400
probably

51
00:01:22,400 --> 00:01:26,560
around like 2014 2015 um

52
00:01:26,560 --> 00:01:28,080
and this was when i was like in like

53
00:01:28,080 --> 00:01:29,759
early high school and we were playing

54
00:01:29,759 --> 00:01:32,720
like runescape uh gambling like doing a

55
00:01:32,720 --> 00:01:34,400
bunch of like really dumb stuff on the

56
00:01:34,400 --> 00:01:36,159
internet and you needed cryptocurrency

57
00:01:36,159 --> 00:01:36,960
to

58
00:01:36,960 --> 00:01:38,560
to either collect money from selling

59
00:01:38,560 --> 00:01:41,040
your in-game items or to like buy stuff

60
00:01:41,040 --> 00:01:41,840
right

61
00:01:41,840 --> 00:01:43,360
so i was you know like doing normal

62
00:01:43,360 --> 00:01:45,920
stuff with bitcoin or whatever and

63
00:01:45,920 --> 00:01:49,119
playing lots of video games right so

64
00:01:49,119 --> 00:01:50,320
when i started doing this i kind of

65
00:01:50,320 --> 00:01:52,560
realized that you know the whole process

66
00:01:52,560 --> 00:01:55,119
had like a bit of pain points um if you

67
00:01:55,119 --> 00:01:56,880
read like you know the the philosophy of

68
00:01:56,880 --> 00:01:58,799
like cryptocurrency back in like 2014 or

69
00:01:58,799 --> 00:02:01,040
15 it's probably still the same today

70
00:02:01,040 --> 00:02:02,320
it was all about you know like this

71
00:02:02,320 --> 00:02:04,719
decentralization and like you know that

72
00:02:04,719 --> 00:02:06,399
bitcoin came out of the housing crisis

73
00:02:06,399 --> 00:02:08,160
and like basically the idea is like

74
00:02:08,160 --> 00:02:09,199
we're going to base we're going to

75
00:02:09,199 --> 00:02:10,399
remove ourselves from the financial

76
00:02:10,399 --> 00:02:12,239
system but this was never really the

77
00:02:12,239 --> 00:02:14,560
case right you know you have what's like

78
00:02:14,560 --> 00:02:16,239
advertised as the bitcoin transaction

79
00:02:16,239 --> 00:02:18,080
process where it's like you know nick

80
00:02:18,080 --> 00:02:19,520
goes about you know transacting with

81
00:02:19,520 --> 00:02:20,959
another user or you can transact

82
00:02:20,959 --> 00:02:23,120
cryptocurrency but but the issue still

83
00:02:23,120 --> 00:02:25,440
becomes like converting that money into

84
00:02:25,440 --> 00:02:27,440
usd or into whatever you know currency

85
00:02:27,440 --> 00:02:28,640
you use right

86
00:02:28,640 --> 00:02:30,560
so here's a photo on the right of me and

87
00:02:30,560 --> 00:02:33,120
like i think this is 2014

88
00:02:33,120 --> 00:02:35,040
and i'm having to go through exchange

89
00:02:35,040 --> 00:02:36,879
you know to buy bitcoin right and in

90
00:02:36,879 --> 00:02:38,000
order to do that you know you have to

91
00:02:38,000 --> 00:02:39,360
like authenticate the website you have

92
00:02:39,360 --> 00:02:41,200
to show them your id and you have to you

93
00:02:41,200 --> 00:02:43,519
know like pay usd for bitcoin where it

94
00:02:43,519 --> 00:02:45,120
gets deposited into your web app account

95
00:02:45,120 --> 00:02:47,519
right so the whole decentralized part

96
00:02:47,519 --> 00:02:49,599
kind of falls apart with kyc

97
00:02:49,599 --> 00:02:50,879
i'm sure there's people who are like

98
00:02:50,879 --> 00:02:52,800
very like oh you know i only use

99
00:02:52,800 --> 00:02:54,400
cryptocurrency but

100
00:02:54,400 --> 00:02:55,360
and i guess that's kind of like the

101
00:02:55,360 --> 00:02:56,959
introduction of stable coins maybe help

102
00:02:56,959 --> 00:02:58,720
with that but at the end of the day like

103
00:02:58,720 --> 00:02:59,840
if you want to buy stuff you're going to

104
00:02:59,840 --> 00:03:00,959
probably have to trade something and

105
00:03:00,959 --> 00:03:02,720
what you trade over is like

106
00:03:02,720 --> 00:03:05,519
probably going to be you know usd

107
00:03:05,519 --> 00:03:07,120
and the bottom of course we have the the

108
00:03:07,120 --> 00:03:09,360
massive bitfinex hack of like 4.5

109
00:03:09,360 --> 00:03:10,800
billion dollars

110
00:03:10,800 --> 00:03:12,480
um and basically this just goes to show

111
00:03:12,480 --> 00:03:13,440
that like

112
00:03:13,440 --> 00:03:15,040
even though fundamentally these

113
00:03:15,040 --> 00:03:18,159
algorithms and you know every these all

114
00:03:18,159 --> 00:03:19,599
of crypto like fundamentally

115
00:03:19,599 --> 00:03:21,120
mathematically is like very locked down

116
00:03:21,120 --> 00:03:22,959
and decentralized

117
00:03:22,959 --> 00:03:25,040
um there's still like ways to go about

118
00:03:25,040 --> 00:03:26,640
like hacking it right and this was kind

119
00:03:26,640 --> 00:03:27,599
of like

120
00:03:27,599 --> 00:03:29,360
the reasoning behind like kind of doing

121
00:03:29,360 --> 00:03:31,040
this research and moving into like kind

122
00:03:31,040 --> 00:03:33,920
of hacking crypto web apps

123
00:03:33,920 --> 00:03:35,840
so kind of crypto's open secret is like

124
00:03:35,840 --> 00:03:37,599
this massive lack of decentralization

125
00:03:37,599 --> 00:03:39,599
right um if you didn't read about this

126
00:03:39,599 --> 00:03:41,360
hack the badger dow hack it's really

127
00:03:41,360 --> 00:03:42,799
really interesting

128
00:03:42,799 --> 00:03:45,040
basically what happened is a company

129
00:03:45,040 --> 00:03:46,560
called badger dao

130
00:03:46,560 --> 00:03:48,080
they were going to

131
00:03:48,080 --> 00:03:49,360
you know they're going to open their

132
00:03:49,360 --> 00:03:50,959
website and the hackers knew that they

133
00:03:50,959 --> 00:03:52,640
were going to open their website so what

134
00:03:52,640 --> 00:03:54,319
they did is they pre-registered the

135
00:03:54,319 --> 00:03:56,159
cloudflare accounts for you know like

136
00:03:56,159 --> 00:03:57,840
normal emails that they might use you

137
00:03:57,840 --> 00:03:59,599
know for instance like support

138
00:03:59,599 --> 00:04:02,319
badgerdow.com and what cloudflare was

139
00:04:02,319 --> 00:04:04,720
doing was it wasn't verifying your email

140
00:04:04,720 --> 00:04:06,640
address when you made the account so

141
00:04:06,640 --> 00:04:08,400
what the hacker did is they registered

142
00:04:08,400 --> 00:04:10,560
the cloudflare they generated an api key

143
00:04:10,560 --> 00:04:11,920
and then they immediately took that api

144
00:04:11,920 --> 00:04:13,840
key and just held onto it in hopes that

145
00:04:13,840 --> 00:04:15,200
one day badgered out would register

146
00:04:15,200 --> 00:04:17,759
cloudflare which they did so once you

147
00:04:17,759 --> 00:04:19,519
know badger that one badgered out like

148
00:04:19,519 --> 00:04:21,040
registered to cloudflare they had the

149
00:04:21,040 --> 00:04:23,360
api key they basically used the api key

150
00:04:23,360 --> 00:04:25,360
to inject javascript into the web app

151
00:04:25,360 --> 00:04:27,280
that badgerdow used and they were able

152
00:04:27,280 --> 00:04:29,360
to make these like very very calculated

153
00:04:29,360 --> 00:04:31,600
decisions on you know we're going to

154
00:04:31,600 --> 00:04:33,520
inject javascript into this browser and

155
00:04:33,520 --> 00:04:34,560
we're going to

156
00:04:34,560 --> 00:04:36,800
use you know the web3 moto uh like

157
00:04:36,800 --> 00:04:38,639
metamask and we're going to prompt the

158
00:04:38,639 --> 00:04:40,639
user to like basically have access to

159
00:04:40,639 --> 00:04:42,560
all of our assets or just you know like

160
00:04:42,560 --> 00:04:43,840
intercept the money and take the money

161
00:04:43,840 --> 00:04:44,880
that they were going to deposit or

162
00:04:44,880 --> 00:04:46,000
withdraw

163
00:04:46,000 --> 00:04:48,720
so this kind of leads to like

164
00:04:48,720 --> 00:04:49,440
the

165
00:04:49,440 --> 00:04:51,840
the fundamental part of like my

166
00:04:51,840 --> 00:04:53,520
experience like hacking crypto stuff is

167
00:04:53,520 --> 00:04:54,240
like

168
00:04:54,240 --> 00:04:55,440
you're always going to have that web

169
00:04:55,440 --> 00:04:57,120
layer right so even though you have like

170
00:04:57,120 --> 00:04:58,720
metamask which is like

171
00:04:58,720 --> 00:05:00,560
connected to ethereum and like uses all

172
00:05:00,560 --> 00:05:02,880
the ethereum nodes and stuff like you

173
00:05:02,880 --> 00:05:04,479
need to be able to just to advertise

174
00:05:04,479 --> 00:05:06,320
that to users and like you know you're

175
00:05:06,320 --> 00:05:07,600
going to use a discord server you're

176
00:05:07,600 --> 00:05:08,720
going to have a telegram chat you're

177
00:05:08,720 --> 00:05:10,320
going to have a website and these are

178
00:05:10,320 --> 00:05:11,440
all like three you know points of

179
00:05:11,440 --> 00:05:12,800
failure that

180
00:05:12,800 --> 00:05:14,400
a hacker could go in and basically like

181
00:05:14,400 --> 00:05:16,400
compromise your site

182
00:05:16,400 --> 00:05:17,199
and

183
00:05:17,199 --> 00:05:19,280
this kind of leads into and i guess to

184
00:05:19,280 --> 00:05:20,639
introduce the format of this talk we're

185
00:05:20,639 --> 00:05:22,000
going to go over like individual issues

186
00:05:22,000 --> 00:05:23,759
i found over the last couple years

187
00:05:23,759 --> 00:05:25,120
but the first issue i ever found on that

188
00:05:25,120 --> 00:05:27,280
cryptocurrency exchange is just blind

189
00:05:27,280 --> 00:05:29,280
xss of course the trusted binding

190
00:05:29,280 --> 00:05:30,320
success

191
00:05:30,320 --> 00:05:31,120
um

192
00:05:31,120 --> 00:05:32,720
so what you could do on the website on

193
00:05:32,720 --> 00:05:34,880
paxful paxful is basically like you know

194
00:05:34,880 --> 00:05:36,320
i've got a amazon gift card and i want

195
00:05:36,320 --> 00:05:38,080
to buy like bitcoin so you trade with

196
00:05:38,080 --> 00:05:40,720
each other and paxol x is like kind of

197
00:05:40,720 --> 00:05:42,080
escrow right

198
00:05:42,080 --> 00:05:43,840
so what i was able to do is just you

199
00:05:43,840 --> 00:05:45,360
know what any hacker would is and that's

200
00:05:45,360 --> 00:05:47,199
just throw blind exercise payloads

201
00:05:47,199 --> 00:05:48,560
everywhere right

202
00:05:48,560 --> 00:05:51,360
and one day i realized that the buying

203
00:05:51,360 --> 00:05:53,199
payload had fired not only did it fire

204
00:05:53,199 --> 00:05:55,120
but it fired in two different contexts

205
00:05:55,120 --> 00:05:57,120
right so the left user you can kind of

206
00:05:57,120 --> 00:05:59,759
see there is uh

207
00:05:59,759 --> 00:06:01,840
less options than the right one so the

208
00:06:01,840 --> 00:06:03,440
left one if you can see it pretty well

209
00:06:03,440 --> 00:06:05,440
it doesn't have the paxo core one but

210
00:06:05,440 --> 00:06:06,880
the right one does and the reason for

211
00:06:06,880 --> 00:06:08,160
this is because

212
00:06:08,160 --> 00:06:09,520
internally on the pax whole

213
00:06:09,520 --> 00:06:11,440
administration panel they had two user

214
00:06:11,440 --> 00:06:12,560
groups right they moderators and

215
00:06:12,560 --> 00:06:14,319
administrators right so what we were

216
00:06:14,319 --> 00:06:15,360
able to do is basically just like

217
00:06:15,360 --> 00:06:18,160
compromise the administrator panel um

218
00:06:18,160 --> 00:06:20,800
or excuse me we were able to uh

219
00:06:20,800 --> 00:06:22,400
you know when building our poc what we

220
00:06:22,400 --> 00:06:24,319
did is we made a poc that accessed the

221
00:06:24,319 --> 00:06:26,160
data in the core wallet and what we

222
00:06:26,160 --> 00:06:27,440
realized is that

223
00:06:27,440 --> 00:06:29,759
even though the moderator users

224
00:06:29,759 --> 00:06:31,039
didn't have those buttons they could

225
00:06:31,039 --> 00:06:33,199
still access the data so it was kind of

226
00:06:33,199 --> 00:06:34,880
like an internal privilege escalation

227
00:06:34,880 --> 00:06:37,759
and apologize there's the title that so

228
00:06:37,759 --> 00:06:38,960
the camera is in the upright corner so

229
00:06:38,960 --> 00:06:41,199
it's probably gonna block something but

230
00:06:41,199 --> 00:06:44,639
that's the title there awesome

231
00:06:44,639 --> 00:06:46,560
yeah when i saw it fire and when i

232
00:06:46,560 --> 00:06:48,319
fetched the page what i realize is that

233
00:06:48,319 --> 00:06:50,960
there is a wallet controller right

234
00:06:50,960 --> 00:06:52,720
and internally this is a page for

235
00:06:52,720 --> 00:06:55,120
administrators to mess with stuff right

236
00:06:55,120 --> 00:06:57,199
and it's basically a form where you can

237
00:06:57,199 --> 00:06:59,280
test the wallet and there was a input

238
00:06:59,280 --> 00:07:01,120
field that was disabled that had

239
00:07:01,120 --> 00:07:03,280
zero zero one bitcoin to test if if the

240
00:07:03,280 --> 00:07:04,800
bitcoin network was up

241
00:07:04,800 --> 00:07:06,000
right so

242
00:07:06,000 --> 00:07:07,440
this was this is basically vulnerable to

243
00:07:07,440 --> 00:07:08,880
sea surf and you could change the amount

244
00:07:08,880 --> 00:07:10,400
so an attacker could have just you know

245
00:07:10,400 --> 00:07:13,120
taken the 300 bitcoin via c surf or they

246
00:07:13,120 --> 00:07:14,639
could have gone and you know done the

247
00:07:14,639 --> 00:07:16,240
bonding success and gotten the

248
00:07:16,240 --> 00:07:17,919
administrator cookies and access the

249
00:07:17,919 --> 00:07:19,199
core wallet

250
00:07:19,199 --> 00:07:21,520
um additionally like you know this is

251
00:07:21,520 --> 00:07:23,120
all the all the findings but they paid a

252
00:07:23,120 --> 00:07:24,319
bounty of twenty thousand dollars and

253
00:07:24,319 --> 00:07:26,240
this was in 2017 so i was a fantastic

254
00:07:26,240 --> 00:07:28,080
like bounty for this so super

255
00:07:28,080 --> 00:07:29,520
interesting

256
00:07:29,520 --> 00:07:32,160
um so you think you know 2017 to 2022

257
00:07:32,160 --> 00:07:34,000
has has anything changed

258
00:07:34,000 --> 00:07:35,520
you know we should have the saving grace

259
00:07:35,520 --> 00:07:36,720
of uh

260
00:07:36,720 --> 00:07:38,400
the internet and like all the security

261
00:07:38,400 --> 00:07:40,400
that should have came out but

262
00:07:40,400 --> 00:07:42,960
realistically um straight to the exact

263
00:07:42,960 --> 00:07:46,080
same thing blind sets number two on a

264
00:07:46,080 --> 00:07:48,000
website called wire is pretty much the

265
00:07:48,000 --> 00:07:50,160
exactly the same thing right what wire

266
00:07:50,160 --> 00:07:51,759
is is if you go to metamask and you want

267
00:07:51,759 --> 00:07:53,199
to buy it like cryptocurrency basically

268
00:07:53,199 --> 00:07:54,080
it's like

269
00:07:54,080 --> 00:07:55,840
you go through the metamask and it

270
00:07:55,840 --> 00:07:57,280
connects to wire which is basically just

271
00:07:57,280 --> 00:07:58,240
like a payment platform for

272
00:07:58,240 --> 00:07:59,520
cryptocurrency

273
00:07:59,520 --> 00:08:01,680
but i was able to register a business

274
00:08:01,680 --> 00:08:03,280
and i found out that there's you know

275
00:08:03,280 --> 00:08:05,680
blinding success into the user panel

276
00:08:05,680 --> 00:08:06,960
where basically you're able to review

277
00:08:06,960 --> 00:08:08,639
the compliance all the information about

278
00:08:08,639 --> 00:08:09,919
the user

279
00:08:09,919 --> 00:08:11,599
and i think there's a really good uh

280
00:08:11,599 --> 00:08:13,840
whitey cracker quote from song

281
00:08:13,840 --> 00:08:15,280
and it's basically just talking about

282
00:08:15,280 --> 00:08:16,400
you know i guess some things never

283
00:08:16,400 --> 00:08:17,759
change humiliating all these fools with

284
00:08:17,759 --> 00:08:19,120
the same games

285
00:08:19,120 --> 00:08:20,240
and it's basically just the idea that

286
00:08:20,240 --> 00:08:22,720
like you know four years ago and now

287
00:08:22,720 --> 00:08:25,039
we're doing the same thing like security

288
00:08:25,039 --> 00:08:27,039
is like the methods we use are all kind

289
00:08:27,039 --> 00:08:28,160
of

290
00:08:28,160 --> 00:08:29,599
they're they're reliable more than

291
00:08:29,599 --> 00:08:32,240
anything um maybe less so than now but

292
00:08:32,240 --> 00:08:34,479
still you know kicking at it right

293
00:08:34,479 --> 00:08:36,080
but wire ended up paying a bounty of ten

294
00:08:36,080 --> 00:08:38,159
thousand dollars which you know a little

295
00:08:38,159 --> 00:08:39,919
less than uh paxful but there wasn't

296
00:08:39,919 --> 00:08:42,080
direct access to funds so hey

297
00:08:42,080 --> 00:08:43,760
still a very like kind of fun bug but

298
00:08:43,760 --> 00:08:45,440
you know

299
00:08:45,440 --> 00:08:47,040
we'll switch to uh you know talking

300
00:08:47,040 --> 00:08:48,880
about more

301
00:08:48,880 --> 00:08:51,600
you know in 2022 who owns your crypto

302
00:08:51,600 --> 00:08:52,720
right so it's like a really interesting

303
00:08:52,720 --> 00:08:54,880
thing it's like uh if you go to the

304
00:08:54,880 --> 00:08:56,480
cryptocurrency exchange and deposit

305
00:08:56,480 --> 00:08:57,760
money in like how do you get the money

306
00:08:57,760 --> 00:09:00,000
out right and who who is actually

307
00:09:00,000 --> 00:09:01,360
providing the liquidity for your

308
00:09:01,360 --> 00:09:03,200
cryptocurrency so like an interesting

309
00:09:03,200 --> 00:09:04,640
thing you'd think is you know binance

310
00:09:04,640 --> 00:09:06,399
has their own like api internally that

311
00:09:06,399 --> 00:09:08,880
has all the crypto and uh they have like

312
00:09:08,880 --> 00:09:10,640
this really locked down like

313
00:09:10,640 --> 00:09:11,920
where they're doing these like raw

314
00:09:11,920 --> 00:09:13,839
bitcoin transactions like you deposit

315
00:09:13,839 --> 00:09:15,920
into you know binance and then

316
00:09:15,920 --> 00:09:17,680
you would think that binance would just

317
00:09:17,680 --> 00:09:19,760
like keep that like their internal vault

318
00:09:19,760 --> 00:09:22,160
and then they'd you know make changes to

319
00:09:22,160 --> 00:09:24,480
that but realistically what they do is

320
00:09:24,480 --> 00:09:25,839
binance goes through a company called

321
00:09:25,839 --> 00:09:27,040
prime trust

322
00:09:27,040 --> 00:09:28,880
and prime trust is basically an api

323
00:09:28,880 --> 00:09:29,920
that's built for a company called

324
00:09:29,920 --> 00:09:31,600
fireblocks right

325
00:09:31,600 --> 00:09:33,760
so basic binance says if you want to you

326
00:09:33,760 --> 00:09:35,760
know deposit or withdraw money binance

327
00:09:35,760 --> 00:09:37,360
calls an api for prime trust and prime

328
00:09:37,360 --> 00:09:39,279
trust calls an api for fire blocks but

329
00:09:39,279 --> 00:09:40,560
at the end of the day the bottom of the

330
00:09:40,560 --> 00:09:42,560
chain is fire blocks where they do an

331
00:09:42,560 --> 00:09:45,040
insane amount of liquidity um and you

332
00:09:45,040 --> 00:09:47,279
know company like fireblocks provides

333
00:09:47,279 --> 00:09:48,560
liquidity for tons of different

334
00:09:48,560 --> 00:09:50,720
cryptocurrency exchanges so

335
00:09:50,720 --> 00:09:52,080
you know you would maybe think like oh

336
00:09:52,080 --> 00:09:53,519
if i'm gonna hack a cryptocurrency site

337
00:09:53,519 --> 00:09:54,880
then i really need to have all this like

338
00:09:54,880 --> 00:09:57,440
crypto knowledge right but realistically

339
00:09:57,440 --> 00:09:59,600
like trying to hack a crypto site it's

340
00:09:59,600 --> 00:10:01,839
like can i compromise the firebox api

341
00:10:01,839 --> 00:10:03,760
key or the box that they're using to do

342
00:10:03,760 --> 00:10:05,680
the transactions and if so

343
00:10:05,680 --> 00:10:06,959
you're basically able to do you know

344
00:10:06,959 --> 00:10:08,800
crypto stuff right and it's just like an

345
00:10:08,800 --> 00:10:11,200
api call like they're leveraging like uh

346
00:10:11,200 --> 00:10:13,040
you know any other api that you leverage

347
00:10:13,040 --> 00:10:14,320
so it's like a really fascinating thing

348
00:10:14,320 --> 00:10:16,240
to think about in terms of you know do i

349
00:10:16,240 --> 00:10:17,839
need like this specialized skill set to

350
00:10:17,839 --> 00:10:19,360
hack cryptocurrency websites the answer

351
00:10:19,360 --> 00:10:20,640
is plain no

352
00:10:20,640 --> 00:10:22,079
you need you know normal appsec

353
00:10:22,079 --> 00:10:24,000
experience

354
00:10:24,000 --> 00:10:26,160
so the third issue is actually

355
00:10:26,160 --> 00:10:28,240
a kind of more technical actual

356
00:10:28,240 --> 00:10:29,920
vulnerability so it's there's a sql

357
00:10:29,920 --> 00:10:31,200
injection vulnerability on this website

358
00:10:31,200 --> 00:10:33,920
called vulcanforge right and vulcanforge

359
00:10:33,920 --> 00:10:36,560
employs the the wallet you know the

360
00:10:36,560 --> 00:10:38,240
third-party wallet right i don't think

361
00:10:38,240 --> 00:10:39,839
their liquidity provider is fire blocks

362
00:10:39,839 --> 00:10:41,519
i think it's a different company but we

363
00:10:41,519 --> 00:10:42,560
were looking at the website and we found

364
00:10:42,560 --> 00:10:44,399
a sql injection and

365
00:10:44,399 --> 00:10:45,839
with the sql injection we're actually

366
00:10:45,839 --> 00:10:46,959
able to

367
00:10:46,959 --> 00:10:48,480
have slides for it

368
00:10:48,480 --> 00:10:50,079
we were able to you know dump the tables

369
00:10:50,079 --> 00:10:51,360
and we saw like a user's table like

370
00:10:51,360 --> 00:10:53,360
private keys and all this stuff and you

371
00:10:53,360 --> 00:10:54,560
know we immediately reported it and

372
00:10:54,560 --> 00:10:56,000
immediately fixed it

373
00:10:56,000 --> 00:10:57,360
um

374
00:10:57,360 --> 00:10:59,120
but what was really really you know

375
00:10:59,120 --> 00:11:01,600
interesting is like i think three or

376
00:11:01,600 --> 00:11:03,040
four months later

377
00:11:03,040 --> 00:11:04,720
they were hacked or six months later

378
00:11:04,720 --> 00:11:06,320
they were hacked for the exact same sort

379
00:11:06,320 --> 00:11:07,120
of

380
00:11:07,120 --> 00:11:08,720
i think i don't know the technical part

381
00:11:08,720 --> 00:11:09,600
of the vulnerability but they were

382
00:11:09,600 --> 00:11:11,519
basically hacked where someone got

383
00:11:11,519 --> 00:11:12,640
access to the api keys for their

384
00:11:12,640 --> 00:11:13,839
liquidity provider and they're hacked

385
00:11:13,839 --> 00:11:15,920
for 140 million dollars

386
00:11:15,920 --> 00:11:18,399
you know do i know if you know this sql

387
00:11:18,399 --> 00:11:20,000
injection could have done the same thing

388
00:11:20,000 --> 00:11:22,240
i i think there's a chance that it had

389
00:11:22,240 --> 00:11:23,600
the same impact

390
00:11:23,600 --> 00:11:24,800
you know there's like a you know api

391
00:11:24,800 --> 00:11:26,880
keys table and users table but like

392
00:11:26,880 --> 00:11:28,399
it's really really scary to think about

393
00:11:28,399 --> 00:11:30,240
that like a vulnerability like this

394
00:11:30,240 --> 00:11:31,600
where it's just like very traditional

395
00:11:31,600 --> 00:11:33,680
sql injection with sql map leads to

396
00:11:33,680 --> 00:11:35,839
you know potentially someone liking or

397
00:11:35,839 --> 00:11:38,480
stealing 140 million dollars you know

398
00:11:38,480 --> 00:11:40,640
this was uh six months after our attack

399
00:11:40,640 --> 00:11:42,079
we had nothing to do with it we deemed

400
00:11:42,079 --> 00:11:43,760
the guy on telegram and report the issue

401
00:11:43,760 --> 00:11:44,880
and i think they paid like a small

402
00:11:44,880 --> 00:11:46,079
bounty it was like two or three thousand

403
00:11:46,079 --> 00:11:47,120
dollars

404
00:11:47,120 --> 00:11:48,399
um

405
00:11:48,399 --> 00:11:49,839
but

406
00:11:49,839 --> 00:11:51,360
it's really really scary to think about

407
00:11:51,360 --> 00:11:52,480
that like there's still these like

408
00:11:52,480 --> 00:11:54,079
stacks that are set up in this way where

409
00:11:54,079 --> 00:11:56,320
it's like okay we've connected our you

410
00:11:56,320 --> 00:11:58,480
know liquidity provider with api keys

411
00:11:58,480 --> 00:11:59,680
and

412
00:11:59,680 --> 00:12:01,680
yeah you sql injected or you hack it and

413
00:12:01,680 --> 00:12:02,959
it's like boom you've stolen all their

414
00:12:02,959 --> 00:12:04,160
records

415
00:12:04,160 --> 00:12:06,320
so

416
00:12:06,320 --> 00:12:07,600
kind of at this point though there's

417
00:12:07,600 --> 00:12:09,200
there's the introduction of the ethereum

418
00:12:09,200 --> 00:12:11,200
and defy like ecosystem right we have

419
00:12:11,200 --> 00:12:13,519
our savior mr vitalik who has introduced

420
00:12:13,519 --> 00:12:16,160
like this very big like decentralized

421
00:12:16,160 --> 00:12:17,839
world right you've got like unit swap

422
00:12:17,839 --> 00:12:19,440
you've got metamask you control your own

423
00:12:19,440 --> 00:12:21,600
keys it's beautiful right

424
00:12:21,600 --> 00:12:23,040
but the issue of this is like the stack

425
00:12:23,040 --> 00:12:24,480
is getting more and more complicated

426
00:12:24,480 --> 00:12:25,920
right like you've got

427
00:12:25,920 --> 00:12:26,959
you know if you want to access your

428
00:12:26,959 --> 00:12:28,399
metamask you click a button and the

429
00:12:28,399 --> 00:12:29,839
button calls out to are these all these

430
00:12:29,839 --> 00:12:32,480
rpcs which are websites and the rpcs

431
00:12:32,480 --> 00:12:33,600
tell you how much money you have and

432
00:12:33,600 --> 00:12:34,959
like what you can do

433
00:12:34,959 --> 00:12:36,480
and then when you when you're after the

434
00:12:36,480 --> 00:12:38,880
website like uniswap um the only way you

435
00:12:38,880 --> 00:12:40,480
really know that the address that you're

436
00:12:40,480 --> 00:12:43,279
talking to is the correct one is if one

437
00:12:43,279 --> 00:12:45,200
they haven't linked their api key

438
00:12:45,200 --> 00:12:47,360
and two they like you know they've

439
00:12:47,360 --> 00:12:48,880
signed cryptographically somewhere that

440
00:12:48,880 --> 00:12:50,240
like that website you're accessing it's

441
00:12:50,240 --> 00:12:52,000
like the correct website because

442
00:12:52,000 --> 00:12:53,839
realistically uniswap is just a normal

443
00:12:53,839 --> 00:12:55,920
website uses cloudflare toasted on

444
00:12:55,920 --> 00:12:58,399
something like next.js or reversel or

445
00:12:58,399 --> 00:13:00,079
something um

446
00:13:00,079 --> 00:13:01,519
or i guess they're technically the same

447
00:13:01,519 --> 00:13:02,800
but

448
00:13:02,800 --> 00:13:04,240
yeah sorry a bit of a cut there but

449
00:13:04,240 --> 00:13:05,200
anyway

450
00:13:05,200 --> 00:13:06,720
the the really interesting thing for

451
00:13:06,720 --> 00:13:07,760
this is like

452
00:13:07,760 --> 00:13:09,600
you really don't know what you're buying

453
00:13:09,600 --> 00:13:11,279
unless you're actually checking you know

454
00:13:11,279 --> 00:13:12,880
the actual addresses and it's hosted on

455
00:13:12,880 --> 00:13:14,560
ipfs and the keys aren't compromised

456
00:13:14,560 --> 00:13:16,079
right so this isn't necessarily

457
00:13:16,079 --> 00:13:18,720
cryptocurrency but this is basically an

458
00:13:18,720 --> 00:13:20,480
example here on the banksy website where

459
00:13:20,480 --> 00:13:21,760
someone was able to hack the banksy

460
00:13:21,760 --> 00:13:23,440
website and what they did is they just

461
00:13:23,440 --> 00:13:25,839
sold a fake nft on the website and since

462
00:13:25,839 --> 00:13:27,440
there's no cryptographic verification or

463
00:13:27,440 --> 00:13:29,360
anything like that people just assumed

464
00:13:29,360 --> 00:13:31,360
it was banksy who was selling nft

465
00:13:31,360 --> 00:13:32,959
so the bid on this actually got up to

466
00:13:32,959 --> 00:13:34,959
244 000 pounds

467
00:13:34,959 --> 00:13:36,160
and i think the scammer actually

468
00:13:36,160 --> 00:13:38,399
refunded the money but

469
00:13:38,399 --> 00:13:40,000
it's a really really fascinating case

470
00:13:40,000 --> 00:13:41,600
where it's like you have this integrity

471
00:13:41,600 --> 00:13:43,519
problem with crypto of like how do we

472
00:13:43,519 --> 00:13:44,959
know who's who and what are we gonna do

473
00:13:44,959 --> 00:13:46,720
about it right

474
00:13:46,720 --> 00:13:48,079
um and this kind of brings the next

475
00:13:48,079 --> 00:13:49,519
point of like where are these

476
00:13:49,519 --> 00:13:51,600
decentralized finance apps been actually

477
00:13:51,600 --> 00:13:52,959
being deployed and they're being

478
00:13:52,959 --> 00:13:54,720
deployed on places like for cell using

479
00:13:54,720 --> 00:13:57,440
nextgs or like netlify and sometimes

480
00:13:57,440 --> 00:13:59,360
they're being deployed on like ipfs

481
00:13:59,360 --> 00:14:01,680
um but even at the very end of it

482
00:14:01,680 --> 00:14:03,199
they're being deployed on top of tlds

483
00:14:03,199 --> 00:14:05,120
right and this is like a very like core

484
00:14:05,120 --> 00:14:06,800
integrity problem on the internet um

485
00:14:06,800 --> 00:14:08,560
you've got like bgp hijacking like dns

486
00:14:08,560 --> 00:14:10,320
hijacking and like

487
00:14:10,320 --> 00:14:11,920
you know you have all these like

488
00:14:11,920 --> 00:14:14,000
big services that are running these you

489
00:14:14,000 --> 00:14:16,560
know cryptography are these uh d5

490
00:14:16,560 --> 00:14:17,920
platforms where people just trust that

491
00:14:17,920 --> 00:14:19,519
they're sending their money right so if

492
00:14:19,519 --> 00:14:21,279
someone hacks for cell or netlify or an

493
00:14:21,279 --> 00:14:23,440
xbs or finds a vulnerability and like a

494
00:14:23,440 --> 00:14:24,880
tld or whatever where they can take over

495
00:14:24,880 --> 00:14:26,560
the website they can basically pretend

496
00:14:26,560 --> 00:14:28,240
to be the actual website and that's a

497
00:14:28,240 --> 00:14:30,959
really big problem um so this is

498
00:14:30,959 --> 00:14:31,839
actually

499
00:14:31,839 --> 00:14:33,120
a vulnerability

500
00:14:33,120 --> 00:14:34,639
make the camera a little smaller for

501
00:14:34,639 --> 00:14:35,360
this

502
00:14:35,360 --> 00:14:36,720
uh

503
00:14:36,720 --> 00:14:38,079
so this is vulnerability i found in

504
00:14:38,079 --> 00:14:40,720
vercell and vercell runs about i would

505
00:14:40,720 --> 00:14:43,279
say like 60 70

506
00:14:43,279 --> 00:14:45,120
of crypto web apps right

507
00:14:45,120 --> 00:14:46,079
so

508
00:14:46,079 --> 00:14:47,440
what vercell does is basically they

509
00:14:47,440 --> 00:14:49,680
provide some website where you

510
00:14:49,680 --> 00:14:50,959
authenticate you link your github and

511
00:14:50,959 --> 00:14:52,560
you can just like one click deploy apps

512
00:14:52,560 --> 00:14:53,360
right

513
00:14:53,360 --> 00:14:54,720
and while testing it we found that there

514
00:14:54,720 --> 00:14:56,800
is this i can take a vulnerability where

515
00:14:56,800 --> 00:14:58,399
in the github callback functionality

516
00:14:58,399 --> 00:15:00,240
which is used for the oauth login

517
00:15:00,240 --> 00:15:02,079
there's no validation for the state

518
00:15:02,079 --> 00:15:03,360
parameter so you can basically just like

519
00:15:03,360 --> 00:15:04,720
paste this string someone and if they

520
00:15:04,720 --> 00:15:06,639
open it authenticated the github gets

521
00:15:06,639 --> 00:15:07,839
bound to their account and you basically

522
00:15:07,839 --> 00:15:10,160
got like full account takeover sell and

523
00:15:10,160 --> 00:15:12,399
the impact of this is like pretty insane

524
00:15:12,399 --> 00:15:14,079
if it was actually targeted

525
00:15:14,079 --> 00:15:14,880
um

526
00:15:14,880 --> 00:15:16,639
like if you took over like one of the

527
00:15:16,639 --> 00:15:19,360
big like you know billion dollar volume

528
00:15:19,360 --> 00:15:21,519
whatever things you could basically just

529
00:15:21,519 --> 00:15:23,199
display whatever you want and steal tons

530
00:15:23,199 --> 00:15:24,880
of money and i'm kind of surprised that

531
00:15:24,880 --> 00:15:28,320
like um i can't that sounds like a as i

532
00:15:28,320 --> 00:15:29,600
said i was surprised versailles hasn't

533
00:15:29,600 --> 00:15:31,519
been hacked in the commission's way yet

534
00:15:31,519 --> 00:15:32,320
um

535
00:15:32,320 --> 00:15:33,519
because it seems like such a ripe

536
00:15:33,519 --> 00:15:34,959
resource for attackers i'm not saying to

537
00:15:34,959 --> 00:15:35,920
do that

538
00:15:35,920 --> 00:15:37,759
but

539
00:15:37,759 --> 00:15:40,000
it's just like

540
00:15:40,000 --> 00:15:41,440
people are becoming more and more aware

541
00:15:41,440 --> 00:15:43,360
of these sort of attacks that can happen

542
00:15:43,360 --> 00:15:45,360
right so i think more and more malicious

543
00:15:45,360 --> 00:15:46,720
people are getting kind of opportunistic

544
00:15:46,720 --> 00:15:48,160
because it's like okay

545
00:15:48,160 --> 00:15:49,759
if i can compromise the website you can

546
00:15:49,759 --> 00:15:51,120
display whatever i want and i can steal

547
00:15:51,120 --> 00:15:55,839
tons of money so why not right why not

548
00:15:56,000 --> 00:15:56,720
so

549
00:15:56,720 --> 00:15:58,720
to get into kind of like a longer slide

550
00:15:58,720 --> 00:15:59,839
and this is kind of one of the more

551
00:15:59,839 --> 00:16:01,680
technical slides so we'll kind of go

552
00:16:01,680 --> 00:16:02,880
over it briefly but you can kind of read

553
00:16:02,880 --> 00:16:04,720
about it a little bit um

554
00:16:04,720 --> 00:16:06,320
what are the crypto attack vectors for

555
00:16:06,320 --> 00:16:08,639
like web vulnerabilities so if the app

556
00:16:08,639 --> 00:16:10,399
is self-custody like users use their own

557
00:16:10,399 --> 00:16:11,920
private keys you know where is it hosted

558
00:16:11,920 --> 00:16:13,440
what libraries does it use and is there

559
00:16:13,440 --> 00:16:15,120
anything imported on chain that we can

560
00:16:15,120 --> 00:16:17,040
like display on the website right

561
00:16:17,040 --> 00:16:18,000
um

562
00:16:18,000 --> 00:16:19,360
so to kind of go about this the idea

563
00:16:19,360 --> 00:16:20,720
would be that we compromise like the

564
00:16:20,720 --> 00:16:22,160
integrity of the website right so our

565
00:16:22,160 --> 00:16:23,839
goal is just simply to

566
00:16:23,839 --> 00:16:25,519
become the website post content on the

567
00:16:25,519 --> 00:16:27,519
website or somehow take over

568
00:16:27,519 --> 00:16:28,800
a

569
00:16:28,800 --> 00:16:30,320
issue in the

570
00:16:30,320 --> 00:16:32,079
in the integrity part right now this

571
00:16:32,079 --> 00:16:33,279
could be

572
00:16:33,279 --> 00:16:34,480
you know instead of taking a website

573
00:16:34,480 --> 00:16:36,320
maybe we like take over a discord chat

574
00:16:36,320 --> 00:16:38,079
bot right or we take over a discord

575
00:16:38,079 --> 00:16:40,000
account and if we take over the discord

576
00:16:40,000 --> 00:16:41,839
account we can just do at everyone

577
00:16:41,839 --> 00:16:43,839
please buy my nft at this website and

578
00:16:43,839 --> 00:16:45,279
people do it because you know

579
00:16:45,279 --> 00:16:47,199
cryptoculture is like very like ape and

580
00:16:47,199 --> 00:16:49,440
like buy this stuff as soon as you can

581
00:16:49,440 --> 00:16:51,519
otherwise we're going to lose out right

582
00:16:51,519 --> 00:16:53,040
so if the app does have custody like

583
00:16:53,040 --> 00:16:54,560
users who trust the website to host

584
00:16:54,560 --> 00:16:56,079
their keys um

585
00:16:56,079 --> 00:16:57,519
one thing we can ask is like does the

586
00:16:57,519 --> 00:16:59,120
app use fire blocks like do they have a

587
00:16:59,120 --> 00:17:01,199
monetary provider and do they set that

588
00:17:01,199 --> 00:17:03,120
up in like a good way right so if you

589
00:17:03,120 --> 00:17:05,039
build like a cryptocurrency web app that

590
00:17:05,039 --> 00:17:06,240
leverages something like fire blocks

591
00:17:06,240 --> 00:17:07,760
there's correct ways and incorrect ways

592
00:17:07,760 --> 00:17:10,079
to build it right so one correct way is

593
00:17:10,079 --> 00:17:11,919
that even though you know you've got

594
00:17:11,919 --> 00:17:13,839
like your website like you've built like

595
00:17:13,839 --> 00:17:15,679
your cryptocurrency exchange

596
00:17:15,679 --> 00:17:17,119
and people like come in and create like

597
00:17:17,119 --> 00:17:19,280
a user account each user should still

598
00:17:19,280 --> 00:17:21,520
have their own individual wallet right

599
00:17:21,520 --> 00:17:22,959
but if you decide to make it in a way

600
00:17:22,959 --> 00:17:23,919
where it's just like okay we're going to

601
00:17:23,919 --> 00:17:25,679
have one wallet so if you deposit we're

602
00:17:25,679 --> 00:17:26,880
going to transfer it to a big account

603
00:17:26,880 --> 00:17:28,000
and the big account is when everybody

604
00:17:28,000 --> 00:17:30,000
shares right that introduces potential

605
00:17:30,000 --> 00:17:31,360
logic vulnerabilities like negative

606
00:17:31,360 --> 00:17:32,480
amounts of money

607
00:17:32,480 --> 00:17:34,799
you know trying to send or receive uh

608
00:17:34,799 --> 00:17:36,240
race conditions where you're able to

609
00:17:36,240 --> 00:17:37,679
increase your balance

610
00:17:37,679 --> 00:17:39,200
and if this happens then you can

611
00:17:39,200 --> 00:17:40,880
basically like kind of exploit like the

612
00:17:40,880 --> 00:17:42,720
gated garden of

613
00:17:42,720 --> 00:17:44,080
you're able to kind of send money around

614
00:17:44,080 --> 00:17:45,679
and generate money on a thin air and

615
00:17:45,679 --> 00:17:46,799
steal other people's money at the end of

616
00:17:46,799 --> 00:17:47,919
the day

617
00:17:47,919 --> 00:17:49,120
um in the last part we kind of talked

618
00:17:49,120 --> 00:17:51,039
about it before a lot of cryptocurrency

619
00:17:51,039 --> 00:17:53,760
exchanges aren't using crypto anymore um

620
00:17:53,760 --> 00:17:55,039
if you want to start hacking crypto web

621
00:17:55,039 --> 00:17:57,120
apps come join us like it's it's very

622
00:17:57,120 --> 00:17:59,520
much you know traditional web security

623
00:17:59,520 --> 00:18:01,440
um but yeah like firebox has handled

624
00:18:01,440 --> 00:18:03,600
more than 500 billion dollars in assets

625
00:18:03,600 --> 00:18:06,240
right it is uh very large if someone was

626
00:18:06,240 --> 00:18:07,200
able to

627
00:18:07,200 --> 00:18:08,720
find a core vulnerability in fire blocks

628
00:18:08,720 --> 00:18:11,440
it'd be very absurd um they at the end

629
00:18:11,440 --> 00:18:12,799
of the day they do use like tons of

630
00:18:12,799 --> 00:18:13,919
crypto stuff you know they have like

631
00:18:13,919 --> 00:18:15,919
multi-chain whatever whatever but

632
00:18:15,919 --> 00:18:17,840
they're also at the end of the day um

633
00:18:17,840 --> 00:18:20,240
like an api basically so finding web

634
00:18:20,240 --> 00:18:21,600
vulnerabilities and fire blocks really

635
00:18:21,600 --> 00:18:24,480
interesting so

636
00:18:24,480 --> 00:18:26,240
this brings into uh like issue number

637
00:18:26,240 --> 00:18:30,080
five right so uh with this issue it's

638
00:18:30,080 --> 00:18:32,400
basically a universal xss on a next

639
00:18:32,400 --> 00:18:35,440
image library via improper host pricing

640
00:18:35,440 --> 00:18:36,880
the way this basically worked is uh

641
00:18:36,880 --> 00:18:38,559
pretty simple like you know if you guys

642
00:18:38,559 --> 00:18:39,919
have seen like kind of traditional web

643
00:18:39,919 --> 00:18:43,039
vulnerabilities like you're able to uh

644
00:18:43,039 --> 00:18:44,559
trick the website into thinking you're

645
00:18:44,559 --> 00:18:46,000
loading a resource off a whitelisted

646
00:18:46,000 --> 00:18:48,400
host via doing you know attacker website

647
00:18:48,400 --> 00:18:50,880
and then percent 5c or a backslash at

648
00:18:50,880 --> 00:18:53,280
whitelisted host and the url parser kind

649
00:18:53,280 --> 00:18:54,960
of breaks it thinks it's it's talking to

650
00:18:54,960 --> 00:18:56,320
whitelisted host but realistically it's

651
00:18:56,320 --> 00:18:58,240
talking to attacker website and what

652
00:18:58,240 --> 00:18:59,520
you're able to do is just load in like

653
00:18:59,520 --> 00:19:01,919
an evil svg file um

654
00:19:01,919 --> 00:19:03,840
gave us a bounty of a swag box the

655
00:19:03,840 --> 00:19:05,360
hoodie is very comfortable so i'm very

656
00:19:05,360 --> 00:19:06,799
happy with that

657
00:19:06,799 --> 00:19:08,720
you know so uh

658
00:19:08,720 --> 00:19:10,160
whatever it's it's it's one of those

659
00:19:10,160 --> 00:19:11,200
things where

660
00:19:11,200 --> 00:19:12,559
reporting it's the provider you're not

661
00:19:12,559 --> 00:19:13,919
really going to get a bounty bounty but

662
00:19:13,919 --> 00:19:15,280
like you could maybe find a customer

663
00:19:15,280 --> 00:19:16,559
who's affected and kind of report it

664
00:19:16,559 --> 00:19:19,679
there um obviously do both but

665
00:19:19,679 --> 00:19:21,600
whatever you uh however what you want to

666
00:19:21,600 --> 00:19:22,799
play the game

667
00:19:22,799 --> 00:19:24,720
it's on your discretion

668
00:19:24,720 --> 00:19:26,160
but uh this is kind of interesting issue

669
00:19:26,160 --> 00:19:27,200
because

670
00:19:27,200 --> 00:19:29,760
this is a universal xss on nuxed image

671
00:19:29,760 --> 00:19:31,600
and next image is used like everywhere

672
00:19:31,600 --> 00:19:33,679
for crypto so like

673
00:19:33,679 --> 00:19:35,039
you're basically able to have xss and

674
00:19:35,039 --> 00:19:36,720
like any crypto or a ton of crypto

675
00:19:36,720 --> 00:19:37,840
websites and it's like why not just

676
00:19:37,840 --> 00:19:39,039
exploit the integrity there and make a

677
00:19:39,039 --> 00:19:40,799
ton of money or whatever so that's just

678
00:19:40,799 --> 00:19:42,559
kind of a

679
00:19:42,559 --> 00:19:44,320
interesting issue there

680
00:19:44,320 --> 00:19:46,240
so kind of a another similar issue is

681
00:19:46,240 --> 00:19:48,080
like a universal open redirect on

682
00:19:48,080 --> 00:19:50,080
next.js um

683
00:19:50,080 --> 00:19:51,840
and nextjs is the same thing it's

684
00:19:51,840 --> 00:19:52,960
deployed through versailles and it's

685
00:19:52,960 --> 00:19:54,960
used on like every crypto website and

686
00:19:54,960 --> 00:19:56,080
what you're able to do is you know in

687
00:19:56,080 --> 00:19:57,760
the next image library you're able to do

688
00:19:57,760 --> 00:19:59,120
you know forward slash backslash forward

689
00:19:59,120 --> 00:20:01,120
slash backslash and load no resource

690
00:20:01,120 --> 00:20:02,559
from attacker controlled domain or

691
00:20:02,559 --> 00:20:05,200
redirect user to attacker control domain

692
00:20:05,200 --> 00:20:08,000
um we actually reported this to

693
00:20:08,000 --> 00:20:09,919
versel and then we also reported this to

694
00:20:09,919 --> 00:20:11,600
a affected customer where it was account

695
00:20:11,600 --> 00:20:13,280
takeover and they were generous enough

696
00:20:13,280 --> 00:20:14,400
to give us like a four thousand dollar

697
00:20:14,400 --> 00:20:17,360
bounty sounds really nice

698
00:20:17,360 --> 00:20:19,039
kind of a similar thing is there is

699
00:20:19,039 --> 00:20:22,240
another universal xss on uh

700
00:20:22,240 --> 00:20:25,360
hubspot hubspot cms so hubspot cms is

701
00:20:25,360 --> 00:20:26,880
kind of a i think it's a managed

702
00:20:26,880 --> 00:20:29,120
solution somewhere like wordpress right

703
00:20:29,120 --> 00:20:30,640
where they're able to host like your

704
00:20:30,640 --> 00:20:32,480
blog for you or whatever and tons of

705
00:20:32,480 --> 00:20:34,320
crypto sites use this for their blog let

706
00:20:34,320 --> 00:20:35,919
me scroll this down

707
00:20:35,919 --> 00:20:37,840
my camera's always in the way

708
00:20:37,840 --> 00:20:40,240
so uh you know circle.com they're

709
00:20:40,240 --> 00:20:41,760
basically a provider for like i think

710
00:20:41,760 --> 00:20:44,080
uscc or some other stablecoin

711
00:20:44,080 --> 00:20:46,240
but you're able to get xss on

712
00:20:46,240 --> 00:20:48,640
circle.com via basically

713
00:20:48,640 --> 00:20:51,919
you can see uh the hsfs endpoint

714
00:20:51,919 --> 00:20:54,000
this endpoint here is reverse proxy to

715
00:20:54,000 --> 00:20:55,200
their cdn

716
00:20:55,200 --> 00:20:56,799
so basically what you're able to do is

717
00:20:56,799 --> 00:20:57,919
uh

718
00:20:57,919 --> 00:21:00,640
post content to the the manage like

719
00:21:00,640 --> 00:21:02,799
hubspot resources where you're able to

720
00:21:02,799 --> 00:21:05,520
post an html file with custom content

721
00:21:05,520 --> 00:21:07,600
and you're actually able to

722
00:21:07,600 --> 00:21:10,320
access that html file on any customer

723
00:21:10,320 --> 00:21:12,240
website because what you can do is find

724
00:21:12,240 --> 00:21:15,200
the resource like uri for the

725
00:21:15,200 --> 00:21:16,720
actual asset like loaded in on any

726
00:21:16,720 --> 00:21:17,679
customer

727
00:21:17,679 --> 00:21:19,200
so when you did this you know universal

728
00:21:19,200 --> 00:21:21,600
xss and

729
00:21:21,600 --> 00:21:22,640
there's another interesting thing with

730
00:21:22,640 --> 00:21:25,360
hubspot is they have a another endpoint

731
00:21:25,360 --> 00:21:27,200
underscore hdms diagnostics and what

732
00:21:27,200 --> 00:21:29,280
this endpoint does is reflect your whole

733
00:21:29,280 --> 00:21:30,559
cookies right

734
00:21:30,559 --> 00:21:32,559
so even if you've got hp only cookies if

735
00:21:32,559 --> 00:21:33,600
they're being sent to the web server

736
00:21:33,600 --> 00:21:35,520
they're going to get reflected via this

737
00:21:35,520 --> 00:21:36,960
so you basically had a way in which you

738
00:21:36,960 --> 00:21:39,280
had one xss and two you know you could

739
00:21:39,280 --> 00:21:40,799
steal everybody's cookies

740
00:21:40,799 --> 00:21:42,840
they're hp only

741
00:21:42,840 --> 00:21:45,280
cookies kind of issue number eight it's

742
00:21:45,280 --> 00:21:49,039
like a very similar issue right um

743
00:21:49,039 --> 00:21:51,520
for instapage you could basically uh i

744
00:21:51,520 --> 00:21:53,120
guess not similar sorry it's a subject

745
00:21:53,120 --> 00:21:54,559
takeover basically so

746
00:21:54,559 --> 00:21:56,159
when you add your website to instapage

747
00:21:56,159 --> 00:21:57,679
you could just append like null bytes to

748
00:21:57,679 --> 00:21:58,880
the uh

749
00:21:58,880 --> 00:22:00,640
domain that you're adding you know uh

750
00:22:00,640 --> 00:22:03,280
backslash u000 and what that did was

751
00:22:03,280 --> 00:22:04,480
basically give you write permission for

752
00:22:04,480 --> 00:22:06,000
the website so if you found the website

753
00:22:06,000 --> 00:22:07,440
that was live and being host on

754
00:22:07,440 --> 00:22:08,480
instapage

755
00:22:08,480 --> 00:22:10,640
you did that you're able to post content

756
00:22:10,640 --> 00:22:12,799
to any website so for our poc we took

757
00:22:12,799 --> 00:22:14,960
over about.instapage.com or published

758
00:22:14,960 --> 00:22:16,320
content to it

759
00:22:16,320 --> 00:22:19,200
and again instapage like another really

760
00:22:19,200 --> 00:22:20,000
big

761
00:22:20,000 --> 00:22:21,520
you know crypto

762
00:22:21,520 --> 00:22:24,320
crypto host right so

763
00:22:24,320 --> 00:22:25,280
you could have done a lot of different

764
00:22:25,280 --> 00:22:26,480
stuff with that

765
00:22:26,480 --> 00:22:27,840
here's another kind of interesting thing

766
00:22:27,840 --> 00:22:29,919
similar sort of issue right

767
00:22:29,919 --> 00:22:31,679
um this is like improper host by listing

768
00:22:31,679 --> 00:22:32,960
on gitbook and basically what you're

769
00:22:32,960 --> 00:22:34,640
able to do is a

770
00:22:34,640 --> 00:22:37,039
similar endpoint right uh curly curly

771
00:22:37,039 --> 00:22:39,440
thing slash file slash you know this

772
00:22:39,440 --> 00:22:41,600
endpoint was able to basically reverse

773
00:22:41,600 --> 00:22:44,480
proxy assets from appspot.com and they

774
00:22:44,480 --> 00:22:46,159
basically had to check that it began

775
00:22:46,159 --> 00:22:48,240
with git book dash whatever

776
00:22:48,240 --> 00:22:50,640
and then it ended you know spot.com so

777
00:22:50,640 --> 00:22:52,159
we could do is just register you know

778
00:22:52,159 --> 00:22:54,799
git book dash dash heck that episode.com

779
00:22:54,799 --> 00:22:56,240
and post a file

780
00:22:56,240 --> 00:22:57,520
and you're able to create like an html

781
00:22:57,520 --> 00:23:00,000
file you can basically access right and

782
00:23:00,000 --> 00:23:01,360
get book is used like everywhere in

783
00:23:01,360 --> 00:23:03,520
crypto as well um you know that all the

784
00:23:03,520 --> 00:23:05,520
api documentation people have

785
00:23:05,520 --> 00:23:07,280
so uh for all these you know the attack

786
00:23:07,280 --> 00:23:09,120
scenario is basically

787
00:23:09,120 --> 00:23:10,080
you know

788
00:23:10,080 --> 00:23:12,799
there's no integrity on what's actually

789
00:23:12,799 --> 00:23:13,919
being

790
00:23:13,919 --> 00:23:16,240
like the website itself is the only like

791
00:23:16,240 --> 00:23:17,679
the only thing people can trust right so

792
00:23:17,679 --> 00:23:19,440
if you send someone a url that's like

793
00:23:19,440 --> 00:23:21,120
you know cryptokitties that open cd that

794
00:23:21,120 --> 00:23:23,200
io people are like okay you know it's

795
00:23:23,200 --> 00:23:24,960
probably cryptokitties so then you have

796
00:23:24,960 --> 00:23:26,240
you know your fake page which is like

797
00:23:26,240 --> 00:23:27,039
hey

798
00:23:27,039 --> 00:23:29,600
send me a million dollars and uh

799
00:23:29,600 --> 00:23:31,679
people uh maybe maybe send me a million

800
00:23:31,679 --> 00:23:33,919
dollars

801
00:23:33,919 --> 00:23:37,120
so here's the uh another one uh

802
00:23:37,120 --> 00:23:38,320
sorry for there's a ton of similar

803
00:23:38,320 --> 00:23:40,080
issues right in a row but uh

804
00:23:40,080 --> 00:23:42,080
universal xss on landing eye via cross

805
00:23:42,080 --> 00:23:43,840
tenant load right so basically for this

806
00:23:43,840 --> 00:23:44,640
one

807
00:23:44,640 --> 00:23:45,840
when you're

808
00:23:45,840 --> 00:23:47,360
creating a page or landing page on

809
00:23:47,360 --> 00:23:49,279
landing eye you can uh basically preview

810
00:23:49,279 --> 00:23:51,520
your page on your own website and what

811
00:23:51,520 --> 00:23:52,720
you do is it gives you this parameter

812
00:23:52,720 --> 00:23:54,159
called export hash right so if i make my

813
00:23:54,159 --> 00:23:55,200
website

814
00:23:55,200 --> 00:23:56,720
and i want to preview the website before

815
00:23:56,720 --> 00:23:58,400
it goes live it's like okay

816
00:23:58,400 --> 00:24:00,000
use this parameter

817
00:24:00,000 --> 00:24:01,840
and preview your website using it and

818
00:24:01,840 --> 00:24:02,880
then you can see what it looks like

819
00:24:02,880 --> 00:24:06,640
right but the issue with this is that it

820
00:24:06,640 --> 00:24:08,559
basically let you do it for any tenant

821
00:24:08,559 --> 00:24:10,960
so you know advertising.crypto.com

822
00:24:10,960 --> 00:24:13,120
we were able to just append you know

823
00:24:13,120 --> 00:24:14,559
export hash whatever and there wasn't

824
00:24:14,559 --> 00:24:16,080
actually a million dollar giveaway

825
00:24:16,080 --> 00:24:17,360
should probably change this slide so

826
00:24:17,360 --> 00:24:18,960
doesn't actually look like it's uh real

827
00:24:18,960 --> 00:24:20,559
or whatever but

828
00:24:20,559 --> 00:24:22,159
you could uh load in your own attacker

829
00:24:22,159 --> 00:24:24,240
controlled html file and then you know

830
00:24:24,240 --> 00:24:26,320
pretend to be crypto.com which is

831
00:24:26,320 --> 00:24:28,000
you know lots of advertising around that

832
00:24:28,000 --> 00:24:29,840
domain name be kind of a kind of a fun

833
00:24:29,840 --> 00:24:32,720
bug

834
00:24:32,720 --> 00:24:34,240
so to kind of take a step back from all

835
00:24:34,240 --> 00:24:36,000
those like individual issues

836
00:24:36,000 --> 00:24:38,159
you know in 2011 with the introduction

837
00:24:38,159 --> 00:24:39,760
of like bitcoin you have the electrum

838
00:24:39,760 --> 00:24:41,840
wallet right the electron wallet is like

839
00:24:41,840 --> 00:24:43,840
you download the chain

840
00:24:43,840 --> 00:24:45,120
and after you download the whole chain

841
00:24:45,120 --> 00:24:48,080
yourself you get to see you know

842
00:24:48,080 --> 00:24:49,600
all your transactions all the money you

843
00:24:49,600 --> 00:24:51,039
have and all your wallets and you manage

844
00:24:51,039 --> 00:24:52,320
it yourself right it's very

845
00:24:52,320 --> 00:24:54,000
straightforward you're sending receiving

846
00:24:54,000 --> 00:24:55,679
money goes through

847
00:24:55,679 --> 00:24:57,120
um

848
00:24:57,120 --> 00:24:58,559
the different nodes it's like actually

849
00:24:58,559 --> 00:25:00,960
decentralized and

850
00:25:00,960 --> 00:25:02,559
at the end it's very like isolated to

851
00:25:02,559 --> 00:25:04,159
binary like you know

852
00:25:04,159 --> 00:25:06,000
it's like one thing right but now if you

853
00:25:06,000 --> 00:25:06,799
want to access you know the

854
00:25:06,799 --> 00:25:08,880
decentralized internet you go through

855
00:25:08,880 --> 00:25:10,400
cloudflare which goes through dns and

856
00:25:10,400 --> 00:25:12,080
it's on for cell it's got npm modules

857
00:25:12,080 --> 00:25:13,919
nextgs and in order to verify your

858
00:25:13,919 --> 00:25:15,679
transactions use other scan and in order

859
00:25:15,679 --> 00:25:17,760
to look at your nfts you use openc and

860
00:25:17,760 --> 00:25:19,840
all this go through like infura rpc

861
00:25:19,840 --> 00:25:20,880
nodes

862
00:25:20,880 --> 00:25:21,919
and at the end of the day there's so

863
00:25:21,919 --> 00:25:23,440
many points of failure potential points

864
00:25:23,440 --> 00:25:26,159
of failure and it creates like this very

865
00:25:26,159 --> 00:25:28,640
vast like attack service for new crypto

866
00:25:28,640 --> 00:25:29,440
you know

867
00:25:29,440 --> 00:25:30,720
even at the end of the day it's like you

868
00:25:30,720 --> 00:25:31,679
know

869
00:25:31,679 --> 00:25:33,120
a user may have to like manually approve

870
00:25:33,120 --> 00:25:34,400
the transaction

871
00:25:34,400 --> 00:25:35,679
there's still like a ridiculous number

872
00:25:35,679 --> 00:25:36,799
of ways you can go about like

873
00:25:36,799 --> 00:25:39,600
compromising the stack so

874
00:25:39,600 --> 00:25:42,159
me my opinion is that 2011 was probably

875
00:25:42,159 --> 00:25:44,080
a little bit easier to secure and 2022

876
00:25:44,080 --> 00:25:46,640
is like harder right

877
00:25:46,640 --> 00:25:47,360
so

878
00:25:47,360 --> 00:25:49,279
issue number 11. kind of a bigger bounty

879
00:25:49,279 --> 00:25:50,960
for this one um

880
00:25:50,960 --> 00:25:52,400
there was a remote code execution

881
00:25:52,400 --> 00:25:54,480
vulnerability on a

882
00:25:54,480 --> 00:25:56,240
stablecoin website with a market cap

883
00:25:56,240 --> 00:25:58,400
like 150 million dollars and

884
00:25:58,400 --> 00:26:00,000
they hosted another service right they

885
00:26:00,000 --> 00:26:01,600
hosted a

886
00:26:01,600 --> 00:26:04,559
on their aws stack they had a uh another

887
00:26:04,559 --> 00:26:06,159
sort of website that you could use where

888
00:26:06,159 --> 00:26:08,080
you could upload files right so what

889
00:26:08,080 --> 00:26:09,360
you're able to do is just traverse the

890
00:26:09,360 --> 00:26:11,360
file upload and upload to like that's

891
00:26:11,360 --> 00:26:13,039
cron tab because it was running as root

892
00:26:13,039 --> 00:26:14,000
right

893
00:26:14,000 --> 00:26:15,360
and once you did that you're able to run

894
00:26:15,360 --> 00:26:16,799
commands right and just basically get a

895
00:26:16,799 --> 00:26:18,559
shell in the box and once you had a show

896
00:26:18,559 --> 00:26:20,559
on the box you could basically see

897
00:26:20,559 --> 00:26:22,880
that the abs secrets let you you know do

898
00:26:22,880 --> 00:26:25,120
aws stuff right so once you connected

899
00:26:25,120 --> 00:26:26,960
aws you realize that basically you could

900
00:26:26,960 --> 00:26:29,120
pivot between

901
00:26:29,120 --> 00:26:31,279
the compromise of the

902
00:26:31,279 --> 00:26:34,080
you know side side website right

903
00:26:34,080 --> 00:26:36,320
and you also pivot into the

904
00:26:36,320 --> 00:26:37,120
core

905
00:26:37,120 --> 00:26:38,720
stablecoin website

906
00:26:38,720 --> 00:26:40,480
and you know at the end of the day for

907
00:26:40,480 --> 00:26:42,320
stable coins where you convert united

908
00:26:42,320 --> 00:26:44,799
states dollars to stable coins there has

909
00:26:44,799 --> 00:26:46,400
to be some sort of provisioning system

910
00:26:46,400 --> 00:26:47,279
right

911
00:26:47,279 --> 00:26:48,559
and i think if i don't understand the

912
00:26:48,559 --> 00:26:50,480
impact incorrectly you will actually

913
00:26:50,480 --> 00:26:51,840
access the system and like you know

914
00:26:51,840 --> 00:26:53,760
provision yourself stuff or access the

915
00:26:53,760 --> 00:26:55,279
dashboard to do this

916
00:26:55,279 --> 00:26:57,520
so super scary bug but yeah they end up

917
00:26:57,520 --> 00:26:59,760
paying like a 50 000 bounty i'm super

918
00:26:59,760 --> 00:27:01,440
grateful for that but yeah crypto

919
00:27:01,440 --> 00:27:02,559
bounties are

920
00:27:02,559 --> 00:27:03,840
interesting it's definitely like a

921
00:27:03,840 --> 00:27:05,279
different landscape

922
00:27:05,279 --> 00:27:06,720
um some people would say this ability is

923
00:27:06,720 --> 00:27:08,880
like low which if you look at the impact

924
00:27:08,880 --> 00:27:10,159
it's like yeah

925
00:27:10,159 --> 00:27:11,520
but realistically we're getting into a

926
00:27:11,520 --> 00:27:12,960
better part right with fifty thousand

927
00:27:12,960 --> 00:27:14,480
dollar bounties with hundred thousand

928
00:27:14,480 --> 00:27:15,840
dollar bounties like there's good

929
00:27:15,840 --> 00:27:17,440
bounties now so

930
00:27:17,440 --> 00:27:19,120
lots of uh

931
00:27:19,120 --> 00:27:22,159
reasons for you to hack stuff right

932
00:27:22,159 --> 00:27:24,080
so uh the second kind of big

933
00:27:24,080 --> 00:27:26,000
vulnerability is like we were able to

934
00:27:26,000 --> 00:27:29,520
compromise the entire to tld

935
00:27:29,520 --> 00:27:31,039
and the reason we did this because we're

936
00:27:31,039 --> 00:27:32,480
originally looking at tether right we're

937
00:27:32,480 --> 00:27:34,159
like there's so much news about tether

938
00:27:34,159 --> 00:27:36,159
we're really curious you know securing

939
00:27:36,159 --> 00:27:38,559
tether or whatever um and we realized

940
00:27:38,559 --> 00:27:40,399
it's running on a dot t-o-tld and we're

941
00:27:40,399 --> 00:27:41,520
like okay that's kind of saying we've

942
00:27:41,520 --> 00:27:43,360
never seen this.otld

943
00:27:43,360 --> 00:27:45,120
um or at least we you know we haven't

944
00:27:45,120 --> 00:27:46,640
really thought about it so

945
00:27:46,640 --> 00:27:48,240
we got to see how they they do their you

946
00:27:48,240 --> 00:27:49,520
know provisioning for stuff and we

947
00:27:49,520 --> 00:27:50,880
realized that

948
00:27:50,880 --> 00:27:53,039
they're running on a very like uh it's

949
00:27:53,039 --> 00:27:54,799
kind of an older website they've existed

950
00:27:54,799 --> 00:27:56,880
you know the two guys who run the tltld

951
00:27:56,880 --> 00:27:57,919
they're both named eric they're really

952
00:27:57,919 --> 00:27:59,039
smart people and they've been running

953
00:27:59,039 --> 00:28:01,279
the website since you know

954
00:28:01,279 --> 00:28:03,039
it was pr i think the first actual

955
00:28:03,039 --> 00:28:06,159
registrar was teo domains right

956
00:28:06,159 --> 00:28:08,640
um stands for the island tonga and

957
00:28:08,640 --> 00:28:09,679
you're actually able to go on the

958
00:28:09,679 --> 00:28:11,760
website even like you know 2000 or

959
00:28:11,760 --> 00:28:13,120
however early it was and registered

960
00:28:13,120 --> 00:28:14,320
domain name

961
00:28:14,320 --> 00:28:16,240
but it was vulnerable to sql injection

962
00:28:16,240 --> 00:28:17,200
and

963
00:28:17,200 --> 00:28:18,960
what you're able to do is dump the

964
00:28:18,960 --> 00:28:20,640
password for managing the dns

965
00:28:20,640 --> 00:28:22,559
information for the host right so an

966
00:28:22,559 --> 00:28:23,840
attacker when i've been able to

967
00:28:23,840 --> 00:28:25,039
basically

968
00:28:25,039 --> 00:28:27,039
pop this using sql injection and access

969
00:28:27,039 --> 00:28:29,679
the dns management for tether.to and

970
00:28:29,679 --> 00:28:31,120
tether.to is kind of the same thing

971
00:28:31,120 --> 00:28:32,559
where it's like a provisioning system

972
00:28:32,559 --> 00:28:33,520
for

973
00:28:33,520 --> 00:28:35,760
buying and selling tether right

974
00:28:35,760 --> 00:28:37,760
so if you pop this you're able to

975
00:28:37,760 --> 00:28:40,799
take over any to domain but

976
00:28:40,799 --> 00:28:42,480
i think overall more broadly it like

977
00:28:42,480 --> 00:28:44,799
speaks to the idea of like you know

978
00:28:44,799 --> 00:28:46,480
we are so far away from having a

979
00:28:46,480 --> 00:28:48,559
decentralized like

980
00:28:48,559 --> 00:28:52,000
a decentralized crypto right like

981
00:28:52,000 --> 00:28:54,480
this is like

982
00:28:54,480 --> 00:28:56,159
the

983
00:28:56,159 --> 00:28:57,360
the aspect of this and like the

984
00:28:57,360 --> 00:28:59,039
implications of this is like hey you

985
00:28:59,039 --> 00:29:00,640
know even if you get as locked down as

986
00:29:00,640 --> 00:29:02,000
possible like there's still ways to go

987
00:29:02,000 --> 00:29:03,279
about like

988
00:29:03,279 --> 00:29:04,799
compromising the stack which is not

989
00:29:04,799 --> 00:29:07,440
decentralized or is like you know

990
00:29:07,440 --> 00:29:09,840
because technically dns is but you know

991
00:29:09,840 --> 00:29:12,640
it's iffy but anyway anyway um

992
00:29:12,640 --> 00:29:14,080
tld vulnerabilities are like the peak i

993
00:29:14,080 --> 00:29:15,600
feel like of like

994
00:29:15,600 --> 00:29:17,760
we've we've found a hole in the whole

995
00:29:17,760 --> 00:29:19,279
system right where it's like we've

996
00:29:19,279 --> 00:29:20,799
compromised the whole thing

997
00:29:20,799 --> 00:29:22,799
but yeah super interesting bug but

998
00:29:22,799 --> 00:29:25,279
allowed us to take over tether.to nato

999
00:29:25,279 --> 00:29:28,080
website so

1000
00:29:28,559 --> 00:29:29,600
sorry i'm kind of speed running these

1001
00:29:29,600 --> 00:29:31,760
anyway uh issue number 13 is like a full

1002
00:29:31,760 --> 00:29:32,720
account takeover vulnerability on

1003
00:29:32,720 --> 00:29:34,960
crypterium right so crypterium is like

1004
00:29:34,960 --> 00:29:37,600
an exchange and there's this is kind of

1005
00:29:37,600 --> 00:29:38,720
a different type of bug because it's

1006
00:29:38,720 --> 00:29:41,520
more like a custodial platform right

1007
00:29:41,520 --> 00:29:42,720
but what you're able to do is just you

1008
00:29:42,720 --> 00:29:44,080
know uh

1009
00:29:44,080 --> 00:29:46,000
orange side type trick of semicolon

1010
00:29:46,000 --> 00:29:48,559
slash and access the internal api for it

1011
00:29:48,559 --> 00:29:49,360
right

1012
00:29:49,360 --> 00:29:51,200
and we found this api dock that like

1013
00:29:51,200 --> 00:29:52,640
exposed the internal api routes and

1014
00:29:52,640 --> 00:29:53,919
we're like okay how do we access this

1015
00:29:53,919 --> 00:29:55,360
one and what you're able to do is

1016
00:29:55,360 --> 00:29:56,960
provide like a phone number

1017
00:29:56,960 --> 00:29:58,399
and you're basically off in any account

1018
00:29:58,399 --> 00:30:00,559
right and it generates a session cookie

1019
00:30:00,559 --> 00:30:01,919
year we'll take it over

1020
00:30:01,919 --> 00:30:02,880
um

1021
00:30:02,880 --> 00:30:04,720
next bug like issue number 14 is like

1022
00:30:04,720 --> 00:30:06,640
full account take of our own roll

1023
00:30:06,640 --> 00:30:08,159
um for this one they basically weren't

1024
00:30:08,159 --> 00:30:10,240
verifying who the user was and you're

1025
00:30:10,240 --> 00:30:11,600
able to basically

1026
00:30:11,600 --> 00:30:13,760
throw in like a six digit code um and

1027
00:30:13,760 --> 00:30:14,480
like

1028
00:30:14,480 --> 00:30:15,760
connect your

1029
00:30:15,760 --> 00:30:18,080
2fa to another user's account and

1030
00:30:18,080 --> 00:30:19,679
once you connected your 2fa to another

1031
00:30:19,679 --> 00:30:21,279
user's account it actually reflected an

1032
00:30:21,279 --> 00:30:23,039
authorization bearer right and that

1033
00:30:23,039 --> 00:30:24,720
authorization bear was actually the i

1034
00:30:24,720 --> 00:30:27,039
the authorization bearer for the user

1035
00:30:27,039 --> 00:30:28,399
where you're adding 2fa and once you

1036
00:30:28,399 --> 00:30:29,679
have this you're really able to like log

1037
00:30:29,679 --> 00:30:30,720
in their account and do whatever you

1038
00:30:30,720 --> 00:30:32,480
wanted and it's full kind of take around

1039
00:30:32,480 --> 00:30:33,919
another you know custodial platform

1040
00:30:33,919 --> 00:30:35,200
called role

1041
00:30:35,200 --> 00:30:36,399
right

1042
00:30:36,399 --> 00:30:38,240
um so kind of like

1043
00:30:38,240 --> 00:30:39,679
you know sorry for the length of this

1044
00:30:39,679 --> 00:30:42,480
with the 14 issues but uh

1045
00:30:42,480 --> 00:30:44,559
or the format i guess kind of harder to

1046
00:30:44,559 --> 00:30:45,919
go deeper in each one but kind of like

1047
00:30:45,919 --> 00:30:48,320
the final thoughts right um

1048
00:30:48,320 --> 00:30:50,240
cryptocurrency attacks are like actually

1049
00:30:50,240 --> 00:30:52,559
like super super increasing complexity

1050
00:30:52,559 --> 00:30:55,039
they're getting very targeted um

1051
00:30:55,039 --> 00:30:56,399
and there's so many things to like

1052
00:30:56,399 --> 00:30:58,000
really be aware of when like things move

1053
00:30:58,000 --> 00:30:59,840
forward this quickly right so you can

1054
00:30:59,840 --> 00:31:02,000
kind of see uh oops sorry

1055
00:31:02,000 --> 00:31:04,480
these two little photos right um

1056
00:31:04,480 --> 00:31:06,720
so here we have you know open c with

1057
00:31:06,720 --> 00:31:08,480
like selling an item and here we have

1058
00:31:08,480 --> 00:31:11,279
like geth right like

1059
00:31:11,279 --> 00:31:12,799
i think the reason the reason i include

1060
00:31:12,799 --> 00:31:13,760
these two is i thought it's kind of

1061
00:31:13,760 --> 00:31:15,519
funny it's just like you know you can

1062
00:31:15,519 --> 00:31:17,440
either um

1063
00:31:17,440 --> 00:31:19,279
run your own like jeff node and like

1064
00:31:19,279 --> 00:31:21,120
verify each and every transaction you

1065
00:31:21,120 --> 00:31:22,399
know in order to be cryptographic as

1066
00:31:22,399 --> 00:31:24,480
possible or you can just go to openc

1067
00:31:24,480 --> 00:31:26,399
trust the website do all this stuff you

1068
00:31:26,399 --> 00:31:27,919
know but it's kind of pick your poison

1069
00:31:27,919 --> 00:31:28,640
because

1070
00:31:28,640 --> 00:31:30,320
you know one of those is like very it's

1071
00:31:30,320 --> 00:31:32,559
isolated it's like you know

1072
00:31:32,559 --> 00:31:34,000
you're able to

1073
00:31:34,000 --> 00:31:35,440
interact with just the thing directly

1074
00:31:35,440 --> 00:31:37,039
and so you get to see the whole chain

1075
00:31:37,039 --> 00:31:38,399
video one leverages you know all the

1076
00:31:38,399 --> 00:31:40,799
websites all of stuff yadda yadda but

1077
00:31:40,799 --> 00:31:42,000
yeah

1078
00:31:42,000 --> 00:31:43,440
um anyways like

1079
00:31:43,440 --> 00:31:44,799
reliance on browser extensions and

1080
00:31:44,799 --> 00:31:46,399
traditional web is very complicated

1081
00:31:46,399 --> 00:31:48,080
right so

1082
00:31:48,080 --> 00:31:49,440
having to use metamask and having to

1083
00:31:49,440 --> 00:31:50,720
give these websites where you like

1084
00:31:50,720 --> 00:31:52,399
interact with my mask it's like very

1085
00:31:52,399 --> 00:31:54,640
very complicated um

1086
00:31:54,640 --> 00:31:56,240
there are some of these that make like

1087
00:31:56,240 --> 00:31:57,760
some some

1088
00:31:57,760 --> 00:31:59,200
chain

1089
00:31:59,200 --> 00:32:01,200
brother extensions like metamask or

1090
00:32:01,200 --> 00:32:03,039
alternative to metamask like

1091
00:32:03,039 --> 00:32:04,799
auto approve transactions for certain

1092
00:32:04,799 --> 00:32:06,480
domains right it's like let's say you

1093
00:32:06,480 --> 00:32:08,240
use gambling.com all the time you

1094
00:32:08,240 --> 00:32:10,399
basically say like tick like oh you know

1095
00:32:10,399 --> 00:32:12,720
i trust gambling.com auto approve every

1096
00:32:12,720 --> 00:32:14,880
transaction on gambling.com and that's

1097
00:32:14,880 --> 00:32:17,279
like okay so if attacker gets xss

1098
00:32:17,279 --> 00:32:19,360
they can steal all your money that's

1099
00:32:19,360 --> 00:32:21,760
that's cool i guess whatever

1100
00:32:21,760 --> 00:32:22,880
um

1101
00:32:22,880 --> 00:32:24,799
there's attackers have like a massive

1102
00:32:24,799 --> 00:32:26,880
incentive to innovate right there's like

1103
00:32:26,880 --> 00:32:29,840
a tons of money it's free money

1104
00:32:29,840 --> 00:32:31,519
um the community of crypto people is

1105
00:32:31,519 --> 00:32:34,640
like the perfect like victim right

1106
00:32:34,640 --> 00:32:36,480
there's a culture of just like throw

1107
00:32:36,480 --> 00:32:38,159
money whatever right

1108
00:32:38,159 --> 00:32:40,320
and people aren't technical people are

1109
00:32:40,320 --> 00:32:42,240
just after some money like the number of

1110
00:32:42,240 --> 00:32:44,159
users in crypto is getting so vast and

1111
00:32:44,159 --> 00:32:45,679
you can't possibly share enough

1112
00:32:45,679 --> 00:32:47,039
resources that

1113
00:32:47,039 --> 00:32:48,480
you know people could

1114
00:32:48,480 --> 00:32:50,000
you know like say like fishing trainings

1115
00:32:50,000 --> 00:32:51,120
right like

1116
00:32:51,120 --> 00:32:52,559
for how much money we invest in fishing

1117
00:32:52,559 --> 00:32:54,480
trainings like people still get fished

1118
00:32:54,480 --> 00:32:56,320
but yeah and then kind of the last two

1119
00:32:56,320 --> 00:32:57,679
like no one's downloading a copy of the

1120
00:32:57,679 --> 00:32:59,600
chain like nobody does that

1121
00:32:59,600 --> 00:33:01,279
realistically if you're like a dude

1122
00:33:01,279 --> 00:33:03,039
who's buying stuff like

1123
00:33:03,039 --> 00:33:04,720
you're just gonna use your metamask and

1124
00:33:04,720 --> 00:33:07,360
like check stuff yourself or you're not

1125
00:33:07,360 --> 00:33:09,200
gonna check stuff yourself right you're

1126
00:33:09,200 --> 00:33:10,240
just going to depend on like the

1127
00:33:10,240 --> 00:33:11,600
third-party stuff like other scan and

1128
00:33:11,600 --> 00:33:13,120
all this stuff

1129
00:33:13,120 --> 00:33:14,000
so

1130
00:33:14,000 --> 00:33:16,320
you know

1131
00:33:16,799 --> 00:33:18,399
compromising these big apis you could

1132
00:33:18,399 --> 00:33:19,760
basically pretend to be crypto even

1133
00:33:19,760 --> 00:33:20,720
though it's not cryptographically

1134
00:33:20,720 --> 00:33:22,720
verified right like if you pop other

1135
00:33:22,720 --> 00:33:25,440
scan you can basically uh

1136
00:33:25,440 --> 00:33:26,960
if you pop like other scan and pura and

1137
00:33:26,960 --> 00:33:27,840
all this stuff together you can

1138
00:33:27,840 --> 00:33:28,799
basically

1139
00:33:28,799 --> 00:33:31,039
be the new ethereum for 90 of the user

1140
00:33:31,039 --> 00:33:32,159
base right

1141
00:33:32,159 --> 00:33:34,320
the apis provide truth like that's all

1142
00:33:34,320 --> 00:33:36,080
there is to it is like people don't

1143
00:33:36,080 --> 00:33:38,399
verify stuff and apis are leveraged to

1144
00:33:38,399 --> 00:33:41,279
verify truth right so now crypto isn't

1145
00:33:41,279 --> 00:33:44,000
crypto crypto is you know web

1146
00:33:44,000 --> 00:33:45,440
it's kind of falling back into itself a

1147
00:33:45,440 --> 00:33:46,720
little bit

1148
00:33:46,720 --> 00:33:47,919
but uh

1149
00:33:47,919 --> 00:33:49,760
i think that is uh

1150
00:33:49,760 --> 00:33:51,760
pretty much all um i think i messed up

1151
00:33:51,760 --> 00:33:53,039
this a little bit brett wanted his name

1152
00:33:53,039 --> 00:33:54,640
to be bigger so i made his name bigger

1153
00:33:54,640 --> 00:33:55,760
for this

1154
00:33:55,760 --> 00:33:56,799
um

1155
00:33:56,799 --> 00:33:59,440
yeah thank you for for watching this uh

1156
00:33:59,440 --> 00:34:00,720
i think the time may be a little weird

1157
00:34:00,720 --> 00:34:02,480
maybe went over maybe under but i'm

1158
00:34:02,480 --> 00:34:03,760
happy to answer any questions we want to

1159
00:34:03,760 --> 00:34:05,919
reach out on twitter um but yeah i hope

1160
00:34:05,919 --> 00:34:07,360
everybody kind of walked away with an

1161
00:34:07,360 --> 00:34:10,079
understanding of just like

1162
00:34:10,079 --> 00:34:13,199
crypto vulnerabilities are

1163
00:34:13,199 --> 00:34:15,918
more a lot of times more web than crypto

1164
00:34:15,918 --> 00:34:17,679
and the ecosystem needs a lot more

1165
00:34:17,679 --> 00:34:19,918
people to help kind of like secure it

1166
00:34:19,918 --> 00:34:21,839
and there's a big incentive for people

1167
00:34:21,839 --> 00:34:24,879
to come help secure crypto right

1168
00:34:24,879 --> 00:34:26,000
um

1169
00:34:26,000 --> 00:34:27,280
again you know thank you for watching

1170
00:34:27,280 --> 00:34:29,119
thank you so much um

1171
00:34:29,119 --> 00:34:30,560
and sorry if this again like if it's

1172
00:34:30,560 --> 00:34:32,320
toxin rush or anything like that i'm

1173
00:34:32,320 --> 00:34:34,079
really doing internet talks or doing

1174
00:34:34,079 --> 00:34:36,079
pre-recorded talks is like it's pretty

1175
00:34:36,079 --> 00:34:38,239
rough you know it's uh

1176
00:34:38,239 --> 00:34:39,839
it's always hard to tell like what time

1177
00:34:39,839 --> 00:34:41,599
is or like read the room or whatever but

1178
00:34:41,599 --> 00:34:42,320
uh

1179
00:34:42,320 --> 00:34:46,879
again yeah thank you so much thanks guys

