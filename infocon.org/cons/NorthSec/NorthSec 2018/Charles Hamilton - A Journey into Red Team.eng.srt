1
00:00:00,089 --> 00:00:05,609
hey guys<font color="#E5E5E5"> how's</font><font color="#CCCCCC"> it going I was supposed</font>

2
00:00:03,629 --> 00:00:12,480
<font color="#E5E5E5">to do a joke about bit connect so should</font>

3
00:00:05,609 --> 00:00:18,840
I do it or<font color="#E5E5E5"> not what's up with so what</font>

4
00:00:12,480 --> 00:00:21,539
was a bit connect so send me your<font color="#E5E5E5"> money</font>

5
00:00:18,840 --> 00:00:24,210
for my<font color="#CCCCCC"> iceo and we'll raise like</font><font color="#E5E5E5"> a</font>

6
00:00:21,539 --> 00:00:26,430
couple<font color="#E5E5E5"> of million dollars</font><font color="#CCCCCC"> together</font><font color="#E5E5E5"> so</font>

7
00:00:24,210 --> 00:00:28,800
this<font color="#E5E5E5"> is pretty much a phishing attempt</font>

8
00:00:26,430 --> 00:00:30,150
to get your money which is some<font color="#E5E5E5"> of the</font>

9
00:00:28,800 --> 00:00:34,649
<font color="#CCCCCC">thing</font><font color="#E5E5E5"> that we're gonna discuss in this</font>

10
00:00:30,150 --> 00:00:37,500
<font color="#CCCCCC">talk so Who am</font><font color="#E5E5E5"> I I work at Mannion a</font>

11
00:00:34,649 --> 00:00:39,360
<font color="#CCCCCC">fireEye company</font><font color="#E5E5E5"> I'm doing</font><font color="#CCCCCC"> Red Team web</font>

12
00:00:37,500 --> 00:00:41,160
application testing<font color="#CCCCCC"> internal/external</font>

13
00:00:39,360 --> 00:00:42,960
and stuff<font color="#E5E5E5"> like that I really enjoy</font>

14
00:00:41,160 --> 00:00:45,000
<font color="#E5E5E5">writing assembly some people think I'm</font>

15
00:00:42,960 --> 00:00:47,160
crazy<font color="#CCCCCC"> because of</font><font color="#E5E5E5"> that but I guess I love</font>

16
00:00:45,000 --> 00:00:48,450
it<font color="#E5E5E5"> love to bypass stuff so this is</font>

17
00:00:47,160 --> 00:00:50,339
<font color="#E5E5E5">something that you have</font><font color="#CCCCCC"> to do when you</font>

18
00:00:48,450 --> 00:00:53,190
perform<font color="#E5E5E5"> red team because your client may</font>

19
00:00:50,340 --> 00:00:54,690
have<font color="#E5E5E5"> security product on the way so you</font>

20
00:00:53,190 --> 00:00:56,789
<font color="#CCCCCC">have to figure out a</font><font color="#E5E5E5"> way to go through</font>

21
00:00:54,690 --> 00:00:58,980
them<font color="#E5E5E5"> I've been with the North tech for</font>

22
00:00:56,789 --> 00:01:00,719
four years now<font color="#E5E5E5"> I'm a native French</font>

23
00:00:58,980 --> 00:01:02,370
<font color="#CCCCCC">québécois which</font><font color="#E5E5E5"> explained my terrible</font>

24
00:01:00,719 --> 00:01:06,439
accent<font color="#CCCCCC"> it's all actually my parents</font>

25
00:01:02,370 --> 00:01:06,439
<font color="#CCCCCC">fault not mine so blame them for that</font>

26
00:01:06,530 --> 00:01:10,950
<font color="#E5E5E5">what we're</font><font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> talk about today</font><font color="#CCCCCC"> the</font>

27
00:01:08,970 --> 00:01:12,630
<font color="#CCCCCC">goal of a red team because there's a lot</font>

28
00:01:10,950 --> 00:01:14,729
<font color="#E5E5E5">of misconception about red team again</font>

29
00:01:12,630 --> 00:01:16,470
<font color="#CCCCCC">this is my</font><font color="#E5E5E5"> personal opinion so I could</font>

30
00:01:14,729 --> 00:01:19,380
be wrong<font color="#CCCCCC"> you could be right it's a</font>

31
00:01:16,470 --> 00:01:20,970
<font color="#E5E5E5">question of point of view</font><font color="#CCCCCC"> identifying</font>

32
00:01:19,380 --> 00:01:23,130
<font color="#E5E5E5">your target so when you're targeting a</font>

33
00:01:20,970 --> 00:01:24,810
company what we should do and couple of

34
00:01:23,130 --> 00:01:26,548
tricks to actually find<font color="#CCCCCC"> interesting</font>

35
00:01:24,810 --> 00:01:28,920
value that can really help you doing a

36
00:01:26,549 --> 00:01:30,570
red team<font color="#CCCCCC"> phishing so a couple</font><font color="#E5E5E5"> of advice</font>

37
00:01:28,920 --> 00:01:32,460
<font color="#CCCCCC">that I personally use when I perform</font>

38
00:01:30,570 --> 00:01:34,470
phishing<font color="#E5E5E5"> which kind of</font><font color="#CCCCCC"> pedal you should</font>

39
00:01:32,460 --> 00:01:36,630
use in<font color="#E5E5E5"> certain specific situation and</font>

40
00:01:34,470 --> 00:01:38,250
<font color="#E5E5E5">hunting this is again not a complete</font>

41
00:01:36,630 --> 00:01:40,408
things about<font color="#CCCCCC"> writing because we don't</font>

42
00:01:38,250 --> 00:01:41,759
have like<font color="#E5E5E5"> 12 hours</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> talk</font><font color="#CCCCCC"> about it</font><font color="#E5E5E5"> but</font>

43
00:01:40,409 --> 00:01:43,470
I'll<font color="#E5E5E5"> give</font><font color="#CCCCCC"> you some of the tips</font><font color="#E5E5E5"> that I</font>

44
00:01:41,759 --> 00:01:45,409
personally use when I perform<font color="#CCCCCC"> red team</font>

45
00:01:43,470 --> 00:01:49,079
and couple<font color="#E5E5E5"> of tools and tips at the end</font>

46
00:01:45,409 --> 00:01:51,540
<font color="#E5E5E5">regarding red teaming so first of all</font>

47
00:01:49,079 --> 00:01:53,750
goal of red team<font color="#E5E5E5"> obviously</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> want to</font>

48
00:01:51,540 --> 00:01:55,920
assess your client responsiveness

49
00:01:53,750 --> 00:01:58,020
<font color="#E5E5E5">responsiveness against red actors</font>

50
00:01:55,920 --> 00:01:59,460
<font color="#E5E5E5">usually when you perform an internal</font>

51
00:01:58,020 --> 00:02:01,079
penetration testing you're gonna run

52
00:01:59,460 --> 00:02:03,270
<font color="#E5E5E5">like an automated scan they're gonna</font>

53
00:02:01,079 --> 00:02:05,130
give you a big picture<font color="#E5E5E5"> of</font><font color="#CCCCCC"> everything</font>

54
00:02:03,270 --> 00:02:06,689
they have in their network and<font color="#E5E5E5"> a bunch</font>

55
00:02:05,130 --> 00:02:09,239
of unpatched software and stuff like

56
00:02:06,689 --> 00:02:11,340
that<font color="#CCCCCC"> usually red teamers not gonna run</font>

57
00:02:09,239 --> 00:02:13,200
automated<font color="#E5E5E5"> tools because we want our says</font>

58
00:02:11,340 --> 00:02:13,680
if they're able to<font color="#CCCCCC"> actually detect us so</font>

59
00:02:13,200 --> 00:02:15,988
we<font color="#CCCCCC"> trying</font><font color="#E5E5E5"> to</font>

60
00:02:13,680 --> 00:02:18,469
be a bit more<font color="#CCCCCC"> quiet</font><font color="#E5E5E5"> over the network</font><font color="#CCCCCC"> so</font>

61
00:02:15,989 --> 00:02:21,780
<font color="#E5E5E5">we provide different</font><font color="#CCCCCC"> kind</font><font color="#E5E5E5"> of feedback</font>

62
00:02:18,469 --> 00:02:23,370
<font color="#CCCCCC">evaluating their security posture</font><font color="#E5E5E5"> we</font>

63
00:02:21,780 --> 00:02:25,650
<font color="#E5E5E5">usually going</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> define goals with the</font>

64
00:02:23,370 --> 00:02:28,829
<font color="#E5E5E5">client so access the CEO email for</font>

65
00:02:25,650 --> 00:02:30,930
<font color="#CCCCCC">example getting</font><font color="#E5E5E5"> a domain admin</font><font color="#CCCCCC"> access or</font>

66
00:02:28,829 --> 00:02:33,450
targeting specific application that

67
00:02:30,930 --> 00:02:35,250
contained like the the<font color="#E5E5E5"> the real good has</font>

68
00:02:33,450 --> 00:02:37,379
<font color="#E5E5E5">set like customer information and stuff</font>

69
00:02:35,250 --> 00:02:39,269
like that<font color="#E5E5E5"> right and also trying</font><font color="#CCCCCC"> to</font>

70
00:02:37,379 --> 00:02:42,540
demonstrate<font color="#E5E5E5"> the kind</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> path that an</font>

71
00:02:39,269 --> 00:02:44,879
attacker can actually use to get access

72
00:02:42,540 --> 00:02:46,290
<font color="#E5E5E5">to this</font><font color="#CCCCCC"> information because most of</font><font color="#E5E5E5"> the</font>

73
00:02:44,879 --> 00:02:48,929
time we're<font color="#E5E5E5"> going to define them in admin</font>

74
00:02:46,290 --> 00:02:50,760
as as a go but we don't necessarily<font color="#CCCCCC"> need</font>

75
00:02:48,930 --> 00:02:54,269
<font color="#E5E5E5">domain admin to actually get</font><font color="#CCCCCC"> access to</font>

76
00:02:50,760 --> 00:02:56,849
<font color="#E5E5E5">really valuable assets right what</font><font color="#CCCCCC"> Red</font>

77
00:02:54,269 --> 00:02:59,609
<font color="#CCCCCC">Team is</font><font color="#E5E5E5"> not about exporting as many old</font>

78
00:02:56,849 --> 00:03:01,619
<font color="#E5E5E5">a as possible to me a red team is most</font>

79
00:02:59,609 --> 00:03:03,359
likely a sysadmin job so you get your

80
00:03:01,620 --> 00:03:04,769
<font color="#E5E5E5">first foothold then you just have to</font>

81
00:03:03,359 --> 00:03:06,750
understand your<font color="#CCCCCC"> environment and figure</font>

82
00:03:04,769 --> 00:03:08,129
out who have the<font color="#CCCCCC"> the access to the</font>

83
00:03:06,750 --> 00:03:10,200
specific application that you<font color="#E5E5E5"> want</font><font color="#CCCCCC"> to</font>

84
00:03:08,129 --> 00:03:11,909
<font color="#E5E5E5">target right and again it's also not</font>

85
00:03:10,200 --> 00:03:13,679
exploiting as much system as possible

86
00:03:11,909 --> 00:03:16,138
<font color="#CCCCCC">because</font><font color="#E5E5E5"> you want to remain stealth so</font>

87
00:03:13,680 --> 00:03:17,549
sometimes I've conducted<font color="#E5E5E5"> red team where</font>

88
00:03:16,139 --> 00:03:19,109
I only had two<font color="#CCCCCC"> shelves for</font><font color="#E5E5E5"> the whole</font>

89
00:03:17,549 --> 00:03:20,549
<font color="#E5E5E5">things and was enough to</font><font color="#CCCCCC"> actually</font>

90
00:03:19,109 --> 00:03:22,379
achieve all the goals<font color="#CCCCCC"> so that's perfect</font>

91
00:03:20,549 --> 00:03:26,579
<font color="#CCCCCC">for you because you can</font><font color="#E5E5E5"> remain remain</font>

92
00:03:22,379 --> 00:03:28,290
pretty<font color="#E5E5E5"> cell so if you make the analogy</font>

93
00:03:26,579 --> 00:03:30,389
<font color="#E5E5E5">between internal testing and red team</font>

94
00:03:28,290 --> 00:03:31,769
internal testing most like Rambo you're

95
00:03:30,389 --> 00:03:33,629
shooting everywhere and you're just

96
00:03:31,769 --> 00:03:36,689
<font color="#E5E5E5">trying</font><font color="#CCCCCC"> to actually get shells everywhere</font>

97
00:03:33,629 --> 00:03:38,819
<font color="#E5E5E5">and it's usually a little bit more</font>

98
00:03:36,689 --> 00:03:40,409
easier to<font color="#E5E5E5"> get the main admin that way</font>

99
00:03:38,819 --> 00:03:42,569
but it's extremely noisy and it's not

100
00:03:40,409 --> 00:03:44,099
<font color="#CCCCCC">something that you can do when you</font>

101
00:03:42,569 --> 00:03:45,780
perform Red Team Red<font color="#CCCCCC"> Team it's more like</font>

102
00:03:44,099 --> 00:03:47,578
jumbo James Bond you're more still a

103
00:03:45,780 --> 00:03:49,079
little<font color="#E5E5E5"> bit more sexy of the network</font>

104
00:03:47,579 --> 00:03:50,819
usually<font color="#E5E5E5"> your</font><font color="#CCCCCC"> panel is</font><font color="#E5E5E5"> gonna be a bit</font>

105
00:03:49,079 --> 00:03:53,819
<font color="#CCCCCC">more sophisticated and just by using</font>

106
00:03:50,819 --> 00:03:56,099
<font color="#CCCCCC">your muscle to show everywhere but the</font>

107
00:03:53,819 --> 00:03:57,720
<font color="#E5E5E5">realest question are</font><font color="#CCCCCC"> we really sexy and</font>

108
00:03:56,099 --> 00:03:59,819
stealthy as James Bond when we perform

109
00:03:57,720 --> 00:04:01,379
<font color="#CCCCCC">wet</font><font color="#E5E5E5"> theme we're gonna discover that some</font>

110
00:03:59,819 --> 00:04:03,030
of the techniques that<font color="#E5E5E5"> we use are</font><font color="#CCCCCC"> not</font>

111
00:04:01,379 --> 00:04:05,220
<font color="#CCCCCC">solely a stealth as we thought</font>

112
00:04:03,030 --> 00:04:06,449
<font color="#E5E5E5">unfortunately and that's one of the</font>

113
00:04:05,220 --> 00:04:08,819
things that I want<font color="#E5E5E5"> to address just give</font>

114
00:04:06,449 --> 00:04:10,169
you inside of trick<font color="#E5E5E5"> that I</font><font color="#CCCCCC"> use to</font>

115
00:04:08,819 --> 00:04:12,030
<font color="#CCCCCC">actually be a bit more stuff</font>

116
00:04:10,169 --> 00:04:14,099
unfortunately there's no<font color="#E5E5E5"> magic way to</font>

117
00:04:12,030 --> 00:04:15,959
get data without<font color="#E5E5E5"> being detected at some</font>

118
00:04:14,099 --> 00:04:17,699
point because<font color="#E5E5E5"> that's how it works right</font>

119
00:04:15,959 --> 00:04:19,228
you need to<font color="#E5E5E5"> fetch data so at some points</font>

120
00:04:17,699 --> 00:04:21,810
you need<font color="#E5E5E5"> to</font><font color="#CCCCCC"> establish connection to a</font>

121
00:04:19,228 --> 00:04:25,200
specific service<font color="#E5E5E5"> at least</font>

122
00:04:21,810 --> 00:04:28,330
so let's move on to<font color="#E5E5E5"> identify your target</font>

123
00:04:25,200 --> 00:04:30,550
<font color="#E5E5E5">first of all you need a list of targets</font>

124
00:04:28,330 --> 00:04:32,979
<font color="#E5E5E5">right so are you gonna fish</font><font color="#CCCCCC"> employees</font>

125
00:04:30,550 --> 00:04:34,540
specific type<font color="#CCCCCC"> of employees</font><font color="#E5E5E5"> let's say</font>

126
00:04:32,980 --> 00:04:36,970
you're<font color="#E5E5E5"> looking</font><font color="#CCCCCC"> for an insurance company</font>

127
00:04:34,540 --> 00:04:39,490
<font color="#CCCCCC">are you gonna target</font><font color="#E5E5E5"> the the insurance</font>

128
00:04:36,970 --> 00:04:41,200
claim guys that have<font color="#E5E5E5"> limited access or</font>

129
00:04:39,490 --> 00:04:42,760
you're gonna try<font color="#E5E5E5"> to go to the manager or</font>

130
00:04:41,200 --> 00:04:44,920
people with a<font color="#E5E5E5"> little bit more privilege</font>

131
00:04:42,760 --> 00:04:47,170
it may be<font color="#E5E5E5"> interesting because they may</font>

132
00:04:44,920 --> 00:04:50,080
have<font color="#CCCCCC"> specific program internally</font><font color="#E5E5E5"> that</font>

133
00:04:47,170 --> 00:04:52,900
can be that<font color="#CCCCCC"> can be</font><font color="#E5E5E5"> used for a better</font>

134
00:04:50,080 --> 00:04:54,250
fishing campaign identifying<font color="#E5E5E5"> or security</font>

135
00:04:52,900 --> 00:04:56,140
product even<font color="#E5E5E5"> if you don't have a foot</font>

136
00:04:54,250 --> 00:04:57,730
<font color="#CCCCCC">older sometimes some inside that you can</font>

137
00:04:56,140 --> 00:05:00,159
get to actually indentify this kind of

138
00:04:57,730 --> 00:05:02,080
information<font color="#E5E5E5"> and pick the right fishing</font>

139
00:05:00,160 --> 00:05:05,080
camping for your<font color="#E5E5E5"> target</font><font color="#CCCCCC"> we'll discuss</font>

140
00:05:02,080 --> 00:05:07,479
about<font color="#CCCCCC"> this a bit later I'll give you a</font>

141
00:05:05,080 --> 00:05:10,020
perfect<font color="#E5E5E5"> example this is actually a real</font>

142
00:05:07,480 --> 00:05:12,580
a real<font color="#E5E5E5"> screenshot from a real client</font>

143
00:05:10,020 --> 00:05:15,640
<font color="#CCCCCC">that</font><font color="#E5E5E5"> was</font><font color="#CCCCCC"> a fairly new company</font><font color="#E5E5E5"> so they</font>

144
00:05:12,580 --> 00:05:17,109
didn't<font color="#E5E5E5"> have much</font><font color="#CCCCCC"> email</font><font color="#E5E5E5"> that were leaked</font>

145
00:05:15,640 --> 00:05:19,000
and data breach and stuff<font color="#CCCCCC"> like that</font>

146
00:05:17,110 --> 00:05:21,100
which<font color="#CCCCCC"> is a good place to</font><font color="#E5E5E5"> find couple of</font>

147
00:05:19,000 --> 00:05:23,320
<font color="#CCCCCC">emails for your</font><font color="#E5E5E5"> target company however</font>

148
00:05:21,100 --> 00:05:24,730
<font color="#CCCCCC">they were really active</font><font color="#E5E5E5"> on Facebook so</font>

149
00:05:23,320 --> 00:05:26,950
they were posting picture in their

150
00:05:24,730 --> 00:05:28,690
office<font color="#E5E5E5"> with a bunch of people and they</font>

151
00:05:26,950 --> 00:05:31,240
tagged every single<font color="#E5E5E5"> employee on the</font>

152
00:05:28,690 --> 00:05:32,890
<font color="#E5E5E5">picture finding the email pattern is</font>

153
00:05:31,240 --> 00:05:33,940
usually<font color="#CCCCCC"> something simple you need to</font>

154
00:05:32,890 --> 00:05:35,200
find one<font color="#CCCCCC"> or two</font><font color="#E5E5E5"> and you're gonna</font>

155
00:05:33,940 --> 00:05:38,200
understand that<font color="#E5E5E5"> this is their email</font>

156
00:05:35,200 --> 00:05:40,150
pattern so<font color="#CCCCCC"> I</font><font color="#E5E5E5"> basically crafted emails</font>

157
00:05:38,200 --> 00:05:41,830
based on their name on Facebook again

158
00:05:40,150 --> 00:05:43,450
<font color="#E5E5E5">bonus</font><font color="#CCCCCC"> points some of these people</font><font color="#E5E5E5"> were</font>

159
00:05:41,830 --> 00:05:45,609
actually putting into<font color="#CCCCCC"> our job</font><font color="#E5E5E5"> on</font>

160
00:05:43,450 --> 00:05:47,710
Facebook so it was<font color="#E5E5E5"> even easier for</font><font color="#CCCCCC"> me to</font>

161
00:05:45,610 --> 00:05:49,870
figure<font color="#E5E5E5"> out that this person was an</font>

162
00:05:47,710 --> 00:05:51,669
underwriter at the company<font color="#E5E5E5"> or doing</font>

163
00:05:49,870 --> 00:05:54,310
something<font color="#E5E5E5"> else</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> you can select your</font>

164
00:05:51,670 --> 00:05:55,930
<font color="#E5E5E5">target more efficiently so looking at</font>

165
00:05:54,310 --> 00:05:57,850
Facebook<font color="#E5E5E5"> is really a good idea</font><font color="#CCCCCC"> if you're</font>

166
00:05:55,930 --> 00:05:59,500
looking for potential<font color="#CCCCCC"> named</font><font color="#E5E5E5"> for a</font>

167
00:05:57,850 --> 00:06:04,810
specific company if you<font color="#CCCCCC"> don't get much</font>

168
00:05:59,500 --> 00:06:06,460
email through public<font color="#E5E5E5"> public</font><font color="#CCCCCC"> Channel as I</font>

169
00:06:04,810 --> 00:06:08,770
mentioned searching publicly available

170
00:06:06,460 --> 00:06:12,549
password dump<font color="#E5E5E5"> like there's a couple of</font>

171
00:06:08,770 --> 00:06:13,990
huge dump like Adobe Ashley<font color="#E5E5E5"> Madison and</font>

172
00:06:12,550 --> 00:06:15,460
bunch of<font color="#CCCCCC"> other</font><font color="#E5E5E5"> in the past that can</font>

173
00:06:13,990 --> 00:06:17,050
actually<font color="#E5E5E5"> give you a bunch of email</font>

174
00:06:15,460 --> 00:06:18,580
address<font color="#CCCCCC"> that</font><font color="#E5E5E5"> can be used you don't</font>

175
00:06:17,050 --> 00:06:20,470
really<font color="#E5E5E5"> care about</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> but the password</font>

176
00:06:18,580 --> 00:06:22,510
you mostly<font color="#E5E5E5"> gonna fish those people right</font>

177
00:06:20,470 --> 00:06:23,950
so<font color="#CCCCCC"> you just reuse this information</font><font color="#E5E5E5"> get</font>

178
00:06:22,510 --> 00:06:26,110
hub you'll be surprised<font color="#E5E5E5"> how many dev</font>

179
00:06:23,950 --> 00:06:28,090
actually put their email<font color="#E5E5E5"> in the author</font>

180
00:06:26,110 --> 00:06:30,490
and<font color="#E5E5E5"> they're actually</font><font color="#CCCCCC"> a company</font><font color="#E5E5E5"> and</font>

181
00:06:28,090 --> 00:06:32,080
there's an incident couple of months ago

182
00:06:30,490 --> 00:06:34,700
<font color="#CCCCCC">that happened with a company that</font>

183
00:06:32,080 --> 00:06:36,770
<font color="#CCCCCC">actually had email</font>

184
00:06:34,700 --> 00:06:38,810
<font color="#E5E5E5">leak through their github and they also</font>

185
00:06:36,770 --> 00:06:40,609
<font color="#E5E5E5">leaked internal password that way so you</font>

186
00:06:38,810 --> 00:06:43,160
can even find<font color="#E5E5E5"> passwords sometimes for</font>

187
00:06:40,610 --> 00:06:44,780
free<font color="#CCCCCC"> babe in same idea people</font><font color="#E5E5E5"> may just</font>

188
00:06:43,160 --> 00:06:46,639
<font color="#CCCCCC">put some things</font><font color="#E5E5E5"> to share with</font><font color="#CCCCCC"> a friend</font>

189
00:06:44,780 --> 00:06:48,979
<font color="#CCCCCC">and they kind of forget that it's public</font>

190
00:06:46,639 --> 00:06:52,419
sometimes<font color="#E5E5E5"> and indexed by Google so you</font>

191
00:06:48,980 --> 00:06:54,860
can also<font color="#E5E5E5"> find it that way</font>

192
00:06:52,419 --> 00:06:57,620
another really good<font color="#CCCCCC"> thing is</font><font color="#E5E5E5"> oh</font><font color="#CCCCCC"> whoa</font>

193
00:06:54,860 --> 00:07:00,200
<font color="#E5E5E5">actually oh whoa</font><font color="#CCCCCC"> is the devil</font><font color="#E5E5E5"> pretty</font>

194
00:06:57,620 --> 00:07:00,980
<font color="#E5E5E5">much you can do a lot</font><font color="#CCCCCC"> of amazing stuff</font>

195
00:07:00,200 --> 00:07:03,260
<font color="#CCCCCC">with OA</font>

196
00:07:00,980 --> 00:07:05,450
there's most company are<font color="#E5E5E5"> not moving to</font>

197
00:07:03,260 --> 00:07:07,849
office<font color="#CCCCCC"> 365 which is the cloud version of</font>

198
00:07:05,450 --> 00:07:10,460
it but<font color="#CCCCCC"> they're</font><font color="#E5E5E5"> still super cool feature</font>

199
00:07:07,850 --> 00:07:13,160
<font color="#CCCCCC">Oh on premise</font><font color="#E5E5E5"> you can actually</font><font color="#CCCCCC"> League</font>

200
00:07:10,460 --> 00:07:15,409
the gal which is the global<font color="#CCCCCC"> address list</font>

201
00:07:13,160 --> 00:07:17,060
which<font color="#E5E5E5"> contains all the employees all you</font>

202
00:07:15,410 --> 00:07:18,860
need is a<font color="#E5E5E5"> password right but it's</font><font color="#CCCCCC"> not</font>

203
00:07:17,060 --> 00:07:22,190
really hard because<font color="#CCCCCC"> people tend to have</font>

204
00:07:18,860 --> 00:07:24,440
terrible password so one of<font color="#E5E5E5"> the things</font>

205
00:07:22,190 --> 00:07:26,540
that you can do<font color="#CCCCCC"> brute-force their</font>

206
00:07:24,440 --> 00:07:29,600
password so assume<font color="#CCCCCC"> that you found a list</font>

207
00:07:26,540 --> 00:07:32,630
of email<font color="#CCCCCC"> use the good ol season plus the</font>

208
00:07:29,600 --> 00:07:34,520
year so spring 2010 and just spray it

209
00:07:32,630 --> 00:07:36,110
against all of them and you're probably

210
00:07:34,520 --> 00:07:37,070
gonna find<font color="#E5E5E5"> at least one</font><font color="#CCCCCC"> or two account</font>

211
00:07:36,110 --> 00:07:38,600
<font color="#E5E5E5">doesn't really matter if</font><font color="#CCCCCC"> they're</font>

212
00:07:37,070 --> 00:07:42,110
<font color="#E5E5E5">privileged or not because you</font><font color="#CCCCCC"> can use</font>

213
00:07:38,600 --> 00:07:44,750
this<font color="#E5E5E5"> this credential</font><font color="#CCCCCC"> to actually get to</font>

214
00:07:42,110 --> 00:07:46,220
the the service<font color="#CCCCCC"> which actually have the</font>

215
00:07:44,750 --> 00:07:48,200
filter that<font color="#E5E5E5"> get people</font><font color="#CCCCCC"> filtered that</font>

216
00:07:46,220 --> 00:07:50,360
<font color="#CCCCCC">gonna</font><font color="#E5E5E5"> provide you the list of all their</font>

217
00:07:48,200 --> 00:07:52,130
<font color="#E5E5E5">employees</font><font color="#CCCCCC"> so from there you can</font><font color="#E5E5E5"> just</font>

218
00:07:50,360 --> 00:07:54,919
restart the whole process<font color="#E5E5E5"> but with all</font>

219
00:07:52,130 --> 00:07:59,150
<font color="#CCCCCC">of their their Active Directory which is</font>

220
00:07:54,919 --> 00:08:00,440
<font color="#E5E5E5">very interesting cool thing even if</font><font color="#CCCCCC"> MFA</font>

221
00:07:59,150 --> 00:08:01,969
is enabled so multi-factor

222
00:08:00,440 --> 00:08:04,010
authentication is<font color="#CCCCCC"> enabled it's still</font>

223
00:08:01,970 --> 00:08:05,840
<font color="#CCCCCC">gonna work</font><font color="#E5E5E5"> without it it's basically</font>

224
00:08:04,010 --> 00:08:07,520
<font color="#CCCCCC">just support basic authentication so</font>

225
00:08:05,840 --> 00:08:09,260
it's fairly easy<font color="#E5E5E5"> to script it there's a</font>

226
00:08:07,520 --> 00:08:11,690
bunch of tool online<font color="#CCCCCC"> actually do</font><font color="#E5E5E5"> that</font>

227
00:08:09,260 --> 00:08:14,950
for you<font color="#E5E5E5"> so targeting oh whoa is really</font>

228
00:08:11,690 --> 00:08:18,140
<font color="#CCCCCC">lucrative</font><font color="#E5E5E5"> same approach with office 365</font>

229
00:08:14,950 --> 00:08:19,789
<font color="#CCCCCC">there's a public API</font><font color="#E5E5E5"> that you</font><font color="#CCCCCC"> can</font><font color="#E5E5E5"> use</font>

230
00:08:18,140 --> 00:08:22,010
that achieve pretty<font color="#CCCCCC"> much the</font><font color="#E5E5E5"> same thing</font>

231
00:08:19,789 --> 00:08:25,070
so<font color="#CCCCCC"> again you</font><font color="#E5E5E5"> just have</font><font color="#CCCCCC"> to lick couple of</font>

232
00:08:22,010 --> 00:08:27,289
emails<font color="#E5E5E5"> and you can query the</font><font color="#CCCCCC"> API and</font>

233
00:08:25,070 --> 00:08:29,270
found the information<font color="#CCCCCC"> again you can also</font>

234
00:08:27,289 --> 00:08:30,950
perform password<font color="#E5E5E5"> brute force on</font>

235
00:08:29,270 --> 00:08:34,130
<font color="#CCCCCC">auto-discovery which</font><font color="#E5E5E5"> is a public domain</font>

236
00:08:30,950 --> 00:08:36,080
<font color="#E5E5E5">for all the the cloud client and most of</font>

237
00:08:34,130 --> 00:08:38,299
the time client<font color="#CCCCCC"> don't get inside of the</font>

238
00:08:36,080 --> 00:08:39,710
kind of attack<font color="#CCCCCC"> that are perform against</font>

239
00:08:38,299 --> 00:08:42,079
this<font color="#E5E5E5"> system in because it's owned</font><font color="#CCCCCC"> by</font>

240
00:08:39,710 --> 00:08:43,370
Microsoft<font color="#E5E5E5"> so it may</font><font color="#CCCCCC"> take a bit of</font><font color="#E5E5E5"> time</font>

241
00:08:42,080 --> 00:08:45,080
before<font color="#CCCCCC"> they</font><font color="#E5E5E5"> actually realize</font><font color="#CCCCCC"> that</font>

242
00:08:43,370 --> 00:08:47,000
<font color="#E5E5E5">they're a DFS</font>

243
00:08:45,080 --> 00:08:49,760
is<font color="#E5E5E5"> actually been</font><font color="#CCCCCC"> brought</font><font color="#E5E5E5"> forth</font>

244
00:08:47,000 --> 00:08:52,910
<font color="#E5E5E5">externally because nobody</font><font color="#CCCCCC"> like look at</font>

245
00:08:49,760 --> 00:08:56,840
their logs right do you<font color="#CCCCCC"> I don't</font>

246
00:08:52,910 --> 00:08:59,569
personally<font color="#CCCCCC"> show down it's also really</font>

247
00:08:56,840 --> 00:09:02,600
<font color="#CCCCCC">useful you'll be surprised</font><font color="#E5E5E5"> how many good</font>

248
00:08:59,570 --> 00:09:05,720
<font color="#E5E5E5">Oh Citrix portal</font><font color="#CCCCCC"> over</font><font color="#E5E5E5"> VPN</font><font color="#CCCCCC"> door actually</font>

249
00:09:02,600 --> 00:09:07,190
<font color="#E5E5E5">publicly exposed by your targets just</font>

250
00:09:05,720 --> 00:09:09,140
<font color="#E5E5E5">use shown and all the information</font><font color="#CCCCCC"> is</font>

251
00:09:07,190 --> 00:09:11,870
<font color="#E5E5E5">there you're gonna get all what you need</font>

252
00:09:09,140 --> 00:09:14,060
<font color="#E5E5E5">and if it's not a multi-factor</font>

253
00:09:11,870 --> 00:09:15,440
authentication<font color="#E5E5E5"> usually by using the</font>

254
00:09:14,060 --> 00:09:17,329
<font color="#E5E5E5">previous information that you got by</font>

255
00:09:15,440 --> 00:09:19,100
brute forcing password through<font color="#CCCCCC"> over you</font>

256
00:09:17,330 --> 00:09:21,110
may found<font color="#E5E5E5"> a valuable employee to have</font><font color="#CCCCCC"> a</font>

257
00:09:19,100 --> 00:09:23,660
<font color="#E5E5E5">Citrix portal access to a specific</font>

258
00:09:21,110 --> 00:09:26,150
application<font color="#E5E5E5"> and from from there you can</font>

259
00:09:23,660 --> 00:09:28,490
<font color="#E5E5E5">try to do Citrix escape and stuff like</font>

260
00:09:26,150 --> 00:09:30,470
that and<font color="#E5E5E5"> basically get a shell inside of</font>

261
00:09:28,490 --> 00:09:31,940
their own network<font color="#E5E5E5"> without even having to</font>

262
00:09:30,470 --> 00:09:34,400
fish the<font color="#CCCCCC"> whole company which is very</font>

263
00:09:31,940 --> 00:09:36,110
interesting<font color="#E5E5E5"> because the most critical</font>

264
00:09:34,400 --> 00:09:37,699
part is usually<font color="#CCCCCC"> phishing this</font><font color="#E5E5E5"> is where</font>

265
00:09:36,110 --> 00:09:38,900
you have to interact with<font color="#CCCCCC"> the user so</font>

266
00:09:37,700 --> 00:09:42,890
<font color="#E5E5E5">you have better chance of being detected</font>

267
00:09:38,900 --> 00:09:44,180
at that specific step so that's<font color="#CCCCCC"> a gold</font>

268
00:09:42,890 --> 00:09:47,090
trick and as I told<font color="#E5E5E5"> you the good old</font>

269
00:09:44,180 --> 00:09:48,770
summer<font color="#CCCCCC"> 2002</font><font color="#E5E5E5"> 2018 always gonna work</font>

270
00:09:47,090 --> 00:09:51,970
unfortunately<font color="#CCCCCC"> because it's compliant</font>

271
00:09:48,770 --> 00:09:54,319
<font color="#CCCCCC">even if your password policies in force</font>

272
00:09:51,970 --> 00:09:56,270
except nobody<font color="#E5E5E5"> enforce the special</font>

273
00:09:54,320 --> 00:09:58,610
character policy<font color="#CCCCCC"> in Active</font><font color="#E5E5E5"> Directory so</font>

274
00:09:56,270 --> 00:10:00,590
even if you know for a fact that<font color="#CCCCCC"> your</font>

275
00:09:58,610 --> 00:10:02,300
your client is enforcing that<font color="#CCCCCC"> just had a</font>

276
00:10:00,590 --> 00:10:05,840
bang at<font color="#CCCCCC"> the end and you're still gonna</font>

277
00:10:02,300 --> 00:10:07,670
<font color="#E5E5E5">get success unfortunately and that's a</font>

278
00:10:05,840 --> 00:10:11,870
fact<font color="#E5E5E5"> that's the sad part of it I'm not</font>

279
00:10:07,670 --> 00:10:13,849
<font color="#E5E5E5">even</font><font color="#CCCCCC"> joking</font><font color="#E5E5E5"> so you want to identify</font>

280
00:10:11,870 --> 00:10:15,800
<font color="#E5E5E5">which kind of security product your</font>

281
00:10:13,850 --> 00:10:17,600
clients have there's a<font color="#E5E5E5"> couple of trick</font>

282
00:10:15,800 --> 00:10:19,880
like<font color="#CCCCCC"> that most of the security product</font>

283
00:10:17,600 --> 00:10:21,650
<font color="#E5E5E5">tend to be verbose they kind of want to</font>

284
00:10:19,880 --> 00:10:23,450
show you that they're there<font color="#CCCCCC"> and they're</font>

285
00:10:21,650 --> 00:10:26,020
<font color="#CCCCCC">really proud of</font><font color="#E5E5E5"> being there so</font><font color="#CCCCCC"> they're</font>

286
00:10:23,450 --> 00:10:29,660
usually gonna have bunch of information

287
00:10:26,020 --> 00:10:32,329
<font color="#E5E5E5">that you can actually use so trying to</font>

288
00:10:29,660 --> 00:10:34,040
<font color="#E5E5E5">find an</font><font color="#CCCCCC"> email that</font><font color="#E5E5E5"> is not used anymore</font>

289
00:10:32,330 --> 00:10:36,830
<font color="#E5E5E5">so it has been</font><font color="#CCCCCC"> dis activated by your</font>

290
00:10:34,040 --> 00:10:38,240
<font color="#E5E5E5">targeted Corp and send an email to</font><font color="#CCCCCC"> that</font>

291
00:10:36,830 --> 00:10:40,130
<font color="#E5E5E5">clients of</font><font color="#CCCCCC"> course it's going</font><font color="#E5E5E5"> to bounce</font>

292
00:10:38,240 --> 00:10:43,400
back saying<font color="#E5E5E5"> that the user does not exist</font>

293
00:10:40,130 --> 00:10:45,230
anymore<font color="#CCCCCC"> and</font><font color="#E5E5E5"> look at the SMTP error</font>

294
00:10:43,400 --> 00:10:46,910
<font color="#E5E5E5">you'll be really surprised of all the</font>

295
00:10:45,230 --> 00:10:49,190
information<font color="#CCCCCC"> that</font><font color="#E5E5E5"> you can found here's</font>

296
00:10:46,910 --> 00:10:51,230
just three<font color="#CCCCCC"> simple example the first</font><font color="#E5E5E5"> one</font>

297
00:10:49,190 --> 00:10:53,240
is the Microsoft<font color="#CCCCCC"> technology so you have</font>

298
00:10:51,230 --> 00:10:55,520
like the<font color="#CCCCCC"> reputation of the email</font><font color="#E5E5E5"> and you</font>

299
00:10:53,240 --> 00:10:57,690
<font color="#CCCCCC">can confirm that everything is good and</font>

300
00:10:55,520 --> 00:10:59,939
<font color="#E5E5E5">didn't detect anything</font>

301
00:10:57,690 --> 00:11:01,950
with your payload and even<font color="#E5E5E5"> there you can</font>

302
00:10:59,940 --> 00:11:04,500
<font color="#E5E5E5">notify that they don't have SPF enable</font>

303
00:11:01,950 --> 00:11:06,600
which is another<font color="#E5E5E5"> bad</font><font color="#CCCCCC"> thing a second one</font>

304
00:11:04,500 --> 00:11:09,450
<font color="#E5E5E5">is proof point and you have the scoring</font>

305
00:11:06,600 --> 00:11:10,860
of<font color="#E5E5E5"> your email so if you're scoring badly</font>

306
00:11:09,450 --> 00:11:12,180
maybe you should adapt your fishing

307
00:11:10,860 --> 00:11:13,800
camping a bit to make<font color="#CCCCCC"> sure that you're</font>

308
00:11:12,180 --> 00:11:15,839
<font color="#CCCCCC">gonna</font><font color="#E5E5E5"> score better before doing the</font>

309
00:11:13,800 --> 00:11:19,979
actual fishing<font color="#E5E5E5"> campaign against your</font>

310
00:11:15,840 --> 00:11:21,240
client<font color="#E5E5E5"> last one good</font><font color="#CCCCCC"> ol McAfee so again</font>

311
00:11:19,980 --> 00:11:23,070
you can know<font color="#E5E5E5"> for a fact that they use</font>

312
00:11:21,240 --> 00:11:25,280
McAfee technology and<font color="#CCCCCC"> on the other</font><font color="#E5E5E5"> side</font>

313
00:11:23,070 --> 00:11:27,720
<font color="#CCCCCC">and you can kind of adapt your phishing</font>

314
00:11:25,280 --> 00:11:29,400
email to make<font color="#E5E5E5"> sure that you're not going</font>

315
00:11:27,720 --> 00:11:33,420
<font color="#E5E5E5">to be detected by the solution that they</font>

316
00:11:29,400 --> 00:11:35,100
use another simple example<font color="#E5E5E5"> LinkedIn</font><font color="#CCCCCC"> it's</font>

317
00:11:33,420 --> 00:11:37,140
your friend<font color="#CCCCCC"> just look</font><font color="#E5E5E5"> for the kind of</font>

318
00:11:35,100 --> 00:11:38,400
job that<font color="#CCCCCC"> they're</font><font color="#E5E5E5"> offering you it may</font>

319
00:11:37,140 --> 00:11:40,949
<font color="#E5E5E5">help you so if they're looking for</font>

320
00:11:38,400 --> 00:11:42,569
<font color="#CCCCCC">supplying me in palo alto art side for</font>

321
00:11:40,950 --> 00:11:43,950
<font color="#CCCCCC">example</font><font color="#E5E5E5"> you kind of know what they're</font>

322
00:11:42,570 --> 00:11:46,110
<font color="#E5E5E5">probably using on the other side so</font>

323
00:11:43,950 --> 00:11:50,340
again<font color="#CCCCCC"> you</font><font color="#E5E5E5"> can adapt your</font><font color="#CCCCCC"> peddle</font><font color="#E5E5E5"> based on</font>

324
00:11:46,110 --> 00:11:52,710
this<font color="#CCCCCC"> information</font><font color="#E5E5E5"> also their corporate</font>

325
00:11:50,340 --> 00:11:55,470
<font color="#E5E5E5">the website is really useful to</font><font color="#CCCCCC"> get</font>

326
00:11:52,710 --> 00:11:57,630
ideas<font color="#E5E5E5"> most big company</font><font color="#CCCCCC"> now they have</font>

327
00:11:55,470 --> 00:12:02,070
like royalty program<font color="#E5E5E5"> internally or they</font>

328
00:11:57,630 --> 00:12:03,689
involve in like a<font color="#E5E5E5"> shouty</font><font color="#CCCCCC"> chari</font><font color="#E5E5E5"> program</font>

329
00:12:02,070 --> 00:12:05,490
and stuff<font color="#E5E5E5"> like that so if you know for a</font>

330
00:12:03,690 --> 00:12:08,190
fact that there's an upcoming event in a

331
00:12:05,490 --> 00:12:10,410
month<font color="#E5E5E5"> let's say you can decide to make a</font>

332
00:12:08,190 --> 00:12:12,300
<font color="#E5E5E5">fishing camping base out</font><font color="#CCCCCC"> of this so it's</font>

333
00:12:10,410 --> 00:12:13,770
kind of good in time because it makes

334
00:12:12,300 --> 00:12:15,959
sense for<font color="#E5E5E5"> them to receive email about</font>

335
00:12:13,770 --> 00:12:17,430
<font color="#E5E5E5">that</font><font color="#CCCCCC"> at</font><font color="#E5E5E5"> that specific time</font><font color="#CCCCCC"> or if they</font>

336
00:12:15,960 --> 00:12:19,170
<font color="#E5E5E5">have loyalty program you can claim that</font>

337
00:12:17,430 --> 00:12:20,969
<font color="#CCCCCC">you change something in the loyalty</font>

338
00:12:19,170 --> 00:12:22,620
program and you have<font color="#E5E5E5"> to subscribe there</font>

339
00:12:20,970 --> 00:12:23,640
and provide your<font color="#E5E5E5"> active directory we</font><font color="#CCCCCC"> can</font>

340
00:12:22,620 --> 00:12:28,830
branch<font color="#E5E5E5"> out on</font><font color="#CCCCCC"> a third party website</font>

341
00:12:23,640 --> 00:12:30,810
<font color="#E5E5E5">right it's</font><font color="#CCCCCC"> 100%</font><font color="#E5E5E5"> legitimate so at that</font>

342
00:12:28,830 --> 00:12:32,820
<font color="#E5E5E5">point let's assume that we there's a</font>

343
00:12:30,810 --> 00:12:34,050
bunch of other way to<font color="#E5E5E5"> actually perform</font>

344
00:12:32,820 --> 00:12:36,540
<font color="#E5E5E5">this part but let's</font><font color="#CCCCCC"> assume that we</font>

345
00:12:34,050 --> 00:12:38,370
collected a good list of email we<font color="#CCCCCC"> have a</font>

346
00:12:36,540 --> 00:12:40,860
good<font color="#E5E5E5"> idea</font><font color="#CCCCCC"> of our target let's move to</font>

347
00:12:38,370 --> 00:12:42,240
<font color="#E5E5E5">the actual phishing campaign itself</font><font color="#CCCCCC"> so</font>

348
00:12:40,860 --> 00:12:43,980
here's a couple<font color="#CCCCCC"> of rules that</font><font color="#E5E5E5"> I</font>

349
00:12:42,240 --> 00:12:45,990
personally follow when I do<font color="#E5E5E5"> phishing</font>

350
00:12:43,980 --> 00:12:48,120
campaign<font color="#CCCCCC"> the first one</font><font color="#E5E5E5"> never put your</font>

351
00:12:45,990 --> 00:12:49,800
malicious payload<font color="#E5E5E5"> in the email that's</font>

352
00:12:48,120 --> 00:12:51,300
really important because<font color="#E5E5E5"> you don't get</font>

353
00:12:49,800 --> 00:12:53,819
any<font color="#CCCCCC"> visibility and I'll cover this a</font>

354
00:12:51,300 --> 00:12:56,280
little<font color="#E5E5E5"> bit more in details</font><font color="#CCCCCC"> afterward</font>

355
00:12:53,820 --> 00:12:58,320
<font color="#E5E5E5">don't allow don't allow or made it</font>

356
00:12:56,280 --> 00:13:00,180
<font color="#E5E5E5">solution to have insight into your final</font>

357
00:12:58,320 --> 00:13:01,680
search so if you know a<font color="#E5E5E5"> way to</font><font color="#CCCCCC"> actually</font>

358
00:13:00,180 --> 00:13:04,020
prevent automated tools to actually

359
00:13:01,680 --> 00:13:06,510
<font color="#CCCCCC">fetch your payload do it</font><font color="#E5E5E5"> it's always</font>

360
00:13:04,020 --> 00:13:08,460
gonna benefit<font color="#CCCCCC"> you use categorize domain</font>

361
00:13:06,510 --> 00:13:09,100
<font color="#E5E5E5">it's super easy to get categorized the</font>

362
00:13:08,460 --> 00:13:10,690
man

363
00:13:09,100 --> 00:13:12,430
you know for a fighter you<font color="#E5E5E5"> go through</font>

364
00:13:10,690 --> 00:13:14,650
most proxy that way so<font color="#E5E5E5"> you</font><font color="#CCCCCC"> don't even</font>

365
00:13:12,430 --> 00:13:17,109
<font color="#E5E5E5">have</font><font color="#CCCCCC"> to worry that</font><font color="#E5E5E5"> your</font><font color="#CCCCCC"> CE to server may</font>

366
00:13:14,650 --> 00:13:19,959
just be not authorizes in by the

367
00:13:17,110 --> 00:13:22,030
corporate proxy use<font color="#CCCCCC"> HTTPS</font>

368
00:13:19,960 --> 00:13:23,620
there's no reason of not<font color="#E5E5E5"> doing it you're</font>

369
00:13:22,030 --> 00:13:26,410
just<font color="#CCCCCC"> gonna blend with the the rest of</font>

370
00:13:23,620 --> 00:13:27,280
the encrypted<font color="#E5E5E5"> traffic</font><font color="#CCCCCC"> be boring as much</font>

371
00:13:26,410 --> 00:13:28,810
as<font color="#CCCCCC"> possible</font>

372
00:13:27,280 --> 00:13:30,400
none of that lot of<font color="#CCCCCC"> people don't</font><font color="#E5E5E5"> agree</font>

373
00:13:28,810 --> 00:13:31,689
<font color="#E5E5E5">with me on this</font><font color="#CCCCCC"> one but I</font><font color="#E5E5E5"> personally</font>

374
00:13:30,400 --> 00:13:33,819
<font color="#E5E5E5">just strongly believe that you should</font>

375
00:13:31,690 --> 00:13:35,560
make your phishing campaign as boring as

376
00:13:33,820 --> 00:13:37,900
possible<font color="#E5E5E5"> and as much corporate as</font>

377
00:13:35,560 --> 00:13:40,060
possible<font color="#E5E5E5"> just personally I</font><font color="#CCCCCC"> really</font>

378
00:13:37,900 --> 00:13:41,860
enjoyed the<font color="#CCCCCC"> code</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> conduct thing just</font>

379
00:13:40,060 --> 00:13:44,349
here here's a code of<font color="#E5E5E5"> conduct</font><font color="#CCCCCC"> update</font>

380
00:13:41,860 --> 00:13:46,480
<font color="#E5E5E5">please read</font><font color="#CCCCCC"> it and approve it nobody's</font>

381
00:13:44,350 --> 00:13:48,250
gonna do it<font color="#CCCCCC"> nobody care but you're</font>

382
00:13:46,480 --> 00:13:49,780
always gonna<font color="#E5E5E5"> get one or two person</font>

383
00:13:48,250 --> 00:13:51,280
that's finally<font color="#E5E5E5"> gonna do with it</font><font color="#CCCCCC"> may</font>

384
00:13:49,780 --> 00:13:52,420
<font color="#E5E5E5">takes like</font><font color="#CCCCCC"> two days</font><font color="#E5E5E5"> before you get your</font>

385
00:13:51,280 --> 00:13:55,089
show but<font color="#E5E5E5"> at least they're just gonna</font>

386
00:13:52,420 --> 00:13:56,650
ignore<font color="#E5E5E5"> it</font><font color="#CCCCCC"> if you offer some some things</font>

387
00:13:55,090 --> 00:13:57,910
to people<font color="#E5E5E5"> usually they're gonna be more</font>

388
00:13:56,650 --> 00:14:00,010
<font color="#CCCCCC">trill and they're gonna look at</font><font color="#E5E5E5"> the</font>

389
00:13:57,910 --> 00:14:01,959
emails<font color="#E5E5E5"> oh yeah I get 50 bucks or</font>

390
00:14:00,010 --> 00:14:03,400
<font color="#CCCCCC">something like that</font><font color="#E5E5E5"> in Amazon card so</font>

391
00:14:01,960 --> 00:14:04,750
they're<font color="#E5E5E5"> really gonna look at the email</font>

392
00:14:03,400 --> 00:14:06,449
and feel like<font color="#E5E5E5"> they're they're looking</font>

393
00:14:04,750 --> 00:14:08,800
for someone so<font color="#CCCCCC"> they may catch</font><font color="#E5E5E5"> up and</font>

394
00:14:06,450 --> 00:14:10,600
take a look at the email<font color="#CCCCCC"> again and may</font>

395
00:14:08,800 --> 00:14:12,219
realize that it's fishy and may

396
00:14:10,600 --> 00:14:13,930
potentially<font color="#CCCCCC"> raisin or especially a</font>

397
00:14:12,220 --> 00:14:15,730
nowaday there's a lot of companies<font color="#CCCCCC"> that</font>

398
00:14:13,930 --> 00:14:17,530
have<font color="#E5E5E5"> a</font><font color="#CCCCCC"> phishing button built</font><font color="#E5E5E5"> in and like</font>

399
00:14:15,730 --> 00:14:21,790
<font color="#CCCCCC">Outlook for example so it's fairly easy</font>

400
00:14:17,530 --> 00:14:23,680
now to report using typosquatting

401
00:14:21,790 --> 00:14:26,050
nowaday<font color="#CCCCCC"> I think it's a</font><font color="#E5E5E5"> really bad idea</font>

402
00:14:23,680 --> 00:14:28,239
<font color="#CCCCCC">because it's a</font><font color="#E5E5E5"> bit more fishy and we're</font>

403
00:14:26,050 --> 00:14:31,030
<font color="#E5E5E5">living in everything as a services error</font>

404
00:14:28,240 --> 00:14:33,940
<font color="#E5E5E5">so for us it's pretty common to see like</font>

405
00:14:31,030 --> 00:14:36,069
a<font color="#E5E5E5"> subdomain like company supplements</font>

406
00:14:33,940 --> 00:14:38,020
such as far I<font color="#CCCCCC"> dot whatever third party</font>

407
00:14:36,070 --> 00:14:40,300
comm because this is now how the

408
00:14:38,020 --> 00:14:43,060
internet works so having this is more

409
00:14:40,300 --> 00:14:46,180
legit than<font color="#CCCCCC"> like</font><font color="#E5E5E5"> far</font><font color="#CCCCCC"> I with 3e for</font>

410
00:14:43,060 --> 00:14:49,479
<font color="#E5E5E5">example and don't reuse your domain as a</font>

411
00:14:46,180 --> 00:14:50,920
as a red teamer<font color="#CCCCCC"> and as a</font><font color="#E5E5E5"> company some of</font>

412
00:14:49,480 --> 00:14:52,900
your sample<font color="#E5E5E5"> me ended up on virustotal</font>

413
00:14:50,920 --> 00:14:54,729
because a<font color="#E5E5E5"> client may caught you and they</font>

414
00:14:52,900 --> 00:14:55,990
may try to analyze<font color="#CCCCCC"> it so you may</font>

415
00:14:54,730 --> 00:14:57,400
actually just<font color="#CCCCCC"> leak out a</font><font color="#E5E5E5"> client</font>

416
00:14:55,990 --> 00:15:00,700
<font color="#CCCCCC">information that way and it's not</font>

417
00:14:57,400 --> 00:15:03,220
<font color="#E5E5E5">something that you want to do so</font><font color="#CCCCCC"> Malchus</font>

418
00:15:00,700 --> 00:15:04,510
payload<font color="#E5E5E5"> you don't have any insight if</font>

419
00:15:03,220 --> 00:15:05,830
it's inside<font color="#E5E5E5"> of your pillow you don't</font>

420
00:15:04,510 --> 00:15:07,600
know if it was<font color="#CCCCCC"> fetched</font><font color="#E5E5E5"> you don't know</font>

421
00:15:05,830 --> 00:15:11,500
which kind<font color="#E5E5E5"> of solution potentially fetch</font>

422
00:15:07,600 --> 00:15:12,730
it<font color="#E5E5E5"> you have zero control over it so one</font>

423
00:15:11,500 --> 00:15:14,890
of the things that you<font color="#E5E5E5"> should do is</font>

424
00:15:12,730 --> 00:15:17,890
always<font color="#CCCCCC"> put a link that point to website</font>

425
00:15:14,890 --> 00:15:19,780
where your payload<font color="#E5E5E5"> is hosted</font><font color="#CCCCCC"> if like</font>

426
00:15:17,890 --> 00:15:20,960
they have a solution<font color="#CCCCCC"> that actually</font><font color="#E5E5E5"> fetch</font>

427
00:15:19,780 --> 00:15:22,880
your<font color="#E5E5E5"> paddle you're gonna know for</font>

428
00:15:20,960 --> 00:15:24,740
fact that the<font color="#E5E5E5"> solution fetched the</font>

429
00:15:22,880 --> 00:15:26,120
website so you<font color="#CCCCCC"> can fingerprint the IP</font>

430
00:15:24,740 --> 00:15:28,040
address and maybe<font color="#CCCCCC"> correlate this IP</font>

431
00:15:26,120 --> 00:15:29,330
address<font color="#E5E5E5"> with the company if there's</font>

432
00:15:28,040 --> 00:15:30,980
something<font color="#E5E5E5"> is wrong</font><font color="#CCCCCC"> you're paid off</font><font color="#E5E5E5"> for</font>

433
00:15:29,330 --> 00:15:32,570
<font color="#E5E5E5">whatever reason it's easier for you</font><font color="#CCCCCC"> to</font>

434
00:15:30,980 --> 00:15:34,850
swap it because you can just<font color="#E5E5E5"> change the</font>

435
00:15:32,570 --> 00:15:36,710
content of<font color="#CCCCCC"> the website</font><font color="#E5E5E5"> on</font><font color="#CCCCCC"> the fly</font>

436
00:15:34,850 --> 00:15:39,980
without<font color="#CCCCCC"> having</font><font color="#E5E5E5"> to send new phishing</font>

437
00:15:36,710 --> 00:15:41,330
campaign<font color="#CCCCCC"> with new links so this is the</font>

438
00:15:39,980 --> 00:15:43,430
perfect<font color="#CCCCCC"> example as I</font><font color="#E5E5E5"> mentioned I'm a</font>

439
00:15:41,330 --> 00:15:45,740
personal huge fan of code of conduct

440
00:15:43,430 --> 00:15:48,349
update so<font color="#E5E5E5"> you just say hi Bob we</font>

441
00:15:45,740 --> 00:15:50,510
currently updated<font color="#E5E5E5"> a code of conduct</font>

442
00:15:48,350 --> 00:15:52,850
<font color="#E5E5E5">policy please just review and accept as</font>

443
00:15:50,510 --> 00:15:55,430
soon as possible and<font color="#CCCCCC"> you provided this</font>

444
00:15:52,850 --> 00:15:57,650
super corporate link right with the<font color="#E5E5E5"> UID</font>

445
00:15:55,430 --> 00:15:58,819
at<font color="#E5E5E5"> the end so</font><font color="#CCCCCC"> you can</font><font color="#E5E5E5"> track</font><font color="#CCCCCC"> your user</font>

446
00:15:57,650 --> 00:16:01,040
that's<font color="#CCCCCC"> that's</font><font color="#E5E5E5"> something is really</font>

447
00:15:58,820 --> 00:16:03,110
important because if you know<font color="#E5E5E5"> for a fact</font>

448
00:16:01,040 --> 00:16:05,120
that this idea was<font color="#CCCCCC"> tied to a specific</font>

449
00:16:03,110 --> 00:16:06,680
<font color="#E5E5E5">user and you see like three</font><font color="#CCCCCC"> different IP</font>

450
00:16:05,120 --> 00:16:08,780
fetching the same pedal you're probably

451
00:16:06,680 --> 00:16:10,280
you're<font color="#CCCCCC"> probably</font><font color="#E5E5E5"> facing an automated</font>

452
00:16:08,780 --> 00:16:11,540
product that is<font color="#E5E5E5"> actually trying to</font>

453
00:16:10,280 --> 00:16:13,490
understand what's going<font color="#CCCCCC"> on with your</font>

454
00:16:11,540 --> 00:16:18,230
<font color="#E5E5E5">email so it may raise a red flag on your</font>

455
00:16:13,490 --> 00:16:20,450
<font color="#CCCCCC">site as you</font><font color="#E5E5E5"> can see here the email that</font>

456
00:16:18,230 --> 00:16:21,890
<font color="#E5E5E5">the URL format is a bit complex and it</font>

457
00:16:20,450 --> 00:16:23,690
tend to<font color="#E5E5E5"> be corporate because most of</font>

458
00:16:21,890 --> 00:16:27,260
these<font color="#CCCCCC"> third-party actually have super</font>

459
00:16:23,690 --> 00:16:30,920
impossible URL schemes so I<font color="#E5E5E5"> personally</font>

460
00:16:27,260 --> 00:16:33,230
use right engine mod rewrite engine to

461
00:16:30,920 --> 00:16:35,030
simply<font color="#E5E5E5"> create whatever link I want so</font>

462
00:16:33,230 --> 00:16:37,250
this is a perfect example<font color="#E5E5E5"> of a rule</font><font color="#CCCCCC"> that</font>

463
00:16:35,030 --> 00:16:39,290
I use which basically doesn't<font color="#E5E5E5"> matter</font>

464
00:16:37,250 --> 00:16:41,210
what you put<font color="#CCCCCC"> in the URL are just always</font>

465
00:16:39,290 --> 00:16:42,650
<font color="#CCCCCC">going to redirect</font><font color="#E5E5E5"> to index</font><font color="#CCCCCC"> out PHP so</font>

466
00:16:41,210 --> 00:16:44,930
you can be as<font color="#E5E5E5"> creative</font><font color="#CCCCCC"> if</font><font color="#E5E5E5"> you want</font>

467
00:16:42,650 --> 00:16:47,420
sometimes I'm<font color="#E5E5E5"> even enjoying myself by</font>

468
00:16:44,930 --> 00:16:49,640
just<font color="#E5E5E5"> hiding like aspx extension</font><font color="#CCCCCC"> even if</font>

469
00:16:47,420 --> 00:16:52,219
it's a PHP<font color="#E5E5E5"> server but it's I don't know</font>

470
00:16:49,640 --> 00:16:54,800
<font color="#E5E5E5">H aspx sounds more corporate to me than</font>

471
00:16:52,220 --> 00:16:56,840
PHP most of the time so it may actually

472
00:16:54,800 --> 00:16:59,120
convince<font color="#E5E5E5"> people like the devil is in the</font>

473
00:16:56,840 --> 00:17:01,160
details<font color="#CCCCCC"> it</font><font color="#E5E5E5"> says right so this is a</font>

474
00:16:59,120 --> 00:17:03,830
perfect example<font color="#CCCCCC"> of like making corporate</font>

475
00:17:01,160 --> 00:17:05,959
URL rule number<font color="#E5E5E5"> two</font>

476
00:17:03,830 --> 00:17:08,500
as I told<font color="#E5E5E5"> you don't allow a medic tool</font>

477
00:17:05,959 --> 00:17:11,030
to<font color="#CCCCCC"> actually fetch your final payload</font>

478
00:17:08,500 --> 00:17:12,890
<font color="#CCCCCC">this is a trick that I love a lot I</font>

479
00:17:11,030 --> 00:17:15,770
<font color="#E5E5E5">basically generate the link using</font>

480
00:17:12,890 --> 00:17:17,270
<font color="#CCCCCC">JavaScript simple as that because</font><font color="#E5E5E5"> 99% of</font>

481
00:17:15,770 --> 00:17:20,150
those product don't<font color="#E5E5E5"> actually parse</font>

482
00:17:17,270 --> 00:17:22,160
<font color="#E5E5E5">JavaScript so this is a typical</font><font color="#CCCCCC"> website</font>

483
00:17:20,150 --> 00:17:24,470
<font color="#CCCCCC">so</font><font color="#E5E5E5"> you have your link that point to this</font>

484
00:17:22,160 --> 00:17:27,470
website and the<font color="#CCCCCC"> website have a link to</font>

485
00:17:24,470 --> 00:17:30,170
<font color="#E5E5E5">this shady word enable macro document</font>

486
00:17:27,470 --> 00:17:31,760
<font color="#E5E5E5">and you just click on it</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> most of the</font>

487
00:17:30,170 --> 00:17:34,040
<font color="#E5E5E5">the tools actually</font><font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> parse the HTML</font>

488
00:17:31,760 --> 00:17:34,610
and found the link<font color="#E5E5E5"> and</font><font color="#CCCCCC"> actually get</font><font color="#E5E5E5"> to</font>

489
00:17:34,040 --> 00:17:36,080
the<font color="#E5E5E5"> payload</font>

490
00:17:34,610 --> 00:17:37,969
and they're gonna analyze it and

491
00:17:36,080 --> 00:17:39,620
potentially<font color="#CCCCCC"> maybe detect you</font><font color="#E5E5E5"> so if</font>

492
00:17:37,970 --> 00:17:41,630
there's a<font color="#CCCCCC"> way to actually hide</font><font color="#E5E5E5"> this URL</font>

493
00:17:39,620 --> 00:17:43,580
why not doing it<font color="#E5E5E5"> and JavaScript is</font>

494
00:17:41,630 --> 00:17:45,830
exactly the tools that<font color="#E5E5E5"> you need you</font>

495
00:17:43,580 --> 00:17:48,049
basically create the<font color="#E5E5E5"> link which</font><font color="#CCCCCC"> is an</font>

496
00:17:45,830 --> 00:17:49,370
empty link so when they're gonna crawl

497
00:17:48,049 --> 00:17:50,720
the website<font color="#CCCCCC"> they're not gonna find</font>

498
00:17:49,370 --> 00:17:52,219
anything<font color="#CCCCCC"> and they're just</font><font color="#E5E5E5"> gonna forget</font>

499
00:17:50,720 --> 00:17:54,049
<font color="#E5E5E5">about this thing and says yeah there's</font>

500
00:17:52,220 --> 00:17:56,210
<font color="#E5E5E5">nothing shady here that's a perfectly</font>

501
00:17:54,049 --> 00:17:57,770
<font color="#E5E5E5">fine</font><font color="#CCCCCC"> website however you have your</font>

502
00:17:56,210 --> 00:18:01,150
little<font color="#E5E5E5"> piece of JavaScript at the end</font>

503
00:17:57,770 --> 00:18:04,129
that basically create<font color="#E5E5E5"> the location and</font>

504
00:18:01,150 --> 00:18:06,230
actually<font color="#CCCCCC"> filled the URL for you and</font>

505
00:18:04,130 --> 00:18:08,210
<font color="#E5E5E5">bonus point in this case as you</font><font color="#CCCCCC"> can see</font>

506
00:18:06,230 --> 00:18:10,580
the last line<font color="#E5E5E5"> I'm gonna force the click</font>

507
00:18:08,210 --> 00:18:12,470
<font color="#E5E5E5">and</font><font color="#CCCCCC"> phishing is always about the user</font>

508
00:18:10,580 --> 00:18:14,750
interaction<font color="#CCCCCC"> if your user enjoyed the</font>

509
00:18:12,470 --> 00:18:16,429
<font color="#CCCCCC">experience is gonna most likely</font><font color="#E5E5E5"> follow</font>

510
00:18:14,750 --> 00:18:18,260
through the path so if you force the

511
00:18:16,429 --> 00:18:19,880
download pop up<font color="#E5E5E5"> for him it's even better</font>

512
00:18:18,260 --> 00:18:21,590
right it<font color="#E5E5E5"> doesn't even have to click</font><font color="#CCCCCC"> on</font>

513
00:18:19,880 --> 00:18:22,790
the link so there's much more<font color="#E5E5E5"> chance</font>

514
00:18:21,590 --> 00:18:25,070
<font color="#CCCCCC">that he's actually gonna click</font><font color="#E5E5E5"> and</font>

515
00:18:22,790 --> 00:18:27,230
download<font color="#CCCCCC"> it so by doing</font><font color="#E5E5E5"> the click action</font>

516
00:18:25,070 --> 00:18:28,220
<font color="#CCCCCC">you're just gonna</font><font color="#E5E5E5"> fetch the page and</font>

517
00:18:27,230 --> 00:18:29,960
<font color="#E5E5E5">you're gonna be prompted with</font><font color="#CCCCCC"> the</font>

518
00:18:28,220 --> 00:18:33,020
<font color="#E5E5E5">downloads so that's</font><font color="#CCCCCC"> perfect right</font><font color="#E5E5E5"> that's</font>

519
00:18:29,960 --> 00:18:35,030
<font color="#E5E5E5">convenient</font><font color="#CCCCCC"> and sandbox not gonna be able</font>

520
00:18:33,020 --> 00:18:40,750
<font color="#E5E5E5">to</font><font color="#CCCCCC"> see that because</font><font color="#E5E5E5"> it's JavaScript</font>

521
00:18:35,030 --> 00:18:43,668
generated link use categorize the man

522
00:18:40,750 --> 00:18:45,860
<font color="#E5E5E5">fairly simple there's a bunch of website</font>

523
00:18:43,669 --> 00:18:48,350
are already categorized personally<font color="#E5E5E5"> I</font>

524
00:18:45,860 --> 00:18:50,689
used this little this<font color="#CCCCCC"> little tool which</font>

525
00:18:48,350 --> 00:18:52,580
is like a<font color="#E5E5E5"> four liner of bash we just</font>

526
00:18:50,690 --> 00:18:55,130
clone a website and change the base so I

527
00:18:52,580 --> 00:18:56,780
can<font color="#E5E5E5"> clone a website which is an exact</font>

528
00:18:55,130 --> 00:18:58,730
copy<font color="#CCCCCC"> of the</font><font color="#E5E5E5"> original one and send it to</font>

529
00:18:56,780 --> 00:19:00,980
<font color="#CCCCCC">categorize ur such as like blue code</font>

530
00:18:58,730 --> 00:19:03,320
which<font color="#E5E5E5"> is actually now</font><font color="#CCCCCC"> semantic and bunch</font>

531
00:19:00,980 --> 00:19:04,970
of<font color="#E5E5E5"> other company so they're just gonna</font>

532
00:19:03,320 --> 00:19:07,100
categorize you the man because it's a

533
00:19:04,970 --> 00:19:08,510
legitimate<font color="#E5E5E5"> well-known domain after</font><font color="#CCCCCC"> right</font>

534
00:19:07,100 --> 00:19:10,639
you're good to<font color="#CCCCCC"> go</font><font color="#E5E5E5"> and you</font><font color="#CCCCCC"> can use</font><font color="#E5E5E5"> this</font>

535
00:19:08,510 --> 00:19:14,450
domain for<font color="#CCCCCC"> phishing or for</font><font color="#E5E5E5"> you see to</font>

536
00:19:10,640 --> 00:19:17,330
connection you can<font color="#CCCCCC"> also on but for</font>

537
00:19:14,450 --> 00:19:19,970
expired domain if you're lazy<font color="#E5E5E5"> like like</font>

538
00:19:17,330 --> 00:19:21,409
me so I just<font color="#CCCCCC"> wrote this</font><font color="#E5E5E5"> little tool</font>

539
00:19:19,970 --> 00:19:23,299
couple of years<font color="#CCCCCC"> ago which goes on</font>

540
00:19:21,410 --> 00:19:25,280
expired domain and you<font color="#E5E5E5"> just give a</font>

541
00:19:23,299 --> 00:19:27,620
keyword<font color="#E5E5E5"> it's</font><font color="#CCCCCC"> gonna list bunch of domain</font>

542
00:19:25,280 --> 00:19:29,899
that<font color="#E5E5E5"> are actually expired</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> you can</font>

543
00:19:27,620 --> 00:19:31,639
buy them if they're<font color="#CCCCCC"> available</font><font color="#E5E5E5"> so you</font><font color="#CCCCCC"> can</font>

544
00:19:29,900 --> 00:19:33,620
find<font color="#E5E5E5"> already categorized the man and</font>

545
00:19:31,640 --> 00:19:35,690
that's another thing<font color="#CCCCCC"> this there's some</font>

546
00:19:33,620 --> 00:19:37,100
some product<font color="#CCCCCC"> it's security product</font>

547
00:19:35,690 --> 00:19:39,110
company they're actually gonna look at

548
00:19:37,100 --> 00:19:41,270
the date<font color="#CCCCCC"> of registration so if this</font>

549
00:19:39,110 --> 00:19:42,770
demand was there<font color="#E5E5E5"> forever</font><font color="#CCCCCC"> you may</font>

550
00:19:41,270 --> 00:19:43,850
actually<font color="#E5E5E5"> bypass this check and they're</font>

551
00:19:42,770 --> 00:19:45,410
gonna say oh yeah<font color="#E5E5E5"> this demand has been</font>

552
00:19:43,850 --> 00:19:47,418
<font color="#E5E5E5">around for like</font><font color="#CCCCCC"> ten</font><font color="#E5E5E5"> years so it's</font>

553
00:19:45,410 --> 00:19:48,200
probably safe<font color="#E5E5E5"> because</font><font color="#CCCCCC"> if you</font><font color="#E5E5E5"> just boil</font>

554
00:19:47,419 --> 00:19:49,730
them<font color="#E5E5E5"> into the</font>

555
00:19:48,200 --> 00:19:51,139
<font color="#CCCCCC">go</font><font color="#E5E5E5"> register it and they see it in their</font>

556
00:19:49,730 --> 00:19:52,820
<font color="#E5E5E5">net or they're gonna put</font><font color="#CCCCCC"> a red flag on</font>

557
00:19:51,139 --> 00:19:55,070
<font color="#CCCCCC">it</font><font color="#E5E5E5"> site this domain is fresh it's</font>

558
00:19:52,820 --> 00:19:57,408
freshly registrated<font color="#CCCCCC"> it may be shady</font>

559
00:19:55,070 --> 00:19:58,689
right<font color="#E5E5E5"> so this approach can</font><font color="#CCCCCC"> help you with</font>

560
00:19:57,409 --> 00:20:01,730
<font color="#E5E5E5">that too</font>

561
00:19:58,690 --> 00:20:04,539
rule number four use<font color="#E5E5E5"> HTTPS what if valid</font>

562
00:20:01,730 --> 00:20:07,610
certificate<font color="#CCCCCC"> let's encrypt is free right</font>

563
00:20:04,539 --> 00:20:09,769
<font color="#CCCCCC">now</font><font color="#E5E5E5"> unfortunately not the whole web is</font>

564
00:20:07,610 --> 00:20:11,928
actually<font color="#E5E5E5"> using this but I'm pretty sure</font>

565
00:20:09,769 --> 00:20:13,250
over time<font color="#E5E5E5"> most of the internet</font><font color="#CCCCCC"> probably</font>

566
00:20:11,929 --> 00:20:15,380
gonna use let's encrypt because it's

567
00:20:13,250 --> 00:20:17,210
free<font color="#E5E5E5"> so right now I've seen some company</font>

568
00:20:15,380 --> 00:20:18,710
<font color="#CCCCCC">that actually</font><font color="#E5E5E5"> put a red flag when it's</font>

569
00:20:17,210 --> 00:20:20,330
less<font color="#E5E5E5"> time crypt because they know it's</font>

570
00:20:18,710 --> 00:20:22,610
free<font color="#E5E5E5"> and a lot</font><font color="#CCCCCC"> of bad guys</font><font color="#E5E5E5"> are</font><font color="#CCCCCC"> actually</font>

571
00:20:20,330 --> 00:20:24,320
using it<font color="#E5E5E5"> well in the</font><font color="#CCCCCC"> future I'm pretty</font>

572
00:20:22,610 --> 00:20:25,729
sure that the most<font color="#E5E5E5"> of the</font><font color="#CCCCCC"> company gonna</font>

573
00:20:24,320 --> 00:20:27,139
rely on the let's encrypt<font color="#E5E5E5"> so you're</font><font color="#CCCCCC"> just</font>

574
00:20:25,730 --> 00:20:29,299
<font color="#E5E5E5">gonna be another guy with let's encrypt</font>

575
00:20:27,139 --> 00:20:31,039
but you can also afford<font color="#E5E5E5"> a a paid</font>

576
00:20:29,299 --> 00:20:33,559
certificate<font color="#E5E5E5"> with like your rapid as a</font>

577
00:20:31,039 --> 00:20:35,389
cell<font color="#E5E5E5"> or all of the other providers and</font>

578
00:20:33,559 --> 00:20:37,100
bonus<font color="#CCCCCC"> points for let's encrypt you don't</font>

579
00:20:35,389 --> 00:20:38,570
even<font color="#E5E5E5"> have to validate yourself</font><font color="#CCCCCC"> I should</font>

580
00:20:37,100 --> 00:20:39,620
<font color="#CCCCCC">go with corporate solution</font><font color="#E5E5E5"> for</font>

581
00:20:38,570 --> 00:20:41,360
certificate they're gonna ask you a

582
00:20:39,620 --> 00:20:43,279
<font color="#CCCCCC">bunch of information and I don't</font><font color="#E5E5E5"> like</font>

583
00:20:41,360 --> 00:20:45,709
lying on the internet so I feel like

584
00:20:43,279 --> 00:20:47,799
<font color="#E5E5E5">providing for fake information is not</font>

585
00:20:45,710 --> 00:20:50,690
something is really<font color="#E5E5E5"> good</font>

586
00:20:47,799 --> 00:20:53,090
number five<font color="#E5E5E5"> being boring as</font><font color="#CCCCCC"> possible</font>

587
00:20:50,690 --> 00:20:55,580
<font color="#E5E5E5">again I said</font><font color="#CCCCCC"> discussed earlier</font><font color="#E5E5E5"> if</font><font color="#CCCCCC"> you're</font>

588
00:20:53,090 --> 00:20:57,649
if<font color="#E5E5E5"> your client have expectation</font><font color="#CCCCCC"> they're</font>

589
00:20:55,580 --> 00:20:59,809
most<font color="#E5E5E5"> likely gonna reread the email again</font>

590
00:20:57,649 --> 00:21:01,580
<font color="#E5E5E5">and remember last time yeah you have an</font>

591
00:20:59,809 --> 00:21:02,928
<font color="#CCCCCC">email so yeah you got this fifty percent</font>

592
00:21:01,580 --> 00:21:04,908
<font color="#E5E5E5">discount</font><font color="#CCCCCC"> I'm pretty sure that most of</font>

593
00:21:02,929 --> 00:21:06,500
you<font color="#E5E5E5"> look at the URL and sign that maybe</font>

594
00:21:04,909 --> 00:21:08,419
<font color="#CCCCCC">fishier</font><font color="#E5E5E5"> that some things we're like</font>

595
00:21:06,500 --> 00:21:10,460
there are framing money or discount on

596
00:21:08,419 --> 00:21:12,710
something<font color="#E5E5E5"> why is</font><font color="#CCCCCC"> it a phishing campaign</font>

597
00:21:10,460 --> 00:21:14,539
but if I<font color="#E5E5E5"> send you this good</font><font color="#CCCCCC"> old egg can</font>

598
00:21:12,710 --> 00:21:17,419
you please complete<font color="#CCCCCC"> your timesheet</font>

599
00:21:14,539 --> 00:21:18,830
you're like one month you and you didn't

600
00:21:17,419 --> 00:21:22,460
fill your timesheet please just do it

601
00:21:18,830 --> 00:21:23,689
<font color="#CCCCCC">and log into the the interfaces</font><font color="#E5E5E5"> you're</font>

602
00:21:22,460 --> 00:21:25,159
gonna hate<font color="#CCCCCC"> it but you're still</font><font color="#E5E5E5"> gonna do</font>

603
00:21:23,690 --> 00:21:27,440
it<font color="#CCCCCC"> because it's corporate right and you</font>

604
00:21:25,159 --> 00:21:30,710
want to be a good employee<font color="#CCCCCC"> so that's a</font>

605
00:21:27,440 --> 00:21:32,210
perfect<font color="#CCCCCC"> example of boring phishing</font>

606
00:21:30,710 --> 00:21:34,519
campaign<font color="#E5E5E5"> and personally I had better</font>

607
00:21:32,210 --> 00:21:36,169
<font color="#E5E5E5">success with boring</font><font color="#CCCCCC"> campaigns and like</font>

608
00:21:34,519 --> 00:21:37,760
those super cool campaign where you're

609
00:21:36,169 --> 00:21:41,779
gonna<font color="#E5E5E5"> get everything you want if you</font>

610
00:21:37,760 --> 00:21:44,570
subscribe<font color="#CCCCCC"> there typosquatting like for</font>

611
00:21:41,779 --> 00:21:47,630
example<font color="#CCCCCC"> north sex dot io vs North seg</font>

612
00:21:44,570 --> 00:21:49,789
Canadian event<font color="#CCCCCC"> calm right if you look at</font>

613
00:21:47,630 --> 00:21:51,500
it real<font color="#E5E5E5"> fast</font><font color="#CCCCCC"> it kind of look legitimate</font>

614
00:21:49,789 --> 00:21:53,658
it may be a real domain<font color="#CCCCCC"> but if you're</font>

615
00:21:51,500 --> 00:21:55,610
<font color="#E5E5E5">taking a look at it it's obviously a</font>

616
00:21:53,659 --> 00:21:58,970
typo<font color="#E5E5E5"> squatting because we're not a</font><font color="#CCCCCC"> Nord</font>

617
00:21:55,610 --> 00:22:01,219
sex event where North's<font color="#CCCCCC"> sick but if you</font>

618
00:21:58,970 --> 00:22:01,700
look at North<font color="#CCCCCC"> seg Canadian event</font><font color="#E5E5E5"> calm it</font>

619
00:22:01,220 --> 00:22:04,070
looks

620
00:22:01,700 --> 00:22:06,230
more legitimate<font color="#E5E5E5"> right it's probably just</font>

621
00:22:04,070 --> 00:22:07,908
a Canadian website<font color="#E5E5E5"> that have a list of</font>

622
00:22:06,230 --> 00:22:10,100
all the Canadian<font color="#CCCCCC"> event for example we</font>

623
00:22:07,909 --> 00:22:11,690
<font color="#E5E5E5">don't know it sounds legitimate and</font><font color="#CCCCCC"> Nord</font>

624
00:22:10,100 --> 00:22:13,219
<font color="#E5E5E5">sake is spelled correctly which is</font>

625
00:22:11,690 --> 00:22:15,470
<font color="#E5E5E5">another good thing because this</font><font color="#CCCCCC"> is what</font>

626
00:22:13,220 --> 00:22:17,440
<font color="#CCCCCC">we</font><font color="#E5E5E5"> were used to and if you look at third</font>

627
00:22:15,470 --> 00:22:20,179
<font color="#CCCCCC">party</font><font color="#E5E5E5"> for example</font><font color="#CCCCCC"> you'll</font><font color="#E5E5E5"> see just</font>

628
00:22:17,440 --> 00:22:22,010
<font color="#E5E5E5">tomorrow on Monday when you get back to</font>

629
00:22:20,179 --> 00:22:24,200
Jeff<font color="#E5E5E5"> look at your job look how many</font>

630
00:22:22,010 --> 00:22:26,090
<font color="#CCCCCC">different subdomain you're using</font><font color="#E5E5E5"> they're</font>

631
00:22:24,200 --> 00:22:28,309
not even related<font color="#E5E5E5"> to your</font><font color="#CCCCCC"> company you'll</font>

632
00:22:26,090 --> 00:22:30,049
be<font color="#E5E5E5"> actually pretty impressed by</font><font color="#CCCCCC"> how many</font>

633
00:22:28,309 --> 00:22:33,500
subdomain you're gonna see that<font color="#CCCCCC"> are not</font>

634
00:22:30,049 --> 00:22:35,330
<font color="#CCCCCC">even related</font><font color="#E5E5E5"> to you number</font><font color="#CCCCCC"> seven</font>

635
00:22:33,500 --> 00:22:37,429
don't reuse your demand<font color="#E5E5E5"> for</font><font color="#CCCCCC"> our</font><font color="#E5E5E5"> project</font>

636
00:22:35,330 --> 00:22:39,260
<font color="#E5E5E5">your</font><font color="#CCCCCC"> payroll my ended up on virustotal</font>

637
00:22:37,429 --> 00:22:40,970
<font color="#CCCCCC">because some of</font><font color="#E5E5E5"> your client may detect</font>

638
00:22:39,260 --> 00:22:42,679
you you<font color="#E5E5E5"> never know and</font><font color="#CCCCCC"> you may actually</font>

639
00:22:40,970 --> 00:22:44,899
<font color="#E5E5E5">leak other</font><font color="#CCCCCC"> client information especially</font>

640
00:22:42,679 --> 00:22:47,510
<font color="#CCCCCC">if you're using your client name as a</font>

641
00:22:44,899 --> 00:22:48,439
subdomain<font color="#E5E5E5"> so they may found</font><font color="#CCCCCC"> DNS</font><font color="#E5E5E5"> records</font>

642
00:22:47,510 --> 00:22:49,940
and stuff like that which is<font color="#E5E5E5"> not</font>

643
00:22:48,440 --> 00:22:52,419
<font color="#CCCCCC">something that you want</font><font color="#E5E5E5"> because you</font><font color="#CCCCCC"> want</font>

644
00:22:49,940 --> 00:22:55,789
<font color="#CCCCCC">to be transparent about that</font><font color="#E5E5E5"> obviously</font>

645
00:22:52,419 --> 00:22:57,470
payload so at<font color="#E5E5E5"> that point we we prepare a</font>

646
00:22:55,789 --> 00:23:00,350
phishing campaign we're ready to send a

647
00:22:57,470 --> 00:23:04,269
payload<font color="#CCCCCC"> to our victim so I'm just gonna</font>

648
00:23:00,350 --> 00:23:04,269
take<font color="#CCCCCC"> a sip</font><font color="#E5E5E5"> of water</font><font color="#CCCCCC"> before the</font><font color="#E5E5E5"> pillow</font>

649
00:23:06,930 --> 00:23:11,340
so the<font color="#E5E5E5"> phishing campaign is almost ready</font>

650
00:23:09,330 --> 00:23:13,889
<font color="#E5E5E5">we just</font><font color="#CCCCCC"> need to put a payload inside of</font>

651
00:23:11,340 --> 00:23:17,189
<font color="#CCCCCC">a fishing camping</font>

652
00:23:13,890 --> 00:23:19,290
nowaday there is a classic approach<font color="#CCCCCC"> act</font>

653
00:23:17,190 --> 00:23:20,910
differently<font color="#E5E5E5"> if you're in front of a</font>

654
00:23:19,290 --> 00:23:22,409
security<font color="#E5E5E5"> product which is basically</font>

655
00:23:20,910 --> 00:23:24,810
evading<font color="#CCCCCC"> sandboxes</font>

656
00:23:22,410 --> 00:23:26,370
but the<font color="#CCCCCC"> riser was</font><font color="#E5E5E5"> not necessarily an</font>

657
00:23:24,810 --> 00:23:29,250
efficient model so they moved to

658
00:23:26,370 --> 00:23:31,979
<font color="#CCCCCC">endpoint solution right</font><font color="#E5E5E5"> so your client</font>

659
00:23:29,250 --> 00:23:33,330
is actually<font color="#E5E5E5"> the</font><font color="#CCCCCC"> sandbox itself</font><font color="#E5E5E5"> but we</font>

660
00:23:31,980 --> 00:23:36,030
still found a lot<font color="#E5E5E5"> of client actually</font>

661
00:23:33,330 --> 00:23:38,159
<font color="#E5E5E5">have like</font><font color="#CCCCCC"> inline sandbox so if you can</font>

662
00:23:36,030 --> 00:23:39,840
just stop<font color="#E5E5E5"> the execution on those sandbox</font>

663
00:23:38,160 --> 00:23:41,460
you're good to go<font color="#CCCCCC"> but there's also a</font>

664
00:23:39,840 --> 00:23:43,280
<font color="#E5E5E5">couple of</font><font color="#CCCCCC"> little trick that you</font><font color="#E5E5E5"> can</font><font color="#CCCCCC"> use</font>

665
00:23:41,460 --> 00:23:45,690
on<font color="#E5E5E5"> the</font><font color="#CCCCCC"> endpoint to</font><font color="#E5E5E5"> kind of defeat the</font>

666
00:23:43,280 --> 00:23:47,940
<font color="#CCCCCC">detection so I'll cover some of the</font>

667
00:23:45,690 --> 00:23:51,030
example that<font color="#E5E5E5"> I actually personally do</font>

668
00:23:47,940 --> 00:23:53,010
when I do<font color="#E5E5E5"> fishing camping</font><font color="#CCCCCC"> just to be</font>

669
00:23:51,030 --> 00:23:55,920
<font color="#E5E5E5">clear I'm gonna define my definition of</font>

670
00:23:53,010 --> 00:23:57,900
<font color="#CCCCCC">association in evasion if you look at</font>

671
00:23:55,920 --> 00:23:59,610
the variable equals<font color="#E5E5E5"> three is the</font>

672
00:23:57,900 --> 00:24:01,890
original code right<font color="#E5E5E5"> the concept of a</font>

673
00:23:59,610 --> 00:24:04,169
skating code is to<font color="#CCCCCC"> actually have the</font>

674
00:24:01,890 --> 00:24:06,060
same result but<font color="#E5E5E5"> written differently so</font>

675
00:24:04,170 --> 00:24:08,250
instead<font color="#E5E5E5"> of just putting three I'm gonna</font>

676
00:24:06,060 --> 00:24:11,129
<font color="#E5E5E5">obfuscate it and change it to 1 plus 2</font>

677
00:24:08,250 --> 00:24:12,960
so the result<font color="#CCCCCC"> is the same</font><font color="#E5E5E5"> but if they're</font>

678
00:24:11,130 --> 00:24:14,640
<font color="#E5E5E5">performing static analysis and</font><font color="#CCCCCC"> they're</font>

679
00:24:12,960 --> 00:24:16,380
looking<font color="#E5E5E5"> for the mouse just</font><font color="#CCCCCC"> 3 in this</font>

680
00:24:14,640 --> 00:24:18,420
<font color="#E5E5E5">case</font><font color="#CCCCCC"> they're not gonna see the 3 right</font>

681
00:24:16,380 --> 00:24:20,880
that's the idea<font color="#CCCCCC"> if you're doing evasion</font>

682
00:24:18,420 --> 00:24:23,130
<font color="#CCCCCC">you're gonna use specific condition to</font>

683
00:24:20,880 --> 00:24:25,320
actually act differently so in this case

684
00:24:23,130 --> 00:24:27,540
let's<font color="#E5E5E5"> say if context equals sandbox</font>

685
00:24:25,320 --> 00:24:30,960
so we're fingerprinting the<font color="#CCCCCC"> sangs but in</font>

686
00:24:27,540 --> 00:24:33,629
<font color="#E5E5E5">this certain way</font><font color="#CCCCCC"> ok fine you can do</font><font color="#E5E5E5"> 3 if</font>

687
00:24:30,960 --> 00:24:35,100
it's if it's not the case<font color="#E5E5E5"> just exit so</font>

688
00:24:33,630 --> 00:24:37,260
in this case the code never gonna run

689
00:24:35,100 --> 00:24:38,520
and most sandbox<font color="#E5E5E5"> will say yeah your code</font>

690
00:24:37,260 --> 00:24:42,990
is fine we didn't detect<font color="#E5E5E5"> anything</font>

691
00:24:38,520 --> 00:24:45,720
suspicious<font color="#CCCCCC"> being</font><font color="#E5E5E5"> trendy</font><font color="#CCCCCC"> it's not</font>

692
00:24:42,990 --> 00:24:47,400
necessarily a<font color="#E5E5E5"> good thing for you</font><font color="#CCCCCC"> guys</font>

693
00:24:45,720 --> 00:24:49,230
<font color="#E5E5E5">that do</font><font color="#CCCCCC"> Red Team</font><font color="#E5E5E5"> you're probably mostly</font>

694
00:24:47,400 --> 00:24:50,760
using<font color="#CCCCCC"> powershell script nowaday</font><font color="#E5E5E5"> because</font>

695
00:24:49,230 --> 00:24:52,230
it's<font color="#E5E5E5"> the new cool thing but if you</font>

696
00:24:50,760 --> 00:24:54,930
remember<font color="#CCCCCC"> a</font><font color="#E5E5E5"> couple of</font><font color="#CCCCCC"> years ago when we</font>

697
00:24:52,230 --> 00:24:56,880
<font color="#CCCCCC">used to</font><font color="#E5E5E5"> use</font><font color="#CCCCCC"> Metasploit</font><font color="#E5E5E5"> then all the the</font>

698
00:24:54,930 --> 00:24:58,830
Metasploit module that were mostly<font color="#CCCCCC"> inta</font>

699
00:24:56,880 --> 00:25:00,210
cutable and<font color="#E5E5E5"> dll we're still achieving</font>

700
00:24:58,830 --> 00:25:02,790
the same thing it's just<font color="#E5E5E5"> a</font><font color="#CCCCCC"> different way</font>

701
00:25:00,210 --> 00:25:05,610
but<font color="#E5E5E5"> vendor also followed the trend right</font>

702
00:25:02,790 --> 00:25:07,350
so right now most of<font color="#E5E5E5"> the detection or</font>

703
00:25:05,610 --> 00:25:09,120
based out of PowerShell they're working

704
00:25:07,350 --> 00:25:10,830
really<font color="#E5E5E5"> hard on detecting PowerShell as</font>

705
00:25:09,120 --> 00:25:13,409
much as they can<font color="#CCCCCC"> because that's every</font>

706
00:25:10,830 --> 00:25:14,610
that's<font color="#E5E5E5"> what people use now what was the</font>

707
00:25:13,410 --> 00:25:16,530
<font color="#E5E5E5">last time that you actually heard about</font>

708
00:25:14,610 --> 00:25:17,320
<font color="#E5E5E5">someone</font><font color="#CCCCCC"> so here's</font><font color="#E5E5E5"> the new cool detection</font>

709
00:25:16,530 --> 00:25:19,690
against buying

710
00:25:17,320 --> 00:25:22,210
<font color="#CCCCCC">they don't really</font><font color="#E5E5E5"> care because most</font>

711
00:25:19,690 --> 00:25:23,980
people move to<font color="#CCCCCC"> PowerShell</font><font color="#E5E5E5"> so if you have</font>

712
00:25:22,210 --> 00:25:25,630
if<font color="#E5E5E5"> you come up</font><font color="#CCCCCC"> with other ways of</font>

713
00:25:23,980 --> 00:25:27,370
<font color="#E5E5E5">actually executing</font><font color="#CCCCCC"> code and your</font><font color="#E5E5E5"> target</font>

714
00:25:25,630 --> 00:25:29,230
it may actually<font color="#E5E5E5"> be super good</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> you</font>

715
00:25:27,370 --> 00:25:33,429
because<font color="#E5E5E5"> the chance of being</font><font color="#CCCCCC"> detected are</font>

716
00:25:29,230 --> 00:25:35,440
a bit lower<font color="#CCCCCC"> so first of all virus</font><font color="#E5E5E5"> for</font>

717
00:25:33,430 --> 00:25:39,190
the payloads<font color="#E5E5E5"> don't run PowerShell</font>

718
00:25:35,440 --> 00:25:41,080
<font color="#CCCCCC">directly all the vendors gonna detect</font>

719
00:25:39,190 --> 00:25:42,520
you in a second<font color="#E5E5E5"> because they know that</font>

720
00:25:41,080 --> 00:25:44,169
<font color="#E5E5E5">you're gonna use PowerShell so the</font>

721
00:25:42,520 --> 00:25:45,879
minute that<font color="#E5E5E5"> you actually start</font><font color="#CCCCCC"> the</font>

722
00:25:44,170 --> 00:25:47,710
PowerShell process they're gonna detect

723
00:25:45,880 --> 00:25:50,290
you<font color="#E5E5E5"> they have different level of</font>

724
00:25:47,710 --> 00:25:51,940
detection<font color="#E5E5E5"> but there is a tool that I</font>

725
00:25:50,290 --> 00:25:54,100
wrote a<font color="#CCCCCC"> couple of years</font><font color="#E5E5E5"> ago which is</font>

726
00:25:51,940 --> 00:25:55,870
called powerless show<font color="#E5E5E5"> which is using a</font>

727
00:25:54,100 --> 00:25:59,230
<font color="#E5E5E5">technique that was well documented in</font>

728
00:25:55,870 --> 00:26:00,639
<font color="#E5E5E5">the past that used the that used C sharp</font>

729
00:25:59,230 --> 00:26:02,080
<font color="#CCCCCC">to actually create a run space</font>

730
00:26:00,640 --> 00:26:03,910
environment<font color="#CCCCCC"> and execute power shell</font>

731
00:26:02,080 --> 00:26:06,939
without<font color="#E5E5E5"> actually using</font><font color="#CCCCCC"> the PowerShell</font>

732
00:26:03,910 --> 00:26:09,280
like binary itself<font color="#E5E5E5"> so if you use that</font>

733
00:26:06,940 --> 00:26:12,310
you're<font color="#E5E5E5"> gonna run whatever PowerShell you</font>

734
00:26:09,280 --> 00:26:15,580
want without<font color="#E5E5E5"> having</font><font color="#CCCCCC"> to bother executing</font>

735
00:26:12,310 --> 00:26:18,760
the PowerShell PowerShell process itself

736
00:26:15,580 --> 00:26:20,649
if you're using macro for example<font color="#E5E5E5"> the</font>

737
00:26:18,760 --> 00:26:23,500
<font color="#CCCCCC">well-known technique is to rely on</font><font color="#E5E5E5"> W</font>

738
00:26:20,650 --> 00:26:26,230
<font color="#E5E5E5">script dot shell or the the function</font>

739
00:26:23,500 --> 00:26:28,660
<font color="#CCCCCC">called shell itself the big issue with</font>

740
00:26:26,230 --> 00:26:30,820
that is<font color="#CCCCCC"> Windward gonna actually spawn a</font>

741
00:26:28,660 --> 00:26:33,400
process<font color="#E5E5E5"> a child process that is</font><font color="#CCCCCC"> gonna be</font>

742
00:26:30,820 --> 00:26:34,780
like CMD or<font color="#E5E5E5"> whatever you run and most of</font>

743
00:26:33,400 --> 00:26:37,060
the system gonna detect<font color="#E5E5E5"> the child</font>

744
00:26:34,780 --> 00:26:39,370
process<font color="#CCCCCC"> of Windward which is not what</font>

745
00:26:37,060 --> 00:26:42,429
<font color="#CCCCCC">you want right the solution that I come</font>

746
00:26:39,370 --> 00:26:45,760
up with is use<font color="#E5E5E5"> W my through through win</font>

747
00:26:42,430 --> 00:26:47,680
<font color="#CCCCCC">exec so through your</font><font color="#E5E5E5"> macro sorry the</font>

748
00:26:45,760 --> 00:26:50,200
idea is your child process not gonna be

749
00:26:47,680 --> 00:26:53,260
tied to windward it's actually gonna<font color="#E5E5E5"> tie</font>

750
00:26:50,200 --> 00:26:55,030
to W my<font color="#E5E5E5"> SCP</font><font color="#CCCCCC"> our service which is</font>

751
00:26:53,260 --> 00:26:57,129
actually the<font color="#E5E5E5"> W my service so there is no</font>

752
00:26:55,030 --> 00:27:00,220
link between the execution of<font color="#E5E5E5"> your</font>

753
00:26:57,130 --> 00:27:02,410
<font color="#E5E5E5">payload and the word document itself</font><font color="#CCCCCC"> and</font>

754
00:27:00,220 --> 00:27:04,260
I have another tool for<font color="#CCCCCC"> that which is</font>

755
00:27:02,410 --> 00:27:06,580
<font color="#CCCCCC">Malchus macro generator that generates</font>

756
00:27:04,260 --> 00:27:08,200
<font color="#E5E5E5">terribly office</font><font color="#CCCCCC"> kated macro that</font><font color="#E5E5E5"> are</font>

757
00:27:06,580 --> 00:27:10,179
super useful when you<font color="#CCCCCC"> want to fish</font>

758
00:27:08,200 --> 00:27:12,730
people

759
00:27:10,180 --> 00:27:15,220
again<font color="#CCCCCC"> if you're planning to</font><font color="#E5E5E5"> use</font><font color="#CCCCCC"> sign</font>

760
00:27:12,730 --> 00:27:17,860
binary<font color="#E5E5E5"> be careful again because they all</font>

761
00:27:15,220 --> 00:27:19,870
know<font color="#CCCCCC"> about it is super trendy a</font><font color="#E5E5E5"> lot of</font>

762
00:27:17,860 --> 00:27:21,669
people discuss about<font color="#CCCCCC"> it on Twitter and</font>

763
00:27:19,870 --> 00:27:23,770
the post example so it's a matter<font color="#E5E5E5"> of</font>

764
00:27:21,670 --> 00:27:25,360
hours sometimes<font color="#E5E5E5"> before</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> vendor is</font>

765
00:27:23,770 --> 00:27:28,000
actually gonna have<font color="#CCCCCC"> the new rules for</font>

766
00:27:25,360 --> 00:27:29,590
<font color="#E5E5E5">those</font><font color="#CCCCCC"> well-known binary</font><font color="#E5E5E5"> like reggae r2d2</font>

767
00:27:28,000 --> 00:27:32,800
<font color="#CCCCCC">was a well-known binary where</font><font color="#E5E5E5"> you can</font>

768
00:27:29,590 --> 00:27:34,570
specify a<font color="#E5E5E5"> road to a comma object that</font>

769
00:27:32,800 --> 00:27:36,909
you<font color="#E5E5E5"> control and it's</font><font color="#CCCCCC"> gonna download it</font>

770
00:27:34,570 --> 00:27:40,000
and<font color="#CCCCCC"> execute it so you you're using like</font>

771
00:27:36,910 --> 00:27:43,930
<font color="#CCCCCC">the</font><font color="#E5E5E5"> white listed sign windows</font><font color="#CCCCCC"> binary to</font>

772
00:27:40,000 --> 00:27:46,000
actually run<font color="#CCCCCC"> your code right</font><font color="#E5E5E5"> however I</font>

773
00:27:43,930 --> 00:27:47,740
got some insight about<font color="#E5E5E5"> the fact that</font>

774
00:27:46,000 --> 00:27:50,200
some people<font color="#CCCCCC"> found a way to actually run</font>

775
00:27:47,740 --> 00:27:52,150
<font color="#E5E5E5">these binary and modify the code</font><font color="#CCCCCC"> but</font>

776
00:27:50,200 --> 00:27:55,030
they're gonna remind sign so actually

777
00:27:52,150 --> 00:27:58,000
wrote a little script<font color="#E5E5E5"> that modify the</font>

778
00:27:55,030 --> 00:27:59,649
hash of those<font color="#CCCCCC"> signed binary</font><font color="#E5E5E5"> but it's so</font>

779
00:27:58,000 --> 00:28:01,480
they're still gonna remain signed by

780
00:27:59,650 --> 00:28:03,490
<font color="#CCCCCC">Microsoft so even if you changed</font><font color="#E5E5E5"> the</font>

781
00:28:01,480 --> 00:28:04,930
data it's still<font color="#E5E5E5"> gonna remain sign so</font>

782
00:28:03,490 --> 00:28:07,090
it's<font color="#E5E5E5"> fairly interesting</font><font color="#CCCCCC"> because</font><font color="#E5E5E5"> you're</font>

783
00:28:04,930 --> 00:28:08,620
still signed so if your<font color="#E5E5E5"> endpoint</font>

784
00:28:07,090 --> 00:28:10,209
<font color="#E5E5E5">solution is black listing everything</font>

785
00:28:08,620 --> 00:28:11,919
<font color="#E5E5E5">that it's not signed by Microsoft you're</font>

786
00:28:10,210 --> 00:28:15,040
passing that check but<font color="#E5E5E5"> if they also look</font>

787
00:28:11,920 --> 00:28:17,080
at<font color="#CCCCCC"> the hash of</font><font color="#E5E5E5"> well known bad sign</font>

788
00:28:15,040 --> 00:28:19,450
binary you're also gonna pass this check

789
00:28:17,080 --> 00:28:22,030
so usually you can actually<font color="#E5E5E5"> execute your</font>

790
00:28:19,450 --> 00:28:24,130
code using this the<font color="#E5E5E5"> only downside is you</font>

791
00:28:22,030 --> 00:28:26,410
have to drop this<font color="#CCCCCC"> binary on the system</font>

792
00:28:24,130 --> 00:28:28,090
but it's still<font color="#E5E5E5"> something that you can do</font>

793
00:28:26,410 --> 00:28:29,830
so your first<font color="#E5E5E5"> stage can be</font><font color="#CCCCCC"> drop</font><font color="#E5E5E5"> this</font>

794
00:28:28,090 --> 00:28:31,360
<font color="#E5E5E5">sign binary that was modified like reg</font>

795
00:28:29,830 --> 00:28:33,520
<font color="#E5E5E5">as we are told you do for example so you</font>

796
00:28:31,360 --> 00:28:36,010
<font color="#CCCCCC">drop your modified version</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> reg as we</font>

797
00:28:33,520 --> 00:28:38,650
are 32<font color="#E5E5E5"> and you actually</font><font color="#CCCCCC"> run the same</font>

798
00:28:36,010 --> 00:28:41,740
type<font color="#CCCCCC"> of export</font><font color="#E5E5E5"> but with this slightly</font>

799
00:28:38,650 --> 00:28:45,190
modified version and they may<font color="#E5E5E5"> not detect</font>

800
00:28:41,740 --> 00:28:47,590
you another trick that work with some

801
00:28:45,190 --> 00:28:49,810
some product again they have different

802
00:28:47,590 --> 00:28:51,790
level of detection<font color="#E5E5E5"> just</font><font color="#CCCCCC"> rename</font><font color="#E5E5E5"> it</font>

803
00:28:49,810 --> 00:28:53,200
<font color="#E5E5E5">PowerShell dot exe to something random</font>

804
00:28:51,790 --> 00:28:55,149
some of them are<font color="#E5E5E5"> not</font><font color="#CCCCCC"> even bothering</font>

805
00:28:53,200 --> 00:28:56,260
<font color="#E5E5E5">looking at the the hash of the binary</font>

806
00:28:55,150 --> 00:28:58,570
<font color="#CCCCCC">that you're running they're just gonna</font>

807
00:28:56,260 --> 00:29:00,129
look at<font color="#E5E5E5"> the name so just rename it and</font>

808
00:28:58,570 --> 00:29:02,740
<font color="#E5E5E5">do your things and it's still gonna work</font>

809
00:29:00,130 --> 00:29:05,050
perfectly again<font color="#CCCCCC"> you can do it inside of</font>

810
00:29:02,740 --> 00:29:06,850
<font color="#E5E5E5">your macro because some software again</font>

811
00:29:05,050 --> 00:29:08,620
may actually detect that you're gonna

812
00:29:06,850 --> 00:29:10,480
run the command copy<font color="#E5E5E5"> PowerShell</font><font color="#CCCCCC"> and</font>

813
00:29:08,620 --> 00:29:12,489
rename it<font color="#E5E5E5"> so just do it inside of your</font>

814
00:29:10,480 --> 00:29:14,980
macro if you're using<font color="#E5E5E5"> macros your first</font>

815
00:29:12,490 --> 00:29:17,200
attack vector<font color="#E5E5E5"> it's fairly simple just</font>

816
00:29:14,980 --> 00:29:17,580
<font color="#E5E5E5">copy file source destination and you're</font>

817
00:29:17,200 --> 00:29:22,470
good

818
00:29:17,580 --> 00:29:25,889
to go you should always put<font color="#E5E5E5"> a condition</font>

819
00:29:22,470 --> 00:29:28,590
<font color="#CCCCCC">in your code to</font><font color="#E5E5E5"> evade sandbox you never</font>

820
00:29:25,890 --> 00:29:30,540
know<font color="#E5E5E5"> maybe even if your</font><font color="#CCCCCC"> OSN</font><font color="#E5E5E5"> didn't</font>

821
00:29:28,590 --> 00:29:32,760
reveal any specific<font color="#E5E5E5"> security product</font>

822
00:29:30,540 --> 00:29:34,200
<font color="#E5E5E5">just do it</font><font color="#CCCCCC"> it costs</font><font color="#E5E5E5"> nothing and it may</font>

823
00:29:32,760 --> 00:29:36,180
save<font color="#E5E5E5"> your</font><font color="#CCCCCC"> life</font>

824
00:29:34,200 --> 00:29:38,460
a perfect example when I use click once

825
00:29:36,180 --> 00:29:40,230
<font color="#E5E5E5">the way that click once work at the end</font>

826
00:29:38,460 --> 00:29:42,680
of the day it's just an executable but

827
00:29:40,230 --> 00:29:44,790
<font color="#E5E5E5">Microsoft come up with a super cool</font>

828
00:29:42,680 --> 00:29:47,190
<font color="#CCCCCC">user-friendly way of delivering them</font>

829
00:29:44,790 --> 00:29:48,720
through our internet<font color="#CCCCCC"> browser so</font><font color="#E5E5E5"> you</font>

830
00:29:47,190 --> 00:29:51,510
click<font color="#E5E5E5"> on the link and you</font><font color="#CCCCCC"> have this</font>

831
00:29:48,720 --> 00:29:53,670
super<font color="#E5E5E5"> like cool fancy</font><font color="#CCCCCC"> setup that just</font>

832
00:29:51,510 --> 00:29:55,260
starts so people feel<font color="#E5E5E5"> like I guess it's</font>

833
00:29:53,670 --> 00:29:58,680
more<font color="#E5E5E5"> safe that way right for whatever</font>

834
00:29:55,260 --> 00:30:00,570
reason but if your payroll is<font color="#E5E5E5"> fetch by a</font>

835
00:29:58,680 --> 00:30:01,920
<font color="#CCCCCC">security product they usually</font><font color="#E5E5E5"> just gonna</font>

836
00:30:00,570 --> 00:30:04,590
get the binary<font color="#CCCCCC"> and they're gonna run it</font>

837
00:30:01,920 --> 00:30:06,090
<font color="#E5E5E5">so an easy check for click once check if</font>

838
00:30:04,590 --> 00:30:07,980
<font color="#CCCCCC">Internet Explorer</font><font color="#E5E5E5"> is actually running</font>

839
00:30:06,090 --> 00:30:10,020
<font color="#CCCCCC">because if</font><font color="#E5E5E5"> there is a click once running</font>

840
00:30:07,980 --> 00:30:12,000
<font color="#E5E5E5">on the system and Internet Explorer is</font>

841
00:30:10,020 --> 00:30:13,530
not open<font color="#E5E5E5"> it's impossible like there's</font>

842
00:30:12,000 --> 00:30:15,120
something shady<font color="#E5E5E5"> going on you're probably</font>

843
00:30:13,530 --> 00:30:18,510
<font color="#E5E5E5">like in the sandbox or something like</font>

844
00:30:15,120 --> 00:30:20,639
<font color="#CCCCCC">that so in this case in c-sharp you can</font>

845
00:30:18,510 --> 00:30:22,650
just check<font color="#CCCCCC"> for the process and if if</font>

846
00:30:20,640 --> 00:30:24,810
it's the case if<font color="#CCCCCC"> Internet Explorer</font><font color="#E5E5E5"> is</font>

847
00:30:22,650 --> 00:30:27,030
running just you can be evil as much as

848
00:30:24,810 --> 00:30:28,379
you want after<font color="#CCCCCC"> that</font><font color="#E5E5E5"> again I have a tool</font>

849
00:30:27,030 --> 00:30:30,149
which is called<font color="#CCCCCC"> click once generator</font>

850
00:30:28,380 --> 00:30:32,370
that allow you to<font color="#CCCCCC"> generate those fancy</font>

851
00:30:30,150 --> 00:30:34,380
click once every officiated things and

852
00:30:32,370 --> 00:30:36,179
you have all the<font color="#E5E5E5"> option to actually</font>

853
00:30:34,380 --> 00:30:37,830
<font color="#CCCCCC">specify which kind of process you want</font>

854
00:30:36,180 --> 00:30:39,300
<font color="#CCCCCC">to look for another one</font><font color="#E5E5E5"> that is</font><font color="#CCCCCC"> really</font>

855
00:30:37,830 --> 00:30:40,590
interesting<font color="#CCCCCC"> to</font><font color="#E5E5E5"> look for its outlook</font>

856
00:30:39,300 --> 00:30:43,110
obviously if you know for a fact that

857
00:30:40,590 --> 00:30:44,790
<font color="#CCCCCC">using the five client so if someone's</font>

858
00:30:43,110 --> 00:30:47,219
<font color="#E5E5E5">actually reading you email it</font><font color="#CCCCCC"> and</font>

859
00:30:44,790 --> 00:30:51,389
outlook is<font color="#E5E5E5"> not open again it sounds a</font>

860
00:30:47,220 --> 00:30:52,980
bit shady to<font color="#CCCCCC"> me payload</font><font color="#E5E5E5"> again sometimes</font>

861
00:30:51,390 --> 00:30:54,480
you have issue and you're facing a

862
00:30:52,980 --> 00:30:55,800
specific client and you have to come up

863
00:30:54,480 --> 00:30:57,690
<font color="#E5E5E5">with</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> solution because you know that</font>

864
00:30:55,800 --> 00:31:00,720
they're<font color="#E5E5E5"> gonna detect this specific type</font>

865
00:30:57,690 --> 00:31:02,730
of<font color="#CCCCCC"> payload so sometimes times the time I</font>

866
00:31:00,720 --> 00:31:05,400
just<font color="#E5E5E5"> write tools to actually</font><font color="#CCCCCC"> try and</font>

867
00:31:02,730 --> 00:31:07,980
<font color="#E5E5E5">evade them so the first</font><font color="#CCCCCC"> one is for calm</font>

868
00:31:05,400 --> 00:31:11,570
<font color="#E5E5E5">scriptlet so SCT</font><font color="#CCCCCC"> fowl if you want to use</font>

869
00:31:07,980 --> 00:31:14,730
like<font color="#CCCCCC"> COBOL</font><font color="#E5E5E5"> strike or</font><font color="#CCCCCC"> Empire built in the</font>

870
00:31:11,570 --> 00:31:16,620
SCT file you<font color="#E5E5E5"> can just send the file</font>

871
00:31:14,730 --> 00:31:18,480
through<font color="#CCCCCC"> a CTF</font><font color="#E5E5E5"> ascator and it's just</font>

872
00:31:16,620 --> 00:31:20,159
gonna<font color="#E5E5E5"> make it a bit</font><font color="#CCCCCC"> more fiscally then</font>

873
00:31:18,480 --> 00:31:24,330
usually you're good to go

874
00:31:20,160 --> 00:31:27,180
<font color="#CCCCCC">uni B'Av is actually an exe</font><font color="#E5E5E5"> office</font><font color="#CCCCCC"> cater</font>

875
00:31:24,330 --> 00:31:29,439
<font color="#E5E5E5">after</font><font color="#CCCCCC"> Skater sorry</font><font color="#E5E5E5"> and it just takes</font>

876
00:31:27,180 --> 00:31:31,269
<font color="#E5E5E5">shell code and gonna generate a</font><font color="#CCCCCC"> Exe</font>

877
00:31:29,440 --> 00:31:32,559
<font color="#CCCCCC">that is heavily officiated and you</font>

878
00:31:31,269 --> 00:31:34,929
should be good<font color="#CCCCCC"> to go again I also</font>

879
00:31:32,559 --> 00:31:36,549
support<font color="#CCCCCC"> bunch</font><font color="#E5E5E5"> of evasion</font><font color="#CCCCCC"> modules so you</font>

880
00:31:34,929 --> 00:31:39,190
can actually<font color="#E5E5E5"> specify which module you</font>

881
00:31:36,549 --> 00:31:41,830
want<font color="#E5E5E5"> to use don't kill my cat</font><font color="#CCCCCC"> I</font>

882
00:31:39,190 --> 00:31:44,200
presented that<font color="#CCCCCC"> to last year nor it's</font>

883
00:31:41,830 --> 00:31:46,928
actually<font color="#E5E5E5"> it's relying on polyglot images</font>

884
00:31:44,200 --> 00:31:48,970
so it's a 100%<font color="#CCCCCC"> valid image</font><font color="#E5E5E5"> but it's also</font>

885
00:31:46,929 --> 00:31:51,220
a 100% valid<font color="#CCCCCC"> shellcode if you start</font><font color="#E5E5E5"> from</font>

886
00:31:48,970 --> 00:31:52,419
the first byte of<font color="#CCCCCC"> the</font><font color="#E5E5E5"> image so</font><font color="#CCCCCC"> over</font>

887
00:31:51,220 --> 00:31:55,299
network you're just gonna see in the

888
00:31:52,419 --> 00:31:56,649
<font color="#E5E5E5">image and most of the sandbox</font><font color="#CCCCCC"> product</font>

889
00:31:55,299 --> 00:31:58,029
don't really care about<font color="#E5E5E5"> an image right</font>

890
00:31:56,649 --> 00:32:00,370
because they<font color="#E5E5E5"> don't want to lost their</font>

891
00:31:58,029 --> 00:32:04,029
CPU cycle analyzing<font color="#E5E5E5"> a legitimate image</font>

892
00:32:00,370 --> 00:32:05,768
right for<font color="#CCCCCC"> PowerShell</font><font color="#E5E5E5"> there's my friend</font>

893
00:32:04,029 --> 00:32:07,360
<font color="#E5E5E5">is actually presenting at the</font><font color="#CCCCCC"> same time</font>

894
00:32:05,769 --> 00:32:09,309
from fire<font color="#CCCCCC"> right you roll invoke</font>

895
00:32:07,360 --> 00:32:12,129
efficient is actually presenting the

896
00:32:09,309 --> 00:32:15,158
<font color="#E5E5E5">sophistication as we speak</font><font color="#CCCCCC"> and this is a</font>

897
00:32:12,129 --> 00:32:17,529
heavy<font color="#CCCCCC"> framework</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> has efficient to</font>

898
00:32:15,159 --> 00:32:19,480
you<font color="#CCCCCC"> Yuko</font><font color="#E5E5E5"> but if you're using COBOL swag</font>

899
00:32:17,529 --> 00:32:21,100
or Empire you may realize that most<font color="#E5E5E5"> of</font>

900
00:32:19,480 --> 00:32:23,049
the time if you<font color="#CCCCCC"> have the one-liner it's</font>

901
00:32:21,100 --> 00:32:25,629
just<font color="#E5E5E5"> gonna be a one-liner</font><font color="#CCCCCC"> base64-encoded</font>

902
00:32:23,049 --> 00:32:27,580
<font color="#CCCCCC">right and most</font><font color="#E5E5E5"> of their product now they</font>

903
00:32:25,629 --> 00:32:29,439
actually fingerprint that specific<font color="#CCCCCC"> pad</font>

904
00:32:27,580 --> 00:32:32,168
so<font color="#E5E5E5"> I just wrote</font><font color="#CCCCCC"> a little simple tools</font>

905
00:32:29,440 --> 00:32:33,610
actually obfuscate the<font color="#CCCCCC"> base64 itself so</font>

906
00:32:32,169 --> 00:32:35,580
it's<font color="#CCCCCC"> more convenient</font><font color="#E5E5E5"> for this kind of</font>

907
00:32:33,610 --> 00:32:38,529
specific tools but feel free<font color="#E5E5E5"> to just</font>

908
00:32:35,580 --> 00:32:39,820
take a look<font color="#E5E5E5"> at my github and just see</font>

909
00:32:38,529 --> 00:32:41,740
how<font color="#CCCCCC"> it works if you're interested</font><font color="#E5E5E5"> in</font>

910
00:32:39,820 --> 00:32:45,309
more<font color="#E5E5E5"> details</font><font color="#CCCCCC"> I can</font><font color="#E5E5E5"> provide you after the</font>

911
00:32:41,740 --> 00:32:46,720
presentation<font color="#E5E5E5"> problem with the sandbox</font>

912
00:32:45,309 --> 00:32:48,220
<font color="#E5E5E5">there</font><font color="#CCCCCC"> are fingerprint able and</font>

913
00:32:46,720 --> 00:32:50,169
predictable<font color="#E5E5E5"> right because you know for a</font>

914
00:32:48,220 --> 00:32:53,769
fact that this<font color="#CCCCCC"> is not a real</font><font color="#E5E5E5"> environment</font>

915
00:32:50,169 --> 00:32:55,419
this<font color="#CCCCCC"> is something that it's faking an</font>

916
00:32:53,769 --> 00:32:58,090
environment<font color="#E5E5E5"> and trying to see what's</font>

917
00:32:55,419 --> 00:32:59,200
going<font color="#E5E5E5"> on with your with your malware so</font>

918
00:32:58,090 --> 00:33:01,539
there's a lot of<font color="#E5E5E5"> trigger you can</font>

919
00:32:59,200 --> 00:33:04,570
<font color="#CCCCCC">actually use to prevent your code to run</font>

920
00:33:01,539 --> 00:33:07,570
on<font color="#CCCCCC"> sandboxes for</font><font color="#E5E5E5"> example look at the</font>

921
00:33:04,570 --> 00:33:10,090
<font color="#E5E5E5">memory size if it's more</font><font color="#CCCCCC"> or less</font><font color="#E5E5E5"> than</font><font color="#CCCCCC"> 4</font>

922
00:33:07,570 --> 00:33:11,950
gig<font color="#E5E5E5"> you're probably not living in the</font>

923
00:33:10,090 --> 00:33:14,259
you're probably<font color="#E5E5E5"> living in the pacifist</font>

924
00:33:11,950 --> 00:33:17,350
<font color="#E5E5E5">less than 4 gigs or your sandbox</font><font color="#CCCCCC"> because</font>

925
00:33:14,259 --> 00:33:19,419
now they're<font color="#CCCCCC"> 4 gigs on a computer is it's</font>

926
00:33:17,350 --> 00:33:22,330
<font color="#E5E5E5">pretty legitimate same with the disk</font>

927
00:33:19,419 --> 00:33:23,649
size<font color="#E5E5E5"> if you</font><font color="#CCCCCC"> have less than 250 gigs of</font>

928
00:33:22,330 --> 00:33:25,029
this size you're probably not a

929
00:33:23,649 --> 00:33:27,399
<font color="#E5E5E5">legitimate computer you're just a</font>

930
00:33:25,029 --> 00:33:29,259
<font color="#E5E5E5">sandbox again there are some</font><font color="#CCCCCC"> sand</font><font color="#E5E5E5"> bugs</font>

931
00:33:27,399 --> 00:33:30,908
<font color="#E5E5E5">that have like that fake this</font>

932
00:33:29,259 --> 00:33:33,070
information but there's other way to

933
00:33:30,909 --> 00:33:35,740
look at<font color="#E5E5E5"> that you can also look at the</font>

934
00:33:33,070 --> 00:33:37,389
hook that they've created<font color="#E5E5E5"> number</font><font color="#CCCCCC"> of CPUs</font>

935
00:33:35,740 --> 00:33:39,250
same thing I<font color="#E5E5E5"> think that I don't even</font>

936
00:33:37,389 --> 00:33:41,320
<font color="#CCCCCC">know if</font><font color="#E5E5E5"> it's possible to buy a</font><font color="#CCCCCC"> single</font>

937
00:33:39,250 --> 00:33:42,940
CPU<font color="#E5E5E5"> anymore probably not you're probably</font>

938
00:33:41,320 --> 00:33:44,678
<font color="#CCCCCC">gonna have at least</font><font color="#E5E5E5"> two core</font>

939
00:33:42,940 --> 00:33:47,320
so that's another thing<font color="#CCCCCC"> that you can</font>

940
00:33:44,679 --> 00:33:50,679
<font color="#E5E5E5">check zooming even for is probably good</font>

941
00:33:47,320 --> 00:33:52,389
in 2018<font color="#E5E5E5"> again as I mentioned look for a</font>

942
00:33:50,679 --> 00:33:54,009
<font color="#E5E5E5">specific process running if you're</font>

943
00:33:52,389 --> 00:33:56,559
<font color="#E5E5E5">fishing someone and you don't see</font>

944
00:33:54,009 --> 00:34:00,279
Outlook<font color="#CCCCCC"> exe running that's probably not</font>

945
00:33:56,559 --> 00:34:04,779
your original<font color="#E5E5E5"> target</font><font color="#CCCCCC"> difference between</font>

946
00:34:00,279 --> 00:34:07,659
<font color="#CCCCCC">endpoint and</font><font color="#E5E5E5"> your actual sandbox network</font>

947
00:34:04,779 --> 00:34:09,819
<font color="#CCCCCC">access is your sandbox have network</font>

948
00:34:07,659 --> 00:34:11,319
<font color="#E5E5E5">access that's another easy one</font><font color="#CCCCCC"> oh</font><font color="#E5E5E5"> yeah</font>

949
00:34:09,819 --> 00:34:13,270
<font color="#CCCCCC">here's my pedal and</font><font color="#E5E5E5"> you don't have</font>

950
00:34:11,319 --> 00:34:14,739
network<font color="#CCCCCC"> access how my</font><font color="#E5E5E5"> pedal actually</font>

951
00:34:13,270 --> 00:34:17,770
ended up<font color="#E5E5E5"> there so that's something that</font>

952
00:34:14,739 --> 00:34:19,868
<font color="#CCCCCC">you</font><font color="#E5E5E5"> can assess pretty easily</font><font color="#CCCCCC"> if you're</font>

953
00:34:17,770 --> 00:34:21,788
targeting company usually<font color="#CCCCCC"> they're gonna</font>

954
00:34:19,869 --> 00:34:23,440
be joined to the domain so you<font color="#CCCCCC"> can check</font>

955
00:34:21,789 --> 00:34:25,179
<font color="#E5E5E5">if the</font><font color="#CCCCCC"> current user</font><font color="#E5E5E5"> is running your</font>

956
00:34:23,440 --> 00:34:27,369
pedal is joined to a domain if it's not

957
00:34:25,179 --> 00:34:29,049
the case that's<font color="#CCCCCC"> probably not again</font><font color="#E5E5E5"> the</font>

958
00:34:27,369 --> 00:34:32,409
target<font color="#CCCCCC"> that</font><font color="#E5E5E5"> you're looking for time zone</font>

959
00:34:29,049 --> 00:34:34,569
<font color="#E5E5E5">if you're targeting a Canadian company</font>

960
00:34:32,409 --> 00:34:36,069
and you know exactly on which one on

961
00:34:34,569 --> 00:34:37,989
which time zone they are<font color="#E5E5E5"> there's no</font>

962
00:34:36,069 --> 00:34:39,549
reason<font color="#CCCCCC"> to have like</font><font color="#E5E5E5"> your weird times on</font>

963
00:34:37,989 --> 00:34:41,229
in a<font color="#E5E5E5"> different country right</font><font color="#CCCCCC"> so it may</font>

964
00:34:39,549 --> 00:34:43,480
<font color="#E5E5E5">be another sign if you're running your</font>

965
00:34:41,230 --> 00:34:46,869
code in a shady environment detecting

966
00:34:43,480 --> 00:34:48,279
hook<font color="#CCCCCC"> there's</font><font color="#E5E5E5"> a bunch of</font><font color="#CCCCCC"> sandboxes</font><font color="#E5E5E5"> that</font>

967
00:34:46,869 --> 00:34:51,970
actually have<font color="#E5E5E5"> hooks and they're gonna</font>

968
00:34:48,279 --> 00:34:53,889
<font color="#E5E5E5">fake some some answers so</font><font color="#CCCCCC"> if you has for</font>

969
00:34:51,969 --> 00:34:55,959
a specific<font color="#E5E5E5"> Windows API they may force an</font>

970
00:34:53,889 --> 00:34:58,029
answer but there's actually a way<font color="#CCCCCC"> to</font>

971
00:34:55,960 --> 00:34:59,680
actually<font color="#E5E5E5"> detect book so you can</font><font color="#CCCCCC"> actually</font>

972
00:34:58,029 --> 00:35:02,200
detect that<font color="#E5E5E5"> the function was</font><font color="#CCCCCC"> hooked and</font>

973
00:34:59,680 --> 00:35:04,140
<font color="#E5E5E5">just abort if it's the case</font><font color="#CCCCCC"> uptime for</font>

974
00:35:02,200 --> 00:35:07,180
<font color="#E5E5E5">example if you're targeting someone</font>

975
00:35:04,140 --> 00:35:09,819
during<font color="#E5E5E5"> the after launch and the computer</font>

976
00:35:07,180 --> 00:35:12,009
was open for<font color="#E5E5E5"> like five seconds maybe</font>

977
00:35:09,819 --> 00:35:14,920
it's another shady sandbox<font color="#E5E5E5"> that just</font>

978
00:35:12,010 --> 00:35:17,200
fired up activities look at the clip or

979
00:35:14,920 --> 00:35:18,670
look at the the the<font color="#E5E5E5"> network</font><font color="#CCCCCC"> traffic</font><font color="#E5E5E5"> that</font>

980
00:35:17,200 --> 00:35:21,549
you're receiving if the clipboard is

981
00:35:18,670 --> 00:35:23,380
empty<font color="#CCCCCC"> that may be the case but usually</font>

982
00:35:21,549 --> 00:35:25,538
people<font color="#CCCCCC"> are like copy pasting stuff all</font>

983
00:35:23,380 --> 00:35:27,789
day<font color="#CCCCCC"> long so if it's</font><font color="#E5E5E5"> empty that's another</font>

984
00:35:25,539 --> 00:35:29,410
good<font color="#E5E5E5"> sign</font><font color="#CCCCCC"> of the fact that you're</font>

985
00:35:27,789 --> 00:35:31,480
probably looking at a sandbox right<font color="#E5E5E5"> now</font>

986
00:35:29,410 --> 00:35:33,098
and there's like billions of other

987
00:35:31,480 --> 00:35:35,319
techniques<font color="#E5E5E5"> and we can talk about this</font>

988
00:35:33,099 --> 00:35:37,900
<font color="#CCCCCC">for probably six hours but be creative</font>

989
00:35:35,319 --> 00:35:39,400
<font color="#CCCCCC">that's</font><font color="#E5E5E5"> the key</font><font color="#CCCCCC"> and don't be don't be</font>

990
00:35:37,900 --> 00:35:41,020
<font color="#CCCCCC">sure</font><font color="#E5E5E5"> to actually</font><font color="#CCCCCC"> play with those sand</font>

991
00:35:39,400 --> 00:35:43,070
<font color="#CCCCCC">boxes and trying to figure out how they</font>

992
00:35:41,020 --> 00:35:46,820
work you're<font color="#E5E5E5"> gonna benefit from</font><font color="#CCCCCC"> that</font>

993
00:35:43,070 --> 00:35:49,520
<font color="#E5E5E5">rule number five</font><font color="#CCCCCC"> connecting back to</font><font color="#E5E5E5"> your</font>

994
00:35:46,820 --> 00:35:51,320
<font color="#CCCCCC">c2 as tell T as possible</font><font color="#E5E5E5"> there's a lot</font>

995
00:35:49,520 --> 00:35:54,740
of techniques that<font color="#E5E5E5"> were publicly</font><font color="#CCCCCC"> you</font>

996
00:35:51,320 --> 00:35:56,930
know<font color="#E5E5E5"> publicly</font><font color="#CCCCCC"> disclosed lately like dumb</font>

997
00:35:54,740 --> 00:35:59,240
<font color="#CCCCCC">and fronting so use a legitimate domain</font>

998
00:35:56,930 --> 00:36:01,759
to actually front your c2 domain<font color="#E5E5E5"> is</font>

999
00:35:59,240 --> 00:36:03,709
<font color="#E5E5E5">something is quite cool because your</font>

1000
00:36:01,760 --> 00:36:05,960
client gonna see traffic<font color="#E5E5E5"> to a legitimate</font>

1001
00:36:03,710 --> 00:36:07,640
let's say<font color="#E5E5E5"> Microsoft</font><font color="#CCCCCC"> website then from</font>

1002
00:36:05,960 --> 00:36:09,710
there you can<font color="#CCCCCC"> actually</font><font color="#E5E5E5"> send the data</font>

1003
00:36:07,640 --> 00:36:12,020
back<font color="#CCCCCC"> to your</font><font color="#E5E5E5"> c2 so it's kind</font><font color="#CCCCCC"> of hard to</font>

1004
00:36:09,710 --> 00:36:13,850
<font color="#CCCCCC">actually figure</font><font color="#E5E5E5"> out what's going on for</font>

1005
00:36:12,020 --> 00:36:16,310
<font color="#E5E5E5">me hi our perspective a</font><font color="#CCCCCC"> little</font><font color="#E5E5E5"> bit</font>

1006
00:36:13,850 --> 00:36:18,020
harder at least<font color="#E5E5E5"> categorize the men</font><font color="#CCCCCC"> again</font>

1007
00:36:16,310 --> 00:36:20,180
I<font color="#E5E5E5"> think we covered</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> one pretty</font><font color="#CCCCCC"> well</font>

1008
00:36:18,020 --> 00:36:22,280
<font color="#E5E5E5">and forced HTTPS again there's no reason</font>

1009
00:36:20,180 --> 00:36:24,859
<font color="#CCCCCC">for you to</font><font color="#E5E5E5"> not use HTTPS</font><font color="#CCCCCC"> you're gonna</font>

1010
00:36:22,280 --> 00:36:27,050
<font color="#E5E5E5">blend</font><font color="#CCCCCC"> into the</font><font color="#E5E5E5"> rest of the HTTP</font>

1011
00:36:24,860 --> 00:36:29,090
<font color="#E5E5E5">traffic's and the most companies don't</font>

1012
00:36:27,050 --> 00:36:31,040
<font color="#E5E5E5">perform SSL interception so they're not</font>

1013
00:36:29,090 --> 00:36:34,250
of they're gonna have zero visibility on

1014
00:36:31,040 --> 00:36:36,800
what's going on also<font color="#CCCCCC"> select legitimate</font>

1015
00:36:34,250 --> 00:36:39,260
protocol<font color="#CCCCCC"> in the past like Metasploit</font><font color="#E5E5E5"> few</font>

1016
00:36:36,800 --> 00:36:41,300
<font color="#E5E5E5">look for example they used to do all the</font>

1017
00:36:39,260 --> 00:36:44,030
traffic over raw TCP that was actually

1018
00:36:41,300 --> 00:36:46,160
encrypted<font color="#E5E5E5"> but most rats now they</font>

1019
00:36:44,030 --> 00:36:47,870
actually<font color="#CCCCCC"> move</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> http</font><font color="#E5E5E5"> because they just</font>

1020
00:36:46,160 --> 00:36:51,049
want<font color="#E5E5E5"> to blend</font><font color="#CCCCCC"> into</font><font color="#E5E5E5"> legitimate traffic so</font>

1021
00:36:47,870 --> 00:36:52,339
again<font color="#E5E5E5"> using HTTP for your own</font><font color="#CCCCCC"> rat is</font>

1022
00:36:51,050 --> 00:36:56,210
probably a good idea<font color="#E5E5E5"> if you</font><font color="#CCCCCC"> want to</font>

1023
00:36:52,340 --> 00:36:58,150
write<font color="#E5E5E5"> your own which bring me to turn</font>

1024
00:36:56,210 --> 00:37:00,980
<font color="#E5E5E5">the shell which is</font><font color="#CCCCCC"> a rat that I wrote a</font>

1025
00:36:58,150 --> 00:37:03,340
<font color="#E5E5E5">couple of months</font><font color="#CCCCCC"> ago and again</font><font color="#E5E5E5"> it was to</font>

1026
00:37:00,980 --> 00:37:06,980
solve<font color="#E5E5E5"> an issue on a specific engagement</font>

1027
00:37:03,340 --> 00:37:08,600
<font color="#CCCCCC">one of the idea</font><font color="#E5E5E5"> that we</font><font color="#CCCCCC"> that we</font><font color="#E5E5E5"> had is</font>

1028
00:37:06,980 --> 00:37:11,060
the<font color="#E5E5E5"> endpoint solution was actually</font>

1029
00:37:08,600 --> 00:37:13,279
analyzing then the<font color="#E5E5E5"> network traffic use</font>

1030
00:37:11,060 --> 00:37:15,710
the<font color="#E5E5E5"> using a mini filter which</font><font color="#CCCCCC"> is</font>

1031
00:37:13,280 --> 00:37:17,540
basically a filter<font color="#CCCCCC"> that you can put on</font>

1032
00:37:15,710 --> 00:37:20,480
the network traffic<font color="#E5E5E5"> so even if you</font><font color="#CCCCCC"> use</font>

1033
00:37:17,540 --> 00:37:22,340
<font color="#E5E5E5">HTTP when it the the target</font><font color="#CCCCCC"> the traffic</font>

1034
00:37:20,480 --> 00:37:23,900
is<font color="#E5E5E5"> gonna be decrypted</font><font color="#CCCCCC"> at the u.s. level</font>

1035
00:37:22,340 --> 00:37:26,180
right so you still have<font color="#E5E5E5"> visibility on</font>

1036
00:37:23,900 --> 00:37:27,860
the<font color="#CCCCCC"> clear-text</font><font color="#E5E5E5"> traffic so if you have</font>

1037
00:37:26,180 --> 00:37:30,560
your<font color="#E5E5E5"> stager they actually gonna see it</font>

1038
00:37:27,860 --> 00:37:32,060
and clear<font color="#E5E5E5"> so the solution was</font><font color="#CCCCCC"> to come up</font>

1039
00:37:30,560 --> 00:37:33,890
with<font color="#E5E5E5"> a second layer of encryption that</font>

1040
00:37:32,060 --> 00:37:36,259
it's not<font color="#CCCCCC"> performed at do west level but</font>

1041
00:37:33,890 --> 00:37:39,620
at<font color="#CCCCCC"> the software level</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> Tunde shell is</font>

1042
00:37:36,260 --> 00:37:41,510
actually encrypting everything using<font color="#CCCCCC"> rc4</font>

1043
00:37:39,620 --> 00:37:44,270
so when the target received the traffic

1044
00:37:41,510 --> 00:37:46,880
it's our it's our c4<font color="#E5E5E5"> encrypted which</font>

1045
00:37:44,270 --> 00:37:48,750
doesn't give any information to<font color="#CCCCCC"> the the</font>

1046
00:37:46,880 --> 00:37:51,480
mini filter because<font color="#E5E5E5"> it's just gibberish</font>

1047
00:37:48,750 --> 00:37:53,370
and the<font color="#CCCCCC"> PowerShell</font><font color="#E5E5E5"> rat actually</font>

1048
00:37:51,480 --> 00:37:55,560
performed<font color="#CCCCCC"> the decryption at that point</font>

1049
00:37:53,370 --> 00:37:58,319
so the network has no<font color="#E5E5E5"> visibility on this</font>

1050
00:37:55,560 --> 00:38:00,150
<font color="#E5E5E5">actual traffic another thing that I</font>

1051
00:37:58,320 --> 00:38:02,310
wanted<font color="#E5E5E5"> to address is the fact that most</font>

1052
00:38:00,150 --> 00:38:03,900
<font color="#E5E5E5">of these rat have a second stage so you</font>

1053
00:38:02,310 --> 00:38:05,340
have you're gonna<font color="#E5E5E5"> have</font><font color="#CCCCCC"> your shellcode</font>

1054
00:38:03,900 --> 00:38:07,590
which is the first<font color="#CCCCCC"> Charcot that going to</font>

1055
00:38:05,340 --> 00:38:09,780
fetch the remote<font color="#E5E5E5"> dll or exe that's gonna</font>

1056
00:38:07,590 --> 00:38:12,540
be loaded in memory then it's gonna be

1057
00:38:09,780 --> 00:38:14,340
<font color="#CCCCCC">executed</font><font color="#E5E5E5"> the problem with that is most</font>

1058
00:38:12,540 --> 00:38:16,350
<font color="#E5E5E5">of the solution actually</font><font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> send the</font>

1059
00:38:14,340 --> 00:38:18,300
second stage clear over network so

1060
00:38:16,350 --> 00:38:19,890
you're gonna see like<font color="#E5E5E5"> this shady</font><font color="#CCCCCC"> cobol's</font>

1061
00:38:18,300 --> 00:38:21,690
right dll going through the network

1062
00:38:19,890 --> 00:38:26,250
<font color="#E5E5E5">which is not</font><font color="#CCCCCC"> as</font><font color="#E5E5E5"> really something that</font>

1063
00:38:21,690 --> 00:38:28,440
you<font color="#E5E5E5"> want so by doing</font><font color="#CCCCCC"> rc4 encryption and</font>

1064
00:38:26,250 --> 00:38:31,530
avoiding having<font color="#E5E5E5"> a second stage you're</font>

1065
00:38:28,440 --> 00:38:34,980
pretty<font color="#E5E5E5"> much good to</font><font color="#CCCCCC"> go again</font><font color="#E5E5E5"> so this is</font>

1066
00:38:31,530 --> 00:38:38,160
basically the scheme<font color="#CCCCCC"> of how the tunnel</font>

1067
00:38:34,980 --> 00:38:40,410
rat work so<font color="#CCCCCC"> you use rc4</font><font color="#E5E5E5"> encryption sent</font>

1068
00:38:38,160 --> 00:38:42,810
over<font color="#CCCCCC"> https when those decrypt the</font><font color="#E5E5E5"> HTTP</font>

1069
00:38:40,410 --> 00:38:44,430
stream then the network<font color="#CCCCCC"> is at that</font>

1070
00:38:42,810 --> 00:38:45,600
position and<font color="#CCCCCC"> powershell rat</font><font color="#E5E5E5"> actually</font>

1071
00:38:44,430 --> 00:38:47,549
decrypt<font color="#E5E5E5"> the rc4</font>

1072
00:38:45,600 --> 00:38:52,500
after the hook was set so they have

1073
00:38:47,550 --> 00:38:53,820
<font color="#CCCCCC">zeros ability again it</font><font color="#E5E5E5"> just doesn't</font>

1074
00:38:52,500 --> 00:38:55,680
<font color="#E5E5E5">download the second stage which is a</font>

1075
00:38:53,820 --> 00:38:57,390
good<font color="#E5E5E5"> thing and it feel free to</font>

1076
00:38:55,680 --> 00:38:59,520
contribute to the project<font color="#E5E5E5"> I wish it can</font>

1077
00:38:57,390 --> 00:39:01,440
become<font color="#CCCCCC"> something</font><font color="#E5E5E5"> is useful for for more</font>

1078
00:38:59,520 --> 00:39:02,940
<font color="#E5E5E5">than</font><font color="#CCCCCC"> just me so</font><font color="#E5E5E5"> if you feel I'm actually</font>

1079
00:39:01,440 --> 00:39:04,350
working on where you<font color="#E5E5E5"> are right now</font><font color="#CCCCCC"> to</font>

1080
00:39:02,940 --> 00:39:06,750
make it<font color="#E5E5E5"> as much convenient as possible</font>

1081
00:39:04,350 --> 00:39:08,310
<font color="#CCCCCC">but feel free to actually join me in</font>

1082
00:39:06,750 --> 00:39:10,380
that project<font color="#CCCCCC"> if you're interested</font><font color="#E5E5E5"> will</font>

1083
00:39:08,310 --> 00:39:13,380
be a pleasure<font color="#E5E5E5"> to work with you choose</font>

1084
00:39:10,380 --> 00:39:16,320
the right<font color="#CCCCCC"> pedal for example if you look</font>

1085
00:39:13,380 --> 00:39:18,570
<font color="#E5E5E5">at</font><font color="#CCCCCC"> a fist 2016 by therefore the</font><font color="#E5E5E5"> macro</font>

1086
00:39:16,320 --> 00:39:20,310
<font color="#E5E5E5">disabled so you can try out as hard as</font>

1087
00:39:18,570 --> 00:39:22,860
<font color="#E5E5E5">you</font><font color="#CCCCCC"> want the client not</font><font color="#E5E5E5"> going to be able</font>

1088
00:39:20,310 --> 00:39:24,360
<font color="#E5E5E5">to</font><font color="#CCCCCC"> actually run it so trying</font><font color="#E5E5E5"> to avoid</font>

1089
00:39:22,860 --> 00:39:27,930
macro if you know for a fact that<font color="#E5E5E5"> your</font>

1090
00:39:24,360 --> 00:39:30,000
client<font color="#CCCCCC"> is</font><font color="#E5E5E5"> using office 2016</font><font color="#CCCCCC"> HT a it's</font>

1091
00:39:27,930 --> 00:39:32,069
super powerful<font color="#E5E5E5"> but it's also highly</font>

1092
00:39:30,000 --> 00:39:34,590
detected because<font color="#E5E5E5"> it's extremely trendy a</font>

1093
00:39:32,070 --> 00:39:37,560
lot of people talk<font color="#CCCCCC"> about</font><font color="#E5E5E5"> it and it's</font>

1094
00:39:34,590 --> 00:39:39,990
fairly<font color="#CCCCCC"> COO a click once</font><font color="#E5E5E5"> required the use</font>

1095
00:39:37,560 --> 00:39:42,060
<font color="#E5E5E5">of Internet Explorer</font><font color="#CCCCCC"> and I've hit a case</font>

1096
00:39:39,990 --> 00:39:44,069
where the the<font color="#E5E5E5"> whole shop was using</font>

1097
00:39:42,060 --> 00:39:46,200
<font color="#E5E5E5">Google Chrome</font><font color="#CCCCCC"> and it didn't know how to</font>

1098
00:39:44,070 --> 00:39:48,110
<font color="#E5E5E5">use Internet Explorer so they were just</font>

1099
00:39:46,200 --> 00:39:50,250
trying<font color="#CCCCCC"> to load the click once using</font>

1100
00:39:48,110 --> 00:39:53,250
<font color="#E5E5E5">Chrome which was not really successful</font>

1101
00:39:50,250 --> 00:39:55,200
<font color="#CCCCCC">for me</font><font color="#E5E5E5"> playing taxi maybe blog by</font>

1102
00:39:53,250 --> 00:39:56,730
application whitelisting so depending<font color="#E5E5E5"> on</font>

1103
00:39:55,200 --> 00:39:58,040
which kind<font color="#E5E5E5"> of fingerprint you manage to</font>

1104
00:39:56,730 --> 00:40:00,950
do on your client you may

1105
00:39:58,040 --> 00:40:04,430
actually avoid using one<font color="#CCCCCC"> of</font><font color="#E5E5E5"> these</font>

1106
00:40:00,950 --> 00:40:06,080
specific<font color="#CCCCCC"> payload</font><font color="#E5E5E5"> because you're gonna</font>

1107
00:40:04,430 --> 00:40:08,899
get<font color="#CCCCCC"> detected or it's actually just not</font>

1108
00:40:06,080 --> 00:40:11,330
gonna<font color="#E5E5E5"> run again avoid running PowerShell</font>

1109
00:40:08,900 --> 00:40:13,790
directly<font color="#CCCCCC"> to because it's extremely</font>

1110
00:40:11,330 --> 00:40:15,770
tranny<font color="#E5E5E5"> so for example instead</font><font color="#CCCCCC"> of doing</font>

1111
00:40:13,790 --> 00:40:17,779
macro that actually<font color="#CCCCCC"> launched it W might</font>

1112
00:40:15,770 --> 00:40:20,000
<font color="#E5E5E5">that one</font><font color="#CCCCCC"> launched</font><font color="#E5E5E5"> PowerShell use macro</font>

1113
00:40:17,780 --> 00:40:23,210
that launched W might actually use

1114
00:40:20,000 --> 00:40:24,980
PowerShell<font color="#CCCCCC"> less to a load the PowerShell</font>

1115
00:40:23,210 --> 00:40:28,610
without actually ever ever invoking

1116
00:40:24,980 --> 00:40:29,720
<font color="#E5E5E5">PowerShell</font><font color="#CCCCCC"> exe that's those little</font>

1117
00:40:28,610 --> 00:40:31,040
things that<font color="#E5E5E5"> actually make a</font><font color="#CCCCCC"> huge</font>

1118
00:40:29,720 --> 00:40:34,730
difference<font color="#E5E5E5"> at you know the day between</font>

1119
00:40:31,040 --> 00:40:36,500
<font color="#E5E5E5">being detected or not so at this point</font>

1120
00:40:34,730 --> 00:40:38,630
<font color="#E5E5E5">we carefully crafted or phishing</font>

1121
00:40:36,500 --> 00:40:41,240
campaign<font color="#E5E5E5"> and or</font><font color="#CCCCCC"> payload so we're</font><font color="#E5E5E5"> pretty</font>

1122
00:40:38,630 --> 00:40:43,070
<font color="#E5E5E5">much</font><font color="#CCCCCC"> ready</font><font color="#E5E5E5"> to go right so good news</font>

1123
00:40:41,240 --> 00:40:46,609
<font color="#E5E5E5">everyone we have a shell at that point</font>

1124
00:40:43,070 --> 00:40:48,380
so it's time<font color="#E5E5E5"> for</font><font color="#CCCCCC"> hunting so now we have</font>

1125
00:40:46,610 --> 00:40:50,720
access<font color="#E5E5E5"> we need to gather as much</font>

1126
00:40:48,380 --> 00:40:52,550
<font color="#E5E5E5">information as</font><font color="#CCCCCC"> possible</font><font color="#E5E5E5"> and usually</font><font color="#CCCCCC"> you</font>

1127
00:40:50,720 --> 00:40:54,109
never<font color="#E5E5E5"> know maybe you think you went you</font>

1128
00:40:52,550 --> 00:40:55,820
went through<font color="#CCCCCC"> when you were supercell but</font>

1129
00:40:54,110 --> 00:40:59,570
they actually have good detection and

1130
00:40:55,820 --> 00:41:01,190
they<font color="#E5E5E5"> actually detected you so as fast as</font>

1131
00:40:59,570 --> 00:41:02,990
possible<font color="#E5E5E5"> I'm always gonna try to fetch</font>

1132
00:41:01,190 --> 00:41:04,640
as<font color="#CCCCCC"> much information</font><font color="#E5E5E5"> about the internal</font>

1133
00:41:02,990 --> 00:41:06,919
user base so I'm gonna fetch the

1134
00:41:04,640 --> 00:41:08,690
<font color="#CCCCCC">username the email</font><font color="#E5E5E5"> and everything I can</font>

1135
00:41:06,920 --> 00:41:10,640
to<font color="#CCCCCC"> make</font><font color="#E5E5E5"> sure</font><font color="#CCCCCC"> that I</font><font color="#E5E5E5"> can collect this</font>

1136
00:41:08,690 --> 00:41:12,380
<font color="#CCCCCC">information and punch potentially we do</font>

1137
00:41:10,640 --> 00:41:14,600
a phishing campaign later on with a

1138
00:41:12,380 --> 00:41:17,420
bigger pool of<font color="#CCCCCC"> information so again</font>

1139
00:41:14,600 --> 00:41:19,339
<font color="#CCCCCC">before</font><font color="#E5E5E5"> using running PowerShell directly</font>

1140
00:41:17,420 --> 00:41:21,710
avoid using in that<font color="#E5E5E5"> family command</font>

1141
00:41:19,340 --> 00:41:23,480
because there's a lot of<font color="#E5E5E5"> detection</font><font color="#CCCCCC"> based</font>

1142
00:41:21,710 --> 00:41:24,920
rule<font color="#E5E5E5"> that are purely based on the</font>

1143
00:41:23,480 --> 00:41:27,020
function that<font color="#E5E5E5"> you're gonna call so if</font>

1144
00:41:24,920 --> 00:41:28,460
you call net user something<font color="#E5E5E5"> there's a</font>

1145
00:41:27,020 --> 00:41:31,100
good chance<font color="#CCCCCC"> that you may be detected if</font>

1146
00:41:28,460 --> 00:41:32,840
they have detection for that<font color="#CCCCCC"> trying to</font>

1147
00:41:31,100 --> 00:41:34,970
<font color="#E5E5E5">avoid connecting to all system at the</font>

1148
00:41:32,840 --> 00:41:38,450
same time if it's possible<font color="#CCCCCC"> because it's</font>

1149
00:41:34,970 --> 00:41:41,120
pretty bad and super noisy<font color="#CCCCCC"> the solution</font>

1150
00:41:38,450 --> 00:41:43,640
<font color="#CCCCCC">if you want to get the information as</font>

1151
00:41:41,120 --> 00:41:46,339
<font color="#E5E5E5">fast as possible personally</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> use</font>

1152
00:41:43,640 --> 00:41:48,080
unmanaged PowerShell plus LDAP query<font color="#E5E5E5"> you</font>

1153
00:41:46,340 --> 00:41:49,790
can<font color="#E5E5E5"> just send an LDAP query to</font><font color="#CCCCCC"> the</font>

1154
00:41:48,080 --> 00:41:51,980
<font color="#CCCCCC">Active Directory</font><font color="#E5E5E5"> and get all the</font>

1155
00:41:49,790 --> 00:41:54,230
information<font color="#E5E5E5"> for</font><font color="#CCCCCC"> cobol strike power pick</font>

1156
00:41:51,980 --> 00:41:56,240
is equal enough<font color="#CCCCCC"> manage</font><font color="#E5E5E5"> PowerShell it's</font>

1157
00:41:54,230 --> 00:41:58,610
<font color="#CCCCCC">built-in so there's</font><font color="#E5E5E5"> no reason to</font><font color="#CCCCCC"> not</font>

1158
00:41:56,240 --> 00:42:00,229
<font color="#CCCCCC">doing a ton of shell by default support</font>

1159
00:41:58,610 --> 00:42:02,030
this<font color="#E5E5E5"> too so every time</font><font color="#CCCCCC"> that every time</font>

1160
00:42:00,230 --> 00:42:04,430
<font color="#CCCCCC">that you're actually invoking PowerShell</font>

1161
00:42:02,030 --> 00:42:06,079
you're actually using<font color="#CCCCCC"> the on -</font>

1162
00:42:04,430 --> 00:42:10,109
PowerShell idea

1163
00:42:06,079 --> 00:42:11,579
so if you look at<font color="#E5E5E5"> this script</font><font color="#CCCCCC"> I have a</font>

1164
00:42:10,109 --> 00:42:13,769
command<font color="#CCCCCC"> let which is called</font><font color="#E5E5E5"> dump user</font>

1165
00:42:11,579 --> 00:42:16,980
<font color="#E5E5E5">email which actually</font><font color="#CCCCCC"> just ended</font><font color="#E5E5E5"> up doing</font>

1166
00:42:13,769 --> 00:42:18,930
a a LDAP query so it's gonna look<font color="#E5E5E5"> for</font>

1167
00:42:16,980 --> 00:42:20,999
all the users<font color="#CCCCCC"> in the</font><font color="#E5E5E5"> LDAP directory and</font>

1168
00:42:18,930 --> 00:42:23,009
get the mail property that's<font color="#E5E5E5"> all you're</font>

1169
00:42:20,999 --> 00:42:25,259
gonna<font color="#E5E5E5"> get all the the</font><font color="#CCCCCC"> mail</font><font color="#E5E5E5"> without</font>

1170
00:42:23,009 --> 00:42:27,029
having to use<font color="#E5E5E5"> SMB or anything else</font>

1171
00:42:25,259 --> 00:42:28,890
you're<font color="#CCCCCC"> just gonna query LDAP directly</font>

1172
00:42:27,029 --> 00:42:31,710
and this is usually<font color="#CCCCCC"> some things that</font>

1173
00:42:28,890 --> 00:42:34,230
<font color="#CCCCCC">company do not monitor same with</font>

1174
00:42:31,710 --> 00:42:36,569
username<font color="#E5E5E5"> you want all the</font><font color="#CCCCCC"> username same</font>

1175
00:42:34,230 --> 00:42:38,730
query<font color="#E5E5E5"> just different property there's</font>

1176
00:42:36,569 --> 00:42:41,190
other option like more<font color="#E5E5E5"> that can provide</font>

1177
00:42:38,730 --> 00:42:43,920
you more information<font color="#CCCCCC"> about the users</font>

1178
00:42:41,190 --> 00:42:48,930
that<font color="#CCCCCC"> you're looking for if you're</font>

1179
00:42:43,920 --> 00:42:50,279
filling a bit more and more crazy if I

1180
00:42:48,930 --> 00:42:52,140
can put<font color="#E5E5E5"> it</font><font color="#CCCCCC"> that way you can actually try</font>

1181
00:42:50,279 --> 00:42:54,299
to<font color="#CCCCCC"> birth force users after you fetch the</font>

1182
00:42:52,140 --> 00:42:55,980
<font color="#CCCCCC">list</font><font color="#E5E5E5"> of users if you feel like you want</font>

1183
00:42:54,299 --> 00:42:56,489
<font color="#CCCCCC">to brute force all</font><font color="#E5E5E5"> of these users why</font>

1184
00:42:55,980 --> 00:42:59,460
not

1185
00:42:56,489 --> 00:43:02,579
so actually wrote<font color="#E5E5E5"> another script that</font>

1186
00:42:59,460 --> 00:43:04,650
allow you<font color="#E5E5E5"> to pass a list of user and the</font>

1187
00:43:02,579 --> 00:43:06,690
password and the cool thing<font color="#CCCCCC"> about this</font>

1188
00:43:04,650 --> 00:43:08,930
rip is you can actually<font color="#E5E5E5"> if brute force</font>

1189
00:43:06,690 --> 00:43:10,980
user another<font color="#CCCCCC"> forest inside of the</font>

1190
00:43:08,930 --> 00:43:12,328
<font color="#CCCCCC">enterprise you</font><font color="#E5E5E5"> just have to</font><font color="#CCCCCC"> specify the</font>

1191
00:43:10,980 --> 00:43:14,369
<font color="#CCCCCC">demand</font><font color="#E5E5E5"> that you're looking for so you</font>

1192
00:43:12,329 --> 00:43:16,920
<font color="#E5E5E5">can be in</font><font color="#CCCCCC"> domain a and</font><font color="#E5E5E5"> actually brute</font>

1193
00:43:14,369 --> 00:43:18,869
force users in dumb in<font color="#CCCCCC"> B works pretty</font>

1194
00:43:16,920 --> 00:43:20,390
well it's obviously a bit more noisy

1195
00:43:18,869 --> 00:43:22,559
<font color="#CCCCCC">because every time</font><font color="#E5E5E5"> you're trying to</font>

1196
00:43:20,390 --> 00:43:25,890
<font color="#E5E5E5">login attempt you're gonna generate an</font>

1197
00:43:22,559 --> 00:43:28,140
event<font color="#E5E5E5"> of course</font><font color="#CCCCCC"> try to avoid</font><font color="#E5E5E5"> brute</font>

1198
00:43:25,890 --> 00:43:29,519
forcing more<font color="#CCCCCC"> than two times the same</font>

1199
00:43:28,140 --> 00:43:30,029
user because you may lock all the

1200
00:43:29,519 --> 00:43:32,368
<font color="#CCCCCC">accounts</font>

1201
00:43:30,029 --> 00:43:33,660
this is not something<font color="#E5E5E5"> super stealth</font>

1202
00:43:32,369 --> 00:43:35,640
<font color="#E5E5E5">especially if you don't want to be</font>

1203
00:43:33,660 --> 00:43:37,618
detected but<font color="#E5E5E5"> it can be really useful</font><font color="#CCCCCC"> if</font>

1204
00:43:35,640 --> 00:43:42,480
you're<font color="#E5E5E5"> running out of idea everything</font>

1205
00:43:37,619 --> 00:43:44,970
<font color="#E5E5E5">that didn't went super well just sort of</font>

1206
00:43:42,480 --> 00:43:47,160
curiosity<font color="#CCCCCC"> the the brute force thing rely</font>

1207
00:43:44,970 --> 00:43:49,799
on a validate credential which is a

1208
00:43:47,160 --> 00:43:51,420
<font color="#CCCCCC">built-in functionality in Windows and it</font>

1209
00:43:49,799 --> 00:43:52,980
just connected<font color="#E5E5E5"> the DC in the house gives</font>

1210
00:43:51,420 --> 00:43:55,160
the credential or<font color="#E5E5E5"> valid or not</font><font color="#CCCCCC"> that's</font>

1211
00:43:52,980 --> 00:43:55,160
<font color="#E5E5E5">all</font>

1212
00:43:55,589 --> 00:43:59,729
if you're looking<font color="#CCCCCC"> for a specific sign</font>

1213
00:43:57,900 --> 00:44:01,349
account name let's<font color="#E5E5E5"> say you're you went</font>

1214
00:43:59,729 --> 00:44:03,558
on LinkedIn and<font color="#CCCCCC"> you found this specific</font>

1215
00:44:01,349 --> 00:44:05,669
user that seems to<font color="#CCCCCC"> be really interesting</font>

1216
00:44:03,559 --> 00:44:08,009
<font color="#CCCCCC">there's actually a little script</font><font color="#E5E5E5"> that I</font>

1217
00:44:05,669 --> 00:44:10,469
again wrote which is called search full

1218
00:44:08,009 --> 00:44:12,539
name - Sam<font color="#E5E5E5"> account you</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> provided</font><font color="#CCCCCC"> a</font>

1219
00:44:10,469 --> 00:44:14,130
name and they're gonna return<font color="#E5E5E5"> the</font>

1220
00:44:12,539 --> 00:44:16,949
<font color="#CCCCCC">information that it's actually inside of</font>

1221
00:44:14,130 --> 00:44:19,019
<font color="#E5E5E5">the</font><font color="#CCCCCC"> active directory</font><font color="#E5E5E5"> again so in this</font>

1222
00:44:16,949 --> 00:44:20,429
case<font color="#CCCCCC"> I search for myself</font><font color="#E5E5E5"> inside of the</font>

1223
00:44:19,019 --> 00:44:22,709
fire ride domain and as you<font color="#E5E5E5"> can</font><font color="#CCCCCC"> see I</font>

1224
00:44:20,429 --> 00:44:25,049
just<font color="#E5E5E5"> specify Hamilton and my name come</font>

1225
00:44:22,709 --> 00:44:26,999
out so<font color="#E5E5E5"> you can get the</font><font color="#CCCCCC"> Sam account</font><font color="#E5E5E5"> name</font>

1226
00:44:25,049 --> 00:44:28,349
and<font color="#CCCCCC"> you can</font><font color="#E5E5E5"> potentially try to find</font>

1227
00:44:26,999 --> 00:44:30,299
where this<font color="#E5E5E5"> actually is</font><font color="#CCCCCC"> actually</font>

1228
00:44:28,349 --> 00:44:34,799
<font color="#E5E5E5">currently logged in based on the same</font>

1229
00:44:30,299 --> 00:44:37,259
account<font color="#E5E5E5"> name right</font><font color="#CCCCCC"> there's a really cool</font>

1230
00:44:34,799 --> 00:44:40,019
feature<font color="#CCCCCC"> you're probably familiar with</font>

1231
00:44:37,259 --> 00:44:43,229
tools such as<font color="#E5E5E5"> invoke user hunter which</font>

1232
00:44:40,019 --> 00:44:46,348
<font color="#E5E5E5">basically</font><font color="#CCCCCC"> connect</font><font color="#E5E5E5"> as too much to as to</font>

1233
00:44:43,229 --> 00:44:48,328
have sets that it's actually alive in

1234
00:44:46,349 --> 00:44:50,009
the network<font color="#E5E5E5"> and they're gonna try to see</font>

1235
00:44:48,329 --> 00:44:52,799
<font color="#E5E5E5">you who's actually running on</font><font color="#CCCCCC"> this</font>

1236
00:44:50,009 --> 00:44:54,779
<font color="#CCCCCC">system right it's super useful but</font>

1237
00:44:52,799 --> 00:44:58,229
extremely<font color="#E5E5E5"> noisy</font><font color="#CCCCCC"> to this technique is a</font>

1238
00:44:54,779 --> 00:45:00,119
bit less<font color="#CCCCCC"> less tell</font><font color="#E5E5E5"> it only</font><font color="#CCCCCC"> connect to</font>

1239
00:44:58,229 --> 00:45:02,218
<font color="#E5E5E5">the main controller and look for the</font>

1240
00:45:00,119 --> 00:45:03,779
event log<font color="#CCCCCC"> and the log on event for the</font>

1241
00:45:02,219 --> 00:45:05,759
<font color="#E5E5E5">users or</font><font color="#CCCCCC"> you're targeting</font><font color="#E5E5E5"> the only</font>

1242
00:45:03,779 --> 00:45:08,329
downside is<font color="#CCCCCC"> that</font><font color="#E5E5E5"> you need to have domain</font>

1243
00:45:05,759 --> 00:45:10,799
admin access<font color="#E5E5E5"> at that point however</font>

1244
00:45:08,329 --> 00:45:12,659
<font color="#E5E5E5">usually the way</font><font color="#CCCCCC"> that I'm proceeding</font><font color="#E5E5E5"> is</font>

1245
00:45:10,799 --> 00:45:14,669
my first goal<font color="#CCCCCC"> is to</font><font color="#E5E5E5"> get the main admin</font>

1246
00:45:12,659 --> 00:45:16,439
and from there I'm gonna<font color="#E5E5E5"> move</font><font color="#CCCCCC"> to a</font>

1247
00:45:14,669 --> 00:45:18,390
<font color="#CCCCCC">specific target that have access to the</font>

1248
00:45:16,439 --> 00:45:20,519
application I'm targeting<font color="#E5E5E5"> so at that</font>

1249
00:45:18,390 --> 00:45:21,929
point<font color="#E5E5E5"> in my</font><font color="#CCCCCC"> Red Team</font><font color="#E5E5E5"> I already have the</font>

1250
00:45:20,519 --> 00:45:24,299
main<font color="#E5E5E5"> element so it's not really an issue</font>

1251
00:45:21,929 --> 00:45:26,880
<font color="#CCCCCC">for me so you</font><font color="#E5E5E5"> just specify your user and</font>

1252
00:45:24,299 --> 00:45:30,089
wait for the event<font color="#CCCCCC"> log to show it up and</font>

1253
00:45:26,880 --> 00:45:31,890
you're gonna<font color="#E5E5E5"> have a bunch of like</font><font color="#CCCCCC"> logon</font>

1254
00:45:30,089 --> 00:45:34,259
event that show you the source IP so you

1255
00:45:31,890 --> 00:45:36,779
can easily find<font color="#CCCCCC"> where the user</font><font color="#E5E5E5"> is</font>

1256
00:45:34,259 --> 00:45:40,409
actually connected at the moment so you

1257
00:45:36,779 --> 00:45:44,219
<font color="#CCCCCC">can</font><font color="#E5E5E5"> target that system later</font><font color="#CCCCCC"> on browser</font>

1258
00:45:40,409 --> 00:45:45,779
bookmark<font color="#E5E5E5"> is really useful too</font><font color="#CCCCCC"> by default</font>

1259
00:45:44,219 --> 00:45:48,569
they may push this information<font color="#CCCCCC"> their</font>

1260
00:45:45,779 --> 00:45:50,489
<font color="#E5E5E5">bookmark so all their corporate asset</font>

1261
00:45:48,569 --> 00:45:51,989
<font color="#E5E5E5">may be actually found in the bookmark so</font>

1262
00:45:50,489 --> 00:45:53,279
if you're<font color="#CCCCCC"> looking</font><font color="#E5E5E5"> for their intranet and</font>

1263
00:45:51,989 --> 00:45:55,169
stuff like that you may actually found

1264
00:45:53,279 --> 00:45:56,909
it there<font color="#CCCCCC"> again there's another little</font>

1265
00:45:55,169 --> 00:46:01,589
<font color="#CCCCCC">powershell script</font><font color="#E5E5E5"> that can do that for</font>

1266
00:45:56,909 --> 00:46:03,509
you<font color="#CCCCCC"> w digest me</font><font color="#E5E5E5"> me cats sometimes may</font>

1267
00:46:01,589 --> 00:46:06,910
not<font color="#E5E5E5"> work because they may have</font><font color="#CCCCCC"> prevented</font>

1268
00:46:03,509 --> 00:46:08,710
w<font color="#E5E5E5"> digest to be stored in memory</font>

1269
00:46:06,910 --> 00:46:11,560
the cool thing about<font color="#CCCCCC"> powershell by</font>

1270
00:46:08,710 --> 00:46:13,900
default is support Kerberos<font color="#CCCCCC"> ticket</font><font color="#E5E5E5"> so if</font>

1271
00:46:11,560 --> 00:46:15,640
you have access<font color="#CCCCCC"> to PowerShell you</font>

1272
00:46:13,900 --> 00:46:18,100
actually have access to<font color="#CCCCCC"> the current</font><font color="#E5E5E5"> user</font>

1273
00:46:15,640 --> 00:46:19,720
<font color="#CCCCCC">curb rustic yet</font><font color="#E5E5E5"> and I wrote a little</font>

1274
00:46:18,100 --> 00:46:21,580
script which is<font color="#E5E5E5"> called remote that we</font>

1275
00:46:19,720 --> 00:46:23,560
might execute<font color="#E5E5E5"> that allow you to execute</font>

1276
00:46:21,580 --> 00:46:26,380
command on a remote host using your

1277
00:46:23,560 --> 00:46:27,790
<font color="#E5E5E5">current user Kerberos ticket so assuming</font>

1278
00:46:26,380 --> 00:46:30,220
that<font color="#E5E5E5"> the user that you currently have</font>

1279
00:46:27,790 --> 00:46:32,050
<font color="#CCCCCC">access to have</font><font color="#E5E5E5"> access to other system</font>

1280
00:46:30,220 --> 00:46:32,919
such<font color="#CCCCCC"> as at local Hyneman user or</font>

1281
00:46:32,050 --> 00:46:36,070
something<font color="#E5E5E5"> like</font><font color="#CCCCCC"> that you can just</font>

1282
00:46:32,920 --> 00:46:37,630
<font color="#CCCCCC">leverage that power to move laterally on</font>

1283
00:46:36,070 --> 00:46:41,890
the network without<font color="#E5E5E5"> actually knowing</font>

1284
00:46:37,630 --> 00:46:44,350
<font color="#CCCCCC">anyone password there</font><font color="#E5E5E5"> is a little</font>

1285
00:46:41,890 --> 00:46:46,330
downside<font color="#CCCCCC"> about</font><font color="#E5E5E5"> Kerberos tickets</font>

1286
00:46:44,350 --> 00:46:48,150
<font color="#E5E5E5">sometimes even if you have a Kerberos</font>

1287
00:46:46,330 --> 00:46:50,980
ticket you're gonna<font color="#E5E5E5"> get access deny</font>

1288
00:46:48,150 --> 00:46:53,170
<font color="#E5E5E5">there is a catch-22 with the Kerberos</font>

1289
00:46:50,980 --> 00:46:55,030
ticket depend on which process you're

1290
00:46:53,170 --> 00:46:56,890
actually<font color="#CCCCCC"> using your Kerberos ticket may</font>

1291
00:46:55,030 --> 00:46:58,750
not be in refresh<font color="#CCCCCC"> so it's just gonna</font>

1292
00:46:56,890 --> 00:47:01,960
<font color="#E5E5E5">timeout and never gonna be actually</font>

1293
00:46:58,750 --> 00:47:04,510
renewed<font color="#E5E5E5"> so it's really important to</font>

1294
00:47:01,960 --> 00:47:07,030
actually pick the right process when

1295
00:47:04,510 --> 00:47:09,070
<font color="#E5E5E5">you're performing that kind of task so</font>

1296
00:47:07,030 --> 00:47:10,840
<font color="#CCCCCC">especially if you're using W</font><font color="#E5E5E5"> mod this is</font>

1297
00:47:09,070 --> 00:47:12,730
<font color="#CCCCCC">one of</font><font color="#E5E5E5"> the the process are actually</font>

1298
00:47:10,840 --> 00:47:15,280
gonna not necessarily renew your

1299
00:47:12,730 --> 00:47:16,990
Kerberos ticket<font color="#E5E5E5"> so one of the things</font>

1300
00:47:15,280 --> 00:47:18,670
that I do again it's a bit noisy<font color="#CCCCCC"> but</font>

1301
00:47:16,990 --> 00:47:20,200
sometimes we have<font color="#CCCCCC"> to be noisy to make</font>

1302
00:47:18,670 --> 00:47:21,760
sure that we in a good<font color="#E5E5E5"> position I'm</font>

1303
00:47:20,200 --> 00:47:23,350
gonna<font color="#E5E5E5"> migrate to Explorer so I'm gonna</font>

1304
00:47:21,760 --> 00:47:24,940
<font color="#E5E5E5">inject</font><font color="#CCCCCC"> myself into Explorer</font><font color="#E5E5E5"> and</font>

1305
00:47:23,350 --> 00:47:27,640
impersonate everything that<font color="#CCCCCC"> it's running</font>

1306
00:47:24,940 --> 00:47:29,920
<font color="#E5E5E5">under the Explorer context</font><font color="#CCCCCC"> I'm also</font>

1307
00:47:27,640 --> 00:47:32,740
gonna enter it from<font color="#E5E5E5"> the Kerberos ticket</font>

1308
00:47:29,920 --> 00:47:35,680
obviously<font color="#E5E5E5"> so that's</font><font color="#CCCCCC"> a that's</font><font color="#E5E5E5"> my go to</font>

1309
00:47:32,740 --> 00:47:37,209
process but unfortunately<font color="#E5E5E5"> Explorer is</font>

1310
00:47:35,680 --> 00:47:38,919
not<font color="#CCCCCC"> the process that really performed</font>

1311
00:47:37,210 --> 00:47:41,230
network traffic so it's some things that

1312
00:47:38,920 --> 00:47:43,570
it's shady<font color="#E5E5E5"> apparently on Windows 10 now</font>

1313
00:47:41,230 --> 00:47:47,620
<font color="#CCCCCC">Explorer is actually having tabs and do</font>

1314
00:47:43,570 --> 00:47:50,970
perform networks network<font color="#E5E5E5"> connections so</font>

1315
00:47:47,620 --> 00:47:53,500
it make this technique a bit less shady

1316
00:47:50,970 --> 00:47:55,299
<font color="#CCCCCC">again</font><font color="#E5E5E5"> from an offset perspective it's</font>

1317
00:47:53,500 --> 00:47:57,490
not<font color="#E5E5E5"> necessarily the best process to use</font>

1318
00:47:55,300 --> 00:47:59,260
however<font color="#CCCCCC"> there's more stealthy target</font>

1319
00:47:57,490 --> 00:48:01,569
that you can use such as<font color="#CCCCCC"> as we see also</font>

1320
00:47:59,260 --> 00:48:03,730
<font color="#CCCCCC">to connote our process actually perform</font>

1321
00:48:01,570 --> 00:48:06,100
network traffic so keep<font color="#E5E5E5"> that</font><font color="#CCCCCC"> in mind in</font>

1322
00:48:03,730 --> 00:48:07,750
the future<font color="#E5E5E5"> so you can migrate to</font><font color="#CCCCCC"> these</font>

1323
00:48:06,100 --> 00:48:10,970
process and it's a bit<font color="#E5E5E5"> more</font><font color="#CCCCCC"> sell because</font>

1324
00:48:07,750 --> 00:48:12,950
<font color="#CCCCCC">they're known to perform network traffic</font>

1325
00:48:10,970 --> 00:48:16,189
Active Directory<font color="#CCCCCC"> contain a</font><font color="#E5E5E5"> lot of</font>

1326
00:48:12,950 --> 00:48:18,169
<font color="#E5E5E5">valuable information</font><font color="#CCCCCC"> there's</font><font color="#E5E5E5"> probably</font>

1327
00:48:16,190 --> 00:48:20,150
<font color="#E5E5E5">like two or</font><font color="#CCCCCC"> three hundred</font><font color="#E5E5E5"> feel for each</font>

1328
00:48:18,170 --> 00:48:21,710
user so you'll be surprised<font color="#E5E5E5"> of all the</font>

1329
00:48:20,150 --> 00:48:23,930
<font color="#E5E5E5">information</font><font color="#CCCCCC"> that you can found</font><font color="#E5E5E5"> and</font>

1330
00:48:21,710 --> 00:48:26,839
actually have a bunch of utility<font color="#CCCCCC"> that</font>

1331
00:48:23,930 --> 00:48:28,098
<font color="#E5E5E5">can dump the comment the description and</font>

1332
00:48:26,839 --> 00:48:29,810
you'll<font color="#E5E5E5"> be surprised how many time we</font>

1333
00:48:28,099 --> 00:48:31,369
<font color="#E5E5E5">found actual</font><font color="#CCCCCC"> are coded password in the</font>

1334
00:48:29,810 --> 00:48:33,380
command<font color="#E5E5E5"> for like service account and</font>

1335
00:48:31,369 --> 00:48:35,720
<font color="#E5E5E5">stuff like that so just</font><font color="#CCCCCC"> dump all the</font>

1336
00:48:33,380 --> 00:48:37,130
comments<font color="#E5E5E5"> and you'll be surprised by</font><font color="#CCCCCC"> they</font>

1337
00:48:35,720 --> 00:48:39,859
<font color="#CCCCCC">don't</font><font color="#E5E5E5"> change this password for</font><font color="#CCCCCC"> this</font>

1338
00:48:37,130 --> 00:48:41,300
specific service account<font color="#E5E5E5"> and usually</font>

1339
00:48:39,859 --> 00:48:42,859
<font color="#E5E5E5">having a service account is really</font>

1340
00:48:41,300 --> 00:48:45,800
really<font color="#E5E5E5"> useful from a</font><font color="#CCCCCC"> Red Team</font>

1341
00:48:42,859 --> 00:48:48,200
<font color="#CCCCCC">perspective there's also legacy a</font>

1342
00:48:45,800 --> 00:48:49,550
<font color="#E5E5E5">software that created the user password</font>

1343
00:48:48,200 --> 00:48:51,379
fill in your<font color="#CCCCCC"> Active Directory which</font>

1344
00:48:49,550 --> 00:48:54,140
literally store the user password<font color="#CCCCCC"> and</font>

1345
00:48:51,380 --> 00:48:56,930
clear so you may actually<font color="#E5E5E5"> found that one</font>

1346
00:48:54,140 --> 00:48:58,700
<font color="#CCCCCC">two as I mentioned</font><font color="#E5E5E5"> earlier you</font><font color="#CCCCCC"> don't</font>

1347
00:48:56,930 --> 00:49:00,200
<font color="#E5E5E5">necessarily need</font><font color="#CCCCCC"> had mint</font><font color="#E5E5E5"> privileges to</font>

1348
00:48:58,700 --> 00:49:02,299
achieve all your predefined goal with

1349
00:49:00,200 --> 00:49:04,609
your<font color="#E5E5E5"> clients so if it's an</font><font color="#CCCCCC"> option you</font>

1350
00:49:02,300 --> 00:49:06,020
can try and avoid it<font color="#E5E5E5"> because most of the</font>

1351
00:49:04,609 --> 00:49:07,640
noise<font color="#CCCCCC"> that</font><font color="#E5E5E5"> you're gonna make is to find</font>

1352
00:49:06,020 --> 00:49:09,320
the right<font color="#CCCCCC"> person to have domain admin</font>

1353
00:49:07,640 --> 00:49:10,759
right at the beginning<font color="#CCCCCC"> so if you can</font>

1354
00:49:09,320 --> 00:49:12,740
avoid<font color="#CCCCCC"> that</font><font color="#E5E5E5"> part and just target the</font>

1355
00:49:10,760 --> 00:49:14,540
specific<font color="#CCCCCC"> user ya that you're looking for</font>

1356
00:49:12,740 --> 00:49:16,779
it may actually save you from being

1357
00:49:14,540 --> 00:49:16,779
detected

1358
00:49:16,990 --> 00:49:21,200
unfortunately red team in real life<font color="#CCCCCC"> are</font>

1359
00:49:19,520 --> 00:49:24,050
a bit different<font color="#CCCCCC"> because we're limited</font><font color="#E5E5E5"> in</font>

1360
00:49:21,200 --> 00:49:25,759
<font color="#E5E5E5">time and budget right so the client is</font>

1361
00:49:24,050 --> 00:49:27,349
paying<font color="#E5E5E5"> for your service so sometimes we</font>

1362
00:49:25,760 --> 00:49:29,750
<font color="#CCCCCC">have</font><font color="#E5E5E5"> to hack fast because we're just</font>

1363
00:49:27,349 --> 00:49:32,569
<font color="#E5E5E5">running out</font><font color="#CCCCCC"> of budget</font><font color="#E5E5E5"> or time so we may</font>

1364
00:49:29,750 --> 00:49:34,010
<font color="#CCCCCC">have</font><font color="#E5E5E5"> to take risky</font><font color="#CCCCCC"> this decision but</font><font color="#E5E5E5"> you</font>

1365
00:49:32,569 --> 00:49:35,660
have to be careful and make<font color="#E5E5E5"> sure</font><font color="#CCCCCC"> that</font>

1366
00:49:34,010 --> 00:49:37,369
you're taking the risky<font color="#CCCCCC"> decision for the</font>

1367
00:49:35,660 --> 00:49:38,990
right reason<font color="#E5E5E5"> like as we mentioned</font>

1368
00:49:37,369 --> 00:49:40,900
earlier migrating to<font color="#CCCCCC"> Explorer is</font>

1369
00:49:38,990 --> 00:49:43,700
probably something<font color="#CCCCCC"> that can be</font><font color="#E5E5E5"> done</font>

1370
00:49:40,900 --> 00:49:47,119
fairly stealthy<font color="#E5E5E5"> and may be extremely</font>

1371
00:49:43,700 --> 00:49:48,560
valuable<font color="#CCCCCC"> for you most windows command</font>

1372
00:49:47,119 --> 00:49:50,060
can<font color="#CCCCCC"> be run through</font><font color="#E5E5E5"> PowerShell that's</font>

1373
00:49:48,560 --> 00:49:52,578
another thing most of the framework just

1374
00:49:50,060 --> 00:49:55,670
<font color="#E5E5E5">gonna spawn CMD but you can actually use</font>

1375
00:49:52,579 --> 00:49:58,040
unmanaged PowerShell to<font color="#E5E5E5"> run typical CMD</font>

1376
00:49:55,670 --> 00:50:00,140
command such as<font color="#CCCCCC"> netstat or stuff like</font>

1377
00:49:58,040 --> 00:50:02,000
<font color="#CCCCCC">that so you can use power pick from</font>

1378
00:50:00,140 --> 00:50:03,710
<font color="#CCCCCC">cobol</font><font color="#E5E5E5"> strike or powershell support that</font>

1379
00:50:02,000 --> 00:50:05,329
by their<font color="#CCCCCC"> foe so at least</font><font color="#E5E5E5"> you're not</font>

1380
00:50:03,710 --> 00:50:07,369
<font color="#E5E5E5">gonna have</font><font color="#CCCCCC"> if an add this command has</font>

1381
00:50:05,329 --> 00:50:11,030
<font color="#CCCCCC">been</font><font color="#E5E5E5"> wrong and you're not</font><font color="#CCCCCC"> gonna get</font><font color="#E5E5E5"> the</font>

1382
00:50:07,369 --> 00:50:15,710
alerts for that that's<font color="#CCCCCC"> one ago these are</font>

1383
00:50:11,030 --> 00:50:19,099
not<font color="#E5E5E5"> super stealthy trick but way way way</font>

1384
00:50:15,710 --> 00:50:21,440
useful my favorite one is final<font color="#CCCCCC"> call i'm</font>

1385
00:50:19,099 --> 00:50:22,070
in access it's actually super noisy<font color="#E5E5E5"> but</font>

1386
00:50:21,440 --> 00:50:24,320
it's<font color="#E5E5E5"> the</font>

1387
00:50:22,070 --> 00:50:25,850
useful<font color="#CCCCCC"> the way it works is going to</font>

1388
00:50:24,320 --> 00:50:28,370
connect to all the assets and trying to

1389
00:50:25,850 --> 00:50:30,290
see if the current<font color="#E5E5E5"> user have access to</font>

1390
00:50:28,370 --> 00:50:32,480
this system<font color="#E5E5E5"> with local admin privileges</font>

1391
00:50:30,290 --> 00:50:33,800
<font color="#CCCCCC">it's so useful because you don't even</font>

1392
00:50:32,480 --> 00:50:35,960
have to find a local privilege

1393
00:50:33,800 --> 00:50:37,520
escalation<font color="#E5E5E5"> on your current system if you</font>

1394
00:50:35,960 --> 00:50:39,950
<font color="#E5E5E5">don't want to you can</font><font color="#CCCCCC"> just move on to</font><font color="#E5E5E5"> a</font>

1395
00:50:37,520 --> 00:50:42,320
next<font color="#E5E5E5"> one where you actually privilege so</font>

1396
00:50:39,950 --> 00:50:44,779
you don't<font color="#E5E5E5"> even have to borrow doing this</font>

1397
00:50:42,320 --> 00:50:46,580
<font color="#E5E5E5">getnet the main</font><font color="#CCCCCC"> trust is actually super</font>

1398
00:50:44,780 --> 00:50:48,380
powerful<font color="#CCCCCC"> too you're gonna get all the</font>

1399
00:50:46,580 --> 00:50:50,720
domains so you may<font color="#E5E5E5"> actually found cross</font>

1400
00:50:48,380 --> 00:50:52,430
the main policies that<font color="#CCCCCC"> leaked other</font>

1401
00:50:50,720 --> 00:50:54,529
users are actually privileged in your

1402
00:50:52,430 --> 00:50:56,509
own domain<font color="#E5E5E5"> even</font><font color="#CCCCCC"> if you don't know about</font>

1403
00:50:54,530 --> 00:50:57,830
it<font color="#CCCCCC"> same with the net first rush</font><font color="#E5E5E5"> you'll</font>

1404
00:50:56,510 --> 00:51:00,590
be surprised like<font color="#E5E5E5"> how</font><font color="#CCCCCC"> many be</font>

1405
00:50:57,830 --> 00:51:03,500
directional<font color="#E5E5E5"> trust we found all the time</font>

1406
00:51:00,590 --> 00:51:05,480
that are so useful<font color="#CCCCCC"> in fact</font><font color="#E5E5E5"> share finder</font>

1407
00:51:03,500 --> 00:51:07,040
looking for share with valuable

1408
00:51:05,480 --> 00:51:10,190
<font color="#CCCCCC">information to</font><font color="#E5E5E5"> is something is really</font>

1409
00:51:07,040 --> 00:51:12,170
<font color="#E5E5E5">useful and get net local group again if</font>

1410
00:51:10,190 --> 00:51:13,970
you're looking<font color="#CCCCCC"> for</font><font color="#E5E5E5"> local and</font><font color="#CCCCCC"> main will</font>

1411
00:51:12,170 --> 00:51:15,650
promote on<font color="#CCCCCC"> remote</font><font color="#E5E5E5"> in a system</font><font color="#CCCCCC"> you can</font>

1412
00:51:13,970 --> 00:51:16,910
<font color="#CCCCCC">just ask the remote system to give you</font>

1413
00:51:15,650 --> 00:51:18,440
<font color="#E5E5E5">the list of everything</font><font color="#CCCCCC"> that is</font>

1414
00:51:16,910 --> 00:51:20,060
considered<font color="#E5E5E5"> local alignments view it's</font>

1415
00:51:18,440 --> 00:51:21,770
gonna include active<font color="#E5E5E5"> they're actually</font>

1416
00:51:20,060 --> 00:51:24,020
group and local users also have access

1417
00:51:21,770 --> 00:51:25,370
<font color="#CCCCCC">to it so this is something it's really</font>

1418
00:51:24,020 --> 00:51:27,140
<font color="#E5E5E5">useful but unfortunately there are</font>

1419
00:51:25,370 --> 00:51:28,430
mostly extremely noisy because<font color="#E5E5E5"> they're</font>

1420
00:51:27,140 --> 00:51:30,140
gonna connect<font color="#CCCCCC"> to most system and</font>

1421
00:51:28,430 --> 00:51:33,140
generate<font color="#CCCCCC"> a</font><font color="#E5E5E5"> lot of network traffic</font>

1422
00:51:30,140 --> 00:51:35,660
so in conclusion<font color="#CCCCCC"> even if we try to be as</font>

1423
00:51:33,140 --> 00:51:37,850
stealthy<font color="#CCCCCC"> as possible there's</font><font color="#E5E5E5"> no real</font><font color="#CCCCCC"> way</font>

1424
00:51:35,660 --> 00:51:39,379
to exfiltrate data<font color="#E5E5E5"> without creating some</font>

1425
00:51:37,850 --> 00:51:41,390
noise at some point so you just have<font color="#E5E5E5"> to</font>

1426
00:51:39,380 --> 00:51:44,480
choose your battle and decide<font color="#CCCCCC"> okay I</font>

1427
00:51:41,390 --> 00:51:48,140
<font color="#CCCCCC">consider this</font><font color="#E5E5E5"> specific part of my my</font>

1428
00:51:44,480 --> 00:51:50,590
action to be noisy but big may seems

1429
00:51:48,140 --> 00:51:53,359
legitimate from a network perspective

1430
00:51:50,590 --> 00:51:55,040
<font color="#E5E5E5">but when it's possible</font><font color="#CCCCCC"> trying to adapt</font>

1431
00:51:53,360 --> 00:51:56,660
your technique<font color="#E5E5E5"> in you tool to remain as</font>

1432
00:51:55,040 --> 00:51:58,490
stealthy<font color="#CCCCCC"> as possible with your</font><font color="#E5E5E5"> clients</font>

1433
00:51:56,660 --> 00:52:00,170
so again<font color="#CCCCCC"> I kind of give you some</font><font color="#E5E5E5"> advice</font>

1434
00:51:58,490 --> 00:52:01,399
I hope they're<font color="#E5E5E5"> gonna be useful for you</font>

1435
00:52:00,170 --> 00:52:03,680
in the<font color="#E5E5E5"> future especially if you're</font>

1436
00:52:01,400 --> 00:52:07,130
performing<font color="#E5E5E5"> a red team but you can use</font>

1437
00:52:03,680 --> 00:52:10,279
these advice<font color="#CCCCCC"> to</font><font color="#E5E5E5"> actually get more data</font>

1438
00:52:07,130 --> 00:52:12,170
without creating<font color="#E5E5E5"> much noise</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> a good</font>

1439
00:52:10,280 --> 00:52:13,970
fishing<font color="#E5E5E5"> camping make a difference trying</font>

1440
00:52:12,170 --> 00:52:17,510
to target<font color="#E5E5E5"> your company look at what they</font>

1441
00:52:13,970 --> 00:52:19,220
like crafting a payload isn't hard<font color="#E5E5E5"> so</font>

1442
00:52:17,510 --> 00:52:20,840
take your time don't<font color="#CCCCCC"> rush yourself</font>

1443
00:52:19,220 --> 00:52:22,549
trying<font color="#E5E5E5"> to learn and that's one of the</font>

1444
00:52:20,840 --> 00:52:23,840
reason<font color="#E5E5E5"> why I wrote all</font><font color="#CCCCCC"> of these tool</font><font color="#E5E5E5"> I</font>

1445
00:52:22,550 --> 00:52:25,100
just<font color="#CCCCCC"> wanted to have a better</font>

1446
00:52:23,840 --> 00:52:28,130
<font color="#CCCCCC">understanding</font><font color="#E5E5E5"> and the best way to learn</font>

1447
00:52:25,100 --> 00:52:29,900
is by doing<font color="#E5E5E5"> it yourself and again trying</font>

1448
00:52:28,130 --> 00:52:31,820
<font color="#E5E5E5">to avoid running PowerShell directly at</font>

1449
00:52:29,900 --> 00:52:33,860
all<font color="#CCCCCC"> cost</font><font color="#E5E5E5"> I</font><font color="#CCCCCC"> think I probably said that</font><font color="#E5E5E5"> 20</font>

1450
00:52:31,820 --> 00:52:35,330
time<font color="#E5E5E5"> during the presentation</font><font color="#CCCCCC"> but that's</font>

1451
00:52:33,860 --> 00:52:37,790
<font color="#CCCCCC">a fact</font><font color="#E5E5E5"> it's really important</font><font color="#CCCCCC"> too</font>

1452
00:52:35,330 --> 00:52:40,250
do that because<font color="#E5E5E5"> it's easy to detect</font>

1453
00:52:37,790 --> 00:52:42,350
<font color="#CCCCCC">people that way</font><font color="#E5E5E5"> that's pretty much it</font>

1454
00:52:40,250 --> 00:52:44,150
for<font color="#CCCCCC"> me so I</font><font color="#E5E5E5"> hope you enjoy it</font><font color="#CCCCCC"> if you</font>

1455
00:52:42,350 --> 00:52:46,549
don't<font color="#E5E5E5"> have any</font><font color="#CCCCCC"> questions I guess I'll</font>

1456
00:52:44,150 --> 00:52:56,379
take<font color="#E5E5E5"> some now</font>

1457
00:52:46,550 --> 00:52:56,379
[Applause]

