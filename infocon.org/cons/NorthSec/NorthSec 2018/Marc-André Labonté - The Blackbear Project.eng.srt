1
00:00:00,140 --> 00:00:06,298
hello everyone I'm<font color="#CCCCCC"> Markin via Baldy I'm</font>

2
00:00:04,410 --> 00:00:10,129
here to talk about<font color="#E5E5E5"> the black bear</font>

3
00:00:06,299 --> 00:00:14,750
<font color="#E5E5E5">project which is basically a fork of</font>

4
00:00:10,130 --> 00:00:20,279
<font color="#CCCCCC">OpenSSH and</font><font color="#E5E5E5"> I mean I made that fork to</font>

5
00:00:14,750 --> 00:00:23,369
transform<font color="#CCCCCC"> OpenSSH in that rivers SSH</font><font color="#E5E5E5"> so</font>

6
00:00:20,279 --> 00:00:27,599
I was a system<font color="#CCCCCC"> administrator for</font><font color="#E5E5E5"> more</font>

7
00:00:23,369 --> 00:00:30,090
than<font color="#CCCCCC"> ten years and since two years ago I</font>

8
00:00:27,599 --> 00:00:32,790
moved their way<font color="#CCCCCC"> in to penetration</font>

9
00:00:30,090 --> 00:00:34,250
<font color="#E5E5E5">testing and that is what I'm doing ever</font>

10
00:00:32,790 --> 00:00:38,399
since

11
00:00:34,250 --> 00:00:41,489
so yeah why did it and I'm gonna talk

12
00:00:38,399 --> 00:00:48,899
<font color="#CCCCCC">about why they</font><font color="#E5E5E5"> did and how I did it</font>

13
00:00:41,489 --> 00:00:51,300
especially so it's four of<font color="#CCCCCC"> OpenSSH</font><font color="#E5E5E5"> and</font>

14
00:00:48,899 --> 00:00:54,420
it's designed<font color="#E5E5E5"> to provide a fully</font>

15
00:00:51,300 --> 00:00:58,680
interactive<font color="#E5E5E5"> shell don't know if you</font>

16
00:00:54,420 --> 00:01:02,399
tried like<font color="#E5E5E5"> the dev TCP</font><font color="#CCCCCC"> bash tree or web</font>

17
00:00:58,680 --> 00:01:06,869
shells or Python<font color="#CCCCCC"> river shells when</font>

18
00:01:02,399 --> 00:01:10,950
you're using those shells sub-command

19
00:01:06,869 --> 00:01:16,350
made that work properly like<font color="#E5E5E5"> VI or even</font>

20
00:01:10,950 --> 00:01:21,689
<font color="#E5E5E5">pseudo so I wanted regular SSH as a</font>

21
00:01:16,350 --> 00:01:25,939
reversion when I I need<font color="#E5E5E5"> to do a connect</font>

22
00:01:21,689 --> 00:01:30,899
back and<font color="#E5E5E5"> also I wanted to leverage</font>

23
00:01:25,939 --> 00:01:35,119
<font color="#CCCCCC">OpenSSH dynamic and port forwarding</font><font color="#E5E5E5"> like</font>

24
00:01:30,900 --> 00:01:39,470
the socks proxy<font color="#E5E5E5"> and the VPN</font>

25
00:01:35,119 --> 00:01:42,600
functionality and the regular report

26
00:01:39,470 --> 00:01:45,420
refers port forwarding<font color="#E5E5E5"> and the river</font>

27
00:01:42,600 --> 00:01:47,169
port forwarding as well which<font color="#E5E5E5"> you won't</font>

28
00:01:45,420 --> 00:01:52,540
have if you

29
00:01:47,170 --> 00:01:55,630
like they have<font color="#E5E5E5"> disappeared back and so a</font>

30
00:01:52,540 --> 00:02:00,640
bit<font color="#E5E5E5"> of history about the project</font><font color="#CCCCCC"> it</font>

31
00:01:55,630 --> 00:02:04,830
started when the<font color="#E5E5E5"> arc fest</font><font color="#CCCCCC"> events used to</font>

32
00:02:00,640 --> 00:02:07,840
have war games the<font color="#CCCCCC"> last war games were</font>

33
00:02:04,830 --> 00:02:11,320
playing countries by<font color="#E5E5E5"> fighting each</font>

34
00:02:07,840 --> 00:02:14,910
<font color="#CCCCCC">others</font><font color="#E5E5E5"> and the first such warnings</font><font color="#CCCCCC"> I was</font>

35
00:02:11,320 --> 00:02:18,609
kicked out of<font color="#E5E5E5"> my home machine by some</font>

36
00:02:14,910 --> 00:02:22,870
adversary team<font color="#CCCCCC"> my son never gets I</font>

37
00:02:18,610 --> 00:02:27,280
started<font color="#E5E5E5"> for</font><font color="#CCCCCC"> OpenSSH</font><font color="#E5E5E5"> provide me with some</font>

38
00:02:22,870 --> 00:02:30,310
<font color="#E5E5E5">sort of</font><font color="#CCCCCC"> backdoor</font><font color="#E5E5E5"> that I could use also</font>

39
00:02:27,280 --> 00:02:35,020
defensively so if some adversary<font color="#E5E5E5"> in the</font>

40
00:02:30,310 --> 00:02:38,440
<font color="#E5E5E5">war game will infiltrate my machine and</font>

41
00:02:35,020 --> 00:02:41,709
change all the password and replace all

42
00:02:38,440 --> 00:02:44,470
<font color="#CCCCCC">their authorized key with my</font><font color="#E5E5E5"> ssh</font>

43
00:02:41,709 --> 00:02:48,400
<font color="#CCCCCC">forecasts I children will still be able</font>

44
00:02:44,470 --> 00:02:52,750
<font color="#E5E5E5">to log in and fight back and then the</font>

45
00:02:48,400 --> 00:02:55,930
first version was<font color="#CCCCCC"> based on OpenSSH but</font>

46
00:02:52,750 --> 00:03:00,459
it lacked<font color="#CCCCCC"> reversal functionality then</font>

47
00:02:55,930 --> 00:03:04,269
<font color="#CCCCCC">ice for drug pair the drop your project</font>

48
00:03:00,459 --> 00:03:06,820
<font color="#E5E5E5">that's why it's called Blackbeard and so</font>

49
00:03:04,269 --> 00:03:09,070
the<font color="#CCCCCC"> copays is symbols I could understand</font>

50
00:03:06,820 --> 00:03:12,910
the<font color="#E5E5E5"> code and</font><font color="#CCCCCC"> add the herschel</font>

51
00:03:09,070 --> 00:03:16,930
functionality but<font color="#E5E5E5"> drug bear do lack the</font>

52
00:03:12,910 --> 00:03:22,239
<font color="#CCCCCC">sux proxy for dynamic port forwarding so</font>

53
00:03:16,930 --> 00:03:24,310
I went back<font color="#CCCCCC"> to OpenSSH</font><font color="#E5E5E5"> I was became a</font>

54
00:03:22,239 --> 00:03:26,410
better programmer so I was able to

55
00:03:24,310 --> 00:03:34,890
finally understand openness

56
00:03:26,410 --> 00:03:38,859
and finish the<font color="#E5E5E5"> job so that the</font>

57
00:03:34,890 --> 00:03:41,350
functionality<font color="#CCCCCC"> talk</font><font color="#E5E5E5"> about it like you</font>

58
00:03:38,860 --> 00:03:47,980
have<font color="#E5E5E5"> to know that</font><font color="#CCCCCC"> you could use these</font>

59
00:03:41,350 --> 00:03:50,400
options<font color="#CCCCCC"> to let's say you want to use an</font>

60
00:03:47,980 --> 00:03:54,340
<font color="#E5E5E5">additional service on the target side</font>

61
00:03:50,400 --> 00:03:57,220
you will use the<font color="#E5E5E5"> capital L option to</font>

62
00:03:54,340 --> 00:04:00,490
open<font color="#E5E5E5"> a port on</font><font color="#CCCCCC"> your machine that if you</font>

63
00:03:57,220 --> 00:04:03,310
connect to it<font color="#CCCCCC"> it will</font><font color="#E5E5E5"> be it will go</font>

64
00:04:00,490 --> 00:04:05,620
through<font color="#E5E5E5"> the SSH tunnel then you will be</font>

65
00:04:03,310 --> 00:04:09,820
<font color="#CCCCCC">able</font><font color="#E5E5E5"> to reach the service on the remote</font>

66
00:04:05,620 --> 00:04:13,530
<font color="#CCCCCC">machine</font><font color="#E5E5E5"> because otherwise firewall might</font>

67
00:04:09,820 --> 00:04:16,360
prevent that connection<font color="#E5E5E5"> you may also</font>

68
00:04:13,530 --> 00:04:18,910
provide<font color="#CCCCCC"> services to the remote machine</font>

69
00:04:16,360 --> 00:04:21,160
<font color="#CCCCCC">through your connection</font><font color="#E5E5E5"> let's say you</font>

70
00:04:18,910 --> 00:04:23,410
have a connect back but from a network

71
00:04:21,160 --> 00:04:27,970
that<font color="#E5E5E5"> doesn't have</font><font color="#CCCCCC"> access to</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> internet</font>

72
00:04:23,410 --> 00:04:31,510
<font color="#E5E5E5">and you need machines from the network</font>

73
00:04:27,970 --> 00:04:34,510
to have internet access<font color="#CCCCCC"> you can</font><font color="#E5E5E5"> use the</font>

74
00:04:31,510 --> 00:04:38,320
capital<font color="#CCCCCC"> or option to open a port on the</font>

75
00:04:34,510 --> 00:04:42,010
target side<font color="#E5E5E5"> if the target side connected</font>

76
00:04:38,320 --> 00:04:44,800
<font color="#CCCCCC">they will be for forwarded to your</font>

77
00:04:42,010 --> 00:04:47,500
machine and<font color="#CCCCCC"> then you can tunnel</font><font color="#E5E5E5"> through</font>

78
00:04:44,800 --> 00:04:52,350
a proxy<font color="#CCCCCC"> and give</font><font color="#E5E5E5"> internet access to the</font>

79
00:04:47,500 --> 00:04:58,450
otherwise<font color="#E5E5E5"> enclose a restricted</font><font color="#CCCCCC"> network</font>

80
00:04:52,350 --> 00:04:59,540
so that<font color="#E5E5E5"> these functionality I wanted to</font>

81
00:04:58,450 --> 00:05:04,300
have them and

82
00:04:59,540 --> 00:05:07,340
inside my reverse shell<font color="#E5E5E5"> so of course</font>

83
00:05:04,300 --> 00:05:12,320
it's a post exploitation<font color="#CCCCCC"> tool so you</font>

84
00:05:07,340 --> 00:05:16,250
have to<font color="#E5E5E5"> have the ability to run code</font><font color="#CCCCCC"> on</font>

85
00:05:12,320 --> 00:05:19,460
<font color="#E5E5E5">the target machine after</font><font color="#CCCCCC"> have an exploit</font>

86
00:05:16,250 --> 00:05:23,810
or<font color="#CCCCCC"> login</font><font color="#E5E5E5"> or some way</font><font color="#CCCCCC"> to run code</font>

87
00:05:19,460 --> 00:05:27,500
<font color="#E5E5E5">remotely and like I said provides the</font>

88
00:05:23,810 --> 00:05:31,360
tunneling ability and I use<font color="#CCCCCC"> it</font><font color="#E5E5E5"> for</font>

89
00:05:27,500 --> 00:05:35,840
<font color="#E5E5E5">manual enumeration</font><font color="#CCCCCC"> like</font><font color="#E5E5E5"> since I have</font>

90
00:05:31,360 --> 00:05:39,470
<font color="#CCCCCC">Rigler SSH</font><font color="#E5E5E5"> can run the I can run tab I</font>

91
00:05:35,840 --> 00:05:43,239
can run any tools<font color="#E5E5E5"> that could be</font><font color="#CCCCCC"> on the</font>

92
00:05:39,470 --> 00:05:56,060
machine I use it to manually explore

93
00:05:43,240 --> 00:05:58,820
machines so the<font color="#E5E5E5"> issues that I</font>

94
00:05:56,060 --> 00:06:05,840
<font color="#E5E5E5">encountered in the development of the</font>

95
00:05:58,820 --> 00:06:09,909
<font color="#E5E5E5">the software it's like I think uttered</font>

96
00:06:05,840 --> 00:06:14,270
<font color="#E5E5E5">what they call the privilege separation</font>

97
00:06:09,910 --> 00:06:17,300
privilege separation is when the<font color="#E5E5E5"> SSH</font>

98
00:06:14,270 --> 00:06:20,299
server<font color="#CCCCCC"> receive</font><font color="#E5E5E5"> a connection is kind of</font>

99
00:06:17,300 --> 00:06:27,050
<font color="#E5E5E5">fork into two processes and it's meant</font>

100
00:06:20,300 --> 00:06:29,840
to provide<font color="#CCCCCC"> Security's prevent someone</font>

101
00:06:27,050 --> 00:06:34,570
<font color="#E5E5E5">that is reaching</font><font color="#CCCCCC"> the server</font><font color="#E5E5E5"> from</font><font color="#CCCCCC"> the net</font>

102
00:06:29,840 --> 00:06:38,210
the network reduce the<font color="#CCCCCC"> attack surface</font>

103
00:06:34,570 --> 00:06:43,099
<font color="#E5E5E5">what will happen</font><font color="#CCCCCC"> is when you connect</font><font color="#E5E5E5"> to</font>

104
00:06:38,210 --> 00:06:46,010
<font color="#E5E5E5">the</font><font color="#CCCCCC"> SSH server server will fork</font><font color="#E5E5E5"> and then</font>

105
00:06:43,100 --> 00:06:49,550
the network<font color="#E5E5E5"> code will be will drop</font>

106
00:06:46,010 --> 00:06:51,469
<font color="#CCCCCC">privilege it will change route so we</font>

107
00:06:49,550 --> 00:06:56,060
will have restricted<font color="#CCCCCC"> access</font><font color="#E5E5E5"> to the file</font>

108
00:06:51,470 --> 00:06:59,780
system<font color="#E5E5E5"> and then it will be further</font>

109
00:06:56,060 --> 00:07:02,790
restricted with technology<font color="#E5E5E5"> like second</font>

110
00:06:59,780 --> 00:07:05,760
on Linux or<font color="#CCCCCC"> players on</font>

111
00:07:02,790 --> 00:07:09,680
<font color="#CCCCCC">and</font><font color="#E5E5E5"> bsd that will restrict the the</font>

112
00:07:05,760 --> 00:07:13,800
<font color="#E5E5E5">system calls that can be made from that</font>

113
00:07:09,680 --> 00:07:16,380
process<font color="#E5E5E5"> that restricted process and and</font>

114
00:07:13,800 --> 00:07:19,770
the<font color="#E5E5E5"> third process would be created there</font>

115
00:07:16,380 --> 00:07:22,880
is<font color="#CCCCCC"> the privilege one and that privilege</font>

116
00:07:19,770 --> 00:07:25,310
process will be responsible for

117
00:07:22,880 --> 00:07:28,159
authenticating the user so it will

118
00:07:25,310 --> 00:07:30,150
receive the password or receive

119
00:07:28,160 --> 00:07:35,670
credential<font color="#E5E5E5"> and</font><font color="#CCCCCC"> need authentication</font>

120
00:07:30,150 --> 00:07:37,919
<font color="#E5E5E5">tokens or</font><font color="#CCCCCC"> will challenge if the user is</font>

121
00:07:35,670 --> 00:07:41,010
using a key pair will challenge the user

122
00:07:37,920 --> 00:07:44,490
to prove that the required private key

123
00:07:41,010 --> 00:07:46,170
and<font color="#CCCCCC"> both processes</font><font color="#E5E5E5"> do communicate with</font>

124
00:07:44,490 --> 00:07:51,000
each other<font color="#E5E5E5"> more on</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> later</font>

125
00:07:46,170 --> 00:07:54,840
<font color="#E5E5E5">that could be abused as well and also I</font>

126
00:07:51,000 --> 00:07:55,890
I did try not to use the<font color="#E5E5E5"> disk on the</font>

127
00:07:54,840 --> 00:08:00,390
target side

128
00:07:55,890 --> 00:08:02,520
so I did<font color="#E5E5E5"> want</font><font color="#CCCCCC"> to bypass</font><font color="#E5E5E5"> any account</font>

129
00:08:00,390 --> 00:08:05,669
restriction let's say you<font color="#E5E5E5"> are attacking</font>

130
00:08:02,520 --> 00:08:08,820
<font color="#E5E5E5">a web server the account the web server</font>

131
00:08:05,670 --> 00:08:12,060
is<font color="#CCCCCC"> running on</font><font color="#E5E5E5"> often as its shell</font><font color="#CCCCCC"> set to</font>

132
00:08:08,820 --> 00:08:15,620
<font color="#CCCCCC">build falls or build again and there are</font>

133
00:08:12,060 --> 00:08:19,380
also other configuration to restrict

134
00:08:15,620 --> 00:08:22,110
access<font color="#CCCCCC"> to those system accounts so I</font>

135
00:08:19,380 --> 00:08:26,490
wanted to bypass<font color="#CCCCCC"> that and I wanted</font><font color="#E5E5E5"> to</font>

136
00:08:22,110 --> 00:08:29,840
<font color="#E5E5E5">leave as little</font><font color="#CCCCCC"> log as possible and I</font>

137
00:08:26,490 --> 00:08:33,330
wanted<font color="#CCCCCC"> that to depend on the target work</font>

138
00:08:29,840 --> 00:08:35,760
authentication mechanisms<font color="#E5E5E5"> so I don't use</font>

139
00:08:33,330 --> 00:08:39,419
the target<font color="#E5E5E5"> password databases I don't</font>

140
00:08:35,760 --> 00:08:42,539
use<font color="#E5E5E5"> too risky on the target actually the</font>

141
00:08:39,419 --> 00:08:46,260
authentication is done<font color="#E5E5E5"> with a key pair</font>

142
00:08:42,539 --> 00:08:50,939
but<font color="#E5E5E5"> the public key is embedded inside</font>

143
00:08:46,260 --> 00:08:53,480
<font color="#CCCCCC">the binary</font><font color="#E5E5E5"> it's not on the binary that</font>

144
00:08:50,940 --> 00:08:59,080
you will upload but not on the

145
00:08:53,480 --> 00:09:03,140
and finally this issue is when I do

146
00:08:59,080 --> 00:09:07,100
upload the sshd binary to the target

147
00:09:03,140 --> 00:09:10,730
<font color="#CCCCCC">have to upload it and then to toggle the</font>

148
00:09:07,100 --> 00:09:14,060
<font color="#E5E5E5">execute execute bit on the binary like</font>

149
00:09:10,730 --> 00:09:19,160
do change model it and then to run it

150
00:09:14,060 --> 00:09:22,459
with proper arguments<font color="#E5E5E5"> so I wanted</font><font color="#CCCCCC"> to</font>

151
00:09:19,160 --> 00:09:27,500
streamline<font color="#E5E5E5"> that process so I discovered</font>

152
00:09:22,460 --> 00:09:31,370
<font color="#CCCCCC">that I could</font><font color="#E5E5E5"> also make</font><font color="#CCCCCC"> the sshd</font><font color="#E5E5E5"> a bash</font>

153
00:09:27,500 --> 00:09:34,130
<font color="#CCCCCC">script</font><font color="#E5E5E5"> so it it's a bash grip and</font><font color="#CCCCCC"> ILF</font>

154
00:09:31,370 --> 00:09:36,530
file at once<font color="#E5E5E5"> so the bash script that is</font>

155
00:09:34,130 --> 00:09:40,640
embedded<font color="#E5E5E5"> and the binary will take care</font>

156
00:09:36,530 --> 00:09:44,150
<font color="#E5E5E5">of the change mode will turn on the</font>

157
00:09:40,640 --> 00:09:49,010
<font color="#E5E5E5">execute bit then run it with</font><font color="#CCCCCC"> the</font>

158
00:09:44,150 --> 00:09:53,840
supplied arguments so first the

159
00:09:49,010 --> 00:09:58,610
privilege version<font color="#CCCCCC"> I</font><font color="#E5E5E5"> talked</font><font color="#CCCCCC"> about</font><font color="#E5E5E5"> it's</font>

160
00:09:53,840 --> 00:10:03,830
like well for with what for both<font color="#E5E5E5"> two</font>

161
00:09:58,610 --> 00:10:07,850
processes<font color="#CCCCCC"> one that is talking with</font><font color="#E5E5E5"> the</font>

162
00:10:03,830 --> 00:10:11,150
network<font color="#E5E5E5"> that is every restricted change</font>

163
00:10:07,850 --> 00:10:14,510
route with<font color="#CCCCCC"> a Content force</font><font color="#E5E5E5"> and the other</font>

164
00:10:11,150 --> 00:10:17,390
<font color="#E5E5E5">privilege process which is called</font><font color="#CCCCCC"> a</font>

165
00:10:14,510 --> 00:10:22,430
monitor most of the<font color="#E5E5E5"> privilege process</font>

166
00:10:17,390 --> 00:10:26,500
code<font color="#CCCCCC"> isn't monitored</font><font color="#E5E5E5"> see file and these</font>

167
00:10:22,430 --> 00:10:32,300
two communicate<font color="#E5E5E5"> over a defined protocol</font>

168
00:10:26,500 --> 00:10:35,990
<font color="#E5E5E5">over a UNIX socket and my is</font><font color="#CCCCCC"> surprised</font>

169
00:10:32,300 --> 00:10:38,209
people<font color="#E5E5E5"> but the information that is sent</font>

170
00:10:35,990 --> 00:10:42,620
and received over that socket<font color="#E5E5E5"> is in the</font>

171
00:10:38,210 --> 00:10:47,210
clear so if you try to eavesdrop the

172
00:10:42,620 --> 00:10:50,120
network on the right side the

173
00:10:47,210 --> 00:10:53,180
information is encrypted<font color="#E5E5E5"> but if you</font>

174
00:10:50,120 --> 00:10:55,310
attempt to eavesdrop on the UNIX socket

175
00:10:53,180 --> 00:10:57,969
that connect both the<font color="#E5E5E5"> privilege and the</font>

176
00:10:55,310 --> 00:11:02,449
unprivileged process<font color="#E5E5E5"> then you have</font>

177
00:10:57,970 --> 00:11:08,579
<font color="#E5E5E5">access to clear text credentials</font>

178
00:11:02,449 --> 00:11:11,870
so how it works is in the<font color="#CCCCCC"> priviledge</font><font color="#E5E5E5"> the</font>

179
00:11:08,579 --> 00:11:16,469
unprivileged process<font color="#E5E5E5"> the code will call</font>

180
00:11:11,870 --> 00:11:19,769
<font color="#E5E5E5">mmm</font><font color="#CCCCCC"> request send</font><font color="#E5E5E5"> to send data over the</font>

181
00:11:16,470 --> 00:11:22,499
socket<font color="#E5E5E5"> and then the</font><font color="#CCCCCC"> privileged process</font>

182
00:11:19,769 --> 00:11:27,920
will receive that request with<font color="#E5E5E5"> the</font>

183
00:11:22,499 --> 00:11:31,110
credential<font color="#E5E5E5"> will validate and will answer</font>

184
00:11:27,920 --> 00:11:34,670
with<font color="#E5E5E5"> mmm answered old password to see</font>

185
00:11:31,110 --> 00:11:38,550
the account is authenticated<font color="#E5E5E5"> or not</font>

186
00:11:34,670 --> 00:11:43,199
after the password has been<font color="#E5E5E5"> validated</font>

187
00:11:38,550 --> 00:11:49,399
<font color="#CCCCCC">but we can eavesdrop on that you can</font>

188
00:11:43,199 --> 00:11:53,758
test with the PS and the SS tools so

189
00:11:49,399 --> 00:11:57,300
this screen capture has been made right

190
00:11:53,759 --> 00:11:59,790
<font color="#CCCCCC">after a client</font><font color="#E5E5E5"> do connect but before the</font>

191
00:11:57,300 --> 00:12:02,639
user actually<font color="#CCCCCC"> entered the password so</font>

192
00:11:59,790 --> 00:12:07,230
let's say you have root access on a

193
00:12:02,639 --> 00:12:09,509
<font color="#CCCCCC">machine and from</font><font color="#E5E5E5"> another machine you you</font>

194
00:12:07,230 --> 00:12:11,939
connect to it<font color="#CCCCCC"> with SSH you'll get the</font>

195
00:12:09,509 --> 00:12:16,050
password prompt<font color="#E5E5E5"> you don't enter</font><font color="#CCCCCC"> anything</font>

196
00:12:11,939 --> 00:12:21,329
you go back on your your machine<font color="#E5E5E5"> and you</font>

197
00:12:16,050 --> 00:12:25,529
use PS<font color="#CCCCCC"> you'll see the two sshd child</font>

198
00:12:21,329 --> 00:12:28,529
processes<font color="#E5E5E5"> the privileged one you'll see</font>

199
00:12:25,529 --> 00:12:31,980
proof<font color="#E5E5E5"> within square brackets and the</font>

200
00:12:28,529 --> 00:12:35,069
network part<font color="#E5E5E5"> of it you'll see net into</font>

201
00:12:31,980 --> 00:12:40,709
the square brackets so you<font color="#E5E5E5"> can get the</font>

202
00:12:35,069 --> 00:12:45,959
PID<font color="#E5E5E5"> 1364 the</font><font color="#CCCCCC"> privileged</font><font color="#E5E5E5"> 130 1361 for the</font>

203
00:12:40,709 --> 00:12:48,809
network code and using<font color="#CCCCCC"> the</font><font color="#E5E5E5"> SS tool you</font>

204
00:12:45,959 --> 00:12:54,300
can integrate<font color="#CCCCCC"> intermarried unique</font>

205
00:12:48,809 --> 00:12:58,290
sockets<font color="#CCCCCC"> that are used by these processes</font>

206
00:12:54,300 --> 00:12:59,769
<font color="#E5E5E5">so from the privileged size the file</font>

207
00:12:58,290 --> 00:13:03,160
descriptor<font color="#E5E5E5"> of the socket</font>

208
00:12:59,769 --> 00:13:05,829
the file descriptor<font color="#CCCCCC"> six and from the</font>

209
00:13:03,160 --> 00:13:09,939
<font color="#CCCCCC">network side is it is file descriptor</font>

210
00:13:05,829 --> 00:13:13,449
for so then you see the pipe that does

211
00:13:09,939 --> 00:13:17,670
link the two<font color="#E5E5E5"> and I</font><font color="#CCCCCC"> made quite</font><font color="#E5E5E5"> a few</font>

212
00:13:13,449 --> 00:13:22,049
experiment<font color="#E5E5E5"> and if I monitor the</font>

213
00:13:17,670 --> 00:13:25,420
<font color="#CCCCCC">privilege process to try to gather</font>

214
00:13:22,049 --> 00:13:28,720
credential<font color="#CCCCCC"> I notice that</font><font color="#E5E5E5"> the file</font>

215
00:13:25,420 --> 00:13:33,309
descriptor which<font color="#E5E5E5"> I can get them from is</font>

216
00:13:28,720 --> 00:13:37,089
pretty much always<font color="#E5E5E5"> six might be</font>

217
00:13:33,309 --> 00:13:42,339
different but my experience<font color="#E5E5E5"> I got</font><font color="#CCCCCC"> a lot</font>

218
00:13:37,089 --> 00:13:46,660
<font color="#CCCCCC">of success with six so you can get a</font>

219
00:13:42,339 --> 00:13:50,949
credential<font color="#CCCCCC"> like let's say overnight over</font>

220
00:13:46,660 --> 00:13:54,279
a few days for<font color="#E5E5E5"> as long as</font><font color="#CCCCCC"> you want</font><font color="#E5E5E5"> and</font>

221
00:13:50,949 --> 00:13:57,910
you<font color="#CCCCCC"> can</font><font color="#E5E5E5"> do it with Astraeus if it did</font>

222
00:13:54,279 --> 00:14:00,009
<font color="#E5E5E5">it's installed on the machine</font><font color="#CCCCCC"> you can</font>

223
00:13:57,910 --> 00:14:04,240
also do it with<font color="#E5E5E5"> other tools there</font><font color="#CCCCCC"> is a</font>

224
00:14:00,009 --> 00:14:08,170
tool and it's called<font color="#E5E5E5"> trees</font><font color="#CCCCCC"> light like</font>

225
00:14:04,240 --> 00:14:10,779
<font color="#CCCCCC">Belden</font><font color="#E5E5E5"> wrote it and that tool will do it</font>

226
00:14:08,170 --> 00:14:14,170
will<font color="#E5E5E5"> extract password and show you the</font>

227
00:14:10,779 --> 00:14:16,749
password automatically but I prefer<font color="#CCCCCC"> to</font>

228
00:14:14,170 --> 00:14:21,009
use<font color="#CCCCCC"> Astraeus</font><font color="#E5E5E5"> if it's already installed</font>

229
00:14:16,749 --> 00:14:23,679
<font color="#CCCCCC">and</font><font color="#E5E5E5"> I will avoid to upload</font><font color="#CCCCCC"> a binary</font><font color="#E5E5E5"> on</font>

230
00:14:21,009 --> 00:14:26,319
the machine<font color="#CCCCCC"> and the point is your</font><font color="#E5E5E5"> route</font>

231
00:14:23,679 --> 00:14:29,199
already<font color="#CCCCCC"> like if you can't do that that</font>

232
00:14:26,319 --> 00:14:33,040
means<font color="#E5E5E5"> that you</font><font color="#CCCCCC"> you already compromised</font>

233
00:14:29,199 --> 00:14:37,209
that machine<font color="#E5E5E5"> but what you want to do is</font>

234
00:14:33,040 --> 00:14:42,248
to collect<font color="#E5E5E5"> and perhaps reuse</font><font color="#CCCCCC"> credentials</font>

235
00:14:37,209 --> 00:14:47,998
so<font color="#E5E5E5"> if you wait for</font><font color="#CCCCCC"> sustainance trader to</font>

236
00:14:42,249 --> 00:14:47,999
login<font color="#E5E5E5"> so yeah the whole time</font>

237
00:14:48,360 --> 00:14:54,230
it's this one

238
00:14:59,089 --> 00:15:12,050
I'm route<font color="#CCCCCC"> already on virtual machine</font>

239
00:15:04,179 --> 00:15:17,449
like the the<font color="#E5E5E5"> IP is 192 168 1</font><font color="#CCCCCC"> 22 17</font><font color="#E5E5E5"> and</font>

240
00:15:12,050 --> 00:15:20,299
then I<font color="#E5E5E5"> look for</font><font color="#CCCCCC"> the PID of</font><font color="#E5E5E5"> the main</font><font color="#CCCCCC"> sh t</font>

241
00:15:17,449 --> 00:15:25,368
demon<font color="#E5E5E5"> so that's the one that is</font><font color="#CCCCCC"> actually</font>

242
00:15:20,299 --> 00:15:28,360
listening<font color="#CCCCCC"> on port 22 often you'll see</font><font color="#E5E5E5"> if</font>

243
00:15:25,369 --> 00:15:33,139
you grab force HD<font color="#CCCCCC"> you'll</font><font color="#E5E5E5"> see a lot of</font>

244
00:15:28,360 --> 00:15:36,350
<font color="#E5E5E5">sshd processes you want to target</font><font color="#CCCCCC"> that</font>

245
00:15:33,139 --> 00:15:43,339
one<font color="#E5E5E5"> that is listening</font><font color="#CCCCCC"> to the main</font>

246
00:15:36,350 --> 00:15:49,879
<font color="#E5E5E5">service port so I'm running a trace and</font>

247
00:15:43,339 --> 00:15:52,069
then I'm logging in as<font color="#CCCCCC"> seven I use a</font>

248
00:15:49,879 --> 00:15:57,319
long password password are getting

249
00:15:52,069 --> 00:16:00,589
longer<font color="#CCCCCC"> longer these days so I'm</font><font color="#E5E5E5"> typing</font>

250
00:15:57,319 --> 00:16:05,240
the password<font color="#E5E5E5"> in and then what as I hit</font>

251
00:16:00,589 --> 00:16:10,399
enter<font color="#CCCCCC"> its generate a log</font><font color="#E5E5E5"> a lot</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> log</font>

252
00:16:05,240 --> 00:16:13,850
files<font color="#E5E5E5"> so I I grab for SSH connection to</font>

253
00:16:10,399 --> 00:16:18,949
locate the file in which<font color="#CCCCCC"> the credential</font>

254
00:16:13,850 --> 00:16:22,579
will be logged and when you find<font color="#E5E5E5"> that</font>

255
00:16:18,949 --> 00:16:26,089
string inside the<font color="#CCCCCC"> s trace the the log</font>

256
00:16:22,579 --> 00:16:28,160
father be generated by us<font color="#CCCCCC"> trace and you</font>

257
00:16:26,089 --> 00:16:36,100
<font color="#CCCCCC">look for that string</font><font color="#E5E5E5"> and the password</font>

258
00:16:28,160 --> 00:16:36,100
<font color="#CCCCCC">will be</font><font color="#E5E5E5"> a few line below so it is</font>

259
00:16:36,260 --> 00:16:45,270
that's how one can abuse<font color="#E5E5E5"> privilege</font>

260
00:16:40,370 --> 00:16:47,390
separation of<font color="#CCCCCC"> OpenSSH so back to</font><font color="#E5E5E5"> the</font>

261
00:16:45,270 --> 00:16:47,390
slides

262
00:16:49,220 --> 00:16:59,810
<font color="#CCCCCC">alright so then I wanted to avoid the</font>

263
00:16:56,250 --> 00:17:03,900
<font color="#CCCCCC">disc on the target side</font><font color="#E5E5E5"> and also avoid</font>

264
00:16:59,810 --> 00:17:07,619
logging and<font color="#CCCCCC"> again restriction so I</font>

265
00:17:03,900 --> 00:17:10,650
<font color="#E5E5E5">disabled the</font><font color="#CCCCCC"> Noll again check so like</font>

266
00:17:07,619 --> 00:17:14,639
there's a configuration<font color="#CCCCCC"> file you can</font>

267
00:17:10,650 --> 00:17:19,020
<font color="#E5E5E5">deny access to some user and sshd so</font><font color="#CCCCCC"> I</font>

268
00:17:14,640 --> 00:17:21,600
<font color="#E5E5E5">disable that so if my sshd daemon runs</font>

269
00:17:19,020 --> 00:17:25,760
on a server<font color="#CCCCCC"> even though that</font><font color="#E5E5E5"> files</font><font color="#CCCCCC"> there</font>

270
00:17:21,599 --> 00:17:28,740
<font color="#CCCCCC">and the find out in the earth and also</font>

271
00:17:25,760 --> 00:17:33,690
<font color="#CCCCCC">ways make sure</font><font color="#E5E5E5"> that the shell that</font>

272
00:17:28,740 --> 00:17:36,960
you'll<font color="#E5E5E5"> get is been</font><font color="#CCCCCC"> SH I wanted</font><font color="#E5E5E5"> to use</font>

273
00:17:33,690 --> 00:17:38,730
bash I prefer bash but I'm not<font color="#E5E5E5"> sure bash</font>

274
00:17:36,960 --> 00:17:41,550
is present on all systems

275
00:17:38,730 --> 00:17:42,830
<font color="#CCCCCC">so</font><font color="#E5E5E5"> I thought I was safer to</font><font color="#CCCCCC"> use blue</font><font color="#E5E5E5"> a</font>

276
00:17:41,550 --> 00:17:47,639
message

277
00:17:42,830 --> 00:17:51,320
it's<font color="#E5E5E5"> ND</font><font color="#CCCCCC"> if the share of the user</font><font color="#E5E5E5"> that is</font>

278
00:17:47,640 --> 00:17:56,430
compromised as a triple<font color="#E5E5E5"> w</font><font color="#CCCCCC"> data and who's</font>

279
00:17:51,320 --> 00:17:59,960
knoll again like I said<font color="#E5E5E5"> the</font>

280
00:17:56,430 --> 00:18:06,240
authorization is done with<font color="#E5E5E5"> public keys</font>

281
00:17:59,960 --> 00:18:11,460
and the key is embedded in

282
00:18:06,240 --> 00:18:14,970
binary so<font color="#E5E5E5"> I modified</font><font color="#CCCCCC"> the mic file</font><font color="#E5E5E5"> so</font>

283
00:18:11,460 --> 00:18:18,150
when you build<font color="#E5E5E5"> the</font><font color="#CCCCCC"> project it will</font>

284
00:18:14,970 --> 00:18:22,440
generate a key pair which are called<font color="#E5E5E5"> ID</font>

285
00:18:18,150 --> 00:18:27,120
<font color="#CCCCCC">black bear and it will create a</font><font color="#E5E5E5"> C file</font>

286
00:18:22,440 --> 00:18:30,560
<font color="#CCCCCC">pop Keys dot</font><font color="#E5E5E5"> C we see it here and</font><font color="#CCCCCC"> we'll</font>

287
00:18:27,120 --> 00:18:34,800
<font color="#E5E5E5">embed the public key in a character re</font>

288
00:18:30,560 --> 00:18:38,639
<font color="#CCCCCC">do notice the</font><font color="#E5E5E5"> no pointer at</font><font color="#CCCCCC"> DM they as</font>

289
00:18:34,800 --> 00:18:41,210
well tell my my code to<font color="#E5E5E5"> stop looking for</font>

290
00:18:38,640 --> 00:18:46,650
<font color="#CCCCCC">keys so you</font><font color="#E5E5E5"> can have your own keys and</font>

291
00:18:41,210 --> 00:18:53,280
rebuild<font color="#E5E5E5"> but make sure</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> no pointer is</font>

292
00:18:46,650 --> 00:18:55,710
there<font color="#E5E5E5"> I did replace the usual code that</font>

293
00:18:53,280 --> 00:18:59,310
is designed to<font color="#E5E5E5"> read keys from authorized</font>

294
00:18:55,710 --> 00:19:04,830
key file<font color="#CCCCCC"> disk with that</font><font color="#E5E5E5"> function</font><font color="#CCCCCC"> Ritchie</font>

295
00:18:59,310 --> 00:19:07,500
<font color="#CCCCCC">five men</font><font color="#E5E5E5"> which reaches</font><font color="#CCCCCC"> from the re</font><font color="#E5E5E5"> so</font>

296
00:19:04,830 --> 00:19:12,480
that's our authorization work with<font color="#E5E5E5"> back</font>

297
00:19:07,500 --> 00:19:16,800
<font color="#E5E5E5">there also</font><font color="#CCCCCC"> the configuration</font><font color="#E5E5E5"> of the SSH</font>

298
00:19:12,480 --> 00:19:21,110
daemon<font color="#E5E5E5"> is</font><font color="#CCCCCC"> also</font><font color="#E5E5E5"> embedded you can modify</font>

299
00:19:16,800 --> 00:19:27,030
it by editing<font color="#CCCCCC"> serve cannot see and</font>

300
00:19:21,110 --> 00:19:29,850
recompile<font color="#E5E5E5"> so that's that way I don't</font>

301
00:19:27,030 --> 00:19:34,020
have to<font color="#CCCCCC"> rely on</font><font color="#E5E5E5"> configuration file on</font>

302
00:19:29,850 --> 00:19:36,990
the target side and I also turn<font color="#CCCCCC"> on you</font>

303
00:19:34,020 --> 00:19:41,639
know the<font color="#CCCCCC"> gateway port option when you</font>

304
00:19:36,990 --> 00:19:46,010
use capital<font color="#CCCCCC"> R to expose</font><font color="#E5E5E5"> a port on</font><font color="#CCCCCC"> a</font>

305
00:19:41,640 --> 00:19:49,320
target side and<font color="#CCCCCC"> to</font><font color="#E5E5E5"> Ford it on your side</font>

306
00:19:46,010 --> 00:19:52,350
usually by default<font color="#E5E5E5"> your your restricted</font>

307
00:19:49,320 --> 00:19:56,320
<font color="#CCCCCC">Duty look back at your face so you</font>

308
00:19:52,350 --> 00:20:00,428
<font color="#E5E5E5">cannot let's say your target</font>

309
00:19:56,320 --> 00:20:03,129
<font color="#E5E5E5">as network interface and they will</font>

310
00:20:00,429 --> 00:20:06,340
expose our network you cannot serve a

311
00:20:03,130 --> 00:20:10,259
port to these<font color="#E5E5E5"> network you can only serve</font>

312
00:20:06,340 --> 00:20:14,019
<font color="#CCCCCC">to look back so I turn gateway port on</font>

313
00:20:10,259 --> 00:20:16,929
so with black bear<font color="#E5E5E5"> you can expose port</font>

314
00:20:14,019 --> 00:20:24,730
on our network interfaces<font color="#CCCCCC"> on the remote</font>

315
00:20:16,929 --> 00:20:26,500
<font color="#CCCCCC">system finally like the</font><font color="#E5E5E5"> the old keys are</font>

316
00:20:24,730 --> 00:20:30,399
generated<font color="#E5E5E5"> on the fly</font>

317
00:20:26,500 --> 00:20:34,000
that's a remnant of the<font color="#E5E5E5"> whole design so</font>

318
00:20:30,399 --> 00:20:39,939
I didn't want<font color="#E5E5E5"> to use host keys on disk</font>

319
00:20:34,000 --> 00:20:42,549
<font color="#CCCCCC">so I</font><font color="#E5E5E5"> copied code from the ssh-keygen you</font>

320
00:20:39,940 --> 00:20:46,600
know that that part is responsible<font color="#E5E5E5"> for</font>

321
00:20:42,549 --> 00:20:49,809
<font color="#CCCCCC">generate in key pairs</font><font color="#E5E5E5"> that be all skis</font>

322
00:20:46,600 --> 00:20:53,699
<font color="#E5E5E5">are user keys so I copied that generate</font>

323
00:20:49,809 --> 00:20:58,509
the code responsible for key generation

324
00:20:53,700 --> 00:21:03,759
<font color="#E5E5E5">into the sshd binary but there's one big</font>

325
00:20:58,509 --> 00:21:07,809
<font color="#E5E5E5">issue as I'd like you'll never know if</font>

326
00:21:03,759 --> 00:21:10,240
the<font color="#E5E5E5"> the host key is good or not</font><font color="#CCCCCC"> so that</font>

327
00:21:07,809 --> 00:21:14,110
makes the software vulnerable to man the

328
00:21:10,240 --> 00:21:18,159
module attack and so I recently

329
00:21:14,110 --> 00:21:21,549
developed<font color="#E5E5E5"> the code for compile time</font>

330
00:21:18,159 --> 00:21:24,879
generation of user keys<font color="#E5E5E5"> so I should use</font>

331
00:21:21,549 --> 00:21:27,340
<font color="#CCCCCC">the same course</font><font color="#E5E5E5"> the same code for all</font>

332
00:21:24,879 --> 00:21:29,699
<font color="#CCCCCC">keys as</font><font color="#E5E5E5"> well that is a fix</font><font color="#CCCCCC"> that is</font>

333
00:21:27,340 --> 00:21:29,699
coming

334
00:21:30,120 --> 00:21:41,070
and I wanted<font color="#CCCCCC"> to have to deliver</font><font color="#E5E5E5"> or</font>

335
00:21:37,030 --> 00:21:44,230
effectively<font color="#E5E5E5"> the binary so as tired of</font>

336
00:21:41,070 --> 00:21:46,980
downloading it's like let's say you have

337
00:21:44,230 --> 00:21:50,140
a web shell<font color="#E5E5E5"> you have to send a</font><font color="#CCCCCC"> request</font>

338
00:21:46,980 --> 00:21:53,740
<font color="#E5E5E5">download</font><font color="#CCCCCC"> the binary</font><font color="#E5E5E5"> send the second</font>

339
00:21:50,140 --> 00:21:56,890
request<font color="#E5E5E5"> to turn on executable bit and</font>

340
00:21:53,740 --> 00:21:59,770
then send the third request to run the

341
00:21:56,890 --> 00:22:02,740
binary with the arguments you want<font color="#E5E5E5"> so I</font>

342
00:21:59,770 --> 00:22:07,170
wanted<font color="#CCCCCC"> to streamline</font><font color="#E5E5E5"> that process so I</font>

343
00:22:02,740 --> 00:22:13,380
found a<font color="#CCCCCC"> way to include a bash</font><font color="#E5E5E5"> script</font>

344
00:22:07,170 --> 00:22:14,980
<font color="#CCCCCC">inside the e.l.f binary</font><font color="#E5E5E5"> sort of like the</font>

345
00:22:13,380 --> 00:22:17,170
<font color="#CCCCCC">proof-of-concept</font>

346
00:22:14,980 --> 00:22:20,280
<font color="#E5E5E5">or get the out vacation are doing</font>

347
00:22:17,170 --> 00:22:23,440
with their magazines<font color="#CCCCCC"> it's like it's a</font>

348
00:22:20,280 --> 00:22:27,129
polyglot file or<font color="#E5E5E5"> a file can be a</font>

349
00:22:23,440 --> 00:22:32,260
multiple<font color="#E5E5E5"> time at once so I did look at</font>

350
00:22:27,130 --> 00:22:39,160
the yeah<font color="#E5E5E5"> half adder to find places</font><font color="#CCCCCC"> where</font>

351
00:22:32,260 --> 00:22:44,010
I could include my shell script<font color="#E5E5E5"> and if</font>

352
00:22:39,160 --> 00:22:49,030
you try<font color="#E5E5E5"> to first I've tried to pipe my</font>

353
00:22:44,010 --> 00:22:54,940
sshd binary<font color="#CCCCCC"> into bash and then I noticed</font>

354
00:22:49,030 --> 00:22:58,810
<font color="#CCCCCC">that it will fail but later it's like it</font>

355
00:22:54,940 --> 00:23:03,610
will go through like the first<font color="#E5E5E5"> 300 bytes</font>

356
00:22:58,810 --> 00:23:10,300
<font color="#CCCCCC">and</font><font color="#E5E5E5"> it will fail the first parent</font><font color="#CCCCCC"> is in</font>

357
00:23:03,610 --> 00:23:15,850
one encounter<font color="#E5E5E5"> so bash can actually is</font>

358
00:23:10,300 --> 00:23:19,240
<font color="#E5E5E5">actually permissive so you will absorb a</font>

359
00:23:15,850 --> 00:23:20,189
lot of<font color="#E5E5E5"> different bytes before will</font><font color="#CCCCCC"> bail</font>

360
00:23:19,240 --> 00:23:24,360
<font color="#CCCCCC">out</font>

361
00:23:20,190 --> 00:23:26,700
<font color="#CCCCCC">a syntax error so I did I did profit</font>

362
00:23:24,360 --> 00:23:32,699
from that<font color="#E5E5E5"> and I also did profit from the</font>

363
00:23:26,700 --> 00:23:36,179
fact that inside<font color="#E5E5E5"> the</font><font color="#CCCCCC"> FI letter</font><font color="#E5E5E5"> several</font>

364
00:23:32,700 --> 00:23:40,860
<font color="#CCCCCC">bites that</font><font color="#E5E5E5"> are unused so I use that</font>

365
00:23:36,179 --> 00:23:45,210
small amount of<font color="#E5E5E5"> space as a code cave to</font>

366
00:23:40,860 --> 00:23:50,939
include<font color="#CCCCCC"> an</font><font color="#E5E5E5"> here document so I used here</font>

367
00:23:45,210 --> 00:23:55,950
document to make<font color="#E5E5E5"> bash when I pipe sshd</font><font color="#CCCCCC"> I</font>

368
00:23:50,940 --> 00:23:59,360
make it ignore whatever is between<font color="#E5E5E5"> my</font>

369
00:23:55,950 --> 00:24:03,389
here document inside the<font color="#E5E5E5"> father and the</font>

370
00:23:59,360 --> 00:24:06,209
<font color="#E5E5E5">closing tag of the here document right</font>

371
00:24:03,389 --> 00:24:10,110
before my script that I include as

372
00:24:06,210 --> 00:24:12,899
another character<font color="#CCCCCC"> re</font><font color="#E5E5E5"> so we see here</font><font color="#CCCCCC"> I</font>

373
00:24:10,110 --> 00:24:17,758
wrote a<font color="#CCCCCC"> Python script that will patch</font>

374
00:24:12,899 --> 00:24:22,918
sshd to add here document inside the<font color="#CCCCCC"> enf</font>

375
00:24:17,759 --> 00:24:26,129
father and the the lower part of<font color="#E5E5E5"> the</font>

376
00:24:22,919 --> 00:24:30,179
screen<font color="#E5E5E5"> capture is</font><font color="#CCCCCC"> the river shell dot c</font>

377
00:24:26,129 --> 00:24:33,779
file had<font color="#CCCCCC"> that</font><font color="#E5E5E5"> character re which he</font>

378
00:24:30,179 --> 00:24:38,039
<font color="#E5E5E5">killed the closing part then the actual</font>

379
00:24:33,779 --> 00:24:42,509
bash script that will receive arguments

380
00:24:38,039 --> 00:24:48,539
from<font color="#CCCCCC"> the environment and they will turn</font>

381
00:24:42,509 --> 00:24:51,779
<font color="#CCCCCC">on the execute bit</font><font color="#E5E5E5"> then run the</font><font color="#CCCCCC"> the sshd</font>

382
00:24:48,539 --> 00:24:57,919
binary so that's that<font color="#E5E5E5"> is when the</font><font color="#CCCCCC"> enf</font>

383
00:24:51,779 --> 00:24:57,919
takes over demo<font color="#E5E5E5"> time</font>

384
00:25:08,440 --> 00:25:16,080
let's say the<font color="#E5E5E5"> the program is compiled</font>

385
00:25:12,310 --> 00:25:20,550
I run the Python<font color="#CCCCCC"> script to patch it and</font>

386
00:25:16,080 --> 00:25:24,909
then I'll move it to a location<font color="#E5E5E5"> which</font>

387
00:25:20,550 --> 00:25:28,480
from which I will<font color="#E5E5E5"> serve</font><font color="#CCCCCC"> it to the</font>

388
00:25:24,910 --> 00:25:32,190
network<font color="#CCCCCC"> so the target can reach it so I</font>

389
00:25:28,480 --> 00:25:35,440
use a<font color="#CCCCCC"> Python HTTP server to serve it</font>

390
00:25:32,190 --> 00:25:40,510
<font color="#E5E5E5">then I will</font><font color="#CCCCCC"> vote the client</font><font color="#E5E5E5"> you'll</font>

391
00:25:35,440 --> 00:25:43,240
notice I had the - our flag<font color="#E5E5E5"> to specify a</font>

392
00:25:40,510 --> 00:25:46,900
lesson address so that that tells the

393
00:25:43,240 --> 00:25:49,210
client<font color="#E5E5E5"> that they will need</font><font color="#CCCCCC"> to listen</font><font color="#E5E5E5"> for</font>

394
00:25:46,900 --> 00:25:52,750
<font color="#CCCCCC">our connection instead</font><font color="#E5E5E5"> of trying to make</font>

395
00:25:49,210 --> 00:25:57,940
a connection<font color="#E5E5E5"> and also</font><font color="#CCCCCC"> I included an</font>

396
00:25:52,750 --> 00:26:03,190
<font color="#CCCCCC">example and</font><font color="#E5E5E5"> remit</font><font color="#CCCCCC"> that every father I</font>

397
00:25:57,940 --> 00:26:06,040
will use against<font color="#CCCCCC"> a webserver I poke</font><font color="#E5E5E5"> the</font>

398
00:26:03,190 --> 00:26:12,040
client<font color="#CCCCCC"> you</font><font color="#E5E5E5"> have to specify the key just</font>

399
00:26:06,040 --> 00:26:17,830
as you will do usually<font color="#CCCCCC"> and I just made a</font>

400
00:26:12,040 --> 00:26:20,770
mistake<font color="#CCCCCC"> I need to use - P the regular -</font>

401
00:26:17,830 --> 00:26:23,169
<font color="#E5E5E5">P will allow you to</font><font color="#CCCCCC"> specify</font><font color="#E5E5E5"> the port so</font>

402
00:26:20,770 --> 00:26:27,010
then the client is listening for<font color="#CCCCCC"> our</font>

403
00:26:23,170 --> 00:26:30,610
connection<font color="#CCCCCC"> I</font><font color="#E5E5E5"> just copy and paste the</font>

404
00:26:27,010 --> 00:26:35,320
command inside<font color="#CCCCCC"> damn vulnerable web</font>

405
00:26:30,610 --> 00:26:40,050
application and when<font color="#E5E5E5"> I had submit I get</font>

406
00:26:35,320 --> 00:26:44,200
a connect back then from there<font color="#E5E5E5"> yeah</font>

407
00:26:40,050 --> 00:26:48,129
usual<font color="#E5E5E5"> SSH protocol take place so it's</font>

408
00:26:44,200 --> 00:26:52,030
only<font color="#CCCCCC"> a reverse</font><font color="#E5E5E5"> TCP then it's regular SSH</font>

409
00:26:48,130 --> 00:26:55,180
so I'm troubled<font color="#E5E5E5"> about you data can see</font>

410
00:26:52,030 --> 00:26:58,840
my shows use urban all again but I I got

411
00:26:55,180 --> 00:27:03,010
<font color="#CCCCCC">pin SH I can run</font><font color="#E5E5E5"> I</font><font color="#CCCCCC"> can run</font>

412
00:26:58,840 --> 00:27:06,810
<font color="#E5E5E5">Finn and like it's just</font><font color="#CCCCCC"> like I had a</font>

413
00:27:03,010 --> 00:27:06,810
<font color="#E5E5E5">regular</font><font color="#CCCCCC"> SSH connection</font>

414
00:27:08,030 --> 00:27:13,360
so that's pretty much<font color="#E5E5E5"> it any questions</font>

415
00:27:14,260 --> 00:27:25,170
[Applause]

416
00:27:32,060 --> 00:27:34,120
you

