1
00:02:53,420 --> 00:02:56,540
thank you

2
00:03:09,060 --> 00:03:11,300
foreign

3
00:04:11,819 --> 00:04:14,819
foreign

4
00:06:02,400 --> 00:06:04,638
foreign

5
00:06:45,240 --> 00:06:47,419
foreign

6
00:07:00,780 --> 00:07:03,780
foreign

7
00:09:30,959 --> 00:09:33,959
younger

8
00:09:41,880 --> 00:09:45,380
Bionic reasons

9
00:10:00,120 --> 00:10:01,800
you're right we give you uh your tax

10
00:10:01,800 --> 00:10:05,959
money get out of my head

11
00:10:10,800 --> 00:10:14,180
I like what those things um

12
00:10:37,580 --> 00:10:40,940
come on there

13
00:11:31,660 --> 00:11:34,860
[Music]

14
00:11:38,140 --> 00:11:46,260
[Music]

15
00:11:46,260 --> 00:11:49,260
foreign

16
00:11:55,080 --> 00:12:02,620
[Music]

17
00:12:07,450 --> 00:12:10,519
[Music]

18
00:12:24,500 --> 00:12:28,200
and do the hosted q a so as always you

19
00:12:28,200 --> 00:12:30,060
can go on slido I will pop that link in

20
00:12:30,060 --> 00:12:32,160
Discord as well and we'll have the QR

21
00:12:32,160 --> 00:12:34,260
code that comes up and you can add

22
00:12:34,260 --> 00:12:36,660
questions from now as the speakers talk

23
00:12:36,660 --> 00:12:37,760
and then

24
00:12:37,760 --> 00:12:41,279
they will kick in after the talks so our

25
00:12:41,279 --> 00:12:42,440
moderator is

26
00:12:42,440 --> 00:12:44,880
a long time North SEC volunteer with

27
00:12:44,880 --> 00:12:46,139
more than 15 years of experience in

28
00:12:46,139 --> 00:12:49,860
information security finance

29
00:13:00,000 --> 00:13:02,399
uh so that was that was very bilingual

30
00:13:02,399 --> 00:13:04,200
awesome

31
00:13:04,200 --> 00:13:07,560
impressive thank you welcome everyone so

32
00:13:07,560 --> 00:13:10,200
I will introduce our first speaker suira

33
00:13:10,200 --> 00:13:12,480
who has been doing malware analysis and

34
00:13:12,480 --> 00:13:13,740
reverse engineering for the last 10

35
00:13:13,740 --> 00:13:16,079
years in addition to that she's also a

36
00:13:16,079 --> 00:13:17,940
volunteering in her community both

37
00:13:17,940 --> 00:13:20,040
participating in cyberages and black

38
00:13:20,040 --> 00:13:24,719
hoodie so welcome and

39
00:13:29,160 --> 00:13:32,579
so thanks Miramar uh yes so hello

40
00:13:32,579 --> 00:13:35,220
everyone uh hello North SEC thank you

41
00:13:35,220 --> 00:13:37,560
for having me I'm really excited to talk

42
00:13:37,560 --> 00:13:39,500
about my research on tracking

43
00:13:39,500 --> 00:13:41,579
Bumblebee's development

44
00:13:41,579 --> 00:13:43,920
as you know my name is Sue I'm a

45
00:13:43,920 --> 00:13:46,740
security researcher at crowdstrike

46
00:13:46,740 --> 00:13:48,839
so our talk today we are going to look

47
00:13:48,839 --> 00:13:51,060
at different timelines on the

48
00:13:51,060 --> 00:13:53,100
development of different bumblebee

49
00:13:53,100 --> 00:13:54,420
components

50
00:13:54,420 --> 00:13:57,000
some may not be a parent right now what

51
00:13:57,000 --> 00:13:59,459
we'll notice is that the developers they

52
00:13:59,459 --> 00:14:01,920
like to focus on different EDR evasion

53
00:14:01,920 --> 00:14:03,720
techniques some of which are worth

54
00:14:03,720 --> 00:14:05,880
mentioning so we'll talk about those as

55
00:14:05,880 --> 00:14:07,019
well

56
00:14:07,019 --> 00:14:09,779
and then finally at the end we'll draw a

57
00:14:09,779 --> 00:14:11,579
conclusion about what these timelines

58
00:14:11,579 --> 00:14:15,000
can teach us about the developers and

59
00:14:15,000 --> 00:14:19,200
how they approach developing a malware

60
00:14:19,200 --> 00:14:21,420
I do want to note that crowdstrike's

61
00:14:21,420 --> 00:14:23,820
name for the malware as seen in the

62
00:14:23,820 --> 00:14:25,680
intelligence reporting is called shindig

63
00:14:25,680 --> 00:14:28,800
but I will continue to use bumblebee

64
00:14:28,800 --> 00:14:31,440
throughout this talk

65
00:14:31,440 --> 00:14:33,360
so before we're going to look at Dev

66
00:14:33,360 --> 00:14:35,639
timelines we are going to first get a

67
00:14:35,639 --> 00:14:38,339
really quick history about Bumblebee so

68
00:14:38,339 --> 00:14:40,320
quick uh just a quick chronology

69
00:14:40,320 --> 00:14:43,740
timeline here so how did it all start

70
00:14:43,740 --> 00:14:46,500
so it was first reported in March 2022

71
00:14:46,500 --> 00:14:49,680
by the Google tag team the researchers

72
00:14:49,680 --> 00:14:52,800
they observed this new loader being used

73
00:14:52,800 --> 00:14:55,320
by Affiliates Kuba previously associated

74
00:14:55,320 --> 00:14:58,380
with conti and that's also how they gave

75
00:14:58,380 --> 00:15:00,959
it its name the string bumblebee was

76
00:15:00,959 --> 00:15:03,480
seen in a user agent header when it made

77
00:15:03,480 --> 00:15:05,160
requests to the server

78
00:15:05,160 --> 00:15:07,440
now these same Affiliates they use the

79
00:15:07,440 --> 00:15:09,899
similar loader in a campaign they were

80
00:15:09,899 --> 00:15:13,260
targeting in August of 2021 that's the

81
00:15:13,260 --> 00:15:15,480
cve they were targeting and it was later

82
00:15:15,480 --> 00:15:17,579
reported by Microsoft in September of

83
00:15:17,579 --> 00:15:20,880
that year but that loader though it

84
00:15:20,880 --> 00:15:22,800
didn't have the bot like capabilities it

85
00:15:22,800 --> 00:15:24,720
was only used for spreading cobolt

86
00:15:24,720 --> 00:15:26,519
strike so when we're looking at our

87
00:15:26,519 --> 00:15:28,980
timelines we are going to focus on

88
00:15:28,980 --> 00:15:31,320
bumblebee when it started off as a bot

89
00:15:31,320 --> 00:15:34,320
so the start date we believe to be 31st

90
00:15:34,320 --> 00:15:37,440
Jan 2022 and for the purpose of This

91
00:15:37,440 --> 00:15:40,320
research it's until first of March this

92
00:15:40,320 --> 00:15:41,220
year

93
00:15:41,220 --> 00:15:43,199
so as you see here shortly after the

94
00:15:43,199 --> 00:15:45,720
first report bumblebees activities

95
00:15:45,720 --> 00:15:47,639
started picking up three major

96
00:15:47,639 --> 00:15:49,620
Affiliates who have been seen using it

97
00:15:49,620 --> 00:15:51,839
from the beginning more major Affiliates

98
00:15:51,839 --> 00:15:53,339
joined down the line and there were some

99
00:15:53,339 --> 00:15:55,260
smaller ones but it's not shown here on

100
00:15:55,260 --> 00:15:56,339
the graph

101
00:15:56,339 --> 00:15:59,100
and you also see that they're used by

102
00:15:59,100 --> 00:16:01,260
the likes distributed by the likes of

103
00:16:01,260 --> 00:16:03,420
smoke bot and batloader so it's quite a

104
00:16:03,420 --> 00:16:05,940
popular malware

105
00:16:05,940 --> 00:16:08,699
so what is Bumblebee like right now when

106
00:16:08,699 --> 00:16:11,100
it infects a victim's machine like what

107
00:16:11,100 --> 00:16:13,560
does that life cycle look like

108
00:16:13,560 --> 00:16:15,660
so as with most malware it starts off

109
00:16:15,660 --> 00:16:18,240
with the loaders the way uh top there

110
00:16:18,240 --> 00:16:21,360
you see in the flow it's encrypted it's

111
00:16:21,360 --> 00:16:23,399
packed it unpacks on malware in

112
00:16:23,399 --> 00:16:25,680
Bumblebee's case the unpacked file is

113
00:16:25,680 --> 00:16:29,100
always a dll so once unpacked it can

114
00:16:29,100 --> 00:16:31,079
communicate with the server to receive

115
00:16:31,079 --> 00:16:33,000
commands that it needs to run on the

116
00:16:33,000 --> 00:16:35,639
machine bumblebee calls these commands

117
00:16:35,639 --> 00:16:37,860
as tasks they are abbreviated

118
00:16:37,860 --> 00:16:39,959
three-leaded strings and they're

119
00:16:39,959 --> 00:16:42,120
lettered in such a way that you can

120
00:16:42,120 --> 00:16:44,940
deduce the meaning behind each task so

121
00:16:44,940 --> 00:16:46,440
take for instance the one in the very

122
00:16:46,440 --> 00:16:49,399
bottom here sdl stands for silent delete

123
00:16:49,399 --> 00:16:51,959
it's yeah so it removes the malware

124
00:16:51,959 --> 00:16:54,060
removes itself from the machine

125
00:16:54,060 --> 00:16:56,100
I won't go through this list yet because

126
00:16:56,100 --> 00:16:58,980
we will touch on tasks again at a later

127
00:16:58,980 --> 00:17:00,060
point

128
00:17:00,060 --> 00:17:03,600
now I'll unpack dll2 it has another

129
00:17:03,600 --> 00:17:05,459
embedded file in it it's called The Hook

130
00:17:05,459 --> 00:17:07,980
module it's using conjunction with two

131
00:17:07,980 --> 00:17:10,199
of the tasks and we'll see that later on

132
00:17:10,199 --> 00:17:12,660
in the talk as well and finally

133
00:17:12,660 --> 00:17:15,059
bumblebee is modular in nature that

134
00:17:15,059 --> 00:17:17,400
means it can run different plugins on

135
00:17:17,400 --> 00:17:19,020
the machine that it gets from the server

136
00:17:19,020 --> 00:17:21,720
and those plugins too can communicate

137
00:17:21,720 --> 00:17:24,059
with the server

138
00:17:24,059 --> 00:17:26,699
so from this image we are looking at

139
00:17:26,699 --> 00:17:28,439
three different timelines our first

140
00:17:28,439 --> 00:17:30,540
timeline will look at the development

141
00:17:30,540 --> 00:17:32,220
that's been put into the loader and the

142
00:17:32,220 --> 00:17:35,340
dll the second one you know changes that

143
00:17:35,340 --> 00:17:36,960
we have seen to the communication

144
00:17:36,960 --> 00:17:39,720
protocol over time and then finally the

145
00:17:39,720 --> 00:17:41,580
third timeline is just going to look at

146
00:17:41,580 --> 00:17:44,120
tasks

147
00:17:44,520 --> 00:17:47,100
so here we have is a first Gantt

148
00:17:47,100 --> 00:17:50,340
timeline chart so the way it works is

149
00:17:50,340 --> 00:17:52,500
from left to right it goes in

150
00:17:52,500 --> 00:17:54,480
chronological order so starting from

151
00:17:54,480 --> 00:17:57,660
31st Jan 2022 until first of March this

152
00:17:57,660 --> 00:18:01,140
year and from top to bottom you can see

153
00:18:01,140 --> 00:18:04,559
uh the list of techniques that the

154
00:18:04,559 --> 00:18:07,020
malware uses in in part of its loader

155
00:18:07,020 --> 00:18:09,660
where it's bought I didn't list all

156
00:18:09,660 --> 00:18:11,280
those techniques here because it would

157
00:18:11,280 --> 00:18:13,260
be impossible to fit it all in the slide

158
00:18:13,260 --> 00:18:15,600
but this is just to give you an idea of

159
00:18:15,600 --> 00:18:17,460
how long those techniques were used and

160
00:18:17,460 --> 00:18:18,780
the duration

161
00:18:18,780 --> 00:18:22,140
now before I talk about you know this uh

162
00:18:22,140 --> 00:18:24,419
timeline here I do want to mention about

163
00:18:24,419 --> 00:18:28,140
Bumblebee's binaries uh just in general

164
00:18:28,140 --> 00:18:31,440
so Bumblebee's main dll the unpacked

165
00:18:31,440 --> 00:18:33,660
file and its plugins they use you'll

166
00:18:33,660 --> 00:18:35,700
notice they use a lot of functions from

167
00:18:35,700 --> 00:18:38,460
the Boost Library boost is an open

168
00:18:38,460 --> 00:18:40,860
source C plus plus Library it is header

169
00:18:40,860 --> 00:18:43,799
based that means any program using boost

170
00:18:43,799 --> 00:18:46,620
ends up statically compiling a lot of

171
00:18:46,620 --> 00:18:49,080
those functions in its binary and it

172
00:18:49,080 --> 00:18:51,539
also explains why Bumblebee's files are

173
00:18:51,539 --> 00:18:53,520
quite big in size

174
00:18:53,520 --> 00:18:56,039
so as you see here from the start when

175
00:18:56,039 --> 00:18:58,020
bumblebee started it didn't have a

176
00:18:58,020 --> 00:19:00,120
loader it was actually quite it didn't

177
00:19:00,120 --> 00:19:01,980
have anything packing it was unencrypted

178
00:19:01,980 --> 00:19:05,160
it was unpacked this now might likely be

179
00:19:05,160 --> 00:19:08,760
it's um like a way for the developers to

180
00:19:08,760 --> 00:19:11,820
test the bot and the loader actually

181
00:19:11,820 --> 00:19:13,919
came much later into play by end of

182
00:19:13,919 --> 00:19:15,780
March and as we saw in the previous

183
00:19:15,780 --> 00:19:18,240
timeline it was around the time the

184
00:19:18,240 --> 00:19:20,760
malware was picking up activity

185
00:19:20,760 --> 00:19:22,980
so despite you know even though they're

186
00:19:22,980 --> 00:19:24,900
just testing the malware they did though

187
00:19:24,900 --> 00:19:27,780
have what we believe to be an EDR

188
00:19:27,780 --> 00:19:31,080
evasion technique so this technique was

189
00:19:31,080 --> 00:19:33,720
where it would hook the API RTL exit

190
00:19:33,720 --> 00:19:35,220
user process

191
00:19:35,220 --> 00:19:37,980
so the API was only hooked if there was

192
00:19:37,980 --> 00:19:41,160
an existing EDR or AV hook on that API

193
00:19:41,160 --> 00:19:43,860
in this case the malware's trampoline

194
00:19:43,860 --> 00:19:46,200
code would make sure that bumblebee

195
00:19:46,200 --> 00:19:47,940
finished executing its thread before

196
00:19:47,940 --> 00:19:51,360
control went back to the EDR likely to

197
00:19:51,360 --> 00:19:53,580
prevent the you know the antivirus from

198
00:19:53,580 --> 00:19:55,740
scanning or analyzing the process any

199
00:19:55,740 --> 00:19:57,000
further

200
00:19:57,000 --> 00:20:00,120
they did though Swap this technique for

201
00:20:00,120 --> 00:20:02,220
another EDR Vision called thread

202
00:20:02,220 --> 00:20:07,020
execution hijacking by end of June 2022

203
00:20:07,020 --> 00:20:09,900
um I think yeah but in my opinion a much

204
00:20:09,900 --> 00:20:12,780
better EDR evasion we'll see why in the

205
00:20:12,780 --> 00:20:14,640
later slide

206
00:20:14,640 --> 00:20:17,340
now when the loader was introduced it

207
00:20:17,340 --> 00:20:19,980
wasn't only like useful encrypting a

208
00:20:19,980 --> 00:20:24,059
packer Amino dll it too had an EDR

209
00:20:24,059 --> 00:20:26,280
evasion it's called remote Library

210
00:20:26,280 --> 00:20:28,140
injection and that too we'll see again

211
00:20:28,140 --> 00:20:31,200
right after this slide

212
00:20:31,200 --> 00:20:33,539
the developers as well they played with

213
00:20:33,539 --> 00:20:36,720
a different form of a loader and and in

214
00:20:36,720 --> 00:20:39,240
fact it also gave them another EDR

215
00:20:39,240 --> 00:20:42,000
evasion so they would use power sploid's

216
00:20:42,000 --> 00:20:43,919
reflective dll injection and this was

217
00:20:43,919 --> 00:20:45,900
something they introduced after they

218
00:20:45,900 --> 00:20:48,660
came back from their first break but now

219
00:20:48,660 --> 00:20:51,000
we see it more when they came back from

220
00:20:51,000 --> 00:20:53,280
the second break and it's more used in

221
00:20:53,280 --> 00:20:57,960
cases for SEO poisoning and malvertising

222
00:20:57,960 --> 00:21:00,960
finally I want to touch on Alcazar so

223
00:21:00,960 --> 00:21:03,539
alcazer is this repository in GitHub it

224
00:21:03,539 --> 00:21:05,580
contains all these different techniques

225
00:21:05,580 --> 00:21:08,280
and one can use for doing anti-analysis

226
00:21:08,280 --> 00:21:11,520
checks on the machine and Bumblebee uses

227
00:21:11,520 --> 00:21:14,100
almost all of those checks and so they

228
00:21:14,100 --> 00:21:15,960
were using the alcaza report quite

229
00:21:15,960 --> 00:21:17,880
aggressively like at the beginning of

230
00:21:17,880 --> 00:21:20,100
the malware's execution and as you can

231
00:21:20,100 --> 00:21:21,840
see like for a really long period of

232
00:21:21,840 --> 00:21:24,900
time but then interestingly they just

233
00:21:24,900 --> 00:21:26,880
dropped it like two weeks before going

234
00:21:26,880 --> 00:21:28,799
on their second break it wasn't really

235
00:21:28,799 --> 00:21:31,679
clear why but then after coming back

236
00:21:31,679 --> 00:21:34,080
from the second break they they

237
00:21:34,080 --> 00:21:36,179
reintroduced it but in a completely

238
00:21:36,179 --> 00:21:39,000
different context so we'll see that more

239
00:21:39,000 --> 00:21:43,880
when we look at the C2 communication

240
00:21:44,280 --> 00:21:46,980
now we have our first EDR evasion here

241
00:21:46,980 --> 00:21:49,500
this is used by the loader

242
00:21:49,500 --> 00:21:52,140
so the purpose of this technique is to

243
00:21:52,140 --> 00:21:54,360
actually masquerade bumblebees unpacked

244
00:21:54,360 --> 00:21:57,000
dll to appear running as a legitimate

245
00:21:57,000 --> 00:21:59,940
dll in memory here you see the

246
00:21:59,940 --> 00:22:01,799
screenshot or process Explorer you can

247
00:22:01,799 --> 00:22:03,780
see the active threads of bumblebees

248
00:22:03,780 --> 00:22:06,539
process the one highlighted there the

249
00:22:06,539 --> 00:22:08,220
active thread it's pointing to this

250
00:22:08,220 --> 00:22:10,860
Library called dim's room it's actually

251
00:22:10,860 --> 00:22:14,280
a Windows system library of Windows now

252
00:22:14,280 --> 00:22:16,799
it's in this case it's not the system

253
00:22:16,799 --> 00:22:18,900
Library that's running behind the scenes

254
00:22:18,900 --> 00:22:21,720
is actually Bumblebee the One giveaway

255
00:22:21,720 --> 00:22:24,360
here is it's referencing that export

256
00:22:24,360 --> 00:22:27,419
function called setpath that belongs to

257
00:22:27,419 --> 00:22:29,100
our malware

258
00:22:29,100 --> 00:22:31,440
now this technique is done by first

259
00:22:31,440 --> 00:22:34,799
hooking apis that are used by ntdll for

260
00:22:34,799 --> 00:22:37,880
loading and mapping libraries in memory

261
00:22:37,880 --> 00:22:40,679
generally those apis perform the

262
00:22:40,679 --> 00:22:43,919
operation against a file on disk but by

263
00:22:43,919 --> 00:22:46,740
hooking the API they can control it

264
00:22:46,740 --> 00:22:48,960
against an unpacked file in memory so

265
00:22:48,960 --> 00:22:50,159
quite clever

266
00:22:50,159 --> 00:22:52,740
but this you know proof of concept isn't

267
00:22:52,740 --> 00:22:55,620
new it was introduced back in 2004 and

268
00:22:55,620 --> 00:22:57,840
there's a link to it at the bottom for

269
00:22:57,840 --> 00:23:00,200
those that can see the slide

270
00:23:00,200 --> 00:23:03,179
and which goes into detail explaining it

271
00:23:03,179 --> 00:23:06,299
and and also the only other malware that

272
00:23:06,299 --> 00:23:08,940
we were able to find using the same the

273
00:23:08,940 --> 00:23:10,980
same technique was ramnet and it's also

274
00:23:10,980 --> 00:23:14,940
pointed out in one of IBM's blogs now

275
00:23:14,940 --> 00:23:17,640
this is not all to say that you know the

276
00:23:17,640 --> 00:23:20,039
developers were necessarily aware of the

277
00:23:20,039 --> 00:23:22,860
POC or were the same group as ramnet but

278
00:23:22,860 --> 00:23:25,020
it's quite common in e-crime to see a

279
00:23:25,020 --> 00:23:27,240
lot of these groups borrow techniques

280
00:23:27,240 --> 00:23:31,380
and reuse techniques and um yeah so it's

281
00:23:31,380 --> 00:23:33,539
nothing necessarily new but it seems to

282
00:23:33,539 --> 00:23:36,379
work for their case

283
00:23:36,480 --> 00:23:39,059
next off we have is the thread execution

284
00:23:39,059 --> 00:23:42,240
hijacking so this is the EDR evasion

285
00:23:42,240 --> 00:23:45,059
used by unpacked LL

286
00:23:45,059 --> 00:23:47,580
now this technique's purpose is to

287
00:23:47,580 --> 00:23:50,220
masquerade bumblebees start offset in

288
00:23:50,220 --> 00:23:53,640
memory to appear under a decoy offset

289
00:23:53,640 --> 00:23:56,159
and and they point that offset to that

290
00:23:56,159 --> 00:23:58,200
of this really long named API that's

291
00:23:58,200 --> 00:24:01,740
part of ntdll so similarly you have the

292
00:24:01,740 --> 00:24:04,559
same screenshot here and you have one of

293
00:24:04,559 --> 00:24:06,360
these other active threads it's showing

294
00:24:06,360 --> 00:24:09,179
that the API is running but as you can

295
00:24:09,179 --> 00:24:11,340
guess it's actually a malware

296
00:24:11,340 --> 00:24:14,880
now this technique is done by first or

297
00:24:14,880 --> 00:24:17,940
it creates the API as a thread in

298
00:24:17,940 --> 00:24:20,100
suspended mode and when the thread is

299
00:24:20,100 --> 00:24:22,860
suspended the malware can modify the

300
00:24:22,860 --> 00:24:25,200
thread's context structure in that

301
00:24:25,200 --> 00:24:27,059
structure there's a field that specifies

302
00:24:27,059 --> 00:24:29,580
a start routine it would normally point

303
00:24:29,580 --> 00:24:31,740
to the API it just swaps it for the

304
00:24:31,740 --> 00:24:34,200
malware so it effectively just spoops

305
00:24:34,200 --> 00:24:36,360
the edr's call stack so it appears that

306
00:24:36,360 --> 00:24:39,000
an API is running but actually it's the

307
00:24:39,000 --> 00:24:42,000
malware that's running behind the scenes

308
00:24:42,000 --> 00:24:44,880
now this technique is generally used for

309
00:24:44,880 --> 00:24:46,679
process injection and there's a really

310
00:24:46,679 --> 00:24:49,440
good entry in miter attack that shows

311
00:24:49,440 --> 00:24:51,600
other malware families using it

312
00:24:51,600 --> 00:24:54,000
in my case I was trying to find a

313
00:24:54,000 --> 00:24:56,580
similar POC where it's used in within

314
00:24:56,580 --> 00:24:58,260
the same process because it wasn't

315
00:24:58,260 --> 00:25:00,539
really injected into any external

316
00:25:00,539 --> 00:25:03,360
process I had no luck I actually thought

317
00:25:03,360 --> 00:25:05,940
this was something novel by this group

318
00:25:05,940 --> 00:25:08,940
but then I come across this other blog

319
00:25:08,940 --> 00:25:11,820
where they show cozy Bears a Dropbox

320
00:25:11,820 --> 00:25:14,820
loader using the same technique and

321
00:25:14,820 --> 00:25:17,100
coincidentally they use the same decoy

322
00:25:17,100 --> 00:25:19,559
API name so of all the API names that

323
00:25:19,559 --> 00:25:22,140
could be out there so again you know

324
00:25:22,140 --> 00:25:24,299
clearly they borrowed another technique

325
00:25:24,299 --> 00:25:26,539
here

326
00:25:27,360 --> 00:25:29,279
now that we've learned about the load

327
00:25:29,279 --> 00:25:31,860
and dll let's look at the C2

328
00:25:31,860 --> 00:25:34,320
communication so before I show the

329
00:25:34,320 --> 00:25:36,380
timeline I just want to explain what

330
00:25:36,380 --> 00:25:39,840
Bumblebee's protocol is like right now

331
00:25:39,840 --> 00:25:41,940
so the malware uses secure web sockets

332
00:25:41,940 --> 00:25:44,760
the messages it creates to the for the

333
00:25:44,760 --> 00:25:46,500
server and receive from the server then

334
00:25:46,500 --> 00:25:49,440
Json format and they're rc4 encrypted

335
00:25:49,440 --> 00:25:52,740
the key of which is embedded in our

336
00:25:52,740 --> 00:25:55,380
unpacked dll file

337
00:25:55,380 --> 00:25:58,200
here's a description of what these

338
00:25:58,200 --> 00:25:59,460
messages look like they're very

339
00:25:59,460 --> 00:26:01,380
truncated it's not the full version but

340
00:26:01,380 --> 00:26:03,960
just to give a sense of what it is and

341
00:26:03,960 --> 00:26:06,840
I've labeled them as ping hidden tasks

342
00:26:06,840 --> 00:26:08,820
just to understand and the flow better

343
00:26:08,820 --> 00:26:10,980
as I explain it but these are not the

344
00:26:10,980 --> 00:26:13,740
names given by the malware

345
00:26:13,740 --> 00:26:16,500
now bumblebee they have a beaconing

346
00:26:16,500 --> 00:26:18,600
style communication so these messages

347
00:26:18,600 --> 00:26:20,880
you see they get sent in a loop

348
00:26:20,880 --> 00:26:24,000
constantly this is quite common in a lot

349
00:26:24,000 --> 00:26:26,159
of e-crime families you see it also with

350
00:26:26,159 --> 00:26:29,279
bog Bots and CAC Bots and so the payload

351
00:26:29,279 --> 00:26:31,500
is not immediately delivered to the

352
00:26:31,500 --> 00:26:33,240
victim machine it's delivered at an

353
00:26:33,240 --> 00:26:35,340
undetermined period of time so that

354
00:26:35,340 --> 00:26:37,440
makes it harder for analysts like us to

355
00:26:37,440 --> 00:26:40,200
pull down any payload and also makes it

356
00:26:40,200 --> 00:26:42,179
just harder for the victim to realize

357
00:26:42,179 --> 00:26:45,059
that they were infected

358
00:26:45,059 --> 00:26:46,919
um now so let's explain what these

359
00:26:46,919 --> 00:26:50,340
messages mean so now the whole point of

360
00:26:50,340 --> 00:26:52,679
Bumblebee's ping request is to send

361
00:26:52,679 --> 00:26:56,220
across the Bots ID to the server and in

362
00:26:56,220 --> 00:26:57,659
turn from the server it will get a

363
00:26:57,659 --> 00:26:58,860
session ID

364
00:26:58,860 --> 00:27:01,200
that session ID is used in throughout

365
00:27:01,200 --> 00:27:03,960
the other request messages and likely

366
00:27:03,960 --> 00:27:06,600
it's for the malware's back end to keep

367
00:27:06,600 --> 00:27:09,659
track of what messages get sent out and

368
00:27:09,659 --> 00:27:11,580
finally if there's any commands for the

369
00:27:11,580 --> 00:27:13,919
malware to execute it'll arrive in the

370
00:27:13,919 --> 00:27:16,679
task type response message and as you

371
00:27:16,679 --> 00:27:18,539
learn task is the three-lettered command

372
00:27:18,539 --> 00:27:20,640
and along with any payload for the

373
00:27:20,640 --> 00:27:22,440
malware to execute

374
00:27:22,440 --> 00:27:25,740
now what about the hit request here in

375
00:27:25,740 --> 00:27:26,880
the middle

376
00:27:26,880 --> 00:27:30,419
that is where alcazer comes into play so

377
00:27:30,419 --> 00:27:32,580
okay sir as we learned from the first

378
00:27:32,580 --> 00:27:34,260
timeline you know is this report on

379
00:27:34,260 --> 00:27:35,880
GitHub contains different Tech

380
00:27:35,880 --> 00:27:38,100
techniques one can do for anti-analysis

381
00:27:38,100 --> 00:27:42,240
checks well uh bumblebee don't do those

382
00:27:42,240 --> 00:27:45,059
checks at the beginning of execution now

383
00:27:45,059 --> 00:27:47,460
they will run those checks only when it

384
00:27:47,460 --> 00:27:50,279
receives the go-to from the server that

385
00:27:50,279 --> 00:27:52,500
go to is in the Ping response there's a

386
00:27:52,500 --> 00:27:54,900
Boolean field in there called Hit if the

387
00:27:54,900 --> 00:27:57,360
server sends the hit value is true it

388
00:27:57,360 --> 00:27:59,760
will run these checks and then it will

389
00:27:59,760 --> 00:28:01,080
send

390
00:28:01,080 --> 00:28:03,539
um you know the out the results of those

391
00:28:03,539 --> 00:28:06,260
checks in this really long Json message

392
00:28:06,260 --> 00:28:08,760
contains different Boolean Fields across

393
00:28:08,760 --> 00:28:10,919
to the server and accordingly the server

394
00:28:10,919 --> 00:28:12,659
will drop the connection if it thinks

395
00:28:12,659 --> 00:28:14,460
there's any if it's running in the VM or

396
00:28:14,460 --> 00:28:17,880
any anti-analysis artifacts now the

397
00:28:17,880 --> 00:28:19,860
developers they didn't only settle with

398
00:28:19,860 --> 00:28:22,799
using alcazo they do some of their own

399
00:28:22,799 --> 00:28:25,140
checks like the classic trying to look

400
00:28:25,140 --> 00:28:27,840
for active processes in the machine and

401
00:28:27,840 --> 00:28:30,720
and this one in particular this field

402
00:28:30,720 --> 00:28:32,880
here called binary DB

403
00:28:32,880 --> 00:28:36,779
that one contains a base64 encoded SQL

404
00:28:36,779 --> 00:28:39,720
database of browsing history that they

405
00:28:39,720 --> 00:28:41,760
query from chrome and Ms Edge in

406
00:28:41,760 --> 00:28:43,740
particular so now you have a really

407
00:28:43,740 --> 00:28:45,539
clever way of checking like if your

408
00:28:45,539 --> 00:28:47,700
machine is indeed a Sandbox or Victim

409
00:28:47,700 --> 00:28:49,620
Because uh you know sandbox is less

410
00:28:49,620 --> 00:28:52,380
likely to have browsing history

411
00:28:52,380 --> 00:28:54,900
I don't want to note that now we see

412
00:28:54,900 --> 00:28:57,659
these new bills in April where this

413
00:28:57,659 --> 00:28:59,460
check has been dropped but not

414
00:28:59,460 --> 00:29:01,020
completely because we still see

415
00:29:01,020 --> 00:29:03,600
Affiliates using older builds so not

416
00:29:03,600 --> 00:29:05,760
every communication will necessarily be

417
00:29:05,760 --> 00:29:08,820
exfiltrating browsing history

418
00:29:08,820 --> 00:29:11,460
now in the event that bumblebee gets a

419
00:29:11,460 --> 00:29:13,320
task from the server it will it will

420
00:29:13,320 --> 00:29:15,720
also send a result of running the task

421
00:29:15,720 --> 00:29:18,600
in a separate type message sorry it's

422
00:29:18,600 --> 00:29:21,120
right behind me here and that just

423
00:29:21,120 --> 00:29:23,100
contains you know any errors that may

424
00:29:23,100 --> 00:29:24,779
have been encountered by running the

425
00:29:24,779 --> 00:29:27,659
task or any information that was

426
00:29:27,659 --> 00:29:31,159
exfiltrated by running the task

427
00:29:32,159 --> 00:29:35,159
so looking at the Timeline is actually

428
00:29:35,159 --> 00:29:37,380
being quite a fair bit of changes over

429
00:29:37,380 --> 00:29:40,140
time till it got to where it is now it's

430
00:29:40,140 --> 00:29:42,480
a bit harder to follow so I found that

431
00:29:42,480 --> 00:29:44,159
just by grouping it on these certain

432
00:29:44,159 --> 00:29:47,899
properties here again right behind me

433
00:29:47,899 --> 00:29:50,520
it makes it a bit more easier to follow

434
00:29:50,520 --> 00:29:52,799
so let's go from the beginning at the

435
00:29:52,799 --> 00:29:54,299
start

436
00:29:54,299 --> 00:29:56,460
so when bumblebee first started they

437
00:29:56,460 --> 00:29:59,580
used actually an https protocol and of

438
00:29:59,580 --> 00:30:01,620
course it's Infamous usage and string

439
00:30:01,620 --> 00:30:04,500
bumblebee now the messages that was sent

440
00:30:04,500 --> 00:30:07,020
across it was only the task message so

441
00:30:07,020 --> 00:30:08,820
not the Ping and the hit that we saw on

442
00:30:08,820 --> 00:30:10,140
the previous slide

443
00:30:10,140 --> 00:30:12,539
the client version number was one you

444
00:30:12,539 --> 00:30:15,000
know of course first iteration and the

445
00:30:15,000 --> 00:30:17,220
endpoint string that I made a request to

446
00:30:17,220 --> 00:30:18,840
was called gate

447
00:30:18,840 --> 00:30:21,539
Now by mid-april they decided to

448
00:30:21,539 --> 00:30:24,059
randomize the user agent pattern and

449
00:30:24,059 --> 00:30:25,500
this was also the time you started

450
00:30:25,500 --> 00:30:27,240
seeing more public blogs coming out

451
00:30:27,240 --> 00:30:29,520
about Bumblebee and Bumblebee was a bit

452
00:30:29,520 --> 00:30:32,580
too obvious of a user agent name but

453
00:30:32,580 --> 00:30:35,279
that was clearly short-lived because in

454
00:30:35,279 --> 00:30:38,700
early may they decided to switch it up

455
00:30:38,700 --> 00:30:41,880
so they randomized the user agent they

456
00:30:41,880 --> 00:30:44,399
started encrypting the task message and

457
00:30:44,399 --> 00:30:47,460
we see rc4 Keys come in play the

458
00:30:47,460 --> 00:30:49,919
endpoint string it changed from gate to

459
00:30:49,919 --> 00:30:52,679
gate s s may be their way of saying

460
00:30:52,679 --> 00:30:55,080
secure no idea

461
00:30:55,080 --> 00:30:57,120
um and then okay so now the next stage

462
00:30:57,120 --> 00:30:59,100
so a month after they came from their

463
00:30:59,100 --> 00:31:01,200
first break they switched the protocol

464
00:31:01,200 --> 00:31:03,059
this is now where they started using web

465
00:31:03,059 --> 00:31:05,700
sockets and we also see the introduction

466
00:31:05,700 --> 00:31:08,640
of the Ping type message the endpoint

467
00:31:08,640 --> 00:31:12,720
string a change from gate s to gate w

468
00:31:12,720 --> 00:31:14,520
and the client version number was two

469
00:31:14,520 --> 00:31:17,039
and now where we are at and something

470
00:31:17,039 --> 00:31:18,899
they've introduced after their second

471
00:31:18,899 --> 00:31:20,640
break is you know we see the three

472
00:31:20,640 --> 00:31:23,940
messages the only difference is the user

473
00:31:23,940 --> 00:31:25,740
agent string is this hard-coded value

474
00:31:25,740 --> 00:31:28,200
here the bottom of the slide uh it's not

475
00:31:28,200 --> 00:31:31,020
randomized anymore and maybe it's like

476
00:31:31,020 --> 00:31:32,640
the attempt at trying to make traffic

477
00:31:32,640 --> 00:31:36,320
look a bit more legitimate

478
00:31:36,960 --> 00:31:40,919
that brings us to the final one tasks

479
00:31:40,919 --> 00:31:42,419
so

480
00:31:42,419 --> 00:31:45,779
here on the left hand side okay the

481
00:31:45,779 --> 00:31:48,179
screen is like gone off here but on the

482
00:31:48,179 --> 00:31:49,500
left hand side you can see is a

483
00:31:49,500 --> 00:31:51,240
description of what the three-letter

484
00:31:51,240 --> 00:31:53,700
tasks mean and on the right hand side is

485
00:31:53,700 --> 00:31:56,700
a really high level overview on how they

486
00:31:56,700 --> 00:31:59,399
get executed by the malware now our

487
00:31:59,399 --> 00:32:01,140
first four tasks are what are

488
00:32:01,140 --> 00:32:03,720
responsible for executing payloads the

489
00:32:03,720 --> 00:32:05,940
post three of which does injects the

490
00:32:05,940 --> 00:32:08,880
payload into processes so bumblebee can

491
00:32:08,880 --> 00:32:11,820
either inject shell codes or dll and if

492
00:32:11,820 --> 00:32:15,240
it is a dll it could be either secondary

493
00:32:15,240 --> 00:32:17,159
payloads in the dll format so like

494
00:32:17,159 --> 00:32:20,220
Cobalt strike blockbot or or it could be

495
00:32:20,220 --> 00:32:23,100
dlls of their plugins which are also in

496
00:32:23,100 --> 00:32:24,360
the dll format

497
00:32:24,360 --> 00:32:27,179
now if it's injecting payloads it uses

498
00:32:27,179 --> 00:32:30,240
the apcq code injection technique and

499
00:32:30,240 --> 00:32:32,340
it's also injected along with the hook

500
00:32:32,340 --> 00:32:35,340
module both of which have an EDR evasion

501
00:32:35,340 --> 00:32:37,640
role behind it so I will expand on them

502
00:32:37,640 --> 00:32:40,140
at a later slide

503
00:32:40,140 --> 00:32:43,260
now bumblebee can execute payloads just

504
00:32:43,260 --> 00:32:45,779
by itself no injection needed that's the

505
00:32:45,779 --> 00:32:49,440
Dex task gdt allows the malware to run

506
00:32:49,440 --> 00:32:52,580
commands likely for reconnaissance

507
00:32:52,580 --> 00:32:55,440
instead of invoking it directly through

508
00:32:55,440 --> 00:32:58,679
command.xc it's passed to command.xe

509
00:32:58,679 --> 00:33:01,320
standard input output nothing malicious

510
00:33:01,320 --> 00:33:02,880
is actually a common programming

511
00:33:02,880 --> 00:33:05,399
technique but it just prevents the user

512
00:33:05,399 --> 00:33:07,080
from getting notified that these

513
00:33:07,080 --> 00:33:09,179
commands are running in the background

514
00:33:09,179 --> 00:33:11,940
the malware can install itself on the

515
00:33:11,940 --> 00:33:15,419
machine AKA create persistence it uses a

516
00:33:15,419 --> 00:33:19,140
wmi to do create those artifacts and

517
00:33:19,140 --> 00:33:22,140
finally sdl silent delete the malware

518
00:33:22,140 --> 00:33:24,419
can remove itself and it uses Powershell

519
00:33:24,419 --> 00:33:27,360
to do that

520
00:33:27,360 --> 00:33:30,179
and now we have a final timeline

521
00:33:30,179 --> 00:33:32,159
so let's start off with the persistence

522
00:33:32,159 --> 00:33:34,620
task install ins

523
00:33:34,620 --> 00:33:37,140
so now when this task was used in the

524
00:33:37,140 --> 00:33:40,140
beginning it didn't use wmi it used your

525
00:33:40,140 --> 00:33:42,480
regular Windows API like create

526
00:33:42,480 --> 00:33:44,820
directory you know they create those uh

527
00:33:44,820 --> 00:33:47,340
artifacts on the machine uh the switch

528
00:33:47,340 --> 00:33:49,860
to wmi came about early May and it was

529
00:33:49,860 --> 00:33:52,019
actually quite a clever shift because

530
00:33:52,019 --> 00:33:54,600
now it will create those persistence

531
00:33:54,600 --> 00:33:58,559
files uh using command line strings but

532
00:33:58,559 --> 00:34:01,799
with wmi it could it would create the

533
00:34:01,799 --> 00:34:04,140
yeah it would create a command.xc using

534
00:34:04,140 --> 00:34:07,080
wmi a result of doing that ends up

535
00:34:07,080 --> 00:34:10,320
showing command.xc's process as a child

536
00:34:10,320 --> 00:34:13,918
process of the wmi parent process rather

537
00:34:13,918 --> 00:34:16,020
than of the malware process so

538
00:34:16,020 --> 00:34:18,540
effectively they achieve parent PID

539
00:34:18,540 --> 00:34:20,460
spoofing so quite clever and it's a bit

540
00:34:20,460 --> 00:34:22,800
more harder to monitor

541
00:34:22,800 --> 00:34:25,500
now this same task the weight is

542
00:34:25,500 --> 00:34:28,320
implemented to deferred based on which

543
00:34:28,320 --> 00:34:31,440
loader is being used so as we learned in

544
00:34:31,440 --> 00:34:33,060
the first timeline you know it's either

545
00:34:33,060 --> 00:34:35,520
power sploit so it starts off as a

546
00:34:35,520 --> 00:34:37,560
Powershell file or it could be an

547
00:34:37,560 --> 00:34:40,619
encrypted loader so if it was using

548
00:34:40,619 --> 00:34:42,060
power sploit

549
00:34:42,060 --> 00:34:45,300
um the malware just uses Windows DP API

550
00:34:45,300 --> 00:34:48,239
to encrypt the contents of the file so

551
00:34:48,239 --> 00:34:50,820
this likely prevents antivirus from

552
00:34:50,820 --> 00:34:53,219
scanning the contents and you know and

553
00:34:53,219 --> 00:34:54,480
being like oh whoa this looks like

554
00:34:54,480 --> 00:34:56,580
Powershell like commands and from

555
00:34:56,580 --> 00:34:59,580
blocking it then accordingly bumblebee

556
00:34:59,580 --> 00:35:01,920
creates a task that will run a script

557
00:35:01,920 --> 00:35:04,859
which uses DP API to decrypt it before

558
00:35:04,859 --> 00:35:06,240
running

559
00:35:06,240 --> 00:35:08,099
none of the loader was you know

560
00:35:08,099 --> 00:35:10,020
unexecutable to start off with it was

561
00:35:10,020 --> 00:35:12,180
already encrypted already packed it

562
00:35:12,180 --> 00:35:15,000
didn't need DP API and then you know

563
00:35:15,000 --> 00:35:17,160
just used a living off the land binary

564
00:35:17,160 --> 00:35:21,920
or ABC conf to execute the dll

565
00:35:22,079 --> 00:35:24,720
next off we have is gdt the one that can

566
00:35:24,720 --> 00:35:27,599
execute commands they introduced this in

567
00:35:27,599 --> 00:35:30,180
early may as well it was a it was

568
00:35:30,180 --> 00:35:32,880
implemented pretty in a simple manner in

569
00:35:32,880 --> 00:35:34,560
fact it was so simple that it matched

570
00:35:34,560 --> 00:35:39,180
exactly that with the msdn's example on

571
00:35:39,180 --> 00:35:42,660
how to achieve the same technique but it

572
00:35:42,660 --> 00:35:45,420
only allowed them to run one command at

573
00:35:45,420 --> 00:35:48,060
a time so I wasn't aware that they were

574
00:35:48,060 --> 00:35:51,420
testing it but then by end of May they

575
00:35:51,420 --> 00:35:54,180
switched they started using boost dot

576
00:35:54,180 --> 00:35:56,880
asio library to implement the same

577
00:35:56,880 --> 00:35:59,099
technique the only difference with using

578
00:35:59,099 --> 00:36:01,320
boost was it allowed them to run

579
00:36:01,320 --> 00:36:04,800
multiple commands asynchronously

580
00:36:04,800 --> 00:36:07,079
so here you see it's just a screenshot

581
00:36:07,079 --> 00:36:10,740
of what the pipe name gets created as a

582
00:36:10,740 --> 00:36:13,980
result of using boost.asio so not

583
00:36:13,980 --> 00:36:16,200
malicious again but quite useful for

584
00:36:16,200 --> 00:36:18,420
hunting and also at the end of the name

585
00:36:18,420 --> 00:36:21,060
you'll see concatenated to it is the PID

586
00:36:21,060 --> 00:36:23,460
so it's the process that invoked this

587
00:36:23,460 --> 00:36:26,640
technique to start off with

588
00:36:26,640 --> 00:36:30,240
and then finally let's touch on plg the

589
00:36:30,240 --> 00:36:31,079
task

590
00:36:31,079 --> 00:36:33,960
so plg is what allows

591
00:36:33,960 --> 00:36:36,480
which introduce plugins for the malware

592
00:36:36,480 --> 00:36:38,460
yeah and that was also introduced around

593
00:36:38,460 --> 00:36:40,740
the time they switched to websockets so

594
00:36:40,740 --> 00:36:42,720
they made quite a big changes after

595
00:36:42,720 --> 00:36:45,960
their first break nothing too fancy but

596
00:36:45,960 --> 00:36:49,079
they needed a way to get the plugins to

597
00:36:49,079 --> 00:36:51,300
communicate with the Bots and so they

598
00:36:51,300 --> 00:36:53,940
created an RPC endpoint we are named

599
00:36:53,940 --> 00:36:56,460
pipes that allows for inter-process

600
00:36:56,460 --> 00:36:59,579
communication nothing malicious popular

601
00:36:59,579 --> 00:37:02,640
programming technique but you know it's

602
00:37:02,640 --> 00:37:06,359
just useful to be aware of now the

603
00:37:06,359 --> 00:37:09,780
plugins via this endpoint they can they

604
00:37:09,780 --> 00:37:13,140
can query for the active C2 address

605
00:37:13,140 --> 00:37:15,359
fine okay

606
00:37:15,359 --> 00:37:18,599
okay for the active C2 address and Port

607
00:37:18,599 --> 00:37:21,060
that they need to connect to

608
00:37:21,060 --> 00:37:25,200
okay so try and go as quickly as I can

609
00:37:25,200 --> 00:37:28,320
okay so let's talk on this injection

610
00:37:28,320 --> 00:37:31,440
technique that's used by tasks so APC is

611
00:37:31,440 --> 00:37:33,720
actually getting quite popular uh among

612
00:37:33,720 --> 00:37:35,760
malware authors and there's a miter

613
00:37:35,760 --> 00:37:37,560
attack at the bottom of the slide if you

614
00:37:37,560 --> 00:37:40,380
can see it that lists other families

615
00:37:40,380 --> 00:37:43,800
using it so why is this popular so every

616
00:37:43,800 --> 00:37:46,500
thread in a process has an APC it's a

617
00:37:46,500 --> 00:37:49,260
queue anything that's at and anything

618
00:37:49,260 --> 00:37:50,820
that gets added to that queue is

619
00:37:50,820 --> 00:37:53,640
executed when the thread thread enters

620
00:37:53,640 --> 00:37:55,140
an alertable state

621
00:37:55,140 --> 00:37:58,740
so Bumblebee as you can tell and most

622
00:37:58,740 --> 00:38:00,660
other malware families they like to take

623
00:38:00,660 --> 00:38:03,000
advantage of this so in Bumblebee's case

624
00:38:03,000 --> 00:38:04,920
they'll just create the process in the

625
00:38:04,920 --> 00:38:07,380
suspended mode inject the payload and

626
00:38:07,380 --> 00:38:09,000
add an offset to the payload to the

627
00:38:09,000 --> 00:38:12,720
threads apcq so then as the thread is as

628
00:38:12,720 --> 00:38:14,400
the process is resumed it ends up

629
00:38:14,400 --> 00:38:18,180
executing the code and also they modify

630
00:38:18,180 --> 00:38:20,700
the entry point of the process by adding

631
00:38:20,700 --> 00:38:22,619
instructions that call sleepex in the

632
00:38:22,619 --> 00:38:26,940
loop because sleepex helps to uh set the

633
00:38:26,940 --> 00:38:28,800
thread into that state into the

634
00:38:28,800 --> 00:38:30,060
alertable state

635
00:38:30,060 --> 00:38:32,760
and in addition these processes are

636
00:38:32,760 --> 00:38:34,800
created with wmi and as we've learned

637
00:38:34,800 --> 00:38:38,220
achieves parent PID spoofing

638
00:38:38,220 --> 00:38:40,500
next off is the hook module that's

639
00:38:40,500 --> 00:38:44,040
injected along with the dlls so the

640
00:38:44,040 --> 00:38:46,859
purpose of this is module is to remove

641
00:38:46,859 --> 00:38:50,339
EDR hooks on apis it comes with a list

642
00:38:50,339 --> 00:38:52,680
of hard-coded apis in the binary and it

643
00:38:52,680 --> 00:38:55,619
looks through all those apis so it

644
00:38:55,619 --> 00:38:58,320
Compares those apis instructions in

645
00:38:58,320 --> 00:38:59,940
memory to its instructions on this

646
00:38:59,940 --> 00:39:03,300
physical file on disk because AV is

647
00:39:03,300 --> 00:39:06,420
likely to hook on an API more in memory

648
00:39:06,420 --> 00:39:09,060
it doesn't hook it in disk so it

649
00:39:09,060 --> 00:39:11,160
Compares it using a length disassembler

650
00:39:11,160 --> 00:39:13,320
which calculates the length of each

651
00:39:13,320 --> 00:39:15,119
instruction and it also compares the

652
00:39:15,119 --> 00:39:17,520
prefix and accordingly you know the

653
00:39:17,520 --> 00:39:19,380
length or prefix is different it means

654
00:39:19,380 --> 00:39:21,359
it's hooked in which case it just copies

655
00:39:21,359 --> 00:39:23,940
over the bytes in the physical file to

656
00:39:23,940 --> 00:39:26,460
the to its instructions in memory

657
00:39:26,460 --> 00:39:30,000
effectively removing the hook finally it

658
00:39:30,000 --> 00:39:32,280
uses remote Library injection to load

659
00:39:32,280 --> 00:39:34,500
the payload to appear running as a

660
00:39:34,500 --> 00:39:36,660
legitimate dll so this was the very same

661
00:39:36,660 --> 00:39:39,420
technique used by the loader as well

662
00:39:39,420 --> 00:39:42,060
so I'll quickly expand on this uh the

663
00:39:42,060 --> 00:39:45,660
the function that uses uh the length

664
00:39:45,660 --> 00:39:48,300
disassemble function it borrows a lot

665
00:39:48,300 --> 00:39:50,520
from this open source Library called lip

666
00:39:50,520 --> 00:39:52,200
splice I just wanted to point out it's

667
00:39:52,200 --> 00:39:54,359
quite popular among other families that

668
00:39:54,359 --> 00:39:57,480
have been seen uh and again just to show

669
00:39:57,480 --> 00:39:58,800
that you know it's nothing something

670
00:39:58,800 --> 00:40:00,540
they've implemented on their own and

671
00:40:00,540 --> 00:40:02,339
they're just using some existing code

672
00:40:02,339 --> 00:40:04,380
out there

673
00:40:04,380 --> 00:40:06,720
and that finally brings us to our

674
00:40:06,720 --> 00:40:08,720
conclusion speed mode

675
00:40:08,720 --> 00:40:11,339
so what do these timelines teach us so

676
00:40:11,339 --> 00:40:14,720
from these timelines it helps us to map

677
00:40:14,720 --> 00:40:17,640
the activity of bumblebees software

678
00:40:17,640 --> 00:40:19,440
development life cycle

679
00:40:19,440 --> 00:40:21,720
so clearly the developers they have an

680
00:40:21,720 --> 00:40:24,119
agile methodology with how they go about

681
00:40:24,119 --> 00:40:28,020
building this malware so we see that

682
00:40:28,020 --> 00:40:29,820
right off from the beginning especially

683
00:40:29,820 --> 00:40:32,400
that period in the start 31st Jan until

684
00:40:32,400 --> 00:40:37,079
31st March 2022 that was uh you know the

685
00:40:37,079 --> 00:40:39,000
first release of our malware it was

686
00:40:39,000 --> 00:40:40,680
quite simple it didn't have the loader

687
00:40:40,680 --> 00:40:43,020
was an encrypted and packed and this is

688
00:40:43,020 --> 00:40:45,480
an agile tombs would be called an MVP

689
00:40:45,480 --> 00:40:48,119
which is a minimal viable product and

690
00:40:48,119 --> 00:40:50,160
that's where you know they're testing

691
00:40:50,160 --> 00:40:52,260
out you'll also see this in a lot of

692
00:40:52,260 --> 00:40:55,020
forums underground forums when authors

693
00:40:55,020 --> 00:40:56,579
are trying to sell their malware product

694
00:40:56,579 --> 00:40:58,200
they're like they have some beta version

695
00:40:58,200 --> 00:41:01,320
or an MVP version and it's kind of

696
00:41:01,320 --> 00:41:02,520
hilarious it's kind of like the

697
00:41:02,520 --> 00:41:04,800
crowdfunding for getting the malware

698
00:41:04,800 --> 00:41:07,619
project off the ground but not to say

699
00:41:07,619 --> 00:41:09,660
that we saw the same activity with

700
00:41:09,660 --> 00:41:12,540
bumblebee but just by observing the

701
00:41:12,540 --> 00:41:15,960
bills over time you can see this you can

702
00:41:15,960 --> 00:41:18,300
imagine what that's like

703
00:41:18,300 --> 00:41:20,460
and it's also clear because the second

704
00:41:20,460 --> 00:41:23,280
phase of their release was what

705
00:41:23,280 --> 00:41:26,460
introduced EDR evasion and that was you

706
00:41:26,460 --> 00:41:27,780
know at the end of March when they

707
00:41:27,780 --> 00:41:30,119
introduced the loader and it also had an

708
00:41:30,119 --> 00:41:32,579
EDR vision and we even see three major

709
00:41:32,579 --> 00:41:34,440
Affiliates using it and makes sense

710
00:41:34,440 --> 00:41:36,420
because if you're going to make your

711
00:41:36,420 --> 00:41:38,400
malware live you want to make sure that

712
00:41:38,400 --> 00:41:41,040
it's not detectable

713
00:41:41,040 --> 00:41:43,380
now apart from all of that we also

714
00:41:43,380 --> 00:41:46,020
noticed that these developers they like

715
00:41:46,020 --> 00:41:48,540
to focus on the C2 infrastructure during

716
00:41:48,540 --> 00:41:51,359
the Hiatus in our heads we think of

717
00:41:51,359 --> 00:41:54,240
Hiatus as a break but no they are not on

718
00:41:54,240 --> 00:41:55,619
a break they're on a break from

719
00:41:55,619 --> 00:41:58,140
Distributing the malware this makes

720
00:41:58,140 --> 00:42:01,380
sense because if they're going to you

721
00:42:01,380 --> 00:42:02,300
know

722
00:42:02,300 --> 00:42:04,800
build a new malware they want to make

723
00:42:04,800 --> 00:42:07,200
sure that it's able to communicate with

724
00:42:07,200 --> 00:42:10,020
the back end that works and so it makes

725
00:42:10,020 --> 00:42:12,000
sense why they're going on a break and I

726
00:42:12,000 --> 00:42:13,859
believe right now they're probably on

727
00:42:13,859 --> 00:42:15,300
their third break because I haven't seen

728
00:42:15,300 --> 00:42:17,760
much activity

729
00:42:17,760 --> 00:42:20,820
the developers too they seem to step out

730
00:42:20,820 --> 00:42:22,560
of the norm with how they've gone

731
00:42:22,560 --> 00:42:25,380
building out this malware we don't see

732
00:42:25,380 --> 00:42:27,660
the use of API hashing or string

733
00:42:27,660 --> 00:42:29,839
obfuscation that's actually quite common

734
00:42:29,839 --> 00:42:33,000
now that might likely be the result of

735
00:42:33,000 --> 00:42:35,880
how they are using EDR evasion so as we

736
00:42:35,880 --> 00:42:38,339
saw with the loader and without dll it

737
00:42:38,339 --> 00:42:40,560
spoofs the Edo's call stack and makes it

738
00:42:40,560 --> 00:42:42,599
appear that our malware is running as a

739
00:42:42,599 --> 00:42:45,660
dll or as an API so you know if your

740
00:42:45,660 --> 00:42:48,540
antivirus doesn't think that that memory

741
00:42:48,540 --> 00:42:50,339
space is malicious because it thinks

742
00:42:50,339 --> 00:42:52,740
it's a dll API it's less likely to scan

743
00:42:52,740 --> 00:42:55,020
it and then Yar rules in this case at

744
00:42:55,020 --> 00:42:58,319
this point would be quite useless

745
00:42:58,319 --> 00:42:59,880
um and then finally you know they

746
00:42:59,880 --> 00:43:01,980
clearly have some mature Dev practices

747
00:43:01,980 --> 00:43:03,720
on how they go about doing things

748
00:43:03,720 --> 00:43:05,819
especially the fact that they're using

749
00:43:05,819 --> 00:43:08,220
boost boost you know it's it's open

750
00:43:08,220 --> 00:43:10,260
source but it's very popular in the C

751
00:43:10,260 --> 00:43:12,900
plus Community but it's not commonly

752
00:43:12,900 --> 00:43:15,660
seen in malware and uh useful building

753
00:43:15,660 --> 00:43:17,339
malware there are a few out there but

754
00:43:17,339 --> 00:43:19,260
not common you don't even see them using

755
00:43:19,260 --> 00:43:21,240
Game cheats and and you can guess why

756
00:43:21,240 --> 00:43:23,220
it's quite big in size and quite bulky

757
00:43:23,220 --> 00:43:25,200
but the fact that this is mature is

758
00:43:25,200 --> 00:43:27,060
because they're clearly familiar with

759
00:43:27,060 --> 00:43:29,280
something that is quite common for a

760
00:43:29,280 --> 00:43:31,859
community and they use it I mean they

761
00:43:31,859 --> 00:43:34,319
communicate with the C2 and with the in

762
00:43:34,319 --> 00:43:37,319
the gdt task command and also the fact

763
00:43:37,319 --> 00:43:38,940
that they're using the open source

764
00:43:38,940 --> 00:43:41,160
Library lib splice that's quite common

765
00:43:41,160 --> 00:43:42,720
in splicing you know it's been around

766
00:43:42,720 --> 00:43:45,359
for almost a decade and it makes sense

767
00:43:45,359 --> 00:43:47,880
like if you're going to modify an API in

768
00:43:47,880 --> 00:43:49,920
memory you better know what you're doing

769
00:43:49,920 --> 00:43:52,740
so might as well use something that

770
00:43:52,740 --> 00:43:54,660
works and is quite capable to achieve

771
00:43:54,660 --> 00:43:55,560
the task

772
00:43:55,560 --> 00:43:57,900
so yeah that's about it hope you all

773
00:43:57,900 --> 00:43:59,579
enjoy it and I look forward to questions

774
00:43:59,579 --> 00:44:01,610
during the panel thank you

775
00:44:01,610 --> 00:44:08,199
[Applause]

776
00:44:09,060 --> 00:44:11,160
thanks everyone we will start again in

777
00:44:11,160 --> 00:44:13,020
roughly five minutes so if you want to

778
00:44:13,020 --> 00:44:14,940
change rooms or even move a bit forward

779
00:44:14,940 --> 00:44:17,460
in the room so that you leave more space

780
00:44:17,460 --> 00:44:19,680
for others coming in

781
00:44:19,680 --> 00:44:22,819
see you in five minutes

782
00:44:44,100 --> 00:44:47,179
[Music]

783
00:45:33,000 --> 00:45:35,599
okay

784
00:46:52,859 --> 00:46:55,700
foreign

785
00:47:57,870 --> 00:48:00,969
[Music]

786
00:48:04,940 --> 00:48:08,240
come on there

787
00:49:08,400 --> 00:49:10,579
foreign

788
00:53:58,440 --> 00:54:01,500
morning for for about a week and they

789
00:54:01,500 --> 00:54:04,319
give more detail and say that there was

790
00:54:04,319 --> 00:54:06,839
a malicious uh

791
00:54:06,839 --> 00:54:09,540
attachment with the macro and then it

792
00:54:09,540 --> 00:54:13,759
led to a lower based malware dependency

793
00:54:14,579 --> 00:54:16,859
so according to our visibility most high

794
00:54:16,859 --> 00:54:19,380
profile targets for this cyber spinach

795
00:54:19,380 --> 00:54:21,780
campaign were located in Eastern Europe

796
00:54:21,780 --> 00:54:24,839
around Ukraine and we noticed that the

797
00:54:24,839 --> 00:54:26,780
group was especially interesting

798
00:54:26,780 --> 00:54:29,880
interested in diplomats and people are

799
00:54:29,880 --> 00:54:31,920
working at Ministry of Foreign Affairs

800
00:54:31,920 --> 00:54:35,960
in various countries in this region

801
00:54:37,980 --> 00:54:40,559
so here are examples of malicious

802
00:54:40,559 --> 00:54:43,079
documents that the group has used so the

803
00:54:43,079 --> 00:54:46,319
one of on the left is use some

804
00:54:46,319 --> 00:54:48,599
traditional VBA macro while the one on

805
00:54:48,599 --> 00:54:50,640
on the right that was used if I remember

806
00:54:50,640 --> 00:54:53,880
correctly in June 2022

807
00:54:53,880 --> 00:54:54,900
um against

808
00:54:54,900 --> 00:54:55,559
[Music]

809
00:54:55,559 --> 00:54:56,599
um

810
00:54:56,599 --> 00:54:59,880
growing staff of Moldova so this one was

811
00:54:59,880 --> 00:55:02,160
using the Foreigner vulnerability which

812
00:55:02,160 --> 00:55:05,119
is CV 2022

813
00:55:05,119 --> 00:55:08,460
30190 so it's a vulnerability that leads

814
00:55:08,460 --> 00:55:12,480
to code execution in Microsoft Office

815
00:55:12,480 --> 00:55:15,480
and this one was discovered just few few

816
00:55:15,480 --> 00:55:17,760
weeks before it was used

817
00:55:17,760 --> 00:55:20,760
um so it it shows that the real zombies

818
00:55:20,760 --> 00:55:23,160
schedule is like looking for for new for

819
00:55:23,160 --> 00:55:26,420
new compromise vector

820
00:55:26,700 --> 00:55:29,160
so what's the infection chain first

821
00:55:29,160 --> 00:55:31,859
start with a spearfishing Imaging

822
00:55:31,859 --> 00:55:35,099
um as I just shown then it's a manifest

823
00:55:35,099 --> 00:55:36,900
Office document for example XLS

824
00:55:36,900 --> 00:55:39,180
attachment with a VBA macro

825
00:55:39,180 --> 00:55:42,780
that then download the MSI installer

826
00:55:42,780 --> 00:55:45,900
that will drop the sunset downloader

827
00:55:45,900 --> 00:55:48,380
which is a Lua bus

828
00:55:48,380 --> 00:55:51,059
downloader and then the resistance is

829
00:55:51,059 --> 00:55:53,280
established by dropping a lnk file into

830
00:55:53,280 --> 00:55:56,240
a startup folder

831
00:55:57,900 --> 00:56:00,780
but there is a chain doesn't stop there

832
00:56:00,780 --> 00:56:03,059
so Sunset is a downloader and can

833
00:56:03,059 --> 00:56:05,819
download additional scripts in in Lua

834
00:56:05,819 --> 00:56:07,819
and one of those scripts

835
00:56:07,819 --> 00:56:10,800
is responsible for downloading the next

836
00:56:10,800 --> 00:56:12,119
stage

837
00:56:12,119 --> 00:56:13,680
which is

838
00:56:13,680 --> 00:56:16,319
more or less the same thing as Sunset

839
00:56:16,319 --> 00:56:19,440
but in ottawatki so it's again a

840
00:56:19,440 --> 00:56:22,260
downloader in Auto add key and see this

841
00:56:22,260 --> 00:56:24,480
time this one can download a spying

842
00:56:24,480 --> 00:56:27,660
plugins also in Authority so for example

843
00:56:27,660 --> 00:56:29,880
to take screenshots to steal password in

844
00:56:29,880 --> 00:56:31,920
browser or some

845
00:56:31,920 --> 00:56:35,400
kind of hidden VNC and there are many

846
00:56:35,400 --> 00:56:37,640
more

847
00:56:39,119 --> 00:56:42,980
so this is sunset it's a bit ugly but

848
00:56:42,980 --> 00:56:45,960
onto the obfuscate it

849
00:56:45,960 --> 00:56:46,559
um

850
00:56:46,559 --> 00:56:48,240
with

851
00:56:48,240 --> 00:56:50,819
bit of manual work this is what you what

852
00:56:50,819 --> 00:56:53,520
you obtain so it's quite simple first it

853
00:56:53,520 --> 00:56:55,920
takes the serial number of the C drive

854
00:56:55,920 --> 00:57:00,180
and then it send a HTTP get request to

855
00:57:00,180 --> 00:57:01,640
the CNC server

856
00:57:01,640 --> 00:57:04,980
so there is a IP address of the C2 that

857
00:57:04,980 --> 00:57:07,380
is directly accorded in the code and

858
00:57:07,380 --> 00:57:09,420
then it's a slash under several numbers

859
00:57:09,420 --> 00:57:12,300
that was retrieved and then the read the

860
00:57:12,300 --> 00:57:15,240
reply of this request

861
00:57:15,240 --> 00:57:15,900
um

862
00:57:15,900 --> 00:57:20,240
is lower code that will be interpreted

863
00:57:21,839 --> 00:57:26,160
so this is the the plugin that will drop

864
00:57:26,160 --> 00:57:29,520
the autoate key downloader so it's Lua

865
00:57:29,520 --> 00:57:31,920
script that will just download first

866
00:57:31,920 --> 00:57:37,980
this uh Ms core e uh file so this is the

867
00:57:37,980 --> 00:57:40,680
automatically script and then second it

868
00:57:40,680 --> 00:57:42,540
download the autoot key interpreter

869
00:57:42,540 --> 00:57:44,760
because most of the time the victim

870
00:57:44,760 --> 00:57:46,140
doesn't have the automotive key

871
00:57:46,140 --> 00:57:47,640
interpreter installing the machine so

872
00:57:47,640 --> 00:57:50,839
they need to ship it

873
00:57:51,540 --> 00:57:54,180
this group really like scripting

874
00:57:54,180 --> 00:57:56,640
language for example they develop a

875
00:57:56,640 --> 00:57:59,040
variant of sunset in TCL it was first

876
00:57:59,040 --> 00:58:01,319
time I heard about the the script

877
00:58:01,319 --> 00:58:03,660
language but as you can see it's almost

878
00:58:03,660 --> 00:58:06,119
the same thing except that it doesn't

879
00:58:06,119 --> 00:58:09,000
retrieve the C drive cell number but the

880
00:58:09,000 --> 00:58:11,579
logic is similar like it's an request to

881
00:58:11,579 --> 00:58:15,740
a server and ever the reply

882
00:58:17,579 --> 00:58:20,720
so this is the automatic key downloader

883
00:58:20,720 --> 00:58:24,359
as you can see it's almost the same as

884
00:58:24,359 --> 00:58:26,460
Sunset again

885
00:58:26,460 --> 00:58:30,119
um yeah first it will take the C drive

886
00:58:30,119 --> 00:58:32,940
server number which is put them in the

887
00:58:32,940 --> 00:58:37,680
HTTP request and then it evals the the

888
00:58:37,680 --> 00:58:39,480
code that it's written by by the CNC

889
00:58:39,480 --> 00:58:41,160
server

890
00:58:41,160 --> 00:58:44,040
this is an example of a plugin in

891
00:58:44,040 --> 00:58:47,700
autodesky this one will install a

892
00:58:47,700 --> 00:58:50,220
remote access tool

893
00:58:50,220 --> 00:58:52,700
which is called remote

894
00:58:52,700 --> 00:58:55,619
remote utilities so it's kind of

895
00:58:55,619 --> 00:58:57,619
legitimate tool

896
00:58:57,619 --> 00:59:00,980
but it allows to like to fully control

897
00:59:00,980 --> 00:59:04,500
the machine so actually like this auto

898
00:59:04,500 --> 00:59:08,040
key script just download and execute the

899
00:59:08,040 --> 00:59:11,819
exit tab for remote utilities

900
00:59:11,819 --> 00:59:14,640
this is the full list of plugins that is

901
00:59:14,640 --> 00:59:17,880
available to hkbots so I won't describe

902
00:59:17,880 --> 00:59:21,059
every every single of them but maybe

903
00:59:21,059 --> 00:59:23,760
just just a few so there is a desk

904
00:59:23,760 --> 00:59:26,160
screen plugin to take a screenshots the

905
00:59:26,160 --> 00:59:28,140
screen on the screen office to take

906
00:59:28,140 --> 00:59:30,660
screenshot in Loop

907
00:59:30,660 --> 00:59:31,500
um

908
00:59:31,500 --> 00:59:35,339
then we have this hvnc so agency stands

909
00:59:35,339 --> 00:59:38,160
for hidden VNC but actually in this case

910
00:59:38,160 --> 00:59:40,020
it's not really a

911
00:59:40,020 --> 00:59:42,839
it doesn't use the VNC protocol it just

912
00:59:42,839 --> 00:59:45,720
add less Chrome browser that can be

913
00:59:45,720 --> 00:59:47,240
controlled remotely

914
00:59:47,240 --> 00:59:51,420
not sure what's the exact purpose but it

915
00:59:51,420 --> 00:59:54,240
might be to browse websites that are not

916
00:59:54,240 --> 00:59:55,320
available

917
00:59:55,320 --> 00:59:58,709
[Music]

918
00:59:58,920 --> 01:00:02,220
I mean two two Bros um uh website on the

919
01:00:02,220 --> 01:00:04,680
Internet or on the local network uh

920
01:00:04,680 --> 01:00:07,260
since they don't have any proxy maybe

921
01:00:07,260 --> 01:00:09,359
it's like their way of processing

922
01:00:09,359 --> 01:00:12,140
focusing traffic

923
01:00:12,180 --> 01:00:14,819
there is a key logger uh pretty simple

924
01:00:14,819 --> 01:00:17,480
uh browser password stealer

925
01:00:17,480 --> 01:00:21,720
and the root server on the road server

926
01:00:21,720 --> 01:00:24,960
of plugins that I just talked earlier so

927
01:00:24,960 --> 01:00:26,700
it's quite

928
01:00:26,700 --> 01:00:29,839
typical like

929
01:00:29,839 --> 01:00:34,400
implant used to spy on on a machine

930
01:00:35,339 --> 01:00:38,160
and there is this plugin which is called

931
01:00:38,160 --> 01:00:40,799
delete cookies which is interesting

932
01:00:40,799 --> 01:00:43,440
because for Espionage it's not very

933
01:00:43,440 --> 01:00:45,240
useful it's

934
01:00:45,240 --> 01:00:47,940
delete cookies on the victim machine for

935
01:00:47,940 --> 01:00:51,059
very specific domain including so it's

936
01:00:51,059 --> 01:00:53,359
hard coded the domains are coded here

937
01:00:53,359 --> 01:00:56,040
mail.eru and td.com and as you might

938
01:00:56,040 --> 01:00:59,280
know TD is a Canadian bank so why were

939
01:00:59,280 --> 01:01:02,280
protector want to to delete cookies for

940
01:01:02,280 --> 01:01:05,940
Canadian one so we think that this uh

941
01:01:05,940 --> 01:01:10,140
this plugin is in is aimed at deleting

942
01:01:10,140 --> 01:01:11,940
authentication cookies so that the

943
01:01:11,940 --> 01:01:14,700
victim has to re-authenticate to the

944
01:01:14,700 --> 01:01:16,980
records and then if they run the kilogue

945
01:01:16,980 --> 01:01:18,059
at the same time they can grab

946
01:01:18,059 --> 01:01:21,440
credentials but

947
01:01:21,440 --> 01:01:23,940
existed.com doesn't make sense if you

948
01:01:23,940 --> 01:01:24,799
target

949
01:01:24,799 --> 01:01:28,200
diplomats in Eastern Europe

950
01:01:28,200 --> 01:01:32,579
so let's go back a bit in time and I

951
01:01:32,579 --> 01:01:36,319
found this blog post by a training micro

952
01:01:36,319 --> 01:01:39,420
and that says that it's a group that

953
01:01:39,420 --> 01:01:41,520
targets us and Canadian Bank customer

954
01:01:41,520 --> 01:01:44,520
and if we scroll down a little bit we

955
01:01:44,520 --> 01:01:45,559
have this

956
01:01:45,559 --> 01:01:49,440
nice figure and as you can see the

957
01:01:49,440 --> 01:01:53,339
infection is the chain starts with a XLS

958
01:01:53,339 --> 01:01:57,119
file with a VBA micro

959
01:01:57,119 --> 01:02:00,240
then we have a automatic key downloader

960
01:02:00,240 --> 01:02:03,119
that can download additional scripts so

961
01:02:03,119 --> 01:02:06,599
probably sounds quite familiar

962
01:02:06,599 --> 01:02:08,520
and then we scroll down again and there

963
01:02:08,520 --> 01:02:12,540
is an example of of a plugin so this one

964
01:02:12,540 --> 01:02:14,760
is a browser password still

965
01:02:14,760 --> 01:02:18,240
and if we compare to the plugin called

966
01:02:18,240 --> 01:02:21,119
passwords that we that that we found in

967
01:02:21,119 --> 01:02:23,160
our Spanish campaign it's actually

968
01:02:23,160 --> 01:02:25,740
exactly the same thing

969
01:02:25,740 --> 01:02:30,000
so it seems that the toolkit use in this

970
01:02:30,000 --> 01:02:32,339
threat micro article from 2020 is the

971
01:02:32,339 --> 01:02:34,880
same that was used to Target

972
01:02:34,880 --> 01:02:39,440
government Staff last year

973
01:02:40,260 --> 01:02:42,480
so easy to acquire a group that switch

974
01:02:42,480 --> 01:02:45,540
to espionage during the war

975
01:02:45,540 --> 01:02:49,740
actually not because uh we did we dug

976
01:02:49,740 --> 01:02:52,440
into older campaign and we found we

977
01:02:52,440 --> 01:02:55,200
found that since 2020 the Roman biscuit

978
01:02:55,200 --> 01:02:57,480
have been targeting government officials

979
01:02:57,480 --> 01:02:59,339
and people working in state-owned

980
01:02:59,339 --> 01:03:01,980
companies uh mostly in Central Asia and

981
01:03:01,980 --> 01:03:04,559
also Armenia so it means that they have

982
01:03:04,559 --> 01:03:08,040
been doing uh cybercromb and cyber

983
01:03:08,040 --> 01:03:09,960
Espionage since the beginning of their

984
01:03:09,960 --> 01:03:11,520
operation

985
01:03:11,520 --> 01:03:15,359
yeah so I answered to to the question

986
01:03:15,359 --> 01:03:18,420
a bit early but uh

987
01:03:18,420 --> 01:03:21,299
yes they do Cyborg and cyber spinach

988
01:03:21,299 --> 01:03:23,819
we also noticed that so at the beginning

989
01:03:23,819 --> 01:03:25,619
of last year they were mostly doing

990
01:03:25,619 --> 01:03:28,260
Subway spinach but then starting October

991
01:03:28,260 --> 01:03:31,440
2022 we have started to to see more and

992
01:03:31,440 --> 01:03:34,500
more cyber frame companies

993
01:03:34,500 --> 01:03:35,880
um

994
01:03:35,880 --> 01:03:40,079
we we found our own a bit more than 4

995
01:03:40,079 --> 01:03:43,380
000 victims since the beginning of 2022

996
01:03:43,380 --> 01:03:45,660
and as you can see most of them are

997
01:03:45,660 --> 01:03:48,440
located in the US Canada

998
01:03:48,440 --> 01:03:51,480
and also between in Europe as you can

999
01:03:51,480 --> 01:03:54,780
see Germany but what is interesting is

1000
01:03:54,780 --> 01:03:57,359
that there are also quite few victims in

1001
01:03:57,359 --> 01:03:59,779
Russia

1002
01:04:00,900 --> 01:04:04,020
yeah so we considered more than 4 500

1003
01:04:04,020 --> 01:04:07,440
victims since uh January last year and

1004
01:04:07,440 --> 01:04:09,599
interestingly there is a big spike of

1005
01:04:09,599 --> 01:04:13,740
infection uh almost uh once a month so

1006
01:04:13,740 --> 01:04:16,440
these are the the latest one we observed

1007
01:04:16,440 --> 01:04:19,260
was in early March I didn't observe

1008
01:04:19,260 --> 01:04:22,200
anything like another campaign since

1009
01:04:22,200 --> 01:04:24,420
that time but maybe the complete change

1010
01:04:24,420 --> 01:04:26,160
the toolkit I'm not sure

1011
01:04:26,160 --> 01:04:29,040
and most victims for cyber Queen

1012
01:04:29,040 --> 01:04:32,460
campaigns are cryptocurrency Traders and

1013
01:04:32,460 --> 01:04:34,980
also small and medium businesses I don't

1014
01:04:34,980 --> 01:04:36,839
think they are specifically targeting

1015
01:04:36,839 --> 01:04:38,940
like anyone

1016
01:04:38,940 --> 01:04:40,020
um

1017
01:04:40,020 --> 01:04:43,140
just random small businesses in U.S and

1018
01:04:43,140 --> 01:04:45,379
Canada

1019
01:04:45,960 --> 01:04:48,859
so how is the

1020
01:04:48,859 --> 01:04:51,720
malware delivery for the cyber crime

1021
01:04:51,720 --> 01:04:53,940
companies so they must use a traffic

1022
01:04:53,940 --> 01:04:56,700
direction system to redirect targets to

1023
01:04:56,700 --> 01:04:58,740
manifest pages

1024
01:04:58,740 --> 01:05:01,319
unfortunately in our Telemetry we did

1025
01:05:01,319 --> 01:05:03,119
not observe how people landed on the

1026
01:05:03,119 --> 01:05:05,160
first note of the TDS but open source

1027
01:05:05,160 --> 01:05:06,900
reporting suggests that the attackers

1028
01:05:06,900 --> 01:05:09,839
are selling sending specification emails

1029
01:05:09,839 --> 01:05:13,079
with links or PDF documents with links

1030
01:05:13,079 --> 01:05:15,960
to these first nodes of the TDS and it's

1031
01:05:15,960 --> 01:05:17,819
also possible that visitors from

1032
01:05:17,819 --> 01:05:20,400
compromised websites are redirected to

1033
01:05:20,400 --> 01:05:22,619
this TDS

1034
01:05:22,619 --> 01:05:26,040
so it's an example of a chain for the

1035
01:05:26,040 --> 01:05:29,760
studios that I found on urscan.io so the

1036
01:05:29,760 --> 01:05:32,520
target will first visit the the website

1037
01:05:32,520 --> 01:05:35,880
local kitchencodes.com

1038
01:05:36,000 --> 01:05:39,319
um then they will be redirected to a

1039
01:05:39,319 --> 01:05:42,780
second domain which is a bit odd to

1040
01:05:42,780 --> 01:05:47,339
pronoun so I won't do it and then there

1041
01:05:47,339 --> 01:05:50,220
is a third redirection to take for

1042
01:05:50,220 --> 01:05:51,839
solutions.com

1043
01:05:51,839 --> 01:05:54,720
and on this one there is a delivery of

1044
01:05:54,720 --> 01:05:58,140
malicious JavaScript files in that case

1045
01:05:58,140 --> 01:06:00,780
it was named document one December some

1046
01:06:00,780 --> 01:06:05,460
random number.js and it's almost every

1047
01:06:05,460 --> 01:06:08,119
time the same pattern for for the

1048
01:06:08,119 --> 01:06:10,920
manifold JavaScript so it's always like

1049
01:06:10,920 --> 01:06:13,140
document or notice or something like

1050
01:06:13,140 --> 01:06:15,359
that and then the date of the campaign

1051
01:06:15,359 --> 01:06:19,040
and then some random number

1052
01:06:20,040 --> 01:06:22,980
in some other cases there are also fake

1053
01:06:22,980 --> 01:06:26,039
so people are originated from the TDS to

1054
01:06:26,039 --> 01:06:30,420
fake Zoom pages and then from the zoom

1055
01:06:30,420 --> 01:06:32,819
Pages if you click download then you'll

1056
01:06:32,819 --> 01:06:35,280
also get a malicious Javascript file and

1057
01:06:35,280 --> 01:06:40,319
there are also some for uh TeamViewer as

1058
01:06:40,319 --> 01:06:42,660
you can see there is some typo new

1059
01:06:42,660 --> 01:06:47,180
version and I think it's written

1060
01:06:47,180 --> 01:06:50,880
it's actually it's not team viewer in

1061
01:06:50,880 --> 01:06:52,859
the title it's 2v if I remember

1062
01:06:52,859 --> 01:06:55,460
correctly

1063
01:06:57,480 --> 01:06:59,520
um

1064
01:06:59,520 --> 01:07:02,640
so this is a another Trend that that we

1065
01:07:02,640 --> 01:07:04,940
found with uh like

1066
01:07:04,940 --> 01:07:07,680
necodilemation.com is part of the CDs it

1067
01:07:07,680 --> 01:07:10,380
redirected to this document.js

1068
01:07:10,380 --> 01:07:11,119
um

1069
01:07:11,119 --> 01:07:13,980
manuscript and then it downloaded HK

1070
01:07:13,980 --> 01:07:16,380
button so this is clearly like part of

1071
01:07:16,380 --> 01:07:18,319
the realm of biscuit operation

1072
01:07:18,319 --> 01:07:23,520
but if we look for this domain on on

1073
01:07:23,520 --> 01:07:25,760
various total for example

1074
01:07:25,760 --> 01:07:29,280
we can see that the same domain was used

1075
01:07:29,280 --> 01:07:32,099
to to deliver like a different like MSC

1076
01:07:32,099 --> 01:07:36,859
file with jobs actually a partial script

1077
01:07:37,260 --> 01:07:40,079
and this partial script will reach out

1078
01:07:40,079 --> 01:07:43,980
to download cdn.com and this domain was

1079
01:07:43,980 --> 01:07:45,960
apparently controlled by another

1080
01:07:45,960 --> 01:07:50,280
cyberpunk actor called ta 505 in 2020 so

1081
01:07:50,280 --> 01:07:52,920
it's possible that the domain change

1082
01:07:52,920 --> 01:07:56,819
ends but in any case like this uh

1083
01:07:56,819 --> 01:07:58,380
professional downloader it's actually

1084
01:07:58,380 --> 01:08:00,559
not part of srmometers guide operation

1085
01:08:00,559 --> 01:08:04,940
so what it means is that the TDs is not

1086
01:08:04,940 --> 01:08:08,099
exclusive to the realm of biscuit so it

1087
01:08:08,099 --> 01:08:10,980
was probably used by CA 505 we've also

1088
01:08:10,980 --> 01:08:13,200
seen some cubot distribution for for

1089
01:08:13,200 --> 01:08:16,319
from it so it's probably some paid

1090
01:08:16,319 --> 01:08:19,198
underground services that that the group

1091
01:08:19,198 --> 01:08:21,600
is using to distribute and install the

1092
01:08:21,600 --> 01:08:23,219
malware they're probably like paying

1093
01:08:23,219 --> 01:08:25,920
someone else to to do some yeah to

1094
01:08:25,920 --> 01:08:29,899
distribute their tools

1095
01:08:30,120 --> 01:08:33,660
there was also some mention of Google

1096
01:08:33,660 --> 01:08:36,060
ads uh many shoes garage that redirect

1097
01:08:36,060 --> 01:08:38,819
to this to those many shoes websites so

1098
01:08:38,819 --> 01:08:40,799
we did not really observe it in our

1099
01:08:40,799 --> 01:08:42,899
Telemetry but there is a blog post on

1100
01:08:42,899 --> 01:08:45,479
the sun's website and you can see like

1101
01:08:45,479 --> 01:08:48,299
this is fake ads for TeamViewer and

1102
01:08:48,299 --> 01:08:50,950
actually it redirects to one of the

1103
01:08:50,950 --> 01:08:51,420
[Music]

1104
01:08:51,420 --> 01:08:52,859
um

1105
01:08:52,859 --> 01:08:56,100
uh fake pages that I mentioned just a

1106
01:08:56,100 --> 01:08:58,819
few slides before

1107
01:09:01,560 --> 01:09:04,920
um so in in any case either like the TDS

1108
01:09:04,920 --> 01:09:07,319
or the man issues Google ads they lead

1109
01:09:07,319 --> 01:09:10,259
to a Javascript file which is a bit

1110
01:09:10,259 --> 01:09:12,299
obfuscated

1111
01:09:12,299 --> 01:09:13,020
um

1112
01:09:13,020 --> 01:09:15,960
but we can like reconstruct the URL and

1113
01:09:15,960 --> 01:09:17,880
actually it will call it install product

1114
01:09:17,880 --> 01:09:20,580
to download the MSI to to download and

1115
01:09:20,580 --> 01:09:24,238
install MSI from from this URL

1116
01:09:24,238 --> 01:09:27,420
so probably uh the realm of biscuit was

1117
01:09:27,420 --> 01:09:30,000
providing this MSI and even the

1118
01:09:30,000 --> 01:09:31,979
JavaScript was controlled by same group

1119
01:09:31,979 --> 01:09:35,479
as as rotds

1120
01:09:37,500 --> 01:09:40,439
if the target executes the jscript it

1121
01:09:40,439 --> 01:09:43,439
download the MSI package that drops this

1122
01:09:43,439 --> 01:09:47,580
VBS downloader and again it's similar to

1123
01:09:47,580 --> 01:09:51,120
sunseed or ahk bot you can see that it

1124
01:09:51,120 --> 01:09:54,000
gets the C Direction number and then

1125
01:09:54,000 --> 01:09:56,400
does the HTTP get request in this case

1126
01:09:56,400 --> 01:09:58,160
it will not download

1127
01:09:58,160 --> 01:10:01,860
VBS scripts but download and install

1128
01:10:01,860 --> 01:10:04,620
another MSI package

1129
01:10:04,620 --> 01:10:07,140
and this MSI package can contain for

1130
01:10:07,140 --> 01:10:09,840
example hkbots or new python screen

1131
01:10:09,840 --> 01:10:11,100
shooter

1132
01:10:11,100 --> 01:10:13,800
and also in the latest campaigns we have

1133
01:10:13,800 --> 01:10:16,679
seen a few more plugins for for the

1134
01:10:16,679 --> 01:10:19,980
autoot key downloader

1135
01:10:19,980 --> 01:10:24,600
so this is a python screenshotter uh

1136
01:10:24,600 --> 01:10:28,080
it's it's quite simple like it just take

1137
01:10:28,080 --> 01:10:30,330
a screenshot and infiltrate it

1138
01:10:30,330 --> 01:10:30,960
[Music]

1139
01:10:30,960 --> 01:10:31,820
um

1140
01:10:31,820 --> 01:10:34,440
also the feeling how it's it's written

1141
01:10:34,440 --> 01:10:36,960
it's always similar to in every

1142
01:10:36,960 --> 01:10:39,540
scripting language so I believe like one

1143
01:10:39,540 --> 01:10:41,880
person develops all these tools in all

1144
01:10:41,880 --> 01:10:45,840
those in all those different languages

1145
01:10:45,840 --> 01:10:48,120
there is also a

1146
01:10:48,120 --> 01:10:50,699
so if you remember there was this

1147
01:10:50,699 --> 01:10:54,000
more or less a Don VNC but now they have

1148
01:10:54,000 --> 01:10:56,880
something that they call hcmd and

1149
01:10:56,880 --> 01:10:59,179
actually it's a reversal written in

1150
01:10:59,179 --> 01:11:02,820
not.js why not

1151
01:11:02,820 --> 01:11:05,480
and

1152
01:11:06,239 --> 01:11:09,179
yeah actually there are a few functions

1153
01:11:09,179 --> 01:11:12,239
but the goal is just to execute some

1154
01:11:12,239 --> 01:11:14,580
some comment with cmd.exe and send the

1155
01:11:14,580 --> 01:11:18,380
result back to to the CNC server

1156
01:11:18,420 --> 01:11:22,260
and there is a new password stealer and

1157
01:11:22,260 --> 01:11:24,239
it will

1158
01:11:24,239 --> 01:11:27,360
and what is interesting is at the end so

1159
01:11:27,360 --> 01:11:29,880
they download and execute another like

1160
01:11:29,880 --> 01:11:31,800
executable which is download address

1161
01:11:31,800 --> 01:11:34,140
here and what is interesting there is

1162
01:11:34,140 --> 01:11:36,480
some common inversions saying that here

1163
01:11:36,480 --> 01:11:38,280
it is not known what the function should

1164
01:11:38,280 --> 01:11:40,500
be written so it's

1165
01:11:40,500 --> 01:11:42,360
probably referring to see that they

1166
01:11:42,360 --> 01:11:43,800
don't really know what what they are

1167
01:11:43,800 --> 01:11:45,920
doing

1168
01:11:46,980 --> 01:11:49,440
and the last one that they have added

1169
01:11:49,440 --> 01:11:52,699
probably because they started to really

1170
01:11:52,699 --> 01:11:55,380
compromise more and more

1171
01:11:55,380 --> 01:11:58,980
like companies is that with this script

1172
01:11:58,980 --> 01:12:01,020
to to gather information about the

1173
01:12:01,020 --> 01:12:02,840
active directory

1174
01:12:02,840 --> 01:12:06,900
so the execute a bunch of of comments

1175
01:12:06,900 --> 01:12:09,300
like another test or net group or domain

1176
01:12:09,300 --> 01:12:12,300
computers slash domain extra

1177
01:12:12,300 --> 01:12:15,239
and then again the actual thread to like

1178
01:12:15,239 --> 01:12:17,520
this part is very similar in all

1179
01:12:17,520 --> 01:12:19,980
programs

1180
01:12:19,980 --> 01:12:22,920
and what comes after of course cobal

1181
01:12:22,920 --> 01:12:24,420
strike

1182
01:12:24,420 --> 01:12:25,080
um

1183
01:12:25,080 --> 01:12:27,179
then after cover track we haven't

1184
01:12:27,179 --> 01:12:29,400
observed any further activity but it's

1185
01:12:29,400 --> 01:12:32,040
likely that attackers are deploying

1186
01:12:32,040 --> 01:12:35,520
other stages or reselling the infecting

1187
01:12:35,520 --> 01:12:37,500
machine to run somewhere Affiliates for

1188
01:12:37,500 --> 01:12:39,360
example because

1189
01:12:39,360 --> 01:12:41,580
yes they can monetize their activity

1190
01:12:41,580 --> 01:12:44,940
with the password Stealers or I don't

1191
01:12:44,940 --> 01:12:47,640
know they can take screenshots and

1192
01:12:47,640 --> 01:12:48,540
and

1193
01:12:48,540 --> 01:12:51,300
get some private information but

1194
01:12:51,300 --> 01:12:53,280
I think that there are really monitoring

1195
01:12:53,280 --> 01:12:55,500
monetizing uh also the infecting machine

1196
01:12:55,500 --> 01:12:57,300
after

1197
01:12:57,300 --> 01:13:00,000
cobal thread configuration is quite

1198
01:13:00,000 --> 01:13:02,460
typical so yes you have like your

1199
01:13:02,460 --> 01:13:04,739
domains know that.com I believe they

1200
01:13:04,739 --> 01:13:07,560
control that it uses a jQuery malleable

1201
01:13:07,560 --> 01:13:11,340
profile and if we scroll down there is a

1202
01:13:11,340 --> 01:13:14,360
watermark and it's non-watermark used by

1203
01:13:14,360 --> 01:13:17,040
many many cyberphone groups so it's

1204
01:13:17,040 --> 01:13:19,140
probably some leak cover swag Builder

1205
01:13:19,140 --> 01:13:22,580
from long time ago

1206
01:13:23,340 --> 01:13:25,860
and then two months ago they did some

1207
01:13:25,860 --> 01:13:27,380
retelling

1208
01:13:27,380 --> 01:13:30,320
they decided to redevelop everything in

1209
01:13:30,320 --> 01:13:34,679
not.js so including ahk bots so this is

1210
01:13:34,679 --> 01:13:37,140
the new back door that we name not Bots

1211
01:13:37,140 --> 01:13:38,580
but it's

1212
01:13:38,580 --> 01:13:41,280
as you can see the same that c drivers

1213
01:13:41,280 --> 01:13:43,980
are number get request and then execute

1214
01:13:43,980 --> 01:13:45,480
the results

1215
01:13:45,480 --> 01:13:47,280
difference is that everything is in

1216
01:13:47,280 --> 01:13:48,620
JavaScript now

1217
01:13:48,620 --> 01:13:52,860
and they have started redeveloping the

1218
01:13:52,860 --> 01:13:55,020
plugins from Auto add key to JavaScript

1219
01:13:55,020 --> 01:13:57,360
so they haven't finished like developing

1220
01:13:57,360 --> 01:13:59,280
redeveloping everything but some of them

1221
01:13:59,280 --> 01:14:01,800
are already known done for example the

1222
01:14:01,800 --> 01:14:04,820
browser password still

1223
01:14:06,659 --> 01:14:07,320
um

1224
01:14:07,320 --> 01:14:10,679
or the screen shutter this one actually

1225
01:14:10,679 --> 01:14:13,380
it downloads another tool which is

1226
01:14:13,380 --> 01:14:16,140
called ear fan view it's some

1227
01:14:16,140 --> 01:14:19,320
tools to to do to to edit pictures but

1228
01:14:19,320 --> 01:14:21,360
actually it can be used in command 92 to

1229
01:14:21,360 --> 01:14:24,019
take screenshots

1230
01:14:26,219 --> 01:14:26,880
um

1231
01:14:26,880 --> 01:14:29,460
some other experimentation that we have

1232
01:14:29,460 --> 01:14:32,460
observed like in March is that they have

1233
01:14:32,460 --> 01:14:35,280
started playing with a lnk file

1234
01:14:35,280 --> 01:14:38,699
um so since Microsoft disabled by

1235
01:14:38,699 --> 01:14:41,280
default macro downloaded from the

1236
01:14:41,280 --> 01:14:43,620
internet and care if I have have become

1237
01:14:43,620 --> 01:14:47,940
some very very popular uh last year

1238
01:14:47,940 --> 01:14:50,340
among like all two attackers and other

1239
01:14:50,340 --> 01:14:53,040
remote biscuit is no exception and

1240
01:14:53,040 --> 01:14:54,780
they're also starting to play with the

1241
01:14:54,780 --> 01:14:57,420
dot pip file which are

1242
01:14:57,420 --> 01:15:00,380
like just office

1243
01:15:00,380 --> 01:15:03,600
file for Microsoft Publisher

1244
01:15:03,600 --> 01:15:07,320
so as we can see here for example uh one

1245
01:15:07,320 --> 01:15:08,460
of the

1246
01:15:08,460 --> 01:15:11,159
operator uploaded a bunch of file on

1247
01:15:11,159 --> 01:15:13,260
various total probably in order to to

1248
01:15:13,260 --> 01:15:15,480
try to to bypass the detection so we can

1249
01:15:15,480 --> 01:15:17,580
see at the beginning there was one

1250
01:15:17,580 --> 01:15:19,860
detection then a few minutes after five

1251
01:15:19,860 --> 01:15:22,580
detection and finally zero detection

1252
01:15:22,580 --> 01:15:26,780
after 27 minutes

1253
01:15:27,800 --> 01:15:31,500
some words about the attribution uh so

1254
01:15:31,500 --> 01:15:33,780
there was again another blog post by

1255
01:15:33,780 --> 01:15:36,120
proof point which was published early

1256
01:15:36,120 --> 01:15:37,320
February

1257
01:15:37,320 --> 01:15:40,620
and so what the they have named the

1258
01:15:40,620 --> 01:15:43,800
group here ta86s but actually the cyber

1259
01:15:43,800 --> 01:15:46,260
crime project I was describing

1260
01:15:46,260 --> 01:15:49,860
so now the question is between Espionage

1261
01:15:49,860 --> 01:15:51,780
and Cyborg Prime clusters is it the same

1262
01:15:51,780 --> 01:15:56,300
group or is it some Network it for sale

1263
01:15:57,960 --> 01:16:00,060
um so we think it's it's the same group

1264
01:16:00,060 --> 01:16:02,460
because the level of activity is is

1265
01:16:02,460 --> 01:16:05,699
quite low we we considered like a bit

1266
01:16:05,699 --> 01:16:09,659
more than 4 000 victims it comes Sons I

1267
01:16:09,659 --> 01:16:12,300
but if the if the toolkit was shared on

1268
01:16:12,300 --> 01:16:14,940
multiple cyberpunk groups it will be way

1269
01:16:14,940 --> 01:16:16,020
higher

1270
01:16:16,020 --> 01:16:19,020
and second the network infrastructure is

1271
01:16:19,020 --> 01:16:21,060
very similar for oral cyber explanation

1272
01:16:21,060 --> 01:16:23,460
cyber open campaigns for comparison

1273
01:16:23,460 --> 01:16:26,100
server usually located at same hosting

1274
01:16:26,100 --> 01:16:28,320
providers so it's likely that a single

1275
01:16:28,320 --> 01:16:31,020
person manage all this infrastructure

1276
01:16:31,020 --> 01:16:34,020
and third the tool set is Razor basic

1277
01:16:34,020 --> 01:16:36,179
and in comparison to other cremor black

1278
01:16:36,179 --> 01:16:39,719
doors that four sets that we have seen

1279
01:16:39,719 --> 01:16:42,960
so assessment is that it's a rhyming

1280
01:16:42,960 --> 01:16:45,060
biscuit is a cyber coin group that is

1281
01:16:45,060 --> 01:16:47,699
doing Espionage on the side for

1282
01:16:47,699 --> 01:16:49,920
for some some reason like we don't know

1283
01:16:49,920 --> 01:16:52,739
for who they are working but they are

1284
01:16:52,739 --> 01:16:56,718
clearly engaging in Espionage as well

1285
01:16:58,980 --> 01:17:00,000
um

1286
01:17:00,000 --> 01:17:03,239
so lastly uh why they will do

1287
01:17:03,239 --> 01:17:06,300
financially motivated activity

1288
01:17:06,300 --> 01:17:10,440
um since Espionage is not like addressed

1289
01:17:10,440 --> 01:17:12,840
a few operations and not their main

1290
01:17:12,840 --> 01:17:15,060
operations it's unlikely that they use

1291
01:17:15,060 --> 01:17:17,159
cybercom to fund the Espionage operation

1292
01:17:17,159 --> 01:17:19,620
which is likely that it's for the

1293
01:17:19,620 --> 01:17:22,460
personal profit

1294
01:17:22,640 --> 01:17:25,560
and during our investigation we found a

1295
01:17:25,560 --> 01:17:27,840
few ends about origin of the attackers

1296
01:17:27,840 --> 01:17:30,360
so first in

1297
01:17:30,360 --> 01:17:33,480
most plugins or most marvelously

1298
01:17:33,480 --> 01:17:36,239
developed there are Russian strings and

1299
01:17:36,239 --> 01:17:38,219
most of them like the restraint language

1300
01:17:38,219 --> 01:17:42,060
is like really good quality so it it was

1301
01:17:42,060 --> 01:17:45,960
written by a Russian native speaker

1302
01:17:45,960 --> 01:17:48,840
so this one says my number for debugging

1303
01:17:48,840 --> 01:17:51,360
so it's likely that this two number are

1304
01:17:51,360 --> 01:17:53,460
the C drive serial numbers of the

1305
01:17:53,460 --> 01:17:54,800
developer

1306
01:17:54,800 --> 01:17:58,199
and also if you remember the targets of

1307
01:17:58,199 --> 01:17:59,699
the server is finished campaign it was

1308
01:17:59,699 --> 01:18:02,520
first Central Asia and then Ukraine and

1309
01:18:02,520 --> 01:18:05,400
its neighbors so it really suggests that

1310
01:18:05,400 --> 01:18:07,800
attackers are somehow connected to to

1311
01:18:07,800 --> 01:18:10,500
Belarus or Russia because they are like

1312
01:18:10,500 --> 01:18:12,719
the two main states that are like spying

1313
01:18:12,719 --> 01:18:15,380
in this region

1314
01:18:15,480 --> 01:18:18,420
so let's conclude this uh this talk

1315
01:18:18,420 --> 01:18:21,300
first back to the original question so

1316
01:18:21,300 --> 01:18:23,400
our Russian cyber criminals targeting

1317
01:18:23,400 --> 01:18:27,060
European and its allies so yes and no so

1318
01:18:27,060 --> 01:18:29,040
the realm of biscuit is a good example

1319
01:18:29,040 --> 01:18:31,620
of that it's probably a Russian

1320
01:18:31,620 --> 01:18:34,560
operation cyber criminals that are

1321
01:18:34,560 --> 01:18:37,020
that were doing Espionage in Central

1322
01:18:37,020 --> 01:18:39,300
Asia but then they moved to Eastern

1323
01:18:39,300 --> 01:18:40,739
Eastern Europe at the beginning of the

1324
01:18:40,739 --> 01:18:43,980
of the war but on the other end it's

1325
01:18:43,980 --> 01:18:46,380
only one of the few it's only one

1326
01:18:46,380 --> 01:18:49,260
example and we we haven't seen like a

1327
01:18:49,260 --> 01:18:52,800
very big trend of cyber criminals

1328
01:18:52,800 --> 01:18:55,920
starting to Target Ukraine or Poland or

1329
01:18:55,920 --> 01:18:58,860
such countries so we should be careful

1330
01:18:58,860 --> 01:19:01,320
when trying to link every cyber crime

1331
01:19:01,320 --> 01:19:03,719
incident in Western countries to to the

1332
01:19:03,719 --> 01:19:06,500
war in Ukraine

1333
01:19:10,640 --> 01:19:12,900
I believe there are cyber criminals

1334
01:19:12,900 --> 01:19:16,020
doing a bit of cyber spinach they have a

1335
01:19:16,020 --> 01:19:18,239
basic tool set but it seems to work even

1336
01:19:18,239 --> 01:19:21,179
against Ministry of Foreign Affairs and

1337
01:19:21,179 --> 01:19:23,460
they really like to redevelop the same

1338
01:19:23,460 --> 01:19:27,060
thing in different scripting language uh

1339
01:19:27,060 --> 01:19:29,640
we will see what scripting languages

1340
01:19:29,640 --> 01:19:31,699
next

1341
01:19:31,699 --> 01:19:34,679
uh thanks for your attention and

1342
01:19:34,679 --> 01:19:37,080
frequently finishing to write a blog

1343
01:19:37,080 --> 01:19:39,239
post that will be published on our blog

1344
01:19:39,239 --> 01:19:43,699
with ifsecurity.com in a few weeks

1345
01:19:48,659 --> 01:19:50,820
thanks everyone Thanks for attending we

1346
01:19:50,820 --> 01:19:52,739
are right on time so what we will do is

1347
01:19:52,739 --> 01:19:55,080
that before taking any of your questions

1348
01:19:55,080 --> 01:19:57,900
we will re uh we'll bring some chairs on

1349
01:19:57,900 --> 01:19:59,460
stage and we'll have a panel with Sue

1350
01:19:59,460 --> 01:20:00,719
and matter so if you have questions

1351
01:20:00,719 --> 01:20:03,600
please uh ask them you can ask them over

1352
01:20:03,600 --> 01:20:06,300
Silo as well and we will start in a bit

1353
01:20:06,300 --> 01:20:08,159
less than 15 minutes so please stay

1354
01:20:08,159 --> 01:20:11,179
tuned thank you again

1355
01:20:16,020 --> 01:20:18,860
foreign

1356
01:22:06,239 --> 01:22:08,780
foreign

1357
01:22:47,640 --> 01:22:50,640
foreign

1358
01:23:53,560 --> 01:23:56,629
[Music]

1359
01:24:05,520 --> 01:24:07,760
foreign

1360
01:25:09,540 --> 01:25:12,540
foreign

1361
01:26:46,800 --> 01:26:49,800
foreign

1362
01:27:50,400 --> 01:27:53,400
foreign

1363
01:29:13,610 --> 01:29:16,688
[Music]

1364
01:29:36,719 --> 01:29:39,719
mountains

1365
01:30:23,820 --> 01:30:26,239
foreign

1366
01:31:32,880 --> 01:31:35,880
foreign

1367
01:32:52,320 --> 01:32:54,860
all right

1368
01:34:00,420 --> 01:34:03,420
foreign

1369
01:34:33,660 --> 01:34:36,720
[Music]

1370
01:35:26,400 --> 01:35:28,638
foreign

1371
01:35:57,380 --> 01:36:00,060
with the panel with our two previous

1372
01:36:00,060 --> 01:36:02,219
presenters so it matters so thanks again

1373
01:36:02,219 --> 01:36:04,080
for presenting

1374
01:36:04,080 --> 01:36:05,520
um I really enjoyed the presentations

1375
01:36:05,520 --> 01:36:07,500
while the topic were completely

1376
01:36:07,500 --> 01:36:09,179
different I think there are many things

1377
01:36:09,179 --> 01:36:10,800
that were similar

1378
01:36:10,800 --> 01:36:12,420
in reverse engineering and technical

1379
01:36:12,420 --> 01:36:15,780
analysis to understand how attackers or

1380
01:36:15,780 --> 01:36:17,940
managed actors are behaving how they're

1381
01:36:17,940 --> 01:36:20,820
evolving over time I think it was also

1382
01:36:20,820 --> 01:36:22,620
interesting to note that it is likely

1383
01:36:22,620 --> 01:36:24,540
that both actors are operating from the

1384
01:36:24,540 --> 01:36:26,460
same region of the world

1385
01:36:26,460 --> 01:36:27,480
and while at the same time the

1386
01:36:27,480 --> 01:36:29,040
motivations are different so I think

1387
01:36:29,040 --> 01:36:30,239
this was really

1388
01:36:30,239 --> 01:36:32,040
good um the first question I have for

1389
01:36:32,040 --> 01:36:33,420
you and actually we have a couple

1390
01:36:33,420 --> 01:36:34,620
questions from the audience already

1391
01:36:34,620 --> 01:36:37,980
thank you if you have more we will have

1392
01:36:37,980 --> 01:36:39,900
microphones you can ask them or you can

1393
01:36:39,900 --> 01:36:42,360
ask them on Silo as well

1394
01:36:42,360 --> 01:36:43,139
um

1395
01:36:43,139 --> 01:36:46,080
so that's it please uh yeah please send

1396
01:36:46,080 --> 01:36:47,400
your questions if you have them but

1397
01:36:47,400 --> 01:36:48,840
before that I'll start with two of my

1398
01:36:48,840 --> 01:36:51,360
own questions just to warm you up warm

1399
01:36:51,360 --> 01:36:53,040
you up and get you accustomed to the

1400
01:36:53,040 --> 01:36:54,900
microphones

1401
01:36:54,900 --> 01:36:56,100
um yeah so my first question and I'll

1402
01:36:56,100 --> 01:36:58,560
start with you sue if you had unlimited

1403
01:36:58,560 --> 01:37:00,179
resources

1404
01:37:00,179 --> 01:37:02,639
and you had to do that research again

1405
01:37:02,639 --> 01:37:04,679
in unlimited resources in the sense of

1406
01:37:04,679 --> 01:37:07,500
both money but also reverse Engineers

1407
01:37:07,500 --> 01:37:09,360
contacts in the government is there

1408
01:37:09,360 --> 01:37:10,920
anything you do different or you wish

1409
01:37:10,920 --> 01:37:12,360
you had the resources to do something

1410
01:37:12,360 --> 01:37:14,460
more

1411
01:37:14,460 --> 01:37:17,120
a question

1412
01:37:20,940 --> 01:37:23,639
I track at work

1413
01:37:23,639 --> 01:37:26,340
um it's it's very like unlike apt you

1414
01:37:26,340 --> 01:37:28,440
know it's a salon was widespread you see

1415
01:37:28,440 --> 01:37:32,100
a lot of them uh what and and it's also

1416
01:37:32,100 --> 01:37:34,139
something I touched on the slide briefly

1417
01:37:34,139 --> 01:37:36,239
but you know what a lot of these malware

1418
01:37:36,239 --> 01:37:39,000
use a beaconing style communication

1419
01:37:39,000 --> 01:37:41,580
so that makes it a lot more harder to

1420
01:37:41,580 --> 01:37:43,380
pull down payloads that they're trying

1421
01:37:43,380 --> 01:37:46,920
to spread so if money wasn't an issue it

1422
01:37:46,920 --> 01:37:48,900
would be actually quite fun to try and

1423
01:37:48,900 --> 01:37:52,560
infect as many machines as we can and uh

1424
01:37:52,560 --> 01:37:54,960
track all these different Affiliates and

1425
01:37:54,960 --> 01:37:58,320
how they and what payloads they choose

1426
01:37:58,320 --> 01:38:00,420
to distribute because I think that's one

1427
01:38:00,420 --> 01:38:02,880
thing that's missing in a lot of our

1428
01:38:02,880 --> 01:38:05,159
industry so we do track some Affiliates

1429
01:38:05,159 --> 01:38:08,219
but not all of them it's impossible like

1430
01:38:08,219 --> 01:38:10,020
you can emulate up to a certain point

1431
01:38:10,020 --> 01:38:12,780
but then it comes to a point where these

1432
01:38:12,780 --> 01:38:15,480
Affiliates are installing tooling on the

1433
01:38:15,480 --> 01:38:17,460
victim machine that requires Hands-On

1434
01:38:17,460 --> 01:38:19,320
keyboard activity so at that point

1435
01:38:19,320 --> 01:38:21,960
emulation is useless and you do need a

1436
01:38:21,960 --> 01:38:23,639
machine and if they don't find anything

1437
01:38:23,639 --> 01:38:25,980
interesting on a machine they're less

1438
01:38:25,980 --> 01:38:28,500
likely to you know load anything

1439
01:38:28,500 --> 01:38:31,560
so yeah money not an issue in fact as

1440
01:38:31,560 --> 01:38:33,719
many computers out there

1441
01:38:33,719 --> 01:38:35,340
that's a really good answer what about

1442
01:38:35,340 --> 01:38:37,080
you Matthew

1443
01:38:37,080 --> 01:38:40,500
yeah I think that your idea about having

1444
01:38:40,500 --> 01:38:43,800
like full environment to see how actors

1445
01:38:43,800 --> 01:38:47,040
are behaving will be a pretty good idea

1446
01:38:47,040 --> 01:38:50,880
even for apts sometimes uh

1447
01:38:50,880 --> 01:38:53,639
I would like to to have that like big

1448
01:38:53,639 --> 01:38:57,360
Windows domain like a fake one with a

1449
01:38:57,360 --> 01:38:59,340
machine with interesting documents Etc

1450
01:38:59,340 --> 01:39:01,920
just to see what they are doing

1451
01:39:01,920 --> 01:39:04,800
um this is a good point

1452
01:39:04,800 --> 01:39:05,580
um

1453
01:39:05,580 --> 01:39:09,600
and specifically for my from my research

1454
01:39:09,600 --> 01:39:11,880
I didn't have much time to to focus on

1455
01:39:11,880 --> 01:39:14,100
the first part the the traffic direction

1456
01:39:14,100 --> 01:39:15,960
system

1457
01:39:15,960 --> 01:39:19,500
um like if I had more resources I would

1458
01:39:19,500 --> 01:39:21,600
definitely look at that to try to find

1459
01:39:21,600 --> 01:39:24,780
out how these trade actors where they

1460
01:39:24,780 --> 01:39:28,020
are selling their services uh exactly

1461
01:39:28,020 --> 01:39:30,840
what other traductors are are using it

1462
01:39:30,840 --> 01:39:35,580
and trying to uh to separate the version

1463
01:39:35,580 --> 01:39:38,520
among the the different protectors

1464
01:39:38,520 --> 01:39:40,560
um yeah I think that that's what's

1465
01:39:40,560 --> 01:39:42,659
missing in the research

1466
01:39:42,659 --> 01:39:44,639
cool thanks and by the way I didn't want

1467
01:39:44,639 --> 01:39:45,900
to highlight anything that was missing

1468
01:39:45,900 --> 01:39:47,820
just more we always have limited

1469
01:39:47,820 --> 01:39:52,199
resources in limited uh time so cool one

1470
01:39:52,199 --> 01:39:55,199
thing that I'm noticing in different

1471
01:39:55,199 --> 01:39:57,360
research teams looking at cybercrime is

1472
01:39:57,360 --> 01:39:59,820
that there is lots of similarities with

1473
01:39:59,820 --> 01:40:02,159
tracking apt actors but sometimes there

1474
01:40:02,159 --> 01:40:03,780
are some things that are harder in my

1475
01:40:03,780 --> 01:40:06,120
opinion one of them is to is how we

1476
01:40:06,120 --> 01:40:07,260
organize

1477
01:40:07,260 --> 01:40:09,600
multiple researchers tracking cyber

1478
01:40:09,600 --> 01:40:12,480
crime in apt I think many research teams

1479
01:40:12,480 --> 01:40:14,520
will split between Russian actors

1480
01:40:14,520 --> 01:40:16,679
Iranian actors Chinese actors maybe

1481
01:40:16,679 --> 01:40:18,960
North Korea

1482
01:40:18,960 --> 01:40:21,840
how do you think teams doing cyber crime

1483
01:40:21,840 --> 01:40:23,639
research should be structured or do you

1484
01:40:23,639 --> 01:40:25,199
have good experience in your own

1485
01:40:25,199 --> 01:40:28,699
organizations that you'd like to share

1486
01:40:30,360 --> 01:40:32,219
I guess I'll go with that since it's

1487
01:40:32,219 --> 01:40:33,500
cyber crime

1488
01:40:33,500 --> 01:40:37,199
that's a good point that's true I mean a

1489
01:40:37,199 --> 01:40:39,300
lot even I believe crowdstrike has a

1490
01:40:39,300 --> 01:40:42,000
similar structure like that where apt

1491
01:40:42,000 --> 01:40:45,420
focus is by country and ecrime is well

1492
01:40:45,420 --> 01:40:48,659
everything you have like in my case I

1493
01:40:48,659 --> 01:40:50,639
work on certain families and some other

1494
01:40:50,639 --> 01:40:53,400
analysts they work on it by Family basis

1495
01:40:53,400 --> 01:40:55,739
but we are starting to notice things

1496
01:40:55,739 --> 01:40:58,560
like tooling that is shared across these

1497
01:40:58,560 --> 01:41:02,580
groups and uh and then this does make it

1498
01:41:02,580 --> 01:41:06,179
a lot more harder I mean as far as it's

1499
01:41:06,179 --> 01:41:08,400
concerned I mean we could place all

1500
01:41:08,400 --> 01:41:10,320
these most of these malware groups under

1501
01:41:10,320 --> 01:41:12,300
say one country in particular because

1502
01:41:12,300 --> 01:41:14,880
that's where they tend to arrive but of

1503
01:41:14,880 --> 01:41:16,679
course you do see malware coming from

1504
01:41:16,679 --> 01:41:18,199
other country

1505
01:41:18,199 --> 01:41:21,179
I don't think there's any clear solution

1506
01:41:21,179 --> 01:41:24,480
but the key thing is to distinguish

1507
01:41:24,480 --> 01:41:26,940
these toolings as much as possible and

1508
01:41:26,940 --> 01:41:29,940
then you have so from a low level

1509
01:41:29,940 --> 01:41:31,620
perspective active and then from a high

1510
01:41:31,620 --> 01:41:33,420
level perspective you have threat

1511
01:41:33,420 --> 01:41:35,400
intelligence analysts come into play and

1512
01:41:35,400 --> 01:41:37,739
try and make that connection with how

1513
01:41:37,739 --> 01:41:40,739
this tooling is used across groups so I

1514
01:41:40,739 --> 01:41:42,360
don't think settling with countries is

1515
01:41:42,360 --> 01:41:44,340
enough because it's clearly not targeted

1516
01:41:44,340 --> 01:41:47,639
and this is a whole different Financial

1517
01:41:47,639 --> 01:41:52,460
sort of a ball game here yeah

1518
01:41:52,560 --> 01:41:54,380
yeah I think the problem with

1519
01:41:54,380 --> 01:41:57,179
cybercrombies that it's a war ecosystem

1520
01:41:57,179 --> 01:41:59,580
so you cannot really you can make

1521
01:41:59,580 --> 01:42:03,719
clusters but everything is connected so

1522
01:42:03,719 --> 01:42:07,679
you cannot like work on on something and

1523
01:42:07,679 --> 01:42:09,420
it's not separate from everything for

1524
01:42:09,420 --> 01:42:11,159
apt so until you can separate by

1525
01:42:11,159 --> 01:42:13,440
countries because apieties they don't

1526
01:42:13,440 --> 01:42:16,040
collaborate with with each other

1527
01:42:16,040 --> 01:42:19,020
like if you track Russian apts they will

1528
01:42:19,020 --> 01:42:21,360
never never collaborate with Chinese

1529
01:42:21,360 --> 01:42:24,480
deputies or North Korean actors or it's

1530
01:42:24,480 --> 01:42:27,179
if you work on some apt you can just

1531
01:42:27,179 --> 01:42:29,820
work on that and it has no relation with

1532
01:42:29,820 --> 01:42:32,820
anything else so it's it's quite easy to

1533
01:42:32,820 --> 01:42:35,820
separate the job even like we don't

1534
01:42:35,820 --> 01:42:38,159
really we are not

1535
01:42:38,159 --> 01:42:41,580
how we are organized like uh any cities

1536
01:42:41,580 --> 01:42:43,860
we don't separate by by countries like

1537
01:42:43,860 --> 01:42:46,320
for example I work mostly on Russian

1538
01:42:46,320 --> 01:42:49,860
apts but also on Chinese apts and same

1539
01:42:49,860 --> 01:42:52,980
for for other people but we tend to

1540
01:42:52,980 --> 01:42:55,800
to track like different groups and one

1541
01:42:55,800 --> 01:42:57,900
people are responsible for for one group

1542
01:42:57,900 --> 01:43:00,000
and it's

1543
01:43:00,000 --> 01:43:04,500
very aware that we have to someone as to

1544
01:43:04,500 --> 01:43:07,260
to collaborate with another researcher

1545
01:43:07,260 --> 01:43:09,239
because groups are sharing something

1546
01:43:09,239 --> 01:43:10,800
except for

1547
01:43:10,800 --> 01:43:16,940
Chinese apts which is a big mess but

1548
01:43:16,980 --> 01:43:19,199
um yeah it's it's really easier to to

1549
01:43:19,199 --> 01:43:22,040
Cluster things

1550
01:43:25,460 --> 01:43:27,659
research it was really hard to

1551
01:43:27,659 --> 01:43:30,239
understand like the the infection chain

1552
01:43:30,239 --> 01:43:32,400
and the traffic direction system and all

1553
01:43:32,400 --> 01:43:34,560
this stuff because there are so many

1554
01:43:34,560 --> 01:43:38,699
different protectors using the same

1555
01:43:38,699 --> 01:43:42,480
like same TDS so it's it gets messy

1556
01:43:42,480 --> 01:43:44,959
quite easy

1557
01:43:53,340 --> 01:43:56,280
so when bizarre Laura was using this

1558
01:43:56,280 --> 01:43:58,980
Bazaar call type campaigns a lot of

1559
01:43:58,980 --> 01:44:01,100
these call centers were opened in India

1560
01:44:01,100 --> 01:44:04,020
but we know that bizarre order did none

1561
01:44:04,020 --> 01:44:06,480
of those developers are from India and

1562
01:44:06,480 --> 01:44:08,159
uh you know based off what we've seen in

1563
01:44:08,159 --> 01:44:10,800
the Conti leaks so clearly there's a lot

1564
01:44:10,800 --> 01:44:13,500
of international collaboration here and

1565
01:44:13,500 --> 01:44:15,600
it's a lot more

1566
01:44:15,600 --> 01:44:17,580
he has a lot more organized than we

1567
01:44:17,580 --> 01:44:20,159
thought you know before another good

1568
01:44:20,159 --> 01:44:23,219
example I have with e-crime is uh so for

1569
01:44:23,219 --> 01:44:25,619
bachbot so publicly it's called ice ID

1570
01:44:25,619 --> 01:44:28,980
they use this hidden VNC tool you know

1571
01:44:28,980 --> 01:44:31,440
um Matthew talked about like hidden vncs

1572
01:44:31,440 --> 01:44:33,600
so they've been using this tool since

1573
01:44:33,600 --> 01:44:37,260
2019 but now we're seeing the same tool

1574
01:44:37,260 --> 01:44:40,380
being distributed by bumblebee uh we

1575
01:44:40,380 --> 01:44:43,739
even see like a catbot using a similar

1576
01:44:43,739 --> 01:44:46,920
tool and it's it's a bit uh

1577
01:44:46,920 --> 01:44:49,139
it was a bit like Curious it's like is

1578
01:44:49,139 --> 01:44:50,880
this just another group building this

1579
01:44:50,880 --> 01:44:52,560
tool like where are they getting their

1580
01:44:52,560 --> 01:44:54,300
hands on this tool from so clearly

1581
01:44:54,300 --> 01:44:56,699
there's a lot of organization Happening

1582
01:44:56,699 --> 01:44:58,980
Here uh Something That We're Not privy

1583
01:44:58,980 --> 01:45:01,080
to yeah

1584
01:45:01,080 --> 01:45:02,100
yeah thanks

1585
01:45:02,100 --> 01:45:04,860
um I would like to ask you Lily you had

1586
01:45:04,860 --> 01:45:06,540
a question and if that's okay with you

1587
01:45:06,540 --> 01:45:08,219
I'd like you to ask it live because I

1588
01:45:08,219 --> 01:45:09,420
think you will deliver it better than

1589
01:45:09,420 --> 01:45:11,659
myself

1590
01:45:17,040 --> 01:45:18,600
I assume

1591
01:45:18,600 --> 01:45:22,080
um so a question in regards to bumblebee

1592
01:45:22,080 --> 01:45:26,520
um so with the API unhooking module in

1593
01:45:26,520 --> 01:45:31,199
that particular malware when it detects

1594
01:45:31,199 --> 01:45:32,639
that

1595
01:45:32,639 --> 01:45:35,820
an API is hooked in memory is that it

1596
01:45:35,820 --> 01:45:38,580
overwrites that with the bytes on disk

1597
01:45:38,580 --> 01:45:41,520
and my question is what happens if

1598
01:45:41,520 --> 01:45:44,040
there's a memory pointer at the

1599
01:45:44,040 --> 01:45:47,400
beginning of that particular API on disk

1600
01:45:47,400 --> 01:45:50,639
and for example in memory

1601
01:45:50,639 --> 01:45:53,940
um would it just right the raw bytes

1602
01:45:53,940 --> 01:45:56,100
from disk and that memory pointer would

1603
01:45:56,100 --> 01:45:58,139
be invalid and potentially cause any

1604
01:45:58,139 --> 01:46:00,659
type of Crash do you figure what are

1605
01:46:00,659 --> 01:46:02,219
your thoughts there

1606
01:46:02,219 --> 01:46:04,500
cool thanks lady for the question

1607
01:46:04,500 --> 01:46:06,960
um so yeah so this was uh I think it was

1608
01:46:06,960 --> 01:46:09,179
a slide I just quickly went by it was a

1609
01:46:09,179 --> 01:46:11,280
slide that talked about the lip splice

1610
01:46:11,280 --> 01:46:13,560
the splicing library that does the

1611
01:46:13,560 --> 01:46:17,340
unhooking so essentially when it's

1612
01:46:17,340 --> 01:46:19,860
trying to remove any hooks on apis it's

1613
01:46:19,860 --> 01:46:22,560
copying over bytes from the instructions

1614
01:46:22,560 --> 01:46:24,780
and its physical file so Lily pointed

1615
01:46:24,780 --> 01:46:26,639
out the fact that you know you might

1616
01:46:26,639 --> 01:46:28,739
have instructions in memory where it's

1617
01:46:28,739 --> 01:46:31,380
referencing addresses and that could be

1618
01:46:31,380 --> 01:46:34,380
a potential problem because does this

1619
01:46:34,380 --> 01:46:36,239
malware take care of rebasing those

1620
01:46:36,239 --> 01:46:39,420
addresses uh long story short no they

1621
01:46:39,420 --> 01:46:42,420
don't they just they don't even do

1622
01:46:42,420 --> 01:46:44,159
anything different they just completely

1623
01:46:44,159 --> 01:46:47,880
use this Library as is the thing about

1624
01:46:47,880 --> 01:46:50,100
this Library it is almost a decade old

1625
01:46:50,100 --> 01:46:52,440
so it's not something new not something

1626
01:46:52,440 --> 01:46:55,080
that was aware of rebasing so they just

1627
01:46:55,080 --> 01:46:57,719
come in and it ran like it there was no

1628
01:46:57,719 --> 01:47:00,840
problem so maybe they tested it maybe

1629
01:47:00,840 --> 01:47:04,139
not there's no clear idea why but it

1630
01:47:04,139 --> 01:47:06,900
seems to work but I believe like also

1631
01:47:06,900 --> 01:47:09,119
like Lily's done research where we have

1632
01:47:09,119 --> 01:47:11,340
seen like other families now starting to

1633
01:47:11,340 --> 01:47:13,260
look and Implement those checks for

1634
01:47:13,260 --> 01:47:15,179
rebasing so you know a lot of these

1635
01:47:15,179 --> 01:47:17,219
groups are probably becoming aware of

1636
01:47:17,219 --> 01:47:19,860
the faults behind some of these uh

1637
01:47:19,860 --> 01:47:23,280
cooking libraries yeah thank you

1638
01:47:23,280 --> 01:47:25,199
thanks again for your question is there

1639
01:47:25,199 --> 01:47:27,119
any other question in the audience we

1640
01:47:27,119 --> 01:47:28,800
are not ready to take some questions

1641
01:47:28,800 --> 01:47:29,820
um yes please go ahead and if that's

1642
01:47:29,820 --> 01:47:31,139
okay with you I'll try to rephrase your

1643
01:47:31,139 --> 01:47:34,880
question for the ones listening online

1644
01:47:54,840 --> 01:47:57,900
so please step in correct me if I didn't

1645
01:47:57,900 --> 01:47:59,639
understand your question properly the

1646
01:47:59,639 --> 01:48:01,980
question is in the Bible in bumblebee

1647
01:48:01,980 --> 01:48:04,440
why are the developers why did the

1648
01:48:04,440 --> 01:48:06,420
developers choose rc4 instead of

1649
01:48:06,420 --> 01:48:07,980
something maybe more efficient or more

1650
01:48:07,980 --> 01:48:11,639
modern like rc5 or double fish

1651
01:48:11,639 --> 01:48:13,320
good question

1652
01:48:13,320 --> 01:48:16,440
it's not clear why they've introduced

1653
01:48:16,440 --> 01:48:19,980
rc4 and rc4 is like this it's like this

1654
01:48:19,980 --> 01:48:21,780
go-to thing with a lot of e-crime

1655
01:48:21,780 --> 01:48:24,659
malwares a lot of them just use rc4 but

1656
01:48:24,659 --> 01:48:26,280
there is also a bit of a hidden meaning

1657
01:48:26,280 --> 01:48:28,739
behind it uh and not something I've

1658
01:48:28,739 --> 01:48:30,179
talked about

1659
01:48:30,179 --> 01:48:32,040
um so with Bumblebee a lot of the

1660
01:48:32,040 --> 01:48:34,980
samples based on which Affiliates is

1661
01:48:34,980 --> 01:48:38,280
using the malware each affiliate has

1662
01:48:38,280 --> 01:48:41,940
their own rc4 key and so even though

1663
01:48:41,940 --> 01:48:43,679
it's communicating with the server you

1664
01:48:43,679 --> 01:48:45,119
need to make sure you're communicating

1665
01:48:45,119 --> 01:48:48,300
with the server that can decrypt

1666
01:48:48,300 --> 01:48:51,000
messages with that proper key so in a

1667
01:48:51,000 --> 01:48:52,920
way it wasn't only just encrypting

1668
01:48:52,920 --> 01:48:57,619
traffic it was also used to track uh

1669
01:48:57,619 --> 01:49:00,840
communication for certain Affiliates so

1670
01:49:00,840 --> 01:49:02,940
you couldn't just use any you know

1671
01:49:02,940 --> 01:49:06,300
bumblebee malware and just take the c2s

1672
01:49:06,300 --> 01:49:07,679
from that malware and just communicate

1673
01:49:07,679 --> 01:49:09,840
with it if you don't know the rc4 key

1674
01:49:09,840 --> 01:49:12,239
that's associated with the C2 it makes

1675
01:49:12,239 --> 01:49:15,300
it harder to see what the response is so

1676
01:49:15,300 --> 01:49:17,520
it's in their way slightly tricky like

1677
01:49:17,520 --> 01:49:19,020
unless you have the malware and can't

1678
01:49:19,020 --> 01:49:21,179
use it but I mean yeah they could have

1679
01:49:21,179 --> 01:49:23,639
carried it forward but they clearly

1680
01:49:23,639 --> 01:49:26,340
didn't bother yeah

1681
01:49:26,340 --> 01:49:28,739
thanks thanks for your answer

1682
01:49:28,739 --> 01:49:31,920
um maybe we can explain why protectors

1683
01:49:31,920 --> 01:49:35,040
like using rc4 so I don't really know

1684
01:49:35,040 --> 01:49:39,119
about sc5 and rc6 but for sc4 there is

1685
01:49:39,119 --> 01:49:42,600
no constant so if you compare to AES for

1686
01:49:42,600 --> 01:49:44,880
example in sc4 there is no constant so

1687
01:49:44,880 --> 01:49:46,500
it's harder to

1688
01:49:46,500 --> 01:49:50,940
to detect sc4 with like a byte buttons

1689
01:49:50,940 --> 01:49:53,460
you'll need to to check like the the

1690
01:49:53,460 --> 01:49:57,119
decompiler who have or have a signature

1691
01:49:57,119 --> 01:50:01,199
on some some disassembly graph so that's

1692
01:50:01,199 --> 01:50:04,560
why trade actors are like using sc4 it's

1693
01:50:04,560 --> 01:50:08,340
just hard to make a signature on it

1694
01:50:08,340 --> 01:50:11,639
thanks and thanks for this explanation

1695
01:50:11,639 --> 01:50:12,900
um I'll go with one question we had

1696
01:50:12,900 --> 01:50:15,360
online for you master which was

1697
01:50:15,360 --> 01:50:18,300
um can you elaborate a bit on the

1698
01:50:18,300 --> 01:50:19,380
um

1699
01:50:19,380 --> 01:50:20,940
what does it mean that there was a

1700
01:50:20,940 --> 01:50:23,400
watermark for the Cobalt strike sample

1701
01:50:23,400 --> 01:50:25,619
that you described

1702
01:50:25,619 --> 01:50:29,760
so the watermark is a number that that

1703
01:50:29,760 --> 01:50:32,880
is linked to uh to the license link to

1704
01:50:32,880 --> 01:50:35,699
the Cobalt strike Builder the problem is

1705
01:50:35,699 --> 01:50:37,920
that first it's quite easy to change if

1706
01:50:37,920 --> 01:50:39,480
I remember correctly it's just a number

1707
01:50:39,480 --> 01:50:43,260
in the text file in in the directory of

1708
01:50:43,260 --> 01:50:46,139
like the cover track instance

1709
01:50:46,139 --> 01:50:47,100
um

1710
01:50:47,100 --> 01:50:49,920
but generally trit actors don't care

1711
01:50:49,920 --> 01:50:52,920
about changing it so it can still be

1712
01:50:52,920 --> 01:50:57,780
useful to to Cluster uh different uh

1713
01:50:57,780 --> 01:50:59,880
um Cobalt swag beacons you extract the

1714
01:50:59,880 --> 01:51:01,980
config and then you cluster by by what

1715
01:51:01,980 --> 01:51:05,699
your map the second problem is that

1716
01:51:05,699 --> 01:51:07,739
there are a lot of copper strike

1717
01:51:07,739 --> 01:51:10,980
builders that have been leaked online so

1718
01:51:10,980 --> 01:51:13,320
you can find like cobal strike builder

1719
01:51:13,320 --> 01:51:16,800
of like previous versions and

1720
01:51:16,800 --> 01:51:19,440
a lot of protectors are reusing those

1721
01:51:19,440 --> 01:51:21,719
leak Builders and that's why there are

1722
01:51:21,719 --> 01:51:24,719
the they end up with the same Watermark

1723
01:51:24,719 --> 01:51:27,320
at the end

1724
01:51:27,360 --> 01:51:29,520
thanks I'll continue with questions

1725
01:51:29,520 --> 01:51:32,040
online I I like that everyone is able to

1726
01:51:32,040 --> 01:51:33,719
vote and upvote them so it helps me

1727
01:51:33,719 --> 01:51:35,340
prioritize

1728
01:51:35,340 --> 01:51:37,440
um the next one I think is for you Sue

1729
01:51:37,440 --> 01:51:40,679
and the question is

1730
01:51:40,679 --> 01:51:42,780
could you abuse the beginning system in

1731
01:51:42,780 --> 01:51:46,080
bumblebee to affect the attacker in

1732
01:51:46,080 --> 01:51:49,080
order to infect the attacker in order to

1733
01:51:49,080 --> 01:51:52,040
unmask their identity

1734
01:51:52,139 --> 01:51:53,880
uh you seem to be expecting that

1735
01:51:53,880 --> 01:51:55,560
question I like it

1736
01:51:55,560 --> 01:51:56,639
well

1737
01:51:56,639 --> 01:51:59,340
uh unfortunately I don't have any good

1738
01:51:59,340 --> 01:52:03,119
answer because uh uh you know part of my

1739
01:52:03,119 --> 01:52:06,080
work is we do not attack back

1740
01:52:06,080 --> 01:52:09,179
so uh it may be possible but it's not

1741
01:52:09,179 --> 01:52:11,520
something uh you know we allowed

1742
01:52:11,520 --> 01:52:14,520
um to pursue or look forward and so I

1743
01:52:14,520 --> 01:52:16,679
just really only monitor traffic

1744
01:52:16,679 --> 01:52:18,960
and I will yeah that's it that's all I

1745
01:52:18,960 --> 01:52:21,360
can answer to it

1746
01:52:21,360 --> 01:52:23,460
awesome I think the next one is for you

1747
01:52:23,460 --> 01:52:26,219
master did you need to enable macros in

1748
01:52:26,219 --> 01:52:28,199
Word and Excel and Microsoft Publisher

1749
01:52:28,199 --> 01:52:30,300
files in order to get a successful

1750
01:52:30,300 --> 01:52:32,580
infection

1751
01:52:32,580 --> 01:52:35,699
probably yes but to be honest I just

1752
01:52:35,699 --> 01:52:38,400
extracted the macro and didn't trying to

1753
01:52:38,400 --> 01:52:42,300
didn't try to run the document but if it

1754
01:52:42,300 --> 01:52:44,340
was downloaded from the internet I think

1755
01:52:44,340 --> 01:52:45,540
for

1756
01:52:45,540 --> 01:52:49,080
few years now so before uh

1757
01:52:49,080 --> 01:52:50,400
so

1758
01:52:50,400 --> 01:52:54,960
before July 2022 you add some some just

1759
01:52:54,960 --> 01:52:56,639
some message and you can just click to

1760
01:52:56,639 --> 01:52:59,940
enable macro but now it's just not

1761
01:52:59,940 --> 01:53:01,920
possible to run macro from the internet

1762
01:53:01,920 --> 01:53:05,280
if you have like up-to-date version of

1763
01:53:05,280 --> 01:53:08,940
uh of Microsoft Office

1764
01:53:08,940 --> 01:53:10,619
thank you

1765
01:53:10,619 --> 01:53:13,619
next one is is crypto still very in

1766
01:53:13,619 --> 01:53:15,780
fashion in the crime world or as hype

1767
01:53:15,780 --> 01:53:18,060
died down like in the mainstream

1768
01:53:18,060 --> 01:53:20,040
and if so which cryptocurrent I guess

1769
01:53:20,040 --> 01:53:23,239
cryptocurrency in this case

1770
01:53:23,340 --> 01:53:24,719
so maybe I'll start with Tuma too

1771
01:53:24,719 --> 01:53:25,980
because I think you did mention that

1772
01:53:25,980 --> 01:53:28,380
some of the targets for your uh for the

1773
01:53:28,380 --> 01:53:30,659
group you're tracking were looking at

1774
01:53:30,659 --> 01:53:33,480
crypto cryptocurrency

1775
01:53:33,480 --> 01:53:37,679
yes so we noticed that uh attackers when

1776
01:53:37,679 --> 01:53:39,540
they were collecting like from per uh

1777
01:53:39,540 --> 01:53:43,560
browsing stories or like doing like key

1778
01:53:43,560 --> 01:53:47,040
logging they were um very interested in

1779
01:53:47,040 --> 01:53:50,940
uh taking credentials to to Logan poop

1780
01:53:50,940 --> 01:53:53,960
to log in popular uh

1781
01:53:53,960 --> 01:53:56,880
cryptocurrency exchange for example so

1782
01:53:56,880 --> 01:53:59,639
we haven't observed them stealing really

1783
01:53:59,639 --> 01:54:01,639
stealing those uh

1784
01:54:01,639 --> 01:54:04,260
these cryptocurrencies but I guess if

1785
01:54:04,260 --> 01:54:07,619
they are collecting uh wallet addresses

1786
01:54:07,619 --> 01:54:10,320
uh login password for crypto exchange

1787
01:54:10,320 --> 01:54:14,159
it's just not to to look at the number

1788
01:54:14,159 --> 01:54:14,940
um

1789
01:54:14,940 --> 01:54:18,840
and what was the original question not

1790
01:54:18,840 --> 01:54:21,000
sure answer is the question I think he

1791
01:54:21,000 --> 01:54:22,920
did answer the question uh maybe the

1792
01:54:22,920 --> 01:54:25,020
other part was is there anything you can

1793
01:54:25,020 --> 01:54:27,000
share about which crypto exchanges or

1794
01:54:27,000 --> 01:54:30,920
which currencies were mostly targeted

1795
01:54:31,940 --> 01:54:34,500
mostly big Bitcoin if I remember

1796
01:54:34,500 --> 01:54:37,199
correctly and like the exchange is it

1797
01:54:37,199 --> 01:54:38,460
was

1798
01:54:38,460 --> 01:54:42,360
very random so it mostly depends on what

1799
01:54:42,360 --> 01:54:45,119
exchange the victim was using

1800
01:54:45,119 --> 01:54:46,320
okay

1801
01:54:46,320 --> 01:54:47,580
um

1802
01:54:47,580 --> 01:54:50,360
so it's not with

1803
01:54:53,580 --> 01:54:56,699
OS malware a lot of Steelers So lately

1804
01:54:56,699 --> 01:54:58,920
we've been seeing it's a kind of an

1805
01:54:58,920 --> 01:55:00,000
interesting question because we've been

1806
01:55:00,000 --> 01:55:01,800
seeing a lot of Steelers that Target

1807
01:55:01,800 --> 01:55:04,739
Gamers and like social engineer Gamers

1808
01:55:04,739 --> 01:55:06,719
through Twitter and to get them to

1809
01:55:06,719 --> 01:55:09,239
install Steelers on a machine which end

1810
01:55:09,239 --> 01:55:12,480
of the day just steals wallets and an

1811
01:55:12,480 --> 01:55:14,219
extensive list of wallets and it's all

1812
01:55:14,219 --> 01:55:17,639
related to the metaverse because some of

1813
01:55:17,639 --> 01:55:20,780
these games they use crypto currency

1814
01:55:20,780 --> 01:55:24,780
exchanges for and trading and stuff so

1815
01:55:24,780 --> 01:55:26,880
they look at like um

1816
01:55:26,880 --> 01:55:29,699
Finance

1817
01:55:29,699 --> 01:55:31,860
Bitcoin there was a list and I don't

1818
01:55:31,860 --> 01:55:34,619
know the entire list off my head but uh

1819
01:55:34,619 --> 01:55:36,900
I think it's more common in the gaming

1820
01:55:36,900 --> 01:55:39,540
world yeah for sure

1821
01:55:39,540 --> 01:55:41,340
great thanks for the initial additional

1822
01:55:41,340 --> 01:55:43,619
context this is uh really appreciated

1823
01:55:43,619 --> 01:55:45,119
um the next question is something we've

1824
01:55:45,119 --> 01:55:47,400
already touched on but I will I will go

1825
01:55:47,400 --> 01:55:49,139
through it again and then please feel

1826
01:55:49,139 --> 01:55:50,219
free to chime in if there's something

1827
01:55:50,219 --> 01:55:52,380
else you'd like to add how different is

1828
01:55:52,380 --> 01:55:55,139
it in uh studying geopolitically

1829
01:55:55,139 --> 01:55:57,600
motivated versus uh the ones created by

1830
01:55:57,600 --> 01:55:59,639
criminals is there a significant

1831
01:55:59,639 --> 01:56:02,100
difference or pretty much the same

1832
01:56:02,100 --> 01:56:03,960
I'll start by summarizing what we what I

1833
01:56:03,960 --> 01:56:05,340
remember from what we've discussed so

1834
01:56:05,340 --> 01:56:06,360
far

1835
01:56:06,360 --> 01:56:07,560
um I think we've discussed that

1836
01:56:07,560 --> 01:56:09,780
state-sponsored attackers are going to

1837
01:56:09,780 --> 01:56:11,400
be mostly not sharing their tools or

1838
01:56:11,400 --> 01:56:12,719
techniques they have their own things

1839
01:56:12,719 --> 01:56:14,820
and they the Chinese and the Russians

1840
01:56:14,820 --> 01:56:16,980
rarely exchange tools while for the

1841
01:56:16,980 --> 01:56:19,199
cyber crime we see a lot more of

1842
01:56:19,199 --> 01:56:21,179
exchange and common pieces being used

1843
01:56:21,179 --> 01:56:23,340
anything else that you see that kind of

1844
01:56:23,340 --> 01:56:25,080
stands out as geopolitical versus

1845
01:56:25,080 --> 01:56:27,920
criminal malware

1846
01:56:36,440 --> 01:56:39,500
maybe how malware are developed or

1847
01:56:39,500 --> 01:56:41,119
protected

1848
01:56:41,119 --> 01:56:45,719
like January Kramer malware are very

1849
01:56:45,719 --> 01:56:47,280
well protected there are like big

1850
01:56:47,280 --> 01:56:49,739
Packers which are very annoying to to

1851
01:56:49,739 --> 01:56:53,520
reverse and they do a lot of check like

1852
01:56:53,520 --> 01:56:55,080
to see if they are running in some

1853
01:56:55,080 --> 01:56:57,000
virtual machine or sandbox or stuff like

1854
01:56:57,000 --> 01:56:59,760
that on the contrary apt malware

1855
01:56:59,760 --> 01:57:02,119
generally they are not packed

1856
01:57:02,119 --> 01:57:05,580
very little obfuscated like from time to

1857
01:57:05,580 --> 01:57:07,440
time like strings are obfuscated but

1858
01:57:07,440 --> 01:57:11,280
that's pretty much it so of course from

1859
01:57:11,280 --> 01:57:13,080
time to time there is some very big

1860
01:57:13,080 --> 01:57:15,000
change that are very uh to understand

1861
01:57:15,000 --> 01:57:17,420
but

1862
01:57:17,460 --> 01:57:19,739
generally like it's

1863
01:57:19,739 --> 01:57:21,060
I'd say

1864
01:57:21,060 --> 01:57:23,280
maybe not easier to to reverse because

1865
01:57:23,280 --> 01:57:26,580
the mirror are very big uh like a lot of

1866
01:57:26,580 --> 01:57:28,920
functionalities are generally in C plus

1867
01:57:28,920 --> 01:57:31,260
plus like network communication it can

1868
01:57:31,260 --> 01:57:35,159
be quite hard to to understand but there

1869
01:57:35,159 --> 01:57:37,679
are really rarely used Packer because

1870
01:57:37,679 --> 01:57:40,260
they want to stay under the radar and

1871
01:57:40,260 --> 01:57:42,920
looks like any other file on the system

1872
01:57:42,920 --> 01:57:46,320
when you have some pack sample it's

1873
01:57:46,320 --> 01:57:50,000
start to be suspicious

1874
01:57:50,400 --> 01:57:53,219
I guess what I could add to it is uh e

1875
01:57:53,219 --> 01:57:55,020
crime these days they are a lot more

1876
01:57:55,020 --> 01:57:58,080
ransomware focused I mean that's the

1877
01:57:58,080 --> 01:57:59,940
easy way to make money

1878
01:57:59,940 --> 01:58:02,280
um it's uh and of course if it's

1879
01:58:02,280 --> 01:58:03,960
targeting Gamers it's you know stealing

1880
01:58:03,960 --> 01:58:06,540
cryptocurrency but uh like gone now the

1881
01:58:06,540 --> 01:58:08,639
days you see banking Trojans and and

1882
01:58:08,639 --> 01:58:10,619
most apts don't

1883
01:58:10,619 --> 01:58:12,239
um I could be wrong they may be doing

1884
01:58:12,239 --> 01:58:14,280
ransomware or not but that's what's

1885
01:58:14,280 --> 01:58:17,460
clearly defining and what the you know

1886
01:58:17,460 --> 01:58:20,820
what defines e-crime and apt

1887
01:58:20,820 --> 01:58:22,980
um and also I find that ecrime they tend

1888
01:58:22,980 --> 01:58:25,320
to focus a lot more on EDR evasion

1889
01:58:25,320 --> 01:58:27,659
because they are targeting companies and

1890
01:58:27,659 --> 01:58:29,820
companies most likely have some EDR

1891
01:58:29,820 --> 01:58:32,340
solution and and they just want to

1892
01:58:32,340 --> 01:58:33,840
bypass that and especially with

1893
01:58:33,840 --> 01:58:36,119
ransomware you're seeing a trend with

1894
01:58:36,119 --> 01:58:39,900
the vulnerable drivers so the by OBD and

1895
01:58:39,900 --> 01:58:42,719
so you know they clearly it's they want

1896
01:58:42,719 --> 01:58:45,360
to prevent edrs from seeing that they're

1897
01:58:45,360 --> 01:58:47,699
encrypting files so vulnerable Rivals is

1898
01:58:47,699 --> 01:58:50,400
the way to go apparently these days

1899
01:58:50,400 --> 01:58:53,400
so yeah I guess hope that answers the

1900
01:58:53,400 --> 01:58:54,420
question

1901
01:58:54,420 --> 01:58:56,760
I think it does thank you

1902
01:58:56,760 --> 01:58:58,260
um I'll start with mature for the next

1903
01:58:58,260 --> 01:58:59,940
one have you seen this situation in

1904
01:58:59,940 --> 01:59:01,679
Ukraine generally increased malware

1905
01:59:01,679 --> 01:59:03,060
threat activity

1906
01:59:03,060 --> 01:59:04,800
and what do you think those people

1907
01:59:04,800 --> 01:59:06,659
working on malware will do if the war

1908
01:59:06,659 --> 01:59:09,080
ends

1909
01:59:10,739 --> 01:59:13,860
um so we did see an increase of marrow

1910
01:59:13,860 --> 01:59:16,320
attacks in in Ukraine but those are

1911
01:59:16,320 --> 01:59:19,860
mostly State sponsor attacks

1912
01:59:19,860 --> 01:59:23,880
um so the people developing those those

1913
01:59:23,880 --> 01:59:27,000
malware were most probably working from

1914
01:59:27,000 --> 01:59:29,219
for the same organization before the war

1915
01:59:29,219 --> 01:59:31,260
and will continue to work for some

1916
01:59:31,260 --> 01:59:33,480
organization after the war so

1917
01:59:33,480 --> 01:59:37,380
not sure if it will change anything

1918
01:59:37,380 --> 01:59:40,020
um and we did see like some some

1919
01:59:40,020 --> 01:59:41,880
increase in the context of the war but

1920
01:59:41,880 --> 01:59:46,320
it's not like crazy and

1921
01:59:46,320 --> 01:59:49,260
in the last few months it's it's really

1922
01:59:49,260 --> 01:59:53,719
more quiet that it was one year ago

1923
01:59:54,540 --> 01:59:57,980
anything to add soon

1924
01:59:58,040 --> 02:00:01,920
I think Matthew has heard it well

1925
02:00:01,920 --> 02:00:03,960
perfect the next question is also a bit

1926
02:00:03,960 --> 02:00:06,060
apt oriented have you been involved in

1927
02:00:06,060 --> 02:00:08,219
nation state apt identification for

1928
02:00:08,219 --> 02:00:10,020
diplomatic allegations for example

1929
02:00:10,020 --> 02:00:14,000
blaming Russian FSB for attacks

1930
02:00:14,639 --> 02:00:19,500
um so from time to time we will like say

1931
02:00:19,500 --> 02:00:21,060
that the group is most likely right

1932
02:00:21,060 --> 02:00:23,400
brochure like no China Airline but we

1933
02:00:23,400 --> 02:00:27,360
never go as far as naming The Entity of

1934
02:00:27,360 --> 02:00:30,179
the person who is behind it it's quite

1935
02:00:30,179 --> 02:00:33,780
easy to to make mistakes and it's more

1936
02:00:33,780 --> 02:00:37,980
political job to to do that

1937
02:00:37,980 --> 02:00:40,020
right

1938
02:00:40,020 --> 02:00:43,380
I agree I mean yes

1939
02:00:43,380 --> 02:00:45,179
cool and we have time for one last

1940
02:00:45,179 --> 02:00:48,420
question it is also a bit uh politically

1941
02:00:48,420 --> 02:00:50,699
oriented how much work is going on with

1942
02:00:50,699 --> 02:00:53,900
groups blaming each other

1943
02:00:54,139 --> 02:00:56,639
recently was discovered to be actually

1944
02:00:56,639 --> 02:00:59,219
tied to Russian apt is are there other

1945
02:00:59,219 --> 02:01:02,000
examples

1946
02:01:04,320 --> 02:01:06,420
I can start because I see you looking at

1947
02:01:06,420 --> 02:01:09,119
the sky I think

1948
02:01:09,119 --> 02:01:11,639
I do remember one case

1949
02:01:11,639 --> 02:01:14,520
um of another Russian operation at the

1950
02:01:14,520 --> 02:01:16,800
beginning of the war with Ukraine where

1951
02:01:16,800 --> 02:01:19,199
they changed the

1952
02:01:19,199 --> 02:01:21,420
um they changed some of the metadata in

1953
02:01:21,420 --> 02:01:23,340
some pictures to make it look like it

1954
02:01:23,340 --> 02:01:24,980
was coming from Poland but it was very

1955
02:01:24,980 --> 02:01:27,420
maturation not super convincing so I

1956
02:01:27,420 --> 02:01:29,480
think fast lag operations are not

1957
02:01:29,480 --> 02:01:32,400
uncommon but to say they are increasing

1958
02:01:32,400 --> 02:01:34,800
or there are recent examples

1959
02:01:34,800 --> 02:01:38,480
um I would need to ask our experts

1960
02:01:40,440 --> 02:01:42,239
um any crime

1961
02:01:42,239 --> 02:01:45,360
well with group blaming you you normally

1962
02:01:45,360 --> 02:01:48,480
see a lot of within the group a lot of

1963
02:01:48,480 --> 02:01:51,179
them sometimes they can be tensions I

1964
02:01:51,179 --> 02:01:53,040
think that was quite clear with Conti

1965
02:01:53,040 --> 02:01:55,380
leaks with something political comes up

1966
02:01:55,380 --> 02:01:57,599
and but of course it was a Ukrainian

1967
02:01:57,599 --> 02:02:01,320
researcher that released the logs but uh

1968
02:02:01,320 --> 02:02:03,179
um you don't see it too much you mostly

1969
02:02:03,179 --> 02:02:05,040
see it maybe among ransomware groups

1970
02:02:05,040 --> 02:02:06,599
like especially if there was a

1971
02:02:06,599 --> 02:02:09,000
ransomware that targeted a hospital and

1972
02:02:09,000 --> 02:02:11,880
then they immediately try to post on

1973
02:02:11,880 --> 02:02:13,860
like the data leak site that it's not

1974
02:02:13,860 --> 02:02:16,260
them it's someone else and so it's

1975
02:02:16,260 --> 02:02:18,840
oftentimes that that case because they

1976
02:02:18,840 --> 02:02:21,060
do not want to be liable and they are

1977
02:02:21,060 --> 02:02:24,719
you know actually worried but otherwise

1978
02:02:24,719 --> 02:02:27,300
like it's hard to we haven't seen it

1979
02:02:27,300 --> 02:02:30,540
elsewhere like in the crime about apt

1980
02:02:30,540 --> 02:02:32,880
I'm not sure maybe there's a lot more of

1981
02:02:32,880 --> 02:02:36,139
that happening in that end

1982
02:02:36,960 --> 02:02:38,760
I don't think there are a lot of them

1983
02:02:38,760 --> 02:02:42,540
another example was the one in Korea

1984
02:02:42,540 --> 02:02:47,239
during the winter Olympics uh

1985
02:02:47,280 --> 02:02:49,560
I don't remember exactly the details but

1986
02:02:49,560 --> 02:02:51,239
there was something with the rich

1987
02:02:51,239 --> 02:02:54,239
Shadows from like North Korean group and

1988
02:02:54,239 --> 02:02:56,280
actually it was like

1989
02:02:56,280 --> 02:02:58,860
sitting it was beyond like the attack

1990
02:02:58,860 --> 02:03:01,320
like a Russia line group

1991
02:03:01,320 --> 02:03:02,639
[Music]

1992
02:03:02,639 --> 02:03:04,619
it's it's a bit old so I don't remember

1993
02:03:04,619 --> 02:03:06,659
exactly the details but actually like

1994
02:03:06,659 --> 02:03:10,500
this group setting it make it look like

1995
02:03:10,500 --> 02:03:13,440
it was some like no score North Korean

1996
02:03:13,440 --> 02:03:16,619
online group that was behind the attack

1997
02:03:16,619 --> 02:03:20,219
but like it's it's not very common or

1998
02:03:20,219 --> 02:03:23,520
it's too good and we we don't we don't

1999
02:03:23,520 --> 02:03:27,320
realize it but I don't know

2000
02:03:32,639 --> 02:03:35,219
but you do see it in forums you see a

2001
02:03:35,219 --> 02:03:37,260
lot of sometimes arguments sometimes

2002
02:03:37,260 --> 02:03:39,960
when an author like some group has

2003
02:03:39,960 --> 02:03:41,400
developed a malware and they're selling

2004
02:03:41,400 --> 02:03:43,320
it to Affiliates the Affiliates can

2005
02:03:43,320 --> 02:03:45,540
sometimes backstab or do something that

2006
02:03:45,540 --> 02:03:47,280
they're not meant to do there's always

2007
02:03:47,280 --> 02:03:49,080
rules among them that they allow

2008
02:03:49,080 --> 02:03:52,080
Affiliates to do not do so that is

2009
02:03:52,080 --> 02:03:54,719
actually quite common in ecrime and so

2010
02:03:54,719 --> 02:03:57,119
especially again with ransomware they

2011
02:03:57,119 --> 02:03:59,340
try to tell Affiliates that because of

2012
02:03:59,340 --> 02:04:01,920
you uh you're targeting hospitals you're

2013
02:04:01,920 --> 02:04:05,159
no longer part of the program but so

2014
02:04:05,159 --> 02:04:07,320
that's pretty common or sometimes you

2015
02:04:07,320 --> 02:04:09,300
have Affiliates that will buy a test

2016
02:04:09,300 --> 02:04:12,119
build but then end up using it their own

2017
02:04:12,119 --> 02:04:14,940
way and that you know quite frankly

2018
02:04:14,940 --> 02:04:17,280
upsets the developer and then they just

2019
02:04:17,280 --> 02:04:20,219
release it or they go into Cahoots with

2020
02:04:20,219 --> 02:04:23,040
someone else but yeah so it's a as long

2021
02:04:23,040 --> 02:04:24,060
as there's money there's always

2022
02:04:24,060 --> 02:04:25,920
something to be upset about

2023
02:04:25,920 --> 02:04:27,719
these are really good examples thank you

2024
02:04:27,719 --> 02:04:30,480
and we are at times so thank you very

2025
02:04:30,480 --> 02:04:32,400
much for your presentations for

2026
02:04:32,400 --> 02:04:33,480
everything you've shared and then for

2027
02:04:33,480 --> 02:04:35,280
joining this panel

2028
02:04:35,280 --> 02:04:36,780
um it's great having this discussion

2029
02:04:36,780 --> 02:04:38,280
with you and thanks to all of you for

2030
02:04:38,280 --> 02:04:40,110
your questions

2031
02:04:40,110 --> 02:04:44,929
[Applause]

2032
02:05:22,739 --> 02:05:24,980
oh

2033
02:05:59,520 --> 02:06:01,760
foreign

2034
02:07:04,500 --> 02:07:07,500
foreign

2035
02:08:22,139 --> 02:08:24,320
foreign

2036
02:09:37,080 --> 02:09:39,920
foreign

2037
02:12:08,099 --> 02:12:10,340
foreign

2038
02:13:22,739 --> 02:13:25,218
wow

2039
02:14:57,119 --> 02:15:00,079
foreign

2040
02:16:39,599 --> 02:16:41,840
foreign

2041
02:17:33,240 --> 02:17:35,840
the people

2042
02:18:44,218 --> 02:18:46,459
foreign

2043
02:18:50,179 --> 02:18:53,580
we're gonna get started I'll let people

2044
02:18:53,580 --> 02:18:56,240
wander in and speak slowly

2045
02:18:56,240 --> 02:18:59,218
so we've got three more talks uh in this

2046
02:18:59,218 --> 02:19:01,740
room until the end of the day and uh

2047
02:19:01,740 --> 02:19:02,939
we're going to be doing a couple of

2048
02:19:02,939 --> 02:19:04,500
questions after each of them so there's

2049
02:19:04,500 --> 02:19:06,959
no final panel

2050
02:19:06,959 --> 02:19:09,000
um so I'm thrilled to be welcoming Sarah

2051
02:19:09,000 --> 02:19:12,000
karanik to the stage she's a long time

2052
02:19:12,000 --> 02:19:14,099
hacker and she spent the better part of

2053
02:19:14,099 --> 02:19:15,840
10 years as a software engineer with a

2054
02:19:15,840 --> 02:19:17,340
keen interest in security engineering

2055
02:19:17,340 --> 02:19:19,859
specifically she also had a foray into

2056
02:19:19,859 --> 02:19:21,898
entrepreneurship and now for the last

2057
02:19:21,898 --> 02:19:23,519
five years or so her main focus has been

2058
02:19:23,519 --> 02:19:26,459
on cyber security primarily offensive

2059
02:19:26,459 --> 02:19:28,260
her research interests include

2060
02:19:28,260 --> 02:19:30,780
cryptography malware reverse engineering

2061
02:19:30,780 --> 02:19:32,638
and apparently cyber warfare

2062
02:19:32,638 --> 02:19:35,478
Sarah is currently working towards her

2063
02:19:35,478 --> 02:19:37,620
ciss-p-i-s-s-e-p and in the future she

2064
02:19:37,620 --> 02:19:39,599
hopes to finally get hers Masters so

2065
02:19:39,599 --> 02:19:41,398
welcome to the stage really excited for

2066
02:19:41,398 --> 02:19:43,138
your talk

2067
02:19:43,138 --> 02:19:46,740
awesome thank you can I just go ahead

2068
02:19:46,740 --> 02:19:49,140
Roger all right

2069
02:19:49,140 --> 02:19:51,960
um my name is Sarah krainik uh thank you

2070
02:19:51,960 --> 02:19:53,700
for coming to my session I'm very happy

2071
02:19:53,700 --> 02:19:55,140
to be here and I would like to thank

2072
02:19:55,140 --> 02:19:56,580
everyone who got me here because it

2073
02:19:56,580 --> 02:19:58,320
wasn't quite a straight route

2074
02:19:58,320 --> 02:20:02,160
so yes here we go first a disclaimer

2075
02:20:02,160 --> 02:20:04,800
this was uh needed so before I get

2076
02:20:04,800 --> 02:20:06,620
started I'm solely here on my own accord

2077
02:20:06,620 --> 02:20:09,840
and I do not speak or on behalf of my

2078
02:20:09,840 --> 02:20:12,060
employer I do not talk I will not talk

2079
02:20:12,060 --> 02:20:14,640
about my work or about my work or who I

2080
02:20:14,640 --> 02:20:16,740
work for this topic is a very personal

2081
02:20:16,740 --> 02:20:19,080
interest in mine so I just need to make

2082
02:20:19,080 --> 02:20:21,000
that very clear

2083
02:20:21,000 --> 02:20:23,820
so uh to get started some goals of mine

2084
02:20:23,820 --> 02:20:25,740
today is to talk to Define and convey

2085
02:20:25,740 --> 02:20:28,020
the meaning of hybrid Warfare and how

2086
02:20:28,020 --> 02:20:29,600
it's used to date

2087
02:20:29,600 --> 02:20:32,399
how why cyber operations by a sizeable

2088
02:20:32,399 --> 02:20:35,760
war or part of hybrid Warfare

2089
02:20:35,760 --> 02:20:38,520
how we can as red teamers pen testers

2090
02:20:38,520 --> 02:20:41,280
utilize the lessons learned so far in

2091
02:20:41,280 --> 02:20:43,380
the conflict of Ukraine and Russia

2092
02:20:43,380 --> 02:20:46,080
and the opposing side of that is by

2093
02:20:46,080 --> 02:20:48,120
learning how the defensive side can also

2094
02:20:48,120 --> 02:20:50,660
learn from you

2095
02:20:51,300 --> 02:20:53,460
okay background

2096
02:20:53,460 --> 02:20:55,140
a little definition I'm not going to

2097
02:20:55,140 --> 02:20:56,460
read it verbatim so I'm just going to

2098
02:20:56,460 --> 02:20:59,160
give you 10 seconds to read it quickly

2099
02:20:59,160 --> 02:21:01,740
all right Tim all right

2100
02:21:01,740 --> 02:21:04,699
all right everyone good

2101
02:21:05,600 --> 02:21:09,420
so several components of hybrid Warfare

2102
02:21:09,420 --> 02:21:11,580
as you can see here so one diplomatic

2103
02:21:11,580 --> 02:21:12,840
pressure

2104
02:21:12,840 --> 02:21:15,120
electoral interference migration

2105
02:21:15,120 --> 02:21:17,160
actually Force migration we actually saw

2106
02:21:17,160 --> 02:21:18,540
this in Ukraine where they recently

2107
02:21:18,540 --> 02:21:21,060
deported children back to Russia to

2108
02:21:21,060 --> 02:21:24,540
Russia let's say uh we have what else do

2109
02:21:24,540 --> 02:21:26,160
we have cyber attacks corruption fake

2110
02:21:26,160 --> 02:21:29,780
news economic manipulation

2111
02:21:33,979 --> 02:21:37,279
that's right

2112
02:21:38,340 --> 02:21:41,180
oh sorry

2113
02:21:48,560 --> 02:21:51,300
so it's not my laptop whose laptop is

2114
02:21:51,300 --> 02:21:53,479
this

2115
02:22:04,140 --> 02:22:07,140
foreign

2116
02:22:35,460 --> 02:22:37,200
so this happened quite recently it's

2117
02:22:37,200 --> 02:22:40,200
still unclear who we can attribute to

2118
02:22:40,200 --> 02:22:41,760
but we could all figure out what it

2119
02:22:41,760 --> 02:22:42,720
might mean

2120
02:22:42,720 --> 02:22:45,479
I'm not going to fill in the I'll let

2121
02:22:45,479 --> 02:22:47,880
you conclude what it'll be

2122
02:22:47,880 --> 02:22:51,000
either way it conflates everything and

2123
02:22:51,000 --> 02:22:52,920
we get to the point where we confuse

2124
02:22:52,920 --> 02:22:55,080
who's done what and why

2125
02:22:55,080 --> 02:22:57,420
we're going to watch a few Clips the

2126
02:22:57,420 --> 02:22:58,800
first clip is

2127
02:22:58,800 --> 02:22:59,880
um

2128
02:22:59,880 --> 02:23:03,300
a Russian official who's denying I don't

2129
02:23:03,300 --> 02:23:04,560
know if you know about Little Green Men

2130
02:23:04,560 --> 02:23:06,899
but they invaded Crimea quite recently

2131
02:23:06,899 --> 02:23:09,060
or when in 2014

2132
02:23:09,060 --> 02:23:13,220
so this is the denial

2133
02:23:14,580 --> 02:23:17,780
well of course we don't have audio

2134
02:23:21,859 --> 02:23:24,420
okay sorry I don't know how to audio for

2135
02:23:24,420 --> 02:23:27,479
some reason anyways he goes on to say

2136
02:23:27,479 --> 02:23:30,960
uh basically we're not there what

2137
02:23:30,960 --> 02:23:33,180
why we're not there

2138
02:23:33,180 --> 02:23:35,399
of course not we're not there

2139
02:23:35,399 --> 02:23:37,740
well not too long after

2140
02:23:37,740 --> 02:23:41,220
of course the commander from Russia

2141
02:23:41,220 --> 02:23:43,560
yeah we're there of course we are we

2142
02:23:43,560 --> 02:23:45,780
actually uh played with the system got

2143
02:23:45,780 --> 02:23:48,960
people to vote vote in a proxy war or

2144
02:23:48,960 --> 02:23:51,359
proxy vote

2145
02:23:51,359 --> 02:23:53,040
um yeah and so

2146
02:23:53,040 --> 02:23:56,100
it's it's p if you can get people to

2147
02:23:56,100 --> 02:23:57,840
choose to vote for you

2148
02:23:57,840 --> 02:24:02,280
and choose to have a referendum by force

2149
02:24:02,280 --> 02:24:04,200
then you don't need to invade them right

2150
02:24:04,200 --> 02:24:06,620
so

2151
02:24:08,160 --> 02:24:10,080
so here's a perfect example of plausible

2152
02:24:10,080 --> 02:24:12,000
deniability if one can get International

2153
02:24:12,000 --> 02:24:14,280
Community to believe that people voted

2154
02:24:14,280 --> 02:24:16,800
for something themselves AKA a proxy

2155
02:24:16,800 --> 02:24:19,920
vote then there is no Invasion right so

2156
02:24:19,920 --> 02:24:22,260
you just you're invited you voted you

2157
02:24:22,260 --> 02:24:24,660
voted as for it to come another unique

2158
02:24:24,660 --> 02:24:26,819
aspect of this conflict has been the way

2159
02:24:26,819 --> 02:24:28,920
drones have been utilized

2160
02:24:28,920 --> 02:24:31,140
uh more traditional usage of bombing and

2161
02:24:31,140 --> 02:24:33,060
surveillance but also a so-called

2162
02:24:33,060 --> 02:24:35,520
Kamikaze emissions the types of drones

2163
02:24:35,520 --> 02:24:38,460
has varied as well both purpose military

2164
02:24:38,460 --> 02:24:40,680
hardware and the use of publicly

2165
02:24:40,680 --> 02:24:43,680
available Hardware the uses of aus shelf

2166
02:24:43,680 --> 02:24:45,780
Hardware has gotten to the point where

2167
02:24:45,780 --> 02:24:48,240
some manufactured manufacturers like DJI

2168
02:24:48,240 --> 02:24:50,160
have refused to sell it to Russia

2169
02:24:50,160 --> 02:24:53,040
Ukraine because it might be used in the

2170
02:24:53,040 --> 02:24:55,520
act of War

2171
02:24:56,520 --> 02:24:59,939
this is actually a clip of an example of

2172
02:24:59,939 --> 02:25:01,620
how they're using drones in particular

2173
02:25:01,620 --> 02:25:03,720
Kamikaze so you'll actually see it come

2174
02:25:03,720 --> 02:25:07,160
in in just a sec

2175
02:25:14,359 --> 02:25:17,100
okay get on to the interesting part

2176
02:25:17,100 --> 02:25:20,220
cyber warfare so some some examples of

2177
02:25:20,220 --> 02:25:23,220
cyber war attacks in 2022 this graphic

2178
02:25:23,220 --> 02:25:25,200
is interesting from the perspective it

2179
02:25:25,200 --> 02:25:27,060
marries kinetic attacks and cyber

2180
02:25:27,060 --> 02:25:29,819
attacks so this is on the ground attacks

2181
02:25:29,819 --> 02:25:32,399
as well as in the Cyber Realm

2182
02:25:32,399 --> 02:25:34,319
the magic can agricult cyber operations

2183
02:25:34,319 --> 02:25:36,420
as a theme we'll see uh come quite

2184
02:25:36,420 --> 02:25:39,120
regularly I'll highlight two events in

2185
02:25:39,120 --> 02:25:41,460
particular one cyber one connected they

2186
02:25:41,460 --> 02:25:44,100
happen to happen on April 11th so you

2187
02:25:44,100 --> 02:25:46,680
can actually see April 11th no sorry

2188
02:25:46,680 --> 02:25:49,920
March 11th my my bad so if you see the

2189
02:25:49,920 --> 02:25:52,439
Russian strikes in dinitro and then we

2190
02:25:52,439 --> 02:25:56,220
have the matching government attack and

2191
02:25:56,220 --> 02:25:59,220
the Cyber Realm

2192
02:25:59,220 --> 02:26:01,080
so we're working closely with Kinetic

2193
02:26:01,080 --> 02:26:03,960
operational command often makes for more

2194
02:26:03,960 --> 02:26:06,600
effective use of cyber capabilities this

2195
02:26:06,600 --> 02:26:09,120
is just not relevant for Warfare but

2196
02:26:09,120 --> 02:26:10,380
also when conducting red team

2197
02:26:10,380 --> 02:26:12,960
assessments for example you will need to

2198
02:26:12,960 --> 02:26:14,880
coordinate all groups involved with your

2199
02:26:14,880 --> 02:26:16,859
engagement physical social engineering

2200
02:26:16,859 --> 02:26:18,720
Network everyone needs to coordinate

2201
02:26:18,720 --> 02:26:20,880
together your talk must be coordinated

2202
02:26:20,880 --> 02:26:24,560
super coordinating okay

2203
02:26:24,840 --> 02:26:28,200
so these are some attacks that let up so

2204
02:26:28,200 --> 02:26:31,020
we they start in 2014 which is if

2205
02:26:31,020 --> 02:26:32,880
everybody's aware of their timeline is

2206
02:26:32,880 --> 02:26:35,960
when basically Crimea was

2207
02:26:35,960 --> 02:26:37,740
annexed

2208
02:26:37,740 --> 02:26:38,880
um

2209
02:26:38,880 --> 02:26:41,340
so we start there we go for a DDOS

2210
02:26:41,340 --> 02:26:43,500
attack and then it goes to activists

2211
02:26:43,500 --> 02:26:46,740
power grid attacks and you can see the

2212
02:26:46,740 --> 02:26:49,439
succession of attacks up till about 2022

2213
02:26:49,439 --> 02:26:52,319
in February was the official invasion of

2214
02:26:52,319 --> 02:26:53,880
eastern Ukraine

2215
02:26:53,880 --> 02:26:56,220
uh so we'll talk about two of those

2216
02:26:56,220 --> 02:26:58,680
attacks

2217
02:26:58,680 --> 02:27:00,120
um in particular we'll talk about

2218
02:27:00,120 --> 02:27:02,880
nepecha and we'll talk about the power

2219
02:27:02,880 --> 02:27:05,420
grid attacks

2220
02:27:05,420 --> 02:27:08,280
but first Russia so what do we know

2221
02:27:08,280 --> 02:27:10,939
about Russia

2222
02:27:12,080 --> 02:27:14,640
their focus has been on disrupting

2223
02:27:14,640 --> 02:27:16,560
Society through information Warfare and

2224
02:27:16,560 --> 02:27:18,359
cyber attacks on businesses and critical

2225
02:27:18,359 --> 02:27:21,060
infrastructure Dutch intelligence report

2226
02:27:21,060 --> 02:27:23,160
suggests that other incidents such as

2227
02:27:23,160 --> 02:27:25,260
malware and disrupting Ukrainian power

2228
02:27:25,260 --> 02:27:27,479
supply are probably mainly aimed at

2229
02:27:27,479 --> 02:27:29,640
undermining Ukrainian morale rather than

2230
02:27:29,640 --> 02:27:31,560
all-out like achieving a military

2231
02:27:31,560 --> 02:27:33,960
objective this boosts the point that

2232
02:27:33,960 --> 02:27:36,479
Russia is focused on disruption

2233
02:27:36,479 --> 02:27:39,020
rather than a cyber physical damage

2234
02:27:39,020 --> 02:27:43,460
rather on Cyber physical damage

2235
02:27:44,220 --> 02:27:46,740
but what's quite interesting even though

2236
02:27:46,740 --> 02:27:48,960
they're trying to avoid like

2237
02:27:48,960 --> 02:27:49,920
um

2238
02:27:49,920 --> 02:27:52,740
not damage in the Cyber realm they have

2239
02:27:52,740 --> 02:27:55,140
gone after Targets on the kinetic side

2240
02:27:55,140 --> 02:27:58,800
like on hospitals and other targets like

2241
02:27:58,800 --> 02:28:01,319
schools so yeah it's kind of interesting

2242
02:28:01,319 --> 02:28:03,680
that way

2243
02:28:03,899 --> 02:28:05,760
but there's also this question if they

2244
02:28:05,760 --> 02:28:08,280
do goes in the one interesting about a

2245
02:28:08,280 --> 02:28:10,740
Cyber attack too is many of you know is

2246
02:28:10,740 --> 02:28:12,359
you can't really Target as well as

2247
02:28:12,359 --> 02:28:15,060
kinetic and it can get out and this is a

2248
02:28:15,060 --> 02:28:18,800
theme that we'll see coming up

2249
02:28:19,140 --> 02:28:22,080
so a few viruses that you might know one

2250
02:28:22,080 --> 02:28:24,720
of the earliest is earliest that got out

2251
02:28:24,720 --> 02:28:27,240
of the uh realm was the Morris worm if

2252
02:28:27,240 --> 02:28:28,500
anyone's familiar with that it was one

2253
02:28:28,500 --> 02:28:30,000
of the earliest viruses if not the

2254
02:28:30,000 --> 02:28:32,819
earliest and another one more recently

2255
02:28:32,819 --> 02:28:34,200
was a wannacry

2256
02:28:34,200 --> 02:28:36,000
after that and that was based off

2257
02:28:36,000 --> 02:28:37,620
external blue which is interesting

2258
02:28:37,620 --> 02:28:39,420
because we'll just get to nepecha which

2259
02:28:39,420 --> 02:28:43,220
is also built off external blue

2260
02:28:43,819 --> 02:28:47,160
so nepecia now betcha was composed of

2261
02:28:47,160 --> 02:28:49,439
two separate components external blue

2262
02:28:49,439 --> 02:28:51,359
and mini cats and now Petra was a

2263
02:28:51,359 --> 02:28:54,060
derivative of the Petra malware so blue

2264
02:28:54,060 --> 02:28:56,819
is a leaked NSA Hocking tool which

2265
02:28:56,819 --> 02:28:58,500
exploited a no-bound ability of the

2266
02:28:58,500 --> 02:29:00,960
Microsoft server message block so this

2267
02:29:00,960 --> 02:29:04,740
is smv V1 protocol an infiltrated window

2268
02:29:04,740 --> 02:29:07,380
systems with outdated security the net

2269
02:29:07,380 --> 02:29:09,240
Petra Attack originated from an update

2270
02:29:09,240 --> 02:29:11,280
to the Ukrainian tax software called me

2271
02:29:11,280 --> 02:29:14,100
Doc during their talk radiation monitor

2272
02:29:14,100 --> 02:29:16,260
even at Chernobyl went offline sub

2273
02:29:16,260 --> 02:29:18,780
recreated Ministries Banks Metro systems

2274
02:29:18,780 --> 02:29:23,640
and other Enterprises were also affected

2275
02:29:23,640 --> 02:29:24,899
um

2276
02:29:24,899 --> 02:29:26,760
I don't know if you know about net Petra

2277
02:29:26,760 --> 02:29:29,220
I think hit at about 10 billion in

2278
02:29:29,220 --> 02:29:31,319
Damages around the world too so not just

2279
02:29:31,319 --> 02:29:33,240
in Ukraine

2280
02:29:33,240 --> 02:29:34,020
um

2281
02:29:34,020 --> 02:29:36,240
though initially label is ransomware due

2282
02:29:36,240 --> 02:29:38,280
to Ransom message that was displayed

2283
02:29:38,280 --> 02:29:40,620
after infection it was soon proven that

2284
02:29:40,620 --> 02:29:42,420
neppetch functions more like a

2285
02:29:42,420 --> 02:29:44,640
destructive wiper tool rather than

2286
02:29:44,640 --> 02:29:47,640
actual ransomware

2287
02:29:47,640 --> 02:29:49,859
the attack came on the Eve also at the

2288
02:29:49,859 --> 02:29:51,660
Ukrainian public holiday

2289
02:29:51,660 --> 02:29:55,260
um uh called Constitution Day

2290
02:29:55,260 --> 02:29:57,420
now Petra was a destructive and spread

2291
02:29:57,420 --> 02:29:59,040
quickly but many accounts who was also

2292
02:29:59,040 --> 02:30:01,560
an act of cyber War which is interesting

2293
02:30:01,560 --> 02:30:03,780
because there was a an insurance company

2294
02:30:03,780 --> 02:30:06,540
called zerk that actually denied claims

2295
02:30:06,540 --> 02:30:07,979
in the hundreds of millions of dollars

2296
02:30:07,979 --> 02:30:10,500
because they claimed it was an act of

2297
02:30:10,500 --> 02:30:12,899
War so it was one of the few attacks

2298
02:30:12,899 --> 02:30:14,040
that were actually labeled from the

2299
02:30:14,040 --> 02:30:17,840
start as a cyber act or a cyber War Act

2300
02:30:17,840 --> 02:30:20,460
because the Cyber War didn't fall under

2301
02:30:20,460 --> 02:30:23,700
the purview of the insurance policies

2302
02:30:23,700 --> 02:30:25,979
um yeah they took it to court and I

2303
02:30:25,979 --> 02:30:28,319
think just recently they settled and I

2304
02:30:28,319 --> 02:30:29,340
don't know what the settlement because

2305
02:30:29,340 --> 02:30:31,160
it wasn't made public

2306
02:30:31,160 --> 02:30:34,200
so nap Petra overwrites

2307
02:30:34,200 --> 02:30:36,060
and encrypt sectors of the physical hard

2308
02:30:36,060 --> 02:30:37,920
drive and the C volume but it does not

2309
02:30:37,920 --> 02:30:40,140
contain the ability to restore the files

2310
02:30:40,140 --> 02:30:42,420
rendering the recovery of possible even

2311
02:30:42,420 --> 02:30:44,580
if the ransom is paid this is why it was

2312
02:30:44,580 --> 02:30:46,979
not attributed to ransomware using the

2313
02:30:46,979 --> 02:30:49,380
windows API device i o control the

2314
02:30:49,380 --> 02:30:51,899
malware is able to direct to direct read

2315
02:30:51,899 --> 02:30:53,880
and write access to the physical hard

2316
02:30:53,880 --> 02:30:56,819
drive without an interaction with the

2317
02:30:56,819 --> 02:30:58,740
operating system

2318
02:30:58,740 --> 02:31:01,020
this allowed the code to determine the

2319
02:31:01,020 --> 02:31:03,840
number of disks and partitions on the

2320
02:31:03,840 --> 02:31:05,640
system unmount and mounted for volume

2321
02:31:05,640 --> 02:31:07,979
even if it was in use I determined the

2322
02:31:07,979 --> 02:31:10,200
drive geometry for the drives on the

2323
02:31:10,200 --> 02:31:12,060
system the number of sectors bytes and

2324
02:31:12,060 --> 02:31:14,819
per second sector the malware uses the

2325
02:31:14,819 --> 02:31:16,920
access to destroy data critical to the

2326
02:31:16,920 --> 02:31:19,920
operating system the Petra also had the

2327
02:31:19,920 --> 02:31:21,840
ability to replace the OS bootloader

2328
02:31:21,840 --> 02:31:26,060
with custom code embedded in the binary

2329
02:31:27,140 --> 02:31:29,640
so the next attack I chose as well

2330
02:31:29,640 --> 02:31:32,460
because it went after OT systems rather

2331
02:31:32,460 --> 02:31:34,319
than just it systems

2332
02:31:34,319 --> 02:31:36,300
and so the power Distribution Company

2333
02:31:36,300 --> 02:31:38,220
sustained a Cyber attack and Western

2334
02:31:38,220 --> 02:31:41,160
Ukraine on the 23rd of December 2015.

2335
02:31:41,160 --> 02:31:43,380
although although the attack was

2336
02:31:43,380 --> 02:31:46,140
triggered in 2015 it was carefully

2337
02:31:46,140 --> 02:31:49,140
planned networks and systems

2338
02:31:49,140 --> 02:31:50,939
were compromised as early as eight

2339
02:31:50,939 --> 02:31:53,580
months before in the spring of 2015 a

2340
02:31:53,580 --> 02:31:55,740
variety of black energy malware was

2341
02:31:55,740 --> 02:31:58,939
triggered with an employee of the

2342
02:31:58,939 --> 02:32:02,479
opened an Excel attachment of an email

2343
02:32:02,479 --> 02:32:04,740
if you don't know black energy is a

2344
02:32:04,740 --> 02:32:07,260
malware Suite that was first hit the

2345
02:32:07,260 --> 02:32:10,380
news in 2014 when I was used extensively

2346
02:32:10,380 --> 02:32:13,859
if to infiltrate energy utilities

2347
02:32:13,859 --> 02:32:15,840
its a was to gather intelligence about

2348
02:32:15,840 --> 02:32:17,580
the infrastructure networks to help

2349
02:32:17,580 --> 02:32:19,920
prepare for future cyber attacks during

2350
02:32:19,920 --> 02:32:22,500
several months into summer of 2015 black

2351
02:32:22,500 --> 02:32:24,660
energy malware was remotely controlled

2352
02:32:24,660 --> 02:32:27,479
to collect data hop from one host to the

2353
02:32:27,479 --> 02:32:29,819
other and detect vulnerabilities and

2354
02:32:29,819 --> 02:32:31,680
even make its way out to all T networks

2355
02:32:31,680 --> 02:32:33,240
and perform some of the reconnaissance

2356
02:32:33,240 --> 02:32:36,300
activities the afternoon two days after

2357
02:32:36,300 --> 02:32:38,280
Christmas as stated by the operator the

2358
02:32:38,280 --> 02:32:39,899
mouse started to move

2359
02:32:39,899 --> 02:32:42,479
on the HMI system so that's a human

2360
02:32:42,479 --> 02:32:45,060
machine interface and start switching

2361
02:32:45,060 --> 02:32:47,700
off Breakers remotely

2362
02:32:47,700 --> 02:32:50,160
when the local operator attempted to

2363
02:32:50,160 --> 02:32:52,380
regain control is super the supervision

2364
02:32:52,380 --> 02:32:54,780
interface he was logged off and could

2365
02:32:54,780 --> 02:32:56,520
not log in again because a password had

2366
02:32:56,520 --> 02:32:57,979
been changed

2367
02:32:57,979 --> 02:33:00,000
additional malware in particularly to

2368
02:33:00,000 --> 02:33:01,800
custom develop export was used to

2369
02:33:01,800 --> 02:33:03,240
prevent operator from regaining control

2370
02:33:03,240 --> 02:33:06,600
to the network by wiping out many disks

2371
02:33:06,600 --> 02:33:08,340
using killdisk

2372
02:33:08,340 --> 02:33:11,100
overwriting external to serial Gateway

2373
02:33:11,100 --> 02:33:13,380
firmware with random code thus turning

2374
02:33:13,380 --> 02:33:16,859
devices into basically scrap

2375
02:33:16,859 --> 02:33:18,960
but the attack was too fast to allow any

2376
02:33:18,960 --> 02:33:20,520
reaction indeed a critical

2377
02:33:20,520 --> 02:33:22,740
infrastructure environment operating

2378
02:33:22,740 --> 02:33:24,720
actions may cause safety issues

2379
02:33:24,720 --> 02:33:26,000
therefore

2380
02:33:26,000 --> 02:33:28,640
uh they really could do anything because

2381
02:33:28,640 --> 02:33:31,620
they have predefined actions in a lot of

2382
02:33:31,620 --> 02:33:33,060
these places

2383
02:33:33,060 --> 02:33:35,760
and so he had the operator had to follow

2384
02:33:35,760 --> 02:33:38,220
guidelines and to take action and if

2385
02:33:38,220 --> 02:33:40,140
those actions don't include such things

2386
02:33:40,140 --> 02:33:42,000
as a Cyber attack

2387
02:33:42,000 --> 02:33:44,460
while your Sol

2388
02:33:44,460 --> 02:33:46,920
this is exactly thing that happened in

2389
02:33:46,920 --> 02:33:48,840
Ukraine

2390
02:33:48,840 --> 02:33:49,740
um

2391
02:33:49,740 --> 02:33:51,899
so it was it's great to have Sops or

2392
02:33:51,899 --> 02:33:52,979
what we call Standard offering

2393
02:33:52,979 --> 02:33:54,780
procedures but we also need to account

2394
02:33:54,780 --> 02:33:57,060
for when those actions arise and Sops

2395
02:33:57,060 --> 02:33:59,220
can't handle that or are planned for

2396
02:33:59,220 --> 02:34:00,540
them

2397
02:34:00,540 --> 02:34:02,460
considering attackers are constantly

2398
02:34:02,460 --> 02:34:03,780
coming up with new ways to attack our

2399
02:34:03,780 --> 02:34:05,939
organizations our saps need to find a

2400
02:34:05,939 --> 02:34:08,640
way to adapt as well obvious actions

2401
02:34:08,640 --> 02:34:10,439
could have stopped the attack but like I

2402
02:34:10,439 --> 02:34:12,600
said it's OT and there's really standard

2403
02:34:12,600 --> 02:34:14,939
ways of doing everything so you could

2404
02:34:14,939 --> 02:34:18,560
just let's say unplug the system

2405
02:34:20,960 --> 02:34:23,760
okay so what what do we know about the

2406
02:34:23,760 --> 02:34:27,060
Ukrainian operations this is where my

2407
02:34:27,060 --> 02:34:28,680
talk really came from because I was

2408
02:34:28,680 --> 02:34:32,220
really addressing interested in how

2409
02:34:32,220 --> 02:34:34,920
Ukraine was expected within days to fall

2410
02:34:34,920 --> 02:34:38,040
to Russia right so no one expected to be

2411
02:34:38,040 --> 02:34:40,859
here in 2023 in Russia's or Ukraine

2412
02:34:40,859 --> 02:34:43,260
still fighting on both the Cyber realm

2413
02:34:43,260 --> 02:34:44,960
and the kinetic Realm

2414
02:34:44,960 --> 02:34:48,140
so why

2415
02:34:53,280 --> 02:34:55,500
I had I came up with two things in my

2416
02:34:55,500 --> 02:34:57,000
mind

2417
02:34:57,000 --> 02:34:57,840
um

2418
02:34:57,840 --> 02:35:00,960
one was the the

2419
02:35:00,960 --> 02:35:03,899
Russian actions failed to materialize

2420
02:35:03,899 --> 02:35:06,540
and distribute those attacks

2421
02:35:06,540 --> 02:35:08,640
and Ukraine had better than expected

2422
02:35:08,640 --> 02:35:10,160
defenses

2423
02:35:10,160 --> 02:35:12,720
most Russian digital attacks attempts

2424
02:35:12,720 --> 02:35:14,780
were directed prematurely or mediated

2425
02:35:14,780 --> 02:35:17,760
quickly thanks to far-reaching Ukrainian

2426
02:35:17,760 --> 02:35:19,620
monitoring detection and response

2427
02:35:19,620 --> 02:35:22,560
measures Ukraine receives receives also

2428
02:35:22,560 --> 02:35:25,020
significant help from Western

2429
02:35:25,020 --> 02:35:27,300
both companies and governments

2430
02:35:27,300 --> 02:35:29,280
one Center for strategic and

2431
02:35:29,280 --> 02:35:30,960
International Studies reported

2432
02:35:30,960 --> 02:35:32,580
what apparent weakness of the Russian

2433
02:35:32,580 --> 02:35:35,340
cyber operations has been the lack

2434
02:35:35,340 --> 02:35:37,439
between the Cyber and conventional

2435
02:35:37,439 --> 02:35:39,840
attacking but I've talked to elect level

2436
02:35:39,840 --> 02:35:42,000
cyber attacks provide benefits plan to

2437
02:35:42,000 --> 02:35:43,859
combined with other weapons including

2438
02:35:43,859 --> 02:35:45,960
conventional Delivery Systems Precision

2439
02:35:45,960 --> 02:35:48,420
guided Munitions augmented aerial

2440
02:35:48,420 --> 02:35:50,399
Vehicles like padrones and electronic

2441
02:35:50,399 --> 02:35:53,359
warfare interesting Ukraine had a better

2442
02:35:53,359 --> 02:35:56,760
ability to deploy these mechanisms the

2443
02:35:56,760 --> 02:35:59,520
combination can command networks

2444
02:35:59,520 --> 02:36:01,620
and advanced weapon systems that

2445
02:36:01,620 --> 02:36:03,420
contribute to addition of opposing

2446
02:36:03,420 --> 02:36:06,600
forces however when it used in an ad hoc

2447
02:36:06,600 --> 02:36:09,300
manner or went on coordinated with air

2448
02:36:09,300 --> 02:36:11,280
and ground actions cyber attacks proved

2449
02:36:11,280 --> 02:36:13,859
less useful

2450
02:36:13,859 --> 02:36:15,540
the one area Russia seems quite

2451
02:36:15,540 --> 02:36:18,600
successful and talented at has been what

2452
02:36:18,600 --> 02:36:20,220
we call you know information Warfare

2453
02:36:20,220 --> 02:36:23,240
right their propaganda

2454
02:36:24,060 --> 02:36:25,680
they could go after more physical

2455
02:36:25,680 --> 02:36:28,140
targets but they would have to really do

2456
02:36:28,140 --> 02:36:30,600
it in such a way that's very convert

2457
02:36:30,600 --> 02:36:32,280
comfort me

2458
02:36:32,280 --> 02:36:35,040
and they must do it in such a way that

2459
02:36:35,040 --> 02:36:36,540
they're careful because the Russia

2460
02:36:36,540 --> 02:36:39,479
doesn't uh enjoy the reputation that

2461
02:36:39,479 --> 02:36:41,819
Ukraine does Ukraine has this

2462
02:36:41,819 --> 02:36:44,280
aura about it right so they can do

2463
02:36:44,280 --> 02:36:45,720
pretty much anything without getting

2464
02:36:45,720 --> 02:36:48,899
into Harm's Way whereas Russia

2465
02:36:48,899 --> 02:36:50,640
they do something they get a deep

2466
02:36:50,640 --> 02:36:51,720
trouble especially if they start

2467
02:36:51,720 --> 02:36:55,039
attacking NATO countries

2468
02:36:57,180 --> 02:36:58,800
another part of this I don't know if

2469
02:36:58,800 --> 02:37:01,140
anybody's heard of the it Army

2470
02:37:01,140 --> 02:37:04,140
but Ukraine Idol utilizes this it Army

2471
02:37:04,140 --> 02:37:05,700
concept which is a built off of

2472
02:37:05,700 --> 02:37:07,460
volunteers

2473
02:37:07,460 --> 02:37:09,359
it

2474
02:37:09,359 --> 02:37:10,680
there's a lot of argument to get it

2475
02:37:10,680 --> 02:37:12,840
against it but we'll get to that quickly

2476
02:37:12,840 --> 02:37:14,520
or soon

2477
02:37:14,520 --> 02:37:15,180
um

2478
02:37:15,180 --> 02:37:17,160
they there's a lot of theories that they

2479
02:37:17,160 --> 02:37:18,200
just keep

2480
02:37:18,200 --> 02:37:20,880
Russia busy while the ukrainians can

2481
02:37:20,880 --> 02:37:23,160
focus on their defensive and offensive

2482
02:37:23,160 --> 02:37:25,560
cyber operations

2483
02:37:25,560 --> 02:37:30,680
any any other actions is just a bonus

2484
02:37:33,960 --> 02:37:36,899
that being said they do have some

2485
02:37:36,899 --> 02:37:38,399
standard

2486
02:37:38,399 --> 02:37:41,460
um rules

2487
02:37:42,780 --> 02:37:44,640
but there has been some criticism

2488
02:37:44,640 --> 02:37:47,580
because they have gone after

2489
02:37:47,580 --> 02:37:50,880
targets that maybe are not

2490
02:37:50,880 --> 02:37:52,800
just military targets let's put it that

2491
02:37:52,800 --> 02:37:54,920
way

2492
02:37:55,020 --> 02:37:56,760
and the problem is controlling what

2493
02:37:56,760 --> 02:37:58,260
people do so if you have a bunch of

2494
02:37:58,260 --> 02:38:00,540
volunteers how do you control them

2495
02:38:00,540 --> 02:38:03,840
and Mike and but another aspect that we

2496
02:38:03,840 --> 02:38:05,640
can think about is if you have a bunch

2497
02:38:05,640 --> 02:38:07,920
of voluntaries you can also have some

2498
02:38:07,920 --> 02:38:09,720
plausible deniability of a bunch of

2499
02:38:09,720 --> 02:38:11,399
volunteers doing stuff well it's not us

2500
02:38:11,399 --> 02:38:14,539
right we're not doing it

2501
02:38:15,120 --> 02:38:17,819
um so you can re uh remain at arm's

2502
02:38:17,819 --> 02:38:19,439
lengths and have that plausible

2503
02:38:19,439 --> 02:38:22,160
deniability

2504
02:38:23,399 --> 02:38:25,560
they have used telegram to organize and

2505
02:38:25,560 --> 02:38:27,660
they also have this called MSHA dos I

2506
02:38:27,660 --> 02:38:28,800
don't know if anyone knows this Library

2507
02:38:28,800 --> 02:38:32,100
it actually does like Mass DDOS attacks

2508
02:38:32,100 --> 02:38:33,479
you're not supposed to use it for

2509
02:38:33,479 --> 02:38:36,720
nefarious purposes of course

2510
02:38:36,720 --> 02:38:37,740
um

2511
02:38:37,740 --> 02:38:40,140
so the it Army has these rules of

2512
02:38:40,140 --> 02:38:41,880
engagement or

2513
02:38:41,880 --> 02:38:45,800
um yeah their rules engagement but

2514
02:38:45,840 --> 02:38:47,760
um if you work with hackers at all it's

2515
02:38:47,760 --> 02:38:49,859
hard to control what they do so it's

2516
02:38:49,859 --> 02:38:51,600
better to say hey here's a bunch of

2517
02:38:51,600 --> 02:38:54,420
tools hands off and interestingly at the

2518
02:38:54,420 --> 02:38:56,160
beginning of the whole it army they were

2519
02:38:56,160 --> 02:38:58,380
just giving them a bunch of targets and

2520
02:38:58,380 --> 02:39:00,780
here have fun now they've gone to the

2521
02:39:00,780 --> 02:39:02,580
point where they're using this mha dos

2522
02:39:02,580 --> 02:39:05,880
to build a bot and you just have to

2523
02:39:05,880 --> 02:39:07,880
connect with their bot and you can

2524
02:39:07,880 --> 02:39:12,080
participate in their actions

2525
02:39:12,080 --> 02:39:14,880
as I said before people are just going

2526
02:39:14,880 --> 02:39:16,800
after targets and I have heard stories

2527
02:39:16,800 --> 02:39:19,680
of people actually on their own accord

2528
02:39:19,680 --> 02:39:22,140
going after things like OT networks

2529
02:39:22,140 --> 02:39:25,200
ics's and scada systems and taking out

2530
02:39:25,200 --> 02:39:29,520
power plants and various things

2531
02:39:29,520 --> 02:39:32,880
but before you do this I have to say you

2532
02:39:32,880 --> 02:39:35,640
are might be act in an act of war and

2533
02:39:35,640 --> 02:39:37,680
hacking and we all know that's illegal

2534
02:39:37,680 --> 02:39:39,600
so I have to make that perfectly clear

2535
02:39:39,600 --> 02:39:43,100
you do that you're in deep trouble

2536
02:39:43,439 --> 02:39:45,720
before the it Army uh there was an

2537
02:39:45,720 --> 02:39:47,160
entrepreneur who was also doing some

2538
02:39:47,160 --> 02:39:50,060
voluntary activity

2539
02:39:51,060 --> 02:39:53,580
uh cellular tooling as I said is the mha

2540
02:39:53,580 --> 02:39:55,620
Dos framework which forms the basis of a

2541
02:39:55,620 --> 02:39:57,840
bot they built that the Cyber Armory

2542
02:39:57,840 --> 02:40:00,000
volunteers can use to participate in

2543
02:40:00,000 --> 02:40:01,439
efforts

2544
02:40:01,439 --> 02:40:03,600
not so shockingly there has also been

2545
02:40:03,600 --> 02:40:07,080
cases of Russia building tools and

2546
02:40:07,080 --> 02:40:09,319
distributing them to

2547
02:40:09,319 --> 02:40:11,880
partisans if you will and taking

2548
02:40:11,880 --> 02:40:14,460
advantage of them that way so if you

2549
02:40:14,460 --> 02:40:15,540
don't know maybe what you're doing

2550
02:40:15,540 --> 02:40:18,359
exactly and you download this tool

2551
02:40:18,359 --> 02:40:22,280
there was some Trojans on it

2552
02:40:28,740 --> 02:40:30,660
okay planning and launching a Cyber

2553
02:40:30,660 --> 02:40:32,399
attack

2554
02:40:32,399 --> 02:40:34,020
let's shift our Focus we have learned

2555
02:40:34,020 --> 02:40:35,460
Lots about what's happening in the

2556
02:40:35,460 --> 02:40:37,020
tactics and technique so what does this

2557
02:40:37,020 --> 02:40:38,100
mean for us

2558
02:40:38,100 --> 02:40:40,560
most of us in this cyber world are well

2559
02:40:40,560 --> 02:40:43,699
aware of the kill chain

2560
02:40:43,859 --> 02:40:45,720
by Lockheed there's also the miter

2561
02:40:45,720 --> 02:40:47,880
attack framework which is also which is

2562
02:40:47,880 --> 02:40:49,620
more exhaustive but for the use case at

2563
02:40:49,620 --> 02:40:51,240
hand

2564
02:40:51,240 --> 02:40:55,699
I use the Cyber kill chain

2565
02:40:55,920 --> 02:40:56,580
um

2566
02:40:56,580 --> 02:40:58,920
cyber generally doesn't happen in

2567
02:40:58,920 --> 02:41:00,479
isolation although the rule has been

2568
02:41:00,479 --> 02:41:03,080
broken previously like stuxnet

2569
02:41:03,080 --> 02:41:05,760
although it's ducksnet

2570
02:41:05,760 --> 02:41:07,800
there was a huge component on the ground

2571
02:41:07,800 --> 02:41:09,600
is the theory because they would have

2572
02:41:09,600 --> 02:41:12,660
had to get all that information prior to

2573
02:41:12,660 --> 02:41:15,560
the actual event

2574
02:41:17,340 --> 02:41:19,020
but this is especially when you're

2575
02:41:19,020 --> 02:41:20,399
talking about critical infrastructure

2576
02:41:20,399 --> 02:41:22,319
and other

2577
02:41:22,319 --> 02:41:24,439
um

2578
02:41:24,960 --> 02:41:28,260
OT infrastructures uh the the amount of

2579
02:41:28,260 --> 02:41:30,200
information that you need

2580
02:41:30,200 --> 02:41:34,520
is hugely important

2581
02:41:34,920 --> 02:41:35,880
especially when we're talking about

2582
02:41:35,880 --> 02:41:37,439
critical infrastructure cyber attacks

2583
02:41:37,439 --> 02:41:39,359
could have real world consequences

2584
02:41:39,359 --> 02:41:41,460
wouldn't take much to cause harm for

2585
02:41:41,460 --> 02:41:44,160
example stopping the water treatment

2586
02:41:44,160 --> 02:41:47,100
or targeting a local hospital

2587
02:41:47,100 --> 02:41:49,200
sure there's civilian targets but let's

2588
02:41:49,200 --> 02:41:51,359
be serious nation states might shy away

2589
02:41:51,359 --> 02:41:52,500
from

2590
02:41:52,500 --> 02:41:55,020
reasons touched on already

2591
02:41:55,020 --> 02:41:57,420
what about motivated partisan group or

2592
02:41:57,420 --> 02:41:59,399
individuals or nation-states who don't

2593
02:41:59,399 --> 02:42:01,740
care about International decorum or laws

2594
02:42:01,740 --> 02:42:04,140
concerning OT systems are widely under

2595
02:42:04,140 --> 02:42:06,960
defended and rely on outdated Tech

2596
02:42:06,960 --> 02:42:08,760
with more being connected to the

2597
02:42:08,760 --> 02:42:11,340
interwebs it is it's not inconceivable

2598
02:42:11,340 --> 02:42:12,899
that a bad actor Will Target these

2599
02:42:12,899 --> 02:42:14,880
systems neither inadvertently or

2600
02:42:14,880 --> 02:42:17,280
advertently Target civilians it is

2601
02:42:17,280 --> 02:42:19,500
shocking that it hasn't happened more

2602
02:42:19,500 --> 02:42:21,060
than we've seen already

2603
02:42:21,060 --> 02:42:23,160
attribution would be hard and like many

2604
02:42:23,160 --> 02:42:25,260
breaches may not be detected for a long

2605
02:42:25,260 --> 02:42:27,479
time before being remediated like we saw

2606
02:42:27,479 --> 02:42:29,880
in the power of great attack

2607
02:42:29,880 --> 02:42:31,500
rolling out of serious attacks and

2608
02:42:31,500 --> 02:42:33,420
making it innocuous enough to not create

2609
02:42:33,420 --> 02:42:35,220
waves and alert the authorities and true

2610
02:42:35,220 --> 02:42:36,840
nature and scope of the attack is key

2611
02:42:36,840 --> 02:42:39,780
sure it takes planning and organization

2612
02:42:39,780 --> 02:42:41,280
and all that is lacking is a current

2613
02:42:41,280 --> 02:42:44,540
climate is a motivated party

2614
02:42:44,580 --> 02:42:46,439
staggering attacks would help to hide

2615
02:42:46,439 --> 02:42:47,880
the true motivation or hinder

2616
02:42:47,880 --> 02:42:50,520
attribution added some disinformation

2617
02:42:50,520 --> 02:42:53,460
about who might be at fault and blame

2618
02:42:53,460 --> 02:42:55,800
the official opposition for example of

2619
02:42:55,800 --> 02:42:58,140
the ruling party and you're on Off to

2620
02:42:58,140 --> 02:43:00,619
the Races

2621
02:43:01,260 --> 02:43:03,240
yeah

2622
02:43:03,240 --> 02:43:05,880
so lessons for offensive teams

2623
02:43:05,880 --> 02:43:08,160
uh for all the fog and questions over

2624
02:43:08,160 --> 02:43:10,319
the I.T model Ukraine creativity and

2625
02:43:10,319 --> 02:43:12,300
Ingenuity can nonetheless have created a

2626
02:43:12,300 --> 02:43:13,620
model for their new kind of warfare

2627
02:43:13,620 --> 02:43:15,780
drones trackling troops movements with

2628
02:43:15,780 --> 02:43:18,300
purpose of spilled apps like EPO EPO is

2629
02:43:18,300 --> 02:43:20,700
an app for distracting drones in the air

2630
02:43:20,700 --> 02:43:23,040
telegram for talking troops there is

2631
02:43:23,040 --> 02:43:25,680
bellingcat uh Twitter feeds like elit

2632
02:43:25,680 --> 02:43:27,720
there's another one as well

2633
02:43:27,720 --> 02:43:29,460
brings a whole new meaning to a militia

2634
02:43:29,460 --> 02:43:31,319
not just democratizing cyber warfare but

2635
02:43:31,319 --> 02:43:33,660
it's democratizing War similar to

2636
02:43:33,660 --> 02:43:35,460
partisan activity in World War II but

2637
02:43:35,460 --> 02:43:37,560
with modern communication my tools

2638
02:43:37,560 --> 02:43:39,960
organizing can mobilize thousands it

2639
02:43:39,960 --> 02:43:41,280
would not be it would be interesting to

2640
02:43:41,280 --> 02:43:43,020
look at this issue in more depth with

2641
02:43:43,020 --> 02:43:45,120
further research

2642
02:43:45,120 --> 02:43:47,880
militaries and other organizations will

2643
02:43:47,880 --> 02:43:49,380
learn from the conflict and no doubt

2644
02:43:49,380 --> 02:43:52,200
shape the future of conflict

2645
02:43:52,200 --> 02:43:53,939
it has also provided example for

2646
02:43:53,939 --> 02:43:55,740
businesses and indeed countries how to

2647
02:43:55,740 --> 02:43:58,319
stand and keep running under constant

2648
02:43:58,319 --> 02:44:00,540
pressure in cyber attacks countries like

2649
02:44:00,540 --> 02:44:03,479
industry suffer from talents shortages

2650
02:44:03,479 --> 02:44:05,340
for companies in Orcs who could afford

2651
02:44:05,340 --> 02:44:07,620
specialized units like this U.S cyber

2652
02:44:07,620 --> 02:44:08,760
command the accredited model

2653
02:44:08,760 --> 02:44:11,000
demonstrates a way to develop a cyber

2654
02:44:11,000 --> 02:44:13,380
capability that can swiftly to be

2655
02:44:13,380 --> 02:44:14,520
deployed

2656
02:44:14,520 --> 02:44:16,439
having training pipeline is critical

2657
02:44:16,439 --> 02:44:18,720
preparedness

2658
02:44:18,720 --> 02:44:21,300
in the primary focus you might be able

2659
02:44:21,300 --> 02:44:23,700
to have highly trained team on hand

2660
02:44:23,700 --> 02:44:25,560
full-time

2661
02:44:25,560 --> 02:44:27,000
but you certainly can build a

2662
02:44:27,000 --> 02:44:28,260
partnership with industry and

2663
02:44:28,260 --> 02:44:30,180
governmental orgs to build a network of

2664
02:44:30,180 --> 02:44:32,460
tools and people to deploy when stuff

2665
02:44:32,460 --> 02:44:35,000
gets real

2666
02:44:36,080 --> 02:44:39,359
is definitely not the great approach but

2667
02:44:39,359 --> 02:44:42,120
after years of cyber at Tech preparation

2668
02:44:42,120 --> 02:44:44,220
this type of preparation is often in the

2669
02:44:44,220 --> 02:44:47,340
norm something happens we react it's in

2670
02:44:47,340 --> 02:44:49,319
every pre-planning for something that

2671
02:44:49,319 --> 02:44:51,479
might happen we'd let it happen and then

2672
02:44:51,479 --> 02:44:54,979
we figure out how to not happen again

2673
02:45:00,180 --> 02:45:03,800
it's a strategic planning

2674
02:45:04,740 --> 02:45:07,260
your team is tasked to infiltrate uh so

2675
02:45:07,260 --> 02:45:08,850
some takeaways

2676
02:45:08,850 --> 02:45:11,660
[Music]

2677
02:45:11,660 --> 02:45:14,220
so your team is tasked to infiltrate a

2678
02:45:14,220 --> 02:45:15,780
secure building now what what do you

2679
02:45:15,780 --> 02:45:18,600
know about the building access points

2680
02:45:18,600 --> 02:45:20,640
how about when the security goes to the

2681
02:45:20,640 --> 02:45:22,859
bathroom changes shifts for example do

2682
02:45:22,859 --> 02:45:24,540
we know what type of access systems they

2683
02:45:24,540 --> 02:45:26,280
have can we spoof the method of Entry

2684
02:45:26,280 --> 02:45:28,560
you need to know your enemy at Target no

2685
02:45:28,560 --> 02:45:30,300
matter if the if you're attacking a

2686
02:45:30,300 --> 02:45:33,000
country or a company Recon is important

2687
02:45:33,000 --> 02:45:35,700
and planning a stop severe attack

2688
02:45:35,700 --> 02:45:38,580
we use Frameworks for a reason run

2689
02:45:38,580 --> 02:45:41,340
through your plan I go back to uh I I

2690
02:45:41,340 --> 02:45:43,620
fight and wait I when we train for a

2691
02:45:43,620 --> 02:45:46,680
fight we train to fight in training so

2692
02:45:46,680 --> 02:45:48,420
you win the fight in training same thing

2693
02:45:48,420 --> 02:45:50,280
with this you prepare and prepare

2694
02:45:50,280 --> 02:45:51,420
prepare

2695
02:45:51,420 --> 02:45:53,040
you walk through what will happen at

2696
02:45:53,040 --> 02:45:55,979
each stage of that attack

2697
02:45:55,979 --> 02:45:58,020
this is this is starting to sound

2698
02:45:58,020 --> 02:45:59,939
familiar it's not by accident the

2699
02:45:59,939 --> 02:46:01,380
interesting thing even with knowing all

2700
02:46:01,380 --> 02:46:03,060
that we know teams and organizations

2701
02:46:03,060 --> 02:46:04,859
appear to get it wrong more times than

2702
02:46:04,859 --> 02:46:06,420
they get it right

2703
02:46:06,420 --> 02:46:08,399
if you're running an offensive team take

2704
02:46:08,399 --> 02:46:10,319
no practice war games and blue team red

2705
02:46:10,319 --> 02:46:12,120
team exercises should not be just the

2706
02:46:12,120 --> 02:46:13,680
purview of intelligence organizations

2707
02:46:13,680 --> 02:46:16,020
and Military

2708
02:46:16,020 --> 02:46:18,540
but I realize that that takes a lot of

2709
02:46:18,540 --> 02:46:20,580
money so you can do what we call in the

2710
02:46:20,580 --> 02:46:22,200
security World tabletop exercise a

2711
02:46:22,200 --> 02:46:24,479
whiteboard tests this kind of thing walk

2712
02:46:24,479 --> 02:46:26,580
through everything there's no reason why

2713
02:46:26,580 --> 02:46:28,080
an organization even with three people

2714
02:46:28,080 --> 02:46:30,660
can't walk through your attack steps and

2715
02:46:30,660 --> 02:46:32,160
figure out what your adversary will be

2716
02:46:32,160 --> 02:46:33,359
doing

2717
02:46:33,359 --> 02:46:34,680
I could tell you who your enemy

2718
02:46:34,680 --> 02:46:37,260
attackers would be power plants maybe a

2719
02:46:37,260 --> 02:46:40,200
Target by terrorist banks by criminals

2720
02:46:40,200 --> 02:46:41,520
it doesn't matter what organization

2721
02:46:41,520 --> 02:46:43,859
you're a part of you are going to be in

2722
02:46:43,859 --> 02:46:46,080
a talk at some point

2723
02:46:46,080 --> 02:46:48,720
even an Insider discover ex-boy for

2724
02:46:48,720 --> 02:46:50,580
example it could take time and effort

2725
02:46:50,580 --> 02:46:53,399
and take time and effort to step back

2726
02:46:53,399 --> 02:46:55,620
and be in a system like an outsider or

2727
02:46:55,620 --> 02:46:58,140
even an Insider who attends to harm one

2728
02:46:58,140 --> 02:46:59,580
of the values of the tabletop exercise

2729
02:46:59,580 --> 02:47:02,399
to let players consider the system as a

2730
02:47:02,399 --> 02:47:04,580
whole

2731
02:47:06,600 --> 02:47:09,060
organization without the idea who is

2732
02:47:09,060 --> 02:47:10,500
doing what

2733
02:47:10,500 --> 02:47:12,899
the flow and tasking of your efforts

2734
02:47:12,899 --> 02:47:14,880
will be haphazard at best so we have a

2735
02:47:14,880 --> 02:47:17,580
CTF going on this weekend even though

2736
02:47:17,580 --> 02:47:19,260
eight eight people team

2737
02:47:19,260 --> 02:47:21,359
if nobody knows what each other's doing

2738
02:47:21,359 --> 02:47:23,040
or how they're doing it or what you're

2739
02:47:23,040 --> 02:47:24,240
doing

2740
02:47:24,240 --> 02:47:26,700
you're not going to get anywhere

2741
02:47:26,700 --> 02:47:29,460
this goes to uh

2742
02:47:29,460 --> 02:47:31,979
we'll get to communication

2743
02:47:31,979 --> 02:47:34,140
so yeah so when you're building teams in

2744
02:47:34,140 --> 02:47:35,880
your organization has to be there if you

2745
02:47:35,880 --> 02:47:37,260
can't coordinate you don't know what

2746
02:47:37,260 --> 02:47:38,819
each other's doing it's going to fall

2747
02:47:38,819 --> 02:47:40,560
apart pretty quickly talent management

2748
02:47:40,560 --> 02:47:42,660
may not seem relevant but if you utilize

2749
02:47:42,660 --> 02:47:44,399
your people properly no amount of team

2750
02:47:44,399 --> 02:47:47,460
members will get the tasks done right we

2751
02:47:47,460 --> 02:47:49,140
you can have a thousand people but if I

2752
02:47:49,140 --> 02:47:50,819
was just sitting around dust bunnies

2753
02:47:50,819 --> 02:47:53,640
collecting dust bunnies

2754
02:47:53,640 --> 02:47:55,680
it's not going to matter

2755
02:47:55,680 --> 02:47:58,020
I have seen Team Dynamics and lack of

2756
02:47:58,020 --> 02:47:59,760
organizations take down the smallest of

2757
02:47:59,760 --> 02:48:01,380
teens because people are not sure what

2758
02:48:01,380 --> 02:48:02,220
to do

2759
02:48:02,220 --> 02:48:04,620
and leaders don't delegate

2760
02:48:04,620 --> 02:48:06,120
figure out what your people are great at

2761
02:48:06,120 --> 02:48:07,859
and divvy up tasks

2762
02:48:07,859 --> 02:48:09,600
keep the chain of command in the event

2763
02:48:09,600 --> 02:48:11,280
situation this doesn't have to be your

2764
02:48:11,280 --> 02:48:12,540
chain and command at your normal

2765
02:48:12,540 --> 02:48:14,819
workplace but has some structure in

2766
02:48:14,819 --> 02:48:18,899
place at the event or at your assessment

2767
02:48:18,899 --> 02:48:20,700
but don't forget to listen to your

2768
02:48:20,700 --> 02:48:22,500
experts right now everyone's a security

2769
02:48:22,500 --> 02:48:24,300
Hue topic you can't specialize in

2770
02:48:24,300 --> 02:48:25,800
everything

2771
02:48:25,800 --> 02:48:27,240
figure out what your people are good at

2772
02:48:27,240 --> 02:48:28,979
to be up tasks keep to the chain of

2773
02:48:28,979 --> 02:48:31,279
command

2774
02:48:31,500 --> 02:48:34,140
this leads to communication how do we

2775
02:48:34,140 --> 02:48:37,039
pass up and down information

2776
02:48:38,100 --> 02:48:40,439
and this of course leads into the topic

2777
02:48:40,439 --> 02:48:43,220
of opsec

2778
02:48:45,899 --> 02:48:49,380
so when we talk about opsec

2779
02:48:49,380 --> 02:48:50,939
there's a well-known story I don't know

2780
02:48:50,939 --> 02:48:52,740
if you're a fan of cryptography but when

2781
02:48:52,740 --> 02:48:54,660
they broke the Enigma they couldn't

2782
02:48:54,660 --> 02:48:56,460
actually use the Enigma to the extent

2783
02:48:56,460 --> 02:48:59,100
that everybody wanted because what

2784
02:48:59,100 --> 02:49:00,600
happens when everyone knows what you

2785
02:49:00,600 --> 02:49:01,560
know

2786
02:49:01,560 --> 02:49:06,019
people stop using that tool right so

2787
02:49:06,060 --> 02:49:07,680
um it's this is sort of the same thing

2788
02:49:07,680 --> 02:49:10,020
with cyber you gotta you gotta plan if

2789
02:49:10,020 --> 02:49:11,700
you have these attacks and you know you

2790
02:49:11,700 --> 02:49:13,680
have these attacks let's say you have a

2791
02:49:13,680 --> 02:49:16,140
zero day which I hope nobody has and not

2792
02:49:16,140 --> 02:49:18,240
keeping it to themselves but if you do

2793
02:49:18,240 --> 02:49:20,300
you would want to use it at once because

2794
02:49:20,300 --> 02:49:22,859
then that whole idea of having that

2795
02:49:22,859 --> 02:49:25,020
people know you have it it's gone that

2796
02:49:25,020 --> 02:49:28,160
that Advantage is gone

2797
02:49:29,040 --> 02:49:32,460
so this the opsec applies to both cyber

2798
02:49:32,460 --> 02:49:33,720
exercises as well as security

2799
02:49:33,720 --> 02:49:36,000
assessments

2800
02:49:36,000 --> 02:49:38,939
and um

2801
02:49:38,939 --> 02:49:40,200
so yeah

2802
02:49:40,200 --> 02:49:42,359
so one of the other things that when we

2803
02:49:42,359 --> 02:49:44,100
get into talking about when to use these

2804
02:49:44,100 --> 02:49:46,740
attacks is this idea of probability and

2805
02:49:46,740 --> 02:49:48,899
what's called strategic Randomness so

2806
02:49:48,899 --> 02:49:50,760
again you've got to use it

2807
02:49:50,760 --> 02:49:51,899
if you're going to attack somebody

2808
02:49:51,899 --> 02:49:53,760
you've got to make it so it's plausibly

2809
02:49:53,760 --> 02:49:57,780
that it's not yourself doing the attack

2810
02:49:57,780 --> 02:49:59,399
um

2811
02:49:59,399 --> 02:50:02,000
so

2812
02:50:03,120 --> 02:50:05,220
I lead on this side for so when it comes

2813
02:50:05,220 --> 02:50:07,020
to Russia and I lean on the side why

2814
02:50:07,020 --> 02:50:08,819
they haven't done so well as they have

2815
02:50:08,819 --> 02:50:10,260
is I lean on the side of tactical

2816
02:50:10,260 --> 02:50:12,300
coordination or Russia's military and

2817
02:50:12,300 --> 02:50:13,740
intelligence organizations not

2818
02:50:13,740 --> 02:50:15,600
coordinating as we know large

2819
02:50:15,600 --> 02:50:17,280
organizations all have to get in the way

2820
02:50:17,280 --> 02:50:20,460
and are paralyzed by bureaucracy this uh

2821
02:50:20,460 --> 02:50:22,260
one of the advantages I think Ukraine

2822
02:50:22,260 --> 02:50:25,260
had is this sort of ad hoc ragtag team

2823
02:50:25,260 --> 02:50:28,680
sorry that ground fighting attitude

2824
02:50:28,680 --> 02:50:30,300
and because they don't have this big

2825
02:50:30,300 --> 02:50:32,520
organization apparently before the the

2826
02:50:32,520 --> 02:50:34,020
all these attacks happen they didn't

2827
02:50:34,020 --> 02:50:37,380
really have any cyber capacity within

2828
02:50:37,380 --> 02:50:40,460
their organizations already

2829
02:50:41,939 --> 02:50:43,740
and as we all know large organ Nations

2830
02:50:43,740 --> 02:50:45,720
get in the way and are paralyzed by

2831
02:50:45,720 --> 02:50:47,399
bureaucracy

2832
02:50:47,399 --> 02:50:49,460
um

2833
02:50:49,500 --> 02:50:50,939
so you might not you might be in a

2834
02:50:50,939 --> 02:50:52,319
situation where you might not know in

2835
02:50:52,319 --> 02:50:54,780
terms of another aspect we need to talk

2836
02:50:54,780 --> 02:50:56,700
about is tooling so you might be in a

2837
02:50:56,700 --> 02:50:57,720
position where you don't know what

2838
02:50:57,720 --> 02:51:00,180
you're using in a event this happens

2839
02:51:00,180 --> 02:51:02,399
quite often you go to event you don't

2840
02:51:02,399 --> 02:51:04,500
know what you're doing but you'll have a

2841
02:51:04,500 --> 02:51:05,819
set of tooling and this is very

2842
02:51:05,819 --> 02:51:07,260
important to set up your tooling before

2843
02:51:07,260 --> 02:51:09,840
you go a lot of organizations if you

2844
02:51:09,840 --> 02:51:11,340
work in a bigger organization you might

2845
02:51:11,340 --> 02:51:13,260
not have a choice of tools so if you go

2846
02:51:13,260 --> 02:51:15,240
into an assessment you might be stuck on

2847
02:51:15,240 --> 02:51:16,560
something because

2848
02:51:16,560 --> 02:51:18,600
that's proprietary that's what you use

2849
02:51:18,600 --> 02:51:20,580
so stick to it it's unfortunate but it

2850
02:51:20,580 --> 02:51:22,500
happens I don't think it should happen

2851
02:51:22,500 --> 02:51:25,080
because you should use tools to match

2852
02:51:25,080 --> 02:51:27,240
your tasks

2853
02:51:27,240 --> 02:51:29,580
as always it's like this famous question

2854
02:51:29,580 --> 02:51:31,380
of the programming languages what's the

2855
02:51:31,380 --> 02:51:33,899
best programming language come on what's

2856
02:51:33,899 --> 02:51:36,060
best programming language right it's

2857
02:51:36,060 --> 02:51:38,700
python right who uses python right yeah

2858
02:51:38,700 --> 02:51:41,340
okay I don't think so I'd like C so

2859
02:51:41,340 --> 02:51:42,720
there you go

2860
02:51:42,720 --> 02:51:44,520
um

2861
02:51:44,520 --> 02:51:46,280
so you know this pain

2862
02:51:46,280 --> 02:51:49,319
I I could make a whole talk out of the

2863
02:51:49,319 --> 02:51:51,720
scope of the session adaptably and

2864
02:51:51,720 --> 02:51:54,120
tooling is something to address

2865
02:51:54,120 --> 02:51:56,520
so yeah don't let your tools dictate

2866
02:51:56,520 --> 02:51:57,840
what you do

2867
02:51:57,840 --> 02:52:00,720
let what you do dictate your tooling

2868
02:52:00,720 --> 02:52:02,399
before moving on I would like to address

2869
02:52:02,399 --> 02:52:04,560
the human element but fill with building

2870
02:52:04,560 --> 02:52:07,319
effective teams is a huge topic but does

2871
02:52:07,319 --> 02:52:09,600
need to address briefly here we must

2872
02:52:09,600 --> 02:52:11,819
build teams that are mixed and in every

2873
02:52:11,819 --> 02:52:14,520
way both in skills and makeup to think

2874
02:52:14,520 --> 02:52:16,260
like the attacker and to find ways to

2875
02:52:16,260 --> 02:52:18,359
attack and Achieve our objectives as

2876
02:52:18,359 --> 02:52:21,000
offensive folks you need to you need

2877
02:52:21,000 --> 02:52:22,319
team members that have different skill

2878
02:52:22,319 --> 02:52:24,240
sets and viewpoints to complement the

2879
02:52:24,240 --> 02:52:27,979
team obviously the team

2880
02:52:30,080 --> 02:52:33,740
obviously the team

2881
02:52:34,439 --> 02:52:36,300
obviously you can't have everybody who's

2882
02:52:36,300 --> 02:52:37,560
good at one thing so if you have

2883
02:52:37,560 --> 02:52:39,359
somebody who's really good at malware

2884
02:52:39,359 --> 02:52:41,939
ready malware you what's the point I

2885
02:52:41,939 --> 02:52:43,500
have a really good malware person if you

2886
02:52:43,500 --> 02:52:45,060
can't have somebody who knows how to get

2887
02:52:45,060 --> 02:52:47,100
somebody to click on that link right it

2888
02:52:47,100 --> 02:52:50,540
doesn't it's not effective anymore

2889
02:52:51,720 --> 02:52:54,300
all right so unfortunately I think my

2890
02:52:54,300 --> 02:52:55,740
time's coming

2891
02:52:55,740 --> 02:52:57,479
to a quick end

2892
02:52:57,479 --> 02:52:59,520
Maybe

2893
02:52:59,520 --> 02:53:00,920
um

2894
02:53:00,920 --> 02:53:04,319
so I have a few final points just to go

2895
02:53:04,319 --> 02:53:07,200
over uh never enter underestimate your

2896
02:53:07,200 --> 02:53:08,760
adversary

2897
02:53:08,760 --> 02:53:11,100
it is a massive mistake Russia's made

2898
02:53:11,100 --> 02:53:14,100
and organizations continually make

2899
02:53:14,100 --> 02:53:16,260
plan for the worst hope for the best

2900
02:53:16,260 --> 02:53:17,880
over plan

2901
02:53:17,880 --> 02:53:20,040
your worst case scenario if Defenders if

2902
02:53:20,040 --> 02:53:22,319
on the offensive side run through your

2903
02:53:22,319 --> 02:53:25,260
workflow for your attack well cyber and

2904
02:53:25,260 --> 02:53:27,960
nine cyber aspects the Ukrainian

2905
02:53:27,960 --> 02:53:29,700
conflict will leave a lasting impact on

2906
02:53:29,700 --> 02:53:32,100
Cyber world the lessons learned

2907
02:53:32,100 --> 02:53:34,319
will all will be important going forward

2908
02:53:34,319 --> 02:53:35,880
and

2909
02:53:35,880 --> 02:53:37,740
not only at the nation state level but

2910
02:53:37,740 --> 02:53:40,880
also for individual ngos and companies

2911
02:53:40,880 --> 02:53:44,580
and that's all I have for Planned

2912
02:53:44,580 --> 02:53:45,660
content

2913
02:53:45,660 --> 02:53:47,640
so I think I have some time for

2914
02:53:47,640 --> 02:53:50,000
questions

2915
02:53:53,160 --> 02:53:57,140
so we do have

2916
02:53:57,359 --> 02:54:00,420
we have time for questions so

2917
02:54:00,420 --> 02:54:02,100
um feel free to use the QR code that may

2918
02:54:02,100 --> 02:54:03,779
or may not be appearing

2919
02:54:03,779 --> 02:54:07,080
somewhere such as on the stage and

2920
02:54:07,080 --> 02:54:09,300
um I'm happy to read some questions out

2921
02:54:09,300 --> 02:54:12,120
or since we don't have any yet uh if

2922
02:54:12,120 --> 02:54:13,500
anyone wants to jump in and say

2923
02:54:13,500 --> 02:54:14,580
something

2924
02:54:14,580 --> 02:54:16,740
you

2925
02:54:16,740 --> 02:54:19,020
you can do so and I will translate for

2926
02:54:19,020 --> 02:54:21,500
the Stream

2927
02:54:28,560 --> 02:54:31,220
s

2928
02:54:33,300 --> 02:54:36,300
thank you thanks so much

2929
02:54:36,300 --> 02:54:38,160
please come talk to Sarah afterwards if

2930
02:54:38,160 --> 02:54:39,840
you were too shy to ask in front of

2931
02:54:39,840 --> 02:54:41,960
everyone

2932
02:54:47,520 --> 02:54:50,460
we're gonna take about a 10 minute break

2933
02:54:50,460 --> 02:54:53,479
and then we'll be back

2934
02:54:54,779 --> 02:54:56,899
thank you

2935
02:55:29,760 --> 02:55:32,829
[Music]

2936
02:56:22,500 --> 02:56:24,680
foreign

2937
02:57:11,590 --> 02:57:14,760
[Music]

2938
02:57:35,580 --> 02:57:38,539
thank you

2939
02:58:43,140 --> 02:58:45,680
oh

2940
03:00:04,979 --> 03:00:07,979
foreign

2941
03:01:14,899 --> 03:01:18,199
come on there

2942
03:02:31,680 --> 03:02:34,340
now

2943
03:03:54,540 --> 03:03:57,500
foreign

2944
03:05:03,899 --> 03:05:06,899
foreign

2945
03:05:49,680 --> 03:05:53,220
all right okay and we're back

2946
03:05:53,220 --> 03:05:55,620
um welcome everyone so I'm super excited

2947
03:05:55,620 --> 03:05:58,080
to have sushaka Sharma on the stage uh

2948
03:05:58,080 --> 03:05:59,819
he is a repeat speaker he's been here

2949
03:05:59,819 --> 03:06:02,160
before we know him well he's the chief

2950
03:06:02,160 --> 03:06:03,899
scientist at bravado where he helps

2951
03:06:03,899 --> 03:06:05,580
build code analysis tools for data

2952
03:06:05,580 --> 03:06:07,859
privacy and data security he completed

2953
03:06:07,859 --> 03:06:09,779
his PhD in computer engineering from

2954
03:06:09,779 --> 03:06:12,420
Polytechnic where he worked on ebpf

2955
03:06:12,420 --> 03:06:14,460
technology and Hardware assisted tracing

2956
03:06:14,460 --> 03:06:16,979
techniques for OS analysis for the last

2957
03:06:16,979 --> 03:06:18,720
six years sushakra has been working on

2958
03:06:18,720 --> 03:06:20,640
enhancing static analysis tooling for

2959
03:06:20,640 --> 03:06:22,800
fixing security bugs at scale and he is

2960
03:06:22,800 --> 03:06:24,479
also quite a prolific conference speaker

2961
03:06:24,479 --> 03:06:27,899
including norseck thank you so much

2962
03:06:27,899 --> 03:06:30,060
hey everyone

2963
03:06:30,060 --> 03:06:31,319
so

2964
03:06:31,319 --> 03:06:34,859
um thanks a lot uh for for this very

2965
03:06:34,859 --> 03:06:36,899
lofty introduction

2966
03:06:36,899 --> 03:06:39,060
um you know but it's just me and my

2967
03:06:39,060 --> 03:06:42,000
humble mustache which is here

2968
03:06:42,000 --> 03:06:43,140
so

2969
03:06:43,140 --> 03:06:45,840
um uh I welcome you to this talk

2970
03:06:45,840 --> 03:06:49,380
um we're gonna discuss a lot of Concepts

2971
03:06:49,380 --> 03:06:51,300
which have not been discussed in privacy

2972
03:06:51,300 --> 03:06:53,819
before and I guess it would be one of

2973
03:06:53,819 --> 03:06:55,500
the first times we are gonna do a deep

2974
03:06:55,500 --> 03:06:59,580
dive into it and uh just let's uh get

2975
03:06:59,580 --> 03:07:01,020
into it then

2976
03:07:01,020 --> 03:07:03,720
so I'm this guy uh you know about this

2977
03:07:03,720 --> 03:07:06,359
so no need to read this uh privacy in

2978
03:07:06,359 --> 03:07:09,240
modern times is uh actually something

2979
03:07:09,240 --> 03:07:13,200
like this you know uh you click yes I

2980
03:07:13,200 --> 03:07:15,240
agree and you sign of your soul or you

2981
03:07:15,240 --> 03:07:17,460
burn your money and go to the Himalayas

2982
03:07:17,460 --> 03:07:19,800
so I mean there's no choice in between

2983
03:07:19,800 --> 03:07:21,420
at this time

2984
03:07:21,420 --> 03:07:24,960
so um and why why do people feel like

2985
03:07:24,960 --> 03:07:28,020
this is because uh they see a few things

2986
03:07:28,020 --> 03:07:30,000
they see the mistakes every day you know

2987
03:07:30,000 --> 03:07:32,640
they see news items like this uh you

2988
03:07:32,640 --> 03:07:35,100
know Twitter advising all 330 million

2989
03:07:35,100 --> 03:07:38,399
users to change their passwords uh uh

2990
03:07:38,399 --> 03:07:40,620
gas state agency in India you know leaks

2991
03:07:40,620 --> 03:07:42,779
millions of aadhar numbers other is like

2992
03:07:42,779 --> 03:07:45,300
uh SIN number here so so it's like that

2993
03:07:45,300 --> 03:07:47,580
so and all of these things when you go

2994
03:07:47,580 --> 03:07:49,740
to the root of it is very basic you know

2995
03:07:49,740 --> 03:07:51,720
for Twitter it was actually plain text

2996
03:07:51,720 --> 03:07:54,060
passwords and logs and something as

2997
03:07:54,060 --> 03:07:56,640
simple as that and for this it was an

2998
03:07:56,640 --> 03:07:58,620
unauthenticated endpoint which was

2999
03:07:58,620 --> 03:08:01,020
leaking Pia you could just go and you

3000
03:08:01,020 --> 03:08:04,020
know do the increment ID thing and you

3001
03:08:04,020 --> 03:08:06,180
suddenly get all the information

3002
03:08:06,180 --> 03:08:09,180
so the other reason is that people know

3003
03:08:09,180 --> 03:08:11,220
about this also now you know they they

3004
03:08:11,220 --> 03:08:13,080
did not used to know this this dark

3005
03:08:13,080 --> 03:08:14,880
cloud in between but now they know that

3006
03:08:14,880 --> 03:08:17,160
they're data brokers who are you know

3007
03:08:17,160 --> 03:08:19,560
you trust a few of the services you put

3008
03:08:19,560 --> 03:08:21,840
all your data there some Services you

3009
03:08:21,840 --> 03:08:23,520
are you don't know you should trust or

3010
03:08:23,520 --> 03:08:26,160
not but I guess you know maybe just give

3011
03:08:26,160 --> 03:08:28,620
some info to them and then you know it

3012
03:08:28,620 --> 03:08:32,100
goes on gets into this dark area and

3013
03:08:32,100 --> 03:08:33,899
then everything gets collected and

3014
03:08:33,899 --> 03:08:35,880
suddenly there is there is the service

3015
03:08:35,880 --> 03:08:38,220
which has everything about you you know

3016
03:08:38,220 --> 03:08:41,460
you never even expected this random ABC

3017
03:08:41,460 --> 03:08:43,380
numbered Corporation having all this

3018
03:08:43,380 --> 03:08:44,939
information about you because but they

3019
03:08:44,939 --> 03:08:47,160
have it and and people know about this

3020
03:08:47,160 --> 03:08:49,680
now so so there were it they are

3021
03:08:49,680 --> 03:08:52,200
genuinely worried

3022
03:08:52,200 --> 03:08:54,300
um it's very difficult to solve you know

3023
03:08:54,300 --> 03:08:57,300
these these problems because there are

3024
03:08:57,300 --> 03:08:59,399
economic incentives around them because

3025
03:08:59,399 --> 03:09:01,200
like you know for some businesses they

3026
03:09:01,200 --> 03:09:02,760
are only going to run if they you know

3027
03:09:02,760 --> 03:09:04,800
take in your data

3028
03:09:04,800 --> 03:09:07,080
but some legitimate businesses they have

3029
03:09:07,080 --> 03:09:09,180
to actually solve this stuff so the

3030
03:09:09,180 --> 03:09:11,520
theater of security and privacy looks

3031
03:09:11,520 --> 03:09:13,859
like this right now and and I'll start

3032
03:09:13,859 --> 03:09:16,319
from the perspective of privacy we'll

3033
03:09:16,319 --> 03:09:19,200
see the csos mind you know it it's kind

3034
03:09:19,200 --> 03:09:20,939
of like this it's not blank we are going

3035
03:09:20,939 --> 03:09:22,800
to fill this

3036
03:09:22,800 --> 03:09:25,800
so uh I think the first thing is is like

3037
03:09:25,800 --> 03:09:29,220
this RSA log 4G Big Ticket items they

3038
03:09:29,220 --> 03:09:30,779
really are worried about all of that

3039
03:09:30,779 --> 03:09:34,140
stuff but then you know behind there is

3040
03:09:34,140 --> 03:09:35,760
something else also in the back of the

3041
03:09:35,760 --> 03:09:38,220
mind you know there it's important for

3042
03:09:38,220 --> 03:09:40,560
them to understand what's going on

3043
03:09:40,560 --> 03:09:42,960
so we'll zoom into it and then we see

3044
03:09:42,960 --> 03:09:45,120
that there they know about some bugs you

3045
03:09:45,120 --> 03:09:46,680
know which are gonna own them somebody

3046
03:09:46,680 --> 03:09:48,420
must have mentioned them in some board

3047
03:09:48,420 --> 03:09:51,120
meeting you know a guy walking past uh

3048
03:09:51,120 --> 03:09:52,620
so they're worried about them also it's

3049
03:09:52,620 --> 03:09:54,359
not like they're not worried about it

3050
03:09:54,359 --> 03:09:56,399
and at the same time

3051
03:09:56,399 --> 03:09:58,439
there's another human you know they know

3052
03:09:58,439 --> 03:10:01,200
about and this human is that sharply

3053
03:10:01,200 --> 03:10:02,939
dressed colleague which they have and

3054
03:10:02,939 --> 03:10:05,640
and they have like the cippee ETC on

3055
03:10:05,640 --> 03:10:08,100
LinkedIn okay this person is the privacy

3056
03:10:08,100 --> 03:10:10,020
officer the Chief privacy officer so we

3057
03:10:10,020 --> 03:10:11,760
we started looking at their mind also

3058
03:10:11,760 --> 03:10:14,580
now okay and and the Chief privacy

3059
03:10:14,580 --> 03:10:16,979
officer is worried about gdpr you know

3060
03:10:16,979 --> 03:10:18,840
you talk to Chief privacy officers okay

3061
03:10:18,840 --> 03:10:22,200
gdpr is is my stuff GDP compliant or not

3062
03:10:22,200 --> 03:10:24,660
are like CCPA you know and then they

3063
03:10:24,660 --> 03:10:26,939
also worry about some conferences like

3064
03:10:26,939 --> 03:10:29,340
iappp organizations like that and then

3065
03:10:29,340 --> 03:10:31,620
compliance these are you know is the

3066
03:10:31,620 --> 03:10:33,359
data fine they're worried about that and

3067
03:10:33,359 --> 03:10:35,160
then there's this nagging question that

3068
03:10:35,160 --> 03:10:37,500
they always have so in Paradigm of a

3069
03:10:37,500 --> 03:10:39,479
privacy policy we say that we don't

3070
03:10:39,479 --> 03:10:41,760
collect precise location but on the

3071
03:10:41,760 --> 03:10:44,340
random Channel I saw this map of our

3072
03:10:44,340 --> 03:10:47,220
customers doing SBB Bank runs okay and

3073
03:10:47,220 --> 03:10:49,500
people were joking about it so how did

3074
03:10:49,500 --> 03:10:51,600
this information go there so I I think

3075
03:10:51,600 --> 03:10:53,760
they are worried about stuff you know

3076
03:10:53,760 --> 03:10:55,680
it's but but they just don't know

3077
03:10:55,680 --> 03:10:58,800
exactly how to tackle it uh but there

3078
03:10:58,800 --> 03:11:01,560
are reasons for it and and during my

3079
03:11:01,560 --> 03:11:03,840
movement from security and privacy and

3080
03:11:03,840 --> 03:11:06,000
security all together throughout these

3081
03:11:06,000 --> 03:11:06,899
years

3082
03:11:06,899 --> 03:11:08,760
I have realized that privacy operations

3083
03:11:08,760 --> 03:11:11,040
work like this there are three buckets

3084
03:11:11,040 --> 03:11:14,340
of people who touch privacy essentially

3085
03:11:14,340 --> 03:11:16,020
so I think the first is the lawyers on

3086
03:11:16,020 --> 03:11:18,600
the side uh they they they do high level

3087
03:11:18,600 --> 03:11:21,660
gdpr type mandates uh very important uh

3088
03:11:21,660 --> 03:11:23,220
they're more reactive so they look at

3089
03:11:23,220 --> 03:11:25,560
privacy events very carefully on on what

3090
03:11:25,560 --> 03:11:27,600
has happened what is going to happen and

3091
03:11:27,600 --> 03:11:29,340
they have a very compliance kind of

3092
03:11:29,340 --> 03:11:30,960
mindset are we compliant with this law

3093
03:11:30,960 --> 03:11:32,700
is it is it fine or not this is very

3094
03:11:32,700 --> 03:11:34,800
important for large organization to run

3095
03:11:34,800 --> 03:11:37,859
efficiently not get into trouble uh and

3096
03:11:37,859 --> 03:11:40,680
then they also rely very deeply with uh

3097
03:11:40,680 --> 03:11:43,979
security data or privacy operations uh

3098
03:11:43,979 --> 03:11:46,140
which actually own in putting those laws

3099
03:11:46,140 --> 03:11:48,120
in action they try to implement what is

3100
03:11:48,120 --> 03:11:50,460
going on uh you know they're tracking

3101
03:11:50,460 --> 03:11:52,439
all the changes flows to all the data

3102
03:11:52,439 --> 03:11:55,200
inside the org run privacy assessments

3103
03:11:55,200 --> 03:11:57,660
data subject access requests these are

3104
03:11:57,660 --> 03:11:58,979
these are all these terms you're going

3105
03:11:58,979 --> 03:12:01,520
to hear in privacy they come from a very

3106
03:12:01,520 --> 03:12:04,380
safety kind of mindset we we have a

3107
03:12:04,380 --> 03:12:06,779
responsibility to save Safeguard the

3108
03:12:06,779 --> 03:12:08,760
data that is coming in and then on the

3109
03:12:08,760 --> 03:12:11,520
other side are developers they are very

3110
03:12:11,520 --> 03:12:14,279
decoupled from from other orgs as I have

3111
03:12:14,279 --> 03:12:16,620
observed they are actually these are the

3112
03:12:16,620 --> 03:12:18,060
people who will actually solve a problem

3113
03:12:18,060 --> 03:12:20,520
so so if if some change has to be done

3114
03:12:20,520 --> 03:12:23,160
in the code to keep the app safe uh to

3115
03:12:23,160 --> 03:12:24,779
implement privacy respecting features

3116
03:12:24,779 --> 03:12:27,779
and it it goes to them so so really the

3117
03:12:27,779 --> 03:12:30,060
problem the solution of the problem is

3118
03:12:30,060 --> 03:12:31,740
there okay and and then a lot of people

3119
03:12:31,740 --> 03:12:34,920
are revolving around these buckets uh

3120
03:12:34,920 --> 03:12:37,080
Gathering or or not having the

3121
03:12:37,080 --> 03:12:40,500
developers you know get into the I would

3122
03:12:40,500 --> 03:12:43,800
say say the same table I would say

3123
03:12:43,800 --> 03:12:45,660
so uh there are common grounds in

3124
03:12:45,660 --> 03:12:48,300
security and privacy uh you know I tried

3125
03:12:48,300 --> 03:12:50,160
to put them in this nice Venn diagram

3126
03:12:50,160 --> 03:12:52,640
because Venn diagrams always look cool

3127
03:12:52,640 --> 03:12:55,800
so uh security folks you know you can

3128
03:12:55,800 --> 03:12:57,960
see they care about injection or bypass

3129
03:12:57,960 --> 03:13:01,020
Network stuff some CV CWS you know they

3130
03:13:01,020 --> 03:13:03,660
care about you know that path reversal I

3131
03:13:03,660 --> 03:13:05,760
guess and then uh they also care about

3132
03:13:05,760 --> 03:13:07,080
some other stuff like they care about

3133
03:13:07,080 --> 03:13:09,479
data security and sensitive data leaks

3134
03:13:09,479 --> 03:13:12,120
there's a huge whole section about that

3135
03:13:12,120 --> 03:13:15,120
you know like CW 200 they care about

3136
03:13:15,120 --> 03:13:16,979
information leaks it's not like they

3137
03:13:16,979 --> 03:13:19,020
don't care about it but they look at

3138
03:13:19,020 --> 03:13:21,600
this from their angle as if it's one of

3139
03:13:21,600 --> 03:13:23,399
the points inside the thing that we have

3140
03:13:23,399 --> 03:13:26,220
to fix and and we are done uh the other

3141
03:13:26,220 --> 03:13:28,500
folks privacy folks care about a lot of

3142
03:13:28,500 --> 03:13:29,819
other things that these folks don't know

3143
03:13:29,819 --> 03:13:32,939
about at all like these are dpia privacy

3144
03:13:32,939 --> 03:13:35,880
impact assessments you know so their

3145
03:13:35,880 --> 03:13:38,279
privacy impact assessments are run on

3146
03:13:38,279 --> 03:13:40,020
spreadsheets right now in a lot of

3147
03:13:40,020 --> 03:13:41,819
organizations I've talked to a lot of

3148
03:13:41,819 --> 03:13:44,420
organizations to folks working in

3149
03:13:44,420 --> 03:13:47,880
forsake they would think how can you run

3150
03:13:47,880 --> 03:13:49,800
a whole thing like this you know like a

3151
03:13:49,800 --> 03:13:52,920
provable thing where sensitive data uh

3152
03:13:52,920 --> 03:13:54,660
like are you recording precise location

3153
03:13:54,660 --> 03:13:57,000
it takes like two to three months for

3154
03:13:57,000 --> 03:13:58,439
them to get this information from

3155
03:13:58,439 --> 03:14:00,899
Engineers it's it's it's weird but this

3156
03:14:00,899 --> 03:14:02,399
is really what happens so they care

3157
03:14:02,399 --> 03:14:04,020
about this and there is a common ground

3158
03:14:04,020 --> 03:14:06,420
that is there uh the goal is that we

3159
03:14:06,420 --> 03:14:09,180
need to understand that Common Ground so

3160
03:14:09,180 --> 03:14:11,700
right now the pull is is too much on the

3161
03:14:11,700 --> 03:14:13,380
other sides but you know eventually we

3162
03:14:13,380 --> 03:14:15,000
are going to fix this

3163
03:14:15,000 --> 03:14:17,819
so the conundrum is like this there's a

3164
03:14:17,819 --> 03:14:20,880
lot of code it produces a lot of data

3165
03:14:20,880 --> 03:14:22,920
you know so the data that is coming in

3166
03:14:22,920 --> 03:14:24,720
all these databases going from one place

3167
03:14:24,720 --> 03:14:26,460
to another place going in the log you

3168
03:14:26,460 --> 03:14:28,020
know getting leaked somewhere it's

3169
03:14:28,020 --> 03:14:30,060
coming from code code is responsible for

3170
03:14:30,060 --> 03:14:32,580
that and privacy operation is like

3171
03:14:32,580 --> 03:14:34,680
someone with a broom trying to you know

3172
03:14:34,680 --> 03:14:37,620
brush this water spilling on on on on

3173
03:14:37,620 --> 03:14:39,899
the surface you know it's it's not going

3174
03:14:39,899 --> 03:14:42,779
to work they try their best and going a

3175
03:14:42,779 --> 03:14:44,819
little bit deep this is kind of like an

3176
03:14:44,819 --> 03:14:47,939
example of an actual code where you can

3177
03:14:47,939 --> 03:14:50,580
see that uh there's username you know

3178
03:14:50,580 --> 03:14:52,560
it's it's something that is coming from

3179
03:14:52,560 --> 03:14:54,779
the user and eventually if you look at

3180
03:14:54,779 --> 03:14:56,399
the code you will see that it gets

3181
03:14:56,399 --> 03:14:59,460
logged uh you know in a log and in

3182
03:14:59,460 --> 03:15:00,779
reality what's going to happen because

3183
03:15:00,779 --> 03:15:03,479
I've seen some operations inside is they

3184
03:15:03,479 --> 03:15:06,240
go to some 10 databases here and there

3185
03:15:06,240 --> 03:15:08,520
one other log service you know running

3186
03:15:08,520 --> 03:15:11,460
somewhere else and then some innocent

3187
03:15:11,460 --> 03:15:13,439
human you know who never even cared

3188
03:15:13,439 --> 03:15:15,899
about it they have access to it and they

3189
03:15:15,899 --> 03:15:17,580
just don't tell anybody you know because

3190
03:15:17,580 --> 03:15:19,859
they don't care about it but uh

3191
03:15:19,859 --> 03:15:21,779
technically it is bad because because

3192
03:15:21,779 --> 03:15:24,060
that's data that gets leaked and it's in

3193
03:15:24,060 --> 03:15:25,500
front of someone who should not have it

3194
03:15:25,500 --> 03:15:27,240
so privacy operations are going to look

3195
03:15:27,240 --> 03:15:29,100
at many places and trying to understand

3196
03:15:29,100 --> 03:15:31,680
this they will look at databases trying

3197
03:15:31,680 --> 03:15:33,720
to remove stuff from databases if they

3198
03:15:33,720 --> 03:15:36,359
find private information there

3199
03:15:36,359 --> 03:15:38,520
but the reality is that the developer

3200
03:15:38,520 --> 03:15:41,040
really knows where this data is how we

3201
03:15:41,040 --> 03:15:42,779
put them there so so there is an

3202
03:15:42,779 --> 03:15:45,300
opportunity here to try to fix it at the

3203
03:15:45,300 --> 03:15:47,160
left layer and this is the whole thesis

3204
03:15:47,160 --> 03:15:49,439
of this talk we haven't even begin you

3205
03:15:49,439 --> 03:15:53,220
know so uh we will begin and uh the

3206
03:15:53,220 --> 03:15:55,140
thesis is that if we can analyze code

3207
03:15:55,140 --> 03:15:58,200
properly we might be able to fix a lot

3208
03:15:58,200 --> 03:16:00,359
of vulnerabilities that are in security

3209
03:16:00,359 --> 03:16:02,160
and also at the intersection of privacy

3210
03:16:02,160 --> 03:16:05,220
so making everyone happy

3211
03:16:05,220 --> 03:16:07,979
so the goal is to develop uh privacy

3212
03:16:07,979 --> 03:16:10,560
tools for developers and Engineers we'll

3213
03:16:10,560 --> 03:16:13,260
see how we can build them we use the

3214
03:16:13,260 --> 03:16:15,240
technical static analysis age-old

3215
03:16:15,240 --> 03:16:19,319
technique we'll see how it works so uh

3216
03:16:19,319 --> 03:16:21,960
static analysis is analysis of a program

3217
03:16:21,960 --> 03:16:24,720
or a piece of software before it even

3218
03:16:24,720 --> 03:16:26,700
runs and then predicting what's going to

3219
03:16:26,700 --> 03:16:28,500
happen when it runs so it's kind of like

3220
03:16:28,500 --> 03:16:31,560
magic so so that's what it is uh you

3221
03:16:31,560 --> 03:16:33,240
have to understand a few concept sources

3222
03:16:33,240 --> 03:16:35,160
so if you look at the look on the right

3223
03:16:35,160 --> 03:16:37,319
hand side interesting points where the

3224
03:16:37,319 --> 03:16:39,899
data can begin so here is here is data

3225
03:16:39,899 --> 03:16:42,240
coming inside this little function and

3226
03:16:42,240 --> 03:16:44,220
then trying to track it all the way to

3227
03:16:44,220 --> 03:16:46,680
syn sync so tainting it all the way so

3228
03:16:46,680 --> 03:16:48,779
that you can do like a nice data flow

3229
03:16:48,779 --> 03:16:50,580
analysis so these are some some sort of

3230
03:16:50,580 --> 03:16:52,200
Concepts you'll you'll have to remember

3231
03:16:52,200 --> 03:16:55,260
sources saying stains and data flow

3232
03:16:55,260 --> 03:16:58,319
um and you know like why why we try to

3233
03:16:58,319 --> 03:17:00,720
do this is because how humans understand

3234
03:17:00,720 --> 03:17:03,180
you know code we also understand it like

3235
03:17:03,180 --> 03:17:05,160
that you when I told you about this we

3236
03:17:05,160 --> 03:17:06,899
is of code you started looking in your

3237
03:17:06,899 --> 03:17:08,880
head about HTTP then seeing okay it goes

3238
03:17:08,880 --> 03:17:10,979
to location and then it goes here so

3239
03:17:10,979 --> 03:17:12,720
computers also understand it exactly

3240
03:17:12,720 --> 03:17:14,819
like that so why not we just leverage

3241
03:17:14,819 --> 03:17:16,500
this so so that's kind of like the

3242
03:17:16,500 --> 03:17:18,540
thesis behind this

3243
03:17:18,540 --> 03:17:20,460
so looking at the same piece of code

3244
03:17:20,460 --> 03:17:22,260
this is how you would think inside your

3245
03:17:22,260 --> 03:17:24,300
head you would look at this HTTP

3246
03:17:24,300 --> 03:17:26,399
variable you will tag it in your head

3247
03:17:26,399 --> 03:17:28,439
you will mark it as source and then try

3248
03:17:28,439 --> 03:17:30,600
to see where it is going and then see it

3249
03:17:30,600 --> 03:17:32,700
goes to an info then you try to look at

3250
03:17:32,700 --> 03:17:34,680
what is the type of this info okay this

3251
03:17:34,680 --> 03:17:37,200
looks like the logger you know from

3252
03:17:37,200 --> 03:17:38,640
Apache log for J okay this is

3253
03:17:38,640 --> 03:17:39,840
interesting for me I should start

3254
03:17:39,840 --> 03:17:43,100
tracking it so

3255
03:17:43,140 --> 03:17:46,140
um after this mapping is has been done

3256
03:17:46,140 --> 03:17:48,479
you can ask this question so this is

3257
03:17:48,479 --> 03:17:50,700
your goal you know when you try to

3258
03:17:50,700 --> 03:17:53,100
analyze software so find a flow from a

3259
03:17:53,100 --> 03:17:55,620
variable which is pii geolocation to

3260
03:17:55,620 --> 03:17:58,200
sync log function of patch package

3261
03:17:58,200 --> 03:18:00,060
Apache log project so you might have

3262
03:18:00,060 --> 03:18:02,160
this you know thinking in your head

3263
03:18:02,160 --> 03:18:04,620
trying to understand a piece of code and

3264
03:18:04,620 --> 03:18:06,960
that's what you do mentally so uh so the

3265
03:18:06,960 --> 03:18:09,060
goal of static analysis is to try to

3266
03:18:09,060 --> 03:18:11,700
model this you know uh using computers

3267
03:18:11,700 --> 03:18:14,279
we have been doing this for ages uh

3268
03:18:14,279 --> 03:18:16,740
compilers have been doing half of this

3269
03:18:16,740 --> 03:18:19,020
work all the time so we are just going

3270
03:18:19,020 --> 03:18:20,399
to leverage that

3271
03:18:20,399 --> 03:18:22,979
so why should we do this because code is

3272
03:18:22,979 --> 03:18:24,540
actually the true container producer

3273
03:18:24,540 --> 03:18:27,060
mover of data so why not just analyze

3274
03:18:27,060 --> 03:18:28,979
data from that layer rather than just

3275
03:18:28,979 --> 03:18:30,359
looking at it when it gets stored

3276
03:18:30,359 --> 03:18:33,060
somewhere so we can find bugs early in

3277
03:18:33,060 --> 03:18:34,859
the software development life cycle you

3278
03:18:34,859 --> 03:18:37,380
know try to fix things very early rather

3279
03:18:37,380 --> 03:18:40,859
than trying to be you know reactive and

3280
03:18:40,859 --> 03:18:43,740
trying to look at things at runtime

3281
03:18:43,740 --> 03:18:47,460
so uh how do we do this so before we do

3282
03:18:47,460 --> 03:18:49,560
this we'll have to do a deep dive and

3283
03:18:49,560 --> 03:18:52,500
understand what is even code so

3284
03:18:52,500 --> 03:18:54,240
existential questions like this in

3285
03:18:54,240 --> 03:18:56,160
computer science can be solved by

3286
03:18:56,160 --> 03:18:59,040
complex things like this so I'm not

3287
03:18:59,040 --> 03:19:00,300
going to go through all of it but

3288
03:19:00,300 --> 03:19:01,620
essentially what you need to know is

3289
03:19:01,620 --> 03:19:03,899
that this is how computers are going to

3290
03:19:03,899 --> 03:19:06,000
understand this little line you know end

3291
03:19:06,000 --> 03:19:09,660
Y equals X plus 50 uh it converts it

3292
03:19:09,660 --> 03:19:11,640
into this nice tree format just remember

3293
03:19:11,640 --> 03:19:14,939
the name AST and then eventually through

3294
03:19:14,939 --> 03:19:17,880
this AST we are able to get this control

3295
03:19:17,880 --> 03:19:20,040
for graph on the right hand side how

3296
03:19:20,040 --> 03:19:22,080
control passes between different points

3297
03:19:22,080 --> 03:19:23,640
inside the application inside the

3298
03:19:23,640 --> 03:19:25,800
function remember we are not even

3299
03:19:25,800 --> 03:19:27,960
executing anything it's just statically

3300
03:19:27,960 --> 03:19:30,359
analyzing the whole uh you know piece of

3301
03:19:30,359 --> 03:19:32,600
code and trying to understand that and

3302
03:19:32,600 --> 03:19:35,220
take a good note at this yellow thing

3303
03:19:35,220 --> 03:19:38,040
there orange thing so so that's

3304
03:19:38,040 --> 03:19:40,260
essentially where our data is so with

3305
03:19:40,260 --> 03:19:42,359
this information embedded in these nice

3306
03:19:42,359 --> 03:19:44,819
trees and graphs that you see we are

3307
03:19:44,819 --> 03:19:48,359
able to to get a dependence tree so that

3308
03:19:48,359 --> 03:19:49,920
we know that the value of Z depends on

3309
03:19:49,920 --> 03:19:52,200
the value y depends on the value of x so

3310
03:19:52,200 --> 03:19:53,939
by doing this you can see where we are

3311
03:19:53,939 --> 03:19:55,620
approaching we are eventually building

3312
03:19:55,620 --> 03:19:58,080
like data flow of of a complete

3313
03:19:58,080 --> 03:19:59,460
application

3314
03:19:59,460 --> 03:20:01,380
so but programs are more complex they

3315
03:20:01,380 --> 03:20:03,420
are not single lines of code uh real

3316
03:20:03,420 --> 03:20:06,180
programs look like this and they have

3317
03:20:06,180 --> 03:20:09,960
more abstractions in in them so so there

3318
03:20:09,960 --> 03:20:11,399
are class and types which have been

3319
03:20:11,399 --> 03:20:13,140
introduced a variable can be a member

3320
03:20:13,140 --> 03:20:14,700
variable it can be a local variable

3321
03:20:14,700 --> 03:20:17,340
there is a package now or namespace

3322
03:20:17,340 --> 03:20:19,080
based on what language you have I mean

3323
03:20:19,080 --> 03:20:21,779
procedure function methods I mean these

3324
03:20:21,779 --> 03:20:24,840
are all variants of of things uh so so

3325
03:20:24,840 --> 03:20:27,540
we have these new new abstractions that

3326
03:20:27,540 --> 03:20:29,340
have been added and then there is a

3327
03:20:29,340 --> 03:20:31,920
relationship between them so

3328
03:20:31,920 --> 03:20:34,620
for example this method get patient that

3329
03:20:34,620 --> 03:20:36,020
you saw before

3330
03:20:36,020 --> 03:20:40,140
is defined in in this class patient

3331
03:20:40,140 --> 03:20:41,760
controller which instantiates another

3332
03:20:41,760 --> 03:20:44,220
variable and the method also contains a

3333
03:20:44,220 --> 03:20:46,220
call which is find body so you can see

3334
03:20:46,220 --> 03:20:48,960
programs will become huge you know when

3335
03:20:48,960 --> 03:20:50,939
you convert them to a graphical format

3336
03:20:50,939 --> 03:20:52,800
and that's that's essentially what we

3337
03:20:52,800 --> 03:20:56,160
try to do we try to achieve so uh to

3338
03:20:56,160 --> 03:20:58,260
embed all this information and Abstract

3339
03:20:58,260 --> 03:21:00,479
syntax tree the information about calls

3340
03:21:00,479 --> 03:21:03,359
information about data flow we use an

3341
03:21:03,359 --> 03:21:06,000
approach of building a graph like a

3342
03:21:06,000 --> 03:21:07,560
massive graph which has all this

3343
03:21:07,560 --> 03:21:09,660
information and the base layer of that

3344
03:21:09,660 --> 03:21:11,880
would be an abstract syntax tree so it's

3345
03:21:11,880 --> 03:21:13,859
a tree which has all the little little

3346
03:21:13,859 --> 03:21:16,439
information about uh for example here

3347
03:21:16,439 --> 03:21:21,359
you know X plus 50 equals y so so this

3348
03:21:21,359 --> 03:21:22,920
kind of information is embedded in a

3349
03:21:22,920 --> 03:21:24,180
graph like that we'll have that

3350
03:21:24,180 --> 03:21:26,100
information of the whole code embedded

3351
03:21:26,100 --> 03:21:28,439
as one of the base layers and then we

3352
03:21:28,439 --> 03:21:30,420
enhance it we try to build more

3353
03:21:30,420 --> 03:21:31,979
information over it so we have control

3354
03:21:31,979 --> 03:21:33,960
flow and data flow information over it

3355
03:21:33,960 --> 03:21:35,700
and then eventually build more

3356
03:21:35,700 --> 03:21:37,560
information over it where you know we

3357
03:21:37,560 --> 03:21:39,899
can have a human kind of question that

3358
03:21:39,899 --> 03:21:42,420
we can ask okay give me all the methods

3359
03:21:42,420 --> 03:21:44,880
which have patient in their name so this

3360
03:21:44,880 --> 03:21:46,439
kind of information is now embedded

3361
03:21:46,439 --> 03:21:49,260
because we have this nice graph this

3362
03:21:49,260 --> 03:21:51,000
whole thing is called as a code property

3363
03:21:51,000 --> 03:21:54,479
graph a colleague of mine invented this

3364
03:21:54,479 --> 03:21:56,160
you can go on the Wikipedia article and

3365
03:21:56,160 --> 03:21:58,500
you can read about this

3366
03:21:58,500 --> 03:22:01,560
uh so so a big graph and it's a

3367
03:22:01,560 --> 03:22:03,479
queryable graph you can query it and ask

3368
03:22:03,479 --> 03:22:06,359
questions so uh languages different

3369
03:22:06,359 --> 03:22:08,340
languages whatever code is written in

3370
03:22:08,340 --> 03:22:10,560
different languages that's front end and

3371
03:22:10,560 --> 03:22:13,680
then the front end uh you know creates

3372
03:22:13,680 --> 03:22:16,080
this nice graph and then you can query

3373
03:22:16,080 --> 03:22:17,880
the graph using a query engine so in

3374
03:22:17,880 --> 03:22:19,920
real world it would be like how it would

3375
03:22:19,920 --> 03:22:22,080
how you can operationalize is is there

3376
03:22:22,080 --> 03:22:24,240
is a Java app you have and then it

3377
03:22:24,240 --> 03:22:26,520
converts to this graph and then you have

3378
03:22:26,520 --> 03:22:28,680
this question a human-like question that

3379
03:22:28,680 --> 03:22:31,020
you had you can ask this question and

3380
03:22:31,020 --> 03:22:33,000
then the graph returns an answer it says

3381
03:22:33,000 --> 03:22:34,800
okay I found one flow you know starts

3382
03:22:34,800 --> 03:22:37,920
from HTTP ends to the first parameter of

3383
03:22:37,920 --> 03:22:40,859
info uh on this line on this file so you

3384
03:22:40,859 --> 03:22:43,140
have a lot of this information embedded

3385
03:22:43,140 --> 03:22:44,880
completely in it

3386
03:22:44,880 --> 03:22:47,160
how we can use this

3387
03:22:47,160 --> 03:22:49,560
so what if we could run thousands of

3388
03:22:49,560 --> 03:22:51,960
these queries on millions of lines of

3389
03:22:51,960 --> 03:22:54,840
code okay it's not AI it's just it's a

3390
03:22:54,840 --> 03:22:57,120
simple stuff okay we are not gonna do a

3391
03:22:57,120 --> 03:23:00,140
lot of llm AI stuff it's very simple

3392
03:23:00,140 --> 03:23:02,640
thousands of these queries formulate

3393
03:23:02,640 --> 03:23:04,560
these nice queries and run this on

3394
03:23:04,560 --> 03:23:06,120
millions and millions of lines of code

3395
03:23:06,120 --> 03:23:08,760
it's gonna throw out interesting flows

3396
03:23:08,760 --> 03:23:11,399
which you can see which are provable

3397
03:23:11,399 --> 03:23:13,979
that this data went from here and ended

3398
03:23:13,979 --> 03:23:17,279
up there so that's essentially the way

3399
03:23:17,279 --> 03:23:19,319
way we can solve this

3400
03:23:19,319 --> 03:23:22,260
and to do this we build this tool called

3401
03:23:22,260 --> 03:23:25,080
Privado scan which starts scaling static

3402
03:23:25,080 --> 03:23:27,779
analysis and and tunes specifically for

3403
03:23:27,779 --> 03:23:29,340
privacy

3404
03:23:29,340 --> 03:23:32,220
uh Privado scan is open source uh you

3405
03:23:32,220 --> 03:23:33,479
know there are three components of it

3406
03:23:33,479 --> 03:23:35,279
there are three repos Privado Privado

3407
03:23:35,279 --> 03:23:37,859
core and provada CLI uh There Are Rules

3408
03:23:37,859 --> 03:23:39,779
which are defined in nice yamls very

3409
03:23:39,779 --> 03:23:43,500
easy to remember very straightforward uh

3410
03:23:43,500 --> 03:23:46,260
the engine uh it generates the cpg

3411
03:23:46,260 --> 03:23:48,600
converts these rules to actual queries

3412
03:23:48,600 --> 03:23:50,640
so these millions of queries and then

3413
03:23:50,640 --> 03:23:53,640
runs these queries on on uh you know a

3414
03:23:53,640 --> 03:23:56,340
lot of code and then you can view the

3415
03:23:56,340 --> 03:23:58,620
results by default there's a Json and

3416
03:23:58,620 --> 03:24:00,420
something on the CLI but then you can

3417
03:24:00,420 --> 03:24:02,279
also visualize it on a community

3418
03:24:02,279 --> 03:24:04,220
dashboard that we have

3419
03:24:04,220 --> 03:24:07,140
Privado is lgpl so you can download and

3420
03:24:07,140 --> 03:24:08,760
play with this

3421
03:24:08,760 --> 03:24:10,739
how does this work so source code

3422
03:24:10,739 --> 03:24:12,620
converts to this graph we talked about

3423
03:24:12,620 --> 03:24:16,260
yaml rules query and then results as I

3424
03:24:16,260 --> 03:24:17,939
just told you you get something like

3425
03:24:17,939 --> 03:24:20,939
this so five flows where data is Flowing

3426
03:24:20,939 --> 03:24:24,060
from flowing to AWS S3 so so you can

3427
03:24:24,060 --> 03:24:27,319
even embed these kind of you know syncs

3428
03:24:27,319 --> 03:24:30,239
in in the system so it's flowing to a DB

3429
03:24:30,239 --> 03:24:32,160
it's written to a file and then you can

3430
03:24:32,160 --> 03:24:33,600
go through the system and understand

3431
03:24:33,600 --> 03:24:36,779
where the data is exactly going so you

3432
03:24:36,779 --> 03:24:38,760
can try this out uh there's a simple

3433
03:24:38,760 --> 03:24:41,700
curl command here to try this out

3434
03:24:41,700 --> 03:24:44,279
you should not do this because you know

3435
03:24:44,279 --> 03:24:46,859
yeah so uh and then you can just run

3436
03:24:46,859 --> 03:24:49,080
provider scan

3437
03:24:49,080 --> 03:24:50,340
um

3438
03:24:50,340 --> 03:24:53,460
we'll go to a demo now uh I hope the

3439
03:24:53,460 --> 03:24:56,640
demo Works uh because we should start

3440
03:24:56,640 --> 03:24:59,160
praying to the demo Gods now so uh

3441
03:24:59,160 --> 03:25:01,500
system is set up here it's very simple I

3442
03:25:01,500 --> 03:25:04,140
think I should uh make this a bit

3443
03:25:04,140 --> 03:25:08,060
smaller I guess here is this good

3444
03:25:09,720 --> 03:25:12,260
okay

3445
03:25:12,479 --> 03:25:15,840
okay uh can everyone see this

3446
03:25:15,840 --> 03:25:20,040
awesome uh okay I need two hands but one

3447
03:25:20,040 --> 03:25:22,620
is occupied so the brain has to think

3448
03:25:22,620 --> 03:25:24,960
okay uh

3449
03:25:24,960 --> 03:25:27,000
so I have some commands already added it

3450
03:25:27,000 --> 03:25:29,939
says Privado scan banking system back in

3451
03:25:29,939 --> 03:25:32,520
there banking system backend is a repo

3452
03:25:32,520 --> 03:25:35,040
it has some sensitive data and then

3453
03:25:35,040 --> 03:25:37,140
we'll try to discover if it flows

3454
03:25:37,140 --> 03:25:38,580
somewhere

3455
03:25:38,580 --> 03:25:40,380
um you know I've already scanned it so I

3456
03:25:40,380 --> 03:25:42,239
know what happens but it's for you to

3457
03:25:42,239 --> 03:25:44,100
see what happens

3458
03:25:44,100 --> 03:25:48,720
so uh let's run this and this is uh so

3459
03:25:48,720 --> 03:25:51,540
Privado is packaged in in like a Docker

3460
03:25:51,540 --> 03:25:54,479
container so now this is this is running

3461
03:25:54,479 --> 03:25:57,180
here uh you can see that

3462
03:25:57,180 --> 03:25:58,439
um you know we detected that the

3463
03:25:58,439 --> 03:26:00,239
language is Java you know it looks at

3464
03:26:00,239 --> 03:26:02,460
configuration it's trying to download

3465
03:26:02,460 --> 03:26:05,340
some dependencies which might be there

3466
03:26:05,340 --> 03:26:07,500
so for example Imports Etc that you do

3467
03:26:07,500 --> 03:26:09,300
in Java it's trying to understand all of

3468
03:26:09,300 --> 03:26:11,700
that uh and then you know it will start

3469
03:26:11,700 --> 03:26:14,279
parsing source code so static analysis

3470
03:26:14,279 --> 03:26:16,080
takes time so it's it's gonna take time

3471
03:26:16,080 --> 03:26:19,560
but uh surprisingly it's very fast I was

3472
03:26:19,560 --> 03:26:21,720
told that uh in in some organizations

3473
03:26:21,720 --> 03:26:23,340
that were doing static analysis that

3474
03:26:23,340 --> 03:26:25,080
they used to run there's stuff on

3475
03:26:25,080 --> 03:26:27,300
weekends and then go back and on Monday

3476
03:26:27,300 --> 03:26:28,920
they would come with like thousands of

3477
03:26:28,920 --> 03:26:31,080
things in the list and I never

3478
03:26:31,080 --> 03:26:33,180
understood how people can do this but

3479
03:26:33,180 --> 03:26:36,000
you know this is pretty fast for for the

3480
03:26:36,000 --> 03:26:39,540
size of this code so we ran a lot of

3481
03:26:39,540 --> 03:26:42,239
passes over this graph uh people working

3482
03:26:42,239 --> 03:26:43,560
in compilers would understand what

3483
03:26:43,560 --> 03:26:45,359
passes are so we ran a lot of these

3484
03:26:45,359 --> 03:26:48,000
passes over this nice graph and we were

3485
03:26:48,000 --> 03:26:50,399
able to detect a lot of things uh

3486
03:26:50,399 --> 03:26:52,560
related to privacy here so so you can

3487
03:26:52,560 --> 03:26:55,500
see there there is some data elements so

3488
03:26:55,500 --> 03:26:59,460
we have uh 11 data elements total uh you

3489
03:26:59,460 --> 03:27:01,380
know one third party and then you know

3490
03:27:01,380 --> 03:27:03,540
two storages and then information about

3491
03:27:03,540 --> 03:27:05,040
those data elements so they are also

3492
03:27:05,040 --> 03:27:06,720
classified so we have a way to classify

3493
03:27:06,720 --> 03:27:09,180
those data elements also

3494
03:27:09,180 --> 03:27:11,340
um you can see we have some passport

3495
03:27:11,340 --> 03:27:13,500
information age phone number date of

3496
03:27:13,500 --> 03:27:15,479
birth and where it is going so for

3497
03:27:15,479 --> 03:27:16,680
example date of birth is getting

3498
03:27:16,680 --> 03:27:19,020
collected in these routes it's also

3499
03:27:19,020 --> 03:27:22,439
going to this database htfc bank one we

3500
03:27:22,439 --> 03:27:24,600
we understood because there was this

3501
03:27:24,600 --> 03:27:27,420
information was in the configuration uh

3502
03:27:27,420 --> 03:27:29,580
for some place some things we can we can

3503
03:27:29,580 --> 03:27:31,260
also detect third parties so this is

3504
03:27:31,260 --> 03:27:34,100
getting shared to this fast to SMS thing

3505
03:27:34,100 --> 03:27:37,319
uh you know and then uh there is a nice

3506
03:27:37,319 --> 03:27:39,899
dashboard to view this also I'll try to

3507
03:27:39,899 --> 03:27:42,858
open it let's see

3508
03:27:50,100 --> 03:27:54,720
okay so so uh this is how you know it

3509
03:27:54,720 --> 03:27:57,300
looks so you have these data elements on

3510
03:27:57,300 --> 03:27:59,340
on the left side and and then you see

3511
03:27:59,340 --> 03:28:01,739
data going uh all the way on the right

3512
03:28:01,739 --> 03:28:03,660
side so here we can see like phone

3513
03:28:03,660 --> 03:28:04,979
number we were looking at phone number

3514
03:28:04,979 --> 03:28:07,920
we can see where phone number went uh it

3515
03:28:07,920 --> 03:28:09,600
it went it was getting shared to fast

3516
03:28:09,600 --> 03:28:12,180
SMS goes into the storage and then you

3517
03:28:12,180 --> 03:28:14,880
can click on code analysis and see this

3518
03:28:14,880 --> 03:28:17,819
literally line by line how this was

3519
03:28:17,819 --> 03:28:21,300
going from one uh place to another uh

3520
03:28:21,300 --> 03:28:22,920
and then you you can see eventually you

3521
03:28:22,920 --> 03:28:25,319
know you created a URL connection and

3522
03:28:25,319 --> 03:28:27,899
then maybe you know the string in url

3523
03:28:27,899 --> 03:28:30,660
was fast to SMS and then that's how it

3524
03:28:30,660 --> 03:28:32,580
detected that essentially you made a

3525
03:28:32,580 --> 03:28:35,700
call to that and the phone number was a

3526
03:28:35,700 --> 03:28:37,500
part of that message that went there so

3527
03:28:37,500 --> 03:28:40,439
so this is a this is an example uh

3528
03:28:40,439 --> 03:28:42,479
contrary to a lot of what people say I

3529
03:28:42,479 --> 03:28:44,399
find this thing very interesting you

3530
03:28:44,399 --> 03:28:47,640
know like stuff going into logs uh is is

3531
03:28:47,640 --> 03:28:49,680
one of the interesting things that I

3532
03:28:49,680 --> 03:28:53,460
find here so uh that brings me to the

3533
03:28:53,460 --> 03:28:55,680
end of the demo uh you can try to play

3534
03:28:55,680 --> 03:28:58,560
around with it with your own

3535
03:28:58,560 --> 03:29:01,319
um with your own

3536
03:29:01,319 --> 03:29:05,040
repos also try with Java python is also

3537
03:29:05,040 --> 03:29:07,380
there python is beat beta at that time

3538
03:29:07,380 --> 03:29:10,020
at this time and JS is also beta but I

3539
03:29:10,020 --> 03:29:11,520
think Java is working very well so

3540
03:29:11,520 --> 03:29:13,739
please play around with this

3541
03:29:13,739 --> 03:29:16,380
um where do we go next so I think if if

3542
03:29:16,380 --> 03:29:18,540
someone asks me what we should do you

3543
03:29:18,540 --> 03:29:20,340
know in privacy this would be something

3544
03:29:20,340 --> 03:29:22,979
very golden for me you know a privacy

3545
03:29:22,979 --> 03:29:25,260
policy very high level stuff that you

3546
03:29:25,260 --> 03:29:27,899
know lawyer folks would understand much

3547
03:29:27,899 --> 03:29:30,720
more better you know with cippe stuff on

3548
03:29:30,720 --> 03:29:33,420
their LinkedIn uh we want to understand

3549
03:29:33,420 --> 03:29:36,060
how they translate to gdpr violations

3550
03:29:36,060 --> 03:29:39,660
you know gdpr or any other law so gdpr

3551
03:29:39,660 --> 03:29:42,000
is like a you know kind of like a larger

3552
03:29:42,000 --> 03:29:46,260
term that I'm using for CCPA or any

3553
03:29:46,260 --> 03:29:49,500
other kind of pip Eda for Canada so so

3554
03:29:49,500 --> 03:29:50,819
these kind of regulations which are

3555
03:29:50,819 --> 03:29:53,220
there so any violation connected with

3556
03:29:53,220 --> 03:29:55,200
the policy that you already have in your

3557
03:29:55,200 --> 03:29:57,660
organization and then an actual bug

3558
03:29:57,660 --> 03:30:00,840
inside the code so so this would be this

3559
03:30:00,840 --> 03:30:03,300
would be like the the golden you know

3560
03:30:03,300 --> 03:30:04,859
kind of like the Holy Grail of of

3561
03:30:04,859 --> 03:30:07,859
getting privacy done properly it's very

3562
03:30:07,859 --> 03:30:09,720
difficult to do this we can do half of

3563
03:30:09,720 --> 03:30:11,520
it you can do one piece of it but

3564
03:30:11,520 --> 03:30:12,899
through and through it's very difficult

3565
03:30:12,899 --> 03:30:15,060
but people are trying

3566
03:30:15,060 --> 03:30:16,680
um there's a research paper below you

3567
03:30:16,680 --> 03:30:18,840
can see see this I mean this this has

3568
03:30:18,840 --> 03:30:21,120
been talking about a very similar

3569
03:30:21,120 --> 03:30:23,160
approach and they are also doing

3570
03:30:23,160 --> 03:30:25,260
something like that

3571
03:30:25,260 --> 03:30:27,779
um and then you know find these exact

3572
03:30:27,779 --> 03:30:29,819
privacy violations and suggest some

3573
03:30:29,819 --> 03:30:31,800
automated ways to fix them you know we

3574
03:30:31,800 --> 03:30:34,920
can we can definitely leverage uh AI or

3575
03:30:34,920 --> 03:30:37,500
the advances in AI right now for that I

3576
03:30:37,500 --> 03:30:40,319
think the time is there the models are

3577
03:30:40,319 --> 03:30:42,540
just not yet there but I think they are

3578
03:30:42,540 --> 03:30:44,279
almost there

3579
03:30:44,279 --> 03:30:46,200
um and then build a complete

3580
03:30:46,200 --> 03:30:48,359
organizational data flow not just by

3581
03:30:48,359 --> 03:30:51,899
analyzing code but also databases apis

3582
03:30:51,899 --> 03:30:54,000
document or your complete infrastructure

3583
03:30:54,000 --> 03:30:57,239
so so like a large complete large map of

3584
03:30:57,239 --> 03:30:59,520
where data can start from where it can

3585
03:30:59,520 --> 03:31:01,979
go just by doing scanning on of all

3586
03:31:01,979 --> 03:31:03,600
these individual components so till now

3587
03:31:03,600 --> 03:31:05,760
we have been scanning something some DBS

3588
03:31:05,760 --> 03:31:07,439
here and then someone looks at a

3589
03:31:07,439 --> 03:31:10,020
document puts it in a spreadsheet sends

3590
03:31:10,020 --> 03:31:11,700
it to somebody else a lot of manual

3591
03:31:11,700 --> 03:31:13,979
processes going on right now we can

3592
03:31:13,979 --> 03:31:16,620
do everything by just scanning all of

3593
03:31:16,620 --> 03:31:18,180
these pieces one by one and then

3594
03:31:18,180 --> 03:31:19,859
correlating them that would be pretty

3595
03:31:19,859 --> 03:31:21,420
interesting

3596
03:31:21,420 --> 03:31:23,640
okay uh I think we are almost at the end

3597
03:31:23,640 --> 03:31:27,180
of this so last comment you know which I

3598
03:31:27,180 --> 03:31:29,220
would want to say that if your clothes

3599
03:31:29,220 --> 03:31:31,200
had as much value as your private

3600
03:31:31,200 --> 03:31:33,420
information I can bet some privacy

3601
03:31:33,420 --> 03:31:35,700
policy would be there and they won't

3602
03:31:35,700 --> 03:31:37,260
mind asking you to send them your

3603
03:31:37,260 --> 03:31:39,420
underwear before you order a cab I mean

3604
03:31:39,420 --> 03:31:41,220
this is the state that we are in right

3605
03:31:41,220 --> 03:31:43,439
now related to privacy so so please take

3606
03:31:43,439 --> 03:31:45,359
care of your private information that's

3607
03:31:45,359 --> 03:31:47,880
that's all I would say uh here are some

3608
03:31:47,880 --> 03:31:50,100
additional links for docs rules engine

3609
03:31:50,100 --> 03:31:53,520
for Privado uh I I also recommend you

3610
03:31:53,520 --> 03:31:56,220
reading the nist Privacy framework and

3611
03:31:56,220 --> 03:31:57,899
not just the security one the Privacy

3612
03:31:57,899 --> 03:32:00,120
one here and there's a tool by Microsoft

3613
03:32:00,120 --> 03:32:03,060
data protection mapping framework which

3614
03:32:03,060 --> 03:32:05,279
which maps all these different you know

3615
03:32:05,279 --> 03:32:07,739
these uh we we all know the miter attack

3616
03:32:07,739 --> 03:32:10,859
framework or over top 10 Etc I mean in

3617
03:32:10,859 --> 03:32:13,080
security we know this but in privacy

3618
03:32:13,080 --> 03:32:15,060
there is an effort to map all these

3619
03:32:15,060 --> 03:32:18,060
different uh kind of Standards into each

3620
03:32:18,060 --> 03:32:19,800
other so that that's essentially what

3621
03:32:19,800 --> 03:32:21,180
this is

3622
03:32:21,180 --> 03:32:26,359
okay uh and so questions

3623
03:32:28,800 --> 03:32:31,519
thank you

3624
03:32:33,779 --> 03:32:37,260
okay so um let's start with ah there we

3625
03:32:37,260 --> 03:32:40,020
go amazing magic so do you think this

3626
03:32:40,020 --> 03:32:41,220
approach could encourage organizations

3627
03:32:41,220 --> 03:32:44,279
to retain pii in a dangerous way uh and

3628
03:32:44,279 --> 03:32:45,720
should we focus on privacy by Design

3629
03:32:45,720 --> 03:32:46,920
good question

3630
03:32:46,920 --> 03:32:50,399
so I I I think this is actual privacy by

3631
03:32:50,399 --> 03:32:52,020
Design I mean yes they they are

3632
03:32:52,020 --> 03:32:54,120
retaining your information anyways you

3633
03:32:54,120 --> 03:32:56,819
know you would be surprised to know how

3634
03:32:56,819 --> 03:32:59,520
much information they retain on you and

3635
03:32:59,520 --> 03:33:01,020
you'll be surprised to know that they

3636
03:33:01,020 --> 03:33:03,420
have no clue what to do with this so

3637
03:33:03,420 --> 03:33:05,460
it's they're already retaining it I mean

3638
03:33:05,460 --> 03:33:09,380
there's no uh question about it and and

3639
03:33:09,380 --> 03:33:12,300
every time someone says that we are not

3640
03:33:12,300 --> 03:33:13,800
going to collect this or we are

3641
03:33:13,800 --> 03:33:16,920
compliant with this uh you know

3642
03:33:16,920 --> 03:33:19,500
I I think I can bet I I don't know maybe

3643
03:33:19,500 --> 03:33:21,779
it's too dangerous but I will still bet

3644
03:33:21,779 --> 03:33:24,300
that they have your information okay uh

3645
03:33:24,300 --> 03:33:25,680
and in somewhere in some of the

3646
03:33:25,680 --> 03:33:27,239
databases and they don't know about it

3647
03:33:27,239 --> 03:33:29,100
so they're not wrong in it it's just

3648
03:33:29,100 --> 03:33:30,779
that they don't know about it but since

3649
03:33:30,779 --> 03:33:32,880
they are collecting it anyways through

3650
03:33:32,880 --> 03:33:35,399
these various you know means a marketing

3651
03:33:35,399 --> 03:33:37,380
person came in and then said I need this

3652
03:33:37,380 --> 03:33:38,880
thing in the analytics can you put it

3653
03:33:38,880 --> 03:33:41,279
nobody else knows about what they asked

3654
03:33:41,279 --> 03:33:43,620
and where it where the data is going uh

3655
03:33:43,620 --> 03:33:46,439
the better thing is to get to have an

3656
03:33:46,439 --> 03:33:48,239
understanding that it is going there and

3657
03:33:48,239 --> 03:33:50,939
then stop it so so this I believe is a

3658
03:33:50,939 --> 03:33:53,160
way to do privacy by Design By Doing

3659
03:33:53,160 --> 03:33:54,840
static analysis of code and actually

3660
03:33:54,840 --> 03:33:58,380
understanding where it's exactly going

3661
03:33:58,380 --> 03:34:00,300
does that answer the question or I was

3662
03:34:00,300 --> 03:34:02,340
just going around you know beating about

3663
03:34:02,340 --> 03:34:04,700
the bush

3664
03:34:05,760 --> 03:34:07,620
we will never know if the person who

3665
03:34:07,620 --> 03:34:09,359
asked the question is actually in the

3666
03:34:09,359 --> 03:34:11,479
room

3667
03:34:12,300 --> 03:34:14,700
any other questions I'm not seeing

3668
03:34:14,700 --> 03:34:16,859
anything popping up yet oh never mind

3669
03:34:16,859 --> 03:34:22,080
that is a lie uh so here we go

3670
03:34:22,080 --> 03:34:24,540
how such is it even possible for this

3671
03:34:24,540 --> 03:34:26,100
kind of analysis to help with the

3672
03:34:26,100 --> 03:34:28,920
confused Deputy problem your example of

3673
03:34:28,920 --> 03:34:31,739
the incrementing ID revealing adhar's

3674
03:34:31,739 --> 03:34:33,439
numbers

3675
03:34:33,439 --> 03:34:36,660
uh can you remind me the confused Deputy

3676
03:34:36,660 --> 03:34:38,899
problem

3677
03:34:39,479 --> 03:34:41,580
All Right audience

3678
03:34:41,580 --> 03:34:43,560
I don't know the confused Deputy problem

3679
03:34:43,560 --> 03:34:47,000
so I'm lost

3680
03:35:09,899 --> 03:35:12,660
okay got it yeah so

3681
03:35:12,660 --> 03:35:13,500
um

3682
03:35:13,500 --> 03:35:16,859
so I think when you actually do code

3683
03:35:16,859 --> 03:35:19,080
analysis and try to understand how this

3684
03:35:19,080 --> 03:35:21,180
information was collected for example

3685
03:35:21,180 --> 03:35:23,220
let's take the other number so so if you

3686
03:35:23,220 --> 03:35:24,840
look at the system you will see that the

3687
03:35:24,840 --> 03:35:26,460
other number was collected in this

3688
03:35:26,460 --> 03:35:28,620
certain variable and we see that it went

3689
03:35:28,620 --> 03:35:31,920
all the way here to uh you know populate

3690
03:35:31,920 --> 03:35:34,800
this template in this you know jsx file

3691
03:35:34,800 --> 03:35:37,200
you know and here it was going you would

3692
03:35:37,200 --> 03:35:39,600
actually you would have a complete flow

3693
03:35:39,600 --> 03:35:41,760
of where the data went to and if in

3694
03:35:41,760 --> 03:35:44,460
between that there was no check or

3695
03:35:44,460 --> 03:35:46,739
authentication you can actually prove

3696
03:35:46,739 --> 03:35:49,800
and find it that this was missing this

3697
03:35:49,800 --> 03:35:53,040
uh authentication was missing so this

3698
03:35:53,040 --> 03:35:54,660
person is not authorized to view it so

3699
03:35:54,660 --> 03:35:57,300
you can find it but if you didn't I mean

3700
03:35:57,300 --> 03:35:58,739
obviously the flow is supposed to be

3701
03:35:58,739 --> 03:36:01,200
there it's it's a data that came from

3702
03:36:01,200 --> 03:36:03,239
somewhere and you know is supposed to be

3703
03:36:03,239 --> 03:36:06,060
shown on the site but if it's not

3704
03:36:06,060 --> 03:36:08,340
authenticated you can prove it that this

3705
03:36:08,340 --> 03:36:09,960
was not authenticated so it's a

3706
03:36:09,960 --> 03:36:12,319
violation

3707
03:36:16,500 --> 03:36:19,800
okay and we've got another one

3708
03:36:19,800 --> 03:36:22,500
let's see uh won't companies actually

3709
03:36:22,500 --> 03:36:24,840
want to stay away from tools like yours

3710
03:36:24,840 --> 03:36:26,580
so that they can keep claiming that they

3711
03:36:26,580 --> 03:36:29,700
did not know hundred percent

3712
03:36:29,700 --> 03:36:32,040
hundred percent they want to be away

3713
03:36:32,040 --> 03:36:35,399
from us as much as possible uh but

3714
03:36:35,399 --> 03:36:37,500
hundred percent they will be slapped

3715
03:36:37,500 --> 03:36:39,180
with like you know 60 million dollar

3716
03:36:39,180 --> 03:36:41,819
fine you know because like last week

3717
03:36:41,819 --> 03:36:45,660
there were three uh you know

3718
03:36:45,660 --> 03:36:48,359
um in in EU so EU is very strict on this

3719
03:36:48,359 --> 03:36:50,460
right now you know last two years they

3720
03:36:50,460 --> 03:36:52,560
have they have started you know clearing

3721
03:36:52,560 --> 03:36:54,180
court cases which had been pending for

3722
03:36:54,180 --> 03:36:56,640
quite some time and they are going to

3723
03:36:56,640 --> 03:36:58,979
get fined so it's the same thing that

3724
03:36:58,979 --> 03:37:01,680
happens in in cyber security so you know

3725
03:37:01,680 --> 03:37:04,439
like fear-driven fixes which should not

3726
03:37:04,439 --> 03:37:06,359
be there people should intrinsically be

3727
03:37:06,359 --> 03:37:09,239
motivated to not leak information but

3728
03:37:09,239 --> 03:37:11,340
they don't do it so the other approach

3729
03:37:11,340 --> 03:37:12,899
is they'll get fined and then they will

3730
03:37:12,899 --> 03:37:15,540
come to us to either detect where the

3731
03:37:15,540 --> 03:37:18,720
issue was there or you know bake privacy

3732
03:37:18,720 --> 03:37:20,520
by Design the way it is supposed to be

3733
03:37:20,520 --> 03:37:22,680
but I I would not be too pessimistic

3734
03:37:22,680 --> 03:37:24,479
about it because I'm interacting with a

3735
03:37:24,479 --> 03:37:27,359
lot of companies and and they are uh you

3736
03:37:27,359 --> 03:37:29,700
know really coming to us from any

3737
03:37:29,700 --> 03:37:31,319
engineering perspective for the first

3738
03:37:31,319 --> 03:37:33,899
time never experience this like somebody

3739
03:37:33,899 --> 03:37:36,359
uh a large organization coming to us and

3740
03:37:36,359 --> 03:37:38,520
saying oh we know that all of the stuff

3741
03:37:38,520 --> 03:37:40,800
is fine with us but we actually want to

3742
03:37:40,800 --> 03:37:43,560
bake privacy by Design so it's it's a

3743
03:37:43,560 --> 03:37:46,140
new thing you know and privacy buying

3744
03:37:46,140 --> 03:37:48,359
design privacy by Design and these

3745
03:37:48,359 --> 03:37:50,460
techniques being pioneered here itself

3746
03:37:50,460 --> 03:37:54,080
in Canada I mean it's it's a big thing

3747
03:37:57,060 --> 03:38:00,439
all right going once going

3748
03:38:00,439 --> 03:38:03,300
twice all right I think I think that's

3749
03:38:03,300 --> 03:38:05,100
all we got thank you so much sushakra

3750
03:38:05,100 --> 03:38:06,470
okay appreciate your time

3751
03:38:06,470 --> 03:38:13,708
[Applause]

3752
03:38:15,479 --> 03:38:17,340
and then we'll be back for the next

3753
03:38:17,340 --> 03:38:18,720
presentation which is the last of the

3754
03:38:18,720 --> 03:38:19,800
day well

3755
03:38:19,800 --> 03:38:22,080
there's the uh North Seck 10 years panel

3756
03:38:22,080 --> 03:38:23,760
and then there's a cocktail but the last

3757
03:38:23,760 --> 03:38:26,420
in this room

3758
03:38:43,450 --> 03:38:46,569
[Music]

3759
03:38:46,920 --> 03:38:49,920
foreign

3760
03:39:08,700 --> 03:39:11,000
foreign

3761
03:39:51,950 --> 03:39:55,129
[Music]

3762
03:40:19,439 --> 03:40:21,680
foreign

3763
03:42:00,239 --> 03:42:03,239
foreign

3764
03:43:55,100 --> 03:43:58,399
come on there

3765
03:44:41,460 --> 03:44:43,699
foreign

3766
03:45:11,990 --> 03:45:15,160
[Music]

3767
03:45:37,620 --> 03:45:40,520
foreign

3768
03:47:15,060 --> 03:47:17,300
foreign

3769
03:48:16,979 --> 03:48:19,979
foreign

3770
03:50:01,500 --> 03:50:03,739
foreign

3771
03:50:10,760 --> 03:50:13,560
we're good to go so we're going to get

3772
03:50:13,560 --> 03:50:15,720
started with the uh last talk of this

3773
03:50:15,720 --> 03:50:17,160
track

3774
03:50:17,160 --> 03:50:19,319
um so we've got some guests today who

3775
03:50:19,319 --> 03:50:22,319
came from halfway across the world so um

3776
03:50:22,319 --> 03:50:24,960
on up on stage we have a Hagen vardanian

3777
03:50:24,960 --> 03:50:27,300
uh he's the CTO of red rays and his

3778
03:50:27,300 --> 03:50:28,739
expertise includes protecting vital

3779
03:50:28,739 --> 03:50:31,800
business applications including Erp CRM

3780
03:50:31,800 --> 03:50:34,500
SRM Banking and processing software he's

3781
03:50:34,500 --> 03:50:35,700
a well-known Authority on Enterprise

3782
03:50:35,700 --> 03:50:37,979
application security including sap and

3783
03:50:37,979 --> 03:50:39,420
Oracle he's published many

3784
03:50:39,420 --> 03:50:41,220
vulnerabilities and speaks regularly at

3785
03:50:41,220 --> 03:50:43,080
conferences across the world as we can

3786
03:50:43,080 --> 03:50:45,720
see and special thanks to these folks

3787
03:50:45,720 --> 03:50:47,880
for for making it here

3788
03:50:47,880 --> 03:50:50,520
um and as you can see the youngest team

3789
03:50:50,520 --> 03:50:53,399
member is over here and really awesome

3790
03:50:53,399 --> 03:50:57,000
so thank you so much

3791
03:50:57,000 --> 03:51:00,060
um uh hello I'm excited to share my

3792
03:51:00,060 --> 03:51:01,920
presentation with you today uh which

3793
03:51:01,920 --> 03:51:04,200
focused on the vulnerability chains in

3794
03:51:04,200 --> 03:51:07,739
the sap softwares and today I will

3795
03:51:07,739 --> 03:51:11,220
demonstrate how to possible to escalate

3796
03:51:11,220 --> 03:51:13,500
privileges in sap and jump from

3797
03:51:13,500 --> 03:51:17,880
on-premises networks to the sap clouds

3798
03:51:17,880 --> 03:51:20,000
um

3799
03:51:20,279 --> 03:51:24,660
here is the oh sorry

3800
03:51:24,660 --> 03:51:25,920
yep

3801
03:51:25,920 --> 03:51:29,040
um here's our agenda and

3802
03:51:29,040 --> 03:51:29,939
um

3803
03:51:29,939 --> 03:51:32,880
I I think it will help help you to

3804
03:51:32,880 --> 03:51:35,479
understand the flow of our presentation

3805
03:51:35,479 --> 03:51:38,160
my name is vahagan I'm CTO of red race

3806
03:51:38,160 --> 03:51:42,660
and rpne she's a CEO of Red race a few

3807
03:51:42,660 --> 03:51:44,580
words about red race red race is a

3808
03:51:44,580 --> 03:51:45,840
research and development center in

3809
03:51:45,840 --> 03:51:50,660
Armenia we founded in two years ago

3810
03:51:50,660 --> 03:51:54,420
and since 2021 we discovered over 50

3811
03:51:54,420 --> 03:51:57,120
zero days in Enterprise software

3812
03:51:57,120 --> 03:52:00,180
especially sap Oracle Etc

3813
03:52:00,180 --> 03:52:02,120
so what is sap

3814
03:52:02,120 --> 03:52:05,040
the sap is a multinational software

3815
03:52:05,040 --> 03:52:07,560
corporation that's specialized in

3816
03:52:07,560 --> 03:52:10,020
Enterprise softwares developing

3817
03:52:10,020 --> 03:52:11,880
including enterprise resource planning

3818
03:52:11,880 --> 03:52:12,960
softwares

3819
03:52:12,960 --> 03:52:18,739
and Erp software is used by businesses

3820
03:52:18,739 --> 03:52:22,920
of all the sites across

3821
03:52:22,920 --> 03:52:25,920
all Industries to manage the uh today

3822
03:52:25,920 --> 03:52:28,680
operations okay

3823
03:52:28,680 --> 03:52:31,979
um a short story of the research last

3824
03:52:31,979 --> 03:52:35,160
year one of our customer request us

3825
03:52:35,160 --> 03:52:35,720
um

3826
03:52:35,720 --> 03:52:37,460
to

3827
03:52:37,460 --> 03:52:42,720
analyze their sap landscape

3828
03:52:42,720 --> 03:52:46,319
the sap landscape was very hard but here

3829
03:52:46,319 --> 03:52:50,700
I I wanted to show very simple Network

3830
03:52:50,700 --> 03:52:52,040
structure

3831
03:52:52,040 --> 03:52:54,540
the customer give us an access as a

3832
03:52:54,540 --> 03:52:58,859
regular user in the user space and the

3833
03:52:58,859 --> 03:53:00,420
request was

3834
03:53:00,420 --> 03:53:04,140
uh Hey guys is it possible to find out

3835
03:53:04,140 --> 03:53:06,899
some vulnerabilities or is it possible

3836
03:53:06,899 --> 03:53:10,439
to get information from sap cloud

3837
03:53:10,439 --> 03:53:12,620
from the user

3838
03:53:12,620 --> 03:53:15,000
user environments user Network

3839
03:53:15,000 --> 03:53:16,380
environments right

3840
03:53:16,380 --> 03:53:18,600
so we started to analyze and first of

3841
03:53:18,600 --> 03:53:21,180
all we built this map as you can see we

3842
03:53:21,180 --> 03:53:24,660
split the map by three parts the first

3843
03:53:24,660 --> 03:53:27,660
one is a user environment the second one

3844
03:53:27,660 --> 03:53:30,720
is on-premises sap servers environment

3845
03:53:30,720 --> 03:53:33,479
and the third one is sap Cloud

3846
03:53:33,479 --> 03:53:35,760
environment

3847
03:53:35,760 --> 03:53:39,180
um the end users didn't have access to

3848
03:53:39,180 --> 03:53:42,180
this AP Cloud directly so they have

3849
03:53:42,180 --> 03:53:45,120
connection only to the sap servers on

3850
03:53:45,120 --> 03:53:48,120
on-premises network right but the main

3851
03:53:48,120 --> 03:53:52,200
components was a cloud connector that

3852
03:53:52,200 --> 03:53:55,380
was connected to the zip cloud and was

3853
03:53:55,380 --> 03:53:57,899
connected to another saps in on-premises

3854
03:53:57,899 --> 03:53:59,640
so it means that if you if if you would

3855
03:53:59,640 --> 03:54:02,880
like to compromise the sap cloud or get

3856
03:54:02,880 --> 03:54:03,920
information

3857
03:54:03,920 --> 03:54:09,180
in sap Cloud we should compromise the

3858
03:54:09,180 --> 03:54:10,979
sap Cloud connector right

3859
03:54:10,979 --> 03:54:13,920
but to compromise the CP Cloud connector

3860
03:54:13,920 --> 03:54:15,960
we can we should compromise the sap

3861
03:54:15,960 --> 03:54:19,200
servers so we need to jump there there

3862
03:54:19,200 --> 03:54:21,660
and in the cloud

3863
03:54:21,660 --> 03:54:24,540
okay when we are compromising the sap

3864
03:54:24,540 --> 03:54:29,699
servers usually we can have

3865
03:54:29,880 --> 03:54:33,120
four type of access the first access it

3866
03:54:33,120 --> 03:54:37,140
can be admin user in sap application

3867
03:54:37,140 --> 03:54:41,100
and the second one we can get access to

3868
03:54:41,100 --> 03:54:45,420
the sap database the third one is

3869
03:54:45,420 --> 03:54:48,500
vulnerability or access when we can read

3870
03:54:48,500 --> 03:54:51,840
application we can read files from the

3871
03:54:51,840 --> 03:54:54,060
sap application using some directory

3872
03:54:54,060 --> 03:54:57,540
traversal just for example or we can

3873
03:54:57,540 --> 03:54:59,699
execute some code or command in sap

3874
03:54:59,699 --> 03:55:01,500
servers

3875
03:55:01,500 --> 03:55:06,300
okay before we will we'll

3876
03:55:06,300 --> 03:55:07,800
um I will demonstrate the vulnerability

3877
03:55:07,800 --> 03:55:09,540
I'd like to mention that all the

3878
03:55:09,540 --> 03:55:11,819
vulnerabilities has been discovered by

3879
03:55:11,819 --> 03:55:14,479
Red race during the that assessment

3880
03:55:14,479 --> 03:55:18,960
only except one the CV from 2021 we just

3881
03:55:18,960 --> 03:55:20,580
rested it

3882
03:55:20,580 --> 03:55:21,239
um

3883
03:55:21,239 --> 03:55:25,800
uh and all the screenshots that I will

3884
03:55:25,800 --> 03:55:28,800
demonstrate I will show you it's from

3885
03:55:28,800 --> 03:55:31,859
Red race demo server as as you are I

3886
03:55:31,859 --> 03:55:33,300
think you can understand that I can't

3887
03:55:33,300 --> 03:55:37,080
show the screenshots uh from our

3888
03:55:37,080 --> 03:55:38,580
customer servers

3889
03:55:38,580 --> 03:55:39,779
okay

3890
03:55:39,779 --> 03:55:42,239
so first of all we analyzed we scan the

3891
03:55:42,239 --> 03:55:45,720
sap applications and as the our customer

3892
03:55:45,720 --> 03:55:49,680
was from gazunt oil industry

3893
03:55:49,680 --> 03:55:52,080
we saw that he used sap manufacturing

3894
03:55:52,080 --> 03:55:53,460
execution model

3895
03:55:53,460 --> 03:55:56,279
the sap manufacturing execution model

3896
03:55:56,279 --> 03:55:59,399
is you um is using in many many

3897
03:55:59,399 --> 03:56:00,779
Industries

3898
03:56:00,779 --> 03:56:05,520
and the the me sap me model is a Java

3899
03:56:05,520 --> 03:56:09,180
application that is deploying in Java uh

3900
03:56:09,180 --> 03:56:12,239
Stacks application Java stacks

3901
03:56:12,239 --> 03:56:15,660
so uh as the redress is a partner of sap

3902
03:56:15,660 --> 03:56:18,779
we could download that component and we

3903
03:56:18,779 --> 03:56:21,479
started to analyze to discover some

3904
03:56:21,479 --> 03:56:24,180
vulnerabilities there

3905
03:56:24,180 --> 03:56:26,819
um we had a lot of low privileged user

3906
03:56:26,819 --> 03:56:28,439
and

3907
03:56:28,439 --> 03:56:30,720
um we

3908
03:56:30,720 --> 03:56:34,040
during the research we found vemo

3909
03:56:34,040 --> 03:56:37,580
deleo.jsp file in the sapme component

3910
03:56:37,580 --> 03:56:42,600
and as you can see from the this line

3911
03:56:42,600 --> 03:56:45,720
um this GSP script is receiving file

3912
03:56:45,720 --> 03:56:47,460
path

3913
03:56:47,460 --> 03:56:51,479
um some file path parameter and

3914
03:56:51,479 --> 03:56:52,199
um

3915
03:56:52,199 --> 03:56:55,380
using file parameter value he's reading

3916
03:56:55,380 --> 03:56:57,300
the file and he's printing that content

3917
03:56:57,300 --> 03:56:59,160
of the file in the page right

3918
03:56:59,160 --> 03:57:01,620
uh

3919
03:57:01,620 --> 03:57:06,359
um the payload of the execution is

3920
03:57:06,359 --> 03:57:07,520
here

3921
03:57:07,520 --> 03:57:11,460
and I'm showing this this payload here

3922
03:57:11,460 --> 03:57:13,739
the first time after the fixing

3923
03:57:13,739 --> 03:57:15,120
so

3924
03:57:15,120 --> 03:57:18,479
right now we have a access to the sap

3925
03:57:18,479 --> 03:57:22,680
application server as I mean we can read

3926
03:57:22,680 --> 03:57:25,460
the files from this API application okay

3927
03:57:25,460 --> 03:57:29,580
then we need to try to escalate our

3928
03:57:29,580 --> 03:57:33,779
privileges in sap to get access to

3929
03:57:33,779 --> 03:57:35,640
another levels

3930
03:57:35,640 --> 03:57:37,979
the Privileges collection number one

3931
03:57:37,979 --> 03:57:40,260
the main thing is that sap is stored

3932
03:57:40,260 --> 03:57:42,000
some critical information in the file

3933
03:57:42,000 --> 03:57:44,880
system and under this screenshot you can

3934
03:57:44,880 --> 03:57:48,239
see two files so extort.preps and sex

3935
03:57:48,239 --> 03:57:50,600
store.key

3936
03:57:50,600 --> 03:57:53,120
sector.properties file

3937
03:57:53,120 --> 03:57:55,859
contains in encrypted mode application

3938
03:57:55,859 --> 03:57:58,439
admin password and gdbc connection

3939
03:57:58,439 --> 03:58:00,899
string with username and password

3940
03:58:00,899 --> 03:58:03,899
as we are in the sap cyber security

3941
03:58:03,899 --> 03:58:06,359
industry over 10 years we know the

3942
03:58:06,359 --> 03:58:08,640
encryption algorithm and of course we

3943
03:58:08,640 --> 03:58:12,300
know we have the key of the encryption

3944
03:58:12,300 --> 03:58:14,279
and the encryption algorithm is the

3945
03:58:14,279 --> 03:58:16,739
triple Dash we decrypt it

3946
03:58:16,739 --> 03:58:19,680
and we got the

3947
03:58:19,680 --> 03:58:24,120
sap admin application password here and

3948
03:58:24,120 --> 03:58:27,720
gdbc connection string okay

3949
03:58:27,720 --> 03:58:32,040
so right now we have a admin user of sap

3950
03:58:32,040 --> 03:58:34,500
application and we could connect to the

3951
03:58:34,500 --> 03:58:36,060
sap database

3952
03:58:36,060 --> 03:58:39,779
so what what's next we need to but if

3953
03:58:39,779 --> 03:58:42,420
you remember the network map we should

3954
03:58:42,420 --> 03:58:44,699
compromise the sap cloud

3955
03:58:44,699 --> 03:58:49,220
we try to escalate our privileges again

3956
03:58:49,220 --> 03:58:53,699
we escalate privileges by two ways I

3957
03:58:53,699 --> 03:58:55,859
will show you here the first way because

3958
03:58:55,859 --> 03:58:58,500
the second way still is not fixed by sap

3959
03:58:58,500 --> 03:59:02,939
and I could show it here you can we

3960
03:59:02,939 --> 03:59:06,800
analyzed the exist other vulnerabilities

3961
03:59:06,800 --> 03:59:12,600
and we found CV 2021 from 2021 and as

3962
03:59:12,600 --> 03:59:15,359
you can see from the screenshot the

3963
03:59:15,359 --> 03:59:17,819
for execution this vulnerability you

3964
03:59:17,819 --> 03:59:21,960
need to have privilege uh high but we

3965
03:59:21,960 --> 03:59:24,960
already have it okay so

3966
03:59:24,960 --> 03:59:28,620
if the sap admins is not updated this

3967
03:59:28,620 --> 03:59:31,020
component it means that we can execute

3968
03:59:31,020 --> 03:59:34,080
this vulnerability also

3969
03:59:34,080 --> 03:59:36,779
um again we download this component we

3970
03:59:36,779 --> 03:59:41,520
made a diff and we found that the sap

3971
03:59:41,520 --> 03:59:43,260
fixed

3972
03:59:43,260 --> 03:59:45,300
the vulnerability in handle save

3973
03:59:45,300 --> 03:59:49,020
function by uploading some file

3974
03:59:49,020 --> 03:59:51,720
and they are checking dot JSP in

3975
03:59:51,720 --> 03:59:54,960
lowercase and Dot JSP in uppercase

3976
03:59:54,960 --> 03:59:59,340
file extension a small tip

3977
03:59:59,340 --> 04:00:03,060
tipping trick from me if you have some

3978
04:00:03,060 --> 04:00:05,399
Java application and you are trying to

3979
04:00:05,399 --> 04:00:07,859
upload the GSP file and the Java

3980
04:00:07,859 --> 04:00:11,060
application is telling you hey you can't

3981
04:00:11,060 --> 04:00:15,180
upload.gsp try to upload with uppercases

3982
04:00:15,180 --> 04:00:17,960
it can be work

3983
04:00:18,420 --> 04:00:19,319
um you

3984
04:00:19,319 --> 04:00:22,920
information we of the vulnerable servlet

3985
04:00:22,920 --> 04:00:26,100
name function and others we built the

3986
04:00:26,100 --> 04:00:27,899
proof of concept

3987
04:00:27,899 --> 04:00:30,600
and again I I'm showing the proof of

3988
04:00:30,600 --> 04:00:34,439
concept first time after the fixing and

3989
04:00:34,439 --> 04:00:37,620
we sent that this the following HTTP

3990
04:00:37,620 --> 04:00:41,520
request to the sap server and it works

3991
04:00:41,520 --> 04:00:43,620
it works sorry

3992
04:00:43,620 --> 04:00:45,420
um

3993
04:00:45,420 --> 04:00:48,300
here we can see that we executed the

3994
04:00:48,300 --> 04:00:50,520
tasks list command

3995
04:00:50,520 --> 04:00:55,580
and we can right now we can execute the

3996
04:00:55,580 --> 04:00:59,520
command in the sap servers but

3997
04:00:59,520 --> 04:01:01,560
if you see the screenshot on the shell

3998
04:01:01,560 --> 04:01:03,779
script is not displaying the username of

3999
04:01:03,779 --> 04:01:06,239
soft processes it means that the user

4000
04:01:06,239 --> 04:01:08,699
which running our shell script doesn't

4001
04:01:08,699 --> 04:01:11,220
have enough privileges to show that info

4002
04:01:11,220 --> 04:01:12,899
right

4003
04:01:12,899 --> 04:01:15,720
so what what we need to do

4004
04:01:15,720 --> 04:01:19,580
we need to escalate privileges again

4005
04:01:20,340 --> 04:01:21,420
um

4006
04:01:21,420 --> 04:01:22,620
after

4007
04:01:22,620 --> 04:01:26,040
um we we started to analyze the sap

4008
04:01:26,040 --> 04:01:28,380
processes by Proto soccer

4009
04:01:28,380 --> 04:01:32,100
and we discovered three processes

4010
04:01:32,100 --> 04:01:34,920
that

4011
04:01:34,920 --> 04:01:35,699
um

4012
04:01:35,699 --> 04:01:39,500
running under system user okay

4013
04:01:39,500 --> 04:01:42,300
for us interesting was the following

4014
04:01:42,300 --> 04:01:47,040
processes sap host exec and sap OS call

4015
04:01:47,040 --> 04:01:51,239
exit files processes sorry

4016
04:01:51,239 --> 04:01:52,199
um

4017
04:01:52,199 --> 04:01:53,699
we

4018
04:01:53,699 --> 04:01:56,880
use the process monitor for

4019
04:01:56,880 --> 04:02:00,060
uh tracking the activities of that that

4020
04:02:00,060 --> 04:02:03,060
processes and

4021
04:02:03,060 --> 04:02:05,939
um we started to analyze and we started

4022
04:02:05,939 --> 04:02:07,380
to

4023
04:02:07,380 --> 04:02:09,540
um tracking what kind of file they're

4024
04:02:09,540 --> 04:02:13,560
creating executing modifying Etc

4025
04:02:13,560 --> 04:02:15,359
and we saw that there are a few

4026
04:02:15,359 --> 04:02:17,640
activities but the most interesting was

4027
04:02:17,640 --> 04:02:23,279
that the sap host exec process this one

4028
04:02:23,279 --> 04:02:27,439
is executing every two minutes sapci

4029
04:02:27,439 --> 04:02:30,120
mb.process.exe process after analyzing

4030
04:02:30,120 --> 04:02:32,699
permissions of that file we found out

4031
04:02:32,699 --> 04:02:36,359
that many user sorry any user from the

4032
04:02:36,359 --> 04:02:39,720
operation system of sap server could

4033
04:02:39,720 --> 04:02:42,840
delete that file and write file by this

4034
04:02:42,840 --> 04:02:46,020
name in the folder so what we did

4035
04:02:46,020 --> 04:02:47,760
we built

4036
04:02:47,760 --> 04:02:51,060
who created the Shell Code in.net built

4037
04:02:51,060 --> 04:02:53,100
and uploaded to the Windows machine

4038
04:02:53,100 --> 04:02:56,120
the Shell Code was opened

4039
04:02:56,120 --> 04:02:59,580
should open the port 444 listen any

4040
04:02:59,580 --> 04:03:01,920
interface and when he received the

4041
04:03:01,920 --> 04:03:03,960
commands he should execute that command

4042
04:03:03,960 --> 04:03:05,220
by CMD

4043
04:03:05,220 --> 04:03:07,340
okay we'll upload that file and we

4044
04:03:07,340 --> 04:03:11,120
replace the sap

4045
04:03:11,120 --> 04:03:13,439
cimb.xf file

4046
04:03:13,439 --> 04:03:16,020
and it worked

4047
04:03:16,020 --> 04:03:21,979
the sap host exec is executed our shell

4048
04:03:21,979 --> 04:03:26,479
file and I don't know why I don't know

4049
04:03:26,479 --> 04:03:30,060
what was wrong but our shell file was

4050
04:03:30,060 --> 04:03:34,819
has been signed but by sapse

4051
04:03:35,880 --> 04:03:39,180
maybe it come from sap maybe it's back

4052
04:03:39,180 --> 04:03:42,899
in process hacker I need to investigate

4053
04:03:42,899 --> 04:03:45,300
but

4054
04:03:45,300 --> 04:03:47,840
you can see the

4055
04:03:47,840 --> 04:03:50,399
in the screenshot that our shell script

4056
04:03:50,399 --> 04:03:52,319
has been signed

4057
04:03:52,319 --> 04:03:55,220
so after the executing netcat

4058
04:03:55,220 --> 04:03:58,739
netstat sorry you can see that Port has

4059
04:03:58,739 --> 04:03:59,819
been open

4060
04:03:59,819 --> 04:04:03,199
and we should we could connect to that

4061
04:04:03,199 --> 04:04:07,560
shell and execute it with my command and

4062
04:04:07,560 --> 04:04:09,180
yeah where system

4063
04:04:09,180 --> 04:04:10,800
so that's it

4064
04:04:10,800 --> 04:04:12,840
but

4065
04:04:12,840 --> 04:04:13,620
um

4066
04:04:13,620 --> 04:04:15,720
again you remember that we should

4067
04:04:15,720 --> 04:04:18,739
compromise the sap Cloud right

4068
04:04:18,739 --> 04:04:21,960
we need to jump to the from the one of

4069
04:04:21,960 --> 04:04:26,040
the sap sap servers here from sap Java

4070
04:04:26,040 --> 04:04:28,739
to Cloud connector

4071
04:04:28,739 --> 04:04:32,060
uh to do that we decided to

4072
04:04:32,060 --> 04:04:36,979
dump memory of LSS process

4073
04:04:36,979 --> 04:04:40,800
our customers say that we couldn't as we

4074
04:04:40,800 --> 04:04:43,880
are system we could disable the

4075
04:04:43,880 --> 04:04:47,520
Microsoft antivirus and use mimikas

4076
04:04:47,520 --> 04:04:50,520
there but he said we couldn't disable

4077
04:04:50,520 --> 04:04:54,000
the antivirus we couldn't extract the

4078
04:04:54,000 --> 04:04:55,760
jump to our

4079
04:04:55,760 --> 04:04:58,920
Windows machine to analyze that dump so

4080
04:04:58,920 --> 04:05:00,979
uh

4081
04:05:00,979 --> 04:05:05,399
we had another way only we downloaded

4082
04:05:05,399 --> 04:05:07,500
the

4083
04:05:07,500 --> 04:05:09,500
um

4084
04:05:09,920 --> 04:05:13,920
c-sharp mini dump from the GitHub and

4085
04:05:13,920 --> 04:05:15,840
build that program

4086
04:05:15,840 --> 04:05:18,020
to dump the process

4087
04:05:18,020 --> 04:05:21,420
the dump memory of the lsas process

4088
04:05:21,420 --> 04:05:22,620
right

4089
04:05:22,620 --> 04:05:24,000
but

4090
04:05:24,000 --> 04:05:26,399
of course this program is detected by

4091
04:05:26,399 --> 04:05:29,760
antivirus and by any antivirus included

4092
04:05:29,760 --> 04:05:32,399
Microsoft antivirus so we try to modify

4093
04:05:32,399 --> 04:05:33,779
that file

4094
04:05:33,779 --> 04:05:36,720
and the source code of the

4095
04:05:36,720 --> 04:05:39,239
sharp mini dump we modified it we

4096
04:05:39,239 --> 04:05:43,080
replied some screen strings we replace

4097
04:05:43,080 --> 04:05:46,859
strings by Charles Rice we compiled

4098
04:05:46,859 --> 04:05:49,500
again and uh

4099
04:05:49,500 --> 04:05:52,080
we again has been detected by Microsoft

4100
04:05:52,080 --> 04:05:55,680
antivirus and you know the bypass was so

4101
04:05:55,680 --> 04:05:56,640
beautiful

4102
04:05:56,640 --> 04:05:58,319
we just

4103
04:05:58,319 --> 04:06:04,439
uh set some file extension uh to we we

4104
04:06:04,439 --> 04:06:07,800
used file extension that is not has been

4105
04:06:07,800 --> 04:06:10,020
registered in videos machine

4106
04:06:10,020 --> 04:06:14,180
and we executed by CMD C minidump

4107
04:06:14,180 --> 04:06:18,180
bypassmas.exe dot PPP and it has been

4108
04:06:18,180 --> 04:06:21,120
executed and he dumped the password and

4109
04:06:21,120 --> 04:06:25,260
hashes of the processes okay

4110
04:06:25,260 --> 04:06:29,460
so after that we had

4111
04:06:29,460 --> 04:06:31,439
the

4112
04:06:31,439 --> 04:06:33,359
uh

4113
04:06:33,359 --> 04:06:35,640
admin users and password from

4114
04:06:35,640 --> 04:06:40,020
application and from operation system

4115
04:06:40,020 --> 04:06:43,220
and right now we should jump to the mic

4116
04:06:43,220 --> 04:06:46,439
sap Cloud connector sorry

4117
04:06:46,439 --> 04:06:49,560
and you know how we jump uh it was so

4118
04:06:49,560 --> 04:06:50,660
easy

4119
04:06:50,660 --> 04:06:52,220
because

4120
04:06:52,220 --> 04:06:55,380
in the last game there was over 100 sap

4121
04:06:55,380 --> 04:06:56,640
servers

4122
04:06:56,640 --> 04:06:59,899
and the sap admin said

4123
04:06:59,899 --> 04:07:02,220
the same password for all the sap

4124
04:07:02,220 --> 04:07:03,840
servers landscape

4125
04:07:03,840 --> 04:07:07,319
so we jump to the sap Cloud connector

4126
04:07:07,319 --> 04:07:11,460
we connected to sap Cloud connector by

4127
04:07:11,460 --> 04:07:14,819
SSH and started to analyze the system

4128
04:07:14,819 --> 04:07:18,479
as the sap cc is based on the page

4129
04:07:18,479 --> 04:07:22,560
Tomcat the password was in users.xml

4130
04:07:22,560 --> 04:07:23,580
file

4131
04:07:23,580 --> 04:07:24,660
here

4132
04:07:24,660 --> 04:07:27,540
in Hessian mode in hershit mode

4133
04:07:27,540 --> 04:07:30,600
so we continue to analyze the system to

4134
04:07:30,600 --> 04:07:32,880
get other ways how it's possible to

4135
04:07:32,880 --> 04:07:35,460
discover the password

4136
04:07:35,460 --> 04:07:40,500
um we found sap ssfs file the ssfs it's

4137
04:07:40,500 --> 04:07:44,060
a modern sap

4138
04:07:44,399 --> 04:07:46,620
a Secure Storage

4139
04:07:46,620 --> 04:07:48,479
and

4140
04:07:48,479 --> 04:07:49,260
um

4141
04:07:49,260 --> 04:07:52,319
which we should try to decrypt this

4142
04:07:52,319 --> 04:07:54,920
Secure Storage

4143
04:07:56,520 --> 04:07:57,420
um

4144
04:07:57,420 --> 04:07:59,840
after some researching

4145
04:07:59,840 --> 04:08:03,899
of ssfs structure for sapcc we found

4146
04:08:03,899 --> 04:08:05,939
that

4147
04:08:05,939 --> 04:08:10,199
the sapcc ssfs contains the following

4148
04:08:10,199 --> 04:08:12,060
properties should contain the following

4149
04:08:12,060 --> 04:08:13,199
properties

4150
04:08:13,199 --> 04:08:14,720
but

4151
04:08:14,720 --> 04:08:17,819
the encryption algorithm has been

4152
04:08:17,819 --> 04:08:20,460
written in binary files and reversing

4153
04:08:20,460 --> 04:08:22,680
that binary files can be take a long

4154
04:08:22,680 --> 04:08:24,180
time for us

4155
04:08:24,180 --> 04:08:26,160
and we

4156
04:08:26,160 --> 04:08:28,279
choose another way

4157
04:08:28,279 --> 04:08:31,760
uh we

4158
04:08:31,760 --> 04:08:37,100
with so that there are leap sap

4159
04:08:37,100 --> 04:08:39,600
scc20jni.so file

4160
04:08:39,600 --> 04:08:42,359
and that file had

4161
04:08:42,359 --> 04:08:44,460
one exported function

4162
04:08:44,460 --> 04:08:48,420
sex store access get record

4163
04:08:48,420 --> 04:08:52,620
and what we did we just used that so

4164
04:08:52,620 --> 04:08:54,060
Library

4165
04:08:54,060 --> 04:08:59,778
as a native function here

4166
04:09:00,060 --> 04:09:05,580
we use that function in our mini Java

4167
04:09:05,580 --> 04:09:08,399
got and

4168
04:09:08,399 --> 04:09:09,300
um

4169
04:09:09,300 --> 04:09:11,460
as argument we passed the properties

4170
04:09:11,460 --> 04:09:13,500
that we discovered

4171
04:09:13,500 --> 04:09:16,080
this one and this one and we got

4172
04:09:16,080 --> 04:09:19,380
the password for Java case storage and

4173
04:09:19,380 --> 04:09:21,660
admin

4174
04:09:21,660 --> 04:09:26,699
password for the sap Cloud connector

4175
04:09:26,699 --> 04:09:30,840
so what next we open the sap Cloud

4176
04:09:30,840 --> 04:09:33,600
connector UI

4177
04:09:33,600 --> 04:09:36,479
and log in there and right now we can

4178
04:09:36,479 --> 04:09:38,939
manage the sap

4179
04:09:38,939 --> 04:09:41,460
um connections we can move the traffic

4180
04:09:41,460 --> 04:09:43,920
from the cloud to our servers or we can

4181
04:09:43,920 --> 04:09:46,739
move traffic from on-premises systems to

4182
04:09:46,739 --> 04:09:49,739
ours to our another server and we can

4183
04:09:49,739 --> 04:09:51,359
manage the traffic we can listen the

4184
04:09:51,359 --> 04:09:53,160
traffic we can discover some private

4185
04:09:53,160 --> 04:09:54,359
info

4186
04:09:54,359 --> 04:09:56,540
Etc

4187
04:09:56,880 --> 04:09:57,479
um

4188
04:09:57,479 --> 04:09:59,580
so as a conclusion

4189
04:09:59,580 --> 04:10:03,720
you the sap admins should install the

4190
04:10:03,720 --> 04:10:04,920
sap

4191
04:10:04,920 --> 04:10:08,600
security notes that we discovered and

4192
04:10:08,600 --> 04:10:13,140
they shouldn't use the same password for

4193
04:10:13,140 --> 04:10:15,080
sap

4194
04:10:15,080 --> 04:10:17,520
operation systems they should use

4195
04:10:17,520 --> 04:10:19,140
different passwords for different

4196
04:10:19,140 --> 04:10:22,500
systems I know it can be so hard for the

4197
04:10:22,500 --> 04:10:25,680
admins but it's another is the is the

4198
04:10:25,680 --> 04:10:30,660
one way for protecting the sap servers

4199
04:10:30,660 --> 04:10:33,899
for password reuse attack

4200
04:10:33,899 --> 04:10:36,899
so that's it thank you if you have any

4201
04:10:36,899 --> 04:10:38,810
questions

4202
04:10:38,810 --> 04:10:45,769
[Applause]

4203
04:10:48,020 --> 04:10:50,279
all right folks you know how this works

4204
04:10:50,279 --> 04:10:51,300
at this point

4205
04:10:51,300 --> 04:10:53,160
um priority to anyone who submits via

4206
04:10:53,160 --> 04:10:56,220
slido will also give it a couple minutes

4207
04:10:56,220 --> 04:10:59,699
and if anyone is feeling brave you can

4208
04:10:59,699 --> 04:11:03,500
also ask and I will repeat the question

4209
04:11:08,399 --> 04:11:10,380
so I refresh

4210
04:11:10,380 --> 04:11:12,120
it's supposed to be real time it's not

4211
04:11:12,120 --> 04:11:14,160
that real time

4212
04:11:14,160 --> 04:11:16,640
okay

4213
04:11:27,439 --> 04:11:30,660
anyone with questions

4214
04:11:30,660 --> 04:11:33,140
I'm gonna

4215
04:11:33,660 --> 04:11:37,279
call it a day shortly

4216
04:11:38,100 --> 04:11:39,840
all right

4217
04:11:39,840 --> 04:11:41,220
um I guess we we're done in this track

4218
04:11:41,220 --> 04:11:43,140
for the day thank you again so much it's

4219
04:11:43,140 --> 04:11:44,939
a pleasure having you and thanks for

4220
04:11:44,939 --> 04:11:46,020
walking us through that that was

4221
04:11:46,020 --> 04:11:46,990
excellent

4222
04:11:46,990 --> 04:11:51,660
[Applause]

4223
04:11:53,070 --> 04:11:58,080
[Music]

4224
04:11:58,080 --> 04:12:00,199
thank you

4225
04:12:05,410 --> 04:12:15,289
[Music]

4226
04:12:20,160 --> 04:12:32,610
[Music]

4227
04:12:34,780 --> 04:12:38,129
[Music]

4228
04:12:40,400 --> 04:12:43,609
[Music]

4229
04:12:48,070 --> 04:13:15,620
[Music]

4230
04:13:15,620 --> 04:13:18,979
come on there

4231
04:13:19,070 --> 04:13:23,270
[Music]

4232
04:13:23,399 --> 04:13:26,399
foreign

4233
04:13:30,740 --> 04:13:33,780
[Music]

4234
04:13:39,580 --> 04:13:43,600
[Music]

4235
04:13:45,990 --> 04:13:49,910
[Music]

4236
04:13:53,340 --> 04:14:13,680
[Music]

4237
04:14:13,680 --> 04:14:15,800
thank you

4238
04:14:16,100 --> 04:14:30,299
[Music]

4239
04:14:32,630 --> 04:14:35,880
[Music]

4240
04:14:35,880 --> 04:14:37,430
foreign

4241
04:14:37,430 --> 04:14:40,639
[Music]

4242
04:14:45,830 --> 04:14:53,940
[Music]

4243
04:15:00,160 --> 04:15:12,600
[Music]

4244
04:15:14,820 --> 04:15:23,270
[Music]

4245
04:15:27,090 --> 04:15:31,430
[Music]

4246
04:15:38,750 --> 04:15:41,520
[Music]

4247
04:15:41,520 --> 04:15:44,070
foreign

4248
04:15:44,070 --> 04:15:53,249
[Music]

4249
04:15:55,580 --> 04:15:58,939
come on there

4250
04:15:59,080 --> 04:16:14,280
[Music]

4251
04:16:20,790 --> 04:16:23,879
[Music]

4252
04:16:26,730 --> 04:16:29,910
[Music]

4253
04:16:35,980 --> 04:16:41,880
[Music]

4254
04:16:41,880 --> 04:16:43,800
thank you

4255
04:16:43,800 --> 04:17:01,560
[Music]

4256
04:17:01,560 --> 04:17:03,080
foreign

4257
04:17:03,080 --> 04:17:10,289
[Music]

4258
04:17:13,750 --> 04:17:19,500
[Music]

4259
04:17:19,500 --> 04:17:22,500
foreign

