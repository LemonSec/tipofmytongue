1
00:00:00,000 --> 00:00:04,259
with the differences between hybrid and

2
00:00:01,620 --> 00:00:07,470
native and having one address for<font color="#E5E5E5"> l2</font>

3
00:00:04,259 --> 00:00:11,370
management and a separate address for l3

4
00:00:07,470 --> 00:00:13,040
management became absolute<font color="#CCCCCC"> ech our</font><font color="#E5E5E5"> lower</font>

5
00:00:11,370 --> 00:00:15,799
<font color="#E5E5E5">level operations staff would get lost</font>

6
00:00:13,040 --> 00:00:19,890
couldn't find their way through<font color="#E5E5E5"> the box</font>

7
00:00:15,800 --> 00:00:23,970
it's got some<font color="#E5E5E5"> value in what it offers to</font>

8
00:00:19,890 --> 00:00:26,400
you but for<font color="#E5E5E5"> us it just didn't work we</font>

9
00:00:23,970 --> 00:00:28,919
also did a lot of router to switch

10
00:00:26,400 --> 00:00:31,409
consolidation and then trunked it over

11
00:00:28,920 --> 00:00:34,250
to a switch where our colocation room

12
00:00:31,410 --> 00:00:37,290
was<font color="#CCCCCC"> two then</font><font color="#E5E5E5"> fan out to the customers</font>

13
00:00:34,250 --> 00:00:39,570
again the router port always looks like

14
00:00:37,290 --> 00:00:42,989
it's up so the operation staff thinks

15
00:00:39,570 --> 00:00:45,539
there can't be a problem and it just

16
00:00:42,989 --> 00:00:48,000
<font color="#E5E5E5">complicated the troubleshooting for our</font>

17
00:00:45,539 --> 00:00:49,789
NOC staff so where the opportunity

18
00:00:48,000 --> 00:00:54,420
presents we continue to get rid of this

19
00:00:49,789 --> 00:00:56,640
anywhere and everywhere possible so on

20
00:00:54,420 --> 00:00:58,770
the topic of<font color="#E5E5E5"> hardware complexity once</font>

21
00:00:56,640 --> 00:01:00,809
you grow beyond a single router you'll

22
00:00:58,770 --> 00:01:04,019
likely find you need to<font color="#E5E5E5"> become an expert</font>

23
00:01:00,809 --> 00:01:06,090
in<font color="#CCCCCC"> what you've got</font><font color="#E5E5E5"> plan for this we made</font>

24
00:01:04,019 --> 00:01:09,090
the mistake of throwing 7507 s into our

25
00:01:06,090 --> 00:01:10,680
network before we really knew the

26
00:01:09,090 --> 00:01:13,200
typical failure modes of VIP tues

27
00:01:10,680 --> 00:01:16,170
because they're<font color="#E5E5E5"> not ECC memory they like</font>

28
00:01:13,200 --> 00:01:18,479
to crash on you becoming<font color="#E5E5E5"> very familiar</font>

29
00:01:16,170 --> 00:01:21,350
with troubleshooting charts made our

30
00:01:18,479 --> 00:01:24,740
life real easy maybe<font color="#E5E5E5"> not necessarily</font>

31
00:01:21,350 --> 00:01:27,179
recovering from the crash but at least

32
00:01:24,740 --> 00:01:30,509
beating up on vendors to get replacement

33
00:01:27,180 --> 00:01:31,799
memory shipped out where appropriate boy

34
00:01:30,509 --> 00:01:35,640
do we have a lot of lessons to learn

35
00:01:31,799 --> 00:01:37,079
about GSR engines boy was a surprise to

36
00:01:35,640 --> 00:01:39,960
find out that engine one can't do

37
00:01:37,079 --> 00:01:42,270
priority queuing and then obviously line

38
00:01:39,960 --> 00:01:45,329
cards and<font color="#E5E5E5"> add a quick disclaimer I</font>

39
00:01:42,270 --> 00:01:46,740
apologize we are a cisco only shop we're

40
00:01:45,329 --> 00:01:48,389
small enough and<font color="#CCCCCC"> just</font><font color="#E5E5E5"> don't have the</font>

41
00:01:46,740 --> 00:01:52,079
development<font color="#E5E5E5"> budget to do much</font>

42
00:01:48,390 --> 00:01:56,310
experimentation we kind of live<font color="#CCCCCC"> on the</font>

43
00:01:52,079 --> 00:02:00,179
not at the just in time but<font color="#E5E5E5"> the wing</font>

44
00:01:56,310 --> 00:02:02,969
into two weeks ago method so design your

45
00:02:00,180 --> 00:02:05,310
network as you're starting<font color="#CCCCCC"> from</font><font color="#E5E5E5"> a small</font>

46
00:02:02,969 --> 00:02:07,979
<font color="#E5E5E5">network and moving your way up one box</font>

47
00:02:05,310 --> 00:02:10,160
per pop probably doesn't work when<font color="#E5E5E5"> I</font>

48
00:02:07,979 --> 00:02:12,700
came on<font color="#E5E5E5"> board everything was</font><font color="#CCCCCC"> riverstone</font>

49
00:02:10,160 --> 00:02:16,060
flow-based forwarding just wasn't

50
00:02:12,700 --> 00:02:19,349
fun thing for port foot scans were

51
00:02:16,060 --> 00:02:21,819
terrible on us we tried doing

52
00:02:19,349 --> 00:02:24,488
distributed forwarding but found that

53
00:02:21,819 --> 00:02:26,109
<font color="#E5E5E5">the older cards we had would only handle</font>

54
00:02:24,489 --> 00:02:28,390
hundred thousand routes and they didn't

55
00:02:26,110 --> 00:02:31,180
know<font color="#E5E5E5"> what to do with the prefixes that</font>

56
00:02:28,390 --> 00:02:33,179
didn't fit in be consistent where you

57
00:02:31,180 --> 00:02:36,310
can but don't<font color="#E5E5E5"> make everything fit a mold</font>

58
00:02:33,180 --> 00:02:38,019
we did way too much<font color="#E5E5E5"> of trying to do</font>

59
00:02:36,310 --> 00:02:40,510
<font color="#CCCCCC">everything with</font><font color="#E5E5E5"> the same size router and</font>

60
00:02:38,019 --> 00:02:43,680
we're getting<font color="#CCCCCC"> better</font><font color="#E5E5E5"> now at picking the</font>

61
00:02:40,510 --> 00:02:47,319
<font color="#E5E5E5">right sized box for what we're doing</font>

62
00:02:43,680 --> 00:02:51,819
core network design we started off with

63
00:02:47,319 --> 00:02:53,560
<font color="#E5E5E5">two core routers per pop and that's kind</font>

64
00:02:51,819 --> 00:02:55,530
of what was worked well for us but the

65
00:02:53,560 --> 00:02:58,060
architecture is shifted a little bit

66
00:02:55,530 --> 00:02:59,590
you'll need more core routers when

67
00:02:58,060 --> 00:03:03,579
you've outgrown this presentation this

68
00:02:59,590 --> 00:03:05,620
<font color="#E5E5E5">is for small operators yeah whatever</font>

69
00:03:03,579 --> 00:03:09,130
size you feel is small but it works for

70
00:03:05,620 --> 00:03:12,400
us so by going<font color="#E5E5E5"> to a routed model think</font>

71
00:03:09,130 --> 00:03:17,560
<font color="#CCCCCC">its last 30 years / 31 / link if you're</font>

72
00:03:12,400 --> 00:03:21,130
doing<font color="#CCCCCC"> two core layer 2 switches we ran</font>

73
00:03:17,560 --> 00:03:22,540
into a lot<font color="#E5E5E5"> of pitfalls on this so</font>

74
00:03:21,130 --> 00:03:26,500
referring to the two<font color="#CCCCCC"> correll two</font>

75
00:03:22,540 --> 00:03:28,690
switches here's an idea we found<font color="#E5E5E5"> that</font>

76
00:03:26,500 --> 00:03:30,819
the capacity scaling was just a

77
00:03:28,690 --> 00:03:32,410
challenge if you had some of these links

78
00:03:30,819 --> 00:03:35,649
as gigabit and some of these links as

79
00:03:32,410 --> 00:03:38,470
fast ethernet you'd have queuing issues

80
00:03:35,650 --> 00:03:41,829
in the switch routers wouldn't know

81
00:03:38,470 --> 00:03:43,989
where to send traffic intelligently you

82
00:03:41,829 --> 00:03:46,060
<font color="#E5E5E5">also have strange failure modes as links</font>

83
00:03:43,989 --> 00:03:49,329
go down especially<font color="#E5E5E5"> to random links one</font>

84
00:03:46,060 --> 00:03:50,560
on one switch one on another you just

85
00:03:49,329 --> 00:03:55,299
don't know where your transit traffic is

86
00:03:50,560 --> 00:03:58,299
going<font color="#E5E5E5"> to end up so as we move to the two</font>

87
00:03:55,299 --> 00:04:01,680
<font color="#CCCCCC">cool routers per pop so you have</font>

88
00:03:58,299 --> 00:04:03,849
convergence issues and troubleshooting

89
00:04:01,680 --> 00:04:06,609
we ended up with two core routers that

90
00:04:03,849 --> 00:04:09,459
connect to<font color="#E5E5E5"> each other we try wherever</font>

91
00:04:06,609 --> 00:04:12,840
possible to do two links between the two

92
00:04:09,459 --> 00:04:15,400
core routers preferably card independent

93
00:04:12,840 --> 00:04:17,310
<font color="#CCCCCC">Murphy lives in</font><font color="#E5E5E5"> our walls and we try to</font>

94
00:04:15,400 --> 00:04:19,510
do what we<font color="#CCCCCC"> can to beat them back</font>

95
00:04:17,310 --> 00:04:21,940
downstream connectivity on what we

96
00:04:19,510 --> 00:04:23,560
termed distribution routers each of

97
00:04:21,940 --> 00:04:25,990
those distribution routers connects to

98
00:04:23,560 --> 00:04:26,500
both core routers and nothing else in

99
00:04:25,990 --> 00:04:29,530
the pie

100
00:04:26,500 --> 00:04:31,570
directly our upstream connectivity where

101
00:04:29,530 --> 00:04:33,520
we were getting connectivity is on what

102
00:04:31,570 --> 00:04:35,440
we termed edge routers everybody's got

103
00:04:33,520 --> 00:04:38,169
their own vocabulary but going forward

104
00:04:35,440 --> 00:04:40,540
this<font color="#E5E5E5"> is our reference again each edge</font>

105
00:04:38,170 --> 00:04:43,480
router connects to both core routers and

106
00:04:40,540 --> 00:04:46,860
nothing else in the pop and then the pop

107
00:04:43,480 --> 00:04:50,650
to pop links your<font color="#E5E5E5"> when links per se</font>

108
00:04:46,860 --> 00:04:54,790
connected on our core routers so there's

109
00:04:50,650 --> 00:04:56,739
a diagram of<font color="#E5E5E5"> the connectivity try to be</font>

110
00:04:54,790 --> 00:04:58,120
a lazy guy draw on the link between<font color="#E5E5E5"> the</font>

111
00:04:56,740 --> 00:05:02,230
two cool routers but you can see<font color="#E5E5E5"> how it</font>

112
00:04:58,120 --> 00:05:05,230
<font color="#CCCCCC">goes</font><font color="#E5E5E5"> each of the links you see would be</font>

113
00:05:02,230 --> 00:05:09,100
a / 30 years last 31 scaled a lot<font color="#E5E5E5"> battle</font>

114
00:05:05,230 --> 00:05:10,720
better for us but in the<font color="#E5E5E5"> beginning we</font>

115
00:05:09,100 --> 00:05:13,270
made the mistake of trying to do<font color="#CCCCCC"> all of</font>

116
00:05:10,720 --> 00:05:17,290
our core routing and all of our<font color="#E5E5E5"> upstream</font>

117
00:05:13,270 --> 00:05:19,000
connectivity on our core routers got us

118
00:05:17,290 --> 00:05:23,169
going but we ran into<font color="#E5E5E5"> an interesting</font>

119
00:05:19,000 --> 00:05:26,440
pitfall in the iOS<font color="#CCCCCC"> bgp path selection</font>

120
00:05:23,169 --> 00:05:29,830
algorithm where rule 9 says prefer your

121
00:05:26,440 --> 00:05:31,930
external bgp path over your internal bgp

122
00:05:29,830 --> 00:05:34,630
path if it's<font color="#E5E5E5"> not already selected</font>

123
00:05:31,930 --> 00:05:37,840
earlier which meant that our inter pop

124
00:05:34,630 --> 00:05:40,390
traffic left but logically closest link

125
00:05:37,840 --> 00:05:42,940
unless another link was drastically

126
00:05:40,390 --> 00:05:45,700
better so here's a diagram of<font color="#E5E5E5"> our old</font>

127
00:05:42,940 --> 00:05:48,969
method if traffic and city<font color="#E5E5E5"> two was</font>

128
00:05:45,700 --> 00:05:52,719
heading perhaps for the right side cloud

129
00:05:48,970 --> 00:05:53,950
it would get on to core<font color="#E5E5E5"> one and core one</font>

130
00:05:52,720 --> 00:05:55,750
would say I'm going<font color="#E5E5E5"> to prefer an</font>

131
00:05:53,950 --> 00:05:58,180
external path and I'm going<font color="#E5E5E5"> to send it</font>

132
00:05:55,750 --> 00:05:59,860
out to this direction it made a lot<font color="#E5E5E5"> of</font>

133
00:05:58,180 --> 00:06:03,550
our traffic tuning an interesting

134
00:05:59,860 --> 00:06:08,169
challenge likewise from City three on

135
00:06:03,550 --> 00:06:11,770
the right so trying to<font color="#E5E5E5"> keep control of</font>

136
00:06:08,169 --> 00:06:14,289
our provider bandwidth utilization was a

137
00:06:11,770 --> 00:06:16,390
game try an iteration see what it did

138
00:06:14,290 --> 00:06:20,169
for us try another iteration try and get

139
00:06:16,390 --> 00:06:23,070
closer so we solved it by bringing<font color="#E5E5E5"> in</font>

140
00:06:20,169 --> 00:06:25,599
edge routers which were theoretically

141
00:06:23,070 --> 00:06:28,690
equidistant from the<font color="#E5E5E5"> core router so</font>

142
00:06:25,600 --> 00:06:31,630
traffic<font color="#E5E5E5"> from city to would come into</font>

143
00:06:28,690 --> 00:06:34,180
core one and it now has<font color="#E5E5E5"> two equidistant</font>

144
00:06:31,630 --> 00:06:36,400
external options about technically

145
00:06:34,180 --> 00:06:38,820
internal options before going out to<font color="#CCCCCC"> the</font>

146
00:06:36,400 --> 00:06:42,299
cloud and that allowed core 12

147
00:06:38,820 --> 00:06:44,700
pick whichever exit path made more sense

148
00:06:42,300 --> 00:06:50,790
rather<font color="#E5E5E5"> than being drastically glued to</font>

149
00:06:44,700 --> 00:06:53,789
the external first as far as<font color="#E5E5E5"> igp design</font>

150
00:06:50,790 --> 00:06:56,640
goes we started<font color="#E5E5E5"> with ospf because we</font>

151
00:06:53,790 --> 00:06:59,910
were working on multi-vendor switched to

152
00:06:56,640 --> 00:07:02,340
is<font color="#E5E5E5"> is on the premise that it would be</font>

153
00:06:59,910 --> 00:07:05,070
more secure because we weren't accepting

154
00:07:02,340 --> 00:07:08,099
<font color="#CCCCCC">sealing us frames externally or from our</font>

155
00:07:05,070 --> 00:07:11,130
customers on a premise that it would be

156
00:07:08,100 --> 00:07:13,820
operationally safer because we do mpls

157
00:07:11,130 --> 00:07:16,380
VPN s we would potentially have

158
00:07:13,820 --> 00:07:20,300
customers wanting to do ospf routing

159
00:07:16,380 --> 00:07:23,219
with us so by having<font color="#E5E5E5"> our</font><font color="#CCCCCC"> operation staff</font>

160
00:07:20,300 --> 00:07:25,470
doing router ospf commands<font color="#E5E5E5"> all the time</font>

161
00:07:23,220 --> 00:07:29,370
they couldn't accidentally stumble into

162
00:07:25,470 --> 00:07:33,480
router ospf<font color="#E5E5E5"> one and fubar our core</font>

163
00:07:29,370 --> 00:07:35,700
routing but<font color="#E5E5E5"> we've found that some</font>

164
00:07:33,480 --> 00:07:37,740
hardware out there doesn't have is<font color="#E5E5E5"> is</font>

165
00:07:35,700 --> 00:07:39,930
support or it's not where we want it to

166
00:07:37,740 --> 00:07:46,080
<font color="#E5E5E5">be so we're starting to plan going back</font>

167
00:07:39,930 --> 00:07:48,630
to ospf either way our lesson was you

168
00:07:46,080 --> 00:07:50,520
want the versatility when you get<font color="#E5E5E5"> into a</font>

169
00:07:48,630 --> 00:07:52,530
scenario where you want mpls traffic

170
00:07:50,520 --> 00:07:55,710
engineering for example you're going to

171
00:07:52,530 --> 00:08:00,719
want ospf or is<font color="#E5E5E5"> is pick what suits for</font>

172
00:07:55,710 --> 00:08:02,159
you eigrp wouldn't do it for<font color="#CCCCCC"> us keep</font>

173
00:08:00,720 --> 00:08:04,200
your eye appeal een it's been in a lot

174
00:08:02,160 --> 00:08:06,180
of lot<font color="#E5E5E5"> of other presentations but it's</font>

175
00:08:04,200 --> 00:08:07,680
made a lot of<font color="#CCCCCC"> sense for us as well keep</font>

176
00:08:06,180 --> 00:08:10,100
everything else in BGP for the

177
00:08:07,680 --> 00:08:13,590
administrative control and the scaling

178
00:08:10,100 --> 00:08:15,890
so credit to<font color="#CCCCCC"> VJ gill and the addn team</font>

179
00:08:13,590 --> 00:08:18,359
we copied their model from a previous

180
00:08:15,890 --> 00:08:20,250
<font color="#CCCCCC">nanulak presentation and found</font>

181
00:08:18,360 --> 00:08:22,920
tremendous simplicity in it as we were

182
00:08:20,250 --> 00:08:25,470
<font color="#E5E5E5">rolling it out we start with a table of</font>

183
00:08:22,920 --> 00:08:27,480
metrics by pipe size and then<font color="#CCCCCC"> Adam</font>

184
00:08:25,470 --> 00:08:30,600
modifier depending on where in the

185
00:08:27,480 --> 00:08:34,050
network that pipe physically exists so

186
00:08:30,600 --> 00:08:36,150
admittedly<font color="#E5E5E5"> we took the long view we have</font>

187
00:08:34,049 --> 00:08:39,228
nothing larger than Gigabit Ethernet but

188
00:08:36,150 --> 00:08:43,890
we plan for<font color="#E5E5E5"> all the way</font><font color="#CCCCCC"> up of what's</font>

189
00:08:39,229 --> 00:08:48,600
current or reasonably forecast this is

190
00:08:43,890 --> 00:08:50,970
the base metric table we use from that

191
00:08:48,600 --> 00:08:51,850
we modify it so that links between core

192
00:08:50,970 --> 00:08:53,920
routers are

193
00:08:51,850 --> 00:08:57,279
trick of one regardless<font color="#E5E5E5"> of their pipe</font>

194
00:08:53,920 --> 00:08:59,560
size a backup core the core link might

195
00:08:57,279 --> 00:09:03,880
be higher it might match the table<font color="#E5E5E5"> but</font>

196
00:08:59,560 --> 00:09:06,339
we tend<font color="#E5E5E5"> to have equal</font><font color="#CCCCCC"> size quarter core</font>

197
00:09:03,880 --> 00:09:09,459
links links from<font color="#E5E5E5"> the court of</font><font color="#CCCCCC"> the edge</font>

198
00:09:06,339 --> 00:09:13,899
or<font color="#CCCCCC"> core</font><font color="#E5E5E5"> distribution</font><font color="#CCCCCC"> are based on the</font>

199
00:09:09,459 --> 00:09:16,599
<font color="#E5E5E5">table plus a value</font><font color="#CCCCCC"> of 500 LAN links are</font>

200
00:09:13,899 --> 00:09:18,279
the value in the table<font color="#E5E5E5"> plus 30 and there</font>

201
00:09:16,600 --> 00:09:24,459
have been<font color="#E5E5E5"> some minor tweaks for bgp</font>

202
00:09:18,279 --> 00:09:27,550
tuning purposes we also use 10,000 plus

203
00:09:24,459 --> 00:09:30,489
the native value to indicate a link

204
00:09:27,550 --> 00:09:34,229
that's being worked on it shifts traffic

205
00:09:30,490 --> 00:09:38,220
off the link for us automatically and

206
00:09:34,230 --> 00:09:40,959
Link metric of 20,000 plus the table

207
00:09:38,220 --> 00:09:44,019
where we are bringing in a new link or

208
00:09:40,959 --> 00:09:47,619
taking one out so there's a little bit

209
00:09:44,019 --> 00:09:49,630
<font color="#E5E5E5">of automatic documentation of what's the</font>

210
00:09:47,620 --> 00:09:53,709
operational status of the link by

211
00:09:49,630 --> 00:09:56,439
looking<font color="#CCCCCC"> at the metric so by using this</font>

212
00:09:53,709 --> 00:09:59,008
metric Design a failure<font color="#CCCCCC"> of the links</font>

213
00:09:56,439 --> 00:10:01,870
between the two core routers in the pot

214
00:09:59,009 --> 00:10:04,480
prevents the transit traffic from going

215
00:10:01,870 --> 00:10:06,779
<font color="#CCCCCC">through an intra pop edge router or</font>

216
00:10:04,480 --> 00:10:09,310
through an intra pop distribution router

217
00:10:06,779 --> 00:10:12,850
traffic will prefer to flow around the

218
00:10:09,310 --> 00:10:15,518
<font color="#E5E5E5">LAN and reason for that is the links</font>

219
00:10:12,850 --> 00:10:18,339
from distich or might not be sized for

220
00:10:15,519 --> 00:10:21,279
the transitory traffic on top of it as

221
00:10:18,339 --> 00:10:23,529
an example<font color="#E5E5E5"> not exactly the scale but</font>

222
00:10:21,279 --> 00:10:26,439
somewhat representing what's going on

223
00:10:23,529 --> 00:10:29,529
our two core routers<font color="#CCCCCC"> have a metric</font><font color="#E5E5E5"> of</font>

224
00:10:26,439 --> 00:10:32,860
one all<font color="#CCCCCC"> the other non core routers in</font>

225
00:10:29,529 --> 00:10:36,310
the pop or a metric<font color="#E5E5E5"> of perhaps 507 a lot</font>

226
00:10:32,860 --> 00:10:39,160
of our stuff was fast ethernet links

227
00:10:36,310 --> 00:10:41,979
from city to city are in the<font color="#CCCCCC"> 30s and</font>

228
00:10:39,160 --> 00:10:45,880
then another city the links from core to

229
00:10:41,980 --> 00:10:48,329
the<font color="#CCCCCC"> outer</font><font color="#E5E5E5"> edge are in the 500s so a loss</font>

230
00:10:45,880 --> 00:10:51,310
of this link in the center prevents

231
00:10:48,329 --> 00:10:53,680
traffic from going through<font color="#E5E5E5"> here it would</font>

232
00:10:51,310 --> 00:10:56,638
much rather find a path around the land

233
00:10:53,680 --> 00:11:00,399
where it could presumably go through

234
00:10:56,639 --> 00:11:02,079
roughly 14 cities before it would find

235
00:11:00,399 --> 00:11:03,640
<font color="#E5E5E5">that that route would be less preferable</font>

236
00:11:02,079 --> 00:11:05,890
than going<font color="#CCCCCC"> through</font>

237
00:11:03,640 --> 00:11:10,630
the local core or the local disk or

238
00:11:05,890 --> 00:11:13,990
local edge some pitfalls of that metric

239
00:11:10,630 --> 00:11:17,170
structure we had links to<font color="#CCCCCC"> 29-14 in</font>

240
00:11:13,990 --> 00:11:20,650
dallas<font color="#E5E5E5"> and in houston the next rule in</font>

241
00:11:17,170 --> 00:11:22,060
BGP path selection for iOS is prefer the

242
00:11:20,650 --> 00:11:24,819
route<font color="#CCCCCC"> that can be reached to the closest</font>

243
00:11:22,060 --> 00:11:29,290
<font color="#CCCCCC">IGP neighbor so I geometrics do factor</font>

244
00:11:24,820 --> 00:11:31,390
in<font color="#E5E5E5"> here and we got bit all of our</font>

245
00:11:29,290 --> 00:11:34,510
connectivity is in dallas in<font color="#CCCCCC"> Houston our</font>

246
00:11:31,390 --> 00:11:37,840
<font color="#E5E5E5">San Antonio pop is connected to Dallas</font>

247
00:11:34,510 --> 00:11:42,090
and connected<font color="#CCCCCC"> to Houston San Antonio</font>

248
00:11:37,840 --> 00:11:45,460
core one went to Dallas and based on<font color="#E5E5E5"> its</font>

249
00:11:42,090 --> 00:11:48,790
<font color="#E5E5E5">BGP table it preferred certain prefixes</font>

250
00:11:45,460 --> 00:11:51,370
through<font color="#CCCCCC"> 29-14 in</font><font color="#E5E5E5"> Dallas core two was</font>

251
00:11:48,790 --> 00:11:54,339
connected to Houston it preferred<font color="#CCCCCC"> 29-14</font>

252
00:11:51,370 --> 00:11:56,260
through Houston and we had some

253
00:11:54,340 --> 00:11:57,760
interesting intercity traffic patterns

254
00:11:56,260 --> 00:12:01,470
that we finally<font color="#E5E5E5"> tracked down to be</font>

255
00:11:57,760 --> 00:12:04,090
because<font color="#CCCCCC"> of GP metric we tweaked some</font>

256
00:12:01,470 --> 00:12:07,240
metrics between the Houston core routers

257
00:12:04,090 --> 00:12:10,540
in Houston edge one where our<font color="#CCCCCC"> 29-14 link</font>

258
00:12:07,240 --> 00:12:12,490
was all of our<font color="#E5E5E5"> San Antonio distribution</font>

259
00:12:10,540 --> 00:12:15,099
routers had<font color="#CCCCCC"> BGP multipath enabled and</font>

260
00:12:12,490 --> 00:12:18,490
went boom running out of RAM on<font color="#CCCCCC"> the VIP</font>

261
00:12:15,100 --> 00:12:19,990
and the RSP simultaneously compounding

262
00:12:18,490 --> 00:12:21,730
the wonderful excitement of that event

263
00:12:19,990 --> 00:12:24,010
was<font color="#CCCCCC"> the fact that our headquarters</font>

264
00:12:21,730 --> 00:12:26,200
office and my desk are connected by<font color="#E5E5E5"> T</font>

265
00:12:24,010 --> 00:12:28,390
ones off of one of those distribution

266
00:12:26,200 --> 00:12:30,130
routers so not only<font color="#E5E5E5"> did the full routers</font>

267
00:12:28,390 --> 00:12:31,420
run under<font color="#CCCCCC"> Ram</font><font color="#E5E5E5"> I lost my ability to look</font>

268
00:12:30,130 --> 00:12:37,330
into the network<font color="#E5E5E5"> and see what was going</font>

269
00:12:31,420 --> 00:12:40,630
on oops so figure out where you really

270
00:12:37,330 --> 00:12:45,190
need<font color="#CCCCCC"> bgb multipath and plan that in your</font>

271
00:12:40,630 --> 00:12:49,380
hardware purchases as well moving<font color="#E5E5E5"> on to</font>

272
00:12:45,190 --> 00:12:52,000
<font color="#E5E5E5">BGP design it's made to scale so use it</font>

273
00:12:49,380 --> 00:12:54,220
we carry all of our customer link

274
00:12:52,000 --> 00:12:55,840
subnets and our customer land subnets

275
00:12:54,220 --> 00:12:58,780
and obviously our external routes in it

276
00:12:55,840 --> 00:13:01,300
it's<font color="#E5E5E5"> got great filtering tools I highly</font>

277
00:12:58,780 --> 00:13:04,060
recommend<font color="#E5E5E5"> you use them we filter at</font>

278
00:13:01,300 --> 00:13:07,120
every point of<font color="#E5E5E5"> ingress and every route</font>

279
00:13:04,060 --> 00:13:09,250
injection point in doing so we imply an

280
00:13:07,120 --> 00:13:12,610
internal community allowing us to

281
00:13:09,250 --> 00:13:15,910
interpret that route rapidly from any

282
00:13:12,610 --> 00:13:17,350
other router in the network some of the

283
00:13:15,910 --> 00:13:19,329
scaling pitfalls that

284
00:13:17,350 --> 00:13:21,850
didn't work<font color="#E5E5E5"> for us we were a</font>

285
00:13:19,330 --> 00:13:23,530
confederation shop I was<font color="#E5E5E5"> the one who</font>

286
00:13:21,850 --> 00:13:25,890
<font color="#E5E5E5">made</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> decisions it looked good to us</font>

287
00:13:23,530 --> 00:13:28,300
in the very beginning it was a<font color="#E5E5E5"> little</font>

288
00:13:25,890 --> 00:13:32,350
easier<font color="#CCCCCC"> to get documentation on it for</font>

289
00:13:28,300 --> 00:13:34,719
<font color="#E5E5E5">the stuff we had but one sub S sub a s /</font>

290
00:13:32,350 --> 00:13:37,630
pop meant<font color="#E5E5E5"> that each router was its own</font>

291
00:13:34,720 --> 00:13:38,950
sub a s convergence was painful because

292
00:13:37,630 --> 00:13:40,660
the routers would end of exchanging the

293
00:13:38,950 --> 00:13:43,630
entire table not just<font color="#CCCCCC"> the best routes</font>

294
00:13:40,660 --> 00:13:45,969
and the sub a s path tried to be an igp

295
00:13:43,630 --> 00:13:48,189
and it'd be<font color="#E5E5E5"> much easier to do it on the</font>

296
00:13:45,970 --> 00:13:51,550
scale of<font color="#E5E5E5"> hundreds of routes rather than</font>

297
00:13:48,190 --> 00:13:56,020
hundreds of thousands of routes so<font color="#CCCCCC"> we</font>

298
00:13:51,550 --> 00:13:58,540
removed<font color="#CCCCCC"> confederations and then deployed</font>

299
00:13:56,020 --> 00:14:01,329
route reflectors and going back<font color="#CCCCCC"> to the</font>

300
00:13:58,540 --> 00:14:04,390
8th edn transition and taking a long

301
00:14:01,330 --> 00:14:07,000
view on our project we disabled client

302
00:14:04,390 --> 00:14:09,699
to client reflection which my

303
00:14:07,000 --> 00:14:14,200
<font color="#E5E5E5">understanding is it helps minimize med</font>

304
00:14:09,700 --> 00:14:15,610
isolations and related funnies and it

305
00:14:14,200 --> 00:14:18,640
allows a little bit better scaling as

306
00:14:15,610 --> 00:14:22,450
you're doing multi path to various

307
00:14:18,640 --> 00:14:24,550
clients or providers so we just

308
00:14:22,450 --> 00:14:27,040
redistribute connected routes into<font color="#CCCCCC"> bgp</font>

309
00:14:24,550 --> 00:14:29,560
we exclude the interfaces that are

310
00:14:27,040 --> 00:14:31,719
already in the<font color="#CCCCCC"> igp and one of the exes</font>

311
00:14:29,560 --> 00:14:34,810
that<font color="#E5E5E5"> we ran into was the route map</font>

312
00:14:31,720 --> 00:14:38,410
handling this was and in many cases

313
00:14:34,810 --> 00:14:41,140
still is written to deny based on

314
00:14:38,410 --> 00:14:43,390
interface name if you<font color="#CCCCCC"> end up with</font><font color="#E5E5E5"> a</font>

315
00:14:41,140 --> 00:14:47,319
failed VIP failed line card whatever

316
00:14:43,390 --> 00:14:49,180
that interface no longer exists if you

317
00:14:47,320 --> 00:14:50,890
happen<font color="#CCCCCC"> to reboot the</font><font color="#E5E5E5"> router at the same</font>

318
00:14:49,180 --> 00:14:54,670
time or something like that during<font color="#E5E5E5"> a</font>

319
00:14:50,890 --> 00:14:57,430
card upgrade what have<font color="#E5E5E5"> you the router</font>

320
00:14:54,670 --> 00:14:59,979
will recalculate the route map and that

321
00:14:57,430 --> 00:15:04,750
line which previously denied<font color="#E5E5E5"> only one</font>

322
00:14:59,980 --> 00:15:06,490
interface now denies all prefixes so we

323
00:15:04,750 --> 00:15:10,270
are shifting to excluding your<font color="#CCCCCC"> IGP</font>

324
00:15:06,490 --> 00:15:12,280
interfaces based on prefix list fun

325
00:15:10,270 --> 00:15:16,420
little<font color="#CCCCCC"> challenge troubleshoot</font><font color="#E5E5E5"> I was home</font>

326
00:15:12,280 --> 00:15:18,730
in a<font color="#E5E5E5"> Christmas vacation and didn't make</font>

327
00:15:16,420 --> 00:15:20,319
any sense but dig into it and oops yep

328
00:15:18,730 --> 00:15:23,170
that line<font color="#CCCCCC"> is not doing what we</font><font color="#E5E5E5"> want it</font>

329
00:15:20,320 --> 00:15:25,960
to likewise we redistribute static

330
00:15:23,170 --> 00:15:27,969
routes into<font color="#E5E5E5"> BGP and allows us</font><font color="#CCCCCC"> to do all</font>

331
00:15:25,960 --> 00:15:29,410
of our customer configurations on the

332
00:15:27,970 --> 00:15:31,509
distribution router where the customer

333
00:15:29,410 --> 00:15:36,670
connected and not have to touch anything

334
00:15:31,509 --> 00:15:39,970
anywhere else what you'll never find in

335
00:15:36,670 --> 00:15:42,430
the various<font color="#CCCCCC"> bgp textbooks is that</font>

336
00:15:39,970 --> 00:15:45,220
transit costs money appearing is usually

337
00:15:42,430 --> 00:15:47,949
no or low costs debatable customers

338
00:15:45,220 --> 00:15:49,569
usually result in revenue so from a

339
00:15:47,949 --> 00:15:52,269
design perspective what the books<font color="#E5E5E5"> don't</font>

340
00:15:49,569 --> 00:15:53,969
tell you is many many networks treat

341
00:15:52,269 --> 00:15:57,459
their prefixes appropriate to dollars

342
00:15:53,970 --> 00:15:59,439
prefer to send traffic to a customer if

343
00:15:57,459 --> 00:16:01,569
that's where<font color="#E5E5E5"> the prefix lives rather</font>

344
00:15:59,439 --> 00:16:03,519
than through pairing a transit so the

345
00:16:01,569 --> 00:16:06,189
often used hammer to do thats local

346
00:16:03,519 --> 00:16:08,079
preference so as a sample local

347
00:16:06,189 --> 00:16:09,759
preference design ours is a little bit

348
00:16:08,079 --> 00:16:10,989
skewed from this but it's a good basis

349
00:16:09,759 --> 00:16:13,060
and<font color="#CCCCCC"> to what we're shifting back to</font>

350
00:16:10,990 --> 00:16:16,149
customer local preference a<font color="#CCCCCC"> four hundred</font>

351
00:16:13,060 --> 00:16:19,089
<font color="#CCCCCC">pier local preference of 300 transit of</font>

352
00:16:16,149 --> 00:16:21,339
two hundred and a backup route would be

353
00:16:19,089 --> 00:16:23,050
<font color="#E5E5E5">a local preference of</font><font color="#CCCCCC"> fifty key here</font>

354
00:16:21,339 --> 00:16:26,110
being with the default local preference

355
00:16:23,050 --> 00:16:28,779
being 100 a forgotten or flawed route

356
00:16:26,110 --> 00:16:31,000
map will result in routes that aren't

357
00:16:28,779 --> 00:16:32,379
used if you forget the route map and

358
00:16:31,000 --> 00:16:34,720
learn prefixes from your customer

359
00:16:32,379 --> 00:16:36,250
they'll come at local preference of 100

360
00:16:34,720 --> 00:16:37,420
you'll still send the traffic out

361
00:16:36,250 --> 00:16:40,360
through your transit or better

362
00:16:37,420 --> 00:16:43,029
connections and customers say why is my

363
00:16:40,360 --> 00:16:44,800
traffic<font color="#E5E5E5"> not coming over our link it</font>

364
00:16:43,029 --> 00:16:47,199
<font color="#E5E5E5">forces helps to force the</font>

365
00:16:44,800 --> 00:16:50,920
troubleshooting and the observation of

366
00:16:47,199 --> 00:16:53,620
<font color="#E5E5E5">the problem and likewise if you bring up</font>

367
00:16:50,920 --> 00:16:56,050
a transit connection you're not going to

368
00:16:53,620 --> 00:16:59,920
swamp your routes the wrong way because

369
00:16:56,050 --> 00:17:02,170
<font color="#E5E5E5">of an incorrect route map so our</font>

370
00:16:59,920 --> 00:17:04,299
customer filtering plan filter once on

371
00:17:02,170 --> 00:17:07,329
ingress apply that internal community

372
00:17:04,299 --> 00:17:11,609
and we do so aggressively because<font color="#E5E5E5"> we're</font>

373
00:17:07,329 --> 00:17:15,579
a small enough shop we filter on a

374
00:17:11,609 --> 00:17:17,619
<font color="#E5E5E5">combination</font><font color="#CCCCCC"> of prefix and a s path in</font>

375
00:17:15,579 --> 00:17:20,349
such a way that the customer can prepend

376
00:17:17,619 --> 00:17:22,989
freely using the a s is allowed on<font color="#CCCCCC"> that</font>

377
00:17:20,349 --> 00:17:28,030
path we also allow our customers to

378
00:17:22,990 --> 00:17:30,520
shorten the a s path as desired if there

379
00:17:28,030 --> 00:17:32,799
<font color="#E5E5E5">are multiple a SS on the path let's say</font>

380
00:17:30,520 --> 00:17:36,190
our customer has a downstream customer

381
00:17:32,799 --> 00:17:38,049
with a<font color="#E5E5E5"> / 24 downstream customers router</font>

382
00:17:36,190 --> 00:17:39,600
blows up they replace it with a small

383
00:17:38,049 --> 00:17:44,370
box that they don't want<font color="#CCCCCC"> to</font>

384
00:17:39,600 --> 00:17:47,928
or can't run BGP that customer of ours

385
00:17:44,370 --> 00:17:50,580
might get asked to announce the prefix

386
00:17:47,929 --> 00:17:53,250
the<font color="#E5E5E5"> a s</font><font color="#CCCCCC"> path will most likely have</font>

387
00:17:50,580 --> 00:17:55,110
changed in doing<font color="#CCCCCC"> so we allow that prefix</font>

388
00:17:53,250 --> 00:17:58,470
to<font color="#E5E5E5"> make it out the</font><font color="#CCCCCC"> door and allow</font><font color="#E5E5E5"> that</font>

389
00:17:55,110 --> 00:18:01,740
customer customer to continue using<font color="#E5E5E5"> the</font>

390
00:17:58,470 --> 00:18:04,620
net we do not allow our customers to

391
00:18:01,740 --> 00:18:07,049
change a s path without prior contact

392
00:18:04,620 --> 00:18:09,120
and configuration changes we don't allow

393
00:18:07,049 --> 00:18:10,860
them to lengthen it other than pre<font color="#E5E5E5"> pins</font>

394
00:18:09,120 --> 00:18:13,158
we tell<font color="#E5E5E5"> them about the filtering rules</font>

395
00:18:10,860 --> 00:18:16,830
and lots more at turn up we have a

396
00:18:13,159 --> 00:18:19,020
four-page document that covers a lot<font color="#CCCCCC"> of</font>

397
00:18:16,830 --> 00:18:24,030
our<font color="#E5E5E5"> BGP stuff in that that they get on</font>

398
00:18:19,020 --> 00:18:28,070
turn up so in doing the community<font color="#E5E5E5"> on</font>

399
00:18:24,030 --> 00:18:33,440
each prefix it's a coded community

400
00:18:28,070 --> 00:18:37,620
covers the pop of origin of receipt or

401
00:18:33,440 --> 00:18:39,750
ingress indicates a requested egress

402
00:18:37,620 --> 00:18:42,239
handling that sometimes overridden but

403
00:18:39,750 --> 00:18:44,070
sometimes not and they type of the route

404
00:18:42,240 --> 00:18:47,010
whether it's a customer out our own

405
00:18:44,070 --> 00:18:49,799
route or an external and then try<font color="#E5E5E5"> to use</font>

406
00:18:47,010 --> 00:18:52,620
this tag intelligently we use the pop of

407
00:18:49,799 --> 00:18:55,230
origin to adjust med automatically for

408
00:18:52,620 --> 00:18:58,889
us on egress to our providers allow

409
00:18:55,230 --> 00:19:01,530
simplegeo routing and has done drastic

410
00:18:58,890 --> 00:19:06,450
things for our land costs and size of

411
00:19:01,530 --> 00:19:09,270
pipe needed our design left<font color="#E5E5E5"> side is our</font>

412
00:19:06,450 --> 00:19:12,020
<font color="#E5E5E5">a s number the right side is five</font>

413
00:19:09,270 --> 00:19:14,580
characters first indicates route type

414
00:19:12,020 --> 00:19:16,889
second and<font color="#E5E5E5"> third indicate pop of origin</font>

415
00:19:14,580 --> 00:19:19,139
admittedly<font color="#CCCCCC"> we only have five pops but if</font>

416
00:19:16,890 --> 00:19:22,049
we did<font color="#E5E5E5"> double we'd be out</font><font color="#CCCCCC"> of characters</font>

417
00:19:19,140 --> 00:19:25,409
so we went<font color="#E5E5E5"> for the long view d is our</font>

418
00:19:22,049 --> 00:19:27,690
desired tuning<font color="#CCCCCC"> 0 is as I've managed to</font>

419
00:19:25,409 --> 00:19:32,030
tune it over<font color="#E5E5E5"> time to keep our links</font>

420
00:19:27,690 --> 00:19:34,919
balanced as desired one is basically

421
00:19:32,030 --> 00:19:39,379
wide open or whatever our providers tend

422
00:19:34,919 --> 00:19:42,210
to tune at to request backup handling

423
00:19:39,380 --> 00:19:43,799
less traffic<font color="#CCCCCC"> on it and seven would be</font>

424
00:19:42,210 --> 00:19:47,190
<font color="#E5E5E5">for maintenance indicating this routes</font>

425
00:19:43,799 --> 00:19:51,059
only<font color="#E5E5E5"> only if I have no other way to</font>

426
00:19:47,190 --> 00:19:51,879
<font color="#CCCCCC">handle it</font><font color="#E5E5E5"> and then e is our trigger for</font>

427
00:19:51,059 --> 00:19:54,249
aggregate

428
00:19:51,879 --> 00:20:00,069
and hot potato routing or pop specific

429
00:19:54,249 --> 00:20:01,869
and cold potato after that for our

430
00:20:00,069 --> 00:20:04,509
<font color="#CCCCCC">customers to have some control we</font>

431
00:20:01,869 --> 00:20:06,488
developed a set of communities that we

432
00:20:04,509 --> 00:20:09,009
<font color="#E5E5E5">sometimes use and our</font><font color="#CCCCCC"> customers are</font>

433
00:20:06,489 --> 00:20:11,499
always eligible to use for tuning within

434
00:20:09,009 --> 00:20:15,159
our network used to set local preference

435
00:20:11,499 --> 00:20:17,949
and adjust how their routes compare on

436
00:20:15,159 --> 00:20:21,069
that previous chart to allow them to

437
00:20:17,949 --> 00:20:24,909
balance with our transits<font color="#CCCCCC"> and peers or</font>

438
00:20:21,069 --> 00:20:26,859
come in below it and<font color="#CCCCCC"> if they</font><font color="#E5E5E5"> should want</font>

439
00:20:24,909 --> 00:20:28,539
to<font color="#E5E5E5"> have the</font><font color="#CCCCCC"> option of both customer</font>

440
00:20:26,859 --> 00:20:31,749
level local preference and customer

441
00:20:28,539 --> 00:20:34,059
<font color="#E5E5E5">backup that's still essentially better</font>

442
00:20:31,749 --> 00:20:37,599
than transit we allow them to do so by

443
00:20:34,059 --> 00:20:40,389
using met in the case of customers that

444
00:20:37,599 --> 00:20:42,099
only<font color="#E5E5E5"> have a single connection to us we</font>

445
00:20:40,389 --> 00:20:44,289
have a simpler<font color="#E5E5E5"> inbound route map that</font>

446
00:20:42,099 --> 00:20:48,729
squashes med to minimize any

447
00:20:44,289 --> 00:20:51,249
troubleshooting surprises from it so<font color="#CCCCCC"> for</font>

448
00:20:48,729 --> 00:20:55,089
basic versions of local pref they'd use

449
00:20:51,249 --> 00:20:57,759
one 1457 colon 400 for example if they

450
00:20:55,089 --> 00:21:03,339
wish<font color="#CCCCCC"> to know router prefix the right</font>

451
00:20:57,759 --> 00:21:07,989
side would<font color="#CCCCCC"> be 0 so in our customer</font>

452
00:21:03,339 --> 00:21:10,389
inbound route map five basic categories

453
00:21:07,989 --> 00:21:12,419
in the route map the number<font color="#E5E5E5"> of entries</font>

454
00:21:10,389 --> 00:21:15,908
in the route map grows based on how many

455
00:21:12,419 --> 00:21:19,299
<font color="#CCCCCC">AAS paths they might be sending us</font>

456
00:21:15,909 --> 00:21:23,440
routes first option for<font color="#CCCCCC"> us is to accept</font>

457
00:21:19,299 --> 00:21:26,289
<font color="#E5E5E5">a null routed aggregate route we will</font>

458
00:21:23,440 --> 00:21:27,819
accept it we will<font color="#CCCCCC"> know route it and we</font>

459
00:21:26,289 --> 00:21:29,440
will propagate it to our providers

460
00:21:27,819 --> 00:21:32,199
because it's one of their aggregates

461
00:21:29,440 --> 00:21:34,690
there could be a<font color="#CCCCCC"> lot</font><font color="#E5E5E5"> of valuable tools</font>

462
00:21:32,199 --> 00:21:36,969
which will show on a chart coming up why

463
00:21:34,690 --> 00:21:41,469
they might<font color="#CCCCCC"> want their aggregate route</font><font color="#E5E5E5"> no</font>

464
00:21:36,969 --> 00:21:44,739
routed second in the route map is to

465
00:21:41,469 --> 00:21:47,319
accept no<font color="#E5E5E5"> routed specific routes from</font>

466
00:21:44,739 --> 00:21:49,379
them anything matching their prefix

467
00:21:47,319 --> 00:21:53,259
length all the way out the / 32 is

468
00:21:49,379 --> 00:21:56,529
accepted tagged no export null routed

469
00:21:53,259 --> 00:21:59,409
and shared within our network this

470
00:21:56,529 --> 00:22:01,809
allows them<font color="#E5E5E5"> to based on the third step</font>

471
00:21:59,409 --> 00:22:03,539
<font color="#E5E5E5">except their aggregate and propagated</font>

472
00:22:01,809 --> 00:22:05,670
which is the typical expected behavior

473
00:22:03,539 --> 00:22:06,990
so now they using the

474
00:22:05,670 --> 00:22:09,210
second and third clause they could

475
00:22:06,990 --> 00:22:12,510
announce us their aggregate and using

476
00:22:09,210 --> 00:22:18,180
the second<font color="#CCCCCC"> clause null route any portion</font>

477
00:22:12,510 --> 00:22:21,660
of<font color="#E5E5E5"> their space we will also accept a</font>

478
00:22:18,180 --> 00:22:24,450
more specific with a specific community

479
00:22:21,660 --> 00:22:26,580
allowing that prefix to<font color="#E5E5E5"> be propagated</font>

480
00:22:24,450 --> 00:22:30,000
even though<font color="#E5E5E5"> it didn't match our original</font>

481
00:22:26,580 --> 00:22:33,030
exact match filters it's a best-effort

482
00:22:30,000 --> 00:22:36,660
feature hopes that our transits filter

483
00:22:33,030 --> 00:22:39,030
on less<font color="#CCCCCC"> than or equal to 24 but allows</font>

484
00:22:36,660 --> 00:22:42,870
us from a small<font color="#E5E5E5"> shop perspective to</font>

485
00:22:39,030 --> 00:22:45,090
simplify our support requirements and if

486
00:22:42,870 --> 00:22:47,280
a customer for some reason in<font color="#CCCCCC"> emergency</font>

487
00:22:45,090 --> 00:22:49,500
situation needs<font color="#E5E5E5"> to announce a more</font>

488
00:22:47,280 --> 00:22:52,070
specific for traffic engineering

489
00:22:49,500 --> 00:22:54,630
purposes or whatever they can<font color="#E5E5E5"> call</font><font color="#CCCCCC"> us up</font>

490
00:22:52,070 --> 00:22:56,490
<font color="#E5E5E5">we'll tell them the community to use</font>

491
00:22:54,630 --> 00:22:58,410
they can apply that community to their

492
00:22:56,490 --> 00:23:00,960
route it will<font color="#E5E5E5"> instantly go out through</font>

493
00:22:58,410 --> 00:23:03,690
our filters and allows a technician or

494
00:23:00,960 --> 00:23:06,180
<font color="#E5E5E5">myself to circle back in the next 12</font>

495
00:23:03,690 --> 00:23:10,010
hours per se and add the appropriate

496
00:23:06,180 --> 00:23:12,330
filter entries and request the specific

497
00:23:10,010 --> 00:23:15,270
filter openings on behalf of our

498
00:23:12,330 --> 00:23:18,629
providers we have not gotten large

499
00:23:15,270 --> 00:23:20,760
enough to automate that and the last

500
00:23:18,630 --> 00:23:23,040
entry on the prefix list is to accept a

501
00:23:20,760 --> 00:23:25,020
specific that does not have the

502
00:23:23,040 --> 00:23:27,690
community for propagation so it would be

503
00:23:25,020 --> 00:23:30,629
simply a specific and does<font color="#E5E5E5"> not have a</font>

504
00:23:27,690 --> 00:23:32,670
community for no routing and we will

505
00:23:30,630 --> 00:23:35,430
accept the route we will tag it no

506
00:23:32,670 --> 00:23:39,440
export share it within our network this

507
00:23:35,430 --> 00:23:44,010
allows both a<font color="#E5E5E5"> anti spoof filter override</font>

508
00:23:39,440 --> 00:23:46,170
and so if by chance they're announcing

509
00:23:44,010 --> 00:23:48,350
their aggregate to another provider and

510
00:23:46,170 --> 00:23:51,270
not to us but they do have certain

511
00:23:48,350 --> 00:23:53,040
prefixes they want to be able<font color="#E5E5E5"> to send</font>

512
00:23:51,270 --> 00:23:55,530
out through us they can create an RPF

513
00:23:53,040 --> 00:23:59,370
opening it also<font color="#CCCCCC"> allows them to do a no</font>

514
00:23:55,530 --> 00:24:02,520
route / I'd let me jump ahead to this

515
00:23:59,370 --> 00:24:05,070
chart so here's a sample of the customer

516
00:24:02,520 --> 00:24:09,170
filtering logic I'm going<font color="#E5E5E5"> to highlight</font>

517
00:24:05,070 --> 00:24:12,240
the first second and last<font color="#CCCCCC"> Clause there</font>

518
00:24:09,170 --> 00:24:14,430
we will accept will allow null routed

519
00:24:12,240 --> 00:24:16,650
aggregates and propagate them so for

520
00:24:14,430 --> 00:24:19,190
example<font color="#E5E5E5"> if</font><font color="#CCCCCC"> the customers allowed to use</font>

521
00:24:16,650 --> 00:24:21,550
10 / 8 will accept it

522
00:24:19,190 --> 00:24:25,220
no route it and will propagate it

523
00:24:21,550 --> 00:24:26,960
jumping down to the fifth<font color="#E5E5E5"> clause will</font>

524
00:24:25,220 --> 00:24:30,380
allow customers to announce a more

525
00:24:26,960 --> 00:24:31,880
specific to us and tag it no export so

526
00:24:30,380 --> 00:24:35,870
in this case the customer might announce

527
00:24:31,880 --> 00:24:38,570
10 20 / 16 will accept it will

528
00:24:35,870 --> 00:24:42,229
distribute it internally and that more

529
00:24:38,570 --> 00:24:45,139
specific will<font color="#E5E5E5"> actually propagate and the</font>

530
00:24:42,230 --> 00:24:47,510
packets heading for that prefix will

531
00:24:45,140 --> 00:24:49,190
come in our upstream edges travel

532
00:24:47,510 --> 00:24:50,750
through<font color="#CCCCCC"> our core down to the</font>

533
00:24:49,190 --> 00:24:53,840
distribution router and head out to<font color="#CCCCCC"> the</font>

534
00:24:50,750 --> 00:24:56,660
customer jumping back to the second

535
00:24:53,840 --> 00:24:59,899
<font color="#E5E5E5">clause will accept a null routed more</font>

536
00:24:56,660 --> 00:25:01,940
specific and<font color="#E5E5E5"> tag it no export and of</font>

537
00:24:59,900 --> 00:25:05,990
<font color="#E5E5E5">course no route so the customer could</font>

538
00:25:01,940 --> 00:25:08,510
announce 10 20 30 / 24 we would accept

539
00:25:05,990 --> 00:25:11,270
the prefix<font color="#E5E5E5"> distributed internally and</font>

540
00:25:08,510 --> 00:25:16,100
<font color="#CCCCCC">arrange for no routing so if we look</font><font color="#E5E5E5"> at</font>

541
00:25:11,270 --> 00:25:19,190
the chart on the bottom 10 dot 0 through

542
00:25:16,100 --> 00:25:24,139
10 19 would get no routed because<font color="#E5E5E5"> it's</font>

543
00:25:19,190 --> 00:25:33,830
carried under the first block the 10 / a

544
00:25:24,140 --> 00:25:37,520
aggregate 10 20 / 16 I'm sorry 10 to 20

545
00:25:33,830 --> 00:25:40,520
through 10 dot 2029 would be routed

546
00:25:37,520 --> 00:25:46,790
because it's carried under the<font color="#CCCCCC"> 5th block</font>

547
00:25:40,520 --> 00:25:49,280
<font color="#E5E5E5">the 10 dot 20 / 16 acceptance 10 20 30 /</font>

548
00:25:46,790 --> 00:25:53,750
24 gets no routed carried under the

549
00:25:49,280 --> 00:25:57,410
second square 10 dot 20 31 through the

550
00:25:53,750 --> 00:26:00,860
rest of<font color="#E5E5E5"> 10 dot 20 / 16 is routed because</font>

551
00:25:57,410 --> 00:26:03,380
of the<font color="#CCCCCC"> 5th square 10 dot 21 through the</font>

552
00:26:00,860 --> 00:26:08,050
rest of 10 / 8 would<font color="#E5E5E5"> be</font><font color="#CCCCCC"> no routed</font>

553
00:26:03,380 --> 00:26:11,530
because of the initial aggregate /<font color="#E5E5E5"> 8</font>

554
00:26:08,050 --> 00:26:14,870
fairly complex<font color="#CCCCCC"> allows the customers to</font>

555
00:26:11,530 --> 00:26:18,639
nail up large aggregates use small

556
00:26:14,870 --> 00:26:21,889
portions of them and not<font color="#CCCCCC"> be subject to</font>

557
00:26:18,640 --> 00:26:24,220
massive traffic swings or router

558
00:26:21,890 --> 00:26:26,150
implosions in the event of a toss

559
00:26:24,220 --> 00:26:28,520
obviously they could simply announce

560
00:26:26,150 --> 00:26:31,850
their aggregate normally and null route

561
00:26:28,520 --> 00:26:34,250
a few<font color="#CCCCCC"> pay you no particular prefixes</font>

562
00:26:31,850 --> 00:26:36,110
this was relatively easy<font color="#CCCCCC"> to implement</font>

563
00:26:34,250 --> 00:26:38,809
giving the other filtering we were doing

564
00:26:36,110 --> 00:26:44,059
and gives the customer a lot more

565
00:26:38,809 --> 00:26:46,910
flexibility and control as desired so

566
00:26:44,059 --> 00:26:48,770
the side impact of this filtering is

567
00:26:46,910 --> 00:26:52,100
that we have at least<font color="#E5E5E5"> two prefix lists</font>

568
00:26:48,770 --> 00:26:56,600
per customer one of those prefix lists

569
00:26:52,100 --> 00:26:59,000
is an exact match list / a s path so if

570
00:26:56,600 --> 00:27:01,189
they have if they<font color="#E5E5E5"> have a prefix and a</font>

571
00:26:59,000 --> 00:27:03,650
customer<font color="#CCCCCC"> of theirs is doing BGP with em</font>

572
00:27:01,190 --> 00:27:06,590
and does a prefix we would<font color="#CCCCCC"> have</font><font color="#E5E5E5"> to exact</font>

573
00:27:03,650 --> 00:27:09,409
match lists there'd be<font color="#CCCCCC"> an additional</font>

574
00:27:06,590 --> 00:27:12,678
list that's just matching on the

575
00:27:09,409 --> 00:27:14,539
aggregate out to / 32 for<font color="#CCCCCC"> null</font><font color="#E5E5E5"> routing</font>

576
00:27:12,679 --> 00:27:19,460
and the temporary specifics discussed

577
00:27:14,539 --> 00:27:23,990
earlier they can optionally inject

578
00:27:19,460 --> 00:27:25,669
tuning communities we and we have the

579
00:27:23,990 --> 00:27:30,350
option<font color="#CCCCCC"> of injecting tuning communities</font>

580
00:27:25,669 --> 00:27:34,960
as desired we've got numerous customers

581
00:27:30,350 --> 00:27:37,789
that are new to BGP need help in tuning

582
00:27:34,960 --> 00:27:40,190
can't understand why half the traffic

583
00:27:37,789 --> 00:27:43,730
comes through us even though they've

584
00:27:40,190 --> 00:27:45,520
prepended it 12 times we know<font color="#E5E5E5"> that</font>

585
00:27:43,730 --> 00:27:47,419
they've<font color="#E5E5E5"> got a fixed local preference</font>

586
00:27:45,520 --> 00:27:49,460
externally in order to get<font color="#CCCCCC"> that to</font>

587
00:27:47,419 --> 00:27:52,039
balance the way they want it so<font color="#CCCCCC"> we will</font>

588
00:27:49,460 --> 00:27:54,080
often inject those communities and tell

589
00:27:52,039 --> 00:27:56,240
them you've got 30 days to arrange for

590
00:27:54,080 --> 00:27:58,340
<font color="#E5E5E5">yourself any time thereafter we might</font>

591
00:27:56,240 --> 00:28:03,909
remove the community and you'll be on

592
00:27:58,340 --> 00:28:06,020
<font color="#CCCCCC">your own so with that bgp tuning design</font>

593
00:28:03,909 --> 00:28:08,990
we came up<font color="#E5E5E5"> with another set of</font>

594
00:28:06,020 --> 00:28:10,760
communities that we or our customers<font color="#E5E5E5"> can</font>

595
00:28:08,990 --> 00:28:13,820
apply<font color="#E5E5E5"> to routes for tuning outside the</font>

596
00:28:10,760 --> 00:28:16,190
network including no advertise the

597
00:28:13,820 --> 00:28:22,210
setting of pre pens and the requesting

598
00:28:16,190 --> 00:28:25,039
of local preference so on our edge

599
00:28:22,210 --> 00:28:27,470
routers on the outbound path to our

600
00:28:25,039 --> 00:28:29,270
providers we obviously filter out other

601
00:28:27,470 --> 00:28:30,350
upstream routes just to double make sure

602
00:28:29,270 --> 00:28:33,860
that they're not<font color="#E5E5E5"> going to go out that</font>

603
00:28:30,350 --> 00:28:37,100
way we allow routes that are flagged

604
00:28:33,860 --> 00:28:39,709
with individual<font color="#E5E5E5"> and/or global local</font>

605
00:28:37,100 --> 00:28:42,350
preference or<font color="#CCCCCC"> pre pen requests and this</font>

606
00:28:39,710 --> 00:28:43,909
became rather complex we were pretty

607
00:28:42,350 --> 00:28:45,049
dependent on route map continue to make

608
00:28:43,909 --> 00:28:48,409
this work

609
00:28:45,049 --> 00:28:50,918
but our customers<font color="#CCCCCC"> can do individual</font>

610
00:28:48,409 --> 00:28:55,009
local preference and global prepend

611
00:28:50,919 --> 00:28:57,440
configurations<font color="#CCCCCC"> or vice versa and layer</font>

612
00:28:55,009 --> 00:29:00,739
it as they wish<font color="#CCCCCC"> to we've had a couple of</font>

613
00:28:57,440 --> 00:29:02,989
requests for this already if there are

614
00:29:00,739 --> 00:29:05,989
<font color="#CCCCCC">none of those local preference or</font>

615
00:29:02,989 --> 00:29:07,759
prepend requests on the route then we

616
00:29:05,989 --> 00:29:10,779
will allow routes that are flagged for

617
00:29:07,759 --> 00:29:13,820
internal to our<font color="#E5E5E5"> network local preference</font>

618
00:29:10,779 --> 00:29:17,359
and map a corresponding local preference

619
00:29:13,820 --> 00:29:20,769
because we<font color="#E5E5E5"> found that BJP and stability</font>

620
00:29:17,359 --> 00:29:24,109
will show up if you've<font color="#E5E5E5"> got a lower if</font>

621
00:29:20,769 --> 00:29:28,129
local preference does not equal or go

622
00:29:24,109 --> 00:29:31,158
down relatively speaking<font color="#E5E5E5"> as the route</font>

623
00:29:28,129 --> 00:29:33,379
travels outbound if there<font color="#E5E5E5"> are none</font><font color="#CCCCCC"> of</font>

624
00:29:31,159 --> 00:29:34,999
those communities present we process the

625
00:29:33,379 --> 00:29:37,309
routes based on the embedded tuning

626
00:29:34,999 --> 00:29:42,109
which is the<font color="#E5E5E5"> D character mentioned</font>

627
00:29:37,309 --> 00:29:45,499
earlier and then we set our med based on

628
00:29:42,109 --> 00:29:51,678
the embedded character and what the pop

629
00:29:45,499 --> 00:29:54,619
of origin<font color="#CCCCCC"> versus pape of egress is so</font>

630
00:29:51,679 --> 00:29:55,970
for our BGP outbound tuning we finally

631
00:29:54,619 --> 00:29:57,559
gotten ourselves to a point<font color="#CCCCCC"> where we've</font>

632
00:29:55,970 --> 00:30:01,460
got parallel connectivity to<font color="#E5E5E5"> three</font>

633
00:29:57,559 --> 00:30:03,889
transit providers we're not in<font color="#CCCCCC"> a good</font>

634
00:30:01,460 --> 00:30:06,109
position to<font color="#E5E5E5"> peer much yet so reliant on</font>

635
00:30:03,889 --> 00:30:08,029
transit for each of those<font color="#CCCCCC"> three</font>

636
00:30:06,109 --> 00:30:11,629
providers we've got a link in<font color="#E5E5E5"> dallas and</font>

637
00:30:08,029 --> 00:30:14,210
a link in<font color="#CCCCCC"> Houston</font><font color="#E5E5E5"> for those transit</font>

638
00:30:11,629 --> 00:30:17,238
providers address space blocks<font color="#E5E5E5"> and their</font>

639
00:30:14,210 --> 00:30:18,980
customers we do cold potato we presume

640
00:30:17,239 --> 00:30:21,289
we're getting med from them we use it

641
00:30:18,980 --> 00:30:22,700
for intelligent routing and we'll send

642
00:30:21,289 --> 00:30:25,399
<font color="#E5E5E5">it through our network to get out to</font>

643
00:30:22,700 --> 00:30:28,070
their through whatever exit point

644
00:30:25,399 --> 00:30:30,469
they're suggesting if it's a prefix

645
00:30:28,070 --> 00:30:31,970
that's beyond that radius will send it

646
00:30:30,470 --> 00:30:35,950
hot potato we'll just give it to them

647
00:30:31,970 --> 00:30:38,720
and<font color="#CCCCCC"> let them take it from there so</font>

648
00:30:35,950 --> 00:30:40,820
reasoning behind that is that<font color="#E5E5E5"> in a</font>

649
00:30:38,720 --> 00:30:44,149
normal state assuming<font color="#CCCCCC"> that we</font><font color="#E5E5E5"> don't have</font>

650
00:30:40,820 --> 00:30:46,668
links or routers down cold potato

651
00:30:44,149 --> 00:30:51,229
routing is only one hop longer<font color="#E5E5E5"> within</font>

652
00:30:46,669 --> 00:30:53,149
our network for us because it's normally

653
00:30:51,230 --> 00:30:56,090
two hops from distribution<font color="#E5E5E5"> through</font>

654
00:30:53,149 --> 00:30:57,330
cortege it would<font color="#CCCCCC"> only be three hops from</font>

655
00:30:56,090 --> 00:31:01,010
<font color="#E5E5E5">distribution to core</font>

656
00:30:57,330 --> 00:31:04,590
to another<font color="#E5E5E5"> city score to an edge so</font>

657
00:31:01,010 --> 00:31:06,210
summarized we know our network because

658
00:31:04,590 --> 00:31:08,879
of<font color="#CCCCCC"> the presence of a med on those</font>

659
00:31:06,210 --> 00:31:12,330
prefixes we assume<font color="#CCCCCC"> that our provider</font>

660
00:31:08,880 --> 00:31:13,710
knows their network but we also take the

661
00:31:12,330 --> 00:31:15,750
view that we<font color="#E5E5E5"> know our network better</font>

662
00:31:13,710 --> 00:31:18,480
than they<font color="#CCCCCC"> know better than we know</font><font color="#E5E5E5"> their</font>

663
00:31:15,750 --> 00:31:20,400
network because all we're getting is<font color="#E5E5E5"> med</font>

664
00:31:18,480 --> 00:31:23,250
<font color="#E5E5E5">and we don't know anything about their</font>

665
00:31:20,400 --> 00:31:24,900
<font color="#CCCCCC">IGP metrics or whatever and the</font>

666
00:31:23,250 --> 00:31:29,000
assumption<font color="#E5E5E5"> is if they're</font><font color="#CCCCCC"> telling us that</font>

667
00:31:24,900 --> 00:31:29,000
a particular pop is better<font color="#E5E5E5"> we'll use it</font>

668
00:31:29,630 --> 00:31:35,370
so the assumption is the<font color="#E5E5E5"> med learned is</font>

669
00:31:32,640 --> 00:31:37,260
likely based on or otherwise derived

670
00:31:35,370 --> 00:31:39,989
from<font color="#CCCCCC"> igp distance to</font><font color="#E5E5E5"> the point of</font>

671
00:31:37,260 --> 00:31:43,500
aggregate injection so if it's the

672
00:31:39,990 --> 00:31:46,950
transit providers aggregate prefixes the

673
00:31:43,500 --> 00:31:49,860
<font color="#CCCCCC">Med probably points us to whatever core</font>

674
00:31:46,950 --> 00:31:53,550
location or pop location they're using

675
00:31:49,860 --> 00:31:55,709
<font color="#CCCCCC">to inject the routes and if it's one of</font>

676
00:31:53,550 --> 00:31:58,860
their customers<font color="#E5E5E5"> we presume that the</font>

677
00:31:55,710 --> 00:32:02,990
customer has either tuned med or is

678
00:31:58,860 --> 00:32:06,570
doing med equivalent across all pipes

679
00:32:02,990 --> 00:32:09,210
we're assuming that that the provider

680
00:32:06,570 --> 00:32:12,000
has now chosen a best path through their

681
00:32:09,210 --> 00:32:14,760
network to the point of best med from

682
00:32:12,000 --> 00:32:18,830
the customer so that the providers med

683
00:32:14,760 --> 00:32:18,830
will lead us to that best exit point

684
00:32:22,640 --> 00:32:27,200
moving on to traffic engineering we had

685
00:32:25,910 --> 00:32:30,560
some<font color="#CCCCCC"> interesting challenges in</font>

686
00:32:27,200 --> 00:32:32,930
redundancy planning we've done some

687
00:32:30,560 --> 00:32:36,020
simulations by changing the metric on

688
00:32:32,930 --> 00:32:38,450
links but we've learned<font color="#E5E5E5"> that all too</font>

689
00:32:36,020 --> 00:32:41,600
often if we're striving for n plus 1

690
00:32:38,450 --> 00:32:44,260
redundancy we've got to<font color="#CCCCCC"> kind of back</font>

691
00:32:41,600 --> 00:32:46,790
calculate our capacity planning and

692
00:32:44,260 --> 00:32:49,010
probably start ordering new capacity at

693
00:32:46,790 --> 00:32:51,800
n plus 2<font color="#E5E5E5"> so that by the time it actually</font>

694
00:32:49,010 --> 00:32:55,960
shows up<font color="#E5E5E5"> we're just barely squeaking</font>

695
00:32:51,800 --> 00:32:59,000
beyond n plus 1 and<font color="#CCCCCC"> about to run out</font><font color="#E5E5E5"> and</font>

696
00:32:55,960 --> 00:33:02,420
from<font color="#E5E5E5"> GI Jane to means</font><font color="#CCCCCC"> one and one means</font>

697
00:32:59,000 --> 00:33:04,250
none sometimes with two cool routers to

698
00:33:02,420 --> 00:33:06,710
over<font color="#E5E5E5"> one means half your capacities that</font>

699
00:33:04,250 --> 00:33:11,030
excess ugh but it's what you might<font color="#E5E5E5"> have</font>

700
00:33:06,710 --> 00:33:12,800
to do so because we're only<font color="#E5E5E5"> a</font><font color="#CCCCCC"> four citty</font>

701
00:33:11,030 --> 00:33:15,920
network with a strange traffic pattern

702
00:33:12,800 --> 00:33:18,860
sometimes mpls traffic engineering saved

703
00:33:15,920 --> 00:33:22,880
our butts we had before we got to the

704
00:33:18,860 --> 00:33:24,949
parallel providers we had over<font color="#CCCCCC"> a hundred</font>

705
00:33:22,880 --> 00:33:28,220
megabits traveling across our<font color="#CCCCCC"> dallas to</font>

706
00:33:24,950 --> 00:33:32,690
<font color="#CCCCCC">houston</font><font color="#E5E5E5"> lan when our overall traffic was</font>

707
00:33:28,220 --> 00:33:35,300
only 150 megabytes so in the toughest of

708
00:33:32,690 --> 00:33:37,430
<font color="#E5E5E5">times we had one or two te tunnels from</font>

709
00:33:35,300 --> 00:33:41,330
each distribution router to each edge

710
00:33:37,430 --> 00:33:43,730
router and vice versa<font color="#E5E5E5"> and we ran on very</font>

711
00:33:41,330 --> 00:33:46,970
aggressive<font color="#E5E5E5"> 15-minute auto bandwidth</font>

712
00:33:43,730 --> 00:33:49,240
timers a lot of RSVP state but it was

713
00:33:46,970 --> 00:33:53,930
enough to<font color="#CCCCCC"> get</font><font color="#E5E5E5"> us out of trouble and</font>

714
00:33:49,240 --> 00:33:56,720
utilized the non equal cost links to

715
00:33:53,930 --> 00:33:58,730
gain some read some capacity and retain

716
00:33:56,720 --> 00:34:01,100
some redundancy<font color="#CCCCCC"> that would otherwise</font>

717
00:33:58,730 --> 00:34:04,760
been quite expensive to engineer

718
00:34:01,100 --> 00:34:06,230
directly into the network<font color="#CCCCCC"> and of course</font>

719
00:34:04,760 --> 00:34:07,760
we had some pitfalls one of our

720
00:34:06,230 --> 00:34:10,190
customers is<font color="#E5E5E5"> running a new server and</font>

721
00:34:07,760 --> 00:34:12,399
that<font color="#E5E5E5"> meant a few large bandwidth flows</font>

722
00:34:10,190 --> 00:34:14,600
we get glued to a particular tunnel and

723
00:34:12,399 --> 00:34:15,759
here you<font color="#E5E5E5"> just add a couple of tunnels</font>

724
00:34:14,600 --> 00:34:19,759
where you know you need them for

725
00:34:15,760 --> 00:34:22,550
granularity once we started moving<font color="#E5E5E5"> into</font>

726
00:34:19,760 --> 00:34:25,399
different platforms ran into some iOS

727
00:34:22,550 --> 00:34:29,360
issues they got in our way made things

728
00:34:25,399 --> 00:34:33,139
get pretty ugly when the hourly re

729
00:34:29,360 --> 00:34:36,169
optimization timers hit so we cleaned

730
00:34:33,139 --> 00:34:39,589
out all the disks<font color="#E5E5E5"> to</font>

731
00:34:36,168 --> 00:34:41,839
an edge to dist tunnels and settled on

732
00:34:39,589 --> 00:34:44,929
core decor tunnels only over our<font color="#E5E5E5"> land</font>

733
00:34:41,839 --> 00:34:48,139
links and a standard of four tunnels /

734
00:34:44,929 --> 00:34:50,418
link so if<font color="#E5E5E5"> we exceed the configured</font>

735
00:34:48,139 --> 00:34:54,649
capacity of a<font color="#CCCCCC"> LAN link a quarter of</font><font color="#E5E5E5"> our</font>

736
00:34:50,418 --> 00:34:56,529
traffic swings at<font color="#CCCCCC"> that point the traffic</font>

737
00:34:54,649 --> 00:35:00,380
follows our lowest metric topology

738
00:34:56,530 --> 00:35:02,240
unless there's congestion it reacts with

739
00:35:00,380 --> 00:35:05,599
<font color="#E5E5E5">in 15 minutes because the auto bandwidth</font>

740
00:35:02,240 --> 00:35:08,270
and when the<font color="#E5E5E5"> bandwidth recedes we</font>

741
00:35:05,599 --> 00:35:10,250
restore back to lowest metric topology

742
00:35:08,270 --> 00:35:15,230
within 15 minutes of clearing the

743
00:35:10,250 --> 00:35:17,540
<font color="#E5E5E5">challenge so on the topic of monitoring</font>

744
00:35:15,230 --> 00:35:20,030
<font color="#E5E5E5">I had</font><font color="#CCCCCC"> originally set out to do some</font>

745
00:35:17,540 --> 00:35:22,359
<font color="#E5E5E5">monitoring and tools in a tutorial</font>

746
00:35:20,030 --> 00:35:24,829
presentation but found<font color="#E5E5E5"> that this was</font>

747
00:35:22,359 --> 00:35:27,290
more prevalent and what i thought was

748
00:35:24,829 --> 00:35:29,390
more contributory at this point a couple

749
00:35:27,290 --> 00:35:31,460
<font color="#E5E5E5">of key monitoring tools though consider</font>

750
00:35:29,390 --> 00:35:34,609
what you can from a homegrown tool set

751
00:35:31,460 --> 00:35:37,460
to research many or all facets of<font color="#E5E5E5"> your</font>

752
00:35:34,609 --> 00:35:39,470
customers configurations and consolidate

753
00:35:37,460 --> 00:35:41,839
that information for your help desk or

754
00:35:39,470 --> 00:35:43,399
<font color="#CCCCCC">not that will</font><font color="#E5E5E5"> in turn allow you to</font>

755
00:35:41,839 --> 00:35:45,589
minimize the need to share your enable

756
00:35:43,400 --> 00:35:50,390
passwords and allow them to<font color="#E5E5E5"> get a lot of</font>

757
00:35:45,589 --> 00:35:52,279
status from simplified tools for us<font color="#CCCCCC"> two</font>

758
00:35:50,390 --> 00:35:55,640
biggest<font color="#E5E5E5"> things where Mr TG with some</font>

759
00:35:52,280 --> 00:35:57,140
homeroom and enhancements and syslog so

760
00:35:55,640 --> 00:35:59,868
our<font color="#E5E5E5"> mr TG which I'll show you in a</font>

761
00:35:57,140 --> 00:36:02,900
moment has a simple link for each port

762
00:35:59,869 --> 00:36:06,770
to a cutesy but it works network diagram

763
00:36:02,900 --> 00:36:08,900
a link<font color="#E5E5E5"> to telnet to the CPE and a</font>

764
00:36:06,770 --> 00:36:10,940
quickie document on most of our smaller

765
00:36:08,900 --> 00:36:14,420
links on how to configure that CPE if

766
00:36:10,940 --> 00:36:17,510
it's our standard brand we've also gone

767
00:36:14,420 --> 00:36:20,450
with a syslog implementation that<font color="#CCCCCC"> has a</font>

768
00:36:17,510 --> 00:36:23,930
pearl wrapper that does some basic color

769
00:36:20,450 --> 00:36:26,270
coding for up and down so our relatively

770
00:36:23,930 --> 00:36:27,859
inexperienced knock staff can get a

771
00:36:26,270 --> 00:36:30,470
sense of what's going<font color="#E5E5E5"> on just by looking</font>

772
00:36:27,859 --> 00:36:32,660
at the colors also substitutes in the

773
00:36:30,470 --> 00:36:34,848
interface description so the entry has a

774
00:36:32,660 --> 00:36:36,950
<font color="#E5E5E5">local meaning we felt that the syslog</font>

775
00:36:34,849 --> 00:36:40,069
was quicker for<font color="#E5E5E5"> us to make useful</font>

776
00:36:36,950 --> 00:36:42,919
because the syslog message has all the

777
00:36:40,069 --> 00:36:45,259
text you need to decode what kind of

778
00:36:42,920 --> 00:36:48,230
message it's trying to tell<font color="#CCCCCC"> us whereas</font>

779
00:36:45,260 --> 00:36:49,850
SNMP would require a lot<font color="#CCCCCC"> of translation</font>

780
00:36:48,230 --> 00:36:54,140
and might potentially have a

781
00:36:49,850 --> 00:36:56,600
a lot of excess messages so on the

782
00:36:54,140 --> 00:37:00,470
security just to preach<font color="#CCCCCC"> the standard</font>

783
00:36:56,600 --> 00:37:03,410
song please prevent your bad traffic do

784
00:37:00,470 --> 00:37:08,660
your anti spoofing unique a star p f

785
00:37:03,410 --> 00:37:11,180
unless you can't and we also use a very

786
00:37:08,660 --> 00:37:16,460
simple<font color="#E5E5E5"> but a very effective inbound</font><font color="#CCCCCC"> akal</font>

787
00:37:11,180 --> 00:37:18,319
on every port leaving our core or our

788
00:37:16,460 --> 00:37:20,960
production<font color="#E5E5E5"> network if it's facing a</font>

789
00:37:18,320 --> 00:37:22,400
provider if it's facing a partner if

790
00:37:20,960 --> 00:37:25,280
it's facing a customer there's an

791
00:37:22,400 --> 00:37:29,120
inbound access list that we update as we

792
00:37:25,280 --> 00:37:33,620
see fit black hole routing has saved our

793
00:37:29,120 --> 00:37:36,830
but<font color="#E5E5E5"> you know being able to dump away a</font>

794
00:37:33,620 --> 00:37:40,160
<font color="#E5E5E5">DOS attack helps mitigate the impact on</font>

795
00:37:36,830 --> 00:37:42,890
many other vulnerable customers the same

796
00:37:40,160 --> 00:37:44,420
time and we've got just<font color="#E5E5E5"> enough net flow</font>

797
00:37:42,890 --> 00:37:48,370
in place to be able to<font color="#CCCCCC"> help us track</font>

798
00:37:44,420 --> 00:37:51,530
down source and destination of that<font color="#CCCCCC"> boss</font>

799
00:37:48,370 --> 00:37:54,440
typically<font color="#E5E5E5"> our approach is to black hole</font>

800
00:37:51,530 --> 00:37:56,570
the victim initially until we can go

801
00:37:54,440 --> 00:37:59,120
back and call the data a<font color="#E5E5E5"> little bit</font>

802
00:37:56,570 --> 00:38:00,590
better<font color="#E5E5E5"> and figure out if it's truly</font>

803
00:37:59,120 --> 00:38:02,900
distributed in which case there's not

804
00:38:00,590 --> 00:38:05,960
<font color="#E5E5E5">much that we felt we could do or if it's</font>

805
00:38:02,900 --> 00:38:08,840
<font color="#E5E5E5">coming from a few key attack points in</font>

806
00:38:05,960 --> 00:38:11,450
which case we'll a black hole the source

807
00:38:08,840 --> 00:38:13,700
of the problem and unblock whole the

808
00:38:11,450 --> 00:38:16,520
victim allowing them to mostly resume

809
00:38:13,700 --> 00:38:21,620
business and service and move<font color="#E5E5E5"> forward</font>

810
00:38:16,520 --> 00:38:23,710
from there so that's<font color="#E5E5E5"> my story it's</font>

811
00:38:21,620 --> 00:38:25,370
worked well for us over<font color="#E5E5E5"> the five years</font>

812
00:38:23,710 --> 00:38:27,560
technically<font color="#CCCCCC"> I'm on call</font>

813
00:38:25,370 --> 00:38:29,870
<font color="#CCCCCC">twenty-four-seven even on vacation and</font>

814
00:38:27,560 --> 00:38:32,029
whatnot but my phone rings about<font color="#E5E5E5"> once</font>

815
00:38:29,870 --> 00:38:34,580
every three months<font color="#E5E5E5"> and I attribute</font><font color="#CCCCCC"> a lot</font>

816
00:38:32,030 --> 00:38:36,560
of that to what we've talked about<font color="#E5E5E5"> here</font>

817
00:38:34,580 --> 00:38:38,900
this afternoon if you'd like

818
00:38:36,560 --> 00:38:42,259
configuration snippets from any portion

819
00:38:38,900 --> 00:38:44,150
or all portions of this program feel

820
00:38:42,260 --> 00:38:47,000
free to track me down by email be happy

821
00:38:44,150 --> 00:38:50,390
<font color="#CCCCCC">to show you what we use</font><font color="#E5E5E5"> and so forth and</font>

822
00:38:47,000 --> 00:38:53,660
a couple of samples real quick here's

823
00:38:50,390 --> 00:38:57,080
our syslog implementation we've

824
00:38:53,660 --> 00:39:02,080
<font color="#CCCCCC">color-coded down as red cleared as green</font>

825
00:38:57,080 --> 00:39:03,710
up as green same for bgp neighbors also

826
00:39:02,080 --> 00:39:06,440
translated this

827
00:39:03,710 --> 00:39:11,359
pause interface to being an OC 3 to a

828
00:39:06,440 --> 00:39:14,900
partner of ours<font color="#E5E5E5"> and then as well here's</font>

829
00:39:11,359 --> 00:39:18,040
a look into<font color="#CCCCCC"> our</font><font color="#E5E5E5"> mr TG this particular</font>

830
00:39:14,900 --> 00:39:20,660
<font color="#CCCCCC">destroyed or has our t1 customers I've</font>

831
00:39:18,040 --> 00:39:24,200
temporarily renamed one of our customer

832
00:39:20,660 --> 00:39:26,960
<font color="#E5E5E5">ports to be unnamed so here we've</font><font color="#CCCCCC"> got a</font>

833
00:39:24,200 --> 00:39:28,640
way to look at the network diagram this

834
00:39:26,960 --> 00:39:32,450
is actually generated from rancid

835
00:39:28,640 --> 00:39:39,400
configs but it just sucks in<font color="#E5E5E5"> jpg of a</font>

836
00:39:32,450 --> 00:39:41,960
7507 sucks in it what yeah all right<font color="#CCCCCC"> I</font>

837
00:39:39,400 --> 00:39:45,530
forgot this only gets generated once a

838
00:39:41,960 --> 00:39:46,700
day for the diagrams<font color="#CCCCCC"> culling through</font><font color="#E5E5E5"> the</font>

839
00:39:45,530 --> 00:39:51,890
<font color="#E5E5E5">rants and stuff was a little bit slower</font>

840
00:39:46,700 --> 00:39:55,419
but gives us the link subnet from our

841
00:39:51,890 --> 00:39:59,569
distribution router to the cpe the

842
00:39:55,420 --> 00:40:01,670
network and the far side address tells

843
00:39:59,570 --> 00:40:04,460
us what kind<font color="#CCCCCC"> of interface it is what</font>

844
00:40:01,670 --> 00:40:06,859
router card assignment t1 assignment

845
00:40:04,460 --> 00:40:09,800
time slots and then on the bottom side

846
00:40:06,859 --> 00:40:12,140
shows the land network what the<font color="#E5E5E5"> sub that</font>

847
00:40:09,800 --> 00:40:14,930
is for<font color="#E5E5E5"> the many knock employees we have</font>

848
00:40:12,140 --> 00:40:18,410
<font color="#CCCCCC">don't understand / notations gives them</font>

849
00:40:14,930 --> 00:40:19,970
a quick you<font color="#E5E5E5"> know / conversion table with</font>

850
00:40:18,410 --> 00:40:23,810
a bunch of notes at the<font color="#E5E5E5"> bottom that are</font>

851
00:40:19,970 --> 00:40:28,779
relative<font color="#CCCCCC"> to our implementation quickie</font>

852
00:40:23,810 --> 00:40:31,609
<font color="#CCCCCC">on administrative distance if needed and</font>

853
00:40:28,780 --> 00:40:36,680
rarely gets used there and a little<font color="#CCCCCC"> bit</font>

854
00:40:31,609 --> 00:40:38,299
on internal tags our classic cpe he was

855
00:40:36,680 --> 00:40:41,720
<font color="#E5E5E5">ad trained so this walks them through</font>

856
00:40:38,300 --> 00:40:44,270
the menu based structure<font color="#CCCCCC"> step-by-step to</font>

857
00:40:41,720 --> 00:40:45,649
configure it gives them a<font color="#E5E5E5"> quickie link</font>

858
00:40:44,270 --> 00:40:51,560
to tell MIT to it if they should so

859
00:40:45,650 --> 00:40:55,430
desire and some SNMP correlation or

860
00:40:51,560 --> 00:41:00,109
actually<font color="#CCCCCC"> its i think it is SNMP to pull</font>

861
00:40:55,430 --> 00:41:02,118
it<font color="#E5E5E5"> and gives us a link status and then</font>

862
00:41:00,109 --> 00:41:04,400
allows us to go into<font color="#E5E5E5"> the last</font>

863
00:41:02,119 --> 00:41:09,329
twenty-four hour counters for every 15

864
00:41:04,400 --> 00:41:12,969
minutes<font color="#CCCCCC"> so</font>

865
00:41:09,329 --> 00:41:15,099
at this point it's 25 minutes to beer

866
00:41:12,969 --> 00:41:16,479
and gear which means you've got<font color="#E5E5E5"> about 25</font>

867
00:41:15,099 --> 00:41:18,190
minutes for questions or<font color="#E5E5E5"> if there's</font>

868
00:41:16,479 --> 00:41:23,649
anything else<font color="#E5E5E5"> you'd like me to elaborate</font>

869
00:41:18,190 --> 00:41:26,130
<font color="#CCCCCC">on dive in further and show any</font>

870
00:41:23,650 --> 00:41:26,130
questions

871
00:41:30,750 --> 00:41:35,010
alrighty as<font color="#E5E5E5"> mentioned feel free to</font>

872
00:41:33,180 --> 00:41:38,759
contact<font color="#E5E5E5"> me if you'd like any glimpse</font>

873
00:41:35,010 --> 00:41:43,100
into configurations and orbit a bit and

874
00:41:38,760 --> 00:41:43,100
<font color="#CCCCCC">we'll be down at beer and gear</font>

