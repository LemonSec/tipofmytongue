1
00:00:00,000 --> 00:00:05,190
<font color="#E5E5E5">okay welcome everybody I'm</font><font color="#CCCCCC"> ELISA I'm</font>

2
00:00:03,600 --> 00:00:07,200
working<font color="#CCCCCC"> for</font><font color="#E5E5E5"> the Amsterdam internet</font>

3
00:00:05,190 --> 00:00:11,130
exchange and thank you<font color="#CCCCCC"> very much for</font>

4
00:00:07,200 --> 00:00:14,160
introducing me so I was working on

5
00:00:11,130 --> 00:00:17,039
traffic analysis on our exchange based

6
00:00:14,160 --> 00:00:19,980
on<font color="#E5E5E5"> SQL data and I'm going to talk about</font>

7
00:00:17,039 --> 00:00:23,490
how we implement that what we did what

8
00:00:19,980 --> 00:00:27,300
kind of what kind of things we<font color="#E5E5E5"> found out</font>

9
00:00:23,490 --> 00:00:33,089
during testing and the<font color="#CCCCCC"> implementation</font><font color="#E5E5E5"> of</font>

10
00:00:27,300 --> 00:00:35,850
<font color="#E5E5E5">our tool to do that on our exchange it's</font>

11
00:00:33,090 --> 00:00:38,129
going to look like<font color="#E5E5E5"> that now i'm going to</font>

12
00:00:35,850 --> 00:00:40,620
say briefly a couple of things<font color="#CCCCCC"> about</font>

13
00:00:38,129 --> 00:00:43,110
<font color="#CCCCCC">sflow that are important to know I think</font>

14
00:00:40,620 --> 00:00:45,269
<font color="#E5E5E5">most of you already heard about what as</font>

15
00:00:43,110 --> 00:00:46,589
flow is but anyway they're like two

16
00:00:45,270 --> 00:00:48,360
<font color="#CCCCCC">three things I would like to point out</font>

17
00:00:46,590 --> 00:00:52,050
<font color="#CCCCCC">that everybody</font><font color="#E5E5E5"> knows what I'm talking</font>

18
00:00:48,360 --> 00:00:54,469
about then about<font color="#E5E5E5"> requirements and plans</font>

19
00:00:52,050 --> 00:00:57,930
what we actually wanted to<font color="#E5E5E5"> do with</font><font color="#CCCCCC"> that</font>

20
00:00:54,469 --> 00:01:00,329
things we ran into<font color="#E5E5E5"> while testing with</font>

21
00:00:57,930 --> 00:01:03,650
<font color="#CCCCCC">the hardware we use and things I</font><font color="#E5E5E5"> found</font>

22
00:01:00,329 --> 00:01:05,790
out<font color="#CCCCCC"> about other vendors and hardware</font>

23
00:01:03,650 --> 00:01:08,580
then there<font color="#E5E5E5"> are a couple of software</font>

24
00:01:05,790 --> 00:01:12,810
solutions to collect and analyze soft as

25
00:01:08,580 --> 00:01:14,580
flow data and i'm going<font color="#E5E5E5"> to say why we</font>

26
00:01:12,810 --> 00:01:18,299
don't use them and why we in the end

27
00:01:14,580 --> 00:01:21,270
implemented our own software to to

28
00:01:18,299 --> 00:01:24,090
analyze that and<font color="#CCCCCC"> i</font><font color="#E5E5E5"> have some results and</font>

29
00:01:21,270 --> 00:01:30,199
pretty graphs and things to show at the

30
00:01:24,090 --> 00:01:32,729
end<font color="#CCCCCC"> okay so what is s flow s flow is</font>

31
00:01:30,200 --> 00:01:38,159
implemented on switches and routers it's

32
00:01:32,729 --> 00:01:41,009
a standard to capture packets and<font color="#E5E5E5"> the</font>

33
00:01:38,159 --> 00:01:42,960
captured packets are exported via UDP

34
00:01:41,009 --> 00:01:46,790
datagrams to a collector and the

35
00:01:42,960 --> 00:01:50,070
collector can analyze and store the data

36
00:01:46,790 --> 00:01:52,170
mmm it's pretty efficient because it's

37
00:01:50,070 --> 00:01:55,710
sampling so we don't have to<font color="#E5E5E5"> look into</font>

38
00:01:52,170 --> 00:01:57,840
every packet and that's why<font color="#CCCCCC"> we can do</font>

39
00:01:55,710 --> 00:02:02,158
that on<font color="#CCCCCC"> high speed links as we have an</font>

40
00:01:57,840 --> 00:02:04,500
amex<font color="#CCCCCC"> mm so it's a standard a lot of</font>

41
00:02:02,159 --> 00:02:09,000
vendors implemented it on the hardware

42
00:02:04,500 --> 00:02:14,000
we use foundry switches at am-6 so most

43
00:02:09,000 --> 00:02:14,000
of my testing was on foundry hardware

44
00:02:16,629 --> 00:02:22,420
important to know about standard is that

45
00:02:19,940 --> 00:02:25,370
not everything is sampled information

46
00:02:22,420 --> 00:02:29,629
the standard defines two different<font color="#E5E5E5"> kinds</font>

47
00:02:25,370 --> 00:02:32,150
of two<font color="#CCCCCC"> different kinds</font><font color="#E5E5E5"> of information we</font>

48
00:02:29,629 --> 00:02:35,870
can put into<font color="#E5E5E5"> the data grams one of them</font>

49
00:02:32,150 --> 00:02:37,459
are flow samples that's that's what

50
00:02:35,870 --> 00:02:39,860
everybody's thinking about talking about

51
00:02:37,459 --> 00:02:45,790
as flow getting our counter samples

52
00:02:39,860 --> 00:02:49,340
counter samples pretty much replace the

53
00:02:45,790 --> 00:02:53,510
<font color="#E5E5E5">data you can you can pull from your from</font>

54
00:02:49,340 --> 00:02:56,299
your devices via<font color="#CCCCCC"> SMP so it's like</font>

55
00:02:53,510 --> 00:02:59,590
<font color="#E5E5E5">interface information on counters errors</font>

56
00:02:56,299 --> 00:03:02,750
and stuff like that and to flow samples

57
00:02:59,590 --> 00:03:04,400
basically capture the<font color="#E5E5E5"> packets so you can</font>

58
00:03:02,750 --> 00:03:07,190
define an interval like I would like<font color="#CCCCCC"> to</font>

59
00:03:04,400 --> 00:03:09,769
<font color="#E5E5E5">have one out of eight k and you get one</font>

60
00:03:07,190 --> 00:03:13,989
out of AK packet headers which you have

61
00:03:09,769 --> 00:03:13,989
to parse and analyze and count

62
00:03:18,569 --> 00:03:24,599
<font color="#CCCCCC">okay so the plan what we actually wanted</font>

63
00:03:21,749 --> 00:03:27,569
to<font color="#E5E5E5"> do in the first place is to use</font><font color="#CCCCCC"> the</font>

64
00:03:24,599 --> 00:03:30,179
flow samples and make a member<font color="#CCCCCC"> to member</font>

65
00:03:27,569 --> 00:03:32,969
graphs because so far using<font color="#E5E5E5"> mr TG we</font>

66
00:03:30,180 --> 00:03:35,459
have graphs off the interface<font color="#CCCCCC"> i remember</font>

67
00:03:32,969 --> 00:03:37,888
<font color="#E5E5E5">to exchange knows</font><font color="#CCCCCC"> ok</font><font color="#E5E5E5"> i'm pushing that</font>

68
00:03:35,459 --> 00:03:39,120
much traffic over one interface but he

69
00:03:37,889 --> 00:03:42,030
doesn't know where<font color="#CCCCCC"> the traffic is going</font>

70
00:03:39,120 --> 00:03:45,299
to<font color="#E5E5E5"> if he doesn't have his own accounting</font>

71
00:03:42,030 --> 00:03:47,189
on his side so it was like okay it would

72
00:03:45,299 --> 00:03:49,260
be<font color="#E5E5E5"> nice service for our members to see</font>

73
00:03:47,189 --> 00:03:52,620
what where the<font color="#CCCCCC"> traffic is actually going</font>

74
00:03:49,260 --> 00:03:56,040
to we can do<font color="#E5E5E5"> that because</font><font color="#CCCCCC"> we have a</font>

75
00:03:52,620 --> 00:03:58,739
<font color="#E5E5E5">policy of one mac address / member so if</font>

76
00:03:56,040 --> 00:04:00,269
we decode a packet and look at the MAC

77
00:03:58,739 --> 00:04:02,010
addresses we know exactly from which

78
00:04:00,269 --> 00:04:07,349
member to which member it's going over

79
00:04:02,010 --> 00:04:10,590
switch platform and there's more we can

80
00:04:07,349 --> 00:04:13,679
look for because we get the whole packet

81
00:04:10,590 --> 00:04:15,750
header so we were<font color="#E5E5E5"> also interested in</font>

82
00:04:13,680 --> 00:04:18,570
seeing things like the ether type of the

83
00:04:15,750 --> 00:04:21,298
packets going over the exchange but as

84
00:04:18,570 --> 00:04:24,440
we are<font color="#E5E5E5"> a layer 2 platform we don't</font>

85
00:04:21,298 --> 00:04:27,090
<font color="#E5E5E5">really want to do more</font><font color="#CCCCCC"> than that so we</font>

86
00:04:24,440 --> 00:04:29,849
pretty much respected herself not to

87
00:04:27,090 --> 00:04:33,388
look deeper than led to information so

88
00:04:29,849 --> 00:04:36,659
we don't decode or store or whatever any

89
00:04:33,389 --> 00:04:41,280
IP addresses or more information about

90
00:04:36,659 --> 00:04:42,690
the members traffic and the other

91
00:04:41,280 --> 00:04:46,650
interesting part about the counter

92
00:04:42,690 --> 00:04:49,320
samples that as flows providing was well

93
00:04:46,650 --> 00:04:53,190
we have some issues with mr TG<font color="#E5E5E5"> and a</font>

94
00:04:49,320 --> 00:04:56,340
much mr gigi is not like though but we

95
00:04:53,190 --> 00:04:57,990
were thinking<font color="#CCCCCC"> about replacing mr TG with</font>

96
00:04:56,340 --> 00:05:00,150
the counter samples that as flows

97
00:04:57,990 --> 00:05:07,289
providing but<font color="#E5E5E5"> i'm going to talk about</font>

98
00:05:00,150 --> 00:05:10,250
mhg issues later on a bit more<font color="#E5E5E5"> on am-6</font>

99
00:05:07,289 --> 00:05:13,949
so we have really high demands on

100
00:05:10,250 --> 00:05:15,360
performance currently it's a bit more

101
00:05:13,949 --> 00:05:19,139
<font color="#E5E5E5">because</font><font color="#CCCCCC"> i prepared two slides last week</font>

102
00:05:15,360 --> 00:05:21,930
so it's I think 280 gigabits per second

103
00:05:19,139 --> 00:05:27,570
right now so if<font color="#E5E5E5"> we end up with</font><font color="#CCCCCC"> a</font>

104
00:05:21,930 --> 00:05:30,510
sampling rate of eight k5k samples per

105
00:05:27,570 --> 00:05:31,510
second the samples are packed in the UDP

106
00:05:30,510 --> 00:05:34,750
datagrams

107
00:05:31,510 --> 00:05:37,480
like five six seven samples per Datagram

108
00:05:34,750 --> 00:05:39,940
so in the end<font color="#E5E5E5"> we end up</font><font color="#CCCCCC"> with like 700</font>

109
00:05:37,480 --> 00:05:44,380
UDP datagrams arriving at<font color="#CCCCCC"> our collector</font>

110
00:05:39,940 --> 00:05:48,310
and<font color="#E5E5E5"> 5 case samples to be parsed and</font>

111
00:05:44,380 --> 00:05:51,250
analyzed so the software we want to use

112
00:05:48,310 --> 00:05:53,620
so we have to use<font color="#E5E5E5"> needs to perform and</font>

113
00:05:51,250 --> 00:05:55,390
needs<font color="#E5E5E5"> to handle that amount of data so</font>

114
00:05:53,620 --> 00:05:58,750
even if<font color="#E5E5E5"> it's sampled information it's</font>

115
00:05:55,390 --> 00:06:05,830
still a lot of stuff coming<font color="#E5E5E5"> in we have</font>

116
00:05:58,750 --> 00:06:11,980
to look<font color="#E5E5E5"> at one shorts lied about the MIT</font>

117
00:06:05,830 --> 00:06:14,560
<font color="#CCCCCC">G stuff so it looks like the small Peaks</font>

118
00:06:11,980 --> 00:06:18,850
and going up and down of the graphs of

119
00:06:14,560 --> 00:06:24,400
our traffic graphs that is due to cpu

120
00:06:18,850 --> 00:06:27,670
load io issues and and general mr TG

121
00:06:24,400 --> 00:06:32,500
issues the software<font color="#CCCCCC"> has and that's</font>

122
00:06:27,670 --> 00:06:34,180
something we can avoid with the SQL

123
00:06:32,500 --> 00:06:36,930
counter samples because we don't have<font color="#E5E5E5"> to</font>

124
00:06:34,180 --> 00:06:39,550
pull the<font color="#E5E5E5"> devices all the time so it's</font>

125
00:06:36,930 --> 00:06:44,170
well better for devices and better for

126
00:06:39,550 --> 00:06:46,270
44<font color="#CCCCCC"> in the</font><font color="#E5E5E5"> end are collecting server to</font>

127
00:06:44,170 --> 00:06:52,660
to plot the graphs out of counter

128
00:06:46,270 --> 00:06:54,130
samples from<font color="#E5E5E5"> s flow and something about</font>

129
00:06:52,660 --> 00:06:57,310
the sampling rate because<font color="#E5E5E5"> I did a lot of</font>

130
00:06:54,130 --> 00:06:59,260
testing in our lap with generated

131
00:06:57,310 --> 00:07:03,690
traffic to figure out what would<font color="#CCCCCC"> be the</font>

132
00:06:59,260 --> 00:07:08,200
best sampling right to to go for an end

133
00:07:03,690 --> 00:07:12,090
well that's a graph showing showing a

134
00:07:08,200 --> 00:07:16,030
foundry<font color="#CCCCCC"> rx8 with we plugged in a</font>

135
00:07:12,090 --> 00:07:18,070
different interface with a different

136
00:07:16,030 --> 00:07:21,099
amount of interfaces on one blade on

137
00:07:18,070 --> 00:07:23,409
phone we are excited the blade<font color="#E5E5E5"> CPUs used</font>

138
00:07:21,100 --> 00:07:26,170
for for sampling the data and for

139
00:07:23,410 --> 00:07:29,440
packing the UDP packets so I was

140
00:07:26,170 --> 00:07:32,560
watching the the<font color="#E5E5E5"> cpu load on the</font>

141
00:07:29,440 --> 00:07:38,110
<font color="#E5E5E5">specific blade we used to test that so</font>

142
00:07:32,560 --> 00:07:40,240
there's like eight 12 and 16 interfaces

143
00:07:38,110 --> 00:07:42,750
on one blade with different amount of

144
00:07:40,240 --> 00:07:45,990
frames pushed over this one blade

145
00:07:42,750 --> 00:07:48,420
and it looks<font color="#E5E5E5"> like that so at some point</font>

146
00:07:45,990 --> 00:07:51,720
we decided to go for 8k as a sampling

147
00:07:48,420 --> 00:07:54,930
rate because it seems kind of safe in

148
00:07:51,720 --> 00:07:58,670
the end the the highest amount of packet

149
00:07:54,930 --> 00:08:02,310
we packets<font color="#E5E5E5"> were used to to test that is</font>

150
00:07:58,670 --> 00:08:04,200
what was it 30 40 million texts per

151
00:08:02,310 --> 00:08:05,640
second which is<font color="#E5E5E5"> pretty</font><font color="#CCCCCC"> much the</font><font color="#E5E5E5"> amount</font>

152
00:08:04,200 --> 00:08:07,950
of packets we have on the whole am-6

153
00:08:05,640 --> 00:08:10,770
platform so that shouldn't happen on one

154
00:08:07,950 --> 00:08:13,860
blade but it was interesting<font color="#CCCCCC"> to see what</font>

155
00:08:10,770 --> 00:08:17,070
what's going on then so we went for like

156
00:08:13,860 --> 00:08:21,240
<font color="#E5E5E5">safe way to to not have any issues with</font>

157
00:08:17,070 --> 00:08:24,030
<font color="#CCCCCC">a hardware in the end and we we use 8k</font>

158
00:08:21,240 --> 00:08:29,600
as something right right now that looks

159
00:08:24,030 --> 00:08:29,599
pretty<font color="#CCCCCC"> much the same on on the RX 16 and</font>

160
00:08:30,230 --> 00:08:36,510
it's a bit<font color="#E5E5E5"> different on all the front we</font>

161
00:08:33,270 --> 00:08:39,000
<font color="#CCCCCC">have where</font><font color="#E5E5E5"> because they don't have blade</font>

162
00:08:36,510 --> 00:08:43,950
<font color="#CCCCCC">CPUs they only have one cpu in the</font>

163
00:08:39,000 --> 00:08:46,620
switch so well but it's still using it's

164
00:08:43,950 --> 00:08:49,440
still using up the<font color="#E5E5E5"> cpu and still 8k was</font>

165
00:08:46,620 --> 00:08:55,130
on unlock did the older devices<font color="#CCCCCC"> it was</font>

166
00:08:49,440 --> 00:08:58,140
still good<font color="#E5E5E5"> some other things about</font>

167
00:08:55,130 --> 00:09:02,460
hardware that are interesting is for

168
00:08:58,140 --> 00:09:04,970
<font color="#CCCCCC">example that so as flow samples the</font>

169
00:09:02,460 --> 00:09:07,800
packets only going in one direction

170
00:09:04,970 --> 00:09:10,470
which means that<font color="#E5E5E5"> in the end the vendor</font>

171
00:09:07,800 --> 00:09:14,069
has to decide if they<font color="#E5E5E5"> sample inbound</font>

172
00:09:10,470 --> 00:09:18,180
traffic or unbound traffic and foundry

173
00:09:14,070 --> 00:09:21,410
devices<font color="#CCCCCC"> it's inbound which means that if</font>

174
00:09:18,180 --> 00:09:24,510
packets are dropped inside a switch we

175
00:09:21,410 --> 00:09:26,430
don't really know about<font color="#E5E5E5"> that because we</font>

176
00:09:24,510 --> 00:09:27,780
see like packets coming in and we don't

177
00:09:26,430 --> 00:09:31,469
<font color="#E5E5E5">know if</font><font color="#CCCCCC"> they go out again on the other</font>

178
00:09:27,780 --> 00:09:33,480
<font color="#E5E5E5">side on</font><font color="#CCCCCC"> force 10 devices</font><font color="#E5E5E5"> it's exactly</font>

179
00:09:31,470 --> 00:09:35,490
the other way around<font color="#E5E5E5"> so you don't know</font>

180
00:09:33,480 --> 00:09:37,320
how<font color="#CCCCCC"> much actually got pushed into the</font>

181
00:09:35,490 --> 00:09:40,620
switch but<font color="#E5E5E5"> you know what came out of it</font>

182
00:09:37,320 --> 00:09:44,160
<font color="#E5E5E5">again and the member to member graphs we</font>

183
00:09:40,620 --> 00:09:48,360
we do which is for example<font color="#CCCCCC"> on the right</font>

184
00:09:44,160 --> 00:09:50,610
side<font color="#CCCCCC"> we assume pretty much that</font>

185
00:09:48,360 --> 00:09:53,580
everything one member pushes to the

186
00:09:50,610 --> 00:09:55,560
other one is also<font color="#E5E5E5"> coming out on the</font>

187
00:09:53,580 --> 00:09:56,220
other side that's why<font color="#E5E5E5"> we plot in an</font>

188
00:09:55,560 --> 00:09:58,920
outgoing

189
00:09:56,220 --> 00:10:03,000
in a graph but as we can<font color="#CCCCCC"> see there it's</font>

190
00:09:58,920 --> 00:10:04,890
like<font color="#CCCCCC"> well</font><font color="#E5E5E5"> it's I think it's more</font><font color="#CCCCCC"> than a</font>

191
00:10:03,000 --> 00:10:10,590
geek and this member actually only has a

192
00:10:04,890 --> 00:10:12,360
<font color="#CCCCCC">gay</font><font color="#E5E5E5"> part so you don't yeah we know that</font>

193
00:10:10,590 --> 00:10:14,730
<font color="#E5E5E5">somebody is trying to push one or two</font>

194
00:10:12,360 --> 00:10:18,270
gig to dismember but it's not ending up

195
00:10:14,730 --> 00:10:21,510
there properly so that's one interesting

196
00:10:18,270 --> 00:10:23,400
thing you can find out<font color="#CCCCCC"> about Hardware</font>

197
00:10:21,510 --> 00:10:26,580
different implementations of different

198
00:10:23,400 --> 00:10:29,810
vendors and as well another thing while

199
00:10:26,580 --> 00:10:32,910
I was testing the counter samples is

200
00:10:29,810 --> 00:10:35,959
that so you define a fixed polling

201
00:10:32,910 --> 00:10:39,959
interval for the counter samples and

202
00:10:35,960 --> 00:10:42,480
means for example every 300 seconds

203
00:10:39,960 --> 00:10:44,850
because I want<font color="#E5E5E5"> to plot a graph in five</font>

204
00:10:42,480 --> 00:10:49,470
minutes<font color="#E5E5E5"> so okay 300 seconds should be</font>

205
00:10:44,850 --> 00:10:52,590
enough<font color="#CCCCCC"> to get the interface counters so</font>

206
00:10:49,470 --> 00:10:55,170
if i do that i cannot i don't know when

207
00:10:52,590 --> 00:10:57,260
the sample<font color="#E5E5E5"> is actually taken so it might</font>

208
00:10:55,170 --> 00:11:00,540
be that<font color="#E5E5E5"> like within the time frame of</font>

209
00:10:57,260 --> 00:11:03,210
300 seconds counter number one is coming

210
00:11:00,540 --> 00:11:06,240
after 100 seconds and counter number two

211
00:11:03,210 --> 00:11:08,790
after 200 so if<font color="#E5E5E5"> i would like to add up</font>

212
00:11:06,240 --> 00:11:11,400
<font color="#CCCCCC">the data and make a</font><font color="#E5E5E5"> total graph of all</font>

213
00:11:08,790 --> 00:11:14,280
the counters at the<font color="#CCCCCC"> end i have different</font>

214
00:11:11,400 --> 00:11:16,680
values from different times which<font color="#CCCCCC"> is</font>

215
00:11:14,280 --> 00:11:20,730
well not<font color="#E5E5E5"> really useful because if i want</font>

216
00:11:16,680 --> 00:11:23,969
<font color="#E5E5E5">to have a total graph two on one certain</font>

217
00:11:20,730 --> 00:11:27,510
point<font color="#E5E5E5"> I need I i need the counter</font>

218
00:11:23,970 --> 00:11:32,970
information of that<font color="#CCCCCC"> time and not like 30</font>

219
00:11:27,510 --> 00:11:36,890
seconds before that so well it's also an

220
00:11:32,970 --> 00:11:39,360
implementation question well they might

221
00:11:36,890 --> 00:11:41,520
consider to do something like<font color="#E5E5E5"> okay i can</font>

222
00:11:39,360 --> 00:11:44,840
<font color="#E5E5E5">define that i would like to have it</font>

223
00:11:41,520 --> 00:11:48,030
within 300 seconds but at<font color="#E5E5E5"> the end of a</font>

224
00:11:44,840 --> 00:11:49,800
full minute or something like that we

225
00:11:48,030 --> 00:11:52,890
cannot configure that on the switches so

226
00:11:49,800 --> 00:11:56,550
what we decided to do in the end is and

227
00:11:52,890 --> 00:11:59,460
we tested that as well a lot to define a

228
00:11:56,550 --> 00:12:02,699
sampling rate a counter polling interval

229
00:11:59,460 --> 00:12:05,840
of one second so we're getting<font color="#E5E5E5"> all the</font>

230
00:12:02,700 --> 00:12:08,370
interface data every second and

231
00:12:05,840 --> 00:12:09,220
basically we throw away everything we

232
00:12:08,370 --> 00:12:12,279
<font color="#E5E5E5">get and we only</font>

233
00:12:09,220 --> 00:12:16,329
keep the last one the orange one in the

234
00:12:12,279 --> 00:12:19,089
graph there it's a bit a waste of data

235
00:12:16,329 --> 00:12:22,019
because we don't need it but the

236
00:12:19,089 --> 00:12:26,709
hardware is dealing with<font color="#E5E5E5"> that and we</font>

237
00:12:22,019 --> 00:12:28,449
yeah have at least the current data at

238
00:12:26,709 --> 00:12:33,420
<font color="#CCCCCC">the end when we want them when we want</font>

239
00:12:28,449 --> 00:12:38,258
<font color="#E5E5E5">to plot the stuff okay that's about</font>

240
00:12:33,420 --> 00:12:41,410
hardware and findings software there are

241
00:12:38,259 --> 00:12:45,579
a couple of tools out there to use

242
00:12:41,410 --> 00:12:49,600
analyze on<font color="#CCCCCC"> the collector side one is a</font>

243
00:12:45,579 --> 00:12:51,250
slow tool from in<font color="#E5E5E5"> Monday it's it's an</font>

244
00:12:49,600 --> 00:12:54,459
open source tool and it's pretty much

245
00:12:51,250 --> 00:12:56,259
<font color="#E5E5E5">for testing purposes because it's just</font>

246
00:12:54,459 --> 00:12:57,969
<font color="#E5E5E5">plotting out it's just printing out the</font>

247
00:12:56,259 --> 00:13:01,810
data to send it out and you just see

248
00:12:57,970 --> 00:13:04,660
what<font color="#E5E5E5"> it is I</font><font color="#CCCCCC"> know that some people parse</font>

249
00:13:01,810 --> 00:13:08,138
the output of this tool again<font color="#E5E5E5"> to two</font>

250
00:13:04,660 --> 00:13:11,649
then count analyze and and do whatever

251
00:13:08,139 --> 00:13:16,480
with it we couldn't do that because well

252
00:13:11,649 --> 00:13:18,069
for 5k packets per second forest via one

253
00:13:16,480 --> 00:13:22,990
tool and another that wasn't working

254
00:13:18,069 --> 00:13:27,819
<font color="#E5E5E5">anymore PMX is also see</font><font color="#CCCCCC"> which software</font>

255
00:13:22,990 --> 00:13:31,120
<font color="#CCCCCC">written and see that one is that one is</font>

256
00:13:27,819 --> 00:13:33,099
storing the data to a database so we

257
00:13:31,120 --> 00:13:35,889
could choose between my sequel and

258
00:13:33,100 --> 00:13:39,220
<font color="#CCCCCC">postgres to write the whole packet data</font>

259
00:13:35,889 --> 00:13:41,589
down that is first of<font color="#E5E5E5"> all it wasn't</font>

260
00:13:39,220 --> 00:13:44,079
working<font color="#E5E5E5"> with 5k packets per second again</font>

261
00:13:41,589 --> 00:13:46,059
and second of all we<font color="#E5E5E5"> don't need the</font>

262
00:13:44,079 --> 00:13:48,550
whole data we<font color="#E5E5E5"> don't need everything we</font>

263
00:13:46,059 --> 00:13:50,079
<font color="#E5E5E5">get there because to make member to</font>

264
00:13:48,550 --> 00:13:51,939
member graphs we pretty much only need

265
00:13:50,079 --> 00:13:53,709
mac addresses and the packet size and we

266
00:13:51,939 --> 00:13:55,629
can calculate what's what's going from

267
00:13:53,709 --> 00:13:58,839
one member to another so that was enough

268
00:13:55,629 --> 00:14:01,899
and<font color="#E5E5E5"> so at some point testing all this Oh</font>

269
00:13:58,839 --> 00:14:04,240
in one traffic sentinels<font color="#E5E5E5"> commercial</font>

270
00:14:01,899 --> 00:14:08,170
software<font color="#CCCCCC"> welcome by that I</font><font color="#E5E5E5"> don't know</font>

271
00:14:04,240 --> 00:14:10,180
exactly how how this is working<font color="#E5E5E5"> so but</font>

272
00:14:08,170 --> 00:14:15,329
some people use that as well and<font color="#E5E5E5"> it</font>

273
00:14:10,180 --> 00:14:17,829
seems<font color="#CCCCCC"> to work it's sanely expensive and</font>

274
00:14:15,329 --> 00:14:20,739
live as flow is the

275
00:14:17,830 --> 00:14:22,750
the library written by Richard<font color="#CCCCCC"> Steinberg</font>

276
00:14:20,740 --> 00:14:26,620
<font color="#CCCCCC">and</font><font color="#E5E5E5"> he presented that last time at nano</font>

277
00:14:22,750 --> 00:14:28,270
cos far as i know it that one wasn't

278
00:14:26,620 --> 00:14:29,500
released yet when we<font color="#E5E5E5"> started working</font><font color="#CCCCCC"> on</font>

279
00:14:28,270 --> 00:14:33,550
that because i<font color="#E5E5E5"> started working on that</font>

280
00:14:29,500 --> 00:14:35,230
like a year<font color="#E5E5E5"> ago and and so so we tested</font>

281
00:14:33,550 --> 00:14:37,719
<font color="#E5E5E5">all the software all the free software</font>

282
00:14:35,230 --> 00:14:40,480
and decided at some point okay it's not

283
00:14:37,720 --> 00:14:43,660
doing exactly what<font color="#E5E5E5"> we want and we have</font>

284
00:14:40,480 --> 00:14:46,120
to customize<font color="#E5E5E5"> it anyway and well yeah</font>

285
00:14:43,660 --> 00:14:48,339
let's just<font color="#E5E5E5"> write our own stuff because</font>

286
00:14:46,120 --> 00:14:50,740
then we can have exactly what we need

287
00:14:48,340 --> 00:14:54,370
and exactly what we want to do so we

288
00:14:50,740 --> 00:14:57,670
started<font color="#E5E5E5"> working on software in</font><font color="#CCCCCC"> Perl</font>

289
00:14:54,370 --> 00:15:04,150
because half of the m6 knock is<font color="#E5E5E5"> yeah</font>

290
00:14:57,670 --> 00:15:07,750
into pearl so first I brought<font color="#CCCCCC"> a decoding</font>

291
00:15:04,150 --> 00:15:10,030
module 4 4 s 4 packets net s flow which

292
00:15:07,750 --> 00:15:15,240
is<font color="#E5E5E5"> open source and available at Sipan</font>

293
00:15:10,030 --> 00:15:18,220
and then we wrote a demon around that to

294
00:15:15,240 --> 00:15:21,070
analyze and store the data in our

295
00:15:18,220 --> 00:15:23,650
defaults another thing about databases

296
00:15:21,070 --> 00:15:26,620
and<font color="#E5E5E5"> rd fights in the end if you if you</font>

297
00:15:23,650 --> 00:15:30,490
want to plot data and our<font color="#E5E5E5"> defaults rd is</font>

298
00:15:26,620 --> 00:15:33,070
a database already which<font color="#CCCCCC"> is great</font>

299
00:15:30,490 --> 00:15:35,500
<font color="#E5E5E5">because it's throwing out all data old</font>

300
00:15:33,070 --> 00:15:38,140
data and you you don't need<font color="#CCCCCC"> to clean it</font>

301
00:15:35,500 --> 00:15:40,120
up like common database you have to<font color="#E5E5E5"> take</font>

302
00:15:38,140 --> 00:15:43,180
care of deleting data again and things

303
00:15:40,120 --> 00:15:45,550
like that<font color="#CCCCCC"> so rd is this is pretty cool</font>

304
00:15:43,180 --> 00:15:46,660
too well<font color="#CCCCCC"> i put</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> in there and</font><font color="#E5E5E5"> i can</font>

305
00:15:45,550 --> 00:15:50,740
<font color="#E5E5E5">just leave it</font><font color="#CCCCCC"> there and</font><font color="#E5E5E5"> don't have to</font>

306
00:15:46,660 --> 00:15:53,890
<font color="#E5E5E5">take care of it anymore so it's a bit</font><font color="#CCCCCC"> of</font>

307
00:15:50,740 --> 00:15:56,860
a waste to to to put data into database

308
00:15:53,890 --> 00:16:00,490
first and then into<font color="#E5E5E5"> rd again so we</font>

309
00:15:56,860 --> 00:16:03,430
decided to to just<font color="#E5E5E5"> collect it cash it</font>

310
00:16:00,490 --> 00:16:10,000
somehow<font color="#CCCCCC"> and throw it into rd and it's</font>

311
00:16:03,430 --> 00:16:12,489
done and<font color="#CCCCCC"> we have to like look up stuff</font>

312
00:16:10,000 --> 00:16:14,920
<font color="#E5E5E5">in a database as member databases to</font>

313
00:16:12,490 --> 00:16:18,460
have like names and and and everything

314
00:16:14,920 --> 00:16:20,290
<font color="#E5E5E5">we need which is also in perl everything</font>

315
00:16:18,460 --> 00:16:22,450
we have libraries to access our database

316
00:16:20,290 --> 00:16:26,230
so it was easy to integrate into the

317
00:16:22,450 --> 00:16:28,810
whole m6 environment the software is

318
00:16:26,230 --> 00:16:29,990
also used by a<font color="#E5E5E5"> couple of other people by</font>

319
00:16:28,810 --> 00:16:32,709
now the<font color="#E5E5E5"> VN</font>

320
00:16:29,990 --> 00:16:35,649
internet exchange implemented their own

321
00:16:32,709 --> 00:16:38,329
demon around this net s<font color="#E5E5E5"> la module and</font>

322
00:16:35,649 --> 00:16:42,860
we've been in<font color="#E5E5E5"> contact a lot and I pretty</font>

323
00:16:38,330 --> 00:16:44,420
much did the same the same<font color="#E5E5E5"> thing like</font>

324
00:16:42,860 --> 00:16:50,089
plotting member to member graphs and

325
00:16:44,420 --> 00:16:53,689
stuff so performance of this pearl

326
00:16:50,089 --> 00:16:55,520
software is well the decoding is

327
00:16:53,690 --> 00:16:59,450
obviously slow and pearl then we could

328
00:16:55,520 --> 00:17:04,699
we could have<font color="#E5E5E5"> it and see but it's it's</font>

329
00:16:59,450 --> 00:17:08,329
still it's still ok we can we the server

330
00:17:04,699 --> 00:17:10,130
can handle it and to have it better

331
00:17:08,329 --> 00:17:13,849
integrated into our environment I think

332
00:17:10,130 --> 00:17:18,199
it's it's<font color="#CCCCCC"> okay to to to have like well</font>

333
00:17:13,849 --> 00:17:22,099
some cpu load we are<font color="#CCCCCC"> I was thinking</font>

334
00:17:18,199 --> 00:17:25,459
<font color="#CCCCCC">about maybe making a part</font><font color="#E5E5E5"> of it and see</font>

335
00:17:22,099 --> 00:17:29,000
and and and have like a pro thing around

336
00:17:25,459 --> 00:17:32,030
that but that's something think<font color="#CCCCCC"> about</font>

337
00:17:29,000 --> 00:17:34,460
but it's really like I think at<font color="#CCCCCC"> amex</font>

338
00:17:32,030 --> 00:17:36,740
it's pretty much like really really a

339
00:17:34,460 --> 00:17:39,470
lot<font color="#CCCCCC"> of data we have to to to to parse</font>

340
00:17:36,740 --> 00:17:41,990
and store and everybody else has less

341
00:17:39,470 --> 00:17:48,530
shouldn't have any issues with with cpu

342
00:17:41,990 --> 00:17:51,679
on that so what we do with a member to

343
00:17:48,530 --> 00:17:54,950
member information is we cache the data

344
00:17:51,679 --> 00:17:58,790
in the demon running and every five

345
00:17:54,950 --> 00:18:03,410
minutes we write down to our defaults we

346
00:17:58,790 --> 00:18:09,830
have about 450 members right now 450

347
00:18:03,410 --> 00:18:16,300
ports members ports so that ends up in

348
00:18:09,830 --> 00:18:20,240
well to a maximum of 200 k rd files

349
00:18:16,300 --> 00:18:22,190
which is<font color="#CCCCCC"> a lot and but from from what we</font>

350
00:18:20,240 --> 00:18:24,200
see right now our conversations are

351
00:18:22,190 --> 00:18:27,790
peering going on between the members we

352
00:18:24,200 --> 00:18:30,320
<font color="#CCCCCC">are plotting 550,000 50,000 graphs and</font>

353
00:18:27,790 --> 00:18:35,889
the service doing that and like<font color="#E5E5E5"> a couple</font>

354
00:18:30,320 --> 00:18:35,889
of seconds so that<font color="#CCCCCC"> is still working</font>

355
00:18:37,210 --> 00:18:47,629
<font color="#E5E5E5">okay and some results on on accuracy so</font>

356
00:18:44,539 --> 00:18:49,970
it's a well as well is statistics

357
00:18:47,629 --> 00:18:56,899
because we don't see everything and we

358
00:18:49,970 --> 00:18:59,059
couldn't so what I was trying as to get

359
00:18:56,899 --> 00:19:02,299
all the data together and to<font color="#E5E5E5"> compare it</font>

360
00:18:59,059 --> 00:19:05,990
<font color="#E5E5E5">with the with report</font><font color="#CCCCCC"> mr TG graphs to see</font>

361
00:19:02,299 --> 00:19:08,779
if it's actually<font color="#E5E5E5"> kind of accurate and it</font>

362
00:19:05,990 --> 00:19:11,750
is but because<font color="#E5E5E5"> it's statistics so it's</font>

363
00:19:08,779 --> 00:19:14,600
it's the<font color="#E5E5E5"> smaller amount of a certain</font>

364
00:19:11,750 --> 00:19:17,149
type of data you're looking for is the

365
00:19:14,600 --> 00:19:22,370
the bigger the error is in the end so if

366
00:19:17,149 --> 00:19:24,768
we<font color="#CCCCCC"> look for like a small ambit port from</font>

367
00:19:22,370 --> 00:19:27,189
<font color="#CCCCCC">a</font><font color="#E5E5E5"> 10mb port from a member and he's not</font>

368
00:19:24,769 --> 00:19:29,720
pushing a lot<font color="#E5E5E5"> of traffic we the error is</font>

369
00:19:27,190 --> 00:19:32,570
getting bigger in the<font color="#CCCCCC"> end but it's kind</font>

370
00:19:29,720 --> 00:19:35,690
of ok because it's<font color="#E5E5E5"> not something people</font>

371
00:19:32,570 --> 00:19:38,500
depend on<font color="#E5E5E5"> and it's not values that they</font>

372
00:19:35,690 --> 00:19:42,950
really will have to have every second

373
00:19:38,500 --> 00:19:45,019
bit of it so so<font color="#CCCCCC"> far like having an idea</font>

374
00:19:42,950 --> 00:19:46,580
of who you're peering with and what the

375
00:19:45,019 --> 00:19:50,720
amount of hearings between the members

376
00:19:46,580 --> 00:19:52,490
it's<font color="#CCCCCC"> okay around that in the end after</font>

377
00:19:50,720 --> 00:19:54,350
the software was running we collected

378
00:19:52,490 --> 00:19:57,409
data for a couple of months i wrote a

379
00:19:54,350 --> 00:19:58,879
web interface around that just to give

380
00:19:57,409 --> 00:20:01,340
an impression it looks a bit like that

381
00:19:58,879 --> 00:20:03,980
and it's calculating the stuff up front

382
00:20:01,340 --> 00:20:06,559
so we have like a top 10 or top

383
00:20:03,980 --> 00:20:09,460
<font color="#E5E5E5">something list the members</font><font color="#CCCCCC"> can can look</font>

384
00:20:06,559 --> 00:20:14,899
at and see where the traffic is going<font color="#CCCCCC"> to</font>

385
00:20:09,460 --> 00:20:18,710
also<font color="#E5E5E5"> we have tools now for our own usage</font>

386
00:20:14,899 --> 00:20:22,070
like overviews like that to see like the

387
00:20:18,710 --> 00:20:25,970
top<font color="#E5E5E5"> something p rings between our</font>

388
00:20:22,070 --> 00:20:30,500
members and things like that always

389
00:20:25,970 --> 00:20:32,480
funny to present as the ipv6 graphs we

390
00:20:30,500 --> 00:20:34,970
have because we<font color="#E5E5E5"> were interested in</font>

391
00:20:32,480 --> 00:20:37,940
seeing how<font color="#E5E5E5"> much ipv6 traffic is actually</font>

392
00:20:34,970 --> 00:20:39,500
going over the hands explore form it was

393
00:20:37,940 --> 00:20:42,470
a bit more<font color="#E5E5E5"> in the beginning I think then</font>

394
00:20:39,500 --> 00:20:44,210
some member forgot to turn on<font color="#E5E5E5"> I physics</font>

395
00:20:42,470 --> 00:20:47,190
routing again after they<font color="#E5E5E5"> migrated to the</font>

396
00:20:44,210 --> 00:20:51,660
port and now it's less

397
00:20:47,190 --> 00:20:57,480
good yeah so what people do with that

398
00:20:51,660 --> 00:20:58,860
now is well they use it I heard from a

399
00:20:57,480 --> 00:21:03,120
couple of members that they're actually

400
00:20:58,860 --> 00:21:07,020
<font color="#E5E5E5">looking at it and they use</font><font color="#CCCCCC"> it for like</font>

401
00:21:03,120 --> 00:21:09,360
traffic engineering in one example is

402
00:21:07,020 --> 00:21:11,310
<font color="#E5E5E5">that somebody told me he was about to</font>

403
00:21:09,360 --> 00:21:14,449
set up a private viewing with somebody

404
00:21:11,310 --> 00:21:16,500
else and after<font color="#E5E5E5"> he looked at one gig</font>

405
00:21:14,450 --> 00:21:18,450
connection and after he looked at as

406
00:21:16,500 --> 00:21:20,130
flow yes I go well but we're pushing one

407
00:21:18,450 --> 00:21:22,400
or two gig there<font color="#CCCCCC"> so it doesn't really</font>

408
00:21:20,130 --> 00:21:25,110
make a lot of sense so I stayed

409
00:21:22,400 --> 00:21:26,730
obviously a couple of members see that

410
00:21:25,110 --> 00:21:28,469
they do enough traffic with somebody

411
00:21:26,730 --> 00:21:33,050
else to actually set<font color="#CCCCCC"> up a private</font>

412
00:21:28,470 --> 00:21:36,990
peering so they leave the US well yeah

413
00:21:33,050 --> 00:21:40,500
<font color="#CCCCCC">but it is</font><font color="#E5E5E5"> it is useful at is use it is</font>

414
00:21:36,990 --> 00:21:44,640
also useful for us to to to see what's

415
00:21:40,500 --> 00:21:49,080
going on well somebody is standing

416
00:21:44,640 --> 00:21:56,570
traffic in some weird way and we look at

417
00:21:49,080 --> 00:21:59,750
it a lot mmm another example is we were

418
00:21:56,570 --> 00:22:01,800
interested to see how much<font color="#CCCCCC"> of the</font>

419
00:21:59,750 --> 00:22:03,780
members traffic is actually going off

420
00:22:01,800 --> 00:22:05,639
the core because we have like a core<font color="#CCCCCC"> and</font>

421
00:22:03,780 --> 00:22:09,750
a lot of apps which is<font color="#E5E5E5"> connected to that</font>

422
00:22:05,640 --> 00:22:11,910
and we<font color="#CCCCCC"> wanted to shift around things a</font>

423
00:22:09,750 --> 00:22:14,340
bit and so we were looking<font color="#CCCCCC"> at as well to</font>

424
00:22:11,910 --> 00:22:16,470
see<font color="#CCCCCC"> okay that member is not pushing a</font>

425
00:22:14,340 --> 00:22:22,169
<font color="#E5E5E5">lot over there so we can change our</font>

426
00:22:16,470 --> 00:22:24,030
architecture based on that what I'm busy

427
00:22:22,170 --> 00:22:30,140
<font color="#CCCCCC">with work what I'm busy with right now</font>

428
00:22:24,030 --> 00:22:33,149
is to work on a on a way of

429
00:22:30,140 --> 00:22:35,820
notifications to have like emails or

430
00:22:33,150 --> 00:22:37,560
notifications about hey something

431
00:22:35,820 --> 00:22:39,240
happened here or something is going on

432
00:22:37,560 --> 00:22:40,950
<font color="#E5E5E5">there because right now we just have to</font>

433
00:22:39,240 --> 00:22:45,300
look at<font color="#E5E5E5"> the graphs to to figure out</font>

434
00:22:40,950 --> 00:22:48,570
what's what's going on right now so we

435
00:22:45,300 --> 00:22:52,399
keep<font color="#CCCCCC"> working on that and oh we have some</font>

436
00:22:48,570 --> 00:22:52,399
good experience<font color="#CCCCCC"> with it so far</font><font color="#E5E5E5"> and</font>

437
00:22:53,580 --> 00:23:09,629
and that's<font color="#E5E5E5"> it questions there's no other</font>

438
00:23:05,940 --> 00:23:11,570
questions I have one you<font color="#CCCCCC"> showed an S</font>

439
00:23:09,630 --> 00:23:14,790
flow based traffic engineering matrix

440
00:23:11,570 --> 00:23:16,590
it's quite common practice at internet

441
00:23:14,790 --> 00:23:18,750
exchanges to generate appearing matrix

442
00:23:16,590 --> 00:23:20,820
from data in the rotating registries

443
00:23:18,750 --> 00:23:28,590
have you considered comparing the two

444
00:23:20,820 --> 00:23:31,860
for consistency but we the Vienna and in

445
00:23:28,590 --> 00:23:33,480
exchange they make appearing matrix with

446
00:23:31,860 --> 00:23:37,370
<font color="#CCCCCC">us for that and they actually published</font>

447
00:23:33,480 --> 00:23:41,460
it but a lot<font color="#CCCCCC"> of members were not really</font>

448
00:23:37,370 --> 00:23:44,879
happy about it so well they have an

449
00:23:41,460 --> 00:23:47,340
option to opt out there and not be in

450
00:23:44,880 --> 00:23:49,950
the matrix but<font color="#E5E5E5"> it's then it's not really</font>

451
00:23:47,340 --> 00:23:53,070
<font color="#E5E5E5">useful anymore when you have not</font>

452
00:23:49,950 --> 00:23:55,710
everybody in we're not that<font color="#CCCCCC"> as that</font><font color="#E5E5E5"> is</font>

453
00:23:53,070 --> 00:24:01,230
only for our usage and we don't<font color="#E5E5E5"> we don't</font>

454
00:23:55,710 --> 00:24:03,320
publish that<font color="#CCCCCC"> okay thanks very much thank</font>

455
00:24:01,230 --> 00:24:03,320
<font color="#E5E5E5">you</font>

