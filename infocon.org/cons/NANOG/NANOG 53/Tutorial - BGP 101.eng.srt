1
00:00:00,060 --> 00:00:03,629
and then I'll talk<font color="#E5E5E5"> about some</font><font color="#CCCCCC"> AG be</font>

2
00:00:01,500 --> 00:00:05,160
scaling<font color="#CCCCCC"> rat reflection</font><font color="#E5E5E5"> and</font>

3
00:00:03,629 --> 00:00:07,980
<font color="#CCCCCC">Confederations and what that</font><font color="#E5E5E5"> does to</font>

4
00:00:05,160 --> 00:00:09,870
routes and paths<font color="#CCCCCC"> and</font><font color="#E5E5E5"> then lastly if we</font>

5
00:00:07,980 --> 00:00:11,670
have some time I'll talk<font color="#E5E5E5"> about some BGP</font>

6
00:00:09,870 --> 00:00:14,309
mechanics you<font color="#CCCCCC"> know how to</font><font color="#E5E5E5"> configure BGP</font>

7
00:00:11,670 --> 00:00:17,580
and<font color="#E5E5E5"> troubleshoot and things like that</font><font color="#CCCCCC"> so</font>

8
00:00:14,309 --> 00:00:21,169
<font color="#CCCCCC">let's start off what is BGP</font><font color="#E5E5E5"> well it's</font>

9
00:00:17,580 --> 00:00:23,538
the border<font color="#E5E5E5"> gateway routing protocol</font>

10
00:00:21,170 --> 00:00:26,039
<font color="#CCCCCC">fantastic we all know what it is right</font>

11
00:00:23,539 --> 00:00:28,619
<font color="#CCCCCC">this is the typical definition that you</font>

12
00:00:26,039 --> 00:00:30,150
see of BGP<font color="#CCCCCC"> it's an exterior</font><font color="#E5E5E5"> gateway</font>

13
00:00:28,619 --> 00:00:32,369
routing protocol used for inter

14
00:00:30,150 --> 00:00:36,629
autonomous system routing<font color="#E5E5E5"> and the</font>

15
00:00:32,369 --> 00:00:38,790
current<font color="#E5E5E5"> RFC defining it is</font><font color="#CCCCCC"> 42 71 an</font>

16
00:00:36,630 --> 00:00:40,829
<font color="#E5E5E5">autonomous system typically is defined</font>

17
00:00:38,790 --> 00:00:42,360
as a single network that is<font color="#E5E5E5"> indoor a</font>

18
00:00:40,829 --> 00:00:44,879
single<font color="#E5E5E5"> administration with a single</font>

19
00:00:42,360 --> 00:00:46,739
routing policy and this routing domain

20
00:00:44,879 --> 00:00:49,500
is a time<font color="#E5E5E5"> assigned an autonomous system</font>

21
00:00:46,739 --> 00:00:51,660
<font color="#E5E5E5">number</font><font color="#CCCCCC"> and a s number or an ASM those</font>

22
00:00:49,500 --> 00:00:54,539
are all the<font color="#E5E5E5"> same things so that's the</font>

23
00:00:51,660 --> 00:00:58,828
typical<font color="#E5E5E5"> definition but still what what</font>

24
00:00:54,539 --> 00:01:00,690
is<font color="#E5E5E5"> BGP so in normal language BGP</font><font color="#CCCCCC"> is the</font>

25
00:00:58,829 --> 00:01:02,370
<font color="#E5E5E5">routing protocol</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> allows networks on</font>

26
00:01:00,690 --> 00:01:04,140
the<font color="#CCCCCC"> internet to signal to</font><font color="#E5E5E5"> other networks</font>

27
00:01:02,370 --> 00:01:06,450
on the<font color="#CCCCCC"> internet</font><font color="#E5E5E5"> what is the set of</font>

28
00:01:04,140 --> 00:01:08,700
<font color="#CCCCCC">destinations that they can reach the</font>

29
00:01:06,450 --> 00:01:10,049
word exterior is used to<font color="#E5E5E5"> refer</font><font color="#CCCCCC"> to the</font>

30
00:01:08,700 --> 00:01:12,330
fact<font color="#E5E5E5"> that</font><font color="#CCCCCC"> it's intended to be used</font>

31
00:01:10,049 --> 00:01:14,850
<font color="#E5E5E5">between networks on</font><font color="#CCCCCC"> the exterior and</font>

32
00:01:12,330 --> 00:01:16,890
Inter a house also<font color="#E5E5E5"> is used to refer</font><font color="#CCCCCC"> to</font>

33
00:01:14,850 --> 00:01:17,780
the fact<font color="#CCCCCC"> that is</font><font color="#E5E5E5"> between autonomous</font>

34
00:01:16,890 --> 00:01:21,030
systems

35
00:01:17,780 --> 00:01:22,500
so basically BGP is<font color="#E5E5E5"> a protocol</font><font color="#CCCCCC"> that</font>

36
00:01:21,030 --> 00:01:24,090
<font color="#CCCCCC">allows you</font><font color="#E5E5E5"> to learn multiple paths to</font>

37
00:01:22,500 --> 00:01:26,790
<font color="#E5E5E5">each destination on the internet and</font>

38
00:01:24,090 --> 00:01:30,150
then selects which path path is best<font color="#E5E5E5"> and</font>

39
00:01:26,790 --> 00:01:32,040
uses<font color="#CCCCCC"> that path to forward traffic</font><font color="#E5E5E5"> only</font>

40
00:01:30,150 --> 00:01:34,020
<font color="#E5E5E5">one best path is sent</font><font color="#CCCCCC"> to your neighbors</font>

41
00:01:32,040 --> 00:01:36,420
<font color="#E5E5E5">and if you look at this drawing that I</font>

42
00:01:34,020 --> 00:01:38,699
have over to the left this is<font color="#CCCCCC"> the</font><font color="#E5E5E5"> kata</font>

43
00:01:36,420 --> 00:01:41,820
AS<font color="#CCCCCC"> internet graph each square represents</font>

44
00:01:38,700 --> 00:01:43,680
<font color="#CCCCCC">an autonomous system or a BGP Network on</font>

45
00:01:41,820 --> 00:01:45,270
the<font color="#CCCCCC"> Internet and the lines in between</font>

46
00:01:43,680 --> 00:01:47,130
<font color="#E5E5E5">them indicate one or more</font>

47
00:01:45,270 --> 00:01:50,310
interconnections between those networks

48
00:01:47,130 --> 00:01:51,990
where they're running<font color="#CCCCCC"> BGP</font><font color="#E5E5E5"> so as you can</font>

49
00:01:50,310 --> 00:01:55,140
<font color="#CCCCCC">see there's a fairly dense mesh in the</font>

50
00:01:51,990 --> 00:01:57,770
core lots of<font color="#E5E5E5"> bgp sessions and that's</font>

51
00:01:55,140 --> 00:02:00,180
basically<font color="#E5E5E5"> how routes propagate</font>

52
00:01:57,770 --> 00:02:02,548
throughout the network<font color="#CCCCCC"> so what's an</font>

53
00:02:00,180 --> 00:02:04,530
autonomous system<font color="#E5E5E5"> well it's a single</font>

54
00:02:02,549 --> 00:02:06,649
routing domain and that's typically<font color="#E5E5E5"> what</font>

55
00:02:04,530 --> 00:02:09,060
people<font color="#CCCCCC"> think</font><font color="#E5E5E5"> of when they draw a cloud</font>

56
00:02:06,649 --> 00:02:11,038
but<font color="#E5E5E5"> diving into that cloud we have</font><font color="#CCCCCC"> a</font>

57
00:02:09,060 --> 00:02:11,880
collection<font color="#CCCCCC"> of routers that typically</font>

58
00:02:11,038 --> 00:02:14,040
have a common route

59
00:02:11,880 --> 00:02:16,430
policy they have<font color="#CCCCCC"> a consistent view of</font>

60
00:02:14,040 --> 00:02:18,420
routing usually it's a single<font color="#CCCCCC"> IGP</font>

61
00:02:16,430 --> 00:02:20,900
typically it's under a<font color="#E5E5E5"> common ownership</font>

62
00:02:18,420 --> 00:02:23,940
with common administrative<font color="#E5E5E5"> control and</font>

63
00:02:20,900 --> 00:02:25,800
this network<font color="#E5E5E5"> is assigned a single global</font>

64
00:02:23,940 --> 00:02:29,540
<font color="#E5E5E5">unique autonomous system number for</font>

65
00:02:25,800 --> 00:02:32,610
example<font color="#CCCCCC"> six four four nine</font><font color="#E5E5E5"> six</font>

66
00:02:29,540 --> 00:02:34,290
so where do<font color="#CCCCCC"> ASNs come from the globally</font>

67
00:02:32,610 --> 00:02:36,450
unique ones come<font color="#CCCCCC"> from the five regional</font>

68
00:02:34,290 --> 00:02:39,750
internet routing registries<font color="#CCCCCC"> Arian ripe</font>

69
00:02:36,450 --> 00:02:43,350
<font color="#CCCCCC">aap neck Lac</font><font color="#E5E5E5"> neck</font><font color="#CCCCCC"> AfriNIC there's some</font>

70
00:02:39,750 --> 00:02:46,230
special<font color="#E5E5E5"> a SNS zero and 65535 a reserved</font>

71
00:02:43,350 --> 00:02:49,620
by<font color="#CCCCCC"> Jana</font><font color="#E5E5E5"> so they're not supposed to be</font>

72
00:02:46,230 --> 00:02:52,859
used<font color="#E5E5E5"> private</font><font color="#CCCCCC"> a SNS is</font><font color="#E5E5E5"> that very high</font>

73
00:02:49,620 --> 00:02:55,170
range from 6 4 5 1 2<font color="#E5E5E5"> to 6 5 5 3 4</font>

74
00:02:52,860 --> 00:02:57,690
those are termed for internal<font color="#CCCCCC"> use only</font>

75
00:02:55,170 --> 00:03:00,269
and<font color="#E5E5E5"> shouldn't show up on an AS path in</font>

76
00:02:57,690 --> 00:03:05,460
the<font color="#E5E5E5"> internet and then there's also some</font>

77
00:03:00,270 --> 00:03:09,510
documentation<font color="#E5E5E5"> a SMS per RFC 53.89 from</font><font color="#CCCCCC"> 6</font>

78
00:03:05,460 --> 00:03:16,260
<font color="#CCCCCC">4 4 9 6 through</font><font color="#E5E5E5"> 6 4 5 11 and 6 5 5 3 6</font>

79
00:03:09,510 --> 00:03:19,440
through 6 5 5 5 1<font color="#CCCCCC"> SN format there are</font><font color="#E5E5E5"> 2</font>

80
00:03:16,260 --> 00:03:23,760
byte<font color="#E5E5E5"> a SNS and 4-byte asn</font><font color="#CCCCCC"> s the</font><font color="#E5E5E5"> 2 byte</font>

81
00:03:19,440 --> 00:03:25,560
<font color="#CCCCCC">asns range from 0 to 65535 but we're on</font>

82
00:03:23,760 --> 00:03:27,390
<font color="#E5E5E5">the verge of running out</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> those so we</font>

83
00:03:25,560 --> 00:03:30,630
<font color="#E5E5E5">extended the numbering space and doubled</font>

84
00:03:27,390 --> 00:03:33,359
it by<font color="#E5E5E5"> adding another 16 bits so this</font>

85
00:03:30,630 --> 00:03:36,930
additional range ranges from 65536

86
00:03:33,360 --> 00:03:39,740
through<font color="#CCCCCC"> four billion</font><font color="#E5E5E5"> 294 million nine</font>

87
00:03:36,930 --> 00:03:41,610
hundred<font color="#CCCCCC"> sixty seven</font><font color="#E5E5E5"> thousand</font><font color="#CCCCCC"> 296</font><font color="#E5E5E5"> and</font>

88
00:03:39,740 --> 00:03:42,959
you'll note on<font color="#CCCCCC"> the slide that I've</font>

89
00:03:41,610 --> 00:03:45,540
<font color="#E5E5E5">written it without any commas or</font>

90
00:03:42,959 --> 00:03:48,180
separation<font color="#E5E5E5"> of any type it's a large</font><font color="#CCCCCC"> 10</font>

91
00:03:45,540 --> 00:03:50,609
digit number there was a lot of debate

92
00:03:48,180 --> 00:03:52,350
<font color="#CCCCCC">about how</font><font color="#E5E5E5"> to display these and there</font>

93
00:03:50,610 --> 00:03:54,390
were two basic camps there<font color="#E5E5E5"> was a s plane</font>

94
00:03:52,350 --> 00:03:56,250
which was let's just<font color="#E5E5E5"> display it as a</font>

95
00:03:54,390 --> 00:03:57,690
large<font color="#CCCCCC"> ten digit number these numbers or</font>

96
00:03:56,250 --> 00:04:00,390
<font color="#E5E5E5">you can count them you can think about</font>

97
00:03:57,690 --> 00:04:02,010
them very<font color="#E5E5E5"> easily</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> lots of people</font><font color="#CCCCCC"> have</font>

98
00:04:00,390 --> 00:04:03,869
said you<font color="#CCCCCC"> know even phone numbers which</font>

99
00:04:02,010 --> 00:04:06,209
are<font color="#CCCCCC"> ten digit numbers have divisions so</font>

100
00:04:03,870 --> 00:04:08,850
maybe a long string of<font color="#CCCCCC"> ten digit numbers</font>

101
00:04:06,209 --> 00:04:11,190
is<font color="#E5E5E5"> not a good idea</font><font color="#CCCCCC"> so the other camp was</font>

102
00:04:08,850 --> 00:04:12,840
a s dot notation<font color="#E5E5E5"> and what they suggested</font>

103
00:04:11,190 --> 00:04:14,910
was it should be a<font color="#E5E5E5"> 16-bit number</font>

104
00:04:12,840 --> 00:04:17,459
followed<font color="#E5E5E5"> by a period and</font><font color="#CCCCCC"> another 16-bit</font>

105
00:04:14,910 --> 00:04:20,820
number so for<font color="#E5E5E5"> example the existing is</font>

106
00:04:17,459 --> 00:04:22,919
<font color="#E5E5E5">one two</font><font color="#CCCCCC"> three</font><font color="#E5E5E5"> four would</font><font color="#CCCCCC"> be extended</font>

107
00:04:20,820 --> 00:04:24,719
into<font color="#CCCCCC"> the thirty</font><font color="#E5E5E5"> into the 32-bit space</font>

108
00:04:22,919 --> 00:04:28,500
and become zero point one<font color="#CCCCCC"> two three</font>

109
00:04:24,720 --> 00:04:30,690
<font color="#CCCCCC">four and the new additional</font><font color="#E5E5E5"> range would</font>

110
00:04:28,500 --> 00:04:34,680
start off at one<font color="#CCCCCC"> point zero and go up</font>

111
00:04:30,690 --> 00:04:36,870
<font color="#CCCCCC">through 6535 dot 6535 so there was a lot</font>

112
00:04:34,680 --> 00:04:39,810
of unhappiness<font color="#E5E5E5"> with this type of</font>

113
00:04:36,870 --> 00:04:41,670
<font color="#CCCCCC">arrangement</font><font color="#E5E5E5"> as well</font><font color="#CCCCCC"> people</font><font color="#E5E5E5"> didn't like</font>

114
00:04:39,810 --> 00:04:44,670
to write regular expressions against

115
00:04:41,670 --> 00:04:46,410
this number set that's divided up<font color="#E5E5E5"> and in</font>

116
00:04:44,670 --> 00:04:48,960
regular<font color="#CCCCCC"> expressions the period means a</font>

117
00:04:46,410 --> 00:04:50,550
match of any character<font color="#E5E5E5"> so you'd have</font><font color="#CCCCCC"> to</font>

118
00:04:48,960 --> 00:04:51,900
use the backslash to escape all<font color="#CCCCCC"> of the</font>

119
00:04:50,550 --> 00:04:53,880
periods<font color="#CCCCCC"> if you actually</font><font color="#E5E5E5"> wanted to match</font>

120
00:04:51,900 --> 00:04:55,349
on a period and<font color="#E5E5E5"> there was lots of debate</font>

121
00:04:53,880 --> 00:04:57,270
about<font color="#CCCCCC"> you know maybe we</font><font color="#E5E5E5"> shouldn't use a</font>

122
00:04:55,350 --> 00:04:59,790
dot maybe we should use a semicolon<font color="#E5E5E5"> like</font>

123
00:04:57,270 --> 00:05:01,260
ipv6 addresses and then<font color="#E5E5E5"> people smile</font>

124
00:04:59,790 --> 00:05:04,250
<font color="#CCCCCC">spiraling</font><font color="#E5E5E5"> out of control when people</font>

125
00:05:01,260 --> 00:05:06,810
said well how about<font color="#E5E5E5"> a happy face</font><font color="#CCCCCC"> and</font>

126
00:05:04,250 --> 00:05:09,060
pretty<font color="#E5E5E5"> much now everyone has converged</font>

127
00:05:06,810 --> 00:05:11,850
on a<font color="#CCCCCC"> s-plane for better or for worse</font>

128
00:05:09,060 --> 00:05:16,200
<font color="#CCCCCC">there's also a special is two three four</font>

129
00:05:11,850 --> 00:05:20,370
<font color="#CCCCCC">five six</font><font color="#E5E5E5"> that's used to denote a</font><font color="#CCCCCC"> four</font>

130
00:05:16,200 --> 00:05:23,190
<font color="#CCCCCC">bit a SN</font><font color="#E5E5E5"> for</font><font color="#CCCCCC"> two</font><font color="#E5E5E5"> byte only a SN capable</font>

131
00:05:20,370 --> 00:05:25,080
routers so because you can't send a four

132
00:05:23,190 --> 00:05:27,810
byte<font color="#CCCCCC"> a s in the 80s path</font><font color="#E5E5E5"> two routers</font>

133
00:05:25,080 --> 00:05:29,370
<font color="#CCCCCC">that</font><font color="#E5E5E5"> don't support 4-byte asn s instead</font>

134
00:05:27,810 --> 00:05:33,780
you just<font color="#E5E5E5"> send them two three four five</font>

135
00:05:29,370 --> 00:05:36,750
six some caveats<font color="#E5E5E5"> about a s numbers</font>

136
00:05:33,780 --> 00:05:38,340
networks that are singly home<font color="#E5E5E5"> can</font><font color="#CCCCCC"> use</font>

137
00:05:36,750 --> 00:05:40,710
static<font color="#E5E5E5"> routes to connect to the internet</font>

138
00:05:38,340 --> 00:05:43,229
<font color="#E5E5E5">these networks</font><font color="#CCCCCC"> don't run BGP they don't</font>

139
00:05:40,710 --> 00:05:45,000
have an<font color="#CCCCCC"> ASN they basically don't count</font>

140
00:05:43,230 --> 00:05:46,140
from<font color="#CCCCCC"> the BGP perspective of the world</font>

141
00:05:45,000 --> 00:05:49,290
I'm<font color="#CCCCCC"> not saying these networks aren't</font>

142
00:05:46,140 --> 00:05:50,550
important or useful<font color="#E5E5E5"> or good</font><font color="#CCCCCC"> they</font><font color="#E5E5E5"> just</font>

143
00:05:49,290 --> 00:05:51,870
don't exist<font color="#E5E5E5"> when you're looking at the</font>

144
00:05:50,550 --> 00:05:55,740
view<font color="#E5E5E5"> of the routing table and</font><font color="#CCCCCC"> counting</font>

145
00:05:51,870 --> 00:05:58,080
<font color="#CCCCCC">of networks some transit providers also</font>

146
00:05:55,740 --> 00:06:00,690
<font color="#CCCCCC">allow downstream BGP customers to use</font>

147
00:05:58,080 --> 00:06:02,520
private<font color="#E5E5E5"> guesses</font><font color="#CCCCCC"> to BGP peer with only</font>

148
00:06:00,690 --> 00:06:06,450
<font color="#E5E5E5">them which they then strip off towards</font>

149
00:06:02,520 --> 00:06:08,880
the<font color="#E5E5E5"> rest of the</font><font color="#CCCCCC"> internet</font><font color="#E5E5E5"> from an outside</font>

150
00:06:06,450 --> 00:06:09,599
view these networks don't don't appear

151
00:06:08,880 --> 00:06:11,219
they're invisible

152
00:06:09,600 --> 00:06:12,540
and<font color="#CCCCCC"> this creates kind of</font><font color="#E5E5E5"> an ownership</font>

153
00:06:11,220 --> 00:06:13,740
problem because it looks like<font color="#CCCCCC"> the</font>

154
00:06:12,540 --> 00:06:15,720
transit<font color="#CCCCCC"> provider is</font><font color="#E5E5E5"> the one actually</font>

155
00:06:13,740 --> 00:06:17,280
<font color="#E5E5E5">originating the route so if there's a</font>

156
00:06:15,720 --> 00:06:19,080
problem with that<font color="#CCCCCC"> route announcement or</font>

157
00:06:17,280 --> 00:06:20,729
routing with that route<font color="#E5E5E5"> it looks like</font>

158
00:06:19,080 --> 00:06:21,990
that problem<font color="#CCCCCC"> belongs to the transit</font>

159
00:06:20,730 --> 00:06:25,110
provider<font color="#E5E5E5"> and that's who</font><font color="#CCCCCC"> people will</font>

160
00:06:21,990 --> 00:06:27,900
likely contact if there's an issue<font color="#E5E5E5"> the</font>

161
00:06:25,110 --> 00:06:29,760
other approach is to<font color="#CCCCCC"> use RFC 2270</font><font color="#E5E5E5"> ASOS</font>

162
00:06:27,900 --> 00:06:32,310
<font color="#CCCCCC">and basically what that is is the</font>

163
00:06:29,760 --> 00:06:34,320
transit provider<font color="#E5E5E5"> goes to the</font><font color="#CCCCCC"> RER and</font>

164
00:06:32,310 --> 00:06:36,240
gets a globally<font color="#CCCCCC"> unique ASN and they</font>

165
00:06:34,320 --> 00:06:37,500
register it to themselves<font color="#E5E5E5"> but they</font>

166
00:06:36,240 --> 00:06:38,100
register it in such a way<font color="#CCCCCC"> that it</font>

167
00:06:37,500 --> 00:06:39,660
denotes<font color="#E5E5E5"> that</font>

168
00:06:38,100 --> 00:06:41,340
doesn't belong<font color="#CCCCCC"> to</font><font color="#E5E5E5"> them but it's for use</font>

169
00:06:39,660 --> 00:06:43,770
for<font color="#E5E5E5"> their downstream customers that are</font>

170
00:06:41,340 --> 00:06:45,869
singly home to them and then they allow

171
00:06:43,770 --> 00:06:47,760
as many downstream customers only

172
00:06:45,870 --> 00:06:52,280
<font color="#E5E5E5">connected to that to to them to keep</font>

173
00:06:47,760 --> 00:06:54,930
using<font color="#CCCCCC"> the</font><font color="#E5E5E5"> same</font><font color="#CCCCCC"> is over and over again I</font>

174
00:06:52,280 --> 00:06:56,190
wanted<font color="#E5E5E5"> to do some quick BGP history just</font>

175
00:06:54,930 --> 00:06:58,530
<font color="#E5E5E5">to let you know where we were coming</font>

176
00:06:56,190 --> 00:07:03,300
from<font color="#E5E5E5"> and what some</font><font color="#CCCCCC"> of the</font><font color="#E5E5E5"> issues were so</font>

177
00:06:58,530 --> 00:07:04,830
take you back to<font color="#E5E5E5"> NFS days in 85</font><font color="#CCCCCC"> the NSF</font>

178
00:07:03,300 --> 00:07:07,590
was established to connect six

179
00:07:04,830 --> 00:07:10,440
supercomputing sites together<font color="#E5E5E5"> with 56 km</font>

180
00:07:07,590 --> 00:07:12,960
<font color="#CCCCCC">east lines</font><font color="#E5E5E5"> they had</font><font color="#CCCCCC"> PvP 11s that</font><font color="#E5E5E5"> are</font>

181
00:07:10,440 --> 00:07:14,550
running<font color="#E5E5E5"> gateway</font><font color="#CCCCCC"> software</font><font color="#E5E5E5"> which was</font>

182
00:07:12,960 --> 00:07:18,510
<font color="#E5E5E5">written by Dave Mills called the fuzz</font>

183
00:07:14,550 --> 00:07:21,870
ball<font color="#E5E5E5"> and it ran EGP exterior gateway</font>

184
00:07:18,510 --> 00:07:23,580
protocol version 2<font color="#E5E5E5"> and the way</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> GP</font>

185
00:07:21,870 --> 00:07:25,920
was built it<font color="#E5E5E5"> basically used a spanning</font>

186
00:07:23,580 --> 00:07:28,830
<font color="#CCCCCC">tree algorithm much like</font><font color="#E5E5E5"> Ethernet does</font>

187
00:07:25,920 --> 00:07:30,680
and<font color="#E5E5E5"> it expected</font><font color="#CCCCCC"> that stub gateways would</font>

188
00:07:28,830 --> 00:07:33,060
be<font color="#E5E5E5"> connected to a centrally administered</font>

189
00:07:30,680 --> 00:07:36,300
centrally controlled backbone which was

190
00:07:33,060 --> 00:07:38,610
the ARPANET<font color="#E5E5E5"> and it used an unreliable</font><font color="#CCCCCC"> IP</font>

191
00:07:36,300 --> 00:07:40,530
transport<font color="#E5E5E5"> and a periodic refresh</font><font color="#CCCCCC"> so it</font>

192
00:07:38,610 --> 00:07:44,010
sent the<font color="#E5E5E5"> entire routing table as an</font>

193
00:07:40,530 --> 00:07:45,659
update atomically<font color="#CCCCCC"> the problem was the</font>

194
00:07:44,010 --> 00:07:48,300
network was growing very<font color="#CCCCCC"> rapidly it</font>

195
00:07:45,660 --> 00:07:49,620
really wasn't a simple<font color="#CCCCCC"> pour with stub</font>

196
00:07:48,300 --> 00:07:53,010
networks hanging off of<font color="#E5E5E5"> it as you can</font>

197
00:07:49,620 --> 00:07:55,770
<font color="#E5E5E5">see</font><font color="#CCCCCC"> from this diagram from 86 and it</font>

198
00:07:53,010 --> 00:07:58,230
really wasn't scaling well so in 87<font color="#E5E5E5"> NSF</font>

199
00:07:55,770 --> 00:08:00,450
established an agreement with MCI IBM

200
00:07:58,230 --> 00:08:03,690
and Merritt to upgrade the NSF backbone

201
00:08:00,450 --> 00:08:07,979
to<font color="#E5E5E5"> phase</font><font color="#CCCCCC"> 2</font><font color="#E5E5E5"> and as part of that they</font>

202
00:08:03,690 --> 00:08:10,430
deployed<font color="#CCCCCC"> BGP so entered BGP</font><font color="#E5E5E5"> this is</font>

203
00:08:07,980 --> 00:08:14,490
referred to<font color="#E5E5E5"> as the</font><font color="#CCCCCC"> three napkin protocol</font>

204
00:08:10,430 --> 00:08:17,550
<font color="#CCCCCC">it was</font><font color="#E5E5E5"> actually invented</font><font color="#CCCCCC"> over lunch at</font>

205
00:08:14,490 --> 00:08:19,890
<font color="#CCCCCC">IETF</font><font color="#E5E5E5"> 12 between yakov and Kurt with some</font>

206
00:08:17,550 --> 00:08:22,410
<font color="#E5E5E5">help from Len they basically wrote it</font>

207
00:08:19,890 --> 00:08:24,780
down on three napkins<font color="#CCCCCC"> I understand those</font>

208
00:08:22,410 --> 00:08:26,670
napkins<font color="#CCCCCC"> do not survive they had lots of</font>

209
00:08:24,780 --> 00:08:28,469
ketchup<font color="#E5E5E5"> on them but they were</font>

210
00:08:26,670 --> 00:08:30,270
immediately<font color="#E5E5E5"> transcribed onto</font><font color="#CCCCCC"> these three</font>

211
00:08:28,470 --> 00:08:33,840
pieces<font color="#E5E5E5"> of paper which last I heard were</font>

212
00:08:30,270 --> 00:08:36,299
framed<font color="#E5E5E5"> at juniper</font><font color="#CCCCCC"> and the three napkins</font>

213
00:08:33,840 --> 00:08:38,729
were pictured here the first napkin is

214
00:08:36,299 --> 00:08:40,348
the packet format<font color="#E5E5E5"> the second napkin is</font>

215
00:08:38,729 --> 00:08:43,500
the<font color="#E5E5E5"> description of codes and sub codes</font>

216
00:08:40,349 --> 00:08:45,900
<font color="#E5E5E5">and the third</font><font color="#CCCCCC"> nack napkin was the finite</font>

217
00:08:43,500 --> 00:08:49,140
<font color="#E5E5E5">state machine and this was later</font>

218
00:08:45,900 --> 00:08:51,650
formalized into RFC<font color="#CCCCCC"> 11:05 in June of 89</font>

219
00:08:49,140 --> 00:08:55,110
<font color="#E5E5E5">and then RFC was 17</font>

220
00:08:51,650 --> 00:08:57,060
<font color="#E5E5E5">so a lot has changed in the</font><font color="#CCCCCC"> ietf in RFC</font>

221
00:08:55,110 --> 00:09:01,980
authorship since then if you could

222
00:08:57,060 --> 00:09:03,739
<font color="#E5E5E5">imagine</font><font color="#CCCCCC"> bgp was a 17 page RFC so and</font>

223
00:09:01,980 --> 00:09:07,430
<font color="#E5E5E5">obviously the rest is internet history</font>

224
00:09:03,740 --> 00:09:10,260
<font color="#CCCCCC">in 88 NSF was upgraded to tyonne's</font>

225
00:09:07,430 --> 00:09:12,989
<font color="#CCCCCC">traffic was doubling</font><font color="#E5E5E5"> every</font><font color="#CCCCCC"> 7 months</font><font color="#E5E5E5"> in</font>

226
00:09:10,260 --> 00:09:15,180
<font color="#E5E5E5">89 it was upgraded to</font><font color="#CCCCCC"> t3s that's when</font>

227
00:09:12,990 --> 00:09:21,150
<font color="#E5E5E5">BGP was deployed it had 16 nodes at that</font>

228
00:09:15,180 --> 00:09:23,400
time<font color="#CCCCCC"> in 1990 ARPANET</font><font color="#E5E5E5"> was dissolved</font><font color="#CCCCCC"> it</font>

229
00:09:21,150 --> 00:09:25,680
became BBN and we saw the introduction

230
00:09:23,400 --> 00:09:28,920
of commercial ISPs Union<font color="#CCCCCC"> ette and psi</font>

231
00:09:25,680 --> 00:09:32,729
net<font color="#E5E5E5"> surf net and near net and then</font>

232
00:09:28,920 --> 00:09:35,939
eventually<font color="#E5E5E5"> in 95 NSF net was dissolved</font>

233
00:09:32,730 --> 00:09:37,290
<font color="#CCCCCC">and if you have trouble sleeping tonight</font>

234
00:09:35,940 --> 00:09:38,820
<font color="#CCCCCC">or the rest of this week while you're</font>

235
00:09:37,290 --> 00:09:41,579
here and<font color="#E5E5E5"> go ahead and download some</font><font color="#CCCCCC"> of</font>

236
00:09:38,820 --> 00:09:43,500
these<font color="#CCCCCC"> RFC's and read them they're great</font>

237
00:09:41,580 --> 00:09:45,300
bedtime<font color="#E5E5E5"> reading</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> will show you the</font>

238
00:09:43,500 --> 00:09:47,460
<font color="#E5E5E5">whole history from exterior gateway</font>

239
00:09:45,300 --> 00:09:52,079
protocol<font color="#E5E5E5"> version 1 all the</font><font color="#CCCCCC"> way up to the</font>

240
00:09:47,460 --> 00:09:54,420
current<font color="#E5E5E5"> BGP version 4 so let's jump in</font>

241
00:09:52,080 --> 00:09:56,880
and<font color="#CCCCCC"> take a</font><font color="#E5E5E5"> look at BGP at the 30,000</font>

242
00:09:54,420 --> 00:10:00,839
<font color="#E5E5E5">foot</font><font color="#CCCCCC"> level</font><font color="#E5E5E5"> so a couple of definitions</font><font color="#CCCCCC"> to</font>

243
00:09:56,880 --> 00:10:02,460
start things off<font color="#E5E5E5"> neighbors or peers have</font>

244
00:10:00,840 --> 00:10:04,230
a relationship<font color="#CCCCCC"> between two routers</font>

245
00:10:02,460 --> 00:10:05,640
<font color="#E5E5E5">they're running BGP amongst each other</font>

246
00:10:04,230 --> 00:10:07,050
<font color="#E5E5E5">and there's there's a couple</font><font color="#CCCCCC"> different</font>

247
00:10:05,640 --> 00:10:07,860
<font color="#E5E5E5">types of neighboring or peering</font>

248
00:10:07,050 --> 00:10:11,040
relationships

249
00:10:07,860 --> 00:10:12,540
the first is transit in this case the

250
00:10:11,040 --> 00:10:14,640
network<font color="#E5E5E5"> is usually</font><font color="#CCCCCC"> a customer of an</font>

251
00:10:12,540 --> 00:10:16,020
upstream transit provider and the

252
00:10:14,640 --> 00:10:17,699
network usually<font color="#CCCCCC"> pays that upstream</font>

253
00:10:16,020 --> 00:10:20,340
transit provider to carry their traffic

254
00:10:17,700 --> 00:10:23,130
to all of the<font color="#CCCCCC"> internet</font><font color="#E5E5E5"> peering usually</font>

255
00:10:20,340 --> 00:10:24,870
denoted with<font color="#CCCCCC"> a capital P</font><font color="#E5E5E5"> indicates that</font>

256
00:10:23,130 --> 00:10:27,120
the two<font color="#E5E5E5"> networks are roughly of</font>

257
00:10:24,870 --> 00:10:28,590
equivalent size<font color="#E5E5E5"> and it's mutually</font>

258
00:10:27,120 --> 00:10:30,660
beneficial for<font color="#CCCCCC"> their customers to</font>

259
00:10:28,590 --> 00:10:32,400
<font color="#E5E5E5">exchange routes between them so you</font>

260
00:10:30,660 --> 00:10:34,620
could imagine AT&T is not going to<font color="#E5E5E5"> buy</font>

261
00:10:32,400 --> 00:10:36,120
transit from Verizon and Verizon is not

262
00:10:34,620 --> 00:10:38,400
going to buy transit from<font color="#E5E5E5"> AT&T</font>

263
00:10:36,120 --> 00:10:40,710
but<font color="#CCCCCC"> 18t customers would like to be able</font>

264
00:10:38,400 --> 00:10:43,530
<font color="#E5E5E5">to talk</font><font color="#CCCCCC"> to you Verizon customers</font><font color="#E5E5E5"> they do</font>

265
00:10:40,710 --> 00:10:45,270
that<font color="#E5E5E5"> through this peering exchange and</font>

266
00:10:43,530 --> 00:10:47,220
then the third type<font color="#CCCCCC"> of neighboring or</font>

267
00:10:45,270 --> 00:10:49,740
peering session is a customer

268
00:10:47,220 --> 00:10:51,780
<font color="#CCCCCC">relationship</font><font color="#E5E5E5"> in this case the network is</font>

269
00:10:49,740 --> 00:10:53,430
a transit provider<font color="#CCCCCC"> and he's offering BGP</font>

270
00:10:51,780 --> 00:10:56,660
to his downstream customer who's usually

271
00:10:53,430 --> 00:10:59,250
paying them to carry their routes

272
00:10:56,660 --> 00:11:00,719
default routing<font color="#E5E5E5"> is when you have in all</font>

273
00:10:59,250 --> 00:11:03,090
<font color="#E5E5E5">zeros route which is</font><font color="#CCCCCC"> your gateway of</font>

274
00:11:00,720 --> 00:11:04,380
<font color="#E5E5E5">last resort</font><font color="#CCCCCC"> that's where they'll send</font>

275
00:11:03,090 --> 00:11:04,800
traffic<font color="#E5E5E5"> if</font><font color="#CCCCCC"> you don't know where it</font>

276
00:11:04,380 --> 00:11:06,060
should go

277
00:11:04,800 --> 00:11:07,260
you don't have any more specific

278
00:11:06,060 --> 00:11:10,649
<font color="#CCCCCC">information of where to send</font><font color="#E5E5E5"> that</font>

279
00:11:07,260 --> 00:11:12,540
<font color="#E5E5E5">traffic and the default free zone is an</font>

280
00:11:10,649 --> 00:11:14,640
area<font color="#CCCCCC"> a collection of networks that have</font>

281
00:11:12,540 --> 00:11:16,709
no default route<font color="#E5E5E5"> so these networks</font>

282
00:11:14,640 --> 00:11:18,750
basically<font color="#E5E5E5"> carry reach ability to every</font>

283
00:11:16,709 --> 00:11:19,859
single<font color="#CCCCCC"> destination on the Internet</font><font color="#E5E5E5"> and</font>

284
00:11:18,750 --> 00:11:21,870
<font color="#E5E5E5">if they don't have a route for</font><font color="#CCCCCC"> that</font>

285
00:11:19,860 --> 00:11:25,290
<font color="#CCCCCC">destination</font><font color="#E5E5E5"> they simply can't deliver</font>

286
00:11:21,870 --> 00:11:27,260
the traffic so at a high<font color="#CCCCCC"> level what does</font>

287
00:11:25,290 --> 00:11:29,880
this look<font color="#CCCCCC"> like so we're gonna look at</font>

288
00:11:27,260 --> 00:11:31,319
how routing<font color="#CCCCCC"> information propagates from</font>

289
00:11:29,880 --> 00:11:33,930
various<font color="#E5E5E5"> different customers in this</font>

290
00:11:31,320 --> 00:11:37,470
drawing<font color="#E5E5E5"> customer</font><font color="#CCCCCC"> one in</font><font color="#E5E5E5"> this case is a</font>

291
00:11:33,930 --> 00:11:40,079
customer<font color="#E5E5E5"> of a</font><font color="#CCCCCC"> TMT he sends his route to</font>

292
00:11:37,470 --> 00:11:41,490
his upstream provider and<font color="#E5E5E5"> AT&T will</font>

293
00:11:40,079 --> 00:11:43,260
throw in that route to its downstream

294
00:11:41,490 --> 00:11:45,779
customers in this case customer to you

295
00:11:43,260 --> 00:11:48,779
in all stream<font color="#E5E5E5"> and it also sends it to</font>

296
00:11:45,779 --> 00:11:51,269
his<font color="#E5E5E5"> peers</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> this case</font><font color="#CCCCCC"> new unit all</font>

297
00:11:48,779 --> 00:11:53,070
<font color="#E5E5E5">stream will also send the routes</font><font color="#CCCCCC"> that it</font>

298
00:11:51,269 --> 00:11:55,730
learned from<font color="#CCCCCC"> AT&T which is it the</font>

299
00:11:53,070 --> 00:11:57,720
transit provider<font color="#E5E5E5"> to its customers</font>

300
00:11:55,730 --> 00:11:59,430
<font color="#E5E5E5">Verizon will send the route that it</font>

301
00:11:57,720 --> 00:12:01,920
learned from<font color="#E5E5E5"> its pure AT&T to its</font>

302
00:11:59,430 --> 00:12:04,410
customers which<font color="#CCCCCC"> is all stream customer 3</font>

303
00:12:01,920 --> 00:12:08,490
and customer 4 but<font color="#E5E5E5"> he won't resend that</font>

304
00:12:04,410 --> 00:12:09,899
<font color="#E5E5E5">to another pure in this case level 3 if</font>

305
00:12:08,490 --> 00:12:11,490
we look<font color="#E5E5E5"> at customer 2 we have much of</font>

306
00:12:09,899 --> 00:12:14,570
<font color="#CCCCCC">the</font><font color="#E5E5E5"> same thing</font><font color="#CCCCCC"> except he's got two up</font>

307
00:12:11,490 --> 00:12:16,740
streams he's got AT&T and all<font color="#E5E5E5"> stream</font>

308
00:12:14,570 --> 00:12:19,649
<font color="#E5E5E5">AT&T will send it to their downstream</font>

309
00:12:16,740 --> 00:12:21,089
customers as well as peering all stream

310
00:12:19,649 --> 00:12:23,100
<font color="#CCCCCC">will send it to</font><font color="#E5E5E5"> its three transit</font>

311
00:12:21,089 --> 00:12:25,620
providers AT&T Verizon in level<font color="#E5E5E5"> three</font>

312
00:12:23,100 --> 00:12:27,420
and because level<font color="#E5E5E5"> three is learning it</font>

313
00:12:25,620 --> 00:12:29,160
<font color="#E5E5E5">from a customer all stream he'll send it</font>

314
00:12:27,420 --> 00:12:32,459
to his customers which include customer

315
00:12:29,160 --> 00:12:35,880
<font color="#CCCCCC">4 and BT and BT will send it</font><font color="#E5E5E5"> to its</font>

316
00:12:32,459 --> 00:12:37,469
customer customer<font color="#CCCCCC"> 5 level 3 will also</font>

317
00:12:35,880 --> 00:12:40,380
<font color="#E5E5E5">send it to its peers because it learned</font>

318
00:12:37,470 --> 00:12:41,820
it<font color="#E5E5E5"> from a customer and then unit will</font>

319
00:12:40,380 --> 00:12:44,130
<font color="#E5E5E5">also send this route to its downstream</font>

320
00:12:41,820 --> 00:12:45,870
customers but it's questionable<font color="#E5E5E5"> as to</font>

321
00:12:44,130 --> 00:12:47,970
<font color="#CCCCCC">whether or not it sends it to its peers</font>

322
00:12:45,870 --> 00:12:49,920
<font color="#E5E5E5">and this depends on whether or not the</font>

323
00:12:47,970 --> 00:12:52,260
best route<font color="#E5E5E5"> you unit heard was from</font><font color="#CCCCCC"> a</font>

324
00:12:49,920 --> 00:12:53,760
customer or from a pure because peers

325
00:12:52,260 --> 00:12:57,270
don't generally give transit to other

326
00:12:53,760 --> 00:12:59,520
peers so if<font color="#CCCCCC"> the</font><font color="#E5E5E5"> best path is from all</font>

327
00:12:57,270 --> 00:13:01,170
stream which is<font color="#E5E5E5"> its customer and that</font>

328
00:12:59,520 --> 00:13:03,689
<font color="#E5E5E5">case it will send it</font><font color="#CCCCCC"> to peers like level</font>

329
00:13:01,170 --> 00:13:05,790
3 and<font color="#CCCCCC"> AT&T but</font><font color="#E5E5E5"> if it's best path was</font>

330
00:13:03,690 --> 00:13:07,199
learned from<font color="#CCCCCC"> AT&T which is a peer it</font>

331
00:13:05,790 --> 00:13:11,530
will not send it<font color="#E5E5E5"> to other peers like</font>

332
00:13:07,199 --> 00:13:14,920
level 3 so customer<font color="#CCCCCC"> 3 much</font>

333
00:13:11,530 --> 00:13:16,480
customer<font color="#E5E5E5"> three much of the same</font><font color="#CCCCCC"> sends</font><font color="#E5E5E5"> it</font>

334
00:13:14,920 --> 00:13:18,910
to its upstream<font color="#CCCCCC"> UDN app that goes</font><font color="#E5E5E5"> to all</font>

335
00:13:16,480 --> 00:13:21,280
<font color="#CCCCCC">of</font><font color="#E5E5E5"> its customers</font><font color="#CCCCCC"> and peers</font><font color="#E5E5E5"> all stream</font>

336
00:13:18,910 --> 00:13:23,170
sends its downstream customer<font color="#E5E5E5"> AT&T to</font>

337
00:13:21,280 --> 00:13:25,740
its downstream customers level<font color="#CCCCCC"> three to</font>

338
00:13:23,170 --> 00:13:28,449
its downstream customers same<font color="#E5E5E5"> for BT</font>

339
00:13:25,740 --> 00:13:31,030
customer<font color="#CCCCCC"> four has</font><font color="#E5E5E5"> two up streams unit</font>

340
00:13:28,450 --> 00:13:33,700
and level three level<font color="#E5E5E5"> three sends it to</font>

341
00:13:31,030 --> 00:13:35,890
<font color="#CCCCCC">all of</font><font color="#E5E5E5"> its down streams and peers BT</font>

342
00:13:33,700 --> 00:13:37,000
sends it to its customers<font color="#E5E5E5"> all stream</font>

343
00:13:35,890 --> 00:13:38,980
because it's<font color="#E5E5E5"> learning it from its</font>

344
00:13:37,000 --> 00:13:40,480
transit provider since it sends it to

345
00:13:38,980 --> 00:13:43,180
its customer<font color="#E5E5E5"> level three to its</font>

346
00:13:40,480 --> 00:13:45,780
customers and peers<font color="#E5E5E5"> and 80</font><font color="#CCCCCC"> to its</font>

347
00:13:43,180 --> 00:13:48,699
customers as well<font color="#E5E5E5"> but not to peers and</font>

348
00:13:45,780 --> 00:13:50,290
<font color="#E5E5E5">lastly customer five sends it to BT who</font>

349
00:13:48,700 --> 00:13:53,170
sends it to<font color="#E5E5E5"> level three who sends it to</font>

350
00:13:50,290 --> 00:13:54,579
its customers and its peers and those

351
00:13:53,170 --> 00:13:57,250
<font color="#E5E5E5">networks send it to their downstream</font>

352
00:13:54,580 --> 00:13:59,850
customers as well<font color="#E5E5E5"> at a high</font><font color="#CCCCCC"> level that's</font>

353
00:13:57,250 --> 00:14:03,250
<font color="#E5E5E5">how BGP route propagation works</font>

354
00:13:59,850 --> 00:14:04,930
<font color="#CCCCCC">it's distance-vector routing</font><font color="#E5E5E5"> the</font>

355
00:14:03,250 --> 00:14:07,270
examples on the previous slide basically

356
00:14:04,930 --> 00:14:09,550
<font color="#CCCCCC">show the distance</font><font color="#E5E5E5"> vector nature of BGP</font>

357
00:14:07,270 --> 00:14:12,250
<font color="#E5E5E5">in addition to announcing reachability</font>

358
00:14:09,550 --> 00:14:14,349
information for the<font color="#E5E5E5"> destination it also</font>

359
00:14:12,250 --> 00:14:16,600
has a protocol<font color="#E5E5E5"> next hop and that</font>

360
00:14:14,350 --> 00:14:18,970
protocol next hop by default has changed

361
00:14:16,600 --> 00:14:21,910
at the ebgp boundary<font color="#CCCCCC"> I have a slide on</font>

362
00:14:18,970 --> 00:14:23,710
<font color="#E5E5E5">this in a minute each</font><font color="#CCCCCC"> AAS chooses its</font>

363
00:14:21,910 --> 00:14:26,439
best path and then<font color="#E5E5E5"> forwards traffic</font>

364
00:14:23,710 --> 00:14:28,089
towards that protocol next stop so this

365
00:14:26,440 --> 00:14:30,850
<font color="#E5E5E5">is kind of the distance in the</font><font color="#CCCCCC"> vector of</font>

366
00:14:28,089 --> 00:14:32,710
<font color="#E5E5E5">BGP it's slightly</font><font color="#CCCCCC"> more</font><font color="#E5E5E5"> complicated</font>

367
00:14:30,850 --> 00:14:34,060
because the BGP path selection<font color="#E5E5E5"> is</font>

368
00:14:32,710 --> 00:14:35,350
actually much more detailed and<font color="#E5E5E5"> there's</font>

369
00:14:34,060 --> 00:14:36,760
a lot<font color="#E5E5E5"> more factors in it and we'll talk</font>

370
00:14:35,350 --> 00:14:39,400
about<font color="#E5E5E5"> that at the very end of the first</font>

371
00:14:36,760 --> 00:14:40,960
section<font color="#CCCCCC"> but the point here is</font><font color="#E5E5E5"> that an a</font>

372
00:14:39,400 --> 00:14:43,420
s in the<font color="#E5E5E5"> middle of the topology does not</font>

373
00:14:40,960 --> 00:14:45,700
know the entire topology it's it's only

374
00:14:43,420 --> 00:14:47,260
seeing the<font color="#CCCCCC"> distance to the edge of its</font>

375
00:14:45,700 --> 00:14:49,000
network<font color="#E5E5E5"> and it's only seeing the best</font>

376
00:14:47,260 --> 00:14:53,100
path of all the<font color="#CCCCCC"> downstream networks that</font>

377
00:14:49,000 --> 00:14:55,330
are sending it so in terms of forwarding

378
00:14:53,100 --> 00:14:57,550
<font color="#CCCCCC">we've got all these next hops that have</font>

379
00:14:55,330 --> 00:14:59,230
just<font color="#CCCCCC"> popped</font><font color="#E5E5E5"> into this diagram and</font><font color="#CCCCCC"> we'll</font>

380
00:14:57,550 --> 00:15:15,849
note here that customer<font color="#CCCCCC"> two has a path</font>

381
00:14:59,230 --> 00:15:18,280
for 144.000 next with the next<font color="#CCCCCC"> hop</font><font color="#E5E5E5"> of G</font>

382
00:15:15,850 --> 00:15:23,100
which is<font color="#CCCCCC"> UV net all</font><font color="#E5E5E5"> stream lives it with</font>

383
00:15:18,280 --> 00:15:29,970
next hops FC and J which<font color="#E5E5E5"> are you Gannett</font>

384
00:15:23,100 --> 00:15:32,310
the level<font color="#E5E5E5"> 3 and AT&T</font><font color="#CCCCCC"> Verizon seized it</font>

385
00:15:29,970 --> 00:15:34,440
from B<font color="#CCCCCC"> and D which are</font><font color="#E5E5E5"> the directly from</font>

386
00:15:32,310 --> 00:15:35,939
the customer as<font color="#E5E5E5"> well as level 3</font><font color="#CCCCCC"> level</font><font color="#E5E5E5"> 3</font>

387
00:15:34,440 --> 00:15:39,350
<font color="#CCCCCC">sees it directly from the customer pay</font>

388
00:15:35,940 --> 00:15:41,760
as well<font color="#E5E5E5"> as Eve from you unit and so on</font>

389
00:15:39,350 --> 00:15:43,500
<font color="#E5E5E5">so link state routing protocols are the</font>

390
00:15:41,760 --> 00:15:46,860
other type<font color="#CCCCCC"> of running protocols and</font>

391
00:15:43,500 --> 00:15:48,510
these are like OSPF and is<font color="#E5E5E5"> is and the</font>

392
00:15:46,860 --> 00:15:50,760
way these<font color="#CCCCCC"> work is every node in the</font>

393
00:15:48,510 --> 00:15:52,350
network<font color="#E5E5E5"> announces its reach ability to</font>

394
00:15:50,760 --> 00:15:54,660
every adjacent<font color="#E5E5E5"> note and what that cost</font>

395
00:15:52,350 --> 00:15:56,970
is<font color="#E5E5E5"> this gets flooded through the entire</font>

396
00:15:54,660 --> 00:15:58,650
<font color="#CCCCCC">two apology and then routers from</font><font color="#E5E5E5"> their</font>

397
00:15:56,970 --> 00:15:59,970
unique perspective in<font color="#CCCCCC"> that two apology</font>

398
00:15:58,650 --> 00:16:02,459
build a graph to<font color="#CCCCCC"> figure out what the</font>

399
00:15:59,970 --> 00:16:03,840
cost is<font color="#CCCCCC"> to get to every node so the way</font>

400
00:16:02,460 --> 00:16:06,540
this<font color="#CCCCCC"> works we're going to look</font><font color="#E5E5E5"> at</font>

401
00:16:03,840 --> 00:16:08,250
announcements<font color="#CCCCCC"> from A to</font><font color="#E5E5E5"> F router a</font>

402
00:16:06,540 --> 00:16:10,469
basically comes<font color="#E5E5E5"> online and says I've got</font>

403
00:16:08,250 --> 00:16:13,260
<font color="#E5E5E5">two lengths to adjacent routers C and B</font>

404
00:16:10,470 --> 00:16:15,720
and my cost to get to C is<font color="#E5E5E5"> 8 and my cost</font>

405
00:16:13,260 --> 00:16:17,670
to get to B is 5 and it builds<font color="#E5E5E5"> an update</font>

406
00:16:15,720 --> 00:16:19,710
and it<font color="#E5E5E5"> ships that out all of its</font>

407
00:16:17,670 --> 00:16:22,319
interfaces towards all the other routers

408
00:16:19,710 --> 00:16:24,450
that<font color="#E5E5E5"> are in the IGP and those routers</font>

409
00:16:22,320 --> 00:16:26,580
receive<font color="#E5E5E5"> that update and they flood it</font>

410
00:16:24,450 --> 00:16:31,080
out of all<font color="#CCCCCC"> of their</font><font color="#E5E5E5"> interfaces as</font><font color="#CCCCCC"> well</font>

411
00:16:26,580 --> 00:16:35,190
so router B sends<font color="#CCCCCC"> it to C and D C sends</font>

412
00:16:31,080 --> 00:16:38,460
it to<font color="#E5E5E5"> EF and B</font><font color="#CCCCCC"> D sends it to F</font><font color="#E5E5E5"> D sends</font>

413
00:16:35,190 --> 00:16:40,890
it to F and you start populating the

414
00:16:38,460 --> 00:16:42,900
routing table on F so f now knows<font color="#CCCCCC"> the</font>

415
00:16:40,890 --> 00:16:44,819
cost<font color="#E5E5E5"> to get from A to B is 5 the cost to</font>

416
00:16:42,900 --> 00:16:49,370
<font color="#E5E5E5">get from B to a is 5 the cost to get to</font>

417
00:16:44,820 --> 00:16:52,650
<font color="#CCCCCC">a</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> C</font><font color="#E5E5E5"> is 5 and from C to a is 5 and</font>

418
00:16:49,370 --> 00:16:54,240
each router does this independently<font color="#E5E5E5"> and</font>

419
00:16:52,650 --> 00:16:57,300
as they flood it throughout<font color="#E5E5E5"> the</font><font color="#CCCCCC"> network</font>

420
00:16:54,240 --> 00:16:59,370
<font color="#E5E5E5">you build up the entire routing table so</font>

421
00:16:57,300 --> 00:17:00,839
now any router and the<font color="#E5E5E5"> routing table can</font>

422
00:16:59,370 --> 00:17:02,190
build this tree and figure out<font color="#E5E5E5"> what is</font>

423
00:17:00,840 --> 00:17:07,470
the shortest<font color="#E5E5E5"> path to get to</font><font color="#CCCCCC"> any</font>

424
00:17:02,190 --> 00:17:09,660
destination<font color="#E5E5E5"> in the event that there is</font>

425
00:17:07,470 --> 00:17:11,670
now<font color="#E5E5E5"> to edge or break for example the</font>

426
00:17:09,660 --> 00:17:13,980
link between<font color="#E5E5E5"> a and C goes down then</font>

427
00:17:11,670 --> 00:17:16,439
router<font color="#E5E5E5"> a simply sends out announcement</font>

428
00:17:13,980 --> 00:17:19,110
<font color="#E5E5E5">saying</font><font color="#CCCCCC"> I no longer have a link to C and</font>

429
00:17:16,439 --> 00:17:21,000
he'll flood that all of his interfaces

430
00:17:19,109 --> 00:17:24,240
that<font color="#E5E5E5"> will reach roto B router B will</font>

431
00:17:21,000 --> 00:17:26,280
flood that<font color="#E5E5E5"> to C and D Cu will flood it</font>

432
00:17:24,240 --> 00:17:28,950
to<font color="#CCCCCC"> e</font><font color="#E5E5E5"> and F at this point F prunes that</font>

433
00:17:26,280 --> 00:17:30,510
out of his graph and he then calculates

434
00:17:28,950 --> 00:17:32,690
the new shortest path to get<font color="#CCCCCC"> to</font><font color="#E5E5E5"> the</font>

435
00:17:30,510 --> 00:17:32,690
destination

436
00:17:35,820 --> 00:17:40,689
so<font color="#E5E5E5"> link state versus</font><font color="#CCCCCC"> distance</font><font color="#E5E5E5"> vector</font>

437
00:17:39,249 --> 00:17:42,639
what's the difference well link<font color="#E5E5E5"> state</font>

438
00:17:40,690 --> 00:17:45,129
protocols<font color="#E5E5E5"> only need to flood information</font>

439
00:17:42,639 --> 00:17:46,779
about what linker node has gone down<font color="#E5E5E5"> so</font>

440
00:17:45,129 --> 00:17:48,218
it's it's very<font color="#E5E5E5"> fast</font>

441
00:17:46,779 --> 00:17:50,409
the flooding<font color="#E5E5E5"> can</font><font color="#CCCCCC"> be independent</font><font color="#E5E5E5"> of</font>

442
00:17:48,219 --> 00:17:52,210
calculating the best<font color="#CCCCCC"> path each node</font>

443
00:17:50,409 --> 00:17:53,649
simply prunes off links that are no

444
00:17:52,210 --> 00:17:55,899
longer in service

445
00:17:53,649 --> 00:17:57,518
or adds new<font color="#E5E5E5"> lengths that suddenly are in</font>

446
00:17:55,899 --> 00:17:59,590
service and then calculates a new best

447
00:17:57,519 --> 00:18:01,149
path and they converge very<font color="#E5E5E5"> quickly</font>

448
00:17:59,590 --> 00:18:02,769
because they don't depend<font color="#E5E5E5"> on a change of</font>

449
00:18:01,149 --> 00:18:05,080
topology to be<font color="#E5E5E5"> recognized before they</font>

450
00:18:02,769 --> 00:18:06,879
flood so it floods very quickly and then

451
00:18:05,080 --> 00:18:09,668
each router simultaneously calculates

452
00:18:06,879 --> 00:18:11,439
the new topology<font color="#E5E5E5"> the drawbacks to this</font>

453
00:18:09,669 --> 00:18:13,599
is that each<font color="#E5E5E5"> node has</font><font color="#CCCCCC"> a full view</font><font color="#E5E5E5"> of the</font>

454
00:18:11,440 --> 00:18:16,239
topology<font color="#CCCCCC"> it doesn't scale well for</font><font color="#E5E5E5"> large</font>

455
00:18:13,599 --> 00:18:18,309
networks<font color="#CCCCCC"> it carries a lot of state and</font>

456
00:18:16,239 --> 00:18:19,539
each node at least that each given<font color="#CCCCCC"> level</font>

457
00:18:18,309 --> 00:18:25,450
<font color="#E5E5E5">of hierarchy will see all the</font>

458
00:18:19,539 --> 00:18:26,799
instability<font color="#E5E5E5"> in</font><font color="#CCCCCC"> the network</font><font color="#E5E5E5"> so distance</font>

459
00:18:25,450 --> 00:18:28,719
<font color="#E5E5E5">vector routing protocols on the other</font>

460
00:18:26,799 --> 00:18:31,149
hand<font color="#E5E5E5"> only need to send updates when the</font>

461
00:18:28,719 --> 00:18:33,309
best path changes so a distance<font color="#E5E5E5"> vector</font>

462
00:18:31,149 --> 00:18:35,139
protocol needs<font color="#E5E5E5"> to first determine if the</font>

463
00:18:33,309 --> 00:18:38,499
<font color="#CCCCCC">topology change creates a new best path</font>

464
00:18:35,139 --> 00:18:40,839
<font color="#CCCCCC">due path selection</font><font color="#E5E5E5"> if a new bath</font><font color="#CCCCCC"> if no</font>

465
00:18:38,499 --> 00:18:42,580
new<font color="#E5E5E5"> best path is selected</font><font color="#CCCCCC"> it simply does</font>

466
00:18:40,839 --> 00:18:45,279
nothing if there is a new best path

467
00:18:42,580 --> 00:18:48,339
selected it has to build<font color="#E5E5E5"> an update and</font>

468
00:18:45,279 --> 00:18:50,349
send that update out each node does not

469
00:18:48,339 --> 00:18:51,820
<font color="#E5E5E5">have a full picture of the network which</font>

470
00:18:50,349 --> 00:18:52,450
means<font color="#CCCCCC"> it scales much better for large</font>

471
00:18:51,820 --> 00:18:55,119
networks

472
00:18:52,450 --> 00:18:56,979
it carries lot less state and only<font color="#E5E5E5"> nodes</font>

473
00:18:55,119 --> 00:18:59,559
where the best<font color="#E5E5E5"> path</font><font color="#CCCCCC"> change</font><font color="#E5E5E5"> need to be</font>

474
00:18:56,979 --> 00:19:01,479
sent an update or withdrawal<font color="#CCCCCC"> on the</font>

475
00:18:59,559 --> 00:19:02,979
other hand it takes<font color="#CCCCCC"> longer</font><font color="#E5E5E5"> for updates</font>

476
00:19:01,479 --> 00:19:04,690
<font color="#E5E5E5">to cascade through the network because</font>

477
00:19:02,979 --> 00:19:06,279
each node must<font color="#CCCCCC"> process the update</font><font color="#E5E5E5"> and</font>

478
00:19:04,690 --> 00:19:08,379
withdrawals first calculate<font color="#E5E5E5"> new best</font>

479
00:19:06,279 --> 00:19:12,129
<font color="#E5E5E5">path and then decide</font><font color="#CCCCCC"> if it has to send</font>

480
00:19:08,379 --> 00:19:15,070
<font color="#E5E5E5">its own update so why do we use distance</font>

481
00:19:12,129 --> 00:19:16,629
vector routing for<font color="#E5E5E5"> the</font><font color="#CCCCCC"> internet well</font>

482
00:19:15,070 --> 00:19:18,700
because of the<font color="#CCCCCC"> large-scale</font><font color="#E5E5E5"> nature of the</font>

483
00:19:16,629 --> 00:19:20,978
<font color="#E5E5E5">internet routing tables lend itself much</font>

484
00:19:18,700 --> 00:19:23,289
better to distance vector it reduces the

485
00:19:20,979 --> 00:19:24,309
<font color="#CCCCCC">amount of state required networks on the</font>

486
00:19:23,289 --> 00:19:26,408
<font color="#CCCCCC">internet are also run by different</font>

487
00:19:24,309 --> 00:19:28,210
<font color="#CCCCCC">organizations</font><font color="#E5E5E5"> so no one person is</font>

488
00:19:26,409 --> 00:19:30,669
<font color="#CCCCCC">responsible for</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> stability of the</font>

489
00:19:28,210 --> 00:19:32,469
internet and with<font color="#E5E5E5"> distance vector</font>

490
00:19:30,669 --> 00:19:34,649
routing you can sort<font color="#E5E5E5"> of isolate that</font>

491
00:19:32,469 --> 00:19:39,099
<font color="#E5E5E5">instability to different areas of</font>

492
00:19:34,649 --> 00:19:42,120
administrative control so it reduces<font color="#CCCCCC"> the</font>

493
00:19:39,099 --> 00:19:44,309
<font color="#CCCCCC">churn and provides a level</font><font color="#E5E5E5"> of separation</font>

494
00:19:42,120 --> 00:19:46,379
for internal - apologies they tend to<font color="#E5E5E5"> be</font>

495
00:19:44,309 --> 00:19:48,090
<font color="#E5E5E5">much smaller and</font><font color="#CCCCCC"> the smaller</font><font color="#E5E5E5"> amount of</font>

496
00:19:46,380 --> 00:19:49,679
state required for an internal<font color="#CCCCCC"> - apology</font>

497
00:19:48,090 --> 00:19:53,010
can easily fit within the limits of a

498
00:19:49,679 --> 00:19:54,480
link state protocol<font color="#CCCCCC"> it's generally the</font>

499
00:19:53,010 --> 00:19:56,480
internal<font color="#E5E5E5"> - apologies generally run by a</font>

500
00:19:54,480 --> 00:19:58,799
single single<font color="#E5E5E5"> organization who</font><font color="#CCCCCC"> has</font>

501
00:19:56,480 --> 00:20:00,450
control over<font color="#E5E5E5"> the stability of</font><font color="#CCCCCC"> that</font>

502
00:19:58,799 --> 00:20:03,770
<font color="#CCCCCC">Network</font><font color="#E5E5E5"> and consent standards across</font>

503
00:20:00,450 --> 00:20:06,029
<font color="#E5E5E5">that network and it converges very fast</font>

504
00:20:03,770 --> 00:20:08,299
so if you picked up<font color="#E5E5E5"> a textbook in the</font>

505
00:20:06,029 --> 00:20:10,409
1990s<font color="#E5E5E5"> and said how do I build a network</font>

506
00:20:08,299 --> 00:20:12,900
typically<font color="#E5E5E5"> they would give you this very</font>

507
00:20:10,409 --> 00:20:15,059
bad advice<font color="#CCCCCC"> and</font><font color="#E5E5E5"> that very bad advice</font><font color="#CCCCCC"> was</font>

508
00:20:12,900 --> 00:20:17,909
run<font color="#CCCCCC"> bgp as your</font><font color="#E5E5E5"> exterior gateway</font>

509
00:20:15,059 --> 00:20:20,789
protocol on the edge<font color="#E5E5E5"> of your network run</font>

510
00:20:17,909 --> 00:20:22,140
an<font color="#CCCCCC"> IGP internally usually OSPF for</font><font color="#E5E5E5"> isis</font>

511
00:20:20,789 --> 00:20:24,990
between your routers<font color="#E5E5E5"> within your network</font>

512
00:20:22,140 --> 00:20:27,929
<font color="#E5E5E5">and then on the edge redistribute all of</font>

513
00:20:24,990 --> 00:20:29,490
your BGP routes into your<font color="#CCCCCC"> IGP carry that</font>

514
00:20:27,929 --> 00:20:30,929
across the inside<font color="#CCCCCC"> of</font><font color="#E5E5E5"> your network and</font>

515
00:20:29,490 --> 00:20:33,539
then on the far end where<font color="#E5E5E5"> you're running</font>

516
00:20:30,929 --> 00:20:35,700
BGP<font color="#E5E5E5"> redistribute it back from your</font><font color="#CCCCCC"> IGP</font>

517
00:20:33,539 --> 00:20:38,100
back into<font color="#CCCCCC"> BGP and</font><font color="#E5E5E5"> announce that out to</font>

518
00:20:35,700 --> 00:20:40,799
the<font color="#E5E5E5"> rest of the</font><font color="#CCCCCC"> Internet this doesn't</font>

519
00:20:38,100 --> 00:20:42,270
scale<font color="#E5E5E5"> your</font><font color="#CCCCCC"> IGP becomes as large as the</font>

520
00:20:40,799 --> 00:20:44,700
<font color="#CCCCCC">internet table think hundreds of</font>

521
00:20:42,270 --> 00:20:46,470
thousands of routes<font color="#E5E5E5"> and any instability</font>

522
00:20:44,700 --> 00:20:48,179
<font color="#CCCCCC">in the internet</font><font color="#E5E5E5"> gets translated into</font>

523
00:20:46,470 --> 00:20:50,820
instability in your local<font color="#E5E5E5"> network</font><font color="#CCCCCC"> and</font>

524
00:20:48,179 --> 00:20:52,350
when you're redistributing<font color="#E5E5E5"> from and back</font>

525
00:20:50,820 --> 00:20:55,730
to protocols you lose a lot<font color="#CCCCCC"> of</font><font color="#E5E5E5"> the</font>

526
00:20:52,350 --> 00:20:58,080
<font color="#E5E5E5">metrics so this is not a good design</font>

527
00:20:55,730 --> 00:21:00,690
<font color="#E5E5E5">typically what</font><font color="#CCCCCC"> people do these days is</font>

528
00:20:58,080 --> 00:21:02,309
they run ebgp<font color="#E5E5E5"> between the edge of their</font>

529
00:21:00,690 --> 00:21:04,740
network and other<font color="#E5E5E5"> is is to learn</font>

530
00:21:02,309 --> 00:21:06,779
<font color="#E5E5E5">internet routes and then they run ibgp</font>

531
00:21:04,740 --> 00:21:08,580
internally to ship<font color="#E5E5E5"> those internet or</font>

532
00:21:06,779 --> 00:21:10,770
<font color="#E5E5E5">route routes around within their insight</font>

533
00:21:08,580 --> 00:21:13,408
inside their network<font color="#E5E5E5"> and then they also</font>

534
00:21:10,770 --> 00:21:15,000
run an IG PA which is used<font color="#E5E5E5"> to learn the</font>

535
00:21:13,409 --> 00:21:17,250
internal topology<font color="#CCCCCC"> of their own network</font>

536
00:21:15,000 --> 00:21:19,799
<font color="#CCCCCC">and there's a couple of different ideas</font>

537
00:21:17,250 --> 00:21:21,659
<font color="#E5E5E5">of routes that</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> can put in the IGP my</font>

538
00:21:19,799 --> 00:21:24,510
recommendation is keep it as small<font color="#CCCCCC"> as</font>

539
00:21:21,659 --> 00:21:26,690
<font color="#CCCCCC">you possibly can so that</font><font color="#E5E5E5"> way it is the</font>

540
00:21:24,510 --> 00:21:29,279
most stable and the quickest<font color="#E5E5E5"> to converge</font>

541
00:21:26,690 --> 00:21:31,049
<font color="#CCCCCC">the</font><font color="#E5E5E5"> smallest possible implementation is</font>

542
00:21:29,279 --> 00:21:33,779
<font color="#CCCCCC">to put your loop backs</font><font color="#E5E5E5"> only into your</font>

543
00:21:31,049 --> 00:21:35,309
<font color="#CCCCCC">IGP if</font><font color="#E5E5E5"> you're running is is you don't</font>

544
00:21:33,779 --> 00:21:38,039
<font color="#E5E5E5">even need your back to back point</font><font color="#CCCCCC"> two</font>

545
00:21:35,309 --> 00:21:40,740
points<font color="#E5E5E5"> in Isis because it runs over CL</font>

546
00:21:38,039 --> 00:21:42,600
NS which doesn't require IP<font color="#E5E5E5"> if you're</font>

547
00:21:40,740 --> 00:21:44,100
running<font color="#CCCCCC"> OSPF then you have to put</font><font color="#E5E5E5"> your</font>

548
00:21:42,600 --> 00:21:46,260
loop backs and your backbone point two

549
00:21:44,100 --> 00:21:49,230
points into<font color="#E5E5E5"> the IGP that's the bare</font>

550
00:21:46,260 --> 00:21:51,179
minimum<font color="#CCCCCC"> some people will go a step</font>

551
00:21:49,230 --> 00:21:53,190
further<font color="#CCCCCC"> and say</font><font color="#E5E5E5"> anything that is a BGP</font>

552
00:21:51,179 --> 00:21:54,820
protocol<font color="#E5E5E5"> next top put that into the IGP</font>

553
00:21:53,190 --> 00:21:56,409
as well

554
00:21:54,820 --> 00:21:58,570
some people will add on to<font color="#CCCCCC"> that</font><font color="#E5E5E5"> any</font>

555
00:21:56,409 --> 00:22:00,279
<font color="#CCCCCC">destination that requires IGP based</font>

556
00:21:58,570 --> 00:22:03,460
<font color="#CCCCCC">load-balancing I've got some</font><font color="#E5E5E5"> slides on</font>

557
00:22:00,279 --> 00:22:05,259
<font color="#E5E5E5">that in the second half</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> some people</font>

558
00:22:03,460 --> 00:22:07,960
will<font color="#CCCCCC"> also add any destination</font><font color="#E5E5E5"> that needs</font>

559
00:22:05,259 --> 00:22:09,549
fast convergence<font color="#E5E5E5"> so maybe a little take</font>

560
00:22:07,960 --> 00:22:11,139
stuff out<font color="#CCCCCC"> of</font><font color="#E5E5E5"> BGP</font><font color="#CCCCCC"> and put it into there</font>

561
00:22:09,549 --> 00:22:14,200
<font color="#CCCCCC">IGP in order to allow it to converge</font>

562
00:22:11,139 --> 00:22:16,090
faster and then the the least preferred

563
00:22:14,200 --> 00:22:17,919
<font color="#CCCCCC">is anything that's considered</font><font color="#E5E5E5"> an</font>

564
00:22:16,090 --> 00:22:21,129
internal route any prefix that<font color="#E5E5E5"> you own</font>

565
00:22:17,919 --> 00:22:26,740
<font color="#E5E5E5">put it into the IGP definitely not</font>

566
00:22:21,130 --> 00:22:28,330
recommended so good<font color="#E5E5E5"> bgp</font><font color="#CCCCCC"> IGP design</font>

567
00:22:26,740 --> 00:22:30,820
<font color="#E5E5E5">really gives you the best of both</font><font color="#CCCCCC"> worlds</font>

568
00:22:28,330 --> 00:22:32,500
<font color="#CCCCCC">you use</font><font color="#E5E5E5"> BGP for the internet routing it</font>

569
00:22:30,820 --> 00:22:34,629
converges slower but<font color="#E5E5E5"> it has some</font><font color="#CCCCCC"> level</font>

570
00:22:32,500 --> 00:22:36,399
<font color="#E5E5E5">of isolation</font><font color="#CCCCCC"> and it allows the</font><font color="#E5E5E5"> internet</font>

571
00:22:34,629 --> 00:22:38,559
table to scale<font color="#CCCCCC"> to hundreds</font><font color="#E5E5E5"> of thousands</font>

572
00:22:36,399 --> 00:22:40,570
of routes and millions<font color="#E5E5E5"> of paths and</font><font color="#CCCCCC"> you</font>

573
00:22:38,559 --> 00:22:42,940
use your<font color="#CCCCCC"> IGP for your internal</font><font color="#E5E5E5"> topology</font>

574
00:22:40,570 --> 00:22:44,980
which converges<font color="#E5E5E5"> faster the</font><font color="#CCCCCC"> topologies</font>

575
00:22:42,940 --> 00:22:46,779
kept small so it converges quickly and

576
00:22:44,980 --> 00:22:48,429
scaling is not an issue<font color="#E5E5E5"> and the</font>

577
00:22:46,779 --> 00:22:50,440
stability<font color="#CCCCCC"> of the topology</font><font color="#E5E5E5"> is not an</font>

578
00:22:48,429 --> 00:22:54,940
issue because it's<font color="#E5E5E5"> 100% your network</font>

579
00:22:50,440 --> 00:22:56,980
which you control the<font color="#CCCCCC"> stability of so</font>

580
00:22:54,940 --> 00:22:58,299
ebgp and<font color="#CCCCCC"> i bgp</font><font color="#E5E5E5"> I've already talked about</font>

581
00:22:56,980 --> 00:23:00,460
this a<font color="#E5E5E5"> little bit</font>

582
00:22:58,299 --> 00:23:01,840
the basic difference<font color="#CCCCCC"> here is ebgp is</font>

583
00:23:00,460 --> 00:23:03,190
when your<font color="#CCCCCC"> BGP neighbors belong to</font>

584
00:23:01,840 --> 00:23:05,949
<font color="#CCCCCC">different networks</font><font color="#E5E5E5"> different</font><font color="#CCCCCC"> autonomous</font>

585
00:23:03,190 --> 00:23:08,830
systems<font color="#E5E5E5"> in this case every best path is</font>

586
00:23:05,950 --> 00:23:10,240
advertised across the ebgp boundary ebgp

587
00:23:08,830 --> 00:23:12,759
<font color="#E5E5E5">neighbors you're</font><font color="#CCCCCC"> usually directly</font>

588
00:23:10,240 --> 00:23:14,139
connected routers and<font color="#E5E5E5"> the</font><font color="#CCCCCC"> protocol</font><font color="#E5E5E5"> next</font>

589
00:23:12,759 --> 00:23:17,649
<font color="#CCCCCC">hop</font><font color="#E5E5E5"> is typically changed to the</font>

590
00:23:14,139 --> 00:23:19,269
advertising ebgp<font color="#CCCCCC"> neighbors address i bgp</font>

591
00:23:17,649 --> 00:23:20,590
<font color="#CCCCCC">is when your BGP neighbors belong to the</font>

592
00:23:19,269 --> 00:23:23,230
same autonomous system<font color="#CCCCCC"> they're</font><font color="#E5E5E5"> part of</font>

593
00:23:20,590 --> 00:23:25,389
<font color="#CCCCCC">the same network if a path is learned</font>

594
00:23:23,230 --> 00:23:28,240
via<font color="#CCCCCC"> I</font><font color="#E5E5E5"> BGP you don't riad ver ties it to</font>

595
00:23:25,389 --> 00:23:30,399
another<font color="#CCCCCC"> I</font><font color="#E5E5E5"> bgp neighbor which requires a</font>

596
00:23:28,240 --> 00:23:31,870
full mesh of<font color="#E5E5E5"> I bgp peering I'll talk</font>

597
00:23:30,399 --> 00:23:34,989
more about scaling<font color="#E5E5E5"> that in the second</font>

598
00:23:31,870 --> 00:23:36,758
<font color="#E5E5E5">half</font><font color="#CCCCCC"> I bgp neighbors are generally not</font>

599
00:23:34,990 --> 00:23:38,620
directly connected but<font color="#CCCCCC"> they do share a</font>

600
00:23:36,759 --> 00:23:41,919
common<font color="#CCCCCC"> I GP which allows them</font><font color="#E5E5E5"> to reach</font>

601
00:23:38,620 --> 00:23:44,049
each<font color="#E5E5E5"> other and they advertise every best</font>

602
00:23:41,919 --> 00:23:45,850
<font color="#E5E5E5">a BGP path that they learn to I bgp</font>

603
00:23:44,049 --> 00:23:49,149
neighbors<font color="#E5E5E5"> but like I</font><font color="#CCCCCC"> said they don't</font>

604
00:23:45,850 --> 00:23:51,009
<font color="#E5E5E5">react vert eyes i bgp paths and protocol</font>

605
00:23:49,149 --> 00:23:53,018
<font color="#CCCCCC">next hop typically is unchanged in this</font>

606
00:23:51,009 --> 00:23:54,340
case because you're using your<font color="#CCCCCC"> I GP to</font>

607
00:23:53,019 --> 00:23:56,789
figure out how to get<font color="#E5E5E5"> to</font><font color="#CCCCCC"> that protocol</font>

608
00:23:54,340 --> 00:23:56,789
next<font color="#CCCCCC"> time</font>

609
00:23:57,480 --> 00:24:02,399
so<font color="#E5E5E5"> bgp protocol next top there's a</font>

610
00:24:00,779 --> 00:24:04,260
<font color="#CCCCCC">number</font><font color="#E5E5E5"> of ways that you can set protocol</font>

611
00:24:02,399 --> 00:24:07,320
next<font color="#CCCCCC"> up within</font><font color="#E5E5E5"> your network once you</font>

612
00:24:04,260 --> 00:24:09,269
learn a route from<font color="#E5E5E5"> ebgp you can just</font>

613
00:24:07,320 --> 00:24:10,470
leave the protocol<font color="#E5E5E5"> next</font><font color="#CCCCCC"> stop as it</font><font color="#E5E5E5"> is in</font>

614
00:24:09,269 --> 00:24:12,720
which case it could<font color="#CCCCCC"> be a directly</font>

615
00:24:10,470 --> 00:24:14,490
connected interface<font color="#E5E5E5"> which is basically</font>

616
00:24:12,720 --> 00:24:16,889
the far end of the<font color="#CCCCCC"> point-to-point</font><font color="#E5E5E5"> to the</font>

617
00:24:14,490 --> 00:24:18,360
router your neighboring with<font color="#CCCCCC"> if you're</font>

618
00:24:16,889 --> 00:24:19,678
not<font color="#E5E5E5"> neighboring with the far end router</font>

619
00:24:18,360 --> 00:24:21,840
interface but your<font color="#E5E5E5"> neighboring with a</font>

620
00:24:19,679 --> 00:24:23,130
loopback<font color="#E5E5E5"> in order to make that bgp</font>

621
00:24:21,840 --> 00:24:26,189
session come up you'll have<font color="#E5E5E5"> a static</font>

622
00:24:23,130 --> 00:24:29,010
route<font color="#CCCCCC"> and that that static route could</font>

623
00:24:26,190 --> 00:24:30,809
then be reach<font color="#CCCCCC"> ability to the loopback of</font>

624
00:24:29,010 --> 00:24:33,990
the neighbor which could be the protocol

625
00:24:30,809 --> 00:24:35,760
next<font color="#CCCCCC"> hop or you could rewrite</font><font color="#E5E5E5"> next hop</font>

626
00:24:33,990 --> 00:24:37,230
towards your<font color="#CCCCCC"> I BGP to be</font><font color="#E5E5E5"> yourself</font><font color="#CCCCCC"> in</font>

627
00:24:35,760 --> 00:24:44,610
which case that<font color="#CCCCCC"> routes going to be</font>

628
00:24:37,230 --> 00:24:46,860
<font color="#E5E5E5">reachable through your</font><font color="#CCCCCC"> IGP so going</font>

629
00:24:44,610 --> 00:24:48,479
<font color="#CCCCCC">through these a route reachable in your</font>

630
00:24:46,860 --> 00:24:53,158
<font color="#CCCCCC">IGP could be a number of</font><font color="#E5E5E5"> different cases</font>

631
00:24:48,480 --> 00:24:54,809
<font color="#CCCCCC">it could</font><font color="#E5E5E5"> be that your ebgp peering is</font>

632
00:24:53,159 --> 00:24:56,429
not the local<font color="#E5E5E5"> router so you're looking</font>

633
00:24:54,809 --> 00:24:58,830
at a route somewhere<font color="#E5E5E5"> in the middle of</font>

634
00:24:56,429 --> 00:25:01,740
your network topology in which<font color="#E5E5E5"> case</font>

635
00:24:58,830 --> 00:25:04,710
you're going to<font color="#CCCCCC"> have an IDP route to the</font>

636
00:25:01,740 --> 00:25:06,570
edge routers loopback<font color="#E5E5E5"> it could be that</font>

637
00:25:04,710 --> 00:25:08,190
the edge routers are appearing with the

638
00:25:06,570 --> 00:25:09,510
directly<font color="#E5E5E5"> connected interface and putting</font>

639
00:25:08,190 --> 00:25:11,460
<font color="#E5E5E5">that directly connected interface</font>

640
00:25:09,510 --> 00:25:13,799
passively into<font color="#CCCCCC"> their IGP in which case</font>

641
00:25:11,460 --> 00:25:15,269
you'll have<font color="#E5E5E5"> an</font><font color="#CCCCCC"> igt</font><font color="#E5E5E5"> route to it or it</font>

642
00:25:13,799 --> 00:25:16,769
could be<font color="#CCCCCC"> that you have a static route to</font>

643
00:25:15,269 --> 00:25:19,380
appear with the loop back and that

644
00:25:16,769 --> 00:25:22,559
static route is being injected<font color="#E5E5E5"> into your</font>

645
00:25:19,380 --> 00:25:24,470
<font color="#CCCCCC">IGP as well you</font><font color="#E5E5E5"> also have these same</font>

646
00:25:22,559 --> 00:25:26,730
flavors with it being another<font color="#E5E5E5"> BGP route</font>

647
00:25:24,470 --> 00:25:28,649
<font color="#E5E5E5">rather than injecting the directly</font>

648
00:25:26,730 --> 00:25:31,409
connected route into your<font color="#CCCCCC"> IGP or</font><font color="#E5E5E5"> those</font>

649
00:25:28,649 --> 00:25:33,209
or the static route into your<font color="#CCCCCC"> IGP</font><font color="#E5E5E5"> you</font>

650
00:25:31,409 --> 00:25:35,070
can redistribute those into<font color="#CCCCCC"> bgp</font><font color="#E5E5E5"> and then</font>

651
00:25:33,210 --> 00:25:36,360
you'll<font color="#E5E5E5"> just do a two-level recursion so</font>

652
00:25:35,070 --> 00:25:38,549
you<font color="#E5E5E5"> help a BGP route which has a</font>

653
00:25:36,360 --> 00:25:40,469
protocol next stop which<font color="#CCCCCC"> is reachable</font>

654
00:25:38,549 --> 00:25:42,450
<font color="#CCCCCC">through a</font><font color="#E5E5E5"> BGP route which has a protocol</font>

655
00:25:40,470 --> 00:25:45,570
next top which<font color="#CCCCCC"> is a</font><font color="#E5E5E5"> loopback of an edge</font>

656
00:25:42,450 --> 00:25:45,779
router so let me diagram what that looks

657
00:25:45,570 --> 00:25:49,559
like

658
00:25:45,779 --> 00:25:51,570
<font color="#E5E5E5">so a route comes in for a lookup and if</font>

659
00:25:49,559 --> 00:25:53,610
that<font color="#E5E5E5"> route is a directly connected route</font>

660
00:25:51,570 --> 00:25:56,370
you simply ship the traffic out that

661
00:25:53,610 --> 00:25:58,469
interface<font color="#E5E5E5"> route comes in for a lookup</font>

662
00:25:56,370 --> 00:26:00,629
<font color="#E5E5E5">and that route is a static</font><font color="#CCCCCC"> route that</font>

663
00:25:58,470 --> 00:26:02,309
static route either points to a directly

664
00:26:00,630 --> 00:26:05,010
connected interface in which case you

665
00:26:02,309 --> 00:26:08,100
ship it<font color="#CCCCCC"> out that interface or it</font><font color="#E5E5E5"> has</font>

666
00:26:05,010 --> 00:26:09,960
some far end next<font color="#E5E5E5"> hop address like a</font>

667
00:26:08,100 --> 00:26:11,309
Ethernet on<font color="#CCCCCC"> a broadcast medium and then</font>

668
00:26:09,960 --> 00:26:13,049
there's some layer<font color="#CCCCCC"> 2 mechanism like</font>

669
00:26:11,309 --> 00:26:15,539
<font color="#E5E5E5">are to figure out how to reach</font><font color="#CCCCCC"> that</font>

670
00:26:13,049 --> 00:26:19,559
<font color="#E5E5E5">layer to destination and</font><font color="#CCCCCC"> you ship</font><font color="#E5E5E5"> it out</font>

671
00:26:15,539 --> 00:26:20,759
that interface or a prefix comes in and

672
00:26:19,559 --> 00:26:22,710
that route is reachable<font color="#CCCCCC"> through your I</font>

673
00:26:20,759 --> 00:26:24,779
<font color="#CCCCCC">GP you look at your I GP graph you</font>

674
00:26:22,710 --> 00:26:26,490
figure<font color="#E5E5E5"> out what is the shortest path to</font>

675
00:26:24,779 --> 00:26:28,409
<font color="#E5E5E5">get there you know what your outgoing</font>

676
00:26:26,490 --> 00:26:31,350
interface is you ship<font color="#E5E5E5"> it out that</font>

677
00:26:28,409 --> 00:26:34,169
interface in the event that<font color="#E5E5E5"> it comes in</font>

678
00:26:31,350 --> 00:26:36,539
<font color="#E5E5E5">and it's a BGP prefix</font><font color="#CCCCCC"> then you have to</font>

679
00:26:34,169 --> 00:26:38,070
look at the protocol next<font color="#CCCCCC"> top</font><font color="#E5E5E5"> one case</font>

680
00:26:36,539 --> 00:26:40,230
<font color="#E5E5E5">is that the protocol next stop is the</font>

681
00:26:38,070 --> 00:26:42,350
ebgp<font color="#E5E5E5"> neighbor interface of the router</font>

682
00:26:40,230 --> 00:26:45,029
that's<font color="#E5E5E5"> ebgp peering with that network</font>

683
00:26:42,350 --> 00:26:47,789
<font color="#CCCCCC">but if you're not on that local</font><font color="#E5E5E5"> router</font>

684
00:26:45,029 --> 00:26:50,429
<font color="#E5E5E5">you</font><font color="#CCCCCC"> have to do a route regression so the</font>

685
00:26:47,789 --> 00:26:54,960
<font color="#E5E5E5">next hop could possibly be that edge</font>

686
00:26:50,429 --> 00:26:56,970
routers move back<font color="#E5E5E5"> or it could be the</font>

687
00:26:54,960 --> 00:26:59,610
directly<font color="#E5E5E5"> connected interface which is</font>

688
00:26:56,970 --> 00:27:02,119
<font color="#CCCCCC">being redistributed into</font><font color="#E5E5E5"> bgp which has a</font>

689
00:26:59,610 --> 00:27:05,158
next top of that<font color="#E5E5E5"> edge router look back</font>

690
00:27:02,119 --> 00:27:06,480
both<font color="#CCCCCC"> of those are in your IGP so you</font>

691
00:27:05,159 --> 00:27:08,249
regress down to the IGP

692
00:27:06,480 --> 00:27:09,600
<font color="#E5E5E5">you know the shortest path in your</font><font color="#CCCCCC"> IGP</font>

693
00:27:08,249 --> 00:27:13,470
and<font color="#E5E5E5"> the outgoing</font><font color="#CCCCCC"> interface to send it</font>

694
00:27:09,600 --> 00:27:15,990
out<font color="#E5E5E5"> of the other possibility is if it's</font>

695
00:27:13,470 --> 00:27:18,119
on<font color="#E5E5E5"> the egress router itself if the next</font>

696
00:27:15,990 --> 00:27:20,220
<font color="#E5E5E5">hop is</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> ebgp</font><font color="#CCCCCC"> neighbor interface well</font>

697
00:27:18,119 --> 00:27:22,439
that's<font color="#CCCCCC"> a directly</font><font color="#E5E5E5"> connected route you</font>

698
00:27:20,220 --> 00:27:24,360
send it out that interface<font color="#CCCCCC"> if the next</font>

699
00:27:22,440 --> 00:27:26,100
hop<font color="#CCCCCC"> is a static</font><font color="#E5E5E5"> route that static route</font>

700
00:27:24,360 --> 00:27:28,258
points to an interface<font color="#E5E5E5"> or to a far end</font>

701
00:27:26,100 --> 00:27:31,740
destination<font color="#CCCCCC"> that's reachable</font><font color="#E5E5E5"> through say</font>

702
00:27:28,259 --> 00:27:33,840
<font color="#E5E5E5">ARPA and this is just walking</font><font color="#CCCCCC"> you</font>

703
00:27:31,740 --> 00:27:36,690
through again<font color="#E5E5E5"> in words</font><font color="#CCCCCC"> the diagram that</font>

704
00:27:33,840 --> 00:27:38,340
<font color="#E5E5E5">we did so we're gonna look at the three</font>

705
00:27:36,690 --> 00:27:40,200
cases<font color="#CCCCCC"> of the different protocol next</font>

706
00:27:38,340 --> 00:27:41,610
<font color="#CCCCCC">tops we're</font><font color="#E5E5E5"> going to actually look at the</font>

707
00:27:40,200 --> 00:27:44,279
state of<font color="#E5E5E5"> the different routings and how</font>

708
00:27:41,610 --> 00:27:46,110
this<font color="#E5E5E5"> works and the first example</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> 100</font>

709
00:27:44,279 --> 00:27:49,889
is<font color="#E5E5E5"> going to advertise to</font><font color="#CCCCCC"> a s 200 via</font>

710
00:27:46,110 --> 00:27:52,408
ebgp<font color="#CCCCCC"> a s 100 is</font><font color="#E5E5E5"> going to use the a s 100</font>

711
00:27:49,889 --> 00:27:54,119
side of the<font color="#E5E5E5"> point-to-point link and when</font>

712
00:27:52,409 --> 00:27:56,220
the route is learned by a s 200 they're

713
00:27:54,119 --> 00:28:00,209
going to continue<font color="#E5E5E5"> to use the natural BGP</font>

714
00:27:56,220 --> 00:28:01,619
protocol next<font color="#CCCCCC"> hop and the a s 200 rather</font>

715
00:28:00,210 --> 00:28:03,929
learning<font color="#E5E5E5"> the prefix is going to re-add</font>

716
00:28:01,619 --> 00:28:05,789
<font color="#E5E5E5">ver ties it to its ibgp neighbors and</font>

717
00:28:03,929 --> 00:28:07,860
it's going to set next<font color="#E5E5E5"> top self so the</font>

718
00:28:05,789 --> 00:28:11,730
<font color="#E5E5E5">next hop</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> going to be reset to his own</font>

719
00:28:07,860 --> 00:28:13,350
<font color="#E5E5E5">loopback so let's walk through this so</font>

720
00:28:11,730 --> 00:28:15,360
this<font color="#E5E5E5"> is the state</font><font color="#CCCCCC"> that you see here</font><font color="#E5E5E5"> on</font>

721
00:28:13,350 --> 00:28:17,908
some router in the middle of a s 200

722
00:28:15,360 --> 00:28:23,008
you'll note that it's got a static route

723
00:28:17,909 --> 00:28:24,680
for 100<font color="#CCCCCC"> - 0 - 0</font><font color="#E5E5E5"> 16 to discard that's the</font>

724
00:28:23,009 --> 00:28:27,380
<font color="#CCCCCC">pull-up route representing all of this</font>

725
00:28:24,680 --> 00:28:31,910
for a<font color="#E5E5E5"> s200 that static route is going</font><font color="#CCCCCC"> to</font>

726
00:28:27,380 --> 00:28:33,650
be redistributed into<font color="#CCCCCC"> bgp on the ebgp</font>

727
00:28:31,910 --> 00:28:36,380
speaking router we have<font color="#E5E5E5"> the same state</font>

728
00:28:33,650 --> 00:28:38,810
<font color="#CCCCCC">and when the static route is</font>

729
00:28:36,380 --> 00:28:40,340
<font color="#CCCCCC">redistributed into</font><font color="#E5E5E5"> bgp he's going to</font>

730
00:28:38,810 --> 00:28:42,889
send it to<font color="#E5E5E5"> all</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> his ibgp neighbors</font>

731
00:28:40,340 --> 00:28:44,899
including<font color="#CCCCCC"> the ebgp speaking router so</font>

732
00:28:42,890 --> 00:28:47,750
this is the route for<font color="#E5E5E5"> the slash 16 and</font>

733
00:28:44,900 --> 00:28:51,080
you'll see the<font color="#E5E5E5"> next hop is 102 to 2</font>

734
00:28:47,750 --> 00:28:54,890
which is this routers<font color="#CCCCCC"> leak back here so</font>

735
00:28:51,080 --> 00:28:57,889
this<font color="#E5E5E5"> is kind of the set up in</font><font color="#CCCCCC"> IAS 200 in</font>

736
00:28:54,890 --> 00:28:59,600
<font color="#CCCCCC">s</font><font color="#E5E5E5"> 100 this is</font><font color="#CCCCCC"> the setup here we've just</font>

737
00:28:57,890 --> 00:29:02,300
<font color="#CCCCCC">got some routing information how to get</font>

738
00:28:59,600 --> 00:29:06,500
to these<font color="#CCCCCC"> routers as well as his up links</font>

739
00:29:02,300 --> 00:29:09,889
to the<font color="#E5E5E5"> core of a s 100 when the route is</font>

740
00:29:06,500 --> 00:29:12,140
advertised by a<font color="#E5E5E5"> ebgp</font><font color="#CCCCCC"> it's learned the</font>

741
00:29:09,890 --> 00:29:15,770
ingress of a s 100<font color="#E5E5E5"> so this is the slash</font>

742
00:29:12,140 --> 00:29:20,450
16<font color="#CCCCCC"> and you'll see the next</font><font color="#E5E5E5"> hop is 101.3</font>

743
00:29:15,770 --> 00:29:22,330
<font color="#E5E5E5">2 which is the BGP</font><font color="#CCCCCC"> neighbour address and</font>

744
00:29:20,450 --> 00:29:26,570
he's<font color="#E5E5E5"> going to set next hop self and</font>

745
00:29:22,330 --> 00:29:28,280
advertise those routes to a s 100 so on

746
00:29:26,570 --> 00:29:30,740
the far end<font color="#E5E5E5"> of a s 100 you'll note that</font>

747
00:29:28,280 --> 00:29:34,160
<font color="#E5E5E5">we're learning the slash 16</font><font color="#CCCCCC"> and the next</font>

748
00:29:30,740 --> 00:29:37,880
hop is<font color="#CCCCCC"> 101 1.1 which is the edge routers</font>

749
00:29:34,160 --> 00:29:41,870
<font color="#CCCCCC">loopback we know how to get</font><font color="#E5E5E5"> to 100 1.1.1</font>

750
00:29:37,880 --> 00:29:45,520
in the IGP in this case is<font color="#E5E5E5"> is and we</font>

751
00:29:41,870 --> 00:29:48,050
know what<font color="#E5E5E5"> interfaces to use to reject</font>

752
00:29:45,520 --> 00:29:51,710
<font color="#E5E5E5">the second</font><font color="#CCCCCC"> example</font><font color="#E5E5E5"> we're going</font><font color="#CCCCCC"> to</font>

753
00:29:48,050 --> 00:29:54,129
redistribute connected into<font color="#E5E5E5"> BGP so the</font>

754
00:29:51,710 --> 00:29:58,730
way this works is again<font color="#E5E5E5"> the same</font><font color="#CCCCCC"> setup</font>

755
00:29:54,130 --> 00:29:59,510
<font color="#E5E5E5">and we're going to learn the route via</font>

756
00:29:58,730 --> 00:30:01,340
<font color="#CCCCCC">ebgp</font>

757
00:29:59,510 --> 00:30:04,040
and redistribute our connected routes

758
00:30:01,340 --> 00:30:06,620
<font color="#CCCCCC">into</font><font color="#E5E5E5"> BGP so this slash 30</font><font color="#CCCCCC"> point-to-point</font>

759
00:30:04,040 --> 00:30:10,970
<font color="#CCCCCC">here is</font><font color="#E5E5E5"> going to be redistributed into</font>

760
00:30:06,620 --> 00:30:13,070
the ibgp for a s 100 and you'll see that

761
00:30:10,970 --> 00:30:17,830
here here's the slash 30<font color="#E5E5E5"> with a protocol</font>

762
00:30:13,070 --> 00:30:17,830
next top of<font color="#E5E5E5"> 1.1.11 which is his loopback</font>

763
00:30:19,150 --> 00:30:26,150
we then advertised via<font color="#E5E5E5"> ebgp 2/16 which</font>

764
00:30:23,180 --> 00:30:29,720
shows up here with the next<font color="#E5E5E5"> top of 101.3</font>

765
00:30:26,150 --> 00:30:32,930
<font color="#CCCCCC">- which is the</font><font color="#E5E5E5"> natural next top of the</font>

766
00:30:29,720 --> 00:30:35,180
<font color="#E5E5E5">BGP neighbor and he's gonna react vert</font>

767
00:30:32,930 --> 00:30:38,810
<font color="#E5E5E5">eyes that to the ibgp</font>

768
00:30:35,180 --> 00:30:41,780
and when he advertises the slash 16<font color="#CCCCCC"> it</font>

769
00:30:38,810 --> 00:30:44,300
has<font color="#E5E5E5"> the next top of 101.3</font><font color="#CCCCCC"> - which again</font>

770
00:30:41,780 --> 00:30:46,820
<font color="#CCCCCC">is that</font><font color="#E5E5E5"> same natural next hop and we</font>

771
00:30:44,300 --> 00:30:50,210
know how to get<font color="#E5E5E5"> to</font><font color="#CCCCCC"> 103</font><font color="#E5E5E5"> tear through</font>

772
00:30:46,820 --> 00:30:51,470
<font color="#CCCCCC">100mm</font><font color="#E5E5E5"> 3.0</font><font color="#CCCCCC"> slash 30 which was the</font>

773
00:30:50,210 --> 00:30:56,150
<font color="#E5E5E5">directly connected network that we</font>

774
00:30:51,470 --> 00:30:57,890
redistributed into<font color="#E5E5E5"> BGP so the third case</font>

775
00:30:56,150 --> 00:31:01,910
we're<font color="#E5E5E5"> gonna do here is redistributing</font>

776
00:30:57,890 --> 00:31:04,310
static<font color="#E5E5E5"> into BGP very similar on this</font>

777
00:31:01,910 --> 00:31:07,220
router we do an IP route for these

778
00:31:04,310 --> 00:31:12,379
<font color="#E5E5E5">loopback</font><font color="#CCCCCC"> slash 32 in order to make BGP</font>

779
00:31:07,220 --> 00:31:14,120
come up so we redistribute static and<font color="#CCCCCC"> de</font>

780
00:31:12,380 --> 00:31:16,190
BGP so that static route is<font color="#CCCCCC"> going to</font>

781
00:31:14,120 --> 00:31:20,179
show up<font color="#E5E5E5"> on some other router and a</font><font color="#CCCCCC"> s 100</font>

782
00:31:16,190 --> 00:31:24,620
as 102.3<font color="#CCCCCC"> slash 32 with the next top of</font>

783
00:31:20,180 --> 00:31:28,550
100<font color="#E5E5E5"> 1.1 1.1 he's looped</font><font color="#CCCCCC"> back</font><font color="#E5E5E5"> we then</font>

784
00:31:24,620 --> 00:31:30,530
advertised<font color="#E5E5E5"> via</font><font color="#CCCCCC"> ebgp</font><font color="#E5E5E5"> the slash 16 which</font>

785
00:31:28,550 --> 00:31:34,490
shows up on the edge router with the

786
00:31:30,530 --> 00:31:36,379
<font color="#E5E5E5">next top of</font><font color="#CCCCCC"> 102.3</font><font color="#E5E5E5"> which is the loopback</font>

787
00:31:34,490 --> 00:31:38,000
<font color="#E5E5E5">in this case and the way that this</font>

788
00:31:36,380 --> 00:31:47,210
<font color="#E5E5E5">router gets to the loopback is through</font>

789
00:31:38,000 --> 00:31:50,990
the static route<font color="#E5E5E5"> to 100 1.2 102.3 here</font>

790
00:31:47,210 --> 00:31:53,050
it's down here<font color="#E5E5E5"> 102.3</font><font color="#CCCCCC"> / 32</font><font color="#E5E5E5"> and we know</font>

791
00:31:50,990 --> 00:31:56,840
the interface that's<font color="#E5E5E5"> reachable through</font>

792
00:31:53,050 --> 00:32:00,740
we then re advertise that<font color="#CCCCCC"> slash</font><font color="#E5E5E5"> 16 to</font>

793
00:31:56,840 --> 00:32:03,770
the ibgp<font color="#E5E5E5"> oops and we have the 16 here</font>

794
00:32:00,740 --> 00:32:06,080
with the next top of 102.3<font color="#CCCCCC"> again this</font>

795
00:32:03,770 --> 00:32:07,940
routers loopback address and we know how

796
00:32:06,080 --> 00:32:12,620
to<font color="#E5E5E5"> get</font><font color="#CCCCCC"> to that address</font><font color="#E5E5E5"> because it's been</font>

797
00:32:07,940 --> 00:32:15,710
redistributed into<font color="#E5E5E5"> bgp 102.3 / 32 with</font>

798
00:32:12,620 --> 00:32:18,590
the next top of<font color="#E5E5E5"> 100 1.1.1 this routers</font>

799
00:32:15,710 --> 00:32:21,530
they back so in a nutshell this is<font color="#E5E5E5"> how</font>

800
00:32:18,590 --> 00:32:25,010
route regression<font color="#CCCCCC"> ret resolution works in</font>

801
00:32:21,530 --> 00:32:26,480
the network<font color="#E5E5E5"> for various cases generally</font>

802
00:32:25,010 --> 00:32:27,680
<font color="#E5E5E5">most networks will pick one flavor to</font>

803
00:32:26,480 --> 00:32:29,040
run with for most<font color="#E5E5E5"> of their</font>

804
00:32:27,680 --> 00:32:32,220
interconnectivity

805
00:32:29,040 --> 00:32:34,980
there's also<font color="#CCCCCC"> third-party</font><font color="#E5E5E5"> next hops</font><font color="#CCCCCC"> in</font>

806
00:32:32,220 --> 00:32:39,720
<font color="#E5E5E5">this case a s-300 is ebgp peering</font><font color="#CCCCCC"> with a</font>

807
00:32:34,980 --> 00:32:44,940
<font color="#CCCCCC">f200</font><font color="#E5E5E5"> and advertising 103</font><font color="#CCCCCC"> 0.0 / 16 with</font>

808
00:32:39,720 --> 00:32:48,810
his next hop of<font color="#E5E5E5"> 100 1.33 the interface</font>

809
00:32:44,940 --> 00:32:51,960
on this<font color="#E5E5E5"> Ethernet</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> s 200 is also ebgp</font>

810
00:32:48,810 --> 00:32:57,480
peering<font color="#CCCCCC"> with a s 100</font><font color="#E5E5E5"> and he's going to</font>

811
00:32:51,960 --> 00:33:01,110
advertise<font color="#E5E5E5"> his</font><font color="#CCCCCC"> /</font><font color="#E5E5E5"> 16 102 0.0 / 16 with his</font>

812
00:32:57,480 --> 00:33:07,200
next top of 101.3<font color="#E5E5E5"> - and he's also going</font>

813
00:33:01,110 --> 00:33:08,969
to advertise<font color="#E5E5E5"> 100 3.0 - 0 16 with 101 3.3</font>

814
00:33:07,200 --> 00:33:12,990
is<font color="#E5E5E5"> the next</font><font color="#CCCCCC"> top so he's advertising a</font>

815
00:33:08,970 --> 00:33:15,480
<font color="#E5E5E5">s3's routes with a s 3 s next top this</font>

816
00:33:12,990 --> 00:33:17,880
<font color="#E5E5E5">is a third party next</font><font color="#CCCCCC"> hop</font><font color="#E5E5E5"> this allows a</font>

817
00:33:15,480 --> 00:33:20,370
s 102 not have a<font color="#E5E5E5"> BGP session directly</font>

818
00:33:17,880 --> 00:33:22,560
with a s 300 and to efficiently deliver

819
00:33:20,370 --> 00:33:24,300
that<font color="#E5E5E5"> traffic directly to a s 300 without</font>

820
00:33:22,560 --> 00:33:28,020
having it to go<font color="#E5E5E5"> you turning through a s</font>

821
00:33:24,300 --> 00:33:30,780
200 but there's a danger<font color="#CCCCCC"> in</font><font color="#E5E5E5"> third party</font>

822
00:33:28,020 --> 00:33:33,210
next<font color="#CCCCCC"> hops because they can be</font><font color="#E5E5E5"> used when</font>

823
00:33:30,780 --> 00:33:35,070
<font color="#E5E5E5">the third party is not on a shared</font><font color="#CCCCCC"> lan</font>

824
00:33:33,210 --> 00:33:37,560
and doesn't want those<font color="#CCCCCC"> add those routes</font>

825
00:33:35,070 --> 00:33:40,350
<font color="#E5E5E5">advertised so in this case we have a s</font>

826
00:33:37,560 --> 00:33:42,600
200 getting transit from<font color="#E5E5E5"> a s 100 na s</font>

827
00:33:40,350 --> 00:33:44,310
300 getting transit from a s 100 and

828
00:33:42,600 --> 00:33:47,399
they're each advertising their own

829
00:33:44,310 --> 00:33:49,620
aggregate<font color="#E5E5E5"> and then you could imagine a</font>

830
00:33:47,400 --> 00:33:51,540
denial service attack happens where some

831
00:33:49,620 --> 00:33:53,189
address inside a s 200 is getting

832
00:33:51,540 --> 00:33:54,840
attacked and<font color="#CCCCCC"> it's drawing</font><font color="#E5E5E5"> lots of</font>

833
00:33:53,190 --> 00:33:58,620
traffic<font color="#E5E5E5"> and it's flooding out the link</font>

834
00:33:54,840 --> 00:34:00,570
between a s 100 and a s 300 so as 200

835
00:33:58,620 --> 00:34:03,600
goes ahead and advertises that<font color="#E5E5E5"> single</font>

836
00:34:00,570 --> 00:34:05,899
<font color="#CCCCCC">slash 32 to a s 100 buts it's the next</font>

837
00:34:03,600 --> 00:34:09,029
hop to be some address inside of a s 300

838
00:34:05,900 --> 00:34:11,040
now all of a<font color="#CCCCCC"> sudden a s 100 is</font><font color="#E5E5E5"> going to</font>

839
00:34:09,030 --> 00:34:13,560
forward<font color="#E5E5E5"> all of</font><font color="#CCCCCC"> that dust traffic to a s</font>

840
00:34:11,040 --> 00:34:20,399
300 who turns<font color="#E5E5E5"> out</font><font color="#CCCCCC"> to be a competitor to</font>

841
00:34:13,560 --> 00:34:21,719
<font color="#CCCCCC">asta so wanted</font><font color="#E5E5E5"> to just briefly talk</font>

842
00:34:20,399 --> 00:34:24,600
about<font color="#E5E5E5"> the difference between routing</font>

843
00:34:21,719 --> 00:34:26,040
versus forwarding routing is the process

844
00:34:24,600 --> 00:34:28,440
where information reach ability about

845
00:34:26,040 --> 00:34:29,940
the destination is shared<font color="#E5E5E5"> a router might</font>

846
00:34:28,440 --> 00:34:31,950
learn<font color="#E5E5E5"> multiple paths for a given route</font>

847
00:34:29,940 --> 00:34:33,750
these routes<font color="#E5E5E5"> are stored by</font><font color="#CCCCCC"> the routing</font>

848
00:34:31,949 --> 00:34:36,178
<font color="#CCCCCC">engine or</font><font color="#E5E5E5"> the route processor in the</font>

849
00:34:33,750 --> 00:34:37,800
routing<font color="#E5E5E5"> information base or the RHIB it</font>

850
00:34:36,179 --> 00:34:39,720
does path<font color="#E5E5E5"> selection and it chooses the</font>

851
00:34:37,800 --> 00:34:42,690
<font color="#CCCCCC">best</font><font color="#E5E5E5"> path and that's the one that's used</font>

852
00:34:39,719 --> 00:34:45,209
for forwarding<font color="#E5E5E5"> so once the best path is</font>

853
00:34:42,690 --> 00:34:47,220
chosen that information is<font color="#CCCCCC"> shared with</font>

854
00:34:45,210 --> 00:34:48,750
the<font color="#E5E5E5"> forwarding engine and is stored in</font>

855
00:34:47,219 --> 00:34:50,969
the forwarding information<font color="#E5E5E5"> based the</font><font color="#CCCCCC"> FIB</font>

856
00:34:48,750 --> 00:34:52,469
and you basically<font color="#E5E5E5"> do a fib lookup and</font>

857
00:34:50,969 --> 00:34:56,219
consult the fib table to<font color="#E5E5E5"> figure out what</font>

858
00:34:52,469 --> 00:34:57,810
interface<font color="#E5E5E5"> to send traffic out of so if</font>

859
00:34:56,219 --> 00:35:00,540
we go back<font color="#CCCCCC"> to you the customer</font><font color="#E5E5E5"> to</font>

860
00:34:57,810 --> 00:35:02,940
customer for picture<font color="#CCCCCC"> these</font><font color="#E5E5E5"> very light</font>

861
00:35:00,540 --> 00:35:05,220
<font color="#CCCCCC">gray arrows are the route propagation</font>

862
00:35:02,940 --> 00:35:07,349
information<font color="#E5E5E5"> but if we look at customer</font>

863
00:35:05,220 --> 00:35:09,930
tooth perspective he's got three equally

864
00:35:07,349 --> 00:35:11,910
good paths to reach customer<font color="#E5E5E5"> for so</font>

865
00:35:09,930 --> 00:35:14,160
there's one through<font color="#CCCCCC"> AT&T and</font><font color="#E5E5E5"> you unit</font><font color="#CCCCCC"> to</font>

866
00:35:11,910 --> 00:35:15,810
customer for<font color="#E5E5E5"> one through all stream and</font>

867
00:35:14,160 --> 00:35:19,500
you unit to customer<font color="#CCCCCC"> four and one three</font>

868
00:35:15,810 --> 00:35:21,270
level three<font color="#E5E5E5"> to customer four so customer</font>

869
00:35:19,500 --> 00:35:26,670
to you has to choose between<font color="#E5E5E5"> these</font>

870
00:35:21,270 --> 00:35:29,060
equally<font color="#E5E5E5"> good paths to forward between so</font>

871
00:35:26,670 --> 00:35:33,510
<font color="#E5E5E5">we do that through</font><font color="#CCCCCC"> a BGP path selection</font>

872
00:35:29,060 --> 00:35:35,578
<font color="#E5E5E5">so at a high</font><font color="#CCCCCC"> level this is the</font><font color="#E5E5E5"> BGP path</font>

873
00:35:33,510 --> 00:35:37,740
selection overview I'm gonna dive down

874
00:35:35,579 --> 00:35:39,900
and<font color="#CCCCCC"> go</font><font color="#E5E5E5"> through these much slowly after I</font>

875
00:35:37,740 --> 00:35:41,459
<font color="#CCCCCC">ran through</font><font color="#E5E5E5"> this slide but</font><font color="#CCCCCC"> I wanted</font><font color="#E5E5E5"> to</font>

876
00:35:39,900 --> 00:35:43,380
run<font color="#CCCCCC"> through them really quickly once so</font>

877
00:35:41,460 --> 00:35:45,960
that<font color="#E5E5E5"> you could see in entirety what the</font>

878
00:35:43,380 --> 00:35:47,130
path selection<font color="#E5E5E5"> algorithm looks like so</font>

879
00:35:45,960 --> 00:35:49,680
the<font color="#E5E5E5"> first thing you do is you check to</font>

880
00:35:47,130 --> 00:35:51,599
make sure that<font color="#CCCCCC"> it has a valid route</font><font color="#E5E5E5"> that</font>

881
00:35:49,680 --> 00:35:53,190
that route is reachable<font color="#E5E5E5"> and prefer</font>

882
00:35:51,599 --> 00:35:53,760
routes<font color="#E5E5E5"> that are more specific over less</font>

883
00:35:53,190 --> 00:35:55,800
specific

884
00:35:53,760 --> 00:35:58,020
then<font color="#CCCCCC"> you're gonna prefer the lowest</font>

885
00:35:55,800 --> 00:36:01,550
protocol preference<font color="#E5E5E5"> or</font><font color="#CCCCCC"> the highest</font><font color="#E5E5E5"> Cisco</font>

886
00:35:58,020 --> 00:36:05,009
proprietary weight<font color="#E5E5E5"> higher local proof</font>

887
00:36:01,550 --> 00:36:06,750
locally originated on Cisco shortest<font color="#CCCCCC"> AAS</font>

888
00:36:05,010 --> 00:36:08,339
path<font color="#CCCCCC"> length</font><font color="#E5E5E5"> locally originated on</font>

889
00:36:06,750 --> 00:36:09,950
juniper<font color="#E5E5E5"> you can see the vendors</font>

890
00:36:08,339 --> 00:36:12,660
implement<font color="#E5E5E5"> things slightly differently</font>

891
00:36:09,950 --> 00:36:14,790
<font color="#E5E5E5">lowest origin code where</font><font color="#CCCCCC"> IGP is better</font>

892
00:36:12,660 --> 00:36:17,640
than<font color="#CCCCCC"> EGP which</font><font color="#E5E5E5"> is better than incomplete</font>

893
00:36:14,790 --> 00:36:20,759
or unknown lowest multi exit

894
00:36:17,640 --> 00:36:23,759
discriminator prefer ebgp learned routes

895
00:36:20,760 --> 00:36:25,430
over ibgp learned routes<font color="#E5E5E5"> lowest</font><font color="#CCCCCC"> IGP</font>

896
00:36:23,760 --> 00:36:27,690
distance to the protocol<font color="#E5E5E5"> next top</font>

897
00:36:25,430 --> 00:36:33,710
shortest route reflector cluster<font color="#CCCCCC"> length</font>

898
00:36:27,690 --> 00:36:36,810
<font color="#CCCCCC">if you're on a juniper oldest</font><font color="#E5E5E5"> ebgp path</font>

899
00:36:33,710 --> 00:36:39,000
<font color="#E5E5E5">lowest router ID shortest route</font>

900
00:36:36,810 --> 00:36:42,750
reflection cluster<font color="#CCCCCC"> lengths on Cisco and</font>

901
00:36:39,000 --> 00:36:46,170
lowest neighbor address so these are all

902
00:36:42,750 --> 00:36:49,410
based on<font color="#E5E5E5"> BGP attributes so what is a BGP</font>

903
00:36:46,170 --> 00:36:51,569
attribute<font color="#E5E5E5"> well a BGP message consists of</font>

904
00:36:49,410 --> 00:36:52,020
one or<font color="#CCCCCC"> more NL RI</font><font color="#E5E5E5"> well what's an</font><font color="#CCCCCC"> inn</font>

905
00:36:51,569 --> 00:36:54,330
<font color="#E5E5E5">allure</font>

906
00:36:52,020 --> 00:36:57,509
<font color="#CCCCCC">NLR eye is a network layer reach</font><font color="#E5E5E5"> ability</font>

907
00:36:54,330 --> 00:36:59,970
<font color="#E5E5E5">information it's typically a prefix and</font>

908
00:36:57,510 --> 00:37:02,400
<font color="#CCCCCC">it's mask so</font><font color="#E5E5E5"> whenever anyone says you</font>

909
00:36:59,970 --> 00:37:05,250
know talks about an NL RI they're

910
00:37:02,400 --> 00:37:06,930
talking about<font color="#E5E5E5"> a prefix in a mask</font><font color="#CCCCCC"> when</font>

911
00:37:05,250 --> 00:37:09,600
you send an update<font color="#E5E5E5"> or withdrawal or a</font>

912
00:37:06,930 --> 00:37:11,368
BGP message all of the prefixes<font color="#E5E5E5"> in that</font>

913
00:37:09,600 --> 00:37:13,830
message<font color="#E5E5E5"> must share the same set of</font>

914
00:37:11,369 --> 00:37:15,600
attributes<font color="#E5E5E5"> and the attributes are</font>

915
00:37:13,830 --> 00:37:18,299
properties that<font color="#E5E5E5"> describe the route or</font>

916
00:37:15,600 --> 00:37:20,640
routes<font color="#E5E5E5"> and those attributes are encoded</font>

917
00:37:18,300 --> 00:37:23,180
in a<font color="#CCCCCC"> TLV type length value which makes</font>

918
00:37:20,640 --> 00:37:26,040
it<font color="#E5E5E5"> easily extensible so you just specify</font>

919
00:37:23,180 --> 00:37:28,470
<font color="#CCCCCC">the attribute that you're adding</font><font color="#E5E5E5"> is of</font>

920
00:37:26,040 --> 00:37:30,690
this type it is this long and<font color="#E5E5E5"> this is</font>

921
00:37:28,470 --> 00:37:35,490
<font color="#CCCCCC">the value so if you wanted</font><font color="#E5E5E5"> to add a new</font>

922
00:37:30,690 --> 00:37:37,950
<font color="#CCCCCC">TLV type it's fairly easy to do so BGP</font>

923
00:37:35,490 --> 00:37:39,479
types some<font color="#CCCCCC"> are mandatory which means it</font>

924
00:37:37,950 --> 00:37:41,189
has<font color="#E5E5E5"> to</font><font color="#CCCCCC"> be in the update if it's not in</font>

925
00:37:39,480 --> 00:37:43,230
the update the update<font color="#CCCCCC"> is</font><font color="#E5E5E5"> not valid and</font>

926
00:37:41,190 --> 00:37:44,550
you have to throw it<font color="#E5E5E5"> away some are</font>

927
00:37:43,230 --> 00:37:46,380
optional which means not all

928
00:37:44,550 --> 00:37:48,930
<font color="#E5E5E5">implementations need to understand the</font>

929
00:37:46,380 --> 00:37:50,640
attribute some are discretionary which

930
00:37:48,930 --> 00:37:53,460
means it's not<font color="#E5E5E5"> required to be in</font><font color="#CCCCCC"> the</font>

931
00:37:50,640 --> 00:37:54,600
update some are transitive which means

932
00:37:53,460 --> 00:37:56,670
it can<font color="#CCCCCC"> be shared</font><font color="#E5E5E5"> between multiple</font>

933
00:37:54,600 --> 00:37:59,009
<font color="#E5E5E5">networks and some are non transitive</font>

934
00:37:56,670 --> 00:38:03,510
which means they get lost at the ebgp

935
00:37:59,010 --> 00:38:04,560
boundary so diving<font color="#E5E5E5"> in now the first</font>

936
00:38:03,510 --> 00:38:06,630
<font color="#E5E5E5">three things I talked about were</font>

937
00:38:04,560 --> 00:38:08,520
validity reach ability<font color="#E5E5E5"> and specificity</font>

938
00:38:06,630 --> 00:38:10,410
these are actually<font color="#E5E5E5"> not part of the BGP</font>

939
00:38:08,520 --> 00:38:12,840
path selection<font color="#E5E5E5"> algorithm but I've</font>

940
00:38:10,410 --> 00:38:14,790
included<font color="#CCCCCC"> them here for completeness</font><font color="#E5E5E5"> so</font>

941
00:38:12,840 --> 00:38:16,080
the first one is<font color="#E5E5E5"> validity</font><font color="#CCCCCC"> you want to</font>

942
00:38:14,790 --> 00:38:18,720
make<font color="#CCCCCC"> sure that the route that</font><font color="#E5E5E5"> you're</font>

943
00:38:16,080 --> 00:38:21,750
<font color="#E5E5E5">getting is not malformed it might have</font>

944
00:38:18,720 --> 00:38:25,080
an invalid attribute value it might have

945
00:38:21,750 --> 00:38:26,550
a required attribute<font color="#CCCCCC"> that is missing and</font>

946
00:38:25,080 --> 00:38:28,109
it might have a variable<font color="#E5E5E5"> length</font>

947
00:38:26,550 --> 00:38:29,580
<font color="#CCCCCC">attribute where it says the</font><font color="#E5E5E5"> length of</font>

948
00:38:28,109 --> 00:38:31,590
the attribute is this long and<font color="#E5E5E5"> then it</font>

949
00:38:29,580 --> 00:38:33,180
has this much data in it<font color="#CCCCCC"> so if those</font>

950
00:38:31,590 --> 00:38:36,140
don't<font color="#E5E5E5"> match up</font><font color="#CCCCCC"> clearly</font><font color="#E5E5E5"> something is</font>

951
00:38:33,180 --> 00:38:38,940
wrong it's not<font color="#E5E5E5"> valid you throw it away</font>

952
00:38:36,140 --> 00:38:41,100
additionally we have an<font color="#E5E5E5"> a s path and the</font>

953
00:38:38,940 --> 00:38:43,530
ass path records every<font color="#CCCCCC"> network that the</font>

954
00:38:41,100 --> 00:38:46,290
route has propagated<font color="#E5E5E5"> through and that's</font>

955
00:38:43,530 --> 00:38:48,600
partly used for loop prevention<font color="#E5E5E5"> so if</font>

956
00:38:46,290 --> 00:38:49,920
you see<font color="#E5E5E5"> your own a s in the AF path you</font>

957
00:38:48,600 --> 00:38:51,900
consider that<font color="#E5E5E5"> looped you should know</font>

958
00:38:49,920 --> 00:38:55,230
<font color="#CCCCCC">about that route directly</font><font color="#E5E5E5"> from yourself</font>

959
00:38:51,900 --> 00:38:57,119
<font color="#E5E5E5">throw those away same about cluster ID</font>

960
00:38:55,230 --> 00:38:59,780
<font color="#E5E5E5">list</font><font color="#CCCCCC"> if your own</font><font color="#E5E5E5"> cluster is in the</font>

961
00:38:57,119 --> 00:39:02,430
cluster list<font color="#E5E5E5"> it's looped throw it away</font>

962
00:38:59,780 --> 00:39:04,740
<font color="#E5E5E5">and</font><font color="#CCCCCC"> then there's also some knobs as well</font>

963
00:39:02,430 --> 00:39:06,899
there's enforced first<font color="#E5E5E5"> a s</font>

964
00:39:04,740 --> 00:39:08,669
there's<font color="#E5E5E5"> this transparent route reflector</font>

965
00:39:06,900 --> 00:39:10,710
thing that can send you an update and

966
00:39:08,670 --> 00:39:13,200
not include itself in the<font color="#CCCCCC"> AAS path and</font>

967
00:39:10,710 --> 00:39:15,480
that looks kind<font color="#E5E5E5"> of bogus</font><font color="#CCCCCC"> so there's a</font>

968
00:39:13,200 --> 00:39:17,790
knob that<font color="#CCCCCC"> you</font><font color="#E5E5E5"> can say if the first day s</font>

969
00:39:15,480 --> 00:39:21,150
is not<font color="#CCCCCC"> the ASM peering with throw that</font>

970
00:39:17,790 --> 00:39:23,250
route away<font color="#CCCCCC"> and then lastly is this Cisco</font>

971
00:39:21,150 --> 00:39:26,369
default value which is synchronization

972
00:39:23,250 --> 00:39:29,460
<font color="#E5E5E5">it used to be in I</font><font color="#CCCCCC"> think</font><font color="#E5E5E5"> for up to a</font>

973
00:39:26,369 --> 00:39:31,710
<font color="#E5E5E5">version iOS 11 if you are</font><font color="#CCCCCC"> learning a</font>

974
00:39:29,460 --> 00:39:33,599
route<font color="#E5E5E5"> and the next hop was not reachable</font>

975
00:39:31,710 --> 00:39:35,130
in your<font color="#CCCCCC"> IGP you consider it on Vallot</font>

976
00:39:33,599 --> 00:39:36,780
and you throw it away<font color="#CCCCCC"> unless you</font>

977
00:39:35,130 --> 00:39:38,849
configure no sync which virtually

978
00:39:36,780 --> 00:39:40,950
everyone did so they<font color="#E5E5E5"> recently</font><font color="#CCCCCC"> changed</font>

979
00:39:38,849 --> 00:39:44,880
that to be the default behavior in

980
00:39:40,950 --> 00:39:46,890
<font color="#CCCCCC">12-something</font><font color="#E5E5E5"> so that's a validity the</font>

981
00:39:44,880 --> 00:39:48,390
next is reach ability<font color="#E5E5E5"> so you get a valid</font>

982
00:39:46,890 --> 00:39:50,368
me formed route and it's got a protocol

983
00:39:48,390 --> 00:39:51,629
next<font color="#CCCCCC"> top</font><font color="#E5E5E5"> can you actually reach</font><font color="#CCCCCC"> that</font>

984
00:39:50,369 --> 00:39:53,579
next<font color="#CCCCCC"> top do you have a route to that</font>

985
00:39:51,630 --> 00:39:56,609
<font color="#E5E5E5">next top is that next top reachable</font>

986
00:39:53,579 --> 00:39:57,990
<font color="#CCCCCC">through itself or is there</font><font color="#E5E5E5"> no route to</font>

987
00:39:56,609 --> 00:39:59,819
that<font color="#E5E5E5"> next top at all if any of these</font>

988
00:39:57,990 --> 00:40:02,910
things occur<font color="#CCCCCC"> you can't get there on the</font>

989
00:39:59,820 --> 00:40:04,619
routes<font color="#E5E5E5"> not usable throw it away and then</font>

990
00:40:02,910 --> 00:40:06,180
the last thing<font color="#E5E5E5"> is specificity more</font>

991
00:40:04,619 --> 00:40:09,000
specific routes are preferred<font color="#E5E5E5"> over least</font>

992
00:40:06,180 --> 00:40:11,940
specific<font color="#E5E5E5"> routes</font><font color="#CCCCCC"> so if you have 1 2 3 . /</font>

993
00:40:09,000 --> 00:40:14,609
24 that's better than 1<font color="#E5E5E5"> dot 2 dot 0 dot</font>

994
00:40:11,940 --> 00:40:15,900
0<font color="#CCCCCC"> / 16 you can imagine if you're holding</font>

995
00:40:14,609 --> 00:40:18,690
a<font color="#E5E5E5"> letter and you want to mail it to</font>

996
00:40:15,900 --> 00:40:21,300
school<font color="#CCCCCC"> pennsylvania and to post trucks</font>

997
00:40:18,690 --> 00:40:22,829
come by and one postman says<font color="#E5E5E5"> i know how</font>

998
00:40:21,300 --> 00:40:24,420
to<font color="#E5E5E5"> get to pennsylvania and the other one</font>

999
00:40:22,829 --> 00:40:26,160
says well I live in school and<font color="#E5E5E5"> I know</font>

1000
00:40:24,420 --> 00:40:27,420
right<font color="#E5E5E5"> where</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> is which one do</font><font color="#CCCCCC"> you</font>

1001
00:40:26,160 --> 00:40:29,520
think<font color="#E5E5E5"> is going</font><font color="#CCCCCC"> to be</font><font color="#E5E5E5"> more reliable and</font>

1002
00:40:27,420 --> 00:40:31,020
delivering<font color="#E5E5E5"> your letter the one that has</font>

1003
00:40:29,520 --> 00:40:33,089
more<font color="#CCCCCC"> information about</font><font color="#E5E5E5"> the destination</font>

1004
00:40:31,020 --> 00:40:35,430
same thing with<font color="#CCCCCC"> a</font><font color="#E5E5E5"> routing protocol the</font>

1005
00:40:33,089 --> 00:40:37,349
more specific routes<font color="#E5E5E5"> are more detailed</font>

1006
00:40:35,430 --> 00:40:39,210
information<font color="#E5E5E5"> about the destination more</font>

1007
00:40:37,349 --> 00:40:41,910
likely to<font color="#E5E5E5"> get you to that destination so</font>

1008
00:40:39,210 --> 00:40:43,020
they're<font color="#E5E5E5"> more preferred incidentally this</font>

1009
00:40:41,910 --> 00:40:44,700
<font color="#E5E5E5">is</font><font color="#CCCCCC"> also why</font>

1010
00:40:43,020 --> 00:40:45,990
prefix hijacking becomes a problem

1011
00:40:44,700 --> 00:40:47,609
<font color="#CCCCCC">because</font><font color="#E5E5E5"> people</font><font color="#CCCCCC"> will just</font><font color="#E5E5E5"> start</font>

1012
00:40:45,990 --> 00:40:52,109
arbitrarily announcing a more specific

1013
00:40:47,609 --> 00:40:55,078
<font color="#CCCCCC">route and suck traffic away so protocol</font>

1014
00:40:52,109 --> 00:40:58,380
preference in<font color="#E5E5E5"> Cisco proprietary wait the</font>

1015
00:40:55,079 --> 00:41:01,200
lowest protocol preference wins<font color="#CCCCCC"> and the</font>

1016
00:40:58,380 --> 00:41:03,450
highest<font color="#CCCCCC"> Cisco</font><font color="#E5E5E5"> proprietary weight wins</font><font color="#CCCCCC"> so</font>

1017
00:41:01,200 --> 00:41:05,098
<font color="#CCCCCC">cisco proprietary weight is a value that</font>

1018
00:41:03,450 --> 00:41:07,710
<font color="#CCCCCC">you</font><font color="#E5E5E5"> can configure locally on the router</font>

1019
00:41:05,099 --> 00:41:10,079
<font color="#E5E5E5">it's not part of BGP it's not advertised</font>

1020
00:41:07,710 --> 00:41:13,560
<font color="#E5E5E5">anyone else the default value is right</font>

1021
00:41:10,079 --> 00:41:16,950
in the<font color="#CCCCCC"> middle at 32,767 and you can</font>

1022
00:41:13,560 --> 00:41:17,549
manually make it lower down<font color="#CCCCCC"> to 0</font><font color="#E5E5E5"> or</font>

1023
00:41:16,950 --> 00:41:21,750
higher

1024
00:41:17,550 --> 00:41:23,100
<font color="#CCCCCC">265</font><font color="#E5E5E5"> 535</font><font color="#CCCCCC"> you can figure this through</font>

1025
00:41:21,750 --> 00:41:29,580
policy either<font color="#E5E5E5"> per neighbor</font>

1026
00:41:23,100 --> 00:41:32,009
<font color="#E5E5E5">per prefix</font><font color="#CCCCCC"> by our route</font><font color="#E5E5E5"> map</font><font color="#CCCCCC"> and wait is</font>

1027
00:41:29,580 --> 00:41:33,660
not propagated<font color="#CCCCCC"> to other bgp routers</font><font color="#E5E5E5"> this</font>

1028
00:41:32,010 --> 00:41:36,870
is a<font color="#E5E5E5"> fairly dangerous knob that</font>

1029
00:41:33,660 --> 00:41:38,490
generally<font color="#E5E5E5"> people shouldn't use</font><font color="#CCCCCC"> but if</font>

1030
00:41:36,870 --> 00:41:39,680
you<font color="#CCCCCC"> find you need to use it and you find</font>

1031
00:41:38,490 --> 00:41:41,879
that you have<font color="#CCCCCC"> a multi vendor</font>

1032
00:41:39,680 --> 00:41:43,710
<font color="#E5E5E5">implementation you'll note that juniper</font>

1033
00:41:41,880 --> 00:41:45,480
doesn't have the<font color="#CCCCCC"> cisco proprietary</font><font color="#E5E5E5"> wait</font>

1034
00:41:43,710 --> 00:41:47,850
<font color="#E5E5E5">so the way that</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> would create a</font>

1035
00:41:45,480 --> 00:41:49,290
<font color="#E5E5E5">similar behavior in juniper is to</font>

1036
00:41:47,850 --> 00:41:51,569
manipulate<font color="#CCCCCC"> the locally configured</font>

1037
00:41:49,290 --> 00:41:53,190
protocol preference on specific<font color="#CCCCCC"> bgp</font><font color="#E5E5E5"> /</font>

1038
00:41:51,570 --> 00:41:57,150
prefixes and<font color="#E5E5E5"> you can do that through</font>

1039
00:41:53,190 --> 00:41:58,830
<font color="#E5E5E5">policy so here is a table</font><font color="#CCCCCC"> that just</font>

1040
00:41:57,150 --> 00:41:59,940
shows the<font color="#E5E5E5"> relative weights of the</font>

1041
00:41:58,830 --> 00:42:01,650
different<font color="#E5E5E5"> protocol preference</font>

1042
00:41:59,940 --> 00:42:03,990
preferences<font color="#E5E5E5"> again there is some</font>

1043
00:42:01,650 --> 00:42:06,170
differences between vendors<font color="#E5E5E5"> but</font>

1044
00:42:03,990 --> 00:42:09,149
generally they're more<font color="#CCCCCC"> or less the same</font>

1045
00:42:06,170 --> 00:42:12,210
isis<font color="#CCCCCC"> OSPF is more preferred than is is</font>

1046
00:42:09,150 --> 00:42:14,540
is is is<font color="#CCCCCC"> more preferred than BGP so on</font>

1047
00:42:12,210 --> 00:42:17,610
and so forth

1048
00:42:14,540 --> 00:42:19,350
local preference so highest local

1049
00:42:17,610 --> 00:42:22,140
preference is preferred the default

1050
00:42:19,350 --> 00:42:24,299
local<font color="#E5E5E5"> preference is 100 and local / F</font>

1051
00:42:22,140 --> 00:42:27,210
can<font color="#E5E5E5"> be set</font><font color="#CCCCCC"> by power policy and it can be</font>

1052
00:42:24,300 --> 00:42:29,220
used<font color="#E5E5E5"> to modify outbound traffic local</font>

1053
00:42:27,210 --> 00:42:31,530
<font color="#E5E5E5">pref is sent to ibgp neighbors but it's</font>

1054
00:42:29,220 --> 00:42:34,560
not transitive it's not sent to ebgp

1055
00:42:31,530 --> 00:42:36,630
neighbors however typically transit

1056
00:42:34,560 --> 00:42:38,190
providers will offer<font color="#E5E5E5"> a set of</font>

1057
00:42:36,630 --> 00:42:39,930
communities that allow a<font color="#E5E5E5"> customer to</font>

1058
00:42:38,190 --> 00:42:42,330
indicate<font color="#E5E5E5"> a local preference value that</font>

1059
00:42:39,930 --> 00:42:44,100
<font color="#E5E5E5">they desire you slap that community on</font>

1060
00:42:42,330 --> 00:42:46,950
your prefix you send it to your ebgp

1061
00:42:44,100 --> 00:42:48,420
upstream transit provider<font color="#E5E5E5"> it matches on</font>

1062
00:42:46,950 --> 00:42:50,460
that community<font color="#CCCCCC"> and sets your</font><font color="#E5E5E5"> desired</font>

1063
00:42:48,420 --> 00:42:52,320
local preference<font color="#CCCCCC"> so in</font><font color="#E5E5E5"> that fashion</font><font color="#CCCCCC"> you</font>

1064
00:42:50,460 --> 00:42:57,840
can use it to control<font color="#E5E5E5"> inbound traffic as</font>

1065
00:42:52,320 --> 00:42:59,430
well on<font color="#E5E5E5"> Cisco locally originated routes</font>

1066
00:42:57,840 --> 00:43:02,190
that<font color="#E5E5E5"> are locally originated and</font>

1067
00:42:59,430 --> 00:43:03,870
redistributed into<font color="#E5E5E5"> BGP</font><font color="#CCCCCC"> are preferred so</font>

1068
00:43:02,190 --> 00:43:06,480
that includes<font color="#E5E5E5"> the</font><font color="#CCCCCC"> network statement on</font>

1069
00:43:03,870 --> 00:43:07,799
the local router<font color="#CCCCCC"> that includes routes</font>

1070
00:43:06,480 --> 00:43:10,400
that are<font color="#E5E5E5"> redistributed from another</font>

1071
00:43:07,800 --> 00:43:13,740
protocol<font color="#E5E5E5"> like static or connected and</font>

1072
00:43:10,400 --> 00:43:16,370
that<font color="#E5E5E5"> includes routes that</font><font color="#CCCCCC"> are created</font>

1073
00:43:13,740 --> 00:43:19,080
through<font color="#E5E5E5"> the aggregate command as well</font>

1074
00:43:16,370 --> 00:43:21,660
juniper doesn't really redistribute from

1075
00:43:19,080 --> 00:43:25,259
one protocol to<font color="#E5E5E5"> BGP locally on the box</font>

1076
00:43:21,660 --> 00:43:28,049
so<font color="#E5E5E5"> it doesn't really apply the next is</font>

1077
00:43:25,260 --> 00:43:30,180
shortest<font color="#CCCCCC"> a s path as a route propagates</font>

1078
00:43:28,050 --> 00:43:30,599
from<font color="#E5E5E5"> network to network the a s is added</font>

1079
00:43:30,180 --> 00:43:33,089
<font color="#CCCCCC">to the a</font>

1080
00:43:30,599 --> 00:43:34,650
path<font color="#E5E5E5"> the origin is going</font><font color="#CCCCCC"> to be all the</font>

1081
00:43:33,089 --> 00:43:36,299
<font color="#E5E5E5">way to the right and</font><font color="#CCCCCC"> as it goes</font><font color="#E5E5E5"> through</font>

1082
00:43:34,650 --> 00:43:39,029
<font color="#E5E5E5">the</font><font color="#CCCCCC"> network</font><font color="#E5E5E5"> each a s is going to be</font>

1083
00:43:36,299 --> 00:43:40,440
appended to<font color="#CCCCCC"> that list with</font><font color="#E5E5E5"> all the way</font>

1084
00:43:39,029 --> 00:43:43,049
to the<font color="#E5E5E5"> left being the a s that you're</font>

1085
00:43:40,440 --> 00:43:44,910
hearing<font color="#E5E5E5"> the route from like I said</font>

1086
00:43:43,049 --> 00:43:47,369
before the a s path is used to prevent

1087
00:43:44,910 --> 00:43:50,399
routing loops<font color="#E5E5E5"> but it's also a rough</font>

1088
00:43:47,369 --> 00:43:52,349
measure of distance as well<font color="#CCCCCC"> there's a</font>

1089
00:43:50,400 --> 00:43:55,349
few caveats here<font color="#E5E5E5"> if you have an a s set</font>

1090
00:43:52,349 --> 00:43:57,029
that only<font color="#E5E5E5"> counts as a single a s and if</font>

1091
00:43:55,349 --> 00:43:58,739
you have<font color="#CCCCCC"> Confederate</font><font color="#E5E5E5"> asses and the</font>

1092
00:43:57,029 --> 00:44:00,329
<font color="#CCCCCC">aspect is don't count at all</font><font color="#E5E5E5"> I'll talk</font>

1093
00:43:58,739 --> 00:44:03,989
more about Confederation in the second

1094
00:44:00,329 --> 00:44:05,640
half<font color="#CCCCCC"> it's not a very good</font><font color="#E5E5E5"> measure of</font>

1095
00:44:03,989 --> 00:44:07,259
<font color="#E5E5E5">distance because it's possible</font><font color="#CCCCCC"> that you</font>

1096
00:44:05,640 --> 00:44:09,900
can<font color="#CCCCCC"> have</font><font color="#E5E5E5"> some transit providers that</font>

1097
00:44:07,259 --> 00:44:12,029
<font color="#E5E5E5">have one large global autonomous system</font>

1098
00:44:09,900 --> 00:44:13,499
with a single<font color="#CCCCCC"> a s and you might have</font>

1099
00:44:12,029 --> 00:44:15,809
other transit providers that have

1100
00:44:13,499 --> 00:44:18,660
<font color="#E5E5E5">multiple a s is spanning that same</font>

1101
00:44:15,809 --> 00:44:20,130
global<font color="#E5E5E5"> space so it's not the best</font>

1102
00:44:18,660 --> 00:44:23,009
measure of<font color="#E5E5E5"> distance but it's the only</font>

1103
00:44:20,130 --> 00:44:24,210
<font color="#E5E5E5">one that</font><font color="#CCCCCC"> we have so giving an idea of</font>

1104
00:44:23,009 --> 00:44:26,579
what<font color="#E5E5E5"> this</font><font color="#CCCCCC"> looks like</font>

1105
00:44:24,210 --> 00:44:28,829
we've got customer for sending his route

1106
00:44:26,579 --> 00:44:31,859
to his<font color="#CCCCCC"> two upstream providers new unit</font>

1107
00:44:28,829 --> 00:44:35,579
level<font color="#CCCCCC"> 3 when he sends it to ebgp he adds</font>

1108
00:44:31,859 --> 00:44:37,380
he adds<font color="#E5E5E5"> his</font><font color="#CCCCCC"> a SAS 400 to the path when</font>

1109
00:44:35,579 --> 00:44:41,519
level<font color="#E5E5E5"> 3 sends it up to</font><font color="#CCCCCC"> their</font><font color="#E5E5E5"> downstream</font>

1110
00:44:37,380 --> 00:44:45,509
<font color="#CCCCCC">Zahl stream and bt</font><font color="#E5E5E5"> level 3 adds 3 3</font><font color="#CCCCCC"> 5 6</font>

1111
00:44:41,519 --> 00:44:48,089
to the<font color="#CCCCCC"> a s path and same</font><font color="#E5E5E5"> for when he</font>

1112
00:44:45,509 --> 00:44:50,099
sends<font color="#E5E5E5"> it to transit BT sends it to their</font>

1113
00:44:48,089 --> 00:44:52,710
customers<font color="#CCCCCC"> you'll now see 3 a s is in the</font>

1114
00:44:50,099 --> 00:44:54,539
ass path five four zero<font color="#CCCCCC"> zero which is</font><font color="#E5E5E5"> BT</font>

1115
00:44:52,710 --> 00:44:58,009
<font color="#CCCCCC">three three five six which is</font><font color="#E5E5E5"> level</font>

1116
00:44:54,539 --> 00:45:00,359
<font color="#E5E5E5">three</font><font color="#CCCCCC"> na s 400 which is customer</font><font color="#E5E5E5"> four</font>

1117
00:44:58,009 --> 00:45:03,180
same for all scream all scream<font color="#CCCCCC"> will send</font>

1118
00:45:00,359 --> 00:45:05,339
it to<font color="#E5E5E5"> its customer and you'll see a s</font>

1119
00:45:03,180 --> 00:45:07,259
400 the origination you'll see three

1120
00:45:05,339 --> 00:45:09,749
<font color="#E5E5E5">three five six the level three path as</font>

1121
00:45:07,259 --> 00:45:13,249
well as one five two nine zero<font color="#E5E5E5"> all</font>

1122
00:45:09,749 --> 00:45:15,988
stream and that's<font color="#E5E5E5"> not the only</font><font color="#CCCCCC"> path</font><font color="#E5E5E5"> that</font>

1123
00:45:13,249 --> 00:45:17,968
exists in this<font color="#CCCCCC"> two apology there's lots</font>

1124
00:45:15,989 --> 00:45:19,380
of<font color="#E5E5E5"> other paths</font><font color="#CCCCCC"> for example level</font><font color="#E5E5E5"> three</font>

1125
00:45:17,969 --> 00:45:21,239
<font color="#E5E5E5">we'll see it directly</font><font color="#CCCCCC"> from</font><font color="#E5E5E5"> a as</font><font color="#CCCCCC"> four</font>

1126
00:45:19,380 --> 00:45:24,239
<font color="#CCCCCC">hundred as well as from</font><font color="#E5E5E5"> its peering</font>

1127
00:45:21,239 --> 00:45:25,499
session from 701 701 we'll see it

1128
00:45:24,239 --> 00:45:28,380
directly<font color="#CCCCCC"> from the customer as well as</font>

1129
00:45:25,499 --> 00:45:29,759
<font color="#E5E5E5">its appearing session from level</font><font color="#CCCCCC"> 380 and</font>

1130
00:45:28,380 --> 00:45:32,219
<font color="#CCCCCC">we'll see it from its peering session</font>

1131
00:45:29,759 --> 00:45:35,369
with seven 701 all stream will see three

1132
00:45:32,219 --> 00:45:37,799
paths<font color="#E5E5E5"> he'll see</font><font color="#CCCCCC"> he'll steve as400 behind</font>

1133
00:45:35,369 --> 00:45:39,569
701<font color="#E5E5E5"> as well as behind level</font><font color="#CCCCCC"> three and</font>

1134
00:45:37,799 --> 00:45:40,890
those are built the<font color="#E5E5E5"> same length so</font>

1135
00:45:39,569 --> 00:45:43,319
they're equally as<font color="#E5E5E5"> good and he's going</font>

1136
00:45:40,890 --> 00:45:44,220
to do path<font color="#E5E5E5"> selection on something lower</font>

1137
00:45:43,319 --> 00:45:47,759
down<font color="#E5E5E5"> in the algorithm</font>

1138
00:45:44,220 --> 00:45:50,848
the<font color="#CCCCCC"> 18t path is much longer</font><font color="#E5E5E5"> so is not</font>

1139
00:45:47,760 --> 00:45:52,500
preferred<font color="#E5E5E5"> and then all stream will pick</font>

1140
00:45:50,849 --> 00:45:55,920
one<font color="#CCCCCC"> of</font><font color="#E5E5E5"> those paths in this case we've</font>

1141
00:45:52,500 --> 00:45:57,329
chosen<font color="#E5E5E5"> the level</font><font color="#CCCCCC"> three path</font><font color="#E5E5E5"> and so all</font>

1142
00:45:55,920 --> 00:45:58,950
stream will see<font color="#E5E5E5"> they'll will see the</font>

1143
00:45:57,329 --> 00:46:00,300
path behind<font color="#E5E5E5"> I'm sorry the customer</font><font color="#CCCCCC"> -</font>

1144
00:45:58,950 --> 00:46:04,410
you'll see the<font color="#CCCCCC"> path behind</font><font color="#E5E5E5"> all stream</font>

1145
00:46:00,300 --> 00:46:10,290
<font color="#E5E5E5">level three</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> 400 they'll also see the</font>

1146
00:46:04,410 --> 00:46:15,319
<font color="#CCCCCC">18 D path then</font><font color="#E5E5E5"> juniper</font><font color="#CCCCCC"> - yes go</font><font color="#E5E5E5"> to the</font>

1147
00:46:10,290 --> 00:46:17,430
mic please<font color="#CCCCCC"> you good</font>

1148
00:46:15,319 --> 00:46:19,770
<font color="#E5E5E5">Brian</font><font color="#CCCCCC"> Johnston</font><font color="#E5E5E5"> from</font><font color="#CCCCCC"> the Tiki world</font>

1149
00:46:17,430 --> 00:46:23,339
networks<font color="#E5E5E5"> I know on Cisco you can turn</font>

1150
00:46:19,770 --> 00:46:24,930
off<font color="#CCCCCC"> bgp a.s</font><font color="#E5E5E5"> path hops as a selection in</font>

1151
00:46:23,339 --> 00:46:26,369
the<font color="#E5E5E5"> algorithm you can turn it off</font><font color="#CCCCCC"> can't</font>

1152
00:46:24,930 --> 00:46:27,930
do<font color="#E5E5E5"> that in juniper do you know so you're</font>

1153
00:46:26,369 --> 00:46:29,609
talking about<font color="#E5E5E5"> the loop prevention</font>

1154
00:46:27,930 --> 00:46:31,828
turning that off<font color="#CCCCCC"> ignoring your own</font>

1155
00:46:29,609 --> 00:46:33,240
Asda's<font color="#E5E5E5"> path it'll still be</font><font color="#CCCCCC"> looper</font>

1156
00:46:31,829 --> 00:46:36,150
<font color="#CCCCCC">eventually</font><font color="#E5E5E5"> just won't use</font><font color="#CCCCCC"> it as a method</font>

1157
00:46:33,240 --> 00:46:37,709
<font color="#CCCCCC">to select</font><font color="#E5E5E5"> the best path so it sees them</font>

1158
00:46:36,150 --> 00:46:39,660
if it sees<font color="#CCCCCC"> the loop there it discards</font>

1159
00:46:37,710 --> 00:46:41,310
<font color="#E5E5E5">but then when it gets to the point</font><font color="#CCCCCC"> of</font>

1160
00:46:39,660 --> 00:46:42,839
selecting what is the best path<font color="#E5E5E5"> it</font>

1161
00:46:41,310 --> 00:46:44,130
doesn't doesn't use it at<font color="#E5E5E5"> all in the</font>

1162
00:46:42,839 --> 00:46:45,810
selector<font color="#CCCCCC"> algorithm</font><font color="#E5E5E5"> just skips over that</font>

1163
00:46:44,130 --> 00:46:47,579
goes the<font color="#E5E5E5"> next step</font><font color="#CCCCCC"> I don't believe you</font>

1164
00:46:45,810 --> 00:46:50,240
<font color="#E5E5E5">can turn that off in juniper not</font>

1165
00:46:47,579 --> 00:46:50,240
familiar with<font color="#CCCCCC"> that</font>

1166
00:46:52,130 --> 00:46:58,280
<font color="#E5E5E5">so juniper</font><font color="#CCCCCC"> will prefer locally</font>

1167
00:46:55,430 --> 00:47:00,710
originated paths<font color="#E5E5E5"> so it prefers strictly</font>

1168
00:46:58,280 --> 00:47:05,000
internal paths<font color="#CCCCCC"> IGP routes static direct</font>

1169
00:47:00,710 --> 00:47:06,590
local<font color="#CCCCCC"> / BGP paths</font><font color="#E5E5E5"> and like I</font><font color="#CCCCCC"> said</font>

1170
00:47:05,000 --> 00:47:08,900
<font color="#E5E5E5">earlier juniper really doesn't</font>

1171
00:47:06,590 --> 00:47:11,780
redistribute locally on the router<font color="#E5E5E5"> from</font>

1172
00:47:08,900 --> 00:47:13,460
other protocols in<font color="#E5E5E5"> WGP it redistributes</font>

1173
00:47:11,780 --> 00:47:15,440
them towards exporting towards other

1174
00:47:13,460 --> 00:47:17,090
neighbors<font color="#E5E5E5"> there's it's possible to do</font>

1175
00:47:15,440 --> 00:47:21,050
<font color="#E5E5E5">using import and export and ribs but</font>

1176
00:47:17,090 --> 00:47:22,640
very uncommon after<font color="#CCCCCC"> that is origin</font><font color="#E5E5E5"> where</font>

1177
00:47:21,050 --> 00:47:25,670
the<font color="#E5E5E5"> lowest origin is preferred and</font>

1178
00:47:22,640 --> 00:47:28,700
there's a lot<font color="#E5E5E5"> of debate</font><font color="#CCCCCC"> about origin the</font>

1179
00:47:25,670 --> 00:47:30,470
way it<font color="#E5E5E5"> used to be used is</font><font color="#CCCCCC"> IGP routes</font>

1180
00:47:28,700 --> 00:47:32,810
redistributed from<font color="#CCCCCC"> IGP were preferred</font>

1181
00:47:30,470 --> 00:47:36,200
then followed by routes redistributed

1182
00:47:32,810 --> 00:47:37,580
from ebgp<font color="#E5E5E5"> which was the ebgp protocol</font>

1183
00:47:36,200 --> 00:47:42,589
this was in the days<font color="#CCCCCC"> where we were</font>

1184
00:47:37,580 --> 00:47:44,540
migrating from<font color="#CCCCCC"> AGP version 2</font><font color="#E5E5E5"> to BGP</font><font color="#CCCCCC"> vs.</font>

1185
00:47:42,590 --> 00:47:46,070
anything else whether it's<font color="#E5E5E5"> incomplete or</font>

1186
00:47:44,540 --> 00:47:46,460
unknown the to vendors call it something

1187
00:47:46,070 --> 00:47:48,380
<font color="#E5E5E5">different</font>

1188
00:47:46,460 --> 00:47:49,790
incomplete<font color="#CCCCCC"> or unknown basically means</font>

1189
00:47:48,380 --> 00:47:50,900
you redistributed it from<font color="#E5E5E5"> something</font>

1190
00:47:49,790 --> 00:47:53,630
where you really<font color="#CCCCCC"> don't</font><font color="#E5E5E5"> know this</font><font color="#CCCCCC"> data</font>

1191
00:47:50,900 --> 00:47:56,510
<font color="#CCCCCC">vote so</font><font color="#E5E5E5"> people some people</font><font color="#CCCCCC"> say you</font>

1192
00:47:53,630 --> 00:47:59,420
<font color="#CCCCCC">should never</font><font color="#E5E5E5"> ever see a GP</font><font color="#CCCCCC"> as a setting</font>

1193
00:47:56,510 --> 00:48:02,570
in origin on<font color="#E5E5E5"> the internet because nobody</font>

1194
00:47:59,420 --> 00:48:04,070
<font color="#E5E5E5">uses EGP anymore other people say well</font>

1195
00:48:02,570 --> 00:48:06,860
in the<font color="#E5E5E5"> spirit of</font><font color="#CCCCCC"> what people were</font>

1196
00:48:04,070 --> 00:48:09,830
meaning<font color="#CCCCCC"> IGP is a dynamic protocol</font><font color="#E5E5E5"> that</font>

1197
00:48:06,860 --> 00:48:12,170
is most trusted<font color="#E5E5E5"> AGP is any other dynamic</font>

1198
00:48:09,830 --> 00:48:14,120
protocol<font color="#CCCCCC"> an incomplete or unknown as any</font>

1199
00:48:12,170 --> 00:48:16,700
non dynamic protocol static links for

1200
00:48:14,120 --> 00:48:19,040
example<font color="#E5E5E5"> directly connected links so some</font>

1201
00:48:16,700 --> 00:48:20,419
people<font color="#E5E5E5"> will</font><font color="#CCCCCC"> use it that way</font><font color="#E5E5E5"> it's also</font>

1202
00:48:19,040 --> 00:48:22,340
important to note that there's there's

1203
00:48:20,420 --> 00:48:24,920
inconsistent default behavior<font color="#E5E5E5"> almost</font>

1204
00:48:22,340 --> 00:48:27,920
<font color="#CCCCCC">when you redistribute</font><font color="#E5E5E5"> on different</font>

1205
00:48:24,920 --> 00:48:29,270
<font color="#E5E5E5">platforms some will set it to</font><font color="#CCCCCC"> IGP and</font>

1206
00:48:27,920 --> 00:48:33,080
some will set it to incomplete<font color="#E5E5E5"> or</font>

1207
00:48:29,270 --> 00:48:35,420
unknown<font color="#CCCCCC"> so because</font><font color="#E5E5E5"> of this inconsistent</font>

1208
00:48:33,080 --> 00:48:37,759
behavior<font color="#E5E5E5"> a lot of transit providers have</font>

1209
00:48:35,420 --> 00:48:39,260
come to the conclusion<font color="#CCCCCC"> that origin is</font>

1210
00:48:37,760 --> 00:48:41,750
<font color="#CCCCCC">not actually used for anything</font>

1211
00:48:39,260 --> 00:48:43,520
and although origin is supposed to<font color="#E5E5E5"> be</font>

1212
00:48:41,750 --> 00:48:46,820
set by<font color="#E5E5E5"> the guy that redistributes the</font>

1213
00:48:43,520 --> 00:48:48,770
<font color="#E5E5E5">route into bgp they feel that they</font><font color="#CCCCCC"> can</font>

1214
00:48:46,820 --> 00:48:50,840
<font color="#E5E5E5">freely stomp on it to influence</font><font color="#CCCCCC"> path</font>

1215
00:48:48,770 --> 00:48:52,730
selection<font color="#CCCCCC"> within their own</font><font color="#E5E5E5"> network so</font>

1216
00:48:50,840 --> 00:48:55,460
some transit providers will actually

1217
00:48:52,730 --> 00:48:57,080
reset origin to make one route less

1218
00:48:55,460 --> 00:48:59,780
preferred<font color="#CCCCCC"> over another</font>

1219
00:48:57,080 --> 00:49:02,500
even though per RFC<font color="#E5E5E5"> they're specifically</font>

1220
00:48:59,780 --> 00:49:02,500
<font color="#E5E5E5">not supposed to do</font>

1221
00:49:02,510 --> 00:49:08,790
<font color="#E5E5E5">men</font><font color="#CCCCCC"> multi exit discriminators</font><font color="#E5E5E5"> so this is</font>

1222
00:49:06,150 --> 00:49:11,250
an entered is<font color="#E5E5E5"> non transitive optional</font>

1223
00:49:08,790 --> 00:49:12,960
attribute so that means you can<font color="#E5E5E5"> send a</font>

1224
00:49:11,250 --> 00:49:15,540
medval you to a neighboring a<font color="#E5E5E5"> s but it</font>

1225
00:49:12,960 --> 00:49:18,090
won't propagate beyond that a s below

1226
00:49:15,540 --> 00:49:19,410
the lowest met is preferred<font color="#E5E5E5"> and met is</font>

1227
00:49:18,090 --> 00:49:21,300
intended to be<font color="#CCCCCC"> used when there</font><font color="#E5E5E5"> are</font>

1228
00:49:19,410 --> 00:49:22,859
multiple exits to a given<font color="#CCCCCC"> destination</font><font color="#E5E5E5"> so</font>

1229
00:49:21,300 --> 00:49:24,690
<font color="#E5E5E5">that way the</font><font color="#CCCCCC"> downstream network can</font>

1230
00:49:22,860 --> 00:49:27,080
<font color="#CCCCCC">indicate which entrance points are</font>

1231
00:49:24,690 --> 00:49:29,190
better than which other entrance points

1232
00:49:27,080 --> 00:49:30,630
<font color="#CCCCCC">one way that</font><font color="#E5E5E5"> you can do this is you can</font>

1233
00:49:29,190 --> 00:49:32,460
<font color="#E5E5E5">send an arbitrary value if you want a</font>

1234
00:49:30,630 --> 00:49:34,980
primary backup<font color="#E5E5E5"> configuration you can say</font>

1235
00:49:32,460 --> 00:49:37,650
met on the primary<font color="#E5E5E5"> is</font><font color="#CCCCCC"> 10 met on the</font>

1236
00:49:34,980 --> 00:49:39,930
backup<font color="#CCCCCC"> is 20 and you</font><font color="#E5E5E5"> can always force</font>

1237
00:49:37,650 --> 00:49:41,280
traffic to use the primary<font color="#E5E5E5"> another way</font>

1238
00:49:39,930 --> 00:49:44,040
<font color="#CCCCCC">that this can</font><font color="#E5E5E5"> be used is you can use</font>

1239
00:49:41,280 --> 00:49:45,930
<font color="#E5E5E5">your internal</font><font color="#CCCCCC"> IGP metrics and set your</font>

1240
00:49:44,040 --> 00:49:49,470
internal<font color="#CCCCCC"> IGP metrics to the med value</font>

1241
00:49:45,930 --> 00:49:52,919
towards<font color="#E5E5E5"> ebgp</font><font color="#CCCCCC"> I have some slides on this</font>

1242
00:49:49,470 --> 00:49:55,980
later med values are only<font color="#E5E5E5"> compared when</font>

1243
00:49:52,920 --> 00:49:58,170
the<font color="#E5E5E5"> neighboring is is the same this</font><font color="#CCCCCC"> is</font>

1244
00:49:55,980 --> 00:50:00,350
because it could<font color="#E5E5E5"> be a function of the</font>

1245
00:49:58,170 --> 00:50:02,580
IGP metric and<font color="#CCCCCC"> IGP metrics</font>

1246
00:50:00,350 --> 00:50:04,620
<font color="#E5E5E5">coast-to-coast on one network might be</font>

1247
00:50:02,580 --> 00:50:06,360
tens of thousands and might<font color="#CCCCCC"> be you know</font>

1248
00:50:04,620 --> 00:50:08,190
<font color="#CCCCCC">thirty five on another network so</font>

1249
00:50:06,360 --> 00:50:10,680
because these aren't really<font color="#CCCCCC"> comparable</font>

1250
00:50:08,190 --> 00:50:12,450
values<font color="#E5E5E5"> you generally only compare meds</font>

1251
00:50:10,680 --> 00:50:15,180
between the same autonomous system

1252
00:50:12,450 --> 00:50:20,520
number and if<font color="#E5E5E5"> a</font><font color="#CCCCCC"> met is not set it it</font>

1253
00:50:15,180 --> 00:50:22,350
seems a value of zero<font color="#CCCCCC"> the default value</font>

1254
00:50:20,520 --> 00:50:25,020
of<font color="#CCCCCC"> zero with med not being set turns out</font>

1255
00:50:22,350 --> 00:50:26,640
to be not so helpful<font color="#CCCCCC"> because if you want</font>

1256
00:50:25,020 --> 00:50:28,440
<font color="#E5E5E5">to start deep referencing lengths you</font>

1257
00:50:26,640 --> 00:50:30,629
have to go and then preference<font color="#E5E5E5"> up all</font>

1258
00:50:28,440 --> 00:50:32,970
the other<font color="#E5E5E5"> links so there has been</font><font color="#CCCCCC"> some</font>

1259
00:50:30,630 --> 00:50:35,610
<font color="#CCCCCC">debate</font><font color="#E5E5E5"> in the past about changing the</font>

1260
00:50:32,970 --> 00:50:37,919
default med value to infinity or the

1261
00:50:35,610 --> 00:50:40,500
<font color="#CCCCCC">largest possible value or one less than</font>

1262
00:50:37,920 --> 00:50:42,090
<font color="#CCCCCC">the</font><font color="#E5E5E5"> largest possible value so some</font>

1263
00:50:40,500 --> 00:50:45,000
implementations may treat<font color="#E5E5E5"> a different</font>

1264
00:50:42,090 --> 00:50:48,540
med differently<font color="#E5E5E5"> so do check</font><font color="#CCCCCC"> that if you</font>

1265
00:50:45,000 --> 00:50:50,160
plan on using<font color="#E5E5E5"> default med values there</font>

1266
00:50:48,540 --> 00:50:52,680
are<font color="#E5E5E5"> some options with men there's always</font>

1267
00:50:50,160 --> 00:50:56,129
<font color="#CCCCCC">compare med</font><font color="#E5E5E5"> in this case you will make a</font>

1268
00:50:52,680 --> 00:50:57,890
med comparison between two<font color="#E5E5E5"> routes even</font>

1269
00:50:56,130 --> 00:51:00,840
<font color="#CCCCCC">if the neighboring</font><font color="#E5E5E5"> s is different</font>

1270
00:50:57,890 --> 00:51:04,410
there's also<font color="#E5E5E5"> Cisco non-deterministic med</font>

1271
00:51:00,840 --> 00:51:06,600
so<font color="#E5E5E5"> Cisco does this pairwise route</font>

1272
00:51:04,410 --> 00:51:08,460
<font color="#CCCCCC">selection so it takes the</font><font color="#E5E5E5"> first route</font>

1273
00:51:06,600 --> 00:51:09,720
and makes it best<font color="#E5E5E5"> and then it takes the</font>

1274
00:51:08,460 --> 00:51:11,280
second route and compares that to<font color="#CCCCCC"> the</font>

1275
00:51:09,720 --> 00:51:13,230
<font color="#E5E5E5">first route</font><font color="#CCCCCC"> and if the second route is</font>

1276
00:51:11,280 --> 00:51:14,490
better that becomes the new best and

1277
00:51:13,230 --> 00:51:15,750
then if there's a third route<font color="#CCCCCC"> ik</font>

1278
00:51:14,490 --> 00:51:17,189
<font color="#CCCCCC">there's the third</font><font color="#E5E5E5"> route to the second</font>

1279
00:51:15,750 --> 00:51:20,220
route and if the third route is better

1280
00:51:17,190 --> 00:51:21,570
that becomes the new<font color="#E5E5E5"> best you can get</font>

1281
00:51:20,220 --> 00:51:23,069
into a<font color="#CCCCCC"> scenario where you have three</font>

1282
00:51:21,570 --> 00:51:24,480
<font color="#E5E5E5">routes where the first route is better</font>

1283
00:51:23,070 --> 00:51:26,010
than the second route the second round

1284
00:51:24,480 --> 00:51:27,210
is better than the third route<font color="#E5E5E5"> and the</font>

1285
00:51:26,010 --> 00:51:29,100
third route is better than the<font color="#E5E5E5"> first</font>

1286
00:51:27,210 --> 00:51:30,810
route<font color="#CCCCCC"> and depending upon the order in</font>

1287
00:51:29,100 --> 00:51:32,940
which<font color="#E5E5E5"> you've learned them you might</font>

1288
00:51:30,810 --> 00:51:35,369
choose a different<font color="#CCCCCC"> best path with the</font>

1289
00:51:32,940 --> 00:51:37,350
Cisco<font color="#E5E5E5"> non-deterministic behavior</font>

1290
00:51:35,369 --> 00:51:39,210
juniper compares all the routes together

1291
00:51:37,350 --> 00:51:41,368
<font color="#E5E5E5">so it will always make the same decision</font>

1292
00:51:39,210 --> 00:51:43,020
but if you wanted to<font color="#CCCCCC"> have the same Cisco</font>

1293
00:51:41,369 --> 00:51:46,650
behavior on a<font color="#CCCCCC"> Juniper there's a knob to</font>

1294
00:51:43,020 --> 00:51:48,570
<font color="#E5E5E5">turn on Cisco non-deterministic bed I'm</font>

1295
00:51:46,650 --> 00:51:50,280
also going to diagram<font color="#E5E5E5"> this later on when</font>

1296
00:51:48,570 --> 00:51:51,720
I talk about<font color="#E5E5E5"> metal ation you get the</font>

1297
00:51:50,280 --> 00:51:53,970
exact<font color="#E5E5E5"> same behavior when you have a</font>

1298
00:51:51,720 --> 00:51:56,240
hierarchical bgp network but in that

1299
00:51:53,970 --> 00:51:58,410
case it's persistent<font color="#E5E5E5"> and it's really bad</font>

1300
00:51:56,240 --> 00:52:01,618
<font color="#CCCCCC">have some slides at</font><font color="#E5E5E5"> the very end of the</font>

1301
00:51:58,410 --> 00:52:04,049
second section<font color="#E5E5E5"> on</font><font color="#CCCCCC"> that so the</font><font color="#E5E5E5"> next thing</font>

1302
00:52:01,619 --> 00:52:06,540
is<font color="#E5E5E5"> prefer</font><font color="#CCCCCC"> a BGP mind pass</font><font color="#E5E5E5"> over ibgp</font>

1303
00:52:04,050 --> 00:52:08,310
learning paths so here the idea<font color="#CCCCCC"> is</font><font color="#E5E5E5"> if</font>

1304
00:52:06,540 --> 00:52:09,450
you're<font color="#E5E5E5"> learning the route from ebgp and</font>

1305
00:52:08,310 --> 00:52:12,240
you're also<font color="#E5E5E5"> learning it from your own</font>

1306
00:52:09,450 --> 00:52:14,730
network via<font color="#CCCCCC"> ibgp and both routes are</font>

1307
00:52:12,240 --> 00:52:17,368
equally<font color="#E5E5E5"> as good prefer the ebgp one</font>

1308
00:52:14,730 --> 00:52:19,590
because<font color="#E5E5E5"> that will cause you to send a</font>

1309
00:52:17,369 --> 00:52:22,230
route update to the<font color="#CCCCCC"> I BGP so that way</font>

1310
00:52:19,590 --> 00:52:27,060
the<font color="#E5E5E5"> network gets to see more possible</font>

1311
00:52:22,230 --> 00:52:29,220
paths after<font color="#E5E5E5"> that its lowest</font><font color="#CCCCCC"> AGP distance</font>

1312
00:52:27,060 --> 00:52:31,049
<font color="#E5E5E5">so look at the protocol next</font><font color="#CCCCCC"> hop and</font>

1313
00:52:29,220 --> 00:52:32,580
calculate the IGP distance to<font color="#E5E5E5"> that</font>

1314
00:52:31,050 --> 00:52:35,369
protocol<font color="#E5E5E5"> next hop whichever one is</font>

1315
00:52:32,580 --> 00:52:37,049
shorter<font color="#E5E5E5"> that's the one you</font><font color="#CCCCCC"> prefer in the</font>

1316
00:52:35,369 --> 00:52:40,560
event<font color="#CCCCCC"> that</font><font color="#E5E5E5"> your next hop</font><font color="#CCCCCC"> is not in your</font>

1317
00:52:37,050 --> 00:52:42,210
<font color="#CCCCCC">IGP</font><font color="#E5E5E5"> say it's</font><font color="#CCCCCC"> BGP then you do a route</font>

1318
00:52:40,560 --> 00:52:43,740
regression so you look at<font color="#E5E5E5"> that next</font><font color="#CCCCCC"> hop</font>

1319
00:52:42,210 --> 00:52:45,119
you pick the BGP<font color="#E5E5E5"> route to get to</font><font color="#CCCCCC"> that</font>

1320
00:52:43,740 --> 00:52:47,279
next<font color="#E5E5E5"> hop you figure</font><font color="#CCCCCC"> out what the BGP</font>

1321
00:52:45,119 --> 00:52:50,400
<font color="#E5E5E5">route of that next hop</font><font color="#CCCCCC"> is if</font><font color="#E5E5E5"> that's in</font>

1322
00:52:47,280 --> 00:52:52,790
your<font color="#CCCCCC"> IGP take the cost to that in terms</font>

1323
00:52:50,400 --> 00:52:55,260
<font color="#E5E5E5">of static and directly connected routes</font>

1324
00:52:52,790 --> 00:52:58,109
<font color="#E5E5E5">some vendors treat them differently some</font>

1325
00:52:55,260 --> 00:53:00,570
will give them an IG<font color="#CCCCCC"> P cost of 0 others</font>

1326
00:52:58,109 --> 00:53:02,759
will<font color="#E5E5E5"> have</font><font color="#CCCCCC"> their be a null value</font><font color="#E5E5E5"> for IG p</font>

1327
00:53:00,570 --> 00:53:06,359
and make no comparison so there are<font color="#E5E5E5"> some</font>

1328
00:53:02,760 --> 00:53:07,859
differences<font color="#CCCCCC"> here between vendors at this</font>

1329
00:53:06,359 --> 00:53:09,240
point you're getting<font color="#E5E5E5"> to</font><font color="#CCCCCC"> be fairly</font>

1330
00:53:07,859 --> 00:53:11,100
arbitrary in terms of what you're

1331
00:53:09,240 --> 00:53:12,359
picking to be the best path but<font color="#E5E5E5"> you want</font>

1332
00:53:11,100 --> 00:53:16,500
<font color="#E5E5E5">it to have an algorithm</font><font color="#CCCCCC"> that always</font>

1333
00:53:12,359 --> 00:53:17,819
comes out to terminus<font color="#CCCCCC"> t'k so you need to</font>

1334
00:53:16,500 --> 00:53:20,820
have a path selection algorithm to

1335
00:53:17,820 --> 00:53:22,710
actually<font color="#CCCCCC"> pick a best path</font><font color="#E5E5E5"> so again these</font>

1336
00:53:20,820 --> 00:53:24,450
things<font color="#E5E5E5"> kind of get arbitrary but the</font>

1337
00:53:22,710 --> 00:53:27,090
next one on juniper<font color="#E5E5E5"> is shortest route</font>

1338
00:53:24,450 --> 00:53:28,319
reflection cluster<font color="#CCCCCC"> lists</font><font color="#E5E5E5"> so prefer if</font>

1339
00:53:27,090 --> 00:53:29,670
two routes are equally good and one

1340
00:53:28,320 --> 00:53:30,960
<font color="#E5E5E5">a shorter cluster list than the other</font>

1341
00:53:29,670 --> 00:53:33,120
take the one<font color="#CCCCCC"> with the shorter cluster</font>

1342
00:53:30,960 --> 00:53:36,150
list<font color="#E5E5E5"> I'll talk more about clusters in</font>

1343
00:53:33,120 --> 00:53:39,000
the second half for<font color="#CCCCCC"> ebgp learned routes</font>

1344
00:53:36,150 --> 00:53:41,120
prefer the older route<font color="#E5E5E5"> so basically what</font>

1345
00:53:39,000 --> 00:53:44,820
<font color="#E5E5E5">this</font><font color="#CCCCCC"> means is if you're learning</font><font color="#E5E5E5"> two</font>

1346
00:53:41,120 --> 00:53:46,500
paths<font color="#E5E5E5"> via a BGP and one flaps and the</font>

1347
00:53:44,820 --> 00:53:50,700
other one is stable<font color="#CCCCCC"> just</font><font color="#E5E5E5"> stick with the</font>

1348
00:53:46,500 --> 00:53:52,280
stable one<font color="#CCCCCC"> so some people</font><font color="#E5E5E5"> think this</font><font color="#CCCCCC"> is</font>

1349
00:53:50,700 --> 00:53:54,990
good<font color="#E5E5E5"> because it reduces unnecessary</font>

1350
00:53:52,280 --> 00:53:56,940
churn<font color="#E5E5E5"> some people think this</font><font color="#CCCCCC"> is bad</font>

1351
00:53:54,990 --> 00:53:58,229
<font color="#E5E5E5">because it's non-deterministic</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> the</font>

1352
00:53:56,940 --> 00:54:00,900
problem with it<font color="#E5E5E5"> being non-deterministic</font>

1353
00:53:58,230 --> 00:54:02,520
is you might<font color="#E5E5E5"> have a long persisting</font>

1354
00:54:00,900 --> 00:54:04,140
session with a provider where you learn

1355
00:54:02,520 --> 00:54:06,180
a lot<font color="#E5E5E5"> of routes from could be a peering</font>

1356
00:54:04,140 --> 00:54:08,040
session where you<font color="#E5E5E5"> learn you know half of</font>

1357
00:54:06,180 --> 00:54:09,270
the<font color="#E5E5E5"> internet from it and you have</font>

1358
00:54:08,040 --> 00:54:10,590
another peering session with another

1359
00:54:09,270 --> 00:54:12,030
<font color="#E5E5E5">provider where you learn</font><font color="#CCCCCC"> the same half</font>

1360
00:54:10,590 --> 00:54:14,190
of the<font color="#CCCCCC"> Internet</font><font color="#E5E5E5"> but it's not preferred</font>

1361
00:54:12,030 --> 00:54:17,310
because that<font color="#E5E5E5"> session has been unstable</font>

1362
00:54:14,190 --> 00:54:19,530
<font color="#CCCCCC">in the recent</font><font color="#E5E5E5"> past and then you get a</font>

1363
00:54:17,310 --> 00:54:20,759
<font color="#E5E5E5">flap on</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> stable link you do some</font>

1364
00:54:19,530 --> 00:54:23,340
<font color="#E5E5E5">maintenance you take a router down a</font>

1365
00:54:20,760 --> 00:54:24,810
link goes down for some reason<font color="#CCCCCC"> all of a</font>

1366
00:54:23,340 --> 00:54:26,820
<font color="#CCCCCC">sudden all that traffic</font><font color="#E5E5E5"> is going to</font>

1367
00:54:24,810 --> 00:54:28,410
<font color="#E5E5E5">shift over to the other</font><font color="#CCCCCC"> peer you might</font>

1368
00:54:26,820 --> 00:54:29,520
not have had<font color="#CCCCCC"> enough bandwidth to</font><font color="#E5E5E5"> deal</font>

1369
00:54:28,410 --> 00:54:32,399
with that<font color="#CCCCCC"> because you weren't</font><font color="#E5E5E5"> prepared</font>

1370
00:54:29,520 --> 00:54:33,870
<font color="#CCCCCC">for that to happen so if you don't want</font>

1371
00:54:32,400 --> 00:54:37,950
to use the oldest you can override it

1372
00:54:33,870 --> 00:54:41,100
<font color="#E5E5E5">with always compare router ID then you</font>

1373
00:54:37,950 --> 00:54:43,950
get to lowest router ID so if<font color="#CCCCCC"> your ebgp</font>

1374
00:54:41,100 --> 00:54:45,810
peering with<font color="#E5E5E5"> two neighbors each of them</font>

1375
00:54:43,950 --> 00:54:48,089
has a globally unique<font color="#CCCCCC"> router ID</font><font color="#E5E5E5"> which</font>

1376
00:54:45,810 --> 00:54:48,480
everyone has a lower IP address you pick

1377
00:54:48,090 --> 00:54:51,630
that one

1378
00:54:48,480 --> 00:54:54,240
so 4.4.4 dot<font color="#CCCCCC"> four is a lower number than</font>

1379
00:54:51,630 --> 00:54:57,270
<font color="#E5E5E5">eight dot one dot one dot one so</font><font color="#CCCCCC"> for</font>

1380
00:54:54,240 --> 00:54:59,729
<font color="#E5E5E5">that 4.4.4 would be better and then</font>

1381
00:54:57,270 --> 00:55:01,410
Cisco does shortest route reflection

1382
00:54:59,730 --> 00:55:03,990
cluster<font color="#CCCCCC"> lists</font><font color="#E5E5E5"> same as juniper they just</font>

1383
00:55:01,410 --> 00:55:05,640
do<font color="#E5E5E5"> it in a different</font><font color="#CCCCCC"> place and</font><font color="#E5E5E5"> then the</font>

1384
00:55:03,990 --> 00:55:07,200
final<font color="#CCCCCC"> thing is the lowest neighbor</font>

1385
00:55:05,640 --> 00:55:09,180
address<font color="#E5E5E5"> so in the</font><font color="#CCCCCC"> event that</font><font color="#E5E5E5"> you have</font>

1386
00:55:07,200 --> 00:55:12,810
multiple<font color="#CCCCCC"> bgp sessions to the same router</font>

1387
00:55:09,180 --> 00:55:14,549
that router has one router ID<font color="#E5E5E5"> so the</font>

1388
00:55:12,810 --> 00:55:16,140
router ID from both of those updates<font color="#E5E5E5"> is</font>

1389
00:55:14,550 --> 00:55:18,000
going to be the same so<font color="#E5E5E5"> you have to</font>

1390
00:55:16,140 --> 00:55:21,500
<font color="#CCCCCC">brake on something even lower</font><font color="#E5E5E5"> in this</font>

1391
00:55:18,000 --> 00:55:21,500
<font color="#E5E5E5">case</font><font color="#CCCCCC"> it's the lowest</font><font color="#E5E5E5"> neighbor address</font>

1392
00:55:22,270 --> 00:55:27,880
there are a couple other attributes<font color="#E5E5E5"> that</font>

1393
00:55:24,340 --> 00:55:30,250
I want to talk<font color="#E5E5E5"> about briefly</font><font color="#CCCCCC"> bgp</font>

1394
00:55:27,880 --> 00:55:33,970
communities is the ability<font color="#E5E5E5"> to put one or</font>

1395
00:55:30,250 --> 00:55:35,410
<font color="#E5E5E5">more labels on a route communities are</font>

1396
00:55:33,970 --> 00:55:39,250
transitive and optional and<font color="#E5E5E5"> they're</font>

1397
00:55:35,410 --> 00:55:41,649
<font color="#E5E5E5">defined in RFC 1997 it's a 32 bit number</font>

1398
00:55:39,250 --> 00:55:45,370
usually represented represented as a

1399
00:55:41,650 --> 00:55:46,810
<font color="#CCCCCC">16-bit number : 16-bit number</font><font color="#E5E5E5"> typically</font>

1400
00:55:45,370 --> 00:55:48,460
the<font color="#CCCCCC"> first grouping of numbers is the</font>

1401
00:55:46,810 --> 00:55:50,440
autonomous system number and the second

1402
00:55:48,460 --> 00:55:54,010
grouping of numbers is an action value

1403
00:55:50,440 --> 00:55:56,050
for example 701 : 80<font color="#E5E5E5"> indicates that a s</font>

1404
00:55:54,010 --> 00:55:58,840
701 should set a local proof of<font color="#CCCCCC"> 80 when</font>

1405
00:55:56,050 --> 00:56:02,050
it learns<font color="#E5E5E5"> this route</font><font color="#CCCCCC"> from a customer 701</font>

1406
00:55:58,840 --> 00:56:03,790
<font color="#CCCCCC">8</font><font color="#E5E5E5"> : 80 indicates that a s 701 8 should</font>

1407
00:56:02,050 --> 00:56:06,160
set a local preference of 80 on this

1408
00:56:03,790 --> 00:56:09,370
route when learned from<font color="#E5E5E5"> a customer it</font>

1409
00:56:06,160 --> 00:56:13,210
just so happens that<font color="#E5E5E5"> you unit and AT&T</font>

1410
00:56:09,370 --> 00:56:16,060
used the same :<font color="#CCCCCC"> 80</font><font color="#E5E5E5"> community that's not</font>

1411
00:56:13,210 --> 00:56:17,890
<font color="#CCCCCC">a</font><font color="#E5E5E5"> standard across transit providers some</font>

1412
00:56:16,060 --> 00:56:19,360
use different<font color="#E5E5E5"> values so you'll have to</font>

1413
00:56:17,890 --> 00:56:22,480
figure<font color="#E5E5E5"> out what values are supported by</font>

1414
00:56:19,360 --> 00:56:24,670
each of your<font color="#E5E5E5"> transit providers generally</font>

1415
00:56:22,480 --> 00:56:26,620
<font color="#CCCCCC">BGP communities are used to classify a</font>

1416
00:56:24,670 --> 00:56:29,500
type of<font color="#E5E5E5"> Route and then write policy to</font>

1417
00:56:26,620 --> 00:56:31,839
manipulate that type of<font color="#E5E5E5"> route</font><font color="#CCCCCC"> it's</font>

1418
00:56:29,500 --> 00:56:33,220
<font color="#E5E5E5">useful for information purposes such as</font>

1419
00:56:31,840 --> 00:56:35,110
<font color="#E5E5E5">determining the</font><font color="#CCCCCC"> location of where</font><font color="#E5E5E5"> a</font>

1420
00:56:33,220 --> 00:56:37,029
route was learned<font color="#E5E5E5"> or tagging a</font>

1421
00:56:35,110 --> 00:56:39,130
particular type of<font color="#CCCCCC"> route</font><font color="#E5E5E5"> say I learned</font>

1422
00:56:37,030 --> 00:56:44,050
<font color="#E5E5E5">it from a peer don't advertise it</font><font color="#CCCCCC"> to</font>

1423
00:56:39,130 --> 00:56:46,930
other peers extended<font color="#CCCCCC"> BGP communities</font><font color="#E5E5E5"> so</font>

1424
00:56:44,050 --> 00:56:50,290
RFC 4360 extended the<font color="#E5E5E5"> BGP</font><font color="#CCCCCC"> community's</font>

1425
00:56:46,930 --> 00:56:52,390
<font color="#CCCCCC">base to a 64-bit</font><font color="#E5E5E5"> number the first</font><font color="#CCCCCC"> 8 bits</font>

1426
00:56:50,290 --> 00:56:55,060
<font color="#CCCCCC">indicate</font><font color="#E5E5E5"> the type whether it's a regular</font>

1427
00:56:52,390 --> 00:56:56,529
<font color="#CCCCCC">or extended community</font><font color="#E5E5E5"> and it can also</font>

1428
00:56:55,060 --> 00:56:57,910
indicate<font color="#E5E5E5"> whether the community is</font>

1429
00:56:56,530 --> 00:57:00,430
intended to be transitive or non

1430
00:56:57,910 --> 00:57:02,379
transitive<font color="#E5E5E5"> and then for the extended</font>

1431
00:57:00,430 --> 00:57:05,230
communities the second<font color="#CCCCCC"> 8 bits</font>

1432
00:57:02,380 --> 00:57:08,950
indicate<font color="#E5E5E5"> the subtype</font><font color="#CCCCCC"> it could be a</font>

1433
00:57:05,230 --> 00:57:11,230
16-bit<font color="#CCCCCC"> ASN with a 32-bit target value it</font>

1434
00:57:08,950 --> 00:57:13,870
could be a 32-bit<font color="#CCCCCC"> ASN with a</font><font color="#E5E5E5"> 16-bit</font>

1435
00:57:11,230 --> 00:57:17,170
target value and this<font color="#E5E5E5"> is useful to</font>

1436
00:57:13,870 --> 00:57:20,950
encode 32-bit<font color="#CCCCCC"> a SMS</font><font color="#E5E5E5"> so if you wanted to</font>

1437
00:57:17,170 --> 00:57:24,250
encode you know<font color="#E5E5E5"> 1.1 is your</font><font color="#CCCCCC"> a SN : some</font>

1438
00:57:20,950 --> 00:57:26,919
action :<font color="#E5E5E5"> 80 you could do that</font><font color="#CCCCCC"> it's also</font>

1439
00:57:24,250 --> 00:57:28,060
useful<font color="#E5E5E5"> to extend the action space to</font>

1440
00:57:26,920 --> 00:57:30,400
have more numbers<font color="#CCCCCC"> in it so you can</font>

1441
00:57:28,060 --> 00:57:32,170
<font color="#CCCCCC">designate more things</font><font color="#E5E5E5"> people tend to</font>

1442
00:57:30,400 --> 00:57:35,050
<font color="#E5E5E5">like to</font><font color="#CCCCCC"> use</font><font color="#E5E5E5"> groupings of numbers to mean</font>

1443
00:57:32,170 --> 00:57:35,830
something like the<font color="#E5E5E5"> 1000 is used for</font>

1444
00:57:35,050 --> 00:57:37,480
<font color="#E5E5E5">nationals</font>

1445
00:57:35,830 --> 00:57:41,080
than the<font color="#CCCCCC"> 3000 range is used for</font>

1446
00:57:37,480 --> 00:57:43,600
customers<font color="#CCCCCC"> and then finally it's also</font>

1447
00:57:41,080 --> 00:57:46,540
also<font color="#E5E5E5"> useful for VPNs to signaling route</font>

1448
00:57:43,600 --> 00:57:48,430
targets<font color="#E5E5E5"> so the way this works is you</font>

1449
00:57:46,540 --> 00:57:50,500
might<font color="#CCCCCC"> have the</font><font color="#E5E5E5"> same route show up in two</font>

1450
00:57:48,430 --> 00:57:52,149
different VPNs<font color="#E5E5E5"> Toyota might have a VPN</font>

1451
00:57:50,500 --> 00:57:54,520
and Ford might have a VPN and<font color="#E5E5E5"> they both</font>

1452
00:57:52,150 --> 00:57:56,380
might be using the same<font color="#CCCCCC"> 10 space so</font><font color="#E5E5E5"> to</font>

1453
00:57:54,520 --> 00:58:00,220
distinguish between whether it's you

1454
00:57:56,380 --> 00:58:02,650
know 10/8 in the<font color="#CCCCCC"> Toyota network or 10/8</font>

1455
00:58:00,220 --> 00:58:05,140
in the<font color="#E5E5E5"> Ford</font><font color="#CCCCCC"> Network</font><font color="#E5E5E5"> you basically use a</font>

1456
00:58:02,650 --> 00:58:08,310
<font color="#E5E5E5">route target identifier to say which</font>

1457
00:58:05,140 --> 00:58:11,589
virtual routing interface it belongs to

1458
00:58:08,310 --> 00:58:14,230
there's a few<font color="#CCCCCC"> well-known</font><font color="#E5E5E5"> communities no</font>

1459
00:58:11,590 --> 00:58:16,120
export<font color="#E5E5E5"> which means don't advertise it</font>

1460
00:58:14,230 --> 00:58:18,760
outside the<font color="#CCCCCC"> local is</font><font color="#E5E5E5"> you can set no</font>

1461
00:58:16,120 --> 00:58:20,319
export<font color="#E5E5E5"> on a route send it to ebgp the</font>

1462
00:58:18,760 --> 00:58:21,430
upstream<font color="#E5E5E5"> a/s will learn it but then they</font>

1463
00:58:20,320 --> 00:58:24,370
won't<font color="#E5E5E5"> send it to the rest</font><font color="#CCCCCC"> of the</font>

1464
00:58:21,430 --> 00:58:26,440
<font color="#E5E5E5">Internet no</font><font color="#CCCCCC"> advertise you can set</font><font color="#E5E5E5"> that</font>

1465
00:58:24,370 --> 00:58:28,779
<font color="#CCCCCC">on a on a route send it to your upstream</font>

1466
00:58:26,440 --> 00:58:30,040
a<font color="#E5E5E5"> BGP neighbor that router will learn it</font>

1467
00:58:28,780 --> 00:58:34,060
<font color="#E5E5E5">but it won't advertise it to any other</font>

1468
00:58:30,040 --> 00:58:36,130
routers not even the<font color="#CCCCCC"> I BGP no export</font><font color="#E5E5E5"> sub</font>

1469
00:58:34,060 --> 00:58:37,900
<font color="#CCCCCC">Confed you can</font><font color="#E5E5E5"> advertise that into a</font>

1470
00:58:36,130 --> 00:58:39,940
router and<font color="#E5E5E5"> he will keep it local to his</font>

1471
00:58:37,900 --> 00:58:41,590
sub<font color="#E5E5E5"> Confederation I'll talk more about</font>

1472
00:58:39,940 --> 00:58:45,550
what sub<font color="#E5E5E5"> can fins are in the second half</font>

1473
00:58:41,590 --> 00:58:47,830
<font color="#CCCCCC">and no</font><font color="#E5E5E5"> peer which indicates do you</font>

1474
00:58:45,550 --> 00:58:49,690
advertise this out to other customers

1475
00:58:47,830 --> 00:58:54,580
<font color="#CCCCCC">but don't send it to settlement</font><font color="#E5E5E5"> free</font>

1476
00:58:49,690 --> 00:58:56,590
peers some of the common transit

1477
00:58:54,580 --> 00:58:58,240
provider communities often transit

1478
00:58:56,590 --> 00:59:00,460
providers will offer a community to set

1479
00:58:58,240 --> 00:59:02,049
<font color="#E5E5E5">local preference they'll offer a</font>

1480
00:59:00,460 --> 00:59:05,020
community to prepend<font color="#CCCCCC"> the transit</font>

1481
00:59:02,050 --> 00:59:07,120
providers a s towards peers<font color="#CCCCCC"> the lab</font>

1482
00:59:05,020 --> 00:59:09,100
retire out containment communities for

1483
00:59:07,120 --> 00:59:10,540
<font color="#E5E5E5">example don't link it to peers don't</font>

1484
00:59:09,100 --> 00:59:12,759
<font color="#E5E5E5">leak it out of the continent</font><font color="#CCCCCC"> don't</font><font color="#E5E5E5"> leak</font>

1485
00:59:10,540 --> 00:59:15,790
<font color="#E5E5E5">it out of the country</font><font color="#CCCCCC"> don't leak it out</font>

1486
00:59:12,760 --> 00:59:17,950
<font color="#E5E5E5">of a particular region</font><font color="#CCCCCC"> don't</font><font color="#E5E5E5"> make it out</font>

1487
00:59:15,790 --> 00:59:19,690
<font color="#CCCCCC">of a particular</font><font color="#E5E5E5"> state some providers</font>

1488
00:59:17,950 --> 00:59:21,339
<font color="#E5E5E5">will offer this behavior targeted to a</font>

1489
00:59:19,690 --> 00:59:24,790
<font color="#CCCCCC">short list of autonomous systems for</font>

1490
00:59:21,340 --> 00:59:27,760
example<font color="#CCCCCC"> you might say don't</font><font color="#E5E5E5"> send it to</font>

1491
00:59:24,790 --> 00:59:30,630
peers of<font color="#E5E5E5"> Sprint or prepend twice to</font>

1492
00:59:27,760 --> 00:59:30,630
<font color="#E5E5E5">peers of</font><font color="#CCCCCC"> you unit</font>

1493
00:59:31,440 --> 00:59:35,970
community stripping<font color="#E5E5E5"> so there's some</font>

1494
00:59:33,960 --> 00:59:38,430
default behavior differences on the

1495
00:59:35,970 --> 00:59:40,950
different router vendors<font color="#CCCCCC"> by default</font>

1496
00:59:38,430 --> 00:59:42,569
<font color="#E5E5E5">juniper will send all communities so if</font>

1497
00:59:40,950 --> 00:59:43,828
you don't want a Juniper router to send

1498
00:59:42,569 --> 00:59:45,329
all the communities on the<font color="#E5E5E5"> route you</font>

1499
00:59:43,829 --> 00:59:47,940
actually have to write policy to strip

1500
00:59:45,329 --> 00:59:49,829
those communities off<font color="#E5E5E5"> in the case of</font>

1501
00:59:47,940 --> 00:59:51,930
<font color="#E5E5E5">Cisco it doesn't send any communities by</font>

1502
00:59:49,829 --> 00:59:53,549
default<font color="#E5E5E5"> if you want to Cisco router to</font>

1503
00:59:51,930 --> 00:59:55,950
send communities you<font color="#CCCCCC"> have to</font><font color="#E5E5E5"> issue the</font>

1504
00:59:53,549 --> 00:59:58,020
<font color="#E5E5E5">send community config bit to get it to</font>

1505
00:59:55,950 --> 01:00:00,359
<font color="#E5E5E5">start doing that and generally on the</font>

1506
00:59:58,020 --> 01:00:01,500
<font color="#E5E5E5">internet when people</font><font color="#CCCCCC"> peer</font><font color="#E5E5E5"> they don't</font>

1507
01:00:00,359 --> 01:00:03,779
want their peers to do traffic

1508
01:00:01,500 --> 01:00:05,130
<font color="#E5E5E5">engineering on their local network so</font>

1509
01:00:03,780 --> 01:00:07,829
they'll generally flatten all of the

1510
01:00:05,130 --> 01:00:09,240
meds<font color="#E5E5E5"> and strip all of</font><font color="#CCCCCC"> the communities so</font>

1511
01:00:07,829 --> 01:00:11,849
you can assume<font color="#CCCCCC"> that if you're putting</font><font color="#E5E5E5"> a</font>

1512
01:00:09,240 --> 01:00:13,200
community on a route<font color="#E5E5E5"> as it goes upstream</font>

1513
01:00:11,849 --> 01:00:15,240
through transit providers it will

1514
01:00:13,200 --> 01:00:21,149
<font color="#CCCCCC">probably stay there</font><font color="#E5E5E5"> once it goes to</font>

1515
01:00:15,240 --> 01:00:23,939
<font color="#E5E5E5">appear it's probably gone aggregator is</font>

1516
01:00:21,150 --> 01:00:25,589
an optional transitive attribute<font color="#CCCCCC"> it's</font>

1517
01:00:23,940 --> 01:00:27,240
used when a router<font color="#E5E5E5"> receives one or more</font>

1518
01:00:25,589 --> 01:00:29,880
routes that it<font color="#E5E5E5"> aggregates into a super</font>

1519
01:00:27,240 --> 01:00:31,439
nut and the aggregator<font color="#CCCCCC"> is the router ID</font>

1520
01:00:29,880 --> 01:00:33,240
of the router performing the aggregation

1521
01:00:31,440 --> 01:00:34,710
which is useful for<font color="#E5E5E5"> troubleshooting to</font>

1522
01:00:33,240 --> 01:00:37,379
figure out where this aggregate route is

1523
01:00:34,710 --> 01:00:39,240
coming from the aggregate<font color="#E5E5E5"> the aggregate</font>

1524
01:00:37,380 --> 01:00:40,950
route can also inherit some<font color="#E5E5E5"> of the</font>

1525
01:00:39,240 --> 01:00:43,618
qualities of the<font color="#E5E5E5"> contributing routes</font>

1526
01:00:40,950 --> 01:00:46,319
<font color="#E5E5E5">like the a s path and it will store them</font>

1527
01:00:43,619 --> 01:00:47,819
<font color="#E5E5E5">in an a s set and you can craft policy</font>

1528
01:00:46,319 --> 01:00:51,119
to say certain routes do or don't

1529
01:00:47,819 --> 01:00:53,520
contribute to<font color="#E5E5E5"> the aggregate so the way</font>

1530
01:00:51,119 --> 01:00:56,460
<font color="#E5E5E5">this</font><font color="#CCCCCC"> looks in</font><font color="#E5E5E5"> a drawing we've got a</font><font color="#CCCCCC"> s1</font>

1531
01:00:53,520 --> 01:01:01,349
advertising<font color="#E5E5E5"> 1.1.1 0/24</font>

1532
01:00:56,460 --> 01:01:04,710
and<font color="#CCCCCC"> asq advertising 1.1.2 dot 0/24 both</font>

1533
01:01:01,349 --> 01:01:06,960
to the same<font color="#E5E5E5"> upstream a s3 in this case</font>

1534
01:01:04,710 --> 01:01:10,109
in this<font color="#E5E5E5"> case a s3 is going to aggregate</font>

1535
01:01:06,960 --> 01:01:14,279
this 2/24<font color="#E5E5E5"> s into a 22 which is</font><font color="#CCCCCC"> one</font><font color="#E5E5E5"> dot</font>

1536
01:01:10,109 --> 01:01:17,400
<font color="#E5E5E5">one dot 0 dot 0 / 2 and he's going to</font>

1537
01:01:14,279 --> 01:01:19,319
<font color="#E5E5E5">advertise that to a s for his upstream</font>

1538
01:01:17,400 --> 01:01:22,079
<font color="#E5E5E5">so one way he can do that</font><font color="#CCCCCC"> is just simply</font>

1539
01:01:19,319 --> 01:01:25,920
<font color="#E5E5E5">advertises last</font><font color="#CCCCCC"> twenty two</font><font color="#E5E5E5"> and it will</font>

1540
01:01:22,079 --> 01:01:27,779
be originated<font color="#E5E5E5"> by a s3 but another way</font>

1541
01:01:25,920 --> 01:01:29,760
<font color="#CCCCCC">that you can do that is he can use an a</font>

1542
01:01:27,779 --> 01:01:31,980
<font color="#E5E5E5">s set and inherit the a s path of the</font>

1543
01:01:29,760 --> 01:01:34,890
contributing<font color="#E5E5E5"> realms in this case you'll</font>

1544
01:01:31,980 --> 01:01:39,980
<font color="#CCCCCC">see that the routes</font><font color="#E5E5E5"> are being originated</font>

1545
01:01:34,890 --> 01:01:39,980
<font color="#E5E5E5">by a</font><font color="#CCCCCC"> s1 and to</font><font color="#E5E5E5"> behind a s3</font>

1546
01:01:41,220 --> 01:01:46,089
there's also the atomic aggregate<font color="#E5E5E5"> in</font>

1547
01:01:43,990 --> 01:01:48,819
this case a s 1 is again announcing the

1548
01:01:46,090 --> 01:01:52,720
same<font color="#CCCCCC"> slash 24 but a s 2 is announcing</font>

1549
01:01:48,820 --> 01:01:55,300
the entire<font color="#CCCCCC"> slash 22</font><font color="#E5E5E5"> a s 3 is only going</font>

1550
01:01:52,720 --> 01:01:58,089
<font color="#E5E5E5">to announce the aggregate</font><font color="#CCCCCC"> slash 22 it's</font>

1551
01:01:55,300 --> 01:02:01,180
going to show that<font color="#CCCCCC"> as being originated</font>

1552
01:01:58,090 --> 01:02:03,580
<font color="#E5E5E5">by a s</font><font color="#CCCCCC"> 2 behind</font><font color="#E5E5E5"> a s 3</font><font color="#CCCCCC"> but it's also</font>

1553
01:02:01,180 --> 01:02:05,589
going to set<font color="#E5E5E5"> the atomic aggregate flag</font>

1554
01:02:03,580 --> 01:02:08,230
<font color="#E5E5E5">so that's going to indicate to upstream</font>

1555
01:02:05,590 --> 01:02:10,480
routers<font color="#CCCCCC"> that a s 3 sees other more</font>

1556
01:02:08,230 --> 01:02:15,310
specific routes inside that<font color="#E5E5E5"> slash 22</font>

1557
01:02:10,480 --> 01:02:19,540
which are being suppressed<font color="#E5E5E5"> one more path</font>

1558
01:02:15,310 --> 01:02:21,759
<font color="#CCCCCC">attribute the a s for path the</font><font color="#E5E5E5"> a s path</font>

1559
01:02:19,540 --> 01:02:24,490
is<font color="#E5E5E5"> actually not</font><font color="#CCCCCC"> capable</font><font color="#E5E5E5"> of carrying</font><font color="#CCCCCC"> 32</font>

1560
01:02:21,760 --> 01:02:26,020
<font color="#CCCCCC">bit autonomous system numbers there was</font>

1561
01:02:24,490 --> 01:02:29,649
some discussion<font color="#E5E5E5"> about changing</font><font color="#CCCCCC"> the ass</font>

1562
01:02:26,020 --> 01:02:31,120
path to include<font color="#CCCCCC"> 32</font><font color="#E5E5E5"> bit a</font><font color="#CCCCCC"> SNS</font><font color="#E5E5E5"> but that</font>

1563
01:02:29,650 --> 01:02:33,150
would make it non backwards compatible

1564
01:02:31,120 --> 01:02:36,130
and<font color="#E5E5E5"> break the already deployed</font>

1565
01:02:33,150 --> 01:02:38,530
implementations<font color="#E5E5E5"> so what they decided</font><font color="#CCCCCC"> to</font>

1566
01:02:36,130 --> 01:02:41,440
do is to create a new a s path<font color="#E5E5E5"> called a</font>

1567
01:02:38,530 --> 01:02:44,710
<font color="#E5E5E5">s</font><font color="#CCCCCC"> 4 path and in the a s 4 path and they</font>

1568
01:02:41,440 --> 01:02:47,350
would put the<font color="#CCCCCC"> 32 bit a SNS and they</font>

1569
01:02:44,710 --> 01:02:50,010
would still<font color="#E5E5E5"> continue to put the a s path</font>

1570
01:02:47,350 --> 01:02:52,450
the the<font color="#CCCCCC"> 16</font><font color="#E5E5E5"> bit a s is in the</font><font color="#CCCCCC"> a s path</font>

1571
01:02:50,010 --> 01:02:55,840
but in the<font color="#CCCCCC"> event that there was a 32 bit</font>

1572
01:02:52,450 --> 01:02:57,549
<font color="#CCCCCC">ASN</font><font color="#E5E5E5"> they would stick in a s 2 3 4 5 6 as</font>

1573
01:02:55,840 --> 01:03:00,040
a placeholder<font color="#E5E5E5"> to indicate that there was</font>

1574
01:02:57,550 --> 01:03:02,830
a four bit ASM that couldn't be properly

1575
01:03:00,040 --> 01:03:05,230
<font color="#CCCCCC">represented in the a s path so this way</font>

1576
01:03:02,830 --> 01:03:07,600
routers that weren't capable of a<font color="#E5E5E5"> 32 bit</font>

1577
01:03:05,230 --> 01:03:10,360
ASM could still just<font color="#E5E5E5"> use the a s path</font>

1578
01:03:07,600 --> 01:03:12,910
<font color="#E5E5E5">everything</font><font color="#CCCCCC"> would work just just fine and</font>

1579
01:03:10,360 --> 01:03:16,120
they would see a s 2<font color="#E5E5E5"> 3 4 5 6 in the</font><font color="#CCCCCC"> as</font>

1580
01:03:12,910 --> 01:03:18,790
path but routers<font color="#CCCCCC"> that were 32-bit</font>

1581
01:03:16,120 --> 01:03:22,330
capable would actually be able<font color="#E5E5E5"> to use</font>

1582
01:03:18,790 --> 01:03:24,759
the a s 4 path and see the<font color="#CCCCCC"> 32 bit</font><font color="#E5E5E5"> a s</font>

1583
01:03:22,330 --> 01:03:27,250
ends in there as well there's some

1584
01:03:24,760 --> 01:03:28,750
<font color="#E5E5E5">interesting interaction here because you</font>

1585
01:03:27,250 --> 01:03:32,890
could have a router in the middle of the

1586
01:03:28,750 --> 01:03:36,220
network<font color="#CCCCCC"> that</font><font color="#E5E5E5"> is only a</font><font color="#CCCCCC"> 16-bit ASN</font>

1587
01:03:32,890 --> 01:03:38,049
capable in which case when<font color="#CCCCCC"> he offends</font>

1588
01:03:36,220 --> 01:03:40,060
his<font color="#CCCCCC"> ASD the</font><font color="#E5E5E5"> ass path he's going to only</font>

1589
01:03:38,050 --> 01:03:42,970
<font color="#E5E5E5">do that in the ass path and not the a s4</font>

1590
01:03:40,060 --> 01:03:45,310
path so potentially the a s4 path does

1591
01:03:42,970 --> 01:03:47,500
<font color="#CCCCCC">not contain a</font><font color="#E5E5E5"> complete view of the a s</font>

1592
01:03:45,310 --> 01:03:51,009
path so you<font color="#E5E5E5"> have to construct a complete</font>

1593
01:03:47,500 --> 01:03:52,100
<font color="#E5E5E5">view of the a s path both from the a s</font>

1594
01:03:51,010 --> 01:03:55,010
path as well as the

1595
01:03:52,100 --> 01:03:57,740
<font color="#CCCCCC">warpath</font><font color="#E5E5E5"> and that's gonna be the</font><font color="#CCCCCC"> case for</font>

1596
01:03:55,010 --> 01:04:02,900
<font color="#E5E5E5">some time until</font><font color="#CCCCCC"> all routers areas for</font>

1597
01:03:57,740 --> 01:04:07,069
capable do you guys want to<font color="#E5E5E5"> take a break</font>

1598
01:04:02,900 --> 01:04:08,240
say<font color="#E5E5E5"> 10-minute</font><font color="#CCCCCC"> break alright let's go</font>

1599
01:04:07,070 --> 01:04:10,390
<font color="#E5E5E5">ahead and take it to em break 10-minute</font>

1600
01:04:08,240 --> 01:04:10,390
break

1601
01:05:54,309 --> 01:05:58,150
and<font color="#CCCCCC"> to draw this now</font>

1602
01:06:00,070 --> 01:06:10,410
I saw an<font color="#E5E5E5"> email oh and I'll mention</font>

1603
01:12:06,150 --> 01:12:10,699
all right we're gonna go ahead<font color="#CCCCCC"> and get</font>

1604
01:12:07,949 --> 01:12:10,699
started back<font color="#CCCCCC"> in a minute</font>

1605
01:13:46,179 --> 01:13:50,860
so I've actually<font color="#E5E5E5"> been asked to hold off</font>

1606
01:13:48,580 --> 01:13:52,780
<font color="#CCCCCC">on</font><font color="#E5E5E5"> the one or</font><font color="#CCCCCC"> two slides until four so</font>

1607
01:13:50,860 --> 01:13:55,839
if anybody had<font color="#E5E5E5"> any</font><font color="#CCCCCC"> questions or wanted</font>

1608
01:13:52,780 --> 01:13:58,659
<font color="#E5E5E5">to review anything in the first half we</font>

1609
01:13:55,840 --> 01:14:00,969
can<font color="#E5E5E5"> go ahead and do</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> if not</font><font color="#CCCCCC"> you're</font>

1610
01:13:58,659 --> 01:14:02,589
free<font color="#E5E5E5"> till the next 15</font><font color="#CCCCCC"> minutes and then</font>

1611
01:14:00,969 --> 01:14:08,400
<font color="#E5E5E5">we have a break and some coffee and</font>

1612
01:14:02,590 --> 01:14:08,400
cookies and<font color="#E5E5E5"> why not yes</font>

1613
01:14:08,790 --> 01:14:13,410
they will be available<font color="#CCCCCC"> on the website</font>

1614
01:14:11,050 --> 01:14:13,410
<font color="#E5E5E5">yeah</font>

1615
01:14:34,660 --> 01:14:39,940
so the question is is<font color="#E5E5E5"> 10-gig becoming</font>

1616
01:14:37,630 --> 01:14:41,650
more prevalent<font color="#CCCCCC"> and are people using</font><font color="#E5E5E5"> and</font>

1617
01:14:39,940 --> 01:14:44,200
are people<font color="#CCCCCC"> using fiber channel</font><font color="#E5E5E5"> as it</font>

1618
01:14:41,650 --> 01:14:45,940
<font color="#E5E5E5">becomes more prevalent</font><font color="#CCCCCC"> so yeah certainly</font>

1619
01:14:44,200 --> 01:14:48,580
we're seeing<font color="#CCCCCC"> a lot more</font><font color="#E5E5E5"> a thern ette a</font>

1620
01:14:45,940 --> 01:14:51,009
lot more<font color="#E5E5E5"> Giggy and</font><font color="#CCCCCC"> 10 Giggy a lot</font><font color="#E5E5E5"> of the</font>

1621
01:14:48,580 --> 01:14:53,410
reason<font color="#E5E5E5"> for</font><font color="#CCCCCC"> that is because it's cheaper</font>

1622
01:14:51,010 --> 01:14:57,700
you don't have all the timing clocking

1623
01:14:53,410 --> 01:14:59,980
so<font color="#E5E5E5"> on</font><font color="#CCCCCC"> it stuff and certainly</font><font color="#E5E5E5"> as growth</font>

1624
01:14:57,700 --> 01:15:01,929
of the utilization grows people are

1625
01:14:59,980 --> 01:15:04,410
wanting<font color="#CCCCCC"> to bond those together so yes we</font>

1626
01:15:01,930 --> 01:15:04,410
are seeing<font color="#E5E5E5"> that</font>

1627
01:15:20,510 --> 01:15:25,210
<font color="#E5E5E5">all right well then I guess I'll</font><font color="#CCCCCC"> see you</font>

1628
01:15:22,130 --> 01:15:25,210
<font color="#E5E5E5">all</font><font color="#CCCCCC"> at four</font><font color="#E5E5E5"> after the break</font>

