1
00:00:00,000 --> 00:00:02,029
I

2
00:01:05,650 --> 00:01:09,369
no it did it<font color="#E5E5E5"> okay</font>

3
00:01:10,430 --> 00:01:18,040
it was<font color="#CCCCCC"> actually 97 by the way if you</font>

4
00:01:13,610 --> 00:01:18,039
look at<font color="#CCCCCC"> the big bgp so</font>

5
00:01:48,310 --> 00:01:54,100
hello my name<font color="#CCCCCC"> is avi Friedman I now with</font>

6
00:01:52,840 --> 00:01:55,659
<font color="#CCCCCC">server</font><font color="#E5E5E5"> central and I'm here to talk</font>

7
00:01:54,100 --> 00:01:58,600
about whatever you<font color="#E5E5E5"> guys would like to</font>

8
00:01:55,659 --> 00:02:01,990
<font color="#E5E5E5">hear about about bgp this talk is</font>

9
00:01:58,600 --> 00:02:03,729
oriented as an intro we have done sort

10
00:02:01,990 --> 00:02:06,250
of more intermediate level and I guess

11
00:02:03,729 --> 00:02:08,410
the<font color="#E5E5E5"> question that I have for the people</font>

12
00:02:06,250 --> 00:02:10,660
who<font color="#E5E5E5"> are not here just to heckle is what</font>

13
00:02:08,410 --> 00:02:14,019
you guys would like<font color="#E5E5E5"> to</font><font color="#CCCCCC"> actually at what</font>

14
00:02:10,660 --> 00:02:16,420
level you would like this Taylor 24 so

15
00:02:14,019 --> 00:02:19,239
again ignoring the hecklers how many

16
00:02:16,420 --> 00:02:21,160
people<font color="#E5E5E5"> have are curious about bgp but</font>

17
00:02:19,239 --> 00:02:25,440
have not actually turned up bgp

18
00:02:21,160 --> 00:02:29,049
themselves<font color="#E5E5E5"> okay and</font><font color="#CCCCCC"> how many people have</font>

19
00:02:25,440 --> 00:02:31,060
basic bgp that they figured out how to

20
00:02:29,049 --> 00:02:32,650
<font color="#CCCCCC">set up multi-homing or they had some</font>

21
00:02:31,060 --> 00:02:34,870
people help them and are curious about

22
00:02:32,650 --> 00:02:36,910
how to grow beyond that great then this

23
00:02:34,870 --> 00:02:41,140
presentation is just right on and we'll

24
00:02:36,910 --> 00:02:42,599
try<font color="#E5E5E5"> to ignore the hecklers so so we're</font>

25
00:02:41,140 --> 00:02:45,279
going<font color="#E5E5E5"> to talk a little bit about</font>

26
00:02:42,599 --> 00:02:47,018
connectivity in general what it means

27
00:02:45,280 --> 00:02:50,140
how you get your IP addresses connected

28
00:02:47,019 --> 00:02:52,120
to the net how some concepts around

29
00:02:50,140 --> 00:02:54,608
<font color="#CCCCCC">multi-homing with autonomous system</font>

30
00:02:52,120 --> 00:02:56,410
numbers and address space how you

31
00:02:54,609 --> 00:03:01,239
actually are connected multihomed

32
00:02:56,410 --> 00:03:04,269
without using bgp how and then a bunch

33
00:03:01,239 --> 00:03:06,040
of topics about bgp itself bgp routes

34
00:03:04,269 --> 00:03:08,440
and peering sessions and autonomous

35
00:03:06,040 --> 00:03:10,209
system numbers and some of the some of

36
00:03:08,440 --> 00:03:12,280
the flexibility<font color="#E5E5E5"> built into bgp to</font>

37
00:03:10,209 --> 00:03:13,630
control how you see the world<font color="#E5E5E5"> and how</font>

38
00:03:12,280 --> 00:03:16,060
the world sees you when you are

39
00:03:13,630 --> 00:03:18,310
multihomed and we'll<font color="#E5E5E5"> have a little bit</font>

40
00:03:16,060 --> 00:03:20,910
of a detour talking about<font color="#E5E5E5"> hardware</font>

41
00:03:18,310 --> 00:03:25,810
hardware to support<font color="#CCCCCC"> multi-homing and</font>

42
00:03:20,910 --> 00:03:27,400
<font color="#CCCCCC">show some configurations and talk about</font>

43
00:03:25,810 --> 00:03:30,489
a little bit about some best practices

44
00:03:27,400 --> 00:03:32,620
we<font color="#CCCCCC"> actually have fairly limited time for</font>

45
00:03:30,489 --> 00:03:34,060
bgp intro<font color="#E5E5E5"> i think we have 90 minutes and</font>

46
00:03:32,620 --> 00:03:37,690
i'll give<font color="#E5E5E5"> you some links to some</font>

47
00:03:34,060 --> 00:03:43,030
additional material including a<font color="#E5E5E5"> BGP 102</font>

48
00:03:37,690 --> 00:03:45,100
that gets more into scaling so if you're

49
00:03:43,030 --> 00:03:46,569
trying to<font color="#CCCCCC"> get to</font><font color="#E5E5E5"> the internet the most</font>

50
00:03:45,100 --> 00:03:48,489
important thing<font color="#CCCCCC"> to remember is the</font>

51
00:03:46,569 --> 00:03:50,018
reverse path right you have<font color="#E5E5E5"> to get your</font>

52
00:03:48,489 --> 00:03:54,160
packets out and people have<font color="#CCCCCC"> to be able</font>

53
00:03:50,019 --> 00:03:55,780
<font color="#E5E5E5">to</font><font color="#CCCCCC"> find you the way that people find you</font>

54
00:03:54,160 --> 00:03:58,030
is by making sure<font color="#E5E5E5"> that</font><font color="#CCCCCC"> your upstream</font>

55
00:03:55,780 --> 00:03:58,930
providers are telling everyone else that

56
00:03:58,030 --> 00:03:59,960
they know how to get to<font color="#CCCCCC"> your address</font>

57
00:03:58,930 --> 00:04:01,820
<font color="#CCCCCC">space</font>

58
00:03:59,960 --> 00:04:03,380
either because you're using IP addresses

59
00:04:01,820 --> 00:04:05,090
in their address<font color="#E5E5E5"> space in which case</font>

60
00:04:03,380 --> 00:04:07,700
they're already engineered to take care

61
00:04:05,090 --> 00:04:09,920
<font color="#E5E5E5">of it or if you're bringing addresses to</font>

62
00:04:07,700 --> 00:04:12,350
<font color="#CCCCCC">the table they need to advertise them or</font>

63
00:04:09,920 --> 00:04:14,209
using bgp you would advertise them to

64
00:04:12,350 --> 00:04:17,120
them and they would send it to everybody

65
00:04:14,210 --> 00:04:19,280
else full internet connectivity means

66
00:04:17,120 --> 00:04:21,260
that the route<font color="#E5E5E5"> that cover your address</font>

67
00:04:19,279 --> 00:04:22,669
space have to be seen by all the

68
00:04:21,260 --> 00:04:24,980
important<font color="#E5E5E5"> networks out there basically</font>

69
00:04:22,670 --> 00:04:26,990
every network out there when that

70
00:04:24,980 --> 00:04:28,990
<font color="#E5E5E5">doesn't happen you get things like</font>

71
00:04:26,990 --> 00:04:31,190
cogent and level 3 and cogent and

72
00:04:28,990 --> 00:04:33,230
provider a and cogent provider be

73
00:04:31,190 --> 00:04:36,010
encoded<font color="#CCCCCC"> provider</font><font color="#E5E5E5"> see not being able to</font>

74
00:04:33,230 --> 00:04:38,570
<font color="#E5E5E5">see each other so without bgp</font>

75
00:04:36,010 --> 00:04:39,860
<font color="#CCCCCC">multi-homing works just fine a little</font>

76
00:04:38,570 --> 00:04:41,420
bit<font color="#CCCCCC"> of a complication in terms of</font>

77
00:04:39,860 --> 00:04:44,240
whether it's providers do or don't<font color="#E5E5E5"> want</font>

78
00:04:41,420 --> 00:04:46,520
like to let you<font color="#CCCCCC"> use their address space</font>

79
00:04:44,240 --> 00:04:47,930
how many people<font color="#E5E5E5"> here</font><font color="#CCCCCC"> have only provider</font>

80
00:04:46,520 --> 00:04:50,330
address space they don't have provider

81
00:04:47,930 --> 00:04:51,890
independent space yet<font color="#E5E5E5"> okay so we</font><font color="#CCCCCC"> have</font>

82
00:04:50,330 --> 00:04:53,330
one and everyone else has how many

83
00:04:51,890 --> 00:04:54,770
people<font color="#CCCCCC"> are still running a mix they have</font>

84
00:04:53,330 --> 00:04:58,010
some space from providers than they have

85
00:04:54,770 --> 00:05:00,469
their own space from registry okay make

86
00:04:58,010 --> 00:05:03,080
<font color="#E5E5E5">sense so again the important point here</font>

87
00:05:00,470 --> 00:05:06,800
is to get traffic back you need to have

88
00:05:03,080 --> 00:05:09,200
everyone know how to get to you so I

89
00:05:06,800 --> 00:05:12,350
think the<font color="#CCCCCC"> best way to think about a</font>

90
00:05:09,200 --> 00:05:14,510
route is a promise if<font color="#E5E5E5"> I send you a BGP</font>

91
00:05:12,350 --> 00:05:15,650
route or any kind of route it means that

92
00:05:14,510 --> 00:05:18,140
I'm promising that if you give me

93
00:05:15,650 --> 00:05:19,880
packets for that destination that I can

94
00:05:18,140 --> 00:05:25,280
deliver them at least<font color="#E5E5E5"> as</font><font color="#CCCCCC"> well as anyone</font>

95
00:05:19,880 --> 00:05:26,870
else so if<font color="#CCCCCC"> I advertise 17 I promise that</font>

96
00:05:25,280 --> 00:05:28,909
<font color="#CCCCCC">if you deliver traffic to me for</font>

97
00:05:26,870 --> 00:05:31,970
<font color="#E5E5E5">anything inside that I know how to get</font>

98
00:05:28,910 --> 00:05:33,500
it there<font color="#E5E5E5"> and if you are a single home</font>

99
00:05:31,970 --> 00:05:36,020
customer of mine and I give you address

100
00:05:33,500 --> 00:05:37,550
space within that<font color="#CCCCCC"> the entire world</font>

101
00:05:36,020 --> 00:05:40,609
doesn't actually need<font color="#E5E5E5"> to know about your</font>

102
00:05:37,550 --> 00:05:44,540
/ 24 it's when you<font color="#CCCCCC"> multi home that you</font>

103
00:05:40,610 --> 00:05:46,850
need to advertise the 24 out both paths

104
00:05:44,540 --> 00:05:49,640
you need to advertise it so that you can

105
00:05:46,850 --> 00:05:50,930
become multicom so you have to make<font color="#CCCCCC"> sure</font>

106
00:05:49,640 --> 00:05:53,479
that all these promises are heard by

107
00:05:50,930 --> 00:05:55,160
everybody and you just<font color="#CCCCCC"> you need to</font>

108
00:05:53,480 --> 00:05:57,350
<font color="#E5E5E5">remember that when there's connectivity</font>

109
00:05:55,160 --> 00:05:59,090
problems it's also the reverse path

110
00:05:57,350 --> 00:06:00,590
which is controlled by you sending these

111
00:05:59,090 --> 00:06:02,989
routes out or your providers advertising

112
00:06:00,590 --> 00:06:04,580
their routes for you so again the routes

113
00:06:02,990 --> 00:06:06,170
go one way and the traffic goes the

114
00:06:04,580 --> 00:06:08,800
other I tell you that<font color="#CCCCCC"> I know how to get</font>

115
00:06:06,170 --> 00:06:11,180
somewhere and<font color="#E5E5E5"> thus the traffic will flow</font>

116
00:06:08,800 --> 00:06:13,639
it's much easier to control your

117
00:06:11,180 --> 00:06:16,219
outbound routes you can always type

118
00:06:13,639 --> 00:06:17,689
well whatever whatever then<font color="#CCCCCC"> you're</font>

119
00:06:16,219 --> 00:06:19,280
inbound<font color="#E5E5E5"> and that's something that we'll</font>

120
00:06:17,689 --> 00:06:22,249
talk<font color="#E5E5E5"> about as we go through this how</font>

121
00:06:19,280 --> 00:06:25,688
many people here<font color="#CCCCCC"> have who are just</font>

122
00:06:22,249 --> 00:06:30,050
learning BGP have<font color="#E5E5E5"> Cisco only network</font>

123
00:06:25,689 --> 00:06:34,249
juniper only<font color="#CCCCCC"> network netgear only</font>

124
00:06:30,050 --> 00:06:36,860
<font color="#E5E5E5">network okay so people generally are</font>

125
00:06:34,249 --> 00:06:38,900
working with multiple vendors i'm going

126
00:06:36,860 --> 00:06:40,400
<font color="#E5E5E5">to use cisco terminology here because</font>

127
00:06:38,900 --> 00:06:42,888
that's probably the most widely deployed

128
00:06:40,400 --> 00:06:45,289
platform the people<font color="#E5E5E5"> using bgp how many</font>

129
00:06:42,889 --> 00:06:47,810
people use primarily catalysts catalyst

130
00:06:45,289 --> 00:06:55,909
6500<font color="#E5E5E5"> s for routing for bgp routing</font>

131
00:06:47,810 --> 00:06:57,560
switch routers<font color="#E5E5E5"> okay okay so getting</font>

132
00:06:55,909 --> 00:07:00,050
outbound packets to go well we're

133
00:06:57,560 --> 00:07:03,199
talking now about how does it work when

134
00:07:00,050 --> 00:07:06,379
<font color="#E5E5E5">you're multihomed without running</font><font color="#CCCCCC"> bgp so</font>

135
00:07:03,199 --> 00:07:09,080
pretty simple<font color="#E5E5E5"> you set your default</font>

136
00:07:06,379 --> 00:07:12,710
routes you set your policy it could be

137
00:07:09,080 --> 00:07:14,870
do that i use both<font color="#CCCCCC"> of my links equally</font>

138
00:07:12,710 --> 00:07:17,539
it could be that<font color="#CCCCCC"> i prefer one link and</font>

139
00:07:14,870 --> 00:07:18,949
then one of them as a backup obviously

140
00:07:17,539 --> 00:07:20,029
if you have a more complex topology

141
00:07:18,949 --> 00:07:22,039
where you're<font color="#E5E5E5"> not doing this all on one</font>

142
00:07:20,029 --> 00:07:25,069
router then you get<font color="#CCCCCC"> into some ibgp</font>

143
00:07:22,039 --> 00:07:26,568
issues which we'll talk about and you

144
00:07:25,069 --> 00:07:28,400
<font color="#E5E5E5">can use administrative you can use</font>

145
00:07:26,569 --> 00:07:32,360
weights say this is better than<font color="#E5E5E5"> this and</font>

146
00:07:28,400 --> 00:07:34,128
with a with most routers nowadays

147
00:07:32,360 --> 00:07:36,919
including all the switch routers that

148
00:07:34,129 --> 00:07:38,180
people are<font color="#CCCCCC"> using the way</font><font color="#E5E5E5"> this happens</font>

149
00:07:36,919 --> 00:07:41,149
<font color="#CCCCCC">you can</font><font color="#E5E5E5"> think of it</font><font color="#CCCCCC"> as whether it's</font>

150
00:07:38,180 --> 00:07:43,310
hashing or weld caching basically it's

151
00:07:41,149 --> 00:07:44,750
not every<font color="#E5E5E5"> other packet that will go out</font>

152
00:07:43,310 --> 00:07:47,149
multiple links when you load balancing

153
00:07:44,750 --> 00:07:49,580
because that would<font color="#CCCCCC"> be very bad for TCP</font>

154
00:07:47,149 --> 00:07:52,189
going to remote destinations it's to get

155
00:07:49,580 --> 00:07:54,830
from either to get to a location or to

156
00:07:52,189 --> 00:07:58,520
get from an IP import to an IP and port

157
00:07:54,830 --> 00:08:01,029
will typically go one way so again not

158
00:07:58,520 --> 00:08:04,159
using<font color="#E5E5E5"> BGP pretty simple to do outbound</font>

159
00:08:01,029 --> 00:08:05,930
to do inbound you just have to tell your

160
00:08:04,159 --> 00:08:07,610
provider what address space and they

161
00:08:05,930 --> 00:08:11,629
magically make it happen there are some

162
00:08:07,610 --> 00:08:13,520
advantages to running this way without

163
00:08:11,629 --> 00:08:16,129
<font color="#E5E5E5">BGP which is you just call up your</font>

164
00:08:13,520 --> 00:08:18,680
providers and complain and you know your

165
00:08:16,129 --> 00:08:20,479
router's if they're unstable probably

166
00:08:18,680 --> 00:08:22,009
<font color="#E5E5E5">won't affect people actually getting</font>

167
00:08:20,479 --> 00:08:24,199
packets back to you if you're running

168
00:08:22,009 --> 00:08:26,029
BGP and you don't run a stable network

169
00:08:24,199 --> 00:08:26,610
your problems are amplified your

170
00:08:26,029 --> 00:08:28,800
connectivity

171
00:08:26,610 --> 00:08:30,659
problems become amplified<font color="#CCCCCC"> over if you if</font>

172
00:08:28,800 --> 00:08:35,490
all of your routing logic lives at your

173
00:08:30,659 --> 00:08:37,289
provider but generally generally the

174
00:08:35,490 --> 00:08:39,000
reason why people<font color="#E5E5E5"> do want to run bgp</font>

175
00:08:37,289 --> 00:08:40,740
even if there are<font color="#E5E5E5"> only multi home to two</font>

176
00:08:39,000 --> 00:08:42,360
providers is because it gives you a lot

177
00:08:40,740 --> 00:08:45,510
more control someone calls up and says

178
00:08:42,360 --> 00:08:47,279
hey<font color="#CCCCCC"> my unit connectivity for you is</font>

179
00:08:45,510 --> 00:08:49,500
going<font color="#E5E5E5"> crazy and they say yeah we know</font>

180
00:08:47,279 --> 00:08:50,459
that or they may say we have<font color="#E5E5E5"> no idea</font>

181
00:08:49,500 --> 00:08:52,680
what you're<font color="#E5E5E5"> talking about but you have</font>

182
00:08:50,459 --> 00:08:54,300
customers and you can see that<font color="#E5E5E5"> and then</font>

183
00:08:52,680 --> 00:08:56,069
you can try rolling all your outbound

184
00:08:54,300 --> 00:08:57,750
traffic to different to one of your

185
00:08:56,070 --> 00:08:59,730
other providers and you see it's<font color="#E5E5E5"> better</font>

186
00:08:57,750 --> 00:09:01,320
and boom so that's pretty much

187
00:08:59,730 --> 00:09:03,959
state-of-the-art the internet is

188
00:09:01,320 --> 00:09:06,060
<font color="#E5E5E5">basically a bunch of</font><font color="#CCCCCC"> people</font><font color="#E5E5E5"> using very</font>

189
00:09:03,959 --> 00:09:07,949
simple config language and it's very

190
00:09:06,060 --> 00:09:09,449
much<font color="#CCCCCC"> like a bunch of garage mechanics</font>

191
00:09:07,950 --> 00:09:11,070
banging on routers with wrenches and

192
00:09:09,450 --> 00:09:12,839
people complain and then you make a

193
00:09:11,070 --> 00:09:14,519
change<font color="#E5E5E5"> and if</font><font color="#CCCCCC"> people stop complaining</font>

194
00:09:12,839 --> 00:09:17,370
you leave it so that's generally the<font color="#E5E5E5"> way</font>

195
00:09:14,519 --> 00:09:18,870
people things work so if you're<font color="#CCCCCC"> going to</font>

196
00:09:17,370 --> 00:09:20,880
enter<font color="#E5E5E5"> the</font><font color="#CCCCCC"> multihoming space you need</font>

197
00:09:18,870 --> 00:09:22,680
some address space sounds like most

198
00:09:20,880 --> 00:09:24,750
people are familiar with that how many

199
00:09:22,680 --> 00:09:26,339
<font color="#CCCCCC">people here are planning the multi home</font>

200
00:09:24,750 --> 00:09:29,220
to do not yet have an autonomous system

201
00:09:26,339 --> 00:09:31,050
number<font color="#E5E5E5"> I see that someone actually just</font>

202
00:09:29,220 --> 00:09:32,519
grabbed<font color="#CCCCCC"> for 969 the company</font><font color="#E5E5E5"> that bought</font>

203
00:09:31,050 --> 00:09:34,859
the<font color="#E5E5E5"> company that bought</font><font color="#CCCCCC"> the assets of</font>

204
00:09:32,519 --> 00:09:35,910
the company that<font color="#CCCCCC"> I had started</font><font color="#E5E5E5"> which</font>

205
00:09:34,860 --> 00:09:37,829
then merged with someone and their

206
00:09:35,910 --> 00:09:39,630
assets were bought by someone else gave

207
00:09:37,829 --> 00:09:42,060
back the a s that<font color="#E5E5E5"> I used to use and that</font>

208
00:09:39,630 --> 00:09:45,120
was just reassigned so anyway everyone's

209
00:09:42,060 --> 00:09:49,439
<font color="#CCCCCC">gotten AF and you have an</font><font color="#E5E5E5"> IR IR that you</font>

210
00:09:45,120 --> 00:09:51,269
can talk<font color="#CCCCCC"> to</font><font color="#E5E5E5"> so your providers if you're</font>

211
00:09:49,440 --> 00:09:53,970
going<font color="#E5E5E5"> to start running bgp may require</font>

212
00:09:51,269 --> 00:09:57,510
that you register your you enter your

213
00:09:53,970 --> 00:09:59,370
routes in a routing database how many

214
00:09:57,510 --> 00:10:00,569
people<font color="#E5E5E5"> here are doing</font><font color="#CCCCCC"> multi-homing but</font>

215
00:09:59,370 --> 00:10:03,120
have never played with<font color="#E5E5E5"> a routing</font>

216
00:10:00,570 --> 00:10:05,269
database or rotting<font color="#E5E5E5"> registrated</font><font color="#CCCCCC"> okay so</font>

217
00:10:03,120 --> 00:10:08,279
we<font color="#E5E5E5"> can provide some links at the end I</font>

218
00:10:05,269 --> 00:10:10,440
generally recommend that as people have

219
00:10:08,279 --> 00:10:12,390
<font color="#E5E5E5">recommended to me that people use</font><font color="#CCCCCC"> alt DB</font>

220
00:10:10,440 --> 00:10:13,980
which is free<font color="#E5E5E5"> unless your providers have</font>

221
00:10:12,390 --> 00:10:16,290
some specific database that they run

222
00:10:13,980 --> 00:10:20,100
they want you to be in normally the idea

223
00:10:16,290 --> 00:10:22,319
is any generally accepted routing

224
00:10:20,100 --> 00:10:24,120
registry you can register your your

225
00:10:22,320 --> 00:10:27,029
policy or autonomous system your routes

226
00:10:24,120 --> 00:10:29,130
with and any of your providers that are

227
00:10:27,029 --> 00:10:32,250
doing filtering will pick<font color="#CCCCCC"> that up from</font>

228
00:10:29,130 --> 00:10:34,500
you and the<font color="#E5E5E5"> idea there is that it me it</font>

229
00:10:32,250 --> 00:10:36,209
gives you the ability to register to

230
00:10:34,500 --> 00:10:38,810
tell the world<font color="#E5E5E5"> this is my intent these</font>

231
00:10:36,209 --> 00:10:40,430
are the routes that<font color="#E5E5E5"> I may advertise</font>

232
00:10:38,810 --> 00:10:42,020
and you<font color="#E5E5E5"> don't actually have to then</font>

233
00:10:40,430 --> 00:10:44,089
email your provider and say please

234
00:10:42,020 --> 00:10:46,610
extend my filter because they may<font color="#E5E5E5"> be</font>

235
00:10:44,090 --> 00:10:48,110
able<font color="#E5E5E5"> to actually just run a program that</font>

236
00:10:46,610 --> 00:10:49,670
generates the filters for their routers

237
00:10:48,110 --> 00:10:52,490
and why is filtering important we'll

238
00:10:49,670 --> 00:10:53,900
talk about that ebgp by default when<font color="#E5E5E5"> you</font>

239
00:10:52,490 --> 00:10:55,970
run bgp will send everything to

240
00:10:53,900 --> 00:10:57,260
everybody which would<font color="#CCCCCC"> be a big mess if</font>

241
00:10:55,970 --> 00:10:59,480
the internet actually<font color="#E5E5E5"> ran that way so</font>

242
00:10:57,260 --> 00:11:02,330
you have aggressive filtering that's

243
00:10:59,480 --> 00:11:04,279
very<font color="#E5E5E5"> important that everyone know what</font>

244
00:11:02,330 --> 00:11:09,529
they should<font color="#CCCCCC"> be allowed to get from a</font>

245
00:11:04,279 --> 00:11:12,620
customer so oops okay so on<font color="#E5E5E5"> the provider</font>

246
00:11:09,529 --> 00:11:14,570
side with a<font color="#E5E5E5"> little bit of complexity if</font>

247
00:11:12,620 --> 00:11:16,520
I've got address space that's<font color="#CCCCCC"> actually</font>

248
00:11:14,570 --> 00:11:19,040
<font color="#E5E5E5">not n layer address space if I've got</font>

249
00:11:16,520 --> 00:11:22,160
address space that I had from<font color="#E5E5E5"> n layer</font>

250
00:11:19,040 --> 00:11:24,199
and they<font color="#CCCCCC"> announced it as a / 17 but I've</font>

251
00:11:22,160 --> 00:11:27,620
got formerly a 24 and then I have my new

252
00:11:24,200 --> 00:11:29,089
provider announced just<font color="#E5E5E5"> that 24 all my</font>

253
00:11:27,620 --> 00:11:31,190
traffic is going<font color="#E5E5E5"> to come in on the</font>

254
00:11:29,089 --> 00:11:34,550
sprint connection any of the non

255
00:11:31,190 --> 00:11:36,940
hecklers why is<font color="#E5E5E5"> it that all my traffic</font>

256
00:11:34,550 --> 00:11:41,900
would then come in<font color="#E5E5E5"> the sprint connection</font>

257
00:11:36,940 --> 00:11:49,430
more specific<font color="#CCCCCC"> okay so uh in what</font>

258
00:11:41,900 --> 00:11:50,510
dimension right so<font color="#E5E5E5"> I said non heckler</font>

259
00:11:49,430 --> 00:11:52,760
but I guess Patrick doesn't take

260
00:11:50,510 --> 00:11:57,200
direction we'll wait he used to work for

261
00:11:52,760 --> 00:11:59,300
<font color="#E5E5E5">me and I know</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> okay so not using the</font>

262
00:11:57,200 --> 00:12:00,650
GPA that why<font color="#CCCCCC"> would</font><font color="#E5E5E5"> you want to use vgp</font>

263
00:11:59,300 --> 00:12:02,510
is you get more<font color="#CCCCCC"> control of</font><font color="#E5E5E5"> your destiny</font>

264
00:12:00,650 --> 00:12:05,000
it used<font color="#E5E5E5"> to be that was a little bit more</font>

265
00:12:02,510 --> 00:12:06,200
dangerous because something which we're

266
00:12:05,000 --> 00:12:08,960
not<font color="#E5E5E5"> really going to go into in great</font>

267
00:12:06,200 --> 00:12:10,790
detail BGP route flap damping people

268
00:12:08,960 --> 00:12:12,350
used to use so that the unstable

269
00:12:10,790 --> 00:12:14,030
sections of the net they used to

270
00:12:12,350 --> 00:12:15,740
actually say wait if that if that

271
00:12:14,030 --> 00:12:17,390
section<font color="#E5E5E5"> of the net of those routes are</font>

272
00:12:15,740 --> 00:12:18,650
going up and down we're<font color="#E5E5E5"> going to stop</font>

273
00:12:17,390 --> 00:12:20,540
knowing how to get to them for<font color="#E5E5E5"> a while</font>

274
00:12:18,650 --> 00:12:22,640
and then<font color="#CCCCCC"> it was really a problem</font><font color="#E5E5E5"> because</font>

275
00:12:20,540 --> 00:12:24,380
if you were very unstable you could lose

276
00:12:22,640 --> 00:12:26,480
connectivity to major networks for hours

277
00:12:24,380 --> 00:12:27,860
at a time not as much of a big deal now

278
00:12:26,480 --> 00:12:30,380
<font color="#E5E5E5">although there's still some instability</font>

279
00:12:27,860 --> 00:12:32,120
that some greater risk of creating

280
00:12:30,380 --> 00:12:34,400
instability when you run<font color="#CCCCCC"> btp but the key</font>

281
00:12:32,120 --> 00:12:35,720
thing is you can it gives you the

282
00:12:34,400 --> 00:12:38,449
ability to respond to customer

283
00:12:35,720 --> 00:12:41,240
complaints you can try take a whole

284
00:12:38,450 --> 00:12:43,430
remote network like n layer or sprint or

285
00:12:41,240 --> 00:12:45,500
level<font color="#E5E5E5"> 3 and try moving it you can do it</font>

286
00:12:43,430 --> 00:12:47,209
<font color="#E5E5E5">on a prefix basis and it gives you a</font>

287
00:12:45,500 --> 00:12:49,310
little<font color="#E5E5E5"> bit of control on the inbound</font>

288
00:12:47,209 --> 00:12:51,709
side not as much control the little bit

289
00:12:49,310 --> 00:12:55,579
of control over how people get to you on

290
00:12:51,710 --> 00:12:58,130
and outside so why<font color="#CCCCCC"> BGP well there really</font>

291
00:12:55,580 --> 00:13:00,050
isn't any<font color="#E5E5E5"> other option there's no magic</font>

292
00:12:58,130 --> 00:13:02,689
ESP network of static routes the people

293
00:13:00,050 --> 00:13:04,670
transfer be<font color="#E5E5E5"> GPS worked well enough even</font>

294
00:13:02,690 --> 00:13:08,180
despite the fact that it's<font color="#CCCCCC"> got major</font>

295
00:13:04,670 --> 00:13:09,890
problems and that it's the<font color="#CCCCCC"> only exterior</font>

296
00:13:08,180 --> 00:13:11,810
gateway protocol it's the only protocol

297
00:13:09,890 --> 00:13:15,310
the<font color="#E5E5E5"> network's use to tell</font><font color="#CCCCCC"> each other</font>

298
00:13:11,810 --> 00:13:18,050
about their routes on the<font color="#CCCCCC"> internet the</font>

299
00:13:15,310 --> 00:13:19,790
BGP goes pretty much in the wayback

300
00:13:18,050 --> 00:13:21,469
machine so actually<font color="#CCCCCC"> before I started</font>

301
00:13:19,790 --> 00:13:24,620
playing<font color="#E5E5E5"> with routers it goes far enough</font>

302
00:13:21,470 --> 00:13:28,010
back to anyone<font color="#E5E5E5"> remember any of the non</font>

303
00:13:24,620 --> 00:13:30,620
hecklers remember ANS the<font color="#CCCCCC"> backbone it</font>

304
00:13:28,010 --> 00:13:32,960
goes back to<font color="#E5E5E5"> when there was acceptable</font>

305
00:13:30,620 --> 00:13:34,100
use of different networks that made up

306
00:13:32,960 --> 00:13:35,330
the internet<font color="#E5E5E5"> there was commercial</font>

307
00:13:34,100 --> 00:13:36,740
<font color="#E5E5E5">internet there was research and</font>

308
00:13:35,330 --> 00:13:38,570
educational internet there were things

309
00:13:36,740 --> 00:13:40,940
that you couldn't couldn't do and built

310
00:13:38,570 --> 00:13:43,220
in the<font color="#E5E5E5"> BGP was the idea that you might</font>

311
00:13:40,940 --> 00:13:45,320
<font color="#CCCCCC">have policy and say these routes are</font>

312
00:13:43,220 --> 00:13:46,850
only allowed<font color="#CCCCCC"> to be seen here only</font>

313
00:13:45,320 --> 00:13:48,800
<font color="#CCCCCC">certain kinds of traffic and certain</font>

314
00:13:46,850 --> 00:13:50,960
kinds<font color="#E5E5E5"> of policy so what's actually very</font>

315
00:13:48,800 --> 00:13:53,209
good is<font color="#CCCCCC"> that bgp was built to give</font>

316
00:13:50,960 --> 00:13:55,490
<font color="#E5E5E5">people a lot of flexibility about how</font>

317
00:13:53,210 --> 00:13:57,410
they wanted to treat routes as heard

318
00:13:55,490 --> 00:13:58,730
from different locations<font color="#E5E5E5"> and again why</font>

319
00:13:57,410 --> 00:14:01,760
is that important both your multihomed

320
00:13:58,730 --> 00:14:03,140
you're going to hear the<font color="#E5E5E5"> same for</font>

321
00:14:01,760 --> 00:14:04,790
generally available routes you're going

322
00:14:03,140 --> 00:14:07,520
to hear<font color="#E5E5E5"> about that route we call it</font><font color="#CCCCCC"> a</font>

323
00:14:04,790 --> 00:14:09,709
prefix for many different providers that

324
00:14:07,520 --> 00:14:11,600
gives you multiple paths one for each

325
00:14:09,710 --> 00:14:14,210
provider to the prefix and the policy

326
00:14:11,600 --> 00:14:17,060
lets you decide which pads you prefer

327
00:14:14,210 --> 00:14:18,620
now it happens that how<font color="#E5E5E5"> many people</font><font color="#CCCCCC"> are</font>

328
00:14:17,060 --> 00:14:20,750
<font color="#E5E5E5">multi home but don't really do any</font>

329
00:14:18,620 --> 00:14:22,250
inbound playing with the routes you

330
00:14:20,750 --> 00:14:25,160
don't do local<font color="#CCCCCC"> crafts or</font><font color="#E5E5E5"> padding or</font>

331
00:14:22,250 --> 00:14:26,420
anything like that I mean the fact is it

332
00:14:25,160 --> 00:14:28,370
actually<font color="#E5E5E5"> works pretty well it actually</font>

333
00:14:26,420 --> 00:14:32,750
load balances reasonably well if you buy

334
00:14:28,370 --> 00:14:34,520
from<font color="#E5E5E5"> reasonable providers but running a</font>

335
00:14:32,750 --> 00:14:38,390
network of any complexity you want some

336
00:14:34,520 --> 00:14:40,280
of<font color="#CCCCCC"> that policy flexibility so BGP is a</font>

337
00:14:38,390 --> 00:14:42,890
routing protocol to an exterior gateway

338
00:14:40,280 --> 00:14:44,839
protocol it's the only protocol used to

339
00:14:42,890 --> 00:14:47,600
do this right<font color="#CCCCCC"> now it's got some RFC's</font>

340
00:14:44,840 --> 00:14:49,790
around it we<font color="#E5E5E5"> currently use BGP version 4</font>

341
00:14:47,600 --> 00:14:51,620
so a long<font color="#E5E5E5"> time since anyone knocked on</font>

342
00:14:49,790 --> 00:14:53,510
my door with<font color="#CCCCCC"> BB we should be version 3</font>

343
00:14:51,620 --> 00:14:56,480
most<font color="#E5E5E5"> of the protons and mostly</font><font color="#CCCCCC"> it's have</font>

344
00:14:53,510 --> 00:14:58,069
long been retired it's a distance vector

345
00:14:56,480 --> 00:15:00,140
routing protocol for any of your

346
00:14:58,070 --> 00:15:02,060
computer science<font color="#E5E5E5"> geeks</font>

347
00:15:00,140 --> 00:15:03,530
it supports classless routing which we

348
00:15:02,060 --> 00:15:06,800
<font color="#CCCCCC">don't</font><font color="#E5E5E5"> really need to go</font><font color="#CCCCCC"> into now because</font>

349
00:15:03,530 --> 00:15:10,069
everything does and the<font color="#CCCCCC"> idea is</font><font color="#E5E5E5"> to tell</font>

350
00:15:06,800 --> 00:15:13,069
other networks about<font color="#E5E5E5"> the prefixes the</font>

351
00:15:10,070 --> 00:15:15,620
routes<font color="#E5E5E5"> that every other network is</font>

352
00:15:13,070 --> 00:15:17,150
responsible for if you see<font color="#CCCCCC"> nlr I that</font>

353
00:15:15,620 --> 00:15:18,950
that's a fancy way of saying route

354
00:15:17,150 --> 00:15:21,829
network layer<font color="#E5E5E5"> reach ability information</font>

355
00:15:18,950 --> 00:15:24,620
that's just something the protocol so

356
00:15:21,830 --> 00:15:28,220
one comment the RFC has been updated its

357
00:15:24,620 --> 00:15:30,590
now 4271 is the basis of bt p sub 1971

358
00:15:28,220 --> 00:15:32,360
has been completely invalid for actually

359
00:15:30,590 --> 00:15:34,100
producing a working vgp for many years

360
00:15:32,360 --> 00:15:35,720
and<font color="#E5E5E5"> they finally</font><font color="#CCCCCC"> got around</font><font color="#E5E5E5"> actually</font>

361
00:15:34,100 --> 00:15:37,850
making an RFC that's kind of accurate

362
00:15:35,720 --> 00:15:41,800
how bgp works so would you please send

363
00:15:37,850 --> 00:15:41,800
<font color="#E5E5E5">me email so</font><font color="#CCCCCC"> i may update this thank you</font>

364
00:15:43,030 --> 00:15:46,670
well there were those<font color="#E5E5E5"> things like</font>

365
00:15:44,810 --> 00:15:48,349
weights and other things that<font color="#E5E5E5"> people did</font>

366
00:15:46,670 --> 00:15:50,000
that weren't really<font color="#E5E5E5"> in there that's sort</font>

367
00:15:48,350 --> 00:15:54,260
of like the<font color="#CCCCCC"> hall pass</font><font color="#E5E5E5"> selection thing</font>

368
00:15:50,000 --> 00:15:56,420
that anyway<font color="#E5E5E5"> so in BGP networks are</font>

369
00:15:54,260 --> 00:16:01,280
autonomous systems each<font color="#E5E5E5"> Network has an</font>

370
00:15:56,420 --> 00:16:03,589
autonomous system number<font color="#CCCCCC"> or more one or</font>

371
00:16:01,280 --> 00:16:06,079
<font color="#E5E5E5">more autonomous system numbers so the</font>

372
00:16:03,590 --> 00:16:10,580
routes are exchanged between autonomous

373
00:16:06,080 --> 00:16:13,370
systems in BGP every a s is the same

374
00:16:10,580 --> 00:16:16,040
size so you you net is the<font color="#E5E5E5"> same size as</font>

375
00:16:13,370 --> 00:16:18,440
a single router network when you look at

376
00:16:16,040 --> 00:16:20,510
the route all you see is that<font color="#CCCCCC"> 10 ton of</font>

377
00:16:18,440 --> 00:16:22,370
<font color="#CCCCCC">the system's contribution in BGP you</font>

378
00:16:20,510 --> 00:16:24,790
don't actually<font color="#E5E5E5"> see anything about the</font>

379
00:16:22,370 --> 00:16:27,830
internal topology the<font color="#E5E5E5"> remote network</font>

380
00:16:24,790 --> 00:16:29,300
unless they put some markers on there

381
00:16:27,830 --> 00:16:30,680
that give you some clues that you could

382
00:16:29,300 --> 00:16:32,810
<font color="#E5E5E5">look at called communities which we'll</font>

383
00:16:30,680 --> 00:16:34,219
talk about but you don't see<font color="#CCCCCC"> ten copies</font>

384
00:16:32,810 --> 00:16:36,949
<font color="#CCCCCC">of it just because that network is</font>

385
00:16:34,220 --> 00:16:39,500
bigger vgp doesn't know about link

386
00:16:36,950 --> 00:16:41,270
congestion links size pipe size anything

387
00:16:39,500 --> 00:16:43,490
like that it just tells you i have heard

388
00:16:41,270 --> 00:16:45,410
<font color="#E5E5E5">from this network that i can get there</font>

389
00:16:43,490 --> 00:16:47,600
the distance<font color="#E5E5E5"> vector protocol is pretty</font>

390
00:16:45,410 --> 00:16:49,550
much a whisper down the lane<font color="#E5E5E5"> it's</font><font color="#CCCCCC"> i</font>

391
00:16:47,600 --> 00:16:51,920
heard from him that he<font color="#E5E5E5"> can get there the</font>

392
00:16:49,550 --> 00:16:54,170
<font color="#E5E5E5">next guy</font><font color="#CCCCCC"> that guy says oh I heard this</font>

393
00:16:51,920 --> 00:16:56,750
and here i am that i can get there and

394
00:16:54,170 --> 00:16:59,120
then on the other line another

395
00:16:56,750 --> 00:17:00,980
interesting point the autonomous system

396
00:16:59,120 --> 00:17:03,860
numbers are stamped on the routes on the

397
00:17:00,980 --> 00:17:05,360
way out of a network the way one way you

398
00:17:03,860 --> 00:17:07,130
can remember this is it's<font color="#E5E5E5"> possible to</font>

399
00:17:05,359 --> 00:17:09,708
write a BGP implementation<font color="#CCCCCC"> that sends</font>

400
00:17:07,130 --> 00:17:12,860
routes without actually putting the a s

401
00:17:09,709 --> 00:17:13,340
on it so there were early things with

402
00:17:12,859 --> 00:17:14,629
router

403
00:17:13,339 --> 00:17:17,089
in fact people do that<font color="#E5E5E5"> with</font><font color="#CCCCCC"> real</font>

404
00:17:14,630 --> 00:17:19,790
reflection<font color="#E5E5E5"> that you can add an exchange</font>

405
00:17:17,089 --> 00:17:21,319
point share routes between people

406
00:17:19,790 --> 00:17:23,359
without having your AAS in it so if you

407
00:17:21,319 --> 00:17:25,970
trying to think<font color="#CCCCCC"> in your head does the</font>

408
00:17:23,359 --> 00:17:27,889
<font color="#CCCCCC">rel on</font><font color="#E5E5E5"> my network have my a s in it the</font>

409
00:17:25,970 --> 00:17:29,870
answer<font color="#E5E5E5"> is it</font><font color="#CCCCCC"> doesn't and the way</font><font color="#E5E5E5"> that</font>

410
00:17:27,890 --> 00:17:31,310
you know that<font color="#E5E5E5"> the a s is only on the way</font>

411
00:17:29,870 --> 00:17:33,310
out is that you could write software

412
00:17:31,310 --> 00:17:36,050
that will transfer routes without

413
00:17:33,310 --> 00:17:38,600
actually having it is<font color="#CCCCCC"> in the</font><font color="#E5E5E5"> middle so</font>

414
00:17:36,050 --> 00:17:40,760
no concept of pipe<font color="#CCCCCC"> size size congestion</font>

415
00:17:38,600 --> 00:17:44,149
anything like that one of the<font color="#E5E5E5"> things</font>

416
00:17:40,760 --> 00:17:45,379
that<font color="#CCCCCC"> is actually the first</font><font color="#E5E5E5"> learning when</font>

417
00:17:44,150 --> 00:17:47,690
you start<font color="#E5E5E5"> playing with Internet routing</font>

418
00:17:45,380 --> 00:17:50,480
is a lot of the hidden complexity that

419
00:17:47,690 --> 00:17:52,550
you might think is there isn't<font color="#E5E5E5"> it's just</font>

420
00:17:50,480 --> 00:17:55,430
a bunch of dumb stuff involved with

421
00:17:52,550 --> 00:17:56,960
<font color="#E5E5E5">Cisco excuse me with vendor routing bugs</font>

422
00:17:55,430 --> 00:17:58,940
of all<font color="#E5E5E5"> different kinds of vendors have</font>

423
00:17:56,960 --> 00:18:00,560
bugs and you<font color="#E5E5E5"> just need to know</font><font color="#CCCCCC"> the</font>

424
00:17:58,940 --> 00:18:02,090
simple stuff well enough that when you

425
00:18:00,560 --> 00:18:04,550
see a problem<font color="#CCCCCC"> you can sit down and say</font>

426
00:18:02,090 --> 00:18:06,560
what should<font color="#E5E5E5"> be happening and you know</font>

427
00:18:04,550 --> 00:18:08,120
you grow to earn your your routing

428
00:18:06,560 --> 00:18:09,860
engineer bones the first time you find

429
00:18:08,120 --> 00:18:11,600
out<font color="#CCCCCC"> that something</font><font color="#E5E5E5"> that should</font><font color="#CCCCCC"> be</font>

430
00:18:09,860 --> 00:18:13,100
happening but isn't is due to a bug and

431
00:18:11,600 --> 00:18:17,659
not due to your<font color="#E5E5E5"> miss configuration and</font>

432
00:18:13,100 --> 00:18:20,389
it will probably<font color="#CCCCCC"> only take you about you</font>

433
00:18:17,660 --> 00:18:22,160
<font color="#E5E5E5">know five different routers or you know</font>

434
00:18:20,390 --> 00:18:24,890
20 tickets or something<font color="#CCCCCC"> until you</font><font color="#E5E5E5"> find</font>

435
00:18:22,160 --> 00:18:26,240
the first bug but if you know what

436
00:18:24,890 --> 00:18:28,010
should be happening routing is

437
00:18:26,240 --> 00:18:29,990
deterministic there's no magic man and

438
00:18:28,010 --> 00:18:31,730
the router making stuff go one way<font color="#CCCCCC"> or</font>

439
00:18:29,990 --> 00:18:33,740
the other if<font color="#CCCCCC"> a link fills up is</font><font color="#E5E5E5"> just</font>

440
00:18:31,730 --> 00:18:35,780
going to<font color="#E5E5E5"> sit</font><font color="#CCCCCC"> there pegged unless you get</font>

441
00:18:33,740 --> 00:18:39,440
so unless<font color="#CCCCCC"> it stays so pegged that</font>

442
00:18:35,780 --> 00:18:41,960
<font color="#E5E5E5">routing protocols can't even run so why</font>

443
00:18:39,440 --> 00:18:43,070
does BGP have the a s<font color="#CCCCCC"> path will actually</font>

444
00:18:41,960 --> 00:18:46,280
talk a little bit about what's inside

445
00:18:43,070 --> 00:18:49,490
the route this was not immediately<font color="#E5E5E5"> clear</font>

446
00:18:46,280 --> 00:18:50,840
to me all the reasons why<font color="#E5E5E5"> you needed to</font>

447
00:18:49,490 --> 00:18:52,940
have at a s path until I actually

448
00:18:50,840 --> 00:18:54,020
started looking at<font color="#CCCCCC"> Confederations and</font>

449
00:18:52,940 --> 00:18:56,090
route reflectors and some of the

450
00:18:54,020 --> 00:18:58,100
advanced scaling stuff the first thing

451
00:18:56,090 --> 00:19:00,230
<font color="#CCCCCC">is without the a s path there'd be no</font>

452
00:18:58,100 --> 00:19:01,580
way to do loop detection so first

453
00:19:00,230 --> 00:19:03,620
fundamental reason design<font color="#E5E5E5"> of the</font>

454
00:19:01,580 --> 00:19:05,629
protocol the autonomous system path

455
00:19:03,620 --> 00:19:07,429
which is the autonomous system numbers

456
00:19:05,630 --> 00:19:10,820
that get built up<font color="#E5E5E5"> as the rapture versus</font>

457
00:19:07,430 --> 00:19:14,300
let you do loop detection in internal

458
00:19:10,820 --> 00:19:15,770
<font color="#CCCCCC">BGP you don't actually</font><font color="#E5E5E5"> put your AAS on</font>

459
00:19:14,300 --> 00:19:18,020
it and so they're separate there's a

460
00:19:15,770 --> 00:19:20,270
rule that gets a little bit confusing

461
00:19:18,020 --> 00:19:23,420
which will go into about what routes can

462
00:19:20,270 --> 00:19:26,190
go where and that rule exists mainly

463
00:19:23,420 --> 00:19:28,270
because there's no AAS path to do loop

464
00:19:26,190 --> 00:19:30,640
second thing again we talked about<font color="#E5E5E5"> when</font>

465
00:19:28,270 --> 00:19:32,770
BGP came about it was<font color="#E5E5E5"> in this world of</font>

466
00:19:30,640 --> 00:19:35,860
policy routing which doesn't mean what

467
00:19:32,770 --> 00:19:37,600
we mean now by policy but you know<font color="#E5E5E5"> what</font>

468
00:19:35,860 --> 00:19:40,330
routes are allowed on what network and

469
00:19:37,600 --> 00:19:41,830
so setting policy you<font color="#E5E5E5"> can say either</font>

470
00:19:40,330 --> 00:19:43,689
because there's a problem<font color="#E5E5E5"> you're trying</font>

471
00:19:41,830 --> 00:19:45,040
to<font color="#E5E5E5"> get around or because you don't</font><font color="#CCCCCC"> want</font>

472
00:19:43,690 --> 00:19:49,210
certain routes to go somewhere<font color="#CCCCCC"> you can</font>

473
00:19:45,040 --> 00:19:51,639
say if the route has this you know was a

474
00:19:49,210 --> 00:19:53,620
sprint route heard from you you net then

475
00:19:51,640 --> 00:19:55,540
<font color="#CCCCCC">de preference it or drop it or do</font>

476
00:19:53,620 --> 00:19:57,549
something else with<font color="#E5E5E5"> it and when you're</font>

477
00:19:55,540 --> 00:19:58,990
routing fuga fuga rose you can actually

478
00:19:57,549 --> 00:20:01,270
<font color="#E5E5E5">look at the routing table and you'll</font>

479
00:19:58,990 --> 00:20:03,010
know the AAS numbers and you can

480
00:20:01,270 --> 00:20:06,520
actually pretty simply inspect what's

481
00:20:03,010 --> 00:20:09,940
going on as you make changes hello pgp

482
00:20:06,520 --> 00:20:11,770
and is is we have these hockey pucks

483
00:20:09,940 --> 00:20:13,090
that<font color="#E5E5E5"> are the routers we have clouds that</font>

484
00:20:11,770 --> 00:20:16,210
are the networks and you've got

485
00:20:13,090 --> 00:20:20,559
different networks exchanging traffic

486
00:20:16,210 --> 00:20:21,790
via different links now in<font color="#E5E5E5"> general most</font>

487
00:20:20,559 --> 00:20:24,399
of these networks would<font color="#E5E5E5"> have more than</font>

488
00:20:21,790 --> 00:20:26,649
one router but again to<font color="#CCCCCC"> BGP it's all one</font>

489
00:20:24,400 --> 00:20:28,900
it's all wanna a s it's one

490
00:20:26,650 --> 00:20:30,010
representative even if you talk to that

491
00:20:28,900 --> 00:20:34,570
network via multiple different

492
00:20:30,010 --> 00:20:36,970
connections so more concepts in BGP the

493
00:20:34,570 --> 00:20:40,049
peering sessions the the way that the

494
00:20:36,970 --> 00:20:42,910
routers talk to each other<font color="#E5E5E5"> or over tcp /</font>

495
00:20:40,049 --> 00:20:44,918
pairing sessions there's<font color="#E5E5E5"> keep alives at</font>

496
00:20:42,910 --> 00:20:48,190
the<font color="#CCCCCC"> TCP level but also there's a BGP</font>

497
00:20:44,919 --> 00:20:51,669
message that<font color="#E5E5E5"> is it keep alive inside the</font>

498
00:20:48,190 --> 00:20:53,530
routes it's just a<font color="#E5E5E5"> pretty flexible set</font>

499
00:20:51,669 --> 00:20:56,830
of these<font color="#E5E5E5"> things called attributes so the</font>

500
00:20:53,530 --> 00:20:58,059
route is a little mini database and it's

501
00:20:56,830 --> 00:21:00,309
got things like what are the IP address

502
00:20:58,059 --> 00:21:01,540
<font color="#E5E5E5">what's the alt on the system path and</font>

503
00:21:00,309 --> 00:21:03,250
then it's got other attributes that

504
00:21:01,540 --> 00:21:04,928
<font color="#CCCCCC">we'll talk about</font><font color="#E5E5E5"> and one of the nice</font>

505
00:21:03,250 --> 00:21:07,840
things about the<font color="#CCCCCC"> structure is you can</font>

506
00:21:04,929 --> 00:21:10,750
actually<font color="#E5E5E5"> extend those in well-known ways</font>

507
00:21:07,840 --> 00:21:13,270
or if you want to make your<font color="#CCCCCC"> own</font>

508
00:21:10,750 --> 00:21:14,470
attributes and send your pgp key in it

509
00:21:13,270 --> 00:21:16,299
or something like that<font color="#E5E5E5"> you could do</font><font color="#CCCCCC"> that</font>

510
00:21:14,470 --> 00:21:19,330
too it used to be easier<font color="#CCCCCC"> to do that</font>

511
00:21:16,299 --> 00:21:20,950
<font color="#E5E5E5">without breaking the internet now more</font>

512
00:21:19,330 --> 00:21:23,889
and more routing vendors have started

513
00:21:20,950 --> 00:21:27,700
reading rfcs so it becomes less possible

514
00:21:23,890 --> 00:21:30,250
<font color="#E5E5E5">send wonky stuff in BDA but</font><font color="#CCCCCC"> BGP has been</font>

515
00:21:27,700 --> 00:21:31,540
extended for ipv6 and multicast and some

516
00:21:30,250 --> 00:21:34,450
other<font color="#CCCCCC"> things that</font><font color="#E5E5E5"> it wasn't originally</font>

517
00:21:31,540 --> 00:21:37,000
designed for because it's very because

518
00:21:34,450 --> 00:21:39,500
the attributes can be easily at

519
00:21:37,000 --> 00:21:43,340
another thing that's important in BGP is

520
00:21:39,500 --> 00:21:46,190
only one best route for any given prefix

521
00:21:43,340 --> 00:21:49,610
in any given time what what<font color="#E5E5E5"> does</font><font color="#CCCCCC"> that</font>

522
00:21:46,190 --> 00:21:52,549
mean well early on I had a customer I

523
00:21:49,610 --> 00:21:55,309
was connected to sprint and uni-net call

524
00:21:52,549 --> 00:21:58,250
them and<font color="#E5E5E5"> a customer of mine said I only</font>

525
00:21:55,309 --> 00:22:01,520
want I want<font color="#CCCCCC"> a full routing table but</font>

526
00:21:58,250 --> 00:22:03,620
only of sprint routes well you can't do

527
00:22:01,520 --> 00:22:05,360
that unless you're writing your own

528
00:22:03,620 --> 00:22:08,000
unless you're doing<font color="#E5E5E5"> really weird Richard</font>

529
00:22:05,360 --> 00:22:10,580
level bizarre things with routers you

530
00:22:08,000 --> 00:22:11,929
can't really<font color="#E5E5E5"> do that because if I'm</font>

531
00:22:10,580 --> 00:22:15,139
going to multi if I'm going to load

532
00:22:11,929 --> 00:22:16,820
balance my traffic then I'm going to

533
00:22:15,140 --> 00:22:18,559
<font color="#E5E5E5">have half my routes from provider a and</font>

534
00:22:16,820 --> 00:22:22,549
half my routes from provider big but I'm

535
00:22:18,559 --> 00:22:24,559
<font color="#E5E5E5">only allowed to send the best path there</font>

536
00:22:22,549 --> 00:22:27,110
were the best path to that prefix so if

537
00:22:24,559 --> 00:22:29,330
half of my routes let's say from you net

538
00:22:27,110 --> 00:22:31,668
and sprint half of them<font color="#E5E5E5"> from union at I</font>

539
00:22:29,330 --> 00:22:33,230
<font color="#E5E5E5">can</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> can only send I can say only send</font>

540
00:22:31,669 --> 00:22:34,880
<font color="#CCCCCC">Union it routes but then I'm only going</font>

541
00:22:33,230 --> 00:22:37,280
<font color="#E5E5E5">to send that person half the routes and</font>

542
00:22:34,880 --> 00:22:39,290
that's really important and it comes up

543
00:22:37,280 --> 00:22:41,750
again and again in BGP you could only

544
00:22:39,290 --> 00:22:43,059
send<font color="#E5E5E5"> the best route if you could send</font>

545
00:22:41,750 --> 00:22:45,700
routes that<font color="#CCCCCC"> we're not</font><font color="#E5E5E5"> the best route</font>

546
00:22:43,059 --> 00:22:48,049
that way lies<font color="#E5E5E5"> madness or at least</font>

547
00:22:45,700 --> 00:22:49,820
massive looping of packets all over the

548
00:22:48,049 --> 00:22:50,990
place which we try to<font color="#E5E5E5"> avoid which is</font>

549
00:22:49,820 --> 00:22:54,168
another reason why when we talk about

550
00:22:50,990 --> 00:22:57,470
weight will tell you not to use that bgp

551
00:22:54,169 --> 00:23:00,890
weights so the best route is the one

552
00:22:57,470 --> 00:23:03,140
that you can send another interesting

553
00:23:00,890 --> 00:23:05,330
thing for debugging the best BGP route

554
00:23:03,140 --> 00:23:07,010
is not necessarily<font color="#E5E5E5"> the route that the</font>

555
00:23:05,330 --> 00:23:08,780
router is using because there are

556
00:23:07,010 --> 00:23:12,290
multiple different routing tables in<font color="#CCCCCC"> the</font>

557
00:23:08,780 --> 00:23:14,780
router so you can send the best BGP

558
00:23:12,290 --> 00:23:16,428
route but of course you<font color="#E5E5E5"> may have</font><font color="#CCCCCC"> direct</font>

559
00:23:14,780 --> 00:23:19,220
<font color="#CCCCCC">connection to something that overrides</font>

560
00:23:16,429 --> 00:23:22,250
the routing table the<font color="#CCCCCC"> the external route</font>

561
00:23:19,220 --> 00:23:25,220
and then you know that<font color="#CCCCCC"> maybe</font><font color="#E5E5E5"> the route</font>

562
00:23:22,250 --> 00:23:27,980
you're using but in BGP land it will<font color="#CCCCCC"> it</font>

563
00:23:25,220 --> 00:23:31,040
will be completely<font color="#E5E5E5"> agnostic to that so</font>

564
00:23:27,980 --> 00:23:33,679
with bgp<font color="#E5E5E5"> i turn up a session and then</font>

565
00:23:31,040 --> 00:23:36,590
all the best routes are exchanged then

566
00:23:33,679 --> 00:23:39,590
<font color="#E5E5E5">over time just the changes get exchanged</font>

567
00:23:36,590 --> 00:23:40,970
so turn up a session and with ebgp which

568
00:23:39,590 --> 00:23:43,730
we'll talk about<font color="#CCCCCC"> i'm going</font><font color="#E5E5E5"> to try to</font>

569
00:23:40,970 --> 00:23:46,100
send<font color="#CCCCCC"> you whether your my customer my</font>

570
00:23:43,730 --> 00:23:48,179
peer i'm<font color="#E5E5E5"> going to send you every route</font>

571
00:23:46,100 --> 00:23:52,289
that I have or more

572
00:23:48,179 --> 00:23:53,970
every for every BGP route that I have

573
00:23:52,289 --> 00:23:55,860
the best path that's what I'm going<font color="#CCCCCC"> to</font>

574
00:23:53,970 --> 00:23:57,809
<font color="#E5E5E5">try to send you</font><font color="#CCCCCC"> a copy of through</font>

575
00:23:55,860 --> 00:23:59,459
whatever filters I have that<font color="#E5E5E5"> it will</font>

576
00:23:57,809 --> 00:24:02,639
make it<font color="#CCCCCC"> through whatever filters you</font>

577
00:23:59,460 --> 00:24:04,409
have so if you take<font color="#CCCCCC"> a session down</font><font color="#E5E5E5"> and</font>

578
00:24:02,639 --> 00:24:06,360
then bring it back<font color="#CCCCCC"> up again that whole</font>

579
00:24:04,409 --> 00:24:08,129
process<font color="#E5E5E5"> starts again and we'll talk</font>

580
00:24:06,360 --> 00:24:10,769
about this a<font color="#CCCCCC"> little</font><font color="#E5E5E5"> bit but that's a</font>

581
00:24:08,129 --> 00:24:14,549
very bad thing to have happen you really

582
00:24:10,769 --> 00:24:17,519
want<font color="#E5E5E5"> to avoid</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> so basically what</font>

583
00:24:14,549 --> 00:24:18,869
happens is every time<font color="#E5E5E5"> I send URL you</font>

584
00:24:17,519 --> 00:24:21,720
have to look<font color="#E5E5E5"> at it and say is this the</font>

585
00:24:18,869 --> 00:24:23,490
<font color="#E5E5E5">new vest BGP route and if it is send it</font>

586
00:24:21,720 --> 00:24:25,200
to more routing tables in your router

587
00:24:23,490 --> 00:24:27,210
and then send<font color="#E5E5E5"> it to the line cards in</font>

588
00:24:25,200 --> 00:24:29,100
your router and then if it was the best

589
00:24:27,210 --> 00:24:30,299
BGP route and you<font color="#CCCCCC"> advertised the other</font>

590
00:24:29,100 --> 00:24:33,090
route you need to send it to all your

591
00:24:30,299 --> 00:24:34,799
peers in this<font color="#CCCCCC"> cascades</font><font color="#E5E5E5"> and so there's a</font>

592
00:24:33,090 --> 00:24:37,049
lot<font color="#CCCCCC"> of work that's</font><font color="#E5E5E5"> gone into BGP to make</font>

593
00:24:34,799 --> 00:24:39,210
sure that you don't take sessions up and

594
00:24:37,049 --> 00:24:44,879
down and changes the policy can be

595
00:24:39,210 --> 00:24:47,249
propagated just incrementally so inside

596
00:24:44,879 --> 00:24:48,809
the router basically you can think<font color="#E5E5E5"> of it</font>

597
00:24:47,249 --> 00:24:51,960
as following I apologize for<font color="#E5E5E5"> not having</font>

598
00:24:48,809 --> 00:24:54,899
a fancy diagram there's routing table

599
00:24:51,960 --> 00:24:56,850
specific routing routing tables routing

600
00:24:54,899 --> 00:25:01,049
protocol specific routing tables so BGP

601
00:24:56,850 --> 00:25:03,658
has a routing table the best route from

602
00:25:01,049 --> 00:25:05,220
BGP makes it then down into a big IP

603
00:25:03,659 --> 00:25:06,659
routing table now you've lost

604
00:25:05,220 --> 00:25:08,610
information when that happens you don't

605
00:25:06,659 --> 00:25:10,679
keep the autonomous system path you

606
00:25:08,610 --> 00:25:13,379
don't keep the origin the things from

607
00:25:10,679 --> 00:25:15,480
BGP get it get wiped and you have the IP

608
00:25:13,379 --> 00:25:17,248
routing table and there's some concept

609
00:25:15,480 --> 00:25:19,679
of where<font color="#E5E5E5"> that came from then there's</font>

610
00:25:17,249 --> 00:25:21,809
more of a forwarding table and the exact

611
00:25:19,679 --> 00:25:22,919
implementation depends on what router

612
00:25:21,809 --> 00:25:24,809
you're using<font color="#E5E5E5"> but then there's a</font>

613
00:25:22,919 --> 00:25:26,610
forwarding table and then that may or

614
00:25:24,809 --> 00:25:28,590
may<font color="#CCCCCC"> not get distributed to the</font>

615
00:25:26,610 --> 00:25:31,379
forwarding tables on the line cards of

616
00:25:28,590 --> 00:25:34,408
the<font color="#E5E5E5"> device so the</font><font color="#CCCCCC"> best BGP route was</font>

617
00:25:31,379 --> 00:25:36,658
actually causing the packets or to flow

618
00:25:34,409 --> 00:25:38,309
within your router isn't itself a BGP

619
00:25:36,659 --> 00:25:40,619
route but it's a BGP route that became

620
00:25:38,309 --> 00:25:43,408
an IP routing table route that went in

621
00:25:40,619 --> 00:25:46,080
and became a forwarding table round so

622
00:25:43,409 --> 00:25:48,299
each time you get a BGP update and

623
00:25:46,080 --> 00:25:50,129
something changes this more work that

624
00:25:48,299 --> 00:25:51,990
has to happen within the router which is

625
00:25:50,129 --> 00:25:55,139
why even the router<font color="#E5E5E5"> CPUs are very fast</font>

626
00:25:51,990 --> 00:25:57,179
there's<font color="#E5E5E5"> still some scalability issues</font>

627
00:25:55,139 --> 00:25:58,939
and you don't really want a very dynamic

628
00:25:57,179 --> 00:26:00,680
network in terms of route

629
00:25:58,940 --> 00:26:03,320
updates or you can have problems<font color="#E5E5E5"> and</font>

630
00:26:00,680 --> 00:26:05,900
every<font color="#CCCCCC"> time a route flows downwards it</font>

631
00:26:03,320 --> 00:26:07,540
gets more not more specific in terms of

632
00:26:05,900 --> 00:26:10,520
number IP addresses but more and more

633
00:26:07,540 --> 00:26:11,840
context is lost so that the line card

634
00:26:10,520 --> 00:26:13,160
doesn't need even to know where the

635
00:26:11,840 --> 00:26:16,909
route came from it just<font color="#CCCCCC"> needs to know</font>

636
00:26:13,160 --> 00:26:19,160
from here<font color="#E5E5E5"> to there so basic bgp</font>

637
00:26:16,910 --> 00:26:22,130
configuration you're<font color="#E5E5E5"> going to have an IP</font>

638
00:26:19,160 --> 00:26:23,750
address<font color="#CCCCCC"> on an interface you've got a</font>

639
00:26:22,130 --> 00:26:25,610
network that you want to<font color="#E5E5E5"> announce we'll</font>

640
00:26:23,750 --> 00:26:27,530
talk about we'll talk<font color="#E5E5E5"> about</font><font color="#CCCCCC"> some</font><font color="#E5E5E5"> more</font>

641
00:26:25,610 --> 00:26:29,830
concepts about this but<font color="#CCCCCC"> i thought people</font>

642
00:26:27,530 --> 00:26:32,300
<font color="#CCCCCC">would like to</font><font color="#E5E5E5"> see a basic configuration</font>

643
00:26:29,830 --> 00:26:34,429
you've got an out that you want<font color="#CCCCCC"> to</font>

644
00:26:32,300 --> 00:26:36,379
create in BGP that's the network

645
00:26:34,430 --> 00:26:38,090
statement there's someone you're going

646
00:26:36,380 --> 00:26:40,400
to pier with<font color="#CCCCCC"> there'll be</font><font color="#E5E5E5"> some</font><font color="#CCCCCC"> other</font>

647
00:26:38,090 --> 00:26:42,770
things<font color="#E5E5E5"> that you'll you'll enter as as</font>

648
00:26:40,400 --> 00:26:44,510
neighbor statements as well and the one

649
00:26:42,770 --> 00:26:46,340
<font color="#E5E5E5">thing you should always be thinking of</font>

650
00:26:44,510 --> 00:26:47,810
is filtering out download filtering

651
00:26:46,340 --> 00:26:49,550
inbound you're going to send<font color="#E5E5E5"> your routes</font>

652
00:26:47,810 --> 00:26:52,790
out and you've<font color="#E5E5E5"> got some bogans that you</font>

653
00:26:49,550 --> 00:26:55,070
don't want to<font color="#E5E5E5"> get in bogans in the</font>

654
00:26:52,790 --> 00:26:56,930
generally accepted term you know IP

655
00:26:55,070 --> 00:26:59,480
addresses that shouldn't be seen on<font color="#E5E5E5"> the</font>

656
00:26:56,930 --> 00:27:02,780
internet but when you're<font color="#CCCCCC"> talking to</font><font color="#E5E5E5"> an</font>

657
00:26:59,480 --> 00:27:04,280
external provider or you're talking to

658
00:27:02,780 --> 00:27:05,629
an external provider you<font color="#E5E5E5"> actually also</font>

659
00:27:04,280 --> 00:27:07,790
want to make sure for<font color="#E5E5E5"> example that they</font>

660
00:27:05,630 --> 00:27:09,860
don't advertise you your own address

661
00:27:07,790 --> 00:27:11,360
space and the reason that this is

662
00:27:09,860 --> 00:27:14,090
important is actually because of a<font color="#E5E5E5"> s</font>

663
00:27:11,360 --> 00:27:16,550
<font color="#E5E5E5">7007 there was an incident and by the</font>

664
00:27:14,090 --> 00:27:18,860
way is 7007 still allocated or someone

665
00:27:16,550 --> 00:27:22,070
some poor soul about to actually<font color="#CCCCCC"> get it</font>

666
00:27:18,860 --> 00:27:24,110
get it allocated from<font color="#CCCCCC"> aaron oh he does</font>

667
00:27:22,070 --> 00:27:27,230
okay good because<font color="#E5E5E5"> I can just imagine</font>

668
00:27:24,110 --> 00:27:28,639
<font color="#E5E5E5">some poor provider about to get it so AF</font>

669
00:27:27,230 --> 00:27:32,060
<font color="#E5E5E5">seven thousand seven blew up the</font>

670
00:27:28,640 --> 00:27:34,220
<font color="#E5E5E5">internet one day</font><font color="#CCCCCC"> by does anyone everyone</font>

671
00:27:32,060 --> 00:27:37,190
<font color="#E5E5E5">raise your hand if you remember classful</font>

672
00:27:34,220 --> 00:27:39,530
addressing internet interesting<font color="#CCCCCC"> okay so</font>

673
00:27:37,190 --> 00:27:42,110
basically redistributed bgp for through

674
00:27:39,530 --> 00:27:46,250
rip v1 now what<font color="#E5E5E5"> happens when you take a</font>

675
00:27:42,110 --> 00:27:48,320
17-4 v1 is it either becomes a 24 or 16

676
00:27:46,250 --> 00:27:50,540
or<font color="#E5E5E5"> an eight right it becomes that</font>

677
00:27:48,320 --> 00:27:52,250
<font color="#E5E5E5">information is lost it becomes whatever</font>

678
00:27:50,540 --> 00:27:55,040
the network number indicates the length

679
00:27:52,250 --> 00:27:58,160
should be then when you put it back so<font color="#CCCCCC"> I</font>

680
00:27:55,040 --> 00:27:59,870
was<font color="#CCCCCC"> in a data center and a customer of</font>

681
00:27:58,160 --> 00:28:04,970
<font color="#E5E5E5">mine called me and said why are you</font>

682
00:27:59,870 --> 00:28:08,239
advertising me a 24 when I'm advertising

683
00:28:04,970 --> 00:28:09,320
you at 23 and who's this a/s 7007 that's

684
00:28:08,240 --> 00:28:11,450
originating it

685
00:28:09,320 --> 00:28:13,879
and I actually happen to know at the

686
00:28:11,450 --> 00:28:15,500
time who 7007 was and called him to find

687
00:28:13,880 --> 00:28:18,529
<font color="#E5E5E5">out what</font><font color="#CCCCCC"> was going on what's happening</font>

688
00:28:15,500 --> 00:28:22,039
was<font color="#E5E5E5"> BGP for went to Bert v1 which went</font>

689
00:28:18,529 --> 00:28:24,830
back to be GPA so the 23 was in 192 or

690
00:28:22,039 --> 00:28:26,929
greater became a Class C then got put

691
00:28:24,830 --> 00:28:30,199
back in as a 24<font color="#E5E5E5"> and then redistributed</font>

692
00:28:26,929 --> 00:28:32,480
through sprint so<font color="#E5E5E5"> network hygiene don't</font>

693
00:28:30,200 --> 00:28:34,820
accept anything in your<font color="#E5E5E5"> address in your</font>

694
00:28:32,480 --> 00:28:36,350
routing table from<font color="#CCCCCC"> the outside what that</font>

695
00:28:34,820 --> 00:28:39,379
means is<font color="#E5E5E5"> when you have a customer</font><font color="#CCCCCC"> that</font>

696
00:28:36,350 --> 00:28:41,330
is<font color="#E5E5E5"> going to multi home it actually then</font>

697
00:28:39,380 --> 00:28:43,340
is when you should<font color="#E5E5E5"> put a</font><font color="#CCCCCC"> hole you</font><font color="#E5E5E5"> should</font>

698
00:28:41,330 --> 00:28:45,168
change your filter to allow that address

699
00:28:43,340 --> 00:28:47,059
space in so<font color="#E5E5E5"> that you can still get to</font>

700
00:28:45,169 --> 00:28:52,570
them if their connection to you goes

701
00:28:47,059 --> 00:28:56,720
down<font color="#E5E5E5"> so highly recommended so we have</font>

702
00:28:52,570 --> 00:29:01,189
routes that talk about<font color="#E5E5E5"> connectivity that</font>

703
00:28:56,720 --> 00:29:04,580
<font color="#E5E5E5">happen inside peering sessions over tcp</font>

704
00:29:01,190 --> 00:29:06,740
between networks so inside every<font color="#CCCCCC"> route</font>

705
00:29:04,580 --> 00:29:08,960
is a bunch of attributes and again

706
00:29:06,740 --> 00:29:10,700
number of attributes grows as our

707
00:29:08,960 --> 00:29:12,649
flexibility what we want to do with BGP

708
00:29:10,700 --> 00:29:14,990
grows so the prefix is the fundamental

709
00:29:12,649 --> 00:29:21,110
thing its starting point<font color="#CCCCCC"> internet mask</font>

710
00:29:14,990 --> 00:29:23,629
or a length through second through two

711
00:29:21,110 --> 00:29:26,389
major<font color="#E5E5E5"> one AAS path so it's the sequence</font>

712
00:29:23,629 --> 00:29:28,699
of autonomous systems each with an<font color="#CCCCCC"> asn</font>

713
00:29:26,389 --> 00:29:32,750
that the route has traversed lets you do

714
00:29:28,700 --> 00:29:35,679
loop detection my policy and the<font color="#CCCCCC"> AAS is</font>

715
00:29:32,750 --> 00:29:39,470
stamped on the way out which means that

716
00:29:35,679 --> 00:29:41,750
inside your network your routes actually

717
00:29:39,470 --> 00:29:43,399
have the null<font color="#CCCCCC"> asp well not null but</font>

718
00:29:41,750 --> 00:29:45,710
they're empty and in some

719
00:29:43,399 --> 00:29:48,080
implementations they may be no so in reg

720
00:29:45,710 --> 00:29:49,580
ex speak it's carrot dollar sign there's

721
00:29:48,080 --> 00:29:51,439
start at the beginning go to the<font color="#E5E5E5"> end</font>

722
00:29:49,580 --> 00:29:53,658
<font color="#E5E5E5">nothing in the middle that's your routes</font>

723
00:29:51,440 --> 00:29:55,879
inside your network when you advertise

724
00:29:53,659 --> 00:29:57,289
them to someone<font color="#E5E5E5"> else that's when the</font><font color="#CCCCCC"> a s</font>

725
00:29:55,879 --> 00:30:02,178
goes on and then they see it and they

726
00:29:57,289 --> 00:30:04,039
can tag by your AAS so one thing to note

727
00:30:02,179 --> 00:30:06,769
there's now bigger autonomous system

728
00:30:04,039 --> 00:30:08,029
numbers and you may see them there are a

729
00:30:06,769 --> 00:30:11,029
lot of routers out there that don't

730
00:30:08,029 --> 00:30:14,059
actually<font color="#E5E5E5"> support them yet and at</font><font color="#CCCCCC"> some</font>

731
00:30:11,029 --> 00:30:16,279
point when we finish allocating all the

732
00:30:14,059 --> 00:30:18,950
returned<font color="#CCCCCC"> Ethon</font><font color="#E5E5E5"> list of numbers that</font><font color="#CCCCCC"> will</font>

733
00:30:16,279 --> 00:30:21,420
become pretty important so but if you're

734
00:30:18,950 --> 00:30:23,120
using major router vendor whatever your

735
00:30:21,420 --> 00:30:26,250
publications will probably support<font color="#E5E5E5"> that</font>

736
00:30:23,120 --> 00:30:31,429
in the a s range in the lower a s phase

737
00:30:26,250 --> 00:30:35,070
0<font color="#CCCCCC"> & 6</font><font color="#E5E5E5"> by 536 are</font><font color="#CCCCCC"> reserved we found that</font>

738
00:30:31,430 --> 00:30:36,660
<font color="#CCCCCC">zero the question of whether</font><font color="#E5E5E5"> zero was</font>

739
00:30:35,070 --> 00:30:40,230
reserved or not came up with one of<font color="#E5E5E5"> the</font>

740
00:30:36,660 --> 00:30:41,640
first big bgp blow-ups when they s0

741
00:30:40,230 --> 00:30:44,070
leaked onto the internet and people that

742
00:30:41,640 --> 00:30:46,790
did read<font color="#CCCCCC"> rfcs said invalid and people</font>

743
00:30:44,070 --> 00:30:51,120
<font color="#E5E5E5">that didn't said hey that's okay and</font>

744
00:30:46,790 --> 00:30:54,240
then there's a range 645 1226 5534 that

745
00:30:51,120 --> 00:30:56,459
are for use internally now there are

746
00:30:54,240 --> 00:30:57,840
cases where you'll use that to<font color="#E5E5E5"> talk to</font>

747
00:30:56,460 --> 00:31:00,630
another provider let's say you want to

748
00:30:57,840 --> 00:31:02,669
multi home to the same provider and you

749
00:31:00,630 --> 00:31:04,800
want to be able to change how your

750
00:31:02,670 --> 00:31:07,920
addresses are announced to them you may

751
00:31:04,800 --> 00:31:10,950
actually grab an AS that is actually

752
00:31:07,920 --> 00:31:13,410
<font color="#E5E5E5">that should be 65535 you only want to</font>

753
00:31:10,950 --> 00:31:14,670
grab an ass and use it for bgp but not

754
00:31:13,410 --> 00:31:18,330
have<font color="#CCCCCC"> it be seen</font><font color="#E5E5E5"> by the internet and then</font>

755
00:31:14,670 --> 00:31:20,640
you use a reserve<font color="#CCCCCC"> autonomous system so</font>

756
00:31:18,330 --> 00:31:22,260
when your pattern matching carrot means

757
00:31:20,640 --> 00:31:24,540
match beginning dollar means match the

758
00:31:22,260 --> 00:31:26,400
end so the the null is path the mtas

759
00:31:24,540 --> 00:31:27,780
path is carried dollar sign so if you

760
00:31:26,400 --> 00:31:32,570
want<font color="#E5E5E5"> to see your rel through type show</font>

761
00:31:27,780 --> 00:31:35,399
IP bgp reg<font color="#CCCCCC"> carrot dollar sign so a</font>

762
00:31:32,570 --> 00:31:39,689
sprint customer would see an N layer

763
00:31:35,400 --> 00:31:42,780
originated route carrot 1239 space for

764
00:31:39,690 --> 00:31:44,900
<font color="#CCCCCC">four</font><font color="#E5E5E5"> thirty-six dollar sign or if you</font>

765
00:31:42,780 --> 00:31:47,820
wanted<font color="#E5E5E5"> to match anything that was in</font>

766
00:31:44,900 --> 00:31:52,140
4436 you put an underscore instead of

767
00:31:47,820 --> 00:31:54,330
the dollar sign but when sprint is

768
00:31:52,140 --> 00:31:56,220
looking at that route internally you

769
00:31:54,330 --> 00:32:00,480
wouldn't see the 1239 it would<font color="#E5E5E5"> just see</font>

770
00:31:56,220 --> 00:32:02,820
4436<font color="#E5E5E5"> I heard it from 4436 if you want to</font>

771
00:32:00,480 --> 00:32:05,400
match one important thing about regular

772
00:32:02,820 --> 00:32:09,330
expressions in cisco speak if you do

773
00:32:05,400 --> 00:32:12,450
show IP bgp reg and just type 701 you'll

774
00:32:09,330 --> 00:32:14,520
see 7018 routes also its ASCII wise

775
00:32:12,450 --> 00:32:17,520
matching not treating the numbers as

776
00:32:14,520 --> 00:32:18,960
numbers so you<font color="#CCCCCC"> should</font><font color="#E5E5E5"> always you'll use</font>

777
00:32:17,520 --> 00:32:21,930
a carrot a dollar sign or just

778
00:32:18,960 --> 00:32:23,990
underscore means beginning or end means

779
00:32:21,930 --> 00:32:26,370
it could be the beginning the end or

780
00:32:23,990 --> 00:32:29,730
it's not<font color="#E5E5E5"> really a space but you know a</font>

781
00:32:26,370 --> 00:32:32,870
breaker so show IP bgp reg underscore

782
00:32:29,730 --> 00:32:36,950
<font color="#E5E5E5">701 underscore would match 701 anywhere</font>

783
00:32:32,870 --> 00:32:38,360
in there but only the number 701 another

784
00:32:36,950 --> 00:32:41,480
attribute which will sort of skip over

785
00:32:38,360 --> 00:32:44,149
for now next top attribute that says how

786
00:32:41,480 --> 00:32:48,010
<font color="#E5E5E5">I get there this becomes more important</font>

787
00:32:44,150 --> 00:32:51,440
with more with larger internal networks

788
00:32:48,010 --> 00:32:53,059
with internal<font color="#CCCCCC"> bgp routing there's</font>

789
00:32:51,440 --> 00:32:55,250
actually a little bit of recursion that

790
00:32:53,059 --> 00:32:58,460
will normally go on where the routers

791
00:32:55,250 --> 00:33:00,320
will peer with each other either using a

792
00:32:58,460 --> 00:33:03,410
physical interface or hopefully<font color="#CCCCCC"> using a</font>

793
00:33:00,320 --> 00:33:06,169
loopback<font color="#E5E5E5"> / 32 that you use and the</font>

794
00:33:03,410 --> 00:33:08,420
internal routing protocol ospf for is is

795
00:33:06,170 --> 00:33:09,770
will describe to the routers how they

796
00:33:08,420 --> 00:33:12,860
can all get to each other at the low

797
00:33:09,770 --> 00:33:14,720
level and bgp is used to sort<font color="#E5E5E5"> of map the</font>

798
00:33:12,860 --> 00:33:17,330
<font color="#E5E5E5">superhighway wrote you know to get to</font>

799
00:33:14,720 --> 00:33:19,309
this external space go to that router

800
00:33:17,330 --> 00:33:22,460
but<font color="#E5E5E5"> bgp doesn't tell you how to get to</font>

801
00:33:19,309 --> 00:33:24,080
chicago's router the it tells<font color="#E5E5E5"> you</font><font color="#CCCCCC"> the IP</font>

802
00:33:22,460 --> 00:33:26,120
address of it and then a recursive

803
00:33:24,080 --> 00:33:28,850
lookup happens underneath it in that

804
00:33:26,120 --> 00:33:31,939
world<font color="#E5E5E5"> with ibgp you want to you want</font><font color="#CCCCCC"> to</font>

805
00:33:28,850 --> 00:33:34,309
have the next tops preserved with<font color="#E5E5E5"> bgp</font>

806
00:33:31,940 --> 00:33:36,290
with ebgp when you're talking bgp to

807
00:33:34,309 --> 00:33:40,129
other providers you generally<font color="#CCCCCC"> want to</font>

808
00:33:36,290 --> 00:33:41,450
have generally next top will be just

809
00:33:40,130 --> 00:33:42,620
someone that you're directly connected

810
00:33:41,450 --> 00:33:44,720
to but you generally want to say next

811
00:33:42,620 --> 00:33:46,370
stop self just to be sure that really

812
00:33:44,720 --> 00:33:49,070
<font color="#E5E5E5">mainly comes up in a case where you've</font>

813
00:33:46,370 --> 00:33:51,350
got like<font color="#E5E5E5"> a land and you've got a few</font>

814
00:33:49,070 --> 00:33:54,110
<font color="#CCCCCC">different people on the land and you</font>

815
00:33:51,350 --> 00:33:57,139
might<font color="#E5E5E5"> be peering with people and routes</font>

816
00:33:54,110 --> 00:33:59,059
get past amongst<font color="#E5E5E5"> them if you don't do</font>

817
00:33:57,140 --> 00:34:01,309
something what will happen<font color="#CCCCCC"> is you'll</font>

818
00:33:59,059 --> 00:34:03,320
hear the next<font color="#E5E5E5"> stop not for the router</font>

819
00:34:01,309 --> 00:34:04,610
that you talk to but for somebody else's

820
00:34:03,320 --> 00:34:08,120
router and you don't want it that's

821
00:34:04,610 --> 00:34:09,469
generally bad the<font color="#CCCCCC"> Med multi exit</font>

822
00:34:08,120 --> 00:34:10,940
discriminator again we're not going to

823
00:34:09,469 --> 00:34:14,060
talk a lot<font color="#E5E5E5"> about it here that's more of</font>

824
00:34:10,940 --> 00:34:16,790
a<font color="#E5E5E5"> BGP 102 topic it's a number that</font>

825
00:34:14,060 --> 00:34:18,830
someone<font color="#E5E5E5"> can put on a route in the mid</font>

826
00:34:16,790 --> 00:34:22,070
attribute that's designed to tell you

827
00:34:18,830 --> 00:34:23,509
how close or far<font color="#E5E5E5"> away that route is so</font>

828
00:34:22,070 --> 00:34:25,669
for example let's<font color="#E5E5E5"> say you appear with n</font>

829
00:34:23,510 --> 00:34:27,800
layer in three different cities you'll

830
00:34:25,668 --> 00:34:30,980
hear a different med a different metric

831
00:34:27,800 --> 00:34:34,129
on that number depending on how<font color="#CCCCCC"> close</font>

832
00:34:30,980 --> 00:34:36,590
the route is injected into<font color="#CCCCCC"> that</font><font color="#E5E5E5"> n layer</font>

833
00:34:34,129 --> 00:34:38,779
Network and the<font color="#CCCCCC"> original idea was sort</font>

834
00:34:36,590 --> 00:34:40,220
of that you'd take your<font color="#CCCCCC"> igp metric your</font>

835
00:34:38,780 --> 00:34:42,169
internal routing protocol<font color="#E5E5E5"> metric and</font>

836
00:34:40,219 --> 00:34:43,730
stick it there there are<font color="#E5E5E5"> a lot of</font>

837
00:34:42,168 --> 00:34:45,480
complexities that actually wound up

838
00:34:43,730 --> 00:34:49,010
coming up if you look up med

839
00:34:45,480 --> 00:34:53,369
flapping and instability over the<font color="#E5E5E5"> last</font>

840
00:34:49,010 --> 00:34:56,040
12 or 13 years because the<font color="#CCCCCC"> med only</font>

841
00:34:53,369 --> 00:34:57,600
means something within one provider you

842
00:34:56,040 --> 00:34:59,070
can't<font color="#E5E5E5"> compare one providers med to</font>

843
00:34:57,600 --> 00:35:01,200
another and when you do that those

844
00:34:59,070 --> 00:35:04,680
problems but and and you can also change

845
00:35:01,200 --> 00:35:06,149
the mid as you hear the route to be one

846
00:35:04,680 --> 00:35:07,379
<font color="#CCCCCC">of</font><font color="#E5E5E5"> the different knobs or twiddles that</font>

847
00:35:06,150 --> 00:35:09,180
you can do to prefer routes but

848
00:35:07,380 --> 00:35:11,580
generally we advise people to just stay

849
00:35:09,180 --> 00:35:13,950
away from the mid people starting of<font color="#E5E5E5"> the</font>

850
00:35:11,580 --> 00:35:15,450
people who are just<font color="#CCCCCC"> learning BGP how</font>

851
00:35:13,950 --> 00:35:20,939
many people have only<font color="#E5E5E5"> one router</font>

852
00:35:15,450 --> 00:35:24,930
speaking bgp in their network to less

853
00:35:20,940 --> 00:35:26,609
than<font color="#E5E5E5"> five more than five okay yeah I</font>

854
00:35:24,930 --> 00:35:28,080
clear<font color="#E5E5E5"> that we don't have complete</font>

855
00:35:26,609 --> 00:35:31,350
coverage of<font color="#E5E5E5"> the possibility space and</font>

856
00:35:28,080 --> 00:35:33,060
how many<font color="#E5E5E5"> people who are the intended</font>

857
00:35:31,350 --> 00:35:40,380
audience not<font color="#E5E5E5"> the hecklers are running</font>

858
00:35:33,060 --> 00:35:50,730
ospf in their network is is eigrp ibgp

859
00:35:40,380 --> 00:35:57,690
only okay so mostly ospf so me sorry<font color="#CCCCCC"> hmm</font>

860
00:35:50,730 --> 00:36:01,890
Oh rip v8 congratulations you can you

861
00:35:57,690 --> 00:36:03,869
could<font color="#E5E5E5"> become black holy oh I will not</font>

862
00:36:01,890 --> 00:36:05,730
use<font color="#E5E5E5"> rip v1 I will not use repeat what I</font>

863
00:36:03,869 --> 00:36:07,950
think most terminal servers already

864
00:36:05,730 --> 00:36:10,140
support only rip v2 I think movie one is

865
00:36:07,950 --> 00:36:12,060
pretty dead nowadays so another

866
00:36:10,140 --> 00:36:14,129
attribute you'll see is the origin don't

867
00:36:12,060 --> 00:36:15,900
worry about<font color="#E5E5E5"> it I'm one way you can think</font>

868
00:36:14,130 --> 00:36:18,210
<font color="#E5E5E5">about the BGP origin attribute is this</font>

869
00:36:15,900 --> 00:36:21,150
sort of like half of an AS path will

870
00:36:18,210 --> 00:36:23,190
talk about how routers select which path

871
00:36:21,150 --> 00:36:25,890
<font color="#E5E5E5">to the given destination is better and</font>

872
00:36:23,190 --> 00:36:27,090
origin is in there so if you want to<font color="#E5E5E5"> do</font>

873
00:36:25,890 --> 00:36:29,490
some twiddling you can occasionally

874
00:36:27,090 --> 00:36:31,260
change the origin<font color="#E5E5E5"> and that's actually</font>

875
00:36:29,490 --> 00:36:32,700
happened at the<font color="#CCCCCC"> end of a month when</font>

876
00:36:31,260 --> 00:36:35,430
people want more revenue they'll change

877
00:36:32,700 --> 00:36:38,279
the origin<font color="#CCCCCC"> to make more traffic flow</font>

878
00:36:35,430 --> 00:36:40,259
their way but generally like med you'll

879
00:36:38,280 --> 00:36:42,450
just sort of ignore this attribute for

880
00:36:40,260 --> 00:36:44,040
now wait attribute the main reason<font color="#E5E5E5"> I</font>

881
00:36:42,450 --> 00:36:46,618
mentioned this is that you<font color="#CCCCCC"> should not</font>

882
00:36:44,040 --> 00:36:48,960
use<font color="#E5E5E5"> it there are certain more exotic</font>

883
00:36:46,619 --> 00:36:50,820
cases where it's useful and certain

884
00:36:48,960 --> 00:36:52,560
complex reverse path filtering

885
00:36:50,820 --> 00:36:54,960
topologies where you need to get into<font color="#CCCCCC"> it</font>

886
00:36:52,560 --> 00:36:58,410
the interesting thing with the weight

887
00:36:54,960 --> 00:36:59,910
attribute is that it's not<font color="#CCCCCC"> transitive</font>

888
00:36:58,410 --> 00:37:03,569
you set the weight it's<font color="#E5E5E5"> for that router</font>

889
00:36:59,910 --> 00:37:05,339
only the reason you should your<font color="#E5E5E5"> antenna</font>

890
00:37:03,569 --> 00:37:06,660
should go up and say danger danger when

891
00:37:05,339 --> 00:37:09,299
you<font color="#E5E5E5"> do something that's on one router</font>

892
00:37:06,660 --> 00:37:12,509
only in a multi router network you may

893
00:37:09,299 --> 00:37:14,190
<font color="#E5E5E5">have someone you can send someone you</font>

894
00:37:12,510 --> 00:37:16,589
may have someone pointing around at you

895
00:37:14,190 --> 00:37:20,130
and you could point it back at them now

896
00:37:16,589 --> 00:37:22,078
normally<font color="#CCCCCC"> in well-formed uses of BGP that</font>

897
00:37:20,130 --> 00:37:24,510
could never happen you could never be

898
00:37:22,079 --> 00:37:25,950
because if you thought<font color="#CCCCCC"> that you should</font>

899
00:37:24,510 --> 00:37:27,539
get there through them you'd have<font color="#E5E5E5"> a</font>

900
00:37:25,950 --> 00:37:29,308
route you'd advertise it they think

901
00:37:27,539 --> 00:37:31,230
<font color="#E5E5E5">that's best they would never advertise</font>

902
00:37:29,309 --> 00:37:33,059
you around you couldn't have that kind

903
00:37:31,230 --> 00:37:34,289
of thing<font color="#CCCCCC"> going on but</font><font color="#E5E5E5"> with weights just</font>

904
00:37:33,059 --> 00:37:35,549
like with static routes you can point

905
00:37:34,289 --> 00:37:36,960
static routes back at<font color="#E5E5E5"> each other with</font>

906
00:37:35,549 --> 00:37:39,750
weights<font color="#E5E5E5"> it's it's equivalent to like a</font>

907
00:37:36,960 --> 00:37:41,760
BGP really override static and the

908
00:37:39,750 --> 00:37:43,200
original<font color="#E5E5E5"> idea was if</font><font color="#CCCCCC"> you have</font><font color="#E5E5E5"> something</font>

909
00:37:41,760 --> 00:37:45,089
that<font color="#CCCCCC"> you really really</font><font color="#E5E5E5"> think needs to</font><font color="#CCCCCC"> go</font>

910
00:37:43,200 --> 00:37:46,859
that way<font color="#E5E5E5"> it gives you the ability to do</font>

911
00:37:45,089 --> 00:37:50,520
that but you should just stay away from

912
00:37:46,859 --> 00:37:53,910
it never sent the way ah so local<font color="#CCCCCC"> pref</font>

913
00:37:50,520 --> 00:37:56,819
after a SPF local pref is probably the

914
00:37:53,910 --> 00:37:59,940
metric that people use the most nowadays

915
00:37:56,819 --> 00:38:03,089
the local<font color="#E5E5E5"> pref attribute itself is local</font>

916
00:37:59,940 --> 00:38:05,970
to within<font color="#CCCCCC"> your network so you'll won't</font>

917
00:38:03,089 --> 00:38:07,558
see a provider's local<font color="#E5E5E5"> proof unless they</font>

918
00:38:05,970 --> 00:38:09,359
somehow magically transform it to

919
00:38:07,559 --> 00:38:11,130
something else called a community<font color="#CCCCCC"> to</font>

920
00:38:09,359 --> 00:38:12,480
tell you<font color="#E5E5E5"> about it but it's within your</font>

921
00:38:11,130 --> 00:38:15,450
network so anything that you do to it

922
00:38:12,480 --> 00:38:19,079
won't<font color="#E5E5E5"> be affected it's used influence</font>

923
00:38:15,450 --> 00:38:21,629
<font color="#E5E5E5">BGP path selection so it comes in the</font>

924
00:38:19,079 --> 00:38:23,940
when I look at 22 paths to the same

925
00:38:21,630 --> 00:38:27,630
prefix and say which should i prefer<font color="#E5E5E5"> I'm</font>

926
00:38:23,940 --> 00:38:31,500
going<font color="#E5E5E5"> to use the local pref before I use</font>

927
00:38:27,630 --> 00:38:33,059
the<font color="#CCCCCC"> a s path</font><font color="#E5E5E5"> length so one thing is</font>

928
00:38:31,500 --> 00:38:34,529
<font color="#CCCCCC">you're sort of now ignoring some</font>

929
00:38:33,059 --> 00:38:38,039
information that<font color="#CCCCCC"> you can get from</font><font color="#E5E5E5"> the</font>

930
00:38:34,529 --> 00:38:41,039
ass path but generally speaking I think

931
00:38:38,039 --> 00:38:43,589
<font color="#CCCCCC">it's probably well over fifty percent of</font>

932
00:38:41,039 --> 00:38:46,559
<font color="#E5E5E5">people use local pref to change how they</font>

933
00:38:43,589 --> 00:38:50,640
actually to move traffic around on their

934
00:38:46,559 --> 00:38:55,349
network using<font color="#CCCCCC"> bgb one subtlety is if</font>

935
00:38:50,640 --> 00:38:57,240
there is no local attribute then it's

936
00:38:55,349 --> 00:38:59,069
like there was an attribute of a hundred

937
00:38:57,240 --> 00:39:01,649
so if you ever done a show IP bgp and

938
00:38:59,069 --> 00:39:03,808
you see local / f column and there's you

939
00:39:01,650 --> 00:39:06,029
know 90 100 150 and then there's empty

940
00:39:03,809 --> 00:39:11,190
empty means that the local<font color="#CCCCCC"> / f is not</font>

941
00:39:06,029 --> 00:39:14,380
set in that<font color="#CCCCCC"> case it's as</font><font color="#E5E5E5"> if it were 100</font>

942
00:39:11,190 --> 00:39:15,970
normally 100 so it overrides the aspect

943
00:39:14,380 --> 00:39:18,040
<font color="#E5E5E5">that comes before they s path and it's</font>

944
00:39:15,970 --> 00:39:19,779
Trent<font color="#E5E5E5"> it's transitive it goes to the</font>

945
00:39:18,040 --> 00:39:25,029
other routers but<font color="#CCCCCC"> it's local only to</font>

946
00:39:19,780 --> 00:39:27,070
your network so it's sort of it's<font color="#E5E5E5"> the</font>

947
00:39:25,030 --> 00:39:28,960
main inter needed intermediate level

948
00:39:27,070 --> 00:39:32,440
knob that people use to prefer traffic

949
00:39:28,960 --> 00:39:35,250
nowadays so another topic<font color="#CCCCCC"> ibgp for his</font>

950
00:39:32,440 --> 00:39:38,290
ebgp this was a<font color="#E5E5E5"> little confusing to me</font>

951
00:39:35,250 --> 00:39:41,380
when I was<font color="#CCCCCC"> first starting especially the</font>

952
00:39:38,290 --> 00:39:45,640
ibgp part although ebgp was to my first

953
00:39:41,380 --> 00:39:48,280
<font color="#CCCCCC">peer was you</font><font color="#E5E5E5"> Gannett and this is a sort</font>

954
00:39:45,640 --> 00:39:50,379
of funny story<font color="#E5E5E5"> I was working with</font>

955
00:39:48,280 --> 00:39:52,750
someone had gotten the t3 down to DC

956
00:39:50,380 --> 00:39:54,460
connected to<font color="#CCCCCC"> Mays trying to read the</font>

957
00:39:52,750 --> 00:39:57,160
cisco dots and figure<font color="#CCCCCC"> this stuff out</font><font color="#E5E5E5"> and</font>

958
00:39:54,460 --> 00:39:58,750
so<font color="#E5E5E5"> I asked him for help and he didn't</font>

959
00:39:57,160 --> 00:40:00,100
want<font color="#CCCCCC"> to</font><font color="#E5E5E5"> give it</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> me because there were</font>

960
00:39:58,750 --> 00:40:01,360
a number of<font color="#E5E5E5"> people that believe that if</font>

961
00:40:00,100 --> 00:40:03,490
you<font color="#E5E5E5"> teach people about how to do routing</font>

962
00:40:01,360 --> 00:40:04,810
that it creates more competitors and all

963
00:40:03,490 --> 00:40:06,310
that sort of stuff now there's a lot

964
00:40:04,810 --> 00:40:09,730
more information<font color="#CCCCCC"> that it was available</font>

965
00:40:06,310 --> 00:40:13,480
in<font color="#E5E5E5"> 96-97 but anyway</font><font color="#CCCCCC"> I had sent mailed to</font>

966
00:40:09,730 --> 00:40:15,310
a few people and I got email from asp at

967
00:40:13,480 --> 00:40:16,720
you<font color="#E5E5E5"> not saying hey would you like to</font>

968
00:40:15,310 --> 00:40:18,850
pure we notice you're amazed and<font color="#E5E5E5"> I said</font>

969
00:40:16,720 --> 00:40:21,790
why sure that would<font color="#CCCCCC"> be lovely and I</font>

970
00:40:18,850 --> 00:40:23,470
tried to<font color="#CCCCCC"> figure out how to set up all</font>

971
00:40:21,790 --> 00:40:25,029
the filters that I would only send my

972
00:40:23,470 --> 00:40:26,950
own addresses but it was all this<font color="#CCCCCC"> Cisco</font>

973
00:40:25,030 --> 00:40:28,390
speak and I didn't<font color="#E5E5E5"> really understand it</font>

974
00:40:26,950 --> 00:40:30,009
that was why I wrote all those articles

975
00:40:28,390 --> 00:40:32,580
was because I was so frustrated at

976
00:40:30,010 --> 00:40:35,080
trying to<font color="#E5E5E5"> parse all the documentation</font>

977
00:40:32,580 --> 00:40:36,730
ebgp bgp when you're speaking<font color="#E5E5E5"> to another</font>

978
00:40:35,080 --> 00:40:38,470
is<font color="#E5E5E5"> by default you're going to send all</font>

979
00:40:36,730 --> 00:40:40,210
<font color="#E5E5E5">the routes in your routing table there's</font>

980
00:40:38,470 --> 00:40:42,129
nothing you need<font color="#E5E5E5"> to turn on you're just</font>

981
00:40:40,210 --> 00:40:44,730
going to start sending<font color="#E5E5E5"> them unless you</font>

982
00:40:42,130 --> 00:40:48,430
have filters in place but<font color="#E5E5E5"> with ibgp</font>

983
00:40:44,730 --> 00:40:50,140
because there's no loop detection by

984
00:40:48,430 --> 00:40:52,060
default there<font color="#E5E5E5"> are things that have been</font>

985
00:40:50,140 --> 00:40:53,410
<font color="#E5E5E5">added onto bgp for loop detection but</font>

986
00:40:52,060 --> 00:40:55,779
because there's no loop detection

987
00:40:53,410 --> 00:40:58,060
there's a weird rule in ibgp that says

988
00:40:55,780 --> 00:40:59,650
you can only send routes that you heard

989
00:40:58,060 --> 00:41:01,870
from the outside or that you were

990
00:40:59,650 --> 00:41:04,840
originated you can't tell another

991
00:41:01,870 --> 00:41:06,310
internal router about a route that you

992
00:41:04,840 --> 00:41:07,870
heard from another<font color="#E5E5E5"> one</font><font color="#CCCCCC"> because there's</font>

993
00:41:06,310 --> 00:41:09,970
no loop detection by default and if you

994
00:41:07,870 --> 00:41:11,740
could do that then the messages would

995
00:41:09,970 --> 00:41:13,509
just loop around so it's sort of the

996
00:41:11,740 --> 00:41:14,890
opposite you would think that with ebgp

997
00:41:13,510 --> 00:41:17,200
you'd be more selective and you'd have

998
00:41:14,890 --> 00:41:19,509
<font color="#E5E5E5">to say please to send all my routes out</font>

999
00:41:17,200 --> 00:41:21,129
this connection and with ibgp you would

1000
00:41:19,510 --> 00:41:22,640
think you'd send all your routes fully

1001
00:41:21,130 --> 00:41:25,180
but it's<font color="#CCCCCC"> actually a little bit</font>

1002
00:41:22,640 --> 00:41:27,769
<font color="#E5E5E5">reverse and that can be confusing so</font>

1003
00:41:25,180 --> 00:41:30,950
corollary you must strongly filter all

1004
00:41:27,769 --> 00:41:34,519
ebgp sessions because it could happen

1005
00:41:30,950 --> 00:41:36,319
that all the routes now most big

1006
00:41:34,519 --> 00:41:37,669
networks will actually use configuration

1007
00:41:36,319 --> 00:41:39,410
management systems to manage their

1008
00:41:37,670 --> 00:41:40,819
network but a common thing<font color="#E5E5E5"> that will</font>

1009
00:41:39,410 --> 00:41:43,009
happen<font color="#E5E5E5"> is I'm turning up appearing</font>

1010
00:41:40,819 --> 00:41:45,380
session and with the wonderful<font color="#E5E5E5"> CL is</font>

1011
00:41:43,010 --> 00:41:48,319
that our cisco in<font color="#E5E5E5"> cisco like that we're</font>

1012
00:41:45,380 --> 00:41:50,599
all so familiar with<font color="#E5E5E5"> if you type you</font>

1013
00:41:48,319 --> 00:41:52,009
know neighbor foo remote<font color="#E5E5E5"> a s foo and</font>

1014
00:41:50,599 --> 00:41:54,950
then someone taps you on the shoulder

1015
00:41:52,010 --> 00:41:56,390
<font color="#E5E5E5">and you don't cut</font><font color="#CCCCCC"> and paste the rest you</font>

1016
00:41:54,950 --> 00:41:58,250
<font color="#CCCCCC">have a</font><font color="#E5E5E5"> session that might come up if</font>

1017
00:41:56,390 --> 00:42:00,680
there is no password before any filters

1018
00:41:58,250 --> 00:42:02,930
are in place and<font color="#E5E5E5"> if you're expecting</font><font color="#CCCCCC"> to</font>

1019
00:42:00,680 --> 00:42:04,848
only<font color="#E5E5E5"> get 20 routes from someone you</font>

1020
00:42:02,930 --> 00:42:06,140
always<font color="#CCCCCC"> need to prepare for the fact that</font>

1021
00:42:04,849 --> 00:42:08,359
they<font color="#E5E5E5"> might start suddenly sending you</font>

1022
00:42:06,140 --> 00:42:13,098
<font color="#E5E5E5">280,000 and</font><font color="#CCCCCC"> there are some mechanisms to</font>

1023
00:42:08,359 --> 00:42:15,500
<font color="#E5E5E5">deal with that so in BGP speakers within</font>

1024
00:42:13,099 --> 00:42:19,369
an AS talk to each other<font color="#E5E5E5"> it's ibgp</font>

1025
00:42:15,500 --> 00:42:21,440
internal bgp and the corollary about the

1026
00:42:19,369 --> 00:42:22,849
lack of loop detection is that in the

1027
00:42:21,440 --> 00:42:25,670
simple configurations you have to have a

1028
00:42:22,849 --> 00:42:28,789
full mesh every internal<font color="#E5E5E5"> bgp router</font>

1029
00:42:25,670 --> 00:42:31,789
needs to speak bgp to every other router

1030
00:42:28,789 --> 00:42:33,230
with ebgp is external so you can

1031
00:42:31,789 --> 00:42:35,569
actually<font color="#E5E5E5"> have this is also an old slide</font>

1032
00:42:33,230 --> 00:42:39,049
you can actually somebody<font color="#E5E5E5"> bgp you've got</font>

1033
00:42:35,569 --> 00:42:41,808
different networks out there with the

1034
00:42:39,049 --> 00:42:42,769
the hidden complexity<font color="#E5E5E5"> in set inside 7007</font>

1035
00:42:41,809 --> 00:42:45,349
is that there are actually multiple

1036
00:42:42,769 --> 00:42:47,450
routers now to ebgp the fact that there

1037
00:42:45,349 --> 00:42:49,369
are is completely transparent but within

1038
00:42:47,450 --> 00:42:52,038
<font color="#E5E5E5">that network you've got those routers</font>

1039
00:42:49,369 --> 00:42:54,200
and so the<font color="#E5E5E5"> far routers the far two</font>

1040
00:42:52,039 --> 00:42:57,410
routers will be speaking<font color="#CCCCCC"> ibgp</font><font color="#E5E5E5"> on dbgap</font>

1041
00:42:54,200 --> 00:43:00,308
in fact the<font color="#CCCCCC"> the third router in</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> seven</font>

1042
00:42:57,410 --> 00:43:02,569
<font color="#CCCCCC">thousand seven may well also speak ebgp</font>

1043
00:43:00,309 --> 00:43:03,859
to someone else but in this diagram it

1044
00:43:02,569 --> 00:43:09,980
would<font color="#E5E5E5"> just speak ibgp and it would be</font>

1045
00:43:03,859 --> 00:43:13,250
meshed with the other two so ebgp talks

1046
00:43:09,980 --> 00:43:16,339
to one other<font color="#E5E5E5"> guy sends the one best path</font>

1047
00:43:13,250 --> 00:43:20,000
<font color="#E5E5E5">to every prefix in BGP sends all the</font>

1048
00:43:16,339 --> 00:43:21,710
<font color="#E5E5E5">important attributes prefix AFF but</font>

1049
00:43:20,000 --> 00:43:22,819
doesn't send the local pref or some

1050
00:43:21,710 --> 00:43:26,750
other attributes<font color="#E5E5E5"> when you read the</font>

1051
00:43:22,819 --> 00:43:28,788
protocol there's transitive attributes

1052
00:43:26,750 --> 00:43:30,200
that get sent around non transitive like

1053
00:43:28,789 --> 00:43:31,880
the weight that are local and<font color="#E5E5E5"> then</font>

1054
00:43:30,200 --> 00:43:33,700
there's the there's attributes that are

1055
00:43:31,880 --> 00:43:39,100
local to your ass and attributes

1056
00:43:33,700 --> 00:43:43,140
you send to other people<font color="#E5E5E5"> so usually</font><font color="#CCCCCC"> with</font>

1057
00:43:39,100 --> 00:43:45,819
ebgp the next top will be set<font color="#E5E5E5"> unless its</font>

1058
00:43:43,140 --> 00:43:47,790
multiple p unless you're all there's

1059
00:43:45,820 --> 00:43:52,390
multiple people speaking on the same

1060
00:43:47,790 --> 00:43:54,850
generally land the same premix with ibgp

1061
00:43:52,390 --> 00:43:56,170
<font color="#CCCCCC">role you can talk two routers many hops</font>

1062
00:43:54,850 --> 00:43:58,210
away they don't have to<font color="#E5E5E5"> be directly</font>

1063
00:43:56,170 --> 00:43:59,740
connected and in fact<font color="#E5E5E5"> the recursive</font>

1064
00:43:58,210 --> 00:44:02,170
routing that<font color="#E5E5E5"> I talked</font><font color="#CCCCCC"> about is generally</font>

1065
00:43:59,740 --> 00:44:04,000
what<font color="#E5E5E5"> will happen is BGP will be used to</font>

1066
00:44:02,170 --> 00:44:05,380
tell you sort of where generally you're

1067
00:44:04,000 --> 00:44:08,620
going<font color="#E5E5E5"> and then you'll look up in ospf</font>

1068
00:44:05,380 --> 00:44:11,770
eigrp is is whatever how to actually get

1069
00:44:08,620 --> 00:44:14,140
there but it can only send throughout it

1070
00:44:11,770 --> 00:44:16,570
injects or routed here is directly from

1071
00:44:14,140 --> 00:44:18,730
an external peer requiring a full mesh

1072
00:44:16,570 --> 00:44:20,680
and the<font color="#E5E5E5"> reason is because there's no</font>

1073
00:44:18,730 --> 00:44:23,080
loop detection otherwise it sends all

1074
00:44:20,680 --> 00:44:26,190
the<font color="#E5E5E5"> attributes other than wait it leaves</font>

1075
00:44:23,080 --> 00:44:28,509
the a SPF alone unless you're doing

1076
00:44:26,190 --> 00:44:30,640
<font color="#CCCCCC">Confederations which I assume no one is</font>

1077
00:44:28,510 --> 00:44:33,340
and it doesn't<font color="#CCCCCC"> touch the next top unless</font>

1078
00:44:30,640 --> 00:44:35,200
you say next stop self there are some

1079
00:44:33,340 --> 00:44:36,940
cases<font color="#E5E5E5"> if</font><font color="#CCCCCC"> you have a very simple topology</font>

1080
00:44:35,200 --> 00:44:38,379
and let's say you have two routers in

1081
00:44:36,940 --> 00:44:40,600
the same data center<font color="#CCCCCC"> and that's your</font>

1082
00:44:38,380 --> 00:44:43,180
network you<font color="#CCCCCC"> may</font><font color="#E5E5E5"> want to reset the next</font>

1083
00:44:40,600 --> 00:44:46,779
stop but generally you won't reset the

1084
00:44:43,180 --> 00:44:48,850
next stop in ibgp so let's say<font color="#E5E5E5"> you have</font>

1085
00:44:46,780 --> 00:44:50,470
16 routers or your network and you want

1086
00:44:48,850 --> 00:44:52,630
to run ibgp by default you're going to

1087
00:44:50,470 --> 00:44:54,250
need<font color="#E5E5E5"> a pretty complex mesh which becomes</font>

1088
00:44:52,630 --> 00:44:56,710
even larger when you have tens or

1089
00:44:54,250 --> 00:44:58,780
hundreds of routers and there's topics

1090
00:44:56,710 --> 00:45:01,990
that are covered in BGP<font color="#E5E5E5"> 102 route</font>

1091
00:44:58,780 --> 00:45:04,180
reflectors and Confederations that you

1092
00:45:01,990 --> 00:45:05,560
get into to scale it the interesting

1093
00:45:04,180 --> 00:45:08,140
thing when you're just<font color="#E5E5E5"> starting out is</font>

1094
00:45:05,560 --> 00:45:10,000
you should understand a little bit about

1095
00:45:08,140 --> 00:45:12,569
it<font color="#E5E5E5"> because it's actually better to setup</font>

1096
00:45:10,000 --> 00:45:14,800
your network with route reflectors or

1097
00:45:12,570 --> 00:45:16,660
initially just because it doesn't add

1098
00:45:14,800 --> 00:45:17,770
really any overhead and it gives you the

1099
00:45:16,660 --> 00:45:21,640
ability to not have<font color="#CCCCCC"> to change anything</font>

1100
00:45:17,770 --> 00:45:24,550
<font color="#E5E5E5">as you as you grow so the ibgp</font>

1101
00:45:21,640 --> 00:45:27,009
restriction we talked about<font color="#E5E5E5"> that so how</font>

1102
00:45:24,550 --> 00:45:29,710
do I outs get into BGP you have to

1103
00:45:27,010 --> 00:45:32,800
insert routes somehow and you can either

1104
00:45:29,710 --> 00:45:34,390
statically insert them or you can

1105
00:45:32,800 --> 00:45:36,370
redistribute for another routing

1106
00:45:34,390 --> 00:45:37,750
protocol how many<font color="#CCCCCC"> people here</font>

1107
00:45:36,370 --> 00:45:40,120
redistribute from another routing

1108
00:45:37,750 --> 00:45:42,760
protocol<font color="#E5E5E5"> into BGP of the non hecklers</font>

1109
00:45:40,120 --> 00:45:45,150
<font color="#E5E5E5">okay and how many people use only static</font>

1110
00:45:42,760 --> 00:45:48,359
statements to create BGP routes

1111
00:45:45,150 --> 00:45:53,730
<font color="#CCCCCC">okay so</font><font color="#E5E5E5"> i recommend that you stick with</font>

1112
00:45:48,359 --> 00:45:56,578
that until you<font color="#E5E5E5"> uh yes more than once we</font>

1113
00:45:53,730 --> 00:45:59,190
really the ultimate question yes the the

1114
00:45:56,579 --> 00:46:01,109
never-ending distributed non converging

1115
00:45:59,190 --> 00:46:03,510
<font color="#E5E5E5">computation that will ensue although</font>

1116
00:46:01,109 --> 00:46:06,210
actually with divergence with with

1117
00:46:03,510 --> 00:46:10,349
partial SPF will it actually can it

1118
00:46:06,210 --> 00:46:13,920
handle it okay so generally speaking if

1119
00:46:10,349 --> 00:46:16,619
you want there's some<font color="#CCCCCC"> bgp slides big bgp</font>

1120
00:46:13,920 --> 00:46:18,799
<font color="#E5E5E5">dot ppt that are at</font><font color="#CCCCCC"> my website and bgp</font>

1121
00:46:16,619 --> 00:46:21,630
102 I think talk a little bit about

1122
00:46:18,799 --> 00:46:23,609
creating<font color="#CCCCCC"> bgp routes by dynamically</font>

1123
00:46:21,630 --> 00:46:26,970
redistributing them from other protocols

1124
00:46:23,609 --> 00:46:30,328
but unnecessary complexity at the basic

1125
00:46:26,970 --> 00:46:33,868
level so to create<font color="#E5E5E5"> a route in cisco say</font>

1126
00:46:30,329 --> 00:46:35,579
network foo<font color="#E5E5E5"> i don't think</font><font color="#CCCCCC"> you can gets i</font>

1127
00:46:33,869 --> 00:46:37,950
<font color="#E5E5E5">think every so often I tried</font><font color="#CCCCCC"> network foo</font>

1128
00:46:35,579 --> 00:46:41,369
/ 16 or something and it still doesn't

1129
00:46:37,950 --> 00:46:44,368
let you just to be perverse it must have

1130
00:46:41,369 --> 00:46:45,720
<font color="#CCCCCC">an exactly matching underlying route of</font>

1131
00:46:44,369 --> 00:46:49,490
some sort generally a static route

1132
00:46:45,720 --> 00:46:51,720
otherwise it won't create that route and

1133
00:46:49,490 --> 00:46:52,979
<font color="#E5E5E5">you probably don't want</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> do this with</font>

1134
00:46:51,720 --> 00:46:53,910
a thousand routes at a thousand routes

1135
00:46:52,980 --> 00:46:55,770
you hire someone<font color="#E5E5E5"> who knows about</font>

1136
00:46:53,910 --> 00:46:59,960
redistributing and setting up your

1137
00:46:55,770 --> 00:47:02,460
network and but and it's pretty<font color="#E5E5E5"> easy to</font>

1138
00:46:59,960 --> 00:47:04,760
scale this way generally you'll put the

1139
00:47:02,460 --> 00:47:10,410
network statement at the place or places

1140
00:47:04,760 --> 00:47:14,760
closest<font color="#E5E5E5"> to where your customers are so</font>

1141
00:47:10,410 --> 00:47:17,910
advertising routes bgp is inside peering

1142
00:47:14,760 --> 00:47:20,490
sessions on top of TCP<font color="#E5E5E5"> and your peers</font>

1143
00:47:17,910 --> 00:47:22,799
have to be<font color="#E5E5E5"> specified explicitly there is</font>

1144
00:47:20,490 --> 00:47:26,009
a way to do<font color="#E5E5E5"> wild card bgp but you</font>

1145
00:47:22,799 --> 00:47:28,049
wouldn't be doing that so once bgp<font color="#CCCCCC"> once</font>

1146
00:47:26,010 --> 00:47:30,270
appearing sessions up all the routes

1147
00:47:28,049 --> 00:47:32,849
flood and then there are periodic

1148
00:47:30,270 --> 00:47:34,619
updates so the key thing is to make your

1149
00:47:32,849 --> 00:47:38,220
network as much like this as possible so

1150
00:47:34,619 --> 00:47:41,730
all you're getting overtime is periodic

1151
00:47:38,220 --> 00:47:44,788
updates if you have issues<font color="#E5E5E5"> going on with</font>

1152
00:47:41,730 --> 00:47:47,099
connectivity or cpu you can do a show IP

1153
00:47:44,789 --> 00:47:49,650
bgp and look at the number<font color="#CCCCCC"> of updates</font>

1154
00:47:47,099 --> 00:47:52,190
that have happened over time is there a

1155
00:47:49,650 --> 00:47:52,190
<font color="#E5E5E5">mint for that</font>

1156
00:47:53,140 --> 00:47:57,940
I have<font color="#E5E5E5"> something</font><font color="#CCCCCC"> that scrapes it but</font>

1157
00:47:55,140 --> 00:47:59,470
<font color="#E5E5E5">okay</font><font color="#CCCCCC"> so you might even</font><font color="#E5E5E5"> be</font><font color="#CCCCCC"> able to</font>

1158
00:47:57,940 --> 00:48:01,690
depending<font color="#CCCCCC"> on your router vendor grab</font>

1159
00:47:59,470 --> 00:48:03,069
that and look at<font color="#CCCCCC"> it because</font><font color="#E5E5E5"> if you start</font>

1160
00:48:01,690 --> 00:48:04,390
seeing that go really high on some

1161
00:48:03,069 --> 00:48:07,960
sessions but not others there's some

1162
00:48:04,390 --> 00:48:10,299
problems that you need to look<font color="#E5E5E5"> at so</font>

1163
00:48:07,960 --> 00:48:13,480
there's a state machine that describes

1164
00:48:10,299 --> 00:48:16,839
how the routers speak<font color="#E5E5E5"> BGP to each other</font>

1165
00:48:13,480 --> 00:48:18,130
it's in the RFC<font color="#E5E5E5"> and one reason it can be</font>

1166
00:48:16,839 --> 00:48:20,140
useful<font color="#CCCCCC"> to at least know what those</font>

1167
00:48:18,130 --> 00:48:22,089
states are is because<font color="#E5E5E5"> when you do a show</font>

1168
00:48:20,140 --> 00:48:24,578
IP bgp you'll see those states listed

1169
00:48:22,089 --> 00:48:26,440
and the interesting<font color="#CCCCCC"> thing there is</font>

1170
00:48:24,579 --> 00:48:29,230
active doesn't mean active it means

1171
00:48:26,440 --> 00:48:31,799
<font color="#E5E5E5">waiting so if you see active next to the</font>

1172
00:48:29,230 --> 00:48:38,289
session it means the session is not up

1173
00:48:31,799 --> 00:48:40,269
so so every<font color="#CCCCCC"> time I get a route it's got</font>

1174
00:48:38,289 --> 00:48:42,490
to pass the filters and then it can go

1175
00:48:40,269 --> 00:48:44,410
<font color="#E5E5E5">into BGP routing table and then unless</font>

1176
00:48:42,490 --> 00:48:45,939
if unless it's the<font color="#E5E5E5"> same route</font>

1177
00:48:44,410 --> 00:48:48,609
essentially that<font color="#CCCCCC"> it just had a different</font>

1178
00:48:45,940 --> 00:48:50,349
attribute on it I need to figure out

1179
00:48:48,609 --> 00:48:51,460
whether that's<font color="#E5E5E5"> the best IP route it can</font>

1180
00:48:50,349 --> 00:48:52,569
I need to figure out whether that's the

1181
00:48:51,460 --> 00:48:54,579
<font color="#E5E5E5">best route for the forwarding table</font>

1182
00:48:52,569 --> 00:48:56,710
generally IP route and forwarding tables

1183
00:48:54,579 --> 00:48:59,109
the same thing and then I also<font color="#E5E5E5"> need to</font>

1184
00:48:56,710 --> 00:49:00,430
send it to any<font color="#E5E5E5"> BGP peers and see whether</font>

1185
00:48:59,109 --> 00:49:01,869
it passes so there's a lot<font color="#CCCCCC"> of work that</font>

1186
00:49:00,430 --> 00:49:06,250
<font color="#CCCCCC">has</font><font color="#E5E5E5"> to go on and that's why you want to</font>

1187
00:49:01,869 --> 00:49:09,460
want to<font color="#E5E5E5"> keep the network stable so</font>

1188
00:49:06,250 --> 00:49:11,440
policy to decide what routes can and

1189
00:49:09,460 --> 00:49:13,690
can't go<font color="#E5E5E5"> where and what routes you want</font>

1190
00:49:11,440 --> 00:49:17,019
to prefer from different directions the

1191
00:49:13,690 --> 00:49:19,599
basic filters are prefixed less there

1192
00:49:17,019 --> 00:49:22,538
used to be distributed the modern form

1193
00:49:19,599 --> 00:49:26,710
is prefixed list lets you list prefixes

1194
00:49:22,539 --> 00:49:29,410
there's a SPF filters as path access

1195
00:49:26,710 --> 00:49:31,059
lists that let you match on a s pass and

1196
00:49:29,410 --> 00:49:33,609
then there's route maps that let you be

1197
00:49:31,059 --> 00:49:35,589
more creative certainly<font color="#E5E5E5"> not a touring</font>

1198
00:49:33,609 --> 00:49:38,410
complete language but the route maps

1199
00:49:35,589 --> 00:49:41,230
that you give you more complexity and

1200
00:49:38,410 --> 00:49:46,359
actually let you set or reset attributes

1201
00:49:41,230 --> 00:49:47,769
in BGP as you for distributing to your

1202
00:49:46,359 --> 00:49:50,650
other routers and potentially to your

1203
00:49:47,769 --> 00:49:53,109
downstream customers so<font color="#E5E5E5"> free fixed lists</font>

1204
00:49:50,650 --> 00:49:56,140
are just it's it's to be used for

1205
00:49:53,109 --> 00:49:58,390
neighbor it's just a list<font color="#E5E5E5"> of its</font>

1206
00:49:56,140 --> 00:50:00,368
matching on prefixes<font color="#E5E5E5"> it's applied to</font>

1207
00:49:58,390 --> 00:50:02,259
your BGP routes you can<font color="#CCCCCC"> use an inbound</font>

1208
00:50:00,369 --> 00:50:03,100
outbound both it's based just on the

1209
00:50:02,259 --> 00:50:06,380
prefaces

1210
00:50:03,100 --> 00:50:09,259
you have a prefix list call it something

1211
00:50:06,380 --> 00:50:11,600
have it on every router of your prefixes

1212
00:50:09,260 --> 00:50:14,270
and then you probably should also have

1213
00:50:11,600 --> 00:50:17,360
at least a<font color="#E5E5E5"> prefix list of rel to do not</font>

1214
00:50:14,270 --> 00:50:20,210
want<font color="#E5E5E5"> to allow in so you don't want to</font>

1215
00:50:17,360 --> 00:50:22,460
allow anything that's a<font color="#E5E5E5"> 20 that's longer</font>

1216
00:50:20,210 --> 00:50:24,890
than a 24 or 23 you don't want allow RC

1217
00:50:22,460 --> 00:50:27,619
<font color="#CCCCCC">19 18 yo no you don't want to allow your</font>

1218
00:50:24,890 --> 00:50:29,180
address space in them beyond that you'll

1219
00:50:27,619 --> 00:50:31,730
is you have customers you'll create

1220
00:50:29,180 --> 00:50:34,580
access this for that or for other

1221
00:50:31,730 --> 00:50:39,140
special purposes so a s path access

1222
00:50:34,580 --> 00:50:41,360
lists called filters common ones you

1223
00:50:39,140 --> 00:50:43,549
want to keep<font color="#E5E5E5"> around or permit only my</font>

1224
00:50:41,360 --> 00:50:46,040
<font color="#CCCCCC">routes so you'll probably have an ass</font>

1225
00:50:43,550 --> 00:50:48,470
path access list of what are your elves

1226
00:50:46,040 --> 00:50:52,460
which means<font color="#CCCCCC"> carrick dollar sign and the</font>

1227
00:50:48,470 --> 00:50:54,410
AS IS of anyone underneath you<font color="#CCCCCC"> there are</font>

1228
00:50:52,460 --> 00:50:57,650
reasons that is path access lists are

1229
00:50:54,410 --> 00:51:00,170
not enough for example let's<font color="#CCCCCC"> say that</font>

1230
00:50:57,650 --> 00:51:02,090
you have a multihomed customer and your

1231
00:51:00,170 --> 00:51:05,660
access list says permit my routes and

1232
00:51:02,090 --> 00:51:10,340
<font color="#E5E5E5">for hit permit 7007 my customer but you</font>

1233
00:51:05,660 --> 00:51:12,290
<font color="#E5E5E5">don't have</font><font color="#CCCCCC"> I'm sorry I got this</font>

1234
00:51:10,340 --> 00:51:14,690
backwards let's say you have a prefix

1235
00:51:12,290 --> 00:51:17,720
list only<font color="#E5E5E5"> that says allow these routes</font>

1236
00:51:14,690 --> 00:51:20,600
through and your<font color="#CCCCCC"> multi-home</font><font color="#E5E5E5"> customer</font>

1237
00:51:17,720 --> 00:51:23,240
goes down you'll hear those routes from

1238
00:51:20,600 --> 00:51:24,920
another provider and you may then give

1239
00:51:23,240 --> 00:51:26,868
them transit you may actually transit

1240
00:51:24,920 --> 00:51:29,210
you units path to another provider

1241
00:51:26,869 --> 00:51:31,070
unless you also filter by a s<font color="#E5E5E5"> path so</font>

1242
00:51:29,210 --> 00:51:33,500
it's important to<font color="#E5E5E5"> do both prefix</font>

1243
00:51:31,070 --> 00:51:36,380
filtering and a sol 3 in<font color="#E5E5E5"> general if in</font>

1244
00:51:33,500 --> 00:51:38,960
doubt over filter the amount of work

1245
00:51:36,380 --> 00:51:41,390
required when extra routes float around

1246
00:51:38,960 --> 00:51:44,500
is much much more than<font color="#CCCCCC"> the extra work of</font>

1247
00:51:41,390 --> 00:51:47,379
doing some filtering in your router's

1248
00:51:44,500 --> 00:51:49,850
regular expressions with cisco are

1249
00:51:47,380 --> 00:51:53,570
eunuchs regular expressions basically or

1250
00:51:49,850 --> 00:51:55,940
subset three a sub part 1 of standard

1251
00:51:53,570 --> 00:51:59,330
UNIX regular expressions dot means match

1252
00:51:55,940 --> 00:52:02,930
any single character asterisk means zero

1253
00:51:59,330 --> 00:52:05,810
or more of it so unlike das where star

1254
00:52:02,930 --> 00:52:09,169
means<font color="#E5E5E5"> slightly different plus means that</font>

1255
00:52:05,810 --> 00:52:11,359
character and then more of them at ? in

1256
00:52:09,170 --> 00:52:12,920
<font color="#E5E5E5">general you probably won't use these</font>

1257
00:52:11,359 --> 00:52:15,650
until you get more complex or you have

1258
00:52:12,920 --> 00:52:17,930
providers<font color="#E5E5E5"> that are telling you</font>

1259
00:52:15,650 --> 00:52:19,610
you snippets of how to do matching on

1260
00:52:17,930 --> 00:52:21,290
different<font color="#CCCCCC"> areas generally going to use</font>

1261
00:52:19,610 --> 00:52:23,150
the carrot which means begin at the

1262
00:52:21,290 --> 00:52:26,270
<font color="#E5E5E5">dollar sign which means n debt and the</font>

1263
00:52:23,150 --> 00:52:32,840
underscore which means begin and or a

1264
00:52:26,270 --> 00:52:34,310
break between a esas those so there are

1265
00:52:32,840 --> 00:52:36,710
<font color="#E5E5E5">also some other things for</font>

1266
00:52:34,310 --> 00:52:39,080
Confederations but we're assuming you're

1267
00:52:36,710 --> 00:52:41,870
<font color="#E5E5E5">not doing that so again more regular</font>

1268
00:52:39,080 --> 00:52:44,690
expression so when you apply a spell

1269
00:52:41,870 --> 00:52:46,089
filtering you set the filter inbound and

1270
00:52:44,690 --> 00:52:51,050
then the routes that<font color="#E5E5E5"> try to get in</font>

1271
00:52:46,090 --> 00:52:55,130
through that filter will<font color="#CCCCCC"> be permitted</font><font color="#E5E5E5"> or</font>

1272
00:52:51,050 --> 00:53:00,610
denied so if in this case that<font color="#E5E5E5"> I with</font>

1273
00:52:55,130 --> 00:53:04,250
access<font color="#CCCCCC"> was ten there if the route has</font>

1274
00:53:00,610 --> 00:53:06,770
6201 or 6201 that it heard from 6202

1275
00:53:04,250 --> 00:53:10,250
it's been accepted but<font color="#E5E5E5"> nothing from 701</font>

1276
00:53:06,770 --> 00:53:14,900
will be able<font color="#E5E5E5"> to make it into 3847 from</font>

1277
00:53:10,250 --> 00:53:17,390
6201 the other major use of this is on

1278
00:53:14,900 --> 00:53:19,070
the inbound side if you again<font color="#CCCCCC"> your</font>

1279
00:53:17,390 --> 00:53:21,950
<font color="#E5E5E5">multihomed you want to try moving all</font>

1280
00:53:19,070 --> 00:53:23,750
your unit traffic and say match 701 deny

1281
00:53:21,950 --> 00:53:25,009
everything else and then you'll set

1282
00:53:23,750 --> 00:53:27,080
something you'll<font color="#CCCCCC"> be using a route map</font>

1283
00:53:25,010 --> 00:53:29,390
and you'll set something to cause the

1284
00:53:27,080 --> 00:53:31,670
routes TV either be preferred or d

1285
00:53:29,390 --> 00:53:36,290
preferred as you hear them<font color="#E5E5E5"> from a given</font>

1286
00:53:31,670 --> 00:53:38,450
provider three things that<font color="#CCCCCC"> you should</font>

1287
00:53:36,290 --> 00:53:41,779
probably always keep around especially

1288
00:53:38,450 --> 00:53:43,310
for the sort of or you<font color="#E5E5E5"> know</font>

1289
00:53:41,780 --> 00:53:45,650
something we're<font color="#CCCCCC"> just going on in to do</font>

1290
00:53:43,310 --> 00:53:48,170
something it's always<font color="#E5E5E5"> a little dangerous</font>

1291
00:53:45,650 --> 00:53:52,300
when you hear the routing guy say you

1292
00:53:48,170 --> 00:53:54,230
know oh crap or interesting or doubt and

1293
00:53:52,300 --> 00:53:55,460
you know generally they'll go reaching

1294
00:53:54,230 --> 00:53:58,430
for one of these you want to have

1295
00:53:55,460 --> 00:54:00,050
something that permits everything you

1296
00:53:58,430 --> 00:54:03,169
certainly want<font color="#E5E5E5"> to have something that</font>

1297
00:54:00,050 --> 00:54:05,300
denies everything and you want to have

1298
00:54:03,170 --> 00:54:06,710
something that permits might be more

1299
00:54:05,300 --> 00:54:07,760
than carrot dollar sign but your routes

1300
00:54:06,710 --> 00:54:09,830
because you're<font color="#E5E5E5"> going to use</font><font color="#CCCCCC"> that a lot</font>

1301
00:54:07,760 --> 00:54:13,820
<font color="#E5E5E5">and it might</font><font color="#CCCCCC"> be Kara</font><font color="#E5E5E5"> telesign and there</font>

1302
00:54:09,830 --> 00:54:16,040
might be<font color="#E5E5E5"> your down</font><font color="#CCCCCC"> streams how many</font>

1303
00:54:13,820 --> 00:54:20,470
people<font color="#E5E5E5"> here run bgp but have no</font>

1304
00:54:16,040 --> 00:54:23,080
downstream a<font color="#CCCCCC"> esas good</font>

1305
00:54:20,470 --> 00:54:27,549
I was wondering<font color="#CCCCCC"> whether you'd raise your</font>

1306
00:54:23,080 --> 00:54:29,380
hand<font color="#CCCCCC"> so realm apps let you combine</font>

1307
00:54:27,550 --> 00:54:30,970
different ways of matching on<font color="#CCCCCC"> Valve's</font>

1308
00:54:29,380 --> 00:54:33,940
but they also let you set different

1309
00:54:30,970 --> 00:54:37,959
things in those routes so they're like

1310
00:54:33,940 --> 00:54:39,550
little programs not very complex they're

1311
00:54:37,960 --> 00:54:42,490
also used for<font color="#E5E5E5"> other things like when you</font>

1312
00:54:39,550 --> 00:54:44,410
do do redistribution you'll do a route

1313
00:54:42,490 --> 00:54:47,529
maps we do traffic shape and and other

1314
00:54:44,410 --> 00:54:49,540
things but<font color="#E5E5E5"> for bgp it says</font><font color="#CCCCCC"> matt if this</font>

1315
00:54:47,530 --> 00:54:53,050
is the case then do this or don't do

1316
00:54:49,540 --> 00:54:55,570
this so<font color="#E5E5E5"> route map some name permit or</font>

1317
00:54:53,050 --> 00:54:59,800
deny then match and set how<font color="#E5E5E5"> many people</font>

1318
00:54:55,570 --> 00:55:02,740
<font color="#CCCCCC">here use foundry for okay one very very</font>

1319
00:54:59,800 --> 00:55:04,869
important thing just to annoy the

1320
00:55:02,740 --> 00:55:06,790
routing engineers<font color="#CCCCCC"> of</font><font color="#E5E5E5"> the world the</font>

1321
00:55:04,869 --> 00:55:09,790
vendors that are not juniper that have

1322
00:55:06,790 --> 00:55:11,170
done<font color="#E5E5E5"> cisco like decided that they didn't</font>

1323
00:55:09,790 --> 00:55:13,270
actually want<font color="#E5E5E5"> to do it exactly like</font>

1324
00:55:11,170 --> 00:55:15,310
<font color="#E5E5E5">cisco did because why that would be</font>

1325
00:55:13,270 --> 00:55:16,810
incredibly complex and would<font color="#E5E5E5"> require</font>

1326
00:55:15,310 --> 00:55:20,500
someone to actually spend that evening

1327
00:55:16,810 --> 00:55:22,509
working on<font color="#E5E5E5"> and with foundry you ever</font>

1328
00:55:20,500 --> 00:55:25,030
<font color="#CCCCCC">notice you type you know neighbor</font>

1329
00:55:22,510 --> 00:55:26,320
whatever foo and it says<font color="#E5E5E5"> woman this may</font>

1330
00:55:25,030 --> 00:55:28,750
not take effect until you clear the

1331
00:55:26,320 --> 00:55:30,400
session so you pasting a bunch<font color="#E5E5E5"> of</font><font color="#CCCCCC"> stuff</font>

1332
00:55:28,750 --> 00:55:32,380
in you get all this output well one very

1333
00:55:30,400 --> 00:55:35,859
important syntactic difference on cisco

1334
00:55:32,380 --> 00:55:41,080
its neighbor foo route map route map

1335
00:55:35,859 --> 00:55:43,630
name in on foundry its neighbor foo<font color="#CCCCCC"> rap</font>

1336
00:55:41,080 --> 00:55:46,150
map in or<font color="#E5E5E5"> alt and then route map name</font>

1337
00:55:43,630 --> 00:55:47,880
when<font color="#E5E5E5"> i was playing with boundaries i</font>

1338
00:55:46,150 --> 00:55:50,619
<font color="#E5E5E5">actually almost became made clueless</font>

1339
00:55:47,880 --> 00:55:53,170
because i<font color="#E5E5E5"> pasted cut and pasted didn't</font>

1340
00:55:50,619 --> 00:55:54,490
notice that<font color="#E5E5E5"> the syntax on cisco was</font>

1341
00:55:53,170 --> 00:55:58,060
slightly dead and turned<font color="#E5E5E5"> up a bunch of</font>

1342
00:55:54,490 --> 00:55:59,618
sessions without route maps which caused

1343
00:55:58,060 --> 00:56:02,529
some complications which we then found

1344
00:55:59,619 --> 00:56:04,990
so important thing to note there if

1345
00:56:02,530 --> 00:56:07,150
you're using a not<font color="#E5E5E5"> cisco that sort of</font>

1346
00:56:04,990 --> 00:56:09,609
<font color="#CCCCCC">speak cisco make sure that all of the</font>

1347
00:56:07,150 --> 00:56:13,150
<font color="#E5E5E5">bgp related syntax is the same before</font>

1348
00:56:09,609 --> 00:56:16,540
you go<font color="#E5E5E5"> cutting and pasting so although</font>

1349
00:56:13,150 --> 00:56:18,670
generally the other goofy one is foundry

1350
00:56:16,540 --> 00:56:20,560
where cisco uses allow foundry uses

1351
00:56:18,670 --> 00:56:23,560
except and so they look the same but

1352
00:56:20,560 --> 00:56:25,480
they're they're<font color="#CCCCCC"> not really what like</font>

1353
00:56:23,560 --> 00:56:27,490
when you define like community lists and

1354
00:56:25,480 --> 00:56:29,470
things like that I've<font color="#E5E5E5"> seen</font><font color="#CCCCCC"> people get</font>

1355
00:56:27,490 --> 00:56:32,529
bit by that before where it's not quite

1356
00:56:29,470 --> 00:56:37,189
the exact same syntax<font color="#CCCCCC"> okay</font>

1357
00:56:32,530 --> 00:56:40,220
so for route maps thats a permit if the

1358
00:56:37,190 --> 00:56:42,620
first Clause there the match statement

1359
00:56:40,220 --> 00:56:45,169
is matched then the rep the route is

1360
00:56:42,620 --> 00:56:47,630
permitted if the route map says deny

1361
00:56:45,170 --> 00:56:49,460
that if the match is true it'll be

1362
00:56:47,630 --> 00:56:51,560
denied so it's a<font color="#E5E5E5"> little bit of reverse</font>

1363
00:56:49,460 --> 00:56:53,510
logic there that is sort of the way that

1364
00:56:51,560 --> 00:56:56,660
<font color="#E5E5E5">it should work but just you have to</font>

1365
00:56:53,510 --> 00:56:58,280
<font color="#CCCCCC">think about sometimes and then</font><font color="#E5E5E5"> if the</font>

1366
00:56:56,660 --> 00:57:00,529
match if the route hasn't been matched

1367
00:56:58,280 --> 00:57:02,030
<font color="#E5E5E5">by one of these earlier that will</font><font color="#CCCCCC"> just</font>

1368
00:57:00,530 --> 00:57:06,680
flow through to the next sequence number

1369
00:57:02,030 --> 00:57:09,710
until ugz they're matched or not so

1370
00:57:06,680 --> 00:57:12,290
selecting routes usually<font color="#E5E5E5"> there'll be two</font>

1371
00:57:09,710 --> 00:57:14,900
three four ways to get to a given remote

1372
00:57:12,290 --> 00:57:17,840
destination will call that two or three

1373
00:57:14,900 --> 00:57:19,280
or four<font color="#E5E5E5"> paths to the same prefix it can</font>

1374
00:57:17,840 --> 00:57:21,380
become confusing when you call up and

1375
00:57:19,280 --> 00:57:23,540
say I see three prefixes to get there

1376
00:57:21,380 --> 00:57:25,130
that typically means something<font color="#E5E5E5"> else if I</font>

1377
00:57:23,540 --> 00:57:28,670
see three prefixes it means there's more

1378
00:57:25,130 --> 00:57:30,530
specific and less specific but in BGP if

1379
00:57:28,670 --> 00:57:31,820
i'm peering if<font color="#E5E5E5"> i have transit full</font>

1380
00:57:30,530 --> 00:57:35,510
transit from two providers i'll have

1381
00:57:31,820 --> 00:57:39,080
generally two paths for every prefix and

1382
00:57:35,510 --> 00:57:40,940
then i<font color="#CCCCCC"> have to</font><font color="#E5E5E5"> pick the best one the</font>

1383
00:57:39,080 --> 00:57:45,049
really important thing to note is it's

1384
00:57:40,940 --> 00:57:47,450
not random the net effect if<font color="#CCCCCC"> you don't</font>

1385
00:57:45,050 --> 00:57:49,610
do any tuning is that you sort of get

1386
00:57:47,450 --> 00:57:51,799
statistical aggregation that can sort of

1387
00:57:49,610 --> 00:57:53,510
seemed like either randomness or magic

1388
00:57:51,800 --> 00:57:56,540
depending<font color="#CCCCCC"> on you know</font><font color="#E5E5E5"> the way you look</font>

1389
00:57:53,510 --> 00:57:58,700
at it but thought random her monistic

1390
00:57:56,540 --> 00:58:00,950
which means you can<font color="#E5E5E5"> always look at the</font>

1391
00:57:58,700 --> 00:58:03,230
<font color="#E5E5E5">input apply the rules and figure out</font>

1392
00:58:00,950 --> 00:58:05,540
what's going<font color="#E5E5E5"> on there is a very hold on</font>

1393
00:58:03,230 --> 00:58:07,040
hold on there is<font color="#CCCCCC"> an</font><font color="#E5E5E5"> exception certainly</font>

1394
00:58:05,540 --> 00:58:09,050
if you<font color="#E5E5E5"> set if you have multiple routers</font>

1395
00:58:07,040 --> 00:58:11,509
with the same router ID then you will

1396
00:58:09,050 --> 00:58:13,220
get random behavior there's actually a

1397
00:58:11,510 --> 00:58:15,710
problem where<font color="#E5E5E5"> cisco is non-deterministic</font>

1398
00:58:13,220 --> 00:58:19,000
where it will use the length of the

1399
00:58:15,710 --> 00:58:22,130
uptime of the session as a tiebreaker

1400
00:58:19,000 --> 00:58:24,710
what you're talking about with<font color="#E5E5E5"> us that's</font>

1401
00:58:22,130 --> 00:58:26,780
a cisco behavior you<font color="#E5E5E5"> can turn that off</font>

1402
00:58:24,710 --> 00:58:28,850
but by<font color="#E5E5E5"> default that's I don't know did</font>

1403
00:58:26,780 --> 00:58:30,350
<font color="#CCCCCC">they did they make that</font><font color="#E5E5E5"> did they turn</font>

1404
00:58:28,850 --> 00:58:32,560
that off by default is it still that way

1405
00:58:30,350 --> 00:58:32,560
I

1406
00:58:33,200 --> 00:58:39,020
<font color="#E5E5E5">oh but but you can someone please send</font>

1407
00:58:37,100 --> 00:58:40,730
me<font color="#CCCCCC"> email to remember to remind me to put</font>

1408
00:58:39,020 --> 00:58:42,320
that into<font color="#E5E5E5"> the presentation is</font><font color="#CCCCCC"> jess for</font>

1409
00:58:40,730 --> 00:58:43,430
example has a way to turn<font color="#CCCCCC"> that on to</font>

1410
00:58:42,320 --> 00:58:49,250
<font color="#E5E5E5">enable that it's called</font><font color="#CCCCCC"> Cisco</font>

1411
00:58:43,430 --> 00:58:53,120
<font color="#E5E5E5">non-deterministic have a cisco pull a</font>

1412
00:58:49,250 --> 00:58:55,100
route out of your ass mode<font color="#E5E5E5"> okay so and</font>

1413
00:58:53,120 --> 00:58:57,680
and and the reason that I stress that is

1414
00:58:55,100 --> 00:59:00,380
because again routing and figuring this

1415
00:58:57,680 --> 00:59:02,990
stuff out is the intersection<font color="#E5E5E5"> of a</font>

1416
00:59:00,380 --> 00:59:05,030
<font color="#E5E5E5">number</font><font color="#CCCCCC"> of basic principles right I'm</font>

1417
00:59:02,990 --> 00:59:07,459
always going to pick the most specific

1418
00:59:05,030 --> 00:59:09,650
<font color="#CCCCCC">route it was only one path that I think</font>

1419
00:59:07,460 --> 00:59:11,720
is best in BGP that's the only path that

1420
00:59:09,650 --> 00:59:13,640
I can advertise to<font color="#E5E5E5"> someone when I've got</font>

1421
00:59:11,720 --> 00:59:14,990
all the different paths to<font color="#CCCCCC"> a prefix</font>

1422
00:59:13,640 --> 00:59:18,529
there are some rules that I'm<font color="#E5E5E5"> going to</font>

1423
00:59:14,990 --> 00:59:19,580
apply so there's always you just think

1424
00:59:18,530 --> 00:59:21,080
of all the<font color="#E5E5E5"> different</font><font color="#CCCCCC"> things that</font>

1425
00:59:19,580 --> 00:59:23,990
interact and you can always<font color="#E5E5E5"> debug what's</font>

1426
00:59:21,080 --> 00:59:26,870
going on until you find a bug which will

1427
00:59:23,990 --> 00:59:29,500
happen more often than<font color="#CCCCCC"> it should so</font>

1428
00:59:26,870 --> 00:59:33,770
always find the<font color="#E5E5E5"> low specific route and</font>

1429
00:59:29,500 --> 00:59:35,720
only consider pads to the prefixes that

1430
00:59:33,770 --> 00:59:39,080
you can<font color="#E5E5E5"> get to so if you can't get</font><font color="#CCCCCC"> to</font>

1431
00:59:35,720 --> 00:59:40,009
the next top and unless<font color="#E5E5E5"> some tuning has</font>

1432
00:59:39,080 --> 00:59:42,470
been done generally you're going to

1433
00:59:40,010 --> 00:59:45,650
prefer the shortest day s path and then

1434
00:59:42,470 --> 00:59:49,299
<font color="#CCCCCC">med and</font><font color="#E5E5E5"> then down to router ID or what</font>

1435
00:59:45,650 --> 00:59:49,300
was it the uptime of the session

1436
00:59:52,340 --> 01:00:04,560
<font color="#CCCCCC">hmm</font><font color="#E5E5E5"> oh the uptime of the of the path but</font>

1437
01:00:01,830 --> 01:00:06,420
some of the session is the route<font color="#E5E5E5"> okay</font>

1438
01:00:04,560 --> 01:00:09,480
<font color="#E5E5E5">okay so that makes more sense</font><font color="#CCCCCC"> than the</font>

1439
01:00:06,420 --> 01:00:12,840
session but<font color="#E5E5E5"> okay it's still</font><font color="#CCCCCC"> not good but</font>

1440
01:00:09,480 --> 01:00:13,890
it makes more right<font color="#E5E5E5"> okay yes um or if</font>

1441
01:00:12,840 --> 01:00:16,890
you're using a weight which you

1442
01:00:13,890 --> 01:00:18,540
shouldn't use or a local pref or you've

1443
01:00:16,890 --> 01:00:21,270
<font color="#E5E5E5">Pat a dais path then that will happen</font>

1444
01:00:18,540 --> 01:00:23,520
before the route sort of as you got it

1445
01:00:21,270 --> 01:00:26,700
from<font color="#E5E5E5"> your provider so if you want to</font>

1446
01:00:23,520 --> 01:00:28,650
<font color="#E5E5E5">change what will happen by default the</font>

1447
01:00:26,700 --> 01:00:31,200
two most common methods are you can

1448
01:00:28,650 --> 01:00:34,470
change the local pref which will ignore

1449
01:00:31,200 --> 01:00:36,839
the AAS path or you can actually pad the

1450
01:00:34,470 --> 01:00:39,209
aspect you can make the route look

1451
01:00:36,840 --> 01:00:41,010
further away as you hear it from<font color="#E5E5E5"> a</font>

1452
01:00:39,210 --> 01:00:43,770
certain provider the problem with a s

1453
01:00:41,010 --> 01:00:47,340
path padding is while it does sort of

1454
01:00:43,770 --> 01:00:49,620
preserve the distance concept in the ass

1455
01:00:47,340 --> 01:00:53,130
path well first of all the distance in<font color="#E5E5E5"> a</font>

1456
01:00:49,620 --> 01:00:55,230
<font color="#E5E5E5">s pap is you know correlated but you</font>

1457
01:00:53,130 --> 01:00:56,490
know not<font color="#E5E5E5"> even fifty percent good for</font>

1458
01:00:55,230 --> 01:00:59,910
actually determining which is closer

1459
01:00:56,490 --> 01:01:01,169
which isn't but also if you're<font color="#E5E5E5"> sending</font>

1460
01:00:59,910 --> 01:01:02,759
routes to someone else and you start

1461
01:01:01,170 --> 01:01:04,650
<font color="#E5E5E5">playing with</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> s path then they may not</font>

1462
01:01:02,760 --> 01:01:06,420
like it because that you've taken<font color="#E5E5E5"> away</font>

1463
01:01:04,650 --> 01:01:08,970
their flexibility so that's why

1464
01:01:06,420 --> 01:01:12,470
generally people will use local<font color="#CCCCCC"> pref so</font>

1465
01:01:08,970 --> 01:01:15,209
bgp decision algorithm pretty standard

1466
01:01:12,470 --> 01:01:16,859
it is well it's now more standard for a

1467
01:01:15,210 --> 01:01:20,100
while there<font color="#E5E5E5"> was the RFC</font><font color="#CCCCCC"> and then there</font>

1468
01:01:16,860 --> 01:01:22,920
was what people did and<font color="#CCCCCC"> it's become more</font>

1469
01:01:20,100 --> 01:01:24,270
converge but<font color="#CCCCCC"> the basic things are if you</font>

1470
01:01:22,920 --> 01:01:26,060
<font color="#E5E5E5">have a route that you can get to that's</font>

1471
01:01:24,270 --> 01:01:30,150
the most specific<font color="#E5E5E5"> and you can get to</font>

1472
01:01:26,060 --> 01:01:32,009
you'll follow the a s path length unless

1473
01:01:30,150 --> 01:01:33,930
you've set something and the set setting

1474
01:01:32,010 --> 01:01:38,730
something could be changing the a s path

1475
01:01:33,930 --> 01:01:42,960
length or setting the local press so the

1476
01:01:38,730 --> 01:01:44,910
easiest way to<font color="#CCCCCC"> affect which route you're</font>

1477
01:01:42,960 --> 01:01:50,100
going to prefer is let's say you wanted

1478
01:01:44,910 --> 01:01:53,520
to deep preference uunet as heard from n

1479
01:01:50,100 --> 01:01:56,160
<font color="#E5E5E5">layer you'd make an ice bath access list</font>

1480
01:01:53,520 --> 01:01:57,330
that says permit underscore 701

1481
01:01:56,160 --> 01:02:01,830
underscore because you don't want<font color="#CCCCCC"> to be</font>

1482
01:01:57,330 --> 01:02:02,950
affecting 18t also and then you'd make a

1483
01:02:01,830 --> 01:02:05,920
route map

1484
01:02:02,950 --> 01:02:07,750
says if match that prefix if you<font color="#E5E5E5"> just</font>

1485
01:02:05,920 --> 01:02:10,329
put the a s path access-list on the

1486
01:02:07,750 --> 01:02:12,820
peering session then you'd only accept

1487
01:02:10,329 --> 01:02:14,380
routes from 701 so you need to use a

1488
01:02:12,820 --> 01:02:18,040
route map to give you more flexibility

1489
01:02:14,380 --> 01:02:19,780
<font color="#CCCCCC">it's a route map the pref match</font><font color="#E5E5E5"> asked</font>

1490
01:02:18,040 --> 01:02:24,849
<font color="#CCCCCC">about 50 and then you set an extra</font>

1491
01:02:19,780 --> 01:02:31,510
prepend that could be 4436 or in this

1492
01:02:24,849 --> 01:02:33,550
case yeah 4436 and then you would put

1493
01:02:31,510 --> 01:02:35,349
<font color="#CCCCCC">that and then I'm sorry then you use the</font>

1494
01:02:33,550 --> 01:02:37,480
route map and you'd say if I match that

1495
01:02:35,349 --> 01:02:41,020
then i set the local prep lower lower

1496
01:02:37,480 --> 01:02:42,250
than 100 i set the<font color="#CCCCCC"> little prof</font><font color="#E5E5E5"> 290 we'll</font>

1497
01:02:41,020 --> 01:02:43,869
talk<font color="#CCCCCC"> a little bit about this more later</font>

1498
01:02:42,250 --> 01:02:46,510
<font color="#CCCCCC">I just want to show you one of</font><font color="#E5E5E5"> the</font>

1499
01:02:43,869 --> 01:02:48,430
concepts if you so a s path you can

1500
01:02:46,510 --> 01:02:55,450
prepend or you can set the local pref

1501
01:02:48,430 --> 01:02:59,140
lower yeah<font color="#E5E5E5"> i just noticed that to extend</font>

1502
01:02:55,450 --> 01:03:02,980
it so rather vendors<font color="#E5E5E5"> cisco juniper how</font>

1503
01:02:59,140 --> 01:03:05,980
many people<font color="#CCCCCC"> use for routing use pc</font>

1504
01:03:02,980 --> 01:03:09,339
hardware server platform<font color="#CCCCCC"> plagas zebra</font>

1505
01:03:05,980 --> 01:03:13,420
anyone's still using gate d not that I'm

1506
01:03:09,339 --> 01:03:14,950
aware of<font color="#CCCCCC"> okay anything</font><font color="#E5E5E5"> else is doable a</font>

1507
01:03:13,420 --> 01:03:16,900
little adventurous the main thing i

1508
01:03:14,950 --> 01:03:18,819
would remind people as if it looks<font color="#CCCCCC"> like</font>

1509
01:03:16,900 --> 01:03:20,170
cisco but isn't cisco then test

1510
01:03:18,819 --> 01:03:22,509
everything because there'll be some

1511
01:03:20,170 --> 01:03:24,819
subtle differences and you may have to

1512
01:03:22,510 --> 01:03:26,859
remember what's show IP bgp neighbor

1513
01:03:24,819 --> 01:03:29,230
advertised or show IP bgp<font color="#CCCCCC"> advertise</font>

1514
01:03:26,859 --> 01:03:31,390
neighbor or you know what is the exact

1515
01:03:29,230 --> 01:03:33,010
syntax basically everything<font color="#E5E5E5"> will work</font>

1516
01:03:31,390 --> 01:03:35,140
for the pretty base for the pretty

1517
01:03:33,010 --> 01:03:39,670
starter topologies but when you<font color="#E5E5E5"> get into</font>

1518
01:03:35,140 --> 01:03:41,410
more complex bgp policy or bgp topology

1519
01:03:39,670 --> 01:03:43,450
that's where you become more<font color="#E5E5E5"> and more</font>

1520
01:03:41,410 --> 01:03:44,710
adventurous straying from the path of

1521
01:03:43,450 --> 01:03:46,598
the same vendors that everyone else are

1522
01:03:44,710 --> 01:03:50,650
using and you have to remember if you

1523
01:03:46,599 --> 01:03:52,150
use cisco juniper and foundry might be

1524
01:03:50,650 --> 01:03:54,250
getting into<font color="#E5E5E5"> their where if you have a</font>

1525
01:03:52,150 --> 01:03:55,869
blog if you have a problem at least a

1526
01:03:54,250 --> 01:03:58,960
significant portion of the internet<font color="#E5E5E5"> is</font>

1527
01:03:55,869 --> 01:04:01,569
seeing it but<font color="#E5E5E5"> if you</font><font color="#CCCCCC"> use you know</font><font color="#E5E5E5"> Joe</font>

1528
01:03:58,960 --> 01:04:03,940
router then you may be having serious

1529
01:04:01,569 --> 01:04:05,619
problems that no one else is seeing and

1530
01:04:03,940 --> 01:04:09,140
then your customer you know will be

1531
01:04:05,619 --> 01:04:12,240
unduly unhappy with you

1532
01:04:09,140 --> 01:04:15,598
right I mean I don't<font color="#CCCCCC"> think I've ever</font>

1533
01:04:12,240 --> 01:04:18,328
caused a major meltdown of the<font color="#CCCCCC"> internet</font>

1534
01:04:15,599 --> 01:04:20,160
by using<font color="#E5E5E5"> my own bgp implementation I</font>

1535
01:04:18,329 --> 01:04:22,289
think that's copy added properly but I

1536
01:04:20,160 --> 01:04:25,288
<font color="#E5E5E5">certainly have caused myself problems</font>

1537
01:04:22,289 --> 01:04:32,009
for reach ability of my own prefixes by

1538
01:04:25,289 --> 01:04:33,749
using my<font color="#E5E5E5"> own bgp implementation right i</font>

1539
01:04:32,009 --> 01:04:35,490
mean the key thing is you make the

1540
01:04:33,749 --> 01:04:37,169
updates and they're not<font color="#E5E5E5"> properly formed</font>

1541
01:04:35,490 --> 01:04:39,089
and then you find that different vendors

1542
01:04:37,170 --> 01:04:42,930
didn't do good error detection and then

1543
01:04:39,089 --> 01:04:44,578
you find some vendors accept those

1544
01:04:42,930 --> 01:04:46,288
routes and some vendors say those routes

1545
01:04:44,579 --> 01:04:48,059
are bad well that's the<font color="#E5E5E5"> worst case</font>

1546
01:04:46,289 --> 01:04:49,349
scenario where some vendors will accept

1547
01:04:48,059 --> 01:04:53,430
and propagate it and then others will

1548
01:04:49,349 --> 01:04:55,589
write a narrative Drive session right so

1549
01:04:53,430 --> 01:04:59,279
one thing we didn't talk<font color="#CCCCCC"> about and if</font>

1550
01:04:55,589 --> 01:05:01,499
you look<font color="#CCCCCC"> at the BGP protocol if you see</font>

1551
01:04:59,279 --> 01:05:03,720
a rel that's not valid either

1552
01:05:01,499 --> 01:05:05,368
syntactically or semantically you're

1553
01:05:03,720 --> 01:05:07,529
supposed to actually<font color="#CCCCCC"> send a notify</font>

1554
01:05:05,369 --> 01:05:09,269
message and tear down the session so

1555
01:05:07,529 --> 01:05:10,920
with<font color="#E5E5E5"> all the stuff</font><font color="#CCCCCC"> that we talked about</font>

1556
01:05:09,269 --> 01:05:13,439
about all the work<font color="#CCCCCC"> that goes on when you</font>

1557
01:05:10,920 --> 01:05:15,809
advertise or<font color="#CCCCCC"> D advertise a whole bunch</font>

1558
01:05:13,440 --> 01:05:18,799
<font color="#E5E5E5">of routes you can see that that would be</font>

1559
01:05:15,809 --> 01:05:21,210
bad<font color="#CCCCCC"> if it happened in sync across all</font>

1560
01:05:18,799 --> 01:05:22,529
vendor a routers couldn't talk<font color="#CCCCCC"> to all</font>

1561
01:05:21,210 --> 01:05:24,630
vendor be routers because there was a

1562
01:05:22,529 --> 01:05:26,279
route that they disagreed about whether

1563
01:05:24,630 --> 01:05:28,650
it was valid or not and so you want to

1564
01:05:26,279 --> 01:05:30,660
avoid<font color="#E5E5E5"> that but basically the other you</font>

1565
01:05:28,650 --> 01:05:33,420
know things work the when I first gave

1566
01:05:30,660 --> 01:05:36,509
this presentation God helped me 14 years

1567
01:05:33,420 --> 01:05:38,549
<font color="#E5E5E5">ago there was actually a section on not</font>

1568
01:05:36,509 --> 01:05:41,369
running full bgp but filtering and doing

1569
01:05:38,549 --> 01:05:44,489
partial bgp but you know it's it's

1570
01:05:41,369 --> 01:05:46,109
effectively the same cost to buy any any

1571
01:05:44,489 --> 01:05:48,119
device that<font color="#E5E5E5"> you would actually</font><font color="#CCCCCC"> run bgp</font>

1572
01:05:46,109 --> 01:05:50,519
on<font color="#E5E5E5"> we'll have enough</font><font color="#CCCCCC"> RAM nowadays and</font>

1573
01:05:48,119 --> 01:05:52,799
enough forwarding table to run full bgp

1574
01:05:50,519 --> 01:05:56,339
routes<font color="#CCCCCC"> i say that even</font><font color="#E5E5E5"> though i've got a</font>

1575
01:05:52,799 --> 01:05:58,710
<font color="#CCCCCC">3 B in my network that I'm hacking up</font>

1576
01:05:56,339 --> 01:06:01,700
how many<font color="#E5E5E5"> people I'm sorry was the shot</font>

1577
01:05:58,710 --> 01:06:01,700
shiny bald man what

1578
01:06:07,770 --> 01:06:13,170
on one<font color="#CCCCCC"> of my routers for usenet well if</font>

1579
01:06:11,460 --> 01:06:14,220
you get<font color="#CCCCCC"> your point</font><font color="#E5E5E5"> in where someone else</font>

1580
01:06:13,170 --> 01:06:23,970
somewhere else then they<font color="#E5E5E5"> won't be a</font>

1581
01:06:14,220 --> 01:06:26,160
problem right that's that's my my

1582
01:06:23,970 --> 01:06:28,379
theories is that next<font color="#E5E5E5"> year when this is</font>

1583
01:06:26,160 --> 01:06:30,060
presented is that you know ipv6 when it

1584
01:06:28,380 --> 01:06:32,160
continues to not be adopted will drive

1585
01:06:30,060 --> 01:06:33,840
the aggregation in the ipv4 space which

1586
01:06:32,160 --> 01:06:35,399
will then cause problems<font color="#E5E5E5"> and they've all</font>

1587
01:06:33,840 --> 01:06:37,380
all set up massive tunnel nets and<font color="#CCCCCC"> we'll</font>

1588
01:06:35,400 --> 01:06:39,240
have Sean Durran type I predict we'll be

1589
01:06:37,380 --> 01:06:41,190
talking about address face that people

1590
01:06:39,240 --> 01:06:44,069
do filtering and all the stuff from 14

1591
01:06:41,190 --> 01:06:45,860
years<font color="#CCCCCC"> ago in about a year should</font><font color="#E5E5E5"> we set</font>

1592
01:06:44,070 --> 01:06:48,360
up a lottery you know a pool on that

1593
01:06:45,860 --> 01:06:49,560
it's more<font color="#E5E5E5"> than more than nine more than</font>

1594
01:06:48,360 --> 01:06:54,300
six months less than three years

1595
01:06:49,560 --> 01:06:55,290
sometime in there so no one's going to

1596
01:06:54,300 --> 01:06:56,880
blame<font color="#CCCCCC"> you if you have a problem with</font>

1597
01:06:55,290 --> 01:06:59,910
<font color="#E5E5E5">Cisco juniper and there's a lot of help</font>

1598
01:06:56,880 --> 01:07:01,950
that you can get at some point there

1599
01:06:59,910 --> 01:07:04,589
will be a routing Rosetta so stoned

1600
01:07:01,950 --> 01:07:05,910
document or tutorial or something and if

1601
01:07:04,590 --> 01:07:07,470
anyone<font color="#E5E5E5"> would like to present that I</font>

1602
01:07:05,910 --> 01:07:11,250
think nanog is actively looking for

1603
01:07:07,470 --> 01:07:12,720
someone to do that but servers as

1604
01:07:11,250 --> 01:07:15,720
routers can work to the<font color="#CCCCCC"> many gigabits</font>

1605
01:07:12,720 --> 01:07:18,899
level now<font color="#E5E5E5"> I'm in computers are to some</font>

1606
01:07:15,720 --> 01:07:20,910
extent almost for everyday tasks and

1607
01:07:18,900 --> 01:07:23,190
like not running your router in<font color="#E5E5E5"> Java</font>

1608
01:07:20,910 --> 01:07:24,990
they're<font color="#E5E5E5"> infinitely fast and can do you</font>

1609
01:07:23,190 --> 01:07:27,780
know at least half line rate a 10 gig

1610
01:07:24,990 --> 01:07:30,000
and the key thing is the things that

1611
01:07:27,780 --> 01:07:31,440
aren't Cisco's<font color="#E5E5E5"> in</font><font color="#CCCCCC"> Dhahran junipers but</font>

1612
01:07:30,000 --> 01:07:35,820
look like Cisco can be a little bit

1613
01:07:31,440 --> 01:07:37,110
annoying the catalyst is probably the

1614
01:07:35,820 --> 01:07:39,330
thing when<font color="#CCCCCC"> people say what</font><font color="#E5E5E5"> should I run</font>

1615
01:07:37,110 --> 01:07:41,190
I just<font color="#CCCCCC"> point them to that because it's</font>

1616
01:07:39,330 --> 01:07:42,240
cisco like it's a switch router but then

1617
01:07:41,190 --> 01:07:45,510
again everything's a switch router

1618
01:07:42,240 --> 01:07:49,109
nowadays and you can run full bgp for

1619
01:07:45,510 --> 01:07:51,090
the base routers less than 20k the 48 by

1620
01:07:49,110 --> 01:07:54,720
gig or four by 10 gig cards or 10k or

1621
01:07:51,090 --> 01:07:57,240
less so really hard to complain juniper

1622
01:07:54,720 --> 01:08:00,660
MX is what<font color="#E5E5E5"> people say I want to get a</font>

1623
01:07:57,240 --> 01:08:02,850
<font color="#CCCCCC">good router</font><font color="#E5E5E5"> okay it's again it really is</font>

1624
01:08:00,660 --> 01:08:05,160
a switch router still it architect early

1625
01:08:02,850 --> 01:08:07,470
isn't it no the e<font color="#CCCCCC"> ex is a switch router</font>

1626
01:08:05,160 --> 01:08:10,950
the MX is a rebadged<font color="#CCCCCC"> t-series</font><font color="#E5E5E5"> with the</font>

1627
01:08:07,470 --> 01:08:12,899
quarter of the price<font color="#CCCCCC"> okay effectively</font>

1628
01:08:10,950 --> 01:08:15,660
<font color="#E5E5E5">not really but effectively so by default</font>

1629
01:08:12,900 --> 01:08:18,000
on the MX when you set a VLAN is it

1630
01:08:15,660 --> 01:08:20,278
unique to that port<font color="#E5E5E5"> okay so you have to</font>

1631
01:08:18,000 --> 01:08:21,509
do something to make it global<font color="#E5E5E5"> okay so</font>

1632
01:08:20,279 --> 01:08:22,980
it can be a switch

1633
01:08:21,509 --> 01:08:26,639
if you want it to but it's a router that

1634
01:08:22,979 --> 01:08:29,068
can be a switch<font color="#E5E5E5"> okay got it and then the</font>

1635
01:08:26,639 --> 01:08:30,690
foundry RX and<font color="#E5E5E5"> Alexa fmr while their</font>

1636
01:08:29,069 --> 01:08:33,089
full bgp speaking routers that are

1637
01:08:30,689 --> 01:08:36,750
alternatives and they basically<font color="#E5E5E5"> work for</font>

1638
01:08:33,089 --> 01:08:38,698
simple use cases<font color="#CCCCCC"> force 10 also</font><font color="#E5E5E5"> basically</font>

1639
01:08:36,750 --> 01:08:43,198
works if<font color="#E5E5E5"> you don't torture it for simply</font>

1640
01:08:38,698 --> 01:08:44,778
use cases inning so when you want a

1641
01:08:43,198 --> 01:08:47,278
<font color="#E5E5E5">multi-homed and you're going to use bgp</font>

1642
01:08:44,779 --> 01:08:48,509
the the key thing<font color="#CCCCCC"> to get in the habit of</font>

1643
01:08:47,279 --> 01:08:50,369
thinking<font color="#E5E5E5"> about is what do you want to</font>

1644
01:08:48,509 --> 01:08:53,969
accomplish what are you actually trying

1645
01:08:50,368 --> 01:08:55,348
to<font color="#E5E5E5"> get as the net result what do you</font>

1646
01:08:53,969 --> 01:08:58,859
<font color="#E5E5E5">want to advertise and what do you want</font>

1647
01:08:55,349 --> 01:09:00,089
to accept and as long as you go about it

1648
01:08:58,859 --> 01:09:03,089
thinking about it like that that's

1649
01:09:00,089 --> 01:09:04,799
really<font color="#E5E5E5"> the the mindset that you need so</font>

1650
01:09:03,089 --> 01:09:07,318
think about it<font color="#E5E5E5"> in advance make your</font>

1651
01:09:04,799 --> 01:09:09,238
access lists and then you can<font color="#E5E5E5"> set up the</font>

1652
01:09:07,319 --> 01:09:11,460
session it'll do basically what you want

1653
01:09:09,238 --> 01:09:13,049
<font color="#E5E5E5">you may need tuning you may find that</font>

1654
01:09:11,460 --> 01:09:16,019
the traffic<font color="#E5E5E5"> flow is not right or your</font>

1655
01:09:13,049 --> 01:09:17,339
performance problems or that you forgot

1656
01:09:16,019 --> 01:09:19,589
about<font color="#E5E5E5"> a prefix although it probably</font>

1657
01:09:17,339 --> 01:09:21,269
doesn't happen but plan your

1658
01:09:19,589 --> 01:09:25,500
configuration and start implementing it

1659
01:09:21,269 --> 01:09:27,389
before<font color="#CCCCCC"> you start typing so what's your</font>

1660
01:09:25,500 --> 01:09:29,908
policy<font color="#E5E5E5"> I want to advertise all of our</font>

1661
01:09:27,389 --> 01:09:33,779
routes all of them but only our routes

1662
01:09:29,908 --> 01:09:35,608
so don't advertise<font color="#CCCCCC"> third-party routes</font>

1663
01:09:33,779 --> 01:09:37,710
you assume your providers doing

1664
01:09:35,609 --> 01:09:41,460
filtering on you but that<font color="#E5E5E5"> may be a bad</font>

1665
01:09:37,710 --> 01:09:44,429
assumption we want to accept all routes

1666
01:09:41,460 --> 01:09:45,689
and let the router sort them out and if

1667
01:09:44,429 --> 01:09:47,670
we<font color="#E5E5E5"> don't have enough memory we can do</font>

1668
01:09:45,689 --> 01:09:48,988
filtering meaning if we don't have

1669
01:09:47,670 --> 01:09:52,799
<font color="#CCCCCC">enough memory start with none and then</font>

1670
01:09:48,988 --> 01:09:55,079
add some in and see how it goes and then

1671
01:09:52,799 --> 01:10:01,289
as we have traffic imbalance or

1672
01:09:55,079 --> 01:10:02,730
performance will change the mix so one

1673
01:10:01,289 --> 01:10:05,699
thing you<font color="#E5E5E5"> don't</font><font color="#CCCCCC"> want to do is black hole</font>

1674
01:10:02,730 --> 01:10:08,759
<font color="#E5E5E5">Carl benninger has anyone seen him on TV</font>

1675
01:10:05,699 --> 01:10:11,369
he's actually in the finance and so he

1676
01:10:08,760 --> 01:10:13,559
was a very litigious individual who was

1677
01:10:11,369 --> 01:10:15,989
a mean stay<font color="#E5E5E5"> about 10 years ago on</font>

1678
01:10:13,559 --> 01:10:20,699
different mailing lists and he and I

1679
01:10:15,989 --> 01:10:26,539
were both customers of<font color="#E5E5E5"> God what network</font>

1680
01:10:20,699 --> 01:10:30,239
was that no no before ages it was uh I

1681
01:10:26,539 --> 01:10:32,280
can't remember net 99 yes I don't know

1682
01:10:30,239 --> 01:10:34,500
why I was blanking on that so and he had

1683
01:10:32,280 --> 01:10:37,500
you<font color="#E5E5E5"> know octet you</font>

1684
01:10:34,500 --> 01:10:41,160
Oh octet a<font color="#CCCCCC"> docked at be</font><font color="#E5E5E5"> and I had opted</font>

1685
01:10:37,500 --> 01:10:43,320
octet be today and I you<font color="#CCCCCC"> know had</font>

1686
01:10:41,160 --> 01:10:45,870
dyslexia and started announcing his

1687
01:10:43,320 --> 01:10:48,120
address space and I was up visiting

1688
01:10:45,870 --> 01:10:50,490
panics in New York and they got a call

1689
01:10:48,120 --> 01:10:53,250
from karl denninger saying he was going

1690
01:10:50,490 --> 01:10:55,230
to sue panic sue me sue everybody

1691
01:10:53,250 --> 01:10:58,290
because<font color="#E5E5E5"> I was announcing his address</font>

1692
01:10:55,230 --> 01:11:00,000
space bottom line is in BGP there are

1693
01:10:58,290 --> 01:11:01,560
these<font color="#CCCCCC"> things there are filters but</font>

1694
01:11:00,000 --> 01:11:04,230
<font color="#CCCCCC">they're</font><font color="#E5E5E5"> tremendous number of people that</font>

1695
01:11:01,560 --> 01:11:05,430
aren't really applicable because if

1696
01:11:04,230 --> 01:11:07,469
<font color="#E5E5E5">you're large enough that you're peering</font>

1697
01:11:05,430 --> 01:11:08,430
with a lot of<font color="#E5E5E5"> people people your large</font>

1698
01:11:07,470 --> 01:11:12,390
enough that people generally are

1699
01:11:08,430 --> 01:11:15,420
building filters on you and if your

1700
01:11:12,390 --> 01:11:16,980
provider isn't filtered and they have a

1701
01:11:15,420 --> 01:11:18,060
mistake and<font color="#E5E5E5"> you make a mistake and then</font>

1702
01:11:16,980 --> 01:11:20,429
you're a denouncing someone else's

1703
01:11:18,060 --> 01:11:21,870
address space that could be bad so

1704
01:11:20,430 --> 01:11:23,430
because<font color="#E5E5E5"> you'll black hold of it</font>

1705
01:11:21,870 --> 01:11:29,640
somewhere specific the traffic will flow

1706
01:11:23,430 --> 01:11:33,300
through to you so black<font color="#CCCCCC"> hole EO know</font>

1707
01:11:29,640 --> 01:11:35,070
about that another interesting thing to

1708
01:11:33,300 --> 01:11:36,630
remember when you think about the

1709
01:11:35,070 --> 01:11:40,980
complexity of what you can implement in

1710
01:11:36,630 --> 01:11:43,770
BGP is your<font color="#E5E5E5"> provider has to believe that</font>

1711
01:11:40,980 --> 01:11:45,660
their path to you is the best one or

1712
01:11:43,770 --> 01:11:47,700
they could not advertise it to someone

1713
01:11:45,660 --> 01:11:50,040
else remember would be GP I can only

1714
01:11:47,700 --> 01:11:52,710
advertise my best round so<font color="#E5E5E5"> sometimes</font>

1715
01:11:50,040 --> 01:11:55,710
people<font color="#CCCCCC"> will say could you</font><font color="#E5E5E5"> please make it</font>

1716
01:11:52,710 --> 01:11:58,950
<font color="#E5E5E5">so that you only advertise my route in</font>

1717
01:11:55,710 --> 01:12:02,930
France if France Telecom is doing<font color="#E5E5E5"> more</font>

1718
01:11:58,950 --> 01:12:05,460
than<font color="#E5E5E5"> a gigabit and you don't hear my my</font>

1719
01:12:02,930 --> 01:12:08,160
you know you<font color="#CCCCCC"> Gannett route as heard in</font>

1720
01:12:05,460 --> 01:12:12,030
California and you know then I want you

1721
01:12:08,160 --> 01:12:14,490
<font color="#E5E5E5">to statically originated it what exactly</font>

1722
01:12:12,030 --> 01:12:16,860
so a lot of the flexibility<font color="#E5E5E5"> of what</font>

1723
01:12:14,490 --> 01:12:18,990
people want to<font color="#E5E5E5"> do is imp is limited by</font>

1724
01:12:16,860 --> 01:12:20,759
the fact that I can't advertise a route

1725
01:12:18,990 --> 01:12:22,889
to someone unless I think<font color="#CCCCCC"> it's</font><font color="#E5E5E5"> the best</font>

1726
01:12:20,760 --> 01:12:29,460
path and so that's important to remember

1727
01:12:22,890 --> 01:12:31,530
in this context so<font color="#CCCCCC"> multi-homing is</font>

1728
01:12:29,460 --> 01:12:32,910
everyone here is there anyone who is not

1729
01:12:31,530 --> 01:12:36,950
yet multihomed who is<font color="#CCCCCC"> planning on</font>

1730
01:12:32,910 --> 01:12:39,960
becoming multihomed anyone who would pay

1731
01:12:36,950 --> 01:12:42,780
more than fifty thousand dollars for

1732
01:12:39,960 --> 01:12:47,439
<font color="#CCCCCC">Class C audience</font>

1733
01:12:42,780 --> 01:12:49,478
okay if so soon afterwards generally

1734
01:12:47,439 --> 01:12:51,669
with when you're setting things up it's

1735
01:12:49,479 --> 01:12:54,159
good to<font color="#CCCCCC"> have</font><font color="#E5E5E5"> default routes also now</font>

1736
01:12:51,669 --> 01:12:55,419
default is one of the routes thought I

1737
01:12:54,159 --> 01:12:57,789
had that in here that's a little bit

1738
01:12:55,419 --> 01:12:59,349
different in that default will only be

1739
01:12:57,789 --> 01:13:02,459
sent if you actually say that<font color="#E5E5E5"> you want</font>

1740
01:12:59,349 --> 01:13:05,889
to originate the default route to appear

1741
01:13:02,459 --> 01:13:07,869
but<font color="#E5E5E5"> even if you're getting default route</font>

1742
01:13:05,889 --> 01:13:11,169
from your providers you may or may not

1743
01:13:07,869 --> 01:13:13,179
wish to have default routes why would

1744
01:13:11,169 --> 01:13:14,889
<font color="#E5E5E5">you want it well you may have</font><font color="#CCCCCC"> a problem</font>

1745
01:13:13,179 --> 01:13:17,019
<font color="#CCCCCC">your provider may change the config and</font>

1746
01:13:14,889 --> 01:13:19,479
you won't get it why would<font color="#E5E5E5"> you not</font><font color="#CCCCCC"> want</font>

1747
01:13:17,019 --> 01:13:21,219
it well if the<font color="#CCCCCC"> bgp sessions up but their</font>

1748
01:13:19,479 --> 01:13:23,079
router has become disconnected from the

1749
01:13:21,219 --> 01:13:24,820
rest of<font color="#E5E5E5"> their network you probably</font><font color="#CCCCCC"> don't</font>

1750
01:13:23,079 --> 01:13:26,768
want<font color="#CCCCCC"> to be defaulting to them so this</font><font color="#E5E5E5"> is</font>

1751
01:13:24,820 --> 01:13:29,079
something you can think<font color="#E5E5E5"> about do I want</font>

1752
01:13:26,769 --> 01:13:31,300
to<font color="#CCCCCC"> have default or not generally I would</font>

1753
01:13:29,079 --> 01:13:33,219
say for most providers it's good to<font color="#CCCCCC"> have</font>

1754
01:13:31,300 --> 01:13:34,929
a default route as a backup because

1755
01:13:33,219 --> 01:13:37,479
you're<font color="#E5E5E5"> going</font><font color="#CCCCCC"> to be more likely to be</font>

1756
01:13:34,929 --> 01:13:38,889
having you know playing if<font color="#CCCCCC"> you're just</font>

1757
01:13:37,479 --> 01:13:40,059
<font color="#E5E5E5">learning about routing you're going to</font>

1758
01:13:38,889 --> 01:13:42,880
be playing<font color="#E5E5E5"> with your router more than</font>

1759
01:13:40,059 --> 01:13:45,519
theirs<font color="#E5E5E5"> I'll throw in one disclaimer some</font>

1760
01:13:42,880 --> 01:13:48,280
<font color="#CCCCCC">vendors will match a default route when</font>

1761
01:13:45,519 --> 01:13:50,110
you say<font color="#E5E5E5"> redistribute static without</font>

1762
01:13:48,280 --> 01:13:51,789
having to specify default originating

1763
01:13:50,110 --> 01:13:54,188
<font color="#CCCCCC">Cisco will protect you against that but</font>

1764
01:13:51,789 --> 01:13:57,188
other vendors will not and this is cause

1765
01:13:54,189 --> 01:13:59,439
some global outages in the past was on

1766
01:13:57,189 --> 01:14:01,059
the outbound side not it's it's own the

1767
01:13:59,439 --> 01:14:02,139
outbound side it's so if you<font color="#E5E5E5"> just have a</font>

1768
01:14:01,059 --> 01:14:05,439
default route and then say I

1769
01:14:02,139 --> 01:14:07,269
<font color="#E5E5E5">redistribute static into bgp some</font>

1770
01:14:05,439 --> 01:14:09,849
routers will match your default and

1771
01:14:07,269 --> 01:14:11,619
start advertising that<font color="#CCCCCC"> okay about to</font>

1772
01:14:09,849 --> 01:14:14,139
take that<font color="#E5E5E5"> afterwards because</font><font color="#CCCCCC"> I'm</font>

1773
01:14:11,619 --> 01:14:16,148
<font color="#E5E5E5">interested because it's a question of</font>

1774
01:14:14,139 --> 01:14:20,110
does default become a BGP route itself

1775
01:14:16,149 --> 01:14:22,559
or is it and then there they don't have

1776
01:14:20,110 --> 01:14:26,259
felt the filters don't deal<font color="#E5E5E5"> with it okay</font>

1777
01:14:22,559 --> 01:14:27,489
so then you gather outbound is easy you

1778
01:14:26,260 --> 01:14:31,689
can make sure that you can get your

1779
01:14:27,489 --> 01:14:33,938
package out and then for sending your

1780
01:14:31,689 --> 01:14:36,489
routes out one thing you do not want<font color="#E5E5E5"> to</font>

1781
01:14:33,939 --> 01:14:38,619
do is tie your routes to an interface

1782
01:14:36,489 --> 01:14:40,688
you always want to statically you want

1783
01:14:38,619 --> 01:14:42,039
to make sure<font color="#E5E5E5"> that they exist basically</font>

1784
01:14:40,689 --> 01:14:46,809
forever you want to have some routes

1785
01:14:42,039 --> 01:14:48,280
that go to a loopback null 0 something

1786
01:14:46,809 --> 01:14:49,539
like that because you don't<font color="#E5E5E5"> have an</font>

1787
01:14:48,280 --> 01:14:50,889
interface going up and down and<font color="#CCCCCC"> have</font>

1788
01:14:49,539 --> 01:14:53,710
your route go up and down that

1789
01:14:50,890 --> 01:14:56,260
cause you massive problems so you create

1790
01:14:53,710 --> 01:14:58,750
your routes make sure<font color="#CCCCCC"> that they're</font>

1791
01:14:56,260 --> 01:15:00,820
always going the underlying routes that

1792
01:14:58,750 --> 01:15:04,090
have to match the BGP route always

1793
01:15:00,820 --> 01:15:06,580
<font color="#CCCCCC">exists make sure</font><font color="#E5E5E5"> that you've</font><font color="#CCCCCC"> got at</font>

1794
01:15:04,090 --> 01:15:08,260
least a permit everything at<font color="#CCCCCC"> least to</font>

1795
01:15:06,580 --> 01:15:11,080
deny everything and at least an access

1796
01:15:08,260 --> 01:15:14,830
list that talks about what you're a esas

1797
01:15:11,080 --> 01:15:17,320
are either just knew or your your

1798
01:15:14,830 --> 01:15:19,450
downstream then insert those routes<font color="#CCCCCC"> in</font>

1799
01:15:17,320 --> 01:15:21,370
<font color="#CCCCCC">to be GPA probably dunno sink and some</font>

1800
01:15:19,450 --> 01:15:25,540
other<font color="#CCCCCC"> things and then you're going to</font>

1801
01:15:21,370 --> 01:15:29,230
configure the neighbors how many people

1802
01:15:25,540 --> 01:15:31,480
<font color="#E5E5E5">here have configuration management</font>

1803
01:15:29,230 --> 01:15:37,360
systems that configure the routers for

1804
01:15:31,480 --> 01:15:38,919
them automatic automatically<font color="#CCCCCC"> okay not</font>

1805
01:15:37,360 --> 01:15:43,929
<font color="#CCCCCC">sure I believe everyone to raise their</font>

1806
01:15:38,920 --> 01:15:45,730
hand and but if you don't then<font color="#E5E5E5"> one thing</font>

1807
01:15:43,930 --> 01:15:50,110
<font color="#CCCCCC">you really want</font><font color="#E5E5E5"> to avoid is half</font>

1808
01:15:45,730 --> 01:15:53,290
configuring a session so one good way to

1809
01:15:50,110 --> 01:15:55,690
do it is by typing in<font color="#E5E5E5"> the neighbor</font>

1810
01:15:53,290 --> 01:15:58,000
<font color="#CCCCCC">shutdown or the neighbor you know first</font>

1811
01:15:55,690 --> 01:16:00,700
line then immediately shut down or cut

1812
01:15:58,000 --> 01:16:04,570
and<font color="#E5E5E5"> paste or gotta help you could tftp</font>

1813
01:16:00,700 --> 01:16:06,940
or something to make<font color="#CCCCCC"> the change if</font>

1814
01:16:04,570 --> 01:16:10,120
you're on a cisco where the CLI gives

1815
01:16:06,940 --> 01:16:12,929
you limited flexibility so you've got

1816
01:16:10,120 --> 01:16:16,120
actually it's probably<font color="#E5E5E5"> not even what is</font>

1817
01:16:12,930 --> 01:16:17,560
but might<font color="#CCCCCC"> not be 60 seconds I've seen</font>

1818
01:16:16,120 --> 01:16:22,840
<font color="#E5E5E5">sessions come up much faster than</font><font color="#CCCCCC"> I</font>

1819
01:16:17,560 --> 01:16:24,520
expected them to yes Kevin I haven't

1820
01:16:22,840 --> 01:16:27,250
<font color="#E5E5E5">seen two but I've definitely seen less</font>

1821
01:16:24,520 --> 01:16:28,450
close to a bit less<font color="#CCCCCC"> than 30 so you</font>

1822
01:16:27,250 --> 01:16:29,890
really want to<font color="#E5E5E5"> keep this in mind as</font>

1823
01:16:28,450 --> 01:16:31,690
you're configuring that that session

1824
01:16:29,890 --> 01:16:33,400
might start coming<font color="#E5E5E5"> up now I think the</font>

1825
01:16:31,690 --> 01:16:34,750
spec actually requires like 10 seconds

1826
01:16:33,400 --> 01:16:36,610
at idle before<font color="#E5E5E5"> it will try to come up</font>

1827
01:16:34,750 --> 01:16:38,260
but foundry recently added a feature

1828
01:16:36,610 --> 01:16:39,910
where by default the neighbor when you

1829
01:16:38,260 --> 01:16:41,860
create it comes up in<font color="#E5E5E5"> shutdown state</font>

1830
01:16:39,910 --> 01:16:43,090
which is<font color="#CCCCCC"> a very good</font><font color="#E5E5E5"> thing that people</font>

1831
01:16:41,860 --> 01:16:46,780
should<font color="#E5E5E5"> that's just go to do that is nice</font>

1832
01:16:43,090 --> 01:16:49,710
I argue<font color="#CCCCCC"> like that so one important thing</font>

1833
01:16:46,780 --> 01:16:53,200
also to remember is remember with bgp

1834
01:16:49,710 --> 01:16:55,660
session comes up i will<font color="#CCCCCC"> send you all my</font>

1835
01:16:53,200 --> 01:16:58,000
best routes through the filters and then

1836
01:16:55,660 --> 01:16:59,680
i'll only send you changes if the

1837
01:16:58,000 --> 01:17:01,630
session comes up and<font color="#CCCCCC"> i</font><font color="#E5E5E5"> start sending</font>

1838
01:16:59,680 --> 01:17:03,650
your routes before the filters are in

1839
01:17:01,630 --> 01:17:06,340
place<font color="#E5E5E5"> and</font><font color="#CCCCCC"> i apply the filters</font>

1840
01:17:03,650 --> 01:17:08,509
I the routes<font color="#E5E5E5"> that already went through</font>

1841
01:17:06,340 --> 01:17:10,100
you're already<font color="#E5E5E5"> going to</font><font color="#CCCCCC"> hear unless</font><font color="#E5E5E5"> I do</font>

1842
01:17:08,510 --> 01:17:12,320
something which<font color="#CCCCCC"> we'll talk</font><font color="#E5E5E5"> about to</font>

1843
01:17:10,100 --> 01:17:14,719
reapply those filters so that's why this

1844
01:17:12,320 --> 01:17:17,059
is<font color="#E5E5E5"> very important so neighbor</font>

1845
01:17:14,719 --> 01:17:20,360
configuration if you have two neighbors

1846
01:17:17,060 --> 01:17:22,820
put a description in say version 4 even

1847
01:17:20,360 --> 01:17:24,469
though it will<font color="#CCCCCC"> be next off self set next</font>

1848
01:17:22,820 --> 01:17:27,170
stop self because<font color="#E5E5E5"> God knows what weird</font>

1849
01:17:24,469 --> 01:17:29,659
topology you might get into with an

1850
01:17:27,170 --> 01:17:32,480
ethernet if you have a provider that

1851
01:17:29,659 --> 01:17:36,129
asks you to do ebgp<font color="#CCCCCC"> multi-hop change</font>

1852
01:17:32,480 --> 01:17:39,889
providers and don't use them so just

1853
01:17:36,130 --> 01:17:44,090
directly connected I didn't say that I

1854
01:17:39,890 --> 01:17:48,770
<font color="#E5E5E5">just said so you</font><font color="#CCCCCC"> want to have a prefixed</font>

1855
01:17:44,090 --> 01:17:50,300
list and a filter list that is only my

1856
01:17:48,770 --> 01:17:52,429
routes only my routes and only<font color="#E5E5E5"> minor</font>

1857
01:17:50,300 --> 01:17:54,920
asses you want to have a prefix list and

1858
01:17:52,429 --> 01:17:56,540
a filter list that says either in this

1859
01:17:54,920 --> 01:17:58,190
case the filter list one is<font color="#E5E5E5"> just a</font>

1860
01:17:56,540 --> 01:18:00,560
placeholder<font color="#E5E5E5"> for everything you don't</font>

1861
01:17:58,190 --> 01:18:02,089
need it there it's sort<font color="#E5E5E5"> of just a it's a</font>

1862
01:18:00,560 --> 01:18:05,840
reminder when I look at a config it

1863
01:18:02,090 --> 01:18:08,989
reminds me<font color="#E5E5E5"> Oh allowing everything the no</font>

1864
01:18:05,840 --> 01:18:12,620
bogans means don't allow RFC 1918 don't

1865
01:18:08,989 --> 01:18:14,750
allow I generally don't take unallocated

1866
01:18:12,620 --> 01:18:16,909
address space and filter it because well

1867
01:18:14,750 --> 01:18:18,409
pretty soon we won't have any real

1868
01:18:16,909 --> 01:18:20,509
unallocated address space<font color="#CCCCCC"> I mean</font>

1869
01:18:18,409 --> 01:18:22,940
multicast whatever but the key thing

1870
01:18:20,510 --> 01:18:25,820
there is I think don't allow your<font color="#CCCCCC"> own</font>

1871
01:18:22,940 --> 01:18:28,879
routes in unless you're specifically

1872
01:18:25,820 --> 01:18:32,750
allowing customers to<font color="#CCCCCC"> take them and then</font>

1873
01:18:28,880 --> 01:18:34,610
test it do shawty bgp before anything is

1874
01:18:32,750 --> 01:18:36,770
up you should<font color="#E5E5E5"> see your routes if you</font>

1875
01:18:34,610 --> 01:18:38,030
don't you won't expect anyone else to

1876
01:18:36,770 --> 01:18:40,570
see them you have to see them<font color="#CCCCCC"> before you</font>

1877
01:18:38,030 --> 01:18:44,059
<font color="#CCCCCC">can send them when the sessions are up</font>

1878
01:18:40,570 --> 01:18:45,590
do a show IP bgp neighbor advertised<font color="#CCCCCC"> i</font>

1879
01:18:44,060 --> 01:18:47,690
think if you're on a founder it'll be

1880
01:18:45,590 --> 01:18:49,310
show IP bgp advertised neighbor

1881
01:18:47,690 --> 01:18:51,769
ip-address backwards or something like

1882
01:18:49,310 --> 01:18:54,199
that but and you should see<font color="#CCCCCC"> that your</font>

1883
01:18:51,770 --> 01:18:56,420
advertising those routes go to a looking

1884
01:18:54,199 --> 01:18:59,330
glass is there an extra stuff two<font color="#CCCCCC"> checks</font>

1885
01:18:56,420 --> 01:19:02,360
not<font color="#E5E5E5"> net anymore ok Google looking glass</font>

1886
01:18:59,330 --> 01:19:04,850
and when we find a looking glass and see

1887
01:19:02,360 --> 01:19:06,739
how other people see or our view route

1888
01:19:04,850 --> 01:19:09,920
views that<font color="#E5E5E5"> our view our views Ralph</font>

1889
01:19:06,739 --> 01:19:13,360
hughesnet or Ralph dash<font color="#CCCCCC"> views that Ralph</font>

1890
01:19:09,920 --> 01:19:16,380
used yes<font color="#CCCCCC"> ok something like that google</font>

1891
01:19:13,360 --> 01:19:18,839
route server and

1892
01:19:16,380 --> 01:19:21,540
go in and look at<font color="#CCCCCC"> it and so it's that's</font>

1893
01:19:18,840 --> 01:19:23,610
what's really very important is remember

1894
01:19:21,540 --> 01:19:25,530
your inbound path is influenced by how

1895
01:19:23,610 --> 01:19:26,790
people see you so if you want<font color="#E5E5E5"> to see how</font>

1896
01:19:25,530 --> 01:19:29,040
<font color="#CCCCCC">people are seeing you you need to go</font>

1897
01:19:26,790 --> 01:19:30,930
outside your network<font color="#CCCCCC"> you may also</font><font color="#E5E5E5"> be</font>

1898
01:19:29,040 --> 01:19:32,400
able<font color="#E5E5E5"> to trade get servers on other</font>

1899
01:19:30,930 --> 01:19:35,160
networks just part of general network

1900
01:19:32,400 --> 01:19:38,070
debugging is making sure<font color="#CCCCCC"> that you've got</font>

1901
01:19:35,160 --> 01:19:40,080
<font color="#E5E5E5">the flexibility to see how people get</font>

1902
01:19:38,070 --> 01:19:42,830
back to you I remember one of<font color="#E5E5E5"> the</font>

1903
01:19:40,080 --> 01:19:45,990
challenges that I had over time is if

1904
01:19:42,830 --> 01:19:47,880
all your friends start connecting to you

1905
01:19:45,990 --> 01:19:49,410
then all the sudden all the boxes that

1906
01:19:47,880 --> 01:19:52,170
<font color="#CCCCCC">you set up all the all over the internet</font>

1907
01:19:49,410 --> 01:19:53,400
that help you figure out what<font color="#E5E5E5"> screwed up</font>

1908
01:19:52,170 --> 01:19:55,470
on your<font color="#E5E5E5"> network don't work because</font>

1909
01:19:53,400 --> 01:19:59,360
they're now on your network and<font color="#E5E5E5"> this is</font>

1910
01:19:55,470 --> 01:19:59,360
a recurring<font color="#E5E5E5"> problem that I seem to have</font>

1911
01:20:01,040 --> 01:20:06,000
<font color="#E5E5E5">okay so preferring routes we talked</font>

1912
01:20:03,630 --> 01:20:09,920
about<font color="#E5E5E5"> this a little bit before but the</font>

1913
01:20:06,000 --> 01:20:14,700
easiest way is to match on the ASP and

1914
01:20:09,920 --> 01:20:18,800
prepend the<font color="#E5E5E5"> a s path or use the</font>

1915
01:20:14,700 --> 01:20:20,970
photograph<font color="#E5E5E5"> and pretty much everyone I</font>

1916
01:20:18,800 --> 01:20:23,610
just recommend that people use local

1917
01:20:20,970 --> 01:20:27,570
<font color="#E5E5E5">pref this is so just the argument here</font>

1918
01:20:23,610 --> 01:20:29,309
goes let's say that<font color="#CCCCCC"> I am</font><font color="#E5E5E5"> a an edge</font>

1919
01:20:27,570 --> 01:20:31,950
network and I'm connected to provider

1920
01:20:29,310 --> 01:20:33,720
and provider<font color="#E5E5E5"> being and I've got a much</font>

1921
01:20:31,950 --> 01:20:35,490
bigger pipe to provider a than provider

1922
01:20:33,720 --> 01:20:38,670
<font color="#E5E5E5">B which I would argue is your fault not</font>

1923
01:20:35,490 --> 01:20:42,420
<font color="#E5E5E5">the rest of the Internet's fault so what</font>

1924
01:20:38,670 --> 01:20:44,610
do i do I prepend extra copies of my

1925
01:20:42,420 --> 01:20:46,410
autonomous system number on the smaller

1926
01:20:44,610 --> 01:20:47,880
pipe on provider be to the smaller pipe

1927
01:20:46,410 --> 01:20:50,070
and what does that<font color="#E5E5E5"> do</font><font color="#CCCCCC"> it makes it look</font>

1928
01:20:47,880 --> 01:20:52,050
further away which means<font color="#E5E5E5"> less traffic</font>

1929
01:20:50,070 --> 01:20:54,870
will flow<font color="#E5E5E5"> to it and i would say plus or</font>

1930
01:20:52,050 --> 01:20:56,340
minus fifty percent you know<font color="#E5E5E5"> it's not</font>

1931
01:20:54,870 --> 01:20:58,290
going to be ninety percent it's not

1932
01:20:56,340 --> 01:21:00,360
going to be ten percent it's you know

1933
01:20:58,290 --> 01:21:02,100
plus or minus fifty percent of<font color="#E5E5E5"> the nets</font>

1934
01:21:00,360 --> 01:21:03,450
going to honor that<font color="#E5E5E5"> and the other fifty</font>

1935
01:21:02,100 --> 01:21:07,590
percent will be<font color="#CCCCCC"> seing local press and</font>

1936
01:21:03,450 --> 01:21:10,860
they won't honor it and the<font color="#E5E5E5"> idea there</font>

1937
01:21:07,590 --> 01:21:13,410
is the argument against using local

1938
01:21:10,860 --> 01:21:15,599
processes some providers at the edge of

1939
01:21:13,410 --> 01:21:17,639
that are trying<font color="#E5E5E5"> to tell you what</font><font color="#CCCCCC"> to use</font>

1940
01:21:15,600 --> 01:21:19,530
and what to avoid and when you use local

1941
01:21:17,640 --> 01:21:23,400
pref you're throwing that information

1942
01:21:19,530 --> 01:21:25,769
way but i would<font color="#CCCCCC"> say for simplicity</font>

1943
01:21:23,400 --> 01:21:27,690
probably use local pref to prefer routes

1944
01:21:25,770 --> 01:21:28,060
also if<font color="#CCCCCC"> you have downstream customers</font>

1945
01:21:27,690 --> 01:21:30,190
you're pretty

1946
01:21:28,060 --> 01:21:32,500
have to because if you start playing

1947
01:21:30,190 --> 01:21:35,650
<font color="#E5E5E5">with a SPF your downstream customers are</font>

1948
01:21:32,500 --> 01:21:37,960
going going<font color="#E5E5E5"> to get unhappy so outbound</font>

1949
01:21:35,650 --> 01:21:40,660
is easy you can always set static routes

1950
01:21:37,960 --> 01:21:42,600
you can do route maps setting your

1951
01:21:40,660 --> 01:21:45,460
outbound as easy and as a corollary

1952
01:21:42,600 --> 01:21:48,130
setting your inbound has to be not easy

1953
01:21:45,460 --> 01:21:49,390
because your inbound is someone else's

1954
01:21:48,130 --> 01:21:51,100
outbound<font color="#CCCCCC"> and then they can completely</font>

1955
01:21:49,390 --> 01:21:53,380
control it so it's a little<font color="#CCCCCC"> bit more</font>

1956
01:21:51,100 --> 01:21:55,420
complex how do you<font color="#E5E5E5"> make</font><font color="#CCCCCC"> ralphs get back</font>

1957
01:21:53,380 --> 01:21:57,960
into how do you select how people get

1958
01:21:55,420 --> 01:22:00,340
back to you it's a<font color="#E5E5E5"> little bit less</font>

1959
01:21:57,960 --> 01:22:03,990
subtle it's a<font color="#E5E5E5"> little bit more like</font>

1960
01:22:00,340 --> 01:22:06,010
sledgehammer you can d aggregate or

1961
01:22:03,990 --> 01:22:08,769
selectively the aggregate so you

1962
01:22:06,010 --> 01:22:11,890
basically say provider a provider be I

1963
01:22:08,770 --> 01:22:13,030
can I ask path pad that didn't work<font color="#E5E5E5"> so</font>

1964
01:22:11,890 --> 01:22:16,720
what I'm going to do is I'm going<font color="#CCCCCC"> to</font>

1965
01:22:13,030 --> 01:22:20,050
announce half of my 20 23 out this path

1966
01:22:16,720 --> 01:22:22,990
so at<font color="#E5E5E5"> this path it's going to get the</font>

1967
01:22:20,050 --> 01:22:25,960
<font color="#E5E5E5">other half in this path above 23 it'll</font>

1968
01:22:22,990 --> 01:22:27,700
get just the 24 worth it's not<font color="#E5E5E5"> that</font><font color="#CCCCCC"> kind</font>

1969
01:22:25,960 --> 01:22:30,550
to the internet but<font color="#E5E5E5"> people certainly do</font>

1970
01:22:27,700 --> 01:22:32,620
it<font color="#E5E5E5"> yes you can also selectively</font>

1971
01:22:30,550 --> 01:22:34,390
advertise with community so have your

1972
01:22:32,620 --> 01:22:36,010
transit provider only sent to a couple

1973
01:22:34,390 --> 01:22:40,000
of networks<font color="#CCCCCC"> as a</font><font color="#E5E5E5"> way to reduce what</font>

1974
01:22:36,010 --> 01:22:41,440
comes in yep we'll get<font color="#E5E5E5"> to</font><font color="#CCCCCC"> that so you</font>

1975
01:22:40,000 --> 01:22:44,980
can't get<font color="#E5E5E5"> down to the granularity of</font>

1976
01:22:41,440 --> 01:22:49,330
saying the CEO of the company that<font color="#CCCCCC"> is my</font>

1977
01:22:44,980 --> 01:22:52,599
customer lives in you know Joe town and

1978
01:22:49,330 --> 01:22:56,230
is on Bob Joe Bob net and I wish to make

1979
01:22:52,600 --> 01:22:58,420
his IP address come back<font color="#CCCCCC"> in to me via my</font>

1980
01:22:56,230 --> 01:23:01,540
provider a pipe that's what you can't do

1981
01:22:58,420 --> 01:23:03,700
you can say pull more traffic here or

1982
01:23:01,540 --> 01:23:05,650
with communities which I will talk about

1983
01:23:03,700 --> 01:23:07,150
you can be a<font color="#E5E5E5"> little bit you can get a</font>

1984
01:23:05,650 --> 01:23:09,280
little<font color="#E5E5E5"> bit more finesse but ultimately</font>

1985
01:23:07,150 --> 01:23:11,379
remember Joe Bob net can always set a

1986
01:23:09,280 --> 01:23:12,670
static route back to you through

1987
01:23:11,380 --> 01:23:16,500
whatever they want and you lose control

1988
01:23:12,670 --> 01:23:19,720
<font color="#E5E5E5">it's the car away there so first method</font>

1989
01:23:16,500 --> 01:23:22,540
advertise more specifics second method<font color="#E5E5E5"> a</font>

1990
01:23:19,720 --> 01:23:25,660
<font color="#E5E5E5">SPF prepend so if you want to advertise</font>

1991
01:23:22,540 --> 01:23:30,370
more specifics you'd have a<font color="#CCCCCC"> prefixed</font>

1992
01:23:25,660 --> 01:23:32,680
list that is the 23 on<font color="#CCCCCC"> the 24 and then a</font>

1993
01:23:30,370 --> 01:23:34,870
<font color="#CCCCCC">prefix</font><font color="#E5E5E5"> list that's just the 23 and then</font>

1994
01:23:32,680 --> 01:23:37,110
you use different prefix lists to each

1995
01:23:34,870 --> 01:23:39,849
provider

1996
01:23:37,110 --> 01:23:42,190
the other way is communities which I

1997
01:23:39,850 --> 01:23:43,830
didn't go into a great deal because as I

1998
01:23:42,190 --> 01:23:46,240
figured we have about<font color="#E5E5E5"> eight minutes left</font>

1999
01:23:43,830 --> 01:23:48,370
the BGP community is one of<font color="#E5E5E5"> those</font>

2000
01:23:46,240 --> 01:23:50,380
attributes and it's just a number that

2001
01:23:48,370 --> 01:23:52,690
you put<font color="#CCCCCC"> on a</font><font color="#E5E5E5"> route and what people do</font>

2002
01:23:50,380 --> 01:23:56,680
with it is they let you put numbers on

2003
01:23:52,690 --> 01:23:58,870
the route that<font color="#E5E5E5"> influence how they handle</font>

2004
01:23:56,680 --> 01:24:00,670
your realm they also can send you those

2005
01:23:58,870 --> 01:24:03,309
BGP communities that tell you something

2006
01:24:00,670 --> 01:24:06,310
about<font color="#E5E5E5"> the route to tell you how much</font>

2007
01:24:03,310 --> 01:24:09,760
they prefer it how far away it is how

2008
01:24:06,310 --> 01:24:11,200
they heard it on the<font color="#E5E5E5"> outbound side on</font>

2009
01:24:09,760 --> 01:24:14,790
the inbound side to them the outbound

2010
01:24:11,200 --> 01:24:18,309
from you you can use the community to

2011
01:24:14,790 --> 01:24:21,910
tell the provider something like prepend

2012
01:24:18,310 --> 01:24:25,660
this route once 2701 but not to anyone

2013
01:24:21,910 --> 01:24:27,790
<font color="#E5E5E5">else or if you hear this route for me at</font>

2014
01:24:25,660 --> 01:24:30,040
multiple locations don't prefer this

2015
01:24:27,790 --> 01:24:32,590
location prefer some other location so

2016
01:24:30,040 --> 01:24:34,990
you can<font color="#E5E5E5"> actually often the providers</font>

2017
01:24:32,590 --> 01:24:37,180
will say here<font color="#CCCCCC"> are my list</font><font color="#E5E5E5"> of communities</font>

2018
01:24:34,990 --> 01:24:39,490
and if you set this community will set

2019
01:24:37,180 --> 01:24:42,310
my internal local / f below 100 or above

2020
01:24:39,490 --> 01:24:44,559
100 you know as I hear it from you how

2021
01:24:42,310 --> 01:24:48,250
many people<font color="#E5E5E5"> here</font><font color="#CCCCCC"> have not used bgb</font>

2022
01:24:44,560 --> 01:24:50,320
communities how many<font color="#E5E5E5"> people have not</font>

2023
01:24:48,250 --> 01:24:53,140
<font color="#E5E5E5">used communities but have seen their</font>

2024
01:24:50,320 --> 01:24:56,230
providers that have lists of<font color="#E5E5E5"> BGP</font>

2025
01:24:53,140 --> 01:24:59,680
communities they can set so if you're

2026
01:24:56,230 --> 01:25:03,009
curious I would advise<font color="#CCCCCC"> you look at at</font>

2027
01:24:59,680 --> 01:25:06,100
<font color="#E5E5E5">the nanog in the Dominican Republic</font>

2028
01:25:03,010 --> 01:25:08,830
there<font color="#E5E5E5"> was a BGP 102 presentation that</font>

2029
01:25:06,100 --> 01:25:10,990
talks<font color="#E5E5E5"> about the BGP communities and how</font>

2030
01:25:08,830 --> 01:25:12,370
to use them and has an example of a

2031
01:25:10,990 --> 01:25:14,650
whole network and one of the<font color="#E5E5E5"> things that</font>

2032
01:25:12,370 --> 01:25:16,870
set up is communities<font color="#E5E5E5"> I also did a</font>

2033
01:25:14,650 --> 01:25:18,519
presentation back in like one<font color="#CCCCCC"> of the</font>

2034
01:25:16,870 --> 01:25:20,349
Seattle ones you can find<font color="#CCCCCC"> at the</font>

2035
01:25:18,520 --> 01:25:21,850
archives it's like how to implement a

2036
01:25:20,350 --> 01:25:24,220
complex Community system with a whole

2037
01:25:21,850 --> 01:25:25,930
bunch<font color="#E5E5E5"> of details in jizz advanced topic</font>

2038
01:25:24,220 --> 01:25:28,690
but right there yeah in general

2039
01:25:25,930 --> 01:25:32,410
providers don't<font color="#E5E5E5"> offer you these things</font>

2040
01:25:28,690 --> 01:25:35,469
unless<font color="#E5E5E5"> they're n layer if you ask</font>

2041
01:25:32,410 --> 01:25:37,660
they'll give it<font color="#CCCCCC"> to you but because</font><font color="#E5E5E5"> it</font>

2042
01:25:35,470 --> 01:25:38,980
involves you know<font color="#E5E5E5"> basically if people</font>

2043
01:25:37,660 --> 01:25:40,900
have never<font color="#E5E5E5"> set communities learning</font>

2044
01:25:38,980 --> 01:25:42,429
about it they don't want<font color="#CCCCCC"> to have as</font><font color="#E5E5E5"> part</font>

2045
01:25:40,900 --> 01:25:43,960
of the turn up process having<font color="#E5E5E5"> to explain</font>

2046
01:25:42,430 --> 01:25:45,820
<font color="#E5E5E5">about you know BGP and look at your</font>

2047
01:25:43,960 --> 01:25:46,930
configs but it gives you a lot of

2048
01:25:45,820 --> 01:25:49,269
generally will give you a lot of

2049
01:25:46,930 --> 01:25:49,840
flexibility<font color="#E5E5E5"> I would never buy from</font>

2050
01:25:49,270 --> 01:25:52,210
anyone

2051
01:25:49,840 --> 01:25:54,790
give me didn't have a reasonable

2052
01:25:52,210 --> 01:25:56,500
community system to allow me<font color="#CCCCCC"> to specify</font>

2053
01:25:54,790 --> 01:25:58,389
what to do because you don't your

2054
01:25:56,500 --> 01:25:59,920
provider doesn't I don't<font color="#CCCCCC"> it's</font><font color="#E5E5E5"> not only</font>

2055
01:25:58,389 --> 01:26:01,659
my provider doesn't want to be woken up

2056
01:25:59,920 --> 01:26:03,369
I don't want to<font color="#E5E5E5"> have to deal with a</font>

2057
01:26:01,659 --> 01:26:04,929
human to be able<font color="#E5E5E5"> to do something</font><font color="#CCCCCC"> it's</font>

2058
01:26:03,369 --> 01:26:06,098
<font color="#CCCCCC">like I love booking online I don't want</font>

2059
01:26:04,929 --> 01:26:08,110
to call<font color="#E5E5E5"> human and do something</font><font color="#CCCCCC"> because</font>

2060
01:26:06,099 --> 01:26:09,429
they'll do it wrong and it'll be slow I

2061
01:26:08,110 --> 01:26:11,259
want<font color="#E5E5E5"> to be able to have the control of</font>

2062
01:26:09,429 --> 01:26:13,000
my own because<font color="#CCCCCC"> I may</font><font color="#E5E5E5"> need to play with a</font>

2063
01:26:11,260 --> 01:26:15,880
<font color="#E5E5E5">few</font><font color="#CCCCCC"> different things look at a route</font>

2064
01:26:13,000 --> 01:26:18,310
view see what's going on and that's<font color="#E5E5E5"> just</font>

2065
01:26:15,880 --> 01:26:20,920
<font color="#CCCCCC">not going</font><font color="#E5E5E5"> to survive a open a ticket get</font>

2066
01:26:18,310 --> 01:26:22,360
something done and send it back also the

2067
01:26:20,920 --> 01:26:24,750
fact that there's a community system in

2068
01:26:22,360 --> 01:26:26,679
place means that there's a lot<font color="#CCCCCC"> of good</font>

2069
01:26:24,750 --> 01:26:28,030
<font color="#E5E5E5">automation of the network which means</font>

2070
01:26:26,679 --> 01:26:30,280
the network itself is going to be more

2071
01:26:28,030 --> 01:26:32,019
stable because humans aren't having to

2072
01:26:30,280 --> 01:26:33,369
go in and put you know little shims in

2073
01:26:32,020 --> 01:26:35,020
<font color="#E5E5E5">for people but don't you know that</font>

2074
01:26:33,369 --> 01:26:36,339
communities are proprietary and that

2075
01:26:35,020 --> 01:26:38,440
would be violating their<font color="#CCCCCC"> India's if they</font>

2076
01:26:36,340 --> 01:26:41,469
were to send them to you like Verizon

2077
01:26:38,440 --> 01:26:44,888
well I might or might not buy from

2078
01:26:41,469 --> 01:26:47,050
networks that had that kind of yes well

2079
01:26:44,889 --> 01:26:48,610
but<font color="#E5E5E5"> it's it come on you have to admit it</font>

2080
01:26:47,050 --> 01:26:49,659
is fun to<font color="#E5E5E5"> reverse-engineer someone's</font>

2081
01:26:48,610 --> 01:26:51,790
communities when they won't give it to

2082
01:26:49,659 --> 01:26:52,960
you right it's a little<font color="#E5E5E5"> bit harder to</font>

2083
01:26:51,790 --> 01:26:56,650
reverse engineer<font color="#E5E5E5"> their help done</font>

2084
01:26:52,960 --> 01:26:58,889
communities but so bgp 102 and some

2085
01:26:56,650 --> 01:27:02,138
other presentations communities the

2086
01:26:58,889 --> 01:27:06,400
generally what the medium to larger guys

2087
01:27:02,139 --> 01:27:08,230
used to change their inbound path but

2088
01:27:06,400 --> 01:27:10,900
again<font color="#E5E5E5"> the first ones are you can</font>

2089
01:27:08,230 --> 01:27:14,138
advertise<font color="#E5E5E5"> more specifics or you can ask</font>

2090
01:27:10,900 --> 01:27:17,170
path pad and then communities is general

2091
01:27:14,139 --> 01:27:21,310
are generally the<font color="#CCCCCC"> way two people</font><font color="#E5E5E5"> do so</font>

2092
01:27:17,170 --> 01:27:22,810
iOS commands other than<font color="#E5E5E5"> just config i'm</font>

2093
01:27:21,310 --> 01:27:25,630
going<font color="#E5E5E5"> to assume most people have turned</font>

2094
01:27:22,810 --> 01:27:29,349
up sessions show IP bgp on a router IP

2095
01:27:25,630 --> 01:27:32,320
bgp some learning the output of show IP

2096
01:27:29,349 --> 01:27:33,969
bgp somehow to see<font color="#E5E5E5"> your clear</font><font color="#CCCCCC"> apg IP bgp</font>

2097
01:27:32,320 --> 01:27:35,349
command is wrong in cisco there's no

2098
01:27:33,969 --> 01:27:36,849
neighbor and foundry there is a neighbor

2099
01:27:35,349 --> 01:27:40,929
which is another one of those weird

2100
01:27:36,849 --> 01:27:42,849
differences<font color="#CCCCCC"> okay I've met it so one</font>

2101
01:27:40,929 --> 01:27:47,770
thing you know just very important if

2102
01:27:42,849 --> 01:27:51,719
you want<font color="#E5E5E5"> to reapply filter changes the</font>

2103
01:27:47,770 --> 01:27:55,080
command is clear IP bgp neighbor IP soft

2104
01:27:51,719 --> 01:27:55,080
remember the soft

2105
01:27:55,789 --> 01:28:01,050
well<font color="#E5E5E5"> I would say note the clear and thus</font>

2106
01:27:58,920 --> 01:28:03,599
remember the soft it is not pleased to

2107
01:28:01,050 --> 01:28:08,070
<font color="#E5E5E5">gently reapply all of my filters kind</font>

2108
01:28:03,599 --> 01:28:10,769
router it is clear which means you know

2109
01:28:08,070 --> 01:28:13,380
so the<font color="#E5E5E5"> idea is remember that you must</font>

2110
01:28:10,769 --> 01:28:15,300
have a soft what soft does is say I will

2111
01:28:13,380 --> 01:28:17,190
reevaluate everything that I've sent and

2112
01:28:15,300 --> 01:28:18,749
see if I<font color="#E5E5E5"> would have not</font><font color="#CCCCCC"> sent something</font>

2113
01:28:17,190 --> 01:28:21,178
<font color="#E5E5E5">or said something slightly differently</font>

2114
01:28:18,749 --> 01:28:25,349
is there a cisco command i was wondering

2115
01:28:21,179 --> 01:28:27,809
this double show you<font color="#E5E5E5"> DET v attributes in</font>

2116
01:28:25,349 --> 01:28:29,519
the advertised routes not just which

2117
01:28:27,809 --> 01:28:31,739
routes were advertised but whether or

2118
01:28:29,519 --> 01:28:33,389
not you<font color="#E5E5E5"> got the reference is one of the</font>

2119
01:28:31,739 --> 01:28:35,728
big<font color="#CCCCCC"> problems with cisco that juniper</font>

2120
01:28:33,389 --> 01:28:38,280
fixed and everyone should ask<font color="#E5E5E5"> cisco for</font>

2121
01:28:35,729 --> 01:28:39,570
a way<font color="#CCCCCC"> to see your adjacent rib out this</font>

2122
01:28:38,280 --> 01:28:42,179
is one of those things like<font color="#E5E5E5"> every three</font>

2123
01:28:39,570 --> 01:28:46,380
<font color="#E5E5E5">months i sit</font><font color="#CCCCCC"> and say</font><font color="#E5E5E5"> god I wonder if I</font>

2124
01:28:42,179 --> 01:28:49,460
<font color="#CCCCCC">could do that okay so the thing there is</font>

2125
01:28:46,380 --> 01:28:53,010
when<font color="#E5E5E5"> you do a show IP bgp</font><font color="#CCCCCC"> advertised</font>

2126
01:28:49,460 --> 01:28:55,889
you'll see<font color="#E5E5E5"> that certain prefixes were</font>

2127
01:28:53,010 --> 01:28:57,570
advertised but not what med is set on

2128
01:28:55,889 --> 01:29:00,809
them or what communities are set on them

2129
01:28:57,570 --> 01:29:02,699
as sent to one provider so on juniper

2130
01:29:00,809 --> 01:29:04,260
you can see<font color="#CCCCCC"> that and for debugging as</font>

2131
01:29:02,699 --> 01:29:09,749
you get more complex that's a useful

2132
01:29:04,260 --> 01:29:13,139
functionality best practices filter

2133
01:29:09,749 --> 01:29:15,749
don't advertise too much you're<font color="#E5E5E5"> going to</font>

2134
01:29:13,139 --> 01:29:21,300
use bgp passwords in general which are

2135
01:29:15,749 --> 01:29:24,829
really<font color="#E5E5E5"> tcp encryption bgp TTL hack is</font>

2136
01:29:21,300 --> 01:29:27,420
also good to use for security so

2137
01:29:24,829 --> 01:29:29,789
basically<font color="#E5E5E5"> you make sure that the</font>

2138
01:29:27,420 --> 01:29:31,079
providers are actually the routers are

2139
01:29:29,789 --> 01:29:32,969
actually adjacent that should be<font color="#E5E5E5"> that's</font>

2140
01:29:31,079 --> 01:29:35,070
covered in BGP most of the<font color="#E5E5E5"> things here</font>

2141
01:29:32,969 --> 01:29:37,349
are actually outside the<font color="#E5E5E5"> scope of this</font>

2142
01:29:35,070 --> 01:29:38,759
<font color="#E5E5E5">or covered in BGP 102 but you don't need</font>

2143
01:29:37,349 --> 01:29:40,199
<font color="#E5E5E5">to understand completely just enough to</font>

2144
01:29:38,760 --> 01:29:41,550
grab the config snippets and make sure

2145
01:29:40,199 --> 01:29:46,629
<font color="#CCCCCC">that you start</font><font color="#E5E5E5"> doing them as you grow</font>

2146
01:29:41,550 --> 01:29:49,180
yeah hmm

2147
01:29:46,630 --> 01:29:53,100
oh I forgot this is one<font color="#CCCCCC"> of the</font><font color="#E5E5E5"> things we</font>

2148
01:29:49,180 --> 01:29:55,210
<font color="#E5E5E5">got into an argument about and Dominican</font>

2149
01:29:53,100 --> 01:29:59,640
we have different there<font color="#E5E5E5"> are differing</font>

2150
01:29:55,210 --> 01:29:59,640
opinions about it so in general

2151
01:30:05,360 --> 01:30:11,540
for edge networks that are multi home to

2152
01:30:07,790 --> 01:30:12,710
two providers I still recommend it and I

2153
01:30:11,540 --> 01:30:14,570
could be wrong I've<font color="#E5E5E5"> been wrong before</font>

2154
01:30:12,710 --> 01:30:16,250
well the<font color="#E5E5E5"> point being the passwords</font>

2155
01:30:14,570 --> 01:30:18,190
protect you against an attack that no

2156
01:30:16,250 --> 01:30:20,210
one has<font color="#CCCCCC"> ever actually seen happen and</font>

2157
01:30:18,190 --> 01:30:22,429
actually configuring the passwords as a

2158
01:30:20,210 --> 01:30:30,310
giant<font color="#E5E5E5"> pain in the ass it is a giant pain</font>

2159
01:30:22,430 --> 01:30:33,830
they asked although it can be fun<font color="#CCCCCC"> okay</font>

2160
01:30:30,310 --> 01:30:37,070
next top self with ebgp is a belt and

2161
01:30:33,830 --> 01:30:38,990
suspenders setting<font color="#E5E5E5"> the bgp version 24</font><font color="#CCCCCC"> i</font>

2162
01:30:37,070 --> 01:30:41,870
don't<font color="#E5E5E5"> think there any</font><font color="#CCCCCC"> VIII's</font><font color="#E5E5E5"> out there</font>

2163
01:30:38,990 --> 01:30:43,510
but good to do appear in between lupex

2164
01:30:41,870 --> 01:30:46,340
when you get into multi router

2165
01:30:43,510 --> 01:30:48,230
topologies internally you don't want to

2166
01:30:46,340 --> 01:30:49,790
<font color="#E5E5E5">appear with the next stop being an</font>

2167
01:30:48,230 --> 01:30:50,959
interface because if the interface goes

2168
01:30:49,790 --> 01:30:52,670
down<font color="#E5E5E5"> then the session goes down</font>

2169
01:30:50,960 --> 01:30:54,500
generally you're going to have multiple

2170
01:30:52,670 --> 01:30:57,110
ways of getting between different

2171
01:30:54,500 --> 01:30:58,940
routers so you let your<font color="#CCCCCC"> IGP figure that</font>

2172
01:30:57,110 --> 01:31:01,730
out you'll<font color="#E5E5E5"> have a loopback / router and</font>

2173
01:30:58,940 --> 01:31:04,089
you appear between those enable software

2174
01:31:01,730 --> 01:31:07,429
config if it isn't enabled by default

2175
01:31:04,090 --> 01:31:09,920
when you<font color="#E5E5E5"> get more more when you get</font>

2176
01:31:07,430 --> 01:31:11,990
larger scale you use peer groups the

2177
01:31:09,920 --> 01:31:15,020
purpose of the peer group is if you is

2178
01:31:11,990 --> 01:31:16,130
that any rel that has all the same

2179
01:31:15,020 --> 01:31:17,990
attributes that are<font color="#E5E5E5"> going to go to</font>

2180
01:31:16,130 --> 01:31:19,970
multiple people you can form<font color="#E5E5E5"> there at</font>

2181
01:31:17,990 --> 01:31:22,309
once and send it multiple times and it's

2182
01:31:19,970 --> 01:31:25,070
lower cpu it's more efficient to do it

2183
01:31:22,310 --> 01:31:27,260
that way you'll probably wind up using

2184
01:31:25,070 --> 01:31:29,900
<font color="#E5E5E5">reflectors at some point so you'll</font>

2185
01:31:27,260 --> 01:31:31,430
<font color="#E5E5E5">actually want to start configuring do</font>

2186
01:31:29,900 --> 01:31:32,809
make your initial configurations use

2187
01:31:31,430 --> 01:31:35,830
route reflectors so that you don't have

2188
01:31:32,810 --> 01:31:39,590
<font color="#CCCCCC">to add anything worry about it later on</font>

2189
01:31:35,830 --> 01:31:41,540
make sure<font color="#E5E5E5"> that you prefer your yes one</font>

2190
01:31:39,590 --> 01:31:43,130
extra note you<font color="#CCCCCC"> should use templates not</font>

2191
01:31:41,540 --> 01:31:48,170
peer groups now templates are<font color="#CCCCCC"> elf sorry</font>

2192
01:31:43,130 --> 01:31:51,290
<font color="#CCCCCC">i'm gonna let's</font><font color="#E5E5E5"> go leg make sure</font><font color="#CCCCCC"> that</font>

2193
01:31:48,170 --> 01:31:54,740
<font color="#CCCCCC">you prefer IGP routes / bgp routes there</font>

2194
01:31:51,290 --> 01:31:57,410
are some some equipment where that's<font color="#E5E5E5"> not</font>

2195
01:31:54,740 --> 01:31:59,690
the default configuration don't use

2196
01:31:57,410 --> 01:32:01,280
don't read about Ralph<font color="#E5E5E5"> lot</font><font color="#CCCCCC"> BGP Ralph</font>

2197
01:31:59,690 --> 01:32:03,280
<font color="#E5E5E5">slop dampening and think how cool let</font><font color="#CCCCCC"> me</font>

2198
01:32:01,280 --> 01:32:06,769
turn that<font color="#CCCCCC"> on unless you actually have</font>

2199
01:32:03,280 --> 01:32:09,830
understand the implications also another

2200
01:32:06,770 --> 01:32:11,830
thing to note yeah anyway is you can

2201
01:32:09,830 --> 01:32:14,360
actually<font color="#E5E5E5"> as</font><font color="#CCCCCC"> we get closer to</font><font color="#E5E5E5"> the edge</font>

2202
01:32:11,830 --> 01:32:16,519
things like<font color="#E5E5E5"> ralph lab dampening that use</font>

2203
01:32:14,360 --> 01:32:18,230
extra memory to remember routes that are

2204
01:32:16,520 --> 01:32:18,900
no<font color="#CCCCCC"> longer there could be really bad</font>

2205
01:32:18,230 --> 01:32:22,139
because<font color="#E5E5E5"> they could</font>

2206
01:32:18,900 --> 01:32:23,549
it caused you to ride a memory if in

2207
01:32:22,140 --> 01:32:27,170
doubt<font color="#E5E5E5"> when you're appearing with someone</font>

2208
01:32:23,550 --> 01:32:30,179
use<font color="#CCCCCC"> max prefix yes you should probably</font>

2209
01:32:27,170 --> 01:32:32,550
give the command for make sure that you

2210
01:32:30,179 --> 01:32:35,760
pref internal routes /<font color="#E5E5E5"> PGP make sure</font>

2211
01:32:32,550 --> 01:32:37,800
that you configure distance<font color="#E5E5E5"> BGP 200 200</font>

2212
01:32:35,760 --> 01:32:39,510
200 if you do not do this you<font color="#CCCCCC"> will break</font>

2213
01:32:37,800 --> 01:32:42,690
your router at some point because<font color="#E5E5E5"> cisco</font>

2214
01:32:39,510 --> 01:32:45,350
has a really really stupid default some

2215
01:32:42,690 --> 01:32:49,650
<font color="#E5E5E5">vendors do indeed have stupid defaults</font>

2216
01:32:45,350 --> 01:32:53,219
<font color="#CCCCCC">okay well edit the slides it's edit log</font>

2217
01:32:49,650 --> 01:32:54,780
<font color="#CCCCCC">bgp session state changes anything have</font>

2218
01:32:53,219 --> 01:32:56,760
central logging systems that look at

2219
01:32:54,780 --> 01:32:58,889
<font color="#CCCCCC">disks going bad and things like that if</font>

2220
01:32:56,760 --> 01:33:00,150
you want to get more sophisticated

2221
01:32:58,890 --> 01:33:01,800
there's a lot that you could look<font color="#E5E5E5"> at</font>

2222
01:33:00,150 --> 01:33:05,670
like looking at update volume and things

2223
01:33:01,800 --> 01:33:07,230
like that generally speaking looking at

2224
01:33:05,670 --> 01:33:09,420
whether sessions are up and down<font color="#E5E5E5"> and</font>

2225
01:33:07,230 --> 01:33:11,129
making sure<font color="#CCCCCC"> that you</font><font color="#E5E5E5"> look at errors link</font>

2226
01:33:09,420 --> 01:33:12,989
errors on the links<font color="#CCCCCC"> that you're</font>

2227
01:33:11,130 --> 01:33:15,870
<font color="#CCCCCC">appearing with people on it probably a</font>

2228
01:33:12,989 --> 01:33:17,940
good base level to do and if<font color="#E5E5E5"> you do wind</font>

2229
01:33:15,870 --> 01:33:20,550
up using private a esas internally

2230
01:33:17,940 --> 01:33:24,049
please remember<font color="#CCCCCC"> to strip them as you</font>

2231
01:33:20,550 --> 01:33:24,050
send your routes to the outside world

2232
01:33:25,219 --> 01:33:31,230
one other caveat on the remove private

2233
01:33:27,719 --> 01:33:33,000
is it only removes one private<font color="#CCCCCC"> a s</font>

2234
01:33:31,230 --> 01:33:34,500
that's in the beginning it does<font color="#E5E5E5"> not</font>

2235
01:33:33,000 --> 01:33:36,570
remove them from the entire a s path

2236
01:33:34,500 --> 01:33:42,239
which is something<font color="#CCCCCC"> people forget about</font><font color="#E5E5E5"> a</font>

2237
01:33:36,570 --> 01:33:43,739
lot<font color="#E5E5E5"> of times sorry well it I don't know</font>

2238
01:33:42,239 --> 01:33:45,269
if you necessarily want to filter the

2239
01:33:43,739 --> 01:33:46,889
route or not but make sure whenever

2240
01:33:45,270 --> 01:33:49,020
there is a transition whenever there's

2241
01:33:46,890 --> 01:33:50,699
an ebgp transition that's<font color="#E5E5E5"> where you need</font>

2242
01:33:49,020 --> 01:33:52,440
<font color="#CCCCCC">to configure the remove private ass</font>

2243
01:33:50,699 --> 01:33:56,639
because if it happens twice<font color="#CCCCCC"> I say your</font>

2244
01:33:52,440 --> 01:33:59,159
customer sends you a remote private ass

2245
01:33:56,640 --> 01:34:01,590
and then you advertise it again with a

2246
01:33:59,159 --> 01:34:04,409
private<font color="#E5E5E5"> is and you do a remove private</font>

2247
01:34:01,590 --> 01:34:05,640
is not remote private is sorry it will

2248
01:34:04,409 --> 01:34:09,599
only remove the first one<font color="#E5E5E5"> and won't</font>

2249
01:34:05,640 --> 01:34:12,000
remove the second one recent changes<font color="#CCCCCC"> to</font>

2250
01:34:09,600 --> 01:34:15,570
<font color="#E5E5E5">the powerpoint always been like that yes</font>

2251
01:34:12,000 --> 01:34:17,850
what no<font color="#E5E5E5"> no it's okay i typed it on the</font>

2252
01:34:15,570 --> 01:34:19,440
plane all day okay<font color="#E5E5E5"> and my fingers did</font>

2253
01:34:17,850 --> 01:34:22,770
not type what my brain told them to type

2254
01:34:19,440 --> 01:34:25,949
so<font color="#E5E5E5"> I apologize um so there's a lot more</font>

2255
01:34:22,770 --> 01:34:27,570
in fact<font color="#E5E5E5"> a full BGP 101 with lots of</font>

2256
01:34:25,949 --> 01:34:29,190
configure examples and changing routes

2257
01:34:27,570 --> 01:34:31,780
and all that would probably be about<font color="#CCCCCC"> 3</font>

2258
01:34:29,190 --> 01:34:35,469
or<font color="#CCCCCC"> 3 hours but if you want</font>

2259
01:34:31,780 --> 01:34:36,610
look at some of the more scale we call

2260
01:34:35,469 --> 01:34:40,900
them advanced but what they're really

2261
01:34:36,610 --> 01:34:45,030
tend to be about<font color="#E5E5E5"> a scaling bgp including</font>

2262
01:34:40,900 --> 01:34:47,579
some configurations there are there's a

2263
01:34:45,030 --> 01:34:50,019
<font color="#CCCCCC">Phillip</font><font color="#E5E5E5"> Smith has done a number of</font>

2264
01:34:47,579 --> 01:34:51,519
presentations<font color="#E5E5E5"> at nanog that have lots of</font>

2265
01:34:50,020 --> 01:34:55,000
router configs and talk about some<font color="#CCCCCC"> of</font>

2266
01:34:51,520 --> 01:34:56,710
the advanced topics I've got yeah<font color="#E5E5E5"> I did</font>

2267
01:34:55,000 --> 01:34:59,440
a couple<font color="#E5E5E5"> times ago at nanog and</font>

2268
01:34:56,710 --> 01:35:01,150
<font color="#E5E5E5">Dominican we did bgp 102 that talks</font>

2269
01:34:59,440 --> 01:35:02,710
about some of those topics<font color="#CCCCCC"> a lot of</font>

2270
01:35:01,150 --> 01:35:05,888
<font color="#E5E5E5">resources on the internet now a lot</font><font color="#CCCCCC"> more</font>

2271
01:35:02,710 --> 01:35:07,389
<font color="#CCCCCC">than you know ten years ago and if you</font>

2272
01:35:05,889 --> 01:35:09,639
have<font color="#CCCCCC"> any other</font><font color="#E5E5E5"> questions</font><font color="#CCCCCC"> any specific</font>

2273
01:35:07,389 --> 01:35:10,869
questions I think we are now three

2274
01:35:09,639 --> 01:35:13,599
minutes over but you can<font color="#E5E5E5"> come up and ask</font>

2275
01:35:10,869 --> 01:35:15,630
them and otherwise I hope this was

2276
01:35:13,599 --> 01:35:15,630
helpful

