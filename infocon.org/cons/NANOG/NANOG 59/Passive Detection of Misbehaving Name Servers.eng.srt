1
00:00:14,519 --> 00:00:23,829
<font color="#E5E5E5">alright everyone will be getting</font><font color="#CCCCCC"> started</font>

2
00:00:18,930 --> 00:00:32,860
please find<font color="#E5E5E5"> your seats that means you</font>

3
00:00:23,829 --> 00:00:35,080
Jam<font color="#E5E5E5"> John van oppen alright please</font>

4
00:00:32,860 --> 00:00:45,730
welcome John spring with cert thank you

5
00:00:35,080 --> 00:00:47,680
John hi everyone so this is<font color="#CCCCCC"> a discussion</font>

6
00:00:45,730 --> 00:00:49,390
<font color="#E5E5E5">of some stuff that I was doing to try to</font>

7
00:00:47,680 --> 00:00:52,149
detect some malicious behavior on<font color="#CCCCCC"> the</font>

8
00:00:49,390 --> 00:00:55,090
<font color="#CCCCCC">internet it actually goes back for some</font>

9
00:00:52,149 --> 00:00:56,949
time this will be a bit<font color="#E5E5E5"> of a survey just</font>

10
00:00:55,090 --> 00:00:59,530
to get the flavor what's going on if you

11
00:00:56,949 --> 00:01:00,968
<font color="#CCCCCC">want to look</font><font color="#E5E5E5"> at the technical details we</font>

12
00:00:59,530 --> 00:01:03,370
actually<font color="#CCCCCC"> just published this as a tech</font>

13
00:01:00,969 --> 00:01:05,560
report last<font color="#E5E5E5"> Friday seems like a long</font>

14
00:01:03,370 --> 00:01:07,330
time ago<font color="#E5E5E5"> to me for some reason I'm</font>

15
00:01:05,560 --> 00:01:08,940
coming in from Pittsburgh<font color="#CCCCCC"> cuz we're out</font>

16
00:01:07,330 --> 00:01:10,869
of Carnegie Mellon<font color="#CCCCCC"> University</font>

17
00:01:08,940 --> 00:01:12,100
unfortunately I cannot report that the

18
00:01:10,869 --> 00:01:14,770
Pirates are going to the next<font color="#E5E5E5"> round of</font>

19
00:01:12,100 --> 00:01:21,060
the playoffs hopefully<font color="#CCCCCC"> I'll report</font><font color="#E5E5E5"> that</font>

20
00:01:14,770 --> 00:01:24,068
tomorrow so first step of course is the

21
00:01:21,060 --> 00:01:25,720
useless legal language now that you guys

22
00:01:24,069 --> 00:01:28,649
have all consented to monitoring of

23
00:01:25,720 --> 00:01:31,119
everything that<font color="#E5E5E5"> I'm doing they move on</font>

24
00:01:28,649 --> 00:01:34,539
all it really says is that I don't

25
00:01:31,119 --> 00:01:37,360
promise that any of this is real so fast

26
00:01:34,539 --> 00:01:40,149
flux is not new I'm new talking about

27
00:01:37,360 --> 00:01:44,590
<font color="#CCCCCC">nameservers doing fast flux</font><font color="#E5E5E5"> under put</font>

28
00:01:40,149 --> 00:01:46,810
fast in air quotes but fast flux is not

29
00:01:44,590 --> 00:01:50,890
new at all I can report it on this<font color="#E5E5E5"> a</font>

30
00:01:46,810 --> 00:01:54,250
long time ago and if I can is doing a

31
00:01:50,890 --> 00:01:58,090
report like this then it has percolated

32
00:01:54,250 --> 00:02:00,550
up pretty far into the DNS awareness so

33
00:01:58,090 --> 00:02:02,200
in case<font color="#CCCCCC"> you didn't read this paper in</font>

34
00:02:00,550 --> 00:02:04,750
2008 or I've forgotten it since<font color="#E5E5E5"> then</font>

35
00:02:02,200 --> 00:02:07,509
because we're all getting old basically

36
00:02:04,750 --> 00:02:09,818
fast flux is if one domain uses a bunch

37
00:02:07,509 --> 00:02:13,360
<font color="#E5E5E5">of different IP addresses the botnet</font>

38
00:02:09,818 --> 00:02:15,458
authors do this to avoid IP blacklists

39
00:02:13,360 --> 00:02:17,010
basically so if they hard code the

40
00:02:15,459 --> 00:02:19,150
domain name or something into their

41
00:02:17,010 --> 00:02:20,319
malicious code then they can cycle

42
00:02:19,150 --> 00:02:22,130
through the IP addresses which gets

43
00:02:20,319 --> 00:02:23,359
around that block lists

44
00:02:22,130 --> 00:02:25,040
they soon realize that this wasn't

45
00:02:23,360 --> 00:02:26,630
enough so they started also cycling

46
00:02:25,040 --> 00:02:28,190
through the domain names and so you have

47
00:02:26,630 --> 00:02:32,470
multiple domain names which are hosted

48
00:02:28,190 --> 00:02:36,530
on a related set of IP addresses but the

49
00:02:32,470 --> 00:02:37,820
time to live for these is you know five

50
00:02:36,530 --> 00:02:43,730
seconds five minutes something<font color="#E5E5E5"> rather</font>

51
00:02:37,820 --> 00:02:45,500
short so you might<font color="#E5E5E5"> say didn't we take</font>

52
00:02:43,730 --> 00:02:48,950
care<font color="#E5E5E5"> of this five years ago why do I</font>

53
00:02:45,500 --> 00:02:50,620
care now we have a<font color="#E5E5E5"> pretty good mechanism</font>

54
00:02:48,950 --> 00:02:53,540
for taking this stuff down reactively

55
00:02:50,620 --> 00:02:56,270
but pretty good is relative right<font color="#E5E5E5"> it's</font>

56
00:02:53,540 --> 00:02:57,709
always reactive so for reactive and

57
00:02:56,270 --> 00:02:59,150
we're taking<font color="#E5E5E5"> something down we're</font>

58
00:02:57,710 --> 00:03:03,530
playing whack Amole as a defensive

59
00:02:59,150 --> 00:03:06,010
community that's not ideal if you're

60
00:03:03,530 --> 00:03:08,300
playing whack-a-mole you're gonna lose I

61
00:03:06,010 --> 00:03:09,799
actually just three weeks<font color="#E5E5E5"> ago in San</font>

62
00:03:08,300 --> 00:03:11,570
Francisco presented a paper with some

63
00:03:09,800 --> 00:03:14,210
modeling about this and why this is

64
00:03:11,570 --> 00:03:17,090
definitely true if you're playing

65
00:03:14,210 --> 00:03:20,090
whack-a-mole you will not catch up right

66
00:03:17,090 --> 00:03:22,730
because<font color="#E5E5E5"> you have to react so if they're</font>

67
00:03:20,090 --> 00:03:25,550
<font color="#E5E5E5">doing a fast flux botnet and they only</font>

68
00:03:22,730 --> 00:03:27,890
need to get one domain name through and

69
00:03:25,550 --> 00:03:29,810
one IP address through out of<font color="#E5E5E5"> 500,000</font>

70
00:03:27,890 --> 00:03:31,970
<font color="#E5E5E5">and they can update their</font><font color="#CCCCCC"> BOTS to evade</font>

71
00:03:29,810 --> 00:03:34,010
your defensive mechanisms they will do

72
00:03:31,970 --> 00:03:35,870
that they'll win right we see this<font color="#E5E5E5"> as</font>

73
00:03:34,010 --> 00:03:40,390
<font color="#E5E5E5">conficker conficker still exists all</font>

74
00:03:35,870 --> 00:03:46,340
over the place so given that this is a

75
00:03:40,390 --> 00:03:49,519
latent problem click there we go what

76
00:03:46,340 --> 00:03:51,950
can<font color="#E5E5E5"> we do so domains need two things</font>

77
00:03:49,520 --> 00:03:53,780
they need a location as I said<font color="#CCCCCC"> we</font>

78
00:03:51,950 --> 00:03:55,369
already have tried blocking the location

79
00:03:53,780 --> 00:03:57,110
we've already tried ip-based block lists

80
00:03:55,370 --> 00:03:59,120
those work<font color="#CCCCCC"> okay as long as they're</font>

81
00:03:57,110 --> 00:04:00,080
actually you know owning the IP<font color="#CCCCCC"> address</font>

82
00:03:59,120 --> 00:04:01,630
that they're<font color="#CCCCCC"> using for malicious</font>

83
00:04:00,080 --> 00:04:06,350
purposes but that's not often the case

84
00:04:01,630 --> 00:04:09,290
everyone has compromised machines on

85
00:04:06,350 --> 00:04:11,750
their infrastructure somewhere and you

86
00:04:09,290 --> 00:04:13,190
can't just block the IP address<font color="#E5E5E5"> if it's</font>

87
00:04:11,750 --> 00:04:16,339
been compromised because you take<font color="#E5E5E5"> down</font>

88
00:04:13,190 --> 00:04:17,750
legitimate services so since there are

89
00:04:16,339 --> 00:04:20,298
only two<font color="#CCCCCC"> things that something needs in</font>

90
00:04:17,750 --> 00:04:24,230
the<font color="#CCCCCC"> DNS to be active let's try</font><font color="#E5E5E5"> to look</font>

91
00:04:20,298 --> 00:04:26,060
<font color="#E5E5E5">at the name servers so I did this two</font>

92
00:04:24,230 --> 00:04:27,350
ways I did the same<font color="#E5E5E5"> algorithm but I did</font>

93
00:04:26,060 --> 00:04:29,300
it on two different<font color="#E5E5E5"> sources which have</font>

94
00:04:27,350 --> 00:04:31,450
slightly different features that I

95
00:04:29,300 --> 00:04:33,050
connects that I can take advantage of so

96
00:04:31,450 --> 00:04:34,909
certain

97
00:04:33,050 --> 00:04:38,569
<font color="#CCCCCC">top-level domains make their zone files</font>

98
00:04:34,909 --> 00:04:40,940
available these are the generic<font color="#CCCCCC"> tlds</font><font color="#E5E5E5"> com</font>

99
00:04:38,569 --> 00:04:42,409
org net so the zone files give me a

100
00:04:40,940 --> 00:04:43,729
pretty good insight into the

101
00:04:42,409 --> 00:04:47,030
second-level domains on the internet

102
00:04:43,729 --> 00:04:50,210
because<font color="#CCCCCC"> com is half of them right but</font>

103
00:04:47,030 --> 00:04:52,068
<font color="#CCCCCC">that's still not everything and in</font>

104
00:04:50,210 --> 00:04:55,128
general i only have daily resolution on

105
00:04:52,069 --> 00:04:57,050
this so if some bad guy in the zone

106
00:04:55,129 --> 00:04:59,750
files changes the IP address of his name

107
00:04:57,050 --> 00:05:01,849
server four times in a day<font color="#E5E5E5"> but the last</font>

108
00:04:59,750 --> 00:05:03,289
<font color="#E5E5E5">one is</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> same as the</font><font color="#CCCCCC"> first one i won't</font>

109
00:05:01,849 --> 00:05:05,930
see<font color="#E5E5E5"> that it's changed because i can only</font>

110
00:05:03,289 --> 00:05:08,449
pull it down at midnight<font color="#CCCCCC"> on the</font><font color="#E5E5E5"> other</font>

111
00:05:05,930 --> 00:05:10,219
<font color="#E5E5E5">hand i have a passive DNS data source so</font>

112
00:05:08,449 --> 00:05:12,770
<font color="#CCCCCC">I have the contents of the resource</font>

113
00:05:10,219 --> 00:05:15,139
recordsets so<font color="#E5E5E5"> I have the IP addresses of</font>

114
00:05:12,770 --> 00:05:17,628
the<font color="#E5E5E5"> name servers and the domains that</font>

115
00:05:15,139 --> 00:05:21,440
are used as name servers from that and I

116
00:05:17,629 --> 00:05:23,270
can see down lower labels that are name

117
00:05:21,440 --> 00:05:26,440
servers I can also see all the<font color="#CCCCCC"> tlds they</font>

118
00:05:23,270 --> 00:05:28,639
get requested but it's incomplete so

119
00:05:26,440 --> 00:05:30,199
you'll see slightly<font color="#E5E5E5"> different results</font>

120
00:05:28,639 --> 00:05:32,690
from these two data sets but<font color="#CCCCCC"> it's</font>

121
00:05:30,199 --> 00:05:34,759
provides a way looking<font color="#E5E5E5"> at both sings the</font>

122
00:05:32,690 --> 00:05:36,430
you knows one gives completeness for

123
00:05:34,759 --> 00:05:38,659
everything in the zone one gives a

124
00:05:36,430 --> 00:05:40,370
sample across the whole internet<font color="#E5E5E5"> so is a</font>

125
00:05:38,659 --> 00:05:42,259
little more complete the passive DNS

126
00:05:40,370 --> 00:05:45,770
source has a slight<font color="#E5E5E5"> North American bias</font>

127
00:05:42,259 --> 00:05:50,630
so there's<font color="#E5E5E5"> that what I do is pretty</font>

128
00:05:45,770 --> 00:05:53,690
<font color="#E5E5E5">simple and it's related</font><font color="#CCCCCC"> to the fast flux</font>

129
00:05:50,630 --> 00:05:55,849
detection in general so you look for

130
00:05:53,690 --> 00:05:57,469
<font color="#E5E5E5">things that move IP addresses and you</font>

131
00:05:55,849 --> 00:06:00,979
prioritize those things if they change

132
00:05:57,469 --> 00:06:03,139
<font color="#CCCCCC">ASNs pretty frequently the name server</font>

133
00:06:00,979 --> 00:06:04,609
is supposed to be stable right you guys

134
00:06:03,139 --> 00:06:06,110
that run name servers you know that your

135
00:06:04,610 --> 00:06:07,639
name server should not be changing IP

136
00:06:06,110 --> 00:06:09,379
addresses that's basically forced down

137
00:06:07,639 --> 00:06:10,340
time if your name server changes IP

138
00:06:09,379 --> 00:06:11,900
addresses because there's<font color="#E5E5E5"> going to be</font>

139
00:06:10,340 --> 00:06:14,448
the TTL pine out and<font color="#CCCCCC"> people are going to</font>

140
00:06:11,900 --> 00:06:16,239
get<font color="#CCCCCC"> confused might be reasonable for</font>

141
00:06:14,449 --> 00:06:18,860
this to happen once or twice<font color="#CCCCCC"> in a month</font>

142
00:06:16,240 --> 00:06:20,509
probably<font color="#E5E5E5"> once right people do change</font>

143
00:06:18,860 --> 00:06:23,000
their name servers but they try to not

144
00:06:20,509 --> 00:06:24,199
do it so frequently even<font color="#CCCCCC"> someplace</font><font color="#E5E5E5"> like</font>

145
00:06:23,000 --> 00:06:26,180
Akamai<font color="#E5E5E5"> I've gotten several questions</font>

146
00:06:24,199 --> 00:06:28,580
like isn't this CDN isn't this going to

147
00:06:26,180 --> 00:06:32,599
<font color="#E5E5E5">change all of the time that's</font><font color="#CCCCCC"> actually</font>

148
00:06:28,580 --> 00:06:35,840
<font color="#E5E5E5">not how those work quite the resource</font>

149
00:06:32,599 --> 00:06:37,580
pages that end Leafs of the CDN are

150
00:06:35,840 --> 00:06:40,669
going to change all the time but

151
00:06:37,580 --> 00:06:43,310
<font color="#E5E5E5">everyone needs a stable place to ask for</font>

152
00:06:40,669 --> 00:06:44,960
what those very variable resources<font color="#E5E5E5"> are</font>

153
00:06:43,310 --> 00:06:45,610
so although a combined might have one

154
00:06:44,960 --> 00:06:47,530
hundred or two

155
00:06:45,610 --> 00:06:49,509
or whatever<font color="#E5E5E5"> his name servers and they</font>

156
00:06:47,530 --> 00:06:52,989
might vary which ones you ask questions

157
00:06:49,509 --> 00:06:55,449
to each individual name server stays in

158
00:06:52,990 --> 00:06:56,949
the same place the IP address doesn't

159
00:06:55,449 --> 00:06:58,870
change so what I'm talking about is<font color="#E5E5E5"> the</font>

160
00:06:56,949 --> 00:07:01,810
actual name server changing IP addresses

161
00:06:58,870 --> 00:07:04,659
and particularly I care<font color="#E5E5E5"> if they change a</font>

162
00:07:01,810 --> 00:07:07,000
s because if it changes a s it's

163
00:07:04,659 --> 00:07:10,090
changing who's in control of the network

164
00:07:07,000 --> 00:07:12,879
and so pretty reasonable if someone's

165
00:07:10,090 --> 00:07:15,039
changing their name server from one IP

166
00:07:12,879 --> 00:07:17,319
address they own to another one but if

167
00:07:15,039 --> 00:07:21,219
you're on you know the customer net

168
00:07:17,319 --> 00:07:22,719
block for isp in<font color="#CCCCCC"> France and then the</font>

169
00:07:21,219 --> 00:07:25,180
name server changes to the customer net

170
00:07:22,719 --> 00:07:29,439
lock for an ISP in<font color="#CCCCCC"> San Francisco i'm</font>

171
00:07:25,180 --> 00:07:30,789
pretty<font color="#E5E5E5"> sure that that's not real so</font><font color="#CCCCCC"> i</font>

172
00:07:29,439 --> 00:07:33,520
know that<font color="#E5E5E5"> you're all surprised that bad</font>

173
00:07:30,789 --> 00:07:37,169
things happen on the<font color="#CCCCCC"> internet please</font>

174
00:07:33,520 --> 00:07:43,840
forced laughter a<font color="#E5E5E5"> little bit oh thanks</font>

175
00:07:37,169 --> 00:07:45,878
there you go if you<font color="#E5E5E5"> look at this</font><font color="#CCCCCC"> you</font>

176
00:07:43,840 --> 00:07:48,310
have<font color="#E5E5E5"> the number of changes in IP</font><font color="#CCCCCC"> address</font>

177
00:07:45,879 --> 00:07:51,069
and the number of changes in a SN if you

178
00:07:48,310 --> 00:07:54,520
look<font color="#CCCCCC"> at say row four or five they're</font>

179
00:07:51,069 --> 00:07:56,050
actually more than the<font color="#CCCCCC"> left right hand</font>

180
00:07:54,520 --> 00:07:57,818
<font color="#E5E5E5">column a s column then there are an IP</font>

181
00:07:56,050 --> 00:07:59,529
column<font color="#E5E5E5"> this is because</font><font color="#CCCCCC"> if something</font>

182
00:07:57,819 --> 00:08:03,629
changes IP address nine times it might

183
00:07:59,529 --> 00:08:06,159
only change as5 so it's not out of the

184
00:08:03,629 --> 00:08:09,129
198 that changed IP four times how many

185
00:08:06,159 --> 00:08:12,129
changed a s it's how many<font color="#E5E5E5"> change they</font>

186
00:08:09,129 --> 00:08:15,310
<font color="#CCCCCC">asked four times out of all of them so</font><font color="#E5E5E5"> I</font>

187
00:08:12,129 --> 00:08:17,050
would venture a guess that point<font color="#CCCCCC"> 2 or</font>

188
00:08:15,310 --> 00:08:19,150
point one percent of the things that<font color="#E5E5E5"> the</font>

189
00:08:17,050 --> 00:08:22,810
zone files were malicious for as far as

190
00:08:19,150 --> 00:08:27,429
name servers go if you sum up down there

191
00:08:22,810 --> 00:08:28,870
in the passive files<font color="#E5E5E5"> there are a bit</font>

192
00:08:27,430 --> 00:08:31,180
more this is<font color="#CCCCCC"> because the time</font>

193
00:08:28,870 --> 00:08:34,870
granularity is better I<font color="#E5E5E5"> think it also</font>

194
00:08:31,180 --> 00:08:37,299
might be because the generic<font color="#CCCCCC"> tlds have a</font>

195
00:08:34,870 --> 00:08:39,578
bit better security on the people that

196
00:08:37,299 --> 00:08:40,958
they allow to register names I think

197
00:08:39,578 --> 00:08:43,029
that's a pretty reasonable guess as to

198
00:08:40,958 --> 00:08:45,339
why this is true also not sure<font color="#E5E5E5"> exactly</font>

199
00:08:43,029 --> 00:08:47,920
which one of those it is but as you can

200
00:08:45,339 --> 00:08:49,540
see there's a bit more suspicious

201
00:08:47,920 --> 00:08:56,510
looking name servers if we look at

202
00:08:49,540 --> 00:08:59,459
passive DNS so that data was from 2011

203
00:08:56,510 --> 00:09:01,350
if you<font color="#E5E5E5"> look at this this is the number</font>

204
00:08:59,460 --> 00:09:04,140
<font color="#CCCCCC">of IP address number of nameservers the</font>

205
00:09:01,350 --> 00:09:06,120
changed IP address five or more times

206
00:09:04,140 --> 00:09:09,300
within the 30 days<font color="#E5E5E5"> prior to the date on</font>

207
00:09:06,120 --> 00:09:15,750
the bottom this runs from<font color="#E5E5E5"> October first</font>

208
00:09:09,300 --> 00:09:21,300
2011 until two weeks ago<font color="#CCCCCC"> the big spike</font>

209
00:09:15,750 --> 00:09:23,550
is when<font color="#E5E5E5"> Dena's changer was taken down so</font>

210
00:09:21,300 --> 00:09:25,050
they were doing<font color="#E5E5E5"> this to</font><font color="#CCCCCC"> keep their name</font>

211
00:09:23,550 --> 00:09:26,520
servers up that they were serving<font color="#E5E5E5"> all</font>

212
00:09:25,050 --> 00:09:30,349
these militias<font color="#E5E5E5"> ads that was stealing all</font>

213
00:09:26,520 --> 00:09:34,319
of this money also if you<font color="#E5E5E5"> note they</font>

214
00:09:30,350 --> 00:09:35,850
looked like they were serving names that

215
00:09:34,320 --> 00:09:37,080
had suspicious strings in it right

216
00:09:35,850 --> 00:09:39,930
there's usually not<font color="#CCCCCC"> too many name</font>

217
00:09:37,080 --> 00:09:41,970
servers that are RX free pharma viagra

218
00:09:39,930 --> 00:09:44,219
cialis dot name<font color="#CCCCCC"> server net or whatever</font>

219
00:09:41,970 --> 00:09:45,690
it is so that's what that red line means

220
00:09:44,220 --> 00:09:47,490
they had one of those kind of words in

221
00:09:45,690 --> 00:09:51,270
it very simple I'm not actually

222
00:09:47,490 --> 00:09:54,120
analyzing like where they sold anything

223
00:09:51,270 --> 00:09:57,660
to I'm<font color="#E5E5E5"> looking at the strings in the</font>

224
00:09:54,120 --> 00:10:00,000
name server name however that<font color="#CCCCCC"> peeks out</font>

225
00:09:57,660 --> 00:10:04,170
at 3,500 name servers doing this in the

226
00:10:00,000 --> 00:10:05,850
<font color="#E5E5E5">zone files it drops a lot so we can</font>

227
00:10:04,170 --> 00:10:07,829
<font color="#E5E5E5">certainly affect it if we go arrest six</font>

228
00:10:05,850 --> 00:10:11,460
people in Estonia and turn off their

229
00:10:07,830 --> 00:10:14,370
servers so that's<font color="#E5E5E5"> good news but maybe we</font>

230
00:10:11,460 --> 00:10:16,440
can<font color="#E5E5E5"> do without quite so much effort by</font>

231
00:10:14,370 --> 00:10:18,030
<font color="#E5E5E5">the FBI right maybe we look at this from</font>

232
00:10:16,440 --> 00:10:20,460
a technical point of view we can<font color="#E5E5E5"> also do</font>

233
00:10:18,030 --> 00:10:22,920
something that number stays pretty

234
00:10:20,460 --> 00:10:25,350
stable between four and six hundred name

235
00:10:22,920 --> 00:10:27,360
servers doing IP flux in the<font color="#E5E5E5"> zone files</font>

236
00:10:25,350 --> 00:10:31,110
for the big generic top-level domains

237
00:10:27,360 --> 00:10:36,930
for the last two<font color="#CCCCCC"> years about twenty two</font>

238
00:10:31,110 --> 00:10:38,520
months so I do say<font color="#CCCCCC"> that this can be</font>

239
00:10:36,930 --> 00:10:39,839
<font color="#CCCCCC">changed because obviously it can be</font>

240
00:10:38,520 --> 00:10:42,329
affected but I also say<font color="#CCCCCC"> that this is</font>

241
00:10:39,840 --> 00:10:44,490
<font color="#E5E5E5">still somewhat of a problem you not know</font>

242
00:10:42,330 --> 00:10:46,800
how many domains those<font color="#CCCCCC"> 500 name servers</font>

243
00:10:44,490 --> 00:10:47,970
are serving right we could find that<font color="#E5E5E5"> out</font>

244
00:10:46,800 --> 00:10:50,790
but that's just<font color="#E5E5E5"> not what I did on this</font>

245
00:10:47,970 --> 00:10:52,650
graph so just because the 500 name

246
00:10:50,790 --> 00:10:55,290
servers can probably control a good

247
00:10:52,650 --> 00:10:58,189
amount of malicious infrastructure also

248
00:10:55,290 --> 00:11:00,780
I said<font color="#E5E5E5"> that I'd adjust the parameters</font>

249
00:10:58,190 --> 00:11:03,690
the parameters for name server IP flux

250
00:11:00,780 --> 00:11:05,640
are not the same as that for regular IP

251
00:11:03,690 --> 00:11:07,680
flux this is why no one else found it

252
00:11:05,640 --> 00:11:09,529
right you don't<font color="#E5E5E5"> find this by accident</font>

253
00:11:07,680 --> 00:11:13,189
<font color="#CCCCCC">when you</font><font color="#E5E5E5"> just regularly run</font>

254
00:11:09,529 --> 00:11:15,889
p flux calculations it hides all of that

255
00:11:13,189 --> 00:11:18,920
<font color="#E5E5E5">because in general</font><font color="#CCCCCC"> name servers are more</font>

256
00:11:15,889 --> 00:11:22,310
stable this is all name server IP

257
00:11:18,920 --> 00:11:24,920
address<font color="#CCCCCC"> TTLs so if the domain was a name</font>

258
00:11:22,310 --> 00:11:28,399
server this is in the passive DNS what

259
00:11:24,920 --> 00:11:31,339
the TTL was for<font color="#E5E5E5"> it's a record forty-one</font>

260
00:11:28,399 --> 00:11:33,199
percent of them were two days almost<font color="#CCCCCC"> all</font>

261
00:11:31,339 --> 00:11:36,319
of them are<font color="#E5E5E5"> either one hour one</font><font color="#CCCCCC"> day or</font>

262
00:11:33,199 --> 00:11:37,969
two days what does this tell you besides

263
00:11:36,319 --> 00:11:39,199
that this<font color="#E5E5E5"> is a log-log plot and that I</font>

264
00:11:37,970 --> 00:11:41,509
might know a little<font color="#CCCCCC"> bit about how</font>

265
00:11:39,199 --> 00:11:43,219
logarithms work and that maybe I'm

266
00:11:41,509 --> 00:11:44,660
therefore intelligent and should be

267
00:11:43,220 --> 00:11:49,120
listened to which is probably not we

268
00:11:44,660 --> 00:11:51,649
should<font color="#E5E5E5"> take away from this graph that</font>

269
00:11:49,120 --> 00:11:53,029
name server records behave differently

270
00:11:51,649 --> 00:11:54,170
than regular records so we have to<font color="#CCCCCC"> look</font>

271
00:11:53,029 --> 00:11:58,999
at them differently we have to<font color="#E5E5E5"> look at</font>

272
00:11:54,170 --> 00:12:01,579
them especially also if<font color="#E5E5E5"> you look almost</font>

273
00:11:58,999 --> 00:12:05,689
all name server records have a TTL<font color="#CCCCCC"> of</font>

274
00:12:01,579 --> 00:12:10,729
more than five minutes so with regular

275
00:12:05,689 --> 00:12:14,329
fast flux one of the<font color="#CCCCCC"> defense's was you</font>

276
00:12:10,730 --> 00:12:16,459
can pin names for five seconds in your

277
00:12:14,329 --> 00:12:18,349
name server things like that<font color="#E5E5E5"> you</font>

278
00:12:16,459 --> 00:12:20,109
actually don't accept new things<font color="#E5E5E5"> you pin</font>

279
00:12:18,350 --> 00:12:24,439
the research record for five seconds

280
00:12:20,110 --> 00:12:27,910
with name servers this is a pretty big

281
00:12:24,439 --> 00:12:30,349
study i looked at 760 million records

282
00:12:27,910 --> 00:12:32,180
you can probably pin<font color="#CCCCCC"> name servers</font><font color="#E5E5E5"> it a</font>

283
00:12:30,350 --> 00:12:33,230
lot longer depending on exactly what

284
00:12:32,180 --> 00:12:35,000
percentage<font color="#E5E5E5"> of people you want to</font>

285
00:12:33,230 --> 00:12:37,370
frustrate if you put it at five minutes

286
00:12:35,000 --> 00:12:40,009
you would frustrate point probably<font color="#CCCCCC"> 02</font>

287
00:12:37,370 --> 00:12:41,779
percent of name server records that's

288
00:12:40,009 --> 00:12:43,279
less than the ones that<font color="#CCCCCC"> i claim are</font>

289
00:12:41,779 --> 00:12:45,829
malicious so you probably<font color="#E5E5E5"> shouldn't care</font>

290
00:12:43,279 --> 00:12:47,269
what they say anyway you can pin it a

291
00:12:45,829 --> 00:12:49,719
bit higher if you're a bit more

292
00:12:47,269 --> 00:12:49,720
ambitious

293
00:12:52,329 --> 00:12:56,888
when someone gives a security talk you

294
00:12:54,160 --> 00:12:58,179
should always ask so what right<font color="#E5E5E5"> I'm not</font>

295
00:12:56,889 --> 00:12:59,649
here to<font color="#E5E5E5"> sell you anything so I'm not</font>

296
00:12:58,179 --> 00:13:04,809
claiming that the sky<font color="#E5E5E5"> is</font><font color="#CCCCCC"> falling you</font>

297
00:12:59,649 --> 00:13:06,399
should buy something from me so there's

298
00:13:04,809 --> 00:13:08,290
no analytic reason why<font color="#E5E5E5"> people should</font>

299
00:13:06,399 --> 00:13:09,429
change these name servers so much if

300
00:13:08,290 --> 00:13:10,959
they change this much they're probably

301
00:13:09,429 --> 00:13:15,189
doing it because they're running from

302
00:13:10,959 --> 00:13:16,628
somebody so if you care about protecting

303
00:13:15,189 --> 00:13:18,879
someone from it and that might actually

304
00:13:16,629 --> 00:13:20,470
just be your corporate<font color="#E5E5E5"> 10 people that</font>

305
00:13:18,879 --> 00:13:22,029
actually run your network I know<font color="#E5E5E5"> that</font>

306
00:13:20,470 --> 00:13:24,339
you<font color="#E5E5E5"> guys are running networks for big</font>

307
00:13:22,029 --> 00:13:26,980
customer bases that you can't just

308
00:13:24,339 --> 00:13:28,360
dictate what name servers they go to if

309
00:13:26,980 --> 00:13:30,189
you run a DNS server for your own

310
00:13:28,360 --> 00:13:32,709
employees though you probably want<font color="#E5E5E5"> to</font>

311
00:13:30,189 --> 00:13:34,209
care about this if you run a bigger name

312
00:13:32,709 --> 00:13:35,679
server you might want<font color="#E5E5E5"> to think about</font>

313
00:13:34,209 --> 00:13:38,018
caring about it but there's also all

314
00:13:35,679 --> 00:13:40,149
those contracts things I do claim that

315
00:13:38,019 --> 00:13:43,239
as a high confidence indicator and that

316
00:13:40,149 --> 00:13:46,480
more importantly transitioning to

317
00:13:43,239 --> 00:13:48,069
blocking name servers is more effective

318
00:13:46,480 --> 00:13:51,489
than<font color="#CCCCCC"> trying to</font><font color="#E5E5E5"> play whack-a-mole and</font>

319
00:13:48,069 --> 00:13:54,248
catch up on just blocking the actual

320
00:13:51,489 --> 00:13:55,629
domains after we see that they're bad if

321
00:13:54,249 --> 00:13:57,749
you block a name server it blocks all

322
00:13:55,629 --> 00:14:00,069
the<font color="#E5E5E5"> things that are resolving using it</font>

323
00:13:57,749 --> 00:14:02,739
so you jump out ahead a little bit<font color="#E5E5E5"> and</font>

324
00:14:00,069 --> 00:14:05,799
you help to win this asymmetric battle

325
00:14:02,739 --> 00:14:07,749
that's going on where the attackers have

326
00:14:05,799 --> 00:14:10,839
this asymmetric advantage if they only

327
00:14:07,749 --> 00:14:13,319
have to get one thing through I am

328
00:14:10,839 --> 00:14:16,149
<font color="#E5E5E5">curious if anyone has looked at this on</font>

329
00:14:13,319 --> 00:14:19,118
securing their networks I don't know of

330
00:14:16,149 --> 00:14:21,129
anyone that has so I would like<font color="#CCCCCC"> to know</font>

331
00:14:19,119 --> 00:14:22,959
<font color="#CCCCCC">if someone has you can come talk to me</font>

332
00:14:21,129 --> 00:14:27,730
later I would<font color="#E5E5E5"> especially like to know if</font>

333
00:14:22,959 --> 00:14:29,768
you tried this and it did not work so I

334
00:14:27,730 --> 00:14:31,509
could try and spend a lot of effort

335
00:14:29,769 --> 00:14:34,209
proving to you beyond a reasonable doubt

336
00:14:31,509 --> 00:14:35,410
that<font color="#CCCCCC"> this</font><font color="#E5E5E5"> is bad I have some good</font>

337
00:14:34,209 --> 00:14:37,179
<font color="#E5E5E5">reasons to believe that that's not</font>

338
00:14:35,410 --> 00:14:39,040
fruitful I could try to sample some of

339
00:14:37,179 --> 00:14:40,569
these name servers and run them down but

340
00:14:39,040 --> 00:14:42,309
<font color="#CCCCCC">I think that that's more or less done</font>

341
00:14:40,569 --> 00:14:44,199
with that<font color="#E5E5E5"> 3,000 of these went offline</font>

342
00:14:42,309 --> 00:14:49,179
when DNS changer was taken down and

343
00:14:44,199 --> 00:14:51,849
those servers were taken off i also have

344
00:14:49,179 --> 00:14:53,410
done some other work looking at black

345
00:14:51,850 --> 00:14:55,269
lists and intersections between them

346
00:14:53,410 --> 00:14:58,569
which makes<font color="#E5E5E5"> me question the utility of</font>

347
00:14:55,269 --> 00:14:59,949
just intersecting some list of names

348
00:14:58,569 --> 00:15:01,660
that had come up with<font color="#E5E5E5"> someone else's</font>

349
00:14:59,949 --> 00:15:04,149
blacklist and saying if they agree that

350
00:15:01,660 --> 00:15:04,510
<font color="#CCCCCC">i'm right because everyone looks at</font>

351
00:15:04,149 --> 00:15:07,720
different

352
00:15:04,510 --> 00:15:09,580
things<font color="#E5E5E5"> and so almost no blacklists</font>

353
00:15:07,720 --> 00:15:10,990
actually intersect so it'd<font color="#CCCCCC"> be hard to</font>

354
00:15:09,580 --> 00:15:12,700
pick which one and<font color="#E5E5E5"> I would just get to</font>

355
00:15:10,990 --> 00:15:14,650
pick whichever one made<font color="#CCCCCC"> me look the</font>

356
00:15:12,700 --> 00:15:16,300
smartest which is not the best<font color="#E5E5E5"> way to</font>

357
00:15:14,650 --> 00:15:19,120
try<font color="#E5E5E5"> to actually get the right answer at</font>

358
00:15:16,300 --> 00:15:21,339
something I do continue to keep track of

359
00:15:19,120 --> 00:15:25,740
this and I intend on doing that<font color="#CCCCCC"> for the</font>

360
00:15:21,340 --> 00:15:25,740
<font color="#E5E5E5">near future and the foreseeable future I</font>

361
00:15:26,700 --> 00:15:31,060
bringing this to some attention because

362
00:15:29,110 --> 00:15:32,770
<font color="#CCCCCC">it might be</font><font color="#E5E5E5"> the case that some</font>

363
00:15:31,060 --> 00:15:34,900
registries are in a position to pay

364
00:15:32,770 --> 00:15:37,090
attention<font color="#E5E5E5"> to this and if not actually do</font>

365
00:15:34,900 --> 00:15:39,010
anything<font color="#E5E5E5"> feed it into some other abuse</font>

366
00:15:37,090 --> 00:15:42,130
process right to keep track of something

367
00:15:39,010 --> 00:15:44,110
in<font color="#E5E5E5"> the meantime if you keep track of the</font>

368
00:15:42,130 --> 00:15:48,120
DNS queries that you<font color="#CCCCCC"> ask for your</font>

369
00:15:44,110 --> 00:15:48,120
organization you<font color="#CCCCCC"> can do this yourself</font>

370
00:15:48,270 --> 00:15:51,939
that<font color="#CCCCCC"> type report has all of the</font>

371
00:15:50,320 --> 00:15:53,590
information about what you<font color="#E5E5E5"> would need to</font>

372
00:15:51,940 --> 00:15:56,470
do to actually look at this it's pretty

373
00:15:53,590 --> 00:15:58,870
<font color="#E5E5E5">simple though you can block this i would</font>

374
00:15:56,470 --> 00:16:01,000
suggest in a dns in the actual dns

375
00:15:58,870 --> 00:16:02,170
server like rpz because you want<font color="#E5E5E5"> to</font>

376
00:16:01,000 --> 00:16:03,640
actually block request to the name

377
00:16:02,170 --> 00:16:05,920
server the point is that those are

378
00:16:03,640 --> 00:16:08,740
<font color="#E5E5E5">changing IP addresses so just blocking</font>

379
00:16:05,920 --> 00:16:10,270
outbound 53 to that IP address might not

380
00:16:08,740 --> 00:16:12,250
be effective once it changes names here

381
00:16:10,270 --> 00:16:13,870
<font color="#E5E5E5">very cool if you link your firewall</font>

382
00:16:12,250 --> 00:16:15,700
rules really carefully with your name

383
00:16:13,870 --> 00:16:19,480
server then you can<font color="#E5E5E5"> probably do it that</font>

384
00:16:15,700 --> 00:16:20,920
way that is all I<font color="#E5E5E5"> have I have about 14</font>

385
00:16:19,480 --> 00:16:22,360
minutes for questions I hope<font color="#E5E5E5"> that</font>

386
00:16:20,920 --> 00:16:25,290
there's at least one and that I can

387
00:16:22,360 --> 00:16:25,290
continue<font color="#E5E5E5"> to talk</font>

388
00:16:28,189 --> 00:16:35,870
good morning dr. yahoo here so / 400-600

389
00:16:33,810 --> 00:16:40,529
games for worse than you think our

390
00:16:35,870 --> 00:16:43,949
suspect or potentially filmmakers do you

391
00:16:40,529 --> 00:16:47,189
have compiled this you still aboard and

392
00:16:43,949 --> 00:16:51,060
<font color="#E5E5E5">sp2 us to go for out the name server for</font>

393
00:16:47,189 --> 00:16:53,699
size I can make it available but I do

394
00:16:51,060 --> 00:17:01,079
have to<font color="#E5E5E5"> I can't just publish that based</font>

395
00:16:53,699 --> 00:17:03,839
on Serge<font color="#CCCCCC"> rule I would</font><font color="#E5E5E5"> like to say that</font>

396
00:17:01,079 --> 00:17:06,899
that was true right I can give it<font color="#CCCCCC"> to you</font>

397
00:17:03,839 --> 00:17:08,669
certainly uh publishing it publicly is a

398
00:17:06,900 --> 00:17:10,890
little bit more difficult however<font color="#E5E5E5"> I</font>

399
00:17:08,669 --> 00:17:13,199
would<font color="#E5E5E5"> be interested in exploring where</font>

400
00:17:10,890 --> 00:17:14,339
we sort<font color="#E5E5E5"> of hand it off to someone else</font>

401
00:17:13,199 --> 00:17:16,500
who might incorporate it in something

402
00:17:14,339 --> 00:17:22,889
that<font color="#CCCCCC"> they would use that might have</font>

403
00:17:16,500 --> 00:17:25,220
better dissemination yeah I come talk to

404
00:17:22,890 --> 00:17:25,220
me afterwards

405
00:17:43,730 --> 00:17:52,680
so I thought<font color="#E5E5E5"> about</font><font color="#CCCCCC"> that and I basically</font>

406
00:17:49,820 --> 00:17:54,240
decided that it was not<font color="#E5E5E5"> our we were not</font>

407
00:17:52,680 --> 00:17:59,070
going to issue a response to any of

408
00:17:54,240 --> 00:18:02,300
those Ras so I'm doing<font color="#CCCCCC"> the best I can</font>

409
00:17:59,070 --> 00:18:06,270
given that I know that<font color="#CCCCCC"> I'm past that</font>

410
00:18:02,300 --> 00:18:26,129
period right but that would have been

411
00:18:06,270 --> 00:18:30,320
ideal however the breezes in any case

412
00:18:26,130 --> 00:18:32,820
sort of trivial these people<font color="#E5E5E5"> layer down</font>

413
00:18:30,320 --> 00:18:37,649
there's<font color="#E5E5E5"> nothing special about the</font>

414
00:18:32,820 --> 00:18:44,939
registries control especially for NSN

415
00:18:37,650 --> 00:18:47,730
records so I so this is a always a

416
00:18:44,940 --> 00:18:51,600
matter of you know how much effort we

417
00:18:47,730 --> 00:18:53,820
put in on what areas you don't I agree

418
00:18:51,600 --> 00:18:57,350
<font color="#CCCCCC">that it's not any kind</font><font color="#E5E5E5"> of silver bullet</font>

419
00:18:53,820 --> 00:19:02,070
there is no one silver bullet if you can

420
00:18:57,350 --> 00:19:03,750
however clean up certain<font color="#CCCCCC"> tlds better</font>

421
00:19:02,070 --> 00:19:05,970
right you have better assurances that

422
00:19:03,750 --> 00:19:08,490
things in precisely that second level

423
00:19:05,970 --> 00:19:10,500
are safer and if<font color="#E5E5E5"> I get to the point</font>

424
00:19:08,490 --> 00:19:13,740
where i can<font color="#CCCCCC"> just say i'm gonna block all</font>

425
00:19:10,500 --> 00:19:15,480
dynamic dns on my secure network right

426
00:19:13,740 --> 00:19:18,380
because everything bad has been forced

427
00:19:15,480 --> 00:19:20,970
<font color="#CCCCCC">out of all of the traditional registries</font>

428
00:19:18,380 --> 00:19:25,790
because they keep track of it that is

429
00:19:20,970 --> 00:19:25,790
not trivial if that's not useless

430
00:19:27,330 --> 00:19:34,980
<font color="#CCCCCC">a real progress</font><font color="#E5E5E5"> on the step first of all</font>

431
00:19:31,850 --> 00:19:36,570
as a matter of fact you know I<font color="#E5E5E5"> can just</font>

432
00:19:34,980 --> 00:19:43,020
doesn't have that capability because all

433
00:19:36,570 --> 00:19:45,120
the CCTVs are are subject to you simply

434
00:19:43,020 --> 00:19:49,470
can<font color="#CCCCCC"> you essentially you're trying your</font>

435
00:19:45,120 --> 00:19:51,600
cell phone but<font color="#E5E5E5"> but also because of the</font>

436
00:19:49,470 --> 00:19:54,990
<font color="#E5E5E5">large expansion of the roof I think that</font>

437
00:19:51,600 --> 00:19:57,860
this is<font color="#E5E5E5"> a problem that just expands per</font>

438
00:19:54,990 --> 00:20:02,640
hour I think I can't seriously bleep

439
00:19:57,860 --> 00:20:04,500
list of this or are it<font color="#CCCCCC"> seems</font><font color="#E5E5E5"> to me</font>

440
00:20:02,640 --> 00:20:07,770
rather than you something<font color="#E5E5E5"> that was</font>

441
00:20:04,500 --> 00:20:25,890
implied by the biggest conscious and

442
00:20:07,770 --> 00:20:28,050
that is your reputation oh yeah and i

443
00:20:25,890 --> 00:20:30,240
know i did<font color="#E5E5E5"> not actually say in the</font>

444
00:20:28,050 --> 00:20:32,610
slides i can at all because i'm aware of

445
00:20:30,240 --> 00:20:34,620
they don't actually to the extent<font color="#E5E5E5"> that</font>

446
00:20:32,610 --> 00:20:38,429
they have contracts with the ccTLDs they

447
00:20:34,620 --> 00:20:43,199
are not so binding on behavioral

448
00:20:38,430 --> 00:20:45,660
modifications so each TLD is going to

449
00:20:43,200 --> 00:20:47,040
have to<font color="#CCCCCC"> be convinced of the utility of</font>

450
00:20:45,660 --> 00:20:48,630
this independently which does not

451
00:20:47,040 --> 00:20:51,000
exactly give a nice friendly single

452
00:20:48,630 --> 00:20:52,800
point of contact to make any<font color="#CCCCCC"> changes but</font>

453
00:20:51,000 --> 00:20:54,180
that doesn't mean that<font color="#E5E5E5"> we just throw up</font>

454
00:20:52,800 --> 00:20:57,830
our hands completely and say that uh

455
00:20:54,180 --> 00:20:57,830
this is hard we'd better not try at all

456
00:21:00,170 --> 00:21:04,560
I'm<font color="#E5E5E5"> gonna put your table a question from</font>

457
00:21:02,520 --> 00:21:06,629
the table up here and we've heard in

458
00:21:04,560 --> 00:21:09,659
recent talks in other conferences that

459
00:21:06,630 --> 00:21:11,130
there are millions of open recursive DNS

460
00:21:09,660 --> 00:21:13,650
resolvers on the<font color="#E5E5E5"> internet is that's</font>

461
00:21:11,130 --> 00:21:15,200
something that's cross search radars at

462
00:21:13,650 --> 00:21:18,500
using the overlap<font color="#E5E5E5"> of the issue</font>

463
00:21:15,200 --> 00:21:20,690
about here and it was like 32 million

464
00:21:18,500 --> 00:21:24,130
open resolvers out there yeah so the

465
00:21:20,690 --> 00:21:31,070
number<font color="#E5E5E5"> of open resolvers is large and</font>

466
00:21:24,130 --> 00:21:35,299
yes I'm aware of that that that's a

467
00:21:31,070 --> 00:21:36,769
different sort of<font color="#E5E5E5"> issue I think because</font>

468
00:21:35,299 --> 00:21:37,940
with the open resolvers one of the

469
00:21:36,769 --> 00:21:41,360
things that people are really worried

470
00:21:37,940 --> 00:21:45,559
about<font color="#E5E5E5"> is the reflection and sort of</font>

471
00:21:41,360 --> 00:21:47,990
public health concerns which i think is

472
00:21:45,559 --> 00:21:54,320
a serious issue but<font color="#CCCCCC"> i</font><font color="#E5E5E5"> think is separate</font>

473
00:21:47,990 --> 00:21:56,269
from denying the malicious content

474
00:21:54,320 --> 00:21:59,689
controllers their ability to<font color="#E5E5E5"> actually</font>

475
00:21:56,269 --> 00:22:02,500
have some sort of master copy so right

476
00:21:59,690 --> 00:22:08,620
<font color="#E5E5E5">you can certainly use an open resolver</font>

477
00:22:02,500 --> 00:22:08,620
to make the query around some sort of

478
00:22:08,980 --> 00:22:16,639
protection that<font color="#E5E5E5"> you put in</font><font color="#CCCCCC"> place I</font>

479
00:22:10,970 --> 00:22:20,149
suppose because they are approximate of

480
00:22:16,639 --> 00:22:21,769
<font color="#E5E5E5">Lee so to some extent right proxies are</font>

481
00:22:20,149 --> 00:22:24,678
always a problem right the<font color="#E5E5E5"> Internet is a</font>

482
00:22:21,769 --> 00:22:29,000
logical<font color="#CCCCCC"> Network not a physical so we</font>

483
00:22:24,679 --> 00:22:31,039
can't oh well<font color="#CCCCCC"> this is carved off here so</font>

484
00:22:29,000 --> 00:22:32,870
it does affect you know the more things

485
00:22:31,039 --> 00:22:40,610
<font color="#CCCCCC">that are wrong to snowball the fact they</font>

486
00:22:32,870 --> 00:22:43,120
think any<font color="#E5E5E5"> more questions okay</font><font color="#CCCCCC"> all right</font>

487
00:22:40,610 --> 00:22:43,120
<font color="#E5E5E5">thank you very</font><font color="#CCCCCC"> much</font>

488
00:22:53,770 --> 00:22:55,830
you

