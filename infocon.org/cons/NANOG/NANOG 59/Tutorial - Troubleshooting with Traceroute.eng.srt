1
00:00:08,080 --> 00:00:13,210
so I'm Richard<font color="#CCCCCC"> steenburgen from gtt</font>

2
00:00:11,260 --> 00:00:15,100
we're

3
00:00:13,210 --> 00:00:17,380
again for anyone<font color="#E5E5E5"> who</font><font color="#CCCCCC"> hasn't seen</font><font color="#E5E5E5"> this</font>

4
00:00:15,100 --> 00:00:19,480
before it's been about<font color="#E5E5E5"> four and a half</font>

5
00:00:17,380 --> 00:00:21,279
years since I did<font color="#CCCCCC"> this talk so I'm doing</font>

6
00:00:19,480 --> 00:00:23,380
<font color="#CCCCCC">it again slightly revamped so hopefully</font>

7
00:00:21,279 --> 00:00:25,480
it'll be slightly different<font color="#CCCCCC"> than what</font>

8
00:00:23,380 --> 00:00:28,330
was there before hopefully slightly more

9
00:00:25,480 --> 00:00:30,340
more informative but we're here<font color="#E5E5E5"> to</font><font color="#CCCCCC"> talk</font>

10
00:00:28,330 --> 00:00:34,089
about<font color="#E5E5E5"> a practical guide to correctly</font>

11
00:00:30,340 --> 00:00:36,130
troubleshooting with traceroute so quick

12
00:00:34,090 --> 00:00:37,840
introduction troubleshooting<font color="#E5E5E5"> problems on</font>

13
00:00:36,130 --> 00:00:39,850
the internet number one go-to tool is

14
00:00:37,840 --> 00:00:42,040
traceroute every OS comes with it

15
00:00:39,850 --> 00:00:43,210
there's a million different websites you

16
00:00:42,040 --> 00:00:45,010
can run trace your outs from there's

17
00:00:43,210 --> 00:00:46,629
<font color="#E5E5E5">looking-glasses there's visual</font>

18
00:00:45,010 --> 00:00:47,890
traceroute tools there's things that

19
00:00:46,629 --> 00:00:49,358
will put a little pretty picture

20
00:00:47,890 --> 00:00:50,769
together and show you where<font color="#E5E5E5"> the latency</font>

21
00:00:49,359 --> 00:00:54,329
goes up so that everyone<font color="#E5E5E5"> and their</font>

22
00:00:50,769 --> 00:00:56,410
<font color="#E5E5E5">grandmother can and does use it use it</font>

23
00:00:54,329 --> 00:00:57,460
there's a lot<font color="#CCCCCC"> of free stuff</font><font color="#E5E5E5"> there's a</font>

24
00:00:56,410 --> 00:01:00,248
lot<font color="#CCCCCC"> of commercially available tools</font>

25
00:00:57,460 --> 00:01:01,989
there's a lot of tools like MTR that

26
00:01:00,249 --> 00:01:03,940
will run continuous trace routes they'll

27
00:01:01,989 --> 00:01:05,679
kind of map out the network and give you

28
00:01:03,940 --> 00:01:07,450
<font color="#E5E5E5">some visualization and it seems like</font>

29
00:01:05,680 --> 00:01:09,760
it's a very<font color="#E5E5E5"> simple and easy-to-use tool</font>

30
00:01:07,450 --> 00:01:12,100
all you do is<font color="#CCCCCC"> you</font><font color="#E5E5E5"> type in a destination</font>

31
00:01:09,760 --> 00:01:13,810
IP address and it shows you the path to

32
00:01:12,100 --> 00:01:15,699
every router along the way and<font color="#E5E5E5"> it would</font>

33
00:01:13,810 --> 00:01:17,350
seem intuitively like you could<font color="#E5E5E5"> look at</font>

34
00:01:15,700 --> 00:01:19,720
<font color="#CCCCCC">this and see something</font><font color="#E5E5E5"> really obvious</font>

35
00:01:17,350 --> 00:01:21,429
like hey look the latency jumps up here

36
00:01:19,720 --> 00:01:23,530
or hey look there's packet loss here and

37
00:01:21,430 --> 00:01:25,659
that that would actually<font color="#E5E5E5"> help you go</font>

38
00:01:23,530 --> 00:01:29,619
figure<font color="#CCCCCC"> out the problem it turns out not</font>

39
00:01:25,659 --> 00:01:31,689
to be the case so<font color="#CCCCCC"> why</font><font color="#E5E5E5"> does that turn out</font>

40
00:01:29,619 --> 00:01:33,159
not to be the case well these days most

41
00:01:31,689 --> 00:01:36,279
modern networks are actually pretty well

42
00:01:33,159 --> 00:01:38,320
run so a lot of your simple issues like

43
00:01:36,280 --> 00:01:41,290
simple congestion or routing loops or

44
00:01:38,320 --> 00:01:43,570
random things that that are easily

45
00:01:41,290 --> 00:01:45,729
<font color="#E5E5E5">diagnosed with traceroute tend to be</font>

46
00:01:43,570 --> 00:01:48,298
less and less common which you<font color="#E5E5E5"> left with</font>

47
00:01:45,729 --> 00:01:50,469
tends<font color="#E5E5E5"> to be more and more complex and</font>

48
00:01:48,299 --> 00:01:51,909
turns<font color="#E5E5E5"> out there's very few people that</font>

49
00:01:50,469 --> 00:01:54,219
<font color="#E5E5E5">are actually skilled in interpreting</font>

50
00:01:51,909 --> 00:01:57,490
<font color="#CCCCCC">traceroute like i said it looks</font>

51
00:01:54,219 --> 00:01:59,380
relatively easy<font color="#E5E5E5"> to use but it it turns</font>

52
00:01:57,490 --> 00:02:00,820
to give<font color="#E5E5E5"> people the impression that they</font>

53
00:01:59,380 --> 00:02:02,979
know how to<font color="#E5E5E5"> read a traceroute when they</font>

54
00:02:00,820 --> 00:02:03,758
don't<font color="#E5E5E5"> or that they can look at a single</font>

55
00:02:02,979 --> 00:02:05,560
trace<font color="#E5E5E5"> you're out and make a</font>

56
00:02:03,759 --> 00:02:07,450
determination<font color="#E5E5E5"> and the reality is</font><font color="#CCCCCC"> you</font>

57
00:02:05,560 --> 00:02:08,949
need more than<font color="#E5E5E5"> one traceroute and you</font>

58
00:02:07,450 --> 00:02:10,660
need some knowledge<font color="#E5E5E5"> of the destination</font>

59
00:02:08,949 --> 00:02:12,399
<font color="#E5E5E5">points you need a bunch of other things</font>

60
00:02:10,660 --> 00:02:14,109
<font color="#CCCCCC">that are outside of that one piece of</font>

61
00:02:12,400 --> 00:02:16,780
screen input to actually figure out

62
00:02:14,110 --> 00:02:19,540
<font color="#E5E5E5">what's going</font><font color="#CCCCCC"> on so in reality it turns</font>

63
00:02:16,780 --> 00:02:21,580
out most most<font color="#E5E5E5"> ISP</font><font color="#CCCCCC"> knox and even most</font>

64
00:02:19,540 --> 00:02:22,989
mid-level IP engineering staff

65
00:02:21,580 --> 00:02:25,750
actually qualified to interpret

66
00:02:22,990 --> 00:02:28,690
traceroute correctly and what this tends

67
00:02:25,750 --> 00:02:30,430
to<font color="#E5E5E5"> do is you get an overload anyone</font>

68
00:02:28,690 --> 00:02:33,190
that's<font color="#CCCCCC"> ever answered not tickets from</font>

69
00:02:30,430 --> 00:02:34,540
traceroute gets an overload of stupid

70
00:02:33,190 --> 00:02:37,350
<font color="#CCCCCC">tracery up tickets for things that are</font>

71
00:02:34,540 --> 00:02:39,670
<font color="#E5E5E5">not your network and it tends to really</font>

72
00:02:37,350 --> 00:02:41,170
number one make it difficult to

73
00:02:39,670 --> 00:02:43,269
troubleshoot real issues number to<font color="#E5E5E5"> make</font>

74
00:02:41,170 --> 00:02:45,040
<font color="#E5E5E5">it difficult to report real issues other</font>

75
00:02:43,270 --> 00:02:46,480
people because people don't believe<font color="#E5E5E5"> you</font>

76
00:02:45,040 --> 00:02:49,000
when you<font color="#CCCCCC"> sit in a chair I'll ticket</font><font color="#E5E5E5"> you</font>

77
00:02:46,480 --> 00:02:52,000
<font color="#E5E5E5">actually know what you're doing so</font>

78
00:02:49,000 --> 00:02:53,380
simple traceroute output for anyone who

79
00:02:52,000 --> 00:02:54,910
hasn't<font color="#CCCCCC"> seen a traceroute if you haven't</font>

80
00:02:53,380 --> 00:02:59,200
you bigger problems that<font color="#E5E5E5"> I can help you</font>

81
00:02:54,910 --> 00:03:01,540
<font color="#E5E5E5">with here you know you're going to see a</font>

82
00:02:59,200 --> 00:03:04,149
list of rows you're going to see the hop

83
00:03:01,540 --> 00:03:05,859
number the IP<font color="#CCCCCC"> address and the reverse</font>

84
00:03:04,150 --> 00:03:07,600
<font color="#E5E5E5">DNS for what that router hop is and</font>

85
00:03:05,860 --> 00:03:09,310
you're going to see a series of latency

86
00:03:07,600 --> 00:03:13,600
measurements in this case we're seeing

87
00:03:09,310 --> 00:03:14,860
three latency measurements per<font color="#E5E5E5"> app so if</font>

88
00:03:13,600 --> 00:03:16,600
you actually want to<font color="#E5E5E5"> know how tres4</font>

89
00:03:14,860 --> 00:03:20,050
traceroute works at the packet level

90
00:03:16,600 --> 00:03:21,970
here's what's happening you are starting

91
00:03:20,050 --> 00:03:24,400
by launching a pro packet toward the

92
00:03:21,970 --> 00:03:26,470
destination and you set a TTL value of

93
00:03:24,400 --> 00:03:29,950
time to live value on the IP header of

94
00:03:26,470 --> 00:03:31,780
one every time<font color="#E5E5E5"> a router touches a packet</font>

95
00:03:29,950 --> 00:03:33,549
it will decrement the value and when the

96
00:03:31,780 --> 00:03:36,280
value had<font color="#E5E5E5"> zero it drops the packet and</font>

97
00:03:33,550 --> 00:03:37,959
more importantly it sends<font color="#CCCCCC"> back an ICMP</font>

98
00:03:36,280 --> 00:03:40,420
message to the original source that says

99
00:03:37,959 --> 00:03:42,790
hey I dropped your packet and traceroute

100
00:03:40,420 --> 00:03:45,429
looks at these ICMP messages and uses

101
00:03:42,790 --> 00:03:47,170
that figure out the path so when you

102
00:03:45,430 --> 00:03:50,140
launch that first packet with a TTL of

103
00:03:47,170 --> 00:03:52,510
<font color="#E5E5E5">one the router gets it decrements the</font>

104
00:03:50,140 --> 00:03:54,760
value<font color="#E5E5E5"> hits zero now it's going to drop</font>

105
00:03:52,510 --> 00:03:57,399
the packet drops it<font color="#E5E5E5"> sends</font><font color="#CCCCCC"> back its ICMP</font>

106
00:03:54,760 --> 00:04:00,070
TTL exceed message the source gets that

107
00:03:57,400 --> 00:04:01,660
ICMP calculates the difference in time

108
00:04:00,070 --> 00:04:04,239
between when it send its probe and when

109
00:04:01,660 --> 00:04:07,720
it<font color="#E5E5E5"> gets this ICMP response and displays</font>

110
00:04:04,239 --> 00:04:10,450
a hop and a latency value and go back to

111
00:04:07,720 --> 00:04:12,850
step<font color="#E5E5E5"> one repeat but this time increment</font>

112
00:04:10,450 --> 00:04:14,410
the TTL value so start<font color="#CCCCCC"> with two so the</font>

113
00:04:12,850 --> 00:04:16,269
packet will get two hops out before it

114
00:04:14,410 --> 00:04:18,909
gets dropped the ICMP goes back and you

115
00:04:16,269 --> 00:04:20,820
use<font color="#CCCCCC"> that to figure out what your path is</font>

116
00:04:18,910 --> 00:04:22,540
and then when you<font color="#CCCCCC"> get</font><font color="#E5E5E5"> to the end</font>

117
00:04:20,820 --> 00:04:25,540
typically what'll happen is you'll

118
00:04:22,540 --> 00:04:28,720
you'll get the most traceroute probes or

119
00:04:25,540 --> 00:04:31,060
either<font color="#E5E5E5"> UDP to a port</font><font color="#CCCCCC"> that nothing's</font>

120
00:04:28,720 --> 00:04:32,600
listening on or an ICMP message or

121
00:04:31,060 --> 00:04:35,180
<font color="#CCCCCC">something so you'll</font><font color="#E5E5E5"> get back</font>

122
00:04:32,600 --> 00:04:36,410
the ICMP message other<font color="#E5E5E5"> than</font><font color="#CCCCCC"> a TTL exceed</font>

123
00:04:35,180 --> 00:04:40,340
and that's how tracer I'll knows hey

124
00:04:36,410 --> 00:04:42,110
we're done stop some more details about

125
00:04:40,340 --> 00:04:44,719
how this actually works most

126
00:04:42,110 --> 00:04:47,630
implementations send multiple probes /

127
00:04:44,720 --> 00:04:50,510
<font color="#E5E5E5">hop so like I showed in the previous</font>

128
00:04:47,630 --> 00:04:52,760
example the default is<font color="#CCCCCC"> three</font><font color="#E5E5E5"> so that</font>

129
00:04:50,510 --> 00:04:54,380
means for<font color="#CCCCCC"> every time the TTL value is</font>

130
00:04:52,760 --> 00:04:55,909
incremented you're going to send three

131
00:04:54,380 --> 00:04:57,320
probes and you're going<font color="#E5E5E5"> to get three</font>

132
00:04:55,910 --> 00:05:01,700
different latency measurements for each

133
00:04:57,320 --> 00:05:03,980
hop each<font color="#CCCCCC"> Pro packet uses a unique key to</font>

134
00:05:01,700 --> 00:05:06,380
i distinguish yourself so<font color="#E5E5E5"> typically what</font>

135
00:05:03,980 --> 00:05:08,540
you'll see their most traceroute

136
00:05:06,380 --> 00:05:10,490
implementations like a UDP based

137
00:05:08,540 --> 00:05:12,530
traceroute will have an incrementing

138
00:05:10,490 --> 00:05:15,470
destination port so when it sends<font color="#E5E5E5"> three</font>

139
00:05:12,530 --> 00:05:17,659
<font color="#E5E5E5">3434 it knows that</font><font color="#CCCCCC"> its probe one when</font><font color="#E5E5E5"> it</font>

140
00:05:15,470 --> 00:05:20,240
sends three 3435 it knows<font color="#CCCCCC"> that its probe</font>

141
00:05:17,660 --> 00:05:22,430
to its how it reconstructs the data<font color="#E5E5E5"> when</font>

142
00:05:20,240 --> 00:05:24,440
he gets back but another thing<font color="#E5E5E5"> to keep</font>

143
00:05:22,430 --> 00:05:26,750
in mind is that every<font color="#E5E5E5"> pro packet is a</font>

144
00:05:24,440 --> 00:05:28,850
completely<font color="#E5E5E5"> independent trial so just</font>

145
00:05:26,750 --> 00:05:31,070
because traceroute is showing it to you

146
00:05:28,850 --> 00:05:32,540
on the same line in the same the<font color="#CCCCCC"> same</font>

147
00:05:31,070 --> 00:05:34,640
place<font color="#E5E5E5"> with the number one beside it</font>

148
00:05:32,540 --> 00:05:37,090
doesn't mean that<font color="#E5E5E5"> in any way followed</font>

149
00:05:34,640 --> 00:05:39,950
the same path either forward or backward

150
00:05:37,090 --> 00:05:42,320
and this may or may not be visible<font color="#E5E5E5"> to</font>

151
00:05:39,950 --> 00:05:43,729
the end user so it might<font color="#CCCCCC"> look like it's</font>

152
00:05:42,320 --> 00:05:45,170
the exact same path it might be the same

153
00:05:43,730 --> 00:05:47,420
router address it might be the<font color="#E5E5E5"> same</font>

154
00:05:45,170 --> 00:05:48,770
everything<font color="#E5E5E5"> but you are no way guaranteed</font>

155
00:05:47,420 --> 00:05:51,050
that the paths throughout though the

156
00:05:48,770 --> 00:05:52,669
packet actually followed is the same

157
00:05:51,050 --> 00:05:55,940
path everything is a<font color="#E5E5E5"> completely</font>

158
00:05:52,670 --> 00:05:59,090
independent trial the way the traceroute

159
00:05:55,940 --> 00:06:01,130
calculates latency is very simple like<font color="#E5E5E5"> I</font>

160
00:05:59,090 --> 00:06:03,349
said<font color="#E5E5E5"> you timestamp when you launch the</font>

161
00:06:01,130 --> 00:06:06,080
probe packet you<font color="#E5E5E5"> timestamp when you get</font>

162
00:06:03,350 --> 00:06:07,190
the ICMP packet back and you subtract

163
00:06:06,080 --> 00:06:09,710
<font color="#CCCCCC">the difference and that's your round</font>

164
00:06:07,190 --> 00:06:13,040
trip time there is no router based

165
00:06:09,710 --> 00:06:14,780
processing of the the package themselves

166
00:06:13,040 --> 00:06:15,980
so the router doesn't<font color="#E5E5E5"> do any calculation</font>

167
00:06:14,780 --> 00:06:17,450
the router doesn't<font color="#E5E5E5"> have to have an</font>

168
00:06:15,980 --> 00:06:20,150
accurate clock the router doesn't<font color="#E5E5E5"> do</font>

169
00:06:17,450 --> 00:06:23,270
anything<font color="#E5E5E5"> other than drop the packet send</font>

170
00:06:20,150 --> 00:06:25,310
the ICMP back some implementations will

171
00:06:23,270 --> 00:06:26,719
actually encode inside the payload of

172
00:06:25,310 --> 00:06:29,150
the pro packet<font color="#CCCCCC"> del encode a little bit</font>

173
00:06:26,720 --> 00:06:30,590
of<font color="#E5E5E5"> data and when you get the ICMP</font>

174
00:06:29,150 --> 00:06:32,239
message back you'll get a lot of the

175
00:06:30,590 --> 00:06:33,919
first few bites of that so sometimes

176
00:06:32,240 --> 00:06:36,530
I'll use<font color="#CCCCCC"> that to offload some of the</font>

177
00:06:33,920 --> 00:06:38,120
state so they<font color="#E5E5E5"> don't have to keep track</font>

178
00:06:36,530 --> 00:06:40,070
of when they sent the pro packet but

179
00:06:38,120 --> 00:06:41,180
it's the principle is<font color="#E5E5E5"> the same you're</font>

180
00:06:40,070 --> 00:06:43,139
taking the difference in time between

181
00:06:41,180 --> 00:06:46,830
when you sent your packet when you got

182
00:06:43,139 --> 00:06:49,289
pack it<font color="#CCCCCC"> back so like I said the the</font>

183
00:06:46,830 --> 00:06:51,779
latency is the total of<font color="#E5E5E5"> the time taken</font>

184
00:06:49,289 --> 00:06:53,639
for you to forward<font color="#CCCCCC"> that</font><font color="#E5E5E5"> traffic to that</font>

185
00:06:51,779 --> 00:06:54,990
hop where it gets dropped the time that

186
00:06:53,639 --> 00:06:57,090
it<font color="#E5E5E5"> takes for the router to drop the</font>

187
00:06:54,990 --> 00:06:58,439
packet and generate the ICMP message and

188
00:06:57,090 --> 00:07:00,840
then the time that it<font color="#E5E5E5"> takes for that</font>

189
00:06:58,439 --> 00:07:02,550
ICMP message to get back to the sender

190
00:07:00,840 --> 00:07:04,318
that's those<font color="#E5E5E5"> three elements come</font>

191
00:07:02,550 --> 00:07:08,430
together to make<font color="#CCCCCC"> up your your latency</font>

192
00:07:04,319 --> 00:07:09,629
value so if you look<font color="#E5E5E5"> at traceroute and</font>

193
00:07:08,430 --> 00:07:11,550
you want to<font color="#E5E5E5"> know what are you actually</font>

194
00:07:09,629 --> 00:07:13,759
seeing what hops are you seeing<font color="#CCCCCC"> what</font>

195
00:07:11,550 --> 00:07:18,389
interface IP addresses are you saying

196
00:07:13,759 --> 00:07:20,580
traceroute will always return the ICMP

197
00:07:18,389 --> 00:07:23,550
<font color="#E5E5E5">packet sourced from the ingress</font>

198
00:07:20,580 --> 00:07:25,650
interface so we look at this<font color="#E5E5E5"> example the</font>

199
00:07:23,550 --> 00:07:27,900
the pro packet comes into router one and

200
00:07:25,650 --> 00:07:30,810
it has an ingress interface with a slash

201
00:07:27,900 --> 00:07:35,060
30 on it and it is 17 to 16 dot-to-dot 1

202
00:07:30,810 --> 00:07:37,589
/ 30 when it drops the<font color="#E5E5E5"> packet on router1</font>

203
00:07:35,060 --> 00:07:39,089
decrement the TTL 20 decides that it's

204
00:07:37,589 --> 00:07:41,069
<font color="#E5E5E5">going to drop this packet and sends back</font>

205
00:07:39,089 --> 00:07:43,259
an ICMP message it's going to source

206
00:07:41,069 --> 00:07:46,020
that ICMP from the interface that it

207
00:07:43,259 --> 00:07:47,339
came in on so in this example you see

208
00:07:46,020 --> 00:07:51,000
the the two hops that<font color="#E5E5E5"> you'll actually</font>

209
00:07:47,339 --> 00:07:53,250
see and traceroute the 17 to 16<font color="#CCCCCC"> 21</font><font color="#E5E5E5"> and</font>

210
00:07:51,000 --> 00:07:55,409
the<font color="#CCCCCC"> other ingress interface router too</font>

211
00:07:53,250 --> 00:07:56,610
you're<font color="#E5E5E5"> not going to see the egress</font>

212
00:07:55,409 --> 00:07:58,830
interface you're not going to see the

213
00:07:56,610 --> 00:08:01,139
return you're not going to see any<font color="#E5E5E5"> of</font>

214
00:07:58,830 --> 00:08:03,599
that an interesting<font color="#E5E5E5"> factoid is this is</font>

215
00:08:01,139 --> 00:08:05,819
<font color="#E5E5E5">actually</font><font color="#CCCCCC"> not a standard behavior if you</font>

216
00:08:03,599 --> 00:08:08,550
<font color="#CCCCCC">actually</font><font color="#E5E5E5"> go read the rfcs thats a howl</font>

217
00:08:05,819 --> 00:08:10,529
router should<font color="#E5E5E5"> work when they for when</font>

218
00:08:08,550 --> 00:08:12,569
they drop a packet and send an ICMP it

219
00:08:10,529 --> 00:08:14,639
<font color="#E5E5E5">actually says</font><font color="#CCCCCC"> that it must be sourced</font>

220
00:08:12,569 --> 00:08:16,229
from the egress interface and it turns

221
00:08:14,639 --> 00:08:18,479
out this doesn't happen in practice and

222
00:08:16,229 --> 00:08:19,919
if it did traceroute wouldn't work<font color="#E5E5E5"> so</font>

223
00:08:18,479 --> 00:08:21,899
we're kind of fortunate that no one ever

224
00:08:19,919 --> 00:08:27,870
fixed it but interestingly no one ever

225
00:08:21,899 --> 00:08:29,099
went back an update of the RFC Oh next

226
00:08:27,870 --> 00:08:32,909
thing we<font color="#CCCCCC"> want to talk about is how you</font>

227
00:08:29,099 --> 00:08:34,529
interpret<font color="#CCCCCC"> DNS and</font><font color="#E5E5E5"> a traceroute really</font>

228
00:08:32,909 --> 00:08:36,510
you don't retrace her out by the IP

229
00:08:34,529 --> 00:08:38,789
address<font color="#E5E5E5"> most operators are kind enough</font>

230
00:08:36,510 --> 00:08:42,520
to throw some dns information in there

231
00:08:38,789 --> 00:08:44,650
some of them are<font color="#E5E5E5"> Google but</font>

232
00:08:42,520 --> 00:08:46,180
most of them are and it's very<font color="#CCCCCC"> helpful</font>

233
00:08:44,650 --> 00:08:47,530
for<font color="#E5E5E5"> figuring out what's going on even if</font>

234
00:08:46,180 --> 00:08:50,829
it's<font color="#E5E5E5"> not your network</font><font color="#CCCCCC"> you can kind of</font>

235
00:08:47,530 --> 00:08:52,870
get an<font color="#E5E5E5"> idea of a lot of information like</font>

236
00:08:50,830 --> 00:08:55,180
geographic locations where these things

237
00:08:52,870 --> 00:08:57,190
are physically located you<font color="#E5E5E5"> can start to</font>

238
00:08:55,180 --> 00:08:59,560
tell the interface types and the

239
00:08:57,190 --> 00:09:02,110
capacities you can even start to tell

240
00:08:59,560 --> 00:09:03,520
the router types and roles and most

241
00:09:02,110 --> 00:09:07,570
importantly you look for<font color="#E5E5E5"> network</font>

242
00:09:03,520 --> 00:09:09,220
boundaries and relationships so why do

243
00:09:07,570 --> 00:09:11,680
<font color="#E5E5E5">you</font><font color="#CCCCCC"> want to know the location of</font><font color="#E5E5E5"> the</font>

244
00:09:09,220 --> 00:09:14,320
routers knowing the geographic location

245
00:09:11,680 --> 00:09:16,150
of the routers is important for figuring

246
00:09:14,320 --> 00:09:18,250
out a lot<font color="#E5E5E5"> of things like is this</font>

247
00:09:16,150 --> 00:09:20,500
<font color="#CCCCCC">suboptimal</font><font color="#E5E5E5"> routing am i going from</font>

248
00:09:18,250 --> 00:09:22,750
<font color="#E5E5E5">Phoenix to ashburn to come back to San</font>

249
00:09:20,500 --> 00:09:24,160
Jose that<font color="#E5E5E5"> matters and so you need to</font>

250
00:09:22,750 --> 00:09:26,590
know if their routers in<font color="#CCCCCC"> Ashburn or Los</font>

251
00:09:24,160 --> 00:09:28,510
Angeles it's going<font color="#E5E5E5"> to help you figure</font>

252
00:09:26,590 --> 00:09:29,980
out your network latency you're going to

253
00:09:28,510 --> 00:09:33,700
a lot it will talk about this later<font color="#E5E5E5"> but</font>

254
00:09:29,980 --> 00:09:35,440
the latency is largely tied to the

255
00:09:33,700 --> 00:09:36,970
distance that<font color="#CCCCCC"> the signal is propagating</font>

256
00:09:35,440 --> 00:09:40,360
over and so if<font color="#E5E5E5"> you see something that is</font>

257
00:09:36,970 --> 00:09:43,000
vastly out of the way then it's probably

258
00:09:40,360 --> 00:09:44,710
not<font color="#CCCCCC"> a good thing</font><font color="#E5E5E5"> or</font><font color="#CCCCCC"> that might or might</font>

259
00:09:43,000 --> 00:09:48,270
not be an explanation for<font color="#E5E5E5"> the latency</font>

260
00:09:44,710 --> 00:09:50,470
that<font color="#CCCCCC"> you see so the</font><font color="#E5E5E5"> most commonly used</font>

261
00:09:48,270 --> 00:09:53,439
location identifiers that people put in

262
00:09:50,470 --> 00:09:57,370
traceroute are the<font color="#CCCCCC"> iata or the ICAO</font>

263
00:09:53,440 --> 00:10:00,340
airport codes or silly codes primarily

264
00:09:57,370 --> 00:10:04,590
in<font color="#E5E5E5"> the US but a lot</font><font color="#CCCCCC"> of times people just</font>

265
00:10:00,340 --> 00:10:04,590
attempt to abbreviate it to a common

266
00:10:25,880 --> 00:10:29,610
population there's an<font color="#E5E5E5"> airport and they</font>

267
00:10:27,990 --> 00:10:32,490
have a unique set of codes assigned to

268
00:10:29,610 --> 00:10:35,070
them so it's very easy<font color="#E5E5E5"> to to reuse those</font>

269
00:10:32,490 --> 00:10:38,670
codes especially if you<font color="#CCCCCC"> have a large</font>

270
00:10:35,070 --> 00:10:40,680
small number of large pops so for

271
00:10:38,670 --> 00:10:43,709
<font color="#E5E5E5">example if you you care about Phoenix as</font>

272
00:10:40,680 --> 00:10:46,439
a major airport PHX is very easy to

273
00:10:43,709 --> 00:10:48,599
figure<font color="#E5E5E5"> out if you care about mapping</font>

274
00:10:46,440 --> 00:10:50,670
into a lot<font color="#CCCCCC"> more a lot</font><font color="#E5E5E5"> of smaller detail</font>

275
00:10:48,600 --> 00:10:53,070
like say<font color="#E5E5E5"> Chandler Arizona where we're at</font>

276
00:10:50,670 --> 00:10:54,630
it's not so important not so useful to

277
00:10:53,070 --> 00:10:56,940
you but if you really care about<font color="#E5E5E5"> the</font>

278
00:10:54,630 --> 00:10:58,529
major major metropolitan areas then it's

279
00:10:56,940 --> 00:11:01,829
it's a good way to do it and<font color="#E5E5E5"> it's short</font>

280
00:10:58,529 --> 00:11:03,660
three letter code sometimes things get

281
00:11:01,829 --> 00:11:07,319
confusing though a lot of airport codes

282
00:11:03,660 --> 00:11:08,790
are not intuitive you could get<font color="#E5E5E5"> into a</font>

283
00:11:07,320 --> 00:11:12,209
<font color="#E5E5E5">couple situations so for example</font>

284
00:11:08,790 --> 00:11:16,189
somewhere like New York is served by

285
00:11:12,209 --> 00:11:18,930
three different airports JFK LGA and ewr

286
00:11:16,190 --> 00:11:21,899
so a lot of times people will just write

287
00:11:18,930 --> 00:11:24,269
NYC and that that is actually a code

288
00:11:21,899 --> 00:11:25,649
that represents all three of those but a

289
00:11:24,269 --> 00:11:27,540
lot<font color="#CCCCCC"> of times you get into a situation</font>

290
00:11:25,649 --> 00:11:29,850
<font color="#E5E5E5">where is not clear which airport am I</font>

291
00:11:27,540 --> 00:11:32,310
closer to which what level of detail

292
00:11:29,850 --> 00:11:34,290
should I go into<font color="#E5E5E5"> that and then the</font><font color="#CCCCCC"> other</font>

293
00:11:32,310 --> 00:11:37,709
one that you<font color="#E5E5E5"> see is a lot of airport</font>

294
00:11:34,290 --> 00:11:39,959
codes are based on historic names for

295
00:11:37,709 --> 00:11:42,268
example Northern Virginia is served by

296
00:11:39,959 --> 00:11:44,579
<font color="#E5E5E5">IED which is not immediately obvious</font>

297
00:11:42,269 --> 00:11:46,560
Dulles Airport that's not immediately

298
00:11:44,579 --> 00:11:48,870
obvious that that's Northern Virginia so

299
00:11:46,560 --> 00:11:51,689
sometimes<font color="#CCCCCC"> people just write it out and</font>

300
00:11:48,870 --> 00:11:54,630
something like wdc or or something else

301
00:11:51,690 --> 00:11:58,560
that's it's easier to identify for the

302
00:11:54,630 --> 00:12:01,529
layman silly codes are common language

303
00:11:58,560 --> 00:12:02,849
location identifier these are the kind

304
00:12:01,529 --> 00:12:06,649
of things that<font color="#E5E5E5"> you see you in working</font>

305
00:12:02,850 --> 00:12:09,440
with telcos there is a gigantic database

306
00:12:06,649 --> 00:12:12,870
maintained and sold by telcordia and

307
00:12:09,440 --> 00:12:15,600
like so typically used by telcos to do

308
00:12:12,870 --> 00:12:17,190
lots of identified enta<font color="#CCCCCC"> fying down to</font>

309
00:12:15,600 --> 00:12:18,990
the rack level down to<font color="#CCCCCC"> the panel level</font>

310
00:12:17,190 --> 00:12:20,430
there's a standardized code the part

311
00:12:18,990 --> 00:12:21,779
<font color="#E5E5E5">that we care about for traceroute</font>

312
00:12:20,430 --> 00:12:23,160
purposes are the first six letters

313
00:12:21,779 --> 00:12:27,060
that's called the geopolitical

314
00:12:23,160 --> 00:12:28,680
identifier so for example houston texas

315
00:12:27,060 --> 00:12:30,779
or<font color="#E5E5E5"> Ashburn Virginia will be</font><font color="#CCCCCC"> written out</font>

316
00:12:28,680 --> 00:12:32,849
as these six letters this gives<font color="#E5E5E5"> you a</font>

317
00:12:30,779 --> 00:12:34,050
much<font color="#E5E5E5"> broader coverage so if you really</font>

318
00:12:32,850 --> 00:12:35,690
do care about the difference<font color="#E5E5E5"> between</font>

319
00:12:34,050 --> 00:12:37,370
Phoenix and Chandler

320
00:12:35,690 --> 00:12:41,450
you're going to want to<font color="#CCCCCC"> go to this type</font>

321
00:12:37,370 --> 00:12:43,540
of a code but the issue there is that

322
00:12:41,450 --> 00:12:45,740
this<font color="#E5E5E5"> is really a u.s. specific thing</font>

323
00:12:43,540 --> 00:12:47,870
sometimes you'll see other people kind

324
00:12:45,740 --> 00:12:49,580
of adapting it for use outside the US

325
00:12:47,870 --> 00:12:51,470
but it's not a standard there you can't

326
00:12:49,580 --> 00:12:54,470
go to a book and consultant and figuring

327
00:12:51,470 --> 00:12:58,640
out<font color="#E5E5E5"> and then sometimes people just make</font>

328
00:12:54,470 --> 00:13:01,190
<font color="#E5E5E5">stuff up another example</font><font color="#CCCCCC"> of an airport</font>

329
00:12:58,640 --> 00:13:02,780
code that's not obvious<font color="#CCCCCC"> ord if you don't</font>

330
00:13:01,190 --> 00:13:04,940
live there or fly through airports a lot

331
00:13:02,780 --> 00:13:06,829
you might not know that<font color="#CCCCCC"> ok or Chicago or</font>

332
00:13:04,940 --> 00:13:07,940
midway is the other<font color="#CCCCCC"> Airport you might</font>

333
00:13:06,830 --> 00:13:10,340
not know<font color="#CCCCCC"> that you don't one of these are</font>

334
00:13:07,940 --> 00:13:13,190
<font color="#CCCCCC">Chicago and so you might just find it</font>

335
00:13:10,340 --> 00:13:15,020
easier to put CH I I mean the benefit

336
00:13:13,190 --> 00:13:17,630
there is that it's it's more of a<font color="#E5E5E5"> human</font>

337
00:13:15,020 --> 00:13:19,370
<font color="#E5E5E5">readable value so if it's a u.s. person</font>

338
00:13:17,630 --> 00:13:21,020
reading a traceroute going through the

339
00:13:19,370 --> 00:13:23,300
US and its really obvious that it's in

340
00:13:21,020 --> 00:13:25,220
the<font color="#E5E5E5"> u.s. CH I might be fine but if it's</font>

341
00:13:23,300 --> 00:13:26,870
a non-us person and the traceroute is

342
00:13:25,220 --> 00:13:28,460
not obviously in the u.s. like

343
00:13:26,870 --> 00:13:31,310
conveniently located between new york

344
00:13:28,460 --> 00:13:32,900
and san jose or something like that then

345
00:13:31,310 --> 00:13:34,430
it might not be<font color="#E5E5E5"> obvious what that means</font>

346
00:13:32,900 --> 00:13:38,720
and that's where it's<font color="#E5E5E5"> nice to use actual</font>

347
00:13:34,430 --> 00:13:41,930
standards so<font color="#E5E5E5"> I have a little table of</font>

348
00:13:38,720 --> 00:13:44,120
the<font color="#E5E5E5"> commonly located that commonly used</font>

349
00:13:41,930 --> 00:13:45,829
major cities broken down by airport

350
00:13:44,120 --> 00:13:48,170
codes silly codes and just some of the

351
00:13:45,830 --> 00:13:52,450
other codes that people will will use in

352
00:13:48,170 --> 00:13:55,160
practice so for consulting offline

353
00:13:52,450 --> 00:13:57,380
here's<font color="#E5E5E5"> some of the non major US cities</font>

354
00:13:55,160 --> 00:13:58,819
same type of thing the<font color="#E5E5E5"> major peering</font>

355
00:13:57,380 --> 00:14:03,439
points and major inter connection points

356
00:13:58,820 --> 00:14:05,080
that<font color="#E5E5E5"> you typically see next big thing</font>

357
00:14:03,440 --> 00:14:08,420
you can do<font color="#E5E5E5"> with interpreting</font><font color="#CCCCCC"> dns is</font>

358
00:14:05,080 --> 00:14:09,710
identifying interface types so most

359
00:14:08,420 --> 00:14:11,120
networks will be kind enough to<font color="#E5E5E5"> put</font>

360
00:14:09,710 --> 00:14:14,180
their interface information<font color="#E5E5E5"> in today and</font>

361
00:14:11,120 --> 00:14:16,430
<font color="#E5E5E5">s2 and it helps you figure out</font><font color="#CCCCCC"> if it's a</font>

362
00:14:14,180 --> 00:14:18,500
one gig or 10 gig or an OC 3 or

363
00:14:16,430 --> 00:14:20,689
something hideously smaller hideously

364
00:14:18,500 --> 00:14:23,089
large kind of helps you figure<font color="#E5E5E5"> out</font>

365
00:14:20,690 --> 00:14:24,620
what's going<font color="#CCCCCC"> on</font><font color="#E5E5E5"> with the</font><font color="#CCCCCC"> network you</font>

366
00:14:23,089 --> 00:14:26,000
should be<font color="#CCCCCC"> careful to make sure that the</font>

367
00:14:24,620 --> 00:14:27,650
network you're looking at actually keeps

368
00:14:26,000 --> 00:14:29,780
their dns<font color="#E5E5E5"> up-to-date there's a lot</font><font color="#CCCCCC"> of</font>

369
00:14:27,650 --> 00:14:32,390
<font color="#E5E5E5">people that set their dns manually once</font>

370
00:14:29,780 --> 00:14:34,010
and then they go<font color="#CCCCCC"> reuse the IP four years</font>

371
00:14:32,390 --> 00:14:36,100
later<font color="#E5E5E5"> and don't update it and so it's</font>

372
00:14:34,010 --> 00:14:38,450
still point<font color="#CCCCCC"> needs something wildly bogus</font>

373
00:14:36,100 --> 00:14:40,370
most large networks actually use

374
00:14:38,450 --> 00:14:42,980
automated systems to generate their dns

375
00:14:40,370 --> 00:14:43,440
updates certainly we do certainly<font color="#E5E5E5"> most</font>

376
00:14:42,980 --> 00:14:45,540
other

377
00:14:43,440 --> 00:14:46,470
networks do and it's just it's easier

378
00:14:45,540 --> 00:14:48,599
<font color="#CCCCCC">for everyone if you're managing</font>

379
00:14:46,470 --> 00:14:50,910
<font color="#E5E5E5">thousands of interfaces to keep that</font>

380
00:14:48,600 --> 00:14:54,540
information of the day so here's an

381
00:14:50,910 --> 00:14:56,160
<font color="#CCCCCC">example of how you</font><font color="#E5E5E5"> can look at the</font>

382
00:14:54,540 --> 00:14:57,599
<font color="#CCCCCC">information given in a traceroute and</font>

383
00:14:56,160 --> 00:15:00,120
kind of figure<font color="#CCCCCC"> out</font><font color="#E5E5E5"> something</font><font color="#CCCCCC"> about the</font>

384
00:14:57,600 --> 00:15:04,170
device so this was an example<font color="#E5E5E5"> they came</font>

385
00:15:00,120 --> 00:15:06,320
<font color="#CCCCCC">up on a traceroute XE 11 10 on a device</font>

386
00:15:04,170 --> 00:15:09,900
called edge<font color="#E5E5E5"> one New York one level three</font>

387
00:15:06,320 --> 00:15:12,090
I have a chart on this later but you

388
00:15:09,900 --> 00:15:14,819
<font color="#E5E5E5">know that x e dash number / number /</font>

389
00:15:12,090 --> 00:15:17,100
number is a Juniper format for 10 gig

390
00:15:14,820 --> 00:15:19,010
you know<font color="#E5E5E5"> that the device has at least 12</font>

391
00:15:17,100 --> 00:15:21,810
slots because we're already on slot 11

392
00:15:19,010 --> 00:15:24,960
you know that it's at least a 40 gig per

393
00:15:21,810 --> 00:15:28,589
slot router because you're into more

394
00:15:24,960 --> 00:15:30,300
than one<font color="#CCCCCC"> pic in</font><font color="#E5E5E5"> the slot so you know at</font>

395
00:15:28,590 --> 00:15:31,560
this point that<font color="#E5E5E5"> it's a Juniper remix 960</font>

396
00:15:30,300 --> 00:15:33,390
because there's no other<font color="#E5E5E5"> device out</font>

397
00:15:31,560 --> 00:15:35,369
there they could fit this profile and so

398
00:15:33,390 --> 00:15:36,689
if<font color="#E5E5E5"> you have an idea of what part where</font>

399
00:15:35,370 --> 00:15:39,120
people are<font color="#E5E5E5"> running it really helps you</font>

400
00:15:36,690 --> 00:15:41,220
figure out architectural<font color="#CCCCCC"> e what's going</font>

401
00:15:39,120 --> 00:15:43,770
on how to how to troubleshoot stuff so

402
00:15:41,220 --> 00:15:45,710
it's good<font color="#CCCCCC"> to know those things here's a</font>

403
00:15:43,770 --> 00:15:48,090
full breakdown of the naming conventions

404
00:15:45,710 --> 00:15:51,750
everything from your fast e or gig e or

405
00:15:48,090 --> 00:15:58,110
10 gig and how it<font color="#CCCCCC"> looks in cisco iOS XR</font>

406
00:15:51,750 --> 00:16:00,300
and juniper so the next<font color="#CCCCCC"> thing you want</font>

407
00:15:58,110 --> 00:16:03,210
to<font color="#E5E5E5"> know when looking at dns is what is</font>

408
00:16:00,300 --> 00:16:06,630
the role of the router really why this

409
00:16:03,210 --> 00:16:08,070
matters is you can<font color="#E5E5E5"> figure out</font><font color="#CCCCCC"> it's a</font>

410
00:16:06,630 --> 00:16:09,660
core device you can figure<font color="#E5E5E5"> out if it's</font>

411
00:16:08,070 --> 00:16:11,580
an edge device<font color="#CCCCCC"> appearing router and</font>

412
00:16:09,660 --> 00:16:12,990
that'll kind of help you<font color="#E5E5E5"> figure out</font>

413
00:16:11,580 --> 00:16:15,720
number one it'll help you figure out

414
00:16:12,990 --> 00:16:17,490
where the network boundary itself is so

415
00:16:15,720 --> 00:16:18,720
as you you find that boundary that will

416
00:16:17,490 --> 00:16:20,730
become<font color="#E5E5E5"> more useful and troubleshooting</font>

417
00:16:18,720 --> 00:16:22,380
later but number two it'll help you just

418
00:16:20,730 --> 00:16:23,700
in general figure out what's going<font color="#CCCCCC"> on</font>

419
00:16:22,380 --> 00:16:26,189
<font color="#E5E5E5">with this traceroute and who do you</font>

420
00:16:23,700 --> 00:16:27,990
contact when there's a problem so some

421
00:16:26,190 --> 00:16:30,180
of the common identifiers that you'll

422
00:16:27,990 --> 00:16:33,180
see core routers will be called see our

423
00:16:30,180 --> 00:16:35,400
core gigabit backbone router backbone

424
00:16:33,180 --> 00:16:37,229
router converge core router<font color="#E5E5E5"> ethernet</font>

425
00:16:35,400 --> 00:16:39,360
backbone router that one's slightly

426
00:16:37,230 --> 00:16:42,150
confusing because it looks<font color="#E5E5E5"> like it might</font>

427
00:16:39,360 --> 00:16:43,980
be<font color="#CCCCCC"> an edge router but it's not you look</font>

428
00:16:42,150 --> 00:16:45,810
for your puring routers which are<font color="#E5E5E5"> all</font>

429
00:16:43,980 --> 00:16:47,700
often<font color="#CCCCCC"> called your borders your edge here</font>

430
00:16:45,810 --> 00:16:50,010
your internet<font color="#CCCCCC"> routers your gateway</font>

431
00:16:47,700 --> 00:16:52,230
routers are not necessarily gateway

432
00:16:50,010 --> 00:16:53,750
routers but your peer devices and then

433
00:16:52,230 --> 00:16:56,300
typically your customer device

434
00:16:53,750 --> 00:16:59,020
is tend to be called things like<font color="#E5E5E5"> AR</font>

435
00:16:56,300 --> 00:17:01,699
zagar's cust customer access router

436
00:16:59,020 --> 00:17:03,710
high-speed access or just<font color="#E5E5E5"> gateway</font>

437
00:17:01,700 --> 00:17:08,870
anything that says gateway is typically

438
00:17:03,710 --> 00:17:11,030
a customer<font color="#CCCCCC"> DMark point and then the next</font>

439
00:17:08,869 --> 00:17:13,369
<font color="#E5E5E5">thing that you can identify from</font><font color="#CCCCCC"> DNS is</font>

440
00:17:11,030 --> 00:17:15,050
<font color="#E5E5E5">network boundaries so network boundaries</font>

441
00:17:13,369 --> 00:17:17,119
are especially important to<font color="#E5E5E5"> identify</font>

442
00:17:15,050 --> 00:17:21,319
<font color="#E5E5E5">because they let you figure out where</font>

443
00:17:17,119 --> 00:17:23,448
policy<font color="#E5E5E5"> changes occur so for example once</font>

444
00:17:21,319 --> 00:17:25,639
it crosses this boundary<font color="#E5E5E5"> from my network</font>

445
00:17:23,449 --> 00:17:27,530
to your network your policies probably

446
00:17:25,640 --> 00:17:28,880
change because you<font color="#E5E5E5"> paid different</font>

447
00:17:27,530 --> 00:17:30,379
amounts of different carriers and have

448
00:17:28,880 --> 00:17:32,600
different local prep settings and so

449
00:17:30,380 --> 00:17:34,790
you're very<font color="#E5E5E5"> likely once that packet</font>

450
00:17:32,600 --> 00:17:37,399
crosses that border to have a different

451
00:17:34,790 --> 00:17:39,680
reverse path for example so identifying

452
00:17:37,400 --> 00:17:41,690
<font color="#E5E5E5">network boundaries is important for that</font>

453
00:17:39,680 --> 00:17:44,180
reason it<font color="#E5E5E5"> also tends to be the area</font>

454
00:17:41,690 --> 00:17:46,760
where things go wrong it's a lot<font color="#CCCCCC"> easier</font>

455
00:17:44,180 --> 00:17:48,410
for<font color="#CCCCCC"> me to have capacity to myself than</font>

456
00:17:46,760 --> 00:17:50,030
it is for me to<font color="#E5E5E5"> call up a third party</font>

457
00:17:48,410 --> 00:17:52,340
<font color="#E5E5E5">and negotiate capacity in order cross</font>

458
00:17:50,030 --> 00:17:54,139
connects and<font color="#E5E5E5"> do all</font><font color="#CCCCCC"> that so typically</font>

459
00:17:52,340 --> 00:17:57,139
the choke points tend to be those those

460
00:17:54,140 --> 00:17:59,150
<font color="#E5E5E5">d marks or third parties and the type of</font>

461
00:17:57,140 --> 00:18:00,680
relationship you're looking for it's

462
00:17:59,150 --> 00:18:04,730
typically either<font color="#E5E5E5"> going to be a transit</font>

463
00:18:00,680 --> 00:18:06,530
<font color="#CCCCCC">ap or customer and most networks are</font>

464
00:18:04,730 --> 00:18:08,390
nice enough to<font color="#E5E5E5"> try and put something in</font>

465
00:18:06,530 --> 00:18:11,990
there<font color="#CCCCCC"> to indicate that it's a customer d</font>

466
00:18:08,390 --> 00:18:14,390
<font color="#CCCCCC">mark so that you know what's</font><font color="#E5E5E5"> going on so</font>

467
00:18:11,990 --> 00:18:16,790
<font color="#CCCCCC">in this example it's really easy to spot</font>

468
00:18:14,390 --> 00:18:18,650
where the DNS changes your first hop

469
00:18:16,790 --> 00:18:21,920
says<font color="#E5E5E5"> global crossing these are your old</font>

470
00:18:18,650 --> 00:18:23,630
slides your second hop says sprint and

471
00:18:21,920 --> 00:18:25,970
so it's<font color="#E5E5E5"> pretty obvious that</font><font color="#CCCCCC"> this is the</font>

472
00:18:23,630 --> 00:18:28,820
the DMark point the other thing you<font color="#E5E5E5"> can</font>

473
00:18:25,970 --> 00:18:31,400
look for<font color="#CCCCCC"> is when the remote party is in</font>

474
00:18:28,820 --> 00:18:33,919
the name so for example in the<font color="#CCCCCC"> next</font>

475
00:18:31,400 --> 00:18:36,680
<font color="#E5E5E5">example hop for is a global crossing</font>

476
00:18:33,920 --> 00:18:38,810
router and hop five hey look it's<font color="#CCCCCC"> the</font>

477
00:18:36,680 --> 00:18:42,500
same router but this one says cogent on

478
00:18:38,810 --> 00:18:44,870
it so typically what that means is the /

479
00:18:42,500 --> 00:18:46,490
30 was allocated out of one party's IP

480
00:18:44,870 --> 00:18:48,939
space so for example Global Crossing

481
00:18:46,490 --> 00:18:51,320
gave the the / 32 this interface and

482
00:18:48,940 --> 00:18:54,080
didn't<font color="#E5E5E5"> bother to contact cogent and say</font>

483
00:18:51,320 --> 00:18:56,810
give<font color="#CCCCCC"> us dns information for your side so</font>

484
00:18:54,080 --> 00:18:59,090
they just<font color="#E5E5E5"> put in cogent dot and then the</font>

485
00:18:56,810 --> 00:19:00,740
<font color="#CCCCCC">the same device on the other side so</font>

486
00:18:59,090 --> 00:19:03,379
that's really how<font color="#E5E5E5"> you can figure out</font>

487
00:19:00,740 --> 00:19:05,270
that type of thing and then the easy way

488
00:19:03,380 --> 00:19:07,910
<font color="#E5E5E5">to verify that is just to look for the</font>

489
00:19:05,270 --> 00:19:10,160
<font color="#E5E5E5">DNS on the other side of that / 30 so</font>

490
00:19:07,910 --> 00:19:12,800
you see dot<font color="#CCCCCC"> 90 is is this cogent IP</font>

491
00:19:10,160 --> 00:19:15,230
address so let's<font color="#E5E5E5"> look at 89 the other</font>

492
00:19:12,800 --> 00:19:17,090
side of the<font color="#CCCCCC"> / 30 and you can see</font><font color="#E5E5E5"> the</font>

493
00:19:15,230 --> 00:19:19,550
interface and the device<font color="#CCCCCC"> that it lands</font>

494
00:19:17,090 --> 00:19:21,110
on so now you have<font color="#E5E5E5"> an idea if this</font>

495
00:19:19,550 --> 00:19:23,090
traffic is staying on<font color="#E5E5E5"> this device if</font>

496
00:19:21,110 --> 00:19:27,110
it's not help you on troubleshooting

497
00:19:23,090 --> 00:19:28,879
later next big thing you need<font color="#CCCCCC"> to</font>

498
00:19:27,110 --> 00:19:33,620
identify and trace route is the latency

499
00:19:28,880 --> 00:19:35,180
that<font color="#E5E5E5"> it reports so to understand the</font>

500
00:19:33,620 --> 00:19:36,800
network latency there's really<font color="#E5E5E5"> three</font>

501
00:19:35,180 --> 00:19:39,260
primary causes of network induced

502
00:19:36,800 --> 00:19:41,600
latency that<font color="#CCCCCC"> we care about the first</font><font color="#E5E5E5"> one</font>

503
00:19:39,260 --> 00:19:43,730
is serialization<font color="#CCCCCC"> delay that's</font><font color="#E5E5E5"> basically</font>

504
00:19:41,600 --> 00:19:46,159
the delay that occurs when you<font color="#E5E5E5"> are</font>

505
00:19:43,730 --> 00:19:47,990
encoding the data from packet form into

506
00:19:46,160 --> 00:19:51,260
a string of bits I'm putting it on the

507
00:19:47,990 --> 00:19:52,700
<font color="#E5E5E5">wire there is queuing delay which is the</font>

508
00:19:51,260 --> 00:19:54,590
delay that happens when the router

509
00:19:52,700 --> 00:19:55,850
switch is holding<font color="#E5E5E5"> on to the packet not</font>

510
00:19:54,590 --> 00:19:58,010
transmitting it waiting for an

511
00:19:55,850 --> 00:20:00,800
opportunity<font color="#E5E5E5"> to do so and then there's</font>

512
00:19:58,010 --> 00:20:02,810
propagation delay which is just how long

513
00:20:00,800 --> 00:20:05,030
it takes the electromagnetic signal to

514
00:20:02,810 --> 00:20:09,950
transfer<font color="#E5E5E5"> over the wire or fiber or</font>

515
00:20:05,030 --> 00:20:11,899
whatever the the<font color="#E5E5E5"> media is so a</font>

516
00:20:09,950 --> 00:20:13,820
serialization die in networking

517
00:20:11,900 --> 00:20:15,890
serialization just means the process of

518
00:20:13,820 --> 00:20:19,639
encoding the chunks of data onto the

519
00:20:15,890 --> 00:20:20,930
wire the faster interface is the<font color="#E5E5E5"> faster</font>

520
00:20:19,640 --> 00:20:23,330
this will occur and it's completely

521
00:20:20,930 --> 00:20:25,040
linear so the math is very<font color="#E5E5E5"> simple you</font>

522
00:20:23,330 --> 00:20:27,830
just take the packet size and divide<font color="#CCCCCC"> it</font>

523
00:20:25,040 --> 00:20:30,100
by the link speed so for example a 1500

524
00:20:27,830 --> 00:20:32,210
byte packet sent over a<font color="#CCCCCC"> 1 megabit link</font>

525
00:20:30,100 --> 00:20:34,520
your first<font color="#E5E5E5"> step would be to convert</font><font color="#CCCCCC"> the</font>

526
00:20:32,210 --> 00:20:36,980
units so<font color="#CCCCCC"> 1 megabit is a thousand</font>

527
00:20:34,520 --> 00:20:39,470
kilobits per second which is 125

528
00:20:36,980 --> 00:20:42,470
kilobytes per second divided by 8 which

529
00:20:39,470 --> 00:20:44,300
is<font color="#CCCCCC"> just written out 125,000 bytes per</font>

530
00:20:42,470 --> 00:20:47,060
second and then you can take your bites

531
00:20:44,300 --> 00:20:49,280
/ bytes per second and figure<font color="#CCCCCC"> out that</font>

532
00:20:47,060 --> 00:20:52,669
it will take 12 milliseconds for this

533
00:20:49,280 --> 00:20:55,280
1500 byte packet to serialize over the

534
00:20:52,670 --> 00:20:58,160
interface so why<font color="#E5E5E5"> does this actually</font>

535
00:20:55,280 --> 00:20:59,540
cause a delay remember the packets move

536
00:20:58,160 --> 00:21:01,940
through the network as an atomic unit

537
00:20:59,540 --> 00:21:03,200
you can't transmit the first half<font color="#E5E5E5"> of the</font>

538
00:21:01,940 --> 00:21:05,930
packet now and come back to the rest

539
00:21:03,200 --> 00:21:07,220
<font color="#E5E5E5">later you generally can't start</font>

540
00:21:05,930 --> 00:21:08,600
transmitting the packet until<font color="#E5E5E5"> you</font>

541
00:21:07,220 --> 00:21:11,360
<font color="#CCCCCC">finished receiving it that's true of</font>

542
00:21:08,600 --> 00:21:12,830
most routers there are some switches

543
00:21:11,360 --> 00:21:13,939
some low latency switches they use

544
00:21:12,830 --> 00:21:16,189
what's called a<font color="#E5E5E5"> cut through architecture</font>

545
00:21:13,940 --> 00:21:17,020
<font color="#E5E5E5">so after they get the first 64 bytes</font>

546
00:21:16,190 --> 00:21:19,720
they start<font color="#E5E5E5"> for</font>

547
00:21:17,020 --> 00:21:22,990
running the the packet but those tend to

548
00:21:19,720 --> 00:21:25,300
be specialized you tend<font color="#E5E5E5"> to</font><font color="#CCCCCC"> lose features</font>

549
00:21:22,990 --> 00:21:26,650
when you start to do that and it's it's

550
00:21:25,300 --> 00:21:28,659
<font color="#E5E5E5">the kind of thing that you'll only find</font>

551
00:21:26,650 --> 00:21:30,160
them like specialized low latency

552
00:21:28,660 --> 00:21:33,100
switches you generally<font color="#CCCCCC"> don't find that</font>

553
00:21:30,160 --> 00:21:34,690
in routers so you because you can't

554
00:21:33,100 --> 00:21:36,219
start transmitting until you finish

555
00:21:34,690 --> 00:21:37,690
receiving the packet if it takes 12

556
00:21:36,220 --> 00:21:40,180
milliseconds to<font color="#E5E5E5"> go across the wire</font>

557
00:21:37,690 --> 00:21:41,590
that's 12 milliseconds that you've added

558
00:21:40,180 --> 00:21:43,510
<font color="#E5E5E5">to the total latency of this</font>

559
00:21:41,590 --> 00:21:45,699
<font color="#CCCCCC">conversation every time you touch a</font>

560
00:21:43,510 --> 00:21:49,720
packet aware device every time you touch

561
00:21:45,700 --> 00:21:51,640
a router or switch so fortunately this

562
00:21:49,720 --> 00:21:52,990
is a lot less of<font color="#E5E5E5"> an issue than it used</font>

563
00:21:51,640 --> 00:21:55,300
to be on modern<font color="#E5E5E5"> high-speed networks</font>

564
00:21:52,990 --> 00:21:57,070
reason for that is interface beads have

565
00:21:55,300 --> 00:21:59,350
gone up many orders of<font color="#E5E5E5"> magnitudes over</font>

566
00:21:57,070 --> 00:22:00,970
the many years that the<font color="#CCCCCC"> Internet has</font>

567
00:21:59,350 --> 00:22:02,949
<font color="#CCCCCC">been around but packet sizes have pretty</font>

568
00:22:00,970 --> 00:22:06,520
<font color="#CCCCCC">much stayed the same so it's</font><font color="#E5E5E5"> getting</font>

569
00:22:02,950 --> 00:22:08,350
less and less of a problem but if you've

570
00:22:06,520 --> 00:22:10,240
got a low speed link this can still be a

571
00:22:08,350 --> 00:22:12,040
very noticeable cause of latency so

572
00:22:10,240 --> 00:22:13,930
probably<font color="#E5E5E5"> not an issue on your 10 gig</font>

573
00:22:12,040 --> 00:22:15,820
link where it calls as point 0 0 1 2

574
00:22:13,930 --> 00:22:19,720
milliseconds of latency but it might<font color="#E5E5E5"> be</font>

575
00:22:15,820 --> 00:22:21,840
an issue on your 768k<font color="#E5E5E5"> dsl line where</font><font color="#CCCCCC"> you</font>

576
00:22:19,720 --> 00:22:24,430
just cause 15<font color="#E5E5E5"> 16 milliseconds of latency</font>

577
00:22:21,840 --> 00:22:27,100
just to pass the packet across<font color="#E5E5E5"> because</font>

578
00:22:24,430 --> 00:22:29,140
it is a packet and interestingly<font color="#E5E5E5"> it also</font>

579
00:22:27,100 --> 00:22:32,110
makes a good counter argument to a lot

580
00:22:29,140 --> 00:22:34,750
<font color="#CCCCCC">of the kind</font><font color="#E5E5E5"> of popular we should deploy</font>

581
00:22:32,110 --> 00:22:36,490
jumbo frames everywhere arguments out

582
00:22:34,750 --> 00:22:38,650
there because when you do that you

583
00:22:36,490 --> 00:22:40,630
actually increase the<font color="#CCCCCC"> latency you</font>

584
00:22:38,650 --> 00:22:42,160
increase the amount of contention<font color="#E5E5E5"> on the</font>

585
00:22:40,630 --> 00:22:43,390
link and<font color="#E5E5E5"> you potentially increase</font>

586
00:22:42,160 --> 00:22:48,190
jitters late we'll talk about that later

587
00:22:43,390 --> 00:22:51,040
<font color="#E5E5E5">on so queuing delay the the next cause</font>

588
00:22:48,190 --> 00:22:52,930
of network latency<font color="#E5E5E5"> queuing is like I</font>

589
00:22:51,040 --> 00:22:54,670
said when the router switch is holding

590
00:22:52,930 --> 00:22:56,290
the packet in memory waiting for an

591
00:22:54,670 --> 00:22:58,390
opportunity to transmit it but not

592
00:22:56,290 --> 00:22:59,950
<font color="#CCCCCC">actually doing</font><font color="#E5E5E5"> so in</font><font color="#CCCCCC"> every moment</font><font color="#E5E5E5"> that</font>

593
00:22:58,390 --> 00:23:01,540
the router holds the packet and its

594
00:22:59,950 --> 00:23:03,430
memory not doing anything with it your

595
00:23:01,540 --> 00:23:06,280
latency is going up and your user

596
00:23:03,430 --> 00:23:07,480
experience is probably going down so why

597
00:23:06,280 --> 00:23:10,810
do<font color="#E5E5E5"> we need queuing in the first place</font>

598
00:23:07,480 --> 00:23:13,480
well first we need<font color="#E5E5E5"> to understand how</font>

599
00:23:10,810 --> 00:23:15,820
link utilization actually works so

600
00:23:13,480 --> 00:23:17,590
typically when<font color="#E5E5E5"> someone says I've</font><font color="#CCCCCC"> got a</font>

601
00:23:15,820 --> 00:23:19,480
10 gig port and I'm<font color="#E5E5E5"> doing five gigs over</font>

602
00:23:17,590 --> 00:23:22,030
it they might say that's fifty percent

603
00:23:19,480 --> 00:23:23,950
utilized that's<font color="#E5E5E5"> actually not true at any</font>

604
00:23:22,030 --> 00:23:25,210
<font color="#E5E5E5">given moment the interface can only be</font>

605
00:23:23,950 --> 00:23:26,620
in one of two states<font color="#E5E5E5"> it can either be</font>

606
00:23:25,210 --> 00:23:27,790
transmitting in which case<font color="#E5E5E5"> it's one</font>

607
00:23:26,620 --> 00:23:28,120
<font color="#CCCCCC">hundred percent utilized and you can't</font>

608
00:23:27,790 --> 00:23:30,550
do any

609
00:23:28,120 --> 00:23:32,530
with it or<font color="#E5E5E5"> it's not transmitting and</font>

610
00:23:30,550 --> 00:23:34,060
it's 0% utilized so what you're actually

611
00:23:32,530 --> 00:23:36,670
saying when you say fifty percent

612
00:23:34,060 --> 00:23:39,970
utilized is<font color="#E5E5E5"> fifty percent as measured</font>

613
00:23:36,670 --> 00:23:41,920
over one second so you pretty much need

614
00:23:39,970 --> 00:23:43,990
some<font color="#CCCCCC"> queuing for interfaces to function</font>

615
00:23:41,920 --> 00:23:46,180
and if you ever<font color="#E5E5E5"> doubt that</font><font color="#CCCCCC"> ask</font><font color="#E5E5E5"> anyone</font>

616
00:23:43,990 --> 00:23:48,010
who's ever bought a top of<font color="#CCCCCC"> rack switch</font>

617
00:23:46,180 --> 00:23:49,810
that<font color="#CCCCCC"> doesn't have enough packet buffers</font>

618
00:23:48,010 --> 00:23:52,720
and tried to get line right performance

619
00:23:49,810 --> 00:23:55,629
out of it so when it's<font color="#E5E5E5"> queuing a good</font>

620
00:23:52,720 --> 00:23:57,780
thing you need<font color="#E5E5E5"> queuing especially when</font>

621
00:23:55,630 --> 00:23:59,980
you have mismatched interface speeds

622
00:23:57,780 --> 00:24:01,330
especially if you've got a higher speed

623
00:23:59,980 --> 00:24:03,550
interface sending to a lower speed

624
00:24:01,330 --> 00:24:05,860
interface so like we talked about under

625
00:24:03,550 --> 00:24:08,230
serialization<font color="#E5E5E5"> the packet comes through</font>

626
00:24:05,860 --> 00:24:10,810
the interface at a certain speed based

627
00:24:08,230 --> 00:24:12,790
on the speed<font color="#E5E5E5"> of the interface so a giggi</font>

628
00:24:10,810 --> 00:24:14,860
link will transmit that packet<font color="#CCCCCC"> ten times</font>

629
00:24:12,790 --> 00:24:18,010
faster it will it will get through the

630
00:24:14,860 --> 00:24:20,800
interface ten times faster<font color="#CCCCCC"> than a fast</font>

631
00:24:18,010 --> 00:24:22,629
evil so if you've<font color="#CCCCCC"> got a bunch of Giggy</font>

632
00:24:20,800 --> 00:24:24,520
ports feeding a bunch of fasting ports

633
00:24:22,630 --> 00:24:26,290
even if you're in no way maxing out the

634
00:24:24,520 --> 00:24:28,540
utilization you're going to have these

635
00:24:26,290 --> 00:24:30,190
packets come in a millisecond before

636
00:24:28,540 --> 00:24:32,830
they're ready to<font color="#E5E5E5"> go out you're going to</font>

637
00:24:30,190 --> 00:24:34,240
need buffering the other<font color="#E5E5E5"> area that you</font>

638
00:24:32,830 --> 00:24:35,919
you tend to<font color="#E5E5E5"> need buffering is when</font>

639
00:24:34,240 --> 00:24:37,360
you've<font color="#E5E5E5"> got a lot of talkers so for</font>

640
00:24:35,920 --> 00:24:40,030
<font color="#E5E5E5">example if you've got a top of rack</font>

641
00:24:37,360 --> 00:24:41,800
switch with 41 gig ports going down to

642
00:24:40,030 --> 00:24:44,530
servers and they're all feeding into a

643
00:24:41,800 --> 00:24:46,659
couple<font color="#CCCCCC"> of uplink ports you have a large</font>

644
00:24:44,530 --> 00:24:48,370
number of talkers feeding into a smaller

645
00:24:46,660 --> 00:24:51,610
number of<font color="#E5E5E5"> ports and it may not even</font>

646
00:24:48,370 --> 00:24:53,080
matter that the<font color="#CCCCCC"> interfaces is faster you</font>

647
00:24:51,610 --> 00:24:54,639
still got all these packets coming

648
00:24:53,080 --> 00:24:56,020
together at once so you've got these

649
00:24:54,640 --> 00:24:58,420
little micro bursts<font color="#CCCCCC"> then you need to</font>

650
00:24:56,020 --> 00:25:00,490
queue for so technically speaking

651
00:24:58,420 --> 00:25:02,080
<font color="#CCCCCC">queuing always increases throughput and</font>

652
00:25:00,490 --> 00:25:04,210
if you<font color="#CCCCCC"> think about</font><font color="#E5E5E5"> this logically the</font>

653
00:25:02,080 --> 00:25:07,240
longer you hold<font color="#CCCCCC"> onto the packet the more</font>

654
00:25:04,210 --> 00:25:10,230
opportunity you have to find a slot to

655
00:25:07,240 --> 00:25:12,940
transmit it when the router<font color="#E5E5E5"> is not used</font>

656
00:25:10,230 --> 00:25:15,370
so then the question becomes how long

657
00:25:12,940 --> 00:25:17,680
should you hold on to<font color="#CCCCCC"> it and what's the</font>

658
00:25:15,370 --> 00:25:19,360
value there so typically<font color="#E5E5E5"> you might see</font>

659
00:25:17,680 --> 00:25:21,010
something like<font color="#E5E5E5"> if you are</font><font color="#CCCCCC"> willing to</font>

660
00:25:19,360 --> 00:25:23,709
buffer the packet for an extra<font color="#E5E5E5"> five</font>

661
00:25:21,010 --> 00:25:25,960
milliseconds you could get<font color="#CCCCCC"> a link</font>

662
00:25:23,710 --> 00:25:27,820
utilization up from sixty percent to say

663
00:25:25,960 --> 00:25:30,060
eighty-five percent before you start

664
00:25:27,820 --> 00:25:34,060
seeing drops that's<font color="#E5E5E5"> probably worth doing</font>

665
00:25:30,060 --> 00:25:36,909
but it depends<font color="#E5E5E5"> on your application so</font>

666
00:25:34,060 --> 00:25:39,220
what<font color="#E5E5E5"> is queuing bad well as an interface</font>

667
00:25:36,910 --> 00:25:40,490
becomes more and more full the amount<font color="#E5E5E5"> of</font>

668
00:25:39,220 --> 00:25:42,380
time that you

669
00:25:40,490 --> 00:25:44,440
hold on to the packet<font color="#CCCCCC"> find an open slot</font>

670
00:25:42,380 --> 00:25:47,600
to transmit it increases exponentially

671
00:25:44,440 --> 00:25:49,160
so you might still<font color="#E5E5E5"> be</font><font color="#CCCCCC"> able</font><font color="#E5E5E5"> to</font>

672
00:25:47,600 --> 00:25:50,809
successfully deliver every packet you

673
00:25:49,160 --> 00:25:52,820
might be able to<font color="#E5E5E5"> get a full 10 gigabits</font>

674
00:25:50,809 --> 00:25:54,290
across this 10 gige link but you might

675
00:25:52,820 --> 00:25:55,820
have to hold every packet in the buffer

676
00:25:54,290 --> 00:25:57,590
for five thousand milliseconds to do it

677
00:25:55,820 --> 00:25:59,389
it's<font color="#E5E5E5"> probably not a good</font><font color="#CCCCCC"> thing for</font><font color="#E5E5E5"> your</font>

678
00:25:57,590 --> 00:26:02,209
end user not for<font color="#E5E5E5"> anyone who's watching</font>

679
00:25:59,390 --> 00:26:03,980
video or voice or SSH or anything

680
00:26:02,210 --> 00:26:06,260
interactive and<font color="#E5E5E5"> it's really going to</font>

681
00:26:03,980 --> 00:26:08,210
interfere with TCP performance too so at

682
00:26:06,260 --> 00:26:10,340
a certain point queuing actually becomes

683
00:26:08,210 --> 00:26:12,950
counterproductive the question is<font color="#E5E5E5"> what</font>

684
00:26:10,340 --> 00:26:15,439
is that point and how do<font color="#E5E5E5"> you</font><font color="#CCCCCC"> know how to</font>

685
00:26:12,950 --> 00:26:17,270
configure it<font color="#E5E5E5"> cuz like i said if you if</font>

686
00:26:15,440 --> 00:26:18,890
you get an extra one percent throughput

687
00:26:17,270 --> 00:26:20,270
but you have to screw up the latency on

688
00:26:18,890 --> 00:26:23,210
all of your traffic to do it it's

689
00:26:20,270 --> 00:26:24,860
probably<font color="#CCCCCC"> a bad thing typically what most</font>

690
00:26:23,210 --> 00:26:27,350
people see with normal internet internet

691
00:26:24,860 --> 00:26:30,110
mixed traffic is once you get above

692
00:26:27,350 --> 00:26:32,030
about ninety-five percent utilization as

693
00:26:30,110 --> 00:26:34,370
measured over 1 to 2<font color="#E5E5E5"> seconds you're</font>

694
00:26:32,030 --> 00:26:35,990
going<font color="#E5E5E5"> to start to see almost all of your</font>

695
00:26:34,370 --> 00:26:38,270
<font color="#E5E5E5">packets noticeably affected with</font>

696
00:26:35,990 --> 00:26:41,179
significant latency so you really want

697
00:26:38,270 --> 00:26:42,889
<font color="#E5E5E5">to keep it ideally below 90 but the</font>

698
00:26:41,179 --> 00:26:44,630
lower the better if you keep a link it

699
00:26:42,890 --> 00:26:46,880
below fifty percent you'll see perfect

700
00:26:44,630 --> 00:26:49,220
no jitter no nothing and everyone will

701
00:26:46,880 --> 00:26:50,750
have a<font color="#E5E5E5"> good time and it turns out that</font>

702
00:26:49,220 --> 00:26:53,290
most routers actually have really bad

703
00:26:50,750 --> 00:26:56,770
defaults for their interface<font color="#E5E5E5"> cues to</font>

704
00:26:53,290 --> 00:26:59,540
there's a lot of kind of overreaction to

705
00:26:56,770 --> 00:27:02,360
things like oh we shouldn't ever drop a

706
00:26:59,540 --> 00:27:04,220
packet or oh I heard that<font color="#E5E5E5"> this carrier</font>

707
00:27:02,360 --> 00:27:05,870
<font color="#E5E5E5">grade router and needed bigger buffers</font>

708
00:27:04,220 --> 00:27:07,610
and I paid a<font color="#CCCCCC"> lot for it so i should have</font>

709
00:27:05,870 --> 00:27:09,649
really big buffers and so sometimes

710
00:27:07,610 --> 00:27:12,590
people ship routers with buffers<font color="#CCCCCC"> that'll</font>

711
00:27:09,650 --> 00:27:15,230
hold packet for<font color="#E5E5E5"> 5 to</font><font color="#CCCCCC"> 10 seconds not</font>

712
00:27:12,590 --> 00:27:16,790
milliseconds while it's looking for a

713
00:27:15,230 --> 00:27:19,610
slot that's that's just too much that's

714
00:27:16,790 --> 00:27:21,409
excessive so there's a lot<font color="#E5E5E5"> of research</font>

715
00:27:19,610 --> 00:27:22,879
that's<font color="#E5E5E5"> going into this right now if you</font>

716
00:27:21,410 --> 00:27:24,440
google for the term buffer bloat you'll

717
00:27:22,880 --> 00:27:26,660
find a lot of further documentation on

718
00:27:24,440 --> 00:27:28,250
this and kind of why you don't want that

719
00:27:26,660 --> 00:27:30,890
but when you're looking<font color="#E5E5E5"> at</font><font color="#CCCCCC"> a traceroute</font>

720
00:27:28,250 --> 00:27:32,450
when you see a<font color="#E5E5E5"> 5,000 millisecond time</font>

721
00:27:30,890 --> 00:27:34,309
you<font color="#E5E5E5"> you kind of know what's going on</font>

722
00:27:32,450 --> 00:27:35,720
it's it's not because there's a<font color="#E5E5E5"> 5,000</font>

723
00:27:34,309 --> 00:27:37,670
millisecond fiber path unless someone

724
00:27:35,720 --> 00:27:39,620
ran fiber to<font color="#CCCCCC"> the moon and back it's</font>

725
00:27:37,670 --> 00:27:43,309
<font color="#E5E5E5">because it's being stuck in an inner</font>

726
00:27:39,620 --> 00:27:45,949
outer queue and then the third cause of

727
00:27:43,309 --> 00:27:48,770
latency is propagation delay which is

728
00:27:45,950 --> 00:27:49,040
simply<font color="#E5E5E5"> time spent on the wire so if you</font>

729
00:27:48,770 --> 00:27:50,120
want

730
00:27:49,040 --> 00:27:51,889
look at the math of<font color="#E5E5E5"> this is really</font>

731
00:27:50,120 --> 00:27:54,290
simple the speed of light<font color="#E5E5E5"> in a vacuum is</font>

732
00:27:51,890 --> 00:27:56,810
roughly 300,000<font color="#E5E5E5"> kilometers per second</font>

733
00:27:54,290 --> 00:27:58,580
and turns out that's not<font color="#E5E5E5"> very fast over</font>

734
00:27:56,810 --> 00:28:01,280
long distances so you start to see

735
00:27:58,580 --> 00:28:03,020
measurable latency if you want to look

736
00:28:01,280 --> 00:28:05,330
<font color="#E5E5E5">at how fast light propagates in fibre</font>

737
00:28:03,020 --> 00:28:07,639
fibers made a glass as a refractive

738
00:28:05,330 --> 00:28:11,780
index of<font color="#E5E5E5"> around point 1 for 8 in the</font>

739
00:28:07,640 --> 00:28:13,520
<font color="#E5E5E5">core so you won / 1.48 you see that</font>

740
00:28:11,780 --> 00:28:16,460
light travels light propagates through

741
00:28:13,520 --> 00:28:18,980
fiber at around two thirds the speed

742
00:28:16,460 --> 00:28:21,350
that it does in a vacuum about 0.67 see

743
00:28:18,980 --> 00:28:24,020
so it's a roughly around 200,000

744
00:28:21,350 --> 00:28:25,909
kilometers per second if<font color="#E5E5E5"> you expand that</font>

745
00:28:24,020 --> 00:28:28,610
out 200,000 kilometers per second equals

746
00:28:25,910 --> 00:28:30,320
200 kilometers per millisecond and then

747
00:28:28,610 --> 00:28:32,810
you would want<font color="#CCCCCC"> to divide that by 2 to</font>

748
00:28:30,320 --> 00:28:35,960
account for round trip time so if you

749
00:28:32,810 --> 00:28:38,510
see a<font color="#E5E5E5"> 1 millisecond in your traceroute</font>

750
00:28:35,960 --> 00:28:40,370
because you're measuring the time there

751
00:28:38,510 --> 00:28:42,470
and the time<font color="#E5E5E5"> back that means there's</font>

752
00:28:40,370 --> 00:28:44,209
roughly 100 kilometers of fiber in<font color="#E5E5E5"> the</font>

753
00:28:42,470 --> 00:28:46,280
way if all you're<font color="#CCCCCC"> looking at is</font>

754
00:28:44,210 --> 00:28:48,050
propagation delays so just as an example

755
00:28:46,280 --> 00:28:50,240
if you were to go all<font color="#CCCCCC"> the way around the</font>

756
00:28:48,050 --> 00:28:52,430
<font color="#E5E5E5">world on the equator come back to where</font>

757
00:28:50,240 --> 00:28:54,650
you started from just from speed of

758
00:28:52,430 --> 00:28:56,600
light delays through fiber it would take

759
00:28:54,650 --> 00:28:59,510
you about 400 milliseconds so that's how

760
00:28:56,600 --> 00:29:02,290
big the world is and certainly you can

761
00:28:59,510 --> 00:29:05,420
have fiber paths that are not straight

762
00:29:02,290 --> 00:29:07,190
so how do you look at<font color="#E5E5E5"> a traceroute and</font>

763
00:29:05,420 --> 00:29:09,770
identify what latency is affecting you

764
00:29:07,190 --> 00:29:11,870
and figure out<font color="#E5E5E5"> if it's normal your first</font>

765
00:29:09,770 --> 00:29:13,520
step is to use location identifiers to

766
00:29:11,870 --> 00:29:15,830
<font color="#CCCCCC">figure out the geographical information</font>

767
00:29:13,520 --> 00:29:18,680
figure<font color="#E5E5E5"> out that kind of fits what</font><font color="#CCCCCC"> your</font>

768
00:29:15,830 --> 00:29:21,470
you're<font color="#E5E5E5"> looking for so for example you</font>

769
00:29:18,680 --> 00:29:24,440
<font color="#CCCCCC">have a packet that's NYC New York and</font>

770
00:29:21,470 --> 00:29:26,600
it's going to lhr that's London and<font color="#CCCCCC"> you</font>

771
00:29:24,440 --> 00:29:29,390
see that it's about<font color="#E5E5E5"> sixty seven point</font>

772
00:29:26,600 --> 00:29:30,949
six milliseconds for 4,200 miles yeah<font color="#E5E5E5"> it</font>

773
00:29:29,390 --> 00:29:33,530
sounds about<font color="#E5E5E5"> right that's actually one</font>

774
00:29:30,950 --> 00:29:35,570
of the better fiber pads you can<font color="#E5E5E5"> get and</font>

775
00:29:33,530 --> 00:29:38,629
then<font color="#E5E5E5"> this other example you see the</font>

776
00:29:35,570 --> 00:29:40,939
latency go up between AT&T and cogent if

777
00:29:38,630 --> 00:29:44,450
you<font color="#E5E5E5"> look at the geographic information</font>

778
00:29:40,940 --> 00:29:47,120
you see 18t<font color="#CCCCCC"> Washington DC and then you</font>

779
00:29:44,450 --> 00:29:49,670
see cogent IED which is also<font color="#CCCCCC"> Washington</font>

780
00:29:47,120 --> 00:29:51,020
DC and you see the latency went up two

781
00:29:49,670 --> 00:29:53,210
hundred<font color="#E5E5E5"> twenty milliseconds that's</font>

782
00:29:51,020 --> 00:29:55,190
probably<font color="#E5E5E5"> not distance related that</font>

783
00:29:53,210 --> 00:29:57,650
shouldn't happen so that's either the

784
00:29:55,190 --> 00:29:59,000
return path or a congested interface but

785
00:29:57,650 --> 00:29:59,309
you<font color="#E5E5E5"> don't know for sure until you look</font>

786
00:29:59,000 --> 00:30:02,610
<font color="#E5E5E5">at more</font>

787
00:29:59,309 --> 00:30:04,559
or data so the other thing that<font color="#E5E5E5"> starts</font>

788
00:30:02,610 --> 00:30:07,258
to affect traceroute is prioritization

789
00:30:04,559 --> 00:30:09,240
to<font color="#E5E5E5"> rate limiting so remember</font><font color="#CCCCCC"> that I said</font>

790
00:30:07,259 --> 00:30:11,549
the traceroute latency is actually the

791
00:30:09,240 --> 00:30:13,169
sum of three things the<font color="#E5E5E5"> time that</font><font color="#CCCCCC"> it</font>

792
00:30:11,549 --> 00:30:15,090
<font color="#E5E5E5">takes for the pro packet to get to the</font>

793
00:30:13,169 --> 00:30:16,620
router that's dropping the packet the

794
00:30:15,090 --> 00:30:18,689
time that it<font color="#E5E5E5"> takes for the router to</font>

795
00:30:16,620 --> 00:30:20,518
drop the packet and send its ICMP and

796
00:30:18,690 --> 00:30:22,710
the time that<font color="#CCCCCC"> it takes that ICMP message</font>

797
00:30:20,519 --> 00:30:24,659
to get back number<font color="#E5E5E5"> one and number three</font>

798
00:30:22,710 --> 00:30:26,820
your actual real<font color="#CCCCCC"> network characteristics</font>

799
00:30:24,659 --> 00:30:28,710
but number two is completely artificial

800
00:30:26,820 --> 00:30:31,678
and only happens on trace route packets

801
00:30:28,710 --> 00:30:33,450
so what happens there is you tend<font color="#CCCCCC"> to</font>

802
00:30:31,679 --> 00:30:37,080
<font color="#E5E5E5">have routers get busy one way or</font><font color="#CCCCCC"> another</font>

803
00:30:33,450 --> 00:30:38,580
and either drop the ICMP generation not

804
00:30:37,080 --> 00:30:40,949
do it at all in which case it looks<font color="#E5E5E5"> like</font>

805
00:30:38,580 --> 00:30:42,360
pack of<font color="#E5E5E5"> Awesome traceroute or take a</font>

806
00:30:40,950 --> 00:30:44,519
little<font color="#E5E5E5"> bit of time to get around to</font>

807
00:30:42,360 --> 00:30:46,408
generating that ICMP message in which

808
00:30:44,519 --> 00:30:48,389
<font color="#E5E5E5">case it looks like high latency but this</font>

809
00:30:46,409 --> 00:30:49,980
is again completely<font color="#E5E5E5"> artificial it</font>

810
00:30:48,389 --> 00:30:54,119
doesn't affect real traffic it only

811
00:30:49,980 --> 00:30:55,769
affects<font color="#CCCCCC"> trace rail traffic to understand</font>

812
00:30:54,119 --> 00:30:57,990
this you have to understand what's

813
00:30:55,769 --> 00:31:00,830
called<font color="#E5E5E5"> to it versus through it so most</font>

814
00:30:57,990 --> 00:31:03,539
routers have<font color="#E5E5E5"> a distinct processing path</font>

815
00:31:00,830 --> 00:31:05,249
what these are<font color="#CCCCCC"> called the data plane is</font>

816
00:31:03,539 --> 00:31:07,470
what you call<font color="#E5E5E5"> for packets forwarding</font>

817
00:31:05,249 --> 00:31:09,210
through the routers and inside the data

818
00:31:07,470 --> 00:31:11,159
plan there's there's two pads actually

819
00:31:09,210 --> 00:31:12,960
there's<font color="#E5E5E5"> the fast path which is what the</font>

820
00:31:11,159 --> 00:31:15,960
vast<font color="#E5E5E5"> vast majority of your regular</font>

821
00:31:12,960 --> 00:31:19,350
ordinary everyday internet porn goes

822
00:31:15,960 --> 00:31:20,940
through that's just forwarding through

823
00:31:19,350 --> 00:31:22,139
an ASIC that is very<font color="#E5E5E5"> good at doing</font>

824
00:31:20,940 --> 00:31:24,539
hundreds of millions of packets per

825
00:31:22,139 --> 00:31:26,428
second and then there's the slow path

826
00:31:24,539 --> 00:31:29,820
and that handles anything that is an

827
00:31:26,429 --> 00:31:31,710
exception common examples of that are if

828
00:31:29,820 --> 00:31:33,418
there's an IP option configured that

829
00:31:31,710 --> 00:31:35,850
needs to get handled separately if you

830
00:31:33,419 --> 00:31:38,039
need to do ICMP generation which is what

831
00:31:35,850 --> 00:31:39,719
tre sorelle falls into if you have

832
00:31:38,039 --> 00:31:41,309
configured logging if<font color="#CCCCCC"> you configured</font>

833
00:31:39,720 --> 00:31:43,019
sampling if you've done anything on<font color="#E5E5E5"> your</font>

834
00:31:41,309 --> 00:31:46,740
router that<font color="#E5E5E5"> requires special processing</font>

835
00:31:43,019 --> 00:31:49,350
it has to punt it to<font color="#CCCCCC"> the slow path and</font>

836
00:31:46,740 --> 00:31:51,269
then the control plane is traffic that's

837
00:31:49,350 --> 00:31:53,340
actually being forward forwarded to the

838
00:31:51,269 --> 00:31:54,990
router this is completely<font color="#CCCCCC"> different than</font>

839
00:31:53,340 --> 00:31:56,309
traffic<font color="#CCCCCC"> that goes through it so some</font>

840
00:31:54,990 --> 00:31:58,769
example of that are your routing

841
00:31:56,309 --> 00:32:02,249
protocols your<font color="#E5E5E5"> BGP or is is your SPF</font>

842
00:31:58,769 --> 00:32:04,139
your SNMP your CLI when you telnet

843
00:32:02,249 --> 00:32:06,119
necessary to the box when you ping the

844
00:32:04,139 --> 00:32:08,530
box itself when you ping from the box

845
00:32:06,119 --> 00:32:10,689
when you ping to it

846
00:32:08,530 --> 00:32:11,830
anything that goes to an IP address<font color="#E5E5E5"> that</font>

847
00:32:10,690 --> 00:32:14,110
is actually configured on the router

848
00:32:11,830 --> 00:32:16,210
this also includes things like ARP as

849
00:32:14,110 --> 00:32:18,040
the router is doing our<font color="#CCCCCC"> anything that</font>

850
00:32:16,210 --> 00:32:20,500
the router itself processes and doesn't

851
00:32:18,040 --> 00:32:22,149
just forward and it turns out that most

852
00:32:20,500 --> 00:32:24,310
router<font color="#CCCCCC"> CPUs are actually relatively</font>

853
00:32:22,150 --> 00:32:27,640
underpowered so it's not uncommon to

854
00:32:24,310 --> 00:32:29,530
find a 300 to 600 gig router that has a

855
00:32:27,640 --> 00:32:32,860
600 megahertz cpu holding the whole

856
00:32:29,530 --> 00:32:34,840
thing up these things are old and cranky

857
00:32:32,860 --> 00:32:36,879
and<font color="#E5E5E5"> tend not to have the best software</font>

858
00:32:34,840 --> 00:32:38,560
on them either and remember that ICMP

859
00:32:36,880 --> 00:32:40,270
generation is not a priority<font color="#E5E5E5"> for the</font>

860
00:32:38,560 --> 00:32:41,770
router of all the<font color="#CCCCCC"> things that</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> can be</font>

861
00:32:40,270 --> 00:32:43,240
<font color="#E5E5E5">doing that is probably</font><font color="#CCCCCC"> the least</font>

862
00:32:41,770 --> 00:32:45,129
important to<font color="#CCCCCC"> actually keeping network</font>

863
00:32:43,240 --> 00:32:48,940
running so that's<font color="#E5E5E5"> going to affect your</font>

864
00:32:45,130 --> 00:32:51,310
tracer up on some platforms the slow

865
00:32:48,940 --> 00:32:53,590
path data plane actually shares the same

866
00:32:51,310 --> 00:32:56,620
resources as<font color="#E5E5E5"> the control plane so what</font>

867
00:32:53,590 --> 00:32:58,449
that means is if I<font color="#E5E5E5"> get a packet that I</font>

868
00:32:56,620 --> 00:33:00,699
have<font color="#E5E5E5"> the TTL drop and I have to punt it</font>

869
00:32:58,450 --> 00:33:03,760
to a<font color="#CCCCCC"> cpu to handle the ICP generation</font>

870
00:33:00,700 --> 00:33:05,200
that runs on<font color="#CCCCCC"> the same</font><font color="#E5E5E5"> cpu as the guy</font>

871
00:33:03,760 --> 00:33:08,230
that's association to the box<font color="#E5E5E5"> doing a</font>

872
00:33:05,200 --> 00:33:10,300
show IP bgp so what happens is someone

873
00:33:08,230 --> 00:33:13,270
goes in and does a big complex regex

874
00:33:10,300 --> 00:33:14,980
<font color="#CCCCCC">show IP bgp and it slows the cpu down so</font>

875
00:33:13,270 --> 00:33:16,900
much that it takes a while<font color="#CCCCCC"> to generate</font>

876
00:33:14,980 --> 00:33:19,360
the ICMP message and now you start to

877
00:33:16,900 --> 00:33:21,760
see latency<font color="#CCCCCC"> that doesn't really exist in</font>

878
00:33:19,360 --> 00:33:25,030
<font color="#E5E5E5">the traceroute probably one of the most</font>

879
00:33:21,760 --> 00:33:27,160
common infamous examples of this is

880
00:33:25,030 --> 00:33:29,200
called<font color="#E5E5E5"> the</font><font color="#CCCCCC"> bgp scanner process so</font>

881
00:33:27,160 --> 00:33:30,700
classic iOS every 60 seconds there's a

882
00:33:29,200 --> 00:33:32,920
<font color="#E5E5E5">process that runs that iterates through</font>

883
00:33:30,700 --> 00:33:35,260
every BGP route and the box to kind of

884
00:33:32,920 --> 00:33:36,310
do some<font color="#E5E5E5"> back-end cleanup and every 60</font>

885
00:33:35,260 --> 00:33:40,240
seconds when it runs it makes your

886
00:33:36,310 --> 00:33:42,040
treasure look like crap the other thing

887
00:33:40,240 --> 00:33:44,580
to keep in mind is that most ICMP

888
00:33:42,040 --> 00:33:47,470
generation is going<font color="#E5E5E5"> to be rate limited</font>

889
00:33:44,580 --> 00:33:49,419
there's a lot<font color="#CCCCCC"> of reasons that you could</font>

890
00:33:47,470 --> 00:33:52,630
need to generate an ICMP it's not<font color="#E5E5E5"> just</font>

891
00:33:49,420 --> 00:33:54,970
<font color="#CCCCCC">TTL exceed could be anything from a a</font>

892
00:33:52,630 --> 00:33:57,760
destination unreachable a<font color="#CCCCCC"> ralphs just</font>

893
00:33:54,970 --> 00:33:59,290
flapped it could be<font color="#E5E5E5"> that you've created</font>

894
00:33:57,760 --> 00:34:01,870
<font color="#E5E5E5">a routing loop it could be any number of</font>

895
00:33:59,290 --> 00:34:03,550
things and it's a very<font color="#E5E5E5"> complex process</font>

896
00:34:01,870 --> 00:34:05,169
that gets handled in software by a

897
00:34:03,550 --> 00:34:06,850
<font color="#CCCCCC">general-purpose cpu and so there's</font>

898
00:34:05,170 --> 00:34:10,500
there's no<font color="#E5E5E5"> trace route asics out there</font>

899
00:34:06,850 --> 00:34:12,730
there's no if<font color="#E5E5E5"> PGA's that do any of this</font>

900
00:34:10,500 --> 00:34:14,230
and these<font color="#E5E5E5"> cpus are also doing other</font>

901
00:34:12,730 --> 00:34:15,580
things and they're<font color="#E5E5E5"> doing other more</font>

902
00:34:14,230 --> 00:34:17,360
important things like keeping the

903
00:34:15,580 --> 00:34:20,690
routing protocols from timing<font color="#E5E5E5"> out</font>

904
00:34:17,360 --> 00:34:22,790
and letting you do your show IP bgp and

905
00:34:20,690 --> 00:34:25,580
processing your arm doing all that type

906
00:34:22,790 --> 00:34:28,520
of stuff so you you actually wouldn't

907
00:34:25,580 --> 00:34:31,370
want your your TTL<font color="#CCCCCC"> zero packets to be</font>

908
00:34:28,520 --> 00:34:33,380
completely unchecked<font color="#CCCCCC"> any</font><font color="#E5E5E5"> time someone</font>

909
00:34:31,370 --> 00:34:35,029
creates a routing loop if you wrap a

910
00:34:33,380 --> 00:34:36,680
thing to me and I point the route

911
00:34:35,030 --> 00:34:37,940
straight back<font color="#CCCCCC"> to you that's going</font><font color="#E5E5E5"> to</font>

912
00:34:36,679 --> 00:34:40,040
create a routing loop<font color="#E5E5E5"> that's going to</font>

913
00:34:37,940 --> 00:34:42,260
give you a flood of TTL expiring packets

914
00:34:40,040 --> 00:34:44,029
so if you spent all your<font color="#E5E5E5"> CPU time</font>

915
00:34:42,260 --> 00:34:45,770
dealing with<font color="#E5E5E5"> those in generating ICMP</font>

916
00:34:44,030 --> 00:34:47,270
number one you generate a huge flood you

917
00:34:45,770 --> 00:34:48,860
might actually be<font color="#E5E5E5"> dee da</font><font color="#CCCCCC"> Singh someone</font>

918
00:34:47,270 --> 00:34:51,170
in the process number two you'd be

919
00:34:48,860 --> 00:34:53,810
consuming all your resources so most

920
00:34:51,170 --> 00:34:56,150
routers tend to have a rate limit the

921
00:34:53,810 --> 00:34:58,490
problem there is<font color="#E5E5E5"> these tend to be wildly</font>

922
00:34:56,150 --> 00:35:01,220
varied by a vendor platform software and

923
00:34:58,490 --> 00:35:03,799
are many times not configurable and<font color="#E5E5E5"> not</font>

924
00:35:01,220 --> 00:35:05,629
locked so you might<font color="#E5E5E5"> get into a situation</font>

925
00:35:03,800 --> 00:35:08,090
<font color="#E5E5E5">where you've got a big core router</font>

926
00:35:05,630 --> 00:35:09,530
somewhere and<font color="#CCCCCC"> 10 different people decide</font>

927
00:35:08,090 --> 00:35:11,180
that they're<font color="#CCCCCC"> all going to</font><font color="#E5E5E5"> run MTR at the</font>

928
00:35:09,530 --> 00:35:13,250
same time maybe because<font color="#CCCCCC"> of</font><font color="#E5E5E5"> an actual</font>

929
00:35:11,180 --> 00:35:15,830
network issue that went away and that's

930
00:35:13,250 --> 00:35:18,010
now so many TTL exceed messages that

931
00:35:15,830 --> 00:35:20,150
your router is not processing them and

932
00:35:18,010 --> 00:35:22,160
you're going<font color="#E5E5E5"> to start to see artificial</font>

933
00:35:20,150 --> 00:35:23,360
loss and everyone's going<font color="#CCCCCC"> to start to</font>

934
00:35:22,160 --> 00:35:24,470
see this and they're all going to start

935
00:35:23,360 --> 00:35:28,490
to open traceroute tickets with your

936
00:35:24,470 --> 00:35:30,770
neck so here's how you can<font color="#E5E5E5"> figure out if</font>

937
00:35:28,490 --> 00:35:33,229
there<font color="#E5E5E5"> is an actual forwarding issue if</font>

938
00:35:30,770 --> 00:35:35,630
it's<font color="#CCCCCC"> actually an issue the loss and</font>

939
00:35:33,230 --> 00:35:37,940
latency will persist across all future

940
00:35:35,630 --> 00:35:41,000
hops so if you look<font color="#CCCCCC"> at</font><font color="#E5E5E5"> this example here</font>

941
00:35:37,940 --> 00:35:43,610
number two you<font color="#E5E5E5"> see this weird spike from</font>

942
00:35:41,000 --> 00:35:45,230
18 milliseconds to<font color="#E5E5E5"> 68 milliseconds we</font>

943
00:35:43,610 --> 00:35:47,480
see how it doesn't continue in hop three

944
00:35:45,230 --> 00:35:49,220
and doesn't cut<font color="#CCCCCC"> the rest but</font><font color="#E5E5E5"> it doesn't</font>

945
00:35:47,480 --> 00:35:51,260
continue anywhere else that means<font color="#E5E5E5"> it's</font>

946
00:35:49,220 --> 00:35:55,609
not<font color="#E5E5E5"> a real forwarding issue if it was</font>

947
00:35:51,260 --> 00:35:57,350
actually in any way congesting or having

948
00:35:55,610 --> 00:35:59,540
a bad route or whatever you would see

949
00:35:57,350 --> 00:36:01,310
<font color="#CCCCCC">that follow all the way through if you</font>

950
00:35:59,540 --> 00:36:03,410
don't you know that<font color="#E5E5E5"> it's completely</font>

951
00:36:01,310 --> 00:36:05,029
cosmetic that's the number one thing to

952
00:36:03,410 --> 00:36:07,009
look for and that tends to<font color="#E5E5E5"> take out</font>

953
00:36:05,030 --> 00:36:08,210
<font color="#E5E5E5">about fifty percent</font><font color="#CCCCCC"> of your your random</font>

954
00:36:07,010 --> 00:36:09,410
people<font color="#E5E5E5"> in the internet sending</font><font color="#CCCCCC"> you</font>

955
00:36:08,210 --> 00:36:12,020
<font color="#E5E5E5">cherish all complaints about high</font>

956
00:36:09,410 --> 00:36:13,700
latency and it's just a particular<font color="#E5E5E5"> CPU</font>

957
00:36:12,020 --> 00:36:17,180
spike that's not cosmetic and if you run

958
00:36:13,700 --> 00:36:19,040
it again it'll probably go away when in

959
00:36:17,180 --> 00:36:21,859
<font color="#E5E5E5">doubt you can also try other things like</font>

960
00:36:19,040 --> 00:36:23,960
<font color="#E5E5E5">a non TTL expiring method so if you were</font>

961
00:36:21,860 --> 00:36:26,150
really curious<font color="#E5E5E5"> about the latency to hop</font>

962
00:36:23,960 --> 00:36:26,760
to you might<font color="#E5E5E5"> just ping the IP directly</font>

963
00:36:26,150 --> 00:36:28,520
and

964
00:36:26,760 --> 00:36:31,470
not it's going to<font color="#E5E5E5"> be handled differently</font>

965
00:36:28,520 --> 00:36:33,390
but that might<font color="#CCCCCC"> be a way to just kind of</font>

966
00:36:31,470 --> 00:36:35,930
measure that again and again and see<font color="#CCCCCC"> if</font>

967
00:36:33,390 --> 00:36:38,580
those you're getting the same behavior

968
00:36:35,930 --> 00:36:40,379
the<font color="#CCCCCC"> other thing that</font><font color="#E5E5E5"> you need to</font><font color="#CCCCCC"> be</font>

969
00:36:38,580 --> 00:36:43,680
careful<font color="#E5E5E5"> of</font><font color="#CCCCCC"> and traceroute is asymmetric</font>

970
00:36:40,380 --> 00:36:45,990
pads so remember what race route is

971
00:36:43,680 --> 00:36:48,060
showing you is actually the forward path

972
00:36:45,990 --> 00:36:51,120
you were seeing how you're Pro packet

973
00:36:48,060 --> 00:36:53,220
goes to the destination but you are not

974
00:36:51,120 --> 00:36:55,770
seeing and which makes<font color="#E5E5E5"> up a half the</font>

975
00:36:53,220 --> 00:36:57,870
latency value is the return path which

976
00:36:55,770 --> 00:37:00,990
can be completely different<font color="#CCCCCC"> and is</font>

977
00:36:57,870 --> 00:37:02,339
completely invisible so at no point can

978
00:37:00,990 --> 00:37:03,540
you ever look at one treasure<font color="#E5E5E5"> out and</font>

979
00:37:02,340 --> 00:37:05,280
guarantee that you know the<font color="#E5E5E5"> answer you</font>

980
00:37:03,540 --> 00:37:06,360
<font color="#CCCCCC">need to look at a minimum of two you</font>

981
00:37:05,280 --> 00:37:08,820
<font color="#E5E5E5">need to look at the</font><font color="#CCCCCC"> forward and reverse</font>

982
00:37:06,360 --> 00:37:12,210
paths before you even begin to have a

983
00:37:08,820 --> 00:37:13,440
hope of figuring it out like I said not

984
00:37:12,210 --> 00:37:14,580
<font color="#E5E5E5">only is the reverse path completely</font>

985
00:37:13,440 --> 00:37:19,710
hidden it can be completely<font color="#E5E5E5"> different</font>

986
00:37:14,580 --> 00:37:21,960
<font color="#E5E5E5">you have no way to know so asymmetric</font>

987
00:37:19,710 --> 00:37:24,060
paths tend to started<font color="#CCCCCC"> network boundaries</font>

988
00:37:21,960 --> 00:37:25,560
<font color="#CCCCCC">that was why I said that it was so</font>

989
00:37:24,060 --> 00:37:27,450
important to identify the network

990
00:37:25,560 --> 00:37:29,490
boundaries earlier because that's where

991
00:37:27,450 --> 00:37:31,770
the administrative policies change so

992
00:37:29,490 --> 00:37:34,200
look at<font color="#CCCCCC"> this example and you see that</font>

993
00:37:31,770 --> 00:37:36,840
<font color="#CCCCCC">Global Crossing to sprint you see in her</font>

994
00:37:34,200 --> 00:37:38,939
work boundary and you see<font color="#CCCCCC"> Ashburn on one</font>

995
00:37:36,840 --> 00:37:39,930
side<font color="#CCCCCC"> Nash burn on</font><font color="#E5E5E5"> the other side and the</font>

996
00:37:38,940 --> 00:37:41,580
latency is gone<font color="#CCCCCC"> up a hundred</font>

997
00:37:39,930 --> 00:37:44,430
milliseconds<font color="#E5E5E5"> so that could</font><font color="#CCCCCC"> be two things</font>

998
00:37:41,580 --> 00:37:46,440
<font color="#E5E5E5">it could be</font><font color="#CCCCCC"> that the global crossing</font>

999
00:37:44,430 --> 00:37:48,060
side is congested to sprint but you

1000
00:37:46,440 --> 00:37:50,280
don't know that<font color="#E5E5E5"> for sure you don't know</font>

1001
00:37:48,060 --> 00:37:52,110
that until<font color="#E5E5E5"> you look at the reverse path</font>

1002
00:37:50,280 --> 00:37:55,050
because it could also be an asymmetric

1003
00:37:52,110 --> 00:37:57,510
reverse path in this<font color="#E5E5E5"> particular example</font>

1004
00:37:55,050 --> 00:38:00,000
what happens is as soon as it hits print

1005
00:37:57,510 --> 00:38:02,130
side sprint has<font color="#CCCCCC"> a different local policy</font>

1006
00:38:00,000 --> 00:38:03,720
on which path are going to prefer and it

1007
00:38:02,130 --> 00:38:05,820
returns via a different<font color="#CCCCCC"> path he goes</font>

1008
00:38:03,720 --> 00:38:07,830
back via<font color="#E5E5E5"> cogent path that's congested</font>

1009
00:38:05,820 --> 00:38:09,090
and that's what's causing your hundred

1010
00:38:07,830 --> 00:38:11,340
milliseconds of latency but you can't

1011
00:38:09,090 --> 00:38:12,840
see that in this<font color="#CCCCCC"> trace route so again</font>

1012
00:38:11,340 --> 00:38:16,370
you always need<font color="#CCCCCC"> more than</font><font color="#E5E5E5"> one choice</font>

1013
00:38:12,840 --> 00:38:16,370
your help to identify this type of thing

1014
00:38:16,430 --> 00:38:21,240
so what do you do when you've got an

1015
00:38:18,660 --> 00:38:23,310
asymmetric traceroute and the end user

1016
00:38:21,240 --> 00:38:25,830
<font color="#E5E5E5">or whoever you're working with hasn't</font>

1017
00:38:23,310 --> 00:38:27,690
sent you two paths what are<font color="#CCCCCC"> some ways</font>

1018
00:38:25,830 --> 00:38:30,600
that you can kind of try<font color="#E5E5E5"> to rule this</font>

1019
00:38:27,690 --> 00:38:32,700
out the most<font color="#CCCCCC"> powerful thing you can do</font>

1020
00:38:30,600 --> 00:38:34,890
is to work with<font color="#CCCCCC"> your source address so</font>

1021
00:38:32,700 --> 00:38:36,990
in this example<font color="#CCCCCC"> let's assume</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> your</font>

1022
00:38:34,890 --> 00:38:39,379
multihomed to global crossing<font color="#CCCCCC"> in level</font>

1023
00:38:36,990 --> 00:38:41,640
<font color="#CCCCCC">three like</font><font color="#E5E5E5"> I said old slides</font>

1024
00:38:39,380 --> 00:38:43,830
you know that global crossing reaches

1025
00:38:41,640 --> 00:38:46,140
you via global crossing and sprint comes

1026
00:38:43,830 --> 00:38:47,880
back to you via level<font color="#CCCCCC"> three so you think</font>

1027
00:38:46,140 --> 00:38:49,379
<font color="#CCCCCC">that</font><font color="#E5E5E5"> there's a problem</font><font color="#CCCCCC"> between sprint</font>

1028
00:38:47,880 --> 00:38:51,869
level<font color="#CCCCCC"> three but how do</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> prove it how</font>

1029
00:38:49,380 --> 00:38:54,440
do you know<font color="#CCCCCC"> for sure what you can do is</font>

1030
00:38:51,869 --> 00:38:57,359
run them traceroute from your router and

1031
00:38:54,440 --> 00:39:00,420
set the source<font color="#E5E5E5"> address manually and set</font>

1032
00:38:57,359 --> 00:39:02,250
it to the / 30 that<font color="#CCCCCC"> is given to you by</font>

1033
00:39:00,420 --> 00:39:04,230
your transit provider in this case

1034
00:39:02,250 --> 00:39:07,050
global crossing and typically the way

1035
00:39:04,230 --> 00:39:10,560
this works<font color="#E5E5E5"> is the provider always gives</font>

1036
00:39:07,050 --> 00:39:11,760
the customer the<font color="#E5E5E5"> / 30 that's the 99</font>

1037
00:39:10,560 --> 00:39:15,259
percent of the time what you'll see

1038
00:39:11,760 --> 00:39:18,270
happen and peers tend to kind of go<font color="#CCCCCC"> 5050</font>

1039
00:39:15,260 --> 00:39:19,890
so in this case because<font color="#E5E5E5"> it's a / 30 that</font>

1040
00:39:18,270 --> 00:39:21,840
comes out of global crossings aggregate

1041
00:39:19,890 --> 00:39:23,730
it's going to follow that routing

1042
00:39:21,840 --> 00:39:26,250
behavior so it's<font color="#E5E5E5"> not it doesn't know</font>

1043
00:39:23,730 --> 00:39:27,990
that<font color="#CCCCCC"> you're multihomed to level</font><font color="#E5E5E5"> 3 it</font>

1044
00:39:26,250 --> 00:39:29,970
only thinks of itself as a global

1045
00:39:27,990 --> 00:39:31,859
crossing IP that's<font color="#E5E5E5"> going to force the</font>

1046
00:39:29,970 --> 00:39:33,419
reverse path to come back from sprint to

1047
00:39:31,859 --> 00:39:35,340
global crossing and if you see the

1048
00:39:33,420 --> 00:39:38,190
latency go away then you can<font color="#E5E5E5"> guarantee</font>

1049
00:39:35,340 --> 00:39:41,369
<font color="#CCCCCC">that or you can deduce that the problem</font>

1050
00:39:38,190 --> 00:39:43,020
was between sprint and level<font color="#CCCCCC"> 3</font><font color="#E5E5E5"> so</font>

1051
00:39:41,369 --> 00:39:44,850
another thing to<font color="#E5E5E5"> remember about</font>

1052
00:39:43,020 --> 00:39:47,970
asymmetric paths is that they can<font color="#E5E5E5"> happen</font>

1053
00:39:44,850 --> 00:39:49,980
anywhere can and<font color="#E5E5E5"> will especially on</font>

1054
00:39:47,970 --> 00:39:52,439
networks<font color="#E5E5E5"> with multiple exits so here's</font>

1055
00:39:49,980 --> 00:39:53,760
an<font color="#E5E5E5"> example of a</font><font color="#CCCCCC"> very simple peered</font>

1056
00:39:52,440 --> 00:39:56,220
network network appears in three

1057
00:39:53,760 --> 00:39:58,950
locations Washington DC Chicago and San

1058
00:39:56,220 --> 00:40:01,649
Jose and typically the way routing works

1059
00:39:58,950 --> 00:40:03,359
is people do hot potato they want to get

1060
00:40:01,650 --> 00:40:05,160
the packet author network as quickly as

1061
00:40:03,359 --> 00:40:06,569
<font color="#CCCCCC">possible and get it to</font><font color="#E5E5E5"> the other party</font>

1062
00:40:05,160 --> 00:40:09,330
number one<font color="#E5E5E5"> because that reduces their</font>

1063
00:40:06,570 --> 00:40:11,490
costs number two because the destination

1064
00:40:09,330 --> 00:40:12,569
<font color="#CCCCCC">network tends to have a better</font><font color="#E5E5E5"> idea of</font>

1065
00:40:11,490 --> 00:40:14,129
where they're forwarding the traffic

1066
00:40:12,570 --> 00:40:15,780
than you do they carry all their own d

1067
00:40:14,130 --> 00:40:17,580
aggregates and do their own<font color="#E5E5E5"> traffic</font>

1068
00:40:15,780 --> 00:40:19,530
engineering and it's generally a good

1069
00:40:17,580 --> 00:40:22,109
policy to get the packet to<font color="#CCCCCC"> the</font>

1070
00:40:19,530 --> 00:40:24,660
destination as quickly as<font color="#CCCCCC"> possible so in</font>

1071
00:40:22,109 --> 00:40:26,640
this example on hop one you see the

1072
00:40:24,660 --> 00:40:29,279
reverse path it goes across this

1073
00:40:26,640 --> 00:40:31,529
interface in<font color="#E5E5E5"> Washington</font><font color="#CCCCCC"> DC and it comes</font>

1074
00:40:29,280 --> 00:40:35,220
back across this interface in<font color="#E5E5E5"> Washington</font>

1075
00:40:31,530 --> 00:40:37,380
DC<font color="#E5E5E5"> on hop to you see the reverse path is</font>

1076
00:40:35,220 --> 00:40:40,200
different now it actually comes back via

1077
00:40:37,380 --> 00:40:41,850
Chicago on top three the reverse path

1078
00:40:40,200 --> 00:40:43,919
comes back via San Jose and this can

1079
00:40:41,850 --> 00:40:46,470
happen at every hop along the route as

1080
00:40:43,920 --> 00:40:48,210
you change where your reverse path is so

1081
00:40:46,470 --> 00:40:51,598
you can't take

1082
00:40:48,210 --> 00:40:54,270
a latency hop in the middle<font color="#E5E5E5"> of</font><font color="#CCCCCC"> a</font>

1083
00:40:51,599 --> 00:40:56,430
traceroute for granted because it might

1084
00:40:54,270 --> 00:40:58,680
<font color="#CCCCCC">be showing you for example hop too has a</font>

1085
00:40:56,430 --> 00:41:01,890
spike in hop three doesn't it could be

1086
00:40:58,680 --> 00:41:03,930
cosmetic or it could be that<font color="#CCCCCC"> the Chicago</font>

1087
00:41:01,890 --> 00:41:06,029
<font color="#CCCCCC">return interface is congested and only</font>

1088
00:41:03,930 --> 00:41:06,990
the Chicago<font color="#E5E5E5"> return interface so that's</font>

1089
00:41:06,030 --> 00:41:08,700
the kind of thing that you<font color="#CCCCCC"> would want</font><font color="#E5E5E5"> to</font>

1090
00:41:06,990 --> 00:41:10,589
probe further run some more choice route

1091
00:41:08,700 --> 00:41:15,118
see if its consistency if it's the<font color="#CCCCCC"> same</font>

1092
00:41:10,589 --> 00:41:17,430
behavior or not so how do you use source

1093
00:41:15,119 --> 00:41:18,780
address in your<font color="#E5E5E5"> choice routes what if</font>

1094
00:41:17,430 --> 00:41:21,029
it's numbered out of my space is in the

1095
00:41:18,780 --> 00:41:23,160
case of up here you can<font color="#CCCCCC"> still see some</font>

1096
00:41:21,030 --> 00:41:26,339
benefits typically<font color="#E5E5E5"> what I tell people to</font>

1097
00:41:23,160 --> 00:41:28,319
do is start sourcing from as many

1098
00:41:26,339 --> 00:41:30,690
different diverse sources as possible

1099
00:41:28,320 --> 00:41:33,119
and see what you<font color="#CCCCCC"> can get so for example</font>

1100
00:41:30,690 --> 00:41:36,270
say that I pier with with level<font color="#CCCCCC"> three</font>

1101
00:41:33,119 --> 00:41:39,530
and<font color="#CCCCCC"> we have a / 30 between each</font><font color="#E5E5E5"> other</font>

1102
00:41:36,270 --> 00:41:42,509
and it's my / 30 so I can't set<font color="#CCCCCC"> it to</font>

1103
00:41:39,530 --> 00:41:44,160
their their side and hope that<font color="#CCCCCC"> it all</font>

1104
00:41:42,510 --> 00:41:45,420
just works out<font color="#E5E5E5"> because it's not it's</font>

1105
00:41:44,160 --> 00:41:48,210
it's<font color="#E5E5E5"> going to follow my routing policy</font>

1106
00:41:45,420 --> 00:41:50,670
<font color="#E5E5E5">it's part of my aggregate what actually</font>

1107
00:41:48,210 --> 00:41:53,550
might happen is a lot of networks tend

1108
00:41:50,670 --> 00:41:57,540
to carry their edge /<font color="#E5E5E5"> 30s in their</font><font color="#CCCCCC"> igp</font>

1109
00:41:53,550 --> 00:42:00,450
so that / 30 in particular because it is

1110
00:41:57,540 --> 00:42:01,740
an edge interface to appear still gets

1111
00:42:00,450 --> 00:42:03,779
carried in<font color="#E5E5E5"> their network and still</font>

1112
00:42:01,740 --> 00:42:06,720
forces it to act as though it was their

1113
00:42:03,780 --> 00:42:07,830
route so there's always<font color="#E5E5E5"> a benefit try it</font>

1114
00:42:06,720 --> 00:42:09,330
try it from<font color="#E5E5E5"> a whole bunch of different</font>

1115
00:42:07,830 --> 00:42:12,750
<font color="#E5E5E5">viewpoints and see if you can deduce</font>

1116
00:42:09,330 --> 00:42:14,190
what's going on another thing to<font color="#E5E5E5"> keep in</font>

1117
00:42:12,750 --> 00:42:16,940
mind is that a lot<font color="#CCCCCC"> of routers have</font>

1118
00:42:14,190 --> 00:42:19,859
different default source addresses

1119
00:42:16,940 --> 00:42:22,080
typically the default on most routers if

1120
00:42:19,859 --> 00:42:24,630
you can figure nothing is to set the

1121
00:42:22,080 --> 00:42:27,450
source<font color="#E5E5E5"> address to the egress interface</font>

1122
00:42:24,630 --> 00:42:28,770
that the probe leaves from<font color="#E5E5E5"> may or may</font>

1123
00:42:27,450 --> 00:42:30,799
not be<font color="#E5E5E5"> what you want in fact it's</font>

1124
00:42:28,770 --> 00:42:35,400
probably<font color="#E5E5E5"> oftentimes not what you want</font>

1125
00:42:30,800 --> 00:42:37,859
but maybe it is if you you<font color="#E5E5E5"> can configure</font>

1126
00:42:35,400 --> 00:42:39,390
<font color="#E5E5E5">other options for example juniper you</font>

1127
00:42:37,859 --> 00:42:41,279
can configure system default address

1128
00:42:39,390 --> 00:42:42,598
selection and that will always source

1129
00:42:41,280 --> 00:42:45,240
the packets from your loopback address

1130
00:42:42,599 --> 00:42:47,070
so that'll be a lot more consistent if

1131
00:42:45,240 --> 00:42:48,689
nothing else you<font color="#CCCCCC"> might still</font><font color="#E5E5E5"> want to go</font>

1132
00:42:47,070 --> 00:42:51,630
back to looking at individual egress

1133
00:42:48,690 --> 00:42:53,730
interfaces to do some deductions but

1134
00:42:51,630 --> 00:42:55,650
most of<font color="#E5E5E5"> the time you probably want to be</font>

1135
00:42:53,730 --> 00:42:57,570
consistent so you don't randomly wonder

1136
00:42:55,650 --> 00:42:59,190
why this this one path is higher

1137
00:42:57,570 --> 00:43:02,850
the other and it turns out to<font color="#E5E5E5"> be a</font>

1138
00:42:59,190 --> 00:43:04,440
reverse path issue every time another

1139
00:43:02,850 --> 00:43:07,950
<font color="#E5E5E5">big thing that affects traceroute is</font>

1140
00:43:04,440 --> 00:43:09,420
multi paths and load balancing so

1141
00:43:07,950 --> 00:43:11,370
remember like<font color="#E5E5E5"> I said at the beginning</font>

1142
00:43:09,420 --> 00:43:14,580
every probe is a completely<font color="#E5E5E5"> independent</font>

1143
00:43:11,370 --> 00:43:18,120
trial and most traceroute packets the

1144
00:43:14,580 --> 00:43:20,160
the UDP and<font color="#E5E5E5"> TCP traceroute probes use a</font>

1145
00:43:18,120 --> 00:43:21,990
different layer for port every time so

1146
00:43:20,160 --> 00:43:25,890
they know<font color="#CCCCCC"> which probe their</font><font color="#E5E5E5"> own</font><font color="#CCCCCC"> top</font>

1147
00:43:21,990 --> 00:43:27,060
<font color="#E5E5E5">three hop for probe one probe</font><font color="#CCCCCC"> to because</font>

1148
00:43:25,890 --> 00:43:29,100
they use a different layer for port

1149
00:43:27,060 --> 00:43:31,320
every time what tends to happen is the

1150
00:43:29,100 --> 00:43:32,730
equal cost<font color="#E5E5E5"> multipath algorithms that are</font>

1151
00:43:31,320 --> 00:43:34,440
hashing on the packet and figuring out

1152
00:43:32,730 --> 00:43:36,660
<font color="#E5E5E5">how to distribute across multiple paths</font>

1153
00:43:34,440 --> 00:43:38,190
are looking at these as different flows

1154
00:43:36,660 --> 00:43:40,920
and that they could send them different

1155
00:43:38,190 --> 00:43:43,860
ways<font color="#E5E5E5"> so here's an example</font><font color="#CCCCCC"> of a very</font>

1156
00:43:40,920 --> 00:43:45,720
innocuous multiple paths you see it goes

1157
00:43:43,860 --> 00:43:47,880
across two different routers within

1158
00:43:45,720 --> 00:43:50,580
<font color="#CCCCCC">telia every time one</font><font color="#E5E5E5"> two one two one two</font>

1159
00:43:47,880 --> 00:43:52,320
and that's purely just<font color="#CCCCCC"> its incrementing</font>

1160
00:43:50,580 --> 00:43:55,040
the port by one<font color="#E5E5E5"> and so it's going one</font>

1161
00:43:52,320 --> 00:43:57,300
the other one the other one the other

1162
00:43:55,040 --> 00:43:58,800
that<font color="#CCCCCC"> one the stone is</font><font color="#E5E5E5"> very easy two of</font>

1163
00:43:57,300 --> 00:44:00,030
two of the probes go over one path one

1164
00:43:58,800 --> 00:44:02,070
goes<font color="#CCCCCC"> over the other and you can see that</font>

1165
00:44:00,030 --> 00:44:05,340
there's two parallel paths at layer

1166
00:44:02,070 --> 00:44:08,100
<font color="#E5E5E5">three slightly more complex example the</font>

1167
00:44:05,340 --> 00:44:10,800
patents don't always have to be equal so

1168
00:44:08,100 --> 00:44:12,360
here's an example<font color="#E5E5E5"> of what looks like a</font>

1169
00:44:10,800 --> 00:44:13,410
potentially confusing<font color="#CCCCCC"> traceroute but</font>

1170
00:44:12,360 --> 00:44:15,960
what's actually happening is you have

1171
00:44:13,410 --> 00:44:17,549
two parallel paths one that goes Ashburn

1172
00:44:15,960 --> 00:44:19,080
New York Seattle one that goes Ashburn

1173
00:44:17,550 --> 00:44:21,060
Chicago Seattle and these<font color="#E5E5E5"> are</font><font color="#CCCCCC"> both</font>

1174
00:44:19,080 --> 00:44:23,340
perfectly fine valid paths that could

1175
00:44:21,060 --> 00:44:24,330
work great but it's<font color="#E5E5E5"> very confusing if</font>

1176
00:44:23,340 --> 00:44:29,130
you don't know<font color="#E5E5E5"> what you're you're</font>

1177
00:44:24,330 --> 00:44:31,560
looking for and then the worst<font color="#CCCCCC"> unequal</font>

1178
00:44:29,130 --> 00:44:33,930
of the worst multiple paths scenario you

1179
00:44:31,560 --> 00:44:36,060
can<font color="#E5E5E5"> get into is unequal length and this</font>

1180
00:44:33,930 --> 00:44:37,470
<font color="#E5E5E5">is really confusing to the traceroute</font>

1181
00:44:36,060 --> 00:44:39,480
reader because it tends to<font color="#E5E5E5"> make it look</font>

1182
00:44:37,470 --> 00:44:41,640
<font color="#CCCCCC">like someone's going back and forth back</font>

1183
00:44:39,480 --> 00:44:43,530
and forth so say for example there's a

1184
00:44:41,640 --> 00:44:45,359
load balancing situation where there

1185
00:44:43,530 --> 00:44:47,070
just<font color="#E5E5E5"> happens to be an extra router X</font>

1186
00:44:45,360 --> 00:44:48,450
inserted in the path and otherwise these

1187
00:44:47,070 --> 00:44:50,940
are equal cost and it's going<font color="#E5E5E5"> to load</font>

1188
00:44:48,450 --> 00:44:52,770
<font color="#E5E5E5">balance between the two and traffic flow</font>

1189
00:44:50,940 --> 00:44:57,120
fine but what you're going to see is a

1190
00:44:52,770 --> 00:44:59,970
traceroute that goes bc b d c d e de and

1191
00:44:57,120 --> 00:45:01,500
install it confusing as all hell so keep

1192
00:44:59,970 --> 00:45:03,750
in mind when you see something like<font color="#CCCCCC"> that</font>

1193
00:45:01,500 --> 00:45:06,150
that's often what's going on

1194
00:45:03,750 --> 00:45:07,290
when in doubt<font color="#E5E5E5"> if you want to take</font><font color="#CCCCCC"> it</font>

1195
00:45:06,150 --> 00:45:08,850
<font color="#E5E5E5">down to something slightly less</font>

1196
00:45:07,290 --> 00:45:11,580
confusing just configure your tracer

1197
00:45:08,850 --> 00:45:13,410
I'll to only do a single probe so for

1198
00:45:11,580 --> 00:45:16,380
<font color="#E5E5E5">example in the</font><font color="#CCCCCC"> UNIX tracer allots the</font>

1199
00:45:13,410 --> 00:45:19,799
command is dash Q<font color="#CCCCCC"> 1 for</font><font color="#E5E5E5"> whatever reason</font>

1200
00:45:16,380 --> 00:45:21,810
in the<font color="#E5E5E5"> Juniper CLI you can do this from</font>

1201
00:45:19,800 --> 00:45:23,310
<font color="#E5E5E5">the shell so if you drop this shell and</font>

1202
00:45:21,810 --> 00:45:25,890
do a traceroute manually it'll work but

1203
00:45:23,310 --> 00:45:29,070
it's not actually in the CLI so minor

1204
00:45:25,890 --> 00:45:30,870
annoyance but remember<font color="#E5E5E5"> this may not be</font>

1205
00:45:29,070 --> 00:45:33,270
the actual path of your traffic<font color="#E5E5E5"> forwards</font>

1206
00:45:30,870 --> 00:45:34,740
over and every probe is still an

1207
00:45:33,270 --> 00:45:36,120
independent trial so you're not

1208
00:45:34,740 --> 00:45:37,740
guarantee that you're seeing one

1209
00:45:36,120 --> 00:45:40,140
contiguous path you're not guaranteed

1210
00:45:37,740 --> 00:45:42,479
that you're seeing the one side of<font color="#E5E5E5"> that</font>

1211
00:45:40,140 --> 00:45:45,600
two-sided load-balanced you're seeing

1212
00:45:42,480 --> 00:45:47,250
one particular string but it might

1213
00:45:45,600 --> 00:45:49,520
bounce and forth back and forth between

1214
00:45:47,250 --> 00:45:51,690
the<font color="#CCCCCC"> two</font><font color="#E5E5E5"> and in fact you probably will</font>

1215
00:45:49,520 --> 00:45:54,380
other things<font color="#CCCCCC"> that you can do if</font><font color="#E5E5E5"> you</font>

1216
00:45:51,690 --> 00:45:56,850
suspect this is<font color="#CCCCCC"> an issue is look at</font>

1217
00:45:54,380 --> 00:45:59,040
different IP addresses sometimes<font color="#E5E5E5"> people</font>

1218
00:45:56,850 --> 00:46:01,410
have their they're hatching<font color="#CCCCCC"> configure</font><font color="#E5E5E5"> to</font>

1219
00:45:59,040 --> 00:46:04,230
look at IP addresses so if you see a

1220
00:46:01,410 --> 00:46:07,049
weird path<font color="#E5E5E5"> three treacherous</font><font color="#CCCCCC"> travelling</font>

1221
00:46:04,230 --> 00:46:09,540
to dot 4 5 6 and see if it does

1222
00:46:07,050 --> 00:46:11,450
different things that's that's usually a

1223
00:46:09,540 --> 00:46:15,630
pretty good way to kind of narrow in on

1224
00:46:11,450 --> 00:46:17,850
when it's one path out of 64 path bundle

1225
00:46:15,630 --> 00:46:18,930
or something horrible like that that's

1226
00:46:17,850 --> 00:46:21,779
probably<font color="#E5E5E5"> the worst thing you could ever</font>

1227
00:46:18,930 --> 00:46:23,430
try<font color="#CCCCCC"> and troubleshoot but it's a good way</font>

1228
00:46:21,780 --> 00:46:26,070
<font color="#E5E5E5">to identify when something like</font><font color="#CCCCCC"> that is</font>

1229
00:46:23,430 --> 00:46:28,799
happening<font color="#E5E5E5"> and then the other</font><font color="#CCCCCC"> thing that</font>

1230
00:46:26,070 --> 00:46:32,760
pops up in traceroute is how it works

1231
00:46:28,800 --> 00:46:34,170
with mpls so remember there's a lot of

1232
00:46:32,760 --> 00:46:37,140
large networks out there that run

1233
00:46:34,170 --> 00:46:39,030
completely in pls based course and some

1234
00:46:37,140 --> 00:46:41,640
of<font color="#CCCCCC"> those devices don't even carry an IP</font>

1235
00:46:39,030 --> 00:46:43,140
routing table which they're doing it for

1236
00:46:41,640 --> 00:46:45,750
cost reasons or for performance reasons

1237
00:46:43,140 --> 00:46:47,520
or whatever that's perfectly fine you've

1238
00:46:45,750 --> 00:46:49,770
got<font color="#CCCCCC"> an MPLS based core it doesn't</font><font color="#E5E5E5"> need a</font>

1239
00:46:47,520 --> 00:46:52,050
routing table but what<font color="#E5E5E5"> this means is it</font>

1240
00:46:49,770 --> 00:46:53,790
causes a problem for how the ICMP is

1241
00:46:52,050 --> 00:46:55,560
generated because<font color="#E5E5E5"> if you don't have a</font>

1242
00:46:53,790 --> 00:46:57,870
local<font color="#E5E5E5"> routing table and your core device</font>

1243
00:46:55,560 --> 00:47:00,270
how do you know how to send the ICMP

1244
00:46:57,870 --> 00:47:03,089
message back so the workaround for this

1245
00:47:00,270 --> 00:47:05,580
is called ICMP tunneling what this does

1246
00:47:03,090 --> 00:47:08,400
is if the<font color="#E5E5E5"> router is forced to generate</font>

1247
00:47:05,580 --> 00:47:10,110
an ICMP rather than do a routing look up

1248
00:47:08,400 --> 00:47:11,859
and forward it like a normal router

1249
00:47:10,110 --> 00:47:13,660
would it puts it back in

1250
00:47:11,859 --> 00:47:15,730
side<font color="#CCCCCC"> the LSP that the path was</font><font color="#E5E5E5"> the</font>

1251
00:47:13,660 --> 00:47:17,739
packet was coming in on and forwards it

1252
00:47:15,730 --> 00:47:19,329
all the way<font color="#E5E5E5"> to the tail end which is</font>

1253
00:47:17,739 --> 00:47:20,769
perfectly<font color="#E5E5E5"> fine for getting the messages</font>

1254
00:47:19,329 --> 00:47:23,890
delivered but it makes<font color="#CCCCCC"> the treasure I</font>

1255
00:47:20,769 --> 00:47:25,689
look<font color="#E5E5E5"> really weird so here's kind of a</font>

1256
00:47:23,890 --> 00:47:28,089
<font color="#E5E5E5">diagram explaining that instead of the</font>

1257
00:47:25,690 --> 00:47:29,890
previous<font color="#CCCCCC"> model where a top one it would</font>

1258
00:47:28,089 --> 00:47:32,049
return it hop to a return on<font color="#E5E5E5"> hawthorne</font>

1259
00:47:29,890 --> 00:47:33,700
<font color="#E5E5E5">return now every hop along the way it's</font>

1260
00:47:32,049 --> 00:47:35,980
going<font color="#E5E5E5"> to forward that packet to the very</font>

1261
00:47:33,700 --> 00:47:37,989
tail end of the LSP before it comes back

1262
00:47:35,980 --> 00:47:40,749
to<font color="#CCCCCC"> you</font><font color="#E5E5E5"> it tends to make your traceroute</font>

1263
00:47:37,989 --> 00:47:42,700
look something like<font color="#CCCCCC"> this so here you've</font>

1264
00:47:40,749 --> 00:47:45,339
<font color="#CCCCCC">got a port between global crossing and</font>

1265
00:47:42,700 --> 00:47:47,589
ATT palo alto<font color="#CCCCCC"> de</font><font color="#E5E5E5"> san</font><font color="#CCCCCC"> francisco it's</font>

1266
00:47:45,339 --> 00:47:50,049
probably a local regional port and you

1267
00:47:47,589 --> 00:47:51,609
see the latency jump up quite a bit but

1268
00:47:50,049 --> 00:47:53,319
you see the latency stay consistent the

1269
00:47:51,609 --> 00:47:56,078
entire way through as it goes from San

1270
00:47:53,319 --> 00:47:57,549
Francisco to Chicago to New York the

1271
00:47:56,079 --> 00:47:59,289
latency stays exactly the same and

1272
00:47:57,549 --> 00:48:01,630
what's happening<font color="#E5E5E5"> there is ICMP tunneling</font>

1273
00:47:59,289 --> 00:48:03,730
well not that pop number three that

1274
00:48:01,630 --> 00:48:06,249
<font color="#E5E5E5">router in San Francisco drops the packet</font>

1275
00:48:03,730 --> 00:48:08,680
rather than returning it to the source

1276
00:48:06,249 --> 00:48:10,509
in San<font color="#CCCCCC"> Francisco it puts it back in the</font>

1277
00:48:08,680 --> 00:48:12,519
LSP and it forwards it to New York

1278
00:48:10,509 --> 00:48:14,079
<font color="#CCCCCC">before it can return so if you see</font>

1279
00:48:12,519 --> 00:48:16,118
something like that kind<font color="#CCCCCC"> of have an idea</font>

1280
00:48:14,079 --> 00:48:19,420
of what<font color="#E5E5E5"> to look for and don't get</font>

1281
00:48:16,119 --> 00:48:21,730
confused by it so some final thoughts

1282
00:48:19,420 --> 00:48:23,650
the traceroute checklist if you're

1283
00:48:21,730 --> 00:48:25,509
working<font color="#CCCCCC"> with traceroute if you you're</font>

1284
00:48:23,650 --> 00:48:27,489
working<font color="#E5E5E5"> on a trail ticket if you're</font>

1285
00:48:25,509 --> 00:48:29,289
trying to<font color="#E5E5E5"> figure out what's going on if</font>

1286
00:48:27,489 --> 00:48:32,349
someone has sent you a traceroute in any

1287
00:48:29,289 --> 00:48:34,749
way you should<font color="#E5E5E5"> always ask for trade</font>

1288
00:48:32,349 --> 00:48:36,940
routes in both directions and real

1289
00:48:34,749 --> 00:48:38,319
source and destination IP s if you're

1290
00:48:36,940 --> 00:48:40,329
going to submit<font color="#CCCCCC"> a traceroute ticket</font>

1291
00:48:38,319 --> 00:48:42,400
submit these two things don't bother

1292
00:48:40,329 --> 00:48:44,079
screwing around with it and pretending

1293
00:48:42,400 --> 00:48:45,369
like you know how to troubleshoot it

1294
00:48:44,079 --> 00:48:48,460
because it's going<font color="#E5E5E5"> to confuse everyone</font>

1295
00:48:45,369 --> 00:48:52,150
so we have our NOC<font color="#E5E5E5"> train to just not</font>

1296
00:48:48,460 --> 00:48:54,130
<font color="#CCCCCC">even attempt to process further and no</font>

1297
00:48:52,150 --> 00:48:55,720
since in the<font color="#E5E5E5"> the source and the</font>

1298
00:48:54,130 --> 00:48:57,670
destination send their the forward<font color="#E5E5E5"> and</font>

1299
00:48:55,720 --> 00:48:59,109
<font color="#E5E5E5">the reverse path or there's no possible</font>

1300
00:48:57,670 --> 00:49:01,749
way you can ever make an accurate

1301
00:48:59,109 --> 00:49:03,098
analysis also<font color="#E5E5E5"> be aware of people that</font>

1302
00:49:01,749 --> 00:49:04,839
send snippets of trace your outs with

1303
00:49:03,099 --> 00:49:06,099
missing information and it's it's very

1304
00:49:04,839 --> 00:49:07,538
common for someone to think<font color="#E5E5E5"> they're</font>

1305
00:49:06,099 --> 00:49:08,739
doing<font color="#CCCCCC"> you</font><font color="#E5E5E5"> a good thing by just</font><font color="#CCCCCC"> cutting</font>

1306
00:49:07,539 --> 00:49:10,089
out the middle of<font color="#E5E5E5"> a</font><font color="#CCCCCC"> traceroute and</font>

1307
00:49:08,739 --> 00:49:12,430
sending<font color="#E5E5E5"> it to you and it's completely</font>

1308
00:49:10,089 --> 00:49:14,210
<font color="#E5E5E5">useless you really need to know the</font>

1309
00:49:12,430 --> 00:49:17,029
actual destination IP that

1310
00:49:14,210 --> 00:49:20,510
responding<font color="#CCCCCC"> to and also</font><font color="#E5E5E5"> be</font><font color="#CCCCCC"> careful of</font>

1311
00:49:17,030 --> 00:49:21,470
people that do a traceroute see an IP in

1312
00:49:20,510 --> 00:49:23,960
the middle of<font color="#E5E5E5"> it and then do a</font>

1313
00:49:21,470 --> 00:49:25,368
traceroute to that IP because that can

1314
00:49:23,960 --> 00:49:26,780
have very different forwarding

1315
00:49:25,369 --> 00:49:29,359
characteristics than the actual

1316
00:49:26,780 --> 00:49:31,280
destination that they were<font color="#E5E5E5"> looking at so</font>

1317
00:49:29,359 --> 00:49:34,339
make sure you get real IP addresses make

1318
00:49:31,280 --> 00:49:36,740
sure you actually troubleshoot to the

1319
00:49:34,339 --> 00:49:38,900
real IP address<font color="#E5E5E5"> if for whatever reason</font>

1320
00:49:36,740 --> 00:49:41,029
<font color="#E5E5E5">the real IP address is not reachable you</font>

1321
00:49:38,900 --> 00:49:42,290
can try looking at you know the last<font color="#E5E5E5"> hop</font>

1322
00:49:41,030 --> 00:49:44,000
<font color="#E5E5E5">that was reachable and do something like</font>

1323
00:49:42,290 --> 00:49:47,359
<font color="#CCCCCC">that but</font><font color="#E5E5E5"> just keep in mind</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> you are</font>

1324
00:49:44,000 --> 00:49:50,380
no way guaranteed the<font color="#E5E5E5"> the path is going</font>

1325
00:49:47,359 --> 00:49:53,380
to be the same at all and that's<font color="#E5E5E5"> it</font>

1326
00:49:50,380 --> 00:49:53,380
questions

1327
00:49:56,210 --> 00:49:58,839
Mike

1328
00:50:04,190 --> 00:50:10,900
oh oh right

1329
00:50:11,380 --> 00:50:15,650
my<font color="#E5E5E5"> name is Chad Reed with the</font><font color="#CCCCCC"> apollo</font>

1330
00:50:13,610 --> 00:50:17,360
<font color="#CCCCCC">group could</font><font color="#E5E5E5"> you talk about the</font><font color="#CCCCCC"> mpls</font>

1331
00:50:15,650 --> 00:50:19,160
tunneling one more time<font color="#E5E5E5"> I was with you</font>

1332
00:50:17,360 --> 00:50:22,880
on everything until that point and<font color="#E5E5E5"> then</font>

1333
00:50:19,160 --> 00:50:25,220
I kind of got lost yeah so the<font color="#E5E5E5"> way mpls</font>

1334
00:50:22,880 --> 00:50:27,710
works is you have a you have an LSP you

1335
00:50:25,220 --> 00:50:29,660
have a virtual puddle from point A to

1336
00:50:27,710 --> 00:50:31,310
point B within your network and it's

1337
00:50:29,660 --> 00:50:33,980
<font color="#E5E5E5">going</font><font color="#CCCCCC"> to guarantee</font><font color="#E5E5E5"> a forward path it's</font>

1338
00:50:31,310 --> 00:50:35,900
going to you might have in this case<font color="#CCCCCC"> ten</font>

1339
00:50:33,980 --> 00:50:37,760
hops in the middle but what<font color="#E5E5E5"> happens is</font>

1340
00:50:35,900 --> 00:50:39,530
this first router in San Francisco says

1341
00:50:37,760 --> 00:50:41,210
I know this packet is going to New York

1342
00:50:39,530 --> 00:50:43,640
i'm going to encapsulate it inside of

1343
00:50:41,210 --> 00:50:45,860
the LSP and i'm going<font color="#E5E5E5"> to forward it to</font>

1344
00:50:43,640 --> 00:50:47,560
New York that's how<font color="#E5E5E5"> you do komplex</font>

1345
00:50:45,860 --> 00:50:50,360
traffic engineering and things like that

1346
00:50:47,560 --> 00:50:51,830
<font color="#E5E5E5">but what happens is in the case where</font>

1347
00:50:50,360 --> 00:50:54,290
it's doing a traitor I'll packet where

1348
00:50:51,830 --> 00:50:56,779
it's dropping the packet and it doesn't

1349
00:50:54,290 --> 00:50:58,580
know so now<font color="#CCCCCC"> it's drop the packet and</font>

1350
00:50:56,780 --> 00:51:00,560
generate in ICP<font color="#CCCCCC"> and it needs</font><font color="#E5E5E5"> to send a</font>

1351
00:50:58,580 --> 00:51:02,660
Tyson feedback to whoever did that

1352
00:51:00,560 --> 00:51:04,370
traceroute it's not carrying<font color="#E5E5E5"> a routing</font>

1353
00:51:02,660 --> 00:51:06,920
table at<font color="#E5E5E5"> this point it's it's only</font>

1354
00:51:04,370 --> 00:51:08,960
switching mpls so the only way that it

1355
00:51:06,920 --> 00:51:11,180
has to deliver the packet is to put it

1356
00:51:08,960 --> 00:51:15,020
in the same LSP that it got it from

1357
00:51:11,180 --> 00:51:17,509
which is a good workaround to a table

1358
00:51:15,020 --> 00:51:18,680
escort but a bad work around for trace

1359
00:51:17,510 --> 00:51:20,980
job because it makes<font color="#CCCCCC"> the treasure look</font>

1360
00:51:18,680 --> 00:51:20,980
weird

1361
00:51:22,800 --> 00:51:31,950
I Sam<font color="#CCCCCC"> Waldron from Huawei with respect</font>

1362
00:51:28,500 --> 00:51:34,970
to mpls I don't think<font color="#CCCCCC"> you can actually</font>

1363
00:51:31,950 --> 00:51:37,919
troubleshoot the mpls networks with

1364
00:51:34,970 --> 00:51:42,810
tunneling mechanism if you actually<font color="#CCCCCC"> go</font>

1365
00:51:37,920 --> 00:51:45,480
back to nanog 55 presented mpls so young

1366
00:51:42,810 --> 00:51:48,660
tutorial you use<font color="#CCCCCC"> Alice beeping and</font>

1367
00:51:45,480 --> 00:51:51,900
crazed and treat<font color="#CCCCCC"> raise to actually</font>

1368
00:51:48,660 --> 00:51:53,700
troubleshoot the networks because ICMP

1369
00:51:51,900 --> 00:51:56,070
for example you<font color="#CCCCCC"> take penultimate hop</font>

1370
00:51:53,700 --> 00:51:58,410
popping and you have fell asleep

1371
00:51:56,070 --> 00:52:01,350
breakage between polenta<font color="#CCCCCC"> mate and</font>

1372
00:51:58,410 --> 00:52:03,210
ultimate hob you cannot get it with ICMP

1373
00:52:01,350 --> 00:52:05,730
because you could actually route it and

1374
00:52:03,210 --> 00:52:07,620
figure<font color="#E5E5E5"> that out so the reason why I</font>

1375
00:52:05,730 --> 00:52:10,380
bring this point is if you want to

1376
00:52:07,620 --> 00:52:12,990
troubleshoot mpls networks we<font color="#E5E5E5"> actually</font>

1377
00:52:10,380 --> 00:52:16,050
have similar kind of tool set just like

1378
00:52:12,990 --> 00:52:18,270
ICMP tool set but specifically catered

1379
00:52:16,050 --> 00:52:21,510
to mpls<font color="#E5E5E5"> network so you could actually</font>

1380
00:52:18,270 --> 00:52:23,610
you can go back<font color="#CCCCCC"> and for the audience</font>

1381
00:52:21,510 --> 00:52:27,300
they can go back and<font color="#CCCCCC"> look</font><font color="#E5E5E5"> up tutorial</font>

1382
00:52:23,610 --> 00:52:28,860
and<font color="#CCCCCC"> Phillip out so that's</font><font color="#E5E5E5"> true if you're</font>

1383
00:52:27,300 --> 00:52:31,080
troubleshooting your own<font color="#CCCCCC"> MPLS Network</font>

1384
00:52:28,860 --> 00:52:32,520
but and this<font color="#CCCCCC"> was an example</font><font color="#E5E5E5"> I'm saying</font>

1385
00:52:31,080 --> 00:52:34,230
you're a ninja's are on the internet and

1386
00:52:32,520 --> 00:52:36,509
some network who is<font color="#E5E5E5"> not you so say</font>

1387
00:52:34,230 --> 00:52:38,760
you're not ATT and you're<font color="#CCCCCC"> wondering why</font>

1388
00:52:36,510 --> 00:52:40,260
this latency jumps up so high you can

1389
00:52:38,760 --> 00:52:42,360
tell what's happening because<font color="#E5E5E5"> they've</font>

1390
00:52:40,260 --> 00:52:43,890
configured I seen Pete online and thus

1391
00:52:42,360 --> 00:52:46,740
you look at this<font color="#E5E5E5"> and you don't think</font>

1392
00:52:43,890 --> 00:52:48,299
it's congestion Palo Alto you know that

1393
00:52:46,740 --> 00:52:49,560
it's ICP tongue because it stays the

1394
00:52:48,300 --> 00:52:50,790
whole way through yes if you're

1395
00:52:49,560 --> 00:52:52,500
troubleshooting your own network you

1396
00:52:50,790 --> 00:52:54,330
should use different tools like LS

1397
00:52:52,500 --> 00:52:55,920
beeping and things like that this is

1398
00:52:54,330 --> 00:52:58,799
talking<font color="#CCCCCC"> about</font><font color="#E5E5E5"> a third party that's just</font>

1399
00:52:55,920 --> 00:53:01,530
looking at<font color="#CCCCCC"> a traceroute result so one</font>

1400
00:52:58,800 --> 00:53:04,290
additional<font color="#CCCCCC"> question</font><font color="#E5E5E5"> so have you thought</font>

1401
00:53:01,530 --> 00:53:06,890
about the multicast traffic how do you

1402
00:53:04,290 --> 00:53:08,759
want to troubleshoot that about it

1403
00:53:06,890 --> 00:53:10,109
because most<font color="#E5E5E5"> of the things you</font><font color="#CCCCCC"> are</font>

1404
00:53:08,760 --> 00:53:14,700
talking about the trace route with

1405
00:53:10,110 --> 00:53:15,220
respect to unicast right I not touched

1406
00:53:14,700 --> 00:53:18,580
the

1407
00:53:15,220 --> 00:53:19,689
multicast<font color="#CCCCCC"> out of it my</font><font color="#E5E5E5"> condolences if</font>

1408
00:53:18,580 --> 00:53:25,270
you're stuck doing a multicast

1409
00:53:19,690 --> 00:53:29,970
traceroute yeah sorry<font color="#E5E5E5"> no idea okay</font>

1410
00:53:25,270 --> 00:53:29,970
thanks any other questions

1411
00:53:34,130 --> 00:53:38,299
my name is Chris bathroom for Microsoft

1412
00:53:35,960 --> 00:53:40,579
on a core group so we<font color="#E5E5E5"> look at the</font>

1413
00:53:38,299 --> 00:53:41,779
traceroute and we can see 74

1414
00:53:40,579 --> 00:53:44,869
milliseconds all the way through until

1415
00:53:41,779 --> 00:53:48,740
it stops at AT&T now assuming we didn't

1416
00:53:44,869 --> 00:53:50,779
have a verbose dns server<font color="#E5E5E5"> there our dms</font>

1417
00:53:48,740 --> 00:53:53,629
naming convention how would we know

1418
00:53:50,779 --> 00:53:55,640
where the<font color="#CCCCCC"> MPLS tunneling stops because</font>

1419
00:53:53,630 --> 00:53:58,759
we can see<font color="#E5E5E5"> that but we have a very small</font>

1420
00:53:55,640 --> 00:54:00,710
millisecond increase from nine to<font color="#E5E5E5"> ten so</font>

1421
00:53:58,759 --> 00:54:02,720
one of the things<font color="#E5E5E5"> I almost threw in here</font>

1422
00:54:00,710 --> 00:54:05,329
and I didn't<font color="#E5E5E5"> get around to doing it is</font>

1423
00:54:02,720 --> 00:54:07,700
there's<font color="#CCCCCC"> actually extensions to the ICMP</font>

1424
00:54:05,329 --> 00:54:10,640
TTL exceed messages that encode

1425
00:54:07,700 --> 00:54:12,078
something about the LSP and most routers

1426
00:54:10,640 --> 00:54:14,118
are aware of this so if<font color="#E5E5E5"> you do a</font>

1427
00:54:12,079 --> 00:54:16,430
traceroute through someone else's MPLS

1428
00:54:14,119 --> 00:54:18,710
Network you'll get back a little message

1429
00:54:16,430 --> 00:54:20,089
that says this went through an LSP and

1430
00:54:18,710 --> 00:54:23,960
they'll tell you how deep in the stack

1431
00:54:20,089 --> 00:54:26,390
it was they'll give you a LS PID things

1432
00:54:23,960 --> 00:54:27,859
like that so you can<font color="#E5E5E5"> use that kind</font><font color="#CCCCCC"> of</font>

1433
00:54:26,390 --> 00:54:29,779
figure<font color="#CCCCCC"> out if you're inside an LSP or</font>

1434
00:54:27,859 --> 00:54:34,759
not I just didn't have<font color="#E5E5E5"> time division</font>

1435
00:54:29,779 --> 00:54:38,720
iron cool thank you hi I'm<font color="#CCCCCC"> Adrian</font>

1436
00:54:34,759 --> 00:54:43,039
supplant on with AT&T and my domain is

1437
00:54:38,720 --> 00:54:46,339
security so in AT&T we debated a lot

1438
00:54:43,039 --> 00:54:51,079
about when we went<font color="#CCCCCC"> to mpls</font><font color="#E5E5E5"> whether to</font>

1439
00:54:46,339 --> 00:54:52,910
hide the core or not and we ended up

1440
00:54:51,079 --> 00:54:56,240
with kind of a mixed<font color="#CCCCCC"> bag where we have</font>

1441
00:54:52,910 --> 00:54:58,430
our domestic<font color="#CCCCCC"> choric as you can see we</font>

1442
00:54:56,240 --> 00:55:01,098
can<font color="#CCCCCC"> see the hops but</font><font color="#E5E5E5"> in our</font>

1443
00:54:58,430 --> 00:55:03,049
international core we hide the hops so

1444
00:55:01,099 --> 00:55:07,819
you can<font color="#E5E5E5"> only see the beginning and the</font>

1445
00:55:03,049 --> 00:55:09,829
two<font color="#E5E5E5"> peas at either end of</font><font color="#CCCCCC"> the path what</font>

1446
00:55:07,819 --> 00:55:12,170
do other providers do about this and

1447
00:55:09,829 --> 00:55:14,980
anybody<font color="#E5E5E5"> thinking about hiding the core</font>

1448
00:55:12,170 --> 00:55:17,630
for usually<font color="#E5E5E5"> for security reasons because</font>

1449
00:55:14,980 --> 00:55:21,049
it's a security best practice to not

1450
00:55:17,630 --> 00:55:22,640
interact with the core not allow transit

1451
00:55:21,049 --> 00:55:27,049
traffic to interact with<font color="#E5E5E5"> the core in a</font>

1452
00:55:22,640 --> 00:55:28,960
way<font color="#CCCCCC"> like TTL exceeded does and certainly</font>

1453
00:55:27,049 --> 00:55:32,110
the vendor has been recommending that

1454
00:55:28,960 --> 00:55:35,740
for quite some time and you will

1455
00:55:32,110 --> 00:55:38,920
<font color="#CCCCCC">Enda being on like security auditors</font>

1456
00:55:35,740 --> 00:55:42,250
checklist sets at some point like many

1457
00:55:38,920 --> 00:55:43,900
other things yeah certainly a lot of

1458
00:55:42,250 --> 00:55:45,910
<font color="#E5E5E5">people will just turn off the TTL</font>

1459
00:55:43,900 --> 00:55:49,180
decrement so like you said you don't see

1460
00:55:45,910 --> 00:55:51,129
this at all the the LSP is treated as

1461
00:55:49,180 --> 00:55:52,480
though it was one single<font color="#E5E5E5"> hop and so you</font>

1462
00:55:51,130 --> 00:55:55,330
don't have<font color="#E5E5E5"> a router in the middle</font>

1463
00:55:52,480 --> 00:55:57,340
dropping exposing itself yeah that's

1464
00:55:55,330 --> 00:55:59,560
very<font color="#E5E5E5"> good at hiding that type of stuff</font>

1465
00:55:57,340 --> 00:56:01,060
from traceroute there's lots of<font color="#E5E5E5"> other</font>

1466
00:55:59,560 --> 00:56:02,830
ways<font color="#E5E5E5"> you can get around that there's</font>

1467
00:56:01,060 --> 00:56:05,200
lots<font color="#E5E5E5"> of like if you if you poke and prod</font>

1468
00:56:02,830 --> 00:56:06,430
at different networks for example if you

1469
00:56:05,200 --> 00:56:08,379
can guess someone's<font color="#CCCCCC"> Whitbeck address</font>

1470
00:56:06,430 --> 00:56:11,350
<font color="#CCCCCC">oftentimes you'll find you don't</font><font color="#E5E5E5"> have a</font>

1471
00:56:08,380 --> 00:56:12,850
way to hide those LSDs and you'll still

1472
00:56:11,350 --> 00:56:15,790
be able to kind of poke and see the the

1473
00:56:12,850 --> 00:56:17,620
hidden core so<font color="#E5E5E5"> I wouldn't really look at</font>

1474
00:56:15,790 --> 00:56:20,380
it<font color="#E5E5E5"> from a security perspective I'm</font>

1475
00:56:17,620 --> 00:56:22,029
personally of the mindset that I like

1476
00:56:20,380 --> 00:56:24,550
exposing the core because I want

1477
00:56:22,030 --> 00:56:25,780
customers I generally work with smart

1478
00:56:24,550 --> 00:56:27,340
customers and I kind of want them to

1479
00:56:25,780 --> 00:56:29,950
know what's going<font color="#E5E5E5"> on and what's</font>

1480
00:56:27,340 --> 00:56:32,560
happening kind<font color="#E5E5E5"> of shows exactly where</font>

1481
00:56:29,950 --> 00:56:34,509
and why the packets going but yeah you

1482
00:56:32,560 --> 00:56:36,009
just remember that<font color="#E5E5E5"> anything you see in</font>

1483
00:56:34,510 --> 00:56:38,290
traits<font color="#E5E5E5"> are out you are in</font><font color="#CCCCCC"> no way</font>

1484
00:56:36,010 --> 00:56:39,910
guaranteed to know that the fiber path

1485
00:56:38,290 --> 00:56:42,040
just doesn't go be a switch<font color="#E5E5E5"> network</font>

1486
00:56:39,910 --> 00:56:43,899
that's completely invisible or inside an

1487
00:56:42,040 --> 00:56:46,600
LSP that's hiding 17 different router

1488
00:56:43,900 --> 00:56:50,110
hops or anything else you're you're at

1489
00:56:46,600 --> 00:56:51,868
the mercy of what is exposed<font color="#E5E5E5"> to you okay</font>

1490
00:56:50,110 --> 00:56:54,950
thanks

1491
00:56:51,869 --> 00:56:54,950
any other questions

1492
00:56:55,890 --> 00:56:59,569
oh thank you very<font color="#CCCCCC"> much</font>

1493
00:57:10,350 --> 00:57:12,410
you

