1
00:00:00,000 --> 00:00:04,560
[Music]

2
00:00:04,560 --> 00:00:06,399
well thank you for that introduction

3
00:00:06,399 --> 00:00:08,639
my name is craig lapovitz and i'm the

4
00:00:08,639 --> 00:00:11,040
cto for nokia deep field

5
00:00:11,040 --> 00:00:13,679
a bit of housekeeping before we begin

6
00:00:13,679 --> 00:00:15,679
first i work for a router vendor that

7
00:00:15,679 --> 00:00:18,000
also provides anti-ddos

8
00:00:18,000 --> 00:00:20,240
and secondly i won't be naming

9
00:00:20,240 --> 00:00:23,680
individual isps or cloud providers today

10
00:00:23,680 --> 00:00:25,840
unless they explicitly advertise their

11
00:00:25,840 --> 00:00:26,720
ddos

12
00:00:26,720 --> 00:00:29,679
and iphm or ip header modification

13
00:00:29,679 --> 00:00:30,960
services

14
00:00:30,960 --> 00:00:32,479
and i'm not naming them for really two

15
00:00:32,479 --> 00:00:34,399
reasons one

16
00:00:34,399 --> 00:00:37,200
is that it's often hard to tell motive

17
00:00:37,200 --> 00:00:39,680
whether it is actually malicious intent

18
00:00:39,680 --> 00:00:42,399
or it's inadvertent and or ignorance and

19
00:00:42,399 --> 00:00:43,280
they're not aware

20
00:00:43,280 --> 00:00:46,160
of their customers and secondly i don't

21
00:00:46,160 --> 00:00:47,120
think it is the most

22
00:00:47,120 --> 00:00:50,399
important factor the important factor

23
00:00:50,399 --> 00:00:54,320
is that as a community it is relatively

24
00:00:54,320 --> 00:00:55,440
straightforward

25
00:00:55,440 --> 00:00:59,359
to detect to filter and block and stop

26
00:00:59,359 --> 00:01:02,320
spoofed traffic which constitutes the

27
00:01:02,320 --> 00:01:02,879
large

28
00:01:02,879 --> 00:01:06,080
share of ddos today and as

29
00:01:06,080 --> 00:01:08,159
a community you know it really is a

30
00:01:08,159 --> 00:01:09,439
community effort

31
00:01:09,439 --> 00:01:11,760
with ddos booters they are constantly

32
00:01:11,760 --> 00:01:12,880
changing asn

33
00:01:12,880 --> 00:01:15,759
constantly changing names and so on so

34
00:01:15,759 --> 00:01:16,880
this talk really came

35
00:01:16,880 --> 00:01:19,920
out of frustration frustration that

36
00:01:19,920 --> 00:01:21,680
we are still having the same

37
00:01:21,680 --> 00:01:23,200
conversations 20

38
00:01:23,200 --> 00:01:26,280
25 years later about really

39
00:01:26,280 --> 00:01:27,439
unsophisticated

40
00:01:27,439 --> 00:01:30,799
stupid iphm reflection ddos

41
00:01:30,799 --> 00:01:33,920
well this isn't all of ddos it is by

42
00:01:33,920 --> 00:01:36,560
frequency and aggregate volume the vast

43
00:01:36,560 --> 00:01:38,479
majority of ddos

44
00:01:38,479 --> 00:01:39,920
and the frustration is there's no good

45
00:01:39,920 --> 00:01:42,000
reason for this this traffic is

46
00:01:42,000 --> 00:01:45,520
relatively easy to detect and to block

47
00:01:45,520 --> 00:01:47,360
and you know out of frustration we

48
00:01:47,360 --> 00:01:48,960
decided to spend a bit of time and

49
00:01:48,960 --> 00:01:49,840
effort

50
00:01:49,840 --> 00:01:52,399
and see if we could actually understand

51
00:01:52,399 --> 00:01:54,000
where the spoofed traffic was

52
00:01:54,000 --> 00:01:55,759
coming from and trace it back to the

53
00:01:55,759 --> 00:01:58,079
internet and indeed as i'll share the

54
00:01:58,079 --> 00:02:00,159
rest of this talk you can

55
00:02:00,159 --> 00:02:02,880
we went through again steps i'll talk in

56
00:02:02,880 --> 00:02:04,640
the upcoming slides and really identify

57
00:02:04,640 --> 00:02:06,240
50 or so companies

58
00:02:06,240 --> 00:02:08,160
that today are generating the vast

59
00:02:08,160 --> 00:02:10,959
majority of spoofed amplified

60
00:02:10,959 --> 00:02:14,080
tcp reflection and spoof ddos so we'll

61
00:02:14,080 --> 00:02:15,599
share a little bit about the techniques

62
00:02:15,599 --> 00:02:16,560
we did

63
00:02:16,560 --> 00:02:18,720
uh we'll show how you can use most

64
00:02:18,720 --> 00:02:20,959
routers today from all vendors to block

65
00:02:20,959 --> 00:02:22,800
the vast majority of ddos

66
00:02:22,800 --> 00:02:24,560
and we've got recommendations for

67
00:02:24,560 --> 00:02:28,080
vendors so a quick bit of introduction

68
00:02:28,080 --> 00:02:31,200
they're really four vectors for ddos

69
00:02:31,200 --> 00:02:33,440
the first three vectors all rely on the

70
00:02:33,440 --> 00:02:34,720
ability to do

71
00:02:34,720 --> 00:02:37,120
high speed spoofing of the source

72
00:02:37,120 --> 00:02:38,160
address

73
00:02:38,160 --> 00:02:41,760
for amplification tcp sa synac

74
00:02:41,760 --> 00:02:45,200
and iphm flood the attacker spoofs the

75
00:02:45,200 --> 00:02:47,120
source address of the victim

76
00:02:47,120 --> 00:02:49,519
bounces it off of amplifiers and

77
00:02:49,519 --> 00:02:50,319
achieves a

78
00:02:50,319 --> 00:02:53,360
500 1000 x amplification going to the

79
00:02:53,360 --> 00:02:54,400
victim

80
00:02:54,400 --> 00:02:56,400
in the third flavor it is just fully

81
00:02:56,400 --> 00:02:58,000
spoofed typically your sin

82
00:02:58,000 --> 00:03:01,040
your reset tax and others

83
00:03:01,040 --> 00:03:03,599
bond nets are absolutely part of ddos

84
00:03:03,599 --> 00:03:05,120
but they aren't the most significant

85
00:03:05,120 --> 00:03:06,480
portion today

86
00:03:06,480 --> 00:03:09,040
and you know likely i probably reserve

87
00:03:09,040 --> 00:03:11,920
the talk of their own in the future

88
00:03:11,920 --> 00:03:13,760
so when you actually look at the ddos

89
00:03:13,760 --> 00:03:15,200
ecosystem it primarily

90
00:03:15,200 --> 00:03:18,319
tends to be today gamers and extortion

91
00:03:18,319 --> 00:03:19,519
attempts

92
00:03:19,519 --> 00:03:21,360
gamers and extortion are not super

93
00:03:21,360 --> 00:03:22,720
hackers what they're doing

94
00:03:22,720 --> 00:03:25,519
is they're using give or take about 100

95
00:03:25,519 --> 00:03:28,080
or so commercial booter services

96
00:03:28,080 --> 00:03:30,159
these are services that advertise that

97
00:03:30,159 --> 00:03:32,000
offer discounts and referrals

98
00:03:32,000 --> 00:03:34,400
and provide a range of ddos options for

99
00:03:34,400 --> 00:03:36,319
give or take about fifty to a hundred

100
00:03:36,319 --> 00:03:36,879
dollars

101
00:03:36,879 --> 00:03:40,879
u.s per month in turn the ddos booters

102
00:03:40,879 --> 00:03:41,519
rely

103
00:03:41,519 --> 00:03:44,959
on a fairly small number of hosting

104
00:03:44,959 --> 00:03:46,560
these hosting companies tend to be

105
00:03:46,560 --> 00:03:48,720
specialists they also tend to advertise

106
00:03:48,720 --> 00:03:49,599
though some

107
00:03:49,599 --> 00:03:52,560
less directly than others where the

108
00:03:52,560 --> 00:03:53,920
stressors will run

109
00:03:53,920 --> 00:03:55,680
on the different servers and for example

110
00:03:55,680 --> 00:03:57,840
plex web is one that advertises they'll

111
00:03:57,840 --> 00:03:58,560
ignore

112
00:03:58,560 --> 00:04:01,360
all dmca requests they provide high

113
00:04:01,360 --> 00:04:01,840
speed

114
00:04:01,840 --> 00:04:05,280
spoofing in turn the spoofers tend to

115
00:04:05,280 --> 00:04:05,840
rely

116
00:04:05,840 --> 00:04:08,319
for most attacks on amplification or

117
00:04:08,319 --> 00:04:09,920
reflection

118
00:04:09,920 --> 00:04:12,879
millions particularly dns ntp into a

119
00:04:12,879 --> 00:04:14,400
lesser degree ldap

120
00:04:14,400 --> 00:04:16,798
and memcache and other services all

121
00:04:16,798 --> 00:04:19,040
generating the one to three terabytes

122
00:04:19,040 --> 00:04:22,639
attacks that we see reported today

123
00:04:22,639 --> 00:04:24,639
and this is just an example of one of

124
00:04:24,639 --> 00:04:25,840
the booters

125
00:04:25,840 --> 00:04:28,320
all the panels start to look a lot alike

126
00:04:28,320 --> 00:04:30,320
generally the prices are about 50

127
00:04:30,320 --> 00:04:32,720
to 100 months for the basic plan if you

128
00:04:32,720 --> 00:04:34,639
want to rent a botnet that gets into the

129
00:04:34,639 --> 00:04:35,919
hundreds of dollars

130
00:04:35,919 --> 00:04:39,520
but udp and tcp synac and udp flood

131
00:04:39,520 --> 00:04:41,600
attacks are relatively cheap

132
00:04:41,600 --> 00:04:43,040
as you'll see in the panel here it

133
00:04:43,040 --> 00:04:45,199
helpfully provides a number of spoof

134
00:04:45,199 --> 00:04:46,000
options

135
00:04:46,000 --> 00:04:48,160
you can spoof digitalocean linode

136
00:04:48,160 --> 00:04:50,080
rackspace as your source

137
00:04:50,080 --> 00:04:52,960
and generally offering 20 or 30 servers

138
00:04:52,960 --> 00:04:54,000
give or take

139
00:04:54,000 --> 00:04:57,280
amongst the again iphm or ip header

140
00:04:57,280 --> 00:04:58,400
modification

141
00:04:58,400 --> 00:05:01,680
uh hosting generally the claims range

142
00:05:01,680 --> 00:05:03,440
from hundreds of gigabits to in this

143
00:05:03,440 --> 00:05:04,639
case hard stressor

144
00:05:04,639 --> 00:05:07,280
and others will advertise two targets or

145
00:05:07,280 --> 00:05:08,639
your money back

146
00:05:08,639 --> 00:05:12,000
uh a text and

147
00:05:12,000 --> 00:05:13,520
you know when you actually look into

148
00:05:13,520 --> 00:05:15,280
who's actually offering

149
00:05:15,280 --> 00:05:17,919
the underlying hosting it really tends

150
00:05:17,919 --> 00:05:18,320
to be

151
00:05:18,320 --> 00:05:21,440
two areas one is there's a range of

152
00:05:21,440 --> 00:05:23,280
companies like privacy servers that

153
00:05:23,280 --> 00:05:24,080
explicitly

154
00:05:24,080 --> 00:05:27,680
advertise generally based in gray area

155
00:05:27,680 --> 00:05:29,759
eastern european and sort of

156
00:05:29,759 --> 00:05:33,759
other like jurisdictions uh in the

157
00:05:33,759 --> 00:05:34,960
reference section at the end we have a

158
00:05:34,960 --> 00:05:36,960
couple of pointers to the overlap with

159
00:05:36,960 --> 00:05:38,560
the bulletproof hosting market which

160
00:05:38,560 --> 00:05:41,280
also talks about these jurisdictions

161
00:05:41,280 --> 00:05:43,360
for other of the hosters they tend to be

162
00:05:43,360 --> 00:05:44,320
layered behind

163
00:05:44,320 --> 00:05:47,360
multiple layers of asn like hosting

164
00:05:47,360 --> 00:05:48,960
domains and ownership

165
00:05:48,960 --> 00:05:52,320
to try to obfuscate or they hide in sort

166
00:05:52,320 --> 00:05:54,000
of an infrastructure as a service

167
00:05:54,000 --> 00:05:56,240
provider or multiple layers of hosting

168
00:05:56,240 --> 00:05:58,639
so the one on the left is absolutely

169
00:05:58,639 --> 00:06:01,039
explicit about what they do

170
00:06:01,039 --> 00:06:02,560
the one on the right is a little more

171
00:06:02,560 --> 00:06:04,880
mysterious they both advertise

172
00:06:04,880 --> 00:06:06,880
they're the leader in ddos mitigation

173
00:06:06,880 --> 00:06:08,880
services and it turns out

174
00:06:08,880 --> 00:06:11,919
we see huge significant share of ddos

175
00:06:11,919 --> 00:06:12,880
originating

176
00:06:12,880 --> 00:06:16,000
from the same hosting company so the

177
00:06:16,000 --> 00:06:17,440
overall problem today

178
00:06:17,440 --> 00:06:20,400
is not a technology problem it is a

179
00:06:20,400 --> 00:06:21,919
technology problem in the sense that the

180
00:06:21,919 --> 00:06:24,080
number of amplifiers is growing driven

181
00:06:24,080 --> 00:06:25,280
by iot

182
00:06:25,280 --> 00:06:27,360
the number of botnets is growing because

183
00:06:27,360 --> 00:06:28,960
iot and cloud

184
00:06:28,960 --> 00:06:31,600
and ddos and bps rates are growing

185
00:06:31,600 --> 00:06:33,680
because well one and two

186
00:06:33,680 --> 00:06:36,000
and you can make money but at the end of

187
00:06:36,000 --> 00:06:36,720
the day

188
00:06:36,720 --> 00:06:38,880
this is an economic problem when it

189
00:06:38,880 --> 00:06:40,800
costs fifty dollars to launch a

190
00:06:40,800 --> 00:06:42,960
two-terabyte ddos attack

191
00:06:42,960 --> 00:06:45,520
and you can obtain ten thousand in

192
00:06:45,520 --> 00:06:46,720
extortion

193
00:06:46,720 --> 00:06:49,199
that's an arbitrage and that money will

194
00:06:49,199 --> 00:06:51,280
continue to drive the ecosystem

195
00:06:51,280 --> 00:06:54,080
unless we change the economics and this

196
00:06:54,080 --> 00:06:56,000
talk really is about ways that we can

197
00:06:56,000 --> 00:06:56,720
identify

198
00:06:56,720 --> 00:06:59,120
track and identify where the iphm is

199
00:06:59,120 --> 00:06:59,919
coming from

200
00:06:59,919 --> 00:07:02,400
and what we can do to help mitigate it

201
00:07:02,400 --> 00:07:04,319
and the final graph on this slide really

202
00:07:04,319 --> 00:07:06,160
is showing the growth right this problem

203
00:07:06,160 --> 00:07:08,400
is not getting better it's getting worse

204
00:07:08,400 --> 00:07:10,639
when we look at aggregate spoofed

205
00:07:10,639 --> 00:07:12,400
traffic over last year

206
00:07:12,400 --> 00:07:14,560
we saw it basically double in size for

207
00:07:14,560 --> 00:07:15,680
the average peaks

208
00:07:15,680 --> 00:07:18,960
we saw across our sample study

209
00:07:18,960 --> 00:07:20,720
so you know there's really six ways to

210
00:07:20,720 --> 00:07:22,400
address the sort of dos

211
00:07:22,400 --> 00:07:24,960
economic problem one way is fix

212
00:07:24,960 --> 00:07:25,840
amplifiers

213
00:07:25,840 --> 00:07:28,560
patch all the botnets and you know

214
00:07:28,560 --> 00:07:30,400
worthy cause we should do it but it's

215
00:07:30,400 --> 00:07:32,800
somewhat of a lost cause over the last

216
00:07:32,800 --> 00:07:34,639
25 years

217
00:07:34,639 --> 00:07:36,639
law enforcement and if you read pacer

218
00:07:36,639 --> 00:07:38,479
documents constant churn

219
00:07:38,479 --> 00:07:41,520
of bot takedowns ddos hosting

220
00:07:41,520 --> 00:07:44,879
you know krebs articles all document and

221
00:07:44,879 --> 00:07:46,879
chronicle this

222
00:07:46,879 --> 00:07:48,879
uh you know we also have seen you know

223
00:07:48,879 --> 00:07:50,800
number of hardware vendors all offering

224
00:07:50,800 --> 00:07:52,080
specialized kit

225
00:07:52,080 --> 00:07:54,800
all of that works but again the problem

226
00:07:54,800 --> 00:07:56,479
isn't technical there's lots of vendors

227
00:07:56,479 --> 00:07:58,800
today we all know how to block ddos

228
00:07:58,800 --> 00:08:00,720
the challenge is how do you change the

229
00:08:00,720 --> 00:08:01,840
economics

230
00:08:01,840 --> 00:08:04,000
when the attackers it's free or fifty

231
00:08:04,000 --> 00:08:05,120
dollars

232
00:08:05,120 --> 00:08:08,240
to the millions of dollars spent on ddos

233
00:08:08,240 --> 00:08:10,240
well this talk really is about the last

234
00:08:10,240 --> 00:08:11,520
two but clearly

235
00:08:11,520 --> 00:08:14,319
cloud and cdn offer a huge amount of

236
00:08:14,319 --> 00:08:15,280
scale

237
00:08:15,280 --> 00:08:16,960
and have played a huge role in

238
00:08:16,960 --> 00:08:18,319
mitigating ddos

239
00:08:18,319 --> 00:08:20,720
for a large number of companies but

240
00:08:20,720 --> 00:08:21,919
largely this talk

241
00:08:21,919 --> 00:08:24,160
is about we need to stop or change the

242
00:08:24,160 --> 00:08:25,039
economics

243
00:08:25,039 --> 00:08:28,560
of ddos at the iphone

244
00:08:28,560 --> 00:08:31,199
at the iphm edge where ddos first enters

245
00:08:31,199 --> 00:08:33,120
the network is smooth traffic

246
00:08:33,120 --> 00:08:35,360
as well as how we can leverage existing

247
00:08:35,360 --> 00:08:36,240
routers

248
00:08:36,240 --> 00:08:38,080
to better scale and block more

249
00:08:38,080 --> 00:08:41,599
economically within victim or downstream

250
00:08:41,599 --> 00:08:44,480
provider networks so we decided to take

251
00:08:44,480 --> 00:08:45,760
the last year

252
00:08:45,760 --> 00:08:48,240
and decided to see if we could trace

253
00:08:48,240 --> 00:08:49,040
iphm

254
00:08:49,040 --> 00:08:52,480
across the network so we used starting

255
00:08:52,480 --> 00:08:53,279
on the right

256
00:08:53,279 --> 00:08:56,240
techniques similar to itf dots and other

257
00:08:56,240 --> 00:08:58,080
sorts of fingerprint methods

258
00:08:58,080 --> 00:09:00,480
where amongst a commercial base of

259
00:09:00,480 --> 00:09:02,720
deployed ddos customers

260
00:09:02,720 --> 00:09:05,120
were able to get fingerprints of the

261
00:09:05,120 --> 00:09:07,200
attack as it arrived

262
00:09:07,200 --> 00:09:09,600
we're then able to use that fingerprint

263
00:09:09,600 --> 00:09:11,600
and look for that traffic as a traffic

264
00:09:11,600 --> 00:09:13,440
arrives at the amplifiers

265
00:09:13,440 --> 00:09:15,519
and actually trace it all the way back

266
00:09:15,519 --> 00:09:16,560
in most cases

267
00:09:16,560 --> 00:09:18,399
in many cases or maybe forty fifty

268
00:09:18,399 --> 00:09:19,760
percent of cases

269
00:09:19,760 --> 00:09:21,920
back to the original hoster in other

270
00:09:21,920 --> 00:09:23,600
cases we could get close

271
00:09:23,600 --> 00:09:25,360
to the regional transit you know the

272
00:09:25,360 --> 00:09:27,040
national ptt in

273
00:09:27,040 --> 00:09:29,040
eastern europe where the traffic was

274
00:09:29,040 --> 00:09:30,080
originating

275
00:09:30,080 --> 00:09:32,480
so again really interesting ability to

276
00:09:32,480 --> 00:09:33,760
leverage commercial base

277
00:09:33,760 --> 00:09:35,920
and fingerprints to actually trace the

278
00:09:35,920 --> 00:09:36,800
traffic

279
00:09:36,800 --> 00:09:39,440
back across the network and try to

280
00:09:39,440 --> 00:09:40,399
quantify

281
00:09:40,399 --> 00:09:42,160
where is it entering and this is kind of

282
00:09:42,160 --> 00:09:44,640
some examples of what that looks like

283
00:09:44,640 --> 00:09:47,600
this is an example of a fingerprint as

284
00:09:47,600 --> 00:09:48,880
seen at the victim

285
00:09:48,880 --> 00:09:50,880
starting you know give or take about 7

286
00:09:50,880 --> 00:09:52,800
p.m in the local time zone

287
00:09:52,800 --> 00:09:55,120
you'll see that traffic dropped uh you

288
00:09:55,120 --> 00:09:57,040
know within the shaded red box

289
00:09:57,040 --> 00:10:01,040
as the customer essentially went offline

290
00:10:01,040 --> 00:10:04,240
for a period of several hours this dos

291
00:10:04,240 --> 00:10:05,360
attack consisted

292
00:10:05,360 --> 00:10:08,480
of amplified ddos mostly fragments

293
00:10:08,480 --> 00:10:12,480
from about 65 000 dns amplifiers

294
00:10:12,480 --> 00:10:14,480
and we'll look in the next slide and by

295
00:10:14,480 --> 00:10:15,680
the way i should mention that you know

296
00:10:15,680 --> 00:10:16,480
what's interesting

297
00:10:16,480 --> 00:10:18,959
this is the dos attack i think was

298
00:10:18,959 --> 00:10:21,200
solved but it likely was solved by the

299
00:10:21,200 --> 00:10:22,800
customer being blackholed

300
00:10:22,800 --> 00:10:24,560
and all traffic being dropped to the

301
00:10:24,560 --> 00:10:26,079
customer so

302
00:10:26,079 --> 00:10:27,760
this is actually i think the interesting

303
00:10:27,760 --> 00:10:29,760
bit this is looking

304
00:10:29,760 --> 00:10:33,600
far upstream of that victim customer

305
00:10:33,600 --> 00:10:36,560
and applying the same ddos same ddos

306
00:10:36,560 --> 00:10:37,440
hash

307
00:10:37,440 --> 00:10:39,680
amongst a range of different parts of

308
00:10:39,680 --> 00:10:41,360
networks and routers

309
00:10:41,360 --> 00:10:43,200
what we found when we look at this hash

310
00:10:43,200 --> 00:10:44,640
and repeat this process

311
00:10:44,640 --> 00:10:47,200
over tens of thousands of attacks we

312
00:10:47,200 --> 00:10:47,920
identify

313
00:10:47,920 --> 00:10:50,399
a fairly small number of hosting

314
00:10:50,399 --> 00:10:51,360
companies

315
00:10:51,360 --> 00:10:53,600
regional transit localized bits of the

316
00:10:53,600 --> 00:10:56,079
world where the attacks are originating

317
00:10:56,079 --> 00:10:58,839
in this case hosting provider 23

318
00:10:58,839 --> 00:11:00,160
anonymized

319
00:11:00,160 --> 00:11:02,399
was generating for the period about 14

320
00:11:02,399 --> 00:11:04,399
million uh two different sort of attack

321
00:11:04,399 --> 00:11:07,200
vectors 14 million packets per second

322
00:11:07,200 --> 00:11:09,839
about another four or six coming out of

323
00:11:09,839 --> 00:11:11,360
a regional provider

324
00:11:11,360 --> 00:11:14,800
all told just from this trace one to two

325
00:11:14,800 --> 00:11:16,399
terabits of traffic going to the

326
00:11:16,399 --> 00:11:17,600
downstream

327
00:11:17,600 --> 00:11:20,000
but again we're able to identify the

328
00:11:20,000 --> 00:11:22,079
specific points in the network where the

329
00:11:22,079 --> 00:11:23,120
original spoofed

330
00:11:23,120 --> 00:11:26,240
traffic was entering and we

331
00:11:26,240 --> 00:11:28,480
further as i'll talk about in the next

332
00:11:28,480 --> 00:11:29,680
several slides

333
00:11:29,680 --> 00:11:31,839
we're able to use fingerprints of the

334
00:11:31,839 --> 00:11:34,240
different booters and iphm hosting

335
00:11:34,240 --> 00:11:37,680
to further narrow down the likely origin

336
00:11:37,680 --> 00:11:41,040
within regional transit and

337
00:11:41,040 --> 00:11:43,279
other provider networks so this is just

338
00:11:43,279 --> 00:11:45,200
kind of a big picture view

339
00:11:45,200 --> 00:11:47,839
that is looking not just at the attack

340
00:11:47,839 --> 00:11:49,200
that we fingerprinted

341
00:11:49,200 --> 00:11:51,440
in the last two slides but this is an

342
00:11:51,440 --> 00:11:52,480
aggregate view

343
00:11:52,480 --> 00:11:54,639
this is looking at where does ddos come

344
00:11:54,639 --> 00:11:57,040
from and when you fingerprint the ddos

345
00:11:57,040 --> 00:11:57,600
tax

346
00:11:57,600 --> 00:12:01,360
back to the origin interfaces origin

347
00:12:01,360 --> 00:12:04,800
hosting customers it's not a huge number

348
00:12:04,800 --> 00:12:08,000
now 50 is order of magnitude number it

349
00:12:08,000 --> 00:12:09,040
might be 55

350
00:12:09,040 --> 00:12:11,920
it might be 60 but it's not thousands it

351
00:12:11,920 --> 00:12:13,680
turns out that the overall

352
00:12:13,680 --> 00:12:16,000
ddos and even bulletproof hosting

353
00:12:16,000 --> 00:12:18,399
ecosystem is not huge it really

354
00:12:18,399 --> 00:12:20,800
is specialized providers offering these

355
00:12:20,800 --> 00:12:22,160
services

356
00:12:22,160 --> 00:12:24,800
and again we can't just try uh tribute

357
00:12:24,800 --> 00:12:25,839
motive

358
00:12:25,839 --> 00:12:27,600
some of these are advertising some of

359
00:12:27,600 --> 00:12:29,279
these clearly are in the business of

360
00:12:29,279 --> 00:12:30,800
providing ddos

361
00:12:30,800 --> 00:12:32,800
others it is a little more mysterious

362
00:12:32,800 --> 00:12:34,720
whether this is intentional

363
00:12:34,720 --> 00:12:37,560
or in inadvertent uh leaving you know

364
00:12:37,560 --> 00:12:39,360
bcp38 off

365
00:12:39,360 --> 00:12:42,399
and they have some bad customers but as

366
00:12:42,399 --> 00:12:43,440
i said we

367
00:12:43,440 --> 00:12:46,160
wanted to be able to not only use sort

368
00:12:46,160 --> 00:12:47,200
of ipfix

369
00:12:47,200 --> 00:12:49,600
in netflow to trace ddos back to the

370
00:12:49,600 --> 00:12:50,399
origin

371
00:12:50,399 --> 00:12:52,160
but because we don't have complete

372
00:12:52,160 --> 00:12:53,839
coverage of the network

373
00:12:53,839 --> 00:12:55,360
we wanted to be able to use other

374
00:12:55,360 --> 00:12:57,040
techniques like fingerprinting the

375
00:12:57,040 --> 00:12:57,920
booters

376
00:12:57,920 --> 00:13:00,320
to be able to get a better idea of

377
00:13:00,320 --> 00:13:01,680
likely origin

378
00:13:01,680 --> 00:13:03,600
within some of the networks where we did

379
00:13:03,600 --> 00:13:04,959
not have visibility

380
00:13:04,959 --> 00:13:07,360
so it turns out for about the 100 or so

381
00:13:07,360 --> 00:13:09,440
commercial booters

382
00:13:09,440 --> 00:13:10,959
they all have sort of distinct

383
00:13:10,959 --> 00:13:13,440
fingerprints and what i mean by

384
00:13:13,440 --> 00:13:16,320
a fingerprint is when you build up a

385
00:13:16,320 --> 00:13:17,360
list of dns

386
00:13:17,360 --> 00:13:20,399
amplifiers of memcache amplifiers of

387
00:13:20,399 --> 00:13:21,760
cldap

388
00:13:21,760 --> 00:13:24,639
every list is slightly different and in

389
00:13:24,639 --> 00:13:26,720
particular what's really interesting

390
00:13:26,720 --> 00:13:28,880
is to look at the invalid ips that are

391
00:13:28,880 --> 00:13:30,000
being used

392
00:13:30,000 --> 00:13:32,000
because the invalid ips really give an

393
00:13:32,000 --> 00:13:34,000
indication of when the list was

394
00:13:34,000 --> 00:13:37,279
collected we actually as nokia monitor

395
00:13:37,279 --> 00:13:40,240
and track all amplifiers and actually

396
00:13:40,240 --> 00:13:42,000
date when amplifiers enter

397
00:13:42,000 --> 00:13:45,040
or leave the internet so amplifier plist

398
00:13:45,040 --> 00:13:46,399
really interesting way

399
00:13:46,399 --> 00:13:49,600
to identify looking at flow or pcaps of

400
00:13:49,600 --> 00:13:50,399
attacks

401
00:13:50,399 --> 00:13:52,959
which amplifier uh which jumi booter is

402
00:13:52,959 --> 00:13:54,160
being used

403
00:13:54,160 --> 00:13:57,360
similarly when you use a d dns

404
00:13:57,360 --> 00:14:00,079
amplification payload for all records

405
00:14:00,079 --> 00:14:01,920
you get to choose what domain name to

406
00:14:01,920 --> 00:14:03,120
query

407
00:14:03,120 --> 00:14:06,959
in what i think may be an ironic choice

408
00:14:06,959 --> 00:14:09,440
a number of the booters have chosen

409
00:14:09,440 --> 00:14:11,199
peace corps.gov

410
00:14:11,199 --> 00:14:13,360
as the name that they'll query to

411
00:14:13,360 --> 00:14:16,000
generate the amplified dns

412
00:14:16,000 --> 00:14:17,760
similarly many of the booters will use

413
00:14:17,760 --> 00:14:20,639
icmp during the attack to monitor

414
00:14:20,639 --> 00:14:22,880
the choice of iphm and others i'll

415
00:14:22,880 --> 00:14:23,839
identify

416
00:14:23,839 --> 00:14:25,920
so all of these are techniques that when

417
00:14:25,920 --> 00:14:27,680
you look at live attacks

418
00:14:27,680 --> 00:14:30,000
you can significantly narrow down the

419
00:14:30,000 --> 00:14:31,519
choice of booters

420
00:14:31,519 --> 00:14:33,279
though i will say many of the booters

421
00:14:33,279 --> 00:14:35,040
are actually the same company

422
00:14:35,040 --> 00:14:37,440
they often if you read some of the uh

423
00:14:37,440 --> 00:14:39,519
you know rest reports will offer five

424
00:14:39,519 --> 00:14:42,000
six different companies with slightly

425
00:14:42,000 --> 00:14:43,600
different names

426
00:14:43,600 --> 00:14:46,079
and there is absolutely a significant

427
00:14:46,079 --> 00:14:47,600
amount of code sharing

428
00:14:47,600 --> 00:14:49,920
and amplifier sharing so it's sometimes

429
00:14:49,920 --> 00:14:51,600
hard to tell exactly

430
00:14:51,600 --> 00:14:53,120
when they're different companies and

431
00:14:53,120 --> 00:14:55,839
under different administrative control

432
00:14:55,839 --> 00:14:58,720
so we want to be able to identify and

433
00:14:58,720 --> 00:15:01,120
fingerprint the actual booters

434
00:15:01,120 --> 00:15:02,880
and i think we're able to do a fairly

435
00:15:02,880 --> 00:15:04,959
reasonable job of doing that

436
00:15:04,959 --> 00:15:07,920
the other thing we wanted to do is can

437
00:15:07,920 --> 00:15:08,320
we

438
00:15:08,320 --> 00:15:12,240
broadly detect when there is spoofed

439
00:15:12,240 --> 00:15:13,839
traffic occurring

440
00:15:13,839 --> 00:15:16,079
and again there are many papers cited in

441
00:15:16,079 --> 00:15:17,519
the reference that touch on different

442
00:15:17,519 --> 00:15:19,199
aspects of this i don't think

443
00:15:19,199 --> 00:15:21,519
any one of these things is novel in

444
00:15:21,519 --> 00:15:22,720
itself

445
00:15:22,720 --> 00:15:25,199
but the important bit as i said earlier

446
00:15:25,199 --> 00:15:26,000
is these are all

447
00:15:26,000 --> 00:15:28,480
queries that anyone from you know dozens

448
00:15:28,480 --> 00:15:30,320
of different vendors supplying

449
00:15:30,320 --> 00:15:32,800
flow tools or others these are queries

450
00:15:32,800 --> 00:15:33,519
you can run

451
00:15:33,519 --> 00:15:37,199
in your network and identify the sources

452
00:15:37,199 --> 00:15:40,480
it is absolutely the case that

453
00:15:40,480 --> 00:15:42,639
several of these hosting companies are

454
00:15:42,639 --> 00:15:43,680
customers

455
00:15:43,680 --> 00:15:46,880
of many of the uh nanog attendees

456
00:15:46,880 --> 00:15:48,560
so these are your customers this is

457
00:15:48,560 --> 00:15:50,079
traffic that you can detect

458
00:15:50,079 --> 00:15:52,079
and of course the several ways that we

459
00:15:52,079 --> 00:15:54,240
use detect this is number one

460
00:15:54,240 --> 00:15:56,639
looking at invalid or improbable port

461
00:15:56,639 --> 00:15:57,600
combinations

462
00:15:57,600 --> 00:16:00,240
now this is a hundred percent some cdn

463
00:16:00,240 --> 00:16:02,079
and others do interesting bits

464
00:16:02,079 --> 00:16:04,320
but generally looking for xbox as a

465
00:16:04,320 --> 00:16:05,360
source port

466
00:16:05,360 --> 00:16:07,680
and looking for traffic going to you

467
00:16:07,680 --> 00:16:10,880
know dns or memcache or ldap

468
00:16:10,880 --> 00:16:13,040
is generally pretty good if you see

469
00:16:13,040 --> 00:16:14,880
large volumes of traffic

470
00:16:14,880 --> 00:16:17,440
with these port combinations it is

471
00:16:17,440 --> 00:16:18,000
almost

472
00:16:18,000 --> 00:16:21,040
you know high probability representing

473
00:16:21,040 --> 00:16:22,639
spoofed or iphm

474
00:16:22,639 --> 00:16:26,399
traffic similarly a lot of iphm

475
00:16:26,399 --> 00:16:29,120
uses really improbable header fields

476
00:16:29,120 --> 00:16:31,279
these are crazy ttls

477
00:16:31,279 --> 00:16:35,519
sequence windows tcp options and so on

478
00:16:35,519 --> 00:16:38,320
in fact i mean ttl is really interesting

479
00:16:38,320 --> 00:16:38,639
now

480
00:16:38,639 --> 00:16:40,959
it doesn't have to be this way but again

481
00:16:40,959 --> 00:16:43,680
this talk is not about theoretical ddos

482
00:16:43,680 --> 00:16:46,399
it's not about nation state ddos this

483
00:16:46,399 --> 00:16:46,800
talk

484
00:16:46,800 --> 00:16:49,199
is about the vast majority of ddos we

485
00:16:49,199 --> 00:16:50,160
see today

486
00:16:50,160 --> 00:16:52,399
that's taking customers offline

487
00:16:52,399 --> 00:16:53,680
extortion temps

488
00:16:53,680 --> 00:16:55,920
gamers things that are really causing

489
00:16:55,920 --> 00:16:57,040
pain

490
00:16:57,040 --> 00:17:00,160
for the vast majority of spoofed traffic

491
00:17:00,160 --> 00:17:01,199
that we see

492
00:17:01,199 --> 00:17:04,559
the ttls are done really poorly

493
00:17:04,559 --> 00:17:06,480
normally the internet has gotten really

494
00:17:06,480 --> 00:17:09,039
small content is not coming from

495
00:17:09,039 --> 00:17:11,839
thousands of locations it is coming from

496
00:17:11,839 --> 00:17:12,880
cdn

497
00:17:12,880 --> 00:17:15,760
pretty closely aligned to provider's

498
00:17:15,760 --> 00:17:17,280
edge network

499
00:17:17,280 --> 00:17:19,199
what we're looking at in the left graph

500
00:17:19,199 --> 00:17:21,599
is the ttl we expect in a normal sort of

501
00:17:21,599 --> 00:17:22,959
consumer network

502
00:17:22,959 --> 00:17:25,199
you know ttls are normally coming pretty

503
00:17:25,199 --> 00:17:27,359
close around the original linux

504
00:17:27,359 --> 00:17:30,240
cp devices windows and for whatever

505
00:17:30,240 --> 00:17:33,520
reason cloudfront uses either ttl range

506
00:17:33,520 --> 00:17:35,919
but again pretty straightforward in ttl

507
00:17:35,919 --> 00:17:38,000
sort of distribution we see

508
00:17:38,000 --> 00:17:41,120
for traffic arriving in most consumer

509
00:17:41,120 --> 00:17:42,720
networks in europe us

510
00:17:42,720 --> 00:17:46,320
asia on the right in red is what a ddos

511
00:17:46,320 --> 00:17:46,960
looks like

512
00:17:46,960 --> 00:17:49,280
this is randomized ttl with the 240

513
00:17:49,280 --> 00:17:50,240
component

514
00:17:50,240 --> 00:17:53,200
again this is really not hard to spot

515
00:17:53,200 --> 00:17:55,280
when spoofed traffic is arriving in a

516
00:17:55,280 --> 00:17:55,919
network

517
00:17:55,919 --> 00:17:57,840
to identify which customers which

518
00:17:57,840 --> 00:18:00,240
interfaces or which peers

519
00:18:00,240 --> 00:18:04,799
are originating the spoofed traffic

520
00:18:05,120 --> 00:18:07,679
you know similarly when we looked at

521
00:18:07,679 --> 00:18:09,360
identifying where

522
00:18:09,360 --> 00:18:11,520
ipgm spoof traffic was entering the

523
00:18:11,520 --> 00:18:13,679
network we also looked at things like

524
00:18:13,679 --> 00:18:14,640
topology

525
00:18:14,640 --> 00:18:18,000
and ciders and really it's a combination

526
00:18:18,000 --> 00:18:21,039
of all of these techniques you know

527
00:18:21,039 --> 00:18:23,280
a u.s consumer provider is not

528
00:18:23,280 --> 00:18:24,880
originating traffic out of asia

529
00:18:24,880 --> 00:18:27,520
right this is not uh i think super

530
00:18:27,520 --> 00:18:28,640
complicated

531
00:18:28,640 --> 00:18:31,039
but some very simple code analysis of

532
00:18:31,039 --> 00:18:32,080
ipfix

533
00:18:32,080 --> 00:18:35,120
provides really high classification

534
00:18:35,120 --> 00:18:38,480
of iphm and just for example

535
00:18:38,480 --> 00:18:41,360
you know typical synfloods they will use

536
00:18:41,360 --> 00:18:43,520
and just sequentially iterate from

537
00:18:43,520 --> 00:18:47,200
one to 255 you know the entire v4

538
00:18:47,200 --> 00:18:48,720
address space

539
00:18:48,720 --> 00:18:51,840
and again it really is i think ipgm

540
00:18:51,840 --> 00:18:53,919
that is root of all this there is

541
00:18:53,919 --> 00:18:55,120
botnets out there

542
00:18:55,120 --> 00:18:58,000
but the vast majority of spoofed traffic

543
00:18:58,000 --> 00:18:59,600
of simply smooth flood

544
00:18:59,600 --> 00:19:02,080
like this where they're doing a synac

545
00:19:02,080 --> 00:19:03,440
syn flight attack

546
00:19:03,440 --> 00:19:06,400
or reflector attack is all coming from a

547
00:19:06,400 --> 00:19:08,240
very small number

548
00:19:08,240 --> 00:19:11,520
of iphm hosters so

549
00:19:11,520 --> 00:19:13,679
i think we were able to successfully

550
00:19:13,679 --> 00:19:14,960
leverage uh

551
00:19:14,960 --> 00:19:17,200
ddos fingerprinting we're successfully

552
00:19:17,200 --> 00:19:19,280
able to track ddos back across the

553
00:19:19,280 --> 00:19:20,400
network

554
00:19:20,400 --> 00:19:23,200
we're able to leverage some iphm

555
00:19:23,200 --> 00:19:25,200
detection techniques to identify the

556
00:19:25,200 --> 00:19:26,720
major hosters

557
00:19:26,720 --> 00:19:29,200
and to narrow down with the fingerprints

558
00:19:29,200 --> 00:19:31,280
where we thought the original ddos was

559
00:19:31,280 --> 00:19:33,440
originating in the network

560
00:19:33,440 --> 00:19:35,520
with all that said we were left with a

561
00:19:35,520 --> 00:19:37,200
couple of mysteries

562
00:19:37,200 --> 00:19:39,600
one of the mysteries is our amplifier

563
00:19:39,600 --> 00:19:41,280
lists are different from almost

564
00:19:41,280 --> 00:19:43,440
everything we see being used in attacks

565
00:19:43,440 --> 00:19:45,919
and we're never quite sure why

566
00:19:45,919 --> 00:19:47,919
we also never quite understood why there

567
00:19:47,919 --> 00:19:49,360
was so much icmp

568
00:19:49,360 --> 00:19:52,799
associated with ddos and lastly

569
00:19:52,799 --> 00:19:55,440
you know when you actually look at the

570
00:19:55,440 --> 00:19:57,200
megabits per second

571
00:19:57,200 --> 00:20:00,240
50 60 to 100 uh

572
00:20:00,240 --> 00:20:02,240
megabit excuse me mega packets per

573
00:20:02,240 --> 00:20:05,280
second coming out of iphone hosting

574
00:20:05,280 --> 00:20:07,840
you know that has at least the potential

575
00:20:07,840 --> 00:20:08,720
of being

576
00:20:08,720 --> 00:20:11,840
5x to get us into 10 20 tera

577
00:20:11,840 --> 00:20:15,360
of ddos potential traffic yet cloudfront

578
00:20:15,360 --> 00:20:16,400
and others who

579
00:20:16,400 --> 00:20:18,000
you know have done some nice blogs on

580
00:20:18,000 --> 00:20:19,919
this we're still seeing really two to

581
00:20:19,919 --> 00:20:21,919
three being the high water mark

582
00:20:21,919 --> 00:20:25,120
so the question is why well the first

583
00:20:25,120 --> 00:20:26,480
thing you'll notice is that

584
00:20:26,480 --> 00:20:28,000
things like memcache have gotten a lot

585
00:20:28,000 --> 00:20:29,520
harder they're really

586
00:20:29,520 --> 00:20:31,280
you know there are a lot of amplifiers

587
00:20:31,280 --> 00:20:32,880
out there but they're not infinite

588
00:20:32,880 --> 00:20:34,880
and particularly with m cash the number

589
00:20:34,880 --> 00:20:36,640
has gone down

590
00:20:36,640 --> 00:20:38,480
the other thing that becomes clear is

591
00:20:38,480 --> 00:20:40,240
there absolutely are a number of

592
00:20:40,240 --> 00:20:41,280
providers

593
00:20:41,280 --> 00:20:43,840
who are rate limiting policing filtering

594
00:20:43,840 --> 00:20:44,640
your pf

595
00:20:44,640 --> 00:20:47,679
and blocking traffic from experience

596
00:20:47,679 --> 00:20:48,559
where we obtained

597
00:20:48,559 --> 00:20:50,400
accounts on all the booters they're

598
00:20:50,400 --> 00:20:52,480
notoriously unreliable

599
00:20:52,480 --> 00:20:55,520
and most of the attacks are not using

600
00:20:55,520 --> 00:20:58,640
all iphm at once it really is the

601
00:20:58,640 --> 00:21:00,000
aggregate iphm

602
00:21:00,000 --> 00:21:03,039
capacity is quite large but the booters

603
00:21:03,039 --> 00:21:03,840
are using

604
00:21:03,840 --> 00:21:05,440
you know only portions of the

605
00:21:05,440 --> 00:21:07,120
infrastructure

606
00:21:07,120 --> 00:21:08,960
the final and i think you know somewhat

607
00:21:08,960 --> 00:21:10,240
interesting reason

608
00:21:10,240 --> 00:21:12,480
is that when you look at the iphone

609
00:21:12,480 --> 00:21:13,280
traffic

610
00:21:13,280 --> 00:21:16,320
it usually is done really poorly

611
00:21:16,320 --> 00:21:20,000
and by that i mean about 50 up to

612
00:21:20,000 --> 00:21:24,240
50 or more of the amplifiers are invalid

613
00:21:24,240 --> 00:21:25,919
and you'll see this if you look at any

614
00:21:25,919 --> 00:21:27,280
ddos attack

615
00:21:27,280 --> 00:21:29,679
whether it's using ldap or ntp and you

616
00:21:29,679 --> 00:21:31,360
see unreachable come back

617
00:21:31,360 --> 00:21:33,200
is a great hint that someone has an

618
00:21:33,200 --> 00:21:34,960
outdated list

619
00:21:34,960 --> 00:21:37,919
so it's pretty clear a fairly large

620
00:21:37,919 --> 00:21:39,679
number of the booters out there this is

621
00:21:39,679 --> 00:21:41,600
not super sophisticated

622
00:21:41,600 --> 00:21:43,520
this is not you know high-end criminal

623
00:21:43,520 --> 00:21:45,600
gangs this is

624
00:21:45,600 --> 00:21:48,320
you know fairly low-level stuff that is

625
00:21:48,320 --> 00:21:49,280
able to generate

626
00:21:49,280 --> 00:21:53,280
multi-terabit attacks using shared code

627
00:21:53,280 --> 00:21:55,360
uh for you know a few hundred dollars a

628
00:21:55,360 --> 00:21:57,039
month on iphm

629
00:21:57,039 --> 00:21:59,840
uh hosters and fifty dollars a month if

630
00:21:59,840 --> 00:22:00,559
you buy your

631
00:22:00,559 --> 00:22:04,000
buy a stressor account so i think one of

632
00:22:04,000 --> 00:22:04,960
the key

633
00:22:04,960 --> 00:22:08,480
messages from this talk is that the

634
00:22:08,480 --> 00:22:11,200
particularly the spoofed iphm deep ddos

635
00:22:11,200 --> 00:22:12,640
problem is one that

636
00:22:12,640 --> 00:22:15,200
uh of economics we need to do a better

637
00:22:15,200 --> 00:22:15,679
job

638
00:22:15,679 --> 00:22:17,679
of an industry of trying to block the

639
00:22:17,679 --> 00:22:19,440
original spoof traffic

640
00:22:19,440 --> 00:22:22,720
uh before it arrives at the amplifiers

641
00:22:22,720 --> 00:22:24,480
and the second part of this talk as i

642
00:22:24,480 --> 00:22:26,480
wrap up is that

643
00:22:26,480 --> 00:22:28,720
we also now have the ability given the

644
00:22:28,720 --> 00:22:30,320
advances in routers

645
00:22:30,320 --> 00:22:33,600
and software using flowspec and netconf

646
00:22:33,600 --> 00:22:36,880
to block the vast majority of ddos as it

647
00:22:36,880 --> 00:22:38,559
arrives at end networks

648
00:22:38,559 --> 00:22:41,760
you know assuming upstream capacity and

649
00:22:41,760 --> 00:22:43,120
we'll talk about the next few slides

650
00:22:43,120 --> 00:22:45,120
we're better part of the last two years

651
00:22:45,120 --> 00:22:47,120
it's been spent working on bits of this

652
00:22:47,120 --> 00:22:48,559
technology

653
00:22:48,559 --> 00:22:50,960
but it really is the case that amplifier

654
00:22:50,960 --> 00:22:53,039
attacks super easy to block and i think

655
00:22:53,039 --> 00:22:53,679
many

656
00:22:53,679 --> 00:22:56,240
isps are already blocking port and

657
00:22:56,240 --> 00:22:58,320
packet length combinations

658
00:22:58,320 --> 00:23:00,720
but it turns out that you can also block

659
00:23:00,720 --> 00:23:01,360
the more

660
00:23:01,360 --> 00:23:04,640
complicated attacks and typically

661
00:23:04,640 --> 00:23:06,320
as i said amplification attacks are

662
00:23:06,320 --> 00:23:08,000
really straightforward to block directly

663
00:23:08,000 --> 00:23:09,039
on routers

664
00:23:09,039 --> 00:23:11,760
many of you and nano already are it

665
00:23:11,760 --> 00:23:12,799
turns out even

666
00:23:12,799 --> 00:23:16,159
sin ack attacks where the attacker

667
00:23:16,159 --> 00:23:20,000
will not amplify but spoof the victim ip

668
00:23:20,000 --> 00:23:22,400
bounce it off of akamai bounce it off of

669
00:23:22,400 --> 00:23:24,400
google to hide the origins

670
00:23:24,400 --> 00:23:27,360
and try to launch again sort of a tcp

671
00:23:27,360 --> 00:23:28,880
state flood attack

672
00:23:28,880 --> 00:23:31,520
against the end load balancer firewall

673
00:23:31,520 --> 00:23:33,039
these attacks are also

674
00:23:33,039 --> 00:23:34,880
i think relatively straightforward to

675
00:23:34,880 --> 00:23:37,760
block with about 2 000 filters

676
00:23:37,760 --> 00:23:40,640
as well as the randomized flood attacks

677
00:23:40,640 --> 00:23:41,679
i won't talk about

678
00:23:41,679 --> 00:23:43,919
botnets too much in this talk and save

679
00:23:43,919 --> 00:23:45,279
that for another time

680
00:23:45,279 --> 00:23:46,480
these are really though some of the

681
00:23:46,480 --> 00:23:49,120
hardest attacks to block but also you

682
00:23:49,120 --> 00:23:51,039
can do a reasonably good job

683
00:23:51,039 --> 00:23:53,919
in about two thousand filter entries

684
00:23:53,919 --> 00:23:55,600
traditionally of course the challenge is

685
00:23:55,600 --> 00:23:56,480
upstream right

686
00:23:56,480 --> 00:23:58,559
you know if you've got a one terabyte

687
00:23:58,559 --> 00:24:00,640
link or you know hundred gigabit link

688
00:24:00,640 --> 00:24:03,760
uh tenta uh down you know no router no

689
00:24:03,760 --> 00:24:04,400
software

690
00:24:04,400 --> 00:24:06,960
in the world is cleverer enough to block

691
00:24:06,960 --> 00:24:07,520
it

692
00:24:07,520 --> 00:24:10,320
but you can use routers to block traffic

693
00:24:10,320 --> 00:24:11,440
of your provider

694
00:24:11,440 --> 00:24:14,240
to downstream customers some of the

695
00:24:14,240 --> 00:24:15,520
challenges really are

696
00:24:15,520 --> 00:24:18,159
of course the upstream capacity and it

697
00:24:18,159 --> 00:24:20,159
really is an issue now or a game of how

698
00:24:20,159 --> 00:24:22,880
many simultaneous attacks can you block

699
00:24:22,880 --> 00:24:24,799
and you know typically one of the issues

700
00:24:24,799 --> 00:24:26,880
for providers is safety

701
00:24:26,880 --> 00:24:28,880
that is you know do you actually does

702
00:24:28,880 --> 00:24:30,880
the guys who run the routers trust the

703
00:24:30,880 --> 00:24:32,080
security team to install

704
00:24:32,080 --> 00:24:34,960
filters so there's organizational issues

705
00:24:34,960 --> 00:24:35,760
there's always

706
00:24:35,760 --> 00:24:38,320
issues around the line speed impact but

707
00:24:38,320 --> 00:24:40,400
you know things have gotten a lot better

708
00:24:40,400 --> 00:24:41,360
in the last five

709
00:24:41,360 --> 00:24:44,159
ten years and we have a number of

710
00:24:44,159 --> 00:24:44,960
customers

711
00:24:44,960 --> 00:24:47,760
largely using just the routers to be

712
00:24:47,760 --> 00:24:48,799
able to block

713
00:24:48,799 --> 00:24:52,000
uh significant portions of ddos traffic

714
00:24:52,000 --> 00:24:53,679
so i'll wrap up with just kind of the

715
00:24:53,679 --> 00:24:55,039
last slide

716
00:24:55,039 --> 00:24:57,919
uh you know it's been 25 years of the

717
00:24:57,919 --> 00:24:58,480
same

718
00:24:58,480 --> 00:25:01,120
attacks given the same types of talks

719
00:25:01,120 --> 00:25:02,000
about

720
00:25:02,000 --> 00:25:05,440
amplified dns amplified cldap

721
00:25:05,440 --> 00:25:08,080
this is you know a community problem

722
00:25:08,080 --> 00:25:09,360
we're not going to solve this through

723
00:25:09,360 --> 00:25:10,240
law enforcement

724
00:25:10,240 --> 00:25:12,080
we're not going to solve this through

725
00:25:12,080 --> 00:25:14,080
closing down all the booters and

726
00:25:14,080 --> 00:25:16,880
closing down all the hosting instead

727
00:25:16,880 --> 00:25:18,960
there are really simple queries that all

728
00:25:18,960 --> 00:25:20,159
of you can run

729
00:25:20,159 --> 00:25:23,679
looking at ttl port combinations

730
00:25:23,679 --> 00:25:25,919
queries that will identify where spoof

731
00:25:25,919 --> 00:25:27,520
traffic is entering the network

732
00:25:27,520 --> 00:25:30,159
on its way to amplifiers and these are

733
00:25:30,159 --> 00:25:31,120
queries you can

734
00:25:31,120 --> 00:25:33,679
gently share with your peers as you

735
00:25:33,679 --> 00:25:36,080
negotiate peering agreements and others

736
00:25:36,080 --> 00:25:37,520
but as a community we have the

737
00:25:37,520 --> 00:25:40,080
opportunity to block the vast majority

738
00:25:40,080 --> 00:25:40,480
of

739
00:25:40,480 --> 00:25:44,159
amplified ddos and lastly

740
00:25:44,159 --> 00:25:46,640
you know we are working with a number of

741
00:25:46,640 --> 00:25:48,880
other vendors and other carriers

742
00:25:48,880 --> 00:25:51,279
you know the technology is really so

743
00:25:51,279 --> 00:25:52,960
close with grpc

744
00:25:52,960 --> 00:25:56,880
ipfix netflow flowspec combined with

745
00:25:56,880 --> 00:25:59,200
a number of vendors are working on much

746
00:25:59,200 --> 00:26:00,320
faster whether it be

747
00:26:00,320 --> 00:26:03,919
grpc or ib fix export of data

748
00:26:03,919 --> 00:26:06,080
so we can detect and block ddos much

749
00:26:06,080 --> 00:26:07,600
faster

750
00:26:07,600 --> 00:26:08,960
you know we are still working with a

751
00:26:08,960 --> 00:26:11,600
number of vendors on low latency filter

752
00:26:11,600 --> 00:26:12,480
operations

753
00:26:12,480 --> 00:26:14,799
you know how fast can you install and

754
00:26:14,799 --> 00:26:16,159
remove filters

755
00:26:16,159 --> 00:26:18,480
in response to dynamic and changing

756
00:26:18,480 --> 00:26:20,000
attacks

757
00:26:20,000 --> 00:26:22,400
and lastly you know happy to talk

758
00:26:22,400 --> 00:26:24,880
offline with folks we're working within

759
00:26:24,880 --> 00:26:25,840
the itf

760
00:26:25,840 --> 00:26:28,960
and other vendors things like ttl

761
00:26:28,960 --> 00:26:31,919
as i showed earlier incredibly powerful

762
00:26:31,919 --> 00:26:34,480
if we get ttl within flowspec

763
00:26:34,480 --> 00:26:36,320
combined with a few other features like

764
00:26:36,320 --> 00:26:38,080
filtering order prefix list and

765
00:26:38,080 --> 00:26:40,720
so on so that's quick summary of the

766
00:26:40,720 --> 00:26:41,360
talk

767
00:26:41,360 --> 00:26:44,159
i have a number of references at the end

768
00:26:44,159 --> 00:26:45,120
of the deck

769
00:26:45,120 --> 00:26:47,679
and we'll be happy to answer just a few

770
00:26:47,679 --> 00:26:50,159
questions

771
00:26:51,360 --> 00:26:52,960
all right thank you craig for your

772
00:26:52,960 --> 00:26:55,600
presentation uh we have a few questions

773
00:26:55,600 --> 00:26:56,480
in the queue

774
00:26:56,480 --> 00:26:58,880
um the first one is actually my own

775
00:26:58,880 --> 00:26:59,600
question

776
00:26:59,600 --> 00:27:02,799
um while strict rpf

777
00:27:02,799 --> 00:27:06,559
is not an option for many isps to run

778
00:27:06,559 --> 00:27:08,000
against their customers

779
00:27:08,000 --> 00:27:09,840
are there any providers actively

780
00:27:09,840 --> 00:27:11,600
examining flow data

781
00:27:11,600 --> 00:27:14,000
for large volumes of traffic coming from

782
00:27:14,000 --> 00:27:16,159
their customers

783
00:27:16,159 --> 00:27:18,559
uh you know i think we have been working

784
00:27:18,559 --> 00:27:20,000
with some of our customers

785
00:27:20,000 --> 00:27:23,600
who are actively doing that but

786
00:27:23,600 --> 00:27:25,919
i will say that there are a fair number

787
00:27:25,919 --> 00:27:28,080
of providers as i mentioned in the talk

788
00:27:28,080 --> 00:27:29,279
that that aren't

789
00:27:29,279 --> 00:27:31,039
i think part of the goal of this talk

790
00:27:31,039 --> 00:27:33,120
again is just to reiterate that

791
00:27:33,120 --> 00:27:35,200
there are some very basic queries that

792
00:27:35,200 --> 00:27:37,360
you can use with any netflow vendor

793
00:27:37,360 --> 00:27:40,960
using ttl using cider to be able to see

794
00:27:40,960 --> 00:27:42,159
this stuff

795
00:27:42,159 --> 00:27:44,480
and again you know this is just uh it's

796
00:27:44,480 --> 00:27:46,159
largely an economic problem

797
00:27:46,159 --> 00:27:48,159
as we continue to have this great

798
00:27:48,159 --> 00:27:52,159
disparity between the cost of ddos

799
00:27:52,159 --> 00:27:54,880
amplifiers

800
00:27:57,919 --> 00:28:01,279
apologies for having my phone on you

801
00:28:01,279 --> 00:28:04,559
one more question um i have nicu do you

802
00:28:04,559 --> 00:28:05,600
publish the 2k

803
00:28:05,600 --> 00:28:08,960
filter uh so

804
00:28:08,960 --> 00:28:11,600
we are the i don't know what you mean by

805
00:28:11,600 --> 00:28:13,600
publish 2k filter the 2k filter

806
00:28:13,600 --> 00:28:17,360
will depend on the individual customer

807
00:28:17,360 --> 00:28:19,440
so i think the way to think about the 2k

808
00:28:19,440 --> 00:28:21,600
filter is that the internet has gotten

809
00:28:21,600 --> 00:28:22,880
very small

810
00:28:22,880 --> 00:28:25,200
if you have a subscriber or an

811
00:28:25,200 --> 00:28:26,880
enterprise customer

812
00:28:26,880 --> 00:28:29,120
uh the range of the internet the

813
00:28:29,120 --> 00:28:29,919
actually

814
00:28:29,919 --> 00:28:32,559
interact with and the ttls they'll use

815
00:28:32,559 --> 00:28:34,000
to interact with that

816
00:28:34,000 --> 00:28:36,799
uh rest of the internet is fairly narrow

817
00:28:36,799 --> 00:28:39,039
and he can be captured in a fairly small

818
00:28:39,039 --> 00:28:40,240
filter set

819
00:28:40,240 --> 00:28:42,080
similarly if you're running servers and

820
00:28:42,080 --> 00:28:44,080
getting tcp synapse

821
00:28:44,080 --> 00:28:46,399
so it really is a way to think of it

822
00:28:46,399 --> 00:28:48,000
perhaps is yeah baseline

823
00:28:48,000 --> 00:28:50,880
a baseline that combines topology uh per

824
00:28:50,880 --> 00:28:53,919
customer ttl and other information

825
00:28:53,919 --> 00:28:56,880
uh to form uh you know essentially a

826
00:28:56,880 --> 00:28:57,679
filter list

827
00:28:57,679 --> 00:29:00,320
or permit list that can be very very

828
00:29:00,320 --> 00:29:02,799
effective for the vast majority of ddos

829
00:29:02,799 --> 00:29:05,120
today

830
00:29:06,159 --> 00:29:08,880
okay thank you i have one more question

831
00:29:08,880 --> 00:29:10,559
in the queue

832
00:29:10,559 --> 00:29:13,600
we are often reluctant to name and shame

833
00:29:13,600 --> 00:29:15,600
at what point does the time necessity

834
00:29:15,600 --> 00:29:16,720
does the times

835
00:29:16,720 --> 00:29:20,000
necess necessitate the need for this

836
00:29:20,000 --> 00:29:22,480
and if so when is naming and shaming

837
00:29:22,480 --> 00:29:25,200
both necessary and helpful

838
00:29:25,200 --> 00:29:27,760
well as i said at the beginning of the

839
00:29:27,760 --> 00:29:28,399
talk

840
00:29:28,399 --> 00:29:31,600
uh you know the challenge is that

841
00:29:31,600 --> 00:29:33,840
many of you know the booters and the

842
00:29:33,840 --> 00:29:34,880
iphm

843
00:29:34,880 --> 00:29:36,960
don't have a long shelf life many of

844
00:29:36,960 --> 00:29:39,520
them have a shelf life of six months to

845
00:29:39,520 --> 00:29:40,320
a year

846
00:29:40,320 --> 00:29:41,919
in fact during the study period we

847
00:29:41,919 --> 00:29:43,919
obtained accounts and maybe thirty forty

848
00:29:43,919 --> 00:29:45,360
percent of the accounts

849
00:29:45,360 --> 00:29:47,279
uh that we obtained at the start were no

850
00:29:47,279 --> 00:29:49,679
longer valid by the end uh

851
00:29:49,679 --> 00:29:53,200
given both law enforcement action and

852
00:29:53,200 --> 00:29:56,559
some of them just disappeared uh so

853
00:29:56,559 --> 00:29:59,679
the first order bit is that

854
00:29:59,679 --> 00:30:02,240
you know there's a lot of flux but you

855
00:30:02,240 --> 00:30:04,480
know there does seem to be at any given

856
00:30:04,480 --> 00:30:06,399
time about 100 stressors

857
00:30:06,399 --> 00:30:10,240
and about 50 iphm and the focus really

858
00:30:10,240 --> 00:30:12,640
is structural what can we do as an

859
00:30:12,640 --> 00:30:13,440
industry

860
00:30:13,440 --> 00:30:16,640
to detect and to block this and

861
00:30:16,640 --> 00:30:19,039
if you just run or periodically some

862
00:30:19,039 --> 00:30:20,720
simple queries or build it into your

863
00:30:20,720 --> 00:30:22,240
peering agreements

864
00:30:22,240 --> 00:30:24,000
i mean this is not an intractable

865
00:30:24,000 --> 00:30:26,080
problem there's 50 companies

866
00:30:26,080 --> 00:30:28,000
that are largely at any given time

867
00:30:28,000 --> 00:30:30,480
driving most of the world's ddos

868
00:30:30,480 --> 00:30:33,360
and at least half of them are customers

869
00:30:33,360 --> 00:30:34,159
of nano

870
00:30:34,159 --> 00:30:37,360
participants so we have reached out to

871
00:30:37,360 --> 00:30:39,919
both our customers and other vendors and

872
00:30:39,919 --> 00:30:41,520
other isps

873
00:30:41,520 --> 00:30:43,520
uh where we've detected some of this

874
00:30:43,520 --> 00:30:45,200
traffic and are working

875
00:30:45,200 --> 00:30:47,440
individually but largely this is a

876
00:30:47,440 --> 00:30:49,200
structural issue we should solve as a

877
00:30:49,200 --> 00:30:50,559
community and

878
00:30:50,559 --> 00:30:53,120
make sure we are applying bc38 and

879
00:30:53,120 --> 00:30:54,640
actively using

880
00:30:54,640 --> 00:30:56,720
basically any commercial netflix tool to

881
00:30:56,720 --> 00:30:58,480
look for this traffic

882
00:30:58,480 --> 00:31:00,640
you know the final reason as i said

883
00:31:00,640 --> 00:31:01,760
before maybe the

884
00:31:01,760 --> 00:31:03,600
third reason i'll have four before i'm

885
00:31:03,600 --> 00:31:06,000
done the the third reason is

886
00:31:06,000 --> 00:31:09,039
some of this may not be intentional so

887
00:31:09,039 --> 00:31:11,360
uh some of this may be bad customers you

888
00:31:11,360 --> 00:31:13,360
know we don't know motive

889
00:31:13,360 --> 00:31:16,720
uh with all of this and finally

890
00:31:16,720 --> 00:31:18,240
i do think there are some references at

891
00:31:18,240 --> 00:31:20,080
the end so while we

892
00:31:20,080 --> 00:31:23,360
we do provide some screenshots of names

893
00:31:23,360 --> 00:31:26,080
there's also fifth you know 10 or 12

894
00:31:26,080 --> 00:31:26,559
different

895
00:31:26,559 --> 00:31:29,440
uh academic as well as industry papers

896
00:31:29,440 --> 00:31:30,960
we reference at the end they do

897
00:31:30,960 --> 00:31:32,000
enumerate

898
00:31:32,000 --> 00:31:34,640
different bits of the ecosystem and

899
00:31:34,640 --> 00:31:35,039
again

900
00:31:35,039 --> 00:31:37,120
you know this isn't really super hard

901
00:31:37,120 --> 00:31:38,480
most many of these companies are

902
00:31:38,480 --> 00:31:39,600
advertising

903
00:31:39,600 --> 00:31:42,080
it is relatively straightforward to get

904
00:31:42,080 --> 00:31:43,919
an account get an ip address and see

905
00:31:43,919 --> 00:31:45,279
who's hosting them

906
00:31:45,279 --> 00:31:48,240
and understand what the aspas look like

907
00:31:48,240 --> 00:31:49,360
to the network

908
00:31:49,360 --> 00:31:50,720
so we are working with folks in the

909
00:31:50,720 --> 00:31:52,080
industry in sharing some of the

910
00:31:52,080 --> 00:31:53,039
information

911
00:31:53,039 --> 00:31:55,679
but most of all we'd like to see broader

912
00:31:55,679 --> 00:31:56,480
industry

913
00:31:56,480 --> 00:31:58,799
use some of these queries uh to be able

914
00:31:58,799 --> 00:31:59,519
to detect

915
00:31:59,519 --> 00:32:01,679
and to be able to police within their

916
00:32:01,679 --> 00:32:04,000
own networks

917
00:32:04,000 --> 00:32:07,039
right okay well thank you unfortunately

918
00:32:07,039 --> 00:32:07,519
we are

919
00:32:07,519 --> 00:32:15,200
out of question time so

920
00:32:15,200 --> 00:32:17,279
you

