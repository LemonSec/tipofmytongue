1
00:00:00,000 --> 00:00:05,819
<font color="#CCCCCC">alright first of</font><font color="#E5E5E5"> all I'd like to thank</font>

2
00:00:03,149 --> 00:00:07,950
you<font color="#E5E5E5"> all</font><font color="#CCCCCC"> for resisting the temptation to</font>

3
00:00:05,819 --> 00:00:11,460
skip out on lunch or take a two o'clock

4
00:00:07,950 --> 00:00:13,200
flight so it's good<font color="#CCCCCC"> to</font><font color="#E5E5E5"> see the numbers</font>

5
00:00:11,460 --> 00:00:15,450
that<font color="#CCCCCC"> are still there after lunch I know</font>

6
00:00:13,200 --> 00:00:19,289
the<font color="#E5E5E5"> last days of the conference can be</font>

7
00:00:15,450 --> 00:00:21,330
kind of interesting it's<font color="#E5E5E5"> unfortunate</font>

8
00:00:19,289 --> 00:00:23,220
that the Rob Thomas is not here because

9
00:00:21,330 --> 00:00:26,369
what I'd like to do right<font color="#CCCCCC"> now is I'd</font>

10
00:00:23,220 --> 00:00:29,910
<font color="#CCCCCC">like to swear that that I am NOT an</font>

11
00:00:26,369 --> 00:00:33,930
infidel I repeat I am NOT an infidel I

12
00:00:29,910 --> 00:00:36,899
do believe there is a real threat I do

13
00:00:33,930 --> 00:00:40,019
believe that dead rats will be floating

14
00:00:36,899 --> 00:00:43,379
<font color="#CCCCCC">in your swimming pools that there is an</font>

15
00:00:40,020 --> 00:00:46,170
imminent mudslide waiting to happen so

16
00:00:43,379 --> 00:00:49,769
the goal of this presentation is to

17
00:00:46,170 --> 00:00:52,079
provide some clarification<font color="#CCCCCC"> on some of</font>

18
00:00:49,770 --> 00:00:54,300
the mechanisms and some of the ways that

19
00:00:52,079 --> 00:00:56,879
those dead rats can end up in your

20
00:00:54,300 --> 00:00:59,640
swimming<font color="#CCCCCC"> pool and that those end that</font>

21
00:00:56,879 --> 00:01:03,059
the specific events that could trigger

22
00:00:59,640 --> 00:01:06,299
that mud slide so by way of introduction

23
00:01:03,059 --> 00:01:08,670
I am a security researcher in a small

24
00:01:06,299 --> 00:01:10,920
group in Austin what I've been doing for

25
00:01:08,670 --> 00:01:13,159
the last several years<font color="#E5E5E5"> is beating up on</font>

26
00:01:10,920 --> 00:01:16,560
protocols finding implementation flaws

27
00:01:13,159 --> 00:01:19,110
finding bugs so that's that's what I do

28
00:01:16,560 --> 00:01:20,850
for a<font color="#CCCCCC"> living I'm I'm not someone out</font>

29
00:01:19,110 --> 00:01:22,439
there who manages routers for living I

30
00:01:20,850 --> 00:01:26,270
beat<font color="#CCCCCC"> up protocols for living so</font><font color="#E5E5E5"> you'll</font>

31
00:01:22,439 --> 00:01:26,270
see that perspective to do<font color="#E5E5E5"> this talk</font>

32
00:01:26,469 --> 00:01:34,780
so the the goal of this this talk<font color="#E5E5E5"> is to</font>

33
00:01:31,070 --> 00:01:38,029
provide some concrete data about

34
00:01:34,780 --> 00:01:39,799
vulnerabilities in BGP implementation

35
00:01:38,030 --> 00:01:43,130
and what I mean<font color="#CCCCCC"> by concrete data is I</font>

36
00:01:39,799 --> 00:01:46,219
mean actual testing testing of routers

37
00:01:43,130 --> 00:01:49,850
not theorizing about potential

38
00:01:46,219 --> 00:01:53,270
vulnerabilities in BGP or things that

39
00:01:49,850 --> 00:01:55,250
could happen but but real data and the

40
00:01:53,270 --> 00:01:56,929
way<font color="#E5E5E5"> that you do</font><font color="#CCCCCC"> that is you get a</font><font color="#E5E5E5"> bunch</font>

41
00:01:55,250 --> 00:01:59,000
of routers in the lab<font color="#E5E5E5"> you write attack</font>

42
00:01:56,929 --> 00:02:01,789
tools you come with<font color="#CCCCCC"> up with a set</font><font color="#E5E5E5"> of</font>

43
00:01:59,000 --> 00:02:03,890
attacks and you execute them and then

44
00:02:01,789 --> 00:02:06,259
you come up with the findings so in this

45
00:02:03,890 --> 00:02:08,840
talk I'm<font color="#E5E5E5"> going to give you a summary of</font>

46
00:02:06,259 --> 00:02:10,788
the vulnerability testing we've done on

47
00:02:08,840 --> 00:02:12,950
a variety of implementations over the

48
00:02:10,788 --> 00:02:16,190
last few months<font color="#E5E5E5"> we'll plug those</font>

49
00:02:12,950 --> 00:02:18,530
findings into an analysis of<font color="#E5E5E5"> BGP best</font>

50
00:02:16,190 --> 00:02:21,019
common practices and the section on best

51
00:02:18,530 --> 00:02:22,250
common practices is many of the same

52
00:02:21,019 --> 00:02:24,980
things you've heard over and over again

53
00:02:22,250 --> 00:02:28,160
and this this man on talk and in

54
00:02:24,980 --> 00:02:30,970
previous animal talks but all factor<font color="#CCCCCC"> in</font>

55
00:02:28,160 --> 00:02:34,940
the difficulty required to conduct

56
00:02:30,970 --> 00:02:37,340
specific attacks and the sorts of access

57
00:02:34,940 --> 00:02:41,690
<font color="#CCCCCC">that are</font><font color="#E5E5E5"> required to achieve that</font>

58
00:02:37,340 --> 00:02:43,880
objective and by way of caveat I'd like

59
00:02:41,690 --> 00:02:47,000
<font color="#E5E5E5">to say up front that the focus of this</font>

60
00:02:43,880 --> 00:02:50,480
presentation is actually on exploiting

61
00:02:47,000 --> 00:02:52,609
BGP not on what you can do with a

62
00:02:50,480 --> 00:02:56,388
compromised router so what are<font color="#CCCCCC"> the</font>

63
00:02:52,609 --> 00:03:00,470
actual risks when if<font color="#E5E5E5"> you try to attack a</font>

64
00:02:56,389 --> 00:03:02,269
<font color="#E5E5E5">BGP process on a router on port 179 so</font>

65
00:03:00,470 --> 00:03:04,760
if you if you look<font color="#E5E5E5"> at</font><font color="#CCCCCC"> the threat models</font>

66
00:03:02,269 --> 00:03:07,459
that were outlined earlier this morning

67
00:03:04,760 --> 00:03:09,709
a lot of this would fit into the packet

68
00:03:07,459 --> 00:03:11,160
injection or wiretapping it was on

69
00:03:09,709 --> 00:03:13,860
<font color="#CCCCCC">steves</font>

70
00:03:11,160 --> 00:03:15,630
and then<font color="#CCCCCC"> I'll also provide some some</font>

71
00:03:13,860 --> 00:03:18,600
<font color="#CCCCCC">real-world</font><font color="#E5E5E5"> data that can give us some</font>

72
00:03:15,630 --> 00:03:21,240
<font color="#E5E5E5">clues on whether or not some</font><font color="#CCCCCC"> of these</font>

73
00:03:18,600 --> 00:03:25,470
best common practices in terms of

74
00:03:21,240 --> 00:03:28,440
locking down vty access<font color="#E5E5E5"> SSH HTTP things</font>

75
00:03:25,470 --> 00:03:32,250
like that<font color="#E5E5E5"> and also what</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> the behavior</font>

76
00:03:28,440 --> 00:03:34,250
of<font color="#E5E5E5"> BGP implementations out there in the</font>

77
00:03:32,250 --> 00:03:36,690
wild and there's some interesting

78
00:03:34,250 --> 00:03:39,990
comparisons between that behavior that

79
00:03:36,690 --> 00:03:42,300
we observed in<font color="#CCCCCC"> the wild and what we</font>

80
00:03:39,990 --> 00:03:46,200
observed in<font color="#CCCCCC"> the lab</font><font color="#E5E5E5"> so I've got a lot of</font>

81
00:03:42,300 --> 00:03:50,190
content and you<font color="#E5E5E5"> do move on so as you</font>

82
00:03:46,200 --> 00:03:53,609
well know secure BGP like secure dns has

83
00:03:50,190 --> 00:03:56,250
popped up on the radar of leading<font color="#CCCCCC"> policy</font>

84
00:03:53,610 --> 00:03:58,440
<font color="#CCCCCC">makers both of those protocols made it</font>

85
00:03:56,250 --> 00:04:00,620
into<font color="#CCCCCC"> the national strategy and there's a</font>

86
00:03:58,440 --> 00:04:03,150
lot<font color="#CCCCCC"> of information out there about</font>

87
00:04:00,620 --> 00:04:07,160
vulnerabilities in BGP and what can<font color="#CCCCCC"> be</font>

88
00:04:03,150 --> 00:04:11,130
done with BGP unfortunately some of it

89
00:04:07,160 --> 00:04:13,650
does not<font color="#E5E5E5"> seem to be based on any real</font>

90
00:04:11,130 --> 00:04:16,709
empirical data meaning it's<font color="#E5E5E5"> not based on</font>

91
00:04:13,650 --> 00:04:18,120
testing actual routers so that one of

92
00:04:16,709 --> 00:04:20,390
the goals of<font color="#E5E5E5"> this presentation is to</font>

93
00:04:18,120 --> 00:04:23,310
help help clarify some of those issues

94
00:04:20,390 --> 00:04:25,919
and another problem<font color="#CCCCCC"> is that there are</font><font color="#E5E5E5"> a</font>

95
00:04:23,310 --> 00:04:28,110
lot of folks talking in in pretty and

96
00:04:25,920 --> 00:04:29,820
sometimes vague terms about security

97
00:04:28,110 --> 00:04:32,669
holes or security vulnerabilities

98
00:04:29,820 --> 00:04:34,980
without specifically identifying what

99
00:04:32,669 --> 00:04:37,380
sorts of vulnerabilities those are and

100
00:04:34,980 --> 00:04:41,390
that's another goal I attempt<font color="#CCCCCC"> to address</font>

101
00:04:37,380 --> 00:04:41,390
in<font color="#E5E5E5"> this presentation so</font>

102
00:04:41,490 --> 00:04:47,340
what do I mean by vulnerabilities one of

103
00:04:44,460 --> 00:04:50,190
my pet peeves is people using the word

104
00:04:47,340 --> 00:04:51,619
vulnerability in a fuzzy way or not

105
00:04:50,190 --> 00:04:53,460
knowing what they're talking about

106
00:04:51,620 --> 00:04:55,380
typically when I think about<font color="#E5E5E5"> a</font>

107
00:04:53,460 --> 00:04:57,659
vulnerability they're basically<font color="#E5E5E5"> three</font>

108
00:04:55,380 --> 00:05:00,240
classes of vulnerabilities you can have

109
00:04:57,660 --> 00:05:03,509
design<font color="#E5E5E5"> boner abilities and as you well</font>

110
00:05:00,240 --> 00:05:07,410
know<font color="#E5E5E5"> you know tcp/ip by design has no</font>

111
00:05:03,509 --> 00:05:11,610
security you can tear down TCP sessions

112
00:05:07,410 --> 00:05:13,979
by spoofing resets<font color="#E5E5E5"> BGP as you well know</font>

113
00:05:11,610 --> 00:05:15,840
<font color="#E5E5E5">without</font><font color="#CCCCCC"> the without the sum of these</font>

114
00:05:13,979 --> 00:05:17,490
security<font color="#CCCCCC"> hamlets has no built-in</font>

115
00:05:15,840 --> 00:05:19,979
security so those are designed<font color="#E5E5E5"> polling</font>

116
00:05:17,490 --> 00:05:22,349
abilities implementation vulnerabilities

117
00:05:19,979 --> 00:05:23,729
on the other hand are when a<font color="#E5E5E5"> process or</font>

118
00:05:22,349 --> 00:05:25,440
an application does not do what<font color="#CCCCCC"> it's</font>

119
00:05:23,729 --> 00:05:27,599
supposed to do these are typically based

120
00:05:25,440 --> 00:05:29,550
on coding errors in buffer overflows are

121
00:05:27,599 --> 00:05:32,550
probably the<font color="#E5E5E5"> most common or the commonly</font>

122
00:05:29,550 --> 00:05:36,690
reported form of implementation<font color="#E5E5E5"> forms</font>

123
00:05:32,550 --> 00:05:38,970
and another another and probably perhaps

124
00:05:36,690 --> 00:05:42,750
the most important vulnerability would

125
00:05:38,970 --> 00:05:45,360
be<font color="#CCCCCC"> Miss configuration default passwords</font>

126
00:05:42,750 --> 00:05:47,310
of<font color="#CCCCCC"> sissco inability to do any sort</font><font color="#E5E5E5"> of</font>

127
00:05:45,360 --> 00:05:49,020
ACLs things like that those are the

128
00:05:47,310 --> 00:05:51,000
examples of<font color="#CCCCCC"> Miss configuration</font>

129
00:05:49,020 --> 00:05:54,870
vulnerabilities and it's important to

130
00:05:51,000 --> 00:05:56,550
make this distinction because and those

131
00:05:54,870 --> 00:05:58,259
of you that the security<font color="#CCCCCC"> Bob last night</font>

132
00:05:56,550 --> 00:06:01,500
found out that vulnerability disclosure

133
00:05:58,259 --> 00:06:04,320
and reporting and notification is a very

134
00:06:01,500 --> 00:06:06,479
interesting<font color="#CCCCCC"> area with with lots of</font>

135
00:06:04,320 --> 00:06:07,949
issues so whether or not you're talking

136
00:06:06,479 --> 00:06:09,330
about a design vulnerability or miss

137
00:06:07,949 --> 00:06:11,219
configuration or implementation

138
00:06:09,330 --> 00:06:14,820
vulnerability can make a difference<font color="#E5E5E5"> in</font>

139
00:06:11,219 --> 00:06:18,450
terms of notification and disclosure

140
00:06:14,820 --> 00:06:22,560
and and basically<font color="#E5E5E5"> an upfront caveat is</font>

141
00:06:18,450 --> 00:06:25,500
that i am<font color="#CCCCCC"> not</font><font color="#E5E5E5"> going to be disclosing any</font>

142
00:06:22,560 --> 00:06:28,050
specific product vulnerabilities<font color="#E5E5E5"> i will</font>

143
00:06:25,500 --> 00:06:30,630
be discussing in general terms some

144
00:06:28,050 --> 00:06:32,940
vulnerabilities that were discovered<font color="#E5E5E5"> I'm</font>

145
00:06:30,630 --> 00:06:34,770
<font color="#E5E5E5">not going to name any vendors and I'm</font>

146
00:06:32,940 --> 00:06:36,719
not<font color="#E5E5E5"> going to talk about any exploit code</font>

147
00:06:34,770 --> 00:06:38,490
so don't<font color="#E5E5E5"> don't raise your hand after</font>

148
00:06:36,720 --> 00:06:41,070
this and say hey I'm from you know

149
00:06:38,490 --> 00:06:43,320
vendor a did you test my product because

150
00:06:41,070 --> 00:06:47,490
I'm either going to<font color="#E5E5E5"> have to lie or say</font>

151
00:06:43,320 --> 00:06:50,550
no I'm not sure which is worse and

152
00:06:47,490 --> 00:06:52,470
another another caveat is that we did

153
00:06:50,550 --> 00:06:54,660
and<font color="#E5E5E5"> you'll I'll go into more detail in</font>

154
00:06:52,470 --> 00:06:57,630
the presentation and a little bit but we

155
00:06:54,660 --> 00:07:02,160
did generate a set of<font color="#CCCCCC"> EGP</font><font color="#E5E5E5"> test cases</font>

156
00:06:57,630 --> 00:07:04,710
similar to those released by a group in

157
00:07:02,160 --> 00:07:10,140
Finland with the proto speed proto sweet

158
00:07:04,710 --> 00:07:11,840
and we have<font color="#E5E5E5"> provided those to search</font><font color="#CCCCCC"> ok</font>

159
00:07:10,140 --> 00:07:16,080
so so what did<font color="#CCCCCC"> we do with our testing</font>

160
00:07:11,840 --> 00:07:18,450
basically many of the apparent security

161
00:07:16,080 --> 00:07:20,780
problems in BGP are related to<font color="#E5E5E5"> the</font><font color="#CCCCCC"> to</font>

162
00:07:18,450 --> 00:07:23,849
insecurity<font color="#CCCCCC"> of tcp lack of authentication</font>

163
00:07:20,780 --> 00:07:25,859
you know lack of you<font color="#E5E5E5"> know access control</font>

164
00:07:23,850 --> 00:07:27,900
things<font color="#CCCCCC"> like that so we we started out</font>

165
00:07:25,860 --> 00:07:29,430
with<font color="#CCCCCC"> TCP you're an attack or the first</font>

166
00:07:27,900 --> 00:07:30,719
thing you're going to<font color="#E5E5E5"> go after at least</font>

167
00:07:29,430 --> 00:07:33,210
<font color="#E5E5E5">one of the first things I'm going to try</font>

168
00:07:30,720 --> 00:07:34,500
to go after if I'm a remote attacker is

169
00:07:33,210 --> 00:07:37,979
I want to see what I can do<font color="#CCCCCC"> with that</font>

170
00:07:34,500 --> 00:07:41,790
TCP stack on port 179 another<font color="#E5E5E5"> area of</font>

171
00:07:37,980 --> 00:07:45,380
testing was to determine the robustness

172
00:07:41,790 --> 00:07:49,560
of common bgp implementations by sending

173
00:07:45,380 --> 00:07:54,150
various sorts of malformed messages then

174
00:07:49,560 --> 00:07:57,600
we also tested sections of the<font color="#CCCCCC"> bgp</font>

175
00:07:54,150 --> 00:08:01,380
attack tree that several of us developed

176
00:07:57,600 --> 00:08:04,110
last fall this this work is the

177
00:08:01,380 --> 00:08:06,240
culmination of an effort that started

178
00:08:04,110 --> 00:08:08,910
eight or nine<font color="#E5E5E5"> months ago with in cisco</font>

179
00:08:06,240 --> 00:08:11,790
to basically lay out a comprehensive and

180
00:08:08,910 --> 00:08:15,990
systematic set of attacks against bgp

181
00:08:11,790 --> 00:08:18,660
and to turn that<font color="#CCCCCC"> into some actual lab</font>

182
00:08:15,990 --> 00:08:19,870
testing that could be verified<font color="#CCCCCC"> and that</font>

183
00:08:18,660 --> 00:08:23,230
could<font color="#E5E5E5"> be</font>

184
00:08:19,870 --> 00:08:26,050
<font color="#E5E5E5">be produced so last ball Sean Connery</font>

185
00:08:23,230 --> 00:08:28,090
and I and dave cook developed a BGP

186
00:08:26,050 --> 00:08:29,890
attack tree and<font color="#E5E5E5"> that's I believe it's in</font>

187
00:08:28,090 --> 00:08:33,669
draft status for RP second it may have

188
00:08:29,890 --> 00:08:35,080
it may have already was expired and then

189
00:08:33,669 --> 00:08:39,969
that the third part<font color="#E5E5E5"> of this was to</font>

190
00:08:35,080 --> 00:08:44,430
basically look at administrative courts

191
00:08:39,970 --> 00:08:46,930
out there and look at the behavior of

192
00:08:44,430 --> 00:08:49,260
common bgp speakers out there on the

193
00:08:46,930 --> 00:08:49,260
internet

194
00:08:55,670 --> 00:09:00,170
so I know sue is going to talk about

195
00:08:58,610 --> 00:09:02,540
attack trees a little bit in the next

196
00:09:00,170 --> 00:09:04,610
talk but basically the way that attack

197
00:09:02,540 --> 00:09:07,730
trees work is you come up with a set of

198
00:09:04,610 --> 00:09:11,180
<font color="#E5E5E5">goals of that an attacker would attempt</font>

199
00:09:07,730 --> 00:09:13,100
to<font color="#E5E5E5"> achieve and compromise a process gain</font>

200
00:09:11,180 --> 00:09:15,620
unauthorized access conducted<font color="#E5E5E5"> nila of</font>

201
00:09:13,100 --> 00:09:17,510
service those are generally the sorts of

202
00:09:15,620 --> 00:09:20,210
generic things that you you<font color="#CCCCCC"> face with</font>

203
00:09:17,510 --> 00:09:23,830
any protocol so you come up with a set

204
00:09:20,210 --> 00:09:26,510
of<font color="#E5E5E5"> goals and then you break down and</font>

205
00:09:23,830 --> 00:09:28,880
each of these goals into sub goals as

206
00:09:26,510 --> 00:09:32,120
means of achieving the parent goal so in

207
00:09:28,880 --> 00:09:33,980
in the draft convey<font color="#CCCCCC"> BGP attack last fall</font>

208
00:09:32,120 --> 00:09:36,260
we came up with three categories of

209
00:09:33,980 --> 00:09:40,280
goals<font color="#E5E5E5"> first of all were the kind of</font>

210
00:09:36,260 --> 00:09:42,650
lowest discrete goals that we had with

211
00:09:40,280 --> 00:09:44,180
BGP that we<font color="#E5E5E5"> called atomic goals you know</font>

212
00:09:42,650 --> 00:09:46,660
<font color="#CCCCCC">compromise and that can mean a lot of</font>

213
00:09:44,180 --> 00:09:49,339
<font color="#CCCCCC">different things</font><font color="#E5E5E5"> md5 authentication</font>

214
00:09:46,660 --> 00:09:51,650
establish an unauthorized session you

215
00:09:49,340 --> 00:09:55,820
<font color="#E5E5E5">know receta bgp sessions with a message</font>

216
00:09:51,650 --> 00:09:58,010
things like that then in<font color="#E5E5E5"> order to</font>

217
00:09:55,820 --> 00:10:00,410
and then you use a combination of these

218
00:09:58,010 --> 00:10:04,160
atomic goals to carry out more

219
00:10:00,410 --> 00:10:05,959
sophisticated and complex attacks and in

220
00:10:04,160 --> 00:10:08,329
order to conduct some<font color="#E5E5E5"> of the atomic</font>

221
00:10:05,960 --> 00:10:10,160
goals as<font color="#CCCCCC"> well as</font><font color="#E5E5E5"> to conduct the attack</font>

222
00:10:08,330 --> 00:10:12,740
scenarios you use a variety of

223
00:10:10,160 --> 00:10:15,469
techniques<font color="#E5E5E5"> that may have nothing to</font><font color="#CCCCCC"> do</font>

224
00:10:12,740 --> 00:10:17,930
with<font color="#E5E5E5"> vgp compromising a router of</font>

225
00:10:15,470 --> 00:10:19,970
generic dos<font color="#CCCCCC"> attack</font><font color="#E5E5E5"> that does not require</font>

226
00:10:17,930 --> 00:10:21,589
anything to do with<font color="#E5E5E5"> BGP those are all</font>

227
00:10:19,970 --> 00:10:23,690
examples of what we called supporting

228
00:10:21,590 --> 00:10:27,680
atomic goals and if you're interested<font color="#E5E5E5"> in</font>

229
00:10:23,690 --> 00:10:29,810
<font color="#E5E5E5">this sea the sea valency the draft</font><font color="#CCCCCC"> okay</font>

230
00:10:27,680 --> 00:10:31,880
so in terms of the specific testing what

231
00:10:29,810 --> 00:10:34,489
we did was<font color="#CCCCCC"> we we took the attack tree</font>

232
00:10:31,880 --> 00:10:37,790
and we broke it out into specific

233
00:10:34,490 --> 00:10:40,190
attacks and the tests from the attack

234
00:10:37,790 --> 00:10:42,650
tree are usually the<font color="#E5E5E5"> lowest level leaves</font>

235
00:10:40,190 --> 00:10:45,470
of the tree so to speak so<font color="#CCCCCC"> we looked at</font>

236
00:10:42,650 --> 00:10:47,480
what is the<font color="#CCCCCC"> behavior of</font><font color="#E5E5E5"> TCP and bgp</font>

237
00:10:45,470 --> 00:10:49,760
connection establishment on a variety<font color="#CCCCCC"> of</font>

238
00:10:47,480 --> 00:10:53,300
routers what is the susceptibility of

239
00:10:49,760 --> 00:10:55,430
common<font color="#E5E5E5"> tcp resource exhaustion aka syn</font>

240
00:10:53,300 --> 00:10:59,449
floods and other sorts of<font color="#E5E5E5"> TCP resource</font>

241
00:10:55,430 --> 00:11:01,400
exhaustion we wrote some tools to see

242
00:10:59,450 --> 00:11:06,980
how easy it would be to let's say write

243
00:11:01,400 --> 00:11:09,350
a BGP md5 cracker for bgp try some md5

244
00:11:06,980 --> 00:11:11,690
flooding<font color="#CCCCCC"> get some updated flooding and</font>

245
00:11:09,350 --> 00:11:13,760
<font color="#E5E5E5">i'll just add that the attacks listed in</font>

246
00:11:11,690 --> 00:11:15,530
italics are ones that<font color="#CCCCCC"> i had to put</font><font color="#E5E5E5"> at</font>

247
00:11:13,760 --> 00:11:18,110
the end of present presentation this was

248
00:11:15,530 --> 00:11:22,189
<font color="#CCCCCC">originally over</font><font color="#E5E5E5"> 60 slides and</font><font color="#CCCCCC"> I had to</font>

249
00:11:18,110 --> 00:11:24,860
move a lot<font color="#E5E5E5"> of stuff to the end then the</font>

250
00:11:22,190 --> 00:11:26,570
BGP route insertion be a<font color="#E5E5E5"> TCP hijacking</font>

251
00:11:24,860 --> 00:11:28,370
this is what the you know most people

252
00:11:26,570 --> 00:11:30,080
are talking<font color="#E5E5E5"> about you know compromising</font>

253
00:11:28,370 --> 00:11:32,680
a link or guessing the<font color="#E5E5E5"> TCP sequence</font>

254
00:11:30,080 --> 00:11:35,600
number and causing an update to

255
00:11:32,680 --> 00:11:38,290
malicious update to be sent and then the

256
00:11:35,600 --> 00:11:42,190
malformed messages

257
00:11:38,290 --> 00:11:44,230
so the goal of this testing was not and

258
00:11:42,190 --> 00:11:47,829
I repeat was not to do any sort of

259
00:11:44,230 --> 00:11:50,290
<font color="#E5E5E5">competitive security testing making</font>

260
00:11:47,829 --> 00:11:53,189
marketing claims about the presence of

261
00:11:50,290 --> 00:11:57,790
other vendors vulnerabilities is

262
00:11:53,190 --> 00:11:59,740
foolhardy at best just as making<font color="#E5E5E5"> claims</font>

263
00:11:57,790 --> 00:12:02,290
about the absence of vulnerabilities in

264
00:11:59,740 --> 00:12:04,509
your products so I'm<font color="#E5E5E5"> not even going to</font>

265
00:12:02,290 --> 00:12:07,630
go there with that<font color="#E5E5E5"> so but the purpose</font>

266
00:12:04,509 --> 00:12:10,149
was<font color="#E5E5E5"> to get a sample of implementation</font>

267
00:12:07,630 --> 00:12:12,550
behavior to determine the overall risk

268
00:12:10,149 --> 00:12:16,089
of some of these common attacks that

269
00:12:12,550 --> 00:12:18,339
have been discussed and you'll if you

270
00:12:16,089 --> 00:12:20,139
see little numbers in parentheses that

271
00:12:18,339 --> 00:12:22,779
means the numbers of implementations

272
00:12:20,139 --> 00:12:24,399
that<font color="#E5E5E5"> exhibited that behavior now in some</font>

273
00:12:22,779 --> 00:12:25,569
cases I did not include that because

274
00:12:24,399 --> 00:12:27,310
there's some really smart people out

275
00:12:25,569 --> 00:12:29,920
there that say<font color="#E5E5E5"> hey I know what this</font>

276
00:12:27,310 --> 00:12:32,079
implementation does so<font color="#E5E5E5"> I can start</font>

277
00:12:29,920 --> 00:12:36,040
putting names on these of these test

278
00:12:32,079 --> 00:12:38,019
results and<font color="#CCCCCC"> then I will</font><font color="#E5E5E5"> add that you</font>

279
00:12:36,040 --> 00:12:39,579
know any sort of<font color="#CCCCCC"> statistics cpu</font>

280
00:12:38,019 --> 00:12:42,670
utilization or routing process

281
00:12:39,579 --> 00:12:44,410
utilization or you know time for

282
00:12:42,670 --> 00:12:47,589
prostate the<font color="#E5E5E5"> appear to come up or come</font>

283
00:12:44,410 --> 00:12:50,019
down they were not based on a and I real

284
00:12:47,589 --> 00:12:51,399
life loaded<font color="#E5E5E5"> network there's a there's a</font>

285
00:12:50,019 --> 00:12:53,829
diagram in<font color="#E5E5E5"> the back that shows our</font>

286
00:12:51,399 --> 00:12:56,139
network that we use for testing so the

287
00:12:53,829 --> 00:12:58,140
your your mileage may vary if this were

288
00:12:56,139 --> 00:13:01,850
conducted on a real<font color="#E5E5E5"> network</font>

289
00:12:58,140 --> 00:13:05,670
so one<font color="#CCCCCC"> of the limitations of some of the</font>

290
00:13:01,850 --> 00:13:08,220
existing bgp security work and in

291
00:13:05,670 --> 00:13:10,410
particular there's a a presentation<font color="#CCCCCC"> that</font>

292
00:13:08,220 --> 00:13:12,000
was at black hat in<font color="#E5E5E5"> seattle earlier this</font>

293
00:13:10,410 --> 00:13:14,969
spring and i believe it's<font color="#E5E5E5"> going to show</font>

294
00:13:12,000 --> 00:13:17,850
up at black hat again in<font color="#E5E5E5"> las vegas was</font>

295
00:13:14,970 --> 00:13:21,330
that they<font color="#E5E5E5"> really didn't release any any</font>

296
00:13:17,850 --> 00:13:25,200
bgp attack tools so we wrote some bgp

297
00:13:21,330 --> 00:13:27,930
attack tools with the goal of validating

298
00:13:25,200 --> 00:13:30,090
these tests we also used a variety of

299
00:13:27,930 --> 00:13:34,430
you know commonly available open source

300
00:13:30,090 --> 00:13:37,170
tools nemesis<font color="#E5E5E5"> h pain things like that</font>

301
00:13:34,430 --> 00:13:39,300
and then we wrote a really crude

302
00:13:37,170 --> 00:13:42,060
proof-of-concept eat the BGP hijacking

303
00:13:39,300 --> 00:13:44,400
tool just to validate that behavior

304
00:13:42,060 --> 00:13:47,189
things like decent a few<font color="#CCCCCC"> you</font><font color="#E5E5E5"> probably</font>

305
00:13:44,400 --> 00:13:50,579
<font color="#E5E5E5">heard of these and then we also wrote a</font>

306
00:13:47,190 --> 00:13:54,120
buzzing package to basically generate

307
00:13:50,580 --> 00:13:58,230
the malformed bgp messages now some<font color="#E5E5E5"> of</font>

308
00:13:54,120 --> 00:14:00,000
these tools we would like to<font color="#E5E5E5"> put in the</font>

309
00:13:58,230 --> 00:14:01,050
hands of responsible folks some of them

310
00:14:00,000 --> 00:14:04,350
there's no way that we're going to<font color="#E5E5E5"> do</font>

311
00:14:01,050 --> 00:14:06,900
<font color="#E5E5E5">that but email me tell me what you do</font>

312
00:14:04,350 --> 00:14:08,070
the goal of this is to basically you

313
00:14:06,900 --> 00:14:10,650
know put a stake in the ground and

314
00:14:08,070 --> 00:14:12,630
saying here's some tests we didn't test

315
00:14:10,650 --> 00:14:15,270
all the implementations folks need to

316
00:14:12,630 --> 00:14:17,100
start doing some more testing so that's

317
00:14:15,270 --> 00:14:19,949
something<font color="#E5E5E5"> i'll discuss at the end of may</font>

318
00:14:17,100 --> 00:14:23,240
be a good way<font color="#E5E5E5"> to distribute tools and</font>

319
00:14:19,950 --> 00:14:23,240
test procedures responsibly

320
00:14:24,180 --> 00:14:28,620
so some folks may be wondering why do

321
00:14:26,700 --> 00:14:30,839
you start out with these kind<font color="#E5E5E5"> of boring</font>

322
00:14:28,620 --> 00:14:33,060
tests<font color="#CCCCCC"> upfront</font><font color="#E5E5E5"> why don't you go you know</font>

323
00:14:30,839 --> 00:14:35,960
immediately to session hijacking or

324
00:14:33,060 --> 00:14:39,479
man-in-the-middle things like that

325
00:14:35,960 --> 00:14:42,149
typically when I go after<font color="#E5E5E5"> a protocol you</font>

326
00:14:39,480 --> 00:14:44,820
start with the viewpoint of a remote

327
00:14:42,149 --> 00:14:47,220
blind attacker that<font color="#CCCCCC"> knows nothing about</font>

328
00:14:44,820 --> 00:14:50,040
the target<font color="#E5E5E5"> and you</font><font color="#CCCCCC"> determine what that</font>

329
00:14:47,220 --> 00:14:52,200
attacker can do and then you progress<font color="#E5E5E5"> to</font>

330
00:14:50,040 --> 00:14:54,209
an increasingly more knowledgeable

331
00:14:52,200 --> 00:14:56,910
attacker who knows information about the

332
00:14:54,209 --> 00:14:59,880
configuration who the<font color="#E5E5E5"> peers are so you</font>

333
00:14:56,910 --> 00:15:02,880
start from the<font color="#E5E5E5"> best-case scenario and</font>

334
00:14:59,880 --> 00:15:06,420
move to increasingly worst-case

335
00:15:02,880 --> 00:15:10,050
scenarios to<font color="#CCCCCC"> see how things stack up and</font>

336
00:15:06,420 --> 00:15:13,439
depending<font color="#E5E5E5"> on the level of how far you</font>

337
00:15:10,050 --> 00:15:15,839
can get into<font color="#CCCCCC"> the session that determines</font>

338
00:15:13,440 --> 00:15:19,140
the susceptibility to certain types of

339
00:15:15,839 --> 00:15:21,120
<font color="#CCCCCC">tack attacks including TCP resource</font>

340
00:15:19,140 --> 00:15:24,110
exhaustion attacks as<font color="#CCCCCC"> well as possibly</font>

341
00:15:21,120 --> 00:15:24,110
<font color="#E5E5E5">some malformed messages</font>

342
00:15:28,000 --> 00:15:31,630
so one<font color="#CCCCCC"> of the interesting things</font><font color="#E5E5E5"> that I</font>

343
00:15:29,500 --> 00:15:33,430
used to<font color="#E5E5E5"> do security testing Francisco</font>

344
00:15:31,630 --> 00:15:34,960
now I'm in a research group and I other

345
00:15:33,430 --> 00:15:39,670
folks do that sort of<font color="#E5E5E5"> product testing</font>

346
00:15:34,960 --> 00:15:41,470
but at most i would get exposed to maybe

347
00:15:39,670 --> 00:15:43,839
one or two implementations of let's say

348
00:15:41,470 --> 00:15:45,640
<font color="#E5E5E5">IPSec or ike or something like that this</font>

349
00:15:43,840 --> 00:15:47,290
was<font color="#E5E5E5"> very interesting</font><font color="#CCCCCC"> because i saw</font><font color="#E5E5E5"> seven</font>

350
00:15:45,640 --> 00:15:49,900
different implementations and there was

351
00:15:47,290 --> 00:15:51,730
a vast it was a great<font color="#CCCCCC"> variety of</font>

352
00:15:49,900 --> 00:15:53,439
behavior in terms of how these

353
00:15:51,730 --> 00:15:55,420
implementations responded two different

354
00:15:53,440 --> 00:16:00,700
messages so if we<font color="#CCCCCC"> start out the worst</font>

355
00:15:55,420 --> 00:16:02,829
case which all right with sending<font color="#E5E5E5"> a sin</font>

356
00:16:00,700 --> 00:16:04,480
from a non configured peer meaning you

357
00:16:02,830 --> 00:16:07,330
do<font color="#E5E5E5"> not you have not configured appearing</font>

358
00:16:04,480 --> 00:16:10,660
session and look at what<font color="#E5E5E5"> the response is</font>

359
00:16:07,330 --> 00:16:12,340
to sending that spin that that's in one

360
00:16:10,660 --> 00:16:13,660
of the implementations did would

361
00:16:12,340 --> 00:16:16,810
probably i would consider the best thing

362
00:16:13,660 --> 00:16:19,480
<font color="#CCCCCC">to silently drop the three of them sent</font>

363
00:16:16,810 --> 00:16:21,760
a reset act that's<font color="#CCCCCC"> okay several the</font>

364
00:16:19,480 --> 00:16:23,710
implementations also sin act so those

365
00:16:21,760 --> 00:16:25,660
implementations thats enact you could

366
00:16:23,710 --> 00:16:29,950
use traditional you<font color="#CCCCCC"> know port scanning</font>

367
00:16:25,660 --> 00:16:33,400
tools to determine<font color="#E5E5E5"> BGP speakers now if</font>

368
00:16:29,950 --> 00:16:35,830
you spoof a sin from an established<font color="#CCCCCC"> peer</font>

369
00:16:33,400 --> 00:16:37,240
and there is already and by established

370
00:16:35,830 --> 00:16:39,240
peer I mean there's a peer that's

371
00:16:37,240 --> 00:16:43,240
configured and the session<font color="#CCCCCC"> is active</font>

372
00:16:39,240 --> 00:16:45,190
that the behavior is as follows most of

373
00:16:43,240 --> 00:16:47,140
the implementations send it reset<font color="#E5E5E5"> ack</font>

374
00:16:45,190 --> 00:16:50,350
<font color="#E5E5E5">and that's the good thing to do a few of</font>

375
00:16:47,140 --> 00:16:53,140
them happily sin act so<font color="#CCCCCC"> that leads to</font>

376
00:16:50,350 --> 00:16:56,339
some exposures that that I'll talk<font color="#E5E5E5"> about</font>

377
00:16:53,140 --> 00:16:59,230
<font color="#E5E5E5">it a little bit later now if we send a</font>

378
00:16:56,339 --> 00:17:01,089
BGP open from a non configured peer most

379
00:16:59,230 --> 00:17:04,089
of them were set the session immediately

380
00:17:01,089 --> 00:17:06,220
that's a good<font color="#E5E5E5"> thing silently reset we</font>

381
00:17:04,089 --> 00:17:08,530
don't even you know<font color="#E5E5E5"> you cannot use that</font>

382
00:17:06,220 --> 00:17:11,050
to gain any information one of the

383
00:17:08,530 --> 00:17:13,449
implementations sent an open message

384
00:17:11,050 --> 00:17:16,329
with an<font color="#E5E5E5"> authentication</font><font color="#CCCCCC"> failed</font>

385
00:17:13,449 --> 00:17:20,169
now the rest<font color="#E5E5E5"> of these you are sending a</font>

386
00:17:16,329 --> 00:17:22,329
connection from a configured pier with

387
00:17:20,169 --> 00:17:25,059
an invalid a s and they're basically two

388
00:17:22,329 --> 00:17:26,888
different possibilities which is<font color="#E5E5E5"> a two</font>

389
00:17:25,059 --> 00:17:29,289
different possibilities there now i'll

390
00:17:26,888 --> 00:17:31,750
add<font color="#CCCCCC"> that these tests right here with the</font>

391
00:17:29,289 --> 00:17:33,158
open assume that there was not appearing

392
00:17:31,750 --> 00:17:35,440
established appearing session

393
00:17:33,159 --> 00:17:37,149
established because if there<font color="#CCCCCC"> were</font>

394
00:17:35,440 --> 00:17:42,190
appearing establishment session

395
00:17:37,149 --> 00:17:43,600
established you would get a reset<font color="#E5E5E5"> ack ok</font>

396
00:17:42,190 --> 00:17:44,409
some interesting things<font color="#E5E5E5"> that I saw when</font>

397
00:17:43,600 --> 00:17:46,889
tested when looking at these

398
00:17:44,409 --> 00:17:49,539
implementations some of<font color="#E5E5E5"> them had</font>

399
00:17:46,889 --> 00:17:51,340
basically no delay at all where I could

400
00:17:49,539 --> 00:17:54,039
just send open open open open open and

401
00:17:51,340 --> 00:17:56,110
you know do some sort of flooding attack

402
00:17:54,039 --> 00:17:58,690
but<font color="#E5E5E5"> bgp opens other than would you know</font>

403
00:17:56,110 --> 00:18:01,120
wait 60 seconds or several minutes

404
00:17:58,690 --> 00:18:03,179
before allowing me to send and open

405
00:18:01,120 --> 00:18:05,709
again though during this time out period

406
00:18:03,179 --> 00:18:08,019
basically i sent<font color="#CCCCCC"> it open and</font><font color="#E5E5E5"> they they</font>

407
00:18:05,710 --> 00:18:10,960
send a reset back so that has some

408
00:18:08,019 --> 00:18:12,100
implications it made some testing

409
00:18:10,960 --> 00:18:13,480
difficult on our part when we are

410
00:18:12,100 --> 00:18:15,219
sending large numbers of invalid

411
00:18:13,480 --> 00:18:18,490
messages but<font color="#E5E5E5"> that does have cemented</font><font color="#CCCCCC"> ok</font>

412
00:18:15,220 --> 00:18:20,889
at least<font color="#E5E5E5"> some implications now it's also</font>

413
00:18:18,490 --> 00:18:22,539
important<font color="#E5E5E5"> to notice that and this should</font>

414
00:18:20,889 --> 00:18:25,830
<font color="#E5E5E5">be obvious to most folks but it's</font>

415
00:18:22,539 --> 00:18:29,769
important to put<font color="#E5E5E5"> down that none of these</font>

416
00:18:25,830 --> 00:18:33,879
there<font color="#E5E5E5"> was no way to send any sort of you</font>

417
00:18:29,769 --> 00:18:36,399
<font color="#CCCCCC">know send</font><font color="#E5E5E5"> an update if you did not have</font>

418
00:18:33,880 --> 00:18:40,360
<font color="#CCCCCC">a valid if you did</font><font color="#E5E5E5"> not use it from a</font>

419
00:18:36,399 --> 00:18:42,928
valid<font color="#E5E5E5"> peer or with the valid autonomous</font>

420
00:18:40,360 --> 00:18:42,928
system number

421
00:18:51,059 --> 00:18:57,250
<font color="#E5E5E5">okay so TCP resource exhaustion are just</font>

422
00:18:54,220 --> 00:18:58,779
common<font color="#E5E5E5"> TCP attacks in flooding and you</font>

423
00:18:57,250 --> 00:19:02,110
may<font color="#E5E5E5"> be wondering well why test this this</font>

424
00:18:58,779 --> 00:19:04,090
is about<font color="#E5E5E5"> BGP well what I found in</font>

425
00:19:02,110 --> 00:19:08,918
testing of other<font color="#E5E5E5"> TCP based applications</font>

426
00:19:04,090 --> 00:19:10,658
is that there is typically there's it's

427
00:19:08,919 --> 00:19:13,149
hard to<font color="#E5E5E5"> determine what's an application</font>

428
00:19:10,659 --> 00:19:16,809
<font color="#E5E5E5">layer problem and what is a TCP problem</font>

429
00:19:13,149 --> 00:19:18,489
and that doing some of the naphtha style

430
00:19:16,809 --> 00:19:20,230
attacks and that's in the references

431
00:19:18,490 --> 00:19:23,140
basically conducting resource

432
00:19:20,230 --> 00:19:26,169
exhaustion's attacks beyond the first

433
00:19:23,140 --> 00:19:29,080
sin receive state you can have some

434
00:19:26,169 --> 00:19:31,029
aberrant behavior or sometimes crash the

435
00:19:29,080 --> 00:19:33,100
application so just you know for the

436
00:19:31,029 --> 00:19:36,070
<font color="#E5E5E5">sake of comprehensiveness and to see</font>

437
00:19:33,100 --> 00:19:38,080
what<font color="#E5E5E5"> would happen we did the TCP</font>

438
00:19:36,070 --> 00:19:40,720
resource exhaustion attack and they're

439
00:19:38,080 --> 00:19:42,760
basically you're trying to exhaust TCP

440
00:19:40,720 --> 00:19:45,549
at three different states now it's

441
00:19:42,760 --> 00:19:47,379
important to distinguish that<font color="#E5E5E5"> i'm not</font>

442
00:19:45,549 --> 00:19:48,639
<font color="#E5E5E5">talking about link saturation i'm not</font>

443
00:19:47,380 --> 00:19:49,840
talking about filling up cues i'm not

444
00:19:48,640 --> 00:19:52,630
talking about sending packets they<font color="#CCCCCC"> get</font>

445
00:19:49,840 --> 00:19:54,490
put it up<font color="#CCCCCC"> to the cpu</font><font color="#E5E5E5"> that cause you know</font>

446
00:19:52,630 --> 00:19:58,770
problems that way<font color="#E5E5E5"> i'm talking very</font>

447
00:19:54,490 --> 00:19:58,770
narrowly just about TCP

448
00:19:59,160 --> 00:20:04,710
so if on the<font color="#E5E5E5"> implementations</font><font color="#CCCCCC"> that would</font>

449
00:20:02,790 --> 00:20:07,590
happily syn flood or they would happily

450
00:20:04,710 --> 00:20:11,790
syn ACK whether it<font color="#CCCCCC"> was from a valid peer</font>

451
00:20:07,590 --> 00:20:16,080
or not you we saw a you know five to six

452
00:20:11,790 --> 00:20:18,240
minute delay in establishment of<font color="#CCCCCC"> the of</font>

453
00:20:16,080 --> 00:20:22,590
the<font color="#E5E5E5"> BGP session so basically what we did</font>

454
00:20:18,240 --> 00:20:24,930
<font color="#E5E5E5">was I starts in flooding clear the BGP</font>

455
00:20:22,590 --> 00:20:26,820
session wait for<font color="#E5E5E5"> it to come back</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> it</font>

456
00:20:24,930 --> 00:20:32,600
could take five or six<font color="#CCCCCC"> minutes now</font>

457
00:20:26,820 --> 00:20:37,169
sometimes if we put access lists on the

458
00:20:32,600 --> 00:20:39,480
<font color="#CCCCCC">pier to</font><font color="#E5E5E5"> prevent the pier being attacked</font>

459
00:20:37,170 --> 00:20:41,880
from sending its connections to the

460
00:20:39,480 --> 00:20:45,410
other peer the session would never get

461
00:20:41,880 --> 00:20:48,870
negotiated so what we saw is that

462
00:20:45,410 --> 00:20:52,260
typically<font color="#CCCCCC"> you in order to do a</font>

463
00:20:48,870 --> 00:20:54,959
successful syn flood to prevent<font color="#CCCCCC"> BGP</font>

464
00:20:52,260 --> 00:20:56,340
sessions from being negotiated you would

465
00:20:54,960 --> 00:20:59,820
have<font color="#E5E5E5"> to attack both sides of the</font>

466
00:20:56,340 --> 00:21:02,909
conversation<font color="#E5E5E5"> and you first would have to</font>

467
00:20:59,820 --> 00:21:05,520
reset the session and that's you<font color="#CCCCCC"> know</font>

468
00:21:02,910 --> 00:21:08,580
relatively relatively hard to do now

469
00:21:05,520 --> 00:21:10,860
there<font color="#E5E5E5"> are some issues potential issues</font>

470
00:21:08,580 --> 00:21:13,679
with implementations that<font color="#E5E5E5"> happily syn</font>

471
00:21:10,860 --> 00:21:15,870
ack packets in terms of resource

472
00:21:13,680 --> 00:21:18,789
exhaustion past that<font color="#CCCCCC"> scene receive</font>

473
00:21:15,870 --> 00:21:22,340
receive state

474
00:21:18,789 --> 00:21:24,499
so TCP sequence number attacks tearing

475
00:21:22,340 --> 00:21:27,139
down sessions I one<font color="#CCCCCC"> of the you know</font><font color="#E5E5E5"> the</font>

476
00:21:24,499 --> 00:21:29,240
most common attacks mentioned like in

477
00:21:27,139 --> 00:21:31,699
Sandra Murphy's threat document she

478
00:21:29,240 --> 00:21:33,710
talks about<font color="#E5E5E5"> basically how any outsider</font>

479
00:21:31,700 --> 00:21:37,399
can swoop you reset and tear down

480
00:21:33,710 --> 00:21:39,919
appearing session now that actually

481
00:21:37,399 --> 00:21:42,379
turns out to be harder at least<font color="#E5E5E5"> what we</font>

482
00:21:39,919 --> 00:21:45,169
found<font color="#E5E5E5"> that it was harder than then what</font>

483
00:21:42,379 --> 00:21:46,850
some folks have thought first<font color="#E5E5E5"> of all you</font>

484
00:21:45,169 --> 00:21:50,470
know as you<font color="#CCCCCC"> well know default</font><font color="#E5E5E5"> TCP</font>

485
00:21:46,850 --> 00:21:50,469
behavior is too

486
00:21:54,060 --> 00:21:58,740
<font color="#E5E5E5">okay so TCP sequence number behavior</font>

487
00:21:56,730 --> 00:22:02,010
typically<font color="#E5E5E5"> if</font><font color="#CCCCCC"> you want to reset a session</font>

488
00:21:58,740 --> 00:22:06,570
you need to get<font color="#CCCCCC"> the source</font><font color="#E5E5E5"> port source</font>

489
00:22:02,010 --> 00:22:08,730
destination port get the get the source

490
00:22:06,570 --> 00:22:11,220
destination IP right and the sequence

491
00:22:08,730 --> 00:22:12,780
number right we wrote a little<font color="#E5E5E5"> tool that</font>

492
00:22:11,220 --> 00:22:16,260
did that<font color="#CCCCCC"> and as you can see you could</font>

493
00:22:12,780 --> 00:22:18,360
bring down the session now this this<font color="#E5E5E5"> is</font>

494
00:22:16,260 --> 00:22:21,210
a math that shows basically how

495
00:22:18,360 --> 00:22:24,449
difficult it is to to conduct a blind

496
00:22:21,210 --> 00:22:27,000
spoof assuming<font color="#CCCCCC"> that you have a good</font>

497
00:22:24,450 --> 00:22:30,350
sequence number randomization routine in

498
00:22:27,000 --> 00:22:30,350
your when you're in<font color="#CCCCCC"> your step</font>

499
00:22:30,900 --> 00:22:35,670
so what we saw was that if<font color="#E5E5E5"> you</font><font color="#CCCCCC"> guess</font><font color="#E5E5E5"> the</font>

500
00:22:33,780 --> 00:22:37,710
sequence number or if you gain network

501
00:22:35,670 --> 00:22:40,080
access meaning you were in line you

502
00:22:37,710 --> 00:22:42,030
could obviously reset the session and it

503
00:22:40,080 --> 00:22:44,120
would cause you know about a minute for

504
00:22:42,030 --> 00:22:47,129
<font color="#E5E5E5">the for it to be down now there are</font><font color="#CCCCCC"> some</font>

505
00:22:44,120 --> 00:22:48,810
summers research there that says it's

506
00:22:47,130 --> 00:22:52,110
easier to go after<font color="#E5E5E5"> the initial sequence</font>

507
00:22:48,810 --> 00:22:54,600
numbers but what we saw was that in

508
00:22:52,110 --> 00:22:57,540
order to do that you have to have a lot

509
00:22:54,600 --> 00:22:59,550
of<font color="#E5E5E5"> cynics coming back to be able to</font>

510
00:22:57,540 --> 00:23:03,149
characterize those initial sequence

511
00:22:59,550 --> 00:23:04,950
numbers that are generated so basically

512
00:23:03,150 --> 00:23:07,710
<font color="#CCCCCC">what we saw is that it's it's harder to</font>

513
00:23:04,950 --> 00:23:11,190
conduct TCP resets than some folks have

514
00:23:07,710 --> 00:23:13,200
have claimed and if you implement best

515
00:23:11,190 --> 00:23:16,450
common practices they should<font color="#E5E5E5"> be</font>

516
00:23:13,200 --> 00:23:19,360
virtually impossible

517
00:23:16,450 --> 00:23:20,890
<font color="#E5E5E5">ok TCP hijacking this is what most folks</font>

518
00:23:19,360 --> 00:23:25,330
have talked<font color="#E5E5E5"> about we wrote a little tool</font>

519
00:23:20,890 --> 00:23:27,730
that allows you to<font color="#E5E5E5"> send the the update</font>

520
00:23:25,330 --> 00:23:29,169
<font color="#CCCCCC">to the router and this was just based on</font>

521
00:23:27,730 --> 00:23:31,570
sniffing the traffic it was written<font color="#E5E5E5"> in</font>

522
00:23:29,170 --> 00:23:33,960
lib net and the pcap and you can see

523
00:23:31,570 --> 00:23:36,960
that<font color="#E5E5E5"> it successfully</font><font color="#CCCCCC"> starts the update</font>

524
00:23:33,960 --> 00:23:39,610
<font color="#CCCCCC">ARP spoofing is also a means of</font>

525
00:23:36,960 --> 00:23:43,090
basically<font color="#E5E5E5"> taking over a</font><font color="#CCCCCC"> pier but you</font>

526
00:23:39,610 --> 00:23:45,040
have to have<font color="#E5E5E5"> local access to that to</font>

527
00:23:43,090 --> 00:23:49,240
that segment in order to conduct those

528
00:23:45,040 --> 00:23:51,790
sorts of attacks in terms of one of the

529
00:23:49,240 --> 00:23:54,220
one of the<font color="#CCCCCC"> sets of</font><font color="#E5E5E5"> tests we did was to</font>

530
00:23:51,790 --> 00:23:55,899
generate malformed messages and that's

531
00:23:54,220 --> 00:23:58,120
commonly referred to as fuzzing and

532
00:23:55,900 --> 00:23:59,620
that's one way of finding security

533
00:23:58,120 --> 00:24:01,000
vulnerabilities and products it's

534
00:23:59,620 --> 00:24:03,010
<font color="#E5E5E5">probably not</font><font color="#CCCCCC"> the best</font><font color="#E5E5E5"> way the best way</font>

535
00:24:01,000 --> 00:24:04,960
would be due to do a in a code review

536
00:24:03,010 --> 00:24:08,050
but we didn't have the source to all the

537
00:24:04,960 --> 00:24:10,390
implementations we test it so we a lot

538
00:24:08,050 --> 00:24:13,240
of folks are using buzzing to to test

539
00:24:10,390 --> 00:24:15,370
implementations so basically the way

540
00:24:13,240 --> 00:24:17,200
this<font color="#E5E5E5"> works there was originally a tool</font>

541
00:24:15,370 --> 00:24:19,120
called Isaac I don't know if any of you

542
00:24:17,200 --> 00:24:21,730
have heard of<font color="#E5E5E5"> it that it generates a lot</font>

543
00:24:19,120 --> 00:24:24,370
of invalid packets now the problem was I

544
00:24:21,730 --> 00:24:27,340
sick was that a really smart work work

545
00:24:24,370 --> 00:24:29,500
not so stupid implementations if the

546
00:24:27,340 --> 00:24:31,330
first<font color="#E5E5E5"> few bites of the message and I'm</font>

547
00:24:29,500 --> 00:24:33,040
<font color="#E5E5E5">talking generically not just about bgp</font>

548
00:24:31,330 --> 00:24:35,379
here but the<font color="#E5E5E5"> first few bites of the</font>

549
00:24:33,040 --> 00:24:36,879
message if they<font color="#E5E5E5"> are not valid typically</font>

550
00:24:35,380 --> 00:24:39,300
the implementation will just drop them

551
00:24:36,880 --> 00:24:42,160
so the goal of our tool was to basically

552
00:24:39,300 --> 00:24:43,470
embed those invalid messages deeper into

553
00:24:42,160 --> 00:24:46,140
the packet

554
00:24:43,470 --> 00:24:48,000
and we generated<font color="#E5E5E5"> about 800 test cases</font>

555
00:24:46,140 --> 00:24:49,860
for<font color="#E5E5E5"> the open to determine the</font>

556
00:24:48,000 --> 00:24:53,400
susceptibility of these malformed

557
00:24:49,860 --> 00:24:56,158
messages so this would<font color="#CCCCCC"> be an example of</font>

558
00:24:53,400 --> 00:24:57,870
a simple malformed open open and you can

559
00:24:56,159 --> 00:25:00,210
<font color="#E5E5E5">see</font><font color="#CCCCCC"> that there's the ballot 16 Bart's</font>

560
00:24:57,870 --> 00:25:01,709
<font color="#CCCCCC">bites of the marker up front and I</font>

561
00:25:00,210 --> 00:25:04,799
believe<font color="#CCCCCC"> that the length is actually</font>

562
00:25:01,710 --> 00:25:07,559
valid as well but the type is not a

563
00:25:04,799 --> 00:25:09,980
valid BGP message so in most cases this

564
00:25:07,559 --> 00:25:13,850
should be dropped by the implementation

565
00:25:09,980 --> 00:25:17,659
we did the<font color="#CCCCCC"> same thing for for the update</font>

566
00:25:13,850 --> 00:25:21,240
and basically our test results

567
00:25:17,659 --> 00:25:23,669
especially<font color="#CCCCCC"> if you compare these to the</font>

568
00:25:21,240 --> 00:25:25,590
<font color="#CCCCCC">the results from SNMP these seem</font>

569
00:25:23,669 --> 00:25:27,330
remarkably positive one of the problems

570
00:25:25,590 --> 00:25:28,918
<font color="#CCCCCC">with SNMP is that you saw the same</font>

571
00:25:27,330 --> 00:25:31,649
<font color="#E5E5E5">problem showing up and everybody's</font>

572
00:25:28,919 --> 00:25:33,630
implementation we didn't see that the

573
00:25:31,650 --> 00:25:35,820
<font color="#E5E5E5">problems that we found were unique to</font>

574
00:25:33,630 --> 00:25:38,460
the implementation an out of 1,200 test

575
00:25:35,820 --> 00:25:41,370
cases we only found four four distinct

576
00:25:38,460 --> 00:25:43,730
flaws and three of these flaws you

577
00:25:41,370 --> 00:25:48,199
actually<font color="#CCCCCC"> had to be a configured</font><font color="#E5E5E5"> peer and</font>

578
00:25:43,730 --> 00:25:50,370
no the valide s to conduct that attack

579
00:25:48,200 --> 00:25:51,840
so here are just some recommendations

580
00:25:50,370 --> 00:25:53,459
based on looking on at all the

581
00:25:51,840 --> 00:25:56,530
implementations and this is probably

582
00:25:53,460 --> 00:25:59,290
<font color="#E5E5E5">more appropriate for vendors</font>

583
00:25:56,530 --> 00:26:01,000
so what we did next was we took a threat

584
00:25:59,290 --> 00:26:03,399
we looked at three different threat

585
00:26:01,000 --> 00:26:06,060
models a blind attacker<font color="#E5E5E5"> a non blind</font>

586
00:26:03,400 --> 00:26:08,350
attacker and a compromised router I

587
00:26:06,060 --> 00:26:09,850
think it's made eminently clear that

588
00:26:08,350 --> 00:26:13,240
basically all bets are off if you

589
00:26:09,850 --> 00:26:15,129
<font color="#E5E5E5">compromise the router things and things</font>

590
00:26:13,240 --> 00:26:16,510
get progressively better if you're just

591
00:26:15,130 --> 00:26:19,030
<font color="#E5E5E5">talking</font><font color="#CCCCCC"> about a non blind attacker</font>

592
00:26:16,510 --> 00:26:20,590
someone caught just gaining access<font color="#E5E5E5"> to</font>

593
00:26:19,030 --> 00:26:23,680
the wire and<font color="#E5E5E5"> then a remote blind</font>

594
00:26:20,590 --> 00:26:26,320
attacker now in<font color="#E5E5E5"> terms of the best</font>

595
00:26:23,680 --> 00:26:28,570
practices<font color="#CCCCCC"> that we use to validate these</font>

596
00:26:26,320 --> 00:26:30,399
tests<font color="#E5E5E5"> I'll just talk about the ones that</font>

597
00:26:28,570 --> 00:26:32,560
we<font color="#E5E5E5"> added and those are in</font><font color="#CCCCCC"> red the rest</font>

598
00:26:30,400 --> 00:26:34,150
of these are are fairly<font color="#CCCCCC"> well-known</font><font color="#E5E5E5"> the</font>

599
00:26:32,560 --> 00:26:36,520
we added some layer<font color="#CCCCCC"> two breasts</font>

600
00:26:34,150 --> 00:26:37,930
practices which are probably more

601
00:26:36,520 --> 00:26:40,810
appropriate for shared media

602
00:26:37,930 --> 00:26:43,450
environments so applying the best

603
00:26:40,810 --> 00:26:45,879
practices we<font color="#E5E5E5"> found that if you apply the</font>

604
00:26:43,450 --> 00:26:48,910
best practices conducting the<font color="#E5E5E5"> TCP</font>

605
00:26:45,880 --> 00:26:50,560
attacks to exploit BGP are virtually

606
00:26:48,910 --> 00:26:52,000
impossible you know insecurity you never

607
00:26:50,560 --> 00:26:55,740
say never but they're virtually

608
00:26:52,000 --> 00:26:58,870
impossible non blind attacks if you

609
00:26:55,740 --> 00:27:01,090
don't apply the layer to best practices

610
00:26:58,870 --> 00:27:02,679
you'll<font color="#E5E5E5"> have some susceptibility and once</font>

611
00:27:01,090 --> 00:27:05,320
again all bets are off with compromised

612
00:27:02,680 --> 00:27:07,780
router so big surprise compromised

613
00:27:05,320 --> 00:27:09,250
router is the<font color="#CCCCCC"> worst-case scenario but</font>

614
00:27:07,780 --> 00:27:12,250
compromised routers in and of themselves

615
00:27:09,250 --> 00:27:13,990
don't have anything to<font color="#E5E5E5"> do with BGP and I</font>

616
00:27:12,250 --> 00:27:16,930
know this is kind of an exaggeration but

617
00:27:13,990 --> 00:27:21,730
you don't hear many folks talking about

618
00:27:16,930 --> 00:27:23,920
about<font color="#E5E5E5"> replacing you know smtp or HTTP</font>

619
00:27:21,730 --> 00:27:25,780
just because folks are compromising web

620
00:27:23,920 --> 00:27:28,330
servers or mail servers now this

621
00:27:25,780 --> 00:27:31,360
shouldn't be taken as an as a reason not

622
00:27:28,330 --> 00:27:33,939
to pursue secure protocols and that's a

623
00:27:31,360 --> 00:27:36,429
bit of an oversimplification but all of

624
00:27:33,940 --> 00:27:38,080
the attacks<font color="#E5E5E5"> that we looked at did not if</font>

625
00:27:36,430 --> 00:27:40,690
you're<font color="#E5E5E5"> just going to talk about attacks</font>

626
00:27:38,080 --> 00:27:43,330
that use bgp<font color="#E5E5E5"> you're the range of attacks</font>

627
00:27:40,690 --> 00:27:45,800
is significantly limited

628
00:27:43,330 --> 00:27:48,649
<font color="#E5E5E5">okay so basically what we wanted to do</font>

629
00:27:45,800 --> 00:27:50,840
was we wanted<font color="#E5E5E5"> to look at our best</font><font color="#CCCCCC"> pax</font><font color="#E5E5E5"> is</font>

630
00:27:48,650 --> 00:27:54,020
actually being applied out there we came

631
00:27:50,840 --> 00:27:57,290
up with a list<font color="#E5E5E5"> of of routers that we</font>

632
00:27:54,020 --> 00:28:00,050
were a list of routers and we did very

633
00:27:57,290 --> 00:28:03,530
<font color="#E5E5E5">non intrusive we sent very non intrusive</font>

634
00:28:00,050 --> 00:28:06,139
probes basically<font color="#E5E5E5"> for sins and within the</font>

635
00:28:03,530 --> 00:28:08,720
sin payload there was actually a message

636
00:28:06,140 --> 00:28:11,540
<font color="#E5E5E5">saying this is not malicious activity it</font>

637
00:28:08,720 --> 00:28:13,820
provided an email and said please

638
00:28:11,540 --> 00:28:15,470
contact us if you have<font color="#CCCCCC"> any concerns</font><font color="#E5E5E5"> or</font>

639
00:28:13,820 --> 00:28:18,470
question about this now<font color="#E5E5E5"> interestingly</font>

640
00:28:15,470 --> 00:28:20,480
enough how many responses do you think

641
00:28:18,470 --> 00:28:24,260
we got<font color="#E5E5E5"> after sitting at this no we</font>

642
00:28:20,480 --> 00:28:26,860
actually<font color="#E5E5E5"> got one from anyway from a</font>

643
00:28:24,260 --> 00:28:26,860
government<font color="#E5E5E5"> agency</font>

644
00:28:27,260 --> 00:28:35,390
so we all assuming we<font color="#E5E5E5"> got a syn</font><font color="#CCCCCC"> ack from</font>

645
00:28:31,700 --> 00:28:38,360
a from a port 179 what we did was<font color="#CCCCCC"> we</font>

646
00:28:35,390 --> 00:28:41,060
sent a valid format it open to see what

647
00:28:38,360 --> 00:28:44,030
we got back now here<font color="#E5E5E5"> are the results</font>

648
00:28:41,060 --> 00:28:48,290
basically we discovered you<font color="#CCCCCC"> know of our</font>

649
00:28:44,030 --> 00:28:52,720
total number of routers 115,000 we found

650
00:28:48,290 --> 00:28:56,300
approximately 4600 thats enact we<font color="#E5E5E5"> found</font>

651
00:28:52,720 --> 00:28:58,400
3,000 that reset the vast majority of

652
00:28:56,300 --> 00:29:00,620
society no response now those could be

653
00:28:58,400 --> 00:29:02,570
filtered but it could be firewalling or

654
00:29:00,620 --> 00:29:06,260
something like that in terms of the BGP

655
00:29:02,570 --> 00:29:08,210
opens I was<font color="#E5E5E5"> quite surprised to see</font><font color="#CCCCCC"> that</font>

656
00:29:06,260 --> 00:29:10,129
the large number<font color="#CCCCCC"> of opens or</font>

657
00:29:08,210 --> 00:29:13,100
notifications that were sent back

658
00:29:10,130 --> 00:29:15,200
because<font color="#E5E5E5"> this did</font><font color="#CCCCCC"> not because these were</font>

659
00:29:13,100 --> 00:29:16,909
all from non configured peers these

660
00:29:15,200 --> 00:29:20,660
these probes were sent from the cisco

661
00:29:16,910 --> 00:29:22,820
<font color="#E5E5E5">dmz so the arp these IP source IP is of</font>

662
00:29:20,660 --> 00:29:25,310
our packets should not be a pierced so

663
00:29:22,820 --> 00:29:28,220
we got a large number of<font color="#E5E5E5"> BGP messages</font>

664
00:29:25,310 --> 00:29:30,919
back now on<font color="#E5E5E5"> the</font><font color="#CCCCCC"> right column</font><font color="#E5E5E5"> there</font>

665
00:29:28,220 --> 00:29:33,950
basically that<font color="#E5E5E5"> data shows the</font><font color="#CCCCCC"> number</font><font color="#E5E5E5"> of</font>

666
00:29:30,920 --> 00:29:38,650
sin acts we received from ssh telnet and

667
00:29:33,950 --> 00:29:41,390
HTTP and in<font color="#CCCCCC"> total</font><font color="#E5E5E5"> we found of the</font>

668
00:29:38,650 --> 00:29:44,720
115,000 routers and worse them using

669
00:29:41,390 --> 00:29:46,840
routers and rotation marks 16,000 had

670
00:29:44,720 --> 00:29:49,160
some sort of administrative access

671
00:29:46,840 --> 00:29:52,159
that's a problem<font color="#E5E5E5"> that points to that</font>

672
00:29:49,160 --> 00:29:54,680
<font color="#E5E5E5">issue of compromise routers right there</font>

673
00:29:52,160 --> 00:29:57,290
and the total number was fourteen

674
00:29:54,680 --> 00:29:59,450
percent of the routers had some sort of

675
00:29:57,290 --> 00:30:01,430
administrative access on this next slide

676
00:29:59,450 --> 00:30:04,250
<font color="#E5E5E5">I have some interesting country</font>

677
00:30:01,430 --> 00:30:07,890
breakdown and I guess<font color="#E5E5E5"> old Europe gets</font>

678
00:30:04,250 --> 00:30:11,040
the award curly<font color="#E5E5E5"> the best secured routers</font>

679
00:30:07,890 --> 00:30:14,610
spain france and great britain had the

680
00:30:11,040 --> 00:30:19,260
lowest percentage of routers that had

681
00:30:14,610 --> 00:30:22,169
admit admin access so basically in

682
00:30:19,260 --> 00:30:24,870
conclusion this first bullet here should

683
00:30:22,170 --> 00:30:29,550
be<font color="#E5E5E5"> no surprise it's it's kind of common</font>

684
00:30:24,870 --> 00:30:32,459
sense but<font color="#CCCCCC"> it was good to provide some</font>

685
00:30:29,550 --> 00:30:34,470
real data to back this up compromise

686
00:30:32,460 --> 00:30:37,800
routers are the biggest problem<font color="#E5E5E5"> these</font>

687
00:30:34,470 --> 00:30:40,260
remote blind attacks are in our

688
00:30:37,800 --> 00:30:43,260
estimation not the<font color="#E5E5E5"> problem that some</font>

689
00:30:40,260 --> 00:30:45,900
folks have made them out to be also that

690
00:30:43,260 --> 00:30:49,500
if you apply best common practices both

691
00:30:45,900 --> 00:30:51,330
for bgp and<font color="#E5E5E5"> tcp in terms of access</font>

692
00:30:49,500 --> 00:30:54,410
control lists you<font color="#E5E5E5"> can pretty much</font>

693
00:30:51,330 --> 00:30:56,639
mitigate most of the tcp attacks

694
00:30:54,410 --> 00:30:59,730
including soon flooding and also

695
00:30:56,640 --> 00:31:02,010
injecting data and kind<font color="#E5E5E5"> of this this</font>

696
00:30:59,730 --> 00:31:04,080
last point here<font color="#E5E5E5"> is you know and this has</font>

697
00:31:02,010 --> 00:31:06,750
kind<font color="#E5E5E5"> of came to me after listening to</font>

698
00:31:04,080 --> 00:31:08,820
rob very entertaining presentation last

699
00:31:06,750 --> 00:31:11,820
night at<font color="#E5E5E5"> the bob and also</font><font color="#CCCCCC"> earlier you</font>

700
00:31:08,820 --> 00:31:14,100
know attackers are lazy why do all this

701
00:31:11,820 --> 00:31:16,050
stuff using<font color="#CCCCCC"> TCP sequence number attacks</font>

702
00:31:14,100 --> 00:31:17,850
having to guess all this stuff or he's

703
00:31:16,050 --> 00:31:21,480
<font color="#E5E5E5">arp attacks or to compromise a local</font>

704
00:31:17,850 --> 00:31:23,429
host when you can just own the box and

705
00:31:21,480 --> 00:31:27,650
one more slide and then<font color="#E5E5E5"> i'll i'll open</font>

706
00:31:23,430 --> 00:31:30,450
up<font color="#E5E5E5"> for interrogation so basically</font>

707
00:31:27,650 --> 00:31:33,060
encourage folks to do<font color="#E5E5E5"> tests to do</font>

708
00:31:30,450 --> 00:31:36,000
testing<font color="#E5E5E5"> of their products security</font>

709
00:31:33,060 --> 00:31:37,679
testing is always a good<font color="#E5E5E5"> thing implement</font>

710
00:31:36,000 --> 00:31:40,830
<font color="#E5E5E5">bgp best common practices this is</font>

711
00:31:37,680 --> 00:31:43,350
beating a dead horse and this you know

712
00:31:40,830 --> 00:31:44,850
force folks to you know be more specific

713
00:31:43,350 --> 00:31:48,120
when they're<font color="#E5E5E5"> talking about bgp</font>

714
00:31:44,850 --> 00:31:49,709
vulnerabilities because it's not<font color="#E5E5E5"> all or</font>

715
00:31:48,120 --> 00:31:51,050
nothing and it's<font color="#CCCCCC"> pretty not as simple as</font>

716
00:31:49,710 --> 00:31:55,440
opposed to make it out<font color="#E5E5E5"> to be</font>

717
00:31:51,050 --> 00:31:56,850
more testing is needed and a combination

718
00:31:55,440 --> 00:31:59,580
<font color="#CCCCCC">of folks whether</font><font color="#E5E5E5"> it's research</font>

719
00:31:56,850 --> 00:32:01,980
researchers you know customers or

720
00:31:59,580 --> 00:32:06,870
vendors themselves they all need to take

721
00:32:01,980 --> 00:32:09,740
part<font color="#E5E5E5"> in the testing okay now open up to</font>

722
00:32:06,870 --> 00:32:13,310
the<font color="#E5E5E5"> queue that's forming this people</font>

723
00:32:09,740 --> 00:32:15,810
quick question when you<font color="#E5E5E5"> were looking at</font>

724
00:32:13,310 --> 00:32:17,909
fuzzing packets injecting malformed

725
00:32:15,810 --> 00:32:20,429
updates were you looking at<font color="#E5E5E5"> it</font>

726
00:32:17,910 --> 00:32:21,660
specifically it one of the side effects

727
00:32:20,430 --> 00:32:24,870
whether you<font color="#E5E5E5"> could actually generate a</font>

728
00:32:21,660 --> 00:32:25,980
notify message what were you looking at

729
00:32:24,870 --> 00:32:27,750
whether the router crashed or<font color="#CCCCCC"> whatnot</font>

730
00:32:25,980 --> 00:32:29,250
<font color="#E5E5E5">what we've seen is really interesting is</font>

731
00:32:27,750 --> 00:32:31,230
playing with some of that<font color="#E5E5E5"> you know</font>

732
00:32:29,250 --> 00:32:33,240
constructing messages that are subtly

733
00:32:31,230 --> 00:32:35,700
wrong is<font color="#CCCCCC"> that it is possible to</font>

734
00:32:33,240 --> 00:32:38,430
construct messages which router a the

735
00:32:35,700 --> 00:32:40,740
vendor a will actually pass on defender

736
00:32:38,430 --> 00:32:42,750
<font color="#E5E5E5">B which will then say ain't bad you know</font>

737
00:32:40,740 --> 00:32:45,060
<font color="#E5E5E5">Eric parse correctly and then cause</font>

738
00:32:42,750 --> 00:32:46,070
notify storms in<font color="#CCCCCC"> some cases even being a</font>

739
00:32:45,060 --> 00:32:48,470
few<font color="#CCCCCC"> AS</font>

740
00:32:46,070 --> 00:32:49,760
be<font color="#E5E5E5"> able to cause different vendors to</font>

741
00:32:48,470 --> 00:32:52,490
not be able to talk<font color="#E5E5E5"> to each other well</font>

742
00:32:49,760 --> 00:32:53,840
so basically so basically sending some

743
00:32:52,490 --> 00:32:55,970
sort of invalid up gate that gets

744
00:32:53,840 --> 00:32:58,760
propagated<font color="#CCCCCC"> alright transitively</font><font color="#E5E5E5"> by some</font>

745
00:32:55,970 --> 00:33:00,830
router vendors we<font color="#E5E5E5"> actually were just</font>

746
00:32:58,760 --> 00:33:02,900
looking at the first message so<font color="#CCCCCC"> we did</font>

747
00:33:00,830 --> 00:33:05,090
the<font color="#E5E5E5"> opens and then looking at the</font>

748
00:33:02,900 --> 00:33:06,650
response I would encourage you<font color="#E5E5E5"> to do a</font>

749
00:33:05,090 --> 00:33:09,470
lot of work and we could<font color="#CCCCCC"> talk about</font><font color="#E5E5E5"> this</font>

750
00:33:06,650 --> 00:33:12,200
<font color="#E5E5E5">on the malformed updates</font><font color="#CCCCCC"> I think that's</font>

751
00:33:09,470 --> 00:33:13,910
a that's a pretty big opening gala give

752
00:33:12,200 --> 00:33:15,920
ability to cause notifies remotely and

753
00:33:13,910 --> 00:33:19,090
it's happened at an odd during a Down

754
00:33:15,920 --> 00:33:22,250
Dog actually when there was a s0s0

755
00:33:19,090 --> 00:33:23,830
appeared mas pads and it prevented bays

756
00:33:22,250 --> 00:33:26,390
and<font color="#E5E5E5"> systems from talking to each other</font>

757
00:33:23,830 --> 00:33:28,760
yeah<font color="#E5E5E5"> given</font><font color="#CCCCCC"> the complexity of some of</font>

758
00:33:26,390 --> 00:33:31,400
those message formats there could be so

759
00:33:28,760 --> 00:33:33,650
could be some issues<font color="#CCCCCC"> I'm Steve Bell</font><font color="#E5E5E5"> oven</font>

760
00:33:31,400 --> 00:33:39,130
thank you very<font color="#CCCCCC"> much for conducting these</font>

761
00:33:33,650 --> 00:33:41,840
tests especially after the SNMP<font color="#CCCCCC"> asn.1</font>

762
00:33:39,130 --> 00:33:43,730
stuff the year or so ago it's very

763
00:33:41,840 --> 00:33:47,570
reassuring to hear that we<font color="#E5E5E5"> don't have</font>

764
00:33:43,730 --> 00:33:51,020
similar glaring vulnerabilities in BGP i

765
00:33:47,570 --> 00:33:52,790
would add one caveat if<font color="#E5E5E5"> you're if you</font>

766
00:33:51,020 --> 00:33:56,870
have bgp sessions that are going more

767
00:33:52,790 --> 00:33:59,659
than one IP hot and you've got I GP

768
00:33:56,870 --> 00:34:03,500
security problems that means that

769
00:33:59,660 --> 00:34:06,200
attackers don't it improves the odds<font color="#E5E5E5"> for</font>

770
00:34:03,500 --> 00:34:08,780
a of a staging a non blind attack so

771
00:34:06,200 --> 00:34:13,370
<font color="#E5E5E5">it's not the salmon if government</font>

772
00:34:08,780 --> 00:34:15,650
multi-hop EJ I agree totally and I guess

773
00:34:13,370 --> 00:34:21,620
probably unless im sue harrison in this

774
00:34:15,650 --> 00:34:23,570
moment all act as a dr co-chair so one

775
00:34:21,620 --> 00:34:25,940
question<font color="#CCCCCC"> i have that i'd like</font><font color="#E5E5E5"> to know</font><font color="#CCCCCC"> is</font>

776
00:34:23,570 --> 00:34:29,030
did you use then configured option in

777
00:34:25,940 --> 00:34:30,918
the new finite state machine release

778
00:34:29,030 --> 00:34:32,780
peers unconfigured there are there<font color="#CCCCCC"> are</font>

779
00:34:30,918 --> 00:34:35,060
some things that allow non configured

780
00:34:32,780 --> 00:34:39,669
<font color="#CCCCCC">pier so did you restrict your research</font>

781
00:34:35,060 --> 00:34:39,668
to interfere it was just<font color="#E5E5E5"> too</font>

782
00:34:44,500 --> 00:34:50,070
I'll be available offline everyone's

783
00:34:46,750 --> 00:34:50,070
chat about<font color="#E5E5E5"> this thanks</font>

