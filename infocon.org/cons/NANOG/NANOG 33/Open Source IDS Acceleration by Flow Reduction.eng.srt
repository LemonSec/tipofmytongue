1
00:00:00,000 --> 00:00:04,799
Paul tatarskiy from<font color="#E5E5E5"> University of</font>

2
00:00:02,370 --> 00:00:06,540
<font color="#E5E5E5">California at Santa Cruz he's going to</font>

3
00:00:04,799 --> 00:00:08,790
be talking about how<font color="#E5E5E5"> you sift through</font>

4
00:00:06,540 --> 00:00:10,410
all the information on<font color="#E5E5E5"> flows coming to</font>

5
00:00:08,790 --> 00:00:12,678
your network to find things<font color="#E5E5E5"> that might</font>

6
00:00:10,410 --> 00:00:16,940
be<font color="#E5E5E5"> interesting and perhaps dangerous</font>

7
00:00:12,679 --> 00:00:16,940
using an intrusion detection system

8
00:00:32,310 --> 00:00:38,610
by feeling more awake now<font color="#E5E5E5"> your coffee</font>

9
00:00:36,140 --> 00:00:42,300
the title of this talk is needle in a

10
00:00:38,610 --> 00:00:43,920
haystack I ended<font color="#CCCCCC"> up after losing large</font>

11
00:00:42,300 --> 00:00:46,739
chunk of money yesterday at the<font color="#CCCCCC"> bellagio</font>

12
00:00:43,920 --> 00:00:49,170
I went to<font color="#CCCCCC"> their art museum where I</font>

13
00:00:46,740 --> 00:00:51,960
actually did see a there's an actual

14
00:00:49,170 --> 00:00:54,510
Monet haystacks painting in there give

15
00:00:51,960 --> 00:00:58,860
me some solace so I had to go back to

16
00:00:54,510 --> 00:01:00,360
<font color="#E5E5E5">the ATM to get into that area so in</font>

17
00:00:58,860 --> 00:01:03,540
honor<font color="#E5E5E5"> of that it's called needle and a</font>

18
00:01:00,360 --> 00:01:05,339
sec the name<font color="#E5E5E5"> just at the talk is that</font>

19
00:01:03,540 --> 00:01:07,860
<font color="#E5E5E5">I'm working on looking at intrusion</font>

20
00:01:05,339 --> 00:01:10,979
detection from a slightly reverse point

21
00:01:07,860 --> 00:01:13,320
of view i'm<font color="#E5E5E5"> looking at primarily</font>

22
00:01:10,979 --> 00:01:15,330
removing potential sources of the nine

23
00:01:13,320 --> 00:01:17,970
traffic from<font color="#CCCCCC"> the flows to come in here</font>

24
00:01:15,330 --> 00:01:20,220
network my name is Paul Starsky there's

25
00:01:17,970 --> 00:01:21,929
one email address I've been an intrusion

26
00:01:20,220 --> 00:01:25,140
detection network intrusion detection

27
00:01:21,930 --> 00:01:27,960
operator<font color="#E5E5E5"> pretty much since 1990 my first</font>

28
00:01:25,140 --> 00:01:30,570
IDs was a son IPC in a<font color="#CCCCCC"> 10 make tap into</font>

29
00:01:27,960 --> 00:01:33,210
our backbone I've seen<font color="#E5E5E5"> a lot of packets</font>

30
00:01:30,570 --> 00:01:36,630
go by they've got the traditional good

31
00:01:33,210 --> 00:01:38,220
bad and ugly analogy of the package some

32
00:01:36,630 --> 00:01:40,030
of the packets that go by my network are

33
00:01:38,220 --> 00:01:41,979
extremely nasty

34
00:01:40,030 --> 00:01:43,900
and the analogy that I'll try not<font color="#CCCCCC"> to</font>

35
00:01:41,979 --> 00:01:46,360
abuse too much in this talk is that the

36
00:01:43,900 --> 00:01:49,060
unpublished exploit stream that comes

37
00:01:46,360 --> 00:01:50,770
crashing into your name server gets a

38
00:01:49,060 --> 00:01:53,200
shell on<font color="#E5E5E5"> your main DNS servers the</font>

39
00:01:50,770 --> 00:01:54,610
needle you change the<font color="#E5E5E5"> route of course</font>

40
00:01:53,200 --> 00:01:59,140
though so you don't really<font color="#E5E5E5"> care right</font>

41
00:01:54,610 --> 00:02:03,158
and<font color="#E5E5E5"> benign or understood traffic is the</font>

42
00:01:59,140 --> 00:02:04,869
<font color="#CCCCCC">hay</font><font color="#E5E5E5"> my belief based on what I've been</font>

43
00:02:03,159 --> 00:02:07,840
<font color="#E5E5E5">working on is that it's easier to find</font>

44
00:02:04,869 --> 00:02:10,720
those needles with less<font color="#CCCCCC"> Hey but that the</font>

45
00:02:07,840 --> 00:02:12,820
process of defining hey is sometimes

46
00:02:10,720 --> 00:02:16,570
either easy and in particular it's not

47
00:02:12,820 --> 00:02:19,359
<font color="#E5E5E5">very</font><font color="#CCCCCC"> safe just so you know</font><font color="#E5E5E5"> the</font>

48
00:02:16,570 --> 00:02:21,850
environment I'm pretty small shop I'm

49
00:02:19,360 --> 00:02:23,110
the sole<font color="#E5E5E5"> IDs operator for the University</font>

50
00:02:21,850 --> 00:02:26,140
of California Santa Cruz School of

51
00:02:23,110 --> 00:02:28,959
Engineering we are growing<font color="#E5E5E5"> to two</font>

52
00:02:26,140 --> 00:02:31,679
buildings oh my<font color="#E5E5E5"> goodness we now have</font>

53
00:02:28,959 --> 00:02:34,360
<font color="#E5E5E5">however several gigabit quality uplinks</font>

54
00:02:31,680 --> 00:02:36,310
we have no firewall in place which makes

55
00:02:34,360 --> 00:02:38,950
us get to see<font color="#CCCCCC"> all sorts of interesting</font>

56
00:02:36,310 --> 00:02:40,780
things for about the past six years

57
00:02:38,950 --> 00:02:42,100
we've been a snort shop so if you're

58
00:02:40,780 --> 00:02:46,180
familiar with snort i will probably

59
00:02:42,100 --> 00:02:49,420
speak in snort ease and try to define

60
00:02:46,180 --> 00:02:52,630
things in that IDs language we use spans

61
00:02:49,420 --> 00:02:54,369
to capture our traffic and pretty much

62
00:02:52,630 --> 00:02:56,109
IDs and pretty good system

63
00:02:54,370 --> 00:02:58,610
administration is<font color="#CCCCCC"> the main source</font><font color="#E5E5E5"> of</font>

64
00:02:56,110 --> 00:03:01,760
protection for<font color="#CCCCCC"> our department</font>

65
00:02:58,610 --> 00:03:05,990
so here's the problem in exile<font color="#CCCCCC"> budin</font>

66
00:03:01,760 --> 00:03:07,700
reverse order we have budgetary issues<font color="#E5E5E5"> I</font>

67
00:03:05,990 --> 00:03:09,950
get money to upgrade our<font color="#E5E5E5"> IDs system</font>

68
00:03:07,700 --> 00:03:12,589
about every five years I've got about<font color="#E5E5E5"> a</font>

69
00:03:09,950 --> 00:03:15,260
year and a<font color="#CCCCCC"> half to go I need a way to</font>

70
00:03:12,590 --> 00:03:18,100
better focus on<font color="#E5E5E5"> unknown traffic while</font>

71
00:03:15,260 --> 00:03:21,109
removing several sources of good traffic

72
00:03:18,100 --> 00:03:22,750
that<font color="#CCCCCC"> is coming out of my department in</font>

73
00:03:21,110 --> 00:03:26,030
particular I'm a human genome project

74
00:03:22,750 --> 00:03:27,800
site in my organization which is<font color="#E5E5E5"> the</font>

75
00:03:26,030 --> 00:03:30,740
number<font color="#E5E5E5"> one producer of outbound traffic</font>

76
00:03:27,800 --> 00:03:32,180
on the campus and we are number two and

77
00:03:30,740 --> 00:03:34,190
that we<font color="#E5E5E5"> have a red hat I so mirror</font>

78
00:03:32,180 --> 00:03:37,430
unfortunately located on to my wire as

79
00:03:34,190 --> 00:03:40,160
well our sword box is starting to run

80
00:03:37,430 --> 00:03:42,560
out of gas and we need a way to find

81
00:03:40,160 --> 00:03:45,590
some method to extend its life a little

82
00:03:42,560 --> 00:03:47,150
bit farther and we're also due to<font color="#E5E5E5"> all</font>

83
00:03:45,590 --> 00:03:49,160
the worms and all the other block fun

84
00:03:47,150 --> 00:03:52,190
we're dealing<font color="#CCCCCC"> with on our campus we need</font>

85
00:03:49,160 --> 00:03:54,320
to start spanning internal switches

86
00:03:52,190 --> 00:03:57,530
so why<font color="#E5E5E5"> does that matter to</font><font color="#CCCCCC"> a large</font>

87
00:03:54,320 --> 00:03:59,150
organization we're<font color="#E5E5E5"> hoping that</font><font color="#CCCCCC"> if we can</font>

88
00:03:57,530 --> 00:04:01,940
come up with<font color="#E5E5E5"> sort of a systematic way to</font>

89
00:03:59,150 --> 00:04:05,000
define<font color="#CCCCCC"> hey that perhaps there's a way</font>

90
00:04:01,940 --> 00:04:07,460
<font color="#CCCCCC">for large large networks to apply it to</font>

91
00:04:05,000 --> 00:04:10,250
their<font color="#E5E5E5"> ids system capture points if they</font>

92
00:04:07,460 --> 00:04:12,740
have them and<font color="#E5E5E5"> spend more processing time</font>

93
00:04:10,250 --> 00:04:14,990
and more searching time to spot the

94
00:04:12,740 --> 00:04:18,549
truly nasty three or<font color="#E5E5E5"> four packets that</font>

95
00:04:14,990 --> 00:04:18,549
are really importantly that floats

96
00:04:19,450 --> 00:04:24,039
so in order to start this whole process

97
00:04:21,130 --> 00:04:26,560
<font color="#E5E5E5">we basically had to figure out what are</font>

98
00:04:24,040 --> 00:04:28,990
we looking at for the last<font color="#E5E5E5"> 15</font><font color="#CCCCCC"> years and</font>

99
00:04:26,560 --> 00:04:31,510
we've been trying for a long time<font color="#CCCCCC"> to</font>

100
00:04:28,990 --> 00:04:35,530
keep pretty good track of the top

101
00:04:31,510 --> 00:04:37,539
sources of flows on our network<font color="#E5E5E5"> and as</font>

102
00:04:35,530 --> 00:04:39,700
we do that each year<font color="#E5E5E5"> we also sort of</font>

103
00:04:37,540 --> 00:04:41,770
compare it to the number<font color="#CCCCCC"> of alerts and</font>

104
00:04:39,700 --> 00:04:44,469
signature matches<font color="#CCCCCC"> that come off those</font>

105
00:04:41,770 --> 00:04:46,690
flows so that we can even<font color="#E5E5E5"> get a feeling</font>

106
00:04:44,470 --> 00:04:49,660
for is all that traffic we're looking

107
00:04:46,690 --> 00:04:52,030
through every day even triggering some

108
00:04:49,660 --> 00:04:53,650
of the IDS signatures if you ever<font color="#E5E5E5"> work</font>

109
00:04:52,030 --> 00:04:55,630
with snort snort is basically a

110
00:04:53,650 --> 00:04:59,169
definition of maybe three thousand

111
00:04:55,630 --> 00:05:01,990
needles<font color="#CCCCCC"> rule</font><font color="#E5E5E5"> base rule sets as they come</font>

112
00:04:59,170 --> 00:05:04,330
is a very specific<font color="#E5E5E5"> set of packets to</font>

113
00:05:01,990 --> 00:05:07,360
look<font color="#CCCCCC"> for is what we're digging through</font>

114
00:05:04,330 --> 00:05:09,719
every day<font color="#E5E5E5"> even triggering that type of</font>

115
00:05:07,360 --> 00:05:09,720
information

116
00:05:10,440 --> 00:05:15,960
so how do you start to define hey we

117
00:05:13,860 --> 00:05:19,860
took a pretty simple approach to it we

118
00:05:15,960 --> 00:05:22,680
<font color="#E5E5E5">looked for systems that we manage so I'm</font>

119
00:05:19,860 --> 00:05:24,540
also a system administrator for<font color="#CCCCCC"> the</font>

120
00:05:22,680 --> 00:05:26,310
flows coming out of the systems we

121
00:05:24,540 --> 00:05:29,790
managed can we come up with<font color="#CCCCCC"> a definition</font>

122
00:05:26,310 --> 00:05:32,160
of what this stuff is and here's a sort

123
00:05:29,790 --> 00:05:33,990
of<font color="#E5E5E5"> example of what we came up</font><font color="#CCCCCC"> with we</font>

124
00:05:32,160 --> 00:05:36,240
have a set of public my sequel servers

125
00:05:33,990 --> 00:05:39,290
which have been following things lately

126
00:05:36,240 --> 00:05:42,540
was kind of exciting last week we have a

127
00:05:39,290 --> 00:05:46,290
large amount of regular traditional

128
00:05:42,540 --> 00:05:48,750
download sources with FTP HTTP<font color="#CCCCCC"> rsync</font>

129
00:05:46,290 --> 00:05:52,200
<font color="#E5E5E5">download sources we do have</font><font color="#CCCCCC"> a red hat</font>

130
00:05:48,750 --> 00:05:55,410
ISIL mirror we have both research

131
00:05:52,200 --> 00:05:58,229
<font color="#E5E5E5">peer-to-peer and another kind of</font>

132
00:05:55,410 --> 00:06:00,000
peer-to-peer usage we have internet

133
00:05:58,230 --> 00:06:02,040
scalable file systems<font color="#E5E5E5"> and some non</font>

134
00:06:00,000 --> 00:06:03,780
internet scalable file systems running a

135
00:06:02,040 --> 00:06:06,570
pretty good chunk of<font color="#E5E5E5"> data around I'm</font>

136
00:06:03,780 --> 00:06:08,669
going to particularly have<font color="#CCCCCC"> AFS we have</font>

137
00:06:06,570 --> 00:06:10,650
backups all throughout<font color="#E5E5E5"> the campus and of</font>

138
00:06:08,670 --> 00:06:12,120
course<font color="#E5E5E5"> we have a temp to get everyone to</font>

139
00:06:10,650 --> 00:06:14,880
automatically update quite frequently

140
00:06:12,120 --> 00:06:16,500
and some other<font color="#CCCCCC"> hey examples we have a</font>

141
00:06:14,880 --> 00:06:19,140
lot of students that<font color="#E5E5E5"> go make DPN</font>

142
00:06:16,500 --> 00:06:21,120
connections various places and an

143
00:06:19,140 --> 00:06:23,520
emerging amount of extra video

144
00:06:21,120 --> 00:06:25,509
conferencing and phone calls<font color="#E5E5E5"> over the</font>

145
00:06:23,520 --> 00:06:28,998
internet

146
00:06:25,509 --> 00:06:31,009
so we also tend to do<font color="#CCCCCC"> everything in our</font>

147
00:06:28,999 --> 00:06:33,999
department with stuff that we can find

148
00:06:31,009 --> 00:06:38,479
in<font color="#E5E5E5"> open-source land she's been wonderful</font>

149
00:06:33,999 --> 00:06:41,389
we purchased<font color="#E5E5E5"> a fairly large cheap IDE</font>

150
00:06:38,479 --> 00:06:43,938
raid it<font color="#E5E5E5"> holds enough packets for us to</font>

151
00:06:41,389 --> 00:06:46,009
do some kind<font color="#E5E5E5"> of analysis on them and we</font>

152
00:06:43,939 --> 00:06:49,159
use<font color="#E5E5E5"> a variety of tools after capturing</font>

153
00:06:46,009 --> 00:06:50,779
<font color="#CCCCCC">them with good old TCP dump we use there</font>

154
00:06:49,159 --> 00:06:53,869
<font color="#E5E5E5">is a slide of URLs the end if</font><font color="#CCCCCC"> you want</font>

155
00:06:50,779 --> 00:06:55,759
to skip to that we use TCP flow which

156
00:06:53,869 --> 00:06:59,029
actually works quite well to just do it

157
00:06:55,759 --> 00:07:01,360
a quick source desk<font color="#CCCCCC"> breakout of</font><font color="#E5E5E5"> files</font>

158
00:06:59,029 --> 00:07:03,889
you can see what<font color="#E5E5E5"> you're dealing with</font>

159
00:07:01,360 --> 00:07:04,909
snort also has a sort<font color="#E5E5E5"> of not too well</font>

160
00:07:03,889 --> 00:07:06,949
documented feature where you can

161
00:07:04,909 --> 00:07:10,819
actually put in a session log mode and

162
00:07:06,949 --> 00:07:12,919
it builds out this nice tree on the UNIX

163
00:07:10,819 --> 00:07:14,210
file system of the data and anywhere it

164
00:07:12,919 --> 00:07:16,729
went and<font color="#E5E5E5"> you can actually then use</font>

165
00:07:14,210 --> 00:07:19,388
<font color="#CCCCCC">unix-like bu commands sort of get a</font>

166
00:07:16,729 --> 00:07:22,399
quick view of who's sending what where

167
00:07:19,389 --> 00:07:23,990
we took an<font color="#E5E5E5"> old tool called tcpd stat</font>

168
00:07:22,399 --> 00:07:26,539
which gives you sort<font color="#E5E5E5"> of a statistical</font>

169
00:07:23,990 --> 00:07:29,779
analysis of the flow sizes and the

170
00:07:26,539 --> 00:07:32,449
<font color="#E5E5E5">standard deviation of the flow sizes we</font>

171
00:07:29,779 --> 00:07:34,149
use in top periodically we get net flow

172
00:07:32,449 --> 00:07:38,360
statistics for fine central

173
00:07:34,149 --> 00:07:40,550
administrators on campus and if you<font color="#E5E5E5"> look</font>

174
00:07:38,360 --> 00:07:44,330
at these flows long enough you will

175
00:07:40,550 --> 00:07:46,689
notice large numbers of repeated large

176
00:07:44,330 --> 00:07:46,688
things

177
00:07:46,700 --> 00:07:50,969
that's rude

178
00:07:48,720 --> 00:07:53,130
for a<font color="#E5E5E5"> very small sample period we just</font>

179
00:07:50,970 --> 00:07:55,740
did a quick<font color="#E5E5E5"> comparison of</font><font color="#CCCCCC"> four flows</font>

180
00:07:53,130 --> 00:07:58,560
greater than<font color="#E5E5E5"> 50 megabytes in size what</font>

181
00:07:55,740 --> 00:08:01,410
was going around<font color="#CCCCCC"> on our network this</font><font color="#E5E5E5"> is</font>

182
00:07:58,560 --> 00:08:03,150
not a large network I repeat we had a

183
00:08:01,410 --> 00:08:05,070
<font color="#E5E5E5">very</font><font color="#CCCCCC"> small number of flows that exceeded</font>

184
00:08:03,150 --> 00:08:08,549
a gigabyte inside we got a pretty<font color="#E5E5E5"> good</font>

185
00:08:05,070 --> 00:08:09,960
chunk of around 500 megabytes mostly

186
00:08:08,550 --> 00:08:13,980
clustering up at the size of<font color="#E5E5E5"> an ISO</font>

187
00:08:09,960 --> 00:08:16,409
image keep boiling up around 50 megabyte

188
00:08:13,980 --> 00:08:21,630
only 350 so all told on this slide

189
00:08:16,410 --> 00:08:23,270
there's about six hundred flows during

190
00:08:21,630 --> 00:08:25,680
that same sample period there were over

191
00:08:23,270 --> 00:08:27,950
300,000 smaller flows which I didn't put

192
00:08:25,680 --> 00:08:31,290
on<font color="#E5E5E5"> the graph this 'makeup a funny line</font>

193
00:08:27,950 --> 00:08:33,179
and almost all the alerts to trigger

194
00:08:31,290 --> 00:08:34,740
during that flow period<font color="#E5E5E5"> almost all the</font>

195
00:08:33,179 --> 00:08:36,809
alerts whether they're false positive or

196
00:08:34,740 --> 00:08:39,570
not we're<font color="#E5E5E5"> in those 300,000 smaller</font>

197
00:08:36,809 --> 00:08:41,880
floats however if you add up the bytes

198
00:08:39,570 --> 00:08:43,650
that were in those top six hundred flows

199
00:08:41,880 --> 00:08:45,420
we're<font color="#E5E5E5"> talking thirty three percent of</font>

200
00:08:43,650 --> 00:08:47,250
all the work the capture card was doing

201
00:08:45,420 --> 00:08:50,790
was dealing with<font color="#E5E5E5"> those large glows and</font>

202
00:08:47,250 --> 00:08:54,030
the top<font color="#CCCCCC"> twenty flows represented seven</font>

203
00:08:50,790 --> 00:08:56,240
percent of<font color="#E5E5E5"> all our traffic for that</font>

204
00:08:54,030 --> 00:08:56,240
period

205
00:08:56,390 --> 00:09:00,949
so some<font color="#CCCCCC"> of the traditional quick ways</font>

206
00:08:58,460 --> 00:09:02,630
that we've used to define hey if you've

207
00:09:00,950 --> 00:09:04,670
ever worked<font color="#E5E5E5"> like pcap you know you can</font>

208
00:09:02,630 --> 00:09:07,790
define nice very complicated not

209
00:09:04,670 --> 00:09:11,060
expressions that if you use with a tool

210
00:09:07,790 --> 00:09:13,400
built on top of<font color="#CCCCCC"> line pcap can in</font>

211
00:09:11,060 --> 00:09:16,550
software prevent those packets being

212
00:09:13,400 --> 00:09:18,470
seen by the engine but it as soon<font color="#E5E5E5"> as</font><font color="#CCCCCC"> you</font>

213
00:09:16,550 --> 00:09:20,900
know quite a bit about what's flowing

214
00:09:18,470 --> 00:09:23,480
where and how to define it<font color="#E5E5E5"> and if you</font>

215
00:09:20,900 --> 00:09:27,459
<font color="#E5E5E5">get it incorrect your IDs engine</font>

216
00:09:23,480 --> 00:09:27,460
completely completely lose those packets

217
00:09:27,550 --> 00:09:31,180
snort has a wonderful feature called a

218
00:09:29,870 --> 00:09:33,760
pass rule

219
00:09:31,180 --> 00:09:36,699
where you can start to define very

220
00:09:33,760 --> 00:09:38,319
specific content level rules that say I

221
00:09:36,700 --> 00:09:41,380
really<font color="#E5E5E5"> don't want to do any further</font>

222
00:09:38,320 --> 00:09:44,560
processing on a flow that contains Ricky

223
00:09:41,380 --> 00:09:48,340
Martin's world<font color="#E5E5E5"> mp3 album or whatever I</font>

224
00:09:44,560 --> 00:09:49,900
don't<font color="#CCCCCC"> need to look</font><font color="#E5E5E5"> at this newer snort</font>

225
00:09:48,340 --> 00:09:51,520
has the ability to mark flows with

226
00:09:49,900 --> 00:09:53,079
what's called a flow bit which I view is

227
00:09:51,520 --> 00:09:55,780
kind of a little<font color="#E5E5E5"> check mark where you</font>

228
00:09:53,080 --> 00:09:57,490
can go in<font color="#E5E5E5"> and say well i think this flow</font>

229
00:09:55,780 --> 00:09:59,740
is this and then maybe<font color="#E5E5E5"> another rule says</font>

230
00:09:57,490 --> 00:10:03,160
oh yeah it's definitely that and you can

231
00:09:59,740 --> 00:10:06,640
start whittling down rose or rules that

232
00:10:03,160 --> 00:10:07,990
snort uses to process those packets but

233
00:10:06,640 --> 00:10:09,340
<font color="#E5E5E5">the bottom line is snort is still</font>

234
00:10:07,990 --> 00:10:14,410
reading all that information into

235
00:10:09,340 --> 00:10:17,170
attention here's a sample pass rule just

236
00:10:14,410 --> 00:10:18,430
so you can see<font color="#CCCCCC"> it it's it just</font><font color="#E5E5E5"> as an</font>

237
00:10:17,170 --> 00:10:21,729
example<font color="#E5E5E5"> I wouldn't recommend running</font>

238
00:10:18,430 --> 00:10:24,810
this but it's a chunk of content it's in

239
00:10:21,730 --> 00:10:28,810
every ISIL header on a CD I've left out

240
00:10:24,810 --> 00:10:32,079
roughly 3,000 32,000<font color="#CCCCCC"> zeros</font><font color="#E5E5E5"> there in</font>

241
00:10:28,810 --> 00:10:35,020
front of it but every<font color="#CCCCCC"> ISO image does</font>

242
00:10:32,080 --> 00:10:36,340
contain this chunk of information

243
00:10:35,020 --> 00:10:37,900
actually<font color="#CCCCCC"> it's kind of interesting to put</font>

244
00:10:36,340 --> 00:10:40,660
in an alert mode you can see how<font color="#CCCCCC"> many</font>

245
00:10:37,900 --> 00:10:42,160
Isis are coming across your network can

246
00:10:40,660 --> 00:10:44,410
<font color="#E5E5E5">I certify that someone isn't going to</font>

247
00:10:42,160 --> 00:10:47,230
put 32,000 zeros in<font color="#E5E5E5"> their next piece of</font>

248
00:10:44,410 --> 00:10:49,170
<font color="#E5E5E5">shell code know what you might see it</font>

249
00:10:47,230 --> 00:10:51,570
there

250
00:10:49,170 --> 00:10:54,329
some very simple test to show what

251
00:10:51,570 --> 00:10:58,649
<font color="#CCCCCC">happens just when</font><font color="#E5E5E5"> you move around 1i so</font>

252
00:10:54,329 --> 00:11:02,579
okay<font color="#E5E5E5"> so this is a fedora disc one of</font>

253
00:10:58,649 --> 00:11:07,410
<font color="#CCCCCC">just three aw I Fedora three disc one I</font>

254
00:11:02,579 --> 00:11:10,880
so between two hosts on port 9999 with

255
00:11:07,410 --> 00:11:14,010
snort in assembly mode for that port

256
00:11:10,880 --> 00:11:15,689
it's a 630 a megabyte flow and I'm going

257
00:11:14,010 --> 00:11:21,060
to on this graph show you a couple of

258
00:11:15,690 --> 00:11:23,339
<font color="#E5E5E5">ways it impacts this is most intended</font>

259
00:11:21,060 --> 00:11:26,489
just to show relative impact<font color="#CCCCCC"> norm I</font>

260
00:11:23,339 --> 00:11:28,920
forced slow machine the first line is

261
00:11:26,490 --> 00:11:30,990
basically a regular TCP dump you

262
00:11:28,920 --> 00:11:34,740
<font color="#E5E5E5">basically see the system's working you</font>

263
00:11:30,990 --> 00:11:38,399
know working fairly hard TCP dump if I

264
00:11:34,740 --> 00:11:42,350
take out just port 9999 it cuts up half

265
00:11:38,399 --> 00:11:44,940
a point off one of the CPU system layers

266
00:11:42,350 --> 00:11:48,690
no change if i take the source<font color="#CCCCCC"> host</font>

267
00:11:44,940 --> 00:11:52,050
address and the source port off to show

268
00:11:48,690 --> 00:11:54,510
relative impact on snort the snort

269
00:11:52,050 --> 00:11:56,339
alerts rule no content check is just a

270
00:11:54,510 --> 00:11:58,560
snort rule that doesn't even dig into

271
00:11:56,339 --> 00:12:00,350
the<font color="#CCCCCC"> package so that's sort of the</font>

272
00:11:58,560 --> 00:12:05,640
<font color="#E5E5E5">baseline that comes in around five</font>

273
00:12:00,350 --> 00:12:07,920
seconds<font color="#E5E5E5"> of the user</font><font color="#CCCCCC"> cpu time and then as</font>

274
00:12:05,640 --> 00:12:11,430
we go down the line the next one is<font color="#CCCCCC"> a</font>

275
00:12:07,920 --> 00:12:13,500
snort rule with a content field to be

276
00:12:11,430 --> 00:12:16,800
searched for in the packet it exists

277
00:12:13,500 --> 00:12:18,660
nowhere in the<font color="#E5E5E5"> iso that word is hoptoad</font>

278
00:12:16,800 --> 00:12:21,449
there's no word hoptoad anywhere in the

279
00:12:18,660 --> 00:12:23,370
<font color="#E5E5E5">fedora 3i so you see that</font><font color="#CCCCCC"> it basically</font>

280
00:12:21,450 --> 00:12:25,140
matches the amount<font color="#E5E5E5"> of CPU time that if</font>

281
00:12:23,370 --> 00:12:28,980
you actually match the word on the iso

282
00:12:25,140 --> 00:12:32,130
is the next line and pass rules produce

283
00:12:28,980 --> 00:12:33,980
the same level<font color="#CCCCCC"> of impact and the last</font>

284
00:12:32,130 --> 00:12:36,480
line is actually if<font color="#CCCCCC"> i have a two rules</font>

285
00:12:33,980 --> 00:12:40,410
just to<font color="#CCCCCC"> show it's starting to work</font>

286
00:12:36,480 --> 00:12:43,440
harder to get more done so what we were

287
00:12:40,410 --> 00:12:45,230
trying<font color="#E5E5E5"> to basically deal with is sure</font>

288
00:12:43,440 --> 00:12:47,700
would<font color="#E5E5E5"> be nice to get this off the</font>

289
00:12:45,230 --> 00:12:50,459
operating system<font color="#E5E5E5"> of</font><font color="#CCCCCC"> the machine can</font><font color="#E5E5E5"> I</font>

290
00:12:47,700 --> 00:12:54,060
<font color="#CCCCCC">get it out of the base</font><font color="#E5E5E5"> of the OS stack</font>

291
00:12:50,459 --> 00:12:57,000
and get it perhaps offloaded someplace

292
00:12:54,060 --> 00:12:59,849
else we had a<font color="#E5E5E5"> lot of concerns we started</font>

293
00:12:57,000 --> 00:13:02,190
looking for solutions for<font color="#E5E5E5"> this we really</font>

294
00:12:59,850 --> 00:13:05,190
think streams are vital to doing good<font color="#E5E5E5"> i</font>

295
00:13:02,190 --> 00:13:07,230
des we really want<font color="#E5E5E5"> to know is this a</font>

296
00:13:05,190 --> 00:13:09,930
orderly session of packages you know

297
00:13:07,230 --> 00:13:12,510
who's sending it how's it<font color="#CCCCCC"> going</font><font color="#E5E5E5"> we want</font>

298
00:13:09,930 --> 00:13:14,609
to be able to stop<font color="#E5E5E5"> looking</font><font color="#CCCCCC"> at some</font>

299
00:13:12,510 --> 00:13:17,250
streams after we have a reasonable

300
00:13:14,610 --> 00:13:19,990
degree of certainty that it is<font color="#E5E5E5"> truly a</font>

301
00:13:17,250 --> 00:13:22,690
good stream<font color="#CCCCCC"> okay</font>

302
00:13:19,990 --> 00:13:24,130
and then we're big chickens we don't

303
00:13:22,690 --> 00:13:26,980
trust our ability<font color="#CCCCCC"> to always do this</font>

304
00:13:24,130 --> 00:13:29,290
correctly we want to cheaply and easily

305
00:13:26,980 --> 00:13:30,700
actually<font color="#E5E5E5"> record it all anyway just to</font>

306
00:13:29,290 --> 00:13:34,149
double check periodically if<font color="#CCCCCC"> we did it</font>

307
00:13:30,700 --> 00:13:36,520
<font color="#CCCCCC">correctly and our goal at the very least</font>

308
00:13:34,149 --> 00:13:40,290
was to take some<font color="#E5E5E5"> of our plight pcap not</font>

309
00:13:36,520 --> 00:13:40,290
clauses and push them<font color="#E5E5E5"> out into hardware</font>

310
00:13:41,779 --> 00:13:45,959
started looking around<font color="#E5E5E5"> and actually i</font>

311
00:13:43,859 --> 00:13:47,910
was introduced to<font color="#E5E5E5"> a card from a firm</font>

312
00:13:45,959 --> 00:13:50,699
called meta networks called the MTP card

313
00:13:47,910 --> 00:13:53,579
and the piece that<font color="#E5E5E5"> was introduced to me</font>

314
00:13:50,699 --> 00:13:56,849
as it uses snort rules to define in its

315
00:13:53,579 --> 00:14:00,149
brain what it wants<font color="#E5E5E5"> to capture versus</font>

316
00:13:56,850 --> 00:14:03,269
not capture and it keeps a state table

317
00:14:00,149 --> 00:14:07,589
of source and destination host and port

318
00:14:03,269 --> 00:14:09,829
flows so there's some ability to know is

319
00:14:07,589 --> 00:14:12,869
it part<font color="#E5E5E5"> of an existing stream or not and</font>

320
00:14:09,829 --> 00:14:15,719
then is a nice cost saver for our small

321
00:14:12,869 --> 00:14:17,639
<font color="#CCCCCC">department it has a backup tap on the</font>

322
00:14:15,720 --> 00:14:20,249
side of it that<font color="#CCCCCC"> actually access to the</font>

323
00:14:17,639 --> 00:14:21,929
mini regeneration tap you get all the

324
00:14:20,249 --> 00:14:26,970
packets without the filtering out that

325
00:14:21,929 --> 00:14:29,309
tap and if it rep matches its rule sets

326
00:14:26,970 --> 00:14:30,509
it hands it up to the operating system

327
00:14:29,309 --> 00:14:35,129
as if it was a regular ethernet

328
00:14:30,509 --> 00:14:36,450
interface here's a glorious picture of

329
00:14:35,129 --> 00:14:39,240
our<font color="#E5E5E5"> setup</font>

330
00:14:36,450 --> 00:14:42,720
we have the dark cloud of the<font color="#E5E5E5"> outside</font>

331
00:14:39,240 --> 00:14:45,150
<font color="#CCCCCC">world my lovely vizio copy and paste</font>

332
00:14:42,720 --> 00:14:47,580
switch with a spam court that's pulling

333
00:14:45,150 --> 00:14:49,949
into the primary capture interface of

334
00:14:47,580 --> 00:14:52,290
the cart and<font color="#CCCCCC"> then out the mirrored</font>

335
00:14:49,950 --> 00:14:55,380
captioner face i go to a pretty<font color="#E5E5E5"> basic</font>

336
00:14:52,290 --> 00:14:57,480
box with a large<font color="#CCCCCC"> Ikey raid to try to</font>

337
00:14:55,380 --> 00:14:59,870
keep some degree of retrospective<font color="#E5E5E5"> of the</font>

338
00:14:57,480 --> 00:14:59,870
packets

339
00:15:00,760 --> 00:15:06,490
we started with<font color="#E5E5E5"> basically simple</font>

340
00:15:02,800 --> 00:15:08,140
translation of some of the live pcap

341
00:15:06,490 --> 00:15:10,060
rules that we've kept around in a file

342
00:15:08,140 --> 00:15:13,150
<font color="#CCCCCC">that we use years most</font><font color="#E5E5E5"> of them are</font>

343
00:15:10,060 --> 00:15:15,459
excellent report but we started<font color="#E5E5E5"> removing</font>

344
00:15:13,150 --> 00:15:17,079
things like the backup server get the

345
00:15:15,460 --> 00:15:19,420
backup server out<font color="#CCCCCC"> of there get all the</font>

346
00:15:17,080 --> 00:15:20,800
update rpms from<font color="#E5E5E5"> Red Hat out of there</font>

347
00:15:19,420 --> 00:15:23,680
because<font color="#CCCCCC"> a lot of them trigger false</font>

348
00:15:20,800 --> 00:15:26,979
positives on some snore delivers and you

349
00:15:23,680 --> 00:15:30,010
compile up the rules and you load it

350
00:15:26,980 --> 00:15:33,730
into this card's engine and it actually

351
00:15:30,010 --> 00:15:35,710
did some interesting results scale this

352
00:15:33,730 --> 00:15:39,580
graph is<font color="#E5E5E5"> a little changed its three on</font>

353
00:15:35,710 --> 00:15:41,790
the far side but at the top of the graph

354
00:15:39,580 --> 00:15:45,040
here we have the TCP dump on the<font color="#E5E5E5"> same</font>

355
00:15:41,790 --> 00:15:47,860
638 megabyte ISO image just<font color="#E5E5E5"> as the</font>

356
00:15:45,040 --> 00:15:50,740
reference point then we have<font color="#CCCCCC"> another</font>

357
00:15:47,860 --> 00:15:53,980
reference point of if i remove port 9999

358
00:15:50,740 --> 00:15:55,570
from the capture<font color="#CCCCCC"> and then an interesting</font>

359
00:15:53,980 --> 00:15:57,050
thing happens when<font color="#E5E5E5"> i tell the card to do</font>

360
00:15:55,570 --> 00:16:00,140
that for<font color="#E5E5E5"> me</font>

361
00:15:57,050 --> 00:16:02,540
the<font color="#E5E5E5"> cpu's is on the host drops to</font>

362
00:16:00,140 --> 00:16:04,430
basically next to nothing well fairly

363
00:16:02,540 --> 00:16:09,560
obviously because no<font color="#E5E5E5"> packets come off</font>

364
00:16:04,430 --> 00:16:12,199
the car if I then put in the same

365
00:16:09,560 --> 00:16:14,479
reference point of<font color="#E5E5E5"> TCP dumping using the</font>

366
00:16:12,200 --> 00:16:17,209
server sending back the data to the

367
00:16:14,480 --> 00:16:18,740
client as a reference and<font color="#CCCCCC"> then I tell</font>

368
00:16:17,209 --> 00:16:21,349
the card to drop the server side

369
00:16:18,740 --> 00:16:24,680
conversation I get a pretty significant

370
00:16:21,350 --> 00:16:28,160
cut in CP unions and I get enough of the

371
00:16:24,680 --> 00:16:30,140
information<font color="#E5E5E5"> to know that there was still</font>

372
00:16:28,160 --> 00:16:32,329
a large flow but I don't have that large

373
00:16:30,140 --> 00:16:34,750
flow taking<font color="#E5E5E5"> up my snort engines up cpu</font>

374
00:16:32,329 --> 00:16:34,750
time

375
00:16:36,390 --> 00:16:41,730
we are trying now to push farther into

376
00:16:39,780 --> 00:16:44,550
layer<font color="#CCCCCC"> 3 going into the content of the</font>

377
00:16:41,730 --> 00:16:47,130
packet we'd like<font color="#E5E5E5"> to</font><font color="#CCCCCC"> take our collection</font>

378
00:16:44,550 --> 00:16:50,189
of pass rules some of<font color="#E5E5E5"> which are years</font>

379
00:16:47,130 --> 00:16:52,230
old things we'd like to ignore and we'd

380
00:16:50,190 --> 00:16:54,150
<font color="#E5E5E5">like to push them down into the car and</font>

381
00:16:52,230 --> 00:16:57,090
I've got kind of an<font color="#CCCCCC"> example and they try</font>

382
00:16:54,150 --> 00:16:59,939
to show with ethereal we would like<font color="#E5E5E5"> to</font>

383
00:16:57,090 --> 00:17:01,830
<font color="#E5E5E5">be able to push</font><font color="#CCCCCC"> down into hardware a lot</font>

384
00:16:59,940 --> 00:17:04,560
<font color="#E5E5E5">of the things</font><font color="#CCCCCC"> that we're doing manually</font>

385
00:17:01,830 --> 00:17:07,560
with<font color="#E5E5E5"> P caps we'd like</font><font color="#CCCCCC"> to say once we see</font>

386
00:17:04,560 --> 00:17:10,440
it's one of the reasonable signatures

387
00:17:07,560 --> 00:17:12,569
for a large red hat I so don't<font color="#E5E5E5"> bother we</font>

388
00:17:10,440 --> 00:17:14,640
don't need the data we'd<font color="#E5E5E5"> like</font><font color="#CCCCCC"> to write</font>

389
00:17:12,569 --> 00:17:16,530
dynamic rules that detect passive ftp

390
00:17:14,640 --> 00:17:19,260
because we<font color="#E5E5E5"> still</font><font color="#CCCCCC"> have a large amount of</font>

391
00:17:16,530 --> 00:17:21,959
passive ftp downloads it perhaps parse

392
00:17:19,260 --> 00:17:24,359
the lines in the past<font color="#E5E5E5"> v section and say</font>

393
00:17:21,959 --> 00:17:26,760
there's a big data flow coming and we

394
00:17:24,359 --> 00:17:29,459
might<font color="#E5E5E5"> not want to see it we're trying to</font>

395
00:17:26,760 --> 00:17:31,890
remove in an intelligent way some of the

396
00:17:29,460 --> 00:17:35,490
components of windows update all the

397
00:17:31,890 --> 00:17:37,860
various linux update services etc all in

398
00:17:35,490 --> 00:17:39,900
a goal of doing more with the small

399
00:17:37,860 --> 00:17:42,290
chunk of resources we have for our ids

400
00:17:39,900 --> 00:17:42,290
bonus

401
00:17:42,550 --> 00:17:47,770
<font color="#CCCCCC">I'll</font><font color="#E5E5E5"> show you an example after I just do</font>

402
00:17:44,560 --> 00:17:50,200
a couple quick summary here

403
00:17:47,770 --> 00:17:52,240
the goal is if it works<font color="#CCCCCC"> for</font><font color="#E5E5E5"> us on a</font>

404
00:17:50,200 --> 00:17:55,090
<font color="#E5E5E5">small scale that it might scale up but</font>

405
00:17:52,240 --> 00:17:57,970
you might be<font color="#CCCCCC"> able</font><font color="#E5E5E5"> to produce for not as</font>

406
00:17:55,090 --> 00:18:00,790
much<font color="#CCCCCC"> hardware ability the ability to</font>

407
00:17:57,970 --> 00:18:03,610
capture really<font color="#E5E5E5"> heavy flow and do some</font>

408
00:18:00,790 --> 00:18:05,740
<font color="#CCCCCC">reasonable IDs against it we're also</font>

409
00:18:03,610 --> 00:18:08,949
hoping that if we can<font color="#E5E5E5"> get very specific</font>

410
00:18:05,740 --> 00:18:12,010
content rules out into the flow removal

411
00:18:08,950 --> 00:18:14,560
list that you could really<font color="#E5E5E5"> focus into</font>

412
00:18:12,010 --> 00:18:17,050
very particular tax against something

413
00:18:14,560 --> 00:18:19,659
very important for routers<font color="#CCCCCC"> or the nest</font>

414
00:18:17,050 --> 00:18:21,970
servers and we're also hoping that the

415
00:18:19,660 --> 00:18:25,060
we can basically scrimp a little bit on

416
00:18:21,970 --> 00:18:29,440
the pc cost for the<font color="#CCCCCC"> ids system if we can</font>

417
00:18:25,060 --> 00:18:33,510
offload it on to the cars now<font color="#CCCCCC"> i'm an</font>

418
00:18:29,440 --> 00:18:33,510
attempt to see<font color="#E5E5E5"> if you can see this here</font>

419
00:18:36,909 --> 00:18:47,679
here's<font color="#CCCCCC"> the ethereal dump follow</font><font color="#E5E5E5"> TCP</font>

420
00:18:44,229 --> 00:18:52,529
stream of the<font color="#CCCCCC"> Fedora 3i so coming across</font>

421
00:18:47,679 --> 00:18:56,619
<font color="#E5E5E5">the net</font><font color="#CCCCCC"> zeros look at all those zeroes I</font>

422
00:18:52,529 --> 00:18:58,269
wonder what's going on here and<font color="#CCCCCC"> then we</font>

423
00:18:56,619 --> 00:19:02,049
get this lovely message embedded in the

424
00:18:58,269 --> 00:19:05,710
top of<font color="#CCCCCC"> the ISO which has befallen the</font>

425
00:19:02,049 --> 00:19:07,869
IDS business a piece of flair we've got

426
00:19:05,710 --> 00:19:11,169
a date stamp we've got some information

427
00:19:07,869 --> 00:19:13,899
we've got a funny little md5 and we've

428
00:19:11,169 --> 00:19:16,979
got this lovely warning telling me this

429
00:19:13,899 --> 00:19:21,099
is<font color="#E5E5E5"> not the</font><font color="#CCCCCC"> same running md5 in this I so</font>

430
00:19:16,979 --> 00:19:24,549
we took basically this section of

431
00:19:21,099 --> 00:19:27,249
content we made<font color="#CCCCCC"> it a snort password he</font>

432
00:19:24,549 --> 00:19:29,979
said if you see this we don't want to

433
00:19:27,249 --> 00:19:33,340
see any<font color="#CCCCCC"> more of this flow and compiled</font>

434
00:19:29,979 --> 00:19:35,019
it into the card op activated that

435
00:19:33,340 --> 00:19:37,709
firmware on<font color="#CCCCCC"> the card and ran the same</font>

436
00:19:35,019 --> 00:19:37,710
<font color="#E5E5E5">cap for again</font>

437
00:19:37,750 --> 00:19:41,789
and what we get

438
00:19:39,600 --> 00:19:43,469
it's<font color="#E5E5E5"> kind of funny looking from a flow</font>

439
00:19:41,789 --> 00:19:47,940
point of view but the flow looks normal

440
00:19:43,470 --> 00:19:53,760
look at all those<font color="#E5E5E5"> zeros and then we hit</font>

441
00:19:47,940 --> 00:19:57,809
the start of the marker and chunk it's

442
00:19:53,760 --> 00:19:59,280
gone<font color="#CCCCCC"> and you continue to see the</font>

443
00:19:57,809 --> 00:20:00,690
conversation and<font color="#E5E5E5"> you don't see it in</font>

444
00:19:59,280 --> 00:20:04,110
politics extreme because<font color="#E5E5E5"> there's no data</font>

445
00:20:00,690 --> 00:20:06,929
in<font color="#E5E5E5"> it from the</font><font color="#CCCCCC"> client in the server but</font>

446
00:20:04,110 --> 00:20:08,490
all<font color="#CCCCCC"> that rest of</font><font color="#E5E5E5"> the roughly 636</font>

447
00:20:06,929 --> 00:20:13,320
megabytes of data is no longer<font color="#CCCCCC"> in the</font>

448
00:20:08,490 --> 00:20:15,120
flow so our goal in the end is if we can

449
00:20:13,320 --> 00:20:17,639
come up with a rational set of rules

450
00:20:15,120 --> 00:20:20,129
then try to<font color="#E5E5E5"> reduce some of that level of</font>

451
00:20:17,640 --> 00:20:21,960
traffic that we will be able<font color="#E5E5E5"> to do much</font>

452
00:20:20,130 --> 00:20:26,100
more capturing and get much more out of

453
00:20:21,960 --> 00:20:29,100
it that's<font color="#E5E5E5"> not</font><font color="#CCCCCC"> all</font>

454
00:20:26,100 --> 00:20:29,100
questions

455
00:20:34,320 --> 00:20:41,570
hi paul kappa render in my brief dealing

456
00:20:38,009 --> 00:20:47,130
with with<font color="#E5E5E5"> university of</font>

457
00:20:41,570 --> 00:20:48,990
wisconsin-madison they have think you

458
00:20:47,130 --> 00:20:51,409
two probably know<font color="#E5E5E5"> what I'm doing</font><font color="#CCCCCC"> i think</font>

459
00:20:48,990 --> 00:20:55,470
so<font color="#CCCCCC"> ok they've written some vicious</font>

460
00:20:51,409 --> 00:20:58,549
malicious traffic composition

461
00:20:55,470 --> 00:21:01,830
environment script which is best

462
00:20:58,549 --> 00:21:05,639
specifically digits and<font color="#CCCCCC"> mod comparison</font>

463
00:21:01,830 --> 00:21:08,100
between snort and grow and<font color="#E5E5E5"> they found</font>

464
00:21:05,639 --> 00:21:09,899
<font color="#E5E5E5">out from the reassembly of the packets</font>

465
00:21:08,100 --> 00:21:12,750
which you mentioned I me a cpu

466
00:21:09,899 --> 00:21:16,439
utilization is saw snort justiça

467
00:21:12,750 --> 00:21:20,340
nosedive<font color="#CCCCCC"> wires bro stood up to the to</font>

468
00:21:16,440 --> 00:21:21,750
the test but<font color="#E5E5E5"> with MTP up do you see any</font>

469
00:21:20,340 --> 00:21:26,570
difference they're offloading that

470
00:21:21,750 --> 00:21:28,740
process to<font color="#CCCCCC"> mt pecan to the MTP card I</font>

471
00:21:26,570 --> 00:21:31,408
together I haven't<font color="#E5E5E5"> used grow in a while</font>

472
00:21:28,740 --> 00:21:34,860
but<font color="#E5E5E5"> I've always liked grow as a way of</font>

473
00:21:31,409 --> 00:21:37,919
doing<font color="#CCCCCC"> that yes I it's like pcap based in</font>

474
00:21:34,860 --> 00:21:41,178
theory the same removal should fly from

475
00:21:37,919 --> 00:21:43,559
row in the same way sort has become our

476
00:21:41,179 --> 00:21:45,430
<font color="#E5E5E5">IDs primarily because of its language</font>

477
00:21:43,559 --> 00:21:47,889
you see a lot of<font color="#CCCCCC"> snort roll</font>

478
00:21:45,430 --> 00:21:51,430
published a lot of our folks know how to

479
00:21:47,890 --> 00:21:53,410
do it I would be interested to find out

480
00:21:51,430 --> 00:21:56,050
I honestly<font color="#CCCCCC"> do not know looks I'm not try</font>

481
00:21:53,410 --> 00:21:58,660
bro of the scar ok

482
00:21:56,050 --> 00:22:00,040
<font color="#CCCCCC">you know that's me but just I think</font>

483
00:21:58,660 --> 00:22:04,410
you're on the right track to try it I

484
00:22:00,040 --> 00:22:04,409
would see what happens<font color="#CCCCCC"> okay thanks</font>

485
00:22:05,430 --> 00:22:13,080
I<font color="#CCCCCC"> rob cees priem how much these cards</font>

486
00:22:10,080 --> 00:22:14,939
cost this card was donated to me I

487
00:22:13,080 --> 00:22:17,550
actually do<font color="#E5E5E5"> not know the precise cost of</font>

488
00:22:14,940 --> 00:22:19,230
this car there is<font color="#E5E5E5"> probably in the</font>

489
00:22:17,550 --> 00:22:24,350
audience somewhere a gentleman who would

490
00:22:19,230 --> 00:22:24,350
know and I get<font color="#E5E5E5"> one donated to me too I</font>

491
00:22:24,650 --> 00:22:30,830
will again defer that to the affirm that

492
00:22:27,300 --> 00:22:30,830
donates the car to shade

493
00:22:30,890 --> 00:22:37,520
I'll<font color="#E5E5E5"> throw in a question here does your</font>

494
00:22:33,440 --> 00:22:39,770
ideas system<font color="#CCCCCC"> crazy</font><font color="#E5E5E5"> how much does your</font>

495
00:22:37,520 --> 00:22:42,290
idea system actually<font color="#E5E5E5"> catch in terms of</font>

496
00:22:39,770 --> 00:22:44,389
real intrusion detection and how do<font color="#E5E5E5"> you</font>

497
00:22:42,290 --> 00:22:47,080
deal with<font color="#E5E5E5"> them in</font><font color="#CCCCCC"> terms of what success</font>

498
00:22:44,390 --> 00:22:50,330
do i get from all these piles of packets

499
00:22:47,080 --> 00:22:51,490
my personal<font color="#E5E5E5"> opinion and focus in my</font>

500
00:22:50,330 --> 00:22:55,300
department we might be

501
00:22:51,490 --> 00:22:57,670
disagree<font color="#CCCCCC"> with me is that IDs has saved a</font>

502
00:22:55,300 --> 00:23:00,040
large number of our systems from

503
00:22:57,670 --> 00:23:03,640
<font color="#CCCCCC">compromised in particular it's been very</font>

504
00:23:00,040 --> 00:23:05,230
useful lately with finding botnets we've

505
00:23:03,640 --> 00:23:08,670
put in a set of rules that primarily

506
00:23:05,230 --> 00:23:12,490
<font color="#E5E5E5">looked for interesting patterns in IRC</font>

507
00:23:08,670 --> 00:23:15,640
outbound sessions and we have a<font color="#E5E5E5"> pretty</font>

508
00:23:12,490 --> 00:23:18,580
good percentage of hits on it from those

509
00:23:15,640 --> 00:23:22,720
one or two alerts the trigger vermont n

510
00:23:18,580 --> 00:23:26,199
stuff we've done middle to not as good

511
00:23:22,720 --> 00:23:28,950
hang out a lot of very specific attacks

512
00:23:26,200 --> 00:23:31,330
that not automated where people do very

513
00:23:28,950 --> 00:23:32,020
undocumented things there's no snorkel

514
00:23:31,330 --> 00:23:34,000
for

515
00:23:32,020 --> 00:23:35,560
you do however have a set of custom

516
00:23:34,000 --> 00:23:39,640
rules that focus more on what the

517
00:23:35,560 --> 00:23:41,429
<font color="#E5E5E5">servers say back to the attacker and</font>

518
00:23:39,640 --> 00:23:45,850
actually one of<font color="#E5E5E5"> our most popular</font>

519
00:23:41,430 --> 00:23:48,070
historical rules is a uid 0 match that's

520
00:23:45,850 --> 00:23:52,389
been around forever because everyone

521
00:23:48,070 --> 00:23:55,360
seems to type ID investigators so I'd

522
00:23:52,390 --> 00:23:56,650
say overall<font color="#E5E5E5"> it's if we don't catch it</font>

523
00:23:55,360 --> 00:23:58,659
<font color="#CCCCCC">right away</font><font color="#E5E5E5"> with</font><font color="#CCCCCC"> the IDS</font><font color="#E5E5E5"> the</font>

524
00:23:56,650 --> 00:24:02,080
post-processing but it's<font color="#E5E5E5"> effectively do</font>

525
00:23:58,660 --> 00:24:04,140
<font color="#E5E5E5">realize at least what they did so pretty</font>

526
00:24:02,080 --> 00:24:04,139
good

527
00:24:04,440 --> 00:24:11,870
thank you<font color="#CCCCCC"> okay may have our next</font>

528
00:24:08,280 --> 00:24:11,870
speakers<font color="#CCCCCC"> and panel up here please</font>

