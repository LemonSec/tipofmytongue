1
00:00:00,000 --> 00:00:07,659
[Music]

2
00:00:09,769 --> 00:00:15,170
hello today our next speaker is dr. e

3
00:00:13,099 --> 00:00:17,930
from oracle the title of his

4
00:00:15,170 --> 00:00:21,259
presentation is excessive be GPA spat

5
00:00:17,930 --> 00:00:25,570
prepending is a self inflicted learner

6
00:00:21,259 --> 00:00:28,699
ability deck please go ahead everybody

7
00:00:25,570 --> 00:00:32,750
David where he is oh he said and so talk

8
00:00:28,699 --> 00:00:34,160
about prepending and how it can be a

9
00:00:32,750 --> 00:00:38,180
vulnerability or a self-inflicted

10
00:00:34,160 --> 00:00:39,169
routing vulnerability so many people in

11
00:00:38,180 --> 00:00:41,629
the audience are probably very familiar

12
00:00:39,170 --> 00:00:43,159
with b2b prepending but just to be sure

13
00:00:41,629 --> 00:00:45,199
in case there's someone out there that

14
00:00:43,159 --> 00:00:46,729
doesn't know it that well here's what

15
00:00:45,199 --> 00:00:48,769
we're referring to so a s path

16
00:00:46,729 --> 00:00:51,500
prepending is a traffic engineering

17
00:00:48,769 --> 00:00:53,809
technique used to deprioritize route by

18
00:00:51,500 --> 00:00:57,409
part officially increasing s path length

19
00:00:53,809 --> 00:01:01,519
so the prepending refers to manifest

20
00:00:57,409 --> 00:01:04,879
itself as this repeated AAS ASN in an

21
00:01:01,519 --> 00:01:08,750
ass path typically announced to a subset

22
00:01:04,879 --> 00:01:12,290
not usually all adjacent guesses and in

23
00:01:08,750 --> 00:01:17,840
this example we have a slash 24 here in

24
00:01:12,290 --> 00:01:21,289
the AAS path on the left is the s or 192

25
00:01:17,840 --> 00:01:23,479
occurs two times assuming for 192 was

26
00:01:21,289 --> 00:01:26,749
going to occur naturally in this path

27
00:01:23,479 --> 00:01:29,240
anyway the second appearance successive

28
00:01:26,749 --> 00:01:33,408
appearance there is the prepended ones

29
00:01:29,240 --> 00:01:35,899
this was pretended one time and assuming

30
00:01:33,409 --> 00:01:37,789
all of their criteria are equal BGP

31
00:01:35,899 --> 00:01:41,979
route selection prefers the shortest

32
00:01:37,789 --> 00:01:45,350
path length ie the non prepended route

33
00:01:41,979 --> 00:01:47,060
that's what prepended prepending is I

34
00:01:45,350 --> 00:01:48,770
hope no one comes out of this talk

35
00:01:47,060 --> 00:01:51,319
thinking I'm anti prepending there's

36
00:01:48,770 --> 00:01:53,689
always a place for it but we're talking

37
00:01:51,319 --> 00:01:58,039
about some times it goes wrong

38
00:01:53,689 --> 00:02:00,380
so typically prepending is not not the

39
00:01:58,039 --> 00:02:04,189
main source of a prop of the problem of

40
00:02:00,380 --> 00:02:08,179
routing issues one notable exception

41
00:02:04,189 --> 00:02:10,818
occurred in February 2009 many years ago

42
00:02:08,179 --> 00:02:14,300
where there was a lot of outages caused

43
00:02:10,818 --> 00:02:16,549
by a single routing announcement and

44
00:02:14,300 --> 00:02:18,260
this had to do with an extremely long

45
00:02:16,550 --> 00:02:21,680
ass path that some routers couldn't

46
00:02:18,260 --> 00:02:23,510
handle in this case what had happened

47
00:02:21,680 --> 00:02:27,439
was there was a subtle

48
00:02:23,510 --> 00:02:30,519
a command line configuration difference

49
00:02:27,439 --> 00:02:33,799
between the configuration interface of

50
00:02:30,519 --> 00:02:39,560
mikrotik routers versus cisco routers

51
00:02:33,799 --> 00:02:43,220
and so honest cisco router by a recall

52
00:02:39,560 --> 00:02:44,599
correctly when you enter the a s if you

53
00:02:43,220 --> 00:02:47,420
want that lisa prepending you would

54
00:02:44,599 --> 00:02:50,089
enter what ass you wanted to appear to

55
00:02:47,420 --> 00:02:53,089
the left of your is in the command line

56
00:02:50,090 --> 00:02:56,209
configuration so you're entering an a s

57
00:02:53,090 --> 00:02:59,659
and at the command line on the mikrotik

58
00:02:56,209 --> 00:03:02,000
version of the identical command instead

59
00:02:59,659 --> 00:03:05,269
of entering the a s you were entering

60
00:03:02,000 --> 00:03:08,900
account and how many times did you want

61
00:03:05,269 --> 00:03:11,930
to see your IDs appear and so poor forty

62
00:03:08,900 --> 00:03:14,510
seven thousand eight sixty eight when

63
00:03:11,930 --> 00:03:16,370
they entered their own a s in this field

64
00:03:14,510 --> 00:03:18,440
that was actually account prepending

65
00:03:16,370 --> 00:03:22,819
then we're essentially telling the

66
00:03:18,440 --> 00:03:24,349
router to generate a a s path with forty

67
00:03:22,819 --> 00:03:28,488
seven thousand eight hundred sixty eight

68
00:03:24,349 --> 00:03:33,679
prepends now thankfully this value was

69
00:03:28,489 --> 00:03:35,900
stored in an 8-bit field so it flipped

70
00:03:33,680 --> 00:03:40,310
over many many times as it was trying to

71
00:03:35,900 --> 00:03:43,040
store this value resulting in a value of

72
00:03:40,310 --> 00:03:47,030
five hundred fifty two and so the router

73
00:03:43,040 --> 00:03:49,790
added 552 prepends and sent the

74
00:03:47,030 --> 00:03:51,889
announcement on its way so far nothing's

75
00:03:49,790 --> 00:03:54,470
broken it's not great but it's not

76
00:03:51,889 --> 00:03:56,840
broken but what ended up happening was

77
00:03:54,470 --> 00:03:59,720
there were there was a certain type of

78
00:03:56,840 --> 00:04:02,389
cisco router at the time it was a

79
00:03:59,720 --> 00:04:03,949
unknown bug at the time that if it

80
00:04:02,389 --> 00:04:05,660
received an announcement b2b

81
00:04:03,949 --> 00:04:11,060
announcement with an AF path length but

82
00:04:05,660 --> 00:04:14,720
exceeded twenty-five asses then it would

83
00:04:11,060 --> 00:04:21,500
crash and so as that 252 pre pens moved

84
00:04:14,720 --> 00:04:26,080
to another is 253 284 55 tipped on and

85
00:04:21,500 --> 00:04:29,479
then finally hit enough routers to cause

86
00:04:26,080 --> 00:04:31,010
outages all over the place there was a

87
00:04:29,479 --> 00:04:34,310
number of blog we wrote a couple of

88
00:04:31,010 --> 00:04:36,630
these back in the renesis days and those

89
00:04:34,310 --> 00:04:39,690
links are below this was a graft

90
00:04:36,630 --> 00:04:44,270
one of those so prepending is rarely the

91
00:04:39,690 --> 00:04:46,860
source of the problem but it often is

92
00:04:44,270 --> 00:04:50,219
but a good healthy footnote if not a

93
00:04:46,860 --> 00:04:51,990
subplot to a lot of routing leaks so one

94
00:04:50,220 --> 00:04:53,700
thing I put stomped on in the past year

95
00:04:51,990 --> 00:04:56,100
was revisiting this China Telecom thing

96
00:04:53,700 --> 00:04:58,409
from 10 years ago that seems to extremes

97
00:04:56,100 --> 00:05:01,410
into kind of never go away I see it

98
00:04:58,410 --> 00:05:05,430
still get repeated on our circles we

99
00:05:01,410 --> 00:05:08,610
know the routes tone equal traffic of

100
00:05:05,430 --> 00:05:12,030
the sleep didn't really swallow 15% of

101
00:05:08,610 --> 00:05:13,950
the internet when I looked at this back

102
00:05:12,030 --> 00:05:17,760
in April 2010 in this particular

103
00:05:13,950 --> 00:05:19,469
incident I did my I do a lot of analysis

104
00:05:17,760 --> 00:05:22,080
of these kind of routing incidents and

105
00:05:19,470 --> 00:05:25,740
this graphic on the bottom left is

106
00:05:22,080 --> 00:05:29,310
looking at as a way to depict visualize

107
00:05:25,740 --> 00:05:32,460
how the propagation of the various

108
00:05:29,310 --> 00:05:33,990
routes in a in a particular routing

109
00:05:32,460 --> 00:05:36,900
league so we've got home one axis in the

110
00:05:33,990 --> 00:05:38,970
bottom right time counting up as it

111
00:05:36,900 --> 00:05:42,539
moves away from the viewer the other

112
00:05:38,970 --> 00:05:46,050
axis on the on the bottom is the 50,000

113
00:05:42,540 --> 00:05:49,260
or so prefixes that were in this

114
00:05:46,050 --> 00:05:51,570
involved in this link and then the axis

115
00:05:49,260 --> 00:05:54,300
going up and down is our measure of

116
00:05:51,570 --> 00:05:56,550
propagation we call that pure percentage

117
00:05:54,300 --> 00:05:58,740
so how much of our BGP sources accepted

118
00:05:56,550 --> 00:06:00,480
the leaked version of the route so most

119
00:05:58,740 --> 00:06:04,980
leaks look at something like this we've

120
00:06:00,480 --> 00:06:07,440
got a few a small portion of the leak is

121
00:06:04,980 --> 00:06:10,530
routed to a large part of the internet

122
00:06:07,440 --> 00:06:12,990
that shows up in red a dark red and then

123
00:06:10,530 --> 00:06:14,280
there's a quick decay along a long tail

124
00:06:12,990 --> 00:06:18,660
of things that really didn't go very far

125
00:06:14,280 --> 00:06:21,929
and so when I was digging into this you

126
00:06:18,660 --> 00:06:23,130
know 10 years ago you know again when I

127
00:06:21,930 --> 00:06:25,140
look at these I want to know what are

128
00:06:23,130 --> 00:06:27,030
the prefixes that were most impacted

129
00:06:25,140 --> 00:06:28,530
here in this case it was mostly Chinese

130
00:06:27,030 --> 00:06:32,010
routes so it was a China on China

131
00:06:28,530 --> 00:06:34,469
incident however in there were the top

132
00:06:32,010 --> 00:06:37,170
five and as well as in the top 10 they

133
00:06:34,470 --> 00:06:40,530
were US routes did I you know stumble

134
00:06:37,170 --> 00:06:42,630
upon some sort of conspiracy here this

135
00:06:40,530 --> 00:06:44,580
is targeting these guys and when I dug

136
00:06:42,630 --> 00:06:48,060
into it turned out this was a small ice

137
00:06:44,580 --> 00:06:50,130
beat in Charlottesville Virginia that as

138
00:06:48,060 --> 00:06:50,530
a matter of course of every day on the

139
00:06:50,130 --> 00:06:52,900
Internet

140
00:06:50,530 --> 00:06:56,229
they would announce they would prepend

141
00:06:52,900 --> 00:06:58,960
five times all of their routes to a

142
00:06:56,230 --> 00:07:00,850
single upstream in this case it's these

143
00:06:58,960 --> 00:07:03,760
two is less 21/22

144
00:07:00,850 --> 00:07:05,380
the one to 163 was there a yes they

145
00:07:03,760 --> 00:07:08,800
announced they prepended at five times

146
00:07:05,380 --> 00:07:12,150
for total of six instances an S path to

147
00:07:08,800 --> 00:07:15,850
a single upstream and what this did was

148
00:07:12,150 --> 00:07:19,570
incentivize all other asses the Internet

149
00:07:15,850 --> 00:07:21,400
to find some other origin if something

150
00:07:19,570 --> 00:07:23,490
were to show up and that in a nutshell

151
00:07:21,400 --> 00:07:26,080
is the vulnerability so we we were

152
00:07:23,490 --> 00:07:28,300
brainstorming what they call this and I

153
00:07:26,080 --> 00:07:30,250
think we settled on prepended - all

154
00:07:28,300 --> 00:07:31,780
because excessive can be excessive in

155
00:07:30,250 --> 00:07:36,070
multiple dimensions there's excessive

156
00:07:31,780 --> 00:07:37,900
and you know how many how long in a s

157
00:07:36,070 --> 00:07:39,669
path length is and I'm not really too

158
00:07:37,900 --> 00:07:42,280
concerned with that the part that I'm

159
00:07:39,669 --> 00:07:44,380
concerned about is when you prepend to

160
00:07:42,280 --> 00:07:46,659
the entire Internet thus negating any

161
00:07:44,380 --> 00:07:49,210
value of traffic engineering value and

162
00:07:46,660 --> 00:07:50,860
this occurs we've been writing a you

163
00:07:49,210 --> 00:07:53,979
know mentioning this for many years this

164
00:07:50,860 --> 00:07:57,040
is a write up of the teller I mean in an

165
00:07:53,980 --> 00:07:59,410
IND of sadly 2014 if you were to go back

166
00:07:57,040 --> 00:08:01,720
and look at our write-up of that in it

167
00:07:59,410 --> 00:08:06,150
we were calling out prefixes that were

168
00:08:01,720 --> 00:08:08,890
impacted in this leak and again noting

169
00:08:06,150 --> 00:08:10,960
some that were prepended again to a

170
00:08:08,890 --> 00:08:13,260
single little upstream so therefore

171
00:08:10,960 --> 00:08:16,450
everybody at the time would have this

172
00:08:13,260 --> 00:08:17,800
artificially long ass path length as the

173
00:08:16,450 --> 00:08:20,110
illegitimate route when the leak came

174
00:08:17,800 --> 00:08:22,510
along a lot of a large portion the

175
00:08:20,110 --> 00:08:25,360
internet would go for the the leaked

176
00:08:22,510 --> 00:08:27,219
version same thing occurred in telecom

177
00:08:25,360 --> 00:08:32,229
the TM net leaked the following year

178
00:08:27,220 --> 00:08:34,180
again we called this out years ago in

179
00:08:32,229 --> 00:08:36,520
this in this write-up saying we've

180
00:08:34,179 --> 00:08:39,069
another case of a prefix that's

181
00:08:36,520 --> 00:08:39,640
prepended to everything and again it

182
00:08:39,070 --> 00:08:42,880
gets whacked

183
00:08:39,640 --> 00:08:46,810
when this leak comes along so prepending

184
00:08:42,880 --> 00:08:49,920
to everybody prepend to all is it will

185
00:08:46,810 --> 00:08:53,739
be pointing this phenomenon as and

186
00:08:49,920 --> 00:08:56,380
essentially it's I would submit the it

187
00:08:53,740 --> 00:08:58,450
no longer is shaping route propagation

188
00:08:56,380 --> 00:09:01,480
at that point and the only thing is

189
00:08:58,450 --> 00:09:03,329
doing is incentivizing a sentence other

190
00:09:01,480 --> 00:09:06,059
asses to choose another

191
00:09:03,329 --> 00:09:09,149
were to appear either by mistake or

192
00:09:06,059 --> 00:09:11,368
otherwise so we've known about this for

193
00:09:09,149 --> 00:09:14,339
at least a decade to do so bust us out

194
00:09:11,369 --> 00:09:17,879
there I just had no idea how much there

195
00:09:14,339 --> 00:09:19,230
was and it turns out there is a lot and

196
00:09:17,879 --> 00:09:22,860
we'll go into these graphs here so we

197
00:09:19,230 --> 00:09:24,959
dug we ran across analysis across both

198
00:09:22,860 --> 00:09:27,420
the v4 global routing table the v6

199
00:09:24,959 --> 00:09:30,809
routing table we'll go through each of

200
00:09:27,420 --> 00:09:35,069
these briefly so on this graphic on the

201
00:09:30,809 --> 00:09:37,079
right the x-axis is the total all the

202
00:09:35,069 --> 00:09:39,389
prefixes in the v4 global routing table

203
00:09:37,079 --> 00:09:42,089
this was run last summer so it's about

204
00:09:39,389 --> 00:09:44,129
at about 750 thousand routes it's a

205
00:09:42,089 --> 00:09:48,299
little bigger today but the shape looks

206
00:09:44,129 --> 00:09:51,209
identical the y-axis is how many as a

207
00:09:48,299 --> 00:09:54,559
percentage of how many of our BGP

208
00:09:51,209 --> 00:09:57,719
sources to be about three or 400 BGP

209
00:09:54,559 --> 00:10:00,439
sources that have full tables used for

210
00:09:57,720 --> 00:10:04,459
our analysis since the renesis dataset

211
00:10:00,439 --> 00:10:07,139
and how much of those how many of those

212
00:10:04,459 --> 00:10:08,540
would have reached a how many of those

213
00:10:07,139 --> 00:10:11,790
assets would it reach that prefix

214
00:10:08,540 --> 00:10:14,189
through a pre pendant path and if it

215
00:10:11,790 --> 00:10:16,498
turns out of the you know this is

216
00:10:14,189 --> 00:10:18,779
obviously a curve slopes down if we pick

217
00:10:16,499 --> 00:10:21,389
a point like 95 percent of it if it's

218
00:10:18,779 --> 00:10:26,069
prevented to 95 percent or more of our

219
00:10:21,389 --> 00:10:28,169
sources that there are 60 over 60,000

220
00:10:26,069 --> 00:10:30,540
prefixes that would fall into that

221
00:10:28,169 --> 00:10:32,339
category that amounts to 8 percent of

222
00:10:30,540 --> 00:10:34,019
the global routing table 1 and 12 routes

223
00:10:32,339 --> 00:10:36,779
is essentially prepended to the entire

224
00:10:34,019 --> 00:10:38,220
internet if you slip through the

225
00:10:36,779 --> 00:10:40,110
prefixes that are involved in this list

226
00:10:38,220 --> 00:10:41,579
it's entities of every stripe we got

227
00:10:40,110 --> 00:10:44,549
governments banks Internet

228
00:10:41,579 --> 00:10:47,099
infrastructure maybe networks from your

229
00:10:44,549 --> 00:10:48,480
prefixes from your network may be a

230
00:10:47,100 --> 00:10:50,730
similar mine

231
00:10:48,480 --> 00:10:52,470
it's about everybody's in there if we

232
00:10:50,730 --> 00:10:55,470
were to lower it down to 50% and then it

233
00:10:52,470 --> 00:10:57,419
goes up to 50% of our sources seeing

234
00:10:55,470 --> 00:11:01,049
prepending then it's you know over 100

235
00:10:57,419 --> 00:11:03,299
that produces that look like that it's

236
00:11:01,049 --> 00:11:06,269
quickly we were to break down where are

237
00:11:03,299 --> 00:11:08,639
the big sources just recently TPG seven

238
00:11:06,269 --> 00:11:10,129
five four five but in Australia seems to

239
00:11:08,639 --> 00:11:13,559
have a lot of

240
00:11:10,129 --> 00:11:17,649
prepending to all with average prepend

241
00:11:13,559 --> 00:11:19,719
length of you know sender for

242
00:11:17,649 --> 00:11:21,449
total rebounds is if you were to

243
00:11:19,720 --> 00:11:24,310
multiply the previous Cal versus the

244
00:11:21,449 --> 00:11:26,399
times the prepend average pre Bank

245
00:11:24,310 --> 00:11:28,660
length is how many of the how many

246
00:11:26,399 --> 00:11:30,040
guesses are getting added to the global

247
00:11:28,660 --> 00:11:32,740
routing table as a result of their

248
00:11:30,040 --> 00:11:37,599
prepending but there's companies in here

249
00:11:32,740 --> 00:11:41,130
you got Akamai Verizon there's there's

250
00:11:37,600 --> 00:11:41,130
quite a lot of this stuff out there with

251
00:11:41,190 --> 00:11:47,410
recognizable companies they're going to

252
00:11:43,540 --> 00:11:49,510
be six this this phenomenon exists there

253
00:11:47,410 --> 00:11:51,550
as well to a smaller extent the

254
00:11:49,510 --> 00:11:53,529
percentages are smaller and I would

255
00:11:51,550 --> 00:11:54,839
suggest that that's probably due to the

256
00:11:53,529 --> 00:11:57,250
fact that I think there's less

257
00:11:54,839 --> 00:11:59,399
historical traffic engineering that has

258
00:11:57,250 --> 00:12:03,850
been gone on going on in the b6 rule

259
00:11:59,399 --> 00:12:06,760
then to be sick three four but it uh it

260
00:12:03,850 --> 00:12:09,670
still it's still one it's still there

261
00:12:06,760 --> 00:12:11,319
and it's growing so again some of these

262
00:12:09,670 --> 00:12:14,410
gases that contribute to this are the

263
00:12:11,320 --> 00:12:16,870
same ones in the previous list for

264
00:12:14,410 --> 00:12:19,480
whatever reason there's just a some

265
00:12:16,870 --> 00:12:23,050
people a lot of prepending to everything

266
00:12:19,480 --> 00:12:25,480
the whole internet yeah so I think the

267
00:12:23,050 --> 00:12:28,439
first takeaway is to my point I'd like

268
00:12:25,480 --> 00:12:31,540
to get across here is prepending as

269
00:12:28,440 --> 00:12:32,860
frequently employed and an excessive

270
00:12:31,540 --> 00:12:35,709
manner especially that renders routes

271
00:12:32,860 --> 00:12:38,860
vulnerable to disruption or misdirection

272
00:12:35,709 --> 00:12:41,050
accidental or otherwise so thus far

273
00:12:38,860 --> 00:12:43,510
we've been talking about accidents

274
00:12:41,050 --> 00:12:47,170
routing leaks that were unintentional

275
00:12:43,510 --> 00:12:50,620
but if I was interment adversary and

276
00:12:47,170 --> 00:12:52,599
there are a number of issues of security

277
00:12:50,620 --> 00:12:56,230
with the weaknesses of BGP I think we we

278
00:12:52,600 --> 00:12:59,050
know that but here's another one so on a

279
00:12:56,230 --> 00:13:00,850
recent day we have this slash 20 it was

280
00:12:59,050 --> 00:13:02,709
prepended to all basically the whole

281
00:13:00,850 --> 00:13:04,329
internet if you had this route in your

282
00:13:02,709 --> 00:13:05,979
table have this route your table it

283
00:13:04,329 --> 00:13:08,739
looks something like this where you've

284
00:13:05,980 --> 00:13:12,069
got 30 plus prepends that's everybody

285
00:13:08,740 --> 00:13:14,199
everybody's got this if I wanted to

286
00:13:12,069 --> 00:13:15,639
insert myself if I was a bad guy I want

287
00:13:14,199 --> 00:13:17,410
to shoot myself on the traffic destiny

288
00:13:15,639 --> 00:13:20,709
for this last 20 I might announce the

289
00:13:17,410 --> 00:13:22,449
same prefix and I might announce it from

290
00:13:20,709 --> 00:13:24,579
some bulletproof photo stinks or some is

291
00:13:22,449 --> 00:13:26,349
that what Carol look the other way and I

292
00:13:24,579 --> 00:13:28,390
would fabricate the a s path then we've

293
00:13:26,350 --> 00:13:29,690
documented lots of cases in the past

294
00:13:28,390 --> 00:13:32,930
with its big canal

295
00:13:29,690 --> 00:13:37,790
connecter sketchy Russian Russian

296
00:13:32,930 --> 00:13:39,290
routing or a Ukraine this is is this

297
00:13:37,790 --> 00:13:40,640
happens with some regularity of

298
00:13:39,290 --> 00:13:43,730
fabricating a spaz

299
00:13:40,640 --> 00:13:45,260
I would fabricated so the origin and a

300
00:13:43,730 --> 00:13:48,740
few of the upstreams are all identical

301
00:13:45,260 --> 00:13:50,689
so it would it would be hard to hard to

302
00:13:48,740 --> 00:13:52,220
pick out that this was taking place and

303
00:13:50,690 --> 00:13:54,950
you'd be able to siphon off any man in

304
00:13:52,220 --> 00:13:56,930
the middle something and why is this

305
00:13:54,950 --> 00:14:00,320
possible because these guys are

306
00:13:56,930 --> 00:14:02,420
prepending so much so like I said the

307
00:14:00,320 --> 00:14:05,600
the length of this prepending is the

308
00:14:02,420 --> 00:14:07,760
attacker room to craft a s path that

309
00:14:05,600 --> 00:14:09,890
would appear plausible comply with

310
00:14:07,760 --> 00:14:11,450
orders and validation and not be

311
00:14:09,890 --> 00:14:12,920
detected buying much of the

312
00:14:11,450 --> 00:14:15,500
off-the-shelf route monitoring that is

313
00:14:12,920 --> 00:14:16,120
checking for unauthorized origins or

314
00:14:15,500 --> 00:14:19,010
upstreams

315
00:14:16,120 --> 00:14:21,230
you know we can put those in there and

316
00:14:19,010 --> 00:14:23,500
still have a route that's gonna get

317
00:14:21,230 --> 00:14:26,420
selected or get circulated quite a bit

318
00:14:23,500 --> 00:14:28,130
so that's a that's a theoretical risk I

319
00:14:26,420 --> 00:14:30,050
try to look for some cases that see like

320
00:14:28,130 --> 00:14:31,670
I find something but it's it's hard to I

321
00:14:30,050 --> 00:14:35,209
haven't found something in the wild that

322
00:14:31,670 --> 00:14:38,569
actually did this you know next thing we

323
00:14:35,210 --> 00:14:40,610
did was to look at is this as a trend

324
00:14:38,570 --> 00:14:44,360
what's the trend here is just growing

325
00:14:40,610 --> 00:14:47,000
over time or is a it turns out it is and

326
00:14:44,360 --> 00:14:48,680
if we go back now two years going just

327
00:14:47,000 --> 00:14:50,030
picking a day out of a month just to run

328
00:14:48,680 --> 00:14:51,770
these numbers it's a bit of a moving

329
00:14:50,030 --> 00:14:54,380
target so it fluctuates us people change

330
00:14:51,770 --> 00:14:56,210
their routing right now in the v4 table

331
00:14:54,380 --> 00:14:58,490
there was a bit of an uptick I think

332
00:14:56,210 --> 00:15:02,390
that's subsided but the overall trend of

333
00:14:58,490 --> 00:15:04,880
the increasing continues same for v6

334
00:15:02,390 --> 00:15:07,160
it's increasing you know maybe it's a

335
00:15:04,880 --> 00:15:08,510
little more big the increase here the

336
00:15:07,160 --> 00:15:12,350
distribution is a little more scattered

337
00:15:08,510 --> 00:15:15,100
but it looks like as the global router

338
00:15:12,350 --> 00:15:17,690
table is increasing the percentage of

339
00:15:15,100 --> 00:15:20,210
the amount prefixes that are appended to

340
00:15:17,690 --> 00:15:24,680
everything is also growing at a faster

341
00:15:20,210 --> 00:15:27,080
rate than the routing table so you know

342
00:15:24,680 --> 00:15:28,910
I think we've made the case in you know

343
00:15:27,080 --> 00:15:30,680
an inadvertent route leak could disrupt

344
00:15:28,910 --> 00:15:32,959
traffic you know maybe I determined

345
00:15:30,680 --> 00:15:35,599
adversary good that was probably true

346
00:15:32,960 --> 00:15:38,090
with or without the pretending accidents

347
00:15:35,600 --> 00:15:39,110
happened so why deliberately put your

348
00:15:38,090 --> 00:15:41,870
routes at risk

349
00:15:39,110 --> 00:15:44,589
why do this is a question

350
00:15:41,870 --> 00:15:47,240
I started asking some people so myself

351
00:15:44,589 --> 00:15:49,520
for some of these I'm teamed up with Joe

352
00:15:47,240 --> 00:15:51,740
of Snyder's see if we could find someone

353
00:15:49,520 --> 00:15:53,839
who would tell us what was the rationale

354
00:15:51,740 --> 00:15:55,790
was this intentional and what purpose

355
00:15:53,839 --> 00:15:58,010
did I think it serves by doing this and

356
00:15:55,790 --> 00:16:02,089
so one of the first stops I went to was

357
00:15:58,010 --> 00:16:04,600
a s3o three to one which you may not

358
00:16:02,089 --> 00:16:08,570
know but she should because this is the

359
00:16:04,600 --> 00:16:10,370
the Burning Man festival just kind of a

360
00:16:08,570 --> 00:16:12,470
counterculture what festival takes place

361
00:16:10,370 --> 00:16:14,990
once a year out the desert western part

362
00:16:12,470 --> 00:16:17,300
of the United States they happen to have

363
00:16:14,990 --> 00:16:18,440
a net ops team and a s and they route

364
00:16:17,300 --> 00:16:22,069
their own traffic think about their own

365
00:16:18,440 --> 00:16:24,800
prefixes they were doing some prepending

366
00:16:22,070 --> 00:16:26,600
depending to all and it just so happened

367
00:16:24,800 --> 00:16:28,160
to one of my colleagues happen to know

368
00:16:26,600 --> 00:16:29,990
one of the guys in there that ops team

369
00:16:28,160 --> 00:16:32,029
reached out and said you know hey

370
00:16:29,990 --> 00:16:33,230
whatever you guys doing this and they

371
00:16:32,029 --> 00:16:35,510
went looked at it it's like oh that's

372
00:16:33,230 --> 00:16:37,490
wrong and so they just removed it you

373
00:16:35,510 --> 00:16:42,050
can get an explanation for that on that

374
00:16:37,490 --> 00:16:45,380
one but you know they did acknowledge -

375
00:16:42,050 --> 00:16:47,060
probably wasn't wasn't very helpful

376
00:16:45,380 --> 00:16:50,570
since it's all going through a single

377
00:16:47,060 --> 00:16:52,579
upstream you know we took a bunch of

378
00:16:50,570 --> 00:16:53,870
examples you see their credit CloudFlare

379
00:16:52,580 --> 00:16:55,310
Google we brought some examples they

380
00:16:53,870 --> 00:16:56,720
looked at us yeah these are probably

381
00:16:55,310 --> 00:17:00,020
wrong which you can remove and they did

382
00:16:56,720 --> 00:17:04,900
so you know we we put them up there with

383
00:17:00,020 --> 00:17:09,170
the Burning Man festival level of

384
00:17:04,900 --> 00:17:10,670
responsiveness and but you know that was

385
00:17:09,170 --> 00:17:12,319
the minority the majority people either

386
00:17:10,670 --> 00:17:13,550
didn't respond or just claimed you know

387
00:17:12,319 --> 00:17:15,980
it was some sort of operational issue

388
00:17:13,550 --> 00:17:17,770
and so from our conversations with some

389
00:17:15,980 --> 00:17:20,540
of these folks and other people who are

390
00:17:17,770 --> 00:17:22,910
kind of trying to do us for this

391
00:17:20,540 --> 00:17:25,550
prepending for traffic engineering here

392
00:17:22,910 --> 00:17:28,610
are the theories as to why why is this

393
00:17:25,550 --> 00:17:30,020
so pervasive theory number one which

394
00:17:28,610 --> 00:17:34,639
probably accounts for the vast majority

395
00:17:30,020 --> 00:17:37,460
is just simply poor housekeeping there

396
00:17:34,640 --> 00:17:39,260
probably was a time in the past where

397
00:17:37,460 --> 00:17:40,880
the committee made sense they had two up

398
00:17:39,260 --> 00:17:42,500
streams they wanted to deep prioritize

399
00:17:40,880 --> 00:17:44,870
one of them they prepend it to the one

400
00:17:42,500 --> 00:17:47,030
and everything's good then the

401
00:17:44,870 --> 00:17:49,489
unprepared upstream goes away anything

402
00:17:47,030 --> 00:17:51,020
now they don't have one upstream and

403
00:17:49,490 --> 00:17:53,300
they're still prepending to it and maybe

404
00:17:51,020 --> 00:17:54,860
the then we're gonna near moved on to

405
00:17:53,300 --> 00:17:55,580
another job and no one ever goes back to

406
00:17:54,860 --> 00:17:56,870
look at it

407
00:17:55,580 --> 00:18:00,860
and that's how these things kind of

408
00:17:56,870 --> 00:18:02,629
persist and accumulate so I think I

409
00:18:00,860 --> 00:18:03,729
would think poor housekeeping is

410
00:18:02,630 --> 00:18:07,970
probably counting for a lot of these

411
00:18:03,730 --> 00:18:09,380
another thing that is a topic that we've

412
00:18:07,970 --> 00:18:12,920
encountered a lot is return-path

413
00:18:09,380 --> 00:18:15,170
influence so if you recall in the

414
00:18:12,920 --> 00:18:16,850
grounding League of November 2017

415
00:18:15,170 --> 00:18:19,880
involving level 3

416
00:18:16,850 --> 00:18:21,290
there was as a running week where tens

417
00:18:19,880 --> 00:18:24,520
of thousands of more specifics were

418
00:18:21,290 --> 00:18:28,250
announced the global routing table as

419
00:18:24,520 --> 00:18:29,240
many of observers do and we see

420
00:18:28,250 --> 00:18:30,740
something like that I would think Oh is

421
00:18:29,240 --> 00:18:32,750
there a route optimizer involved in this

422
00:18:30,740 --> 00:18:35,150
case it wasn't it was a case where there

423
00:18:32,750 --> 00:18:37,730
was a couple of large access level layer

424
00:18:35,150 --> 00:18:41,810
networks I will networks were announcing

425
00:18:37,730 --> 00:18:44,090
more specifics into the into level 3

426
00:18:41,810 --> 00:18:47,600
over their private peering to and try to

427
00:18:44,090 --> 00:18:49,310
influence how the traffic would return

428
00:18:47,600 --> 00:18:54,439
over a direct path over that peering

429
00:18:49,310 --> 00:18:56,510
link as an attempt to yeah so it didn't

430
00:18:54,440 --> 00:18:59,270
go out some other egress a little three

431
00:18:56,510 --> 00:19:01,270
so you know you could do you could

432
00:18:59,270 --> 00:19:03,200
prepend to the whole internet to try to

433
00:19:01,270 --> 00:19:04,970
essentially poison the whole internet

434
00:19:03,200 --> 00:19:07,370
try to force traffic to come back over a

435
00:19:04,970 --> 00:19:10,730
private sharing link it would be a bit

436
00:19:07,370 --> 00:19:12,260
of overkill and there's probably better

437
00:19:10,730 --> 00:19:15,440
ways to do it but that's that may

438
00:19:12,260 --> 00:19:17,120
account for some of these and then you

439
00:19:15,440 --> 00:19:20,360
know we can never discount when it comes

440
00:19:17,120 --> 00:19:24,530
to BGP the mistakes bound off anybody

441
00:19:20,360 --> 00:19:26,540
you've worked with BGP data to any

442
00:19:24,530 --> 00:19:30,980
extent you've encountered a number of

443
00:19:26,540 --> 00:19:34,070
errors that occur that appear everywhere

444
00:19:30,980 --> 00:19:38,030
in this example of this prepending we've

445
00:19:34,070 --> 00:19:40,639
come across it may be hard to notice a

446
00:19:38,030 --> 00:19:42,290
bit of an eye test here but the the

447
00:19:40,640 --> 00:19:45,590
final two digits of the repeating

448
00:19:42,290 --> 00:19:47,899
whereby a s here is actually oscillating

449
00:19:45,590 --> 00:19:53,240
between two 9:00 to 9:00 9:00 to 9:00 to

450
00:19:47,900 --> 00:19:57,410
2:00 to 9:00 to 9:00 1990 so there may

451
00:19:53,240 --> 00:19:59,480
be some percentage a nonzero amount of

452
00:19:57,410 --> 00:20:02,060
these prepending to fall where that was

453
00:19:59,480 --> 00:20:04,010
not the intention it's just it's simply

454
00:20:02,060 --> 00:20:06,520
a mistake and no one has ever gone back

455
00:20:04,010 --> 00:20:06,520
to fix it

456
00:20:06,770 --> 00:20:14,929
so to wrap up this talk about prepending

457
00:20:10,420 --> 00:20:17,809
here are the so the final points so long

458
00:20:14,929 --> 00:20:20,240
as paths incur risk of disruption and

459
00:20:17,809 --> 00:20:22,280
that's true whether they are due to

460
00:20:20,240 --> 00:20:25,820
prepending or some other reason if you

461
00:20:22,280 --> 00:20:27,678
are a small isp in Tajikistan and you

462
00:20:25,820 --> 00:20:29,389
get your transit through Kazakhstan

463
00:20:27,679 --> 00:20:31,970
you're basically Russia gets it through

464
00:20:29,390 --> 00:20:33,260
Europe you may have long ass paths and

465
00:20:31,970 --> 00:20:36,920
there's just not much you can do about

466
00:20:33,260 --> 00:20:40,040
it if someone else announces your your

467
00:20:36,920 --> 00:20:41,420
routes it's they maybe they made it here

468
00:20:40,040 --> 00:20:44,510
as a shortest path to a lot of the

469
00:20:41,420 --> 00:20:46,700
internet so there's some people have an

470
00:20:44,510 --> 00:20:49,160
unavoidable amount of risk there but

471
00:20:46,700 --> 00:20:53,630
there's no sense in adding to that risk

472
00:20:49,160 --> 00:20:56,150
I would recommend to people in this

473
00:20:53,630 --> 00:20:57,679
audience if you are running BGP you

474
00:20:56,150 --> 00:21:01,610
might want to double-check to see how

475
00:20:57,679 --> 00:21:06,170
your you know if your prepending and how

476
00:21:01,610 --> 00:21:09,860
is that what are you preparing to do is

477
00:21:06,170 --> 00:21:12,830
it to everything if you want to check if

478
00:21:09,860 --> 00:21:14,270
you want to see what if we've got

479
00:21:12,830 --> 00:21:16,428
anything creep in at all based on our

480
00:21:14,270 --> 00:21:19,370
and also so you're free to send me an

481
00:21:16,429 --> 00:21:21,860
AAS I'm happy to tell you you know what

482
00:21:19,370 --> 00:21:24,020
we can see on that because it's a lot of

483
00:21:21,860 --> 00:21:27,800
networks almost everybody has got

484
00:21:24,020 --> 00:21:30,860
something in this list and you know in

485
00:21:27,800 --> 00:21:32,870
the end with 8 percent of the v4 and 5.6

486
00:21:30,860 --> 00:21:34,790
percent of the v6 global routing tables

487
00:21:32,870 --> 00:21:37,010
presently prepended to essentially

488
00:21:34,790 --> 00:21:39,080
everyone I think it's safe to conclude

489
00:21:37,010 --> 00:21:42,200
that this traffic engineering technique

490
00:21:39,080 --> 00:21:47,540
is being overused and amounts to a

491
00:21:42,200 --> 00:21:50,120
self-inflicted governor ability okay

492
00:21:47,540 --> 00:21:54,000
and that's my talk

493
00:21:50,120 --> 00:21:55,739
thank you Doug so we have a few

494
00:21:54,000 --> 00:21:57,540
questions from the audience which I will

495
00:21:55,740 --> 00:22:00,270
read to you and you answer them so the

496
00:21:57,540 --> 00:22:02,220
first question is we have been using ASP

497
00:22:00,270 --> 00:22:04,200
pin to balance ingress traffic from

498
00:22:02,220 --> 00:22:07,500
different ISPs is there another option

499
00:22:04,200 --> 00:22:10,080
to do this without using prepending I

500
00:22:07,500 --> 00:22:11,460
guess if it's available to you sometimes

501
00:22:10,080 --> 00:22:14,850
up streams provide communities

502
00:22:11,460 --> 00:22:18,540
communities is I think generally if if

503
00:22:14,850 --> 00:22:19,740
that's an option then that gets rid of

504
00:22:18,540 --> 00:22:21,928
some of the problems that pre-planning

505
00:22:19,740 --> 00:22:25,340
can cause but it depends on your

506
00:22:21,929 --> 00:22:28,410
upstream if so if that's an option okay

507
00:22:25,340 --> 00:22:31,230
next question is do your PGP sources

508
00:22:28,410 --> 00:22:32,880
include endrin networks that is I

509
00:22:31,230 --> 00:22:41,820
deliberately creeped into the entire

510
00:22:32,880 --> 00:22:44,010
commercial Internet let's see I'm not

511
00:22:41,820 --> 00:22:45,418
sure we have very many of those Oh as

512
00:22:44,010 --> 00:22:47,760
far as like the the prefixes that are

513
00:22:45,419 --> 00:22:50,250
getting prepended to the entire Internet

514
00:22:47,760 --> 00:22:54,450
it's possible they exist I don't believe

515
00:22:50,250 --> 00:22:57,150
the N Ren networks account for 8% of the

516
00:22:54,450 --> 00:22:59,669
global routing table so I think even if

517
00:22:57,150 --> 00:23:03,179
they are that's there's a greater trend

518
00:22:59,669 --> 00:23:04,650
beyond just those those networks okay

519
00:23:03,179 --> 00:23:06,870
next question is somewhere and that's

520
00:23:04,650 --> 00:23:08,520
because the prepend - all up streams

521
00:23:06,870 --> 00:23:11,549
data take into account that non

522
00:23:08,520 --> 00:23:13,080
prepended advertisements maybe - semi

523
00:23:11,549 --> 00:23:19,260
private pairings like research and

524
00:23:13,080 --> 00:23:22,470
education networks internet - this is

525
00:23:19,260 --> 00:23:26,309
similar of so your prepending - the

526
00:23:22,470 --> 00:23:29,400
whole internet to try to I guess

527
00:23:26,309 --> 00:23:32,760
prioritize receiving traffic through the

528
00:23:29,400 --> 00:23:34,650
Internet - or some yeah I guess so maybe

529
00:23:32,760 --> 00:23:36,660
that no that's possible I guess I would

530
00:23:34,650 --> 00:23:38,400
I would suggest if there's any if you're

531
00:23:36,660 --> 00:23:41,570
using at all any of the traffic that's

532
00:23:38,400 --> 00:23:44,850
coming through the global routing table

533
00:23:41,570 --> 00:23:48,750
then that's at risk due to the fact that

534
00:23:44,850 --> 00:23:50,549
it's simply prepended but it could be a

535
00:23:48,750 --> 00:23:51,960
certainly could be if somebody want to

536
00:23:50,549 --> 00:23:54,889
take that offline or get in touch with

537
00:23:51,960 --> 00:23:59,809
me I'd be happy to look into that

538
00:23:54,890 --> 00:24:02,520
alright next is there an IETF RFC or

539
00:23:59,809 --> 00:24:03,190
nanog or other operator group that's

540
00:24:02,520 --> 00:24:05,379
common park

541
00:24:03,190 --> 00:24:09,460
document doc prepend engagements should

542
00:24:05,380 --> 00:24:11,470
there be I'm not aware of one seems like

543
00:24:09,460 --> 00:24:12,970
the topic would be probably larger than

544
00:24:11,470 --> 00:24:16,540
maybe just traffic engineering in

545
00:24:12,970 --> 00:24:18,370
general I guess I'm not I'm not sure

546
00:24:16,540 --> 00:24:22,840
maybe someone else can contrive in as

547
00:24:18,370 --> 00:24:27,189
far as best common practices on traffic

548
00:24:22,840 --> 00:24:30,129
engineering okay

549
00:24:27,190 --> 00:24:32,260
can you filter prepending at the pier

550
00:24:30,130 --> 00:24:38,980
ideally it would only be needed on one

551
00:24:32,260 --> 00:24:41,230
hop I think some people have heard you

552
00:24:38,980 --> 00:24:45,280
know I gave this talk at ripe and

553
00:24:41,230 --> 00:24:47,500
remember the audience had commented that

554
00:24:45,280 --> 00:24:52,860
they drop you know prepends longer than

555
00:24:47,500 --> 00:24:55,000
X number I guess the the idea would be

556
00:24:52,860 --> 00:24:58,780
yeah it's hard to know I try to know

557
00:24:55,000 --> 00:25:01,510
where where you want it says they the

558
00:24:58,780 --> 00:25:03,220
question asked one hop away but it may

559
00:25:01,510 --> 00:25:05,830
be maybe you're trying to influence

560
00:25:03,220 --> 00:25:08,290
something farther away than one hop so

561
00:25:05,830 --> 00:25:10,659
you may not know what hop you want that

562
00:25:08,290 --> 00:25:13,090
people need to take effect I guess after

563
00:25:10,660 --> 00:25:15,850
that point that you'd want to reduce to

564
00:25:13,090 --> 00:25:18,510
unique if I'd down to removed I'm not

565
00:25:15,850 --> 00:25:25,169
aware of a technology that does that

566
00:25:18,510 --> 00:25:27,610
maybe it exists are the ipv4 and ipv6

567
00:25:25,170 --> 00:25:32,020
lists of bad actors public and

568
00:25:27,610 --> 00:25:37,629
dynamically updating you know we didn't

569
00:25:32,020 --> 00:25:39,520
publish that but if someone want to get

570
00:25:37,630 --> 00:25:43,300
in touch with me I'd be happy to share

571
00:25:39,520 --> 00:25:44,680
sure that data with them okay and here's

572
00:25:43,300 --> 00:25:47,230
the last question unless somebody else

573
00:25:44,680 --> 00:25:49,330
submits one very quickly could those

574
00:25:47,230 --> 00:25:51,700
brief excuse me could those percentages

575
00:25:49,330 --> 00:25:58,689
be due to enterprises using their backup

576
00:25:51,700 --> 00:26:01,000
providers long term let's see yeah I

577
00:25:58,690 --> 00:26:02,890
guess I guess so that was our my

578
00:26:01,000 --> 00:26:04,240
explanation for your theories of how

579
00:26:02,890 --> 00:26:06,580
this how this came to be

580
00:26:04,240 --> 00:26:09,970
whether it's one's a primary a backup

581
00:26:06,580 --> 00:26:12,790
you have you've have you had to up

582
00:26:09,970 --> 00:26:14,590
streams your prepending to one the non

583
00:26:12,790 --> 00:26:16,330
pre-printed one where to go it away for

584
00:26:14,590 --> 00:26:16,990
some reason and you just stayed on the

585
00:26:16,330 --> 00:26:18,730
prepended

586
00:26:16,990 --> 00:26:21,070
one I guess in this case and the

587
00:26:18,730 --> 00:26:23,679
question of the backup link you never

588
00:26:21,070 --> 00:26:25,809
you never went away from it

589
00:26:23,679 --> 00:26:28,720
and so now that persists that could

590
00:26:25,809 --> 00:26:30,550
definitely account for a lot of it and I

591
00:26:28,720 --> 00:26:32,470
guess I would suggest that that you're

592
00:26:30,550 --> 00:26:35,169
leaving yourself vulnerable to a routing

593
00:26:32,470 --> 00:26:36,760
incident by having your path so long if

594
00:26:35,170 --> 00:26:38,710
there's an origination leak out there

595
00:26:36,760 --> 00:26:44,020
everybody's gonna go for the the leaker

596
00:26:38,710 --> 00:26:45,250
over your legitimate route okay that's

597
00:26:44,020 --> 00:26:47,800
the last of the question don't know

598
00:26:45,250 --> 00:26:49,150
here's another one what is the best way

599
00:26:47,800 --> 00:26:54,790
to contact Doug with additional

600
00:26:49,150 --> 00:26:57,070
questions let's see maybe I can share my

601
00:26:54,790 --> 00:27:01,389
email it's Douglas stop midoriya Oracle

602
00:26:57,070 --> 00:27:03,250
com alright thank you very much Doug I

603
00:27:01,390 --> 00:27:05,050
appreciate you giving the talk and being

604
00:27:03,250 --> 00:27:06,940
here to answer the questions the project

605
00:27:05,050 --> 00:27:08,830
who's there that concludes our current

606
00:27:06,940 --> 00:27:12,010
session we'll be back at 4:30 p.m.

607
00:27:08,830 --> 00:27:14,110
Eastern time with taka and Aaron

608
00:27:12,010 --> 00:27:15,150
internet routing registry updates thanks

609
00:27:14,110 --> 00:27:22,889
a lot

610
00:27:15,150 --> 00:27:22,890
[Music]

