1
00:00:00,560 --> 00:00:07,369
here's<font color="#E5E5E5"> the roughage end I hope to get</font>

2
00:00:02,730 --> 00:00:07,369
through we'll<font color="#E5E5E5"> skip around a little bit I</font>

3
00:00:09,920 --> 00:00:13,320
want<font color="#E5E5E5"> to give everyone a kind of an idea</font>

4
00:00:11,910 --> 00:00:15,240
of why this is important if you don't

5
00:00:13,320 --> 00:00:16,920
already know I think<font color="#CCCCCC"> everyone is seen at</font>

6
00:00:15,240 --> 00:00:18,990
<font color="#E5E5E5">least the increase of</font><font color="#CCCCCC"> lots</font><font color="#E5E5E5"> that have</font>

7
00:00:16,920 --> 00:00:22,680
been rampant and proliferate it over the

8
00:00:18,990 --> 00:00:24,269
last year or so by lasts less person

9
00:00:22,680 --> 00:00:27,960
I've<font color="#E5E5E5"> talked to has given me a count of</font>

10
00:00:24,269 --> 00:00:31,409
bots that have been known to be unique

11
00:00:27,960 --> 00:00:32,579
pods upwards of<font color="#E5E5E5"> 4 million hosts and I</font>

12
00:00:31,410 --> 00:00:34,050
don't know how<font color="#E5E5E5"> you come at that count</font>

13
00:00:32,579 --> 00:00:36,480
but four million<font color="#E5E5E5"> hosts or sounds like a</font>

14
00:00:34,050 --> 00:00:39,809
lot of bots to me a lot<font color="#E5E5E5"> of scary pack of</font>

15
00:00:36,480 --> 00:00:40,828
potential there if if nothing else

16
00:00:39,809 --> 00:00:43,349
there's probably at least a few hundred

17
00:00:40,829 --> 00:00:44,640
thousand so as this is risen over the

18
00:00:43,350 --> 00:00:46,079
past year I think<font color="#CCCCCC"> it's important for</font>

19
00:00:44,640 --> 00:00:47,550
network operators to talk about this

20
00:00:46,079 --> 00:00:49,739
that there's anything that we can do we

21
00:00:47,550 --> 00:00:51,750
should sort of look at looking at ways

22
00:00:49,739 --> 00:00:53,070
to mitigate this and we're going<font color="#CCCCCC"> to try</font>

23
00:00:51,750 --> 00:00:54,510
<font color="#CCCCCC">to focus on is more of the command and</font>

24
00:00:53,070 --> 00:00:56,489
<font color="#E5E5E5">control infrastructure rather than</font>

25
00:00:54,510 --> 00:00:58,739
compromise host we've had compromised

26
00:00:56,489 --> 00:01:00,570
souls forever we<font color="#E5E5E5"> certainly can't get rid</font>

27
00:00:58,739 --> 00:01:02,370
of all those<font color="#CCCCCC"> what we there's ways that</font>

28
00:01:00,570 --> 00:01:05,459
we can minimize the effect of the

29
00:01:02,370 --> 00:01:06,869
botnets and their malicious intent

30
00:01:05,459 --> 00:01:09,750
usually in the form of denial of service

31
00:01:06,869 --> 00:01:11,640
attacks or fishing fishing expositions

32
00:01:09,750 --> 00:01:13,770
of those sorts of things it might<font color="#E5E5E5"> be</font>

33
00:01:11,640 --> 00:01:20,720
nice to thrust if we can mitigate some

34
00:01:13,770 --> 00:01:20,720
of that I should<font color="#E5E5E5"> be okay</font>

35
00:01:22,570 --> 00:01:28,429
we're<font color="#E5E5E5"> going to permanently focus on IRC</font>

36
00:01:25,070 --> 00:01:29,779
<font color="#CCCCCC">based botnets IRC time is</font><font color="#E5E5E5"> probably using</font>

37
00:01:28,430 --> 00:01:32,600
the majority of botnets that you see

38
00:01:29,780 --> 00:01:34,520
where a there's a centralized command

39
00:01:32,600 --> 00:01:36,080
control infrastructure and by

40
00:01:34,520 --> 00:01:38,360
centralized<font color="#E5E5E5"> it could be one or more IRC</font>

41
00:01:36,080 --> 00:01:40,970
servers but<font color="#E5E5E5"> certainly few IRC servers</font>

42
00:01:38,360 --> 00:01:42,920
then there<font color="#E5E5E5"> are number of bonds and</font>

43
00:01:40,970 --> 00:01:44,120
there's been other command control

44
00:01:42,920 --> 00:01:46,190
infrastructures whether it's

45
00:01:44,120 --> 00:01:49,090
peer-to-peer or instant message about

46
00:01:46,190 --> 00:01:51,200
IRC reply and large is the<font color="#CCCCCC"> communicant</font>

47
00:01:49,090 --> 00:01:54,860
command and control infrastructure of

48
00:01:51,200 --> 00:01:58,850
choice you<font color="#CCCCCC"> have probably at least a few</font>

49
00:01:54,860 --> 00:02:00,830
<font color="#CCCCCC">hundred a few</font><font color="#E5E5E5"> thousand rogue IRC servers</font>

50
00:01:58,850 --> 00:02:04,369
that have been known or seen in the wild

51
00:02:00,830 --> 00:02:06,320
<font color="#E5E5E5">and the bot is nothing more</font><font color="#CCCCCC"> than malware</font>

52
00:02:04,370 --> 00:02:09,350
installed on a host<font color="#E5E5E5"> that contains</font>

53
00:02:06,320 --> 00:02:13,010
exploit tools and attack tools and the

54
00:02:09,350 --> 00:02:14,570
actual IRC client code and we've had at

55
00:02:13,010 --> 00:02:15,980
least a<font color="#E5E5E5"> Miss Greene or two in the back</font>

56
00:02:14,570 --> 00:02:18,230
there that's told us about the<font color="#E5E5E5"> reasons</font>

57
00:02:15,980 --> 00:02:20,239
for botnets are sometimes for fun but

58
00:02:18,230 --> 00:02:22,030
most often<font color="#E5E5E5"> today they're for profit so</font>

59
00:02:20,240 --> 00:02:24,700
<font color="#E5E5E5">people are making really a lot of money</font>

60
00:02:22,030 --> 00:02:27,560
managing button that's attacking people

61
00:02:24,700 --> 00:02:29,780
either through denial service attacks or

62
00:02:27,560 --> 00:02:31,840
stealing credit cards and those sorts of

63
00:02:29,780 --> 00:02:31,840
things

64
00:02:41,740 --> 00:02:48,920
there's really there's really three

65
00:02:46,640 --> 00:02:50,839
parts to the basic command control

66
00:02:48,920 --> 00:02:52,850
infrastructure of today's botnets

67
00:02:50,840 --> 00:02:55,820
<font color="#CCCCCC">they're based on our see there's the IRC</font>

68
00:02:52,850 --> 00:02:57,530
servers themselves then there's<font color="#E5E5E5"> the DNS</font>

69
00:02:55,820 --> 00:02:59,690
names that are used to associate to

70
00:02:57,530 --> 00:03:02,960
those host addresses that are the IRC

71
00:02:59,690 --> 00:03:05,450
servers then there's often a vanity

72
00:03:02,960 --> 00:03:07,670
based web page where the malware will be

73
00:03:05,450 --> 00:03:10,100
installed so the bots can go<font color="#E5E5E5"> update</font>

74
00:03:07,670 --> 00:03:13,549
themselves with new attack tools and new

75
00:03:10,100 --> 00:03:15,079
IRC client code none<font color="#CCCCCC"> of this has really</font>

76
00:03:13,550 --> 00:03:17,060
knew though three years ago<font color="#E5E5E5"> this month</font>

77
00:03:15,080 --> 00:03:18,530
there was<font color="#E5E5E5"> a paper at</font><font color="#CCCCCC"> least at cert that</font>

78
00:03:17,060 --> 00:03:20,930
talked about all this stuff except for

79
00:03:18,530 --> 00:03:22,640
the<font color="#CCCCCC"> Bennet II web pages so none of this</font>

80
00:03:20,930 --> 00:03:23,810
information is really all that<font color="#E5E5E5"> new what</font>

81
00:03:22,640 --> 00:03:25,910
we're trying to do is really<font color="#E5E5E5"> kind of</font>

82
00:03:23,810 --> 00:03:27,410
raise the level of understanding by

83
00:03:25,910 --> 00:03:29,810
network operators<font color="#E5E5E5"> that this stuff is out</font>

84
00:03:27,410 --> 00:03:31,190
there and it's proliferating to the fact

85
00:03:29,810 --> 00:03:33,340
to<font color="#CCCCCC"> the point that</font><font color="#E5E5E5"> we need to really</font>

86
00:03:31,190 --> 00:03:35,720
start<font color="#CCCCCC"> looking at how to deal with this</font>

87
00:03:33,340 --> 00:03:40,340
before it starts taking down the larger

88
00:03:35,720 --> 00:03:42,230
networks so the bots are made up of the

89
00:03:40,340 --> 00:03:44,450
malware and there's really two ways<font color="#E5E5E5"> that</font>

90
00:03:42,230 --> 00:03:46,880
a bot will become a bot one is the come

91
00:03:44,450 --> 00:03:49,670
& get it method where either via some

92
00:03:46,880 --> 00:03:51,829
link in an email or via web page or<font color="#E5E5E5"> a</font>

93
00:03:49,670 --> 00:03:53,359
peer-to-peer file sharing that someone's

94
00:03:51,830 --> 00:03:55,340
enticing you to come get something<font color="#E5E5E5"> that</font>

95
00:03:53,360 --> 00:03:57,019
you think that<font color="#CCCCCC"> you</font><font color="#E5E5E5"> want but in fact it's</font>

96
00:03:55,340 --> 00:04:00,019
really a piece of malware that contains

97
00:03:57,019 --> 00:04:02,000
the<font color="#CCCCCC"> BOK code and the other the other way</font>

98
00:04:00,019 --> 00:04:05,900
to get about is simply be a remote

99
00:04:02,000 --> 00:04:08,900
exploit and this seems<font color="#E5E5E5"> to be reducing</font>

100
00:04:05,900 --> 00:04:10,310
slightly thanks to service pack<font color="#E5E5E5"> 2 just</font>

101
00:04:08,900 --> 00:04:12,350
ended a little evidence from people<font color="#E5E5E5"> i've</font>

102
00:04:10,310 --> 00:04:15,019
talked to<font color="#E5E5E5"> they've seen approximately</font>

103
00:04:12,350 --> 00:04:16,640
about a third of their hosts drop in

104
00:04:15,019 --> 00:04:19,790
being remotely exploitable from some of

105
00:04:16,640 --> 00:04:20,959
the common like soft exploits that<font color="#CCCCCC"> i've</font>

106
00:04:19,790 --> 00:04:22,850
<font color="#E5E5E5">been released over the past year so</font>

107
00:04:20,959 --> 00:04:23,930
that's somewhat of a good sign I don't

108
00:04:22,850 --> 00:04:26,630
<font color="#E5E5E5">think that's</font><font color="#CCCCCC"> going to really have an</font>

109
00:04:23,930 --> 00:04:29,300
overall huge impact on bots and botnets

110
00:04:26,630 --> 00:04:31,640
though it made somewhat reduced the

111
00:04:29,300 --> 00:04:32,660
level of a flash worm type of fact but I

112
00:04:31,640 --> 00:04:36,250
think we'll probably see bots and

113
00:04:32,660 --> 00:04:36,250
botnets continue to flourish or sometime

114
00:04:36,310 --> 00:04:40,070
so here's the themes that I kind of want

115
00:04:38,780 --> 00:04:41,450
<font color="#E5E5E5">to focus on</font><font color="#CCCCCC"> isn't any network based</font>

116
00:04:40,070 --> 00:04:43,420
mitigation<font color="#CCCCCC"> that we can do is good</font>

117
00:04:41,450 --> 00:04:44,770
simpler the better and

118
00:04:43,420 --> 00:04:46,570
looking at the command<font color="#E5E5E5"> control</font>

119
00:04:44,770 --> 00:04:47,950
infrastructure there's things that we

120
00:04:46,570 --> 00:04:50,050
can do to disrupt that command and

121
00:04:47,950 --> 00:04:51,880
control infrastructure we need may not

122
00:04:50,050 --> 00:04:53,050
be able<font color="#E5E5E5"> to get rid of all those BOTS but</font>

123
00:04:51,880 --> 00:04:54,790
if<font color="#CCCCCC"> we can disrupt that command and</font>

124
00:04:53,050 --> 00:04:56,770
control infrastructure we disrupt the

125
00:04:54,790 --> 00:04:58,270
ability for those botnets to perform

126
00:04:56,770 --> 00:05:00,430
their work which is<font color="#E5E5E5"> usually denial of</font>

127
00:04:58,270 --> 00:05:02,680
service attacks which network operators

128
00:05:00,430 --> 00:05:07,690
is probably the most<font color="#E5E5E5"> offensive the</font>

129
00:05:02,680 --> 00:05:10,060
things that we don't<font color="#E5E5E5"> like to see so</font>

130
00:05:07,690 --> 00:05:11,590
there's the rogue RC controller and a

131
00:05:10,060 --> 00:05:13,150
rogue agency controller is nothing more

132
00:05:11,590 --> 00:05:15,369
than<font color="#E5E5E5"> IRC server that's set up primarily</font>

133
00:05:13,150 --> 00:05:17,380
for<font color="#E5E5E5"> the use of corralling and managing</font>

134
00:05:15,370 --> 00:05:19,450
about<font color="#E5E5E5"> that</font><font color="#CCCCCC"> network so this isn't the</font>

135
00:05:17,380 --> 00:05:21,700
public IRC servers like EF nets are down

136
00:05:19,450 --> 00:05:23,620
that you may be familiar with this is an

137
00:05:21,700 --> 00:05:25,960
IRC server typically installed on an

138
00:05:23,620 --> 00:05:27,370
already compromised host probably a host

139
00:05:25,960 --> 00:05:29,560
that<font color="#E5E5E5"> already had a bot that's just</font>

140
00:05:27,370 --> 00:05:31,930
simply been promoted there's usually a

141
00:05:29,560 --> 00:05:34,150
few characteristics<font color="#E5E5E5"> to a rogue IRC</font>

142
00:05:31,930 --> 00:05:37,180
server that<font color="#CCCCCC"> you might not find in a</font>

143
00:05:34,150 --> 00:05:41,979
typical IRC server the IRC protocol

144
00:05:37,180 --> 00:05:44,200
defaults to port 6667 on<font color="#CCCCCC"> tcp commonly</font>

145
00:05:41,980 --> 00:05:45,730
you see any port being used in<font color="#CCCCCC"> fact a</font>

146
00:05:44,200 --> 00:05:48,190
number reports that are just odd ports

147
00:05:45,730 --> 00:05:50,500
on<font color="#CCCCCC"> TCP beings piracy servers that i</font>

148
00:05:48,190 --> 00:05:52,690
wrote<font color="#CCCCCC"> information-gathering</font><font color="#E5E5E5"> commands</font>

149
00:05:50,500 --> 00:05:54,520
<font color="#E5E5E5">like who is or</font><font color="#CCCCCC"> listing channels are</font>

150
00:05:52,690 --> 00:05:56,140
often disabled or booby-trapped to alert

151
00:05:54,520 --> 00:05:57,520
<font color="#CCCCCC">I needed miss</font><font color="#E5E5E5"> green operators that</font>

152
00:05:56,140 --> 00:06:00,580
you're on to them and looking<font color="#E5E5E5"> around on</font>

153
00:05:57,520 --> 00:06:02,370
the road IRC server servers occasionally

154
00:06:00,580 --> 00:06:04,510
not that often but occasionally

155
00:06:02,370 --> 00:06:05,560
password-protected channels are hidden

156
00:06:04,510 --> 00:06:08,380
so<font color="#E5E5E5"> you can't see them in a</font>

157
00:06:05,560 --> 00:06:10,660
<font color="#E5E5E5">information-gathering whist command the</font>

158
00:06:08,380 --> 00:06:12,340
probably password protected and there's

159
00:06:10,660 --> 00:06:13,870
probably<font color="#CCCCCC"> a few other things that may</font>

160
00:06:12,340 --> 00:06:16,090
indicate that you're<font color="#E5E5E5"> dealing with a</font>

161
00:06:13,870 --> 00:06:18,460
rogue IRC server if we're able to see

162
00:06:16,090 --> 00:06:20,890
the login messages or some be able to

163
00:06:18,460 --> 00:06:22,150
log into a rogue IRC server some of the

164
00:06:20,890 --> 00:06:23,349
things that<font color="#E5E5E5"> you might find that</font><font color="#CCCCCC"> would</font>

165
00:06:22,150 --> 00:06:26,049
tip you off is that there's a high

166
00:06:23,350 --> 00:06:29,050
number of invisible too visible users

167
00:06:26,050 --> 00:06:31,000
that is where a user on an IRC servers

168
00:06:29,050 --> 00:06:32,890
mask their identity so you can't see who

169
00:06:31,000 --> 00:06:34,900
they are or list them<font color="#E5E5E5"> out and one of the</font>

170
00:06:32,890 --> 00:06:36,430
<font color="#E5E5E5">information-gathering commands or if</font>

171
00:06:34,900 --> 00:06:38,169
there's a large number of users on the

172
00:06:36,430 --> 00:06:39,640
<font color="#E5E5E5">server but there's only three or four</font>

173
00:06:38,170 --> 00:06:41,410
channels that would<font color="#E5E5E5"> tend to indicate</font>

174
00:06:39,640 --> 00:06:43,270
that that's really<font color="#E5E5E5"> not a valid server</font>

175
00:06:41,410 --> 00:06:44,500
because how often do you see a few

176
00:06:43,270 --> 00:06:46,060
thousand people<font color="#E5E5E5"> and channel have the</font>

177
00:06:44,500 --> 00:06:49,270
discussion and it just doesn't happen

178
00:06:46,060 --> 00:06:51,100
<font color="#CCCCCC">once it's moderated there's a few other</font>

179
00:06:49,270 --> 00:06:52,960
<font color="#CCCCCC">things and</font><font color="#E5E5E5"> I'll just show you a couple</font>

180
00:06:51,100 --> 00:06:55,120
samples in<font color="#E5E5E5"> the next slide but real quick</font>

181
00:06:52,960 --> 00:06:57,099
<font color="#E5E5E5">that a couple of DNS things and DNS is a</font>

182
00:06:55,120 --> 00:07:00,180
really handy thing to keep an eye on to

183
00:06:57,100 --> 00:07:03,010
identify and track rogue IRC servers a

184
00:07:00,180 --> 00:07:05,830
<font color="#CCCCCC">DNS name is almost always used because</font>

185
00:07:03,010 --> 00:07:07,630
it's an easy way to locate an IRC

186
00:07:05,830 --> 00:07:10,000
servers especially<font color="#E5E5E5"> if I receive server</font>

187
00:07:07,630 --> 00:07:12,400
goes away to come<font color="#CCCCCC"> compromised machine</font>

188
00:07:10,000 --> 00:07:14,200
like any other it's<font color="#E5E5E5"> often going to be</font>

189
00:07:12,400 --> 00:07:16,539
susceptible being detected and then take

190
00:07:14,200 --> 00:07:19,180
it offline so a<font color="#CCCCCC"> DNS name provides a way</font>

191
00:07:16,540 --> 00:07:20,890
for Miss crane to set up a network based

192
00:07:19,180 --> 00:07:24,550
on a name that can be shifted around to

193
00:07:20,890 --> 00:07:25,990
different a records and believe<font color="#E5E5E5"> it or</font>

194
00:07:24,550 --> 00:07:27,550
not a lot of the the names<font color="#E5E5E5"> that are</font>

195
00:07:25,990 --> 00:07:29,320
associated with rogue IRC servers are

196
00:07:27,550 --> 00:07:31,240
pretty<font color="#CCCCCC"> obvious when once you see the</font>

197
00:07:29,320 --> 00:07:33,969
name it's often<font color="#E5E5E5"> something that just</font>

198
00:07:31,240 --> 00:07:35,380
looks<font color="#CCCCCC"> row so and so far that's been a</font>

199
00:07:33,970 --> 00:07:39,160
good<font color="#CCCCCC"> thing at least</font><font color="#E5E5E5"> for the people who</font>

200
00:07:35,380 --> 00:07:41,469
<font color="#E5E5E5">are fighting by</font><font color="#CCCCCC"> that's so here</font><font color="#E5E5E5"> is a</font>

201
00:07:39,160 --> 00:07:43,720
simplified example of what you<font color="#E5E5E5"> might</font>

202
00:07:41,470 --> 00:07:45,460
find if you were to watch a bot log on

203
00:07:43,720 --> 00:07:46,540
to a rogue IRC server now there's a

204
00:07:45,460 --> 00:07:48,580
number of<font color="#E5E5E5"> things that's wrong with</font><font color="#CCCCCC"> this</font>

205
00:07:46,540 --> 00:07:50,050
picture one there's a couple<font color="#E5E5E5"> of names</font>

206
00:07:48,580 --> 00:07:52,870
here that either don't resolve or just

207
00:07:50,050 --> 00:07:55,060
don't<font color="#E5E5E5"> exist there's large number of</font>

208
00:07:52,870 --> 00:07:56,850
users that<font color="#CCCCCC"> are invisible there's a large</font>

209
00:07:55,060 --> 00:07:59,080
number of users two channels available

210
00:07:56,850 --> 00:08:00,880
there's only one<font color="#E5E5E5"> operator online</font>

211
00:07:59,080 --> 00:08:02,320
typically if<font color="#E5E5E5"> you have a significantly</font>

212
00:08:00,880 --> 00:08:03,880
large IRC network you're going to have

213
00:08:02,320 --> 00:08:06,040
more operators so that they can manage

214
00:08:03,880 --> 00:08:07,690
that<font color="#E5E5E5"> network it all I got one that's</font>

215
00:08:06,040 --> 00:08:09,790
usually<font color="#CCCCCC"> a sign that as a rogue IRC</font>

216
00:08:07,690 --> 00:08:12,850
server as well and<font color="#E5E5E5"> of course</font><font color="#CCCCCC"> you got a</font>

217
00:08:09,790 --> 00:08:15,990
suspicious-looking channel name as<font color="#E5E5E5"> well</font>

218
00:08:12,850 --> 00:08:15,990
as the topic for<font color="#CCCCCC"> that channel</font>

219
00:08:17,950 --> 00:08:21,880
then there's IRC networks that are set

220
00:08:19,900 --> 00:08:25,870
up to appears to<font color="#CCCCCC"> be primarily used for</font>

221
00:08:21,880 --> 00:08:28,090
rogue not road but somewhat suspicious

222
00:08:25,870 --> 00:08:30,370
file sharing of<font color="#E5E5E5"> wares are copyrighted</font>

223
00:08:28,090 --> 00:08:32,770
material like movies<font color="#CCCCCC"> and music and it's</font>

224
00:08:30,370 --> 00:08:34,690
not entirely clear that these IRC

225
00:08:32,770 --> 00:08:36,610
servers should be shut<font color="#E5E5E5"> down completely</font>

226
00:08:34,690 --> 00:08:39,070
but certainly a<font color="#E5E5E5"> lot of activity</font><font color="#CCCCCC"> that</font>

227
00:08:36,610 --> 00:08:41,500
occurs on them this is at least or best

228
00:08:39,070 --> 00:08:43,540
suspicious and so this<font color="#CCCCCC"> is</font><font color="#E5E5E5"> not unlike</font>

229
00:08:41,500 --> 00:08:45,400
peer to peer file sharing now it's been

230
00:08:43,539 --> 00:08:47,380
said and it's<font color="#E5E5E5"> probably a good argument</font>

231
00:08:45,400 --> 00:08:48,790
to<font color="#E5E5E5"> make in this room but these types of</font>

232
00:08:47,380 --> 00:08:50,590
networks even though their BOTS and

233
00:08:48,790 --> 00:08:53,260
<font color="#E5E5E5">their</font><font color="#CCCCCC"> compromise</font><font color="#E5E5E5"> and maybe have back</font>

234
00:08:50,590 --> 00:08:55,240
door ftp servers on them maybe this is

235
00:08:53,260 --> 00:08:56,920
something best left to the<font color="#E5E5E5"> software</font>

236
00:08:55,240 --> 00:08:58,690
police type of<font color="#CCCCCC"> organisations we've got</font>

237
00:08:56,920 --> 00:09:01,689
enough problems<font color="#E5E5E5"> of dealing with</font><font color="#CCCCCC"> attacks</font>

238
00:08:58,690 --> 00:09:03,850
and other things if this isn't impacting

239
00:09:01,690 --> 00:09:08,860
infrastructure let someone else go after

240
00:09:03,850 --> 00:09:10,630
these for<font color="#CCCCCC"> a change then you believe it</font>

241
00:09:08,860 --> 00:09:12,670
<font color="#E5E5E5">or not there are legitimate IRC servers</font>

242
00:09:10,630 --> 00:09:15,220
there's probably<font color="#CCCCCC"> a few people in a</font>

243
00:09:12,670 --> 00:09:18,069
nightie server<font color="#E5E5E5"> nano channel mocking my</font>

244
00:09:15,220 --> 00:09:20,250
presentation right now<font color="#E5E5E5"> and there's a but</font>

245
00:09:18,070 --> 00:09:26,350
there are spots that tend to collect on

246
00:09:20,250 --> 00:09:28,030
these servers generally<font color="#CCCCCC"> for the purpose</font>

247
00:09:26,350 --> 00:09:30,580
of migrating from one row guys you've

248
00:09:28,030 --> 00:09:31,990
server to another if you if you're

249
00:09:30,580 --> 00:09:33,760
<font color="#E5E5E5">running a rogue IRC server and gets</font>

250
00:09:31,990 --> 00:09:35,710
taken down you need<font color="#CCCCCC"> to</font><font color="#E5E5E5"> move</font><font color="#CCCCCC"> to another</font>

251
00:09:33,760 --> 00:09:37,450
IRC server obviously but before you can

252
00:09:35,710 --> 00:09:39,370
do that<font color="#E5E5E5"> you might park yourself on a</font>

253
00:09:37,450 --> 00:09:41,260
legitimate piracy server kind of corral

254
00:09:39,370 --> 00:09:43,300
everyone together before<font color="#CCCCCC"> you move on</font><font color="#E5E5E5"> and</font>

255
00:09:41,260 --> 00:09:44,730
that happens pretty frequently and<font color="#E5E5E5"> there</font>

256
00:09:43,300 --> 00:09:47,469
of<font color="#CCCCCC"> course there's some miscreants who</font>

257
00:09:44,730 --> 00:09:48,970
actually build their botnet some real

258
00:09:47,470 --> 00:09:50,560
IRC servers although you don't find that

259
00:09:48,970 --> 00:09:53,080
<font color="#E5E5E5">a whole lot especially not really large</font>

260
00:09:50,560 --> 00:09:54,760
botnets luckily most of the<font color="#E5E5E5"> legitimate</font>

261
00:09:53,080 --> 00:09:56,920
IRC servers are run by pretty good folks

262
00:09:54,760 --> 00:09:59,290
and they tend<font color="#E5E5E5"> to get rid of those BOTS</font>

263
00:09:56,920 --> 00:10:00,760
pretty quickly although if you talk to

264
00:09:59,290 --> 00:10:02,439
them they're pretty hesitant to kill off

265
00:10:00,760 --> 00:10:04,090
<font color="#E5E5E5">BOTS too quickly because they know if</font>

266
00:10:02,440 --> 00:10:05,320
<font color="#E5E5E5">they do the people who run those bonnets</font>

267
00:10:04,090 --> 00:10:08,380
you're going to come after them and<font color="#CCCCCC"> they</font>

268
00:10:05,320 --> 00:10:10,750
have nothing<font color="#E5E5E5"> to lose to do so so I</font>

269
00:10:08,380 --> 00:10:14,830
racino IRC networks are often targeted

270
00:10:10,750 --> 00:10:16,570
attacks but<font color="#E5E5E5"> if IRC servers can do a</font>

271
00:10:14,830 --> 00:10:18,430
little bit more<font color="#E5E5E5"> on monitoring if they</font>

272
00:10:16,570 --> 00:10:19,780
<font color="#CCCCCC">take a look at the spikes and their</font>

273
00:10:18,430 --> 00:10:21,969
connections that come in if they see a

274
00:10:19,780 --> 00:10:23,829
huge number<font color="#E5E5E5"> of connections coming into</font>

275
00:10:21,970 --> 00:10:26,380
small intervals that may be bought and

276
00:10:23,830 --> 00:10:28,230
that's<font color="#E5E5E5"> coming in if they see long idle</font>

277
00:10:26,380 --> 00:10:30,630
connections particularly for<font color="#E5E5E5"> one</font>

278
00:10:28,230 --> 00:10:33,000
and with<font color="#CCCCCC"> nicks that are</font><font color="#E5E5E5"> Nablus where</font>

279
00:10:30,630 --> 00:10:34,380
<font color="#CCCCCC">they you've got</font><font color="#E5E5E5"> are prefixed to a neck</font>

280
00:10:33,000 --> 00:10:36,570
that everyone shares and then a few

281
00:10:34,380 --> 00:10:38,160
random characters<font color="#E5E5E5"> after that but usually</font>

282
00:10:36,570 --> 00:10:39,870
indicates that there's a<font color="#E5E5E5"> bot not farming</font>

283
00:10:38,160 --> 00:10:41,250
there and so it's there an evening

284
00:10:39,870 --> 00:10:42,900
position to actually find some of this

285
00:10:41,250 --> 00:10:44,400
stuff and<font color="#E5E5E5"> while they don't</font><font color="#CCCCCC"> necessarily</font>

286
00:10:42,900 --> 00:10:45,840
have to shut them all down and<font color="#E5E5E5"> take the</font>

287
00:10:44,400 --> 00:10:47,790
packet pain that comes with it they

288
00:10:45,840 --> 00:10:49,560
could<font color="#E5E5E5"> possibly report them the</font><font color="#CCCCCC"> grid like</font>

289
00:10:47,790 --> 00:10:54,329
d shield or my net watch men to<font color="#E5E5E5"> get some</font>

290
00:10:49,560 --> 00:10:56,280
<font color="#E5E5E5">of those hosts going down the dns plays</font>

291
00:10:54,330 --> 00:10:59,040
a very important role for miscreants and

292
00:10:56,280 --> 00:11:00,390
rogue IRC servers one or more IP

293
00:10:59,040 --> 00:11:02,099
addresses can be<font color="#E5E5E5"> associated with</font><font color="#CCCCCC"> the</font>

294
00:11:00,390 --> 00:11:04,290
<font color="#E5E5E5">name and the</font><font color="#CCCCCC"> name is very easy to come</font>

295
00:11:02,100 --> 00:11:05,640
by you can typically get a name for free

296
00:11:04,290 --> 00:11:08,969
or burry<font color="#CCCCCC"> low cost from a number of</font>

297
00:11:05,640 --> 00:11:11,040
providers all over the world and<font color="#E5E5E5"> the</font>

298
00:11:08,970 --> 00:11:14,430
records<font color="#CCCCCC"> that are used for road IRC</font>

299
00:11:11,040 --> 00:11:16,650
servers well often they look rogue in

300
00:11:14,430 --> 00:11:18,660
the name themselves one of the clues

301
00:11:16,650 --> 00:11:20,760
often is you see that the TTL<font color="#CCCCCC"> of that</font>

302
00:11:18,660 --> 00:11:22,170
record<font color="#E5E5E5"> is</font><font color="#CCCCCC"> very low usually it's on the</font>

303
00:11:20,760 --> 00:11:25,290
order of five minutes or even a few

304
00:11:22,170 --> 00:11:26,939
<font color="#E5E5E5">seconds just in case of actual host goes</font>

305
00:11:25,290 --> 00:11:28,170
away they can update that records so

306
00:11:26,940 --> 00:11:31,620
they can point their BOTS at a different

307
00:11:28,170 --> 00:11:33,390
server and I I'm not really much of a

308
00:11:31,620 --> 00:11:35,640
Perl program I<font color="#CCCCCC"> see I</font><font color="#E5E5E5"> know combat pearl</font>

309
00:11:33,390 --> 00:11:37,199
and i<font color="#E5E5E5"> created this script called dns</font>

310
00:11:35,640 --> 00:11:39,510
watch that you can watch dns records

311
00:11:37,200 --> 00:11:41,250
change over time<font color="#E5E5E5"> and a good example</font><font color="#CCCCCC"> is</font>

312
00:11:39,510 --> 00:11:43,530
you can pipe a couple of sites like

313
00:11:41,250 --> 00:11:45,180
yahoo of<font color="#E5E5E5"> google to it you can</font><font color="#CCCCCC"> watch as a</font>

314
00:11:43,530 --> 00:11:47,400
name changes IP addresses over some

315
00:11:45,180 --> 00:11:49,650
period of time and<font color="#E5E5E5"> so you could if you</font>

316
00:11:47,400 --> 00:11:51,780
can't get an a record cold from a<font color="#E5E5E5"> DNS</font>

317
00:11:49,650 --> 00:11:53,810
provider you might be at least monitor

318
00:11:51,780 --> 00:11:59,910
where that a record points over some

319
00:11:53,810 --> 00:12:01,859
some period of your mind at any time so

320
00:11:59,910 --> 00:12:04,410
in order to find<font color="#CCCCCC"> DNS there's probably</font>

321
00:12:01,860 --> 00:12:07,080
these three ways that you can do so if

322
00:12:04,410 --> 00:12:08,550
you run a<font color="#E5E5E5"> DNS server that's recursive</font>

323
00:12:07,080 --> 00:12:10,320
for a bunch of hosts that may have<font color="#E5E5E5"> BOTS</font>

324
00:12:08,550 --> 00:12:12,359
you can certainly<font color="#E5E5E5"> turn on query logging</font>

325
00:12:10,320 --> 00:12:13,740
I'm<font color="#E5E5E5"> most familiar with buying so any of</font>

326
00:12:12,360 --> 00:12:16,320
<font color="#E5E5E5">my dns examples are going to be</font>

327
00:12:13,740 --> 00:12:20,040
<font color="#E5E5E5">associated bind but you can turn on</font>

328
00:12:16,320 --> 00:12:21,750
query logging very few people seem<font color="#CCCCCC"> to do</font>

329
00:12:20,040 --> 00:12:23,699
that probably<font color="#E5E5E5"> because the performance</font>

330
00:12:21,750 --> 00:12:25,770
impact of that that involves in this

331
00:12:23,700 --> 00:12:27,090
space that's going to take but that's

332
00:12:25,770 --> 00:12:28,470
one option what it doesn't give you

333
00:12:27,090 --> 00:12:30,450
<font color="#E5E5E5">though is the a records it just gives</font>

334
00:12:28,470 --> 00:12:32,550
you the name of a host of querying for

335
00:12:30,450 --> 00:12:33,810
the other kind of<font color="#E5E5E5"> a newer technique</font>

336
00:12:32,550 --> 00:12:35,670
which is a really<font color="#E5E5E5"> interesting one and i</font>

337
00:12:33,810 --> 00:12:38,459
think really useful on is that people

338
00:12:35,670 --> 00:12:39,599
can set up a packet capture on their

339
00:12:38,460 --> 00:12:41,759
egress points or point

340
00:12:39,600 --> 00:12:43,560
organic traffic process between their

341
00:12:41,759 --> 00:12:45,630
network and they look for the<font color="#E5E5E5"> responses</font>

342
00:12:43,560 --> 00:12:48,000
coming back from queries going to

343
00:12:45,630 --> 00:12:49,079
servers outside their network what

344
00:12:48,000 --> 00:12:50,699
you're<font color="#E5E5E5"> looking for is you're looking</font><font color="#CCCCCC"> to</font>

345
00:12:49,079 --> 00:12:52,589
capture an a record that has both the

346
00:12:50,699 --> 00:12:54,359
query that was named the name that<font color="#E5E5E5"> was</font>

347
00:12:52,589 --> 00:12:56,310
queried for than the a records

348
00:12:54,360 --> 00:12:57,690
associated with that query and you take

349
00:12:56,310 --> 00:12:59,339
<font color="#E5E5E5">that information you don't really need</font>

350
00:12:57,690 --> 00:13:00,810
to<font color="#E5E5E5"> know specifically</font><font color="#CCCCCC"> who's Corrine for</font>

351
00:12:59,339 --> 00:13:02,670
it you just want<font color="#CCCCCC"> to build a database of</font>

352
00:13:00,810 --> 00:13:05,849
names associated to IP addresses all the

353
00:13:02,670 --> 00:13:07,740
<font color="#CCCCCC">time so you can take a</font><font color="#E5E5E5"> look if you see</font>

354
00:13:05,850 --> 00:13:09,899
or suspect a particular host is a row

355
00:13:07,740 --> 00:13:11,490
controller or if you suspect a

356
00:13:09,899 --> 00:13:13,019
particular name you can search through

357
00:13:11,490 --> 00:13:15,779
your database an associate one with the

358
00:13:13,019 --> 00:13:18,110
other and what that buys you over the

359
00:13:15,779 --> 00:13:20,519
query logging is that you have a history

360
00:13:18,110 --> 00:13:22,199
and of court that the<font color="#E5E5E5"> really hard way is</font>

361
00:13:20,519 --> 00:13:23,819
if you actually have a bot or you can

362
00:13:22,199 --> 00:13:25,529
<font color="#E5E5E5">get the code that's used on the bot and</font>

363
00:13:23,819 --> 00:13:27,389
you can take a<font color="#E5E5E5"> look at that malware and</font>

364
00:13:25,529 --> 00:13:30,660
either analyze it or set up in a lab and

365
00:13:27,389 --> 00:13:32,100
see what<font color="#E5E5E5"> actually queries for now once a</font>

366
00:13:30,660 --> 00:13:33,600
bond is connected to a rogue IC server

367
00:13:32,100 --> 00:13:35,459
it's<font color="#E5E5E5"> definitely not going to query that</font>

368
00:13:33,600 --> 00:13:38,579
name very often so unless<font color="#E5E5E5"> you're looking</font>

369
00:13:35,459 --> 00:13:40,859
you're not going to find it if<font color="#E5E5E5"> the name</font>

370
00:13:38,579 --> 00:13:42,449
gets closed if the DNS provider closes

371
00:13:40,860 --> 00:13:44,279
that name and there's some clues that

372
00:13:42,449 --> 00:13:46,500
will cue you into a<font color="#E5E5E5"> row game we'll talk</font>

373
00:13:44,279 --> 00:13:48,149
about in the next slide but a few key if

374
00:13:46,500 --> 00:13:49,500
that<font color="#CCCCCC"> name is</font><font color="#E5E5E5"> not greed very often but</font>

375
00:13:48,149 --> 00:13:50,990
you know a host is compromised either

376
00:13:49,500 --> 00:13:54,120
you've got an email from somebody or

377
00:13:50,990 --> 00:13:56,069
you've suspected a host having about

378
00:13:54,120 --> 00:13:58,139
some other reason you can bounce<font color="#E5E5E5"> that</font>

379
00:13:56,069 --> 00:13:59,430
link and then if you can put a tap on

380
00:13:58,139 --> 00:14:05,220
that host you can watch for<font color="#E5E5E5"> the DNS</font>

381
00:13:59,430 --> 00:14:07,109
query that it's going<font color="#E5E5E5"> to make any time</font>

382
00:14:05,220 --> 00:14:08,630
you see repetitive<font color="#CCCCCC"> eight queries and by</font>

383
00:14:07,110 --> 00:14:10,769
repetitive I mean a<font color="#CCCCCC"> lot of</font><font color="#E5E5E5"> bait queries</font>

384
00:14:08,630 --> 00:14:12,930
usually in the period of a few<font color="#E5E5E5"> minutes</font>

385
00:14:10,769 --> 00:14:15,029
like every few seconds or even many

386
00:14:12,930 --> 00:14:16,920
times a second that should probably

387
00:14:15,029 --> 00:14:18,870
<font color="#CCCCCC">trigger something in your brain because</font>

388
00:14:16,920 --> 00:14:21,180
there's<font color="#E5E5E5"> not too many hosts except for</font>

389
00:14:18,870 --> 00:14:22,680
automated software like bonds that are

390
00:14:21,180 --> 00:14:23,638
going to be querying for a name over and

391
00:14:22,680 --> 00:14:24,949
over and over and<font color="#E5E5E5"> over again</font>

392
00:14:23,639 --> 00:14:27,180
particularly<font color="#E5E5E5"> over a long period of time</font>

393
00:14:24,949 --> 00:14:29,008
what that's telling you is<font color="#CCCCCC"> that there's</font>

394
00:14:27,180 --> 00:14:31,589
a host out there that's infected it's

395
00:14:29,009 --> 00:14:33,839
set up to talk to a rogue IRC server

396
00:14:31,589 --> 00:14:35,370
it's looking<font color="#E5E5E5"> for a particular server</font>

397
00:14:33,839 --> 00:14:37,680
based on some name but that names been

398
00:14:35,370 --> 00:14:39,329
pulled<font color="#E5E5E5"> okay in the software Iran that</font>

399
00:14:37,680 --> 00:14:39,870
client hasn't been updated to look for a

400
00:14:39,329 --> 00:14:42,599
new<font color="#E5E5E5"> name</font>

401
00:14:39,870 --> 00:14:44,580
and so that<font color="#CCCCCC"> names</font><font color="#E5E5E5"> close the bots are</font>

402
00:14:42,600 --> 00:14:46,620
really not that smart they try to

403
00:14:44,580 --> 00:14:47,640
connect at every chance they get as long

404
00:14:46,620 --> 00:14:49,470
as they're<font color="#CCCCCC"> not connected they're going</font>

405
00:14:47,640 --> 00:14:50,610
to keep trying to connect so<font color="#E5E5E5"> going to</font>

406
00:14:49,470 --> 00:14:51,779
make queries over and over again and

407
00:14:50,610 --> 00:14:53,790
<font color="#E5E5E5">that's going to even fill up your query</font>

408
00:14:51,779 --> 00:14:55,950
logs we're<font color="#E5E5E5"> going to see</font><font color="#CCCCCC"> that DNS traffic</font>

409
00:14:53,790 --> 00:14:58,949
attempt going up to recursive DNS

410
00:14:55,950 --> 00:15:00,529
servers in all the cases I've seen all

411
00:14:58,950 --> 00:15:02,760
the<font color="#E5E5E5"> boxers querying their local</font>

412
00:15:00,529 --> 00:15:05,520
resolvers use about<font color="#CCCCCC"> their local cache or</font>

413
00:15:02,760 --> 00:15:10,170
<font color="#CCCCCC">their the local and configured</font><font color="#E5E5E5"> DNS</font>

414
00:15:05,520 --> 00:15:11,550
servers if you suspect<font color="#CCCCCC"> spambots in your</font>

415
00:15:10,170 --> 00:15:14,400
network<font color="#CCCCCC"> you can</font><font color="#E5E5E5"> certainly look for MX</font>

416
00:15:11,550 --> 00:15:17,189
queries obviously for<font color="#CCCCCC"> hosts that you</font>

417
00:15:14,400 --> 00:15:19,439
don't think are running mail servers any

418
00:15:17,190 --> 00:15:20,820
other server that<font color="#CCCCCC"> you don't expect to be</font>

419
00:15:19,440 --> 00:15:22,980
<font color="#E5E5E5">running as a server may</font><font color="#CCCCCC"> be making</font><font color="#E5E5E5"> a lot</font>

420
00:15:20,820 --> 00:15:24,540
<font color="#E5E5E5">of reverse clues which may indicate</font>

421
00:15:22,980 --> 00:15:26,820
you've got a controller on your network

422
00:15:24,540 --> 00:15:28,410
a lot of the IRC servers out there

423
00:15:26,820 --> 00:15:29,910
<font color="#CCCCCC">configure</font><font color="#E5E5E5"> to do kind of a weak form of</font>

424
00:15:28,410 --> 00:15:32,850
authentication by doing a verse<font color="#CCCCCC"> Cleary</font>

425
00:15:29,910 --> 00:15:34,319
on all the hosts that<font color="#CCCCCC"> attach down and</font>

426
00:15:32,850 --> 00:15:36,870
there seems to be some general patterns

427
00:15:34,320 --> 00:15:38,940
that<font color="#CCCCCC"> you can glean out of DNS names now</font>

428
00:15:36,870 --> 00:15:40,710
I couldn't<font color="#E5E5E5"> give</font><font color="#CCCCCC"> you a generic regular</font>

429
00:15:38,940 --> 00:15:43,290
expression that you<font color="#E5E5E5"> can send through</font>

430
00:15:40,710 --> 00:15:45,180
your DNS query lives and say this is for

431
00:15:43,290 --> 00:15:46,500
sure a bad dns name that's being used

432
00:15:45,180 --> 00:15:48,750
for controller but there's some patterns

433
00:15:46,500 --> 00:15:50,640
that<font color="#CCCCCC"> you do find you typically see three</font>

434
00:15:48,750 --> 00:15:52,589
levels you see a hostname sub domain and

435
00:15:50,640 --> 00:15:54,300
top-level dinner it's not always<font color="#E5E5E5"> the</font>

436
00:15:52,589 --> 00:15:55,529
case but probably at least ninety

437
00:15:54,300 --> 00:15:57,689
percent of the time that's how the names

438
00:15:55,529 --> 00:15:59,430
are formed then there's certain patterns

439
00:15:57,690 --> 00:16:00,870
within certain names or certain popular

440
00:15:59,430 --> 00:16:03,479
teal DS that tend to<font color="#E5E5E5"> be used more often</font>

441
00:16:00,870 --> 00:16:05,850
than not and at least for us from<font color="#CCCCCC"> Ed is</font>

442
00:16:03,480 --> 00:16:09,750
I've yet to see one for a road named at

443
00:16:05,850 --> 00:16:11,040
<font color="#E5E5E5">TD</font><font color="#CCCCCC"> u service so that's kind of a good</font>

444
00:16:09,750 --> 00:16:13,820
thing for<font color="#CCCCCC"> us</font><font color="#E5E5E5"> we'll finally something</font>

445
00:16:11,040 --> 00:16:13,819
can't be blind for

446
00:16:14,669 --> 00:16:19,299
some of you may also be<font color="#E5E5E5"> Dina said mins</font>

447
00:16:17,739 --> 00:16:22,479
in addition to just standard network

448
00:16:19,299 --> 00:16:23,799
operator operation people so if you run

449
00:16:22,479 --> 00:16:25,359
a dns service there's some things that

450
00:16:23,799 --> 00:16:28,389
you<font color="#E5E5E5"> should probably</font><font color="#CCCCCC"> do if you're not</font>

451
00:16:25,359 --> 00:16:30,850
already doing you<font color="#CCCCCC"> should log resource</font>

452
00:16:28,389 --> 00:16:33,399
record changes so anyone who's updating

453
00:16:30,850 --> 00:16:34,869
their records and not only<font color="#E5E5E5"> the records</font>

454
00:16:33,399 --> 00:16:36,339
that<font color="#E5E5E5"> they're making changes on but also</font>

455
00:16:34,869 --> 00:16:40,239
where they're coming from<font color="#E5E5E5"> and making</font>

456
00:16:36,339 --> 00:16:42,369
those changes the latter helps you once

457
00:16:40,239 --> 00:16:44,259
you identify that someone's updating

458
00:16:42,369 --> 00:16:46,149
names for rogue IRC control you can go

459
00:16:44,259 --> 00:16:49,720
back<font color="#E5E5E5"> and see</font><font color="#CCCCCC"> what other names might be</font>

460
00:16:46,149 --> 00:16:52,239
bad and logging the source of those

461
00:16:49,720 --> 00:16:53,949
changes will tell you or at<font color="#CCCCCC"> least give</font>

462
00:16:52,239 --> 00:16:55,539
you a<font color="#E5E5E5"> record of some information that</font>

463
00:16:53,949 --> 00:16:57,160
<font color="#CCCCCC">you can provide to</font><font color="#E5E5E5"> law enforcement or</font>

464
00:16:55,539 --> 00:17:00,779
anyone who's trying to track back the

465
00:16:57,160 --> 00:17:02,919
source of the operative of that botnet

466
00:17:00,779 --> 00:17:04,959
something that I don't<font color="#E5E5E5"> know that</font><font color="#CCCCCC"> much</font>

467
00:17:02,919 --> 00:17:06,429
about<font color="#CCCCCC"> dns admin services that are</font>

468
00:17:04,959 --> 00:17:09,069
provided out there other than what<font color="#CCCCCC"> I've</font>

469
00:17:06,429 --> 00:17:10,809
<font color="#E5E5E5">been told is that a number of them or a</font>

470
00:17:09,069 --> 00:17:12,699
<font color="#E5E5E5">number of you perhaps are not pulling</font>

471
00:17:10,809 --> 00:17:15,269
records that have been set up with

472
00:17:12,699 --> 00:17:18,220
invalid credit cards if you find<font color="#E5E5E5"> that</font>

473
00:17:15,269 --> 00:17:20,019
you've<font color="#CCCCCC"> been swindled with a credit card</font>

474
00:17:18,220 --> 00:17:21,939
go look through your records and pull

475
00:17:20,019 --> 00:17:23,709
any record that's associated with those

476
00:17:21,939 --> 00:17:25,059
invalid credit cards just kind of make

477
00:17:23,709 --> 00:17:26,980
<font color="#CCCCCC">sense to me I don't know what the issues</font>

478
00:17:25,059 --> 00:17:29,559
are there maybe<font color="#E5E5E5"> it's just too much</font><font color="#CCCCCC"> work</font>

479
00:17:26,980 --> 00:17:33,639
<font color="#CCCCCC">to do</font><font color="#E5E5E5"> certainly a lot of data DNS</font>

480
00:17:29,559 --> 00:17:35,289
providers have<font color="#E5E5E5"> do writing a free service</font>

481
00:17:33,639 --> 00:17:37,559
or a low-cost service maybe just<font color="#E5E5E5"> don't</font>

482
00:17:35,289 --> 00:17:39,549
have enough staff to handle some of us

483
00:17:37,559 --> 00:17:41,289
and one<font color="#E5E5E5"> of the best</font><font color="#CCCCCC"> things that you can</font>

484
00:17:39,549 --> 00:17:43,240
do if your<font color="#CCCCCC"> dns admin and you've</font>

485
00:17:41,289 --> 00:17:44,889
discovered a name that's been bad it's

486
00:17:43,240 --> 00:17:47,139
not just pull the record entirely but

487
00:17:44,889 --> 00:17:48,580
set the TTL fairly high<font color="#CCCCCC"> i would</font>

488
00:17:47,139 --> 00:17:50,799
<font color="#E5E5E5">recommend at least the minimum of seven</font>

489
00:17:48,580 --> 00:17:53,199
days and<font color="#CCCCCC"> maybe up to 30</font><font color="#E5E5E5"> days 60</font>

490
00:17:50,799 --> 00:17:54,820
something years is<font color="#CCCCCC"> probably too long but</font>

491
00:17:53,200 --> 00:17:56,830
at least 30 days<font color="#E5E5E5"> or seven days season</font>

492
00:17:54,820 --> 00:17:58,899
that the minimum would<font color="#E5E5E5"> be a nice setting</font>

493
00:17:56,830 --> 00:18:01,210
what that does is it kind of poisons

494
00:17:58,899 --> 00:18:03,279
that local<font color="#E5E5E5"> or recursive server where the</font>

495
00:18:01,210 --> 00:18:04,929
bots<font color="#CCCCCC"> may be so that when that record</font>

496
00:18:03,279 --> 00:18:07,360
gets updated they're still querying for

497
00:18:04,929 --> 00:18:09,460
<font color="#E5E5E5">a name that's been closed now which</font>

498
00:18:07,360 --> 00:18:12,039
address do you close will you<font color="#E5E5E5"> point the</font>

499
00:18:09,460 --> 00:18:14,529
the<font color="#CCCCCC"> record at a loopback address</font><font color="#E5E5E5"> you</font>

500
00:18:12,039 --> 00:18:16,480
pointed our RC 1918 a travesty pointed

501
00:18:14,529 --> 00:18:18,820
at something else there's still some

502
00:18:16,480 --> 00:18:20,799
debate about what the standard address

503
00:18:18,820 --> 00:18:21,939
should be when<font color="#CCCCCC"> closed name and it</font>

504
00:18:20,799 --> 00:18:23,080
probably<font color="#CCCCCC"> won't ever be an agreement</font>

505
00:18:21,940 --> 00:18:25,480
because it's going<font color="#E5E5E5"> to different for</font>

506
00:18:23,080 --> 00:18:28,689
Lupul<font color="#E5E5E5"> I'll just tell</font><font color="#CCCCCC"> you that if you use</font>

507
00:18:25,480 --> 00:18:30,519
<font color="#CCCCCC">an RFC 1918 address people who have BOTS</font>

508
00:18:28,690 --> 00:18:31,809
may end up actually trying<font color="#E5E5E5"> to contact</font>

509
00:18:30,519 --> 00:18:33,820
legitimate host they may actually be

510
00:18:31,809 --> 00:18:36,039
using that address space<font color="#E5E5E5"> within our</font>

511
00:18:33,820 --> 00:18:39,279
<font color="#E5E5E5">network so that address faces the triple</font>

512
00:18:36,039 --> 00:18:41,860
your problem if you<font color="#E5E5E5"> use another kind of</font>

513
00:18:39,279 --> 00:18:43,570
address space like<font color="#CCCCCC"> tests match or any</font>

514
00:18:41,860 --> 00:18:44,769
other reserves best you never any<font color="#E5E5E5"> other</font>

515
00:18:43,570 --> 00:18:47,168
<font color="#E5E5E5">reserved space you never know if that's</font>

516
00:18:44,769 --> 00:18:49,000
going to be in use or not I tend to

517
00:18:47,169 --> 00:18:50,470
think<font color="#E5E5E5"> to</font><font color="#CCCCCC"> 40s life for might be a good</font>

518
00:18:49,000 --> 00:18:52,049
one<font color="#E5E5E5"> because I don't I've never heard of</font>

519
00:18:50,470 --> 00:18:54,370
anyone actually using that address space

520
00:18:52,049 --> 00:18:56,710
although if<font color="#E5E5E5"> you're using it I'd be just</font>

521
00:18:54,370 --> 00:18:59,350
curious to know that you are<font color="#E5E5E5"> loopback</font>

522
00:18:56,710 --> 00:19:01,269
tends to be the<font color="#E5E5E5"> most popular address too</font>

523
00:18:59,350 --> 00:19:03,549
closely but there is<font color="#CCCCCC"> one</font><font color="#E5E5E5"> potential</font>

524
00:19:01,269 --> 00:19:05,169
problem with a loopback address if<font color="#E5E5E5"> you</font>

525
00:19:03,549 --> 00:19:07,059
point a record at a loopback address if

526
00:19:05,169 --> 00:19:09,490
you remember back when blaster female a

527
00:19:07,059 --> 00:19:11,529
bunch of<font color="#E5E5E5"> people</font><font color="#CCCCCC"> set the windows update</font>

528
00:19:09,490 --> 00:19:13,120
name to a loopback address and<font color="#E5E5E5"> then</font>

529
00:19:11,529 --> 00:19:14,409
realize when the<font color="#E5E5E5"> worm went to attack the</font>

530
00:19:13,120 --> 00:19:16,209
windows update address they saw these

531
00:19:14,409 --> 00:19:18,279
saw the strange traffic on the network

532
00:19:16,210 --> 00:19:20,590
they sell all these packets from a

533
00:19:18,279 --> 00:19:22,389
source address to all<font color="#E5E5E5"> these strange</font>

534
00:19:20,590 --> 00:19:24,789
destination addresses within their

535
00:19:22,389 --> 00:19:26,799
network of all these boots source

536
00:19:24,789 --> 00:19:29,889
addresses what happened his blaster

537
00:19:26,799 --> 00:19:31,840
actually source spoofed the attack to

538
00:19:29,889 --> 00:19:33,870
the<font color="#E5E5E5"> Windows Update address but the</font>

539
00:19:31,840 --> 00:19:36,158
windows update address was pointed at

540
00:19:33,870 --> 00:19:39,489
127 in a lot<font color="#E5E5E5"> of people's organizations</font>

541
00:19:36,159 --> 00:19:41,200
who kind of preempted Microsoft and so

542
00:19:39,490 --> 00:19:43,510
what they did was they the worm actually

543
00:19:41,200 --> 00:19:46,330
<font color="#E5E5E5">sent out a packet with source</font><font color="#CCCCCC"> boost</font>

544
00:19:43,510 --> 00:19:47,559
address attacking themselves which they

545
00:19:46,330 --> 00:19:49,990
probably were not running<font color="#CCCCCC"> a web server</font>

546
00:19:47,559 --> 00:19:52,389
but yet still would respond to that big

547
00:19:49,990 --> 00:19:53,679
smooth source address and so then that

548
00:19:52,389 --> 00:19:58,168
<font color="#CCCCCC">pack</font><font color="#E5E5E5"> would actually bounce off their</font>

549
00:19:53,679 --> 00:20:00,460
<font color="#CCCCCC">hosts and head out to nowhere see it's</font>

550
00:19:58,169 --> 00:20:02,559
questionable which address you set it to

551
00:20:00,460 --> 00:20:03,940
close with use what's best for you<font color="#E5E5E5"> I</font>

552
00:20:02,559 --> 00:20:05,710
suppose but<font color="#E5E5E5"> if we could come to our</font>

553
00:20:03,940 --> 00:20:06,880
standard I suppose that<font color="#E5E5E5"> might be nice so</font>

554
00:20:05,710 --> 00:20:09,549
at least we know that it's been closed

555
00:20:06,880 --> 00:20:12,010
and if your<font color="#E5E5E5"> DNS admin if you've got a</font>

556
00:20:09,549 --> 00:20:13,720
name that's closed it's probably<font color="#CCCCCC"> a good</font>

557
00:20:12,010 --> 00:20:15,429
idea to share it<font color="#CCCCCC"> with other DNS admins</font>

558
00:20:13,720 --> 00:20:17,320
through a DNS black hole list at the

559
00:20:15,429 --> 00:20:19,510
link i thrive here and the<font color="#E5E5E5"> reason is</font>

560
00:20:17,320 --> 00:20:21,460
that if they the miscreant owns a

561
00:20:19,510 --> 00:20:23,769
particular<font color="#CCCCCC"> domain they can easily move</font>

562
00:20:21,460 --> 00:20:26,139
it to somebody else<font color="#CCCCCC"> so you want to let</font>

563
00:20:23,769 --> 00:20:28,210
others know that hey this domain is bad

564
00:20:26,139 --> 00:20:30,299
you don't let people<font color="#CCCCCC"> set up names any of</font>

565
00:20:28,210 --> 00:20:30,299
this

566
00:20:31,310 --> 00:20:35,520
finally<font color="#CCCCCC"> is</font><font color="#E5E5E5"> kind of the last resort this</font>

567
00:20:34,080 --> 00:20:37,770
is a<font color="#E5E5E5"> little bit of a pain is set up but</font>

568
00:20:35,520 --> 00:20:40,860
you can do a black hole or<font color="#E5E5E5"> sinkhole and</font>

569
00:20:37,770 --> 00:20:42,810
here again example upon with bind you

570
00:20:40,860 --> 00:20:44,490
can set up<font color="#E5E5E5"> any number of zone records</font>

571
00:20:42,810 --> 00:20:47,340
based on a<font color="#E5E5E5"> host name that you suspect as</font>

572
00:20:44,490 --> 00:20:48,600
bad and so in your name<font color="#E5E5E5"> decom file you</font>

573
00:20:47,340 --> 00:20:51,330
could set up all these zones it could be

574
00:20:48,600 --> 00:20:52,980
Road example mad or<font color="#CCCCCC"> pack sword example</font>

575
00:20:51,330 --> 00:20:54,600
about<font color="#E5E5E5"> net or whatever the name is and</font>

576
00:20:52,980 --> 00:20:57,020
you can point them all to this DV bad

577
00:20:54,600 --> 00:21:00,389
name and then this<font color="#E5E5E5"> DB bad name is just a</font>

578
00:20:57,020 --> 00:21:01,650
generic zone file the most important

579
00:21:00,390 --> 00:21:03,330
thing probably being at the bottom here

580
00:21:01,650 --> 00:21:06,600
the a record that it actually points to

581
00:21:03,330 --> 00:21:07,919
and all this does is says anytime any

582
00:21:06,600 --> 00:21:08,879
anyone's going to query<font color="#CCCCCC"> for that name</font>

583
00:21:07,920 --> 00:21:11,430
they're just going<font color="#E5E5E5"> to get back that</font>

584
00:21:08,880 --> 00:21:15,420
address so you can black hole or sink

585
00:21:11,430 --> 00:21:17,450
hole down more<font color="#CCCCCC"> caller you want to do of</font>

586
00:21:15,420 --> 00:21:19,200
course some<font color="#E5E5E5"> of the buying purists may be</font>

587
00:21:17,450 --> 00:21:21,780
freaking out<font color="#E5E5E5"> and that may not be the</font>

588
00:21:19,200 --> 00:21:23,010
best thing<font color="#CCCCCC"> to do if you really care</font>

589
00:21:21,780 --> 00:21:24,270
about<font color="#E5E5E5"> the consistency of the database</font>

590
00:21:23,010 --> 00:21:27,720
but certainly as a last resort that

591
00:21:24,270 --> 00:21:29,910
might be an option now there's a<font color="#E5E5E5"> problem</font>

592
00:21:27,720 --> 00:21:32,070
dns is really handy thing to know and if

593
00:21:29,910 --> 00:21:34,620
you know dns and<font color="#E5E5E5"> you can close dns for a</font>

594
00:21:32,070 --> 00:21:36,179
botnet that<font color="#E5E5E5"> really helps a lot but</font>

595
00:21:34,620 --> 00:21:37,860
there's a<font color="#E5E5E5"> problem because there's</font>

596
00:21:36,180 --> 00:21:39,990
multiple pieces to the command<font color="#E5E5E5"> control</font>

597
00:21:37,860 --> 00:21:41,610
infrastructure there's dns but there's

598
00:21:39,990 --> 00:21:44,010
also an IP address or multiple IP

599
00:21:41,610 --> 00:21:46,020
addresses there may even be multiple DNS

600
00:21:44,010 --> 00:21:47,940
names if you close one<font color="#CCCCCC"> and not the other</font>

601
00:21:46,020 --> 00:21:49,950
the button that may still live without

602
00:21:47,940 --> 00:21:51,990
even losing a single bond<font color="#E5E5E5"> maybe with</font>

603
00:21:49,950 --> 00:21:54,450
even minimal downtime there's actually

604
00:21:51,990 --> 00:21:56,040
some redundancies built right in if you

605
00:21:54,450 --> 00:21:57,210
close the name but the controller host

606
00:21:56,040 --> 00:21:58,950
is still up and<font color="#E5E5E5"> all the bots are</font>

607
00:21:57,210 --> 00:22:01,050
connected all the<font color="#E5E5E5"> miss Green has to do</font>

608
00:21:58,950 --> 00:22:03,090
is tell the bots to update their code<font color="#E5E5E5"> to</font>

609
00:22:01,050 --> 00:22:04,230
<font color="#E5E5E5">point to a new dns name so the next time</font>

610
00:22:03,090 --> 00:22:06,240
they get disconnected they're going to

611
00:22:04,230 --> 00:22:08,670
query for<font color="#E5E5E5"> the new name and vice versus</font>

612
00:22:06,240 --> 00:22:10,080
reverse is also true if the controller

613
00:22:08,670 --> 00:22:13,080
goes away<font color="#CCCCCC"> but the name is still there</font>

614
00:22:10,080 --> 00:22:14,580
<font color="#E5E5E5">and the TTL is really small it's going</font>

615
00:22:13,080 --> 00:22:16,530
<font color="#E5E5E5">to only take probably</font><font color="#CCCCCC"> a few seconds or a</font>

616
00:22:14,580 --> 00:22:18,960
few<font color="#E5E5E5"> minutes to query</font><font color="#CCCCCC"> for the the new</font>

617
00:22:16,530 --> 00:22:20,040
<font color="#CCCCCC">address associated</font><font color="#E5E5E5"> that name I don't</font>

618
00:22:18,960 --> 00:22:21,960
know exactly how<font color="#E5E5E5"> to fix this problem</font>

619
00:22:20,040 --> 00:22:24,270
because<font color="#E5E5E5"> usually the address and the name</font>

620
00:22:21,960 --> 00:22:25,380
are not managed by the same entity so

621
00:22:24,270 --> 00:22:26,760
it's kind of a<font color="#CCCCCC"> difficult problem to</font>

622
00:22:25,380 --> 00:22:31,080
figure out how to actually do both at

623
00:22:26,760 --> 00:22:33,740
the same<font color="#E5E5E5"> time now some ideas that</font><font color="#CCCCCC"> have</font>

624
00:22:31,080 --> 00:22:36,159
been bandied about a little<font color="#E5E5E5"> bit with dns</font>

625
00:22:33,740 --> 00:22:39,770
software hack side column

626
00:22:36,160 --> 00:22:41,990
one not so much specific to botnets

627
00:22:39,770 --> 00:22:44,179
themselves but what you see when a name

628
00:22:41,990 --> 00:22:46,400
gets<font color="#CCCCCC"> close if a bottle that still has</font>

629
00:22:44,179 --> 00:22:47,750
<font color="#CCCCCC">for the bots in Nevada it still has the</font>

630
00:22:46,400 --> 00:22:49,370
same malware and they're still querying

631
00:22:47,750 --> 00:22:50,720
for a name that's been closed you see

632
00:22:49,370 --> 00:22:52,459
<font color="#E5E5E5">those repetitive queries happening over</font>

633
00:22:50,720 --> 00:22:54,410
and over again and<font color="#CCCCCC"> because it's a</font>

634
00:22:52,460 --> 00:22:55,700
recursive query at least<font color="#CCCCCC"> that bind with</font>

635
00:22:54,410 --> 00:22:58,040
i'm familiar with has to create

636
00:22:55,700 --> 00:22:59,690
essentially stateful each query as it

637
00:22:58,040 --> 00:23:01,820
goes and<font color="#E5E5E5"> tries to fetch out the full</font>

638
00:22:59,690 --> 00:23:04,460
record and there's usually a limit in

639
00:23:01,820 --> 00:23:06,559
some period or some interval of queries

640
00:23:04,460 --> 00:23:08,690
that clients can make if things<font color="#CCCCCC"> are</font>

641
00:23:06,559 --> 00:23:10,610
<font color="#CCCCCC">querying recursively fast enough you</font><font color="#E5E5E5"> can</font>

642
00:23:08,690 --> 00:23:11,990
reach<font color="#CCCCCC"> that limit and then it shuts down</font>

643
00:23:10,610 --> 00:23:14,178
every<font color="#CCCCCC"> other host</font><font color="#E5E5E5"> from making recursive</font>

644
00:23:11,990 --> 00:23:15,770
queries<font color="#E5E5E5"> so when not that might be useful</font>

645
00:23:14,179 --> 00:23:17,660
is to have a rate limiter for recursive

646
00:23:15,770 --> 00:23:18,799
queries or what<font color="#E5E5E5"> I would</font><font color="#CCCCCC"> prefer actually</font>

647
00:23:17,660 --> 00:23:21,049
use a look some kind<font color="#E5E5E5"> of like you</font>

648
00:23:18,799 --> 00:23:22,639
mechanism you can<font color="#E5E5E5"> possibly do</font><font color="#CCCCCC"> this in</font>

649
00:23:21,049 --> 00:23:24,139
your OS and your stack or your upstream

650
00:23:22,640 --> 00:23:26,510
router you may<font color="#E5E5E5"> not be able to do it</font>

651
00:23:24,140 --> 00:23:29,320
specifically recursive queries but<font color="#E5E5E5"> I</font>

652
00:23:26,510 --> 00:23:31,700
know<font color="#E5E5E5"> people who tried to do that as well</font>

653
00:23:29,320 --> 00:23:33,980
the other thing that could<font color="#CCCCCC"> be useful a</font>

654
00:23:31,700 --> 00:23:36,530
feature request and some dns off forest

655
00:23:33,980 --> 00:23:39,049
is to have a regular<font color="#CCCCCC"> expression support</font>

656
00:23:36,530 --> 00:23:41,299
so that you can<font color="#E5E5E5"> more easily sink hole or</font>

657
00:23:39,049 --> 00:23:42,889
black hole names so rather<font color="#E5E5E5"> than having</font>

658
00:23:41,299 --> 00:23:45,049
<font color="#CCCCCC">to do that kind of black hole sinkholes</font>

659
00:23:42,890 --> 00:23:46,309
own hat that we had<font color="#E5E5E5"> before having</font>

660
00:23:45,049 --> 00:23:47,480
something you can do possibly without

661
00:23:46,309 --> 00:23:49,970
even having<font color="#E5E5E5"> ever you start your name</font>

662
00:23:47,480 --> 00:23:53,510
server is to be<font color="#E5E5E5"> to say anything from you</font>

663
00:23:49,970 --> 00:23:55,760
know packs or net gets black<font color="#E5E5E5"> /</font><font color="#CCCCCC"> singh</font>

664
00:23:53,510 --> 00:23:57,710
cold again that may be kind of mucking

665
00:23:55,760 --> 00:23:59,120
with the you know<font color="#E5E5E5"> that unique</font><font color="#CCCCCC"> dns</font>

666
00:23:57,710 --> 00:24:00,470
database that may not<font color="#E5E5E5"> be such a good</font>

667
00:23:59,120 --> 00:24:03,500
thing<font color="#E5E5E5"> but it might</font><font color="#CCCCCC"> be an option some</font>

668
00:24:00,470 --> 00:24:05,059
people are looking<font color="#CCCCCC"> for and I puts snuck</font>

669
00:24:03,500 --> 00:24:06,400
in a bullet point here that's probably

670
00:24:05,059 --> 00:24:09,100
not<font color="#E5E5E5"> in the slides that you have online</font>

671
00:24:06,400 --> 00:24:11,360
another thing that stops people from

672
00:24:09,100 --> 00:24:12,439
even looking at<font color="#E5E5E5"> dns is they don't like</font>

673
00:24:11,360 --> 00:24:14,240
the queries because the performance

674
00:24:12,440 --> 00:24:16,460
impact so something that we're all

675
00:24:14,240 --> 00:24:18,590
familiar with<font color="#E5E5E5"> the net flow is having a</font>

676
00:24:16,460 --> 00:24:21,290
sampling mechanism so while you may<font color="#CCCCCC"> not</font>

677
00:24:18,590 --> 00:24:22,580
be able<font color="#E5E5E5"> to get a record of every single</font>

678
00:24:21,290 --> 00:24:24,620
packet that goes through your box the

679
00:24:22,580 --> 00:24:28,129
same thing<font color="#CCCCCC"> for dns we may not need every</font>

680
00:24:24,620 --> 00:24:29,418
single log record for a query in our<font color="#E5E5E5"> dns</font>

681
00:24:28,130 --> 00:24:31,010
server but if we had a sample that might

682
00:24:29,419 --> 00:24:33,140
be at least useful reduce the

683
00:24:31,010 --> 00:24:35,890
performance impact and reduce the<font color="#CCCCCC"> disk</font>

684
00:24:33,140 --> 00:24:35,890
space requirements

685
00:24:36,870 --> 00:24:40,350
now the network mitigation techniques

686
00:24:38,730 --> 00:24:42,600
are actually a little bit harder to come

687
00:24:40,350 --> 00:24:44,280
up with concretely because unless you've

688
00:24:42,600 --> 00:24:46,320
got<font color="#CCCCCC"> eyes into your network where you can</font>

689
00:24:44,280 --> 00:24:49,139
do packet inspection that is you can

690
00:24:46,320 --> 00:24:50,700
analyze the contents of packets figuring

691
00:24:49,140 --> 00:24:52,740
out<font color="#E5E5E5"> what about is and what</font><font color="#CCCCCC"> about next</font>

692
00:24:50,700 --> 00:24:55,790
controller looks like is relatively

693
00:24:52,740 --> 00:24:58,110
difficult but some general like

694
00:24:55,790 --> 00:25:00,149
recommendations you've all heard or

695
00:24:58,110 --> 00:25:02,790
mostly heard before is the you know

696
00:25:00,150 --> 00:25:05,190
maintaining<font color="#E5E5E5"> flows setting up bug on and</font>

697
00:25:02,790 --> 00:25:06,570
dark space monitoring the one that you

698
00:25:05,190 --> 00:25:09,330
don't<font color="#CCCCCC"> hear talk about too much but</font>

699
00:25:06,570 --> 00:25:11,520
what's even more useful is having a

700
00:25:09,330 --> 00:25:14,490
distributed<font color="#CCCCCC"> micro-blog sinkhole or a</font>

701
00:25:11,520 --> 00:25:17,790
black hole so here the idea is rather

702
00:25:14,490 --> 00:25:20,760
than taking unused address space take a

703
00:25:17,790 --> 00:25:22,860
small / 29 or even a / 32 out of your

704
00:25:20,760 --> 00:25:24,990
heavily used address space and point

705
00:25:22,860 --> 00:25:27,510
that at a sinkhole<font color="#E5E5E5"> or black hole and if</font>

706
00:25:24,990 --> 00:25:29,670
the worms and the botnets are typically

707
00:25:27,510 --> 00:25:31,410
often worm based looking to do some

708
00:25:29,670 --> 00:25:33,210
remote exploits if they're scanning

709
00:25:31,410 --> 00:25:36,780
based on locality<font color="#CCCCCC"> that is within a</font>

710
00:25:33,210 --> 00:25:38,429
subnet chances are better that you'll

711
00:25:36,780 --> 00:25:40,350
<font color="#CCCCCC">find them if you</font><font color="#E5E5E5"> can take one of those</font>

712
00:25:38,429 --> 00:25:45,990
microbial allocations and point them at

713
00:25:40,350 --> 00:25:47,428
a<font color="#CCCCCC"> sinkhole ok against the more stuff</font>

714
00:25:45,990 --> 00:25:49,110
that you've all heard before at least I

715
00:25:47,429 --> 00:25:53,850
hope you have<font color="#E5E5E5"> the ingress and egress</font>

716
00:25:49,110 --> 00:25:55,500
filters you should have both<font color="#CCCCCC"> a common</font>

717
00:25:53,850 --> 00:25:58,980
ask the question is whether<font color="#E5E5E5"> you should</font>

718
00:25:55,500 --> 00:26:01,020
filter on port 0 UDP<font color="#CCCCCC"> or</font><font color="#E5E5E5"> TCP we have the</font>

719
00:25:58,980 --> 00:26:03,030
quick answer that is no and<font color="#E5E5E5"> the reason</font>

720
00:26:01,020 --> 00:26:05,879
<font color="#E5E5E5">for that is because you end up having</font>

721
00:26:03,030 --> 00:26:07,139
fragments that will look<font color="#E5E5E5"> like port 0 so</font>

722
00:26:05,880 --> 00:26:08,760
<font color="#E5E5E5">you probably</font><font color="#CCCCCC"> don't want</font><font color="#E5E5E5"> to filter them</font>

723
00:26:07,140 --> 00:26:10,890
as much as<font color="#CCCCCC"> we don't typically like to</font>

724
00:26:08,760 --> 00:26:12,390
see fragments on the network you will

725
00:26:10,890 --> 00:26:14,760
<font color="#E5E5E5">block legitimate traffic if you blocked</font>

726
00:26:12,390 --> 00:26:17,340
ports hero certainly in a dire situation

727
00:26:14,760 --> 00:26:19,590
you may need to do that but<font color="#E5E5E5"> be careful</font>

728
00:26:17,340 --> 00:26:22,439
if you block port<font color="#CCCCCC"> do in fact UDP</font>

729
00:26:19,590 --> 00:26:24,990
actually is completely valid and sending

730
00:26:22,440 --> 00:26:28,800
a UDP source port 0 a lot of media

731
00:26:24,990 --> 00:26:30,270
streams will do that on the nanog<font color="#E5E5E5"> list</font>

732
00:26:28,800 --> 00:26:33,330
<font color="#E5E5E5">and other places people have talked</font>

733
00:26:30,270 --> 00:26:36,389
<font color="#E5E5E5">about and implemented filtering for BOTS</font>

734
00:26:33,330 --> 00:26:40,139
or the controllers and that's<font color="#E5E5E5"> something</font>

735
00:26:36,390 --> 00:26:41,610
that has some<font color="#CCCCCC"> affect some positive</font>

736
00:26:40,140 --> 00:26:45,679
effect but also has some collateral

737
00:26:41,610 --> 00:26:49,169
damage keep in mind<font color="#CCCCCC"> that BOTS and button</font>

738
00:26:45,679 --> 00:26:51,120
controllers may be more<font color="#CCCCCC"> than just a</font>

739
00:26:49,170 --> 00:26:53,370
windows pc<font color="#E5E5E5"> and someone's home maybe a</font>

740
00:26:51,120 --> 00:26:55,229
virtual server maybe something that's

741
00:26:53,370 --> 00:26:57,030
kind of important to someone what's

742
00:26:55,230 --> 00:26:58,440
actually in production use now you may

743
00:26:57,030 --> 00:27:01,440
say too bad<font color="#CCCCCC"> and that's finding a lot of</font>

744
00:26:58,440 --> 00:27:03,030
people<font color="#E5E5E5"> will do that but you know</font>

745
00:27:01,440 --> 00:27:05,490
certainly your mileage may vary and

746
00:27:03,030 --> 00:27:07,830
again bots and botnet controllers kind

747
00:27:05,490 --> 00:27:10,470
of go so that list has to be maintained

748
00:27:07,830 --> 00:27:11,790
<font color="#E5E5E5">and kept up to date and something kind</font>

749
00:27:10,470 --> 00:27:14,070
of<font color="#E5E5E5"> a pet peeve of mine is what are you</font>

750
00:27:11,790 --> 00:27:17,010
sending to multicast address space this

751
00:27:14,070 --> 00:27:19,470
<font color="#E5E5E5">is just kind of a general kind of</font>

752
00:27:17,010 --> 00:27:21,210
removing the bad stuff obvious bad stuff

753
00:27:19,470 --> 00:27:23,250
out of your network<font color="#E5E5E5"> that you can do you</font>

754
00:27:21,210 --> 00:27:25,890
<font color="#E5E5E5">support multicast there's certainly no</font>

755
00:27:23,250 --> 00:27:28,080
reason to see TCP packets going to the

756
00:27:25,890 --> 00:27:29,730
multicast address space so a really<font color="#E5E5E5"> easy</font>

757
00:27:28,080 --> 00:27:31,889
thing to do if your hard work and handle

758
00:27:29,730 --> 00:27:34,380
<font color="#E5E5E5">it is filter out any TCP packets 22 24 /</font>

759
00:27:31,890 --> 00:27:36,030
for effect you can<font color="#E5E5E5"> actually do the</font>

760
00:27:34,380 --> 00:27:37,680
reverse probably a little bit<font color="#E5E5E5"> easier you</font>

761
00:27:36,030 --> 00:27:40,139
could say I only want to allow certain

762
00:27:37,680 --> 00:27:42,120
things to teach you 4 / 4 and we could

763
00:27:40,140 --> 00:27:43,800
talk<font color="#CCCCCC"> about</font><font color="#E5E5E5"> that at NSB set bond for</font>

764
00:27:42,120 --> 00:27:45,149
later offline if you'd like but<font color="#E5E5E5"> there's</font>

765
00:27:43,800 --> 00:27:46,470
a lot of stuff that<font color="#CCCCCC"> you can pull out of</font>

766
00:27:45,150 --> 00:27:48,620
<font color="#CCCCCC">that address space that shouldn't be</font>

767
00:27:46,470 --> 00:27:48,620
there

768
00:27:52,480 --> 00:27:56,590
if you're not doing flows you should be

769
00:27:54,549 --> 00:27:58,870
that's essentially the the<font color="#E5E5E5"> idea behind</font>

770
00:27:56,590 --> 00:28:00,909
this slide just<font color="#CCCCCC"> to point out if you're</font>

771
00:27:58,870 --> 00:28:02,409
using flow tools or if you're<font color="#E5E5E5"> not using</font>

772
00:28:00,910 --> 00:28:04,570
flow tools and want<font color="#E5E5E5"> to I would just</font>

773
00:28:02,410 --> 00:28:07,179
point you to Ed's post from a year or

774
00:28:04,570 --> 00:28:09,189
two ago go look for<font color="#E5E5E5"> this the title of</font>

775
00:28:07,179 --> 00:28:11,110
this his message<font color="#CCCCCC"> was checking for das</font>

776
00:28:09,190 --> 00:28:13,150
reports game traffic<font color="#E5E5E5"> he's had a real</font>

777
00:28:11,110 --> 00:28:14,889
simple<font color="#E5E5E5"> one-liner basically using flow</font>

778
00:28:13,150 --> 00:28:16,690
tools like me to<font color="#E5E5E5"> och and it actually</font>

779
00:28:14,890 --> 00:28:19,740
works pretty well in detecting scanners

780
00:28:16,690 --> 00:28:21,970
and Donald service tax on your flows a

781
00:28:19,740 --> 00:28:23,290
new tool that's coming available<font color="#CCCCCC"> and i</font>

782
00:28:21,970 --> 00:28:25,690
<font color="#E5E5E5">highly recommend people check it out</font>

783
00:28:23,290 --> 00:28:28,510
it's called NF<font color="#E5E5E5"> dump it's actually part</font>

784
00:28:25,690 --> 00:28:30,790
of a larger package but the idea is

785
00:28:28,510 --> 00:28:33,400
similar to flow tools<font color="#CCCCCC"> it's collector</font>

786
00:28:30,790 --> 00:28:34,870
it's got some reporting tools and so

787
00:28:33,400 --> 00:28:37,870
forth what the real nice thing about

788
00:28:34,870 --> 00:28:39,219
this is it's based on TCP dump syntax so

789
00:28:37,870 --> 00:28:40,928
if you're familiar with flow tools one

790
00:28:39,220 --> 00:28:43,150
of the<font color="#CCCCCC"> panes has always been you've got</font>

791
00:28:40,929 --> 00:28:45,309
to create<font color="#E5E5E5"> an flow filter file you're</font>

792
00:28:43,150 --> 00:28:46,419
going to kind of set that up manually or

793
00:28:45,309 --> 00:28:48,520
it's a little bit pain to set up the

794
00:28:46,419 --> 00:28:50,559
script but<font color="#E5E5E5"> with NF dumping if you can do</font>

795
00:28:48,520 --> 00:28:52,210
it like TCP dump syntax you can really

796
00:28:50,559 --> 00:28:53,770
make your scripts a little bit simpler

797
00:28:52,210 --> 00:28:56,049
or interface that on a web page a little

798
00:28:53,770 --> 00:28:58,330
<font color="#CCCCCC">bit easier so it's still relatively new</font>

799
00:28:56,049 --> 00:29:00,040
<font color="#E5E5E5">it doesn't have the full feature set but</font>

800
00:28:58,330 --> 00:29:01,689
because it's being actively developed so

801
00:29:00,040 --> 00:29:04,918
you can go check that out and get all

802
00:29:01,690 --> 00:29:04,919
your features that you want in<font color="#E5E5E5"> there</font>

803
00:29:06,150 --> 00:29:11,260
that's some general things that may lead

804
00:29:09,250 --> 00:29:13,390
you to believe that<font color="#E5E5E5"> there's botnets or</font>

805
00:29:11,260 --> 00:29:16,299
controllers active somewhere<font color="#CCCCCC"> on your</font>

806
00:29:13,390 --> 00:29:18,100
<font color="#E5E5E5">network or suspicious traffic that you</font>

807
00:29:16,299 --> 00:29:19,030
may want<font color="#E5E5E5"> to take a closer look at and</font>

808
00:29:18,100 --> 00:29:20,980
there's a number<font color="#E5E5E5"> of</font><font color="#CCCCCC"> things that you</font><font color="#E5E5E5"> can</font>

809
00:29:19,030 --> 00:29:22,840
<font color="#E5E5E5">come up with kind of figuring out how to</font>

810
00:29:20,980 --> 00:29:24,190
create<font color="#CCCCCC"> your algorithms and pull this</font>

811
00:29:22,840 --> 00:29:26,110
stuff out and make any sense<font color="#E5E5E5"> it was a</font>

812
00:29:24,190 --> 00:29:28,570
little bit tricky but just to give<font color="#CCCCCC"> you</font>

813
00:29:26,110 --> 00:29:30,340
some<font color="#E5E5E5"> general ideas if you do just flow</font>

814
00:29:28,570 --> 00:29:31,600
monitoring at your borders and some of

815
00:29:30,340 --> 00:29:33,309
the large networks<font color="#CCCCCC"> you probably</font><font color="#E5E5E5"> don't do</font>

816
00:29:31,600 --> 00:29:34,389
that they have them that have them

817
00:29:33,309 --> 00:29:36,490
everywhere but for some of the smaller

818
00:29:34,390 --> 00:29:37,870
networks that have lots of subnets you

819
00:29:36,490 --> 00:29:39,340
really kind<font color="#CCCCCC"> of want to try</font><font color="#E5E5E5"> to do flow</font>

820
00:29:37,870 --> 00:29:42,459
monitoring that your edges as much as

821
00:29:39,340 --> 00:29:44,049
possible because again worms and bots

822
00:29:42,460 --> 00:29:46,210
that are parts of these networks look

823
00:29:44,049 --> 00:29:47,650
like worms and they're scanning is kind

824
00:29:46,210 --> 00:29:49,510
of locality base words within their

825
00:29:47,650 --> 00:29:50,950
subnet so if you're only monitoring

826
00:29:49,510 --> 00:29:53,679
closing a border you may miss a lot of

827
00:29:50,950 --> 00:29:55,179
<font color="#E5E5E5">that tivity</font><font color="#CCCCCC"> and so if you</font><font color="#E5E5E5"> can see these</font>

828
00:29:53,679 --> 00:29:55,680
scans and you can associate them with a

829
00:29:55,179 --> 00:29:58,380
<font color="#E5E5E5">TCP</font>

830
00:29:55,680 --> 00:29:59,820
action possibly to some control you may

831
00:29:58,380 --> 00:30:02,850
be spotted bot or the<font color="#E5E5E5"> world controller</font>

832
00:29:59,820 --> 00:30:06,389
itself of<font color="#E5E5E5"> course anything</font><font color="#CCCCCC"> too dark space</font>

833
00:30:02,850 --> 00:30:07,409
or short flows or lots of flows from a

834
00:30:06,390 --> 00:30:11,220
single source to multiple destinations

835
00:30:07,410 --> 00:30:12,810
if you see a lot of flows syn packets

836
00:30:11,220 --> 00:30:15,330
going out with resets or unreachable is

837
00:30:12,810 --> 00:30:18,179
coming back so<font color="#CCCCCC"> that could be scanning</font>

838
00:30:15,330 --> 00:30:21,750
coming in you can also do analysis based

839
00:30:18,180 --> 00:30:23,340
on packet sizes IRC traffic is typically

840
00:30:21,750 --> 00:30:25,920
<font color="#E5E5E5">not going to be a bunch of</font><font color="#CCCCCC"> 1,500 I</font>

841
00:30:23,340 --> 00:30:29,340
packets it's very<font color="#E5E5E5"> interactive it's very</font>

842
00:30:25,920 --> 00:30:31,470
conversational so if you see traffic

843
00:30:29,340 --> 00:30:34,230
that kind<font color="#E5E5E5"> of follows that pattern you</font>

844
00:30:31,470 --> 00:30:36,900
<font color="#E5E5E5">can put</font><font color="#CCCCCC"> that into</font><font color="#E5E5E5"> your suspect list as</font>

845
00:30:34,230 --> 00:30:39,660
well a lot of bots infect each other

846
00:30:36,900 --> 00:30:43,440
remotely and perhaps the exploit code

847
00:30:39,660 --> 00:30:45,840
usually over ftp on a standard or a odd

848
00:30:43,440 --> 00:30:48,300
number port or via tftp so if you see

849
00:30:45,840 --> 00:30:49,800
tftp in particular you network and you

850
00:30:48,300 --> 00:30:51,780
see a lot of it particularly from one or

851
00:30:49,800 --> 00:30:56,460
two hosts so that would<font color="#CCCCCC"> be a suspect</font>

852
00:30:51,780 --> 00:30:57,899
post that might have a water here's<font color="#E5E5E5"> some</font>

853
00:30:56,460 --> 00:30:59,460
<font color="#CCCCCC">network hacks I don't know that these</font>

854
00:30:57,900 --> 00:31:02,310
should be implemented<font color="#CCCCCC"> or even discussed</font>

855
00:30:59,460 --> 00:31:04,350
further here but the<font color="#E5E5E5"> first</font><font color="#CCCCCC"> one is kind</font>

856
00:31:02,310 --> 00:31:07,070
of interesting and XP has kind of

857
00:31:04,350 --> 00:31:10,740
doneness with service pack 2 by<font color="#E5E5E5"> the way</font>

858
00:31:07,070 --> 00:31:13,620
if there was we have a cut rate<font color="#E5E5E5"> limiter</font>

859
00:31:10,740 --> 00:31:16,050
so you've got and read queues and all

860
00:31:13,620 --> 00:31:18,120
kinds of dropping out rhythms but that's

861
00:31:16,050 --> 00:31:20,909
all based on packets if we had something

862
00:31:18,120 --> 00:31:24,360
<font color="#E5E5E5">similar based on flows that would be a</font>

863
00:31:20,910 --> 00:31:25,710
good system to alarm at least based on

864
00:31:24,360 --> 00:31:27,479
somebody's trying to talk<font color="#CCCCCC"> to a</font><font color="#E5E5E5"> lot of</font>

865
00:31:25,710 --> 00:31:29,700
hosts within a short interval that's

866
00:31:27,480 --> 00:31:32,160
<font color="#E5E5E5">usually indicative of file sharing for</font>

867
00:31:29,700 --> 00:31:35,250
once in our universities but<font color="#E5E5E5"> also for</font>

868
00:31:32,160 --> 00:31:36,450
scanning attempts sometimes for denial

869
00:31:35,250 --> 00:31:39,870
of service attacks<font color="#E5E5E5"> too if you're</font>

870
00:31:36,450 --> 00:31:44,220
considering the source of all people

871
00:31:39,870 --> 00:31:46,739
talking about<font color="#E5E5E5"> using internet pricing</font>

872
00:31:44,220 --> 00:31:48,030
schemes again that was a big research

873
00:31:46,740 --> 00:31:49,470
<font color="#E5E5E5">topic awhile back that</font><font color="#CCCCCC"> seemed</font><font color="#E5E5E5"> to have</font>

874
00:31:48,030 --> 00:31:51,270
died but maybe that's coming back<font color="#E5E5E5"> and</font>

875
00:31:49,470 --> 00:31:52,680
<font color="#E5E5E5">people have to learn a bunch of lessons</font>

876
00:31:51,270 --> 00:31:54,660
there I don't know how that's actually

877
00:31:52,680 --> 00:31:56,820
I'm going<font color="#E5E5E5"> to pan out I suspect it</font>

878
00:31:54,660 --> 00:31:57,620
probably won't work for the majority<font color="#CCCCCC"> of</font>

879
00:31:56,820 --> 00:31:59,330
networks

880
00:31:57,620 --> 00:32:02,389
but it's certainly something to consider

881
00:31:59,330 --> 00:32:04,790
I suppose<font color="#E5E5E5"> then there's people</font><font color="#CCCCCC"> who can go</font>

882
00:32:02,390 --> 00:32:06,950
around and hunt out the bots and report

883
00:32:04,790 --> 00:32:09,379
malware a report rogue IRC servers a

884
00:32:06,950 --> 00:32:10,850
thankless job doesn't seem to have that

885
00:32:09,380 --> 00:32:13,610
much of an impact if you look at it

886
00:32:10,850 --> 00:32:14,840
individually but enough people are

887
00:32:13,610 --> 00:32:16,729
reporting this stuff and<font color="#E5E5E5"> doing something</font>

888
00:32:14,840 --> 00:32:20,000
about it and maybe coming<font color="#E5E5E5"> up with some</font>

889
00:32:16,730 --> 00:32:21,200
nice ideas to make things easier<font color="#CCCCCC"> to stop</font>

890
00:32:20,000 --> 00:32:23,780
and mitigate this stuff you know maybe

891
00:32:21,200 --> 00:32:29,630
that is you know old-fashioned hard work

892
00:32:23,780 --> 00:32:30,950
is<font color="#E5E5E5"> the way to go now I've just got a</font>

893
00:32:29,630 --> 00:32:33,650
bunch<font color="#E5E5E5"> of miscellaneous slides here at</font>

894
00:32:30,950 --> 00:32:36,140
the end this<font color="#E5E5E5"> is just a simple</font><font color="#CCCCCC"> example of</font>

895
00:32:33,650 --> 00:32:39,160
if you're wanting to<font color="#E5E5E5"> try to catch box</font>

896
00:32:36,140 --> 00:32:41,809
you can really<font color="#E5E5E5"> do so with XP unpatched</font>

897
00:32:39,160 --> 00:32:43,010
just by setting up<font color="#CCCCCC"> I see</font><font color="#E5E5E5"> sec filters and</font>

898
00:32:41,809 --> 00:32:45,050
<font color="#E5E5E5">I won't go through each</font><font color="#CCCCCC"> one of these</font>

899
00:32:43,010 --> 00:32:47,330
lines but<font color="#E5E5E5"> the basic idea is here you can</font>

900
00:32:45,050 --> 00:32:49,879
set<font color="#CCCCCC"> it up so that your host will</font>

901
00:32:47,330 --> 00:32:51,800
actually capture a<font color="#E5E5E5"> bot will be able to</font>

902
00:32:49,880 --> 00:32:54,020
be infected that it won't be able to

903
00:32:51,800 --> 00:32:57,440
send out an attack traffic like on Court

904
00:32:54,020 --> 00:32:58,850
TV for full<font color="#CCCCCC"> 30 or TCP port 135 and you</font>

905
00:32:57,440 --> 00:33:00,890
<font color="#E5E5E5">can put in some custom rules for</font>

906
00:32:58,850 --> 00:33:02,540
yourself now<font color="#E5E5E5"> this actually is not</font>

907
00:33:00,890 --> 00:33:04,400
perfectly as in cases where this fails

908
00:33:02,540 --> 00:33:06,620
and certainly if<font color="#E5E5E5"> the host gets</font>

909
00:33:04,400 --> 00:33:08,570
compromised<font color="#CCCCCC"> but for now</font><font color="#E5E5E5"> we're smart</font>

910
00:33:06,620 --> 00:33:11,030
enough to concern this stuff<font color="#CCCCCC"> up so</font><font color="#E5E5E5"> far I</font>

911
00:33:08,570 --> 00:33:14,020
<font color="#E5E5E5">don't ever see</font><font color="#CCCCCC"> BOTS doing that but</font>

912
00:33:11,030 --> 00:33:16,220
certainly<font color="#E5E5E5"> it's not beyond possibility</font>

913
00:33:14,020 --> 00:33:17,570
most of us have router so that might be

914
00:33:16,220 --> 00:33:19,190
<font color="#E5E5E5">actually better just put that in line</font>

915
00:33:17,570 --> 00:33:24,580
and<font color="#E5E5E5"> you can effectively do the same</font>

916
00:33:19,190 --> 00:33:26,929
thing things that don't help much

917
00:33:24,580 --> 00:33:29,629
there's a few of them and<font color="#CCCCCC"> I would</font>

918
00:33:26,929 --> 00:33:32,300
<font color="#E5E5E5">recommend against all of these if you</font>

919
00:33:29,630 --> 00:33:34,309
find a rogar so you can server it's

920
00:33:32,300 --> 00:33:36,770
usually<font color="#CCCCCC"> not a good idea to go check it</font>

921
00:33:34,309 --> 00:33:38,210
out start doing who is commands start

922
00:33:36,770 --> 00:33:40,129
trying to<font color="#E5E5E5"> engage in chat with the person</font>

923
00:33:38,210 --> 00:33:41,570
who's operating it at best you'll get

924
00:33:40,130 --> 00:33:43,309
kicked off at worst you'll be drinking

925
00:33:41,570 --> 00:33:45,889
out of a fire roads so I<font color="#E5E5E5"> don't generally</font>

926
00:33:43,309 --> 00:33:47,570
recommend that for most<font color="#CCCCCC"> people there's</font>

927
00:33:45,890 --> 00:33:49,040
<font color="#E5E5E5">really no reason you need to do</font><font color="#CCCCCC"> that if</font>

928
00:33:47,570 --> 00:33:50,870
you can capture some of the traffic<font color="#E5E5E5"> and</font>

929
00:33:49,040 --> 00:33:53,240
you<font color="#E5E5E5"> know</font><font color="#CCCCCC"> its rogue IRC server that's all</font>

930
00:33:50,870 --> 00:33:55,870
you need to know you know<font color="#CCCCCC"> unless</font><font color="#E5E5E5"> you're</font>

931
00:33:53,240 --> 00:33:58,460
<font color="#CCCCCC">doing unless you're Rob Thomas I guess</font>

932
00:33:55,870 --> 00:34:01,479
he likes<font color="#E5E5E5"> to play in the underground but</font>

933
00:33:58,460 --> 00:34:01,480
for most<font color="#E5E5E5"> people i don't recommend</font>

934
00:34:01,720 --> 00:34:06,340
if you do find row controllers or<font color="#E5E5E5"> BOTS</font>

935
00:34:04,440 --> 00:34:07,510
don't just<font color="#E5E5E5"> tell your friends about them</font>

936
00:34:06,340 --> 00:34:08,710
say hey there's a real control and check

937
00:34:07,510 --> 00:34:10,600
your flows that doesn't really solve

938
00:34:08,710 --> 00:34:12,730
much most people won't have flows

939
00:34:10,600 --> 00:34:13,779
because there's enough<font color="#E5E5E5"> BOTS to go around</font>

940
00:34:12,730 --> 00:34:16,300
most people aren't going<font color="#E5E5E5"> to have the</font>

941
00:34:13,780 --> 00:34:17,620
same<font color="#E5E5E5"> thoughts you have but what you can</font>

942
00:34:16,300 --> 00:34:19,450
do is at<font color="#CCCCCC"> least report it to someone</font>

943
00:34:17,620 --> 00:34:21,819
who's responsible if you don't know

944
00:34:19,449 --> 00:34:23,589
<font color="#CCCCCC">about the tinkermen who is sort</font><font color="#E5E5E5"> of run</font>

945
00:34:21,820 --> 00:34:24,880
this command and find out about it it's

946
00:34:23,590 --> 00:34:27,640
<font color="#E5E5E5">really handy thing to have a toast</font>

947
00:34:24,880 --> 00:34:30,520
<font color="#E5E5E5">essentially which is is responsible for</font>

948
00:34:27,639 --> 00:34:31,929
<font color="#E5E5E5">routing a particular address and the</font>

949
00:34:30,520 --> 00:34:33,340
other<font color="#CCCCCC"> thing you</font><font color="#E5E5E5"> know I don't</font><font color="#CCCCCC"> think you</font>

950
00:34:31,929 --> 00:34:35,020
find this in mid nineties peas but you

951
00:34:33,340 --> 00:34:37,060
would find this in an organization's

952
00:34:35,020 --> 00:34:40,989
those who would block the standard IRC

953
00:34:37,060 --> 00:34:42,909
protocol port 6667 first of<font color="#E5E5E5"> all any of</font>

954
00:34:40,989 --> 00:34:44,949
you opposed to port filtering<font color="#CCCCCC"> ugh i am</font>

955
00:34:42,909 --> 00:34:46,509
<font color="#E5E5E5">it's just kind of a dumb idea there's</font>

956
00:34:44,949 --> 00:34:48,310
just<font color="#E5E5E5"> too many bit combinations to filter</font>

957
00:34:46,510 --> 00:34:49,900
on that you'll never built at<font color="#E5E5E5"> all but</font>

958
00:34:48,310 --> 00:34:51,639
<font color="#CCCCCC">really more importantly there's no</font>

959
00:34:49,900 --> 00:34:54,460
reason that a row controller has to use

960
00:34:51,639 --> 00:34:56,409
port 6667 while a lot of<font color="#CCCCCC"> them do a lot</font>

961
00:34:54,460 --> 00:35:00,790
of them<font color="#E5E5E5"> don't</font><font color="#CCCCCC"> okay so that really isn't</font>

962
00:34:56,409 --> 00:35:02,770
going to solve the problem<font color="#CCCCCC"> as some</font>

963
00:35:00,790 --> 00:35:06,130
<font color="#E5E5E5">additional things that go over real</font>

964
00:35:02,770 --> 00:35:07,870
briefly if you are the recipients<font color="#CCCCCC"> of a</font>

965
00:35:06,130 --> 00:35:10,720
if you happen to<font color="#E5E5E5"> be a lucky recipient</font><font color="#CCCCCC"> of</font>

966
00:35:07,870 --> 00:35:12,370
the botnet controller and I<font color="#E5E5E5"> suspect a</font>

967
00:35:10,720 --> 00:35:14,470
lot of you have probably had these

968
00:35:12,370 --> 00:35:18,220
either unintentionally<font color="#CCCCCC"> oh</font><font color="#E5E5E5"> maybe perhaps</font>

969
00:35:14,470 --> 00:35:19,330
on purpose you can take over<font color="#E5E5E5"> that</font>

970
00:35:18,220 --> 00:35:22,209
controller either if you have the name

971
00:35:19,330 --> 00:35:23,650
or<font color="#CCCCCC"> the address I generally wouldn't</font>

972
00:35:22,210 --> 00:35:25,810
recommend this either but it's been done

973
00:35:23,650 --> 00:35:29,650
you can<font color="#CCCCCC"> corral</font><font color="#E5E5E5"> the bots and see all the</font>

974
00:35:25,810 --> 00:35:31,090
bots that are<font color="#E5E5E5"> connecting to it not</font>

975
00:35:29,650 --> 00:35:34,360
something for<font color="#E5E5E5"> the weak of heart I</font>

976
00:35:31,090 --> 00:35:36,000
suppose RC traffic is rhythmic if

977
00:35:34,360 --> 00:35:38,800
there's no activity there's a<font color="#CCCCCC"> ping pong</font>

978
00:35:36,000 --> 00:35:40,570
keep-alive mechanism that happens so it

979
00:35:38,800 --> 00:35:42,580
seems to vary depending on the IRC

980
00:35:40,570 --> 00:35:44,500
server that<font color="#CCCCCC"> T's</font><font color="#E5E5E5"> / typically run from 15</font>

981
00:35:42,580 --> 00:35:46,120
to a couple of<font color="#E5E5E5"> minutes where let me ping</font>

982
00:35:44,500 --> 00:35:48,940
pong packets that go back and forth and

983
00:35:46,120 --> 00:35:50,770
again there's specific patterns to IRC

984
00:35:48,940 --> 00:35:53,110
traffic as well you certainly wouldn't

985
00:35:50,770 --> 00:35:55,300
expect to<font color="#E5E5E5"> see lots of 1500 by packets</font>

986
00:35:53,110 --> 00:35:58,420
<font color="#E5E5E5">I'm going between pots in the botnet</font>

987
00:35:55,300 --> 00:36:00,660
servers any Windows host with the port

988
00:35:58,420 --> 00:36:02,890
<font color="#E5E5E5">113 open has probably got a bottle</font>

989
00:36:00,660 --> 00:36:05,850
that's probably<font color="#CCCCCC"> the one port that's</font><font color="#E5E5E5"> not</font>

990
00:36:02,890 --> 00:36:05,850
open by default on windows

991
00:36:06,180 --> 00:36:11,440
ftp ports on on or ftp services on

992
00:36:09,310 --> 00:36:13,990
<font color="#E5E5E5">edwards is often a bad sign that's</font>

993
00:36:11,440 --> 00:36:16,869
probably one of those gray area botnets

994
00:36:13,990 --> 00:36:19,689
where there's a private<font color="#E5E5E5"> ftp server</font>

995
00:36:16,869 --> 00:36:23,440
serving up music files or movies and

996
00:36:19,690 --> 00:36:25,360
again if you can if you<font color="#CCCCCC"> can get past</font>

997
00:36:23,440 --> 00:36:27,040
kind of the legal<font color="#E5E5E5"> and the privacy issues</font>

998
00:36:25,360 --> 00:36:29,560
if you can actually<font color="#CCCCCC"> look at</font><font color="#E5E5E5"> the package</font>

999
00:36:27,040 --> 00:36:31,480
you<font color="#E5E5E5"> can do a lot more there's not been a</font>

1000
00:36:29,560 --> 00:36:33,460
whole lot<font color="#E5E5E5"> of effort to encrypt a lot of</font>

1001
00:36:31,480 --> 00:36:36,460
this stuff so if you can match on

1002
00:36:33,460 --> 00:36:38,410
certain signatures and strings more than

1003
00:36:36,460 --> 00:36:40,240
just flows and packet sizes and that's

1004
00:36:38,410 --> 00:36:42,490
that sort of thing you can probably<font color="#CCCCCC"> find</font>

1005
00:36:40,240 --> 00:36:44,589
<font color="#E5E5E5">most the bottles or most of the road</font>

1006
00:36:42,490 --> 00:36:45,970
controllers just based on a few

1007
00:36:44,590 --> 00:36:47,350
well-known strings because there's not<font color="#E5E5E5"> a</font>

1008
00:36:45,970 --> 00:36:49,359
lot of deviations between what they're

1009
00:36:47,350 --> 00:36:55,060
actually sending and receiving as far as

1010
00:36:49,360 --> 00:36:56,770
though the plain text goes now the bad

1011
00:36:55,060 --> 00:36:58,360
news is there's a lots of things that a

1012
00:36:56,770 --> 00:37:00,520
miscreant could do to really hard these

1013
00:36:58,360 --> 00:37:03,340
<font color="#E5E5E5">botnets to make it harder for any of us</font>

1014
00:37:00,520 --> 00:37:05,950
<font color="#E5E5E5">to stop them or mitigate them one of the</font>

1015
00:37:03,340 --> 00:37:07,119
most<font color="#CCCCCC"> obvious is to encrypt stuff once</font>

1016
00:37:05,950 --> 00:37:09,460
that<font color="#E5E5E5"> happens it's going to be really</font>

1017
00:37:07,119 --> 00:37:10,960
hard other than the hard work of going

1018
00:37:09,460 --> 00:37:12,490
out<font color="#CCCCCC"> and finding a bot or the malware</font>

1019
00:37:10,960 --> 00:37:15,700
that's used on the bot to see what's

1020
00:37:12,490 --> 00:37:17,859
<font color="#E5E5E5">going on why this hasn't happened is not</font>

1021
00:37:15,700 --> 00:37:19,930
<font color="#E5E5E5">entirely clear but it probably the best</font>

1022
00:37:17,859 --> 00:37:22,330
<font color="#CCCCCC">answer is</font><font color="#E5E5E5"> because it doesn't need to the</font>

1023
00:37:19,930 --> 00:37:24,399
basically<font color="#E5E5E5"> just don't need to do this the</font>

1024
00:37:22,330 --> 00:37:26,980
other option may<font color="#CCCCCC"> be that it does add</font>

1025
00:37:24,400 --> 00:37:28,510
some overhead to the malware I don't

1026
00:37:26,980 --> 00:37:29,980
think<font color="#CCCCCC"> that</font><font color="#E5E5E5"> much that</font><font color="#CCCCCC"> will certainly</font><font color="#E5E5E5"> make</font>

1027
00:37:28,510 --> 00:37:32,200
it<font color="#E5E5E5"> impossible you know three hundred</font>

1028
00:37:29,980 --> 00:37:34,060
kilobytes maybe maybe a couple of eggs

1029
00:37:32,200 --> 00:37:36,490
at the<font color="#E5E5E5"> most that doesn't seem like a</font>

1030
00:37:34,060 --> 00:37:38,619
whole lot<font color="#CCCCCC"> of effort and trim to harden a</font>

1031
00:37:36,490 --> 00:37:40,240
botnet so once that starts happening if

1032
00:37:38,619 --> 00:37:41,890
<font color="#E5E5E5">it does that's not going to be good</font>

1033
00:37:40,240 --> 00:37:44,680
that's going<font color="#E5E5E5"> to make the job</font><font color="#CCCCCC"> finding</font>

1034
00:37:41,890 --> 00:37:46,960
<font color="#CCCCCC">this stuff a lot harder</font><font color="#E5E5E5"> I receive will</font>

1035
00:37:44,680 --> 00:37:48,700
probably be<font color="#CCCCCC"> the dominant command control</font>

1036
00:37:46,960 --> 00:37:50,830
infrastructure because it's easy and it

1037
00:37:48,700 --> 00:37:52,330
works really well as there's probably

1038
00:37:50,830 --> 00:37:56,020
not a reason to using<font color="#E5E5E5"> anything else that</font>

1039
00:37:52,330 --> 00:37:57,819
scales really well there's<font color="#CCCCCC"> lots of tools</font>

1040
00:37:56,020 --> 00:37:59,619
that<font color="#E5E5E5"> have been built us both off the IRC</font>

1041
00:37:57,820 --> 00:38:02,140
clients and there's free server software

1042
00:37:59,619 --> 00:38:03,550
available so you'll<font color="#CCCCCC"> probably see IRC</font>

1043
00:38:02,140 --> 00:38:05,589
being the command<font color="#CCCCCC"> and control</font>

1044
00:38:03,550 --> 00:38:06,430
<font color="#E5E5E5">infrastructure for some time but there's</font>

1045
00:38:05,590 --> 00:38:07,810
<font color="#E5E5E5">been other command control</font>

1046
00:38:06,430 --> 00:38:10,230
infrastructures like instant messaging

1047
00:38:07,810 --> 00:38:13,210
and peer-to-peer file-sharing protocols

1048
00:38:10,230 --> 00:38:15,310
ipv6 networks how many<font color="#E5E5E5"> of you have flow</font>

1049
00:38:13,210 --> 00:38:16,440
monitoring and ipv6 networks raising

1050
00:38:15,310 --> 00:38:18,700
hand

1051
00:38:16,440 --> 00:38:21,160
nobody because as far as i know i don't

1052
00:38:18,700 --> 00:38:23,470
think<font color="#CCCCCC"> it exists alright so how do you</font>

1053
00:38:21,160 --> 00:38:25,240
detect botnets or see<font color="#CCCCCC"> what sorts of</font>

1054
00:38:23,470 --> 00:38:27,910
activities going<font color="#E5E5E5"> on we don't even have</font>

1055
00:38:25,240 --> 00:38:29,288
the tools to look for<font color="#E5E5E5"> this stuff and if</font>

1056
00:38:27,910 --> 00:38:31,149
you don't think<font color="#E5E5E5"> that's happening thing</font>

1057
00:38:29,289 --> 00:38:33,819
again has not happening a lot<font color="#E5E5E5"> but it's</font>

1058
00:38:31,150 --> 00:38:35,259
<font color="#CCCCCC">happening distributing e to the</font>

1059
00:38:33,819 --> 00:38:37,299
<font color="#E5E5E5">controllers either by having multiple</font>

1060
00:38:35,259 --> 00:38:39,450
names multiplier see servers basically

1061
00:38:37,299 --> 00:38:42,819
multiple multiple botnets within botnets

1062
00:38:39,450 --> 00:38:45,308
using something else besides<font color="#CCCCCC"> DNS this is</font>

1063
00:38:42,819 --> 00:38:46,359
if I was a kid if I was a miscreant and

1064
00:38:45,309 --> 00:38:49,720
I'm not<font color="#E5E5E5"> saying that a matter of months</font>

1065
00:38:46,359 --> 00:38:51,880
ago<font color="#E5E5E5"> and if you if you were a miss</font>

1066
00:38:49,720 --> 00:38:54,299
Graydon you want if you're realizing

1067
00:38:51,880 --> 00:38:56,500
that your names are being<font color="#E5E5E5"> shut down</font>

1068
00:38:54,299 --> 00:38:58,869
there's a number of ways<font color="#CCCCCC"> that you can</font>

1069
00:38:56,500 --> 00:39:00,940
<font color="#E5E5E5">get around using DNS certainly you can</font>

1070
00:38:58,869 --> 00:39:02,950
go query different dns servers that

1071
00:39:00,940 --> 00:39:04,779
people<font color="#CCCCCC"> aren't watching but it would be</font>

1072
00:39:02,950 --> 00:39:06,038
<font color="#E5E5E5">really easy just to set up vanity web</font>

1073
00:39:04,779 --> 00:39:08,049
page somewhere with a list of IP

1074
00:39:06,039 --> 00:39:09,579
addresses on it and even if you're

1075
00:39:08,049 --> 00:39:11,160
monitoring flows you have really no way

1076
00:39:09,579 --> 00:39:13,329
of telling which page they're getting at

1077
00:39:11,160 --> 00:39:14,288
<font color="#CCCCCC">okay and the IP addresses that they're</font>

1078
00:39:13,329 --> 00:39:16,720
pulling down from that page unless

1079
00:39:14,289 --> 00:39:18,039
you're actually doing packet capture and

1080
00:39:16,720 --> 00:39:19,419
how<font color="#CCCCCC"> many</font><font color="#E5E5E5"> of you are doing packet capture</font>

1081
00:39:18,039 --> 00:39:22,240
and keep in<font color="#E5E5E5"> that packet capture data for</font>

1082
00:39:19,420 --> 00:39:23,619
a long time I suspect almost<font color="#E5E5E5"> nobody so</font>

1083
00:39:22,240 --> 00:39:25,868
<font color="#CCCCCC">it's really easy to harden some of this</font>

1084
00:39:23,619 --> 00:39:27,970
stuff<font color="#E5E5E5"> okay and that last one does happen</font>

1085
00:39:25,869 --> 00:39:29,920
to you<font color="#CCCCCC"> okay that's again why</font><font color="#E5E5E5"> I don't</font>

1086
00:39:27,970 --> 00:39:32,439
recommend people go out<font color="#E5E5E5"> and try to</font>

1087
00:39:29,920 --> 00:39:34,950
<font color="#E5E5E5">mitigate this stuff by hand because you</font>

1088
00:39:32,440 --> 00:39:34,950
may be<font color="#E5E5E5"> sorry</font>

1089
00:39:37,720 --> 00:39:41,200
some of the people now network operators

1090
00:39:39,700 --> 00:39:42,368
can't do this by themselves you<font color="#E5E5E5"> know we</font>

1091
00:39:41,200 --> 00:39:44,140
<font color="#E5E5E5">could possibly help with some of this</font>

1092
00:39:42,369 --> 00:39:46,000
but there's I think<font color="#E5E5E5"> most people here</font>

1093
00:39:44,140 --> 00:39:47,799
would agree it's<font color="#CCCCCC"> not our job to go fix</font>

1094
00:39:46,000 --> 00:39:49,150
all these<font color="#CCCCCC"> BOTS but if we can help I</font>

1095
00:39:47,800 --> 00:39:51,099
would argue that we should do<font color="#E5E5E5"> something</font>

1096
00:39:49,150 --> 00:39:53,380
<font color="#CCCCCC">okay</font><font color="#E5E5E5"> because other people have a stake</font>

1097
00:39:51,099 --> 00:39:55,330
in a salsa the<font color="#CCCCCC"> AV vendors are the people</font>

1098
00:39:53,380 --> 00:39:57,820
who are pulling apart the malware they

1099
00:39:55,330 --> 00:39:59,440
find all<font color="#E5E5E5"> the details about the bottom</font>

1100
00:39:57,820 --> 00:40:02,109
<font color="#E5E5E5">out the names the channels the next all</font>

1101
00:39:59,440 --> 00:40:04,180
that sort of stuff often you can go<font color="#E5E5E5"> out</font>

1102
00:40:02,109 --> 00:40:05,500
to a semantic site or any of the AV

1103
00:40:04,180 --> 00:40:08,919
vendors you'll see<font color="#E5E5E5"> that they've written</font>

1104
00:40:05,500 --> 00:40:10,900
up a full report on a particular piece

1105
00:40:08,920 --> 00:40:12,460
of<font color="#E5E5E5"> malware that contains an IRC bot and</font>

1106
00:40:10,900 --> 00:40:13,720
they've listed not only the dns name but

1107
00:40:12,460 --> 00:40:15,670
the channels and<font color="#E5E5E5"> the next and everything</font>

1108
00:40:13,720 --> 00:40:18,098
else<font color="#CCCCCC"> and even after a couple of months</font>

1109
00:40:15,670 --> 00:40:19,540
it's still active so<font color="#CCCCCC"> they find all</font><font color="#E5E5E5"> this</font>

1110
00:40:18,099 --> 00:40:20,859
information<font color="#CCCCCC"> what do</font><font color="#E5E5E5"> they do with it they</font>

1111
00:40:19,540 --> 00:40:22,720
just<font color="#CCCCCC"> posted to a webpage and</font><font color="#E5E5E5"> they kind</font>

1112
00:40:20,859 --> 00:40:24,160
<font color="#E5E5E5">of move on I don't necessarily blame</font>

1113
00:40:22,720 --> 00:40:25,390
them they've probably got lots of<font color="#E5E5E5"> this</font>

1114
00:40:24,160 --> 00:40:27,910
<font color="#CCCCCC">stuff to look at lots of</font><font color="#E5E5E5"> better things</font>

1115
00:40:25,390 --> 00:40:30,069
to do than go closing stuff but it might

1116
00:40:27,910 --> 00:40:32,319
<font color="#CCCCCC">be nice for them to maybe</font><font color="#E5E5E5"> have a central</font>

1117
00:40:30,070 --> 00:40:33,820
reporting facility for some of these

1118
00:40:32,320 --> 00:40:37,540
names<font color="#E5E5E5"> or addresses that are being</font><font color="#CCCCCC"> used</font>

1119
00:40:33,820 --> 00:40:38,980
so be closed down<font color="#CCCCCC"> on bastard one of the</font>

1120
00:40:37,540 --> 00:40:41,050
<font color="#E5E5E5">things i</font><font color="#CCCCCC"> would like isn't kind of an</font>

1121
00:40:38,980 --> 00:40:42,910
organization is if anyone who's running

1122
00:40:41,050 --> 00:40:45,580
a dns service allows people to point

1123
00:40:42,910 --> 00:40:46,720
names at various IP addresses I kind<font color="#E5E5E5"> of</font>

1124
00:40:45,580 --> 00:40:49,210
<font color="#E5E5E5">like to know when you're pointing names</font>

1125
00:40:46,720 --> 00:40:50,830
up my IP addresses generally we don't

1126
00:40:49,210 --> 00:40:52,960
allow that so if<font color="#CCCCCC"> that's happening I'd</font>

1127
00:40:50,830 --> 00:40:53,950
kind of like to know about it if if it's

1128
00:40:52,960 --> 00:40:55,180
something<font color="#E5E5E5"> that's happening I go take a</font>

1129
00:40:53,950 --> 00:40:57,339
look at<font color="#E5E5E5"> it and see if it's being used</font>

1130
00:40:55,180 --> 00:40:58,450
for inappropriate purposes now the big

1131
00:40:57,339 --> 00:41:01,119
ideas peas probably don't need the

1132
00:40:58,450 --> 00:41:02,890
services<font color="#CCCCCC"> it's wouldn't be something that</font>

1133
00:41:01,119 --> 00:41:04,150
they could manage but<font color="#E5E5E5"> they're serving</font>

1134
00:41:02,890 --> 00:41:05,560
<font color="#E5E5E5">for a lot of endor organizations well a</font>

1135
00:41:04,150 --> 00:41:10,119
lot of<font color="#E5E5E5"> the stuff ends up I'd like to</font>

1136
00:41:05,560 --> 00:41:12,099
know about it IRC operators have tough

1137
00:41:10,119 --> 00:41:13,380
<font color="#CCCCCC">time because usually volunteer and don't</font>

1138
00:41:12,099 --> 00:41:15,700
have<font color="#E5E5E5"> a lot of spare time to do these</font>

1139
00:41:13,380 --> 00:41:18,099
sorts of things but the more they<font color="#CCCCCC"> can</font>

1140
00:41:15,700 --> 00:41:19,839
pass information<font color="#E5E5E5"> on to us certainly we</font>

1141
00:41:18,099 --> 00:41:21,250
<font color="#CCCCCC">can help them out and</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> course you know</font>

1142
00:41:19,839 --> 00:41:22,630
the reason being all three of these

1143
00:41:21,250 --> 00:41:26,820
people are<font color="#E5E5E5"> being attacked by host on our</font>

1144
00:41:22,630 --> 00:41:28,960
network so they have a stake in us and

1145
00:41:26,820 --> 00:41:30,730
finally to wrap up last couple of slides

1146
00:41:28,960 --> 00:41:33,730
here's some information that I found

1147
00:41:30,730 --> 00:41:35,800
useful and the last slide I don't know

1148
00:41:33,730 --> 00:41:37,780
that<font color="#E5E5E5"> it's online yet another very green</font>

1149
00:41:35,800 --> 00:41:40,960
is here but he told me who's going<font color="#E5E5E5"> to</font>

1150
00:41:37,780 --> 00:41:42,609
put this on<font color="#E5E5E5"> the lawn Cisco's ftp site so</font>

1151
00:41:40,960 --> 00:41:43,390
if it's not<font color="#E5E5E5"> that it's not there yet</font>

1152
00:41:42,609 --> 00:41:49,750
it'll<font color="#E5E5E5"> be there</font>

1153
00:41:43,390 --> 00:41:50,859
pretty soon and there's a few things

1154
00:41:49,750 --> 00:41:53,619
that<font color="#E5E5E5"> you can go find everyone knows</font>

1155
00:41:50,859 --> 00:41:54,759
<font color="#CCCCCC">about a lot of</font><font color="#E5E5E5"> this stuff but if you</font>

1156
00:41:53,619 --> 00:41:56,049
know what<font color="#E5E5E5"> to search for you can actually</font>

1157
00:41:54,760 --> 00:41:57,910
<font color="#E5E5E5">find your own botnets just buy some</font>

1158
00:41:56,049 --> 00:41:59,230
simple web searches and I'll kind<font color="#E5E5E5"> of</font>

1159
00:41:57,910 --> 00:42:02,170
leave it<font color="#CCCCCC"> at that you can go find</font><font color="#E5E5E5"> your</font>

1160
00:41:59,230 --> 00:42:03,490
own when you've got free time<font color="#E5E5E5"> I hope</font>

1161
00:42:02,170 --> 00:42:07,859
<font color="#E5E5E5">I've left is the couple minutes</font><font color="#CCCCCC"> for</font>

1162
00:42:03,490 --> 00:42:07,859
questions but more importantly answers

1163
00:42:20,260 --> 00:42:30,320
this is inappropriately set for<font color="#E5E5E5"> Nordic</font>

1164
00:42:24,740 --> 00:42:32,450
people so I find it useful how long do

1165
00:42:30,320 --> 00:42:34,220
you expect to keep logs i mean you're

1166
00:42:32,450 --> 00:42:35,450
talking about<font color="#E5E5E5"> doing tracing and logging</font>

1167
00:42:34,220 --> 00:42:39,850
and keeping that kind of stuff and

1168
00:42:35,450 --> 00:42:42,379
increasingly<font color="#E5E5E5"> i'm getting pushback from</font>

1169
00:42:39,850 --> 00:42:46,940
legal and administrative people that

1170
00:42:42,380 --> 00:42:50,920
keeping logs is a bad thing so what<font color="#CCCCCC"> it</font>

1171
00:42:46,940 --> 00:42:53,810
<font color="#CCCCCC">would has had helped me reconcile this</font>

1172
00:42:50,920 --> 00:42:55,010
well I I can tell you as much just basis

1173
00:42:53,810 --> 00:42:56,930
if you have if you<font color="#CCCCCC"> can use it that's</font>

1174
00:42:55,010 --> 00:42:58,220
nice because with something like dns

1175
00:42:56,930 --> 00:43:00,049
query logs that's going to take a lot of

1176
00:42:58,220 --> 00:43:02,149
space you're probably not going to<font color="#CCCCCC"> be</font>

1177
00:43:00,050 --> 00:43:04,730
able to keep<font color="#CCCCCC"> that much anyways got about</font>

1178
00:43:02,150 --> 00:43:06,140
<font color="#E5E5E5">a half a terabyte of school well that</font>

1179
00:43:04,730 --> 00:43:08,660
that's still probably not going to<font color="#E5E5E5"> be</font>

1180
00:43:06,140 --> 00:43:11,450
that month that many logs really for for

1181
00:43:08,660 --> 00:43:13,850
some organizations I I can tell you what

1182
00:43:11,450 --> 00:43:16,250
I do I don't tend to<font color="#E5E5E5"> keep it more than</font>

1183
00:43:13,850 --> 00:43:17,720
one two three months<font color="#E5E5E5"> after that point</font>

1184
00:43:16,250 --> 00:43:19,760
it's really stale and you can't really

1185
00:43:17,720 --> 00:43:21,830
<font color="#E5E5E5">do much with least dns query logs after</font>

1186
00:43:19,760 --> 00:43:23,180
that point and I'm like you I don't<font color="#E5E5E5"> want</font>

1187
00:43:21,830 --> 00:43:25,310
to keep it<font color="#E5E5E5"> very long either or i'm like</font>

1188
00:43:23,180 --> 00:43:27,529
the lawyers I don't want to be in a

1189
00:43:25,310 --> 00:43:28,970
situation<font color="#E5E5E5"> where I have</font><font color="#CCCCCC"> to have it I</font>

1190
00:43:27,530 --> 00:43:32,600
don't want<font color="#CCCCCC"> it to</font><font color="#E5E5E5"> be</font><font color="#CCCCCC"> a subpoena day</font>

1191
00:43:28,970 --> 00:43:33,859
actually<font color="#E5E5E5"> so you if it's a week or two</font>

1192
00:43:32,600 --> 00:43:36,140
old it's probably not gonna be<font color="#E5E5E5"> that much</font>

1193
00:43:33,860 --> 00:43:38,060
<font color="#CCCCCC">East anyways particularly with botnets</font>

1194
00:43:36,140 --> 00:43:42,109
the names<font color="#CCCCCC"> ten cheney kind of change</font>

1195
00:43:38,060 --> 00:43:44,480
pretty often so<font color="#E5E5E5"> what may be pointing to</font>

1196
00:43:42,110 --> 00:43:45,770
one host one day will be pointing to two

1197
00:43:44,480 --> 00:43:51,980
or three different houses of the next

1198
00:43:45,770 --> 00:43:53,840
day<font color="#E5E5E5"> okay and you have intimated or</font>

1199
00:43:51,980 --> 00:43:56,030
suggest to the couple of other ways of

1200
00:43:53,840 --> 00:43:59,090
actually identifying bought activity

1201
00:43:56,030 --> 00:44:00,830
other than yet another abuse of the dns

1202
00:43:59,090 --> 00:44:04,310
do you know anybody that's actually

1203
00:44:00,830 --> 00:44:06,380
working on that<font color="#CCCCCC"> oh which example are you</font>

1204
00:44:04,310 --> 00:44:09,759
referring to those like the packet

1205
00:44:06,380 --> 00:44:13,550
capture packet captures a big hammer

1206
00:44:09,760 --> 00:44:17,270
there anyway maybe I should<font color="#CCCCCC"> take</font><font color="#E5E5E5"> this up</font>

1207
00:44:13,550 --> 00:44:18,770
in<font color="#E5E5E5"> the security buffing this evening so</font>

1208
00:44:17,270 --> 00:44:20,390
let me<font color="#CCCCCC"> do that if there's lots of</font>

1209
00:44:18,770 --> 00:44:22,340
details<font color="#CCCCCC"> I had to leave out some details</font>

1210
00:44:20,390 --> 00:44:23,660
like I<font color="#CCCCCC"> wanted to</font><font color="#E5E5E5"> leave out because I</font>

1211
00:44:22,340 --> 00:44:24,750
didn't want certain people searching for

1212
00:44:23,660 --> 00:44:30,060
certain<font color="#CCCCCC"> strings</font><font color="#E5E5E5"> and find</font>

1213
00:44:24,750 --> 00:44:37,070
my name attached to it I know you had

1214
00:44:30,060 --> 00:44:44,340
something to<font color="#CCCCCC"> say hi Anna I'm an odd</font>

1215
00:44:37,070 --> 00:44:46,410
that's more<font color="#E5E5E5"> like</font><font color="#CCCCCC"> it and I</font><font color="#E5E5E5"> am too so I'm</font>

1216
00:44:44,340 --> 00:44:47,700
<font color="#E5E5E5">Rob Thomas with team comer II and I'd</font>

1217
00:44:46,410 --> 00:44:49,410
<font color="#E5E5E5">like</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> thank John putting together an</font>

1218
00:44:47,700 --> 00:44:53,089
excellent presentation<font color="#CCCCCC"> but i</font><font color="#E5E5E5"> want to</font>

1219
00:44:49,410 --> 00:44:53,089
highlight a couple things thank you John

1220
00:44:55,760 --> 00:45:00,810
so when people<font color="#E5E5E5"> talk about bots that</font>

1221
00:44:59,010 --> 00:45:03,300
tends to<font color="#E5E5E5"> be</font><font color="#CCCCCC"> a lot of focus on Microsoft</font>

1222
00:45:00,810 --> 00:45:05,580
and that's certainly true but<font color="#CCCCCC"> you</font><font color="#E5E5E5"> need</font>

1223
00:45:03,300 --> 00:45:08,100
to understand why because it's a target

1224
00:45:05,580 --> 00:45:11,130
of opportunity the miscreants are

1225
00:45:08,100 --> 00:45:12,830
actually OS agnostic they don't care<font color="#E5E5E5"> so</font>

1226
00:45:11,130 --> 00:45:16,680
how many<font color="#E5E5E5"> of you have juniper routers</font>

1227
00:45:12,830 --> 00:45:18,660
you've got by it turns out juniper

1228
00:45:16,680 --> 00:45:21,569
routers are awesome little platforms for

1229
00:45:18,660 --> 00:45:24,810
compiling freebsd<font color="#E5E5E5"> BOTS kite an night and</font>

1230
00:45:21,570 --> 00:45:28,620
running them and lately<font color="#E5E5E5"> the miscreants</font>

1231
00:45:24,810 --> 00:45:30,930
have been scanning for<font color="#E5E5E5"> TCP 22 easily</font>

1232
00:45:28,620 --> 00:45:32,970
<font color="#E5E5E5">guessed logins and passwords and they</font>

1233
00:45:30,930 --> 00:45:35,040
put there by down there what they can't

1234
00:45:32,970 --> 00:45:37,319
believe is they finally got a bot that

1235
00:45:35,040 --> 00:45:44,880
has an OC 192 they don't have to lie

1236
00:45:37,320 --> 00:45:47,580
anymore they're increasingly moving to

1237
00:45:44,880 --> 00:45:49,110
unix based<font color="#CCCCCC"> BOTS because</font><font color="#E5E5E5"> remember John</font>

1238
00:45:47,580 --> 00:45:50,700
said something early but it was<font color="#E5E5E5"> really</font>

1239
00:45:49,110 --> 00:45:52,200
the<font color="#E5E5E5"> crux of this is that it's all about</font>

1240
00:45:50,700 --> 00:45:54,509
profit that's how<font color="#E5E5E5"> these people are</font>

1241
00:45:52,200 --> 00:45:58,580
making a living so they go to unix based

1242
00:45:54,510 --> 00:46:00,960
BOTS why shock amazement windows crashes

1243
00:45:58,580 --> 00:46:02,640
they can't keep their windows BOTS up

1244
00:46:00,960 --> 00:46:05,940
any longer then your users can keep

1245
00:46:02,640 --> 00:46:08,129
their machines up the record right now

1246
00:46:05,940 --> 00:46:10,560
<font color="#E5E5E5">in the underground is 14 different</font>

1247
00:46:08,130 --> 00:46:13,080
active bots on a single<font color="#E5E5E5"> Windows machine</font>

1248
00:46:10,560 --> 00:46:18,120
that's pretty<font color="#E5E5E5"> cool even the miscreants</font>

1249
00:46:13,080 --> 00:46:20,759
couldn't believe<font color="#CCCCCC"> that they booted the</font>

1250
00:46:18,120 --> 00:46:23,580
bots themselves are used by people who

1251
00:46:20,760 --> 00:46:25,710
are not technical by and<font color="#E5E5E5"> large those</font>

1252
00:46:23,580 --> 00:46:27,480
running botnets and using them for spam

1253
00:46:25,710 --> 00:46:30,270
and ddos extortion things they're not

1254
00:46:27,480 --> 00:46:33,180
technical people for this reason for

1255
00:46:30,270 --> 00:46:35,400
example a bot binary compiled by this

1256
00:46:33,180 --> 00:46:38,259
gentleman for me because<font color="#E5E5E5"> I'm not a</font>

1257
00:46:35,400 --> 00:46:41,710
techie will cost me 400

1258
00:46:38,260 --> 00:46:44,760
52 five hundred dollars us that's what<font color="#E5E5E5"> I</font>

1259
00:46:41,710 --> 00:46:46,720
will pay him to type dot slash configure

1260
00:46:44,760 --> 00:46:50,380
you didn't know how<font color="#CCCCCC"> much you were worth</font>

1261
00:46:46,720 --> 00:46:52,209
did you see you have to<font color="#E5E5E5"> understand the</font>

1262
00:46:50,380 --> 00:46:53,620
motivation here is money there's

1263
00:46:52,210 --> 00:46:55,510
something<font color="#E5E5E5"> you need to know about every</font>

1264
00:46:53,620 --> 00:46:58,240
single bot so you may be thinking<font color="#CCCCCC"> BOTS d</font>

1265
00:46:55,510 --> 00:47:01,660
dot skin and splayed yeah I don't<font color="#CCCCCC"> have</font>

1266
00:46:58,240 --> 00:47:04,629
<font color="#E5E5E5">time for that every single bot has</font>

1267
00:47:01,660 --> 00:47:07,509
keystroke logging capability and it

1268
00:47:04,630 --> 00:47:10,540
actively hunts for financial data on the

1269
00:47:07,510 --> 00:47:12,700
machines it infects that means it's

1270
00:47:10,540 --> 00:47:14,440
pulling people's bank accounts their

1271
00:47:12,700 --> 00:47:16,649
PayPal accounts their western union

1272
00:47:14,440 --> 00:47:19,030
accounts and then they clean them out

1273
00:47:16,650 --> 00:47:22,630
many of the botnets we see built today

1274
00:47:19,030 --> 00:47:24,370
are simply built to be sold to those who

1275
00:47:22,630 --> 00:47:27,190
will clean out those bank accounts or

1276
00:47:24,370 --> 00:47:29,410
worse we use those bank accounts to move

1277
00:47:27,190 --> 00:47:33,070
money through are you familiar with the

1278
00:47:29,410 --> 00:47:35,470
term the underground term cashier what

1279
00:47:33,070 --> 00:47:38,590
is a cashier here's how madly their

1280
00:47:35,470 --> 00:47:41,290
skills are a cashier is somebody who

1281
00:47:38,590 --> 00:47:44,320
<font color="#E5E5E5">lives in the United States generally has</font>

1282
00:47:41,290 --> 00:47:46,560
a US based phone number and makes calls

1283
00:47:44,320 --> 00:47:49,150
all day long cleaning out bank accounts

1284
00:47:46,560 --> 00:47:50,890
they will get fifty percent of<font color="#E5E5E5"> the</font>

1285
00:47:49,150 --> 00:47:53,280
proceeds for doing this for<font color="#E5E5E5"> somebody who</font>

1286
00:47:50,890 --> 00:47:55,779
has bots that have these bank accounts

1287
00:47:53,280 --> 00:47:57,220
so when you think<font color="#E5E5E5"> about bots so when you</font>

1288
00:47:55,780 --> 00:47:58,600
think<font color="#CCCCCC"> about the threat the nature of the</font>

1289
00:47:57,220 --> 00:48:01,540
<font color="#E5E5E5">threat the thing you need</font><font color="#CCCCCC"> to keep in</font>

1290
00:47:58,600 --> 00:48:03,490
mind<font color="#E5E5E5"> is it's about</font><font color="#CCCCCC"> the Benjamins it's</font>

1291
00:48:01,540 --> 00:48:06,100
not about<font color="#E5E5E5"> d-does it's not about who's</font>

1292
00:48:03,490 --> 00:48:10,200
cool it's a business and it's a very

1293
00:48:06,100 --> 00:48:10,200
successful business that's it

