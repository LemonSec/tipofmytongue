1
00:00:10,090 --> 00:00:14,649
good morning

2
00:00:11,690 --> 00:00:14,649
arrey morning

3
00:00:15,090 --> 00:00:19,029
few words above myself i'm reporter

4
00:00:17,800 --> 00:00:23,470
etske and worked for Juniper Networks

5
00:00:19,029 --> 00:00:26,829
since 2006 five last six years here see

6
00:00:23,470 --> 00:00:31,719
in a Bay Area this presentation is about

7
00:00:26,829 --> 00:00:37,090
the techniques we know big worth

8
00:00:31,719 --> 00:00:40,030
invented who used last year to to do we

9
00:00:37,090 --> 00:00:43,120
do one of our key customer challenge

10
00:00:40,030 --> 00:00:46,899
which tends to be a how we can control

11
00:00:43,120 --> 00:00:49,980
the state explosion of best guest

12
00:00:46,899 --> 00:00:53,170
protocol sorry bottle gateway protocol

13
00:00:49,980 --> 00:00:58,678
in a specific environment

14
00:00:53,170 --> 00:00:58,679
which I would say it's a scarab drink

15
00:01:00,210 --> 00:01:07,960
so o if you have any question during the

16
00:01:04,569 --> 00:01:13,690
presentation or just break me

17
00:01:07,960 --> 00:01:16,929
I prefer interaction so the agenda is

18
00:01:13,690 --> 00:01:20,679
like first what is the environment what

19
00:01:16,930 --> 00:01:22,140
is this scale-out peering why what is

20
00:01:20,680 --> 00:01:26,290
differe

21
00:01:22,140 --> 00:01:28,750
what it is what is what is not why it's

22
00:01:26,290 --> 00:01:34,690
so specific and what are the principles

23
00:01:28,750 --> 00:01:37,060
of operation this leads us who leads us

24
00:01:34,690 --> 00:01:39,970
to the controlling challenges right so

25
00:01:37,060 --> 00:01:43,920
the BGP scale and limitation of the

26
00:01:39,970 --> 00:01:47,860
well-known common practices and finally

27
00:01:43,920 --> 00:01:52,650
to I want to share with you the solution

28
00:01:47,860 --> 00:01:55,780
or a solution for that

29
00:01:52,650 --> 00:01:58,330
with a create the construct of the

30
00:01:55,780 --> 00:02:00,580
abstract next up what it is and how the

31
00:01:58,330 --> 00:02:02,679
internal BGP architecture will look like

32
00:02:00,580 --> 00:02:07,030
when we use the abstract next abstract

33
00:02:02,680 --> 00:02:10,090
nexif is by the way my term so we can

34
00:02:07,030 --> 00:02:15,269
always change it as community over time

35
00:02:10,090 --> 00:02:15,269
and finally some configuration examples

36
00:02:16,409 --> 00:02:20,689
this is not

37
00:02:17,930 --> 00:02:23,510
fitting presentations so I would say not

38
00:02:20,689 --> 00:02:25,849
I would try to keep it very short but we

39
00:02:23,510 --> 00:02:28,159
spent more and more time on the on the

40
00:02:25,849 --> 00:02:31,238
on the devices with the screen our

41
00:02:28,159 --> 00:02:34,819
application are even if screen is dead

42
00:02:31,239 --> 00:02:37,219
like my iPhone the application are

43
00:02:34,819 --> 00:02:40,700
running in background the message is

44
00:02:37,219 --> 00:02:45,799
coming the notifications are coming so

45
00:02:40,700 --> 00:02:48,108
the bomb wave is growing especially the

46
00:02:45,799 --> 00:02:52,340
need for boundaries and also in round

47
00:02:48,109 --> 00:02:56,239
trip delay right that that is equalized

48
00:02:52,340 --> 00:02:59,989
to experience how my experience with the

49
00:02:56,239 --> 00:03:04,909
application with a with a webpage with

50
00:02:59,989 --> 00:03:07,010
the app is and this in addition to the

51
00:03:04,909 --> 00:03:09,200
fact that the consumer consumer of the

52
00:03:07,010 --> 00:03:11,569
data and producer of the data is usually

53
00:03:09,200 --> 00:03:18,409
different Network Facebook and t-mobile

54
00:03:11,569 --> 00:03:20,510
or sorry that whatever operator this

55
00:03:18,409 --> 00:03:23,448
leads to the situation where the peering

56
00:03:20,510 --> 00:03:25,790
is more dance and dance it's more points

57
00:03:23,449 --> 00:03:31,010
more connection more bandwidth needed

58
00:03:25,790 --> 00:03:33,858
and they that's that's why not only we

59
00:03:31,010 --> 00:03:36,948
are generally seeing the at least from

60
00:03:33,859 --> 00:03:39,859
place where I am up juniper networks we

61
00:03:36,949 --> 00:03:41,900
are seeing this this interest in the

62
00:03:39,859 --> 00:03:44,510
scale out architecture where we have

63
00:03:41,900 --> 00:03:47,299
good residency without extra cost

64
00:03:44,510 --> 00:03:49,578
because it's n +1 residency we can

65
00:03:47,299 --> 00:03:55,959
provide the capacity and scale the

66
00:03:49,579 --> 00:03:59,870
capacity as needed and by reducing the

67
00:03:55,959 --> 00:04:03,919
requirements for the bandwidth density

68
00:03:59,870 --> 00:04:07,370
on every elements in the network it's

69
00:04:03,919 --> 00:04:10,220
just good for for competition right it's

70
00:04:07,370 --> 00:04:13,669
easier to easier to use different

71
00:04:10,220 --> 00:04:16,220
products so what is this scale out

72
00:04:13,669 --> 00:04:20,530
peering I would I try to put this kind

73
00:04:16,220 --> 00:04:24,620
of formal definition so if we have a

74
00:04:20,529 --> 00:04:28,460
given period connected to multiple a

75
00:04:24,620 --> 00:04:30,410
autonomic system ASV ours at a given

76
00:04:28,460 --> 00:04:34,400
site

77
00:04:30,410 --> 00:04:37,190
and that's the situation when we have a

78
00:04:34,400 --> 00:04:39,650
schedule peering right we period a with

79
00:04:37,190 --> 00:04:43,969
the given P is in the scale-out manner

80
00:04:39,650 --> 00:04:47,630
and then of course the whole routing

81
00:04:43,970 --> 00:04:49,790
system is set up to enjoy the ECM PL

82
00:04:47,630 --> 00:04:53,390
downstream at the upstream of course

83
00:04:49,790 --> 00:04:55,490
there is a limits right the PAS can do

84
00:04:53,390 --> 00:05:00,080
whatever he wants with the policy but

85
00:04:55,490 --> 00:05:02,960
conceptually I'm advertising on all four

86
00:05:00,080 --> 00:05:05,409
devices down to the pier AES my network

87
00:05:02,960 --> 00:05:15,109
equally with the equal attributes and

88
00:05:05,410 --> 00:05:18,230
expect the same opposite and the scalp

89
00:05:15,110 --> 00:05:20,210
image is specific sub case or subset of

90
00:05:18,230 --> 00:05:22,790
distributed peering right we may have

91
00:05:20,210 --> 00:05:25,969
these different environments where the

92
00:05:22,790 --> 00:05:29,690
given a s is connected to to ASB ours at

93
00:05:25,970 --> 00:05:32,510
different sides or to ASB are at given

94
00:05:29,690 --> 00:05:34,550
sites connects to different here is s

95
00:05:32,510 --> 00:05:36,409
that's the distributed peering right we

96
00:05:34,550 --> 00:05:39,140
distribute the peering cloud but it is

97
00:05:36,410 --> 00:05:48,080
not scale out at least not in context of

98
00:05:39,140 --> 00:05:50,270
this presentation so if we if we have a

99
00:05:48,080 --> 00:05:52,849
peering side with this scale out peering

100
00:05:50,270 --> 00:05:55,909
model we have the bunch of IES be ours

101
00:05:52,850 --> 00:06:00,770
we just discussed that we will have also

102
00:05:55,910 --> 00:06:04,930
the set of core routers or core switches

103
00:06:00,770 --> 00:06:09,770
whatever we call it spine even that's in

104
00:06:04,930 --> 00:06:13,460
this year or last year fancy name of the

105
00:06:09,770 --> 00:06:15,260
of the core device I'll probably route

106
00:06:13,460 --> 00:06:19,880
reflectors and we will talk a little bit

107
00:06:15,260 --> 00:06:21,710
about them later and in between there is

108
00:06:19,880 --> 00:06:24,980
the need to be something which connects

109
00:06:21,710 --> 00:06:28,159
this it connects these elements in a way

110
00:06:24,980 --> 00:06:29,750
which allows me scale out peering so

111
00:06:28,160 --> 00:06:32,510
added appearing devices without

112
00:06:29,750 --> 00:06:35,300
impacting the rest of the network and in

113
00:06:32,510 --> 00:06:38,860
general it is something in between could

114
00:06:35,300 --> 00:06:42,650
be a passive network just the cables or

115
00:06:38,860 --> 00:06:43,760
some active elements so Altos which is

116
00:06:42,650 --> 00:06:46,609
the we'll see

117
00:06:43,760 --> 00:06:49,250
this example or sets of switches that's

118
00:06:46,610 --> 00:06:52,580
a little bit vintage it could be L free

119
00:06:49,250 --> 00:06:56,590
underlying network five stages clause

120
00:06:52,580 --> 00:07:01,130
it could be just pure L free device flat

121
00:06:56,590 --> 00:07:05,869
or probably there will be more

122
00:07:01,130 --> 00:07:08,620
possibilities however if we look how it

123
00:07:05,870 --> 00:07:11,510
looks from the how this behaves from the

124
00:07:08,620 --> 00:07:14,900
routing perspective how this be this

125
00:07:11,510 --> 00:07:17,480
option perhaps from the peering so

126
00:07:14,900 --> 00:07:20,419
internet routing perspective free out of

127
00:07:17,480 --> 00:07:24,010
these four ends I put the same situation

128
00:07:20,420 --> 00:07:27,290
when my core routers and they and the

129
00:07:24,010 --> 00:07:29,270
IASB ours are directly peering at layer

130
00:07:27,290 --> 00:07:31,310
3 right if we have override there are

131
00:07:29,270 --> 00:07:33,289
tunnels if we have L to switch we have

132
00:07:31,310 --> 00:07:37,880
segments if you have passive Network we

133
00:07:33,290 --> 00:07:41,210
have closed topology if we put the like

134
00:07:37,880 --> 00:07:43,490
on the bottom right side some active

135
00:07:41,210 --> 00:07:46,430
elements with the full capabilities of

136
00:07:43,490 --> 00:07:48,950
the internet routing in the middle it's

137
00:07:46,430 --> 00:07:53,150
nothing else than just bigger closed

138
00:07:48,950 --> 00:07:56,979
network so like a hierarchical core if

139
00:07:53,150 --> 00:07:59,120
you like or spines and Quarterly's

140
00:07:56,980 --> 00:08:01,130
that's a little bit back to the future

141
00:07:59,120 --> 00:08:05,450
when I draw it first time as a half hmm

142
00:08:01,130 --> 00:08:09,020
I saw this somewhere and look my CCIE

143
00:08:05,450 --> 00:08:14,210
book from 90s I say yeah yeah core

144
00:08:09,020 --> 00:08:17,900
distribution access that same but just a

145
00:08:14,210 --> 00:08:20,510
side note for the rest of the talk I

146
00:08:17,900 --> 00:08:24,890
would rather for we will talk about the

147
00:08:20,510 --> 00:08:28,520
the topology on the left upper side just

148
00:08:24,890 --> 00:08:32,659
because it's a simplest but everything

149
00:08:28,520 --> 00:08:35,150
is valid in all other cases so what are

150
00:08:32,659 --> 00:08:36,949
the common principles when we go to the

151
00:08:35,150 --> 00:08:39,409
scale-out peering right we want the

152
00:08:36,950 --> 00:08:40,190
boundary if we want right out on the

153
00:08:39,409 --> 00:08:43,098
ecmp

154
00:08:40,190 --> 00:08:46,730
so what will be impact on my network on

155
00:08:43,099 --> 00:08:49,570
my control plane you see a equal cost

156
00:08:46,730 --> 00:08:52,340
load balancing cannot ASB ours that

157
00:08:49,570 --> 00:08:56,660
implicitly means that we have to use

158
00:08:52,340 --> 00:08:57,380
best bgp multipath in some point in the

159
00:08:56,660 --> 00:09:00,050
network

160
00:08:57,380 --> 00:09:05,360
the BGP routing will be across multiple

161
00:09:00,050 --> 00:09:08,870
gateways load balancing and that scale

162
00:09:05,360 --> 00:09:11,410
up drip routing information base yeah if

163
00:09:08,870 --> 00:09:14,389
we say okay I have a half-million

164
00:09:11,410 --> 00:09:19,819
prefixes for gateways it's ultimately

165
00:09:14,389 --> 00:09:22,730
two million paths just like that the

166
00:09:19,819 --> 00:09:25,430
second we want to write on n plus one

167
00:09:22,730 --> 00:09:28,639
redundancy model right so if one fails

168
00:09:25,430 --> 00:09:32,239
we are losing only proportion of the of

169
00:09:28,639 --> 00:09:33,920
the capacity and we can over-provisioned

170
00:09:32,240 --> 00:09:36,380
like a twenty percent of twenty five

171
00:09:33,920 --> 00:09:42,189
percent instead of one plus one that's a

172
00:09:36,380 --> 00:09:44,959
big financial gain and this has to be

173
00:09:42,190 --> 00:09:48,699
the the redundancy has to cover us

174
00:09:44,959 --> 00:09:52,758
against the interiors interface failure

175
00:09:48,699 --> 00:09:54,560
also multiple session failure because we

176
00:09:52,759 --> 00:09:57,319
don't know what is on the opposite side

177
00:09:54,560 --> 00:10:02,060
on in the pas de so single failure on

178
00:09:57,319 --> 00:10:05,959
the periods can appear on my is as a

179
00:10:02,060 --> 00:10:07,989
multiple session down my ASB our failure

180
00:10:05,959 --> 00:10:14,660
and the entire site could go out

181
00:10:07,990 --> 00:10:17,120
hopefully never but then I want to scale

182
00:10:14,660 --> 00:10:19,519
out I already said it so be able to add

183
00:10:17,120 --> 00:10:23,000
additional ASB are on one side without

184
00:10:19,519 --> 00:10:25,850
impacting the other so it has obvious

185
00:10:23,000 --> 00:10:28,370
consequence across on the physical

186
00:10:25,850 --> 00:10:31,430
network if I add do i I don't want to

187
00:10:28,370 --> 00:10:35,260
add the links across the entire global

188
00:10:31,430 --> 00:10:39,219
network but also on the control plane

189
00:10:35,260 --> 00:10:43,339
I'm using the two or very few carota

190
00:10:39,220 --> 00:10:47,060
Reuters outside I can keep scaling out

191
00:10:43,339 --> 00:10:49,850
the ASB ours but scaling How Tos beers

192
00:10:47,060 --> 00:10:57,439
mean also scaling out the number of read

193
00:10:49,850 --> 00:11:01,699
of paths in the BGP and now I can say in

194
00:10:57,439 --> 00:11:04,579
this remote region somewhere in Alaska I

195
00:11:01,699 --> 00:11:06,170
have my old router right and I don't

196
00:11:04,579 --> 00:11:09,050
need to upgrade them there is enough

197
00:11:06,170 --> 00:11:10,819
capacity and enough enough interfaces

198
00:11:09,050 --> 00:11:12,738
but

199
00:11:10,819 --> 00:11:16,519
because my routing information based

200
00:11:12,739 --> 00:11:18,169
Kayla I need to upgrade hardware upgrade

201
00:11:16,519 --> 00:11:20,779
the tutor as well that's that's not what

202
00:11:18,169 --> 00:11:24,499
I want so myself network wired solution

203
00:11:20,779 --> 00:11:27,549
should isolate this scale out at the

204
00:11:24,499 --> 00:11:29,959
side from the rest of the network and

205
00:11:27,549 --> 00:11:31,699
ideally I would like to restore the

206
00:11:29,959 --> 00:11:37,789
traffic in seconds rather than in tens

207
00:11:31,699 --> 00:11:42,769
of minutes that's a general call to

208
00:11:37,789 --> 00:11:45,470
avoid or try to mitigate situation when

209
00:11:42,769 --> 00:11:48,559
my convergence of network is really

210
00:11:45,470 --> 00:11:51,829
dependent on the traffic spur path we

211
00:11:48,559 --> 00:11:53,358
draw our entry advertisement it would be

212
00:11:51,829 --> 00:12:02,508
much better if we can do this in the

213
00:11:53,359 --> 00:12:07,039
bulk so that's what we want and how this

214
00:12:02,509 --> 00:12:10,069
how the traditional typical BGP design

215
00:12:07,039 --> 00:12:12,319
will deal with that first look at the

216
00:12:10,069 --> 00:12:15,488
scale and if I have the network of 40

217
00:12:12,319 --> 00:12:19,248
sides for ASB ours to route reflectors

218
00:12:15,489 --> 00:12:20,959
each asbr gets from Piraeus to help me

219
00:12:19,249 --> 00:12:23,419
on traffic's it's not that much only

220
00:12:20,959 --> 00:12:27,228
half of it is active because the other

221
00:12:23,419 --> 00:12:29,749
half is better from the other exits one

222
00:12:27,229 --> 00:12:31,970
million active prefixes is also not out

223
00:12:29,749 --> 00:12:33,769
of the rich looking globally on the

224
00:12:31,970 --> 00:12:37,549
network it means that the network lanced

225
00:12:33,769 --> 00:12:42,889
eight million paths and we have globally

226
00:12:37,549 --> 00:12:45,589
we have 80 path / traffic's if I want to

227
00:12:42,889 --> 00:12:47,959
use the ecmp I need the add path if I do

228
00:12:45,589 --> 00:12:49,929
the crazy up of 80 I don't know if

229
00:12:47,959 --> 00:12:53,059
everything hard work and do that but

230
00:12:49,929 --> 00:12:57,289
that leads to the situation when I have

231
00:12:53,059 --> 00:13:00,439
like 80 path out of it for maybe eight

232
00:12:57,289 --> 00:13:02,689
is active another for maybe eight is my

233
00:13:00,439 --> 00:13:05,539
backup or second path the best path if

234
00:13:02,689 --> 00:13:08,419
you use something like BGP peak but 80%

235
00:13:05,539 --> 00:13:11,720
of this information is just not needed

236
00:13:08,419 --> 00:13:14,689
it's not primary it's not backup why to

237
00:13:11,720 --> 00:13:17,359
keep it across the network and this the

238
00:13:14,689 --> 00:13:18,049
BGP without without half buff is doing

239
00:13:17,359 --> 00:13:19,970
this nicely

240
00:13:18,049 --> 00:13:22,579
just select the best active path and

241
00:13:19,970 --> 00:13:24,830
that's it but if you do the add path for

242
00:13:22,579 --> 00:13:27,859
the multipath ecmp well boss

243
00:13:24,830 --> 00:13:31,640
we have this challenge the other thing

244
00:13:27,860 --> 00:13:35,000
we cannot forget is that we have limited

245
00:13:31,640 --> 00:13:38,540
control of what our purine KS is doing

246
00:13:35,000 --> 00:13:40,610
all right it we assume they advertise

247
00:13:38,540 --> 00:13:44,150
all prefixes on all links because they

248
00:13:40,610 --> 00:13:47,750
also did these my periods also like to

249
00:13:44,150 --> 00:13:52,400
use the ecmp characteristics but people

250
00:13:47,750 --> 00:13:56,210
make mistakes and policies always could

251
00:13:52,400 --> 00:13:59,390
be put there for whatever reason so it

252
00:13:56,210 --> 00:14:07,040
could happen that some of prefixes

253
00:13:59,390 --> 00:14:08,960
doesn't exist on every laser on every on

254
00:14:07,040 --> 00:14:11,750
every session on every asbr

255
00:14:08,960 --> 00:14:15,320
and this leads to some trade-off right

256
00:14:11,750 --> 00:14:17,090
either we need to be have to something

257
00:14:15,320 --> 00:14:20,270
smart and deep in the network like a

258
00:14:17,090 --> 00:14:23,450
core router which is able to do the full

259
00:14:20,270 --> 00:14:26,840
IP lookup and knows where to send its

260
00:14:23,450 --> 00:14:31,190
the ICMP over free for the prefix number

261
00:14:26,840 --> 00:14:35,030
two or we have to agree on some some

262
00:14:31,190 --> 00:14:37,580
suboptimal routing inside in on the

263
00:14:35,030 --> 00:14:40,310
egress side when one asbr will drop the

264
00:14:37,580 --> 00:14:42,770
traffic to another area I believe that

265
00:14:40,310 --> 00:14:45,650
the optimal routing is d our goal this

266
00:14:42,770 --> 00:14:49,730
is the way how we control the cost so

267
00:14:45,650 --> 00:14:53,329
and latency so that that's the

268
00:14:49,730 --> 00:14:56,210
underlying decision was what we go with

269
00:14:53,330 --> 00:14:58,400
and by the way the customer we work on

270
00:14:56,210 --> 00:15:00,830
with that who triggers did that work

271
00:14:58,400 --> 00:15:09,709
anyway is doing IP routing on every

272
00:15:00,830 --> 00:15:12,050
device so and finally if my peer a s is

273
00:15:09,710 --> 00:15:14,330
doing the same as I'm doing so going

274
00:15:12,050 --> 00:15:19,120
scale out the number of session will

275
00:15:14,330 --> 00:15:19,120
draw come on

276
00:15:19,910 --> 00:15:26,540
so we will have to reduce the number of

277
00:15:24,380 --> 00:15:29,300
BGP paths across the network we will

278
00:15:26,540 --> 00:15:33,849
need to have ecmp and these two are kind

279
00:15:29,300 --> 00:15:37,550
of contradiction Airi requirements and

280
00:15:33,850 --> 00:15:39,470
enable some fast convergence ii or

281
00:15:37,550 --> 00:15:43,459
subsequent restoration sub-second maybe

282
00:15:39,470 --> 00:15:47,410
it's this is what we almost achieved in

283
00:15:43,460 --> 00:15:50,000
the in the particular scenario but a

284
00:15:47,410 --> 00:15:55,219
restoration of traffic in seconds not in

285
00:15:50,000 --> 00:16:01,040
tens of minutes that that's what what we

286
00:15:55,220 --> 00:16:02,990
try what we can achieve here and to go

287
00:16:01,040 --> 00:16:05,449
deeper into this solution this will be

288
00:16:02,990 --> 00:16:07,670
my reference network with is some naming

289
00:16:05,450 --> 00:16:09,410
convention where the there is a role

290
00:16:07,670 --> 00:16:15,410
there is a site and there is a number of

291
00:16:09,410 --> 00:16:19,310
device outside on the entire network is

292
00:16:15,410 --> 00:16:21,620
doing i-95 P forwarding we have the

293
00:16:19,310 --> 00:16:23,569
route reflector which are connected in

294
00:16:21,620 --> 00:16:25,910
two full meshes so the first route

295
00:16:23,570 --> 00:16:29,680
reflector at given site in full mesh

296
00:16:25,910 --> 00:16:33,199
with first reflector on all other sides

297
00:16:29,680 --> 00:16:35,839
road reflectors are running multipath

298
00:16:33,200 --> 00:16:39,050
and ad path would be with their clients

299
00:16:35,840 --> 00:16:41,630
so the core routers and ASB ours toward

300
00:16:39,050 --> 00:16:44,630
other route reflectors out of sight will

301
00:16:41,630 --> 00:16:48,470
advertise only single a single path just

302
00:16:44,630 --> 00:16:50,840
to prevent the situation when our 80

303
00:16:48,470 --> 00:16:54,440
million path goes across this entire net

304
00:16:50,840 --> 00:16:57,020
system asbr

305
00:16:54,440 --> 00:17:00,020
except the multi path except up at part

306
00:16:57,020 --> 00:17:01,640
from reflector but when it speaks to

307
00:17:00,020 --> 00:17:09,439
route refer to route reflector it

308
00:17:01,640 --> 00:17:12,589
advertised only best the best route so

309
00:17:09,439 --> 00:17:14,750
the first typical the deployment we have

310
00:17:12,589 --> 00:17:16,730
today is using next up self how many

311
00:17:14,750 --> 00:17:21,260
network is using Maxwell of your network

312
00:17:16,730 --> 00:17:23,810
is using max of self just to free okay

313
00:17:21,260 --> 00:17:25,550
for five good

314
00:17:23,810 --> 00:17:27,649
[Laughter]

315
00:17:25,550 --> 00:17:31,710
[Music]

316
00:17:27,650 --> 00:17:34,040
with that before either failure happen

317
00:17:31,710 --> 00:17:37,350
everything is perfect I just want to

318
00:17:34,040 --> 00:17:42,450
highlight that the core router has the

319
00:17:37,350 --> 00:17:46,500
four paths - for local exits and all the

320
00:17:42,450 --> 00:17:50,310
next hubs are duplex of the SBR 1.1 up

321
00:17:46,500 --> 00:18:00,200
to the asbr 1.4 and all these lubis are

322
00:17:50,310 --> 00:18:03,060
in IGP so what happen if this link fails

323
00:18:00,200 --> 00:18:07,770
all four route backs are still in IDP

324
00:18:03,060 --> 00:18:10,350
and asbr 1.1 the one it which is

325
00:18:07,770 --> 00:18:12,450
impacted obviously will withdraw the

326
00:18:10,350 --> 00:18:14,280
routes will send a withdraw out to the

327
00:18:12,450 --> 00:18:18,230
route reflector for half million it

328
00:18:14,280 --> 00:18:21,090
takes some time tens of second minutes

329
00:18:18,230 --> 00:18:23,820
depending on the hardware right and what

330
00:18:21,090 --> 00:18:25,620
else is going on in the network route

331
00:18:23,820 --> 00:18:28,350
reflector reflects this information back

332
00:18:25,620 --> 00:18:30,810
to the core routers and the Carothers

333
00:18:28,350 --> 00:18:37,280
remove the path and updates their feet

334
00:18:30,810 --> 00:18:40,200
which takes another X minutes and then

335
00:18:37,280 --> 00:18:43,530
Reuters add other sides may need to do

336
00:18:40,200 --> 00:18:47,000
exactly the same thing right if this

337
00:18:43,530 --> 00:18:50,040
path particular path was the one chosen

338
00:18:47,000 --> 00:18:53,190
as a best from route reflector probably

339
00:18:50,040 --> 00:19:01,159
based on the route ID then these change

340
00:18:53,190 --> 00:19:07,430
this chain need to be propagated okay so

341
00:19:01,160 --> 00:19:12,450
maybe using the except unchanged is the

342
00:19:07,430 --> 00:19:15,660
better behavior but in this case again

343
00:19:12,450 --> 00:19:17,940
we have for next hops because of the

344
00:19:15,660 --> 00:19:20,520
passive interface passive IGP on the

345
00:19:17,940 --> 00:19:22,320
external interfaces all negative for

346
00:19:20,520 --> 00:19:25,560
next cops are reachable through the IGP

347
00:19:22,320 --> 00:19:30,050
on the core routers and the failure is a

348
00:19:25,560 --> 00:19:30,050
session down not interface now

349
00:19:30,830 --> 00:19:36,870
unfortunately next hop stays in the IGP

350
00:19:33,570 --> 00:19:38,689
and the story repeats we have to

351
00:19:36,870 --> 00:19:43,599
withdraw all half-million perfect

352
00:19:38,690 --> 00:19:43,599
or whatever the number is it takes time

353
00:19:44,080 --> 00:19:49,220
you may say it's overkill how it happens

354
00:19:47,989 --> 00:19:51,590
that the session goes down and

355
00:19:49,220 --> 00:19:53,359
interfaces up it could if you have a

356
00:19:51,590 --> 00:19:59,749
switch in between if you have some old

357
00:19:53,359 --> 00:20:02,478
DWDM system in between but even we have

358
00:19:59,749 --> 00:20:10,899
a situation when actually interface will

359
00:20:02,479 --> 00:20:10,899
go down the the mechanics is that

360
00:20:12,220 --> 00:20:18,349
traffic at site free will be move it to

361
00:20:16,340 --> 00:20:21,678
the sub optimal path all right because

362
00:20:18,349 --> 00:20:24,289
the next hop is removed and the route

363
00:20:21,679 --> 00:20:26,419
reflectors and core routers and the ASB

364
00:20:24,289 --> 00:20:28,429
are outside or whatever edge routers on

365
00:20:26,419 --> 00:20:33,109
the site number free buy some time

366
00:20:28,429 --> 00:20:34,820
running which has invalid BGP path with

367
00:20:33,109 --> 00:20:38,029
the unresolvable neck scope so they will

368
00:20:34,820 --> 00:20:39,590
select the another one and I said that

369
00:20:38,029 --> 00:20:41,960
before that the route reflectors

370
00:20:39,590 --> 00:20:46,609
propagate only one best path out of

371
00:20:41,960 --> 00:20:48,619
their sight so from site to free the

372
00:20:46,609 --> 00:20:51,619
alternative path is free here site two

373
00:20:48,619 --> 00:20:53,209
and then of course there is a BGP

374
00:20:51,619 --> 00:20:55,428
conversion as we draw all updates

375
00:20:53,210 --> 00:20:58,190
etcetera so traffic loop comes back to

376
00:20:55,429 --> 00:21:02,690
site one because it's closer on in the

377
00:20:58,190 --> 00:21:06,259
IGP but we have these traffic shifts not

378
00:21:02,690 --> 00:21:10,999
nice this could be avoided if we run the

379
00:21:06,259 --> 00:21:13,849
ad path between sites but then is a cost

380
00:21:10,999 --> 00:21:17,119
which we try to reduce right the scale

381
00:21:13,849 --> 00:21:21,379
of the BGP routing routing information

382
00:21:17,119 --> 00:21:23,509
base and it's not only the memory but

383
00:21:21,379 --> 00:21:26,809
it's also the time of the cold start up

384
00:21:23,509 --> 00:21:29,440
right when we start from scratch it's

385
00:21:26,809 --> 00:21:33,190
four times more information to be

386
00:21:29,440 --> 00:21:35,629
carried between sites it's also

387
00:21:33,190 --> 00:21:39,109
challenged with the chair next order

388
00:21:35,629 --> 00:21:41,719
because we have four paths and if forth

389
00:21:39,109 --> 00:21:43,789
best path or third best path is flapping

390
00:21:41,720 --> 00:21:45,200
it doesn't really change anything in the

391
00:21:43,789 --> 00:21:47,809
network but we have to propagate this

392
00:21:45,200 --> 00:21:52,400
information and consume resources CPU

393
00:21:47,809 --> 00:21:57,770
resources okay

394
00:21:52,400 --> 00:22:08,570
I think the most interesting part come

395
00:21:57,770 --> 00:22:11,059
on okay the solution is based on the

396
00:22:08,570 --> 00:22:14,659
construct called I called abstract next

397
00:22:11,059 --> 00:22:17,870
hub so first of all this is not a change

398
00:22:14,660 --> 00:22:21,530
to BGP there is no protocol change we

399
00:22:17,870 --> 00:22:23,719
use exactly the same old BGP protocol in

400
00:22:21,530 --> 00:22:26,389
terms of the how we encapsulate the

401
00:22:23,720 --> 00:22:29,570
frames in terms of what is the semantics

402
00:22:26,390 --> 00:22:31,730
of every attribute and in terms of the

403
00:22:29,570 --> 00:22:35,840
BGP selection algorithm no changes to be

404
00:22:31,730 --> 00:22:41,390
deep in the abstract next hope is a

405
00:22:35,840 --> 00:22:47,030
slash 30 33 32 33 would be or / 128

406
00:22:41,390 --> 00:22:50,360
obviously address which is set as a BGP

407
00:22:47,030 --> 00:22:53,600
next hope in the advertisement if the

408
00:22:50,360 --> 00:22:58,030
advertisement is if the path was learned

409
00:22:53,600 --> 00:23:01,428
from one out of the set of BGP session

410
00:22:58,030 --> 00:23:05,030
right so this is like option two group

411
00:23:01,429 --> 00:23:08,500
couple of BGP sessions and say okay fine

412
00:23:05,030 --> 00:23:11,299
if if at least one of them is

413
00:23:08,500 --> 00:23:13,820
advertising these prefix I will keep

414
00:23:11,299 --> 00:23:15,470
using these as a BGP Naxal so it's a

415
00:23:13,820 --> 00:23:18,590
little bit similar to the loop the next

416
00:23:15,470 --> 00:23:22,220
up self right we change the next one but

417
00:23:18,590 --> 00:23:25,600
at the same time these these abstract

418
00:23:22,220 --> 00:23:29,630
address this this address is in my AGP

419
00:23:25,600 --> 00:23:31,490
advertise to I GP conditionally only if

420
00:23:29,630 --> 00:23:33,500
at least one session is up and running

421
00:23:31,490 --> 00:23:35,630
if the session goes that what all

422
00:23:33,500 --> 00:23:39,770
session in group goes down I remove the

423
00:23:35,630 --> 00:23:42,200
next up from the AGP and what is this

424
00:23:39,770 --> 00:23:44,150
add a subset of session which is

425
00:23:42,200 --> 00:23:45,919
associated with the abstract next shop

426
00:23:44,150 --> 00:23:49,100
it's up to you it's a part of this

427
00:23:45,919 --> 00:23:52,970
network design it could be all session

428
00:23:49,100 --> 00:23:58,610
from even asbr with the same period but

429
00:23:52,970 --> 00:24:01,760
it could be also set of the session on

430
00:23:58,610 --> 00:24:04,040
given a guess BR with the all transit

431
00:24:01,760 --> 00:24:05,629
providers then the abstract next so we

432
00:24:04,040 --> 00:24:07,730
oh there is a where

433
00:24:05,630 --> 00:24:11,330
through the transit provider or it could

434
00:24:07,730 --> 00:24:15,470
be a set of session from given side with

435
00:24:11,330 --> 00:24:18,500
given period all right so we up we say

436
00:24:15,470 --> 00:24:20,930
doesn't matter which of asbr sat outside

437
00:24:18,500 --> 00:24:24,410
has the active session with the given

438
00:24:20,930 --> 00:24:29,210
period at least one is there we keep

439
00:24:24,410 --> 00:24:31,700
advertising these DS as a as a BGP next

440
00:24:29,210 --> 00:24:34,580
attribute concept is very generic and

441
00:24:31,700 --> 00:24:37,220
there could be also other use of them I

442
00:24:34,580 --> 00:24:42,889
just working on some other use of the

443
00:24:37,220 --> 00:24:45,920
abstract next job but let's see how this

444
00:24:42,890 --> 00:24:49,910
would work in our example network right

445
00:24:45,920 --> 00:24:53,360
first look in the inter side how big how

446
00:24:49,910 --> 00:24:56,150
this will behave between ASPRS

447
00:24:53,360 --> 00:24:58,639
Carruthers and route reflectors and for

448
00:24:56,150 --> 00:25:01,880
this example the abstract next-hop

449
00:24:58,640 --> 00:25:07,310
represent the all sessions with the a s2

450
00:25:01,880 --> 00:25:08,000
s2 is on the bottom right from given

451
00:25:07,310 --> 00:25:11,000
asbr

452
00:25:08,000 --> 00:25:14,630
so each ASB are therefore the IP address

453
00:25:11,000 --> 00:25:19,490
the i would be specific and unique for D

454
00:25:14,630 --> 00:25:23,630
my I guess B R and P Reyes I call it a

455
00:25:19,490 --> 00:25:28,130
PA up abstract Mexico a ESB are PAP

456
00:25:23,630 --> 00:25:31,910
raised specifically abstract Mexico so

457
00:25:28,130 --> 00:25:35,900
with that each is BR advertised the one

458
00:25:31,910 --> 00:25:39,140
path to the prefix to with the next hope

459
00:25:35,900 --> 00:25:41,870
BGP neck subset to abstract value

460
00:25:39,140 --> 00:25:44,600
associated with the advertising pays BR

461
00:25:41,870 --> 00:25:48,050
as you see on the picture so abstract

462
00:25:44,600 --> 00:25:52,240
next hop 1.1 underscore two if the pas

463
00:25:48,050 --> 00:25:55,310
is to underscore free if the pas is free

464
00:25:52,240 --> 00:25:58,070
under and then the route reflectors are

465
00:25:55,310 --> 00:26:00,620
doing now doing the rather attachment to

466
00:25:58,070 --> 00:26:04,460
the core routers and they are doing that

467
00:26:00,620 --> 00:26:08,389
with the ad path so all four paths are

468
00:26:04,460 --> 00:26:12,200
reachable are visible to the to the core

469
00:26:08,390 --> 00:26:15,320
router actually the good idea is to have

470
00:26:12,200 --> 00:26:19,390
one more path and we'll see later when

471
00:26:15,320 --> 00:26:19,389
it comes to comes to play

472
00:26:22,400 --> 00:26:28,380
having that information corroder can

473
00:26:25,350 --> 00:26:31,980
load balanced traffic address traffic

474
00:26:28,380 --> 00:26:35,820
address egress downstream traffic across

475
00:26:31,980 --> 00:26:40,020
all for ASB ours in the example so how

476
00:26:35,820 --> 00:26:42,210
this will behalf in the in the failure

477
00:26:40,020 --> 00:26:47,879
scenario the first simple failure

478
00:26:42,210 --> 00:26:54,990
come on it's a one session between a s2

479
00:26:47,880 --> 00:26:56,850
and asbr 1.1 and in this case between X

480
00:26:54,990 --> 00:27:02,010
hub would not change right because we

481
00:26:56,850 --> 00:27:06,689
have another session there is no need to

482
00:27:02,010 --> 00:27:08,670
send update to root reflector this is

483
00:27:06,690 --> 00:27:11,700
more like an ex-cop self to do global

484
00:27:08,670 --> 00:27:17,610
the same the rest of the network will

485
00:27:11,700 --> 00:27:20,370
not see much here the next could be ok

486
00:27:17,610 --> 00:27:24,179
what if I don't have a second session so

487
00:27:20,370 --> 00:27:25,320
the example now is I guess a is free the

488
00:27:24,180 --> 00:27:29,400
end asbr

489
00:27:25,320 --> 00:27:33,350
1.2 we lose the session this is only

490
00:27:29,400 --> 00:27:38,670
session to a debt is BR to das free

491
00:27:33,350 --> 00:27:43,550
therefore bgp NEX hub has to be removed

492
00:27:38,670 --> 00:27:43,550
from I GP when it's removed from I GP

493
00:27:44,480 --> 00:27:53,760
the core rotor immediately sees it

494
00:27:48,980 --> 00:27:56,160
immediately is everything has time but

495
00:27:53,760 --> 00:28:00,170
it's much faster it so one operation in

496
00:27:56,160 --> 00:28:03,750
the IES is all in OSPF all right and

497
00:28:00,170 --> 00:28:07,770
based on that d one of for path used

498
00:28:03,750 --> 00:28:10,380
beef previously by by corroder

499
00:28:07,770 --> 00:28:13,770
is not valid anymore and so one

500
00:28:10,380 --> 00:28:16,680
operation with triggers local local

501
00:28:13,770 --> 00:28:19,200
local convergence or local path

502
00:28:16,680 --> 00:28:23,310
selection on the core router without

503
00:28:19,200 --> 00:28:27,000
need of propagating BGP updates and

504
00:28:23,310 --> 00:28:28,740
withdrawals and if these device has

505
00:28:27,000 --> 00:28:31,290
something prep program it in the field

506
00:28:28,740 --> 00:28:32,470
and it's possible to do this even in sub

507
00:28:31,290 --> 00:28:33,639
seconds for the

508
00:28:32,470 --> 00:28:39,850
hundreds of thousands of millions

509
00:28:33,640 --> 00:28:45,390
prefixes another example what if we lose

510
00:28:39,850 --> 00:28:51,280
all session between asbr 1.1 and as2

511
00:28:45,390 --> 00:28:53,470
david out the abstract next hope now is

512
00:28:51,280 --> 00:28:57,250
has to be removed from IGP because there

513
00:28:53,470 --> 00:29:00,730
is no more session on a SBR one with pas

514
00:28:57,250 --> 00:29:03,160
- and the story repeats right we just

515
00:29:00,730 --> 00:29:06,940
remove the next up from IGP these

516
00:29:03,160 --> 00:29:13,320
triggers the local fixing on the on the

517
00:29:06,940 --> 00:29:18,190
core routers and rest of the network and

518
00:29:13,320 --> 00:29:20,649
a final doom day we lose all we lose all

519
00:29:18,190 --> 00:29:25,570
sessions on all days be ours with the

520
00:29:20,650 --> 00:29:29,200
as2 of course all bgp NEX have become

521
00:29:25,570 --> 00:29:33,310
unreachable in the out sorry in the is

522
00:29:29,200 --> 00:29:36,700
is or IGP and corroder just removes the

523
00:29:33,310 --> 00:29:38,620
four of them now the fifth path become

524
00:29:36,700 --> 00:29:43,720
interesting because corroder can send

525
00:29:38,620 --> 00:29:46,419
traffic to other exit at other site with

526
00:29:43,720 --> 00:29:49,150
all these failures after the fixing

527
00:29:46,420 --> 00:29:51,400
happens and traffic is restored there is

528
00:29:49,150 --> 00:29:54,490
a normal BGP conversion there is a

529
00:29:51,400 --> 00:29:57,880
withdrawal there is a tough updates but

530
00:29:54,490 --> 00:30:09,730
they are but our traffic restoration do

531
00:29:57,880 --> 00:30:13,420
not depends on that time so what if we

532
00:30:09,730 --> 00:30:17,320
just stop here we'll see that the all

533
00:30:13,420 --> 00:30:20,380
for may s be ours are visible across the

534
00:30:17,320 --> 00:30:23,320
entire network and we have the same

535
00:30:20,380 --> 00:30:25,660
challenge as before with the fact that

536
00:30:23,320 --> 00:30:29,710
we have only one update going out of my

537
00:30:25,660 --> 00:30:32,910
site to another size we have to renew it

538
00:30:29,710 --> 00:30:37,030
send the update within new BGP next hub

539
00:30:32,910 --> 00:30:39,550
so let's make the another step of

540
00:30:37,030 --> 00:30:42,220
abstraction and whenever the update is

541
00:30:39,550 --> 00:30:44,260
leaving my side let's change the BGP

542
00:30:42,220 --> 00:30:46,419
next hub to another abstract address

543
00:30:44,260 --> 00:30:50,830
which now will represent

544
00:30:46,419 --> 00:30:54,609
not all session per asbr but all session

545
00:30:50,830 --> 00:30:58,090
of all ASB ours as a set and you can

546
00:30:54,609 --> 00:31:01,559
easily find two things right that first

547
00:30:58,090 --> 00:31:04,749
of all we advertise only one path

548
00:31:01,559 --> 00:31:07,869
regardless of number of the ASB are sat

549
00:31:04,749 --> 00:31:10,149
side which is good because this reduce

550
00:31:07,869 --> 00:31:15,309
the scale on the on the network wide

551
00:31:10,149 --> 00:31:19,119
scale and second it doesn't change if

552
00:31:15,309 --> 00:31:28,480
one of the ASB ARS lose his connectivity

553
00:31:19,119 --> 00:31:32,080
with the neighboring areas and again the

554
00:31:28,480 --> 00:31:36,700
how this operates under the failure the

555
00:31:32,080 --> 00:31:38,949
single single session fail there is no

556
00:31:36,700 --> 00:31:42,220
withdrawal at all right no update at all

557
00:31:38,950 --> 00:31:50,049
next Club doesn't change if we lose two

558
00:31:42,220 --> 00:31:55,330
sessions to from the if we lose two

559
00:31:50,049 --> 00:31:57,940
sessions from asbr 1.1 there is a there

560
00:31:55,330 --> 00:32:01,379
is a removal of the abstract next up

561
00:31:57,940 --> 00:32:08,139
which is specific to SBR 1.1 inside the

562
00:32:01,379 --> 00:32:10,928
inter inter side but from the inter-site

563
00:32:08,139 --> 00:32:13,359
update the next sub doesn't change so

564
00:32:10,929 --> 00:32:20,080
there is no need to do anything out of

565
00:32:13,359 --> 00:32:22,418
the out of the given side one note there

566
00:32:20,080 --> 00:32:24,158
could be and there is a possibility that

567
00:32:22,419 --> 00:32:26,529
the object need to be signed because our

568
00:32:24,159 --> 00:32:28,720
janitor ID change for example but

569
00:32:26,529 --> 00:32:34,059
because the BGP next hop is not

570
00:32:28,720 --> 00:32:39,489
unchanged there is no need to do any fit

571
00:32:34,059 --> 00:32:44,279
programming or fifth chain jizz um and

572
00:32:39,489 --> 00:32:44,279
if we lose this all session with a s2

573
00:32:49,070 --> 00:32:59,129
like that then of obviously we have to

574
00:32:54,090 --> 00:33:04,080
read we draw the this site-specific or

575
00:32:59,130 --> 00:33:06,660
site pas specific BGP next-hop abstract

576
00:33:04,080 --> 00:33:12,600
next up from ID from good network quite

577
00:33:06,660 --> 00:33:18,360
IGP and that force us to use the backup

578
00:33:12,600 --> 00:33:22,379
exit so what would be the results from

579
00:33:18,360 --> 00:33:25,709
the scale perspective and in same

580
00:33:22,380 --> 00:33:28,380
network with the same environment the CR

581
00:33:25,710 --> 00:33:30,270
needs to handle between two and five to

582
00:33:28,380 --> 00:33:33,059
ten million path that depends a little

583
00:33:30,270 --> 00:33:35,309
bit how many what is the ECM p on the

584
00:33:33,059 --> 00:33:39,629
one side of your network so in most

585
00:33:35,309 --> 00:33:42,120
cases it would be 2.5 million not 80 on

586
00:33:39,630 --> 00:33:45,059
a ASPRS we need like a three million

587
00:33:42,120 --> 00:33:48,780
path maybe ten million in very worst

588
00:33:45,059 --> 00:33:51,690
case scenario where five other remote

589
00:33:48,780 --> 00:33:55,590
sites are equal or in equal cost right

590
00:33:51,690 --> 00:33:58,500
so rather I don't know network which

591
00:33:55,590 --> 00:34:00,780
gives me that characteristics that five

592
00:33:58,500 --> 00:34:06,030
remote sites are in equal cost from me

593
00:34:00,780 --> 00:34:09,869
so I do the ecmp that way but we may

594
00:34:06,030 --> 00:34:12,810
save like eighty percent of the of the

595
00:34:09,869 --> 00:34:15,179
path this part which I previously said

596
00:34:12,810 --> 00:34:20,580
it's like it's never used it's unneeded

597
00:34:15,179 --> 00:34:24,090
in not propagated we have quite good

598
00:34:20,580 --> 00:34:27,540
ecmp right if we if we are going to

599
00:34:24,090 --> 00:34:31,770
reach something out of my out of my side

600
00:34:27,540 --> 00:34:36,629
and we can may have may we may have up

601
00:34:31,770 --> 00:34:40,619
to 24 ways right we did at par 5 all

602
00:34:36,629 --> 00:34:44,219
right so provided that these site to two

603
00:34:40,619 --> 00:34:45,179
side six are in ecmp there they are in

604
00:34:44,219 --> 00:34:50,399
the same cost

605
00:34:45,179 --> 00:34:52,290
iid P cost from site one we spray the

606
00:34:50,399 --> 00:34:55,138
traffic coming at site one we spray

607
00:34:52,290 --> 00:34:58,800
among three core planes in this example

608
00:34:55,139 --> 00:35:01,380
and then each Corp lines when delivered

609
00:34:58,800 --> 00:35:02,339
to egress site is spread over for ASB

610
00:35:01,380 --> 00:35:06,269
ours

611
00:35:02,339 --> 00:35:11,279
and then this is pray these girls to the

612
00:35:06,269 --> 00:35:14,308
PAS opposite is a four-way because

613
00:35:11,279 --> 00:35:18,289
that's what we if the egg race is local

614
00:35:14,309 --> 00:35:18,289
to site one we have four aggressors and

615
00:35:18,619 --> 00:35:25,890
finally the configuration so this is an

616
00:35:22,440 --> 00:35:28,710
example of Juno's we have these quite

617
00:35:25,890 --> 00:35:32,879
specific construct here just to for

618
00:35:28,710 --> 00:35:35,519
convenience under egress de we can give

619
00:35:32,880 --> 00:35:39,359
the IP address that's exactly address

620
00:35:35,519 --> 00:35:42,209
used by um this is the address of

621
00:35:39,359 --> 00:35:45,950
abstract next hub and this is a part of

622
00:35:42,210 --> 00:35:49,680
BGP configuration so this address is

623
00:35:45,950 --> 00:35:53,549
inserted in the routing table as as a

624
00:35:49,680 --> 00:35:57,859
family ARP only if we have at least made

625
00:35:53,549 --> 00:36:01,170
at least one neighbor up and running

626
00:35:57,859 --> 00:36:04,170
most precisely is in established state

627
00:36:01,170 --> 00:36:06,479
and we already receive end of end of RIP

628
00:36:04,170 --> 00:36:11,609
marker so we even know that it's

629
00:36:06,479 --> 00:36:13,919
converged and then of course this this

630
00:36:11,609 --> 00:36:16,229
address need this address needs to be

631
00:36:13,920 --> 00:36:21,569
liquid into the into IGP this is a

632
00:36:16,229 --> 00:36:25,078
simple policy and that's it so as a

633
00:36:21,569 --> 00:36:31,259
result we see the abstract next op 1 1 1

634
00:36:25,079 --> 00:36:34,739
2 in the is is in this case ID repealing

635
00:36:31,259 --> 00:36:37,739
state database and in bgp update when

636
00:36:34,739 --> 00:36:41,700
the ASB are advertised the prefix 100

637
00:36:37,739 --> 00:36:49,109
50000 search 24 the next hop is set to

638
00:36:41,700 --> 00:36:53,339
abstract value I try to make it also for

639
00:36:49,109 --> 00:36:56,940
iOS XR and it's almost possible without

640
00:36:53,339 --> 00:37:03,029
this special knob it's almost possible

641
00:36:56,940 --> 00:37:05,190
because but it's possible with iOS XE so

642
00:37:03,029 --> 00:37:07,829
the idea is that the abstract next hop

643
00:37:05,190 --> 00:37:09,960
address would be a static route title to

644
00:37:07,829 --> 00:37:13,170
the interface and the next hub which is

645
00:37:09,960 --> 00:37:16,170
the IP address this 11 1 1 1 11 1 105

646
00:37:13,170 --> 00:37:19,500
its IP address of my remote peer

647
00:37:16,170 --> 00:37:22,710
external appear so if the interface goes

648
00:37:19,500 --> 00:37:26,330
down or the arp resolution for the peer

649
00:37:22,710 --> 00:37:30,750
go away also this static route go away

650
00:37:26,330 --> 00:37:32,069
then we need to read vert ice these into

651
00:37:30,750 --> 00:37:36,180
the IGP

652
00:37:32,070 --> 00:37:40,560
and here is a trick right I can do that

653
00:37:36,180 --> 00:37:42,600
but the fact that pure the address of

654
00:37:40,560 --> 00:37:46,590
peer is reachable doesn't mean that the

655
00:37:42,600 --> 00:37:50,549
bgp session is up and running and the

656
00:37:46,590 --> 00:37:52,140
only way I found to mimic that is okay I

657
00:37:50,550 --> 00:37:55,830
know that this session should make it

658
00:37:52,140 --> 00:37:58,710
should give me some leading prefix in my

659
00:37:55,830 --> 00:38:01,920
case is fifty fifty seven fifty seven

660
00:37:58,710 --> 00:38:03,810
one one so if I get that from the from

661
00:38:01,920 --> 00:38:05,730
the session I know this session is up so

662
00:38:03,810 --> 00:38:07,950
this is a condition the condition here

663
00:38:05,730 --> 00:38:10,680
you can simplify that remove this

664
00:38:07,950 --> 00:38:12,689
condition and say okay if the interface

665
00:38:10,680 --> 00:38:14,339
is apt and the abstract neck scope is up

666
00:38:12,690 --> 00:38:18,360
the rest is the same

667
00:38:14,340 --> 00:38:22,080
right bgp update is setting these are

668
00:38:18,360 --> 00:38:25,380
these abstract abstract next hop address

669
00:38:22,080 --> 00:38:30,060
as a BGP next hop and the logic is

670
00:38:25,380 --> 00:38:32,490
exactly the same and finally third

671
00:38:30,060 --> 00:38:34,620
example is again from Geno's I'm a

672
00:38:32,490 --> 00:38:38,810
little bit more familiar but you

673
00:38:34,620 --> 00:38:42,630
remember I said it would be good to

674
00:38:38,810 --> 00:38:44,910
represent to change make another level

675
00:38:42,630 --> 00:38:51,840
of abstraction when we when we advertise

676
00:38:44,910 --> 00:38:54,890
out of the site right so now we we

677
00:38:51,840 --> 00:38:58,980
create the static route which is this

678
00:38:54,890 --> 00:39:01,290
side space side peer specific abstract

679
00:38:58,980 --> 00:39:06,660
next hop and we will advertise it back

680
00:39:01,290 --> 00:39:12,480
to is is on the SB ours only if I have

681
00:39:06,660 --> 00:39:19,020
this specific a ESB ours is BR ax NH in

682
00:39:12,480 --> 00:39:25,640
the in the routing table so if we come

683
00:39:19,020 --> 00:39:25,640
back to you see that is BR specific

684
00:39:25,670 --> 00:39:29,700
abstract next hop is one dot one dot one

685
00:39:28,170 --> 00:39:33,750
dot two

686
00:39:29,700 --> 00:39:40,259
and here at the bottom on the bottom

687
00:39:33,750 --> 00:39:42,660
bottom left I have a condition there is

688
00:39:40,260 --> 00:39:45,180
a condition which says if one dot one

689
00:39:42,660 --> 00:39:49,230
dot one dot two exist in the eye not

690
00:39:45,180 --> 00:39:52,980
zero then all this will redistribute the

691
00:39:49,230 --> 00:39:55,950
static with tattoo to IGP and of course

692
00:39:52,980 --> 00:40:02,010
I may have more conditions like that so

693
00:39:55,950 --> 00:40:04,350
I can check the asbr of the abstract

694
00:40:02,010 --> 00:40:07,230
next op of ASV are one two three and

695
00:40:04,350 --> 00:40:09,839
four and if one of them exist in inot

696
00:40:07,230 --> 00:40:12,690
zero then I will register Butte the site

697
00:40:09,840 --> 00:40:17,060
specific address abstract abstract next

698
00:40:12,690 --> 00:40:21,570
hope to the to the is is alright OS p f

699
00:40:17,060 --> 00:40:25,380
so then you can see in the in the link

700
00:40:21,570 --> 00:40:29,370
state database that this site pas

701
00:40:25,380 --> 00:40:33,270
specific abstract next hope is in the in

702
00:40:29,370 --> 00:40:35,940
the routing table in the IGP routing one

703
00:40:33,270 --> 00:40:39,360
dot zero dot one dot two and this is

704
00:40:35,940 --> 00:40:42,510
also what a wrote reflector advertised

705
00:40:39,360 --> 00:40:44,100
as a BGP next hope to another sites not

706
00:40:42,510 --> 00:40:47,330
locally to clients but to other route

707
00:40:44,100 --> 00:40:52,560
reflectors added other sites

708
00:40:47,330 --> 00:40:55,200
okay so short summary the scale out

709
00:40:52,560 --> 00:40:57,259
architecture cell solve some challenges

710
00:40:55,200 --> 00:41:00,779
with boundary friend and an zero

711
00:40:57,260 --> 00:41:05,190
round-trip time also might help with the

712
00:41:00,780 --> 00:41:07,260
commercial site the cost of scale out is

713
00:41:05,190 --> 00:41:09,510
always the control plate state the

714
00:41:07,260 --> 00:41:12,210
control plane states they are going up

715
00:41:09,510 --> 00:41:14,130
so we need some new practices in

716
00:41:12,210 --> 00:41:16,500
construct how to deal with that and

717
00:41:14,130 --> 00:41:21,540
abstract next up is useful construct

718
00:41:16,500 --> 00:41:23,250
it's a tool I can i it's not a Holy

719
00:41:21,540 --> 00:41:26,029
Grail it's not something which solves

720
00:41:23,250 --> 00:41:28,650
all the problems on the word one of my

721
00:41:26,030 --> 00:41:31,680
colleagues commented that though it

722
00:41:28,650 --> 00:41:34,190
doesn't solve the optimality of the BGP

723
00:41:31,680 --> 00:41:37,529
routing of course not it's not for that

724
00:41:34,190 --> 00:41:41,820
it's a tool which allows you to control

725
00:41:37,530 --> 00:41:43,079
the scale of BGP path across your

726
00:41:41,820 --> 00:41:49,319
internal

727
00:41:43,079 --> 00:41:51,180
you peel out it's just and the use of it

728
00:41:49,319 --> 00:41:53,788
is documented in the draft it I

729
00:41:51,180 --> 00:41:56,759
submitted it for the ITF Gras working

730
00:41:53,789 --> 00:42:01,380
group so you can comment

731
00:41:56,759 --> 00:42:06,869
bhishan me fix it and make it usable for

732
00:42:01,380 --> 00:42:14,700
others thank you and it's your time for

733
00:42:06,869 --> 00:42:16,950
questions eat any Peter you promised

734
00:42:14,700 --> 00:42:26,368
grill me what about the best gets

735
00:42:16,950 --> 00:42:40,288
protocol come on speak to Mike mics are

736
00:42:26,369 --> 00:42:42,509
on the back or I can give you your

737
00:42:40,289 --> 00:42:45,779
example is essentially a search rider

738
00:42:42,509 --> 00:42:48,150
scaled out appearing with other example

739
00:42:45,779 --> 00:42:49,979
but given that it's a spine leaf

740
00:42:48,150 --> 00:42:51,839
topology and the fact that a lot of our

741
00:42:49,979 --> 00:42:53,308
modern data center designs are bgp

742
00:42:51,839 --> 00:42:59,328
spying leaf is this something that would

743
00:42:53,309 --> 00:43:03,259
be as well yes there is a possibility to

744
00:42:59,329 --> 00:43:06,859
make it applicable for tea for the

745
00:43:03,259 --> 00:43:10,949
underlay routing in the spine on leaf

746
00:43:06,859 --> 00:43:12,839
the thing is it's not for free there is

747
00:43:10,949 --> 00:43:14,279
some cost operational cost associated

748
00:43:12,839 --> 00:43:16,949
with that right when you need to

749
00:43:14,279 --> 00:43:19,369
configure these IP addresses etc so

750
00:43:16,949 --> 00:43:22,769
depending on the scale right if your

751
00:43:19,369 --> 00:43:26,150
network if you're if you're close high

752
00:43:22,769 --> 00:43:30,718
peak loss has say ten thousand prefixes

753
00:43:26,150 --> 00:43:35,279
not $100 $500 and prefixes or million to

754
00:43:30,719 --> 00:43:38,749
exist is it worth to do that right but

755
00:43:35,279 --> 00:43:43,799
yes it's it's possible it reduced the

756
00:43:38,749 --> 00:43:48,479
reduced the how far in the how high in

757
00:43:43,799 --> 00:43:53,130
the cost network this the object has to

758
00:43:48,479 --> 00:43:54,509
travel to close the traffic I seems like

759
00:43:53,130 --> 00:43:56,849
a net architecture you typically run

760
00:43:54,509 --> 00:43:58,380
into models of

761
00:43:56,849 --> 00:44:00,210
networking devices that have a limit on

762
00:43:58,380 --> 00:44:01,859
the control plane even more so than you

763
00:44:00,210 --> 00:44:02,989
do in the search router edge networks

764
00:44:01,859 --> 00:44:05,598
right

765
00:44:02,989 --> 00:44:09,479
actually I don't know the again one of

766
00:44:05,599 --> 00:44:12,089
one person which commented my my draft

767
00:44:09,479 --> 00:44:15,239
said you know what who cares about

768
00:44:12,089 --> 00:44:17,130
control plane performance there is no

769
00:44:15,239 --> 00:44:21,029
problem at all the people who trying to

770
00:44:17,130 --> 00:44:22,829
do sub second subject sub second is

771
00:44:21,029 --> 00:44:26,309
always about the provisioning state

772
00:44:22,829 --> 00:44:28,109
before and yes then it's useful if you

773
00:44:26,309 --> 00:44:29,910
if you are looking for the sub second it

774
00:44:28,109 --> 00:44:33,328
could be useful because we remove the

775
00:44:29,910 --> 00:44:34,890
one object which fix the tens of

776
00:44:33,329 --> 00:44:38,849
thousands if not hundreds of thousands

777
00:44:34,890 --> 00:44:41,489
of the of the of the routing routing

778
00:44:38,849 --> 00:44:44,759
entries but your hardware has to have

779
00:44:41,489 --> 00:44:49,710
proper indirection so not every hardware

780
00:44:44,759 --> 00:44:53,369
can do this that's I know that if we

781
00:44:49,710 --> 00:44:56,880
have only two levels on the example most

782
00:44:53,369 --> 00:44:59,369
of the merchant ships including trident

783
00:44:56,880 --> 00:45:02,609
tomahawks and all these can do that but

784
00:44:59,369 --> 00:45:05,160
if the if the indirection depth going

785
00:45:02,609 --> 00:45:08,519
father and fathers of VPN over BGP are

786
00:45:05,160 --> 00:45:10,319
you over a tunnel over another two now

787
00:45:08,519 --> 00:45:16,319
then things become a little bit more

788
00:45:10,319 --> 00:45:18,509
more complex yeah the example is service

789
00:45:16,319 --> 00:45:21,089
provider you can think about this also

790
00:45:18,509 --> 00:45:23,549
from the content provider which peers we

791
00:45:21,089 --> 00:45:28,200
do with the service provider and want

792
00:45:23,549 --> 00:45:30,269
the boundary fried that work is network

793
00:45:28,200 --> 00:45:34,160
widget is bidipi doesn't matter is

794
00:45:30,269 --> 00:45:34,160
service provider or content provider

