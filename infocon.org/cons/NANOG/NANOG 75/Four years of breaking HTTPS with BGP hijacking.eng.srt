1
00:00:10,620 --> 00:00:17,110
so yeah to start it up let's get back to

2
00:00:15,250 --> 00:00:20,730
a set event which occurred ten months

3
00:00:17,110 --> 00:00:23,619
ago in April 2018

4
00:00:20,730 --> 00:00:26,260
cryptocurrency exchange named my other

5
00:00:23,619 --> 00:00:28,920
wallet recorded an incident of a

6
00:00:26,260 --> 00:00:32,879
man-in-the-middle attack the incident

7
00:00:28,920 --> 00:00:35,620
lasted for two hours until somebody

8
00:00:32,879 --> 00:00:38,440
finally noticed the issue and reached

9
00:00:35,620 --> 00:00:41,379
out to ice peace to fix it in a few

10
00:00:38,440 --> 00:00:44,709
hours it was already on the news here's

11
00:00:41,380 --> 00:00:48,040
how it basically worked under not normal

12
00:00:44,710 --> 00:00:51,250
conditions the browser starts session

13
00:00:48,040 --> 00:00:54,430
with an arbitrary remote server a web

14
00:00:51,250 --> 00:00:57,460
server with a DNS query an authoritative

15
00:00:54,430 --> 00:01:01,269
DNS server which in case of minor wallet

16
00:00:57,460 --> 00:01:04,119
comm used to be Amazon route 53 responds

17
00:01:01,270 --> 00:01:07,600
with an IP address of the requested

18
00:01:04,119 --> 00:01:10,229
domain and after that the browser sends

19
00:01:07,600 --> 00:01:14,830
an HTTP request the request or better

20
00:01:10,229 --> 00:01:18,009
fires up a TLS session with that IP

21
00:01:14,830 --> 00:01:21,340
address then the server again hosted in

22
00:01:18,009 --> 00:01:24,369
our case within an amazon another amazon

23
00:01:21,340 --> 00:01:26,860
product responds with a TLS certificate

24
00:01:24,369 --> 00:01:29,200
the signature of the letter being then

25
00:01:26,860 --> 00:01:32,099
checked against the built-in browser

26
00:01:29,200 --> 00:01:32,099
trust store

27
00:01:32,259 --> 00:01:39,520
so what attackers did in that case was a

28
00:01:36,069 --> 00:01:41,319
BGP hijack of their route 53 IP prefix

29
00:01:39,520 --> 00:01:44,649
which hosted the authoritative server

30
00:01:41,319 --> 00:01:47,440
for the my Ethernet my other wallet that

31
00:01:44,649 --> 00:01:51,789
come domain an initial query would then

32
00:01:47,440 --> 00:01:54,880
go to rogue DNS server which responded

33
00:01:51,789 --> 00:01:56,380
with an IP address of server controlled

34
00:01:54,880 --> 00:02:00,149
by the attacker

35
00:01:56,380 --> 00:02:04,089
after that just like in the normal case

36
00:02:00,149 --> 00:02:06,640
the browser sent TLS hello which didn't

37
00:02:04,090 --> 00:02:09,369
go to Amazon this time but instead

38
00:02:06,640 --> 00:02:15,190
traveled all the way down to cold and

39
00:02:09,369 --> 00:02:19,120
hopeless place somewhere in Siberia that

40
00:02:15,190 --> 00:02:22,959
place used self-signed TLS certificate

41
00:02:19,120 --> 00:02:23,260
though so the browser I'm laughing but

42
00:02:22,959 --> 00:02:26,950
the

43
00:02:23,260 --> 00:02:29,078
nothing to laugh about right so the

44
00:02:26,950 --> 00:02:30,069
place is the self-signed till is

45
00:02:29,079 --> 00:02:33,790
certificate though

46
00:02:30,069 --> 00:02:37,629
so the browser must have issued serious

47
00:02:33,790 --> 00:02:39,849
carry warning about certificate being

48
00:02:37,629 --> 00:02:41,980
wrong yet the attackers were able to

49
00:02:39,849 --> 00:02:44,349
withdraw some crypto stuff from some of

50
00:02:41,980 --> 00:02:46,750
the users accounts because a certain

51
00:02:44,349 --> 00:02:49,030
portion of users happily click through

52
00:02:46,750 --> 00:02:57,280
the certificate certificate warning

53
00:02:49,030 --> 00:02:59,530
anyway yeah let's be clear it's not that

54
00:02:57,280 --> 00:03:01,720
easy to get through HTTPS certificate

55
00:02:59,530 --> 00:03:04,959
warnings with that today's chrome or

56
00:03:01,720 --> 00:03:07,810
firefox sometimes it's even impossible

57
00:03:04,959 --> 00:03:10,120
depends on an error though in today's

58
00:03:07,810 --> 00:03:13,060
internet a handful men in the middle

59
00:03:10,120 --> 00:03:16,329
attack is quite a rare thing a few

60
00:03:13,060 --> 00:03:19,090
orders of magnitude more often it's

61
00:03:16,329 --> 00:03:22,090
either a captive portal doing captive

62
00:03:19,090 --> 00:03:24,370
things or a site blocking enforced by

63
00:03:22,090 --> 00:03:26,920
law or simply a configuration error

64
00:03:24,370 --> 00:03:29,970
which can occur both on the server side

65
00:03:26,920 --> 00:03:33,879
and a client side like an accidentally

66
00:03:29,970 --> 00:03:36,609
expired certificate and on the client

67
00:03:33,879 --> 00:03:40,179
side for instance a mistaken parental

68
00:03:36,609 --> 00:03:45,250
control set up a user basically loans by

69
00:03:40,180 --> 00:03:47,620
heart today to circumvent the HTTP

70
00:03:45,250 --> 00:03:50,199
errors because they have done it a

71
00:03:47,620 --> 00:03:54,010
thousand times before and nothing bad

72
00:03:50,199 --> 00:03:56,199
has happened after that which is why the

73
00:03:54,010 --> 00:03:58,569
most popular suggestion on how to fix

74
00:03:56,199 --> 00:04:01,030
the issue of BGP hijacking against an

75
00:03:58,569 --> 00:04:03,099
HTTPS portal was to further strengthen

76
00:04:01,030 --> 00:04:06,220
strengthen the way a contemporary

77
00:04:03,099 --> 00:04:08,138
browser reports a certificate issue if

78
00:04:06,220 --> 00:04:11,470
we say once allowed to click through

79
00:04:08,139 --> 00:04:13,810
that error at all then the issue is

80
00:04:11,470 --> 00:04:17,738
completely gone unfortunately it turns

81
00:04:13,810 --> 00:04:20,500
out it's not really that simple the

82
00:04:17,738 --> 00:04:23,130
first time I faced BGP hijacking

83
00:04:20,500 --> 00:04:26,949
incident myself dates back to the year

84
00:04:23,130 --> 00:04:30,460
2012 our only business back in those

85
00:04:26,949 --> 00:04:32,979
days was DDoS mitigation the problem

86
00:04:30,460 --> 00:04:36,190
with DDoS mitigation is that sometimes a

87
00:04:32,979 --> 00:04:36,909
criminal is really highly motivated to

88
00:04:36,190 --> 00:04:40,300
bring a network

89
00:04:36,910 --> 00:04:43,330
service down that doesn't happen usually

90
00:04:40,300 --> 00:04:46,810
with say carpet-bombing

91
00:04:43,330 --> 00:04:48,460
blackmail attacks yet once in a while

92
00:04:46,810 --> 00:04:50,680
and attack is ordered by market

93
00:04:48,460 --> 00:04:52,479
competition of the victim and depending

94
00:04:50,680 --> 00:04:55,660
on the market situation a competition

95
00:04:52,480 --> 00:04:57,250
can go to great lengths to achieve what

96
00:04:55,660 --> 00:04:59,290
they try to achieve and of course a

97
00:04:57,250 --> 00:05:01,450
hijacking is quite a reliable way to do

98
00:04:59,290 --> 00:05:04,330
that closely though but the cost is

99
00:05:01,450 --> 00:05:07,960
always about a trade-off between how

100
00:05:04,330 --> 00:05:08,500
much you pay and how much you get in

101
00:05:07,960 --> 00:05:10,630
return

102
00:05:08,500 --> 00:05:13,900
at that time we've happened to already

103
00:05:10,630 --> 00:05:16,570
have an internal BGP monitoring to which

104
00:05:13,900 --> 00:05:20,469
we then polished a bit and released to

105
00:05:16,570 --> 00:05:23,680
public in a year however as we examined

106
00:05:20,470 --> 00:05:25,600
possible consequences of a hijacking we

107
00:05:23,680 --> 00:05:27,820
figured out that almost no matter how

108
00:05:25,600 --> 00:05:29,800
secure is the configuration of a web

109
00:05:27,820 --> 00:05:31,360
server a man-in-the-middle attack

110
00:05:29,800 --> 00:05:33,660
through hijacking would still be a

111
00:05:31,360 --> 00:05:37,960
success

112
00:05:33,660 --> 00:05:39,640
the problem is certificate authorities

113
00:05:37,960 --> 00:05:41,830
which signed certificates with key

114
00:05:39,640 --> 00:05:44,469
reflect is reflected in a browser trust

115
00:05:41,830 --> 00:05:46,780
store only need to first check if the

116
00:05:44,470 --> 00:05:49,120
entity requesting as a an HTTPS

117
00:05:46,780 --> 00:05:52,179
certificate for a website is in fact in

118
00:05:49,120 --> 00:05:55,540
charge of managing that web site and due

119
00:05:52,180 --> 00:05:58,870
to obvious chicken-and-egg dilemma here

120
00:05:55,540 --> 00:06:00,760
they do it in insecure ways I submitted

121
00:05:58,870 --> 00:06:03,430
the detailed outline of how such an

122
00:06:00,760 --> 00:06:05,320
attack could be carried as a top

123
00:06:03,430 --> 00:06:08,080
proposal for a blackhat conference in

124
00:06:05,320 --> 00:06:10,480
Vegas four years ago the proposal got

125
00:06:08,080 --> 00:06:12,070
approved the slides and the white paper

126
00:06:10,480 --> 00:06:14,650
are available on the conference website

127
00:06:12,070 --> 00:06:16,390
in that white paper we examine how

128
00:06:14,650 --> 00:06:19,870
certificate authorities implement the

129
00:06:16,390 --> 00:06:22,810
remote server checking basically they

130
00:06:19,870 --> 00:06:26,230
generate a random token presented to the

131
00:06:22,810 --> 00:06:29,970
user who requests the certificate and

132
00:06:26,230 --> 00:06:32,890
expect to see a token up in awhile

133
00:06:29,970 --> 00:06:36,160
either by requesting a certain page we

134
00:06:32,890 --> 00:06:38,380
are clear text HTTP or by looking for a

135
00:06:36,160 --> 00:06:40,210
presence of that token in DNS txt

136
00:06:38,380 --> 00:06:43,870
records for the target domain or by

137
00:06:40,210 --> 00:06:46,690
checking who is records there used to be

138
00:06:43,870 --> 00:06:48,790
also more exotic method to achieve the

139
00:06:46,690 --> 00:06:50,050
same goal but those

140
00:06:48,790 --> 00:06:52,840
we are quite enough for our

141
00:06:50,050 --> 00:06:55,390
consideration because it's the user who

142
00:06:52,840 --> 00:06:57,429
chooses the who chooses one particular

143
00:06:55,390 --> 00:07:05,909
checking method at not and not the

144
00:06:57,430 --> 00:07:08,290
certificate authority yeah as the result

145
00:07:05,910 --> 00:07:10,480
an offender who applies for a

146
00:07:08,290 --> 00:07:13,720
certificate for an arbitrary website on

147
00:07:10,480 --> 00:07:17,500
the web and gets a token which would be

148
00:07:13,720 --> 00:07:19,960
checked can then supply the verifying

149
00:07:17,500 --> 00:07:25,540
script with that token through hijacking

150
00:07:19,960 --> 00:07:28,180
of an IP prefix of that site or a prefix

151
00:07:25,540 --> 00:07:30,490
of its DNS server or something else

152
00:07:28,180 --> 00:07:32,860
depends on a website infrastructure in

153
00:07:30,490 --> 00:07:34,960
turn a CA would issue a perfectly valid

154
00:07:32,860 --> 00:07:37,630
TLS certificate and would then send it

155
00:07:34,960 --> 00:07:41,530
to the offender that certificate would

156
00:07:37,630 --> 00:07:43,570
then just be used in MIT M attacks we

157
00:07:41,530 --> 00:07:45,460
are hijacking again or be any other

158
00:07:43,570 --> 00:07:49,000
traffic redirection method convenient

159
00:07:45,460 --> 00:07:51,460
for the attacker if the server resides

160
00:07:49,000 --> 00:07:54,910
in the United States all the users are

161
00:07:51,460 --> 00:07:58,299
in the North North America and the SS EA

162
00:07:54,910 --> 00:08:01,180
in say Poland or Spain then adjusted for

163
00:07:58,300 --> 00:08:03,580
the internet apology a limited range

164
00:08:01,180 --> 00:08:06,190
hijacking would go totally unnoticed the

165
00:08:03,580 --> 00:08:08,169
whitepaper defined two different types

166
00:08:06,190 --> 00:08:10,090
of a BGP hijacking attack which were

167
00:08:08,170 --> 00:08:13,810
mostly different only in the house

168
00:08:10,090 --> 00:08:16,479
stealthy an attack could go from the

169
00:08:13,810 --> 00:08:19,120
victim's point of view one important

170
00:08:16,480 --> 00:08:21,030
consequences a consequence was that for

171
00:08:19,120 --> 00:08:23,980
such an attack implemented properly

172
00:08:21,030 --> 00:08:26,859
there was at that point virtually no way

173
00:08:23,980 --> 00:08:30,250
of telling it in fact occurred much life

174
00:08:26,860 --> 00:08:32,289
less of investigating it so I have

175
00:08:30,250 --> 00:08:35,590
published the white paper and within

176
00:08:32,289 --> 00:08:37,478
five of a few months I have collected

177
00:08:35,590 --> 00:08:40,030
feedback from the trust a trust

178
00:08:37,479 --> 00:08:42,190
Authority industry experts it was just

179
00:08:40,030 --> 00:08:45,550
one article but there were more

180
00:08:42,190 --> 00:08:47,740
different news websites we with my

181
00:08:45,550 --> 00:08:50,890
unfortunate hands-on experience from 10

182
00:08:47,740 --> 00:08:53,230
2012 I was thrilled to see how the issue

183
00:08:50,890 --> 00:08:56,380
is probably going to be resolved in the

184
00:08:53,230 --> 00:09:00,170
most elegant and beautiful way guess

185
00:08:56,380 --> 00:09:02,029
what what I get instead

186
00:09:00,170 --> 00:09:04,240
was that reassuring statement that the

187
00:09:02,029 --> 00:09:07,459
issue highlighted wasn't really an issue

188
00:09:04,240 --> 00:09:10,850
the articles pointed out first that the

189
00:09:07,459 --> 00:09:13,099
BGP hijacking issue alone was almost be

190
00:09:10,850 --> 00:09:14,810
really illogical imagine how I felt

191
00:09:13,100 --> 00:09:17,480
reading that three years since it

192
00:09:14,810 --> 00:09:20,329
happened to my own network let alone

193
00:09:17,480 --> 00:09:23,000
using it for HBS HTTP certificate

194
00:09:20,329 --> 00:09:24,979
hijacking next they numerated a few

195
00:09:23,000 --> 00:09:27,500
features for the web public

196
00:09:24,980 --> 00:09:32,149
infrastructure such as extended extended

197
00:09:27,500 --> 00:09:34,700
validation all first letters capital or

198
00:09:32,149 --> 00:09:37,579
publicly key pinning stay and stated

199
00:09:34,700 --> 00:09:39,560
those would be the final ultimate

200
00:09:37,579 --> 00:09:40,010
solution for the certificate hijacking

201
00:09:39,560 --> 00:09:42,859
problem

202
00:09:40,010 --> 00:09:47,630
finally the article stated that today's

203
00:09:42,860 --> 00:09:49,820
CA would never be checking the token

204
00:09:47,630 --> 00:09:52,399
with a single script and would only

205
00:09:49,820 --> 00:09:56,480
issue after a handful of checks which

206
00:09:52,399 --> 00:09:59,060
reported consensus the author also are

207
00:09:56,480 --> 00:10:01,250
called as a BGP monitoring company which

208
00:09:59,060 --> 00:10:03,018
we in fact were not at the moment we're

209
00:10:01,250 --> 00:10:06,589
still at the dose mitigation company

210
00:10:03,019 --> 00:10:09,470
maybe 99% and the BGP marine monitoring

211
00:10:06,589 --> 00:10:11,750
tool called trader was developed as a

212
00:10:09,470 --> 00:10:15,860
free community project but that was just

213
00:10:11,750 --> 00:10:18,440
less important so here is an outline of

214
00:10:15,860 --> 00:10:22,220
how they say industry plan to deal with

215
00:10:18,440 --> 00:10:24,199
this back three and a half years ago we

216
00:10:22,220 --> 00:10:26,480
could have waited even for longer to see

217
00:10:24,199 --> 00:10:29,750
how did that go but as we'll see that's

218
00:10:26,480 --> 00:10:33,380
not needed what's the ultimate result as

219
00:10:29,750 --> 00:10:37,029
it is today the first statement was that

220
00:10:33,380 --> 00:10:39,290
BGP hijacking doesn't happen in practice

221
00:10:37,029 --> 00:10:42,320
someone I've been talking to coin to

222
00:10:39,290 --> 00:10:43,760
turn conference type attack a meaning

223
00:10:42,320 --> 00:10:45,649
that such a threat doesn't have to be

224
00:10:43,760 --> 00:10:50,689
part of practical web security risk

225
00:10:45,649 --> 00:10:52,940
assessment Oh average 20 it was 20 18

226
00:10:50,690 --> 00:10:55,459
and as we can see those attacks do

227
00:10:52,940 --> 00:10:57,800
happen the essential prerequisite though

228
00:10:55,459 --> 00:11:00,260
is a motivated attacker hunting for a

229
00:10:57,800 --> 00:11:02,979
price convincing enough and cryptic

230
00:11:00,260 --> 00:11:05,600
currency exchanges are an obvious target

231
00:11:02,980 --> 00:11:07,070
the my other wallet case missed the

232
00:11:05,600 --> 00:11:09,500
certificate part though but the

233
00:11:07,070 --> 00:11:11,209
attackers in that case probably do not

234
00:11:09,500 --> 00:11:14,550
follow conference agenda as thoroughly

235
00:11:11,209 --> 00:11:17,130
as all of us here

236
00:11:14,550 --> 00:11:19,770
too bad for them because if they did

237
00:11:17,130 --> 00:11:21,450
they could have been sitting on the wall

238
00:11:19,770 --> 00:11:23,069
at user accounts for much longer than

239
00:11:21,450 --> 00:11:26,720
two hours

240
00:11:23,070 --> 00:11:29,700
yeah that is the first outcome today

241
00:11:26,720 --> 00:11:31,440
attend internet communities community

242
00:11:29,700 --> 00:11:34,530
meetings such as New York and you will

243
00:11:31,440 --> 00:11:36,300
never miss an opportunity yes sir that

244
00:11:34,530 --> 00:11:39,420
was a contextual advertising they forced

245
00:11:36,300 --> 00:11:42,510
me to do that another funny thing is

246
00:11:39,420 --> 00:11:44,729
that since year 2015 different people on

247
00:11:42,510 --> 00:11:47,280
multiple occasions wrote me wrote me

248
00:11:44,730 --> 00:11:48,990
emails or even reached me in person to

249
00:11:47,280 --> 00:11:52,199
clarify the details of that potential

250
00:11:48,990 --> 00:11:56,420
threat or to discuss strange issues with

251
00:11:52,200 --> 00:12:00,210
TLS they have seen and last year on two

252
00:11:56,420 --> 00:12:02,579
unrelated occasions the topic to discuss

253
00:12:00,210 --> 00:12:04,950
was a certificate in public certificate

254
00:12:02,580 --> 00:12:07,410
transparency logs that the website owner

255
00:12:04,950 --> 00:12:09,360
had reasons to believe they couldn't

256
00:12:07,410 --> 00:12:12,300
have ever conscience consciously I

257
00:12:09,360 --> 00:12:14,040
applied for it's quite hard to tell what

258
00:12:12,300 --> 00:12:15,900
really happened there because as I've

259
00:12:14,040 --> 00:12:18,329
said before the certificate issue is

260
00:12:15,900 --> 00:12:20,760
challenging enough to detect let alone

261
00:12:18,330 --> 00:12:22,920
investigate for instance on average

262
00:12:20,760 --> 00:12:25,590
there are hundreds of Amazon prefixes

263
00:12:22,920 --> 00:12:29,400
sitting in hijacks or out leaks every

264
00:12:25,590 --> 00:12:31,950
day and for any website using route 53

265
00:12:29,400 --> 00:12:34,920
it would take a great effort to sort

266
00:12:31,950 --> 00:12:36,960
that high stack parsing for one needle a

267
00:12:34,920 --> 00:12:39,120
potential offender in both of the cases

268
00:12:36,960 --> 00:12:44,280
is I'm assumed to be quite motivated

269
00:12:39,120 --> 00:12:48,150
though next up extended validation all

270
00:12:44,280 --> 00:12:50,449
first letters capital for those lucky of

271
00:12:48,150 --> 00:12:53,189
you who doesn't deal with online banking

272
00:12:50,450 --> 00:12:56,300
Evie is essentially that little green

273
00:12:53,190 --> 00:12:59,040
box in the address bar of the browser

274
00:12:56,300 --> 00:13:01,829
where the name of the company owning the

275
00:12:59,040 --> 00:13:03,780
website is written you are only granted

276
00:13:01,830 --> 00:13:07,650
such a certificate after you provide

277
00:13:03,780 --> 00:13:11,610
additional documents such as a photo of

278
00:13:07,650 --> 00:13:15,600
your office's reception desk or monthly

279
00:13:11,610 --> 00:13:17,730
electricity bills because if you pay the

280
00:13:15,600 --> 00:13:23,100
electricity bills then your website is

281
00:13:17,730 --> 00:13:24,090
certainly secure don't ask anyhow on

282
00:13:23,100 --> 00:13:25,920
mobile devices

283
00:13:24,090 --> 00:13:26,730
Evie bugs even used to replace the

284
00:13:25,920 --> 00:13:29,010
address bar

285
00:13:26,730 --> 00:13:32,220
pletely which led to funny

286
00:13:29,010 --> 00:13:34,860
vulnerabilities such as a fork obtaining

287
00:13:32,220 --> 00:13:38,970
a fraudulent certificate for a company

288
00:13:34,860 --> 00:13:40,860
called identity verified that phrase was

289
00:13:38,970 --> 00:13:43,350
then displayed instead of the address

290
00:13:40,860 --> 00:13:44,310
bar ruling out virtually any possibility

291
00:13:43,350 --> 00:13:46,440
that Joe Sixpack

292
00:13:44,310 --> 00:13:50,130
would detect a phishing site behind that

293
00:13:46,440 --> 00:13:53,550
certificate it's 2019 now and if he is

294
00:13:50,130 --> 00:13:55,920
effective effectively dead mobile

295
00:13:53,550 --> 00:13:57,689
devices don't show or support it anymore

296
00:13:55,920 --> 00:14:01,410
some of them never did like Windows

297
00:13:57,690 --> 00:14:03,720
Phone 8 death browsers are also

298
00:14:01,410 --> 00:14:07,500
apparently slowly moving out of that

299
00:14:03,720 --> 00:14:09,690
support websites prefer to not to use it

300
00:14:07,500 --> 00:14:13,769
not only because it's so much cheaper to

301
00:14:09,690 --> 00:14:16,170
go with domain validation but also

302
00:14:13,769 --> 00:14:18,690
because today an HTTP a certificate

303
00:14:16,170 --> 00:14:22,649
renewal process is expected to be 100%

304
00:14:18,690 --> 00:14:26,190
automated and automating evie is hell

305
00:14:22,649 --> 00:14:28,050
incorporated again BGP hijacking is a

306
00:14:26,190 --> 00:14:30,570
rare threat today while forgetting to

307
00:14:28,050 --> 00:14:32,939
renew your HTS certificate is a routine

308
00:14:30,570 --> 00:14:35,819
mistake and with evey you wouldn't

309
00:14:32,940 --> 00:14:38,639
usually able to fix that in less than a

310
00:14:35,819 --> 00:14:40,760
couple of days here we see how a remedy

311
00:14:38,639 --> 00:14:44,399
was in fact worse than the disease

312
00:14:40,760 --> 00:14:48,480
what's next oh yeah public key pinning

313
00:14:44,399 --> 00:14:50,430
dead removed from Chrome a long time ago

314
00:14:48,480 --> 00:14:53,339
still I would personally oppose that

315
00:14:50,430 --> 00:14:55,529
change but I'm not blaming from

316
00:14:53,339 --> 00:14:58,649
developers for that because they have

317
00:14:55,529 --> 00:15:00,990
some solid reasons to do that what PGP

318
00:14:58,649 --> 00:15:03,389
was designed for was to basically put a

319
00:15:00,990 --> 00:15:06,600
number of certificates in into the

320
00:15:03,389 --> 00:15:08,519
browser cache during the very first HTTP

321
00:15:06,600 --> 00:15:11,130
request and then tell the browser that

322
00:15:08,519 --> 00:15:13,889
the remote website should never be

323
00:15:11,130 --> 00:15:16,050
displayed if the remote TLS server

324
00:15:13,889 --> 00:15:19,800
authenticates itself itself with a

325
00:15:16,050 --> 00:15:21,359
certificate missing in the cache

326
00:15:19,800 --> 00:15:24,719
now I mentioned what would happen if

327
00:15:21,360 --> 00:15:29,130
someone such as an angry former employee

328
00:15:24,720 --> 00:15:31,769
logs onto the website and puts only one

329
00:15:29,130 --> 00:15:35,220
rogue certificate with a four years

330
00:15:31,769 --> 00:15:36,810
lifetime into the P key P header and

331
00:15:35,220 --> 00:15:39,810
then deletes the certificate that's

332
00:15:36,810 --> 00:15:40,560
called a hostile pinning and the website

333
00:15:39,810 --> 00:15:42,510
would then

334
00:15:40,560 --> 00:15:46,979
be unreachable for most of the users for

335
00:15:42,510 --> 00:15:49,980
about four years which is bad anyhow

336
00:15:46,980 --> 00:15:52,050
pika P has never really seen adoption

337
00:15:49,980 --> 00:15:54,480
because again updating the picky p-value

338
00:15:52,050 --> 00:15:57,750
for any today's web server is very very

339
00:15:54,480 --> 00:15:59,779
hard to mate I know I did it

340
00:15:57,750 --> 00:16:02,400
aha and the last one

341
00:15:59,779 --> 00:16:04,680
checking the token from multiple places

342
00:16:02,400 --> 00:16:07,800
on the internet this dear audience is

343
00:16:04,680 --> 00:16:10,109
where the real fun starts first a couple

344
00:16:07,800 --> 00:16:12,709
of words about the theoretical concept

345
00:16:10,110 --> 00:16:16,529
of issuing by consensus here's how I

346
00:16:12,710 --> 00:16:19,260
understand it was supposed to work say

347
00:16:16,529 --> 00:16:21,900
there's a number of machines like four

348
00:16:19,260 --> 00:16:24,810
on the slide that run the verifying

349
00:16:21,900 --> 00:16:26,520
script if every machine sees the same

350
00:16:24,810 --> 00:16:28,770
token everything's alright the

351
00:16:26,520 --> 00:16:32,370
certificate is generated and issued if

352
00:16:28,770 --> 00:16:34,920
one of the machines fault though well

353
00:16:32,370 --> 00:16:37,710
there's still majority which reports

354
00:16:34,920 --> 00:16:39,599
consensus and apparently no warning at

355
00:16:37,710 --> 00:16:41,490
least I'm yet to see how such a warning

356
00:16:39,600 --> 00:16:43,830
could be displayed displayed on the

357
00:16:41,490 --> 00:16:46,020
trusted authority website and the

358
00:16:43,830 --> 00:16:48,930
certificate certificate is issued and

359
00:16:46,020 --> 00:16:52,140
what if we have a BGP incident that

360
00:16:48,930 --> 00:16:54,510
propagated across a significant number

361
00:16:52,140 --> 00:16:58,730
of ispin networks and the tokens applied

362
00:16:54,510 --> 00:17:01,230
to most of the verifying machines oh

363
00:16:58,730 --> 00:17:03,870
yeah the majority still reports

364
00:17:01,230 --> 00:17:05,970
consensus and the certificate is still

365
00:17:03,870 --> 00:17:11,550
issued at the time I was so mesmerized

366
00:17:05,970 --> 00:17:13,199
by the words majority and consensus that

367
00:17:11,550 --> 00:17:15,750
it took some time for me to figure out

368
00:17:13,199 --> 00:17:18,300
that almost the only case where it could

369
00:17:15,750 --> 00:17:19,589
be really preventing something is when

370
00:17:18,300 --> 00:17:23,220
either the BG bits

371
00:17:19,589 --> 00:17:24,810
incident is small enough yet in this

372
00:17:23,220 --> 00:17:27,810
case the certificate shouldn't be issued

373
00:17:24,810 --> 00:17:31,320
anyways or on or where when there is

374
00:17:27,810 --> 00:17:32,970
somehow really no consensus yet in

375
00:17:31,320 --> 00:17:38,610
practice such a case would be almost

376
00:17:32,970 --> 00:17:41,300
impossible to see okay so the majority

377
00:17:38,610 --> 00:17:44,189
part is just broken also distributing

378
00:17:41,300 --> 00:17:46,080
multiple clients across the internet

379
00:17:44,190 --> 00:17:47,100
apology in such a way that they would

380
00:17:46,080 --> 00:17:50,220
stay independent

381
00:17:47,100 --> 00:17:52,730
in case of an arbitrary BGP incident is

382
00:17:50,220 --> 00:17:55,070
a very tough engineering task

383
00:17:52,730 --> 00:17:57,200
let's assume trust authorities could in

384
00:17:55,070 --> 00:18:01,340
fact implement a multi-home checking

385
00:17:57,200 --> 00:18:02,169
only more properly some how do they do

386
00:18:01,340 --> 00:18:04,850
that

387
00:18:02,169 --> 00:18:06,590
after a couple couple of years it came

388
00:18:04,850 --> 00:18:09,020
to my attention and again in a funny way

389
00:18:06,590 --> 00:18:11,600
I might need to tell the story doink ena

390
00:18:09,020 --> 00:18:14,600
if you have time that someone else

391
00:18:11,600 --> 00:18:17,199
except me finally got interested with

392
00:18:14,600 --> 00:18:25,360
the issue someone in the sense I mean

393
00:18:17,200 --> 00:18:28,610
yes cool scientists good news everyone a

394
00:18:25,360 --> 00:18:30,918
team including Jennifer Rexford from

395
00:18:28,610 --> 00:18:33,049
Princeton did what scientists usually do

396
00:18:30,919 --> 00:18:35,990
with white papers they see they have

397
00:18:33,049 --> 00:18:37,850
checked my results in that white paper

398
00:18:35,990 --> 00:18:40,190
I haven't actually stated that I've

399
00:18:37,850 --> 00:18:43,309
carried out the attack myself and

400
00:18:40,190 --> 00:18:45,410
prattle apparently I can't say I really

401
00:18:43,309 --> 00:18:48,168
did I've tried but stopped after the

402
00:18:45,410 --> 00:18:50,990
check Ian I was checked I need it next

403
00:18:48,169 --> 00:18:53,330
to pay for the certificate to obtain it

404
00:18:50,990 --> 00:18:55,270
and there was a moment where I suddenly

405
00:18:53,330 --> 00:18:58,580
thought about some three-letter

406
00:18:55,270 --> 00:19:01,010
abbreviations and then decided it's best

407
00:18:58,580 --> 00:19:05,240
to stop here just in case Princeton

408
00:19:01,010 --> 00:19:06,770
folks were more desperate it turns out

409
00:19:05,240 --> 00:19:08,690
that for a number of repeated

410
00:19:06,770 --> 00:19:10,250
certificate authorities no one was

411
00:19:08,690 --> 00:19:12,980
actually checking from multiple sources

412
00:19:10,250 --> 00:19:15,830
so for a fraudulent certificate could

413
00:19:12,980 --> 00:19:17,929
have actually sat beside and sent to

414
00:19:15,830 --> 00:19:20,178
malicious users if I consent

415
00:19:17,929 --> 00:19:22,010
conscientious CA would use multiple

416
00:19:20,179 --> 00:19:24,320
clients around the globe then it's quite

417
00:19:22,010 --> 00:19:28,669
tough to find a conscientious CA those

418
00:19:24,320 --> 00:19:30,320
days the folks continued and in year

419
00:19:28,669 --> 00:19:33,080
released another paper much more

420
00:19:30,320 --> 00:19:35,780
complicated they define three more

421
00:19:33,080 --> 00:19:38,178
attack types gave all those five fancy

422
00:19:35,780 --> 00:19:40,970
sciency names and tested the result of

423
00:19:38,179 --> 00:19:43,040
those I'm leaving a link here I urge you

424
00:19:40,970 --> 00:19:45,980
to read it it's a very cool work and

425
00:19:43,040 --> 00:19:48,020
since then almost every month

426
00:19:45,980 --> 00:19:50,240
Google Scholar pins me with a new

427
00:19:48,020 --> 00:19:56,900
academic reference to my presentation

428
00:19:50,240 --> 00:19:59,450
from 2015 so it turns out that by

429
00:19:56,900 --> 00:20:01,840
letting the cat out of the box I wasn't

430
00:19:59,450 --> 00:20:05,520
able to get anywhere close to a solution

431
00:20:01,840 --> 00:20:07,520
for the root cause but in

432
00:20:05,520 --> 00:20:13,530
have started a moderately successful

433
00:20:07,520 --> 00:20:15,090
research direction yeah why do I say

434
00:20:13,530 --> 00:20:17,550
that their root cause isn't settled

435
00:20:15,090 --> 00:20:19,889
because no one of the involved parties

436
00:20:17,550 --> 00:20:22,470
really cared thereafter

437
00:20:19,890 --> 00:20:25,309
what did CAS do a couple of things first

438
00:20:22,470 --> 00:20:28,080
certificate transparency second genus

439
00:20:25,309 --> 00:20:31,889
certificate authority authorization all

440
00:20:28,080 --> 00:20:33,090
first letters capital you know no I'm

441
00:20:31,890 --> 00:20:35,880
kidding

442
00:20:33,090 --> 00:20:38,490
in fact certificate transparency is a

443
00:20:35,880 --> 00:20:41,190
truly brilliant breakthrough at least

444
00:20:38,490 --> 00:20:44,250
now we could become aware of an incident

445
00:20:41,190 --> 00:20:47,100
as it goes which is so much more than

446
00:20:44,250 --> 00:20:49,770
nothing hardly anyone in enterprise

447
00:20:47,100 --> 00:20:52,590
organizations let alone nonprofits is

448
00:20:49,770 --> 00:20:54,360
monitoring all the city lists for

449
00:20:52,590 --> 00:20:57,720
fraudulent certificate in real time

450
00:20:54,360 --> 00:21:00,059
though and I might be wrong here but I

451
00:20:57,720 --> 00:21:02,610
believe that hardly anyone is ever going

452
00:21:00,059 --> 00:21:04,770
to do that but so a certain attack

453
00:21:02,610 --> 00:21:06,870
window ranging from hours to months

454
00:21:04,770 --> 00:21:10,139
still persists also I see speed of

455
00:21:06,870 --> 00:21:12,419
occasion would involve human factor

456
00:21:10,140 --> 00:21:15,750
which also takes a lot of time all that

457
00:21:12,420 --> 00:21:18,780
put aside a great technology see a dog

458
00:21:15,750 --> 00:21:20,670
solves kind a different problem you can

459
00:21:18,780 --> 00:21:23,428
still use the same scale say let's

460
00:21:20,670 --> 00:21:27,120
encrypt that was used by the tls service

461
00:21:23,429 --> 00:21:31,080
owner also CA is again resource record

462
00:21:27,120 --> 00:21:33,479
in the zone like txt and could also be

463
00:21:31,080 --> 00:21:36,449
replaced by an attacker it might have

464
00:21:33,480 --> 00:21:40,800
been slightly better in that regard if

465
00:21:36,450 --> 00:21:42,720
you could glue it maybe anyhow it's

466
00:21:40,800 --> 00:21:45,480
rather far from being solution oh yeah

467
00:21:42,720 --> 00:21:48,780
here is a fun question why did the might

468
00:21:45,480 --> 00:21:51,420
other not my other wallet attackers

469
00:21:48,780 --> 00:21:54,809
hijack the route 53 prefix instead of

470
00:21:51,420 --> 00:21:56,790
easy to prefix where the website was

471
00:21:54,809 --> 00:21:59,580
hosted at the moment that's you know

472
00:21:56,790 --> 00:22:01,409
moron of an effort the scheme is more

473
00:21:59,580 --> 00:22:04,139
complicated you need to set up a DNS

474
00:22:01,410 --> 00:22:07,550
server where you could have just get

475
00:22:04,140 --> 00:22:09,929
along with a lone HTTP server so why

476
00:22:07,550 --> 00:22:12,030
well there's an assumption that those

477
00:22:09,929 --> 00:22:14,520
folks were reasonable which proves false

478
00:22:12,030 --> 00:22:17,428
quite frequently for criminals

479
00:22:14,520 --> 00:22:18,270
but given that assumption there is an

480
00:22:17,429 --> 00:22:19,470
obvious answer

481
00:22:18,270 --> 00:22:21,539
an average DNS

482
00:22:19,470 --> 00:22:23,510
server which place and the authoritative

483
00:22:21,539 --> 00:22:25,919
role for a website gets order of

484
00:22:23,510 --> 00:22:29,549
magnitude less traffic than the website

485
00:22:25,919 --> 00:22:34,860
it serves handling all the Amazon web

486
00:22:29,549 --> 00:22:36,780
traffic even for a single 20/24 is quite

487
00:22:34,860 --> 00:22:38,729
expensive while doing it selectively the

488
00:22:36,780 --> 00:22:41,700
way it was done and in my der wallet

489
00:22:38,730 --> 00:22:44,250
case is very cost effective

490
00:22:41,700 --> 00:22:47,039
that makes DNS a more likely target for

491
00:22:44,250 --> 00:22:50,070
future BGP attacks in fact hijacking a

492
00:22:47,039 --> 00:22:52,530
DNS server opens even more possibilities

493
00:22:50,070 --> 00:22:54,629
you can sniff on its own you can trick

494
00:22:52,530 --> 00:22:56,879
cloud container orchestration tools and

495
00:22:54,630 --> 00:23:00,870
so on but our today focus is only

496
00:22:56,880 --> 00:23:04,289
internet facing servers here's how the

497
00:23:00,870 --> 00:23:06,840
security tools tool looks in our Raider

498
00:23:04,289 --> 00:23:08,250
once again for each Amazon autonomous

499
00:23:06,840 --> 00:23:11,789
system there is a number of BGP

500
00:23:08,250 --> 00:23:14,820
incidents happening every day don't

501
00:23:11,789 --> 00:23:16,770
blame Amazon though it's the same nearly

502
00:23:14,820 --> 00:23:19,590
for any well-known cloud services

503
00:23:16,770 --> 00:23:21,210
provider a hosting company or a genius

504
00:23:19,590 --> 00:23:24,209
provider that's a complete mess

505
00:23:21,210 --> 00:23:27,090
any autonomous system administrator can

506
00:23:24,210 --> 00:23:29,789
get an instant access to its own

507
00:23:27,090 --> 00:23:32,039
security information here it only takes

508
00:23:29,789 --> 00:23:34,770
time to register on the website please

509
00:23:32,039 --> 00:23:36,720
forgive me if I have been lost in all

510
00:23:34,770 --> 00:23:39,059
the mergers and acquisitions but last

511
00:23:36,720 --> 00:23:40,710
time I checked no certificate authority

512
00:23:39,059 --> 00:23:44,100
representative has been using the tool

513
00:23:40,710 --> 00:23:46,380
if NEC is in fact doing that then I'm

514
00:23:44,100 --> 00:23:48,240
sorry please send me an email so that we

515
00:23:46,380 --> 00:23:53,520
can see how to maybe tailor it better

516
00:23:48,240 --> 00:23:55,559
for you needs the next involved party

517
00:23:53,520 --> 00:23:57,539
obviously is the DNS community

518
00:23:55,559 --> 00:23:59,370
well things here are slightly better

519
00:23:57,539 --> 00:24:03,000
there is a tool which could save us the

520
00:23:59,370 --> 00:24:07,199
day but which is DNS SEC but whoops the

521
00:24:03,000 --> 00:24:09,780
adoption rate was low to par so far what

522
00:24:07,200 --> 00:24:13,169
did the ISP community do to prevent this

523
00:24:09,780 --> 00:24:16,020
well BGP hijacking as a whole well there

524
00:24:13,169 --> 00:24:18,870
is also a couple of things first of all

525
00:24:16,020 --> 00:24:22,710
a of them wasn't enough so there was a

526
00:24:18,870 --> 00:24:24,570
plan B which guess what log got low

527
00:24:22,710 --> 00:24:26,909
adoption so far but we are not giving up

528
00:24:24,570 --> 00:24:30,418
now we handle and see which we can

529
00:24:26,909 --> 00:24:32,830
contribute to quite far from the final

530
00:24:30,419 --> 00:24:37,690
ultimate solution though but promising

531
00:24:32,830 --> 00:24:40,899
a sad thing is that apparently we cannot

532
00:24:37,690 --> 00:24:43,810
even conduct academic bgp experiments in

533
00:24:40,900 --> 00:24:45,850
wild nature because bgp software present

534
00:24:43,810 --> 00:24:46,929
on the Internet is sometimes old

535
00:24:45,850 --> 00:24:49,540
sometimes buggy

536
00:24:46,930 --> 00:24:52,150
sometimes old and vulnerable and it

537
00:24:49,540 --> 00:24:55,090
literally takes times to update it takes

538
00:24:52,150 --> 00:24:57,370
years to update whatever routing related

539
00:24:55,090 --> 00:24:59,320
piece of code there is I've never seen

540
00:24:57,370 --> 00:25:03,429
same configure or wanna cry victims

541
00:24:59,320 --> 00:25:05,470
yelling at the malware authors because

542
00:25:03,430 --> 00:25:06,940
everyone knows that an insecure system

543
00:25:05,470 --> 00:25:09,160
on the Internet is pretty much doomed

544
00:25:06,940 --> 00:25:11,740
but somehow it's not related to insecure

545
00:25:09,160 --> 00:25:13,660
bgp software so poor researchers who

546
00:25:11,740 --> 00:25:16,180
occasionally triggered a buck in ever

547
00:25:13,660 --> 00:25:18,490
artist January were put under quite

548
00:25:16,180 --> 00:25:23,650
serious public pressure maybe it's just

549
00:25:18,490 --> 00:25:25,390
me but it said long story short we were

550
00:25:23,650 --> 00:25:27,100
reaching the conclusion I've seen people

551
00:25:25,390 --> 00:25:29,580
before criticizing me for not being

552
00:25:27,100 --> 00:25:33,310
optimistic enough in my public speeches

553
00:25:29,580 --> 00:25:35,949
so I listen and I hear what said and I

554
00:25:33,310 --> 00:25:40,840
have put some funny text on the net

555
00:25:35,950 --> 00:25:44,700
slide ya see it's pink comic sense on

556
00:25:40,840 --> 00:25:47,470
top of a yellow oval must be very funny

557
00:25:44,700 --> 00:25:50,830
what's not funny though is that for

558
00:25:47,470 --> 00:25:53,380
years ITF and others has been designing

559
00:25:50,830 --> 00:25:55,330
designing hardened transport protocols

560
00:25:53,380 --> 00:25:58,240
to protect users data the most

561
00:25:55,330 --> 00:26:00,610
contemporary design is quick with HTTP

562
00:25:58,240 --> 00:26:02,590
slash 3 which adds up quite

563
00:26:00,610 --> 00:26:04,300
significantly to the system requirements

564
00:26:02,590 --> 00:26:06,820
of a web server for the sake of

565
00:26:04,300 --> 00:26:09,430
encryption and data protection a funny

566
00:26:06,820 --> 00:26:12,460
thing is that one of the quick design

567
00:26:09,430 --> 00:26:14,410
goals was ok maybe it wasn't really

568
00:26:12,460 --> 00:26:17,380
stated in the spec but it was always

569
00:26:14,410 --> 00:26:18,850
implied to protect innocent users

570
00:26:17,380 --> 00:26:22,840
exercising their freedom of speech

571
00:26:18,850 --> 00:26:24,699
against evil state actors I cannot

572
00:26:22,840 --> 00:26:27,639
really pick a proper board at least

573
00:26:24,700 --> 00:26:30,970
while we are on the record to describe

574
00:26:27,640 --> 00:26:35,350
how feasible and cheap such attacks are

575
00:26:30,970 --> 00:26:37,180
for any possible state actor reassuring

576
00:26:35,350 --> 00:26:39,730
users that everything is going just fine

577
00:26:37,180 --> 00:26:41,320
words for a certain period of time but I

578
00:26:39,730 --> 00:26:42,010
don't really want to be on this planet

579
00:26:41,320 --> 00:26:44,710
anymore

580
00:26:42,010 --> 00:26:46,190
when this period of times time comes to

581
00:26:44,710 --> 00:26:48,710
end

582
00:26:46,190 --> 00:26:50,330
another complaint is that we can't

583
00:26:48,710 --> 00:26:53,480
really say we have a proper solution

584
00:26:50,330 --> 00:26:55,669
that's right but now yeah we don't have

585
00:26:53,480 --> 00:26:58,220
quite have a 300 pages document

586
00:26:55,670 --> 00:27:00,230
presenting a final ultimate solution but

587
00:26:58,220 --> 00:27:02,870
what we have is a set of tools that we

588
00:27:00,230 --> 00:27:06,200
don't use but instead leaving the bottom

589
00:27:02,870 --> 00:27:08,330
of a blocked philip of film cabinet each

590
00:27:06,200 --> 00:27:11,480
of those technologies could limit the

591
00:27:08,330 --> 00:27:14,840
exposure yet now none gets adopted there

592
00:27:11,480 --> 00:27:16,550
are simple things to do say adopt a

593
00:27:14,840 --> 00:27:18,620
multi-hop session with our ADA to

594
00:27:16,550 --> 00:27:21,110
monitor your own autonomous system here

595
00:27:18,620 --> 00:27:24,020
is the link on the slide where you could

596
00:27:21,110 --> 00:27:26,449
do that it's free and it's easier than

597
00:27:24,020 --> 00:27:29,900
adopting a puppy and much more fun I

598
00:27:26,450 --> 00:27:32,210
mean I personally prefer kittens anyway

599
00:27:29,900 --> 00:27:34,190
the combined technical depth in the

600
00:27:32,210 --> 00:27:37,070
internet doesn't appear to shrink the

601
00:27:34,190 --> 00:27:39,200
only girls grows further yet only takes

602
00:27:37,070 --> 00:27:42,129
some time to contribute into pain of the

603
00:27:39,200 --> 00:27:45,310
depth so why not to start now please

604
00:27:42,130 --> 00:27:45,310
thank you

605
00:27:46,100 --> 00:27:50,879
[Applause]

606
00:27:59,790 --> 00:28:04,830
no questions oh yeah what hi I'm Matt

607
00:28:03,390 --> 00:28:06,930
Weinberg from Verisign it should be

608
00:28:04,830 --> 00:28:10,050
noted that that domain was not DNS sex

609
00:28:06,930 --> 00:28:12,570
signed right at the time so had the zone

610
00:28:10,050 --> 00:28:15,990
been DNS X I and any recursive resolver

611
00:28:12,570 --> 00:28:17,340
would have not been happy with that zone

612
00:28:15,990 --> 00:28:20,310
it would have helped them a lot if they

613
00:28:17,340 --> 00:28:24,510
just sign their zone maybe a little plug

614
00:28:20,310 --> 00:28:29,250
for Dina sack maybe but route 53 doesn't

615
00:28:24,510 --> 00:28:32,100
allow to sign domains sorry well maybe

616
00:28:29,250 --> 00:28:35,250
she user of the service support DNS SEC

617
00:28:32,100 --> 00:28:41,100
it's been like the feature request dates

618
00:28:35,250 --> 00:28:42,570
back like six years ago but perfect

619
00:28:41,100 --> 00:28:45,990
follow up Michael Sinatra yes that

620
00:28:42,570 --> 00:28:48,990
rhetorical question why doesn't rub 53

621
00:28:45,990 --> 00:28:55,470
support DNS SEC are you asking that

622
00:28:48,990 --> 00:29:00,510
question for me I'll check with Amazon

623
00:28:55,470 --> 00:29:02,690
okay so I guess let's see thank you very

624
00:29:00,510 --> 00:29:02,690
much

625
00:29:13,320 --> 00:29:15,379
you

