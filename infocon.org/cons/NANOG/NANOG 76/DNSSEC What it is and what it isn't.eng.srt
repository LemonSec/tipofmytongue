1
00:00:10,460 --> 00:00:16,840
[Applause]

2
00:00:13,690 --> 00:00:19,930
yeah so short bit about me so I've been

3
00:00:16,840 --> 00:00:23,880
doing tcp/ip and internet-based stuff

4
00:00:19,930 --> 00:00:29,590
since 84 I started doing DNS in

5
00:00:23,880 --> 00:00:31,479
large-scale in 1990 and the landscape

6
00:00:29,590 --> 00:00:33,340
has changed pretty dramatically in terms

7
00:00:31,480 --> 00:00:37,390
of how it's been abused over the years

8
00:00:33,340 --> 00:00:39,910
both deliberately and inadvertently I'm

9
00:00:37,390 --> 00:00:42,760
gonna go through a few basics first just

10
00:00:39,910 --> 00:00:46,390
so that we have all of the terms we tend

11
00:00:42,760 --> 00:00:48,370
to get very sloppy sometimes in where we

12
00:00:46,390 --> 00:00:50,020
describe the various roles of your DNS

13
00:00:48,370 --> 00:00:51,160
and I'm going to be doing some case

14
00:00:50,020 --> 00:00:52,780
studies with this and I want to make

15
00:00:51,160 --> 00:00:54,699
sure that we're all on the same page and

16
00:00:52,780 --> 00:00:56,739
you're understanding the context of how

17
00:00:54,700 --> 00:00:58,690
I'm using those so we describe that

18
00:00:56,739 --> 00:01:03,940
you're getting exactly what's really

19
00:00:58,690 --> 00:01:07,000
going on so first off Zone on or that

20
00:01:03,940 --> 00:01:10,080
that's the person who actually owns the

21
00:01:07,000 --> 00:01:12,550
brand name whatever you want to call it

22
00:01:10,080 --> 00:01:16,750
they are the ones actually care if that

23
00:01:12,550 --> 00:01:19,420
domain name functions correctly in this

24
00:01:16,750 --> 00:01:22,300
parlance a dns operator is whoever is

25
00:01:19,420 --> 00:01:24,160
running the visible authoritative name

26
00:01:22,300 --> 00:01:26,920
servers on the Internet

27
00:01:24,160 --> 00:01:29,110
whether it's any caster or uni casted

28
00:01:26,920 --> 00:01:31,810
but not the hidden masters not anything

29
00:01:29,110 --> 00:01:35,530
else but the the operator of the public

30
00:01:31,810 --> 00:01:37,110
authoritative servers and this is the

31
00:01:35,530 --> 00:01:39,190
one that I always used to confuse

32
00:01:37,110 --> 00:01:43,239
registrar's of the people that you buy

33
00:01:39,190 --> 00:01:45,729
domain names from and the registry is

34
00:01:43,239 --> 00:01:51,099
the actual database that constructs

35
00:01:45,729 --> 00:01:54,729
those TL DS so I can buy a.com domain

36
00:01:51,099 --> 00:01:58,209
name from any number of registrar's but

37
00:01:54,729 --> 00:02:00,759
Verisign runs the registry that actually

38
00:01:58,209 --> 00:02:05,800
has the stuff that goes into com to do

39
00:02:00,759 --> 00:02:07,239
those delegations there are also a bunch

40
00:02:05,800 --> 00:02:09,758
of roles and we'll be talking about this

41
00:02:07,239 --> 00:02:12,280
because these are all now attack

42
00:02:09,758 --> 00:02:15,279
surfaces and unfortunately the bad

43
00:02:12,280 --> 00:02:16,270
actors in many cases are more

44
00:02:15,280 --> 00:02:19,020
knowledgeable and more sophisticated

45
00:02:16,270 --> 00:02:23,500
than the sysadmin who may have inherited

46
00:02:19,020 --> 00:02:26,610
the DNS infrastructure so it's usually

47
00:02:23,500 --> 00:02:29,470
starts with the stub resolver and that's

48
00:02:26,610 --> 00:02:31,450
most likely to be part of the operating

49
00:02:29,470 --> 00:02:34,780
system of the device that is actually

50
00:02:31,450 --> 00:02:38,859
making the DNS query and in most cases

51
00:02:34,780 --> 00:02:41,950
it is literally a stupid stub and it

52
00:02:38,860 --> 00:02:45,760
just goes to whatever was configured via

53
00:02:41,950 --> 00:02:48,339
DHCP or in your resolve comm or in your

54
00:02:45,760 --> 00:02:52,359
registry and goes and asks a fully

55
00:02:48,340 --> 00:02:54,370
recursive resolver for the answers some

56
00:02:52,360 --> 00:02:56,500
operating systems like Windows and Mac's

57
00:02:54,370 --> 00:02:59,020
do actually also cache for five minutes

58
00:02:56,500 --> 00:03:02,020
within the stub resolver but that's not

59
00:02:59,020 --> 00:03:03,970
a requirement the recursive resolver is

60
00:03:02,020 --> 00:03:06,190
the one that does all of the interesting

61
00:03:03,970 --> 00:03:08,620
work it is the one that will go through

62
00:03:06,190 --> 00:03:10,900
all of starting at the root and going

63
00:03:08,620 --> 00:03:12,340
through all of the delegations to get to

64
00:03:10,900 --> 00:03:15,010
the point where it gets to the name

65
00:03:12,340 --> 00:03:17,470
server that has the answer for the

66
00:03:15,010 --> 00:03:20,019
original question and it then sends it

67
00:03:17,470 --> 00:03:24,130
back to whoever asked usually as I said

68
00:03:20,020 --> 00:03:27,610
the stub resolver in this case almost

69
00:03:24,130 --> 00:03:30,940
always fully recursive resolver czar

70
00:03:27,610 --> 00:03:33,280
also caching so that they can give the

71
00:03:30,940 --> 00:03:34,390
same answer again to other clients

72
00:03:33,280 --> 00:03:37,239
without having to go through all that

73
00:03:34,390 --> 00:03:39,339
work and give the answer faster and then

74
00:03:37,239 --> 00:03:41,019
the other side of the picture are the

75
00:03:39,340 --> 00:03:43,750
authoritative servers and these are the

76
00:03:41,019 --> 00:03:45,790
ones that actually have the zone data

77
00:03:43,750 --> 00:03:49,810
for that particular domain name that

78
00:03:45,790 --> 00:03:53,980
you're interested in and answer only for

79
00:03:49,810 --> 00:03:56,980
that this is in the slides it's mostly

80
00:03:53,980 --> 00:03:58,899
there to show that basically the device

81
00:03:56,980 --> 00:04:01,238
asks the question it goes to the caching

82
00:03:58,900 --> 00:04:05,470
recursive resolver and then it will walk

83
00:04:01,239 --> 00:04:08,850
through the entire tree the only thing

84
00:04:05,470 --> 00:04:10,989
of interest here is that in the old days

85
00:04:08,850 --> 00:04:12,489
everybody including the root server got

86
00:04:10,989 --> 00:04:15,970
the full question if I wanted dub dub

87
00:04:12,489 --> 00:04:18,760
dub example.com that recursive resolver

88
00:04:15,970 --> 00:04:23,290
actually asked the root server for dub

89
00:04:18,760 --> 00:04:24,460
dub dub example.com even though the only

90
00:04:23,290 --> 00:04:29,260
thing that's going to get is a referral

91
00:04:24,460 --> 00:04:31,030
to who has answers for comm cue name

92
00:04:29,260 --> 00:04:34,590
minimization is a standard that is

93
00:04:31,030 --> 00:04:37,690
starting to roll out fairly widely and

94
00:04:34,590 --> 00:04:39,719
that's the one where you only put as

95
00:04:37,690 --> 00:04:41,580
much name into that query as

96
00:04:39,720 --> 00:04:43,590
you need to get that answer so the root

97
00:04:41,580 --> 00:04:49,310
server will only see a question for calm

98
00:04:43,590 --> 00:04:52,619
they won't see dubbed example calm and

99
00:04:49,310 --> 00:04:56,670
the common security problems that we see

100
00:04:52,620 --> 00:04:58,340
and that we were hoping to address one

101
00:04:56,670 --> 00:05:01,860
of them is simply denial of service

102
00:04:58,340 --> 00:05:04,830
guaranteeing that you were unable to get

103
00:05:01,860 --> 00:05:06,840
an answer for that zone probably the

104
00:05:04,830 --> 00:05:10,830
most notable example in in recent

105
00:05:06,840 --> 00:05:12,900
history was the dine outage in 2015

106
00:05:10,830 --> 00:05:15,570
where basically they melted connection

107
00:05:12,900 --> 00:05:16,979
points such that you couldn't get to

108
00:05:15,570 --> 00:05:18,900
their authoritative service and and

109
00:05:16,980 --> 00:05:22,950
little useless things like Twitter

110
00:05:18,900 --> 00:05:25,650
disappear off the face of the earth one

111
00:05:22,950 --> 00:05:29,400
of the other ones which really drove DNS

112
00:05:25,650 --> 00:05:30,780
SEC deployment back in 2008 cache

113
00:05:29,400 --> 00:05:34,039
poisoning and we'll talk more about

114
00:05:30,780 --> 00:05:38,909
exactly what it means when you poison

115
00:05:34,040 --> 00:05:40,530
the recursive resolvers cache people set

116
00:05:38,910 --> 00:05:41,820
up false authoritative server so if I

117
00:05:40,530 --> 00:05:43,890
can get you to go to something that

118
00:05:41,820 --> 00:05:46,140
isn't the server that's supposed to be

119
00:05:43,890 --> 00:05:48,090
there it's not the DNS operators it's

120
00:05:46,140 --> 00:05:50,400
one that I is the bad guy I'm running I

121
00:05:48,090 --> 00:05:52,349
can put whatever zone data and I want I

122
00:05:50,400 --> 00:05:54,630
can change where your web queries go I

123
00:05:52,350 --> 00:05:56,340
can change where your email goes I can

124
00:05:54,630 --> 00:05:58,140
set up man in the middle or honey pots I

125
00:05:56,340 --> 00:06:00,929
can do all sorts of nasty little things

126
00:05:58,140 --> 00:06:02,550
if I can convince you to go to this

127
00:06:00,930 --> 00:06:06,150
server that it's not the real

128
00:06:02,550 --> 00:06:08,610
authoritative and then finally if you

129
00:06:06,150 --> 00:06:10,830
can get the credentials for the zone

130
00:06:08,610 --> 00:06:13,200
owner or whoever maintains the zone data

131
00:06:10,830 --> 00:06:14,609
and you can actually go into that zone I

132
00:06:13,200 --> 00:06:16,890
don't even need a false authoritative

133
00:06:14,610 --> 00:06:20,580
server I can just change the data within

134
00:06:16,890 --> 00:06:22,800
the DNS zone itself and so primarily

135
00:06:20,580 --> 00:06:24,570
these are what we are seeing in DNS

136
00:06:22,800 --> 00:06:26,220
attacks I'm not going to be talking

137
00:06:24,570 --> 00:06:30,120
about some of the other things like DNS

138
00:06:26,220 --> 00:06:32,460
tunneling where DNS is used as and other

139
00:06:30,120 --> 00:06:36,950
means where command and control this is

140
00:06:32,460 --> 00:06:40,200
about hijacking the DNS data itself

141
00:06:36,950 --> 00:06:43,530
results of those obviously you get no

142
00:06:40,200 --> 00:06:45,360
answer at all so your business is off

143
00:06:43,530 --> 00:06:48,479
the internet and and failing to take

144
00:06:45,360 --> 00:06:51,060
anything or I can set up a fake site and

145
00:06:48,479 --> 00:06:51,960
if I can set up a fake site and I can

146
00:06:51,060 --> 00:06:54,180
get to your users too

147
00:06:51,960 --> 00:06:59,219
that instead I can steal login

148
00:06:54,180 --> 00:07:04,800
credentials I can give out false data I

149
00:06:59,220 --> 00:07:07,410
can give embarrassing alternatives or I

150
00:07:04,800 --> 00:07:09,389
can quietly make it look like it's

151
00:07:07,410 --> 00:07:12,180
working normally and I can eavesdrop on

152
00:07:09,389 --> 00:07:19,199
your email or your web traffic or other

153
00:07:12,180 --> 00:07:22,229
things so some DNS SEC basics in the

154
00:07:19,199 --> 00:07:25,050
simplest terms DNS SEC is just public

155
00:07:22,229 --> 00:07:27,870
key or asymmetric encryption and the way

156
00:07:25,050 --> 00:07:29,970
that works is you generate a pair of

157
00:07:27,870 --> 00:07:32,789
keys one of which is public and and

158
00:07:29,970 --> 00:07:35,550
given out widely and one of which you

159
00:07:32,789 --> 00:07:40,229
keep very secure in private and those

160
00:07:35,550 --> 00:07:44,130
pairs of keys allow you to either sign

161
00:07:40,229 --> 00:07:45,870
or encrypt data private keys are always

162
00:07:44,130 --> 00:07:47,250
kept very secure because if someone can

163
00:07:45,870 --> 00:07:50,039
get your private key they can counter

164
00:07:47,250 --> 00:07:52,740
finish you or they can decrypt things

165
00:07:50,039 --> 00:07:56,550
that you wanted to keep secure in the

166
00:07:52,740 --> 00:07:58,919
DNS use of this they do with digital

167
00:07:56,550 --> 00:08:01,380
signatures nothing is encrypted with the

168
00:07:58,919 --> 00:08:03,930
keys but there are signatures so you can

169
00:08:01,380 --> 00:08:07,289
validate that nothing has changed

170
00:08:03,930 --> 00:08:09,000
and since DNS publishes anyway and

171
00:08:07,289 --> 00:08:10,830
public keys are supposed to be widely

172
00:08:09,000 --> 00:08:13,289
available they've taken advantage of

173
00:08:10,830 --> 00:08:15,719
that so the public keys are actually put

174
00:08:13,289 --> 00:08:20,280
into the zone with other zone data along

175
00:08:15,719 --> 00:08:22,349
with the signatures and you can take

176
00:08:20,280 --> 00:08:25,138
those public keys and you can take those

177
00:08:22,349 --> 00:08:28,919
signatures and you can walk that whole

178
00:08:25,139 --> 00:08:31,320
chain through and you can then use those

179
00:08:28,919 --> 00:08:33,149
to validate all of the signatures and if

180
00:08:31,320 --> 00:08:35,039
you can do all of those you have

181
00:08:33,149 --> 00:08:37,890
assurance that whatever DNS answer you

182
00:08:35,039 --> 00:08:41,968
got has not been modified from what is

183
00:08:37,890 --> 00:08:45,270
in the zone and if for some reason

184
00:08:41,969 --> 00:08:48,810
validation does fail if the if you are

185
00:08:45,270 --> 00:08:51,449
DNS ex signing your data but that answer

186
00:08:48,810 --> 00:08:53,369
fails to validate the user will get no

187
00:08:51,450 --> 00:08:55,260
answer so if somebody does something

188
00:08:53,370 --> 00:08:57,329
malicious the user is protected from

189
00:08:55,260 --> 00:08:59,250
going to that bad site because they

190
00:08:57,329 --> 00:09:02,959
won't ever get da record or quad a

191
00:08:59,250 --> 00:09:05,350
record so

192
00:09:02,960 --> 00:09:07,760
first we'll talk about what DNS SEC

193
00:09:05,350 --> 00:09:09,110
actually solves and what are the

194
00:09:07,760 --> 00:09:11,150
problems that we're talking about in

195
00:09:09,110 --> 00:09:15,110
security that it potentially could solve

196
00:09:11,150 --> 00:09:18,050
so most people when they break down

197
00:09:15,110 --> 00:09:19,850
security will describe that there are

198
00:09:18,050 --> 00:09:24,290
certain key things that you need to be

199
00:09:19,850 --> 00:09:27,220
able to do or not do confidentiality can

200
00:09:24,290 --> 00:09:32,329
I prevent anyone who's not authorized

201
00:09:27,220 --> 00:09:34,700
from getting this data integrity how do

202
00:09:32,330 --> 00:09:36,470
I know that someone hasn't in some way

203
00:09:34,700 --> 00:09:38,210
modified the data from the original

204
00:09:36,470 --> 00:09:41,930
sender all the way to me is the

205
00:09:38,210 --> 00:09:44,450
recipient and availability can I get to

206
00:09:41,930 --> 00:09:46,699
that data when I want that data or can

207
00:09:44,450 --> 00:09:52,250
someone prevent me from it from getting

208
00:09:46,700 --> 00:09:56,060
it so DNS SEC solves the integrity

209
00:09:52,250 --> 00:09:58,790
problem because when I put it into the

210
00:09:56,060 --> 00:10:01,640
zone and I digitally create signatures

211
00:09:58,790 --> 00:10:04,310
for it and publish the public key and do

212
00:10:01,640 --> 00:10:06,380
all of the stuff that I need to do you

213
00:10:04,310 --> 00:10:09,229
can go through and validate and you can

214
00:10:06,380 --> 00:10:11,120
tell that what I put in the zone file

215
00:10:09,230 --> 00:10:16,959
actually got all the way there

216
00:10:11,120 --> 00:10:21,680
so cache poisoning because DNS

217
00:10:16,959 --> 00:10:26,170
generically is udp-based I can send a

218
00:10:21,680 --> 00:10:28,729
single packet as a DNS response and that

219
00:10:26,170 --> 00:10:31,400
resolver if it's asked for the answer to

220
00:10:28,730 --> 00:10:34,760
dub dub dub at example.com and a UDP

221
00:10:31,400 --> 00:10:36,650
packet comes back that says be a record

222
00:10:34,760 --> 00:10:42,680
for dub dub dub that example.com is

223
00:10:36,650 --> 00:10:47,390
1.2.3.4 and I'm not doing DNS SEC I will

224
00:10:42,680 --> 00:10:51,589
stick it in my cache and in 2008 Dan

225
00:10:47,390 --> 00:10:52,850
Kaminsky did some research and talk to

226
00:10:51,589 --> 00:10:53,930
me offline if you want the really gory

227
00:10:52,850 --> 00:10:56,060
details but there's something called the

228
00:10:53,930 --> 00:11:02,060
birthday attack which basically says

229
00:10:56,060 --> 00:11:03,619
that counter-intuitively if I have 50

230
00:11:02,060 --> 00:11:06,140
people in the room the chance of two

231
00:11:03,620 --> 00:11:08,300
people having the same birthday is 80

232
00:11:06,140 --> 00:11:11,810
percent or whatever it is but within a

233
00:11:08,300 --> 00:11:15,709
fairly finite amount somewhere in the

234
00:11:11,810 --> 00:11:16,849
low 500s I have a 99.9% chance that

235
00:11:15,709 --> 00:11:22,430
there will be cool

236
00:11:16,850 --> 00:11:24,529
and so what Dan discovered was if you

237
00:11:22,430 --> 00:11:27,589
simply sent four or five hundred packets

238
00:11:24,529 --> 00:11:29,689
with responses that were bad or

239
00:11:27,589 --> 00:11:32,060
malicious at the same time that you

240
00:11:29,690 --> 00:11:35,480
could generate a query for that answer

241
00:11:32,060 --> 00:11:37,369
the odds were almost guaranteed that the

242
00:11:35,480 --> 00:11:39,380
cash would take that instead of the

243
00:11:37,370 --> 00:11:42,529
legitimate authoritative servers answer

244
00:11:39,380 --> 00:11:43,850
and they would cash it and of course

245
00:11:42,529 --> 00:11:45,740
they would also put a TTL that was

246
00:11:43,850 --> 00:11:48,200
really really long so that that answer

247
00:11:45,740 --> 00:11:50,930
stayed in that cache for a very long

248
00:11:48,200 --> 00:11:52,730
time and so what happens is everybody

249
00:11:50,930 --> 00:11:56,479
who then asks after that cache is

250
00:11:52,730 --> 00:12:00,529
poisoned gets the malicious answer DNS

251
00:11:56,480 --> 00:12:03,589
SEC because the caching server won't

252
00:12:00,529 --> 00:12:05,390
cache it unless it validates if it fails

253
00:12:03,589 --> 00:12:08,180
to validate it simply throws that answer

254
00:12:05,390 --> 00:12:09,920
away so the most effective thing that we

255
00:12:08,180 --> 00:12:12,439
have right now for cache poisoning is

256
00:12:09,920 --> 00:12:14,300
DNS SEC because of that integrity check

257
00:12:12,440 --> 00:12:16,459
we know that the answer is what was

258
00:12:14,300 --> 00:12:19,069
supposed to be in the zone data or we

259
00:12:16,459 --> 00:12:21,229
don't accept it at all it also means

260
00:12:19,070 --> 00:12:25,310
that if I set up a false authoritative

261
00:12:21,230 --> 00:12:27,920
server I don't have the private key so I

262
00:12:25,310 --> 00:12:32,329
can't sign those records so none of them

263
00:12:27,920 --> 00:12:34,010
will validate and so again if I managed

264
00:12:32,330 --> 00:12:36,980
to somehow get you to come to a false

265
00:12:34,010 --> 00:12:40,040
server but the correct zone is signed

266
00:12:36,980 --> 00:12:42,110
you won't accept those answers either so

267
00:12:40,040 --> 00:12:44,000
in both cases what this means is the

268
00:12:42,110 --> 00:12:45,560
end-to-end integrity from the original

269
00:12:44,000 --> 00:12:47,480
source of the zone file all the way to

270
00:12:45,560 --> 00:12:50,479
the stub resolver and into the device or

271
00:12:47,480 --> 00:12:53,350
app that asked we can know that it's the

272
00:12:50,480 --> 00:12:57,890
same it hasn't been modified in transit

273
00:12:53,350 --> 00:13:01,790
okay that's great but DNS SEC doesn't

274
00:12:57,890 --> 00:13:05,209
solve every problem one of them it

275
00:13:01,790 --> 00:13:07,160
doesn't encrypt all DNS even DNS X sign

276
00:13:05,209 --> 00:13:09,079
still goes in the clear so anybody who

277
00:13:07,160 --> 00:13:12,199
is in the network path and can observe

278
00:13:09,079 --> 00:13:15,199
packets going by can see the query and

279
00:13:12,200 --> 00:13:17,029
the response so if you don't want

280
00:13:15,200 --> 00:13:18,529
someone to know that you are going to

281
00:13:17,029 --> 00:13:21,709
AIDS org

282
00:13:18,529 --> 00:13:23,810
like your insurance company that's a

283
00:13:21,709 --> 00:13:25,849
problem because if somehow they can see

284
00:13:23,810 --> 00:13:27,500
that data going by they know that a

285
00:13:25,850 --> 00:13:30,140
particular IP address in a particular

286
00:13:27,500 --> 00:13:34,100
home is asking about a particular

287
00:13:30,140 --> 00:13:35,000
yes answer so confidentiality is

288
00:13:34,100 --> 00:13:37,400
definitely one of the things that

289
00:13:35,000 --> 00:13:41,150
doesn't do it doesn't fix availability

290
00:13:37,400 --> 00:13:44,959
I can still disrupt things by breaking

291
00:13:41,150 --> 00:13:47,209
signatures clogging links knocking you

292
00:13:44,960 --> 00:13:51,470
off the net tossing your machine

293
00:13:47,210 --> 00:13:54,050
whatever it also you get what's in the

294
00:13:51,470 --> 00:13:57,110
zone but that doesn't it's not

295
00:13:54,050 --> 00:13:58,670
autocorrect for DNS if I fat-finger

296
00:13:57,110 --> 00:14:00,590
something and put the wrong name or the

297
00:13:58,670 --> 00:14:03,410
wrong IP address into my zone file and I

298
00:14:00,590 --> 00:14:04,820
sign it you will get something and it

299
00:14:03,410 --> 00:14:10,370
will validate but that doesn't mean it

300
00:14:04,820 --> 00:14:14,000
will work and finally you don't by

301
00:14:10,370 --> 00:14:17,660
signing your zone control the parent so

302
00:14:14,000 --> 00:14:19,340
for example comm you have to trust that

303
00:14:17,660 --> 00:14:21,829
whoever's running comm is doing

304
00:14:19,340 --> 00:14:25,280
something to be to be sane and secure

305
00:14:21,830 --> 00:14:27,170
themselves but you doing DNS SEC doesn't

306
00:14:25,280 --> 00:14:29,900
necessarily mean that your parent is

307
00:14:27,170 --> 00:14:31,760
secure and if they're not signing you

308
00:14:29,900 --> 00:14:33,319
can't use DNS SEC because it must be a

309
00:14:31,760 --> 00:14:35,750
complete chain all the way from the root

310
00:14:33,320 --> 00:14:37,940
all the way down there are ways of doing

311
00:14:35,750 --> 00:14:40,940
things with additional trust anchors and

312
00:14:37,940 --> 00:14:42,800
other things but they are not clean and

313
00:14:40,940 --> 00:14:47,110
they still don't mean universal

314
00:14:42,800 --> 00:14:49,849
availability of that DNS SEC validation

315
00:14:47,110 --> 00:14:51,200
so I'm gonna talk now about the meet of

316
00:14:49,850 --> 00:14:52,670
this now that we've sort of explained

317
00:14:51,200 --> 00:14:55,280
the ground rules and a little bit about

318
00:14:52,670 --> 00:14:59,060
what D in a second is not I've got some

319
00:14:55,280 --> 00:15:01,490
examples of DNS hijacking broadly and in

320
00:14:59,060 --> 00:15:06,140
the broader sense DNS SEC or hijacking

321
00:15:01,490 --> 00:15:09,850
is you somehow managed to make sure that

322
00:15:06,140 --> 00:15:12,319
the intended consumer of that DNS answer

323
00:15:09,850 --> 00:15:15,200
gets the answer you want them to have

324
00:15:12,320 --> 00:15:17,570
not the correct answer and there are a

325
00:15:15,200 --> 00:15:19,880
number of places that because there are

326
00:15:17,570 --> 00:15:23,570
so many tax surfaces that you can

327
00:15:19,880 --> 00:15:25,580
subvert that data and I've picked some

328
00:15:23,570 --> 00:15:29,330
recent ones there was an incident with a

329
00:15:25,580 --> 00:15:31,900
Brazilian bank there was a website

330
00:15:29,330 --> 00:15:37,100
two-face meant for the WikiLeaks site

331
00:15:31,900 --> 00:15:40,130
there was an ether wallet Bitcoin

332
00:15:37,100 --> 00:15:41,960
cryptocurrency issue and then most

333
00:15:40,130 --> 00:15:43,819
recently what they're calling D an

334
00:15:41,960 --> 00:15:46,709
espionage which is a

335
00:15:43,819 --> 00:15:50,238
nation-state plumbing and and

336
00:15:46,709 --> 00:15:55,378
exploration of other sovereign nations

337
00:15:50,239 --> 00:15:59,009
so Brazilian bank was fairly

338
00:15:55,379 --> 00:16:02,009
straightforward it was a Brazilian ISP

339
00:15:59,009 --> 00:16:05,879
was giving out cheap CPE routers that

340
00:16:02,009 --> 00:16:08,459
had unpatched bugs and as we all knows

341
00:16:05,879 --> 00:16:13,980
you know consumer grade CPU routers or

342
00:16:08,459 --> 00:16:17,579
the gift to keep on giving and so they

343
00:16:13,980 --> 00:16:19,619
figured out a way of changing the

344
00:16:17,579 --> 00:16:22,829
resolver from the stub resolver that was

345
00:16:19,619 --> 00:16:25,379
in the router to their own code and in

346
00:16:22,829 --> 00:16:27,959
most cases for most home set ups your

347
00:16:25,379 --> 00:16:30,179
CPE is also your home router and it does

348
00:16:27,959 --> 00:16:33,209
the DHCP so all of the devices in that

349
00:16:30,179 --> 00:16:35,339
home will change their recursive

350
00:16:33,209 --> 00:16:38,160
resolver to use that router as the

351
00:16:35,339 --> 00:16:40,679
resolver and what they did was they

352
00:16:38,160 --> 00:16:43,290
simply had this code work correctly for

353
00:16:40,679 --> 00:16:45,899
everything except for a particular bank

354
00:16:43,290 --> 00:16:48,689
that they wanted to target any queries

355
00:16:45,899 --> 00:16:51,389
for that bank instead gave answers for a

356
00:16:48,689 --> 00:16:52,799
fake site that they set up and since

357
00:16:51,389 --> 00:16:57,749
they could control what site they went

358
00:16:52,799 --> 00:16:59,610
to they basically had a little man in

359
00:16:57,749 --> 00:17:01,079
the middle and they watched everybody's

360
00:16:59,610 --> 00:17:05,189
login and password as it went through

361
00:17:01,079 --> 00:17:07,589
and then they logged you in helpfully to

362
00:17:05,189 --> 00:17:10,350
the bank so customers didn't notice

363
00:17:07,589 --> 00:17:13,010
until those credentials were used and

364
00:17:10,349 --> 00:17:15,658
they started emptying bank accounts so

365
00:17:13,010 --> 00:17:18,689
the result of this was basically a

366
00:17:15,659 --> 00:17:22,399
number of Brazilian banking customers

367
00:17:18,689 --> 00:17:23,970
lost the money in their accounts so

368
00:17:22,398 --> 00:17:26,609
remediations for this are pretty

369
00:17:23,970 --> 00:17:28,230
straightforward the biggest thing in

370
00:17:26,609 --> 00:17:30,389
this case would be actually running

371
00:17:28,230 --> 00:17:32,070
decent secure and currently patched

372
00:17:30,389 --> 00:17:35,939
routers because they wouldn't have been

373
00:17:32,070 --> 00:17:38,549
able to put the code on DNS SEC would

374
00:17:35,940 --> 00:17:41,460
only have been useful if the individual

375
00:17:38,549 --> 00:17:43,590
devices in that home had themselves been

376
00:17:41,460 --> 00:17:45,149
doing validation because they would have

377
00:17:43,590 --> 00:17:49,080
then noticed that what the router gave

378
00:17:45,149 --> 00:17:51,899
them didn't validate and at least at the

379
00:17:49,080 --> 00:17:54,270
moment there are is code the stubby

380
00:17:51,899 --> 00:17:56,399
project and a couple of other things for

381
00:17:54,270 --> 00:17:57,520
trying to come up with validating stub

382
00:17:56,399 --> 00:17:59,469
resolver small and

383
00:17:57,520 --> 00:18:03,460
to fit on two devices but that's

384
00:17:59,470 --> 00:18:08,679
certainly not common at the moment and

385
00:18:03,460 --> 00:18:10,690
then regular searches for malicious

386
00:18:08,679 --> 00:18:13,780
certs might have given them something

387
00:18:10,690 --> 00:18:17,140
because if they went to the bank and it

388
00:18:13,780 --> 00:18:19,809
was HTTP they might have noticed that

389
00:18:17,140 --> 00:18:24,220
somebody got dub dub dub Brazilian bank

390
00:18:19,809 --> 00:18:26,559
comm with a CA that they didn't use or

391
00:18:24,220 --> 00:18:28,030
with a cert they didn't expect that one

392
00:18:26,559 --> 00:18:29,620
unfortunately is much harder to catch

393
00:18:28,030 --> 00:18:31,899
and will sort of bump into this with

394
00:18:29,620 --> 00:18:34,360
several of these certificate

395
00:18:31,900 --> 00:18:36,670
transparency logs and some of the

396
00:18:34,360 --> 00:18:39,100
attempts at that or pinning are trying

397
00:18:36,670 --> 00:18:42,220
to make the whole CMS less of a

398
00:18:39,100 --> 00:18:44,939
festering security pile but it's kind of

399
00:18:42,220 --> 00:18:49,690
fundamentally broken at the moment

400
00:18:44,940 --> 00:18:51,580
WikiLeaks was actually much more simple

401
00:18:49,690 --> 00:18:55,179
they basically somehow got the account

402
00:18:51,580 --> 00:18:58,000
credentials for the zone owner and they

403
00:18:55,179 --> 00:19:00,460
just went in and changed the IP address

404
00:18:58,000 --> 00:19:01,929
on the a record so it looked like their

405
00:19:00,460 --> 00:19:03,880
site had been hacked and they said we

406
00:19:01,929 --> 00:19:06,160
have hacked the website and and blah

407
00:19:03,880 --> 00:19:07,809
blah blah but that wasn't true the

408
00:19:06,160 --> 00:19:09,520
website was out there just no one was

409
00:19:07,809 --> 00:19:14,770
going to it because they were going to a

410
00:19:09,520 --> 00:19:18,220
false one and in this case very simple

411
00:19:14,770 --> 00:19:22,600
you know credentials keep them secure

412
00:19:18,220 --> 00:19:25,960
and if they'd had DNS SEC and if they'd

413
00:19:22,600 --> 00:19:28,300
actually checked to see that everything

414
00:19:25,960 --> 00:19:30,580
was up in the parent and hadn't changed

415
00:19:28,300 --> 00:19:33,580
it might have given them some more

416
00:19:30,580 --> 00:19:36,250
warning but that's another and we'll get

417
00:19:33,580 --> 00:19:40,960
to this with the last attack that we

418
00:19:36,250 --> 00:19:42,520
were covering des records and NS records

419
00:19:40,960 --> 00:19:46,300
and parents tend to have very long TT

420
00:19:42,520 --> 00:19:50,020
ELLs so most of us don't check them very

421
00:19:46,300 --> 00:19:52,570
often which means that if you can change

422
00:19:50,020 --> 00:19:54,070
things in the parent life gets really

423
00:19:52,570 --> 00:20:00,159
dicey and it's actually very hard to

424
00:19:54,070 --> 00:20:02,409
catch my teeth or wallet a little bit

425
00:20:00,160 --> 00:20:06,100
more interesting what they figured out

426
00:20:02,410 --> 00:20:09,640
was they could actually do a BGP route

427
00:20:06,100 --> 00:20:10,330
hijack of the actual IP address of the

428
00:20:09,640 --> 00:20:14,230
website

429
00:20:10,330 --> 00:20:16,689
and so the real website was still up DNS

430
00:20:14,230 --> 00:20:19,590
was still working and most people were

431
00:20:16,690 --> 00:20:22,990
getting to the correct website but

432
00:20:19,590 --> 00:20:26,159
enough of them wound up getting along

433
00:20:22,990 --> 00:20:29,470
the hijacked route and to the fake one

434
00:20:26,160 --> 00:20:31,150
and they didn't do their certificate

435
00:20:29,470 --> 00:20:34,090
stuff right but unfortunately we've also

436
00:20:31,150 --> 00:20:36,630
trained users of the this certificate

437
00:20:34,090 --> 00:20:42,060
doesn't match is that okay click and

438
00:20:36,630 --> 00:20:44,440
they punch right through and so they did

439
00:20:42,060 --> 00:20:46,300
they went to the fake site their

440
00:20:44,440 --> 00:20:48,310
credentials were stripped their accounts

441
00:20:46,300 --> 00:20:52,990
were emptied and cryptocurrency went

442
00:20:48,310 --> 00:20:54,340
away so this is one where we're getting

443
00:20:52,990 --> 00:20:58,000
sort of into the core of what Nana

444
00:20:54,340 --> 00:21:00,909
preaches anyway BGP and routing security

445
00:20:58,000 --> 00:21:03,010
obviously would have helped this and if

446
00:21:00,910 --> 00:21:06,310
more people were implementing rpki and

447
00:21:03,010 --> 00:21:07,660
doing drops and not just logging they

448
00:21:06,310 --> 00:21:09,220
wouldn't have been able to take care of

449
00:21:07,660 --> 00:21:13,090
this and that would have been the most

450
00:21:09,220 --> 00:21:16,180
useful thing DNS SEC might have helped a

451
00:21:13,090 --> 00:21:19,110
bit but once again if users are willing

452
00:21:16,180 --> 00:21:21,640
to click through certs and other things

453
00:21:19,110 --> 00:21:23,979
it it might have made it easier to

454
00:21:21,640 --> 00:21:25,810
notice earlier if they had been actually

455
00:21:23,980 --> 00:21:28,120
looking at that because validation would

456
00:21:25,810 --> 00:21:30,190
have failed for some of the stuff but

457
00:21:28,120 --> 00:21:31,689
they would have also had to have probing

458
00:21:30,190 --> 00:21:33,640
that was sufficiently distributed across

459
00:21:31,690 --> 00:21:35,500
enough IAS a--'s that they would have

460
00:21:33,640 --> 00:21:38,950
had some of their probes actually in the

461
00:21:35,500 --> 00:21:40,840
areas where the hijack route 1 that's

462
00:21:38,950 --> 00:21:42,190
another one of those why doing things

463
00:21:40,840 --> 00:21:44,080
with anycast is really cool for

464
00:21:42,190 --> 00:21:47,490
robustness but really hard to debug if

465
00:21:44,080 --> 00:21:49,389
something goes wrong and then again

466
00:21:47,490 --> 00:21:51,840
watching your certs is certainly

467
00:21:49,390 --> 00:21:55,150
something that everybody should be doing

468
00:21:51,840 --> 00:21:57,040
unfortunately it's unclear how practical

469
00:21:55,150 --> 00:22:01,780
in in real terms it would be at catching

470
00:21:57,040 --> 00:22:04,480
this so now we get into probably the

471
00:22:01,780 --> 00:22:08,560
most interesting of them this was a

472
00:22:04,480 --> 00:22:13,630
campaign by the Iranian military they

473
00:22:08,560 --> 00:22:15,940
have a cyber hacking team and basically

474
00:22:13,630 --> 00:22:18,580
they come in every morning and go to

475
00:22:15,940 --> 00:22:21,190
work seeing what they can do to find

476
00:22:18,580 --> 00:22:23,530
credentials for people that they don't

477
00:22:21,190 --> 00:22:26,350
like and in this case the two

478
00:22:23,530 --> 00:22:29,560
biggest winners or losers were UAE and

479
00:22:26,350 --> 00:22:33,790
Lebanon who they had concerns about and

480
00:22:29,560 --> 00:22:37,480
so at some point in time they had

481
00:22:33,790 --> 00:22:39,879
managed to get via a data dump they'd

482
00:22:37,480 --> 00:22:45,160
gotten from a previous hack and then

483
00:22:39,880 --> 00:22:48,280
stripping of data EPP credentials so EPP

484
00:22:45,160 --> 00:22:51,340
is the protocol that when a registrar

485
00:22:48,280 --> 00:22:54,670
makes a change that needs to go into the

486
00:22:51,340 --> 00:22:56,110
registry so I register example.com and

487
00:22:54,670 --> 00:22:59,440
they need to insert something into the

488
00:22:56,110 --> 00:23:05,139
dot-com registry the protocol that they

489
00:22:59,440 --> 00:23:08,680
use via API to do that is EPP and EPP

490
00:23:05,140 --> 00:23:12,940
use asserts which are effectively just

491
00:23:08,680 --> 00:23:16,560
like a password or a an SSL cert and so

492
00:23:12,940 --> 00:23:20,980
they got the credentials for a couple of

493
00:23:16,560 --> 00:23:23,830
registry operators including that node

494
00:23:20,980 --> 00:23:26,800
in Sweden and PCH packet Clearing House

495
00:23:23,830 --> 00:23:28,210
and now these are people they know DNS

496
00:23:26,800 --> 00:23:31,600
SEC they are very technically

497
00:23:28,210 --> 00:23:34,060
sophisticated but somehow some someone

498
00:23:31,600 --> 00:23:37,540
had leaked some of the UPP credentials

499
00:23:34,060 --> 00:23:42,460
so they were actually able to get into

500
00:23:37,540 --> 00:23:45,460
the parent now fortunately the Iranians

501
00:23:42,460 --> 00:23:47,380
were not terribly DNS sex savvy because

502
00:23:45,460 --> 00:23:48,850
if they'd been really good what they

503
00:23:47,380 --> 00:23:50,890
would have done was they would have made

504
00:23:48,850 --> 00:23:53,050
sure that DNS SEC wouldn't possibly ever

505
00:23:50,890 --> 00:23:55,240
be an issue by simply taking the DES

506
00:23:53,050 --> 00:23:58,240
records out in calm for example calm

507
00:23:55,240 --> 00:24:00,750
there's now you can't possibly cyan

508
00:23:58,240 --> 00:24:03,700
example.com nor can you validate it

509
00:24:00,750 --> 00:24:06,060
fortunately they did not what they did

510
00:24:03,700 --> 00:24:07,930
do was they changed the NSS and

511
00:24:06,060 --> 00:24:09,460
interestingly enough what they were

512
00:24:07,930 --> 00:24:11,350
doing was they were trying to fly under

513
00:24:09,460 --> 00:24:13,990
the radar so this was happening over

514
00:24:11,350 --> 00:24:16,090
December in January when most of the

515
00:24:13,990 --> 00:24:18,910
world was on holiday and that was

516
00:24:16,090 --> 00:24:20,800
apparently a very deliberate choice and

517
00:24:18,910 --> 00:24:25,390
they would change the NS for an hour at

518
00:24:20,800 --> 00:24:27,310
a time and then change it back so they

519
00:24:25,390 --> 00:24:29,800
also interestingly enough they did

520
00:24:27,310 --> 00:24:31,510
understand enough to know that let's

521
00:24:29,800 --> 00:24:32,919
encrypt which is usually what they use

522
00:24:31,510 --> 00:24:34,530
for getting their fake certs when they

523
00:24:32,920 --> 00:24:36,880
set up their man-in-the-middle websites

524
00:24:34,530 --> 00:24:39,700
it actually checks for sea

525
00:24:36,880 --> 00:24:41,350
records in the zone and it actually DNS

526
00:24:39,700 --> 00:24:44,100
SEC validates those and if it doesn't

527
00:24:41,350 --> 00:24:47,290
validate they won't give you a cert

528
00:24:44,100 --> 00:24:49,510
comodo on the other hand is still of the

529
00:24:47,290 --> 00:24:55,540
yep the credit card works and that's

530
00:24:49,510 --> 00:25:02,050
their validation so they got certs from

531
00:24:55,540 --> 00:25:06,010
Komodo for the PCH networks and so what

532
00:25:02,050 --> 00:25:08,649
they would do was at that hour they

533
00:25:06,010 --> 00:25:12,129
would change the NSS and they would now

534
00:25:08,650 --> 00:25:14,080
point to their own which had IMAP and

535
00:25:12,130 --> 00:25:16,320
web and other things pointing to

536
00:25:14,080 --> 00:25:22,179
machines of theirs that they had set up

537
00:25:16,320 --> 00:25:24,970
man in the middle and PCH because they

538
00:25:22,180 --> 00:25:27,660
were doing DNS SEC and they hadn't

539
00:25:24,970 --> 00:25:30,880
disabled DNS SEC it didn't validate and

540
00:25:27,660 --> 00:25:33,700
what they discovered was that their IMAP

541
00:25:30,880 --> 00:25:36,580
client when you can't reach the site or

542
00:25:33,700 --> 00:25:39,010
when it fails to log in it simply says

543
00:25:36,580 --> 00:25:42,820
no new mail it doesn't give you an error

544
00:25:39,010 --> 00:25:44,830
I can't get to the other site so it was

545
00:25:42,820 --> 00:25:47,830
during that the Christmas holidays

546
00:25:44,830 --> 00:25:48,970
anyway traffic was lighter and it only

547
00:25:47,830 --> 00:25:51,070
happened for an hour and so they were

548
00:25:48,970 --> 00:25:53,350
going oh I'm just getting less mail than

549
00:25:51,070 --> 00:25:58,240
usual okay

550
00:25:53,350 --> 00:26:00,340
the problem was two of their employees

551
00:25:58,240 --> 00:26:03,460
were at a hotel with a captive portal

552
00:26:00,340 --> 00:26:06,129
that required using their DNS recursive

553
00:26:03,460 --> 00:26:11,020
resolver it was not doing DNS SEC

554
00:26:06,130 --> 00:26:14,110
validation fun number one fun number two

555
00:26:11,020 --> 00:26:17,139
they were on iPhones which as soon as

556
00:26:14,110 --> 00:26:21,100
they locked and got an IP address even

557
00:26:17,140 --> 00:26:24,240
before they had validated with the open

558
00:26:21,100 --> 00:26:29,230
portal were immediately trying to log in

559
00:26:24,240 --> 00:26:31,660
and they were getting the non DNS SEC

560
00:26:29,230 --> 00:26:34,690
validated incorrect IMAP so they were

561
00:26:31,660 --> 00:26:40,440
connecting to the false site so these

562
00:26:34,690 --> 00:26:43,270
guys got the two employees passwords and

563
00:26:40,440 --> 00:26:45,580
once they had the passwords they already

564
00:26:43,270 --> 00:26:48,340
could get into the registries and make

565
00:26:45,580 --> 00:26:50,139
changes there which they were now they

566
00:26:48,340 --> 00:26:50,879
could get it two emails so they went

567
00:26:50,140 --> 00:26:53,620
into email

568
00:26:50,880 --> 00:26:56,590
they also started hopping around to see

569
00:26:53,620 --> 00:26:58,510
if they could SSH in finding what other

570
00:26:56,590 --> 00:27:01,059
machines these two employees had access

571
00:26:58,510 --> 00:27:03,429
to and then just copying every file they

572
00:27:01,059 --> 00:27:05,860
found and every password file they found

573
00:27:03,429 --> 00:27:08,470
and dumping them off for later use and

574
00:27:05,860 --> 00:27:11,559
so they just did this four times over a

575
00:27:08,470 --> 00:27:14,260
couple of weeks and among other things

576
00:27:11,559 --> 00:27:17,740
they managed to get passwords for

577
00:27:14,260 --> 00:27:22,090
customers of these registries which

578
00:27:17,740 --> 00:27:24,340
included the dot UAE or gov dot UAE and

579
00:27:22,090 --> 00:27:28,240
gov dot whatever Lebanon's two-letter

580
00:27:24,340 --> 00:27:30,939
country code is and once they had those

581
00:27:28,240 --> 00:27:33,820
they could make changes in the DNS zone

582
00:27:30,940 --> 00:27:35,740
files for those and they would flip

583
00:27:33,820 --> 00:27:37,510
those for an hour and they started

584
00:27:35,740 --> 00:27:40,390
getting government employee credentials

585
00:27:37,510 --> 00:27:42,429
and email and that was basically their

586
00:27:40,390 --> 00:27:45,160
entire goal they wanted to be able to

587
00:27:42,429 --> 00:27:48,670
walk around silently and unnoticed

588
00:27:45,160 --> 00:27:52,210
through their enemy country's government

589
00:27:48,670 --> 00:27:58,480
official sites email whatever to do

590
00:27:52,210 --> 00:28:00,910
espionage and if they hadn't had some of

591
00:27:58,480 --> 00:28:04,030
these things breaking because of DNS SEC

592
00:28:00,910 --> 00:28:05,620
popping in and out it probably would

593
00:28:04,030 --> 00:28:11,170
have gone a lot longer before it was

594
00:28:05,620 --> 00:28:14,620
noticed so basically at that point two

595
00:28:11,170 --> 00:28:17,470
sovereign nations were owned by one of

596
00:28:14,620 --> 00:28:20,169
their enemies who had access to all of

597
00:28:17,470 --> 00:28:22,390
their sensitive information now there's

598
00:28:20,170 --> 00:28:24,400
a lot of stuff that were learned and

599
00:28:22,390 --> 00:28:26,920
actually bill Woodcock did a

600
00:28:24,400 --> 00:28:28,270
presentation on this a few weeks ago of

601
00:28:26,920 --> 00:28:31,450
all the things that happen and all the

602
00:28:28,270 --> 00:28:33,190
things they learned it's the IKEA DNS

603
00:28:31,450 --> 00:28:35,350
symposium and I'm pretty sure there's a

604
00:28:33,190 --> 00:28:37,690
link in the further reading check it out

605
00:28:35,350 --> 00:28:40,659
because he did a very open and

606
00:28:37,690 --> 00:28:45,820
forthright breakdown of root causes and

607
00:28:40,660 --> 00:28:47,500
lessons learned one of them was part of

608
00:28:45,820 --> 00:28:49,510
the problem with doing things was they

609
00:28:47,500 --> 00:28:52,420
were checking NS records in the parent

610
00:28:49,510 --> 00:28:53,890
and D s records but because they had

611
00:28:52,420 --> 00:28:56,230
such long TTLs they were checking it

612
00:28:53,890 --> 00:28:57,670
every 24 hours and these guys were

613
00:28:56,230 --> 00:29:01,410
coming in for an hour at a time and

614
00:28:57,670 --> 00:29:04,419
going away so they didn't catch that

615
00:29:01,410 --> 00:29:08,109
they also realized that when they did

616
00:29:04,419 --> 00:29:11,139
did graph of all the links in the chain

617
00:29:08,109 --> 00:29:13,389
of all of the DNS delegations and who

618
00:29:11,139 --> 00:29:15,309
owned them and who could do password

619
00:29:13,389 --> 00:29:17,080
recoveries and get account for

620
00:29:15,309 --> 00:29:18,249
credentials or who could change them and

621
00:29:17,080 --> 00:29:20,139
how many people knew and all the rest of

622
00:29:18,249 --> 00:29:22,419
it and they did essentially a risk

623
00:29:20,139 --> 00:29:24,729
assessment they realized that they

624
00:29:22,419 --> 00:29:27,070
actually needed to check NS and d s for

625
00:29:24,730 --> 00:29:29,710
changes for everything from the route

626
00:29:27,070 --> 00:29:32,529
all the way down to exactly the labels

627
00:29:29,710 --> 00:29:33,820
that they cared about and on a much more

628
00:29:32,529 --> 00:29:35,440
aggressive basis so they are now doing

629
00:29:33,820 --> 00:29:37,509
that and they're walking the full tree

630
00:29:35,440 --> 00:29:39,429
validating the full tree and doing it on

631
00:29:37,509 --> 00:29:43,869
and I think eight I like a three or five

632
00:29:39,429 --> 00:29:45,609
minute interval there's also something

633
00:29:43,869 --> 00:29:47,649
that you could have in both the

634
00:29:45,609 --> 00:29:50,529
registrar account that you as a consumer

635
00:29:47,649 --> 00:29:53,768
have and that you can ask the registry

636
00:29:50,529 --> 00:29:55,330
to do blocking which is exactly like

637
00:29:53,769 --> 00:29:57,940
doing a credit lock on your credit cards

638
00:29:55,330 --> 00:29:59,769
where you lock it and you have to

639
00:29:57,940 --> 00:30:02,409
actually call somebody up and give some

640
00:29:59,769 --> 00:30:05,799
password or some much more extensive

641
00:30:02,409 --> 00:30:07,509
than you could log in to open it up so

642
00:30:05,799 --> 00:30:10,600
that you can make changes in or have

643
00:30:07,509 --> 00:30:11,769
access to your credit history and you

644
00:30:10,600 --> 00:30:14,498
can do the same thing with your

645
00:30:11,769 --> 00:30:16,629
registrar account and registry yes it

646
00:30:14,499 --> 00:30:18,009
means that you might you know have to

647
00:30:16,629 --> 00:30:20,379
have somebody woken up and get get out

648
00:30:18,009 --> 00:30:22,299
of bed if there's some emergency and you

649
00:30:20,379 --> 00:30:23,769
need to change the NS records but the

650
00:30:22,299 --> 00:30:26,679
odds are pretty good that most of the

651
00:30:23,769 --> 00:30:27,940
time you're gonna be doing that and it's

652
00:30:26,679 --> 00:30:29,799
planned and you're gonna have a

653
00:30:27,940 --> 00:30:32,409
checklist and you're gonna be giving

654
00:30:29,799 --> 00:30:33,730
change management procedures out and

655
00:30:32,409 --> 00:30:35,739
you're gonna be notifying your customers

656
00:30:33,730 --> 00:30:38,320
and so it really shouldn't slow it down

657
00:30:35,739 --> 00:30:39,820
but it really puts a dead stop to do

658
00:30:38,320 --> 00:30:41,049
somebody malicious trying to do that

659
00:30:39,820 --> 00:30:44,799
particularly if they're trying to pop it

660
00:30:41,049 --> 00:30:46,418
every hour so that was there at the time

661
00:30:44,799 --> 00:30:48,970
not everything they had had multi-factor

662
00:30:46,419 --> 00:30:51,779
authentication enabled it was available

663
00:30:48,970 --> 00:30:56,139
but it was not on everything they had

664
00:30:51,779 --> 00:30:58,539
they also it hadn't really occurred to

665
00:30:56,139 --> 00:31:01,119
them having their IMAP server something

666
00:30:58,539 --> 00:31:03,190
that you could I map into directly from

667
00:31:01,119 --> 00:31:08,259
the internet from the open not over a

668
00:31:03,190 --> 00:31:10,419
VPN or an SSL tunnel was one of the

669
00:31:08,259 --> 00:31:12,190
other reasons why it mattered that their

670
00:31:10,419 --> 00:31:13,809
two employees were there because if they

671
00:31:12,190 --> 00:31:16,239
had been over and encrypted tunnel even

672
00:31:13,809 --> 00:31:18,990
going through a hostile network that

673
00:31:16,239 --> 00:31:21,630
wouldn't have leaked their credential

674
00:31:18,990 --> 00:31:23,250
and so they actually re architected all

675
00:31:21,630 --> 00:31:25,580
of their service machines so that

676
00:31:23,250 --> 00:31:28,110
nothing did anything more than one thing

677
00:31:25,580 --> 00:31:30,330
it was all behind firewalls you had to

678
00:31:28,110 --> 00:31:33,000
use VPN access you had to use VPN access

679
00:31:30,330 --> 00:31:35,760
that had to factor all of those were

680
00:31:33,000 --> 00:31:38,160
things they learned they also discovered

681
00:31:35,760 --> 00:31:39,540
that it was very easy to change the

682
00:31:38,160 --> 00:31:43,710
resolvers on the phone the stub resolver

683
00:31:39,540 --> 00:31:45,480
z' and they turned on the MDM stuff

684
00:31:43,710 --> 00:31:48,120
where you know basically your IT

685
00:31:45,480 --> 00:31:49,830
department owns your phone I both hate

686
00:31:48,120 --> 00:31:54,110
and love this it's very secure and it's

687
00:31:49,830 --> 00:31:58,260
annoying beyond words because IT staff

688
00:31:54,110 --> 00:31:59,909
but in this case that was another they

689
00:31:58,260 --> 00:32:02,550
said they have too many people who are

690
00:31:59,910 --> 00:32:04,980
in hotels all over the world because you

691
00:32:02,550 --> 00:32:07,409
know they are global and they are going

692
00:32:04,980 --> 00:32:10,080
into places like China and other places

693
00:32:07,410 --> 00:32:12,330
where you know that the government is is

694
00:32:10,080 --> 00:32:16,050
one of the actors that is trying to get

695
00:32:12,330 --> 00:32:20,399
into your data dns sack would have

696
00:32:16,050 --> 00:32:22,200
helped and it did except for the fact

697
00:32:20,400 --> 00:32:24,120
that they were forced to use a resolver

698
00:32:22,200 --> 00:32:26,640
they didn't work one of the things that

699
00:32:24,120 --> 00:32:28,469
that Woody and I both think there should

700
00:32:26,640 --> 00:32:32,600
be more of I've said multiple times now

701
00:32:28,470 --> 00:32:34,560
the CA insert stuff sucks it's horrible

702
00:32:32,600 --> 00:32:36,870
everyone should be telling every browser

703
00:32:34,560 --> 00:32:38,460
vendor every time you talk to them Dane

704
00:32:36,870 --> 00:32:42,389
isn't enough slower that you shouldn't

705
00:32:38,460 --> 00:32:44,910
do it Dane is a much better cleaner and

706
00:32:42,390 --> 00:32:51,470
more logical leap of trust for doing

707
00:32:44,910 --> 00:32:53,070
certificates for web so what can you do

708
00:32:51,470 --> 00:32:54,810
everything you should be doing

709
00:32:53,070 --> 00:33:01,220
everywhere else every time the the term

710
00:32:54,810 --> 00:33:04,980
InfoSec pops up so decent passwords

711
00:33:01,220 --> 00:33:07,610
don't reuse passwords preferably use a

712
00:33:04,980 --> 00:33:11,460
password manager you can even have group

713
00:33:07,610 --> 00:33:13,229
vaults that you can give and revoke

714
00:33:11,460 --> 00:33:17,340
access to employees as they come in and

715
00:33:13,230 --> 00:33:20,280
out use multi-factor almost everything

716
00:33:17,340 --> 00:33:22,110
these days supports it phishing training

717
00:33:20,280 --> 00:33:24,120
if some of their staff had noticed

718
00:33:22,110 --> 00:33:25,590
earlier that email was doing wonky

719
00:33:24,120 --> 00:33:27,479
things that might have been another

720
00:33:25,590 --> 00:33:29,340
chance for them to catch it during one

721
00:33:27,480 --> 00:33:31,560
of the first couple of attempts as

722
00:33:29,340 --> 00:33:33,330
opposed to after attempt number four

723
00:33:31,560 --> 00:33:36,780
actually not attempt after success

724
00:33:33,330 --> 00:33:37,770
number four other things that you start

725
00:33:36,780 --> 00:33:41,639
looking at when you start getting

726
00:33:37,770 --> 00:33:44,340
paranoid that Registrar account that you

727
00:33:41,640 --> 00:33:45,750
have or the registry account in many

728
00:33:44,340 --> 00:33:47,730
cases somebody registers to a domain

729
00:33:45,750 --> 00:33:50,400
name and they're your web designer

730
00:33:47,730 --> 00:33:53,040
because it's for a campaign and they use

731
00:33:50,400 --> 00:33:55,500
their own email as the contact for it

732
00:33:53,040 --> 00:33:58,200
and that becomes your password recovery

733
00:33:55,500 --> 00:33:59,460
account and it might not be someone at

734
00:33:58,200 --> 00:34:03,300
your company or it might be somebody who

735
00:33:59,460 --> 00:34:06,000
left so make sure that every domain you

736
00:34:03,300 --> 00:34:08,550
care about that the contact emails are

737
00:34:06,000 --> 00:34:11,460
either role or a current company

738
00:34:08,550 --> 00:34:12,720
employee so that nobody else can change

739
00:34:11,460 --> 00:34:15,659
your password to get into your account

740
00:34:12,719 --> 00:34:17,939
and go through all of that regularly go

741
00:34:15,659 --> 00:34:19,859
through that directed graph of where all

742
00:34:17,940 --> 00:34:21,810
my dependencies where all the places

743
00:34:19,860 --> 00:34:24,419
they could change permissions or steal

744
00:34:21,810 --> 00:34:28,469
credentials and come at me from behind

745
00:34:24,418 --> 00:34:30,239
or the side monitor your your DNS and

746
00:34:28,469 --> 00:34:33,178
not just yours the whole chain the

747
00:34:30,239 --> 00:34:35,909
parent all of it and do it on a very

748
00:34:33,179 --> 00:34:37,860
regular basis you know five minutes at a

749
00:34:35,909 --> 00:34:39,989
time ten minutes at a time do it from

750
00:34:37,860 --> 00:34:41,940
multiple different places you know use

751
00:34:39,989 --> 00:34:44,879
one of the ripe Atlas thousand is

752
00:34:41,940 --> 00:34:48,270
something that is across lots and lots

753
00:34:44,880 --> 00:34:50,040
of a s's so you getting an idea of what

754
00:34:48,270 --> 00:34:51,600
it looks like everywhere on the internet

755
00:34:50,040 --> 00:34:55,469
not just from the path from your data

756
00:34:51,600 --> 00:34:57,650
center and anything you care about you

757
00:34:55,469 --> 00:35:00,660
should be monitoring those records and

758
00:34:57,650 --> 00:35:03,450
in all cases monitoring is useful is if

759
00:35:00,660 --> 00:35:05,370
you don't page somebody so actual have

760
00:35:03,450 --> 00:35:10,680
alerts for things that you care about or

761
00:35:05,370 --> 00:35:15,330
that are unexpected SSL certs and and

762
00:35:10,680 --> 00:35:18,029
certificate transparencies at least

763
00:35:15,330 --> 00:35:19,640
attempt it and there are you know there

764
00:35:18,030 --> 00:35:21,690
debates about whether the more extensive

765
00:35:19,640 --> 00:35:25,080
certs are actually worth the money that

766
00:35:21,690 --> 00:35:27,180
they charge for them but you know if

767
00:35:25,080 --> 00:35:28,950
it's millions of dollars of income to

768
00:35:27,180 --> 00:35:31,529
you that might go away if your website

769
00:35:28,950 --> 00:35:33,089
is out you know it's worth getting a

770
00:35:31,530 --> 00:35:39,450
better than the credit card cleared

771
00:35:33,090 --> 00:35:42,330
version of the cert and Dane and ackles

772
00:35:39,450 --> 00:35:43,759
VPNs tunnels you know again it's all

773
00:35:42,330 --> 00:35:45,360
just the standard stuff and then

774
00:35:43,760 --> 00:35:47,340
validate on your

775
00:35:45,360 --> 00:35:49,410
if you're gonna sign things you should

776
00:35:47,340 --> 00:35:52,620
be validating so that you know the DNS

777
00:35:49,410 --> 00:35:54,870
SEC is broken and sign everything and

778
00:35:52,620 --> 00:35:57,810
registry lock everything and registrar

779
00:35:54,870 --> 00:36:01,230
lock everything all right so I've left

780
00:35:57,810 --> 00:36:05,220
we've got a little how much fun about 15

781
00:36:01,230 --> 00:36:08,880
20 minutes so I sort of blew through

782
00:36:05,220 --> 00:36:11,040
this but I'd love to have questions on

783
00:36:08,880 --> 00:36:21,390
either other incidents or more details

784
00:36:11,040 --> 00:36:23,550
on these look I'm sorry just a small

785
00:36:21,390 --> 00:36:29,040
addition to a previous slide ok you know

786
00:36:23,550 --> 00:36:33,360
it's like but maybe one more yeah talk

787
00:36:29,040 --> 00:36:35,580
to you insurance company they these guys

788
00:36:33,360 --> 00:36:37,440
know risk versus money better than

789
00:36:35,580 --> 00:36:40,730
anybody that's their whole business yeah

790
00:36:37,440 --> 00:36:40,730
it's a good suggestion thank you

791
00:36:51,519 --> 00:36:57,848
Dameon mentor from Google one thing I

792
00:36:54,609 --> 00:37:00,640
didn't hear you mention is HSTs headers

793
00:36:57,849 --> 00:37:02,559
so just a quick comment or do you want

794
00:37:00,640 --> 00:37:05,440
to describe you'll do better than I will

795
00:37:02,559 --> 00:37:07,509
with that I sort of know but yeah so web

796
00:37:05,440 --> 00:37:10,269
browsers have this option for hosts

797
00:37:07,509 --> 00:37:12,579
strict Transport Security so basically a

798
00:37:10,269 --> 00:37:15,578
website can respond to its customer

799
00:37:12,579 --> 00:37:17,680
saying in all future transactions you

800
00:37:15,579 --> 00:37:19,749
must use SSL and the certificate must

801
00:37:17,680 --> 00:37:22,089
match you the user isn't allowed to

802
00:37:19,749 --> 00:37:24,308
click through that so as an example if

803
00:37:22,089 --> 00:37:25,930
like my ether wallet had done this their

804
00:37:24,309 --> 00:37:26,950
users would not have been able to click

805
00:37:25,930 --> 00:37:28,868
through these warnings and they would

806
00:37:26,950 --> 00:37:30,189
have been better protected yeah and my

807
00:37:28,869 --> 00:37:32,680
understand is it's basically much like

808
00:37:30,190 --> 00:37:35,890
the SSH fingerprint the first time you

809
00:37:32,680 --> 00:37:37,808
go in and then after that if you don't

810
00:37:35,890 --> 00:37:38,980
present one of the acceptable ones you

811
00:37:37,809 --> 00:37:40,509
actually get in here or you know I don't

812
00:37:38,980 --> 00:37:42,069
think there's even I don't think there's

813
00:37:40,509 --> 00:37:44,289
actually a certificate so when you buy a

814
00:37:42,069 --> 00:37:46,150
fraudulent certificate from comodo you

815
00:37:44,289 --> 00:37:47,619
do bypass this it's not it's not

816
00:37:46,150 --> 00:37:48,999
certificate pinning it's just it

817
00:37:47,619 --> 00:37:52,059
requires a valid cert so it's not

818
00:37:48,999 --> 00:37:54,459
bulletproof yeah the whole search system

819
00:37:52,059 --> 00:37:57,759
in general is fraught with peril but yes

820
00:37:54,460 --> 00:38:00,579
I also had a question I vaguely recall

821
00:37:57,759 --> 00:38:02,680
hearing that the one of the things as

822
00:38:00,579 --> 00:38:04,900
you know I'm interested in DNS

823
00:38:02,680 --> 00:38:07,299
amplification attacks yes all of these

824
00:38:04,900 --> 00:38:09,460
attacks come from DNS X signed domains

825
00:38:07,299 --> 00:38:11,349
because they have very large any records

826
00:38:09,460 --> 00:38:12,789
right so this is why they're almost

827
00:38:11,349 --> 00:38:14,730
always government domains because the

828
00:38:12,789 --> 00:38:18,849
government is all happy about DNS SEC

829
00:38:14,730 --> 00:38:20,859
has their I vaguely recall hearing talk

830
00:38:18,849 --> 00:38:23,049
about trying to shrink these records so

831
00:38:20,859 --> 00:38:25,650
they aren't quite as large yes so there

832
00:38:23,049 --> 00:38:28,299
are a couple of attacks one of them is

833
00:38:25,650 --> 00:38:30,430
current best practices to not allow any

834
00:38:28,299 --> 00:38:32,680
war to rate limit it or to Akal it so

835
00:38:30,430 --> 00:38:35,348
that only your knock can ask for any so

836
00:38:32,680 --> 00:38:37,989
that's one of the pieces and there are

837
00:38:35,349 --> 00:38:40,900
also other things with rate limits so

838
00:38:37,989 --> 00:38:43,930
that you can't get quite as many the

839
00:38:40,900 --> 00:38:46,269
other probably big win is algorithm

840
00:38:43,930 --> 00:38:49,930
choice you see DSA has the same

841
00:38:46,269 --> 00:38:54,999
cryptographic strength as RSA sha-1 for

842
00:38:49,930 --> 00:38:56,769
a fraction of the size I will point out

843
00:38:54,999 --> 00:38:58,390
of course also that I have seen people

844
00:38:56,769 --> 00:38:59,979
doing spectacularly stupid things like

845
00:38:58,390 --> 00:39:01,720
putting Fortier records in and then

846
00:38:59,980 --> 00:39:03,770
having your app doing magic load

847
00:39:01,720 --> 00:39:06,140
balancing as instead of

848
00:39:03,770 --> 00:39:07,430
doing it in a more sane way and that's

849
00:39:06,140 --> 00:39:09,470
gonna be huge and people have tax

850
00:39:07,430 --> 00:39:11,720
records but yes anything you can do to

851
00:39:09,470 --> 00:39:13,970
deliberately keep your spawn sizes and

852
00:39:11,720 --> 00:39:17,000
also with v6 these days if you can keep

853
00:39:13,970 --> 00:39:19,060
it below 1280 life is much better packet

854
00:39:17,000 --> 00:39:30,200
fragmentation and dns are not friends

855
00:39:19,060 --> 00:39:35,810
thank you other questions okay so like I

856
00:39:30,200 --> 00:39:37,580
said um some were pulled down the slide

857
00:39:35,810 --> 00:39:42,250
deck I've got some stuff with more

858
00:39:37,580 --> 00:39:42,250
detail and definitely check those out Oh

859
00:39:43,570 --> 00:39:52,910
Oh No yeah so those are worth reading

860
00:39:50,560 --> 00:39:54,890
there couple of them like I can dock

861
00:39:52,910 --> 00:39:57,950
there also actually themselves refer to

862
00:39:54,890 --> 00:40:00,200
other things the government gave out

863
00:39:57,950 --> 00:40:01,750
recommendations for using DNS second

864
00:40:00,200 --> 00:40:04,129
doing other security stuff and doing

865
00:40:01,750 --> 00:40:07,100
two-factor so there's plenty of good

866
00:40:04,130 --> 00:40:11,420
advice out there but how long is BC p-38

867
00:40:07,100 --> 00:40:13,160
been out so yeah if you can turn this

868
00:40:11,420 --> 00:40:18,950
stuff on it where you are at least we're

869
00:40:13,160 --> 00:40:20,480
getting ahead right if there are any

870
00:40:18,950 --> 00:40:22,720
other questions thank you very much for

871
00:40:20,480 --> 00:40:22,720
your time

872
00:40:26,220 --> 00:40:28,279
you

873
00:40:35,970 --> 00:40:38,029
you

