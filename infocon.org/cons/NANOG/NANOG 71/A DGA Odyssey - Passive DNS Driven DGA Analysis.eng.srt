1
00:00:10,299 --> 00:00:18,289
hello everyone<font color="#E5E5E5"> I'm aiming and this is -</font>

2
00:00:14,299 --> 00:00:20,509
<font color="#E5E5E5">this is Qi Tian</font><font color="#CCCCCC"> we are from 360</font><font color="#E5E5E5"> network</font>

3
00:00:18,289 --> 00:00:22,849
security research lab and today<font color="#E5E5E5"> we are</font>

4
00:00:20,509 --> 00:00:27,460
going<font color="#E5E5E5"> to talk about how we use</font><font color="#CCCCCC"> our</font>

5
00:00:22,849 --> 00:00:33,680
massive<font color="#CCCCCC"> penis</font><font color="#E5E5E5"> data to do real-time</font><font color="#CCCCCC"> RDG</font>

6
00:00:27,460 --> 00:00:37,040
malicious domain traffic analysis<font color="#E5E5E5"> first</font>

7
00:00:33,680 --> 00:00:41,080
some quick facts<font color="#CCCCCC"> currently we provide</font>

8
00:00:37,040 --> 00:00:41,080
our<font color="#E5E5E5"> DG a data feed at this URL</font>

9
00:00:44,140 --> 00:00:50,090
<font color="#E5E5E5">that's the DJ feed updates already at</font>

10
00:00:47,149 --> 00:00:54,829
once<font color="#E5E5E5"> every day and that's</font><font color="#CCCCCC"> a txt file</font>

11
00:00:50,090 --> 00:00:56,000
actually<font color="#CCCCCC"> now</font><font color="#E5E5E5"> itself</font><font color="#CCCCCC"> about 70 mega big it</font>

12
00:00:54,829 --> 00:00:59,809
has<font color="#E5E5E5"> more than 1 million</font>

13
00:00:56,000 --> 00:01:03,230
<font color="#CCCCCC">Tina's country in that</font><font color="#E5E5E5"> foul so it's a</font>

14
00:00:59,809 --> 00:01:06,710
fairly<font color="#E5E5E5"> large dance blacklist actually</font>

15
00:01:03,230 --> 00:01:11,929
and in our field we<font color="#CCCCCC"> are tracking us</font>

16
00:01:06,710 --> 00:01:17,479
right now 38<font color="#E5E5E5"> DJ families who is 375 DJ</font>

17
00:01:11,929 --> 00:01:20,119
<font color="#E5E5E5">variants and our</font><font color="#CCCCCC"> DNS platform</font><font color="#E5E5E5"> on average</font>

18
00:01:17,479 --> 00:01:22,130
we see more<font color="#E5E5E5"> than 5 million DNS queries</font>

19
00:01:20,119 --> 00:01:25,520
looking up for those malicious DJ

20
00:01:22,130 --> 00:01:28,670
domains which means this<font color="#CCCCCC"> DG family are</font>

21
00:01:25,520 --> 00:01:32,320
still fairly active right<font color="#E5E5E5"> now we have</font>

22
00:01:28,670 --> 00:01:35,329
<font color="#E5E5E5">subscribers from more than 50 countries</font>

23
00:01:32,320 --> 00:01:38,029
<font color="#E5E5E5">pulling the data</font><font color="#CCCCCC"> the feeds</font><font color="#E5E5E5"> itself is</font>

24
00:01:35,329 --> 00:01:38,839
free you<font color="#CCCCCC"> are welcome to use it</font><font color="#E5E5E5"> however</font>

25
00:01:38,030 --> 00:01:41,329
you want

26
00:01:38,840 --> 00:01:44,030
there is no<font color="#E5E5E5"> charge for that and actually</font>

27
00:01:41,329 --> 00:01:46,220
if you<font color="#CCCCCC"> go to our website</font><font color="#E5E5E5"> we have more</font>

28
00:01:44,030 --> 00:01:50,420
free service<font color="#E5E5E5"> to the security</font><font color="#CCCCCC"> community</font>

29
00:01:46,220 --> 00:01:50,750
for example<font color="#CCCCCC"> we run Digium DDoS</font><font color="#E5E5E5"> mount did</font>

30
00:01:50,420 --> 00:01:55,490
him

31
00:01:50,750 --> 00:01:58,549
DDoS mom it's basically<font color="#E5E5E5"> DDoS monitoring</font>

32
00:01:55,490 --> 00:02:01,390
traffic<font color="#E5E5E5"> project it's also free</font><font color="#CCCCCC"> we just</font>

33
00:01:58,549 --> 00:02:02,600
we also have<font color="#E5E5E5"> scan</font><font color="#CCCCCC"> mom which checks</font>

34
00:02:01,390 --> 00:02:06,500
<font color="#CCCCCC">network-wide</font>

35
00:02:02,600 --> 00:02:09,019
back<font color="#CCCCCC"> Obama scan traffic</font><font color="#E5E5E5"> we also have</font>

36
00:02:06,500 --> 00:02:12,759
some<font color="#E5E5E5"> other open data so you guys are</font>

37
00:02:09,019 --> 00:02:12,759
welcome to<font color="#E5E5E5"> go there and take a look</font>

38
00:02:12,970 --> 00:02:17,449
<font color="#CCCCCC">today</font><font color="#E5E5E5"> I'm going to go through some</font>

39
00:02:14,989 --> 00:02:19,340
background<font color="#E5E5E5"> information first and psyphon</font>

40
00:02:17,449 --> 00:02:22,819
is going to take over<font color="#E5E5E5"> he will talk about</font>

41
00:02:19,340 --> 00:02:25,280
how<font color="#E5E5E5"> we start from the raw P DNS data</font>

42
00:02:22,819 --> 00:02:28,429
and from the data<font color="#E5E5E5"> to narrow down to a</font>

43
00:02:25,280 --> 00:02:31,159
<font color="#E5E5E5">highly suspicious DJ demand list then</font>

44
00:02:28,430 --> 00:02:34,700
<font color="#E5E5E5">cheater</font><font color="#CCCCCC"> we'll</font><font color="#E5E5E5"> talk about how we pair</font>

45
00:02:31,159 --> 00:02:38,629
those highly suspicious DJ domains<font color="#E5E5E5"> to</font>

46
00:02:34,700 --> 00:02:39,828
real<font color="#CCCCCC"> Mara</font><font color="#E5E5E5"> or sampling our sandbox we</font>

47
00:02:38,629 --> 00:02:41,480
probably don't<font color="#E5E5E5"> have enough time</font><font color="#CCCCCC"> to</font>

48
00:02:39,829 --> 00:02:47,659
talking<font color="#CCCCCC"> about block blocking experience</font>

49
00:02:41,480 --> 00:02:50,659
<font color="#E5E5E5">but we will see we all know most</font><font color="#CCCCCC"> malware</font>

50
00:02:47,659 --> 00:02:53,689
<font color="#E5E5E5">they have they</font><font color="#CCCCCC"> need to have some kind of</font>

51
00:02:50,659 --> 00:02:57,858
mechanism to<font color="#E5E5E5"> talked with</font><font color="#CCCCCC"> their RC twos</font>

52
00:02:53,689 --> 00:03:02,269
command controllers<font color="#E5E5E5"> most hours these</font>

53
00:02:57,859 --> 00:03:04,639
<font color="#CCCCCC">days they use hard</font><font color="#E5E5E5"> code in situ by</font>

54
00:03:02,269 --> 00:03:08,510
<font color="#CCCCCC">hard-coded</font><font color="#E5E5E5"> that we mean is either fixed</font>

55
00:03:04,639 --> 00:03:11,900
IP address or<font color="#E5E5E5"> DNS name here a very good</font>

56
00:03:08,510 --> 00:03:14,000
<font color="#CCCCCC">example</font><font color="#E5E5E5"> is a</font><font color="#CCCCCC"> runner cry we all know this</font>

57
00:03:11,900 --> 00:03:16,069
<font color="#E5E5E5">year in May this year</font>

58
00:03:14,000 --> 00:03:19,760
<font color="#E5E5E5">wanna try made some really serious</font>

59
00:03:16,069 --> 00:03:23,268
damage<font color="#CCCCCC"> I think in just in one day</font><font color="#E5E5E5"> that</font>

60
00:03:19,760 --> 00:03:27,500
<font color="#E5E5E5">ransomware</font><font color="#CCCCCC"> infected more</font><font color="#E5E5E5"> than 200,000</font>

61
00:03:23,269 --> 00:03:32,090
<font color="#E5E5E5">lab computers and more than 100</font>

62
00:03:27,500 --> 00:03:33,680
<font color="#E5E5E5">countries would have having infection</font><font color="#CCCCCC"> if</font>

63
00:03:32,090 --> 00:03:36,310
we take<font color="#E5E5E5"> a look at the source code of the</font>

64
00:03:33,680 --> 00:03:41,569
<font color="#CCCCCC">binary code of wanna try we can see that</font>

65
00:03:36,310 --> 00:03:45,220
<font color="#CCCCCC">cue switch domain</font><font color="#E5E5E5"> there it's clear tax</font>

66
00:03:41,569 --> 00:03:47,839
<font color="#E5E5E5">it's not</font><font color="#CCCCCC"> encrypted so everybody can see</font>

67
00:03:45,220 --> 00:03:49,939
right in a spot<font color="#CCCCCC"> that's there there's</font>

68
00:03:47,840 --> 00:03:52,489
<font color="#E5E5E5">something</font><font color="#CCCCCC"> going on as a</font><font color="#E5E5E5"> domain and I</font>

69
00:03:49,939 --> 00:03:54,948
guess that's why it only<font color="#CCCCCC"> takes few hours</font>

70
00:03:52,489 --> 00:03:57,229
after code got released for a security

71
00:03:54,949 --> 00:03:59,540
researcher<font color="#E5E5E5"> to figure out this</font><font color="#CCCCCC"> is a</font>

72
00:03:57,229 --> 00:04:02,629
q-switched domain<font color="#E5E5E5"> and registered it then</font>

73
00:03:59,540 --> 00:04:06,918
sing how it if one a try<font color="#CCCCCC"> author</font><font color="#E5E5E5"> didn't</font>

74
00:04:02,629 --> 00:04:09,888
use did use like a<font color="#E5E5E5"> DJ it might take</font>

75
00:04:06,919 --> 00:04:15,280
<font color="#E5E5E5">security researcher</font><font color="#CCCCCC"> maybe days to figure</font>

76
00:04:09,889 --> 00:04:17,870
<font color="#E5E5E5">out what's the real</font><font color="#CCCCCC"> c2 is gonna be so DJ</font>

77
00:04:15,280 --> 00:04:21,259
DJ stands<font color="#E5E5E5"> for domain generation</font>

78
00:04:17,870 --> 00:04:24,289
algorithm<font color="#E5E5E5"> so basically by using</font><font color="#CCCCCC"> DG a</font>

79
00:04:21,259 --> 00:04:28,639
that means the c2 is not hard-coded

80
00:04:24,289 --> 00:04:31,430
anymore and the c2 are generated by the

81
00:04:28,639 --> 00:04:33,349
<font color="#CCCCCC">malware's</font><font color="#E5E5E5"> own algorithm and normally</font>

82
00:04:31,430 --> 00:04:35,970
when we're talking about<font color="#E5E5E5"> c2 here we are</font>

83
00:04:33,349 --> 00:04:37,890
talking about<font color="#E5E5E5"> just not just one c2</font>

84
00:04:35,970 --> 00:04:40,530
malware can generate whole bunch of<font color="#CCCCCC"> SI</font>

85
00:04:37,890 --> 00:04:44,849
<font color="#CCCCCC">toos</font><font color="#E5E5E5"> and only pick</font><font color="#CCCCCC"> one to register it</font>

86
00:04:40,530 --> 00:04:46,890
and that malware<font color="#E5E5E5"> will work</font><font color="#CCCCCC"> good example</font>

87
00:04:44,850 --> 00:04:50,490
<font color="#CCCCCC">here</font><font color="#E5E5E5"> I'm not</font><font color="#CCCCCC"> sure if</font><font color="#E5E5E5"> that's clear</font><font color="#CCCCCC"> enough</font>

88
00:04:46,890 --> 00:04:54,770
for you<font color="#E5E5E5"> guys to take a look but this is</font>

89
00:04:50,490 --> 00:05:02,000
a DJ domain generated by<font color="#CCCCCC"> our caught</font>

90
00:04:54,770 --> 00:05:06,510
knock us on this DJ botnet will generate

91
00:05:02,000 --> 00:05:10,140
2004 and 48 domains<font color="#E5E5E5"> every three days</font>

92
00:05:06,510 --> 00:05:12,150
<font color="#CCCCCC">that's a long list</font><font color="#E5E5E5"> and on the left side</font>

93
00:05:10,140 --> 00:05:15,630
<font color="#CCCCCC">you can see</font><font color="#E5E5E5"> that's done with some</font><font color="#CCCCCC"> of the</font>

94
00:05:12,150 --> 00:05:18,060
domain<font color="#E5E5E5"> regenerating on November 21 on</font>

95
00:05:15,630 --> 00:05:21,870
the<font color="#E5E5E5"> right side some other domains it</font>

96
00:05:18,060 --> 00:05:23,780
generated on November 24 so if you take

97
00:05:21,870 --> 00:05:25,830
<font color="#E5E5E5">a close look you'll notice a few</font><font color="#CCCCCC"> things</font>

98
00:05:23,780 --> 00:05:28,950
<font color="#E5E5E5">first</font>

99
00:05:25,830 --> 00:05:32,729
most of the domains have<font color="#E5E5E5"> this return</font>

100
00:05:28,950 --> 00:05:35,010
code<font color="#CCCCCC"> error code</font><font color="#E5E5E5"> III in DNS that means</font><font color="#CCCCCC"> a</font>

101
00:05:32,730 --> 00:05:37,680
<font color="#CCCCCC">next domain domains now existed</font>

102
00:05:35,010 --> 00:05:42,780
<font color="#CCCCCC">basically the mower also didn't register</font>

103
00:05:37,680 --> 00:05:46,740
<font color="#CCCCCC">this domains but also see the red marked</font>

104
00:05:42,780 --> 00:05:48,179
1 on both diagram you can see<font color="#E5E5E5"> there's</font>

105
00:05:46,740 --> 00:05:51,780
one<font color="#E5E5E5"> life</font>

106
00:05:48,180 --> 00:05:55,800
<font color="#E5E5E5">DJ domain and cut registered and was a</font>

107
00:05:51,780 --> 00:05:59,460
<font color="#CCCCCC">son IP</font><font color="#E5E5E5"> there's also another</font><font color="#CCCCCC"> saying if</font>

108
00:05:55,800 --> 00:06:01,710
you<font color="#E5E5E5"> take a look at the TLP</font><font color="#CCCCCC"> a TLD you see</font>

109
00:05:59,460 --> 00:06:06,919
that the chayote is just all over<font color="#E5E5E5"> the</font>

110
00:06:01,710 --> 00:06:13,799
place<font color="#E5E5E5"> for example</font><font color="#CCCCCC"> we have</font><font color="#E5E5E5"> G a dot B's</font>

111
00:06:06,919 --> 00:06:15,659
<font color="#E5E5E5">Taiwan dot US Russia Japan so let's see</font>

112
00:06:13,800 --> 00:06:17,310
if you're secure researcher and you want

113
00:06:15,660 --> 00:06:19,320
to register<font color="#E5E5E5"> and</font><font color="#CCCCCC"> sinkhole all these</font>

114
00:06:17,310 --> 00:06:21,570
<font color="#E5E5E5">domains is going to be really difficult</font>

115
00:06:19,320 --> 00:06:24,270
because you have<font color="#CCCCCC"> to talk with DNS</font>

116
00:06:21,570 --> 00:06:26,070
register are all over the<font color="#E5E5E5"> world and also</font>

117
00:06:24,270 --> 00:06:31,289
<font color="#E5E5E5">pay a lot of money remember</font><font color="#CCCCCC"> we are</font>

118
00:06:26,070 --> 00:06:34,890
saying this botnet will generate 2048

119
00:06:31,290 --> 00:06:35,810
domains<font color="#E5E5E5"> every three days so that's about</font>

120
00:06:34,890 --> 00:06:39,120
the DGA

121
00:06:35,810 --> 00:06:42,060
another another piece of this is passive

122
00:06:39,120 --> 00:06:46,110
<font color="#CCCCCC">dns</font><font color="#E5E5E5"> for</font><font color="#CCCCCC"> those who are</font><font color="#E5E5E5"> not familiar with</font>

123
00:06:42,060 --> 00:06:48,420
passive dns<font color="#CCCCCC"> you can think it has kind of</font>

124
00:06:46,110 --> 00:06:52,490
T DNS<font color="#E5E5E5"> database with all</font>

125
00:06:48,420 --> 00:06:57,630
history record<font color="#E5E5E5"> here a good example here</font>

126
00:06:52,490 --> 00:06:59,910
nano RG<font color="#CCCCCC"> just from article you can see</font>

127
00:06:57,630 --> 00:07:02,460
some key<font color="#CCCCCC"> elements here for</font><font color="#E5E5E5"> example the</font>

128
00:06:59,910 --> 00:07:04,830
<font color="#E5E5E5">first column is a start</font><font color="#CCCCCC"> is a first thing</font>

129
00:07:02,460 --> 00:07:08,190
time<font color="#E5E5E5"> the second column is</font><font color="#CCCCCC"> the last thing</font>

130
00:07:04,830 --> 00:07:11,640
time<font color="#E5E5E5"> also</font><font color="#CCCCCC"> we have like hits number</font><font color="#E5E5E5"> the</font>

131
00:07:08,190 --> 00:07:13,710
domain was asking for<font color="#E5E5E5"> what type of DNS</font>

132
00:07:11,640 --> 00:07:16,229
<font color="#CCCCCC">director that is here is a record and</font>

133
00:07:13,710 --> 00:07:19,489
what's the<font color="#E5E5E5"> IP address was a son to the</font>

134
00:07:16,230 --> 00:07:24,330
<font color="#E5E5E5">DNS name for</font><font color="#CCCCCC"> example the first</font><font color="#E5E5E5"> line here</font>

135
00:07:19,490 --> 00:07:27,960
<font color="#E5E5E5">from late 2014 to earlier this year</font>

136
00:07:24,330 --> 00:07:30,810
<font color="#CCCCCC">nanog was pointed to this fifty dot</font><font color="#E5E5E5"> 31</font>

137
00:07:27,960 --> 00:07:33,299
IP address and see the second line from

138
00:07:30,810 --> 00:07:39,000
<font color="#E5E5E5">earlier this year to now</font><font color="#CCCCCC"> nanog is</font>

139
00:07:33,300 --> 00:07:42,270
pointing to this 104 IP address another

140
00:07:39,000 --> 00:07:46,020
example of<font color="#CCCCCC"> p dns see here</font><font color="#E5E5E5"> PL</font><font color="#CCCCCC"> a neat read</font>

141
00:07:42,270 --> 00:07:48,710
<font color="#E5E5E5">calm again</font><font color="#CCCCCC"> this is</font><font color="#E5E5E5"> only part of the</font>

142
00:07:46,020 --> 00:07:51,990
<font color="#E5E5E5">whole screenshot but you can tell that</font>

143
00:07:48,710 --> 00:07:54,690
<font color="#E5E5E5">basically these domains changing IP all</font>

144
00:07:51,990 --> 00:07:57,570
the time this<font color="#CCCCCC"> is a</font><font color="#E5E5E5"> very typical fast</font>

145
00:07:54,690 --> 00:07:58,380
<font color="#CCCCCC">flex domain normally this type of to me</font>

146
00:07:57,570 --> 00:08:00,930
is up to no good

147
00:07:58,380 --> 00:08:05,880
it's really<font color="#E5E5E5"> safe</font><font color="#CCCCCC"> it's safe to just kill</font>

148
00:08:00,930 --> 00:08:07,920
the domain so passive<font color="#CCCCCC"> dns has a very</font>

149
00:08:05,880 --> 00:08:09,600
great potential in security community

150
00:08:07,920 --> 00:08:12,060
and more<font color="#E5E5E5"> and more</font><font color="#CCCCCC"> companies</font><font color="#E5E5E5"> using a</font>

151
00:08:09,600 --> 00:08:14,640
starting to using it and that's<font color="#E5E5E5"> why we</font>

152
00:08:12,060 --> 00:08:17,730
run our own passive DNS system<font color="#CCCCCC"> as a</font>

153
00:08:14,640 --> 00:08:19,770
passive<font color="#CCCCCC"> dns tisane and also if you're a</font>

154
00:08:17,730 --> 00:08:23,340
<font color="#E5E5E5">security researcher</font><font color="#CCCCCC"> you can go there and</font>

155
00:08:19,770 --> 00:08:25,260
<font color="#CCCCCC">apply account is free</font><font color="#E5E5E5"> the platform</font>

156
00:08:23,340 --> 00:08:28,440
currently covered more than<font color="#CCCCCC"> 10% of all</font>

157
00:08:25,260 --> 00:08:30,840
all chinese dns traffic<font color="#E5E5E5"> and now average</font>

158
00:08:28,440 --> 00:08:32,789
we see every single<font color="#E5E5E5"> second we see more</font>

159
00:08:30,840 --> 00:08:37,319
<font color="#E5E5E5">than 1 million DNS queries per second</font>

160
00:08:32,789 --> 00:08:41,010
and also<font color="#CCCCCC"> altogether we</font><font color="#E5E5E5"> have 15 billion</font>

161
00:08:37,320 --> 00:08:44,310
plus our sets and with that<font color="#CCCCCC"> i'm going to</font>

162
00:08:41,010 --> 00:08:47,520
give the mic to<font color="#E5E5E5"> siphon his can you talk</font>

163
00:08:44,310 --> 00:08:49,709
about how he starts<font color="#E5E5E5"> from the raw DNS a</font>

164
00:08:47,520 --> 00:08:54,000
parts of<font color="#E5E5E5"> DNS data and then to narrow</font>

165
00:08:49,710 --> 00:08:56,820
down to<font color="#CCCCCC"> a high potential</font><font color="#E5E5E5"> DJ candidate</font>

166
00:08:54,000 --> 00:09:00,180
list<font color="#E5E5E5"> there was one thing</font><font color="#CCCCCC"> i have to</font><font color="#E5E5E5"> say</font>

167
00:08:56,820 --> 00:09:01,390
<font color="#E5E5E5">that probably is pretty</font><font color="#CCCCCC"> obvious you guys</font>

168
00:09:00,180 --> 00:09:05,020
can tell that we

169
00:09:01,390 --> 00:09:07,420
from<font color="#CCCCCC"> 19 country and I believe actually</font>

170
00:09:05,020 --> 00:09:11,319
for<font color="#CCCCCC"> cheaters</font><font color="#E5E5E5"> this is first time our</font>

171
00:09:07,420 --> 00:09:13,390
doing English talk ever since his<font color="#CCCCCC"> chorus</font>

172
00:09:11,320 --> 00:09:18,010
<font color="#E5E5E5">college town that's what like 20 years</font>

173
00:09:13,390 --> 00:09:19,720
ago<font color="#E5E5E5"> so we thought</font><font color="#CCCCCC"> about</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> so we think</font>

174
00:09:18,010 --> 00:09:23,860
<font color="#E5E5E5">maybe it's better this can read from the</font>

175
00:09:19,720 --> 00:09:25,720
cell phone<font color="#CCCCCC"> no cell phone note I'll make</font>

176
00:09:23,860 --> 00:09:30,030
<font color="#E5E5E5">sure they can run a reader slow so</font>

177
00:09:25,720 --> 00:09:30,030
should<font color="#E5E5E5"> be easy</font><font color="#CCCCCC"> to understand yeah thanks</font>

178
00:09:30,930 --> 00:09:38,260
<font color="#CCCCCC">how to fund</font><font color="#E5E5E5"> the hi sis</font>

179
00:09:34,800 --> 00:09:42,430
<font color="#E5E5E5">okay how to fund</font><font color="#CCCCCC"> hi suspicious</font>

180
00:09:38,260 --> 00:09:47,800
<font color="#CCCCCC">TJ domains</font><font color="#E5E5E5"> from pursue TS first we need</font>

181
00:09:42,430 --> 00:09:52,770
to get all the<font color="#CCCCCC"> new domains basically we</font>

182
00:09:47,800 --> 00:09:56,579
are<font color="#E5E5E5"> only going to focus on new domains</font>

183
00:09:52,770 --> 00:10:01,210
that showed up<font color="#E5E5E5"> in last seven days and</font>

184
00:09:56,580 --> 00:10:03,420
domain<font color="#CCCCCC"> SLT on the elects</font><font color="#E5E5E5"> top 10 stones</font>

185
00:10:01,210 --> 00:10:07,360
<font color="#E5E5E5">list will</font><font color="#CCCCCC"> be dropped</font>

186
00:10:03,420 --> 00:10:13,030
we also<font color="#E5E5E5"> use some other quick filters</font>

187
00:10:07,360 --> 00:10:16,560
such as<font color="#CCCCCC"> a</font><font color="#E5E5E5"> future filter</font><font color="#CCCCCC"> out loud were</font>

188
00:10:13,030 --> 00:10:20,650
shocked<font color="#E5E5E5"> filter out the work hard domains</font>

189
00:10:16,560 --> 00:10:24,089
as as a<font color="#E5E5E5"> result instead of instead</font><font color="#CCCCCC"> of</font>

190
00:10:20,650 --> 00:10:28,420
during<font color="#E5E5E5"> the dealing with all the raw data</font>

191
00:10:24,090 --> 00:10:37,350
<font color="#E5E5E5">we only need to work on million and a</font>

192
00:10:28,420 --> 00:10:43,180
<font color="#E5E5E5">stat point the result of the above step</font>

193
00:10:37,350 --> 00:10:46,890
<font color="#E5E5E5">will have some noise for example here mm</font>

194
00:10:43,180 --> 00:10:51,969
big CDN providers such as<font color="#E5E5E5"> Akamai and</font>

195
00:10:46,890 --> 00:10:54,640
<font color="#E5E5E5">CloudFlare</font><font color="#CCCCCC"> and all</font><font color="#E5E5E5"> of the all kinds</font><font color="#CCCCCC"> of</font>

196
00:10:51,970 --> 00:11:02,200
<font color="#E5E5E5">audience black</font><font color="#CCCCCC"> lists such as warehouse</font>

197
00:10:54,640 --> 00:11:04,990
and as you are<font color="#CCCCCC"> BL ok</font>

198
00:11:02,200 --> 00:11:08,320
some other common cases<font color="#E5E5E5"> look at the top</font>

199
00:11:04,990 --> 00:11:13,180
one it looks it's a it looks<font color="#E5E5E5"> really</font>

200
00:11:08,320 --> 00:11:15,130
strange<font color="#CCCCCC"> but it in</font><font color="#E5E5E5"> now DJ they are</font>

201
00:11:13,180 --> 00:11:26,890
disposable domains

202
00:11:15,130 --> 00:11:29,710
from the AP Nick Diaz<font color="#E5E5E5"> tests the</font><font color="#CCCCCC"> report</font>

203
00:11:26,890 --> 00:11:31,900
<font color="#CCCCCC">in two</font><font color="#E5E5E5"> kisses the</font><font color="#CCCCCC"> button took his</font>

204
00:11:29,710 --> 00:11:34,540
affront to<font color="#CCCCCC"> the despondent family the</font>

205
00:11:31,900 --> 00:11:36,959
left<font color="#E5E5E5"> is acknowledged and the right in</font>

206
00:11:34,540 --> 00:11:36,959
Mirai

207
00:11:36,990 --> 00:11:43,930
these<font color="#E5E5E5"> domains are used the</font><font color="#CCCCCC"> $40 attack</font>

208
00:11:39,820 --> 00:11:52,540
<font color="#E5E5E5">they really</font><font color="#CCCCCC"> look like TJ but actually</font>

209
00:11:43,930 --> 00:11:56,489
they<font color="#CCCCCC"> are not so we have get rid of the</font>

210
00:11:52,540 --> 00:12:01,750
obvious noise<font color="#E5E5E5"> and then we are going to</font>

211
00:11:56,490 --> 00:12:05,170
go into<font color="#CCCCCC"> the most important part here two</font>

212
00:12:01,750 --> 00:12:06,030
clusters<font color="#E5E5E5"> at Aegean domains the theory is</font>

213
00:12:05,170 --> 00:12:09,490
pretty simple

214
00:12:06,030 --> 00:12:13,650
<font color="#CCCCCC">TJ domains generated by same mobile</font>

215
00:12:09,490 --> 00:12:17,350
<font color="#E5E5E5">family should go together in same group</font>

216
00:12:13,650 --> 00:12:20,860
there are two<font color="#CCCCCC"> dimensions can be</font><font color="#E5E5E5"> used the</font>

217
00:12:17,350 --> 00:12:24,430
mission one time<font color="#E5E5E5"> one more one more well</font>

218
00:12:20,860 --> 00:12:26,830
runs<font color="#E5E5E5"> it's a it will it will keep who</font>

219
00:12:24,430 --> 00:12:30,819
asking DJ<font color="#CCCCCC"> Thomas on who</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> is find one</font>

220
00:12:26,830 --> 00:12:34,900
<font color="#E5E5E5">that is resolved</font><font color="#CCCCCC"> oh</font><font color="#E5E5E5"> the mission to</font>

221
00:12:30,820 --> 00:12:38,350
<font color="#CCCCCC">client clients infected with the same DJ</font>

222
00:12:34,900 --> 00:12:42,610
a family should ask for some some domain

223
00:12:38,350 --> 00:12:46,600
names<font color="#E5E5E5"> in same time window after</font><font color="#CCCCCC"> this</font>

224
00:12:42,610 --> 00:12:51,330
type the month of the month of data when

225
00:12:46,600 --> 00:12:51,330
<font color="#E5E5E5">need to focus on is greatly reduced</font>

226
00:12:53,940 --> 00:13:01,960
<font color="#CCCCCC">okay let's talk about more details we</font>

227
00:12:59,230 --> 00:13:04,780
<font color="#CCCCCC">will</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> a time-based</font>

228
00:13:01,960 --> 00:13:07,540
<font color="#E5E5E5">time based clustering and the client</font>

229
00:13:04,780 --> 00:13:11,829
based clustering for time based

230
00:13:07,540 --> 00:13:14,230
cluttering we use our<font color="#CCCCCC"> use one</font><font color="#E5E5E5"> hour time</font>

231
00:13:11,830 --> 00:13:19,780
intro to group together<font color="#E5E5E5"> automates</font>

232
00:13:14,230 --> 00:13:23,380
accessed by same client for client based

233
00:13:19,780 --> 00:13:28,150
cluttering<font color="#CCCCCC"> it require</font><font color="#E5E5E5"> four steps step</font>

234
00:13:23,380 --> 00:13:29,279
<font color="#CCCCCC">one generate domain name IP matrix name</font>

235
00:13:28,150 --> 00:13:34,119
the

236
00:13:29,279 --> 00:13:37,589
named a step to<font color="#CCCCCC"> calculate</font><font color="#E5E5E5"> the trend</font>

237
00:13:34,119 --> 00:13:42,160
transpose matrix of a named a transpose

238
00:13:37,589 --> 00:13:45,459
<font color="#E5E5E5">number three gets a domain similarity</font>

239
00:13:42,160 --> 00:13:52,629
matrix based on<font color="#E5E5E5"> client requests</font><font color="#CCCCCC"> P equals</font>

240
00:13:45,459 --> 00:13:58,959
a multiply a transpose<font color="#E5E5E5"> the greater the</font>

241
00:13:52,629 --> 00:14:01,860
value<font color="#E5E5E5"> of element of b.i.g the higher the</font>

242
00:13:58,959 --> 00:14:07,868
domain name<font color="#CCCCCC"> I and the domain name J</font>

243
00:14:01,860 --> 00:14:10,679
coincidence<font color="#CCCCCC"> last</font><font color="#E5E5E5"> I've used last type</font>

244
00:14:07,869 --> 00:14:14,290
using<font color="#E5E5E5"> the Lu an algorithm for clustering</font>

245
00:14:10,679 --> 00:14:17,860
we see always<font color="#E5E5E5"> recite</font><font color="#CCCCCC"> ostrich</font><font color="#E5E5E5"> threshold</font>

246
00:14:14,290 --> 00:14:22,230
and algorithm groups are high similarity

247
00:14:17,860 --> 00:14:25,569
domain names together<font color="#CCCCCC"> so every domain</font>

248
00:14:22,230 --> 00:14:30,240
gets sending<font color="#CCCCCC"> into a particular cluster</font>

249
00:14:25,569 --> 00:14:30,240
<font color="#CCCCCC">let's take all take a look at an example</font>

250
00:14:31,319 --> 00:14:36,670
<font color="#E5E5E5">okay this is the example this is a</font>

251
00:14:34,660 --> 00:14:41,920
diagram of<font color="#CCCCCC"> client-based</font>

252
00:14:36,670 --> 00:14:47,860
clustering in matrix a<font color="#E5E5E5"> t means domain</font>

253
00:14:41,920 --> 00:14:50,610
and<font color="#E5E5E5"> I and I</font><font color="#CCCCCC"> G means client IP value one</font>

254
00:14:47,860 --> 00:14:56,470
indicates that domain has a DNS query

255
00:14:50,610 --> 00:15:00,899
<font color="#E5E5E5">forensic corresponding IP 0 0 means no</font>

256
00:14:56,470 --> 00:15:06,120
query in<font color="#E5E5E5"> this example we can see</font><font color="#CCCCCC"> that</font>

257
00:15:00,899 --> 00:15:08,769
the element value of matrix<font color="#E5E5E5"> P is a</font>

258
00:15:06,120 --> 00:15:12,910
coincidence<font color="#E5E5E5"> number of clients</font><font color="#CCCCCC"> IPS</font>

259
00:15:08,769 --> 00:15:16,870
<font color="#E5E5E5">between two domains thus based on the</font>

260
00:15:12,910 --> 00:15:21,100
client<font color="#CCCCCC"> omission the similarity of</font><font color="#E5E5E5"> t1 and</font>

261
00:15:16,870 --> 00:15:23,740
<font color="#E5E5E5">t2</font><font color="#CCCCCC"> three threes</font><font color="#E5E5E5"> are in the gray box</font><font color="#CCCCCC"> okay</font>

262
00:15:21,100 --> 00:15:30,730
<font color="#CCCCCC">it's higher than</font><font color="#E5E5E5"> t1 and the t3</font>

263
00:15:23,740 --> 00:15:34,179
one in the yellow<font color="#E5E5E5"> box then we convert to</font>

264
00:15:30,730 --> 00:15:38,230
<font color="#E5E5E5">the matrix P into a graph</font><font color="#CCCCCC"> set a</font>

265
00:15:34,179 --> 00:15:40,870
threshold such as<font color="#CCCCCC"> 3 and only see with</font>

266
00:15:38,230 --> 00:15:42,790
<font color="#E5E5E5">the edges with the weight greater</font><font color="#CCCCCC"> than</font>

267
00:15:40,870 --> 00:15:49,180
or equal<font color="#E5E5E5"> to the sir</font>

268
00:15:42,790 --> 00:15:52,949
only so the four domains will eventually

269
00:15:49,180 --> 00:15:58,300
be grouped into three clusters t1 and t2

270
00:15:52,950 --> 00:16:02,650
p t1 and t2 in<font color="#E5E5E5"> one same</font><font color="#CCCCCC"> cluster</font>

271
00:15:58,300 --> 00:16:11,800
t3 and t4<font color="#E5E5E5"> are separate each in its only</font>

272
00:16:02,650 --> 00:16:13,930
<font color="#E5E5E5">cluster</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> here is what the result</font>

273
00:16:11,800 --> 00:16:18,400
looks<font color="#CCCCCC"> like</font><font color="#E5E5E5"> it is still a very long</font>

274
00:16:13,930 --> 00:16:23,199
candidate<font color="#CCCCCC"> lists for example this clutter</font>

275
00:16:18,400 --> 00:16:26,370
it's a<font color="#CCCCCC"> typical</font><font color="#E5E5E5"> DGI domain domain TJ TJ a</font>

276
00:16:23,200 --> 00:16:30,610
domain names<font color="#CCCCCC"> it's</font><font color="#E5E5E5"> a configure more well</font>

277
00:16:26,370 --> 00:16:32,500
the cool thing<font color="#CCCCCC"> here is that all the</font>

278
00:16:30,610 --> 00:16:36,940
<font color="#CCCCCC">configured domains</font><font color="#E5E5E5"> were successfully</font>

279
00:16:32,500 --> 00:16:39,880
grouped together without looking at the

280
00:16:36,940 --> 00:16:48,130
configure code we<font color="#E5E5E5"> don't we</font><font color="#CCCCCC"> don't reverse</font>

281
00:16:39,880 --> 00:16:51,820
engineering it<font color="#E5E5E5"> okay that that looks good</font>

282
00:16:48,130 --> 00:16:55,570
<font color="#CCCCCC">now but</font><font color="#E5E5E5"> again we</font><font color="#CCCCCC"> are going</font><font color="#E5E5E5"> to see noise</font>

283
00:16:51,820 --> 00:16:59,140
for example this<font color="#E5E5E5"> this clutter the early</font>

284
00:16:55,570 --> 00:17:03,700
<font color="#CCCCCC">looks like DJ</font><font color="#E5E5E5"> but all of them actually</font>

285
00:16:59,140 --> 00:17:06,190
<font color="#E5E5E5">had coded in this mobile so they are not</font>

286
00:17:03,700 --> 00:17:11,490
DJ<font color="#E5E5E5"> you can you can send them mobile</font>

287
00:17:06,190 --> 00:17:11,490
samples<font color="#E5E5E5"> through the words total</font><font color="#CCCCCC"> reading</font>

288
00:17:13,619 --> 00:17:19,719
so another example<font color="#CCCCCC"> this clutter these</font>

289
00:17:16,810 --> 00:17:25,089
<font color="#E5E5E5">domains are linked with each</font><font color="#CCCCCC"> other</font><font color="#E5E5E5"> we</font>

290
00:17:19,720 --> 00:17:27,310
call<font color="#E5E5E5"> it</font><font color="#CCCCCC"> link fam</font><font color="#E5E5E5"> you can you can see the</font>

291
00:17:25,089 --> 00:17:34,510
right picture<font color="#E5E5E5"> they link to each other</font>

292
00:17:27,310 --> 00:17:40,800
together<font color="#CCCCCC"> they are for black hat</font><font color="#E5E5E5"> SEO used</font>

293
00:17:34,510 --> 00:17:43,960
<font color="#CCCCCC">bump up</font><font color="#E5E5E5"> their search search ranking so</font>

294
00:17:40,800 --> 00:17:46,780
we are<font color="#CCCCCC"> going</font><font color="#E5E5E5"> to apply</font><font color="#CCCCCC"> another layer of</font>

295
00:17:43,960 --> 00:17:51,790
<font color="#E5E5E5">ruse we are only select</font><font color="#CCCCCC"> that domains</font>

296
00:17:46,780 --> 00:17:53,260
that<font color="#E5E5E5"> only consider second</font><font color="#CCCCCC"> as ID</font>

297
00:17:51,790 --> 00:17:54,430
second-level domain and the top-level

298
00:17:53,260 --> 00:17:56,440
domain

299
00:17:54,430 --> 00:17:59,350
under the length of a second-level

300
00:17:56,440 --> 00:18:03,340
domain needed<font color="#E5E5E5"> to be more than five</font>

301
00:17:59,350 --> 00:18:06,790
letters and every every domain<font color="#CCCCCC"> names</font><font color="#E5E5E5"> our</font>

302
00:18:03,340 --> 00:18:13,090
data has less than<font color="#CCCCCC"> five every</font><font color="#E5E5E5"> answer</font>

303
00:18:06,790 --> 00:18:16,480
records<font color="#E5E5E5"> also</font><font color="#CCCCCC"> for each cluster</font><font color="#E5E5E5"> the ratio</font>

304
00:18:13,090 --> 00:18:19,439
of the negative answers<font color="#CCCCCC"> a</font><font color="#E5E5E5"> negative</font>

305
00:18:16,480 --> 00:18:24,790
answer<font color="#E5E5E5"> such had no such domain should be</font>

306
00:18:19,440 --> 00:18:27,360
greater than<font color="#E5E5E5"> 20% and to</font><font color="#CCCCCC"> tune the</font><font color="#E5E5E5"> to</font>

307
00:18:24,790 --> 00:18:31,750
audience the domain for<font color="#E5E5E5"> each cluster is</font>

308
00:18:27,360 --> 00:18:33,909
greater than or equal<font color="#E5E5E5"> to</font><font color="#CCCCCC"> 4</font><font color="#E5E5E5"> after</font><font color="#CCCCCC"> this</font>

309
00:18:31,750 --> 00:18:39,880
operation<font color="#CCCCCC"> the data reduced to ten</font>

310
00:18:33,910 --> 00:18:42,480
thousands<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> this the result looks</font>

311
00:18:39,880 --> 00:18:42,480
much better now

312
00:18:42,660 --> 00:18:49,590
so we are we are<font color="#CCCCCC"> looking at the list</font>

313
00:18:47,380 --> 00:18:55,210
about<font color="#E5E5E5"> the</font><font color="#CCCCCC"> tense on the</font><font color="#E5E5E5"> high suspicious</font>

314
00:18:49,590 --> 00:18:58,179
<font color="#CCCCCC">DJ domain it is a relative safe to use</font>

315
00:18:55,210 --> 00:19:01,300
this list<font color="#E5E5E5"> as a potential blacklist but</font>

316
00:18:58,180 --> 00:19:06,400
we want to give<font color="#CCCCCC"> it even</font><font color="#E5E5E5"> for even further</font>

317
00:19:01,300 --> 00:19:09,909
we will want to pair<font color="#E5E5E5"> the DNS domain to</font>

318
00:19:06,400 --> 00:19:17,220
mobile samples so<font color="#E5E5E5"> we can</font><font color="#CCCCCC"> absolutely sure</font>

319
00:19:09,910 --> 00:19:17,220
and<font color="#CCCCCC"> the GTM you</font><font color="#E5E5E5"> talk</font><font color="#CCCCCC"> apologize thank you</font>

320
00:19:24,230 --> 00:19:34,850
thank you my job is to<font color="#CCCCCC"> paring the DNS</font>

321
00:19:29,330 --> 00:19:36,649
names to<font color="#CCCCCC"> M device</font><font color="#E5E5E5"> we run our own sandbox</font>

322
00:19:34,850 --> 00:19:40,279
<font color="#CCCCCC">every</font><font color="#E5E5E5"> day</font>

323
00:19:36,649 --> 00:19:44,570
we run more than<font color="#E5E5E5"> a hundred thousand</font>

324
00:19:40,279 --> 00:19:49,700
samples from<font color="#E5E5E5"> BT</font><font color="#CCCCCC"> and even more samples</font>

325
00:19:44,570 --> 00:19:54,620
from us<font color="#E5E5E5"> in our sandbox the result is</font>

326
00:19:49,700 --> 00:19:59,539
something<font color="#E5E5E5"> like this</font><font color="#CCCCCC"> you can</font><font color="#E5E5E5"> see on the</font>

327
00:19:54,620 --> 00:20:04,100
left<font color="#E5E5E5"> side is the amplifies and on the</font>

328
00:19:59,539 --> 00:20:11,720
right<font color="#CCCCCC"> side is the DNS names that</font>

329
00:20:04,100 --> 00:20:14,918
amplifiers are asking for<font color="#CCCCCC"> for every</font>

330
00:20:11,720 --> 00:20:20,840
suspicious demands<font color="#CCCCCC"> there are three</font>

331
00:20:14,919 --> 00:20:25,000
<font color="#E5E5E5">pairing possibilities first the man has</font>

332
00:20:20,840 --> 00:20:30,158
an<font color="#E5E5E5"> undefined match and it's already</font>

333
00:20:25,000 --> 00:20:34,370
marketed by someone's<font color="#E5E5E5"> as malicious</font>

334
00:20:30,159 --> 00:20:38,659
<font color="#E5E5E5">second the demand has amplified match</font>

335
00:20:34,370 --> 00:20:43,459
but nobody has market<font color="#E5E5E5"> in this case in</font>

336
00:20:38,659 --> 00:20:47,260
this<font color="#E5E5E5"> case we need to</font><font color="#CCCCCC"> revive</font><font color="#E5E5E5"> reverse</font>

337
00:20:43,460 --> 00:20:55,940
engineering<font color="#E5E5E5"> and this is very</font>

338
00:20:47,260 --> 00:21:00,740
<font color="#E5E5E5">labor-intensive</font><font color="#CCCCCC"> sir</font><font color="#E5E5E5"> the man has no</font><font color="#CCCCCC"> md5</font>

339
00:20:55,940 --> 00:21:08,809
match we can<font color="#E5E5E5"> do a few things</font><font color="#CCCCCC"> but there</font>

340
00:21:00,740 --> 00:21:14,539
is really<font color="#CCCCCC"> not much</font><font color="#E5E5E5"> we can do here in</font>

341
00:21:08,809 --> 00:21:20,139
general<font color="#E5E5E5"> TJ</font><font color="#CCCCCC"> PDA</font><font color="#E5E5E5"> can be divided into two</font>

342
00:21:14,539 --> 00:21:28,039
categories<font color="#CCCCCC"> one is</font><font color="#E5E5E5"> tid the other is TDD</font>

343
00:21:20,139 --> 00:21:33,019
<font color="#E5E5E5">we will talk PID first tid stands for</font>

344
00:21:28,039 --> 00:21:38,090
time independent<font color="#E5E5E5"> and deterministic that</font>

345
00:21:33,019 --> 00:21:42,820
means the<font color="#CCCCCC"> PID DJ will generate</font>

346
00:21:38,090 --> 00:21:45,639
<font color="#CCCCCC">send demands</font><font color="#E5E5E5"> all the time when it runs</font>

347
00:21:42,820 --> 00:21:51,610
<font color="#E5E5E5">here is an</font><font color="#CCCCCC"> example</font>

348
00:21:45,640 --> 00:21:59,390
<font color="#E5E5E5">ramit DJ generates exact same demands in</font>

349
00:21:51,610 --> 00:22:05,139
January January and in September time is

350
00:21:59,390 --> 00:22:05,140
different<font color="#CCCCCC"> but</font><font color="#E5E5E5"> the tool is exact the same</font>

351
00:22:07,660 --> 00:22:17,540
among the<font color="#E5E5E5"> 30</font><font color="#CCCCCC"> I did their families below</font>

352
00:22:12,130 --> 00:22:23,120
the TI d DJ accounts for nearly 30

353
00:22:17,540 --> 00:22:27,159
<font color="#E5E5E5">percent we will take</font><font color="#CCCCCC"> planet</font><font color="#E5E5E5"> DJ for</font>

354
00:22:23,120 --> 00:22:36,010
example to show<font color="#CCCCCC"> how we locate</font><font color="#E5E5E5"> our sample</font>

355
00:22:27,160 --> 00:22:44,030
in the TI d crisp let's look at<font color="#E5E5E5"> this</font>

356
00:22:36,010 --> 00:22:51,070
cluster know<font color="#E5E5E5"> as LD is away within a</font>

357
00:22:44,030 --> 00:22:58,220
length of<font color="#CCCCCC"> a to 19 and consists</font><font color="#E5E5E5"> of 8 y 0</font>

358
00:22:51,070 --> 00:23:03,939
is always<font color="#CCCCCC"> missing TLD is our way</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> come</font>

359
00:22:58,220 --> 00:23:07,760
and<font color="#E5E5E5"> with time goes on the infected</font>

360
00:23:03,940 --> 00:23:15,020
clients always query the same<font color="#E5E5E5"> of</font>

361
00:23:07,760 --> 00:23:23,750
<font color="#E5E5E5">Killians so it look like look like TI d</font>

362
00:23:15,020 --> 00:23:27,500
DJ searching the domains in our<font color="#E5E5E5"> dns and</font>

363
00:23:23,750 --> 00:23:31,630
<font color="#E5E5E5">different database and we called a bunch</font>

364
00:23:27,500 --> 00:23:31,630
of<font color="#E5E5E5"> em defi</font>

365
00:23:35,540 --> 00:23:43,879
through<font color="#CCCCCC"> wise total</font><font color="#E5E5E5"> we know that this</font>

366
00:23:39,720 --> 00:23:47,160
sample<font color="#E5E5E5"> was submitted and marketed as</font>

367
00:23:43,880 --> 00:23:51,090
<font color="#CCCCCC">granite along</font><font color="#E5E5E5"> did</font><font color="#CCCCCC"> their family</font>

368
00:23:47,160 --> 00:23:55,680
so this suspicious<font color="#E5E5E5"> DJ demands are</font>

369
00:23:51,090 --> 00:24:00,260
generated by a new warrant<font color="#CCCCCC"> of Lambeth DJ</font>

370
00:23:55,680 --> 00:24:08,970
we had known identified before<font color="#E5E5E5"> and now</font>

371
00:24:00,260 --> 00:24:12,900
we can<font color="#E5E5E5"> mark it successfully let's the</font>

372
00:24:08,970 --> 00:24:18,900
cap we start from the highly so

373
00:24:12,900 --> 00:24:21,930
specialty ID<font color="#E5E5E5"> DJ cluster you use DN as M</font>

374
00:24:18,900 --> 00:24:25,530
<font color="#CCCCCC">different paths to locate Meryl sample</font>

375
00:24:21,930 --> 00:24:31,320
and then the worst<font color="#E5E5E5"> engineering and</font>

376
00:24:25,530 --> 00:24:35,280
figure<font color="#CCCCCC"> out the algorithm when we can</font>

377
00:24:31,320 --> 00:24:47,450
confidently<font color="#E5E5E5"> generate amounts of this new</font>

378
00:24:35,280 --> 00:24:52,100
violent now let's take a look at TD d pj

379
00:24:47,450 --> 00:24:58,590
t DS stands for<font color="#E5E5E5"> time-dependent and</font>

380
00:24:52,100 --> 00:25:03,179
deterministic<font color="#CCCCCC"> that means basically TV</font><font color="#E5E5E5"> DJ</font>

381
00:24:58,590 --> 00:25:08,750
generates<font color="#E5E5E5"> different commands at</font>

382
00:25:03,180 --> 00:25:14,340
different time here running<font color="#E5E5E5"> at EDD DJ</font>

383
00:25:08,750 --> 00:25:16,980
samples in sandbox<font color="#E5E5E5"> in different time and</font>

384
00:25:14,340 --> 00:25:22,459
we can see<font color="#E5E5E5"> the domain list captured by</font>

385
00:25:16,980 --> 00:25:22,460
were shocked at is total different

386
00:25:26,850 --> 00:25:33,100
the good thing is although the domain

387
00:25:30,550 --> 00:25:36,300
names<font color="#CCCCCC"> change all</font><font color="#E5E5E5"> the time</font>

388
00:25:33,100 --> 00:25:41,879
the<font color="#CCCCCC"> domains generated by the same family</font>

389
00:25:36,300 --> 00:25:47,559
<font color="#CCCCCC">we share</font><font color="#E5E5E5"> some common pattern because the</font>

390
00:25:41,880 --> 00:25:51,910
algorithms<font color="#E5E5E5"> share the same logic so can</font>

391
00:25:47,559 --> 00:25:55,870
use fuzzy match<font color="#E5E5E5"> later on let's take</font><font color="#CCCCCC"> a</font>

392
00:25:51,910 --> 00:26:01,590
look at this look at this table<font color="#CCCCCC"> the</font>

393
00:25:55,870 --> 00:26:06,939
first life were<font color="#CCCCCC"> Ruth generate 10,000</font>

394
00:26:01,590 --> 00:26:12,730
demands per day Tod<font color="#E5E5E5"> is our way to</font><font color="#CCCCCC"> come</font>

395
00:26:06,940 --> 00:26:18,420
and as<font color="#CCCCCC"> Adi is fixed length of six</font>

396
00:26:12,730 --> 00:26:24,580
letters<font color="#E5E5E5"> away from A to Z the last one</font>

397
00:26:18,420 --> 00:26:29,380
say cleaner only<font color="#CCCCCC"> general</font><font color="#E5E5E5"> one domains per</font>

398
00:26:24,580 --> 00:26:34,419
month<font color="#E5E5E5"> Tod is our way to come and as a</font>

399
00:26:29,380 --> 00:26:38,740
deal and is within<font color="#CCCCCC"> eleven to</font><font color="#E5E5E5"> thirteen or</font>

400
00:26:34,420 --> 00:26:47,170
we used letter A to F and the number

401
00:26:38,740 --> 00:26:53,320
<font color="#E5E5E5">zero to nine amongst</font><font color="#CCCCCC"> 38th didier</font>

402
00:26:47,170 --> 00:26:58,330
families we know<font color="#CCCCCC"> TDD a family account</font>

403
00:26:53,320 --> 00:27:02,439
for nearly<font color="#E5E5E5"> 70 percent we will take</font><font color="#CCCCCC"> China</font>

404
00:26:58,330 --> 00:27:10,780
<font color="#E5E5E5">D as an example to show</font><font color="#CCCCCC"> how</font><font color="#E5E5E5"> we locate</font>

405
00:27:02,440 --> 00:27:16,620
<font color="#CCCCCC">Mara sample through a fuzzy match on all</font>

406
00:27:10,780 --> 00:27:21,309
<font color="#E5E5E5">the seven last</font><font color="#CCCCCC"> year</font><font color="#E5E5E5"> this class can</font><font color="#CCCCCC"> up</font>

407
00:27:16,620 --> 00:27:27,399
the<font color="#CCCCCC"> fqd ins in this cluster looked like</font>

408
00:27:21,309 --> 00:27:30,520
this in the following few days<font color="#E5E5E5"> we</font>

409
00:27:27,400 --> 00:27:34,750
<font color="#E5E5E5">noticed that the infected clients of</font>

410
00:27:30,520 --> 00:27:37,450
this class started<font color="#E5E5E5"> to query a whole</font>

411
00:27:34,750 --> 00:27:39,460
bunch of different<font color="#CCCCCC"> live demands</font><font color="#E5E5E5"> every</font>

412
00:27:37,450 --> 00:27:43,960
<font color="#E5E5E5">day</font><font color="#CCCCCC"> the</font>

413
00:27:39,460 --> 00:27:48,029
of demands are not<font color="#CCCCCC"> same each day but</font><font color="#E5E5E5"> the</font>

414
00:27:43,960 --> 00:27:59,559
<font color="#E5E5E5">demands they</font><font color="#CCCCCC"> ask</font><font color="#E5E5E5"> you for</font><font color="#CCCCCC"> shares similar</font>

415
00:27:48,029 --> 00:28:03,990
pattern so it may<font color="#E5E5E5"> be a</font><font color="#CCCCCC"> TDD DJ look at</font>

416
00:27:59,559 --> 00:28:08,830
the demands<font color="#CCCCCC"> in</font><font color="#E5E5E5"> this cluster we can exact</font>

417
00:28:03,990 --> 00:28:10,470
some features they<font color="#CCCCCC"> have seven</font><font color="#E5E5E5"> top-level</font>

418
00:28:08,830 --> 00:28:17,039
domain

419
00:28:10,470 --> 00:28:23,710
<font color="#E5E5E5">Hadji are you sayin net and so on and</font>

420
00:28:17,039 --> 00:28:28,539
the SLD is always<font color="#CCCCCC"> sixteen and as</font><font color="#E5E5E5"> a D</font>

421
00:28:23,710 --> 00:28:37,840
consists of the letter A to Z and the

422
00:28:28,539 --> 00:28:42,220
<font color="#CCCCCC">number</font><font color="#E5E5E5"> till tonight when based on these</font>

423
00:28:37,840 --> 00:28:46,809
<font color="#CCCCCC">features we search the sender boss</font><font color="#E5E5E5"> DNS</font>

424
00:28:42,220 --> 00:28:50,559
and divine<font color="#E5E5E5"> Paris database found that</font>

425
00:28:46,809 --> 00:28:54,908
some domains serve we serve very similar

426
00:28:50,559 --> 00:29:03,399
<font color="#E5E5E5">features and they are generated by a</font>

427
00:28:54,909 --> 00:29:06,880
<font color="#E5E5E5">single sample through Google search we</font>

428
00:29:03,399 --> 00:29:09,610
<font color="#E5E5E5">found an</font><font color="#CCCCCC"> malwarebytes blog they have a</font>

429
00:29:06,880 --> 00:29:13,750
<font color="#CCCCCC">knowledge base sample and named it</font>

430
00:29:09,610 --> 00:29:18,580
trendy but<font color="#E5E5E5"> the article did not mention</font>

431
00:29:13,750 --> 00:29:28,690
anything about a DJ so we create a new

432
00:29:18,580 --> 00:29:31,590
<font color="#E5E5E5">DJ family and named it</font><font color="#CCCCCC"> chandi recap we</font>

433
00:29:28,690 --> 00:29:34,870
start from the suspicious DJ cluster

434
00:29:31,590 --> 00:29:38,889
<font color="#E5E5E5">when figuring our naming pattern and</font>

435
00:29:34,870 --> 00:29:42,459
locate suspicious<font color="#E5E5E5"> and if I through what</font>

436
00:29:38,890 --> 00:29:47,529
we<font color="#CCCCCC"> match and then the worst engineering</font>

437
00:29:42,460 --> 00:29:51,070
and figure<font color="#CCCCCC"> out the algorithm when we can</font>

438
00:29:47,529 --> 00:29:51,940
confidently<font color="#E5E5E5"> generate amounts of this new</font>

439
00:29:51,070 --> 00:29:57,500
<font color="#E5E5E5">family</font>

440
00:29:51,940 --> 00:29:59,900
thank you<font color="#CCCCCC"> I think we're running</font><font color="#E5E5E5"> out of</font>

441
00:29:57,500 --> 00:30:01,640
<font color="#E5E5E5">time</font><font color="#CCCCCC"> for the last section but</font><font color="#E5E5E5"> good thing</font>

442
00:29:59,900 --> 00:30:03,830
is<font color="#E5E5E5"> last section is</font><font color="#CCCCCC"> pretty simple</font><font color="#E5E5E5"> and</font>

443
00:30:01,640 --> 00:30:05,300
easy to understand<font color="#CCCCCC"> you guys can</font><font color="#E5E5E5"> just</font>

444
00:30:03,830 --> 00:30:11,990
read<font color="#CCCCCC"> attack but I don't want to</font><font color="#E5E5E5"> see one</font>

445
00:30:05,300 --> 00:30:15,610
<font color="#CCCCCC">more thing oops right</font><font color="#E5E5E5"> now we have this</font>

446
00:30:11,990 --> 00:30:19,040
github repository<font color="#E5E5E5"> so on this reporter</font>

447
00:30:15,610 --> 00:30:23,149
repository we have suspicious<font color="#CCCCCC"> TJ domains</font>

448
00:30:19,040 --> 00:30:25,850
we thought<font color="#CCCCCC"> md5</font><font color="#E5E5E5"> we also have some empty</font>

449
00:30:23,150 --> 00:30:28,910
<font color="#E5E5E5">files we haven't figured out</font><font color="#CCCCCC"> the</font>

450
00:30:25,850 --> 00:30:31,669
algorithm yet and also<font color="#E5E5E5"> we keep a list of</font>

451
00:30:28,910 --> 00:30:33,560
<font color="#E5E5E5">bean on DJ applications which means the</font>

452
00:30:31,670 --> 00:30:37,490
<font color="#CCCCCC">application is not bad but they just</font>

453
00:30:33,560 --> 00:30:39,200
have this DJ active behavior so for

454
00:30:37,490 --> 00:30:41,570
security researchers<font color="#E5E5E5"> you're more than</font>

455
00:30:39,200 --> 00:30:42,740
welcome to<font color="#E5E5E5"> go take a look and if</font><font color="#CCCCCC"> you can</font>

456
00:30:41,570 --> 00:30:47,379
make contributions<font color="#CCCCCC"> that's going to be</font>

457
00:30:42,740 --> 00:30:47,380
<font color="#E5E5E5">great with</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> any questions</font>

458
00:30:51,370 --> 00:31:00,219
Kevin Bloomberg<font color="#CCCCCC"> a lot</font><font color="#E5E5E5"> of the work you've</font>

459
00:30:56,420 --> 00:31:04,670
done<font color="#CCCCCC"> points to an interesting way of</font>

460
00:31:00,220 --> 00:31:06,290
identifying that's<font color="#E5E5E5"> reprobates you time</font>

461
00:31:04,670 --> 00:31:09,470
to figure<font color="#E5E5E5"> out the</font><font color="#CCCCCC"> next</font><font color="#E5E5E5"> one but you're</font>

462
00:31:06,290 --> 00:31:11,620
you seem to be reproducing the the way

463
00:31:09,470 --> 00:31:14,660
they are generating that<font color="#CCCCCC"> the domains</font>

464
00:31:11,620 --> 00:31:17,590
consistently is this something that the

465
00:31:14,660 --> 00:31:20,360
registries and registrar's should be

466
00:31:17,590 --> 00:31:23,600
using in their algorithms for fraud and

467
00:31:20,360 --> 00:31:26,270
detection<font color="#CCCCCC"> and is</font><font color="#E5E5E5"> that something that</font>

468
00:31:23,600 --> 00:31:27,860
you're working<font color="#CCCCCC"> towards</font><font color="#E5E5E5"> or you're looking</font>

469
00:31:26,270 --> 00:31:29,330
<font color="#CCCCCC">at a higher level you just expect these</font>

470
00:31:27,860 --> 00:31:31,129
will be created and other people are

471
00:31:29,330 --> 00:31:33,590
then<font color="#E5E5E5"> going to use them should it be</font>

472
00:31:31,130 --> 00:31:36,370
stopped at the root<font color="#E5E5E5"> but I don't mean the</font>

473
00:31:33,590 --> 00:31:40,040
roots but at the<font color="#E5E5E5"> root cause rather than</font>

474
00:31:36,370 --> 00:31:42,169
after the fact<font color="#E5E5E5"> right as I mentioned</font>

475
00:31:40,040 --> 00:31:44,690
before<font color="#CCCCCC"> right now all focused mainly on</font>

476
00:31:42,170 --> 00:31:47,720
producing<font color="#E5E5E5"> the</font><font color="#CCCCCC"> data we have more than</font>

477
00:31:44,690 --> 00:31:51,080
like we have people from more<font color="#E5E5E5"> than 50</font>

478
00:31:47,720 --> 00:31:52,900
<font color="#CCCCCC">countries</font><font color="#E5E5E5"> upholding the data or we don't</font>

479
00:31:51,080 --> 00:31:55,669
right now<font color="#E5E5E5"> our focus is just</font><font color="#CCCCCC"> mainly</font>

480
00:31:52,900 --> 00:31:58,450
producing the<font color="#E5E5E5"> data but we</font><font color="#CCCCCC"> haven't worked</font>

481
00:31:55,670 --> 00:32:01,540
with<font color="#E5E5E5"> any registrar to do anything yet</font>

482
00:31:58,450 --> 00:32:01,540
<font color="#E5E5E5">thank you</font>

483
00:32:04,919 --> 00:32:13,030
any more questions<font color="#E5E5E5"> okay thank</font><font color="#CCCCCC"> you very</font>

484
00:32:11,740 --> 00:32:17,230
much

485
00:32:13,030 --> 00:32:17,230
[Applause]

