1
00:00:02,880 --> 00:00:12,599
hello my name is Mathias

2
00:00:07,150 --> 00:00:16,270
here's some data about me I lead a team

3
00:00:12,599 --> 00:00:21,420
anak sue on Twitter I go by the name

4
00:00:16,270 --> 00:00:24,269
I'll see on security and I coined the

5
00:00:21,420 --> 00:00:27,840
hashtag ditch fiber together with the

6
00:00:24,269 --> 00:00:33,960
Minea who is also a colleague of mine

7
00:00:27,840 --> 00:00:37,930
this talk was supposed to be about

8
00:00:33,960 --> 00:00:40,899
handling and a case of ransomware but

9
00:00:37,930 --> 00:00:43,329
since you're all developers here I

10
00:00:40,899 --> 00:00:47,800
thought it would be nice to give a

11
00:00:43,329 --> 00:00:49,210
different twist and look to the piece of

12
00:00:47,800 --> 00:00:56,379
ransomware from a customer perspective

13
00:00:49,210 --> 00:00:59,590
and see how the developers yeah how will

14
00:00:56,379 --> 00:01:01,449
they write the software so you're not

15
00:00:59,590 --> 00:01:05,050
going to talk about the instant response

16
00:01:01,449 --> 00:01:08,259
process we are not going to talk about

17
00:01:05,050 --> 00:01:13,720
the preparation so how do we prepare for

18
00:01:08,260 --> 00:01:16,799
ransomware no not going to do that no

19
00:01:13,720 --> 00:01:16,798
I'm sorry sorry

20
00:01:18,780 --> 00:01:25,180
yeah how do we identify ransomware

21
00:01:21,729 --> 00:01:28,720
usually that's a quite obvious used try

22
00:01:25,180 --> 00:01:31,180
to open your documents and they are

23
00:01:28,720 --> 00:01:32,619
encrypted and and it doesn't work

24
00:01:31,180 --> 00:01:35,770
anymore of the way you expect you

25
00:01:32,619 --> 00:01:43,200
expected we're not going to talk about

26
00:01:35,770 --> 00:01:48,100
that I'm talking to BA about no no

27
00:01:43,200 --> 00:01:52,390
skipping all this I'm talking about I'm

28
00:01:48,100 --> 00:01:54,789
going to talk about ransomware from the

29
00:01:52,390 --> 00:01:56,920
perspective of the consumer so we went

30
00:01:54,790 --> 00:02:01,689
somewhere yeah that's basically a piece

31
00:01:56,920 --> 00:02:04,299
of software you you purchased or well

32
00:02:01,689 --> 00:02:07,389
you actually found a freemium software

33
00:02:04,299 --> 00:02:09,910
so you get it for free you install it by

34
00:02:07,390 --> 00:02:13,860
clicking on the link probably shooting

35
00:02:09,910 --> 00:02:17,190
and it's a encryption stuff and yeah

36
00:02:13,860 --> 00:02:21,890
it's fine because

37
00:02:17,190 --> 00:02:25,620
you can travel to countries abroad and

38
00:02:21,890 --> 00:02:27,059
if you're if border control stops you

39
00:02:25,620 --> 00:02:28,590
and that's righti immature hard drive

40
00:02:27,060 --> 00:02:33,120
all your stuff is committed that's a

41
00:02:28,590 --> 00:02:35,400
good thing but when you want to retrieve

42
00:02:33,120 --> 00:02:39,080
these files yeah that's why you start

43
00:02:35,400 --> 00:02:42,750
paying so usually they have a nice

44
00:02:39,080 --> 00:02:46,100
helpdesk or we send an email you say hey

45
00:02:42,750 --> 00:02:48,480
one more files back and they ask you to

46
00:02:46,100 --> 00:02:50,850
pay some bitcoins or whatever

47
00:02:48,480 --> 00:02:57,230
cryptocurrency and you get your files

48
00:02:50,850 --> 00:03:01,109
back right maybe this is an example of

49
00:02:57,230 --> 00:03:07,769
ransomware for a corporate and finest

50
00:03:01,110 --> 00:03:10,830
it's also available well I'm telling you

51
00:03:07,770 --> 00:03:14,880
about my shitty experience actually so I

52
00:03:10,830 --> 00:03:19,370
try to to open a file now what happens

53
00:03:14,880 --> 00:03:23,430
it tries to open it as a DOS application

54
00:03:19,370 --> 00:03:31,049
or what happens here so apparently this

55
00:03:23,430 --> 00:03:34,799
this piece of ransomware appended some

56
00:03:31,049 --> 00:03:39,030
string ending in dot-com an email

57
00:03:34,799 --> 00:03:42,090
address there for those old enough to

58
00:03:39,030 --> 00:03:46,260
know a comb file is an executable file

59
00:03:42,090 --> 00:03:50,250
that dates back to the dosage okay well

60
00:03:46,260 --> 00:03:52,798
so I'd renamed my files and well it's

61
00:03:50,250 --> 00:03:56,880
obviously not executable so what the

62
00:03:52,799 --> 00:03:58,650
hell usually when yes some nice

63
00:03:56,880 --> 00:04:02,430
ransomware that drops you a ransom note

64
00:03:58,650 --> 00:04:03,140
in a nice graphical form but this one

65
00:04:02,430 --> 00:04:07,590
didn't

66
00:04:03,140 --> 00:04:12,540
so it actually I had a very bad UI

67
00:04:07,590 --> 00:04:17,280
experience here well as far as features

68
00:04:12,540 --> 00:04:20,760
go it seemed solid AAS 256 bit

69
00:04:17,279 --> 00:04:22,919
encryption sounds good

70
00:04:20,760 --> 00:04:25,979
so what do I need to do if about my

71
00:04:22,919 --> 00:04:29,889
files back ok and send an email and it

72
00:04:25,979 --> 00:04:34,560
says very important we recommend to ride

73
00:04:29,889 --> 00:04:34,560
email us with Gmail or Yahoo address

74
00:04:35,490 --> 00:04:40,930
otherwise your email may not reach us

75
00:04:38,069 --> 00:04:46,529
check the spam folder probably our

76
00:04:40,930 --> 00:04:46,529
response mail is in debt okay

77
00:04:47,069 --> 00:04:54,430
and another warning you do not try to

78
00:04:51,550 --> 00:04:58,120
decrypt files bastard or itd ciphers

79
00:04:54,430 --> 00:05:00,159
otherwise you will spoil files okay so I

80
00:04:58,120 --> 00:05:06,460
should use your Edition original product

81
00:05:00,159 --> 00:05:09,188
right so this what I did I emailed the

82
00:05:06,460 --> 00:05:11,080
guys apparently hi I had to take a look

83
00:05:09,189 --> 00:05:14,319
at the file because it does come

84
00:05:11,080 --> 00:05:17,279
obviously was an email address so I

85
00:05:14,319 --> 00:05:20,770
emailed them and what do you think

86
00:05:17,279 --> 00:05:25,029
message not delivered top I was here

87
00:05:20,770 --> 00:05:32,878
with these encrypted files pretty much

88
00:05:25,029 --> 00:05:35,949
disappointed it did a good job

89
00:05:32,879 --> 00:05:39,250
usually you expect your ransomware to

90
00:05:35,949 --> 00:05:44,139
enumerate your drives and your hardest

91
00:05:39,250 --> 00:05:49,719
encrypt your USB media etc but what if

92
00:05:44,139 --> 00:05:51,939
you have an network mapping oh that's

93
00:05:49,719 --> 00:05:59,039
where it started to encrypt the

94
00:05:51,939 --> 00:06:03,310
department file share as well ouch so

95
00:05:59,039 --> 00:06:10,479
without the ransomware support team yeah

96
00:06:03,310 --> 00:06:13,080
what do we do well this was a particular

97
00:06:10,479 --> 00:06:16,810
piece of ransomware where no public

98
00:06:13,080 --> 00:06:18,878
descriptors are available and besides

99
00:06:16,810 --> 00:06:24,099
they do not want you to use it because

100
00:06:18,879 --> 00:06:28,659
you might spoil your files so okay buddy

101
00:06:24,099 --> 00:06:31,779
would you restore it to the backup so

102
00:06:28,659 --> 00:06:33,530
first try to find out what files are

103
00:06:31,779 --> 00:06:37,370
encrypted

104
00:06:33,530 --> 00:06:39,619
so it should be easy all files and with

105
00:06:37,370 --> 00:06:43,220
the email address that's appended

106
00:06:39,620 --> 00:06:46,480
through the original file name to do

107
00:06:43,220 --> 00:06:50,090
that quickly and to be able to to live

108
00:06:46,480 --> 00:06:52,700
to redirect that you will file so I have

109
00:06:50,090 --> 00:06:57,460
a nice listing I use good old der

110
00:06:52,700 --> 00:07:01,520
command this /s were recursing into of

111
00:06:57,460 --> 00:07:04,729
subfolders I want all the files hidden

112
00:07:01,520 --> 00:07:07,419
files as well and it shows me that I

113
00:07:04,730 --> 00:07:15,830
know the 24 files are encrypted

114
00:07:07,419 --> 00:07:18,080
okay challenge accepted but what it did

115
00:07:15,830 --> 00:07:20,890
is in in File Explorer in Windows

116
00:07:18,080 --> 00:07:26,210
it found nineteen fifty four files

117
00:07:20,890 --> 00:07:30,979
that's weird when I did this in

118
00:07:26,210 --> 00:07:33,560
PowerShell I found ninety nine hundred

119
00:07:30,980 --> 00:07:36,130
twenty four files again so what else

120
00:07:33,560 --> 00:07:36,130
going on here

121
00:07:37,280 --> 00:07:42,619
luckily our shell gives some more

122
00:07:39,830 --> 00:07:48,530
information what's really going on so

123
00:07:42,620 --> 00:07:50,419
it's it raises this nice exception that

124
00:07:48,530 --> 00:07:52,460
the fully qualified file name must be

125
00:07:50,419 --> 00:07:55,060
less than two hundred sixty characters

126
00:07:52,460 --> 00:08:01,430
and the directory name must be less than

127
00:07:55,060 --> 00:08:03,350
2048 characters okay yeah living 2017

128
00:08:01,430 --> 00:08:06,250
and we have still this we still have

129
00:08:03,350 --> 00:08:13,479
this restriction NTFS file system

130
00:08:06,250 --> 00:08:20,240
supports 32k of file path oh wow why

131
00:08:13,479 --> 00:08:23,810
well if you dig deep into MSDN you can

132
00:08:20,240 --> 00:08:29,330
find this little piece and there it is

133
00:08:23,810 --> 00:08:33,280
explained so the windows well I owe this

134
00:08:29,330 --> 00:08:36,228
and of Senna's windows file IO API

135
00:08:33,280 --> 00:08:40,949
functions only supports when it's the

136
00:08:36,229 --> 00:08:43,860
sixty characters in the path name okay

137
00:08:40,950 --> 00:08:49,880
this ransomware was able to encrypt my

138
00:08:43,860 --> 00:08:49,880
files right how the hell did that work

139
00:08:50,150 --> 00:08:55,530
okay here's a little explanation about

140
00:08:53,160 --> 00:08:59,000
why the 260 that are strange we are

141
00:08:55,530 --> 00:09:02,670
always used counting in binary so

142
00:08:59,000 --> 00:09:05,700
exponents of 2 are familiar but that

143
00:09:02,670 --> 00:09:08,579
dates back to the DOS here as well so

144
00:09:05,700 --> 00:09:12,090
you have a data structure with the drive

145
00:09:08,580 --> 00:09:15,750
letter a colon backslash Afghans 4 3 and

146
00:09:12,090 --> 00:09:20,820
the path yes that's a familiar power of

147
00:09:15,750 --> 00:09:27,500
2 exponent of you and of course the

148
00:09:20,820 --> 00:09:30,810
trailing no so I was kind of confused by

149
00:09:27,500 --> 00:09:35,070
this ransom guy successfully encrypted

150
00:09:30,810 --> 00:09:38,130
my files however how did it do that and

151
00:09:35,070 --> 00:09:44,370
why I can now can I access these files

152
00:09:38,130 --> 00:09:50,340
using my file explorer actually this is

153
00:09:44,370 --> 00:09:51,930
what happens so when when your computer

154
00:09:50,340 --> 00:09:55,260
is connected to a network and it

155
00:09:51,930 --> 00:10:00,569
performs Drive mapping that artificially

156
00:09:55,260 --> 00:10:03,030
shortens your file path so we need to

157
00:10:00,570 --> 00:10:05,720
take a look on your file server you

158
00:10:03,030 --> 00:10:09,300
still have this this long file path and

159
00:10:05,720 --> 00:10:15,740
that's where it exceeds the 2360

160
00:10:09,300 --> 00:10:20,579
character limit okay well to the rescue

161
00:10:15,740 --> 00:10:24,240
good oh yes sir I don't know how many of

162
00:10:20,580 --> 00:10:28,320
you still know this command nobody

163
00:10:24,240 --> 00:10:37,770
apparently and this gentleman has white

164
00:10:28,320 --> 00:10:42,240
hair so ok yeah both both yeah yeah so

165
00:10:37,770 --> 00:10:44,819
the the subs commands can be used to to

166
00:10:42,240 --> 00:10:46,980
create a local mapping for for

167
00:10:44,820 --> 00:10:50,460
directories and ok we're this in

168
00:10:46,980 --> 00:10:53,190
business again we can map folder to a

169
00:10:50,460 --> 00:10:54,090
drive letter we can use our good old

170
00:10:53,190 --> 00:10:58,680
your command

171
00:10:54,090 --> 00:11:03,720
and yes we can find our our files okay

172
00:10:58,680 --> 00:11:07,199
oh good bread um that's really still

173
00:11:03,720 --> 00:11:11,310
missing some files and some some errors

174
00:11:07,200 --> 00:11:14,430
and it seems that as an administrator on

175
00:11:11,310 --> 00:11:16,829
a file share you not always have the

176
00:11:14,430 --> 00:11:21,949
correct file permissions to access these

177
00:11:16,830 --> 00:11:24,720
files why is that yeah comes the joy of

178
00:11:21,950 --> 00:11:27,000
discretionary access control is that

179
00:11:24,720 --> 00:11:29,700
people can set their own file

180
00:11:27,000 --> 00:11:32,580
permissions and I can add explicit

181
00:11:29,700 --> 00:11:36,660
denies to whatever their whomever they

182
00:11:32,580 --> 00:11:39,300
want so okay that's interesting how are

183
00:11:36,660 --> 00:11:46,890
you going to be access these or restore

184
00:11:39,300 --> 00:11:50,699
this part ayah cackles is it's a nice

185
00:11:46,890 --> 00:11:55,020
DOS commands I don't know yeah again

186
00:11:50,700 --> 00:11:59,400
this is a newer command actually has

187
00:11:55,020 --> 00:12:05,670
been introduced in Windows 2000 or

188
00:11:59,400 --> 00:12:08,939
something or I don't know so you can use

189
00:12:05,670 --> 00:12:11,400
this command to take ownership of files

190
00:12:08,940 --> 00:12:13,020
and there you go you can delete them

191
00:12:11,400 --> 00:12:17,730
replace them with your backup files

192
00:12:13,020 --> 00:12:21,120
whatever you want but painfully this

193
00:12:17,730 --> 00:12:26,250
icacos command I Cal know I calculus

194
00:12:21,120 --> 00:12:31,080
sorry um this is also affected by the

195
00:12:26,250 --> 00:12:34,730
same 263 limitation ok we cover that

196
00:12:31,080 --> 00:12:39,840
already with subs so we'll be fine

197
00:12:34,730 --> 00:12:42,000
right there's another nice utility which

198
00:12:39,840 --> 00:12:44,970
some of you might be familiar with and

199
00:12:42,000 --> 00:12:47,310
that's robocopy now we can actually

200
00:12:44,970 --> 00:12:50,130
achieve the same thing without worrying

201
00:12:47,310 --> 00:12:55,890
about path lengths because it supports a

202
00:12:50,130 --> 00:12:58,250
full 30-day to 32k file path and that's

203
00:12:55,890 --> 00:13:02,120
because it's using a more modern

204
00:12:58,250 --> 00:13:05,670
variation of the windows file i/o api

205
00:13:02,120 --> 00:13:07,980
that's for supporting unicode yeah she

206
00:13:05,670 --> 00:13:11,670
know unicode will double your your

207
00:13:07,980 --> 00:13:13,530
string size so yeah it would be very

208
00:13:11,670 --> 00:13:20,430
shitty if you're a file path should be

209
00:13:13,530 --> 00:13:23,370
reduced to 128 characters so robocopy is

210
00:13:20,430 --> 00:13:29,939
pretty neat so you can use yet it has

211
00:13:23,370 --> 00:13:32,700
some additional benefits so there's some

212
00:13:29,940 --> 00:13:38,460
additional benefits because you actually

213
00:13:32,700 --> 00:13:40,560
can use the backup rights so if you're

214
00:13:38,460 --> 00:13:45,330
an administrator and you throw these

215
00:13:40,560 --> 00:13:50,010
backup rice in into the battle you can

216
00:13:45,330 --> 00:13:53,760
even write files that you that are

217
00:13:50,010 --> 00:13:55,410
shielded by regular file permissions so

218
00:13:53,760 --> 00:13:57,500
that's actually pretty nice but you

219
00:13:55,410 --> 00:14:00,780
don't have to do the take ownership and

220
00:13:57,500 --> 00:14:02,880
stuff people are always scared when you

221
00:14:00,780 --> 00:14:07,800
as an administrator take ownership of

222
00:14:02,880 --> 00:14:13,980
files you should in this case you are a

223
00:14:07,800 --> 00:14:16,890
scary you what if we combine power shell

224
00:14:13,980 --> 00:14:20,360
and robocopy there's obviously someone

225
00:14:16,890 --> 00:14:24,990
smarter than me that already did that

226
00:14:20,360 --> 00:14:27,600
and this is a pretty neat script that

227
00:14:24,990 --> 00:14:33,480
you can use exactly do these copy files

228
00:14:27,600 --> 00:14:39,360
pool files without the 260 character

229
00:14:33,480 --> 00:14:44,760
restriction so thank you to will rebuild

230
00:14:39,360 --> 00:14:46,660
our system I already told you just part

231
00:14:44,760 --> 00:14:49,480
of the files

232
00:14:46,660 --> 00:14:51,639
obviously only the interesting documents

233
00:14:49,480 --> 00:14:56,319
are encrypted so that the ransomware

234
00:14:51,639 --> 00:14:58,540
skips executables and so on so it

235
00:14:56,319 --> 00:15:02,219
doesn't want to ruin your computer

236
00:14:58,540 --> 00:15:05,620
because well if you start encrypting

237
00:15:02,220 --> 00:15:06,970
executable files I think there's a good

238
00:15:05,620 --> 00:15:10,480
chance that your computer doesn't work

239
00:15:06,970 --> 00:15:13,300
anymore so there's Skip be so handsome I

240
00:15:10,480 --> 00:15:20,019
usually encrypts your Word document your

241
00:15:13,300 --> 00:15:22,359
Excel files your family photos etc in

242
00:15:20,019 --> 00:15:24,699
this case we're talking about the file

243
00:15:22,360 --> 00:15:26,560
shares or the Department file shares or

244
00:15:24,699 --> 00:15:30,370
other people are relying through that as

245
00:15:26,560 --> 00:15:35,709
well so yeah people are very stressed

246
00:15:30,370 --> 00:15:41,459
out and the good news was the backup it

247
00:15:35,709 --> 00:15:46,329
was one day off ok it was a full backup

248
00:15:41,459 --> 00:15:50,649
one terabyte of data more than 100

249
00:15:46,329 --> 00:15:55,089
thousand files ok I challenge you do you

250
00:15:50,649 --> 00:15:58,980
know backup solution that you can feed a

251
00:15:55,089 --> 00:16:02,920
list of files serve as a selection

252
00:15:58,980 --> 00:16:08,620
anymore any takers who selectively

253
00:16:02,920 --> 00:16:15,130
restore files no I thought so I couldn't

254
00:16:08,620 --> 00:16:17,680
find one where when I needed it so so we

255
00:16:15,130 --> 00:16:25,149
have to restore and we don't want to

256
00:16:17,680 --> 00:16:26,290
overwrite untouched files so what

257
00:16:25,149 --> 00:16:29,410
options do you have

258
00:16:26,290 --> 00:16:32,439
yeah of course this is an off-site

259
00:16:29,410 --> 00:16:37,779
backup every by every organization

260
00:16:32,439 --> 00:16:40,029
should do an off-site backup but howling

261
00:16:37,779 --> 00:16:43,240
one terabyte of data across a network

262
00:16:40,029 --> 00:16:46,360
even if you have a really need when

263
00:16:43,240 --> 00:16:50,860
connection is a challenge so even with

264
00:16:46,360 --> 00:16:54,340
the 40 megabits one connection - should

265
00:16:50,860 --> 00:17:03,480
take more than 35 hours to restore

266
00:16:54,340 --> 00:17:07,750
not ideal well if your backup is stored

267
00:17:03,480 --> 00:17:12,400
and if you Finity perhaps you can do the

268
00:17:07,750 --> 00:17:15,849
restore off-site as well and ship and

269
00:17:12,400 --> 00:17:18,790
ship a harddrive via file server and

270
00:17:15,849 --> 00:17:22,629
then restore locally and this should be

271
00:17:18,790 --> 00:17:25,629
doable through boots about 25 megabytes

272
00:17:22,630 --> 00:17:33,550
per second and it takes four hours it's

273
00:17:25,630 --> 00:17:39,040
much more acceptable so the hard drive

274
00:17:33,550 --> 00:17:49,450
came in and that's what they're restored

275
00:17:39,040 --> 00:17:52,420
on eighth edition the files okay the the

276
00:17:49,450 --> 00:17:56,110
contents are alright but we don't have D

277
00:17:52,420 --> 00:17:56,410
file permissions set on these here we go

278
00:17:56,110 --> 00:18:00,428
again

279
00:17:56,410 --> 00:18:02,980
I told you this presentation is about

280
00:18:00,429 --> 00:18:06,960
the series of unfortunate events and

281
00:18:02,980 --> 00:18:06,960
that's exactly what happened

282
00:18:08,760 --> 00:18:14,740
fortunately Microsoft to the rescue

283
00:18:10,960 --> 00:18:18,580
again so with this I chaos tool I

284
00:18:14,740 --> 00:18:21,670
described earlier it's possible to store

285
00:18:18,580 --> 00:18:25,830
all your file permissions into a

286
00:18:21,670 --> 00:18:29,110
separate file and import that on a

287
00:18:25,830 --> 00:18:32,919
difference well similarly looking file

288
00:18:29,110 --> 00:18:37,510
system so basically this is what you do

289
00:18:32,920 --> 00:18:39,520
on your on your encrypted file share it

290
00:18:37,510 --> 00:18:44,160
source the file permissions and

291
00:18:39,520 --> 00:18:47,170
hopefully everything is fine when we

292
00:18:44,160 --> 00:18:49,980
after the restore we apply these

293
00:18:47,170 --> 00:18:49,980
permissions again

294
00:18:55,269 --> 00:19:03,490
okay after this exercise a little bit

295
00:18:58,610 --> 00:19:07,100
more than five hours later still the

296
00:19:03,490 --> 00:19:09,590
co-workers that use the the department

297
00:19:07,100 --> 00:19:13,549
share complain we have these files yet

298
00:19:09,590 --> 00:19:22,850
we cannot open is it the comm file no it

299
00:19:13,549 --> 00:19:23,950
is not wait this is what happened so the

300
00:19:22,850 --> 00:19:27,740
ransomware

301
00:19:23,950 --> 00:19:29,509
was able to D to encrypt the file in

302
00:19:27,740 --> 00:19:31,519
place so it opens the file write some

303
00:19:29,509 --> 00:19:33,500
garbage it doesn't do the full

304
00:19:31,519 --> 00:19:37,250
encryption because it takes too long or

305
00:19:33,500 --> 00:19:41,090
they overwrite one or two K of worth

306
00:19:37,250 --> 00:19:42,110
abides move on to the next wait before

307
00:19:41,090 --> 00:19:45,370
moving on to the next

308
00:19:42,110 --> 00:19:50,209
they have been the nice email address

309
00:19:45,370 --> 00:19:57,889
but in particular cases you exceed this

310
00:19:50,210 --> 00:20:00,679
to another sixty character limit ah how

311
00:19:57,889 --> 00:20:02,709
are we going to find these needles in a

312
00:20:00,679 --> 00:20:02,710
haystack

313
00:20:09,070 --> 00:20:14,080
I don't know I didn't get any response

314
00:20:11,950 --> 00:20:18,990
from the surface desk so I wouldn't be

315
00:20:14,080 --> 00:20:23,679
able to tell you so we have a huge

316
00:20:18,990 --> 00:20:28,080
haystack with a mix of legitimately

317
00:20:23,680 --> 00:20:32,320
edited files and encrypted files so yes

318
00:20:28,080 --> 00:20:37,659
are you thinking you can filter on on a

319
00:20:32,320 --> 00:20:41,040
file modification timestamp yeah you

320
00:20:37,660 --> 00:20:44,890
still have a few thousands file saying I

321
00:20:41,040 --> 00:20:51,909
don't I don't like manually trying to

322
00:20:44,890 --> 00:20:54,760
open them so I came up with something as

323
00:20:51,910 --> 00:20:57,910
I told you this particular piece of

324
00:20:54,760 --> 00:21:06,280
ransomware which by the way is called

325
00:20:57,910 --> 00:21:10,110
the and India it was Indian for monkey

326
00:21:06,280 --> 00:21:13,600
robber or something Bond Archer I

327
00:21:10,110 --> 00:21:21,129
learned that from Indian administrator

328
00:21:13,600 --> 00:21:23,080
who was obviously out sourced well she

329
00:21:21,130 --> 00:21:28,950
was working for an outsourcing company

330
00:21:23,080 --> 00:21:34,120
that took care of this infrastructure

331
00:21:28,950 --> 00:21:37,000
I'm not drawing any conclusions here so

332
00:21:34,120 --> 00:21:41,639
I came up with with doing a frequency

333
00:21:37,000 --> 00:21:45,330
analysis on the files or simply

334
00:21:41,640 --> 00:21:50,290
something like this and I have to thank

335
00:21:45,330 --> 00:21:54,909
a guy named Mehta physician for this

336
00:21:50,290 --> 00:22:00,580
useful code snippet so we copy and paste

337
00:21:54,910 --> 00:22:05,970
and you can do a file you read him the

338
00:22:00,580 --> 00:22:09,370
contents of the file take the first 1k

339
00:22:05,970 --> 00:22:12,190
entropy analysis on that and if it's

340
00:22:09,370 --> 00:22:15,479
high entropy and the rest of the file is

341
00:22:12,190 --> 00:22:18,330
a lower entropy then you should be

342
00:22:15,480 --> 00:22:21,330
reasonably safe that you have encounters

343
00:22:18,330 --> 00:22:21,330
encrypted

344
00:22:21,470 --> 00:22:31,409
so this way I was finally able to to see

345
00:22:28,080 --> 00:22:36,439
all the files and restore selectively

346
00:22:31,409 --> 00:22:38,820
restore these using the same strategy so

347
00:22:36,440 --> 00:22:43,159
what can we learn from this at least

348
00:22:38,820 --> 00:22:45,928
what what do we want to developers of

349
00:22:43,159 --> 00:22:50,220
ransomware well by the way I want from

350
00:22:45,929 --> 00:22:52,249
them please use the Unicode file IO API

351
00:22:50,220 --> 00:22:54,090
please please please

352
00:22:52,249 --> 00:23:01,009
especially if you're trashing the

353
00:22:54,090 --> 00:23:04,559
funding I would like a better GUI so

354
00:23:01,009 --> 00:23:05,789
later I found the text file and that's

355
00:23:04,559 --> 00:23:09,149
not very user friendly

356
00:23:05,789 --> 00:23:12,749
I don't like and please use a proper

357
00:23:09,149 --> 00:23:15,178
email infrastructure so why do I have to

358
00:23:12,749 --> 00:23:17,070
create a gmail accounts to send them

359
00:23:15,179 --> 00:23:20,549
email and otherwise they don't receive

360
00:23:17,070 --> 00:23:26,299
it and their response ends up in my spam

361
00:23:20,549 --> 00:23:29,489
folder or not at all come on and yeah

362
00:23:26,299 --> 00:23:37,070
please respond or at least have a

363
00:23:29,489 --> 00:23:41,580
mailbox well jokes aside when you

364
00:23:37,070 --> 00:23:45,059
encounter a case of ransomware of course

365
00:23:41,580 --> 00:23:49,289
there are some lessons learnt as well so

366
00:23:45,059 --> 00:23:52,139
it's very important that you know our

367
00:23:49,289 --> 00:23:58,289
ransomware works and what artifacts be a

368
00:23:52,139 --> 00:24:00,559
and how you can can identify encrypted

369
00:23:58,289 --> 00:24:00,559
files

370
00:24:01,519 --> 00:24:07,229
well I've described a pretty

371
00:24:04,139 --> 00:24:11,189
unconventional recovery strategy that's

372
00:24:07,229 --> 00:24:14,190
because of the backup solution did not

373
00:24:11,190 --> 00:24:16,529
really do what it was supposed to do or

374
00:24:14,190 --> 00:24:23,359
at least it was missing a feature where

375
00:24:16,529 --> 00:24:25,799
you could selectively restore files so

376
00:24:23,359 --> 00:24:29,639
take into consideration that something

377
00:24:25,799 --> 00:24:33,790
like that can happen as well for all of

378
00:24:29,639 --> 00:24:36,139
you with the snapshot solutions

379
00:24:33,790 --> 00:24:43,940
think about it that can be a challenge

380
00:24:36,140 --> 00:24:48,920
as well another thing how can you be

381
00:24:43,940 --> 00:24:52,340
notified as soon as as a file share is

382
00:24:48,920 --> 00:24:57,410
in the process of being encrypted you

383
00:24:52,340 --> 00:25:00,649
can put some file share canneries so put

384
00:24:57,410 --> 00:25:03,320
some file and enable filesystem auditing

385
00:25:00,650 --> 00:25:06,410
on it hide it somewhere deep so

386
00:25:03,320 --> 00:25:11,120
irregular users will not touch it I did

387
00:25:06,410 --> 00:25:17,960
with all means possible but potentially

388
00:25:11,120 --> 00:25:20,330
the ransomware will touch it and once it

389
00:25:17,960 --> 00:25:28,570
gets touched you're pretty sure that

390
00:25:20,330 --> 00:25:36,530
something is amiss more has bugs

391
00:25:28,570 --> 00:25:38,960
unfortunately so don't count on on the

392
00:25:36,530 --> 00:25:43,850
helpdesk but don't count that it always

393
00:25:38,960 --> 00:25:51,080
works as designed and I cannot mention

394
00:25:43,850 --> 00:25:56,290
enough backups are very important that

395
00:25:51,080 --> 00:26:01,389
was my story so we have some time for a

396
00:25:56,290 --> 00:26:01,389
question Thank You mo theis

397
00:26:04,880 --> 00:26:08,330
any questions

398
00:26:16,890 --> 00:26:22,800
my question is how long did it take you

399
00:26:18,930 --> 00:26:27,740
to I mean to do all this work flow from

400
00:26:22,800 --> 00:26:33,050
beginning to the end needs months yes to

401
00:26:27,740 --> 00:26:37,820
four days yep

402
00:26:33,050 --> 00:26:41,659
Foreman days all right

403
00:26:37,820 --> 00:26:47,168
thank you very much thank you more days

404
00:26:41,660 --> 00:26:47,169
[Applause]

