1
00:00:01,410 --> 00:00:06,030
[Music]

2
00:00:07,919 --> 00:00:08,800
okay

3
00:00:08,800 --> 00:00:10,719
um i've been

4
00:00:10,719 --> 00:00:13,280
i said i'm honored to speak at this

5
00:00:13,280 --> 00:00:16,560
event and i've been involved with esappy

6
00:00:16,560 --> 00:00:19,600
going back to august 2009

7
00:00:19,600 --> 00:00:21,119
and i've been the project leader on it

8
00:00:21,119 --> 00:00:23,320
since like january

9
00:00:23,320 --> 00:00:25,760
2012 or somewhere

10
00:00:25,760 --> 00:00:28,400
or 11 or something like that

11
00:00:28,400 --> 00:00:30,640
it seems basically it was like when i

12
00:00:30,640 --> 00:00:32,159
was in kindergarten

13
00:00:32,159 --> 00:00:34,719
um of course i'd also be remiss if i

14
00:00:34,719 --> 00:00:36,960
didn't you know say that the views that

15
00:00:36,960 --> 00:00:39,200
expressed here in this

16
00:00:39,200 --> 00:00:42,079
talk are solely my own do not represent

17
00:00:42,079 --> 00:00:44,879
necessarily the thoughts or opinions of

18
00:00:44,879 --> 00:00:46,879
the owass foundation or any of my

19
00:00:46,879 --> 00:00:48,800
employers whether

20
00:00:48,800 --> 00:00:51,919
current or previous

21
00:00:54,000 --> 00:00:55,840
um okay so

22
00:00:55,840 --> 00:00:57,920
a couple of objectives here and before

23
00:00:57,920 --> 00:00:59,760
you look at this slide and say thank you

24
00:00:59,760 --> 00:01:03,199
captain obvious but duh let me say that

25
00:01:03,199 --> 00:01:05,438
i've been doing development for almost

26
00:01:05,438 --> 00:01:08,640
30 years before esappy without realizing

27
00:01:08,640 --> 00:01:10,400
all these nuances

28
00:01:10,400 --> 00:01:11,200
right

29
00:01:11,200 --> 00:01:14,000
um but i want to show you the following

30
00:01:14,000 --> 00:01:16,240
points that basically library

31
00:01:16,240 --> 00:01:18,479
development is very different than a

32
00:01:18,479 --> 00:01:20,720
typical product development

33
00:01:20,720 --> 00:01:23,200
that um you know there are unique

34
00:01:23,200 --> 00:01:26,000
challenges facing a developer a library

35
00:01:26,000 --> 00:01:28,799
developer faces that i'm hoping to show

36
00:01:28,799 --> 00:01:30,320
you um

37
00:01:30,320 --> 00:01:32,320
early success can be a problem and i'm

38
00:01:32,320 --> 00:01:34,560
going to give some examples

39
00:01:34,560 --> 00:01:35,520
of that

40
00:01:35,520 --> 00:01:37,119
later on and then

41
00:01:37,119 --> 00:01:39,520
foss is different than business

42
00:01:39,520 --> 00:01:41,839
development

43
00:01:44,079 --> 00:01:46,079
and i will discuss

44
00:01:46,079 --> 00:01:47,360
the lessons i'm going to go through

45
00:01:47,360 --> 00:01:48,799
lessons learned basically first by

46
00:01:48,799 --> 00:01:51,119
talking about process and people than

47
00:01:51,119 --> 00:01:52,399
technical

48
00:01:52,399 --> 00:01:54,479
and then each perspective is going to

49
00:01:54,479 --> 00:01:56,159
have four sections like an overview of

50
00:01:56,159 --> 00:01:58,560
what it's about and then

51
00:01:58,560 --> 00:02:00,320
the what was done right what was the

52
00:02:00,320 --> 00:02:01,280
wrong and

53
00:02:01,280 --> 00:02:02,880
and the things that basically the ugly

54
00:02:02,880 --> 00:02:04,479
hacks that were done

55
00:02:04,479 --> 00:02:06,240
or that's not really neither good nor

56
00:02:06,240 --> 00:02:09,038
bad but just you know probably could

57
00:02:09,038 --> 00:02:11,599
have been better

58
00:02:12,959 --> 00:02:15,280
so first the process perspective and

59
00:02:15,280 --> 00:02:16,640
that's basically

60
00:02:16,640 --> 00:02:18,400
um things like

61
00:02:18,400 --> 00:02:21,440
you know realization like uh libraries

62
00:02:21,440 --> 00:02:22,959
and applications are different they're

63
00:02:22,959 --> 00:02:24,480
different in design they're different in

64
00:02:24,480 --> 00:02:27,040
testing and documentation

65
00:02:27,040 --> 00:02:28,879
um the major difference i think that

66
00:02:28,879 --> 00:02:30,560
basically

67
00:02:30,560 --> 00:02:33,599
is that if you think of like um the

68
00:02:33,599 --> 00:02:35,920
process that we use for applications

69
00:02:35,920 --> 00:02:38,720
especially in the agile world right we

70
00:02:38,720 --> 00:02:41,360
basically say refactor early and often

71
00:02:41,360 --> 00:02:42,400
um

72
00:02:42,400 --> 00:02:44,560
in a library world once you put out that

73
00:02:44,560 --> 00:02:47,200
release 1.0 and you have clients those

74
00:02:47,200 --> 00:02:48,879
clients lock into that and if you want

75
00:02:48,879 --> 00:02:51,200
to keep those clients

76
00:02:51,200 --> 00:02:53,280
you cannot be changing interfaces

77
00:02:53,280 --> 00:02:55,760
to them right so that's the major thing

78
00:02:55,760 --> 00:02:56,800
i think

79
00:02:56,800 --> 00:03:00,239
the other thing is that um

80
00:03:00,239 --> 00:03:02,000
developing security libraries versus

81
00:03:02,000 --> 00:03:06,000
other libraries a lot of um

82
00:03:06,000 --> 00:03:08,959
you know i've actually reviewed uh past

83
00:03:08,959 --> 00:03:11,040
eight years i've been on a code review

84
00:03:11,040 --> 00:03:12,159
and have done

85
00:03:12,159 --> 00:03:14,959
uh a lot of reviews of foss security

86
00:03:14,959 --> 00:03:16,560
libraries and stuff like that and a lot

87
00:03:16,560 --> 00:03:19,360
of times they're some of the worst

88
00:03:19,360 --> 00:03:21,519
written things

89
00:03:21,519 --> 00:03:24,000
we as a community do not eat our own

90
00:03:24,000 --> 00:03:26,560
apps like dog food a lot of times

91
00:03:26,560 --> 00:03:27,360
right

92
00:03:27,360 --> 00:03:29,200
and then the other thing is that

93
00:03:29,200 --> 00:03:31,840
basically there's effects when we try to

94
00:03:31,840 --> 00:03:34,959
change processes

95
00:03:35,920 --> 00:03:38,080
right so the good thing about esappy is

96
00:03:38,080 --> 00:03:39,760
that things start small with simple

97
00:03:39,760 --> 00:03:41,840
expectations right

98
00:03:41,840 --> 00:03:44,080
um the original vision was basically a

99
00:03:44,080 --> 00:03:46,319
library that was pretty much only

100
00:03:46,319 --> 00:03:48,400
interfaces but the problem is how do you

101
00:03:48,400 --> 00:03:49,680
test an interface how do you know that

102
00:03:49,680 --> 00:03:51,840
you got the interface right you have to

103
00:03:51,840 --> 00:03:54,239
have some kind of like example code or

104
00:03:54,239 --> 00:03:56,239
something that you write so it turned

105
00:03:56,239 --> 00:03:57,840
into a reference model

106
00:03:57,840 --> 00:04:00,000
well that got bundled which was probably

107
00:04:00,000 --> 00:04:01,760
a poor idea in hindsight but it got

108
00:04:01,760 --> 00:04:05,280
bundled with the interfaces

109
00:04:06,799 --> 00:04:10,000
so um the bad perspective is like

110
00:04:10,000 --> 00:04:12,799
some of the things is we went through uh

111
00:04:12,799 --> 00:04:14,400
before i joined

112
00:04:14,400 --> 00:04:16,399
they were 1.4

113
00:04:16,399 --> 00:04:18,798
when i they were doing the 2.0

114
00:04:18,798 --> 00:04:21,199
release candidates when i joined

115
00:04:21,199 --> 00:04:22,960
um and going from

116
00:04:22,960 --> 00:04:24,240
we didn't have really any clear

117
00:04:24,240 --> 00:04:28,560
migration plan from 1.x to x

118
00:04:28,560 --> 00:04:30,320
generally when you know from semantic

119
00:04:30,320 --> 00:04:32,479
versioning when you go through a major

120
00:04:32,479 --> 00:04:34,080
release number change you don't

121
00:04:34,080 --> 00:04:36,160
necessarily have to promise

122
00:04:36,160 --> 00:04:38,880
that all the interfaces um

123
00:04:38,880 --> 00:04:43,280
uh have to remain the same but

124
00:04:43,280 --> 00:04:45,040
they pretty much tried to keep them the

125
00:04:45,040 --> 00:04:47,199
same regardless and that included

126
00:04:47,199 --> 00:04:48,479
basically

127
00:04:48,479 --> 00:04:50,720
a lot of the broken crypto code that i

128
00:04:50,720 --> 00:04:52,320
took over and

129
00:04:52,320 --> 00:04:54,320
so we tried to like keep the old 1.4

130
00:04:54,320 --> 00:04:56,080
encrypter interfaces and just add new

131
00:04:56,080 --> 00:04:57,440
ones on top of that and then i

132
00:04:57,440 --> 00:04:59,199
deprecated the old ones

133
00:04:59,199 --> 00:05:01,039
but it turned out in hindsight right

134
00:05:01,039 --> 00:05:03,039
that was actually largely responsible

135
00:05:03,039 --> 00:05:05,680
for one of the two cves that were later

136
00:05:05,680 --> 00:05:06,800
discovered

137
00:05:06,800 --> 00:05:09,680
in in east happy

138
00:05:09,680 --> 00:05:11,840
um

139
00:05:13,280 --> 00:05:16,400
also you know there was a no we didn't

140
00:05:16,400 --> 00:05:18,560
have a plan for becoming a

141
00:05:18,560 --> 00:05:20,479
victim of our own success right there

142
00:05:20,479 --> 00:05:22,720
was a lot of parts of east happy that

143
00:05:22,720 --> 00:05:24,880
became very popular early on partly

144
00:05:24,880 --> 00:05:26,240
because there wasn't any other

145
00:05:26,240 --> 00:05:28,560
alternatives the ones that i come to

146
00:05:28,560 --> 00:05:30,560
mind are the encoder and validator

147
00:05:30,560 --> 00:05:32,960
interfaces in some degree the safe

148
00:05:32,960 --> 00:05:34,240
logging

149
00:05:34,240 --> 00:05:35,120
the

150
00:05:35,120 --> 00:05:37,520
encoder was even recognized in some as

151
00:05:37,520 --> 00:05:39,520
defense in some sas tools like uh

152
00:05:39,520 --> 00:05:41,680
fortify and vera code

153
00:05:41,680 --> 00:05:43,520
right but that diverted attention from

154
00:05:43,520 --> 00:05:46,400
other areas where all we had because we

155
00:05:46,400 --> 00:05:48,960
were doing a reference implementation um

156
00:05:48,960 --> 00:05:50,840
where all we had was basically

157
00:05:50,840 --> 00:05:52,960
toy uh implementations like

158
00:05:52,960 --> 00:05:54,639
authenticator and access controller

159
00:05:54,639 --> 00:05:56,080
which were completely

160
00:05:56,080 --> 00:05:58,479
file based and they just didn't scale at

161
00:05:58,479 --> 00:06:00,960
an enterprise level and the e and

162
00:06:00,960 --> 00:06:05,239
these app was supposed to be enterprise

163
00:06:06,479 --> 00:06:09,680
um the ugly part was that

164
00:06:09,680 --> 00:06:10,560
uh

165
00:06:10,560 --> 00:06:12,639
we didn't give very much consideration

166
00:06:12,639 --> 00:06:15,199
to a library development differs from

167
00:06:15,199 --> 00:06:16,880
application development

168
00:06:16,880 --> 00:06:18,400
and i mentioned this kind of already

169
00:06:18,400 --> 00:06:20,479
that you know the agile reflecting a

170
00:06:20,479 --> 00:06:23,039
constant refactor you can't do that

171
00:06:23,039 --> 00:06:25,520
you just can't do that uh you cannot

172
00:06:25,520 --> 00:06:28,160
refactor public classes

173
00:06:28,160 --> 00:06:30,240
um and one of the things that or or

174
00:06:30,240 --> 00:06:33,039
interfaces right and

175
00:06:33,039 --> 00:06:35,440
because we did this before java 8 and

176
00:06:35,440 --> 00:06:38,400
java modules were available it was like

177
00:06:38,400 --> 00:06:39,840
very difficult

178
00:06:39,840 --> 00:06:40,720
um

179
00:06:40,720 --> 00:06:42,800
couldn't really guarantee the direct use

180
00:06:42,800 --> 00:06:44,800
of implementation classes

181
00:06:44,800 --> 00:06:46,479
or classes that were not intended you

182
00:06:46,479 --> 00:06:48,400
know that were intended to be private so

183
00:06:48,400 --> 00:06:51,280
they sort of became the public interface

184
00:06:51,280 --> 00:06:52,400
as well

185
00:06:52,400 --> 00:06:53,680
right

186
00:06:53,680 --> 00:06:55,199
the other thing is how do you security

187
00:06:55,199 --> 00:06:57,120
test the library well

188
00:06:57,120 --> 00:07:00,160
unlike say rest apis you cannot like

189
00:07:00,160 --> 00:07:02,319
just generally fuzz them because you

190
00:07:02,319 --> 00:07:04,160
know you have strong typing in java that

191
00:07:04,160 --> 00:07:06,479
makes that difficult

192
00:07:06,479 --> 00:07:08,160
so you just can't like say oh i got this

193
00:07:08,160 --> 00:07:09,759
string i'm just going to change you know

194
00:07:09,759 --> 00:07:11,599
fuzz the string or whatever

195
00:07:11,599 --> 00:07:14,960
so we had to do a lot of unit testing

196
00:07:14,960 --> 00:07:17,360
and a lot of that was just really

197
00:07:17,360 --> 00:07:19,840
you know in my opinion not up to snuff

198
00:07:19,840 --> 00:07:22,400
until much later on like maybe 2.2 or

199
00:07:22,400 --> 00:07:24,799
whatever

200
00:07:26,080 --> 00:07:28,000
um

201
00:07:28,000 --> 00:07:30,560
the people perspective uh

202
00:07:30,560 --> 00:07:32,160
i can't really present you know a

203
00:07:32,160 --> 00:07:33,680
complete perspective because i didn't

204
00:07:33,680 --> 00:07:36,319
get involved with the 1.x development

205
00:07:36,319 --> 00:07:37,120
but

206
00:07:37,120 --> 00:07:39,840
um this is sort of discussing how people

207
00:07:39,840 --> 00:07:40,880
that were

208
00:07:40,880 --> 00:07:41,919
involved

209
00:07:41,919 --> 00:07:43,840
in uh in the succession of the

210
00:07:43,840 --> 00:07:46,319
leadership in fact affected the

211
00:07:46,319 --> 00:07:49,199
uh esappy

212
00:07:49,199 --> 00:07:51,199
so the good thing was that they had some

213
00:07:51,199 --> 00:07:53,120
really top-notch people working on this

214
00:07:53,120 --> 00:07:55,599
um it was started off by jeff williams

215
00:07:55,599 --> 00:07:59,039
and then jim maniko kind of took over as

216
00:07:59,039 --> 00:08:01,280
sort of the project leader

217
00:08:01,280 --> 00:08:03,039
you know i don't know if it was a formal

218
00:08:03,039 --> 00:08:04,720
thing but um and he kept it running

219
00:08:04,720 --> 00:08:06,479
really smoothly and jim

220
00:08:06,479 --> 00:08:09,360
was really good because he's uh

221
00:08:09,360 --> 00:08:11,199
you know i'd say he's like an evangelist

222
00:08:11,199 --> 00:08:12,879
right he would go out and get all these

223
00:08:12,879 --> 00:08:15,039
people to participate and we had you

224
00:08:15,039 --> 00:08:16,560
know at one point in time probably a

225
00:08:16,560 --> 00:08:18,720
dozen people working on it

226
00:08:18,720 --> 00:08:21,520
um but

227
00:08:21,520 --> 00:08:22,879
uh

228
00:08:22,879 --> 00:08:24,879
we had a lot of initial enthusiasm up to

229
00:08:24,879 --> 00:08:27,919
the 2.0 uh ga release

230
00:08:27,919 --> 00:08:28,800
right

231
00:08:28,800 --> 00:08:31,120
and then the other thing is that um

232
00:08:31,120 --> 00:08:32,479
technical disagreements were handled

233
00:08:32,479 --> 00:08:35,039
very professionally and transparently on

234
00:08:35,039 --> 00:08:37,679
a public mailing list it's not like

235
00:08:37,679 --> 00:08:40,479
you know twitter where people do twitter

236
00:08:40,479 --> 00:08:43,120
storms and stuff and hide behind handles

237
00:08:43,120 --> 00:08:44,720
that you don't necessarily know who they

238
00:08:44,720 --> 00:08:46,560
are and things like that so for the most

239
00:08:46,560 --> 00:08:48,640
part all the technical discussions are

240
00:08:48,640 --> 00:08:50,080
very civil

241
00:08:50,080 --> 00:08:53,080
um

242
00:08:56,560 --> 00:08:59,600
the bad part though was that i think

243
00:08:59,600 --> 00:09:01,360
uh in terms of passing off the

244
00:09:01,360 --> 00:09:03,200
succession after jim

245
00:09:03,200 --> 00:09:05,839
decided he needed to step away

246
00:09:05,839 --> 00:09:07,920
um that good technical leaders in the

247
00:09:07,920 --> 00:09:09,519
business world do not necessarily

248
00:09:09,519 --> 00:09:12,320
translate to the foss world right

249
00:09:12,320 --> 00:09:14,080
and then the other thing was picking

250
00:09:14,080 --> 00:09:16,240
your next successor by suddenly stepping

251
00:09:16,240 --> 00:09:17,760
down and putting in

252
00:09:17,760 --> 00:09:19,120
to the most involved committers as

253
00:09:19,120 --> 00:09:21,200
co-leaders is not a good strategy unless

254
00:09:21,200 --> 00:09:23,839
you have some kind of plan to stand by

255
00:09:23,839 --> 00:09:25,760
them and be able to help them and jim

256
00:09:25,760 --> 00:09:28,160
just didn't have the time to do that

257
00:09:28,160 --> 00:09:29,600
so

258
00:09:29,600 --> 00:09:32,080
both of those bullets i i can't speak

259
00:09:32,080 --> 00:09:33,680
for chris schmidt who was the other

260
00:09:33,680 --> 00:09:35,200
project co-lead but both of these

261
00:09:35,200 --> 00:09:37,120
bullets definitely would apply to me

262
00:09:37,120 --> 00:09:39,279
in the first case like the first bullet

263
00:09:39,279 --> 00:09:42,160
i had no experience uh in volunteering

264
00:09:42,160 --> 00:09:43,680
in the fox world other than doing a

265
00:09:43,680 --> 00:09:46,240
couple like you know very very small uh

266
00:09:46,240 --> 00:09:47,680
pull requests

267
00:09:47,680 --> 00:09:49,600
uh the correct bugs

268
00:09:49,600 --> 00:09:51,680
um in the business world i do fine as a

269
00:09:51,680 --> 00:09:53,440
technical leader but as a completely

270
00:09:53,440 --> 00:09:55,440
different environment right

271
00:09:55,440 --> 00:09:57,120
um because it's not a volunteer

272
00:09:57,120 --> 00:09:59,600
environment the second

273
00:09:59,600 --> 00:10:01,920
point is if you remember at least like

274
00:10:01,920 --> 00:10:04,000
me right growing up as a kid where you

275
00:10:04,000 --> 00:10:05,519
see these cartoons right they have a

276
00:10:05,519 --> 00:10:07,200
line of people and they say all the

277
00:10:07,200 --> 00:10:08,880
volunteers please step forward and

278
00:10:08,880 --> 00:10:10,959
there's this one clueless sap

279
00:10:10,959 --> 00:10:12,880
that stands in line and everybody else

280
00:10:12,880 --> 00:10:15,040
takes a step backwards leaving that

281
00:10:15,040 --> 00:10:16,720
unlucky sucky saying what the heck just

282
00:10:16,720 --> 00:10:18,320
happened well i kind of felt that that

283
00:10:18,320 --> 00:10:19,839
was me

284
00:10:19,839 --> 00:10:23,839
when uh jim maniko uh selected chris

285
00:10:23,839 --> 00:10:26,320
schmidt and myself to be project

286
00:10:26,320 --> 00:10:27,680
co-leaders

287
00:10:27,680 --> 00:10:28,959
so well

288
00:10:28,959 --> 00:10:30,560
ugly okay

289
00:10:30,560 --> 00:10:31,360
but

290
00:10:31,360 --> 00:10:33,360
um i've been told i have a face for

291
00:10:33,360 --> 00:10:36,480
radio or maybe podcasts in the 21st

292
00:10:36,480 --> 00:10:38,560
century here but

293
00:10:38,560 --> 00:10:40,399
no seriously um

294
00:10:40,399 --> 00:10:43,519
the ugly part was that after the two

295
00:10:43,519 --> 00:10:45,920
general availability release pretty much

296
00:10:45,920 --> 00:10:47,519
all the other help disappeared except

297
00:10:47,519 --> 00:10:49,200
for chris schmidt and myself and we

298
00:10:49,200 --> 00:10:50,320
basically

299
00:10:50,320 --> 00:10:54,320
you know handled about 98 of the work

300
00:10:54,320 --> 00:10:57,120
all the bug fixes and you know

301
00:10:57,120 --> 00:10:59,120
releases and everything the previous

302
00:10:59,120 --> 00:11:01,519
regime didn't pass on any details of how

303
00:11:01,519 --> 00:11:03,680
to actually do a deployment

304
00:11:03,680 --> 00:11:06,560
and chris eventually figured it out but

305
00:11:06,560 --> 00:11:08,240
he didn't document it and then chris had

306
00:11:08,240 --> 00:11:10,079
to leave because he had other personal

307
00:11:10,079 --> 00:11:12,800
commitments with his work in changing

308
00:11:12,800 --> 00:11:15,800
jobs

309
00:11:15,920 --> 00:11:18,480
so the technical part uh the discussion

310
00:11:18,480 --> 00:11:20,399
just issues around architecture and

311
00:11:20,399 --> 00:11:23,440
design what i learned

312
00:11:23,519 --> 00:11:25,519
all right so it started with interfaces

313
00:11:25,519 --> 00:11:27,600
as i mentioned right um jeff williams

314
00:11:27,600 --> 00:11:28,959
original idea was just to get the

315
00:11:28,959 --> 00:11:30,399
vendors to

316
00:11:30,399 --> 00:11:32,240
do various reference implementations

317
00:11:32,240 --> 00:11:33,760
themselves

318
00:11:33,760 --> 00:11:36,000
and that's one reason why he made a very

319
00:11:36,000 --> 00:11:38,880
liberal fox license a bsd

320
00:11:38,880 --> 00:11:41,519
3 license

321
00:11:41,519 --> 00:11:42,560
and

322
00:11:42,560 --> 00:11:43,279
but

323
00:11:43,279 --> 00:11:45,279
those interfaces were even intended to

324
00:11:45,279 --> 00:11:46,160
span

325
00:11:46,160 --> 00:11:47,839
different programming languages and

326
00:11:47,839 --> 00:11:49,519
originally we had like

327
00:11:49,519 --> 00:11:52,079
there was one for you know php and cold

328
00:11:52,079 --> 00:11:55,360
fusion and javascript and dotnet and a

329
00:11:55,360 --> 00:11:58,000
bunch of other ones

330
00:11:58,000 --> 00:12:00,240
right so um

331
00:12:00,240 --> 00:12:01,920
but it's just it's hard to build an

332
00:12:01,920 --> 00:12:03,600
interface in the vacuum and it's even

333
00:12:03,600 --> 00:12:05,440
harder to know you did it right right so

334
00:12:05,440 --> 00:12:06,880
you have to have some kind of reference

335
00:12:06,880 --> 00:12:09,040
implementation to test yourself and like

336
00:12:09,040 --> 00:12:11,519
i said we made the mistake of basically

337
00:12:11,519 --> 00:12:14,240
releasing that with the rest of the

338
00:12:14,240 --> 00:12:16,000
interfaces

339
00:12:16,000 --> 00:12:17,760
um the other good thing though is it was

340
00:12:17,760 --> 00:12:20,160
property driven so you were like able to

341
00:12:20,160 --> 00:12:22,399
easily change your implementation if you

342
00:12:22,399 --> 00:12:23,839
wanted to do your own implementations

343
00:12:23,839 --> 00:12:26,880
they have an encrypter or an encoder you

344
00:12:26,880 --> 00:12:28,880
could just you know write your own stuff

345
00:12:28,880 --> 00:12:31,839
according to the interface and then put

346
00:12:31,839 --> 00:12:33,519
in your own implementation and in the

347
00:12:33,519 --> 00:12:35,920
properties file and it'll pick it up

348
00:12:35,920 --> 00:12:39,079
all right

349
00:12:43,120 --> 00:12:45,279
so the bad part um

350
00:12:45,279 --> 00:12:47,600
esappy was designed

351
00:12:47,600 --> 00:12:49,920
uh to include basically all the

352
00:12:49,920 --> 00:12:51,839
prevalent security controls that would

353
00:12:51,839 --> 00:12:53,760
address or help address

354
00:12:53,760 --> 00:12:55,040
at the time

355
00:12:55,040 --> 00:12:57,639
which probably was like

356
00:12:57,639 --> 00:13:01,839
2011 or something like i think uh

357
00:13:01,839 --> 00:13:04,399
the owasp top 10 stuff right so

358
00:13:04,399 --> 00:13:05,200
um

359
00:13:05,200 --> 00:13:06,399
what they did is they took all the

360
00:13:06,399 --> 00:13:08,079
security controls and put them into one

361
00:13:08,079 --> 00:13:09,200
library

362
00:13:09,200 --> 00:13:13,839
and in hindsight that was a bad idea um

363
00:13:14,320 --> 00:13:16,160
a monolithic

364
00:13:16,160 --> 00:13:17,680
library pulls in way too many

365
00:13:17,680 --> 00:13:19,360
dependencies right

366
00:13:19,360 --> 00:13:20,959
um

367
00:13:20,959 --> 00:13:22,560
and so like if you only wanted to use

368
00:13:22,560 --> 00:13:25,120
one thing like the encoder or the

369
00:13:25,120 --> 00:13:26,959
encrypter or whatever

370
00:13:26,959 --> 00:13:28,880
you pull in the transit of depend the

371
00:13:28,880 --> 00:13:30,320
dependencies direct dependencies and

372
00:13:30,320 --> 00:13:31,680
translate the dependencies for

373
00:13:31,680 --> 00:13:32,880
everything

374
00:13:32,880 --> 00:13:36,079
right um

375
00:13:36,079 --> 00:13:39,199
all those dependencies were constantly

376
00:13:39,199 --> 00:13:40,480
involved you know

377
00:13:40,480 --> 00:13:43,040
relating for us to basically have to you

378
00:13:43,040 --> 00:13:44,079
know

379
00:13:44,079 --> 00:13:46,880
uh you know one of the top

380
00:13:46,880 --> 00:13:50,560
uh that creeped into the top ten oaus

381
00:13:50,560 --> 00:13:52,800
top ten was uh using components with

382
00:13:52,800 --> 00:13:54,560
known vulnerabilities

383
00:13:54,560 --> 00:13:56,880
um that became a problem a constant

384
00:13:56,880 --> 00:13:58,480
problem and in fact that's what's been

385
00:13:58,480 --> 00:14:00,320
driving the last couple releases the

386
00:14:00,320 --> 00:14:02,399
point releases that we've been doing

387
00:14:02,399 --> 00:14:04,639
is just trying to keep up with that but

388
00:14:04,639 --> 00:14:06,240
the other thing is that the more

389
00:14:06,240 --> 00:14:08,000
dependencies you have eventually they

390
00:14:08,000 --> 00:14:10,079
stop supporting the version of java that

391
00:14:10,079 --> 00:14:12,079
you're using right so we keep on having

392
00:14:12,079 --> 00:14:14,320
to update we started out with java 5 and

393
00:14:14,320 --> 00:14:16,079
then went to java six then with the drop

394
00:14:16,079 --> 00:14:17,760
of seven and pretty soon we're gonna

395
00:14:17,760 --> 00:14:19,199
have to go with java eight because we

396
00:14:19,199 --> 00:14:20,800
have dependencies

397
00:14:20,800 --> 00:14:22,000
that

398
00:14:22,000 --> 00:14:24,320
you know are not getting patched then if

399
00:14:24,320 --> 00:14:26,639
they uh have environmentally then we're

400
00:14:26,639 --> 00:14:28,560
gonna have to go to java eight

401
00:14:28,560 --> 00:14:29,519
right

402
00:14:29,519 --> 00:14:31,040
um the other thing was we had an

403
00:14:31,040 --> 00:14:34,399
uncontrolled um bloat of just um you

404
00:14:34,399 --> 00:14:36,160
know some of the interfaces i mean it

405
00:14:36,160 --> 00:14:38,079
just became overwhelming they should

406
00:14:38,079 --> 00:14:40,959
have been split out and then um

407
00:14:40,959 --> 00:14:42,880
we had uncontrolled growth of esophage

408
00:14:42,880 --> 00:14:44,560
properties files

409
00:14:44,560 --> 00:14:47,040
one of the top things was every time

410
00:14:47,040 --> 00:14:49,519
every time we ended up um

411
00:14:49,519 --> 00:14:51,040
doing

412
00:14:51,040 --> 00:14:53,199
a property we had to add something to

413
00:14:53,199 --> 00:14:55,920
the security configuration interface and

414
00:14:55,920 --> 00:14:59,040
that became completely bloated right

415
00:14:59,040 --> 00:15:01,360
um oh the other thing singletons they

416
00:15:01,360 --> 00:15:03,760
were a bad idea right i mean

417
00:15:03,760 --> 00:15:05,600
i don't see there was really any purpose

418
00:15:05,600 --> 00:15:07,760
for using a singleton but we didn't

419
00:15:07,760 --> 00:15:10,160
really need them um and initially we

420
00:15:10,160 --> 00:15:12,639
botched them because they were using c

421
00:15:12,639 --> 00:15:14,480
plus pluses double locking pattern which

422
00:15:14,480 --> 00:15:15,920
is not valid for

423
00:15:15,920 --> 00:15:18,160
java so initially the singletons were

424
00:15:18,160 --> 00:15:19,680
not thread safe

425
00:15:19,680 --> 00:15:21,680
and then we also have uh at least three

426
00:15:21,680 --> 00:15:23,360
singletons and this is still current the

427
00:15:23,360 --> 00:15:25,360
case and can't change it because

428
00:15:25,360 --> 00:15:27,440
right but default encoder default

429
00:15:27,440 --> 00:15:29,199
security configuration and default

430
00:15:29,199 --> 00:15:32,079
validator all have public constructors

431
00:15:32,079 --> 00:15:33,279
so when you make signals and you're

432
00:15:33,279 --> 00:15:34,639
supposed to make the constructors

433
00:15:34,639 --> 00:15:35,680
private

434
00:15:35,680 --> 00:15:37,759
uh to force people to use the like the

435
00:15:37,759 --> 00:15:41,399
get instance method

436
00:15:49,120 --> 00:15:51,360
so

437
00:15:51,839 --> 00:15:55,600
the ugly part of this um

438
00:15:55,600 --> 00:15:56,959
there's a

439
00:15:56,959 --> 00:15:59,199
we have radical dependencies on the

440
00:15:59,199 --> 00:16:01,360
properties in logging and exception

441
00:16:01,360 --> 00:16:03,360
handling and all those things kind of

442
00:16:03,360 --> 00:16:05,360
like we're very tightly coupled with

443
00:16:05,360 --> 00:16:07,519
each other right so

444
00:16:07,519 --> 00:16:09,519
like for instance almost everything

445
00:16:09,519 --> 00:16:12,320
basically used our internal logger

446
00:16:12,320 --> 00:16:13,600
uh

447
00:16:13,600 --> 00:16:15,440
the security configuration was the only

448
00:16:15,440 --> 00:16:18,160
exception of that um it had special

449
00:16:18,160 --> 00:16:20,320
login because you hadn't yet figured out

450
00:16:20,320 --> 00:16:23,680
what logger you're supposed to use right

451
00:16:23,680 --> 00:16:26,240
um and then there was like enterprise

452
00:16:26,240 --> 00:16:28,160
security exception so we had this

453
00:16:28,160 --> 00:16:29,839
exception stack and one of the things

454
00:16:29,839 --> 00:16:31,759
that it did enterprise security

455
00:16:31,759 --> 00:16:34,480
exception like had like intrusion

456
00:16:34,480 --> 00:16:37,040
detection stuff in it so like it would

457
00:16:37,040 --> 00:16:39,440
automatically log stuff for you

458
00:16:39,440 --> 00:16:41,600
all right and then the logger basically

459
00:16:41,600 --> 00:16:44,320
had a dependency transitively to the

460
00:16:44,320 --> 00:16:45,279
user

461
00:16:45,279 --> 00:16:46,079
uh

462
00:16:46,079 --> 00:16:47,440
interface

463
00:16:47,440 --> 00:16:49,920
um so that which was used for the logger

464
00:16:49,920 --> 00:16:51,759
to log like an authenticated user

465
00:16:51,759 --> 00:16:54,000
otherwise it would like put anonymous

466
00:16:54,000 --> 00:16:56,320
down

467
00:16:56,880 --> 00:16:58,079
and then like

468
00:16:58,079 --> 00:16:59,839
and and and if you're

469
00:16:59,839 --> 00:17:01,120
kind of wondering what i'm talking about

470
00:17:01,120 --> 00:17:03,519
sometime when you have a chance run

471
00:17:03,519 --> 00:17:06,000
maven site and look at the j depends

472
00:17:06,000 --> 00:17:08,240
output sometime and you'll you'll see

473
00:17:08,240 --> 00:17:09,919
this

474
00:17:09,919 --> 00:17:11,599
problem the first bulls that i mentioned

475
00:17:11,599 --> 00:17:13,599
here

476
00:17:13,599 --> 00:17:15,199
the second one is basically the

477
00:17:15,199 --> 00:17:17,679
implementation class default security

478
00:17:17,679 --> 00:17:19,919
configuration it's just a sin against

479
00:17:19,919 --> 00:17:21,760
mankind i don't know how any other way

480
00:17:21,760 --> 00:17:23,280
to say it i mean it is

481
00:17:23,280 --> 00:17:25,760
the poster child for the phrase backward

482
00:17:25,760 --> 00:17:27,599
compatibility is the curse of software

483
00:17:27,599 --> 00:17:30,720
design right it started out that they

484
00:17:30,720 --> 00:17:33,760
like said okay you know use like uh e4

485
00:17:33,760 --> 00:17:34,720
uh

486
00:17:34,720 --> 00:17:35,520
and

487
00:17:35,520 --> 00:17:37,440
look for your default

488
00:17:37,440 --> 00:17:39,280
or you look for the esappy.properties

489
00:17:39,280 --> 00:17:41,840
file in like java.home system property

490
00:17:41,840 --> 00:17:43,520
right and then they kept on like saying

491
00:17:43,520 --> 00:17:44,960
oh we wouldn't find it here and a class

492
00:17:44,960 --> 00:17:46,559
past we would find it as a resource or

493
00:17:46,559 --> 00:17:48,480
whatever and so there's like about five

494
00:17:48,480 --> 00:17:49,760
different steps

495
00:17:49,760 --> 00:17:50,880
and

496
00:17:50,880 --> 00:17:52,799
it's just very complicated how to

497
00:17:52,799 --> 00:17:54,480
explain how to do that i mean we do have

498
00:17:54,480 --> 00:17:56,160
it documented in that particular

499
00:17:56,160 --> 00:17:58,240
implementation class

500
00:17:58,240 --> 00:18:01,679
but it's like by far probably close you

501
00:18:01,679 --> 00:18:03,120
know i would say very close to the

502
00:18:03,120 --> 00:18:05,440
number one question that we get asked

503
00:18:05,440 --> 00:18:08,160
about um on uh

504
00:18:08,160 --> 00:18:11,120
about esappy and like say stack overflow

505
00:18:11,120 --> 00:18:12,799
right it's almost always like i can't

506
00:18:12,799 --> 00:18:15,039
find the e my my stuff isn't finding the

507
00:18:15,039 --> 00:18:17,360
e7 properties please help right we've

508
00:18:17,360 --> 00:18:20,160
inserted it like uh dozens of times

509
00:18:20,160 --> 00:18:22,160
but um

510
00:18:22,160 --> 00:18:24,080
it's just you know it's just way too

511
00:18:24,080 --> 00:18:26,639
difficult

512
00:18:26,840 --> 00:18:30,080
um also there's too many

513
00:18:30,080 --> 00:18:32,240
major ill-time changes made at once

514
00:18:32,240 --> 00:18:34,240
right we went from

515
00:18:34,240 --> 00:18:37,039
uh google code and subversion to github

516
00:18:37,039 --> 00:18:39,120
and get now the google code thing we

517
00:18:39,120 --> 00:18:41,360
were kind of forced because they were

518
00:18:41,360 --> 00:18:43,200
google was shutting it down

519
00:18:43,200 --> 00:18:44,559
and i didn't really have a problem going

520
00:18:44,559 --> 00:18:46,160
from google code to

521
00:18:46,160 --> 00:18:49,039
github that wasn't a big deal for me but

522
00:18:49,039 --> 00:18:51,760
subversion which i had used

523
00:18:51,760 --> 00:18:54,559
and going to get which i had never used

524
00:18:54,559 --> 00:18:56,320
and and they're kind of radically

525
00:18:56,320 --> 00:18:59,200
different um was a big deal for me

526
00:18:59,200 --> 00:19:02,240
especially since i do like unlike most

527
00:19:02,240 --> 00:19:05,919
people like i said i'm a dinosaur and um

528
00:19:05,919 --> 00:19:07,840
you know i do everything pretty much

529
00:19:07,840 --> 00:19:09,840
like from the shell command line like

530
00:19:09,840 --> 00:19:11,840
bash or corn shell

531
00:19:11,840 --> 00:19:14,080
and then the other thing was uh changing

532
00:19:14,080 --> 00:19:16,480
from ant to maven that was even worse

533
00:19:16,480 --> 00:19:17,919
for me because

534
00:19:17,919 --> 00:19:19,919
like with and at least you could see you

535
00:19:19,919 --> 00:19:21,360
know all the actions of what it was

536
00:19:21,360 --> 00:19:23,520
doing right there in

537
00:19:23,520 --> 00:19:25,440
you know

538
00:19:25,440 --> 00:19:27,679
the xml script

539
00:19:27,679 --> 00:19:28,480
but

540
00:19:28,480 --> 00:19:31,200
with maven it's like all the magic is

541
00:19:31,200 --> 00:19:33,280
done and whatever particular maven

542
00:19:33,280 --> 00:19:35,600
plugins you have and there are seemingly

543
00:19:35,600 --> 00:19:36,960
hundreds of them

544
00:19:36,960 --> 00:19:39,039
and i mean in my opinion right maven is

545
00:19:39,039 --> 00:19:41,919
not your friend i mean it's like

546
00:19:41,919 --> 00:19:44,080
and you know i tried like to get help

547
00:19:44,080 --> 00:19:46,400
from the owass mailing list and all i

548
00:19:46,400 --> 00:19:48,160
got kind of were dumb looks or no

549
00:19:48,160 --> 00:19:50,400
responses or whatever

550
00:19:50,400 --> 00:19:51,600
um

551
00:19:51,600 --> 00:19:53,520
so that just you know

552
00:19:53,520 --> 00:19:55,200
it didn't work out i mean it was like it

553
00:19:55,200 --> 00:19:57,360
took me that was the biggest reason why

554
00:19:57,360 --> 00:19:58,640
we didn't have

555
00:19:58,640 --> 00:20:00,640
um a

556
00:20:00,640 --> 00:20:02,559
release for like a gap of almost two

557
00:20:02,559 --> 00:20:03,840
years because i was trying to figure out

558
00:20:03,840 --> 00:20:05,440
how to do the deployment the stuff that

559
00:20:05,440 --> 00:20:06,720
was in

560
00:20:06,720 --> 00:20:08,559
the

561
00:20:08,559 --> 00:20:11,440
palm.xml file just was not working

562
00:20:11,440 --> 00:20:12,240
right

563
00:20:12,240 --> 00:20:14,400
and then the last thing we trusted

564
00:20:14,400 --> 00:20:18,720
uh nsa for a code review now

565
00:20:18,720 --> 00:20:21,760
that's part of my fault because i

566
00:20:21,760 --> 00:20:23,440
wrote the crypto code and there wasn't

567
00:20:23,440 --> 00:20:25,200
really anybody else that understood it

568
00:20:25,200 --> 00:20:27,039
and i could tell that because it was

569
00:20:27,039 --> 00:20:28,640
just totally botched

570
00:20:28,640 --> 00:20:32,000
in the 1.4 release so i said i need some

571
00:20:32,000 --> 00:20:33,840
second pair eyes on it this is like

572
00:20:33,840 --> 00:20:36,640
tricky stuff to get right

573
00:20:36,640 --> 00:20:40,000
um i advertised on a crypto mailing list

574
00:20:40,000 --> 00:20:41,919
for people to help and

575
00:20:41,919 --> 00:20:43,440
um

576
00:20:43,440 --> 00:20:44,799
one person

577
00:20:44,799 --> 00:20:46,159
only got one

578
00:20:46,159 --> 00:20:48,480
inquiry and that person said

579
00:20:48,480 --> 00:20:50,080
yeah i'll do it for thirty thousand

580
00:20:50,080 --> 00:20:51,440
dollars and that didn't seem right

581
00:20:51,440 --> 00:20:53,120
because like the crypto code was only

582
00:20:53,120 --> 00:20:53,919
about

583
00:20:53,919 --> 00:20:55,840
like eight thousand lines of code if you

584
00:20:55,840 --> 00:20:58,240
include you know comments and stuff

585
00:20:58,240 --> 00:20:59,919
that just didn't seem like a very good

586
00:20:59,919 --> 00:21:00,960
deal

587
00:21:00,960 --> 00:21:04,080
for uh you know a non-profit

588
00:21:04,080 --> 00:21:06,480
um right but to our credit you know i

589
00:21:06,480 --> 00:21:08,960
mean this was pre snowden

590
00:21:08,960 --> 00:21:11,200
um but the one thing is it kind of makes

591
00:21:11,200 --> 00:21:13,760
me suspicious that we had a cve

592
00:21:13,760 --> 00:21:17,039
specifically cbe dash 213

593
00:21:17,039 --> 00:21:20,039
2013-5679

594
00:21:20,640 --> 00:21:23,760
which was there because of a 1.4

595
00:21:23,760 --> 00:21:26,080
backward compatibility interface

596
00:21:26,080 --> 00:21:28,640
and it really it was just it basically

597
00:21:28,640 --> 00:21:31,120
allowed you to bypass the

598
00:21:31,120 --> 00:21:33,039
message authentication code

599
00:21:33,039 --> 00:21:35,679
on on the crypto cipher text

600
00:21:35,679 --> 00:21:36,559
stuff

601
00:21:36,559 --> 00:21:37,600
um

602
00:21:37,600 --> 00:21:40,720
in in a very trivial fashion and i just

603
00:21:40,720 --> 00:21:42,320
really can't believe it's hard for me to

604
00:21:42,320 --> 00:21:44,000
believe i mean i suppose you could say

605
00:21:44,000 --> 00:21:47,679
plausible deniability but if the nsa

606
00:21:47,679 --> 00:21:49,760
crypto experts couldn't find that then

607
00:21:49,760 --> 00:21:52,080
we're all doomed right so

608
00:21:52,080 --> 00:21:54,000
um either they found it they didn't say

609
00:21:54,000 --> 00:21:56,080
anything or whatever now they did say

610
00:21:56,080 --> 00:21:58,240
other things they found a couple things

611
00:21:58,240 --> 00:21:59,919
where we didn't do cross-site scripting

612
00:21:59,919 --> 00:22:02,000
things and and some validation stuff

613
00:22:02,000 --> 00:22:04,480
right but

614
00:22:04,799 --> 00:22:06,640
but for the most part i was just very

615
00:22:06,640 --> 00:22:08,880
disappointed in that particular result

616
00:22:08,880 --> 00:22:11,880
so

617
00:22:12,640 --> 00:22:14,960
so

618
00:22:15,600 --> 00:22:18,240
the conclusion is that basically

619
00:22:18,240 --> 00:22:20,000
monolithic libraries are a thing of the

620
00:22:20,000 --> 00:22:21,440
past you can't

621
00:22:21,440 --> 00:22:23,919
they just make the library too brittle

622
00:22:23,919 --> 00:22:24,960
um

623
00:22:24,960 --> 00:22:26,880
it you know i think the people who've

624
00:22:26,880 --> 00:22:29,440
discovered microservices architecture

625
00:22:29,440 --> 00:22:31,760
have realized this for a while

626
00:22:31,760 --> 00:22:34,080
and i mean i'm not saying that we can do

627
00:22:34,080 --> 00:22:36,159
microservice architecture because things

628
00:22:36,159 --> 00:22:37,440
like authenticate if you really want to

629
00:22:37,440 --> 00:22:40,000
do authentication or

630
00:22:40,000 --> 00:22:42,159
or uh you know access control and stuff

631
00:22:42,159 --> 00:22:45,120
like that in a microservice

632
00:22:45,120 --> 00:22:47,280
you're probably gonna get really bad

633
00:22:47,280 --> 00:22:48,930
performance but um

634
00:22:48,930 --> 00:22:50,400
[Music]

635
00:22:50,400 --> 00:22:52,799
nevertheless you know um it's it's

636
00:22:52,799 --> 00:22:54,240
something that we need to address and

637
00:22:54,240 --> 00:22:56,000
we're planning on addressing that in

638
00:22:56,000 --> 00:22:58,400
he's happy three

639
00:22:58,400 --> 00:23:00,000
um which

640
00:23:00,000 --> 00:23:02,240
uh

641
00:23:02,480 --> 00:23:05,919
we're the the three people myself uh

642
00:23:05,919 --> 00:23:08,640
matt saw and jeremiah stacy

643
00:23:08,640 --> 00:23:11,440
are calling it three sappy uh

644
00:23:11,440 --> 00:23:14,080
shout out to jeremiah for that moniker

645
00:23:14,080 --> 00:23:16,640
um but when we do that we are gonna do

646
00:23:16,640 --> 00:23:17,840
it radically different there's going to

647
00:23:17,840 --> 00:23:19,440
be an e-sappy core that's gonna

648
00:23:19,440 --> 00:23:21,520
represent the interfaces and some common

649
00:23:21,520 --> 00:23:22,400
essential

650
00:23:22,400 --> 00:23:23,919
internal components that everything is

651
00:23:23,919 --> 00:23:25,760
going to depend on and those will be

652
00:23:25,760 --> 00:23:27,840
restricted from visibility using java

653
00:23:27,840 --> 00:23:29,440
modules

654
00:23:29,440 --> 00:23:31,200
and then we will separate implementation

655
00:23:31,200 --> 00:23:34,159
jars out for each major component so

656
00:23:34,159 --> 00:23:37,840
that's how we're planning on doing that

657
00:23:40,000 --> 00:23:41,360
all right so

658
00:23:41,360 --> 00:23:42,799
i guess now it's time for where you get

659
00:23:42,799 --> 00:23:44,799
to ask me questions and i get to pretend

660
00:23:44,799 --> 00:23:48,159
that i know what i'm talking about so

661
00:23:48,159 --> 00:23:51,120
that's it

