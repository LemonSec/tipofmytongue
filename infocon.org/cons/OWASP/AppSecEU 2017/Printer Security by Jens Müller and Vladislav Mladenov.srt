1
00:00:02,510 --> 00:00:08,750
so can you<font color="#E5E5E5"> remove hello everyone my name</font>

2
00:00:05,930 --> 00:00:10,580
is<font color="#CCCCCC"> Jen's</font><font color="#E5E5E5"> Miller a reason given my</font><font color="#CCCCCC"> a tttt</font>

3
00:00:08,750 --> 00:00:13,549
master's degree at<font color="#CCCCCC"> the University of</font>

4
00:00:10,580 --> 00:00:15,559
Warsaw<font color="#CCCCCC"> and</font><font color="#E5E5E5"> now I'm a protective PhD</font>

5
00:00:13,549 --> 00:00:18,099
student at<font color="#E5E5E5"> the Jaipur Network and data</font>

6
00:00:15,559 --> 00:00:20,869
<font color="#CCCCCC">security at the University of Mohan</font>

7
00:00:18,099 --> 00:00:24,230
today I will give you an introduction<font color="#E5E5E5"> on</font>

8
00:00:20,869 --> 00:00:27,890
our current<font color="#CCCCCC"> research and work on printer</font>

9
00:00:24,230 --> 00:00:30,890
security well you may ask why<font color="#E5E5E5"> would</font>

10
00:00:27,890 --> 00:00:34,310
<font color="#E5E5E5">anybody want to attack printers why does</font>

11
00:00:30,890 --> 00:00:36,469
<font color="#E5E5E5">it matter to you well printers are just</font>

12
00:00:34,310 --> 00:00:39,890
simply everywhere<font color="#CCCCCC"> they</font><font color="#E5E5E5"> are contained in</font>

13
00:00:36,469 --> 00:00:43,699
<font color="#CCCCCC">every household in every company</font><font color="#E5E5E5"> in</font>

14
00:00:39,890 --> 00:00:46,219
<font color="#E5E5E5">every educational institution</font><font color="#CCCCCC"> and let's</font>

15
00:00:43,699 --> 00:00:48,800
<font color="#CCCCCC">x2 quite</font><font color="#E5E5E5"> sensitive information like</font>

16
00:00:46,219 --> 00:00:51,829
business contracts in printed like

17
00:00:48,800 --> 00:00:55,160
patient recipes for example like yet

18
00:00:51,829 --> 00:00:57,859
unpublished research<font color="#E5E5E5"> and today I'm going</font>

19
00:00:55,160 --> 00:01:00,669
to show<font color="#E5E5E5"> you how incredibly</font><font color="#CCCCCC"> easy it is to</font>

20
00:00:57,859 --> 00:01:02,780
access this data based on

21
00:01:00,670 --> 00:01:05,980
<font color="#CCCCCC">thirty-five-year-old</font><font color="#E5E5E5"> vulnerabilities</font>

22
00:01:02,780 --> 00:01:09,140
<font color="#E5E5E5">present in almost any laser printer</font>

23
00:01:05,980 --> 00:01:13,460
apart from attacking<font color="#E5E5E5"> the printer</font>

24
00:01:09,140 --> 00:01:16,550
directly to get confidential data taking

25
00:01:13,460 --> 00:01:18,679
over the printer to escalate into a

26
00:01:16,550 --> 00:01:21,500
company's network using the<font color="#E5E5E5"> printer as a</font>

27
00:01:18,680 --> 00:01:23,840
starting point<font color="#E5E5E5"> may also be a relevant</font>

28
00:01:21,500 --> 00:01:26,500
<font color="#E5E5E5">scenario so the printer may be the</font>

29
00:01:23,840 --> 00:01:29,870
weakest<font color="#CCCCCC"> link in your</font><font color="#E5E5E5"> IT security chain</font>

30
00:01:26,500 --> 00:01:33,520
so definitely lots of<font color="#E5E5E5"> motivation</font><font color="#CCCCCC"> to have</font>

31
00:01:29,870 --> 00:01:33,520
a deeper look at those devices

32
00:01:33,790 --> 00:01:40,520
<font color="#CCCCCC">undoubtely printers have evolved</font><font color="#E5E5E5"> 30</font>

33
00:01:37,310 --> 00:01:44,450
years ago<font color="#CCCCCC"> with simple mechanical devices</font>

34
00:01:40,520 --> 00:01:47,690
<font color="#E5E5E5">that</font><font color="#CCCCCC"> did nothing but print</font><font color="#E5E5E5"> or produce a</font>

35
00:01:44,450 --> 00:01:50,480
<font color="#E5E5E5">paper jam from time to time well</font>

36
00:01:47,690 --> 00:01:52,789
nowadays<font color="#E5E5E5"> um</font><font color="#CCCCCC"> you cannot buy a printer</font>

37
00:01:50,480 --> 00:01:56,960
<font color="#CCCCCC">without actually buying a full-blown</font>

38
00:01:52,790 --> 00:02:01,040
computer system with advanced operating

39
00:01:56,960 --> 00:02:02,869
system<font color="#E5E5E5"> who tcp/ip stack</font><font color="#CCCCCC"> additional</font>

40
00:02:01,040 --> 00:02:05,570
functionality such as faxing scanning

41
00:02:02,870 --> 00:02:08,060
<font color="#CCCCCC">often included and you can even store</font>

42
00:02:05,570 --> 00:02:10,160
the printer<font color="#E5E5E5"> apps so I've got a package</font>

43
00:02:08,060 --> 00:02:13,760
management on morning many modern

44
00:02:10,160 --> 00:02:15,769
devices<font color="#CCCCCC"> the only thing that didn't</font>

45
00:02:13,760 --> 00:02:16,370
<font color="#E5E5E5">change maybe is</font><font color="#CCCCCC"> that always when</font><font color="#E5E5E5"> you're</font>

46
00:02:15,769 --> 00:02:18,049
in a<font color="#E5E5E5"> hurry</font>

47
00:02:16,370 --> 00:02:19,879
<font color="#E5E5E5">and you want to print</font><font color="#CCCCCC"> something the</font>

48
00:02:18,049 --> 00:02:26,299
printer<font color="#E5E5E5"> will definitely produce a</font>

49
00:02:19,879 --> 00:02:29,090
printer<font color="#E5E5E5"> a paper jam so what does make</font>

50
00:02:26,299 --> 00:02:31,610
printers special<font color="#E5E5E5"> all our devices are</font>

51
00:02:29,090 --> 00:02:35,090
<font color="#E5E5E5">getting smarter</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> smarter</font><font color="#CCCCCC"> or maybe not</font>

52
00:02:31,610 --> 00:02:38,769
<font color="#E5E5E5">so</font><font color="#CCCCCC"> smart</font><font color="#E5E5E5"> so what is the special about</font>

53
00:02:35,090 --> 00:02:40,989
printers beyond all the traditional

54
00:02:38,769 --> 00:02:44,690
security problems that we have with

55
00:02:40,989 --> 00:02:48,079
embedded devices<font color="#E5E5E5"> in the printing world</font>

56
00:02:44,690 --> 00:02:51,040
<font color="#CCCCCC">we have</font><font color="#E5E5E5"> got some design weakness by</font>

57
00:02:48,079 --> 00:02:54,049
default that<font color="#E5E5E5"> is some extra</font><font color="#CCCCCC"> interesting</font>

58
00:02:51,040 --> 00:02:57,739
you can for<font color="#CCCCCC"> example access</font><font color="#E5E5E5"> the printers</font>

59
00:02:54,049 --> 00:02:59,690
<font color="#E5E5E5">file system to ordinary print shops you</font>

60
00:02:57,739 --> 00:03:02,659
can<font color="#CCCCCC"> access to printers memory through</font>

61
00:02:59,690 --> 00:03:05,120
ordinary print jobs even firmware

62
00:03:02,659 --> 00:03:08,679
updates are deployed as ordinary print

63
00:03:05,120 --> 00:03:11,989
<font color="#CCCCCC">jobs so as you can</font><font color="#E5E5E5"> see</font><font color="#CCCCCC"> there is no</font>

64
00:03:08,680 --> 00:03:14,950
distinction<font color="#E5E5E5"> between documents in</font>

65
00:03:11,989 --> 00:03:17,629
<font color="#E5E5E5">printers and administrative</font>

66
00:03:14,950 --> 00:03:20,869
functionality to actually control<font color="#CCCCCC"> the</font>

67
00:03:17,629 --> 00:03:23,328
device basically<font color="#CCCCCC"> you</font><font color="#E5E5E5"> got data and code</font>

68
00:03:20,870 --> 00:03:25,250
<font color="#E5E5E5">over the same</font><font color="#CCCCCC"> channel</font><font color="#E5E5E5"> and we always know</font>

69
00:03:23,329 --> 00:03:28,190
<font color="#CCCCCC">that this</font><font color="#E5E5E5"> is a bad idea</font>

70
00:03:25,250 --> 00:03:33,290
<font color="#CCCCCC">and such a security weakness by design</font>

71
00:03:28,190 --> 00:03:36,470
is shared by all<font color="#E5E5E5"> laser printers</font><font color="#CCCCCC"> ok</font><font color="#E5E5E5"> what</font>

72
00:03:33,290 --> 00:03:39,470
our main contributions are we performed

73
00:03:36,470 --> 00:03:42,169
systematization<font color="#CCCCCC"> of</font><font color="#E5E5E5"> attacks against</font>

74
00:03:39,470 --> 00:03:45,260
<font color="#CCCCCC">network</font><font color="#E5E5E5"> printers some of them are novel</font>

75
00:03:42,169 --> 00:03:48,560
some of them are well known and we<font color="#E5E5E5"> are</font>

76
00:03:45,260 --> 00:03:51,470
related the attacks on<font color="#E5E5E5"> 20 printer models</font>

77
00:03:48,560 --> 00:03:53,510
of<font color="#E5E5E5"> different manufacturers using</font><font color="#CCCCCC"> a</font>

78
00:03:51,470 --> 00:03:57,379
<font color="#CCCCCC">Python tool rewrote</font><font color="#E5E5E5"> the print</font>

79
00:03:53,510 --> 00:03:59,269
exploitation to a<font color="#E5E5E5"> kid called bread also</font>

80
00:03:57,379 --> 00:04:01,940
<font color="#CCCCCC">I'm going</font><font color="#E5E5E5"> to show you some novel attacks</font>

81
00:03:59,269 --> 00:04:05,599
<font color="#E5E5E5">beyond printers and send you research</font>

82
00:04:01,940 --> 00:04:08,209
directions<font color="#CCCCCC"> okay here's an outline of</font>

83
00:04:05,599 --> 00:04:10,339
today's talk<font color="#E5E5E5"> first</font><font color="#CCCCCC"> I need to give you a</font>

84
00:04:08,209 --> 00:04:14,480
little<font color="#E5E5E5"> bit of background information on</font>

85
00:04:10,340 --> 00:04:18,709
printing technologies so it is easier to

86
00:04:14,480 --> 00:04:20,719
<font color="#E5E5E5">follow the</font><font color="#CCCCCC"> the attacks actually then I'm</font>

87
00:04:18,709 --> 00:04:23,870
going<font color="#E5E5E5"> to give an</font><font color="#CCCCCC"> evaluation</font><font color="#E5E5E5"> a short</font>

88
00:04:20,720 --> 00:04:27,440
introduction<font color="#E5E5E5"> to</font><font color="#CCCCCC"> our bread</font><font color="#E5E5E5"> tool and I'm</font>

89
00:04:23,870 --> 00:04:29,360
trying<font color="#E5E5E5"> to adapt the attacks to areas</font>

90
00:04:27,440 --> 00:04:29,690
beyond printing like<font color="#CCCCCC"> to</font><font color="#E5E5E5"> websites for</font>

91
00:04:29,360 --> 00:04:32,480
exam

92
00:04:29,690 --> 00:04:34,310
the web conference<font color="#CCCCCC"> right and I'm going</font>

93
00:04:32,480 --> 00:04:37,880
<font color="#CCCCCC">to</font><font color="#E5E5E5"> show</font><font color="#CCCCCC"> you some countermeasures so you</font>

94
00:04:34,310 --> 00:04:40,030
can protect your<font color="#E5E5E5"> devices</font><font color="#CCCCCC"> okay let's</font>

95
00:04:37,880 --> 00:04:43,240
start with<font color="#E5E5E5"> some background information</font>

96
00:04:40,030 --> 00:04:47,210
but what does it<font color="#CCCCCC"> actually</font><font color="#E5E5E5"> mean</font><font color="#CCCCCC"> to print</font>

97
00:04:43,240 --> 00:04:49,790
<font color="#E5E5E5">it means basically two things first you</font>

98
00:04:47,210 --> 00:04:52,820
need<font color="#CCCCCC"> to</font><font color="#E5E5E5"> decide which</font><font color="#CCCCCC"> channel you use for</font>

99
00:04:49,790 --> 00:04:54,620
printing<font color="#E5E5E5"> obviously like USB cable like</font>

100
00:04:52,820 --> 00:04:57,380
one of various<font color="#CCCCCC"> network printing</font>

101
00:04:54,620 --> 00:04:59,570
protocols<font color="#CCCCCC"> the second thing is you need</font>

102
00:04:57,380 --> 00:05:02,240
<font color="#CCCCCC">to select a printer language so a</font>

103
00:04:59,570 --> 00:05:03,110
language that<font color="#E5E5E5"> is directly understood by</font>

104
00:05:02,240 --> 00:05:05,720
the printer

105
00:05:03,110 --> 00:05:08,390
for example PostScript<font color="#CCCCCC"> and what your</font>

106
00:05:05,720 --> 00:05:10,540
printer driver<font color="#CCCCCC"> actually does it is it</font>

107
00:05:08,390 --> 00:05:13,130
translates<font color="#CCCCCC"> the document to be printed</font>

108
00:05:10,540 --> 00:05:16,190
<font color="#CCCCCC">into the language</font><font color="#E5E5E5"> that is directly</font>

109
00:05:13,130 --> 00:05:17,510
understood by the printer<font color="#CCCCCC"> mpgl and</font>

110
00:05:16,190 --> 00:05:20,120
<font color="#E5E5E5">postscript are pretty interesting</font>

111
00:05:17,510 --> 00:05:22,310
because<font color="#E5E5E5"> both languages are supported by</font>

112
00:05:20,120 --> 00:05:25,670
almost<font color="#E5E5E5"> any laser printer device out</font>

113
00:05:22,310 --> 00:05:28,730
<font color="#CCCCCC">there okay what can</font><font color="#E5E5E5"> be attack in the</font>

114
00:05:25,670 --> 00:05:31,280
printer context<font color="#E5E5E5"> well we got some kind of</font>

115
00:05:28,730 --> 00:05:34,100
<font color="#E5E5E5">mechanical printer unit we don't really</font>

116
00:05:31,280 --> 00:05:35,049
<font color="#E5E5E5">care</font><font color="#CCCCCC"> about</font><font color="#E5E5E5"> that one we've got</font><font color="#CCCCCC"> an PDL</font>

117
00:05:34,100 --> 00:05:37,310
interpreter

118
00:05:35,050 --> 00:05:39,860
we've got<font color="#CCCCCC"> usually a PostScript</font>

119
00:05:37,310 --> 00:05:42,320
interpreter<font color="#E5E5E5"> and we may have further</font>

120
00:05:39,860 --> 00:05:46,880
interpreters for printer languages like

121
00:05:42,320 --> 00:05:49,400
PCL like the direct PDF printing or some

122
00:05:46,880 --> 00:05:52,669
proprietary<font color="#E5E5E5"> languages supported by some</font>

123
00:05:49,400 --> 00:05:56,210
<font color="#CCCCCC">vendors and when you print a protocol</font><font color="#E5E5E5"> a</font>

124
00:05:52,669 --> 00:05:58,669
document using for example<font color="#E5E5E5"> USB cable</font>

125
00:05:56,210 --> 00:06:01,299
what you can do<font color="#E5E5E5"> is you can for example</font>

126
00:05:58,669 --> 00:06:04,370
send<font color="#CCCCCC"> PostScript data to the USB port</font>

127
00:06:01,300 --> 00:06:06,830
<font color="#E5E5E5">which</font><font color="#CCCCCC"> is interpreted by</font><font color="#E5E5E5"> the PostScript</font>

128
00:06:04,370 --> 00:06:09,740
interpreter<font color="#E5E5E5"> and finally put to paper by</font>

129
00:06:06,830 --> 00:06:11,990
<font color="#E5E5E5">the printing unit but you can also use</font>

130
00:06:09,740 --> 00:06:14,090
one of various other printing channels

131
00:06:11,990 --> 00:06:17,780
for<font color="#E5E5E5"> example one of various</font><font color="#CCCCCC"> Network</font>

132
00:06:14,090 --> 00:06:21,799
protocols like raw<font color="#E5E5E5"> network printing our</font>

133
00:06:17,780 --> 00:06:24,140
port<font color="#CCCCCC"> 9100 tcp</font><font color="#E5E5E5"> the interesting thing here</font>

134
00:06:21,800 --> 00:06:26,110
<font color="#CCCCCC">is that</font><font color="#E5E5E5"> just like USB you get a be</font>

135
00:06:24,140 --> 00:06:28,370
directional channel with<font color="#E5E5E5"> the device</font>

136
00:06:26,110 --> 00:06:30,380
which is<font color="#CCCCCC"> interesting for information</font>

137
00:06:28,370 --> 00:06:32,690
disclosure attacks<font color="#E5E5E5"> but the device</font>

138
00:06:30,380 --> 00:06:33,409
usually<font color="#E5E5E5"> supports many other printing</font>

139
00:06:32,690 --> 00:06:36,080
protocols

140
00:06:33,410 --> 00:06:38,960
directly<font color="#E5E5E5"> like the one known internet</font>

141
00:06:36,080 --> 00:06:40,940
printing protocol<font color="#E5E5E5"> on line printer daemon</font>

142
00:06:38,960 --> 00:06:43,469
which is an old<font color="#E5E5E5"> protocol known from the</font>

143
00:06:40,940 --> 00:06:45,690
UNIX<font color="#CCCCCC"> world</font><font color="#E5E5E5"> and some newer printer</font>

144
00:06:43,470 --> 00:06:48,960
even speak server message block<font color="#E5E5E5"> directly</font>

145
00:06:45,690 --> 00:06:51,210
which<font color="#CCCCCC"> is known as printer shares in the</font>

146
00:06:48,960 --> 00:06:52,979
windows<font color="#CCCCCC"> world</font><font color="#E5E5E5"> well anyways the important</font>

147
00:06:51,210 --> 00:06:55,049
takeaway here is that<font color="#E5E5E5"> forget about the</font>

148
00:06:52,980 --> 00:06:58,350
channels<font color="#E5E5E5"> we are attacking actually the</font>

149
00:06:55,050 --> 00:07:01,020
language<font color="#E5E5E5"> interpreters</font><font color="#CCCCCC"> especially pgl and</font>

150
00:06:58,350 --> 00:07:03,900
<font color="#CCCCCC">PostScript interpreters so the attacks</font>

151
00:07:01,020 --> 00:07:07,080
are independent<font color="#E5E5E5"> of</font><font color="#CCCCCC"> the printing Channel</font>

152
00:07:03,900 --> 00:07:09,419
in other words anybody<font color="#E5E5E5"> who has the</font>

153
00:07:07,080 --> 00:07:11,460
<font color="#CCCCCC">ability to somehow print</font><font color="#E5E5E5"> can also be</font>

154
00:07:09,420 --> 00:07:14,540
cloud printing or whatever<font color="#E5E5E5"> can perform</font>

155
00:07:11,460 --> 00:07:17,549
the attack<font color="#CCCCCC"> okay that's the takeaway here</font>

156
00:07:14,540 --> 00:07:20,190
well now let me<font color="#E5E5E5"> give you some basic</font>

157
00:07:17,550 --> 00:07:23,700
introduction to about printer languages

158
00:07:20,190 --> 00:07:26,700
<font color="#CCCCCC">pgl and health script pgl d printer job</font>

159
00:07:23,700 --> 00:07:30,000
language was<font color="#E5E5E5"> developed by HP in</font><font color="#CCCCCC"> the</font>

160
00:07:26,700 --> 00:07:33,420
early 90s<font color="#E5E5E5"> and it is now some kind of</font>

161
00:07:30,000 --> 00:07:36,840
<font color="#CCCCCC">defect to language to control print</font>

162
00:07:33,420 --> 00:07:39,300
shops<font color="#E5E5E5"> what can you do with PDL for</font>

163
00:07:36,840 --> 00:07:41,700
example you can manage settings<font color="#E5E5E5"> like</font>

164
00:07:39,300 --> 00:07:44,190
studying the paper size to<font color="#CCCCCC"> a4 and</font>

165
00:07:41,700 --> 00:07:47,900
setting the number<font color="#E5E5E5"> of copies before</font>

166
00:07:44,190 --> 00:07:50,910
<font color="#E5E5E5">switching the interpreter to the actual</font>

167
00:07:47,900 --> 00:07:52,500
document interpretation language that is

168
00:07:50,910 --> 00:07:56,160
going to follow like for example

169
00:07:52,500 --> 00:08:00,360
<font color="#E5E5E5">PostScript the interesting</font><font color="#CCCCCC"> thing</font><font color="#E5E5E5"> here</font><font color="#CCCCCC"> is</font>

170
00:07:56,160 --> 00:08:01,980
that<font color="#CCCCCC"> pgl does not</font><font color="#E5E5E5"> only allow you to make</font>

171
00:08:00,360 --> 00:08:04,430
<font color="#CCCCCC">settings for</font><font color="#E5E5E5"> the current print shop but</font>

172
00:08:01,980 --> 00:08:07,440
also<font color="#CCCCCC"> for further print shops who can</font>

173
00:08:04,430 --> 00:08:08,820
influence rural print shops<font color="#E5E5E5"> and the</font>

174
00:08:07,440 --> 00:08:10,890
language has some other interesting

175
00:08:08,820 --> 00:08:13,320
features for<font color="#E5E5E5"> example the</font><font color="#CCCCCC"> standard allows</font>

176
00:08:10,890 --> 00:08:16,770
you to access<font color="#E5E5E5"> the printers file system</font>

177
00:08:13,320 --> 00:08:19,290
to an ordinary printer<font color="#E5E5E5"> okay our next</font>

178
00:08:16,770 --> 00:08:20,820
language<font color="#E5E5E5"> is imported well what is</font>

179
00:08:19,290 --> 00:08:24,810
PostScript it was the very<font color="#E5E5E5"> first</font>

180
00:08:20,820 --> 00:08:27,150
<font color="#CCCCCC">products of</font><font color="#E5E5E5"> Adobe some of us may</font>

181
00:08:24,810 --> 00:08:30,260
remember it as a<font color="#E5E5E5"> format for document</font>

182
00:08:27,150 --> 00:08:34,559
exchange<font color="#CCCCCC"> however it's</font><font color="#E5E5E5"> been largely</font>

183
00:08:30,260 --> 00:08:36,929
obsoleted by PDF nowadays but actually

184
00:08:34,559 --> 00:08:41,039
PostScript was<font color="#E5E5E5"> designed foreign is still</font>

185
00:08:36,929 --> 00:08:42,419
heavily used on laser printers<font color="#E5E5E5"> and when</font>

186
00:08:41,039 --> 00:08:45,120
you want to print<font color="#CCCCCC"> the document for</font>

187
00:08:42,419 --> 00:08:46,770
<font color="#E5E5E5">example some kind of PDF document but</font>

188
00:08:45,120 --> 00:08:48,690
your printer driver does is if you<font color="#E5E5E5"> use</font>

189
00:08:46,770 --> 00:08:50,610
<font color="#CCCCCC">PostScript as a printer driver</font><font color="#E5E5E5"> the</font>

190
00:08:48,690 --> 00:08:54,300
document is translated to PostScript<font color="#E5E5E5"> and</font>

191
00:08:50,610 --> 00:08:56,170
sent to the printer using one<font color="#CCCCCC"> of many</font>

192
00:08:54,300 --> 00:09:00,099
printing channels like

193
00:08:56,170 --> 00:09:04,540
<font color="#CCCCCC">korte 9100 the important thing here is</font>

194
00:09:00,100 --> 00:09:06,519
that<font color="#CCCCCC"> Co script is not</font><font color="#E5E5E5"> some simple page</font>

195
00:09:04,540 --> 00:09:10,149
description language or some<font color="#E5E5E5"> simple</font>

196
00:09:06,519 --> 00:09:12,160
markup language like HTML<font color="#E5E5E5"> PostScript is</font>

197
00:09:10,149 --> 00:09:15,250
<font color="#E5E5E5">actually a turing-complete</font>

198
00:09:12,160 --> 00:09:17,019
programming language so from the

199
00:09:15,250 --> 00:09:20,050
viewpoint<font color="#CCCCCC"> of</font><font color="#E5E5E5"> theoretical computer</font>

200
00:09:17,019 --> 00:09:22,560
science given access to<font color="#E5E5E5"> a postscript</font>

201
00:09:20,050 --> 00:09:25,569
interpreter<font color="#E5E5E5"> already means code execution</font>

202
00:09:22,560 --> 00:09:28,388
because<font color="#E5E5E5"> any possible program or</font>

203
00:09:25,570 --> 00:09:31,870
algorithm can<font color="#CCCCCC"> be written</font><font color="#E5E5E5"> in</font><font color="#CCCCCC"> the</font>

204
00:09:28,389 --> 00:09:34,320
PostScript language<font color="#E5E5E5"> and</font><font color="#CCCCCC"> execute it</font><font color="#E5E5E5"> on</font>

205
00:09:31,870 --> 00:09:37,560
<font color="#E5E5E5">the printer</font>

206
00:09:34,320 --> 00:09:39,310
<font color="#CCCCCC">okay now let me</font><font color="#E5E5E5"> come to some attacks our</font>

207
00:09:37,560 --> 00:09:42,819
methodology in planning new attacks

208
00:09:39,310 --> 00:09:44,790
<font color="#E5E5E5">actually</font><font color="#CCCCCC"> was pretty simple</font><font color="#E5E5E5"> we studied</font>

209
00:09:42,820 --> 00:09:47,199
the<font color="#CCCCCC"> sun-earth and some proprietary</font>

210
00:09:44,790 --> 00:09:50,290
extensions of PostScript<font color="#CCCCCC"> and pgl that</font>

211
00:09:47,199 --> 00:09:53,529
were<font color="#E5E5E5"> publicly available and we simply</font>

212
00:09:50,290 --> 00:09:57,639
<font color="#E5E5E5">look</font><font color="#CCCCCC"> for features</font><font color="#E5E5E5"> of the language</font><font color="#CCCCCC"> that</font>

213
00:09:53,529 --> 00:10:01,510
can<font color="#CCCCCC"> be used to do to</font><font color="#E5E5E5"> actually perform</font>

214
00:09:57,639 --> 00:10:04,060
attacks against printers before actually

215
00:10:01,510 --> 00:10:07,810
coming<font color="#CCCCCC"> to the</font><font color="#E5E5E5"> text I'm going</font><font color="#CCCCCC"> to give you</font>

216
00:10:04,060 --> 00:10:11,489
three attacker model so you<font color="#CCCCCC"> can see who</font>

217
00:10:07,810 --> 00:10:13,719
<font color="#E5E5E5">actually is able to</font><font color="#CCCCCC"> perform the attacks</font>

218
00:10:11,490 --> 00:10:15,550
<font color="#E5E5E5">okay first of all we have</font><font color="#CCCCCC"> got an</font>

219
00:10:13,720 --> 00:10:17,920
attacker with physical access<font color="#CCCCCC"> to the</font>

220
00:10:15,550 --> 00:10:20,890
device this<font color="#CCCCCC"> is</font><font color="#E5E5E5"> quite a strong attacker</font>

221
00:10:17,920 --> 00:10:23,229
model obviously however<font color="#CCCCCC"> ask yourself if</font>

222
00:10:20,890 --> 00:10:25,959
your<font color="#CCCCCC"> department's copy</font><font color="#E5E5E5"> room really</font>

223
00:10:23,230 --> 00:10:29,579
<font color="#E5E5E5">always locked</font><font color="#CCCCCC"> if your</font><font color="#E5E5E5"> conferences copy</font>

224
00:10:25,959 --> 00:10:33,099
room really<font color="#CCCCCC"> always locked</font><font color="#E5E5E5"> now it's not</font>

225
00:10:29,579 --> 00:10:35,439
<font color="#E5E5E5">okay so we think in in many scenarios</font>

226
00:10:33,100 --> 00:10:37,120
<font color="#E5E5E5">and many in many companies and many</font>

227
00:10:35,440 --> 00:10:39,029
<font color="#CCCCCC">institutions with maybe a realistic</font>

228
00:10:37,120 --> 00:10:41,980
<font color="#E5E5E5">attacker one</font>

229
00:10:39,029 --> 00:10:44,920
<font color="#E5E5E5">okay um our next attacker model is the</font>

230
00:10:41,980 --> 00:10:45,940
attacker with tcp/ip network access to

231
00:10:44,920 --> 00:10:49,120
<font color="#CCCCCC">the printer</font>

232
00:10:45,940 --> 00:10:51,339
well again<font color="#E5E5E5"> you may ask who would connect</font>

233
00:10:49,120 --> 00:10:54,089
his printer directly<font color="#E5E5E5"> to the Internet</font>

234
00:10:51,339 --> 00:10:56,380
well actually a lot<font color="#CCCCCC"> of people people do</font>

235
00:10:54,089 --> 00:10:59,079
<font color="#CCCCCC">there are</font><font color="#E5E5E5"> some current numbers from</font>

236
00:10:56,380 --> 00:11:02,560
<font color="#E5E5E5">showed on the</font><font color="#CCCCCC"> search engine for devices</font>

237
00:10:59,079 --> 00:11:05,519
and children currently<font color="#E5E5E5"> classifies over</font>

238
00:11:02,560 --> 00:11:07,899
<font color="#E5E5E5">30,000 computer systems as printers</font>

239
00:11:05,519 --> 00:11:09,860
actually it's a lot more out there but

240
00:11:07,899 --> 00:11:13,399
<font color="#CCCCCC">the classification of</font>

241
00:11:09,860 --> 00:11:16,279
<font color="#CCCCCC">is</font><font color="#E5E5E5"> not 100% correct</font><font color="#CCCCCC"> anyways if an</font>

242
00:11:13,399 --> 00:11:18,800
attacker just wants to attack some some

243
00:11:16,279 --> 00:11:21,730
random<font color="#CCCCCC"> printers</font><font color="#E5E5E5"> she can just use</font>

244
00:11:18,800 --> 00:11:27,079
children<font color="#E5E5E5"> and have alone in the u.s. over</font>

245
00:11:21,730 --> 00:11:31,040
<font color="#CCCCCC">10,000</font><font color="#E5E5E5"> devices to attack okay now our</font>

246
00:11:27,079 --> 00:11:34,219
weakest attacker model is the excuse<font color="#E5E5E5"> how</font>

247
00:11:31,040 --> 00:11:35,750
<font color="#CCCCCC">would the attacker do this well the</font>

248
00:11:34,220 --> 00:11:38,720
attacker would use the<font color="#E5E5E5"> internet and</font>

249
00:11:35,750 --> 00:11:40,790
connect to<font color="#E5E5E5"> port 9000</font><font color="#CCCCCC"> 100 of the printer</font>

250
00:11:38,720 --> 00:11:43,519
and<font color="#CCCCCC"> a</font><font color="#E5E5E5"> set the interesting thing here</font><font color="#CCCCCC"> is</font>

251
00:11:40,790 --> 00:11:44,870
<font color="#CCCCCC">that the attacker gets</font><font color="#E5E5E5"> a direct back</font>

252
00:11:43,519 --> 00:11:47,269
<font color="#E5E5E5">channel from</font><font color="#CCCCCC"> the device which is</font>

253
00:11:44,870 --> 00:11:51,079
<font color="#E5E5E5">important</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> all</font><font color="#CCCCCC"> information disclosure</font>

254
00:11:47,269 --> 00:11:53,329
attacks<font color="#E5E5E5"> if you're some kind of fireball</font>

255
00:11:51,079 --> 00:11:54,829
<font color="#CCCCCC">and as it should be or the</font><font color="#E5E5E5"> printer</font>

256
00:11:53,329 --> 00:11:58,310
<font color="#CCCCCC">doesn't have a public IP address of</font>

257
00:11:54,829 --> 00:12:00,459
<font color="#E5E5E5">course then in this scenario it may also</font>

258
00:11:58,310 --> 00:12:03,349
be interesting that an insider can

259
00:12:00,459 --> 00:12:06,979
<font color="#E5E5E5">perform the attacks through a local area</font>

260
00:12:03,350 --> 00:12:09,740
network for example<font color="#CCCCCC"> employees</font><font color="#E5E5E5"> that want</font>

261
00:12:06,980 --> 00:12:13,399
to<font color="#E5E5E5"> access the print jobs to</font><font color="#CCCCCC"> payroll</font>

262
00:12:09,740 --> 00:12:15,110
print jobs of the department manager it

263
00:12:13,399 --> 00:12:17,630
<font color="#E5E5E5">is also interesting that most modern</font>

264
00:12:15,110 --> 00:12:19,790
printers have Wi-Fi<font color="#CCCCCC"> support by default</font>

265
00:12:17,630 --> 00:12:21,709
<font color="#E5E5E5">and most of them will automatically</font>

266
00:12:19,790 --> 00:12:24,019
connect<font color="#CCCCCC"> to an</font><font color="#E5E5E5"> access point</font>

267
00:12:21,709 --> 00:12:26,839
run by an attacker with a default SSID

268
00:12:24,019 --> 00:12:30,079
<font color="#E5E5E5">and therefore even an attacker who</font><font color="#CCCCCC"> is</font>

269
00:12:26,839 --> 00:12:31,850
not inside<font color="#E5E5E5"> of the company's network but</font>

270
00:12:30,079 --> 00:12:34,939
<font color="#CCCCCC">we</font><font color="#E5E5E5"> physically close and can set up her</font>

271
00:12:31,850 --> 00:12:37,010
<font color="#CCCCCC">own access point can</font><font color="#E5E5E5"> access the printer</font>

272
00:12:34,940 --> 00:12:41,000
<font color="#E5E5E5">and potentially escalate their way into</font>

273
00:12:37,010 --> 00:12:43,790
the network or reach<font color="#CCCCCC"> print shop okay now</font>

274
00:12:41,000 --> 00:12:44,500
our weakest attacker model is the web

275
00:12:43,790 --> 00:12:47,990
attacker

276
00:12:44,500 --> 00:12:50,149
all she does is she<font color="#E5E5E5"> controls the content</font>

277
00:12:47,990 --> 00:12:54,560
or parts of<font color="#E5E5E5"> the content of a</font><font color="#CCCCCC"> website</font>

278
00:12:50,149 --> 00:12:56,600
<font color="#E5E5E5">that is accessed by an employee within</font>

279
00:12:54,560 --> 00:12:58,670
<font color="#E5E5E5">the same local</font><font color="#CCCCCC"> area</font><font color="#E5E5E5"> network for example</font>

280
00:12:56,600 --> 00:13:02,329
<font color="#CCCCCC">as a printer that we are</font><font color="#E5E5E5"> going to attack</font>

281
00:12:58,670 --> 00:13:03,979
<font color="#E5E5E5">and</font><font color="#CCCCCC"> Trudie increased web browser</font>

282
00:13:02,329 --> 00:13:09,529
the attacker can for example use

283
00:13:03,980 --> 00:13:12,980
JavaScript to post for<font color="#CCCCCC"> example malicious</font>

284
00:13:09,529 --> 00:13:15,649
<font color="#CCCCCC">postscript</font><font color="#E5E5E5"> data to port</font><font color="#CCCCCC"> 9100 not to the</font>

285
00:13:12,980 --> 00:13:18,800
web<font color="#CCCCCC"> ports</font><font color="#E5E5E5"> to port</font><font color="#CCCCCC"> 9100</font><font color="#E5E5E5"> of the printer</font>

286
00:13:15,649 --> 00:13:22,220
<font color="#E5E5E5">which is printed or executed depending</font>

287
00:13:18,800 --> 00:13:23,510
<font color="#E5E5E5">on the payload what is one drawback was</font>

288
00:13:22,220 --> 00:13:25,700
just a<font color="#E5E5E5"> dagger model</font>

289
00:13:23,510 --> 00:13:29,200
<font color="#CCCCCC">you can only</font><font color="#E5E5E5"> send data but not receive</font>

290
00:13:25,700 --> 00:13:31,400
anything<font color="#CCCCCC"> I will come back</font><font color="#E5E5E5"> to this later</font>

291
00:13:29,200 --> 00:13:34,130
<font color="#E5E5E5">okay now let's come</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> the actual</font>

292
00:13:31,400 --> 00:13:37,010
<font color="#E5E5E5">attacks let's categorize our attacks</font>

293
00:13:34,130 --> 00:13:38,890
<font color="#E5E5E5">into four</font><font color="#CCCCCC"> classes traditional denial of</font>

294
00:13:37,010 --> 00:13:41,360
service attacks<font color="#CCCCCC"> through print jobs on</font>

295
00:13:38,890 --> 00:13:44,390
making the functionality<font color="#CCCCCC"> of printing</font>

296
00:13:41,360 --> 00:13:46,970
unavailable to other users<font color="#CCCCCC"> bypassing</font>

297
00:13:44,390 --> 00:13:50,410
protection mechanisms for example by

298
00:13:46,970 --> 00:13:52,940
<font color="#E5E5E5">resetting</font><font color="#CCCCCC"> the device to factory defaults</font>

299
00:13:50,410 --> 00:13:55,280
manipulation of other users users print

300
00:13:52,940 --> 00:13:57,470
jobs and information disclosure attacks

301
00:13:55,280 --> 00:13:59,780
<font color="#E5E5E5">like</font><font color="#CCCCCC"> exit to the file system to the</font>

302
00:13:57,470 --> 00:14:03,350
memory or obtaining<font color="#CCCCCC"> other users</font><font color="#E5E5E5"> print</font>

303
00:13:59,780 --> 00:14:07,370
<font color="#CCCCCC">charms ok now let me give you a small</font>

304
00:14:03,350 --> 00:14:09,590
example<font color="#E5E5E5"> for each class of attacks what</font>

305
00:14:07,370 --> 00:14:11,960
all<font color="#E5E5E5"> that works is an infinite loop in</font>

306
00:14:09,590 --> 00:14:13,910
post script asset<font color="#CCCCCC"> PostScript is a</font>

307
00:14:11,960 --> 00:14:17,150
programming language and you have all

308
00:14:13,910 --> 00:14:19,760
these constructs<font color="#CCCCCC"> that a language</font><font color="#E5E5E5"> allows</font>

309
00:14:17,150 --> 00:14:21,620
<font color="#CCCCCC">you</font><font color="#E5E5E5"> to have like loops you can only send</font>

310
00:14:19,760 --> 00:14:23,569
<font color="#E5E5E5">this single line of code</font><font color="#CCCCCC"> to the printer</font>

311
00:14:21,620 --> 00:14:26,420
and the printer will simply do nothing

312
00:14:23,570 --> 00:14:29,270
<font color="#E5E5E5">forever</font><font color="#CCCCCC"> usually until a legitimate user</font>

313
00:14:26,420 --> 00:14:32,240
turns the device off and on again<font color="#E5E5E5"> to be</font>

314
00:14:29,270 --> 00:14:34,790
<font color="#CCCCCC">able</font><font color="#E5E5E5"> to print again okay that's pretty</font>

315
00:14:32,240 --> 00:14:37,220
trivial<font color="#CCCCCC"> however to</font><font color="#E5E5E5"> take away is whenever</font>

316
00:14:34,790 --> 00:14:40,010
the attack has the possibility to print

317
00:14:37,220 --> 00:14:45,380
<font color="#E5E5E5">of course she can prevent others from</font>

318
00:14:40,010 --> 00:14:45,920
printing now to the<font color="#CCCCCC"> election by past</font>

319
00:14:45,380 --> 00:14:48,830
attacks

320
00:14:45,920 --> 00:14:51,920
<font color="#E5E5E5">assume there's an administrator and he</font>

321
00:14:48,830 --> 00:14:53,750
does a very<font color="#E5E5E5"> good job and he</font><font color="#CCCCCC"> said</font>

322
00:14:51,920 --> 00:14:55,459
passwords<font color="#E5E5E5"> everywhere and also</font><font color="#CCCCCC"> the</font>

323
00:14:53,750 --> 00:14:57,830
printers are secured<font color="#E5E5E5"> and our attacker</font>

324
00:14:55,460 --> 00:14:59,690
<font color="#E5E5E5">wants to to change some settings in the</font>

325
00:14:57,830 --> 00:15:02,660
printer<font color="#CCCCCC"> but</font><font color="#E5E5E5"> he doesn't have the password</font>

326
00:14:59,690 --> 00:15:05,060
<font color="#E5E5E5">well what you can always do if she is a</font>

327
00:15:02,660 --> 00:15:07,339
physical attacker<font color="#E5E5E5"> is she can simply</font>

328
00:15:05,060 --> 00:15:11,689
reset<font color="#E5E5E5"> device to factory defaults</font>

329
00:15:07,340 --> 00:15:13,610
<font color="#E5E5E5">while</font><font color="#CCCCCC"> there are documented features like</font>

330
00:15:11,690 --> 00:15:16,160
pressing certain keys<font color="#E5E5E5"> documented in the</font>

331
00:15:13,610 --> 00:15:17,810
manuals<font color="#E5E5E5"> of most printer models to</font>

332
00:15:16,160 --> 00:15:20,089
<font color="#E5E5E5">actually do that if you're a physical</font>

333
00:15:17,810 --> 00:15:22,010
attacker<font color="#E5E5E5"> pretty easy however the</font>

334
00:15:20,090 --> 00:15:25,220
interesting<font color="#E5E5E5"> thing is that for</font><font color="#CCCCCC"> example on</font>

335
00:15:22,010 --> 00:15:27,710
HP printers this can be done to an

336
00:15:25,220 --> 00:15:31,160
<font color="#E5E5E5">ordinary print shop by seeing all this</font>

337
00:15:27,710 --> 00:15:34,280
line of<font color="#CCCCCC"> pgl code to the printer as a</font>

338
00:15:31,160 --> 00:15:36,410
print<font color="#E5E5E5"> shop device will reset itself</font><font color="#CCCCCC"> to</font>

339
00:15:34,280 --> 00:15:37,749
factory defaults<font color="#E5E5E5"> and by the way all</font>

340
00:15:36,410 --> 00:15:40,189
passwords

341
00:15:37,749 --> 00:15:43,939
<font color="#E5E5E5">okay only if the attacker is able to</font>

342
00:15:40,189 --> 00:15:48,498
print now one of<font color="#E5E5E5"> my favorites</font><font color="#CCCCCC"> the</font>

343
00:15:43,939 --> 00:15:51,860
<font color="#E5E5E5">manipulation of print</font><font color="#CCCCCC"> shops well one way</font>

344
00:15:48,499 --> 00:15:55,009
to do this is in<font color="#CCCCCC"> PostScript to redefine</font>

345
00:15:51,860 --> 00:15:58,850
the show page operator<font color="#E5E5E5"> PostScript</font>

346
00:15:55,009 --> 00:16:02,779
consists of about<font color="#E5E5E5"> 400 language functions</font>

347
00:15:58,850 --> 00:16:04,339
called operators and for graphic

348
00:16:02,779 --> 00:16:06,230
manipulation<font color="#E5E5E5"> and stack manipulation and</font>

349
00:16:04,339 --> 00:16:08,589
so on and one<font color="#E5E5E5"> of the operators is the</font>

350
00:16:06,230 --> 00:16:11,990
show page operator which is contained<font color="#E5E5E5"> on</font>

351
00:16:08,589 --> 00:16:14,809
every page in every<font color="#CCCCCC"> document and which</font>

352
00:16:11,990 --> 00:16:18,499
<font color="#E5E5E5">actually tells the printer to put that</font>

353
00:16:14,809 --> 00:16:21,800
page<font color="#E5E5E5"> on paper and</font><font color="#CCCCCC"> you can actually</font>

354
00:16:18,499 --> 00:16:26,569
<font color="#E5E5E5">override operators of the PostScript</font>

355
00:16:21,800 --> 00:16:29,329
language which can influence<font color="#CCCCCC"> fewer print</font>

356
00:16:26,569 --> 00:16:31,040
shops<font color="#E5E5E5"> so when the operator the show page</font>

357
00:16:29,329 --> 00:16:32,959
<font color="#E5E5E5">operator for example</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> called in a</font>

358
00:16:31,040 --> 00:16:36,349
further print shop the attackers version

359
00:16:32,959 --> 00:16:40,638
is executed and<font color="#CCCCCC"> you can use this for</font>

360
00:16:36,350 --> 00:16:43,339
<font color="#E5E5E5">example to put a smiley on other users</font>

361
00:16:40,639 --> 00:16:45,740
<font color="#E5E5E5">print</font><font color="#CCCCCC"> shops simple</font><font color="#E5E5E5"> prank</font><font color="#CCCCCC"> but you can</font>

362
00:16:43,339 --> 00:16:48,709
also do other stuff like<font color="#E5E5E5"> be creative</font>

363
00:16:45,740 --> 00:16:51,079
<font color="#E5E5E5">it's a programming language</font><font color="#CCCCCC"> so for</font>

364
00:16:48,709 --> 00:16:54,290
<font color="#E5E5E5">example you can search</font><font color="#CCCCCC"> for certain text</font>

365
00:16:51,079 --> 00:16:55,939
and then introduce some misspellings<font color="#E5E5E5"> in</font>

366
00:16:54,290 --> 00:16:59,180
the print<font color="#E5E5E5"> shops of a certain user that</font>

367
00:16:55,939 --> 00:17:03,019
maybe you don't like or think of<font color="#CCCCCC"> a</font>

368
00:16:59,180 --> 00:17:05,569
contract that<font color="#E5E5E5"> is being printed and the</font>

369
00:17:03,019 --> 00:17:08,149
attacker<font color="#E5E5E5"> wants to lower the price for</font>

370
00:17:05,569 --> 00:17:11,178
example<font color="#E5E5E5"> so here's when it gets pretty</font>

371
00:17:08,148 --> 00:17:13,729
ugly<font color="#E5E5E5"> okay</font>

372
00:17:11,179 --> 00:17:16,329
last<font color="#E5E5E5"> kind of attacks information</font>

373
00:17:13,730 --> 00:17:19,309
disclosure<font color="#E5E5E5"> text access area there are</font>

374
00:17:16,329 --> 00:17:22,158
<font color="#E5E5E5">proprietary extensions to PostScript and</font>

375
00:17:19,309 --> 00:17:25,069
<font color="#CCCCCC">vgl to access</font><font color="#E5E5E5"> the memory which are</font>

376
00:17:22,159 --> 00:17:28,220
supported by<font color="#E5E5E5"> some printer models however</font>

377
00:17:25,069 --> 00:17:31,158
<font color="#E5E5E5">D</font><font color="#CCCCCC"> standard of</font><font color="#E5E5E5"> the PostScript mpgl</font>

378
00:17:28,220 --> 00:17:35,000
allow you to<font color="#CCCCCC"> access</font><font color="#E5E5E5"> the file system to</font>

379
00:17:31,159 --> 00:17:37,250
ordinary<font color="#E5E5E5"> print shops unfortunately I</font>

380
00:17:35,000 --> 00:17:40,039
don't<font color="#E5E5E5"> have a printer model with me so no</font>

381
00:17:37,250 --> 00:17:42,260
demo today<font color="#CCCCCC"> and you can</font><font color="#E5E5E5"> even capture</font>

382
00:17:40,039 --> 00:17:46,370
print<font color="#E5E5E5"> shops based on the same principle</font>

383
00:17:42,260 --> 00:17:51,110
<font color="#CCCCCC">that you can hook into subsequent print</font>

384
00:17:46,370 --> 00:17:53,689
<font color="#E5E5E5">shops and access this data well</font>

385
00:17:51,110 --> 00:17:55,399
theory<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is easy in practice</font><font color="#E5E5E5"> it took</font>

386
00:17:53,690 --> 00:17:57,830
us some time actually<font color="#E5E5E5"> to figure it out</font>

387
00:17:55,400 --> 00:18:00,410
how to do it for<font color="#E5E5E5"> example there were some</font>

388
00:17:57,830 --> 00:18:03,230
changes<font color="#CCCCCC"> like we're</font><font color="#E5E5E5"> actually</font><font color="#CCCCCC"> two to store</font>

389
00:18:00,410 --> 00:18:04,760
the data that you have captured<font color="#E5E5E5"> if the</font>

390
00:18:03,230 --> 00:18:06,770
printer has<font color="#E5E5E5"> a hard disk and the file</font>

391
00:18:04,760 --> 00:18:08,960
<font color="#E5E5E5">system you can access this it was a</font>

392
00:18:06,770 --> 00:18:11,330
postscript and<font color="#CCCCCC"> safety job there</font>

393
00:18:08,960 --> 00:18:14,030
however on most devices you can only

394
00:18:11,330 --> 00:18:15,620
access the memory<font color="#E5E5E5"> and</font><font color="#CCCCCC"> you can define for</font>

395
00:18:14,030 --> 00:18:17,780
<font color="#CCCCCC">example PostScript dictionary is</font>

396
00:18:15,620 --> 00:18:23,510
supposed to<font color="#E5E5E5"> variables where you could be</font>

397
00:18:17,780 --> 00:18:27,440
stored<font color="#E5E5E5"> print jobs</font><font color="#CCCCCC"> into</font><font color="#E5E5E5"> okay now as I</font>

398
00:18:23,510 --> 00:18:29,210
said the web attacker is<font color="#CCCCCC"> not able to to</font>

399
00:18:27,440 --> 00:18:34,130
get a<font color="#CCCCCC"> back channel</font><font color="#E5E5E5"> WebP attacker can</font>

400
00:18:29,210 --> 00:18:36,500
only send data to<font color="#E5E5E5"> the device using</font><font color="#CCCCCC"> the</font>

401
00:18:34,130 --> 00:18:39,020
implicit<font color="#E5E5E5"> browser as a carrier she is not</font>

402
00:18:36,500 --> 00:18:43,429
able<font color="#E5E5E5"> to get any data back from</font><font color="#CCCCCC"> the</font>

403
00:18:39,020 --> 00:18:45,290
device so why is this you will not buy

404
00:18:43,429 --> 00:18:49,160
this<font color="#E5E5E5"> is it's because of the same</font><font color="#CCCCCC"> origin</font>

405
00:18:45,290 --> 00:18:50,928
policy so<font color="#E5E5E5"> script can only access data</font>

406
00:18:49,160 --> 00:18:54,080
<font color="#E5E5E5">from the same</font><font color="#CCCCCC"> region in terms of</font>

407
00:18:50,929 --> 00:18:57,950
protocol domain and port<font color="#CCCCCC"> okay small</font>

408
00:18:54,080 --> 00:19:00,710
example we've<font color="#E5E5E5"> got evil.org and and we've</font>

409
00:18:57,950 --> 00:19:02,480
got some internal banking side and what

410
00:19:00,710 --> 00:19:05,510
the attacker manages to to lure an

411
00:19:02,480 --> 00:19:09,049
employee<font color="#E5E5E5"> on her website on even</font><font color="#CCCCCC"> the work</font>

412
00:19:05,510 --> 00:19:11,809
and even<font color="#CCCCCC"> a rogue now can execute</font>

413
00:19:09,049 --> 00:19:15,650
<font color="#CCCCCC">JavaScript</font><font color="#E5E5E5"> in the Imperius web browser</font>

414
00:19:11,809 --> 00:19:17,960
<font color="#E5E5E5">and therefore for example</font><font color="#CCCCCC"> force an HTTP</font>

415
00:19:15,650 --> 00:19:20,870
GET<font color="#E5E5E5"> request to some internal</font><font color="#CCCCCC"> side</font>

416
00:19:17,960 --> 00:19:23,120
however now the employees browser says

417
00:19:20,870 --> 00:19:25,340
evil dog does not<font color="#E5E5E5"> equal in terms of</font>

418
00:19:23,120 --> 00:19:27,949
bank.com<font color="#CCCCCC"> and therefore you're not</font>

419
00:19:25,340 --> 00:19:29,209
<font color="#E5E5E5">allowed</font><font color="#CCCCCC"> to access</font><font color="#E5E5E5"> this data so no</font>

420
00:19:27,950 --> 00:19:33,919
information<font color="#CCCCCC"> is closure for the web</font>

421
00:19:29,210 --> 00:19:36,380
attacker well however<font color="#E5E5E5"> in the drinking</font>

422
00:19:33,919 --> 00:19:39,890
context there's something else there's

423
00:19:36,380 --> 00:19:41,900
something<font color="#E5E5E5"> you well you've all heard of</font>

424
00:19:39,890 --> 00:19:45,559
course<font color="#E5E5E5"> um cross-origin resource sharing</font>

425
00:19:41,900 --> 00:19:47,900
which allows you<font color="#E5E5E5"> legitimate a website to</font>

426
00:19:45,559 --> 00:19:51,620
<font color="#E5E5E5">make exceptions to the same origin</font>

427
00:19:47,900 --> 00:19:53,870
policy<font color="#E5E5E5"> and to say a certain rhythm the</font>

428
00:19:51,620 --> 00:19:58,070
domain is for<font color="#CCCCCC"> example allowed to access</font>

429
00:19:53,870 --> 00:20:00,080
<font color="#E5E5E5">a certain resource now however again in</font>

430
00:19:58,070 --> 00:20:01,850
the context of printing you got<font color="#E5E5E5"> evil</font>

431
00:20:00,080 --> 00:20:05,110
<font color="#CCCCCC">org and</font><font color="#E5E5E5"> we want to attack some internal</font>

432
00:20:01,850 --> 00:20:09,889
printer printed<font color="#E5E5E5"> ENCOM on port 9000</font>

433
00:20:05,110 --> 00:20:11,659
<font color="#E5E5E5">okay again the empty year somehow</font><font color="#CCCCCC"> fetch</font>

434
00:20:09,890 --> 00:20:14,270
<font color="#CCCCCC">SD website for example of the attacker</font>

435
00:20:11,660 --> 00:20:16,460
in the attack again again<font color="#CCCCCC"> execute</font>

436
00:20:14,270 --> 00:20:18,020
JavaScript<font color="#E5E5E5"> and the interesting thing</font>

437
00:20:16,460 --> 00:20:22,040
<font color="#CCCCCC">here is</font><font color="#E5E5E5"> GSD a check again</font>

438
00:20:18,020 --> 00:20:25,160
for example<font color="#E5E5E5"> post a postscript file using</font>

439
00:20:22,040 --> 00:20:27,710
javascript<font color="#E5E5E5"> on court</font><font color="#CCCCCC"> 9100 which is then</font>

440
00:20:25,160 --> 00:20:29,090
<font color="#E5E5E5">interpreted on the printer and as</font>

441
00:20:27,710 --> 00:20:31,750
<font color="#CCCCCC">PostScript</font><font color="#E5E5E5"> is a programming language</font>

442
00:20:29,090 --> 00:20:35,870
<font color="#E5E5E5">what you can do for</font><font color="#CCCCCC"> example</font><font color="#E5E5E5"> is you can</font>

443
00:20:31,750 --> 00:20:37,850
<font color="#E5E5E5">actual arbitrary strings back to the</font>

444
00:20:35,870 --> 00:20:40,870
<font color="#E5E5E5">channel which</font><font color="#CCCCCC"> is a</font><font color="#E5E5E5"> network socket in</font>

445
00:20:37,850 --> 00:20:44,929
this case and the attacker can use<font color="#E5E5E5"> this</font>

446
00:20:40,870 --> 00:20:47,600
to simulate an HTTP server running on

447
00:20:44,930 --> 00:20:49,730
<font color="#E5E5E5">the printer for example including the</font>

448
00:20:47,600 --> 00:20:53,120
course header that<font color="#E5E5E5"> explicitly</font><font color="#CCCCCC"> allows</font>

449
00:20:49,730 --> 00:20:55,370
evil.org<font color="#E5E5E5"> to access this data the printer</font>

450
00:20:53,120 --> 00:20:57,649
will actually straight up back to<font color="#E5E5E5"> the</font>

451
00:20:55,370 --> 00:21:01,129
<font color="#CCCCCC">network socket and the browser thinks oh</font>

452
00:20:57,650 --> 00:21:05,270
it's all fine because<font color="#E5E5E5"> the printer allows</font>

453
00:21:01,130 --> 00:21:08,180
<font color="#E5E5E5">able to talk explicitly to to access the</font>

454
00:21:05,270 --> 00:21:10,040
data and therefore the web attack again

455
00:21:08,180 --> 00:21:11,690
is able to<font color="#E5E5E5"> perform all the attacks</font>

456
00:21:10,040 --> 00:21:14,000
including the information<font color="#CCCCCC"> disclosure</font>

457
00:21:11,690 --> 00:21:20,080
attacks<font color="#E5E5E5"> with other words a malicious</font>

458
00:21:14,000 --> 00:21:20,080
<font color="#E5E5E5">website can read your print shops okay</font>

459
00:21:20,470 --> 00:21:26,570
<font color="#E5E5E5">well now</font><font color="#CCCCCC"> Chrome and Firefox are</font>

460
00:21:24,410 --> 00:21:27,980
currently in the process of discussing

461
00:21:26,570 --> 00:21:30,649
to block<font color="#CCCCCC"> this port</font>

462
00:21:27,980 --> 00:21:35,560
<font color="#E5E5E5">um we will see what actually happens</font><font color="#CCCCCC"> um</font>

463
00:21:30,650 --> 00:21:38,360
maybe this will not be possible<font color="#CCCCCC"> forever</font>

464
00:21:35,560 --> 00:21:39,530
now let<font color="#E5E5E5"> me give you a short</font><font color="#CCCCCC"> evaluation</font>

465
00:21:38,360 --> 00:21:43,429
of PD attacks

466
00:21:39,530 --> 00:21:46,850
um one problem was<font color="#E5E5E5"> obtaining enough</font>

467
00:21:43,430 --> 00:21:49,100
printer models to test the<font color="#CCCCCC"> the</font><font color="#E5E5E5"> actual</font>

468
00:21:46,850 --> 00:21:52,310
attacks<font color="#E5E5E5"> and what we</font><font color="#CCCCCC"> actually wanted was</font>

469
00:21:49,100 --> 00:21:56,020
an<font color="#CCCCCC"> average of what is typically used in</font>

470
00:21:52,310 --> 00:22:00,889
a university or<font color="#E5E5E5"> in an office context and</font>

471
00:21:56,020 --> 00:22:03,260
well how<font color="#CCCCCC"> would</font><font color="#E5E5E5"> you do it well what we</font>

472
00:22:00,890 --> 00:22:05,150
did<font color="#E5E5E5"> in the end was we wrote a lot of</font>

473
00:22:03,260 --> 00:22:08,210
emails<font color="#E5E5E5"> knocked a lot of doors at the</font>

474
00:22:05,150 --> 00:22:10,490
<font color="#CCCCCC">University and asked the admins if they</font>

475
00:22:08,210 --> 00:22:13,430
<font color="#CCCCCC">wouldn't have some devices for us for</font>

476
00:22:10,490 --> 00:22:16,280
signs to test and this worked<font color="#E5E5E5"> pretty</font>

477
00:22:13,430 --> 00:22:18,020
well in the end<font color="#E5E5E5"> um we got twenty</font>

478
00:22:16,280 --> 00:22:21,860
printers from

479
00:22:18,020 --> 00:22:24,020
<font color="#CCCCCC">eight different manufacturers we install</font>

480
00:22:21,860 --> 00:22:28,510
the latest<font color="#E5E5E5"> firmware to make sure all the</font>

481
00:22:24,020 --> 00:22:31,940
abilities found<font color="#CCCCCC"> when affixed in</font><font color="#E5E5E5"> between</font>

482
00:22:28,510 --> 00:22:34,400
<font color="#E5E5E5">okay here</font><font color="#CCCCCC"> are the</font><font color="#E5E5E5"> results</font><font color="#CCCCCC"> I'm on the</font>

483
00:22:31,940 --> 00:22:37,490
left<font color="#E5E5E5"> side you</font><font color="#CCCCCC"> can</font><font color="#E5E5E5"> see the actual printer</font>

484
00:22:34,400 --> 00:22:39,530
model and on the right side<font color="#CCCCCC"> the Year</font>

485
00:22:37,490 --> 00:22:43,450
denial of service category of attacks

486
00:22:39,530 --> 00:22:46,340
<font color="#E5E5E5">red means to device is vulnerable and</font>

487
00:22:43,450 --> 00:22:49,040
<font color="#CCCCCC">asset for</font><font color="#E5E5E5"> example the infinite loop in</font>

488
00:22:46,340 --> 00:22:51,709
<font color="#CCCCCC">Perl script</font><font color="#E5E5E5"> works for almost all device</font>

489
00:22:49,040 --> 00:22:53,330
or devices<font color="#E5E5E5"> but there are other</font>

490
00:22:51,710 --> 00:22:55,910
possibilities<font color="#CCCCCC"> for example you can</font>

491
00:22:53,330 --> 00:22:59,810
redefine the<font color="#E5E5E5"> code to show page operator</font>

492
00:22:55,910 --> 00:23:02,930
to do nothing at all so print jobs are

493
00:22:59,810 --> 00:23:06,230
still executed<font color="#E5E5E5"> but they are not good to</font>

494
00:23:02,930 --> 00:23:09,200
<font color="#CCCCCC">pay</font><font color="#E5E5E5"> for finally anymore and</font><font color="#CCCCCC"> pls a</font>

495
00:23:06,230 --> 00:23:11,240
similar feature you can use legitimate

496
00:23:09,200 --> 00:23:14,210
PGI commands to set the printer to

497
00:23:11,240 --> 00:23:15,650
offline mode so network users cannot

498
00:23:14,210 --> 00:23:17,480
<font color="#E5E5E5">access it anymore</font>

499
00:23:15,650 --> 00:23:21,070
it's<font color="#E5E5E5"> just a legitimate feature of the</font>

500
00:23:17,480 --> 00:23:24,710
PTL language<font color="#E5E5E5"> and we even managed to</font>

501
00:23:21,070 --> 00:23:29,689
physically to cause physical damage to<font color="#CCCCCC"> 8</font>

502
00:23:24,710 --> 00:23:32,540
of 20<font color="#E5E5E5"> devices you need to know that</font><font color="#CCCCCC"> our</font>

503
00:23:29,690 --> 00:23:35,390
<font color="#E5E5E5">long term values are stored in the</font>

504
00:23:32,540 --> 00:23:37,370
printers envy realm<font color="#E5E5E5"> that</font><font color="#CCCCCC"> is normal for</font>

505
00:23:35,390 --> 00:23:41,150
embedded devices<font color="#E5E5E5"> to have some flash</font>

506
00:23:37,370 --> 00:23:42,800
memory or<font color="#CCCCCC"> you</font><font color="#E5E5E5"> from</font><font color="#CCCCCC"> to to store to store</font>

507
00:23:41,150 --> 00:23:47,600
the values if the device<font color="#CCCCCC"> doesn't have a</font>

508
00:23:42,800 --> 00:23:49,610
hard<font color="#E5E5E5"> disk and well for example</font><font color="#CCCCCC"> the</font>

509
00:23:47,600 --> 00:23:51,409
<font color="#E5E5E5">number of copies</font><font color="#CCCCCC"> as you've seen in the</font>

510
00:23:49,610 --> 00:23:55,189
example before can be<font color="#E5E5E5"> stored as a</font><font color="#CCCCCC"> long</font>

511
00:23:51,410 --> 00:23:59,170
<font color="#CCCCCC">term</font><font color="#E5E5E5"> value however</font><font color="#CCCCCC"> this in vram only</font>

512
00:23:55,190 --> 00:24:02,240
allows you to to run<font color="#E5E5E5"> to to for example</font>

513
00:23:59,170 --> 00:24:05,330
<font color="#CCCCCC">have a million of write cycles</font><font color="#E5E5E5"> then</font>

514
00:24:02,240 --> 00:24:06,950
there's physical<font color="#E5E5E5"> limit the the unit will</font>

515
00:24:05,330 --> 00:24:10,250
not allow new values to<font color="#CCCCCC"> be written</font>

516
00:24:06,950 --> 00:24:13,940
<font color="#CCCCCC">anymore and you can write</font><font color="#E5E5E5"> to the</font><font color="#CCCCCC"> inva</font>

517
00:24:10,250 --> 00:24:15,860
<font color="#E5E5E5">and</font><font color="#CCCCCC"> vrm to a single line of PHP</font><font color="#E5E5E5"> GL code</font>

518
00:24:13,940 --> 00:24:18,320
<font color="#E5E5E5">by setting the</font><font color="#CCCCCC"> number of copies for</font>

519
00:24:15,860 --> 00:24:20,840
example and you<font color="#E5E5E5"> can also print a large</font>

520
00:24:18,320 --> 00:24:22,490
print shop<font color="#E5E5E5"> which contains a million</font>

521
00:24:20,840 --> 00:24:27,709
lines of code<font color="#E5E5E5"> which takes</font><font color="#CCCCCC"> some time in</font>

522
00:24:22,490 --> 00:24:31,160
the end to exceed the the portability<font color="#E5E5E5"> of</font>

523
00:24:27,710 --> 00:24:33,200
the<font color="#E5E5E5"> envy realm to accept new values</font>

524
00:24:31,160 --> 00:24:35,350
the printer will<font color="#E5E5E5"> still totally fine</font>

525
00:24:33,200 --> 00:24:39,890
print<font color="#E5E5E5"> from</font><font color="#CCCCCC"> a mechanical point</font><font color="#E5E5E5"> of view</font>

526
00:24:35,350 --> 00:24:41,959
but if your paper size for example<font color="#CCCCCC"> is</font>

527
00:24:39,890 --> 00:24:45,650
fixed to letter<font color="#E5E5E5"> and you want to switch</font>

528
00:24:41,960 --> 00:24:51,200
<font color="#CCCCCC">the long term to a4 well and you can't</font>

529
00:24:45,650 --> 00:24:54,160
this may be a problem<font color="#CCCCCC"> ok our next class</font>

530
00:24:51,200 --> 00:24:58,460
of<font color="#E5E5E5"> attack is the protection bypass</font>

531
00:24:54,160 --> 00:25:00,800
attacks using<font color="#E5E5E5"> SNMP the only kind of</font>

532
00:24:58,460 --> 00:25:04,010
attack that<font color="#E5E5E5"> is not launched through a</font>

533
00:25:00,800 --> 00:25:07,280
printer<font color="#CCCCCC"> was possible</font><font color="#E5E5E5"> for about 1/2 of 2</font>

534
00:25:04,010 --> 00:25:08,990
devices<font color="#CCCCCC"> but on most HP devices you could</font>

535
00:25:07,280 --> 00:25:14,110
<font color="#CCCCCC">also reset the device to factory</font>

536
00:25:08,990 --> 00:25:16,490
defaults using ordinary print jobs

537
00:25:14,110 --> 00:25:18,590
manipulating other users print shops by

538
00:25:16,490 --> 00:25:21,020
infecting the device with<font color="#CCCCCC"> host creep</font>

539
00:25:18,590 --> 00:25:24,080
malware also works<font color="#E5E5E5"> for most of the</font>

540
00:25:21,020 --> 00:25:26,210
devices<font color="#E5E5E5"> some devices had physically</font>

541
00:25:24,080 --> 00:25:29,080
broken printing functionality<font color="#CCCCCC"> so we</font>

542
00:25:26,210 --> 00:25:31,490
<font color="#E5E5E5">couldn't actually test them in</font><font color="#CCCCCC"> the end</font>

543
00:25:29,080 --> 00:25:36,020
<font color="#E5E5E5">accessing the memory only</font><font color="#CCCCCC"> work</font><font color="#E5E5E5"> for</font>

544
00:25:31,490 --> 00:25:37,970
<font color="#CCCCCC">grader based devices</font><font color="#E5E5E5"> and exit</font><font color="#CCCCCC"> to the</font>

545
00:25:36,020 --> 00:25:39,980
file system was<font color="#E5E5E5"> only possible</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> two</font>

546
00:25:37,970 --> 00:25:42,970
devices<font color="#CCCCCC"> to access</font><font color="#E5E5E5"> the whole file system</font>

547
00:25:39,980 --> 00:25:46,520
<font color="#E5E5E5">however most devices allowed us to</font>

548
00:25:42,970 --> 00:25:49,400
access<font color="#E5E5E5"> certain directories and this is</font>

549
00:25:46,520 --> 00:25:51,770
not<font color="#E5E5E5"> necessarily harmless for example on</font>

550
00:25:49,400 --> 00:25:54,110
<font color="#E5E5E5">okie devices there</font><font color="#CCCCCC"> is a directory called</font>

551
00:25:51,770 --> 00:25:55,850
hidden<font color="#E5E5E5"> and all the settings are stored</font>

552
00:25:54,110 --> 00:25:58,340
in<font color="#E5E5E5"> this directory and</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> have read and</font>

553
00:25:55,850 --> 00:26:00,230
<font color="#CCCCCC">write access</font><font color="#E5E5E5"> and there are all the</font>

554
00:25:58,340 --> 00:26:03,439
<font color="#CCCCCC">passwords</font><font color="#E5E5E5"> for example not only for the</font>

555
00:26:00,230 --> 00:26:06,200
device itself<font color="#E5E5E5"> because you can integrate</font>

556
00:26:03,440 --> 00:26:09,230
<font color="#E5E5E5">your printer into your</font><font color="#CCCCCC"> network on modern</font>

557
00:26:06,200 --> 00:26:10,670
printers<font color="#E5E5E5"> so you can set for</font><font color="#CCCCCC"> example you</font>

558
00:26:09,230 --> 00:26:12,950
can integrate<font color="#E5E5E5"> into your Windows domain</font>

559
00:26:10,670 --> 00:26:14,990
<font color="#E5E5E5">and then you have got an Active</font>

560
00:26:12,950 --> 00:26:16,460
Directory password<font color="#E5E5E5"> that is set on</font><font color="#CCCCCC"> the</font>

561
00:26:14,990 --> 00:26:19,130
printer installed on the printer in this

562
00:26:16,460 --> 00:26:21,080
<font color="#E5E5E5">directory you can use scan to email so</font>

563
00:26:19,130 --> 00:26:24,320
<font color="#E5E5E5">their email credentials can be stored on</font>

564
00:26:21,080 --> 00:26:27,110
the device<font color="#E5E5E5"> you can even store on Wi-Fi</font>

565
00:26:24,320 --> 00:26:29,300
and<font color="#E5E5E5"> IPSec</font><font color="#CCCCCC"> preciate keys on the printer</font>

566
00:26:27,110 --> 00:26:32,209
and<font color="#E5E5E5"> therefore integrated into a secure</font>

567
00:26:29,300 --> 00:26:34,940
<font color="#CCCCCC">network so this may be one</font><font color="#E5E5E5"> good example</font>

568
00:26:32,210 --> 00:26:37,130
<font color="#E5E5E5">how an attacker can escalate herself</font>

569
00:26:34,940 --> 00:26:39,790
into a company's<font color="#E5E5E5"> network using the</font>

570
00:26:37,130 --> 00:26:43,160
printer<font color="#CCCCCC"> as a starting point</font>

571
00:26:39,790 --> 00:26:44,899
capturing<font color="#E5E5E5"> print jobs and</font><font color="#CCCCCC"> as introduced a</font>

572
00:26:43,160 --> 00:26:47,060
work for most

573
00:26:44,900 --> 00:26:49,220
<font color="#CCCCCC">positive</font><font color="#E5E5E5"> based devices it doesn't work</font>

574
00:26:47,060 --> 00:26:51,350
for<font color="#E5E5E5"> brother devices for</font><font color="#CCCCCC"> example the</font><font color="#E5E5E5"> USB</font>

575
00:26:49,220 --> 00:26:54,170
<font color="#CCCCCC">our script which is some post clone</font>

576
00:26:51,350 --> 00:26:57,830
which is not 100% compatible with the

577
00:26:54,170 --> 00:26:59,780
<font color="#CCCCCC">Adobe standard and also</font><font color="#E5E5E5"> credentials no</font>

578
00:26:57,830 --> 00:27:01,939
she attacks<font color="#E5E5E5"> based on proof force against</font>

579
00:26:59,780 --> 00:27:06,440
<font color="#E5E5E5">PCL and</font><font color="#CCCCCC"> PostScript works for most</font>

580
00:27:01,940 --> 00:27:09,860
devices<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> now let me give you a short</font>

581
00:27:06,440 --> 00:27:12,220
introduction to<font color="#CCCCCC"> our patent to read what</font>

582
00:27:09,860 --> 00:27:15,290
can you do with<font color="#CCCCCC"> it</font><font color="#E5E5E5"> you can dry you can</font>

583
00:27:12,220 --> 00:27:17,210
do to<font color="#CCCCCC"> printer penetration test with the</font>

584
00:27:15,290 --> 00:27:19,899
tool<font color="#CCCCCC"> and</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> can analyze you on printer</font>

585
00:27:17,210 --> 00:27:23,990
it's a free software<font color="#CCCCCC"> available on github</font>

586
00:27:19,900 --> 00:27:26,510
<font color="#E5E5E5">how does</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> work well if you want</font><font color="#CCCCCC"> to pen</font>

587
00:27:23,990 --> 00:27:29,720
test the printer what you can do is you

588
00:27:26,510 --> 00:27:32,210
can have a<font color="#E5E5E5"> a user friendly command like</font>

589
00:27:29,720 --> 00:27:35,210
<font color="#CCCCCC">Yeller and the attacker command of</font>

590
00:27:32,210 --> 00:27:37,850
<font color="#CCCCCC">threat</font><font color="#E5E5E5"> and the attacker module process</font>

591
00:27:35,210 --> 00:27:40,850
to see the command<font color="#E5E5E5"> and translate</font><font color="#CCCCCC"> it to</font>

592
00:27:37,850 --> 00:27:43,850
<font color="#CCCCCC">pgl or both script and finally sent it</font>

593
00:27:40,850 --> 00:27:49,070
to the printer either using USB<font color="#CCCCCC"> cable or</font>

594
00:27:43,850 --> 00:27:52,159
port<font color="#E5E5E5"> 9100 is currently supported so for</font>

595
00:27:49,070 --> 00:27:53,929
<font color="#E5E5E5">example if you want to be in a</font>

596
00:27:52,160 --> 00:27:55,520
postscript mode you simply<font color="#E5E5E5"> tie their</font>

597
00:27:53,930 --> 00:27:57,530
<font color="#E5E5E5">lives you do not have to speak the go</font>

598
00:27:55,520 --> 00:28:00,230
script language and a<font color="#E5E5E5"> fret will</font>

599
00:27:57,530 --> 00:28:04,220
translate into the<font color="#CCCCCC"> PostScript equivalent</font>

600
00:28:00,230 --> 00:28:08,210
and get a postscript response from the

601
00:28:04,220 --> 00:28:10,610
printer<font color="#E5E5E5"> and in the end the user gets the</font>

602
00:28:08,210 --> 00:28:14,000
<font color="#E5E5E5">results of LS</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> user friendly manner</font>

603
00:28:10,610 --> 00:28:17,419
<font color="#CCCCCC">a file Lister ok you can do the pretty</font>

604
00:28:14,000 --> 00:28:20,690
much<font color="#E5E5E5"> the same thing with PTL again type</font>

605
00:28:17,420 --> 00:28:22,220
LS<font color="#E5E5E5"> p GL request to send feature responds</font>

606
00:28:20,690 --> 00:28:25,100
with<font color="#CCCCCC"> apart</font><font color="#E5E5E5"> from the printer</font><font color="#CCCCCC"> and again</font>

607
00:28:22,220 --> 00:28:27,280
you get the results of<font color="#CCCCCC"> the</font><font color="#E5E5E5"> LS in a</font>

608
00:28:25,100 --> 00:28:31,490
<font color="#E5E5E5">user-friendly manner</font>

609
00:28:27,280 --> 00:28:33,620
<font color="#CCCCCC">ok</font><font color="#E5E5E5"> um</font><font color="#CCCCCC"> there are lots of commands that</font>

610
00:28:31,490 --> 00:28:36,130
<font color="#CCCCCC">are supported</font><font color="#E5E5E5"> for</font><font color="#CCCCCC"> file system access</font>

611
00:28:33,620 --> 00:28:39,199
<font color="#CCCCCC">that</font><font color="#E5E5E5"> you would expect from a typical</font>

612
00:28:36,130 --> 00:28:40,700
<font color="#E5E5E5">command-line ftp client like LS get</font><font color="#CCCCCC"> put</font>

613
00:28:39,200 --> 00:28:42,440
the pen to<font color="#CCCCCC"> lead for uploading</font><font color="#E5E5E5"> and</font>

614
00:28:40,700 --> 00:28:44,540
<font color="#CCCCCC">downloading files</font><font color="#E5E5E5"> but that's only for</font>

615
00:28:42,440 --> 00:28:47,720
<font color="#CCCCCC">file system access there many more</font>

616
00:28:44,540 --> 00:28:51,770
commands<font color="#E5E5E5"> just keep it a drive with</font>

617
00:28:47,720 --> 00:28:54,850
implemented all the<font color="#E5E5E5"> attacks that that we</font>

618
00:28:51,770 --> 00:28:54,850
know of<font color="#CCCCCC"> into that</font><font color="#E5E5E5"> you</font>

619
00:28:55,720 --> 00:29:03,279
now we sort of adapting<font color="#E5E5E5"> the</font><font color="#CCCCCC"> attacks</font><font color="#E5E5E5"> to</font>

620
00:28:59,470 --> 00:29:06,460
areas beyond printers and this is pretty

621
00:29:03,279 --> 00:29:10,000
<font color="#E5E5E5">hard for</font><font color="#CCCCCC"> pgl</font><font color="#E5E5E5"> because it's pretty tightly</font>

622
00:29:06,460 --> 00:29:12,549
bound to printers how<font color="#E5E5E5"> the PostScript is</font>

623
00:29:10,000 --> 00:29:15,159
what<font color="#E5E5E5"> we used in other areas for</font><font color="#CCCCCC"> example</font>

624
00:29:12,549 --> 00:29:18,429
<font color="#CCCCCC">you can import</font><font color="#E5E5E5"> postscript files in</font><font color="#CCCCCC"> your</font>

625
00:29:15,159 --> 00:29:21,850
Microsoft<font color="#CCCCCC"> Office or Libre Office and</font>

626
00:29:18,429 --> 00:29:23,740
therefore attack client software<font color="#E5E5E5"> but</font>

627
00:29:21,850 --> 00:29:27,850
<font color="#E5E5E5">also some websites</font><font color="#CCCCCC"> even process</font>

628
00:29:23,740 --> 00:29:30,840
<font color="#CCCCCC">postscript I will come back to that in a</font>

629
00:29:27,850 --> 00:29:34,510
minute<font color="#E5E5E5"> now let me show you an attack on</font>

630
00:29:30,840 --> 00:29:36,850
Google Cloud Print<font color="#CCCCCC"> what is which</font><font color="#E5E5E5"> is</font>

631
00:29:34,510 --> 00:29:38,970
still<font color="#CCCCCC"> tightly bound to the</font><font color="#E5E5E5"> printing area</font>

632
00:29:36,850 --> 00:29:40,990
of course but not traditional printing

633
00:29:38,970 --> 00:29:44,380
<font color="#CCCCCC">what can you do with to bailout print</font>

634
00:29:40,990 --> 00:29:46,450
you can basically print a file from

635
00:29:44,380 --> 00:29:51,279
anywhere in the<font color="#CCCCCC"> world</font><font color="#E5E5E5"> using a Google</font>

636
00:29:46,450 --> 00:29:54,250
<font color="#E5E5E5">account by first registering a Google</font>

637
00:29:51,279 --> 00:29:57,669
open<font color="#CCCCCC"> Chrome compatible printer and then</font>

638
00:29:54,250 --> 00:30:00,000
printing through a Google account<font color="#CCCCCC"> okay</font>

639
00:29:57,669 --> 00:30:03,610
for<font color="#E5E5E5"> example you can target the printer</font>

640
00:30:00,000 --> 00:30:05,260
if the printer is<font color="#E5E5E5"> a</font><font color="#CCCCCC"> postscript printer</font>

641
00:30:03,610 --> 00:30:08,289
you can simply<font color="#E5E5E5"> send a postscript</font>

642
00:30:05,260 --> 00:30:10,059
document to Google print<font color="#E5E5E5"> and the cloud</font>

643
00:30:08,289 --> 00:30:12,158
will simply<font color="#E5E5E5"> forward it to the printer in</font>

644
00:30:10,059 --> 00:30:14,500
<font color="#CCCCCC">your local area</font><font color="#E5E5E5"> network and this is just</font>

645
00:30:12,159 --> 00:30:18,880
another way to<font color="#E5E5E5"> attack your printer in</font>

646
00:30:14,500 --> 00:30:21,370
the<font color="#E5E5E5"> end to perform the attacks just one</font>

647
00:30:18,880 --> 00:30:25,090
more channel<font color="#E5E5E5"> however</font><font color="#CCCCCC"> you can also attack</font>

648
00:30:21,370 --> 00:30:27,668
<font color="#CCCCCC">the Google</font><font color="#E5E5E5"> cloud</font><font color="#CCCCCC"> directly if you</font>

649
00:30:25,090 --> 00:30:30,970
<font color="#E5E5E5">register printer that says well I don't</font>

650
00:30:27,669 --> 00:30:34,090
<font color="#E5E5E5">speak a postscript I only speak I prefer</font>

651
00:30:30,970 --> 00:30:36,340
PDF<font color="#E5E5E5"> just</font><font color="#CCCCCC"> give in PDF then if you send</font><font color="#E5E5E5"> a</font>

652
00:30:34,090 --> 00:30:38,439
<font color="#E5E5E5">postscript file what Google does is it</font>

653
00:30:36,340 --> 00:30:41,980
converts it into PDF<font color="#E5E5E5"> and sends it to the</font>

654
00:30:38,440 --> 00:30:43,600
printer however converting<font color="#E5E5E5"> PostScript</font>

655
00:30:41,980 --> 00:30:46,740
<font color="#E5E5E5">actually means interpreting means</font>

656
00:30:43,600 --> 00:30:50,199
executing PostScript<font color="#CCCCCC"> on the</font><font color="#E5E5E5"> Google cloud</font>

657
00:30:46,740 --> 00:30:52,240
which<font color="#CCCCCC"> can be really dangerous in the</font>

658
00:30:50,200 --> 00:30:54,850
case<font color="#E5E5E5"> of</font><font color="#CCCCCC"> Google the Google guys are</font>

659
00:30:52,240 --> 00:30:57,580
pre-priced and they had sandbox<font color="#E5E5E5"> almost</font>

660
00:30:54,850 --> 00:30:58,000
everything and so the<font color="#E5E5E5"> impact was quite</font>

661
00:30:57,580 --> 00:30:59,949
limited

662
00:30:58,000 --> 00:31:03,970
all the found was a limited information

663
00:30:59,950 --> 00:31:07,059
<font color="#CCCCCC">disclosure being able to stat aperture</font>

664
00:31:03,970 --> 00:31:09,010
size on the actual file system really

665
00:31:07,059 --> 00:31:14,050
limited<font color="#E5E5E5"> or still we got some</font>

666
00:31:09,010 --> 00:31:17,590
for this<font color="#E5E5E5"> finding from Google okay um</font><font color="#CCCCCC"> ss</font>

667
00:31:14,050 --> 00:31:18,990
<font color="#E5E5E5">some PostScript in the web well where</font>

668
00:31:17,590 --> 00:31:22,030
would<font color="#E5E5E5"> it be</font><font color="#CCCCCC"> um</font>

669
00:31:18,990 --> 00:31:24,700
logically PostScript<font color="#CCCCCC"> to</font><font color="#E5E5E5"> PDF conversion</font>

670
00:31:22,030 --> 00:31:27,520
<font color="#E5E5E5">websites would also have</font><font color="#CCCCCC"> to convert and</font>

671
00:31:24,700 --> 00:31:29,560
execute PDF and most of them almost all

672
00:31:27,520 --> 00:31:31,420
of them are vulnerable<font color="#E5E5E5"> at least to</font>

673
00:31:29,560 --> 00:31:34,179
information disclosure<font color="#E5E5E5"> attacks sometimes</font>

674
00:31:31,420 --> 00:31:36,310
even more however<font color="#CCCCCC"> they</font><font color="#E5E5E5"> are not</font><font color="#CCCCCC"> meant</font>

675
00:31:34,180 --> 00:31:39,540
<font color="#CCCCCC">that many</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> them</font><font color="#E5E5E5"> but we can extend this</font>

676
00:31:36,310 --> 00:31:44,830
<font color="#E5E5E5">to image conversion size in general</font>

677
00:31:39,540 --> 00:31:47,020
because many image sites conversion

678
00:31:44,830 --> 00:31:50,409
sites allow<font color="#CCCCCC"> you</font><font color="#E5E5E5"> to upload EPS files</font>

679
00:31:47,020 --> 00:31:52,450
<font color="#E5E5E5">what is EPS EPS is known as a vector</font>

680
00:31:50,410 --> 00:31:55,750
image<font color="#E5E5E5"> file format but actually it's just</font>

681
00:31:52,450 --> 00:31:57,820
plain PostScript<font color="#CCCCCC"> in the end and</font><font color="#E5E5E5"> we</font>

682
00:31:55,750 --> 00:32:00,700
tested the top 100<font color="#E5E5E5"> online image</font>

683
00:31:57,820 --> 00:32:05,169
converters and 48 of them were

684
00:32:00,700 --> 00:32:09,760
vulnerable to accepting<font color="#E5E5E5"> PostScript and</font>

685
00:32:05,170 --> 00:32:12,010
executing costumes<font color="#E5E5E5"> okay you say well my</font>

686
00:32:09,760 --> 00:32:14,040
website doesn't<font color="#E5E5E5"> convert any images but</font>

687
00:32:12,010 --> 00:32:17,470
<font color="#E5E5E5">maybe you have got</font><font color="#CCCCCC"> some hair preview</font>

688
00:32:14,040 --> 00:32:20,940
maybe your users are allowed to to

689
00:32:17,470 --> 00:32:24,430
upload some image for their profile

690
00:32:20,940 --> 00:32:26,530
maybe<font color="#E5E5E5"> on you make a preview</font><font color="#CCCCCC"> of all files</font>

691
00:32:24,430 --> 00:32:30,160
<font color="#E5E5E5">that are uploaded for example Dropbox</font>

692
00:32:26,530 --> 00:32:32,740
and<font color="#CCCCCC"> you can upload an eps file</font><font color="#E5E5E5"> and a</font>

693
00:32:30,160 --> 00:32:35,200
preview image<font color="#E5E5E5"> will be created which</font>

694
00:32:32,740 --> 00:32:38,830
executes PostScript and here you can see

695
00:32:35,200 --> 00:32:41,310
an example<font color="#E5E5E5"> of a file</font><font color="#CCCCCC"> system listing</font><font color="#E5E5E5"> also</font>

696
00:32:38,830 --> 00:32:44,649
it's limited the impact because Dropbox

697
00:32:41,310 --> 00:32:46,990
<font color="#E5E5E5">sandbox everything and you can just a</font>

698
00:32:44,650 --> 00:32:48,640
list of files within their<font color="#E5E5E5"> sandbox in</font>

699
00:32:46,990 --> 00:32:51,220
<font color="#E5E5E5">their container so it doesn't really</font>

700
00:32:48,640 --> 00:32:55,960
matter but<font color="#E5E5E5"> not all sides may have</font>

701
00:32:51,220 --> 00:33:00,130
thought<font color="#E5E5E5"> about such issues okay let me</font>

702
00:32:55,960 --> 00:33:04,030
<font color="#CCCCCC">just give you a practical example</font><font color="#E5E5E5"> well I</font>

703
00:33:00,130 --> 00:33:09,640
haven't set a profile here yet for my

704
00:33:04,030 --> 00:33:13,570
<font color="#CCCCCC">August account</font><font color="#E5E5E5"> or I don't</font><font color="#CCCCCC"> like putting</font>

705
00:33:09,640 --> 00:33:19,630
<font color="#E5E5E5">up my image everywhere so let's just</font>

706
00:33:13,570 --> 00:33:21,530
here edit profile<font color="#CCCCCC"> oh where can I</font><font color="#E5E5E5"> update</font>

707
00:33:19,630 --> 00:33:25,400
<font color="#E5E5E5">my</font><font color="#CCCCCC"> social here</font>

708
00:33:21,530 --> 00:33:32,990
so let's just<font color="#E5E5E5"> try to</font><font color="#CCCCCC"> upload some EPS</font>

709
00:33:25,400 --> 00:33:34,760
file<font color="#E5E5E5"> I know they don't know they are</font>

710
00:33:32,990 --> 00:33:37,940
safe<font color="#CCCCCC"> they don't allow</font><font color="#E5E5E5"> me to</font><font color="#CCCCCC"> do that now</font>

711
00:33:34,760 --> 00:33:41,210
<font color="#CCCCCC">maybe maybe</font><font color="#E5E5E5"> if I just read that</font><font color="#CCCCCC"> to to</font>

712
00:33:37,940 --> 00:33:49,880
get<font color="#E5E5E5"> ready that works</font><font color="#CCCCCC"> now let's just try</font>

713
00:33:41,210 --> 00:33:54,530
<font color="#E5E5E5">this</font><font color="#CCCCCC"> again</font><font color="#E5E5E5"> oh oh oh okay with executed</font>

714
00:33:49,880 --> 00:33:58,880
<font color="#CCCCCC">PostScript</font><font color="#E5E5E5"> on that system</font><font color="#CCCCCC"> um which may</font>

715
00:33:54,530 --> 00:34:01,010
or may not be have a great<font color="#E5E5E5"> impact the</font>

716
00:33:58,880 --> 00:34:02,690
impact usually is from listing files to

717
00:34:01,010 --> 00:34:04,970
actually code execution command

718
00:34:02,690 --> 00:34:07,670
execution based<font color="#E5E5E5"> on what the interpreter</font>

719
00:34:04,970 --> 00:34:10,399
allows you to do<font color="#E5E5E5"> usually go script is</font>

720
00:34:07,670 --> 00:34:14,210
used<font color="#E5E5E5"> and we have</font><font color="#CCCCCC"> pre created T cheat</font>

721
00:34:10,399 --> 00:34:17,089
which just performs<font color="#E5E5E5"> I'm about 20 of</font><font color="#CCCCCC"> the</font>

722
00:34:14,210 --> 00:34:19,550
texted most of them are publicly known

723
00:34:17,090 --> 00:34:23,450
<font color="#E5E5E5">or legitimate language features you just</font>

724
00:34:19,550 --> 00:34:27,169
<font color="#E5E5E5">have to upload it somewhere PDF is also</font>

725
00:34:23,449 --> 00:34:29,689
a good<font color="#CCCCCC"> example to use 3m into to PDF</font>

726
00:34:27,168 --> 00:34:32,629
<font color="#CCCCCC">change</font><font color="#E5E5E5"> content type and</font><font color="#CCCCCC"> it will</font>

727
00:34:29,690 --> 00:34:34,490
automatically try to to attack to

728
00:34:32,629 --> 00:34:39,020
perform<font color="#CCCCCC"> most</font><font color="#E5E5E5"> of the attacks and show you</font>

729
00:34:34,489 --> 00:34:43,790
the<font color="#E5E5E5"> results okay now let me come to some</font>

730
00:34:39,020 --> 00:34:49,399
countermeasures<font color="#E5E5E5"> what actually standards</font>

731
00:34:43,790 --> 00:34:51,710
are kind of well<font color="#CCCCCC"> broken</font><font color="#E5E5E5"> because we only</font>

732
00:34:49,399 --> 00:34:53,629
use legitimate features of the

733
00:34:51,710 --> 00:34:57,020
<font color="#CCCCCC">postscript standards</font><font color="#E5E5E5"> to capture print</font>

734
00:34:53,629 --> 00:34:59,390
jobs<font color="#E5E5E5"> and actually</font><font color="#CCCCCC"> well adobe would have</font>

735
00:34:57,020 --> 00:35:00,980
to to update the standard<font color="#E5E5E5"> but</font><font color="#CCCCCC"> i don't</font>

736
00:34:59,390 --> 00:35:03,350
think<font color="#CCCCCC"> such an old standard will be</font>

737
00:35:00,980 --> 00:35:05,630
<font color="#E5E5E5">updated</font><font color="#CCCCCC"> so what can we do</font>

738
00:35:03,350 --> 00:35:09,620
maybe not use<font color="#CCCCCC"> PostScript at all anymore</font>

739
00:35:05,630 --> 00:35:13,100
in<font color="#CCCCCC"> the long</font><font color="#E5E5E5"> term</font><font color="#CCCCCC"> or we can somehow try</font>

740
00:35:09,620 --> 00:35:15,440
<font color="#E5E5E5">to defend ourselves in other ways</font><font color="#CCCCCC"> for</font>

741
00:35:13,100 --> 00:35:17,509
example<font color="#CCCCCC"> um</font><font color="#E5E5E5"> what you should never ever</font>

742
00:35:15,440 --> 00:35:20,180
never never ever do is connect your

743
00:35:17,510 --> 00:35:22,700
<font color="#E5E5E5">printer directly to the internet there</font>

744
00:35:20,180 --> 00:35:25,310
was<font color="#E5E5E5"> an incident in</font><font color="#CCCCCC"> february where some</font>

745
00:35:22,700 --> 00:35:27,859
<font color="#CCCCCC">grey hat hacker printed on</font><font color="#E5E5E5"> 106 mm</font>

746
00:35:25,310 --> 00:35:30,950
printers around the world<font color="#E5E5E5"> and he printed</font>

747
00:35:27,860 --> 00:35:35,090
only<font color="#E5E5E5"> ascii art so um pretty much</font>

748
00:35:30,950 --> 00:35:37,279
friendly stuff<font color="#E5E5E5"> but he could also have</font>

749
00:35:35,090 --> 00:35:40,490
<font color="#E5E5E5">some try to obtain print jobs or to</font>

750
00:35:37,280 --> 00:35:42,530
physically damage the device<font color="#E5E5E5"> okay make</font>

751
00:35:40,490 --> 00:35:45,259
sure especially<font color="#CCCCCC"> in the university</font>

752
00:35:42,530 --> 00:35:48,530
context<font color="#CCCCCC"> where</font><font color="#E5E5E5"> everybody gets public IP</font>

753
00:35:45,260 --> 00:35:50,300
<font color="#E5E5E5">addresses</font><font color="#CCCCCC"> that you do not exhaust</font><font color="#E5E5E5"> your</font>

754
00:35:48,530 --> 00:35:53,450
devices not<font color="#E5E5E5"> only printers to the</font>

755
00:35:50,300 --> 00:35:56,750
<font color="#E5E5E5">internet but else can you do teach your</font>

756
00:35:53,450 --> 00:35:59,060
employees to really<font color="#E5E5E5"> actually keep the</font>

757
00:35:56,750 --> 00:36:03,350
copy room locked<font color="#E5E5E5"> to make it not too easy</font>

758
00:35:59,060 --> 00:36:06,310
for<font color="#E5E5E5"> a physical attacker to</font><font color="#CCCCCC"> to to infect</font>

759
00:36:03,350 --> 00:36:08,630
<font color="#E5E5E5">your devices with</font><font color="#CCCCCC"> posted more</font><font color="#E5E5E5"> their</font>

760
00:36:06,310 --> 00:36:11,029
administrators<font color="#E5E5E5"> should think about</font>

761
00:36:08,630 --> 00:36:13,010
sandboxing the printers individually and

762
00:36:11,030 --> 00:36:15,080
it is only accessible through<font color="#E5E5E5"> a hardened</font>

763
00:36:13,010 --> 00:36:18,370
print server which is currently<font color="#CCCCCC"> the only</font>

764
00:36:15,080 --> 00:36:20,480
<font color="#E5E5E5">way</font><font color="#CCCCCC"> to actually mighty</font><font color="#E5E5E5"> gate the attacks</font>

765
00:36:18,370 --> 00:36:22,400
printer vendors should think about

766
00:36:20,480 --> 00:36:25,340
undoing<font color="#CCCCCC"> insecure design decisions like</font>

767
00:36:22,400 --> 00:36:27,470
coast trip like proprietary<font color="#CCCCCC"> pgl commands</font>

768
00:36:25,340 --> 00:36:30,800
<font color="#E5E5E5">like data and killed over the same</font>

769
00:36:27,470 --> 00:36:34,100
<font color="#E5E5E5">channel and finally</font><font color="#CCCCCC"> browser vendors</font>

770
00:36:30,800 --> 00:36:36,200
should<font color="#E5E5E5"> consider blocking</font><font color="#CCCCCC"> prod 9100</font><font color="#E5E5E5"> it's</font>

771
00:36:34,100 --> 00:36:38,630
really<font color="#E5E5E5"> not their fault but they can</font>

772
00:36:36,200 --> 00:36:42,799
<font color="#CCCCCC">actually prevent cross-site fringing</font>

773
00:36:38,630 --> 00:36:45,050
attacks against printer devices<font color="#E5E5E5"> in the</font>

774
00:36:42,800 --> 00:36:47,660
end<font color="#CCCCCC"> however</font><font color="#E5E5E5"> it is up to the to the</font>

775
00:36:45,050 --> 00:36:50,600
printer vendors to roll out new<font color="#E5E5E5"> firmware</font>

776
00:36:47,660 --> 00:36:53,629
and to to update the standards and to

777
00:36:50,600 --> 00:36:56,930
produce new produce security<font color="#E5E5E5"> vices in</font>

778
00:36:53,630 --> 00:36:59,960
the long term<font color="#CCCCCC"> okay let</font><font color="#E5E5E5"> me come to</font>

779
00:36:56,930 --> 00:37:01,790
conclusion with from the<font color="#E5E5E5"> systemic</font>

780
00:36:59,960 --> 00:37:04,550
<font color="#CCCCCC">analyzers</font><font color="#E5E5E5"> or</font><font color="#CCCCCC"> preferred printers and</font>

781
00:37:01,790 --> 00:37:07,100
printing standards and proven that<font color="#E5E5E5"> those</font>

782
00:37:04,550 --> 00:37:09,470
<font color="#CCCCCC">pgl and PostScript from the standard and</font>

783
00:37:07,100 --> 00:37:12,380
from the<font color="#CCCCCC"> implementation is quite um</font>

784
00:37:09,470 --> 00:37:14,029
insecure<font color="#CCCCCC"> and we have applied to the</font>

785
00:37:12,380 --> 00:37:17,630
attacks<font color="#E5E5E5"> to different areas for example</font>

786
00:37:14,030 --> 00:37:20,060
<font color="#CCCCCC">two</font><font color="#E5E5E5"> websites we also want to do some</font>

787
00:37:17,630 --> 00:37:22,790
research<font color="#CCCCCC"> for example assess firmware</font>

788
00:37:20,060 --> 00:37:26,600
updates are deployed as ordinary print

789
00:37:22,790 --> 00:37:28,730
<font color="#CCCCCC">jobs and with analyzed 2400 firmware</font>

790
00:37:26,600 --> 00:37:32,000
files from the top<font color="#CCCCCC"> 10</font><font color="#E5E5E5"> vendors and all of</font>

791
00:37:28,730 --> 00:37:33,590
them do like this<font color="#E5E5E5"> accessing this X to a</font>

792
00:37:32,000 --> 00:37:35,210
branch of may also be interesting

793
00:37:33,590 --> 00:37:38,000
because the attacker gets access<font color="#CCCCCC"> to this</font>

794
00:37:35,210 --> 00:37:40,340
online<font color="#E5E5E5"> and trade 3d printers may also be</font>

795
00:37:38,000 --> 00:37:44,720
an interesting<font color="#E5E5E5"> area of</font><font color="#CCCCCC"> research to adapt</font>

796
00:37:40,340 --> 00:37:48,200
<font color="#CCCCCC">at</font><font color="#E5E5E5"> X</font><font color="#CCCCCC"> 2 okay let</font><font color="#E5E5E5"> me come to an end of the</font>

797
00:37:44,720 --> 00:37:48,859
talk the<font color="#CCCCCC"> the print exploitation to a</font><font color="#E5E5E5"> kid</font>

798
00:37:48,200 --> 00:37:50,899
threat

799
00:37:48,859 --> 00:37:53,029
is freely available on<font color="#E5E5E5"> github</font><font color="#CCCCCC"> you can</font>

800
00:37:50,900 --> 00:37:55,609
<font color="#CCCCCC">use it to to analyze</font><font color="#E5E5E5"> your printer</font><font color="#CCCCCC"> give</font>

801
00:37:53,029 --> 00:37:58,160
me some feedback<font color="#E5E5E5"> and if you are</font>

802
00:37:55,609 --> 00:38:00,680
interested in the technical<font color="#CCCCCC"> details of</font>

803
00:37:58,160 --> 00:38:06,410
the attacks<font color="#E5E5E5"> we have set up a wiki where</font>

804
00:38:00,680 --> 00:38:09,999
you can read everything in detail<font color="#CCCCCC"> okay</font>

805
00:38:06,410 --> 00:38:09,999
do you have any questions

806
00:38:41,950 --> 00:38:47,390
that's pretty<font color="#E5E5E5"> much a good question now</font>

807
00:38:44,450 --> 00:38:50,118
most printers will interpret is it as a

808
00:38:47,390 --> 00:38:53,808
<font color="#E5E5E5">plain text drink shop and</font><font color="#CCCCCC"> printed to</font>

809
00:38:50,119 --> 00:38:55,400
paper so the HTTP header of the<font color="#E5E5E5"> attack</font>

810
00:38:53,809 --> 00:38:58,969
including<font color="#CCCCCC"> the erection where the attack</font>

811
00:38:55,400 --> 00:39:00,589
came<font color="#CCCCCC"> from may be printed on paper</font><font color="#E5E5E5"> so if</font>

812
00:38:58,969 --> 00:39:02,239
you<font color="#E5E5E5"> find</font><font color="#CCCCCC"> it on your printer you may be</font>

813
00:39:00,589 --> 00:39:05,420
<font color="#E5E5E5">victim of a cross-site printing attack</font>

814
00:39:02,239 --> 00:39:07,719
<font color="#E5E5E5">you can</font><font color="#CCCCCC"> actually prevent this by</font>

815
00:39:05,420 --> 00:39:09,950
disabling printing functionality<font color="#CCCCCC"> first</font>

816
00:39:07,719 --> 00:39:13,190
but there is a bit tricky<font color="#E5E5E5"> and</font>

817
00:39:09,950 --> 00:39:25,968
<font color="#CCCCCC">model-specific so yes the attacker may</font>

818
00:39:13,190 --> 00:39:29,119
be a bit noisy now it's not a new name

819
00:39:25,969 --> 00:39:33,079
<font color="#E5E5E5">actually it was the term cross-eyed</font>

820
00:39:29,119 --> 00:39:36,079
printing and sending data<font color="#CCCCCC"> to</font><font color="#E5E5E5"> to port</font>

821
00:39:33,079 --> 00:39:38,890
<font color="#CCCCCC">9100 of a printer to a</font><font color="#E5E5E5"> web</font><font color="#CCCCCC"> browser</font><font color="#E5E5E5"> was</font>

822
00:39:36,079 --> 00:39:41,930
invented by<font color="#CCCCCC"> iron</font><font color="#E5E5E5"> weaver in 2007 already</font>

823
00:39:38,890 --> 00:39:44,890
without the course proving thing so the

824
00:39:41,930 --> 00:39:44,890
term is<font color="#E5E5E5"> pretty much out</font>

825
00:39:53,380 --> 00:39:56,590
<font color="#CCCCCC">sure yeah</font>

826
00:40:11,810 --> 00:40:21,330
<font color="#CCCCCC">hmm</font><font color="#E5E5E5"> okay the question is is if we can</font>

827
00:40:19,080 --> 00:40:25,020
use the printer to escalate really into

828
00:40:21,330 --> 00:40:27,630
the network and<font color="#E5E5E5"> actually no not in a</font>

829
00:40:25,020 --> 00:40:30,450
generic<font color="#CCCCCC"> way like post-trip does not</font>

830
00:40:27,630 --> 00:40:32,310
allow you for example<font color="#CCCCCC"> to from the</font>

831
00:40:30,450 --> 00:40:34,080
standard to speak to the VIP and

832
00:40:32,310 --> 00:40:35,460
therefore escalate yourself<font color="#E5E5E5"> into the</font>

833
00:40:34,080 --> 00:40:37,440
network<font color="#E5E5E5"> yes</font>

834
00:40:35,460 --> 00:40:40,230
proprietary extension for example<font color="#E5E5E5"> your</font>

835
00:40:37,440 --> 00:40:42,120
clerics printers allow you to speak<font color="#CCCCCC"> to</font>

836
00:40:40,230 --> 00:40:44,010
<font color="#CCCCCC">the VIP</font><font color="#E5E5E5"> in PostScript but it's not</font>

837
00:40:42,120 --> 00:40:45,690
generic<font color="#E5E5E5"> on other printers you</font><font color="#CCCCCC"> can access</font>

838
00:40:44,010 --> 00:40:48,690
the file system<font color="#CCCCCC"> all right</font>

839
00:40:45,690 --> 00:40:53,070
some RC startup files and therefore get

840
00:40:48,690 --> 00:40:55,680
code execution and then again<font color="#E5E5E5"> try to get</font>

841
00:40:53,070 --> 00:40:59,660
into the network<font color="#E5E5E5"> but this is very model</font>

842
00:40:55,680 --> 00:40:59,660
specific and not generic

843
00:41:10,210 --> 00:41:13,960
<font color="#E5E5E5">okay then thanks again</font>

