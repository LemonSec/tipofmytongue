1
00:00:02,570 --> 00:00:08,420
cause<font color="#CCCCCC"> misconfigurations good afternoon</font>

2
00:00:06,200 --> 00:00:09,559
and<font color="#CCCCCC"> welcome to</font><font color="#E5E5E5"> exploiting cause</font>

3
00:00:08,420 --> 00:00:13,370
misconfigurations

4
00:00:09,559 --> 00:00:15,950
for bitcoins and bounties have you ever

5
00:00:13,370 --> 00:00:18,919
<font color="#E5E5E5">looks at a Bitcoin exchange and wondered</font>

6
00:00:15,950 --> 00:00:20,720
how hard it would be to hack<font color="#E5E5E5"> perhaps you</font>

7
00:00:18,920 --> 00:00:22,550
<font color="#E5E5E5">heard about the recent theft of</font><font color="#CCCCCC"> 60</font>

8
00:00:20,720 --> 00:00:25,250
million<font color="#E5E5E5"> dollars worth of bitcoins from</font>

9
00:00:22,550 --> 00:00:28,279
BitFenix<font color="#CCCCCC"> and thought</font><font color="#E5E5E5"> I wonder if I could</font>

10
00:00:25,250 --> 00:00:30,770
<font color="#CCCCCC">have done that maybe you even took</font><font color="#E5E5E5"> a</font>

11
00:00:28,279 --> 00:00:33,199
look at a Bitcoin exchange and<font color="#E5E5E5"> you saw a</font>

12
00:00:30,770 --> 00:00:35,510
tangled mess<font color="#E5E5E5"> of web sockets sub resource</font>

13
00:00:33,199 --> 00:00:37,670
integrity content security policy web

14
00:00:35,510 --> 00:00:39,620
application firewalls cross-origin

15
00:00:37,670 --> 00:00:43,280
resource sharing and thought that looks

16
00:00:39,620 --> 00:00:45,440
like quite a<font color="#E5E5E5"> lot of work to hack in this</font>

17
00:00:43,280 --> 00:00:48,350
session<font color="#E5E5E5"> I'll share with you how causes</font>

18
00:00:45,440 --> 00:00:49,068
simplicity<font color="#E5E5E5"> is its weakness how that</font>

19
00:00:48,350 --> 00:00:50,629
<font color="#E5E5E5">weakness</font>

20
00:00:49,069 --> 00:00:52,940
leads<font color="#CCCCCC"> to some really</font><font color="#E5E5E5"> interesting</font>

21
00:00:50,629 --> 00:00:57,739
<font color="#E5E5E5">problems and how to exploit those</font>

22
00:00:52,940 --> 00:01:00,498
problems<font color="#E5E5E5"> to</font><font color="#CCCCCC"> steal bitcoins around</font><font color="#E5E5E5"> seven</font>

23
00:00:57,739 --> 00:01:01,998
years<font color="#CCCCCC"> ago I just got into security and I</font>

24
00:01:00,499 --> 00:01:04,640
just read about<font color="#E5E5E5"> these really cool things</font>

25
00:01:01,999 --> 00:01:06,170
called buffer overflows<font color="#E5E5E5"> so on this</font>

26
00:01:04,640 --> 00:01:08,390
particular<font color="#CCCCCC"> evening I was trying to</font>

27
00:01:06,170 --> 00:01:10,460
<font color="#E5E5E5">exploit a buffer overflow</font><font color="#CCCCCC"> in an FTP</font>

28
00:01:08,390 --> 00:01:14,210
<font color="#E5E5E5">service by typing really long URLs in</font>

29
00:01:10,460 --> 00:01:15,679
Firefox<font color="#E5E5E5"> and Firefox crashed so I thought</font>

30
00:01:14,210 --> 00:01:18,710
great<font color="#E5E5E5"> I found a buffer overflow in</font>

31
00:01:15,680 --> 00:01:20,450
Firefox<font color="#E5E5E5"> and I went on the slackers IRC</font>

32
00:01:18,710 --> 00:01:21,380
channel to ask what shall I do<font color="#CCCCCC"> with this</font>

33
00:01:20,450 --> 00:01:22,820
for<font color="#CCCCCC"> a moment code execution</font>

34
00:01:21,380 --> 00:01:26,539
vulnerability that<font color="#E5E5E5"> I'm just about</font><font color="#CCCCCC"> to</font>

35
00:01:22,820 --> 00:01:28,789
have<font color="#E5E5E5"> in Firefox</font><font color="#CCCCCC"> and they told me</font><font color="#E5E5E5"> about</font>

36
00:01:26,540 --> 00:01:31,400
this<font color="#CCCCCC"> website and I can't tell you the</font>

37
00:01:28,790 --> 00:01:34,400
real name<font color="#E5E5E5"> but I'm going to call it we</font>

38
00:01:31,400 --> 00:01:36,710
<font color="#E5E5E5">buy own day and the way the</font><font color="#CCCCCC"> side works</font>

39
00:01:34,400 --> 00:01:39,110
is anyone can sign<font color="#E5E5E5"> up</font><font color="#CCCCCC"> to it</font><font color="#E5E5E5"> and submit</font>

40
00:01:36,710 --> 00:01:41,990
the details of a critical vulnerability

41
00:01:39,110 --> 00:01:45,800
in a<font color="#E5E5E5"> widely used piece of</font><font color="#CCCCCC"> software</font><font color="#E5E5E5"> like</font>

42
00:01:41,990 --> 00:01:48,470
Firefox<font color="#E5E5E5"> and their team</font><font color="#CCCCCC"> of internal</font>

43
00:01:45,800 --> 00:01:51,110
experts will<font color="#CCCCCC"> evaluate this vulnerability</font>

44
00:01:48,470 --> 00:01:53,090
<font color="#E5E5E5">and if they like</font><font color="#CCCCCC"> it they'll make an</font>

45
00:01:51,110 --> 00:01:55,730
offer to buy<font color="#CCCCCC"> the intellectual property</font>

46
00:01:53,090 --> 00:01:57,380
from<font color="#CCCCCC"> you and if you</font><font color="#E5E5E5"> accept the offer</font>

47
00:01:55,730 --> 00:01:59,870
then they get it if you reject<font color="#E5E5E5"> the</font><font color="#CCCCCC"> offer</font>

48
00:01:57,380 --> 00:02:02,210
or they<font color="#E5E5E5"> don't make any offer then they</font>

49
00:01:59,870 --> 00:02:05,090
will act as though<font color="#CCCCCC"> they never seen that</font>

50
00:02:02,210 --> 00:02:07,039
vulnerability<font color="#E5E5E5"> so it's a system built on</font>

51
00:02:05,090 --> 00:02:09,649
trust<font color="#CCCCCC"> you have to trust that the company</font>

52
00:02:07,040 --> 00:02:12,200
will do what they say but it<font color="#E5E5E5"> was quite a</font>

53
00:02:09,649 --> 00:02:15,709
widely respected company so it seemed

54
00:02:12,200 --> 00:02:16,339
like it works<font color="#E5E5E5"> and I try to</font><font color="#CCCCCC"> build an</font>

55
00:02:15,709 --> 00:02:18,319
exploit

56
00:02:16,340 --> 00:02:20,060
this stuff<font color="#E5E5E5"> overflow turned out it wasn't</font>

57
00:02:18,319 --> 00:02:22,220
<font color="#E5E5E5">it was a denial</font><font color="#CCCCCC"> of service but</font><font color="#E5E5E5"> anyway I</font>

58
00:02:20,060 --> 00:02:23,900
submitted it anyway<font color="#CCCCCC"> why not and while</font>

59
00:02:22,220 --> 00:02:25,849
<font color="#E5E5E5">submitting it</font><font color="#CCCCCC"> I noticed</font><font color="#E5E5E5"> that this</font>

60
00:02:23,900 --> 00:02:28,730
website<font color="#E5E5E5"> didn't have any cross-site</font>

61
00:02:25,849 --> 00:02:30,649
request forgery tokens anywhere and I

62
00:02:28,730 --> 00:02:32,899
thought okay<font color="#E5E5E5"> that's a bit weird</font><font color="#CCCCCC"> looks</font>

63
00:02:30,650 --> 00:02:34,730
like I can't really make a page which

64
00:02:32,900 --> 00:02:36,920
will<font color="#E5E5E5"> change someone's email</font><font color="#CCCCCC"> address and</font>

65
00:02:34,730 --> 00:02:38,869
hijack their<font color="#E5E5E5"> account and get me</font><font color="#CCCCCC"> access</font>

66
00:02:36,920 --> 00:02:42,319
to<font color="#CCCCCC"> all their</font><font color="#E5E5E5"> zero dates that's kind of</font>

67
00:02:38,870 --> 00:02:44,930
cool<font color="#CCCCCC"> and then I thought what</font><font color="#E5E5E5"> should</font><font color="#CCCCCC"> I do</font>

68
00:02:42,319 --> 00:02:48,798
with this<font color="#CCCCCC"> vulnerability I know what to</font>

69
00:02:44,930 --> 00:02:49,220
do<font color="#CCCCCC"> I'll sell it to</font><font color="#E5E5E5"> these guys</font><font color="#CCCCCC"> so an hey</font>

70
00:02:48,799 --> 00:02:52,430
there

71
00:02:49,220 --> 00:02:54,079
I found this vulnerability<font color="#CCCCCC"> it's not in a</font>

72
00:02:52,430 --> 00:02:56,690
<font color="#E5E5E5">widely used piece</font><font color="#CCCCCC"> of software</font><font color="#E5E5E5"> but it</font>

73
00:02:54,079 --> 00:02:59,930
isn't your<font color="#E5E5E5"> website and it can be used to</font>

74
00:02:56,690 --> 00:03:02,030
<font color="#E5E5E5">hijack people's account</font><font color="#CCCCCC"> would you prefer</font>

75
00:02:59,930 --> 00:03:04,340
<font color="#E5E5E5">to buy this vulnerability</font><font color="#CCCCCC"> from me</font><font color="#E5E5E5"> or</font>

76
00:03:02,030 --> 00:03:08,420
would<font color="#E5E5E5"> you rather act like you never knew</font>

77
00:03:04,340 --> 00:03:10,700
it even<font color="#E5E5E5"> existed and somewhat predictably</font>

78
00:03:08,420 --> 00:03:12,048
they ended up<font color="#E5E5E5"> buying it from me</font><font color="#CCCCCC"> and at</font>

79
00:03:10,700 --> 00:03:14,629
the time I was pretty<font color="#E5E5E5"> happy with</font><font color="#CCCCCC"> that</font>

80
00:03:12,049 --> 00:03:17,450
outcome<font color="#CCCCCC"> in</font><font color="#E5E5E5"> effect that was the first bug</font>

81
00:03:14,629 --> 00:03:20,298
bounty that I ever got<font color="#E5E5E5"> but in retrospect</font>

82
00:03:17,450 --> 00:03:22,670
<font color="#CCCCCC">I have to wonder how a security company</font>

83
00:03:20,299 --> 00:03:26,030
<font color="#CCCCCC">that's staffed by an internal team of</font>

84
00:03:22,670 --> 00:03:29,089
<font color="#E5E5E5">security</font><font color="#CCCCCC"> experts</font><font color="#E5E5E5"> where all the users are</font>

85
00:03:26,030 --> 00:03:31,970
also<font color="#E5E5E5"> security experts that's full of</font>

86
00:03:29,090 --> 00:03:33,139
easily<font color="#E5E5E5"> sold intellectual property can</font>

87
00:03:31,970 --> 00:03:35,269
<font color="#E5E5E5">have a trivial cross-site request</font>

88
00:03:33,139 --> 00:03:40,280
forgery vulnerability<font color="#E5E5E5"> that's really easy</font>

89
00:03:35,269 --> 00:03:43,849
<font color="#E5E5E5">to find and exploit</font><font color="#CCCCCC"> I think the only</font>

90
00:03:40,280 --> 00:03:45,709
<font color="#CCCCCC">answer is</font><font color="#E5E5E5"> the back in 2009 awareness of</font>

91
00:03:43,849 --> 00:03:47,569
cross my request for<font color="#CCCCCC"> you was just really</font>

92
00:03:45,709 --> 00:03:50,150
<font color="#E5E5E5">poor the vulnerabilities were there they</font>

93
00:03:47,569 --> 00:03:52,369
were easy to find<font color="#E5E5E5"> but nobody was looking</font>

94
00:03:50,150 --> 00:03:55,400
for them and<font color="#E5E5E5"> what I'm going</font><font color="#CCCCCC"> to show</font><font color="#E5E5E5"> you</font>

95
00:03:52,370 --> 00:04:01,130
today is<font color="#E5E5E5"> that</font><font color="#CCCCCC"> thats where causes at the</font>

96
00:03:55,400 --> 00:04:03,200
moment first I'll talk<font color="#E5E5E5"> very briefly</font>

97
00:04:01,130 --> 00:04:05,840
about<font color="#E5E5E5"> the fundamentals of</font><font color="#CCCCCC"> cause</font><font color="#E5E5E5"> from a</font>

98
00:04:03,200 --> 00:04:07,638
hackers point of view and I'll focus on

99
00:04:05,840 --> 00:04:11,510
<font color="#E5E5E5">various limitations</font><font color="#CCCCCC"> that are in the</font>

100
00:04:07,639 --> 00:04:13,700
cause design and implementation and the

101
00:04:11,510 --> 00:04:16,279
<font color="#CCCCCC">workarounds that</font><font color="#E5E5E5"> real websites end up</font>

102
00:04:13,700 --> 00:04:17,839
doing to handle<font color="#E5E5E5"> these limitations</font><font color="#CCCCCC"> and</font>

103
00:04:16,279 --> 00:04:20,179
then I'll<font color="#CCCCCC"> look at what goes wrong</font><font color="#E5E5E5"> with</font>

104
00:04:17,839 --> 00:04:22,520
these<font color="#CCCCCC"> workarounds and how we can</font><font color="#E5E5E5"> use it</font>

105
00:04:20,180 --> 00:04:25,070
to<font color="#E5E5E5"> steal bitcoins and hack various other</font>

106
00:04:22,520 --> 00:04:27,229
sites and then I'll look at some<font color="#CCCCCC"> more</font>

107
00:04:25,070 --> 00:04:29,960
esoteric issues and ways<font color="#CCCCCC"> to</font><font color="#E5E5E5"> exploit</font>

108
00:04:27,229 --> 00:04:31,669
causes that are a bit less<font color="#CCCCCC"> obvious</font>

109
00:04:29,960 --> 00:04:33,138
and then I'll<font color="#E5E5E5"> talk about various</font>

110
00:04:31,669 --> 00:04:35,270
mitigations<font color="#E5E5E5"> that browser vendors</font>

111
00:04:33,139 --> 00:04:39,970
specification authors and developers<font color="#E5E5E5"> can</font>

112
00:04:35,270 --> 00:04:39,969
take<font color="#E5E5E5"> and take five</font><font color="#CCCCCC"> minutes</font><font color="#E5E5E5"> of questions</font>

113
00:04:40,720 --> 00:04:46,160
<font color="#E5E5E5">so who's here who here is already</font>

114
00:04:44,180 --> 00:04:50,570
<font color="#E5E5E5">familiar with the basics</font><font color="#CCCCCC"> of how courts</font>

115
00:04:46,160 --> 00:04:52,460
works<font color="#CCCCCC"> okay cool most of you that's good</font>

116
00:04:50,570 --> 00:04:53,690
if you're not this one<font color="#CCCCCC"> sliders who</font>

117
00:04:52,460 --> 00:04:57,349
you're<font color="#E5E5E5"> going to get so please pay</font>

118
00:04:53,690 --> 00:05:00,770
attention<font color="#E5E5E5"> cause is about what a website</font>

119
00:04:57,350 --> 00:05:03,199
<font color="#CCCCCC">can make your web browser</font><font color="#E5E5E5"> do I say the</font>

120
00:05:00,770 --> 00:05:06,409
<font color="#CCCCCC">Eurozone</font><font color="#E5E5E5"> Gmail and you want to let users</font>

121
00:05:03,199 --> 00:05:08,210
embed their<font color="#CCCCCC"> Dropbox files you can</font><font color="#E5E5E5"> easily</font>

122
00:05:06,410 --> 00:05:10,970
make the<font color="#E5E5E5"> users web</font><font color="#CCCCCC"> browsers send a</font>

123
00:05:08,210 --> 00:05:13,489
request<font color="#E5E5E5"> to Dropbox and Dropbox will send</font>

124
00:05:10,970 --> 00:05:15,380
the response but the web browser won't

125
00:05:13,490 --> 00:05:17,360
<font color="#E5E5E5">let Gmail read the response from Dropbox</font>

126
00:05:15,380 --> 00:05:20,710
<font color="#E5E5E5">thanks to the same</font><font color="#CCCCCC"> origin</font><font color="#E5E5E5"> policy which</font>

127
00:05:17,360 --> 00:05:22,669
is like what<font color="#E5E5E5"> underpins most web security</font>

128
00:05:20,710 --> 00:05:25,010
but say<font color="#CCCCCC"> that</font><font color="#E5E5E5"> Dropbox</font>

129
00:05:22,669 --> 00:05:27,889
<font color="#E5E5E5">actually trusts Gmail and thinks they</font>

130
00:05:25,010 --> 00:05:30,020
have a reasonably secure<font color="#CCCCCC"> setup</font><font color="#E5E5E5"> I want to</font>

131
00:05:27,889 --> 00:05:31,940
let Gmail embed their users files

132
00:05:30,020 --> 00:05:34,250
that's where cross-origin resource

133
00:05:31,940 --> 00:05:37,580
sharing comes in they can specify<font color="#E5E5E5"> this</font>

134
00:05:34,250 --> 00:05:39,949
HTTP header which says they trust<font color="#E5E5E5"> Gmail</font>

135
00:05:37,580 --> 00:05:41,960
<font color="#E5E5E5">and the web browser will compare the</font>

136
00:05:39,949 --> 00:05:43,880
origin its own<font color="#E5E5E5"> mail or Google</font><font color="#CCCCCC"> comm with</font>

137
00:05:41,960 --> 00:05:45,409
<font color="#E5E5E5">the one specified in this header and if</font>

138
00:05:43,880 --> 00:05:49,580
they match then it gives<font color="#E5E5E5"> access to that</font>

139
00:05:45,409 --> 00:05:52,310
content<font color="#E5E5E5"> now by</font><font color="#CCCCCC"> itself</font><font color="#E5E5E5"> that header only</font>

140
00:05:49,580 --> 00:05:54,620
gives access<font color="#CCCCCC"> to</font><font color="#E5E5E5"> users public files on</font>

141
00:05:52,310 --> 00:05:57,050
Dropbox if job box wanted to let Gmail

142
00:05:54,620 --> 00:05:59,570
embed<font color="#E5E5E5"> users private files those</font><font color="#CCCCCC"> has to</font>

143
00:05:57,050 --> 00:06:01,580
<font color="#CCCCCC">add this additional header which is</font>

144
00:05:59,570 --> 00:06:04,070
<font color="#CCCCCC">called</font><font color="#E5E5E5"> allow credentials</font><font color="#CCCCCC"> and set it to</font>

145
00:06:01,580 --> 00:06:06,530
<font color="#CCCCCC">true that means that the web browser</font>

146
00:06:04,070 --> 00:06:08,570
<font color="#E5E5E5">will send the</font><font color="#CCCCCC"> user the users cookies</font>

147
00:06:06,530 --> 00:06:13,429
when it fetches<font color="#E5E5E5"> this file and so private</font>

148
00:06:08,570 --> 00:06:15,199
files can be<font color="#CCCCCC"> accessed too so that's the</font>

149
00:06:13,430 --> 00:06:17,419
core concept of course as all a hacker

150
00:06:15,199 --> 00:06:20,570
really needs<font color="#CCCCCC"> to</font><font color="#E5E5E5"> know about the</font><font color="#CCCCCC"> basics of</font>

151
00:06:17,419 --> 00:06:21,948
how<font color="#E5E5E5"> it works and from that it doesn't</font>

152
00:06:20,570 --> 00:06:24,440
<font color="#E5E5E5">sound like there's</font><font color="#CCCCCC"> very much potential</font>

153
00:06:21,949 --> 00:06:27,880
<font color="#E5E5E5">for</font><font color="#CCCCCC"> things to go wrong and as long as</font>

154
00:06:24,440 --> 00:06:31,219
Dropbox doesn't like<font color="#CCCCCC"> tri-polar</font><font color="#E5E5E5"> header or</font>

155
00:06:27,880 --> 00:06:34,820
Gmail doesn't<font color="#E5E5E5"> get hacked then it's not</font>

156
00:06:31,220 --> 00:06:36,979
<font color="#E5E5E5">too bad but what if Dropbox decides the</font>

157
00:06:34,820 --> 00:06:38,930
<font color="#CCCCCC">Yahoo Mail also has a highly secure</font>

158
00:06:36,979 --> 00:06:42,529
operation and they want<font color="#E5E5E5"> to trust your</font>

159
00:06:38,930 --> 00:06:43,370
email<font color="#E5E5E5"> - you might think from</font><font color="#CCCCCC"> reading the</font>

160
00:06:42,529 --> 00:06:46,159
specification

161
00:06:43,370 --> 00:06:48,770
that job box<font color="#E5E5E5"> could specify a list of</font>

162
00:06:46,160 --> 00:06:50,240
origins which they trust<font color="#E5E5E5"> but in practice</font>

163
00:06:48,770 --> 00:06:54,560
<font color="#CCCCCC">that doesn't work</font><font color="#E5E5E5"> you can only ever</font>

164
00:06:50,240 --> 00:06:57,080
specify one origin<font color="#E5E5E5"> so what do you do if</font>

165
00:06:54,560 --> 00:06:59,680
you want<font color="#E5E5E5"> to trust most</font><font color="#CCCCCC"> college uns</font><font color="#E5E5E5"> well</font>

166
00:06:57,080 --> 00:07:02,719
hold<font color="#E5E5E5"> that thought</font>

167
00:06:59,680 --> 00:07:05,120
also what if you want to trust all

168
00:07:02,720 --> 00:07:07,880
<font color="#E5E5E5">subdomains of your site</font><font color="#CCCCCC"> you might know</font>

169
00:07:05,120 --> 00:07:09,830
<font color="#CCCCCC">that cause supports wildcards</font><font color="#E5E5E5"> but</font>

170
00:07:07,880 --> 00:07:12,710
<font color="#CCCCCC">unfortunately the only</font><font color="#E5E5E5"> wildcard it</font>

171
00:07:09,830 --> 00:07:14,810
supports<font color="#E5E5E5"> is a star on its own</font><font color="#CCCCCC"> you can</font>

172
00:07:12,710 --> 00:07:17,719
<font color="#CCCCCC">say you trust all lava jhin's</font><font color="#E5E5E5"> you can</font>

173
00:07:14,810 --> 00:07:20,510
say you trust<font color="#E5E5E5"> one specific</font><font color="#CCCCCC"> halogen</font><font color="#E5E5E5"> but</font>

174
00:07:17,720 --> 00:07:22,220
your car say I trust all<font color="#E5E5E5"> my subdomains</font>

175
00:07:20,510 --> 00:07:25,180
or<font color="#E5E5E5"> something like that which seems to be</font>

176
00:07:22,220 --> 00:07:28,520
quite a common use case in real sites

177
00:07:25,180 --> 00:07:30,169
also<font color="#E5E5E5"> there's a special exception with</font>

178
00:07:28,520 --> 00:07:32,120
the<font color="#E5E5E5"> way that the</font><font color="#CCCCCC"> wild-card has treated</font>

179
00:07:30,169 --> 00:07:33,710
<font color="#CCCCCC">which is if you use</font><font color="#E5E5E5"> the wild-card in</font>

180
00:07:32,120 --> 00:07:36,560
<font color="#CCCCCC">conjunction with the allow credentials</font>

181
00:07:33,710 --> 00:07:40,880
header web browsers will ignore that

182
00:07:36,560 --> 00:07:43,010
<font color="#CCCCCC">allow</font><font color="#E5E5E5"> credential</font><font color="#CCCCCC"> setup this kind of</font>

183
00:07:40,880 --> 00:07:44,690
makes sense<font color="#E5E5E5"> because if you browse</font><font color="#CCCCCC"> the</font>

184
00:07:43,010 --> 00:07:47,690
web you'll find random sites like

185
00:07:44,690 --> 00:07:49,789
developers mozilla.org<font color="#E5E5E5"> that inexplicably</font>

186
00:07:47,690 --> 00:07:52,450
say they want to trust<font color="#E5E5E5"> all their private</font>

187
00:07:49,789 --> 00:07:55,130
data<font color="#E5E5E5"> with every web</font><font color="#CCCCCC"> site on the internet</font>

188
00:07:52,450 --> 00:07:57,680
<font color="#CCCCCC">but so in</font><font color="#E5E5E5"> fact so this looks really</font>

189
00:07:55,130 --> 00:08:02,630
scary<font color="#E5E5E5"> but in fact it's not</font><font color="#CCCCCC"> actually</font>

190
00:07:57,680 --> 00:08:04,700
<font color="#E5E5E5">about that so what do you do if you want</font>

191
00:08:02,630 --> 00:08:07,250
<font color="#CCCCCC">to</font><font color="#E5E5E5"> trust multiple origins or all of your</font>

192
00:08:04,700 --> 00:08:10,250
subdomains<font color="#E5E5E5"> you've only got one choice</font>

193
00:08:07,250 --> 00:08:12,050
<font color="#E5E5E5">which is</font><font color="#CCCCCC"> to dynamically inspect</font><font color="#E5E5E5"> their</font>

194
00:08:10,250 --> 00:08:15,560
incoming<font color="#E5E5E5"> origin header from</font><font color="#CCCCCC"> the browser</font>

195
00:08:12,050 --> 00:08:18,470
<font color="#E5E5E5">and decide if you trust it and if you do</font>

196
00:08:15,560 --> 00:08:20,930
<font color="#E5E5E5">trust it reflect it</font><font color="#CCCCCC"> back to the user</font><font color="#E5E5E5"> and</font>

197
00:08:18,470 --> 00:08:24,889
<font color="#E5E5E5">making that flash is the</font><font color="#CCCCCC"> only</font><font color="#E5E5E5"> way I can</font>

198
00:08:20,930 --> 00:08:27,620
<font color="#CCCCCC">do justice to how bad it is it's bad</font>

199
00:08:24,889 --> 00:08:29,240
<font color="#E5E5E5">because it's much more likely</font><font color="#CCCCCC"> to be</font>

200
00:08:27,620 --> 00:08:31,490
<font color="#E5E5E5">vulnerable</font><font color="#CCCCCC"> you've gone</font><font color="#E5E5E5"> from a static</font>

201
00:08:29,240 --> 00:08:33,380
hard-coded value to something that's

202
00:08:31,490 --> 00:08:36,260
dynamically generated<font color="#E5E5E5"> based on user</font>

203
00:08:33,380 --> 00:08:38,510
input<font color="#CCCCCC"> but it's even</font><font color="#E5E5E5"> worse</font><font color="#CCCCCC"> than that</font>

204
00:08:36,260 --> 00:08:41,569
<font color="#E5E5E5">because it's</font><font color="#CCCCCC"> also</font><font color="#E5E5E5"> somewhat I can tell</font>

205
00:08:38,510 --> 00:08:45,110
much less likely to<font color="#CCCCCC"> be discovered during</font>

206
00:08:41,570 --> 00:08:48,050
<font color="#CCCCCC">a pen test because if you</font><font color="#E5E5E5"> don't send any</font>

207
00:08:45,110 --> 00:08:50,029
<font color="#E5E5E5">course headers when you're browsing</font><font color="#CCCCCC"> when</font>

208
00:08:48,050 --> 00:08:51,829
you're<font color="#E5E5E5"> doing a security</font><font color="#CCCCCC"> audit you won't</font>

209
00:08:50,029 --> 00:08:53,209
see any cause headers coming back<font color="#E5E5E5"> from</font>

210
00:08:51,829 --> 00:08:55,069
the site if it's doing dynamic

211
00:08:53,209 --> 00:08:56,910
<font color="#E5E5E5">generation so you'll never realize the</font>

212
00:08:55,070 --> 00:09:00,160
site<font color="#CCCCCC"> even</font><font color="#E5E5E5"> uses quartz</font>

213
00:08:56,910 --> 00:09:01,719
and I<font color="#CCCCCC"> think as a result</font><font color="#E5E5E5"> of that you've</font>

214
00:09:00,160 --> 00:09:04,180
got<font color="#CCCCCC"> a whole bunch of sites where</font><font color="#E5E5E5"> this</font>

215
00:09:01,720 --> 00:09:06,790
security critical<font color="#CCCCCC"> functionality based on</font>

216
00:09:04,180 --> 00:09:10,479
pars and user-supplied<font color="#CCCCCC"> yoloz hasn't even</font>

217
00:09:06,790 --> 00:09:12,670
gone through<font color="#CCCCCC"> a security</font><font color="#E5E5E5"> audit so when I</font>

218
00:09:10,480 --> 00:09:14,800
say people's awareness<font color="#CCCCCC"> of</font><font color="#E5E5E5"> cause is</font>

219
00:09:12,670 --> 00:09:17,410
<font color="#E5E5E5">really poor in</font><font color="#CCCCCC"> this year everyone's</font>

220
00:09:14,800 --> 00:09:19,209
heard of<font color="#E5E5E5"> cause but I</font><font color="#CCCCCC"> think a huge number</font>

221
00:09:17,410 --> 00:09:21,760
of people<font color="#E5E5E5"> haven't realized how</font>

222
00:09:19,210 --> 00:09:23,260
widespread dynamic generation is because

223
00:09:21,760 --> 00:09:27,250
if you<font color="#E5E5E5"> don't look</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> it you just</font><font color="#CCCCCC"> won't</font>

224
00:09:23,260 --> 00:09:29,050
<font color="#E5E5E5">find it so</font><font color="#CCCCCC"> I'm going to look</font><font color="#E5E5E5"> at what</font>

225
00:09:27,250 --> 00:09:31,540
<font color="#E5E5E5">goes wrong with a bunch of sites that I</font>

226
00:09:29,050 --> 00:09:34,510
found in the<font color="#E5E5E5"> world all of</font><font color="#CCCCCC"> these sites</font>

227
00:09:31,540 --> 00:09:35,740
have<font color="#E5E5E5"> bug bounty programs so you can be</font>

228
00:09:34,510 --> 00:09:37,600
reasonably<font color="#CCCCCC"> sure that these have already</font>

229
00:09:35,740 --> 00:09:41,110
been fairly heavily tested<font color="#E5E5E5"> by other</font>

230
00:09:37,600 --> 00:09:43,450
people before<font color="#CCCCCC"> me</font><font color="#E5E5E5"> also</font><font color="#CCCCCC"> when I did this</font>

231
00:09:41,110 --> 00:09:46,240
<font color="#CCCCCC">research</font><font color="#E5E5E5"> I was extremely lazy I used</font>

232
00:09:43,450 --> 00:09:47,740
like a four line<font color="#CCCCCC"> curved script and I</font>

233
00:09:46,240 --> 00:09:50,020
didn't bother registering or logging in

234
00:09:47,740 --> 00:09:51,279
<font color="#CCCCCC">to any of these sites so all the</font>

235
00:09:50,020 --> 00:09:52,300
vulnerabilities<font color="#E5E5E5"> I'm going to talk about</font>

236
00:09:51,279 --> 00:09:53,680
in this section<font color="#E5E5E5"> they're real</font>

237
00:09:52,300 --> 00:09:56,819
vulnerabilities and<font color="#E5E5E5"> they're</font><font color="#CCCCCC"> low-hanging</font>

238
00:09:53,680 --> 00:09:56,819
fruit they're easy to find

239
00:09:58,200 --> 00:10:03,670
<font color="#E5E5E5">okay first off there's simplest thing</font>

240
00:10:01,720 --> 00:10:06,730
<font color="#CCCCCC">that can go wrong</font><font color="#E5E5E5"> when you dynamically</font>

241
00:10:03,670 --> 00:10:08,410
generate the allow origin header is that

242
00:10:06,730 --> 00:10:10,630
you just reflect whatever origin header

243
00:10:08,410 --> 00:10:13,420
you get given which is<font color="#E5E5E5"> surprisingly</font>

244
00:10:10,630 --> 00:10:16,120
<font color="#E5E5E5">common for such a crazy</font><font color="#CCCCCC"> behavior I very</font>

245
00:10:13,420 --> 00:10:18,370
quickly<font color="#E5E5E5"> found a Bitcoin exchange which I</font>

246
00:10:16,120 --> 00:10:20,860
<font color="#CCCCCC">sadly can't name that had this</font><font color="#E5E5E5"> behavior</font>

247
00:10:18,370 --> 00:10:23,800
<font color="#E5E5E5">so if we look at the top request this</font>

248
00:10:20,860 --> 00:10:27,459
<font color="#E5E5E5">says hi I'm skeleton scribe dotnet can I</font>

249
00:10:23,800 --> 00:10:30,459
access this<font color="#E5E5E5"> users private key</font><font color="#CCCCCC"> there five</font>

250
00:10:27,459 --> 00:10:32,739
<font color="#E5E5E5">at a</font><font color="#CCCCCC"> pikey that is and this exchange</font>

251
00:10:30,459 --> 00:10:35,739
<font color="#E5E5E5">says yes skeleton described on there you</font>

252
00:10:32,740 --> 00:10:39,100
sound<font color="#E5E5E5"> trustworthy have this</font><font color="#CCCCCC"> users pro</font>

253
00:10:35,740 --> 00:10:43,060
private API<font color="#CCCCCC"> key</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> that means with a</font>

254
00:10:39,100 --> 00:10:46,029
tiny<font color="#E5E5E5"> bit of trivial</font><font color="#CCCCCC"> JavaScript</font><font color="#E5E5E5"> I can</font>

255
00:10:43,060 --> 00:10:48,369
grab<font color="#E5E5E5"> anyone's private API key and once</font>

256
00:10:46,029 --> 00:10:51,640
<font color="#E5E5E5">I've got</font><font color="#CCCCCC"> the safety Ikey</font><font color="#E5E5E5"> I've got quite</font>

257
00:10:48,370 --> 00:10:53,230
a<font color="#E5E5E5"> few</font><font color="#CCCCCC"> options</font><font color="#E5E5E5"> the first</font><font color="#CCCCCC"> thing</font><font color="#E5E5E5"> to do</font>

258
00:10:51,640 --> 00:10:55,860
would probably be to disable

259
00:10:53,230 --> 00:10:58,180
notifications<font color="#E5E5E5"> on the</font><font color="#CCCCCC"> user's account</font><font color="#E5E5E5"> as</font>

260
00:10:55,860 --> 00:11:00,339
Bitcoin exchanges have a history of

261
00:10:58,180 --> 00:11:02,109
being hacked horribly<font color="#E5E5E5"> modern ones are</font>

262
00:11:00,339 --> 00:11:04,839
<font color="#CCCCCC">very keen to show how seriously they</font>

263
00:11:02,110 --> 00:11:08,200
take<font color="#CCCCCC"> security</font><font color="#E5E5E5"> now one of the ways they</font>

264
00:11:04,839 --> 00:11:10,060
do that is by<font color="#E5E5E5"> generating email</font>

265
00:11:08,200 --> 00:11:10,480
notifications for<font color="#E5E5E5"> practically every</font>

266
00:11:10,060 --> 00:11:12,579
<font color="#E5E5E5">action</font>

267
00:11:10,480 --> 00:11:14,350
if you sign in you get a<font color="#E5E5E5"> notification if</font>

268
00:11:12,579 --> 00:11:16,209
you change any settings<font color="#E5E5E5"> you get a</font>

269
00:11:14,350 --> 00:11:19,029
notification<font color="#E5E5E5"> and if you make any trades</font>

270
00:11:16,209 --> 00:11:20,500
or whatever you get a notification<font color="#E5E5E5"> but</font>

271
00:11:19,029 --> 00:11:21,790
that's cool because the<font color="#CCCCCC"> API key can be</font>

272
00:11:20,500 --> 00:11:25,570
<font color="#CCCCCC">used to silently turn off all</font>

273
00:11:21,790 --> 00:11:27,760
notifications<font color="#E5E5E5"> after that well I probably</font>

274
00:11:25,570 --> 00:11:30,250
enable two-factor authentication<font color="#CCCCCC"> on</font>

275
00:11:27,760 --> 00:11:33,970
their account<font color="#CCCCCC"> tie to my phone which just</font>

276
00:11:30,250 --> 00:11:38,290
means they can't<font color="#E5E5E5"> log in and sets me up</font>

277
00:11:33,970 --> 00:11:39,760
nicely<font color="#CCCCCC"> for</font><font color="#E5E5E5"> the next stage which</font><font color="#CCCCCC"> is just</font>

278
00:11:38,290 --> 00:11:42,219
the transfer their<font color="#CCCCCC"> bitcoins to an</font>

279
00:11:39,760 --> 00:11:44,399
<font color="#E5E5E5">address of my choice or to use their</font>

280
00:11:42,220 --> 00:11:47,589
account<font color="#CCCCCC"> to play straight</font><font color="#E5E5E5"> because this is</font>

281
00:11:44,399 --> 00:11:49,269
because<font color="#CCCCCC"> this is a</font><font color="#E5E5E5"> Bitcoin exchange if I</font>

282
00:11:47,589 --> 00:11:50,920
were to compromise<font color="#E5E5E5"> a decent</font><font color="#CCCCCC"> number of</font>

283
00:11:49,269 --> 00:11:53,680
accounts<font color="#E5E5E5"> with this I could</font><font color="#CCCCCC"> potentially</font>

284
00:11:50,920 --> 00:11:55,779
pump up the value<font color="#E5E5E5"> of an</font><font color="#CCCCCC"> altcoin and that</font>

285
00:11:53,680 --> 00:11:58,209
<font color="#E5E5E5">I bought in on previously and thus</font>

286
00:11:55,779 --> 00:12:01,149
<font color="#E5E5E5">indirectly generate myself money without</font>

287
00:11:58,209 --> 00:12:02,560
<font color="#E5E5E5">leaving a massive audit trail although</font>

288
00:12:01,149 --> 00:12:04,300
because<font color="#CCCCCC"> this is a Bitcoin</font><font color="#E5E5E5"> leaving a</font>

289
00:12:02,560 --> 00:12:07,329
massive audit trail isn't<font color="#E5E5E5"> too much of a</font>

290
00:12:04,300 --> 00:12:09,939
problem when I reported<font color="#E5E5E5"> this</font>

291
00:12:07,329 --> 00:12:12,638
vulnerability<font color="#E5E5E5"> it was patched in under 20</font>

292
00:12:09,940 --> 00:12:15,029
<font color="#E5E5E5">minutes</font><font color="#CCCCCC"> alive which is</font><font color="#E5E5E5"> the fastest that</font>

293
00:12:12,639 --> 00:12:17,440
I've ever seen a vulnerability<font color="#E5E5E5"> patched</font>

294
00:12:15,029 --> 00:12:18,939
they were<font color="#CCCCCC"> also kind</font><font color="#E5E5E5"> enough</font><font color="#CCCCCC"> to tell me</font>

295
00:12:17,440 --> 00:12:22,329
<font color="#E5E5E5">that the root</font><font color="#CCCCCC"> cause of this</font>

296
00:12:18,940 --> 00:12:23,889
<font color="#CCCCCC">vulnerability was the vulnerable</font><font color="#E5E5E5"> third</font>

297
00:12:22,329 --> 00:12:27,189
party package that just added these

298
00:12:23,889 --> 00:12:30,250
headers by default so from what I

299
00:12:27,190 --> 00:12:32,019
understand this exchange never actually

300
00:12:30,250 --> 00:12:34,329
<font color="#E5E5E5">intended to use</font><font color="#CCCCCC"> Commons in the</font><font color="#E5E5E5"> first</font>

301
00:12:32,019 --> 00:12:41,079
place it just kind of<font color="#E5E5E5"> popped up there</font>

302
00:12:34,329 --> 00:12:44,410
and remove the less security<font color="#E5E5E5"> great other</font>

303
00:12:41,079 --> 00:12:46,689
times people try to<font color="#CCCCCC"> validate the header</font>

304
00:12:44,410 --> 00:12:50,459
<font color="#E5E5E5">the origin header but something goes</font>

305
00:12:46,690 --> 00:12:54,089
wrong here<font color="#E5E5E5"> this is a different exchange</font>

306
00:12:50,459 --> 00:12:56,260
<font color="#CCCCCC">post I cut mine for other reasons and</font>

307
00:12:54,089 --> 00:12:58,990
they're validating<font color="#CCCCCC"> that the origin</font>

308
00:12:56,260 --> 00:13:00,910
starts with<font color="#CCCCCC"> BTC</font><font color="#E5E5E5"> net I think they think</font>

309
00:12:58,990 --> 00:13:02,920
that<font color="#E5E5E5"> the origin header might contain a</font>

310
00:13:00,910 --> 00:13:05,290
full URL specifying a part and<font color="#CCCCCC"> suchlike</font>

311
00:13:02,920 --> 00:13:07,810
<font color="#CCCCCC">and that's why they're doing</font><font color="#E5E5E5"> this but of</font>

312
00:13:05,290 --> 00:13:12,459
<font color="#E5E5E5">course that means</font><font color="#CCCCCC"> they trust BTC evil</font>

313
00:13:07,810 --> 00:13:14,079
<font color="#CCCCCC">dotnet which</font><font color="#E5E5E5"> is not great when I found</font>

314
00:13:12,459 --> 00:13:15,638
this I thought cool I'll just<font color="#CCCCCC"> find out</font>

315
00:13:14,079 --> 00:13:17,550
how I still<font color="#E5E5E5"> bitcoins from this site and</font>

316
00:13:15,639 --> 00:13:21,130
then<font color="#E5E5E5"> that will go into my talk willingly</font>

317
00:13:17,550 --> 00:13:23,859
but due to<font color="#E5E5E5"> the design of</font><font color="#CCCCCC"> that API I ran</font>

318
00:13:21,130 --> 00:13:26,290
into some difficulties with<font color="#CCCCCC"> that</font>

319
00:13:23,860 --> 00:13:29,589
and<font color="#E5E5E5"> I couldn't actually prove</font><font color="#CCCCCC"> that it</font>

320
00:13:26,290 --> 00:13:31,269
was a<font color="#CCCCCC"> serious security</font><font color="#E5E5E5"> issue in the time</font>

321
00:13:29,589 --> 00:13:34,089
I<font color="#CCCCCC"> took so I thought I'll just</font><font color="#E5E5E5"> come back</font>

322
00:13:31,269 --> 00:13:36,100
to this later<font color="#E5E5E5"> and have another</font><font color="#CCCCCC"> go</font><font color="#E5E5E5"> and</font>

323
00:13:34,089 --> 00:13:38,589
when I came<font color="#E5E5E5"> back in a couple</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> weeks</font><font color="#CCCCCC"> I</font>

324
00:13:36,100 --> 00:13:40,660
found that that<font color="#E5E5E5"> the site had just shut</font>

325
00:13:38,589 --> 00:13:42,550
down<font color="#E5E5E5"> completely</font><font color="#CCCCCC"> the company like ceased</font>

326
00:13:40,660 --> 00:13:46,050
operations and if you wanted your

327
00:13:42,550 --> 00:13:48,699
bitcoins<font color="#E5E5E5"> but you had to phone them up so</font>

328
00:13:46,050 --> 00:13:51,579
that's<font color="#E5E5E5"> why</font><font color="#CCCCCC"> I'm twisted concepts</font><font color="#E5E5E5"> this one</font>

329
00:13:48,700 --> 00:13:54,399
<font color="#CCCCCC">I'm not going</font><font color="#E5E5E5"> to speculate as that why</font>

330
00:13:51,579 --> 00:13:55,479
<font color="#E5E5E5">that would have happened</font><font color="#CCCCCC"> just something</font>

331
00:13:54,399 --> 00:13:59,140
<font color="#E5E5E5">to watch out for when you're</font><font color="#CCCCCC"> dealing</font>

332
00:13:55,480 --> 00:14:01,810
with Bitcoin exchanges I guess something

333
00:13:59,140 --> 00:14:05,230
<font color="#CCCCCC">else that some sites do is they validate</font>

334
00:14:01,810 --> 00:14:06,969
the end of the origin<font color="#E5E5E5"> and they forget to</font>

335
00:14:05,230 --> 00:14:08,670
<font color="#E5E5E5">put a dot start so here I think</font><font color="#CCCCCC"> they're</font>

336
00:14:06,970 --> 00:14:10,899
trying<font color="#CCCCCC"> to trust all their subdomains</font>

337
00:14:08,670 --> 00:14:13,890
<font color="#CCCCCC">this is the mate</font><font color="#E5E5E5"> oh this is the real</font>

338
00:14:10,899 --> 00:14:17,740
site I have a bug bounty<font color="#E5E5E5"> program and</font>

339
00:14:13,890 --> 00:14:20,290
they trust not as a mate<font color="#E5E5E5"> Oh calm great</font>

340
00:14:17,740 --> 00:14:22,300
work probably<font color="#CCCCCC"> the most noteworthy thing</font>

341
00:14:20,290 --> 00:14:23,589
here is the number<font color="#CCCCCC"> of security headers</font>

342
00:14:22,300 --> 00:14:25,779
they've got they've got content<font color="#E5E5E5"> security</font>

343
00:14:23,589 --> 00:14:28,660
policy strict Transport Security content

344
00:14:25,779 --> 00:14:31,149
type options XSS protection and yet with

345
00:14:28,660 --> 00:14:34,740
two extra headers they remove<font color="#E5E5E5"> all their</font>

346
00:14:31,149 --> 00:14:37,839
security<font color="#E5E5E5"> the other notable thing about</font>

347
00:14:34,740 --> 00:14:39,940
<font color="#CCCCCC">this for mobility</font><font color="#E5E5E5"> is that it's possibly</font>

348
00:14:37,839 --> 00:14:42,339
<font color="#CCCCCC">the least impressive bug bound kicks</font>

349
00:14:39,940 --> 00:14:44,290
<font color="#CCCCCC">difference that I've ever had</font><font color="#E5E5E5"> I reported</font>

350
00:14:42,339 --> 00:14:46,570
this issue to<font color="#E5E5E5"> them and didn't get any</font>

351
00:14:44,290 --> 00:14:48,819
reply<font color="#E5E5E5"> and I reminded them a few times</font>

352
00:14:46,570 --> 00:14:50,320
and I still<font color="#CCCCCC"> didn't get any reply and I</font>

353
00:14:48,820 --> 00:14:51,699
thought<font color="#E5E5E5"> okay whatever I don't really</font>

354
00:14:50,320 --> 00:14:55,000
care I'll just<font color="#CCCCCC"> full disclose it in</font>

355
00:14:51,699 --> 00:14:57,459
<font color="#CCCCCC">ninety</font><font color="#E5E5E5"> days and after</font><font color="#CCCCCC"> ninety days I went</font>

356
00:14:55,000 --> 00:15:01,000
<font color="#E5E5E5">to full disclose it and I found that</font>

357
00:14:57,459 --> 00:15:02,469
they fixed so they didn't reply to me

358
00:15:01,000 --> 00:15:04,630
they didn't acknowledge it or<font color="#E5E5E5"> give me</font>

359
00:15:02,470 --> 00:15:09,250
any<font color="#CCCCCC"> credit or anything</font><font color="#E5E5E5"> then one hacker</font>

360
00:15:04,630 --> 00:15:10,870
<font color="#E5E5E5">won but they did fix it I'm not sure</font><font color="#CCCCCC"> why</font>

361
00:15:09,250 --> 00:15:12,760
they would do that<font color="#CCCCCC"> I think maybe they</font>

362
00:15:10,870 --> 00:15:16,209
thought<font color="#E5E5E5"> this was quite an embarrassing</font>

363
00:15:12,760 --> 00:15:20,740
issue perhaps<font color="#E5E5E5"> but well it's public now</font>

364
00:15:16,209 --> 00:15:23,050
anyway<font color="#E5E5E5"> okay both of</font><font color="#CCCCCC"> those all three</font><font color="#E5E5E5"> of</font>

365
00:15:20,740 --> 00:15:25,660
those issues are<font color="#E5E5E5"> quite obvious provided</font>

366
00:15:23,050 --> 00:15:26,979
you're looking for<font color="#E5E5E5"> cause issues now I'm</font>

367
00:15:25,660 --> 00:15:28,750
going to<font color="#E5E5E5"> look at some</font><font color="#CCCCCC"> more subtle</font>

368
00:15:26,980 --> 00:15:32,949
perhaps more technically interesting

369
00:15:28,750 --> 00:15:35,199
ways<font color="#CCCCCC"> to screw up cause on your site if</font>

370
00:15:32,949 --> 00:15:36,540
you were<font color="#E5E5E5"> paying attention earlier you</font>

371
00:15:35,199 --> 00:15:38,459
would<font color="#E5E5E5"> have</font><font color="#CCCCCC"> noticed that</font>

372
00:15:36,540 --> 00:15:40,670
specification has a<font color="#E5E5E5"> reference to the</font>

373
00:15:38,460 --> 00:15:45,600
null origin which raises the<font color="#E5E5E5"> question</font>

374
00:15:40,670 --> 00:15:47,370
<font color="#E5E5E5">what is the neurology and I decided to</font>

375
00:15:45,600 --> 00:15:50,790
spoof<font color="#CCCCCC"> the no origin</font><font color="#E5E5E5"> to a bunch of sites</font>

376
00:15:47,370 --> 00:15:55,320
<font color="#E5E5E5">to see if anybody trusted it and I found</font>

377
00:15:50,790 --> 00:15:57,990
that<font color="#E5E5E5"> Google Google's PDF viewer which</font>

378
00:15:55,320 --> 00:16:01,050
converts a PDF and<font color="#E5E5E5"> HTML trusts</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> no</font>

379
00:15:57,990 --> 00:16:04,560
origin with credentials<font color="#CCCCCC"> so that's cool</font>

380
00:16:01,050 --> 00:16:07,979
<font color="#E5E5E5">and even better there's a Bitcoin</font><font color="#CCCCCC"> wallet</font>

381
00:16:04,560 --> 00:16:09,420
that trusts in<font color="#E5E5E5"> origin excellent</font><font color="#CCCCCC"> you can</font>

382
00:16:07,980 --> 00:16:11,870
find loads<font color="#E5E5E5"> more sites that have</font>

383
00:16:09,420 --> 00:16:15,120
explicitly<font color="#CCCCCC"> whitelisted the null</font><font color="#E5E5E5"> origin</font>

384
00:16:11,870 --> 00:16:19,670
using rapid<font color="#CCCCCC"> sevens</font><font color="#E5E5E5"> sonar HTTP which is a</font>

385
00:16:15,120 --> 00:16:19,670
great resource<font color="#E5E5E5"> or using showed out</font><font color="#CCCCCC"> so</font>

386
00:16:19,790 --> 00:16:24,709
<font color="#CCCCCC">that just</font><font color="#E5E5E5"> leaves the question well how</font>

387
00:16:22,110 --> 00:16:27,630
<font color="#E5E5E5">do I get the now origin who has it</font>

388
00:16:24,710 --> 00:16:29,910
accepted wisdom<font color="#E5E5E5"> on Stack Overflow and</font>

389
00:16:27,630 --> 00:16:31,980
<font color="#CCCCCC">the like seems to</font><font color="#E5E5E5"> be the local file this</font>

390
00:16:29,910 --> 00:16:34,949
<font color="#CCCCCC">file</font><font color="#E5E5E5"> was on your local</font><font color="#CCCCCC"> filesystem use</font>

391
00:16:31,980 --> 00:16:38,780
the null origin and I think that might

392
00:16:34,950 --> 00:16:41,550
be<font color="#E5E5E5"> why it ends up being white listed but</font>

393
00:16:38,780 --> 00:16:43,680
there's this great<font color="#CCCCCC"> little html5</font><font color="#E5E5E5"> feature</font>

394
00:16:41,550 --> 00:16:45,930
which is the<font color="#E5E5E5"> sandbox attribute for</font>

395
00:16:43,680 --> 00:16:48,060
iframes<font color="#E5E5E5"> the purpose of this is to</font>

396
00:16:45,930 --> 00:16:50,280
<font color="#E5E5E5">prevent the contents of an iframe</font><font color="#CCCCCC"> from</font>

397
00:16:48,060 --> 00:16:52,290
<font color="#E5E5E5">doing anything bad by isolating it in a</font>

398
00:16:50,280 --> 00:16:54,209
<font color="#E5E5E5">separate origin and you can probably</font>

399
00:16:52,290 --> 00:16:57,900
guess<font color="#E5E5E5"> what origin it puts the contents</font>

400
00:16:54,210 --> 00:17:00,570
in<font color="#CCCCCC"> it's the null origin yeah so that</font>

401
00:16:57,900 --> 00:17:04,200
means any<font color="#CCCCCC"> website can get hold of the</font>

402
00:17:00,570 --> 00:17:06,840
null origin and thanks to that I could

403
00:17:04,200 --> 00:17:09,270
still<font color="#E5E5E5"> use</font><font color="#CCCCCC"> as Google at the count details</font>

404
00:17:06,839 --> 00:17:11,310
like their user ID<font color="#E5E5E5"> they their email</font>

405
00:17:09,270 --> 00:17:12,450
address nothing super<font color="#E5E5E5"> sensitive but some</font>

406
00:17:11,310 --> 00:17:15,300
stuff you probably<font color="#E5E5E5"> don't want every</font>

407
00:17:12,450 --> 00:17:17,880
website<font color="#E5E5E5"> uses in knowing and I could also</font>

408
00:17:15,300 --> 00:17:22,349
download encrypted backups of other

409
00:17:17,880 --> 00:17:24,360
<font color="#E5E5E5">people's Bitcoin wallets and you might</font>

410
00:17:22,349 --> 00:17:26,669
<font color="#CCCCCC">think</font><font color="#E5E5E5"> it's encrypted what can I do but</font>

411
00:17:24,359 --> 00:17:28,889
luckily for<font color="#E5E5E5"> me it's</font><font color="#CCCCCC"> encrypted with the</font>

412
00:17:26,670 --> 00:17:30,240
password that<font color="#CCCCCC"> the user chose</font><font color="#E5E5E5"> on the</font>

413
00:17:28,890 --> 00:17:32,760
<font color="#E5E5E5">website which didn't even</font><font color="#CCCCCC"> have a</font>

414
00:17:30,240 --> 00:17:34,890
password<font color="#E5E5E5"> strength meter at the time and</font>

415
00:17:32,760 --> 00:17:37,440
here I was<font color="#CCCCCC"> able to launch an offline</font>

416
00:17:34,890 --> 00:17:42,150
<font color="#E5E5E5">brute-force attack against it so that</font>

417
00:17:37,440 --> 00:17:44,130
was potentially<font color="#CCCCCC"> quite serious so in</font>

418
00:17:42,150 --> 00:17:47,130
<font color="#E5E5E5">conclusion what have we learned about</font>

419
00:17:44,130 --> 00:17:50,130
the null origin well it's actually<font color="#E5E5E5"> the</font>

420
00:17:47,130 --> 00:17:52,080
wild card<font color="#E5E5E5"> in disguise if some</font>

421
00:17:50,130 --> 00:17:54,390
<font color="#CCCCCC">they trust</font><font color="#E5E5E5"> star you can tell what they</font>

422
00:17:52,080 --> 00:17:56,340
could try<font color="#E5E5E5"> to say if</font><font color="#CCCCCC"> they say they trust</font>

423
00:17:54,390 --> 00:17:57,900
no it's<font color="#E5E5E5"> not immediately obvious</font><font color="#CCCCCC"> that</font>

424
00:17:56,340 --> 00:18:02,129
they're giving access<font color="#E5E5E5"> to every site out</font>

425
00:17:57,900 --> 00:18:04,710
there but actually<font color="#CCCCCC"> it's worse than</font><font color="#E5E5E5"> the</font>

426
00:18:02,130 --> 00:18:06,840
<font color="#CCCCCC">wild-card it's more dangerous</font><font color="#E5E5E5"> because</font>

427
00:18:04,710 --> 00:18:10,470
<font color="#E5E5E5">the exception with regard to credentials</font>

428
00:18:06,840 --> 00:18:12,389
and the<font color="#E5E5E5"> wild-card doesn't apply</font><font color="#CCCCCC"> to the</font>

429
00:18:10,470 --> 00:18:14,580
<font color="#CCCCCC">null</font><font color="#E5E5E5"> origin so if you say you trust the</font>

430
00:18:12,390 --> 00:18:17,400
null origin with credentials<font color="#E5E5E5"> you are</font>

431
00:18:14,580 --> 00:18:22,949
genuinely sacrificing the<font color="#CCCCCC"> same-origin</font>

432
00:18:17,400 --> 00:18:25,350
<font color="#CCCCCC">policy</font><font color="#E5E5E5"> entirely on your site there's one</font>

433
00:18:22,950 --> 00:18:28,830
other thing<font color="#CCCCCC"> about the</font><font color="#E5E5E5"> now origin I think</font>

434
00:18:25,350 --> 00:18:32,090
the work the choice of the term null<font color="#E5E5E5"> was</font>

435
00:18:28,830 --> 00:18:35,639
not<font color="#CCCCCC"> ideal because some what I can tell</font>

436
00:18:32,090 --> 00:18:37,889
<font color="#E5E5E5">some frameworks let they let you</font>

437
00:18:35,640 --> 00:18:40,530
configure which origins<font color="#CCCCCC"> you want your</font>

438
00:18:37,890 --> 00:18:42,390
application to trust<font color="#E5E5E5"> and if you don't</font>

439
00:18:40,530 --> 00:18:44,940
<font color="#E5E5E5">bother to configure the value of this</font>

440
00:18:42,390 --> 00:18:48,390
<font color="#E5E5E5">variable then the programming language</font>

441
00:18:44,940 --> 00:18:49,980
decides<font color="#E5E5E5"> to output it</font><font color="#CCCCCC"> is null so you're</font>

442
00:18:48,390 --> 00:18:51,690
<font color="#E5E5E5">trying to say I don't trust any sites</font>

443
00:18:49,980 --> 00:18:54,230
<font color="#E5E5E5">and the end result is that you trust</font>

444
00:18:51,690 --> 00:19:00,030
<font color="#E5E5E5">every site on the Internet</font>

445
00:18:54,230 --> 00:19:02,490
perhaps it should<font color="#E5E5E5"> be renamed</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> let's</font>

446
00:19:00,030 --> 00:19:05,000
look<font color="#E5E5E5"> at</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> different slightly subtle</font>

447
00:19:02,490 --> 00:19:10,920
issue which I'm<font color="#E5E5E5"> going to live demo on</font>

448
00:19:05,000 --> 00:19:12,720
Google Finance right so here on Google

449
00:19:10,920 --> 00:19:15,060
Finance<font color="#CCCCCC"> we can see some share</font>

450
00:19:12,720 --> 00:19:18,360
information related to<font color="#E5E5E5"> my to my account</font>

451
00:19:15,060 --> 00:19:20,159
<font color="#E5E5E5">and if I was a hypothetically rich</font>

452
00:19:18,360 --> 00:19:22,740
person the share information might<font color="#CCCCCC"> be</font>

453
00:19:20,160 --> 00:19:25,970
really<font color="#E5E5E5"> quite valuable</font><font color="#CCCCCC"> so let's see if</font>

454
00:19:22,740 --> 00:19:25,970
the site is using<font color="#E5E5E5"> course</font>

455
00:19:32,970 --> 00:19:40,010
I just<font color="#CCCCCC"> realize that not</font><font color="#E5E5E5"> display screen</font>

456
00:19:35,690 --> 00:19:40,010
this<font color="#CCCCCC"> would take a second</font>

457
00:19:47,270 --> 00:19:54,650
right so we were<font color="#CCCCCC"> just</font><font color="#E5E5E5"> on Google Finance</font>

458
00:19:50,620 --> 00:20:00,110
<font color="#E5E5E5">with some share info and I've just sent</font>

459
00:19:54,650 --> 00:20:01,940
in a request<font color="#E5E5E5"> and got it in</font><font color="#CCCCCC"> verb so I'm</font>

460
00:20:00,110 --> 00:20:05,169
going<font color="#CCCCCC"> to see if these guys support cause</font>

461
00:20:01,940 --> 00:20:08,000
I'm<font color="#E5E5E5"> just going to delete this token here</font>

462
00:20:05,170 --> 00:20:08,960
because I can't guess<font color="#CCCCCC"> the value of that</font>

463
00:20:08,000 --> 00:20:15,590
but it doesn't<font color="#CCCCCC"> actually make any</font>

464
00:20:08,960 --> 00:20:16,910
<font color="#E5E5E5">difference right so first off if you</font>

465
00:20:15,590 --> 00:20:19,428
look at the head as you're getting back

466
00:20:16,910 --> 00:20:22,340
<font color="#E5E5E5">there were no calls head is there so a</font>

467
00:20:19,429 --> 00:20:25,550
<font color="#E5E5E5">tested that wasn't acutely aware of</font>

468
00:20:22,340 --> 00:20:27,139
dynamic cause generation might not

469
00:20:25,550 --> 00:20:30,350
realize the slightest supports<font color="#CCCCCC"> caused at</font>

470
00:20:27,140 --> 00:20:31,970
all but we're going to<font color="#E5E5E5"> try an origin we</font>

471
00:20:30,350 --> 00:20:33,709
think they're likely<font color="#CCCCCC"> to trust</font><font color="#E5E5E5"> like</font>

472
00:20:31,970 --> 00:20:36,980
<font color="#CCCCCC">google.com</font><font color="#E5E5E5"> like google.com probably</font>

473
00:20:33,710 --> 00:20:41,059
trust<font color="#E5E5E5"> Google calm and if we send that</font>

474
00:20:36,980 --> 00:20:43,010
then sure enough we've got them<font color="#E5E5E5"> trusting</font>

475
00:20:41,059 --> 00:20:45,530
<font color="#E5E5E5">Google calm with</font><font color="#CCCCCC"> credentials fair</font><font color="#E5E5E5"> enough</font>

476
00:20:43,010 --> 00:20:48,410
no security<font color="#CCCCCC"> risk alert and we can try</font>

477
00:20:45,530 --> 00:20:49,639
the obvious at attacks of seeing if

478
00:20:48,410 --> 00:20:51,980
they're using starts with<font color="#E5E5E5"> or ends with</font>

479
00:20:49,640 --> 00:20:53,300
but as you<font color="#E5E5E5"> can</font><font color="#CCCCCC"> see we don't get the</font>

480
00:20:51,980 --> 00:21:00,250
origin headers back<font color="#E5E5E5"> they're just</font><font color="#CCCCCC"> not</font>

481
00:20:53,300 --> 00:21:03,879
working<font color="#E5E5E5"> also if you try the null origin</font>

482
00:21:00,250 --> 00:21:06,020
then it causes<font color="#CCCCCC"> an internal server error</font>

483
00:21:03,880 --> 00:21:09,110
<font color="#CCCCCC">but there's no actual vulnerability</font><font color="#E5E5E5"> that</font>

484
00:21:06,020 --> 00:21:10,820
has just<font color="#E5E5E5"> kind of funny</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> interestingly</font>

485
00:21:09,110 --> 00:21:17,590
they are trusting all their subdomains

486
00:21:10,820 --> 00:21:22,790
<font color="#CCCCCC">so I can put anything google.com and</font>

487
00:21:17,590 --> 00:21:27,639
that by itself isn't too<font color="#E5E5E5"> bad but they</font>

488
00:21:22,790 --> 00:21:30,409
also don't<font color="#CCCCCC"> validate the protocol so here</font>

489
00:21:27,640 --> 00:21:34,059
<font color="#E5E5E5">HTTP</font><font color="#CCCCCC"> Google com is saying they trust</font>

490
00:21:30,410 --> 00:21:36,970
HTTP evil or Google com

491
00:21:34,059 --> 00:21:43,270
let's see if we can do<font color="#CCCCCC"> anything</font>

492
00:21:36,970 --> 00:21:43,270
interesting<font color="#E5E5E5"> with</font><font color="#CCCCCC"> that</font>

493
00:21:47,190 --> 00:21:52,480
<font color="#E5E5E5">okay so say that</font><font color="#CCCCCC"> you're in a say</font><font color="#E5E5E5"> that</font>

494
00:21:50,890 --> 00:21:54,070
I'm accessing Google<font color="#E5E5E5"> Finance I've got</font>

495
00:21:52,480 --> 00:21:56,260
some sensitive share info on there<font color="#CCCCCC"> and</font>

496
00:21:54,070 --> 00:21:58,530
you're in<font color="#CCCCCC"> a position to view and tamper</font>

497
00:21:56,260 --> 00:22:01,270
with my<font color="#E5E5E5"> network traffic maybe I'm using</font>

498
00:21:58,530 --> 00:22:03,070
<font color="#CCCCCC">insecure</font><font color="#E5E5E5"> Wi-Fi in a coffee shop</font><font color="#CCCCCC"> maybe</font>

499
00:22:01,270 --> 00:22:04,450
<font color="#E5E5E5">you've done BGP hijacking on my</font>

500
00:22:03,070 --> 00:22:06,520
company's office that's kind of

501
00:22:04,450 --> 00:22:08,530
fashionable at the<font color="#E5E5E5"> moment</font><font color="#CCCCCC"> or</font><font color="#E5E5E5"> maybe</font>

502
00:22:06,520 --> 00:22:08,980
you're just<font color="#E5E5E5"> at NSA sitting on every</font>

503
00:22:08,530 --> 00:22:12,490
<font color="#CCCCCC">networks</font>

504
00:22:08,980 --> 00:22:15,070
sampling with everything anyway if I

505
00:22:12,490 --> 00:22:16,990
access Google Finance<font color="#E5E5E5"> directly that's</font>

506
00:22:15,070 --> 00:22:19,629
protected with HTTPS it's pretty

507
00:22:16,990 --> 00:22:23,020
difficult for<font color="#E5E5E5"> you to modify view or</font>

508
00:22:19,630 --> 00:22:26,110
tamper with that<font color="#E5E5E5"> content but as soon as</font>

509
00:22:23,020 --> 00:22:27,790
<font color="#E5E5E5">I load any site over HTTP you can</font>

510
00:22:26,110 --> 00:22:30,939
intercept<font color="#CCCCCC"> that request and spoof</font>

511
00:22:27,790 --> 00:22:33,399
whatever response<font color="#E5E5E5"> you like so here I try</font>

512
00:22:30,940 --> 00:22:37,900
and load<font color="#E5E5E5"> cnn.com</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> you can redirect me</font>

513
00:22:33,400 --> 00:22:39,940
to<font color="#E5E5E5"> evil google calm and the grouser will</font>

514
00:22:37,900 --> 00:22:42,760
silently follow that<font color="#CCCCCC"> redirects</font><font color="#E5E5E5"> and load</font>

515
00:22:39,940 --> 00:22:44,590
up HTTP evil or<font color="#E5E5E5"> Google</font><font color="#CCCCCC"> com</font>

516
00:22:42,760 --> 00:22:46,780
and once again it's an unencrypted

517
00:22:44,590 --> 00:22:49,209
connection you can catch<font color="#CCCCCC"> that request</font>

518
00:22:46,780 --> 00:22:51,309
and spoof<font color="#CCCCCC"> the response</font><font color="#E5E5E5"> and now you're</font>

519
00:22:49,210 --> 00:22:53,770
<font color="#E5E5E5">going to send some malicious JavaScript</font>

520
00:22:51,309 --> 00:22:55,660
that's going to use<font color="#CCCCCC"> courts it's going to</font>

521
00:22:53,770 --> 00:22:58,750
use<font color="#E5E5E5"> cause to send a request to</font><font color="#CCCCCC"> Google</font>

522
00:22:55,660 --> 00:23:00,880
Finance and<font color="#CCCCCC"> the browser</font><font color="#E5E5E5"> will put on this</font>

523
00:22:58,750 --> 00:23:03,250
origin header saying<font color="#E5E5E5"> this request to</font>

524
00:23:00,880 --> 00:23:04,179
<font color="#E5E5E5">Google Finance is coming from evil</font>

525
00:23:03,250 --> 00:23:07,840
Google com

526
00:23:04,179 --> 00:23:09,220
but as we've seen Google<font color="#E5E5E5"> just that so</font>

527
00:23:07,840 --> 00:23:11,530
they go<font color="#E5E5E5"> great that's a trust where the</font>

528
00:23:09,220 --> 00:23:13,809
origin and past my sensitive financial

529
00:23:11,530 --> 00:23:16,480
information<font color="#E5E5E5"> back</font><font color="#CCCCCC"> to your malicious</font>

530
00:23:13,809 --> 00:23:18,510
<font color="#E5E5E5">JavaScript which you can then log or</font>

531
00:23:16,480 --> 00:23:22,500
send off<font color="#CCCCCC"> to wherever you want so</font>

532
00:23:18,510 --> 00:23:25,629
<font color="#CCCCCC">although Google Finance is using</font><font color="#E5E5E5"> HTTPS</font>

533
00:23:22,500 --> 00:23:30,690
they've kind of undone their use of

534
00:23:25,630 --> 00:23:32,350
<font color="#CCCCCC">HTTPS through their use of course</font><font color="#E5E5E5"> ie</font>

535
00:23:30,690 --> 00:23:34,300
<font color="#E5E5E5">when I found this issue</font>

536
00:23:32,350 --> 00:23:35,709
I thought about reporting it to<font color="#E5E5E5"> Google</font>

537
00:23:34,300 --> 00:23:37,120
and I wasn't<font color="#E5E5E5"> sure if it was</font><font color="#CCCCCC"> serious</font>

538
00:23:35,710 --> 00:23:40,120
<font color="#E5E5E5">enough for them to care so I sent them</font>

539
00:23:37,120 --> 00:23:41,830
an<font color="#E5E5E5"> email and didn't</font><font color="#CCCCCC"> get a</font><font color="#E5E5E5"> reply and so I</font>

540
00:23:40,120 --> 00:23:43,959
was like fine I'll<font color="#CCCCCC"> just live them on it</font>

541
00:23:41,830 --> 00:23:44,919
because I<font color="#E5E5E5"> don't</font><font color="#CCCCCC"> think</font><font color="#E5E5E5"> this is</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> serious</font>

542
00:23:43,960 --> 00:23:48,070
issue really<font color="#E5E5E5"> requires a</font>

543
00:23:44,920 --> 00:23:50,410
<font color="#CCCCCC">man-in-the-middle and a few weeks</font><font color="#E5E5E5"> after</font>

544
00:23:48,070 --> 00:23:53,800
<font color="#E5E5E5">my</font><font color="#CCCCCC"> presentation I got a direct message</font>

545
00:23:50,410 --> 00:23:55,480
on Twitter<font color="#E5E5E5"> and I said hey there you know</font>

546
00:23:53,800 --> 00:23:58,210
<font color="#CCCCCC">that vulnerability in Google Finance you</font>

547
00:23:55,480 --> 00:23:59,049
<font color="#E5E5E5">demoed</font><font color="#CCCCCC"> yeah I submitted it to Google and</font>

548
00:23:58,210 --> 00:24:05,919
they paid me<font color="#CCCCCC"> a thousand</font>

549
00:23:59,049 --> 00:24:07,679
<font color="#CCCCCC">hopefully</font><font color="#E5E5E5"> I'm not</font><font color="#CCCCCC"> 100% your the truth of</font>

550
00:24:05,919 --> 00:24:09,879
this<font color="#CCCCCC"> I</font><font color="#E5E5E5"> haven't fully</font><font color="#CCCCCC"> verified it yet but</font>

551
00:24:07,679 --> 00:24:14,470
my presentations might be more valuable

552
00:24:09,879 --> 00:24:17,259
<font color="#E5E5E5">than you think</font><font color="#CCCCCC"> okay you might now be</font>

553
00:24:14,470 --> 00:24:18,940
thinking<font color="#E5E5E5"> great I know how to safely</font>

554
00:24:17,259 --> 00:24:20,350
trust all<font color="#E5E5E5"> of my subdomains</font>

555
00:24:18,940 --> 00:24:23,590
I've just got a<font color="#CCCCCC"> whitelist</font><font color="#E5E5E5"> the protocol</font>

556
00:24:20,350 --> 00:24:24,189
and these ends with<font color="#CCCCCC"> the dot</font><font color="#E5E5E5"> but</font><font color="#CCCCCC"> please</font>

557
00:24:23,590 --> 00:24:26,769
<font color="#E5E5E5">don't do that</font>

558
00:24:24,190 --> 00:24:28,559
for start<font color="#E5E5E5"> obviously</font><font color="#CCCCCC"> if any of your</font>

559
00:24:26,769 --> 00:24:30,929
subdomains have cross-site scripting

560
00:24:28,559 --> 00:24:33,908
you've just removed your security<font color="#E5E5E5"> and</font>

561
00:24:30,929 --> 00:24:36,580
some even<font color="#E5E5E5"> quite well secured</font>

562
00:24:33,909 --> 00:24:38,080
applications like<font color="#CCCCCC"> bugzilla have</font>

563
00:24:36,580 --> 00:24:40,658
intentional cross-site scripting

564
00:24:38,080 --> 00:24:42,100
vulnerabilities on subdomains<font color="#E5E5E5"> it's a</font>

565
00:24:40,659 --> 00:24:44,230
feature<font color="#E5E5E5"> it doesn't compromise the</font>

566
00:24:42,100 --> 00:24:45,789
<font color="#CCCCCC">stability</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> Bugzilla</font><font color="#E5E5E5"> due to the way</font>

567
00:24:44,230 --> 00:24:47,919
it's implemented<font color="#E5E5E5"> but it will</font><font color="#CCCCCC"> compromise</font>

568
00:24:45,789 --> 00:24:50,859
your site<font color="#E5E5E5"> if you trust all your</font>

569
00:24:47,919 --> 00:24:52,509
subdomains<font color="#E5E5E5"> also if you've got hanging</font>

570
00:24:50,859 --> 00:24:54,668
<font color="#CCCCCC">sea</font><font color="#E5E5E5"> names and the like someone might sub</font>

571
00:24:52,509 --> 00:24:58,869
hijack a subdomain<font color="#E5E5E5"> third parties all</font>

572
00:24:54,669 --> 00:25:01,419
that stuff<font color="#E5E5E5"> even if all your</font>

573
00:24:58,869 --> 00:25:03,639
infrastructure<font color="#E5E5E5"> is completely secure</font><font color="#CCCCCC"> and</font>

574
00:25:01,419 --> 00:25:05,139
there's no one XSS vulnerability in it

575
00:25:03,639 --> 00:25:08,309
or any<font color="#E5E5E5"> of the third parties or using</font>

576
00:25:05,139 --> 00:25:11,049
<font color="#CCCCCC">anywhere your customers your clients</font>

577
00:25:08,309 --> 00:25:13,960
<font color="#E5E5E5">infrastructure can lead to excess</font>

578
00:25:11,049 --> 00:25:17,830
vulnerabilities in subdomains<font color="#E5E5E5"> some</font>

579
00:25:13,960 --> 00:25:21,639
unscrupulous<font color="#E5E5E5"> ISPs they detect a failed</font>

580
00:25:17,830 --> 00:25:23,889
DNS lookup and they inject<font color="#E5E5E5"> a page a fake</font>

581
00:25:21,639 --> 00:25:27,039
search page basically<font color="#E5E5E5"> full of adverts</font><font color="#CCCCCC"> to</font>

582
00:25:23,889 --> 00:25:28,359
get some ad revenue and these pages have

583
00:25:27,039 --> 00:25:30,669
a history of occasionally<font color="#E5E5E5"> being</font>

584
00:25:28,359 --> 00:25:32,168
vulnerable<font color="#E5E5E5"> to cross-site scripting so</font>

585
00:25:30,669 --> 00:25:35,200
someone<font color="#E5E5E5"> could inject something that does</font>

586
00:25:32,169 --> 00:25:39,100
not resolve dot your site<font color="#CCCCCC"> calm the</font><font color="#E5E5E5"> ISP</font>

587
00:25:35,200 --> 00:25:41,139
injects a page full<font color="#CCCCCC"> of ads</font><font color="#E5E5E5"> and it's</font>

588
00:25:39,100 --> 00:25:44,459
vulnerable<font color="#E5E5E5"> to JavaScript injection</font><font color="#CCCCCC"> and</font>

589
00:25:41,139 --> 00:25:46,959
you've<font color="#CCCCCC"> just lost</font><font color="#E5E5E5"> your security in fact</font>

590
00:25:44,460 --> 00:25:48,989
recently someone found<font color="#E5E5E5"> that McAfee web</font>

591
00:25:46,960 --> 00:25:51,850
<font color="#E5E5E5">gateway which is</font><font color="#CCCCCC"> something designed to</font>

592
00:25:48,989 --> 00:25:54,450
make your enterprise users<font color="#E5E5E5"> more secure</font>

593
00:25:51,850 --> 00:25:57,100
or something<font color="#CCCCCC"> had a</font><font color="#E5E5E5"> very similar behavior</font>

594
00:25:54,450 --> 00:26:00,129
<font color="#E5E5E5">so only a few months ago if you were</font>

595
00:25:57,100 --> 00:26:02,019
using McAfee<font color="#E5E5E5"> Web Gateway this was</font>

596
00:26:00,129 --> 00:26:03,580
introducing a cross-site scripting

597
00:26:02,019 --> 00:26:06,269
vulnerability into the page it showed

598
00:26:03,580 --> 00:26:08,889
for every<font color="#CCCCCC"> domain name they didn't result</font>

599
00:26:06,269 --> 00:26:11,440
this<font color="#E5E5E5"> is quite a good example of how</font>

600
00:26:08,889 --> 00:26:12,729
adding security mechanisms can introduce

601
00:26:11,440 --> 00:26:15,100
vulnerabilities if you

602
00:26:12,730 --> 00:26:16,450
lay<font color="#CCCCCC"> along complexity and additional</font>

603
00:26:15,100 --> 00:26:22,510
layers you'll get interactions between

604
00:26:16,450 --> 00:26:25,120
layers which remove your security<font color="#E5E5E5"> okay</font>

605
00:26:22,510 --> 00:26:26,799
<font color="#E5E5E5">so far</font><font color="#CCCCCC"> I've focused</font><font color="#E5E5E5"> on</font><font color="#CCCCCC"> exploiting sites</font>

606
00:26:25,120 --> 00:26:30,309
that have said<font color="#E5E5E5"> that allow credentials</font>

607
00:26:26,799 --> 00:26:32,830
flag<font color="#E5E5E5"> to trick that's because most of the</font>

608
00:26:30,309 --> 00:26:34,870
time if this flag is set to false<font color="#E5E5E5"> or</font><font color="#CCCCCC"> not</font>

609
00:26:32,830 --> 00:26:37,540
specified which just means it defaults

610
00:26:34,870 --> 00:26:40,590
<font color="#CCCCCC">to false</font><font color="#E5E5E5"> you can't do very much because</font>

611
00:26:37,540 --> 00:26:43,809
<font color="#CCCCCC">you might as well send a request</font>

612
00:26:40,590 --> 00:26:46,389
<font color="#CCCCCC">directly rather than</font><font color="#E5E5E5"> using</font><font color="#CCCCCC"> your victim</font>

613
00:26:43,809 --> 00:26:48,360
<font color="#E5E5E5">to send it but sometimes there's</font>

614
00:26:46,390 --> 00:26:53,710
<font color="#E5E5E5">something about the users</font><font color="#CCCCCC"> environment</font>

615
00:26:48,360 --> 00:26:55,449
which we can exploit the<font color="#E5E5E5"> very well-known</font>

616
00:26:53,710 --> 00:26:57,970
<font color="#E5E5E5">case of this which for the sake</font><font color="#CCCCCC"> of</font>

617
00:26:55,450 --> 00:27:00,460
completeness I absolutely<font color="#E5E5E5"> can't skip is</font>

618
00:26:57,970 --> 00:27:01,840
that<font color="#E5E5E5"> even if you don't allow credentials</font>

619
00:27:00,460 --> 00:27:05,679
if you allow<font color="#CCCCCC"> access from arbitrary</font>

620
00:27:01,840 --> 00:27:08,470
origins using<font color="#E5E5E5"> cause you're losing a lot</font>

621
00:27:05,679 --> 00:27:14,110
of ie IP based<font color="#CCCCCC"> security that your site</font>

622
00:27:08,470 --> 00:27:16,210
might have for example<font color="#E5E5E5"> the the IDE</font>

623
00:27:14,110 --> 00:27:18,070
<font color="#E5E5E5">IntelliJ which was for Java but that</font>

624
00:27:16,210 --> 00:27:21,610
which was for Java development binds a

625
00:27:18,070 --> 00:27:23,500
server to localhost<font color="#E5E5E5"> so you</font><font color="#CCCCCC"> can't access</font>

626
00:27:21,610 --> 00:27:24,820
as an attacker you<font color="#E5E5E5"> can't hit the server</font>

627
00:27:23,500 --> 00:27:27,460
directly<font color="#CCCCCC"> because it's</font><font color="#E5E5E5"> bound to your</font>

628
00:27:24,820 --> 00:27:29,070
<font color="#E5E5E5">victims localhost but</font><font color="#CCCCCC"> someone</font><font color="#E5E5E5"> found that</font>

629
00:27:27,460 --> 00:27:31,510
thanks to their<font color="#CCCCCC"> course configuration</font>

630
00:27:29,070 --> 00:27:35,049
they could ask<font color="#E5E5E5"> this server they could</font>

631
00:27:31,510 --> 00:27:37,030
make you ask the server for<font color="#E5E5E5"> your private</font>

632
00:27:35,049 --> 00:27:40,870
SSH keys which<font color="#CCCCCC"> it would hand over</font><font color="#E5E5E5"> to an</font>

633
00:27:37,030 --> 00:27:42,460
RBC site so<font color="#E5E5E5"> that was kind of bad</font><font color="#CCCCCC"> and in</font>

634
00:27:40,870 --> 00:27:45,428
fact<font color="#E5E5E5"> using a couple</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> additional issues</font>

635
00:27:42,460 --> 00:27:47,650
they got a remote code execution<font color="#CCCCCC"> and</font>

636
00:27:45,429 --> 00:27:49,990
they ultimately<font color="#E5E5E5"> got a $50,000 bounty for</font>

637
00:27:47,650 --> 00:27:52,679
this which<font color="#E5E5E5"> is not bad so I highly</font>

638
00:27:49,990 --> 00:27:54,610
<font color="#CCCCCC">recommend reading the blog post</font><font color="#E5E5E5"> I</font>

639
00:27:52,679 --> 00:27:56,710
submitted something<font color="#E5E5E5"> to those guys</font>

640
00:27:54,610 --> 00:28:00,070
recently<font color="#E5E5E5"> but sadly didn't get $50,000</font>

641
00:27:56,710 --> 00:28:03,610
<font color="#E5E5E5">bounty so if your site uses IP based</font>

642
00:28:00,070 --> 00:28:05,350
<font color="#E5E5E5">access controls IP whiteness or binding</font>

643
00:28:03,610 --> 00:28:07,479
to an inaccessible network interface

644
00:28:05,350 --> 00:28:12,070
you've got to be really<font color="#CCCCCC"> careful with</font>

645
00:28:07,480 --> 00:28:14,919
<font color="#CCCCCC">your use of course now for some more</font>

646
00:28:12,070 --> 00:28:17,409
<font color="#E5E5E5">exciting</font><font color="#CCCCCC"> stuff if you read the core</font>

647
00:28:14,919 --> 00:28:19,840
specification<font color="#E5E5E5"> you'll find a</font><font color="#CCCCCC"> section</font>

648
00:28:17,410 --> 00:28:22,270
titled<font color="#E5E5E5"> implementation considerations and</font>

649
00:28:19,840 --> 00:28:25,689
that's a code<font color="#E5E5E5"> word for hackers</font><font color="#CCCCCC"> please</font>

650
00:28:22,270 --> 00:28:26,530
pay attention<font color="#E5E5E5"> to this section it says</font><font color="#CCCCCC"> if</font>

651
00:28:25,690 --> 00:28:29,440
you dynamic

652
00:28:26,530 --> 00:28:32,800
generate the allow origin header<font color="#E5E5E5"> make</font>

653
00:28:29,440 --> 00:28:35,670
sure you specify<font color="#E5E5E5"> very origin if you</font>

654
00:28:32,800 --> 00:28:38,950
don't then something may go wrong<font color="#CCCCCC"> and</font>

655
00:28:35,670 --> 00:28:40,570
<font color="#E5E5E5">you might</font><font color="#CCCCCC"> think</font><font color="#E5E5E5"> okay specifying a static</font>

656
00:28:38,950 --> 00:28:41,740
header<font color="#E5E5E5"> what could possible who could</font>

657
00:28:40,570 --> 00:28:44,800
fail to<font color="#E5E5E5"> do that</font>

658
00:28:41,740 --> 00:28:47,290
that sounds really<font color="#CCCCCC"> easy</font><font color="#E5E5E5"> and I guess it</font>

659
00:28:44,800 --> 00:28:51,159
is<font color="#CCCCCC"> pretty</font><font color="#E5E5E5"> easy</font><font color="#CCCCCC"> probably the first</font><font color="#E5E5E5"> people</font>

660
00:28:47,290 --> 00:28:53,770
to fail to do<font color="#E5E5E5"> this</font><font color="#CCCCCC"> will the w3c speaking</font>

661
00:28:51,160 --> 00:28:55,510
to this brilliant quote<font color="#CCCCCC"> I must say it</font>

662
00:28:53,770 --> 00:28:57,730
<font color="#E5E5E5">doesn't make me</font><font color="#CCCCCC"> very confident that soon</font>

663
00:28:55,510 --> 00:29:00,160
more sites will<font color="#CCCCCC"> be supporting cause it's</font>

664
00:28:57,730 --> 00:29:02,560
not even the w3c<font color="#E5E5E5"> manages to configure</font>

665
00:29:00,160 --> 00:29:06,160
<font color="#E5E5E5">its server like well said could have</font>

666
00:29:02,560 --> 00:29:08,710
<font color="#E5E5E5">said it better myself so what happens if</font>

667
00:29:06,160 --> 00:29:10,390
you don't<font color="#E5E5E5"> specify this header well most</font>

668
00:29:08,710 --> 00:29:14,910
of the time I<font color="#CCCCCC"> think things will just not</font>

669
00:29:10,390 --> 00:29:17,590
work<font color="#E5E5E5"> but sometimes it's more interesting</font>

670
00:29:14,910 --> 00:29:19,390
<font color="#E5E5E5">if you've done a lot of web</font><font color="#CCCCCC"> app pen</font>

671
00:29:17,590 --> 00:29:21,970
testing<font color="#E5E5E5"> you probably from time to time</font>

672
00:29:19,390 --> 00:29:23,800
encountered an unexploited<font color="#E5E5E5"> or cross-site</font>

673
00:29:21,970 --> 00:29:27,570
scripting vulnerability<font color="#E5E5E5"> that looks</font>

674
00:29:23,800 --> 00:29:29,860
vaguely like<font color="#E5E5E5"> this so here the problem</font><font color="#CCCCCC"> is</font>

675
00:29:27,570 --> 00:29:32,830
that the<font color="#E5E5E5"> users input that's being</font>

676
00:29:29,860 --> 00:29:34,659
reflected<font color="#CCCCCC"> is coming in the</font><font color="#E5E5E5"> X user HTTP</font>

677
00:29:32,830 --> 00:29:36,129
header<font color="#E5E5E5"> and there's no way to make</font>

678
00:29:34,660 --> 00:29:40,000
someone's<font color="#E5E5E5"> browser send that header</font>

679
00:29:36,130 --> 00:29:41,680
<font color="#CCCCCC">across the main normally now thanks to</font>

680
00:29:40,000 --> 00:29:43,990
<font color="#CCCCCC">the course head it</font><font color="#E5E5E5"> though we can see in</font>

681
00:29:41,680 --> 00:29:48,280
the response<font color="#E5E5E5"> we can send this header</font>

682
00:29:43,990 --> 00:29:50,260
<font color="#CCCCCC">cross-domain</font><font color="#E5E5E5"> with some JavaScript now by</font>

683
00:29:48,280 --> 00:29:52,120
<font color="#E5E5E5">itself</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> doesn't actually make this</font>

684
00:29:50,260 --> 00:29:53,710
issue exploitable<font color="#E5E5E5"> because we're sending</font>

685
00:29:52,120 --> 00:29:56,050
this<font color="#E5E5E5"> request with JavaScript the</font>

686
00:29:53,710 --> 00:29:59,110
response is<font color="#E5E5E5"> just landing in a JavaScript</font>

687
00:29:56,050 --> 00:30:01,149
<font color="#E5E5E5">variable so our injected HTML isn't</font>

688
00:29:59,110 --> 00:30:05,560
<font color="#E5E5E5">being rendered it's just being stored in</font>

689
00:30:01,150 --> 00:30:08,320
<font color="#E5E5E5">a variable but if they haven't specified</font>

690
00:30:05,560 --> 00:30:10,030
very origin then this response may be

691
00:30:08,320 --> 00:30:12,580
cached<font color="#CCCCCC"> and</font><font color="#E5E5E5"> may be served up on</font>

692
00:30:10,030 --> 00:30:14,590
<font color="#E5E5E5">subsequent requests to this page so just</font>

693
00:30:12,580 --> 00:30:17,139
<font color="#CCCCCC">by appending a tiny bit more code we can</font>

694
00:30:14,590 --> 00:30:19,240
<font color="#E5E5E5">say send this payload with</font><font color="#CCCCCC"> course and</font>

695
00:30:17,140 --> 00:30:21,970
then we<font color="#CCCCCC"> can redirect the user to</font><font color="#E5E5E5"> exactly</font>

696
00:30:19,240 --> 00:30:24,850
<font color="#E5E5E5">the same</font><font color="#CCCCCC"> euro</font><font color="#E5E5E5"> and the browser will</font>

697
00:30:21,970 --> 00:30:26,860
probably go oh I've already cached this

698
00:30:24,850 --> 00:30:29,770
response and<font color="#E5E5E5"> then show the</font><font color="#CCCCCC"> user the</font><font color="#E5E5E5"> page</font>

699
00:30:26,860 --> 00:30:33,219
with the injected JavaScript so

700
00:30:29,770 --> 00:30:35,620
cross-site scripting someone and because

701
00:30:33,220 --> 00:30:37,810
this<font color="#E5E5E5"> is exploiting the browser cache a</font>

702
00:30:35,620 --> 00:30:40,559
client-side cache<font color="#E5E5E5"> it's actually quite</font>

703
00:30:37,810 --> 00:30:43,360
reliable it works<font color="#E5E5E5"> most of the</font><font color="#CCCCCC"> time</font>

704
00:30:40,559 --> 00:30:44,769
if the stars<font color="#CCCCCC"> are aligned you might be</font>

705
00:30:43,360 --> 00:30:49,719
<font color="#E5E5E5">able to get away with server-side</font><font color="#CCCCCC"> cash</font>

706
00:30:44,769 --> 00:30:52,000
<font color="#CCCCCC">poison</font><font color="#E5E5E5"> it's quite common for sites that</font>

707
00:30:49,720 --> 00:30:54,909
will<font color="#CCCCCC"> say the origin header</font><font color="#E5E5E5"> to reflect it</font>

708
00:30:52,000 --> 00:30:58,659
regardless<font color="#E5E5E5"> of whether it's actually a</font>

709
00:30:54,909 --> 00:31:02,200
valid origin or not<font color="#E5E5E5"> and Internet</font>

710
00:30:58,659 --> 00:31:06,100
Explorer<font color="#E5E5E5"> the guards the regards a</font>

711
00:31:02,200 --> 00:31:09,370
carriage return<font color="#E5E5E5"> i /r as being a valid</font>

712
00:31:06,100 --> 00:31:12,039
<font color="#CCCCCC">terminator for HTTP header so when it</font>

713
00:31:09,370 --> 00:31:13,928
looks at<font color="#E5E5E5"> the response to that to that</font>

714
00:31:12,039 --> 00:31:15,370
<font color="#CCCCCC">request it sees an additional content</font>

715
00:31:13,929 --> 00:31:17,440
type header which changes the<font color="#E5E5E5"> char set</font>

716
00:31:15,370 --> 00:31:18,549
to<font color="#E5E5E5"> UTS</font><font color="#CCCCCC"> seven which</font><font color="#E5E5E5"> is great for</font>

717
00:31:17,440 --> 00:31:22,500
<font color="#E5E5E5">triggering cross-site scripting</font>

718
00:31:18,549 --> 00:31:25,360
vulnerabilities and once again<font color="#E5E5E5"> by itself</font>

719
00:31:22,500 --> 00:31:27,250
<font color="#E5E5E5">this isn't much good because there's no</font>

720
00:31:25,360 --> 00:31:29,709
way I can<font color="#CCCCCC"> make your version</font><font color="#E5E5E5"> of Internet</font>

721
00:31:27,250 --> 00:31:32,889
Explorer<font color="#E5E5E5"> so in such a dodgy origin</font>

722
00:31:29,710 --> 00:31:34,720
header but<font color="#E5E5E5"> what I can do is use</font><font color="#CCCCCC"> book and</font>

723
00:31:32,889 --> 00:31:38,258
manually send<font color="#E5E5E5"> our origin head in myself</font>

724
00:31:34,720 --> 00:31:40,899
<font color="#E5E5E5">and in hope it gets cached on the server</font>

725
00:31:38,259 --> 00:31:42,700
<font color="#CCCCCC">site and served up</font><font color="#E5E5E5"> to other users</font><font color="#CCCCCC"> and if</font>

726
00:31:40,899 --> 00:31:47,799
the very origin header isn't set by the

727
00:31:42,700 --> 00:31:50,379
server that's not implausible<font color="#E5E5E5"> so that's</font>

728
00:31:47,799 --> 00:31:51,759
cool<font color="#E5E5E5"> in theory</font><font color="#CCCCCC"> you can</font><font color="#E5E5E5"> have any kind of</font>

729
00:31:50,379 --> 00:31:53,139
vulnerability<font color="#CCCCCC"> in</font><font color="#E5E5E5"> the processing of the</font>

730
00:31:51,759 --> 00:31:55,720
<font color="#E5E5E5">origin header like someone could be</font>

731
00:31:53,139 --> 00:31:56,979
<font color="#E5E5E5">using in a sequel statement but this is</font>

732
00:31:55,720 --> 00:32:01,779
a<font color="#CCCCCC"> vulnerability with it that I've</font>

733
00:31:56,980 --> 00:32:05,440
actually<font color="#E5E5E5"> seen quite a few</font><font color="#CCCCCC"> times so what</font>

734
00:32:01,779 --> 00:32:06,940
have we<font color="#CCCCCC"> learnt firstly most importantly</font>

735
00:32:05,440 --> 00:32:09,820
if you're a pen<font color="#E5E5E5"> tester make sure you</font>

736
00:32:06,940 --> 00:32:12,549
look<font color="#E5E5E5"> for dynamic generation of course</font>

737
00:32:09,820 --> 00:32:14,980
headers whenever you test<font color="#E5E5E5"> a site you've</font>

738
00:32:12,549 --> 00:32:16,960
got to specify<font color="#CCCCCC"> an</font><font color="#E5E5E5"> origin header that you</font>

739
00:32:14,980 --> 00:32:18,190
think they're<font color="#E5E5E5"> likely to trust to try and</font>

740
00:32:16,960 --> 00:32:21,759
coax them into revealing<font color="#CCCCCC"> this</font>

741
00:32:18,190 --> 00:32:24,370
functionality<font color="#CCCCCC"> and then if you do find</font><font color="#E5E5E5"> it</font>

742
00:32:21,759 --> 00:32:26,860
I just<font color="#CCCCCC"> audit if it has any of the</font>

743
00:32:24,370 --> 00:32:28,360
vulnerabilities<font color="#CCCCCC"> that I've mentioned</font><font color="#E5E5E5"> the</font>

744
00:32:26,860 --> 00:32:29,949
<font color="#CCCCCC">verb suite scanner will of course do</font>

745
00:32:28,360 --> 00:32:32,500
this for you automatically<font color="#E5E5E5"> as</font><font color="#CCCCCC"> I'll</font>

746
00:32:29,950 --> 00:32:33,730
<font color="#E5E5E5">fairly recently</font><font color="#CCCCCC"> but it</font><font color="#E5E5E5"> won't build an</font>

747
00:32:32,500 --> 00:32:38,710
exploit<font color="#CCCCCC"> for you and that's</font><font color="#E5E5E5"> probably</font>

748
00:32:33,730 --> 00:32:41,409
where<font color="#E5E5E5"> the most fun is to be had as far</font>

749
00:32:38,710 --> 00:32:43,450
as the specification goes well I think

750
00:32:41,409 --> 00:32:46,179
the<font color="#E5E5E5"> wild card exception with</font><font color="#CCCCCC"> credentials</font>

751
00:32:43,450 --> 00:32:47,889
<font color="#E5E5E5">has been a good</font><font color="#CCCCCC"> thing for security</font>

752
00:32:46,179 --> 00:32:51,309
because<font color="#CCCCCC"> we've seen it saved sites like</font>

753
00:32:47,889 --> 00:32:53,679
developers<font color="#CCCCCC"> Mozilla</font><font color="#E5E5E5"> dorg</font><font color="#CCCCCC"> but I think it</font>

754
00:32:51,309 --> 00:32:56,590
<font color="#E5E5E5">should be</font><font color="#CCCCCC"> applies to the null origin</font><font color="#E5E5E5"> too</font>

755
00:32:53,680 --> 00:32:58,810
because that's<font color="#E5E5E5"> just as dangerous</font><font color="#CCCCCC"> or it's</font>

756
00:32:56,590 --> 00:33:01,659
more<font color="#CCCCCC"> dangerous at the moment</font><font color="#E5E5E5"> I actually</font>

757
00:32:58,810 --> 00:33:04,270
suggested this to<font color="#CCCCCC"> the</font><font color="#E5E5E5"> WCC earlier this</font>

758
00:33:01,660 --> 00:33:06,180
week and someone<font color="#CCCCCC"> from Dropbox replied</font>

759
00:33:04,270 --> 00:33:09,070
and said<font color="#E5E5E5"> actually Dropbox relies on</font>

760
00:33:06,180 --> 00:33:12,460
having credentialed access to the null

761
00:33:09,070 --> 00:33:14,290
origin<font color="#CCCCCC"> so that might be problematic I</font>

762
00:33:12,460 --> 00:33:15,580
just need to persuade them to<font color="#E5E5E5"> implement</font>

763
00:33:14,290 --> 00:33:17,980
<font color="#E5E5E5">it in a</font><font color="#CCCCCC"> different</font><font color="#E5E5E5"> way and we might be</font>

764
00:33:15,580 --> 00:33:19,419
<font color="#E5E5E5">able to push that</font><font color="#CCCCCC"> forward</font><font color="#E5E5E5"> also</font><font color="#CCCCCC"> I think</font>

765
00:33:17,980 --> 00:33:22,810
the specification should<font color="#E5E5E5"> allow</font><font color="#CCCCCC"> for</font>

766
00:33:19,420 --> 00:33:24,550
partial wildcards<font color="#E5E5E5"> to let people with</font><font color="#CCCCCC"> a</font>

767
00:33:22,810 --> 00:33:26,710
static value<font color="#E5E5E5"> trust all their subdomains</font>

768
00:33:24,550 --> 00:33:32,830
<font color="#E5E5E5">and reduce the number</font><font color="#CCCCCC"> of sites</font><font color="#E5E5E5"> forced to</font>

769
00:33:26,710 --> 00:33:35,820
do dynamic generation as far as browsers

770
00:33:32,830 --> 00:33:38,169
go I definitely think<font color="#E5E5E5"> they should allow</font>

771
00:33:35,820 --> 00:33:40,540
<font color="#E5E5E5">multiple origins</font><font color="#CCCCCC"> to be</font><font color="#E5E5E5"> specified in a</font>

772
00:33:38,170 --> 00:33:42,150
static<font color="#E5E5E5"> way in this header because once</font>

773
00:33:40,540 --> 00:33:44,830
again<font color="#E5E5E5"> that reduces the number of sites</font>

774
00:33:42,150 --> 00:33:47,140
<font color="#E5E5E5">forced to do dynamic generation which</font><font color="#CCCCCC"> is</font>

775
00:33:44,830 --> 00:33:49,300
risky coding and it's often<font color="#E5E5E5"> implemented</font>

776
00:33:47,140 --> 00:33:51,010
in weird places like like in Apache

777
00:33:49,300 --> 00:33:52,540
<font color="#E5E5E5">configs and stuff</font><font color="#CCCCCC"> rather than an actual</font>

778
00:33:51,010 --> 00:33:56,560
code where it's likely<font color="#CCCCCC"> to get</font><font color="#E5E5E5"> a proper</font>

779
00:33:52,540 --> 00:33:58,330
<font color="#E5E5E5">review also browsers could take the</font>

780
00:33:56,560 --> 00:33:59,919
opportunity to block<font color="#E5E5E5"> a reverse mixed</font>

781
00:33:58,330 --> 00:34:02,889
<font color="#CCCCCC">content basically</font><font color="#E5E5E5"> that issue that I</font>

782
00:33:59,920 --> 00:34:05,620
showed you<font color="#E5E5E5"> on Google Finance browsers</font>

783
00:34:02,890 --> 00:34:08,710
already blocked<font color="#E5E5E5"> HTTPS sites trying</font><font color="#CCCCCC"> to</font>

784
00:34:05,620 --> 00:34:13,569
load scripts over<font color="#E5E5E5"> HTTP but</font><font color="#CCCCCC"> they're very</font>

785
00:34:08,710 --> 00:34:17,740
<font color="#E5E5E5">happily as we saw let HTTP site glance</font>

786
00:34:13,570 --> 00:34:20,680
full access to<font color="#CCCCCC"> http origin</font><font color="#E5E5E5"> so why not</font>

787
00:34:17,739 --> 00:34:22,600
<font color="#E5E5E5">just brought</font><font color="#CCCCCC"> that - if you're a</font>

788
00:34:20,679 --> 00:34:24,159
developer<font color="#E5E5E5"> well is possible don't do</font>

789
00:34:22,600 --> 00:34:27,850
dynamic generation of course headers

790
00:34:24,159 --> 00:34:30,969
that's the safest approach<font color="#CCCCCC"> but</font><font color="#E5E5E5"> if you</font>

791
00:34:27,850 --> 00:34:32,770
have to validate with<font color="#CCCCCC"> caution make sure</font>

792
00:34:30,969 --> 00:34:36,189
it gets a security audit<font color="#E5E5E5"> and don't</font>

793
00:34:32,770 --> 00:34:40,480
forget to verify the protocol and always

794
00:34:36,190 --> 00:34:45,429
specify very origin and never trust null

795
00:34:40,480 --> 00:34:47,889
that goes for you to Dropbox<font color="#CCCCCC"> okay you</font>

796
00:34:45,429 --> 00:34:49,359
can grab the slides or<font color="#CCCCCC"> that and there's</font>

797
00:34:47,889 --> 00:34:52,810
a<font color="#CCCCCC"> write up of</font><font color="#E5E5E5"> like the core technical</font>

798
00:34:49,360 --> 00:34:54,970
<font color="#E5E5E5">content of this online and the three key</font>

799
00:34:52,810 --> 00:34:57,070
things to<font color="#E5E5E5"> remember</font><font color="#CCCCCC"> are that cause</font>

800
00:34:54,969 --> 00:35:01,000
msconfig relations are often critical

801
00:34:57,070 --> 00:35:02,980
sometimes<font color="#E5E5E5"> subtle and absolutely out</font>

802
00:35:01,000 --> 00:35:04,960
there if you look<font color="#E5E5E5"> for them I'm going</font><font color="#CCCCCC"> to</font>

803
00:35:02,980 --> 00:35:06,460
<font color="#CCCCCC">take</font><font color="#E5E5E5"> five</font><font color="#CCCCCC"> minutes of</font><font color="#E5E5E5"> questions now and</font>

804
00:35:04,960 --> 00:35:07,810
<font color="#E5E5E5">if you</font><font color="#CCCCCC"> have any more after that after</font>

805
00:35:06,460 --> 00:35:10,150
<font color="#CCCCCC">that you</font><font color="#E5E5E5"> can come</font><font color="#CCCCCC"> and speak</font><font color="#E5E5E5"> to</font>

806
00:35:07,810 --> 00:35:15,820
down the back and also<font color="#E5E5E5"> if you've got any</font>

807
00:35:10,150 --> 00:35:17,680
questions<font color="#CCCCCC"> about the CERN</font><font color="#E5E5E5"> interesting</font>

808
00:35:15,820 --> 00:35:19,930
interplays between<font color="#E5E5E5"> vendors</font><font color="#CCCCCC"> and the</font>

809
00:35:17,680 --> 00:35:21,580
latest<font color="#E5E5E5"> I</font><font color="#CCCCCC"> watch the top 10 and number 7</font>

810
00:35:19,930 --> 00:35:24,970
<font color="#CCCCCC">I'd be</font><font color="#E5E5E5"> very happy</font><font color="#CCCCCC"> to talk about that as</font>

811
00:35:21,580 --> 00:35:25,540
well<font color="#CCCCCC"> yeah don't</font><font color="#E5E5E5"> forget</font><font color="#CCCCCC"> to follow me on</font>

812
00:35:24,970 --> 00:35:43,600
<font color="#E5E5E5">Twitter</font>

813
00:35:25,540 --> 00:35:45,840
thank you for<font color="#E5E5E5"> listening so it the what</font>

814
00:35:43,600 --> 00:35:45,839
<font color="#CCCCCC">Oh</font>

815
00:36:04,860 --> 00:36:12,290
does the flag allow credentials does it

816
00:36:08,430 --> 00:36:16,140
work only with cookies<font color="#CCCCCC"> I think it allows</font>

817
00:36:12,290 --> 00:36:18,690
<font color="#E5E5E5">basic or those</font><font color="#CCCCCC"> you got to but it</font><font color="#E5E5E5"> won't</font>

818
00:36:16,140 --> 00:36:20,160
allow you know like your random<font color="#E5E5E5"> X header</font>

819
00:36:18,690 --> 00:36:22,350
<font color="#E5E5E5">that you've got some JavaScript sticking</font>

820
00:36:20,160 --> 00:36:25,920
on<font color="#E5E5E5"> because you the that's not like a</font>

821
00:36:22,350 --> 00:36:37,860
browser handled<font color="#CCCCCC"> I could enjoy</font><font color="#E5E5E5"> okay</font>

822
00:36:25,920 --> 00:36:40,550
thanks any other questions at all<font color="#CCCCCC"> okay</font>

823
00:36:37,860 --> 00:36:40,550
cool<font color="#E5E5E5"> thank you</font>

