1
00:00:00,439 --> 00:00:07,259
hey hi thank you for joining our next

2
00:00:04,350 --> 00:00:10,950
session and Malta Vic how NLP can help

3
00:00:07,259 --> 00:00:13,049
us understand their web attackers I'll

4
00:00:10,950 --> 00:00:16,378
start with some motivation

5
00:00:13,049 --> 00:00:18,869
so I'm Orion I are from Imperva and

6
00:00:16,379 --> 00:00:22,939
wherever among other things we are air

7
00:00:18,869 --> 00:00:25,619
warfare providers so what we have in the

8
00:00:22,939 --> 00:00:28,380
security security research team we are

9
00:00:25,619 --> 00:00:32,430
seeing a lot of malicious web traffic is

10
00:00:28,380 --> 00:00:34,890
coming to our to our customers and it

11
00:00:32,430 --> 00:00:37,559
comes in different types different the

12
00:00:34,890 --> 00:00:40,770
types of attacks we see a significant

13
00:00:37,559 --> 00:00:42,750
amount of of data there and all the time

14
00:00:40,770 --> 00:00:44,910
we're trying to continue in improving

15
00:00:42,750 --> 00:00:47,010
our security models or attack models

16
00:00:44,910 --> 00:00:49,349
understand better what attackers are

17
00:00:47,010 --> 00:00:52,349
trying to do and how attacks look like

18
00:00:49,350 --> 00:00:57,059
and therefore to provide a better and

19
00:00:52,350 --> 00:00:59,789
better solutions so what we did here we

20
00:00:57,059 --> 00:01:05,369
try to build a new security model and

21
00:00:59,789 --> 00:01:07,979
new glasses to look on a on a malicious

22
00:01:05,369 --> 00:01:10,950
web traffic and with this better attack

23
00:01:07,979 --> 00:01:13,679
modeling we try to use it for different

24
00:01:10,950 --> 00:01:15,509
applications like analytics of attacks a

25
00:01:13,680 --> 00:01:17,670
reconstruction of the attack narratives

26
00:01:15,509 --> 00:01:19,320
done to understand how the attack looked

27
00:01:17,670 --> 00:01:21,869
like then what were the attackers want

28
00:01:19,320 --> 00:01:24,059
to achieve and also for improving our

29
00:01:21,869 --> 00:01:27,110
the accuracy of the rules that we are

30
00:01:24,060 --> 00:01:29,939
using and to detect the false negatives

31
00:01:27,110 --> 00:01:32,130
so I'm an ethnic man team I'm a lead

32
00:01:29,939 --> 00:01:35,039
scientist Imperva I'm a security

33
00:01:32,130 --> 00:01:37,380
innovator algorithm developer and in

34
00:01:35,040 --> 00:01:40,530
general troubles over in the last couple

35
00:01:37,380 --> 00:01:44,750
of years my main focus is to harness the

36
00:01:40,530 --> 00:01:48,030
huge leap in AI technology that change

37
00:01:44,750 --> 00:01:49,799
essentially every every industry to use

38
00:01:48,030 --> 00:01:51,509
it and to harness its to the and for the

39
00:01:49,799 --> 00:01:54,450
sake of improving our security

40
00:01:51,509 --> 00:01:56,070
applications and I hate to get the

41
00:01:54,450 --> 00:01:59,610
offerings so I compensate my office

42
00:01:56,070 --> 00:02:01,048
hours with a lot of hiking biking very

43
00:01:59,610 --> 00:02:05,280
learning and anything that we do well

44
00:02:01,049 --> 00:02:07,890
outdoors and iMovie I'm a data scientist

45
00:02:05,280 --> 00:02:11,250
at improv and I walk along it alongside

46
00:02:07,890 --> 00:02:12,220
ethic I like to find the innovative

47
00:02:11,250 --> 00:02:14,800
solution to come

48
00:02:12,220 --> 00:02:21,780
problems and I'm very disappointed with

49
00:02:14,800 --> 00:02:24,520
the last season of Game of Thrones yes

50
00:02:21,780 --> 00:02:26,050
okay so I think every security vendor

51
00:02:24,520 --> 00:02:28,630
regardless whether it is a web or

52
00:02:26,050 --> 00:02:32,080
database or or antivirus or everybody's

53
00:02:28,630 --> 00:02:35,740
using AI it is being used for for many

54
00:02:32,080 --> 00:02:38,200
many different usages I think they can

55
00:02:35,740 --> 00:02:42,040
essentially be divided into into four

56
00:02:38,200 --> 00:02:45,489
there is this usage of AI for automation

57
00:02:42,040 --> 00:02:48,220
of processes like Incident Response also

58
00:02:45,490 --> 00:02:51,340
for for enhanced the attack detection

59
00:02:48,220 --> 00:02:53,470
like next-generation antivirus and they

60
00:02:51,340 --> 00:02:55,209
are also used being used for security

61
00:02:53,470 --> 00:02:57,550
modeling and attack analytics and

62
00:02:55,209 --> 00:03:00,370
essentially our research focuses on the

63
00:02:57,550 --> 00:03:03,220
it belongs to the last two security

64
00:03:00,370 --> 00:03:06,459
modeling and for and to attack analytics

65
00:03:03,220 --> 00:03:09,359
so I'll start our research is a uses

66
00:03:06,459 --> 00:03:11,260
actually the data categorization of

67
00:03:09,360 --> 00:03:13,870
malicious web traffic the different

68
00:03:11,260 --> 00:03:15,660
attacks so the most popular attacks in

69
00:03:13,870 --> 00:03:18,310
our customers and probably in every

70
00:03:15,660 --> 00:03:19,690
website or a cross-site scripting SQL

71
00:03:18,310 --> 00:03:23,440
injection and remote command execution

72
00:03:19,690 --> 00:03:27,340
and malicious file upload and the path

73
00:03:23,440 --> 00:03:30,040
set reversal the data that we that were

74
00:03:27,340 --> 00:03:33,070
using for this research is again comes

75
00:03:30,040 --> 00:03:36,790
from our couple of hundreds of thousands

76
00:03:33,070 --> 00:03:40,980
of website protected by by our a cloud

77
00:03:36,790 --> 00:03:44,980
wofe a KA a capsula and we are

78
00:03:40,980 --> 00:03:47,048
monitoring seeing about 200 million

79
00:03:44,980 --> 00:03:49,950
probably sometimes more something less

80
00:03:47,049 --> 00:03:52,000
data points every day each one of them

81
00:03:49,950 --> 00:03:56,768
represents this vicious activity that

82
00:03:52,000 --> 00:03:59,110
was detected in in in web requests of

83
00:03:56,769 --> 00:04:02,320
derived one of our customers

84
00:03:59,110 --> 00:04:05,049
now something a little delicate here so

85
00:04:02,320 --> 00:04:07,600
we have many sites that we are

86
00:04:05,049 --> 00:04:10,090
monitoring and seeing and protecting now

87
00:04:07,600 --> 00:04:12,940
our purposes within this research is to

88
00:04:10,090 --> 00:04:15,489
understand the attacks and to model the

89
00:04:12,940 --> 00:04:18,250
attacks however you know in some sense

90
00:04:15,489 --> 00:04:20,769
like in quantum theory the fact that we

91
00:04:18,250 --> 00:04:25,090
are protecting the website and we are

92
00:04:20,769 --> 00:04:26,270
stopping attacks it has an impact on the

93
00:04:25,090 --> 00:04:29,599
attack itself because

94
00:04:26,270 --> 00:04:31,878
I wanted to do ABCDE then he will

95
00:04:29,599 --> 00:04:34,449
probably do a B and get blocked and then

96
00:04:31,879 --> 00:04:36,919
will not be will not make the CDE

97
00:04:34,449 --> 00:04:39,440
however we have a significant amount of

98
00:04:36,919 --> 00:04:42,289
customers that are working in alert only

99
00:04:39,440 --> 00:04:44,780
mode so we focused the research on data

100
00:04:42,289 --> 00:04:48,020
that came from them and in that sense we

101
00:04:44,780 --> 00:04:51,500
got this benefit of looking at the tax

102
00:04:48,020 --> 00:04:54,049
from the beginning till the end without

103
00:04:51,500 --> 00:04:57,319
impacting by our analysis or our

104
00:04:54,050 --> 00:05:00,590
presence there the progress of the

105
00:04:57,319 --> 00:05:03,020
attack and the model itself we're using

106
00:05:00,590 --> 00:05:04,880
a model that is called the work to

107
00:05:03,020 --> 00:05:08,770
vacate how many here in this in the

108
00:05:04,880 --> 00:05:14,060
audience are heard about the work Tyvek

109
00:05:08,770 --> 00:05:17,630
okay so I'll provide some more details

110
00:05:14,060 --> 00:05:20,479
so as most of you know and some of the

111
00:05:17,630 --> 00:05:23,509
of the leap forward in we that are

112
00:05:20,479 --> 00:05:28,849
attributed to AI are in the NLP speech

113
00:05:23,509 --> 00:05:31,060
recognition translation of text and most

114
00:05:28,849 --> 00:05:33,319
some of these significant part of these

115
00:05:31,060 --> 00:05:35,449
can be attributed to the algorithm

116
00:05:33,319 --> 00:05:37,340
called war Tyvek which essentially

117
00:05:35,449 --> 00:05:40,849
decided that was developed by google i

118
00:05:37,340 --> 00:05:42,679
think three years ago four years ago and

119
00:05:40,849 --> 00:05:45,199
what the algorithm does it takes all the

120
00:05:42,680 --> 00:05:49,580
words in the language based on a large

121
00:05:45,199 --> 00:05:51,979
corpus of text and it does embedding of

122
00:05:49,580 --> 00:05:57,349
these words within a high dimensional

123
00:05:51,979 --> 00:06:01,340
space in a way that a word sitar

124
00:05:57,349 --> 00:06:03,800
contextually related are getting very

125
00:06:01,340 --> 00:06:07,698
similar play getting embeddings that are

126
00:06:03,800 --> 00:06:09,199
very close to each other and the reason

127
00:06:07,699 --> 00:06:11,240
for that that there are several reasons

128
00:06:09,199 --> 00:06:14,960
for that some of them are it's very

129
00:06:11,240 --> 00:06:17,120
specific to NLP but other motivations to

130
00:06:14,960 --> 00:06:20,060
do that is that it's facility' is a lot

131
00:06:17,120 --> 00:06:22,069
of very fast calculations for example in

132
00:06:20,060 --> 00:06:25,219
clustering application you usually have

133
00:06:22,069 --> 00:06:27,560
to calculate an you know an n n by n i

134
00:06:25,219 --> 00:06:28,849
quadratic distance matrix between the

135
00:06:27,560 --> 00:06:32,090
objects in your system which is

136
00:06:28,849 --> 00:06:33,680
sometimes a very very heavy but if you

137
00:06:32,090 --> 00:06:37,460
do this embedding then it is very fairly

138
00:06:33,680 --> 00:06:39,710
easy to find the the close vectors to

139
00:06:37,460 --> 00:06:44,900
given it will give an object and to do

140
00:06:39,710 --> 00:06:49,000
it faster and we're Tyvek captures well

141
00:06:44,900 --> 00:06:51,440
a contextual relationship and as

142
00:06:49,000 --> 00:06:53,210
probably those of us familiar with web

143
00:06:51,440 --> 00:06:54,650
attacks you know that web attacks are

144
00:06:53,210 --> 00:06:57,109
not you know just pixels that are

145
00:06:54,650 --> 00:07:00,318
standalone and don't are not related to

146
00:06:57,110 --> 00:07:01,940
each other if you see something if you

147
00:07:00,319 --> 00:07:03,949
see SQL injection then you are very

148
00:07:01,940 --> 00:07:05,870
likely to see another SQL injection and

149
00:07:03,949 --> 00:07:09,199
you are very likely to see another SQL

150
00:07:05,870 --> 00:07:14,949
injection so this idea of words and

151
00:07:09,199 --> 00:07:18,680
sentences is well fits the the web

152
00:07:14,949 --> 00:07:20,750
application security the way work to

153
00:07:18,680 --> 00:07:23,690
Veck works it is based on a neural

154
00:07:20,750 --> 00:07:25,789
networks that the does the optimization

155
00:07:23,690 --> 00:07:29,330
for a decent bedding and there are

156
00:07:25,789 --> 00:07:32,719
several variants some of them are treat

157
00:07:29,330 --> 00:07:35,150
the order of the words like something

158
00:07:32,720 --> 00:07:36,830
that is called s key from the one that

159
00:07:35,150 --> 00:07:38,810
we use is called bag of words it's

160
00:07:36,830 --> 00:07:41,150
independent of the order so we doesn't

161
00:07:38,810 --> 00:07:43,460
care about whether I comes before love

162
00:07:41,150 --> 00:07:46,310
or love count before I you just treats

163
00:07:43,460 --> 00:07:51,530
them in the same way which is makes more

164
00:07:46,310 --> 00:07:56,690
sense in our arena had the success of

165
00:07:51,530 --> 00:07:58,190
work back in in NLP attracted other

166
00:07:56,690 --> 00:08:01,009
domains with try to harness the same

167
00:07:58,190 --> 00:08:04,789
success at their world and indeed there

168
00:08:01,009 --> 00:08:07,340
are in the band from attics arena there

169
00:08:04,789 --> 00:08:09,380
are algorithms like Jean Tuvok that

170
00:08:07,340 --> 00:08:13,250
takes a genetic sequences in that does

171
00:08:09,380 --> 00:08:15,169
their embedding within such a space geek

172
00:08:13,250 --> 00:08:18,740
duvet guy hurting the fiber business to

173
00:08:15,169 --> 00:08:20,389
make a hurt just last week in in data

174
00:08:18,740 --> 00:08:21,949
science conference in Jerusalem and

175
00:08:20,389 --> 00:08:25,280
actually there is some kind of a trend

176
00:08:21,949 --> 00:08:28,370
of anything to that and we said why not

177
00:08:25,280 --> 00:08:31,549
why not having the malicious web traffic

178
00:08:28,370 --> 00:08:36,159
to vac or in short a multi egg and join

179
00:08:31,550 --> 00:08:39,289
the party so here is the essentially the

180
00:08:36,159 --> 00:08:41,390
zoom out of the flow that we are of the

181
00:08:39,289 --> 00:08:42,890
processing that we are doing so we start

182
00:08:41,390 --> 00:08:44,990
with the tag data point attack that once

183
00:08:42,890 --> 00:08:47,329
they have different types these types

184
00:08:44,990 --> 00:08:48,830
are represented here by colors and

185
00:08:47,329 --> 00:08:51,050
spoiler we're going in the

186
00:08:48,830 --> 00:08:54,170
when we are going to show the embeddings

187
00:08:51,050 --> 00:08:56,300
they were also be such a color coding we

188
00:08:54,170 --> 00:08:58,010
do and we aggregate the attacks in two

189
00:08:56,300 --> 00:09:00,859
sessions in a way that ory will

190
00:08:58,010 --> 00:09:03,649
elaborate on later on and we then

191
00:09:00,860 --> 00:09:07,670
convert the sessions from the attack

192
00:09:03,649 --> 00:09:09,769
arena to the the language arena we

193
00:09:07,670 --> 00:09:12,680
convert them into sentences and then we

194
00:09:09,769 --> 00:09:14,690
activate the word to vex algorithm to do

195
00:09:12,680 --> 00:09:17,660
the embedding now the word to vacuum

196
00:09:14,690 --> 00:09:19,970
work can generate vectors of of

197
00:09:17,660 --> 00:09:22,490
different sizes so we use the 30

198
00:09:19,970 --> 00:09:25,610
dimensions in order in order to give us

199
00:09:22,490 --> 00:09:27,680
and you the opportunity to see all these

200
00:09:25,610 --> 00:09:29,450
vectors together we used an algorithm

201
00:09:27,680 --> 00:09:32,630
for a dimensionality reduction which is

202
00:09:29,450 --> 00:09:34,579
called the ATS any TC in order to throw

203
00:09:32,630 --> 00:09:40,970
them into a two dimensional a subspace

204
00:09:34,579 --> 00:09:43,910
and the result is there okay so what we

205
00:09:40,970 --> 00:09:46,310
did exactly for this model we started

206
00:09:43,910 --> 00:09:48,589
with the session aggregation which means

207
00:09:46,310 --> 00:09:51,410
that we take malicious requests that

208
00:09:48,589 --> 00:09:54,320
came that came separately and we

209
00:09:51,410 --> 00:09:58,880
aggregate we aggregated those requests

210
00:09:54,320 --> 00:10:01,220
into a sentence so a sentence or a

211
00:09:58,880 --> 00:10:04,189
session is not the same when we are

212
00:10:01,220 --> 00:10:05,660
talking about HTTP session I'm going to

213
00:10:04,190 --> 00:10:09,279
explain exactly what do I mean by that

214
00:10:05,660 --> 00:10:13,279
the reason we did it is to apply the

215
00:10:09,279 --> 00:10:16,029
work to work algorithm which is based on

216
00:10:13,279 --> 00:10:19,910
contextual information the same as a

217
00:10:16,029 --> 00:10:23,300
natural language which is arranged by

218
00:10:19,910 --> 00:10:26,990
sentences composed of words so our

219
00:10:23,300 --> 00:10:29,240
session or sentence is a list of

220
00:10:26,990 --> 00:10:32,680
requests which are grouped by the source

221
00:10:29,240 --> 00:10:36,589
IP the source device and the target site

222
00:10:32,680 --> 00:10:39,079
and we also added a separation of 15

223
00:10:36,589 --> 00:10:41,720
minutes interval meaning that if we did

224
00:10:39,079 --> 00:10:44,719
not see any requests in that session for

225
00:10:41,720 --> 00:10:48,170
15 minutes then we split it into two

226
00:10:44,720 --> 00:10:51,380
separate sentences so this is what we

227
00:10:48,170 --> 00:10:55,010
did with the with the except the single

228
00:10:51,380 --> 00:10:58,970
request and aggregated into a single

229
00:10:55,010 --> 00:11:00,000
sentence so the next the next thing we

230
00:10:58,970 --> 00:11:02,970
had is we wanted

231
00:11:00,000 --> 00:11:06,860
to model the attacks the vector of the

232
00:11:02,970 --> 00:11:10,140
attack but we had the insight of the

233
00:11:06,860 --> 00:11:12,360
security rules that were triggered so a

234
00:11:10,140 --> 00:11:15,510
malicious request is composed of the

235
00:11:12,360 --> 00:11:18,870
attack type SQL injection or XSS etc and

236
00:11:15,510 --> 00:11:22,830
it has the malicious action the exploit

237
00:11:18,870 --> 00:11:25,770
of the vulnerability or payload and in

238
00:11:22,830 --> 00:11:29,250
purpose woth detects the known exploits

239
00:11:25,770 --> 00:11:31,650
and payloads using a set of rules so on

240
00:11:29,250 --> 00:11:33,870
the one hand we have the malicious after

241
00:11:31,650 --> 00:11:36,030
and on the other hand we have a web

242
00:11:33,870 --> 00:11:39,330
server with the two types of SQL

243
00:11:36,030 --> 00:11:43,319
injection vulnerabilities and the

244
00:11:39,330 --> 00:11:46,200
attacker creates malicious requests and

245
00:11:43,320 --> 00:11:48,870
sent them through the woth which then

246
00:11:46,200 --> 00:11:52,110
blocks these requests using the security

247
00:11:48,870 --> 00:11:55,920
rules later on the attacker might create

248
00:11:52,110 --> 00:11:59,460
other payloads of request to exploit the

249
00:11:55,920 --> 00:12:02,130
second vulnerability and again these

250
00:11:59,460 --> 00:12:08,130
requests are blocked by our woth and

251
00:12:02,130 --> 00:12:13,500
triggers the security rules so now that

252
00:12:08,130 --> 00:12:17,250
we have presented this in this concept I

253
00:12:13,500 --> 00:12:19,710
want to talk about how how the rules are

254
00:12:17,250 --> 00:12:22,050
being selected so a malicious request

255
00:12:19,710 --> 00:12:24,920
might trigger more than one security

256
00:12:22,050 --> 00:12:27,870
rule in this example the SQL injection

257
00:12:24,920 --> 00:12:31,069
we have a four different rules that are

258
00:12:27,870 --> 00:12:35,330
triggered for the single request and

259
00:12:31,070 --> 00:12:40,110
modeling the attack vector into a a word

260
00:12:35,330 --> 00:12:46,080
means that we need to select which would

261
00:12:40,110 --> 00:12:48,780
represent this request so we can use the

262
00:12:46,080 --> 00:12:51,390
two options one option is to use the

263
00:12:48,780 --> 00:12:53,310
wool set meaning that we take everything

264
00:12:51,390 --> 00:12:55,230
all the rules that were triggered for

265
00:12:53,310 --> 00:12:57,089
the single request which is more

266
00:12:55,230 --> 00:13:00,600
accurate but it has an exponent

267
00:12:57,089 --> 00:13:02,430
exponential number of all set words it

268
00:13:00,600 --> 00:13:06,720
grows very large when you have long

269
00:13:02,430 --> 00:13:09,390
sentences and in a very long attack on

270
00:13:06,720 --> 00:13:12,079
the other hand we chose to choose we

271
00:13:09,390 --> 00:13:15,529
chose to use one representativo

272
00:13:12,079 --> 00:13:18,319
selecting it by the severity by how

273
00:13:15,529 --> 00:13:20,269
accurate the wool is and how common it

274
00:13:18,319 --> 00:13:24,259
is meaning that we chose the least

275
00:13:20,269 --> 00:13:28,699
common wool to represent a single

276
00:13:24,259 --> 00:13:31,850
request and of course you have even more

277
00:13:28,699 --> 00:13:34,128
complex examples such as this one which

278
00:13:31,850 --> 00:13:36,920
incorporates eight rules

279
00:13:34,129 --> 00:13:39,889
eight different rules with various types

280
00:13:36,920 --> 00:13:43,128
and again choosing the the one

281
00:13:39,889 --> 00:13:46,179
representative is based on the the

282
00:13:43,129 --> 00:13:49,970
parameters that have explained earlier

283
00:13:46,179 --> 00:13:52,970
so now that we have the concept of what

284
00:13:49,970 --> 00:13:55,369
is a word and what is the sentence we

285
00:13:52,970 --> 00:14:00,259
grouped them together we took the

286
00:13:55,369 --> 00:14:02,839
separate request chose a apresenta t'v

287
00:14:00,259 --> 00:14:05,629
wool for each one and combine them into

288
00:14:02,839 --> 00:14:09,339
a sentence which is now the same as the

289
00:14:05,629 --> 00:14:14,089
natural language we can feed it into the

290
00:14:09,339 --> 00:14:16,989
the waterbag model and that's the demo

291
00:14:14,089 --> 00:14:16,989
of how it looks

292
00:14:23,380 --> 00:14:30,550
okay thank you re so what you can see

293
00:14:26,440 --> 00:14:32,740
here is the embedding of of the rules

294
00:14:30,550 --> 00:14:35,319
actually this is not all the rules of of

295
00:14:32,740 --> 00:14:37,600
the wafak is just a significant amount a

296
00:14:35,320 --> 00:14:39,820
significant portion of them the cut

297
00:14:37,600 --> 00:14:42,010
there is the color coding so the rules

298
00:14:39,820 --> 00:14:46,060
of the same type or the same attack

299
00:14:42,010 --> 00:14:49,870
category are having the same color so

300
00:14:46,060 --> 00:14:52,839
and for example you can see all this

301
00:14:49,870 --> 00:14:55,300
this SQL injection and a cluster and

302
00:14:52,840 --> 00:14:57,070
what you've seen that this text is

303
00:14:55,300 --> 00:15:00,520
actually in the left column you see the

304
00:14:57,070 --> 00:15:03,880
the metadata about the rule itself what

305
00:15:00,520 --> 00:15:05,680
is it identifier it's a type and then

306
00:15:03,880 --> 00:15:09,130
you have at the next five columns or the

307
00:15:05,680 --> 00:15:10,900
five nearest neighbors of this rule and

308
00:15:09,130 --> 00:15:15,130
there are similarity there location and

309
00:15:10,900 --> 00:15:17,699
the most important item here is these

310
00:15:15,130 --> 00:15:19,870
are these numbers which represent the

311
00:15:17,700 --> 00:15:21,670
conditional probability the mutual

312
00:15:19,870 --> 00:15:23,920
conditional probability between this

313
00:15:21,670 --> 00:15:26,110
rule and the neighbor which means that

314
00:15:23,920 --> 00:15:28,719
for example when the whenever this rule

315
00:15:26,110 --> 00:15:32,050
was chosen to represent a malicious

316
00:15:28,720 --> 00:15:34,630
request in 2/3 of the cases in two out

317
00:15:32,050 --> 00:15:37,569
of three cases and we have seen this

318
00:15:34,630 --> 00:15:39,760
rule coming either immediately after or

319
00:15:37,570 --> 00:15:41,590
immediately before this rule many day

320
00:15:39,760 --> 00:15:43,660
we're captured within the same sentence

321
00:15:41,590 --> 00:15:48,070
and when it and for the other way around

322
00:15:43,660 --> 00:15:51,120
it was almost a hundred percent 93% can

323
00:15:48,070 --> 00:15:55,150
you zoom and zoom out for a second

324
00:15:51,120 --> 00:15:57,700
okay so you can see the SQL injection

325
00:15:55,150 --> 00:16:03,490
cluster can you point me to this this

326
00:15:57,700 --> 00:16:09,040
one alright which one that yes so this

327
00:16:03,490 --> 00:16:11,530
one these these guys are for example a

328
00:16:09,040 --> 00:16:12,880
file upload a rules which again we can

329
00:16:11,530 --> 00:16:15,010
see them that they tend to come together

330
00:16:12,880 --> 00:16:16,210
this is not very surprising actually

331
00:16:15,010 --> 00:16:18,730
this is exactly the picture that we

332
00:16:16,210 --> 00:16:20,170
expected to see because we know when

333
00:16:18,730 --> 00:16:21,430
someone wants to do a file upload then

334
00:16:20,170 --> 00:16:22,900
it tries different things and these

335
00:16:21,430 --> 00:16:25,719
these different things are being

336
00:16:22,900 --> 00:16:28,329
captured captured by a different rules

337
00:16:25,720 --> 00:16:30,430
of of the woth so we can see here

338
00:16:28,330 --> 00:16:36,670
numbers that are even more significant

339
00:16:30,430 --> 00:16:42,010
than death and another example let's

340
00:16:36,670 --> 00:16:42,550
this one alright which one this one okay

341
00:16:42,010 --> 00:16:44,319
thank you

342
00:16:42,550 --> 00:16:46,750
this is a slightly different because

343
00:16:44,320 --> 00:16:48,220
what we see here is rules of of

344
00:16:46,750 --> 00:16:49,360
different types or different data

345
00:16:48,220 --> 00:16:52,000
categories that are coming together

346
00:16:49,360 --> 00:16:53,440
which is a at the beginning it wasn't

347
00:16:52,000 --> 00:16:55,570
surprising but then we looked at these

348
00:16:53,440 --> 00:16:57,280
rules and you see that one rule is a

349
00:16:55,570 --> 00:17:00,340
file upload which means that the

350
00:16:57,280 --> 00:17:04,449
attacker tried to upload some malicious

351
00:17:00,340 --> 00:17:07,060
file and for any purpose to the a to the

352
00:17:04,449 --> 00:17:08,500
web server and next we are seeing vector

353
00:17:07,060 --> 00:17:09,698
communication meaning that someone is

354
00:17:08,500 --> 00:17:12,640
trying to communicate with the back door

355
00:17:09,699 --> 00:17:15,130
so but then we figured out that this is

356
00:17:12,640 --> 00:17:17,140
a it makes a lot of sense because thats

357
00:17:15,130 --> 00:17:19,270
the first moment it tries to do the file

358
00:17:17,140 --> 00:17:20,980
upload and if you succeed it then does

359
00:17:19,270 --> 00:17:23,829
backdoor communication and then we

360
00:17:20,980 --> 00:17:25,709
wanted to go and let the customer know

361
00:17:23,829 --> 00:17:28,600
because this is something that actually

362
00:17:25,709 --> 00:17:30,310
happened it means that it has the file

363
00:17:28,600 --> 00:17:33,310
upload was successful and it has the

364
00:17:30,310 --> 00:17:35,940
backdoor installed however go back to

365
00:17:33,310 --> 00:17:35,940
your presentation

366
00:17:39,809 --> 00:17:46,259
so our some of our security experts

367
00:17:42,889 --> 00:17:48,658
provided an alternative explanation that

368
00:17:46,259 --> 00:17:51,719
it showed us this example and other

369
00:17:48,659 --> 00:17:55,919
examples this is I think it's called an

370
00:17:51,719 --> 00:17:58,049
ex attacker which attacks a plug-in

371
00:17:55,919 --> 00:18:00,149
called the archery where there is the

372
00:17:58,049 --> 00:18:02,129
attack script what he does is first it

373
00:18:00,149 --> 00:18:03,689
tries to do the file upload the way the

374
00:18:02,129 --> 00:18:06,330
upload of the back door and immediately

375
00:18:03,690 --> 00:18:09,119
later maybe even in order to validate

376
00:18:06,330 --> 00:18:10,619
that it was successful he goes and tried

377
00:18:09,119 --> 00:18:12,899
to communicate with the back door so

378
00:18:10,619 --> 00:18:16,259
what we've seen was not necessarily an

379
00:18:12,899 --> 00:18:22,129
successful a file upload but maybe it

380
00:18:16,259 --> 00:18:26,099
needs successful one okay so after

381
00:18:22,129 --> 00:18:28,228
modeling our were to Vic version which

382
00:18:26,099 --> 00:18:30,259
we called mouth to vac we came up with a

383
00:18:28,229 --> 00:18:32,879
few applications what can we do with it

384
00:18:30,259 --> 00:18:35,759
the first the first application was to

385
00:18:32,879 --> 00:18:38,189
find the false negatives and by which I

386
00:18:35,759 --> 00:18:40,889
mean that we have we have some security

387
00:18:38,190 --> 00:18:43,529
rules which are in research mode meaning

388
00:18:40,889 --> 00:18:45,899
that they are not blocking usually we

389
00:18:43,529 --> 00:18:48,899
use it to gather information and Intel

390
00:18:45,899 --> 00:18:51,539
about what's going on over the network

391
00:18:48,899 --> 00:18:54,599
of our customers sometimes these rules

392
00:18:51,539 --> 00:18:56,549
are just regular rules in staging mode

393
00:18:54,599 --> 00:18:59,399
which means that we want to move them to

394
00:18:56,549 --> 00:19:02,039
blocking but we test them before so

395
00:18:59,399 --> 00:19:05,218
using a version of word to back we were

396
00:19:02,039 --> 00:19:08,820
able to identify such words in research

397
00:19:05,219 --> 00:19:12,149
mode which correlates highly with the

398
00:19:08,820 --> 00:19:14,968
other blocking rules and which is yet

399
00:19:12,149 --> 00:19:17,928
suggested to us that we can use these

400
00:19:14,969 --> 00:19:21,179
research rules and maybe create a new

401
00:19:17,929 --> 00:19:23,309
blocking rule to capture the attacks

402
00:19:21,179 --> 00:19:25,739
that we are not currently protecting

403
00:19:23,309 --> 00:19:32,129
against and I'm going to show you an

404
00:19:25,739 --> 00:19:37,349
example of such such rule so we added to

405
00:19:32,129 --> 00:19:39,779
this diagram the okay so this is the

406
00:19:37,349 --> 00:19:42,779
original one and we added all the rules

407
00:19:39,779 --> 00:19:44,519
that are research mode you can see that

408
00:19:42,779 --> 00:19:47,399
they're a little bit transparent like

409
00:19:44,519 --> 00:19:50,759
this one and this one so next to this

410
00:19:47,399 --> 00:19:53,040
cluster of SQL injection we found a

411
00:19:50,759 --> 00:19:54,870
research mode which has

412
00:19:53,040 --> 00:19:58,590
very high correlation with all the

413
00:19:54,870 --> 00:20:01,439
others in that group it is when we did

414
00:19:58,590 --> 00:20:04,889
the testing it was not blocking but you

415
00:20:01,440 --> 00:20:07,290
can see that since it is highly

416
00:20:04,890 --> 00:20:10,380
correlated with other wools filing

417
00:20:07,290 --> 00:20:14,820
together this is a good candidate to

418
00:20:10,380 --> 00:20:18,000
move to blocking another example that

419
00:20:14,820 --> 00:20:23,280
I'm gonna show you is is this one which

420
00:20:18,000 --> 00:20:25,950
is a remote code execution hall and

421
00:20:23,280 --> 00:20:29,129
again very highly correlated with other

422
00:20:25,950 --> 00:20:32,070
rules all of these information based on

423
00:20:29,130 --> 00:20:35,190
many many attacks and requests is very

424
00:20:32,070 --> 00:20:39,030
visible thanks to the to the world tuvok

425
00:20:35,190 --> 00:20:41,760
model and the disney dimensionality

426
00:20:39,030 --> 00:20:46,770
reduction which is this diagram that you

427
00:20:41,760 --> 00:20:53,070
can see so an example concrete example

428
00:20:46,770 --> 00:20:57,480
of such rule is is this one which is the

429
00:20:53,070 --> 00:21:00,080
research rule is the an attack against

430
00:20:57,480 --> 00:21:05,250
the up artist what vulnerability with

431
00:21:00,080 --> 00:21:06,720
over 900,000 hits in three months and it

432
00:21:05,250 --> 00:21:12,180
highly correlated with the path

433
00:21:06,720 --> 00:21:14,700
traversal attack over 700,000 hits in

434
00:21:12,180 --> 00:21:16,980
three months and the dominant client

435
00:21:14,700 --> 00:21:19,980
used to launch these attacks was the

436
00:21:16,980 --> 00:21:22,170
white hat vulnerability scanner and in

437
00:21:19,980 --> 00:21:25,710
our model in the world of X similarity

438
00:21:22,170 --> 00:21:29,550
we got a 99.9 percent similar between

439
00:21:25,710 --> 00:21:32,490
these tools so this was the main

440
00:21:29,550 --> 00:21:37,530
motivation that we came up with to begin

441
00:21:32,490 --> 00:21:39,240
with what we wanted to achieve another

442
00:21:37,530 --> 00:21:42,360
application that I want to present here

443
00:21:39,240 --> 00:21:45,750
is the scanner modeling so we wanted to

444
00:21:42,360 --> 00:21:50,729
detect automatic tools which impulse

445
00:21:45,750 --> 00:21:54,120
impulse impersonate to be a browser so

446
00:21:50,730 --> 00:21:57,090
how we did it we created a separate

447
00:21:54,120 --> 00:22:00,300
Markovic model for common scanner one

448
00:21:57,090 --> 00:22:03,600
model pearl scanner we selected attack

449
00:22:00,300 --> 00:22:04,700
sentence which has the browser as a user

450
00:22:03,600 --> 00:22:07,429
agent

451
00:22:04,700 --> 00:22:10,310
Chrome or Mozilla Firefox and then we

452
00:22:07,430 --> 00:22:13,520
found the model which has the highest

453
00:22:10,310 --> 00:22:15,649
correlation with that sentence and the

454
00:22:13,520 --> 00:22:19,280
result was the probability for each

455
00:22:15,650 --> 00:22:22,610
model to be the origin of that that

456
00:22:19,280 --> 00:22:25,250
sentence or that attack so this is a

457
00:22:22,610 --> 00:22:28,340
concrete example you can see here that

458
00:22:25,250 --> 00:22:31,130
the user agent is Mozilla Chrome and the

459
00:22:28,340 --> 00:22:33,620
sentence is the composed of part of the

460
00:22:31,130 --> 00:22:35,840
self I'll upload an automatic attack and

461
00:22:33,620 --> 00:22:37,820
remote code execution on the left you

462
00:22:35,840 --> 00:22:40,600
can see the rules numbers and on the

463
00:22:37,820 --> 00:22:44,450
right the types and diagram shows the

464
00:22:40,600 --> 00:22:47,540
probability that the model produced for

465
00:22:44,450 --> 00:22:53,420
each of these tools that we get

466
00:22:47,540 --> 00:22:57,379
remodeled more examples are here you can

467
00:22:53,420 --> 00:23:01,070
see the necessary scanner the SQL map

468
00:22:57,380 --> 00:23:04,610
which not surprisingly based on the SQL

469
00:23:01,070 --> 00:23:07,100
injection attacks and you can see on the

470
00:23:04,610 --> 00:23:10,129
other hand that you don't always get the

471
00:23:07,100 --> 00:23:13,429
most perfect prediction or correlation

472
00:23:10,130 --> 00:23:16,490
sometimes you have to set of scanners

473
00:23:13,430 --> 00:23:19,550
which correlates with high covered high

474
00:23:16,490 --> 00:23:23,090
correlation to the attack but it gives

475
00:23:19,550 --> 00:23:28,399
us better understanding about the origin

476
00:23:23,090 --> 00:23:30,649
even though we ignore the the I don't

477
00:23:28,400 --> 00:23:37,430
know they declared the web application

478
00:23:30,650 --> 00:23:39,170
or overuse the reject thank you re so we

479
00:23:37,430 --> 00:23:41,690
have several other applications that we

480
00:23:39,170 --> 00:23:45,050
had there in mind that we found them

481
00:23:41,690 --> 00:23:47,570
this modeling useful to assessment of

482
00:23:45,050 --> 00:23:50,570
the relation between different events

483
00:23:47,570 --> 00:23:52,909
and when we are trying to understand to

484
00:23:50,570 --> 00:23:55,460
reconstruct the narrative of the attacks

485
00:23:52,910 --> 00:23:57,290
you see a lot of I call this a security

486
00:23:55,460 --> 00:23:59,120
pixels I want to get security picture to

487
00:23:57,290 --> 00:24:00,139
understand which events are related to

488
00:23:59,120 --> 00:24:04,969
each other they belong to the same

489
00:24:00,140 --> 00:24:07,070
attack then we we use the fact that the

490
00:24:04,970 --> 00:24:09,440
events have had triggered a rules that

491
00:24:07,070 --> 00:24:11,090
are very close to each other as an

492
00:24:09,440 --> 00:24:12,350
indication that they are close and if

493
00:24:11,090 --> 00:24:14,570
there are distance from each other it is

494
00:24:12,350 --> 00:24:17,379
an indication that they are not related

495
00:24:14,570 --> 00:24:19,000
in order to

496
00:24:17,380 --> 00:24:21,910
even for assessment of the severity of

497
00:24:19,000 --> 00:24:26,350
the attacks whenever we see a sentence

498
00:24:21,910 --> 00:24:28,870
that we that includes words that are

499
00:24:26,350 --> 00:24:31,629
distance for each other then one

500
00:24:28,870 --> 00:24:33,280
possible explanation is that this is

501
00:24:31,630 --> 00:24:35,620
something that is that is unique that is

502
00:24:33,280 --> 00:24:38,230
not standard and I think of that from a

503
00:24:35,620 --> 00:24:40,719
security officer perspective whenever

504
00:24:38,230 --> 00:24:42,520
someone does is very prey and activates

505
00:24:40,720 --> 00:24:44,410
different scanners and okay this is

506
00:24:42,520 --> 00:24:45,760
yada-yada we are good we know we are

507
00:24:44,410 --> 00:24:46,929
protected everything is good but

508
00:24:45,760 --> 00:24:49,210
wherever someone is doing something

509
00:24:46,929 --> 00:24:50,650
unique maybe this is a personal attack a

510
00:24:49,210 --> 00:24:53,260
targeted attack someone is trying to

511
00:24:50,650 --> 00:24:55,350
attack specifically his application and

512
00:24:53,260 --> 00:24:59,289
this is more concerning and may be a

513
00:24:55,350 --> 00:25:01,178
requires some action from dursa and also

514
00:24:59,289 --> 00:25:04,020
it makes us very happy from a research

515
00:25:01,179 --> 00:25:06,490
perspective we have this modeling for a

516
00:25:04,020 --> 00:25:10,270
for doing analysis of the attacks you

517
00:25:06,490 --> 00:25:11,710
have very a nice and good picture of the

518
00:25:10,270 --> 00:25:13,990
idea attacks that we're seeing in the

519
00:25:11,710 --> 00:25:15,669
relation between them and it is good the

520
00:25:13,990 --> 00:25:18,549
lead generation for analysis of

521
00:25:15,669 --> 00:25:23,580
detection of unique things that are

522
00:25:18,549 --> 00:25:28,360
happening within our customers ecosystem

523
00:25:23,580 --> 00:25:30,460
so let me summarize and so first like

524
00:25:28,360 --> 00:25:32,469
we've seen that the web attacks fit very

525
00:25:30,460 --> 00:25:35,429
well at least work to Veck not oh this

526
00:25:32,470 --> 00:25:38,140
was our basic assumption and it was

527
00:25:35,429 --> 00:25:41,200
actually we saw that this is this is

528
00:25:38,140 --> 00:25:44,320
correct this idea of of words and

529
00:25:41,200 --> 00:25:47,919
sentences and security events and in

530
00:25:44,320 --> 00:25:50,408
sequences of web attacks that seem that

531
00:25:47,919 --> 00:25:52,720
these words I have a lot of in parallel

532
00:25:50,409 --> 00:25:54,220
and it can be used for variety of

533
00:25:52,720 --> 00:25:56,380
security applications we found several

534
00:25:54,220 --> 00:26:00,429
ones maybe I others can find the others

535
00:25:56,380 --> 00:26:04,000
each one in his domain and what anyone

536
00:26:00,429 --> 00:26:07,440
with either interest conclusions so

537
00:26:04,000 --> 00:26:10,659
first AI technology is proven again as a

538
00:26:07,440 --> 00:26:13,870
game-changer in security applications in

539
00:26:10,659 --> 00:26:17,200
all from whatever direction you look at

540
00:26:13,870 --> 00:26:19,449
the world of cyber security AI can be

541
00:26:17,200 --> 00:26:20,620
used to to improve it and to make things

542
00:26:19,450 --> 00:26:22,960
much better than before

543
00:26:20,620 --> 00:26:26,379
also from the attackers perspective but

544
00:26:22,960 --> 00:26:28,450
also from our perspective and more

545
00:26:26,380 --> 00:26:30,159
important when bringing security experts

546
00:26:28,450 --> 00:26:30,730
and data scientists and data all

547
00:26:30,159 --> 00:26:32,590
together in

548
00:26:30,730 --> 00:26:35,650
same room or in the same building or the

549
00:26:32,590 --> 00:26:47,260
same world then interesting things that

550
00:26:35,650 --> 00:26:54,900
happen thank you very much and any

551
00:26:47,260 --> 00:26:58,330
questions can you repeat the question

552
00:26:54,900 --> 00:26:59,710
I'm from the mag so everyone hears you

553
00:26:58,330 --> 00:27:03,250
know what are you using to run the

554
00:26:59,710 --> 00:27:06,940
models Hadoop or another system but we

555
00:27:03,250 --> 00:27:10,030
change limitation off my work Tyvek we

556
00:27:06,940 --> 00:27:13,200
just used the Python library which is it

557
00:27:10,030 --> 00:27:13,200
Jensen Jensen yeah

558
00:27:14,520 --> 00:27:19,690
any other questions okay

559
00:27:17,770 --> 00:27:22,629
so we are considering maybe to release

560
00:27:19,690 --> 00:27:27,120
this as an open source at some point so

561
00:27:22,630 --> 00:27:27,120
stay tuned yeah thank you

