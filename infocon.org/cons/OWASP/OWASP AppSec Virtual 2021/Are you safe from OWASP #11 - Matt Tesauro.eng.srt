1
00:00:01,420 --> 00:00:05,040
[Music]

2
00:00:05,040 --> 00:00:06,399
all right thank you very much and

3
00:00:06,399 --> 00:00:08,720
welcome to are you safe from oh wasp

4
00:00:08,720 --> 00:00:11,599
number 11 and hopefully you are

5
00:00:11,599 --> 00:00:14,000
so let's get this let's get this ball

6
00:00:14,000 --> 00:00:16,800
rolling

7
00:00:16,800 --> 00:00:19,119
so first i'd like to set the scene um

8
00:00:19,119 --> 00:00:20,000
and

9
00:00:20,000 --> 00:00:21,520
i'm going to speak from the perspective

10
00:00:21,520 --> 00:00:23,600
that you're saying appsec you're running

11
00:00:23,600 --> 00:00:25,039
an appsec program maybe you have a

12
00:00:25,039 --> 00:00:26,400
product security program because you

13
00:00:26,400 --> 00:00:28,560
want to call it that whatever it is and

14
00:00:28,560 --> 00:00:31,039
you're floating on a sea of software

15
00:00:31,039 --> 00:00:33,440
there is tons of custom built internal

16
00:00:33,440 --> 00:00:34,880
pieces of software and you're just

17
00:00:34,880 --> 00:00:37,120
trying to make sense of it right this is

18
00:00:37,120 --> 00:00:38,800
generally what happens to people that

19
00:00:38,800 --> 00:00:41,040
are in an appsec role it's kind of a fun

20
00:00:41,040 --> 00:00:44,239
and challenging place to be at times

21
00:00:44,239 --> 00:00:46,079
and so you're focused on trying to get

22
00:00:46,079 --> 00:00:48,079
those easy quick wins right and you want

23
00:00:48,079 --> 00:00:50,480
to get the big things out of the way so

24
00:00:50,480 --> 00:00:52,160
audit is coming to you and talking to

25
00:00:52,160 --> 00:00:54,480
you using the os top 10 as kind of their

26
00:00:54,480 --> 00:00:56,559
their talking points

27
00:00:56,559 --> 00:00:59,280
you've got devs um who've taken some of

28
00:00:59,280 --> 00:01:01,199
us top 10 training so

29
00:01:01,199 --> 00:01:03,680
you're feeling like hey i might actually

30
00:01:03,680 --> 00:01:05,280
you know even though i'm i'm sailing on

31
00:01:05,280 --> 00:01:07,760
this little raft with the uh with the

32
00:01:07,760 --> 00:01:10,240
sail of the oaus top 10 i may actually

33
00:01:10,240 --> 00:01:12,080
be close to land i may be able to

34
00:01:12,080 --> 00:01:13,200
actually

35
00:01:13,200 --> 00:01:15,600
start moving forward with my appsec

36
00:01:15,600 --> 00:01:16,880
program

37
00:01:16,880 --> 00:01:19,280
but there's something you missed

38
00:01:19,280 --> 00:01:22,320
right and that something you missed

39
00:01:22,320 --> 00:01:24,400
is oas number 11.

40
00:01:24,400 --> 00:01:26,080
and what i mean by that is all those

41
00:01:26,080 --> 00:01:27,920
things that aren't in the top 10 right

42
00:01:27,920 --> 00:01:29,840
the reason it's called the top 10 is

43
00:01:29,840 --> 00:01:32,400
because there's more than 10. right kind

44
00:01:32,400 --> 00:01:34,000
of academic so

45
00:01:34,000 --> 00:01:35,680
you have to be careful that even though

46
00:01:35,680 --> 00:01:37,600
maybe it might make sense to start with

47
00:01:37,600 --> 00:01:38,880
the top 10

48
00:01:38,880 --> 00:01:40,400
your program really needs to do more

49
00:01:40,400 --> 00:01:41,759
than that and it needs to be much more

50
00:01:41,759 --> 00:01:43,360
holistic

51
00:01:43,360 --> 00:01:44,399
so

52
00:01:44,399 --> 00:01:46,880
i stepped back and did a little look at

53
00:01:46,880 --> 00:01:49,119
the top 10 and i've been around owasp

54
00:01:49,119 --> 00:01:51,840
for far too long since 2008

55
00:01:51,840 --> 00:01:53,600
and i've seen many different versions of

56
00:01:53,600 --> 00:01:56,079
it over time and it's evolved obviously

57
00:01:56,079 --> 00:01:58,000
and changed over time and

58
00:01:58,000 --> 00:01:59,840
one of the original things with the very

59
00:01:59,840 --> 00:02:01,840
first top 10 it was focused on the top

60
00:02:01,840 --> 00:02:03,920
10 vulnerabilities

61
00:02:03,920 --> 00:02:05,759
later on they made a change to focus on

62
00:02:05,759 --> 00:02:07,520
risks which i think was a fantastic

63
00:02:07,520 --> 00:02:09,280
change

64
00:02:09,280 --> 00:02:11,038
and then as you watch the more current

65
00:02:11,038 --> 00:02:13,520
iterations happen you notice that the

66
00:02:13,520 --> 00:02:14,480
risks

67
00:02:14,480 --> 00:02:16,319
go to more and more general categories

68
00:02:16,319 --> 00:02:18,080
so the sort of the scope

69
00:02:18,080 --> 00:02:19,599
of what's covered by the top ten has

70
00:02:19,599 --> 00:02:21,840
changed over time and i well and i think

71
00:02:21,840 --> 00:02:24,160
that's a very fantastic thing and it

72
00:02:24,160 --> 00:02:26,959
kind of argues to my point that the os

73
00:02:26,959 --> 00:02:29,120
top 10 is just the starting place and

74
00:02:29,120 --> 00:02:30,879
even though they've increased the scope

75
00:02:30,879 --> 00:02:32,160
over time

76
00:02:32,160 --> 00:02:33,760
it hasn't quite covered all of the

77
00:02:33,760 --> 00:02:35,680
possibilities right and if you look at

78
00:02:35,680 --> 00:02:37,200
this graphic i

79
00:02:37,200 --> 00:02:40,000
borrowed from the oauth website

80
00:02:40,000 --> 00:02:41,920
you'll see those ones in orange are ones

81
00:02:41,920 --> 00:02:43,680
that got

82
00:02:43,680 --> 00:02:45,840
combined or renamed into larger broader

83
00:02:45,840 --> 00:02:48,400
categories

84
00:02:48,400 --> 00:02:50,800
and then the ones in yellow are ones

85
00:02:50,800 --> 00:02:52,879
that were combined with existing

86
00:02:52,879 --> 00:02:55,200
or other uh categories so you have ones

87
00:02:55,200 --> 00:02:56,800
that sort of got compressed into more

88
00:02:56,800 --> 00:02:58,239
broad categories and other ones that

89
00:02:58,239 --> 00:02:59,280
became

90
00:02:59,280 --> 00:03:01,360
different categories and so the net of

91
00:03:01,360 --> 00:03:02,959
this is is we have

92
00:03:02,959 --> 00:03:05,599
an increasingly broad

93
00:03:05,599 --> 00:03:08,640
oas top 10 happening which is fantastic

94
00:03:08,640 --> 00:03:10,480
but even with that top 10

95
00:03:10,480 --> 00:03:12,720
you could still be missing something

96
00:03:12,720 --> 00:03:16,159
and right straight off from the website

97
00:03:16,159 --> 00:03:17,760
this is a pull quote i pulled directly

98
00:03:17,760 --> 00:03:19,280
off the owasp website globally

99
00:03:19,280 --> 00:03:21,360
recognized by developers as the first

100
00:03:21,360 --> 00:03:22,239
step

101
00:03:22,239 --> 00:03:25,040
the first step towards more secure

102
00:03:25,040 --> 00:03:27,760
coding right underline was added by me

103
00:03:27,760 --> 00:03:29,920
but i think a lot of people think it's

104
00:03:29,920 --> 00:03:33,280
the ceiling not the floor and really

105
00:03:33,280 --> 00:03:34,959
topped in as the floor

106
00:03:34,959 --> 00:03:37,280
and i was on the website i was curious

107
00:03:37,280 --> 00:03:38,640
so i poked around on the list of

108
00:03:38,640 --> 00:03:39,920
projects

109
00:03:39,920 --> 00:03:42,720
and i found 12 additional

110
00:03:42,720 --> 00:03:45,519
variations on the oauth top 10 theme the

111
00:03:45,519 --> 00:03:47,840
mobile top 10 the api security top 10

112
00:03:47,840 --> 00:03:50,400
those are actually fairly popular um the

113
00:03:50,400 --> 00:03:52,319
rest of these less so

114
00:03:52,319 --> 00:03:54,239
but we could actually have

115
00:03:54,239 --> 00:03:58,400
i realized a top 10 list of top 10 lists

116
00:03:58,400 --> 00:04:00,400
right because we have 13. like we could

117
00:04:00,400 --> 00:04:02,640
do this the math works

118
00:04:02,640 --> 00:04:05,280
right now obviously that's not my

119
00:04:05,280 --> 00:04:06,319
intention

120
00:04:06,319 --> 00:04:08,319
but if you look at this this tells you

121
00:04:08,319 --> 00:04:09,920
that humans have this pension for

122
00:04:09,920 --> 00:04:12,159
wanting to look at the top 10 things i

123
00:04:12,159 --> 00:04:13,680
don't know why that's such a thing but

124
00:04:13,680 --> 00:04:15,599
it's just part of our human nature and

125
00:04:15,599 --> 00:04:16,880
you need to fight that part of your

126
00:04:16,880 --> 00:04:19,759
human nature and look beyond the top ten

127
00:04:19,759 --> 00:04:21,839
because sometimes it's the simple things

128
00:04:21,839 --> 00:04:23,199
that bite you

129
00:04:23,199 --> 00:04:25,120
so i'm gonna tell a little story i've

130
00:04:25,120 --> 00:04:27,520
done a bunch of pen testing in my life

131
00:04:27,520 --> 00:04:29,280
in this one particular case i was pen

132
00:04:29,280 --> 00:04:31,600
testing at a large u.s

133
00:04:31,600 --> 00:04:33,199
insurance company

134
00:04:33,199 --> 00:04:35,840
and i'm testing a web app of theirs

135
00:04:35,840 --> 00:04:38,160
and i'm poking around and i find a

136
00:04:38,160 --> 00:04:40,400
the ability to sort and search through

137
00:04:40,400 --> 00:04:42,720
some records

138
00:04:42,720 --> 00:04:45,040
and i'm in the states so i'm going to

139
00:04:45,040 --> 00:04:46,479
look for smith because that's a common

140
00:04:46,479 --> 00:04:48,960
name so search for last name smith

141
00:04:48,960 --> 00:04:53,199
i get 6 800 some odd results back

142
00:04:53,199 --> 00:04:56,880
okay great it's got pagination right 25

143
00:04:56,880 --> 00:04:59,280
50 100 per page i change it

144
00:04:59,280 --> 00:05:02,000
from 25 to 50 per page

145
00:05:02,000 --> 00:05:05,520
i see in my proxy zap of course

146
00:05:05,520 --> 00:05:07,520
i see in zap that hey that 50 is

147
00:05:07,520 --> 00:05:10,080
actually being sent as a parameter

148
00:05:10,080 --> 00:05:11,600
that's awfully curious i wonder what

149
00:05:11,600 --> 00:05:13,840
happens if i change that 50 to 68 and

150
00:05:13,840 --> 00:05:17,520
100 and change right so i do

151
00:05:17,520 --> 00:05:19,919
and what happens is 12 very sweaty

152
00:05:19,919 --> 00:05:22,720
minutes of sitting on site at the client

153
00:05:22,720 --> 00:05:24,560
realizing you may have just dosed their

154
00:05:24,560 --> 00:05:27,919
app now luckily after 12 minutes

155
00:05:27,919 --> 00:05:30,800
i finally got a page back and i did

156
00:05:30,800 --> 00:05:32,479
poke a co-worker but that was also with

157
00:05:32,479 --> 00:05:34,240
me and i said hey go to this url make

158
00:05:34,240 --> 00:05:35,600
sure it comes up and he's like well it's

159
00:05:35,600 --> 00:05:37,280
taking forever but it's coming up i'm

160
00:05:37,280 --> 00:05:40,960
like okay whoo so this was almost a one

161
00:05:40,960 --> 00:05:42,639
request dos

162
00:05:42,639 --> 00:05:44,639
simply by changing an end to a larger

163
00:05:44,639 --> 00:05:47,120
number right failure to validate that

164
00:05:47,120 --> 00:05:48,800
data

165
00:05:48,800 --> 00:05:50,320
but this is a simple thing this isn't

166
00:05:50,320 --> 00:05:52,400
any kind of crazy elite attack

167
00:05:52,400 --> 00:05:54,080
right so you may have done the top 10

168
00:05:54,080 --> 00:05:55,600
and your your developers understand

169
00:05:55,600 --> 00:05:58,960
those 10 high category risks

170
00:05:58,960 --> 00:06:00,240
but they may not get you all the way

171
00:06:00,240 --> 00:06:02,319
there

172
00:06:02,319 --> 00:06:04,240
so i'm going to talk about a couple of

173
00:06:04,240 --> 00:06:06,639
holistic approaches at oh wasp and these

174
00:06:06,639 --> 00:06:08,160
are owasp projects that i think are

175
00:06:08,160 --> 00:06:10,400
really worth your time to look at

176
00:06:10,400 --> 00:06:12,960
to understand and get a much broader

177
00:06:12,960 --> 00:06:13,759
look

178
00:06:13,759 --> 00:06:16,000
at the security landscape so

179
00:06:16,000 --> 00:06:18,880
first off the project is owasp asvs or

180
00:06:18,880 --> 00:06:20,479
the application

181
00:06:20,479 --> 00:06:23,199
security verification standard

182
00:06:23,199 --> 00:06:25,199
we know why we call it asvs because it's

183
00:06:25,199 --> 00:06:27,039
a lot less to say

184
00:06:27,039 --> 00:06:28,479
what does this do what does this provide

185
00:06:28,479 --> 00:06:30,160
what does this do for you well

186
00:06:30,160 --> 00:06:33,199
it gives you a level of rigor

187
00:06:33,199 --> 00:06:36,400
in the controls for your application in

188
00:06:36,400 --> 00:06:38,400
other words if i'm testing i want to

189
00:06:38,400 --> 00:06:39,600
validate

190
00:06:39,600 --> 00:06:42,080
that i have the highest level of rigor

191
00:06:42,080 --> 00:06:44,960
of controls i can use asvs to get that

192
00:06:44,960 --> 00:06:46,560
list of the highest level and there's

193
00:06:46,560 --> 00:06:47,520
actually

194
00:06:47,520 --> 00:06:49,039
there's three levels there's a level

195
00:06:49,039 --> 00:06:50,880
zero as well which is kind of nothing at

196
00:06:50,880 --> 00:06:53,120
all to one two and three so you can kind

197
00:06:53,120 --> 00:06:53,840
of

198
00:06:53,840 --> 00:06:56,880
adjust your needs based on that uh level

199
00:06:56,880 --> 00:06:58,800
of rigor the one two three

200
00:06:58,800 --> 00:07:00,240
and then

201
00:07:00,240 --> 00:07:02,479
also you can use the same document to

202
00:07:02,479 --> 00:07:04,639
provide a list of security requirements

203
00:07:04,639 --> 00:07:05,919
for a developer right if you're in a

204
00:07:05,919 --> 00:07:08,080
middling risk app maybe you're going to

205
00:07:08,080 --> 00:07:09,520
do a level 2

206
00:07:09,520 --> 00:07:10,800
asvs

207
00:07:10,800 --> 00:07:13,039
either entirely or in a particular

208
00:07:13,039 --> 00:07:14,800
category

209
00:07:14,800 --> 00:07:16,800
that that listing becomes your list of

210
00:07:16,800 --> 00:07:19,599
security requirements for the developer

211
00:07:19,599 --> 00:07:21,280
so why would you want to use this well

212
00:07:21,280 --> 00:07:23,520
it's a great metric and a yardstick to

213
00:07:23,520 --> 00:07:24,960
measure

214
00:07:24,960 --> 00:07:26,880
how rugged and how thorough your

215
00:07:26,880 --> 00:07:28,560
security controls are currently if

216
00:07:28,560 --> 00:07:30,560
nothing else right you can certainly say

217
00:07:30,560 --> 00:07:32,160
let me look at my app and do i have all

218
00:07:32,160 --> 00:07:33,440
these things

219
00:07:33,440 --> 00:07:35,199
you can also use it to test your app to

220
00:07:35,199 --> 00:07:37,440
a standard which is fantastic

221
00:07:37,440 --> 00:07:38,720
you can use it as a guideline to

222
00:07:38,720 --> 00:07:40,560
developers who say okay you say i'm a

223
00:07:40,560 --> 00:07:42,720
high risk app what does that mean what

224
00:07:42,720 --> 00:07:45,199
do i need to do well do all the level

225
00:07:45,199 --> 00:07:47,360
three things in asvs

226
00:07:47,360 --> 00:07:48,879
and we're golden right so you can

227
00:07:48,879 --> 00:07:50,319
actually have a

228
00:07:50,319 --> 00:07:52,160
method to talk to the development teams

229
00:07:52,160 --> 00:07:53,360
about what they need to do from a

230
00:07:53,360 --> 00:07:55,360
security control perspective

231
00:07:55,360 --> 00:07:57,280
as well as if you're contracting third

232
00:07:57,280 --> 00:07:58,879
party testers

233
00:07:58,879 --> 00:08:00,720
ask them hey

234
00:08:00,720 --> 00:08:02,960
i need you to go out and test this

235
00:08:02,960 --> 00:08:04,800
and make sure all the controls listed in

236
00:08:04,800 --> 00:08:06,479
say level two

237
00:08:06,479 --> 00:08:08,960
of the asvs are present and working

238
00:08:08,960 --> 00:08:10,479
correctly in my application right now

239
00:08:10,479 --> 00:08:13,120
you have a very good rugged test that

240
00:08:13,120 --> 00:08:14,319
documents

241
00:08:14,319 --> 00:08:15,919
all of the things it does and make sure

242
00:08:15,919 --> 00:08:18,560
it meets the standards you need to meet

243
00:08:18,560 --> 00:08:20,319
for whatever your security profile is

244
00:08:20,319 --> 00:08:22,960
for that particular app

245
00:08:22,960 --> 00:08:25,680
the next one is ola sam or the software

246
00:08:25,680 --> 00:08:28,479
assurance maturity model

247
00:08:28,479 --> 00:08:30,879
sam is there to really measure give you

248
00:08:30,879 --> 00:08:33,120
a way to measure and improve over time a

249
00:08:33,120 --> 00:08:34,399
security

250
00:08:34,399 --> 00:08:37,599
program right this is a comprehensive

251
00:08:37,599 --> 00:08:40,479
method to measure and then

252
00:08:40,479 --> 00:08:43,039
up your game on your security program

253
00:08:43,039 --> 00:08:44,640
over time and it's nice because it's

254
00:08:44,640 --> 00:08:46,320
flexible it's not

255
00:08:46,320 --> 00:08:48,880
terribly prescriptive it's more

256
00:08:48,880 --> 00:08:50,560
flexible and allows you to fit your

257
00:08:50,560 --> 00:08:52,240
business

258
00:08:52,240 --> 00:08:54,480
now why would i want to use that well if

259
00:08:54,480 --> 00:08:56,399
nothing else like i said it's vendor

260
00:08:56,399 --> 00:08:58,399
neutral and it's flexible so it's a

261
00:08:58,399 --> 00:09:01,360
great way to get a gauge on how mature

262
00:09:01,360 --> 00:09:03,360
your appsec or product security program

263
00:09:03,360 --> 00:09:05,839
is which is very useful but beyond that

264
00:09:05,839 --> 00:09:08,320
just initial measurement you can take it

265
00:09:08,320 --> 00:09:10,480
sort of to the next level and use it as

266
00:09:10,480 --> 00:09:12,160
a to create a roadmap of how you're

267
00:09:12,160 --> 00:09:13,600
going to ensure

268
00:09:13,600 --> 00:09:16,800
overall or specific areas that are of

269
00:09:16,800 --> 00:09:18,560
of interest to you were problematic for

270
00:09:18,560 --> 00:09:19,600
you

271
00:09:19,600 --> 00:09:21,200
so you can up your game right and not

272
00:09:21,200 --> 00:09:22,480
only does it give you

273
00:09:22,480 --> 00:09:23,839
the ability to create a customized

274
00:09:23,839 --> 00:09:26,000
roadmap but it also gives you

275
00:09:26,000 --> 00:09:28,640
demonstratable and measurable

276
00:09:28,640 --> 00:09:30,480
ways to show improvement over time so

277
00:09:30,480 --> 00:09:31,440
the people

278
00:09:31,440 --> 00:09:33,600
worth of you on the org chart can see

279
00:09:33,600 --> 00:09:34,560
hey

280
00:09:34,560 --> 00:09:36,560
not only are we here but we have plans

281
00:09:36,560 --> 00:09:38,560
in the next three quarters to get from

282
00:09:38,560 --> 00:09:40,240
this lower level to a higher level in

283
00:09:40,240 --> 00:09:42,480
this one or many categories right so

284
00:09:42,480 --> 00:09:45,839
it's a fantastic thing

285
00:09:46,080 --> 00:09:47,600
and then solving the problem these are

286
00:09:47,600 --> 00:09:49,519
probably my two favorite highly

287
00:09:49,519 --> 00:09:51,360
pragmatic

288
00:09:51,360 --> 00:09:53,440
os projects although i have lots of

289
00:09:53,440 --> 00:09:55,600
hawas projects i like but the oauth

290
00:09:55,600 --> 00:09:58,160
proactive controls and the oauth cheat

291
00:09:58,160 --> 00:09:59,680
sheet series

292
00:09:59,680 --> 00:10:00,959
and why i like these is they're

293
00:10:00,959 --> 00:10:02,720
developer focused

294
00:10:02,720 --> 00:10:04,720
on writing secure code you know let's

295
00:10:04,720 --> 00:10:06,800
try to nip this in the bud before we do

296
00:10:06,800 --> 00:10:10,000
testing right if we can get secure code

297
00:10:10,000 --> 00:10:12,320
out of the development side of the house

298
00:10:12,320 --> 00:10:14,160
we're done right that's a great place to

299
00:10:14,160 --> 00:10:15,839
be

300
00:10:15,839 --> 00:10:17,360
so why would you want to use this well

301
00:10:17,360 --> 00:10:19,360
for the proactive

302
00:10:19,360 --> 00:10:23,040
controls it lists the fundamental parts

303
00:10:23,040 --> 00:10:24,880
that are needed for any kind of secure

304
00:10:24,880 --> 00:10:27,440
application program so

305
00:10:27,440 --> 00:10:28,480
if you're writing any kind of

306
00:10:28,480 --> 00:10:30,000
application worth that salt these are

307
00:10:30,000 --> 00:10:31,760
fundamental things that that application

308
00:10:31,760 --> 00:10:32,399
should

309
00:10:32,399 --> 00:10:34,720
contain they may need to do more

310
00:10:34,720 --> 00:10:36,480
but this is the baseline so it's really

311
00:10:36,480 --> 00:10:38,720
fantastic for that

312
00:10:38,720 --> 00:10:41,200
and then cheat sheets provide very

313
00:10:41,200 --> 00:10:43,279
specific and targeted

314
00:10:43,279 --> 00:10:45,600
information about a

315
00:10:45,600 --> 00:10:48,640
wide range of security issues such as

316
00:10:48,640 --> 00:10:50,320
you have a developer you've had a pen

317
00:10:50,320 --> 00:10:51,839
test there's cross-site scripting in

318
00:10:51,839 --> 00:10:53,600
their application they say how do i fix

319
00:10:53,600 --> 00:10:54,880
this cross-site scripting of the

320
00:10:54,880 --> 00:10:56,399
cross-site scripting cheat sheet right

321
00:10:56,399 --> 00:10:58,160
go to that it'll explain

322
00:10:58,160 --> 00:11:00,320
why it's a problem and how to fix it in

323
00:11:00,320 --> 00:11:01,839
a very developer-focused sort of

324
00:11:01,839 --> 00:11:03,760
one-pager

325
00:11:03,760 --> 00:11:04,880
um

326
00:11:04,880 --> 00:11:07,120
one-pager cheat sheet and the thing

327
00:11:07,120 --> 00:11:08,880
that's fantastic about it is that i

328
00:11:08,880 --> 00:11:10,480
credit the the people who've run this

329
00:11:10,480 --> 00:11:12,079
project they have been really good about

330
00:11:12,079 --> 00:11:13,600
gathering the people that

331
00:11:13,600 --> 00:11:15,360
really really care about a small

332
00:11:15,360 --> 00:11:17,440
esoteric

333
00:11:17,440 --> 00:11:18,959
part

334
00:11:18,959 --> 00:11:20,079
of

335
00:11:20,079 --> 00:11:23,040
the uh security domain like the person

336
00:11:23,040 --> 00:11:25,920
who's really into jwts or jots right

337
00:11:25,920 --> 00:11:27,680
have that person

338
00:11:27,680 --> 00:11:29,360
write that guide so you get these people

339
00:11:29,360 --> 00:11:31,040
that are hyper-specialized in one

340
00:11:31,040 --> 00:11:32,959
particular area of security writing a

341
00:11:32,959 --> 00:11:34,560
highly developer-focused guide it's

342
00:11:34,560 --> 00:11:36,160
really fantastic

343
00:11:36,160 --> 00:11:37,200
can't say

344
00:11:37,200 --> 00:11:40,880
more about good things about that so

345
00:11:40,880 --> 00:11:43,040
let's switch gears really quick and i

346
00:11:43,040 --> 00:11:44,480
work for a company that does api

347
00:11:44,480 --> 00:11:46,640
security so i'm going to dig into the

348
00:11:46,640 --> 00:11:49,920
top 10 api security risks a bit

349
00:11:49,920 --> 00:11:51,760
um one thing to note with this is

350
00:11:51,760 --> 00:11:55,120
interesting it's security risk so

351
00:11:55,120 --> 00:11:57,360
the api top 10 avoided the whole

352
00:11:57,360 --> 00:11:58,800
vulnerability thing they started with

353
00:11:58,800 --> 00:12:00,800
risks which is a plus

354
00:12:00,800 --> 00:12:02,560
and then if you look at this first

355
00:12:02,560 --> 00:12:03,760
half of it

356
00:12:03,760 --> 00:12:06,079
broken object level authorization broken

357
00:12:06,079 --> 00:12:08,560
user level authentication

358
00:12:08,560 --> 00:12:11,360
and then um broken functional level

359
00:12:11,360 --> 00:12:12,800
authorization

360
00:12:12,800 --> 00:12:14,639
so off in and off z

361
00:12:14,639 --> 00:12:16,880
those issues are very common in apis

362
00:12:16,880 --> 00:12:18,480
that's a with the

363
00:12:18,480 --> 00:12:20,079
software to software or service to

364
00:12:20,079 --> 00:12:21,120
service or

365
00:12:21,120 --> 00:12:22,560
program to program whatever you want to

366
00:12:22,560 --> 00:12:25,200
call it api communication model

367
00:12:25,200 --> 00:12:27,600
that's a big weak point i mean three of

368
00:12:27,600 --> 00:12:29,040
the top ten that kind of tells you

369
00:12:29,040 --> 00:12:32,000
something excessive data exposure

370
00:12:32,000 --> 00:12:35,519
usually occurs when you have a mapping

371
00:12:35,519 --> 00:12:39,040
of developers from their data models out

372
00:12:39,040 --> 00:12:40,959
to what's sent to the client

373
00:12:40,959 --> 00:12:42,399
a lot of times that's automagical

374
00:12:42,399 --> 00:12:44,399
depending on the framework and when that

375
00:12:44,399 --> 00:12:47,040
automagic sends the entire data model

376
00:12:47,040 --> 00:12:48,800
a lot of developers will assume well the

377
00:12:48,800 --> 00:12:50,560
client will read off the three pieces of

378
00:12:50,560 --> 00:12:52,959
the 20 bits of data i sent them

379
00:12:52,959 --> 00:12:54,800
and only display that but if the client

380
00:12:54,800 --> 00:12:56,959
is an attacker you just made that guy's

381
00:12:56,959 --> 00:12:58,720
day or gal's day

382
00:12:58,720 --> 00:13:00,480
and then lack of resources and rate

383
00:13:00,480 --> 00:13:02,720
limiting is unique to apis typically

384
00:13:02,720 --> 00:13:04,320
over

385
00:13:04,320 --> 00:13:05,680
web applications although that could

386
00:13:05,680 --> 00:13:07,200
also be an issue with web applications

387
00:13:07,200 --> 00:13:09,519
and the idea here is to either stay away

388
00:13:09,519 --> 00:13:11,360
from being dosed

389
00:13:11,360 --> 00:13:13,279
or um

390
00:13:13,279 --> 00:13:15,120
make sure that that api is available to

391
00:13:15,120 --> 00:13:16,560
all of your clients right if one client

392
00:13:16,560 --> 00:13:18,880
can hog all of your resources

393
00:13:18,880 --> 00:13:20,560
that's certainly unfair and not exactly

394
00:13:20,560 --> 00:13:22,240
probably how you want your api to handle

395
00:13:22,240 --> 00:13:24,320
it

396
00:13:24,880 --> 00:13:26,560
i'm going to take three out of here

397
00:13:26,560 --> 00:13:28,959
right away security missed configuration

398
00:13:28,959 --> 00:13:30,880
injection and insufficient logging and

399
00:13:30,880 --> 00:13:33,760
monitoring those are in the web top ten

400
00:13:33,760 --> 00:13:35,279
they're kind of bog standard thing for

401
00:13:35,279 --> 00:13:36,639
any application

402
00:13:36,639 --> 00:13:38,720
they're not really worth digging into

403
00:13:38,720 --> 00:13:41,360
mass assignment is another issue

404
00:13:41,360 --> 00:13:43,760
of that automagical conversion of data

405
00:13:43,760 --> 00:13:44,880
coming in

406
00:13:44,880 --> 00:13:48,320
down to the data models of the software

407
00:13:48,320 --> 00:13:50,959
if you are only asking for a few pieces

408
00:13:50,959 --> 00:13:53,360
of data and i send additional extra data

409
00:13:53,360 --> 00:13:55,839
and you don't validate that extra data

410
00:13:55,839 --> 00:13:58,480
is a there and shouldn't be or b

411
00:13:58,480 --> 00:14:00,160
is there and i ignore it

412
00:14:00,160 --> 00:14:01,839
a lot of frameworks will automatically

413
00:14:01,839 --> 00:14:03,279
just submit all of that back down to

414
00:14:03,279 --> 00:14:05,360
your data model and it'll be persisted

415
00:14:05,360 --> 00:14:07,760
that's mass assignment

416
00:14:07,760 --> 00:14:09,519
um and proper assets management is a

417
00:14:09,519 --> 00:14:11,040
very interesting one

418
00:14:11,040 --> 00:14:13,680
and that that's really talking about

419
00:14:13,680 --> 00:14:16,560
being able to document and understand

420
00:14:16,560 --> 00:14:18,800
the whole suite of apis that are out

421
00:14:18,800 --> 00:14:20,000
there

422
00:14:20,000 --> 00:14:21,600
and understand which host says which

423
00:14:21,600 --> 00:14:24,240
apis which endpoints are available etc

424
00:14:24,240 --> 00:14:26,000
right so this is really the idea of an

425
00:14:26,000 --> 00:14:28,160
inventory i would say

426
00:14:28,160 --> 00:14:31,040
of apis and an interesting addition that

427
00:14:31,040 --> 00:14:33,600
really isn't in the wasp web top 10 but

428
00:14:33,600 --> 00:14:35,839
honestly should be i've done a lot of

429
00:14:35,839 --> 00:14:38,079
running of apsec programs and we never

430
00:14:38,079 --> 00:14:39,519
well except for one

431
00:14:39,519 --> 00:14:44,000
uh odd use case i never had a good list

432
00:14:44,000 --> 00:14:46,240
so how are we going to jump the api

433
00:14:46,240 --> 00:14:48,720
security shark right

434
00:14:48,720 --> 00:14:50,880
let's get into that

435
00:14:50,880 --> 00:14:52,000
so

436
00:14:52,000 --> 00:14:54,399
uh these are all

437
00:14:54,399 --> 00:14:56,399
i'm using the no name platform some kind

438
00:14:56,399 --> 00:14:58,079
of logos and stuff but honestly this is

439
00:14:58,079 --> 00:15:00,399
generic advice i happen to work at no

440
00:15:00,399 --> 00:15:01,760
name so guess what i happen to have

441
00:15:01,760 --> 00:15:03,839
those graphics handy so that's what i'm

442
00:15:03,839 --> 00:15:05,199
going to show you but honestly this is

443
00:15:05,199 --> 00:15:06,880
more general advice

444
00:15:06,880 --> 00:15:09,760
i would break it into three major areas

445
00:15:09,760 --> 00:15:12,720
one what i call api security posture

446
00:15:12,720 --> 00:15:15,040
which is getting an inventory

447
00:15:15,040 --> 00:15:16,880
and understanding the data that goes

448
00:15:16,880 --> 00:15:19,360
through all of your apis all being kind

449
00:15:19,360 --> 00:15:20,880
of a critical thing

450
00:15:20,880 --> 00:15:22,560
generally speaking this is done by

451
00:15:22,560 --> 00:15:25,040
watching the traffic that goes between

452
00:15:25,040 --> 00:15:27,519
the clients and the apis

453
00:15:27,519 --> 00:15:29,279
and in watching that traffic you get the

454
00:15:29,279 --> 00:15:31,759
ability to find misconfigurations

455
00:15:31,759 --> 00:15:34,880
and what i would call passive scanning

456
00:15:34,880 --> 00:15:36,079
and those configurations or

457
00:15:36,079 --> 00:15:37,680
misconfigurations or vulnerabilities

458
00:15:37,680 --> 00:15:40,399
could exist in the source code in how

459
00:15:40,399 --> 00:15:42,800
the network is configured like a public

460
00:15:42,800 --> 00:15:44,560
an api that should be private is exposed

461
00:15:44,560 --> 00:15:45,600
publicly

462
00:15:45,600 --> 00:15:47,680
or in policy

463
00:15:47,680 --> 00:15:49,600
the second sort of pillar is detection

464
00:15:49,600 --> 00:15:52,160
and response so i've got a list of apis

465
00:15:52,160 --> 00:15:54,240
i understand what data they have now i

466
00:15:54,240 --> 00:15:55,759
can start looking at how they're being

467
00:15:55,759 --> 00:15:59,120
used and understand we'll model honestly

468
00:15:59,120 --> 00:16:01,199
what normal is so i can understand what

469
00:16:01,199 --> 00:16:04,240
abnormal is right kind of

470
00:16:04,240 --> 00:16:07,519
obvious sort of thing you need to do

471
00:16:07,519 --> 00:16:08,720
and then once you have that

472
00:16:08,720 --> 00:16:10,880
understanding of normal and and once you

473
00:16:10,880 --> 00:16:13,360
understand where there is aberrant api

474
00:16:13,360 --> 00:16:15,519
interactions you can respond to that

475
00:16:15,519 --> 00:16:16,639
right you can do some sort of

476
00:16:16,639 --> 00:16:18,160
remediation

477
00:16:18,160 --> 00:16:20,320
to fix that issue

478
00:16:20,320 --> 00:16:22,560
and then testing obviously the the final

479
00:16:22,560 --> 00:16:23,920
pillar

480
00:16:23,920 --> 00:16:25,440
um and if you're doing this right you're

481
00:16:25,440 --> 00:16:28,079
doing this as far left as possible

482
00:16:28,079 --> 00:16:29,360
where you can

483
00:16:29,360 --> 00:16:31,759
ideally hook this into your ci cd and

484
00:16:31,759 --> 00:16:33,360
have that testing happen early in a

485
00:16:33,360 --> 00:16:35,360
pre-production

486
00:16:35,360 --> 00:16:37,279
instance of your api before that api

487
00:16:37,279 --> 00:16:40,079
rolls into prod

488
00:16:40,399 --> 00:16:42,720
so i've mentioned api inventory honestly

489
00:16:42,720 --> 00:16:44,880
i i would have almost given my firstborn

490
00:16:44,880 --> 00:16:47,040
child for api or just general

491
00:16:47,040 --> 00:16:49,519
inventories and because not only is it

492
00:16:49,519 --> 00:16:52,160
nice and necessary to have that list

493
00:16:52,160 --> 00:16:54,079
of all of the apis

494
00:16:54,079 --> 00:16:54,959
but

495
00:16:54,959 --> 00:16:56,800
any product security team i've ever been

496
00:16:56,800 --> 00:16:58,160
on has been resource constrained

497
00:16:58,160 --> 00:17:00,639
resource constrained by people right so

498
00:17:00,639 --> 00:17:02,240
if i'm gonna have to focus my people

499
00:17:02,240 --> 00:17:04,799
where they can make the best

500
00:17:04,799 --> 00:17:06,480
use of their time and get the most bang

501
00:17:06,480 --> 00:17:08,079
for their buck i want to have a full

502
00:17:08,079 --> 00:17:08,959
view

503
00:17:08,959 --> 00:17:11,199
so i can then find out these are the

504
00:17:11,199 --> 00:17:13,439
you know so many most critical apis this

505
00:17:13,439 --> 00:17:15,199
is where i'm going to focus my time

506
00:17:15,199 --> 00:17:16,880
these other ones they're important but i

507
00:17:16,880 --> 00:17:18,079
don't have time to give them the love

508
00:17:18,079 --> 00:17:19,679
they need you can't really do that

509
00:17:19,679 --> 00:17:22,559
without an api

510
00:17:22,559 --> 00:17:24,400
and then understanding the data right

511
00:17:24,400 --> 00:17:26,000
that's coming through your api is also

512
00:17:26,000 --> 00:17:28,240
very important now ideally this would be

513
00:17:28,240 --> 00:17:29,840
auto found right you would have a

514
00:17:29,840 --> 00:17:31,520
classifier that would watch that traffic

515
00:17:31,520 --> 00:17:33,760
and say oh there's a first name there's

516
00:17:33,760 --> 00:17:36,720
a serial number or there's a ssn rather

517
00:17:36,720 --> 00:17:39,039
here's a phone number whatever kind of

518
00:17:39,039 --> 00:17:41,039
data classification you want so you can

519
00:17:41,039 --> 00:17:42,960
then make risk-based decisions based on

520
00:17:42,960 --> 00:17:45,039
that the sensitivity of the data flowing

521
00:17:45,039 --> 00:17:48,240
in and out of those apis

522
00:17:48,320 --> 00:17:50,960
and then detect and respond so

523
00:17:50,960 --> 00:17:53,280
you've got the api inventory

524
00:17:53,280 --> 00:17:54,559
you've got an idea of what's going

525
00:17:54,559 --> 00:17:56,960
through those apis in terms of data

526
00:17:56,960 --> 00:17:58,640
and i know their usage patterns because

527
00:17:58,640 --> 00:18:00,960
i've done some modeling the easiest way

528
00:18:00,960 --> 00:18:02,240
to do it obviously is to do some kind of

529
00:18:02,240 --> 00:18:05,200
computer modeling of normal

530
00:18:05,200 --> 00:18:06,960
and then once i have that aberration

531
00:18:06,960 --> 00:18:09,840
that abnormal event what do i do well

532
00:18:09,840 --> 00:18:11,840
there's sort of three major things you

533
00:18:11,840 --> 00:18:15,600
can do here you can do a manual response

534
00:18:15,600 --> 00:18:17,120
which is basically

535
00:18:17,120 --> 00:18:19,120
in whatever your console is show a

536
00:18:19,120 --> 00:18:21,280
vulnerability and alert whoever happens

537
00:18:21,280 --> 00:18:23,520
to be logged in okay that's that's not

538
00:18:23,520 --> 00:18:26,200
bad it's not particularly fast

539
00:18:26,200 --> 00:18:27,760
semi-automated

540
00:18:27,760 --> 00:18:29,520
is would be something like you see an

541
00:18:29,520 --> 00:18:32,559
anomaly and i drop a ticket in a system

542
00:18:32,559 --> 00:18:34,480
that's used by humans to go fix it right

543
00:18:34,480 --> 00:18:36,559
this could be jira this could be service

544
00:18:36,559 --> 00:18:39,360
now this could be a sim whatever it is

545
00:18:39,360 --> 00:18:41,039
right i drop a ticket and now a human

546
00:18:41,039 --> 00:18:42,960
has a queued up item to go

547
00:18:42,960 --> 00:18:45,600
triage and understand what's going on

548
00:18:45,600 --> 00:18:47,200
or on the far end of the spectrum this

549
00:18:47,200 --> 00:18:49,039
could be fully automated right

550
00:18:49,039 --> 00:18:50,240
i could see

551
00:18:50,240 --> 00:18:51,919
something outside of the thresholds or

552
00:18:51,919 --> 00:18:53,840
the policy or what have you

553
00:18:53,840 --> 00:18:57,520
and take a concrete action i could block

554
00:18:57,520 --> 00:19:00,640
that ip i could d off that user

555
00:19:00,640 --> 00:19:02,480
this would usually be with integrations

556
00:19:02,480 --> 00:19:06,080
on existing hardware like an api gateway

557
00:19:06,080 --> 00:19:07,520
but the idea is you have sort of three

558
00:19:07,520 --> 00:19:11,160
choices when you respond

559
00:19:11,360 --> 00:19:14,559
and then passive and active scanning

560
00:19:14,559 --> 00:19:15,760
so i already talked about passive

561
00:19:15,760 --> 00:19:16,960
scanning that's watching the network

562
00:19:16,960 --> 00:19:18,960
traffic and seeing what's going on and

563
00:19:18,960 --> 00:19:21,440
based on what you see you can make some

564
00:19:21,440 --> 00:19:22,880
very safe assumptions about

565
00:19:22,880 --> 00:19:25,360
vulnerabilities that may exist

566
00:19:25,360 --> 00:19:26,880
but the flip side of that is active

567
00:19:26,880 --> 00:19:28,799
testing and

568
00:19:28,799 --> 00:19:31,039
the it would like the ideal case is

569
00:19:31,039 --> 00:19:34,080
having the ability to take apis

570
00:19:34,080 --> 00:19:36,640
um connect them by product right or by

571
00:19:36,640 --> 00:19:37,919
product or whatever makes sense for your

572
00:19:37,919 --> 00:19:39,760
business like this is the api that does

573
00:19:39,760 --> 00:19:42,880
this unique function for our business

574
00:19:42,880 --> 00:19:45,360
and then test it in a pre-prod instance

575
00:19:45,360 --> 00:19:48,000
ideally with ci cd like i said earlier

576
00:19:48,000 --> 00:19:49,679
so that you can get an idea before that

577
00:19:49,679 --> 00:19:52,400
thing is exposed to the world or whoever

578
00:19:52,400 --> 00:19:54,480
is your client

579
00:19:54,480 --> 00:19:56,720
that it's going out and it's rugged and

580
00:19:56,720 --> 00:19:59,039
it's correct um you get reporting on the

581
00:19:59,039 --> 00:20:00,559
whole line you should anyway with any

582
00:20:00,559 --> 00:20:02,480
reasonably good tool i mean one

583
00:20:02,480 --> 00:20:04,720
interesting thing about apis

584
00:20:04,720 --> 00:20:07,760
is there's a differentiation between

585
00:20:07,760 --> 00:20:09,679
well like what a web app considers a

586
00:20:09,679 --> 00:20:11,919
thing and what an api considers a thing

587
00:20:11,919 --> 00:20:13,280
or i think it needs this distinction

588
00:20:13,280 --> 00:20:14,400
needs to happen

589
00:20:14,400 --> 00:20:17,360
so if you take a host plus a path

590
00:20:17,360 --> 00:20:19,760
plus a method for an api

591
00:20:19,760 --> 00:20:22,320
that's really what the api is because

592
00:20:22,320 --> 00:20:26,559
example.com slash api slash users

593
00:20:26,559 --> 00:20:28,400
get is very different

594
00:20:28,400 --> 00:20:29,200
than

595
00:20:29,200 --> 00:20:31,120
the example.com

596
00:20:31,120 --> 00:20:33,919
api slash users post right i'm either

597
00:20:33,919 --> 00:20:35,600
pulling out user information or i'm

598
00:20:35,600 --> 00:20:37,600
adding users to a system and the

599
00:20:37,600 --> 00:20:39,039
security around those two things are

600
00:20:39,039 --> 00:20:41,520
very different

601
00:20:41,520 --> 00:20:43,120
and finally

602
00:20:43,120 --> 00:20:45,039
when you start the security journey

603
00:20:45,039 --> 00:20:46,400
obviously when you initiate you'll start

604
00:20:46,400 --> 00:20:48,400
with an inventory you start to get a

605
00:20:48,400 --> 00:20:51,440
handle on the policies around the data

606
00:20:51,440 --> 00:20:53,120
that you have and understand what should

607
00:20:53,120 --> 00:20:54,960
and shouldn't be there when you begin to

608
00:20:54,960 --> 00:20:57,600
operationalize you'll do run books and

609
00:20:57,600 --> 00:20:58,880
stuff so that if i

610
00:20:58,880 --> 00:21:00,400
if i do see sensitive data in a

611
00:21:00,400 --> 00:21:02,240
particular api i'm going to fire off

612
00:21:02,240 --> 00:21:04,000
this ticket to this group right you can

613
00:21:04,000 --> 00:21:05,440
organize all that

614
00:21:05,440 --> 00:21:07,039
and you'll scale

615
00:21:07,039 --> 00:21:08,720
a lot of times these are done as maybe

616
00:21:08,720 --> 00:21:10,880
one of your data centers or one of your

617
00:21:10,880 --> 00:21:12,480
cloud providers well

618
00:21:12,480 --> 00:21:14,240
let's go ahead and do it across the rest

619
00:21:14,240 --> 00:21:15,760
of our cloud providers

620
00:21:15,760 --> 00:21:18,240
and then optimize with continual testing

621
00:21:18,240 --> 00:21:20,799
and one interesting thing about apis is

622
00:21:20,799 --> 00:21:22,240
there's a whole bunch of stakeholders

623
00:21:22,240 --> 00:21:24,080
that plays here right you may have to

624
00:21:24,080 --> 00:21:25,200
deal with

625
00:21:25,200 --> 00:21:28,080
the the product or the api owners

626
00:21:28,080 --> 00:21:30,080
the developers who wrote that api the

627
00:21:30,080 --> 00:21:32,080
network and infrastructure people who

628
00:21:32,080 --> 00:21:33,440
make it available to whoever is

629
00:21:33,440 --> 00:21:34,640
consuming it

630
00:21:34,640 --> 00:21:36,080
if you have an api gateway you probably

631
00:21:36,080 --> 00:21:38,080
have an api gateway administrator

632
00:21:38,080 --> 00:21:40,159
obviously appsec is going to be involved

633
00:21:40,159 --> 00:21:41,919
in security operations for things like

634
00:21:41,919 --> 00:21:44,919
incidents

635
00:21:45,120 --> 00:21:48,240
so thank you man that was rocket fast

636
00:21:48,240 --> 00:21:50,240
um if you have any questions come see us

637
00:21:50,240 --> 00:21:52,559
at the booth no namesecurity.com is our

638
00:21:52,559 --> 00:21:54,640
website and we're giving away a free

639
00:21:54,640 --> 00:21:56,799
t-shirt if you uh sat through me

640
00:21:56,799 --> 00:21:59,360
blathering for 20 some odd minutes

641
00:21:59,360 --> 00:22:02,080
at no name.com t-shirt

642
00:22:02,080 --> 00:22:04,320
so grab a t-shirt if you like and

643
00:22:04,320 --> 00:22:06,159
i will happily answer any questions that

644
00:22:06,159 --> 00:22:09,480
have come in

