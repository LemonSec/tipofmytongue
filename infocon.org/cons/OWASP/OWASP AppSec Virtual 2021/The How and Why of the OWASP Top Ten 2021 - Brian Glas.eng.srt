1
00:00:01,420 --> 00:00:05,630
[Music]

2
00:00:07,279 --> 00:00:09,679
hello everybody uh good morning

3
00:00:09,679 --> 00:00:11,840
afternoon evening depending on your time

4
00:00:11,840 --> 00:00:15,839
zone um so today what i want to talk to

5
00:00:15,839 --> 00:00:17,359
you about is

6
00:00:17,359 --> 00:00:18,800
not

7
00:00:18,800 --> 00:00:21,119
about the top 10 you're going to have

8
00:00:21,119 --> 00:00:22,880
several hundred people over the next

9
00:00:22,880 --> 00:00:25,359
three years give you their take on what

10
00:00:25,359 --> 00:00:27,119
each of the categories means and what

11
00:00:27,119 --> 00:00:29,039
you can do about it and all of that and

12
00:00:29,039 --> 00:00:30,560
that's awesome

13
00:00:30,560 --> 00:00:33,280
my job today is to explain to you

14
00:00:33,280 --> 00:00:36,320
how we got to this top ten like how did

15
00:00:36,320 --> 00:00:39,760
we get to this specific list

16
00:00:39,760 --> 00:00:41,440
so that's what i want to cover if you've

17
00:00:41,440 --> 00:00:43,840
got questions at some point please throw

18
00:00:43,840 --> 00:00:45,760
them in i'm more than happy to answer

19
00:00:45,760 --> 00:00:46,800
them

20
00:00:46,800 --> 00:00:49,440
as one of the oauth flagship projects

21
00:00:49,440 --> 00:00:50,800
one of the things that we work really

22
00:00:50,800 --> 00:00:52,399
hard to do is we try to be really

23
00:00:52,399 --> 00:00:54,800
transparent about how we build this

24
00:00:54,800 --> 00:00:56,079
project

25
00:00:56,079 --> 00:00:59,280
so if you notice i am one of four

26
00:00:59,280 --> 00:01:01,760
co-leads on this team so it's myself

27
00:01:01,760 --> 00:01:04,319
andrew van der stock torsten giggler and

28
00:01:04,319 --> 00:01:06,240
neil smithline

29
00:01:06,240 --> 00:01:08,560
and the four of us helped put together

30
00:01:08,560 --> 00:01:11,040
the top 10 2017 and we came back

31
00:01:11,040 --> 00:01:13,439
together for the 2021

32
00:01:13,439 --> 00:01:16,080
and and it's really good i think we have

33
00:01:16,080 --> 00:01:18,720
a pretty diverse set of backgrounds

34
00:01:18,720 --> 00:01:21,119
so that leads to lots of good spirited

35
00:01:21,119 --> 00:01:23,280
discussions about what we should or

36
00:01:23,280 --> 00:01:25,439
should not do in different spaces

37
00:01:25,439 --> 00:01:27,200
and then the other thing you can see on

38
00:01:27,200 --> 00:01:29,439
the title slide is we have three

39
00:01:29,439 --> 00:01:32,720
different links the top 10 itself

40
00:01:32,720 --> 00:01:35,119
was released to coincide with the 20th

41
00:01:35,119 --> 00:01:36,400
anniversary

42
00:01:36,400 --> 00:01:38,880
and you can see that at top owass.org

43
00:01:38,880 --> 00:01:40,400
top 10

44
00:01:40,400 --> 00:01:43,680
our github project so every time we make

45
00:01:43,680 --> 00:01:46,720
changes or we do a release for review

46
00:01:46,720 --> 00:01:49,360
any issues that people create responses

47
00:01:49,360 --> 00:01:51,200
to them and everything all of that is

48
00:01:51,200 --> 00:01:53,840
publicly available in github and then we

49
00:01:53,840 --> 00:01:57,200
also have a separate project site so

50
00:01:57,200 --> 00:01:58,960
it's a site that gives you more

51
00:01:58,960 --> 00:02:00,799
information about how the top 10 is

52
00:02:00,799 --> 00:02:03,200
built and then blog entries when we're

53
00:02:03,200 --> 00:02:05,439
working on it we will give periodic

54
00:02:05,439 --> 00:02:07,759
updates in terms of where we are what

55
00:02:07,759 --> 00:02:09,520
we're working on what we're looking at

56
00:02:09,520 --> 00:02:13,239
and that's at owasptop10.org

57
00:02:13,760 --> 00:02:16,000
so as we get started

58
00:02:16,000 --> 00:02:18,000
one of the first things i want to cover

59
00:02:18,000 --> 00:02:20,640
is we actually have icons

60
00:02:20,640 --> 00:02:22,800
for the first time in the top 10 we

61
00:02:22,800 --> 00:02:25,520
actually have our own icons we're not

62
00:02:25,520 --> 00:02:28,000
waiting on other people to determine

63
00:02:28,000 --> 00:02:30,080
what kind of icons they want to create

64
00:02:30,080 --> 00:02:31,840
for these categories but we actually

65
00:02:31,840 --> 00:02:33,200
have our own

66
00:02:33,200 --> 00:02:36,560
and many thanks to hugo costa so he

67
00:02:36,560 --> 00:02:38,080
helped us

68
00:02:38,080 --> 00:02:39,760
put up with us

69
00:02:39,760 --> 00:02:42,480
because it's actually quite difficult

70
00:02:42,480 --> 00:02:45,680
to figure out one image to represent an

71
00:02:45,680 --> 00:02:48,080
entire category of vulnerabilities

72
00:02:48,080 --> 00:02:50,400
and so some of these images like lend

73
00:02:50,400 --> 00:02:52,239
themselves fairly easily like broken

74
00:02:52,239 --> 00:02:55,040
access control it's not terribly hard to

75
00:02:55,040 --> 00:02:58,080
visualize a fence with broken panels uh

76
00:02:58,080 --> 00:03:00,239
crypto failures injection is actually

77
00:03:00,239 --> 00:03:01,840
quite easy

78
00:03:01,840 --> 00:03:03,200
but then you get into things like

79
00:03:03,200 --> 00:03:04,480
insecure design

80
00:03:04,480 --> 00:03:07,599
or server-side request forgery

81
00:03:07,599 --> 00:03:08,959
things like that all of a sudden it

82
00:03:08,959 --> 00:03:10,800
becomes really difficult to try and

83
00:03:10,800 --> 00:03:14,400
figure out what one picture can convey

84
00:03:14,400 --> 00:03:17,440
the concept of this category

85
00:03:17,440 --> 00:03:20,560
and so we had a lot and i mean a lot of

86
00:03:20,560 --> 00:03:22,720
discussion over a number of months about

87
00:03:22,720 --> 00:03:25,360
what exactly to use for each of these

88
00:03:25,360 --> 00:03:27,840
but i like them up here because i'm

89
00:03:27,840 --> 00:03:30,000
excited that we actually have them

90
00:03:30,000 --> 00:03:34,239
so that absolutely helps with messaging

91
00:03:34,319 --> 00:03:37,360
so the question is on the top 10 how did

92
00:03:37,360 --> 00:03:40,080
we get to the release like did we just

93
00:03:40,080 --> 00:03:42,480
make it up because we felt like it or

94
00:03:42,480 --> 00:03:44,400
did we actually have a process that we

95
00:03:44,400 --> 00:03:47,120
followed so the process that we followed

96
00:03:47,120 --> 00:03:49,200
is well somewhat depicted on this

97
00:03:49,200 --> 00:03:50,959
picture it's meandering

98
00:03:50,959 --> 00:03:53,200
it took us a little while

99
00:03:53,200 --> 00:03:55,760
we started we were hoping to have a 2020

100
00:03:55,760 --> 00:03:58,239
release and then we had a fun little

101
00:03:58,239 --> 00:04:00,000
pandemic

102
00:04:00,000 --> 00:04:02,000
it's not fun or little

103
00:04:02,000 --> 00:04:02,879
but

104
00:04:02,879 --> 00:04:05,680
we had a pandemic and so

105
00:04:05,680 --> 00:04:08,400
we started trying to make a data call

106
00:04:08,400 --> 00:04:10,879
and didn't really get much response

107
00:04:10,879 --> 00:04:12,560
because people had a lot more important

108
00:04:12,560 --> 00:04:15,599
things to deal with so we decided that

109
00:04:15,599 --> 00:04:18,720
we needed to delay the top 10

110
00:04:18,720 --> 00:04:21,040
until 2021 because we wanted to give

111
00:04:21,040 --> 00:04:23,120
people the opportunity to be able to

112
00:04:23,120 --> 00:04:24,560
take care of things that are really

113
00:04:24,560 --> 00:04:25,759
important

114
00:04:25,759 --> 00:04:28,720
and then we would get back to this

115
00:04:28,720 --> 00:04:30,240
so we did

116
00:04:30,240 --> 00:04:32,160
and then we spent

117
00:04:32,160 --> 00:04:35,120
the data call closed near the end of

118
00:04:35,120 --> 00:04:37,199
last year and then we spent several

119
00:04:37,199 --> 00:04:39,040
months culling through the data and then

120
00:04:39,040 --> 00:04:40,960
trying to figure out like what best

121
00:04:40,960 --> 00:04:44,000
represents this next top 10 list

122
00:04:44,000 --> 00:04:46,240
so as we were going through to build the

123
00:04:46,240 --> 00:04:47,840
top 10

124
00:04:47,840 --> 00:04:49,680
we had some core principles that we were

125
00:04:49,680 --> 00:04:50,800
based on

126
00:04:50,800 --> 00:04:52,880
so we were we had to remember that the

127
00:04:52,880 --> 00:04:55,360
os top 10 is a baseline it's not a

128
00:04:55,360 --> 00:04:57,360
ceiling it is something that you start

129
00:04:57,360 --> 00:04:59,680
with not something to completely aspire

130
00:04:59,680 --> 00:05:00,720
to

131
00:05:00,720 --> 00:05:04,080
it is not a full program

132
00:05:04,080 --> 00:05:06,000
if you manage to accomplish the entire

133
00:05:06,000 --> 00:05:09,759
top 10 it is not the end of the road

134
00:05:09,759 --> 00:05:12,160
you've made a milestone you're part way

135
00:05:12,160 --> 00:05:14,880
through your security program

136
00:05:14,880 --> 00:05:17,440
the top 10 was originally built as an

137
00:05:17,440 --> 00:05:20,240
awareness document and it still is for

138
00:05:20,240 --> 00:05:22,320
the most part but it is also a pseudo

139
00:05:22,320 --> 00:05:23,759
standard

140
00:05:23,759 --> 00:05:26,080
which makes it in a really strange

141
00:05:26,080 --> 00:05:29,039
position in terms of how we build it

142
00:05:29,039 --> 00:05:30,800
because we also have to understand that

143
00:05:30,800 --> 00:05:33,520
when we build a new top 10

144
00:05:33,520 --> 00:05:36,560
what we're putting in motion is tens or

145
00:05:36,560 --> 00:05:39,199
hundreds of thousands of hours of work

146
00:05:39,199 --> 00:05:41,680
to update tooling to update training to

147
00:05:41,680 --> 00:05:44,240
update documentation to update policies

148
00:05:44,240 --> 00:05:46,560
to update all sorts of things that we

149
00:05:46,560 --> 00:05:48,560
had never really originally envisioned

150
00:05:48,560 --> 00:05:50,639
with the top 10 that would all be

151
00:05:50,639 --> 00:05:53,440
impacted with it so we don't take this

152
00:05:53,440 --> 00:05:56,319
slightly anytime we go to make a change

153
00:05:56,319 --> 00:05:59,039
it is not there's nothing that's just

154
00:05:59,039 --> 00:06:02,960
haphazard about trying to work on this

155
00:06:02,960 --> 00:06:04,639
the other and the next core principle we

156
00:06:04,639 --> 00:06:06,960
looked at is data is good but data isn't

157
00:06:06,960 --> 00:06:10,080
everything so we wanted to base as much

158
00:06:10,080 --> 00:06:12,720
as we could off of data from a data call

159
00:06:12,720 --> 00:06:14,560
and a data collection

160
00:06:14,560 --> 00:06:16,880
but at the same time we didn't want to

161
00:06:16,880 --> 00:06:19,759
blindly just work on the data we needed

162
00:06:19,759 --> 00:06:21,520
to take it with a grain of salt and try

163
00:06:21,520 --> 00:06:24,160
and understand what was the limitations

164
00:06:24,160 --> 00:06:26,000
of that data and then what could it tell

165
00:06:26,000 --> 00:06:27,120
us

166
00:06:27,120 --> 00:06:28,960
and one of those things is data looks

167
00:06:28,960 --> 00:06:30,479
into the past

168
00:06:30,479 --> 00:06:32,639
so when we make a data call and we get

169
00:06:32,639 --> 00:06:35,199
sent data we have data from

170
00:06:35,199 --> 00:06:37,600
multiple different sources and it's data

171
00:06:37,600 --> 00:06:39,680
from 2017

172
00:06:39,680 --> 00:06:43,600
to we have some that stretched into 2021

173
00:06:43,600 --> 00:06:46,400
but it's not just that

174
00:06:46,400 --> 00:06:48,639
the data is for findings of that

175
00:06:48,639 --> 00:06:50,880
particular year it's that there's a

176
00:06:50,880 --> 00:06:53,360
delay before data even shows up in the

177
00:06:53,360 --> 00:06:54,639
first place

178
00:06:54,639 --> 00:06:56,319
so when a

179
00:06:56,319 --> 00:06:59,680
when human apsec professionals um in the

180
00:06:59,680 --> 00:07:02,960
community we we find a new vulnerability

181
00:07:02,960 --> 00:07:05,440
we find a new way of testing something

182
00:07:05,440 --> 00:07:07,759
it takes time for that to become

183
00:07:07,759 --> 00:07:10,240
mainstream to the point where it starts

184
00:07:10,240 --> 00:07:12,400
showing up in data in any kind of

185
00:07:12,400 --> 00:07:14,080
significant manner

186
00:07:14,080 --> 00:07:16,319
so you find stuff you manage to get some

187
00:07:16,319 --> 00:07:18,319
initial testing you manage to get some

188
00:07:18,319 --> 00:07:20,319
initial automation and then you have to

189
00:07:20,319 --> 00:07:22,319
get that automation adopted and

190
00:07:22,319 --> 00:07:24,319
widespread across multiple different

191
00:07:24,319 --> 00:07:25,759
types of tools and different

192
00:07:25,759 --> 00:07:28,319
organizations and different groups

193
00:07:28,319 --> 00:07:32,080
and so it may take years between when

194
00:07:32,080 --> 00:07:34,479
you initially figure out one type of

195
00:07:34,479 --> 00:07:36,400
vulnerability and then how to look for

196
00:07:36,400 --> 00:07:37,039
it

197
00:07:37,039 --> 00:07:39,199
and then the time it takes to refine the

198
00:07:39,199 --> 00:07:42,160
test and then make it go to scale to

199
00:07:42,160 --> 00:07:44,479
where we can actually have significant

200
00:07:44,479 --> 00:07:46,479
amounts of data that tell us how big of

201
00:07:46,479 --> 00:07:48,319
a problem this really is

202
00:07:48,319 --> 00:07:50,000
so this is part of the reason why we do

203
00:07:50,000 --> 00:07:52,639
a community survey for the top 10.

204
00:07:52,639 --> 00:07:55,199
so we started this in 2017 and we

205
00:07:55,199 --> 00:07:58,080
continued it in 2021

206
00:07:58,080 --> 00:08:02,080
that of the top 10 typically two of them

207
00:08:02,080 --> 00:08:05,199
of the top 10 are picked from the survey

208
00:08:05,199 --> 00:08:07,759
so the idea with the survey is we go and

209
00:08:07,759 --> 00:08:09,440
ask people

210
00:08:09,440 --> 00:08:10,319
what

211
00:08:10,319 --> 00:08:13,360
do you believe is worthy of being in the

212
00:08:13,360 --> 00:08:16,319
top 10 that is not likely to show up in

213
00:08:16,319 --> 00:08:18,800
data either because it's difficult to

214
00:08:18,800 --> 00:08:20,000
test for

215
00:08:20,000 --> 00:08:23,440
or it is too new to show up in tests

216
00:08:23,440 --> 00:08:25,280
and so that's why we do the survey

217
00:08:25,280 --> 00:08:27,759
because that's the only way to get the

218
00:08:27,759 --> 00:08:31,199
more recent the now the upcoming to some

219
00:08:31,199 --> 00:08:33,039
extent

220
00:08:33,039 --> 00:08:34,880
and so it's not purely just looking in

221
00:08:34,880 --> 00:08:36,640
the past

222
00:08:36,640 --> 00:08:38,640
the other principle we have is stability

223
00:08:38,640 --> 00:08:41,200
is good so when you

224
00:08:41,200 --> 00:08:43,360
deal with a standard or a pseudo

225
00:08:43,360 --> 00:08:45,519
standard you don't need that bar to

226
00:08:45,519 --> 00:08:47,920
change every three or six months we've

227
00:08:47,920 --> 00:08:50,000
been asked before why doesn't the top 10

228
00:08:50,000 --> 00:08:52,640
adopt like a devops model and every

229
00:08:52,640 --> 00:08:55,440
month the top 10 could update

230
00:08:55,440 --> 00:08:58,480
and i don't think that person realized

231
00:08:58,480 --> 00:08:59,360
how

232
00:08:59,360 --> 00:09:01,760
dramatically bad that would be for the

233
00:09:01,760 --> 00:09:04,800
top 10. if the top 10 was a constantly

234
00:09:04,800 --> 00:09:08,959
moving target it would no longer be used

235
00:09:08,959 --> 00:09:11,360
because it would be ridiculously

236
00:09:11,360 --> 00:09:13,360
frustrating to try and develop training

237
00:09:13,360 --> 00:09:15,600
for the top 10 only to have it change on

238
00:09:15,600 --> 00:09:17,600
a monthly basis

239
00:09:17,600 --> 00:09:21,040
and so for some things it makes a lot of

240
00:09:21,040 --> 00:09:24,160
sense to make them continuous

241
00:09:24,160 --> 00:09:26,240
continuous change continuous build

242
00:09:26,240 --> 00:09:28,959
continuous delivery and that's great but

243
00:09:28,959 --> 00:09:31,440
for something like the top ten

244
00:09:31,440 --> 00:09:34,399
even every three or four years

245
00:09:34,399 --> 00:09:37,279
that makes sense you need that stability

246
00:09:37,279 --> 00:09:40,160
to build things on top of

247
00:09:40,160 --> 00:09:42,320
so that's why we do it we do it um

248
00:09:42,320 --> 00:09:44,080
usually the aim is for three years and

249
00:09:44,080 --> 00:09:46,080
we have a fall back to four if something

250
00:09:46,080 --> 00:09:48,320
comes up but that's generally the

251
00:09:48,320 --> 00:09:50,640
cadence for the top 10.

252
00:09:50,640 --> 00:09:52,080
the next principle is raising the

253
00:09:52,080 --> 00:09:54,480
minimum bar so when we look at trying to

254
00:09:54,480 --> 00:09:57,120
build the top 10 on each iteration we're

255
00:09:57,120 --> 00:09:58,880
trying to figure out

256
00:09:58,880 --> 00:10:01,040
when we look at this data when we look

257
00:10:01,040 --> 00:10:03,200
at what's going on how do we raise the

258
00:10:03,200 --> 00:10:05,920
bar how do we drive the industry to

259
00:10:05,920 --> 00:10:07,519
improve

260
00:10:07,519 --> 00:10:09,440
and that feeds into the next one is we

261
00:10:09,440 --> 00:10:12,160
have to be really careful that we drive

262
00:10:12,160 --> 00:10:14,720
the right behavior to improve the

263
00:10:14,720 --> 00:10:16,800
software security industry

264
00:10:16,800 --> 00:10:18,160
because what's going to happen is when

265
00:10:18,160 --> 00:10:20,079
you have the top 10 and it's a pseudo

266
00:10:20,079 --> 00:10:21,680
standard then people are going to try

267
00:10:21,680 --> 00:10:23,600
and build things against it

268
00:10:23,600 --> 00:10:25,839
if we choose the wrong categories or we

269
00:10:25,839 --> 00:10:27,600
choose categories that actually end up

270
00:10:27,600 --> 00:10:31,120
causing regression in some spaces

271
00:10:31,120 --> 00:10:33,200
that's the last thing we want to do so

272
00:10:33,200 --> 00:10:35,440
we try to be really careful that what

273
00:10:35,440 --> 00:10:37,680
we're going to do the 10 categories

274
00:10:37,680 --> 00:10:39,519
we're going to produce is actually going

275
00:10:39,519 --> 00:10:42,320
to raise that bar for the industry that

276
00:10:42,320 --> 00:10:44,560
it will push people farther

277
00:10:44,560 --> 00:10:47,440
to develop in new areas

278
00:10:47,440 --> 00:10:49,920
and then the last one we had and this

279
00:10:49,920 --> 00:10:50,800
isn't

280
00:10:50,800 --> 00:10:53,360
new but it's being more explicit is we

281
00:10:53,360 --> 00:10:55,920
were we've set out to focus on root

282
00:10:55,920 --> 00:10:58,079
cause over symptom

283
00:10:58,079 --> 00:11:00,480
and i'll explain some of that so

284
00:11:00,480 --> 00:11:04,320
in 2017 we went back later and decided

285
00:11:04,320 --> 00:11:07,600
to draw basically a somewhat of a venn

286
00:11:07,600 --> 00:11:09,680
diagram of the relationship between the

287
00:11:09,680 --> 00:11:12,320
different categories in 2017.

288
00:11:12,320 --> 00:11:15,040
and we realized that you know in all

289
00:11:15,040 --> 00:11:16,959
all reality cross-site scripting is a

290
00:11:16,959 --> 00:11:19,200
form of injection it needed its own

291
00:11:19,200 --> 00:11:22,160
category for a while just so that

292
00:11:22,160 --> 00:11:24,880
it could have that kind of attention

293
00:11:24,880 --> 00:11:28,640
because it had really high frequency

294
00:11:28,640 --> 00:11:30,560
the data is showing that cross-site

295
00:11:30,560 --> 00:11:32,399
scripting is actually in decline at the

296
00:11:32,399 --> 00:11:34,880
moment and i think it's largely because

297
00:11:34,880 --> 00:11:36,959
of updates to languages and frameworks

298
00:11:36,959 --> 00:11:38,880
there are some that it's almost

299
00:11:38,880 --> 00:11:41,360
non-existent in and that's awesome

300
00:11:41,360 --> 00:11:44,320
that's the behavior we want to drive

301
00:11:44,320 --> 00:11:46,680
we also look at things like security

302
00:11:46,680 --> 00:11:49,279
misconfiguration can cause different

303
00:11:49,279 --> 00:11:51,920
types of things so also remember this is

304
00:11:51,920 --> 00:11:53,279
by title

305
00:11:53,279 --> 00:11:55,279
this is not by like the definition of

306
00:11:55,279 --> 00:11:57,760
the category meaning what cwes are in

307
00:11:57,760 --> 00:11:59,040
the category

308
00:11:59,040 --> 00:12:00,800
but one of the things that showed up on

309
00:12:00,800 --> 00:12:02,240
here that was kind of interesting was

310
00:12:02,240 --> 00:12:04,320
sensitive data exposure

311
00:12:04,320 --> 00:12:05,600
so it

312
00:12:05,600 --> 00:12:07,760
broken authentication creates sensitive

313
00:12:07,760 --> 00:12:10,160
data exposure broken x test control can

314
00:12:10,160 --> 00:12:11,839
create sensitive data exposure

315
00:12:11,839 --> 00:12:13,600
misconfiguration can create sensitive

316
00:12:13,600 --> 00:12:16,320
data exposure sensitive data exposure in

317
00:12:16,320 --> 00:12:17,440
itself

318
00:12:17,440 --> 00:12:20,480
is the result of something else

319
00:12:20,480 --> 00:12:22,399
there it is not a root cause it is

320
00:12:22,399 --> 00:12:24,480
telling you this is the effect

321
00:12:24,480 --> 00:12:26,399
this isn't the cause

322
00:12:26,399 --> 00:12:28,399
and so in

323
00:12:28,399 --> 00:12:30,480
it came to light and and i started to

324
00:12:30,480 --> 00:12:32,320
realize that when i saw like somebody

325
00:12:32,320 --> 00:12:34,079
was doing training for sensitive data

326
00:12:34,079 --> 00:12:35,680
exposure and then they said and we're

327
00:12:35,680 --> 00:12:37,360
going to go beyond the top 10 and talk

328
00:12:37,360 --> 00:12:39,600
about cryptographic failure

329
00:12:39,600 --> 00:12:41,680
which was the vast majority of what the

330
00:12:41,680 --> 00:12:44,160
sensitive data exposure category was i

331
00:12:44,160 --> 00:12:47,279
was like all right we've got this isn't

332
00:12:47,279 --> 00:12:49,040
we didn't do it well enough it's not

333
00:12:49,040 --> 00:12:51,519
being understood correctly

334
00:12:51,519 --> 00:12:53,839
and so that's part of the reason why we

335
00:12:53,839 --> 00:12:55,680
had change and we don't have sensitive

336
00:12:55,680 --> 00:12:58,320
data exposure anymore and the last thing

337
00:12:58,320 --> 00:13:00,560
on this that's interesting is i've had

338
00:13:00,560 --> 00:13:02,800
people tell me like well everything's in

339
00:13:02,800 --> 00:13:06,000
a9 you know because all of these things

340
00:13:06,000 --> 00:13:07,600
are in components with no

341
00:13:07,600 --> 00:13:09,680
vulnerabilities

342
00:13:09,680 --> 00:13:11,600
sort of now the interesting thing with

343
00:13:11,600 --> 00:13:13,120
components with nonvulnerabilities is

344
00:13:13,120 --> 00:13:15,360
that's third-party code all the other

345
00:13:15,360 --> 00:13:17,600
things are typically first-party code

346
00:13:17,600 --> 00:13:19,120
those are things that you're directly

347
00:13:19,120 --> 00:13:21,519
responsible for versus using something

348
00:13:21,519 --> 00:13:23,519
else that somebody else is directly

349
00:13:23,519 --> 00:13:25,760
responsible for

350
00:13:25,760 --> 00:13:27,680
so that drove some of the behavior in

351
00:13:27,680 --> 00:13:29,600
terms of how we looked at stuff within

352
00:13:29,600 --> 00:13:31,200
the top 10.

353
00:13:31,200 --> 00:13:33,440
so the one other thing i want to show is

354
00:13:33,440 --> 00:13:35,839
like when we're looking at the concept

355
00:13:35,839 --> 00:13:38,320
of where does the top 10 fit so one of

356
00:13:38,320 --> 00:13:41,199
the other projects i work on is sam so

357
00:13:41,199 --> 00:13:42,720
it's the software assurance maturity

358
00:13:42,720 --> 00:13:44,639
model

359
00:13:44,639 --> 00:13:46,399
so within sam

360
00:13:46,399 --> 00:13:49,279
so this is a exploded graphic of sam

361
00:13:49,279 --> 00:13:51,440
version 2.0 so all the business

362
00:13:51,440 --> 00:13:53,279
functions security practices their

363
00:13:53,279 --> 00:13:55,839
associated streams and activities

364
00:13:55,839 --> 00:13:58,639
so how the top 10 fits into this is the

365
00:13:58,639 --> 00:14:01,760
top 10 traditionally is used for

366
00:14:01,760 --> 00:14:03,920
the the basis to start security

367
00:14:03,920 --> 00:14:06,160
requirements so asvs gives you a whole

368
00:14:06,160 --> 00:14:08,160
lot more detail but sometimes people

369
00:14:08,160 --> 00:14:09,760
start with the top ten

370
00:14:09,760 --> 00:14:12,720
um it's easily consumable

371
00:14:12,720 --> 00:14:14,839
it's relatively simple by

372
00:14:14,839 --> 00:14:17,600
comparison it's not the end goal again

373
00:14:17,600 --> 00:14:20,160
it is a baseline but then you have it in

374
00:14:20,160 --> 00:14:22,560
for software dependencies

375
00:14:22,560 --> 00:14:24,399
related to third party components and

376
00:14:24,399 --> 00:14:27,279
then you have for control verification

377
00:14:27,279 --> 00:14:29,360
so sometimes also the top ten a lot of

378
00:14:29,360 --> 00:14:32,000
times it's used in policy and standards

379
00:14:32,000 --> 00:14:35,600
or training and awareness and so

380
00:14:35,600 --> 00:14:38,720
recently with the new updates

381
00:14:38,720 --> 00:14:40,720
so now the top 10 starts to touch a

382
00:14:40,720 --> 00:14:43,040
little bit on threat modeling a little

383
00:14:43,040 --> 00:14:46,079
bit on like secure architecture

384
00:14:46,079 --> 00:14:48,880
a little bit on deployment so the new

385
00:14:48,880 --> 00:14:50,480
software integrity software and data

386
00:14:50,480 --> 00:14:52,800
integrity category starts talking about

387
00:14:52,800 --> 00:14:55,040
things about securing your deployment

388
00:14:55,040 --> 00:14:56,639
process

389
00:14:56,639 --> 00:14:59,600
so but at the same time notice how

390
00:14:59,600 --> 00:15:01,440
little coverage

391
00:15:01,440 --> 00:15:03,120
of the entire software assurance

392
00:15:03,120 --> 00:15:05,199
maturity model that sam has that the top

393
00:15:05,199 --> 00:15:07,279
10 actually covers

394
00:15:07,279 --> 00:15:09,199
so just to give you an idea of like this

395
00:15:09,199 --> 00:15:11,519
is where its place is it is not a

396
00:15:11,519 --> 00:15:13,839
program

397
00:15:13,920 --> 00:15:16,880
so if we look at the data that helps us

398
00:15:16,880 --> 00:15:19,279
build the top 10 one of the things that

399
00:15:19,279 --> 00:15:21,120
i really want to make sure i do is i

400
00:15:21,120 --> 00:15:22,720
want to say thank you to everyone who

401
00:15:22,720 --> 00:15:24,399
contributed data

402
00:15:24,399 --> 00:15:25,440
because

403
00:15:25,440 --> 00:15:28,639
everyone here had to expend

404
00:15:28,639 --> 00:15:30,959
effort had to expend time

405
00:15:30,959 --> 00:15:33,360
to be able to pull the data together and

406
00:15:33,360 --> 00:15:34,959
structure it in the way that we

407
00:15:34,959 --> 00:15:36,160
requested

408
00:15:36,160 --> 00:15:38,720
and not every organization not every

409
00:15:38,720 --> 00:15:40,720
vendor not every group

410
00:15:40,720 --> 00:15:43,440
maps their vulnerability data to cwe's

411
00:15:43,440 --> 00:15:45,360
by default so for some of these

412
00:15:45,360 --> 00:15:46,880
organizations they had to go through a

413
00:15:46,880 --> 00:15:49,040
decent bit of work to take whatever they

414
00:15:49,040 --> 00:15:52,000
had for in-house categorization and then

415
00:15:52,000 --> 00:15:54,639
map them to cwes

416
00:15:54,639 --> 00:15:57,440
so we had 13 contributors

417
00:15:57,440 --> 00:15:59,839
12 are listed and one requested to be

418
00:15:59,839 --> 00:16:01,120
anonymous

419
00:16:01,120 --> 00:16:03,279
so again thank you for contributing data

420
00:16:03,279 --> 00:16:04,800
if you hadn't

421
00:16:04,800 --> 00:16:06,800
we wouldn't have the top 10 in its

422
00:16:06,800 --> 00:16:09,920
current form we wouldn't know

423
00:16:09,920 --> 00:16:12,240
but these 13 organizations contributed

424
00:16:12,240 --> 00:16:14,399
over half a million applications worth

425
00:16:14,399 --> 00:16:16,720
of vulnerability data

426
00:16:16,720 --> 00:16:18,959
it was amazing it's the largest group of

427
00:16:18,959 --> 00:16:20,560
data that i think we've ever put

428
00:16:20,560 --> 00:16:21,920
together

429
00:16:21,920 --> 00:16:26,800
in terms of just in one cohesive group

430
00:16:26,800 --> 00:16:29,279
so in that data one of the things that

431
00:16:29,279 --> 00:16:32,399
we continued through from 2017 was

432
00:16:32,399 --> 00:16:35,440
looking at incidence rate not frequency

433
00:16:35,440 --> 00:16:37,680
so one of the things if you remember in

434
00:16:37,680 --> 00:16:40,560
2017 we shifted from frequency to

435
00:16:40,560 --> 00:16:43,680
incidence rate so frequency was more

436
00:16:43,680 --> 00:16:45,519
hey if i test an application for

437
00:16:45,519 --> 00:16:47,040
cross-site scripting and it has a

438
00:16:47,040 --> 00:16:49,120
systemic problem you could have 4 or

439
00:16:49,120 --> 00:16:51,440
five thousand instances of cross-site

440
00:16:51,440 --> 00:16:52,560
scripting

441
00:16:52,560 --> 00:16:55,120
not terribly useful for our purposes it

442
00:16:55,120 --> 00:16:58,240
may be for that app itself so on a

443
00:16:58,240 --> 00:16:59,920
smaller scale if you're looking at the

444
00:16:59,920 --> 00:17:02,320
app itself knowing that there are 5 000

445
00:17:02,320 --> 00:17:04,000
instances of cross-site scripting means

446
00:17:04,000 --> 00:17:06,240
your likelihood is through the roof

447
00:17:06,240 --> 00:17:08,720
and you have a systemic problem you need

448
00:17:08,720 --> 00:17:10,880
to find some central control to be able

449
00:17:10,880 --> 00:17:14,160
to address this at the application level

450
00:17:14,160 --> 00:17:16,240
however when i'm trying to look at a

451
00:17:16,240 --> 00:17:18,240
global population of applications and

452
00:17:18,240 --> 00:17:20,160
try to figure out what percentage of

453
00:17:20,160 --> 00:17:22,319
that global population of applications

454
00:17:22,319 --> 00:17:24,079
is actually impacted by cross-site

455
00:17:24,079 --> 00:17:25,199
scripting

456
00:17:25,199 --> 00:17:27,599
i care much more about incidence rate i

457
00:17:27,599 --> 00:17:29,120
want to know what percentage of

458
00:17:29,120 --> 00:17:30,559
applications

459
00:17:30,559 --> 00:17:33,200
had one at least one instance of

460
00:17:33,200 --> 00:17:35,600
cross-site scripting for my purposes i

461
00:17:35,600 --> 00:17:37,840
don't care if it's one or five thousand

462
00:17:37,840 --> 00:17:39,520
that's not the point

463
00:17:39,520 --> 00:17:41,679
and again that's just because of the way

464
00:17:41,679 --> 00:17:43,600
we're looking at things we're trying to

465
00:17:43,600 --> 00:17:45,120
aggregate a bunch of different

466
00:17:45,120 --> 00:17:47,200
perspectives together from a bunch of

467
00:17:47,200 --> 00:17:49,840
different types of tests

468
00:17:49,840 --> 00:17:51,679
different it could be human-based

469
00:17:51,679 --> 00:17:54,799
testing it could be tool-based testing

470
00:17:54,799 --> 00:17:57,120
the thing is is you can put those two

471
00:17:57,120 --> 00:17:59,039
types of data together if you're looking

472
00:17:59,039 --> 00:18:00,480
at incidence rate

473
00:18:00,480 --> 00:18:03,360
you cannot merge human testing and tool

474
00:18:03,360 --> 00:18:05,440
testing if you're looking at frequency

475
00:18:05,440 --> 00:18:07,120
because when humans test things they

476
00:18:07,120 --> 00:18:08,880
will find two or three instances of it

477
00:18:08,880 --> 00:18:10,240
and they're like you know what i don't

478
00:18:10,240 --> 00:18:12,640
have the time to find 5000 or document

479
00:18:12,640 --> 00:18:13,520
them

480
00:18:13,520 --> 00:18:15,360
so i will tell you you have a cross-site

481
00:18:15,360 --> 00:18:17,600
scripting problem here's three examples

482
00:18:17,600 --> 00:18:19,679
and i move on because that's what i'm

483
00:18:19,679 --> 00:18:20,880
paid to do

484
00:18:20,880 --> 00:18:23,679
a program or a testing tool will move on

485
00:18:23,679 --> 00:18:26,880
and it will dutifully identify 5 000

486
00:18:26,880 --> 00:18:28,880
individual points of failure for

487
00:18:28,880 --> 00:18:30,320
cross-site scripting

488
00:18:30,320 --> 00:18:32,559
you can't merge those two types of data

489
00:18:32,559 --> 00:18:34,799
together because the tool data will

490
00:18:34,799 --> 00:18:37,039
absolutely drown the people

491
00:18:37,039 --> 00:18:38,559
so that's why we deal with incidence

492
00:18:38,559 --> 00:18:39,600
rate

493
00:18:39,600 --> 00:18:40,960
one of the other things that was

494
00:18:40,960 --> 00:18:44,320
interesting in here is when we went

495
00:18:44,320 --> 00:18:46,080
in 2017

496
00:18:46,080 --> 00:18:47,200
the

497
00:18:47,200 --> 00:18:51,200
data call had like 30 defined cwes we

498
00:18:51,200 --> 00:18:52,480
asked hey

499
00:18:52,480 --> 00:18:54,640
for these 30 cwes tell me what kind of

500
00:18:54,640 --> 00:18:56,960
data you have and if you have some other

501
00:18:56,960 --> 00:18:58,720
ones please let us know what other ones

502
00:18:58,720 --> 00:19:00,640
you think might be interesting

503
00:19:00,640 --> 00:19:02,960
so in general we had a fairly narrow

504
00:19:02,960 --> 00:19:04,559
view we were looking at things that were

505
00:19:04,559 --> 00:19:06,480
more commonly known and understood at

506
00:19:06,480 --> 00:19:08,320
the time

507
00:19:08,320 --> 00:19:10,240
for this time around we said you know

508
00:19:10,240 --> 00:19:12,160
what would be really interesting if we

509
00:19:12,160 --> 00:19:14,640
just said send us your data

510
00:19:14,640 --> 00:19:17,600
send us cwes that you track that you map

511
00:19:17,600 --> 00:19:19,600
against because we were really curious

512
00:19:19,600 --> 00:19:21,039
to see what was actually out there

513
00:19:21,039 --> 00:19:23,440
because we had this theory that we were

514
00:19:23,440 --> 00:19:24,880
missing stuff

515
00:19:24,880 --> 00:19:27,840
because we were prescribing which cwes

516
00:19:27,840 --> 00:19:30,240
we had asked for previously

517
00:19:30,240 --> 00:19:31,039
so

518
00:19:31,039 --> 00:19:33,440
it opened floodgates i really did not

519
00:19:33,440 --> 00:19:37,120
expect to get almost 400 unique cwes

520
00:19:37,120 --> 00:19:38,880
mapped in the data

521
00:19:38,880 --> 00:19:41,919
so that ended up changing how we built

522
00:19:41,919 --> 00:19:44,320
the categories because no longer did we

523
00:19:44,320 --> 00:19:46,160
have categories that were somewhere

524
00:19:46,160 --> 00:19:47,280
around

525
00:19:47,280 --> 00:19:49,840
one to five cwes

526
00:19:49,840 --> 00:19:52,640
so this time around when we grouped

527
00:19:52,640 --> 00:19:55,120
findings together cwes together into

528
00:19:55,120 --> 00:19:56,799
risk categories

529
00:19:56,799 --> 00:20:00,559
we went from we had an average of 20

530
00:20:00,559 --> 00:20:03,280
cwes per category and it would range

531
00:20:03,280 --> 00:20:05,600
from 1 to 40.

532
00:20:05,600 --> 00:20:07,760
and i'll explain the one later there's a

533
00:20:07,760 --> 00:20:09,760
reason for it

534
00:20:09,760 --> 00:20:11,520
but when we asked for data we said

535
00:20:11,520 --> 00:20:13,280
please at a minimum give us this

536
00:20:13,280 --> 00:20:15,679
information for a given year

537
00:20:15,679 --> 00:20:17,600
for a given cwe

538
00:20:17,600 --> 00:20:19,919
tell us how many applications you tested

539
00:20:19,919 --> 00:20:21,840
what was that population and then how

540
00:20:21,840 --> 00:20:23,760
many apps did you find at least one

541
00:20:23,760 --> 00:20:26,080
instance of that cwe

542
00:20:26,080 --> 00:20:28,000
and there was other metadata that we

543
00:20:28,000 --> 00:20:29,760
asked for we said hey if you can tell us

544
00:20:29,760 --> 00:20:31,840
what kind of testing tool or whether

545
00:20:31,840 --> 00:20:34,640
this was a human whether this was fast

546
00:20:34,640 --> 00:20:36,559
sassed i asked

547
00:20:36,559 --> 00:20:38,880
you know what kind of tool you used what

548
00:20:38,880 --> 00:20:41,120
kind of language what kind of

549
00:20:41,120 --> 00:20:43,280
industry vertical

550
00:20:43,280 --> 00:20:45,200
a number of different things and so

551
00:20:45,200 --> 00:20:47,200
beyond this base

552
00:20:47,200 --> 00:20:50,080
set of criteria we got a variety or

553
00:20:50,080 --> 00:20:53,039
varied responses depending on how an

554
00:20:53,039 --> 00:20:55,760
organization stored the data

555
00:20:55,760 --> 00:20:57,600
but at a minimum we had this because we

556
00:20:57,600 --> 00:20:59,840
needed this level of minimum data to be

557
00:20:59,840 --> 00:21:01,440
able to compare the results against each

558
00:21:01,440 --> 00:21:02,799
other

559
00:21:02,799 --> 00:21:05,440
so we had interesting results so i went

560
00:21:05,440 --> 00:21:07,760
back through and i analyzed all the cwes

561
00:21:07,760 --> 00:21:10,720
that we were sent and there was only one

562
00:21:10,720 --> 00:21:14,159
cwe that all 13 organizations said they

563
00:21:14,159 --> 00:21:19,520
actually tested for and that was cwe 79.

564
00:21:19,520 --> 00:21:21,840
so if you've played with cwes not

565
00:21:21,840 --> 00:21:24,480
everybody has but if you had you should

566
00:21:24,480 --> 00:21:28,320
recognize cwe79 because cwe79 is

567
00:21:28,320 --> 00:21:30,799
basically cross-site scripting

568
00:21:30,799 --> 00:21:32,799
it is probably one of the easier things

569
00:21:32,799 --> 00:21:34,880
to test for and one of the more common

570
00:21:34,880 --> 00:21:37,200
things that you can find so we have a

571
00:21:37,200 --> 00:21:39,520
plethora of test cases to be able to

572
00:21:39,520 --> 00:21:42,000
test first process scripting the fun

573
00:21:42,000 --> 00:21:45,600
thing is is we also use cwe80

574
00:21:45,600 --> 00:21:48,960
which is also cross-site scripting

575
00:21:48,960 --> 00:21:50,240
slight

576
00:21:50,240 --> 00:21:52,559
very slight difference between the two

577
00:21:52,559 --> 00:21:54,640
but we found that sometimes people use

578
00:21:54,640 --> 00:21:57,440
79 sometimes they use 80.

579
00:21:57,440 --> 00:21:59,520
the second largest one that we had 12

580
00:21:59,520 --> 00:22:00,320
people

581
00:22:00,320 --> 00:22:02,640
or 12 organizations test for was cwe

582
00:22:02,640 --> 00:22:06,640
200. so cwe 200 is exposure of sensitive

583
00:22:06,640 --> 00:22:09,360
information to an unauthorized actor

584
00:22:09,360 --> 00:22:12,159
so this is it just sounds like you know

585
00:22:12,159 --> 00:22:14,880
sensitive data exposure

586
00:22:14,880 --> 00:22:17,760
in reality if you dig into the details

587
00:22:17,760 --> 00:22:21,039
of cwe 200 it is actually a broken

588
00:22:21,039 --> 00:22:24,080
access control cwe it is talking about

589
00:22:24,080 --> 00:22:26,240
in the detail it talks about broken

590
00:22:26,240 --> 00:22:28,559
access control that's why you expose

591
00:22:28,559 --> 00:22:30,480
data

592
00:22:30,480 --> 00:22:34,000
but on the surface absolutely by title

593
00:22:34,000 --> 00:22:38,400
looks like it is more of a symptom cwd

594
00:22:38,400 --> 00:22:42,000
so number 10 had three or not number 10.

595
00:22:42,000 --> 00:22:43,360
the third one down there there were

596
00:22:43,360 --> 00:22:45,919
three cwes that 10 organizations looked

597
00:22:45,919 --> 00:22:46,799
for

598
00:22:46,799 --> 00:22:49,200
and it was 327 which is broken or risky

599
00:22:49,200 --> 00:22:50,880
crypto algorithm

600
00:22:50,880 --> 00:22:54,480
um 89 which again if you play with cwes

601
00:22:54,480 --> 00:22:56,240
you should recognize 89 because that's

602
00:22:56,240 --> 00:22:57,760
sql injection

603
00:22:57,760 --> 00:22:59,919
and then we had 352 which is cross site

604
00:22:59,919 --> 00:23:02,000
request forgery

605
00:23:02,000 --> 00:23:03,919
and then we tail off and the interesting

606
00:23:03,919 --> 00:23:07,280
thing is is greater than 75

607
00:23:07,280 --> 00:23:09,679
of the cwes contributed in our data set

608
00:23:09,679 --> 00:23:11,120
were tested at three or fewer

609
00:23:11,120 --> 00:23:12,480
organizations

610
00:23:12,480 --> 00:23:14,720
which tells me that

611
00:23:14,720 --> 00:23:15,760
we

612
00:23:15,760 --> 00:23:17,440
um

613
00:23:17,440 --> 00:23:18,559
we

614
00:23:18,559 --> 00:23:19,840
differ

615
00:23:19,840 --> 00:23:22,720
sometimes greatly on how we map

616
00:23:22,720 --> 00:23:25,039
types of vulnerabilities or how we map

617
00:23:25,039 --> 00:23:28,080
things to cwes and we may differ greatly

618
00:23:28,080 --> 00:23:30,799
on how we test for things

619
00:23:30,799 --> 00:23:32,240
and that's an interesting thing in this

620
00:23:32,240 --> 00:23:34,480
data so the other thing i have is

621
00:23:34,480 --> 00:23:36,720
limitations on this data like

622
00:23:36,720 --> 00:23:39,679
i don't know exactly like what tests you

623
00:23:39,679 --> 00:23:43,039
ran how often the same app was tested

624
00:23:43,039 --> 00:23:45,360
we did ask for retests like is this the

625
00:23:45,360 --> 00:23:47,039
first time you ever tested the app for

626
00:23:47,039 --> 00:23:49,360
that year or if this was a retest

627
00:23:49,360 --> 00:23:51,679
so our five hundred thousand five

628
00:23:51,679 --> 00:23:53,440
hundred fifteen thousand apps that we

629
00:23:53,440 --> 00:23:56,159
have were all marked as retest note

630
00:23:56,159 --> 00:23:57,679
we have another three hundred and some

631
00:23:57,679 --> 00:24:00,000
thousand applications that were retest

632
00:24:00,000 --> 00:24:04,159
versions of the original applications

633
00:24:04,159 --> 00:24:06,880
but it's kind of interesting to see how

634
00:24:06,880 --> 00:24:08,799
differently we decide

635
00:24:08,799 --> 00:24:11,120
to map cwe's to different types of

636
00:24:11,120 --> 00:24:13,440
vulnerabilities

637
00:24:13,440 --> 00:24:15,760
so if you also remember we have

638
00:24:15,760 --> 00:24:19,120
a community survey so in this survey

639
00:24:19,120 --> 00:24:21,120
again we asked

640
00:24:21,120 --> 00:24:23,279
what do you think should be in the top

641
00:24:23,279 --> 00:24:25,039
10 that you think it's unlikely will

642
00:24:25,039 --> 00:24:28,159
have data or unlikely to be testable

643
00:24:28,159 --> 00:24:31,279
so number one in the survey was cross

644
00:24:31,279 --> 00:24:33,039
site there were server side request

645
00:24:33,039 --> 00:24:35,919
forgery so ssrf

646
00:24:35,919 --> 00:24:38,960
it's really interesting because ssrf was

647
00:24:38,960 --> 00:24:42,559
in the data but if we went by data ssrf

648
00:24:42,559 --> 00:24:45,360
wasn't that big of a problem

649
00:24:45,360 --> 00:24:46,799
so

650
00:24:46,799 --> 00:24:48,000
i don't

651
00:24:48,000 --> 00:24:51,600
so i can guess at why these two don't

652
00:24:51,600 --> 00:24:53,520
agree with each other so some of it may

653
00:24:53,520 --> 00:24:56,159
be ssrf is new enough

654
00:24:56,159 --> 00:24:58,480
um that we're not really that great at

655
00:24:58,480 --> 00:25:01,600
testing for it yet that it's there but

656
00:25:01,600 --> 00:25:04,080
we're not really good at finding it

657
00:25:04,080 --> 00:25:06,240
so this may be a point where the humans

658
00:25:06,240 --> 00:25:08,480
tell us yes this is a problem we have

659
00:25:08,480 --> 00:25:10,799
seen it it creates large problems there

660
00:25:10,799 --> 00:25:13,279
is a large impact when we find it

661
00:25:13,279 --> 00:25:14,640
and the humans are better at

662
00:25:14,640 --> 00:25:16,320
understanding that it's there and they

663
00:25:16,320 --> 00:25:18,320
can find it and we just haven't taught

664
00:25:18,320 --> 00:25:20,240
the automated tools how to find it just

665
00:25:20,240 --> 00:25:22,240
as well yet

666
00:25:22,240 --> 00:25:24,159
it may also be that the humans have a

667
00:25:24,159 --> 00:25:27,120
bias and there's been just enough large

668
00:25:27,120 --> 00:25:29,200
news stories and twitter action in the

669
00:25:29,200 --> 00:25:31,120
last couple years that the perception is

670
00:25:31,120 --> 00:25:34,240
ssrf is a really big problem

671
00:25:34,240 --> 00:25:36,240
i don't know for sure which one is which

672
00:25:36,240 --> 00:25:38,080
but we'll find out in the next two or

673
00:25:38,080 --> 00:25:40,000
three years when we do this again and we

674
00:25:40,000 --> 00:25:42,240
see what the data ends up coming to do

675
00:25:42,240 --> 00:25:44,240
we improve testing and then we find out

676
00:25:44,240 --> 00:25:46,559
yes it is a bigger problem

677
00:25:46,559 --> 00:25:47,760
or does it

678
00:25:47,760 --> 00:25:52,559
quietly slide away i'm not entirely sure

679
00:25:52,559 --> 00:25:54,240
i think it's a bigger deal than the

680
00:25:54,240 --> 00:25:56,880
testing data shows but again we'll

681
00:25:56,880 --> 00:25:58,720
figure it out

682
00:25:58,720 --> 00:26:00,960
the second one in the survey was

683
00:26:00,960 --> 00:26:03,520
unmaintained third-party components

684
00:26:03,520 --> 00:26:05,200
so the data

685
00:26:05,200 --> 00:26:07,679
actually had the data

686
00:26:07,679 --> 00:26:10,159
was large enough for this particular

687
00:26:10,159 --> 00:26:12,320
type of cwe that it actually made it

688
00:26:12,320 --> 00:26:14,320
into the top 10 by data and it didn't

689
00:26:14,320 --> 00:26:16,240
need to come in by survey

690
00:26:16,240 --> 00:26:17,840
so the interesting thing is is number

691
00:26:17,840 --> 00:26:19,120
three was insufficient logging and

692
00:26:19,120 --> 00:26:20,640
monitoring

693
00:26:20,640 --> 00:26:22,640
so that's an interesting category when

694
00:26:22,640 --> 00:26:25,600
we added it in 2017

695
00:26:25,600 --> 00:26:27,520
by survey

696
00:26:27,520 --> 00:26:29,039
we had some people tell us oh you're

697
00:26:29,039 --> 00:26:30,480
going to break the top 10 you can't

698
00:26:30,480 --> 00:26:32,159
actually test for insufficient logging

699
00:26:32,159 --> 00:26:34,080
and monitoring what is insufficient mean

700
00:26:34,080 --> 00:26:36,000
anyway

701
00:26:36,000 --> 00:26:37,760
and it was really interesting to see in

702
00:26:37,760 --> 00:26:41,120
2021 that if people hadn't voted it back

703
00:26:41,120 --> 00:26:42,880
in on the survey it wouldn't have made

704
00:26:42,880 --> 00:26:45,200
it in it just flat out wouldn't because

705
00:26:45,200 --> 00:26:47,039
those are essentially the guidelines the

706
00:26:47,039 --> 00:26:48,880
guidance and the rules that we set forth

707
00:26:48,880 --> 00:26:50,559
for how we build it

708
00:26:50,559 --> 00:26:52,400
but people came back and said you know

709
00:26:52,400 --> 00:26:54,720
what this really is important

710
00:26:54,720 --> 00:26:57,039
this is a category that is really tough

711
00:26:57,039 --> 00:27:00,080
to test for it is hard to determine

712
00:27:00,080 --> 00:27:01,919
insufficient login and monitoring or

713
00:27:01,919 --> 00:27:05,360
we've updated in 2021 it is now security

714
00:27:05,360 --> 00:27:07,520
logging and monitoring failures it's

715
00:27:07,520 --> 00:27:09,919
really important you're highly unlikely

716
00:27:09,919 --> 00:27:11,679
to be

717
00:27:11,679 --> 00:27:14,640
be exploited through it but if your

718
00:27:14,640 --> 00:27:17,039
application is exploited in some way or

719
00:27:17,039 --> 00:27:20,159
you have a breach if you don't have

720
00:27:20,159 --> 00:27:22,799
sufficient login and monitoring you in

721
00:27:22,799 --> 00:27:25,520
for security events you're in a heap of

722
00:27:25,520 --> 00:27:27,120
trouble you're gonna have real trouble

723
00:27:27,120 --> 00:27:30,640
identifying who where what when why

724
00:27:30,640 --> 00:27:33,679
so it's absolutely an important category

725
00:27:33,679 --> 00:27:35,200
so then the other ones we have we have

726
00:27:35,200 --> 00:27:37,679
like unprotected storage of credentials

727
00:27:37,679 --> 00:27:40,159
unrestricted upload a file of dangerous

728
00:27:40,159 --> 00:27:42,960
types excessive attack surface and so on

729
00:27:42,960 --> 00:27:45,760
the vast majority of these vast majority

730
00:27:45,760 --> 00:27:48,320
of these other cwes are in other

731
00:27:48,320 --> 00:27:50,559
categories because there was some data

732
00:27:50,559 --> 00:27:52,559
for them that would show up and so they

733
00:27:52,559 --> 00:27:56,960
got bundled into other categories

734
00:27:57,039 --> 00:27:59,039
so we're so one of the things we want to

735
00:27:59,039 --> 00:28:00,320
do is

736
00:28:00,320 --> 00:28:03,200
manage likelihood so if you look at

737
00:28:03,200 --> 00:28:05,840
the risk basic risk calculation right

738
00:28:05,840 --> 00:28:09,120
likelihood times impact

739
00:28:09,440 --> 00:28:11,840
so you look at incidence rate so the

740
00:28:11,840 --> 00:28:14,880
number of apps that we find a cwe in

741
00:28:14,880 --> 00:28:16,480
versus the number of apps tested for

742
00:28:16,480 --> 00:28:18,240
that cwe

743
00:28:18,240 --> 00:28:20,159
we had some interesting scenarios so if

744
00:28:20,159 --> 00:28:23,760
we looked at the data for cwe 552

745
00:28:23,760 --> 00:28:25,840
so files or directories are accessible

746
00:28:25,840 --> 00:28:27,840
to external parties

747
00:28:27,840 --> 00:28:30,159
the data we had showed an incidence rate

748
00:28:30,159 --> 00:28:32,559
of almost 56 percent

749
00:28:32,559 --> 00:28:34,960
of the 11 000 apps tested for it was

750
00:28:34,960 --> 00:28:36,880
found in 6000 apps

751
00:28:36,880 --> 00:28:39,520
however the population that we had

752
00:28:39,520 --> 00:28:42,320
overall was over half a million apps

753
00:28:42,320 --> 00:28:44,799
so in reality only two percent of our

754
00:28:44,799 --> 00:28:47,120
total population that was contributed

755
00:28:47,120 --> 00:28:49,679
was really tested for the cwe

756
00:28:49,679 --> 00:28:51,120
so while

757
00:28:51,120 --> 00:28:54,080
when it was tested for it was found

758
00:28:54,080 --> 00:28:57,039
in essentially half the applications

759
00:28:57,039 --> 00:28:59,600
overall it really only has an incidence

760
00:28:59,600 --> 00:29:02,159
rate of 1.2 percent the problem is is

761
00:29:02,159 --> 00:29:04,399
we're trying to figure out

762
00:29:04,399 --> 00:29:07,360
how is this statistically significant

763
00:29:07,360 --> 00:29:09,679
how likely is this to be an accurate

764
00:29:09,679 --> 00:29:11,120
representation of the rest of the

765
00:29:11,120 --> 00:29:12,559
population

766
00:29:12,559 --> 00:29:14,559
so what we did is we created another

767
00:29:14,559 --> 00:29:17,039
factor we considered coverage

768
00:29:17,039 --> 00:29:19,039
so coverage is what percent of the

769
00:29:19,039 --> 00:29:22,000
population overall was actually tested

770
00:29:22,000 --> 00:29:23,440
for cwe

771
00:29:23,440 --> 00:29:25,600
so this helps us indicate a level of

772
00:29:25,600 --> 00:29:26,640
assurance

773
00:29:26,640 --> 00:29:28,880
so if you've only tested two percent of

774
00:29:28,880 --> 00:29:32,159
the population for a particular cwe

775
00:29:32,159 --> 00:29:34,240
i'm not as convinced that that is a

776
00:29:34,240 --> 00:29:36,000
representative sample

777
00:29:36,000 --> 00:29:39,440
but if you get into things like

778
00:29:39,440 --> 00:29:41,600
cwe 200

779
00:29:41,600 --> 00:29:42,480
where

780
00:29:42,480 --> 00:29:44,399
it has an incidence rate of almost 20

781
00:29:44,399 --> 00:29:46,240
percent

782
00:29:46,240 --> 00:29:48,720
which is still significant but you look

783
00:29:48,720 --> 00:29:51,039
at the number of apps tested represented

784
00:29:51,039 --> 00:29:53,600
about 94 95 percent of the total

785
00:29:53,600 --> 00:29:54,960
population

786
00:29:54,960 --> 00:29:57,120
so at that point i have a high level of

787
00:29:57,120 --> 00:29:59,440
assurance that this incidence rate of

788
00:29:59,440 --> 00:30:00,559
nearly 20

789
00:30:00,559 --> 00:30:02,399
is accurate

790
00:30:02,399 --> 00:30:04,559
so of our entire population the vast

791
00:30:04,559 --> 00:30:06,720
majority of the apps in that population

792
00:30:06,720 --> 00:30:10,960
were tested for this particular cwe

793
00:30:11,120 --> 00:30:12,000
so

794
00:30:12,000 --> 00:30:14,880
but the interesting thing is again is

795
00:30:14,880 --> 00:30:17,760
i believe judging looking at the data

796
00:30:17,760 --> 00:30:20,640
it's my analysis that says i think cwe

797
00:30:20,640 --> 00:30:23,600
200 keeps getting used as a catch-all

798
00:30:23,600 --> 00:30:26,559
so anytime sensitive data is exposed a

799
00:30:26,559 --> 00:30:28,880
lot of times that cbe gets assigned to

800
00:30:28,880 --> 00:30:31,520
it not necessarily because we understand

801
00:30:31,520 --> 00:30:32,960
the root cause

802
00:30:32,960 --> 00:30:34,880
but we just understand sensitive data

803
00:30:34,880 --> 00:30:37,279
got coughed up or this could cause cough

804
00:30:37,279 --> 00:30:39,600
up sensitive data and rather than

805
00:30:39,600 --> 00:30:42,799
mapping to a cwe that is like the actual

806
00:30:42,799 --> 00:30:45,279
reason why sensitive data was

807
00:30:45,279 --> 00:30:48,640
exposed we actually use the cwe that

808
00:30:48,640 --> 00:30:52,000
says we expose sensitive data

809
00:30:52,000 --> 00:30:53,760
so one of the other interesting things i

810
00:30:53,760 --> 00:30:56,320
wanted to look at in this data is

811
00:30:56,320 --> 00:30:58,240
how does a different tooling compare

812
00:30:58,240 --> 00:31:00,320
with each other so this is a topic that

813
00:31:00,320 --> 00:31:02,080
gets brought up from time to time where

814
00:31:02,080 --> 00:31:03,440
we're looking at

815
00:31:03,440 --> 00:31:07,279
what does dast fine versus sast versus i

816
00:31:07,279 --> 00:31:09,360
asked like how do they relate to each

817
00:31:09,360 --> 00:31:11,360
other is there overlap

818
00:31:11,360 --> 00:31:13,120
and so some of the stuff i've seen so

819
00:31:13,120 --> 00:31:16,080
far says there's probably

820
00:31:16,080 --> 00:31:20,320
10 15 20 percent overlap between dynamic

821
00:31:20,320 --> 00:31:22,880
testing and static testing

822
00:31:22,880 --> 00:31:24,960
i asked crosses over between the other

823
00:31:24,960 --> 00:31:26,880
two as well

824
00:31:26,880 --> 00:31:29,519
so in the data that we had

825
00:31:29,519 --> 00:31:31,760
that was actually identified as this was

826
00:31:31,760 --> 00:31:35,120
a sas tool so static analysis static

827
00:31:35,120 --> 00:31:37,600
application security testing type tool

828
00:31:37,600 --> 00:31:40,000
we had certain cwe so things like use of

829
00:31:40,000 --> 00:31:41,600
hard coded password

830
00:31:41,600 --> 00:31:43,440
yeah absolutely that's going to be a

831
00:31:43,440 --> 00:31:46,000
static analysis dynamic analysis isn't

832
00:31:46,000 --> 00:31:47,519
going to tell you that it doesn't look

833
00:31:47,519 --> 00:31:50,159
in that way so that i totally expect to

834
00:31:50,159 --> 00:31:52,720
show up in sas so these are the top 10

835
00:31:52,720 --> 00:31:54,799
cwes that show up

836
00:31:54,799 --> 00:31:56,399
for tools that were

837
00:31:56,399 --> 00:31:58,159
data that was identified coming from a

838
00:31:58,159 --> 00:32:00,320
sas tool

839
00:32:00,320 --> 00:32:02,080
insufficient entropy

840
00:32:02,080 --> 00:32:04,240
again that's really really hard to test

841
00:32:04,240 --> 00:32:05,440
for

842
00:32:05,440 --> 00:32:07,760
in a dynamic environment because you

843
00:32:07,760 --> 00:32:11,039
would have to do a ton of sampling

844
00:32:11,039 --> 00:32:12,320
to try and determine you didn't have

845
00:32:12,320 --> 00:32:14,480
sufficient entropy in the static

846
00:32:14,480 --> 00:32:16,240
analysis side you could absolutely just

847
00:32:16,240 --> 00:32:18,480
be like well i know that method call is

848
00:32:18,480 --> 00:32:20,000
not a proper

849
00:32:20,000 --> 00:32:21,760
pseudo-random number generator you don't

850
00:32:21,760 --> 00:32:23,519
have enough entropy

851
00:32:23,519 --> 00:32:25,600
then that's actually quite easy to spot

852
00:32:25,600 --> 00:32:28,960
at a static analysis level so in dynamic

853
00:32:28,960 --> 00:32:31,120
analysis we have thing we can find

854
00:32:31,120 --> 00:32:32,880
things like hey we've exposed sensitive

855
00:32:32,880 --> 00:32:35,360
information to unauthorized actors

856
00:32:35,360 --> 00:32:38,080
because we can do access control checks

857
00:32:38,080 --> 00:32:40,480
sensitive cookies so this is interesting

858
00:32:40,480 --> 00:32:42,880
so if we look at things that are related

859
00:32:42,880 --> 00:32:45,440
to cookies and headers for applications

860
00:32:45,440 --> 00:32:47,760
or apis

861
00:32:47,760 --> 00:32:50,480
this is something that static analysis

862
00:32:50,480 --> 00:32:52,559
can't really tell us with any level of

863
00:32:52,559 --> 00:32:54,799
confidence because

864
00:32:54,799 --> 00:32:58,480
those settings like flags on cookies or

865
00:32:58,480 --> 00:33:00,399
the existence of a header

866
00:33:00,399 --> 00:33:02,720
those may not exist in the source code

867
00:33:02,720 --> 00:33:05,919
those might exist on some network device

868
00:33:05,919 --> 00:33:07,840
might be a waf might be a proxy server

869
00:33:07,840 --> 00:33:09,279
might be a web server might be an app

870
00:33:09,279 --> 00:33:12,480
server might be some kind of external

871
00:33:12,480 --> 00:33:14,880
factor to the application itself

872
00:33:14,880 --> 00:33:16,960
only through dynamic

873
00:33:16,960 --> 00:33:19,039
testing can you actually see in the

874
00:33:19,039 --> 00:33:21,360
response that went back to the user or

875
00:33:21,360 --> 00:33:24,080
the calling system do we actually see if

876
00:33:24,080 --> 00:33:26,159
this exists or not

877
00:33:26,159 --> 00:33:28,640
so there's definitely things that can be

878
00:33:28,640 --> 00:33:29,600
found

879
00:33:29,600 --> 00:33:31,440
in one or the other

880
00:33:31,440 --> 00:33:33,679
that the other type of data testing

881
00:33:33,679 --> 00:33:35,600
cannot actually find

882
00:33:35,600 --> 00:33:38,080
so i asked is interesting because iast

883
00:33:38,080 --> 00:33:39,440
is actually

884
00:33:39,440 --> 00:33:41,200
generally from my experience more

885
00:33:41,200 --> 00:33:43,440
accurate because it can actually see

886
00:33:43,440 --> 00:33:45,039
what's going on

887
00:33:45,039 --> 00:33:46,960
the challenge with is it doesn't

888
00:33:46,960 --> 00:33:50,000
actually have its own testing model it's

889
00:33:50,000 --> 00:33:52,880
dependent on your testing coverage from

890
00:33:52,880 --> 00:33:55,120
something else that invokes tests

891
00:33:55,120 --> 00:33:56,720
but it's really good about actually

892
00:33:56,720 --> 00:33:58,640
watching what's going on under the

893
00:33:58,640 --> 00:33:59,679
covers

894
00:33:59,679 --> 00:34:02,080
so if we've got things going out like

895
00:34:02,080 --> 00:34:04,080
input validation it can trace that and

896
00:34:04,080 --> 00:34:06,880
it can give you a lower chance of false

897
00:34:06,880 --> 00:34:09,119
positives to determine whether or not

898
00:34:09,119 --> 00:34:11,599
something's showing up

899
00:34:11,599 --> 00:34:13,918
so some of these cwes you can see that

900
00:34:13,918 --> 00:34:16,320
like they're fairly unique to is because

901
00:34:16,320 --> 00:34:18,960
it has insight into things

902
00:34:18,960 --> 00:34:21,359
so looking at these different top tens

903
00:34:21,359 --> 00:34:23,359
for tools i was curious like how much do

904
00:34:23,359 --> 00:34:26,000
they overlap so sensitive data exposure

905
00:34:26,000 --> 00:34:28,239
is interesting because half of it comes

906
00:34:28,239 --> 00:34:30,800
out of i asked identified tools

907
00:34:30,800 --> 00:34:32,839
a third of it's from dast

908
00:34:32,839 --> 00:34:36,879
and 16 comes out of a sas type tool

909
00:34:36,879 --> 00:34:39,440
sql injection is predominantly static

910
00:34:39,440 --> 00:34:42,239
analysis tools

911
00:34:42,239 --> 00:34:45,199
in terms of like yep we see it we do it

912
00:34:45,199 --> 00:34:47,119
i think i asked is probably

913
00:34:47,119 --> 00:34:49,040
underrepresented here because i asked

914
00:34:49,040 --> 00:34:50,800
would actually be quite useful in

915
00:34:50,800 --> 00:34:52,719
identifying whether or not sql injection

916
00:34:52,719 --> 00:34:55,440
would actually work

917
00:34:55,440 --> 00:34:57,440
cross-site scripting is i'm not

918
00:34:57,440 --> 00:34:59,359
surprised it's a relatively decent

919
00:34:59,359 --> 00:35:00,720
balance

920
00:35:00,720 --> 00:35:03,839
here sas is almost 50 and i asked and

921
00:35:03,839 --> 00:35:06,240
das kind of split the rest of it

922
00:35:06,240 --> 00:35:07,839
looking at things like insufficient

923
00:35:07,839 --> 00:35:09,520
entropy

924
00:35:09,520 --> 00:35:12,560
i asked and asked won't see that

925
00:35:12,560 --> 00:35:14,240
you just don't it's not really worth

926
00:35:14,240 --> 00:35:16,000
testing for that kind of problem in

927
00:35:16,000 --> 00:35:18,160
either of those types of testing that's

928
00:35:18,160 --> 00:35:20,640
a hundred percent sas tool

929
00:35:20,640 --> 00:35:21,920
click jacking

930
00:35:21,920 --> 00:35:23,520
click checking is kind of interesting

931
00:35:23,520 --> 00:35:27,280
because again it is how that result is

932
00:35:27,280 --> 00:35:30,320
represented to the user so in our click

933
00:35:30,320 --> 00:35:33,200
checking data it's 100 das tool

934
00:35:33,200 --> 00:35:35,520
identified as clickjacking

935
00:35:35,520 --> 00:35:37,359
so there's some interesting overlap

936
00:35:37,359 --> 00:35:38,960
between the three

937
00:35:38,960 --> 00:35:40,960
i'm still playing with the data i

938
00:35:40,960 --> 00:35:43,280
haven't gotten into like percent overall

939
00:35:43,280 --> 00:35:44,880
percentages

940
00:35:44,880 --> 00:35:48,640
different types of overlap with that but

941
00:35:48,640 --> 00:35:50,800
basically what we come away with is on

942
00:35:50,800 --> 00:35:52,480
one hand i wish i could tell you pick

943
00:35:52,480 --> 00:35:54,400
one of the three you're covered but in

944
00:35:54,400 --> 00:35:57,040
reality each of them finds unique things

945
00:35:57,040 --> 00:35:59,040
that the others can't find

946
00:35:59,040 --> 00:36:01,760
so you kind of need all of them

947
00:36:01,760 --> 00:36:05,359
if you want that full coverage

948
00:36:05,359 --> 00:36:08,160
so again remember risk is likelihood and

949
00:36:08,160 --> 00:36:09,280
impact

950
00:36:09,280 --> 00:36:10,800
i'm not going to get into the fact that

951
00:36:10,800 --> 00:36:13,440
we rarely use time and likelihood so

952
00:36:13,440 --> 00:36:15,520
it's kind of incomplete compared to how

953
00:36:15,520 --> 00:36:17,920
other industries use risk

954
00:36:17,920 --> 00:36:20,480
that's a topic for something else but

955
00:36:20,480 --> 00:36:23,280
we have likelihood and we need impact

956
00:36:23,280 --> 00:36:27,839
so in 2017 impact was by definition we

957
00:36:27,839 --> 00:36:30,079
used exploit

958
00:36:30,079 --> 00:36:32,560
we use detectability which is really

959
00:36:32,560 --> 00:36:34,480
kind of likelihood and then we used

960
00:36:34,480 --> 00:36:36,800
impact but we use technical impact not

961
00:36:36,800 --> 00:36:38,320
business impact because we can't really

962
00:36:38,320 --> 00:36:40,400
tell you business impact on like a

963
00:36:40,400 --> 00:36:42,960
generic high level scale

964
00:36:42,960 --> 00:36:45,839
the data source for exploit and impact

965
00:36:45,839 --> 00:36:47,920
and detectability in 2017 was

966
00:36:47,920 --> 00:36:50,240
essentially the leadership team

967
00:36:50,240 --> 00:36:52,720
we got together and we had about a four

968
00:36:52,720 --> 00:36:54,640
or six hour meeting where we argued with

969
00:36:54,640 --> 00:36:57,200
each other on average

970
00:36:57,200 --> 00:36:58,160
how

971
00:36:58,160 --> 00:37:00,560
hard is it to exploit your average sql

972
00:37:00,560 --> 00:37:03,200
injection how hard is it to on average

973
00:37:03,200 --> 00:37:05,359
to exploit cross-site scripting

974
00:37:05,359 --> 00:37:06,880
what's the average impact for each of

975
00:37:06,880 --> 00:37:08,800
these and so they were rated on low

976
00:37:08,800 --> 00:37:11,359
medium high for these different things

977
00:37:11,359 --> 00:37:14,160
so 2021 we had so much data for

978
00:37:14,160 --> 00:37:16,240
likelihood we really really wanted to be

979
00:37:16,240 --> 00:37:18,720
able to do it for exploit or for impact

980
00:37:18,720 --> 00:37:19,760
as well

981
00:37:19,760 --> 00:37:23,440
so what we did is we decided we looked

982
00:37:23,440 --> 00:37:25,440
around at what was available because

983
00:37:25,440 --> 00:37:28,720
this isn't data that we could really get

984
00:37:28,720 --> 00:37:30,560
in terms of a data call it wasn't in the

985
00:37:30,560 --> 00:37:32,960
data call we didn't know how these

986
00:37:32,960 --> 00:37:35,440
different things were ranked or scored

987
00:37:35,440 --> 00:37:36,960
so we looked through and we said all

988
00:37:36,960 --> 00:37:39,119
right something that does exist is we

989
00:37:39,119 --> 00:37:42,079
can look at cvss sub scores for exploit

990
00:37:42,079 --> 00:37:45,040
and impact not the overall cvss score

991
00:37:45,040 --> 00:37:47,599
but the specific sub scores for exploit

992
00:37:47,599 --> 00:37:49,680
and impact

993
00:37:49,680 --> 00:37:51,760
so what we did is we actually went to

994
00:37:51,760 --> 00:37:54,560
oauth dependency check and we said and

995
00:37:54,560 --> 00:37:56,000
we because

996
00:37:56,000 --> 00:37:58,240
we knew that it went and pulled all of

997
00:37:58,240 --> 00:38:00,000
the data from nvd

998
00:38:00,000 --> 00:38:02,240
and it stored it all in a nice little h2

999
00:38:02,240 --> 00:38:03,359
database

1000
00:38:03,359 --> 00:38:06,160
and so we set up dependency check pulled

1001
00:38:06,160 --> 00:38:08,320
down all the data

1002
00:38:08,320 --> 00:38:10,240
queried the tables within it and pulled

1003
00:38:10,240 --> 00:38:13,280
out all the data related to cwe's

1004
00:38:13,280 --> 00:38:15,359
anywhere cve

1005
00:38:15,359 --> 00:38:17,359
was mapped to cwe

1006
00:38:17,359 --> 00:38:20,400
and so we found of our nearly 400 cwes

1007
00:38:20,400 --> 00:38:23,359
we found that 241 of them

1008
00:38:23,359 --> 00:38:26,160
had cve data mapped to them

1009
00:38:26,160 --> 00:38:29,200
so not all of the cwes that we have have

1010
00:38:29,200 --> 00:38:31,359
cvss sub scores that we can actually

1011
00:38:31,359 --> 00:38:32,400
leverage

1012
00:38:32,400 --> 00:38:34,000
one of those examples like i mentioned

1013
00:38:34,000 --> 00:38:35,680
is vulnerable components because

1014
00:38:35,680 --> 00:38:37,760
vulnerable components basically will

1015
00:38:37,760 --> 00:38:40,400
never have a cd cve

1016
00:38:40,400 --> 00:38:42,720
mapped to the cwe for vulnerable

1017
00:38:42,720 --> 00:38:44,800
components because the cve would

1018
00:38:44,800 --> 00:38:47,040
actually be mapped to the cwe that was

1019
00:38:47,040 --> 00:38:49,839
the root cause of the problem

1020
00:38:49,839 --> 00:38:51,920
so some of those we just had to

1021
00:38:51,920 --> 00:38:54,320
essentially put in average so we said

1022
00:38:54,320 --> 00:38:56,800
hey exploit and impact will be five on

1023
00:38:56,800 --> 00:38:59,920
average because it's not zero and it's

1024
00:38:59,920 --> 00:39:01,200
not 10.

1025
00:39:01,200 --> 00:39:03,359
so i could pick anything in between but

1026
00:39:03,359 --> 00:39:05,200
we decided just to pick the simple

1027
00:39:05,200 --> 00:39:07,280
middle ground

1028
00:39:07,280 --> 00:39:11,920
when we look at the top 10 cwes mapped

1029
00:39:12,000 --> 00:39:14,640
this the largest individual cwe is

1030
00:39:14,640 --> 00:39:17,839
actually cwe 79 which is our good friend

1031
00:39:17,839 --> 00:39:19,440
cross-site scripting

1032
00:39:19,440 --> 00:39:21,440
um

1033
00:39:21,440 --> 00:39:24,160
which again has a high frequency but the

1034
00:39:24,160 --> 00:39:25,839
interesting thing is

1035
00:39:25,839 --> 00:39:26,839
um

1036
00:39:26,839 --> 00:39:30,560
175 000 of the cves that we had in that

1037
00:39:30,560 --> 00:39:32,640
data 35

1038
00:39:32,640 --> 00:39:36,400
125 000 were mapped to cwes and 35 000

1039
00:39:36,400 --> 00:39:38,880
were unknown whenever they were created

1040
00:39:38,880 --> 00:39:42,640
somebody didn't map them to a cwe

1041
00:39:42,640 --> 00:39:45,839
only 20 cwes in that data had more than

1042
00:39:45,839 --> 00:39:48,400
a thousand cves assigned to them and

1043
00:39:48,400 --> 00:39:51,680
only 70 cwes had more than 100 cves

1044
00:39:51,680 --> 00:39:53,839
assigned to them

1045
00:39:53,839 --> 00:39:57,040
65 of the cwes only had one or two cves

1046
00:39:57,040 --> 00:39:59,760
ever actually assigned to them

1047
00:39:59,760 --> 00:40:02,079
so this data was from

1048
00:40:02,079 --> 00:40:04,720
august of this year so it's changed a

1049
00:40:04,720 --> 00:40:06,720
little bit since then because right now

1050
00:40:06,720 --> 00:40:09,040
we have essentially the largest creation

1051
00:40:09,040 --> 00:40:12,640
of cves that we've seen yet

1052
00:40:12,640 --> 00:40:14,880
but we also had to look at

1053
00:40:14,880 --> 00:40:18,240
in cvss scoring so the data we had was

1054
00:40:18,240 --> 00:40:20,560
almost evenly split

1055
00:40:20,560 --> 00:40:24,640
in out of nvd of cvss v2 versus v3

1056
00:40:24,640 --> 00:40:25,760
scoring

1057
00:40:25,760 --> 00:40:27,599
and if you look at the two they don't

1058
00:40:27,599 --> 00:40:30,800
actually line up with each other so cvss

1059
00:40:30,800 --> 00:40:34,400
v2 sub scores for impact would range

1060
00:40:34,400 --> 00:40:37,280
from essentially three to ten

1061
00:40:37,280 --> 00:40:39,520
but if you looked at version 3 scores it

1062
00:40:39,520 --> 00:40:45,359
would range from about 1.2 1.3 to 6.

1063
00:40:45,359 --> 00:40:47,839
and the reason for this was

1064
00:40:47,839 --> 00:40:50,240
they changed the formula on how they

1065
00:40:50,240 --> 00:40:52,560
actually built the cvss score between

1066
00:40:52,560 --> 00:40:54,480
version 2 and version 3.

1067
00:40:54,480 --> 00:40:57,520
in version 2 impact and exploit could

1068
00:40:57,520 --> 00:41:00,720
technically or theoretically be 0 to 10.

1069
00:41:00,720 --> 00:41:02,240
then they would take

1070
00:41:02,240 --> 00:41:05,599
40 and 60 of those knock them down by

1071
00:41:05,599 --> 00:41:08,800
0.4 or 0.6 and then they would

1072
00:41:08,800 --> 00:41:10,960
to get their total together

1073
00:41:10,960 --> 00:41:13,680
so in version 3 they actually

1074
00:41:13,680 --> 00:41:16,319
artificially limited them so impact

1075
00:41:16,319 --> 00:41:18,000
could only actually

1076
00:41:18,000 --> 00:41:20,960
max out at from zero to six

1077
00:41:20,960 --> 00:41:22,000
and

1078
00:41:22,000 --> 00:41:25,200
exploit could actually do zero to four

1079
00:41:25,200 --> 00:41:27,200
so basically i had to look at those and

1080
00:41:27,200 --> 00:41:29,520
essentially normalize them so that they

1081
00:41:29,520 --> 00:41:31,839
would fit along a similar scale so i

1082
00:41:31,839 --> 00:41:33,520
could see that

1083
00:41:33,520 --> 00:41:35,520
however what made it interesting is even

1084
00:41:35,520 --> 00:41:38,960
after normalization the way the other

1085
00:41:38,960 --> 00:41:41,040
changes in terms of the process of how

1086
00:41:41,040 --> 00:41:42,800
you score something

1087
00:41:42,800 --> 00:41:46,960
on average in version 3 of cvss

1088
00:41:46,960 --> 00:41:48,800
impact scores

1089
00:41:48,800 --> 00:41:50,400
average

1090
00:41:50,400 --> 00:41:54,240
point and a half 1.3 points or so higher

1091
00:41:54,240 --> 00:41:57,760
on average for cwes

1092
00:41:57,760 --> 00:41:59,520
something similar in exploit so in

1093
00:41:59,520 --> 00:42:02,400
exploit you have a range typically in

1094
00:42:02,400 --> 00:42:04,160
version two of somewhere around four to

1095
00:42:04,160 --> 00:42:05,280
ten

1096
00:42:05,280 --> 00:42:07,359
in terms of the scores in version three

1097
00:42:07,359 --> 00:42:09,520
your score range is essentially one to

1098
00:42:09,520 --> 00:42:10,960
four

1099
00:42:10,960 --> 00:42:12,240
this one's a little bit more of a

1100
00:42:12,240 --> 00:42:14,400
dramatic difference location

1101
00:42:14,400 --> 00:42:16,800
but it's the same reason um just because

1102
00:42:16,800 --> 00:42:18,480
the way they changed how they scored and

1103
00:42:18,480 --> 00:42:20,400
what range was possible within the sub

1104
00:42:20,400 --> 00:42:21,680
scores

1105
00:42:21,680 --> 00:42:23,520
if you look at these though within

1106
00:42:23,520 --> 00:42:25,760
exploit deltas

1107
00:42:25,760 --> 00:42:28,880
version three on average was almost half

1108
00:42:28,880 --> 00:42:31,920
a point lower for cwes

1109
00:42:31,920 --> 00:42:33,200
also part of the reason why your

1110
00:42:33,200 --> 00:42:35,119
amplitude changes from left to right on

1111
00:42:35,119 --> 00:42:37,839
these is these are ordered left to right

1112
00:42:37,839 --> 00:42:39,680
in terms of the highest frequency to the

1113
00:42:39,680 --> 00:42:41,440
lowest frequency so when you get down to

1114
00:42:41,440 --> 00:42:43,440
a really small frequency you have much

1115
00:42:43,440 --> 00:42:47,119
higher deltas between them

1116
00:42:47,200 --> 00:42:50,720
so we have our data porridge per se so

1117
00:42:50,720 --> 00:42:52,560
we now have incidence rate and testing

1118
00:42:52,560 --> 00:42:54,800
coverage for likelihood we have exploit

1119
00:42:54,800 --> 00:42:57,760
and impact the sub scores for cvss that

1120
00:42:57,760 --> 00:43:00,400
count for impact but we also decided

1121
00:43:00,400 --> 00:43:02,160
essentially to season it with a little

1122
00:43:02,160 --> 00:43:04,640
bit of total occurrences so there was

1123
00:43:04,640 --> 00:43:06,880
some weight for actually the number of

1124
00:43:06,880 --> 00:43:09,040
times you would find a particular type

1125
00:43:09,040 --> 00:43:11,440
of cwe

1126
00:43:11,440 --> 00:43:14,960
so then we would average these together

1127
00:43:14,960 --> 00:43:16,960
and then we went back and forth so when

1128
00:43:16,960 --> 00:43:18,400
we started

1129
00:43:18,400 --> 00:43:21,280
trying to put cwe's into categories we

1130
00:43:21,280 --> 00:43:23,040
actually spent about three months

1131
00:43:23,040 --> 00:43:24,839
working on it

1132
00:43:24,839 --> 00:43:28,800
because cwes don't cleanly go into some

1133
00:43:28,800 --> 00:43:30,720
of these categories depending on the day

1134
00:43:30,720 --> 00:43:32,880
depending on what you're looking at

1135
00:43:32,880 --> 00:43:35,760
sometimes it makes more sense to go into

1136
00:43:35,760 --> 00:43:38,400
one category or another

1137
00:43:38,400 --> 00:43:40,319
we move things around between different

1138
00:43:40,319 --> 00:43:42,240
categories just trying to figure out

1139
00:43:42,240 --> 00:43:44,960
what made the most sense and reading

1140
00:43:44,960 --> 00:43:46,560
through i read through the detailed

1141
00:43:46,560 --> 00:43:50,720
description of 400 cwes trying to figure

1142
00:43:50,720 --> 00:43:53,440
out like what was the root cause of the

1143
00:43:53,440 --> 00:43:56,720
cwe what was it going after what type of

1144
00:43:56,720 --> 00:44:00,160
cwe was it when we grouped it

1145
00:44:00,160 --> 00:44:03,200
so we ended up with basically this type

1146
00:44:03,200 --> 00:44:05,680
of formula so we had

1147
00:44:05,680 --> 00:44:08,079
different types

1148
00:44:08,079 --> 00:44:09,839
we had our different categories and then

1149
00:44:09,839 --> 00:44:11,599
we said we had our incidence rate

1150
00:44:11,599 --> 00:44:12,720
coverage

1151
00:44:12,720 --> 00:44:14,800
exploit impact number of occurrences and

1152
00:44:14,800 --> 00:44:16,640
then a total score

1153
00:44:16,640 --> 00:44:19,359
so what we decided to do is not pick

1154
00:44:19,359 --> 00:44:21,839
average but pick high water mark for

1155
00:44:21,839 --> 00:44:23,920
cwes within

1156
00:44:23,920 --> 00:44:26,400
um four incidence level

1157
00:44:26,400 --> 00:44:29,200
because i have an issue with averages

1158
00:44:29,200 --> 00:44:31,280
have a tendency to hide

1159
00:44:31,280 --> 00:44:33,119
um the edges

1160
00:44:33,119 --> 00:44:36,400
they they hide different

1161
00:44:36,400 --> 00:44:39,119
impactful levels for

1162
00:44:39,119 --> 00:44:41,440
high and low below above and below

1163
00:44:41,440 --> 00:44:42,480
average

1164
00:44:42,480 --> 00:44:44,480
so the industry essentially has pretty

1165
00:44:44,480 --> 00:44:46,480
much a precedence for using high water

1166
00:44:46,480 --> 00:44:48,160
mark like if you look at nist data

1167
00:44:48,160 --> 00:44:50,000
categorization it's the high water mark

1168
00:44:50,000 --> 00:44:51,680
of data

1169
00:44:51,680 --> 00:44:53,040
so there's a lot of other things so we

1170
00:44:53,040 --> 00:44:54,640
looked at a number of scenarios we

1171
00:44:54,640 --> 00:44:56,240
looked at what happens if we do average

1172
00:44:56,240 --> 00:44:57,839
we looked at what happens if we do high

1173
00:44:57,839 --> 00:44:59,280
water mark

1174
00:44:59,280 --> 00:45:00,960
and we decided that high water mark

1175
00:45:00,960 --> 00:45:03,040
represented it better it was more

1176
00:45:03,040 --> 00:45:05,040
accurate more defensible from our

1177
00:45:05,040 --> 00:45:07,040
perspective

1178
00:45:07,040 --> 00:45:08,480
and then i also broke it down a little

1179
00:45:08,480 --> 00:45:11,440
bit for like contra contributors or

1180
00:45:11,440 --> 00:45:13,920
contributions so what percentage of your

1181
00:45:13,920 --> 00:45:15,440
overall score

1182
00:45:15,440 --> 00:45:17,200
did the different elements within the

1183
00:45:17,200 --> 00:45:18,960
formula contribute because i just wanted

1184
00:45:18,960 --> 00:45:20,720
to see within these categories where

1185
00:45:20,720 --> 00:45:22,480
were they getting their points from like

1186
00:45:22,480 --> 00:45:25,760
what was contributing to it

1187
00:45:25,920 --> 00:45:28,000
so now that we've built everything and

1188
00:45:28,000 --> 00:45:30,240
we pushed it out like where do we go

1189
00:45:30,240 --> 00:45:33,119
from here so the top 10 2021 was

1190
00:45:33,119 --> 00:45:34,560
released on

1191
00:45:34,560 --> 00:45:37,200
september 24th to coincide with the 20th

1192
00:45:37,200 --> 00:45:38,640
anniversary

1193
00:45:38,640 --> 00:45:40,640
so what do we do now

1194
00:45:40,640 --> 00:45:41,599
like

1195
00:45:41,599 --> 00:45:43,839
what what's next

1196
00:45:43,839 --> 00:45:45,920
so from my perspective we need to get

1197
00:45:45,920 --> 00:45:48,720
more consistent with cwes

1198
00:45:48,720 --> 00:45:50,880
we actually have a number of cwes that

1199
00:45:50,880 --> 00:45:52,240
were contributed that were actually

1200
00:45:52,240 --> 00:45:54,560
marked as retired or archived

1201
00:45:54,560 --> 00:45:56,960
and mitre was had mentions in there it

1202
00:45:56,960 --> 00:45:59,200
says please don't use these these are no

1203
00:45:59,200 --> 00:46:02,000
longer active they've been deemed either

1204
00:46:02,000 --> 00:46:04,640
incorrect or superseded by something

1205
00:46:04,640 --> 00:46:08,480
else but yet we still map stuff to them

1206
00:46:08,480 --> 00:46:10,640
we also have within cwe's there's a

1207
00:46:10,640 --> 00:46:13,040
hierarchy so there are some cwes that

1208
00:46:13,040 --> 00:46:15,040
are essentially categories

1209
00:46:15,040 --> 00:46:17,359
and they have multiple layers within a

1210
00:46:17,359 --> 00:46:19,760
tree down

1211
00:46:19,760 --> 00:46:21,680
four different types of category for

1212
00:46:21,680 --> 00:46:23,520
different types of cwes so that you

1213
00:46:23,520 --> 00:46:24,880
essentially have parent and child

1214
00:46:24,880 --> 00:46:27,440
relationships

1215
00:46:27,440 --> 00:46:30,240
um so try not to map to the highest

1216
00:46:30,240 --> 00:46:32,880
level because that kind of obscures what

1217
00:46:32,880 --> 00:46:35,280
is actually going on try to find the

1218
00:46:35,280 --> 00:46:38,000
most detailed and most descriptive cwe

1219
00:46:38,000 --> 00:46:40,000
to try and just match up to the

1220
00:46:40,000 --> 00:46:42,640
vulnerabilities that you find

1221
00:46:42,640 --> 00:46:45,040
also try to use root cause cwes as much

1222
00:46:45,040 --> 00:46:47,520
as possible because root cause is super

1223
00:46:47,520 --> 00:46:50,319
important to where we can understand

1224
00:46:50,319 --> 00:46:52,160
how do we fix this

1225
00:46:52,160 --> 00:46:54,319
symptoms don't help us understand how to

1226
00:46:54,319 --> 00:46:57,680
fix things root causes do

1227
00:46:57,680 --> 00:46:59,280
some of the behavior we're trying to

1228
00:46:59,280 --> 00:47:01,280
drive too is fix this at the language

1229
00:47:01,280 --> 00:47:03,839
and framework level

1230
00:47:03,839 --> 00:47:06,400
back in 2007

1231
00:47:06,400 --> 00:47:08,000
andrew vander stuckle took the story

1232
00:47:08,000 --> 00:47:10,079
about how he added crosstalk cross-site

1233
00:47:10,079 --> 00:47:11,920
request forgery into the top 10 list

1234
00:47:11,920 --> 00:47:13,680
because essentially at the time almost

1235
00:47:13,680 --> 00:47:15,520
100 percent of web applications were

1236
00:47:15,520 --> 00:47:18,000
susceptible to crossout request forgery

1237
00:47:18,000 --> 00:47:20,960
now that number is in the single digits

1238
00:47:20,960 --> 00:47:23,440
like the data we see is less than 10 of

1239
00:47:23,440 --> 00:47:24,880
applications are susceptible to

1240
00:47:24,880 --> 00:47:26,559
cross-site request forgery which is

1241
00:47:26,559 --> 00:47:28,000
awesome

1242
00:47:28,000 --> 00:47:30,079
so that took i mean it's been 14 years i

1243
00:47:30,079 --> 00:47:32,400
hope so but you could also argue we've

1244
00:47:32,400 --> 00:47:35,200
known how to fix sql injection for over

1245
00:47:35,200 --> 00:47:37,119
a decade and we still have it it is

1246
00:47:37,119 --> 00:47:38,480
still one of the most

1247
00:47:38,480 --> 00:47:41,920
larger reasons for data breaches

1248
00:47:41,920 --> 00:47:44,000
but the thing is is we can't expect

1249
00:47:44,000 --> 00:47:46,240
developers to remember all of these tiny

1250
00:47:46,240 --> 00:47:48,000
nitty gritty details

1251
00:47:48,000 --> 00:47:49,680
we've got to fix these things at the

1252
00:47:49,680 --> 00:47:51,520
language and framework level we have to

1253
00:47:51,520 --> 00:47:53,599
do as much as we can for developers so

1254
00:47:53,599 --> 00:47:55,920
that by default they can write secure

1255
00:47:55,920 --> 00:47:58,240
code they have to go out of their way to

1256
00:47:58,240 --> 00:48:00,880
break things

1257
00:48:00,880 --> 00:48:03,200
don't shift left

1258
00:48:03,200 --> 00:48:05,839
expand like move left we use language

1259
00:48:05,839 --> 00:48:07,599
move left instead of shift left because

1260
00:48:07,599 --> 00:48:09,119
what happens in the industry is the

1261
00:48:09,119 --> 00:48:10,880
majority of the time we use the term

1262
00:48:10,880 --> 00:48:13,599
shift left we don't actually mean going

1263
00:48:13,599 --> 00:48:16,400
before code we just mean earlier in the

1264
00:48:16,400 --> 00:48:18,960
code phase earlier in the code phase

1265
00:48:18,960 --> 00:48:20,400
when in reality

1266
00:48:20,400 --> 00:48:22,000
security needs to exist at the

1267
00:48:22,000 --> 00:48:24,160
operational level and security has to

1268
00:48:24,160 --> 00:48:27,119
exist before you ever write code

1269
00:48:27,119 --> 00:48:29,280
when you write user stories when you do

1270
00:48:29,280 --> 00:48:31,119
threat modeling when you do design

1271
00:48:31,119 --> 00:48:33,760
analysis design review you need to

1272
00:48:33,760 --> 00:48:36,480
figure out security needs to be part of

1273
00:48:36,480 --> 00:48:39,680
that mindset and that concept at that

1274
00:48:39,680 --> 00:48:41,760
stage before you ever write a line of

1275
00:48:41,760 --> 00:48:43,839
code

1276
00:48:43,839 --> 00:48:45,119
and that's where the second bullet also

1277
00:48:45,119 --> 00:48:46,640
fits in there's a lot of security

1278
00:48:46,640 --> 00:48:48,720
outside of code we have to stop being

1279
00:48:48,720 --> 00:48:50,880
fixated on purely code and i get it

1280
00:48:50,880 --> 00:48:52,800
because at the code level it's machine

1281
00:48:52,800 --> 00:48:53,839
readable

1282
00:48:53,839 --> 00:48:56,079
before you create code it's really hard

1283
00:48:56,079 --> 00:48:58,400
to do any kind of automation hard to do

1284
00:48:58,400 --> 00:49:01,119
scale because it is still in the squishy

1285
00:49:01,119 --> 00:49:03,280
human phase where it's more of an art

1286
00:49:03,280 --> 00:49:05,359
than a science

1287
00:49:05,359 --> 00:49:07,839
but the hope is is things like insecure

1288
00:49:07,839 --> 00:49:08,880
design

1289
00:49:08,880 --> 00:49:10,800
drives a renaissance into threat

1290
00:49:10,800 --> 00:49:12,880
modeling and i'm watching it start to

1291
00:49:12,880 --> 00:49:14,640
come up and occur and more and more

1292
00:49:14,640 --> 00:49:16,079
people are like this makes a lot of

1293
00:49:16,079 --> 00:49:18,559
sense we need to focus in this area and

1294
00:49:18,559 --> 00:49:21,119
i'm hoping in three or four years we see

1295
00:49:21,119 --> 00:49:23,359
a big change and a big growth in the

1296
00:49:23,359 --> 00:49:25,280
threat modeling space because we have a

1297
00:49:25,280 --> 00:49:27,839
lot of work to do there

1298
00:49:27,839 --> 00:49:28,800
but

1299
00:49:28,800 --> 00:49:32,000
that's what i have that's my time

1300
00:49:32,000 --> 00:49:34,960
so thank you so much if you all have any

1301
00:49:34,960 --> 00:49:38,559
questions please let me know

