1
00:00:00,160 --> 00:00:03,120
hello everyone my name is sabi

2
00:00:03,120 --> 00:00:05,120
i work as a security consultant for

3
00:00:05,120 --> 00:00:08,080
secretary compass san francisco

4
00:00:08,080 --> 00:00:10,800
today i'm here to talk about a special

5
00:00:10,800 --> 00:00:12,480
kind of race conditions in web

6
00:00:12,480 --> 00:00:13,759
applications

7
00:00:13,759 --> 00:00:14,799
called

8
00:00:14,799 --> 00:00:17,600
time of check to time of use often known

9
00:00:17,600 --> 00:00:19,199
as talk to

10
00:00:19,199 --> 00:00:21,600
i will also be introducing an open

11
00:00:21,600 --> 00:00:23,199
source project

12
00:00:23,199 --> 00:00:24,080
called

13
00:00:24,080 --> 00:00:26,960
ova's time gap theory

14
00:00:26,960 --> 00:00:29,359
let us look at the plan first

15
00:00:29,359 --> 00:00:32,079
i'll give you the story behind a vast

16
00:00:32,079 --> 00:00:33,600
time gap theory

17
00:00:33,600 --> 00:00:36,480
i'll also introduce a vast time gap

18
00:00:36,480 --> 00:00:40,079
theory it is a capture the flag style

19
00:00:40,079 --> 00:00:43,040
intentionally vulnerable application

20
00:00:43,040 --> 00:00:44,559
i'll walk you through some of the

21
00:00:44,559 --> 00:00:45,920
challenges

22
00:00:45,920 --> 00:00:47,600
i'll

23
00:00:47,600 --> 00:00:50,079
tell some of the interesting stories

24
00:00:50,079 --> 00:00:52,399
related to talk to

25
00:00:52,399 --> 00:00:54,800
i'll give you links so that you can go

26
00:00:54,800 --> 00:00:56,800
back home and

27
00:00:56,800 --> 00:00:59,280
check all these things yourself by the

28
00:00:59,280 --> 00:01:01,600
time we complete this mini training

29
00:01:01,600 --> 00:01:02,960
session

30
00:01:02,960 --> 00:01:06,720
you will be a top 2 champion that i can

31
00:01:06,720 --> 00:01:08,080
promise

32
00:01:08,080 --> 00:01:10,479
let me tell you a story

33
00:01:10,479 --> 00:01:13,280
i work as an sme for third modeling

34
00:01:13,280 --> 00:01:14,960
sessions

35
00:01:14,960 --> 00:01:17,280
my day-to-day job involves sitting in

36
00:01:17,280 --> 00:01:19,520
that modeling sessions and telling

37
00:01:19,520 --> 00:01:22,000
people what to do

38
00:01:22,000 --> 00:01:25,680
once i was in such a session

39
00:01:25,680 --> 00:01:26,799
i

40
00:01:26,799 --> 00:01:28,799
looked at a particular design of the

41
00:01:28,799 --> 00:01:30,799
software and i was like

42
00:01:30,799 --> 00:01:33,439
looks like this is wonderful to talk to

43
00:01:33,439 --> 00:01:36,000
most of the people sitting in that room

44
00:01:36,000 --> 00:01:38,720
did not know about talk to so i had to

45
00:01:38,720 --> 00:01:40,880
explain imagine this

46
00:01:40,880 --> 00:01:43,280
you are going for a movie

47
00:01:43,280 --> 00:01:44,960
you wanted your

48
00:01:44,960 --> 00:01:48,560
favorite seat so you decided to book the

49
00:01:48,560 --> 00:01:51,200
ticket online

50
00:01:51,200 --> 00:01:53,040
you went to the website

51
00:01:53,040 --> 00:01:55,119
check the seat is available

52
00:01:55,119 --> 00:01:56,960
looks like you're lucky the seat is

53
00:01:56,960 --> 00:01:58,640
available

54
00:01:58,640 --> 00:02:00,880
you want to book the ticket and you have

55
00:02:00,880 --> 00:02:02,479
entered your credit card information and

56
00:02:02,479 --> 00:02:03,600
everything

57
00:02:03,600 --> 00:02:06,880
you clicked on the final book now button

58
00:02:06,880 --> 00:02:09,199
you are expecting a success match say

59
00:02:09,199 --> 00:02:12,239
saying that the seat is booked

60
00:02:12,239 --> 00:02:15,120
but you get an error message instead

61
00:02:15,120 --> 00:02:16,400
it says

62
00:02:16,400 --> 00:02:18,239
the seat is already taken

63
00:02:18,239 --> 00:02:21,760
there was a time gap between the moment

64
00:02:21,760 --> 00:02:23,520
you checked the availability of the

65
00:02:23,520 --> 00:02:24,640
ticket

66
00:02:24,640 --> 00:02:28,400
and you ended the final book now button

67
00:02:28,400 --> 00:02:29,840
you had to enter your credit card

68
00:02:29,840 --> 00:02:32,160
information other contact information

69
00:02:32,160 --> 00:02:35,680
etc within that time someone else booked

70
00:02:35,680 --> 00:02:38,319
that ticket these type of things happens

71
00:02:38,319 --> 00:02:39,680
all the time

72
00:02:39,680 --> 00:02:42,160
it can happen while you

73
00:02:42,160 --> 00:02:44,080
buy stuffs online

74
00:02:44,080 --> 00:02:46,800
when you try to book an airline ticket

75
00:02:46,800 --> 00:02:49,040
or when you try to

76
00:02:49,040 --> 00:02:53,120
purchase face masks thanks to covet 19.

77
00:02:53,120 --> 00:02:55,040
what if both of you click on the book

78
00:02:55,040 --> 00:02:59,519
now button together at the same time

79
00:02:59,519 --> 00:03:02,720
is the application going to prioritize

80
00:03:02,720 --> 00:03:06,000
one request over the other

81
00:03:06,000 --> 00:03:08,560
is the application going to cancel both

82
00:03:08,560 --> 00:03:10,879
of the requests

83
00:03:10,879 --> 00:03:13,280
is the application going to honor both

84
00:03:13,280 --> 00:03:14,720
of the requests

85
00:03:14,720 --> 00:03:19,120
if yes both of you will get same ticket

86
00:03:19,120 --> 00:03:22,640
for the same seat for the same show now

87
00:03:22,640 --> 00:03:25,519
back to my story most people in the room

88
00:03:25,519 --> 00:03:28,959
did not believe that this is possible

89
00:03:28,959 --> 00:03:31,360
many of them knew about talk to they

90
00:03:31,360 --> 00:03:32,720
said

91
00:03:32,720 --> 00:03:36,640
talk to attacks are very hard to exploit

92
00:03:36,640 --> 00:03:39,599
almost all database technologies have

93
00:03:39,599 --> 00:03:41,920
some sort of preventive mechanism

94
00:03:41,920 --> 00:03:44,159
against these type of attacks over the

95
00:03:44,159 --> 00:03:47,040
next few months i came across multiple

96
00:03:47,040 --> 00:03:49,120
such occasions

97
00:03:49,120 --> 00:03:52,239
i wanted to shout out to the world that

98
00:03:52,239 --> 00:03:55,120
talk to issues are real

99
00:03:55,120 --> 00:03:58,080
but how i asked myself in order to make

100
00:03:58,080 --> 00:04:01,439
it easy for people to understand about

101
00:04:01,439 --> 00:04:03,120
talk to issues

102
00:04:03,120 --> 00:04:06,159
i came up with this project called oasp

103
00:04:06,159 --> 00:04:08,400
time gap theory

104
00:04:08,400 --> 00:04:10,480
it is a catch of the flag style

105
00:04:10,480 --> 00:04:11,920
application

106
00:04:11,920 --> 00:04:14,640
it has seven challenges now

107
00:04:14,640 --> 00:04:16,079
it's free

108
00:04:16,079 --> 00:04:17,600
open source

109
00:04:17,600 --> 00:04:20,639
and yes it is dockerized

110
00:04:20,639 --> 00:04:23,360
you can also run it on hiroku if you

111
00:04:23,360 --> 00:04:24,800
want

112
00:04:24,800 --> 00:04:27,600
the home page of awas time gap theory

113
00:04:27,600 --> 00:04:30,080
looks like this

114
00:04:30,080 --> 00:04:33,120
the score page is where you can see all

115
00:04:33,120 --> 00:04:35,759
the progress

116
00:04:36,240 --> 00:04:39,120
the web app directory is where all the

117
00:04:39,120 --> 00:04:40,400
challenges are

118
00:04:40,400 --> 00:04:42,400
let us start with the first challenge

119
00:04:42,400 --> 00:04:44,560
which is the sign up page

120
00:04:44,560 --> 00:04:47,120
a high-level user flow for the sign-up

121
00:04:47,120 --> 00:04:49,919
page would look like this

122
00:04:49,919 --> 00:04:54,720
user enters their email id and password

123
00:04:54,720 --> 00:04:56,880
the application will check

124
00:04:56,880 --> 00:04:59,040
on the database to see

125
00:04:59,040 --> 00:05:01,840
if that email address or username

126
00:05:01,840 --> 00:05:04,720
already exists on the database or not

127
00:05:04,720 --> 00:05:07,520
if a match is not found the application

128
00:05:07,520 --> 00:05:12,080
will create a user account if a match is

129
00:05:12,080 --> 00:05:13,120
found

130
00:05:13,120 --> 00:05:15,440
then the application will throw an error

131
00:05:15,440 --> 00:05:17,759
message instead let us go to the sign up

132
00:05:17,759 --> 00:05:20,320
page and see this in action there are

133
00:05:20,320 --> 00:05:23,600
four buttons on top you can click on

134
00:05:23,600 --> 00:05:26,240
them to fill the form automatically this

135
00:05:26,240 --> 00:05:29,360
way you don't have to manually enter

136
00:05:29,360 --> 00:05:32,160
email address password and the username

137
00:05:32,160 --> 00:05:34,479
by yourself first click on the term

138
00:05:34,479 --> 00:05:36,000
button

139
00:05:36,000 --> 00:05:37,840
the application will fill the user

140
00:05:37,840 --> 00:05:39,600
details for tom

141
00:05:39,600 --> 00:05:41,520
click on the submit button it will

142
00:05:41,520 --> 00:05:44,639
create a user account for tom repeat the

143
00:05:44,639 --> 00:05:46,160
same steps

144
00:05:46,160 --> 00:05:48,400
and you can see that the application is

145
00:05:48,400 --> 00:05:51,039
not letting you create a second user

146
00:05:51,039 --> 00:05:53,840
account with the same details we need a

147
00:05:53,840 --> 00:05:56,720
way to speed up this request

148
00:05:56,720 --> 00:05:58,720
well either we need to speed up the

149
00:05:58,720 --> 00:05:59,919
request

150
00:05:59,919 --> 00:06:03,120
or make the application go slow

151
00:06:03,120 --> 00:06:05,840
that is where the bullet time feature

152
00:06:05,840 --> 00:06:08,639
can come handy

153
00:06:08,639 --> 00:06:10,560
go to the settings page

154
00:06:10,560 --> 00:06:13,600
and put a value like five seconds

155
00:06:13,600 --> 00:06:17,280
into the main weight field to make it

156
00:06:17,280 --> 00:06:19,120
easy to trigger

157
00:06:19,120 --> 00:06:22,560
two requests open two browsers side by

158
00:06:22,560 --> 00:06:24,880
side if you don't have two browsers you

159
00:06:24,880 --> 00:06:29,039
can use a normal window and a private or

160
00:06:29,039 --> 00:06:31,600
incognito window let's click on the

161
00:06:31,600 --> 00:06:34,000
jerry user button this time on both the

162
00:06:34,000 --> 00:06:37,520
browsers click on the submit button as

163
00:06:37,520 --> 00:06:41,120
fast as you can on both the process wait

164
00:06:41,120 --> 00:06:43,280
for the request to finish it will take

165
00:06:43,280 --> 00:06:45,919
slightly longer time for the browser to

166
00:06:45,919 --> 00:06:48,319
finish loading because of our bullet

167
00:06:48,319 --> 00:06:50,560
time feature it looks like both the

168
00:06:50,560 --> 00:06:53,120
requests are successful if you go to

169
00:06:53,120 --> 00:06:56,240
admin manage users you can see that

170
00:06:56,240 --> 00:06:58,800
there are two users with the same email

171
00:06:58,800 --> 00:07:01,120
address if you go to the score page you

172
00:07:01,120 --> 00:07:03,360
can see that you have gained

173
00:07:03,360 --> 00:07:06,800
100 points for solving the first

174
00:07:06,800 --> 00:07:09,599
challenge all these looks good in theory

175
00:07:09,599 --> 00:07:12,880
but in real life you can't expect

176
00:07:12,880 --> 00:07:16,160
somebody to slow down their server so

177
00:07:16,160 --> 00:07:18,639
that you can exploit talk to issues

178
00:07:18,639 --> 00:07:21,280
there you can wait for the peak traffic

179
00:07:21,280 --> 00:07:22,400
period

180
00:07:22,400 --> 00:07:23,280
or

181
00:07:23,280 --> 00:07:25,280
launch a ddos attack against the

182
00:07:25,280 --> 00:07:27,039
application to

183
00:07:27,039 --> 00:07:29,280
achieve a similar effect

184
00:07:29,280 --> 00:07:31,919
but we need something better let us see

185
00:07:31,919 --> 00:07:34,639
a different way to exploit talk to

186
00:07:34,639 --> 00:07:37,280
issues go to the sign up page

187
00:07:37,280 --> 00:07:39,759
then fill in the user details for any of

188
00:07:39,759 --> 00:07:42,560
the user open browser dev tools and

189
00:07:42,560 --> 00:07:45,599
submit the form go to the network tab of

190
00:07:45,599 --> 00:07:48,639
the browser dev tools then look for a

191
00:07:48,639 --> 00:07:50,560
post request to sign

192
00:07:50,560 --> 00:07:53,520
hyphen up dot php page right click on

193
00:07:53,520 --> 00:07:57,440
that request and copy that request as a

194
00:07:57,440 --> 00:08:00,160
fetch request go to the console tab of

195
00:08:00,160 --> 00:08:03,039
the browser dev tools and paste that

196
00:08:03,039 --> 00:08:05,919
particular request we need to modify the

197
00:08:05,919 --> 00:08:08,639
parameters a little so let's change all

198
00:08:08,639 --> 00:08:11,280
of them to devtools this is just one

199
00:08:11,280 --> 00:08:14,319
request we need multiple requests for

200
00:08:14,319 --> 00:08:15,360
that

201
00:08:15,360 --> 00:08:17,680
copy paste the same request multiple

202
00:08:17,680 --> 00:08:18,639
times

203
00:08:18,639 --> 00:08:21,840
all separated by a comma press the enter

204
00:08:21,840 --> 00:08:24,400
key once you have completed it go to

205
00:08:24,400 --> 00:08:27,440
admin manage users and you can see that

206
00:08:27,440 --> 00:08:29,919
your attempt is successful you have two

207
00:08:29,919 --> 00:08:32,000
more accounts with the same email

208
00:08:32,000 --> 00:08:34,080
address what is the use of such an

209
00:08:34,080 --> 00:08:37,519
attack why should an attacker or a user

210
00:08:37,519 --> 00:08:40,080
bother about creating two user accounts

211
00:08:40,080 --> 00:08:42,000
with the same email address on the

212
00:08:42,000 --> 00:08:44,320
system the motives can be many maybe

213
00:08:44,320 --> 00:08:46,480
they want to fool the audit trail an

214
00:08:46,480 --> 00:08:49,200
attacker may also try to sign up for

215
00:08:49,200 --> 00:08:51,440
multiple accounts with the same email

216
00:08:51,440 --> 00:08:53,279
address an email address belonging to a

217
00:08:53,279 --> 00:08:55,279
legitimate user

218
00:08:55,279 --> 00:08:56,720
if the user

219
00:08:56,720 --> 00:08:58,640
clicks on the verification link any of

220
00:08:58,640 --> 00:09:00,640
the verification link and completes the

221
00:09:00,640 --> 00:09:02,080
signup process

222
00:09:02,080 --> 00:09:04,959
maybe the attacker will get a permanent

223
00:09:04,959 --> 00:09:07,760
backdoor to that particular account just

224
00:09:07,760 --> 00:09:10,640
by designing this challenge i

225
00:09:10,640 --> 00:09:14,080
proved four points one top two issues

226
00:09:14,080 --> 00:09:15,519
are real two

227
00:09:15,519 --> 00:09:19,040
not all databases can prevent these type

228
00:09:19,040 --> 00:09:21,920
of issues by default you need to

229
00:09:21,920 --> 00:09:24,399
carefully design the application to

230
00:09:24,399 --> 00:09:25,600
prevent

231
00:09:25,600 --> 00:09:28,760
talk to attacks three you don't need

232
00:09:28,760 --> 00:09:31,279
sophisticated tools to perform talk to

233
00:09:31,279 --> 00:09:33,519
attacks just a modern browser with their

234
00:09:33,519 --> 00:09:35,839
tools is more than enough to perform

235
00:09:35,839 --> 00:09:38,640
basic talk to attacks for talk to

236
00:09:38,640 --> 00:09:41,200
attacks are not just about money

237
00:09:41,200 --> 00:09:44,000
transfer pages it can affect other pages

238
00:09:44,000 --> 00:09:46,880
as well if you go online now and search

239
00:09:46,880 --> 00:09:49,680
for talk to issues race conditions in

240
00:09:49,680 --> 00:09:52,480
web applications or concurrency issues

241
00:09:52,480 --> 00:09:54,560
you'll see tons of articles talking

242
00:09:54,560 --> 00:09:57,839
about different steps and out of them

243
00:09:57,839 --> 00:09:59,839
alliance share would be talking about

244
00:09:59,839 --> 00:10:02,480
money transfer pages so here i am

245
00:10:02,480 --> 00:10:04,880
proving a point that

246
00:10:04,880 --> 00:10:07,120
top two issues can affect

247
00:10:07,120 --> 00:10:10,800
other pages as well now back to my story

248
00:10:10,800 --> 00:10:12,560
after designing the first challenge i

249
00:10:12,560 --> 00:10:15,440
asked myself have i done a good job what

250
00:10:15,440 --> 00:10:18,240
if in future people say hey talk to

251
00:10:18,240 --> 00:10:19,600
issues are real

252
00:10:19,600 --> 00:10:23,680
it can affect money transfer pages and

253
00:10:23,680 --> 00:10:25,839
sign up pages but nothing else i don't

254
00:10:25,839 --> 00:10:28,800
want that that's why we have the second

255
00:10:28,800 --> 00:10:30,000
challenge

256
00:10:30,000 --> 00:10:34,079
called login page login pages are simple

257
00:10:34,079 --> 00:10:36,880
you enter your username and password or

258
00:10:36,880 --> 00:10:39,120
email address and password

259
00:10:39,120 --> 00:10:41,839
submit the form the application will

260
00:10:41,839 --> 00:10:44,560
match whatever you have ended

261
00:10:44,560 --> 00:10:46,800
with what they have on the database if a

262
00:10:46,800 --> 00:10:48,160
match is found

263
00:10:48,160 --> 00:10:49,920
it will create a session if a match is

264
00:10:49,920 --> 00:10:52,399
not found it will throw an error message

265
00:10:52,399 --> 00:10:54,079
instead in addition to the typical

266
00:10:54,079 --> 00:10:57,360
design our login page has

267
00:10:57,360 --> 00:11:01,040
one more additional feature every time a

268
00:11:01,040 --> 00:11:03,839
user enters a wrong password the

269
00:11:03,839 --> 00:11:05,760
application will start

270
00:11:05,760 --> 00:11:08,800
counting the failed attempts towards

271
00:11:08,800 --> 00:11:11,760
that particular email address

272
00:11:11,760 --> 00:11:15,040
once the failed attempt count

273
00:11:15,040 --> 00:11:17,440
has reached a particular threshold the

274
00:11:17,440 --> 00:11:20,640
application will log down that account

275
00:11:20,640 --> 00:11:22,800
this is a plain and simple technique to

276
00:11:22,800 --> 00:11:25,040
prevent brute force attacks let us check

277
00:11:25,040 --> 00:11:28,399
this behavior by going to the login page

278
00:11:28,399 --> 00:11:31,279
click on the user button tom and change

279
00:11:31,279 --> 00:11:33,600
the password a little and

280
00:11:33,600 --> 00:11:36,000
press the submit button keep doing that

281
00:11:36,000 --> 00:11:37,920
few times and you'll see an error

282
00:11:37,920 --> 00:11:39,760
message saying that the user account is

283
00:11:39,760 --> 00:11:41,200
locked out

284
00:11:41,200 --> 00:11:43,519
now click on the term button

285
00:11:43,519 --> 00:11:45,600
and submit the form again and you'll see

286
00:11:45,600 --> 00:11:48,640
that even if you supply the correct

287
00:11:48,640 --> 00:11:52,079
credit shells the app won't let you in

288
00:11:52,079 --> 00:11:55,120
since the account is locked out now that

289
00:11:55,120 --> 00:11:57,200
tom's account is locked out

290
00:11:57,200 --> 00:11:59,920
let us see if we can find the password

291
00:11:59,920 --> 00:12:02,639
of the user jury

292
00:12:02,639 --> 00:12:05,200
by performing a brute force attack open

293
00:12:05,200 --> 00:12:07,200
up browser dev tools

294
00:12:07,200 --> 00:12:11,040
go to the network tab and copy a request

295
00:12:11,040 --> 00:12:13,519
that is going to the login page and copy

296
00:12:13,519 --> 00:12:16,000
that request as fetch open up browser

297
00:12:16,000 --> 00:12:17,440
devtools

298
00:12:17,440 --> 00:12:19,839
go to the network tab

299
00:12:19,839 --> 00:12:22,480
copy the request that is going to

300
00:12:22,480 --> 00:12:25,120
the dot php page the post call to the

301
00:12:25,120 --> 00:12:28,560
login dot php page copy it as fetch

302
00:12:28,560 --> 00:12:30,480
go to the console tab

303
00:12:30,480 --> 00:12:32,560
paste that particular request paste that

304
00:12:32,560 --> 00:12:35,680
request multiple times say five times

305
00:12:35,680 --> 00:12:37,920
all separated by comma change the

306
00:12:37,920 --> 00:12:40,639
password in the initial

307
00:12:40,639 --> 00:12:43,279
for request to an incorrect one and on

308
00:12:43,279 --> 00:12:44,959
the last one

309
00:12:44,959 --> 00:12:48,079
put the correct credentials now click

310
00:12:48,079 --> 00:12:50,160
the enter button in the real world you

311
00:12:50,160 --> 00:12:51,760
may use a dictionary or a weight

312
00:12:51,760 --> 00:12:54,399
generator for creating these passwords

313
00:12:54,399 --> 00:12:57,600
but just for this demo we will go with

314
00:12:57,600 --> 00:13:00,880
passwords typed as it is looks good

315
00:13:00,880 --> 00:13:03,680
let's clear everything up on network tab

316
00:13:03,680 --> 00:13:06,560
then press go to the console tab again

317
00:13:06,560 --> 00:13:08,480
press the enter button go back to the

318
00:13:08,480 --> 00:13:10,320
network tab go through all the requests

319
00:13:10,320 --> 00:13:13,279
that is going to login.php page and find

320
00:13:13,279 --> 00:13:16,000
a request that has 3.2 response which

321
00:13:16,000 --> 00:13:17,839
indicates a successful login if you

322
00:13:17,839 --> 00:13:19,920
click on that you can find the correct

323
00:13:19,920 --> 00:13:21,519
password if you want an established

324
00:13:21,519 --> 00:13:22,720
session

325
00:13:22,720 --> 00:13:25,920
click on the index.php page right after

326
00:13:25,920 --> 00:13:29,120
that 3.2 response and open it in a new

327
00:13:29,120 --> 00:13:32,160
tab we just bypassed a brute force

328
00:13:32,160 --> 00:13:35,519
mechanism by exploiting top two you can

329
00:13:35,519 --> 00:13:37,680
solve this challenge using the bullet

330
00:13:37,680 --> 00:13:39,839
time feature as well for the record it

331
00:13:39,839 --> 00:13:42,399
is not just login pages

332
00:13:42,399 --> 00:13:45,279
any page that has similar rate limiting

333
00:13:45,279 --> 00:13:46,320
design

334
00:13:46,320 --> 00:13:48,560
can be potentially vulnerable to talk to

335
00:13:48,560 --> 00:13:51,519
attacks did you know that people used to

336
00:13:51,519 --> 00:13:52,800
believe

337
00:13:52,800 --> 00:13:55,279
php applications wouldn't be vulnerable

338
00:13:55,279 --> 00:13:57,360
to talk to attacks

339
00:13:57,360 --> 00:13:59,120
i had the

340
00:13:59,120 --> 00:14:01,680
idea behind that thinking

341
00:14:01,680 --> 00:14:05,519
is that php by itself doesn't allow

342
00:14:05,519 --> 00:14:07,920
multiple threads or concurrency

343
00:14:07,920 --> 00:14:09,199
operations

344
00:14:09,199 --> 00:14:10,399
however

345
00:14:10,399 --> 00:14:13,120
the platform it runs on

346
00:14:13,120 --> 00:14:15,120
nginx or apache

347
00:14:15,120 --> 00:14:18,720
they allow concurrency because of that

348
00:14:18,720 --> 00:14:23,120
php inherits talk to issues from the

349
00:14:23,120 --> 00:14:25,680
platform it is running on when i first

350
00:14:25,680 --> 00:14:27,839
started developing time gap theory i

351
00:14:27,839 --> 00:14:31,440
used node.js and express.js

352
00:14:31,440 --> 00:14:33,600
to create the challenges and everything

353
00:14:33,600 --> 00:14:36,160
then i asked myself am i making the

354
00:14:36,160 --> 00:14:39,120
right choice here what if somebody says

355
00:14:39,120 --> 00:14:40,079
the

356
00:14:40,079 --> 00:14:42,720
talk to issues are

357
00:14:42,720 --> 00:14:46,320
platform dependent or language dependent

358
00:14:46,320 --> 00:14:48,160
i didn't want that

359
00:14:48,160 --> 00:14:51,360
i wanted to tell people that

360
00:14:51,360 --> 00:14:53,920
talk to issues are not platform specific

361
00:14:53,920 --> 00:14:57,040
to prove that point i rewrote the code

362
00:14:57,040 --> 00:15:00,560
in php let us go back to the challenges

363
00:15:00,560 --> 00:15:03,199
an actual money transfer page this time

364
00:15:03,199 --> 00:15:05,120
money transfer scenarios has been

365
00:15:05,120 --> 00:15:07,279
friends with talk to issues for a very

366
00:15:07,279 --> 00:15:08,880
long time now

367
00:15:08,880 --> 00:15:11,120
almost all the articles out there

368
00:15:11,120 --> 00:15:13,279
talking about talk to you issues talk

369
00:15:13,279 --> 00:15:15,680
about money transfer pages in today's

370
00:15:15,680 --> 00:15:18,160
session we are paying a tribute to that

371
00:15:18,160 --> 00:15:19,839
age-old tradition

372
00:15:19,839 --> 00:15:21,120
by having

373
00:15:21,120 --> 00:15:24,000
a transfer rewards points page the

374
00:15:24,000 --> 00:15:25,920
working of a money transfer page is

375
00:15:25,920 --> 00:15:28,079
simple there will be a sender and a

376
00:15:28,079 --> 00:15:30,800
receiver the sender sends money to the

377
00:15:30,800 --> 00:15:33,120
receiver if you look at the data flow

378
00:15:33,120 --> 00:15:34,720
diagram you can see that there is a

379
00:15:34,720 --> 00:15:36,480
check that is happening for every

380
00:15:36,480 --> 00:15:37,839
transaction

381
00:15:37,839 --> 00:15:39,600
the application checks

382
00:15:39,600 --> 00:15:42,320
whether the sender has enough money

383
00:15:42,320 --> 00:15:45,040
before performing the transaction

384
00:15:45,040 --> 00:15:49,199
say for example if tom tries to transfer

385
00:15:49,199 --> 00:15:52,079
30 points from their account while they

386
00:15:52,079 --> 00:15:54,480
have only 10 points in their account the

387
00:15:54,480 --> 00:15:56,720
transaction won't go through as security

388
00:15:56,720 --> 00:15:58,720
people we shouldn't be blaming the

389
00:15:58,720 --> 00:16:00,959
claims from an app developer let us

390
00:16:00,959 --> 00:16:03,920
verify that by ourselves login as any

391
00:16:03,920 --> 00:16:06,320
user by going to the login page

392
00:16:06,320 --> 00:16:08,880
click on the transfer rewards

393
00:16:08,880 --> 00:16:11,040
button it will take you to the transfer

394
00:16:11,040 --> 00:16:12,720
rewards page

395
00:16:12,720 --> 00:16:15,120
then click on the first button to fill

396
00:16:15,120 --> 00:16:18,320
up the form automatically then change

397
00:16:18,320 --> 00:16:20,800
the transfer amount

398
00:16:20,800 --> 00:16:23,279
to an amount that is bigger than the

399
00:16:23,279 --> 00:16:25,360
current balance on the account click on

400
00:16:25,360 --> 00:16:26,959
the transfer button

401
00:16:26,959 --> 00:16:28,480
you will see an error message saying

402
00:16:28,480 --> 00:16:30,639
that you don't have enough rewards so

403
00:16:30,639 --> 00:16:32,639
the check is actually happening let us

404
00:16:32,639 --> 00:16:34,639
go back to the data flow diagram if you

405
00:16:34,639 --> 00:16:36,880
look closer you can see that there are

406
00:16:36,880 --> 00:16:37,680
two

407
00:16:37,680 --> 00:16:40,399
steps the application performs during a

408
00:16:40,399 --> 00:16:43,279
transaction right after the balance

409
00:16:43,279 --> 00:16:44,800
check if

410
00:16:44,800 --> 00:16:47,440
the user has sufficient balance

411
00:16:47,440 --> 00:16:49,440
then the application

412
00:16:49,440 --> 00:16:50,639
reduces

413
00:16:50,639 --> 00:16:52,320
that particular

414
00:16:52,320 --> 00:16:56,639
amount from the sender then it adds that

415
00:16:56,639 --> 00:16:59,680
particular amount to the receiver

416
00:16:59,680 --> 00:17:02,320
if you can send multiple parallel

417
00:17:02,320 --> 00:17:04,000
centricus

418
00:17:04,000 --> 00:17:06,559
to the application within a small time

419
00:17:06,559 --> 00:17:08,720
frame or if it is parallel

420
00:17:08,720 --> 00:17:11,280
before the application starts reducing

421
00:17:11,280 --> 00:17:13,919
the value from the from account

422
00:17:13,919 --> 00:17:16,959
you may get lucky let us try that go to

423
00:17:16,959 --> 00:17:19,119
the manage users page

424
00:17:19,119 --> 00:17:21,520
select the user jury and

425
00:17:21,520 --> 00:17:24,000
set zero as reward points on judy's

426
00:17:24,000 --> 00:17:27,039
account go to tom's account and set 100

427
00:17:27,039 --> 00:17:29,280
as reward points on that particular

428
00:17:29,280 --> 00:17:31,919
account go to the settings page and put

429
00:17:31,919 --> 00:17:34,799
a time delay like five seconds as the in

430
00:17:34,799 --> 00:17:37,039
the main weight field to enable the

431
00:17:37,039 --> 00:17:39,280
bullet time feature open two browsers

432
00:17:39,280 --> 00:17:42,160
side by side go to the login page and

433
00:17:42,160 --> 00:17:44,880
log in as user term on both the browsers

434
00:17:44,880 --> 00:17:47,200
navigate to the transfer rewards page

435
00:17:47,200 --> 00:17:49,360
click on the first button to fill the

436
00:17:49,360 --> 00:17:51,520
details automatically

437
00:17:51,520 --> 00:17:54,000
put thomas the sender jerry as the

438
00:17:54,000 --> 00:17:56,640
receiver put the amount as something

439
00:17:56,640 --> 00:17:59,520
slightly lesser or equal to the current

440
00:17:59,520 --> 00:18:02,240
balance on tom's account click on the

441
00:18:02,240 --> 00:18:05,520
transfer button on both browsers as

442
00:18:05,520 --> 00:18:07,360
fast as you can wait for both the

443
00:18:07,360 --> 00:18:10,080
request to finish now go to admin manage

444
00:18:10,080 --> 00:18:12,480
users you can see that

445
00:18:12,480 --> 00:18:13,679
jerry has

446
00:18:13,679 --> 00:18:17,360
more rewards than what tom had initially

447
00:18:17,360 --> 00:18:19,600
so you basically made reward points out

448
00:18:19,600 --> 00:18:21,280
of thin air just so that you know you

449
00:18:21,280 --> 00:18:23,120
can solve this challenge using browser

450
00:18:23,120 --> 00:18:24,960
tools as well these steps would be

451
00:18:24,960 --> 00:18:27,679
similar to the sign up and login

452
00:18:27,679 --> 00:18:29,760
challenges did you know that starbucks

453
00:18:29,760 --> 00:18:33,440
had a similar top to issue back in 2015

454
00:18:33,440 --> 00:18:35,280
all you had to do was

455
00:18:35,280 --> 00:18:38,559
purchase few gift cards from starbucks

456
00:18:38,559 --> 00:18:40,240
then keep on

457
00:18:40,240 --> 00:18:42,799
transferring the money between those

458
00:18:42,799 --> 00:18:45,039
gifts cards within a short period of

459
00:18:45,039 --> 00:18:47,520
time as many times as you can

460
00:18:47,520 --> 00:18:49,039
if you are lucky

461
00:18:49,039 --> 00:18:50,400
you will get

462
00:18:50,400 --> 00:18:52,400
cash in your account out of thin air

463
00:18:52,400 --> 00:18:54,160
it's not just starbucks by the way if

464
00:18:54,160 --> 00:18:56,799
you google for talk to issues

465
00:18:56,799 --> 00:18:58,640
race condition issues or concurrency

466
00:18:58,640 --> 00:19:00,799
issues in web applications

467
00:19:00,799 --> 00:19:02,480
you'll find

468
00:19:02,480 --> 00:19:04,960
a lot of these type of bug boundaries

469
00:19:04,960 --> 00:19:07,440
reported in various firms all over the

470
00:19:07,440 --> 00:19:09,919
globe race conditions and talk to issues

471
00:19:09,919 --> 00:19:12,480
were never in awas dropped in but that

472
00:19:12,480 --> 00:19:14,559
doesn't mean that you can ignore them

473
00:19:14,559 --> 00:19:17,120
hopefully or as time gap theory will

474
00:19:17,120 --> 00:19:19,360
help people understand this particular

475
00:19:19,360 --> 00:19:22,400
security issue and encourage people to

476
00:19:22,400 --> 00:19:25,679
build defense on their applications the

477
00:19:25,679 --> 00:19:27,280
next challenge is kind of a science

478
00:19:27,280 --> 00:19:29,200
fiction the name of the challenge is

479
00:19:29,200 --> 00:19:30,799
ticker to mars

480
00:19:30,799 --> 00:19:33,120
think of time gap theory as a prosperous

481
00:19:33,120 --> 00:19:35,120
company they are giving out ticket to

482
00:19:35,120 --> 00:19:37,120
mars if you have

483
00:19:37,120 --> 00:19:39,679
2000 reward points by the end of the

484
00:19:39,679 --> 00:19:41,840
year on your account let us see how that

485
00:19:41,840 --> 00:19:43,919
works go to the admin and click on

486
00:19:43,919 --> 00:19:46,880
create default users button to

487
00:19:46,880 --> 00:19:48,720
reset the database and create some

488
00:19:48,720 --> 00:19:51,120
sample accounts on the system go to the

489
00:19:51,120 --> 00:19:53,600
admin manage users page and you can see

490
00:19:53,600 --> 00:19:54,400
that

491
00:19:54,400 --> 00:19:57,679
take is the only user who has at least 2

492
00:19:57,679 --> 00:20:00,720
000 reward points in their account now

493
00:20:00,720 --> 00:20:03,600
assume that it is the end of the year

494
00:20:03,600 --> 00:20:06,480
and automated script will check balances

495
00:20:06,480 --> 00:20:09,520
on all of these accounts and determine

496
00:20:09,520 --> 00:20:12,720
who is eligible for gaining that ticket

497
00:20:12,720 --> 00:20:15,120
to mars you don't have to wait for the

498
00:20:15,120 --> 00:20:17,200
year and to trigger the script by the

499
00:20:17,200 --> 00:20:18,000
way

500
00:20:18,000 --> 00:20:19,679
you can go to

501
00:20:19,679 --> 00:20:22,480
admin and click on ticket to mars button

502
00:20:22,480 --> 00:20:24,720
to trigger that particular script let us

503
00:20:24,720 --> 00:20:26,960
do that you can see that the script has

504
00:20:26,960 --> 00:20:31,200
determined take as the only user who's

505
00:20:31,200 --> 00:20:32,960
eligible to

506
00:20:32,960 --> 00:20:35,600
get the ticket to mars now

507
00:20:35,600 --> 00:20:36,480
how

508
00:20:36,480 --> 00:20:40,240
ty can gain the system so that he can go

509
00:20:40,240 --> 00:20:43,200
to mars along with tom first log in as

510
00:20:43,200 --> 00:20:46,240
tag and transfer all reward points to

511
00:20:46,240 --> 00:20:49,120
tom's account go to the settings page

512
00:20:49,120 --> 00:20:52,559
and add five seconds delay in the mars

513
00:20:52,559 --> 00:20:55,520
wait field to enable the bullet time

514
00:20:55,520 --> 00:20:57,760
feature just for the ticket to mars

515
00:20:57,760 --> 00:21:00,640
program open two browsers side by side

516
00:21:00,640 --> 00:21:03,120
on the first browser navigate to the

517
00:21:03,120 --> 00:21:05,919
admin on the second browser

518
00:21:05,919 --> 00:21:09,840
log in as term and pre-fill the data as

519
00:21:09,840 --> 00:21:11,840
send set sender as tom

520
00:21:11,840 --> 00:21:15,039
receiver as tag and put 2000 reward

521
00:21:15,039 --> 00:21:17,280
points as the transfer amount on this

522
00:21:17,280 --> 00:21:19,200
first browser click on the ticket to

523
00:21:19,200 --> 00:21:21,679
mass button then

524
00:21:21,679 --> 00:21:24,400
go to the second browser as fast as you

525
00:21:24,400 --> 00:21:25,200
can

526
00:21:25,200 --> 00:21:27,280
and click on the transfer button wait

527
00:21:27,280 --> 00:21:29,360
for both the pages to load on the first

528
00:21:29,360 --> 00:21:33,039
browser you can see that tom and ty

529
00:21:33,039 --> 00:21:35,280
got the ticket to mars what exactly

530
00:21:35,280 --> 00:21:37,120
happened here let us look at the

531
00:21:37,120 --> 00:21:38,880
flowchart for this particular operation

532
00:21:38,880 --> 00:21:40,559
if you look at the flowchart you can see

533
00:21:40,559 --> 00:21:42,640
that the application goes through the

534
00:21:42,640 --> 00:21:44,400
entire list of users

535
00:21:44,400 --> 00:21:47,039
and check if they have enough reward

536
00:21:47,039 --> 00:21:48,640
points or not

537
00:21:48,640 --> 00:21:50,799
if the user has at least 2000 reward

538
00:21:50,799 --> 00:21:51,679
points

539
00:21:51,679 --> 00:21:54,720
it will assign a ticket to the mars for

540
00:21:54,720 --> 00:21:56,720
that particular user and will go on to

541
00:21:56,720 --> 00:21:59,200
the second user there's a time gap

542
00:21:59,200 --> 00:22:01,600
between the first user check

543
00:22:01,600 --> 00:22:04,720
and the last user check if you can

544
00:22:04,720 --> 00:22:07,360
transfer money from the first account to

545
00:22:07,360 --> 00:22:10,000
the last account within that time

546
00:22:10,000 --> 00:22:12,400
both of them will pass the check and

547
00:22:12,400 --> 00:22:14,080
both of them will get the ticket in a

548
00:22:14,080 --> 00:22:15,919
real-world scenario attacker will be

549
00:22:15,919 --> 00:22:18,080
knowing the execution time of that

550
00:22:18,080 --> 00:22:20,400
particular script say for example

551
00:22:20,400 --> 00:22:23,200
midnight on december 31st so they may

552
00:22:23,200 --> 00:22:25,280
schedule the transaction to happen

553
00:22:25,280 --> 00:22:28,480
exactly at that time to make it easy to

554
00:22:28,480 --> 00:22:30,960
exploit this particular issue do you

555
00:22:30,960 --> 00:22:33,360
know that race conditions in life

556
00:22:33,360 --> 00:22:35,799
critical systems can be dangerous in

557
00:22:35,799 --> 00:22:39,039
1993 three people died and several

558
00:22:39,039 --> 00:22:41,679
people got injured due to a race

559
00:22:41,679 --> 00:22:43,840
condition issue in a radiotherapy system

560
00:22:43,840 --> 00:22:46,480
the northeast blackout of 2003 which was

561
00:22:46,480 --> 00:22:50,080
a wide power outage in us and canada

562
00:22:50,080 --> 00:22:53,440
was also caused by a race condition bug

563
00:22:53,440 --> 00:22:55,360
do you want to know how you can set up a

564
00:22:55,360 --> 00:22:58,400
home lab of os time gap theory

565
00:22:58,400 --> 00:23:01,120
having a home lab can help you

566
00:23:01,120 --> 00:23:02,880
understand talk to your issues much more

567
00:23:02,880 --> 00:23:04,240
closer

568
00:23:04,240 --> 00:23:06,960
it can also help you teach about these

569
00:23:06,960 --> 00:23:09,039
issues to others the first and

570
00:23:09,039 --> 00:23:13,120
recommended option is to use docker

571
00:23:13,120 --> 00:23:15,200
install docker

572
00:23:15,200 --> 00:23:16,159
then

573
00:23:16,159 --> 00:23:17,919
clone this particular

574
00:23:17,919 --> 00:23:20,159
github url or

575
00:23:20,159 --> 00:23:23,200
download the zip file and extract it

576
00:23:23,200 --> 00:23:26,480
cd into timecap hyphen theory directory

577
00:23:26,480 --> 00:23:29,360
issue the command docker combos up

578
00:23:29,360 --> 00:23:32,799
hyphen d go to your browser navigate to

579
00:23:32,799 --> 00:23:35,919
localhost and you will see the home page

580
00:23:35,919 --> 00:23:36,799
of

581
00:23:36,799 --> 00:23:39,280
time gap theory if you don't want to use

582
00:23:39,280 --> 00:23:42,400
docker for any of the reasons you can go

583
00:23:42,400 --> 00:23:44,400
for the hero curvation instead first

584
00:23:44,400 --> 00:23:46,480
sign up for a heroku account and

585
00:23:46,480 --> 00:23:48,559
activate the account activating the

586
00:23:48,559 --> 00:23:51,039
account requires you to confirming the

587
00:23:51,039 --> 00:23:53,919
email and setting up setting up some

588
00:23:53,919 --> 00:23:56,159
payment information like credit card it

589
00:23:56,159 --> 00:23:57,840
is just for activating the account by

590
00:23:57,840 --> 00:23:58,880
the way

591
00:23:58,880 --> 00:24:00,799
you don't have to spend money for

592
00:24:00,799 --> 00:24:02,400
actually running the avast plan gap

593
00:24:02,400 --> 00:24:05,440
theory lab once completed go to the

594
00:24:05,440 --> 00:24:08,640
github page of awast time gap theory

595
00:24:08,640 --> 00:24:10,799
click on the deploy button follow the

596
00:24:10,799 --> 00:24:12,559
on-screen instructions and you'll have

597
00:24:12,559 --> 00:24:14,720
the lab ready i'm sure all of you are

598
00:24:14,720 --> 00:24:17,360
familiar with rating systems facebook

599
00:24:17,360 --> 00:24:20,480
instagram youtube google maps all of

600
00:24:20,480 --> 00:24:22,480
them have some sort of rating system it

601
00:24:22,480 --> 00:24:23,840
can be like

602
00:24:23,840 --> 00:24:24,960
love

603
00:24:24,960 --> 00:24:27,120
or a full-fledged five-star rating

604
00:24:27,120 --> 00:24:30,080
system there is one business logic of

605
00:24:30,080 --> 00:24:32,000
rating system that many people doesn't

606
00:24:32,000 --> 00:24:35,440
like they can only like or love a

607
00:24:35,440 --> 00:24:38,320
particular post or video once not more

608
00:24:38,320 --> 00:24:39,919
than that i'm here to bring your

609
00:24:39,919 --> 00:24:42,320
attention to a new idea

610
00:24:42,320 --> 00:24:44,400
what if you can like

611
00:24:44,400 --> 00:24:47,679
a particular post or video 100 times do

612
00:24:47,679 --> 00:24:50,240
you like that idea let us see how

613
00:24:50,240 --> 00:24:52,640
exactly we can do that to achieve our

614
00:24:52,640 --> 00:24:55,279
goal we need to understand how a rating

615
00:24:55,279 --> 00:24:57,520
system works when a user clicks on the

616
00:24:57,520 --> 00:24:58,799
like button

617
00:24:58,799 --> 00:25:00,720
the application will check the database

618
00:25:00,720 --> 00:25:03,120
to check if that user

619
00:25:03,120 --> 00:25:05,440
already liked that particular post or

620
00:25:05,440 --> 00:25:07,200
video before

621
00:25:07,200 --> 00:25:08,799
or not

622
00:25:08,799 --> 00:25:11,600
if a previous instance is not found the

623
00:25:11,600 --> 00:25:13,919
application will create one if a rating

624
00:25:13,919 --> 00:25:16,480
is found already on that particular post

625
00:25:16,480 --> 00:25:19,919
from the same user they may remove it or

626
00:25:19,919 --> 00:25:21,840
they may do nothing let us check if the

627
00:25:21,840 --> 00:25:23,760
application is performing these checks

628
00:25:23,760 --> 00:25:26,480
or not go to the login page and log in

629
00:25:26,480 --> 00:25:29,120
as any user navigate to the ratings page

630
00:25:29,120 --> 00:25:30,799
you will see a message saying that you

631
00:25:30,799 --> 00:25:33,039
have no ratings click on the love button

632
00:25:33,039 --> 00:25:34,640
you will see a message saying that you

633
00:25:34,640 --> 00:25:36,640
have one rating click on the love button

634
00:25:36,640 --> 00:25:38,480
again now you will see that the message

635
00:25:38,480 --> 00:25:40,880
has changed to you have no rating the

636
00:25:40,880 --> 00:25:43,840
application has removed our initial

637
00:25:43,840 --> 00:25:45,840
rating when we clicked on the button

638
00:25:45,840 --> 00:25:48,480
again now you get to the admin page and

639
00:25:48,480 --> 00:25:50,400
click on create default users button

640
00:25:50,400 --> 00:25:52,720
then go to the settings page set 5

641
00:25:52,720 --> 00:25:55,200
seconds as the main weight delay to

642
00:25:55,200 --> 00:25:57,600
enable the bullet time feature open two

643
00:25:57,600 --> 00:26:00,240
browsers side by side login as this

644
00:26:00,240 --> 00:26:03,360
login as same user on both the browsers

645
00:26:03,360 --> 00:26:05,360
navigate to the ratings page on both of

646
00:26:05,360 --> 00:26:07,600
the browsers click on the love button on

647
00:26:07,600 --> 00:26:10,159
both the browsers as fast as you can

648
00:26:10,159 --> 00:26:12,159
wait for both the request to finish

649
00:26:12,159 --> 00:26:13,600
you'll see a message saying that you

650
00:26:13,600 --> 00:26:15,760
have two ratings now

651
00:26:15,760 --> 00:26:18,480
let us see how we can automate this now

652
00:26:18,480 --> 00:26:20,880
let us see how we can automate this

653
00:26:20,880 --> 00:26:23,520
first we will use browser dev tools for

654
00:26:23,520 --> 00:26:25,520
automating this pay close attention this

655
00:26:25,520 --> 00:26:26,960
time because you are not going to like

656
00:26:26,960 --> 00:26:28,880
the final outcome go to the settings

657
00:26:28,880 --> 00:26:30,880
page and disable the bullet time feature

658
00:26:30,880 --> 00:26:33,360
go to the admin and click click on

659
00:26:33,360 --> 00:26:35,279
create default users button go to the

660
00:26:35,279 --> 00:26:37,600
login page and login as any of the user

661
00:26:37,600 --> 00:26:39,760
then navigate to the ratings page open

662
00:26:39,760 --> 00:26:41,600
browser dev tools then click on the

663
00:26:41,600 --> 00:26:42,960
allow button once click on the allow

664
00:26:42,960 --> 00:26:45,520
button again to remove the existing

665
00:26:45,520 --> 00:26:47,360
rating go to the network tab of the

666
00:26:47,360 --> 00:26:49,039
browser tools

667
00:26:49,039 --> 00:26:51,200
click on the post request to the ratings

668
00:26:51,200 --> 00:26:53,600
page right click on it and copy test

669
00:26:53,600 --> 00:26:55,360
fetch go to the console tab of the

670
00:26:55,360 --> 00:26:57,120
browser paste that particular request

671
00:26:57,120 --> 00:26:59,600
several times all separated by comma

672
00:26:59,600 --> 00:27:01,760
then press the enter button our attack

673
00:27:01,760 --> 00:27:04,640
failed what exactly happened here there

674
00:27:04,640 --> 00:27:06,960
are three things we should pay attention

675
00:27:06,960 --> 00:27:09,760
to see surf prevention tokens

676
00:27:09,760 --> 00:27:11,039
cookies

677
00:27:11,039 --> 00:27:13,520
and sessions first see surf prevention

678
00:27:13,520 --> 00:27:16,559
talk let us see the blocking parameter

679
00:27:16,559 --> 00:27:19,200
is see surf sessions or not click on the

680
00:27:19,200 --> 00:27:21,760
love button multiple times then

681
00:27:21,760 --> 00:27:24,320
inspect all these pause call to the

682
00:27:24,320 --> 00:27:26,480
ratings page by going to the browser

683
00:27:26,480 --> 00:27:28,559
tools and network tab observe the

684
00:27:28,559 --> 00:27:31,200
pattern or behavior of of the csr

685
00:27:31,200 --> 00:27:32,960
prevention token that is being supplied

686
00:27:32,960 --> 00:27:34,880
looks like it is not being changed so

687
00:27:34,880 --> 00:27:37,520
that is not something that prevented us

688
00:27:37,520 --> 00:27:39,520
from executing the attack properly

689
00:27:39,520 --> 00:27:42,240
second cookies fetch requests are not

690
00:27:42,240 --> 00:27:43,919
capable of sending cookies to the

691
00:27:43,919 --> 00:27:46,240
application so we need a mechanism to

692
00:27:46,240 --> 00:27:48,000
send cookies to the application we can

693
00:27:48,000 --> 00:27:50,240
use scale kl supports sending cookies to

694
00:27:50,240 --> 00:27:52,880
the application the third thing sessions

695
00:27:52,880 --> 00:27:56,080
now that we have sessions php can

696
00:27:56,080 --> 00:27:57,919
look for requests coming from the same

697
00:27:57,919 --> 00:28:00,960
session and execute them one by one this

698
00:28:00,960 --> 00:28:04,240
can prevent talk to issues from being

699
00:28:04,240 --> 00:28:06,159
successful in all our previous

700
00:28:06,159 --> 00:28:08,000
challenges the pages were not

701
00:28:08,000 --> 00:28:10,399
authenticated so the sessions were not

702
00:28:10,399 --> 00:28:13,200
important but now that the ratings page

703
00:28:13,200 --> 00:28:15,520
is authenticated we have to be careful

704
00:28:15,520 --> 00:28:17,679
about sessions as we can create multiple

705
00:28:17,679 --> 00:28:19,360
sessions easily by the way you just have

706
00:28:19,360 --> 00:28:21,360
to log into the application from

707
00:28:21,360 --> 00:28:23,279
different browsers and you'll get

708
00:28:23,279 --> 00:28:25,840
multiple sessions we need two cal

709
00:28:25,840 --> 00:28:28,559
requests let's obtain the first one now

710
00:28:28,559 --> 00:28:30,799
login as any user now you get to the

711
00:28:30,799 --> 00:28:33,760
ratings page now open browser devtools

712
00:28:33,760 --> 00:28:35,440
click on the love button go to the

713
00:28:35,440 --> 00:28:37,840
network tab of the browser tool look for

714
00:28:37,840 --> 00:28:39,640
the post request that is going to the

715
00:28:39,640 --> 00:28:42,240
ratings.php page right click on it and

716
00:28:42,240 --> 00:28:45,039
copy as curl this time we have the first

717
00:28:45,039 --> 00:28:47,760
request now repeat the same steps on a

718
00:28:47,760 --> 00:28:50,799
different browser to get the second curl

719
00:28:50,799 --> 00:28:53,039
request open terminal paste the first

720
00:28:53,039 --> 00:28:56,320
scale request space ampersand symbol

721
00:28:56,320 --> 00:28:57,520
space

722
00:28:57,520 --> 00:28:59,919
second kill request and press enter if

723
00:28:59,919 --> 00:29:02,480
you are on windows you need a slightly

724
00:29:02,480 --> 00:29:04,000
different request for this by the way

725
00:29:04,000 --> 00:29:06,480
also remember to remove the compressed

726
00:29:06,480 --> 00:29:08,640
parameter from the request to make it

727
00:29:08,640 --> 00:29:10,480
widely compatible go to the browser

728
00:29:10,480 --> 00:29:12,559
window refresh the page

729
00:29:12,559 --> 00:29:15,279
and it says you have two ratings let us

730
00:29:15,279 --> 00:29:17,520
look at some of the tools

731
00:29:17,520 --> 00:29:19,520
among these tools

732
00:29:19,520 --> 00:29:22,240
raise the web is my personal favorite

733
00:29:22,240 --> 00:29:24,159
race the web is developed by aaron who

734
00:29:24,159 --> 00:29:26,000
is a former colleague of mine in

735
00:29:26,000 --> 00:29:27,919
security compass you should check out

736
00:29:27,919 --> 00:29:31,440
his first presentation because in that

737
00:29:31,440 --> 00:29:33,279
he discusses about

738
00:29:33,279 --> 00:29:35,919
preventive mechanisms against

739
00:29:35,919 --> 00:29:38,720
talk to issues first you need to get the

740
00:29:38,720 --> 00:29:41,679
rest of the binary from the github page

741
00:29:41,679 --> 00:29:43,840
of the rest the web tool in order to run

742
00:29:43,840 --> 00:29:46,240
the tool you need to create normal files

743
00:29:46,240 --> 00:29:48,480
let us look at a sample thermal file

744
00:29:48,480 --> 00:29:50,559
this is the tomal file for the transfer

745
00:29:50,559 --> 00:29:53,120
reverse page count defines how many

746
00:29:53,120 --> 00:29:55,919
requests the tool needs to send to the

747
00:29:55,919 --> 00:29:58,880
application verbose defines the

748
00:29:58,880 --> 00:30:01,919
verbosity level of the output shown on

749
00:30:01,919 --> 00:30:04,880
the screen the method defines the type

750
00:30:04,880 --> 00:30:06,960
of the request it can build get post put

751
00:30:06,960 --> 00:30:08,399
delete etc

752
00:30:08,399 --> 00:30:09,600
url

753
00:30:09,600 --> 00:30:12,320
is well the url at which the request

754
00:30:12,320 --> 00:30:13,760
needs to be sent

755
00:30:13,760 --> 00:30:15,600
body of the request is important if you

756
00:30:15,600 --> 00:30:18,080
want to send a body as part of the

757
00:30:18,080 --> 00:30:20,640
request if you don't need this part you

758
00:30:20,640 --> 00:30:22,880
just ignore it once the terminal file is

759
00:30:22,880 --> 00:30:24,720
ready you can supply it to the rest the

760
00:30:24,720 --> 00:30:28,240
web tool and execute the attack like

761
00:30:28,240 --> 00:30:29,279
this

762
00:30:29,279 --> 00:30:31,039
do you know that of as time gap theory

763
00:30:31,039 --> 00:30:32,399
is a team effort

764
00:30:32,399 --> 00:30:34,559
these are the people who were involved

765
00:30:34,559 --> 00:30:37,120
in bringing this project to you today we

766
00:30:37,120 --> 00:30:39,679
have also released a book you can get it

767
00:30:39,679 --> 00:30:43,080
from timecaptery.combook.html

768
00:30:43,120 --> 00:30:45,760
the physical copies cost you around 30

769
00:30:45,760 --> 00:30:48,720
us dollars but you can get the soft copy

770
00:30:48,720 --> 00:30:51,279
for free from the website i will highly

771
00:30:51,279 --> 00:30:53,360
recommend getting this book this day

772
00:30:53,360 --> 00:30:54,960
you'll have a handy guide with you all

773
00:30:54,960 --> 00:30:57,679
the time which you can refer later if

774
00:30:57,679 --> 00:30:59,760
you want to understand more about doctor

775
00:30:59,760 --> 00:31:00,880
issues

776
00:31:00,880 --> 00:31:03,600
it can also help you to teach others

777
00:31:03,600 --> 00:31:05,760
about doctor issues in general thank you

778
00:31:05,760 --> 00:31:08,240
for attending this session all our

779
00:31:08,240 --> 00:31:11,760
efforts will go waste if nobody uses

780
00:31:11,760 --> 00:31:14,399
this product or nobody learns anything

781
00:31:14,399 --> 00:31:15,600
from it

782
00:31:15,600 --> 00:31:18,640
as early adopters for this project

783
00:31:18,640 --> 00:31:19,360
we

784
00:31:19,360 --> 00:31:22,240
thank you from bottom of our hearts if

785
00:31:22,240 --> 00:31:24,399
you have any questions please reach out

786
00:31:24,399 --> 00:31:27,200
to us using the contact form

787
00:31:27,200 --> 00:31:29,039
of our slack channel

788
00:31:29,039 --> 00:31:32,000
or in our subreddit i have also written

789
00:31:32,000 --> 00:31:33,600
a talk to poem

790
00:31:33,600 --> 00:31:35,919
let me recite that for you what i need

791
00:31:35,919 --> 00:31:38,880
to do today is to find a gap in time a

792
00:31:38,880 --> 00:31:41,200
gap in time that norman thought a

793
00:31:41,200 --> 00:31:43,760
flowing time that norman caught what i

794
00:31:43,760 --> 00:31:45,919
need to find today is to find some

795
00:31:45,919 --> 00:31:48,320
variables variables that shared by

796
00:31:48,320 --> 00:31:50,720
threads variable that not yet locked

797
00:31:50,720 --> 00:31:53,279
what i need to do today is to find some

798
00:31:53,279 --> 00:31:55,679
gap in time from the tick off time of

799
00:31:55,679 --> 00:31:58,720
check to the click of time of use

800
00:31:58,720 --> 00:32:01,440
thank you

