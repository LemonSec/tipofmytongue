1
00:00:00,000 --> 00:00:06,029
<font color="#CCCCCC">mmm</font><font color="#E5E5E5"> Jessica we again have so much</font>

2
00:00:03,120 --> 00:00:07,589
<font color="#E5E5E5">content all right so this talk is</font><font color="#CCCCCC"> going</font>

3
00:00:06,029 --> 00:00:09,510
to<font color="#E5E5E5"> cover authentication as a micro</font>

4
00:00:07,589 --> 00:00:11,730
service just<font color="#E5E5E5"> to really cook rant on</font>

5
00:00:09,510 --> 00:00:14,700
micro services<font color="#E5E5E5"> everybody's kind of doing</font>

6
00:00:11,730 --> 00:00:17,250
them<font color="#CCCCCC"> you</font><font color="#E5E5E5"> don't have to they're not</font><font color="#CCCCCC"> great</font>

7
00:00:14,700 --> 00:00:19,740
<font color="#E5E5E5">for every application</font><font color="#CCCCCC"> so to keep</font><font color="#E5E5E5"> that in</font>

8
00:00:17,250 --> 00:00:22,109
mind when you're building stuff out<font color="#E5E5E5"> this</font>

9
00:00:19,740 --> 00:00:23,939
talk is actually applicable to non

10
00:00:22,109 --> 00:00:26,880
microservice architectures as well<font color="#E5E5E5"> so</font>

11
00:00:23,939 --> 00:00:28,590
keep<font color="#CCCCCC"> that in mind as well</font><font color="#E5E5E5"> all right</font>

12
00:00:26,880 --> 00:00:30,330
<font color="#E5E5E5">quick bio on me my name is</font><font color="#CCCCCC"> brian pond or</font>

13
00:00:28,590 --> 00:00:33,570
le<font color="#E5E5E5"> i founded a company called a Merce</font>

14
00:00:30,330 --> 00:00:36,960
<font color="#E5E5E5">off like</font><font color="#CCCCCC"> 11 years ago I've</font><font color="#E5E5E5"> been doing</font>

15
00:00:33,570 --> 00:00:39,690
security stuff at companies like<font color="#CCCCCC"> BA</font>

16
00:00:36,960 --> 00:00:42,210
<font color="#E5E5E5">Orbitz</font><font color="#CCCCCC"> u.s.</font><font color="#E5E5E5"> Freightways those kind of</font>

17
00:00:39,690 --> 00:00:45,209
things for<font color="#CCCCCC"> many many moons been coding</font>

18
00:00:42,210 --> 00:00:48,390
for about<font color="#CCCCCC"> twenty</font><font color="#E5E5E5"> plus</font><font color="#CCCCCC"> years</font><font color="#E5E5E5"> I'm a big</font>

19
00:00:45,210 --> 00:00:51,030
beer junkie<font color="#CCCCCC"> and one</font><font color="#E5E5E5"> of my favorite beers</font>

20
00:00:48,390 --> 00:00:52,829
is this cool place<font color="#E5E5E5"> in Colorado called</font>

21
00:00:51,030 --> 00:00:54,510
elevation and they make a<font color="#E5E5E5"> really good</font>

22
00:00:52,829 --> 00:00:56,039
quadruple<font color="#E5E5E5"> it's called the APIs so</font>

23
00:00:54,510 --> 00:00:59,940
<font color="#CCCCCC">anybody in</font><font color="#E5E5E5"> Colorado wants to grab a beer</font>

24
00:00:56,039 --> 00:01:01,199
<font color="#CCCCCC">I'm down all</font><font color="#E5E5E5"> right so what I'm gonna do</font>

25
00:00:59,940 --> 00:01:02,489
is I'm gonna go all the<font color="#CCCCCC"> way back in</font><font color="#E5E5E5"> time</font>

26
00:01:01,199 --> 00:01:03,809
we're going to<font color="#E5E5E5"> talk</font><font color="#CCCCCC"> about a fennec ation</font>

27
00:01:02,489 --> 00:01:05,908
and<font color="#CCCCCC"> then we're gonna flash forward to</font>

28
00:01:03,809 --> 00:01:07,710
where<font color="#E5E5E5"> we are today</font><font color="#CCCCCC"> stop me</font><font color="#E5E5E5"> if you have</font>

29
00:01:05,909 --> 00:01:09,240
<font color="#CCCCCC">questions and I'm</font><font color="#E5E5E5"> just gonna keep</font>

30
00:01:07,710 --> 00:01:10,919
cranking through<font color="#CCCCCC"> alright so in the</font>

31
00:01:09,240 --> 00:01:13,408
beginning<font color="#E5E5E5"> the monolithic application</font>

32
00:01:10,920 --> 00:01:16,830
right<font color="#CCCCCC"> looked</font><font color="#E5E5E5"> kind of like this</font><font color="#CCCCCC"> you might</font>

33
00:01:13,409 --> 00:01:17,970
<font color="#E5E5E5">have an app mobile whatever</font><font color="#CCCCCC"> Brian have a</font>

34
00:01:16,830 --> 00:01:20,490
browser and<font color="#E5E5E5"> it's hitting your back-end</font>

35
00:01:17,970 --> 00:01:23,429
<font color="#E5E5E5">and it's this big monster so I like to</font>

36
00:01:20,490 --> 00:01:24,479
say back in<font color="#E5E5E5"> the Orbitz days we had you</font>

37
00:01:23,430 --> 00:01:26,189
know<font color="#E5E5E5"> basically one monolithic</font>

38
00:01:24,479 --> 00:01:28,439
<font color="#E5E5E5">application then we started to rip it</font>

39
00:01:26,189 --> 00:01:31,048
apart<font color="#CCCCCC"> we had one big monolithic database</font>

40
00:01:28,439 --> 00:01:32,279
started<font color="#E5E5E5"> her that thing apart but they're</font>

41
00:01:31,049 --> 00:01:34,229
cumbersome right<font color="#E5E5E5"> so there's a lot of</font>

42
00:01:32,280 --> 00:01:35,610
reasons why<font color="#E5E5E5"> these things are</font><font color="#CCCCCC"> challenging</font>

43
00:01:34,229 --> 00:01:37,590
why people are going<font color="#CCCCCC"> to</font><font color="#E5E5E5"> micro services</font>

44
00:01:35,610 --> 00:01:40,079
<font color="#E5E5E5">so let's look at a standard database I</font>

45
00:01:37,590 --> 00:01:41,250
just made a<font color="#E5E5E5"> little</font><font color="#CCCCCC"> to-do example so this</font>

46
00:01:40,079 --> 00:01:43,669
<font color="#CCCCCC">is our to-do database</font>

47
00:01:41,250 --> 00:01:46,350
it has a user table you have some<font color="#E5E5E5"> roles</font>

48
00:01:43,670 --> 00:01:48,000
<font color="#E5E5E5">a join between those two users can have</font>

49
00:01:46,350 --> 00:01:49,890
<font color="#CCCCCC">multiple roles all that yeah yada and</font>

50
00:01:48,000 --> 00:01:53,100
<font color="#E5E5E5">then you have users or</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> dues sorry and</font>

51
00:01:49,890 --> 00:01:56,250
the<font color="#CCCCCC"> users</font><font color="#E5E5E5"> belong</font><font color="#CCCCCC"> to or</font><font color="#E5E5E5"> to news belong to</font>

52
00:01:53,100 --> 00:01:58,408
a user<font color="#E5E5E5"> okay so here's what our table</font>

53
00:01:56,250 --> 00:02:00,060
looks like<font color="#E5E5E5"> really simple table</font><font color="#CCCCCC"> crates</font>

54
00:01:58,409 --> 00:02:03,420
<font color="#CCCCCC">dues we have some foreign keys in here</font>

55
00:02:00,060 --> 00:02:05,310
so<font color="#CCCCCC"> a</font><font color="#E5E5E5"> foreign keys mmm this is this</font>

56
00:02:03,420 --> 00:02:07,619
little<font color="#CCCCCC"> cascade on</font><font color="#E5E5E5"> delete here is super</font>

57
00:02:05,310 --> 00:02:09,110
important right<font color="#E5E5E5"> help us clean everything</font>

58
00:02:07,619 --> 00:02:11,370
up<font color="#CCCCCC"> so we'll get</font><font color="#E5E5E5"> to that later</font>

59
00:02:09,110 --> 00:02:13,770
<font color="#CCCCCC">all right so how did we log</font><font color="#E5E5E5"> into these</font>

60
00:02:11,370 --> 00:02:16,320
apps<font color="#E5E5E5"> let's assume it's a web</font><font color="#CCCCCC"> app</font>

61
00:02:13,770 --> 00:02:17,700
<font color="#E5E5E5">and we would go to</font><font color="#CCCCCC"> /login</font><font color="#E5E5E5"> right and it</font>

62
00:02:16,320 --> 00:02:20,540
<font color="#E5E5E5">would send us back HTML and that would</font>

63
00:02:17,700 --> 00:02:22,730
be your login page<font color="#E5E5E5"> hopefully over SSL</font>

64
00:02:20,540 --> 00:02:25,109
<font color="#E5E5E5">but you never know</font>

65
00:02:22,730 --> 00:02:26,670
<font color="#CCCCCC">alright so then we filled out the forum</font>

66
00:02:25,110 --> 00:02:27,600
<font color="#E5E5E5">and we posted back and again hopefully</font>

67
00:02:26,670 --> 00:02:30,510
over SSL

68
00:02:27,600 --> 00:02:32,820
well TLS but yeah it<font color="#E5E5E5"> won't cause it SSL</font>

69
00:02:30,510 --> 00:02:34,500
<font color="#E5E5E5">and</font><font color="#CCCCCC"> so we post back to login</font><font color="#E5E5E5"> and we</font>

70
00:02:32,820 --> 00:02:35,760
would send it<font color="#E5E5E5"> our form data and what it</font>

71
00:02:34,500 --> 00:02:37,890
<font color="#E5E5E5">would do is it</font><font color="#CCCCCC"> would go</font><font color="#E5E5E5"> to the database</font>

72
00:02:35,760 --> 00:02:40,079
look us up<font color="#CCCCCC"> make</font><font color="#E5E5E5"> sure all the password</font>

73
00:02:37,890 --> 00:02:40,589
<font color="#E5E5E5">miss is good and then it would create a</font>

74
00:02:40,080 --> 00:02:42,300
<font color="#E5E5E5">session</font>

75
00:02:40,590 --> 00:02:44,550
<font color="#CCCCCC">alright so a session is basically just a</font>

76
00:02:42,300 --> 00:02:46,230
big hash on the server and it<font color="#E5E5E5"> would</font><font color="#CCCCCC"> jam</font>

77
00:02:44,550 --> 00:02:48,630
our user object into the<font color="#E5E5E5"> hash and</font><font color="#CCCCCC"> then</font>

78
00:02:46,230 --> 00:02:50,700
it would<font color="#E5E5E5"> send us back a 302 redirect to</font>

79
00:02:48,630 --> 00:02:52,260
<font color="#E5E5E5">wherever we're going along with a really</font>

80
00:02:50,700 --> 00:02:54,570
long opaque token which is just our

81
00:02:52,260 --> 00:02:56,579
session ID<font color="#E5E5E5"> now we get stored as a cookie</font>

82
00:02:54,570 --> 00:03:00,090
or jammed on<font color="#E5E5E5"> the URL in some fashion</font>

83
00:02:56,580 --> 00:03:01,050
<font color="#E5E5E5">right so pretty classic stuff all right</font>

84
00:03:00,090 --> 00:03:03,030
now when you want<font color="#CCCCCC"> to</font><font color="#E5E5E5"> go fetch our</font><font color="#CCCCCC"> to</font>

85
00:03:01,050 --> 00:03:04,650
<font color="#CCCCCC">Do's we've got a link all that</font><font color="#E5E5E5"> back up</font>

86
00:03:03,030 --> 00:03:08,820
<font color="#E5E5E5">so what we do is we pass back that</font>

87
00:03:04,650 --> 00:03:10,860
cookie to our<font color="#CCCCCC"> slash to do's and the back</font>

88
00:03:08,820 --> 00:03:13,380
end<font color="#CCCCCC"> looks us up in the session using</font>

89
00:03:10,860 --> 00:03:14,970
that big long opaque token<font color="#E5E5E5"> rips our user</font>

90
00:03:13,380 --> 00:03:17,070
object out<font color="#E5E5E5"> of the session and now can go</font>

91
00:03:14,970 --> 00:03:19,890
<font color="#E5E5E5">happily look up our dues and sends those</font>

92
00:03:17,070 --> 00:03:23,190
<font color="#E5E5E5">back as HTML totally straight</font><font color="#CCCCCC"> bored</font>

93
00:03:19,890 --> 00:03:25,079
<font color="#CCCCCC">everybody's hopefully seen this ok so</font>

94
00:03:23,190 --> 00:03:27,480
here's what<font color="#CCCCCC"> our select looked like back</font>

95
00:03:25,080 --> 00:03:30,720
<font color="#CCCCCC">in the</font><font color="#E5E5E5"> old days we</font><font color="#CCCCCC"> just looked</font><font color="#E5E5E5"> them up</font>

96
00:03:27,480 --> 00:03:33,570
<font color="#CCCCCC">user the users ID is 42 right</font><font color="#E5E5E5"> we got</font>

97
00:03:30,720 --> 00:03:36,300
that other<font color="#E5E5E5"> session</font><font color="#CCCCCC"> okay</font>

98
00:03:33,570 --> 00:03:38,340
this works right there's a classic<font color="#E5E5E5"> it</font>

99
00:03:36,300 --> 00:03:40,290
works<font color="#E5E5E5"> still works you don't have to not</font>

100
00:03:38,340 --> 00:03:41,940
do this<font color="#E5E5E5"> even though a lot of</font><font color="#CCCCCC"> people like</font>

101
00:03:40,290 --> 00:03:44,429
I might tell<font color="#CCCCCC"> you not to do this but I</font>

102
00:03:41,940 --> 00:03:46,079
won't<font color="#CCCCCC"> a lot</font><font color="#E5E5E5"> of people tell you not</font><font color="#CCCCCC"> to do</font>

103
00:03:44,430 --> 00:03:47,340
this<font color="#E5E5E5"> sessions are</font><font color="#CCCCCC"> tried and true they've</font>

104
00:03:46,080 --> 00:03:49,110
been<font color="#CCCCCC"> working for a very long time</font>

105
00:03:47,340 --> 00:03:50,760
cookies work they're<font color="#E5E5E5"> secure everything</font>

106
00:03:49,110 --> 00:03:52,680
works<font color="#E5E5E5"> right</font><font color="#CCCCCC"> so this</font><font color="#E5E5E5"> stuff works so</font><font color="#CCCCCC"> don't</font>

107
00:03:50,760 --> 00:03:53,579
feel<font color="#CCCCCC"> like you don't</font><font color="#E5E5E5"> have to implement it</font>

108
00:03:52,680 --> 00:03:57,090
this way it's<font color="#CCCCCC"> just I'm gonna show you</font>

109
00:03:53,580 --> 00:03:58,980
<font color="#CCCCCC">another way to</font><font color="#E5E5E5"> do it but it works on</font>

110
00:03:57,090 --> 00:04:00,680
everything<font color="#E5E5E5"> your session ID becomes your</font>

111
00:03:58,980 --> 00:04:03,149
identifier<font color="#E5E5E5"> that's basically you</font>

112
00:04:00,680 --> 00:04:05,430
generally speaking kind of<font color="#E5E5E5"> hard to steal</font>

113
00:04:03,150 --> 00:04:06,720
cookies hard<font color="#CCCCCC"> to</font><font color="#E5E5E5"> almost impossible to</font>

114
00:04:05,430 --> 00:04:10,200
forge them these<font color="#E5E5E5"> are really really long</font>

115
00:04:06,720 --> 00:04:11,820
<font color="#CCCCCC">Ince</font><font color="#E5E5E5"> basically and you know they're</font>

116
00:04:10,200 --> 00:04:14,790
secure it's a really good semantics<font color="#CCCCCC"> that</font>

117
00:04:11,820 --> 00:04:17,969
the<font color="#CCCCCC"> browser's have</font><font color="#E5E5E5"> about cookies in the</font>

118
00:04:14,790 --> 00:04:21,120
OS right<font color="#E5E5E5"> so all</font><font color="#CCCCCC"> right so why is this</font>

119
00:04:17,970 --> 00:04:23,040
<font color="#E5E5E5">painful</font><font color="#CCCCCC"> well we have state</font><font color="#E5E5E5"> all right so</font>

120
00:04:21,120 --> 00:04:24,600
our<font color="#E5E5E5"> back-end has that big global hash</font>

121
00:04:23,040 --> 00:04:25,880
now you<font color="#E5E5E5"> could</font><font color="#CCCCCC"> stored in the database you</font>

122
00:04:24,600 --> 00:04:28,310
could share it<font color="#E5E5E5"> you</font><font color="#CCCCCC"> could</font>

123
00:04:25,880 --> 00:04:30,409
session pin people right<font color="#E5E5E5"> and so if you</font>

124
00:04:28,310 --> 00:04:32,000
have like<font color="#E5E5E5"> 12 of</font><font color="#CCCCCC"> these boxes serving up</font>

125
00:04:30,410 --> 00:04:34,100
your backhand<font color="#E5E5E5"> application you might have</font>

126
00:04:32,000 --> 00:04:35,600
to lock<font color="#E5E5E5"> somebody to one of them and then</font>

127
00:04:34,100 --> 00:04:37,580
what that<font color="#E5E5E5"> does is it basically passes</font>

128
00:04:35,600 --> 00:04:39,320
them back a cookie<font color="#CCCCCC"> that spins them to</font>

129
00:04:37,580 --> 00:04:40,370
that<font color="#CCCCCC"> back-end server</font><font color="#E5E5E5"> because that's</font>

130
00:04:39,320 --> 00:04:42,050
where<font color="#E5E5E5"> their session is if they go to</font>

131
00:04:40,370 --> 00:04:43,970
<font color="#CCCCCC">another server their session</font><font color="#E5E5E5"> won't be</font>

132
00:04:42,050 --> 00:04:46,340
there<font color="#E5E5E5"> so</font><font color="#CCCCCC"> that we call</font><font color="#E5E5E5"> that session</font>

133
00:04:43,970 --> 00:04:48,170
pinning these things are harder<font color="#CCCCCC"> to scale</font>

134
00:04:46,340 --> 00:04:50,060
<font color="#CCCCCC">got I think a lot</font><font color="#E5E5E5"> about session</font>

135
00:04:48,170 --> 00:04:50,930
replication<font color="#CCCCCC"> you got to think</font><font color="#E5E5E5"> about zero</font>

136
00:04:50,060 --> 00:04:52,580
<font color="#E5E5E5">downtime</font>

137
00:04:50,930 --> 00:04:54,110
generally speaking you<font color="#CCCCCC"> have one big</font>

138
00:04:52,580 --> 00:04:57,349
clunky database because it's got all

139
00:04:54,110 --> 00:04:59,690
<font color="#CCCCCC">your crap and a lot</font><font color="#E5E5E5"> of foreign keys</font><font color="#CCCCCC"> so</font>

140
00:04:57,350 --> 00:05:02,420
it's it's it's<font color="#E5E5E5"> tough but</font><font color="#CCCCCC"> it works</font><font color="#E5E5E5"> really</font>

141
00:04:59,690 --> 00:05:04,400
<font color="#CCCCCC">well for</font><font color="#E5E5E5"> a lot</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> applications all right</font>

142
00:05:02,420 --> 00:05:05,630
so let's rip<font color="#CCCCCC"> it apart I'm</font><font color="#E5E5E5"> gonna rip</font>

143
00:05:04,400 --> 00:05:07,219
<font color="#E5E5E5">these things apart</font><font color="#CCCCCC"> and we're gonna</font><font color="#E5E5E5"> make</font>

144
00:05:05,630 --> 00:05:09,920
it<font color="#E5E5E5"> it to do API and we're gonna make a</font>

145
00:05:07,220 --> 00:05:12,050
user API<font color="#CCCCCC"> cuz i'll micro-service</font><font color="#E5E5E5"> even</font>

146
00:05:09,920 --> 00:05:13,520
cool<font color="#CCCCCC"> then we're gonna put</font><font color="#E5E5E5"> them into</font>

147
00:05:12,050 --> 00:05:16,460
containers and<font color="#CCCCCC"> it's gonna be even</font><font color="#E5E5E5"> cooler</font>

148
00:05:13,520 --> 00:05:18,950
<font color="#CCCCCC">alright so now we can fundamentally rip</font>

149
00:05:16,460 --> 00:05:21,289
apart our databases<font color="#CCCCCC"> cuz we're not tied</font>

150
00:05:18,950 --> 00:05:22,820
to having<font color="#E5E5E5"> a single database</font><font color="#CCCCCC"> each of</font><font color="#E5E5E5"> our</font>

151
00:05:21,290 --> 00:05:24,680
micro services<font color="#E5E5E5"> can have its own</font><font color="#CCCCCC"> database</font>

152
00:05:22,820 --> 00:05:27,730
<font color="#E5E5E5">so let's go ahead and do</font><font color="#CCCCCC"> that as well</font>

153
00:05:24,680 --> 00:05:29,690
well<font color="#CCCCCC"> user database in a to do database</font>

154
00:05:27,730 --> 00:05:31,790
<font color="#CCCCCC">alright so here's</font><font color="#E5E5E5"> what the user database</font>

155
00:05:29,690 --> 00:05:32,600
looks like all<font color="#E5E5E5"> I did</font><font color="#CCCCCC"> was remove the</font>

156
00:05:31,790 --> 00:05:34,130
<font color="#CCCCCC">tadeas table</font>

157
00:05:32,600 --> 00:05:37,070
totally straight<font color="#E5E5E5"> forwards got all the</font>

158
00:05:34,130 --> 00:05:40,250
user junk in it here's what I do

159
00:05:37,070 --> 00:05:42,590
database looks like here's what our new

160
00:05:40,250 --> 00:05:45,080
create statement looks like so<font color="#CCCCCC"> you'll</font>

161
00:05:42,590 --> 00:05:46,520
notice<font color="#CCCCCC"> no foreign key</font><font color="#E5E5E5"> but we do have a</font>

162
00:05:45,080 --> 00:05:49,750
user ID still we just don't have foreign

163
00:05:46,520 --> 00:05:52,820
key<font color="#E5E5E5"> okay</font>

164
00:05:49,750 --> 00:05:55,550
so let's walk through the evolution of

165
00:05:52,820 --> 00:05:58,580
like what we do with this<font color="#CCCCCC"> ok so we're</font>

166
00:05:55,550 --> 00:05:59,480
gonna<font color="#E5E5E5"> have</font><font color="#CCCCCC"> to user API</font><font color="#E5E5E5"> which we</font><font color="#CCCCCC"> what</font>

167
00:05:58,580 --> 00:06:01,340
<font color="#CCCCCC">should we send</font><font color="#E5E5E5"> it when should we get</font>

168
00:05:59,480 --> 00:06:03,710
<font color="#E5E5E5">back I'm just</font><font color="#CCCCCC"> skipping the whole form</font>

169
00:06:01,340 --> 00:06:05,030
<font color="#E5E5E5">part of the process but we're posting</font>

170
00:06:03,710 --> 00:06:06,560
the form with our<font color="#E5E5E5"> username and password</font>

171
00:06:05,030 --> 00:06:09,260
and<font color="#CCCCCC"> I just made it a</font><font color="#E5E5E5"> mobile app because</font>

172
00:06:06,560 --> 00:06:10,820
<font color="#CCCCCC">you know now our hip and modern ok so</font>

173
00:06:09,260 --> 00:06:12,740
what<font color="#E5E5E5"> we're gonna send it is we're gonna</font>

174
00:06:10,820 --> 00:06:14,300
<font color="#E5E5E5">send it our user it's gonna go fetch the</font>

175
00:06:12,740 --> 00:06:17,330
user but it's not gonna set up state

176
00:06:14,300 --> 00:06:18,980
it's<font color="#E5E5E5"> not gonna have a session so let's</font>

177
00:06:17,330 --> 00:06:20,719
just let's just<font color="#E5E5E5"> do the</font><font color="#CCCCCC"> easy way</font><font color="#E5E5E5"> we'll</font>

178
00:06:18,980 --> 00:06:22,790
just pass the user object<font color="#CCCCCC"> back as JSON</font>

179
00:06:20,720 --> 00:06:25,880
<font color="#E5E5E5">and then we'll store the JSON in the</font>

180
00:06:22,790 --> 00:06:27,860
phone<font color="#E5E5E5"> it might look something</font><font color="#CCCCCC"> like this</font>

181
00:06:25,880 --> 00:06:30,980
but in you know whatever storage you

182
00:06:27,860 --> 00:06:32,900
want pretty<font color="#E5E5E5"> straightforward I jammed</font>

183
00:06:30,980 --> 00:06:34,130
some rolled on there just<font color="#CCCCCC"> for fun ok now</font>

184
00:06:32,900 --> 00:06:37,310
I'm gonna go get my to do so I'm gonna

185
00:06:34,130 --> 00:06:39,020
call<font color="#E5E5E5"> my to do API I'm gonna pass in just</font>

186
00:06:37,310 --> 00:06:41,370
you<font color="#E5E5E5"> know might use your idea 42</font>

187
00:06:39,020 --> 00:06:44,070
and then I get my two days and<font color="#E5E5E5"> they come</font>

188
00:06:41,370 --> 00:06:46,470
back<font color="#E5E5E5"> as JSON straight for it</font><font color="#CCCCCC"> oh my god</font>

189
00:06:44,070 --> 00:06:51,090
<font color="#CCCCCC">all</font><font color="#E5E5E5"> right yeah so this bad right I mean</font>

190
00:06:46,470 --> 00:06:53,240
<font color="#E5E5E5">it's just</font><font color="#CCCCCC"> what's it yeah exactly I mean</font>

191
00:06:51,090 --> 00:06:55,500
<font color="#CCCCCC">like don't do this</font>

192
00:06:53,240 --> 00:07:01,620
okay so now I can<font color="#CCCCCC"> totally mess with</font>

193
00:06:55,500 --> 00:07:05,340
somebody<font color="#E5E5E5"> so whose ID is one admin rude</font>

194
00:07:01,620 --> 00:07:07,170
<font color="#CCCCCC">yeah of</font><font color="#E5E5E5"> course so yeah I'm just</font><font color="#CCCCCC"> gonna</font>

195
00:07:05,340 --> 00:07:08,880
<font color="#E5E5E5">sorry oh please sir I'm just gonna keep</font>

196
00:07:07,170 --> 00:07:12,390
<font color="#E5E5E5">checking off his like it</font><font color="#CCCCCC"> he'll never get</font>

197
00:07:08,880 --> 00:07:16,380
now he'll<font color="#E5E5E5"> be so frustrated all right so</font>

198
00:07:12,390 --> 00:07:18,150
let's fix it<font color="#CCCCCC"> we're gonna now</font><font color="#E5E5E5"> pass in it</font>

199
00:07:16,380 --> 00:07:20,190
<font color="#E5E5E5">we're gonna manage</font><font color="#CCCCCC"> this with tokens</font>

200
00:07:18,150 --> 00:07:21,390
<font color="#E5E5E5">right so don't pass in an ID we're gonna</font>

201
00:07:20,190 --> 00:07:27,140
go back<font color="#CCCCCC"> to sort of</font><font color="#E5E5E5"> our session</font>

202
00:07:21,390 --> 00:07:29,130
<font color="#CCCCCC">identifier thing something you</font><font color="#E5E5E5"> know okay</font>

203
00:07:27,140 --> 00:07:30,390
<font color="#CCCCCC">all</font><font color="#E5E5E5"> right so now what we're</font><font color="#CCCCCC"> gonna do is</font>

204
00:07:29,130 --> 00:07:32,670
we're gonna tokenize everything so

205
00:07:30,390 --> 00:07:34,890
rather than<font color="#CCCCCC"> you</font><font color="#E5E5E5"> know oh just IDs we're</font>

206
00:07:32,670 --> 00:07:36,300
gonna use a token exact same way<font color="#E5E5E5"> we did</font>

207
00:07:34,890 --> 00:07:38,039
<font color="#CCCCCC">before with sessions we're just gonna</font>

208
00:07:36,300 --> 00:07:40,260
pass them back to the phone and<font color="#E5E5E5"> then</font><font color="#CCCCCC"> the</font>

209
00:07:38,040 --> 00:07:43,140
phone is gonna happily go use<font color="#CCCCCC"> that token</font>

210
00:07:40,260 --> 00:07:45,840
<font color="#E5E5E5">to look the user up right it's an opaque</font>

211
00:07:43,140 --> 00:07:48,599
token<font color="#E5E5E5"> just basically a long set</font><font color="#CCCCCC"> of</font>

212
00:07:45,840 --> 00:07:50,280
garbage characters and so now we have to

213
00:07:48,600 --> 00:07:52,050
have a<font color="#E5E5E5"> token reconciliation or token</font>

214
00:07:50,280 --> 00:07:54,510
<font color="#CCCCCC">look</font><font color="#E5E5E5"> up when we need is we</font><font color="#CCCCCC"> need to pass</font>

215
00:07:52,050 --> 00:07:55,830
<font color="#E5E5E5">that token and get a user object</font><font color="#CCCCCC"> back</font>

216
00:07:54,510 --> 00:07:58,530
because really<font color="#E5E5E5"> what we need is the user</font>

217
00:07:55,830 --> 00:08:02,130
ID which<font color="#CCCCCC"> is not in the token so then I</font>

218
00:07:58,530 --> 00:08:04,909
call get through a token API to the user

219
00:08:02,130 --> 00:08:08,159
<font color="#CCCCCC">API and</font><font color="#E5E5E5"> then it returns</font><font color="#CCCCCC"> me my user</font><font color="#E5E5E5"> okay</font>

220
00:08:04,910 --> 00:08:09,570
<font color="#E5E5E5">this works this is how</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> lot</font><font color="#CCCCCC"> of like Oh</font>

221
00:08:08,160 --> 00:08:11,460
auth implementation is<font color="#E5E5E5"> actually working</font>

222
00:08:09,570 --> 00:08:13,260
<font color="#E5E5E5">all right so there has to be a user</font>

223
00:08:11,460 --> 00:08:15,840
token mapping at all points in<font color="#E5E5E5"> the user</font>

224
00:08:13,260 --> 00:08:17,490
API you can store it in<font color="#E5E5E5"> memory you can</font>

225
00:08:15,840 --> 00:08:19,650
start in the database out here<font color="#E5E5E5"> wherever</font>

226
00:08:17,490 --> 00:08:23,220
<font color="#E5E5E5">but there's a mapping this stuff gets</font>

227
00:08:19,650 --> 00:08:25,049
<font color="#E5E5E5">really chatty right because if everybody</font>

228
00:08:23,220 --> 00:08:26,970
is going constantly<font color="#CCCCCC"> going back to the</font>

229
00:08:25,050 --> 00:08:29,100
user API<font color="#E5E5E5"> to look the user up and get</font>

230
00:08:26,970 --> 00:08:30,960
really chatty<font color="#CCCCCC"> so you there's a lot of</font>

231
00:08:29,100 --> 00:08:32,640
ways to fix<font color="#E5E5E5"> that</font><font color="#CCCCCC"> you can like go</font><font color="#E5E5E5"> get the</font>

232
00:08:30,960 --> 00:08:35,699
user object<font color="#E5E5E5"> once and then pass the user</font>

233
00:08:32,640 --> 00:08:37,710
<font color="#CCCCCC">object around all your sub api's and but</font>

234
00:08:35,700 --> 00:08:39,180
what you're all<font color="#E5E5E5"> basically doing is</font>

235
00:08:37,710 --> 00:08:40,620
you're<font color="#CCCCCC"> saying okay well everything in</font>

236
00:08:39,179 --> 00:08:43,020
the universe is<font color="#E5E5E5"> coupled to our user API</font>

237
00:08:40,620 --> 00:08:45,120
<font color="#E5E5E5">now because I need to exchange these</font>

238
00:08:43,020 --> 00:08:46,500
tokens<font color="#CCCCCC"> I might be passed a token</font><font color="#E5E5E5"> and I</font>

239
00:08:45,120 --> 00:08:49,830
need to use her object<font color="#CCCCCC"> so I'm going to</font>

240
00:08:46,500 --> 00:08:50,910
exchange it<font color="#CCCCCC"> or look it up</font><font color="#E5E5E5"> so it's very</font>

241
00:08:49,830 --> 00:08:54,060
coupled

242
00:08:50,910 --> 00:08:55,680
<font color="#E5E5E5">all right so now let's go to the new</font>

243
00:08:54,060 --> 00:08:57,540
hotness well not new<font color="#CCCCCC"> it's kind of old</font>

244
00:08:55,680 --> 00:09:00,150
now but<font color="#E5E5E5"> we're gonna make it</font>

245
00:08:57,540 --> 00:09:02,310
JSON web token<font color="#CCCCCC"> so instead of just having</font>

246
00:09:00,150 --> 00:09:04,740
an opaque token like an OAuth<font color="#CCCCCC"> access</font>

247
00:09:02,310 --> 00:09:08,219
token<font color="#CCCCCC"> Oh auth one whatever we're</font><font color="#E5E5E5"> going</font>

248
00:09:04,740 --> 00:09:10,650
<font color="#E5E5E5">to send back JSON web token all right so</font>

249
00:09:08,220 --> 00:09:13,140
what is<font color="#E5E5E5"> JSON web token right so these</font>

250
00:09:10,650 --> 00:09:15,660
things are basically just JSON and

251
00:09:13,140 --> 00:09:18,569
they're in base64<font color="#E5E5E5"> encoded and there's</font>

252
00:09:15,660 --> 00:09:21,540
they can be signed<font color="#E5E5E5"> they can be validated</font>

253
00:09:18,570 --> 00:09:24,120
<font color="#E5E5E5">and they're completely portable so</font>

254
00:09:21,540 --> 00:09:25,890
that's the big win here<font color="#E5E5E5"> is because we</font>

255
00:09:24,120 --> 00:09:27,360
can sign and validate them they're

256
00:09:25,890 --> 00:09:29,310
<font color="#E5E5E5">portable I can send them to any surface</font>

257
00:09:27,360 --> 00:09:32,070
<font color="#CCCCCC">that service can verify that it was</font>

258
00:09:29,310 --> 00:09:33,540
created by the person<font color="#E5E5E5"> you know the</font>

259
00:09:32,070 --> 00:09:35,190
person who has authority to<font color="#E5E5E5"> create it</font>

260
00:09:33,540 --> 00:09:37,349
<font color="#E5E5E5">and they can verify it's actually me</font>

261
00:09:35,190 --> 00:09:39,450
right you can't mangle a<font color="#CCCCCC"> jot</font><font color="#E5E5E5"> because</font>

262
00:09:37,350 --> 00:09:41,130
then the signature<font color="#E5E5E5"> gets screwed up and</font>

263
00:09:39,450 --> 00:09:43,560
<font color="#E5E5E5">you can put anything you want in a job</font>

264
00:09:41,130 --> 00:09:45,150
so it can contain<font color="#E5E5E5"> your</font><font color="#CCCCCC"> rules which is</font>

265
00:09:43,560 --> 00:09:49,079
another<font color="#E5E5E5"> thing you probably want access</font>

266
00:09:45,150 --> 00:09:50,280
<font color="#CCCCCC">to all right</font><font color="#E5E5E5"> so let's look at a job now</font>

267
00:09:49,080 --> 00:09:53,490
let's break it into<font color="#E5E5E5"> pieces all right so</font>

268
00:09:50,280 --> 00:09:55,939
<font color="#E5E5E5">jawed is a</font><font color="#CCCCCC"> three part base64</font><font color="#E5E5E5"> encoded</font>

269
00:09:53,490 --> 00:09:58,830
blob and they're<font color="#E5E5E5"> separated by periods</font>

270
00:09:55,940 --> 00:09:59,940
the first part is<font color="#CCCCCC"> the header</font><font color="#E5E5E5"> second part</font>

271
00:09:58,830 --> 00:10:04,080
<font color="#E5E5E5">is the body</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> the third part is the</font>

272
00:09:59,940 --> 00:10:07,320
<font color="#E5E5E5">signature if</font><font color="#CCCCCC"> I decode my header it looks</font>

273
00:10:04,080 --> 00:10:08,850
like this type and algorithm the

274
00:10:07,320 --> 00:10:11,880
algorithm is how it was<font color="#E5E5E5"> signed or</font>

275
00:10:08,850 --> 00:10:13,530
encrypted<font color="#E5E5E5"> potentially I don't know why</font>

276
00:10:11,880 --> 00:10:15,960
they insist<font color="#E5E5E5"> on using three characters</font>

277
00:10:13,530 --> 00:10:18,000
for this stuff guess they're like<font color="#CCCCCC"> oh</font>

278
00:10:15,960 --> 00:10:21,900
it's<font color="#E5E5E5"> gonna be too big</font><font color="#CCCCCC"> I need</font><font color="#E5E5E5"> to save you</font>

279
00:10:18,000 --> 00:10:23,310
know<font color="#E5E5E5"> two bytes okay mm-hmm and here's</font>

280
00:10:21,900 --> 00:10:26,340
what the body looks<font color="#E5E5E5"> like so if I decode</font>

281
00:10:23,310 --> 00:10:28,770
the body<font color="#E5E5E5"> I'll get this out so these is</font>

282
00:10:26,340 --> 00:10:30,810
these this<font color="#E5E5E5"> is just JSON and it has a</font>

283
00:10:28,770 --> 00:10:33,840
number<font color="#CCCCCC"> of</font><font color="#E5E5E5"> different claims right suspect</font>

284
00:10:30,810 --> 00:10:36,060
<font color="#E5E5E5">calls</font><font color="#CCCCCC"> them claims and there's a number</font>

285
00:10:33,840 --> 00:10:39,150
<font color="#E5E5E5">of</font><font color="#CCCCCC"> them that</font><font color="#E5E5E5"> are standard</font><font color="#CCCCCC"> but you</font><font color="#E5E5E5"> can</font>

286
00:10:36,060 --> 00:10:41,780
put anything<font color="#E5E5E5"> you want in it so issue is</font>

287
00:10:39,150 --> 00:10:44,250
<font color="#CCCCCC">your</font><font color="#E5E5E5"> that's just who created it</font>

288
00:10:41,780 --> 00:10:46,500
expiration when it expires these are all

289
00:10:44,250 --> 00:10:47,700
required<font color="#E5E5E5"> talk about expiration a little</font>

290
00:10:46,500 --> 00:10:51,930
later

291
00:10:47,700 --> 00:10:53,220
the audience is<font color="#CCCCCC"> who is this for</font><font color="#E5E5E5"> what</font>

292
00:10:51,930 --> 00:10:56,550
application so usually this is an

293
00:10:53,220 --> 00:10:59,310
application ID<font color="#CCCCCC"> subject</font><font color="#E5E5E5"> is you it's the</font>

294
00:10:56,550 --> 00:11:02,550
user ID<font color="#E5E5E5"> I just using you you IDs here a</font>

295
00:10:59,310 --> 00:11:04,170
<font color="#E5E5E5">little more portable and</font><font color="#CCCCCC"> then I have</font>

296
00:11:02,550 --> 00:11:05,819
custom claims so I

297
00:11:04,170 --> 00:11:08,250
name and rules<font color="#CCCCCC"> right so that's that's</font>

298
00:11:05,820 --> 00:11:11,190
<font color="#E5E5E5">just</font><font color="#CCCCCC"> information about</font><font color="#E5E5E5"> me and then</font>

299
00:11:08,250 --> 00:11:13,980
that's the signature right<font color="#E5E5E5"> so it's just</font>

300
00:11:11,190 --> 00:11:15,060
<font color="#E5E5E5">this arch RSA or H</font><font color="#CCCCCC"> Mac</font><font color="#E5E5E5"> lots of different</font>

301
00:11:13,980 --> 00:11:17,550
reasons<font color="#E5E5E5"> why</font><font color="#CCCCCC"> you would use one or</font><font color="#E5E5E5"> the</font>

302
00:11:15,060 --> 00:11:22,199
other<font color="#CCCCCC"> and if you want to talk about that</font>

303
00:11:17,550 --> 00:11:24,510
after now I can talk<font color="#CCCCCC"> about alright</font><font color="#E5E5E5"> so</font>

304
00:11:22,199 --> 00:11:27,420
how does<font color="#E5E5E5"> our to do select change well</font>

305
00:11:24,510 --> 00:11:30,449
now we rip apart that jot<font color="#E5E5E5"> we validate</font>

306
00:11:27,420 --> 00:11:32,069
that it's good we verify it and now we

307
00:11:30,449 --> 00:11:34,920
<font color="#E5E5E5">can just</font><font color="#CCCCCC"> grab the ID out of it and jam</font>

308
00:11:32,070 --> 00:11:36,300
it<font color="#E5E5E5"> into our to do so</font><font color="#CCCCCC"> yeh this</font><font color="#E5E5E5"> it's</font>

309
00:11:34,920 --> 00:11:38,420
portable<font color="#CCCCCC"> I don't have to go back</font><font color="#E5E5E5"> to the</font>

310
00:11:36,300 --> 00:11:42,510
user<font color="#E5E5E5"> API to figure this junk out anymore</font>

311
00:11:38,420 --> 00:11:45,269
cool<font color="#CCCCCC"> alright so in the because we</font><font color="#E5E5E5"> have</font>

312
00:11:42,510 --> 00:11:48,269
short time I<font color="#E5E5E5"> can show code or I can skip</font>

313
00:11:45,269 --> 00:11:51,269
it<font color="#CCCCCC"> it snowed</font><font color="#E5E5E5"> so I apologize for that</font>

314
00:11:48,269 --> 00:11:52,380
first and<font color="#E5E5E5"> foremost but I can show code</font>

315
00:11:51,269 --> 00:11:56,149
if you guys want<font color="#CCCCCC"> I'll just</font><font color="#E5E5E5"> skip</font><font color="#CCCCCC"> it and</font>

316
00:11:52,380 --> 00:11:59,250
keep trucking<font color="#E5E5E5"> along show of hands</font><font color="#CCCCCC"> code</font>

317
00:11:56,149 --> 00:12:00,720
<font color="#CCCCCC">okay not enough</font><font color="#E5E5E5"> sorry if you want to see</font>

318
00:11:59,250 --> 00:12:02,490
code come<font color="#E5E5E5"> and see me afterwards I'll</font>

319
00:12:00,720 --> 00:12:04,230
show you<font color="#E5E5E5"> good it's this stuff's really</font>

320
00:12:02,490 --> 00:12:05,730
really straightforward and<font color="#CCCCCC"> we like</font><font color="#E5E5E5"> you</font>

321
00:12:04,230 --> 00:12:06,899
can parse<font color="#CCCCCC"> jots and do a lot of</font><font color="#E5E5E5"> things</font>

322
00:12:05,730 --> 00:12:08,360
with them<font color="#CCCCCC"> just write in JavaScript and</font>

323
00:12:06,899 --> 00:12:11,370
very few lines of<font color="#CCCCCC"> code</font>

324
00:12:08,360 --> 00:12:12,600
<font color="#E5E5E5">okay let's quickly talk</font><font color="#CCCCCC"> about some of</font>

325
00:12:11,370 --> 00:12:14,100
<font color="#E5E5E5">the hacks</font><font color="#CCCCCC"> cuz these are the ones that</font>

326
00:12:12,600 --> 00:12:16,260
<font color="#E5E5E5">everybody complains about they're like</font>

327
00:12:14,100 --> 00:12:18,079
Oh<font color="#E5E5E5"> jots are insecure</font><font color="#CCCCCC"> like no they're not</font>

328
00:12:16,260 --> 00:12:20,490
only if you're an idiot

329
00:12:18,079 --> 00:12:21,959
<font color="#CCCCCC">alright so one of the biggest hacks that</font>

330
00:12:20,490 --> 00:12:23,670
people talk about<font color="#E5E5E5"> is this</font><font color="#CCCCCC"> none algorithm</font>

331
00:12:21,959 --> 00:12:25,500
I don't know why<font color="#E5E5E5"> this Beck decided that</font>

332
00:12:23,670 --> 00:12:27,329
<font color="#CCCCCC">this was okay but they did</font><font color="#E5E5E5"> basically</font>

333
00:12:25,500 --> 00:12:29,459
<font color="#E5E5E5">what you can do is you can say that your</font>

334
00:12:27,329 --> 00:12:33,180
algorithm<font color="#E5E5E5"> is none and then not have a</font>

335
00:12:29,459 --> 00:12:35,939
<font color="#E5E5E5">signature I think they did that because</font>

336
00:12:33,180 --> 00:12:38,010
<font color="#E5E5E5">they wanted a standardized format that's</font>

337
00:12:35,940 --> 00:12:40,740
not JSON but<font color="#E5E5E5"> Jason I don't</font><font color="#CCCCCC"> know I mean</font>

338
00:12:38,010 --> 00:12:42,180
it's it boggles the mind<font color="#E5E5E5"> and so here's</font>

339
00:12:40,740 --> 00:12:45,180
what<font color="#CCCCCC"> it looks like so I'm gonna take my</font>

340
00:12:42,180 --> 00:12:49,260
signature<font color="#E5E5E5"> I'm gonna rip it off I'm gonna</font>

341
00:12:45,180 --> 00:12:52,199
go to<font color="#CCCCCC"> my header change it</font><font color="#E5E5E5"> to none</font>

342
00:12:49,260 --> 00:12:55,230
<font color="#CCCCCC">Riaan</font><font color="#E5E5E5"> code it jam it</font><font color="#CCCCCC"> back on</font><font color="#E5E5E5"> and I have</font>

343
00:12:52,199 --> 00:12:57,750
a valid<font color="#E5E5E5"> job</font><font color="#CCCCCC"> alright</font><font color="#E5E5E5"> so don't do this</font>

344
00:12:55,230 --> 00:13:01,230
<font color="#CCCCCC">just don't</font><font color="#E5E5E5"> allow none and</font><font color="#CCCCCC"> super simple</font>

345
00:12:57,750 --> 00:13:06,120
<font color="#CCCCCC">if none</font><font color="#E5E5E5"> throw exception right just don't</font>

346
00:13:01,230 --> 00:13:09,820
do that<font color="#E5E5E5"> okay</font>

347
00:13:06,120 --> 00:13:11,890
other<font color="#CCCCCC"> J JWT hacks so there's this H</font><font color="#E5E5E5"> Mac</font>

348
00:13:09,820 --> 00:13:14,740
hack that's<font color="#E5E5E5"> kind of interesting</font><font color="#CCCCCC"> and the</font>

349
00:13:11,890 --> 00:13:17,230
way it works is<font color="#E5E5E5"> H Mac uses a shared</font>

350
00:13:14,740 --> 00:13:19,360
secret<font color="#CCCCCC"> all right so it's basically a</font>

351
00:13:17,230 --> 00:13:21,820
password<font color="#CCCCCC"> that</font><font color="#E5E5E5"> you know and I know and so</font>

352
00:13:19,360 --> 00:13:23,920
I sign it with the<font color="#E5E5E5"> password</font><font color="#CCCCCC"> that I know</font>

353
00:13:21,820 --> 00:13:25,890
I give it to you<font color="#E5E5E5"> and you can verify it</font>

354
00:13:23,920 --> 00:13:28,500
with<font color="#E5E5E5"> the password that you know as well</font>

355
00:13:25,890 --> 00:13:30,939
one<font color="#E5E5E5"> of the downsides</font><font color="#CCCCCC"> with H Mac is that</font>

356
00:13:28,500 --> 00:13:34,870
anyone<font color="#E5E5E5"> who can verify a job can also</font>

357
00:13:30,940 --> 00:13:36,040
<font color="#CCCCCC">create a job right so if</font><font color="#E5E5E5"> I have the</font>

358
00:13:34,870 --> 00:13:38,080
secret I can just start<font color="#E5E5E5"> creating jobs</font>

359
00:13:36,040 --> 00:13:39,819
<font color="#E5E5E5">even though</font><font color="#CCCCCC"> I may not</font><font color="#E5E5E5"> or you know I</font>

360
00:13:38,080 --> 00:13:42,640
shouldn't<font color="#E5E5E5"> be allowed to do that</font><font color="#CCCCCC"> that</font>

361
00:13:39,820 --> 00:13:44,950
might be<font color="#CCCCCC"> a</font><font color="#E5E5E5"> bad idea well there's a</font>

362
00:13:42,640 --> 00:13:48,689
really<font color="#E5E5E5"> interesting little hack</font><font color="#CCCCCC"> if you</font>

363
00:13:44,950 --> 00:13:51,610
decide to<font color="#E5E5E5"> pass a job back to someone and</font>

364
00:13:48,690 --> 00:13:54,490
in the header<font color="#CCCCCC"> you can tell them which</font>

365
00:13:51,610 --> 00:13:55,810
key to use to<font color="#CCCCCC"> verify it and it comes</font>

366
00:13:54,490 --> 00:14:00,670
through<font color="#CCCCCC"> and a header parameter called K</font>

367
00:13:55,810 --> 00:14:02,410
ID<font color="#CCCCCC"> and what K ID is basically</font><font color="#E5E5E5"> it's just</font>

368
00:14:00,670 --> 00:14:04,569
<font color="#E5E5E5">a string and it says this is the</font><font color="#CCCCCC"> key I</font>

369
00:14:02,410 --> 00:14:09,699
<font color="#E5E5E5">want you to use so what you can do is</font>

370
00:14:04,570 --> 00:14:13,780
you<font color="#E5E5E5"> can actually go and pass in the</font>

371
00:14:09,700 --> 00:14:16,420
signature<font color="#CCCCCC"> as the key ID</font><font color="#E5E5E5"> so let me show</font>

372
00:14:13,780 --> 00:14:23,920
<font color="#CCCCCC">you what it looks like</font><font color="#E5E5E5"> okay so here's</font>

373
00:14:16,420 --> 00:14:25,839
our header right<font color="#CCCCCC"> right alright so here's</font>

374
00:14:23,920 --> 00:14:27,250
the<font color="#E5E5E5"> header and it's telling us that</font>

375
00:14:25,840 --> 00:14:29,590
we're gonna<font color="#E5E5E5"> use an RSA public key</font>

376
00:14:27,250 --> 00:14:32,230
private key<font color="#E5E5E5"> so what I can do is I can</font>

377
00:14:29,590 --> 00:14:36,100
actually<font color="#E5E5E5"> just</font><font color="#CCCCCC"> go</font><font color="#E5E5E5"> look up the public key</font>

378
00:14:32,230 --> 00:14:39,250
<font color="#E5E5E5">grab it as a string and then</font><font color="#CCCCCC"> I can tell</font>

379
00:14:36,100 --> 00:14:42,190
<font color="#E5E5E5">the backend to</font><font color="#CCCCCC"> use that string</font><font color="#E5E5E5"> as the</font>

380
00:14:39,250 --> 00:14:45,010
<font color="#E5E5E5">shared</font><font color="#CCCCCC"> h max secret so what I'll do is</font>

381
00:14:42,190 --> 00:14:47,200
<font color="#CCCCCC">I'll just change the jot</font><font color="#E5E5E5"> re-sign it with</font>

382
00:14:45,010 --> 00:14:49,120
this text<font color="#CCCCCC"> right here</font><font color="#E5E5E5"> being our H</font><font color="#CCCCCC"> max</font>

383
00:14:47,200 --> 00:14:52,030
shared secret<font color="#CCCCCC"> cuz remember</font><font color="#E5E5E5"> these are</font>

384
00:14:49,120 --> 00:14:54,370
just<font color="#E5E5E5"> big strings and then I rescind the</font>

385
00:14:52,030 --> 00:14:56,530
<font color="#CCCCCC">JA after I've mangled it</font><font color="#E5E5E5"> pass it</font><font color="#CCCCCC"> back</font>

386
00:14:54,370 --> 00:14:59,680
<font color="#CCCCCC">and I say hey by the way here's your key</font>

387
00:14:56,530 --> 00:15:00,850
ID which is the<font color="#E5E5E5"> public key right so</font>

388
00:14:59,680 --> 00:15:02,349
there's a<font color="#E5E5E5"> little bit tricky so really</font>

389
00:15:00,850 --> 00:15:06,460
the only<font color="#E5E5E5"> thing</font><font color="#CCCCCC"> I have</font><font color="#E5E5E5"> to change is</font><font color="#CCCCCC"> that</font>

390
00:15:02,350 --> 00:15:08,170
the algorithm in the header so<font color="#CCCCCC"> is if</font>

391
00:15:06,460 --> 00:15:10,780
it's kind<font color="#CCCCCC"> of confusing because it kind</font>

392
00:15:08,170 --> 00:15:12,250
of is<font color="#E5E5E5"> um I can show you afterwards or</font>

393
00:15:10,780 --> 00:15:14,740
there's a<font color="#E5E5E5"> lot of documentation on this</font>

394
00:15:12,250 --> 00:15:16,180
and so the key<font color="#CCCCCC"> here is when you're</font><font color="#E5E5E5"> going</font>

395
00:15:14,740 --> 00:15:17,980
<font color="#E5E5E5">to look up the key that you're trying to</font>

396
00:15:16,180 --> 00:15:19,300
<font color="#CCCCCC">verify a job with make sure</font><font color="#E5E5E5"> it's the</font>

397
00:15:17,980 --> 00:15:21,610
same<font color="#E5E5E5"> type that you</font>

398
00:15:19,300 --> 00:15:23,859
defined as your algorithm<font color="#E5E5E5"> so it's a</font>

399
00:15:21,610 --> 00:15:27,310
<font color="#E5E5E5">really simple</font><font color="#CCCCCC"> fix if you have a hash of</font>

400
00:15:23,860 --> 00:15:29,380
keys<font color="#E5E5E5"> or shared secrets or whatever they</font>

401
00:15:27,310 --> 00:15:32,949
might be<font color="#E5E5E5"> when you look it up just have a</font>

402
00:15:29,380 --> 00:15:35,019
type with it so you say key<font color="#E5E5E5"> 52 well I'm</font>

403
00:15:32,950 --> 00:15:37,060
expecting it to be<font color="#CCCCCC"> a CH Mac is it H Mac</font>

404
00:15:35,019 --> 00:15:41,560
<font color="#CCCCCC">no it's supposed to be</font><font color="#E5E5E5"> RSA just reject</font>

405
00:15:37,060 --> 00:15:44,709
<font color="#E5E5E5">that job</font><font color="#CCCCCC"> three</font><font color="#E5E5E5"> straight board all right</font>

406
00:15:41,560 --> 00:15:45,930
RSA<font color="#E5E5E5"> Val verification so there's a number</font>

407
00:15:44,709 --> 00:15:48,670
<font color="#E5E5E5">of</font><font color="#CCCCCC"> different ways to do this</font>

408
00:15:45,930 --> 00:15:51,670
the<font color="#E5E5E5"> to do API needs to</font><font color="#CCCCCC"> verify this</font><font color="#E5E5E5"> job</font>

409
00:15:48,670 --> 00:15:53,680
right so we need to get<font color="#E5E5E5"> that dude</font><font color="#CCCCCC"> the</font>

410
00:15:51,670 --> 00:15:55,990
public key<font color="#E5E5E5"> so what we could do is</font><font color="#CCCCCC"> we</font>

411
00:15:53,680 --> 00:16:00,130
could<font color="#E5E5E5"> just drop it as a file on that box</font>

412
00:15:55,990 --> 00:16:02,740
<font color="#E5E5E5">it's pretty easy we could write an API</font>

413
00:16:00,130 --> 00:16:06,700
<font color="#E5E5E5">where they can go look it up</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> cache</font>

414
00:16:02,740 --> 00:16:11,860
it<font color="#E5E5E5"> and they open ID</font><font color="#CCCCCC"> SPECT defines these</font>

415
00:16:06,700 --> 00:16:13,269
as well<font color="#E5E5E5"> so it's called a well known you</font>

416
00:16:11,860 --> 00:16:15,070
<font color="#E5E5E5">can hit the</font><font color="#CCCCCC"> well known API and</font><font color="#E5E5E5"> open ID</font>

417
00:16:13,269 --> 00:16:19,300
connect you know send you back where

418
00:16:15,070 --> 00:16:22,420
<font color="#E5E5E5">your keys</font><font color="#CCCCCC"> are all right</font><font color="#E5E5E5"> so here's what</font>

419
00:16:19,300 --> 00:16:24,939
<font color="#E5E5E5">they might look like right public key is</font>

420
00:16:22,420 --> 00:16:27,610
<font color="#E5E5E5">just JSON maybe so when I go hit</font><font color="#CCCCCC"> that</font>

421
00:16:24,940 --> 00:16:29,920
API to get<font color="#E5E5E5"> my keys I get a key back and</font>

422
00:16:27,610 --> 00:16:31,990
it<font color="#E5E5E5"> just comes back as JSON then I cashed</font>

423
00:16:29,920 --> 00:16:33,550
<font color="#E5E5E5">that and then I can</font><font color="#CCCCCC"> use that to</font><font color="#E5E5E5"> verify</font>

424
00:16:31,990 --> 00:16:37,209
<font color="#CCCCCC">giass that are coming in</font><font color="#E5E5E5"> just verify the</font>

425
00:16:33,550 --> 00:16:38,740
RSA signature cool<font color="#E5E5E5"> all right so what</font>

426
00:16:37,209 --> 00:16:40,479
happens if you have multiple keys<font color="#E5E5E5"> you</font>

427
00:16:38,740 --> 00:16:43,630
might want to rotate<font color="#CCCCCC"> your keys keys</font>

428
00:16:40,480 --> 00:16:45,760
might expire whatever we talked a little

429
00:16:43,630 --> 00:16:47,770
bit about this in the hack section but

430
00:16:45,760 --> 00:16:51,700
all you do is you add a new header<font color="#E5E5E5"> color</font>

431
00:16:47,770 --> 00:16:53,410
<font color="#CCCCCC">K ID and I just said</font><font color="#E5E5E5"> 42 and that just</font>

432
00:16:51,700 --> 00:16:55,779
<font color="#E5E5E5">tells me which key I need to go look up</font>

433
00:16:53,410 --> 00:16:58,029
and again so remember when you go look

434
00:16:55,779 --> 00:17:00,250
up this key ID<font color="#E5E5E5"> make sure that it's an</font>

435
00:16:58,029 --> 00:17:04,660
RSA key<font color="#E5E5E5"> and people aren't hacking you by</font>

436
00:17:00,250 --> 00:17:06,699
swapping out keys and here's what your

437
00:17:04,660 --> 00:17:08,350
JSON might look like from either a

438
00:17:06,699 --> 00:17:09,550
well-known or you can write these api's

439
00:17:08,349 --> 00:17:11,050
yourself<font color="#E5E5E5"> that's really</font><font color="#CCCCCC"> straightforward</font>

440
00:17:09,550 --> 00:17:12,309
right you can store<font color="#CCCCCC"> your keys in a</font>

441
00:17:11,050 --> 00:17:15,448
database<font color="#E5E5E5"> and</font><font color="#CCCCCC"> then just return the public</font>

442
00:17:12,309 --> 00:17:15,449
use<font color="#E5E5E5"> being</font><font color="#CCCCCC"> API</font>

443
00:17:16,480 --> 00:17:23,380
<font color="#E5E5E5">any questions that's far pause really</font>

444
00:17:18,790 --> 00:17:25,389
<font color="#E5E5E5">quick cool</font><font color="#CCCCCC"> we are cranking we might</font>

445
00:17:23,380 --> 00:17:28,510
actually finish my slides<font color="#E5E5E5"> then we</font><font color="#CCCCCC"> can</font>

446
00:17:25,390 --> 00:17:45,880
look<font color="#E5E5E5"> at some code if you want sweet</font><font color="#CCCCCC"> okay</font>

447
00:17:28,510 --> 00:17:49,299
yeah<font color="#CCCCCC"> yeah most people don't</font><font color="#E5E5E5"> implement</font>

448
00:17:45,880 --> 00:17:50,710
that<font color="#E5E5E5"> stuff</font><font color="#CCCCCC"> I don't know we</font><font color="#E5E5E5"> don't we</font>

449
00:17:49,299 --> 00:17:53,410
don't actually implement<font color="#E5E5E5"> that right now</font>

450
00:17:50,710 --> 00:17:55,030
either<font color="#E5E5E5"> so yeah I think it's</font><font color="#CCCCCC"> just a lot</font>

451
00:17:53,410 --> 00:17:57,880
of the algorithms are complicated

452
00:17:55,030 --> 00:18:00,340
<font color="#CCCCCC">they're really</font><font color="#E5E5E5"> time-consuming</font><font color="#CCCCCC"> so you</font>

453
00:17:57,880 --> 00:18:02,860
can't implement<font color="#E5E5E5"> it</font><font color="#CCCCCC"> I have another talk</font>

454
00:18:00,340 --> 00:18:04,959
called hack-proof security and<font color="#E5E5E5"> I talked</font>

455
00:18:02,860 --> 00:18:07,090
specifically about<font color="#E5E5E5"> why algorithms</font><font color="#CCCCCC"> should</font>

456
00:18:04,960 --> 00:18:08,890
be slow right<font color="#CCCCCC"> a lot</font><font color="#E5E5E5"> of people</font><font color="#CCCCCC"> don't want</font>

457
00:18:07,090 --> 00:18:10,600
<font color="#CCCCCC">to take</font><font color="#E5E5E5"> the hit</font><font color="#CCCCCC"> of them being slow</font>

458
00:18:08,890 --> 00:18:13,660
so<font color="#E5E5E5"> I'll</font><font color="#CCCCCC"> rabbit-hole for a really quick</font>

459
00:18:10,600 --> 00:18:15,610
second<font color="#E5E5E5"> here we want encryption and</font>

460
00:18:13,660 --> 00:18:18,400
hashing to be as slow as humanly

461
00:18:15,610 --> 00:18:19,809
<font color="#CCCCCC">possible right it's counterintuitive as</font>

462
00:18:18,400 --> 00:18:21,730
developers we want everything<font color="#CCCCCC"> to be fast</font>

463
00:18:19,809 --> 00:18:23,889
as humanly possible<font color="#CCCCCC"> in this case we want</font>

464
00:18:21,730 --> 00:18:27,549
it<font color="#E5E5E5"> to be slow as humanly possible within</font>

465
00:18:23,890 --> 00:18:31,990
<font color="#E5E5E5">reason and the</font><font color="#CCCCCC"> reason being is</font><font color="#E5E5E5"> that if I</font>

466
00:18:27,549 --> 00:18:33,700
give<font color="#E5E5E5"> you a password hash and it takes</font>

467
00:18:31,990 --> 00:18:36,100
you very very<font color="#CCCCCC"> little time to</font><font color="#E5E5E5"> compute</font>

468
00:18:33,700 --> 00:18:39,610
<font color="#CCCCCC">those hashes</font><font color="#E5E5E5"> you can try all possible</font>

469
00:18:36,100 --> 00:18:41,379
combinations<font color="#E5E5E5"> really fast so for example</font>

470
00:18:39,610 --> 00:18:43,830
if I'm using md5 as a hashing algorithm

471
00:18:41,380 --> 00:18:46,600
again don't do this because it's bad and

472
00:18:43,830 --> 00:18:49,870
you have<font color="#CCCCCC"> up to ten characters I think</font>

473
00:18:46,600 --> 00:18:51,730
<font color="#CCCCCC">ten</font><font color="#E5E5E5"> on a Bitcoin rig a modern one you</font>

474
00:18:49,870 --> 00:18:53,799
can crack every single possible

475
00:18:51,730 --> 00:18:58,870
combination<font color="#CCCCCC"> of every password</font><font color="#E5E5E5"> with ten</font>

476
00:18:53,799 --> 00:19:01,840
characters in about 17 minutes with md5

477
00:18:58,870 --> 00:19:03,070
right so these<font color="#E5E5E5"> are that that's why we</font>

478
00:19:01,840 --> 00:19:04,480
want it to be slow if we write an

479
00:19:03,070 --> 00:19:07,000
<font color="#E5E5E5">algorithm that</font><font color="#CCCCCC"> makes</font><font color="#E5E5E5"> our password</font>

480
00:19:04,480 --> 00:19:09,880
hashing really slow like every hash is

481
00:19:07,000 --> 00:19:11,440
taking like<font color="#CCCCCC"> a second</font><font color="#E5E5E5"> then that's good</font>

482
00:19:09,880 --> 00:19:13,450
because<font color="#E5E5E5"> then it'll take infinity time</font>

483
00:19:11,440 --> 00:19:15,190
right and<font color="#E5E5E5"> it's super because these these</font>

484
00:19:13,450 --> 00:19:16,809
numbers are huge it'll take so long<font color="#CCCCCC"> for</font>

485
00:19:15,190 --> 00:19:18,580
the computers to process<font color="#E5E5E5"> and try brute</font>

486
00:19:16,809 --> 00:19:21,910
forcing every single password<font color="#CCCCCC"> variants</font>

487
00:19:18,580 --> 00:19:23,500
so just keep that<font color="#CCCCCC"> in mind that's</font><font color="#E5E5E5"> why a</font>

488
00:19:21,910 --> 00:19:27,100
lot<font color="#CCCCCC"> of</font><font color="#E5E5E5"> people aren't implementing them</font>

489
00:19:23,500 --> 00:19:29,830
<font color="#E5E5E5">is the complexity is high and there's</font>

490
00:19:27,100 --> 00:19:30,010
really<font color="#CCCCCC"> slow but it's it's good that</font>

491
00:19:29,830 --> 00:19:31,810
<font color="#E5E5E5">there</font>

492
00:19:30,010 --> 00:19:33,629
<font color="#CCCCCC">Wow</font><font color="#E5E5E5"> so that's why if some people</font><font color="#CCCCCC"> do it</font>

493
00:19:31,810 --> 00:19:36,639
because<font color="#CCCCCC"> they need</font><font color="#E5E5E5"> that level of security</font>

494
00:19:33,630 --> 00:19:38,440
so slow is good<font color="#E5E5E5"> except when you're like</font>

495
00:19:36,640 --> 00:19:39,430
<font color="#E5E5E5">you know trying to lock somebody in to</font>

496
00:19:38,440 --> 00:19:40,750
get them to play<font color="#E5E5E5"> a game or something</font>

497
00:19:39,430 --> 00:19:42,910
<font color="#CCCCCC">then you</font><font color="#E5E5E5"> want to get them in as quickly</font>

498
00:19:40,750 --> 00:19:45,510
as possible<font color="#CCCCCC"> so there's a balance between</font>

499
00:19:42,910 --> 00:19:49,260
<font color="#E5E5E5">speed and usability</font>

500
00:19:45,510 --> 00:19:49,260
<font color="#E5E5E5">all right so yep</font>

501
00:20:00,999 --> 00:20:14,229
yep oh yeah they can<font color="#E5E5E5"> DDoS the hell out</font>

502
00:20:03,789 --> 00:20:16,209
of here it is they can be<font color="#CCCCCC"> Dawson</font><font color="#E5E5E5"> yeah</font>

503
00:20:14,229 --> 00:20:18,869
<font color="#CCCCCC">absolutely yeah you</font><font color="#E5E5E5"> and we've seen that</font>

504
00:20:16,209 --> 00:20:22,179
<font color="#CCCCCC">before we've seen</font><font color="#E5E5E5"> machines get totally</font>

505
00:20:18,869 --> 00:20:24,639
crushed by just doing token verification

506
00:20:22,179 --> 00:20:27,219
<font color="#E5E5E5">or like password hashing so if you're</font>

507
00:20:24,639 --> 00:20:28,678
using<font color="#E5E5E5"> like a</font><font color="#CCCCCC"> be crip 13 or</font><font color="#E5E5E5"> 14 right now</font>

508
00:20:27,219 --> 00:20:31,089
which<font color="#E5E5E5"> is</font><font color="#CCCCCC"> really heavy</font>

509
00:20:28,679 --> 00:20:33,129
all you need to<font color="#CCCCCC"> do is just log into</font><font color="#E5E5E5"> a</font>

510
00:20:31,089 --> 00:20:34,829
bank of machines<font color="#E5E5E5"> every couple</font>

511
00:20:33,129 --> 00:20:40,688
milliseconds<font color="#E5E5E5"> and you'll you'll crush it</font>

512
00:20:34,829 --> 00:20:43,418
<font color="#E5E5E5">because bcrypt is really slow cool all</font>

513
00:20:40,689 --> 00:20:46,809
<font color="#E5E5E5">right so refresh tokens so we have our</font>

514
00:20:43,419 --> 00:20:48,219
<font color="#CCCCCC">jots right jots are are now our coolness</font>

515
00:20:46,809 --> 00:20:50,139
that<font color="#CCCCCC"> we</font><font color="#E5E5E5"> can pass</font><font color="#CCCCCC"> around we can verify</font>

516
00:20:48,219 --> 00:20:51,549
them when we get data<font color="#E5E5E5"> out of them but</font>

517
00:20:50,139 --> 00:20:53,139
they're supposed<font color="#CCCCCC"> to be short-lived</font>

518
00:20:51,549 --> 00:20:54,729
<font color="#E5E5E5">and the reason being is that they</font>

519
00:20:53,139 --> 00:20:57,668
because they're<font color="#E5E5E5"> a portable unit of</font>

520
00:20:54,729 --> 00:21:01,029
identity<font color="#CCCCCC"> they're you well you might have</font>

521
00:20:57,669 --> 00:21:03,519
changed over<font color="#E5E5E5"> time so that job becomes</font>

522
00:21:01,029 --> 00:21:05,469
invalid and the<font color="#E5E5E5"> job can't be updated it</font>

523
00:21:03,519 --> 00:21:07,419
needs to be a new<font color="#E5E5E5"> one needs to be</font>

524
00:21:05,469 --> 00:21:09,789
<font color="#E5E5E5">created so</font><font color="#CCCCCC"> the way that most people do</font>

525
00:21:07,419 --> 00:21:11,889
this is through refresh tokens<font color="#CCCCCC"> jots are</font>

526
00:21:09,789 --> 00:21:14,049
designed to be to live<font color="#CCCCCC"> for minutes</font><font color="#E5E5E5"> some</font>

527
00:21:11,889 --> 00:21:16,958
people do it for seconds yeah whatever

528
00:21:14,049 --> 00:21:18,189
<font color="#E5E5E5">your flavor</font><font color="#CCCCCC"> is and then</font><font color="#E5E5E5"> refresh tokens</font>

529
00:21:16,959 --> 00:21:21,489
are the<font color="#CCCCCC"> long-lived things right so</font>

530
00:21:18,189 --> 00:21:23,109
<font color="#E5E5E5">refresh tokens need to be secured more</font>

531
00:21:21,489 --> 00:21:24,669
<font color="#E5E5E5">than anything else in your entire system</font>

532
00:21:23,109 --> 00:21:27,639
<font color="#E5E5E5">because they're the thing that are</font>

533
00:21:24,669 --> 00:21:30,309
that's you and it also allows somebody

534
00:21:27,639 --> 00:21:34,688
<font color="#E5E5E5">that has</font><font color="#CCCCCC"> that to create tokens as you</font>

535
00:21:30,309 --> 00:21:37,059
and do things as you<font color="#E5E5E5"> okay so here's what</font>

536
00:21:34,689 --> 00:21:39,609
it<font color="#E5E5E5"> looks</font><font color="#CCCCCC"> like really</font><font color="#E5E5E5"> quick so now back</font>

537
00:21:37,059 --> 00:21:43,359
<font color="#CCCCCC">in the user API</font><font color="#E5E5E5"> we create a token a</font>

538
00:21:39,609 --> 00:21:45,158
refresh token<font color="#CCCCCC"> and a JSON web token oh by</font>

539
00:21:43,359 --> 00:21:46,329
the way<font color="#E5E5E5"> so and I'm</font><font color="#CCCCCC"> sure you all know</font>

540
00:21:45,159 --> 00:21:48,129
this<font color="#CCCCCC"> but it's called</font><font color="#E5E5E5"> jawed and that's</font>

541
00:21:46,329 --> 00:21:50,908
<font color="#CCCCCC">actually defined</font><font color="#E5E5E5"> in the spec so new year</font>

542
00:21:48,129 --> 00:21:53,498
people say<font color="#E5E5E5"> jawed it's a JSON web token</font>

543
00:21:50,909 --> 00:21:54,819
<font color="#E5E5E5">okay so the server is gonna manage these</font>

544
00:21:53,499 --> 00:21:56,099
refresh tokens you can<font color="#E5E5E5"> store them the</font>

545
00:21:54,819 --> 00:21:58,239
database<font color="#E5E5E5"> can store them in memory</font>

546
00:21:56,099 --> 00:22:00,009
<font color="#E5E5E5">whatever but it's gonna send that</font>

547
00:21:58,239 --> 00:22:02,499
<font color="#CCCCCC">Refresh token back and that Refresh</font>

548
00:22:00,009 --> 00:22:05,769
<font color="#CCCCCC">token needs to</font><font color="#E5E5E5"> be locked to that device</font>

549
00:22:02,499 --> 00:22:06,909
<font color="#CCCCCC">it has to</font><font color="#E5E5E5"> be super secured</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> just keep</font>

550
00:22:05,769 --> 00:22:08,739
that<font color="#CCCCCC"> in</font><font color="#E5E5E5"> mind when you're sending</font><font color="#CCCCCC"> Refresh</font>

551
00:22:06,909 --> 00:22:11,429
tokens back use the<font color="#CCCCCC"> most secure</font>

552
00:22:08,739 --> 00:22:11,429
transport you<font color="#CCCCCC"> can</font>

553
00:22:22,980 --> 00:22:26,919
yeah so don't start anything in local

554
00:22:25,120 --> 00:22:30,370
storage it's really insecure<font color="#CCCCCC"> and</font><font color="#E5E5E5"> like</font><font color="#CCCCCC"> a</font>

555
00:22:26,919 --> 00:22:34,140
really insecure<font color="#CCCCCC"> store it in</font><font color="#E5E5E5"> secure</font>

556
00:22:30,370 --> 00:22:35,408
cookies<font color="#E5E5E5"> right because then you you get</font>

557
00:22:34,140 --> 00:22:37,210
yep

558
00:22:35,409 --> 00:22:39,039
stick the JWT and<font color="#CCCCCC"> the</font><font color="#E5E5E5"> Refresh token in a</font>

559
00:22:37,210 --> 00:22:40,779
cookie<font color="#E5E5E5"> so just like hit Facebook or</font>

560
00:22:39,039 --> 00:22:41,970
<font color="#CCCCCC">Google+ which</font><font color="#E5E5E5"> is going to die sooner</font>

561
00:22:40,779 --> 00:22:44,649
<font color="#CCCCCC">where you know whatever</font><font color="#E5E5E5"> your flavor is</font>

562
00:22:41,970 --> 00:22:46,240
<font color="#CCCCCC">and</font><font color="#E5E5E5"> just open up</font><font color="#CCCCCC"> your inspector and</font>

563
00:22:44,649 --> 00:22:48,039
you'll see all your cookies<font color="#E5E5E5"> and they</font>

564
00:22:46,240 --> 00:22:50,010
name them like a bunch<font color="#E5E5E5"> of</font><font color="#CCCCCC"> random things</font>

565
00:22:48,039 --> 00:22:52,299
<font color="#CCCCCC">they also have a seesaw Oken in there</font>

566
00:22:50,010 --> 00:22:54,669
<font color="#CCCCCC">but you'll see</font><font color="#E5E5E5"> them and you'll have a</font>

567
00:22:52,299 --> 00:22:56,350
<font color="#E5E5E5">refresh token basically a jot</font><font color="#CCCCCC"> like</font>

568
00:22:54,669 --> 00:22:58,679
<font color="#CCCCCC">google uses jots</font><font color="#E5E5E5"> Facebook doesn't</font>

569
00:22:56,350 --> 00:23:01,360
Twitter doesn't<font color="#E5E5E5"> either</font>

570
00:22:58,679 --> 00:23:03,909
you can<font color="#CCCCCC"> start a JWT in a cookie</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> can</font>

571
00:23:01,360 --> 00:23:09,840
<font color="#E5E5E5">store the JWT in local storage it</font>

572
00:23:03,909 --> 00:23:09,840
depends on your tolerance<font color="#E5E5E5"> for security</font>

573
00:23:18,530 --> 00:23:23,180
yep<font color="#E5E5E5"> yeah so I mean you you get it for</font>

574
00:23:21,740 --> 00:23:24,290
<font color="#E5E5E5">free when you're making Ajax requests or</font>

575
00:23:23,180 --> 00:23:26,000
you're making<font color="#E5E5E5"> requests of</font><font color="#CCCCCC"> the server</font>

576
00:23:24,290 --> 00:23:28,070
<font color="#E5E5E5">right the cookies just fly across and</font>

577
00:23:26,000 --> 00:23:29,720
<font color="#E5E5E5">that's just part of the browser which is</font>

578
00:23:28,070 --> 00:23:31,669
<font color="#CCCCCC">which is why most people</font><font color="#E5E5E5"> store them in</font>

579
00:23:29,720 --> 00:23:33,020
secure cookies<font color="#CCCCCC"> so they are not hackable</font>

580
00:23:31,670 --> 00:23:35,780
you can't get to them from<font color="#E5E5E5"> JavaScript</font>

581
00:23:33,020 --> 00:23:39,620
<font color="#E5E5E5">now some folks put them in</font><font color="#CCCCCC"> local storage</font>

582
00:23:35,780 --> 00:23:41,240
<font color="#E5E5E5">and so the kicker there is that</font><font color="#CCCCCC"> unn</font>

583
00:23:39,620 --> 00:23:42,649
verified<font color="#CCCCCC"> javascript and you know</font>

584
00:23:41,240 --> 00:23:44,360
<font color="#E5E5E5">javascript that came from a</font><font color="#CCCCCC"> cross-site</font>

585
00:23:42,650 --> 00:23:46,190
<font color="#E5E5E5">can now get at your local storage</font>

586
00:23:44,360 --> 00:23:48,919
<font color="#E5E5E5">because it's not secure and it's not</font>

587
00:23:46,190 --> 00:23:50,720
<font color="#E5E5E5">local only so there's reasons why you</font>

588
00:23:48,920 --> 00:23:53,290
might<font color="#CCCCCC"> want to do</font><font color="#E5E5E5"> that for</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> period of</font>

589
00:23:50,720 --> 00:23:55,580
<font color="#E5E5E5">time and then move it out or something</font>

590
00:23:53,290 --> 00:23:57,230
<font color="#CCCCCC">pardon me</font><font color="#E5E5E5"> jobs are way better because</font>

591
00:23:55,580 --> 00:23:58,189
they're short-lived right so<font color="#E5E5E5"> eventually</font>

592
00:23:57,230 --> 00:23:58,660
they're gonna expire and then<font color="#E5E5E5"> they're</font>

593
00:23:58,190 --> 00:24:01,250
worthless

594
00:23:58,660 --> 00:24:02,600
<font color="#E5E5E5">so it's it's better to if you're gonna</font>

595
00:24:01,250 --> 00:24:05,510
put anything in local storage<font color="#CCCCCC"> put the</font>

596
00:24:02,600 --> 00:24:08,469
job don't put the<font color="#CCCCCC"> Refresh token</font><font color="#E5E5E5"> and then</font>

597
00:24:05,510 --> 00:24:11,800
put it in secure<font color="#CCCCCC"> storage on mobile yep</font>

598
00:24:08,470 --> 00:24:11,800
sorry<font color="#CCCCCC"> what was that</font>

599
00:24:12,280 --> 00:24:18,410
yeah<font color="#E5E5E5"> authorization headers yeah so you</font>

600
00:24:17,240 --> 00:24:20,210
know<font color="#E5E5E5"> when you're making calls back you</font>

601
00:24:18,410 --> 00:24:21,260
can use<font color="#E5E5E5"> an auth header but that would</font>

602
00:24:20,210 --> 00:24:23,780
force you to store it somewhere<font color="#E5E5E5"> that</font>

603
00:24:21,260 --> 00:24:25,450
<font color="#E5E5E5">JavaScript and get at it like local</font>

604
00:24:23,780 --> 00:24:28,310
<font color="#CCCCCC">storage all right so</font><font color="#E5E5E5"> just be careful</font>

605
00:24:25,450 --> 00:24:31,790
<font color="#CCCCCC">right so like there's a lot of ways to</font>

606
00:24:28,310 --> 00:24:33,649
do<font color="#E5E5E5"> this there's</font><font color="#CCCCCC"> no standard so just make</font>

607
00:24:31,790 --> 00:24:35,090
good decisions based<font color="#CCCCCC"> on what you know</font>

608
00:24:33,650 --> 00:24:39,620
about<font color="#CCCCCC"> the security semantics of a</font>

609
00:24:35,090 --> 00:24:41,830
browser cookies headers<font color="#E5E5E5"> Ajax secure</font>

610
00:24:39,620 --> 00:24:43,969
storage<font color="#E5E5E5"> on mobile whatever it might be</font>

611
00:24:41,830 --> 00:24:45,860
<font color="#CCCCCC">key chains</font><font color="#E5E5E5"> like you can open up</font>

612
00:24:43,970 --> 00:24:48,590
somebody's<font color="#CCCCCC"> key chain</font><font color="#E5E5E5"> store it in there</font>

613
00:24:45,860 --> 00:24:51,409
get it out totally fine<font color="#E5E5E5"> because</font><font color="#CCCCCC"> that</font>

614
00:24:48,590 --> 00:24:53,000
<font color="#E5E5E5">that's a secure storage and face ID or</font>

615
00:24:51,410 --> 00:24:58,630
touch ID or whatever<font color="#CCCCCC"> you know</font><font color="#E5E5E5"> unlock</font>

616
00:24:53,000 --> 00:24:58,630
<font color="#E5E5E5">that so any other questions</font><font color="#CCCCCC"> yeah</font>

617
00:25:04,060 --> 00:25:21,470
<font color="#E5E5E5">all right yeah yep okay so revocation</font>

618
00:25:18,760 --> 00:25:25,910
<font color="#E5E5E5">very nice</font><font color="#CCCCCC"> segue</font><font color="#E5E5E5"> and that's not a plant</font>

619
00:25:21,470 --> 00:25:28,400
at<font color="#E5E5E5"> all</font><font color="#CCCCCC"> so just really</font><font color="#E5E5E5"> quick</font><font color="#CCCCCC"> is a funny</font>

620
00:25:25,910 --> 00:25:29,420
story<font color="#CCCCCC"> first</font><font color="#E5E5E5"> time I did this I</font><font color="#CCCCCC"> was</font>

621
00:25:28,400 --> 00:25:30,800
<font color="#E5E5E5">looking to make</font><font color="#CCCCCC"> sure I spelled</font>

622
00:25:29,420 --> 00:25:32,060
revocation correctly and it<font color="#E5E5E5"> came</font><font color="#CCCCCC"> up with</font>

623
00:25:30,800 --> 00:25:34,220
<font color="#E5E5E5">this death metal band which I thought</font>

624
00:25:32,060 --> 00:25:35,870
was hilarious<font color="#E5E5E5"> and then</font><font color="#CCCCCC"> I did the talk</font>

625
00:25:34,220 --> 00:25:37,970
and the deed<font color="#CCCCCC"> and</font><font color="#E5E5E5"> the audience is like</font>

626
00:25:35,870 --> 00:25:40,100
I'm<font color="#E5E5E5"> going to revocation tonight and I'm</font>

627
00:25:37,970 --> 00:25:41,810
like you're kidding<font color="#CCCCCC"> he's like nope</font>

628
00:25:40,100 --> 00:25:43,189
they're playing<font color="#E5E5E5"> tonight in Denver we're</font>

629
00:25:41,810 --> 00:25:45,800
going I'm<font color="#E5E5E5"> like oh my god</font>

630
00:25:43,190 --> 00:25:47,810
I didn't go<font color="#E5E5E5"> but it's funny</font><font color="#CCCCCC"> alright so</font>

631
00:25:45,800 --> 00:25:49,940
yeah logout API so let me jump really

632
00:25:47,810 --> 00:25:51,770
<font color="#E5E5E5">quick</font><font color="#CCCCCC"> actually through this so the</font><font color="#E5E5E5"> login</font>

633
00:25:49,940 --> 00:25:53,510
OPI just says delete all your tokens

634
00:25:51,770 --> 00:25:56,600
right so<font color="#E5E5E5"> that's an easy one but let's</font>

635
00:25:53,510 --> 00:25:58,640
actually talk<font color="#E5E5E5"> about I'm gonna</font><font color="#CCCCCC"> flash</font>

636
00:25:56,600 --> 00:26:01,520
<font color="#CCCCCC">forward really</font><font color="#E5E5E5"> fast here let's talk</font>

637
00:25:58,640 --> 00:26:03,620
<font color="#E5E5E5">about actual revocation because these</font>

638
00:26:01,520 --> 00:26:05,510
<font color="#E5E5E5">tokens are that you want to expire them</font>

639
00:26:03,620 --> 00:26:07,639
you want them<font color="#E5E5E5"> to be deleted right so</font>

640
00:26:05,510 --> 00:26:08,960
there's<font color="#E5E5E5"> this is</font><font color="#CCCCCC"> impossible according to</font>

641
00:26:07,640 --> 00:26:10,730
the spec and<font color="#E5E5E5"> because they're portable</font>

642
00:26:08,960 --> 00:26:13,040
<font color="#E5E5E5">it's a unit of identity I can send it</font><font color="#CCCCCC"> to</font>

643
00:26:10,730 --> 00:26:15,080
an API<font color="#CCCCCC"> it can validate it it's me it</font>

644
00:26:13,040 --> 00:26:17,420
does something<font color="#E5E5E5"> for me even though my</font>

645
00:26:15,080 --> 00:26:18,590
<font color="#E5E5E5">user might have been</font><font color="#CCCCCC"> deleted</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> we came</font>

646
00:26:17,420 --> 00:26:21,650
<font color="#CCCCCC">up</font><font color="#E5E5E5"> with this</font><font color="#CCCCCC"> really</font><font color="#E5E5E5"> cool little</font><font color="#CCCCCC"> tricky</font>

647
00:26:18,590 --> 00:26:23,959
system<font color="#E5E5E5"> it's really fun what you do is</font>

648
00:26:21,650 --> 00:26:25,790
you basically<font color="#E5E5E5"> set</font><font color="#CCCCCC"> up a web hook when you</font>

649
00:26:23,960 --> 00:26:27,890
delete a refresh token a user or<font color="#CCCCCC"> any of</font>

650
00:26:25,790 --> 00:26:29,300
these things<font color="#CCCCCC"> you send an event to a web</font>

651
00:26:27,890 --> 00:26:31,970
hook<font color="#E5E5E5"> and what it does is it basically</font>

652
00:26:29,300 --> 00:26:35,930
<font color="#E5E5E5">says hey I</font><font color="#CCCCCC"> just revoked things for this</font>

653
00:26:31,970 --> 00:26:37,970
user<font color="#E5E5E5"> right now at this millisecond then</font>

654
00:26:35,930 --> 00:26:39,530
what we can do is we can<font color="#CCCCCC"> start to divide</font>

655
00:26:37,970 --> 00:26:41,330
this up<font color="#E5E5E5"> and figure out the time range</font>

656
00:26:39,530 --> 00:26:43,310
when jots<font color="#E5E5E5"> and refresh tokens become</font>

657
00:26:41,330 --> 00:26:45,620
invalid<font color="#E5E5E5"> okay</font>

658
00:26:43,310 --> 00:26:46,639
following<font color="#E5E5E5"> okay so right now I have an</font>

659
00:26:45,620 --> 00:26:48,949
update<font color="#E5E5E5"> of this in a really long</font><font color="#CCCCCC"> time</font>

660
00:26:46,640 --> 00:26:54,380
apologize let's assume right<font color="#E5E5E5"> now it's</font>

661
00:26:48,950 --> 00:26:56,030
<font color="#CCCCCC">November 9 2017</font><font color="#E5E5E5"> at</font><font color="#CCCCCC"> 1 12:47 p.m. ok and</font>

662
00:26:54,380 --> 00:26:59,660
that's when we<font color="#CCCCCC"> revote</font><font color="#E5E5E5"> that's when that</font>

663
00:26:56,030 --> 00:27:02,120
<font color="#CCCCCC">event comes from the web hook ok any new</font>

664
00:26:59,660 --> 00:27:04,130
job<font color="#CCCCCC"> that we create</font><font color="#E5E5E5"> right now this very</font>

665
00:27:02,120 --> 00:27:05,540
second will expire<font color="#CCCCCC"> 30 minutes from</font><font color="#E5E5E5"> now</font>

666
00:27:04,130 --> 00:27:11,120
<font color="#CCCCCC">because let's just say</font><font color="#E5E5E5"> our jobs last for</font>

667
00:27:05,540 --> 00:27:12,530
30 minutes<font color="#E5E5E5"> good</font><font color="#CCCCCC"> ok one second</font><font color="#E5E5E5"> ago a job</font>

668
00:27:11,120 --> 00:27:14,310
that was created<font color="#E5E5E5"> in one second ago will</font>

669
00:27:12,530 --> 00:27:16,800
expire at this time

670
00:27:14,310 --> 00:27:22,169
<font color="#E5E5E5">one second</font><font color="#CCCCCC"> 30 minutes from</font><font color="#E5E5E5"> now but one</font>

671
00:27:16,800 --> 00:27:25,110
second less<font color="#E5E5E5"> therefore every jot that</font>

672
00:27:22,170 --> 00:27:27,300
expires<font color="#E5E5E5"> before this time is now invalid</font>

673
00:27:25,110 --> 00:27:28,530
<font color="#E5E5E5">so we're just moving the</font><font color="#CCCCCC"> window we're</font>

674
00:27:27,300 --> 00:27:30,149
basically saying you have to you can

675
00:27:28,530 --> 00:27:35,010
only accept<font color="#CCCCCC"> jots when their expiration</font>

676
00:27:30,150 --> 00:27:38,400
is after<font color="#E5E5E5"> that time every following so it</font>

677
00:27:35,010 --> 00:27:40,230
looks<font color="#E5E5E5"> like this so that's our time</font>

678
00:27:38,400 --> 00:27:42,270
window from like you<font color="#E5E5E5"> know again I didn't</font>

679
00:27:40,230 --> 00:27:44,100
update<font color="#E5E5E5"> this sorry</font><font color="#CCCCCC"> um</font><font color="#E5E5E5"> six four twelve</font>

680
00:27:42,270 --> 00:27:46,980
<font color="#E5E5E5">forty seven</font><font color="#CCCCCC"> two</font><font color="#E5E5E5"> six forty two forty</font>

681
00:27:44,100 --> 00:27:48,990
<font color="#E5E5E5">everything in that red is dead even</font>

682
00:27:46,980 --> 00:27:51,210
though the jot themselves are valid and

683
00:27:48,990 --> 00:27:53,670
okay we're just<font color="#CCCCCC"> telling this back</font><font color="#E5E5E5"> ends</font>

684
00:27:51,210 --> 00:27:55,740
<font color="#E5E5E5">just throw it out because we revote them</font>

685
00:27:53,670 --> 00:27:59,700
they're bad everything in the green

686
00:27:55,740 --> 00:28:01,380
that's<font color="#E5E5E5"> been created later is now valid</font>

687
00:27:59,700 --> 00:28:04,200
<font color="#CCCCCC">and everything in the blue has already</font>

688
00:28:01,380 --> 00:28:06,390
expired because<font color="#E5E5E5"> it's before now just</font>

689
00:28:04,200 --> 00:28:08,250
<font color="#CCCCCC">make</font><font color="#E5E5E5"> sense okay so this is kind of a</font>

690
00:28:06,390 --> 00:28:11,340
cool little<font color="#E5E5E5"> trick you hacky way to</font>

691
00:28:08,250 --> 00:28:12,390
revoke jobs there<font color="#E5E5E5"> are a couple of other</font>

692
00:28:11,340 --> 00:28:14,840
ways<font color="#E5E5E5"> you can store them on the</font><font color="#CCCCCC"> servers</font>

693
00:28:12,390 --> 00:28:14,840
<font color="#E5E5E5">happen</font>

694
00:28:31,750 --> 00:28:38,390
yeah you can do<font color="#E5E5E5"> it that way</font>

695
00:28:33,679 --> 00:28:41,210
<font color="#E5E5E5">so we so in our system our IDP</font><font color="#CCCCCC"> we have</font>

696
00:28:38,390 --> 00:28:42,710
three different<font color="#CCCCCC"> ways to do this one of</font>

697
00:28:41,210 --> 00:28:44,779
<font color="#CCCCCC">which is</font><font color="#E5E5E5"> global revoke which forces</font>

698
00:28:42,710 --> 00:28:46,309
<font color="#E5E5E5">everybody out one of</font><font color="#CCCCCC"> which is an</font>

699
00:28:44,779 --> 00:28:48,860
<font color="#CCCCCC">application revoke which basically says</font>

700
00:28:46,309 --> 00:28:50,570
everyone who has a<font color="#E5E5E5"> jot for this app get</font>

701
00:28:48,860 --> 00:28:53,330
out and then the one is a user level

702
00:28:50,570 --> 00:28:54,950
revoke so you get all three<font color="#CCCCCC"> so you could</font>

703
00:28:53,330 --> 00:28:58,158
do<font color="#E5E5E5"> it as granular is just the user if</font>

704
00:28:54,950 --> 00:29:01,390
you wanted to because you know the<font color="#E5E5E5"> users</font>

705
00:28:58,159 --> 00:29:01,390
ID<font color="#CCCCCC"> because it's in the job</font>

706
00:29:15,700 --> 00:29:19,910
that's exactly<font color="#CCCCCC"> correct yep you're</font>

707
00:29:18,080 --> 00:29:21,710
pushing an anti session<font color="#E5E5E5"> out and really</font>

708
00:29:19,910 --> 00:29:25,400
it's really<font color="#CCCCCC"> lightweight it's a user ID</font>

709
00:29:21,710 --> 00:29:32,090
and an int<font color="#CCCCCC"> or a long which is</font><font color="#E5E5E5"> our time</font>

710
00:29:25,400 --> 00:29:34,100
<font color="#E5E5E5">right yes agreed</font><font color="#CCCCCC"> and if they're not</font>

711
00:29:32,090 --> 00:29:36,080
<font color="#E5E5E5">that's why we allow</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> to do it at an</font>

712
00:29:34,100 --> 00:29:38,480
app level<font color="#E5E5E5"> again very because we didn't</font>

713
00:29:36,080 --> 00:29:40,129
<font color="#E5E5E5">want to store 1 million entries in a</font>

714
00:29:38,480 --> 00:29:41,450
hash to figure out all the users that

715
00:29:40,130 --> 00:29:43,640
<font color="#E5E5E5">are evoked just store it at a global</font>

716
00:29:41,450 --> 00:29:46,910
<font color="#E5E5E5">level</font><font color="#CCCCCC"> so you say all tokens are evoked</font>

717
00:29:43,640 --> 00:29:48,230
<font color="#E5E5E5">so in our hash to manage this stuff we</font>

718
00:29:46,910 --> 00:29:49,820
have<font color="#CCCCCC"> we actually have three hash</font><font color="#E5E5E5"> a--'s</font>

719
00:29:48,230 --> 00:29:52,250
one is<font color="#CCCCCC"> global level one's application</font>

720
00:29:49,820 --> 00:29:53,899
level and one's user level and they roll

721
00:29:52,250 --> 00:29:56,240
off<font color="#E5E5E5"> really quickly right because if I</font>

722
00:29:53,900 --> 00:29:57,710
say here's a<font color="#CCCCCC"> timestamp 30 minutes and we</font>

723
00:29:56,240 --> 00:29:58,760
<font color="#E5E5E5">just wake</font><font color="#CCCCCC"> up like every</font><font color="#E5E5E5"> 6 or 7 seconds</font>

724
00:29:57,710 --> 00:30:00,620
<font color="#CCCCCC">and</font><font color="#E5E5E5"> we're like hey it's a dead is</font><font color="#CCCCCC"> it</font>

725
00:29:58,760 --> 00:30:02,870
dead<font color="#E5E5E5"> because it's all in RAM so this is</font>

726
00:30:00,620 --> 00:30:04,189
pretty lightweight<font color="#CCCCCC"> so if I want a global</font>

727
00:30:02,870 --> 00:30:06,469
kill everybody<font color="#E5E5E5"> I'd be like hey guess</font>

728
00:30:04,190 --> 00:30:09,200
what big red button everybody<font color="#E5E5E5"> log in</font>

729
00:30:06,470 --> 00:30:11,090
again<font color="#CCCCCC"> I can and I can tell all</font><font color="#E5E5E5"> the</font>

730
00:30:09,200 --> 00:30:13,700
<font color="#E5E5E5">backend services with one hash entry</font>

731
00:30:11,090 --> 00:30:15,530
<font color="#E5E5E5">everyone's dead and that hash entry is</font>

732
00:30:13,700 --> 00:30:18,890
literally it's actually not<font color="#CCCCCC"> even a hash</font>

733
00:30:15,530 --> 00:30:20,930
it's a global static<font color="#CCCCCC"> it's literally</font><font color="#E5E5E5"> this</font>

734
00:30:18,890 --> 00:30:23,330
<font color="#E5E5E5">is the time stamp for everybody's jots</font>

735
00:30:20,930 --> 00:30:26,210
to be revoked<font color="#E5E5E5"> so lots of ways</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> manage</font>

736
00:30:23,330 --> 00:30:30,970
it<font color="#CCCCCC"> lightly cool</font><font color="#E5E5E5"> all right let's go back</font>

737
00:30:26,210 --> 00:30:30,970
up really<font color="#E5E5E5"> quick yep</font>

738
00:30:51,470 --> 00:30:56,100
yeah cuz it's<font color="#E5E5E5"> not part of the spec it's</font>

739
00:30:54,540 --> 00:31:00,000
just something<font color="#E5E5E5"> like that we came up</font><font color="#CCCCCC"> we</font>

740
00:30:56,100 --> 00:31:01,230
saw this for Wells Fargo<font color="#CCCCCC"> so it was one</font>

741
00:31:00,000 --> 00:31:02,640
we were working with them<font color="#E5E5E5"> and they're</font>

742
00:31:01,230 --> 00:31:04,820
like we need<font color="#E5E5E5"> to revoke</font><font color="#CCCCCC"> John so</font><font color="#E5E5E5"> I'm like</font>

743
00:31:02,640 --> 00:31:08,340
<font color="#E5E5E5">okay fine here this is how you do</font><font color="#CCCCCC"> it and</font>

744
00:31:04,820 --> 00:31:09,810
so there's no<font color="#E5E5E5"> spec definition for this</font>

745
00:31:08,340 --> 00:31:12,270
it's<font color="#CCCCCC"> just something we dreamed up so</font>

746
00:31:09,810 --> 00:31:15,060
<font color="#CCCCCC">very few libraries use it or have it</font>

747
00:31:12,270 --> 00:31:17,490
<font color="#CCCCCC">ours does because we implemented it so</font>

748
00:31:15,060 --> 00:31:19,649
our shot library does all the correct

749
00:31:17,490 --> 00:31:21,420
<font color="#CCCCCC">jot and his stuff according to spec but</font>

750
00:31:19,650 --> 00:31:23,160
then it also provides this just as kind

751
00:31:21,420 --> 00:31:24,990
<font color="#CCCCCC">of a</font><font color="#E5E5E5"> little nicety</font><font color="#CCCCCC"> I don't know if any</font>

752
00:31:23,160 --> 00:31:26,010
of<font color="#E5E5E5"> the other ones do</font><font color="#CCCCCC"> but it's</font><font color="#E5E5E5"> really</font>

753
00:31:24,990 --> 00:31:27,390
<font color="#E5E5E5">easy to write I can</font><font color="#CCCCCC"> show you code</font>

754
00:31:26,010 --> 00:31:30,770
<font color="#E5E5E5">afterwards</font><font color="#CCCCCC"> I mean this stuff is</font>

755
00:31:27,390 --> 00:31:33,770
literally like<font color="#E5E5E5"> 40 lines of code so easy</font>

756
00:31:30,770 --> 00:31:33,770
yep

757
00:31:39,690 --> 00:31:46,350
<font color="#CCCCCC">mm-hmm oh sure yeah so Oh auth to access</font>

758
00:31:45,330 --> 00:31:48,419
tokens<font color="#E5E5E5"> can just be jots</font>

759
00:31:46,350 --> 00:31:50,939
<font color="#E5E5E5">and a lot of OAuth 2 implementations</font>

760
00:31:48,420 --> 00:31:52,770
they are jots so if you're going<font color="#CCCCCC"> to do</font>

761
00:31:50,940 --> 00:31:53,130
an authorization grant<font color="#E5E5E5"> right go over</font>

762
00:31:52,770 --> 00:31:55,790
there

763
00:31:53,130 --> 00:31:57,170
<font color="#E5E5E5">login</font><font color="#CCCCCC"> come</font><font color="#E5E5E5"> back here with a code</font>

764
00:31:55,790 --> 00:32:01,080
<font color="#E5E5E5">authorization code</font>

765
00:31:57,170 --> 00:32:03,630
call via<font color="#CCCCCC"> backend API to the token</font>

766
00:32:01,080 --> 00:32:05,250
<font color="#E5E5E5">endpoint</font><font color="#CCCCCC"> right</font><font color="#E5E5E5"> with my code which code</font>

767
00:32:03,630 --> 00:32:06,990
<font color="#CCCCCC">is really</font><font color="#E5E5E5"> just a big long opaque token</font>

768
00:32:05,250 --> 00:32:08,700
authorization code should always be

769
00:32:06,990 --> 00:32:10,740
opaque tokens<font color="#CCCCCC"> keep</font><font color="#E5E5E5"> that in mind</font>

770
00:32:08,700 --> 00:32:12,540
you called the<font color="#E5E5E5"> backend with your big</font>

771
00:32:10,740 --> 00:32:14,790
long opaque token<font color="#E5E5E5"> and then</font><font color="#CCCCCC"> what it sends</font>

772
00:32:12,540 --> 00:32:17,460
you back is not<font color="#E5E5E5"> an opaque access token</font>

773
00:32:14,790 --> 00:32:19,470
which<font color="#CCCCCC"> is like Oh auth one-ish it sends</font>

774
00:32:17,460 --> 00:32:21,810
you back<font color="#E5E5E5"> a jot so if you look at what</font>

775
00:32:19,470 --> 00:32:23,850
<font color="#E5E5E5">most two</font><font color="#CCCCCC"> implementations are doing</font>

776
00:32:21,810 --> 00:32:26,129
that's it there are a<font color="#E5E5E5"> few that don't so</font>

777
00:32:23,850 --> 00:32:28,169
like Facebook<font color="#E5E5E5"> influenced OAuth 2 but</font>

778
00:32:26,130 --> 00:32:30,180
they refuse to<font color="#E5E5E5"> use jots I'm just fine</font>

779
00:32:28,170 --> 00:32:32,790
because<font color="#CCCCCC"> OA 2 does not require you to use</font>

780
00:32:30,180 --> 00:32:36,780
jots<font color="#E5E5E5"> jots are an extension to OAuth 2</font>

781
00:32:32,790 --> 00:32:40,350
and then on top of it goes<font color="#CCCCCC"> o up to jaw</font>

782
00:32:36,780 --> 00:32:42,899
open ID<font color="#E5E5E5"> Connect that's the layering so</font>

783
00:32:40,350 --> 00:32:44,879
you don't have<font color="#E5E5E5"> to but you</font><font color="#CCCCCC"> can and what</font>

784
00:32:42,900 --> 00:32:47,850
that's a<font color="#E5E5E5"> really good another really good</font>

785
00:32:44,880 --> 00:32:49,860
point<font color="#E5E5E5"> here is that when I hate bearer if</font>

786
00:32:47,850 --> 00:32:51,810
that key word dies I<font color="#CCCCCC"> will be a happy</font>

787
00:32:49,860 --> 00:32:52,500
<font color="#CCCCCC">camper it's the dumbest thing it</font><font color="#E5E5E5"> doesn't</font>

788
00:32:51,810 --> 00:32:56,010
mean anything

789
00:32:52,500 --> 00:32:58,290
so what we<font color="#CCCCCC"> suggest is use a different</font>

790
00:32:56,010 --> 00:33:01,530
scheme<font color="#E5E5E5"> just tell me what it is</font>

791
00:32:58,290 --> 00:33:03,139
it's a jot<font color="#E5E5E5"> and it's so easy to instead</font>

792
00:33:01,530 --> 00:33:06,000
<font color="#E5E5E5">of saying like authorization bearer</font>

793
00:33:03,140 --> 00:33:08,400
token to say authorization jot token<font color="#E5E5E5"> it</font>

794
00:33:06,000 --> 00:33:11,250
<font color="#CCCCCC">a lot of people disagree with</font><font color="#E5E5E5"> me</font><font color="#CCCCCC"> on that</font>

795
00:33:08,400 --> 00:33:14,310
<font color="#E5E5E5">so that's a it's a little contentious</font>

796
00:33:11,250 --> 00:33:16,770
<font color="#E5E5E5">but I do not like bear</font><font color="#CCCCCC"> if you're gonna</font>

797
00:33:14,310 --> 00:33:20,870
tell<font color="#E5E5E5"> me it's opaque say opaque</font><font color="#CCCCCC"> and then</font>

798
00:33:16,770 --> 00:33:20,870
the token<font color="#CCCCCC"> John the token</font>

799
00:33:24,880 --> 00:33:30,230
it is<font color="#E5E5E5"> I agree</font><font color="#CCCCCC"> but you don't know what it</font>

800
00:33:27,650 --> 00:33:32,450
<font color="#E5E5E5">is it's up to the</font><font color="#CCCCCC"> implementation to tell</font>

801
00:33:30,230 --> 00:33:33,770
you and document it properly<font color="#E5E5E5"> or</font><font color="#CCCCCC"> you just</font>

802
00:33:32,450 --> 00:33:34,700
<font color="#E5E5E5">brute force and you're like well I'm</font>

803
00:33:33,770 --> 00:33:36,139
gonna see if<font color="#E5E5E5"> it's a jot</font>

804
00:33:34,700 --> 00:33:39,380
you tried to<font color="#CCCCCC"> coating it</font><font color="#E5E5E5"> and it explodes</font>

805
00:33:36,140 --> 00:33:40,850
you're like<font color="#CCCCCC"> no</font><font color="#E5E5E5"> not a jot so security</font>

806
00:33:39,380 --> 00:33:42,170
<font color="#E5E5E5">threw off you station never works and I</font>

807
00:33:40,850 --> 00:33:44,659
<font color="#E5E5E5">think that's what a lot</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> people are</font>

808
00:33:42,170 --> 00:33:46,309
saying<font color="#E5E5E5"> it</font><font color="#CCCCCC"> is because</font><font color="#E5E5E5"> bearer is really</font>

809
00:33:44,660 --> 00:33:50,630
just the signifier right it<font color="#E5E5E5"> just tells</font>

810
00:33:46,309 --> 00:33:52,940
me what it<font color="#CCCCCC"> is it's</font><font color="#E5E5E5"> not a API key it's a</font>

811
00:33:50,630 --> 00:33:57,679
token<font color="#CCCCCC"> it's a</font><font color="#E5E5E5"> bearer token so why not</font>

812
00:33:52,940 --> 00:33:59,570
<font color="#E5E5E5">just say Joe bear jot anything I mean</font>

813
00:33:57,679 --> 00:34:01,670
it's a<font color="#CCCCCC"> free-form string</font><font color="#E5E5E5"> right so HTTP</font>

814
00:33:59,570 --> 00:34:02,960
only says this has to be a string and

815
00:34:01,670 --> 00:34:05,630
here are the allowed characters for<font color="#E5E5E5"> this</font>

816
00:34:02,960 --> 00:34:08,540
part of the header<font color="#E5E5E5"> right</font><font color="#CCCCCC"> I could</font><font color="#E5E5E5"> call it</font>

817
00:34:05,630 --> 00:34:11,030
Fred<font color="#E5E5E5"> right</font><font color="#CCCCCC"> I could</font><font color="#E5E5E5"> tell</font><font color="#CCCCCC"> it like death</font>

818
00:34:08,540 --> 00:34:13,639
<font color="#E5E5E5">metal replication is awesome right it</font>

819
00:34:11,030 --> 00:34:26,060
doesn't<font color="#CCCCCC"> matter anyway</font><font color="#E5E5E5"> that's yeah that's</font>

820
00:34:13,639 --> 00:34:28,760
<font color="#CCCCCC">my rant</font><font color="#E5E5E5"> for the day so you can encrypt</font>

821
00:34:26,060 --> 00:34:31,279
individual values you can't encrypt the

822
00:34:28,760 --> 00:34:31,960
entire<font color="#E5E5E5"> body it's my time</font><font color="#CCCCCC"> understanding</font>

823
00:34:31,280 --> 00:34:34,340
<font color="#E5E5E5">yeah</font>

824
00:34:31,960 --> 00:34:37,399
you can't encrypt the<font color="#CCCCCC"> entire body that's</font>

825
00:34:34,340 --> 00:34:38,419
a call to jwe it's an encrypted job the

826
00:34:37,399 --> 00:34:41,270
whole thing is encrypted

827
00:34:38,418 --> 00:34:43,850
you can encrypt individual values in the

828
00:34:41,270 --> 00:34:45,440
jot and then have them decrypted<font color="#E5E5E5"> on the</font>

829
00:34:43,850 --> 00:34:47,929
server<font color="#E5E5E5"> and that's totally fine</font><font color="#CCCCCC"> but it</font>

830
00:34:45,440 --> 00:34:50,110
has to be well-formed<font color="#E5E5E5"> JSON based 64</font>

831
00:34:47,929 --> 00:34:57,650
encoded<font color="#E5E5E5"> has to be according to spec</font>

832
00:34:50,110 --> 00:34:58,880
great question yeah you always yes<font color="#E5E5E5"> any</font>

833
00:34:57,650 --> 00:34:59,900
question was the encryption<font color="#CCCCCC"> cause</font>

834
00:34:58,880 --> 00:35:02,270
performance<font color="#E5E5E5"> issues yeah I definitely</font>

835
00:34:59,900 --> 00:35:05,210
<font color="#CCCCCC">like you</font><font color="#E5E5E5"> have to be so careful with this</font>

836
00:35:02,270 --> 00:35:07,370
<font color="#E5E5E5">stuff</font><font color="#CCCCCC"> and actually so I don't think it's</font>

837
00:35:05,210 --> 00:35:10,490
in this<font color="#E5E5E5"> one we have tons of metrics</font>

838
00:35:07,370 --> 00:35:13,359
around<font color="#CCCCCC"> how</font><font color="#E5E5E5"> slow JSON parsing is how slow</font>

839
00:35:10,490 --> 00:35:16,790
<font color="#E5E5E5">RS a verification is how slow H</font><font color="#CCCCCC"> Mac</font><font color="#E5E5E5"> is</font>

840
00:35:13,360 --> 00:35:18,980
it and<font color="#CCCCCC"> so the numbers are</font><font color="#E5E5E5"> interesting</font>

841
00:35:16,790 --> 00:35:20,180
<font color="#CCCCCC">all</font><font color="#E5E5E5"> right so you have to</font><font color="#CCCCCC"> be careful with</font>

842
00:35:18,980 --> 00:35:22,130
this stuff<font color="#E5E5E5"> this stuff is slow and if</font>

843
00:35:20,180 --> 00:35:25,870
you're at scale every<font color="#E5E5E5"> little thing</font>

844
00:35:22,130 --> 00:35:25,870
<font color="#E5E5E5">matters so be careful your encryption</font>

845
00:35:26,630 --> 00:35:46,010
Oh<font color="#E5E5E5"> way around yeah RSA is really slow to</font>

846
00:35:43,430 --> 00:35:48,169
sign<font color="#E5E5E5"> really fast to verify parabolic is</font>

847
00:35:46,010 --> 00:35:51,250
<font color="#E5E5E5">yeah and there's other algorithms that</font>

848
00:35:48,170 --> 00:35:51,250
<font color="#E5E5E5">you can make them</font><font color="#CCCCCC"> slow on</font><font color="#E5E5E5"> both sides</font>

849
00:35:58,150 --> 00:36:03,230
<font color="#CCCCCC">yeah alright so it depends on</font><font color="#E5E5E5"> how long</font>

850
00:36:00,860 --> 00:36:05,480
<font color="#CCCCCC">your dots expire if your dots are longer</font>

851
00:36:03,230 --> 00:36:07,310
<font color="#CCCCCC">lived than you do less signing right you</font>

852
00:36:05,480 --> 00:36:08,360
do more verification<font color="#CCCCCC"> if your dots are</font>

853
00:36:07,310 --> 00:36:09,529
really short<font color="#E5E5E5"> like let's say you keep</font>

854
00:36:08,360 --> 00:36:14,420
them around<font color="#E5E5E5"> I</font><font color="#CCCCCC"> don't</font><font color="#E5E5E5"> know for like three</font>

855
00:36:09,530 --> 00:36:16,340
seconds<font color="#E5E5E5"> five seconds</font><font color="#CCCCCC"> you got to do a lot</font>

856
00:36:14,420 --> 00:36:17,690
of signing<font color="#CCCCCC"> yeah it's gonna be really</font>

857
00:36:16,340 --> 00:36:19,730
heavy so then you want to<font color="#E5E5E5"> pick an auger</font>

858
00:36:17,690 --> 00:36:22,250
than them is better but still secure<font color="#E5E5E5"> on</font>

859
00:36:19,730 --> 00:36:27,010
both<font color="#E5E5E5"> sides yeah so it's just your</font>

860
00:36:22,250 --> 00:36:27,010
semantics<font color="#E5E5E5"> of your ab yep</font>

861
00:36:29,330 --> 00:36:34,620
they can yes<font color="#CCCCCC"> you can use</font><font color="#E5E5E5"> it for anything</font>

862
00:36:31,890 --> 00:36:37,319
<font color="#E5E5E5">you can store any data you want in them</font>

863
00:36:34,620 --> 00:36:39,870
<font color="#E5E5E5">so our</font><font color="#CCCCCC"> job specifically store the user</font>

864
00:36:37,320 --> 00:36:41,820
ID user<font color="#CCCCCC"> chord data that's not</font><font color="#E5E5E5"> like</font>

865
00:36:39,870 --> 00:36:46,049
<font color="#E5E5E5">secure data like</font><font color="#CCCCCC"> secure</font><font color="#E5E5E5"> social security</font>

866
00:36:41,820 --> 00:36:47,910
number and then<font color="#CCCCCC"> roles the</font><font color="#E5E5E5"> roles for</font><font color="#CCCCCC"> the</font>

867
00:36:46,050 --> 00:36:50,250
a<font color="#CCCCCC"> bian switch in our case is an</font>

868
00:36:47,910 --> 00:36:52,379
<font color="#E5E5E5">application ID so let's say you log</font><font color="#CCCCCC"> in</font>

869
00:36:50,250 --> 00:36:54,000
<font color="#CCCCCC">to</font><font color="#E5E5E5"> the forums and</font><font color="#CCCCCC"> you want to know the</font>

870
00:36:52,380 --> 00:36:55,860
<font color="#CCCCCC">roles for that users</font><font color="#E5E5E5"> that user moderator</font>

871
00:36:54,000 --> 00:36:57,060
<font color="#E5E5E5">can they delete posts that from other</font>

872
00:36:55,860 --> 00:37:01,130
people<font color="#CCCCCC"> can they</font><font color="#E5E5E5"> only delete their own</font>

873
00:36:57,060 --> 00:37:07,470
posts<font color="#CCCCCC"> etc you can store</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> in the</font><font color="#E5E5E5"> job</font>

874
00:37:01,130 --> 00:37:10,110
sign well<font color="#E5E5E5"> is so here's the kicker is a</font>

875
00:37:07,470 --> 00:37:12,359
role sensitive<font color="#E5E5E5"> got to make a decision</font>

876
00:37:10,110 --> 00:37:15,870
<font color="#E5E5E5">because</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> can't change the users roles</font>

877
00:37:12,360 --> 00:37:18,360
and roles usually just strings<font color="#CCCCCC"> so in our</font>

878
00:37:15,870 --> 00:37:20,220
case we we feel that they're<font color="#E5E5E5"> not it's</font>

879
00:37:18,360 --> 00:37:22,770
just a bit of<font color="#CCCCCC"> data</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> doesn't it's</font>

880
00:37:20,220 --> 00:37:24,359
<font color="#E5E5E5">nonsensical to a hacker and they can't</font>

881
00:37:22,770 --> 00:37:29,009
<font color="#E5E5E5">change it and make</font><font color="#CCCCCC"> themselves become</font>

882
00:37:24,360 --> 00:37:30,870
admin because<font color="#E5E5E5"> it's signed</font><font color="#CCCCCC"> alright I</font>

883
00:37:29,010 --> 00:37:32,910
think my time<font color="#CCCCCC"> is</font><font color="#E5E5E5"> up</font><font color="#CCCCCC"> yeah if you guys</font>

884
00:37:30,870 --> 00:37:35,240
<font color="#E5E5E5">want</font><font color="#CCCCCC"> to know more come to come up here</font>

885
00:37:32,910 --> 00:37:35,240
I'll be around

886
00:37:35,380 --> 00:37:43,510
[Applause]

