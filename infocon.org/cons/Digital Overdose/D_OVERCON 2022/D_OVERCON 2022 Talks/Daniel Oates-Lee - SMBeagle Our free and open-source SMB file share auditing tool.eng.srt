1
00:00:02,399 --> 00:00:05,120
and welcome back everyone um

2
00:00:05,120 --> 00:00:07,040
we have with us daniel itzly who's uh

3
00:00:07,040 --> 00:00:08,480
replacing simon who couldn't be here

4
00:00:08,480 --> 00:00:10,160
today um

5
00:00:10,160 --> 00:00:14,799
same talk same content and yeah um

6
00:00:15,040 --> 00:00:17,119
please take it away daniel

7
00:00:17,119 --> 00:00:19,760
excellent uh hello everybody thank you

8
00:00:19,760 --> 00:00:23,600
for uh attending today um

9
00:00:23,600 --> 00:00:25,199
what i'm going to be talking about today

10
00:00:25,199 --> 00:00:27,359
is uh an open source tool that we

11
00:00:27,359 --> 00:00:30,160
developed at punk security and for

12
00:00:30,160 --> 00:00:32,880
hunting out weak network shares

13
00:00:32,880 --> 00:00:35,920
this is both a blue defender's team tool

14
00:00:35,920 --> 00:00:38,000
and also a red team as tool and i'm

15
00:00:38,000 --> 00:00:40,000
going to explain what that what what i

16
00:00:40,000 --> 00:00:41,520
mean by that as we're going through the

17
00:00:41,520 --> 00:00:44,480
talks today hopefully i was hoping to do

18
00:00:44,480 --> 00:00:47,039
a live demo it's not quite worked out

19
00:00:47,039 --> 00:00:49,280
the way i wanted it to so but i have got

20
00:00:49,280 --> 00:00:51,520
it pre-recorded so we will get still see

21
00:00:51,520 --> 00:00:53,440
the tool running so what am i going to

22
00:00:53,440 --> 00:00:55,360
talk about today so we're going to look

23
00:00:55,360 --> 00:00:57,120
at what the problem was that we were

24
00:00:57,120 --> 00:00:58,399
trying to address

25
00:00:58,399 --> 00:01:00,399
uh how we approached it

26
00:01:00,399 --> 00:01:03,120
and then how does sm beagle work what is

27
00:01:03,120 --> 00:01:05,199
it and then we'll do a little demo and

28
00:01:05,199 --> 00:01:07,040
i'll show you some of the features that

29
00:01:07,040 --> 00:01:09,439
we've uh we earmarked for

30
00:01:09,439 --> 00:01:11,360
future development and we'd also

31
00:01:11,360 --> 00:01:14,080
obviously also love people to feed back

32
00:01:14,080 --> 00:01:17,200
to us and tell us more uh tools and

33
00:01:17,200 --> 00:01:18,799
features that they would like in sm

34
00:01:18,799 --> 00:01:20,159
eagle so then we can enhance it because

35
00:01:20,159 --> 00:01:22,159
this is an open source tool for the

36
00:01:22,159 --> 00:01:24,080
community to use

37
00:01:24,080 --> 00:01:26,640
but first of all who am i so

38
00:01:26,640 --> 00:01:28,560
my name is daniel oatsley i am a

39
00:01:28,560 --> 00:01:30,079
co-founder

40
00:01:30,079 --> 00:01:32,640
of punk security uh punk security's only

41
00:01:32,640 --> 00:01:35,040
been running for about 12 months now but

42
00:01:35,040 --> 00:01:37,680
i have worked in cyber security for the

43
00:01:37,680 --> 00:01:40,960
last 15 16 years i've been in it for

44
00:01:40,960 --> 00:01:43,360
over 25 years i started out as a

45
00:01:43,360 --> 00:01:45,520
developer and then moved into

46
00:01:45,520 --> 00:01:46,799
infrastructure

47
00:01:46,799 --> 00:01:49,680
did a bit of networks and then naturally

48
00:01:49,680 --> 00:01:51,119
fell into security because i could

49
00:01:51,119 --> 00:01:52,320
understand

50
00:01:52,320 --> 00:01:54,240
applications and networks and

51
00:01:54,240 --> 00:01:56,159
infrastructure and everything like that

52
00:01:56,159 --> 00:01:58,799
um so i'm currently a cyber security

53
00:01:58,799 --> 00:02:02,000
consultant specializing in devsecops so

54
00:02:02,000 --> 00:02:04,719
devsecops is obviously that ability to

55
00:02:04,719 --> 00:02:08,639
be able to automate security tooling and

56
00:02:08,639 --> 00:02:11,200
automatically finding security defects

57
00:02:11,200 --> 00:02:13,280
in applications as you're testing them

58
00:02:13,280 --> 00:02:16,879
through a life cycle and

59
00:02:16,879 --> 00:02:19,280
i put down terraformer because i am a

60
00:02:19,280 --> 00:02:22,080
very big fan of infrastructure is code

61
00:02:22,080 --> 00:02:23,840
everything that i build everything that

62
00:02:23,840 --> 00:02:26,720
i try and do i try and use terraform or

63
00:02:26,720 --> 00:02:28,720
some form of infrastructure as code

64
00:02:28,720 --> 00:02:31,200
because i love automation

65
00:02:31,200 --> 00:02:33,680
so i'm very passionate about that

66
00:02:33,680 --> 00:02:36,560
i also do do quite a bit of pen testing

67
00:02:36,560 --> 00:02:38,480
and hacking myself

68
00:02:38,480 --> 00:02:39,440
um

69
00:02:39,440 --> 00:02:42,319
i do quite a few capture the flags so i

70
00:02:42,319 --> 00:02:44,319
have got some red skills but i try and

71
00:02:44,319 --> 00:02:46,800
focus my skills more in like the blue

72
00:02:46,800 --> 00:02:47,599
the

73
00:02:47,599 --> 00:02:50,400
on the defenders side and

74
00:02:50,400 --> 00:02:52,879
helping the development teams identify

75
00:02:52,879 --> 00:02:55,200
security defects

76
00:02:55,200 --> 00:02:57,440
and so what was the problem that we were

77
00:02:57,440 --> 00:02:59,280
trying to address

78
00:02:59,280 --> 00:03:02,480
uh we we decided that uh we found that

79
00:03:02,480 --> 00:03:04,800
during the pandemic quite a lot of our

80
00:03:04,800 --> 00:03:06,000
quite a lot of people that we was

81
00:03:06,000 --> 00:03:07,680
helping support because we were at a

82
00:03:07,680 --> 00:03:10,159
previous consultancy um we're getting

83
00:03:10,159 --> 00:03:12,159
hit with ransomware

84
00:03:12,159 --> 00:03:14,560
and we thought well how can we help

85
00:03:14,560 --> 00:03:16,400
people uh

86
00:03:16,400 --> 00:03:18,879
get themselves ready for a ransomware

87
00:03:18,879 --> 00:03:21,360
issue because everybody's trying to stop

88
00:03:21,360 --> 00:03:23,120
ransomware from happening

89
00:03:23,120 --> 00:03:26,000
but we believe that um the best defense

90
00:03:26,000 --> 00:03:27,840
is actually knowing what you potentially

91
00:03:27,840 --> 00:03:30,640
will lose as opposed to trying to stop

92
00:03:30,640 --> 00:03:32,480
something that is ever changing

93
00:03:32,480 --> 00:03:34,480
so if you understand what your network

94
00:03:34,480 --> 00:03:36,879
is where your wait wait where your files

95
00:03:36,879 --> 00:03:38,879
are what is likely to be ransomware

96
00:03:38,879 --> 00:03:40,720
you're going to be better prepared which

97
00:03:40,720 --> 00:03:43,440
means that if you did when you do get

98
00:03:43,440 --> 00:03:45,519
attacked and when you do get ransomware

99
00:03:45,519 --> 00:03:47,200
yeah you'll be in a much better position

100
00:03:47,200 --> 00:03:48,720
you'll be less you'll be there'll be

101
00:03:48,720 --> 00:03:51,120
less uh issues so what were the main

102
00:03:51,120 --> 00:03:53,280
issues in our view for people not

103
00:03:53,280 --> 00:03:55,200
understanding their full network well

104
00:03:55,200 --> 00:03:57,599
the the first one is undocumented i.t

105
00:03:57,599 --> 00:03:59,360
systems and technical debt

106
00:03:59,360 --> 00:04:01,599
um you know people building file shares

107
00:04:01,599 --> 00:04:04,159
or file servers or

108
00:04:04,159 --> 00:04:05,120
you know

109
00:04:05,120 --> 00:04:07,120
undocumented infrastructure out there we

110
00:04:07,120 --> 00:04:08,720
all the i.t

111
00:04:08,720 --> 00:04:10,959
staff regularly rotate through we don't

112
00:04:10,959 --> 00:04:13,680
do a lot of documentation and it's just

113
00:04:13,680 --> 00:04:14,720
chaos

114
00:04:14,720 --> 00:04:16,399
in some larger companies

115
00:04:16,399 --> 00:04:18,320
we also don't tend to back up everything

116
00:04:18,320 --> 00:04:19,199
that we

117
00:04:19,199 --> 00:04:21,519
you know back up all our data

118
00:04:21,519 --> 00:04:23,600
a lot of file shares out there in the

119
00:04:23,600 --> 00:04:26,639
world uh are either unknown or only

120
00:04:26,639 --> 00:04:28,320
known by a few peoples and therefore

121
00:04:28,320 --> 00:04:31,040
they're not included inside backups

122
00:04:31,040 --> 00:04:34,400
and networks segment segmentation is

123
00:04:34,400 --> 00:04:35,520
another one

124
00:04:35,520 --> 00:04:37,440
you know people in

125
00:04:37,440 --> 00:04:38,960
finance being able to access

126
00:04:38,960 --> 00:04:41,680
applications that shouldn't you know uh

127
00:04:41,680 --> 00:04:44,400
shouldn't be accessed by uh the hr team

128
00:04:44,400 --> 00:04:45,840
or the hr team

129
00:04:45,840 --> 00:04:48,080
uh accessing stuff that the finance team

130
00:04:48,080 --> 00:04:50,160
um should only have access to you know

131
00:04:50,160 --> 00:04:52,720
those kind of things uh poor security

132
00:04:52,720 --> 00:04:56,479
around web and mail protection um you

133
00:04:56,479 --> 00:04:58,400
know people going out and browsing

134
00:04:58,400 --> 00:05:00,639
straight out to the internet the amount

135
00:05:00,639 --> 00:05:02,479
of companies out there where i've gone

136
00:05:02,479 --> 00:05:04,880
in and found that there's unrestricted

137
00:05:04,880 --> 00:05:06,960
egress and there's no web proxies

138
00:05:06,960 --> 00:05:08,720
there's no filters there's no nothing

139
00:05:08,720 --> 00:05:12,160
like that um is unreal and male

140
00:05:12,160 --> 00:05:14,960
protection itself we're allowing a lot

141
00:05:14,960 --> 00:05:17,120
of ransomware to actually come in in the

142
00:05:17,120 --> 00:05:18,720
form of phishing attacks and stuff like

143
00:05:18,720 --> 00:05:21,199
that and that's a an ever-changing thing

144
00:05:21,199 --> 00:05:24,080
um users permissions and awareness of

145
00:05:24,080 --> 00:05:27,520
what what they've got access to um

146
00:05:27,520 --> 00:05:29,360
one of the one of the big things that i

147
00:05:29,360 --> 00:05:31,039
find when i'm doing my pen tests or

148
00:05:31,039 --> 00:05:32,960
security audits

149
00:05:32,960 --> 00:05:35,280
is that a lot of like service desk guys

150
00:05:35,280 --> 00:05:37,840
have got domain admin rights and it's on

151
00:05:37,840 --> 00:05:39,120
their standard account and their

152
00:05:39,120 --> 00:05:42,720
standard account is incredibly weak

153
00:05:43,120 --> 00:05:46,080
in my view that's wrong um or

154
00:05:46,080 --> 00:05:47,600
people that have moved from like

155
00:05:47,600 --> 00:05:50,560
customer care to hr they retain the

156
00:05:50,560 --> 00:05:52,720
customer care

157
00:05:52,720 --> 00:05:54,720
permissions to a load of file shares

158
00:05:54,720 --> 00:05:56,319
that they shouldn't now

159
00:05:56,319 --> 00:05:58,960
really have access to anymore so it's um

160
00:05:58,960 --> 00:06:01,600
people aren't really doing that um

161
00:06:01,600 --> 00:06:04,000
recertification process and checking

162
00:06:04,000 --> 00:06:06,080
their users every 12 months are you

163
00:06:06,080 --> 00:06:07,680
supposed to still have access to this

164
00:06:07,680 --> 00:06:09,600
are you still supposed you know can we

165
00:06:09,600 --> 00:06:11,440
remove you or

166
00:06:11,440 --> 00:06:13,199
um can we give you a better set of

167
00:06:13,199 --> 00:06:16,720
permissions and then end point um

168
00:06:16,720 --> 00:06:19,520
endpoint protect configurations and it's

169
00:06:19,520 --> 00:06:22,000
not just about security you know have

170
00:06:22,000 --> 00:06:23,360
you got antivirus and whatever you're

171
00:06:23,360 --> 00:06:26,240
running it's also um you know is the

172
00:06:26,240 --> 00:06:29,280
user running as local admin um have you

173
00:06:29,280 --> 00:06:30,639
got services running that you shouldn't

174
00:06:30,639 --> 00:06:32,160
have running are you have you looked at

175
00:06:32,160 --> 00:06:34,319
the cis security standards so these are

176
00:06:34,319 --> 00:06:36,400
the kind of things that we we'd listed

177
00:06:36,400 --> 00:06:38,240
out as the main reasons for people being

178
00:06:38,240 --> 00:06:40,479
hit by ransomware

179
00:06:40,479 --> 00:06:42,479
so what was our approach

180
00:06:42,479 --> 00:06:44,479
well we had a look at the list and we

181
00:06:44,479 --> 00:06:47,440
kind of went right well undocumented 90s

182
00:06:47,440 --> 00:06:49,199
technical debt systems we could probably

183
00:06:49,199 --> 00:06:51,039
do something about that

184
00:06:51,039 --> 00:06:52,960
um we could probably script something to

185
00:06:52,960 --> 00:06:57,199
help search and and and fix that

186
00:06:57,199 --> 00:07:00,479
uh data data backups again we can

187
00:07:00,479 --> 00:07:02,400
probably do something about that as well

188
00:07:02,400 --> 00:07:04,240
uh if we've identified that there are

189
00:07:04,240 --> 00:07:05,919
network file shares that you didn't know

190
00:07:05,919 --> 00:07:08,000
about then we can get that added in

191
00:07:08,000 --> 00:07:10,400
um we we decided that network

192
00:07:10,400 --> 00:07:12,400
segmentation and

193
00:07:12,400 --> 00:07:15,039
email protection and web protection are

194
00:07:15,039 --> 00:07:16,479
done to death

195
00:07:16,479 --> 00:07:18,000
there is no point in always trying to

196
00:07:18,000 --> 00:07:19,520
develop a tool that will help you be

197
00:07:19,520 --> 00:07:22,240
able to fix those because there are lots

198
00:07:22,240 --> 00:07:25,120
of really good tools out there um

199
00:07:25,120 --> 00:07:26,160
and

200
00:07:26,160 --> 00:07:28,160
it's not difficult to be able to get

201
00:07:28,160 --> 00:07:29,280
that right

202
00:07:29,280 --> 00:07:32,000
right well it shouldn't be um user

203
00:07:32,000 --> 00:07:34,479
permissions and awareness and

204
00:07:34,479 --> 00:07:36,639
again we thought if we built a tool that

205
00:07:36,639 --> 00:07:38,560
helped you find your network shares we

206
00:07:38,560 --> 00:07:40,080
could document out what those network

207
00:07:40,080 --> 00:07:42,560
shares were inform the it teams get

208
00:07:42,560 --> 00:07:44,479
people to understand that maybe you need

209
00:07:44,479 --> 00:07:47,039
to be doing re-certifications and stuff

210
00:07:47,039 --> 00:07:49,759
like that and poor server configurations

211
00:07:49,759 --> 00:07:52,080
this is this is we thought well

212
00:07:52,080 --> 00:07:53,360
yeah again

213
00:07:53,360 --> 00:07:55,759
we can look at ntfs shares we can look

214
00:07:55,759 --> 00:07:59,199
at some smb shares we can tell you that

215
00:07:59,199 --> 00:08:02,240
using the everyone group is a bad idea

216
00:08:02,240 --> 00:08:04,080
you should be using authenticated users

217
00:08:04,080 --> 00:08:06,560
if you're in an active directory domain

218
00:08:06,560 --> 00:08:08,000
you know those kind of little things

219
00:08:08,000 --> 00:08:09,680
like that

220
00:08:09,680 --> 00:08:10,800
so

221
00:08:10,800 --> 00:08:13,599
that's where sm beagle came from uh it

222
00:08:13,599 --> 00:08:15,599
it was to build this ransomware

223
00:08:15,599 --> 00:08:17,840
readiness audit tool which will scan

224
00:08:17,840 --> 00:08:20,639
your network and identify any samba

225
00:08:20,639 --> 00:08:23,360
shares that are out there on the network

226
00:08:23,360 --> 00:08:25,039
and

227
00:08:25,039 --> 00:08:28,479
are are available for users to to access

228
00:08:28,479 --> 00:08:30,479
and we thought well it'd be a good idea

229
00:08:30,479 --> 00:08:32,559
to collect that information pull it all

230
00:08:32,559 --> 00:08:35,760
together and then publish it somewhere

231
00:08:35,760 --> 00:08:38,958
so then uh network admins can can view

232
00:08:38,958 --> 00:08:41,519
it and and see and see what's going on

233
00:08:41,519 --> 00:08:44,800
so how does sm beagle work it works in

234
00:08:44,800 --> 00:08:46,399
five stages and i'm going to walk

235
00:08:46,399 --> 00:08:47,920
through all these stages because again

236
00:08:47,920 --> 00:08:49,920
the code is completely open source it's

237
00:08:49,920 --> 00:08:51,519
out there on github if you think of

238
00:08:51,519 --> 00:08:53,040
something that could be done slightly

239
00:08:53,040 --> 00:08:57,200
better feel free to uh to pitch in

240
00:08:57,200 --> 00:09:00,160
so the first stage is uh in this

241
00:09:00,160 --> 00:09:02,000
instance we're going to look at a client

242
00:09:02,000 --> 00:09:03,519
that's on a vpn because you don't

243
00:09:03,519 --> 00:09:04,880
necessarily need to be on the main

244
00:09:04,880 --> 00:09:05,920
network

245
00:09:05,920 --> 00:09:07,680
this was just to show that we are

246
00:09:07,680 --> 00:09:09,440
working remotely a lot of people work

247
00:09:09,440 --> 00:09:11,360
remotely now and still need to access

248
00:09:11,360 --> 00:09:13,680
smb shares so they tend to access them

249
00:09:13,680 --> 00:09:15,839
over a vpn but you could also be

250
00:09:15,839 --> 00:09:17,920
one of these client users in inside the

251
00:09:17,920 --> 00:09:19,600
internal networks

252
00:09:19,600 --> 00:09:22,720
so the first stage is sm beagle can be

253
00:09:22,720 --> 00:09:24,160
passed um

254
00:09:24,160 --> 00:09:26,000
we don't like the word whitelist in butt

255
00:09:26,000 --> 00:09:27,600
list anymore that should have been

256
00:09:27,600 --> 00:09:29,040
changed

257
00:09:29,040 --> 00:09:30,720
it should have been a loud and delight

258
00:09:30,720 --> 00:09:33,440
list um sorry about that

259
00:09:33,440 --> 00:09:37,279
um but basically you can feed in the um

260
00:09:37,279 --> 00:09:39,600
the the inclusion networks and the

261
00:09:39,600 --> 00:09:42,000
networks that you want to exclude

262
00:09:42,000 --> 00:09:44,000
smb will then also have a look at your

263
00:09:44,000 --> 00:09:46,240
current network stacks so your network

264
00:09:46,240 --> 00:09:48,399
connection so where your email servers

265
00:09:48,399 --> 00:09:49,680
are what domain controller you're

266
00:09:49,680 --> 00:09:51,279
authenticating to are you connected to

267
00:09:51,279 --> 00:09:53,600
any uh application servers that you're

268
00:09:53,600 --> 00:09:56,320
using and it'll it will grab those ip

269
00:09:56,320 --> 00:09:57,920
addresses it'll look at your local

270
00:09:57,920 --> 00:10:00,720
interfaces as well uh so it'll scan any

271
00:10:00,720 --> 00:10:03,200
networks that you're locally connected

272
00:10:03,200 --> 00:10:04,399
to

273
00:10:04,399 --> 00:10:05,920
and then what it will then do is it will

274
00:10:05,920 --> 00:10:08,640
correlate a long list of all of these

275
00:10:08,640 --> 00:10:10,720
subnets on all of these networks that it

276
00:10:10,720 --> 00:10:13,600
wants to use by default if it identifies

277
00:10:13,600 --> 00:10:16,079
like a domain controller

278
00:10:16,079 --> 00:10:18,880
we will take the last octet off change

279
00:10:18,880 --> 00:10:21,760
it to a zero and then do slash 24 which

280
00:10:21,760 --> 00:10:24,720
is um just that's generically that's

281
00:10:24,720 --> 00:10:26,399
what people tend to do that you tend to

282
00:10:26,399 --> 00:10:29,200
use 24 networks quite often which is why

283
00:10:29,200 --> 00:10:33,200
we uh added the allow and the deny lists

284
00:10:33,200 --> 00:10:35,120
because there might be some networks

285
00:10:35,120 --> 00:10:37,519
that you might not want to scan for smb

286
00:10:37,519 --> 00:10:38,640
shares

287
00:10:38,640 --> 00:10:40,959
and

288
00:10:41,200 --> 00:10:43,200
what sm beagle will then do is it will

289
00:10:43,200 --> 00:10:46,079
test connectivity to those networks so

290
00:10:46,079 --> 00:10:48,720
it will basically do a

291
00:10:48,720 --> 00:10:50,240
an nmap scan

292
00:10:50,240 --> 00:10:54,240
but using the native windows built-in uh

293
00:10:54,240 --> 00:10:56,160
connection and it will just go it will

294
00:10:56,160 --> 00:10:58,240
build up that long list of those 24

295
00:10:58,240 --> 00:11:02,320
addresses per subnet sorry 254 addresses

296
00:11:02,320 --> 00:11:04,399
per subnet and it will iterate through

297
00:11:04,399 --> 00:11:06,399
every single ip address looking to see

298
00:11:06,399 --> 00:11:08,839
if anything's responding to tcp

299
00:11:08,839 --> 00:11:12,880
445 which is um

300
00:11:12,880 --> 00:11:15,360
which is uh microsoft ds

301
00:11:15,360 --> 00:11:18,079
awesome uh or network shares

302
00:11:18,079 --> 00:11:20,160
and it will scan through and any ip

303
00:11:20,160 --> 00:11:22,160
address that responds to that tcp port

304
00:11:22,160 --> 00:11:24,560
will get put into a special list which

305
00:11:24,560 --> 00:11:27,120
then gets used in the next stage

306
00:11:27,120 --> 00:11:29,040
so the next stage is once we've

307
00:11:29,040 --> 00:11:31,120
identified those servers that have

308
00:11:31,120 --> 00:11:33,279
responded to 445

309
00:11:33,279 --> 00:11:36,079
we will now go and check those servers

310
00:11:36,079 --> 00:11:38,079
we will go and connect to them and we

311
00:11:38,079 --> 00:11:39,920
will see what open shares they've got

312
00:11:39,920 --> 00:11:41,760
what potential hidden shares they've got

313
00:11:41,760 --> 00:11:42,880
open

314
00:11:42,880 --> 00:11:45,040
and we will then generate a list of all

315
00:11:45,040 --> 00:11:46,720
of the shares that then need to be

316
00:11:46,720 --> 00:11:49,120
scanned

317
00:11:51,440 --> 00:11:53,360
what it will then do

318
00:11:53,360 --> 00:11:55,519
in stage four is it will connect to

319
00:11:55,519 --> 00:11:59,040
every single sm every single unc share

320
00:11:59,040 --> 00:12:01,760
that it's identified it will go through

321
00:12:01,760 --> 00:12:04,639
as a low privileged user uh i think i

322
00:12:04,639 --> 00:12:06,639
forgot to say that that so it only runs

323
00:12:06,639 --> 00:12:09,600
as a low privileged user on a laptop you

324
00:12:09,600 --> 00:12:11,200
don't need any privileges for any of

325
00:12:11,200 --> 00:12:13,440
this and in fact it works better if you

326
00:12:13,440 --> 00:12:14,880
don't run it with any privileged

327
00:12:14,880 --> 00:12:16,160
accounts

328
00:12:16,160 --> 00:12:17,760
and what will happen is it will it will

329
00:12:17,760 --> 00:12:19,920
connect as that user and it will see

330
00:12:19,920 --> 00:12:22,000
what that user can see

331
00:12:22,000 --> 00:12:24,240
can you know what files and folders are

332
00:12:24,240 --> 00:12:26,240
inside that share

333
00:12:26,240 --> 00:12:29,440
can they read write or delete uh in that

334
00:12:29,440 --> 00:12:32,160
share and it will collect information

335
00:12:32,160 --> 00:12:35,120
like creation last updated

336
00:12:35,120 --> 00:12:38,240
file extension and it gathers all this

337
00:12:38,240 --> 00:12:42,320
information about your network shares

338
00:12:43,120 --> 00:12:46,000
the last stage is it will then output

339
00:12:46,000 --> 00:12:48,880
that information directly into elastic

340
00:12:48,880 --> 00:12:50,639
so then we can dashboard it up and can

341
00:12:50,639 --> 00:12:52,880
show you it or it can be dumped into a

342
00:12:52,880 --> 00:12:54,720
csv file

343
00:12:54,720 --> 00:12:57,440
now the beauty of doing it into elastic

344
00:12:57,440 --> 00:13:00,560
is you can run this as multiple users

345
00:13:00,560 --> 00:13:02,880
from multiple devices and then you will

346
00:13:02,880 --> 00:13:05,440
get a much larger

347
00:13:05,440 --> 00:13:07,279
visibility of what your network looks

348
00:13:07,279 --> 00:13:09,519
like and what permissions people have

349
00:13:09,519 --> 00:13:12,800
got and what file shares people can see

350
00:13:12,800 --> 00:13:16,399
so that was the whole idea behind that

351
00:13:16,399 --> 00:13:18,480
uh i think i'm still running just about

352
00:13:18,480 --> 00:13:20,639
on time so let's have a little look at a

353
00:13:20,639 --> 00:13:21,519
demo

354
00:13:21,519 --> 00:13:24,399
so this is a very basic standard network

355
00:13:24,399 --> 00:13:27,200
uh we have a client here

356
00:13:27,200 --> 00:13:30,000
um it's just a windows 10 client and

357
00:13:30,000 --> 00:13:31,680
we've got a couple of servers so we've

358
00:13:31,680 --> 00:13:33,680
got a couple of domain controllers we've

359
00:13:33,680 --> 00:13:37,120
got a couple of uh file servers and

360
00:13:37,120 --> 00:13:41,519
we've got a couple of uh

361
00:13:41,600 --> 00:13:44,399
other smb shares that that shouldn't

362
00:13:44,399 --> 00:13:47,600
really be open for anybody to use

363
00:13:47,600 --> 00:13:50,160
so fingers crossed let's see whether

364
00:13:50,160 --> 00:13:52,240
this demo whether this little video will

365
00:13:52,240 --> 00:13:53,839
work and what i'm going to do is i'm

366
00:13:53,839 --> 00:13:56,639
going to walk you through the video

367
00:13:56,639 --> 00:13:58,959
i'm just going to mute that so what

368
00:13:58,959 --> 00:14:00,639
we've done is we've logged into a

369
00:14:00,639 --> 00:14:05,120
windows 10 box as a low privileged user

370
00:14:05,120 --> 00:14:06,639
uh what we're going to do is we're just

371
00:14:06,639 --> 00:14:07,760
going to have a quick look and we're

372
00:14:07,760 --> 00:14:09,920
going to see that he's got two is we've

373
00:14:09,920 --> 00:14:12,959
got a departmental network share

374
00:14:12,959 --> 00:14:15,199
as you would normally expect we can see

375
00:14:15,199 --> 00:14:16,560
that we've got a couple of different

376
00:14:16,560 --> 00:14:18,000
departments in there we've got customer

377
00:14:18,000 --> 00:14:20,399
care facilities that kind of thing and

378
00:14:20,399 --> 00:14:23,279
we're also doing roaming profiles so

379
00:14:23,279 --> 00:14:25,199
the user's profile is being stored on a

380
00:14:25,199 --> 00:14:27,279
network share

381
00:14:27,279 --> 00:14:28,399
so we're going to open up the command

382
00:14:28,399 --> 00:14:30,079
prompt and we're just going to have a

383
00:14:30,079 --> 00:14:31,839
quick look and just show you that there

384
00:14:31,839 --> 00:14:33,839
are no hidden shares running in the

385
00:14:33,839 --> 00:14:35,680
background i'm not doing any mac smoke

386
00:14:35,680 --> 00:14:38,880
and magic i haven't pre connected to any

387
00:14:38,880 --> 00:14:41,279
network share that we discover during

388
00:14:41,279 --> 00:14:42,399
this uh

389
00:14:42,399 --> 00:14:44,399
during this scan

390
00:14:44,399 --> 00:14:45,440
and we're also just going to have a

391
00:14:45,440 --> 00:14:46,560
quick look and have a look at the

392
00:14:46,560 --> 00:14:48,480
network connections we've got so we've

393
00:14:48,480 --> 00:14:49,920
got we can see here that we've got

394
00:14:49,920 --> 00:14:54,000
connections to a lot of smb shares

395
00:14:54,000 --> 00:14:57,120
and we've got some connections

396
00:14:57,120 --> 00:14:58,720
to various different ip addresses

397
00:14:58,720 --> 00:15:01,839
including domain controllers

398
00:15:01,839 --> 00:15:05,440
so what what we're going to do now is

399
00:15:05,440 --> 00:15:07,839
hopefully

400
00:15:07,839 --> 00:15:10,560
i'm now going to go into use smb now

401
00:15:10,560 --> 00:15:12,959
because we um we're all hackers

402
00:15:12,959 --> 00:15:15,279
everybody loves a good club command line

403
00:15:15,279 --> 00:15:17,680
tool so what we've done is we've built

404
00:15:17,680 --> 00:15:20,320
sm beagle to be a command line tool

405
00:15:20,320 --> 00:15:22,560
uh it has now been digitally signed as

406
00:15:22,560 --> 00:15:24,720
well so if you download sm beagle from

407
00:15:24,720 --> 00:15:27,440
the internet and try and run it it will

408
00:15:27,440 --> 00:15:30,160
not come up with any

409
00:15:30,160 --> 00:15:32,079
certificate warnings with windows

410
00:15:32,079 --> 00:15:34,880
defender we've spent a little bit of our

411
00:15:34,880 --> 00:15:37,519
money at punk security and we've gone

412
00:15:37,519 --> 00:15:39,680
and bought a code signing certificate to

413
00:15:39,680 --> 00:15:41,440
make sure that you know everything's all

414
00:15:41,440 --> 00:15:42,880
clean when you're when you're running

415
00:15:42,880 --> 00:15:44,560
these things because

416
00:15:44,560 --> 00:15:46,959
if you can't trust a security tool to be

417
00:15:46,959 --> 00:15:48,320
secure then you shouldn't really be

418
00:15:48,320 --> 00:15:49,360
running it

419
00:15:49,360 --> 00:15:51,040
so inside here we've got our various

420
00:15:51,040 --> 00:15:52,560
different switches where we've got the

421
00:15:52,560 --> 00:15:54,800
first switch here which is minus c that

422
00:15:54,800 --> 00:15:57,120
allows you to specify the csv file that

423
00:15:57,120 --> 00:15:59,199
you want to output to we've got minus e

424
00:15:59,199 --> 00:16:01,120
which allows you to specify the ip

425
00:16:01,120 --> 00:16:04,480
address of your elastic host and by

426
00:16:04,480 --> 00:16:06,880
default we've we've hard coded it in to

427
00:16:06,880 --> 00:16:09,600
run on tcp port to

428
00:16:09,600 --> 00:16:13,800
the default port which is 9220.9200

429
00:16:15,600 --> 00:16:18,079
and we are looking to adjust that so

430
00:16:18,079 --> 00:16:20,160
then you can specify your own there are

431
00:16:20,160 --> 00:16:22,399
some other switches inside here like the

432
00:16:22,399 --> 00:16:25,759
minus f switch which will allow you to

433
00:16:25,759 --> 00:16:27,279
you know if you've got a very large

434
00:16:27,279 --> 00:16:30,000
network it will take the first file

435
00:16:30,000 --> 00:16:32,480
inside the folder and it will document

436
00:16:32,480 --> 00:16:34,000
out those set

437
00:16:34,000 --> 00:16:35,360
rather than doing every single file

438
00:16:35,360 --> 00:16:37,440
inside that folder it will check to see

439
00:16:37,440 --> 00:16:39,120
if the user can rewrite and delete to

440
00:16:39,120 --> 00:16:41,440
that file and then move on to the next

441
00:16:41,440 --> 00:16:43,279
folder so therefore you can speed it up

442
00:16:43,279 --> 00:16:45,040
because if you've got thousands of files

443
00:16:45,040 --> 00:16:46,480
and thousands of directories and

444
00:16:46,480 --> 00:16:48,399
thousands of network chairs this is

445
00:16:48,399 --> 00:16:50,240
going to take forever so the easiest

446
00:16:50,240 --> 00:16:52,880
thing to do for us is to allow you to be

447
00:16:52,880 --> 00:16:54,959
able to just document the first one and

448
00:16:54,959 --> 00:16:56,639
make an assumption that the rest of the

449
00:16:56,639 --> 00:16:58,240
files inside that folder have got the

450
00:16:58,240 --> 00:17:01,120
same permission set

451
00:17:02,480 --> 00:17:05,599
uh we've also got some other areas here

452
00:17:05,599 --> 00:17:08,640
uh like the exclusions networks so

453
00:17:08,640 --> 00:17:10,160
remember i was telling you about the

454
00:17:10,160 --> 00:17:11,520
exclusions

455
00:17:11,520 --> 00:17:14,160
uh excluded networks and also the

456
00:17:14,160 --> 00:17:16,720
include networks as well we've got those

457
00:17:16,720 --> 00:17:19,919
options inside there as well for you

458
00:17:19,919 --> 00:17:21,839
you can run this quietly if you wanted

459
00:17:21,839 --> 00:17:24,160
to so you don't see the output but by

460
00:17:24,160 --> 00:17:26,160
default it will give you a nice little

461
00:17:26,160 --> 00:17:30,079
bit of information as we're running it

462
00:17:30,840 --> 00:17:35,039
so just skip ahead a little bit

463
00:17:35,039 --> 00:17:36,799
right so what we're going to do now is

464
00:17:36,799 --> 00:17:39,120
we're going to run sm beagle uh we're

465
00:17:39,120 --> 00:17:41,600
going to output to an elastic service

466
00:17:41,600 --> 00:17:44,000
and we're going to exclude our local

467
00:17:44,000 --> 00:17:47,280
local area so if i just pause this for a

468
00:17:47,280 --> 00:17:48,240
second

469
00:17:48,240 --> 00:17:49,760
the first thing that you're going to see

470
00:17:49,760 --> 00:17:52,080
is it's found four networks that it's

471
00:17:52,080 --> 00:17:54,720
currently connected to so uh we can see

472
00:17:54,720 --> 00:17:56,160
here we've got

473
00:17:56,160 --> 00:17:57,120
a one

474
00:17:57,120 --> 00:17:59,840
one seven two sixteen ten dot

475
00:17:59,840 --> 00:18:04,080
24 network 172 16 100.0

476
00:18:04,080 --> 00:18:05,679
24 network

477
00:18:05,679 --> 00:18:06,720
um

478
00:18:06,720 --> 00:18:10,480
zero network and then uh ipv6 it doesn't

479
00:18:10,480 --> 00:18:12,799
currently work across a ipv6 that's

480
00:18:12,799 --> 00:18:14,240
something that we that we're looking at

481
00:18:14,240 --> 00:18:15,760
fixing later on

482
00:18:15,760 --> 00:18:17,200
and

483
00:18:17,200 --> 00:18:20,080
we're then going to exclude the ipv6

484
00:18:20,080 --> 00:18:22,160
network uh and it's going to tell you

485
00:18:22,160 --> 00:18:23,440
the networks that it's going to be able

486
00:18:23,440 --> 00:18:24,960
to scan against

487
00:18:24,960 --> 00:18:27,360
now what it's been able to identify here

488
00:18:27,360 --> 00:18:29,280
is it's identified

489
00:18:29,280 --> 00:18:31,440
five different ip addresses that it can

490
00:18:31,440 --> 00:18:34,240
currently connect to and so it can go

491
00:18:34,240 --> 00:18:35,440
and scan

492
00:18:35,440 --> 00:18:37,840
it's then remember that's stage two

493
00:18:37,840 --> 00:18:39,760
stage three is here

494
00:18:39,760 --> 00:18:41,679
so you can see here that we've got all

495
00:18:41,679 --> 00:18:44,559
of the net unc network shares that we

496
00:18:44,559 --> 00:18:47,039
can that we could connect to so we could

497
00:18:47,039 --> 00:18:49,440
we we saw previously that you that we

498
00:18:49,440 --> 00:18:52,480
could see the departmental uh unc share

499
00:18:52,480 --> 00:18:54,400
we can also see the pro net the user

500
00:18:54,400 --> 00:18:56,799
profiles share which we're connected to

501
00:18:56,799 --> 00:18:58,640
but i'm going about there's a software

502
00:18:58,640 --> 00:19:00,080
share area

503
00:19:00,080 --> 00:19:02,799
uh we weren't mapped to that previously

504
00:19:02,799 --> 00:19:04,960
and we didn't we weren't mapped to any

505
00:19:04,960 --> 00:19:07,200
of these net and syslog

506
00:19:07,200 --> 00:19:09,440
false shares either

507
00:19:09,440 --> 00:19:11,679
so they're all new newly discovered as

508
00:19:11,679 --> 00:19:13,919
well so if i just leave that to continue

509
00:19:13,919 --> 00:19:16,160
running what it's going to do now

510
00:19:16,160 --> 00:19:18,240
in this la in stage four

511
00:19:18,240 --> 00:19:19,840
is it's going to connect to every single

512
00:19:19,840 --> 00:19:21,679
one of these network shares and it's

513
00:19:21,679 --> 00:19:23,520
going to go and download

514
00:19:23,520 --> 00:19:25,200
it's going to go and connect and it's

515
00:19:25,200 --> 00:19:28,000
going to go and extract all of the

516
00:19:28,000 --> 00:19:29,440
um

517
00:19:29,440 --> 00:19:32,559
all of the the files the folders and the

518
00:19:32,559 --> 00:19:35,200
permissions that user has to those files

519
00:19:35,200 --> 00:19:38,080
and folders

520
00:19:38,080 --> 00:19:40,320
if we just skip along

521
00:19:40,320 --> 00:19:41,840
uh so what we're going to do now is i'm

522
00:19:41,840 --> 00:19:43,679
going to rerun this but i'm going to

523
00:19:43,679 --> 00:19:46,400
output it to a csv file so then we can

524
00:19:46,400 --> 00:19:48,160
see what's inside the csv file because

525
00:19:48,160 --> 00:19:50,720
i'm going to show you the elastic the

526
00:19:50,720 --> 00:19:52,880
cabana dashboards that we've built for

527
00:19:52,880 --> 00:19:56,160
people uh as just like a bear basics

528
00:19:56,160 --> 00:19:58,240
kind of this is this is how you can get

529
00:19:58,240 --> 00:19:59,520
in there and you can have a look at

530
00:19:59,520 --> 00:20:00,559
stuff

531
00:20:00,559 --> 00:20:03,280
so if we just skip ahead a little bit

532
00:20:03,280 --> 00:20:06,720
and here is the csv file so it's just a

533
00:20:06,720 --> 00:20:08,799
text delimited csv file and the kind of

534
00:20:08,799 --> 00:20:09,840
things that you're going to get is

535
00:20:09,840 --> 00:20:11,440
you're going to get the file name

536
00:20:11,440 --> 00:20:12,799
at the beginning then you're going to

537
00:20:12,799 --> 00:20:14,480
get the file extension then you're going

538
00:20:14,480 --> 00:20:16,880
to get the username that identified that

539
00:20:16,880 --> 00:20:19,200
found that file the workstation that it

540
00:20:19,200 --> 00:20:20,559
was found from

541
00:20:20,559 --> 00:20:22,640
the full unc path

542
00:20:22,640 --> 00:20:25,600
the creation time blast right time as

543
00:20:25,600 --> 00:20:27,919
well which is collected from the ntfs

544
00:20:27,919 --> 00:20:29,200
data

545
00:20:29,200 --> 00:20:31,760
and was the user able to read write or

546
00:20:31,760 --> 00:20:33,039
delete

547
00:20:33,039 --> 00:20:35,039
that file

548
00:20:35,039 --> 00:20:35,840
uh

549
00:20:35,840 --> 00:20:37,840
and the um

550
00:20:37,840 --> 00:20:40,880
the directory type which will be smb

551
00:20:40,880 --> 00:20:42,720
and then the base direct you know like

552
00:20:42,720 --> 00:20:44,960
the full unc patch so you can get to it

553
00:20:44,960 --> 00:20:46,960
later on in um

554
00:20:46,960 --> 00:20:48,799
later on now

555
00:20:48,799 --> 00:20:50,640
one of the things that we've also

556
00:20:50,640 --> 00:20:52,799
identified is that red teamers have

557
00:20:52,799 --> 00:20:55,360
started to use smb eagle during pen

558
00:20:55,360 --> 00:20:58,159
tests for this exact reason

559
00:20:58,159 --> 00:20:59,280
um

560
00:20:59,280 --> 00:21:01,520
they've identified that they can go and

561
00:21:01,520 --> 00:21:04,880
hunt down software shares because

562
00:21:04,880 --> 00:21:07,440
which admin would ever hard code a

563
00:21:07,440 --> 00:21:09,760
password inside a configuration or a

564
00:21:09,760 --> 00:21:11,600
deployment script that would never

565
00:21:11,600 --> 00:21:14,159
happen would it so red team is beginning

566
00:21:14,159 --> 00:21:16,720
to love this and pen testers are as well

567
00:21:16,720 --> 00:21:18,000
with um

568
00:21:18,000 --> 00:21:20,159
i'll come on to that a little bit later

569
00:21:20,159 --> 00:21:21,200
on

570
00:21:21,200 --> 00:21:23,679
so that is the end of the demo

571
00:21:23,679 --> 00:21:25,840
so what does the cabana dashboard looks

572
00:21:25,840 --> 00:21:27,360
like

573
00:21:27,360 --> 00:21:28,840
so

574
00:21:28,840 --> 00:21:32,720
this oh sorry that's that's my my voice

575
00:21:32,720 --> 00:21:34,159
i thought somebody was talking over me

576
00:21:34,159 --> 00:21:37,200
there so inside elastic what we do is we

577
00:21:37,200 --> 00:21:38,640
get uh

578
00:21:38,640 --> 00:21:41,200
sm beagle to write out a brand new index

579
00:21:41,200 --> 00:21:43,440
every single time this runs so it'll

580
00:21:43,440 --> 00:21:45,760
write it out with the current date and

581
00:21:45,760 --> 00:21:47,760
it will dump the data into there for you

582
00:21:47,760 --> 00:21:52,240
so you can now do a historical um

583
00:21:52,240 --> 00:21:54,960
next series of scans as well so not only

584
00:21:54,960 --> 00:21:56,400
can you do it for multiple users

585
00:21:56,400 --> 00:21:58,400
multiple devices but you can also get

586
00:21:58,400 --> 00:22:01,360
this to run over multiple days and see a

587
00:22:01,360 --> 00:22:02,799
period of time

588
00:22:02,799 --> 00:22:04,720
how are new network shares being

589
00:22:04,720 --> 00:22:06,559
discovered or

590
00:22:06,559 --> 00:22:08,960
are new vulnerabilities being introduced

591
00:22:08,960 --> 00:22:11,440
and how you know how do we need to

592
00:22:11,440 --> 00:22:12,799
address this

593
00:22:12,799 --> 00:22:15,120
um this is just going over the cabana

594
00:22:15,120 --> 00:22:16,480
pattern

595
00:22:16,480 --> 00:22:18,480
uh inside here this is just basically

596
00:22:18,480 --> 00:22:19,520
showing you

597
00:22:19,520 --> 00:22:21,520
uh all of that good data that we've got

598
00:22:21,520 --> 00:22:24,159
inside the csv file it's now visualized

599
00:22:24,159 --> 00:22:26,320
and it's a little neater and easier to

600
00:22:26,320 --> 00:22:28,240
read inside elastic

601
00:22:28,240 --> 00:22:30,159
so we can still go exactly the same

602
00:22:30,159 --> 00:22:32,640
information you can see that the user's

603
00:22:32,640 --> 00:22:36,640
profile areas um

604
00:22:37,360 --> 00:22:38,159
and

605
00:22:38,159 --> 00:22:40,559
the information that we that we saw

606
00:22:40,559 --> 00:22:43,200
inside the csv file this is the cabana

607
00:22:43,200 --> 00:22:46,000
dashboard uh so it will easily just show

608
00:22:46,000 --> 00:22:48,000
you how many you need directories you've

609
00:22:48,000 --> 00:22:50,240
got across your network where your files

610
00:22:50,240 --> 00:22:52,640
shares are how many unique file names

611
00:22:52,640 --> 00:22:54,799
have you got what are your your file

612
00:22:54,799 --> 00:22:56,880
extensions they that that comes in quite

613
00:22:56,880 --> 00:22:58,960
handy for the pen testers because now

614
00:22:58,960 --> 00:23:01,039
they can drill down and just go for the

615
00:23:01,039 --> 00:23:05,919
ps1s or the any files or the uh the

616
00:23:05,919 --> 00:23:08,240
batch files and they can drill straight

617
00:23:08,240 --> 00:23:09,600
down and find out exactly where those

618
00:23:09,600 --> 00:23:11,440
files are so they can go and evaluate

619
00:23:11,440 --> 00:23:12,960
them

620
00:23:12,960 --> 00:23:14,559
so in this instance we've drilled down

621
00:23:14,559 --> 00:23:16,240
into the software share so we can see

622
00:23:16,240 --> 00:23:18,559
that there's six uh unique file

623
00:23:18,559 --> 00:23:21,200
extensions we can see ps1s we can see pi

624
00:23:21,200 --> 00:23:24,240
files we can see some text files

625
00:23:24,240 --> 00:23:26,640
and as we come down we can then see

626
00:23:26,640 --> 00:23:28,400
exactly where those script files are so

627
00:23:28,400 --> 00:23:30,159
the pen testers can go and drill

628
00:23:30,159 --> 00:23:33,760
straight into that information

629
00:23:34,880 --> 00:23:37,919
uh inside the if you were to remove all

630
00:23:37,919 --> 00:23:38,880
of the

631
00:23:38,880 --> 00:23:41,120
filters up at the top you can then start

632
00:23:41,120 --> 00:23:44,080
seeing the unique paths and you can see

633
00:23:44,080 --> 00:23:46,159
are those users able to read write and

634
00:23:46,159 --> 00:23:48,080
delete to those different directories

635
00:23:48,080 --> 00:23:51,120
into those files and

636
00:23:51,120 --> 00:23:52,960
and and that could be really useful

637
00:23:52,960 --> 00:23:56,159
information uh so for a software share

638
00:23:56,159 --> 00:23:58,960
why should a user be able to read write

639
00:23:58,960 --> 00:24:00,720
and delete to a software share a

640
00:24:00,720 --> 00:24:02,559
standard user well they shouldn't

641
00:24:02,559 --> 00:24:04,559
therefore that's an identity

642
00:24:04,559 --> 00:24:06,559
identifies you five minutes left thank

643
00:24:06,559 --> 00:24:07,600
you

644
00:24:07,600 --> 00:24:09,120
and

645
00:24:09,120 --> 00:24:11,279
so what i'm going to do

646
00:24:11,279 --> 00:24:13,360
is i'm going to move up quickly on to

647
00:24:13,360 --> 00:24:14,799
the um

648
00:24:14,799 --> 00:24:18,240
to to our future roadmap because we we

649
00:24:18,240 --> 00:24:19,440
believe that once we've started

650
00:24:19,440 --> 00:24:21,440
developing these tools it's no good just

651
00:24:21,440 --> 00:24:22,880
developing a tool and then throwing it

652
00:24:22,880 --> 00:24:24,400
over the line and just going yeah aren't

653
00:24:24,400 --> 00:24:27,039
we great you know and what we want to do

654
00:24:27,039 --> 00:24:28,960
is we want to take in more input so

655
00:24:28,960 --> 00:24:30,400
these are some of the inputs that we've

656
00:24:30,400 --> 00:24:32,720
had over the last kind of

657
00:24:32,720 --> 00:24:34,000
um

658
00:24:34,000 --> 00:24:36,480
six months of the life of sm beagle so

659
00:24:36,480 --> 00:24:38,720
people have asked us can we introduce

660
00:24:38,720 --> 00:24:41,440
the art tables you know can you can you

661
00:24:41,440 --> 00:24:43,360
pull that information in during stage

662
00:24:43,360 --> 00:24:45,520
one yeah we absolutely can we can also

663
00:24:45,520 --> 00:24:47,360
look at dns cache and we are looking at

664
00:24:47,360 --> 00:24:48,720
those at the moment

665
00:24:48,720 --> 00:24:50,320
uh one of the requests by the pen

666
00:24:50,320 --> 00:24:52,080
testing community and the red team is

667
00:24:52,080 --> 00:24:54,480
was to port this onto kali linux we have

668
00:24:54,480 --> 00:24:57,520
done that now and it is being launched

669
00:24:57,520 --> 00:25:00,080
and to the cali repo in the next few

670
00:25:00,080 --> 00:25:01,200
weeks

671
00:25:01,200 --> 00:25:03,279
uh we will be hopefully launching that

672
00:25:03,279 --> 00:25:05,200
in the next few weeks so there is a pen

673
00:25:05,200 --> 00:25:07,279
testers version of this and then you can

674
00:25:07,279 --> 00:25:09,440
just rather than looking at your local

675
00:25:09,440 --> 00:25:11,919
network connections you can only specify

676
00:25:11,919 --> 00:25:13,919
on the kali tool exactly what networks

677
00:25:13,919 --> 00:25:15,840
you want to scan

678
00:25:15,840 --> 00:25:17,600
but again it's a it's a really great

679
00:25:17,600 --> 00:25:18,640
tool

680
00:25:18,640 --> 00:25:20,799
uh we're also looking at how we can look

681
00:25:20,799 --> 00:25:23,679
at legacy file shares as well so ones

682
00:25:23,679 --> 00:25:26,400
that run on net bios you know

683
00:25:26,400 --> 00:25:29,200
and other older networks technologies

684
00:25:29,200 --> 00:25:30,000
because

685
00:25:30,000 --> 00:25:32,159
there are a lot of older network shares

686
00:25:32,159 --> 00:25:34,159
out there like the sift shares and stuff

687
00:25:34,159 --> 00:25:36,240
like that we're also looking at how we

688
00:25:36,240 --> 00:25:39,360
can integrate this into um into cloud

689
00:25:39,360 --> 00:25:41,200
technologies so we have

690
00:25:41,200 --> 00:25:43,120
designed something that will work now

691
00:25:43,120 --> 00:25:46,000
with onedrive and sharepoint so you can

692
00:25:46,000 --> 00:25:47,520
scan your onedrive and your sharepoint

693
00:25:47,520 --> 00:25:49,600
environments and you can identify what

694
00:25:49,600 --> 00:25:51,760
file permissions are up there but it's

695
00:25:51,760 --> 00:25:55,120
not ready yet for a general release

696
00:25:55,120 --> 00:25:57,120
we've also been asked can we

697
00:25:57,120 --> 00:25:59,360
put a regex text scanner in there as

698
00:25:59,360 --> 00:26:00,720
well so

699
00:26:00,720 --> 00:26:02,240
when the pen testers are running their

700
00:26:02,240 --> 00:26:03,840
tools they can look for the word

701
00:26:03,840 --> 00:26:07,039
password or look for a particular phrase

702
00:26:07,039 --> 00:26:09,760
inside the text files if you want to

703
00:26:09,760 --> 00:26:13,120
scan against like a txt file or or a ps1

704
00:26:13,120 --> 00:26:14,880
file or a pi file

705
00:26:14,880 --> 00:26:17,679
and we'd also like to detail out more

706
00:26:17,679 --> 00:26:20,559
about the access control lists so can we

707
00:26:20,559 --> 00:26:23,919
pull out the ntfs acls and dump those

708
00:26:23,919 --> 00:26:25,919
out so then people can build up a much

709
00:26:25,919 --> 00:26:28,720
richer version of what their network

710
00:26:28,720 --> 00:26:31,279
scale scans look uh network shares look

711
00:26:31,279 --> 00:26:32,480
like

712
00:26:32,480 --> 00:26:33,919
and the last one is we would like to

713
00:26:33,919 --> 00:26:36,240
give you command line stats as well so

714
00:26:36,240 --> 00:26:38,640
when you finish running the cli tool you

715
00:26:38,640 --> 00:26:41,200
then get a nice little uh

716
00:26:41,200 --> 00:26:43,760
little little summary of what this looks

717
00:26:43,760 --> 00:26:45,520
like you know how many files have we

718
00:26:45,520 --> 00:26:48,159
scanned uh how many how many readable

719
00:26:48,159 --> 00:26:51,520
writable directories have we identified

720
00:26:51,520 --> 00:26:53,600
and as i say this is completely open

721
00:26:53,600 --> 00:26:55,120
source so

722
00:26:55,120 --> 00:26:57,440
please feel free to go to github go

723
00:26:57,440 --> 00:27:00,000
download the pre-compiled executable

724
00:27:00,000 --> 00:27:02,400
play with it tell us if you've got any

725
00:27:02,400 --> 00:27:04,720
problems with it you know feedback is

726
00:27:04,720 --> 00:27:06,640
key to us because it if we don't get

727
00:27:06,640 --> 00:27:09,200
feedback we can't enhance more more

728
00:27:09,200 --> 00:27:11,200
features about this so i'll open the

729
00:27:11,200 --> 00:27:14,240
floor to any questions

730
00:27:14,400 --> 00:27:16,799
awesome so i'm just going to uh very

731
00:27:16,799 --> 00:27:18,960
quickly go to the questions and answers

732
00:27:18,960 --> 00:27:21,679
uh section right so um

733
00:27:21,679 --> 00:27:24,080
one of the first questions we've had is

734
00:27:24,080 --> 00:27:25,919
that this is um

735
00:27:25,919 --> 00:27:28,960
a great tool that's more of a statement

736
00:27:28,960 --> 00:27:32,240
um how do you identify if the shares the

737
00:27:32,240 --> 00:27:35,360
tool discovers are real or honey pots is

738
00:27:35,360 --> 00:27:36,159
there

739
00:27:36,159 --> 00:27:38,559
can you make the distinction

740
00:27:38,559 --> 00:27:41,200
not currently no um so what we're doing

741
00:27:41,200 --> 00:27:42,559
is we're just

742
00:27:42,559 --> 00:27:44,799
we're just documenting the smb shares

743
00:27:44,799 --> 00:27:46,960
and then we just put that information

744
00:27:46,960 --> 00:27:49,200
out into elastic and then it'll allow

745
00:27:49,200 --> 00:27:52,000
you to identify you you can then do a

746
00:27:52,000 --> 00:27:54,880
bit of investigation the operations team

747
00:27:54,880 --> 00:27:56,799
should know where their honeypot ones

748
00:27:56,799 --> 00:27:58,559
are so they could technically they could

749
00:27:58,559 --> 00:28:01,600
exclude that host from the network scan

750
00:28:01,600 --> 00:28:03,600
if it's a red team that's or a pen

751
00:28:03,600 --> 00:28:05,360
tester that's running this they won't

752
00:28:05,360 --> 00:28:07,360
know that until they go and have a look

753
00:28:07,360 --> 00:28:10,320
at that networks yet

754
00:28:11,600 --> 00:28:14,080
so hopefully that answers the question

755
00:28:14,080 --> 00:28:16,640
it does thank you so much um we also

756
00:28:16,640 --> 00:28:18,559
have another question which would be uh

757
00:28:18,559 --> 00:28:19,840
would you be able to drop the link in

758
00:28:19,840 --> 00:28:21,520
the chat um some people weren't able to

759
00:28:21,520 --> 00:28:22,960
screenshot it in time so i know that

760
00:28:22,960 --> 00:28:24,320
would be greatly appreciated if it were

761
00:28:24,320 --> 00:28:25,760
in the twitch

762
00:28:25,760 --> 00:28:29,360
yep by all means i can do that now uh

763
00:28:29,360 --> 00:28:32,559
i'm i i am not i've done it i've done it

764
00:28:32,559 --> 00:28:34,720
oh you've already done it thank you

765
00:28:34,720 --> 00:28:36,080
i'm not the greatest

766
00:28:36,080 --> 00:28:38,240
i'm not the greatest with the uh with

767
00:28:38,240 --> 00:28:39,919
zoom at the moment so i'm

768
00:28:39,919 --> 00:28:41,520
getting myself on twitch i'm getting

769
00:28:41,520 --> 00:28:43,760
myself brought up to

770
00:28:43,760 --> 00:28:46,480
hey no worries you're doing fantastic

771
00:28:46,480 --> 00:28:47,919
and i believe we have one more question

772
00:28:47,919 --> 00:28:48,960
nikos

773
00:28:48,960 --> 00:28:51,360
uh we do not it was the link

774
00:28:51,360 --> 00:28:54,480
oh it was just the link oh excellent so

775
00:28:54,480 --> 00:28:55,840
we do

776
00:28:55,840 --> 00:28:57,760
so i'm gonna put a little plug in here

777
00:28:57,760 --> 00:28:59,679
uh if you head across to punch security

778
00:28:59,679 --> 00:29:01,760
dot code uk you'll find that we also

779
00:29:01,760 --> 00:29:03,919
have another great open source tool

780
00:29:03,919 --> 00:29:06,720
which allows you to build uh

781
00:29:06,720 --> 00:29:09,039
web server logs and it that might not

782
00:29:09,039 --> 00:29:11,120
sound very interesting but it hides an

783
00:29:11,120 --> 00:29:14,000
attack inside the web server log for you

784
00:29:14,000 --> 00:29:16,240
to go and try and find so it's almost

785
00:29:16,240 --> 00:29:18,880
like a a little threat hunting ctf check

786
00:29:18,880 --> 00:29:20,799
automated challenge and every time you

787
00:29:20,799 --> 00:29:22,960
run uh phone spoof

788
00:29:22,960 --> 00:29:25,039
which is the name of the python script

789
00:29:25,039 --> 00:29:27,520
it will generate you a brand new set of

790
00:29:27,520 --> 00:29:29,840
web blogs so if you think sm beagle's

791
00:29:29,840 --> 00:29:33,120
good go check out pune spoof

792
00:29:33,120 --> 00:29:34,640
we've actually been using them for the

793
00:29:34,640 --> 00:29:35,679
ctf

794
00:29:35,679 --> 00:29:38,720
that's next week yeah i know

795
00:29:38,720 --> 00:29:41,919
it is a great tool um that we have got

796
00:29:41,919 --> 00:29:44,159
another talk about that uh but i

797
00:29:44,159 --> 00:29:47,200
delivered that uh b sides in dublin just

798
00:29:47,200 --> 00:29:49,520
the other week so i thought i'd do we

799
00:29:49,520 --> 00:29:51,600
thought we'd do sm beagle this time

800
00:29:51,600 --> 00:29:52,880
because it's another great tool that

801
00:29:52,880 --> 00:29:54,559
we've built and we have got some other

802
00:29:54,559 --> 00:29:56,640
tools that are coming along the line uh

803
00:29:56,640 --> 00:29:58,320
that will be making open source as well

804
00:29:58,320 --> 00:30:00,720
but yeah this one this one hasn't had a

805
00:30:00,720 --> 00:30:02,960
lot of traction or a lot of

806
00:30:02,960 --> 00:30:05,360
visibility at the moment

807
00:30:05,360 --> 00:30:07,760
yeah thanks a lot daniel for uh

808
00:30:07,760 --> 00:30:09,120
subbing in for

809
00:30:09,120 --> 00:30:10,000
simon

810
00:30:10,000 --> 00:30:11,120
uh

811
00:30:11,120 --> 00:30:12,720
i hope everything's going to be all

812
00:30:12,720 --> 00:30:14,480
right with him and uh yeah thanks for

813
00:30:14,480 --> 00:30:16,159
your time no problem

814
00:30:16,159 --> 00:30:19,279
very much guys

