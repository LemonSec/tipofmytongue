1
00:00:06,319 --> 00:00:07,520
and we are live

2
00:00:07,520 --> 00:00:10,559
boom hello everybody

3
00:00:10,559 --> 00:00:13,519
and welcome i am margando and first i'd

4
00:00:13,519 --> 00:00:15,920
like to thank the digital overdose for

5
00:00:15,920 --> 00:00:17,119
for

6
00:00:17,119 --> 00:00:20,320
hosting this this event and

7
00:00:20,320 --> 00:00:22,960
in this short video presentation i'll be

8
00:00:22,960 --> 00:00:24,000
covering some

9
00:00:24,000 --> 00:00:27,039
uh some quick data wrangling processes

10
00:00:27,039 --> 00:00:27,920
too

11
00:00:27,920 --> 00:00:30,560
to parse through a complicated set of

12
00:00:30,560 --> 00:00:32,079
information with linux

13
00:00:32,079 --> 00:00:34,640
and this will be a little bit fast-paced

14
00:00:34,640 --> 00:00:35,680
but

15
00:00:35,680 --> 00:00:38,480
i expect to convey some basics to get

16
00:00:38,480 --> 00:00:39,520
you started

17
00:00:39,520 --> 00:00:42,160
so you know what to do if you're

18
00:00:42,160 --> 00:00:44,320
interested in

19
00:00:44,320 --> 00:00:46,399
going through the whole exercise on your

20
00:00:46,399 --> 00:00:47,440
own

21
00:00:47,440 --> 00:00:49,520
you can of course contact me anytime if

22
00:00:49,520 --> 00:00:51,120
you have any questions

23
00:00:51,120 --> 00:00:53,840
and you will find this exercises

24
00:00:53,840 --> 00:00:54,879
download link

25
00:00:54,879 --> 00:00:57,840
at the end so you can get started and

26
00:00:57,840 --> 00:00:59,760
actually do what i'm doing here and a

27
00:00:59,760 --> 00:01:00,800
lot more

28
00:01:00,800 --> 00:01:03,920
along with some uh extra resources and

29
00:01:03,920 --> 00:01:06,080
cool links and interesting reads about

30
00:01:06,080 --> 00:01:07,200
the topic

31
00:01:07,200 --> 00:01:11,200
and let's get started a little bit about

32
00:01:11,200 --> 00:01:11,680
me

33
00:01:11,680 --> 00:01:15,840
i actually started my journey into i.t

34
00:01:15,840 --> 00:01:18,640
web and cyber security just recently out

35
00:01:18,640 --> 00:01:20,479
of sheer personal curiosity

36
00:01:20,479 --> 00:01:23,520
around 2019

37
00:01:23,520 --> 00:01:26,159
i'm originally a mechanical engineer

38
00:01:26,159 --> 00:01:26,799
myself

39
00:01:26,799 --> 00:01:30,799
and one year ago was when my interests

40
00:01:30,799 --> 00:01:33,920
in this industry really picked and i

41
00:01:33,920 --> 00:01:36,560
started considering my enthusiasm and

42
00:01:36,560 --> 00:01:37,680
hobby about it

43
00:01:37,680 --> 00:01:41,360
could actually work as a driving engine

44
00:01:41,360 --> 00:01:42,320
for it as a

45
00:01:42,320 --> 00:01:45,520
profession i've been breathing and

46
00:01:45,520 --> 00:01:47,439
needing all things ethical hacking

47
00:01:47,439 --> 00:01:50,079
infosec and cyber security since then

48
00:01:50,079 --> 00:01:51,200
and

49
00:01:51,200 --> 00:01:54,399
so i'm really delighted to to be here

50
00:01:54,399 --> 00:01:54,880
with you

51
00:01:54,880 --> 00:01:56,960
to to share some cool and useful

52
00:01:56,960 --> 00:01:58,640
information

53
00:01:58,640 --> 00:02:02,000
uh also uh i'm interested in stoic and

54
00:02:02,000 --> 00:02:03,600
eastern philosophies in my

55
00:02:03,600 --> 00:02:06,560
spare times and and i've also been

56
00:02:06,560 --> 00:02:07,360
playing guitar

57
00:02:07,360 --> 00:02:09,758
days for 22 years now 10 of them

58
00:02:09,758 --> 00:02:11,038
professionally in a

59
00:02:11,038 --> 00:02:14,319
heavy metal band and

60
00:02:14,319 --> 00:02:17,920
let's get started with it now

61
00:02:17,920 --> 00:02:20,800
what are we actually doing here we will

62
00:02:20,800 --> 00:02:22,480
be looking at

63
00:02:22,480 --> 00:02:25,680
an actual real scenario network bucket

64
00:02:25,680 --> 00:02:27,200
capture file

65
00:02:27,200 --> 00:02:29,680
which is containing malicious activity

66
00:02:29,680 --> 00:02:30,560
inside

67
00:02:30,560 --> 00:02:33,200
a network and i'll be demonstrating an

68
00:02:33,200 --> 00:02:33,760
initial

69
00:02:33,760 --> 00:02:37,280
examination of it via the linux

70
00:02:37,280 --> 00:02:40,400
command line interface or cli and the

71
00:02:40,400 --> 00:02:41,519
search will be

72
00:02:41,519 --> 00:02:46,319
guided for us by some information and

73
00:02:46,319 --> 00:02:49,599
alerts triggered by a nsm or network

74
00:02:49,599 --> 00:02:52,080
security monitoring tool

75
00:02:52,080 --> 00:02:54,720
and the tools that we will be using here

76
00:02:54,720 --> 00:02:56,000
are tcp dump

77
00:02:56,000 --> 00:02:58,800
and additionally some network miner or

78
00:02:58,800 --> 00:02:59,680
wireshark

79
00:02:59,680 --> 00:03:02,159
if you're more comfortable with

80
00:03:02,159 --> 00:03:03,519
wireshark

81
00:03:03,519 --> 00:03:06,959
now i know network miner is a windows 2

82
00:03:06,959 --> 00:03:08,959
but it's sometimes used in

83
00:03:08,959 --> 00:03:12,480
linux distributions used for

84
00:03:12,480 --> 00:03:16,080
digital forensics and just it happens to

85
00:03:16,080 --> 00:03:16,640
be a

86
00:03:16,640 --> 00:03:19,680
personal favorite of mine so in either

87
00:03:19,680 --> 00:03:20,319
case

88
00:03:20,319 --> 00:03:22,560
you can find all the how to's in the

89
00:03:22,560 --> 00:03:24,480
reference section

90
00:03:24,480 --> 00:03:27,760
as it is very simple to set up but it

91
00:03:27,760 --> 00:03:30,840
can be a little bit tricky at times

92
00:03:30,840 --> 00:03:34,000
and what we're expecting to

93
00:03:34,000 --> 00:03:36,400
what we're expecting together and in

94
00:03:36,400 --> 00:03:37,040
these

95
00:03:37,040 --> 00:03:41,120
exercises as uh indicators of compromise

96
00:03:41,120 --> 00:03:42,159
or iocs

97
00:03:42,159 --> 00:03:44,000
are some malicious files being

98
00:03:44,000 --> 00:03:45,760
transferred to the system

99
00:03:45,760 --> 00:03:47,920
so all you reverse engineers will go

100
00:03:47,920 --> 00:03:50,879
crazy with this one

101
00:03:50,959 --> 00:03:52,560
along with some confirmation of

102
00:03:52,560 --> 00:03:54,000
communications with some

103
00:03:54,000 --> 00:03:57,599
c2 or cnc or command control

104
00:03:57,599 --> 00:04:00,640
remote system and let's get

105
00:04:00,640 --> 00:04:04,000
started with the actual exercise

106
00:04:04,000 --> 00:04:06,799
now what are we seeing here in this

107
00:04:06,799 --> 00:04:07,519
screenshot

108
00:04:07,519 --> 00:04:10,480
it was provided as part of the exercise

109
00:04:10,480 --> 00:04:12,560
and

110
00:04:12,560 --> 00:04:14,400
this is all the information we've got

111
00:04:14,400 --> 00:04:16,160
about the events

112
00:04:16,160 --> 00:04:20,000
now squeal and how it works and what

113
00:04:20,000 --> 00:04:22,160
all this means is completely out of

114
00:04:22,160 --> 00:04:24,160
scope here but

115
00:04:24,160 --> 00:04:26,639
we can actually use this information to

116
00:04:26,639 --> 00:04:28,479
guide us through our investigation

117
00:04:28,479 --> 00:04:31,040
and it's really enough to start pulling

118
00:04:31,040 --> 00:04:32,639
the threat of our

119
00:04:32,639 --> 00:04:35,680
pcap file you can

120
00:04:35,680 --> 00:04:38,080
actually find a little bit more

121
00:04:38,080 --> 00:04:39,360
information about how

122
00:04:39,360 --> 00:04:42,639
sql and this et pro rule sets which you

123
00:04:42,639 --> 00:04:43,120
can

124
00:04:43,120 --> 00:04:46,720
see in the event message column and i

125
00:04:46,720 --> 00:04:47,280
will

126
00:04:47,280 --> 00:04:50,240
add a little bit uh more information

127
00:04:50,240 --> 00:04:51,120
about it in the

128
00:04:51,120 --> 00:04:53,280
resources section so you can dive a

129
00:04:53,280 --> 00:04:54,840
little bit deeper into

130
00:04:54,840 --> 00:04:57,919
how all this whole thing works and how

131
00:04:57,919 --> 00:04:58,320
these

132
00:04:58,320 --> 00:05:01,600
alerts were actually triggered on

133
00:05:01,600 --> 00:05:04,960
all these rule sets for this

134
00:05:04,960 --> 00:05:07,520
all we need to know right now is what

135
00:05:07,520 --> 00:05:09,680
we're looking for in our pickup file and

136
00:05:09,680 --> 00:05:10,800
taking a look at the

137
00:05:10,800 --> 00:05:13,280
event messages column which is the one

138
00:05:13,280 --> 00:05:14,000
two three

139
00:05:14,000 --> 00:05:17,039
four five six seven eight and column

140
00:05:17,039 --> 00:05:19,919
we can see some pretty descriptive and

141
00:05:19,919 --> 00:05:21,440
specific alerts such as

142
00:05:21,440 --> 00:05:25,759
portable executable downloads via http

143
00:05:25,759 --> 00:05:29,120
some cobalt strike beaconing

144
00:05:29,120 --> 00:05:32,400
for example some interpreter shells and

145
00:05:32,400 --> 00:05:35,280
yeah it's pretty enough for us to to get

146
00:05:35,280 --> 00:05:36,000
started this

147
00:05:36,000 --> 00:05:38,720
is really specific so we are not

148
00:05:38,720 --> 00:05:39,840
expecting a lot of

149
00:05:39,840 --> 00:05:44,080
false positives and uh for this exercise

150
00:05:44,080 --> 00:05:47,280
i randomly picked uh three

151
00:05:47,280 --> 00:05:50,240
or three alerts which i highlighted in

152
00:05:50,240 --> 00:05:50,720
red

153
00:05:50,720 --> 00:05:54,240
so let's begin working on them also

154
00:05:54,240 --> 00:05:56,560
another piece of information we have

155
00:05:56,560 --> 00:05:58,479
about the exercise is that the

156
00:05:58,479 --> 00:06:02,800
the the land segment is standard to

157
00:06:02,800 --> 00:06:06,160
that eight that zero slash 24

158
00:06:06,160 --> 00:06:09,120
so this is enough to get to get started

159
00:06:09,120 --> 00:06:11,039
we have actually some information about

160
00:06:11,039 --> 00:06:12,240
the

161
00:06:12,240 --> 00:06:16,400
the local compromised uh system which is

162
00:06:16,400 --> 00:06:20,160
a tender two that that a that 101

163
00:06:20,160 --> 00:06:22,000
and you can see it in the in the squeal

164
00:06:22,000 --> 00:06:23,520
alerts so

165
00:06:23,520 --> 00:06:26,479
let's begin working with those three

166
00:06:26,479 --> 00:06:28,960
alerts

167
00:06:30,400 --> 00:06:33,440
now first we need to read our

168
00:06:33,440 --> 00:06:36,479
pickup file and let's

169
00:06:36,479 --> 00:06:39,599
fire up that terminal

170
00:06:40,800 --> 00:06:43,360
and what would happen if for example i

171
00:06:43,360 --> 00:06:44,319
have this

172
00:06:44,319 --> 00:06:47,199
this file in here but what will happen

173
00:06:47,199 --> 00:06:47,840
if

174
00:06:47,840 --> 00:06:51,759
i just read just a city business

175
00:06:51,759 --> 00:06:54,000
it's nothing right it doesn't make any

176
00:06:54,000 --> 00:06:55,039
sense so

177
00:06:55,039 --> 00:06:58,720
if you're familiar with tcp dump or not

178
00:06:58,720 --> 00:07:01,360
you may or may not know that it's

179
00:07:01,360 --> 00:07:02,560
usually used for

180
00:07:02,560 --> 00:07:05,759
for in transit or live

181
00:07:05,759 --> 00:07:09,520
network packet capturing

182
00:07:09,520 --> 00:07:12,639
but in this case we're using it to to

183
00:07:12,639 --> 00:07:16,639
actually read our pickup file so i am

184
00:07:16,639 --> 00:07:19,759
i need to really do

185
00:07:19,759 --> 00:07:23,280
to fire up tcp dump as the

186
00:07:23,280 --> 00:07:26,400
the super user it may not be necessary

187
00:07:26,400 --> 00:07:29,280
at all times but uh it was in this case

188
00:07:29,280 --> 00:07:30,000
and

189
00:07:30,000 --> 00:07:32,479
let's give it a couple switches for

190
00:07:32,479 --> 00:07:33,520
example we have

191
00:07:33,520 --> 00:07:35,759
four t's which will mean that the

192
00:07:35,759 --> 00:07:37,039
timestamps of the

193
00:07:37,039 --> 00:07:39,360
of the packet capture will be human

194
00:07:39,360 --> 00:07:40,560
readable

195
00:07:40,560 --> 00:07:44,960
also a switch will make the output in

196
00:07:44,960 --> 00:07:48,080
readable ascii format the

197
00:07:48,080 --> 00:07:51,919
end switch will which will not resolve

198
00:07:51,919 --> 00:07:54,879
any any address remember we are looking

199
00:07:54,879 --> 00:07:55,919
at the

200
00:07:55,919 --> 00:07:59,199
disquil alerts as ips and as domains so

201
00:07:59,199 --> 00:08:02,720
we need those ips and finally

202
00:08:02,720 --> 00:08:05,840
the r switch which will make

203
00:08:05,840 --> 00:08:09,199
us able to read our pickup file and

204
00:08:09,199 --> 00:08:10,080
let's give it the

205
00:08:10,080 --> 00:08:13,360
argument of the actual the actual

206
00:08:13,360 --> 00:08:15,800
file sorry and let's

207
00:08:15,800 --> 00:08:18,319
[Music]

208
00:08:18,319 --> 00:08:21,120
just read through it

209
00:08:21,360 --> 00:08:25,120
and uh let's let's see what we have here

210
00:08:25,120 --> 00:08:26,240
and it's

211
00:08:26,240 --> 00:08:29,280
a little bit of nonsense but

212
00:08:29,280 --> 00:08:32,399
i'm interested in in a couple pieces of

213
00:08:32,399 --> 00:08:34,479
pieces of information which is mainly

214
00:08:34,479 --> 00:08:35,760
about the file

215
00:08:35,760 --> 00:08:39,679
format and one thing i'm interested

216
00:08:39,679 --> 00:08:40,000
right

217
00:08:40,000 --> 00:08:42,640
now in is how it begins with the

218
00:08:42,640 --> 00:08:43,760
timestamp

219
00:08:43,760 --> 00:08:46,399
then the protocol then uh some

220
00:08:46,399 --> 00:08:47,920
additional information about the

221
00:08:47,920 --> 00:08:49,279
eyepiece and uh

222
00:08:49,279 --> 00:08:52,399
if it's whether it's a for example a who

223
00:08:52,399 --> 00:08:53,519
is or who has

224
00:08:53,519 --> 00:08:56,959
a iarp request etc

225
00:08:56,959 --> 00:09:00,160
and another piece of information which i

226
00:09:00,160 --> 00:09:00,640
was

227
00:09:00,640 --> 00:09:03,760
interested right now in is

228
00:09:03,760 --> 00:09:07,040
this file this format if you can see it

229
00:09:07,040 --> 00:09:09,519
which is the actual communication

230
00:09:09,519 --> 00:09:10,080
between

231
00:09:10,080 --> 00:09:13,279
machines okay

232
00:09:13,600 --> 00:09:15,920
which is this format and we have our

233
00:09:15,920 --> 00:09:17,040
local

234
00:09:17,040 --> 00:09:21,200
local ip and it's interesting to see how

235
00:09:21,200 --> 00:09:22,560
the port is displayed

236
00:09:22,560 --> 00:09:26,800
right just as as if it was another octet

237
00:09:26,800 --> 00:09:29,760
so it's tender to that eight the one one

238
00:09:29,760 --> 00:09:30,560
that

239
00:09:30,560 --> 00:09:33,839
and then the port and how

240
00:09:33,839 --> 00:09:36,560
it is communicating with this symbol and

241
00:09:36,560 --> 00:09:37,360
in the

242
00:09:37,360 --> 00:09:41,279
remote machine

243
00:09:41,279 --> 00:09:45,200
with the same format dot and then the

244
00:09:45,200 --> 00:09:48,720
remote port so with those

245
00:09:48,720 --> 00:09:50,399
two pieces of information we can

246
00:09:50,399 --> 00:09:52,240
actually begin

247
00:09:52,240 --> 00:09:54,720
gripping through it and back to this

248
00:09:54,720 --> 00:09:56,959
guide

249
00:09:58,160 --> 00:10:00,240
we are now a little bit familiar with

250
00:10:00,240 --> 00:10:01,200
how the the

251
00:10:01,200 --> 00:10:05,839
file format works for our pickup

252
00:10:05,920 --> 00:10:10,160
and let's examine the

253
00:10:10,160 --> 00:10:12,800
the actual first alert which i which i

254
00:10:12,800 --> 00:10:13,360
totally

255
00:10:13,360 --> 00:10:18,160
randomly chose and you can see the

256
00:10:18,160 --> 00:10:21,279
source ip which is a local machine and

257
00:10:21,279 --> 00:10:22,640
the source

258
00:10:22,640 --> 00:10:25,680
port and the destination ip

259
00:10:25,680 --> 00:10:27,600
and the destination port and some

260
00:10:27,600 --> 00:10:29,040
information about it which is

261
00:10:29,040 --> 00:10:31,839
interesting for us right now the ep pro

262
00:10:31,839 --> 00:10:32,480
malware

263
00:10:32,480 --> 00:10:35,600
and it's probably correlated by

264
00:10:35,600 --> 00:10:38,720
signature based processes

265
00:10:38,720 --> 00:10:42,720
to hansitor which let's see what we have

266
00:10:42,720 --> 00:10:44,959
here

267
00:10:45,519 --> 00:10:49,519
and just exactly how we know

268
00:10:49,519 --> 00:10:52,720
how our uh our pickup displays our

269
00:10:52,720 --> 00:10:53,839
information we

270
00:10:53,839 --> 00:10:56,800
we can begin actually uh clipping

271
00:10:56,800 --> 00:10:57,680
through it

272
00:10:57,680 --> 00:11:01,839
we know our file format and how does it

273
00:11:01,839 --> 00:11:02,560
work and

274
00:11:02,560 --> 00:11:06,560
we're looking exactly at that

275
00:11:06,560 --> 00:11:10,320
format here we have our local ip

276
00:11:10,320 --> 00:11:14,160
and how it communicated via the the

277
00:11:14,160 --> 00:11:18,240
the local port

278
00:11:18,680 --> 00:11:20,800
49.755

279
00:11:20,800 --> 00:11:24,720
sorry 49755

280
00:11:24,720 --> 00:11:28,399
and it's communicating in this way

281
00:11:28,399 --> 00:11:33,120
to the remote system which is

282
00:11:34,839 --> 00:11:36,000
213.5.229.12.

283
00:11:36,000 --> 00:11:41,200
that 80 the remote port 80.

284
00:11:41,200 --> 00:11:43,760
and let's give it some color to the

285
00:11:43,760 --> 00:11:45,600
output

286
00:11:45,600 --> 00:11:47,839
now this is not always necessary but it

287
00:11:47,839 --> 00:11:49,760
was in this case because i'm using

288
00:11:49,760 --> 00:11:53,600
uh actually wsl which is not formatting

289
00:11:53,600 --> 00:11:54,320
it

290
00:11:54,320 --> 00:11:58,399
very pretty so

291
00:11:58,399 --> 00:12:02,000
we will need it just for this time now

292
00:12:02,000 --> 00:12:05,600
i will zoom it out so you can see it

293
00:12:05,600 --> 00:12:08,320
uh perfectly but i don't think it will

294
00:12:08,320 --> 00:12:08,880
be

295
00:12:08,880 --> 00:12:12,399
readable so just seek it

296
00:12:12,399 --> 00:12:15,680
with this for now

297
00:12:15,680 --> 00:12:19,120
and what do we have here we have

298
00:12:19,120 --> 00:12:23,279
these packets going on with exactly our

299
00:12:23,279 --> 00:12:27,839
search match

300
00:12:27,839 --> 00:12:31,200
and something actually popped out

301
00:12:31,200 --> 00:12:34,160
pretty immediately which is a a post

302
00:12:34,160 --> 00:12:34,800
method

303
00:12:34,800 --> 00:12:40,079
for some very strange php

304
00:12:40,079 --> 00:12:43,760
file which we at this point we

305
00:12:43,760 --> 00:12:45,760
can't possibly know what what it means

306
00:12:45,760 --> 00:12:47,200
or what it does

307
00:12:47,200 --> 00:12:49,680
but we should definitely save this

308
00:12:49,680 --> 00:12:50,880
information as it is

309
00:12:50,880 --> 00:12:54,800
as a piece of information for further

310
00:12:54,800 --> 00:12:59,760
analysis and uh why not let's

311
00:12:59,760 --> 00:13:02,480
isolate it a little bit further and pipe

312
00:13:02,480 --> 00:13:03,200
it some

313
00:13:03,200 --> 00:13:06,800
some more grip and search just as it is

314
00:13:06,800 --> 00:13:12,240
for php give it some color

315
00:13:15,519 --> 00:13:20,240
i get some huh

316
00:13:20,240 --> 00:13:25,040
okay now we have here

317
00:13:26,959 --> 00:13:30,079
some useful uh information we can

318
00:13:30,079 --> 00:13:35,839
we which we should definitely extract

319
00:13:35,839 --> 00:13:38,560
and let's actually see some context

320
00:13:38,560 --> 00:13:39,279
about this

321
00:13:39,279 --> 00:13:42,880
this same packet we we will give it

322
00:13:42,880 --> 00:13:46,720
a little bit a couple

323
00:13:46,720 --> 00:13:50,079
switches to the to our grip command and

324
00:13:50,079 --> 00:13:53,920
what a means is it will display

325
00:13:53,920 --> 00:13:57,920
after this this search match

326
00:13:57,920 --> 00:14:00,959
it will display the the next 10 lines

327
00:14:00,959 --> 00:14:03,519
after this match and let's give it the

328
00:14:03,519 --> 00:14:04,800
same switch for the

329
00:14:04,800 --> 00:14:09,600
for the for both parts of the

330
00:14:09,600 --> 00:14:13,519
of our grip commands

331
00:14:13,519 --> 00:14:16,800
and let's see what we get okay

332
00:14:16,800 --> 00:14:19,920
so we now we have some some context

333
00:14:19,920 --> 00:14:21,760
let's ignore this one because it's the

334
00:14:21,760 --> 00:14:23,120
next packet

335
00:14:23,120 --> 00:14:25,120
but what is interesting here right now

336
00:14:25,120 --> 00:14:26,160
is the the

337
00:14:26,160 --> 00:14:29,760
the http header right so we have this

338
00:14:29,760 --> 00:14:33,040
information which is our unknown file

339
00:14:33,040 --> 00:14:36,639
at this time but we have some user

340
00:14:36,639 --> 00:14:37,360
agents

341
00:14:37,360 --> 00:14:40,000
some host which is definitely

342
00:14:40,000 --> 00:14:41,199
interesting

343
00:14:41,199 --> 00:14:45,040
for for their analysis and we actually

344
00:14:45,040 --> 00:14:47,760
also happen to know some things about

345
00:14:47,760 --> 00:14:48,639
the

346
00:14:48,639 --> 00:14:51,760
domain controller we have here the

347
00:14:51,760 --> 00:14:52,320
domain

348
00:14:52,320 --> 00:14:55,519
presumably this is the local user

349
00:14:55,519 --> 00:14:57,600
buildcook and also we have some

350
00:14:57,600 --> 00:14:59,600
information about the

351
00:14:59,600 --> 00:15:03,440
the local machine which is a windows 10

352
00:15:03,440 --> 00:15:06,800
with a 64-bit architecture

353
00:15:06,800 --> 00:15:12,399
and that's it for this for this

354
00:15:12,399 --> 00:15:15,120
for this alert and you can see actually

355
00:15:15,120 --> 00:15:16,160
the same in

356
00:15:16,160 --> 00:15:20,399
the same information just uh printed it

357
00:15:20,399 --> 00:15:23,680
beautifully and let's save that up

358
00:15:23,680 --> 00:15:25,600
and move on with the next dirt which

359
00:15:25,600 --> 00:15:29,360
will be a little bit easier

360
00:15:29,920 --> 00:15:33,440
it's up and let's start

361
00:15:33,440 --> 00:15:37,279
gripping through it again but now

362
00:15:37,279 --> 00:15:39,519
we can actually see that it's the same

363
00:15:39,519 --> 00:15:40,720
communication but

364
00:15:40,720 --> 00:15:43,839
in reverse so we're actually expecting

365
00:15:43,839 --> 00:15:44,880
some

366
00:15:44,880 --> 00:15:47,920
confirmation of download hopefully or

367
00:15:47,920 --> 00:15:48,399
not

368
00:15:48,399 --> 00:15:50,800
maybe

369
00:15:52,399 --> 00:15:55,040
you can see it's the same order but

370
00:15:55,040 --> 00:15:55,839
reversed

371
00:15:55,839 --> 00:15:59,199
so let's work with that

372
00:16:00,160 --> 00:16:03,279
ten that do that eight that one

373
00:16:03,279 --> 00:16:06,560
one port forty nine

374
00:16:06,560 --> 00:16:09,839
seven seven

375
00:16:11,040 --> 00:16:14,399
always and let's see what we have here

376
00:16:14,399 --> 00:16:16,800
nothing

377
00:16:18,320 --> 00:16:20,880
there must have been a typo here if you

378
00:16:20,880 --> 00:16:23,040
can help me out with that one because i

379
00:16:23,040 --> 00:16:25,560
don't know what i did

380
00:16:25,560 --> 00:16:28,079
10.2.8.1 that

381
00:16:28,079 --> 00:16:37,839
49 757

382
00:16:39,839 --> 00:16:41,839
if you can spot it you can actually help

383
00:16:41,839 --> 00:16:43,120
me out in

384
00:16:43,120 --> 00:16:50,240
here because okay let's

385
00:16:50,240 --> 00:16:53,360
okay let's work with this

386
00:16:55,440 --> 00:16:58,000
okay it's just the same formation just

387
00:16:58,000 --> 00:16:59,759
immediately

388
00:16:59,759 --> 00:17:03,360
the local id so what we're expecting

389
00:17:03,360 --> 00:17:04,400
here is some

390
00:17:04,400 --> 00:17:07,520
actual uh confirmation of

391
00:17:07,520 --> 00:17:10,880
uh download hopefully and

392
00:17:10,880 --> 00:17:14,240
what we have here some

393
00:17:14,240 --> 00:17:19,839
http 200 which means

394
00:17:20,079 --> 00:17:23,760
actually it was confirmed

395
00:17:28,799 --> 00:17:31,520
and that's another piece for our for

396
00:17:31,520 --> 00:17:32,559
previous alert

397
00:17:32,559 --> 00:17:35,919
and we can save this up for further

398
00:17:35,919 --> 00:17:38,480
analysis because we have some

399
00:17:38,480 --> 00:17:39,550
confirmation of the

400
00:17:39,550 --> 00:17:42,639
[Music]

401
00:17:44,840 --> 00:17:47,840
download

402
00:17:47,840 --> 00:17:50,959
now you know what let's

403
00:17:51,679 --> 00:17:54,559
let's so

404
00:17:54,720 --> 00:17:58,080
let's rip it again to see some useful

405
00:17:58,080 --> 00:17:58,960
information

406
00:17:58,960 --> 00:18:01,840
about the

407
00:18:04,000 --> 00:18:08,960
in the 2.8.101 port

408
00:18:09,480 --> 00:18:14,880
49757 and it's communicating to

409
00:18:14,880 --> 00:18:22,640
the remote address which is 8.208.10.17

410
00:18:22,640 --> 00:18:25,039
port 80 which is interesting and let's

411
00:18:25,039 --> 00:18:28,080
see what we have

412
00:18:28,080 --> 00:18:30,000
i was looking at the confirmation before

413
00:18:30,000 --> 00:18:32,000
but it's actually the same thing

414
00:18:32,000 --> 00:18:36,880
and this is what happened before

415
00:18:36,880 --> 00:18:39,919
what i did before this

416
00:18:39,919 --> 00:18:43,200
and we can see some actually

417
00:18:43,200 --> 00:18:46,400
some uh get

418
00:18:46,400 --> 00:18:49,600
get requests and we can see some

419
00:18:49,600 --> 00:18:52,640
strange binaries being fetched

420
00:18:52,640 --> 00:18:55,760
over the the network and we can

421
00:18:55,760 --> 00:18:58,559
we should actually definitely save this

422
00:18:58,559 --> 00:19:00,160
information

423
00:19:00,160 --> 00:19:03,440
because uh this will be

424
00:19:03,440 --> 00:19:05,840
really important in our investigation

425
00:19:05,840 --> 00:19:08,240
going further

426
00:19:08,240 --> 00:19:11,280
and expect a little bit more about

427
00:19:11,280 --> 00:19:14,240
about these these files but for now

428
00:19:14,240 --> 00:19:14,720
let's

429
00:19:14,720 --> 00:19:16,480
let's save this information as i

430
00:19:16,480 --> 00:19:19,760
highlighted in here

431
00:19:21,919 --> 00:19:25,600
and for the file confirmation we can

432
00:19:25,600 --> 00:19:29,039
we can see here that it was

433
00:19:29,039 --> 00:19:32,720
actually with some response from our

434
00:19:32,720 --> 00:19:36,240
our remote server

435
00:19:36,240 --> 00:19:39,440
and that was her third alert now

436
00:19:39,440 --> 00:19:43,360
what i can already hear you

437
00:19:43,360 --> 00:19:47,440
uh questioning is that

438
00:19:47,440 --> 00:19:49,840
can we retrieve those suspicious files

439
00:19:49,840 --> 00:19:52,720
and turns out yes we can and definitely

440
00:19:52,720 --> 00:19:55,039
shoot

441
00:19:55,200 --> 00:19:57,600
everything after this step should be in

442
00:19:57,600 --> 00:19:58,640
a in an

443
00:19:58,640 --> 00:20:02,000
isolated environment and as an extra

444
00:20:02,000 --> 00:20:04,400
layer of protection we will be using

445
00:20:04,400 --> 00:20:07,280
linux i used kali linux which is

446
00:20:07,280 --> 00:20:09,679
definitely not necessary but uh

447
00:20:09,679 --> 00:20:12,799
it was convenient in this case and i

448
00:20:12,799 --> 00:20:13,600
used it to

449
00:20:13,600 --> 00:20:15,919
download some windows malicious binaries

450
00:20:15,919 --> 00:20:18,240
from this pickup file

451
00:20:18,240 --> 00:20:21,200
and then in theory they shouldn't be

452
00:20:21,200 --> 00:20:23,440
able to run in our system

453
00:20:23,440 --> 00:20:26,320
all right let's see how how the whole

454
00:20:26,320 --> 00:20:27,679
thing looks

455
00:20:27,679 --> 00:20:30,880
we have some final information and we

456
00:20:30,880 --> 00:20:31,840
can see some

457
00:20:31,840 --> 00:20:35,360
tabs working in network miner

458
00:20:35,360 --> 00:20:39,039
i run it with with mono in kali linux

459
00:20:39,039 --> 00:20:42,640
and you can see the hosts

460
00:20:42,640 --> 00:20:45,520
tab the files tab images messages in

461
00:20:45,520 --> 00:20:47,360
case you can see some

462
00:20:47,360 --> 00:20:50,960
smtp traffic going on some credentials

463
00:20:50,960 --> 00:20:54,159
sessions dns traffic and what

464
00:20:54,159 --> 00:20:57,360
did pop up immediately

465
00:20:57,360 --> 00:21:00,799
was our uh strange executables

466
00:21:00,799 --> 00:21:03,039
you can see the octet stream which is a

467
00:21:03,039 --> 00:21:04,240
strange file

468
00:21:04,240 --> 00:21:06,799
we didn't look at but that basically

469
00:21:06,799 --> 00:21:08,240
means it's an

470
00:21:08,240 --> 00:21:13,039
unknown file extension

471
00:21:13,039 --> 00:21:16,880
and let's let's see what we can do with

472
00:21:16,880 --> 00:21:17,760
this

473
00:21:17,760 --> 00:21:20,559
executable

474
00:21:20,799 --> 00:21:22,720
we can actually retrieve the files

475
00:21:22,720 --> 00:21:24,400
exactly as they travel to

476
00:21:24,400 --> 00:21:27,200
and from the system and have some very

477
00:21:27,200 --> 00:21:29,760
relevant information about the source

478
00:21:29,760 --> 00:21:33,039
source host for example which is the

479
00:21:33,039 --> 00:21:35,679
five column in the network miner

480
00:21:35,679 --> 00:21:36,960
interface

481
00:21:36,960 --> 00:21:40,240
and along with some timestamps and other

482
00:21:40,240 --> 00:21:42,080
pieces of data for example the frame

483
00:21:42,080 --> 00:21:43,600
number in the

484
00:21:43,600 --> 00:21:46,640
first column which will be useful in a

485
00:21:46,640 --> 00:21:49,919
further or

486
00:21:49,919 --> 00:21:53,840
more useful investigation

487
00:21:53,840 --> 00:21:57,520
and now as you can see

488
00:21:57,520 --> 00:22:00,559
we can actually download the the the

489
00:22:00,559 --> 00:22:03,600
binaries as they were as they traveled

490
00:22:03,600 --> 00:22:06,159
but before going crazy with malware

491
00:22:06,159 --> 00:22:06,960
reverse

492
00:22:06,960 --> 00:22:09,200
reverse engineering and we can extract

493
00:22:09,200 --> 00:22:11,679
the hash of our strange files and look

494
00:22:11,679 --> 00:22:13,679
them up in virustotal

495
00:22:13,679 --> 00:22:16,880
to basically confirm our suspicions and

496
00:22:16,880 --> 00:22:19,919
let's see what we have

497
00:22:20,080 --> 00:22:22,400
you can see the files hash bin has been

498
00:22:22,400 --> 00:22:23,520
already detected

499
00:22:23,520 --> 00:22:27,600
by 57.70 security vendors which is

500
00:22:27,600 --> 00:22:29,039
pretty conclusive for us

501
00:22:29,039 --> 00:22:31,919
and that's partly how our network

502
00:22:31,919 --> 00:22:33,600
security monitoring tool

503
00:22:33,600 --> 00:22:37,280
the detection which is signature based

504
00:22:37,280 --> 00:22:40,559
so we have definitely some confirmation

505
00:22:40,559 --> 00:22:40,880
of

506
00:22:40,880 --> 00:22:44,720
uh malicious files being downloaded and

507
00:22:44,720 --> 00:22:47,760
this was just an example of one

508
00:22:47,760 --> 00:22:50,960
uh file but you can definitely

509
00:22:50,960 --> 00:22:53,200
work out the whole exercise and the

510
00:22:53,200 --> 00:22:54,320
whole

511
00:22:54,320 --> 00:22:56,480
the whole traffic and the whole lines

512
00:22:56,480 --> 00:22:57,520
for the

513
00:22:57,520 --> 00:23:02,400
for the big campfire and um

514
00:23:03,440 --> 00:23:07,440
if we're using the cli and in linux

515
00:23:07,440 --> 00:23:09,440
why would it be necessary if we already

516
00:23:09,440 --> 00:23:11,760
have some automated

517
00:23:11,760 --> 00:23:13,919
graphical user interface or gui

518
00:23:13,919 --> 00:23:15,200
applications

519
00:23:15,200 --> 00:23:18,320
well three reasons for that mainly

520
00:23:18,320 --> 00:23:18,960
because

521
00:23:18,960 --> 00:23:21,440
we now know exactly how pickup files are

522
00:23:21,440 --> 00:23:22,080
structured

523
00:23:22,080 --> 00:23:25,200
and we now know also the ins and outs of

524
00:23:25,200 --> 00:23:25,600
them

525
00:23:25,600 --> 00:23:28,880
and now we have a deeper understanding

526
00:23:28,880 --> 00:23:32,159
of how any gui of our choosing works

527
00:23:32,159 --> 00:23:35,280
and also if we decide to monitor the

528
00:23:35,280 --> 00:23:36,720
activity on our networks

529
00:23:36,720 --> 00:23:39,919
a gui packet sniffer can become a little

530
00:23:39,919 --> 00:23:42,880
bit heavy after some time

531
00:23:42,880 --> 00:23:46,000
due to the big load of data being

532
00:23:46,000 --> 00:23:49,520
transferred to and from the system

533
00:23:49,520 --> 00:23:53,200
just you can just run a wireshark

534
00:23:53,200 --> 00:23:55,600
capture for one hour and you'll see what

535
00:23:55,600 --> 00:23:56,480
i'm

536
00:23:56,480 --> 00:23:59,520
what i mean what i'm talking about and

537
00:23:59,520 --> 00:24:03,039
the third reason is that sometimes guys

538
00:24:03,039 --> 00:24:04,000
are not available

539
00:24:04,000 --> 00:24:06,480
in our environment such as in remote

540
00:24:06,480 --> 00:24:07,279
servers

541
00:24:07,279 --> 00:24:10,240
if we are doing some troubleshooting or

542
00:24:10,240 --> 00:24:12,400
routine checkups

543
00:24:12,400 --> 00:24:15,760
and that was pretty easy and really

544
00:24:15,760 --> 00:24:17,440
straightforward

545
00:24:17,440 --> 00:24:20,559
now this presentation only only scratch

546
00:24:20,559 --> 00:24:24,320
the surface on data wrangling and cli

547
00:24:24,320 --> 00:24:27,520
digital forensics or incident response

548
00:24:27,520 --> 00:24:28,400
processes

549
00:24:28,400 --> 00:24:32,000
but i hope you got interested in

550
00:24:32,000 --> 00:24:35,039
it and i really urge you to to

551
00:24:35,039 --> 00:24:38,480
follow the full exercise

552
00:24:38,480 --> 00:24:40,960
and uh before ending this talk i would

553
00:24:40,960 --> 00:24:42,080
like to express some

554
00:24:42,080 --> 00:24:44,320
some really gratitude to the guys at

555
00:24:44,320 --> 00:24:46,080
republic of hackers

556
00:24:46,080 --> 00:24:48,559
it's a great ethical hacking community

557
00:24:48,559 --> 00:24:49,840
and it's

558
00:24:49,840 --> 00:24:52,240
really a pleasure to be a part of it

559
00:24:52,240 --> 00:24:54,400
also to the staff of digital overdose

560
00:24:54,400 --> 00:24:56,799
conference for hosting this event

561
00:24:56,799 --> 00:24:59,120
thank you all for your support both for

562
00:24:59,120 --> 00:25:00,080
the speakers

563
00:25:00,080 --> 00:25:03,279
and for the community

564
00:25:03,760 --> 00:25:06,720
and uh you can also see and download the

565
00:25:06,720 --> 00:25:07,679
exercise

566
00:25:07,679 --> 00:25:10,799
and the slides at my github

567
00:25:10,799 --> 00:25:13,360
which soon will be added with further

568
00:25:13,360 --> 00:25:16,159
information and some cool

569
00:25:16,159 --> 00:25:19,440
resources and reads and videos whatever

570
00:25:19,440 --> 00:25:20,640
you need

571
00:25:20,640 --> 00:25:23,120
and you may find me also on twitter

572
00:25:23,120 --> 00:25:24,559
discord and linkedin

573
00:25:24,559 --> 00:25:26,960
and if you have some questions about it

574
00:25:26,960 --> 00:25:28,400
just let me know

575
00:25:28,400 --> 00:25:30,799
and i'll be happy to help thanks a lot

576
00:25:30,799 --> 00:25:32,799
for watching and i hope you've enjoyed

577
00:25:32,799 --> 00:25:33,760
this talk

578
00:25:33,760 --> 00:25:36,880
goodbye we do have a few questions if

579
00:25:36,880 --> 00:25:38,080
you're up for it

580
00:25:38,080 --> 00:25:41,120
yeah sure yeah okay um so i guess i'll

581
00:25:41,120 --> 00:25:42,320
kick it off

582
00:25:42,320 --> 00:25:44,559
uh so we have a question from gogothis

583
00:25:44,559 --> 00:25:45,440
um

584
00:25:45,440 --> 00:25:47,679
you know have you happened to use snort

585
00:25:47,679 --> 00:25:48,960
or circada

586
00:25:48,960 --> 00:25:50,880
at all instead of a sql for uh for

587
00:25:50,880 --> 00:25:52,960
monitoring

588
00:25:52,960 --> 00:25:56,720
i'm not really familiar with with

589
00:25:56,720 --> 00:26:00,080
how those processes work but we know sql

590
00:26:00,080 --> 00:26:00,559
works

591
00:26:00,559 --> 00:26:04,000
along with snort and sorry cata is just

592
00:26:04,000 --> 00:26:05,679
another

593
00:26:05,679 --> 00:26:11,760
tool that we can use instead of squeal

594
00:26:11,760 --> 00:26:14,000
but yeah it basically works along with

595
00:26:14,000 --> 00:26:15,600
snot with some

596
00:26:15,600 --> 00:26:19,039
signature based network detection

597
00:26:19,039 --> 00:26:20,480
capabilities

598
00:26:20,480 --> 00:26:24,640
definitely awesome

599
00:26:24,640 --> 00:26:28,240
nice uh there is more questions

600
00:26:28,240 --> 00:26:30,880
um how do you track your iocs do you use

601
00:26:30,880 --> 00:26:33,840
tools like fire eyes redline

602
00:26:33,840 --> 00:26:36,880
um for this time it was and a quick

603
00:26:36,880 --> 00:26:37,760
exercise to

604
00:26:37,760 --> 00:26:40,080
to extract some some useful information

605
00:26:40,080 --> 00:26:41,600
but but sure you can

606
00:26:41,600 --> 00:26:44,240
you can combine it and do some inter

607
00:26:44,240 --> 00:26:45,360
integration with

608
00:26:45,360 --> 00:26:48,640
some uh more robust uh

609
00:26:48,640 --> 00:26:52,000
softwares yeah why not

610
00:26:52,000 --> 00:26:54,799
awesome have you ever had to uh to do

611
00:26:54,799 --> 00:26:56,400
some of um

612
00:26:56,400 --> 00:26:58,080
some analysis like this in a headless

613
00:26:58,080 --> 00:26:59,360
environment where you only had a

614
00:26:59,360 --> 00:27:01,039
terminal and that was the only thing you

615
00:27:01,039 --> 00:27:03,840
really had to work with

616
00:27:03,840 --> 00:27:06,640
in this case we can for example if we

617
00:27:06,640 --> 00:27:07,279
have a

618
00:27:07,279 --> 00:27:10,480
remote server and uh and it's doing some

619
00:27:10,480 --> 00:27:12,799
uh some bucket capture with tcp dump

620
00:27:12,799 --> 00:27:15,440
automatically and if we connect to the

621
00:27:15,440 --> 00:27:19,360
vissh we can do some

622
00:27:19,360 --> 00:27:22,799
actual uh quick checkups

623
00:27:22,799 --> 00:27:24,880
the ssh instead of downloading

624
00:27:24,880 --> 00:27:25,840
downloading the

625
00:27:25,840 --> 00:27:29,440
the whole pcap and analyzing it in our

626
00:27:29,440 --> 00:27:33,039
gui environment right but i think this

627
00:27:33,039 --> 00:27:35,120
is only useful if we

628
00:27:35,120 --> 00:27:37,520
like in this case know exactly what

629
00:27:37,520 --> 00:27:39,760
we're looking for

630
00:27:39,760 --> 00:27:42,880
so it's

631
00:27:42,880 --> 00:27:44,880
a complicated answer to that question

632
00:27:44,880 --> 00:27:48,880
but in this case it was completely

633
00:27:48,880 --> 00:27:54,720
necessary and useful

