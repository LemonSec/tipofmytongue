1
00:00:00,000 --> 00:00:06,680
good afternoon everyone and thanks for
staying for his last talked this is the

2
00:00:06,680 --> 00:00:10,260
end of the conference and we really
appreciate that you that you stayed with

3
00:00:10,260 --> 00:00:14,769
us and you are interested in or Porto
even so that there is another talking

4
00:00:14,769 --> 00:00:18,890
downstairs in Dubuque which is also
looks very interesting given by my

5
00:00:18,890 --> 00:00:24,850
colleague so seems that the last two
talks are two slots were given to the

6
00:00:24,850 --> 00:00:31,119
crisis so my name is lamentable Jan my
colleagues on the icy and if you give

7
00:00:31,119 --> 00:00:37,300
this store together also presents on
introductory slides and then we get to

8
00:00:37,300 --> 00:00:43,030
the technical details and there is a
certain person who was also involved in

9
00:00:43,030 --> 00:00:48,480
this very short selling and they are all
from the University of Technology and

10
00:00:48,480 --> 00:00:53,099
economics detour from the peace love and
joy from the Department of Motor

11
00:00:53,100 --> 00:00:58,030
mobilize and very cool manufacturing and
you talk about hacking cars and

12
00:00:58,030 --> 00:01:03,359
yesterday someone asked me whether we
will bring the car on stage and I i

13
00:01:03,359 --> 00:01:08,350
taught him that no unfortunately not
maybe this is disappointing for you to

14
00:01:08,350 --> 00:01:15,220
but hopefully this is the only
disappointing so why we don't bring the

15
00:01:15,220 --> 00:01:21,408
car to the stage because we are talking
to both checking cars but in fact as you

16
00:01:21,409 --> 00:01:26,229
will see most of the verity did was
mainly on hacking and application on a

17
00:01:26,229 --> 00:01:33,030
PC PC which had some bad effect on the
car itself

18
00:01:33,030 --> 00:01:38,979
as well but actually debacle but it was
really very taking the application on

19
00:01:38,979 --> 00:01:41,450
the PC and that's what I mean

20
00:01:41,450 --> 00:01:50,630
infected stocks this dialectic but I
explain this later so as you know more

21
00:01:50,630 --> 00:01:55,920
than cars are full of embedded
controllers which are basically small

22
00:01:55,920 --> 00:02:01,850
computers inside a car which caused
royal different things in the car like

23
00:02:01,850 --> 00:02:08,049
the air bag which was mentioned but also
the engine of the car or the break and

24
00:02:08,050 --> 00:02:13,950
so on and all these electronic control
units use are connected by internal

25
00:02:13,950 --> 00:02:20,030
networks communication networks for
example the CAN bus in addition the cars

26
00:02:20,030 --> 00:02:26,810
have different external interfaces like
most of the modern cars might have

27
00:02:26,810 --> 00:02:33,819
Bluetooth stack interface which you can
connect your hands free said some cars

28
00:02:33,819 --> 00:02:41,070
have a wifi hotspot some cars have some
GPS receiver or a GSM module or some

29
00:02:41,070 --> 00:02:52,040
cars have some so-called by unless tire
pressure monitoring systems so if you

30
00:02:52,040 --> 00:02:58,480
put all these computers connect external
interfaces so there might be a tax and

31
00:02:58,480 --> 00:03:03,160
cyberattacks against these more than
cars actually a plausible threat so

32
00:03:03,160 --> 00:03:05,329
people started to consider that

33
00:03:05,329 --> 00:03:12,910
and researchers started to work on that
early as early backing 2010 2011 and

34
00:03:12,910 --> 00:03:17,590
some of the 11 of the landmark papers
which have been published by a very well

35
00:03:17,590 --> 00:03:23,470
known conference on USENIX security in
2011 it was written by us- based

36
00:03:23,470 --> 00:03:29,130
researchers from universities and
basically in their paper they show that

37
00:03:29,130 --> 00:03:32,170
cars can be compromised remotely

38
00:03:32,170 --> 00:03:36,988
very very nice paper that goes through
systematically over you

39
00:03:36,989 --> 00:03:42,349
the attack surface of the modern car
they identified three types of possible

40
00:03:42,349 --> 00:03:43,310
surface

41
00:03:43,310 --> 00:03:48,370
physical access to the car basically
value that will be the interface

42
00:03:48,370 --> 00:03:54,470
short-range wireless access such as
Bluetooth interface or by fight and long

43
00:03:54,470 --> 00:04:00,370
range wireless access for example sailor
or

44
00:04:00,370 --> 00:04:07,030
overview these interfaces and they
develop practical a tax proof of concept

45
00:04:07,030 --> 00:04:12,989
attacks against each of these interfaces
so for instance one of them today

46
00:04:12,989 --> 00:04:20,350
developed was exploiting a vulnerability
in the media player there is a software

47
00:04:20,350 --> 00:04:25,530
there which parses the mediafire which
is played and there was a bargain that

48
00:04:25,530 --> 00:04:36,559
sort so they were able to construct a
specially crafted music song tried they

49
00:04:36,560 --> 00:04:42,090
put the CD in the media player and then
immediately replace the CD basically the

50
00:04:42,090 --> 00:04:49,659
block the bug was exploited her and they
took over control over the media they

51
00:04:49,660 --> 00:04:56,450
demonstrated exploitable vulnerabilities
in the Bluetooth stack of the car that

52
00:04:56,450 --> 00:05:01,130
they investigated or 11 over the the
attacks that they constructed was

53
00:05:01,130 --> 00:05:07,600
basically it was exploiting bugging the
GSM will do so they were able to call

54
00:05:07,600 --> 00:05:15,020
the car remote location calling the
telephone number of the car and they

55
00:05:15,020 --> 00:05:21,310
played a specially crafted video again
which exploited the bug and additional

56
00:05:21,310 --> 00:05:23,740
software modules on the on the on that

57
00:05:23,740 --> 00:05:29,289
GSM module and it was compromised and
wants these views are compromised and

58
00:05:29,289 --> 00:05:34,440
you are already inside a car and on the
canvas days basically no more protection

59
00:05:34,440 --> 00:05:47,139
usually so far and after that there were
some follow up there

60
00:05:47,139 --> 00:05:52,159
very very own researchers will work on
that very soon that Charlie Miller with

61
00:05:52,159 --> 00:05:57,919
his colleague Chris Wallace second they
basically their idea was to repeat the

62
00:05:57,919 --> 00:06:01,930
research that was done by these us-
based researchers I just mention because

63
00:06:01,930 --> 00:06:08,990
these guys these academic guys they did
not publish order details for good

64
00:06:08,990 --> 00:06:14,400
reasons but Charlie Miller and his
friend had the idea of repeating all the

65
00:06:14,400 --> 00:06:20,888
and publish everything so basically they
come up with a report that contains a

66
00:06:20,889 --> 00:06:27,319
very detailed description of what they
did and all the tools that they used and

67
00:06:27,319 --> 00:06:32,180
in fact some of you might remember that
Charlie Miller gave a talk he wrote

68
00:06:32,180 --> 00:06:38,029
activated two years ago about this third
so we had already occurred hacking

69
00:06:38,029 --> 00:06:40,080
presentation two years ago

70
00:06:40,080 --> 00:06:44,609
activity which is actually on youtube so
you can you can watch it and they

71
00:06:44,610 --> 00:06:49,889
continued and a very decent trees are
you might have heard about death in June

72
00:06:49,889 --> 00:06:56,319
or July this year there was some news
anchors remotely illegal regime on the

73
00:06:56,319 --> 00:07:00,819
highway and this was also the vehicle
Charlie Miller and his friend very

74
00:07:00,819 --> 00:07:07,039
recent physical ed exploited some
vulnerability in a wifi hotspot on this

75
00:07:07,039 --> 00:07:11,479
modern Jeep so they could remotely
connect via the internet because the

76
00:07:11,479 --> 00:07:16,669
Jeep public IP address the remotely
connected and exploited someone that

77
00:07:16,669 --> 00:07:23,109
will be taken to hospital software and
promoted to cooperative control and

78
00:07:23,110 --> 00:07:27,099
there are other examples so if you look
at the richard is example of infecting

79
00:07:27,099 --> 00:07:32,560
the car veered FM radio broadcast or
violated tired or dimension violence

80
00:07:32,560 --> 00:07:39,000
tire pressure monitoring system or some
addicts on really communication between

81
00:07:39,000 --> 00:07:45,819
the key the viola scheme of the car and
and so on and all those are removed

82
00:07:45,819 --> 00:07:52,339
ethics so basically do they mean that
you compromised of car remotely not

83
00:07:52,339 --> 00:07:55,820
being physically present or close to the
car were you in the car

84
00:07:55,820 --> 00:08:00,690
and they are in fact very intriguing and
scary bewbs you that and they can

85
00:08:00,690 --> 00:08:05,020
attract of course a lot of media
attention because it's always a good you

86
00:08:05,020 --> 00:08:11,740
know the news that you took over a
five-year remotely but the real risk is

87
00:08:11,740 --> 00:08:17,570
in order opinion is quite unclear what
what we mean by this is that it is not

88
00:08:17,570 --> 00:08:22,780
so easy to do those kind of remote
attacks so they need first of all an

89
00:08:22,780 --> 00:08:30,239
exploitable vulnerabilities in some of
the interfaces and there might be such a

90
00:08:30,240 --> 00:08:34,860
vulnerability but it's not so easy to
find such a vulnerability source finding

91
00:08:34,860 --> 00:08:39,190
those vulnerabilities which I really
exploitable this this is far from

92
00:08:39,190 --> 00:08:45,260
trivial it needs reverse engineering
embedded software which is difficult

93
00:08:45,260 --> 00:08:50,860
there is left very little information
available about these embedded was

94
00:08:50,860 --> 00:08:55,360
because the car manufacturers typically
don't share too much so very limited

95
00:08:55,360 --> 00:09:01,220
information from his you can start and
there is a risk of bricking relatively

96
00:09:01,220 --> 00:09:05,870
expensive equipment so then you
experiment try to exploit buffer

97
00:09:05,870 --> 00:09:12,210
overflow you might actually ran their
device unusable and you have to throw a

98
00:09:12,210 --> 00:09:18,980
billion buy a new one and this kind can
be expensive so it's not easy and it may

99
00:09:18,980 --> 00:09:25,220
not skilled very well because of an
ability of the interfaces in one of the

100
00:09:25,220 --> 00:09:30,080
carbons might not lead there in another
card ending in the same interface around

101
00:09:30,080 --> 00:09:38,810
so basically just one vulnerability you
can maybe compromise one type of car and

102
00:09:38,810 --> 00:09:44,109
not the others so that's why I mean
that's what do you mean by not scalable

103
00:09:44,110 --> 00:09:50,690
and the question is there may be some
crew is a hanging lawyer

104
00:09:50,690 --> 00:09:55,930
easier to do than these kind of remote
addicts and that's what we mean by this

105
00:09:55,930 --> 00:09:59,930
Stuxnet style at Soho Stuxnet

106
00:09:59,930 --> 00:10:05,229
basically most of you should probably
know about this and yesterday we had a

107
00:10:05,230 --> 00:10:10,980
wonderful talk one attacking chemical
plans and the speaker there he explained

108
00:10:10,980 --> 00:10:15,290
in fact what we show the video in fact
about how stocks that are so you

109
00:10:15,290 --> 00:10:20,130
probably know but the idea just to
repeat the main point is that Stuxnet

110
00:10:20,130 --> 00:10:28,149
was warm attacking pieces first of all
and then modified the POC that other

111
00:10:28,149 --> 00:10:32,690
unions centrifuges but but if you look
at what started it is really basically

112
00:10:32,690 --> 00:10:38,899
of warm against windows-based pieces so
the idea was that your first infected PC

113
00:10:38,899 --> 00:10:44,390
and took over the communication between
that PC and the PSC and then once you

114
00:10:44,390 --> 00:10:51,420
have that you control the communication
then you can modify the PRC some

115
00:10:51,420 --> 00:10:56,040
parameters or even over right some of
the programs and then that has some

116
00:10:56,040 --> 00:11:05,020
effect on the under control system and
as I said the exploited weakness indoors

117
00:11:05,020 --> 00:11:10,000
and faded to go over the communication
was basically just replacing the deal

118
00:11:10,000 --> 00:11:13,650
which was responsible for the
communication between a SCADA software

119
00:11:13,650 --> 00:11:20,740
used to manage the POC and the BSE so
this horse stuff actually it's kind of a

120
00:11:20,740 --> 00:11:25,950
blueprint for similar attacks against
similar type of systems so if you have

121
00:11:25,950 --> 00:11:31,890
embedded systems typically they are
managed from PCs and so basically debt

122
00:11:31,890 --> 00:11:37,790
or idea to repeat exactly the same kind
of logic in four cars so you have some

123
00:11:37,790 --> 00:11:42,790
PC which is a diagnostic PC used
encourages repair shops running some

124
00:11:42,790 --> 00:11:49,349
sort of her some whole community is the
car for instance via deorbit interface

125
00:11:49,350 --> 00:11:56,760
and then infected PC that PC might
change values or other rights scenes

126
00:11:56,760 --> 00:12:02,910
hidden between the car and that causes
problems to the car so that's that's the

127
00:12:02,910 --> 00:12:04,719
logical 44

128
00:12:04,720 --> 00:12:09,819
why is this worrisome because PCs in
repair shops and carriages are probably

129
00:12:09,819 --> 00:12:16,000
vulnerable probably Dr connected to the
Internet very likely the law also

130
00:12:16,000 --> 00:12:22,759
connecting USB devices and mechanics
probably connect all kinds of USB and

131
00:12:22,759 --> 00:12:26,730
they are probably poorly maintained and
administered because that's not their

132
00:12:26,730 --> 00:12:32,079
main job they're the guys there to to to
maintain their PC and probably they are

133
00:12:32,079 --> 00:12:37,290
also used for other purposes not just
running the diagnosis so if you put all

134
00:12:37,290 --> 00:12:41,969
this together it's relatively easy they
believed to infect them with known or

135
00:12:41,970 --> 00:12:47,040
unknown mother and was the commander
infected the PC then tomorrow can

136
00:12:47,040 --> 00:12:52,279
compromise the diagnostic application
running on the PC and then implements to

137
00:12:52,279 --> 00:13:00,639
us for example for you can implement
many in the middle between the

138
00:13:00,639 --> 00:13:06,180
diagnostic software and a car and then
they have almost direct access to the

139
00:13:06,180 --> 00:13:13,660
car by the GOP interface and this not
only needs standard standard poor's

140
00:13:13,660 --> 00:13:22,860
reverse engineering of pc-based not not
very special and we also believe this is

141
00:13:22,860 --> 00:13:28,000
better than remote attacks because the
same software is usually used to do

142
00:13:28,000 --> 00:13:34,420
diagnostic on multiple types of cars
multiple brands and everybody stick into

143
00:13:34,420 --> 00:13:44,430
the carriage regularly so any any car
could be affected in this way so for

144
00:13:44,430 --> 00:13:49,339
proof of concept we decided to
demonstrate that it is indeed easy to do

145
00:13:49,339 --> 00:13:56,240
in practice so in order test environment
we had access to an OGTT because that's

146
00:13:56,240 --> 00:13:59,320
a test card at the University of
Technology

147
00:13:59,320 --> 00:14:04,680
and economics is using for teaching the
Eagle engineers and we have had had

148
00:14:04,680 --> 00:14:09,949
access to that car for some time and so
we have chosen a vital used search party

149
00:14:09,950 --> 00:14:17,740
diagnostic software which basically is
compatible with this car or all the cars

150
00:14:17,740 --> 00:14:24,010
we differ in the fourth group and he
tried to make modifications in this

151
00:14:24,010 --> 00:14:28,189
diagnostic application too low for men
in the middle attacks between the

152
00:14:28,190 --> 00:14:33,800
application and the car which allows us
eavesdropping or modifying messages on

153
00:14:33,800 --> 00:14:39,020
the flight we make the assumption that
the PC is already infected by malware so

154
00:14:39,020 --> 00:14:44,540
we did not write in my hair for this
work but actually the parallel

155
00:14:44,540 --> 00:14:49,290
presentation in the room downstairs
about them are very type of sample that

156
00:14:49,290 --> 00:14:56,740
he wrote for for bypassing different
security protection mechanism but this

157
00:14:56,740 --> 00:15:00,570
work was not about writing them are
where we are seeing the monastery

158
00:15:00,570 --> 00:15:05,690
infected the PC and they momma can carry
out all the equations and applications

159
00:15:05,690 --> 00:15:12,490
that we do because they basically two
very basic modifications ok so the

160
00:15:12,490 --> 00:15:18,200
outline the rest of the talk will be
that we will present you with a little

161
00:15:18,200 --> 00:15:25,210
bit more detail about the system which
we investigated some of the protection

162
00:15:25,210 --> 00:15:30,230
mechanisms that we discovered that the
application developer putting the

163
00:15:30,230 --> 00:15:37,140
application but as you will see it or
not so effective two day did not prevent

164
00:15:37,140 --> 00:15:43,520
us to understand and reverse engineer
the application and the protocols and

165
00:15:43,520 --> 00:15:49,100
then we can go into the details of the
techniques so show you how we replaced

166
00:15:49,100 --> 00:15:52,790
one of the dealers of these applications
we do a very similar kind of attack that

167
00:15:52,790 --> 00:15:57,569
Stuxnet did DL which is responsible for
the communication between the

168
00:15:57,570 --> 00:16:05,040
application and the car diagnostic cable
TV did this replacement then we explain

169
00:16:05,040 --> 00:16:05,990
the whole

170
00:16:05,990 --> 00:16:10,130
reverse engineer the protocol because
there is a proprietary protocol between

171
00:16:10,130 --> 00:16:15,060
the application and diagnostic cable and
we had to understand the message for

172
00:16:15,060 --> 00:16:19,560
months there's also a checksum
computation they had to figure out how

173
00:16:19,560 --> 00:16:25,569
it works because many modify messages
and there is some encryption scheme

174
00:16:25,570 --> 00:16:31,810
involved as well so messages are
encrypted you know certain way and we

175
00:16:31,810 --> 00:16:39,040
had to figure out what holy books and
once we did all these damn can then

176
00:16:39,040 --> 00:16:43,349
implemented many in the middle attack
and explain how we did

177
00:16:43,350 --> 00:16:50,110
logging and replaying modify messages on
the flight and then do you mentioned

178
00:16:50,110 --> 00:17:02,660
some of the experiments including this
ok so let's start with the system so we

179
00:17:02,660 --> 00:17:07,290
have a diagnostic PCV have a nickel and
they are connected via special so

180
00:17:07,290 --> 00:17:13,040
so-called diagnostic cable on the PCB
have a softer stack we have these

181
00:17:13,040 --> 00:17:19,250
diagnostic application running the
diagnostic application in fact is there

182
00:17:19,250 --> 00:17:24,429
the component which was necessary keys
and the protocol implementations for for

183
00:17:24,429 --> 00:17:30,630
communicating with the cable and the car
and it implements certain diagnostic

184
00:17:30,630 --> 00:17:35,929
functions which basically means that it
reads and set a value was inside a car

185
00:17:35,929 --> 00:17:42,390
in India in the selected easy and
communication or so so so sorry was is a

186
00:17:42,390 --> 00:17:47,179
number of dealers and one of those
dealers is a DLL which is responsible

187
00:17:47,179 --> 00:17:55,809
for the communication between the car
and of course at the lower level there

188
00:17:55,809 --> 00:18:00,770
are drivers which implement
communication functions we have this

189
00:18:00,770 --> 00:18:06,470
cable which is in fact not a simple
connect or but inside a cable that is a

190
00:18:06,470 --> 00:18:09,400
microcontroller so there is a small

191
00:18:09,400 --> 00:18:15,750
PCB the microcontroller and other
components in this microcontroller is

192
00:18:15,750 --> 00:18:24,030
basically functions as a gate soil the
application in fact the application and

193
00:18:24,030 --> 00:18:30,180
Andy's get V Day the micro controlling
the cable then translates to messages

194
00:18:30,180 --> 00:18:40,260
and sends them really to do so head to
this communication between the

195
00:18:40,260 --> 00:18:49,330
application and these get to modify and
and we have been on the cardio video be

196
00:18:49,330 --> 00:18:55,580
the stands for on-board diagnostic and
most modern cars has this interface that

197
00:18:55,580 --> 00:19:00,360
manufacturers put in the car for
diagnostic purposes to do diagnostic

198
00:19:00,360 --> 00:19:06,429
work on the car and behind the OBD then
there is the CAN bus which is connecting

199
00:19:06,430 --> 00:19:12,120
the ECU was essentially OBD is not equal
to can but essentially then you have

200
00:19:12,120 --> 00:19:16,850
access to do you have almost direct
access to the cannon you can send

201
00:19:16,850 --> 00:19:24,399
messages to do you see you saw the
application developers try to put some

202
00:19:24,400 --> 00:19:28,250
protection mechanisms in the India
application to prevent reverse

203
00:19:28,250 --> 00:19:33,090
engineering and and hacking the
application so one of one of those is

204
00:19:33,090 --> 00:19:37,590
signing the dealers that the use or
dealers lauded by the application

205
00:19:37,590 --> 00:19:41,760
digitally signed but for some reason
they did not really check those

206
00:19:41,760 --> 00:19:47,930
signatures so in fact this looks like an
effective protection or maybe the check

207
00:19:47,930 --> 00:19:53,870
but did not find their digi-key they
might get some very silently we don't

208
00:19:53,870 --> 00:20:02,649
know but but one of the dealers there is
some program application to the usual

209
00:20:02,650 --> 00:20:07,760
stuff they try to hide the function of
the program program by my office keating

210
00:20:07,760 --> 00:20:15,450
the code with some common methods
however vendor application is started

211
00:20:15,450 --> 00:20:21,350
it deal so if you attach to the applica-
running application

212
00:20:21,350 --> 00:20:25,719
debugger to attach a debugger to already
running application then you and you can

213
00:20:25,720 --> 00:20:31,120
infect investigator memory and
understand how the application of course

214
00:20:31,120 --> 00:20:36,389
you only see the binary but that's why
we have you know who who can read the

215
00:20:36,389 --> 00:20:41,330
binary and and he understands how the
application and then you some License

216
00:20:41,330 --> 00:20:46,658
Verification so you cannot use any any
kind of cable the application checks did

217
00:20:46,659 --> 00:20:52,909
the cable is genuine but there are fake
copies that you can buy and that's

218
00:20:52,909 --> 00:21:04,889
actually that's what did so on Amazon
for $15 Chinese General Cable and so the

219
00:21:04,889 --> 00:21:14,760
Chinese somehow managed or so to get the
license information and put in so we did

220
00:21:14,760 --> 00:21:23,809
not have to be very very few seconds and
then if you wanted to do this man in the

221
00:21:23,809 --> 00:21:29,460
middle so well was to really develop
some component which can do is repeating

222
00:21:29,460 --> 00:21:36,539
can replay messages or inject pic
messages and and one natural idea was to

223
00:21:36,539 --> 00:21:40,049
somehow modified a DLL which is
responsible for the communication

224
00:21:40,049 --> 00:21:45,289
between the application and the car so
he could for instance you know david a

225
00:21:45,289 --> 00:21:48,840
binary because the source code is not
available of course and and some hope is

226
00:21:48,840 --> 00:21:53,990
to binary but all the functions that we
need one infected lose even simpler to

227
00:21:53,990 --> 00:22:01,940
introduce another fake a DLL load that
he'd yell and then that video below the

228
00:22:01,940 --> 00:22:06,000
origin of on energy use just the
functions of the origin of the allow for

229
00:22:06,000 --> 00:22:11,159
communication but since your video is
loading before you get all the course

230
00:22:11,159 --> 00:22:16,590
before and we can do all sorts of
modification before he passed to the

231
00:22:16,590 --> 00:22:20,620
original so that's exactly the idea that

232
00:22:20,620 --> 00:22:27,939
and no idea I give the floor to crash
with you then give you all the details

233
00:22:27,940 --> 00:22:42,030
about the technical part of the moment
but I am Andrew you may know that

234
00:22:42,030 --> 00:22:48,800
usually mean those low there goes an
application to the memory and after work

235
00:22:48,800 --> 00:22:56,460
so it's important and gather the
necessary shared libraries etc and loads

236
00:22:56,460 --> 00:23:03,120
them to the memory too so in this case
windows loader Lothar Thiele named as

237
00:23:03,120 --> 00:23:10,340
the original after it loans to dealers
cause they are their enterprise entry

238
00:23:10,340 --> 00:23:17,928
point before passing the control to the
original application so are the kids and

239
00:23:17,929 --> 00:23:26,360
extracts the origin of the hard drive
and then reload back so that you can see

240
00:23:26,360 --> 00:23:28,168
the chain

241
00:23:28,169 --> 00:23:36,480
application calls read or write function
then we could simply make many in the

242
00:23:36,480 --> 00:23:43,159
military and the redirect the call to
the original function of the original

243
00:23:43,159 --> 00:23:49,279
ideas and then the core interests beyond
the control again and we can return back

244
00:23:49,279 --> 00:23:58,710
to the original application how can we
improve there are some tips firstly you

245
00:23:58,710 --> 00:24:04,119
have to check you have to take care of
yourself party components to not just

246
00:24:04,119 --> 00:24:11,369
for your own competence to check every
the ideal windows the areas maybe and

247
00:24:11,369 --> 00:24:18,499
they two fires that are pleased it's in
your program that your program notes so

248
00:24:18,499 --> 00:24:23,100
you have to perform dictatorship UDD
digital signature checks and CSE checks

249
00:24:23,100 --> 00:24:28,559
before loading and finger and after
learning anything and you should do the

250
00:24:28,559 --> 00:24:37,279
periodically during the program runs and
should integrate some or all of these

251
00:24:37,279 --> 00:24:42,869
checks to York many of your calculations
like when you are sending the request to

252
00:24:42,869 --> 00:24:50,350
disable their usual place empty holes in
the message that will be replaced by

253
00:24:50,350 --> 00:24:54,719
after the calculations of the protection
of them

254
00:24:54,720 --> 00:25:00,649
CNC or digital signature checks and of
course you should use proper

255
00:25:00,649 --> 00:25:08,289
cryptography other reasons not just
simple XOR as you see to reverse

256
00:25:08,289 --> 00:25:16,739
engineer application we used these days
contains exporters name like in the

257
00:25:16,739 --> 00:25:24,009
origin of the idea some of some of them
we redirect some of them but some of

258
00:25:24,009 --> 00:25:26,310
them be modified to make

259
00:25:26,310 --> 00:25:32,000
to end their functionality for example
after you read and I feel right to

260
00:25:32,000 --> 00:25:36,930
modify them and there we can capture or
modify the communication then the

261
00:25:36,930 --> 00:25:45,040
application causes of course we use
favorite 2013 various diagnostic

262
00:25:45,040 --> 00:25:50,610
application cheat engine parameters
scanning and three very rejects the

263
00:25:50,610 --> 00:26:01,540
exact order to capture data and some
handy tools for filtering that they can

264
00:26:01,540 --> 00:26:08,510
see your usual message either consists
of three bites the first light mean the

265
00:26:08,510 --> 00:26:14,570
message direction know this means to the
the message goes to the cables so

266
00:26:14,570 --> 00:26:19,340
sending by the original application goes
to the cable and of course for demeans

267
00:26:19,340 --> 00:26:26,280
the application gets the message and
cable Oscars after that you can see

268
00:26:26,280 --> 00:26:36,540
signs look size by the size the size of
this message including checks on

269
00:26:36,540 --> 00:26:43,690
Wednesday after down the type of the
message in this case its request message

270
00:26:43,690 --> 00:26:48,350
and of course being seven as you can see
his response

271
00:26:48,350 --> 00:26:56,459
know what their debts you can see the
beta-blocker the force some of the force

272
00:26:56,460 --> 00:26:57,580
by force

273
00:26:57,580 --> 00:27:05,659
first of its kind of target identifiers
after that there is data linked identify

274
00:27:05,660 --> 00:27:11,930
your thoughts by singlet that saying bye
comes from the original application

275
00:27:11,930 --> 00:27:19,920
who's the developers leave it in the
application as a simple CString so we

276
00:27:19,920 --> 00:27:27,470
named like this because they named after
and you can see the actual data block

277
00:27:27,470 --> 00:27:28,600
that wheel

278
00:27:28,600 --> 00:27:38,919
the identify your target we discover and
these checks to complete this chick suns

279
00:27:38,920 --> 00:27:46,780
isn't too hard so you can just simply
acts or all of the bites of the message

280
00:27:46,780 --> 00:27:53,980
and you will get the chance can see a
simple acknowledgement message this user

281
00:27:53,980 --> 00:28:01,890
accounts comes from the cable and cable
has done such as truly an operation for

282
00:28:01,890 --> 00:28:07,670
example of course is a type I and III
that this is an acknowledgement message

283
00:28:07,670 --> 00:28:17,540
here is he messaged you still in israel
needs realize the encryption session

284
00:28:17,540 --> 00:28:25,870
this thing in b2 b6 me is this type of
message the key message consists of buds

285
00:28:25,870 --> 00:28:31,649
these boys are in the existing static
table that diagnostic application and

286
00:28:31,650 --> 00:28:39,710
the cable both have this table aesthetic
table consists of randomly generated by

287
00:28:39,710 --> 00:28:52,730
and and you and you also exercised to
perform the encryption you can see in

288
00:28:52,730 --> 00:29:01,630
this example you get the SMS from the
table with the help of the key and you

289
00:29:01,630 --> 00:29:06,400
just simply excellent excellent with the
original message and you will get the

290
00:29:06,400 --> 00:29:12,680
end result and of course you then after
and you have to recompile the Jackson

291
00:29:12,680 --> 00:29:22,490
here is the table as I said this is
static table and of course they are key

292
00:29:22,490 --> 00:29:28,650
value and you can gather these are
indexes and you can get the real

293
00:29:28,650 --> 00:29:35,970
excellent divides from the table as the
following ok

294
00:29:35,970 --> 00:29:45,900
when the application cause or FB right
function we of course need a backup of

295
00:29:45,900 --> 00:29:53,800
the buffer contained in this function
and then we can redirect the call to the

296
00:29:53,800 --> 00:30:00,210
original deal so that's how we love the
logging and of course when the

297
00:30:00,210 --> 00:30:09,620
application is the reason function that
we are in the reeds and then we can save

298
00:30:09,620 --> 00:30:20,729
the bus and can return to the
application before any kind of cable

299
00:30:20,730 --> 00:30:29,420
needs to be realized or tested the cable
during the initialization the cable

300
00:30:29,420 --> 00:30:37,570
examines the capabilities of the car and
the cable to the software examines the

301
00:30:37,570 --> 00:30:44,740
capabilities of the car and the cable
speed limits license etc and store in

302
00:30:44,740 --> 00:30:50,550
temporary files its source in temporary
place usually these tests before any

303
00:30:50,550 --> 00:30:53,260
bigger operation books

304
00:30:53,260 --> 00:31:02,830
okay and you can see here so far checked
the license if you want to perform

305
00:31:02,830 --> 00:31:09,710
license check you have to conduct the
the obd2 connector to the car but you

306
00:31:09,710 --> 00:31:15,630
can bypass this protection with
collecting

307
00:31:15,630 --> 00:31:23,190
will teach to the beach to collect all
16 four-plus and pin for or minus and

308
00:31:23,190 --> 00:31:29,830
that we will use the same here is an
example of locally made the request and

309
00:31:29,830 --> 00:31:36,760
the responses here you can see the
leaders

310
00:31:36,760 --> 00:31:46,270
yes and of course looking be made off I
said the initialization it's it's called

311
00:31:46,270 --> 00:31:54,700
in dinosaur three four tests we we
perform poor test of those cans so far

312
00:31:54,700 --> 00:31:59,950
and of course the cable scans all of the
ECU's in the car and of course the

313
00:31:59,950 --> 00:32:08,920
Arabic consumer and ABS brakes ABS
brakes and the last year because of the

314
00:32:08,920 --> 00:32:14,450
application less functionality or the
cable as function we don't we didn't

315
00:32:14,450 --> 00:32:15,600
know that

316
00:32:15,600 --> 00:32:21,980
and example for replacing session

317
00:32:21,980 --> 00:32:28,740
these are messages all the right so we
have every player to be replaced these

318
00:32:28,740 --> 00:32:38,650
messages messages here you can see these
riots that you have to send out before

319
00:32:38,650 --> 00:32:42,720
any kind of operation this is a kind of
cable in the series in cooperation with

320
00:32:42,720 --> 00:32:54,200
its related is a separate so it is
invisible for the diagnostic application

321
00:32:54,200 --> 00:33:06,000
and if if we want to perform testing
right Steve rights of course by using

322
00:33:06,000 --> 00:33:11,650
STD idea because they too will also uses
the origin of the ideal 02 performed

323
00:33:11,650 --> 00:33:17,440
write and read operations you have to
call these functions with the correct

324
00:33:17,440 --> 00:33:23,520
parameters before any kind of writing or
reading operation and there are some

325
00:33:23,520 --> 00:33:29,920
here instead you have to wait after any
sent out message so you have to try to

326
00:33:29,920 --> 00:33:37,780
be late too late to the cable and of
course the Joker bites that you have to

327
00:33:37,780 --> 00:33:41,700
send me for anything and

328
00:33:41,700 --> 00:33:47,279
yes we could easily replace the future

329
00:33:47,279 --> 00:33:52,450
internal messages because there is no
need to change anything including or

330
00:33:52,450 --> 00:33:58,010
data structure anything you just replay
that we recorded it so let her a simple

331
00:33:58,010 --> 00:34:04,620
process and as I said this really is a
separate application so it is invisible

332
00:34:04,620 --> 00:34:20,279
to the diagnostic application and yes we
can also modify the communication as you

333
00:34:20,280 --> 00:34:27,089
can see here the application sends the
messages in bite after by style so

334
00:34:27,089 --> 00:34:36,009
performers St right on each bite of the
message yes and here is an example of

335
00:34:36,010 --> 00:34:43,750
this it is simple we want too much and
that we want to replace for reaching a

336
00:34:43,750 --> 00:34:50,649
decision that we can find the match and
from the last bite of the match we can

337
00:34:50,649 --> 00:35:03,170
modify the data and copy the others and
of course we calculate the checks and I

338
00:35:03,170 --> 00:35:13,050
think you saw these were the technical
details of how we can local and I

339
00:35:13,050 --> 00:35:19,869
recessions whole weekend replay messages
from a separate application to the to

340
00:35:19,869 --> 00:35:24,040
the diagnostic application and very
importantly hope we can modify messages

341
00:35:24,040 --> 00:35:34,650
on the fly it was running in the in the
faded yellow and can change anything you

342
00:35:34,650 --> 00:35:39,710
know message was sent out by the
application or received from the cable

343
00:35:39,710 --> 00:35:46,660
and utilities tools then the team made
some experiments and this is just too

344
00:35:46,660 --> 00:35:48,609
sure you were some of the

345
00:35:48,610 --> 00:35:54,820
the pictures and some of these things
that he did so so here is this btw in

346
00:35:54,820 --> 00:36:00,140
the gauge of the university and this is
on the receipt in here and having fun

347
00:36:00,140 --> 00:36:11,170
with these experiments were carried out
during spring 2015 and so this slide

348
00:36:11,170 --> 00:36:15,940
shows you that the diagnostic
application itself produces some log

349
00:36:15,940 --> 00:36:28,400
files simple text size and we just
wanted to check if you make and so here

350
00:36:28,400 --> 00:36:33,970
is the original log here here is some
parts of the of the logs that he made

351
00:36:33,970 --> 00:36:41,129
and certain things you see these values
show up or logs so this was just a check

352
00:36:41,130 --> 00:36:47,099
of your skin and the replay of the
airbag anybody simple message

353
00:36:47,099 --> 00:36:54,099
explained it was just very easy
previously recorded messages so these

354
00:36:54,099 --> 00:36:58,499
messages of infected defer all in this
to bite the scene by the source for

355
00:36:58,499 --> 00:37:03,578
different but not really don't really
know what it is what's the purpose of

356
00:37:03,579 --> 00:37:11,390
that scene by its so this replay ver
perfectly earlier recorded message that

357
00:37:11,390 --> 00:37:33,109
could have been experimenting read very
successful conclusion so as we try to

358
00:37:33,109 --> 00:37:42,569
explain cyberattacks on modern threat
but research has started to focus more

359
00:37:42,569 --> 00:37:49,288
on remote attacks and we argued that
there are easier ways and that's what we

360
00:37:49,289 --> 00:37:53,029
mean by the Stuxnet style attack where
you don't really need to have very

361
00:37:53,029 --> 00:37:56,989
special knowledge about cars and
internal components of the cars that you

362
00:37:56,989 --> 00:37:58,599
basically

363
00:37:58,599 --> 00:38:03,479
applications on normal PCs and we
believe it has a much higher risk

364
00:38:03,479 --> 00:38:09,269
because it's easier to do when maybe
more scalable and so on and the proof of

365
00:38:09,269 --> 00:38:15,558
concept that we that we made is is just
simply replacing an Arabic enabled

366
00:38:15,559 --> 00:38:21,769
disabled message which doesn't look like
very sore why why why is it interesting

367
00:38:21,769 --> 00:38:25,709
but this is just a proof of concepts as
as we said we have a man in the middle

368
00:38:25,710 --> 00:38:31,499
tool which means that you can modify
anything you want including may be firm

369
00:38:31,499 --> 00:38:38,569
and interesting thing is that you can
also modify responses from the cable so

370
00:38:38,569 --> 00:38:44,558
you can hide from the diagnostic
application if we set because vendor

371
00:38:44,559 --> 00:38:50,450
that value is read from the from the car
then you modify the response from the

372
00:38:50,450 --> 00:38:56,368
cable showing a different value so in
this case we just deeply back

373
00:38:56,369 --> 00:39:03,160
message now the mechanics convey that
I've an assist softer and tries to read

374
00:39:03,160 --> 00:39:09,170
this setting out from the car and we can
modify the settings that it still shows

375
00:39:09,170 --> 00:39:16,819
that it's gone so they don't the airbag
remains switched off and the diagnostic

376
00:39:16,819 --> 00:39:20,279
application get speaking formation
because of the many in the middle at

377
00:39:20,279 --> 00:39:24,700
that he that he performed and that can
be of course hideous right because if

378
00:39:24,700 --> 00:39:28,939
you can switch off the air bags of
thousands of cars and it's not visible

379
00:39:28,940 --> 00:39:34,749
to anyone than any time in any of those
cars have some accident and it might

380
00:39:34,749 --> 00:39:45,109
have some serious consequences of course
and as I said you can also very small

381
00:39:45,109 --> 00:39:52,569
would look to the future we are you know
this is a new buzzword and Internet of

382
00:39:52,569 --> 00:39:57,680
Things Remembered basically embedded
devices connected wireless internet and

383
00:39:57,680 --> 00:40:04,029
and if you connect these devices way the
internet then of course create so but

384
00:40:04,029 --> 00:40:09,940
the point is dead that body shirt is
valued also for these embedded devices

385
00:40:09,940 --> 00:40:18,130
of the future so basically you manage
those devices from PCs when you connect

386
00:40:18,130 --> 00:40:26,920
your PC to PC or venue later in in the
future you configure your refrigerator

387
00:40:26,920 --> 00:40:30,470
or whatever you probably will not have

388
00:40:30,470 --> 00:40:35,149
pretty user interface to configure but
you will use a PC and you will connect

389
00:40:35,150 --> 00:40:40,820
to the refrigerator and and configured
that the PC so this Hologic what we are

390
00:40:40,820 --> 00:40:45,890
advocating here with so one could in
fact a PC and from the PC or those

391
00:40:45,890 --> 00:40:51,650
embedded devices and what is maybe more
scurrying at least to me and I would

392
00:40:51,650 --> 00:40:58,160
like to just bring this up as a kind of
a discussion topic there what if then

393
00:40:58,160 --> 00:41:04,830
Alastair some point the infection
disappears from the PC demand their deal

394
00:41:04,830 --> 00:41:07,770
itself for instance

395
00:41:07,770 --> 00:41:18,109
detect that would was embedded devices
are in fact affected already and you

396
00:41:18,109 --> 00:41:23,029
know i i dont have it was solution for
that so i as I said just bring it up as

397
00:41:23,030 --> 00:41:27,490
a question what can you really do about
this whole weekend really security

398
00:41:27,490 --> 00:41:34,799
Internet of Things then you have to
steal by multiple PCs which are used to

399
00:41:34,800 --> 00:41:39,530
to modify or manage those devices thank
you for your attention

