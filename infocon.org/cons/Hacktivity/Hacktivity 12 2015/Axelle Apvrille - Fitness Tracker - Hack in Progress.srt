1
00:00:00,000 --> 00:00:07,879
thanks everybody straight the rain fell
what does this it's easy it's a fitness

2
00:00:07,879 --> 00:00:15,088
tracker ok it's the one they're on the
on the slides another bomb as its my

3
00:00:15,089 --> 00:00:23,590
well the 1 I'm hacking and well if you
haven't got one and you don't know what

4
00:00:23,590 --> 00:00:28,750
those are for basically it will sell its
a tractor the Sports Tracker so it will

5
00:00:28,750 --> 00:00:35,489
tell you how many steps you've been
walking it also acts as a sleep

6
00:00:35,489 --> 00:00:42,709
wristbands that's what they advertise it
will tell you if the quality of your

7
00:00:42,710 --> 00:00:51,180
sleep is good you got an efficiently on
that and the display this is really the

8
00:00:51,180 --> 00:01:00,320
entry level sports wristband at four-bit
it has only five led there at the top

9
00:01:00,320 --> 00:01:07,520
there the act like kind of a progress
bar so that you know how far you are

10
00:01:07,520 --> 00:01:13,020
from your next goal like I don't know my
next goal is to walk five thousand steps

11
00:01:13,020 --> 00:01:19,840
in a in a day or 10,000 said something
like that can link some other only the

12
00:01:19,840 --> 00:01:26,750
LEDs army like meant to be meaningful
for somebody it is also vibrate so you

13
00:01:26,750 --> 00:01:30,759
can wake up in the morning with it if
you want or wake up just in time to get

14
00:01:30,759 --> 00:01:39,549
to my top on this you have no altimeter
so if you're hiking on top of the

15
00:01:39,549 --> 00:01:46,040
Everest or whatever well it doesn't hope
has no GPS those are only on them at the

16
00:01:46,040 --> 00:01:49,340
higher your modles

17
00:01:49,340 --> 00:02:01,329
crackers so I actually really like a
plastic there and if you open it up this

18
00:02:01,329 --> 00:02:10,720
is where you get to a small plastic
enclosure dare and that's where you've

19
00:02:10,720 --> 00:02:14,379
got all the logics the electronics and
everything that tells you how many steps

20
00:02:14,379 --> 00:02:20,518
I'm walking during the presentation for
instance right and then I tried to open

21
00:02:20,519 --> 00:02:27,760
it I started well with circular saw and
then my husband came in and he was

22
00:02:27,760 --> 00:02:34,019
frightened to see me with that so he
decided he'd do the job that like

23
00:02:34,019 --> 00:02:42,310
enormous cutter and I was frightened for
his fingers and we tried to open it as

24
00:02:42,310 --> 00:02:49,360
they see it spread eat off because it's
very small enclosure at Splash plastic

25
00:02:49,360 --> 00:02:53,739
is quite solid is difficult to rip
through and then once you've ripped

26
00:02:53,739 --> 00:02:58,090
through its a very difficult not to
break what is inside because what is

27
00:02:58,090 --> 00:03:10,620
inside is very fragile but you can see
there it's their right that's the

28
00:03:10,620 --> 00:03:17,829
Bluetooth antenna and here you can see
on the well the red part there it's the

29
00:03:17,829 --> 00:03:25,139
NFC antenna and there if you have to go
to the highest this is the end of Egypt

30
00:03:25,139 --> 00:03:34,109
right so in the end we managed to open
it without breaking the motherboard well

31
00:03:34,109 --> 00:03:39,090
you leave without breaking it and that's
pretty good because some other guys

32
00:03:39,090 --> 00:03:46,209
i fix it and 360 electronics have tried
and they had broken the motherboard so

33
00:03:46,209 --> 00:03:54,140
the affidavit was no longer responding
here what we broke you can see it is

34
00:03:54,140 --> 00:04:00,089
their fuel so probably had one blinking
anymore but at least it should be still

35
00:04:00,090 --> 00:04:07,730
working and there you can see this is
chip so it's an ST Microelectronics chip

36
00:04:07,730 --> 00:04:13,518
with an ARM Cortex m3 correct on there
you've also got the real time clock

37
00:04:13,519 --> 00:04:22,900
there this is a treat actual
accelerometer ok so this is what

38
00:04:22,900 --> 00:04:33,388
measures the acceleration on three axis
this is the ship this is for charging

39
00:04:33,389 --> 00:04:35,870
and then on the other side

40
00:04:35,870 --> 00:04:41,410
well you got you haven't got that much
faith because the battery takes quite a

41
00:04:41,410 --> 00:04:52,030
lot of space of course and you've got
the vibrator then this is just to this

42
00:04:52,030 --> 00:04:56,729
is all for that the hard way part do you
have an idea how many records have been

43
00:04:56,729 --> 00:05:06,200
told all crackers combined not only for
a bit of 10 million and up for ten

44
00:05:06,200 --> 00:05:16,969
million or two million seventy-million
didn't count looks like it's between

45
00:05:16,970 --> 00:05:21,800
forty million seventy million according
to you at seventy million well according

46
00:05:21,800 --> 00:05:29,930
to steps right and it looks like it's
growing so it's it's really massive

47
00:05:29,930 --> 00:05:31,610
those are words

48
00:05:31,610 --> 00:05:35,020
steps of course well

49
00:05:35,020 --> 00:05:40,469
security conference and hacking
conference so the question we have on

50
00:05:40,469 --> 00:05:46,550
our minds is well can we get it to
register fake steps for instance though

51
00:05:46,550 --> 00:05:51,330
at that hospital is suggesting well if I
walk on four legs while it can former

52
00:05:51,330 --> 00:06:00,479
steps or something like that that's what
we're gonna have a look at so we're

53
00:06:00,479 --> 00:06:06,370
going to have a video for that but
basically I tried to have it registers

54
00:06:06,370 --> 00:06:13,250
some fake steps and I'm lazy like
happens for a quite a few hackers and I

55
00:06:13,250 --> 00:06:18,979
thought ok I'd like it to register the
steps while I'm just sitting at my desk

56
00:06:18,979 --> 00:06:46,789
and working that would be cool and
that's what I did

57
00:06:46,790 --> 00:06:52,790
the tracker

58
00:06:52,790 --> 00:06:58,430
like kind of geeky way I'd say to you to
synchronize course if you are on Windows

59
00:06:58,430 --> 00:07:10,870
or something like that there's an easier
way to do it till it works and I have a

60
00:07:10,870 --> 00:07:17,260
look at the beginning how many steps I
had that day 38 steps but very much

61
00:07:17,260 --> 00:07:25,050
right and then I attached it to offend
yeah it's a very small fam like 50

62
00:07:25,050 --> 00:07:38,350
something like that and that's my office
and that's lazy walking there we go and

63
00:07:38,350 --> 00:07:44,780
then we're gonna try and synchronizing
it again and see how many steps are

64
00:07:44,780 --> 00:07:53,640
being doing you know I've been working
very much and I refresh the page one

65
00:07:53,640 --> 00:08:04,039
hundred and five steps below my dear 67
steps in 45 seconds that's something

66
00:08:04,040 --> 00:08:10,170
like three kilometres an hour it's not
like you know I'm really looking very

67
00:08:10,170 --> 00:08:14,940
fast but it's better than nothing
especially when I'm just sitting on my

68
00:08:14,940 --> 00:08:28,860
cheer but now when it comes to being
lazy to be honest I'm really the worst

69
00:08:28,860 --> 00:08:35,270
on that there were some other
researchers liquidated they attached to

70
00:08:35,270 --> 00:08:35,659
it

71
00:08:35,659 --> 00:08:44,250
to the wheel of their car that's really
great and the wealthy they ran their car

72
00:08:44,250 --> 00:08:49,620
like for 10 minutes not too fast look
and the registered it was something like

73
00:08:49,620 --> 00:08:57,139
a bit over 1000 steps that way which is
not same thing not so fast like it was

74
00:08:57,139 --> 00:09:03,459
maybe four kilometres an hour or more
probably didn't want to drive too fast

75
00:09:03,459 --> 00:09:09,300
and loose their tracker I don't know
exactly how they set it up but that's

76
00:09:09,300 --> 00:09:15,689
another possibility I can put it on my
card and the reef it that way without

77
00:09:15,689 --> 00:09:31,660
actually being abused thats because of
that and because distances only steps

78
00:09:31,660 --> 00:09:38,969
multiplied by the walking stride we can
we can also use distance and of course

79
00:09:38,970 --> 00:09:43,829
we can abuse the calories and a very
active minutes which are displayed on

80
00:09:43,829 --> 00:09:49,508
our bit to count because the oldest
depend at the beginning on what the

81
00:09:49,509 --> 00:09:57,930
tractor registers as steps now what
about running well it turns out that

82
00:09:57,930 --> 00:10:01,010
many people did

83
00:10:01,010 --> 00:10:06,270
research on those actually repeaters and
how it was measured and with an

84
00:10:06,270 --> 00:10:14,120
excellent leader well we can work out a
lot of things for instance we have here

85
00:10:14,120 --> 00:10:20,090
burgers curves for when we're walking
and those there when we're jogging

86
00:10:20,090 --> 00:10:25,550
basically you see higher peaks when
you're jogging because kind of put more

87
00:10:25,550 --> 00:10:31,819
acceleration well not me because I'm
very bad daughter ok but normal people

88
00:10:31,820 --> 00:10:32,810
it would look like

89
00:10:32,810 --> 00:10:39,489
probably you also have some other
patterns for somebody sitting down

90
00:10:39,490 --> 00:10:47,530
standing up when you're standing up
right you get up so you have high

91
00:10:47,530 --> 00:10:52,380
acceleration on the vertical axis and
the radical excesses on that plot the y

92
00:10:52,380 --> 00:11:00,010
axis that's why you have that one beer
can even do better you can actually tell

93
00:11:00,010 --> 00:11:06,319
Rick out what you are doing so you've
got up got here patterns for when your

94
00:11:06,320 --> 00:11:16,440
back you up when you're brushing your
teeth so all of that with only a natural

95
00:11:16,440 --> 00:11:22,560
leader getting the tracks on the three
axis of course I can tell if you're

96
00:11:22,560 --> 00:11:26,410
walking if you're running but I can also
tell you if you're brushing your teeth

97
00:11:26,410 --> 00:11:40,300
so why would we be doing that ok it's
cool to attach ones but it's made you

98
00:11:40,300 --> 00:11:45,930
kind of elaborate useless well the goal
behind it at least for him and that

99
00:11:45,930 --> 00:11:51,219
hackers or is someone who wants to get
something out of it is two earned and

100
00:11:51,220 --> 00:11:56,660
deserved badges it's the way I will be
able to turn my five thousand steps

101
00:11:56,660 --> 00:12:04,189
badge my 10,000 steps bad or something
like that and with that you can just

102
00:12:04,190 --> 00:12:05,059
programs

103
00:12:05,059 --> 00:12:11,848
from various companies which will give
you 100 points that you can redeem for

104
00:12:11,849 --> 00:12:18,889
various gifts like a gift card $50 gift
card that's that happens can get some

105
00:12:18,889 --> 00:12:26,199
special discounts were brought suit
whatever and they're plenty of other

106
00:12:26,199 --> 00:12:30,919
things that you can get from those
there's for instance again link solution

107
00:12:30,919 --> 00:12:39,439
for a company called packed well they
say dat attracted to them and then you

108
00:12:39,439 --> 00:12:42,319
say ok this morning or today

109
00:12:42,319 --> 00:12:52,829
walk 10,000 steps that's my bed and you
play some money if you only do like 9000

110
00:12:52,829 --> 00:12:58,419
well you lose you lose your money and
your money goes through the other people

111
00:12:58,419 --> 00:13:03,749
wonder bet if you win your bet you get
here Monday plus a little bit of all the

112
00:13:03,749 --> 00:13:11,989
the money that the others lost their bet
ok so you can get some real money just

113
00:13:11,989 --> 00:13:19,829
cheating and getting those under sheriff
badges so that's kind of a motivation

114
00:13:19,829 --> 00:13:25,039
for attackers of course there's also
money for business

115
00:13:25,039 --> 00:13:31,899
obvious but all those nation companies
which gets that they die from your

116
00:13:31,899 --> 00:13:42,209
fitness trackers will make money out of
it here we have company who engage with

117
00:13:42,209 --> 00:13:47,508
Fitbit tractors and they say they said
well we are launching our

118
00:13:47,509 --> 00:13:54,879
industry-leading privacy protected of
course and secure API and with that

119
00:13:54,879 --> 00:14:03,389
trusted partners on an opt-in basically
to receive health outcomes activity data

120
00:14:03,389 --> 00:14:12,389
from participating users so there's
money for everyone there

121
00:14:12,389 --> 00:14:21,399
distance everything with an
accelerometer we can do actually more

122
00:14:21,399 --> 00:14:22,670
than

123
00:14:22,670 --> 00:14:27,550
hiking in tracking steps we can even
know if you're brushing your teeth or

124
00:14:27,550 --> 00:14:37,130
vacuuming your house and there's money
for everybody there are legitimate and

125
00:14:37,130 --> 00:14:43,939
when the tractor an attacker and also
the industry and when there's money

126
00:14:43,940 --> 00:14:54,940
that's fact we know there's also there's
always threats now we're going to

127
00:14:54,940 --> 00:15:00,870
investigate investigate a little bit
more the software part of that this

128
00:15:00,870 --> 00:15:08,280
record their only knows Bluetooth well
it also knows that NFC but I haven't got

129
00:15:08,280 --> 00:15:14,199
any any NFC device so I haven't tried
but that but at odds with Bluetooth cell

130
00:15:14,200 --> 00:15:20,760
if you want to synchronize your data you
have at some point you have there like a

131
00:15:20,760 --> 00:15:29,560
dongle Bluetooth USB dongle or a
smartphone that knows due to the low

132
00:15:29,560 --> 00:15:37,369
energy and there's those device will
kind of relay your synchronize data to

133
00:15:37,370 --> 00:15:46,980
the Fitbit service at the other end what
I wanted to do is just put myself on my

134
00:15:46,980 --> 00:15:55,340
laptop and from the laptop your fitness
tracker I just want to be able to talk

135
00:15:55,340 --> 00:16:00,540
to it to send messages to receive
messages from it and learn from bad to

136
00:16:00,540 --> 00:16:07,740
start hacking it so I wrote a small pipe
and utility to do that and try to write

137
00:16:07,740 --> 00:16:12,800
to it it's pretty easy because actually
we just have to send USB messages to the

138
00:16:12,800 --> 00:16:18,849
right endpoint there's one endpoint for
the dongle right there and another point

139
00:16:18,850 --> 00:16:25,140
for the tracker so you send the USB
message tractor and actually after after

140
00:16:25,140 --> 00:16:30,290
that it goes to the tracker there so
we're gonna

141
00:16:30,290 --> 00:16:45,740
try try to talk

142
00:16:45,740 --> 00:17:09,190
I have with my own stuff and then well
we can get some information like on the

143
00:17:09,190 --> 00:17:10,720
dongle

144
00:17:10,720 --> 00:17:24,380
and mac address

145
00:17:24,380 --> 00:17:32,710
detect crackers the room if some of you
have crackers in the front rows they

146
00:17:32,710 --> 00:17:39,190
will probably be detected as well

147
00:17:39,190 --> 00:18:02,020
all messages with the tracker all along
with yeah there's plenty of truckers

148
00:18:02,020 --> 00:18:25,450
i think is the first one the other three
items the the RSS see that means like

149
00:18:25,450 --> 00:18:32,860
forgot signal strength reform forgot the
art but the hired is the closer distance

150
00:18:32,860 --> 00:18:39,020
by USD tengo cell that's quite logical I
have first one is mine it's close to

151
00:18:39,020 --> 00:18:46,450
that and then the other ones are like
features that those trackers have so now

152
00:18:46,450 --> 00:19:00,510
I'm going to have to select the tracker
I want to talk with

153
00:19:00,510 --> 00:19:30,379
yours up and I can't see mine any longer

154
00:19:30,380 --> 00:19:36,870
very good test because actually at work
I only tried with one dongle because the

155
00:19:36,870 --> 00:19:47,770
other one as you can see a rip it off
and now what can I do what I can for

156
00:19:47,770 --> 00:19:49,960
instance

157
00:19:49,960 --> 00:20:06,350
I can't write this now see yet but this
one has led link linking my device where

158
00:20:06,350 --> 00:20:15,149
do we always have to reset its I'm sorry
about all of this stuff is a bit painful

159
00:20:15,149 --> 00:20:22,310
but either way is it just says time out
all the time we can get its

160
00:20:22,310 --> 00:21:03,399
data

161
00:21:03,399 --> 00:21:32,258
at the beginning at least 10 and 12
version 2 we don't really care that

162
00:21:32,259 --> 00:21:37,489
there's a sequence counter at the
beginning and this is basically like a

163
00:21:37,489 --> 00:21:45,179
modal indicator of which kind of flakes
which version number and then you've got

164
00:21:45,179 --> 00:21:51,519
the intricate encrypted blob which is
encrypted with keys from Fitbit which

165
00:21:51,519 --> 00:22:09,630
contains all the steps and all the
activity I've been doing

166
00:22:09,630 --> 00:22:22,020
so everything manually because there's
no kind of hackers documentation of

167
00:22:22,020 --> 00:22:30,050
course for those device so it was pretty
long of course I managed to reverse like

168
00:22:30,050 --> 00:22:36,470
20 messages for the dongle they have a
different type and then 24 messages for

169
00:22:36,470 --> 00:22:42,200
the tractor with a different type and
then there's the communication with the

170
00:22:42,200 --> 00:22:49,430
server and itself the Fitbit servers
this is done through HTTP or HTTPS with

171
00:22:49,430 --> 00:22:53,720
an XML communication protocol and this
is pretty easy to reverse because he

172
00:22:53,720 --> 00:22:59,760
just have to like Wireshark network
traffic and see how it's working but

173
00:22:59,760 --> 00:23:07,330
that this isn't really difficult there
so we'll just have a glimpse at what

174
00:23:07,330 --> 00:23:14,560
track your package looks like I won't be
going in the details of the 24 packets

175
00:23:14,560 --> 00:23:21,010
of course what happens is that all
packages that you sent you send to the

176
00:23:21,010 --> 00:23:27,150
tractor they always start by see 0 the
indicator for this is attracted packets

177
00:23:27,150 --> 00:23:33,100
then you got the command identifier and
10 in that case means get stumped

178
00:23:33,100 --> 00:23:39,810
requests which means I would like to get
the data to synchronize the tracker

179
00:23:39,810 --> 00:23:46,669
received and will start to respond by ok
I'm gonna start and send you my data but

180
00:23:46,670 --> 00:23:56,380
just and so this is command identifier
41 yard dog a dump response then that's

181
00:23:56,380 --> 00:24:03,630
the encrypted blog that you sell on the
utility and then and the end it sends

182
00:24:03,630 --> 00:24:11,160
another packet to say okay I finished
and you've got also the dump that can be

183
00:24:11,160 --> 00:24:15,740
sure that you haven't been missing and
packet for instance there is also with

184
00:24:15,740 --> 00:24:24,290
CRC at some point but haven't seen any
cash for instance there we go

185
00:24:24,290 --> 00:24:29,450
ok so we can do plenty of things we can
get the information of the dongle we can

186
00:24:29,450 --> 00:24:34,660
we can see how many truckers they are
nearby you want to come later on then

187
00:24:34,660 --> 00:24:42,770
tried to synchronize with my drool you
come and see me afterwards we can have

188
00:24:42,770 --> 00:24:51,639
the LEDs blink thats great now just
imagine if I tell my my management you

189
00:24:51,640 --> 00:24:57,510
know it's great I've been working like
her three months and I'm able to get a

190
00:24:57,510 --> 00:25:02,610
few LED blink and what we can do it with
the standard tool but here I can do it

191
00:25:02,610 --> 00:25:09,780
with my own tool I'm not sure they'd be
impressed so well try and do a bit more

192
00:25:09,780 --> 00:25:27,620
than that it would be it's really very
easy you've got like 20 very bad five

193
00:25:27,620 --> 00:25:34,959
excellent be sure that if you put 0 alt
ratchets and if you can generate like

194
00:25:34,960 --> 00:25:42,410
1999 instead of five that would be
interesting for me as well but the real

195
00:25:42,410 --> 00:25:49,210
question i'd say mine management would
be interested in is rather well this

196
00:25:49,210 --> 00:25:55,110
tractor get infected get it done now if
you know I'm working with for tonight

197
00:25:55,110 --> 00:26:01,590
and I'm a malware analyst there so this
is really what my boss will be

198
00:26:01,590 --> 00:26:07,570
interested or if it can be really
infected or if it can is it able to

199
00:26:07,570 --> 00:26:13,629
propagate a malware to other devices

200
00:26:13,630 --> 00:26:22,650
so we were down an injection scenario
where we have an attacker the statins

201
00:26:22,650 --> 00:26:34,170
malicious code to the tractor the
tractor gets infected and then next time

202
00:26:34,170 --> 00:26:41,150
while the eye doctor can go away the
victim is going to discover that

203
00:26:41,150 --> 00:26:48,510
sometimes end point was going to
discover the tractor for instance if he

204
00:26:48,510 --> 00:26:53,180
wants to know to synchronize it or
something like that and what's

205
00:26:53,180 --> 00:26:59,400
interesting there is that we managed to
get all responses from the tractor also

206
00:26:59,400 --> 00:27:06,800
contain thats malicious code right so
from now on whenever the infected

207
00:27:06,800 --> 00:27:10,260
tractor or something

208
00:27:10,260 --> 00:27:18,970
well it will always answer some packets
the malicious code and then of course

209
00:27:18,970 --> 00:27:26,020
victims lapped up an image and plenty of
nasty things that this malicious payload

210
00:27:26,020 --> 00:27:35,610
will deliver like crashed laptop
propagate to another device that show

211
00:27:35,610 --> 00:27:51,909
you that goes

212
00:27:51,910 --> 00:27:59,310
this way so it's really before I started
to really like a hacker as proof of

213
00:27:59,310 --> 00:28:18,980
concepts it's not very visual I'm sorry
about that

214
00:28:18,980 --> 00:28:28,860
and I'm going to inject the tractor
imaginative malicious codes but it's not

215
00:28:28,860 --> 00:28:34,750
for demonstration purposes I'm just
injecting the string hatch reflects

216
00:28:34,750 --> 00:28:44,490
light and then each time I send a
command to my tracker you can see below

217
00:28:44,490 --> 00:28:49,440
their that it is always answering the
right packet

218
00:28:49,440 --> 00:28:58,169
also hike reflects which is which could
be a malicious count then I decided okay

219
00:28:58,169 --> 00:29:03,559
I sent plenty of messages and there's
always had affects their what happens if

220
00:29:03,559 --> 00:29:16,450
I really totally reset my tracker can I
still see that injected current 100% her

221
00:29:16,450 --> 00:29:32,370
and they do a complete reset and we lose
a few but they're still recovering

222
00:29:32,370 --> 00:29:38,799
like most of it which is what we're
interested in so we can perhaps but

223
00:29:38,799 --> 00:29:43,600
actually be injected by deliberate
further on so that we're not losing them

224
00:29:43,600 --> 00:29:54,299
so this is possible because on the
tracker which has been of course is

225
00:29:54,299 --> 00:30:04,610
closed and which they said they will be
patching

226
00:30:04,610 --> 00:30:17,840
exactly what you can see it's a proof of
concept there was no real malicious code

227
00:30:17,840 --> 00:30:23,100
tele just a string being sent and that
we see you coming back in all packets

228
00:30:23,100 --> 00:30:27,360
afterwards the other limitation I have

229
00:30:27,360 --> 00:30:36,840
is that with this technique I am only
able to inject almost seventeen bite 17

230
00:30:36,840 --> 00:30:43,590
bucks that's not that's not a lot right
choice for a fool alleged but not force

231
00:30:43,590 --> 00:30:49,090
but still i think is still valuable
because if you are old enough to recall

232
00:30:49,090 --> 00:30:53,590
like the crash fan pension program and

233
00:30:53,590 --> 00:30:59,320
2004 well it was only for a bite you
received those four bites on your

234
00:30:59,320 --> 00:31:06,168
computer and it would crash crash it
completely so 17 bytes is really far

235
00:31:06,169 --> 00:31:14,080
more than that the other limitation that
we have for now is that I haven't been

236
00:31:14,080 --> 00:31:18,760
working on the way to actually execute
were delivered the payload on the

237
00:31:18,760 --> 00:31:24,390
hottest show on the victim it receives
the packet the infected packet but it

238
00:31:24,390 --> 00:31:30,669
still has to infective to infect the
laptop or do something on it this means

239
00:31:30,669 --> 00:31:35,899
like exploiting perhaps the USB stack
were exploiting the Bluetooth tax things

240
00:31:35,899 --> 00:31:41,649
like that that's for some other parts of
research to be done there and of course

241
00:31:41,649 --> 00:31:45,709
then yeah the limit of course is that
fit but will be patching thought this

242
00:31:45,710 --> 00:31:53,630
would be possible anyway in a few months
probably now some other things we can do

243
00:31:53,630 --> 00:32:01,779
with the tracker there like images I
don't know you don't want to use your

244
00:32:01,779 --> 00:32:07,179
tractor any longer for sports and you
want to do something else with it or

245
00:32:07,179 --> 00:32:11,840
imagined that i denote the Fitbit
servers are down and don't know what to

246
00:32:11,840 --> 00:32:18,658
do with this tractor and a longer well
we can use it as a source of entropy so

247
00:32:18,659 --> 00:32:23,570
that's perhaps because I like
cryptography so i thought well you know

248
00:32:23,570 --> 00:32:27,600
you're always like a good source of
entropy how about using this track of

249
00:32:27,600 --> 00:32:35,620
their the way we do it again is just
having a look at the various messages

250
00:32:35,620 --> 00:32:42,870
that we can send to the tracker there is
one message which is cool like attentive

251
00:32:42,870 --> 00:32:43,928
Kaeding

252
00:32:43,929 --> 00:32:52,629
the tracker which is meant to set a bond
between the smartphone and the tractor

253
00:32:52,629 --> 00:32:55,139
and for that

254
00:32:55,139 --> 00:33:02,320
well the dongle where the smartphone is
going to sense a challenge the tractor

255
00:33:02,320 --> 00:33:08,418
response the other way with his own
challenge and then the dongle is meant

256
00:33:08,419 --> 00:33:14,759
to computer match out of those to check
those two random numbers numbers and

257
00:33:14,759 --> 00:33:21,070
that way to attend Kate towards the
tractor now if we just want a random

258
00:33:21,070 --> 00:33:29,720
number generator we are just interested
in the second packet 151 to get that one

259
00:33:29,720 --> 00:33:36,629
we just sent like it better be dummy
first 150 we don't care we don't have to

260
00:33:36,629 --> 00:33:41,330
generate the local random number will
just send always the same one and then

261
00:33:41,330 --> 00:33:47,610
we read the random number that the
tracker $0.02 sent us and we use that as

262
00:33:47,610 --> 00:34:23,489
a source of randomness thrive at

263
00:34:23,489 --> 00:34:41,029
and R&D that is get random numbers so
the first few bites first eight bytes to

264
00:34:41,030 --> 00:34:46,260
get are a bit slow because has to
establish the Bluetooth link to the

265
00:34:46,260 --> 00:34:51,940
tractor and then it goes I wouldn't call
that fast but fast enough to get some

266
00:34:51,940 --> 00:35:04,859
some random numbers they're so those are
the random numbers that generate now I'm

267
00:35:04,859 --> 00:35:11,900
sure but you wonder ok those are the
look random but are they really random

268
00:35:11,900 --> 00:35:19,560
that's really a good question right so
well I tested them with the batteries of

269
00:35:19,560 --> 00:35:24,799
tests which are in our recommended by
this for their own

270
00:35:24,800 --> 00:35:32,970
random number generators that they want
to kind of test so there's a toll call

271
00:35:32,970 --> 00:35:39,299
and switch regroup all those first test
the key square test the means-test in

272
00:35:39,300 --> 00:35:43,380
the Monte Carlo P test and then there's
another batteries of tests which is

273
00:35:43,380 --> 00:35:51,890
called D harder and in an ideal world ok
that's what we're targeting we would

274
00:35:51,890 --> 00:35:58,980
have a random number generator with
those values they're right you never get

275
00:35:58,980 --> 00:36:07,190
this course because ideal world is never
perfect and that's what we get for our

276
00:36:07,190 --> 00:36:14,869
tractor there and what we see off
compared it with some other sources of

277
00:36:14,869 --> 00:36:22,130
entropy so Victor Hugo this is French
literature just you see how it goes when

278
00:36:22,130 --> 00:36:29,650
something is not around them that their
friends here while ciphertext is meant

279
00:36:29,650 --> 00:36:33,829
to be pretty much ran them at the end
when it's encrypted so it's also a good

280
00:36:33,829 --> 00:36:40,859
way to test you just see how good random
output would be and then you've got some

281
00:36:40,859 --> 00:36:48,509
critical evidence like radioactive decay
is as well compared with and the results

282
00:36:48,510 --> 00:36:52,369
or it's difficult

283
00:36:52,369 --> 00:37:00,920
there's no real excellent random number
generator but it looks ok I mean it

284
00:37:00,920 --> 00:37:06,220
doesn't look really worth that what we'd
have stand standard on the Linux systems

285
00:37:06,220 --> 00:37:17,578
for instance so I would not using it for
a cryptography but not too bad so yeah

286
00:37:17,579 --> 00:37:26,529
that's what we are able to fool steps
distance count we can have our lives

287
00:37:26,529 --> 00:37:33,549
blink thats great i like it personally
but we can also have worries we can see

288
00:37:33,549 --> 00:37:39,009
that the synchronized synchronization
data that go to the theatre bizarre

289
00:37:39,009 --> 00:37:47,539
encrypted and I'll be working on that
later we are able to inject 17 bunch on

290
00:37:47,539 --> 00:37:52,559
the tracker which could be proud
potentially harmful makers we could

291
00:37:52,559 --> 00:37:58,509
weaken that way infect our tracker and
propagate the infection to other devices

292
00:37:58,509 --> 00:38:07,950
and we are able to track her as a random
number generator that's it you've got a

293
00:38:07,950 --> 00:38:14,649
few links there if you want to see some
more the tools might or will be posted

294
00:38:14,650 --> 00:38:19,290
in a few days the time I get back home

295
00:38:19,290 --> 00:38:33,210
we've got time for questions are you
happy to answer

296
00:38:33,210 --> 00:38:37,880
and have some of you want to try to
synchronize their tracker with the tool

297
00:38:37,880 --> 00:38:55,109
as possible as well

298
00:38:55,109 --> 00:39:10,670
yes this work is applicable

299
00:39:10,670 --> 00:39:22,330
others like they don't have the same
directly the same headers I haven't

300
00:39:22,330 --> 00:39:26,170
reversed exactly all of them but

301
00:39:26,170 --> 00:39:34,090
yes the synchronized the same way you
send the messages the same way it's the

302
00:39:34,090 --> 00:39:39,730
same way to communicate with the tracker
they just do have some for instance for

303
00:39:39,730 --> 00:39:44,720
those with a screen you have some
messages which are implemented on this

304
00:39:44,720 --> 00:39:52,549
one but not used well on both search for
instance or on the charge those packets

305
00:39:52,550 --> 00:40:09,990
are really useful and do something on
that on the device

306
00:40:09,990 --> 00:40:22,129
I don't know what to do with that little
media would be fixing i talked with them

307
00:40:22,130 --> 00:40:29,119
first time it was in March March this
year and they told me it was a bug not

308
00:40:29,119 --> 00:40:37,200
to security issue so I told them well I
don't mind as long as i fix it so they

309
00:40:37,200 --> 00:40:45,399
haven't fixed it yest that's the only
thing I know

310
00:40:45,400 --> 00:41:00,040
well yeah I don't know if you so there I
can get the firmware data well except

311
00:41:00,040 --> 00:41:03,930
that it's encrypted same thing so

312
00:41:03,930 --> 00:41:15,870
I can't make all the sense out of it yet
it's there somewhere data so they have

313
00:41:15,870 --> 00:41:20,600
the way yet to update the firmware and
probably that what they will do do it

314
00:41:20,600 --> 00:41:21,580
that way

315
00:41:21,580 --> 00:41:28,690
patch and send an update afterwards to
people who were synchronizing I guess

316
00:41:28,690 --> 00:41:54,860
it's the way they're gonna do it does
that answer your question

317
00:41:54,860 --> 00:42:06,710
yeah I haven't I tried to cover it
because it's encrypted for now it leaves

318
00:42:06,710 --> 00:42:12,590
the tractor there at leave it it's
already encrypted so when I see the

319
00:42:12,590 --> 00:42:18,200
bites on the laptop it's already
encrypted a feisty have a look at them

320
00:42:18,200 --> 00:42:24,620
on the smartphone same it's encrypted
and when I discussed with some tidbits a

321
00:42:24,620 --> 00:42:29,299
security engineers they told me that
they indeed they considered their laptop

322
00:42:29,300 --> 00:42:35,240
or smartphone as outside the security
enclosure so that they had encrypted

323
00:42:35,240 --> 00:42:41,080
before which is actually I guess good
measure so it's encrypted and for now

324
00:42:41,080 --> 00:42:49,470
I'm not even sure what they are using it
could be either a yes or XP I am Not

325
00:42:49,470 --> 00:42:57,540
sure that I haven't been able to locate
the key they are using either and for

326
00:42:57,540 --> 00:43:02,790
that I need to inspect the hardware so
that's why at the beginning we started

327
00:43:02,790 --> 00:43:07,300
like opening it and now we have to i get
through to probe the hardware to to get

328
00:43:07,300 --> 00:43:13,570
something I haven't been able to see
anything more with the software

329
00:43:13,570 --> 00:43:29,450
but when I asked encrypted on the
tracker so comparing encrypted data is

330
00:43:29,450 --> 00:43:42,618
useless yes I can downgrade of social at
the beginning of

331
00:43:42,619 --> 00:43:48,180
ya at the beginning of the packet
there's a sequence counter and for

332
00:43:48,180 --> 00:43:53,490
instance I tried some other times to do
some replay attacks on steps like a

333
00:43:53,490 --> 00:43:59,680
record every package that is going to be
a bit server while I've been doing ten

334
00:43:59,680 --> 00:44:05,230
steps and tried to replace that with
changing the sequence counters correctly

335
00:44:05,230 --> 00:44:09,970
and it did not work so I guess that it's
more than just encryption there's

336
00:44:09,970 --> 00:44:16,430
probably in the encrypted packets either
some timer or something more but that's

337
00:44:16,430 --> 00:44:21,720
not working if you replace it so might
not be possible to downgrade for the

338
00:44:21,720 --> 00:44:33,618
same reason so I tried other brands no I
have not I have been playing with some

339
00:44:33,619 --> 00:44:42,099
other devices like the Sony SmartWatch
as well but the architecture is

340
00:44:42,099 --> 00:44:48,470
completely different tests absolutely no
ya no relationship with with a tractor

341
00:44:48,470 --> 00:44:58,379
to try other trackers to be fun

342
00:44:58,380 --> 00:45:06,770
ok well I guess that's all unless
there's another one

343
00:45:06,770 --> 00:45:08,890
well thank you very much for attending
them

