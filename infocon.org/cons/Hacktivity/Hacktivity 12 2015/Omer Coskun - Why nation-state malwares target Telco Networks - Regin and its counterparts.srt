1
00:00:00,470 --> 00:00:08,610
welcome hi my name is Omar thank you for
coming out to listen my talk today I'm

2
00:00:08,610 --> 00:00:12,030
going to prison to an offensive security
network

3
00:00:12,030 --> 00:00:17,519
offensive network security research
related to the nation state attacks

4
00:00:17,519 --> 00:00:26,159
targeting telecommunication networks
just briefly what we are going to cover

5
00:00:26,159 --> 00:00:30,869
his introduction to the terror network
architecture and the network protocol

6
00:00:30,869 --> 00:00:37,700
that are being highly targeted such as
Jerry network architecture and i7

7
00:00:37,700 --> 00:00:43,240
protocol and the main concern of this
talk is one of the most credited

8
00:00:43,240 --> 00:00:51,290
government implements region while there
before delving into it is capabilities I

9
00:00:51,290 --> 00:00:57,240
will try to briefly remind the rootkit
techniques as region is a multicomponent

10
00:00:57,240 --> 00:01:03,440
long-term intelligence-gathering good
kids revel brought through the region

11
00:01:03,440 --> 00:01:10,100
capabilities and then analyze how it
could be recognized in an offensive

12
00:01:10,100 --> 00:01:16,169
Jason natural taking as recently there
are more technically complex implant

13
00:01:16,170 --> 00:01:23,440
discovered by the researchers will
briefly make a comparison and finally I

14
00:01:23,440 --> 00:01:28,740
will present them all the more to show
you how some of the techniques employed

15
00:01:28,740 --> 00:01:35,280
by the region implant could be
implemented by a high-level programming

16
00:01:35,280 --> 00:01:42,100
language such as Windows driver
development kids and API programming in

17
00:01:42,100 --> 00:01:51,788
C C++ great about myself my chemical
background is computers I'm currently

18
00:01:51,789 --> 00:01:56,700
working for KPN telecom is red team
which is also known as Royal Dutch

19
00:01:56,700 --> 00:02:03,539
telecom I used to work for companies
like IBM I S I perform security

20
00:02:03,539 --> 00:02:08,940
assessment on my day-to-day work and I'm
very interested in malware analysis

21
00:02:08,940 --> 00:02:18,260
techniques and this is red team we are
based in Amsterdam and it's only six

22
00:02:18,260 --> 00:02:25,010
minutes from the Amsterdam is most
popular Center cause cold as the red

23
00:02:25,010 --> 00:02:36,040
light district what inspires us to carry
this research was to analyze and

24
00:02:36,040 --> 00:02:42,470
determine architecture of GSM any inner
GSM networks governments are not only

25
00:02:42,470 --> 00:02:48,620
helping their own students by spy on
each other by covered taking cooperation

26
00:02:48,620 --> 00:02:55,859
with tools like originals felt
surveillance programs research greater

27
00:02:55,859 --> 00:03:01,940
level recent leaks from on media
conference that network devices telecom

28
00:03:01,940 --> 00:03:08,410
networks are the victims of the DS
programs or directly contributors of

29
00:03:08,410 --> 00:03:16,150
them once the region he can campaign
revealed pretty pretty much each and

30
00:03:16,150 --> 00:03:21,630
every telecommunication company got para
know it and try to make sure that they

31
00:03:21,630 --> 00:03:22,390
haven't been

32
00:03:22,390 --> 00:03:28,829
affected by this by the same attack and
root kids are really fun that I

33
00:03:28,830 --> 00:03:35,170
regarding a lot to learn about all the
internals channel working principles and

34
00:03:35,170 --> 00:03:41,958
the computer architecture I'm sure not
only understanding the incident but also

35
00:03:41,959 --> 00:03:48,590
to be able to reproduce use simulation
of attack

36
00:03:48,590 --> 00:04:01,880
mean a lot to do who dated a very close
to brake systems architecture is very

37
00:04:01,880 --> 00:04:08,640
complex however let us tried to break
down the following core elements global

38
00:04:08,640 --> 00:04:14,010
system for mobile communication stands
for GSM network is developed for a

39
00:04:14,010 --> 00:04:22,270
digital mobile radio communication over
violence and wireless and mobile

40
00:04:22,270 --> 00:04:28,630
communications GPRS an extension of GSM
network that provides mobile wireless

41
00:04:28,630 --> 00:04:37,850
data communication GSM network consists
of the following elements from a

42
00:04:37,850 --> 00:04:44,330
security perspective the important ones
are mobile station based trustee

43
00:04:44,330 --> 00:04:53,349
receiver base station controller base
station subsystem switching center

44
00:04:53,350 --> 00:05:01,200
authentication centers home location
register visit or location register for

45
00:05:01,200 --> 00:05:07,860
a researcher which are these companies
are highly being targeted are the mobile

46
00:05:07,860 --> 00:05:15,660
switching center this is the company for
digital ist estimates that connection to

47
00:05:15,660 --> 00:05:22,240
other mobile switching centers and to
base station controllers

48
00:05:22,240 --> 00:05:29,210
mobile switching centers are the
foremost wired backbone of GSM network

49
00:05:29,210 --> 00:05:33,250
and cancers caused to the public
switched telecommunications network

50
00:05:33,250 --> 00:05:40,470
equipment identity register is the
equipment is a database that stores

51
00:05:40,470 --> 00:05:48,949
international Equipment Identity is best
known as in May numbers of the stations

52
00:05:48,949 --> 00:05:55,250
within the network equipment identified
the Thunder to the registers

53
00:05:55,250 --> 00:06:01,789
manufacturers of the mobile stations and
equipment register provide security

54
00:06:01,789 --> 00:06:07,020
features such as blocking calls from
hands health that have been stalling for

55
00:06:07,020 --> 00:06:15,698
example HLR is a home location register
is a central database for all users to

56
00:06:15,699 --> 00:06:20,840
register their register to the GSM
matter its stores static information

57
00:06:20,840 --> 00:06:26,469
about subscriber such as international
mobile South Korea driver's identity

58
00:06:26,469 --> 00:06:32,000
subscribes services in a key for
attending authenticating subscribers

59
00:06:32,000 --> 00:06:37,699
they taylor also stores dynamic truck
driver information for instance to

60
00:06:37,699 --> 00:06:44,310
current location of the mobile
subscriber physically and authentication

61
00:06:44,310 --> 00:06:50,340
Center associated with a july is the
authentication center this database

62
00:06:50,340 --> 00:06:56,330
contains all gore attempts for
authenticating subscribers and the

63
00:06:56,330 --> 00:07:03,690
necessary for encryption to safe guards
used for authentication and lastly BLR

64
00:07:03,690 --> 00:07:10,110
visitor location register is distributed
database that temporarily stored

65
00:07:10,110 --> 00:07:14,860
information about the mobile station
that are active in geographic area for

66
00:07:14,860 --> 00:07:19,060
which we all are responsible

67
00:07:19,060 --> 00:07:27,400
associated with mobile switching center
in the natural many of have tried wrongs

68
00:07:27,400 --> 00:07:33,529
into their location area the real are
responsible for copying transcriber

69
00:07:33,529 --> 00:07:35,630
information from a lot of it is luck

70
00:07:35,630 --> 00:07:49,900
database communicating among its network
elements communication also accused or

71
00:07:49,900 --> 00:07:54,130
the interfaces to the management
database management database companies

72
00:07:54,130 --> 00:08:00,900
are we all are each other or temptation
center equipment or register identifier

73
00:08:00,900 --> 00:08:10,120
communication might run multiple
messages but ultimately must reach the

74
00:08:10,120 --> 00:08:16,330
Gator get raised this separate interests
exist between each pair of the elements

75
00:08:16,330 --> 00:08:22,560
each interface of cars on programming
protocol the network sewage system is

76
00:08:22,560 --> 00:08:28,060
the heart of the GSM system it connects
wireless network to the standard wire

77
00:08:28,060 --> 00:08:36,070
natural it is responsible for and of
course from one base station systems to

78
00:08:36,070 --> 00:08:42,219
another to perform services such as
charging accounting and the rooming and

79
00:08:42,219 --> 00:08:46,500
different signal signaling protocol
various interfaces Thomas and asset

80
00:08:46,500 --> 00:08:51,710
integrated involved in only control
signaling protocol with no traffic for

81
00:08:51,710 --> 00:08:57,750
example no traffic is generated on the
interfaces between a challenge we all

82
00:08:57,750 --> 00:09:04,510
are these interfaces Carolina signaling
mobile application part on the s7

83
00:09:04,510 --> 00:09:14,290
protocol so how these are related to the
IRS region while they're specifically

84
00:09:14,290 --> 00:09:20,800
targeted GSM networks the antivirus
companies say region has been developed

85
00:09:20,800 --> 00:09:26,109
to be low key type of malware that can
potentially be used in the espionage

86
00:09:26,110 --> 00:09:33,790
campaigns lasting several years since
2008 the company was only able to

87
00:09:33,790 --> 00:09:36,630
analyze its actions

88
00:09:36,630 --> 00:09:43,220
decrypting sample files discovering it
is actions are particularly difficult to

89
00:09:43,220 --> 00:09:46,840
decipher the original related

90
00:09:46,840 --> 00:09:53,260
tell hacking campaigns are also confront
by the recently hit the matter the

91
00:09:53,260 --> 00:09:59,580
following picture was taken in Germany a
group of activists protesting against

92
00:09:59,580 --> 00:10:04,640
the GCHQ and an essay to get their
retirement from the day-to-day thomas'

93
00:10:04,640 --> 00:10:14,689
until now no one has real and clear idea
how to target GSM and other institutions

94
00:10:14,690 --> 00:10:20,430
for hecht so we try to determine the
attack possible action areas and the

95
00:10:20,430 --> 00:10:26,219
attack source says our competition like
high-profile organizations such like an

96
00:10:26,220 --> 00:10:31,370
ass agency GCHQ our approach pretty nice
look like similar to the whole school

97
00:10:31,370 --> 00:10:40,880
technique of North Korea to bring them
their own needs in order to determine

98
00:10:40,880 --> 00:10:46,170
potential attack scenarios we decided to
perform a large-scale immigration from

99
00:10:46,170 --> 00:10:54,209
base stations for the israeli three have
possibly topped just a communication

100
00:10:54,210 --> 00:10:57,370
from radio base stations be great

101
00:10:57,370 --> 00:11:02,480
greatly utilize my clothes knowns versus
network tackling utility in areas such

102
00:11:02,480 --> 00:11:11,500
as it had seen in the picture we try to
collect as much information as possible

103
00:11:11,500 --> 00:11:18,490
from different endpoints of to G 3G and
LTE communication it also included

104
00:11:18,490 --> 00:11:25,710
passable management services that you're
reachable from base station and to

105
00:11:25,710 --> 00:11:32,550
network switches so what we have
discovered directed research from the

106
00:11:32,550 --> 00:11:38,880
BTS whereas the absence of physical
intrusion system I'm specifically

107
00:11:38,880 --> 00:11:48,030
talking about inter-regional whether
wiretapping happens or not the wisest

108
00:11:48,030 --> 00:11:51,650
we also discovered a devices can be
altered or changed most yes some

109
00:11:51,650 --> 00:11:55,650
companies don't even take into
consideration if somebody infiltrate

110
00:11:55,650 --> 00:12:01,520
into space station and we discovered
were honorable service is running a

111
00:12:01,520 --> 00:12:09,910
triple from BTS including management
interfaces with default password public

112
00:12:09,910 --> 00:12:15,880
and private keys and influence of Tampa
rather than a notarized Access

113
00:12:15,880 --> 00:12:20,520
Protection welded natural tapping
shouldn't have been possible in that

114
00:12:20,520 --> 00:12:31,069
change and in turn on there is a big
segmentation issue and in a statement

115
00:12:31,070 --> 00:12:38,670
reachable from the BTS and our
conclusion and experiment revealed that

116
00:12:38,670 --> 00:12:46,800
it was possible to exploit natural
systems from the car GPS unit from the

117
00:12:46,800 --> 00:12:54,510
media since their stations are one of
the most outrageous and natural

118
00:12:54,510 --> 00:12:58,450
complement we want to see whether it is
possible to attack other Internet

119
00:12:58,450 --> 00:13:03,740
companies they start juice information
such as transportation controller a

120
00:13:03,740 --> 00:13:09,590
cello and viola if you ever perform
similar assessment you'd be surprised

121
00:13:09,590 --> 00:13:15,140
very change it in from Jason lateral
very gang getting GSM network from the

122
00:13:15,140 --> 00:13:19,230
radio stations especially if the
segmentation are not correctly

123
00:13:19,230 --> 00:13:25,370
implemented this what we experienced it
let's take a look at companies that

124
00:13:25,370 --> 00:13:35,430
could be targeted to remotely jerry is
GPRS roaming exchange

125
00:13:35,430 --> 00:13:43,359
acts as a hub for GPRS connection from
roaming the need of the educated links

126
00:13:43,360 --> 00:13:49,550
between each GPRS service providers it
said network consisted of periods

127
00:13:49,550 --> 00:13:54,609
interconnect the manger G Derrick
skaters are located for Europe in

128
00:13:54,610 --> 00:13:58,580
Amsterdam and for Asia in Singapore

129
00:13:58,580 --> 00:14:00,899
essentially when

130
00:14:00,899 --> 00:14:07,610
you travel abroad your for your strong
drugs communicated through your provider

131
00:14:07,610 --> 00:14:20,540
at onto this infrastructure GSM roaming
exchange interconnection networks your

132
00:14:20,540 --> 00:14:27,990
location your local GSM provide a broad
trust made it highly interconnected made

133
00:14:27,990 --> 00:14:33,649
for internet sharing a failure or
malicious activity of what affect

134
00:14:33,649 --> 00:14:41,410
multiple users and multiple missions
multiple attack vectors are available

135
00:14:41,410 --> 00:14:53,170
not limited to particular segment or
very orange netting from a group of

136
00:14:53,170 --> 00:14:59,899
ip-based communications protocol used to
carry General Packet Radio Service

137
00:14:59,899 --> 00:15:08,610
within the GSM UMTS and LTE letter GTP
can be decomposed into separate protocol

138
00:15:08,610 --> 00:15:17,699
GTB see GDP and GDP GDP prime GDP used
within the GPS connector for signaling

139
00:15:17,699 --> 00:15:25,959
between GPs important support not GTP
you is used for change user data within

140
00:15:25,959 --> 00:15:33,359
the GPS core network between radio
network and the connector GTP prime uses

141
00:15:33,360 --> 00:15:39,329
the same message structure and GTP C&D
TPU but as an intern independent

142
00:15:39,329 --> 00:15:50,319
function GDP can be used if it UDP or
TCP UDP is either recommended or

143
00:15:50,319 --> 00:15:55,130
mandatory

144
00:15:55,130 --> 00:16:01,000
one of the most important feature of GTP
tunnel shirley is that the DNS on Jerry

145
00:16:01,000 --> 00:16:08,370
used for resolving a ps2 setup GTP
tunnel and access point is the name of

146
00:16:08,370 --> 00:16:14,960
gateway between a GPRS 3G and 4G mobile
networks and another computer natural

147
00:16:14,960 --> 00:16:24,630
fruit kind access to the public Internet
capture and RTP packet transmitted a lot

148
00:16:24,630 --> 00:16:31,450
of information such as name three stops
crime network tunnel endpoint these

149
00:16:31,450 --> 00:16:38,410
might be also useful to correlate a
person and he's her activities to do the

150
00:16:38,410 --> 00:16:47,400
rest of the world if you have enough
information and tid the field to present

151
00:16:47,400 --> 00:16:54,240
eg GTP C header using to tunnel I don't
fight FTD idea the fully qualified

152
00:16:54,240 --> 00:17:01,030
Turner endpoint identifier if you're not
familiar with all these jerry can Metro

153
00:17:01,030 --> 00:17:06,790
and practical details you can imagine is
if your carrier read the setting from

154
00:17:06,790 --> 00:17:14,050
north or south London was a setup and
testing to determine the correct IP to

155
00:17:14,050 --> 00:17:20,579
connect to and to connect to secure
gateway and see you need a private

156
00:17:20,579 --> 00:17:29,350
network like a VPN according to the
former head of the National Security

157
00:17:29,350 --> 00:17:37,370
Agency Michael Hayden he agreed with the
idea that metadata the information

158
00:17:37,370 --> 00:17:42,219
collected by the NSA about phone calls
and other communication that doesn't

159
00:17:42,220 --> 00:17:50,070
include the actual content can tell the
government everything

160
00:17:50,070 --> 00:17:54,950
about anyone it is targeting for
surveillance of filmmaking to actual

161
00:17:54,950 --> 00:18:01,440
content communication is unnecessary and
advances in machine learning and

162
00:18:01,440 --> 00:18:08,090
artificial intelligence make it possible
to predict potential human behavior if

163
00:18:08,090 --> 00:18:17,399
they enough data is provided as is and
has seven is communication common

164
00:18:17,400 --> 00:18:22,810
channel signaling system that trust
boris has 7 messages over and accessible

165
00:18:22,810 --> 00:18:31,310
network which is developed in nine
nineteen seventies which this

166
00:18:31,310 --> 00:18:37,260
implementation didn't introduce a new
security features back down then there's

167
00:18:37,260 --> 00:18:41,280
a six-run victory in the city of
protocol extension of the system

168
00:18:41,280 --> 00:18:52,110
protocol defined to trust boris has 7
messages over IP IP networks

169
00:18:52,110 --> 00:18:58,419
7 introduces procedures for you there
are identification rafting building and

170
00:18:58,420 --> 00:19:05,910
call management says seven consists of
parts message thruster Party ANPP 1 and

171
00:19:05,910 --> 00:19:13,070
type 2 and type III for political
signalling connection control there is

172
00:19:13,070 --> 00:19:18,649
also signalling connection part
transport capabilities application part

173
00:19:18,650 --> 00:19:27,690
telephony user part ISDN user part of
some of the testimony include flow

174
00:19:27,690 --> 00:19:34,560
control of trust transmitted information
traffic congestion control your identity

175
00:19:34,560 --> 00:19:44,610
status detection or traffic monitoring
and monitoring measurement system global

176
00:19:44,610 --> 00:19:49,679
communication protocol standards that
define procedures by which network

177
00:19:49,680 --> 00:19:52,809
elements within the public switched
telephone

178
00:19:52,809 --> 00:19:58,649
california Natural exchange control
information or digital links for setting

179
00:19:58,649 --> 00:20:07,049
up managing and tearing down while
wireline and wireless cause I think

180
00:20:07,049 --> 00:20:11,700
that's a seven is not
application-specific and works or IP it

181
00:20:11,700 --> 00:20:21,200
enables multiple network elements to
work together there are ready to use

182
00:20:21,200 --> 00:20:28,499
tools available for a system
experimentation one of them is $7 that I

183
00:20:28,499 --> 00:20:38,869
used during my research is a powerful
attack surface analysis paper from

184
00:20:38,869 --> 00:20:45,699
traffic analysis over SSL protocol the
experimentation revealed that it was

185
00:20:45,700 --> 00:20:52,629
possible to accept trade many thought
they do see information such as caller

186
00:20:52,629 --> 00:20:57,899
no goalie no information related to
their call

187
00:20:57,900 --> 00:21:07,590
such as call duration calls start and
times and the coast taters please

188
00:21:07,590 --> 00:21:13,230
remember that these are all information
so-called metadata for rich people are

189
00:21:13,230 --> 00:21:14,230
being killed

190
00:21:14,230 --> 00:21:26,790
let ross tourism of attacks on areas
authors or 87 protocol when I subscriber

191
00:21:26,790 --> 00:21:32,750
registers honesty reach the subscriber
profile is copied from a gelateria large

192
00:21:32,750 --> 00:21:41,040
database from from a teller to the
reality is assuming and I think you

193
00:21:41,040 --> 00:21:46,810
manage to make changes in BLR daytime is
he can't change parameters and fake

194
00:21:46,810 --> 00:21:52,899
subscriber in four so that victims can
be redirected to a conference call to

195
00:21:52,900 --> 00:22:02,660
call each time and culminate so the
attacker can simply record and listen to

196
00:22:02,660 --> 00:22:03,410
the call

197
00:22:03,410 --> 00:22:10,660
passively while caller assuming that
he's directly communicating a colleague

198
00:22:10,660 --> 00:22:21,400
by introducing a decoy real are you need
today seven network an attacker can

199
00:22:21,400 --> 00:22:26,960
intercept SMS messages and drop a
confirmation that the message was

200
00:22:26,960 --> 00:22:31,800
legitimate to the recipient if the
victim use mobile banking or another so

201
00:22:31,800 --> 00:22:38,590
serious that use one-time SMS pets then
he can recover or still these passwords

202
00:22:38,590 --> 00:22:48,500
to make money transfer or the take home
internet account furthermore the

203
00:22:48,500 --> 00:22:53,060
following attack scenarios are also
possible by manipulating we all R and H

204
00:22:53,060 --> 00:22:58,159
other units in this area networks
interception of SMS messages

205
00:22:58,160 --> 00:23:03,690
interception of outgoing calls
redirecting incoming

206
00:23:03,690 --> 00:23:14,350
cause for outgoing calls making changes
in user bills and balance recently

207
00:23:14,350 --> 00:23:21,539
researchers discovered that it is
possible to block cell phone by

208
00:23:21,539 --> 00:23:27,370
exploiting a trust relationship between
May and emcee for equipment identity

209
00:23:27,370 --> 00:23:28,918
register

210
00:23:28,919 --> 00:23:44,580
access I don't register simply checks
whether controller unit returns to in

211
00:23:44,580 --> 00:23:55,549
map check image structure and entries
for a whitelisted so you can read more

212
00:23:55,549 --> 00:24:00,019
about the attack scenario as the
resources LEAs for public and available

213
00:24:00,019 --> 00:24:09,720
on the internet and interesting my
locker room team which is known for

214
00:24:09,720 --> 00:24:16,029
selling weaponize surroundings to the
oppressive governments are also

215
00:24:16,029 --> 00:24:23,000
interested in exploiting a 74 user
location tracking to technically true

216
00:24:23,000 --> 00:24:31,139
that is just seen on the circle the
location of mobile for could be obtained

217
00:24:31,139 --> 00:24:38,100
during the time of quarter

218
00:24:38,100 --> 00:24:51,260
journal entries along Route careful when
we say user or link to read it if we are

219
00:24:51,260 --> 00:24:58,450
referring executables that Carly system
privileges however one of the richest in

220
00:24:58,450 --> 00:25:03,000
other things they are good kids run
highly privileged they will offer

221
00:25:03,000 --> 00:25:04,289
operating system

222
00:25:04,289 --> 00:25:17,179
these are also known as device drivers
technique hijacking your function or a

223
00:25:17,179 --> 00:25:21,610
system call and change the execution
flow in a way that accurately and

224
00:25:21,610 --> 00:25:28,850
modified change or obtain what is being
said and we think we can together if if

225
00:25:28,850 --> 00:25:36,809
a pilot hijacked a ship they still
treasure and let a ship continued to its

226
00:25:36,809 --> 00:25:38,639
destination if they wish

227
00:25:38,640 --> 00:25:48,500
cooking techniques used by the malicious
applications to monitor user actions or

228
00:25:48,500 --> 00:25:53,809
application behavior as well as
legitimate applications for the same

229
00:25:53,809 --> 00:26:00,720
purpose for instance antivirus
applications youth cooking techniques to

230
00:26:00,720 --> 00:26:07,970
detect malicious behavior in the system
such as key logging back to an extra and

231
00:26:07,970 --> 00:26:15,190
the same applies to the malicious
applications and boxes

232
00:26:15,190 --> 00:26:20,140
Keith also uses this technique sure
militia or hiding their activities

233
00:26:20,140 --> 00:26:26,130
within the sixth system they infected
most commonly known techniques for user

234
00:26:26,130 --> 00:26:32,330
line application file import address
table who can be lol injection and in

235
00:26:32,330 --> 00:26:34,230
line hoping

236
00:26:34,230 --> 00:26:41,150
addressed to analytical user other
systems systems service table

237
00:26:41,150 --> 00:26:47,840
descriptive input-output directors who
can in turn interrupt address table

238
00:26:47,840 --> 00:26:50,080
descriptive and global address

239
00:26:50,080 --> 00:26:58,189
descriptor table hooting and lastly see
center who can these techniques are

240
00:26:58,190 --> 00:27:04,730
widely available on internet so we will
not delve into the DS so I advise you to

241
00:27:04,730 --> 00:27:14,510
take a look on the internet and read it
and regionalism very multi-platform very

242
00:27:14,510 --> 00:27:20,779
complex multi-platform lookit that
consisted of dropper module and

243
00:27:20,779 --> 00:27:27,210
multi-stage user and kernel level
components each level seem to

244
00:27:27,210 --> 00:27:32,620
responsible of decrypting and lauding
modules into the memory and executing

245
00:27:32,620 --> 00:27:41,219
them the most interesting feature of
Regent lot from that did you

246
00:27:41,220 --> 00:27:46,940
orchestrator and it was very near to the
researchers until the date of discovery

247
00:27:46,940 --> 00:27:56,549
it can be taught as a RPC call to
specific kernel driver to enable and

248
00:27:56,549 --> 00:28:02,070
activate if then the payload that
utilized for the actually performing

249
00:28:02,070 --> 00:28:09,120
militias action in the system one of the
most interesting militias action was to

250
00:28:09,120 --> 00:28:15,479
be able to was employed by the region

251
00:28:15,480 --> 00:28:23,289
Twitter us to be able to monitor GSM
network base station command as you may

252
00:28:23,289 --> 00:28:31,200
have read on the antivirus report

253
00:28:31,200 --> 00:28:38,429
so what were the challenges and heard a
soft director no one had to drop from a

254
00:28:38,429 --> 00:28:46,210
July started eight of the analysis it
was multi-stage encrypted very complex

255
00:28:46,210 --> 00:28:58,880
modulus friend remarked by RPC caused by
the French Mali day tires stored inside

256
00:28:58,880 --> 00:29:06,490
virtual file system and also the
encryption type was our C five not

257
00:29:06,490 --> 00:29:09,260
commonly seen in Mali implementation up
there

258
00:29:09,260 --> 00:29:14,669
up till that time and research GSM
network at no indication of compromise

259
00:29:14,669 --> 00:29:23,740
so we came up a solution and how to
solve this problem

260
00:29:23,740 --> 00:29:29,600
the best way to start to Astor regards
the encryption brain of the frame the

261
00:29:29,600 --> 00:29:37,230
orchestrator and a common accompanied
with memory dumps of infected systems in

262
00:29:37,230 --> 00:29:42,590
collaboration to the different
researchers estimate cost to do dynamic

263
00:29:42,590 --> 00:29:45,070
analysis in that way

264
00:29:45,070 --> 00:29:52,220
a similar issue which has done by
Russian researcher and it has more

265
00:29:52,220 --> 00:30:02,639
detailed exploration nation on the given
link to the region framework pages the

266
00:30:02,639 --> 00:30:08,479
stage one two and three of the region
platform are solely responsible of

267
00:30:08,480 --> 00:30:21,580
description of preceding stages page 1
execution of stage crew which is

268
00:30:21,580 --> 00:30:27,500
developed in the kernel module in the
centerpiece h1 simply users memory

269
00:30:27,500 --> 00:30:34,120
triangle cost to allocate memory pool
for stage 2 consequently it makes these

270
00:30:34,120 --> 00:30:44,590
two preceding module is a kernel driver
who had a conflagration block block

271
00:30:44,590 --> 00:30:51,340
contains the names of two system
directory that hotel encrypted towards

272
00:30:51,340 --> 00:31:00,709
stage in their extended attribute so if
the stage chart has a signal page to

273
00:31:00,710 --> 00:31:07,430
calculate a start of called off the
region that would make the detection

274
00:31:07,430 --> 00:31:17,830
much more harbors and the second state
also create a martyr file that can be

275
00:31:17,830 --> 00:31:23,199
used to identify infected machine it can
simply clears previous stages and

276
00:31:23,200 --> 00:31:30,420
creates an encryption file encrypted
file which requires that is for Cano

277
00:31:30,420 --> 00:31:35,960
palos so actually the kernel payloads
are stored in file container which will

278
00:31:35,960 --> 00:31:47,130
fall container page three years kernel
driver manager and stage for the brain

279
00:31:47,130 --> 00:31:52,010
of the region framework did his
orchestrator responsible of northern

280
00:31:52,010 --> 00:32:04,870
China modules

281
00:32:04,870 --> 00:32:11,780
attached process and interesting for an
API call that retain attached current

282
00:32:11,780 --> 00:32:17,510
rate to do address space of target
process that we open source analyzing

283
00:32:17,510 --> 00:32:27,190
trading platform I think our goal is to
reproduce and assimilated region

284
00:32:27,190 --> 00:32:33,050
functionalities and instruments
instrument payload I created a simple

285
00:32:33,050 --> 00:32:39,730
routine that that simply attached to an
application or intercept system cause

286
00:32:39,730 --> 00:32:50,590
and change them in a way that we wish
this is very simple courts interpret

287
00:32:50,590 --> 00:32:55,959
showing how to obtain process
environment block of process and

288
00:32:55,960 --> 00:33:07,580
obtained base addresses of modules
attaching threat to it

289
00:33:07,580 --> 00:33:12,629
this may not be very concrete
compression among Europe's 3G and do

290
00:33:12,630 --> 00:33:18,820
good too but two things to be most
complex what you discovered until now

291
00:33:18,820 --> 00:33:24,928
and also modules and the approach how to
operate malicious actions on the target

292
00:33:24,929 --> 00:33:33,200
system changed forward time for instance
to robberies in the past

293
00:33:33,200 --> 00:33:42,090
bypassing patch patch guard but original
to do good using stolen and legitimate

294
00:33:42,090 --> 00:33:47,370
certificate

295
00:33:47,370 --> 00:33:59,350
I created a small trailer causes of two
modules journal entry level model and

296
00:33:59,350 --> 00:34:05,480
its malaise orchestrated behavior that
is implemented in in a similar way and

297
00:34:05,480 --> 00:34:06,580
implemented it

298
00:34:06,580 --> 00:34:17,168
region framework and the future of the
simulator include colored latex

299
00:34:17,168 --> 00:34:23,219
alteration running threat of the
legitimate application address space and

300
00:34:23,219 --> 00:34:33,310
totally make it invisible to the user's
orchestrated simulator and partial RPC

301
00:34:33,310 --> 00:34:41,850
calls same as the original frame monitor
or file system registry and natural call

302
00:34:41,850 --> 00:34:51,080
who came back door and Caleb imagine
pretty much that you can see in

303
00:34:51,080 --> 00:35:15,540
ransomware critical an exciting time for
them I hope it won't fail

304
00:35:15,540 --> 00:35:25,690
I tried implemented for boat 64 bit and
32 bit I'm going to show you the torture

305
00:35:25,690 --> 00:35:32,000
to get everything written in C C++
development kids driver development

306
00:35:32,000 --> 00:35:43,760
sheet I have two modules which is
executable here

307
00:35:43,760 --> 00:35:52,360
usual and kernel driver and this is a
batch file simply involved I will show

308
00:35:52,360 --> 00:35:56,360
the content of the bunch fire

309
00:35:56,360 --> 00:36:06,680
simply log to executable without color
palettes and most system controller and

310
00:36:06,680 --> 00:36:14,549
execute as their file system kernel
driver and their status and then excused

311
00:36:14,550 --> 00:36:24,300
to use the land of the free framework so
says it is not recognized with an 80 day

312
00:36:24,300 --> 00:36:30,370
or part within an executable a simple
executable just for demonstration

313
00:36:30,370 --> 00:37:17,880
purposes I made it very simple but I'm
going to do is I will just copy is 32

314
00:37:17,880 --> 00:37:58,300
and since the malware is implemented by
simple STD calls right now the hulking

315
00:37:58,300 --> 00:38:07,270
tribe it can be clearly seen that these
are hook's tryna level hook's that

316
00:38:07,270 --> 00:38:23,210
intercepts and change its behavior in
the system and privileged user I have a

317
00:38:23,210 --> 00:38:28,690
client so I can remotely connect and
depending on firewall configuration and

318
00:38:28,690 --> 00:38:34,890
I could change the party for the sake of
simplicity I'll show here

319
00:38:34,890 --> 00:38:41,150
capabilities so it's a client can
connect to the infected machine by

320
00:38:41,150 --> 00:38:46,270
simply providing IP address I had called
it the part number for the sake of

321
00:38:46,270 --> 00:38:55,940
simplicity so it connects it is a shell
you can just around some militias

322
00:38:55,940 --> 00:39:03,780
activities on the system and by the way
this is totally still totally updated

323
00:39:03,780 --> 00:39:12,000
anti-virus and it cannot detect
execution of it because it intercepts

324
00:39:12,000 --> 00:39:20,220
some calls and heightened fell from the
antivirus I want to just demonstrate to

325
00:39:20,220 --> 00:39:23,520
some of the simple

326
00:39:23,520 --> 00:39:30,600
client comments I can send to system I
can run executable on the system

327
00:39:30,600 --> 00:39:37,620
involves some file open 8 I can encrypt
entire disk and I can kill the system by

328
00:39:37,620 --> 00:39:45,470
simply writing some changes in the fine
structure of the system for example let

329
00:39:45,470 --> 00:39:45,759
me demonstrate

