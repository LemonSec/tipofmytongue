1
00:00:00,060 --> 00:00:05,970
so today we're gonna talk about Android

2
00:00:01,680 --> 00:00:09,480
and more explicitly about the debugging

3
00:00:05,970 --> 00:00:14,040
protocol that's being used to help

4
00:00:09,480 --> 00:00:16,139
various developers into just debugging

5
00:00:14,040 --> 00:00:19,770
their apps faster and how it became

6
00:00:16,139 --> 00:00:22,710
weaponized by the bad guys so first

7
00:00:19,770 --> 00:00:27,509
thing first let's find a bit more about

8
00:00:22,710 --> 00:00:31,890
you guys who uses an Android device all

9
00:00:27,510 --> 00:00:34,170
right we present with add an Android

10
00:00:31,890 --> 00:00:37,170
developer around here or not only

11
00:00:34,170 --> 00:00:39,870
developer just maybe you just compiled

12
00:00:37,170 --> 00:00:44,610
an Android studio project at some point

13
00:00:39,870 --> 00:00:47,879
in your life nice nice so all of the

14
00:00:44,610 --> 00:00:50,719
stuff that it's being pushed to your

15
00:00:47,879 --> 00:00:55,399
phone is being pushed through the

16
00:00:50,719 --> 00:01:01,199
Android through the USB cable and

17
00:00:55,399 --> 00:01:04,170
somehow along those lines the Google

18
00:01:01,199 --> 00:01:07,770
added a new feature in which you could

19
00:01:04,170 --> 00:01:10,470
expose that set protocol USB protocol

20
00:01:07,770 --> 00:01:12,179
over the network but a lot of the

21
00:01:10,470 --> 00:01:14,070
details somehow got lost into

22
00:01:12,180 --> 00:01:17,430
translation and this is gonna be the

23
00:01:14,070 --> 00:01:21,508
focus for today's talk a bit more about

24
00:01:17,430 --> 00:01:25,380
me I recently joined the cyber security

25
00:01:21,509 --> 00:01:28,320
field a few years ago I did my big stunt

26
00:01:25,380 --> 00:01:30,658
by hacking doing some simple me faire

27
00:01:28,320 --> 00:01:33,199
hack on the public transportation system

28
00:01:30,659 --> 00:01:37,740
in Bucharest which on which I did a

29
00:01:33,200 --> 00:01:40,530
responsible disclosure and got PR karma

30
00:01:37,740 --> 00:01:43,110
and after I discovered that I couldn't

31
00:01:40,530 --> 00:01:47,909
travel freely around Bucharest I decided

32
00:01:43,110 --> 00:01:50,159
to basically hack my car and this led to

33
00:01:47,909 --> 00:01:52,439
some interesting discoveries about the

34
00:01:50,159 --> 00:01:56,399
amount of information that your car

35
00:01:52,439 --> 00:01:59,329
knows about you in my case its knew a

36
00:01:56,399 --> 00:02:03,630
lot more about me than I knew myself

37
00:01:59,329 --> 00:02:07,710
about my phone but you can just google

38
00:02:03,630 --> 00:02:11,549
that up the presentation is somewhere on

39
00:02:07,710 --> 00:02:13,049
the internet follow me on github for all

40
00:02:11,550 --> 00:02:14,850
of the

41
00:02:13,050 --> 00:02:17,520
oh then all of the stuff that I'm gonna

42
00:02:14,850 --> 00:02:23,160
show you and on Twitter for the latest

43
00:02:17,520 --> 00:02:27,690
means that I'm gonna post so how why did

44
00:02:23,160 --> 00:02:30,030
I start working on this I mean I don't

45
00:02:27,690 --> 00:02:32,700
just wake up one day and decide it okay

46
00:02:30,030 --> 00:02:35,970
I'm gonna write on a BB honeypot it's

47
00:02:32,700 --> 00:02:38,609
gonna be awesome the root cause was

48
00:02:35,970 --> 00:02:41,670
basically the advent of everything

49
00:02:38,610 --> 00:02:45,420
that's smart nowadays and most

50
00:02:41,670 --> 00:02:49,109
explicitly the reuse of motherboards

51
00:02:45,420 --> 00:02:53,239
into modern IOT devices now you've got

52
00:02:49,110 --> 00:02:58,050
smart TVs smart fridges smart toasters

53
00:02:53,240 --> 00:03:00,570
smart cars that actually use PCBs

54
00:02:58,050 --> 00:03:03,630
motherboards that were used for other

55
00:03:00,570 --> 00:03:06,540
Android devices and actually some of

56
00:03:03,630 --> 00:03:07,980
them actually run Android and who knows

57
00:03:06,540 --> 00:03:10,650
maybe in the future we're gonna have

58
00:03:07,980 --> 00:03:13,380
like even smarter toasters or I don't

59
00:03:10,650 --> 00:03:17,250
know who around you watches Battlestar

60
00:03:13,380 --> 00:03:19,380
Galactica around here alright so for

61
00:03:17,250 --> 00:03:21,330
whoever doesn't know in the future they

62
00:03:19,380 --> 00:03:24,329
did the right thing they basically

63
00:03:21,330 --> 00:03:26,490
banned all IOT devices so you no longer

64
00:03:24,330 --> 00:03:29,400
had any kind of network communication

65
00:03:26,490 --> 00:03:33,740
between devices at least in military

66
00:03:29,400 --> 00:03:36,750
applications but more on that later

67
00:03:33,740 --> 00:03:38,820
while browsing the Internet I also found

68
00:03:36,750 --> 00:03:41,360
out that I was the own I wasn't the only

69
00:03:38,820 --> 00:03:44,760
one worried about the dangers of

70
00:03:41,360 --> 00:03:49,080
unprotected IOT devices this is a really

71
00:03:44,760 --> 00:03:54,060
cool piece from Kevin Berman in which he

72
00:03:49,080 --> 00:03:58,050
explains the advent of some new kind of

73
00:03:54,060 --> 00:04:00,600
malware that is being pushed on Android

74
00:03:58,050 --> 00:04:05,690
support five five five five

75
00:04:00,600 --> 00:04:12,239
does it ring any bell to you guys right

76
00:04:05,690 --> 00:04:15,329
so Android as I mentioned earlier has

77
00:04:12,239 --> 00:04:17,760
this really simple protocol or what used

78
00:04:15,330 --> 00:04:22,770
to be a really simple protocol that

79
00:04:17,760 --> 00:04:25,500
worked over either USB or TCP and from

80
00:04:22,770 --> 00:04:26,280
what some really clever guys told me it

81
00:04:25,500 --> 00:04:28,560
was designed

82
00:04:26,280 --> 00:04:32,179
just be as a simple stream multiplexer

83
00:04:28,560 --> 00:04:35,310
and that was that however over the years

84
00:04:32,180 --> 00:04:38,580
more and more and more stuff got added

85
00:04:35,310 --> 00:04:42,270
and these somehow complicated things but

86
00:04:38,580 --> 00:04:45,870
I thought how hard can it be I will just

87
00:04:42,270 --> 00:04:49,889
read RFC's and it will work well it

88
00:04:45,870 --> 00:04:56,460
didn't it just didn't work I didn't know

89
00:04:49,889 --> 00:04:59,430
why so maybe the problem was that there

90
00:04:56,460 --> 00:05:02,700
was no vulnerability maybe everything

91
00:04:59,430 --> 00:05:08,040
was fine so I started doing a bit more

92
00:05:02,700 --> 00:05:11,300
and it was this is an IP that you could

93
00:05:08,040 --> 00:05:17,160
find just by going around show then and

94
00:05:11,300 --> 00:05:20,880
connect to it do some random and read

95
00:05:17,160 --> 00:05:25,950
shell stuff and it was already infected

96
00:05:20,880 --> 00:05:28,580
by malware another malware and another

97
00:05:25,950 --> 00:05:31,219
one that was running on the same device

98
00:05:28,580 --> 00:05:34,800
so these are not three separate devices

99
00:05:31,220 --> 00:05:37,320
there are only one and somehow the bad

100
00:05:34,800 --> 00:05:39,060
guys didn't hit the same problems when

101
00:05:37,320 --> 00:05:41,430
they were trying to do the attacking I

102
00:05:39,060 --> 00:05:43,770
was having problems when I was trying to

103
00:05:41,430 --> 00:05:47,160
do the whole tricking them into

104
00:05:43,770 --> 00:05:49,830
connecting to me part so I was missing

105
00:05:47,160 --> 00:05:53,160
something but anyway

106
00:05:49,830 --> 00:05:55,109
even if I develop it I mean how bad

107
00:05:53,160 --> 00:05:57,120
would it be because they secured Android

108
00:05:55,110 --> 00:06:02,039
right they added an authentication

109
00:05:57,120 --> 00:06:04,320
method in Android 4.2.2 I think and at

110
00:06:02,039 --> 00:06:07,169
least over USB you could not connect

111
00:06:04,320 --> 00:06:11,400
unless they you would approve the pop-up

112
00:06:07,169 --> 00:06:14,130
on the screen of your phone well this is

113
00:06:11,400 --> 00:06:17,640
Android 5 and I could connect to it and

114
00:06:14,130 --> 00:06:21,870
I didn't get any kind of pop-up so

115
00:06:17,640 --> 00:06:24,530
something was amiss there and if you're

116
00:06:21,870 --> 00:06:27,720
coming from a white pops a white hat

117
00:06:24,530 --> 00:06:30,960
hacker perspective you'd want to hang

118
00:06:27,720 --> 00:06:34,159
yourself with that but for a black hat

119
00:06:30,960 --> 00:06:38,070
that's a lot of sausage to eat you know

120
00:06:34,159 --> 00:06:42,030
it can get you a long time

121
00:06:38,070 --> 00:06:46,230
and while digging around to identify any

122
00:06:42,030 --> 00:06:51,479
more potential targets I found something

123
00:06:46,230 --> 00:06:56,550
that actually frightened me there is a

124
00:06:51,480 --> 00:07:00,510
five-star general somewhere in type in

125
00:06:56,550 --> 00:07:03,360
Taiwan that actually wanted I guess a

126
00:07:00,510 --> 00:07:05,480
smart TV or something like that and he

127
00:07:03,360 --> 00:07:09,090
just plugged it into the internet and

128
00:07:05,480 --> 00:07:10,800
you could actually connect to it and do

129
00:07:09,090 --> 00:07:13,380
a lot of bad stuff over there

130
00:07:10,800 --> 00:07:15,900
unfortunately right now it's down it's

131
00:07:13,380 --> 00:07:19,790
no longer publicly accessible so kudos

132
00:07:15,900 --> 00:07:22,620
to that but this got me an idea

133
00:07:19,790 --> 00:07:24,960
this got me started what if I actually

134
00:07:22,620 --> 00:07:27,180
put all of the work even though there

135
00:07:24,960 --> 00:07:30,989
are no RFC's no documentation whatsoever

136
00:07:27,180 --> 00:07:34,680
and try to sneak in some of my honey

137
00:07:30,990 --> 00:07:36,330
pots and intercept the traffic that

138
00:07:34,680 --> 00:07:39,380
would be coming the attacks that would

139
00:07:36,330 --> 00:07:42,659
be launched sprayed around the internet

140
00:07:39,380 --> 00:07:45,450
so I started digging around I mean there

141
00:07:42,660 --> 00:07:47,550
is no substitution for hard work you

142
00:07:45,450 --> 00:07:51,210
just have to do it and you just have to

143
00:07:47,550 --> 00:07:54,660
hammer it until you get it right and my

144
00:07:51,210 --> 00:07:58,380
target was simple I wanted to be able to

145
00:07:54,660 --> 00:08:03,120
connect to the device I wanted to push a

146
00:07:58,380 --> 00:08:05,670
binary to it and I wanted to launch some

147
00:08:03,120 --> 00:08:10,520
shell commands against my fake device

148
00:08:05,670 --> 00:08:13,550
against my honeypot so I started reading

149
00:08:10,520 --> 00:08:16,590
there is pretty extensive documentation

150
00:08:13,550 --> 00:08:18,660
when it comes to the ADB protocol but

151
00:08:16,590 --> 00:08:21,479
unfortunately it's a bit outdated

152
00:08:18,660 --> 00:08:22,950
remember initially it wasn't designed to

153
00:08:21,480 --> 00:08:26,880
do all of the stuff that's doing

154
00:08:22,950 --> 00:08:29,719
nowadays so somehow a lot of the more

155
00:08:26,880 --> 00:08:32,070
advanced features got bolted on and

156
00:08:29,720 --> 00:08:36,110
don't worry I'm going to open-source all

157
00:08:32,070 --> 00:08:36,110
of this so it's okay

158
00:08:36,860 --> 00:08:41,460
fortunately the communities jumped in

159
00:08:39,720 --> 00:08:43,229
and they started doing their own

160
00:08:41,460 --> 00:08:45,560
research they started doing their own

161
00:08:43,229 --> 00:08:48,210
reverse engineering of the protocol

162
00:08:45,560 --> 00:08:50,699
trying to understand how it works trying

163
00:08:48,210 --> 00:08:56,010
to see where other guys have failed

164
00:08:50,700 --> 00:08:58,470
and somehow the knowledge was there but

165
00:08:56,010 --> 00:09:03,360
it still needed some processing in order

166
00:08:58,470 --> 00:09:05,970
to get something out of it you can find

167
00:09:03,360 --> 00:09:09,930
some really smart guys who have already

168
00:09:05,970 --> 00:09:14,250
written these awesome wrappers for an

169
00:09:09,930 --> 00:09:17,370
ADB packet although a bit incomplete it

170
00:09:14,250 --> 00:09:21,260
just makes everything work so this is

171
00:09:17,370 --> 00:09:24,450
the structure if you have a command to

172
00:09:21,260 --> 00:09:27,990
arguments the data the length of the

173
00:09:24,450 --> 00:09:30,690
data that you're gonna send CRC and some

174
00:09:27,990 --> 00:09:34,040
magic and the commands are on that

175
00:09:30,690 --> 00:09:38,060
complex it's just I think connect

176
00:09:34,040 --> 00:09:41,400
authenticate open okay close right like

177
00:09:38,060 --> 00:09:44,130
pretty simple stuff right and whenever

178
00:09:41,400 --> 00:09:48,060
you for example if you want to do an ADB

179
00:09:44,130 --> 00:09:49,860
shell on that device everything that is

180
00:09:48,060 --> 00:09:53,040
happening that you're gonna see in a

181
00:09:49,860 --> 00:09:55,170
traffic capture is this part this is

182
00:09:53,040 --> 00:09:57,599
happening between the ADB client and

183
00:09:55,170 --> 00:09:59,400
server that are running locally and this

184
00:09:57,600 --> 00:10:02,120
is going to the phone so you've

185
00:09:59,400 --> 00:10:04,439
basically got an open command and

186
00:10:02,120 --> 00:10:06,600
response to that and then you've got a

187
00:10:04,440 --> 00:10:09,140
write with all of the response and all

188
00:10:06,600 --> 00:10:11,970
of the contents of the list command

189
00:10:09,140 --> 00:10:14,430
unfortunately this was also obsolete so

190
00:10:11,970 --> 00:10:19,110
it still needed a bit more digging and

191
00:10:14,430 --> 00:10:20,670
what I found out is that the CRC is in

192
00:10:19,110 --> 00:10:23,810
something standard that you would find

193
00:10:20,670 --> 00:10:26,640
it's some kind of stuff they implemented

194
00:10:23,810 --> 00:10:30,569
nobody explained why you would have this

195
00:10:26,640 --> 00:10:33,270
magic put there if any of you knows

196
00:10:30,570 --> 00:10:38,400
contact me as I said I'm really new in

197
00:10:33,270 --> 00:10:40,740
the industry so right now the best way

198
00:10:38,400 --> 00:10:44,579
that I can explain stuff like that is

199
00:10:40,740 --> 00:10:47,670
just aliens that's it no more no less

200
00:10:44,580 --> 00:10:50,030
it's just black magic to me but that

201
00:10:47,670 --> 00:10:52,709
didn't stop me from getting it working

202
00:10:50,030 --> 00:10:55,829
because what I did I replaced all of the

203
00:10:52,710 --> 00:10:59,940
knowledge with just hard work I did

204
00:10:55,830 --> 00:11:02,730
three traffic captures for

205
00:10:59,940 --> 00:11:08,760
three instances when I would be sending

206
00:11:02,730 --> 00:11:10,770
a list command to that device and the

207
00:11:08,760 --> 00:11:15,660
same command in this specific example

208
00:11:10,770 --> 00:11:18,210
and based on the network connectivity

209
00:11:15,660 --> 00:11:21,569
that I was experiencing at that time I

210
00:11:18,210 --> 00:11:25,080
would get different responses so what I

211
00:11:21,570 --> 00:11:28,890
did I just took a pen and a piece of

212
00:11:25,080 --> 00:11:32,280
paper starting writing down the order in

213
00:11:28,890 --> 00:11:36,230
which the packets would get sent and I

214
00:11:32,280 --> 00:11:43,230
would try to emulate all of that so I

215
00:11:36,230 --> 00:11:45,420
put them in a nice format with all of

216
00:11:43,230 --> 00:11:51,930
the edge cases that were around there

217
00:11:45,420 --> 00:11:55,680
and as you can see the length of the

218
00:11:51,930 --> 00:11:58,229
communication from for sending a file

219
00:11:55,680 --> 00:12:01,829
can range from just exchanging three

220
00:11:58,230 --> 00:12:05,070
packets to some really really complex

221
00:12:01,830 --> 00:12:09,660
stuff that's going on there because

222
00:12:05,070 --> 00:12:12,230
aliens I don't know why it's just corner

223
00:12:09,660 --> 00:12:15,800
case after corner case after corner case

224
00:12:12,230 --> 00:12:18,990
fortunately I got all of that covered I

225
00:12:15,800 --> 00:12:23,880
had a bit of help from this awesome dude

226
00:12:18,990 --> 00:12:28,560
who gave me all of his work into

227
00:12:23,880 --> 00:12:31,890
implementing a simple ADB client so I

228
00:12:28,560 --> 00:12:34,680
took all of the header and packet

229
00:12:31,890 --> 00:12:40,500
building part and I used it to recreate

230
00:12:34,680 --> 00:12:44,699
a server basically and after a lot of

231
00:12:40,500 --> 00:12:48,210
work of a lot of just endless nights and

232
00:12:44,700 --> 00:12:49,830
fight with my girlfriend I finally made

233
00:12:48,210 --> 00:12:52,320
it it worked

234
00:12:49,830 --> 00:12:56,310
I could send files I could central

235
00:12:52,320 --> 00:12:58,920
commands and most importantly it wasn't

236
00:12:56,310 --> 00:13:02,359
only me who is connecting to my fake

237
00:12:58,920 --> 00:13:06,390
device it was also a lot of bad guys and

238
00:13:02,360 --> 00:13:11,190
we're gonna talk about that first after

239
00:13:06,390 --> 00:13:13,699
I show you this you can connect at any

240
00:13:11,190 --> 00:13:17,689
time to are on my publicly expose

241
00:13:13,699 --> 00:13:21,349
honey pots and test it right now if you

242
00:13:17,689 --> 00:13:25,309
want to say hi just drop your payload

243
00:13:21,350 --> 00:13:30,699
right there we're gonna have a really

244
00:13:25,309 --> 00:13:30,699
cool entourage to hang out with and

245
00:13:30,970 --> 00:13:37,730
let's take a look into all kinds of

246
00:13:34,369 --> 00:13:41,109
worms that started hitting my honey pot

247
00:13:37,730 --> 00:13:43,489
keep in mind this is a residential

248
00:13:41,109 --> 00:13:47,269
naturalist there but a data center IP

249
00:13:43,489 --> 00:13:50,059
that I used to host the honey pot from

250
00:13:47,269 --> 00:13:52,220
which I did most of my analysis so it's

251
00:13:50,059 --> 00:13:54,199
grossly incomplete it doesn't account

252
00:13:52,220 --> 00:13:57,199
for the fact that there are may be

253
00:13:54,199 --> 00:13:59,809
vulnerable devices behind the net of

254
00:13:57,199 --> 00:14:03,769
major telecom providers throughout the

255
00:13:59,809 --> 00:14:05,738
world and I'm gonna talk about that a

256
00:14:03,769 --> 00:14:12,230
bit later

257
00:14:05,739 --> 00:14:16,040
so the first guy that started hitting my

258
00:14:12,230 --> 00:14:20,959
honey pot was somebody who looked like

259
00:14:16,040 --> 00:14:24,879
he would be killing all of the other bad

260
00:14:20,959 --> 00:14:28,969
processes these are all miners miners a

261
00:14:24,879 --> 00:14:31,429
lot of mining going on so he basically

262
00:14:28,970 --> 00:14:35,689
shut down everything so you would have a

263
00:14:31,429 --> 00:14:39,289
clean device right now he also pushed

264
00:14:35,689 --> 00:14:42,349
pushed his own miner after that and

265
00:14:39,289 --> 00:14:49,999
starting mining run up clean device

266
00:14:42,350 --> 00:14:53,089
basically the most proficient actor that

267
00:14:49,999 --> 00:14:56,149
I found and that is still highly active

268
00:14:53,089 --> 00:14:57,980
right now on the Internet is Trinity and

269
00:14:56,149 --> 00:15:00,499
I've actually written a blog post about

270
00:14:57,980 --> 00:15:04,220
this you can go look it up it goes into

271
00:15:00,499 --> 00:15:08,779
great details onto how Trinity works but

272
00:15:04,220 --> 00:15:11,829
what Trinity is it's basically a warm

273
00:15:08,779 --> 00:15:16,999
that first connect your device it checks

274
00:15:11,829 --> 00:15:20,809
if the miner is installed if it's not

275
00:15:16,999 --> 00:15:25,579
installed it pushes the apk to the

276
00:15:20,809 --> 00:15:27,379
device and then it launches it and after

277
00:15:25,579 --> 00:15:30,649
that it also checks if the

278
00:15:27,379 --> 00:15:33,549
were mobile part of the worm of the

279
00:15:30,649 --> 00:15:39,019
malware is present as well which is

280
00:15:33,549 --> 00:15:41,419
Trinity the Trinity process this one so

281
00:15:39,019 --> 00:15:46,399
after doing a bit of binary analysis

282
00:15:41,419 --> 00:15:51,109
I discovered that Trinity was actually

283
00:15:46,399 --> 00:15:54,919
scanning all of the internet and pushing

284
00:15:51,109 --> 00:15:59,179
itself and the mining binary to any

285
00:15:54,919 --> 00:16:02,179
target that it found to have this five

286
00:15:59,179 --> 00:16:06,319
five five five port open and it was

287
00:16:02,179 --> 00:16:09,829
mining through a webview that was

288
00:16:06,319 --> 00:16:13,509
loading a simple HTML file that had a

289
00:16:09,829 --> 00:16:16,998
coin hive script just like all times and

290
00:16:13,509 --> 00:16:20,919
inside the binary you could see how it

291
00:16:16,999 --> 00:16:24,799
was trying to create a random IP and

292
00:16:20,919 --> 00:16:32,439
send all of the commands that I've shown

293
00:16:24,799 --> 00:16:35,869
you earlier to the vulnerable device but

294
00:16:32,439 --> 00:16:38,719
looking back at the first guy he was

295
00:16:35,869 --> 00:16:42,109
actually shutting down around seven

296
00:16:38,720 --> 00:16:44,679
other act other actors so I thought man

297
00:16:42,109 --> 00:16:49,189
there must be a lot more and there was

298
00:16:44,679 --> 00:16:52,488
meat F bought a blockchain malware

299
00:16:49,189 --> 00:16:56,179
because blockchain is the buzzword right

300
00:16:52,489 --> 00:16:59,659
now even in the malware community

301
00:16:56,179 --> 00:17:05,599
the guys are 360 did a really cool job

302
00:16:59,659 --> 00:17:08,179
in analyzing it and it didn't do

303
00:17:05,599 --> 00:17:10,779
anything malicious per se it was only

304
00:17:08,179 --> 00:17:15,470
mining so I guess it was like a

305
00:17:10,779 --> 00:17:17,449
victimless crime if you think that your

306
00:17:15,470 --> 00:17:21,649
phone blowing up doesn't make any

307
00:17:17,449 --> 00:17:24,370
victims and the really cool journalist

308
00:17:21,648 --> 00:17:28,029
cattle in Japan wrote a piece about

309
00:17:24,369 --> 00:17:32,268
Trinity and F BOTS actually fighting

310
00:17:28,029 --> 00:17:34,250
over the ownership of these devices keep

311
00:17:32,269 --> 00:17:36,769
in mind that when I initially started

312
00:17:34,250 --> 00:17:39,650
doing the research the Royals were about

313
00:17:36,769 --> 00:17:42,950
seventy thousand devices or so

314
00:17:39,650 --> 00:17:48,200
and at the end the number dropped about

315
00:17:42,950 --> 00:17:52,370
ten thousand so kind of their fair share

316
00:17:48,200 --> 00:17:55,070
of the whole pie shrunk as the share of

317
00:17:52,370 --> 00:17:56,810
the pie shrank down they would be more

318
00:17:55,070 --> 00:18:02,929
and more desperate to shut themselves

319
00:17:56,810 --> 00:18:05,990
down especially when you look at more

320
00:18:02,930 --> 00:18:09,020
and more guys that were trying to push

321
00:18:05,990 --> 00:18:12,380
their own malware on those devices so

322
00:18:09,020 --> 00:18:17,650
this work I was trying to bypass any

323
00:18:12,380 --> 00:18:21,590
firewall by just doing some encoding of

324
00:18:17,650 --> 00:18:26,000
the payload and you can see it here but

325
00:18:21,590 --> 00:18:29,060
right here it's basically launching what

326
00:18:26,000 --> 00:18:33,350
all of this which is the first stage

327
00:18:29,060 --> 00:18:35,690
downloader that would drop another

328
00:18:33,350 --> 00:18:43,250
binary that would start mining on your

329
00:18:35,690 --> 00:18:47,060
own device I might say that the variety

330
00:18:43,250 --> 00:18:49,430
when it came to building malware and

331
00:18:47,060 --> 00:18:52,520
naming malware and targets that that

332
00:18:49,430 --> 00:18:54,950
malware was targeting was quite diverse

333
00:18:52,520 --> 00:19:01,129
for example we had something called

334
00:18:54,950 --> 00:19:05,980
Putin's helper no not this guy which was

335
00:19:01,130 --> 00:19:08,990
targeting DVR devices so at some point

336
00:19:05,980 --> 00:19:11,840
somebody discovered all that a lot of

337
00:19:08,990 --> 00:19:14,750
DVRs had a port open and were basically

338
00:19:11,840 --> 00:19:18,620
running Android so he had this great

339
00:19:14,750 --> 00:19:21,260
idea of making money and mining of them

340
00:19:18,620 --> 00:19:23,860
and the devices are still out in the

341
00:19:21,260 --> 00:19:27,530
open left exposed and vulnerable

342
00:19:23,860 --> 00:19:34,370
thanks to the great fragmentation of IOT

343
00:19:27,530 --> 00:19:37,970
so what can we do one of the funniest

344
00:19:34,370 --> 00:19:42,830
guy that I found was the apologetic

345
00:19:37,970 --> 00:19:45,440
miner he said he's sorry but his mining

346
00:19:42,830 --> 00:19:48,020
on my device not because he was but

347
00:19:45,440 --> 00:19:50,450
because he needed the cash he's truly

348
00:19:48,020 --> 00:19:53,220
sorry but currently he can find any job

349
00:19:50,450 --> 00:19:56,640
so he has to resort to his black

350
00:19:53,220 --> 00:20:02,370
had way in order to survive he won left

351
00:19:56,640 --> 00:20:06,960
his email here so you can drop him an

352
00:20:02,370 --> 00:20:09,299
email and he send you his CV back he

353
00:20:06,960 --> 00:20:11,070
even promised to whitelist the device if

354
00:20:09,299 --> 00:20:14,220
you send the email and he will stop

355
00:20:11,070 --> 00:20:18,510
attacking you because you are worthy in

356
00:20:14,220 --> 00:20:20,789
his view but instead of actually

357
00:20:18,510 --> 00:20:23,158
targeting them down and asking them hey

358
00:20:20,789 --> 00:20:26,549
guy can you please stop mining on my

359
00:20:23,159 --> 00:20:29,460
device I actually decided to open-source

360
00:20:26,549 --> 00:20:33,240
my honey pot and engage other

361
00:20:29,460 --> 00:20:37,230
researchers because to be honest being

362
00:20:33,240 --> 00:20:40,440
so young in the industry the community

363
00:20:37,230 --> 00:20:43,919
has given me a lot so I decided to give

364
00:20:40,440 --> 00:20:46,559
back and shortly after the number of

365
00:20:43,919 --> 00:20:50,580
vulnerable devices dropped by 75% at

366
00:20:46,559 --> 00:20:52,918
least mainly because people were

367
00:20:50,580 --> 00:20:54,870
actually running that and actually

368
00:20:52,919 --> 00:20:56,700
submitting abuse reports to the

369
00:20:54,870 --> 00:20:59,010
authorities and I found that

370
00:20:56,700 --> 00:21:01,679
exhilarating I mean they were using my

371
00:20:59,010 --> 00:21:05,908
product that was based on some other

372
00:21:01,679 --> 00:21:07,860
guys research and journal is made in a

373
00:21:05,909 --> 00:21:10,380
completely different country to shut

374
00:21:07,860 --> 00:21:17,219
down malware from all around the world

375
00:21:10,380 --> 00:21:21,590
and if we look at it a bit more we can

376
00:21:17,220 --> 00:21:24,510
see that the number of IPS has dropped

377
00:21:21,590 --> 00:21:26,309
but I don't know if you guys know

378
00:21:24,510 --> 00:21:29,720
statistics but when a graph is like this

379
00:21:26,309 --> 00:21:33,629
that's not good especially in this case

380
00:21:29,720 --> 00:21:38,070
so what happened here so I decided to

381
00:21:33,630 --> 00:21:41,539
dig a ball around a bit more and I found

382
00:21:38,070 --> 00:21:46,939
two anomalies can you spot the first one

383
00:21:41,539 --> 00:21:50,840
the first one is here so more IPs and

384
00:21:46,940 --> 00:21:50,840
more binary downloads

385
00:21:51,620 --> 00:21:56,300
and I started with what the hell

386
00:21:53,690 --> 00:21:59,960
happened I mean it was weird the second

387
00:21:56,300 --> 00:22:02,480
one was right here but the number of

388
00:21:59,960 --> 00:22:06,080
binary downloads dropped and the number

389
00:22:02,480 --> 00:22:07,550
of IPs dropped as well and I started

390
00:22:06,080 --> 00:22:09,139
digging around a little bit more because

391
00:22:07,550 --> 00:22:14,649
I couldn't find any conclusive

392
00:22:09,140 --> 00:22:18,860
information from this peak but this guy

393
00:22:14,650 --> 00:22:21,080
was using server to just spray the

394
00:22:18,860 --> 00:22:23,540
internet with connection attempts and

395
00:22:21,080 --> 00:22:25,669
just pushing his binaries to Android

396
00:22:23,540 --> 00:22:31,000
devices one after the other one after

397
00:22:25,670 --> 00:22:37,790
the other trying to get as many of them

398
00:22:31,000 --> 00:22:41,120
into his web unfortunately for him he

399
00:22:37,790 --> 00:22:42,260
got a lot of abuse reports and he just

400
00:22:41,120 --> 00:22:47,719
got shut down

401
00:22:42,260 --> 00:22:54,559
hence the drop in the activity so this

402
00:22:47,720 --> 00:22:57,920
is bad this is good and another really

403
00:22:54,559 --> 00:22:59,899
cool side effect of just releasing very

404
00:22:57,920 --> 00:23:01,880
product is that people have actually

405
00:22:59,900 --> 00:23:03,860
started creating memes this wasn't done

406
00:23:01,880 --> 00:23:05,780
by me this was done by some other guys

407
00:23:03,860 --> 00:23:08,899
on Twitter that actually took the

408
00:23:05,780 --> 00:23:10,850
honeypot and started sending abuse

409
00:23:08,900 --> 00:23:15,160
requests starting doing research on

410
00:23:10,850 --> 00:23:18,969
what's happening and hopefully somebody

411
00:23:15,160 --> 00:23:22,340
who actually works inside the factory

412
00:23:18,970 --> 00:23:25,160
somewhere in China saw my report and

413
00:23:22,340 --> 00:23:28,610
said hey guys maybe we shouldn't build

414
00:23:25,160 --> 00:23:32,179
our firmware with the development port

415
00:23:28,610 --> 00:23:33,800
open from the factory and you know shut

416
00:23:32,179 --> 00:23:42,650
it down after were done with the QA

417
00:23:33,800 --> 00:23:45,590
process I've got a big list of bugs for

418
00:23:42,650 --> 00:23:47,270
my honey pot and that's good because I

419
00:23:45,590 --> 00:23:52,178
did not submit them somebody else did

420
00:23:47,270 --> 00:23:55,400
which meant that this was getting usage

421
00:23:52,179 --> 00:24:00,290
some other dude integrated it into

422
00:23:55,400 --> 00:24:04,450
teapot and now it's being employed as a

423
00:24:00,290 --> 00:24:09,670
DB honeypot solution at some telecom

424
00:24:04,450 --> 00:24:12,580
which is really cool and I don't know

425
00:24:09,670 --> 00:24:17,140
short story short I haven't been doing

426
00:24:12,580 --> 00:24:21,490
this for quite awhile I'm here just to

427
00:24:17,140 --> 00:24:26,050
show you that if you set your mind on to

428
00:24:21,490 --> 00:24:29,170
something and if you work towards it and

429
00:24:26,050 --> 00:24:31,690
share it with the community you're gonna

430
00:24:29,170 --> 00:24:34,570
make the world a better place because in

431
00:24:31,690 --> 00:24:38,920
the end as you can see the number of

432
00:24:34,570 --> 00:24:43,090
attacks dropped and this basically made

433
00:24:38,920 --> 00:24:45,280
the internet a safer place because I was

434
00:24:43,090 --> 00:24:49,629
actually seeing complaints on forums

435
00:24:45,280 --> 00:24:51,820
about people saying that man I just

436
00:24:49,630 --> 00:24:55,440
bought three hundred three thousand

437
00:24:51,820 --> 00:24:57,790
dollar TV and it's not working it's

438
00:24:55,440 --> 00:24:59,860
moving really slow ever since yesterday

439
00:24:57,790 --> 00:25:03,700
and don't know what I can do with it you

440
00:24:59,860 --> 00:25:05,889
won't find any moved any of any more

441
00:25:03,700 --> 00:25:07,990
complaints like that on the internet

442
00:25:05,890 --> 00:25:10,330
anymore because there's awareness about

443
00:25:07,990 --> 00:25:17,410
this there's awareness at the ISP level

444
00:25:10,330 --> 00:25:21,730
and I don't know even if it was really

445
00:25:17,410 --> 00:25:25,570
hard in just building this in the end we

446
00:25:21,730 --> 00:25:29,440
saved some guys from the pain of having

447
00:25:25,570 --> 00:25:36,300
to actually turn the TV so they won't

448
00:25:29,440 --> 00:25:39,880
have any malware but just enjoy it so

449
00:25:36,300 --> 00:25:42,399
thank you and if you have any questions

450
00:25:39,880 --> 00:25:46,470
we still have some time if not I'm gonna

451
00:25:42,400 --> 00:25:46,470
give you back 15 minutes of your time

452
00:25:47,190 --> 00:25:52,339
[Applause]

