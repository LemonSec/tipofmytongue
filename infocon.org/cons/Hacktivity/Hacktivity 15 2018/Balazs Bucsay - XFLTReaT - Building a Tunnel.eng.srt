1
00:00:00,030 --> 00:00:04,740
my name is<font color="#CCCCCC"> balázs butcher</font><font color="#E5E5E5"> and I'm going</font>

2
00:00:02,009 --> 00:00:07,680
to<font color="#E5E5E5"> present</font><font color="#CCCCCC"> you the</font><font color="#E5E5E5"> exfiltrate building a</font>

3
00:00:04,740 --> 00:00:11,759
tunnel<font color="#CCCCCC"> but before I start few words</font>

4
00:00:07,680 --> 00:00:15,210
<font color="#CCCCCC">about me I'm Hungarian</font><font color="#E5E5E5"> hacker</font><font color="#CCCCCC"> some of</font>

5
00:00:11,759 --> 00:00:17,789
you already<font color="#E5E5E5"> know me probably I moved to</font>

6
00:00:15,210 --> 00:00:20,520
the UK two years ago and since<font color="#CCCCCC"> then I'm</font>

7
00:00:17,789 --> 00:00:22,710
working<font color="#E5E5E5"> for NCC group in the last two</font>

8
00:00:20,520 --> 00:00:25,259
<font color="#E5E5E5">years I was promoted twice</font><font color="#CCCCCC"> now</font><font color="#E5E5E5"> I'm and</font>

9
00:00:22,710 --> 00:00:28,410
managing<font color="#E5E5E5"> security consultant</font><font color="#CCCCCC"> I do all</font>

10
00:00:25,260 --> 00:00:31,500
kind of offensive work and some defense

11
00:00:28,410 --> 00:00:33,059
as well but<font color="#E5E5E5"> not much</font><font color="#CCCCCC"> I only have</font>

12
00:00:31,500 --> 00:00:35,760
<font color="#E5E5E5">strictest technical technical</font>

13
00:00:33,059 --> 00:00:38,328
certificates listed on the slide and I

14
00:00:35,760 --> 00:00:42,390
<font color="#E5E5E5">started to do these kind of stuffs in</font>

15
00:00:38,329 --> 00:00:46,800
2000 so<font color="#E5E5E5"> the 2000 when I was 13 years old</font>

16
00:00:42,390 --> 00:00:48,960
<font color="#CCCCCC">I had a few presentations here</font><font color="#E5E5E5"> and this</font>

17
00:00:46,800 --> 00:00:51,000
is a<font color="#CCCCCC"> Jubilee for activity but</font><font color="#E5E5E5"> Jubilee</font>

18
00:00:48,960 --> 00:00:55,230
for me as well<font color="#E5E5E5"> because I had my</font><font color="#CCCCCC"> very</font>

19
00:00:51,000 --> 00:00:58,800
first presentation<font color="#CCCCCC"> in activity</font><font color="#E5E5E5"> so I can</font>

20
00:00:55,230 --> 00:01:02,099
thank<font color="#E5E5E5"> a</font><font color="#CCCCCC"> lot to this conference</font><font color="#E5E5E5"> and you</font>

21
00:00:58,800 --> 00:01:04,018
of course<font color="#E5E5E5"> I had a few major projects in</font>

22
00:01:02,100 --> 00:01:07,770
<font color="#E5E5E5">the past like GI John I presented that</font>

23
00:01:04,019 --> 00:01:10,500
<font color="#CCCCCC">in 2009</font><font color="#E5E5E5"> here on activity then siege</font>

24
00:01:07,770 --> 00:01:13,619
route a few<font color="#CCCCCC"> years years ago three years</font>

25
00:01:10,500 --> 00:01:17,100
ago<font color="#E5E5E5"> again here and now I'm doing this</font>

26
00:01:13,619 --> 00:01:20,130
exfiltration research exfiltrate<font color="#E5E5E5"> that</font>

27
00:01:17,100 --> 00:01:22,890
I'm going<font color="#CCCCCC"> to present if you liked my</font>

28
00:01:20,130 --> 00:01:25,949
presentation or the tool please follow

29
00:01:22,890 --> 00:01:29,400
me on twitter my<font color="#E5E5E5"> twitter handler is X or</font>

30
00:01:25,950 --> 00:01:31,560
<font color="#E5E5E5">e IP e IP and my LinkedIn profile is</font>

31
00:01:29,400 --> 00:01:34,110
there as<font color="#E5E5E5"> well on the</font><font color="#CCCCCC"> bottom so you can</font>

32
00:01:31,560 --> 00:01:37,100
find me easily<font color="#CCCCCC"> I was quite lucky</font><font color="#E5E5E5"> with</font>

33
00:01:34,110 --> 00:01:40,619
this<font color="#E5E5E5"> with this research</font><font color="#CCCCCC"> I managed to</font>

34
00:01:37,100 --> 00:01:43,199
travel<font color="#E5E5E5"> around the</font><font color="#CCCCCC"> world I went to Hawaii</font>

35
00:01:40,619 --> 00:01:46,079
<font color="#CCCCCC">to the</font><font color="#E5E5E5"> Chaka Khan rocks come to</font>

36
00:01:43,200 --> 00:01:48,750
Australia Singapore<font color="#E5E5E5"> to hacking into both</font>

37
00:01:46,079 --> 00:01:52,979
G<font color="#E5E5E5"> SEC and a few other conferences in</font>

38
00:01:48,750 --> 00:01:58,710
torrent Europe<font color="#E5E5E5"> in London deep second in</font>

39
00:01:52,979 --> 00:02:01,469
Vienna<font color="#E5E5E5"> and brew</font><font color="#CCCCCC"> Conan</font><font color="#E5E5E5"> in Brooklyn and</font>

40
00:01:58,710 --> 00:02:04,350
<font color="#CCCCCC">Gantt yeah</font><font color="#E5E5E5"> Belgium and of course now I'm</font>

41
00:02:01,469 --> 00:02:05,939
here the<font color="#E5E5E5"> the topic</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> always changing a</font>

42
00:02:04,350 --> 00:02:09,269
little<font color="#CCCCCC"> bit so you will</font><font color="#E5E5E5"> get some new</font>

43
00:02:05,939 --> 00:02:10,109
content<font color="#E5E5E5"> as well the presentation</font><font color="#CCCCCC"> and the</font>

44
00:02:09,270 --> 00:02:11,849
tool<font color="#E5E5E5"> is called</font>

45
00:02:10,110 --> 00:02:12,900
exfiltrate<font color="#E5E5E5"> but it's not really about</font>

46
00:02:11,849 --> 00:02:14,159
<font color="#CCCCCC">exfiltration</font>

47
00:02:12,900 --> 00:02:16,829
you can use<font color="#E5E5E5"> the tool for exfiltration</font>

48
00:02:14,159 --> 00:02:20,399
but the main purpose<font color="#E5E5E5"> is building</font><font color="#CCCCCC"> these</font>

49
00:02:16,829 --> 00:02:22,530
<font color="#CCCCCC">two building tunnels</font><font color="#E5E5E5"> so this is how it</font>

50
00:02:20,400 --> 00:02:24,120
looks like<font color="#E5E5E5"> when</font><font color="#CCCCCC"> you connect to</font><font color="#E5E5E5"> the</font>

51
00:02:22,530 --> 00:02:26,069
internet<font color="#E5E5E5"> on the left hand side you</font><font color="#CCCCCC"> have</font>

52
00:02:24,120 --> 00:02:28,439
your<font color="#E5E5E5"> computer which is</font><font color="#CCCCCC"> connected to a</font>

53
00:02:26,069 --> 00:02:33,060
modem<font color="#E5E5E5"> or a router and</font><font color="#CCCCCC"> that is</font><font color="#E5E5E5"> connected</font>

54
00:02:28,439 --> 00:02:35,250
to the 2d<font color="#E5E5E5"> internet</font><font color="#CCCCCC"> right build</font><font color="#E5E5E5"> early and</font>

55
00:02:33,060 --> 00:02:37,230
you have two<font color="#CCCCCC"> different servers at this</font>

56
00:02:35,250 --> 00:02:39,780
time you<font color="#CCCCCC"> are going to use the bottom</font><font color="#E5E5E5"> one</font>

57
00:02:37,230 --> 00:02:41,159
on<font color="#E5E5E5"> the right which has all your cat</font>

58
00:02:39,780 --> 00:02:44,879
videos because<font color="#E5E5E5"> you really</font><font color="#CCCCCC"> like those</font>

59
00:02:41,159 --> 00:02:46,319
<font color="#CCCCCC">kind of stuff</font><font color="#E5E5E5"> and whenever you want</font><font color="#CCCCCC"> to</font>

60
00:02:44,879 --> 00:02:49,018
watch those<font color="#CCCCCC"> videos</font><font color="#E5E5E5"> you need to connect</font>

61
00:02:46,319 --> 00:02:51,958
<font color="#E5E5E5">to</font><font color="#CCCCCC"> the server</font><font color="#E5E5E5"> and when you do that</font><font color="#CCCCCC"> we go</font>

62
00:02:49,019 --> 00:02:53,849
through<font color="#CCCCCC"> your modem</font><font color="#E5E5E5"> or</font><font color="#CCCCCC"> Gateway</font><font color="#E5E5E5"> through</font>

63
00:02:51,959 --> 00:02:55,139
different routers through different<font color="#E5E5E5"> hops</font>

64
00:02:53,849 --> 00:02:58,530
on the<font color="#CCCCCC"> Internet</font>

65
00:02:55,139 --> 00:03:01,230
but whenever you are using a VPN<font color="#CCCCCC"> or a</font>

66
00:02:58,530 --> 00:03:02,970
tunnel<font color="#E5E5E5"> your route will</font><font color="#CCCCCC"> be a</font><font color="#E5E5E5"> little bit</font>

67
00:03:01,230 --> 00:03:05,040
<font color="#E5E5E5">different you have</font><font color="#CCCCCC"> your other</font><font color="#E5E5E5"> server</font>

68
00:03:02,970 --> 00:03:08,189
where<font color="#E5E5E5"> you installed your Open VPN</font>

69
00:03:05,040 --> 00:03:10,560
service<font color="#E5E5E5"> or Cisco and it connects VPN</font>

70
00:03:08,189 --> 00:03:13,049
server whatever<font color="#E5E5E5"> so you connect to</font><font color="#CCCCCC"> that</font>

71
00:03:10,560 --> 00:03:15,480
<font color="#E5E5E5">server first and then whenever use</font>

72
00:03:13,049 --> 00:03:19,829
<font color="#E5E5E5">whatever you send it will go through</font>

73
00:03:15,480 --> 00:03:22,590
that route and at the end it will<font color="#CCCCCC"> be</font>

74
00:03:19,829 --> 00:03:24,870
redirected to the original server<font color="#E5E5E5"> so the</font>

75
00:03:22,590 --> 00:03:28,409
original<font color="#E5E5E5"> server which stores your cat</font>

76
00:03:24,870 --> 00:03:30,629
videos<font color="#E5E5E5"> will only see your not your IP</font>

77
00:03:28,409 --> 00:03:32,250
<font color="#E5E5E5">address but the VPN servers IP address</font>

78
00:03:30,629 --> 00:03:37,220
<font color="#E5E5E5">so this is basically tunneling this is</font>

79
00:03:32,250 --> 00:03:40,040
how the BPM works<font color="#E5E5E5"> in usual cases yeah</font>

80
00:03:37,220 --> 00:03:42,359
why would you use a VPN<font color="#E5E5E5"> or a tunnel</font>

81
00:03:40,040 --> 00:03:46,228
<font color="#E5E5E5">maybe because you want to hide your IP</font>

82
00:03:42,359 --> 00:03:48,090
address<font color="#E5E5E5"> because you are a journalist who</font>

83
00:03:46,229 --> 00:03:50,819
wants to stay anonymous<font color="#CCCCCC"> or you do</font>

84
00:03:48,090 --> 00:03:53,729
BitTorrent Inc<font color="#E5E5E5"> or you</font><font color="#CCCCCC"> just want to use</font>

85
00:03:50,819 --> 00:03:57,149
VPS<font color="#CCCCCC"> because you want</font><font color="#E5E5E5"> to access the the</font>

86
00:03:53,729 --> 00:03:59,790
<font color="#E5E5E5">internal</font><font color="#CCCCCC"> resources of</font><font color="#E5E5E5"> of your of</font><font color="#CCCCCC"> your</font>

87
00:03:57,150 --> 00:04:02,940
company<font color="#E5E5E5"> so like you want to print or</font><font color="#CCCCCC"> the</font>

88
00:03:59,790 --> 00:04:04,679
<font color="#CCCCCC">XS</font><font color="#E5E5E5"> 5 shares and so on but of course</font>

89
00:04:02,940 --> 00:04:07,500
there<font color="#E5E5E5"> are different</font><font color="#CCCCCC"> reasons</font><font color="#E5E5E5"> for example</font>

90
00:04:04,680 --> 00:04:10,229
<font color="#CCCCCC">you want to bypass</font><font color="#E5E5E5"> captive portals</font><font color="#CCCCCC"> or</font>

91
00:04:07,500 --> 00:04:13,040
you want to bypass<font color="#CCCCCC"> Brock's corporate</font>

92
00:04:10,229 --> 00:04:15,180
proxy policies that can<font color="#E5E5E5"> be done</font>

93
00:04:13,040 --> 00:04:17,579
<font color="#CCCCCC">unfortunate we don't have too much time</font>

94
00:04:15,180 --> 00:04:20,849
so I will<font color="#CCCCCC"> kind</font><font color="#E5E5E5"> of skip this but if you</font>

95
00:04:17,579 --> 00:04:23,710
wanted<font color="#CCCCCC"> to use TCP</font><font color="#E5E5E5"> for tunneling you had</font>

96
00:04:20,849 --> 00:04:25,539
to use Open VPN or<font color="#E5E5E5"> Cisco</font><font color="#CCCCCC"> anyconnect</font><font color="#E5E5E5"> if</font>

97
00:04:23,710 --> 00:04:28,870
you<font color="#E5E5E5"> have to use if you wanted to use UDP</font>

98
00:04:25,539 --> 00:04:32,159
<font color="#E5E5E5">again</font><font color="#CCCCCC"> open</font><font color="#E5E5E5"> BPM for HTTP connect</font>

99
00:04:28,870 --> 00:04:35,259
supporting proxies<font color="#E5E5E5"> there is a support</font>

100
00:04:32,160 --> 00:04:39,669
<font color="#CCCCCC">there is there is support for</font><font color="#E5E5E5"> in Open</font>

101
00:04:35,259 --> 00:04:44,319
VPN<font color="#E5E5E5"> or you could use proxy fire for ICMP</font>

102
00:04:39,669 --> 00:04:48,400
<font color="#E5E5E5">as ICMP TX or ping tunnel these are one</font>

103
00:04:44,319 --> 00:04:50,860
<font color="#CCCCCC">of the one of the domani and for DNS</font>

104
00:04:48,400 --> 00:04:52,750
<font color="#CCCCCC">there is one obvious</font><font color="#E5E5E5"> one which is a</font>

105
00:04:50,860 --> 00:04:56,949
pretty<font color="#E5E5E5"> good choice which is iodine</font>

106
00:04:52,750 --> 00:04:59,370
<font color="#E5E5E5">that's that's really good so a little</font>

107
00:04:56,949 --> 00:05:02,800
bit different topic<font color="#CCCCCC"> and I went to Africa</font>

108
00:04:59,370 --> 00:05:05,949
<font color="#E5E5E5">from Italy it took two days and I was in</font>

109
00:05:02,800 --> 00:05:10,240
a ferry and I had no access<font color="#E5E5E5"> to the</font>

110
00:05:05,949 --> 00:05:12,639
<font color="#CCCCCC">Internet</font><font color="#E5E5E5"> because I was cheap and there</font>

111
00:05:10,240 --> 00:05:15,070
was no<font color="#E5E5E5"> signal on my phone but there was</font>

112
00:05:12,639 --> 00:05:16,870
an open<font color="#E5E5E5"> Wi-Fi on the ferry so I started</font>

113
00:05:15,070 --> 00:05:19,509
to poke around<font color="#E5E5E5"> and real and real I</font>

114
00:05:16,870 --> 00:05:22,180
realized I either pay very<font color="#E5E5E5"> very</font>

115
00:05:19,509 --> 00:05:25,270
expensive money money to get some

116
00:05:22,180 --> 00:05:27,580
internet or I do something<font color="#CCCCCC"> else and I</font>

117
00:05:25,270 --> 00:05:31,000
figured<font color="#E5E5E5"> out</font><font color="#CCCCCC"> that the port 443 which</font><font color="#E5E5E5"> is</font>

118
00:05:27,580 --> 00:05:33,430
usually<font color="#E5E5E5"> HTTPS was on filters so if I</font>

119
00:05:31,000 --> 00:05:36,280
have set up<font color="#E5E5E5"> an Open VPN service on my</font>

120
00:05:33,430 --> 00:05:38,050
server<font color="#E5E5E5"> beforehand I could have used the</font>

121
00:05:36,280 --> 00:05:40,750
<font color="#CCCCCC">internet for free for two days and I</font>

122
00:05:38,050 --> 00:05:43,030
don't<font color="#E5E5E5"> get bored but</font><font color="#CCCCCC"> I didn't do that</font>

123
00:05:40,750 --> 00:05:46,180
<font color="#CCCCCC">because I forgot to set up I didn't know</font>

124
00:05:43,030 --> 00:05:48,849
in<font color="#E5E5E5"> advance then next time I was flying</font>

125
00:05:46,180 --> 00:05:50,919
to<font color="#E5E5E5"> Japan and on the on the on the</font>

126
00:05:48,849 --> 00:05:53,349
airplane<font color="#E5E5E5"> there was Wi-Fi again and I</font>

127
00:05:50,919 --> 00:05:55,659
figured out the ICMP so pinging stuff

128
00:05:53,349 --> 00:05:58,810
<font color="#E5E5E5">pinging</font><font color="#CCCCCC"> host</font><font color="#E5E5E5"> on the internet was working</font>

129
00:05:55,659 --> 00:06:01,210
so I could have used the<font color="#CCCCCC"> internet for</font>

130
00:05:58,810 --> 00:06:04,030
free if I have set<font color="#CCCCCC"> up my tool but I</font>

131
00:06:01,210 --> 00:06:05,919
didn't do that<font color="#CCCCCC"> so shame on</font><font color="#E5E5E5"> me</font><font color="#CCCCCC"> and this</font>

132
00:06:04,030 --> 00:06:08,229
<font color="#E5E5E5">is coming back to me every</font><font color="#CCCCCC"> time</font><font color="#E5E5E5"> when I</font>

133
00:06:05,919 --> 00:06:12,280
go<font color="#CCCCCC"> to an airport the DNS tunneling</font>

134
00:06:08,229 --> 00:06:15,340
<font color="#CCCCCC">Burke's not on Heathrow though</font><font color="#E5E5E5"> so that</font>

135
00:06:12,280 --> 00:06:18,159
whenever I connect<font color="#E5E5E5"> it to my Diaz tunnel</font>

136
00:06:15,340 --> 00:06:21,340
<font color="#E5E5E5">it crashed so it didn't work</font><font color="#CCCCCC"> what did I</font>

137
00:06:18,159 --> 00:06:23,409
seen in at the end so as many<font color="#E5E5E5"> protocols</font>

138
00:06:21,340 --> 00:06:25,330
as many things that you<font color="#E5E5E5"> have that many</font>

139
00:06:23,409 --> 00:06:28,900
solutions have you have on the<font color="#CCCCCC"> internet</font>

140
00:06:25,330 --> 00:06:31,979
or there is no solution<font color="#CCCCCC"> for it the the</font>

141
00:06:28,900 --> 00:06:34,750
the<font color="#CCCCCC"> tools that</font><font color="#E5E5E5"> there are out are</font>

142
00:06:31,979 --> 00:06:37,310
unsupported<font color="#CCCCCC"> end-of-life or proof of</font>

143
00:06:34,750 --> 00:06:39,140
concepts only<font color="#E5E5E5"> so if you have a problem</font>

144
00:06:37,310 --> 00:06:41,600
nobody will care about it it<font color="#CCCCCC"> won't be</font>

145
00:06:39,140 --> 00:06:43,370
fixed<font color="#CCCCCC"> the</font><font color="#E5E5E5"> configuration is always</font>

146
00:06:41,600 --> 00:06:46,250
different<font color="#CCCCCC"> so you need</font><font color="#E5E5E5"> to learn all the</font>

147
00:06:43,370 --> 00:06:47,720
tools how<font color="#E5E5E5"> to configure it how to to set</font>

148
00:06:46,250 --> 00:06:49,640
up and you need<font color="#CCCCCC"> to set up different</font>

149
00:06:47,720 --> 00:06:52,300
<font color="#E5E5E5">tools on the same box if you want to use</font>

150
00:06:49,640 --> 00:06:54,680
these in<font color="#CCCCCC"> the same time</font><font color="#E5E5E5"> no modality</font>

151
00:06:52,300 --> 00:06:56,240
portability issues and of course<font color="#E5E5E5"> the</font>

152
00:06:54,680 --> 00:06:58,600
implementations are using different

153
00:06:56,240 --> 00:07:03,860
<font color="#E5E5E5">really</font><font color="#CCCCCC"> different languages like Perl</font>

154
00:06:58,600 --> 00:07:05,750
Ruby Python<font color="#E5E5E5"> C Java whatever so you can't</font>

155
00:07:03,860 --> 00:07:06,830
know everything<font color="#E5E5E5"> right so it was really</font>

156
00:07:05,750 --> 00:07:09,980
<font color="#E5E5E5">hard to do</font>

157
00:07:06,830 --> 00:07:12,380
<font color="#E5E5E5">tunneling before but I I</font><font color="#CCCCCC"> think I managed</font>

158
00:07:09,980 --> 00:07:14,180
to<font color="#E5E5E5"> change</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> but I really like to</font>

159
00:07:12,380 --> 00:07:16,159
<font color="#E5E5E5">think that so that's why I created</font>

160
00:07:14,180 --> 00:07:18,350
exfiltrate<font color="#E5E5E5"> which is a tunneling</font>

161
00:07:16,160 --> 00:07:21,200
framework<font color="#E5E5E5"> so that this is how the</font><font color="#CCCCCC"> Beast</font>

162
00:07:18,350 --> 00:07:22,670
was born<font color="#CCCCCC"> now before I go into the</font>

163
00:07:21,200 --> 00:07:25,280
<font color="#CCCCCC">details you need to understand what's</font>

164
00:07:22,670 --> 00:07:26,720
<font color="#E5E5E5">tunneling early so basically let's say</font>

165
00:07:25,280 --> 00:07:29,659
you have a<font color="#CCCCCC"> network where everything is</font>

166
00:07:26,720 --> 00:07:31,940
<font color="#CCCCCC">filtered except one</font><font color="#E5E5E5"> thing which is ICMP</font>

167
00:07:29,660 --> 00:07:33,890
so you can ping stuff on the<font color="#CCCCCC"> internet</font>

168
00:07:31,940 --> 00:07:36,980
because<font color="#E5E5E5"> that's unfiltered but any other</font>

169
00:07:33,890 --> 00:07:40,430
stuff like TCP<font color="#E5E5E5"> UDP will be filtered</font><font color="#CCCCCC"> by</font>

170
00:07:36,980 --> 00:07:44,600
<font color="#CCCCCC">the firewall so what you can do you can</font>

171
00:07:40,430 --> 00:07:47,000
basically set<font color="#CCCCCC"> up an ICMP tunnel</font><font color="#E5E5E5"> on the</font>

172
00:07:44,600 --> 00:07:49,670
server on the client and<font color="#E5E5E5"> you can capture</font>

173
00:07:47,000 --> 00:07:52,760
all all the all the<font color="#E5E5E5"> pockets on the</font>

174
00:07:49,670 --> 00:07:55,910
<font color="#E5E5E5">client</font><font color="#CCCCCC"> side and encapsulate it into an</font>

175
00:07:52,760 --> 00:07:58,070
ICMP into a pink pocket so on the green

176
00:07:55,910 --> 00:07:59,900
the green<font color="#E5E5E5"> one on the on the top</font>

177
00:07:58,070 --> 00:08:02,000
<font color="#CCCCCC">left-hand side</font><font color="#E5E5E5"> that's the origin pocket</font>

178
00:07:59,900 --> 00:08:03,710
you grab that<font color="#E5E5E5"> you</font><font color="#CCCCCC"> encapsulated</font><font color="#E5E5E5"> in the</font>

179
00:08:02,000 --> 00:08:06,350
other kind<font color="#E5E5E5"> of pocket which is</font><font color="#CCCCCC"> unfiltered</font>

180
00:08:03,710 --> 00:08:08,359
on the network<font color="#E5E5E5"> you transfer transmit</font>

181
00:08:06,350 --> 00:08:10,760
over<font color="#E5E5E5"> to the server which</font><font color="#CCCCCC"> wirdy</font>

182
00:08:08,360 --> 00:08:12,830
capsulated<font color="#E5E5E5"> and get the same original</font>

183
00:08:10,760 --> 00:08:14,570
<font color="#E5E5E5">pocket that you want it to sell and</font><font color="#CCCCCC"> this</font>

184
00:08:12,830 --> 00:08:16,520
<font color="#E5E5E5">via forwarded to the</font><font color="#CCCCCC"> earlier to</font><font color="#E5E5E5"> the</font>

185
00:08:14,570 --> 00:08:18,800
destination that<font color="#CCCCCC"> you</font><font color="#E5E5E5"> wanted and whenever</font>

186
00:08:16,520 --> 00:08:21,289
you do the same in backwards<font color="#E5E5E5"> that's how</font>

187
00:08:18,800 --> 00:08:23,600
you communicate back and forth<font color="#E5E5E5"> so what's</font>

188
00:08:21,290 --> 00:08:25,340
<font color="#E5E5E5">what's exfiltrate you know what's</font>

189
00:08:23,600 --> 00:08:27,620
tunneling so this is a tunneling

190
00:08:25,340 --> 00:08:31,130
framework it's open source<font color="#E5E5E5"> is Python 2.7</font>

191
00:08:27,620 --> 00:08:32,600
<font color="#E5E5E5">based</font><font color="#CCCCCC"> object-oriented modular multi</font>

192
00:08:31,130 --> 00:08:34,340
client and there is a<font color="#E5E5E5"> check</font>

193
00:08:32,600 --> 00:08:37,610
functionality as well<font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> going to tell</font>

194
00:08:34,340 --> 00:08:40,850
you about these<font color="#E5E5E5"> it's pretty easy to use</font>

195
00:08:37,610 --> 00:08:43,640
I<font color="#E5E5E5"> believe the feedbacks are not showing</font>

196
00:08:40,850 --> 00:08:45,290
<font color="#E5E5E5">that's in every time but I'm working on</font>

197
00:08:43,640 --> 00:08:47,540
that<font color="#E5E5E5"> or it would be nice</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> have your</font>

198
00:08:45,290 --> 00:08:49,930
feedback<font color="#E5E5E5"> as well so</font><font color="#CCCCCC"> basically you need</font>

199
00:08:47,540 --> 00:08:52,750
<font color="#CCCCCC">to go and get</font><font color="#E5E5E5"> hub or clone it</font>

200
00:08:49,930 --> 00:08:55,599
install it the installed requirements

201
00:08:52,750 --> 00:08:58,120
<font color="#E5E5E5">with</font><font color="#CCCCCC"> pip</font><font color="#E5E5E5"> it's really basic edit the</font>

202
00:08:55,600 --> 00:09:00,130
configuration and run it<font color="#E5E5E5"> that's it you</font>

203
00:08:58,120 --> 00:09:02,260
do the<font color="#CCCCCC"> same on the server side and you</font>

204
00:09:00,130 --> 00:09:04,439
have a<font color="#E5E5E5"> tunnel that would be the theory</font>

205
00:09:02,260 --> 00:09:06,730
<font color="#E5E5E5">and behind all the transportation</font>

206
00:09:04,440 --> 00:09:08,589
<font color="#CCCCCC">encryption and authentication stuff our</font>

207
00:09:06,730 --> 00:09:10,630
modular so whenever there is a new

208
00:09:08,589 --> 00:09:12,370
release<font color="#CCCCCC"> you just copy the files</font><font color="#E5E5E5"> into</font>

209
00:09:10,630 --> 00:09:14,800
their corresponding<font color="#E5E5E5"> directory and that's</font>

210
00:09:12,370 --> 00:09:17,770
it<font color="#E5E5E5"> you had a</font><font color="#CCCCCC"> D configuration again</font><font color="#E5E5E5"> again</font>

211
00:09:14,800 --> 00:09:19,750
<font color="#E5E5E5">and run it so why is it framework please</font>

212
00:09:17,770 --> 00:09:21,699
raise your<font color="#E5E5E5"> hand if you have tried</font><font color="#CCCCCC"> to do</font>

213
00:09:19,750 --> 00:09:24,880
tunneling you created<font color="#CCCCCC"> your own</font><font color="#E5E5E5"> tool or</font>

214
00:09:21,700 --> 00:09:27,550
<font color="#E5E5E5">whatever</font><font color="#CCCCCC"> okay some people so you know</font>

215
00:09:24,880 --> 00:09:30,400
<font color="#E5E5E5">that it's a pain because if you want to</font>

216
00:09:27,550 --> 00:09:33,670
do tunneling you should be able to do

217
00:09:30,400 --> 00:09:35,529
<font color="#E5E5E5">only one thing to know how to put your</font>

218
00:09:33,670 --> 00:09:37,479
<font color="#E5E5E5">pockets</font><font color="#CCCCCC"> into another</font><font color="#E5E5E5"> kind of pocket</font><font color="#CCCCCC"> on</font>

219
00:09:35,529 --> 00:09:39,339
how you get your data from that pocket

220
00:09:37,480 --> 00:09:42,730
<font color="#E5E5E5">but that wasn't the case you had to set</font>

221
00:09:39,339 --> 00:09:47,050
up<font color="#E5E5E5"> the interfaces IP address on that</font>

222
00:09:42,730 --> 00:09:48,850
<font color="#E5E5E5">interface routing as well if you wanted</font>

223
00:09:47,050 --> 00:09:52,029
to handle multiple<font color="#CCCCCC"> clients then you had</font>

224
00:09:48,850 --> 00:09:54,010
to code<font color="#E5E5E5"> that then there</font><font color="#CCCCCC"> is there is</font>

225
00:09:52,029 --> 00:09:57,160
encryption authentication you might need

226
00:09:54,010 --> 00:09:59,500
<font color="#E5E5E5">that</font><font color="#CCCCCC"> so if you create your own tunnel</font>

227
00:09:57,160 --> 00:10:01,390
<font color="#E5E5E5">you had to take care about these which</font>

228
00:09:59,500 --> 00:10:02,800
are<font color="#E5E5E5"> really unknowing but now because</font>

229
00:10:01,390 --> 00:10:05,380
it's a framework<font color="#E5E5E5"> you don't have to do</font>

230
00:10:02,800 --> 00:10:07,329
that it's all<font color="#E5E5E5"> taken care of by the</font>

231
00:10:05,380 --> 00:10:10,600
framework<font color="#CCCCCC"> you only have to do</font><font color="#E5E5E5"> two things</font>

232
00:10:07,330 --> 00:10:14,560
<font color="#CCCCCC">one really figure out how you put your</font>

233
00:10:10,600 --> 00:10:15,970
<font color="#E5E5E5">data into the into the</font><font color="#CCCCCC"> pockets so how</font>

234
00:10:14,560 --> 00:10:17,829
you encapsulate<font color="#E5E5E5"> your data and how</font><font color="#CCCCCC"> you</font>

235
00:10:15,970 --> 00:10:19,900
<font color="#CCCCCC">decaf slate your data</font><font color="#E5E5E5"> from that pocket</font>

236
00:10:17,830 --> 00:10:21,910
that's that's the<font color="#CCCCCC"> only thing that you</font>

237
00:10:19,900 --> 00:10:24,010
need<font color="#CCCCCC"> to know when you</font><font color="#E5E5E5"> are developing</font>

238
00:10:21,910 --> 00:10:25,569
<font color="#E5E5E5">developing for the</font><font color="#CCCCCC"> framework</font><font color="#E5E5E5"> and of</font>

239
00:10:24,010 --> 00:10:27,220
course if you are<font color="#E5E5E5"> implementing a new</font>

240
00:10:25,570 --> 00:10:28,420
kind<font color="#E5E5E5"> of protocol and</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> need to</font>

241
00:10:27,220 --> 00:10:31,660
implement<font color="#CCCCCC"> big</font><font color="#E5E5E5"> protocol</font>

242
00:10:28,420 --> 00:10:33,219
related things<font color="#E5E5E5"> but nothing else the</font>

243
00:10:31,660 --> 00:10:36,520
<font color="#E5E5E5">check function</font><font color="#CCCCCC"> it is really</font><font color="#E5E5E5"> handy when</font>

244
00:10:33,220 --> 00:10:38,260
<font color="#CCCCCC">you connect to a new network and you</font>

245
00:10:36,520 --> 00:10:40,449
need to figure<font color="#E5E5E5"> out what kind of</font>

246
00:10:38,260 --> 00:10:42,520
protocols what kind of stuff you<font color="#E5E5E5"> can</font><font color="#CCCCCC"> use</font>

247
00:10:40,450 --> 00:10:44,770
to break out<font color="#CCCCCC"> from that network</font><font color="#E5E5E5"> you have</font>

248
00:10:42,520 --> 00:10:46,870
<font color="#E5E5E5">your server</font><font color="#CCCCCC"> set up configured on the</font>

249
00:10:44,770 --> 00:10:48,339
internet and on the network very

250
00:10:46,870 --> 00:10:50,440
<font color="#E5E5E5">connected and you don't know that that's</font>

251
00:10:48,339 --> 00:10:54,000
work you<font color="#E5E5E5"> just execute the check</font>

252
00:10:50,440 --> 00:10:56,740
functionality<font color="#E5E5E5"> and with all the enabled</font>

253
00:10:54,000 --> 00:10:58,300
functions it<font color="#CCCCCC"> will generate a pocket with</font>

254
00:10:56,740 --> 00:10:59,139
the challenge it will send<font color="#E5E5E5"> it to</font><font color="#CCCCCC"> the</font>

255
00:10:58,300 --> 00:11:02,498
server

256
00:10:59,139 --> 00:11:04,629
and if the server answers that you know

257
00:11:02,499 --> 00:11:07,149
<font color="#E5E5E5">that you can</font><font color="#CCCCCC"> communicate</font><font color="#E5E5E5"> with the server</font>

258
00:11:04,629 --> 00:11:08,859
<font color="#CCCCCC">over</font><font color="#E5E5E5"> that channel so this challenge is</font>

259
00:11:07,149 --> 00:11:10,869
not cryptographically<font color="#E5E5E5"> keep the</font>

260
00:11:08,859 --> 00:11:13,089
graphically<font color="#E5E5E5"> secure nothing like that</font>

261
00:11:10,869 --> 00:11:14,859
you just functionally<font color="#E5E5E5"> it's just a</font>

262
00:11:13,089 --> 00:11:17,439
functional stuff so it's like<font color="#E5E5E5"> sending</font>

263
00:11:14,859 --> 00:11:19,569
two numbers and the the server needs to

264
00:11:17,439 --> 00:11:21,998
sum up and send<font color="#E5E5E5"> it back</font><font color="#CCCCCC"> and when</font><font color="#E5E5E5"> you</font>

265
00:11:19,569 --> 00:11:24,399
know the<font color="#E5E5E5"> disarm that you got back is the</font>

266
00:11:21,999 --> 00:11:25,989
same<font color="#E5E5E5"> as you calculate it you know there</font>

267
00:11:24,399 --> 00:11:27,579
is an<font color="#CCCCCC"> exfiltrate</font><font color="#E5E5E5"> server you can</font>

268
00:11:25,989 --> 00:11:29,609
communicate<font color="#CCCCCC"> with the server because</font><font color="#E5E5E5"> it</font>

269
00:11:27,579 --> 00:11:31,839
answered and so on

270
00:11:29,609 --> 00:11:34,689
this is the multi operating system

271
00:11:31,839 --> 00:11:36,939
support matrix<font color="#CCCCCC"> as you can see not be as</font>

272
00:11:34,689 --> 00:11:39,368
the<font color="#CCCCCC"> FreeBSD OpenBSD is not supported at</font>

273
00:11:36,939 --> 00:11:41,259
<font color="#CCCCCC">the moment</font><font color="#E5E5E5"> probably</font><font color="#CCCCCC"> it should be really</font>

274
00:11:39,369 --> 00:11:46,179
<font color="#E5E5E5">easily supported</font><font color="#CCCCCC"> because you just</font><font color="#E5E5E5"> need</font>

275
00:11:41,259 --> 00:11:48,309
to change a<font color="#E5E5E5"> few things about routing and</font>

276
00:11:46,179 --> 00:11:51,129
interfaces<font color="#E5E5E5"> but that's that's nothing</font>

277
00:11:48,309 --> 00:11:54,509
<font color="#E5E5E5">special or D all</font><font color="#CCCCCC"> the other modules</font>

278
00:11:51,129 --> 00:11:56,769
<font color="#CCCCCC">should</font><font color="#E5E5E5"> work like</font><font color="#CCCCCC"> instantly</font>

279
00:11:54,509 --> 00:12:00,489
Linux<font color="#E5E5E5"> is the main operating system that</font>

280
00:11:56,769 --> 00:12:02,259
<font color="#E5E5E5">I support we support as you can see</font>

281
00:12:00,489 --> 00:12:04,329
almost<font color="#E5E5E5"> everything is supported on Linux</font>

282
00:12:02,259 --> 00:12:07,269
<font color="#E5E5E5">and the the windows support was</font>

283
00:12:04,329 --> 00:12:09,160
introduced a half year ago<font color="#CCCCCC"> and the best</font>

284
00:12:07,269 --> 00:12:11,290
thing about<font color="#E5E5E5"> that there is</font><font color="#CCCCCC"> RDP that</font><font color="#E5E5E5"> I'm</font>

285
00:12:09,160 --> 00:12:13,779
going to<font color="#E5E5E5"> show you and tell you about the</font>

286
00:12:11,290 --> 00:12:15,129
DNS is proof of concept<font color="#E5E5E5"> because of</font>

287
00:12:13,779 --> 00:12:17,350
different<font color="#E5E5E5"> reasons I don't really have</font>

288
00:12:15,129 --> 00:12:22,059
time<font color="#CCCCCC"> to finish</font><font color="#E5E5E5"> at the moment it's quite</font>

289
00:12:17,350 --> 00:12:24,819
quite hard to do<font color="#CCCCCC"> tunneling over DNS it's</font>

290
00:12:22,059 --> 00:12:28,379
quite hard to do reliable and fast

291
00:12:24,819 --> 00:12:31,118
tunneling<font color="#E5E5E5"> over DNS so that's the thing</font>

292
00:12:28,379 --> 00:12:35,169
<font color="#CCCCCC">ease of development</font><font color="#E5E5E5"> because</font><font color="#CCCCCC"> it's</font>

293
00:12:31,119 --> 00:12:39,540
<font color="#CCCCCC">object-oriented</font><font color="#E5E5E5"> every module inherits</font>

294
00:12:35,169 --> 00:12:42,299
its<font color="#E5E5E5"> parents module methods and and</font>

295
00:12:39,540 --> 00:12:45,129
variables<font color="#E5E5E5"> there is a generic generic</font>

296
00:12:42,299 --> 00:12:48,369
module on the top<font color="#E5E5E5"> it has</font><font color="#CCCCCC"> all the methods</font>

297
00:12:45,129 --> 00:12:52,209
<font color="#CCCCCC">and</font><font color="#E5E5E5"> properties that</font><font color="#CCCCCC"> are used all over</font>

298
00:12:48,369 --> 00:12:54,309
<font color="#CCCCCC">the other</font><font color="#E5E5E5"> other modules right and there</font>

299
00:12:52,209 --> 00:12:58,719
is<font color="#CCCCCC"> a split stateful and stateless</font>

300
00:12:54,309 --> 00:13:01,449
modules the stateful like<font color="#E5E5E5"> TCP HTTP those</font>

301
00:12:58,720 --> 00:13:04,029
are stateful protocols<font color="#CCCCCC"> so you have a</font>

302
00:13:01,449 --> 00:13:06,219
full dedicated connection<font color="#E5E5E5"> a session</font>

303
00:13:04,029 --> 00:13:08,439
<font color="#CCCCCC">between the two sides that you can</font>

304
00:13:06,220 --> 00:13:12,339
<font color="#E5E5E5">correct so if there is</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> pocket you know</font>

305
00:13:08,439 --> 00:13:12,930
that that that<font color="#E5E5E5"> basically related to that</font>

306
00:13:12,339 --> 00:13:14,970
<font color="#CCCCCC">session</font>

307
00:13:12,930 --> 00:13:17,969
when we<font color="#E5E5E5"> are talking</font><font color="#CCCCCC"> about stateless</font>

308
00:13:14,970 --> 00:13:20,459
protocol UDP icmp<font color="#CCCCCC"> it's really hard to</font>

309
00:13:17,970 --> 00:13:23,220
tell<font color="#E5E5E5"> it can be done but there is a spit</font>

310
00:13:20,459 --> 00:13:26,099
that's how I implemented it<font color="#E5E5E5"> and for</font>

311
00:13:23,220 --> 00:13:28,139
<font color="#E5E5E5">example if you want to do HTTP connect</font>

312
00:13:26,100 --> 00:13:31,740
<font color="#E5E5E5">if you want to create your own HTTP</font>

313
00:13:28,139 --> 00:13:34,769
connect module<font color="#E5E5E5"> you just inherit up all</font>

314
00:13:31,740 --> 00:13:36,540
the stuff from the<font color="#E5E5E5"> TCP module so you</font>

315
00:13:34,769 --> 00:13:38,879
don't need<font color="#E5E5E5"> to care</font><font color="#CCCCCC"> about many things but</font>

316
00:13:36,540 --> 00:13:42,629
<font color="#CCCCCC">because</font><font color="#E5E5E5"> we</font><font color="#CCCCCC"> are</font><font color="#E5E5E5"> talking about HTTP</font>

317
00:13:38,879 --> 00:13:45,749
<font color="#E5E5E5">connects you need to craft a HTTP</font>

318
00:13:42,629 --> 00:13:48,119
request and the response<font color="#E5E5E5"> and from that</font>

319
00:13:45,749 --> 00:13:50,730
point<font color="#E5E5E5"> everything is done by handled by</font>

320
00:13:48,119 --> 00:13:54,119
the<font color="#CCCCCC"> TCP module so that that's quite easy</font>

321
00:13:50,730 --> 00:13:55,319
<font color="#CCCCCC">to do it's like</font><font color="#E5E5E5"> half an hour</font><font color="#CCCCCC"> work but</font>

322
00:13:54,119 --> 00:13:57,259
it's<font color="#E5E5E5"> already done so</font><font color="#CCCCCC"> you don't</font><font color="#E5E5E5"> have to</font>

323
00:13:55,319 --> 00:14:00,240
do<font color="#CCCCCC"> it but maybe it's</font><font color="#E5E5E5"> something else</font>

324
00:13:57,259 --> 00:14:02,550
<font color="#E5E5E5">whenever you do whatever you connect to</font>

325
00:14:00,240 --> 00:14:05,610
<font color="#CCCCCC">your VPN or not whenever but most of</font><font color="#E5E5E5"> the</font>

326
00:14:02,550 --> 00:14:07,170
<font color="#CCCCCC">cases it's it creates a full tunnel</font><font color="#E5E5E5"> so</font>

327
00:14:05,610 --> 00:14:08,819
everything that<font color="#E5E5E5"> you</font><font color="#CCCCCC"> are</font><font color="#E5E5E5"> sending out of</font>

328
00:14:07,170 --> 00:14:11,610
your<font color="#E5E5E5"> network will be tunneled into that</font>

329
00:14:08,819 --> 00:14:13,559
<font color="#E5E5E5">channel</font><font color="#CCCCCC"> and will be sent</font><font color="#E5E5E5"> to the internet</font>

330
00:14:11,610 --> 00:14:16,470
<font color="#E5E5E5">over that channel but</font><font color="#CCCCCC"> whenever you are</font>

331
00:14:13,559 --> 00:14:19,410
doing<font color="#E5E5E5"> split tunneling you can specify</font>

332
00:14:16,470 --> 00:14:21,870
<font color="#E5E5E5">for example with this tool you can</font>

333
00:14:19,410 --> 00:14:25,490
<font color="#E5E5E5">specify in the scope</font><font color="#CCCCCC"> dot txt file what</font>

334
00:14:21,870 --> 00:14:28,259
kind of<font color="#CCCCCC"> IPS and IP ranges should be</font>

335
00:14:25,490 --> 00:14:30,600
treated as split<font color="#E5E5E5"> tunnel so everything</font>

336
00:14:28,259 --> 00:14:32,730
<font color="#CCCCCC">that you are</font><font color="#E5E5E5"> sending to</font><font color="#CCCCCC"> those IDs will</font>

337
00:14:30,600 --> 00:14:35,129
be sent over the network<font color="#E5E5E5"> or over</font><font color="#CCCCCC"> the</font>

338
00:14:32,730 --> 00:14:36,839
tunnel<font color="#CCCCCC"> but nothing else that</font><font color="#E5E5E5"> comes</font>

339
00:14:35,129 --> 00:14:41,009
<font color="#E5E5E5">really handy when you do penetration</font>

340
00:14:36,839 --> 00:14:42,720
testing<font color="#CCCCCC"> I'm going to show</font><font color="#E5E5E5"> you why so the</font>

341
00:14:41,009 --> 00:14:46,259
<font color="#E5E5E5">windows support in exfiltrate was</font>

342
00:14:42,720 --> 00:14:47,759
introduced like<font color="#E5E5E5"> half a</font><font color="#CCCCCC"> year ago if you</font>

343
00:14:46,259 --> 00:14:50,279
want to use it on<font color="#CCCCCC"> Windows</font><font color="#E5E5E5"> you need to</font>

344
00:14:47,759 --> 00:14:52,920
install<font color="#E5E5E5"> the Open VPN</font><font color="#CCCCCC"> tab driver because</font>

345
00:14:50,279 --> 00:14:56,100
there is no tab driver at all in the

346
00:14:52,920 --> 00:14:59,248
windows in<font color="#CCCCCC"> Windows</font><font color="#E5E5E5"> by default obviously</font>

347
00:14:56,100 --> 00:15:03,029
you need to<font color="#E5E5E5"> install Python 2.7</font><font color="#CCCCCC"> the</font>

348
00:14:59,249 --> 00:15:06,179
requirements like<font color="#E5E5E5"> py VIN 32 which is</font>

349
00:15:03,029 --> 00:15:09,839
<font color="#CCCCCC">needed to to access the api's of the</font>

350
00:15:06,179 --> 00:15:12,089
windows subsystem<font color="#E5E5E5"> and if you want to do</font>

351
00:15:09,839 --> 00:15:14,160
a Windows<font color="#CCCCCC"> server from exfiltrate you</font>

352
00:15:12,089 --> 00:15:16,110
need to<font color="#CCCCCC"> setup the routing net and you</font>

353
00:15:14,160 --> 00:15:17,610
need to start<font color="#CCCCCC"> that service if you want</font>

354
00:15:16,110 --> 00:15:20,699
to uninstall<font color="#E5E5E5"> it you just do it backwards</font>

355
00:15:17,610 --> 00:15:23,089
<font color="#CCCCCC">so</font><font color="#E5E5E5"> it's really easy</font><font color="#CCCCCC"> a little bit</font>

356
00:15:20,699 --> 00:15:26,120
different topic here<font color="#CCCCCC"> Remote Desktop</font>

357
00:15:23,089 --> 00:15:28,819
<font color="#CCCCCC">dynamic</font><font color="#E5E5E5"> virtual channels so whenever you</font>

358
00:15:26,120 --> 00:15:30,439
connect to your<font color="#CCCCCC"> vo to a desk whenever</font>

359
00:15:28,819 --> 00:15:34,790
you connect your remote desktop or

360
00:15:30,439 --> 00:15:39,230
Terminal Services<font color="#E5E5E5"> service so basically</font>

361
00:15:34,790 --> 00:15:41,509
you use<font color="#E5E5E5"> that on</font><font color="#CCCCCC"> Windows right you can do</font>

362
00:15:39,230 --> 00:15:43,129
<font color="#CCCCCC">copy/paste ink right and when you</font>

363
00:15:41,509 --> 00:15:45,740
connect from<font color="#CCCCCC"> the</font><font color="#E5E5E5"> client</font><font color="#CCCCCC"> to the server</font>

364
00:15:43,129 --> 00:15:47,839
<font color="#CCCCCC">you</font><font color="#E5E5E5"> copy a file between the two cloud</font>

365
00:15:45,740 --> 00:15:48,610
<font color="#E5E5E5">between the copy</font><font color="#CCCCCC"> of the client and the</font>

366
00:15:47,839 --> 00:15:51,499
server

367
00:15:48,610 --> 00:15:54,139
there is a<font color="#CCCCCC"> virtual</font><font color="#E5E5E5"> channel created in</font>

368
00:15:51,499 --> 00:15:56,749
the RDP session and that is used to

369
00:15:54,139 --> 00:15:59,779
<font color="#E5E5E5">transfer</font><font color="#CCCCCC"> the file</font><font color="#E5E5E5"> so it's not it's not</font>

370
00:15:56,749 --> 00:16:01,759
<font color="#E5E5E5">doing any new connection</font><font color="#CCCCCC"> besides the</font>

371
00:15:59,779 --> 00:16:04,249
besides<font color="#E5E5E5"> the RDP connection that you</font>

372
00:16:01,759 --> 00:16:08,809
already<font color="#E5E5E5"> have it's basically using</font><font color="#CCCCCC"> that</font>

373
00:16:04,249 --> 00:16:11,809
connection<font color="#E5E5E5"> to to send data in in</font><font color="#CCCCCC"> that so</font>

374
00:16:08,809 --> 00:16:15,079
<font color="#E5E5E5">it's really handy because from 2008</font>

375
00:16:11,809 --> 00:16:17,420
Server 2008<font color="#CCCCCC"> and Vista sp1 this</font>

376
00:16:15,079 --> 00:16:19,579
<font color="#E5E5E5">functionality was published the API was</font>

377
00:16:17,420 --> 00:16:22,790
published to developers so you can

378
00:16:19,579 --> 00:16:26,269
create<font color="#E5E5E5"> your own modules you can create</font>

379
00:16:22,790 --> 00:16:28,309
your own<font color="#E5E5E5"> DLL and with that you can</font>

380
00:16:26,269 --> 00:16:30,230
<font color="#CCCCCC">create</font><font color="#E5E5E5"> your own dynamic</font><font color="#CCCCCC"> view to</font><font color="#E5E5E5"> our</font>

381
00:16:28,309 --> 00:16:32,389
channels between<font color="#E5E5E5"> the two sides between</font>

382
00:16:30,230 --> 00:16:34,279
<font color="#CCCCCC">the client side and the server side so</font>

383
00:16:32,389 --> 00:16:38,120
<font color="#E5E5E5">that can be used for many</font><font color="#CCCCCC"> things for</font>

384
00:16:34,279 --> 00:16:41,360
<font color="#E5E5E5">example tunneling as well</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> that</font>

385
00:16:38,120 --> 00:16:43,550
<font color="#E5E5E5">reason not part of the exfiltrate</font><font color="#CCCCCC"> but</font>

386
00:16:41,360 --> 00:16:46,339
part as a different project I created

387
00:16:43,550 --> 00:16:47,959
<font color="#CCCCCC">this tool which is a using</font><font color="#E5E5E5"> universal</font>

388
00:16:46,339 --> 00:16:50,689
dynamic<font color="#CCCCCC"> wheel to a channel connector</font>

389
00:16:47,959 --> 00:16:52,878
which<font color="#CCCCCC"> is a bit mouthful but anyways on</font>

390
00:16:50,689 --> 00:16:55,129
you can find<font color="#CCCCCC"> it on github it's really</font>

391
00:16:52,879 --> 00:16:57,230
<font color="#E5E5E5">useful for Marvel writers for example or</font>

392
00:16:55,129 --> 00:17:00,019
<font color="#E5E5E5">for those who</font><font color="#CCCCCC"> want to</font><font color="#E5E5E5"> do penetration</font>

393
00:16:57,230 --> 00:17:02,449
testing or tunneling<font color="#E5E5E5"> it has two parts</font>

394
00:17:00,019 --> 00:17:04,579
there is one<font color="#CCCCCC"> dll</font><font color="#E5E5E5"> that you need to</font>

395
00:17:02,449 --> 00:17:08,329
register<font color="#E5E5E5"> on your client computer on your</font>

396
00:17:04,579 --> 00:17:10,398
computer in Windows<font color="#E5E5E5"> and then you can set</font>

397
00:17:08,329 --> 00:17:11,750
<font color="#E5E5E5">it did you can</font><font color="#CCCCCC"> change the settings</font><font color="#E5E5E5"> from</font>

398
00:17:10,398 --> 00:17:13,789
registry I'm going to show<font color="#E5E5E5"> you that</font>

399
00:17:11,750 --> 00:17:14,179
after<font color="#CCCCCC"> that when you connect to the</font>

400
00:17:13,789 --> 00:17:16,669
<font color="#CCCCCC">server</font>

401
00:17:14,179 --> 00:17:18,559
<font color="#E5E5E5">there will be a</font><font color="#CCCCCC"> pop-up</font><font color="#E5E5E5"> like that which</font>

402
00:17:16,669 --> 00:17:20,990
will tell you this is<font color="#E5E5E5"> enabled and</font><font color="#CCCCCC"> you</font>

403
00:17:18,559 --> 00:17:23,928
need to care<font color="#CCCCCC"> about</font><font color="#E5E5E5"> those</font><font color="#CCCCCC"> things on the</font>

404
00:17:20,990 --> 00:17:26,929
server you<font color="#E5E5E5"> need to copy an</font><font color="#CCCCCC"> ACCI and the</font>

405
00:17:23,929 --> 00:17:28,610
<font color="#CCCCCC">AXI has three different yeah and with</font>

406
00:17:26,929 --> 00:17:32,210
the<font color="#CCCCCC"> EXCI you can</font><font color="#E5E5E5"> make this connection</font>

407
00:17:28,610 --> 00:17:33,918
<font color="#E5E5E5">over the RDP session</font><font color="#CCCCCC"> the this tool</font>

408
00:17:32,210 --> 00:17:36,260
supports three modes on both sides

409
00:17:33,919 --> 00:17:38,669
listen connect and name pipes you will

410
00:17:36,260 --> 00:17:42,669
<font color="#E5E5E5">going</font><font color="#CCCCCC"> to see what what are those</font>

411
00:17:38,669 --> 00:17:45,190
so this is basically a use case<font color="#E5E5E5"> for this</font>

412
00:17:42,669 --> 00:17:48,039
and<font color="#E5E5E5"> just</font><font color="#CCCCCC"> to understand what</font><font color="#E5E5E5"> I'm</font><font color="#CCCCCC"> talking</font>

413
00:17:45,190 --> 00:17:50,529
about<font color="#CCCCCC"> when you</font><font color="#E5E5E5"> use you are when you are</font>

414
00:17:48,039 --> 00:17:52,210
<font color="#CCCCCC">using open</font><font color="#E5E5E5"> as a sage or SSH you can do</font>

415
00:17:50,529 --> 00:17:54,700
port forwarding when you connect<font color="#E5E5E5"> to your</font>

416
00:17:52,210 --> 00:17:57,250
<font color="#E5E5E5">server that functionality was missing</font>

417
00:17:54,700 --> 00:18:00,100
from the RDP still missing<font color="#E5E5E5"> but with</font>

418
00:17:57,250 --> 00:18:02,440
these<font color="#E5E5E5"> the dynamic</font><font color="#CCCCCC"> here to our channels</font>

419
00:18:00,100 --> 00:18:07,299
you can<font color="#CCCCCC"> do the same functionality</font><font color="#E5E5E5"> so you</font>

420
00:18:02,440 --> 00:18:10,059
<font color="#E5E5E5">can open up a channel inside SSH or RDP</font>

421
00:18:07,299 --> 00:18:15,250
and you can do port forward or send<font color="#E5E5E5"> any</font>

422
00:18:10,059 --> 00:18:19,000
kind<font color="#E5E5E5"> of data on this slide let's let's</font>

423
00:18:15,250 --> 00:18:20,770
say you have a PCI<font color="#CCCCCC"> zone PCI</font><font color="#E5E5E5"> zone always</font>

424
00:18:19,000 --> 00:18:24,100
needs to be<font color="#CCCCCC"> segregated from the network</font>

425
00:18:20,770 --> 00:18:26,020
<font color="#E5E5E5">and there should be only one access</font>

426
00:18:24,100 --> 00:18:28,899
<font color="#CCCCCC">points where you can log in</font><font color="#E5E5E5"> so usually</font>

427
00:18:26,020 --> 00:18:31,149
in big companies that access point<font color="#CCCCCC"> that</font>

428
00:18:28,899 --> 00:18:33,520
at one<font color="#CCCCCC"> point is the jump box jump</font><font color="#E5E5E5"> box is</font>

429
00:18:31,149 --> 00:18:36,580
<font color="#E5E5E5">usually or either Windows or Linux box</font>

430
00:18:33,520 --> 00:18:39,158
right if it's Windows the<font color="#CCCCCC"> Remote Desktop</font>

431
00:18:36,580 --> 00:18:41,949
<font color="#E5E5E5">is used and usually it's fully</font><font color="#CCCCCC"> fireboard</font>

432
00:18:39,159 --> 00:18:44,830
so there is all only one<font color="#E5E5E5"> port that</font><font color="#CCCCCC"> is</font>

433
00:18:41,950 --> 00:18:47,230
accessible<font color="#E5E5E5"> and that's the drdp the</font>

434
00:18:44,830 --> 00:18:50,439
<font color="#CCCCCC">remote desktop port which is</font><font color="#E5E5E5"> three three</font>

435
00:18:47,230 --> 00:18:52,360
<font color="#E5E5E5">eight</font><font color="#CCCCCC"> nine</font><font color="#E5E5E5"> so you can't really connect</font>

436
00:18:50,440 --> 00:18:54,370
<font color="#E5E5E5">out you can't really connect to any</font>

437
00:18:52,360 --> 00:18:55,779
other ports because<font color="#E5E5E5"> it's firewood</font><font color="#CCCCCC"> and on</font>

438
00:18:54,370 --> 00:18:57,969
the right hand<font color="#CCCCCC"> side</font><font color="#E5E5E5"> we have three</font>

439
00:18:55,779 --> 00:19:00,850
segregated servers let's say in the<font color="#E5E5E5"> PCI</font>

440
00:18:57,970 --> 00:19:02,770
<font color="#CCCCCC">Zone and we figured out</font><font color="#E5E5E5"> on the first one</font>

441
00:19:00,850 --> 00:19:06,610
on segregated one<font color="#E5E5E5"> there is a web server</font>

442
00:19:02,770 --> 00:19:10,000
which is listening on port 80<font color="#E5E5E5"> right so</font>

443
00:19:06,610 --> 00:19:13,689
on the<font color="#E5E5E5"> DLL on the client side we we set</font>

444
00:19:10,000 --> 00:19:16,750
up the<font color="#CCCCCC"> the configuration as we set that</font>

445
00:19:13,690 --> 00:19:19,929
<font color="#E5E5E5">up in listen mode so it will be it will</font>

446
00:19:16,750 --> 00:19:21,760
<font color="#CCCCCC">listen on on all interfaces on the</font><font color="#E5E5E5"> elite</font>

447
00:19:19,929 --> 00:19:25,240
sport as you can see on the left<font color="#E5E5E5"> hand</font>

448
00:19:21,760 --> 00:19:29,230
side and on<font color="#CCCCCC"> the right hand</font><font color="#E5E5E5"> side we set</font>

449
00:19:25,240 --> 00:19:32,020
<font color="#E5E5E5">the</font><font color="#CCCCCC"> XE we execute the XE in</font><font color="#E5E5E5"> connect mode</font>

450
00:19:29,230 --> 00:19:35,080
and it<font color="#E5E5E5"> will connect</font><font color="#CCCCCC"> to the segregated</font>

451
00:19:32,020 --> 00:19:38,139
<font color="#CCCCCC">one computer and port 80</font><font color="#E5E5E5"> and whenever</font>

452
00:19:35,080 --> 00:19:41,559
you<font color="#CCCCCC"> open up your browser on</font><font color="#E5E5E5"> your client</font>

453
00:19:38,140 --> 00:19:44,830
computer and the type localhost<font color="#E5E5E5"> elite</font>

454
00:19:41,559 --> 00:19:47,230
port<font color="#CCCCCC"> all the data will be forwarded to</font>

455
00:19:44,830 --> 00:19:50,119
the segregated<font color="#E5E5E5"> one over the jump box</font>

456
00:19:47,230 --> 00:19:52,219
<font color="#E5E5E5">over RDP and the data is</font>

457
00:19:50,119 --> 00:19:54,399
coming back<font color="#E5E5E5"> on</font><font color="#CCCCCC"> the same roots</font><font color="#E5E5E5"> backwards</font>

458
00:19:52,219 --> 00:19:57,739
<font color="#E5E5E5">so that's that's how</font><font color="#CCCCCC"> it works</font>

459
00:19:54,399 --> 00:19:59,839
there is another mode<font color="#CCCCCC"> actually there is</font>

460
00:19:57,739 --> 00:20:01,789
another<font color="#E5E5E5"> use case that you can use for</font>

461
00:19:59,839 --> 00:20:05,539
<font color="#CCCCCC">example on the</font><font color="#E5E5E5"> segregated</font><font color="#CCCCCC"> two books you</font>

462
00:20:01,789 --> 00:20:07,669
<font color="#E5E5E5">found a box</font><font color="#CCCCCC"> of passwords XLS file so you</font>

463
00:20:05,539 --> 00:20:09,379
want to exfiltrate that you want to grab

464
00:20:07,669 --> 00:20:11,599
that<font color="#E5E5E5"> file but you can't really do that</font>

465
00:20:09,379 --> 00:20:14,359
<font color="#E5E5E5">any other ways just</font><font color="#CCCCCC"> if you are using</font>

466
00:20:11,599 --> 00:20:17,029
this tool for<font color="#CCCCCC"> example so</font><font color="#E5E5E5"> you set up both</font>

467
00:20:14,359 --> 00:20:19,218
sides in listen mode<font color="#CCCCCC"> you go to your</font>

468
00:20:17,029 --> 00:20:23,509
hacking<font color="#E5E5E5"> box on the left hand side you</font>

469
00:20:19,219 --> 00:20:25,159
connect to the client box<font color="#CCCCCC"> and you you</font>

470
00:20:23,509 --> 00:20:27,649
wait for the content of<font color="#E5E5E5"> the file</font><font color="#CCCCCC"> that</font>

471
00:20:25,159 --> 00:20:30,049
<font color="#E5E5E5">will be written</font><font color="#CCCCCC"> into password</font><font color="#E5E5E5"> dot XLS on</font>

472
00:20:27,649 --> 00:20:32,839
your computer on the<font color="#CCCCCC"> right</font><font color="#E5E5E5"> hand side</font>

473
00:20:30,049 --> 00:20:35,089
<font color="#CCCCCC">after</font><font color="#E5E5E5"> that you connect to</font><font color="#CCCCCC"> the server now</font>

474
00:20:32,839 --> 00:20:37,188
you connect to the jump box from the

475
00:20:35,089 --> 00:20:39,769
<font color="#E5E5E5">segregated server</font><font color="#CCCCCC"> and you put all the</font>

476
00:20:37,189 --> 00:20:43,819
<font color="#E5E5E5">file content into that socket</font><font color="#CCCCCC"> so it will</font>

477
00:20:39,769 --> 00:20:45,979
be sent over<font color="#E5E5E5"> TCP from the segregated</font><font color="#CCCCCC"> two</font>

478
00:20:43,819 --> 00:20:49,609
box to the jump<font color="#E5E5E5"> box then from there</font>

479
00:20:45,979 --> 00:20:53,379
<font color="#E5E5E5">overall RDP through the dynamic virtual</font>

480
00:20:49,609 --> 00:20:56,478
<font color="#E5E5E5">channel 2d to the RDP client and again</font>

481
00:20:53,379 --> 00:20:58,698
<font color="#E5E5E5">TCP between the RDP client and the</font>

482
00:20:56,479 --> 00:21:00,499
hacking<font color="#E5E5E5"> box so that's how you can get</font>

483
00:20:58,699 --> 00:21:03,919
fries<font color="#E5E5E5"> and there is a third use case</font>

484
00:21:00,499 --> 00:21:07,039
where<font color="#E5E5E5"> you can use</font><font color="#CCCCCC"> name pipe</font><font color="#E5E5E5"> that that's</font>

485
00:21:03,919 --> 00:21:08,979
that's<font color="#E5E5E5"> more like for fun so please read</font>

486
00:21:07,039 --> 00:21:11,599
<font color="#CCCCCC">israel raise your hand if you</font><font color="#E5E5E5"> have ever</font>

487
00:21:08,979 --> 00:21:14,809
<font color="#CCCCCC">encountered these problems</font><font color="#E5E5E5"> for example</font>

488
00:21:11,599 --> 00:21:19,999
<font color="#CCCCCC">have you ever struggled testing</font><font color="#E5E5E5"> over</font>

489
00:21:14,809 --> 00:21:23,269
jump<font color="#E5E5E5"> box only one to a few okay</font>

490
00:21:19,999 --> 00:21:25,069
the other question have you ever had did

491
00:21:23,269 --> 00:21:26,809
you ever have you<font color="#CCCCCC"> ever been in a</font>

492
00:21:25,069 --> 00:21:29,629
situation<font color="#E5E5E5"> where</font><font color="#CCCCCC"> you had to provide a</font>

493
00:21:26,809 --> 00:21:33,319
list<font color="#E5E5E5"> of tools that you</font><font color="#CCCCCC"> need to install</font>

494
00:21:29,629 --> 00:21:35,329
on that jump box again a few people

495
00:21:33,319 --> 00:21:36,918
yeah that's an issue<font color="#E5E5E5"> and have you ever</font>

496
00:21:35,329 --> 00:21:39,198
<font color="#CCCCCC">had this problem and</font><font color="#E5E5E5"> you've you're on</font>

497
00:21:36,919 --> 00:21:40,969
site or whenever and you install<font color="#E5E5E5"> those</font>

498
00:21:39,199 --> 00:21:43,579
tools on the computer on<font color="#E5E5E5"> the jump box</font>

499
00:21:40,969 --> 00:21:45,709
<font color="#E5E5E5">but</font><font color="#CCCCCC"> you realize later</font><font color="#E5E5E5"> a day later that</font>

500
00:21:43,579 --> 00:21:48,289
you didn't<font color="#E5E5E5"> get approval for a third tool</font>

501
00:21:45,709 --> 00:21:50,479
or a hundred tool that you will<font color="#E5E5E5"> need for</font>

502
00:21:48,289 --> 00:21:51,649
the testing<font color="#E5E5E5"> so that's that's again a</font>

503
00:21:50,479 --> 00:21:53,479
common issue if you<font color="#E5E5E5"> are doing</font>

504
00:21:51,649 --> 00:21:56,178
penetration testing a<font color="#CCCCCC"> PCI zone for</font>

505
00:21:53,479 --> 00:21:58,089
example<font color="#CCCCCC"> because</font><font color="#E5E5E5"> getting approval is not</font>

506
00:21:56,179 --> 00:22:00,829
like five<font color="#E5E5E5"> minutes is probably</font><font color="#CCCCCC"> a few days</font>

507
00:21:58,089 --> 00:22:03,499
so you waste a<font color="#E5E5E5"> lot of time but if you</font>

508
00:22:00,829 --> 00:22:04,070
<font color="#E5E5E5">are using exfiltrate as I already</font>

509
00:22:03,499 --> 00:22:07,430
explained

510
00:22:04,070 --> 00:22:08,240
you you only need to set<font color="#CCCCCC"> up</font><font color="#E5E5E5"> and install</font>

511
00:22:07,430 --> 00:22:10,400
a few things

512
00:22:08,240 --> 00:22:12,800
a handful things on the on the jump<font color="#E5E5E5"> box</font>

513
00:22:10,400 --> 00:22:14,720
so<font color="#E5E5E5"> you will never ever forget about</font>

514
00:22:12,800 --> 00:22:17,000
anything<font color="#E5E5E5"> because you can use your</font><font color="#CCCCCC"> collie</font>

515
00:22:14,720 --> 00:22:20,630
box<font color="#E5E5E5"> your nesters and you can just tunnel</font>

516
00:22:17,000 --> 00:22:22,640
everything over the over the<font color="#E5E5E5"> tunnel so</font>

517
00:22:20,630 --> 00:22:25,070
that's why I<font color="#CCCCCC"> created</font><font color="#E5E5E5"> the RDP module</font>

518
00:22:22,640 --> 00:22:28,220
which<font color="#CCCCCC"> is Windows only</font><font color="#E5E5E5"> and server only so</font>

519
00:22:25,070 --> 00:22:30,950
you need to run<font color="#CCCCCC"> it</font><font color="#E5E5E5"> on the jump box</font><font color="#CCCCCC"> after</font>

520
00:22:28,220 --> 00:22:34,700
you<font color="#CCCCCC"> installed</font><font color="#E5E5E5"> it and because</font><font color="#CCCCCC"> it's layer</font>

521
00:22:30,950 --> 00:22:38,090
<font color="#CCCCCC">3</font><font color="#E5E5E5"> it's tuned not tap</font><font color="#CCCCCC"> that's why it's</font><font color="#E5E5E5"> not</font>

522
00:22:34,700 --> 00:22:39,740
it<font color="#E5E5E5"> it's a it's a restriction but it's</font>

523
00:22:38,090 --> 00:22:43,070
still really<font color="#CCCCCC"> good I already tested a few</font>

524
00:22:39,740 --> 00:22:47,240
few<font color="#CCCCCC"> clients over</font><font color="#E5E5E5"> this and it went very</font>

525
00:22:43,070 --> 00:22:49,250
well so<font color="#CCCCCC"> the demo part</font><font color="#E5E5E5"> after you</font>

526
00:22:47,240 --> 00:22:51,170
installed<font color="#E5E5E5"> exfiltrate there is the</font>

527
00:22:49,250 --> 00:22:54,260
configuration<font color="#CCCCCC"> file it's it's it should</font>

528
00:22:51,170 --> 00:22:56,900
<font color="#E5E5E5">be</font><font color="#CCCCCC"> really</font><font color="#E5E5E5"> easy</font><font color="#CCCCCC"> not to understand</font><font color="#E5E5E5"> but it</font>

529
00:22:54,260 --> 00:22:59,629
seems that<font color="#CCCCCC"> some people are</font><font color="#E5E5E5"> struggling</font>

530
00:22:56,900 --> 00:23:02,660
with it so we have through<font color="#E5E5E5"> the three</font>

531
00:22:59,630 --> 00:23:05,510
<font color="#E5E5E5">boxes here there is one</font><font color="#CCCCCC"> color box that</font>

532
00:23:02,660 --> 00:23:07,190
probably know that there is<font color="#E5E5E5"> this</font><font color="#CCCCCC"> Windows</font>

533
00:23:05,510 --> 00:23:11,000
box which will<font color="#E5E5E5"> be the client</font>

534
00:23:07,190 --> 00:23:13,220
this will be<font color="#CCCCCC"> the the jump box so I will</font>

535
00:23:11,000 --> 00:23:15,140
use this<font color="#CCCCCC"> T to connect to the jump</font><font color="#E5E5E5"> to</font>

536
00:23:13,220 --> 00:23:19,960
<font color="#CCCCCC">desegregated</font><font color="#E5E5E5"> network and there is a</font>

537
00:23:15,140 --> 00:23:19,960
third one which I'm going<font color="#CCCCCC"> to show you</font>

538
00:23:24,730 --> 00:23:33,100
so it has only one interface this<font color="#CCCCCC"> is the</font>

539
00:23:27,580 --> 00:23:35,560
IP<font color="#CCCCCC"> I hope you can see that and this is</font>

540
00:23:33,100 --> 00:23:39,669
the other this<font color="#CCCCCC"> is the client</font><font color="#E5E5E5"> where we</font>

541
00:23:35,560 --> 00:23:42,820
can access the network<font color="#CCCCCC"> that I'm using to</font>

542
00:23:39,670 --> 00:23:45,280
run Kali<font color="#CCCCCC"> so I can</font><font color="#E5E5E5"> access that that that</font>

543
00:23:42,820 --> 00:23:48,399
IP but<font color="#E5E5E5"> I won't be</font><font color="#CCCCCC"> able</font><font color="#E5E5E5"> to access the</font>

544
00:23:45,280 --> 00:23:53,379
other<font color="#E5E5E5"> network but from the Kali was from</font>

545
00:23:48,400 --> 00:23:57,220
here so if I ping this IP and it answers

546
00:23:53,380 --> 00:23:59,800
but if I go to the Kali box and I think

547
00:23:57,220 --> 00:24:01,960
that IP destination host host is

548
00:23:59,800 --> 00:24:04,480
unreachable<font color="#CCCCCC"> so that's</font><font color="#E5E5E5"> not going to</font><font color="#CCCCCC"> work</font>

549
00:24:01,960 --> 00:24:07,060
<font color="#CCCCCC">from</font><font color="#E5E5E5"> that but we</font><font color="#CCCCCC"> are</font><font color="#E5E5E5"> going to we want to</font>

550
00:24:04,480 --> 00:24:09,310
use the Kali<font color="#E5E5E5"> for testing because we have</font>

551
00:24:07,060 --> 00:24:12,429
all the tools<font color="#E5E5E5"> there right</font><font color="#CCCCCC"> so this</font><font color="#E5E5E5"> is the</font>

552
00:24:09,310 --> 00:24:14,980
configuration<font color="#E5E5E5"> you</font><font color="#CCCCCC"> need to set</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> IP</font>

553
00:24:12,430 --> 00:24:17,170
address of the<font color="#E5E5E5"> exfiltrate server this</font>

554
00:24:14,980 --> 00:24:19,900
<font color="#E5E5E5">will</font><font color="#CCCCCC"> be that you</font><font color="#E5E5E5"> don't really need</font><font color="#CCCCCC"> to</font>

555
00:24:17,170 --> 00:24:22,030
change<font color="#CCCCCC"> anything about the server server</font>

556
00:24:19,900 --> 00:24:24,580
<font color="#CCCCCC">part or</font><font color="#E5E5E5"> the client part that's that's</font>

557
00:24:22,030 --> 00:24:26,200
not going<font color="#CCCCCC"> to be used right now</font><font color="#E5E5E5"> if you</font>

558
00:24:24,580 --> 00:24:28,629
want to do split tunneling you need to

559
00:24:26,200 --> 00:24:31,150
specify the IP<font color="#E5E5E5"> is in the scope</font><font color="#CCCCCC"> dot text</font>

560
00:24:28,630 --> 00:24:33,460
there is authentication<font color="#CCCCCC"> this</font><font color="#E5E5E5"> is the key</font>

561
00:24:31,150 --> 00:24:35,290
right<font color="#CCCCCC"> now for</font><font color="#E5E5E5"> this presentation</font><font color="#CCCCCC"> the</font>

562
00:24:33,460 --> 00:24:39,370
<font color="#E5E5E5">encryption is turned off because that's</font>

563
00:24:35,290 --> 00:24:41,649
local network<font color="#E5E5E5"> and that has a performance</font>

564
00:24:39,370 --> 00:24:44,169
impact<font color="#E5E5E5"> not really huge but we</font><font color="#CCCCCC"> are not</font>

565
00:24:41,650 --> 00:24:46,720
going<font color="#CCCCCC"> to use</font><font color="#E5E5E5"> that right</font><font color="#CCCCCC"> now and we</font><font color="#E5E5E5"> are</font>

566
00:24:44,170 --> 00:24:50,080
<font color="#E5E5E5">going to use TCP</font><font color="#CCCCCC"> generic so it's enabled</font>

567
00:24:46,720 --> 00:24:53,440
<font color="#E5E5E5">the port is this port the elite port and</font>

568
00:24:50,080 --> 00:24:55,000
all the other all the<font color="#E5E5E5"> other modules are</font>

569
00:24:53,440 --> 00:24:59,290
turned<font color="#E5E5E5"> off so</font><font color="#CCCCCC"> anybody know</font>

570
00:24:55,000 --> 00:25:04,000
ICMP na but no socks<font color="#CCCCCC"> no and so on</font><font color="#E5E5E5"> so we</font>

571
00:24:59,290 --> 00:25:07,690
don't<font color="#CCCCCC"> have to care about</font><font color="#E5E5E5"> that thing this</font>

572
00:25:04,000 --> 00:25:10,030
is again the<font color="#E5E5E5"> client so we can access the</font>

573
00:25:07,690 --> 00:25:14,890
the segregated<font color="#E5E5E5"> network from this client</font>

574
00:25:10,030 --> 00:25:19,210
<font color="#CCCCCC">and this</font><font color="#E5E5E5"> is the registry which</font><font color="#CCCCCC"> is hard</font>

575
00:25:14,890 --> 00:25:23,860
to<font color="#CCCCCC"> see but there's this enabled stuff so</font>

576
00:25:19,210 --> 00:25:27,700
whenever you execute<font color="#E5E5E5"> msds see the remote</font>

577
00:25:23,860 --> 00:25:30,850
desktop<font color="#E5E5E5"> connection client</font><font color="#CCCCCC"> then then that</font>

578
00:25:27,700 --> 00:25:33,550
<font color="#E5E5E5">DLL that I was talking</font><font color="#CCCCCC"> about</font><font color="#E5E5E5"> will be</font>

579
00:25:30,850 --> 00:25:36,280
<font color="#E5E5E5">registered and will be loaded into the</font>

580
00:25:33,550 --> 00:25:38,269
context<font color="#E5E5E5"> of this of this process from</font>

581
00:25:36,280 --> 00:25:40,459
registry you can enable<font color="#E5E5E5"> it or disabled</font>

582
00:25:38,269 --> 00:25:43,309
if you can set the mode to listen

583
00:25:40,459 --> 00:25:46,159
Connect or name pipe<font color="#CCCCCC"> and you can specify</font>

584
00:25:43,309 --> 00:25:48,619
the port name pipe and so on everything

585
00:25:46,159 --> 00:25:53,089
<font color="#CCCCCC">is set when you connect to the server it</font>

586
00:25:48,619 --> 00:25:58,339
will listen<font color="#E5E5E5"> on the on the on all all</font>

587
00:25:53,089 --> 00:26:01,249
interfaces<font color="#E5E5E5"> on port elite I'm sorry</font>

588
00:25:58,339 --> 00:26:05,330
that's that's a bit<font color="#E5E5E5"> small it's</font><font color="#CCCCCC"> hard to</font>

589
00:26:01,249 --> 00:26:10,849
see so we connect to the segregated

590
00:26:05,330 --> 00:26:12,859
<font color="#CCCCCC">network to that host</font><font color="#E5E5E5"> we are in as you</font>

591
00:26:10,849 --> 00:26:16,609
can see<font color="#E5E5E5"> it's remote desktop the same box</font>

592
00:26:12,859 --> 00:26:18,139
we have the exfiltrate<font color="#E5E5E5"> server here there</font>

593
00:26:16,609 --> 00:26:21,468
is the configuration<font color="#E5E5E5"> for the server as</font>

594
00:26:18,139 --> 00:26:25,399
well<font color="#CCCCCC"> so we</font><font color="#E5E5E5"> are going to run it as you</font>

595
00:26:21,469 --> 00:26:28,190
can<font color="#E5E5E5"> see I hope you can it started the</font>

596
00:26:25,399 --> 00:26:30,408
module<font color="#E5E5E5"> RDP and connected</font><font color="#CCCCCC"> Devere to our</font>

597
00:26:28,190 --> 00:26:32,809
<font color="#E5E5E5">channel which is you Nevada University</font>

598
00:26:30,409 --> 00:26:34,999
BC<font color="#E5E5E5"> that's the name of</font><font color="#CCCCCC"> the channel</font><font color="#E5E5E5"> and if</font>

599
00:26:32,809 --> 00:26:37,158
<font color="#E5E5E5">you go to the client</font><font color="#CCCCCC"> and you look for</font>

600
00:26:34,999 --> 00:26:39,529
that sport that I was looking<font color="#E5E5E5"> for before</font>

601
00:26:37,159 --> 00:26:42,919
<font color="#CCCCCC">you can see it's listening on the elite</font>

602
00:26:39,529 --> 00:26:45,769
<font color="#CCCCCC">port on all interfaces</font><font color="#E5E5E5"> so we don't need</font>

603
00:26:42,919 --> 00:26:47,479
<font color="#E5E5E5">that</font><font color="#CCCCCC"> books</font><font color="#E5E5E5"> anymore and let's try to ping</font>

604
00:26:45,769 --> 00:26:49,549
again<font color="#CCCCCC"> it's not working</font><font color="#E5E5E5"> because we are</font>

605
00:26:47,479 --> 00:26:52,279
not connected to<font color="#E5E5E5"> that but if we are</font>

606
00:26:49,549 --> 00:26:55,549
using the<font color="#CCCCCC"> expiated client to connect to</font>

607
00:26:52,279 --> 00:26:56,989
the client<font color="#CCCCCC"> to</font><font color="#E5E5E5"> the client windows box</font>

608
00:26:55,549 --> 00:27:00,009
<font color="#E5E5E5">where we use the remote desktop</font>

609
00:26:56,989 --> 00:27:07,519
<font color="#E5E5E5">connection then it should work</font>

610
00:27:00,009 --> 00:27:09,469
<font color="#E5E5E5">of course it's not</font><font color="#CCCCCC"> the IP is always</font>

611
00:27:07,519 --> 00:27:15,049
changing in<font color="#CCCCCC"> realtor box so i need to</font>

612
00:27:09,469 --> 00:27:19,359
<font color="#CCCCCC">change the configuration because the IP</font>

613
00:27:15,049 --> 00:27:19,359
was different when I got on<font color="#E5E5E5"> the stage</font>

614
00:27:22,750 --> 00:27:29,780
okay so the authentication the

615
00:27:27,680 --> 00:27:32,690
authentication<font color="#E5E5E5"> was successful</font><font color="#CCCCCC"> so we</font>

616
00:27:29,780 --> 00:27:35,360
<font color="#CCCCCC">should be able to type</font><font color="#E5E5E5"> in that host as</font>

617
00:27:32,690 --> 00:27:38,960
you can see now we<font color="#E5E5E5"> are able to type in</font>

618
00:27:35,360 --> 00:27:42,169
<font color="#E5E5E5">that host so that means that</font><font color="#CCCCCC"> the exited</font>

619
00:27:38,960 --> 00:27:44,690
client connected to the terminal<font color="#E5E5E5"> to the</font>

620
00:27:42,170 --> 00:27:46,700
remote<font color="#CCCCCC"> desktop server client and from</font>

621
00:27:44,690 --> 00:27:49,520
from that<font color="#CCCCCC"> everything is tunneled over to</font>

622
00:27:46,700 --> 00:27:51,410
the exfiltrate server on the<font color="#E5E5E5"> segregated</font>

623
00:27:49,520 --> 00:27:57,410
network so we<font color="#CCCCCC"> can access anything</font><font color="#E5E5E5"> in the</font>

624
00:27:51,410 --> 00:27:59,830
segregated<font color="#CCCCCC"> that's work if we issue an</font>

625
00:27:57,410 --> 00:27:59,830
nmap scan

626
00:28:04,950 --> 00:28:09,270
that should work<font color="#E5E5E5"> it's pretty slow it's</font>

627
00:28:07,740 --> 00:28:11,310
not the fastest because<font color="#E5E5E5"> it's not it</font>

628
00:28:09,270 --> 00:28:14,490
<font color="#E5E5E5">that's the only limitation here so you</font>

629
00:28:11,310 --> 00:28:17,190
need<font color="#E5E5E5"> to be careful</font><font color="#CCCCCC"> not to</font><font color="#E5E5E5"> do you fill up</font>

630
00:28:14,490 --> 00:28:20,520
the<font color="#CCCCCC"> nut table but that's</font><font color="#E5E5E5"> that's this is</font>

631
00:28:17,190 --> 00:28:23,700
<font color="#E5E5E5">really nicely working as you can see</font>

632
00:28:20,520 --> 00:28:26,220
<font color="#E5E5E5">poor 2880 blah blah blah is open on the</font>

633
00:28:23,700 --> 00:28:29,100
<font color="#E5E5E5">on the server and that's going through</font>

634
00:28:26,220 --> 00:28:30,930
the exfiltrate<font color="#E5E5E5"> tunnel into the</font>

635
00:28:29,100 --> 00:28:33,090
segregated<font color="#CCCCCC"> network so basically you can</font>

636
00:28:30,930 --> 00:28:35,160
<font color="#CCCCCC">use any kind of tool</font><font color="#E5E5E5"> from your colleague</font>

637
00:28:33,090 --> 00:28:37,230
box<font color="#E5E5E5"> right now because everything is</font>

638
00:28:35,160 --> 00:28:39,660
<font color="#CCCCCC">tunneled to that</font><font color="#E5E5E5"> network you can use</font>

639
00:28:37,230 --> 00:28:41,820
<font color="#CCCCCC">Nasus as well you just</font><font color="#E5E5E5"> need to make sure</font>

640
00:28:39,660 --> 00:28:45,740
<font color="#CCCCCC">that everything</font><font color="#E5E5E5"> is routed through that</font>

641
00:28:41,820 --> 00:28:45,740
that tunnel where you set it up

642
00:28:48,050 --> 00:28:58,040
[Applause]

643
00:28:54,680 --> 00:29:00,180
thank you<font color="#CCCCCC"> I think it's it's hard</font><font color="#E5E5E5"> to</font>

644
00:28:58,040 --> 00:29:02,760
understand and<font color="#E5E5E5"> hard to explain as well</font>

645
00:29:00,180 --> 00:29:06,770
<font color="#E5E5E5">but it works really good in tax practice</font>

646
00:29:02,760 --> 00:29:11,640
and it helps the pen testers a lot so

647
00:29:06,770 --> 00:29:14,550
about the<font color="#E5E5E5"> offense you know it it was</font>

648
00:29:11,640 --> 00:29:16,380
most review time for offense<font color="#CCCCCC"> you can use</font>

649
00:29:14,550 --> 00:29:18,180
<font color="#E5E5E5">it for</font><font color="#CCCCCC"> different things</font><font color="#E5E5E5"> if you want to</font>

650
00:29:16,380 --> 00:29:21,570
exfiltrate data<font color="#E5E5E5"> it's a it's a good</font>

651
00:29:18,180 --> 00:29:24,240
choice<font color="#E5E5E5"> maybe not the best then you can</font>

652
00:29:21,570 --> 00:29:26,399
bypass corporate proxy policies you<font color="#E5E5E5"> can</font>

653
00:29:24,240 --> 00:29:30,980
bypass cavity<font color="#CCCCCC"> four thousand on the on</font>

654
00:29:26,400 --> 00:29:34,260
the on the airport<font color="#CCCCCC"> you</font><font color="#E5E5E5"> can do like</font>

655
00:29:30,980 --> 00:29:38,820
penetration testing over<font color="#CCCCCC"> the</font><font color="#E5E5E5"> tunnel and</font>

656
00:29:34,260 --> 00:29:42,390
get access<font color="#E5E5E5"> to</font><font color="#CCCCCC"> to segregated</font><font color="#E5E5E5"> networks as</font>

657
00:29:38,820 --> 00:29:46,520
<font color="#CCCCCC">well and so on so about the exfiltration</font>

658
00:29:42,390 --> 00:29:50,910
because this is based on an IP tunnel

659
00:29:46,520 --> 00:29:52,700
<font color="#CCCCCC">fool IP</font><font color="#E5E5E5"> tunnel so every IP header</font><font color="#CCCCCC"> TCP</font>

660
00:29:50,910 --> 00:29:55,290
<font color="#CCCCCC">UDP header and everything will</font><font color="#E5E5E5"> be</font>

661
00:29:52,700 --> 00:29:57,110
transmitted<font color="#CCCCCC"> over and over the protocol</font>

662
00:29:55,290 --> 00:30:00,300
that<font color="#E5E5E5"> you are using for for the tunneling</font>

663
00:29:57,110 --> 00:30:02,010
<font color="#CCCCCC">it will be a</font><font color="#E5E5E5"> little bit noisy so for</font>

664
00:30:00,300 --> 00:30:05,190
example if you want to exfiltrate data

665
00:30:02,010 --> 00:30:07,080
over<font color="#CCCCCC"> DNS then the</font><font color="#E5E5E5"> DNS pockets will be</font>

666
00:30:05,190 --> 00:30:10,830
bigger than expected<font color="#E5E5E5"> because you have a</font>

667
00:30:07,080 --> 00:30:13,310
<font color="#E5E5E5">lots of big overhead basically but but</font>

668
00:30:10,830 --> 00:30:16,649
it can be done and it<font color="#E5E5E5"> works really well</font>

669
00:30:13,310 --> 00:30:20,700
<font color="#CCCCCC">but maybe if</font><font color="#E5E5E5"> you want to do</font><font color="#CCCCCC"> X</font><font color="#E5E5E5"> filtration</font>

670
00:30:16,650 --> 00:30:22,410
<font color="#E5E5E5">and you want to be under the</font><font color="#CCCCCC"> radar</font>

671
00:30:20,700 --> 00:30:24,090
then maybe<font color="#E5E5E5"> it's not the best tool for</font>

672
00:30:22,410 --> 00:30:26,940
you because<font color="#E5E5E5"> it's like I said it's a</font>

673
00:30:24,090 --> 00:30:29,280
quite noisy<font color="#E5E5E5"> the tool was already already</font>

674
00:30:26,940 --> 00:30:30,810
released<font color="#E5E5E5"> there are two URLs</font><font color="#CCCCCC"> that I can</font>

675
00:30:29,280 --> 00:30:33,210
tell<font color="#E5E5E5"> you the first one is the</font><font color="#CCCCCC"> exfiltrate</font>

676
00:30:30,810 --> 00:30:35,820
<font color="#E5E5E5">that info it's kind of hard to</font><font color="#CCCCCC"> remember</font>

677
00:30:33,210 --> 00:30:38,280
but you know it's just<font color="#CCCCCC"> a placeholder it</font>

678
00:30:35,820 --> 00:30:40,740
will it will redirect you to the<font color="#E5E5E5"> second</font>

679
00:30:38,280 --> 00:30:43,500
one which is<font color="#E5E5E5"> the github repository for</font>

680
00:30:40,740 --> 00:30:46,770
exfiltrate if you<font color="#E5E5E5"> liked it please give</font>

681
00:30:43,500 --> 00:30:49,500
<font color="#CCCCCC">me a star</font><font color="#E5E5E5"> on</font><font color="#CCCCCC"> that and what about the</font>

682
00:30:46,770 --> 00:30:51,870
next<font color="#E5E5E5"> thing so</font><font color="#CCCCCC"> I'm going</font><font color="#E5E5E5"> to do some bug</font>

683
00:30:49,500 --> 00:30:54,380
fixes<font color="#CCCCCC"> in the future and</font><font color="#E5E5E5"> probably new</font>

684
00:30:51,870 --> 00:30:56,820
modules there are lots of things in mind

685
00:30:54,380 --> 00:30:59,850
<font color="#E5E5E5">but the most important question on this</font>

686
00:30:56,820 --> 00:31:02,399
slide is how can you<font color="#CCCCCC"> help me or how can</font>

687
00:30:59,850 --> 00:31:04,110
<font color="#CCCCCC">you</font><font color="#E5E5E5"> help the</font><font color="#CCCCCC"> the community</font><font color="#E5E5E5"> so there are</font>

688
00:31:02,400 --> 00:31:06,210
two<font color="#E5E5E5"> different ways first of all if you</font>

689
00:31:04,110 --> 00:31:09,120
want to to get<font color="#E5E5E5"> involved in</font>

690
00:31:06,210 --> 00:31:11,070
the development<font color="#E5E5E5"> you are welcome I will</font>

691
00:31:09,120 --> 00:31:14,250
be<font color="#E5E5E5"> really</font><font color="#CCCCCC"> happy to see some new faces in</font>

692
00:31:11,070 --> 00:31:16,470
<font color="#E5E5E5">there and please use the next branch</font>

693
00:31:14,250 --> 00:31:19,560
<font color="#E5E5E5">from github</font><font color="#CCCCCC"> because that's the bleeding</font>

694
00:31:16,470 --> 00:31:21,750
edge<font color="#CCCCCC"> version and yeah that that should</font>

695
00:31:19,560 --> 00:31:23,659
be<font color="#E5E5E5"> used for development and I would be</font>

696
00:31:21,750 --> 00:31:27,030
<font color="#E5E5E5">really</font><font color="#CCCCCC"> happy to see people doing that</font>

697
00:31:23,660 --> 00:31:28,890
<font color="#CCCCCC">and just</font><font color="#E5E5E5"> come to talk</font><font color="#CCCCCC"> to me please</font><font color="#E5E5E5"> if</font>

698
00:31:27,030 --> 00:31:32,040
you want<font color="#E5E5E5"> to do that yeah just and the</font>

699
00:31:28,890 --> 00:31:33,840
other one which<font color="#CCCCCC"> is as important</font><font color="#E5E5E5"> as the</font>

700
00:31:32,040 --> 00:31:36,210
previous one<font color="#E5E5E5"> if you like the</font>

701
00:31:33,840 --> 00:31:37,439
<font color="#E5E5E5">presentation</font><font color="#CCCCCC"> if you like the tool please</font>

702
00:31:36,210 --> 00:31:40,440
follow me<font color="#CCCCCC"> on Twitter and</font><font color="#E5E5E5"> retweet</font>

703
00:31:37,440 --> 00:31:43,770
<font color="#E5E5E5">everything related to exfiltrate because</font>

704
00:31:40,440 --> 00:31:46,440
that's how it can<font color="#E5E5E5"> access you know that's</font>

705
00:31:43,770 --> 00:31:48,360
how<font color="#CCCCCC"> it can get to other people that's</font>

706
00:31:46,440 --> 00:31:51,090
how it can grow and more people<font color="#E5E5E5"> know</font>

707
00:31:48,360 --> 00:31:53,219
about<font color="#E5E5E5"> this stuff the the</font><font color="#CCCCCC"> more successful</font>

708
00:31:51,090 --> 00:31:54,840
tool can<font color="#CCCCCC"> be created from</font><font color="#E5E5E5"> this so it's</font>

709
00:31:53,220 --> 00:31:57,480
you know<font color="#CCCCCC"> it's a</font><font color="#E5E5E5"> brand net with benefit</font>

710
00:31:54,840 --> 00:32:00,780
for you as well<font color="#E5E5E5"> so thank you for your</font>

711
00:31:57,480 --> 00:32:02,990
<font color="#CCCCCC">attention thank you for being</font><font color="#E5E5E5"> here and I</font>

712
00:32:00,780 --> 00:32:06,660
believe we<font color="#E5E5E5"> have a few more minutes for</font>

713
00:32:02,990 --> 00:32:08,700
for questions so<font color="#E5E5E5"> if you have</font><font color="#CCCCCC"> any</font>

714
00:32:06,660 --> 00:32:10,920
questions<font color="#E5E5E5"> now</font><font color="#CCCCCC"> is the time</font><font color="#E5E5E5"> or maybe later</font>

715
00:32:08,700 --> 00:32:13,950
<font color="#E5E5E5">whenever we are having beers or I'm</font>

716
00:32:10,920 --> 00:32:17,480
outside<font color="#E5E5E5"> any questions</font><font color="#CCCCCC"> okay before we</font><font color="#E5E5E5"> let</font>

717
00:32:13,950 --> 00:32:24,830
<font color="#E5E5E5">balázs god are there any exfiltrate</font>

718
00:32:17,480 --> 00:32:26,130
<font color="#E5E5E5">questions for him this time</font><font color="#CCCCCC"> oh</font><font color="#E5E5E5"> he is not</font>

719
00:32:24,830 --> 00:32:28,860
<font color="#E5E5E5">alive</font>

720
00:32:26,130 --> 00:32:29,350
thank you very<font color="#E5E5E5"> much thank you</font>

721
00:32:28,860 --> 00:32:30,250
[Applause]

722
00:32:29,350 --> 00:32:32,709
[Music]

723
00:32:30,250 --> 00:32:33,130
[Applause]

724
00:32:32,710 --> 00:32:36,989
you

725
00:32:33,130 --> 00:32:36,989
[Applause]

