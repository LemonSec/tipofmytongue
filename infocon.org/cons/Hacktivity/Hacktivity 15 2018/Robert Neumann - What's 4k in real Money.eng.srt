1
00:00:00,030 --> 00:00:03,899
I'm<font color="#CCCCCC"> Roberta</font><font color="#E5E5E5"> Norman I'm a</font><font color="#CCCCCC"> security</font>

2
00:00:02,070 --> 00:00:06,209
researcher<font color="#E5E5E5"> at</font><font color="#CCCCCC"> fourth point</font><font color="#E5E5E5"> working in</font>

3
00:00:03,899 --> 00:00:08,450
the a<font color="#E5E5E5"> special investigation</font><font color="#CCCCCC"> team and I</font>

4
00:00:06,210 --> 00:00:11,849
would like to<font color="#CCCCCC"> share one of</font><font color="#E5E5E5"> the recent</font>

5
00:00:08,450 --> 00:00:17,039
investigations and about the title<font color="#E5E5E5"> so</font>

6
00:00:11,849 --> 00:00:20,340
the<font color="#CCCCCC"> four key</font><font color="#E5E5E5"> theory when you hear the</font>

7
00:00:17,039 --> 00:00:23,220
four key as a kind of a verb<font color="#CCCCCC"> what is the</font>

8
00:00:20,340 --> 00:00:24,900
main<font color="#E5E5E5"> Association you have so usually</font>

9
00:00:23,220 --> 00:00:28,769
<font color="#E5E5E5">it's television with</font><font color="#CCCCCC"> our high</font><font color="#E5E5E5"> definition</font>

10
00:00:24,900 --> 00:00:30,900
<font color="#CCCCCC">because that's something from the past</font>

11
00:00:28,769 --> 00:00:34,440
couple of years<font color="#E5E5E5"> there is</font><font color="#CCCCCC"> eight capes</font>

12
00:00:30,900 --> 00:00:36,570
<font color="#CCCCCC">Tier four K something good</font><font color="#E5E5E5"> but that's</font>

13
00:00:34,440 --> 00:00:38,910
<font color="#CCCCCC">just</font><font color="#E5E5E5"> one thing the second one is good</font>

14
00:00:36,570 --> 00:00:41,790
old cash<font color="#E5E5E5"> because you are usually saying</font>

15
00:00:38,910 --> 00:00:46,288
that it's it's<font color="#E5E5E5"> four thousand or like</font><font color="#CCCCCC"> 4k</font>

16
00:00:41,790 --> 00:00:49,649
<font color="#CCCCCC">and the third one is</font><font color="#E5E5E5"> something kind of a</font>

17
00:00:46,289 --> 00:00:52,260
retro<font color="#CCCCCC"> thing called a 4k demo</font><font color="#E5E5E5"> so I'm not</font>

18
00:00:49,649 --> 00:00:54,329
sure how old you are here but this is

19
00:00:52,260 --> 00:00:57,800
<font color="#E5E5E5">something which goes back to</font><font color="#CCCCCC"> probably</font>

20
00:00:54,329 --> 00:01:00,660
their 80s<font color="#E5E5E5"> or the 90s and it was</font>

21
00:00:57,800 --> 00:01:03,480
representing a very short piece<font color="#CCCCCC"> of code</font>

22
00:01:00,660 --> 00:01:07,140
doing<font color="#E5E5E5"> very fancy graphics on computers</font>

23
00:01:03,480 --> 00:01:10,289
and thankfully it<font color="#E5E5E5"> is still not extinct</font>

24
00:01:07,140 --> 00:01:13,260
but<font color="#CCCCCC"> a</font><font color="#E5E5E5"> little bit more on that later</font>

25
00:01:10,290 --> 00:01:15,450
so couple<font color="#E5E5E5"> of questions before</font><font color="#CCCCCC"> we we</font>

26
00:01:13,260 --> 00:01:18,750
proceed how many of you<font color="#E5E5E5"> can actually</font>

27
00:01:15,450 --> 00:01:21,330
<font color="#E5E5E5">understand assembly code hands up don't</font>

28
00:01:18,750 --> 00:01:23,580
be<font color="#CCCCCC"> shy okay that's</font><font color="#E5E5E5"> reasonable</font>

29
00:01:21,330 --> 00:01:26,070
so how many<font color="#E5E5E5"> you</font><font color="#CCCCCC"> are actually</font><font color="#E5E5E5"> still</font>

30
00:01:23,580 --> 00:01:28,080
writing assembly code<font color="#E5E5E5"> that's more tricky</font>

31
00:01:26,070 --> 00:01:29,850
<font color="#E5E5E5">hands up because I know that you are</font>

32
00:01:28,080 --> 00:01:32,640
might<font color="#CCCCCC"> be doing still share codes right</font>

33
00:01:29,850 --> 00:01:35,399
<font color="#E5E5E5">okay that was that</font><font color="#CCCCCC"> was</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> ticket part</font>

34
00:01:32,640 --> 00:01:37,259
<font color="#E5E5E5">so it will be likely a bit of</font>

35
00:01:35,400 --> 00:01:42,299
<font color="#E5E5E5">higher-level</font><font color="#CCCCCC"> but I was</font><font color="#E5E5E5"> trying to</font><font color="#CCCCCC"> also</font>

36
00:01:37,259 --> 00:01:44,570
<font color="#E5E5E5">include some assembly</font><font color="#CCCCCC"> level stuff mainly</font>

37
00:01:42,299 --> 00:01:48,000
for for you guys who<font color="#CCCCCC"> are</font><font color="#E5E5E5"> still coding</font>

38
00:01:44,570 --> 00:01:51,089
<font color="#E5E5E5">okay and how is</font><font color="#CCCCCC"> it all connecting to the</font>

39
00:01:48,000 --> 00:01:53,490
talk<font color="#E5E5E5"> so is it a present or the past as</font>

40
00:01:51,090 --> 00:01:56,640
<font color="#E5E5E5">you can see that's a POS terminal and</font>

41
00:01:53,490 --> 00:02:00,869
it's<font color="#E5E5E5"> a kind of a bad play with the words</font>

42
00:01:56,640 --> 00:02:04,170
but let's see so there was a you<font color="#CCCCCC"> depose</font>

43
00:02:00,869 --> 00:02:07,890
discovery that was by us<font color="#E5E5E5"> at</font><font color="#CCCCCC"> first point</font>

44
00:02:04,170 --> 00:02:11,459
early this year that was basically a new

45
00:02:07,890 --> 00:02:12,750
piece of<font color="#CCCCCC"> Bo a smaller family</font><font color="#E5E5E5"> wasn't</font>

46
00:02:11,459 --> 00:02:14,580
<font color="#E5E5E5">really</font>

47
00:02:12,750 --> 00:02:18,330
<font color="#CCCCCC">during or anything</font><font color="#E5E5E5"> what we haven't seen</font>

48
00:02:14,580 --> 00:02:20,700
before<font color="#CCCCCC"> the</font><font color="#E5E5E5"> novelty was or one kind of</font>

49
00:02:18,330 --> 00:02:23,400
<font color="#CCCCCC">Novell feature that it was using</font><font color="#E5E5E5"> DNS for</font>

50
00:02:20,700 --> 00:02:26,339
data<font color="#E5E5E5"> extraction compared</font><font color="#CCCCCC"> to other</font>

51
00:02:23,400 --> 00:02:29,790
methods DNS and data extraction<font color="#CCCCCC"> over DNS</font>

52
00:02:26,340 --> 00:02:32,070
is not really<font color="#E5E5E5"> that</font><font color="#CCCCCC"> new but there weren't</font>

53
00:02:29,790 --> 00:02:36,269
<font color="#E5E5E5">many POS families utilizing it before</font>

54
00:02:32,070 --> 00:02:39,840
and we only had a couple<font color="#E5E5E5"> I can handful</font>

55
00:02:36,270 --> 00:02:42,480
of samples of<font color="#E5E5E5"> that then there was the</font>

56
00:02:39,840 --> 00:02:46,680
<font color="#CCCCCC">pinkeye story it was almost at the same</font>

57
00:02:42,480 --> 00:02:49,260
<font color="#E5E5E5">time it was by security researchers</font><font color="#CCCCCC"> they</font>

58
00:02:46,680 --> 00:02:52,020
were finding a<font color="#E5E5E5"> small piece of POS</font>

59
00:02:49,260 --> 00:02:56,540
malware according<font color="#E5E5E5"> to them it was between</font>

60
00:02:52,020 --> 00:02:58,950
<font color="#E5E5E5">four</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> six kilobytes in size and the</font>

61
00:02:56,540 --> 00:03:01,739
interesting bit there was that it was

62
00:02:58,950 --> 00:03:04,019
using kind of<font color="#E5E5E5"> clearing houses for</font>

63
00:03:01,739 --> 00:03:07,800
storing<font color="#CCCCCC"> the all the stolen credit</font><font color="#E5E5E5"> card</font>

64
00:03:04,020 --> 00:03:09,780
<font color="#E5E5E5">data and also they were claiming that it</font>

65
00:03:07,800 --> 00:03:12,630
was<font color="#E5E5E5"> using</font><font color="#CCCCCC"> that the very famous double</font>

66
00:03:09,780 --> 00:03:16,580
<font color="#E5E5E5">XOR encryption as much as we can</font>

67
00:03:12,630 --> 00:03:19,560
consider that<font color="#E5E5E5"> of our own</font><font color="#CCCCCC"> encryption and</font>

68
00:03:16,580 --> 00:03:22,140
the<font color="#CCCCCC"> pinkeye study goes back</font><font color="#E5E5E5"> to a little</font>

69
00:03:19,560 --> 00:03:23,790
<font color="#CCCCCC">bit</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> the past so</font><font color="#E5E5E5"> when we were reading</font>

70
00:03:22,140 --> 00:03:27,029
about the<font color="#E5E5E5"> story and</font><font color="#CCCCCC"> that is a small</font>

71
00:03:23,790 --> 00:03:29,640
piece and it's a POS<font color="#E5E5E5"> there were kind of</font>

72
00:03:27,030 --> 00:03:33,120
small bells ringing<font color="#E5E5E5"> so it's it's</font><font color="#CCCCCC"> very</font>

73
00:03:29,640 --> 00:03:36,708
much<font color="#E5E5E5"> looking like there is the old tiny</font>

74
00:03:33,120 --> 00:03:39,930
post /<font color="#CCCCCC"> Abaddon posts</font><font color="#E5E5E5"> more</font><font color="#CCCCCC"> other</font>

75
00:03:36,709 --> 00:03:42,540
resurfacing or<font color="#E5E5E5"> might be</font><font color="#CCCCCC"> a new iteration</font>

76
00:03:39,930 --> 00:03:44,880
<font color="#CCCCCC">of that</font><font color="#E5E5E5"> or just kind of ideas were</font><font color="#CCCCCC"> lost</font>

77
00:03:42,540 --> 00:03:49,320
for<font color="#E5E5E5"> that or</font><font color="#CCCCCC"> whatever but that</font><font color="#E5E5E5"> was very</font>

78
00:03:44,880 --> 00:03:52,380
very<font color="#CCCCCC"> similar and last but not least its</font>

79
00:03:49,320 --> 00:03:54,660
<font color="#E5E5E5">Joker's - some</font><font color="#CCCCCC"> of you might know the</font>

80
00:03:52,380 --> 00:03:57,410
name so it's a<font color="#E5E5E5"> kind of famous site for</font>

81
00:03:54,660 --> 00:04:00,420
selling and trading<font color="#E5E5E5"> credit card data and</font>

82
00:03:57,410 --> 00:04:03,269
<font color="#E5E5E5">the owner or maybe there are multiple</font>

83
00:04:00,420 --> 00:04:06,359
owners they are kind of pure product of

84
00:04:03,269 --> 00:04:08,579
their work and just recently they<font color="#CCCCCC"> were</font>

85
00:04:06,360 --> 00:04:11,489
claiming<font color="#CCCCCC"> that they were</font><font color="#E5E5E5"> hacking into</font>

86
00:04:08,579 --> 00:04:13,680
merchants directly and they are

87
00:04:11,489 --> 00:04:16,470
responsible<font color="#CCCCCC"> for a</font><font color="#E5E5E5"> couple of recent</font>

88
00:04:13,680 --> 00:04:19,769
breaches Brian Krebs<font color="#E5E5E5"> was having a very</font>

89
00:04:16,470 --> 00:04:23,860
<font color="#E5E5E5">nice summary on them and and also kind</font>

90
00:04:19,769 --> 00:04:26,550
of a fake<font color="#CCCCCC"> Joker's</font><font color="#E5E5E5"> - side so that</font>

91
00:04:23,860 --> 00:04:30,330
<font color="#CCCCCC">is going</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> kind</font><font color="#E5E5E5"> of add up</font><font color="#CCCCCC"> at the end</font>

92
00:04:26,550 --> 00:04:32,259
about<font color="#CCCCCC"> the investigation so we were</font>

93
00:04:30,330 --> 00:04:35,438
basically<font color="#CCCCCC"> just starting to collect</font>

94
00:04:32,259 --> 00:04:38,680
<font color="#E5E5E5">samples we were not really expecting to</font>

95
00:04:35,439 --> 00:04:40,719
<font color="#E5E5E5">have too many because from the previous</font>

96
00:04:38,680 --> 00:04:42,669
experience with<font color="#CCCCCC"> Judy Post</font><font color="#E5E5E5"> and other POS</font>

97
00:04:40,719 --> 00:04:47,050
mother it was usually just<font color="#CCCCCC"> a handful of</font>

98
00:04:42,669 --> 00:04:49,060
samples what someone<font color="#CCCCCC"> can gather we</font>

99
00:04:47,050 --> 00:04:53,289
started to collect those samples<font color="#E5E5E5"> very</font>

100
00:04:49,060 --> 00:04:58,270
<font color="#E5E5E5">early this year</font><font color="#CCCCCC"> and as of today we have</font>

101
00:04:53,289 --> 00:05:01,449
more<font color="#CCCCCC"> than 1500 unique samples of course</font>

102
00:04:58,270 --> 00:05:04,779
they are<font color="#E5E5E5"> falling</font><font color="#CCCCCC"> down</font><font color="#E5E5E5"> into a couple</font><font color="#CCCCCC"> of</font>

103
00:05:01,449 --> 00:05:06,520
<font color="#E5E5E5">different categories but when unique</font><font color="#CCCCCC"> it</font>

104
00:05:04,779 --> 00:05:09,189
<font color="#CCCCCC">is of course</font><font color="#E5E5E5"> it means that it has unique</font>

105
00:05:06,520 --> 00:05:11,740
and the sample size is<font color="#CCCCCC"> whirring between</font>

106
00:05:09,189 --> 00:05:13,719
<font color="#E5E5E5">two and seven kilobytes but it's as the</font>

107
00:05:11,740 --> 00:05:17,319
title was saying it's mostly about<font color="#E5E5E5"> four</font>

108
00:05:13,719 --> 00:05:19,779
kilobytes<font color="#CCCCCC"> and the major rate of them</font>

109
00:05:17,319 --> 00:05:22,629
seemed<font color="#CCCCCC"> to</font><font color="#E5E5E5"> be downloaders the real</font>

110
00:05:19,779 --> 00:05:24,969
payloads<font color="#E5E5E5"> few and far</font><font color="#CCCCCC"> in between and</font>

111
00:05:22,629 --> 00:05:27,250
<font color="#E5E5E5">that's kind just to play with the</font>

112
00:05:24,969 --> 00:05:29,909
<font color="#CCCCCC">numbers I can</font><font color="#E5E5E5"> say that the real payloads</font>

113
00:05:27,250 --> 00:05:34,029
were probably<font color="#E5E5E5"> less than 40 samples total</font>

114
00:05:29,909 --> 00:05:38,589
so that<font color="#E5E5E5"> was a little bit suggesting that</font>

115
00:05:34,029 --> 00:05:40,479
it might be a staged approach first

116
00:05:38,589 --> 00:05:44,349
about a couple of obfuscation<font color="#E5E5E5"> techniques</font>

117
00:05:40,479 --> 00:05:46,930
<font color="#CCCCCC">I'm not going</font><font color="#E5E5E5"> to tell kind of which part</font>

118
00:05:44,349 --> 00:05:49,509
<font color="#E5E5E5">or which module had what techniques I</font>

119
00:05:46,930 --> 00:05:52,839
was more like combining<font color="#E5E5E5"> all the</font>

120
00:05:49,509 --> 00:05:55,750
techniques is collecting them here so

121
00:05:52,839 --> 00:05:59,500
<font color="#E5E5E5">these might or might not be all used</font><font color="#CCCCCC"> by</font>

122
00:05:55,750 --> 00:06:02,949
<font color="#E5E5E5">the different samples the cool</font><font color="#CCCCCC"> the kind</font>

123
00:05:59,500 --> 00:06:05,110
<font color="#E5E5E5">of cool push</font><font color="#CCCCCC"> Office keishon is a very</font>

124
00:06:02,949 --> 00:06:07,750
simplistic one I will<font color="#E5E5E5"> have a nicer</font>

125
00:06:05,110 --> 00:06:10,449
example for that and and explaining

126
00:06:07,750 --> 00:06:13,389
<font color="#E5E5E5">their fake API calls</font><font color="#CCCCCC"> nothing new there</font>

127
00:06:10,449 --> 00:06:15,819
<font color="#E5E5E5">kind of having fake code fake API names</font>

128
00:06:13,389 --> 00:06:18,009
<font color="#CCCCCC">the code is not being executed the</font>

129
00:06:15,819 --> 00:06:20,800
execution is jumping<font color="#E5E5E5"> over all those fake</font>

130
00:06:18,009 --> 00:06:24,159
API calls<font color="#E5E5E5"> janky instructions as having</font>

131
00:06:20,800 --> 00:06:26,589
the usual<font color="#E5E5E5"> knobs LEDs or any other fake</font>

132
00:06:24,159 --> 00:06:28,210
extraction<font color="#E5E5E5"> mask again</font><font color="#CCCCCC"> it's</font><font color="#E5E5E5"> jumping the</font>

133
00:06:26,589 --> 00:06:31,419
execution is jumping<font color="#E5E5E5"> over from down in</font>

134
00:06:28,210 --> 00:06:34,380
<font color="#CCCCCC">port</font><font color="#E5E5E5"> by hash once again kind</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> an on on</font>

135
00:06:31,419 --> 00:06:36,900
old<font color="#E5E5E5"> features or old technique</font>

136
00:06:34,380 --> 00:06:39,600
changing<font color="#CCCCCC"> equal resources</font><font color="#E5E5E5"> that's very</font>

137
00:06:36,900 --> 00:06:42,599
easily done<font color="#E5E5E5"> the same about randomizing</font>

138
00:06:39,600 --> 00:06:46,140
the the vs version info<font color="#CCCCCC"> there are no</font>

139
00:06:42,600 --> 00:06:48,720
real<font color="#CCCCCC"> on T debug or on T virtual machine</font>

140
00:06:46,140 --> 00:06:51,780
<font color="#CCCCCC">or sandbox tricks</font><font color="#E5E5E5"> probably that</font><font color="#CCCCCC"> was not</font>

141
00:06:48,720 --> 00:06:54,690
<font color="#E5E5E5">needed there is almost always very</font>

142
00:06:51,780 --> 00:06:57,210
<font color="#E5E5E5">simple encryption layer on top of</font><font color="#CCCCCC"> that</font>

143
00:06:54,690 --> 00:06:59,310
<font color="#E5E5E5">the compiled executables and it seems</font><font color="#CCCCCC"> to</font>

144
00:06:57,210 --> 00:07:02,010
<font color="#E5E5E5">be applied after</font><font color="#CCCCCC"> computation</font><font color="#E5E5E5"> I will</font>

145
00:06:59,310 --> 00:07:04,860
<font color="#E5E5E5">explain later why and in a couple</font><font color="#CCCCCC"> of</font>

146
00:07:02,010 --> 00:07:06,830
<font color="#E5E5E5">cases there is some</font><font color="#CCCCCC"> AV process names in</font>

147
00:07:04,860 --> 00:07:09,690
the<font color="#CCCCCC"> blacklist</font><font color="#E5E5E5"> so there is the extensive</font>

148
00:07:06,830 --> 00:07:13,169
<font color="#E5E5E5">black and white listing by these modules</font>

149
00:07:09,690 --> 00:07:15,570
the AV names are there not to make

150
00:07:13,170 --> 00:07:17,610
execution stop<font color="#E5E5E5"> but basically just to</font>

151
00:07:15,570 --> 00:07:21,659
prevent<font color="#E5E5E5"> those protests</font><font color="#CCCCCC"> cease to be</font>

152
00:07:17,610 --> 00:07:23,130
opened and there is an example of the

153
00:07:21,660 --> 00:07:25,260
first<font color="#E5E5E5"> kind of cold</font>

154
00:07:23,130 --> 00:07:28,050
push<font color="#CCCCCC"> off discussion I</font><font color="#E5E5E5"> know that it might</font>

155
00:07:25,260 --> 00:07:30,150
be challenging<font color="#E5E5E5"> to see it's actually if</font>

156
00:07:28,050 --> 00:07:32,910
you<font color="#E5E5E5"> are running or jumping the gun and</font>

157
00:07:30,150 --> 00:07:35,219
and loading<font color="#E5E5E5"> the sample into idea</font><font color="#CCCCCC"> Pro</font>

158
00:07:32,910 --> 00:07:37,560
this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> what you get</font><font color="#E5E5E5"> that's kind of your</font>

159
00:07:35,220 --> 00:07:39,690
entry point<font color="#E5E5E5"> but you can see on the</font>

160
00:07:37,560 --> 00:07:41,700
<font color="#CCCCCC">screen there</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> a load library there</font>

161
00:07:39,690 --> 00:07:44,250
is<font color="#E5E5E5"> a</font><font color="#CCCCCC"> gatos address</font><font color="#E5E5E5"> and there is a create</font>

162
00:07:41,700 --> 00:07:46,830
new tags<font color="#E5E5E5"> but basically you cannot really</font>

163
00:07:44,250 --> 00:07:50,130
see any any parameters being passed or

164
00:07:46,830 --> 00:07:53,030
anything<font color="#E5E5E5"> which is sensible so that's the</font>

165
00:07:50,130 --> 00:07:56,219
case when<font color="#E5E5E5"> you</font><font color="#CCCCCC"> are a little bit fast and</font>

166
00:07:53,030 --> 00:07:59,150
you<font color="#E5E5E5"> are using ID by default for</font>

167
00:07:56,220 --> 00:08:02,670
everything if you go back to a very<font color="#CCCCCC"> nice</font>

168
00:07:59,150 --> 00:08:06,719
<font color="#CCCCCC">old-fashioned</font><font color="#E5E5E5"> hex editor that's the same</font>

169
00:08:02,670 --> 00:08:09,410
code the ones who are reading writing

170
00:08:06,720 --> 00:08:12,480
assembly can see that that's actually<font color="#CCCCCC"> a</font>

171
00:08:09,410 --> 00:08:15,390
e8 that's a call<font color="#E5E5E5"> that's the same entry</font>

172
00:08:12,480 --> 00:08:17,640
point here you can see that there<font color="#CCCCCC"> is the</font>

173
00:08:15,390 --> 00:08:20,849
anti<font color="#E5E5E5"> DLL there is there are just</font>

174
00:08:17,640 --> 00:08:23,700
<font color="#E5E5E5">privileges API and there is a nice kind</font>

175
00:08:20,850 --> 00:08:27,120
of odd name for a blue<font color="#E5E5E5"> tags on the last</font>

176
00:08:23,700 --> 00:08:30,510
line so that's just an example<font color="#E5E5E5"> of</font><font color="#CCCCCC"> very</font>

177
00:08:27,120 --> 00:08:34,320
white<font color="#CCCCCC"> make sense to use different</font><font color="#E5E5E5"> tools</font>

178
00:08:30,510 --> 00:08:37,260
<font color="#E5E5E5">for the same task so the kind of the</font>

179
00:08:34,320 --> 00:08:39,690
first component<font color="#E5E5E5"> the downloader and I</font>

180
00:08:37,260 --> 00:08:41,490
would kind<font color="#CCCCCC"> of like to refer to</font><font color="#E5E5E5"> it as</font><font color="#CCCCCC"> a</font>

181
00:08:39,690 --> 00:08:44,460
tiny loader<font color="#CCCCCC"> because that's also</font>

182
00:08:41,490 --> 00:08:47,210
<font color="#CCCCCC">something from the past</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> we are</font><font color="#E5E5E5"> being</font>

183
00:08:44,460 --> 00:08:51,210
sure that this is the same family or

184
00:08:47,210 --> 00:08:53,040
derivation<font color="#E5E5E5"> from that one the downloader</font>

185
00:08:51,210 --> 00:08:55,710
is always having an additional

186
00:08:53,040 --> 00:08:58,500
<font color="#E5E5E5">encryption layer you can imagine that as</font>

187
00:08:55,710 --> 00:09:00,930
a kind<font color="#E5E5E5"> of a short</font><font color="#CCCCCC"> acts or decryption</font>

188
00:08:58,500 --> 00:09:02,640
loop that's usually added at the entry

189
00:09:00,930 --> 00:09:06,089
<font color="#CCCCCC">point or</font><font color="#E5E5E5"> score close to the entry point</font>

190
00:09:02,640 --> 00:09:09,210
and<font color="#E5E5E5"> it's just decrypting the additional</font>

191
00:09:06,090 --> 00:09:11,100
code nothing too complicated<font color="#E5E5E5"> it's very</font>

192
00:09:09,210 --> 00:09:13,470
<font color="#CCCCCC">basic Association technique so</font><font color="#E5E5E5"> you</font>

193
00:09:11,100 --> 00:09:15,560
cannot<font color="#E5E5E5"> really see the internal command</font>

194
00:09:13,470 --> 00:09:18,630
content by just using<font color="#CCCCCC"> the hex editor</font>

195
00:09:15,560 --> 00:09:22,260
that<font color="#CCCCCC"> a node that</font><font color="#E5E5E5"> is supporting do LC to</font>

196
00:09:18,630 --> 00:09:25,980
IP addresses<font color="#E5E5E5"> actually there is a little</font>

197
00:09:22,260 --> 00:09:28,710
phobia<font color="#E5E5E5"> laziness on the side of the</font>

198
00:09:25,980 --> 00:09:31,860
developers<font color="#E5E5E5"> because most of the samples</font>

199
00:09:28,710 --> 00:09:34,920
<font color="#E5E5E5">are only utilizing one and even if you</font>

200
00:09:31,860 --> 00:09:36,900
are using if you are<font color="#CCCCCC"> using only one they</font>

201
00:09:34,920 --> 00:09:38,219
<font color="#E5E5E5">are having the same constants in the</font>

202
00:09:36,900 --> 00:09:40,800
code<font color="#CCCCCC"> so they were not cleaning up the</font>

203
00:09:38,220 --> 00:09:43,380
code to have a version where it's two IP

204
00:09:40,800 --> 00:09:45,359
<font color="#CCCCCC">addresses or have one</font><font color="#E5E5E5"> it's always</font>

205
00:09:43,380 --> 00:09:46,920
<font color="#E5E5E5">flipping back and forth but basically</font>

206
00:09:45,360 --> 00:09:48,900
they are<font color="#E5E5E5"> using two</font><font color="#CCCCCC"> or four times the</font>

207
00:09:46,920 --> 00:09:51,750
<font color="#E5E5E5">same constants and that's not a very</font>

208
00:09:48,900 --> 00:09:53,550
<font color="#CCCCCC">easy and convenient way for them the</font>

209
00:09:51,750 --> 00:09:55,050
main<font color="#CCCCCC"> purpose for the share code sorry</font>

210
00:09:53,550 --> 00:09:57,719
for the download<font color="#CCCCCC"> that is to retrieve a</font>

211
00:09:55,050 --> 00:10:00,300
<font color="#E5E5E5">shellcode and execute it I'm going to</font>

212
00:09:57,720 --> 00:10:02,970
talk<font color="#E5E5E5"> about that next later the share</font>

213
00:10:00,300 --> 00:10:05,250
code is also encrypted<font color="#CCCCCC"> saying</font><font color="#E5E5E5"> X or B</font><font color="#CCCCCC"> is</font>

214
00:10:02,970 --> 00:10:08,460
the encryption<font color="#E5E5E5"> nothing overcomplicated</font>

215
00:10:05,250 --> 00:10:10,860
and due<font color="#CCCCCC"> to the share code and due to</font>

216
00:10:08,460 --> 00:10:12,840
<font color="#CCCCCC">their</font><font color="#E5E5E5"> the structure of this the dollar</font>

217
00:10:10,860 --> 00:10:15,950
is capable<font color="#E5E5E5"> of running any custom share</font>

218
00:10:12,840 --> 00:10:20,900
code what you would like<font color="#E5E5E5"> to do</font><font color="#CCCCCC"> or</font>

219
00:10:15,950 --> 00:10:23,130
executor normal<font color="#E5E5E5"> P executable there are</font>

220
00:10:20,900 --> 00:10:26,160
<font color="#E5E5E5">suggesting that</font><font color="#CCCCCC"> date might be using it</font>

221
00:10:23,130 --> 00:10:28,290
<font color="#CCCCCC">for other</font><font color="#E5E5E5"> operations than their own but</font>

222
00:10:26,160 --> 00:10:31,400
we've<font color="#E5E5E5"> been dealing</font><font color="#CCCCCC"> with one type of</font>

223
00:10:28,290 --> 00:10:35,339
share codes<font color="#CCCCCC"> during</font><font color="#E5E5E5"> your investigation</font>

224
00:10:31,400 --> 00:10:37,770
about<font color="#E5E5E5"> the situation at roses the IPS are</font>

225
00:10:35,340 --> 00:10:40,050
usually lasting for a period<font color="#E5E5E5"> of time</font>

226
00:10:37,770 --> 00:10:43,610
<font color="#E5E5E5">that means that a couple of months</font><font color="#CCCCCC"> or</font>

227
00:10:40,050 --> 00:10:45,930
some older<font color="#CCCCCC"> eyepiece might be coming</font><font color="#E5E5E5"> back</font>

228
00:10:43,610 --> 00:10:49,440
whatever is changing those are the<font color="#E5E5E5"> ports</font>

229
00:10:45,930 --> 00:10:52,140
<font color="#CCCCCC">so if you are looking at samples</font><font color="#E5E5E5"> in kind</font>

230
00:10:49,440 --> 00:10:54,540
of<font color="#E5E5E5"> in a timeline fashion then we could</font>

231
00:10:52,140 --> 00:10:57,519
see<font color="#E5E5E5"> that ports are changing likely by</font>

232
00:10:54,540 --> 00:11:00,040
one increment<font color="#E5E5E5"> or by two increments</font>

233
00:10:57,519 --> 00:11:03,420
those campaigns are kind<font color="#E5E5E5"> of dying off</font>

234
00:11:00,040 --> 00:11:06,310
every second day or<font color="#E5E5E5"> every next week and</font>

235
00:11:03,420 --> 00:11:10,060
just<font color="#E5E5E5"> a new one arriving with the same IP</font>

236
00:11:06,310 --> 00:11:12,910
address but a new port so<font color="#E5E5E5"> about a little</font>

237
00:11:10,060 --> 00:11:15,609
<font color="#E5E5E5">bit about the share code</font><font color="#CCCCCC"> I said the</font>

238
00:11:12,910 --> 00:11:19,269
<font color="#CCCCCC">shackle is being built up from multiple</font>

239
00:11:15,610 --> 00:11:21,100
fractures<font color="#CCCCCC"> when I'm saying</font><font color="#E5E5E5"> share code and</font>

240
00:11:19,269 --> 00:11:24,069
when people<font color="#E5E5E5"> are</font><font color="#CCCCCC"> thinking of</font><font color="#E5E5E5"> share code</font>

241
00:11:21,100 --> 00:11:26,470
you are<font color="#E5E5E5"> thinking of</font><font color="#CCCCCC"> something</font><font color="#E5E5E5"> very short</font>

242
00:11:24,069 --> 00:11:29,019
or and and very basic<font color="#E5E5E5"> functionality</font><font color="#CCCCCC"> just</font>

243
00:11:26,470 --> 00:11:32,470
a couple<font color="#E5E5E5"> of</font><font color="#CCCCCC"> hundred of bytes</font><font color="#E5E5E5"> this is</font>

244
00:11:29,019 --> 00:11:37,509
slightly different<font color="#CCCCCC"> here so this is kind</font>

245
00:11:32,470 --> 00:11:39,699
of the hugs dump of<font color="#E5E5E5"> a sort of first</font>

246
00:11:37,509 --> 00:11:43,300
level share<font color="#E5E5E5"> code as you can see this is</font>

247
00:11:39,699 --> 00:11:46,359
not<font color="#E5E5E5"> that tiny it's not really readable</font>

248
00:11:43,300 --> 00:11:50,229
but there are lots of API names there

249
00:11:46,360 --> 00:11:53,740
<font color="#CCCCCC">are some</font><font color="#E5E5E5"> interesting strings what</font>

250
00:11:50,230 --> 00:11:55,839
happens in reality<font color="#E5E5E5"> is if the downloader</font>

251
00:11:53,740 --> 00:11:59,910
can connect<font color="#E5E5E5"> to your</font><font color="#CCCCCC"> c2 and the</font>

252
00:11:55,839 --> 00:12:03,069
connection is<font color="#E5E5E5"> established it's sending</font>

253
00:11:59,910 --> 00:12:05,199
data there and then trying to<font color="#E5E5E5"> retrieve</font>

254
00:12:03,069 --> 00:12:07,300
something<font color="#E5E5E5"> so</font><font color="#CCCCCC"> and retrieving it's only</font>

255
00:12:05,199 --> 00:12:10,630
downloading like a couple of<font color="#E5E5E5"> hundred</font>

256
00:12:07,300 --> 00:12:12,370
bytes per each Ram and then that's

257
00:12:10,630 --> 00:12:14,949
already a<font color="#E5E5E5"> share code and some</font><font color="#CCCCCC"> additional</font>

258
00:12:12,370 --> 00:12:17,230
data<font color="#E5E5E5"> so like one piece of couple of</font>

259
00:12:14,949 --> 00:12:19,750
hundred bytes is going to build up<font color="#E5E5E5"> this</font>

260
00:12:17,230 --> 00:12:22,209
<font color="#CCCCCC">whole piece by copying the rest of the</font>

261
00:12:19,750 --> 00:12:25,449
content<font color="#E5E5E5"> to a certain memory location and</font>

262
00:12:22,209 --> 00:12:28,750
then giving back the<font color="#CCCCCC"> signal that yeah I</font>

263
00:12:25,449 --> 00:12:33,609
need another piece of<font color="#E5E5E5"> this this one</font><font color="#CCCCCC"> is</font>

264
00:12:28,750 --> 00:12:36,100
probably after<font color="#E5E5E5"> like six or seven piece</font>

265
00:12:33,610 --> 00:12:38,319
<font color="#E5E5E5">collected together once it was complete</font>

266
00:12:36,100 --> 00:12:42,100
<font color="#E5E5E5">the execution is being passed over to</font>

267
00:12:38,319 --> 00:12:44,969
that it's pretty much just resolving

268
00:12:42,100 --> 00:12:48,220
those API names<font color="#CCCCCC"> and</font><font color="#E5E5E5"> also having</font>

269
00:12:44,970 --> 00:12:51,069
<font color="#E5E5E5">processed blacklisting or process</font>

270
00:12:48,220 --> 00:12:53,980
filtering that can be shown a<font color="#E5E5E5"> little bit</font>

271
00:12:51,069 --> 00:12:56,979
in a more readable form here<font color="#E5E5E5"> so it's</font>

272
00:12:53,980 --> 00:12:59,800
basically kind of<font color="#E5E5E5"> easy to see a certain</font>

273
00:12:56,980 --> 00:13:02,800
system process names<font color="#E5E5E5"> only using like</font>

274
00:12:59,800 --> 00:13:05,559
four characters for those and if those

275
00:13:02,800 --> 00:13:08,258
processes<font color="#CCCCCC"> found then those are being</font>

276
00:13:05,559 --> 00:13:10,630
skipped if the process<font color="#CCCCCC"> is</font><font color="#E5E5E5"> not on the</font>

277
00:13:08,259 --> 00:13:11,440
kind of<font color="#E5E5E5"> blacklist then that's going to</font>

278
00:13:10,630 --> 00:13:14,830
<font color="#CCCCCC">be</font>

279
00:13:11,440 --> 00:13:17,710
<font color="#E5E5E5">they're downloaded and the</font><font color="#CCCCCC"> share could</font>

280
00:13:14,830 --> 00:13:19,360
has a certain way<font color="#CCCCCC"> of interaction</font><font color="#E5E5E5"> so it's</font>

281
00:13:17,710 --> 00:13:21,100
it's<font color="#E5E5E5"> not</font><font color="#CCCCCC"> like the download</font><font color="#E5E5E5"> that is</font>

282
00:13:19,360 --> 00:13:22,510
passing over execution to<font color="#E5E5E5"> the share code</font>

283
00:13:21,100 --> 00:13:24,460
and then a share code<font color="#CCCCCC"> does whatever it</font>

284
00:13:22,510 --> 00:13:26,980
<font color="#CCCCCC">wants the share code can also give back</font>

285
00:13:24,460 --> 00:13:29,380
<font color="#E5E5E5">information to the Davo there so after</font>

286
00:13:26,980 --> 00:13:31,240
the kind<font color="#E5E5E5"> of thoughts is blacklisting</font><font color="#CCCCCC"> it</font>

287
00:13:29,380 --> 00:13:34,000
was<font color="#E5E5E5"> gathering all the process names on</font>

288
00:13:31,240 --> 00:13:38,530
<font color="#CCCCCC">your computer then passing that</font><font color="#E5E5E5"> back to</font>

289
00:13:34,000 --> 00:13:41,740
the<font color="#E5E5E5"> c2 in a list and if you are nice</font>

290
00:13:38,530 --> 00:13:45,069
victim then you get<font color="#E5E5E5"> something back as</font>

291
00:13:41,740 --> 00:13:47,310
for the second part<font color="#E5E5E5"> so this is once</font>

292
00:13:45,070 --> 00:13:50,530
<font color="#E5E5E5">again being built</font><font color="#CCCCCC"> from fractures and</font>

293
00:13:47,310 --> 00:13:55,000
this is actually a full<font color="#E5E5E5"> download their</font>

294
00:13:50,530 --> 00:13:56,709
share code so<font color="#CCCCCC"> that story is not ending</font>

295
00:13:55,000 --> 00:13:59,590
here<font color="#CCCCCC"> because this is capable</font><font color="#E5E5E5"> of</font>

296
00:13:56,710 --> 00:14:02,470
<font color="#CCCCCC">downloading something unless</font><font color="#E5E5E5"> you are</font>

297
00:13:59,590 --> 00:14:05,740
also receiving an additional IP address

298
00:14:02,470 --> 00:14:08,380
a port<font color="#CCCCCC"> or fine name and or an actual URL</font>

299
00:14:05,740 --> 00:14:11,020
<font color="#E5E5E5">it wouldn't do anything for you so if</font>

300
00:14:08,380 --> 00:14:13,660
you<font color="#E5E5E5"> are not one of the targets they are</font>

301
00:14:11,020 --> 00:14:15,280
looking for the<font color="#E5E5E5"> next check would after</font>

302
00:14:13,660 --> 00:14:18,160
this what you are getting back is

303
00:14:15,280 --> 00:14:20,740
basically a nice sleep of couple<font color="#E5E5E5"> of</font>

304
00:14:18,160 --> 00:14:23,050
minutes<font color="#CCCCCC"> then a nice tip of couple</font><font color="#E5E5E5"> of</font>

305
00:14:20,740 --> 00:14:25,660
hours and then I on I sleep of couple of

306
00:14:23,050 --> 00:14:27,939
hours and<font color="#E5E5E5"> it goes on so it wouldn't</font>

307
00:14:25,660 --> 00:14:30,760
really<font color="#E5E5E5"> exit from memory but it would be</font>

308
00:14:27,940 --> 00:14:34,630
just<font color="#CCCCCC"> waiting for for another command</font><font color="#E5E5E5"> or</font>

309
00:14:30,760 --> 00:14:40,990
maybe<font color="#E5E5E5"> that they are trying to send you a</font>

310
00:14:34,630 --> 00:14:44,080
different type of payload so<font color="#CCCCCC"> the next</font>

311
00:14:40,990 --> 00:14:47,380
<font color="#E5E5E5">model is</font><font color="#CCCCCC"> discount</font><font color="#E5E5E5"> it's basically it's</font>

312
00:14:44,080 --> 00:14:50,380
having two times<font color="#E5E5E5"> they are both very easy</font>

313
00:14:47,380 --> 00:14:52,870
pieces<font color="#E5E5E5"> of code and basically the type a</font>

314
00:14:50,380 --> 00:14:55,780
is<font color="#E5E5E5"> just collecting</font><font color="#CCCCCC"> the running</font><font color="#E5E5E5"> process</font>

315
00:14:52,870 --> 00:14:57,130
name so it's a small executable looking

316
00:14:55,780 --> 00:14:59,350
at<font color="#E5E5E5"> looking through over your process</font>

317
00:14:57,130 --> 00:15:01,510
names<font color="#E5E5E5"> and basically making a list of</font>

318
00:14:59,350 --> 00:15:03,700
that it's<font color="#E5E5E5"> trying to open all the</font>

319
00:15:01,510 --> 00:15:06,580
processes if there is an error there<font color="#CCCCCC"> is</font>

320
00:15:03,700 --> 00:15:09,430
a flag of<font color="#CCCCCC"> EOF like</font><font color="#E5E5E5"> for fail they were</font>

321
00:15:06,580 --> 00:15:11,470
changing it<font color="#E5E5E5"> sometimes for whatever</font>

322
00:15:09,430 --> 00:15:13,540
reason if it could<font color="#E5E5E5"> be</font><font color="#CCCCCC"> open then it's a</font>

323
00:15:11,470 --> 00:15:15,730
low and then<font color="#E5E5E5"> it's building up a list of</font>

324
00:15:13,540 --> 00:15:18,640
all the process names and the flags<font color="#E5E5E5"> and</font>

325
00:15:15,730 --> 00:15:21,699
sending back<font color="#CCCCCC"> to another situ so</font>

326
00:15:18,640 --> 00:15:24,579
basically it's very<font color="#E5E5E5"> easy mapping of your</font>

327
00:15:21,699 --> 00:15:28,329
running processes<font color="#CCCCCC"> Tybee is a little bit</font>

328
00:15:24,579 --> 00:15:33,040
more complex<font color="#E5E5E5"> but just a</font><font color="#CCCCCC"> little bit more</font>

329
00:15:28,329 --> 00:15:35,888
<font color="#E5E5E5">and it's more targeted so</font><font color="#CCCCCC"> Tybee is also</font>

330
00:15:33,040 --> 00:15:38,079
having a huge list of POS<font color="#E5E5E5"> process names</font>

331
00:15:35,889 --> 00:15:41,980
and it's also<font color="#E5E5E5"> doing some</font><font color="#CCCCCC"> additional</font>

332
00:15:38,079 --> 00:15:43,839
tricks<font color="#E5E5E5"> like getting the name of the PC</font>

333
00:15:41,980 --> 00:15:45,699
and<font color="#E5E5E5"> also doing a network map that's</font>

334
00:15:43,839 --> 00:15:48,399
<font color="#E5E5E5">actually usually think of simplistic</font>

335
00:15:45,699 --> 00:15:51,790
that not view for that<font color="#CCCCCC"> and</font><font color="#E5E5E5"> also doing</font>

336
00:15:48,399 --> 00:15:53,649
the<font color="#CCCCCC"> same process walkthrough but</font><font color="#E5E5E5"> this</font>

337
00:15:51,790 --> 00:15:58,209
time it's<font color="#CCCCCC"> only looking for processes</font>

338
00:15:53,649 --> 00:16:02,439
from<font color="#E5E5E5"> the POS list and that P was</font><font color="#CCCCCC"> list</font><font color="#E5E5E5"> is</font>

339
00:15:58,209 --> 00:16:04,719
this<font color="#E5E5E5"> so to understand or put it into</font>

340
00:16:02,439 --> 00:16:07,449
context you have<font color="#CCCCCC"> to know that</font><font color="#E5E5E5"> there are</font>

341
00:16:04,720 --> 00:16:09,369
<font color="#CCCCCC">six characters for comparing one process</font>

342
00:16:07,449 --> 00:16:12,219
so they were not really bothering to

343
00:16:09,369 --> 00:16:14,889
have the whole long process names here

344
00:16:12,220 --> 00:16:16,839
why would<font color="#CCCCCC"> that be needed</font><font color="#E5E5E5"> they are only</font>

345
00:16:14,889 --> 00:16:19,899
comparing<font color="#E5E5E5"> like the first six characters</font>

346
00:16:16,839 --> 00:16:21,609
of every<font color="#E5E5E5"> process name if</font><font color="#CCCCCC"> we do the math</font>

347
00:16:19,899 --> 00:16:25,149
because<font color="#E5E5E5"> actually I know the size of that</font>

348
00:16:21,609 --> 00:16:30,999
that means<font color="#E5E5E5"> that that list contains over</font>

349
00:16:25,149 --> 00:16:35,639
<font color="#E5E5E5">300 actually 327 POS names so that's</font><font color="#CCCCCC"> a</font>

350
00:16:30,999 --> 00:16:39,039
really an<font color="#E5E5E5"> eye-opener because</font><font color="#CCCCCC"> in reality</font>

351
00:16:35,639 --> 00:16:40,989
if you<font color="#CCCCCC"> are</font><font color="#E5E5E5"> going for a new</font><font color="#CCCCCC"> business as</font>

352
00:16:39,039 --> 00:16:42,759
if you are<font color="#E5E5E5"> kind of buying a POS terminal</font>

353
00:16:40,989 --> 00:16:45,669
and all the hardware<font color="#CCCCCC"> and software</font>

354
00:16:42,759 --> 00:16:48,819
related<font color="#E5E5E5"> for that you have one POS system</font>

355
00:16:45,669 --> 00:16:50,649
running<font color="#E5E5E5"> there are no trial versions of</font>

356
00:16:48,819 --> 00:16:53,079
<font color="#CCCCCC">this software</font><font color="#E5E5E5"> so it's not like if</font><font color="#CCCCCC"> I'm</font>

357
00:16:50,649 --> 00:16:57,009
<font color="#E5E5E5">asking you to</font><font color="#CCCCCC"> collect me like</font><font color="#E5E5E5"> the the</font>

358
00:16:53,079 --> 00:16:58,809
top<font color="#CCCCCC"> 10 simplistic graphics editors on</font>

359
00:16:57,009 --> 00:17:00,910
the net<font color="#E5E5E5"> you can easily kind of grab</font>

360
00:16:58,809 --> 00:17:03,399
those<font color="#E5E5E5"> install those check what</font>

361
00:17:00,910 --> 00:17:06,129
<font color="#CCCCCC">percentage</font><font color="#E5E5E5"> they are using here it's much</font>

362
00:17:03,399 --> 00:17:08,380
more<font color="#E5E5E5"> complex because you</font><font color="#CCCCCC"> need to</font><font color="#E5E5E5"> spend</font>

363
00:17:06,130 --> 00:17:10,059
money<font color="#E5E5E5"> and invest money or you have to</font>

364
00:17:08,380 --> 00:17:11,829
start<font color="#CCCCCC"> mapping a lot of networks and</font>

365
00:17:10,059 --> 00:17:14,760
looking for process names so this alone

366
00:17:11,829 --> 00:17:17,260
indicates<font color="#E5E5E5"> that whoever is behind this</font>

367
00:17:14,760 --> 00:17:19,269
<font color="#E5E5E5">these modules and these campaigns they</font>

368
00:17:17,260 --> 00:17:21,490
are they were not starting<font color="#E5E5E5"> it today or</font>

369
00:17:19,269 --> 00:17:25,149
the week<font color="#CCCCCC"> before</font><font color="#E5E5E5"> but likely doing it for</font>

370
00:17:21,490 --> 00:17:28,840
a couple<font color="#CCCCCC"> of years or more</font><font color="#E5E5E5"> and then</font>

371
00:17:25,148 --> 00:17:30,520
finally the POS model itself a little

372
00:17:28,840 --> 00:17:32,169
bit<font color="#E5E5E5"> strangely but</font>

373
00:17:30,520 --> 00:17:34,990
maybe not that<font color="#CCCCCC"> strange it is</font><font color="#E5E5E5"> not</font>

374
00:17:32,170 --> 00:17:37,330
utilizing<font color="#E5E5E5"> any encryption basically if</font>

375
00:17:34,990 --> 00:17:39,520
someone<font color="#E5E5E5"> is reaching or a piece is</font>

376
00:17:37,330 --> 00:17:41,350
reaching this point<font color="#E5E5E5"> then they are almost</font>

377
00:17:39,520 --> 00:17:43,929
<font color="#CCCCCC">very sure that they are a couple</font><font color="#E5E5E5"> of</font>

378
00:17:41,350 --> 00:17:46,330
target<font color="#E5E5E5"> solid that's likely a POS</font>

379
00:17:43,929 --> 00:17:49,420
terminal there is no analyst<font color="#E5E5E5"> sitting in</font>

380
00:17:46,330 --> 00:17:51,220
front of the<font color="#CCCCCC"> PFC</font><font color="#E5E5E5"> most of the time there</font>

381
00:17:49,420 --> 00:17:53,530
<font color="#E5E5E5">is</font><font color="#CCCCCC"> no</font><font color="#E5E5E5"> heavy installed or anything like</font>

382
00:17:51,220 --> 00:17:55,690
<font color="#E5E5E5">that</font><font color="#CCCCCC"> why would they be hiding</font><font color="#E5E5E5"> anything</font>

383
00:17:53,530 --> 00:17:57,700
<font color="#CCCCCC">in the in the binary</font><font color="#E5E5E5"> they could be</font>

384
00:17:55,690 --> 00:18:00,390
applying the very same simplistic<font color="#E5E5E5"> axes</font>

385
00:17:57,700 --> 00:18:02,380
or they decide not<font color="#CCCCCC"> to do that</font>

386
00:18:00,390 --> 00:18:05,650
the main point the purpose of this

387
00:18:02,380 --> 00:18:09,850
<font color="#CCCCCC">module</font><font color="#E5E5E5"> is but</font><font color="#CCCCCC"> overall the kind of old</font>

388
00:18:05,650 --> 00:18:12,130
<font color="#E5E5E5">other POS</font><font color="#CCCCCC"> moreover</font><font color="#E5E5E5"> we are doing</font><font color="#CCCCCC"> it's</font>

389
00:18:09,850 --> 00:18:14,290
tracking and collecting the track 1 and

390
00:18:12,130 --> 00:18:17,260
track 2 credit<font color="#CCCCCC"> card data from memory</font>

391
00:18:14,290 --> 00:18:20,110
<font color="#E5E5E5">and using</font><font color="#CCCCCC"> then</font><font color="#E5E5E5"> that sending those to the</font>

392
00:18:17,260 --> 00:18:22,150
<font color="#E5E5E5">C to</font><font color="#CCCCCC"> the previous model can</font><font color="#E5E5E5"> also kind of</font>

393
00:18:20,110 --> 00:18:24,909
<font color="#E5E5E5">quantity a black and white list as seen</font>

394
00:18:22,150 --> 00:18:28,600
before<font color="#E5E5E5"> in the</font><font color="#CCCCCC"> feeder</font><font color="#E5E5E5"> share code and with</font>

395
00:18:24,910 --> 00:18:30,940
the<font color="#CCCCCC"> letter scout sometimes they have a</font>

396
00:18:28,600 --> 00:18:32,379
short list of POS names<font color="#E5E5E5"> sometimes</font><font color="#CCCCCC"> they</font>

397
00:18:30,940 --> 00:18:34,990
have a<font color="#CCCCCC"> longer list sometimes they do</font>

398
00:18:32,380 --> 00:18:37,360
also<font color="#CCCCCC"> have a black</font><font color="#E5E5E5"> list for processes not</font>

399
00:18:34,990 --> 00:18:39,910
to be opened<font color="#CCCCCC"> and sometimes</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> internal</font>

400
00:18:37,360 --> 00:18:43,449
<font color="#E5E5E5">kind of combining the</font><font color="#CCCCCC"> two it's always</font>

401
00:18:39,910 --> 00:18:46,270
different<font color="#E5E5E5"> having</font><font color="#CCCCCC"> said that it's</font><font color="#E5E5E5"> the</font>

402
00:18:43,450 --> 00:18:48,460
basic memory<font color="#E5E5E5"> scraper that</font><font color="#CCCCCC"> is still so</font>

403
00:18:46,270 --> 00:18:50,440
minor maintenance going on on<font color="#E5E5E5"> a code</font>

404
00:18:48,460 --> 00:18:53,110
level<font color="#E5E5E5"> I'm going</font><font color="#CCCCCC"> to show an example for</font>

405
00:18:50,440 --> 00:18:55,750
<font color="#E5E5E5">that and it's actually</font><font color="#CCCCCC"> a multi-threaded</font>

406
00:18:53,110 --> 00:18:59,919
<font color="#E5E5E5">memory scanning so whenever one process</font>

407
00:18:55,750 --> 00:19:01,600
is found to be<font color="#E5E5E5"> interesting and</font><font color="#CCCCCC"> it's</font>

408
00:18:59,920 --> 00:19:03,309
either not on<font color="#E5E5E5"> the</font><font color="#CCCCCC"> black list</font><font color="#E5E5E5"> or</font><font color="#CCCCCC"> it's</font>

409
00:19:01,600 --> 00:19:05,409
included<font color="#CCCCCC"> in a varieties</font><font color="#E5E5E5"> that's going to</font>

410
00:19:03,309 --> 00:19:07,750
be opened<font color="#E5E5E5"> and the new thread is</font><font color="#CCCCCC"> going to</font>

411
00:19:05,410 --> 00:19:10,480
be started and all that data is<font color="#CCCCCC"> going to</font>

412
00:19:07,750 --> 00:19:13,929
be scanned or whatever and whatever the

413
00:19:10,480 --> 00:19:16,990
accessible there is the<font color="#CCCCCC"> example for</font>

414
00:19:13,929 --> 00:19:18,340
track<font color="#CCCCCC"> 1 and track 2 data</font><font color="#E5E5E5"> so whoever was</font>

415
00:19:16,990 --> 00:19:21,820
not<font color="#E5E5E5"> dealing</font><font color="#CCCCCC"> with Pugh has probably never</font>

416
00:19:18,340 --> 00:19:25,178
seen<font color="#CCCCCC"> these</font><font color="#E5E5E5"> this is basically what goes</font>

417
00:19:21,820 --> 00:19:28,000
<font color="#CCCCCC">through on the wire then you are using</font>

418
00:19:25,179 --> 00:19:30,730
the<font color="#CCCCCC"> old-fashioned magic mode magnetic</font>

419
00:19:28,000 --> 00:19:33,670
stripe card payment so as you can<font color="#CCCCCC"> see</font>

420
00:19:30,730 --> 00:19:38,080
this is kind<font color="#CCCCCC"> of plain text</font><font color="#E5E5E5"> no encryption</font>

421
00:19:33,670 --> 00:19:40,570
<font color="#CCCCCC">nothing else</font><font color="#E5E5E5"> all the vital data needed</font>

422
00:19:38,080 --> 00:19:43,600
to complete another transaction<font color="#E5E5E5"> is there</font>

423
00:19:40,570 --> 00:19:46,780
<font color="#E5E5E5">so if you can steal</font><font color="#CCCCCC"> that you can kind</font><font color="#E5E5E5"> of</font>

424
00:19:43,600 --> 00:19:50,110
<font color="#E5E5E5">clone a card or use</font><font color="#CCCCCC"> that data</font><font color="#E5E5E5"> for other</font>

425
00:19:46,780 --> 00:19:53,320
transactions<font color="#E5E5E5"> and this is what's actually</font>

426
00:19:50,110 --> 00:19:56,649
being extracted from running the POS

427
00:19:53,320 --> 00:19:59,649
module before encryption the previous

428
00:19:56,650 --> 00:20:02,049
model is<font color="#E5E5E5"> using a basic XOR before</font>

429
00:19:59,650 --> 00:20:04,030
sending that<font color="#E5E5E5"> over to the</font><font color="#CCCCCC"> situ but that</font>

430
00:20:02,049 --> 00:20:06,100
just for<font color="#E5E5E5"> likely for the DLP</font><font color="#CCCCCC"> and other</font>

431
00:20:04,030 --> 00:20:09,250
<font color="#CCCCCC">system so they are not flagging the</font>

432
00:20:06,100 --> 00:20:11,320
traffic as credit card data<font color="#E5E5E5"> as you</font><font color="#CCCCCC"> can</font>

433
00:20:09,250 --> 00:20:14,320
see I wasn't<font color="#CCCCCC"> using the very same card</font>

434
00:20:11,320 --> 00:20:17,320
number<font color="#CCCCCC"> but basically it's attracted to</font>

435
00:20:14,320 --> 00:20:20,020
data and there is a<font color="#E5E5E5"> process name listed</font>

436
00:20:17,320 --> 00:20:23,049
what was my test<font color="#CCCCCC"> be us and the hittable</font>

437
00:20:20,020 --> 00:20:25,330
which was<font color="#E5E5E5"> nothing sort of fancy it was</font>

438
00:20:23,049 --> 00:20:27,539
<font color="#E5E5E5">actually a notepad</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> I was pasting</font>

439
00:20:25,330 --> 00:20:31,720
that just for memory scraping purposes

440
00:20:27,539 --> 00:20:37,179
and then one bit<font color="#CCCCCC"> of evil evolution from</font>

441
00:20:31,720 --> 00:20:40,360
the POS part<font color="#E5E5E5"> so on the left</font><font color="#CCCCCC"> you can see</font>

442
00:20:37,179 --> 00:20:43,570
<font color="#CCCCCC">that this is part of the the memory</font>

443
00:20:40,360 --> 00:20:46,090
scanning procedure<font color="#E5E5E5"> there is a memory</font>

444
00:20:43,570 --> 00:20:48,280
<font color="#E5E5E5">read after the</font><font color="#CCCCCC"> memory read there are</font>

445
00:20:46,090 --> 00:20:51,100
certain checks<font color="#CCCCCC"> and on the bottom</font><font color="#E5E5E5"> you can</font>

446
00:20:48,280 --> 00:20:54,820
<font color="#E5E5E5">see byte compares those are basically</font>

447
00:20:51,100 --> 00:20:58,209
looking<font color="#E5E5E5"> for digits so it's likely three</font>

448
00:20:54,820 --> 00:21:00,789
<font color="#E5E5E5">four five six those are the usual digits</font>

449
00:20:58,210 --> 00:21:02,860
for your credit card<font color="#E5E5E5"> that's that's just</font>

450
00:21:00,789 --> 00:21:06,340
<font color="#E5E5E5">kind of</font><font color="#CCCCCC"> distorting numbers</font><font color="#E5E5E5"> there is a</font>

451
00:21:02,860 --> 00:21:08,770
whole<font color="#CCCCCC"> lung of parsing code beyond that</font>

452
00:21:06,340 --> 00:21:10,899
point<font color="#E5E5E5"> so looking for all the specific</font>

453
00:21:08,770 --> 00:21:14,918
and and special characters<font color="#CCCCCC"> from the</font>

454
00:21:10,900 --> 00:21:18,340
<font color="#CCCCCC">previous slide</font><font color="#E5E5E5"> and validating it all but</font>

455
00:21:14,919 --> 00:21:20,980
this<font color="#CCCCCC"> is where there was actually</font><font color="#E5E5E5"> some</font>

456
00:21:18,340 --> 00:21:24,720
improvement<font color="#E5E5E5"> so on the right you</font><font color="#CCCCCC"> can</font><font color="#E5E5E5"> see</font>

457
00:21:20,980 --> 00:21:28,419
the<font color="#E5E5E5"> very</font><font color="#CCCCCC"> same code except that there are</font>

458
00:21:24,720 --> 00:21:33,220
<font color="#E5E5E5">five more conditions and actually it</font>

459
00:21:28,419 --> 00:21:34,960
seems<font color="#E5E5E5"> that by just reading memory either</font>

460
00:21:33,220 --> 00:21:38,110
<font color="#CCCCCC">it's running on an exception sometimes</font>

461
00:21:34,960 --> 00:21:40,299
or<font color="#E5E5E5"> the timing</font><font color="#CCCCCC"> is key because</font><font color="#E5E5E5"> on the</font><font color="#CCCCCC"> old</font>

462
00:21:38,110 --> 00:21:42,820
<font color="#E5E5E5">sample on</font><font color="#CCCCCC"> the LAT one that's was from</font>

463
00:21:40,299 --> 00:21:44,740
like<font color="#CCCCCC"> January or February this year</font><font color="#E5E5E5"> they</font>

464
00:21:42,820 --> 00:21:47,379
were almost reading like<font color="#E5E5E5"> 400 kilobytes</font>

465
00:21:44,740 --> 00:21:49,690
<font color="#CCCCCC">and then having one millisecond of sleep</font>

466
00:21:47,380 --> 00:21:53,620
that's<font color="#E5E5E5"> not really a long one on the</font>

467
00:21:49,690 --> 00:21:55,720
right<font color="#E5E5E5"> they do that a lot more</font><font color="#CCCCCC"> frequently</font>

468
00:21:53,620 --> 00:21:57,129
<font color="#E5E5E5">so</font><font color="#CCCCCC"> likely they are testing</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> and a</font>

469
00:21:55,720 --> 00:21:57,530
lot<font color="#CCCCCC"> of systems</font><font color="#E5E5E5"> and they are</font><font color="#CCCCCC"> trying</font><font color="#E5E5E5"> to</font>

470
00:21:57,130 --> 00:22:00,350
find

471
00:21:57,530 --> 00:22:03,590
- so it's not<font color="#E5E5E5"> resulting in an exception</font>

472
00:22:00,350 --> 00:22:05,689
it's not<font color="#E5E5E5"> having any memory reading</font>

473
00:22:03,590 --> 00:22:08,510
problems or anything like<font color="#E5E5E5"> that</font>

474
00:22:05,690 --> 00:22:11,360
beside this minor change<font color="#CCCCCC"> the</font><font color="#E5E5E5"> right hand</font>

475
00:22:08,510 --> 00:22:13,760
side sample is<font color="#E5E5E5"> very recent</font><font color="#CCCCCC"> it was from</font>

476
00:22:11,360 --> 00:22:19,820
September<font color="#CCCCCC"> and porcine coded everything</font>

477
00:22:13,760 --> 00:22:23,060
<font color="#E5E5E5">else is the same so basically what the</font>

478
00:22:19,820 --> 00:22:25,220
usual<font color="#CCCCCC"> operation our</font><font color="#E5E5E5"> workshop for them on</font>

479
00:22:23,060 --> 00:22:30,290
the<font color="#CCCCCC"> left we can see that there is</font><font color="#E5E5E5"> the</font>

480
00:22:25,220 --> 00:22:33,490
<font color="#CCCCCC">Scout</font><font color="#E5E5E5"> that would be mapping all the data</font>

481
00:22:30,290 --> 00:22:35,990
and all<font color="#CCCCCC"> the processes</font><font color="#E5E5E5"> what that they can</font>

482
00:22:33,490 --> 00:22:39,560
they were not converting that or or

483
00:22:35,990 --> 00:22:42,860
compiling<font color="#CCCCCC"> that into x64 there was no no</font>

484
00:22:39,560 --> 00:22:44,929
reason<font color="#E5E5E5"> the key it was always</font><font color="#CCCCCC"> static in</font>

485
00:22:42,860 --> 00:22:48,260
that case for for all<font color="#E5E5E5"> the samples we had</font>

486
00:22:44,930 --> 00:22:50,360
from<font color="#E5E5E5"> this year the port number was those</font>

487
00:22:48,260 --> 00:22:53,240
two<font color="#CCCCCC"> that was</font><font color="#E5E5E5"> also not really changing</font>

488
00:22:50,360 --> 00:22:56,979
<font color="#E5E5E5">and it's only a</font><font color="#CCCCCC"> very few IP addresses</font>

489
00:22:53,240 --> 00:22:59,990
they are using for<font color="#E5E5E5"> sending back the</font>

490
00:22:56,980 --> 00:23:01,580
<font color="#E5E5E5">processed</font><font color="#CCCCCC"> data so in their</font>

491
00:22:59,990 --> 00:23:04,310
infrastructure<font color="#E5E5E5"> they are trying to</font>

492
00:23:01,580 --> 00:23:07,790
distinguish which data goes to<font color="#E5E5E5"> where</font>

493
00:23:04,310 --> 00:23:09,679
<font color="#E5E5E5">it's there is kind of an overlap but but</font>

494
00:23:07,790 --> 00:23:12,710
they<font color="#E5E5E5"> are trying to distinguish the</font>

495
00:23:09,680 --> 00:23:14,000
different functions then of course if

496
00:23:12,710 --> 00:23:16,850
there is a good candidate<font color="#E5E5E5"> that is going</font>

497
00:23:14,000 --> 00:23:19,580
to be a downloader<font color="#E5E5E5"> the</font><font color="#CCCCCC"> downloader there</font>

498
00:23:16,850 --> 00:23:21,530
is no encryption<font color="#E5E5E5"> it's actually the brute</font>

499
00:23:19,580 --> 00:23:24,730
<font color="#E5E5E5">forcing of themselves so the top layer</font>

500
00:23:21,530 --> 00:23:27,350
the encryption is not<font color="#E5E5E5"> having any key</font>

501
00:23:24,730 --> 00:23:28,250
stored there is no need<font color="#E5E5E5"> it's just</font><font color="#CCCCCC"> doing</font>

502
00:23:27,350 --> 00:23:29,990
a<font color="#CCCCCC"> D word</font>

503
00:23:28,250 --> 00:23:32,540
brute force<font color="#CCCCCC"> which is</font><font color="#E5E5E5"> very fast on</font>

504
00:23:29,990 --> 00:23:35,360
current CPUs and then it can decrypt

505
00:23:32,540 --> 00:23:37,399
itself it's using many different port

506
00:23:35,360 --> 00:23:39,770
numbers<font color="#CCCCCC"> as I was stating that the port</font>

507
00:23:37,400 --> 00:23:42,440
number is frequently changing and it's

508
00:23:39,770 --> 00:23:44,389
<font color="#CCCCCC">using almost like ten different IP</font>

509
00:23:42,440 --> 00:23:46,520
addresses or that that was from<font color="#E5E5E5"> this</font>

510
00:23:44,390 --> 00:23:49,670
year and then finally you have<font color="#CCCCCC"> the POS</font>

511
00:23:46,520 --> 00:23:52,129
it having also<font color="#E5E5E5"> an M key for the</font>

512
00:23:49,670 --> 00:23:55,100
encryption for data sending back<font color="#E5E5E5"> to the</font>

513
00:23:52,130 --> 00:23:58,100
<font color="#CCCCCC">C</font><font color="#E5E5E5"> - it's multi-platform it's always</font>

514
00:23:55,100 --> 00:24:00,230
using<font color="#CCCCCC"> that very important umber</font><font color="#E5E5E5"> and it's</font>

515
00:23:58,100 --> 00:24:02,659
also a connecting to a very few ones<font color="#E5E5E5"> and</font>

516
00:24:00,230 --> 00:24:05,090
then if you get the<font color="#E5E5E5"> credit card data</font>

517
00:24:02,660 --> 00:24:08,210
than they do the cash out and the whole

518
00:24:05,090 --> 00:24:10,070
cycle goes back to the beginning<font color="#E5E5E5"> as you</font>

519
00:24:08,210 --> 00:24:14,840
<font color="#CCCCCC">could</font><font color="#E5E5E5"> see</font><font color="#CCCCCC"> from all the the P</font>

520
00:24:10,070 --> 00:24:17,389
process names<font color="#E5E5E5"> it's likely a lot of</font>

521
00:24:14,840 --> 00:24:19,639
cycles likely a hundreds or more of

522
00:24:17,390 --> 00:24:22,340
evolution and<font color="#E5E5E5"> constantly looking for new</font>

523
00:24:19,640 --> 00:24:24,830
possible targets<font color="#E5E5E5"> constantly mapping</font><font color="#CCCCCC"> pcs</font>

524
00:24:22,340 --> 00:24:29,060
and having a<font color="#E5E5E5"> good</font><font color="#CCCCCC"> understanding of</font><font color="#E5E5E5"> who</font>

525
00:24:24,830 --> 00:24:32,449
is a good candidate<font color="#CCCCCC"> and who is not so</font>

526
00:24:29,060 --> 00:24:36,590
what the problem is here<font color="#E5E5E5"> first there is</font>

527
00:24:32,450 --> 00:24:39,530
<font color="#E5E5E5">a the software side of things</font><font color="#CCCCCC"> and this</font>

528
00:24:36,590 --> 00:24:43,129
part<font color="#E5E5E5"> is starting with POS ready 2009 and</font>

529
00:24:39,530 --> 00:24:46,430
POS 37<font color="#E5E5E5"> so those are Microsoft platform</font>

530
00:24:43,130 --> 00:24:51,350
names<font color="#E5E5E5"> you can probably guess that P was</font>

531
00:24:46,430 --> 00:24:55,100
<font color="#CCCCCC">3</font><font color="#E5E5E5"> 2009 is XP based what a surprise</font><font color="#CCCCCC"> P was</font>

532
00:24:51,350 --> 00:24:58,219
37 is Windows 7 based one problem is

533
00:24:55,100 --> 00:25:01,820
<font color="#CCCCCC">that people are still using</font><font color="#E5E5E5"> the old our</font>

534
00:24:58,220 --> 00:25:05,690
<font color="#E5E5E5">POS platform and we've pretty much done</font>

535
00:25:01,820 --> 00:25:08,000
how secure<font color="#E5E5E5"> XP is the</font><font color="#CCCCCC"> other is that no</font>

536
00:25:05,690 --> 00:25:10,580
<font color="#E5E5E5">matter what you use soon they are going</font>

537
00:25:08,000 --> 00:25:12,800
<font color="#E5E5E5">to reach end-of-life they are already on</font>

538
00:25:10,580 --> 00:25:16,240
the extended<font color="#E5E5E5"> support and the deeds are</font>

539
00:25:12,800 --> 00:25:20,629
next April<font color="#CCCCCC"> for POS early 2009</font><font color="#E5E5E5"> and</font>

540
00:25:16,240 --> 00:25:23,660
sometimes<font color="#E5E5E5"> October in 2021</font><font color="#CCCCCC"> for the</font>

541
00:25:20,630 --> 00:25:25,490
<font color="#E5E5E5">windows</font><font color="#CCCCCC"> 7 based</font><font color="#E5E5E5"> one then a problem</font><font color="#CCCCCC"> is</font>

542
00:25:23,660 --> 00:25:28,430
<font color="#E5E5E5">that what we could</font><font color="#CCCCCC"> learn from past</font>

543
00:25:25,490 --> 00:25:30,290
<font color="#E5E5E5">experience that often there are remote</font>

544
00:25:28,430 --> 00:25:32,750
access applications being pre-installed

545
00:25:30,290 --> 00:25:34,090
on POS<font color="#E5E5E5"> terminals so that's not really a</font>

546
00:25:32,750 --> 00:25:36,860
surprise

547
00:25:34,090 --> 00:25:39,709
imagine your average IT administrator

548
00:25:36,860 --> 00:25:43,040
<font color="#CCCCCC">they don't want to kind of walk down to</font>

549
00:25:39,710 --> 00:25:45,740
<font color="#CCCCCC">all</font><font color="#E5E5E5"> the POS terminals updating whatever</font>

550
00:25:43,040 --> 00:25:47,570
<font color="#E5E5E5">software is running on them especially</font>

551
00:25:45,740 --> 00:25:50,300
<font color="#E5E5E5">kind of imaging something big in the</font>

552
00:25:47,570 --> 00:25:52,850
<font color="#CCCCCC">United States which is nationwide of</font>

553
00:25:50,300 --> 00:25:55,700
course they have moved to IT<font color="#CCCCCC"> stuff but</font>

554
00:25:52,850 --> 00:25:57,800
doing<font color="#E5E5E5"> that from</font><font color="#CCCCCC"> a central</font><font color="#E5E5E5"> location and</font>

555
00:25:55,700 --> 00:25:59,630
easily and conveniently<font color="#E5E5E5"> updating</font>

556
00:25:57,800 --> 00:26:03,110
software that's always good

557
00:25:59,630 --> 00:26:04,940
the problem is sometimes they as the IT

558
00:26:03,110 --> 00:26:06,620
<font color="#CCCCCC">people</font><font color="#E5E5E5"> sometimes they</font><font color="#CCCCCC"> forget to</font><font color="#E5E5E5"> change</font>

559
00:26:04,940 --> 00:26:09,410
default passwords<font color="#E5E5E5"> or use the same</font>

560
00:26:06,620 --> 00:26:12,050
password<font color="#CCCCCC"> for the whole country white</font>

561
00:26:09,410 --> 00:26:15,350
stuff and that's just providing an

562
00:26:12,050 --> 00:26:16,070
additional<font color="#E5E5E5"> attack surface the track want</font>

563
00:26:15,350 --> 00:26:17,600
to data

564
00:26:16,070 --> 00:26:20,210
<font color="#E5E5E5">lacking an encryption you could see that</font>

565
00:26:17,600 --> 00:26:21,590
it's kind<font color="#E5E5E5"> of plain text there</font><font color="#CCCCCC"> is nothing</font>

566
00:26:20,210 --> 00:26:25,220
<font color="#E5E5E5">more there the</font>

567
00:26:21,590 --> 00:26:26,928
you track<font color="#CCCCCC"> tree which is kind</font><font color="#E5E5E5"> of the EMV</font>

568
00:26:25,220 --> 00:26:31,610
base what I'm going<font color="#E5E5E5"> to talk about later</font>

569
00:26:26,929 --> 00:26:34,789
<font color="#CCCCCC">that's using three deaths</font><font color="#E5E5E5"> RSA and AES so</font>

570
00:26:31,610 --> 00:26:36,860
they were<font color="#E5E5E5"> thinking ahead of the problem</font>

571
00:26:34,789 --> 00:26:39,620
<font color="#E5E5E5">are the years back</font>

572
00:26:36,860 --> 00:26:42,590
but this<font color="#E5E5E5"> is what it is</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> are dealing</font>

573
00:26:39,620 --> 00:26:44,149
<font color="#CCCCCC">with legacy</font><font color="#E5E5E5"> systems here</font><font color="#CCCCCC"> and for last</font>

574
00:26:42,590 --> 00:26:46,189
<font color="#E5E5E5">that's additional</font><font color="#CCCCCC"> third-party</font>

575
00:26:44,150 --> 00:26:48,440
applications might be running<font color="#E5E5E5"> on</font><font color="#CCCCCC"> the POS</font>

576
00:26:46,190 --> 00:26:50,659
<font color="#E5E5E5">so in a couple</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> instances there might</font>

577
00:26:48,440 --> 00:26:53,120
be an SQL<font color="#CCCCCC"> Server on an equivalent</font><font color="#E5E5E5"> and</font>

578
00:26:50,659 --> 00:26:55,250
imagine that if it's storing historical

579
00:26:53,120 --> 00:26:56,959
data and that's loaded into the<font color="#CCCCCC"> memory</font>

580
00:26:55,250 --> 00:26:59,240
<font color="#E5E5E5">then you are not just dealing with</font>

581
00:26:56,960 --> 00:27:01,880
<font color="#E5E5E5">actual transactions being stolen but</font>

582
00:26:59,240 --> 00:27:04,190
also something<font color="#E5E5E5"> from all those historical</font>

583
00:27:01,880 --> 00:27:07,279
<font color="#E5E5E5">data if the post creeper is</font><font color="#CCCCCC"> going is</font>

584
00:27:04,190 --> 00:27:10,429
able to grab the data from the memory

585
00:27:07,279 --> 00:27:12,890
<font color="#E5E5E5">and then we are switching over to the</font>

586
00:27:10,429 --> 00:27:16,220
<font color="#E5E5E5">hardware side</font><font color="#CCCCCC"> of the</font><font color="#E5E5E5"> problem so it's the</font>

587
00:27:12,890 --> 00:27:18,610
old debate magnetic stripe via CMV<font color="#E5E5E5"> which</font>

588
00:27:16,220 --> 00:27:22,159
is in the chip amp attempt in terminals

589
00:27:18,610 --> 00:27:24,908
actually<font color="#CCCCCC"> MV is not a new standard but</font>

590
00:27:22,159 --> 00:27:29,000
something old<font color="#E5E5E5"> it was already</font>

591
00:27:24,909 --> 00:27:31,700
standardized<font color="#E5E5E5"> originally in 1993 and</font><font color="#CCCCCC"> for</font>

592
00:27:29,000 --> 00:27:33,890
<font color="#E5E5E5">so it's it's almost about 25 years ago</font>

593
00:27:31,700 --> 00:27:38,120
<font color="#E5E5E5">and</font><font color="#CCCCCC"> these are the</font><font color="#E5E5E5"> thinking of encryption</font>

594
00:27:33,890 --> 00:27:39,620
back then<font color="#E5E5E5"> at least the basics and it by</font>

595
00:27:38,120 --> 00:27:42,110
the way it was standing for

596
00:27:39,620 --> 00:27:44,418
europay MasterCard and Visa I'm not sure

597
00:27:42,110 --> 00:27:46,729
<font color="#E5E5E5">if any</font><font color="#CCCCCC"> you still remember what</font><font color="#E5E5E5"> Europe a</font>

598
00:27:44,419 --> 00:27:50,240
was not likely<font color="#E5E5E5"> that that's also</font>

599
00:27:46,730 --> 00:27:53,000
something blast from the past<font color="#E5E5E5"> another</font>

600
00:27:50,240 --> 00:27:57,470
<font color="#CCCCCC">thing which is might be a</font><font color="#E5E5E5"> problem but</font>

601
00:27:53,000 --> 00:27:59,510
the liability<font color="#E5E5E5"> shield so</font><font color="#CCCCCC"> bank's</font><font color="#E5E5E5"> a little</font>

602
00:27:57,470 --> 00:28:02,210
bit got fed<font color="#CCCCCC"> up</font><font color="#E5E5E5"> with all these that</font>

603
00:27:59,510 --> 00:28:04,039
people<font color="#CCCCCC"> were easily stealing credit card</font>

604
00:28:02,210 --> 00:28:06,380
data<font color="#CCCCCC"> and of course</font><font color="#E5E5E5"> they are the ones</font>

605
00:28:04,039 --> 00:28:08,570
trying<font color="#E5E5E5"> to ensure the money I'm trying to</font>

606
00:28:06,380 --> 00:28:10,970
be<font color="#E5E5E5"> responsible for for whatever was</font>

607
00:28:08,570 --> 00:28:15,529
<font color="#CCCCCC">stolen people going to the bank hey I</font>

608
00:28:10,970 --> 00:28:18,230
got any kind of<font color="#E5E5E5"> card fraud</font><font color="#CCCCCC"> please give</font>

609
00:28:15,529 --> 00:28:20,539
me my money back<font color="#CCCCCC"> because I can sort</font><font color="#E5E5E5"> of</font>

610
00:28:18,230 --> 00:28:23,830
prove that it was<font color="#CCCCCC"> stolen from</font><font color="#E5E5E5"> me so you</font>

611
00:28:20,539 --> 00:28:27,408
<font color="#CCCCCC">can</font><font color="#E5E5E5"> see and understand that they were</font>

612
00:28:23,830 --> 00:28:30,439
fed up<font color="#E5E5E5"> pretty easily about that so they</font>

613
00:28:27,409 --> 00:28:33,890
wanted<font color="#CCCCCC"> to change that</font><font color="#E5E5E5"> and so they did in</font>

614
00:28:30,440 --> 00:28:34,830
the<font color="#CCCCCC"> EU it was 2005 and the first of</font>

615
00:28:33,890 --> 00:28:36,990
January

616
00:28:34,830 --> 00:28:39,960
when they were having<font color="#CCCCCC"> that</font><font color="#E5E5E5"> the new laws</font>

617
00:28:36,990 --> 00:28:42,570
for<font color="#CCCCCC"> this in the u.s. it took an</font>

618
00:28:39,960 --> 00:28:47,210
additional<font color="#CCCCCC"> ten years</font><font color="#E5E5E5"> it was just</font><font color="#CCCCCC"> the</font>

619
00:28:42,570 --> 00:28:50,250
years ago so at<font color="#E5E5E5"> that point they were</font>

620
00:28:47,210 --> 00:28:52,140
kind of moving<font color="#E5E5E5"> all the responsibility</font>

621
00:28:50,250 --> 00:28:54,179
<font color="#E5E5E5">from bank to merchant and the merchant</font>

622
00:28:52,140 --> 00:28:57,149
is being responsible<font color="#E5E5E5"> if there is any</font>

623
00:28:54,179 --> 00:29:00,269
kind<font color="#E5E5E5"> of known EMV transaction happening</font>

624
00:28:57,149 --> 00:29:03,570
and there is a fraud also there's a

625
00:29:00,269 --> 00:29:06,269
human factor<font color="#E5E5E5"> we are lazy</font><font color="#CCCCCC"> people I can</font>

626
00:29:03,570 --> 00:29:08,189
say that we like to easily just<font color="#E5E5E5"> find</font><font color="#CCCCCC"> the</font>

627
00:29:06,269 --> 00:29:10,500
card<font color="#CCCCCC"> we don't want to enter a PIN code</font>

628
00:29:08,190 --> 00:29:14,039
especially that's<font color="#CCCCCC"> true in the u.s. sorry</font>

629
00:29:10,500 --> 00:29:16,500
guys one possible<font color="#E5E5E5"> solution here would be</font>

630
00:29:14,039 --> 00:29:18,389
that they<font color="#CCCCCC"> are switching over to</font>

631
00:29:16,500 --> 00:29:20,669
contactless payment because that's<font color="#E5E5E5"> also</font>

632
00:29:18,389 --> 00:29:22,320
kind of a<font color="#E5E5E5"> convenient way but that is</font>

633
00:29:20,669 --> 00:29:24,690
<font color="#CCCCCC">only happening</font><font color="#E5E5E5"> in the past years and</font>

634
00:29:22,320 --> 00:29:26,970
still switching over to anything still

635
00:29:24,690 --> 00:29:29,340
involves money<font color="#E5E5E5"> as they have to replace</font>

636
00:29:26,970 --> 00:29:31,649
the terminals and<font color="#CCCCCC"> the software</font><font color="#E5E5E5"> and if</font>

637
00:29:29,340 --> 00:29:34,439
you think of<font color="#E5E5E5"> nationwide that can be a</font>

638
00:29:31,649 --> 00:29:37,678
lot<font color="#CCCCCC"> of</font><font color="#E5E5E5"> money</font><font color="#CCCCCC"> a couple of</font><font color="#E5E5E5"> an all-animal</font>

639
00:29:34,440 --> 00:29:40,080
is before I am<font color="#E5E5E5"> closing it up so when we</font>

640
00:29:37,679 --> 00:29:41,909
were having a<font color="#E5E5E5"> look on at all those</font>

641
00:29:40,080 --> 00:29:45,299
samples and and we were<font color="#E5E5E5"> doing the</font>

642
00:29:41,909 --> 00:29:47,700
investigation something kind<font color="#E5E5E5"> of stood</font>

643
00:29:45,299 --> 00:29:49,230
<font color="#E5E5E5">out that they were very quickly closing</font>

644
00:29:47,700 --> 00:29:51,720
down the ports<font color="#E5E5E5"> and changing to new</font>

645
00:29:49,230 --> 00:29:54,929
campaigns<font color="#E5E5E5"> but sometimes you are lucky</font>

646
00:29:51,720 --> 00:29:57,240
<font color="#E5E5E5">and there are very old</font><font color="#CCCCCC"> IPs and ports</font>

647
00:29:54,929 --> 00:30:00,750
<font color="#E5E5E5">being kept open so I wouldn't say it's</font>

648
00:29:57,240 --> 00:30:03,450
<font color="#CCCCCC">really a Field Op sack</font><font color="#E5E5E5"> it's just</font><font color="#CCCCCC"> kind of</font>

649
00:30:00,750 --> 00:30:05,309
a bit of<font color="#E5E5E5"> a laziness or maybe they were</font>

650
00:30:03,450 --> 00:30:07,500
overloaded with<font color="#E5E5E5"> with all the different</font>

651
00:30:05,309 --> 00:30:10,260
targets and the work but that has

652
00:30:07,500 --> 00:30:12,090
<font color="#CCCCCC">sometimes helps you to actually have a</font>

653
00:30:10,260 --> 00:30:14,158
living<font color="#CCCCCC"> connection and retrieving the</font>

654
00:30:12,090 --> 00:30:17,668
<font color="#E5E5E5">share code also</font><font color="#CCCCCC"> we could see a very</font>

655
00:30:14,159 --> 00:30:21,750
<font color="#CCCCCC">similar</font><font color="#E5E5E5"> downloader actually downloading</font>

656
00:30:17,669 --> 00:30:23,700
<font color="#E5E5E5">what was an act</font><font color="#CCCCCC"> XM rig minor so that</font>

657
00:30:21,750 --> 00:30:25,769
there are a couple<font color="#E5E5E5"> of differences it was</font>

658
00:30:23,700 --> 00:30:28,830
using<font color="#E5E5E5"> scheduled tasks for persistency</font>

659
00:30:25,769 --> 00:30:30,750
<font color="#E5E5E5">but the assembly code loader was very</font>

660
00:30:28,830 --> 00:30:31,918
<font color="#E5E5E5">similar and sometimes they were using</font><font color="#CCCCCC"> P</font>

661
00:30:30,750 --> 00:30:34,980
a compact which is a very basic

662
00:30:31,919 --> 00:30:37,649
executable<font color="#E5E5E5"> Packer that seems to</font><font color="#CCCCCC"> be a</font>

663
00:30:34,980 --> 00:30:39,990
<font color="#CCCCCC">spin-off I wouldn't say that these</font><font color="#E5E5E5"> are</font>

664
00:30:37,649 --> 00:30:41,908
<font color="#CCCCCC">the same people but</font><font color="#E5E5E5"> actually crypto</font>

665
00:30:39,990 --> 00:30:43,770
mining and cryptocurrencies were a big

666
00:30:41,909 --> 00:30:46,870
thing<font color="#CCCCCC"> in the past couple of years so it</font>

667
00:30:43,770 --> 00:30:49,840
wouldn't<font color="#E5E5E5"> it wouldn't be senseless</font>

668
00:30:46,870 --> 00:30:52,120
you say that<font color="#E5E5E5"> they were extending their</font>

669
00:30:49,840 --> 00:30:53,439
activities<font color="#E5E5E5"> and for the last that was</font>

670
00:30:52,120 --> 00:30:55,449
just kind of the<font color="#E5E5E5"> strangest one and</font>

671
00:30:53,440 --> 00:30:57,040
that's the server IP<font color="#E5E5E5"> arranged so whoever</font>

672
00:30:55,450 --> 00:30:59,710
was working<font color="#E5E5E5"> with the server around</font>

673
00:30:57,040 --> 00:31:02,470
somewhere before<font color="#E5E5E5"> might know that the</font>

674
00:30:59,710 --> 00:31:05,410
server is looking up a very big list of

675
00:31:02,470 --> 00:31:07,809
<font color="#E5E5E5">c-class</font><font color="#CCCCCC"> IPs</font><font color="#E5E5E5"> for any kind of</font><font color="#CCCCCC"> c2</font>

676
00:31:05,410 --> 00:31:11,860
communication or the<font color="#E5E5E5"> possibility of that</font>

677
00:31:07,809 --> 00:31:15,040
and that means if you<font color="#E5E5E5"> try to look for</font>

678
00:31:11,860 --> 00:31:17,409
<font color="#CCCCCC">Hansford</font><font color="#E5E5E5"> data and your actual IPS from</font>

679
00:31:15,040 --> 00:31:20,440
this previous campaign<font color="#E5E5E5"> are falling into</font>

680
00:31:17,410 --> 00:31:23,620
<font color="#CCCCCC">that range</font><font color="#E5E5E5"> you run into an awfully lot</font>

681
00:31:20,440 --> 00:31:26,290
of sir Berek kind of samples<font color="#E5E5E5"> and that's</font>

682
00:31:23,620 --> 00:31:30,669
<font color="#E5E5E5">just making</font><font color="#CCCCCC"> your investigation even</font>

683
00:31:26,290 --> 00:31:33,240
harder<font color="#E5E5E5"> as a conclusion</font><font color="#CCCCCC"> so it's a 4</font>

684
00:31:30,670 --> 00:31:36,100
kilobyte<font color="#E5E5E5"> usually assembly based</font>

685
00:31:33,240 --> 00:31:38,950
application purpose-built<font color="#CCCCCC"> it's very easy</font>

686
00:31:36,100 --> 00:31:41,050
to borrow ideas from<font color="#CCCCCC"> us such small</font>

687
00:31:38,950 --> 00:31:44,110
executable<font color="#CCCCCC"> you are not dealing</font><font color="#E5E5E5"> with any</font>

688
00:31:41,050 --> 00:31:46,360
<font color="#CCCCCC">kind of library and high level language</font>

689
00:31:44,110 --> 00:31:49,540
code and library stuff<font color="#E5E5E5"> it's just</font><font color="#CCCCCC"> the</font>

690
00:31:46,360 --> 00:31:51,580
pure<font color="#E5E5E5"> user code it's also very easy so</font>

691
00:31:49,540 --> 00:31:54,250
you can<font color="#E5E5E5"> imagine</font><font color="#CCCCCC"> if I want it to</font><font color="#E5E5E5"> rebuild</font>

692
00:31:51,580 --> 00:31:56,080
the same on a source<font color="#CCCCCC"> level it's 4</font>

693
00:31:54,250 --> 00:31:58,330
kilobytes<font color="#E5E5E5"> it's not taking more than a</font>

694
00:31:56,080 --> 00:32:00,220
couple<font color="#E5E5E5"> of days top and I am rebuilding I</font>

695
00:31:58,330 --> 00:32:02,439
have a source code<font color="#E5E5E5"> I do whatever I want</font>

696
00:32:00,220 --> 00:32:04,690
with<font color="#CCCCCC"> that</font><font color="#E5E5E5"> also</font><font color="#CCCCCC"> it's true that</font><font color="#E5E5E5"> you don't</font>

697
00:32:02,440 --> 00:32:07,300
<font color="#CCCCCC">really need massive amount of</font><font color="#E5E5E5"> code to</font>

698
00:32:04,690 --> 00:32:10,240
implement<font color="#E5E5E5"> basic functionality kind of</font>

699
00:32:07,300 --> 00:32:13,780
<font color="#E5E5E5">purpose-built for just doing a very</font>

700
00:32:10,240 --> 00:32:15,970
<font color="#E5E5E5">basic</font><font color="#CCCCCC"> thing telling exploitation</font><font color="#E5E5E5"> of POS</font>

701
00:32:13,780 --> 00:32:18,490
systems is<font color="#E5E5E5"> unfortunately</font><font color="#CCCCCC"> still happening</font>

702
00:32:15,970 --> 00:32:20,230
due to<font color="#E5E5E5"> the reasons I was just discussing</font>

703
00:32:18,490 --> 00:32:23,470
with<font color="#E5E5E5"> you</font><font color="#CCCCCC"> all the hardware</font><font color="#E5E5E5"> and the</font>

704
00:32:20,230 --> 00:32:27,580
software issues combined<font color="#CCCCCC"> together making</font>

705
00:32:23,470 --> 00:32:30,280
<font color="#E5E5E5">it possible and there is a problem with</font>

706
00:32:27,580 --> 00:32:33,428
software driven<font color="#E5E5E5"> update chains so it</font>

707
00:32:30,280 --> 00:32:35,950
seems<font color="#E5E5E5"> to be reasonable that some teams</font>

708
00:32:33,429 --> 00:32:38,620
<font color="#E5E5E5">are also utilizing hacking and either</font>

709
00:32:35,950 --> 00:32:41,410
getting<font color="#E5E5E5"> to a computer which is a</font>

710
00:32:38,620 --> 00:32:42,820
software delivery chain which is taking

711
00:32:41,410 --> 00:32:44,530
part<font color="#E5E5E5"> in</font><font color="#CCCCCC"> a software delivery chain and</font>

712
00:32:42,820 --> 00:32:47,260
using that<font color="#E5E5E5"> to spread all the</font><font color="#CCCCCC"> downloads</font>

713
00:32:44,530 --> 00:32:50,050
<font color="#CCCCCC">to all the previous terminals or they</font>

714
00:32:47,260 --> 00:32:51,910
are<font color="#E5E5E5"> hacking</font><font color="#CCCCCC"> the remote</font><font color="#E5E5E5"> access tools</font>

715
00:32:50,050 --> 00:32:54,300
already pre-installed and using

716
00:32:51,910 --> 00:32:57,420
credentials to get into

717
00:32:54,300 --> 00:32:59,820
companies that<font color="#CCCCCC"> way and that's</font><font color="#E5E5E5"> where we</font>

718
00:32:57,420 --> 00:33:03,110
can connect back to the<font color="#CCCCCC"> Joker stage</font>

719
00:32:59,820 --> 00:33:06,720
statement that<font color="#E5E5E5"> likely stealing that many</font>

720
00:33:03,110 --> 00:33:11,850
data on that level<font color="#E5E5E5"> is not possible in a</font>

721
00:33:06,720 --> 00:33:13,800
different way a couple<font color="#CCCCCC"> of thanks to guys</font>

722
00:33:11,850 --> 00:33:16,169
helping me<font color="#E5E5E5"> and a couple of</font><font color="#CCCCCC"> organizations</font>

723
00:33:13,800 --> 00:33:17,550
I<font color="#CCCCCC"> was using the graphs I</font><font color="#E5E5E5"> wasn't talking</font>

724
00:33:16,170 --> 00:33:19,380
about the chance<font color="#E5E5E5"> because it was</font><font color="#CCCCCC"> just a</font>

725
00:33:17,550 --> 00:33:21,930
time I'm going<font color="#E5E5E5"> to share the</font><font color="#CCCCCC"> slides and</font>

726
00:33:19,380 --> 00:33:24,360
I'm also going to share<font color="#E5E5E5"> I</font><font color="#CCCCCC"> OC is you know</font>

727
00:33:21,930 --> 00:33:26,460
upcoming blog post all the samples the<font color="#E5E5E5"> C</font>

728
00:33:24,360 --> 00:33:33,330
tools and new taxes<font color="#CCCCCC"> and</font><font color="#E5E5E5"> whatever</font><font color="#CCCCCC"> be</font>

729
00:33:26,460 --> 00:33:35,220
<font color="#E5E5E5">forgetting questions and thank you very</font>

730
00:33:33,330 --> 00:33:37,290
much<font color="#E5E5E5"> for your time I am here if you want</font>

731
00:33:35,220 --> 00:33:39,040
to<font color="#CCCCCC"> have questions in person</font><font color="#E5E5E5"> or by email</font>

732
00:33:37,290 --> 00:33:46,779
at a later point<font color="#CCCCCC"> thank you guys</font>

733
00:33:39,040 --> 00:33:46,779
[Applause]

